var jE=Object.defineProperty;var zE=(e,t,n)=>t in e?jE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Gt=(e,t,n)=>zE(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Mm(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return n=>n in t}const Di={},Gh=[],gu=()=>{},$E=()=>!1,Pp=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),N1=e=>e.startsWith("onUpdate:"),co=Object.assign,D1=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},UE=Object.prototype.hasOwnProperty,Wi=(e,t)=>UE.call(e,t),tr=Array.isArray,Hh=e=>ud(e)==="[object Map]",sh=e=>ud(e)==="[object Set]",N2=e=>ud(e)==="[object Date]",VE=e=>ud(e)==="[object RegExp]",Tr=e=>typeof e=="function",_o=e=>typeof e=="string",Vu=e=>typeof e=="symbol",Qi=e=>e!==null&&typeof e=="object",I1=e=>(Qi(e)||Tr(e))&&Tr(e.then)&&Tr(e.catch),rw=Object.prototype.toString,ud=e=>rw.call(e),GE=e=>ud(e).slice(8,-1),Am=e=>ud(e)==="[object Object]",O1=e=>_o(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,qh=Mm(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),km=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},HE=/-(\w)/g,ga=km(e=>e.replace(HE,(t,n)=>n?n.toUpperCase():"")),qE=/\B([A-Z])/g,Cl=km(e=>e.replace(qE,"-$1").toLowerCase()),Mp=km(e=>e.charAt(0).toUpperCase()+e.slice(1)),Wd=km(e=>e?`on${Mp(e)}`:""),nl=(e,t)=>!Object.is(e,t),Wh=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},iw=(e,t,n,r=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:r,value:n})},Yg=e=>{const t=parseFloat(e);return isNaN(t)?e:t},Jg=e=>{const t=_o(e)?Number(e):NaN;return isNaN(t)?e:t};let D2;const Tm=()=>D2||(D2=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),WE="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console,Error,Symbol",ZE=Mm(WE);function ql(e){if(tr(e)){const t={};for(let n=0;n<e.length;n++){const r=e[n],i=_o(r)?XE(r):ql(r);if(i)for(const s in i)t[s]=i[s]}return t}else if(_o(e)||Qi(e))return e}const KE=/;(?![^(]*\))/g,YE=/:([^]+)/,JE=/\/\*[^]*?\*\//g;function XE(e){const t={};return e.replace(JE,"").split(KE).forEach(n=>{if(n){const r=n.split(YE);r.length>1&&(t[r[0].trim()]=r[1].trim())}}),t}function Bi(e){let t="";if(_o(e))t=e;else if(tr(e))for(let n=0;n<e.length;n++){const r=Bi(e[n]);r&&(t+=r+" ")}else if(Qi(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}function QE(e){if(!e)return null;let{class:t,style:n}=e;return t&&!_o(t)&&(e.class=Bi(t)),n&&(e.style=ql(n)),e}const eP="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",tP=Mm(eP);function ow(e){return!!e||e===""}function nP(e,t){if(e.length!==t.length)return!1;let n=!0;for(let r=0;n&&r<e.length;r++)n=wf(e[r],t[r]);return n}function wf(e,t){if(e===t)return!0;let n=N2(e),r=N2(t);if(n||r)return n&&r?e.getTime()===t.getTime():!1;if(n=Vu(e),r=Vu(t),n||r)return e===t;if(n=tr(e),r=tr(t),n||r)return n&&r?nP(e,t):!1;if(n=Qi(e),r=Qi(t),n||r){if(!n||!r)return!1;const i=Object.keys(e).length,s=Object.keys(t).length;if(i!==s)return!1;for(const o in e){const u=e.hasOwnProperty(o),f=t.hasOwnProperty(o);if(u&&!f||!u&&f||!wf(e[o],t[o]))return!1}}return String(e)===String(t)}function Nm(e,t){return e.findIndex(n=>wf(n,t))}const sw=e=>!!(e&&e.__v_isRef===!0),Wt=e=>_o(e)?e:e==null?"":tr(e)||Qi(e)&&(e.toString===rw||!Tr(e.toString))?sw(e)?Wt(e.value):JSON.stringify(e,aw,2):String(e),aw=(e,t)=>sw(t)?aw(e,t.value):Hh(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[r,i],s)=>(n[B0(r,s)+" =>"]=i,n),{})}:sh(t)?{[`Set(${t.size})`]:[...t.values()].map(n=>B0(n))}:Vu(t)?B0(t):Qi(t)&&!tr(t)&&!Am(t)?String(t):t,B0=(e,t="")=>{var n;return Vu(e)?`Symbol(${(n=e.description)!=null?n:t})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let tl;class B1{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=tl,!t&&tl&&(this.index=(tl.scopes||(tl.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].pause();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].resume();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].resume()}}run(t){if(this._active){const n=tl;try{return tl=this,t()}finally{tl=n}}}on(){tl=this}off(){tl=this.parent}stop(t){if(this._active){this._active=!1;let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(this.effects.length=0,n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function R1(e){return new B1(e)}function F1(){return tl}function lw(e,t=!1){tl&&tl.cleanups.push(e)}let yo;const R0=new WeakSet;class hp{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,tl&&tl.active&&tl.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,R0.has(this)&&(R0.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||cw(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,I2(this),fw(this);const t=yo,n=$u;yo=this,$u=!0;try{return this.fn()}finally{hw(this),yo=t,$u=n,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)$1(t);this.deps=this.depsTail=void 0,I2(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?R0.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Ev(this)&&this.run()}get dirty(){return Ev(this)}}let uw=0,Zd,Kd;function cw(e,t=!1){if(e.flags|=8,t){e.next=Kd,Kd=e;return}e.next=Zd,Zd=e}function j1(){uw++}function z1(){if(--uw>0)return;if(Kd){let t=Kd;for(Kd=void 0;t;){const n=t.next;t.next=void 0,t.flags&=-9,t=n}}let e;for(;Zd;){let t=Zd;for(Zd=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(r){e||(e=r)}t=n}}if(e)throw e}function fw(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function hw(e){let t,n=e.depsTail,r=n;for(;r;){const i=r.prevDep;r.version===-1?(r===n&&(n=i),$1(r),rP(r)):t=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=i}e.deps=t,e.depsTail=n}function Ev(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(dw(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function dw(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===dp))return;e.globalVersion=dp;const t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!Ev(e)){e.flags&=-3;return}const n=yo,r=$u;yo=e,$u=!0;try{fw(e);const i=e.fn(e._value);(t.version===0||nl(i,e._value))&&(e._value=i,t.version++)}catch(i){throw t.version++,i}finally{yo=n,$u=r,hw(e),e.flags&=-3}}function $1(e,t=!1){const{dep:n,prevSub:r,nextSub:i}=e;if(r&&(r.nextSub=i,e.prevSub=void 0),i&&(i.prevSub=r,e.nextSub=void 0),n.subs===e&&(n.subs=r,!r&&n.computed)){n.computed.flags&=-5;for(let s=n.computed.deps;s;s=s.nextDep)$1(s,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function rP(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}function iP(e,t){e.effect instanceof hp&&(e=e.effect.fn);const n=new hp(e);t&&co(n,t);try{n.run()}catch(i){throw n.stop(),i}const r=n.run.bind(n);return r.effect=n,r}function oP(e){e.effect.stop()}let $u=!0;const pw=[];function Mf(){pw.push($u),$u=!1}function Af(){const e=pw.pop();$u=e===void 0?!0:e}function I2(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const n=yo;yo=void 0;try{t()}finally{yo=n}}}let dp=0;class sP{constructor(t,n){this.sub=t,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Dm{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!yo||!$u||yo===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==yo)n=this.activeLink=new sP(yo,this),yo.deps?(n.prevDep=yo.depsTail,yo.depsTail.nextDep=n,yo.depsTail=n):yo.deps=yo.depsTail=n,gw(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const r=n.nextDep;r.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=r),n.prevDep=yo.depsTail,n.nextDep=void 0,yo.depsTail.nextDep=n,yo.depsTail=n,yo.deps===n&&(yo.deps=r)}return n}trigger(t){this.version++,dp++,this.notify(t)}notify(t){j1();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{z1()}}}function gw(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let r=t.deps;r;r=r.nextDep)gw(r)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const Xg=new WeakMap,Jf=Symbol(""),Pv=Symbol(""),pp=Symbol("");function Oa(e,t,n){if($u&&yo){let r=Xg.get(e);r||Xg.set(e,r=new Map);let i=r.get(n);i||(r.set(n,i=new Dm),i.map=r,i.key=n),i.track()}}function Rc(e,t,n,r,i,s){const o=Xg.get(e);if(!o){dp++;return}const u=f=>{f&&f.trigger()};if(j1(),t==="clear")o.forEach(u);else{const f=tr(e),d=f&&O1(n);if(f&&n==="length"){const g=Number(r);o.forEach((y,x)=>{(x==="length"||x===pp||!Vu(x)&&x>=g)&&u(y)})}else switch((n!==void 0||o.has(void 0))&&u(o.get(n)),d&&u(o.get(pp)),t){case"add":f?d&&u(o.get("length")):(u(o.get(Jf)),Hh(e)&&u(o.get(Pv)));break;case"delete":f||(u(o.get(Jf)),Hh(e)&&u(o.get(Pv)));break;case"set":Hh(e)&&u(o.get(Jf));break}}z1()}function aP(e,t){const n=Xg.get(e);return n&&n.get(t)}function Ch(e){const t=Ni(e);return t===e?t:(Oa(t,"iterate",pp),Wl(e)?t:t.map(Ba))}function Im(e){return Oa(e=Ni(e),"iterate",pp),e}const lP={__proto__:null,[Symbol.iterator](){return F0(this,Symbol.iterator,Ba)},concat(...e){return Ch(this).concat(...e.map(t=>tr(t)?Ch(t):t))},entries(){return F0(this,"entries",e=>(e[1]=Ba(e[1]),e))},every(e,t){return Nc(this,"every",e,t,void 0,arguments)},filter(e,t){return Nc(this,"filter",e,t,n=>n.map(Ba),arguments)},find(e,t){return Nc(this,"find",e,t,Ba,arguments)},findIndex(e,t){return Nc(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Nc(this,"findLast",e,t,Ba,arguments)},findLastIndex(e,t){return Nc(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Nc(this,"forEach",e,t,void 0,arguments)},includes(...e){return j0(this,"includes",e)},indexOf(...e){return j0(this,"indexOf",e)},join(e){return Ch(this).join(e)},lastIndexOf(...e){return j0(this,"lastIndexOf",e)},map(e,t){return Nc(this,"map",e,t,void 0,arguments)},pop(){return Ld(this,"pop")},push(...e){return Ld(this,"push",e)},reduce(e,...t){return O2(this,"reduce",e,t)},reduceRight(e,...t){return O2(this,"reduceRight",e,t)},shift(){return Ld(this,"shift")},some(e,t){return Nc(this,"some",e,t,void 0,arguments)},splice(...e){return Ld(this,"splice",e)},toReversed(){return Ch(this).toReversed()},toSorted(e){return Ch(this).toSorted(e)},toSpliced(...e){return Ch(this).toSpliced(...e)},unshift(...e){return Ld(this,"unshift",e)},values(){return F0(this,"values",Ba)}};function F0(e,t,n){const r=Im(e),i=r[t]();return r!==e&&!Wl(e)&&(i._next=i.next,i.next=()=>{const s=i._next();return s.value&&(s.value=n(s.value)),s}),i}const uP=Array.prototype;function Nc(e,t,n,r,i,s){const o=Im(e),u=o!==e&&!Wl(e),f=o[t];if(f!==uP[t]){const y=f.apply(e,s);return u?Ba(y):y}let d=n;o!==e&&(u?d=function(y,x){return n.call(this,Ba(y),x,e)}:n.length>2&&(d=function(y,x){return n.call(this,y,x,e)}));const g=f.call(o,d,r);return u&&i?i(g):g}function O2(e,t,n,r){const i=Im(e);let s=n;return i!==e&&(Wl(e)?n.length>3&&(s=function(o,u,f){return n.call(this,o,u,f,e)}):s=function(o,u,f){return n.call(this,o,Ba(u),f,e)}),i[t](s,...r)}function j0(e,t,n){const r=Ni(e);Oa(r,"iterate",pp);const i=r[t](...n);return(i===-1||i===!1)&&Rm(n[0])?(n[0]=Ni(n[0]),r[t](...n)):i}function Ld(e,t,n=[]){Mf(),j1();const r=Ni(e)[t].apply(e,n);return z1(),Af(),r}const cP=Mm("__proto__,__v_isRef,__isVue"),mw=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Vu));function fP(e){Vu(e)||(e=String(e));const t=Ni(this);return Oa(t,"has",e),t.hasOwnProperty(e)}class vw{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,r){if(n==="__v_skip")return t.__v_skip;const i=this._isReadonly,s=this._isShallow;if(n==="__v_isReactive")return!i;if(n==="__v_isReadonly")return i;if(n==="__v_isShallow")return s;if(n==="__v_raw")return r===(i?s?Lw:xw:s?ww:bw).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(r)?t:void 0;const o=tr(t);if(!i){let f;if(o&&(f=lP[n]))return f;if(n==="hasOwnProperty")return fP}const u=Reflect.get(t,n,Xo(t)?t:r);return(Vu(n)?mw.has(n):cP(n))||(i||Oa(t,"get",n),s)?u:Xo(u)?o&&O1(n)?u:u.value:Qi(u)?i?Bu(u):Yl(u):u}}class yw extends vw{constructor(t=!1){super(!1,t)}set(t,n,r,i){let s=t[n];if(!this._isShallow){const f=xf(s);if(!Wl(r)&&!xf(r)&&(s=Ni(s),r=Ni(r)),!tr(t)&&Xo(s)&&!Xo(r))return f?!1:(s.value=r,!0)}const o=tr(t)&&O1(n)?Number(n)<t.length:Wi(t,n),u=Reflect.set(t,n,r,Xo(t)?t:i);return t===Ni(i)&&(o?nl(r,s)&&Rc(t,"set",n,r):Rc(t,"add",n,r)),u}deleteProperty(t,n){const r=Wi(t,n);t[n];const i=Reflect.deleteProperty(t,n);return i&&r&&Rc(t,"delete",n,void 0),i}has(t,n){const r=Reflect.has(t,n);return(!Vu(n)||!mw.has(n))&&Oa(t,"has",n),r}ownKeys(t){return Oa(t,"iterate",tr(t)?"length":Jf),Reflect.ownKeys(t)}}class _w extends vw{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const hP=new yw,dP=new _w,pP=new yw(!0),gP=new _w(!0),Mv=e=>e,lg=e=>Reflect.getPrototypeOf(e);function mP(e,t,n){return function(...r){const i=this.__v_raw,s=Ni(i),o=Hh(s),u=e==="entries"||e===Symbol.iterator&&o,f=e==="keys"&&o,d=i[e](...r),g=n?Mv:t?Av:Ba;return!t&&Oa(s,"iterate",f?Pv:Jf),{next(){const{value:y,done:x}=d.next();return x?{value:y,done:x}:{value:u?[g(y[0]),g(y[1])]:g(y),done:x}},[Symbol.iterator](){return this}}}}function ug(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function vP(e,t){const n={get(i){const s=this.__v_raw,o=Ni(s),u=Ni(i);e||(nl(i,u)&&Oa(o,"get",i),Oa(o,"get",u));const{has:f}=lg(o),d=t?Mv:e?Av:Ba;if(f.call(o,i))return d(s.get(i));if(f.call(o,u))return d(s.get(u));s!==o&&s.get(i)},get size(){const i=this.__v_raw;return!e&&Oa(Ni(i),"iterate",Jf),Reflect.get(i,"size",i)},has(i){const s=this.__v_raw,o=Ni(s),u=Ni(i);return e||(nl(i,u)&&Oa(o,"has",i),Oa(o,"has",u)),i===u?s.has(i):s.has(i)||s.has(u)},forEach(i,s){const o=this,u=o.__v_raw,f=Ni(u),d=t?Mv:e?Av:Ba;return!e&&Oa(f,"iterate",Jf),u.forEach((g,y)=>i.call(s,d(g),d(y),o))}};return co(n,e?{add:ug("add"),set:ug("set"),delete:ug("delete"),clear:ug("clear")}:{add(i){!t&&!Wl(i)&&!xf(i)&&(i=Ni(i));const s=Ni(this);return lg(s).has.call(s,i)||(s.add(i),Rc(s,"add",i,i)),this},set(i,s){!t&&!Wl(s)&&!xf(s)&&(s=Ni(s));const o=Ni(this),{has:u,get:f}=lg(o);let d=u.call(o,i);d||(i=Ni(i),d=u.call(o,i));const g=f.call(o,i);return o.set(i,s),d?nl(s,g)&&Rc(o,"set",i,s):Rc(o,"add",i,s),this},delete(i){const s=Ni(this),{has:o,get:u}=lg(s);let f=o.call(s,i);f||(i=Ni(i),f=o.call(s,i)),u&&u.call(s,i);const d=s.delete(i);return f&&Rc(s,"delete",i,void 0),d},clear(){const i=Ni(this),s=i.size!==0,o=i.clear();return s&&Rc(i,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(i=>{n[i]=mP(i,e,t)}),n}function Om(e,t){const n=vP(e,t);return(r,i,s)=>i==="__v_isReactive"?!e:i==="__v_isReadonly"?e:i==="__v_raw"?r:Reflect.get(Wi(n,i)&&i in r?n:r,i,s)}const yP={get:Om(!1,!1)},_P={get:Om(!1,!0)},bP={get:Om(!0,!1)},wP={get:Om(!0,!0)},bw=new WeakMap,ww=new WeakMap,xw=new WeakMap,Lw=new WeakMap;function xP(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function LP(e){return e.__v_skip||!Object.isExtensible(e)?0:xP(GE(e))}function Yl(e){return xf(e)?e:Bm(e,!1,hP,yP,bw)}function U1(e){return Bm(e,!1,pP,_P,ww)}function Bu(e){return Bm(e,!0,dP,bP,xw)}function SP(e){return Bm(e,!0,gP,wP,Lw)}function Bm(e,t,n,r,i){if(!Qi(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const s=i.get(e);if(s)return s;const o=LP(e);if(o===0)return e;const u=new Proxy(e,o===2?r:n);return i.set(e,u),u}function dc(e){return xf(e)?dc(e.__v_raw):!!(e&&e.__v_isReactive)}function xf(e){return!!(e&&e.__v_isReadonly)}function Wl(e){return!!(e&&e.__v_isShallow)}function Rm(e){return e?!!e.__v_raw:!1}function Ni(e){const t=e&&e.__v_raw;return t?Ni(t):e}function Fm(e){return!Wi(e,"__v_skip")&&Object.isExtensible(e)&&iw(e,"__v_skip",!0),e}const Ba=e=>Qi(e)?Yl(e):e,Av=e=>Qi(e)?Bu(e):e;function Xo(e){return e?e.__v_isRef===!0:!1}function Ft(e){return Sw(e,!1)}function V1(e){return Sw(e,!0)}function Sw(e,t){return Xo(e)?e:new CP(e,t)}class CP{constructor(t,n){this.dep=new Dm,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?t:Ni(t),this._value=n?t:Ba(t),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(t){const n=this._rawValue,r=this.__v_isShallow||Wl(t)||xf(t);t=r?t:Ni(t),nl(t,n)&&(this._rawValue=t,this._value=r?t:Ba(t),this.dep.trigger())}}function EP(e){e.dep&&e.dep.trigger()}function Wn(e){return Xo(e)?e.value:e}function PP(e){return Tr(e)?e():Wn(e)}const MP={get:(e,t,n)=>t==="__v_raw"?e:Wn(Reflect.get(e,t,n)),set:(e,t,n,r)=>{const i=e[t];return Xo(i)&&!Xo(n)?(i.value=n,!0):Reflect.set(e,t,n,r)}};function G1(e){return dc(e)?e:new Proxy(e,MP)}class AP{constructor(t){this.__v_isRef=!0,this._value=void 0;const n=this.dep=new Dm,{get:r,set:i}=t(n.track.bind(n),n.trigger.bind(n));this._get=r,this._set=i}get value(){return this._value=this._get()}set value(t){this._set(t)}}function Cw(e){return new AP(e)}function Ew(e){const t=tr(e)?new Array(e.length):{};for(const n in e)t[n]=Pw(e,n);return t}class kP{constructor(t,n,r){this._object=t,this._key=n,this._defaultValue=r,this.__v_isRef=!0,this._value=void 0}get value(){const t=this._object[this._key];return this._value=t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return aP(Ni(this._object),this._key)}}class TP{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function NP(e,t,n){return Xo(e)?e:Tr(e)?new TP(e):Qi(e)&&arguments.length>1?Pw(e,t,n):Ft(e)}function Pw(e,t,n){const r=e[t];return Xo(r)?r:new kP(e,t,n)}class DP{constructor(t,n,r){this.fn=t,this.setter=n,this._value=void 0,this.dep=new Dm(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=dp-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&yo!==this)return cw(this,!0),!0}get value(){const t=this.dep.track();return dw(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function IP(e,t,n=!1){let r,i;return Tr(e)?r=e:(r=e.get,i=e.set),new DP(r,i,n)}const OP={GET:"get",HAS:"has",ITERATE:"iterate"},BP={SET:"set",ADD:"add",DELETE:"delete",CLEAR:"clear"},cg={},Qg=new WeakMap;let lf;function RP(){return lf}function Mw(e,t=!1,n=lf){if(n){let r=Qg.get(n);r||Qg.set(n,r=[]),r.push(e)}}function FP(e,t,n=Di){const{immediate:r,deep:i,once:s,scheduler:o,augmentJob:u,call:f}=n,d=te=>i?te:Wl(te)||i===!1||i===0?Fc(te,1):Fc(te);let g,y,x,_,M=!1,T=!1;if(Xo(e)?(y=()=>e.value,M=Wl(e)):dc(e)?(y=()=>d(e),M=!0):tr(e)?(T=!0,M=e.some(te=>dc(te)||Wl(te)),y=()=>e.map(te=>{if(Xo(te))return te.value;if(dc(te))return d(te);if(Tr(te))return f?f(te,2):te()})):Tr(e)?t?y=f?()=>f(e,2):e:y=()=>{if(x){Mf();try{x()}finally{Af()}}const te=lf;lf=g;try{return f?f(e,3,[_]):e(_)}finally{lf=te}}:y=gu,t&&i){const te=y,ue=i===!0?1/0:i;y=()=>Fc(te(),ue)}const D=F1(),I=()=>{g.stop(),D&&D.active&&D1(D.effects,g)};if(s&&t){const te=t;t=(...ue)=>{te(...ue),I()}}let j=T?new Array(e.length).fill(cg):cg;const Z=te=>{if(!(!(g.flags&1)||!g.dirty&&!te))if(t){const ue=g.run();if(i||M||(T?ue.some((le,ge)=>nl(le,j[ge])):nl(ue,j))){x&&x();const le=lf;lf=g;try{const ge=[ue,j===cg?void 0:T&&j[0]===cg?[]:j,_];f?f(t,3,ge):t(...ge),j=ue}finally{lf=le}}}else g.run()};return u&&u(Z),g=new hp(y),g.scheduler=o?()=>o(Z,!1):Z,_=te=>Mw(te,!1,g),x=g.onStop=()=>{const te=Qg.get(g);if(te){if(f)f(te,4);else for(const ue of te)ue();Qg.delete(g)}},t?r?Z(!0):j=g.run():o?o(Z.bind(null,!0),!0):g.run(),I.pause=g.pause.bind(g),I.resume=g.resume.bind(g),I.stop=I,I}function Fc(e,t=1/0,n){if(t<=0||!Qi(e)||e.__v_skip||(n=n||new Set,n.has(e)))return e;if(n.add(e),t--,Xo(e))Fc(e.value,t,n);else if(tr(e))for(let r=0;r<e.length;r++)Fc(e[r],t,n);else if(sh(e)||Hh(e))e.forEach(r=>{Fc(r,t,n)});else if(Am(e)){for(const r in e)Fc(e[r],t,n);for(const r of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,r)&&Fc(e[r],t,n)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const Aw=[];function jP(e){Aw.push(e)}function zP(){Aw.pop()}function $P(e,t){}const UP={SETUP_FUNCTION:0,0:"SETUP_FUNCTION",RENDER_FUNCTION:1,1:"RENDER_FUNCTION",NATIVE_EVENT_HANDLER:5,5:"NATIVE_EVENT_HANDLER",COMPONENT_EVENT_HANDLER:6,6:"COMPONENT_EVENT_HANDLER",VNODE_HOOK:7,7:"VNODE_HOOK",DIRECTIVE_HOOK:8,8:"DIRECTIVE_HOOK",TRANSITION_HOOK:9,9:"TRANSITION_HOOK",APP_ERROR_HANDLER:10,10:"APP_ERROR_HANDLER",APP_WARN_HANDLER:11,11:"APP_WARN_HANDLER",FUNCTION_REF:12,12:"FUNCTION_REF",ASYNC_COMPONENT_LOADER:13,13:"ASYNC_COMPONENT_LOADER",SCHEDULER:14,14:"SCHEDULER",COMPONENT_UPDATE:15,15:"COMPONENT_UPDATE",APP_UNMOUNT_CLEANUP:16,16:"APP_UNMOUNT_CLEANUP"},VP={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",0:"setup function",1:"render function",2:"watcher getter",3:"watcher callback",4:"watcher cleanup function",5:"native event handler",6:"component event handler",7:"vnode hook",8:"directive hook",9:"transition hook",10:"app errorHandler",11:"app warnHandler",12:"ref function",13:"async component loader",14:"scheduler flush",15:"component update",16:"app unmount cleanup function"};function cd(e,t,n,r){try{return r?e(...r):e()}catch(i){ah(i,t,n)}}function vu(e,t,n,r){if(Tr(e)){const i=cd(e,t,n,r);return i&&I1(i)&&i.catch(s=>{ah(s,t,n)}),i}if(tr(e)){const i=[];for(let s=0;s<e.length;s++)i.push(vu(e[s],t,n,r));return i}}function ah(e,t,n,r=!0){const i=t?t.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:o}=t&&t.appContext.config||Di;if(t){let u=t.parent;const f=t.proxy,d=`https://vuejs.org/error-reference/#runtime-${n}`;for(;u;){const g=u.ec;if(g){for(let y=0;y<g.length;y++)if(g[y](e,f,d)===!1)return}u=u.parent}if(s){Mf(),cd(s,null,10,[e,f,d]),Af();return}}GP(e,n,i,r,o)}function GP(e,t,n,r=!0,i=!1){if(i)throw e;console.error(e)}const rl=[];let ac=-1;const Zh=[];let uf=null,Ih=0;const kw=Promise.resolve();let em=null;function Xs(e){const t=em||kw;return e?t.then(this?e.bind(this):e):t}function HP(e){let t=ac+1,n=rl.length;for(;t<n;){const r=t+n>>>1,i=rl[r],s=mp(i);s<e||s===e&&i.flags&2?t=r+1:n=r}return t}function H1(e){if(!(e.flags&1)){const t=mp(e),n=rl[rl.length-1];!n||!(e.flags&2)&&t>=mp(n)?rl.push(e):rl.splice(HP(t),0,e),e.flags|=1,Tw()}}function Tw(){em||(em=kw.then(Nw))}function gp(e){tr(e)?Zh.push(...e):uf&&e.id===-1?uf.splice(Ih+1,0,e):e.flags&1||(Zh.push(e),e.flags|=1),Tw()}function B2(e,t,n=ac+1){for(;n<rl.length;n++){const r=rl[n];if(r&&r.flags&2){if(e&&r.id!==e.uid)continue;rl.splice(n,1),n--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function tm(e){if(Zh.length){const t=[...new Set(Zh)].sort((n,r)=>mp(n)-mp(r));if(Zh.length=0,uf){uf.push(...t);return}for(uf=t,Ih=0;Ih<uf.length;Ih++){const n=uf[Ih];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}uf=null,Ih=0}}const mp=e=>e.id==null?e.flags&2?-1:1/0:e.id;function Nw(e){try{for(ac=0;ac<rl.length;ac++){const t=rl[ac];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),cd(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;ac<rl.length;ac++){const t=rl[ac];t&&(t.flags&=-2)}ac=-1,rl.length=0,tm(),em=null,(rl.length||Zh.length)&&Nw()}}let Oh,fg=[];function Dw(e,t){var n,r;Oh=e,Oh?(Oh.enabled=!0,fg.forEach(({event:i,args:s})=>Oh.emit(i,...s)),fg=[]):typeof window<"u"&&window.HTMLElement&&!((r=(n=window.navigator)==null?void 0:n.userAgent)!=null&&r.includes("jsdom"))?((t.__VUE_DEVTOOLS_HOOK_REPLAY__=t.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(s=>{Dw(s,t)}),setTimeout(()=>{Oh||(t.__VUE_DEVTOOLS_HOOK_REPLAY__=null,fg=[])},3e3)):fg=[]}let zs=null,jm=null;function vp(e){const t=zs;return zs=e,jm=e&&e.type.__scopeId||null,t}function qP(e){jm=e}function WP(){jm=null}const ZP=e=>Gl;function Gl(e,t=zs,n){if(!t||e._n)return e;const r=(...i)=>{r._d&&Rv(-1);const s=vp(t);let o;try{o=e(...i)}finally{vp(s),r._d&&Rv(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function Fn(e,t){if(zs===null)return e;const n=Tp(zs),r=e.dirs||(e.dirs=[]);for(let i=0;i<t.length;i++){let[s,o,u,f=Di]=t[i];s&&(Tr(s)&&(s={mounted:s,updated:s}),s.deep&&Fc(o),r.push({dir:s,instance:n,value:o,oldValue:void 0,arg:u,modifiers:f}))}return e}function lc(e,t,n,r){const i=e.dirs,s=t&&t.dirs;for(let o=0;o<i.length;o++){const u=i[o];s&&(u.oldValue=s[o].value);let f=u.dir[r];f&&(Mf(),vu(f,n,8,[e.el,u,e,t]),Af())}}const Iw=Symbol("_vte"),Ow=e=>e.__isTeleport,Yd=e=>e&&(e.disabled||e.disabled===""),R2=e=>e&&(e.defer||e.defer===""),F2=e=>typeof SVGElement<"u"&&e instanceof SVGElement,j2=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,kv=(e,t)=>{const n=e&&e.to;return _o(n)?t?t(n):null:n},Bw={name:"Teleport",__isTeleport:!0,process(e,t,n,r,i,s,o,u,f,d){const{mc:g,pc:y,pbc:x,o:{insert:_,querySelector:M,createText:T,createComment:D}}=d,I=Yd(t.props);let{shapeFlag:j,children:Z,dynamicChildren:te}=t;if(e==null){const ue=t.el=T(""),le=t.anchor=T("");_(ue,n,r),_(le,n,r);const ge=(U,Q)=>{j&16&&(i&&i.isCE&&(i.ce._teleportTarget=U),g(Z,U,Q,i,s,o,u,f))},H=()=>{const U=t.target=kv(t.props,M),Q=Rw(U,t,T,_);U&&(o!=="svg"&&F2(U)?o="svg":o!=="mathml"&&j2(U)&&(o="mathml"),I||(ge(U,Q),Tg(t,!1)))};I&&(ge(n,le),Tg(t,!0)),R2(t.props)?Fs(()=>{H(),t.el.__isMounted=!0},s):H()}else{if(R2(t.props)&&!e.el.__isMounted){Fs(()=>{Bw.process(e,t,n,r,i,s,o,u,f,d),delete e.el.__isMounted},s);return}t.el=e.el,t.targetStart=e.targetStart;const ue=t.anchor=e.anchor,le=t.target=e.target,ge=t.targetAnchor=e.targetAnchor,H=Yd(e.props),U=H?n:le,Q=H?ue:ge;if(o==="svg"||F2(le)?o="svg":(o==="mathml"||j2(le))&&(o="mathml"),te?(x(e.dynamicChildren,te,U,i,s,o,u),ty(e,t,!0)):f||y(e,t,U,Q,i,s,o,u,!1),I)H?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):hg(t,n,ue,d,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const F=t.target=kv(t.props,M);F&&hg(t,F,null,d,0)}else H&&hg(t,le,ge,d,1);Tg(t,I)}},remove(e,t,n,{um:r,o:{remove:i}},s){const{shapeFlag:o,children:u,anchor:f,targetStart:d,targetAnchor:g,target:y,props:x}=e;if(y&&(i(d),i(g)),s&&i(f),o&16){const _=s||!Yd(x);for(let M=0;M<u.length;M++){const T=u[M];r(T,t,n,_,!!T.dynamicChildren)}}},move:hg,hydrate:KP};function hg(e,t,n,{o:{insert:r},m:i},s=2){s===0&&r(e.targetAnchor,t,n);const{el:o,anchor:u,shapeFlag:f,children:d,props:g}=e,y=s===2;if(y&&r(o,t,n),(!y||Yd(g))&&f&16)for(let x=0;x<d.length;x++)i(d[x],t,n,2);y&&r(u,t,n)}function KP(e,t,n,r,i,s,{o:{nextSibling:o,parentNode:u,querySelector:f,insert:d,createText:g}},y){const x=t.target=kv(t.props,f);if(x){const _=Yd(t.props),M=x._lpa||x.firstChild;if(t.shapeFlag&16)if(_)t.anchor=y(o(e),t,u(e),n,r,i,s),t.targetStart=M,t.targetAnchor=M&&o(M);else{t.anchor=o(e);let T=M;for(;T;){if(T&&T.nodeType===8){if(T.data==="teleport start anchor")t.targetStart=T;else if(T.data==="teleport anchor"){t.targetAnchor=T,x._lpa=t.targetAnchor&&o(t.targetAnchor);break}}T=o(T)}t.targetAnchor||Rw(x,t,g,d),y(M&&o(M),t,x,n,r,i,s)}Tg(t,_)}return t.anchor&&o(t.anchor)}const kg=Bw;function Tg(e,t){const n=e.ctx;if(n&&n.ut){let r,i;for(t?(r=e.el,i=e.anchor):(r=e.targetStart,i=e.targetAnchor);r&&r!==i;)r.nodeType===1&&r.setAttribute("data-v-owner",n.uid),r=r.nextSibling;n.ut()}}function Rw(e,t,n,r){const i=t.targetStart=n(""),s=t.targetAnchor=n("");return i[Iw]=s,e&&(r(i,e),r(s,e)),s}const cf=Symbol("_leaveCb"),dg=Symbol("_enterCb");function q1(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return $s(()=>{e.isMounted=!0}),fd(()=>{e.isUnmounting=!0}),e}const au=[Function,Array],W1={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:au,onEnter:au,onAfterEnter:au,onEnterCancelled:au,onBeforeLeave:au,onLeave:au,onAfterLeave:au,onLeaveCancelled:au,onBeforeAppear:au,onAppear:au,onAfterAppear:au,onAppearCancelled:au},Fw=e=>{const t=e.subTree;return t.component?Fw(t.component):t},YP={name:"BaseTransition",props:W1,setup(e,{slots:t}){const n=_u(),r=q1();return()=>{const i=t.default&&zm(t.default(),!0);if(!i||!i.length)return;const s=jw(i),o=Ni(e),{mode:u}=o;if(r.isLeaving)return z0(s);const f=z2(s);if(!f)return z0(s);let d=ed(f,o,r,n,y=>d=y);f.type!==Ds&&Uc(f,d);let g=n.subTree&&z2(n.subTree);if(g&&g.type!==Ds&&!ju(f,g)&&Fw(n).type!==Ds){let y=ed(g,o,r,n);if(Uc(g,y),u==="out-in"&&f.type!==Ds)return r.isLeaving=!0,y.afterLeave=()=>{r.isLeaving=!1,n.job.flags&8||n.update(),delete y.afterLeave,g=void 0},z0(s);u==="in-out"&&f.type!==Ds?y.delayLeave=(x,_,M)=>{const T=$w(r,g);T[String(g.key)]=g,x[cf]=()=>{_(),x[cf]=void 0,delete d.delayedLeave,g=void 0},d.delayedLeave=()=>{M(),delete d.delayedLeave,g=void 0}}:g=void 0}else g&&(g=void 0);return s}}};function jw(e){let t=e[0];if(e.length>1){for(const n of e)if(n.type!==Ds){t=n;break}}return t}const zw=YP;function $w(e,t){const{leavingVNodes:n}=e;let r=n.get(t.type);return r||(r=Object.create(null),n.set(t.type,r)),r}function ed(e,t,n,r,i){const{appear:s,mode:o,persisted:u=!1,onBeforeEnter:f,onEnter:d,onAfterEnter:g,onEnterCancelled:y,onBeforeLeave:x,onLeave:_,onAfterLeave:M,onLeaveCancelled:T,onBeforeAppear:D,onAppear:I,onAfterAppear:j,onAppearCancelled:Z}=t,te=String(e.key),ue=$w(n,e),le=(U,Q)=>{U&&vu(U,r,9,Q)},ge=(U,Q)=>{const F=Q[1];le(U,Q),tr(U)?U.every(B=>B.length<=1)&&F():U.length<=1&&F()},H={mode:o,persisted:u,beforeEnter(U){let Q=f;if(!n.isMounted)if(s)Q=D||f;else return;U[cf]&&U[cf](!0);const F=ue[te];F&&ju(e,F)&&F.el[cf]&&F.el[cf](),le(Q,[U])},enter(U){let Q=d,F=g,B=y;if(!n.isMounted)if(s)Q=I||d,F=j||g,B=Z||y;else return;let R=!1;const $=U[dg]=W=>{R||(R=!0,W?le(B,[U]):le(F,[U]),H.delayedLeave&&H.delayedLeave(),U[dg]=void 0)};Q?ge(Q,[U,$]):$()},leave(U,Q){const F=String(e.key);if(U[dg]&&U[dg](!0),n.isUnmounting)return Q();le(x,[U]);let B=!1;const R=U[cf]=$=>{B||(B=!0,Q(),$?le(T,[U]):le(M,[U]),U[cf]=void 0,ue[F]===e&&delete ue[F])};ue[F]=e,_?ge(_,[U,R]):R()},clone(U){const Q=ed(U,t,n,r,i);return i&&i(Q),Q}};return H}function z0(e){if(Ap(e))return e=vc(e),e.children=null,e}function z2(e){if(!Ap(e))return Ow(e.type)&&e.children?jw(e.children):e;const{shapeFlag:t,children:n}=e;if(n){if(t&16)return n[0];if(t&32&&Tr(n.default))return n.default()}}function Uc(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Uc(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function zm(e,t=!1,n){let r=[],i=0;for(let s=0;s<e.length;s++){let o=e[s];const u=n==null?o.key:String(n)+String(o.key!=null?o.key:s);o.type===Bn?(o.patchFlag&128&&i++,r=r.concat(zm(o.children,t,u))):(t||o.type!==Ds)&&r.push(u!=null?vc(o,{key:u}):o)}if(i>1)for(let s=0;s<r.length;s++)r[s].patchFlag=-2;return r}/*! #__NO_SIDE_EFFECTS__ */function cs(e,t){return Tr(e)?co({name:e.name},t,{setup:e}):e}function JP(){const e=_u();return e?(e.appContext.config.idPrefix||"v")+"-"+e.ids[0]+e.ids[1]++:""}function Z1(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function XP(e){const t=_u(),n=V1(null);if(t){const i=t.refs===Di?t.refs={}:t.refs;Object.defineProperty(i,e,{enumerable:!0,get:()=>n.value,set:s=>n.value=s})}return n}function yp(e,t,n,r,i=!1){if(tr(e)){e.forEach((M,T)=>yp(M,t&&(tr(t)?t[T]:t),n,r,i));return}if(yf(r)&&!i){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&yp(e,t,n,r.component.subTree);return}const s=r.shapeFlag&4?Tp(r.component):r.el,o=i?null:s,{i:u,r:f}=e,d=t&&t.r,g=u.refs===Di?u.refs={}:u.refs,y=u.setupState,x=Ni(y),_=y===Di?()=>!1:M=>Wi(x,M);if(d!=null&&d!==f&&(_o(d)?(g[d]=null,_(d)&&(y[d]=null)):Xo(d)&&(d.value=null)),Tr(f))cd(f,u,12,[o,g]);else{const M=_o(f),T=Xo(f);if(M||T){const D=()=>{if(e.f){const I=M?_(f)?y[f]:g[f]:f.value;i?tr(I)&&D1(I,s):tr(I)?I.includes(s)||I.push(s):M?(g[f]=[s],_(f)&&(y[f]=g[f])):(f.value=[s],e.k&&(g[e.k]=f.value))}else M?(g[f]=o,_(f)&&(y[f]=o)):T&&(f.value=o,e.k&&(g[e.k]=o))};o?(D.id=-1,Fs(D,n)):D()}}}let $2=!1;const Eh=()=>{$2||(console.error("Hydration completed but contains mismatches."),$2=!0)},QP=e=>e.namespaceURI.includes("svg")&&e.tagName!=="foreignObject",eM=e=>e.namespaceURI.includes("MathML"),pg=e=>{if(e.nodeType===1){if(QP(e))return"svg";if(eM(e))return"mathml"}},$h=e=>e.nodeType===8;function tM(e){const{mt:t,p:n,o:{patchProp:r,createText:i,nextSibling:s,parentNode:o,remove:u,insert:f,createComment:d}}=e,g=(Z,te)=>{if(!te.hasChildNodes()){n(null,Z,te),tm(),te._vnode=Z;return}y(te.firstChild,Z,null,null,null),tm(),te._vnode=Z},y=(Z,te,ue,le,ge,H=!1)=>{H=H||!!te.dynamicChildren;const U=$h(Z)&&Z.data==="[",Q=()=>T(Z,te,ue,le,ge,U),{type:F,ref:B,shapeFlag:R,patchFlag:$}=te;let W=Z.nodeType;te.el=Z,$===-2&&(H=!1,te.dynamicChildren=null);let G=null;switch(F){case _f:W!==3?te.children===""?(f(te.el=i(""),o(Z),Z),G=Z):G=Q():(Z.data!==te.children&&(Eh(),Z.data=te.children),G=s(Z));break;case Ds:j(Z)?(G=s(Z),I(te.el=Z.content.firstChild,Z,ue)):W!==8||U?G=Q():G=s(Z);break;case Qf:if(U&&(Z=s(Z),W=Z.nodeType),W===1||W===3){G=Z;const J=!te.children.length;for(let Y=0;Y<te.staticCount;Y++)J&&(te.children+=G.nodeType===1?G.outerHTML:G.data),Y===te.staticCount-1&&(te.anchor=G),G=s(G);return U?s(G):G}else Q();break;case Bn:U?G=M(Z,te,ue,le,ge,H):G=Q();break;default:if(R&1)(W!==1||te.type.toLowerCase()!==Z.tagName.toLowerCase())&&!j(Z)?G=Q():G=x(Z,te,ue,le,ge,H);else if(R&6){te.slotScopeIds=ge;const J=o(Z);if(U?G=D(Z):$h(Z)&&Z.data==="teleport start"?G=D(Z,Z.data,"teleport end"):G=s(Z),t(te,J,null,ue,le,pg(J),H),yf(te)&&!te.type.__asyncResolved){let Y;U?(Y=hi(Bn),Y.anchor=G?G.previousSibling:J.lastChild):Y=Z.nodeType===3?Pi(""):hi("div"),Y.el=Z,te.component.subTree=Y}}else R&64?W!==8?G=Q():G=te.type.hydrate(Z,te,ue,le,ge,H,e,_):R&128&&(G=te.type.hydrate(Z,te,ue,le,pg(o(Z)),ge,H,e,y))}return B!=null&&yp(B,null,le,te),G},x=(Z,te,ue,le,ge,H)=>{H=H||!!te.dynamicChildren;const{type:U,props:Q,patchFlag:F,shapeFlag:B,dirs:R,transition:$}=te,W=U==="input"||U==="option";if(W||F!==-1){R&&lc(te,null,ue,"created");let G=!1;if(j(Z)){G=p4(null,$)&&ue&&ue.vnode.props&&ue.vnode.props.appear;const Y=Z.content.firstChild;G&&$.beforeEnter(Y),I(Y,Z,ue),te.el=Z=Y}if(B&16&&!(Q&&(Q.innerHTML||Q.textContent))){let Y=_(Z.firstChild,te,Z,ue,le,ge,H);for(;Y;){gg(Z,1)||Eh();const pe=Y;Y=Y.nextSibling,u(pe)}}else if(B&8){let Y=te.children;Y[0]===`
`&&(Z.tagName==="PRE"||Z.tagName==="TEXTAREA")&&(Y=Y.slice(1)),Z.textContent!==Y&&(gg(Z,0)||Eh(),Z.textContent=te.children)}if(Q){if(W||!H||F&48){const Y=Z.tagName.includes("-");for(const pe in Q)(W&&(pe.endsWith("value")||pe==="indeterminate")||Pp(pe)&&!qh(pe)||pe[0]==="."||Y)&&r(Z,pe,null,Q[pe],void 0,ue)}else if(Q.onClick)r(Z,"onClick",null,Q.onClick,void 0,ue);else if(F&4&&dc(Q.style))for(const Y in Q.style)Q.style[Y]}let J;(J=Q&&Q.onVnodeBeforeMount)&&xl(J,ue,te),R&&lc(te,null,ue,"beforeMount"),((J=Q&&Q.onVnodeMounted)||R||G)&&L4(()=>{J&&xl(J,ue,te),G&&$.enter(Z),R&&lc(te,null,ue,"mounted")},le)}return Z.nextSibling},_=(Z,te,ue,le,ge,H,U)=>{U=U||!!te.dynamicChildren;const Q=te.children,F=Q.length;for(let B=0;B<F;B++){const R=U?Q[B]:Q[B]=Sl(Q[B]),$=R.type===_f;Z?($&&!U&&B+1<F&&Sl(Q[B+1]).type===_f&&(f(i(Z.data.slice(R.children.length)),ue,s(Z)),Z.data=R.children),Z=y(Z,R,le,ge,H,U)):$&&!R.children?f(R.el=i(""),ue):(gg(ue,1)||Eh(),n(null,R,ue,null,le,ge,pg(ue),H))}return Z},M=(Z,te,ue,le,ge,H)=>{const{slotScopeIds:U}=te;U&&(ge=ge?ge.concat(U):U);const Q=o(Z),F=_(s(Z),te,Q,ue,le,ge,H);return F&&$h(F)&&F.data==="]"?s(te.anchor=F):(Eh(),f(te.anchor=d("]"),Q,F),F)},T=(Z,te,ue,le,ge,H)=>{if(gg(Z.parentElement,1)||Eh(),te.el=null,H){const F=D(Z);for(;;){const B=s(Z);if(B&&B!==F)u(B);else break}}const U=s(Z),Q=o(Z);return u(Z),n(null,te,Q,U,ue,le,pg(Q),ge),ue&&(ue.vnode.el=te.el,Gm(ue,te.el)),U},D=(Z,te="[",ue="]")=>{let le=0;for(;Z;)if(Z=s(Z),Z&&$h(Z)&&(Z.data===te&&le++,Z.data===ue)){if(le===0)return s(Z);le--}return Z},I=(Z,te,ue)=>{const le=te.parentNode;le&&le.replaceChild(Z,te);let ge=ue;for(;ge;)ge.vnode.el===te&&(ge.vnode.el=ge.subTree.el=Z),ge=ge.parent},j=Z=>Z.nodeType===1&&Z.tagName==="TEMPLATE";return[g,y]}const U2="data-allow-mismatch",nM={0:"text",1:"children",2:"class",3:"style",4:"attribute"};function gg(e,t){if(t===0||t===1)for(;e&&!e.hasAttribute(U2);)e=e.parentElement;const n=e&&e.getAttribute(U2);if(n==null)return!1;if(n==="")return!0;{const r=n.split(",");return t===0&&r.includes("children")?!0:n.split(",").includes(nM[t])}}const rM=Tm().requestIdleCallback||(e=>setTimeout(e,1)),iM=Tm().cancelIdleCallback||(e=>clearTimeout(e)),oM=(e=1e4)=>t=>{const n=rM(t,{timeout:e});return()=>iM(n)};function sM(e){const{top:t,left:n,bottom:r,right:i}=e.getBoundingClientRect(),{innerHeight:s,innerWidth:o}=window;return(t>0&&t<s||r>0&&r<s)&&(n>0&&n<o||i>0&&i<o)}const aM=e=>(t,n)=>{const r=new IntersectionObserver(i=>{for(const s of i)if(s.isIntersecting){r.disconnect(),t();break}},e);return n(i=>{if(i instanceof Element){if(sM(i))return t(),r.disconnect(),!1;r.observe(i)}}),()=>r.disconnect()},lM=e=>t=>{if(e){const n=matchMedia(e);if(n.matches)t();else return n.addEventListener("change",t,{once:!0}),()=>n.removeEventListener("change",t)}},uM=(e=[])=>(t,n)=>{_o(e)&&(e=[e]);let r=!1;const i=o=>{r||(r=!0,s(),t(),o.target.dispatchEvent(new o.constructor(o.type,o)))},s=()=>{n(o=>{for(const u of e)o.removeEventListener(u,i)})};return n(o=>{for(const u of e)o.addEventListener(u,i,{once:!0})}),s};function cM(e,t){if($h(e)&&e.data==="["){let n=1,r=e.nextSibling;for(;r;){if(r.nodeType===1){if(t(r)===!1)break}else if($h(r))if(r.data==="]"){if(--n===0)break}else r.data==="["&&n++;r=r.nextSibling}}else t(e)}const yf=e=>!!e.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function fM(e){Tr(e)&&(e={loader:e});const{loader:t,loadingComponent:n,errorComponent:r,delay:i=200,hydrate:s,timeout:o,suspensible:u=!0,onError:f}=e;let d=null,g,y=0;const x=()=>(y++,d=null,_()),_=()=>{let M;return d||(M=d=t().catch(T=>{if(T=T instanceof Error?T:new Error(String(T)),f)return new Promise((D,I)=>{f(T,()=>D(x()),()=>I(T),y+1)});throw T}).then(T=>M!==d&&d?d:(T&&(T.__esModule||T[Symbol.toStringTag]==="Module")&&(T=T.default),g=T,T)))};return cs({name:"AsyncComponentWrapper",__asyncLoader:_,__asyncHydrate(M,T,D){const I=s?()=>{const j=s(D,Z=>cM(M,Z));j&&(T.bum||(T.bum=[])).push(j)}:D;g?I():_().then(()=>!T.isUnmounted&&I())},get __asyncResolved(){return g},setup(){const M=js;if(Z1(M),g)return()=>$0(g,M);const T=Z=>{d=null,ah(Z,M,13,!r)};if(u&&M.suspense||td)return _().then(Z=>()=>$0(Z,M)).catch(Z=>(T(Z),()=>r?hi(r,{error:Z}):null));const D=Ft(!1),I=Ft(),j=Ft(!!i);return i&&setTimeout(()=>{j.value=!1},i),o!=null&&setTimeout(()=>{if(!D.value&&!I.value){const Z=new Error(`Async component timed out after ${o}ms.`);T(Z),I.value=Z}},o),_().then(()=>{D.value=!0,M.parent&&Ap(M.parent.vnode)&&M.parent.update()}).catch(Z=>{T(Z),I.value=Z}),()=>{if(D.value&&g)return $0(g,M);if(I.value&&r)return hi(r,{error:I.value});if(n&&!j.value)return hi(n)}}})}function $0(e,t){const{ref:n,props:r,children:i,ce:s}=t.vnode,o=hi(e,r,i);return o.ref=n,o.ce=s,delete t.vnode.ce,o}const Ap=e=>e.type.__isKeepAlive,hM={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(e,{slots:t}){const n=_u(),r=n.ctx;if(!r.renderer)return()=>{const j=t.default&&t.default();return j&&j.length===1?j[0]:j};const i=new Map,s=new Set;let o=null;const u=n.suspense,{renderer:{p:f,m:d,um:g,o:{createElement:y}}}=r,x=y("div");r.activate=(j,Z,te,ue,le)=>{const ge=j.component;d(j,Z,te,0,u),f(ge.vnode,j,Z,te,ge,u,ue,j.slotScopeIds,le),Fs(()=>{ge.isDeactivated=!1,ge.a&&Wh(ge.a);const H=j.props&&j.props.onVnodeMounted;H&&xl(H,ge.parent,j)},u)},r.deactivate=j=>{const Z=j.component;rm(Z.m),rm(Z.a),d(j,x,null,1,u),Fs(()=>{Z.da&&Wh(Z.da);const te=j.props&&j.props.onVnodeUnmounted;te&&xl(te,Z.parent,j),Z.isDeactivated=!0},u)};function _(j){U0(j),g(j,n,u,!0)}function M(j){i.forEach((Z,te)=>{const ue=Uv(Z.type);ue&&!j(ue)&&T(te)})}function T(j){const Z=i.get(j);Z&&(!o||!ju(Z,o))?_(Z):o&&U0(o),i.delete(j),s.delete(j)}Co(()=>[e.include,e.exclude],([j,Z])=>{j&&M(te=>Bd(j,te)),Z&&M(te=>!Bd(Z,te))},{flush:"post",deep:!0});let D=null;const I=()=>{D!=null&&(im(n.subTree.type)?Fs(()=>{i.set(D,mg(n.subTree))},n.subTree.suspense):i.set(D,mg(n.subTree)))};return $s(I),Um(I),fd(()=>{i.forEach(j=>{const{subTree:Z,suspense:te}=n,ue=mg(Z);if(j.type===ue.type&&j.key===ue.key){U0(ue);const le=ue.component.da;le&&Fs(le,te);return}_(j)})}),()=>{if(D=null,!t.default)return o=null;const j=t.default(),Z=j[0];if(j.length>1)return o=null,j;if(!Vc(Z)||!(Z.shapeFlag&4)&&!(Z.shapeFlag&128))return o=null,Z;let te=mg(Z);if(te.type===Ds)return o=null,te;const ue=te.type,le=Uv(yf(te)?te.type.__asyncResolved||{}:ue),{include:ge,exclude:H,max:U}=e;if(ge&&(!le||!Bd(ge,le))||H&&le&&Bd(H,le))return te.shapeFlag&=-257,o=te,Z;const Q=te.key==null?ue:te.key,F=i.get(Q);return te.el&&(te=vc(te),Z.shapeFlag&128&&(Z.ssContent=te)),D=Q,F?(te.el=F.el,te.component=F.component,te.transition&&Uc(te,te.transition),te.shapeFlag|=512,s.delete(Q),s.add(Q)):(s.add(Q),U&&s.size>parseInt(U,10)&&T(s.values().next().value)),te.shapeFlag|=256,o=te,im(Z.type)?Z:te}}},dM=hM;function Bd(e,t){return tr(e)?e.some(n=>Bd(n,t)):_o(e)?e.split(",").includes(t):VE(e)?(e.lastIndex=0,e.test(t)):!1}function Uw(e,t){Gw(e,"a",t)}function Vw(e,t){Gw(e,"da",t)}function Gw(e,t,n=js){const r=e.__wdc||(e.__wdc=()=>{let i=n;for(;i;){if(i.isDeactivated)return;i=i.parent}return e()});if($m(t,r,n),n){let i=n.parent;for(;i&&i.parent;)Ap(i.parent.vnode)&&pM(r,t,n,i),i=i.parent}}function pM(e,t,n,r){const i=$m(t,e,r,!0);mc(()=>{D1(r[t],i)},n)}function U0(e){e.shapeFlag&=-257,e.shapeFlag&=-513}function mg(e){return e.shapeFlag&128?e.ssContent:e}function $m(e,t,n=js,r=!1){if(n){const i=n[e]||(n[e]=[]),s=t.__weh||(t.__weh=(...o)=>{Mf();const u=ih(n),f=vu(t,n,e,o);return u(),Af(),f});return r?i.unshift(s):i.push(s),s}}const Hc=e=>(t,n=js)=>{(!td||e==="sp")&&$m(e,(...r)=>t(...r),n)},Hw=Hc("bm"),$s=Hc("m"),K1=Hc("bu"),Um=Hc("u"),fd=Hc("bum"),mc=Hc("um"),qw=Hc("sp"),Ww=Hc("rtg"),Zw=Hc("rtc");function Kw(e,t=js){$m("ec",e,t)}const Y1="components",gM="directives";function Yw(e,t){return J1(Y1,e,!0,t)||e}const Jw=Symbol.for("v-ndc");function mM(e){return _o(e)?J1(Y1,e,!1)||e:e||Jw}function vM(e){return J1(gM,e)}function J1(e,t,n=!0,r=!1){const i=zs||js;if(i){const s=i.type;if(e===Y1){const u=Uv(s,!1);if(u&&(u===t||u===ga(t)||u===Mp(ga(t))))return s}const o=V2(i[e]||s[e],t)||V2(i.appContext[e],t);return!o&&r?s:o}}function V2(e,t){return e&&(e[t]||e[ga(t)]||e[Mp(ga(t))])}function Er(e,t,n,r){let i;const s=n&&n[r],o=tr(e);if(o||_o(e)){const u=o&&dc(e);let f=!1;u&&(f=!Wl(e),e=Im(e)),i=new Array(e.length);for(let d=0,g=e.length;d<g;d++)i[d]=t(f?Ba(e[d]):e[d],d,void 0,s&&s[d])}else if(typeof e=="number"){i=new Array(e);for(let u=0;u<e;u++)i[u]=t(u+1,u,void 0,s&&s[u])}else if(Qi(e))if(e[Symbol.iterator])i=Array.from(e,(u,f)=>t(u,f,void 0,s&&s[f]));else{const u=Object.keys(e);i=new Array(u.length);for(let f=0,d=u.length;f<d;f++){const g=u[f];i[f]=t(e[g],g,f,s&&s[f])}}else i=[];return n&&(n[r]=i),i}function yM(e,t){for(let n=0;n<t.length;n++){const r=t[n];if(tr(r))for(let i=0;i<r.length;i++)e[r[i].name]=r[i].fn;else r&&(e[r.name]=r.key?(...i)=>{const s=r.fn(...i);return s&&(s.key=r.key),s}:r.fn)}return e}function _M(e,t,n={},r,i){if(zs.ce||zs.parent&&yf(zs.parent)&&zs.parent.ce)return t!=="default"&&(n.name=t),$e(),$a(Bn,null,[hi("slot",n,r&&r())],64);let s=e[t];s&&s._c&&(s._d=!1),$e();const o=s&&X1(s(n)),u=n.key||o&&o.key,f=$a(Bn,{key:(u&&!Vu(u)?u:`_${t}`)+(!o&&r?"_fb":"")},o||(r?r():[]),o&&e._===1?64:-2);return!i&&f.scopeId&&(f.slotScopeIds=[f.scopeId+"-s"]),s&&s._c&&(s._d=!0),f}function X1(e){return e.some(t=>Vc(t)?!(t.type===Ds||t.type===Bn&&!X1(t.children)):!0)?e:null}function bM(e,t){const n={};for(const r in e)n[t&&/[A-Z]/.test(r)?`on:${r}`:Wd(r)]=e[r];return n}const Tv=e=>e?k4(e)?Tp(e):Tv(e.parent):null,Jd=co(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Tv(e.parent),$root:e=>Tv(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>Q1(e),$forceUpdate:e=>e.f||(e.f=()=>{H1(e.update)}),$nextTick:e=>e.n||(e.n=Xs.bind(e.proxy)),$watch:e=>YM.bind(e)}),V0=(e,t)=>e!==Di&&!e.__isScriptSetup&&Wi(e,t),Nv={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:n,setupState:r,data:i,props:s,accessCache:o,type:u,appContext:f}=e;let d;if(t[0]!=="$"){const _=o[t];if(_!==void 0)switch(_){case 1:return r[t];case 2:return i[t];case 4:return n[t];case 3:return s[t]}else{if(V0(r,t))return o[t]=1,r[t];if(i!==Di&&Wi(i,t))return o[t]=2,i[t];if((d=e.propsOptions[0])&&Wi(d,t))return o[t]=3,s[t];if(n!==Di&&Wi(n,t))return o[t]=4,n[t];Dv&&(o[t]=0)}}const g=Jd[t];let y,x;if(g)return t==="$attrs"&&Oa(e.attrs,"get",""),g(e);if((y=u.__cssModules)&&(y=y[t]))return y;if(n!==Di&&Wi(n,t))return o[t]=4,n[t];if(x=f.config.globalProperties,Wi(x,t))return x[t]},set({_:e},t,n){const{data:r,setupState:i,ctx:s}=e;return V0(i,t)?(i[t]=n,!0):r!==Di&&Wi(r,t)?(r[t]=n,!0):Wi(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(s[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:r,appContext:i,propsOptions:s}},o){let u;return!!n[o]||e!==Di&&Wi(e,o)||V0(t,o)||(u=s[0])&&Wi(u,o)||Wi(r,o)||Wi(Jd,o)||Wi(i.config.globalProperties,o)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:Wi(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}},wM=co({},Nv,{get(e,t){if(t!==Symbol.unscopables)return Nv.get(e,t,e)},has(e,t){return t[0]!=="_"&&!ZE(t)}});function xM(){return null}function LM(){return null}function SM(e){}function CM(e){}function EM(){return null}function PM(){}function MM(e,t){return null}function AM(){return Xw().slots}function kM(){return Xw().attrs}function Xw(){const e=_u();return e.setupContext||(e.setupContext=D4(e))}function _p(e){return tr(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}function TM(e,t){const n=_p(e);for(const r in t){if(r.startsWith("__skip"))continue;let i=n[r];i?tr(i)||Tr(i)?i=n[r]={type:i,default:t[r]}:i.default=t[r]:i===null&&(i=n[r]={default:t[r]}),i&&t[`__skip_${r}`]&&(i.skipFactory=!0)}return n}function NM(e,t){return!e||!t?e||t:tr(e)&&tr(t)?e.concat(t):co({},_p(e),_p(t))}function DM(e,t){const n={};for(const r in e)t.includes(r)||Object.defineProperty(n,r,{enumerable:!0,get:()=>e[r]});return n}function IM(e){const t=_u();let n=e();return jv(),I1(n)&&(n=n.catch(r=>{throw ih(t),r})),[n,()=>ih(t)]}let Dv=!0;function OM(e){const t=Q1(e),n=e.proxy,r=e.ctx;Dv=!1,t.beforeCreate&&G2(t.beforeCreate,e,"bc");const{data:i,computed:s,methods:o,watch:u,provide:f,inject:d,created:g,beforeMount:y,mounted:x,beforeUpdate:_,updated:M,activated:T,deactivated:D,beforeDestroy:I,beforeUnmount:j,destroyed:Z,unmounted:te,render:ue,renderTracked:le,renderTriggered:ge,errorCaptured:H,serverPrefetch:U,expose:Q,inheritAttrs:F,components:B,directives:R,filters:$}=t;if(d&&BM(d,r,null),o)for(const J in o){const Y=o[J];Tr(Y)&&(r[J]=Y.bind(n))}if(i){const J=i.call(n,n);Qi(J)&&(e.data=Yl(J))}if(Dv=!0,s)for(const J in s){const Y=s[J],pe=Tr(Y)?Y.bind(n,n):Tr(Y.get)?Y.get.bind(n,n):gu,Le=!Tr(Y)&&Tr(Y.set)?Y.set.bind(n):gu,De=cr({get:pe,set:Le});Object.defineProperty(r,J,{enumerable:!0,configurable:!0,get:()=>De.value,set:N=>De.value=N})}if(u)for(const J in u)Qw(u[J],r,n,J);if(f){const J=Tr(f)?f.call(n):f;Reflect.ownKeys(J).forEach(Y=>{Xd(Y,J[Y])})}g&&G2(g,e,"c");function G(J,Y){tr(Y)?Y.forEach(pe=>J(pe.bind(n))):Y&&J(Y.bind(n))}if(G(Hw,y),G($s,x),G(K1,_),G(Um,M),G(Uw,T),G(Vw,D),G(Kw,H),G(Zw,le),G(Ww,ge),G(fd,j),G(mc,te),G(qw,U),tr(Q))if(Q.length){const J=e.exposed||(e.exposed={});Q.forEach(Y=>{Object.defineProperty(J,Y,{get:()=>n[Y],set:pe=>n[Y]=pe})})}else e.exposed||(e.exposed={});ue&&e.render===gu&&(e.render=ue),F!=null&&(e.inheritAttrs=F),B&&(e.components=B),R&&(e.directives=R),U&&Z1(e)}function BM(e,t,n=gu){tr(e)&&(e=Iv(e));for(const r in e){const i=e[r];let s;Qi(i)?"default"in i?s=Zl(i.from||r,i.default,!0):s=Zl(i.from||r):s=Zl(i),Xo(s)?Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):t[r]=s}}function G2(e,t,n){vu(tr(e)?e.map(r=>r.bind(t.proxy)):e.bind(t.proxy),t,n)}function Qw(e,t,n,r){let i=r.includes(".")?_4(n,r):()=>n[r];if(_o(e)){const s=t[e];Tr(s)&&Co(i,s)}else if(Tr(e))Co(i,e.bind(n));else if(Qi(e))if(tr(e))e.forEach(s=>Qw(s,t,n,r));else{const s=Tr(e.handler)?e.handler.bind(n):t[e.handler];Tr(s)&&Co(i,s,e)}}function Q1(e){const t=e.type,{mixins:n,extends:r}=t,{mixins:i,optionsCache:s,config:{optionMergeStrategies:o}}=e.appContext,u=s.get(t);let f;return u?f=u:!i.length&&!n&&!r?f=t:(f={},i.length&&i.forEach(d=>nm(f,d,o,!0)),nm(f,t,o)),Qi(t)&&s.set(t,f),f}function nm(e,t,n,r=!1){const{mixins:i,extends:s}=t;s&&nm(e,s,n,!0),i&&i.forEach(o=>nm(e,o,n,!0));for(const o in t)if(!(r&&o==="expose")){const u=RM[o]||n&&n[o];e[o]=u?u(e[o],t[o]):t[o]}return e}const RM={data:H2,props:q2,emits:q2,methods:Rd,computed:Rd,beforeCreate:Ya,created:Ya,beforeMount:Ya,mounted:Ya,beforeUpdate:Ya,updated:Ya,beforeDestroy:Ya,beforeUnmount:Ya,destroyed:Ya,unmounted:Ya,activated:Ya,deactivated:Ya,errorCaptured:Ya,serverPrefetch:Ya,components:Rd,directives:Rd,watch:jM,provide:H2,inject:FM};function H2(e,t){return t?e?function(){return co(Tr(e)?e.call(this,this):e,Tr(t)?t.call(this,this):t)}:t:e}function FM(e,t){return Rd(Iv(e),Iv(t))}function Iv(e){if(tr(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function Ya(e,t){return e?[...new Set([].concat(e,t))]:t}function Rd(e,t){return e?co(Object.create(null),e,t):t}function q2(e,t){return e?tr(e)&&tr(t)?[...new Set([...e,...t])]:co(Object.create(null),_p(e),_p(t??{})):t}function jM(e,t){if(!e)return t;if(!t)return e;const n=co(Object.create(null),e);for(const r in t)n[r]=Ya(e[r],t[r]);return n}function e4(){return{app:null,config:{isNativeTag:$E,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let zM=0;function $M(e,t){return function(r,i=null){Tr(r)||(r=co({},r)),i!=null&&!Qi(i)&&(i=null);const s=e4(),o=new WeakSet,u=[];let f=!1;const d=s.app={_uid:zM++,_component:r,_props:i,_container:null,_context:s,_instance:null,version:O4,get config(){return s.config},set config(g){},use(g,...y){return o.has(g)||(g&&Tr(g.install)?(o.add(g),g.install(d,...y)):Tr(g)&&(o.add(g),g(d,...y))),d},mixin(g){return s.mixins.includes(g)||s.mixins.push(g),d},component(g,y){return y?(s.components[g]=y,d):s.components[g]},directive(g,y){return y?(s.directives[g]=y,d):s.directives[g]},mount(g,y,x){if(!f){const _=d._ceVNode||hi(r,i);return _.appContext=s,x===!0?x="svg":x===!1&&(x=void 0),y&&t?t(_,g):e(_,g,x),f=!0,d._container=g,g.__vue_app__=d,Tp(_.component)}},onUnmount(g){u.push(g)},unmount(){f&&(vu(u,d._instance,16),e(null,d._container),delete d._container.__vue_app__)},provide(g,y){return s.provides[g]=y,d},runWithContext(g){const y=Xf;Xf=d;try{return g()}finally{Xf=y}}};return d}}let Xf=null;function Xd(e,t){if(js){let n=js.provides;const r=js.parent&&js.parent.provides;r===n&&(n=js.provides=Object.create(r)),n[e]=t}}function Zl(e,t,n=!1){const r=js||zs;if(r||Xf){const i=Xf?Xf._context.provides:r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(i&&e in i)return i[e];if(arguments.length>1)return n&&Tr(t)?t.call(r&&r.proxy):t}}function t4(){return!!(js||zs||Xf)}const n4={},r4=()=>Object.create(n4),i4=e=>Object.getPrototypeOf(e)===n4;function UM(e,t,n,r=!1){const i={},s=r4();e.propsDefaults=Object.create(null),o4(e,t,i,s);for(const o in e.propsOptions[0])o in i||(i[o]=void 0);n?e.props=r?i:U1(i):e.type.props?e.props=i:e.props=s,e.attrs=s}function VM(e,t,n,r){const{props:i,attrs:s,vnode:{patchFlag:o}}=e,u=Ni(i),[f]=e.propsOptions;let d=!1;if((r||o>0)&&!(o&16)){if(o&8){const g=e.vnode.dynamicProps;for(let y=0;y<g.length;y++){let x=g[y];if(Vm(e.emitsOptions,x))continue;const _=t[x];if(f)if(Wi(s,x))_!==s[x]&&(s[x]=_,d=!0);else{const M=ga(x);i[M]=Ov(f,u,M,_,e,!1)}else _!==s[x]&&(s[x]=_,d=!0)}}}else{o4(e,t,i,s)&&(d=!0);let g;for(const y in u)(!t||!Wi(t,y)&&((g=Cl(y))===y||!Wi(t,g)))&&(f?n&&(n[y]!==void 0||n[g]!==void 0)&&(i[y]=Ov(f,u,y,void 0,e,!0)):delete i[y]);if(s!==u)for(const y in s)(!t||!Wi(t,y))&&(delete s[y],d=!0)}d&&Rc(e.attrs,"set","")}function o4(e,t,n,r){const[i,s]=e.propsOptions;let o=!1,u;if(t)for(let f in t){if(qh(f))continue;const d=t[f];let g;i&&Wi(i,g=ga(f))?!s||!s.includes(g)?n[g]=d:(u||(u={}))[g]=d:Vm(e.emitsOptions,f)||(!(f in r)||d!==r[f])&&(r[f]=d,o=!0)}if(s){const f=Ni(n),d=u||Di;for(let g=0;g<s.length;g++){const y=s[g];n[y]=Ov(i,f,y,d[y],e,!Wi(d,y))}}return o}function Ov(e,t,n,r,i,s){const o=e[n];if(o!=null){const u=Wi(o,"default");if(u&&r===void 0){const f=o.default;if(o.type!==Function&&!o.skipFactory&&Tr(f)){const{propsDefaults:d}=i;if(n in d)r=d[n];else{const g=ih(i);r=d[n]=f.call(null,t),g()}}else r=f;i.ce&&i.ce._setProp(n,r)}o[0]&&(s&&!u?r=!1:o[1]&&(r===""||r===Cl(n))&&(r=!0))}return r}const GM=new WeakMap;function s4(e,t,n=!1){const r=n?GM:t.propsCache,i=r.get(e);if(i)return i;const s=e.props,o={},u=[];let f=!1;if(!Tr(e)){const g=y=>{f=!0;const[x,_]=s4(y,t,!0);co(o,x),_&&u.push(..._)};!n&&t.mixins.length&&t.mixins.forEach(g),e.extends&&g(e.extends),e.mixins&&e.mixins.forEach(g)}if(!s&&!f)return Qi(e)&&r.set(e,Gh),Gh;if(tr(s))for(let g=0;g<s.length;g++){const y=ga(s[g]);W2(y)&&(o[y]=Di)}else if(s)for(const g in s){const y=ga(g);if(W2(y)){const x=s[g],_=o[y]=tr(x)||Tr(x)?{type:x}:co({},x),M=_.type;let T=!1,D=!0;if(tr(M))for(let I=0;I<M.length;++I){const j=M[I],Z=Tr(j)&&j.name;if(Z==="Boolean"){T=!0;break}else Z==="String"&&(D=!1)}else T=Tr(M)&&M.name==="Boolean";_[0]=T,_[1]=D,(T||Wi(_,"default"))&&u.push(y)}}const d=[o,u];return Qi(e)&&r.set(e,d),d}function W2(e){return e[0]!=="$"&&!qh(e)}const a4=e=>e[0]==="_"||e==="$stable",ey=e=>tr(e)?e.map(Sl):[Sl(e)],HM=(e,t,n)=>{if(t._n)return t;const r=Gl((...i)=>ey(t(...i)),n);return r._c=!1,r},l4=(e,t,n)=>{const r=e._ctx;for(const i in e){if(a4(i))continue;const s=e[i];if(Tr(s))t[i]=HM(i,s,r);else if(s!=null){const o=ey(s);t[i]=()=>o}}},u4=(e,t)=>{const n=ey(t);e.slots.default=()=>n},c4=(e,t,n)=>{for(const r in t)(n||r!=="_")&&(e[r]=t[r])},qM=(e,t,n)=>{const r=e.slots=r4();if(e.vnode.shapeFlag&32){const i=t._;i?(c4(r,t,n),n&&iw(r,"_",i,!0)):l4(t,r)}else t&&u4(e,t)},WM=(e,t,n)=>{const{vnode:r,slots:i}=e;let s=!0,o=Di;if(r.shapeFlag&32){const u=t._;u?n&&u===1?s=!1:c4(i,t,n):(s=!t.$stable,l4(t,i)),o=t}else t&&(u4(e,t),o={default:1});if(s)for(const u in i)!a4(u)&&o[u]==null&&delete i[u]},Fs=L4;function f4(e){return d4(e)}function h4(e){return d4(e,tM)}function d4(e,t){const n=Tm();n.__VUE__=!0;const{insert:r,remove:i,patchProp:s,createElement:o,createText:u,createComment:f,setText:d,setElementText:g,parentNode:y,nextSibling:x,setScopeId:_=gu,insertStaticContent:M}=e,T=(K,de,ye,me=null,Ue=null,Qe=null,Ze=void 0,He=null,Xe=!!de.dynamicChildren)=>{if(K===de)return;K&&!ju(K,de)&&(me=se(K),N(K,Ue,Qe,!0),K=null),de.patchFlag===-2&&(Xe=!1,de.dynamicChildren=null);const{type:tt,ref:Mt,shapeFlag:Lt}=de;switch(tt){case _f:D(K,de,ye,me);break;case Ds:I(K,de,ye,me);break;case Qf:K==null&&j(de,ye,me,Ze);break;case Bn:B(K,de,ye,me,Ue,Qe,Ze,He,Xe);break;default:Lt&1?ue(K,de,ye,me,Ue,Qe,Ze,He,Xe):Lt&6?R(K,de,ye,me,Ue,Qe,Ze,He,Xe):(Lt&64||Lt&128)&&tt.process(K,de,ye,me,Ue,Qe,Ze,He,Xe,ke)}Mt!=null&&Ue&&yp(Mt,K&&K.ref,Qe,de||K,!de)},D=(K,de,ye,me)=>{if(K==null)r(de.el=u(de.children),ye,me);else{const Ue=de.el=K.el;de.children!==K.children&&d(Ue,de.children)}},I=(K,de,ye,me)=>{K==null?r(de.el=f(de.children||""),ye,me):de.el=K.el},j=(K,de,ye,me)=>{[K.el,K.anchor]=M(K.children,de,ye,me,K.el,K.anchor)},Z=({el:K,anchor:de},ye,me)=>{let Ue;for(;K&&K!==de;)Ue=x(K),r(K,ye,me),K=Ue;r(de,ye,me)},te=({el:K,anchor:de})=>{let ye;for(;K&&K!==de;)ye=x(K),i(K),K=ye;i(de)},ue=(K,de,ye,me,Ue,Qe,Ze,He,Xe)=>{de.type==="svg"?Ze="svg":de.type==="math"&&(Ze="mathml"),K==null?le(de,ye,me,Ue,Qe,Ze,He,Xe):U(K,de,Ue,Qe,Ze,He,Xe)},le=(K,de,ye,me,Ue,Qe,Ze,He)=>{let Xe,tt;const{props:Mt,shapeFlag:Lt,transition:jt,dirs:zt}=K;if(Xe=K.el=o(K.type,Qe,Mt&&Mt.is,Mt),Lt&8?g(Xe,K.children):Lt&16&&H(K.children,Xe,null,me,Ue,G0(K,Qe),Ze,He),zt&&lc(K,null,me,"created"),ge(Xe,K,K.scopeId,Ze,me),Mt){for(const pn in Mt)pn!=="value"&&!qh(pn)&&s(Xe,pn,null,Mt[pn],Qe,me);"value"in Mt&&s(Xe,"value",null,Mt.value,Qe),(tt=Mt.onVnodeBeforeMount)&&xl(tt,me,K)}zt&&lc(K,null,me,"beforeMount");const sn=p4(Ue,jt);sn&&jt.beforeEnter(Xe),r(Xe,de,ye),((tt=Mt&&Mt.onVnodeMounted)||sn||zt)&&Fs(()=>{tt&&xl(tt,me,K),sn&&jt.enter(Xe),zt&&lc(K,null,me,"mounted")},Ue)},ge=(K,de,ye,me,Ue)=>{if(ye&&_(K,ye),me)for(let Qe=0;Qe<me.length;Qe++)_(K,me[Qe]);if(Ue){let Qe=Ue.subTree;if(de===Qe||im(Qe.type)&&(Qe.ssContent===de||Qe.ssFallback===de)){const Ze=Ue.vnode;ge(K,Ze,Ze.scopeId,Ze.slotScopeIds,Ue.parent)}}},H=(K,de,ye,me,Ue,Qe,Ze,He,Xe=0)=>{for(let tt=Xe;tt<K.length;tt++){const Mt=K[tt]=He?ff(K[tt]):Sl(K[tt]);T(null,Mt,de,ye,me,Ue,Qe,Ze,He)}},U=(K,de,ye,me,Ue,Qe,Ze)=>{const He=de.el=K.el;let{patchFlag:Xe,dynamicChildren:tt,dirs:Mt}=de;Xe|=K.patchFlag&16;const Lt=K.props||Di,jt=de.props||Di;let zt;if(ye&&zf(ye,!1),(zt=jt.onVnodeBeforeUpdate)&&xl(zt,ye,de,K),Mt&&lc(de,K,ye,"beforeUpdate"),ye&&zf(ye,!0),(Lt.innerHTML&&jt.innerHTML==null||Lt.textContent&&jt.textContent==null)&&g(He,""),tt?Q(K.dynamicChildren,tt,He,ye,me,G0(de,Ue),Qe):Ze||Y(K,de,He,null,ye,me,G0(de,Ue),Qe,!1),Xe>0){if(Xe&16)F(He,Lt,jt,ye,Ue);else if(Xe&2&&Lt.class!==jt.class&&s(He,"class",null,jt.class,Ue),Xe&4&&s(He,"style",Lt.style,jt.style,Ue),Xe&8){const sn=de.dynamicProps;for(let pn=0;pn<sn.length;pn++){const et=sn[pn],ot=Lt[et],rt=jt[et];(rt!==ot||et==="value")&&s(He,et,ot,rt,Ue,ye)}}Xe&1&&K.children!==de.children&&g(He,de.children)}else!Ze&&tt==null&&F(He,Lt,jt,ye,Ue);((zt=jt.onVnodeUpdated)||Mt)&&Fs(()=>{zt&&xl(zt,ye,de,K),Mt&&lc(de,K,ye,"updated")},me)},Q=(K,de,ye,me,Ue,Qe,Ze)=>{for(let He=0;He<de.length;He++){const Xe=K[He],tt=de[He],Mt=Xe.el&&(Xe.type===Bn||!ju(Xe,tt)||Xe.shapeFlag&70)?y(Xe.el):ye;T(Xe,tt,Mt,null,me,Ue,Qe,Ze,!0)}},F=(K,de,ye,me,Ue)=>{if(de!==ye){if(de!==Di)for(const Qe in de)!qh(Qe)&&!(Qe in ye)&&s(K,Qe,de[Qe],null,Ue,me);for(const Qe in ye){if(qh(Qe))continue;const Ze=ye[Qe],He=de[Qe];Ze!==He&&Qe!=="value"&&s(K,Qe,He,Ze,Ue,me)}"value"in ye&&s(K,"value",de.value,ye.value,Ue)}},B=(K,de,ye,me,Ue,Qe,Ze,He,Xe)=>{const tt=de.el=K?K.el:u(""),Mt=de.anchor=K?K.anchor:u("");let{patchFlag:Lt,dynamicChildren:jt,slotScopeIds:zt}=de;zt&&(He=He?He.concat(zt):zt),K==null?(r(tt,ye,me),r(Mt,ye,me),H(de.children||[],ye,Mt,Ue,Qe,Ze,He,Xe)):Lt>0&&Lt&64&&jt&&K.dynamicChildren?(Q(K.dynamicChildren,jt,ye,Ue,Qe,Ze,He),(de.key!=null||Ue&&de===Ue.subTree)&&ty(K,de,!0)):Y(K,de,ye,Mt,Ue,Qe,Ze,He,Xe)},R=(K,de,ye,me,Ue,Qe,Ze,He,Xe)=>{de.slotScopeIds=He,K==null?de.shapeFlag&512?Ue.ctx.activate(de,ye,me,Ze,Xe):$(de,ye,me,Ue,Qe,Ze,Xe):W(K,de,Xe)},$=(K,de,ye,me,Ue,Qe,Ze)=>{const He=K.component=A4(K,me,Ue);if(Ap(K)&&(He.ctx.renderer=ke),T4(He,!1,Ze),He.asyncDep){if(Ue&&Ue.registerDep(He,G,Ze),!K.el){const Xe=He.subTree=hi(Ds);I(null,Xe,de,ye)}}else G(He,K,de,ye,Ue,Qe,Ze)},W=(K,de,ye)=>{const me=de.component=K.component;if(nA(K,de,ye))if(me.asyncDep&&!me.asyncResolved){J(me,de,ye);return}else me.next=de,me.update();else de.el=K.el,me.vnode=de},G=(K,de,ye,me,Ue,Qe,Ze)=>{const He=()=>{if(K.isMounted){let{next:Lt,bu:jt,u:zt,parent:sn,vnode:pn}=K;{const Qt=g4(K);if(Qt){Lt&&(Lt.el=pn.el,J(K,Lt,Ze)),Qt.asyncDep.then(()=>{K.isUnmounted||He()});return}}let et=Lt,ot;zf(K,!1),Lt?(Lt.el=pn.el,J(K,Lt,Ze)):Lt=pn,jt&&Wh(jt),(ot=Lt.props&&Lt.props.onVnodeBeforeUpdate)&&xl(ot,sn,Lt,pn),zf(K,!0);const rt=Ng(K),Ht=K.subTree;K.subTree=rt,T(Ht,rt,y(Ht.el),se(Ht),K,Ue,Qe),Lt.el=rt.el,et===null&&Gm(K,rt.el),zt&&Fs(zt,Ue),(ot=Lt.props&&Lt.props.onVnodeUpdated)&&Fs(()=>xl(ot,sn,Lt,pn),Ue)}else{let Lt;const{el:jt,props:zt}=de,{bm:sn,m:pn,parent:et,root:ot,type:rt}=K,Ht=yf(de);if(zf(K,!1),sn&&Wh(sn),!Ht&&(Lt=zt&&zt.onVnodeBeforeMount)&&xl(Lt,et,de),zf(K,!0),jt&&Ge){const Qt=()=>{K.subTree=Ng(K),Ge(jt,K.subTree,K,Ue,null)};Ht&&rt.__asyncHydrate?rt.__asyncHydrate(jt,K,Qt):Qt()}else{ot.ce&&ot.ce._injectChildStyle(rt);const Qt=K.subTree=Ng(K);T(null,Qt,ye,me,K,Ue,Qe),de.el=Qt.el}if(pn&&Fs(pn,Ue),!Ht&&(Lt=zt&&zt.onVnodeMounted)){const Qt=de;Fs(()=>xl(Lt,et,Qt),Ue)}(de.shapeFlag&256||et&&yf(et.vnode)&&et.vnode.shapeFlag&256)&&K.a&&Fs(K.a,Ue),K.isMounted=!0,de=ye=me=null}};K.scope.on();const Xe=K.effect=new hp(He);K.scope.off();const tt=K.update=Xe.run.bind(Xe),Mt=K.job=Xe.runIfDirty.bind(Xe);Mt.i=K,Mt.id=K.uid,Xe.scheduler=()=>H1(Mt),zf(K,!0),tt()},J=(K,de,ye)=>{de.component=K;const me=K.vnode.props;K.vnode=de,K.next=null,VM(K,de.props,me,ye),WM(K,de.children,ye),Mf(),B2(K),Af()},Y=(K,de,ye,me,Ue,Qe,Ze,He,Xe=!1)=>{const tt=K&&K.children,Mt=K?K.shapeFlag:0,Lt=de.children,{patchFlag:jt,shapeFlag:zt}=de;if(jt>0){if(jt&128){Le(tt,Lt,ye,me,Ue,Qe,Ze,He,Xe);return}else if(jt&256){pe(tt,Lt,ye,me,Ue,Qe,Ze,He,Xe);return}}zt&8?(Mt&16&&_e(tt,Ue,Qe),Lt!==tt&&g(ye,Lt)):Mt&16?zt&16?Le(tt,Lt,ye,me,Ue,Qe,Ze,He,Xe):_e(tt,Ue,Qe,!0):(Mt&8&&g(ye,""),zt&16&&H(Lt,ye,me,Ue,Qe,Ze,He,Xe))},pe=(K,de,ye,me,Ue,Qe,Ze,He,Xe)=>{K=K||Gh,de=de||Gh;const tt=K.length,Mt=de.length,Lt=Math.min(tt,Mt);let jt;for(jt=0;jt<Lt;jt++){const zt=de[jt]=Xe?ff(de[jt]):Sl(de[jt]);T(K[jt],zt,ye,null,Ue,Qe,Ze,He,Xe)}tt>Mt?_e(K,Ue,Qe,!0,!1,Lt):H(de,ye,me,Ue,Qe,Ze,He,Xe,Lt)},Le=(K,de,ye,me,Ue,Qe,Ze,He,Xe)=>{let tt=0;const Mt=de.length;let Lt=K.length-1,jt=Mt-1;for(;tt<=Lt&&tt<=jt;){const zt=K[tt],sn=de[tt]=Xe?ff(de[tt]):Sl(de[tt]);if(ju(zt,sn))T(zt,sn,ye,null,Ue,Qe,Ze,He,Xe);else break;tt++}for(;tt<=Lt&&tt<=jt;){const zt=K[Lt],sn=de[jt]=Xe?ff(de[jt]):Sl(de[jt]);if(ju(zt,sn))T(zt,sn,ye,null,Ue,Qe,Ze,He,Xe);else break;Lt--,jt--}if(tt>Lt){if(tt<=jt){const zt=jt+1,sn=zt<Mt?de[zt].el:me;for(;tt<=jt;)T(null,de[tt]=Xe?ff(de[tt]):Sl(de[tt]),ye,sn,Ue,Qe,Ze,He,Xe),tt++}}else if(tt>jt)for(;tt<=Lt;)N(K[tt],Ue,Qe,!0),tt++;else{const zt=tt,sn=tt,pn=new Map;for(tt=sn;tt<=jt;tt++){const Tn=de[tt]=Xe?ff(de[tt]):Sl(de[tt]);Tn.key!=null&&pn.set(Tn.key,tt)}let et,ot=0;const rt=jt-sn+1;let Ht=!1,Qt=0;const On=new Array(rt);for(tt=0;tt<rt;tt++)On[tt]=0;for(tt=zt;tt<=Lt;tt++){const Tn=K[tt];if(ot>=rt){N(Tn,Ue,Qe,!0);continue}let ar;if(Tn.key!=null)ar=pn.get(Tn.key);else for(et=sn;et<=jt;et++)if(On[et-sn]===0&&ju(Tn,de[et])){ar=et;break}ar===void 0?N(Tn,Ue,Qe,!0):(On[ar-sn]=tt+1,ar>=Qt?Qt=ar:Ht=!0,T(Tn,de[ar],ye,null,Ue,Qe,Ze,He,Xe),ot++)}const wn=Ht?ZM(On):Gh;for(et=wn.length-1,tt=rt-1;tt>=0;tt--){const Tn=sn+tt,ar=de[Tn],xn=Tn+1<Mt?de[Tn+1].el:me;On[tt]===0?T(null,ar,ye,xn,Ue,Qe,Ze,He,Xe):Ht&&(et<0||tt!==wn[et]?De(ar,ye,xn,2):et--)}}},De=(K,de,ye,me,Ue=null)=>{const{el:Qe,type:Ze,transition:He,children:Xe,shapeFlag:tt}=K;if(tt&6){De(K.component.subTree,de,ye,me);return}if(tt&128){K.suspense.move(de,ye,me);return}if(tt&64){Ze.move(K,de,ye,ke);return}if(Ze===Bn){r(Qe,de,ye);for(let Lt=0;Lt<Xe.length;Lt++)De(Xe[Lt],de,ye,me);r(K.anchor,de,ye);return}if(Ze===Qf){Z(K,de,ye);return}if(me!==2&&tt&1&&He)if(me===0)He.beforeEnter(Qe),r(Qe,de,ye),Fs(()=>He.enter(Qe),Ue);else{const{leave:Lt,delayLeave:jt,afterLeave:zt}=He,sn=()=>r(Qe,de,ye),pn=()=>{Lt(Qe,()=>{sn(),zt&&zt()})};jt?jt(Qe,sn,pn):pn()}else r(Qe,de,ye)},N=(K,de,ye,me=!1,Ue=!1)=>{const{type:Qe,props:Ze,ref:He,children:Xe,dynamicChildren:tt,shapeFlag:Mt,patchFlag:Lt,dirs:jt,cacheIndex:zt}=K;if(Lt===-2&&(Ue=!1),He!=null&&yp(He,null,ye,K,!0),zt!=null&&(de.renderCache[zt]=void 0),Mt&256){de.ctx.deactivate(K);return}const sn=Mt&1&&jt,pn=!yf(K);let et;if(pn&&(et=Ze&&Ze.onVnodeBeforeUnmount)&&xl(et,de,K),Mt&6)ce(K.component,ye,me);else{if(Mt&128){K.suspense.unmount(ye,me);return}sn&&lc(K,null,de,"beforeUnmount"),Mt&64?K.type.remove(K,de,ye,ke,me):tt&&!tt.hasOnce&&(Qe!==Bn||Lt>0&&Lt&64)?_e(tt,de,ye,!1,!0):(Qe===Bn&&Lt&384||!Ue&&Mt&16)&&_e(Xe,de,ye),me&&ee(K)}(pn&&(et=Ze&&Ze.onVnodeUnmounted)||sn)&&Fs(()=>{et&&xl(et,de,K),sn&&lc(K,null,de,"unmounted")},ye)},ee=K=>{const{type:de,el:ye,anchor:me,transition:Ue}=K;if(de===Bn){fe(ye,me);return}if(de===Qf){te(K);return}const Qe=()=>{i(ye),Ue&&!Ue.persisted&&Ue.afterLeave&&Ue.afterLeave()};if(K.shapeFlag&1&&Ue&&!Ue.persisted){const{leave:Ze,delayLeave:He}=Ue,Xe=()=>Ze(ye,Qe);He?He(K.el,Qe,Xe):Xe()}else Qe()},fe=(K,de)=>{let ye;for(;K!==de;)ye=x(K),i(K),K=ye;i(de)},ce=(K,de,ye)=>{const{bum:me,scope:Ue,job:Qe,subTree:Ze,um:He,m:Xe,a:tt}=K;rm(Xe),rm(tt),me&&Wh(me),Ue.stop(),Qe&&(Qe.flags|=8,N(Ze,K,de,ye)),He&&Fs(He,de),Fs(()=>{K.isUnmounted=!0},de),de&&de.pendingBranch&&!de.isUnmounted&&K.asyncDep&&!K.asyncResolved&&K.suspenseId===de.pendingId&&(de.deps--,de.deps===0&&de.resolve())},_e=(K,de,ye,me=!1,Ue=!1,Qe=0)=>{for(let Ze=Qe;Ze<K.length;Ze++)N(K[Ze],de,ye,me,Ue)},se=K=>{if(K.shapeFlag&6)return se(K.component.subTree);if(K.shapeFlag&128)return K.suspense.next();const de=x(K.anchor||K.el),ye=de&&de[Iw];return ye?x(ye):de};let k=!1;const ae=(K,de,ye)=>{K==null?de._vnode&&N(de._vnode,null,null,!0):T(de._vnode||null,K,de,null,null,null,ye),de._vnode=K,k||(k=!0,B2(),tm(),k=!1)},ke={p:T,um:N,m:De,r:ee,mt:$,mc:H,pc:Y,pbc:Q,n:se,o:e};let Pe,Ge;return t&&([Pe,Ge]=t(ke)),{render:ae,hydrate:Pe,createApp:$M(ae,Pe)}}function G0({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function zf({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function p4(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function ty(e,t,n=!1){const r=e.children,i=t.children;if(tr(r)&&tr(i))for(let s=0;s<r.length;s++){const o=r[s];let u=i[s];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=i[s]=ff(i[s]),u.el=o.el),!n&&u.patchFlag!==-2&&ty(o,u)),u.type===_f&&(u.el=o.el)}}function ZM(e){const t=e.slice(),n=[0];let r,i,s,o,u;const f=e.length;for(r=0;r<f;r++){const d=e[r];if(d!==0){if(i=n[n.length-1],e[i]<d){t[r]=i,n.push(r);continue}for(s=0,o=n.length-1;s<o;)u=s+o>>1,e[n[u]]<d?s=u+1:o=u;d<e[n[s]]&&(s>0&&(t[r]=n[s-1]),n[s]=r)}}for(s=n.length,o=n[s-1];s-- >0;)n[s]=o,o=t[o];return n}function g4(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:g4(t)}function rm(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const m4=Symbol.for("v-scx"),v4=()=>Zl(m4);function bp(e,t){return kp(e,null,t)}function KM(e,t){return kp(e,null,{flush:"post"})}function y4(e,t){return kp(e,null,{flush:"sync"})}function Co(e,t,n){return kp(e,t,n)}function kp(e,t,n=Di){const{immediate:r,deep:i,flush:s,once:o}=n,u=co({},n),f=t&&r||!t&&s!=="post";let d;if(td){if(s==="sync"){const _=v4();d=_.__watcherHandles||(_.__watcherHandles=[])}else if(!f){const _=()=>{};return _.stop=gu,_.resume=gu,_.pause=gu,_}}const g=js;u.call=(_,M,T)=>vu(_,g,M,T);let y=!1;s==="post"?u.scheduler=_=>{Fs(_,g&&g.suspense)}:s!=="sync"&&(y=!0,u.scheduler=(_,M)=>{M?_():H1(_)}),u.augmentJob=_=>{t&&(_.flags|=4),y&&(_.flags|=2,g&&(_.id=g.uid,_.i=g))};const x=FP(e,t,u);return td&&(d?d.push(x):f&&x()),x}function YM(e,t,n){const r=this.proxy,i=_o(e)?e.includes(".")?_4(r,e):()=>r[e]:e.bind(r,r);let s;Tr(t)?s=t:(s=t.handler,n=t);const o=ih(this),u=kp(i,s.bind(r),n);return o(),u}function _4(e,t){const n=t.split(".");return()=>{let r=e;for(let i=0;i<n.length&&r;i++)r=r[n[i]];return r}}function JM(e,t,n=Di){const r=_u(),i=ga(t),s=Cl(t),o=b4(e,i),u=Cw((f,d)=>{let g,y=Di,x;return y4(()=>{const _=e[i];nl(g,_)&&(g=_,d())}),{get(){return f(),n.get?n.get(g):g},set(_){const M=n.set?n.set(_):_;if(!nl(M,g)&&!(y!==Di&&nl(_,y)))return;const T=r.vnode.props;T&&(t in T||i in T||s in T)&&(`onUpdate:${t}`in T||`onUpdate:${i}`in T||`onUpdate:${s}`in T)||(g=_,d()),r.emit(`update:${t}`,M),nl(_,M)&&nl(_,y)&&!nl(M,x)&&d(),y=_,x=M}}});return u[Symbol.iterator]=()=>{let f=0;return{next(){return f<2?{value:f++?o||Di:u,done:!1}:{done:!0}}}},u}const b4=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${ga(t)}Modifiers`]||e[`${Cl(t)}Modifiers`];function XM(e,t,...n){if(e.isUnmounted)return;const r=e.vnode.props||Di;let i=n;const s=t.startsWith("update:"),o=s&&b4(r,t.slice(7));o&&(o.trim&&(i=n.map(g=>_o(g)?g.trim():g)),o.number&&(i=n.map(Yg)));let u,f=r[u=Wd(t)]||r[u=Wd(ga(t))];!f&&s&&(f=r[u=Wd(Cl(t))]),f&&vu(f,e,6,i);const d=r[u+"Once"];if(d){if(!e.emitted)e.emitted={};else if(e.emitted[u])return;e.emitted[u]=!0,vu(d,e,6,i)}}function w4(e,t,n=!1){const r=t.emitsCache,i=r.get(e);if(i!==void 0)return i;const s=e.emits;let o={},u=!1;if(!Tr(e)){const f=d=>{const g=w4(d,t,!0);g&&(u=!0,co(o,g))};!n&&t.mixins.length&&t.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}return!s&&!u?(Qi(e)&&r.set(e,null),null):(tr(s)?s.forEach(f=>o[f]=null):co(o,s),Qi(e)&&r.set(e,o),o)}function Vm(e,t){return!e||!Pp(t)?!1:(t=t.slice(2).replace(/Once$/,""),Wi(e,t[0].toLowerCase()+t.slice(1))||Wi(e,Cl(t))||Wi(e,t))}function Ng(e){const{type:t,vnode:n,proxy:r,withProxy:i,propsOptions:[s],slots:o,attrs:u,emit:f,render:d,renderCache:g,props:y,data:x,setupState:_,ctx:M,inheritAttrs:T}=e,D=vp(e);let I,j;try{if(n.shapeFlag&4){const te=i||r,ue=te;I=Sl(d.call(ue,te,g,y,_,x,M)),j=u}else{const te=t;I=Sl(te.length>1?te(y,{attrs:u,slots:o,emit:f}):te(y,null)),j=t.props?u:eA(u)}}catch(te){Qd.length=0,ah(te,e,1),I=hi(Ds)}let Z=I;if(j&&T!==!1){const te=Object.keys(j),{shapeFlag:ue}=Z;te.length&&ue&7&&(s&&te.some(N1)&&(j=tA(j,s)),Z=vc(Z,j,!1,!0))}return n.dirs&&(Z=vc(Z,null,!1,!0),Z.dirs=Z.dirs?Z.dirs.concat(n.dirs):n.dirs),n.transition&&Uc(Z,n.transition),I=Z,vp(D),I}function QM(e,t=!0){let n;for(let r=0;r<e.length;r++){const i=e[r];if(Vc(i)){if(i.type!==Ds||i.children==="v-if"){if(n)return;n=i}}else return}return n}const eA=e=>{let t;for(const n in e)(n==="class"||n==="style"||Pp(n))&&((t||(t={}))[n]=e[n]);return t},tA=(e,t)=>{const n={};for(const r in e)(!N1(r)||!(r.slice(9)in t))&&(n[r]=e[r]);return n};function nA(e,t,n){const{props:r,children:i,component:s}=e,{props:o,children:u,patchFlag:f}=t,d=s.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&f>=0){if(f&1024)return!0;if(f&16)return r?Z2(r,o,d):!!o;if(f&8){const g=t.dynamicProps;for(let y=0;y<g.length;y++){const x=g[y];if(o[x]!==r[x]&&!Vm(d,x))return!0}}}else return(i||u)&&(!u||!u.$stable)?!0:r===o?!1:r?o?Z2(r,o,d):!0:!!o;return!1}function Z2(e,t,n){const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!0;for(let i=0;i<r.length;i++){const s=r[i];if(t[s]!==e[s]&&!Vm(n,s))return!0}return!1}function Gm({vnode:e,parent:t},n){for(;t;){const r=t.subTree;if(r.suspense&&r.suspense.activeBranch===e&&(r.el=e.el),r===e)(e=t.vnode).el=n,t=t.parent;else break}}const im=e=>e.__isSuspense;let Bv=0;const rA={name:"Suspense",__isSuspense:!0,process(e,t,n,r,i,s,o,u,f,d){if(e==null)oA(t,n,r,i,s,o,u,f,d);else{if(s&&s.deps>0&&!e.suspense.isInFallback){t.suspense=e.suspense,t.suspense.vnode=t,t.el=e.el;return}sA(e,t,n,r,i,o,u,f,d)}},hydrate:aA,normalize:lA},iA=rA;function wp(e,t){const n=e.props&&e.props[t];Tr(n)&&n()}function oA(e,t,n,r,i,s,o,u,f){const{p:d,o:{createElement:g}}=f,y=g("div"),x=e.suspense=x4(e,i,r,t,y,n,s,o,u,f);d(null,x.pendingBranch=e.ssContent,y,null,r,x,s,o),x.deps>0?(wp(e,"onPending"),wp(e,"onFallback"),d(null,e.ssFallback,t,n,r,null,s,o),Kh(x,e.ssFallback)):x.resolve(!1,!0)}function sA(e,t,n,r,i,s,o,u,{p:f,um:d,o:{createElement:g}}){const y=t.suspense=e.suspense;y.vnode=t,t.el=e.el;const x=t.ssContent,_=t.ssFallback,{activeBranch:M,pendingBranch:T,isInFallback:D,isHydrating:I}=y;if(T)y.pendingBranch=x,ju(x,T)?(f(T,x,y.hiddenContainer,null,i,y,s,o,u),y.deps<=0?y.resolve():D&&(I||(f(M,_,n,r,i,null,s,o,u),Kh(y,_)))):(y.pendingId=Bv++,I?(y.isHydrating=!1,y.activeBranch=T):d(T,i,y),y.deps=0,y.effects.length=0,y.hiddenContainer=g("div"),D?(f(null,x,y.hiddenContainer,null,i,y,s,o,u),y.deps<=0?y.resolve():(f(M,_,n,r,i,null,s,o,u),Kh(y,_))):M&&ju(x,M)?(f(M,x,n,r,i,y,s,o,u),y.resolve(!0)):(f(null,x,y.hiddenContainer,null,i,y,s,o,u),y.deps<=0&&y.resolve()));else if(M&&ju(x,M))f(M,x,n,r,i,y,s,o,u),Kh(y,x);else if(wp(t,"onPending"),y.pendingBranch=x,x.shapeFlag&512?y.pendingId=x.component.suspenseId:y.pendingId=Bv++,f(null,x,y.hiddenContainer,null,i,y,s,o,u),y.deps<=0)y.resolve();else{const{timeout:j,pendingId:Z}=y;j>0?setTimeout(()=>{y.pendingId===Z&&y.fallback(_)},j):j===0&&y.fallback(_)}}function x4(e,t,n,r,i,s,o,u,f,d,g=!1){const{p:y,m:x,um:_,n:M,o:{parentNode:T,remove:D}}=d;let I;const j=uA(e);j&&t&&t.pendingBranch&&(I=t.pendingId,t.deps++);const Z=e.props?Jg(e.props.timeout):void 0,te=s,ue={vnode:e,parent:t,parentComponent:n,namespace:o,container:r,hiddenContainer:i,deps:0,pendingId:Bv++,timeout:typeof Z=="number"?Z:-1,activeBranch:null,pendingBranch:null,isInFallback:!g,isHydrating:g,isUnmounted:!1,effects:[],resolve(le=!1,ge=!1){const{vnode:H,activeBranch:U,pendingBranch:Q,pendingId:F,effects:B,parentComponent:R,container:$}=ue;let W=!1;ue.isHydrating?ue.isHydrating=!1:le||(W=U&&Q.transition&&Q.transition.mode==="out-in",W&&(U.transition.afterLeave=()=>{F===ue.pendingId&&(x(Q,$,s===te?M(U):s,0),gp(B))}),U&&(T(U.el)===$&&(s=M(U)),_(U,R,ue,!0)),W||x(Q,$,s,0)),Kh(ue,Q),ue.pendingBranch=null,ue.isInFallback=!1;let G=ue.parent,J=!1;for(;G;){if(G.pendingBranch){G.effects.push(...B),J=!0;break}G=G.parent}!J&&!W&&gp(B),ue.effects=[],j&&t&&t.pendingBranch&&I===t.pendingId&&(t.deps--,t.deps===0&&!ge&&t.resolve()),wp(H,"onResolve")},fallback(le){if(!ue.pendingBranch)return;const{vnode:ge,activeBranch:H,parentComponent:U,container:Q,namespace:F}=ue;wp(ge,"onFallback");const B=M(H),R=()=>{ue.isInFallback&&(y(null,le,Q,B,U,null,F,u,f),Kh(ue,le))},$=le.transition&&le.transition.mode==="out-in";$&&(H.transition.afterLeave=R),ue.isInFallback=!0,_(H,U,null,!0),$||R()},move(le,ge,H){ue.activeBranch&&x(ue.activeBranch,le,ge,H),ue.container=le},next(){return ue.activeBranch&&M(ue.activeBranch)},registerDep(le,ge,H){const U=!!ue.pendingBranch;U&&ue.deps++;const Q=le.vnode.el;le.asyncDep.catch(F=>{ah(F,le,0)}).then(F=>{if(le.isUnmounted||ue.isUnmounted||ue.pendingId!==le.suspenseId)return;le.asyncResolved=!0;const{vnode:B}=le;zv(le,F,!1),Q&&(B.el=Q);const R=!Q&&le.subTree.el;ge(le,B,T(Q||le.subTree.el),Q?null:M(le.subTree),ue,o,H),R&&D(R),Gm(le,B.el),U&&--ue.deps===0&&ue.resolve()})},unmount(le,ge){ue.isUnmounted=!0,ue.activeBranch&&_(ue.activeBranch,n,le,ge),ue.pendingBranch&&_(ue.pendingBranch,n,le,ge)}};return ue}function aA(e,t,n,r,i,s,o,u,f){const d=t.suspense=x4(t,r,n,e.parentNode,document.createElement("div"),null,i,s,o,u,!0),g=f(e,d.pendingBranch=t.ssContent,n,d,s,o);return d.deps===0&&d.resolve(!1,!0),g}function lA(e){const{shapeFlag:t,children:n}=e,r=t&32;e.ssContent=K2(r?n.default:n),e.ssFallback=r?K2(n.fallback):hi(Ds)}function K2(e){let t;if(Tr(e)){const n=rh&&e._c;n&&(e._d=!1,$e()),e=e(),n&&(e._d=!0,t=za,S4())}return tr(e)&&(e=QM(e)),e=Sl(e),t&&!e.dynamicChildren&&(e.dynamicChildren=t.filter(n=>n!==e)),e}function L4(e,t){t&&t.pendingBranch?tr(e)?t.effects.push(...e):t.effects.push(e):gp(e)}function Kh(e,t){e.activeBranch=t;const{vnode:n,parentComponent:r}=e;let i=t.el;for(;!i&&t.component;)t=t.component.subTree,i=t.el;n.el=i,r&&r.subTree===n&&(r.vnode.el=i,Gm(r,i))}function uA(e){const t=e.props&&e.props.suspensible;return t!=null&&t!==!1}const Bn=Symbol.for("v-fgt"),_f=Symbol.for("v-txt"),Ds=Symbol.for("v-cmt"),Qf=Symbol.for("v-stc"),Qd=[];let za=null;function $e(e=!1){Qd.push(za=e?null:[])}function S4(){Qd.pop(),za=Qd[Qd.length-1]||null}let rh=1;function Rv(e,t=!1){rh+=e,e<0&&za&&t&&(za.hasOnce=!0)}function C4(e){return e.dynamicChildren=rh>0?za||Gh:null,S4(),rh>0&&za&&za.push(e),e}function qe(e,t,n,r,i,s){return C4(E(e,t,n,r,i,s,!0))}function $a(e,t,n,r,i){return C4(hi(e,t,n,r,i,!0))}function Vc(e){return e?e.__v_isVNode===!0:!1}function ju(e,t){return e.type===t.type&&e.key===t.key}function cA(e){}const E4=({key:e})=>e??null,Dg=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?_o(e)||Xo(e)||Tr(e)?{i:zs,r:e,k:t,f:!!n}:e:null);function E(e,t=null,n=null,r=0,i=null,s=e===Bn?0:1,o=!1,u=!1){const f={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&E4(t),ref:t&&Dg(t),scopeId:jm,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:zs};return u?(ny(f,n),s&128&&e.normalize(f)):n&&(f.shapeFlag|=_o(n)?8:16),rh>0&&!o&&za&&(f.patchFlag>0||s&6)&&f.patchFlag!==32&&za.push(f),f}const hi=fA;function fA(e,t=null,n=null,r=0,i=null,s=!1){if((!e||e===Jw)&&(e=Ds),Vc(e)){const u=vc(e,t,!0);return n&&ny(u,n),rh>0&&!s&&za&&(u.shapeFlag&6?za[za.indexOf(e)]=u:za.push(u)),u.patchFlag=-2,u}if(yA(e)&&(e=e.__vccOpts),t){t=P4(t);let{class:u,style:f}=t;u&&!_o(u)&&(t.class=Bi(u)),Qi(f)&&(Rm(f)&&!tr(f)&&(f=co({},f)),t.style=ql(f))}const o=_o(e)?1:im(e)?128:Ow(e)?64:Qi(e)?4:Tr(e)?2:0;return E(e,t,n,r,i,o,s,!0)}function P4(e){return e?Rm(e)||i4(e)?co({},e):e:null}function vc(e,t,n=!1,r=!1){const{props:i,ref:s,patchFlag:o,children:u,transition:f}=e,d=t?M4(i||{},t):i,g={__v_isVNode:!0,__v_skip:!0,type:e.type,props:d,key:d&&E4(d),ref:t&&t.ref?n&&s?tr(s)?s.concat(Dg(t)):[s,Dg(t)]:Dg(t):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:u,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Bn?o===-1?16:o|16:o,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:f,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&vc(e.ssContent),ssFallback:e.ssFallback&&vc(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return f&&r&&Uc(g,f.clone(g)),g}function Pi(e=" ",t=0){return hi(_f,null,e,t)}function cc(e,t){const n=hi(Qf,null,e);return n.staticCount=t,n}function dn(e="",t=!1){return t?($e(),$a(Ds,null,e)):hi(Ds,null,e)}function Sl(e){return e==null||typeof e=="boolean"?hi(Ds):tr(e)?hi(Bn,null,e.slice()):Vc(e)?ff(e):hi(_f,null,String(e))}function ff(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:vc(e)}function ny(e,t){let n=0;const{shapeFlag:r}=e;if(t==null)t=null;else if(tr(t))n=16;else if(typeof t=="object")if(r&65){const i=t.default;i&&(i._c&&(i._d=!1),ny(e,i()),i._c&&(i._d=!0));return}else{n=32;const i=t._;!i&&!i4(t)?t._ctx=zs:i===3&&zs&&(zs.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else Tr(t)?(t={default:t,_ctx:zs},n=32):(t=String(t),r&64?(n=16,t=[Pi(t)]):n=8);e.children=t,e.shapeFlag|=n}function M4(...e){const t={};for(let n=0;n<e.length;n++){const r=e[n];for(const i in r)if(i==="class")t.class!==r.class&&(t.class=Bi([t.class,r.class]));else if(i==="style")t.style=ql([t.style,r.style]);else if(Pp(i)){const s=t[i],o=r[i];o&&s!==o&&!(tr(s)&&s.includes(o))&&(t[i]=s?[].concat(s,o):o)}else i!==""&&(t[i]=r[i])}return t}function xl(e,t,n,r=null){vu(e,t,7,[n,r])}const hA=e4();let dA=0;function A4(e,t,n){const r=e.type,i=(t?t.appContext:e.appContext)||hA,s={uid:dA++,vnode:e,type:r,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new B1(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:s4(r,i),emitsOptions:w4(r,i),emit:null,emitted:null,propsDefaults:Di,inheritAttrs:r.inheritAttrs,ctx:Di,data:Di,props:Di,attrs:Di,slots:Di,refs:Di,setupState:Di,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=t?t.root:s,s.emit=XM.bind(null,s),e.ce&&e.ce(s),s}let js=null;const _u=()=>js||zs;let om,Fv;{const e=Tm(),t=(n,r)=>{let i;return(i=e[n])||(i=e[n]=[]),i.push(r),s=>{i.length>1?i.forEach(o=>o(s)):i[0](s)}};om=t("__VUE_INSTANCE_SETTERS__",n=>js=n),Fv=t("__VUE_SSR_SETTERS__",n=>td=n)}const ih=e=>{const t=js;return om(e),e.scope.on(),()=>{e.scope.off(),om(t)}},jv=()=>{js&&js.scope.off(),om(null)};function k4(e){return e.vnode.shapeFlag&4}let td=!1;function T4(e,t=!1,n=!1){t&&Fv(t);const{props:r,children:i}=e.vnode,s=k4(e);UM(e,r,s,t),qM(e,i,n);const o=s?pA(e,t):void 0;return t&&Fv(!1),o}function pA(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Nv);const{setup:r}=n;if(r){Mf();const i=e.setupContext=r.length>1?D4(e):null,s=ih(e),o=cd(r,e,0,[e.props,i]),u=I1(o);if(Af(),s(),(u||e.sp)&&!yf(e)&&Z1(e),u){if(o.then(jv,jv),t)return o.then(f=>{zv(e,f,t)}).catch(f=>{ah(f,e,0)});e.asyncDep=o}else zv(e,o,t)}else N4(e,t)}function zv(e,t,n){Tr(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Qi(t)&&(e.setupState=G1(t)),N4(e,n)}let sm,$v;function gA(e){sm=e,$v=t=>{t.render._rc&&(t.withProxy=new Proxy(t.ctx,wM))}}const mA=()=>!sm;function N4(e,t,n){const r=e.type;if(!e.render){if(!t&&sm&&!r.render){const i=r.template||Q1(e).template;if(i){const{isCustomElement:s,compilerOptions:o}=e.appContext.config,{delimiters:u,compilerOptions:f}=r,d=co(co({isCustomElement:s,delimiters:u},o),f);r.render=sm(i,d)}}e.render=r.render||gu,$v&&$v(e)}{const i=ih(e);Mf();try{OM(e)}finally{Af(),i()}}}const vA={get(e,t){return Oa(e,"get",""),e[t]}};function D4(e){const t=n=>{e.exposed=n||{}};return{attrs:new Proxy(e.attrs,vA),slots:e.slots,emit:e.emit,expose:t}}function Tp(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(G1(Fm(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in Jd)return Jd[n](e)},has(t,n){return n in t||n in Jd}})):e.proxy}function Uv(e,t=!0){return Tr(e)?e.displayName||e.name:e.name||t&&e.__name}function yA(e){return Tr(e)&&"__vccOpts"in e}const cr=(e,t)=>IP(e,t,td);function Hm(e,t,n){const r=arguments.length;return r===2?Qi(t)&&!tr(t)?Vc(t)?hi(e,null,[t]):hi(e,t):hi(e,null,t):(r>3?n=Array.prototype.slice.call(arguments,2):r===3&&Vc(n)&&(n=[n]),hi(e,t,n))}function _A(){}function bA(e,t,n,r){const i=n[r];if(i&&I4(i,e))return i;const s=t();return s.memo=e.slice(),s.cacheIndex=r,n[r]=s}function I4(e,t){const n=e.memo;if(n.length!=t.length)return!1;for(let r=0;r<n.length;r++)if(nl(n[r],t[r]))return!1;return rh>0&&za&&za.push(e),!0}const O4="3.5.13",wA=gu,xA=VP,LA=Oh,SA=Dw,CA={createComponentInstance:A4,setupComponent:T4,renderComponentRoot:Ng,setCurrentRenderingInstance:vp,isVNode:Vc,normalizeVNode:Sl,getComponentPublicInstance:Tp,ensureValidVNode:X1,pushWarningContext:jP,popWarningContext:zP},EA=CA,PA=null,MA=null,AA=null;/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Vv;const Y2=typeof window<"u"&&window.trustedTypes;if(Y2)try{Vv=Y2.createPolicy("vue",{createHTML:e=>e})}catch{}const B4=Vv?e=>Vv.createHTML(e):e=>e,kA="http://www.w3.org/2000/svg",TA="http://www.w3.org/1998/Math/MathML",Bc=typeof document<"u"?document:null,J2=Bc&&Bc.createElement("template"),NA={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,r)=>{const i=t==="svg"?Bc.createElementNS(kA,e):t==="mathml"?Bc.createElementNS(TA,e):n?Bc.createElement(e,{is:n}):Bc.createElement(e);return e==="select"&&r&&r.multiple!=null&&i.setAttribute("multiple",r.multiple),i},createText:e=>Bc.createTextNode(e),createComment:e=>Bc.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Bc.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,r,i,s){const o=n?n.previousSibling:t.lastChild;if(i&&(i===s||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),n),!(i===s||!(i=i.nextSibling)););else{J2.innerHTML=B4(r==="svg"?`<svg>${e}</svg>`:r==="mathml"?`<math>${e}</math>`:e);const u=J2.content;if(r==="svg"||r==="mathml"){const f=u.firstChild;for(;f.firstChild;)u.appendChild(f.firstChild);u.removeChild(f)}t.insertBefore(u,n)}return[o?o.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},ef="transition",Sd="animation",nd=Symbol("_vtc"),R4={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},F4=co({},W1,R4),DA=e=>(e.displayName="Transition",e.props=F4,e),Gv=DA((e,{slots:t})=>Hm(zw,j4(e),t)),$f=(e,t=[])=>{tr(e)?e.forEach(n=>n(...t)):e&&e(...t)},X2=e=>e?tr(e)?e.some(t=>t.length>1):e.length>1:!1;function j4(e){const t={};for(const B in e)B in R4||(t[B]=e[B]);if(e.css===!1)return t;const{name:n="v",type:r,duration:i,enterFromClass:s=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:u=`${n}-enter-to`,appearFromClass:f=s,appearActiveClass:d=o,appearToClass:g=u,leaveFromClass:y=`${n}-leave-from`,leaveActiveClass:x=`${n}-leave-active`,leaveToClass:_=`${n}-leave-to`}=e,M=IA(i),T=M&&M[0],D=M&&M[1],{onBeforeEnter:I,onEnter:j,onEnterCancelled:Z,onLeave:te,onLeaveCancelled:ue,onBeforeAppear:le=I,onAppear:ge=j,onAppearCancelled:H=Z}=t,U=(B,R,$,W)=>{B._enterCancelled=W,sf(B,R?g:u),sf(B,R?d:o),$&&$()},Q=(B,R)=>{B._isLeaving=!1,sf(B,y),sf(B,_),sf(B,x),R&&R()},F=B=>(R,$)=>{const W=B?ge:j,G=()=>U(R,B,$);$f(W,[R,G]),Q2(()=>{sf(R,B?f:s),oc(R,B?g:u),X2(W)||e_(R,r,T,G)})};return co(t,{onBeforeEnter(B){$f(I,[B]),oc(B,s),oc(B,o)},onBeforeAppear(B){$f(le,[B]),oc(B,f),oc(B,d)},onEnter:F(!1),onAppear:F(!0),onLeave(B,R){B._isLeaving=!0;const $=()=>Q(B,R);oc(B,y),B._enterCancelled?(oc(B,x),Hv()):(Hv(),oc(B,x)),Q2(()=>{B._isLeaving&&(sf(B,y),oc(B,_),X2(te)||e_(B,r,D,$))}),$f(te,[B,$])},onEnterCancelled(B){U(B,!1,void 0,!0),$f(Z,[B])},onAppearCancelled(B){U(B,!0,void 0,!0),$f(H,[B])},onLeaveCancelled(B){Q(B),$f(ue,[B])}})}function IA(e){if(e==null)return null;if(Qi(e))return[H0(e.enter),H0(e.leave)];{const t=H0(e);return[t,t]}}function H0(e){return Jg(e)}function oc(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.add(n)),(e[nd]||(e[nd]=new Set)).add(t)}function sf(e,t){t.split(/\s+/).forEach(r=>r&&e.classList.remove(r));const n=e[nd];n&&(n.delete(t),n.size||(e[nd]=void 0))}function Q2(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let OA=0;function e_(e,t,n,r){const i=e._endId=++OA,s=()=>{i===e._endId&&r()};if(n!=null)return setTimeout(s,n);const{type:o,timeout:u,propCount:f}=z4(e,t);if(!o)return r();const d=o+"end";let g=0;const y=()=>{e.removeEventListener(d,x),s()},x=_=>{_.target===e&&++g>=f&&y()};setTimeout(()=>{g<f&&y()},u+1),e.addEventListener(d,x)}function z4(e,t){const n=window.getComputedStyle(e),r=M=>(n[M]||"").split(", "),i=r(`${ef}Delay`),s=r(`${ef}Duration`),o=t_(i,s),u=r(`${Sd}Delay`),f=r(`${Sd}Duration`),d=t_(u,f);let g=null,y=0,x=0;t===ef?o>0&&(g=ef,y=o,x=s.length):t===Sd?d>0&&(g=Sd,y=d,x=f.length):(y=Math.max(o,d),g=y>0?o>d?ef:Sd:null,x=g?g===ef?s.length:f.length:0);const _=g===ef&&/\b(transform|all)(,|$)/.test(r(`${ef}Property`).toString());return{type:g,timeout:y,propCount:x,hasTransform:_}}function t_(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((n,r)=>n_(n)+n_(e[r])))}function n_(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function Hv(){return document.body.offsetHeight}function BA(e,t,n){const r=e[nd];r&&(t=(t?[t,...r]:[...r]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const am=Symbol("_vod"),$4=Symbol("_vsh"),qm={beforeMount(e,{value:t},{transition:n}){e[am]=e.style.display==="none"?"":e.style.display,n&&t?n.beforeEnter(e):Cd(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:r}){!t!=!n&&(r?t?(r.beforeEnter(e),Cd(e,!0),r.enter(e)):r.leave(e,()=>{Cd(e,!1)}):Cd(e,t))},beforeUnmount(e,{value:t}){Cd(e,t)}};function Cd(e,t){e.style.display=t?e[am]:"none",e[$4]=!t}function RA(){qm.getSSRProps=({value:e})=>{if(!e)return{style:{display:"none"}}}}const U4=Symbol("");function FA(e){const t=_u();if(!t)return;const n=t.ut=(i=e(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach(s=>lm(s,i))},r=()=>{const i=e(t.proxy);t.ce?lm(t.ce,i):qv(t.subTree,i),n(i)};K1(()=>{gp(r)}),$s(()=>{Co(r,gu,{flush:"post"});const i=new MutationObserver(r);i.observe(t.subTree.el.parentNode,{childList:!0}),mc(()=>i.disconnect())})}function qv(e,t){if(e.shapeFlag&128){const n=e.suspense;e=n.activeBranch,n.pendingBranch&&!n.isHydrating&&n.effects.push(()=>{qv(n.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)lm(e.el,t);else if(e.type===Bn)e.children.forEach(n=>qv(n,t));else if(e.type===Qf){let{el:n,anchor:r}=e;for(;n&&(lm(n,t),n!==r);)n=n.nextSibling}}function lm(e,t){if(e.nodeType===1){const n=e.style;let r="";for(const i in t)n.setProperty(`--${i}`,t[i]),r+=`--${i}: ${t[i]};`;n[U4]=r}}const jA=/(^|;)\s*display\s*:/;function zA(e,t,n){const r=e.style,i=_o(n);let s=!1;if(n&&!i){if(t)if(_o(t))for(const o of t.split(";")){const u=o.slice(0,o.indexOf(":")).trim();n[u]==null&&Ig(r,u,"")}else for(const o in t)n[o]==null&&Ig(r,o,"");for(const o in n)o==="display"&&(s=!0),Ig(r,o,n[o])}else if(i){if(t!==n){const o=r[U4];o&&(n+=";"+o),r.cssText=n,s=jA.test(n)}}else t&&e.removeAttribute("style");am in e&&(e[am]=s?r.display:"",e[$4]&&(r.display="none"))}const r_=/\s*!important$/;function Ig(e,t,n){if(tr(n))n.forEach(r=>Ig(e,t,r));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const r=$A(e,t);r_.test(n)?e.setProperty(Cl(r),n.replace(r_,""),"important"):e[r]=n}}const i_=["Webkit","Moz","ms"],q0={};function $A(e,t){const n=q0[t];if(n)return n;let r=ga(t);if(r!=="filter"&&r in e)return q0[t]=r;r=Mp(r);for(let i=0;i<i_.length;i++){const s=i_[i]+r;if(s in e)return q0[t]=s}return t}const o_="http://www.w3.org/1999/xlink";function s_(e,t,n,r,i,s=tP(t)){r&&t.startsWith("xlink:")?n==null?e.removeAttributeNS(o_,t.slice(6,t.length)):e.setAttributeNS(o_,t,n):n==null||s&&!ow(n)?e.removeAttribute(t):e.setAttribute(t,s?"":Vu(n)?String(n):n)}function a_(e,t,n,r,i){if(t==="innerHTML"||t==="textContent"){n!=null&&(e[t]=t==="innerHTML"?B4(n):n);return}const s=e.tagName;if(t==="value"&&s!=="PROGRESS"&&!s.includes("-")){const u=s==="OPTION"?e.getAttribute("value")||"":e.value,f=n==null?e.type==="checkbox"?"on":"":String(n);(u!==f||!("_value"in e))&&(e.value=f),n==null&&e.removeAttribute(t),e._value=n;return}let o=!1;if(n===""||n==null){const u=typeof e[t];u==="boolean"?n=ow(n):n==null&&u==="string"?(n="",o=!0):u==="number"&&(n=0,o=!0)}try{e[t]=n}catch{}o&&e.removeAttribute(i||t)}function jc(e,t,n,r){e.addEventListener(t,n,r)}function UA(e,t,n,r){e.removeEventListener(t,n,r)}const l_=Symbol("_vei");function VA(e,t,n,r,i=null){const s=e[l_]||(e[l_]={}),o=s[t];if(r&&o)o.value=r;else{const[u,f]=GA(t);if(r){const d=s[t]=WA(r,i);jc(e,u,d,f)}else o&&(UA(e,u,o,f),s[t]=void 0)}}const u_=/(?:Once|Passive|Capture)$/;function GA(e){let t;if(u_.test(e)){t={};let r;for(;r=e.match(u_);)e=e.slice(0,e.length-r[0].length),t[r[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Cl(e.slice(2)),t]}let W0=0;const HA=Promise.resolve(),qA=()=>W0||(HA.then(()=>W0=0),W0=Date.now());function WA(e,t){const n=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=n.attached)return;vu(ZA(r,n.value),t,5,[r])};return n.value=e,n.attached=qA(),n}function ZA(e,t){if(tr(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(r=>i=>!i._stopped&&r&&r(i))}else return t}const c_=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,KA=(e,t,n,r,i,s)=>{const o=i==="svg";t==="class"?BA(e,r,o):t==="style"?zA(e,n,r):Pp(t)?N1(t)||VA(e,t,n,r,s):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):YA(e,t,r,o))?(a_(e,t,r),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&s_(e,t,r,o,s,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!_o(r))?a_(e,ga(t),r,s,t):(t==="true-value"?e._trueValue=r:t==="false-value"&&(e._falseValue=r),s_(e,t,r,o))};function YA(e,t,n,r){if(r)return!!(t==="innerHTML"||t==="textContent"||t in e&&c_(t)&&Tr(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const i=e.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return c_(t)&&_o(n)?!1:t in e}const f_={};/*! #__NO_SIDE_EFFECTS__ */function V4(e,t,n){const r=cs(e,t);Am(r)&&co(r,t);class i extends Wm{constructor(o){super(r,o,n)}}return i.def=r,i}/*! #__NO_SIDE_EFFECTS__ */const JA=(e,t)=>V4(e,t,Q4),XA=typeof HTMLElement<"u"?HTMLElement:class{};class Wm extends XA{constructor(t,n={},r=cm){super(),this._def=t,this._props=n,this._createApp=r,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&r!==cm?this._root=this.shadowRoot:t.shadowRoot!==!1?(this.attachShadow({mode:"open"}),this._root=this.shadowRoot):this._root=this,this._def.__asyncLoader||this._resolveProps(this._def)}connectedCallback(){if(!this.isConnected)return;this.shadowRoot||this._parseSlots(),this._connected=!0;let t=this;for(;t=t&&(t.parentNode||t.host);)if(t instanceof Wm){this._parent=t;break}this._instance||(this._resolved?(this._setParent(),this._update()):t&&t._pendingResolve?this._pendingResolve=t._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(t=this._parent){t&&(this._instance.parent=t._instance,this._instance.provides=t._instance.provides)}disconnectedCallback(){this._connected=!1,Xs(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null)})}_resolveDef(){if(this._pendingResolve)return;for(let r=0;r<this.attributes.length;r++)this._setAttr(this.attributes[r].name);this._ob=new MutationObserver(r=>{for(const i of r)this._setAttr(i.attributeName)}),this._ob.observe(this,{attributes:!0});const t=(r,i=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:s,styles:o}=r;let u;if(s&&!tr(s))for(const f in s){const d=s[f];(d===Number||d&&d.type===Number)&&(f in this._props&&(this._props[f]=Jg(this._props[f])),(u||(u=Object.create(null)))[ga(f)]=!0)}this._numberProps=u,i&&this._resolveProps(r),this.shadowRoot&&this._applyStyles(o),this._mount(r)},n=this._def.__asyncLoader;n?this._pendingResolve=n().then(r=>t(this._def=r,!0)):t(this._def)}_mount(t){this._app=this._createApp(t),t.configureApp&&t.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const n=this._instance&&this._instance.exposed;if(n)for(const r in n)Wi(this,r)||Object.defineProperty(this,r,{get:()=>Wn(n[r])})}_resolveProps(t){const{props:n}=t,r=tr(n)?n:Object.keys(n||{});for(const i of Object.keys(this))i[0]!=="_"&&r.includes(i)&&this._setProp(i,this[i]);for(const i of r.map(ga))Object.defineProperty(this,i,{get(){return this._getProp(i)},set(s){this._setProp(i,s,!0,!0)}})}_setAttr(t){if(t.startsWith("data-v-"))return;const n=this.hasAttribute(t);let r=n?this.getAttribute(t):f_;const i=ga(t);n&&this._numberProps&&this._numberProps[i]&&(r=Jg(r)),this._setProp(i,r,!1,!0)}_getProp(t){return this._props[t]}_setProp(t,n,r=!0,i=!1){if(n!==this._props[t]&&(n===f_?delete this._props[t]:(this._props[t]=n,t==="key"&&this._app&&(this._app._ceVNode.key=n)),i&&this._instance&&this._update(),r)){const s=this._ob;s&&s.disconnect(),n===!0?this.setAttribute(Cl(t),""):typeof n=="string"||typeof n=="number"?this.setAttribute(Cl(t),n+""):n||this.removeAttribute(Cl(t)),s&&s.observe(this,{attributes:!0})}}_update(){X4(this._createVNode(),this._root)}_createVNode(){const t={};this.shadowRoot||(t.onVnodeMounted=t.onVnodeUpdated=this._renderSlots.bind(this));const n=hi(this._def,co(t,this._props));return this._instance||(n.ce=r=>{this._instance=r,r.ce=this,r.isCE=!0;const i=(s,o)=>{this.dispatchEvent(new CustomEvent(s,Am(o[0])?co({detail:o},o[0]):{detail:o}))};r.emit=(s,...o)=>{i(s,o),Cl(s)!==s&&i(Cl(s),o)},this._setParent()}),n}_applyStyles(t,n){if(!t)return;if(n){if(n===this._def||this._styleChildren.has(n))return;this._styleChildren.add(n)}const r=this._nonce;for(let i=t.length-1;i>=0;i--){const s=document.createElement("style");r&&s.setAttribute("nonce",r),s.textContent=t[i],this.shadowRoot.prepend(s)}}_parseSlots(){const t=this._slots={};let n;for(;n=this.firstChild;){const r=n.nodeType===1&&n.getAttribute("slot")||"default";(t[r]||(t[r]=[])).push(n),this.removeChild(n)}}_renderSlots(){const t=(this._teleportTarget||this).querySelectorAll("slot"),n=this._instance.type.__scopeId;for(let r=0;r<t.length;r++){const i=t[r],s=i.getAttribute("name")||"default",o=this._slots[s],u=i.parentNode;if(o)for(const f of o){if(n&&f.nodeType===1){const d=n+"-s",g=document.createTreeWalker(f,1);f.setAttribute(d,"");let y;for(;y=g.nextNode();)y.setAttribute(d,"")}u.insertBefore(f,i)}else for(;i.firstChild;)u.insertBefore(i.firstChild,i);u.removeChild(i)}}_injectChildStyle(t){this._applyStyles(t.styles,t)}_removeChildStyle(t){}}function G4(e){const t=_u(),n=t&&t.ce;return n||null}function QA(){const e=G4();return e&&e.shadowRoot}function e6(e="$style"){{const t=_u();if(!t)return Di;const n=t.type.__cssModules;if(!n)return Di;const r=n[e];return r||Di}}const H4=new WeakMap,q4=new WeakMap,um=Symbol("_moveCb"),h_=Symbol("_enterCb"),t6=e=>(delete e.props.mode,e),n6=t6({name:"TransitionGroup",props:co({},F4,{tag:String,moveClass:String}),setup(e,{slots:t}){const n=_u(),r=q1();let i,s;return Um(()=>{if(!i.length)return;const o=e.moveClass||`${e.name||"v"}-move`;if(!a6(i[0].el,n.vnode.el,o))return;i.forEach(i6),i.forEach(o6);const u=i.filter(s6);Hv(),u.forEach(f=>{const d=f.el,g=d.style;oc(d,o),g.transform=g.webkitTransform=g.transitionDuration="";const y=d[um]=x=>{x&&x.target!==d||(!x||/transform$/.test(x.propertyName))&&(d.removeEventListener("transitionend",y),d[um]=null,sf(d,o))};d.addEventListener("transitionend",y)})}),()=>{const o=Ni(e),u=j4(o);let f=o.tag||Bn;if(i=[],s)for(let d=0;d<s.length;d++){const g=s[d];g.el&&g.el instanceof Element&&(i.push(g),Uc(g,ed(g,u,r,n)),H4.set(g,g.el.getBoundingClientRect()))}s=t.default?zm(t.default()):[];for(let d=0;d<s.length;d++){const g=s[d];g.key!=null&&Uc(g,ed(g,u,r,n))}return hi(f,null,s)}}}),r6=n6;function i6(e){const t=e.el;t[um]&&t[um](),t[h_]&&t[h_]()}function o6(e){q4.set(e,e.el.getBoundingClientRect())}function s6(e){const t=H4.get(e),n=q4.get(e),r=t.left-n.left,i=t.top-n.top;if(r||i){const s=e.el.style;return s.transform=s.webkitTransform=`translate(${r}px,${i}px)`,s.transitionDuration="0s",e}}function a6(e,t,n){const r=e.cloneNode(),i=e[nd];i&&i.forEach(u=>{u.split(/\s+/).forEach(f=>f&&r.classList.remove(f))}),n.split(/\s+/).forEach(u=>u&&r.classList.add(u)),r.style.display="none";const s=t.nodeType===1?t:t.parentNode;s.appendChild(r);const{hasTransform:o}=z4(r);return s.removeChild(r),o}const Lf=e=>{const t=e.props["onUpdate:modelValue"]||!1;return tr(t)?n=>Wh(t,n):t};function l6(e){e.target.composing=!0}function d_(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const mu=Symbol("_assign"),ri={created(e,{modifiers:{lazy:t,trim:n,number:r}},i){e[mu]=Lf(i);const s=r||i.props&&i.props.type==="number";jc(e,t?"change":"input",o=>{if(o.target.composing)return;let u=e.value;n&&(u=u.trim()),s&&(u=Yg(u)),e[mu](u)}),n&&jc(e,"change",()=>{e.value=e.value.trim()}),t||(jc(e,"compositionstart",l6),jc(e,"compositionend",d_),jc(e,"change",d_))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:r,trim:i,number:s}},o){if(e[mu]=Lf(o),e.composing)return;const u=(s||e.type==="number")&&!/^0\d/.test(e.value)?Yg(e.value):e.value,f=t??"";u!==f&&(document.activeElement===e&&e.type!=="range"&&(r&&t===n||i&&e.value.trim()===f)||(e.value=f))}},Ll={deep:!0,created(e,t,n){e[mu]=Lf(n),jc(e,"change",()=>{const r=e._modelValue,i=rd(e),s=e.checked,o=e[mu];if(tr(r)){const u=Nm(r,i),f=u!==-1;if(s&&!f)o(r.concat(i));else if(!s&&f){const d=[...r];d.splice(u,1),o(d)}}else if(sh(r)){const u=new Set(r);s?u.add(i):u.delete(i),o(u)}else o(W4(e,s))})},mounted:p_,beforeUpdate(e,t,n){e[mu]=Lf(n),p_(e,t,n)}};function p_(e,{value:t,oldValue:n},r){e._modelValue=t;let i;if(tr(t))i=Nm(t,r.props.value)>-1;else if(sh(t))i=t.has(r.props.value);else{if(t===n)return;i=wf(t,W4(e,!0))}e.checked!==i&&(e.checked=i)}const ry={created(e,{value:t},n){e.checked=wf(t,n.props.value),e[mu]=Lf(n),jc(e,"change",()=>{e[mu](rd(e))})},beforeUpdate(e,{value:t,oldValue:n},r){e[mu]=Lf(r),t!==n&&(e.checked=wf(t,r.props.value))}},uo={deep:!0,created(e,{value:t,modifiers:{number:n}},r){const i=sh(t);jc(e,"change",()=>{const s=Array.prototype.filter.call(e.options,o=>o.selected).map(o=>n?Yg(rd(o)):rd(o));e[mu](e.multiple?i?new Set(s):s:s[0]),e._assigning=!0,Xs(()=>{e._assigning=!1})}),e[mu]=Lf(r)},mounted(e,{value:t}){g_(e,t)},beforeUpdate(e,t,n){e[mu]=Lf(n)},updated(e,{value:t}){e._assigning||g_(e,t)}};function g_(e,t){const n=e.multiple,r=tr(t);if(!(n&&!r&&!sh(t))){for(let i=0,s=e.options.length;i<s;i++){const o=e.options[i],u=rd(o);if(n)if(r){const f=typeof u;f==="string"||f==="number"?o.selected=t.some(d=>String(d)===String(u)):o.selected=Nm(t,u)>-1}else o.selected=t.has(u);else if(wf(rd(o),t)){e.selectedIndex!==i&&(e.selectedIndex=i);return}}!n&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function rd(e){return"_value"in e?e._value:e.value}function W4(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const iy={created(e,t,n){vg(e,t,n,null,"created")},mounted(e,t,n){vg(e,t,n,null,"mounted")},beforeUpdate(e,t,n,r){vg(e,t,n,r,"beforeUpdate")},updated(e,t,n,r){vg(e,t,n,r,"updated")}};function Z4(e,t){switch(e){case"SELECT":return uo;case"TEXTAREA":return ri;default:switch(t){case"checkbox":return Ll;case"radio":return ry;default:return ri}}}function vg(e,t,n,r,i){const o=Z4(e.tagName,n.props&&n.props.type)[i];o&&o(e,t,n,r)}function u6(){ri.getSSRProps=({value:e})=>({value:e}),ry.getSSRProps=({value:e},t)=>{if(t.props&&wf(t.props.value,e))return{checked:!0}},Ll.getSSRProps=({value:e},t)=>{if(tr(e)){if(t.props&&Nm(e,t.props.value)>-1)return{checked:!0}}else if(sh(e)){if(t.props&&e.has(t.props.value))return{checked:!0}}else if(e)return{checked:!0}},iy.getSSRProps=(e,t)=>{if(typeof t.type!="string")return;const n=Z4(t.type.toUpperCase(),t.props&&t.props.type);if(n.getSSRProps)return n.getSSRProps(e,t)}}const c6=["ctrl","shift","alt","meta"],f6={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>c6.some(n=>e[`${n}Key`]&&!t.includes(n))},Sf=(e,t)=>{const n=e._withMods||(e._withMods={}),r=t.join(".");return n[r]||(n[r]=(i,...s)=>{for(let o=0;o<t.length;o++){const u=f6[t[o]];if(u&&u(i,t))return}return e(i,...s)})},h6={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},d6=(e,t)=>{const n=e._withKeys||(e._withKeys={}),r=t.join(".");return n[r]||(n[r]=i=>{if(!("key"in i))return;const s=Cl(i.key);if(t.some(o=>o===s||h6[o]===s))return e(i)})},K4=co({patchProp:KA},NA);let ep,m_=!1;function Y4(){return ep||(ep=f4(K4))}function J4(){return ep=m_?ep:h4(K4),m_=!0,ep}const X4=(...e)=>{Y4().render(...e)},p6=(...e)=>{J4().hydrate(...e)},cm=(...e)=>{const t=Y4().createApp(...e),{mount:n}=t;return t.mount=r=>{const i=t5(r);if(!i)return;const s=t._component;!Tr(s)&&!s.render&&!s.template&&(s.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const o=n(i,!1,e5(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},t},Q4=(...e)=>{const t=J4().createApp(...e),{mount:n}=t;return t.mount=r=>{const i=t5(r);if(i)return n(i,!0,e5(i))},t};function e5(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function t5(e){return _o(e)?document.querySelector(e):e}let v_=!1;const g6=()=>{v_||(v_=!0,u6(),RA())};/**
* vue v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const m6=()=>{},v6=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:zw,BaseTransitionPropsValidators:W1,Comment:Ds,DeprecationTypes:AA,EffectScope:B1,ErrorCodes:UP,ErrorTypeStrings:xA,Fragment:Bn,KeepAlive:dM,ReactiveEffect:hp,Static:Qf,Suspense:iA,Teleport:kg,Text:_f,TrackOpTypes:OP,Transition:Gv,TransitionGroup:r6,TriggerOpTypes:BP,VueElement:Wm,assertNumber:$P,callWithAsyncErrorHandling:vu,callWithErrorHandling:cd,camelize:ga,capitalize:Mp,cloneVNode:vc,compatUtils:MA,compile:m6,computed:cr,createApp:cm,createBlock:$a,createCommentVNode:dn,createElementBlock:qe,createElementVNode:E,createHydrationRenderer:h4,createPropsRestProxy:DM,createRenderer:f4,createSSRApp:Q4,createSlots:yM,createStaticVNode:cc,createTextVNode:Pi,createVNode:hi,customRef:Cw,defineAsyncComponent:fM,defineComponent:cs,defineCustomElement:V4,defineEmits:LM,defineExpose:SM,defineModel:PM,defineOptions:CM,defineProps:xM,defineSSRCustomElement:JA,defineSlots:EM,devtools:LA,effect:iP,effectScope:R1,getCurrentInstance:_u,getCurrentScope:F1,getCurrentWatcher:RP,getTransitionRawChildren:zm,guardReactiveProps:P4,h:Hm,handleError:ah,hasInjectionContext:t4,hydrate:p6,hydrateOnIdle:oM,hydrateOnInteraction:uM,hydrateOnMediaQuery:lM,hydrateOnVisible:aM,initCustomFormatter:_A,initDirectivesForSSR:g6,inject:Zl,isMemoSame:I4,isProxy:Rm,isReactive:dc,isReadonly:xf,isRef:Xo,isRuntimeOnly:mA,isShallow:Wl,isVNode:Vc,markRaw:Fm,mergeDefaults:TM,mergeModels:NM,mergeProps:M4,nextTick:Xs,normalizeClass:Bi,normalizeProps:QE,normalizeStyle:ql,onActivated:Uw,onBeforeMount:Hw,onBeforeUnmount:fd,onBeforeUpdate:K1,onDeactivated:Vw,onErrorCaptured:Kw,onMounted:$s,onRenderTracked:Zw,onRenderTriggered:Ww,onScopeDispose:lw,onServerPrefetch:qw,onUnmounted:mc,onUpdated:Um,onWatcherCleanup:Mw,openBlock:$e,popScopeId:WP,provide:Xd,proxyRefs:G1,pushScopeId:qP,queuePostFlushCb:gp,reactive:Yl,readonly:Bu,ref:Ft,registerRuntimeCompiler:gA,render:X4,renderList:Er,renderSlot:_M,resolveComponent:Yw,resolveDirective:vM,resolveDynamicComponent:mM,resolveFilter:PA,resolveTransitionHooks:ed,setBlockTracking:Rv,setDevtoolsHook:SA,setTransitionHooks:Uc,shallowReactive:U1,shallowReadonly:SP,shallowRef:V1,ssrContextKey:m4,ssrUtils:EA,stop:oP,toDisplayString:Wt,toHandlerKey:Wd,toHandlers:bM,toRaw:Ni,toRef:NP,toRefs:Ew,toValue:PP,transformVNodeArgs:cA,triggerRef:EP,unref:Wn,useAttrs:kM,useCssModule:e6,useCssVars:FA,useHost:G4,useId:JP,useModel:JM,useSSRContext:v4,useShadowRoot:QA,useSlots:AM,useTemplateRef:XP,useTransitionState:q1,vModelCheckbox:Ll,vModelDynamic:iy,vModelRadio:ry,vModelSelect:uo,vModelText:ri,vShow:qm,version:O4,warn:wA,watch:Co,watchEffect:bp,watchPostEffect:KM,watchSyncEffect:y4,withAsyncContext:IM,withCtx:Gl,withDefaults:MM,withDirectives:Fn,withKeys:d6,withMemo:bA,withModifiers:Sf,withScopeId:ZP},Symbol.toStringTag,{value:"Module"}));/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let n5;const Zm=e=>n5=e,r5=Symbol();function Wv(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var tp;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(tp||(tp={}));function y6(){const e=R1(!0),t=e.run(()=>Ft({}));let n=[],r=[];const i=Fm({install(s){Zm(i),i._a=s,s.provide(r5,i),s.config.globalProperties.$pinia=i,r.forEach(o=>n.push(o)),r=[]},use(s){return this._a?n.push(s):r.push(s),this},_p:n,_a:null,_e:e,_s:new Map,state:t});return i}const i5=()=>{};function y_(e,t,n,r=i5){e.push(t);const i=()=>{const s=e.indexOf(t);s>-1&&(e.splice(s,1),r())};return!n&&F1()&&lw(i),i}function Ph(e,...t){e.slice().forEach(n=>{n(...t)})}const _6=e=>e(),__=Symbol(),Z0=Symbol();function Zv(e,t){e instanceof Map&&t instanceof Map?t.forEach((n,r)=>e.set(r,n)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const n in t){if(!t.hasOwnProperty(n))continue;const r=t[n],i=e[n];Wv(i)&&Wv(r)&&e.hasOwnProperty(n)&&!Xo(r)&&!dc(r)?e[n]=Zv(i,r):e[n]=r}return e}const b6=Symbol();function w6(e){return!Wv(e)||!e.hasOwnProperty(b6)}const{assign:af}=Object;function x6(e){return!!(Xo(e)&&e.effect)}function L6(e,t,n,r){const{state:i,actions:s,getters:o}=t,u=n.state.value[e];let f;function d(){u||(n.state.value[e]=i?i():{});const g=Ew(n.state.value[e]);return af(g,s,Object.keys(o||{}).reduce((y,x)=>(y[x]=Fm(cr(()=>{Zm(n);const _=n._s.get(e);return o[x].call(_,_)})),y),{}))}return f=o5(e,d,t,n,r,!0),f}function o5(e,t,n={},r,i,s){let o;const u=af({actions:{}},n),f={deep:!0};let d,g,y=[],x=[],_;const M=r.state.value[e];!s&&!M&&(r.state.value[e]={}),Ft({});let T;function D(H){let U;d=g=!1,typeof H=="function"?(H(r.state.value[e]),U={type:tp.patchFunction,storeId:e,events:_}):(Zv(r.state.value[e],H),U={type:tp.patchObject,payload:H,storeId:e,events:_});const Q=T=Symbol();Xs().then(()=>{T===Q&&(d=!0)}),g=!0,Ph(y,U,r.state.value[e])}const I=s?function(){const{state:U}=n,Q=U?U():{};this.$patch(F=>{af(F,Q)})}:i5;function j(){o.stop(),y=[],x=[],r._s.delete(e)}const Z=(H,U="")=>{if(__ in H)return H[Z0]=U,H;const Q=function(){Zm(r);const F=Array.from(arguments),B=[],R=[];function $(J){B.push(J)}function W(J){R.push(J)}Ph(x,{args:F,name:Q[Z0],store:ue,after:$,onError:W});let G;try{G=H.apply(this&&this.$id===e?this:ue,F)}catch(J){throw Ph(R,J),J}return G instanceof Promise?G.then(J=>(Ph(B,J),J)).catch(J=>(Ph(R,J),Promise.reject(J))):(Ph(B,G),G)};return Q[__]=!0,Q[Z0]=U,Q},te={_p:r,$id:e,$onAction:y_.bind(null,x),$patch:D,$reset:I,$subscribe(H,U={}){const Q=y_(y,H,U.detached,()=>F()),F=o.run(()=>Co(()=>r.state.value[e],B=>{(U.flush==="sync"?g:d)&&H({storeId:e,type:tp.direct,events:_},B)},af({},f,U)));return Q},$dispose:j},ue=Yl(te);r._s.set(e,ue);const ge=(r._a&&r._a.runWithContext||_6)(()=>r._e.run(()=>(o=R1()).run(()=>t({action:Z}))));for(const H in ge){const U=ge[H];if(Xo(U)&&!x6(U)||dc(U))s||(M&&w6(U)&&(Xo(U)?U.value=M[H]:Zv(U,M[H])),r.state.value[e][H]=U);else if(typeof U=="function"){const Q=Z(U,H);ge[H]=Q,u.actions[H]=U}}return af(ue,ge),af(Ni(ue),ge),Object.defineProperty(ue,"$state",{get:()=>r.state.value[e],set:H=>{D(U=>{af(U,H)})}}),r._p.forEach(H=>{af(ue,o.run(()=>H({store:ue,app:r._a,pinia:r,options:u})))}),M&&s&&n.hydrate&&n.hydrate(ue.$state,M),d=!0,g=!0,ue}/*! #__NO_SIDE_EFFECTS__ */function Np(e,t,n){let r,i;const s=typeof t=="function";typeof e=="string"?(r=e,i=s?n:t):(i=e,r=e.id);function o(u,f){const d=t4();return u=u||(d?Zl(r5,null):null),u&&Zm(u),u=n5,u._s.has(r)||(s?o5(r,t,i,u):L6(r,i,u)),u._s.get(r)}return o.$id=r,o}function s5(e,t){return function(){return e.apply(t,arguments)}}const{toString:S6}=Object.prototype,{getPrototypeOf:oy}=Object,Km=(e=>t=>{const n=S6.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),qu=e=>(e=e.toLowerCase(),t=>Km(t)===e),Ym=e=>t=>typeof t===e,{isArray:hd}=Array,xp=Ym("undefined");function C6(e){return e!==null&&!xp(e)&&e.constructor!==null&&!xp(e.constructor)&&Kl(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const a5=qu("ArrayBuffer");function E6(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&a5(e.buffer),t}const P6=Ym("string"),Kl=Ym("function"),l5=Ym("number"),Jm=e=>e!==null&&typeof e=="object",M6=e=>e===!0||e===!1,Og=e=>{if(Km(e)!=="object")return!1;const t=oy(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},A6=qu("Date"),k6=qu("File"),T6=qu("Blob"),N6=qu("FileList"),D6=e=>Jm(e)&&Kl(e.pipe),I6=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Kl(e.append)&&((t=Km(e))==="formdata"||t==="object"&&Kl(e.toString)&&e.toString()==="[object FormData]"))},O6=qu("URLSearchParams"),[B6,R6,F6,j6]=["ReadableStream","Request","Response","Headers"].map(qu),z6=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Dp(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,i;if(typeof e!="object"&&(e=[e]),hd(e))for(r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else{const s=n?Object.getOwnPropertyNames(e):Object.keys(e),o=s.length;let u;for(r=0;r<o;r++)u=s[r],t.call(null,e[u],u,e)}}function u5(e,t){t=t.toLowerCase();const n=Object.keys(e);let r=n.length,i;for(;r-- >0;)if(i=n[r],t===i.toLowerCase())return i;return null}const Kf=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,c5=e=>!xp(e)&&e!==Kf;function Kv(){const{caseless:e}=c5(this)&&this||{},t={},n=(r,i)=>{const s=e&&u5(t,i)||i;Og(t[s])&&Og(r)?t[s]=Kv(t[s],r):Og(r)?t[s]=Kv({},r):hd(r)?t[s]=r.slice():t[s]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&Dp(arguments[r],n);return t}const $6=(e,t,n,{allOwnKeys:r}={})=>(Dp(t,(i,s)=>{n&&Kl(i)?e[s]=s5(i,n):e[s]=i},{allOwnKeys:r}),e),U6=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),V6=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},G6=(e,t,n,r)=>{let i,s,o;const u={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),s=i.length;s-- >0;)o=i[s],(!r||r(o,e,t))&&!u[o]&&(t[o]=e[o],u[o]=!0);e=n!==!1&&oy(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},H6=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},q6=e=>{if(!e)return null;if(hd(e))return e;let t=e.length;if(!l5(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},W6=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&oy(Uint8Array)),Z6=(e,t)=>{const r=(e&&e[Symbol.iterator]).call(e);let i;for(;(i=r.next())&&!i.done;){const s=i.value;t.call(e,s[0],s[1])}},K6=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},Y6=qu("HTMLFormElement"),J6=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),b_=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),X6=qu("RegExp"),f5=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};Dp(n,(i,s)=>{let o;(o=t(i,s,e))!==!1&&(r[s]=o||i)}),Object.defineProperties(e,r)},Q6=e=>{f5(e,(t,n)=>{if(Kl(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(Kl(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},ek=(e,t)=>{const n={},r=i=>{i.forEach(s=>{n[s]=!0})};return hd(e)?r(e):r(String(e).split(t)),n},tk=()=>{},nk=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function rk(e){return!!(e&&Kl(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const ik=e=>{const t=new Array(10),n=(r,i)=>{if(Jm(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[i]=r;const s=hd(r)?[]:{};return Dp(r,(o,u)=>{const f=n(o,i+1);!xp(f)&&(s[u]=f)}),t[i]=void 0,s}}return r};return n(e,0)},ok=qu("AsyncFunction"),sk=e=>e&&(Jm(e)||Kl(e))&&Kl(e.then)&&Kl(e.catch),h5=((e,t)=>e?setImmediate:t?((n,r)=>(Kf.addEventListener("message",({source:i,data:s})=>{i===Kf&&s===n&&r.length&&r.shift()()},!1),i=>{r.push(i),Kf.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Kl(Kf.postMessage)),ak=typeof queueMicrotask<"u"?queueMicrotask.bind(Kf):typeof process<"u"&&process.nextTick||h5,Jt={isArray:hd,isArrayBuffer:a5,isBuffer:C6,isFormData:I6,isArrayBufferView:E6,isString:P6,isNumber:l5,isBoolean:M6,isObject:Jm,isPlainObject:Og,isReadableStream:B6,isRequest:R6,isResponse:F6,isHeaders:j6,isUndefined:xp,isDate:A6,isFile:k6,isBlob:T6,isRegExp:X6,isFunction:Kl,isStream:D6,isURLSearchParams:O6,isTypedArray:W6,isFileList:N6,forEach:Dp,merge:Kv,extend:$6,trim:z6,stripBOM:U6,inherits:V6,toFlatObject:G6,kindOf:Km,kindOfTest:qu,endsWith:H6,toArray:q6,forEachEntry:Z6,matchAll:K6,isHTMLForm:Y6,hasOwnProperty:b_,hasOwnProp:b_,reduceDescriptors:f5,freezeMethods:Q6,toObjectSet:ek,toCamelCase:J6,noop:tk,toFiniteNumber:nk,findKey:u5,global:Kf,isContextDefined:c5,isSpecCompliantForm:rk,toJSONObject:ik,isAsyncFn:ok,isThenable:sk,setImmediate:h5,asap:ak};function oi(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}Jt.inherits(oi,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Jt.toJSONObject(this.config),code:this.code,status:this.status}}});const d5=oi.prototype,p5={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{p5[e]={value:e}});Object.defineProperties(oi,p5);Object.defineProperty(d5,"isAxiosError",{value:!0});oi.from=(e,t,n,r,i,s)=>{const o=Object.create(d5);return Jt.toFlatObject(e,o,function(f){return f!==Error.prototype},u=>u!=="isAxiosError"),oi.call(o,e.message,t,n,r,i),o.cause=e,o.name=e.name,s&&Object.assign(o,s),o};const lk=null;function Yv(e){return Jt.isPlainObject(e)||Jt.isArray(e)}function g5(e){return Jt.endsWith(e,"[]")?e.slice(0,-2):e}function w_(e,t,n){return e?e.concat(t).map(function(i,s){return i=g5(i),!n&&s?"["+i+"]":i}).join(n?".":""):t}function uk(e){return Jt.isArray(e)&&!e.some(Yv)}const ck=Jt.toFlatObject(Jt,{},null,function(t){return/^is[A-Z]/.test(t)});function Xm(e,t,n){if(!Jt.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=Jt.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(T,D){return!Jt.isUndefined(D[T])});const r=n.metaTokens,i=n.visitor||g,s=n.dots,o=n.indexes,f=(n.Blob||typeof Blob<"u"&&Blob)&&Jt.isSpecCompliantForm(t);if(!Jt.isFunction(i))throw new TypeError("visitor must be a function");function d(M){if(M===null)return"";if(Jt.isDate(M))return M.toISOString();if(!f&&Jt.isBlob(M))throw new oi("Blob is not supported. Use a Buffer instead.");return Jt.isArrayBuffer(M)||Jt.isTypedArray(M)?f&&typeof Blob=="function"?new Blob([M]):Buffer.from(M):M}function g(M,T,D){let I=M;if(M&&!D&&typeof M=="object"){if(Jt.endsWith(T,"{}"))T=r?T:T.slice(0,-2),M=JSON.stringify(M);else if(Jt.isArray(M)&&uk(M)||(Jt.isFileList(M)||Jt.endsWith(T,"[]"))&&(I=Jt.toArray(M)))return T=g5(T),I.forEach(function(Z,te){!(Jt.isUndefined(Z)||Z===null)&&t.append(o===!0?w_([T],te,s):o===null?T:T+"[]",d(Z))}),!1}return Yv(M)?!0:(t.append(w_(D,T,s),d(M)),!1)}const y=[],x=Object.assign(ck,{defaultVisitor:g,convertValue:d,isVisitable:Yv});function _(M,T){if(!Jt.isUndefined(M)){if(y.indexOf(M)!==-1)throw Error("Circular reference detected in "+T.join("."));y.push(M),Jt.forEach(M,function(I,j){(!(Jt.isUndefined(I)||I===null)&&i.call(t,I,Jt.isString(j)?j.trim():j,T,x))===!0&&_(I,T?T.concat(j):[j])}),y.pop()}}if(!Jt.isObject(e))throw new TypeError("data must be an object");return _(e),t}function x_(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function sy(e,t){this._pairs=[],e&&Xm(e,this,t)}const m5=sy.prototype;m5.append=function(t,n){this._pairs.push([t,n])};m5.toString=function(t){const n=t?function(r){return t.call(this,r,x_)}:x_;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function fk(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function v5(e,t,n){if(!t)return e;const r=n&&n.encode||fk;Jt.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let s;if(i?s=i(t,n):s=Jt.isURLSearchParams(t)?t.toString():new sy(t,n).toString(r),s){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class L_{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Jt.forEach(this.handlers,function(r){r!==null&&t(r)})}}const y5={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},hk=typeof URLSearchParams<"u"?URLSearchParams:sy,dk=typeof FormData<"u"?FormData:null,pk=typeof Blob<"u"?Blob:null,gk={isBrowser:!0,classes:{URLSearchParams:hk,FormData:dk,Blob:pk},protocols:["http","https","file","blob","url","data"]},ay=typeof window<"u"&&typeof document<"u",Jv=typeof navigator=="object"&&navigator||void 0,mk=ay&&(!Jv||["ReactNative","NativeScript","NS"].indexOf(Jv.product)<0),vk=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",yk=ay&&window.location.href||"http://localhost",_k=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ay,hasStandardBrowserEnv:mk,hasStandardBrowserWebWorkerEnv:vk,navigator:Jv,origin:yk},Symbol.toStringTag,{value:"Module"})),Ra={..._k,...gk};function bk(e,t){return Xm(e,new Ra.classes.URLSearchParams,Object.assign({visitor:function(n,r,i,s){return Ra.isNode&&Jt.isBuffer(n)?(this.append(r,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},t))}function wk(e){return Jt.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function xk(e){const t={},n=Object.keys(e);let r;const i=n.length;let s;for(r=0;r<i;r++)s=n[r],t[s]=e[s];return t}function _5(e){function t(n,r,i,s){let o=n[s++];if(o==="__proto__")return!0;const u=Number.isFinite(+o),f=s>=n.length;return o=!o&&Jt.isArray(i)?i.length:o,f?(Jt.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!u):((!i[o]||!Jt.isObject(i[o]))&&(i[o]=[]),t(n,r,i[o],s)&&Jt.isArray(i[o])&&(i[o]=xk(i[o])),!u)}if(Jt.isFormData(e)&&Jt.isFunction(e.entries)){const n={};return Jt.forEachEntry(e,(r,i)=>{t(wk(r),i,n,0)}),n}return null}function Lk(e,t,n){if(Jt.isString(e))try{return(t||JSON.parse)(e),Jt.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const Ip={transitional:y5,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,s=Jt.isObject(t);if(s&&Jt.isHTMLForm(t)&&(t=new FormData(t)),Jt.isFormData(t))return i?JSON.stringify(_5(t)):t;if(Jt.isArrayBuffer(t)||Jt.isBuffer(t)||Jt.isStream(t)||Jt.isFile(t)||Jt.isBlob(t)||Jt.isReadableStream(t))return t;if(Jt.isArrayBufferView(t))return t.buffer;if(Jt.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return bk(t,this.formSerializer).toString();if((u=Jt.isFileList(t))||r.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return Xm(u?{"files[]":t}:t,f&&new f,this.formSerializer)}}return s||i?(n.setContentType("application/json",!1),Lk(t)):t}],transformResponse:[function(t){const n=this.transitional||Ip.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(Jt.isResponse(t)||Jt.isReadableStream(t))return t;if(t&&Jt.isString(t)&&(r&&!this.responseType||i)){const o=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(u){if(o)throw u.name==="SyntaxError"?oi.from(u,oi.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ra.classes.FormData,Blob:Ra.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Jt.forEach(["delete","get","head","post","put","patch"],e=>{Ip.headers[e]={}});const Sk=Jt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Ck=e=>{const t={};let n,r,i;return e&&e.split(`
`).forEach(function(o){i=o.indexOf(":"),n=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!n||t[n]&&Sk[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},S_=Symbol("internals");function Ed(e){return e&&String(e).trim().toLowerCase()}function Bg(e){return e===!1||e==null?e:Jt.isArray(e)?e.map(Bg):String(e)}function Ek(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const Pk=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function K0(e,t,n,r,i){if(Jt.isFunction(r))return r.call(this,t,n);if(i&&(t=n),!!Jt.isString(t)){if(Jt.isString(r))return t.indexOf(r)!==-1;if(Jt.isRegExp(r))return r.test(t)}}function Mk(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function Ak(e,t){const n=Jt.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(i,s,o){return this[r].call(this,t,i,s,o)},configurable:!0})})}let El=class{constructor(t){t&&this.set(t)}set(t,n,r){const i=this;function s(u,f,d){const g=Ed(f);if(!g)throw new Error("header name must be a non-empty string");const y=Jt.findKey(i,g);(!y||i[y]===void 0||d===!0||d===void 0&&i[y]!==!1)&&(i[y||f]=Bg(u))}const o=(u,f)=>Jt.forEach(u,(d,g)=>s(d,g,f));if(Jt.isPlainObject(t)||t instanceof this.constructor)o(t,n);else if(Jt.isString(t)&&(t=t.trim())&&!Pk(t))o(Ck(t),n);else if(Jt.isHeaders(t))for(const[u,f]of t.entries())s(f,u,r);else t!=null&&s(n,t,r);return this}get(t,n){if(t=Ed(t),t){const r=Jt.findKey(this,t);if(r){const i=this[r];if(!n)return i;if(n===!0)return Ek(i);if(Jt.isFunction(n))return n.call(this,i,r);if(Jt.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Ed(t),t){const r=Jt.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||K0(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let i=!1;function s(o){if(o=Ed(o),o){const u=Jt.findKey(r,o);u&&(!n||K0(r,r[u],u,n))&&(delete r[u],i=!0)}}return Jt.isArray(t)?t.forEach(s):s(t),i}clear(t){const n=Object.keys(this);let r=n.length,i=!1;for(;r--;){const s=n[r];(!t||K0(this,this[s],s,t,!0))&&(delete this[s],i=!0)}return i}normalize(t){const n=this,r={};return Jt.forEach(this,(i,s)=>{const o=Jt.findKey(r,s);if(o){n[o]=Bg(i),delete n[s];return}const u=t?Mk(s):String(s).trim();u!==s&&delete n[s],n[u]=Bg(i),r[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return Jt.forEach(this,(r,i)=>{r!=null&&r!==!1&&(n[i]=t&&Jt.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(i=>r.set(i)),r}static accessor(t){const r=(this[S_]=this[S_]={accessors:{}}).accessors,i=this.prototype;function s(o){const u=Ed(o);r[u]||(Ak(i,o),r[u]=!0)}return Jt.isArray(t)?t.forEach(s):s(t),this}};El.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Jt.reduceDescriptors(El.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});Jt.freezeMethods(El);function Y0(e,t){const n=this||Ip,r=t||n,i=El.from(r.headers);let s=r.data;return Jt.forEach(e,function(u){s=u.call(n,s,i.normalize(),t?t.status:void 0)}),i.normalize(),s}function b5(e){return!!(e&&e.__CANCEL__)}function dd(e,t,n){oi.call(this,e??"canceled",oi.ERR_CANCELED,t,n),this.name="CanceledError"}Jt.inherits(dd,oi,{__CANCEL__:!0});function w5(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new oi("Request failed with status code "+n.status,[oi.ERR_BAD_REQUEST,oi.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function kk(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Tk(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i=0,s=0,o;return t=t!==void 0?t:1e3,function(f){const d=Date.now(),g=r[s];o||(o=d),n[i]=f,r[i]=d;let y=s,x=0;for(;y!==i;)x+=n[y++],y=y%e;if(i=(i+1)%e,i===s&&(s=(s+1)%e),d-o<t)return;const _=g&&d-g;return _?Math.round(x*1e3/_):void 0}}function Nk(e,t){let n=0,r=1e3/t,i,s;const o=(d,g=Date.now())=>{n=g,i=null,s&&(clearTimeout(s),s=null),e.apply(null,d)};return[(...d)=>{const g=Date.now(),y=g-n;y>=r?o(d,g):(i=d,s||(s=setTimeout(()=>{s=null,o(i)},r-y)))},()=>i&&o(i)]}const fm=(e,t,n=3)=>{let r=0;const i=Tk(50,250);return Nk(s=>{const o=s.loaded,u=s.lengthComputable?s.total:void 0,f=o-r,d=i(f),g=o<=u;r=o;const y={loaded:o,total:u,progress:u?o/u:void 0,bytes:f,rate:d||void 0,estimated:d&&u&&g?(u-o)/d:void 0,event:s,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(y)},n)},C_=(e,t)=>{const n=e!=null;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},E_=e=>(...t)=>Jt.asap(()=>e(...t)),Dk=Ra.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,Ra.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(Ra.origin),Ra.navigator&&/(msie|trident)/i.test(Ra.navigator.userAgent)):()=>!0,Ik=Ra.hasStandardBrowserEnv?{write(e,t,n,r,i,s){const o=[e+"="+encodeURIComponent(t)];Jt.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),Jt.isString(r)&&o.push("path="+r),Jt.isString(i)&&o.push("domain="+i),s===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Ok(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Bk(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function x5(e,t,n){let r=!Ok(t);return e&&(r||n==!1)?Bk(e,t):t}const P_=e=>e instanceof El?{...e}:e;function oh(e,t){t=t||{};const n={};function r(d,g,y,x){return Jt.isPlainObject(d)&&Jt.isPlainObject(g)?Jt.merge.call({caseless:x},d,g):Jt.isPlainObject(g)?Jt.merge({},g):Jt.isArray(g)?g.slice():g}function i(d,g,y,x){if(Jt.isUndefined(g)){if(!Jt.isUndefined(d))return r(void 0,d,y,x)}else return r(d,g,y,x)}function s(d,g){if(!Jt.isUndefined(g))return r(void 0,g)}function o(d,g){if(Jt.isUndefined(g)){if(!Jt.isUndefined(d))return r(void 0,d)}else return r(void 0,g)}function u(d,g,y){if(y in t)return r(d,g);if(y in e)return r(void 0,d)}const f={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:u,headers:(d,g,y)=>i(P_(d),P_(g),y,!0)};return Jt.forEach(Object.keys(Object.assign({},e,t)),function(g){const y=f[g]||i,x=y(e[g],t[g],g);Jt.isUndefined(x)&&y!==u||(n[g]=x)}),n}const L5=e=>{const t=oh({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:s,headers:o,auth:u}=t;t.headers=o=El.from(o),t.url=v5(x5(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&o.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):"")));let f;if(Jt.isFormData(n)){if(Ra.hasStandardBrowserEnv||Ra.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((f=o.getContentType())!==!1){const[d,...g]=f?f.split(";").map(y=>y.trim()).filter(Boolean):[];o.setContentType([d||"multipart/form-data",...g].join("; "))}}if(Ra.hasStandardBrowserEnv&&(r&&Jt.isFunction(r)&&(r=r(t)),r||r!==!1&&Dk(t.url))){const d=i&&s&&Ik.read(s);d&&o.set(i,d)}return t},Rk=typeof XMLHttpRequest<"u",Fk=Rk&&function(e){return new Promise(function(n,r){const i=L5(e);let s=i.data;const o=El.from(i.headers).normalize();let{responseType:u,onUploadProgress:f,onDownloadProgress:d}=i,g,y,x,_,M;function T(){_&&_(),M&&M(),i.cancelToken&&i.cancelToken.unsubscribe(g),i.signal&&i.signal.removeEventListener("abort",g)}let D=new XMLHttpRequest;D.open(i.method.toUpperCase(),i.url,!0),D.timeout=i.timeout;function I(){if(!D)return;const Z=El.from("getAllResponseHeaders"in D&&D.getAllResponseHeaders()),ue={data:!u||u==="text"||u==="json"?D.responseText:D.response,status:D.status,statusText:D.statusText,headers:Z,config:e,request:D};w5(function(ge){n(ge),T()},function(ge){r(ge),T()},ue),D=null}"onloadend"in D?D.onloadend=I:D.onreadystatechange=function(){!D||D.readyState!==4||D.status===0&&!(D.responseURL&&D.responseURL.indexOf("file:")===0)||setTimeout(I)},D.onabort=function(){D&&(r(new oi("Request aborted",oi.ECONNABORTED,e,D)),D=null)},D.onerror=function(){r(new oi("Network Error",oi.ERR_NETWORK,e,D)),D=null},D.ontimeout=function(){let te=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const ue=i.transitional||y5;i.timeoutErrorMessage&&(te=i.timeoutErrorMessage),r(new oi(te,ue.clarifyTimeoutError?oi.ETIMEDOUT:oi.ECONNABORTED,e,D)),D=null},s===void 0&&o.setContentType(null),"setRequestHeader"in D&&Jt.forEach(o.toJSON(),function(te,ue){D.setRequestHeader(ue,te)}),Jt.isUndefined(i.withCredentials)||(D.withCredentials=!!i.withCredentials),u&&u!=="json"&&(D.responseType=i.responseType),d&&([x,M]=fm(d,!0),D.addEventListener("progress",x)),f&&D.upload&&([y,_]=fm(f),D.upload.addEventListener("progress",y),D.upload.addEventListener("loadend",_)),(i.cancelToken||i.signal)&&(g=Z=>{D&&(r(!Z||Z.type?new dd(null,e,D):Z),D.abort(),D=null)},i.cancelToken&&i.cancelToken.subscribe(g),i.signal&&(i.signal.aborted?g():i.signal.addEventListener("abort",g)));const j=kk(i.url);if(j&&Ra.protocols.indexOf(j)===-1){r(new oi("Unsupported protocol "+j+":",oi.ERR_BAD_REQUEST,e));return}D.send(s||null)})},jk=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let r=new AbortController,i;const s=function(d){if(!i){i=!0,u();const g=d instanceof Error?d:this.reason;r.abort(g instanceof oi?g:new dd(g instanceof Error?g.message:g))}};let o=t&&setTimeout(()=>{o=null,s(new oi(`timeout ${t} of ms exceeded`,oi.ETIMEDOUT))},t);const u=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(s):d.removeEventListener("abort",s)}),e=null)};e.forEach(d=>d.addEventListener("abort",s));const{signal:f}=r;return f.unsubscribe=()=>Jt.asap(u),f}},zk=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let r=0,i;for(;r<n;)i=r+t,yield e.slice(r,i),r=i},$k=async function*(e,t){for await(const n of Uk(e))yield*zk(n,t)},Uk=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:r}=await t.read();if(n)break;yield r}}finally{await t.cancel()}},M_=(e,t,n,r)=>{const i=$k(e,t);let s=0,o,u=f=>{o||(o=!0,r&&r(f))};return new ReadableStream({async pull(f){try{const{done:d,value:g}=await i.next();if(d){u(),f.close();return}let y=g.byteLength;if(n){let x=s+=y;n(x)}f.enqueue(new Uint8Array(g))}catch(d){throw u(d),d}},cancel(f){return u(f),i.return()}},{highWaterMark:2})},Qm=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",S5=Qm&&typeof ReadableStream=="function",Vk=Qm&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),C5=(e,...t)=>{try{return!!e(...t)}catch{return!1}},Gk=S5&&C5(()=>{let e=!1;const t=new Request(Ra.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),A_=64*1024,Xv=S5&&C5(()=>Jt.isReadableStream(new Response("").body)),hm={stream:Xv&&(e=>e.body)};Qm&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!hm[t]&&(hm[t]=Jt.isFunction(e[t])?n=>n[t]():(n,r)=>{throw new oi(`Response type '${t}' is not supported`,oi.ERR_NOT_SUPPORT,r)})})})(new Response);const Hk=async e=>{if(e==null)return 0;if(Jt.isBlob(e))return e.size;if(Jt.isSpecCompliantForm(e))return(await new Request(Ra.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(Jt.isArrayBufferView(e)||Jt.isArrayBuffer(e))return e.byteLength;if(Jt.isURLSearchParams(e)&&(e=e+""),Jt.isString(e))return(await Vk(e)).byteLength},qk=async(e,t)=>{const n=Jt.toFiniteNumber(e.getContentLength());return n??Hk(t)},Wk=Qm&&(async e=>{let{url:t,method:n,data:r,signal:i,cancelToken:s,timeout:o,onDownloadProgress:u,onUploadProgress:f,responseType:d,headers:g,withCredentials:y="same-origin",fetchOptions:x}=L5(e);d=d?(d+"").toLowerCase():"text";let _=jk([i,s&&s.toAbortSignal()],o),M;const T=_&&_.unsubscribe&&(()=>{_.unsubscribe()});let D;try{if(f&&Gk&&n!=="get"&&n!=="head"&&(D=await qk(g,r))!==0){let ue=new Request(t,{method:"POST",body:r,duplex:"half"}),le;if(Jt.isFormData(r)&&(le=ue.headers.get("content-type"))&&g.setContentType(le),ue.body){const[ge,H]=C_(D,fm(E_(f)));r=M_(ue.body,A_,ge,H)}}Jt.isString(y)||(y=y?"include":"omit");const I="credentials"in Request.prototype;M=new Request(t,{...x,signal:_,method:n.toUpperCase(),headers:g.normalize().toJSON(),body:r,duplex:"half",credentials:I?y:void 0});let j=await fetch(M);const Z=Xv&&(d==="stream"||d==="response");if(Xv&&(u||Z&&T)){const ue={};["status","statusText","headers"].forEach(U=>{ue[U]=j[U]});const le=Jt.toFiniteNumber(j.headers.get("content-length")),[ge,H]=u&&C_(le,fm(E_(u),!0))||[];j=new Response(M_(j.body,A_,ge,()=>{H&&H(),T&&T()}),ue)}d=d||"text";let te=await hm[Jt.findKey(hm,d)||"text"](j,e);return!Z&&T&&T(),await new Promise((ue,le)=>{w5(ue,le,{data:te,headers:El.from(j.headers),status:j.status,statusText:j.statusText,config:e,request:M})})}catch(I){throw T&&T(),I&&I.name==="TypeError"&&/fetch/i.test(I.message)?Object.assign(new oi("Network Error",oi.ERR_NETWORK,e,M),{cause:I.cause||I}):oi.from(I,I&&I.code,e,M)}}),Qv={http:lk,xhr:Fk,fetch:Wk};Jt.forEach(Qv,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const k_=e=>`- ${e}`,Zk=e=>Jt.isFunction(e)||e===null||e===!1,E5={getAdapter:e=>{e=Jt.isArray(e)?e:[e];const{length:t}=e;let n,r;const i={};for(let s=0;s<t;s++){n=e[s];let o;if(r=n,!Zk(n)&&(r=Qv[(o=String(n)).toLowerCase()],r===void 0))throw new oi(`Unknown adapter '${o}'`);if(r)break;i[o||"#"+s]=r}if(!r){const s=Object.entries(i).map(([u,f])=>`adapter ${u} `+(f===!1?"is not supported by the environment":"is not available in the build"));let o=t?s.length>1?`since :
`+s.map(k_).join(`
`):" "+k_(s[0]):"as no adapter specified";throw new oi("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:Qv};function J0(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new dd(null,e)}function T_(e){return J0(e),e.headers=El.from(e.headers),e.data=Y0.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),E5.getAdapter(e.adapter||Ip.adapter)(e).then(function(r){return J0(e),r.data=Y0.call(e,e.transformResponse,r),r.headers=El.from(r.headers),r},function(r){return b5(r)||(J0(e),r&&r.response&&(r.response.data=Y0.call(e,e.transformResponse,r.response),r.response.headers=El.from(r.response.headers))),Promise.reject(r)})}const P5="1.8.4",e0={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{e0[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const N_={};e0.transitional=function(t,n,r){function i(s,o){return"[Axios v"+P5+"] Transitional option '"+s+"'"+o+(r?". "+r:"")}return(s,o,u)=>{if(t===!1)throw new oi(i(o," has been removed"+(n?" in "+n:"")),oi.ERR_DEPRECATED);return n&&!N_[o]&&(N_[o]=!0,console.warn(i(o," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(s,o,u):!0}};e0.spelling=function(t){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function Kk(e,t,n){if(typeof e!="object")throw new oi("options must be an object",oi.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const s=r[i],o=t[s];if(o){const u=e[s],f=u===void 0||o(u,s,e);if(f!==!0)throw new oi("option "+s+" must be "+f,oi.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new oi("Unknown option "+s,oi.ERR_BAD_OPTION)}}const Rg={assertOptions:Kk,validators:e0},rc=Rg.validators;let eh=class{constructor(t){this.defaults=t,this.interceptors={request:new L_,response:new L_}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?s&&!String(r.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+s):r.stack=s}catch{}}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=oh(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:s}=n;r!==void 0&&Rg.assertOptions(r,{silentJSONParsing:rc.transitional(rc.boolean),forcedJSONParsing:rc.transitional(rc.boolean),clarifyTimeoutError:rc.transitional(rc.boolean)},!1),i!=null&&(Jt.isFunction(i)?n.paramsSerializer={serialize:i}:Rg.assertOptions(i,{encode:rc.function,serialize:rc.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Rg.assertOptions(n,{baseUrl:rc.spelling("baseURL"),withXsrfToken:rc.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=s&&Jt.merge(s.common,s[n.method]);s&&Jt.forEach(["delete","get","head","post","put","patch","common"],M=>{delete s[M]}),n.headers=El.concat(o,s);const u=[];let f=!0;this.interceptors.request.forEach(function(T){typeof T.runWhen=="function"&&T.runWhen(n)===!1||(f=f&&T.synchronous,u.unshift(T.fulfilled,T.rejected))});const d=[];this.interceptors.response.forEach(function(T){d.push(T.fulfilled,T.rejected)});let g,y=0,x;if(!f){const M=[T_.bind(this),void 0];for(M.unshift.apply(M,u),M.push.apply(M,d),x=M.length,g=Promise.resolve(n);y<x;)g=g.then(M[y++],M[y++]);return g}x=u.length;let _=n;for(y=0;y<x;){const M=u[y++],T=u[y++];try{_=M(_)}catch(D){T.call(this,D);break}}try{g=T_.call(this,_)}catch(M){return Promise.reject(M)}for(y=0,x=d.length;y<x;)g=g.then(d[y++],d[y++]);return g}getUri(t){t=oh(this.defaults,t);const n=x5(t.baseURL,t.url,t.allowAbsoluteUrls);return v5(n,t.params,t.paramsSerializer)}};Jt.forEach(["delete","get","head","options"],function(t){eh.prototype[t]=function(n,r){return this.request(oh(r||{},{method:t,url:n,data:(r||{}).data}))}});Jt.forEach(["post","put","patch"],function(t){function n(r){return function(s,o,u){return this.request(oh(u||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}eh.prototype[t]=n(),eh.prototype[t+"Form"]=n(!0)});let Yk=class M5{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(s){n=s});const r=this;this.promise.then(i=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](i);r._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(u=>{r.subscribe(u),s=u}).then(i);return o.cancel=function(){r.unsubscribe(s)},o},t(function(s,o,u){r.reason||(r.reason=new dd(s,o,u),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=r=>{t.abort(r)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new M5(function(i){t=i}),cancel:t}}};function Jk(e){return function(n){return e.apply(null,n)}}function Xk(e){return Jt.isObject(e)&&e.isAxiosError===!0}const e1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(e1).forEach(([e,t])=>{e1[t]=e});function A5(e){const t=new eh(e),n=s5(eh.prototype.request,t);return Jt.extend(n,eh.prototype,t,{allOwnKeys:!0}),Jt.extend(n,t,null,{allOwnKeys:!0}),n.create=function(i){return A5(oh(e,i))},n}const Ls=A5(Ip);Ls.Axios=eh;Ls.CanceledError=dd;Ls.CancelToken=Yk;Ls.isCancel=b5;Ls.VERSION=P5;Ls.toFormData=Xm;Ls.AxiosError=oi;Ls.Cancel=Ls.CanceledError;Ls.all=function(t){return Promise.all(t)};Ls.spread=Jk;Ls.isAxiosError=Xk;Ls.mergeConfig=oh;Ls.AxiosHeaders=El;Ls.formToJSON=e=>_5(Jt.isHTMLForm(e)?new FormData(e):e);Ls.getAdapter=E5.getAdapter;Ls.HttpStatusCode=e1;Ls.default=Ls;const{Axios:ZV,AxiosError:KV,CanceledError:YV,isCancel:JV,CancelToken:XV,VERSION:QV,all:eG,Cancel:tG,isAxiosError:nG,spread:rG,toFormData:iG,AxiosHeaders:oG,HttpStatusCode:sG,formToJSON:aG,getAdapter:lG,mergeConfig:uG}=Ls,gn=Yl({measures:[],longTasks:[],memorySnapshots:[],framesPerSecond:0,lastFpsUpdate:0,frameCount:0,isRecording:!1,isEnabled:!1,startTime:0,currentOperation:null,operationStack:[],operationHistory:[]});let bf=null,Yf=null;const Qk=1e3;function t0(){if(gn.isEnabled){gn.isRecording=!0,gn.startTime=performance.now(),gn.frameCount=0,gn.lastFpsUpdate=performance.now();try{window.PerformanceObserver&&PerformanceObserver.supportedEntryTypes.includes("longtask")&&(bf=new PerformanceObserver(e=>{e.getEntries().forEach(n=>{gn.longTasks.push({duration:n.duration,startTime:n.startTime,name:n.name,component:Gu()})})}),bf.observe({entryTypes:["longtask"]}))}catch(e){console.warn("PerformanceObserver pour longues tâches non supporté",e)}eT(),ly()}}function dm(){gn.isRecording=!1,bf&&(bf.disconnect(),bf=null),D5()}function t1(){bf&&(bf.disconnect(),bf=null),D5(),gn.measures=[],gn.longTasks=[],gn.memorySnapshots=[],gn.operationHistory=[],gn.frameCount=0,gn.framesPerSecond=0,gn.lastFpsUpdate=0,gn.isEnabled&&t0()}function k5(e,t,n){if(!gn.isEnabled||!gn.isRecording)return()=>{};const r=performance.now(),i=gn.currentOperation;return gn.currentOperation=e,gn.operationStack.push(e),()=>{const s=performance.now()-r;gn.operationStack.pop(),gn.currentOperation=gn.operationStack[gn.operationStack.length-1]||null,gn.measures.push({name:e,startTime:r,duration:s,component:t||Gu(),info:n,parentOperation:i||void 0}),s>10&&gn.operationHistory.push({operation:e,component:t||Gu()||"unknown",durationMs:s,timestamp:Date.now()})}}async function T5(e,t,n,r){if(!gn.isEnabled||!gn.isRecording)return t();const i=performance.now(),s=gn.currentOperation;gn.currentOperation=e,gn.operationStack.push(e);try{return await t()}finally{const o=performance.now()-i;gn.operationStack.pop(),gn.currentOperation=gn.operationStack[gn.operationStack.length-1]||null,gn.measures.push({name:e,startTime:i,duration:o,component:n||Gu(),info:r,parentOperation:s||void 0}),o>10&&gn.operationHistory.push({operation:e,component:n||Gu()||"unknown",durationMs:o,timestamp:Date.now()})}}function N5(e,t,n,r){if(!gn.isEnabled||!gn.isRecording)return t();const i=performance.now(),s=gn.currentOperation;gn.currentOperation=e,gn.operationStack.push(e);try{return t()}finally{const o=performance.now()-i;gn.operationStack.pop(),gn.currentOperation=gn.operationStack[gn.operationStack.length-1]||null,gn.measures.push({name:e,startTime:i,duration:o,component:n||Gu(),info:r,parentOperation:s||void 0}),o>10&&gn.operationHistory.push({operation:e,component:n||Gu()||"unknown",durationMs:o,timestamp:Date.now()})}}function ly(){!gn.isEnabled||!gn.isRecording||(performance.memory?gn.memorySnapshots.push({jsHeapSizeLimit:performance.memory.jsHeapSizeLimit,totalJSHeapSize:performance.memory.totalJSHeapSize,usedJSHeapSize:performance.memory.usedJSHeapSize,timestamp:performance.now()}):gn.memorySnapshots.push({timestamp:performance.now()}))}function eT(){Yf!==null&&cancelAnimationFrame(Yf),gn.frameCount=0,gn.lastFpsUpdate=performance.now();function e(){gn.frameCount++;const t=performance.now();t-gn.lastFpsUpdate>=Qk&&(gn.framesPerSecond=Math.round(gn.frameCount*1e3/(t-gn.lastFpsUpdate)),gn.frameCount=0,gn.lastFpsUpdate=t),gn.isRecording&&(Yf=requestAnimationFrame(e))}Yf=requestAnimationFrame(e)}function D5(){Yf!==null&&(cancelAnimationFrame(Yf),Yf=null)}function Gu(){return""}function n1(e){gn.isEnabled=e,e&&!gn.isRecording?t0():!e&&gn.isRecording&&dm()}function I5(e,t,n){return(...r)=>{if(!gn.isEnabled||!gn.isRecording)return e(...r);const i=performance.now();try{return e(...r)}finally{const s=performance.now()-i;gn.measures.push({name:t,startTime:i,duration:s,component:n||Gu(),info:{args:r}}),s>10&&gn.operationHistory.push({operation:t,component:n||Gu()||"unknown",durationMs:s,timestamp:Date.now()})}}}function O5(e,t,n){return async(...r)=>{if(!gn.isEnabled||!gn.isRecording)return await e(...r);const i=performance.now();try{return await e(...r)}finally{const s=performance.now()-i;gn.measures.push({name:t,startTime:i,duration:s,component:n||Gu(),info:{args:r}}),s>10&&gn.operationHistory.push({operation:t,component:n||Gu()||"unknown",durationMs:s,timestamp:Date.now()})}}}function tT(e,t){const n=gn.measures.filter(o=>o.startTime>=e&&o.startTime+o.duration<=t),r=new Map,i=[];n.forEach(o=>{o.parentOperation?(r.has(o.parentOperation)||r.set(o.parentOperation,[]),r.get(o.parentOperation).push(o)):i.push(o)});function s(o){const u=r.get(o.name)||[];return{operation:o.name,duration:o.duration,component:o.component,children:u.sort((f,d)=>d.duration-f.duration).map(f=>s(f))}}return i.sort((o,u)=>u.duration-o.duration).map(o=>s(o))}function r1(e,t){const n=e||gn.startTime,r=t||performance.now(),i=tT(n,r),s=r-n,o=new Map;function u(d){const g=o.get(d.operation)||{duration:0,component:d.component};g.duration+=d.duration,o.set(d.operation,g),d.children.forEach(y=>u(y))}i.forEach(d=>u(d));const f=Array.from(o.entries()).map(([d,{duration:g,component:y}])=>({operation:d,duration:g,component:y,impact:g/s*100})).sort((d,g)=>g.impact-d.impact).slice(0,10);return{criticalPaths:i,totalTime:s,bottlenecks:f}}function pd(){const e=Ft(!1);$s(()=>{try{const r=new URL(window.location.href).searchParams.get("perf")==="true";e.value=r,n1(r),t1()}catch(n){console.warn("Erreur lors de la vérification du paramètre perf:",n),e.value=!1,n1(!1)}}),mc(()=>{gn.isRecording&&dm()});const t=(n,r)=>{if(!gn.isEnabled||!gn.isRecording)return null;const i=gn.measures.find(d=>d.name===n&&d.startTime===r);if(!i)return null;const s=i.startTime+i.duration,o=gn.measures.filter(d=>d.startTime>=i.startTime&&d.startTime<=s&&d!==i),u=gn.longTasks.filter(d=>d.startTime>=i.startTime&&d.startTime<=s),f=gn.memorySnapshots.filter(d=>d.timestamp>=i.startTime&&d.timestamp<=s);return{operation:{name:i.name,component:i.component,startTime:i.startTime,duration:i.duration,info:i.info},context:{relatedOperations:o.map(d=>({name:d.name,component:d.component,startTime:d.startTime-i.startTime,duration:d.duration,info:d.info})),longTasks:u.map(d=>({duration:d.duration,startTime:d.startTime-i.startTime,name:d.name,component:d.component})),memorySnapshots:f.map(d=>({...d,timestamp:d.timestamp-i.startTime}))},summary:{totalRelatedOperations:o.length,totalLongTasks:u.length,maxLongTaskDuration:Math.max(...u.map(d=>d.duration),0),memoryDelta:f.length>1?(f[f.length-1].usedJSHeapSize||0)-(f[0].usedJSHeapSize||0):0}}};return{isEnabled:Bu(Ft(gn.isEnabled)),isQueryParamEnabled:Bu(e),isRecording:Bu(Ft(gn.isRecording)),measures:Bu(Ft(gn.measures)),longTasks:Bu(Ft(gn.longTasks)),memorySnapshots:Bu(Ft(gn.memorySnapshots)),framesPerSecond:Bu(Ft(gn.framesPerSecond)),operationHistory:Bu(Ft(gn.operationHistory)),startRecording:t0,stopRecording:dm,clearRecording:t1,startMeasure:k5,measure:N5,measureAsync:T5,captureMemorySnapshot:ly,createPerformanceTracker:I5,createAsyncPerformanceTracker:O5,getOperationDetails:t,getSlowOperations:()=>!gn.isEnabled||!gn.isRecording?[]:[...gn.measures].sort((n,r)=>r.duration-n.duration).slice(0,10),getLongTasks:()=>!gn.isEnabled||!gn.isRecording?[]:[...gn.longTasks].sort((n,r)=>r.duration-n.duration),getPerformanceReport:()=>{if(!gn.isEnabled||!gn.isRecording)return null;const n=r1();return{totalMeasures:gn.measures.length,totalLongTasks:gn.longTasks.length,slowestOperations:[...gn.measures].sort((r,i)=>i.duration-r.duration).slice(0,10),averageFps:gn.framesPerSecond,memoryUsage:gn.memorySnapshots.length>0?gn.memorySnapshots[gn.memorySnapshots.length-1]:null,operationsByComponent:nT(gn.measures),criticalPaths:n.criticalPaths,bottlenecks:n.bottlenecks,recordingDuration:gn.isRecording?performance.now()-gn.startTime:null}},analyzeCriticalPaths:r1}}function nT(e){if(!gn.isEnabled||!gn.isRecording)return{};const t={};return e.forEach(n=>{const r=n.component||"unknown";t[r]||(t[r]={totalTime:0,callCount:0,operations:{}}),t[r].totalTime+=n.duration,t[r].callCount++,t[r].operations[n.name]||(t[r].operations[n.name]={totalTime:0,callCount:0}),t[r].operations[n.name].totalTime+=n.duration,t[r].operations[n.name].callCount++}),t}const hn={startRecording:t0,stopRecording:dm,clearRecording:t1,startMeasure:k5,measure:N5,measureAsync:T5,captureMemorySnapshot:ly,createPerformanceTracker:I5,createAsyncPerformanceTracker:O5,setEnabled:n1,analyzeCriticalPaths:r1},Rn=Ls.create({baseURL:"/api",headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0}),$r=pd();function B5(e){var r;const n=`; ${document.cookie}`.split(`; ${e}=`);return n.length===2&&((r=n.pop())==null?void 0:r.split(";").shift())||null}Rn.interceptors.request.use(async e=>{const t=$r.startMeasure("api_request_interceptor","ApiService");try{const n=B5("access_token");return n&&(e.headers.Authorization=`Bearer ${n}`),console.log("Request config:",{url:e.url,method:e.method,headers:e.headers,withCredentials:e.withCredentials}),e}finally{t()}},e=>(console.error("Request interceptor error:",e),Promise.reject(e)));Rn.interceptors.response.use(e=>e,async e=>{var r,i;const t=$r.startMeasure("api_response_interceptor","ApiService"),n=e.config;try{if(((r=e.response)==null?void 0:r.status)===401&&!n._retry&&!((i=n.url)!=null&&i.includes("/token/refresh/"))){n._retry=!0;const s=ma();try{await $r.measureAsync("token_refresh",()=>s.refreshToken(),"ApiService");const o=B5("access_token");if(o)return n.headers.Authorization=`Bearer ${o}`,Rn(n)}catch(o){return await s.logout(),window.location.pathname!=="/login"&&(window.location.href="/login"),Promise.reject(o)}}return Promise.reject(e)}finally{t()}});function R5(e){var n;const t=[];if((n=e.response)!=null&&n.data){const r=e.response.data;typeof r=="object"&&!Array.isArray(r)?Object.entries(r).forEach(([i,s])=>{Array.isArray(s)?s.forEach(o=>{t.push({field:i,message:o})}):typeof s=="string"&&t.push({field:i,message:s})}):typeof r=="string"?t.push({field:"non_field_error",message:r}):r.detail&&t.push({field:"non_field_error",message:r.detail})}else e.message&&t.push({field:"non_field_error",message:`Erreur de connexion: ${e.message}`});return t.length===0&&t.push({field:"non_field_error",message:"Une erreur inconnue s'est produite"}),t}const rT={async login(e,t){const n=$r.startMeasure("auth_login","AuthService");try{return(await $r.measureAsync("login_request",()=>Rn.post("/token/",{username:e,password:t}),"AuthService")).data}finally{n()}},async logout(){const e=$r.startMeasure("auth_logout","AuthService");try{await $r.measureAsync("logout_request",()=>Rn.post("/token/logout/"),"AuthService")}finally{e()}},async register(e){const t=$r.startMeasure("auth_register","AuthService");try{return await $r.measureAsync("register_request",()=>Rn.post("/register/",e),"AuthService")}finally{t()}}};async function np(e){console.log("[fetchUsersByHierarchy] Récupération des utilisateurs:",e);const t={role:e.role};e.entrepriseId&&(t.entreprise=e.entrepriseId),e.salarieId&&(t.salarie=e.salarieId),e.includeDetails&&(t.include_plans=!0),e.search&&(t.search=e.search),console.log("[fetchUsersByHierarchy] Filtres appliqués:",t);try{const n=await el.getUsers(t);return console.log(`[fetchUsersByHierarchy] Résultat (${n.data.length} utilisateurs):`,n.data),n.data}catch(n){throw console.error("[fetchUsersByHierarchy] Erreur lors de la récupération des utilisateurs:",n),n}}const el={async getUsers(e={}){const t=$r.startMeasure("get_users","UserService");try{return await $r.measureAsync("get_users_request",()=>Rn.get("/users/",{params:e}),"UserService")}finally{t()}},async getUser(e){return await Rn.get(`/users/${e}/`)},async createUser(e){return await Rn.post("/users/",e)},async updateUser(e,t){return await Rn.patch(`/users/${e}/`,t)},async deleteUser(e){return await Rn.delete(`/users/${e}/`)},async getEntreprises(){return await Rn.get("/users/",{params:{role:"ENTREPRISE"}})},async getSalaries(e){const t={role:"SALARIE"};return e&&(t.entreprise=e),await Rn.get("/users/",{params:t})},async getSalarieVisiteurs(e){return await Rn.get("/users/",{params:{role:"VISITEUR",salarie:e}})},async getEntrepriseVisiteurs(e){return await Rn.get("/users/",{params:{role:"VISITEUR",entreprise:e}})},async getUsersByHierarchy(e){const t=$r.startMeasure("get_users_hierarchy","UserService");try{const n=$r.measure("prepare_hierarchy_filters",()=>{const r={role:e.role};return e.entrepriseId&&(r.entreprise=e.entrepriseId),e.salarieId&&(r.salarie=e.salarieId),e.includeDetails&&(r.include_plans=!0),e.search&&(r.search=e.search),r},"UserService");return await $r.measureAsync("get_users_hierarchy_request",()=>Rn.get("/users/",{params:n}),"UserService")}finally{t()}},async getEntrepriseSalaries(e){return await Rn.get("/users/",{params:{role:"SALARIE",entreprise:e}})},async getVisiteurs(e,t){const n={role:"VISITEUR"};return e&&(n.salarie=e),t&&(n.entreprise=t),await Rn.get("/users/",{params:n})},async assignEntrepriseToSalarie(e,t){return await Rn.patch(`/users/${e}/`,{entreprise:t})},async assignSalarieToVisiteur(e,t){return await Rn.patch(`/users/${e}/`,{salarie:t})},formatLogoFileName(e){return $r.measure("format_logo_filename",()=>{var i;const t=new Date().getTime(),n=((i=e.name.split(".").pop())==null?void 0:i.toLowerCase())||"";return`${e.name.split(".")[0].toLowerCase().replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}-${t}.${n}`},"UserService")},async uploadLogo(e){const t=$r.startMeasure("upload_logo","UserService");try{const n=new FormData,r=this.formatLogoFileName(e),i=new File([e],r,{type:e.type});return n.append("logo",i),await $r.measureAsync("upload_logo_request",()=>Rn.post("/users/upload_logo/",n,{headers:{"Content-Type":"multipart/form-data"}}),"UserService")}finally{t()}}},Fd={async getPlans(){const e=$r.startMeasure("get_plans","IrrigationService");try{return await $r.measureAsync("get_plans_request",()=>Rn.get("/plans/"),"IrrigationService")}finally{e()}},async createPlan(e){const t=$r.startMeasure("create_plan","IrrigationService");try{const n=$r.measure("format_plan_data",()=>({...e,entreprise:e.entreprise?typeof e.entreprise=="object"&&"id"in e.entreprise?e.entreprise.id:Number(e.entreprise):null,salarie:e.salarie?typeof e.salarie=="object"&&"id"in e.salarie?e.salarie.id:Number(e.salarie):null,visiteur:e.visiteur?typeof e.visiteur=="object"&&"id"in e.visiteur?e.visiteur.id:Number(e.visiteur):null}),"IrrigationService");return await $r.measureAsync("create_plan_request",()=>Rn.post("/plans/",n),"IrrigationService")}finally{t()}},async updatePlan(e,t){const n=$r.startMeasure("update_plan","IrrigationService");try{return await $r.measureAsync("update_plan_request",()=>Rn.put(`/plans/${e}/`,t),"IrrigationService")}finally{n()}},async deletePlan(e){const t=$r.startMeasure("delete_plan","IrrigationService");try{return await $r.measureAsync("delete_plan_request",()=>Rn.delete(`/plans/${e}/`),"IrrigationService")}finally{t()}},async getVisiteurPlans(e){return await Rn.get("/plans/",{params:{visiteur:e}})},async createPlanForVisiteur(e){return await Rn.post("/plans/",e)},async getEntreprisePlans(e){return await Rn.get("/plans/",{params:{entreprise:e}})},async getSalariePlans(e){return await Rn.get("/plans/",{params:{salarie:e}})},async createPlanForSalarie(e,t){const n={...e,salarie:t};return await Rn.post("/plans/",n)},async createPlanForEntreprise(e,t){const n={...e,entreprise:t};return await Rn.post("/plans/",n)}},pu={async getNotes(e={}){const t=$r.startMeasure("get_notes","NoteService");try{return await $r.measureAsync("get_notes_request",()=>Rn.get("/notes/",{params:e}),"NoteService")}finally{t()}},async getNote(e){const t=$r.startMeasure("get_note","NoteService");try{return await $r.measureAsync("get_note_request",()=>Rn.get(`/notes/${e}/`),"NoteService")}finally{t()}},async createNote(e){const t=$r.startMeasure("create_note","NoteService");try{return await $r.measureAsync("create_note_request",()=>Rn.post("/notes/",e),"NoteService")}finally{t()}},async updateNote(e,t){console.log("[noteService][updateNote] Mise à jour de la note:",{noteId:e,noteData:t});const n=$r.startMeasure("update_note","NoteService");try{const r={...t};t.column!==void 0?r.column=t.column.toString():t.columnId!==void 0&&(r.column=t.columnId.toString()),delete r.columnId,delete r.column_id,delete r.column_details,console.log("[noteService][updateNote] Données formatées:",r);const i=await $r.measureAsync("update_note_request",()=>Rn.patch(`/notes/${e}/`,r),"NoteService");return console.log("[noteService][updateNote] Réponse du serveur:",i.data),i}catch(r){throw console.error("[noteService][updateNote] Erreur lors de la mise à jour:",r),r}finally{n()}},async deleteNote(e){const t=$r.startMeasure("delete_note","NoteService");try{return await $r.measureAsync("delete_note_request",()=>Rn.delete(`/notes/${e}/`),"NoteService")}finally{t()}},async getComments(e){return await Rn.get(`/notes/${e}/comments/`)},async addComment(e,t){return await Rn.post(`/notes/${e}/comments/`,t)},async updateComment(e,t,n){return await Rn.patch(`/notes/${e}/comments/${t}/`,n)},async deleteComment(e,t){return await Rn.delete(`/notes/${e}/comments/${t}/`)},async getPhotos(e){return await Rn.get(`/notes/${e}/photos/`)},async addPhoto(e,t){return await Rn.post(`/notes/${e}/photos/`,t,{headers:{"Content-Type":"multipart/form-data"}})},async updatePhoto(e,t,n){return await Rn.patch(`/notes/${e}/photos/${t}/`,n)},async deletePhoto(e,t){return await Rn.delete(`/notes/${e}/photos/${t}/`)}},iT={async getColumns(){console.log(`
[columnService][getColumns] Récupération des colonnes`);const e=$r.startMeasure("get_columns","ColumnService");try{const t=await $r.measureAsync("get_columns_request",()=>Rn.get("/columns/"),"ColumnService");return console.log("[columnService][getColumns] Réponse:",t.data),t}catch(t){throw console.error("[columnService][getColumns] Erreur:",t),t}finally{e()}},async createColumn(e){console.log(`
[columnService][createColumn] Création d'une colonne:`,e);const t=$r.startMeasure("create_column","ColumnService");try{const n=await $r.measureAsync("create_column_request",()=>Rn.post("/columns/",e),"ColumnService");return console.log("[columnService][createColumn] Réponse:",n.data),n}catch(n){throw console.error("[columnService][createColumn] Erreur:",n),n}finally{t()}},async updateColumn(e,t){console.log(`
[columnService][updateColumn] Mise à jour de la colonne:`,e,t);const n=$r.startMeasure("update_column","ColumnService");try{const r=await $r.measureAsync("update_column_request",()=>Rn.patch(`/columns/${e}/`,t),"ColumnService");return console.log("[columnService][updateColumn] Réponse:",r.data),r}catch(r){throw console.error("[columnService][updateColumn] Erreur:",r),r}finally{n()}},async deleteColumn(e){const t=$r.startMeasure("delete_column","ColumnService");try{return await $r.measureAsync("delete_column_request",()=>Rn.delete(`/columns/${e}/`),"ColumnService")}finally{t()}},async updateColumnsOrder(e){const t=$r.startMeasure("update_columns_order","ColumnService");try{return await $r.measureAsync("update_columns_order_request",()=>Rn.post("/columns/reorder/",{columns:e}),"ColumnService")}finally{t()}}},oT=Object.freeze(Object.defineProperty({__proto__:null,authService:rT,columnService:iT,default:Rn,fetchUsersByHierarchy:np,formatApiErrors:R5,irrigationService:Fd,noteService:pu,userService:el},Symbol.toStringTag,{value:"Module"}));Rn.defaults.baseURL="/api";Rn.defaults.headers.common["Content-Type"]="application/json";Rn.defaults.withCredentials=!0;function Lp(e){var r;const n=`; ${document.cookie}`.split(`; ${e}=`);return n.length===2&&((r=n.pop())==null?void 0:r.split(";").shift())||null}Rn.interceptors.request.use(e=>{const t=Lp("access_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>(console.error("Request interceptor error:",e),Promise.reject(e)));Rn.interceptors.response.use(e=>e,async e=>{var r,i;const t=ma(),n=e.config;if(((r=e.response)==null?void 0:r.status)===401&&!n._retry&&!((i=n.url)!=null&&i.includes("/token/refresh/"))){n._retry=!0;try{if(!Lp("access_token"))throw new Error("No token available");await t.refreshToken();const o=Lp("access_token");if(o)return n.headers.Authorization=`Bearer ${o}`,Rn(n)}catch(s){console.error("Token refresh failed:",s),await t.logout(),window.location.pathname!=="/login"&&(window.location.href="/login")}}return Promise.reject(e)});function sT(e,t,n=1){const r=new Date;r.setTime(r.getTime()+n*24*60*60*1e3);const i=`expires=${r.toUTCString()}`;document.cookie=`${e}=${t};${i};path=/;secure;samesite=Strict`}function Vl(e){if(!e)return"-";const t=e.first_name||"",n=e.last_name?e.last_name.toUpperCase():"",r=`${t} ${n}`.trim(),i=e.company_name||e.role||"";return!r&&!i?"-":r?i?`${r} (${i})`:r:`(${i})`}function aT(e="",t=""){return`${(e==null?void 0:e.charAt(0))||""}${(t==null?void 0:t.charAt(0))||""}`.toUpperCase()}const lT={ADMIN:"Administrateur",ENTREPRISE:"Entreprise",SALARIE:"Salarie",VISITEUR:"Visiteur"};function uT(e){return lT[e]||e}function cT(){return"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800"}function fT(e){return e?"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800":"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800"}async function hT({role:e,entrepriseId:t,salarieId:n,includeDetails:r=!1}){const i={role:e};return t&&(i.entreprise=t),n&&(i.salarie=n),r&&(i.include_plans=!0),(await el.getUsers(i)).data}const ma=Np("auth",{state:()=>({user:null,isAuthenticated:!1,mustChangePassword:!1,initialized:!1,loading:!1,error:null,enterprises:[],employees:[],visitors:[]}),getters:{isAdmin:e=>{var t;return((t=e.user)==null?void 0:t.user_type)==="admin"},isEntreprise:e=>{var t;return((t=e.user)==null?void 0:t.user_type)==="entreprise"},isSalarie:e=>{var t;return((t=e.user)==null?void 0:t.user_type)==="salarie"},isVisiteur:e=>{var t;return((t=e.user)==null?void 0:t.user_type)==="visiteur"},currentUser:e=>e.user,hasEnterprise:e=>{var t;return!!((t=e.user)!=null&&t.enterprise_id)},hasEmployee:e=>{var t;return!!((t=e.user)!=null&&t.employee_id)}},actions:{async initialize(e){if(!e){const n=await this.restoreSession();return this.initialized=!0,n}if(e.isAuthenticated&&e.user)return this.user=e.user,this.isAuthenticated=!0,this.mustChangePassword=e.user.must_change_password||!1,this.initialized=!0,!0;const t=await this.restoreSession();return this.initialized=!0,t},async restoreSession(){try{if(!Lp("access_token"))return this.isAuthenticated=!1,this.user=null,!1;const t=await Rn.post("/token/refresh/");return t.data.user?(this.user=t.data.user,this.isAuthenticated=!0,this.mustChangePassword=t.data.user.must_change_password||!1,!0):(await this.fetchUserProfile(),!0)}catch(e){return console.error("Failed to restore session:",e),this.isAuthenticated=!1,this.user=null,!1}},async login(e,t){var n,r,i;try{const s=await Rn.post("/token/",{username:e,password:t});if(!s.data.access)throw new Error("Token d'accès non reçu");document.cookie=`access_token=${s.data.access}; path=/; secure; samesite=Strict`;const o=await this.fetchUserProfile();return this.user=o,this.isAuthenticated=!0,!0}catch(s){throw this.isAuthenticated=!1,this.user=null,((n=s.response)==null?void 0:n.status)===401?new Error("Identifiants incorrects"):(i=(r=s.response)==null?void 0:r.data)!=null&&i.detail?new Error(s.response.data.detail):s}},async logout(){this.user=null,this.isAuthenticated=!1,this.mustChangePassword=!1,document.cookie="access_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="refresh_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT"},async checkAuth(){try{return await this.fetchUserProfile(),!0}catch{return this.isAuthenticated=!1,this.user=null,!1}},async fetchUserProfile(){try{const e=await Rn.get("/users/me/");return this.user=e.data,this.isAuthenticated=!0,this.mustChangePassword=e.data.must_change_password||!1,e.data}catch(e){throw this.isAuthenticated=!1,this.user=null,e}},async changePassword(e,t){try{const n=await Rn.post("/users/change_password/",{old_password:e,password:t});return this.user={...this.user,must_change_password:!1},n.data}catch(n){throw console.error("Password change error:",n),n}},async refreshToken(){var e,t;try{if(!Lp("refresh_token"))throw new Error("No refresh token available");const r=await Rn.post("/token/refresh/",{},{withCredentials:!0,_retry:!0}),{access:i}=r.data;if(!i)throw new Error("No access token received");return sT("access_token",i,1),this.isAuthenticated=!0,i}catch(n){throw console.error("Error refreshing token:",{status:(e=n.response)==null?void 0:e.status,data:(t=n.response)==null?void 0:t.data}),this.isAuthenticated=!1,document.cookie="access_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="refresh_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",n}},async fetchUsers(e={}){this.loading=!0;try{return(await el.getUsers(e)).data}catch(t){throw this.error="Erreur lors de la récupération des utilisateurs",t}finally{this.loading=!1}},async fetchEnterprises(){this.loading=!0;try{const e=await el.getUsers({role:"ENTREPRISE"});return this.enterprises=e.data,this.enterprises}catch(e){throw this.error="Erreur lors de la récupération des entreprises",e}finally{this.loading=!1}},async fetchEnterpriseEmployees(e){this.loading=!0;try{const t=await el.getUsers({role:"SALARIE",entreprise:e});return this.employees=t.data,this.employees}catch(t){throw this.error="Erreur lors de la récupération des salaries",t}finally{this.loading=!1}},async fetchEnterpriseVisitors(e){this.loading=!0;try{const t=await el.getUsers({role:"VISITEUR",entreprise:e});return this.visitors=t.data,this.visitors}catch(t){throw this.error="Erreur lors de la récupération des visiteurs",t}finally{this.loading=!1}},async createUser(e){this.loading=!0;try{return(await el.createUser(e)).data}catch(t){throw this.error="Erreur lors de la création de l'utilisateur",t}finally{this.loading=!1}},async updateUser(e,t){this.loading=!0;try{return(await el.updateUser(e,t)).data}catch(n){throw this.error="Erreur lors de la mise à jour de l'utilisateur",n}finally{this.loading=!1}},async deleteUser(e){this.loading=!0;try{return await el.deleteUser(e),!0}catch(t){throw this.error="Erreur lors de la suppression de l'utilisateur",t}finally{this.loading=!1}},async fetchEnterprisesLegacy(){this.loading=!0;try{const e=await Rn.get("/users/",{params:{role:"entreprise"}});this.enterprises=e.data}catch(e){throw this.error="Erreur lors de la récupération des entreprises",e}finally{this.loading=!1}},async setEnterprise(e,t){this.loading=!0;try{await Rn.patch(`/users/${e}/`,{enterprise:t}),this.user&&this.user.id===e&&(this.user.enterprise_id=t)}catch(n){throw this.error="Erreur lors de la mise à jour de l'entreprise",n}finally{this.loading=!1}},async updateUserRole(e,t){this.loading=!0;try{const n=await Rn.patch(`/users/${e}/`,{role:t});return this.user&&this.user.id===e&&(this.user.user_type=t),n.data}catch(n){throw this.error="Erreur lors de la mise à jour du rôle",n}finally{this.loading=!1}},async updateUserEmail(e){var t;this.loading=!0;try{const n=await Rn.patch(`/users/${(t=this.user)==null?void 0:t.id}/`,{email:e});return this.user&&(this.user.email=e),n.data}catch(n){throw this.error="Erreur lors de la mise à jour de l'email",n}finally{this.loading=!1}},async uploadLogo(e){this.loading=!0;try{const t=await el.uploadLogo(e);return this.user&&t.data.logo&&(this.user.logo=t.data.logo),t.data}catch(t){throw this.error="Erreur lors du téléversement du logo",t}finally{this.loading=!1}},checkAccess(e){return this.user?e.includes(this.user.user_type):!1},async fetchUsersByRole(e){this.loading=!0;try{return await hT(e)}catch(t){throw console.error(`Error fetching ${e.role}:`,t),t}finally{this.loading=!1}},async fetchEntrepriseSalaries(e){this.loading=!0;try{return(await el.getUsers({role:"SALARIE",entreprise:e})).data}catch(t){throw this.error="Erreur lors de la récupération des salaries",t}finally{this.loading=!1}},async fetchSalarieVisiteurs(e){this.loading=!0;try{return(await el.getUsers({role:"VISITEUR",salarie:e})).data}catch(t){throw this.error="Erreur lors de la récupération des visiteurs",t}finally{this.loading=!1}}}});/*!
  * vue-router v4.5.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const Bh=typeof document<"u";function F5(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function dT(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&F5(e.default)}const Ki=Object.assign;function X0(e,t){const n={};for(const r in t){const i=t[r];n[r]=Hu(i)?i.map(e):e(i)}return n}const rp=()=>{},Hu=Array.isArray,j5=/#/g,pT=/&/g,gT=/\//g,mT=/=/g,vT=/\?/g,z5=/\+/g,yT=/%5B/g,_T=/%5D/g,$5=/%5E/g,bT=/%60/g,U5=/%7B/g,wT=/%7C/g,V5=/%7D/g,xT=/%20/g;function uy(e){return encodeURI(""+e).replace(wT,"|").replace(yT,"[").replace(_T,"]")}function LT(e){return uy(e).replace(U5,"{").replace(V5,"}").replace($5,"^")}function i1(e){return uy(e).replace(z5,"%2B").replace(xT,"+").replace(j5,"%23").replace(pT,"%26").replace(bT,"`").replace(U5,"{").replace(V5,"}").replace($5,"^")}function ST(e){return i1(e).replace(mT,"%3D")}function CT(e){return uy(e).replace(j5,"%23").replace(vT,"%3F")}function ET(e){return e==null?"":CT(e).replace(gT,"%2F")}function Sp(e){try{return decodeURIComponent(""+e)}catch{}return""+e}const PT=/\/$/,MT=e=>e.replace(PT,"");function Q0(e,t,n="/"){let r,i={},s="",o="";const u=t.indexOf("#");let f=t.indexOf("?");return u<f&&u>=0&&(f=-1),f>-1&&(r=t.slice(0,f),s=t.slice(f+1,u>-1?u:t.length),i=e(s)),u>-1&&(r=r||t.slice(0,u),o=t.slice(u,t.length)),r=NT(r??t,n),{fullPath:r+(s&&"?")+s+o,path:r,query:i,hash:Sp(o)}}function AT(e,t){const n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}function D_(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function kT(e,t,n){const r=t.matched.length-1,i=n.matched.length-1;return r>-1&&r===i&&id(t.matched[r],n.matched[i])&&G5(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}function id(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function G5(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(!TT(e[n],t[n]))return!1;return!0}function TT(e,t){return Hu(e)?I_(e,t):Hu(t)?I_(t,e):e===t}function I_(e,t){return Hu(t)?e.length===t.length&&e.every((n,r)=>n===t[r]):e.length===1&&e[0]===t}function NT(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),r=e.split("/"),i=r[r.length-1];(i===".."||i===".")&&r.push("");let s=n.length-1,o,u;for(o=0;o<r.length;o++)if(u=r[o],u!==".")if(u==="..")s>1&&s--;else break;return n.slice(0,s).join("/")+"/"+r.slice(o).join("/")}const tf={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Cp;(function(e){e.pop="pop",e.push="push"})(Cp||(Cp={}));var ip;(function(e){e.back="back",e.forward="forward",e.unknown=""})(ip||(ip={}));function DT(e){if(!e)if(Bh){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),MT(e)}const IT=/^[^#]+#/;function OT(e,t){return e.replace(IT,"#")+t}function BT(e,t){const n=document.documentElement.getBoundingClientRect(),r=e.getBoundingClientRect();return{behavior:t.behavior,left:r.left-n.left-(t.left||0),top:r.top-n.top-(t.top||0)}}const n0=()=>({left:window.scrollX,top:window.scrollY});function RT(e){let t;if("el"in e){const n=e.el,r=typeof n=="string"&&n.startsWith("#"),i=typeof n=="string"?r?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!i)return;t=BT(i,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function O_(e,t){return(history.state?history.state.position-t:-1)+e}const o1=new Map;function FT(e,t){o1.set(e,t)}function jT(e){const t=o1.get(e);return o1.delete(e),t}let zT=()=>location.protocol+"//"+location.host;function H5(e,t){const{pathname:n,search:r,hash:i}=t,s=e.indexOf("#");if(s>-1){let u=i.includes(e.slice(s))?e.slice(s).length:1,f=i.slice(u);return f[0]!=="/"&&(f="/"+f),D_(f,"")}return D_(n,e)+r+i}function $T(e,t,n,r){let i=[],s=[],o=null;const u=({state:x})=>{const _=H5(e,location),M=n.value,T=t.value;let D=0;if(x){if(n.value=_,t.value=x,o&&o===M){o=null;return}D=T?x.position-T.position:0}else r(_);i.forEach(I=>{I(n.value,M,{delta:D,type:Cp.pop,direction:D?D>0?ip.forward:ip.back:ip.unknown})})};function f(){o=n.value}function d(x){i.push(x);const _=()=>{const M=i.indexOf(x);M>-1&&i.splice(M,1)};return s.push(_),_}function g(){const{history:x}=window;x.state&&x.replaceState(Ki({},x.state,{scroll:n0()}),"")}function y(){for(const x of s)x();s=[],window.removeEventListener("popstate",u),window.removeEventListener("beforeunload",g)}return window.addEventListener("popstate",u),window.addEventListener("beforeunload",g,{passive:!0}),{pauseListeners:f,listen:d,destroy:y}}function B_(e,t,n,r=!1,i=!1){return{back:e,current:t,forward:n,replaced:r,position:window.history.length,scroll:i?n0():null}}function UT(e){const{history:t,location:n}=window,r={value:H5(e,n)},i={value:t.state};i.value||s(r.value,{back:null,current:r.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function s(f,d,g){const y=e.indexOf("#"),x=y>-1?(n.host&&document.querySelector("base")?e:e.slice(y))+f:zT()+e+f;try{t[g?"replaceState":"pushState"](d,"",x),i.value=d}catch(_){console.error(_),n[g?"replace":"assign"](x)}}function o(f,d){const g=Ki({},t.state,B_(i.value.back,f,i.value.forward,!0),d,{position:i.value.position});s(f,g,!0),r.value=f}function u(f,d){const g=Ki({},i.value,t.state,{forward:f,scroll:n0()});s(g.current,g,!0);const y=Ki({},B_(r.value,f,null),{position:g.position+1},d);s(f,y,!1),r.value=f}return{location:r,state:i,push:u,replace:o}}function VT(e){e=DT(e);const t=UT(e),n=$T(e,t.state,t.location,t.replace);function r(s,o=!0){o||n.pauseListeners(),history.go(s)}const i=Ki({location:"",base:e,go:r,createHref:OT.bind(null,e)},t,n);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>t.state.value}),i}function GT(e){return typeof e=="string"||e&&typeof e=="object"}function q5(e){return typeof e=="string"||typeof e=="symbol"}const W5=Symbol("");var R_;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(R_||(R_={}));function od(e,t){return Ki(new Error,{type:e,[W5]:!0},t)}function Dc(e,t){return e instanceof Error&&W5 in e&&(t==null||!!(e.type&t))}const F_="[^/]+?",HT={sensitive:!1,strict:!1,start:!0,end:!0},qT=/[.+*?^${}()[\]/\\]/g;function WT(e,t){const n=Ki({},HT,t),r=[];let i=n.start?"^":"";const s=[];for(const d of e){const g=d.length?[]:[90];n.strict&&!d.length&&(i+="/");for(let y=0;y<d.length;y++){const x=d[y];let _=40+(n.sensitive?.25:0);if(x.type===0)y||(i+="/"),i+=x.value.replace(qT,"\\$&"),_+=40;else if(x.type===1){const{value:M,repeatable:T,optional:D,regexp:I}=x;s.push({name:M,repeatable:T,optional:D});const j=I||F_;if(j!==F_){_+=10;try{new RegExp(`(${j})`)}catch(te){throw new Error(`Invalid custom RegExp for param "${M}" (${j}): `+te.message)}}let Z=T?`((?:${j})(?:/(?:${j}))*)`:`(${j})`;y||(Z=D&&d.length<2?`(?:/${Z})`:"/"+Z),D&&(Z+="?"),i+=Z,_+=20,D&&(_+=-8),T&&(_+=-20),j===".*"&&(_+=-50)}g.push(_)}r.push(g)}if(n.strict&&n.end){const d=r.length-1;r[d][r[d].length-1]+=.7000000000000001}n.strict||(i+="/?"),n.end?i+="$":n.strict&&!i.endsWith("/")&&(i+="(?:/|$)");const o=new RegExp(i,n.sensitive?"":"i");function u(d){const g=d.match(o),y={};if(!g)return null;for(let x=1;x<g.length;x++){const _=g[x]||"",M=s[x-1];y[M.name]=_&&M.repeatable?_.split("/"):_}return y}function f(d){let g="",y=!1;for(const x of e){(!y||!g.endsWith("/"))&&(g+="/"),y=!1;for(const _ of x)if(_.type===0)g+=_.value;else if(_.type===1){const{value:M,repeatable:T,optional:D}=_,I=M in d?d[M]:"";if(Hu(I)&&!T)throw new Error(`Provided param "${M}" is an array but it is not repeatable (* or + modifiers)`);const j=Hu(I)?I.join("/"):I;if(!j)if(D)x.length<2&&(g.endsWith("/")?g=g.slice(0,-1):y=!0);else throw new Error(`Missing required param "${M}"`);g+=j}}return g||"/"}return{re:o,score:r,keys:s,parse:u,stringify:f}}function ZT(e,t){let n=0;for(;n<e.length&&n<t.length;){const r=t[n]-e[n];if(r)return r;n++}return e.length<t.length?e.length===1&&e[0]===80?-1:1:e.length>t.length?t.length===1&&t[0]===80?1:-1:0}function Z5(e,t){let n=0;const r=e.score,i=t.score;for(;n<r.length&&n<i.length;){const s=ZT(r[n],i[n]);if(s)return s;n++}if(Math.abs(i.length-r.length)===1){if(j_(r))return 1;if(j_(i))return-1}return i.length-r.length}function j_(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const KT={type:0,value:""},YT=/[a-zA-Z0-9_]/;function JT(e){if(!e)return[[]];if(e==="/")return[[KT]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(_){throw new Error(`ERR (${n})/"${d}": ${_}`)}let n=0,r=n;const i=[];let s;function o(){s&&i.push(s),s=[]}let u=0,f,d="",g="";function y(){d&&(n===0?s.push({type:0,value:d}):n===1||n===2||n===3?(s.length>1&&(f==="*"||f==="+")&&t(`A repeatable param (${d}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:d,regexp:g,repeatable:f==="*"||f==="+",optional:f==="*"||f==="?"})):t("Invalid state to consume buffer"),d="")}function x(){d+=f}for(;u<e.length;){if(f=e[u++],f==="\\"&&n!==2){r=n,n=4;continue}switch(n){case 0:f==="/"?(d&&y(),o()):f===":"?(y(),n=1):x();break;case 4:x(),n=r;break;case 1:f==="("?n=2:YT.test(f)?x():(y(),n=0,f!=="*"&&f!=="?"&&f!=="+"&&u--);break;case 2:f===")"?g[g.length-1]=="\\"?g=g.slice(0,-1)+f:n=3:g+=f;break;case 3:y(),n=0,f!=="*"&&f!=="?"&&f!=="+"&&u--,g="";break;default:t("Unknown state");break}}return n===2&&t(`Unfinished custom RegExp for param "${d}"`),y(),o(),i}function XT(e,t,n){const r=WT(JT(e.path),n),i=Ki(r,{record:e,parent:t,children:[],alias:[]});return t&&!i.record.aliasOf==!t.record.aliasOf&&t.children.push(i),i}function QT(e,t){const n=[],r=new Map;t=V_({strict:!1,end:!0,sensitive:!1},t);function i(y){return r.get(y)}function s(y,x,_){const M=!_,T=$_(y);T.aliasOf=_&&_.record;const D=V_(t,y),I=[T];if("alias"in y){const te=typeof y.alias=="string"?[y.alias]:y.alias;for(const ue of te)I.push($_(Ki({},T,{components:_?_.record.components:T.components,path:ue,aliasOf:_?_.record:T})))}let j,Z;for(const te of I){const{path:ue}=te;if(x&&ue[0]!=="/"){const le=x.record.path,ge=le[le.length-1]==="/"?"":"/";te.path=x.record.path+(ue&&ge+ue)}if(j=XT(te,x,D),_?_.alias.push(j):(Z=Z||j,Z!==j&&Z.alias.push(j),M&&y.name&&!U_(j)&&o(y.name)),K5(j)&&f(j),T.children){const le=T.children;for(let ge=0;ge<le.length;ge++)s(le[ge],j,_&&_.children[ge])}_=_||j}return Z?()=>{o(Z)}:rp}function o(y){if(q5(y)){const x=r.get(y);x&&(r.delete(y),n.splice(n.indexOf(x),1),x.children.forEach(o),x.alias.forEach(o))}else{const x=n.indexOf(y);x>-1&&(n.splice(x,1),y.record.name&&r.delete(y.record.name),y.children.forEach(o),y.alias.forEach(o))}}function u(){return n}function f(y){const x=n8(y,n);n.splice(x,0,y),y.record.name&&!U_(y)&&r.set(y.record.name,y)}function d(y,x){let _,M={},T,D;if("name"in y&&y.name){if(_=r.get(y.name),!_)throw od(1,{location:y});D=_.record.name,M=Ki(z_(x.params,_.keys.filter(Z=>!Z.optional).concat(_.parent?_.parent.keys.filter(Z=>Z.optional):[]).map(Z=>Z.name)),y.params&&z_(y.params,_.keys.map(Z=>Z.name))),T=_.stringify(M)}else if(y.path!=null)T=y.path,_=n.find(Z=>Z.re.test(T)),_&&(M=_.parse(T),D=_.record.name);else{if(_=x.name?r.get(x.name):n.find(Z=>Z.re.test(x.path)),!_)throw od(1,{location:y,currentLocation:x});D=_.record.name,M=Ki({},x.params,y.params),T=_.stringify(M)}const I=[];let j=_;for(;j;)I.unshift(j.record),j=j.parent;return{name:D,path:T,params:M,matched:I,meta:t8(I)}}e.forEach(y=>s(y));function g(){n.length=0,r.clear()}return{addRoute:s,resolve:d,removeRoute:o,clearRoutes:g,getRoutes:u,getRecordMatcher:i}}function z_(e,t){const n={};for(const r of t)r in e&&(n[r]=e[r]);return n}function $_(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:e8(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function e8(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(const r in e.components)t[r]=typeof n=="object"?n[r]:n;return t}function U_(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function t8(e){return e.reduce((t,n)=>Ki(t,n.meta),{})}function V_(e,t){const n={};for(const r in e)n[r]=r in t?t[r]:e[r];return n}function n8(e,t){let n=0,r=t.length;for(;n!==r;){const s=n+r>>1;Z5(e,t[s])<0?r=s:n=s+1}const i=r8(e);return i&&(r=t.lastIndexOf(i,r-1)),r}function r8(e){let t=e;for(;t=t.parent;)if(K5(t)&&Z5(e,t)===0)return t}function K5({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function i8(e){const t={};if(e===""||e==="?")return t;const r=(e[0]==="?"?e.slice(1):e).split("&");for(let i=0;i<r.length;++i){const s=r[i].replace(z5," "),o=s.indexOf("="),u=Sp(o<0?s:s.slice(0,o)),f=o<0?null:Sp(s.slice(o+1));if(u in t){let d=t[u];Hu(d)||(d=t[u]=[d]),d.push(f)}else t[u]=f}return t}function G_(e){let t="";for(let n in e){const r=e[n];if(n=ST(n),r==null){r!==void 0&&(t+=(t.length?"&":"")+n);continue}(Hu(r)?r.map(s=>s&&i1(s)):[r&&i1(r)]).forEach(s=>{s!==void 0&&(t+=(t.length?"&":"")+n,s!=null&&(t+="="+s))})}return t}function o8(e){const t={};for(const n in e){const r=e[n];r!==void 0&&(t[n]=Hu(r)?r.map(i=>i==null?null:""+i):r==null?r:""+r)}return t}const s8=Symbol(""),H_=Symbol(""),r0=Symbol(""),cy=Symbol(""),s1=Symbol("");function Pd(){let e=[];function t(r){return e.push(r),()=>{const i=e.indexOf(r);i>-1&&e.splice(i,1)}}function n(){e=[]}return{add:t,list:()=>e.slice(),reset:n}}function hf(e,t,n,r,i,s=o=>o()){const o=r&&(r.enterCallbacks[i]=r.enterCallbacks[i]||[]);return()=>new Promise((u,f)=>{const d=x=>{x===!1?f(od(4,{from:n,to:t})):x instanceof Error?f(x):GT(x)?f(od(2,{from:t,to:x})):(o&&r.enterCallbacks[i]===o&&typeof x=="function"&&o.push(x),u())},g=s(()=>e.call(r&&r.instances[i],t,n,d));let y=Promise.resolve(g);e.length<3&&(y=y.then(d)),y.catch(x=>f(x))})}function ev(e,t,n,r,i=s=>s()){const s=[];for(const o of e)for(const u in o.components){let f=o.components[u];if(!(t!=="beforeRouteEnter"&&!o.instances[u]))if(F5(f)){const g=(f.__vccOpts||f)[t];g&&s.push(hf(g,n,r,o,u,i))}else{let d=f();s.push(()=>d.then(g=>{if(!g)throw new Error(`Couldn't resolve component "${u}" at "${o.path}"`);const y=dT(g)?g.default:g;o.mods[u]=g,o.components[u]=y;const _=(y.__vccOpts||y)[t];return _&&hf(_,n,r,o,u,i)()}))}}return s}function q_(e){const t=Zl(r0),n=Zl(cy),r=cr(()=>{const f=Wn(e.to);return t.resolve(f)}),i=cr(()=>{const{matched:f}=r.value,{length:d}=f,g=f[d-1],y=n.matched;if(!g||!y.length)return-1;const x=y.findIndex(id.bind(null,g));if(x>-1)return x;const _=W_(f[d-2]);return d>1&&W_(g)===_&&y[y.length-1].path!==_?y.findIndex(id.bind(null,f[d-2])):x}),s=cr(()=>i.value>-1&&c8(n.params,r.value.params)),o=cr(()=>i.value>-1&&i.value===n.matched.length-1&&G5(n.params,r.value.params));function u(f={}){if(u8(f)){const d=t[Wn(e.replace)?"replace":"push"](Wn(e.to)).catch(rp);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>d),d}return Promise.resolve()}return{route:r,href:cr(()=>r.value.href),isActive:s,isExactActive:o,navigate:u}}function a8(e){return e.length===1?e[0]:e}const l8=cs({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:q_,setup(e,{slots:t}){const n=Yl(q_(e)),{options:r}=Zl(r0),i=cr(()=>({[Z_(e.activeClass,r.linkActiveClass,"router-link-active")]:n.isActive,[Z_(e.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const s=t.default&&a8(t.default(n));return e.custom?s:Hm("a",{"aria-current":n.isExactActive?e.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:i.value},s)}}}),jd=l8;function u8(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function c8(e,t){for(const n in t){const r=t[n],i=e[n];if(typeof r=="string"){if(r!==i)return!1}else if(!Hu(i)||i.length!==r.length||r.some((s,o)=>s!==i[o]))return!1}return!0}function W_(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Z_=(e,t,n)=>e??t??n,f8=cs({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:n}){const r=Zl(s1),i=cr(()=>e.route||r.value),s=Zl(H_,0),o=cr(()=>{let d=Wn(s);const{matched:g}=i.value;let y;for(;(y=g[d])&&!y.components;)d++;return d}),u=cr(()=>i.value.matched[o.value]);Xd(H_,cr(()=>o.value+1)),Xd(s8,u),Xd(s1,i);const f=Ft();return Co(()=>[f.value,u.value,e.name],([d,g,y],[x,_,M])=>{g&&(g.instances[y]=d,_&&_!==g&&d&&d===x&&(g.leaveGuards.size||(g.leaveGuards=_.leaveGuards),g.updateGuards.size||(g.updateGuards=_.updateGuards))),d&&g&&(!_||!id(g,_)||!x)&&(g.enterCallbacks[y]||[]).forEach(T=>T(d))},{flush:"post"}),()=>{const d=i.value,g=e.name,y=u.value,x=y&&y.components[g];if(!x)return K_(n.default,{Component:x,route:d});const _=y.props[g],M=_?_===!0?d.params:typeof _=="function"?_(d):_:null,D=Hm(x,Ki({},M,t,{onVnodeUnmounted:I=>{I.component.isUnmounted&&(y.instances[g]=null)},ref:f}));return K_(n.default,{Component:D,route:d})||D}}});function K_(e,t){if(!e)return null;const n=e(t);return n.length===1?n[0]:n}const Y5=f8;function h8(e){const t=QT(e.routes,e),n=e.parseQuery||i8,r=e.stringifyQuery||G_,i=e.history,s=Pd(),o=Pd(),u=Pd(),f=V1(tf);let d=tf;Bh&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const g=X0.bind(null,se=>""+se),y=X0.bind(null,ET),x=X0.bind(null,Sp);function _(se,k){let ae,ke;return q5(se)?(ae=t.getRecordMatcher(se),ke=k):ke=se,t.addRoute(ke,ae)}function M(se){const k=t.getRecordMatcher(se);k&&t.removeRoute(k)}function T(){return t.getRoutes().map(se=>se.record)}function D(se){return!!t.getRecordMatcher(se)}function I(se,k){if(k=Ki({},k||f.value),typeof se=="string"){const de=Q0(n,se,k.path),ye=t.resolve({path:de.path},k),me=i.createHref(de.fullPath);return Ki(de,ye,{params:x(ye.params),hash:Sp(de.hash),redirectedFrom:void 0,href:me})}let ae;if(se.path!=null)ae=Ki({},se,{path:Q0(n,se.path,k.path).path});else{const de=Ki({},se.params);for(const ye in de)de[ye]==null&&delete de[ye];ae=Ki({},se,{params:y(de)}),k.params=y(k.params)}const ke=t.resolve(ae,k),Pe=se.hash||"";ke.params=g(x(ke.params));const Ge=AT(r,Ki({},se,{hash:LT(Pe),path:ke.path})),K=i.createHref(Ge);return Ki({fullPath:Ge,hash:Pe,query:r===G_?o8(se.query):se.query||{}},ke,{redirectedFrom:void 0,href:K})}function j(se){return typeof se=="string"?Q0(n,se,f.value.path):Ki({},se)}function Z(se,k){if(d!==se)return od(8,{from:k,to:se})}function te(se){return ge(se)}function ue(se){return te(Ki(j(se),{replace:!0}))}function le(se){const k=se.matched[se.matched.length-1];if(k&&k.redirect){const{redirect:ae}=k;let ke=typeof ae=="function"?ae(se):ae;return typeof ke=="string"&&(ke=ke.includes("?")||ke.includes("#")?ke=j(ke):{path:ke},ke.params={}),Ki({query:se.query,hash:se.hash,params:ke.path!=null?{}:se.params},ke)}}function ge(se,k){const ae=d=I(se),ke=f.value,Pe=se.state,Ge=se.force,K=se.replace===!0,de=le(ae);if(de)return ge(Ki(j(de),{state:typeof de=="object"?Ki({},Pe,de.state):Pe,force:Ge,replace:K}),k||ae);const ye=ae;ye.redirectedFrom=k;let me;return!Ge&&kT(r,ke,ae)&&(me=od(16,{to:ye,from:ke}),De(ke,ke,!0,!1)),(me?Promise.resolve(me):Q(ye,ke)).catch(Ue=>Dc(Ue)?Dc(Ue,2)?Ue:Le(Ue):Y(Ue,ye,ke)).then(Ue=>{if(Ue){if(Dc(Ue,2))return ge(Ki({replace:K},j(Ue.to),{state:typeof Ue.to=="object"?Ki({},Pe,Ue.to.state):Pe,force:Ge}),k||ye)}else Ue=B(ye,ke,!0,K,Pe);return F(ye,ke,Ue),Ue})}function H(se,k){const ae=Z(se,k);return ae?Promise.reject(ae):Promise.resolve()}function U(se){const k=fe.values().next().value;return k&&typeof k.runWithContext=="function"?k.runWithContext(se):se()}function Q(se,k){let ae;const[ke,Pe,Ge]=d8(se,k);ae=ev(ke.reverse(),"beforeRouteLeave",se,k);for(const de of ke)de.leaveGuards.forEach(ye=>{ae.push(hf(ye,se,k))});const K=H.bind(null,se,k);return ae.push(K),_e(ae).then(()=>{ae=[];for(const de of s.list())ae.push(hf(de,se,k));return ae.push(K),_e(ae)}).then(()=>{ae=ev(Pe,"beforeRouteUpdate",se,k);for(const de of Pe)de.updateGuards.forEach(ye=>{ae.push(hf(ye,se,k))});return ae.push(K),_e(ae)}).then(()=>{ae=[];for(const de of Ge)if(de.beforeEnter)if(Hu(de.beforeEnter))for(const ye of de.beforeEnter)ae.push(hf(ye,se,k));else ae.push(hf(de.beforeEnter,se,k));return ae.push(K),_e(ae)}).then(()=>(se.matched.forEach(de=>de.enterCallbacks={}),ae=ev(Ge,"beforeRouteEnter",se,k,U),ae.push(K),_e(ae))).then(()=>{ae=[];for(const de of o.list())ae.push(hf(de,se,k));return ae.push(K),_e(ae)}).catch(de=>Dc(de,8)?de:Promise.reject(de))}function F(se,k,ae){u.list().forEach(ke=>U(()=>ke(se,k,ae)))}function B(se,k,ae,ke,Pe){const Ge=Z(se,k);if(Ge)return Ge;const K=k===tf,de=Bh?history.state:{};ae&&(ke||K?i.replace(se.fullPath,Ki({scroll:K&&de&&de.scroll},Pe)):i.push(se.fullPath,Pe)),f.value=se,De(se,k,ae,K),Le()}let R;function $(){R||(R=i.listen((se,k,ae)=>{if(!ce.listening)return;const ke=I(se),Pe=le(ke);if(Pe){ge(Ki(Pe,{replace:!0,force:!0}),ke).catch(rp);return}d=ke;const Ge=f.value;Bh&&FT(O_(Ge.fullPath,ae.delta),n0()),Q(ke,Ge).catch(K=>Dc(K,12)?K:Dc(K,2)?(ge(Ki(j(K.to),{force:!0}),ke).then(de=>{Dc(de,20)&&!ae.delta&&ae.type===Cp.pop&&i.go(-1,!1)}).catch(rp),Promise.reject()):(ae.delta&&i.go(-ae.delta,!1),Y(K,ke,Ge))).then(K=>{K=K||B(ke,Ge,!1),K&&(ae.delta&&!Dc(K,8)?i.go(-ae.delta,!1):ae.type===Cp.pop&&Dc(K,20)&&i.go(-1,!1)),F(ke,Ge,K)}).catch(rp)}))}let W=Pd(),G=Pd(),J;function Y(se,k,ae){Le(se);const ke=G.list();return ke.length?ke.forEach(Pe=>Pe(se,k,ae)):console.error(se),Promise.reject(se)}function pe(){return J&&f.value!==tf?Promise.resolve():new Promise((se,k)=>{W.add([se,k])})}function Le(se){return J||(J=!se,$(),W.list().forEach(([k,ae])=>se?ae(se):k()),W.reset()),se}function De(se,k,ae,ke){const{scrollBehavior:Pe}=e;if(!Bh||!Pe)return Promise.resolve();const Ge=!ae&&jT(O_(se.fullPath,0))||(ke||!ae)&&history.state&&history.state.scroll||null;return Xs().then(()=>Pe(se,k,Ge)).then(K=>K&&RT(K)).catch(K=>Y(K,se,k))}const N=se=>i.go(se);let ee;const fe=new Set,ce={currentRoute:f,listening:!0,addRoute:_,removeRoute:M,clearRoutes:t.clearRoutes,hasRoute:D,getRoutes:T,resolve:I,options:e,push:te,replace:ue,go:N,back:()=>N(-1),forward:()=>N(1),beforeEach:s.add,beforeResolve:o.add,afterEach:u.add,onError:G.add,isReady:pe,install(se){const k=this;se.component("RouterLink",jd),se.component("RouterView",Y5),se.config.globalProperties.$router=k,Object.defineProperty(se.config.globalProperties,"$route",{enumerable:!0,get:()=>Wn(f)}),Bh&&!ee&&f.value===tf&&(ee=!0,te(i.location).catch(Pe=>{}));const ae={};for(const Pe in tf)Object.defineProperty(ae,Pe,{get:()=>f.value[Pe],enumerable:!0});se.provide(r0,k),se.provide(cy,U1(ae)),se.provide(s1,f);const ke=se.unmount;fe.add(se),se.unmount=function(){fe.delete(se),fe.size<1&&(d=tf,R&&R(),R=null,f.value=tf,ee=!1,J=!1),ke()}}};function _e(se){return se.reduce((k,ae)=>k.then(()=>U(ae)),Promise.resolve())}return ce}function d8(e,t){const n=[],r=[],i=[],s=Math.max(t.matched.length,e.matched.length);for(let o=0;o<s;o++){const u=t.matched[o];u&&(e.matched.find(d=>id(d,u))?r.push(u):n.push(u));const f=e.matched[o];f&&(t.matched.find(d=>id(d,f))||i.push(f))}return[n,r,i]}function Op(){return Zl(r0)}function cG(e){return Zl(cy)}const Uu=Np("notification",()=>{const e=Ft([]),t=Ft(0),n=Ft(null),r=cr(()=>[...e.value].sort((y,x)=>x.timestamp-y.timestamp));function i({type:y,message:x,duration:_=5e3}){const M=++t.value,T=Date.now(),D={id:M,type:y,message:x,duration:_,timestamp:T};return e.value.push(D),n.value=M,_>0&&setTimeout(()=>{d(M)},_),M}const s=(y,x=5e3)=>i({type:"success",message:y,duration:x}),o=(y,x=5e3)=>i({type:"error",message:y,duration:x}),u=(y,x=5e3)=>i({type:"info",message:y,duration:x}),f=(y,x=5e3)=>i({type:"warning",message:y,duration:x});function d(y){const x=e.value.findIndex(_=>_.id===y);x!==-1&&e.value.splice(x,1),n.value===y&&(n.value=null)}function g(){e.value=[],n.value=null}return{notifications:r,lastAddedId:n,addNotification:i,removeNotification:d,clearAll:g,success:s,error:o,info:u,warning:f}}),p8=Object.freeze(Object.defineProperty({__proto__:null,useNotificationStore:Uu},Symbol.toStringTag,{value:"Module"}));var ea=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function fy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function J5(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}),n}function g8(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var X5=g8,m8=typeof ea=="object"&&ea&&ea.Object===Object&&ea,v8=m8,y8=v8,_8=typeof self=="object"&&self&&self.Object===Object&&self,b8=y8||_8||Function("return this")(),Q5=b8,w8=Q5,x8=function(){return w8.Date.now()},L8=x8,S8=/\s/;function C8(e){for(var t=e.length;t--&&S8.test(e.charAt(t)););return t}var E8=C8,P8=E8,M8=/^\s+/;function A8(e){return e&&e.slice(0,P8(e)+1).replace(M8,"")}var k8=A8,T8=Q5,N8=T8.Symbol,ex=N8,Y_=ex,tx=Object.prototype,D8=tx.hasOwnProperty,I8=tx.toString,Md=Y_?Y_.toStringTag:void 0;function O8(e){var t=D8.call(e,Md),n=e[Md];try{e[Md]=void 0;var r=!0}catch{}var i=I8.call(e);return r&&(t?e[Md]=n:delete e[Md]),i}var B8=O8,R8=Object.prototype,F8=R8.toString;function j8(e){return F8.call(e)}var z8=j8,J_=ex,$8=B8,U8=z8,V8="[object Null]",G8="[object Undefined]",X_=J_?J_.toStringTag:void 0;function H8(e){return e==null?e===void 0?G8:V8:X_&&X_ in Object(e)?$8(e):U8(e)}var q8=H8;function W8(e){return e!=null&&typeof e=="object"}var Z8=W8,K8=q8,Y8=Z8,J8="[object Symbol]";function X8(e){return typeof e=="symbol"||Y8(e)&&K8(e)==J8}var Q8=X8,eN=k8,Q_=X5,tN=Q8,eb=NaN,nN=/^[-+]0x[0-9a-f]+$/i,rN=/^0b[01]+$/i,iN=/^0o[0-7]+$/i,oN=parseInt;function sN(e){if(typeof e=="number")return e;if(tN(e))return eb;if(Q_(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Q_(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=eN(e);var n=rN.test(e);return n||iN.test(e)?oN(e.slice(2),n?2:8):nN.test(e)?eb:+e}var aN=sN,lN=X5,tv=L8,tb=aN,uN="Expected a function",cN=Math.max,fN=Math.min;function hN(e,t,n){var r,i,s,o,u,f,d=0,g=!1,y=!1,x=!0;if(typeof e!="function")throw new TypeError(uN);t=tb(t)||0,lN(n)&&(g=!!n.leading,y="maxWait"in n,s=y?cN(tb(n.maxWait)||0,t):s,x="trailing"in n?!!n.trailing:x);function _(le){var ge=r,H=i;return r=i=void 0,d=le,o=e.apply(H,ge),o}function M(le){return d=le,u=setTimeout(I,t),g?_(le):o}function T(le){var ge=le-f,H=le-d,U=t-ge;return y?fN(U,s-H):U}function D(le){var ge=le-f,H=le-d;return f===void 0||ge>=t||ge<0||y&&H>=s}function I(){var le=tv();if(D(le))return j(le);u=setTimeout(I,T(le))}function j(le){return u=void 0,x&&r?_(le):(r=i=void 0,o)}function Z(){u!==void 0&&clearTimeout(u),d=0,r=f=i=u=void 0}function te(){return u===void 0?o:j(tv())}function ue(){var le=tv(),ge=D(le);if(r=arguments,i=this,f=le,ge){if(u===void 0)return M(f);if(y)return clearTimeout(u),u=setTimeout(I,t),_(f)}return u===void 0&&(u=setTimeout(I,t)),o}return ue.cancel=Z,ue.flush=te,ue}var dN=hN;const pN=fy(dN),gN={class:"relative w-full"},mN={key:0,class:"search-results w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto"},vN=["onClick"],nb=cs({__name:"SearchBar",emits:["select-location"],setup(e,{emit:t}){const n=Ft(""),r=Ft([]),i=t,s=pN(async f=>{if(f.length<3){r.value=[];return}try{const g=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(f)}`)).json();r.value=g}catch(d){console.error("Erreur lors de la recherche d'adresse:",d),r.value=[]}},300);function o(){s(n.value)}function u(f){n.value=f.display_name,r.value=[],i("select-location",{lat:parseFloat(f.lat),lng:parseFloat(f.lon)})}return(f,d)=>($e(),qe("div",gN,[Fn(E("input",{"onUpdate:modelValue":d[0]||(d[0]=g=>n.value=g),onInput:o,type:"text",placeholder:"Rechercher une adresse...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"},null,544),[[ri,n.value]]),r.value.length>0?($e(),qe("div",mN,[($e(!0),qe(Bn,null,Er(r.value,g=>($e(),qe("div",{key:g.place_id,onClick:y=>u(g),class:"px-4 py-2 hover:bg-gray-100 cursor-pointer"},Wt(g.display_name),9,vN))),128))])):dn("",!0)]))}}),yN={class:"perf-title"},_N={class:"perf-basic-stats"},bN={class:"perf-stat"},wN={class:"perf-stat"},xN={class:"perf-expand-btn"},LN={key:0,class:"perf-content"},SN={class:"perf-section"},CN={class:"perf-metrics"},EN={class:"perf-metric"},PN={class:"perf-metric-value"},MN={class:"perf-metric"},AN={class:"perf-metric-value"},kN={class:"perf-metric"},TN={class:"perf-metric-value"},NN={class:"perf-metric"},DN={class:"perf-metric-value"},IN={class:"perf-section"},ON={class:"perf-metrics"},BN={key:0,class:"perf-metric"},RN={class:"perf-metric-value"},FN={key:1,class:"perf-metric"},jN={class:"perf-metric-value"},zN={key:2,class:"perf-metric"},$N={class:"perf-metric-value"},UN={class:"perf-section"},VN={class:"perf-table"},GN={class:"perf-table-cell"},HN={class:"perf-table-cell"},qN={class:"perf-table-cell"},WN={class:"perf-table-cell"},ZN=["onClick"],KN={key:0,class:"perf-empty"},YN=cs({__name:"PerformancePanel",props:{position:{}},setup(e){const n=e.position||"bottom-left",r=Ft(!1),{isQueryParamEnabled:i,isRecording:s,measures:o,longTasks:u,memorySnapshots:f,framesPerSecond:d,operationHistory:g,startRecording:y,stopRecording:x,clearRecording:_,captureMemorySnapshot:M,getSlowOperations:T,getPerformanceReport:D,getOperationDetails:I}=pd(),j=cr(()=>{const B=D()??{totalMeasures:0,totalLongTasks:0,slowestOperations:[],averageFps:0,memoryUsage:null};return{totalMeasures:B.totalMeasures,totalLongTasks:B.totalLongTasks,averageDuration:B.slowestOperations.length>0?B.slowestOperations.reduce((R,$)=>R+$.duration,0)/B.slowestOperations.length:0,fps:B.averageFps,slowestOperations:B.slowestOperations,memoryUsage:B.memoryUsage}}),Z=cr(()=>(D()??{slowestOperations:[]}).slowestOperations.slice(0,5).map(R=>({operation:R.name,component:R.component||"unknown",durationMs:R.duration,timestamp:R.startTime}))),te=Ft(null);$s(()=>{i.value&&(te.value=window.setInterval(()=>{M()},1e3))}),mc(()=>{te.value!==null&&clearInterval(te.value)});function ue(B){return B===void 0?"N/A":B<1024?B+" B":B<1024*1024?(B/1024).toFixed(2)+" KB":B<1024*1024*1024?(B/(1024*1024)).toFixed(2)+" MB":(B/(1024*1024*1024)).toFixed(2)+" GB"}function le(B){return B.toFixed(2)}const ge=()=>{M()};function H(){const B=D(),R="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(B,null,2)),$=document.createElement("a");$.setAttribute("href",R),$.setAttribute("download","performance_report.json"),document.body.appendChild($),$.click(),$.remove()}function U(){_(),ge()}function Q(){const B=D();navigator.clipboard.writeText(JSON.stringify(B,null,2)).then(()=>{alert("Données de performance copiées dans le presse-papiers")}).catch(R=>{console.error("Erreur lors de la copie des données",R),alert("Erreur lors de la copie des données")})}async function F(B){const R=I(B.operation,B.timestamp);if(!R){alert("Impossible de trouver les détails de cette opération");return}const $={operation:{...R.operation,startTimeRelative:"0ms",startTimeAbsolute:new Date(R.operation.startTime).toISOString()},context:{...R.context,relatedOperations:R.context.relatedOperations.map(W=>({...W,startTime:`+${W.startTime.toFixed(2)}ms`})),longTasks:R.context.longTasks.map(W=>({...W,startTime:`+${W.startTime.toFixed(2)}ms`})),memorySnapshots:R.context.memorySnapshots.map(W=>({...W,timestamp:`+${W.timestamp.toFixed(2)}ms`,usedJSHeapSize:W.usedJSHeapSize?ue(W.usedJSHeapSize):"N/A",totalJSHeapSize:W.totalJSHeapSize?ue(W.totalJSHeapSize):"N/A"}))},summary:{...R.summary,memoryDelta:ue(R.summary.memoryDelta),maxLongTaskDuration:`${R.summary.maxLongTaskDuration.toFixed(2)}ms`}};try{await navigator.clipboard.writeText(JSON.stringify($,null,2)),alert("Détails de l'opération copiés dans le presse-papiers")}catch(W){console.error("Erreur lors de la copie des détails",W),alert("Erreur lors de la copie des détails")}}return(B,R)=>{var $,W,G,J,Y,pe;return Wn(i)?($e(),qe("div",{key:0,class:Bi(["performance-panel",`position-${Wn(n)}`,{expanded:r.value}])},[E("div",{class:"perf-header",onClick:R[0]||(R[0]=Le=>r.value=!r.value)},[E("div",yN,[E("div",{class:Bi(["perf-indicator",{active:Wn(s)}])},null,2),R[1]||(R[1]=E("span",null,"Performance",-1))]),E("div",_N,[E("span",bN,Wt(j.value.fps)+" FPS",1),E("span",wN,Wt(le(j.value.averageDuration))+"ms",1)]),E("button",xN,Wt(r.value?"▼":"▲"),1)]),r.value?($e(),qe("div",LN,[E("div",SN,[R[6]||(R[6]=E("h3",null,"Métriques générales",-1)),E("div",CN,[E("div",EN,[R[2]||(R[2]=E("span",{class:"perf-metric-label"},"Mesures",-1)),E("span",PN,Wt(j.value.totalMeasures),1)]),E("div",MN,[R[3]||(R[3]=E("span",{class:"perf-metric-label"},"Tâches longues",-1)),E("span",AN,Wt(j.value.totalLongTasks),1)]),E("div",kN,[R[4]||(R[4]=E("span",{class:"perf-metric-label"},"Durée moyenne",-1)),E("span",TN,Wt(le(j.value.averageDuration))+"ms",1)]),E("div",NN,[R[5]||(R[5]=E("span",{class:"perf-metric-label"},"FPS",-1)),E("span",DN,Wt(j.value.fps),1)])])]),E("div",IN,[R[10]||(R[10]=E("h3",null,"Mémoire",-1)),E("div",ON,[(($=j.value.memoryUsage)==null?void 0:$.usedJSHeapSize)!==void 0?($e(),qe("div",BN,[R[7]||(R[7]=E("span",{class:"perf-metric-label"},"Utilisée",-1)),E("span",RN,Wt(ue((W=j.value.memoryUsage)==null?void 0:W.usedJSHeapSize)),1)])):dn("",!0),((G=j.value.memoryUsage)==null?void 0:G.totalJSHeapSize)!==void 0?($e(),qe("div",FN,[R[8]||(R[8]=E("span",{class:"perf-metric-label"},"Totale",-1)),E("span",jN,Wt(ue((J=j.value.memoryUsage)==null?void 0:J.totalJSHeapSize)),1)])):dn("",!0),((Y=j.value.memoryUsage)==null?void 0:Y.jsHeapSizeLimit)!==void 0?($e(),qe("div",zN,[R[9]||(R[9]=E("span",{class:"perf-metric-label"},"Limite",-1)),E("span",$N,Wt(ue((pe=j.value.memoryUsage)==null?void 0:pe.jsHeapSizeLimit)),1)])):dn("",!0)])]),E("div",UN,[R[13]||(R[13]=E("h3",null,"Opérations les plus lentes",-1)),E("div",VN,[R[12]||(R[12]=cc('<div class="perf-table-header" data-v-fefe39b0><div class="perf-table-cell" data-v-fefe39b0>Opération</div><div class="perf-table-cell" data-v-fefe39b0>Composant</div><div class="perf-table-cell" data-v-fefe39b0>Durée</div><div class="perf-table-cell" data-v-fefe39b0>Actions</div></div>',1)),($e(!0),qe(Bn,null,Er(Z.value,Le=>($e(),qe("div",{class:"perf-table-row",key:Le.timestamp},[E("div",GN,Wt(Le.operation),1),E("div",HN,Wt(Le.component),1),E("div",qN,Wt(le(Le.durationMs))+"ms",1),E("div",WN,[E("button",{onClick:De=>F(Le),class:"perf-action-button",title:"Copier les détails"},R[11]||(R[11]=[E("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)]),8,ZN)])]))),128)),Z.value.length===0?($e(),qe("div",KN," Aucune opération enregistrée ")):dn("",!0)])]),E("div",{class:"perf-actions"},[E("button",{onClick:U,class:"perf-button"}," Réinitialiser "),E("button",{onClick:H,class:"perf-button"}," Télécharger "),E("button",{onClick:Q,class:"perf-button"}," Copier ")])])):dn("",!0)],2)):dn("",!0)}}}),Bp=(e,t)=>{const n=e.__vccOpts||e;for(const[r,i]of t)n[r]=i;return n},JN=Bp(YN,[["__scopeId","data-v-fefe39b0"]]),XN={class:"h-screen flex flex-col"},QN={key:0,class:"bg-white shadow-sm z-[2000] flex-shrink-0"},eD={class:"mx-auto px-4 sm:px-6 lg:px-8"},tD={class:"flex h-16 items-center justify-between"},nD={class:"flex items-center"},rD={class:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},iD={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"},oD={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},sD={class:"hidden md:flex md:ml-6 space-x-8"},aD={key:0,class:"hidden md:block flex-1 mx-8"},lD={key:1,class:"flex-1"},uD={class:"flex items-center space-x-2 md:space-x-4"},cD={key:0,class:"hidden md:flex items-center justify-center p-2 text-amber-500 hover:text-amber-600 rounded-full hover:bg-amber-50 focus:outline-none focus:ring-2 focus:ring-amber-400",title:"Performance activée"},fD={class:"relative"},hD={class:"px-4 py-2 border-b border-gray-100 flex justify-between items-center"},dD={class:"flex items-center justify-between w-full"},pD={class:"flex items-center space-x-3"},gD={class:"max-h-72 overflow-y-auto"},mD={key:0,class:"px-4 py-3 text-sm text-gray-500 text-center"},vD={class:"flex items-start"},yD={class:"flex-shrink-0 mr-3"},_D={key:0,class:"h-6 w-6 md:h-5 md:w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor"},bD={key:1,class:"h-6 w-6 md:h-5 md:w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},wD={key:2,class:"h-6 w-6 md:h-5 md:w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},xD={key:3,class:"h-6 w-6 md:h-5 md:w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor"},LD={class:"flex-1"},SD={class:"text-sm md:text-sm text-gray-800"},CD=["onClick"],ED={class:"relative"},PD={class:"hidden md:flex flex-col items-end"},MD={class:"text-sm font-medium text-gray-700"},AD={key:0,class:"text-xs text-gray-500"},kD=["src","alt"],TD={class:"md:hidden px-4 py-2 border-b border-gray-100 flex justify-between items-center"},ND={class:"text-sm font-semibold text-gray-700"},DD={class:"text-xs text-gray-500"},ID={key:0,class:"md:hidden bg-white border-t border-gray-200"},OD={class:"space-y-1 px-2 pb-3 pt-2"},BD={key:0,class:"px-4 py-3 border-t border-gray-200"},RD=cs({__name:"App",setup(e){const t=Op(),n=ma(),r=Uu(),{isQueryParamEnabled:i}=pd(),s=Ft(!1),o=Ft(!1),u=Ft(!1),f=Ft(!1),d=Ft(null),g=Ft(!1),y=Ft(!1),x=Ft(null),_=Ft("13px"),M=Ft("65px");function T(){y.value=window.innerWidth<768}$s(()=>{T(),window.addEventListener("resize",T),window.addEventListener("resize",D)}),fd(()=>{window.removeEventListener("resize",T),window.removeEventListener("resize",D)});function D(){if(!x.value)return;const R=x.value.getBoundingClientRect();_.value=`${R.top+window.scrollY+5}px`;const $=R.left+R.width/2;M.value=`${window.innerWidth-$-22}px`}const I=cr(()=>{const R=n.user;if(!R)return"";const $=`${R.first_name} ${R.last_name.toUpperCase()}`;return R.company_name?`${$} (${R.company_name})`:$}),j=cr(()=>{var $;switch(($=n.user)==null?void 0:$.user_type){case"admin":return"Accès administrateur";case"entreprise":return"Accès entreprise";case"salarie":return"Accès salarie";case"visiteur":return"Accès visiteur";default:return""}}),Z=cr(()=>{var R;return((R=n.user)==null?void 0:R.user_type)==="admin"}),te=cr(()=>n.isAuthenticated),ue=[{name:"Carte",to:"/"},{name:"Notes",to:"/notes"}],le=cr(()=>{var $;if(!te.value)return[];const R=[...ue];return(Z.value||(($=n.user)==null?void 0:$.user_type)==="entreprise")&&R.push({name:"Utilisateurs",to:"/users"}),R}),ge=cr(()=>te.value?[{name:"Mon profil",to:"/profile"}]:[]);async function H(){try{await n.logout(),t.push("/login")}catch(R){console.error("Erreur lors de la déconnexion:",R)}}function U(R){window.dispatchEvent(new CustomEvent("map-set-location",{detail:{lat:R.lat,lng:R.lng,zoom:16}}))}$s(async()=>{console.log("App mounted, checking auth...");try{if(localStorage.getItem("token")){console.log("Token found, checking auth..."),await n.checkAuth(),await n.fetchUserProfile();const $=localStorage.getItem("lastPlanId");$&&window.dispatchEvent(new CustomEvent("load-last-plan",{detail:{planId:$}}))}else console.log("No token found")}catch(R){console.error("Auth check error:",R),t.push("/login")}});const Q=cr(()=>{const R="TagMap";if(!te.value)return`${R} - Connexion`;const $=t.currentRoute.value,G={home:"Carte",notes:"Notes",users:"Utilisateurs",profile:"Mon profil",changePassword:"Changement de mot de passe",map:"Carte"}[$.name]||"";return G?`${R} - ${G}`:R});Co(Q,R=>{document.title=R},{immediate:!0});const F=cr(()=>r.notifications.length);function B(){r.clearAll(),u.value=!1}return bp(()=>{if(r.lastAddedId!==null){const R=r.notifications.find($=>$.id===r.lastAddedId);R&&Xs(()=>{D(),f.value=!0,d.value={id:R.id,message:R.message,type:R.type},requestAnimationFrame(()=>{setTimeout(()=>{g.value=!0,setTimeout(()=>{g.value=!1,setTimeout(()=>{var $;(($=d.value)==null?void 0:$.id)===R.id&&(d.value=null,f.value=!1)},300)},4e3)},50)})})}}),(R,$)=>{var W;return $e(),qe("div",XN,[te.value?($e(),qe("header",QN,[E("nav",eD,[E("div",tD,[E("div",nD,[E("button",{onClick:$[0]||($[0]=G=>o.value=!o.value),class:"inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500 md:hidden"},[$[7]||($[7]=E("span",{class:"sr-only"},"Ouvrir le menu",-1)),($e(),qe("svg",rD,[o.value?($e(),qe("path",oD)):($e(),qe("path",iD))]))]),hi(Wn(jd),{to:"/",class:"text-xl font-semibold text-primary-600 truncate ml-2 md:ml-0"},{default:Gl(()=>$[8]||($[8]=[E("span",{class:"md:inline hidden"},"TagMap",-1),E("span",{class:"md:hidden inline"},"TM",-1)])),_:1}),E("div",sD,[($e(!0),qe(Bn,null,Er(le.value,G=>($e(),$a(Wn(jd),{key:G.name,to:G.to,class:Bi(["text-sm font-medium transition-colors duration-200",[R.$route.path===G.to?"text-primary-600 border-b-2 border-primary-500":"text-gray-500 hover:text-gray-900"]])},{default:Gl(()=>[Pi(Wt(G.name),1)]),_:2},1032,["to","class"]))),128))])]),R.$route.path==="/"?($e(),qe("div",aD,[hi(nb,{onSelectLocation:U})])):($e(),qe("div",lD)),E("div",uD,[Wn(i)?($e(),qe("button",cD,$[9]||($[9]=[E("span",{class:"sr-only"},"Performance",-1),E("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)]))):dn("",!0),E("div",fD,[E("button",{ref_key:"bellButtonRef",ref:x,onClick:$[1]||($[1]=G=>u.value=!u.value),class:Bi(["relative flex items-center justify-center p-2 text-gray-400 hover:text-gray-500 rounded-full hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",{"animate-bell":f.value}])},$[10]||($[10]=[E("span",{class:"sr-only"},"Voir les notifications",-1),E("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})],-1)]),2),u.value?($e(),qe("div",{key:0,class:"absolute right-0 mt-2 md:w-80 w-screen md:origin-top-right md:rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-[3000] md:right-0 right-0 left-0 md:left-auto",style:ql(y.value?"position: fixed; top: 64px; left: 0; right: 0; margin: 0;":"")},[E("div",hD,[E("div",dD,[$[12]||($[12]=E("h3",{class:"text-sm font-semibold text-gray-700"},"Notifications",-1)),E("div",pD,[F.value>0?($e(),qe("button",{key:0,onClick:B,class:"text-xs text-primary-600 hover:text-primary-800"}," Tout effacer ")):dn("",!0),E("button",{onClick:$[2]||($[2]=G=>u.value=!1),class:"md:hidden p-1 rounded-full hover:bg-gray-100"},$[11]||($[11]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])])]),E("div",gD,[F.value===0?($e(),qe("div",mD," Aucune notification ")):dn("",!0),($e(!0),qe(Bn,null,Er(Wn(r).notifications,G=>($e(),qe("div",{key:G.id,class:"px-4 py-3 md:py-3 py-4 border-b border-gray-100 last:border-0 hover:bg-gray-50"},[E("div",vD,[E("div",yD,[G.type==="success"?($e(),qe("svg",_D,$[13]||($[13]=[E("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):G.type==="error"?($e(),qe("svg",bD,$[14]||($[14]=[E("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"},null,-1)]))):G.type==="warning"?($e(),qe("svg",wD,$[15]||($[15]=[E("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)]))):($e(),qe("svg",xD,$[16]||($[16]=[E("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"},null,-1)])))]),E("div",LD,[E("p",SD,Wt(G.message),1),E("button",{onClick:J=>Wn(r).removeNotification(G.id),class:"text-xs md:text-xs text-primary-600 hover:text-primary-800 mt-2 md:mt-1 py-1 md:py-0"}," Fermer ",8,CD)])])]))),128))])],4)):dn("",!0)]),E("div",ED,[E("button",{onClick:$[3]||($[3]=G=>s.value=!s.value),class:"flex items-center space-x-2 md:space-x-3 focus:outline-none"},[E("div",PD,[E("span",MD,Wt(I.value),1),j.value?($e(),qe("span",AD,Wt(j.value),1)):dn("",!0)]),E("img",{class:"h-8 w-8 rounded-full ring-2 ring-white",src:((W=Wn(n).user)==null?void 0:W.logo)||"https://ui-avatars.com/api/?name="+encodeURIComponent(I.value),alt:I.value},null,8,kD)]),s.value?($e(),qe("div",{key:0,class:"absolute right-0 mt-2 md:w-48 w-screen md:origin-top-right md:rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-[3000] md:right-0 right-0 left-0 md:left-auto",style:ql(y.value?"position: fixed; top: 64px; left: 0; right: 0; margin: 0;":"")},[E("div",TD,[E("div",null,[E("div",ND,Wt(I.value),1),E("div",DD,Wt(j.value),1)]),E("button",{onClick:$[4]||($[4]=G=>s.value=!1),class:"p-1 rounded-full hover:bg-gray-100"},$[17]||($[17]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),($e(!0),qe(Bn,null,Er(ge.value,G=>($e(),$a(Wn(jd),{key:G.name,to:G.to,class:"block px-4 md:py-2 py-3 text-sm text-gray-700 hover:bg-gray-50 border-b border-gray-100 last:border-b-0",onClick:$[5]||($[5]=J=>s.value=!1)},{default:Gl(()=>[Pi(Wt(G.name),1)]),_:2},1032,["to"]))),128)),E("button",{onClick:H,class:"block w-full px-4 md:py-2 py-3 text-left text-sm text-red-600 hover:bg-gray-50 font-medium"}," Déconnexion ")],4)):dn("",!0)])])]),o.value?($e(),qe("div",ID,[E("div",OD,[($e(!0),qe(Bn,null,Er(le.value,G=>($e(),$a(Wn(jd),{key:G.name,to:G.to,class:Bi(["block px-3 py-2 rounded-md text-base font-medium",[R.$route.path===G.to?"bg-primary-50 text-primary-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"]]),onClick:$[6]||($[6]=J=>o.value=!1)},{default:Gl(()=>[Pi(Wt(G.name),1)]),_:2},1032,["to","class"]))),128))]),R.$route.path==="/"?($e(),qe("div",BD,[hi(nb,{onSelectLocation:U})])):dn("",!0)])):dn("",!0)])])):dn("",!0),E("main",{class:Bi([R.$route.path==="/"&&!y.value?"overflow-hidden":"overflow-auto","flex-1 flex flex-col","md:h-[calc(100vh-64px)]"])},[hi(Wn(Y5))],2),hi(JN,{position:"bottom-left"})])}}}),FD="modulepreload",jD=function(e){return"/static/frontend/"+e},rb={},zc=function(t,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),u=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(f=>{if(f=jD(f),f in rb)return;rb[f]=!0;const d=f.endsWith(".css"),g=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${g}`))return;const y=document.createElement("link");if(y.rel=d?"stylesheet":FD,d||(y.as="script"),y.crossOrigin="",y.href=f,u&&y.setAttribute("nonce",u),document.head.appendChild(y),d)return new Promise((x,_)=>{y.addEventListener("load",x),y.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${f}`)))})}))}function s(o){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=o,window.dispatchEvent(u),!u.defaultPrevented)throw o}return i.then(o=>{for(const u of o||[])u.status==="rejected"&&s(u.reason);return t().catch(s)})},zD={class:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8"},$D={class:"max-w-md w-full space-y-8"},UD={class:"space-y-4"},VD={class:"mt-1"},GD={class:"mt-1"},HD={class:"mt-1"},qD={key:0,class:"rounded-md bg-red-50 p-4"},WD={class:"flex"},ZD={class:"ml-3"},KD={class:"text-sm font-medium text-red-800"},YD={key:1,class:"rounded-md bg-yellow-50 p-4"},JD={class:"flex"},XD={class:"ml-3"},QD={class:"mt-2 text-sm text-yellow-700"},eI={class:"list-disc pl-5 space-y-1"},tI=["disabled"],nI={class:"absolute left-0 inset-y-0 flex items-center pl-3"},rI={key:0,class:"h-5 w-5 text-primary-500 group-hover:text-primary-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},iI={key:1,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},oI=cs({__name:"ChangePasswordForm",setup(e){const t=Op(),n=ma(),r=Yl({oldPassword:"",newPassword:"",confirmPassword:""}),i=Ft(!1),s=Ft("");$s(()=>{var d,g;console.log("ChangePasswordForm mounted, auth state:",{isAuthenticated:n.isAuthenticated,userId:(d=n.user)==null?void 0:d.id,mustChangePassword:(g=n.user)==null?void 0:g.must_change_password})});const o=cr(()=>{const d=[];return r.newPassword&&r.newPassword.length<8&&d.push("Le nouveau mot de passe doit contenir au moins 8 caractères"),r.newPassword&&r.confirmPassword&&r.newPassword!==r.confirmPassword&&d.push("Les mots de passe ne correspondent pas"),d}),u=cr(()=>r.oldPassword.length>0&&r.newPassword.length>=8&&r.newPassword===r.confirmPassword);async function f(){var d,g,y,x,_,M,T,D;if(!u.value){s.value="Veuillez corriger les erreurs avant de continuer";return}if(!((d=n.user)!=null&&d.id)){s.value="Erreur : utilisateur non identifié";return}i.value=!0,s.value="";try{console.log("Submitting password change..."),await n.changePassword(r.oldPassword,r.newPassword),console.log("Password changed successfully"),t.push("/")}catch(I){console.error("Password change failed:",I),(y=(g=I.response)==null?void 0:g.data)!=null&&y.detail?s.value=I.response.data.detail:(_=(x=I.response)==null?void 0:x.data)!=null&&_.old_password?s.value=I.response.data.old_password[0]:(T=(M=I.response)==null?void 0:M.data)!=null&&T.password?s.value=I.response.data.password[0]:((D=I.response)==null?void 0:D.status)===401?(s.value="Session expirée, veuillez vous reconnecter",await n.logout(),t.push("/login")):s.value="Une erreur est survenue lors du changement de mot de passe"}finally{i.value=!1}}return(d,g)=>($e(),qe("div",zD,[E("div",$D,[g[12]||(g[12]=E("div",null,[E("h2",{class:"mt-6 text-center text-3xl font-extrabold text-gray-900"}," Changement de mot de passe "),E("p",{class:"mt-2 text-center text-sm text-gray-600"}," Pour des raisons de sécurité, vous devez changer votre mot de passe. ")],-1)),E("form",{class:"mt-8 space-y-6",onSubmit:Sf(f,["prevent"])},[E("div",UD,[E("div",null,[g[3]||(g[3]=E("label",{for:"old-password",class:"block text-sm font-medium text-gray-700"},"Ancien mot de passe",-1)),E("div",VD,[Fn(E("input",{id:"old-password","onUpdate:modelValue":g[0]||(g[0]=y=>r.oldPassword=y),name:"old-password",type:"password",required:"",autocomplete:"current-password",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Entrez votre mot de passe actuel"},null,512),[[ri,r.oldPassword]])])]),E("div",null,[g[4]||(g[4]=E("label",{for:"new-password",class:"block text-sm font-medium text-gray-700"},"Nouveau mot de passe",-1)),E("div",GD,[Fn(E("input",{id:"new-password","onUpdate:modelValue":g[1]||(g[1]=y=>r.newPassword=y),name:"new-password",type:"password",required:"",autocomplete:"new-password",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Entrez votre nouveau mot de passe"},null,512),[[ri,r.newPassword]])]),g[5]||(g[5]=E("p",{class:"mt-1 text-sm text-gray-500"}," Le mot de passe doit contenir au moins 8 caractères ",-1))]),E("div",null,[g[6]||(g[6]=E("label",{for:"confirm-password",class:"block text-sm font-medium text-gray-700"},"Confirmer le mot de passe",-1)),E("div",HD,[Fn(E("input",{id:"confirm-password","onUpdate:modelValue":g[2]||(g[2]=y=>r.confirmPassword=y),name:"confirm-password",type:"password",required:"",autocomplete:"new-password",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Confirmez votre nouveau mot de passe"},null,512),[[ri,r.confirmPassword]])])])]),s.value?($e(),qe("div",qD,[E("div",WD,[g[7]||(g[7]=E("div",{class:"flex-shrink-0"},[E("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[E("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),E("div",ZD,[E("h3",KD,Wt(s.value),1)])])])):dn("",!0),o.value.length>0?($e(),qe("div",YD,[E("div",JD,[g[9]||(g[9]=E("div",{class:"flex-shrink-0"},[E("svg",{class:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},[E("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])],-1)),E("div",XD,[g[8]||(g[8]=E("h3",{class:"text-sm font-medium text-yellow-800"},"Attention",-1)),E("div",QD,[E("ul",eI,[($e(!0),qe(Bn,null,Er(o.value,(y,x)=>($e(),qe("li",{key:x},Wt(y),1))),128))])])])])])):dn("",!0),E("div",null,[E("button",{type:"submit",disabled:i.value||!u.value,class:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50"},[E("span",nI,[i.value?($e(),qe("svg",iI,g[11]||(g[11]=[E("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),E("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):($e(),qe("svg",rI,g[10]||(g[10]=[E("path",{"fill-rule":"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule":"evenodd"},null,-1)])))]),Pi(" "+Wt(i.value?"Modification en cours...":"Changer le mot de passe"),1)],8,tI)])],32)])]))}}),sI="/static/frontend/assets/background.svg",aI={class:"min-h-screen overflow-auto relative py-12 sm:px-6 lg:px-8"},lI={class:"container mx-auto relative z-10"},uI={class:"sm:mx-auto sm:w-full sm:max-w-md"},cI={class:"bg-white/95 backdrop-blur-sm py-8 px-6 shadow-xl rounded-xl sm:px-10 border border-white/20"},fI={key:0,class:"rounded-md bg-red-50 p-4"},hI={class:"flex"},dI={class:"ml-3"},pI={class:"text-sm font-medium text-red-800"},gI={class:"mt-1"},mI={class:"mt-1 relative"},vI=["type"],yI={key:0,class:"h-5 w-5 text-gray-400 hover:text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},_I={key:1,class:"h-5 w-5 text-gray-400 hover:text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},bI={class:"flex items-center justify-between"},wI={class:"flex items-center"},xI={class:"text-sm"},LI=["disabled"],SI={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},CI={class:"mt-16 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},EI={class:"mt-12"},PI={class:"flex flex-wrap justify-center gap-2 mb-8"},MI=["onClick"],AI={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},kI={class:"flex items-center mb-4"},TI={class:"text-2xl mr-2"},NI={class:"text-xl font-semibold text-gray-900"},DI={class:"text-gray-600 text-sm"},II={key:0,class:"flex justify-center mt-8 gap-2"},OI=["onClick"],nv=6,BI=cs({__name:"LoginView",setup(e){const t=Op(),n=ma(),r=Ft(!1),i=Ft(null),s=Ft(!1),o=Ft("Tous"),u=Ft(1),f=Yl({username:"",password:"",rememberMe:!1}),d=[{type:"Liniculteur",sector:"Agriculture",icon:"🌾",text:"En tant qu'entreprise, j'ai mis en place un sous-compte « agriculteur » permettant la géolocalisation des parcelles. Cela offre à nos salariés et prestataires une visibilité complète sur l'ensemble des parcelles et facilite leur accès. De plus, ils peuvent y ajouter des notes et des photos si nécessaire. Grâce aux trackers, nous renforçons également la sécurité de nos machines contre le vol."},{type:"Agro industriel",sector:"Industrie",icon:"🏭",text:"La gestion des comptes et sous-comptes est un atout majeur pour limiter, filtrer et contrôler l'accès de nos salariés aux différentes tâches."},{type:"Agence de voyage",sector:"Tourisme",icon:"✈️",text:"L'outil nous permet de créer gratuitement et sans limite des sous-comptes clients, d'établir des itinéraires personnalisés avec des points d'intérêt."},{type:"Industriel agroalimentaire",sector:"Industrie",icon:"🌱",text:"Nous disposons d'un compte entreprise avec des sous-comptes dédiés à chaque culture. Nos techniciens et agriculteurs partenaires peuvent ainsi ajouter des annotations et photo sur les parcelles. Grâce aux stations météo connectées, nous optimisons la gestion des tours d'irrigation par secteur géographique en fonction des précipitations."},{type:"Conseil municipal",sector:"Collectivité",icon:"🏛️",text:"Cette solution nous permet de gagner en efficacité dans la gestion des tâches à réaliser, en les géolocalisant et en offrant à nos employés communaux la possibilité d'ajouter des commentaires et des photos sur chaque tâche géoréférencée."},{type:"Location de matériel",sector:"Services",icon:"🚜",text:"Cette solution nous permet de géolocaliser notre flotte grâce à des trackers sans abonnement, avec uniquement un abonnement à la plateforme."},{type:"Agriculteur",sector:"Agriculture",icon:"👨‍🌾",text:"J'ai équipé tous mes canons d'enrouleurs de trackers et de caméras pour dissuader le vol de batteries."},{type:"Semencier",sector:"Agriculture",icon:"🌱",text:"Nous assurons la géolocalisation de l'ensemble de nos parcelles en France."},{type:"Concessionnaire irrigation",sector:"Services",icon:"💧",text:"Nous avons géolocalisé tous les forages de nos clients et ajouté en commentaire la procédure d'entrée, facilitant ainsi le travail de nos techniciens et agriculteurs lors des interventions."},{type:"Entreprise paysagiste",sector:"Services",icon:"🌳",text:"Nous géolocalisons tous nos chantiers et ajoutons une photo du chantier terminé en commentaire, servant de preuve en cas de litige."}],g=cr(()=>["Tous",...new Set(d.map(T=>T.sector))]),y=cr(()=>{let M=o.value==="Tous"?d:d.filter(I=>I.sector===o.value);const T=(u.value-1)*nv,D=T+nv;return M.slice(T,D)}),x=cr(()=>{const M=o.value==="Tous"?d:d.filter(T=>T.sector===o.value);return Math.ceil(M.length/nv)});$s(async()=>{var M;console.log("LoginView mounted"),console.log("INITIAL_STATE:",window.INITIAL_STATE);try{if((M=window.INITIAL_STATE)!=null&&M.isAuthenticated){console.log("User is authenticated, redirecting to home"),t.push("/");return}await n.restoreSession()&&(console.log("Session restored, redirecting to home"),t.push("/"))}catch(T){console.error("Error during initialization:",T),i.value=null}});async function _(){var M,T,D,I,j,Z,te,ue,le;r.value=!0,i.value=null;try{if(!f.username||!f.password){i.value="Veuillez remplir tous les champs";return}await n.login(f.username,f.password),(M=n.user)!=null&&M.must_change_password?t.push("/change-password"):t.push("/")}catch(ge){console.error("Login error:",ge),((T=ge==null?void 0:ge.response)==null?void 0:T.status)===500?i.value="Le service est temporairement indisponible. Veuillez réessayer dans quelques instants.":((D=ge==null?void 0:ge.response)==null?void 0:D.status)===401||((I=ge==null?void 0:ge.response)==null?void 0:I.status)===403?i.value="Identifiants incorrects. Veuillez vérifier votre nom d'utilisateur et mot de passe.":(Z=(j=ge==null?void 0:ge.response)==null?void 0:j.data)!=null&&Z.detail?i.value=ge.response.data.detail:(le=(ue=(te=ge==null?void 0:ge.response)==null?void 0:te.data)==null?void 0:ue.non_field_errors)!=null&&le[0]?i.value=ge.response.data.non_field_errors[0]:(ge==null?void 0:ge.message)==="Network Error"?i.value="Impossible de se connecter au serveur. Veuillez vérifier votre connexion internet.":i.value="Une erreur est survenue lors de la connexion. Veuillez réessayer."}finally{r.value=!1}}return(M,T)=>{const D=Yw("router-link");return $e(),qe("div",aI,[E("div",{class:"fixed inset-0 z-0",style:ql({backgroundImage:`url(${Wn(sI)})`,backgroundSize:"400px",backgroundRepeat:"repeat",filter:"blur(1px) opacity(0.15)"})},null,4),T[16]||(T[16]=E("div",{class:"fixed inset-0 z-0 bg-gradient-to-br from-white/40 via-transparent to-primary-900/10"},null,-1)),E("div",lI,[E("div",uI,[E("div",cI,[T[12]||(T[12]=E("div",{class:"text-center mb-8"},[E("h2",{class:"text-3xl font-bold text-gray-900 mb-2"}," TagMap "),E("p",{class:"text-sm text-gray-600"}," Solution innovante de cartographie et gestion de projets ")],-1)),E("form",{class:"space-y-6",onSubmit:Sf(_,["prevent"])},[i.value?($e(),qe("div",fI,[E("div",hI,[T[4]||(T[4]=E("div",{class:"flex-shrink-0"},[E("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[E("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),E("div",dI,[E("h3",pI,Wt(i.value),1)])])])):dn("",!0),E("div",null,[T[5]||(T[5]=E("label",{for:"username",class:"block text-sm font-medium text-gray-700"}," Nom d'utilisateur ",-1)),E("div",gI,[Fn(E("input",{id:"username","onUpdate:modelValue":T[0]||(T[0]=I=>f.username=I),name:"username",type:"text",required:"",autocomplete:"username",class:"appearance-none block w-full h-11 px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 sm:text-sm","aria-label":"Nom d'utilisateur"},null,512),[[ri,f.username]])])]),E("div",null,[T[8]||(T[8]=E("label",{for:"password",class:"block text-sm font-medium text-gray-700"}," Mot de passe ",-1)),E("div",mI,[Fn(E("input",{id:"password","onUpdate:modelValue":T[1]||(T[1]=I=>f.password=I),type:s.value?"text":"password",name:"password",required:"",autocomplete:"current-password",class:"appearance-none block w-full h-11 px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 sm:text-sm pr-10","aria-label":"Mot de passe"},null,8,vI),[[iy,f.password]]),E("button",{type:"button",onClick:T[2]||(T[2]=I=>s.value=!s.value),class:"absolute inset-y-0 right-0 pr-3 flex items-center","aria-label":"Afficher/masquer le mot de passe"},[s.value?($e(),qe("svg",yI,T[6]||(T[6]=[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)]))):($e(),qe("svg",_I,T[7]||(T[7]=[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])))])])]),E("div",bI,[E("div",wI,[Fn(E("input",{id:"remember-me","onUpdate:modelValue":T[3]||(T[3]=I=>f.rememberMe=I),name:"remember-me",type:"checkbox",class:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded","aria-label":"Se souvenir de moi"},null,512),[[Ll,f.rememberMe]]),T[9]||(T[9]=E("label",{for:"remember-me",class:"ml-2 block text-sm text-gray-900"}," Se souvenir de moi ",-1))]),E("div",xI,[hi(D,{to:"/forgot-password",class:"font-medium text-primary-600 hover:text-primary-500 transition-colors duration-200"},{default:Gl(()=>T[10]||(T[10]=[Pi(" Mot de passe oublié ? ")])),_:1})])]),E("div",null,[E("button",{type:"submit",disabled:r.value,class:"w-full h-11 flex justify-center items-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Se connecter"},[r.value?($e(),qe("svg",SI,T[11]||(T[11]=[E("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),E("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):dn("",!0),Pi(" "+Wt(r.value?"Connexion en cours...":"Se connecter"),1)],8,LI)])],32)])]),E("div",CI,[T[14]||(T[14]=cc('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8" data-v-0be9fb33><div class="bg-white/90 backdrop-blur-sm p-6 rounded-xl shadow-lg border border-white/20" data-v-0be9fb33><div class="flex items-center mb-4" data-v-0be9fb33><span class="text-2xl mr-2" data-v-0be9fb33>👀📌</span><h3 class="text-lg font-semibold text-gray-900" data-v-0be9fb33>Carte Interactive</h3></div><p class="text-gray-600" data-v-0be9fb33>Imaginez... Une carte interactive où tout est sous contrôle ! Tout est centralisé, organisé et accessible en un clin d&#39;œil !</p></div><div class="bg-white/90 backdrop-blur-sm p-6 rounded-xl shadow-lg border border-white/20" data-v-0be9fb33><div class="flex items-center mb-4" data-v-0be9fb33><span class="text-2xl mr-2" data-v-0be9fb33>👥💻🔄</span><h3 class="text-lg font-semibold text-gray-900" data-v-0be9fb33>Collaboration en Temps Réel</h3></div><p class="text-gray-600" data-v-0be9fb33>Travail d&#39;équipe simplifié : Collaborez en temps réel sur une interface ultra-intuitive. Vos équipes restent synchronisées et efficaces !</p></div><div class="bg-white/90 backdrop-blur-sm p-6 rounded-xl shadow-lg border border-white/20" data-v-0be9fb33><div class="flex items-center mb-4" data-v-0be9fb33><span class="text-2xl mr-2" data-v-0be9fb33>🚜📸</span><h3 class="text-lg font-semibold text-gray-900" data-v-0be9fb33>Cerveau Cartographique</h3></div><p class="text-gray-600" data-v-0be9fb33>Un cerveau cartographique : Dessinez, annotez, planifiez, suivez !</p></div><div class="bg-white/90 backdrop-blur-sm p-6 rounded-xl shadow-lg border border-white/20" data-v-0be9fb33><div class="flex items-center mb-4" data-v-0be9fb33><span class="text-2xl mr-2" data-v-0be9fb33>🔐🔑</span><h3 class="text-lg font-semibold text-gray-900" data-v-0be9fb33>Accès Sécurisé</h3></div><p class="text-gray-600" data-v-0be9fb33>Accès sécurisé et intelligent : Gérez les droits d&#39;accès de vos salariés et prestataires en un clic.</p></div></div><div class="mt-12 bg-white/90 backdrop-blur-sm p-8 rounded-xl shadow-lg border border-white/20" data-v-0be9fb33><div class="flex items-center mb-6" data-v-0be9fb33><span class="text-2xl mr-2" data-v-0be9fb33>💡</span><h3 class="text-xl font-bold text-gray-900" data-v-0be9fb33>Équipements Connectés sans Abonnement</h3></div><div class="grid grid-cols-1 md:grid-cols-2 gap-6" data-v-0be9fb33><div class="flex items-center space-x-4" data-v-0be9fb33><div class="flex-shrink-0 text-2xl" data-v-0be9fb33>📍</div><div data-v-0be9fb33><h4 class="font-semibold" data-v-0be9fb33>Tracker GPS solaire</h4><p class="text-gray-600" data-v-0be9fb33>Géolocalisez et sécurisez votre matériel</p></div></div><div class="flex items-center space-x-4" data-v-0be9fb33><div class="flex-shrink-0 text-2xl" data-v-0be9fb33>🌤️</div><div data-v-0be9fb33><h4 class="font-semibold" data-v-0be9fb33>Station météo</h4><p class="text-gray-600" data-v-0be9fb33>Optimisez vos décisions avec des données en temps réel</p></div></div></div></div>',2)),E("div",EI,[T[13]||(T[13]=E("h3",{class:"text-2xl font-bold text-center text-gray-900 mb-8"},"Ils utilisent TagMap",-1)),E("div",PI,[($e(!0),qe(Bn,null,Er(g.value,I=>($e(),qe("button",{key:I,onClick:j=>o.value=I,class:Bi(["px-4 py-2 rounded-full text-sm font-medium transition-all duration-200",o.value===I?"bg-primary-600 text-white":"bg-white/80 text-gray-700 hover:bg-primary-50"])},Wt(I),11,MI))),128))]),E("div",AI,[($e(!0),qe(Bn,null,Er(y.value,I=>($e(),qe("div",{key:I.type,class:"bg-white/90 backdrop-blur-sm p-6 rounded-xl shadow-lg border border-white/20 transition-all duration-300 hover:shadow-xl"},[E("div",kI,[E("span",TI,Wt(I.icon),1),E("span",NI,Wt(I.type),1)]),E("p",DI,Wt(I.text),1)]))),128))]),x.value>1?($e(),qe("div",II,[($e(!0),qe(Bn,null,Er(x.value,I=>($e(),qe("button",{key:I,onClick:j=>u.value=I,class:Bi(["w-8 h-8 rounded-full text-sm font-medium transition-all duration-200",u.value===I?"bg-primary-600 text-white":"bg-white/80 text-gray-700 hover:bg-primary-50"])},Wt(I),11,OI))),128))])):dn("",!0)])]),T[15]||(T[15]=E("div",{class:"h-16"},null,-1))])])}}}),RI=Bp(BI,[["__scopeId","data-v-0be9fb33"]]),ib="/static/frontend/assets/logo.svg";var a1={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(n,r){r(t)})(ea,function(n){var r="1.9.4";function i(a){var p,S,V,ie;for(S=1,V=arguments.length;S<V;S++){ie=arguments[S];for(p in ie)a[p]=ie[p]}return a}var s=Object.create||function(){function a(){}return function(p){return a.prototype=p,new a}}();function o(a,p){var S=Array.prototype.slice;if(a.bind)return a.bind.apply(a,S.call(arguments,1));var V=S.call(arguments,2);return function(){return a.apply(p,V.length?V.concat(S.call(arguments)):arguments)}}var u=0;function f(a){return"_leaflet_id"in a||(a._leaflet_id=++u),a._leaflet_id}function d(a,p,S){var V,ie,Ce,st;return st=function(){V=!1,ie&&(Ce.apply(S,ie),ie=!1)},Ce=function(){V?ie=arguments:(a.apply(S,arguments),setTimeout(st,p),V=!0)},Ce}function g(a,p,S){var V=p[1],ie=p[0],Ce=V-ie;return a===V&&S?a:((a-ie)%Ce+Ce)%Ce+ie}function y(){return!1}function x(a,p){if(p===!1)return a;var S=Math.pow(10,p===void 0?6:p);return Math.round(a*S)/S}function _(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function M(a){return _(a).split(/\s+/)}function T(a,p){Object.prototype.hasOwnProperty.call(a,"options")||(a.options=a.options?s(a.options):{});for(var S in p)a.options[S]=p[S];return a.options}function D(a,p,S){var V=[];for(var ie in a)V.push(encodeURIComponent(S?ie.toUpperCase():ie)+"="+encodeURIComponent(a[ie]));return(!p||p.indexOf("?")===-1?"?":"&")+V.join("&")}var I=/\{ *([\w_ -]+) *\}/g;function j(a,p){return a.replace(I,function(S,V){var ie=p[V];if(ie===void 0)throw new Error("No value provided for variable "+S);return typeof ie=="function"&&(ie=ie(p)),ie})}var Z=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"};function te(a,p){for(var S=0;S<a.length;S++)if(a[S]===p)return S;return-1}var ue="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function le(a){return window["webkit"+a]||window["moz"+a]||window["ms"+a]}var ge=0;function H(a){var p=+new Date,S=Math.max(0,16-(p-ge));return ge=p+S,window.setTimeout(a,S)}var U=window.requestAnimationFrame||le("RequestAnimationFrame")||H,Q=window.cancelAnimationFrame||le("CancelAnimationFrame")||le("CancelRequestAnimationFrame")||function(a){window.clearTimeout(a)};function F(a,p,S){if(S&&U===H)a.call(p);else return U.call(window,o(a,p))}function B(a){a&&Q.call(window,a)}var R={__proto__:null,extend:i,create:s,bind:o,get lastId(){return u},stamp:f,throttle:d,wrapNum:g,falseFn:y,formatNum:x,trim:_,splitWords:M,setOptions:T,getParamString:D,template:j,isArray:Z,indexOf:te,emptyImageUrl:ue,requestFn:U,cancelFn:Q,requestAnimFrame:F,cancelAnimFrame:B};function $(){}$.extend=function(a){var p=function(){T(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},S=p.__super__=this.prototype,V=s(S);V.constructor=p,p.prototype=V;for(var ie in this)Object.prototype.hasOwnProperty.call(this,ie)&&ie!=="prototype"&&ie!=="__super__"&&(p[ie]=this[ie]);return a.statics&&i(p,a.statics),a.includes&&(W(a.includes),i.apply(null,[V].concat(a.includes))),i(V,a),delete V.statics,delete V.includes,V.options&&(V.options=S.options?s(S.options):{},i(V.options,a.options)),V._initHooks=[],V.callInitHooks=function(){if(!this._initHooksCalled){S.callInitHooks&&S.callInitHooks.call(this),this._initHooksCalled=!0;for(var Ce=0,st=V._initHooks.length;Ce<st;Ce++)V._initHooks[Ce].call(this)}},p},$.include=function(a){var p=this.prototype.options;return i(this.prototype,a),a.options&&(this.prototype.options=p,this.mergeOptions(a.options)),this},$.mergeOptions=function(a){return i(this.prototype.options,a),this},$.addInitHook=function(a){var p=Array.prototype.slice.call(arguments,1),S=typeof a=="function"?a:function(){this[a].apply(this,p)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(S),this};function W(a){if(!(typeof L>"u"||!L||!L.Mixin)){a=Z(a)?a:[a];for(var p=0;p<a.length;p++)a[p]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var G={on:function(a,p,S){if(typeof a=="object")for(var V in a)this._on(V,a[V],p);else{a=M(a);for(var ie=0,Ce=a.length;ie<Ce;ie++)this._on(a[ie],p,S)}return this},off:function(a,p,S){if(!arguments.length)delete this._events;else if(typeof a=="object")for(var V in a)this._off(V,a[V],p);else{a=M(a);for(var ie=arguments.length===1,Ce=0,st=a.length;Ce<st;Ce++)ie?this._off(a[Ce]):this._off(a[Ce],p,S)}return this},_on:function(a,p,S,V){if(typeof p!="function"){console.warn("wrong listener type: "+typeof p);return}if(this._listens(a,p,S)===!1){S===this&&(S=void 0);var ie={fn:p,ctx:S};V&&(ie.once=!0),this._events=this._events||{},this._events[a]=this._events[a]||[],this._events[a].push(ie)}},_off:function(a,p,S){var V,ie,Ce;if(this._events&&(V=this._events[a],!!V)){if(arguments.length===1){if(this._firingCount)for(ie=0,Ce=V.length;ie<Ce;ie++)V[ie].fn=y;delete this._events[a];return}if(typeof p!="function"){console.warn("wrong listener type: "+typeof p);return}var st=this._listens(a,p,S);if(st!==!1){var Pt=V[st];this._firingCount&&(Pt.fn=y,this._events[a]=V=V.slice()),V.splice(st,1)}}},fire:function(a,p,S){if(!this.listens(a,S))return this;var V=i({},p,{type:a,target:this,sourceTarget:p&&p.sourceTarget||this});if(this._events){var ie=this._events[a];if(ie){this._firingCount=this._firingCount+1||1;for(var Ce=0,st=ie.length;Ce<st;Ce++){var Pt=ie[Ce],Ut=Pt.fn;Pt.once&&this.off(a,Ut,Pt.ctx),Ut.call(Pt.ctx||this,V)}this._firingCount--}}return S&&this._propagateEvent(V),this},listens:function(a,p,S,V){typeof a!="string"&&console.warn('"string" type argument expected');var ie=p;typeof p!="function"&&(V=!!p,ie=void 0,S=void 0);var Ce=this._events&&this._events[a];if(Ce&&Ce.length&&this._listens(a,ie,S)!==!1)return!0;if(V){for(var st in this._eventParents)if(this._eventParents[st].listens(a,p,S,V))return!0}return!1},_listens:function(a,p,S){if(!this._events)return!1;var V=this._events[a]||[];if(!p)return!!V.length;S===this&&(S=void 0);for(var ie=0,Ce=V.length;ie<Ce;ie++)if(V[ie].fn===p&&V[ie].ctx===S)return ie;return!1},once:function(a,p,S){if(typeof a=="object")for(var V in a)this._on(V,a[V],p,!0);else{a=M(a);for(var ie=0,Ce=a.length;ie<Ce;ie++)this._on(a[ie],p,S,!0)}return this},addEventParent:function(a){return this._eventParents=this._eventParents||{},this._eventParents[f(a)]=a,this},removeEventParent:function(a){return this._eventParents&&delete this._eventParents[f(a)],this},_propagateEvent:function(a){for(var p in this._eventParents)this._eventParents[p].fire(a.type,i({layer:a.target,propagatedFrom:a.target},a),!0)}};G.addEventListener=G.on,G.removeEventListener=G.clearAllEventListeners=G.off,G.addOneTimeEventListener=G.once,G.fireEvent=G.fire,G.hasEventListeners=G.listens;var J=$.extend(G);function Y(a,p,S){this.x=S?Math.round(a):a,this.y=S?Math.round(p):p}var pe=Math.trunc||function(a){return a>0?Math.floor(a):Math.ceil(a)};Y.prototype={clone:function(){return new Y(this.x,this.y)},add:function(a){return this.clone()._add(Le(a))},_add:function(a){return this.x+=a.x,this.y+=a.y,this},subtract:function(a){return this.clone()._subtract(Le(a))},_subtract:function(a){return this.x-=a.x,this.y-=a.y,this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){return this.x/=a,this.y/=a,this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){return this.x*=a,this.y*=a,this},scaleBy:function(a){return new Y(this.x*a.x,this.y*a.y)},unscaleBy:function(a){return new Y(this.x/a.x,this.y/a.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=pe(this.x),this.y=pe(this.y),this},distanceTo:function(a){a=Le(a);var p=a.x-this.x,S=a.y-this.y;return Math.sqrt(p*p+S*S)},equals:function(a){return a=Le(a),a.x===this.x&&a.y===this.y},contains:function(a){return a=Le(a),Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+x(this.x)+", "+x(this.y)+")"}};function Le(a,p,S){return a instanceof Y?a:Z(a)?new Y(a[0],a[1]):a==null?a:typeof a=="object"&&"x"in a&&"y"in a?new Y(a.x,a.y):new Y(a,p,S)}function De(a,p){if(a)for(var S=p?[a,p]:a,V=0,ie=S.length;V<ie;V++)this.extend(S[V])}De.prototype={extend:function(a){var p,S;if(!a)return this;if(a instanceof Y||typeof a[0]=="number"||"x"in a)p=S=Le(a);else if(a=N(a),p=a.min,S=a.max,!p||!S)return this;return!this.min&&!this.max?(this.min=p.clone(),this.max=S.clone()):(this.min.x=Math.min(p.x,this.min.x),this.max.x=Math.max(S.x,this.max.x),this.min.y=Math.min(p.y,this.min.y),this.max.y=Math.max(S.y,this.max.y)),this},getCenter:function(a){return Le((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return Le(this.min.x,this.max.y)},getTopRight:function(){return Le(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var p,S;return typeof a[0]=="number"||a instanceof Y?a=Le(a):a=N(a),a instanceof De?(p=a.min,S=a.max):p=S=a,p.x>=this.min.x&&S.x<=this.max.x&&p.y>=this.min.y&&S.y<=this.max.y},intersects:function(a){a=N(a);var p=this.min,S=this.max,V=a.min,ie=a.max,Ce=ie.x>=p.x&&V.x<=S.x,st=ie.y>=p.y&&V.y<=S.y;return Ce&&st},overlaps:function(a){a=N(a);var p=this.min,S=this.max,V=a.min,ie=a.max,Ce=ie.x>p.x&&V.x<S.x,st=ie.y>p.y&&V.y<S.y;return Ce&&st},isValid:function(){return!!(this.min&&this.max)},pad:function(a){var p=this.min,S=this.max,V=Math.abs(p.x-S.x)*a,ie=Math.abs(p.y-S.y)*a;return N(Le(p.x-V,p.y-ie),Le(S.x+V,S.y+ie))},equals:function(a){return a?(a=N(a),this.min.equals(a.getTopLeft())&&this.max.equals(a.getBottomRight())):!1}};function N(a,p){return!a||a instanceof De?a:new De(a,p)}function ee(a,p){if(a)for(var S=p?[a,p]:a,V=0,ie=S.length;V<ie;V++)this.extend(S[V])}ee.prototype={extend:function(a){var p=this._southWest,S=this._northEast,V,ie;if(a instanceof ce)V=a,ie=a;else if(a instanceof ee){if(V=a._southWest,ie=a._northEast,!V||!ie)return this}else return a?this.extend(_e(a)||fe(a)):this;return!p&&!S?(this._southWest=new ce(V.lat,V.lng),this._northEast=new ce(ie.lat,ie.lng)):(p.lat=Math.min(V.lat,p.lat),p.lng=Math.min(V.lng,p.lng),S.lat=Math.max(ie.lat,S.lat),S.lng=Math.max(ie.lng,S.lng)),this},pad:function(a){var p=this._southWest,S=this._northEast,V=Math.abs(p.lat-S.lat)*a,ie=Math.abs(p.lng-S.lng)*a;return new ee(new ce(p.lat-V,p.lng-ie),new ce(S.lat+V,S.lng+ie))},getCenter:function(){return new ce((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ce(this.getNorth(),this.getWest())},getSouthEast:function(){return new ce(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){typeof a[0]=="number"||a instanceof ce||"lat"in a?a=_e(a):a=fe(a);var p=this._southWest,S=this._northEast,V,ie;return a instanceof ee?(V=a.getSouthWest(),ie=a.getNorthEast()):V=ie=a,V.lat>=p.lat&&ie.lat<=S.lat&&V.lng>=p.lng&&ie.lng<=S.lng},intersects:function(a){a=fe(a);var p=this._southWest,S=this._northEast,V=a.getSouthWest(),ie=a.getNorthEast(),Ce=ie.lat>=p.lat&&V.lat<=S.lat,st=ie.lng>=p.lng&&V.lng<=S.lng;return Ce&&st},overlaps:function(a){a=fe(a);var p=this._southWest,S=this._northEast,V=a.getSouthWest(),ie=a.getNorthEast(),Ce=ie.lat>p.lat&&V.lat<S.lat,st=ie.lng>p.lng&&V.lng<S.lng;return Ce&&st},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(a,p){return a?(a=fe(a),this._southWest.equals(a.getSouthWest(),p)&&this._northEast.equals(a.getNorthEast(),p)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function fe(a,p){return a instanceof ee?a:new ee(a,p)}function ce(a,p,S){if(isNaN(a)||isNaN(p))throw new Error("Invalid LatLng object: ("+a+", "+p+")");this.lat=+a,this.lng=+p,S!==void 0&&(this.alt=+S)}ce.prototype={equals:function(a,p){if(!a)return!1;a=_e(a);var S=Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng));return S<=(p===void 0?1e-9:p)},toString:function(a){return"LatLng("+x(this.lat,a)+", "+x(this.lng,a)+")"},distanceTo:function(a){return k.distance(this,_e(a))},wrap:function(){return k.wrapLatLng(this)},toBounds:function(a){var p=180*a/40075017,S=p/Math.cos(Math.PI/180*this.lat);return fe([this.lat-p,this.lng-S],[this.lat+p,this.lng+S])},clone:function(){return new ce(this.lat,this.lng,this.alt)}};function _e(a,p,S){return a instanceof ce?a:Z(a)&&typeof a[0]!="object"?a.length===3?new ce(a[0],a[1],a[2]):a.length===2?new ce(a[0],a[1]):null:a==null?a:typeof a=="object"&&"lat"in a?new ce(a.lat,"lng"in a?a.lng:a.lon,a.alt):p===void 0?null:new ce(a,p,S)}var se={latLngToPoint:function(a,p){var S=this.projection.project(a),V=this.scale(p);return this.transformation._transform(S,V)},pointToLatLng:function(a,p){var S=this.scale(p),V=this.transformation.untransform(a,S);return this.projection.unproject(V)},project:function(a){return this.projection.project(a)},unproject:function(a){return this.projection.unproject(a)},scale:function(a){return 256*Math.pow(2,a)},zoom:function(a){return Math.log(a/256)/Math.LN2},getProjectedBounds:function(a){if(this.infinite)return null;var p=this.projection.bounds,S=this.scale(a),V=this.transformation.transform(p.min,S),ie=this.transformation.transform(p.max,S);return new De(V,ie)},infinite:!1,wrapLatLng:function(a){var p=this.wrapLng?g(a.lng,this.wrapLng,!0):a.lng,S=this.wrapLat?g(a.lat,this.wrapLat,!0):a.lat,V=a.alt;return new ce(S,p,V)},wrapLatLngBounds:function(a){var p=a.getCenter(),S=this.wrapLatLng(p),V=p.lat-S.lat,ie=p.lng-S.lng;if(V===0&&ie===0)return a;var Ce=a.getSouthWest(),st=a.getNorthEast(),Pt=new ce(Ce.lat-V,Ce.lng-ie),Ut=new ce(st.lat-V,st.lng-ie);return new ee(Pt,Ut)}},k=i({},se,{wrapLng:[-180,180],R:6371e3,distance:function(a,p){var S=Math.PI/180,V=a.lat*S,ie=p.lat*S,Ce=Math.sin((p.lat-a.lat)*S/2),st=Math.sin((p.lng-a.lng)*S/2),Pt=Ce*Ce+Math.cos(V)*Math.cos(ie)*st*st,Ut=2*Math.atan2(Math.sqrt(Pt),Math.sqrt(1-Pt));return this.R*Ut}}),ae=6378137,ke={R:ae,MAX_LATITUDE:85.0511287798,project:function(a){var p=Math.PI/180,S=this.MAX_LATITUDE,V=Math.max(Math.min(S,a.lat),-S),ie=Math.sin(V*p);return new Y(this.R*a.lng*p,this.R*Math.log((1+ie)/(1-ie))/2)},unproject:function(a){var p=180/Math.PI;return new ce((2*Math.atan(Math.exp(a.y/this.R))-Math.PI/2)*p,a.x*p/this.R)},bounds:function(){var a=ae*Math.PI;return new De([-a,-a],[a,a])}()};function Pe(a,p,S,V){if(Z(a)){this._a=a[0],this._b=a[1],this._c=a[2],this._d=a[3];return}this._a=a,this._b=p,this._c=S,this._d=V}Pe.prototype={transform:function(a,p){return this._transform(a.clone(),p)},_transform:function(a,p){return p=p||1,a.x=p*(this._a*a.x+this._b),a.y=p*(this._c*a.y+this._d),a},untransform:function(a,p){return p=p||1,new Y((a.x/p-this._b)/this._a,(a.y/p-this._d)/this._c)}};function Ge(a,p,S,V){return new Pe(a,p,S,V)}var K=i({},k,{code:"EPSG:3857",projection:ke,transformation:function(){var a=.5/(Math.PI*ke.R);return Ge(a,.5,-a,.5)}()}),de=i({},K,{code:"EPSG:900913"});function ye(a){return document.createElementNS("http://www.w3.org/2000/svg",a)}function me(a,p){var S="",V,ie,Ce,st,Pt,Ut;for(V=0,Ce=a.length;V<Ce;V++){for(Pt=a[V],ie=0,st=Pt.length;ie<st;ie++)Ut=Pt[ie],S+=(ie?"L":"M")+Ut.x+" "+Ut.y;S+=p?lt.svg?"z":"x":""}return S||"M0 0"}var Ue=document.documentElement.style,Qe="ActiveXObject"in window,Ze=Qe&&!document.addEventListener,He="msLaunchUri"in navigator&&!("documentMode"in document),Xe=mr("webkit"),tt=mr("android"),Mt=mr("android 2")||mr("android 3"),Lt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),jt=tt&&mr("Google")&&Lt<537&&!("AudioNode"in window),zt=!!window.opera,sn=!He&&mr("chrome"),pn=mr("gecko")&&!Xe&&!zt&&!Qe,et=!sn&&mr("safari"),ot=mr("phantom"),rt="OTransition"in Ue,Ht=navigator.platform.indexOf("Win")===0,Qt=Qe&&"transition"in Ue,On="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Mt,wn="MozPerspective"in Ue,Tn=!window.L_DISABLE_3D&&(Qt||On||wn)&&!rt&&!ot,ar=typeof orientation<"u"||mr("mobile"),xn=ar&&Xe,Mn=ar&&On,Pn=!window.PointerEvent&&window.MSPointerEvent,fr=!!(window.PointerEvent||Pn),yr="ontouchstart"in window||!!window.TouchEvent,at=!window.L_NO_TOUCH&&(yr||fr),We=ar&&zt,It=ar&&pn,En=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Jn=function(){var a=!1;try{var p=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("testPassiveEventSupport",y,p),window.removeEventListener("testPassiveEventSupport",y,p)}catch{}return a}(),Zn=function(){return!!document.createElement("canvas").getContext}(),qt=!!(document.createElementNS&&ye("svg").createSVGRect),mn=!!qt&&function(){var a=document.createElement("div");return a.innerHTML="<svg/>",(a.firstChild&&a.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Bt=!qt&&function(){try{var a=document.createElement("div");a.innerHTML='<v:shape adj="1"/>';var p=a.firstChild;return p.style.behavior="url(#default#VML)",p&&typeof p.adj=="object"}catch{return!1}}(),Kt=navigator.platform.indexOf("Mac")===0,Ln=navigator.platform.indexOf("Linux")===0;function mr(a){return navigator.userAgent.toLowerCase().indexOf(a)>=0}var lt={ie:Qe,ielt9:Ze,edge:He,webkit:Xe,android:tt,android23:Mt,androidStock:jt,opera:zt,chrome:sn,gecko:pn,safari:et,phantom:ot,opera12:rt,win:Ht,ie3d:Qt,webkit3d:On,gecko3d:wn,any3d:Tn,mobile:ar,mobileWebkit:xn,mobileWebkit3d:Mn,msPointer:Pn,pointer:fr,touch:at,touchNative:yr,mobileOpera:We,mobileGecko:It,retina:En,passiveEvents:Jn,canvas:Zn,svg:qt,vml:Bt,inlineSvg:mn,mac:Kt,linux:Ln},Cn=lt.msPointer?"MSPointerDown":"pointerdown",xr=lt.msPointer?"MSPointerMove":"pointermove",Ii=lt.msPointer?"MSPointerUp":"pointerup",Fr=lt.msPointer?"MSPointerCancel":"pointercancel",Pr={touchstart:Cn,touchmove:xr,touchend:Ii,touchcancel:Fr},lr={touchstart:Br,touchmove:Kr,touchend:Kr,touchcancel:Kr},Hr={},ir=!1;function Or(a,p,S){return p==="touchstart"&&gi(),lr[p]?(S=lr[p].bind(this,S),a.addEventListener(Pr[p],S,!1),S):(console.warn("wrong event specified:",p),y)}function jr(a,p,S){if(!Pr[p]){console.warn("wrong event specified:",p);return}a.removeEventListener(Pr[p],S,!1)}function rn(a){Hr[a.pointerId]=a}function ji(a){Hr[a.pointerId]&&(Hr[a.pointerId]=a)}function _i(a){delete Hr[a.pointerId]}function gi(){ir||(document.addEventListener(Cn,rn,!0),document.addEventListener(xr,ji,!0),document.addEventListener(Ii,_i,!0),document.addEventListener(Fr,_i,!0),ir=!0)}function Kr(a,p){if(p.pointerType!==(p.MSPOINTER_TYPE_MOUSE||"mouse")){p.touches=[];for(var S in Hr)p.touches.push(Hr[S]);p.changedTouches=[p],a(p)}}function Br(a,p){p.MSPOINTER_TYPE_TOUCH&&p.pointerType===p.MSPOINTER_TYPE_TOUCH&&Sr(p),Kr(a,p)}function Rr(a){var p={},S,V;for(V in a)S=a[V],p[V]=S&&S.bind?S.bind(a):S;return a=p,p.type="dblclick",p.detail=2,p.isTrusted=!1,p._simulated=!0,p}var dr=200;function zi(a,p){a.addEventListener("dblclick",p);var S=0,V;function ie(Ce){if(Ce.detail!==1){V=Ce.detail;return}if(!(Ce.pointerType==="mouse"||Ce.sourceCapabilities&&!Ce.sourceCapabilities.firesTouchEvents)){var st=Va(Ce);if(!(st.some(function(Ut){return Ut instanceof HTMLLabelElement&&Ut.attributes.for})&&!st.some(function(Ut){return Ut instanceof HTMLInputElement||Ut instanceof HTMLSelectElement}))){var Pt=Date.now();Pt-S<=dr?(V++,V===2&&p(Rr(Ce))):V=1,S=Pt}}}return a.addEventListener("click",ie),{dblclick:p,simDblclick:ie}}function Ss(a,p){a.removeEventListener("dblclick",p.dblclick),a.removeEventListener("click",p.simDblclick)}var Cs=fo(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),si=fo(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),jn=si==="webkitTransition"||si==="OTransition"?si+"End":"transitionend";function Po(a){return typeof a=="string"?document.getElementById(a):a}function ci(a,p){var S=a.style[p]||a.currentStyle&&a.currentStyle[p];if((!S||S==="auto")&&document.defaultView){var V=document.defaultView.getComputedStyle(a,null);S=V?V[p]:null}return S==="auto"?null:S}function hr(a,p,S){var V=document.createElement(a);return V.className=p||"",S&&S.appendChild(V),V}function qn(a){var p=a.parentNode;p&&p.removeChild(a)}function bo(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function wo(a){var p=a.parentNode;p&&p.lastChild!==a&&p.appendChild(a)}function Lr(a){var p=a.parentNode;p&&p.firstChild!==a&&p.insertBefore(a,p.firstChild)}function Us(a,p){if(a.classList!==void 0)return a.classList.contains(p);var S=_n(a);return S.length>0&&new RegExp("(^|\\s)"+p+"(\\s|$)").test(S)}function Gn(a,p){if(a.classList!==void 0)for(var S=M(p),V=0,ie=S.length;V<ie;V++)a.classList.add(S[V]);else if(!Us(a,p)){var Ce=_n(a);Yr(a,(Ce?Ce+" ":"")+p)}}function _r(a,p){a.classList!==void 0?a.classList.remove(p):Yr(a,_((" "+_n(a)+" ").replace(" "+p+" "," ")))}function Yr(a,p){a.className.baseVal===void 0?a.className=p:a.className.baseVal=p}function _n(a){return a.correspondingElement&&(a=a.correspondingElement),a.className.baseVal===void 0?a.className:a.className.baseVal}function tn(a,p){"opacity"in a.style?a.style.opacity=p:"filter"in a.style&&ai(a,p)}function ai(a,p){var S=!1,V="DXImageTransform.Microsoft.Alpha";try{S=a.filters.item(V)}catch{if(p===1)return}p=Math.round(p*100),S?(S.Enabled=p!==100,S.Opacity=p):a.style.filter+=" progid:"+V+"(opacity="+p+")"}function fo(a){for(var p=document.documentElement.style,S=0;S<a.length;S++)if(a[S]in p)return a[S];return!1}function xo(a,p,S){var V=p||new Y(0,0);a.style[Cs]=(lt.ie3d?"translate("+V.x+"px,"+V.y+"px)":"translate3d("+V.x+"px,"+V.y+"px,0)")+(S?" scale("+S+")":"")}function Mi(a,p){a._leaflet_pos=p,lt.any3d?xo(a,p):(a.style.left=p.x+"px",a.style.top=p.y+"px")}function fs(a){return a._leaflet_pos||new Y(0,0)}var Qo,Ro,di;if("onselectstart"in document)Qo=function(){br(window,"selectstart",Sr)},Ro=function(){Nr(window,"selectstart",Sr)};else{var Is=fo(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Qo=function(){if(Is){var a=document.documentElement.style;di=a[Is],a[Is]="none"}},Ro=function(){Is&&(document.documentElement.style[Is]=di,di=void 0)}}function Fo(){br(window,"dragstart",Sr)}function eo(){Nr(window,"dragstart",Sr)}var Lo,Vs;function va(a){for(;a.tabIndex===-1;)a=a.parentNode;a.style&&(to(),Lo=a,Vs=a.style.outlineStyle,a.style.outlineStyle="none",br(window,"keydown",to))}function to(){Lo&&(Lo.style.outlineStyle=Vs,Lo=void 0,Vs=void 0,Nr(window,"keydown",to))}function il(a){do a=a.parentNode;while((!a.offsetWidth||!a.offsetHeight)&&a!==document.body);return a}function ya(a){var p=a.getBoundingClientRect();return{x:p.width/a.offsetWidth||1,y:p.height/a.offsetHeight||1,boundingClientRect:p}}var gr={__proto__:null,TRANSFORM:Cs,TRANSITION:si,TRANSITION_END:jn,get:Po,getStyle:ci,create:hr,remove:qn,empty:bo,toFront:wo,toBack:Lr,hasClass:Us,addClass:Gn,removeClass:_r,setClass:Yr,getClass:_n,setOpacity:tn,testProp:fo,setTransform:xo,setPosition:Mi,getPosition:fs,get disableTextSelection(){return Qo},get enableTextSelection(){return Ro},disableImageDrag:Fo,enableImageDrag:eo,preventOutline:va,restoreOutline:to,getSizedParentNode:il,getScale:ya};function br(a,p,S,V){if(p&&typeof p=="object")for(var ie in p)sl(a,ie,p[ie],S);else{p=M(p);for(var Ce=0,st=p.length;Ce<st;Ce++)sl(a,p[Ce],S,V)}return this}var Jr="_leaflet_events";function Nr(a,p,S,V){if(arguments.length===1)jo(a),delete a[Jr];else if(p&&typeof p=="object")for(var ie in p)Gs(a,ie,p[ie],S);else if(p=M(p),arguments.length===2)jo(a,function(Pt){return te(p,Pt)!==-1});else for(var Ce=0,st=p.length;Ce<st;Ce++)Gs(a,p[Ce],S,V);return this}function jo(a,p){for(var S in a[Jr]){var V=S.split(/\d/)[0];(!p||p(V))&&Gs(a,V,null,null,S)}}var ol={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function sl(a,p,S,V){var ie=p+f(S)+(V?"_"+f(V):"");if(a[Jr]&&a[Jr][ie])return this;var Ce=function(Pt){return S.call(V||a,Pt||window.event)},st=Ce;!lt.touchNative&&lt.pointer&&p.indexOf("touch")===0?Ce=Or(a,p,Ce):lt.touch&&p==="dblclick"?Ce=zi(a,Ce):"addEventListener"in a?p==="touchstart"||p==="touchmove"||p==="wheel"||p==="mousewheel"?a.addEventListener(ol[p]||p,Ce,lt.passiveEvents?{passive:!1}:!1):p==="mouseenter"||p==="mouseleave"?(Ce=function(Pt){Pt=Pt||window.event,al(a,Pt)&&st(Pt)},a.addEventListener(ol[p],Ce,!1)):a.addEventListener(p,st,!1):a.attachEvent("on"+p,Ce),a[Jr]=a[Jr]||{},a[Jr][ie]=Ce}function Gs(a,p,S,V,ie){ie=ie||p+f(S)+(V?"_"+f(V):"");var Ce=a[Jr]&&a[Jr][ie];if(!Ce)return this;!lt.touchNative&&lt.pointer&&p.indexOf("touch")===0?jr(a,p,Ce):lt.touch&&p==="dblclick"?Ss(a,Ce):"removeEventListener"in a?a.removeEventListener(ol[p]||p,Ce,!1):a.detachEvent("on"+p,Ce),a[Jr][ie]=null}function Ua(a){return a.stopPropagation?a.stopPropagation():a.originalEvent?a.originalEvent._stopped=!0:a.cancelBubble=!0,this}function bu(a){return sl(a,"wheel",Ua),this}function Ml(a){return br(a,"mousedown touchstart dblclick contextmenu",Ua),a._leaflet_disable_click=!0,this}function Sr(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this}function qr(a){return Sr(a),Ua(a),this}function Va(a){if(a.composedPath)return a.composedPath();for(var p=[],S=a.target;S;)p.push(S),S=S.parentNode;return p}function Ku(a,p){if(!p)return new Y(a.clientX,a.clientY);var S=ya(p),V=S.boundingClientRect;return new Y((a.clientX-V.left)/S.x-p.clientLeft,(a.clientY-V.top)/S.y-p.clientTop)}var Al=lt.linux&&lt.chrome?window.devicePixelRatio:lt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Jl(a){return lt.edge?a.wheelDeltaY/2:a.deltaY&&a.deltaMode===0?-a.deltaY/Al:a.deltaY&&a.deltaMode===1?-a.deltaY*20:a.deltaY&&a.deltaMode===2?-a.deltaY*60:a.deltaX||a.deltaZ?0:a.wheelDelta?(a.wheelDeltaY||a.wheelDelta)/2:a.detail&&Math.abs(a.detail)<32765?-a.detail*20:a.detail?a.detail/-32765*60:0}function al(a,p){var S=p.relatedTarget;if(!S)return!0;try{for(;S&&S!==a;)S=S.parentNode}catch{return!1}return S!==a}var kl={__proto__:null,on:br,off:Nr,stopPropagation:Ua,disableScrollPropagation:bu,disableClickPropagation:Ml,preventDefault:Sr,stop:qr,getPropagationPath:Va,getMousePosition:Ku,getWheelDelta:Jl,isExternalTarget:al,addListener:br,removeListener:Nr},Xl=J.extend({run:function(a,p,S,V){this.stop(),this._el=a,this._inProgress=!0,this._duration=S||.25,this._easeOutPower=1/Math.max(V||.5,.2),this._startPos=fs(a),this._offset=p.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=F(this._animate,this),this._step()},_step:function(a){var p=+new Date-this._startTime,S=this._duration*1e3;p<S?this._runFrame(this._easeOut(p/S),a):(this._runFrame(1),this._complete())},_runFrame:function(a,p){var S=this._startPos.add(this._offset.multiplyBy(a));p&&S._round(),Mi(this._el,S),this.fire("step")},_complete:function(){B(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}}),Xr=J.extend({options:{crs:K,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(a,p){p=T(this,p),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(a),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),p.maxBounds&&this.setMaxBounds(p.maxBounds),p.zoom!==void 0&&(this._zoom=this._limitZoom(p.zoom)),p.center&&p.zoom!==void 0&&this.setView(_e(p.center),p.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=si&&lt.any3d&&!lt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),br(this._proxy,jn,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(a,p,S){if(p=p===void 0?this._zoom:this._limitZoom(p),a=this._limitCenter(_e(a),p,this.options.maxBounds),S=S||{},this._stop(),this._loaded&&!S.reset&&S!==!0){S.animate!==void 0&&(S.zoom=i({animate:S.animate},S.zoom),S.pan=i({animate:S.animate,duration:S.duration},S.pan));var V=this._zoom!==p?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,p,S.zoom):this._tryAnimatedPan(a,S.pan);if(V)return clearTimeout(this._sizeTimer),this}return this._resetView(a,p,S.pan&&S.pan.noMoveStart),this},setZoom:function(a,p){return this._loaded?this.setView(this.getCenter(),a,{zoom:p}):(this._zoom=a,this)},zoomIn:function(a,p){return a=a||(lt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+a,p)},zoomOut:function(a,p){return a=a||(lt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-a,p)},setZoomAround:function(a,p,S){var V=this.getZoomScale(p),ie=this.getSize().divideBy(2),Ce=a instanceof Y?a:this.latLngToContainerPoint(a),st=Ce.subtract(ie).multiplyBy(1-1/V),Pt=this.containerPointToLatLng(ie.add(st));return this.setView(Pt,p,{zoom:S})},_getBoundsCenterZoom:function(a,p){p=p||{},a=a.getBounds?a.getBounds():fe(a);var S=Le(p.paddingTopLeft||p.padding||[0,0]),V=Le(p.paddingBottomRight||p.padding||[0,0]),ie=this.getBoundsZoom(a,!1,S.add(V));if(ie=typeof p.maxZoom=="number"?Math.min(p.maxZoom,ie):ie,ie===1/0)return{center:a.getCenter(),zoom:ie};var Ce=V.subtract(S).divideBy(2),st=this.project(a.getSouthWest(),ie),Pt=this.project(a.getNorthEast(),ie),Ut=this.unproject(st.add(Pt).divideBy(2).add(Ce),ie);return{center:Ut,zoom:ie}},fitBounds:function(a,p){if(a=fe(a),!a.isValid())throw new Error("Bounds are not valid.");var S=this._getBoundsCenterZoom(a,p);return this.setView(S.center,S.zoom,p)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,p){return this.setView(a,this._zoom,{pan:p})},panBy:function(a,p){if(a=Le(a).round(),p=p||{},!a.x&&!a.y)return this.fire("moveend");if(p.animate!==!0&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Xl,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),p.noMoveStart||this.fire("movestart"),p.animate!==!1){Gn(this._mapPane,"leaflet-pan-anim");var S=this._getMapPanePos().subtract(a).round();this._panAnim.run(this._mapPane,S,p.duration||.25,p.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},flyTo:function(a,p,S){if(S=S||{},S.animate===!1||!lt.any3d)return this.setView(a,p,S);this._stop();var V=this.project(this.getCenter()),ie=this.project(a),Ce=this.getSize(),st=this._zoom;a=_e(a),p=p===void 0?st:p;var Pt=Math.max(Ce.x,Ce.y),Ut=Pt*this.getZoomScale(st,p),an=ie.distanceTo(V)||1,Dn=1.42,Xn=Dn*Dn;function zr(mi){var Wo=mi?-1:1,Ne=mi?Ut:Pt,ms=Ut*Ut-Pt*Pt+Wo*Xn*Xn*an*an,Lu=2*Ne*Xn*an,Io=ms/Lu,Gr=Math.sqrt(Io*Io+1)-Io,Wc=Gr<1e-9?-18:Math.log(Gr);return Wc}function mo(mi){return(Math.exp(mi)-Math.exp(-mi))/2}function Ji(mi){return(Math.exp(mi)+Math.exp(-mi))/2}function Do(mi){return mo(mi)/Ji(mi)}var Hi=zr(0);function gs(mi){return Pt*(Ji(Hi)/Ji(Hi+Dn*mi))}function wc(mi){return Pt*(Ji(Hi)*Do(Hi+Dn*mi)-mo(Hi))/Xn}function ca(mi){return 1-Math.pow(1-mi,1.5)}var Ys=Date.now(),Rs=(zr(1)-Hi)/Dn,kf=S.duration?1e3*S.duration:1e3*Rs*.8;function tu(){var mi=(Date.now()-Ys)/kf,Wo=ca(mi)*Rs;mi<=1?(this._flyToFrame=F(tu,this),this._move(this.unproject(V.add(ie.subtract(V).multiplyBy(wc(Wo)/an)),st),this.getScaleZoom(Pt/gs(Wo),st),{flyTo:!0})):this._move(a,p)._moveEnd(!0)}return this._moveStart(!0,S.noMoveStart),tu.call(this),this},flyToBounds:function(a,p){var S=this._getBoundsCenterZoom(a,p);return this.flyTo(S.center,S.zoom,p)},setMaxBounds:function(a){return a=fe(a),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),a.isValid()?(this.options.maxBounds=a,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(a){var p=this.options.minZoom;return this.options.minZoom=a,this._loaded&&p!==a&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(a):this},setMaxZoom:function(a){var p=this.options.maxZoom;return this.options.maxZoom=a,this._loaded&&p!==a&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(a):this},panInsideBounds:function(a,p){this._enforcingBounds=!0;var S=this.getCenter(),V=this._limitCenter(S,this._zoom,fe(a));return S.equals(V)||this.panTo(V,p),this._enforcingBounds=!1,this},panInside:function(a,p){p=p||{};var S=Le(p.paddingTopLeft||p.padding||[0,0]),V=Le(p.paddingBottomRight||p.padding||[0,0]),ie=this.project(this.getCenter()),Ce=this.project(a),st=this.getPixelBounds(),Pt=N([st.min.add(S),st.max.subtract(V)]),Ut=Pt.getSize();if(!Pt.contains(Ce)){this._enforcingBounds=!0;var an=Ce.subtract(Pt.getCenter()),Dn=Pt.extend(Ce).getSize().subtract(Ut);ie.x+=an.x<0?-Dn.x:Dn.x,ie.y+=an.y<0?-Dn.y:Dn.y,this.panTo(this.unproject(ie),p),this._enforcingBounds=!1}return this},invalidateSize:function(a){if(!this._loaded)return this;a=i({animate:!1,pan:!0},a===!0?{animate:!0}:a);var p=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var S=this.getSize(),V=p.divideBy(2).round(),ie=S.divideBy(2).round(),Ce=V.subtract(ie);return!Ce.x&&!Ce.y?this:(a.animate&&a.pan?this.panBy(Ce):(a.pan&&this._rawPanBy(Ce),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:p,newSize:S}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(a){if(a=this._locateOptions=i({timeout:1e4,watch:!1},a),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var p=o(this._handleGeolocationResponse,this),S=o(this._handleGeolocationError,this);return a.watch?this._locationWatchId=navigator.geolocation.watchPosition(p,S,a):navigator.geolocation.getCurrentPosition(p,S,a),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(a){if(this._container._leaflet_id){var p=a.code,S=a.message||(p===1?"permission denied":p===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:p,message:"Geolocation error: "+S+"."})}},_handleGeolocationResponse:function(a){if(this._container._leaflet_id){var p=a.coords.latitude,S=a.coords.longitude,V=new ce(p,S),ie=V.toBounds(a.coords.accuracy*2),Ce=this._locateOptions;if(Ce.setView){var st=this.getBoundsZoom(ie);this.setView(V,Ce.maxZoom?Math.min(st,Ce.maxZoom):st)}var Pt={latlng:V,bounds:ie,timestamp:a.timestamp};for(var Ut in a.coords)typeof a.coords[Ut]=="number"&&(Pt[Ut]=a.coords[Ut]);this.fire("locationfound",Pt)}},addHandler:function(a,p){if(!p)return this;var S=this[a]=new p(this);return this._handlers.push(S),this.options[a]&&S.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),qn(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(B(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var a;for(a in this._layers)this._layers[a].remove();for(a in this._panes)qn(this._panes[a]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(a,p){var S="leaflet-pane"+(a?" leaflet-"+a.replace("Pane","")+"-pane":""),V=hr("div",S,p||this._mapPane);return a&&(this._panes[a]=V),V},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),p=this.unproject(a.getBottomLeft()),S=this.unproject(a.getTopRight());return new ee(p,S)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,p,S){a=fe(a),S=Le(S||[0,0]);var V=this.getZoom()||0,ie=this.getMinZoom(),Ce=this.getMaxZoom(),st=a.getNorthWest(),Pt=a.getSouthEast(),Ut=this.getSize().subtract(S),an=N(this.project(Pt,V),this.project(st,V)).getSize(),Dn=lt.any3d?this.options.zoomSnap:1,Xn=Ut.x/an.x,zr=Ut.y/an.y,mo=p?Math.max(Xn,zr):Math.min(Xn,zr);return V=this.getScaleZoom(mo,V),Dn&&(V=Math.round(V/(Dn/100))*(Dn/100),V=p?Math.ceil(V/Dn)*Dn:Math.floor(V/Dn)*Dn),Math.max(ie,Math.min(Ce,V))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Y(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(a,p){var S=this._getTopLeftPoint(a,p);return new De(S,S.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(a){return this.options.crs.getProjectedBounds(a===void 0?this.getZoom():a)},getPane:function(a){return typeof a=="string"?this._panes[a]:a},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a,p){var S=this.options.crs;return p=p===void 0?this._zoom:p,S.scale(a)/S.scale(p)},getScaleZoom:function(a,p){var S=this.options.crs;p=p===void 0?this._zoom:p;var V=S.zoom(a*S.scale(p));return isNaN(V)?1/0:V},project:function(a,p){return p=p===void 0?this._zoom:p,this.options.crs.latLngToPoint(_e(a),p)},unproject:function(a,p){return p=p===void 0?this._zoom:p,this.options.crs.pointToLatLng(Le(a),p)},layerPointToLatLng:function(a){var p=Le(a).add(this.getPixelOrigin());return this.unproject(p)},latLngToLayerPoint:function(a){var p=this.project(_e(a))._round();return p._subtract(this.getPixelOrigin())},wrapLatLng:function(a){return this.options.crs.wrapLatLng(_e(a))},wrapLatLngBounds:function(a){return this.options.crs.wrapLatLngBounds(fe(a))},distance:function(a,p){return this.options.crs.distance(_e(a),_e(p))},containerPointToLayerPoint:function(a){return Le(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return Le(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){var p=this.containerPointToLayerPoint(Le(a));return this.layerPointToLatLng(p)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(_e(a)))},mouseEventToContainerPoint:function(a){return Ku(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){var p=this._container=Po(a);if(p){if(p._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");br(p,"scroll",this._onScroll,this),this._containerId=f(p)},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&lt.any3d,Gn(a,"leaflet-container"+(lt.touch?" leaflet-touch":"")+(lt.retina?" leaflet-retina":"")+(lt.ielt9?" leaflet-oldie":"")+(lt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var p=ci(a,"position");p!=="absolute"&&p!=="relative"&&p!=="fixed"&&p!=="sticky"&&(a.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Mi(this._mapPane,new Y(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Gn(a.markerPane,"leaflet-zoom-hide"),Gn(a.shadowPane,"leaflet-zoom-hide"))},_resetView:function(a,p,S){Mi(this._mapPane,new Y(0,0));var V=!this._loaded;this._loaded=!0,p=this._limitZoom(p),this.fire("viewprereset");var ie=this._zoom!==p;this._moveStart(ie,S)._move(a,p)._moveEnd(ie),this.fire("viewreset"),V&&this.fire("load")},_moveStart:function(a,p){return a&&this.fire("zoomstart"),p||this.fire("movestart"),this},_move:function(a,p,S,V){p===void 0&&(p=this._zoom);var ie=this._zoom!==p;return this._zoom=p,this._lastCenter=a,this._pixelOrigin=this._getNewPixelOrigin(a),V?S&&S.pinch&&this.fire("zoom",S):((ie||S&&S.pinch)&&this.fire("zoom",S),this.fire("move",S)),this},_moveEnd:function(a){return a&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return B(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(a){Mi(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(a){this._targets={},this._targets[f(this._container)]=this;var p=a?Nr:br;p(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&p(window,"resize",this._onResize,this),lt.any3d&&this.options.transform3DLimit&&(a?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){B(this._resizeRequest),this._resizeRequest=F(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var a=this._getMapPanePos();Math.max(Math.abs(a.x),Math.abs(a.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(a,p){for(var S=[],V,ie=p==="mouseout"||p==="mouseover",Ce=a.target||a.srcElement,st=!1;Ce;){if(V=this._targets[f(Ce)],V&&(p==="click"||p==="preclick")&&this._draggableMoved(V)){st=!0;break}if(V&&V.listens(p,!0)&&(ie&&!al(Ce,a)||(S.push(V),ie))||Ce===this._container)break;Ce=Ce.parentNode}return!S.length&&!st&&!ie&&this.listens(p,!0)&&(S=[this]),S},_isClickDisabled:function(a){for(;a&&a!==this._container;){if(a._leaflet_disable_click)return!0;a=a.parentNode}},_handleDOMEvent:function(a){var p=a.target||a.srcElement;if(!(!this._loaded||p._leaflet_disable_events||a.type==="click"&&this._isClickDisabled(p))){var S=a.type;S==="mousedown"&&va(p),this._fireDOMEvent(a,S)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(a,p,S){if(a.type==="click"){var V=i({},a);V.type="preclick",this._fireDOMEvent(V,V.type,S)}var ie=this._findEventTargets(a,p);if(S){for(var Ce=[],st=0;st<S.length;st++)S[st].listens(p,!0)&&Ce.push(S[st]);ie=Ce.concat(ie)}if(ie.length){p==="contextmenu"&&Sr(a);var Pt=ie[0],Ut={originalEvent:a};if(a.type!=="keypress"&&a.type!=="keydown"&&a.type!=="keyup"){var an=Pt.getLatLng&&(!Pt._radius||Pt._radius<=10);Ut.containerPoint=an?this.latLngToContainerPoint(Pt.getLatLng()):this.mouseEventToContainerPoint(a),Ut.layerPoint=this.containerPointToLayerPoint(Ut.containerPoint),Ut.latlng=an?Pt.getLatLng():this.layerPointToLatLng(Ut.layerPoint)}for(st=0;st<ie.length;st++)if(ie[st].fire(p,Ut,!0),Ut.originalEvent._stopped||ie[st].options.bubblingMouseEvents===!1&&te(this._mouseEvents,p)!==-1)return}},_draggableMoved:function(a){return a=a.dragging&&a.dragging.enabled()?a:this,a.dragging&&a.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var a=0,p=this._handlers.length;a<p;a++)this._handlers[a].disable()},whenReady:function(a,p){return this._loaded?a.call(p||this,{target:this}):this.on("load",a,p),this},_getMapPanePos:function(){return fs(this._mapPane)||new Y(0,0)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(a,p){var S=a&&p!==void 0?this._getNewPixelOrigin(a,p):this.getPixelOrigin();return S.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(a,p){var S=this.getSize()._divideBy(2);return this.project(a,p)._subtract(S)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(a,p,S){var V=this._getNewPixelOrigin(S,p);return this.project(a,p)._subtract(V)},_latLngBoundsToNewLayerBounds:function(a,p,S){var V=this._getNewPixelOrigin(S,p);return N([this.project(a.getSouthWest(),p)._subtract(V),this.project(a.getNorthWest(),p)._subtract(V),this.project(a.getSouthEast(),p)._subtract(V),this.project(a.getNorthEast(),p)._subtract(V)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,p,S){if(!S)return a;var V=this.project(a,p),ie=this.getSize().divideBy(2),Ce=new De(V.subtract(ie),V.add(ie)),st=this._getBoundsOffset(Ce,S,p);return Math.abs(st.x)<=1&&Math.abs(st.y)<=1?a:this.unproject(V.add(st),p)},_limitOffset:function(a,p){if(!p)return a;var S=this.getPixelBounds(),V=new De(S.min.add(a),S.max.add(a));return a.add(this._getBoundsOffset(V,p))},_getBoundsOffset:function(a,p,S){var V=N(this.project(p.getNorthEast(),S),this.project(p.getSouthWest(),S)),ie=V.min.subtract(a.min),Ce=V.max.subtract(a.max),st=this._rebound(ie.x,-Ce.x),Pt=this._rebound(ie.y,-Ce.y);return new Y(st,Pt)},_rebound:function(a,p){return a+p>0?Math.round(a-p)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(p))},_limitZoom:function(a){var p=this.getMinZoom(),S=this.getMaxZoom(),V=lt.any3d?this.options.zoomSnap:1;return V&&(a=Math.round(a/V)*V),Math.max(p,Math.min(S,a))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){_r(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(a,p){var S=this._getCenterOffset(a)._trunc();return(p&&p.animate)!==!0&&!this.getSize().contains(S)?!1:(this.panBy(S,p),!0)},_createAnimProxy:function(){var a=this._proxy=hr("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(a),this.on("zoomanim",function(p){var S=Cs,V=this._proxy.style[S];xo(this._proxy,this.project(p.center,p.zoom),this.getZoomScale(p.zoom,1)),V===this._proxy.style[S]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){qn(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var a=this.getCenter(),p=this.getZoom();xo(this._proxy,this.project(a,p),this.getZoomScale(p,1))},_catchTransitionEnd:function(a){this._animatingZoom&&a.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(a,p,S){if(this._animatingZoom)return!0;if(S=S||{},!this._zoomAnimated||S.animate===!1||this._nothingToAnimate()||Math.abs(p-this._zoom)>this.options.zoomAnimationThreshold)return!1;var V=this.getZoomScale(p),ie=this._getCenterOffset(a)._divideBy(1-1/V);return S.animate!==!0&&!this.getSize().contains(ie)?!1:(F(function(){this._moveStart(!0,S.noMoveStart||!1)._animateZoom(a,p,!0)},this),!0)},_animateZoom:function(a,p,S,V){this._mapPane&&(S&&(this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=p,Gn(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:a,zoom:p,noUpdate:V}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&_r(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function no(a,p){return new Xr(a,p)}var or=$.extend({options:{position:"topright"},initialize:function(a){T(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var p=this._map;return p&&p.removeControl(this),this.options.position=a,p&&p.addControl(this),this},getContainer:function(){return this._container},addTo:function(a){this.remove(),this._map=a;var p=this._container=this.onAdd(a),S=this.getPosition(),V=a._controlCorners[S];return Gn(p,"leaflet-control"),S.indexOf("bottom")!==-1?V.insertBefore(p,V.firstChild):V.appendChild(p),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(qn(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(a){this._map&&a&&a.screenX>0&&a.screenY>0&&this._map.getContainer().focus()}}),ro=function(a){return new or(a)};Xr.include({addControl:function(a){return a.addTo(this),this},removeControl:function(a){return a.remove(),this},_initControlPos:function(){var a=this._controlCorners={},p="leaflet-",S=this._controlContainer=hr("div",p+"control-container",this._container);function V(ie,Ce){var st=p+ie+" "+p+Ce;a[ie+Ce]=hr("div",st,S)}V("top","left"),V("top","right"),V("bottom","left"),V("bottom","right")},_clearControlPos:function(){for(var a in this._controlCorners)qn(this._controlCorners[a]);qn(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var ll=or.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(a,p,S,V){return S<V?-1:V<S?1:0}},initialize:function(a,p,S){T(this,S),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var V in a)this._addLayer(a[V],V);for(V in p)this._addLayer(p[V],V,!0)},onAdd:function(a){this._initLayout(),this._update(),this._map=a,a.on("zoomend",this._checkDisabledLayers,this);for(var p=0;p<this._layers.length;p++)this._layers[p].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(a){return or.prototype.addTo.call(this,a),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(a,p){return this._addLayer(a,p),this._map?this._update():this},addOverlay:function(a,p){return this._addLayer(a,p,!0),this._map?this._update():this},removeLayer:function(a){a.off("add remove",this._onLayerChange,this);var p=this._getLayer(f(a));return p&&this._layers.splice(this._layers.indexOf(p),1),this._map?this._update():this},expand:function(){Gn(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var a=this._map.getSize().y-(this._container.offsetTop+50);return a<this._section.clientHeight?(Gn(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=a+"px"):_r(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return _r(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var a="leaflet-control-layers",p=this._container=hr("div",a),S=this.options.collapsed;p.setAttribute("aria-haspopup",!0),Ml(p),bu(p);var V=this._section=hr("section",a+"-list");S&&(this._map.on("click",this.collapse,this),br(p,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var ie=this._layersLink=hr("a",a+"-toggle",p);ie.href="#",ie.title="Layers",ie.setAttribute("role","button"),br(ie,{keydown:function(Ce){Ce.keyCode===13&&this._expandSafely()},click:function(Ce){Sr(Ce),this._expandSafely()}},this),S||this.expand(),this._baseLayersList=hr("div",a+"-base",V),this._separator=hr("div",a+"-separator",V),this._overlaysList=hr("div",a+"-overlays",V),p.appendChild(V)},_getLayer:function(a){for(var p=0;p<this._layers.length;p++)if(this._layers[p]&&f(this._layers[p].layer)===a)return this._layers[p]},_addLayer:function(a,p,S){this._map&&a.on("add remove",this._onLayerChange,this),this._layers.push({layer:a,name:p,overlay:S}),this.options.sortLayers&&this._layers.sort(o(function(V,ie){return this.options.sortFunction(V.layer,ie.layer,V.name,ie.name)},this)),this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;bo(this._baseLayersList),bo(this._overlaysList),this._layerControlInputs=[];var a,p,S,V,ie=0;for(S=0;S<this._layers.length;S++)V=this._layers[S],this._addItem(V),p=p||V.overlay,a=a||!V.overlay,ie+=V.overlay?0:1;return this.options.hideSingleBase&&(a=a&&ie>1,this._baseLayersList.style.display=a?"":"none"),this._separator.style.display=p&&a?"":"none",this},_onLayerChange:function(a){this._handlingClick||this._update();var p=this._getLayer(f(a.target)),S=p.overlay?a.type==="add"?"overlayadd":"overlayremove":a.type==="add"?"baselayerchange":null;S&&this._map.fire(S,p)},_createRadioElement:function(a,p){var S='<input type="radio" class="leaflet-control-layers-selector" name="'+a+'"'+(p?' checked="checked"':"")+"/>",V=document.createElement("div");return V.innerHTML=S,V.firstChild},_addItem:function(a){var p=document.createElement("label"),S=this._map.hasLayer(a.layer),V;a.overlay?(V=document.createElement("input"),V.type="checkbox",V.className="leaflet-control-layers-selector",V.defaultChecked=S):V=this._createRadioElement("leaflet-base-layers_"+f(this),S),this._layerControlInputs.push(V),V.layerId=f(a.layer),br(V,"click",this._onInputClick,this);var ie=document.createElement("span");ie.innerHTML=" "+a.name;var Ce=document.createElement("span");p.appendChild(Ce),Ce.appendChild(V),Ce.appendChild(ie);var st=a.overlay?this._overlaysList:this._baseLayersList;return st.appendChild(p),this._checkDisabledLayers(),p},_onInputClick:function(){if(!this._preventClick){var a=this._layerControlInputs,p,S,V=[],ie=[];this._handlingClick=!0;for(var Ce=a.length-1;Ce>=0;Ce--)p=a[Ce],S=this._getLayer(p.layerId).layer,p.checked?V.push(S):p.checked||ie.push(S);for(Ce=0;Ce<ie.length;Ce++)this._map.hasLayer(ie[Ce])&&this._map.removeLayer(ie[Ce]);for(Ce=0;Ce<V.length;Ce++)this._map.hasLayer(V[Ce])||this._map.addLayer(V[Ce]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var a=this._layerControlInputs,p,S,V=this._map.getZoom(),ie=a.length-1;ie>=0;ie--)p=a[ie],S=this._getLayer(p.layerId).layer,p.disabled=S.options.minZoom!==void 0&&V<S.options.minZoom||S.options.maxZoom!==void 0&&V>S.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var a=this._section;this._preventClick=!0,br(a,"click",Sr),this.expand();var p=this;setTimeout(function(){Nr(a,"click",Sr),p._preventClick=!1})}}),_a=function(a,p,S){return new ll(a,p,S)},Ui=or.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(a){var p="leaflet-control-zoom",S=hr("div",p+" leaflet-bar"),V=this.options;return this._zoomInButton=this._createButton(V.zoomInText,V.zoomInTitle,p+"-in",S,this._zoomIn),this._zoomOutButton=this._createButton(V.zoomOutText,V.zoomOutTitle,p+"-out",S,this._zoomOut),this._updateDisabled(),a.on("zoomend zoomlevelschange",this._updateDisabled,this),S},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(a){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(a.shiftKey?3:1))},_zoomOut:function(a){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(a.shiftKey?3:1))},_createButton:function(a,p,S,V,ie){var Ce=hr("a",S,V);return Ce.innerHTML=a,Ce.href="#",Ce.title=p,Ce.setAttribute("role","button"),Ce.setAttribute("aria-label",p),Ml(Ce),br(Ce,"click",qr),br(Ce,"click",ie,this),br(Ce,"click",this._refocusOnMap,this),Ce},_updateDisabled:function(){var a=this._map,p="leaflet-disabled";_r(this._zoomInButton,p),_r(this._zoomOutButton,p),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||a._zoom===a.getMinZoom())&&(Gn(this._zoomOutButton,p),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||a._zoom===a.getMaxZoom())&&(Gn(this._zoomInButton,p),this._zoomInButton.setAttribute("aria-disabled","true"))}});Xr.mergeOptions({zoomControl:!0}),Xr.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Ui,this.addControl(this.zoomControl))});var Ql=function(a){return new Ui(a)},ta=or.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(a){var p="leaflet-control-scale",S=hr("div",p),V=this.options;return this._addScales(V,p+"-line",S),a.on(V.updateWhenIdle?"moveend":"move",this._update,this),a.whenReady(this._update,this),S},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,p,S){a.metric&&(this._mScale=hr("div",p,S)),a.imperial&&(this._iScale=hr("div",p,S))},_update:function(){var a=this._map,p=a.getSize().y/2,S=a.distance(a.containerPointToLatLng([0,p]),a.containerPointToLatLng([this.options.maxWidth,p]));this._updateScales(S)},_updateScales:function(a){this.options.metric&&a&&this._updateMetric(a),this.options.imperial&&a&&this._updateImperial(a)},_updateMetric:function(a){var p=this._getRoundNum(a),S=p<1e3?p+" m":p/1e3+" km";this._updateScale(this._mScale,S,p/a)},_updateImperial:function(a){var p=a*3.2808399,S,V,ie;p>5280?(S=p/5280,V=this._getRoundNum(S),this._updateScale(this._iScale,V+" mi",V/S)):(ie=this._getRoundNum(p),this._updateScale(this._iScale,ie+" ft",ie/p))},_updateScale:function(a,p,S){a.style.width=Math.round(this.options.maxWidth*S)+"px",a.innerHTML=p},_getRoundNum:function(a){var p=Math.pow(10,(Math.floor(a)+"").length-1),S=a/p;return S=S>=10?10:S>=5?5:S>=3?3:S>=2?2:1,p*S}}),Tl=function(a){return new ta(a)},Nl='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Os=or.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(lt.inlineSvg?Nl+" ":"")+"Leaflet</a>"},initialize:function(a){T(this,a),this._attributions={}},onAdd:function(a){a.attributionControl=this,this._container=hr("div","leaflet-control-attribution"),Ml(this._container);for(var p in a._layers)a._layers[p].getAttribution&&this.addAttribution(a._layers[p].getAttribution());return this._update(),a.on("layeradd",this._addAttribution,this),this._container},onRemove:function(a){a.off("layeradd",this._addAttribution,this)},_addAttribution:function(a){a.layer.getAttribution&&(this.addAttribution(a.layer.getAttribution()),a.layer.once("remove",function(){this.removeAttribution(a.layer.getAttribution())},this))},setPrefix:function(a){return this.options.prefix=a,this._update(),this},addAttribution:function(a){return a?(this._attributions[a]||(this._attributions[a]=0),this._attributions[a]++,this._update(),this):this},removeAttribution:function(a){return a?(this._attributions[a]&&(this._attributions[a]--,this._update()),this):this},_update:function(){if(this._map){var a=[];for(var p in this._attributions)this._attributions[p]&&a.push(p);var S=[];this.options.prefix&&S.push(this.options.prefix),a.length&&S.push(a.join(", ")),this._container.innerHTML=S.join(' <span aria-hidden="true">|</span> ')}}});Xr.mergeOptions({attributionControl:!0}),Xr.addInitHook(function(){this.options.attributionControl&&new Os().addTo(this)});var Dl=function(a){return new Os(a)};or.Layers=ll,or.Zoom=Ui,or.Scale=ta,or.Attribution=Os,ro.layers=_a,ro.zoom=Ql,ro.scale=Tl,ro.attribution=Dl;var bi=$.extend({initialize:function(a){this._map=a},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});bi.addTo=function(a,p){return a.addHandler(p,this),this};var Yu={Events:G},Mo=lt.touch?"touchstart mousedown":"mousedown",Hs=J.extend({options:{clickTolerance:3},initialize:function(a,p,S,V){T(this,V),this._element=a,this._dragStartTarget=p||a,this._preventOutline=S},enable:function(){this._enabled||(br(this._dragStartTarget,Mo,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Hs._dragging===this&&this.finishDrag(!0),Nr(this._dragStartTarget,Mo,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(a){if(this._enabled&&(this._moved=!1,!Us(this._element,"leaflet-zoom-anim"))){if(a.touches&&a.touches.length!==1){Hs._dragging===this&&this.finishDrag();return}if(!(Hs._dragging||a.shiftKey||a.which!==1&&a.button!==1&&!a.touches)&&(Hs._dragging=this,this._preventOutline&&va(this._element),Fo(),Qo(),!this._moving)){this.fire("down");var p=a.touches?a.touches[0]:a,S=il(this._element);this._startPoint=new Y(p.clientX,p.clientY),this._startPos=fs(this._element),this._parentScale=ya(S);var V=a.type==="mousedown";br(document,V?"mousemove":"touchmove",this._onMove,this),br(document,V?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(a){if(this._enabled){if(a.touches&&a.touches.length>1){this._moved=!0;return}var p=a.touches&&a.touches.length===1?a.touches[0]:a,S=new Y(p.clientX,p.clientY)._subtract(this._startPoint);!S.x&&!S.y||Math.abs(S.x)+Math.abs(S.y)<this.options.clickTolerance||(S.x/=this._parentScale.x,S.y/=this._parentScale.y,Sr(a),this._moved||(this.fire("dragstart"),this._moved=!0,Gn(document.body,"leaflet-dragging"),this._lastTarget=a.target||a.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Gn(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(S),this._moving=!0,this._lastEvent=a,this._updatePosition())}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a),Mi(this._element,this._newPos),this.fire("drag",a)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(a){_r(document.body,"leaflet-dragging"),this._lastTarget&&(_r(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Nr(document,"mousemove touchmove",this._onMove,this),Nr(document,"mouseup touchend touchcancel",this._onUp,this),eo(),Ro();var p=this._moved&&this._moving;this._moving=!1,Hs._dragging=!1,p&&this.fire("dragend",{noInertia:a,distance:this._newPos.distanceTo(this._startPos)})}});function Il(a,p,S){var V,ie=[1,4,2,8],Ce,st,Pt,Ut,an,Dn,Xn,zr;for(Ce=0,Dn=a.length;Ce<Dn;Ce++)a[Ce]._code=$t(a[Ce],p);for(Pt=0;Pt<4;Pt++){for(Xn=ie[Pt],V=[],Ce=0,Dn=a.length,st=Dn-1;Ce<Dn;st=Ce++)Ut=a[Ce],an=a[st],Ut._code&Xn?an._code&Xn||(zr=xt(an,Ut,Xn,p,S),zr._code=$t(zr,p),V.push(zr)):(an._code&Xn&&(zr=xt(an,Ut,Xn,p,S),zr._code=$t(zr,p),V.push(zr)),V.push(Ut));a=V}return a}function qs(a,p){var S,V,ie,Ce,st,Pt,Ut,an,Dn;if(!a||a.length===0)throw new Error("latlngs not passed");zn(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var Xn=_e([0,0]),zr=fe(a),mo=zr.getNorthWest().distanceTo(zr.getSouthWest())*zr.getNorthEast().distanceTo(zr.getNorthWest());mo<1700&&(Xn=ul(a));var Ji=a.length,Do=[];for(S=0;S<Ji;S++){var Hi=_e(a[S]);Do.push(p.project(_e([Hi.lat-Xn.lat,Hi.lng-Xn.lng])))}for(Pt=Ut=an=0,S=0,V=Ji-1;S<Ji;V=S++)ie=Do[S],Ce=Do[V],st=ie.y*Ce.x-Ce.y*ie.x,Ut+=(ie.x+Ce.x)*st,an+=(ie.y+Ce.y)*st,Pt+=st*3;Pt===0?Dn=Do[0]:Dn=[Ut/Pt,an/Pt];var gs=p.unproject(Le(Dn));return _e([gs.lat+Xn.lat,gs.lng+Xn.lng])}function ul(a){for(var p=0,S=0,V=0,ie=0;ie<a.length;ie++){var Ce=_e(a[ie]);p+=Ce.lat,S+=Ce.lng,V++}return _e([p/V,S/V])}var cl={__proto__:null,clipPolygon:Il,polygonCenter:qs,centroid:ul};function wi(a,p){if(!p||!a.length)return a.slice();var S=p*p;return a=be(a,S),a=io(a,S),a}function Es(a,p,S){return Math.sqrt(Nn(a,p,S,!0))}function ba(a,p,S){return Nn(a,p,S)}function io(a,p){var S=a.length,V=typeof Uint8Array<"u"?Uint8Array:Array,ie=new V(S);ie[0]=ie[S-1]=1,O(a,ie,p,0,S-1);var Ce,st=[];for(Ce=0;Ce<S;Ce++)ie[Ce]&&st.push(a[Ce]);return st}function O(a,p,S,V,ie){var Ce=0,st,Pt,Ut;for(Pt=V+1;Pt<=ie-1;Pt++)Ut=Nn(a[Pt],a[V],a[ie],!0),Ut>Ce&&(st=Pt,Ce=Ut);Ce>S&&(p[st]=1,O(a,p,S,V,st),O(a,p,S,st,ie))}function be(a,p){for(var S=[a[0]],V=1,ie=0,Ce=a.length;V<Ce;V++)cn(a[V],a[ie])>p&&(S.push(a[V]),ie=V);return ie<Ce-1&&S.push(a[Ce-1]),S}var Ke;function ft(a,p,S,V,ie){var Ce=V?Ke:$t(a,S),st=$t(p,S),Pt,Ut,an;for(Ke=st;;){if(!(Ce|st))return[a,p];if(Ce&st)return!1;Pt=Ce||st,Ut=xt(a,p,Pt,S,ie),an=$t(Ut,S),Pt===Ce?(a=Ut,Ce=an):(p=Ut,st=an)}}function xt(a,p,S,V,ie){var Ce=p.x-a.x,st=p.y-a.y,Pt=V.min,Ut=V.max,an,Dn;return S&8?(an=a.x+Ce*(Ut.y-a.y)/st,Dn=Ut.y):S&4?(an=a.x+Ce*(Pt.y-a.y)/st,Dn=Pt.y):S&2?(an=Ut.x,Dn=a.y+st*(Ut.x-a.x)/Ce):S&1&&(an=Pt.x,Dn=a.y+st*(Pt.x-a.x)/Ce),new Y(an,Dn,ie)}function $t(a,p){var S=0;return a.x<p.min.x?S|=1:a.x>p.max.x&&(S|=2),a.y<p.min.y?S|=4:a.y>p.max.y&&(S|=8),S}function cn(a,p){var S=p.x-a.x,V=p.y-a.y;return S*S+V*V}function Nn(a,p,S,V){var ie=p.x,Ce=p.y,st=S.x-ie,Pt=S.y-Ce,Ut=st*st+Pt*Pt,an;return Ut>0&&(an=((a.x-ie)*st+(a.y-Ce)*Pt)/Ut,an>1?(ie=S.x,Ce=S.y):an>0&&(ie+=st*an,Ce+=Pt*an)),st=a.x-ie,Pt=a.y-Ce,V?st*st+Pt*Pt:new Y(ie,Ce)}function zn(a){return!Z(a[0])||typeof a[0][0]!="object"&&typeof a[0][0]<"u"}function nr(a){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),zn(a)}function vr(a,p){var S,V,ie,Ce,st,Pt,Ut,an;if(!a||a.length===0)throw new Error("latlngs not passed");zn(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var Dn=_e([0,0]),Xn=fe(a),zr=Xn.getNorthWest().distanceTo(Xn.getSouthWest())*Xn.getNorthEast().distanceTo(Xn.getNorthWest());zr<1700&&(Dn=ul(a));var mo=a.length,Ji=[];for(S=0;S<mo;S++){var Do=_e(a[S]);Ji.push(p.project(_e([Do.lat-Dn.lat,Do.lng-Dn.lng])))}for(S=0,V=0;S<mo-1;S++)V+=Ji[S].distanceTo(Ji[S+1])/2;if(V===0)an=Ji[0];else for(S=0,Ce=0;S<mo-1;S++)if(st=Ji[S],Pt=Ji[S+1],ie=st.distanceTo(Pt),Ce+=ie,Ce>V){Ut=(Ce-V)/ie,an=[Pt.x-Ut*(Pt.x-st.x),Pt.y-Ut*(Pt.y-st.y)];break}var Hi=p.unproject(Le(an));return _e([Hi.lat+Dn.lat,Hi.lng+Dn.lng])}var Ur={__proto__:null,simplify:wi,pointToSegmentDistance:Es,closestPointOnSegment:ba,clipSegment:ft,_getEdgeIntersection:xt,_getBitCode:$t,_sqClosestPointOnSegment:Nn,isFlat:zn,_flat:nr,polylineCenter:vr},$i={project:function(a){return new Y(a.lng,a.lat)},unproject:function(a){return new ce(a.y,a.x)},bounds:new De([-180,-90],[180,90])},pi={R:6378137,R_MINOR:6356752314245179e-9,bounds:new De([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(a){var p=Math.PI/180,S=this.R,V=a.lat*p,ie=this.R_MINOR/S,Ce=Math.sqrt(1-ie*ie),st=Ce*Math.sin(V),Pt=Math.tan(Math.PI/4-V/2)/Math.pow((1-st)/(1+st),Ce/2);return V=-S*Math.log(Math.max(Pt,1e-10)),new Y(a.lng*p*S,V)},unproject:function(a){for(var p=180/Math.PI,S=this.R,V=this.R_MINOR/S,ie=Math.sqrt(1-V*V),Ce=Math.exp(-a.y/S),st=Math.PI/2-2*Math.atan(Ce),Pt=0,Ut=.1,an;Pt<15&&Math.abs(Ut)>1e-7;Pt++)an=ie*Math.sin(st),an=Math.pow((1-an)/(1+an),ie/2),Ut=Math.PI/2-2*Math.atan(Ce*an)-st,st+=Ut;return new ce(st*p,a.x*p/S)}},xi={__proto__:null,LonLat:$i,Mercator:pi,SphericalMercator:ke},oo=i({},k,{code:"EPSG:3395",projection:pi,transformation:function(){var a=.5/(Math.PI*pi.R);return Ge(a,.5,-a,.5)}()}),ho=i({},k,{code:"EPSG:4326",projection:$i,transformation:Ge(1/180,1,-1/180,.5)}),Ps=i({},se,{projection:$i,transformation:Ge(1,0,-1,0),scale:function(a){return Math.pow(2,a)},zoom:function(a){return Math.log(a)/Math.LN2},distance:function(a,p){var S=p.lng-a.lng,V=p.lat-a.lat;return Math.sqrt(S*S+V*V)},infinite:!0});se.Earth=k,se.EPSG3395=oo,se.EPSG3857=K,se.EPSG900913=de,se.EPSG4326=ho,se.Simple=Ps;var Vr=J.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(a){return a.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(a){return a&&a.removeLayer(this),this},getPane:function(a){return this._map.getPane(a?this.options[a]||a:this.options.pane)},addInteractiveTarget:function(a){return this._map._targets[f(a)]=this,this},removeInteractiveTarget:function(a){return delete this._map._targets[f(a)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(a){var p=a.target;if(p.hasLayer(this)){if(this._map=p,this._zoomAnimated=p._zoomAnimated,this.getEvents){var S=this.getEvents();p.on(S,this),this.once("remove",function(){p.off(S,this)},this)}this.onAdd(p),this.fire("add"),p.fire("layeradd",{layer:this})}}});Xr.include({addLayer:function(a){if(!a._layerAdd)throw new Error("The provided object is not a Layer.");var p=f(a);return this._layers[p]?this:(this._layers[p]=a,a._mapToAdd=this,a.beforeAdd&&a.beforeAdd(this),this.whenReady(a._layerAdd,a),this)},removeLayer:function(a){var p=f(a);return this._layers[p]?(this._loaded&&a.onRemove(this),delete this._layers[p],this._loaded&&(this.fire("layerremove",{layer:a}),a.fire("remove")),a._map=a._mapToAdd=null,this):this},hasLayer:function(a){return f(a)in this._layers},eachLayer:function(a,p){for(var S in this._layers)a.call(p,this._layers[S]);return this},_addLayers:function(a){a=a?Z(a)?a:[a]:[];for(var p=0,S=a.length;p<S;p++)this.addLayer(a[p])},_addZoomLimit:function(a){(!isNaN(a.options.maxZoom)||!isNaN(a.options.minZoom))&&(this._zoomBoundLayers[f(a)]=a,this._updateZoomLevels())},_removeZoomLimit:function(a){var p=f(a);this._zoomBoundLayers[p]&&(delete this._zoomBoundLayers[p],this._updateZoomLevels())},_updateZoomLevels:function(){var a=1/0,p=-1/0,S=this._getZoomSpan();for(var V in this._zoomBoundLayers){var ie=this._zoomBoundLayers[V].options;a=ie.minZoom===void 0?a:Math.min(a,ie.minZoom),p=ie.maxZoom===void 0?p:Math.max(p,ie.maxZoom)}this._layersMaxZoom=p===-1/0?void 0:p,this._layersMinZoom=a===1/0?void 0:a,S!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var zo=Vr.extend({initialize:function(a,p){T(this,p),this._layers={};var S,V;if(a)for(S=0,V=a.length;S<V;S++)this.addLayer(a[S])},addLayer:function(a){var p=this.getLayerId(a);return this._layers[p]=a,this._map&&this._map.addLayer(a),this},removeLayer:function(a){var p=a in this._layers?a:this.getLayerId(a);return this._map&&this._layers[p]&&this._map.removeLayer(this._layers[p]),delete this._layers[p],this},hasLayer:function(a){var p=typeof a=="number"?a:this.getLayerId(a);return p in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(a){var p=Array.prototype.slice.call(arguments,1),S,V;for(S in this._layers)V=this._layers[S],V[a]&&V[a].apply(V,p);return this},onAdd:function(a){this.eachLayer(a.addLayer,a)},onRemove:function(a){this.eachLayer(a.removeLayer,a)},eachLayer:function(a,p){for(var S in this._layers)a.call(p,this._layers[S]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[];return this.eachLayer(a.push,a),a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return f(a)}}),fl=function(a,p){return new zo(a,p)},es=zo.extend({addLayer:function(a){return this.hasLayer(a)?this:(a.addEventParent(this),zo.prototype.addLayer.call(this,a),this.fire("layeradd",{layer:a}))},removeLayer:function(a){return this.hasLayer(a)?(a in this._layers&&(a=this._layers[a]),a.removeEventParent(this),zo.prototype.removeLayer.call(this,a),this.fire("layerremove",{layer:a})):this},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new ee;for(var p in this._layers){var S=this._layers[p];a.extend(S.getBounds?S.getBounds():S.getLatLng())}return a}}),eu=function(a,p){return new es(a,p)},na=$.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(a){T(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,p){var S=this._getIconUrl(a);if(!S){if(a==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var V=this._createImg(S,p&&p.tagName==="IMG"?p:null);return this._setIconStyles(V,a),(this.options.crossOrigin||this.options.crossOrigin==="")&&(V.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),V},_setIconStyles:function(a,p){var S=this.options,V=S[p+"Size"];typeof V=="number"&&(V=[V,V]);var ie=Le(V),Ce=Le(p==="shadow"&&S.shadowAnchor||S.iconAnchor||ie&&ie.divideBy(2,!0));a.className="leaflet-marker-"+p+" "+(S.className||""),Ce&&(a.style.marginLeft=-Ce.x+"px",a.style.marginTop=-Ce.y+"px"),ie&&(a.style.width=ie.x+"px",a.style.height=ie.y+"px")},_createImg:function(a,p){return p=p||document.createElement("img"),p.src=a,p},_getIconUrl:function(a){return lt.retina&&this.options[a+"RetinaUrl"]||this.options[a+"Url"]}});function wu(a){return new na(a)}var Ga=na.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(a){return typeof Ga.imagePath!="string"&&(Ga.imagePath=this._detectIconPath()),(this.options.imagePath||Ga.imagePath)+na.prototype._getIconUrl.call(this,a)},_stripUrl:function(a){var p=function(S,V,ie){var Ce=V.exec(S);return Ce&&Ce[ie]};return a=p(a,/^url\((['"])?(.+)\1\)$/,2),a&&p(a,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var a=hr("div","leaflet-default-icon-path",document.body),p=ci(a,"background-image")||ci(a,"backgroundImage");if(document.body.removeChild(a),p=this._stripUrl(p),p)return p;var S=document.querySelector('link[href$="leaflet.css"]');return S?S.href.substring(0,S.href.length-11-1):""}}),Ha=bi.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new Hs(a,a,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Gn(a,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&_r(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(a){var p=this._marker,S=p._map,V=this._marker.options.autoPanSpeed,ie=this._marker.options.autoPanPadding,Ce=fs(p._icon),st=S.getPixelBounds(),Pt=S.getPixelOrigin(),Ut=N(st.min._subtract(Pt).add(ie),st.max._subtract(Pt).subtract(ie));if(!Ut.contains(Ce)){var an=Le((Math.max(Ut.max.x,Ce.x)-Ut.max.x)/(st.max.x-Ut.max.x)-(Math.min(Ut.min.x,Ce.x)-Ut.min.x)/(st.min.x-Ut.min.x),(Math.max(Ut.max.y,Ce.y)-Ut.max.y)/(st.max.y-Ut.max.y)-(Math.min(Ut.min.y,Ce.y)-Ut.min.y)/(st.min.y-Ut.min.y)).multiplyBy(V);S.panBy(an,{animate:!1}),this._draggable._newPos._add(an),this._draggable._startPos._add(an),Mi(p._icon,this._draggable._newPos),this._onDrag(a),this._panRequest=F(this._adjustPan.bind(this,a))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(a){this._marker.options.autoPan&&(B(this._panRequest),this._panRequest=F(this._adjustPan.bind(this,a)))},_onDrag:function(a){var p=this._marker,S=p._shadow,V=fs(p._icon),ie=p._map.layerPointToLatLng(V);S&&Mi(S,V),p._latlng=ie,a.latlng=ie,a.oldLatLng=this._oldLatLng,p.fire("move",a).fire("drag",a)},_onDragEnd:function(a){B(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",a)}}),po=Vr.extend({options:{icon:new Ga,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(a,p){T(this,p),this._latlng=_e(a)},onAdd:function(a){this._zoomAnimated=this._zoomAnimated&&a.options.markerZoomAnimation,this._zoomAnimated&&a.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(a){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&a.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(a){var p=this._latlng;return this._latlng=_e(a),this.update(),this.fire("move",{oldLatLng:p,latlng:this._latlng})},setZIndexOffset:function(a){return this.options.zIndexOffset=a,this.update()},getIcon:function(){return this.options.icon},setIcon:function(a){return this.options.icon=a,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var a=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(a)}return this},_initIcon:function(){var a=this.options,p="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),S=a.icon.createIcon(this._icon),V=!1;S!==this._icon&&(this._icon&&this._removeIcon(),V=!0,a.title&&(S.title=a.title),S.tagName==="IMG"&&(S.alt=a.alt||"")),Gn(S,p),a.keyboard&&(S.tabIndex="0",S.setAttribute("role","button")),this._icon=S,a.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&br(S,"focus",this._panOnFocus,this);var ie=a.icon.createShadow(this._shadow),Ce=!1;ie!==this._shadow&&(this._removeShadow(),Ce=!0),ie&&(Gn(ie,p),ie.alt=""),this._shadow=ie,a.opacity<1&&this._updateOpacity(),V&&this.getPane().appendChild(this._icon),this._initInteraction(),ie&&Ce&&this.getPane(a.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Nr(this._icon,"focus",this._panOnFocus,this),qn(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&qn(this._shadow),this._shadow=null},_setPos:function(a){this._icon&&Mi(this._icon,a),this._shadow&&Mi(this._shadow,a),this._zIndex=a.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(a){this._icon&&(this._icon.style.zIndex=this._zIndex+a)},_animateZoom:function(a){var p=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(p)},_initInteraction:function(){if(this.options.interactive&&(Gn(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ha)){var a=this.options.draggable;this.dragging&&(a=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ha(this),a&&this.dragging.enable()}},setOpacity:function(a){return this.options.opacity=a,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var a=this.options.opacity;this._icon&&tn(this._icon,a),this._shadow&&tn(this._shadow,a)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var a=this._map;if(a){var p=this.options.icon.options,S=p.iconSize?Le(p.iconSize):Le(0,0),V=p.iconAnchor?Le(p.iconAnchor):Le(0,0);a.panInside(this._latlng,{paddingTopLeft:V,paddingBottomRight:S.subtract(V)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function ra(a,p){return new po(a,p)}var Ms=Vr.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(a){this._renderer=a.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(a){return T(this,a),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&a&&Object.prototype.hasOwnProperty.call(a,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),hs=Ms.extend({options:{fill:!0,radius:10},initialize:function(a,p){T(this,p),this._latlng=_e(a),this._radius=this.options.radius},setLatLng:function(a){var p=this._latlng;return this._latlng=_e(a),this.redraw(),this.fire("move",{oldLatLng:p,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(a){return this.options.radius=this._radius=a,this.redraw()},getRadius:function(){return this._radius},setStyle:function(a){var p=a&&a.radius||this._radius;return Ms.prototype.setStyle.call(this,a),this.setRadius(p),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var a=this._radius,p=this._radiusY||a,S=this._clickTolerance(),V=[a+S,p+S];this._pxBounds=new De(this._point.subtract(V),this._point.add(V))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(a){return a.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function hl(a,p){return new hs(a,p)}var $o=hs.extend({initialize:function(a,p,S){if(typeof p=="number"&&(p=i({},S,{radius:p})),T(this,p),this._latlng=_e(a),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(a){return this._mRadius=a,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new ee(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)))},setStyle:Ms.prototype.setStyle,_project:function(){var a=this._latlng.lng,p=this._latlng.lat,S=this._map,V=S.options.crs;if(V.distance===k.distance){var ie=Math.PI/180,Ce=this._mRadius/k.R/ie,st=S.project([p+Ce,a]),Pt=S.project([p-Ce,a]),Ut=st.add(Pt).divideBy(2),an=S.unproject(Ut).lat,Dn=Math.acos((Math.cos(Ce*ie)-Math.sin(p*ie)*Math.sin(an*ie))/(Math.cos(p*ie)*Math.cos(an*ie)))/ie;(isNaN(Dn)||Dn===0)&&(Dn=Ce/Math.cos(Math.PI/180*p)),this._point=Ut.subtract(S.getPixelOrigin()),this._radius=isNaN(Dn)?0:Ut.x-S.project([an,a-Dn]).x,this._radiusY=Ut.y-st.y}else{var Xn=V.unproject(V.project(this._latlng).subtract([this._mRadius,0]));this._point=S.latLngToLayerPoint(this._latlng),this._radius=this._point.x-S.latLngToLayerPoint(Xn).x}this._updateBounds()}});function ts(a,p,S){return new $o(a,p,S)}var ns=Ms.extend({options:{smoothFactor:1,noClip:!1},initialize:function(a,p){T(this,p),this._setLatLngs(a)},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){return this._setLatLngs(a),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(a){for(var p=1/0,S=null,V=Nn,ie,Ce,st=0,Pt=this._parts.length;st<Pt;st++)for(var Ut=this._parts[st],an=1,Dn=Ut.length;an<Dn;an++){ie=Ut[an-1],Ce=Ut[an];var Xn=V(a,ie,Ce,!0);Xn<p&&(p=Xn,S=V(a,ie,Ce))}return S&&(S.distance=Math.sqrt(p)),S},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return vr(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(a,p){return p=p||this._defaultShape(),a=_e(a),p.push(a),this._bounds.extend(a),this.redraw()},_setLatLngs:function(a){this._bounds=new ee,this._latlngs=this._convertLatLngs(a)},_defaultShape:function(){return zn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(a){for(var p=[],S=zn(a),V=0,ie=a.length;V<ie;V++)S?(p[V]=_e(a[V]),this._bounds.extend(p[V])):p[V]=this._convertLatLngs(a[V]);return p},_project:function(){var a=new De;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,a),this._bounds.isValid()&&a.isValid()&&(this._rawPxBounds=a,this._updateBounds())},_updateBounds:function(){var a=this._clickTolerance(),p=new Y(a,a);this._rawPxBounds&&(this._pxBounds=new De([this._rawPxBounds.min.subtract(p),this._rawPxBounds.max.add(p)]))},_projectLatlngs:function(a,p,S){var V=a[0]instanceof ce,ie=a.length,Ce,st;if(V){for(st=[],Ce=0;Ce<ie;Ce++)st[Ce]=this._map.latLngToLayerPoint(a[Ce]),S.extend(st[Ce]);p.push(st)}else for(Ce=0;Ce<ie;Ce++)this._projectLatlngs(a[Ce],p,S)},_clipPoints:function(){var a=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return}var p=this._parts,S,V,ie,Ce,st,Pt,Ut;for(S=0,ie=0,Ce=this._rings.length;S<Ce;S++)for(Ut=this._rings[S],V=0,st=Ut.length;V<st-1;V++)Pt=ft(Ut[V],Ut[V+1],a,V,!0),Pt&&(p[ie]=p[ie]||[],p[ie].push(Pt[0]),(Pt[1]!==Ut[V+1]||V===st-2)&&(p[ie].push(Pt[1]),ie++))}},_simplifyPoints:function(){for(var a=this._parts,p=this.options.smoothFactor,S=0,V=a.length;S<V;S++)a[S]=wi(a[S],p)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(a,p){var S,V,ie,Ce,st,Pt,Ut=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(S=0,Ce=this._parts.length;S<Ce;S++)for(Pt=this._parts[S],V=0,st=Pt.length,ie=st-1;V<st;ie=V++)if(!(!p&&V===0)&&Es(a,Pt[ie],Pt[V])<=Ut)return!0;return!1}});function Ju(a,p){return new ns(a,p)}ns._flat=nr;var So=ns.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return qs(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(a){var p=ns.prototype._convertLatLngs.call(this,a),S=p.length;return S>=2&&p[0]instanceof ce&&p[0].equals(p[S-1])&&p.pop(),p},_setLatLngs:function(a){ns.prototype._setLatLngs.call(this,a),zn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return zn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var a=this._renderer._bounds,p=this.options.weight,S=new Y(p,p);if(a=new De(a.min.subtract(S),a.max.add(S)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return}for(var V=0,ie=this._rings.length,Ce;V<ie;V++)Ce=Il(this._rings[V],a,!0),Ce.length&&this._parts.push(Ce)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(a){var p=!1,S,V,ie,Ce,st,Pt,Ut,an;if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(Ce=0,Ut=this._parts.length;Ce<Ut;Ce++)for(S=this._parts[Ce],st=0,an=S.length,Pt=an-1;st<an;Pt=st++)V=S[st],ie=S[Pt],V.y>a.y!=ie.y>a.y&&a.x<(ie.x-V.x)*(a.y-V.y)/(ie.y-V.y)+V.x&&(p=!p);return p||ns.prototype._containsPoint.call(this,a,!0)}});function wa(a,p){return new So(a,p)}var Uo=es.extend({initialize:function(a,p){T(this,p),this._layers={},a&&this.addData(a)},addData:function(a){var p=Z(a)?a:a.features,S,V,ie;if(p){for(S=0,V=p.length;S<V;S++)ie=p[S],(ie.geometries||ie.geometry||ie.features||ie.coordinates)&&this.addData(ie);return this}var Ce=this.options;if(Ce.filter&&!Ce.filter(a))return this;var st=Vo(a,Ce);return st?(st.feature=Ho(a),st.defaultOptions=st.options,this.resetStyle(st),Ce.onEachFeature&&Ce.onEachFeature(a,st),this.addLayer(st)):this},resetStyle:function(a){return a===void 0?this.eachLayer(this.resetStyle,this):(a.options=i({},a.defaultOptions),this._setLayerStyle(a,this.options.style),this)},setStyle:function(a){return this.eachLayer(function(p){this._setLayerStyle(p,a)},this)},_setLayerStyle:function(a,p){a.setStyle&&(typeof p=="function"&&(p=p(a.feature)),a.setStyle(p))}});function Vo(a,p){var S=a.type==="Feature"?a.geometry:a,V=S?S.coordinates:null,ie=[],Ce=p&&p.pointToLayer,st=p&&p.coordsToLatLng||La,Pt,Ut,an,Dn;if(!V&&!S)return null;switch(S.type){case"Point":return Pt=st(V),xa(Ce,a,Pt,p);case"MultiPoint":for(an=0,Dn=V.length;an<Dn;an++)Pt=st(V[an]),ie.push(xa(Ce,a,Pt,p));return new es(ie);case"LineString":case"MultiLineString":return Ut=Go(V,S.type==="LineString"?0:1,st),new ns(Ut,p);case"Polygon":case"MultiPolygon":return Ut=Go(V,S.type==="Polygon"?1:2,st),new So(Ut,p);case"GeometryCollection":for(an=0,Dn=S.geometries.length;an<Dn;an++){var Xn=Vo({geometry:S.geometries[an],type:"Feature",properties:a.properties},p);Xn&&ie.push(Xn)}return new es(ie);case"FeatureCollection":for(an=0,Dn=S.features.length;an<Dn;an++){var zr=Vo(S.features[an],p);zr&&ie.push(zr)}return new es(ie);default:throw new Error("Invalid GeoJSON object.")}}function xa(a,p,S,V){return a?a(p,S):new po(S,V&&V.markersInheritOptions&&V)}function La(a){return new ce(a[1],a[0],a[2])}function Go(a,p,S){for(var V=[],ie=0,Ce=a.length,st;ie<Ce;ie++)st=p?Go(a[ie],p-1,S):(S||La)(a[ie]),V.push(st);return V}function Ao(a,p){return a=_e(a),a.alt!==void 0?[x(a.lng,p),x(a.lat,p),x(a.alt,p)]:[x(a.lng,p),x(a.lat,p)]}function ia(a,p,S,V){for(var ie=[],Ce=0,st=a.length;Ce<st;Ce++)ie.push(p?ia(a[Ce],zn(a[Ce])?0:p-1,S,V):Ao(a[Ce],V));return!p&&S&&ie.length>0&&ie.push(ie[0].slice()),ie}function As(a,p){return a.feature?i({},a.feature,{geometry:p}):Ho(p)}function Ho(a){return a.type==="Feature"||a.type==="FeatureCollection"?a:{type:"Feature",properties:{},geometry:a}}var _t={toGeoJSON:function(a){return As(this,{type:"Point",coordinates:Ao(this.getLatLng(),a)})}};po.include(_t),$o.include(_t),hs.include(_t),ns.include({toGeoJSON:function(a){var p=!zn(this._latlngs),S=ia(this._latlngs,p?1:0,!1,a);return As(this,{type:(p?"Multi":"")+"LineString",coordinates:S})}}),So.include({toGeoJSON:function(a){var p=!zn(this._latlngs),S=p&&!zn(this._latlngs[0]),V=ia(this._latlngs,S?2:p?1:0,!0,a);return p||(V=[V]),As(this,{type:(S?"Multi":"")+"Polygon",coordinates:V})}}),zo.include({toMultiPoint:function(a){var p=[];return this.eachLayer(function(S){p.push(S.toGeoJSON(a).geometry.coordinates)}),As(this,{type:"MultiPoint",coordinates:p})},toGeoJSON:function(a){var p=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(p==="MultiPoint")return this.toMultiPoint(a);var S=p==="GeometryCollection",V=[];return this.eachLayer(function(ie){if(ie.toGeoJSON){var Ce=ie.toGeoJSON(a);if(S)V.push(Ce.geometry);else{var st=Ho(Ce);st.type==="FeatureCollection"?V.push.apply(V,st.features):V.push(st)}}}),S?As(this,{geometries:V,type:"GeometryCollection"}):{type:"FeatureCollection",features:V}}});function Zt(a,p){return new Uo(a,p)}var At=Zt,An=Vr.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(a,p,S){this._url=a,this._bounds=fe(p),T(this,S)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Gn(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){qn(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(a){return this.options.opacity=a,this._image&&this._updateOpacity(),this},setStyle:function(a){return a.opacity&&this.setOpacity(a.opacity),this},bringToFront:function(){return this._map&&wo(this._image),this},bringToBack:function(){return this._map&&Lr(this._image),this},setUrl:function(a){return this._url=a,this._image&&(this._image.src=a),this},setBounds:function(a){return this._bounds=fe(a),this._map&&this._reset(),this},getEvents:function(){var a={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var a=this._url.tagName==="IMG",p=this._image=a?this._url:hr("img");if(Gn(p,"leaflet-image-layer"),this._zoomAnimated&&Gn(p,"leaflet-zoom-animated"),this.options.className&&Gn(p,this.options.className),p.onselectstart=y,p.onmousemove=y,p.onload=o(this.fire,this,"load"),p.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(p.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),a){this._url=p.src;return}p.src=this._url,p.alt=this.options.alt},_animateZoom:function(a){var p=this._map.getZoomScale(a.zoom),S=this._map._latLngBoundsToNewLayerBounds(this._bounds,a.zoom,a.center).min;xo(this._image,S,p)},_reset:function(){var a=this._image,p=new De(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),S=p.getSize();Mi(a,p.min),a.style.width=S.x+"px",a.style.height=S.y+"px"},_updateOpacity:function(){tn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var a=this.options.errorOverlayUrl;a&&this._url!==a&&(this._url=a,this._image.src=a)},getCenter:function(){return this._bounds.getCenter()}}),Kn=function(a,p,S){return new An(a,p,S)},wr=An.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var a=this._url.tagName==="VIDEO",p=this._image=a?this._url:hr("video");if(Gn(p,"leaflet-image-layer"),this._zoomAnimated&&Gn(p,"leaflet-zoom-animated"),this.options.className&&Gn(p,this.options.className),p.onselectstart=y,p.onmousemove=y,p.onloadeddata=o(this.fire,this,"load"),a){for(var S=p.getElementsByTagName("source"),V=[],ie=0;ie<S.length;ie++)V.push(S[ie].src);this._url=S.length>0?V:[p.src];return}Z(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(p.style,"objectFit")&&(p.style.objectFit="fill"),p.autoplay=!!this.options.autoplay,p.loop=!!this.options.loop,p.muted=!!this.options.muted,p.playsInline=!!this.options.playsInline;for(var Ce=0;Ce<this._url.length;Ce++){var st=hr("source");st.src=this._url[Ce],p.appendChild(st)}}});function Vi(a,p,S){return new wr(a,p,S)}var Li=An.extend({_initImage:function(){var a=this._image=this._url;Gn(a,"leaflet-image-layer"),this._zoomAnimated&&Gn(a,"leaflet-zoom-animated"),this.options.className&&Gn(a,this.options.className),a.onselectstart=y,a.onmousemove=y}});function Ol(a,p,S){return new Li(a,p,S)}var rs=Vr.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(a,p){a&&(a instanceof ce||Z(a))?(this._latlng=_e(a),T(this,p)):(T(this,a),this._source=p),this.options.content&&(this._content=this.options.content)},openOn:function(a){return a=arguments.length?a:this._source._map,a.hasLayer(this)||a.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(a){return this._map?this.close():(arguments.length?this._source=a:a=this._source,this._prepareOpen(),this.openOn(a._map)),this},onAdd:function(a){this._zoomAnimated=a._zoomAnimated,this._container||this._initLayout(),a._fadeAnimated&&tn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),a._fadeAnimated&&tn(this._container,1),this.bringToFront(),this.options.interactive&&(Gn(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(a){a._fadeAnimated?(tn(this._container,0),this._removeTimeout=setTimeout(o(qn,void 0,this._container),200)):qn(this._container),this.options.interactive&&(_r(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=_e(a),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(a){return this._content=a,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var a={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&wo(this._container),this},bringToBack:function(){return this._map&&Lr(this._container),this},_prepareOpen:function(a){var p=this._source;if(!p._map)return!1;if(p instanceof es){p=null;var S=this._source._layers;for(var V in S)if(S[V]._map){p=S[V];break}if(!p)return!1;this._source=p}if(!a)if(p.getCenter)a=p.getCenter();else if(p.getLatLng)a=p.getLatLng();else if(p.getBounds)a=p.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(a),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var a=this._contentNode,p=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof p=="string")a.innerHTML=p;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(p)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),p=Le(this.options.offset),S=this._getAnchor();this._zoomAnimated?Mi(this._container,a.add(S)):p=p.add(a).add(S);var V=this._containerBottom=-p.y,ie=this._containerLeft=-Math.round(this._containerWidth/2)+p.x;this._container.style.bottom=V+"px",this._container.style.left=ie+"px"}},_getAnchor:function(){return[0,0]}});Xr.include({_initOverlay:function(a,p,S,V){var ie=p;return ie instanceof a||(ie=new a(V).setContent(p)),S&&ie.setLatLng(S),ie}}),Vr.include({_initOverlay:function(a,p,S,V){var ie=S;return ie instanceof a?(T(ie,V),ie._source=this):(ie=p&&!V?p:new a(V,this),ie.setContent(S)),ie}});var Gi=rs.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(a){return a=arguments.length?a:this._source._map,!a.hasLayer(this)&&a._popup&&a._popup.options.autoClose&&a.removeLayer(a._popup),a._popup=this,rs.prototype.openOn.call(this,a)},onAdd:function(a){rs.prototype.onAdd.call(this,a),a.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ms||this._source.on("preclick",Ua))},onRemove:function(a){rs.prototype.onRemove.call(this,a),a.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ms||this._source.off("preclick",Ua))},getEvents:function(){var a=rs.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(a.preclick=this.close),this.options.keepInView&&(a.moveend=this._adjustPan),a},_initLayout:function(){var a="leaflet-popup",p=this._container=hr("div",a+" "+(this.options.className||"")+" leaflet-zoom-animated"),S=this._wrapper=hr("div",a+"-content-wrapper",p);if(this._contentNode=hr("div",a+"-content",S),Ml(p),bu(this._contentNode),br(p,"contextmenu",Ua),this._tipContainer=hr("div",a+"-tip-container",p),this._tip=hr("div",a+"-tip",this._tipContainer),this.options.closeButton){var V=this._closeButton=hr("a",a+"-close-button",p);V.setAttribute("role","button"),V.setAttribute("aria-label","Close popup"),V.href="#close",V.innerHTML='<span aria-hidden="true">&#215;</span>',br(V,"click",function(ie){Sr(ie),this.close()},this)}},_updateLayout:function(){var a=this._contentNode,p=a.style;p.width="",p.whiteSpace="nowrap";var S=a.offsetWidth;S=Math.min(S,this.options.maxWidth),S=Math.max(S,this.options.minWidth),p.width=S+1+"px",p.whiteSpace="",p.height="";var V=a.offsetHeight,ie=this.options.maxHeight,Ce="leaflet-popup-scrolled";ie&&V>ie?(p.height=ie+"px",Gn(a,Ce)):_r(a,Ce),this._containerWidth=this._container.offsetWidth},_animateZoom:function(a){var p=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center),S=this._getAnchor();Mi(this._container,p.add(S))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var a=this._map,p=parseInt(ci(this._container,"marginBottom"),10)||0,S=this._container.offsetHeight+p,V=this._containerWidth,ie=new Y(this._containerLeft,-S-this._containerBottom);ie._add(fs(this._container));var Ce=a.layerPointToContainerPoint(ie),st=Le(this.options.autoPanPadding),Pt=Le(this.options.autoPanPaddingTopLeft||st),Ut=Le(this.options.autoPanPaddingBottomRight||st),an=a.getSize(),Dn=0,Xn=0;Ce.x+V+Ut.x>an.x&&(Dn=Ce.x+V-an.x+Ut.x),Ce.x-Dn-Pt.x<0&&(Dn=Ce.x-Pt.x),Ce.y+S+Ut.y>an.y&&(Xn=Ce.y+S-an.y+Ut.y),Ce.y-Xn-Pt.y<0&&(Xn=Ce.y-Pt.y),(Dn||Xn)&&(this.options.keepInView&&(this._autopanning=!0),a.fire("autopanstart").panBy([Dn,Xn]))}},_getAnchor:function(){return Le(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),oa=function(a,p){return new Gi(a,p)};Xr.mergeOptions({closePopupOnClick:!0}),Xr.include({openPopup:function(a,p,S){return this._initOverlay(Gi,a,p,S).openOn(this),this},closePopup:function(a){return a=arguments.length?a:this._popup,a&&a.close(),this}}),Vr.include({bindPopup:function(a,p){return this._popup=this._initOverlay(Gi,this._popup,a,p),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(a){return this._popup&&(this instanceof es||(this._popup._source=this),this._popup._prepareOpen(a||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(a){return this._popup&&this._popup.setContent(a),this},getPopup:function(){return this._popup},_openPopup:function(a){if(!(!this._popup||!this._map)){qr(a);var p=a.layer||a.target;if(this._popup._source===p&&!(p instanceof Ms)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(a.latlng);return}this._popup._source=p,this.openPopup(a.latlng)}},_movePopup:function(a){this._popup.setLatLng(a.latlng)},_onKeyPress:function(a){a.originalEvent.keyCode===13&&this._openPopup(a)}});var Sa=rs.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(a){rs.prototype.onAdd.call(this,a),this.setOpacity(this.options.opacity),a.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(a){rs.prototype.onRemove.call(this,a),a.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var a=rs.prototype.getEvents.call(this);return this.options.permanent||(a.preclick=this.close),a},_initLayout:function(){var a="leaflet-tooltip",p=a+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=hr("div",p),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+f(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(a){var p,S,V=this._map,ie=this._container,Ce=V.latLngToContainerPoint(V.getCenter()),st=V.layerPointToContainerPoint(a),Pt=this.options.direction,Ut=ie.offsetWidth,an=ie.offsetHeight,Dn=Le(this.options.offset),Xn=this._getAnchor();Pt==="top"?(p=Ut/2,S=an):Pt==="bottom"?(p=Ut/2,S=0):Pt==="center"?(p=Ut/2,S=an/2):Pt==="right"?(p=0,S=an/2):Pt==="left"?(p=Ut,S=an/2):st.x<Ce.x?(Pt="right",p=0,S=an/2):(Pt="left",p=Ut+(Dn.x+Xn.x)*2,S=an/2),a=a.subtract(Le(p,S,!0)).add(Dn).add(Xn),_r(ie,"leaflet-tooltip-right"),_r(ie,"leaflet-tooltip-left"),_r(ie,"leaflet-tooltip-top"),_r(ie,"leaflet-tooltip-bottom"),Gn(ie,"leaflet-tooltip-"+Pt),Mi(ie,a)},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a)},setOpacity:function(a){this.options.opacity=a,this._container&&tn(this._container,a)},_animateZoom:function(a){var p=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);this._setPosition(p)},_getAnchor:function(){return Le(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),sa=function(a,p){return new Sa(a,p)};Xr.include({openTooltip:function(a,p,S){return this._initOverlay(Sa,a,p,S).openOn(this),this},closeTooltip:function(a){return a.close(),this}}),Vr.include({bindTooltip:function(a,p){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Sa,this._tooltip,a,p),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(a){if(!(!a&&this._tooltipHandlersAdded)){var p=a?"off":"on",S={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?S.add=this._openTooltip:(S.mouseover=this._openTooltip,S.mouseout=this.closeTooltip,S.click=this._openTooltip,this._map?this._addFocusListeners():S.add=this._addFocusListeners),this._tooltip.options.sticky&&(S.mousemove=this._moveTooltip),this[p](S),this._tooltipHandlersAdded=!a}},openTooltip:function(a){return this._tooltip&&(this instanceof es||(this._tooltip._source=this),this._tooltip._prepareOpen(a)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(a){return this._tooltip&&this._tooltip.setContent(a),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(a){var p=typeof a.getElement=="function"&&a.getElement();p&&(br(p,"focus",function(){this._tooltip._source=a,this.openTooltip()},this),br(p,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(a){var p=typeof a.getElement=="function"&&a.getElement();p&&p.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(a){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var p=this;this._map.once("moveend",function(){p._openOnceFlag=!1,p._openTooltip(a)});return}this._tooltip._source=a.layer||a.target,this.openTooltip(this._tooltip.options.sticky?a.latlng:void 0)}},_moveTooltip:function(a){var p=a.latlng,S,V;this._tooltip.options.sticky&&a.originalEvent&&(S=this._map.mouseEventToContainerPoint(a.originalEvent),V=this._map.containerPointToLayerPoint(S),p=this._map.layerPointToLatLng(V)),this._tooltip.setLatLng(p)}});var aa=na.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(a){var p=a&&a.tagName==="DIV"?a:document.createElement("div"),S=this.options;if(S.html instanceof Element?(bo(p),p.appendChild(S.html)):p.innerHTML=S.html!==!1?S.html:"",S.bgPos){var V=Le(S.bgPos);p.style.backgroundPosition=-V.x+"px "+-V.y+"px"}return this._setIconStyles(p,"icon"),p},createShadow:function(){return null}});function la(a){return new aa(a)}na.Default=Ga;var Qr=Vr.extend({options:{tileSize:256,opacity:1,updateWhenIdle:lt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(a){T(this,a)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(a){a._addZoomLimit(this)},onRemove:function(a){this._removeAllTiles(),qn(this._container),a._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(wo(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Lr(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(a){return this.options.opacity=a,this._updateOpacity(),this},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var a=this._clampZoom(this._map.getZoom());a!==this._tileZoom&&(this._tileZoom=a,this._updateLevels()),this._update()}return this},getEvents:function(){var a={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove),this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},createTile:function(){return document.createElement("div")},getTileSize:function(){var a=this.options.tileSize;return a instanceof Y?a:new Y(a,a)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a){for(var p=this.getPane().children,S=-a(-1/0,1/0),V=0,ie=p.length,Ce;V<ie;V++)Ce=p[V].style.zIndex,p[V]!==this._container&&Ce&&(S=a(S,+Ce));isFinite(S)&&(this.options.zIndex=S+a(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!lt.ielt9){tn(this._container,this.options.opacity);var a=+new Date,p=!1,S=!1;for(var V in this._tiles){var ie=this._tiles[V];if(!(!ie.current||!ie.loaded)){var Ce=Math.min(1,(a-ie.loaded)/200);tn(ie.el,Ce),Ce<1?p=!0:(ie.active?S=!0:this._onOpaqueTile(ie),ie.active=!0)}}S&&!this._noPrune&&this._pruneTiles(),p&&(B(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this))}},_onOpaqueTile:y,_initContainer:function(){this._container||(this._container=hr("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var a=this._tileZoom,p=this.options.maxZoom;if(a!==void 0){for(var S in this._levels)S=Number(S),this._levels[S].el.children.length||S===a?(this._levels[S].el.style.zIndex=p-Math.abs(a-S),this._onUpdateLevel(S)):(qn(this._levels[S].el),this._removeTilesAtZoom(S),this._onRemoveLevel(S),delete this._levels[S]);var V=this._levels[a],ie=this._map;return V||(V=this._levels[a]={},V.el=hr("div","leaflet-tile-container leaflet-zoom-animated",this._container),V.el.style.zIndex=p,V.origin=ie.project(ie.unproject(ie.getPixelOrigin()),a).round(),V.zoom=a,this._setZoomTransform(V,ie.getCenter(),ie.getZoom()),y(V.el.offsetWidth),this._onCreateLevel(V)),this._level=V,V}},_onUpdateLevel:y,_onRemoveLevel:y,_onCreateLevel:y,_pruneTiles:function(){if(this._map){var a,p,S=this._map.getZoom();if(S>this.options.maxZoom||S<this.options.minZoom){this._removeAllTiles();return}for(a in this._tiles)p=this._tiles[a],p.retain=p.current;for(a in this._tiles)if(p=this._tiles[a],p.current&&!p.active){var V=p.coords;this._retainParent(V.x,V.y,V.z,V.z-5)||this._retainChildren(V.x,V.y,V.z,V.z+2)}for(a in this._tiles)this._tiles[a].retain||this._removeTile(a)}},_removeTilesAtZoom:function(a){for(var p in this._tiles)this._tiles[p].coords.z===a&&this._removeTile(p)},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a)},_invalidateAll:function(){for(var a in this._levels)qn(this._levels[a].el),this._onRemoveLevel(Number(a)),delete this._levels[a];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(a,p,S,V){var ie=Math.floor(a/2),Ce=Math.floor(p/2),st=S-1,Pt=new Y(+ie,+Ce);Pt.z=+st;var Ut=this._tileCoordsToKey(Pt),an=this._tiles[Ut];return an&&an.active?(an.retain=!0,!0):(an&&an.loaded&&(an.retain=!0),st>V?this._retainParent(ie,Ce,st,V):!1)},_retainChildren:function(a,p,S,V){for(var ie=2*a;ie<2*a+2;ie++)for(var Ce=2*p;Ce<2*p+2;Ce++){var st=new Y(ie,Ce);st.z=S+1;var Pt=this._tileCoordsToKey(st),Ut=this._tiles[Pt];if(Ut&&Ut.active){Ut.retain=!0;continue}else Ut&&Ut.loaded&&(Ut.retain=!0);S+1<V&&this._retainChildren(ie,Ce,S+1,V)}},_resetView:function(a){var p=a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),p,p)},_animateZoom:function(a){this._setView(a.center,a.zoom,!0,a.noUpdate)},_clampZoom:function(a){var p=this.options;return p.minNativeZoom!==void 0&&a<p.minNativeZoom?p.minNativeZoom:p.maxNativeZoom!==void 0&&p.maxNativeZoom<a?p.maxNativeZoom:a},_setView:function(a,p,S,V){var ie=Math.round(p);this.options.maxZoom!==void 0&&ie>this.options.maxZoom||this.options.minZoom!==void 0&&ie<this.options.minZoom?ie=void 0:ie=this._clampZoom(ie);var Ce=this.options.updateWhenZooming&&ie!==this._tileZoom;(!V||Ce)&&(this._tileZoom=ie,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),ie!==void 0&&this._update(a),S||this._pruneTiles(),this._noPrune=!!S),this._setZoomTransforms(a,p)},_setZoomTransforms:function(a,p){for(var S in this._levels)this._setZoomTransform(this._levels[S],a,p)},_setZoomTransform:function(a,p,S){var V=this._map.getZoomScale(S,a.zoom),ie=a.origin.multiplyBy(V).subtract(this._map._getNewPixelOrigin(p,S)).round();lt.any3d?xo(a.el,ie,V):Mi(a.el,ie)},_resetGrid:function(){var a=this._map,p=a.options.crs,S=this._tileSize=this.getTileSize(),V=this._tileZoom,ie=this._map.getPixelWorldBounds(this._tileZoom);ie&&(this._globalTileRange=this._pxBoundsToTileRange(ie)),this._wrapX=p.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,p.wrapLng[0]],V).x/S.x),Math.ceil(a.project([0,p.wrapLng[1]],V).x/S.y)],this._wrapY=p.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([p.wrapLat[0],0],V).y/S.x),Math.ceil(a.project([p.wrapLat[1],0],V).y/S.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(a){var p=this._map,S=p._animatingZoom?Math.max(p._animateToZoom,p.getZoom()):p.getZoom(),V=p.getZoomScale(S,this._tileZoom),ie=p.project(a,this._tileZoom).floor(),Ce=p.getSize().divideBy(V*2);return new De(ie.subtract(Ce),ie.add(Ce))},_update:function(a){var p=this._map;if(p){var S=this._clampZoom(p.getZoom());if(a===void 0&&(a=p.getCenter()),this._tileZoom!==void 0){var V=this._getTiledPixelBounds(a),ie=this._pxBoundsToTileRange(V),Ce=ie.getCenter(),st=[],Pt=this.options.keepBuffer,Ut=new De(ie.getBottomLeft().subtract([Pt,-Pt]),ie.getTopRight().add([Pt,-Pt]));if(!(isFinite(ie.min.x)&&isFinite(ie.min.y)&&isFinite(ie.max.x)&&isFinite(ie.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var an in this._tiles){var Dn=this._tiles[an].coords;(Dn.z!==this._tileZoom||!Ut.contains(new Y(Dn.x,Dn.y)))&&(this._tiles[an].current=!1)}if(Math.abs(S-this._tileZoom)>1){this._setView(a,S);return}for(var Xn=ie.min.y;Xn<=ie.max.y;Xn++)for(var zr=ie.min.x;zr<=ie.max.x;zr++){var mo=new Y(zr,Xn);if(mo.z=this._tileZoom,!!this._isValidTile(mo)){var Ji=this._tiles[this._tileCoordsToKey(mo)];Ji?Ji.current=!0:st.push(mo)}}if(st.sort(function(Hi,gs){return Hi.distanceTo(Ce)-gs.distanceTo(Ce)}),st.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Do=document.createDocumentFragment();for(zr=0;zr<st.length;zr++)this._addTile(st[zr],Do);this._level.el.appendChild(Do)}}}},_isValidTile:function(a){var p=this._map.options.crs;if(!p.infinite){var S=this._globalTileRange;if(!p.wrapLng&&(a.x<S.min.x||a.x>S.max.x)||!p.wrapLat&&(a.y<S.min.y||a.y>S.max.y))return!1}if(!this.options.bounds)return!0;var V=this._tileCoordsToBounds(a);return fe(this.options.bounds).overlaps(V)},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a))},_tileCoordsToNwSe:function(a){var p=this._map,S=this.getTileSize(),V=a.scaleBy(S),ie=V.add(S),Ce=p.unproject(V,a.z),st=p.unproject(ie,a.z);return[Ce,st]},_tileCoordsToBounds:function(a){var p=this._tileCoordsToNwSe(a),S=new ee(p[0],p[1]);return this.options.noWrap||(S=this._map.wrapLatLngBounds(S)),S},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_keyToTileCoords:function(a){var p=a.split(":"),S=new Y(+p[0],+p[1]);return S.z=+p[2],S},_removeTile:function(a){var p=this._tiles[a];p&&(qn(p.el),delete this._tiles[a],this.fire("tileunload",{tile:p.el,coords:this._keyToTileCoords(a)}))},_initTile:function(a){Gn(a,"leaflet-tile");var p=this.getTileSize();a.style.width=p.x+"px",a.style.height=p.y+"px",a.onselectstart=y,a.onmousemove=y,lt.ielt9&&this.options.opacity<1&&tn(a,this.options.opacity)},_addTile:function(a,p){var S=this._getTilePos(a),V=this._tileCoordsToKey(a),ie=this.createTile(this._wrapCoords(a),o(this._tileReady,this,a));this._initTile(ie),this.createTile.length<2&&F(o(this._tileReady,this,a,null,ie)),Mi(ie,S),this._tiles[V]={el:ie,coords:a,current:!0},p.appendChild(ie),this.fire("tileloadstart",{tile:ie,coords:a})},_tileReady:function(a,p,S){p&&this.fire("tileerror",{error:p,tile:S,coords:a});var V=this._tileCoordsToKey(a);S=this._tiles[V],S&&(S.loaded=+new Date,this._map._fadeAnimated?(tn(S.el,0),B(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this)):(S.active=!0,this._pruneTiles()),p||(Gn(S.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:S.el,coords:a})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),lt.ielt9||!this._map._fadeAnimated?F(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(a){return a.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(a){var p=new Y(this._wrapX?g(a.x,this._wrapX):a.x,this._wrapY?g(a.y,this._wrapY):a.y);return p.z=a.z,p},_pxBoundsToTileRange:function(a){var p=this.getTileSize();return new De(a.min.unscaleBy(p).floor(),a.max.unscaleBy(p).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0}});function Ws(a){return new Qr(a)}var ko=Qr.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(a,p){this._url=a,p=T(this,p),p.detectRetina&&lt.retina&&p.maxZoom>0?(p.tileSize=Math.floor(p.tileSize/2),p.zoomReverse?(p.zoomOffset--,p.minZoom=Math.min(p.maxZoom,p.minZoom+1)):(p.zoomOffset++,p.maxZoom=Math.max(p.minZoom,p.maxZoom-1)),p.minZoom=Math.max(0,p.minZoom)):p.zoomReverse?p.minZoom=Math.min(p.maxZoom,p.minZoom):p.maxZoom=Math.max(p.minZoom,p.maxZoom),typeof p.subdomains=="string"&&(p.subdomains=p.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(a,p){return this._url===a&&p===void 0&&(p=!0),this._url=a,p||this.redraw(),this},createTile:function(a,p){var S=document.createElement("img");return br(S,"load",o(this._tileOnLoad,this,p,S)),br(S,"error",o(this._tileOnError,this,p,S)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(S.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(S.referrerPolicy=this.options.referrerPolicy),S.alt="",S.src=this.getTileUrl(a),S},getTileUrl:function(a){var p={r:lt.retina?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var S=this._globalTileRange.max.y-a.y;this.options.tms&&(p.y=S),p["-y"]=S}return j(this._url,i(p,this.options))},_tileOnLoad:function(a,p){lt.ielt9?setTimeout(o(a,this,null,p),0):a(null,p)},_tileOnError:function(a,p,S){var V=this.options.errorTileUrl;V&&p.getAttribute("src")!==V&&(p.src=V),a(S,p)},_onTileRemove:function(a){a.tile.onload=null},_getZoomForUrl:function(){var a=this._tileZoom,p=this.options.maxZoom,S=this.options.zoomReverse,V=this.options.zoomOffset;return S&&(a=p-a),a+V},_getSubdomain:function(a){var p=Math.abs(a.x+a.y)%this.options.subdomains.length;return this.options.subdomains[p]},_abortLoading:function(){var a,p;for(a in this._tiles)if(this._tiles[a].coords.z!==this._tileZoom&&(p=this._tiles[a].el,p.onload=y,p.onerror=y,!p.complete)){p.src=ue;var S=this._tiles[a].coords;qn(p),delete this._tiles[a],this.fire("tileabort",{tile:p,coords:S})}},_removeTile:function(a){var p=this._tiles[a];if(p)return p.el.setAttribute("src",ue),Qr.prototype._removeTile.call(this,a)},_tileReady:function(a,p,S){if(!(!this._map||S&&S.getAttribute("src")===ue))return Qr.prototype._tileReady.call(this,a,p,S)}});function Si(a,p){return new ko(a,p)}var Ai=ko.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(a,p){this._url=a;var S=i({},this.defaultWmsParams);for(var V in p)V in this.options||(S[V]=p[V]);p=T(this,p);var ie=p.detectRetina&&lt.retina?2:1,Ce=this.getTileSize();S.width=Ce.x*ie,S.height=Ce.y*ie,this.wmsParams=S},onAdd:function(a){this._crs=this.options.crs||a.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var p=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[p]=this._crs.code,ko.prototype.onAdd.call(this,a)},getTileUrl:function(a){var p=this._tileCoordsToNwSe(a),S=this._crs,V=N(S.project(p[0]),S.project(p[1])),ie=V.min,Ce=V.max,st=(this._wmsVersion>=1.3&&this._crs===ho?[ie.y,ie.x,Ce.y,Ce.x]:[ie.x,ie.y,Ce.x,Ce.y]).join(","),Pt=ko.prototype.getTileUrl.call(this,a);return Pt+D(this.wmsParams,Pt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+st},setParams:function(a,p){return i(this.wmsParams,a),p||this.redraw(),this}});function so(a,p){return new Ai(a,p)}ko.WMS=Ai,Si.wms=so;var Ri=Vr.extend({options:{padding:.1},initialize:function(a){T(this,a),f(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Gn(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var a={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(a.zoomanim=this._onAnimZoom),a},_onAnimZoom:function(a){this._updateTransform(a.center,a.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(a,p){var S=this._map.getZoomScale(p,this._zoom),V=this._map.getSize().multiplyBy(.5+this.options.padding),ie=this._map.project(this._center,p),Ce=V.multiplyBy(-S).add(ie).subtract(this._map._getNewPixelOrigin(a,p));lt.any3d?xo(this._container,Ce,S):Mi(this._container,Ce)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var a in this._layers)this._layers[a]._reset()},_onZoomEnd:function(){for(var a in this._layers)this._layers[a]._project()},_updatePaths:function(){for(var a in this._layers)this._layers[a]._update()},_update:function(){var a=this.options.padding,p=this._map.getSize(),S=this._map.containerPointToLayerPoint(p.multiplyBy(-a)).round();this._bounds=new De(S,S.add(p.multiplyBy(1+a*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),ks=Ri.extend({options:{tolerance:0},getEvents:function(){var a=Ri.prototype.getEvents.call(this);return a.viewprereset=this._onViewPreReset,a},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Ri.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var a=this._container=document.createElement("canvas");br(a,"mousemove",this._onMouseMove,this),br(a,"click dblclick mousedown mouseup contextmenu",this._onClick,this),br(a,"mouseout",this._handleMouseOut,this),a._leaflet_disable_events=!0,this._ctx=a.getContext("2d")},_destroyContainer:function(){B(this._redrawRequest),delete this._ctx,qn(this._container),Nr(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var a;this._redrawBounds=null;for(var p in this._layers)a=this._layers[p],a._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ri.prototype._update.call(this);var a=this._bounds,p=this._container,S=a.getSize(),V=lt.retina?2:1;Mi(p,a.min),p.width=V*S.x,p.height=V*S.y,p.style.width=S.x+"px",p.style.height=S.y+"px",lt.retina&&this._ctx.scale(2,2),this._ctx.translate(-a.min.x,-a.min.y),this.fire("update")}},_reset:function(){Ri.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(a){this._updateDashArray(a),this._layers[f(a)]=a;var p=a._order={layer:a,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=p),this._drawLast=p,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(a){this._requestRedraw(a)},_removePath:function(a){var p=a._order,S=p.next,V=p.prev;S?S.prev=V:this._drawLast=V,V?V.next=S:this._drawFirst=S,delete a._order,delete this._layers[f(a)],this._requestRedraw(a)},_updatePath:function(a){this._extendRedrawBounds(a),a._project(),a._update(),this._requestRedraw(a)},_updateStyle:function(a){this._updateDashArray(a),this._requestRedraw(a)},_updateDashArray:function(a){if(typeof a.options.dashArray=="string"){var p=a.options.dashArray.split(/[, ]+/),S=[],V,ie;for(ie=0;ie<p.length;ie++){if(V=Number(p[ie]),isNaN(V))return;S.push(V)}a.options._dashArray=S}else a.options._dashArray=a.options.dashArray},_requestRedraw:function(a){this._map&&(this._extendRedrawBounds(a),this._redrawRequest=this._redrawRequest||F(this._redraw,this))},_extendRedrawBounds:function(a){if(a._pxBounds){var p=(a.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new De,this._redrawBounds.extend(a._pxBounds.min.subtract([p,p])),this._redrawBounds.extend(a._pxBounds.max.add([p,p]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var a=this._redrawBounds;if(a){var p=a.getSize();this._ctx.clearRect(a.min.x,a.min.y,p.x,p.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var a,p=this._redrawBounds;if(this._ctx.save(),p){var S=p.getSize();this._ctx.beginPath(),this._ctx.rect(p.min.x,p.min.y,S.x,S.y),this._ctx.clip()}this._drawing=!0;for(var V=this._drawFirst;V;V=V.next)a=V.layer,(!p||a._pxBounds&&a._pxBounds.intersects(p))&&a._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(a,p){if(this._drawing){var S,V,ie,Ce,st=a._parts,Pt=st.length,Ut=this._ctx;if(Pt){for(Ut.beginPath(),S=0;S<Pt;S++){for(V=0,ie=st[S].length;V<ie;V++)Ce=st[S][V],Ut[V?"lineTo":"moveTo"](Ce.x,Ce.y);p&&Ut.closePath()}this._fillStroke(Ut,a)}}},_updateCircle:function(a){if(!(!this._drawing||a._empty())){var p=a._point,S=this._ctx,V=Math.max(Math.round(a._radius),1),ie=(Math.max(Math.round(a._radiusY),1)||V)/V;ie!==1&&(S.save(),S.scale(1,ie)),S.beginPath(),S.arc(p.x,p.y/ie,V,0,Math.PI*2,!1),ie!==1&&S.restore(),this._fillStroke(S,a)}},_fillStroke:function(a,p){var S=p.options;S.fill&&(a.globalAlpha=S.fillOpacity,a.fillStyle=S.fillColor||S.color,a.fill(S.fillRule||"evenodd")),S.stroke&&S.weight!==0&&(a.setLineDash&&a.setLineDash(p.options&&p.options._dashArray||[]),a.globalAlpha=S.opacity,a.lineWidth=S.weight,a.strokeStyle=S.color,a.lineCap=S.lineCap,a.lineJoin=S.lineJoin,a.stroke())},_onClick:function(a){for(var p=this._map.mouseEventToLayerPoint(a),S,V,ie=this._drawFirst;ie;ie=ie.next)S=ie.layer,S.options.interactive&&S._containsPoint(p)&&(!(a.type==="click"||a.type==="preclick")||!this._map._draggableMoved(S))&&(V=S);this._fireEvent(V?[V]:!1,a)},_onMouseMove:function(a){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var p=this._map.mouseEventToLayerPoint(a);this._handleMouseHover(a,p)}},_handleMouseOut:function(a){var p=this._hoveredLayer;p&&(_r(this._container,"leaflet-interactive"),this._fireEvent([p],a,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(a,p){if(!this._mouseHoverThrottled){for(var S,V,ie=this._drawFirst;ie;ie=ie.next)S=ie.layer,S.options.interactive&&S._containsPoint(p)&&(V=S);V!==this._hoveredLayer&&(this._handleMouseOut(a),V&&(Gn(this._container,"leaflet-interactive"),this._fireEvent([V],a,"mouseover"),this._hoveredLayer=V)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,a),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(a,p,S){this._map._fireDOMEvent(p,S||p.type,a)},_bringToFront:function(a){var p=a._order;if(p){var S=p.next,V=p.prev;if(S)S.prev=V;else return;V?V.next=S:S&&(this._drawFirst=S),p.prev=this._drawLast,this._drawLast.next=p,p.next=null,this._drawLast=p,this._requestRedraw(a)}},_bringToBack:function(a){var p=a._order;if(p){var S=p.next,V=p.prev;if(V)V.next=S;else return;S?S.prev=V:V&&(this._drawLast=V),p.prev=null,p.next=this._drawFirst,this._drawFirst.prev=p,this._drawFirst=p,this._requestRedraw(a)}}});function ds(a){return lt.canvas?new ks(a):null}var Bs=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return document.createElement("<lvml:"+a+' class="lvml">')}}catch{}return function(a){return document.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),xu={_initContainer:function(){this._container=hr("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Ri.prototype._update.call(this),this.fire("update"))},_initPath:function(a){var p=a._container=Bs("shape");Gn(p,"leaflet-vml-shape "+(this.options.className||"")),p.coordsize="1 1",a._path=Bs("path"),p.appendChild(a._path),this._updateStyle(a),this._layers[f(a)]=a},_addPath:function(a){var p=a._container;this._container.appendChild(p),a.options.interactive&&a.addInteractiveTarget(p)},_removePath:function(a){var p=a._container;qn(p),a.removeInteractiveTarget(p),delete this._layers[f(a)]},_updateStyle:function(a){var p=a._stroke,S=a._fill,V=a.options,ie=a._container;ie.stroked=!!V.stroke,ie.filled=!!V.fill,V.stroke?(p||(p=a._stroke=Bs("stroke")),ie.appendChild(p),p.weight=V.weight+"px",p.color=V.color,p.opacity=V.opacity,V.dashArray?p.dashStyle=Z(V.dashArray)?V.dashArray.join(" "):V.dashArray.replace(/( *, *)/g," "):p.dashStyle="",p.endcap=V.lineCap.replace("butt","flat"),p.joinstyle=V.lineJoin):p&&(ie.removeChild(p),a._stroke=null),V.fill?(S||(S=a._fill=Bs("fill")),ie.appendChild(S),S.color=V.fillColor||V.color,S.opacity=V.fillOpacity):S&&(ie.removeChild(S),a._fill=null)},_updateCircle:function(a){var p=a._point.round(),S=Math.round(a._radius),V=Math.round(a._radiusY||S);this._setPath(a,a._empty()?"M0 0":"AL "+p.x+","+p.y+" "+S+","+V+" 0,"+65535*360)},_setPath:function(a,p){a._path.v=p},_bringToFront:function(a){wo(a._container)},_bringToBack:function(a){Lr(a._container)}},ua=lt.vml?Bs:ye,go=Ri.extend({_initContainer:function(){this._container=ua("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=ua("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){qn(this._container),Nr(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ri.prototype._update.call(this);var a=this._bounds,p=a.getSize(),S=this._container;(!this._svgSize||!this._svgSize.equals(p))&&(this._svgSize=p,S.setAttribute("width",p.x),S.setAttribute("height",p.y)),Mi(S,a.min),S.setAttribute("viewBox",[a.min.x,a.min.y,p.x,p.y].join(" ")),this.fire("update")}},_initPath:function(a){var p=a._path=ua("path");a.options.className&&Gn(p,a.options.className),a.options.interactive&&Gn(p,"leaflet-interactive"),this._updateStyle(a),this._layers[f(a)]=a},_addPath:function(a){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(a._path),a.addInteractiveTarget(a._path)},_removePath:function(a){qn(a._path),a.removeInteractiveTarget(a._path),delete this._layers[f(a)]},_updatePath:function(a){a._project(),a._update()},_updateStyle:function(a){var p=a._path,S=a.options;p&&(S.stroke?(p.setAttribute("stroke",S.color),p.setAttribute("stroke-opacity",S.opacity),p.setAttribute("stroke-width",S.weight),p.setAttribute("stroke-linecap",S.lineCap),p.setAttribute("stroke-linejoin",S.lineJoin),S.dashArray?p.setAttribute("stroke-dasharray",S.dashArray):p.removeAttribute("stroke-dasharray"),S.dashOffset?p.setAttribute("stroke-dashoffset",S.dashOffset):p.removeAttribute("stroke-dashoffset")):p.setAttribute("stroke","none"),S.fill?(p.setAttribute("fill",S.fillColor||S.color),p.setAttribute("fill-opacity",S.fillOpacity),p.setAttribute("fill-rule",S.fillRule||"evenodd")):p.setAttribute("fill","none"))},_updatePoly:function(a,p){this._setPath(a,me(a._parts,p))},_updateCircle:function(a){var p=a._point,S=Math.max(Math.round(a._radius),1),V=Math.max(Math.round(a._radiusY),1)||S,ie="a"+S+","+V+" 0 1,0 ",Ce=a._empty()?"M0 0":"M"+(p.x-S)+","+p.y+ie+S*2+",0 "+ie+-S*2+",0 ";this._setPath(a,Ce)},_setPath:function(a,p){a._path.setAttribute("d",p)},_bringToFront:function(a){wo(a._path)},_bringToBack:function(a){Lr(a._path)}});lt.vml&&go.include(xu);function Oi(a){return lt.svg||lt.vml?new go(a):null}Xr.include({getRenderer:function(a){var p=a.options.renderer||this._getPaneRenderer(a.options.pane)||this.options.renderer||this._renderer;return p||(p=this._renderer=this._createRenderer()),this.hasLayer(p)||this.addLayer(p),p},_getPaneRenderer:function(a){if(a==="overlayPane"||a===void 0)return!1;var p=this._paneRenderers[a];return p===void 0&&(p=this._createRenderer({pane:a}),this._paneRenderers[a]=p),p},_createRenderer:function(a){return this.options.preferCanvas&&ds(a)||Oi(a)}});var qo=So.extend({initialize:function(a,p){So.prototype.initialize.call(this,this._boundsToLatLngs(a),p)},setBounds:function(a){return this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){return a=fe(a),[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});function ps(a,p){return new qo(a,p)}go.create=ua,go.pointsToPath=me,Uo.geometryToLayer=Vo,Uo.coordsToLatLng=La,Uo.coordsToLatLngs=Go,Uo.latLngToCoords=Ao,Uo.latLngsToCoords=ia,Uo.getFeature=As,Uo.asFeature=Ho,Xr.mergeOptions({boxZoom:!0});var pr=bi.extend({initialize:function(a){this._map=a,this._container=a._container,this._pane=a._panes.overlayPane,this._resetStateTimeout=0,a.on("unload",this._destroy,this)},addHooks:function(){br(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Nr(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){qn(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(a){if(!a.shiftKey||a.which!==1&&a.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Qo(),Fo(),this._startPoint=this._map.mouseEventToContainerPoint(a),br(document,{contextmenu:qr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(a){this._moved||(this._moved=!0,this._box=hr("div","leaflet-zoom-box",this._container),Gn(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(a);var p=new De(this._point,this._startPoint),S=p.getSize();Mi(this._box,p.min),this._box.style.width=S.x+"px",this._box.style.height=S.y+"px"},_finish:function(){this._moved&&(qn(this._box),_r(this._container,"leaflet-crosshair")),Ro(),eo(),Nr(document,{contextmenu:qr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(a){if(!(a.which!==1&&a.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var p=new ee(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(p).fire("boxzoomend",{boxZoomBounds:p})}},_onKeyDown:function(a){a.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Xr.addInitHook("addHandler","boxZoom",pr),Xr.mergeOptions({doubleClickZoom:!0});var Ca=bi.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var p=this._map,S=p.getZoom(),V=p.options.zoomDelta,ie=a.originalEvent.shiftKey?S-V:S+V;p.options.doubleClickZoom==="center"?p.setZoom(ie):p.setZoomAround(a.containerPoint,ie)}});Xr.addInitHook("addHandler","doubleClickZoom",Ca),Xr.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Ea=bi.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new Hs(a._mapPane,a._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),a.on("zoomend",this._onZoomEnd,this),a.whenReady(this._onZoomEnd,this))}Gn(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){_r(this._map._container,"leaflet-grab"),_r(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var a=this._map;if(a._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var p=fe(this._map.options.maxBounds);this._offsetLimit=N(this._map.latLngToContainerPoint(p.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(p.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;a.fire("movestart").fire("dragstart"),a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(a){if(this._map.options.inertia){var p=this._lastTime=+new Date,S=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(S),this._times.push(p),this._prunePositions(p)}this._map.fire("move",a).fire("drag",a)},_prunePositions:function(a){for(;this._positions.length>1&&a-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var a=this._map.getSize().divideBy(2),p=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=p.subtract(a).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(a,p){return a-(a-p)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var a=this._draggable._newPos.subtract(this._draggable._startPos),p=this._offsetLimit;a.x<p.min.x&&(a.x=this._viscousLimit(a.x,p.min.x)),a.y<p.min.y&&(a.y=this._viscousLimit(a.y,p.min.y)),a.x>p.max.x&&(a.x=this._viscousLimit(a.x,p.max.x)),a.y>p.max.y&&(a.y=this._viscousLimit(a.y,p.max.y)),this._draggable._newPos=this._draggable._startPos.add(a)}},_onPreDragWrap:function(){var a=this._worldWidth,p=Math.round(a/2),S=this._initialWorldOffset,V=this._draggable._newPos.x,ie=(V-p+S)%a+p-S,Ce=(V+p+S)%a-p-S,st=Math.abs(ie+S)<Math.abs(Ce+S)?ie:Ce;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=st},_onDragEnd:function(a){var p=this._map,S=p.options,V=!S.inertia||a.noInertia||this._times.length<2;if(p.fire("dragend",a),V)p.fire("moveend");else{this._prunePositions(+new Date);var ie=this._lastPos.subtract(this._positions[0]),Ce=(this._lastTime-this._times[0])/1e3,st=S.easeLinearity,Pt=ie.multiplyBy(st/Ce),Ut=Pt.distanceTo([0,0]),an=Math.min(S.inertiaMaxSpeed,Ut),Dn=Pt.multiplyBy(an/Ut),Xn=an/(S.inertiaDeceleration*st),zr=Dn.multiplyBy(-Xn/2).round();!zr.x&&!zr.y?p.fire("moveend"):(zr=p._limitOffset(zr,p.options.maxBounds),F(function(){p.panBy(zr,{duration:Xn,easeLinearity:st,noMoveStart:!0,animate:!0})}))}}});Xr.addInitHook("addHandler","dragging",Ea),Xr.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Zs=bi.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(a){this._map=a,this._setPanDelta(a.options.keyboardPanDelta),this._setZoomDelta(a.options.zoomDelta)},addHooks:function(){var a=this._map._container;a.tabIndex<=0&&(a.tabIndex="0"),br(a,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Nr(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var a=document.body,p=document.documentElement,S=a.scrollTop||p.scrollTop,V=a.scrollLeft||p.scrollLeft;this._map._container.focus(),window.scrollTo(V,S)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(a){var p=this._panKeys={},S=this.keyCodes,V,ie;for(V=0,ie=S.left.length;V<ie;V++)p[S.left[V]]=[-1*a,0];for(V=0,ie=S.right.length;V<ie;V++)p[S.right[V]]=[a,0];for(V=0,ie=S.down.length;V<ie;V++)p[S.down[V]]=[0,a];for(V=0,ie=S.up.length;V<ie;V++)p[S.up[V]]=[0,-1*a]},_setZoomDelta:function(a){var p=this._zoomKeys={},S=this.keyCodes,V,ie;for(V=0,ie=S.zoomIn.length;V<ie;V++)p[S.zoomIn[V]]=a;for(V=0,ie=S.zoomOut.length;V<ie;V++)p[S.zoomOut[V]]=-a},_addHooks:function(){br(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Nr(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var p=a.keyCode,S=this._map,V;if(p in this._panKeys){if(!S._panAnim||!S._panAnim._inProgress)if(V=this._panKeys[p],a.shiftKey&&(V=Le(V).multiplyBy(3)),S.options.maxBounds&&(V=S._limitOffset(Le(V),S.options.maxBounds)),S.options.worldCopyJump){var ie=S.wrapLatLng(S.unproject(S.project(S.getCenter()).add(V)));S.panTo(ie)}else S.panBy(V)}else if(p in this._zoomKeys)S.setZoom(S.getZoom()+(a.shiftKey?3:1)*this._zoomKeys[p]);else if(p===27&&S._popup&&S._popup.options.closeOnEscapeKey)S.closePopup();else return;qr(a)}}});Xr.addInitHook("addHandler","keyboard",Zs),Xr.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var is=bi.extend({addHooks:function(){br(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Nr(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(a){var p=Jl(a),S=this._map.options.wheelDebounceTime;this._delta+=p,this._lastMousePos=this._map.mouseEventToContainerPoint(a),this._startTime||(this._startTime=+new Date);var V=Math.max(S-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),V),qr(a)},_performZoom:function(){var a=this._map,p=a.getZoom(),S=this._map.options.zoomSnap||0;a._stop();var V=this._delta/(this._map.options.wheelPxPerZoomLevel*4),ie=4*Math.log(2/(1+Math.exp(-Math.abs(V))))/Math.LN2,Ce=S?Math.ceil(ie/S)*S:ie,st=a._limitZoom(p+(this._delta>0?Ce:-Ce))-p;this._delta=0,this._startTime=null,st&&(a.options.scrollWheelZoom==="center"?a.setZoom(p+st):a.setZoomAround(this._lastMousePos,p+st))}});Xr.addInitHook("addHandler","scrollWheelZoom",is);var bc=600;Xr.mergeOptions({tapHold:lt.touchNative&&lt.safari&&lt.mobile,tapTolerance:15});var To=bi.extend({addHooks:function(){br(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Nr(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(clearTimeout(this._holdTimeout),a.touches.length===1){var p=a.touches[0];this._startPos=this._newPos=new Y(p.clientX,p.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(br(document,"touchend",Sr),br(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",p))},this),bc),br(document,"touchend touchcancel contextmenu",this._cancel,this),br(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function a(){Nr(document,"touchend",Sr),Nr(document,"touchend touchcancel",a)},_cancel:function(){clearTimeout(this._holdTimeout),Nr(document,"touchend touchcancel contextmenu",this._cancel,this),Nr(document,"touchmove",this._onMove,this)},_onMove:function(a){var p=a.touches[0];this._newPos=new Y(p.clientX,p.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(a,p){var S=new MouseEvent(a,{bubbles:!0,cancelable:!0,view:window,screenX:p.screenX,screenY:p.screenY,clientX:p.clientX,clientY:p.clientY});S._simulated=!0,p.target.dispatchEvent(S)}});Xr.addInitHook("addHandler","tapHold",To),Xr.mergeOptions({touchZoom:lt.touch,bounceAtZoomLimits:!0});var No=bi.extend({addHooks:function(){Gn(this._map._container,"leaflet-touch-zoom"),br(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){_r(this._map._container,"leaflet-touch-zoom"),Nr(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var p=this._map;if(!(!a.touches||a.touches.length!==2||p._animatingZoom||this._zooming)){var S=p.mouseEventToContainerPoint(a.touches[0]),V=p.mouseEventToContainerPoint(a.touches[1]);this._centerPoint=p.getSize()._divideBy(2),this._startLatLng=p.containerPointToLatLng(this._centerPoint),p.options.touchZoom!=="center"&&(this._pinchStartLatLng=p.containerPointToLatLng(S.add(V)._divideBy(2))),this._startDist=S.distanceTo(V),this._startZoom=p.getZoom(),this._moved=!1,this._zooming=!0,p._stop(),br(document,"touchmove",this._onTouchMove,this),br(document,"touchend touchcancel",this._onTouchEnd,this),Sr(a)}},_onTouchMove:function(a){if(!(!a.touches||a.touches.length!==2||!this._zooming)){var p=this._map,S=p.mouseEventToContainerPoint(a.touches[0]),V=p.mouseEventToContainerPoint(a.touches[1]),ie=S.distanceTo(V)/this._startDist;if(this._zoom=p.getScaleZoom(ie,this._startZoom),!p.options.bounceAtZoomLimits&&(this._zoom<p.getMinZoom()&&ie<1||this._zoom>p.getMaxZoom()&&ie>1)&&(this._zoom=p._limitZoom(this._zoom)),p.options.touchZoom==="center"){if(this._center=this._startLatLng,ie===1)return}else{var Ce=S._add(V)._divideBy(2)._subtract(this._centerPoint);if(ie===1&&Ce.x===0&&Ce.y===0)return;this._center=p.unproject(p.project(this._pinchStartLatLng,this._zoom).subtract(Ce),this._zoom)}this._moved||(p._moveStart(!0,!1),this._moved=!0),B(this._animRequest);var st=o(p._move,p,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=F(st,this,!0),Sr(a)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,B(this._animRequest),Nr(document,"touchmove",this._onTouchMove,this),Nr(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Xr.addInitHook("addHandler","touchZoom",No),Xr.BoxZoom=pr,Xr.DoubleClickZoom=Ca,Xr.Drag=Ea,Xr.Keyboard=Zs,Xr.ScrollWheelZoom=is,Xr.TapHold=To,Xr.TouchZoom=No,n.Bounds=De,n.Browser=lt,n.CRS=se,n.Canvas=ks,n.Circle=$o,n.CircleMarker=hs,n.Class=$,n.Control=or,n.DivIcon=aa,n.DivOverlay=rs,n.DomEvent=kl,n.DomUtil=gr,n.Draggable=Hs,n.Evented=J,n.FeatureGroup=es,n.GeoJSON=Uo,n.GridLayer=Qr,n.Handler=bi,n.Icon=na,n.ImageOverlay=An,n.LatLng=ce,n.LatLngBounds=ee,n.Layer=Vr,n.LayerGroup=zo,n.LineUtil=Ur,n.Map=Xr,n.Marker=po,n.Mixin=Yu,n.Path=Ms,n.Point=Y,n.PolyUtil=cl,n.Polygon=So,n.Polyline=ns,n.Popup=Gi,n.PosAnimation=Xl,n.Projection=xi,n.Rectangle=qo,n.Renderer=Ri,n.SVG=go,n.SVGOverlay=Li,n.TileLayer=ko,n.Tooltip=Sa,n.Transformation=Pe,n.Util=R,n.VideoOverlay=wr,n.bind=o,n.bounds=N,n.canvas=ds,n.circle=ts,n.circleMarker=hl,n.control=ro,n.divIcon=la,n.extend=i,n.featureGroup=eu,n.geoJSON=Zt,n.geoJson=At,n.gridLayer=Ws,n.icon=wu,n.imageOverlay=Kn,n.latLng=_e,n.latLngBounds=fe,n.layerGroup=fl,n.map=no,n.marker=ra,n.point=Le,n.polygon=wa,n.polyline=Ju,n.popup=oa,n.rectangle=ps,n.setOptions=T,n.stamp=f,n.svg=Oi,n.svgOverlay=Ol,n.tileLayer=Si,n.tooltip=sa,n.transformation=Ge,n.version=r,n.videoOverlay=Vi;var Ks=window.L;n.noConflict=function(){return window.L=Ks,this},window.L=n})})(a1,a1.exports);var Rt=a1.exports;const Vn=fy(Rt);var ob={exports:{}};(function(e,t){(function(n,r){r(t)})(ea,function(n){var r=typeof window<"u"?window:typeof ea<"u"?ea:typeof self<"u"?self:{};function i(d,g){return d(g={exports:{}},g.exports),g.exports}var s=i(function(d,g){(function(y){const x={escape:function(W){return W.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},parseExtension:_,mimeType:function(W){return W=_(W).toLowerCase(),function(){var G="application/font-woff",J="image/jpeg";return{woff:G,woff2:G,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:J,jpeg:J,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}()[W]||""},dataAsUrl:function(W,G){return`data:${G};base64,`+W},isDataUrl:function(W){return W.search(/^(data:)/)!==-1},canvasToBlob:function(W){return W.toBlob?new Promise(function(J){W.toBlob(J)}):(G=W,new Promise(function(J){const Y=ge(G.toDataURL().split(",")[1]);var pe=Y.length;const Le=new Uint8Array(pe);for(let De=0;De<pe;De++)Le[De]=Y.charCodeAt(De);J(new Blob([Le],{type:"image/png"}))}));var G},resolveUrl:function(W,G){const J=document.implementation.createHTMLDocument(),Y=J.createElement("base"),pe=(J.head.appendChild(Y),J.createElement("a"));return J.body.appendChild(pe),Y.href=G,pe.href=W,pe.href},getAndEncode:function(W){let G=ue.impl.urlCache.find(function(J){return J.url===W});return G||(G={url:W,promise:null},ue.impl.urlCache.push(G)),G.promise===null&&(ue.impl.options.cacheBust&&(W+=(/\?/.test(W)?"&":"?")+new Date().getTime()),G.promise=new Promise(function(J){const Y=ue.impl.options.httpTimeout,pe=new XMLHttpRequest;let Le;var De;function N(ee){console.error(ee),J("")}pe.onreadystatechange=function(){if(pe.readyState===4)if(pe.status!==200)Le?J(Le):N(`cannot fetch resource: ${W}, status: `+pe.status);else{const ee=new FileReader;ee.onloadend=function(){var fe=ee.result.split(/,/)[1];J(fe)},ee.readAsDataURL(pe.response)}},pe.ontimeout=function(){Le?J(Le):N(`timeout of ${Y}ms occured while fetching resource: `+W)},pe.responseType="blob",pe.timeout=Y,ue.impl.options.useCredentials&&(pe.withCredentials=!0),pe.open("GET",W,!0),pe.send(),ue.impl.options.imagePlaceholder&&(De=ue.impl.options.imagePlaceholder.split(/,/))&&De[1]&&(Le=De[1])})),G.promise},uid:function(){let W=0;return function(){return"u"+("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+W++}}(),delay:function(W){return function(G){return new Promise(function(J){setTimeout(function(){J(G)},W)})}},asArray:function(W){const G=[],J=W.length;for(let Y=0;Y<J;Y++)G.push(W[Y]);return G},escapeXhtml:function(W){return W.replace(/%/g,"%25").replace(/#/g,"%23").replace(/\n/g,"%0A")},makeImage:function(W){return W!=="data:,"?new Promise(function(G,J){const Y=new Image;ue.impl.options.useCredentials&&(Y.crossOrigin="use-credentials"),Y.onload=function(){G(Y)},Y.onerror=J,Y.src=W}):Promise.resolve()},width:function(W){var G=M(W,"border-left-width"),J=M(W,"border-right-width");return W.scrollWidth+G+J},height:function(W){var G=M(W,"border-top-width"),J=M(W,"border-bottom-width");return W.scrollHeight+G+J}};function _(W){return(W=/\.([^\.\/]*?)(\?|$)/g.exec(W))?W[1]:""}function M(W,G){const J=le(W).getPropertyValue(G);return parseFloat(J.replace("px",""))}const T=function(){const W=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(pe,Le,De){return G(pe)?Promise.resolve(pe).then(J).then(function(N){let ee=Promise.resolve(pe);return N.forEach(function(fe){ee=ee.then(function(ce){return Y(ce,fe,Le,De)})}),ee}):Promise.resolve(pe)},shouldProcess:G,impl:{readUrls:J,inline:Y}};function G(pe){return pe.search(W)!==-1}function J(pe){const Le=[];for(var De;(De=W.exec(pe))!==null;)Le.push(De[1]);return Le.filter(function(N){return!x.isDataUrl(N)})}function Y(pe,Le,De,N){return Promise.resolve(Le).then(function(ee){return De?x.resolveUrl(ee,De):ee}).then(N||x.getAndEncode).then(function(ee){return x.dataAsUrl(ee,x.mimeType(Le))}).then(function(ee){return pe.replace((fe=Le,new RegExp(`(url\\(['"]?)(${x.escape(fe)})(['"]?\\))`,"g")),`$1${ee}$3`);var fe})}}(),D={resolveAll:function(){return I().then(function(W){return Promise.all(W.map(function(G){return G.resolve()}))}).then(function(W){return W.join(`
`)})},impl:{readAll:I}};function I(){return Promise.resolve(x.asArray(document.styleSheets)).then(function(G){const J=[];return G.forEach(function(Y){if(Object.getPrototypeOf(Y).hasOwnProperty("cssRules"))try{x.asArray(Y.cssRules||[]).forEach(J.push.bind(J))}catch(pe){console.log("Error while reading CSS rules from "+Y.href,pe.toString())}}),J}).then(function(G){return G.filter(function(J){return J.type===CSSRule.FONT_FACE_RULE}).filter(function(J){return T.shouldProcess(J.style.getPropertyValue("src"))})}).then(function(G){return G.map(W)});function W(G){return{resolve:function(){var J=(G.parentStyleSheet||{}).href;return T.inlineAll(G.cssText,J)},src:function(){return G.style.getPropertyValue("src")}}}}const j={inlineAll:function W(G){return G instanceof Element?function(J){const Y=J.style.getPropertyValue("background");return Y?T.inlineAll(Y).then(function(pe){J.style.setProperty("background",pe,Y)}).then(function(){return J}):Promise.resolve(J)}(G).then(function(){return G instanceof HTMLImageElement?Z(G).inline():Promise.all(x.asArray(G.childNodes).map(function(J){return W(J)}))}):Promise.resolve(G)},impl:{newImage:Z}};function Z(W){return{inline:function(G){return x.isDataUrl(W.src)?Promise.resolve():Promise.resolve(W.src).then(G||x.getAndEncode).then(function(J){return x.dataAsUrl(J,x.mimeType(W.src))}).then(function(J){return new Promise(function(Y){W.onload=Y,W.onerror=Y,W.src=J})})}}}const te={imagePlaceholder:void 0,cacheBust:!1,useCredentials:!1},ue={toSvg:H,toPng:function(W,G){return(G=G||{}).raster=!0,U(W,G).then(function(J){return J.toDataURL()})},toJpeg:function(W,G){return(G=G||{}).raster=!0,U(W,G).then(function(J){return J.toDataURL("image/jpeg",G.quality||1)})},toBlob:function(W,G){return(G=G||{}).raster=!0,U(W,G).then(x.canvasToBlob)},toPixelData:function(W,G){return(G=G||{}).raster=!0,U(W,G).then(function(J){return J.getContext("2d").getImageData(0,0,x.width(W),x.height(W)).data})},toCanvas:function(W,G){return(G=G||{}).raster=!0,U(W,G||{})},impl:{fontFaces:D,images:j,util:x,inliner:T,urlCache:[],options:{}}},le=(d.exports=ue,y.getComputedStyle||window.getComputedStyle),ge=y.atob||window.atob;function H(W,G){var J=G=G||{};return J.imagePlaceholder===void 0?ue.impl.options.imagePlaceholder=te.imagePlaceholder:ue.impl.options.imagePlaceholder=J.imagePlaceholder,J.cacheBust===void 0?ue.impl.options.cacheBust=te.cacheBust:ue.impl.options.cacheBust=J.cacheBust,J.useCredentials===void 0?ue.impl.options.useCredentials=te.useCredentials:ue.impl.options.useCredentials=J.useCredentials,Promise.resolve(W).then(function(Y){return function pe(Le,De,N,ee,fe=null){return N||!De||De(Le)?Promise.resolve(Le).then(function(ce){return ce instanceof HTMLCanvasElement?x.makeImage(ce.toDataURL()):ce.nodeName==="IFRAME"?html2canvas(ce.contentDocument.body).then(_e=>_e.toDataURL()).then(x.makeImage):ce.cloneNode(!1)}).then(function(ce){return function(_e,se){const k=_e.childNodes;return k.length===0?Promise.resolve(se):function(ae,ke){const Pe=le(_e);let Ge=Promise.resolve();return ke.forEach(function(K){Ge=Ge.then(function(){return pe(K,De,!1,ee,Pe)}).then(function(de){de&&ae.appendChild(de)})}),Ge}(se,x.asArray(k)).then(function(){return se})}(Le,ce)}).then(function(ce){return function(_e,se,k){return se instanceof Element?Promise.resolve().then(function(){(function(ae,ke){const Pe=le(ae);Pe.cssText?(ke.style.cssText=Pe.cssText,function(Ge,K){K.font=Ge.font,K.fontFamily=Ge.fontFamily,K.fontFeatureSettings=Ge.fontFeatureSettings,K.fontKerning=Ge.fontKerning,K.fontSize=Ge.fontSize,K.fontStretch=Ge.fontStretch,K.fontStyle=Ge.fontStyle,K.fontVariant=Ge.fontVariant,K.fontVariantCaps=Ge.fontVariantCaps,K.fontVariantEastAsian=Ge.fontVariantEastAsian,K.fontVariantLigatures=Ge.fontVariantLigatures,K.fontVariantNumeric=Ge.fontVariantNumeric,K.fontVariationSettings=Ge.fontVariationSettings,K.fontWeight=Ge.fontWeight}(Pe,ke.style)):(k?function(Ge,K,de,ye){const me=de.style,Ue=Ge.style;for(var Qe of K){var Ze=K.getPropertyValue(Qe),He=Ue.getPropertyValue(Qe),Xe=(Ue.setProperty(Qe,ye?"initial":"unset"),K.getPropertyValue(Qe));Xe!==Ze?me.setProperty(Qe,Ze):me.removeProperty(Qe),Ue.setProperty(Qe,He)}}(ae,Pe,ke,N):function(Ge,K,de){const ye=function(Ue){if($[Ue])return $[Ue];R||((R=document.createElement("iframe")).style.visibility="hidden",R.style.position="fixed",document.body.appendChild(R),R.contentWindow.document.write('<!DOCTYPE html><meta charset="UTF-8"><title>sandbox</title><body>'));const Qe=document.createElement(Ue),Ze=(R.contentWindow.document.body.appendChild(Qe),Qe.textContent=".",R.contentWindow.getComputedStyle(Qe)),He={};return x.asArray(Ze).forEach(function(Xe){He[Xe]=Xe==="width"||Xe==="height"?"auto":Ze.getPropertyValue(Xe)}),R.contentWindow.document.body.removeChild(Qe),$[Ue]=He}(de.tagName),me=de.style;x.asArray(Ge).forEach(function(Ue){var Qe=Ge.getPropertyValue(Ue);(Qe!==ye[Ue]||K&&Qe!==K.getPropertyValue(Ue))&&me.setProperty(Ue,Qe,Ge.getPropertyPriority(Ue))})}(Pe,fe,ke),N&&(["inset-block","inset-block-start","inset-block-end"].forEach(Ge=>ke.style.removeProperty(Ge)),["left","right","top","bottom"].forEach(Ge=>{ke.style.getPropertyValue(Ge)&&ke.style.setProperty(Ge,"0px")})))})(_e,se)}).then(function(){[":before",":after"].forEach(function(ae){(function(ke){const Pe=le(_e,ke),Ge=Pe.getPropertyValue("content");if(Ge!==""&&Ge!=="none"){const K=x.uid(),de=se.getAttribute("class"),ye=(de&&se.setAttribute("class",de+" "+K),document.createElement("style"));ye.appendChild(function(){const me=`.${K}:`+ke,Ue=(Pe.cssText?function(){return`${Pe.cssText} content: ${Pe.getPropertyValue("content")};`}:function(){return x.asArray(Pe).map(function(Qe){return Qe+": "+Pe.getPropertyValue(Qe)+(Pe.getPropertyPriority(Qe)?" !important":"")}).join("; ")+";"})();return document.createTextNode(me+`{${Ue}}`)}()),se.appendChild(ye)}})(ae)})}).then(function(){_e instanceof HTMLTextAreaElement&&(se.innerHTML=_e.value),_e instanceof HTMLInputElement&&se.setAttribute("value",_e.value)}).then(function(){se instanceof SVGElement&&(se.setAttribute("xmlns","http://www.w3.org/2000/svg"),se instanceof SVGRectElement&&["width","height"].forEach(function(ae){const ke=se.getAttribute(ae);ke&&se.style.setProperty(ae,ke)}))}).then(function(){return se}):se}(Le,ce,ee)}):Promise.resolve()}(Y,G.filter,!0,!G.raster)}).then(Q).then(F).then(function(Y){G.bgcolor&&(Y.style.backgroundColor=G.bgcolor),G.width&&(Y.style.width=G.width+"px"),G.height&&(Y.style.height=G.height+"px"),G.style&&Object.keys(G.style).forEach(function(Le){Y.style[Le]=G.style[Le]});let pe=null;return typeof G.onclone=="function"&&(pe=G.onclone(Y)),Promise.resolve(pe).then(function(){return Y})}).then(function(Y){return Y=Y,pe=G.width||x.width(W),Le=G.height||x.height(W),Promise.resolve(Y).then(function(De){return De.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(De)}).then(x.escapeXhtml).then(function(De){return`<foreignObject x="0" y="0" width="100%" height="100%">${De}</foreignObject>`}).then(function(De){return`<svg xmlns="http://www.w3.org/2000/svg" width="${pe}" height="${Le}">${De}</svg>`}).then(function(De){return"data:image/svg+xml;charset=utf-8,"+De});var pe,Le}).then(function(Y){return ue.impl.urlCache=[],Y})}function U(W,G){return H(W,G).then(x.makeImage).then(x.delay(0)).then(function(J){var Y=typeof G.scale!="number"?1:G.scale;const pe=function(De,N){const ee=document.createElement("canvas");if(ee.width=(G.width||x.width(De))*N,ee.height=(G.height||x.height(De))*N,G.bgcolor){const fe=ee.getContext("2d");fe.fillStyle=G.bgcolor,fe.fillRect(0,0,ee.width,ee.height)}return ee}(W,Y),Le=pe.getContext("2d");return Le.mozImageSmoothingEnabled=!1,Le.msImageSmoothingEnabled=!1,Le.imageSmoothingEnabled=!1,J&&(Le.scale(Y,Y),Le.drawImage(J,0,0)),R&&(document.body.removeChild(R),R=null,B&&clearTimeout(B),B=setTimeout(()=>{B=null,$={}},2e4)),pe})}function Q(W){return D.resolveAll().then(function(G){const J=document.createElement("style");return W.appendChild(J),J.appendChild(document.createTextNode(G)),W})}function F(W){return j.inlineAll(W).then(function(){return W})}let B=null,R=null,$={}})(r)}),o=i(function(d,g){(function(){function y(D,I,j){var Z=new XMLHttpRequest;Z.open("GET",D),Z.responseType="blob",Z.onload=function(){T(Z.response,I,j)},Z.onerror=function(){console.error("could not download file")},Z.send()}function x(D){var I=new XMLHttpRequest;I.open("HEAD",D,!1);try{I.send()}catch{}return 200<=I.status&&299>=I.status}function _(D){try{D.dispatchEvent(new MouseEvent("click"))}catch{var I=document.createEvent("MouseEvents");I.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),D.dispatchEvent(I)}}var M=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof r=="object"&&r.global===r?r:void 0,T=M.saveAs||(typeof window!="object"||window!==M?function(){}:"download"in HTMLAnchorElement.prototype?function(D,I,j){var Z=M.URL||M.webkitURL,te=document.createElement("a");I=I||D.name||"download",te.download=I,te.rel="noopener",typeof D=="string"?(te.href=D,te.origin===location.origin?_(te):x(te.href)?y(D,I,j):_(te,te.target="_blank")):(te.href=Z.createObjectURL(D),setTimeout(function(){Z.revokeObjectURL(te.href)},4e4),setTimeout(function(){_(te)},0))}:"msSaveOrOpenBlob"in navigator?function(D,I,j){if(I=I||D.name||"download",typeof D!="string")navigator.msSaveOrOpenBlob(function(te,ue){return ue===void 0?ue={autoBom:!1}:typeof ue!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),ue={autoBom:!ue}),ue.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(te.type)?new Blob(["\uFEFF",te],{type:te.type}):te}(D,j),I);else if(x(D))y(D,I,j);else{var Z=document.createElement("a");Z.href=D,Z.target="_blank",setTimeout(function(){_(Z)})}}:function(D,I,j,Z){if((Z=Z||open("","_blank"))&&(Z.document.title=Z.document.body.innerText="downloading..."),typeof D=="string")return y(D,I,j);var te=D.type==="application/octet-stream",ue=/constructor/i.test(M.HTMLElement)||M.safari,le=/CriOS\/[\d]+/.test(navigator.userAgent);if((le||te&&ue)&&typeof FileReader=="object"){var ge=new FileReader;ge.onloadend=function(){var Q=ge.result;Q=le?Q:Q.replace(/^data:[^;]*;/,"data:attachment/file;"),Z?Z.location.href=Q:location=Q,Z=null},ge.readAsDataURL(D)}else{var H=M.URL||M.webkitURL,U=H.createObjectURL(D);Z?Z.location=U:location.href=U,Z=null,setTimeout(function(){H.revokeObjectURL(U)},4e4)}});M.saveAs=T.saveAs=T,d.exports=T})()}),u=L.Control.extend({options:{cropImageByInnerWH:!0,hidden:!1,domtoimageOptions:{},position:"topleft",screenName:"screen",iconUrl:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/PjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDMyIDMyIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAzMiAzMjsiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxnPjxnIGlkPSJjYW1lcmEiPjxwYXRoIHN0eWxlPSJmaWxsOiMwMTAwMDI7IiBkPSJNMTYsOS41MDFjLTQuNDE5LDAtOCwzLjU4MS04LDhjMCw0LjQxOCwzLjU4MSw4LDgsOGM0LjQxOCwwLDgtMy41ODIsOC04UzIwLjQxOCw5LjUwMSwxNiw5LjUwMXogTTIwLjU1NSwyMS40MDZjLTIuMTU2LDIuNTE2LTUuOTQzLDIuODA3LTguNDU5LDAuNjVjLTIuNTE3LTIuMTU2LTIuODA3LTUuOTQ0LTAuNjUtOC40NTljMi4xNTUtMi41MTcsNS45NDMtMi44MDcsOC40NTktMC42NUMyMi40MiwxNS4xMDIsMjIuNzExLDE4Ljg5MSwyMC41NTUsMjEuNDA2eiIvPjxwYXRoIHN0eWxlPSJmaWxsOiMwMTAwMDI7IiBkPSJNMTYsMTMuNTAxYy0yLjIwOSwwLTMuOTk5LDEuNzkxLTQsMy45OTl2MC4wMDJjMCwwLjI3NSwwLjIyNCwwLjUsMC41LDAuNXMwLjUtMC4yMjUsMC41LTAuNVYxNy41YzAuMDAxLTEuNjU2LDEuMzQzLTIuOTk5LDMtMi45OTljMC4yNzYsMCwwLjUtMC4yMjQsMC41LTAuNVMxNi4yNzYsMTMuNTAxLDE2LDEzLjUwMXoiLz48cGF0aCBzdHlsZT0iZmlsbDojMDEwMDAyOyIgZD0iTTI5LjQ5Miw4LjU0MmwtNC4zMzQtMC43MjNsLTEuMzczLTMuNDM0QzIzLjMyNiwzLjI0LDIyLjIzMiwyLjUsMjEsMi41SDExYy0xLjIzMiwwLTIuMzI2LDAuNzQtMi43ODYsMS44ODZMNi44NDIsNy44MTlMMi41MDksOC41NDJDMS4wNTUsOC43ODMsMCwxMC4wMjcsMCwxMS41djE1YzAsMS42NTQsMS4zNDYsMywzLDNoMjZjMS42NTQsMCwzLTEuMzQ2LDMtM3YtMTVDMzIsMTAuMDI3LDMwLjk0NSw4Ljc4MywyOS40OTIsOC41NDJ6IE0zMCwyNi41YzAsMC41NTMtMC40NDcsMS0xLDFIM2MtMC41NTMsMC0xLTAuNDQ3LTEtMXYtMTVjMC0wLjQ4OSwwLjM1NC0wLjkwNiwwLjgzNi0wLjk4Nkw4LjI4LDkuNjA3bDEuNzkxLTQuNDc4QzEwLjIyNCw0Ljc1LDEwLjU5MSw0LjUsMTEsNC41aDEwYzAuNDA4LDAsMC43NzUsMC4yNDksMC45MjgsMC42MjlsMS43OTEsNC40NzhsNS40NDUsMC45MDdDMjkuNjQ2LDEwLjU5NCwzMCwxMS4wMTEsMzAsMTEuNVYyNi41eiIvPjwvZz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PC9zdmc+",hideElementsWithSelectors:[".leaflet-control-container"],onCropBorderSize:2,caption:null,captionFontSize:15,captionFont:"Arial",captionColor:"black",captionBgColor:"white",captionOffset:5,mimeType:"image/png",debugMode:!1,preventDownload:!1,onPixelDataFail:function(d){var g=d.node,y=d.error;return console.warn("Map node is very big "+g.scrollWidth+"x"+g.scrollHeight),console.warn(`Add function: SimpleMapScreenshoter({
              onPixelDataFail: function({ node, plugin, error, mapPane, domtoimageOptions }) {
                 // Solutions:
                 // decrease size of map
                 // or decrease zoom level
                 // or remove elements with big distanses
                 // and after that return image in Promise - plugin._getPixelDataOfNormalMap
                 return plugin._getPixelDataOfNormalMap(domtoimageOptions)
              }
            })`),Promise.reject(y)}},onAdd:function(){return this._container=L.DomUtil.create("div","leaflet-control-simpleMapScreenshoter"),this._link=null,this._screenState={status:1,promise:null},this.options.hidden===!1&&this._addScreenBtn(),this._onUserStartInteractWithMap=this._onUserStartInteractWithMap.bind(this),this._onUserEndInteractWithMap=this._onUserEndInteractWithMap.bind(this),this._map.on("zoomstart",this._onUserStartInteractWithMap),this._map.on("move",this._onUserStartInteractWithMap),this._map.on("zoomend",this._onUserEndInteractWithMap),this._map.on("moveend",this._onUserEndInteractWithMap),this._container},takeScreen:function(){var d=this,g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"blob",y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},x={};for(var _ in this.options)y.hasOwnProperty(_)?x[_]=y[_]:x[_]=this.options[_];return this._screenState.status===2?this._screenState.promise:(this._map.fire("simpleMapScreenshoter.takeScreen"),this._screenState.status=2,this._setElementsVisible(!1),this._screenState.promise=this._waitEndOfInteractions().then(function(){return d._getPixelData(x)}).then(function(M){return d._setElementsVisible(!0),d._toCanvas(M,x)}).then(function(M){return g==="image"?d._canvasToImage(M,x):g==="canvas"?M:d._canvasToBlob(M,x)}).then(function(M){return d._screenState.status=1,d._map.fire("simpleMapScreenshoter.done"),M}).catch(function(M){return d._setElementsVisible(!0),d._screenState.status=1,d._map.fire("simpleMapScreenshoter.error",{e:M}),Promise.reject(M)}),this._screenState.promise)},_setElementsVisible:function(){var d=this,g=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.options.hideElementsWithSelectors.forEach(function(y){var x=d._map._container.querySelectorAll(y),_=!0,M=!1,T=void 0;try{for(var D,I=x[Symbol.iterator]();!(_=(D=I.next()).done);_=!0)D.value.style.opacity=g===!1?0:1}catch(j){M=!0,T=j}finally{try{!_&&I.return&&I.return()}finally{if(M)throw T}}})},_canvasToImage:function(d,g){var y=g.mimeType,x=d.toDataURL(y);return x.indexOf("base64")===-1?Promise.reject(new Error("Base64 image generation error")):Promise.resolve(x)},_canvasToBlob:function(d,g){var y=g.mimeType;return new Promise(function(x,_){d.toBlob(function(M){x(M)},y)})},_toCanvas:function(d,g){var y=g.captionOffset,x=g.caption,_=g.captionFontSize,M=g.captionFont,T=g.captionColor,D=g.captionBgColor,I=this._node,j=I.screenHeight,Z=I.screenWidth,te=document.createElement("canvas");te.width=Z,te.height=j;for(var ue=te.getContext("2d"),le=ue.createImageData(Z,j),ge=0;ge<d.length;++ge)le.data[ge]=d[ge];ue.putImageData(le,0,0),le=null;var H=document.createElement("canvas"),U=H.getContext("2d"),Q=0,F=0,B=j,R=Z;if(this.options.cropImageByInnerWH===!0){for(var $=[],W=0,G=0;G<j;++G){W=0;for(var J=0;J<Z;++J)d[4*G*Z+4*J+4]===0&&W++;W===Z&&$.push(G)}var Y=this._getMinAndMaxOnValuesBreak($);Q=Y.min;for(var pe=Z,Le=Y.max,De=[],N=0,ee=F;ee<pe;++ee){N=0;for(var fe=0;fe<j;++fe)d[4*fe*Z+4*ee+4]===0&&N++;N===j&&De.push(ee)}var ce=this._getMinAndMaxOnValuesBreak(De);F=ce.min,pe=ce.max,(F===0&&pe===0||pe===null)&&(pe=Z),(Q===0&&Le===0||Le===null)&&(Le=j),this.options.debugMode===!0&&(console.log("emptyYLine",$),console.log("minMaxY",Y),console.log("emptyXLine",De),console.log("minMaxX",ce),console.log("debugX",{}),console.log("debugY",{})),Q===0&&Le===j&&F===0&&pe===Z||(Q+=this.options.onCropBorderSize,Le-=this.options.onCropBorderSize,F+=this.options.onCropBorderSize,pe-=this.options.onCropBorderSize),B=Le-Q,R=pe-F,H.width=R,H.height=B}else H.width=R,H.height=B;var _e=null;return x&&(_e=typeof x=="function"?x.call(this):x),_e!==null&&(H.height=H.height+(y+_+y),U.beginPath(),U.rect(0,0,H.width,H.height),U.fillStyle=D,U.fill(),U.save()),U.drawImage(te,F,Q,R,B,0,0,R,B),_e!==null&&(U.font=_+"px "+M,U.fillStyle=T,U.fillText(_e,y,B+y+_)),Promise.resolve(H)},_getMinAndMaxOnValuesBreak:function(d){for(var g=0,y=0,x=!1,_=1;_<d.length;_++){if(d[_]-1!==d[_-1]){y=d[_],x=!0;break}g=d[_]}return x===!1&&d[0]>1?(g=0,y=d[0]):x===!1&&(g=d[d.length-1]||0,y=null),{min:g,max:y}},_getPixelData:function(d){var g=this,y=d.domtoimageOptions,x=y===void 0?{}:y;return this._getPixelDataOfNormalMap(x).catch(function(_){return console.warn("May be map size very big on that zoom level, we have error:",_.toString()),console.warn("You can manually hide map elements with large distances between them for fix that warn"),g._getPixelDataOfBigMap(x)})},_getPixelDataOfNormalMap:function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=this._map.getContainer();return this._node={node:g,screenHeight:g.scrollHeight,screenWidth:g.scrollWidth},s.toPixelData(g,d)},_getPixelDataOfBigMap:function(){var d=this,g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},y=this._map.getContainer(),x=this._map.getPane("mapPane");x.style.width=2*y.clientWidth+"px",x.style.height=2*y.clientHeight+"px",x.style.overflow="hidden";var _=function(){x.style.width="initial",x.style.height="initial",x.style.overflow="initial"};return this._node={node:y,screenHeight:y.scrollHeight,screenWidth:y.scrollWidth},s.toPixelData(y,g).then(function(M){return _(),M}).catch(function(M){return _(),y.scrollHeight>=4e3||y.scrollWidth>=4e3?d.options.onPixelDataFail({plugin:d,node:y,mapPane:x,error:M,domtoimageOptions:g}):Promise.reject(M)})},_addScreenBtn:function(){this._link=L.DomUtil.create("a","leaflet-control-simpleMapScreenshoter-btn",this._container),this._addCss(),L.DomEvent.addListener(this._link,"click",this._onScreenBtn,this),L.DomEvent.disableClickPropagation(this._link)},_addCss:function(){var d=`
    .leaflet-control-simpleMapScreenshoter{
       border: 2px solid rgba(0,0,0,0.2);
       background-clip: padding-box;
    }
    .leaflet-control-simpleMapScreenshoter a{
       background-color: #fff;
       border-bottom: 1px solid #ccc;
       width: 30px;
       height: 30px;
       line-height: 30px;
       display: block;
       text-align: center;
       text-decoration: none;
       color: black;
       overflow: hidden;
       border-radius: 2px;
       background-image: url('`+this.options.iconUrl+`');
       background-position: 46% 41%;
       background-repeat: no-repeat;
       background-size: 63%;
    }
    .leaflet-control-simpleMapScreenshoter a:hover{
       cursor: pointer;
    }
    `,g=document.head||document.getElementsByTagName("head")[0],y=document.createElement("style");y.appendChild(document.createTextNode(d)),g.appendChild(y)},_onScreenBtn:function(){var d=this;this._map.fire("simpleMapScreenshoter.click"),this.options.preventDownload||this.takeScreen().then(function(g){var y=typeof d.options.screenName=="function"?d.options.screenName.call(d):d.options.screenName;o.saveAs(g,y+".png")}).catch(function(g){d._map.fire("simpleMapScreenshoter.error",{e:g})})},_onUserStartInteractWithMap:function(){this._interaction=!0},_onUserEndInteractWithMap:function(){this._interaction=!1},_waitEndOfInteractions:function(){var d=this;return new Promise(function(g){var y=setInterval(function(){d._interaction||(g(),clearInterval(y))},100)})}}),f=(L.Control.SimpleMapScreenshoter=u,L.simpleMapScreenshoter=function(d){return new L.Control.SimpleMapScreenshoter(d)},u);n.default=f,n.SimpleMapScreenshoter=u,Object.defineProperty(n,"__esModule",{value:!0})})})(ob,ob.exports);var Xa=63710088e-1,nx={centimeters:Xa*100,centimetres:Xa*100,degrees:360/(2*Math.PI),feet:Xa*3.28084,inches:Xa*39.37,kilometers:Xa/1e3,kilometres:Xa/1e3,meters:Xa,metres:Xa,miles:Xa/1609.344,millimeters:Xa*1e3,millimetres:Xa*1e3,nauticalmiles:Xa/1852,radians:1,yards:Xa*1.0936};function sd(e,t,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=e,r}function pm(e,t,n={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!sb(e[0])||!sb(e[1]))throw new Error("coordinates must contain numbers");return sd({type:"Point",coordinates:e},t,n)}function hu(e,t,n={}){for(const i of e){if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(i[i.length-1].length!==i[0].length)throw new Error("First and last Position are not equivalent.");for(let s=0;s<i[i.length-1].length;s++)if(i[i.length-1][s]!==i[0][s])throw new Error("First and last Position are not equivalent.")}return sd({type:"Polygon",coordinates:e},t,n)}function du(e,t,n={}){if(e.length<2)throw new Error("coordinates must be an array of two or more positions");return sd({type:"LineString",coordinates:e},t,n)}function FI(e,t={}){const n={type:"FeatureCollection"};return t.id&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.features=e,n}function jI(e,t,n={}){return sd({type:"MultiPolygon",coordinates:e},t,n)}function zI(e,t="kilometers"){const n=nx[t];if(!n)throw new Error(t+" units is invalid");return e*n}function $I(e,t="kilometers"){const n=nx[t];if(!n)throw new Error(t+" units is invalid");return e/n}function l1(e){return e%(2*Math.PI)*180/Math.PI}function zu(e){return e%360*Math.PI/180}function sb(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function ab(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function UI(e){return e.type==="Feature"?e.geometry:e}function rx(e,t,n={}){if(n.final===!0)return VI(e,t);const r=ab(e),i=ab(t),s=zu(r[0]),o=zu(i[0]),u=zu(r[1]),f=zu(i[1]),d=Math.sin(o-s)*Math.cos(f),g=Math.cos(u)*Math.sin(f)-Math.sin(u)*Math.cos(f)*Math.cos(o-s);return l1(Math.atan2(d,g))}function VI(e,t){let n=rx(t,e);return n=(n+180)%360,n}function GI(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function hy(e,t,n,r={}){const i=GI(e),s=zu(i[0]),o=zu(i[1]),u=zu(n),f=$I(t,r.units),d=Math.asin(Math.sin(o)*Math.cos(f)+Math.cos(o)*Math.sin(f)*Math.cos(u)),g=s+Math.atan2(Math.sin(u)*Math.sin(f)*Math.cos(o),Math.cos(f)-Math.sin(o)*Math.sin(d)),y=l1(g),x=l1(d);return pm([y,x],r.properties)}var lb=hy;function ub(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function dy(e,t,n={}){var r=ub(e),i=ub(t),s=zu(i[1]-r[1]),o=zu(i[0]-r[0]),u=zu(r[1]),f=zu(i[1]),d=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(o/2),2)*Math.cos(u)*Math.cos(f);return zI(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)),n.units)}var rv=dy;function HI(e,t,n={}){const i=UI(e).coordinates;let s=0;for(let o=0;o<i.length&&!(t>=s&&o===i.length-1);o++)if(s>=t){const u=t-s;if(u){const f=rx(i[o],i[o-1])-180;return hy(i[o],u,f,n)}else return pm(i[o])}else s+=dy(i[o],i[o+1],n);return pm(i[i.length-1])}var u1=HI;function qI(e,t){var n,r,i,s,o,u,f,d,g,y,x=0,_=e.type==="FeatureCollection",M=e.type==="Feature",T=_?e.features.length:1;for(n=0;n<T;n++){for(u=_?e.features[n].geometry:M?e.geometry:e,d=_?e.features[n].properties:M?e.properties:{},g=_?e.features[n].bbox:M?e.bbox:void 0,y=_?e.features[n].id:M?e.id:void 0,f=u?u.type==="GeometryCollection":!1,o=f?u.geometries.length:1,i=0;i<o;i++){if(s=f?u.geometries[i]:u,s===null){if(t(null,x,d,g,y)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(s,x,d,g,y)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<s.geometries.length;r++)if(t(s.geometries[r],x,d,g,y)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}x++}}function WI(e,t,n){var r=n;return qI(e,function(i,s,o,u,f){s===0&&n===void 0?r=i:r=t(r,i,s,o,u,f)}),r}function ix(e){return WI(e,(t,n)=>t+ZI(n),0)}function ZI(e){let t=0,n;switch(e.type){case"Polygon":return cb(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)t+=cb(e.coordinates[n]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function cb(e){let t=0;if(e&&e.length>0){t+=Math.abs(fb(e[0]));for(let n=1;n<e.length;n++)t-=Math.abs(fb(e[n]))}return t}var KI=Xa*Xa/2,iv=Math.PI/180;function fb(e){const t=e.length-1;if(t<=2)return 0;let n=0,r=0;for(;r<t;){const i=e[r],s=e[r+1===t?0:r+1],o=e[r+2>=t?(r+2)%t:r+2],u=i[0]*iv,f=s[1]*iv,d=o[0]*iv;n+=(d-u)*Math.sin(f),r++}return n*KI}var ic=ix;function ox(e,t,n){if(e!==null)for(var r,i,s,o,u,f,d,g=0,y=0,x,_=e.type,M=_==="FeatureCollection",T=_==="Feature",D=M?e.features.length:1,I=0;I<D;I++){d=M?e.features[I].geometry:T?e.geometry:e,x=d?d.type==="GeometryCollection":!1,u=x?d.geometries.length:1;for(var j=0;j<u;j++){var Z=0,te=0;if(o=x?d.geometries[j]:d,o!==null){f=o.coordinates;var ue=o.type;switch(g=ue==="Polygon"||ue==="MultiPolygon"?1:0,ue){case null:break;case"Point":if(t(f,y,I,Z,te)===!1)return!1;y++,Z++;break;case"LineString":case"MultiPoint":for(r=0;r<f.length;r++){if(t(f[r],y,I,Z,te)===!1)return!1;y++,ue==="MultiPoint"&&Z++}ue==="LineString"&&Z++;break;case"Polygon":case"MultiLineString":for(r=0;r<f.length;r++){for(i=0;i<f[r].length-g;i++){if(t(f[r][i],y,I,Z,te)===!1)return!1;y++}ue==="MultiLineString"&&Z++,ue==="Polygon"&&te++}ue==="Polygon"&&Z++;break;case"MultiPolygon":for(r=0;r<f.length;r++){for(te=0,i=0;i<f[r].length;i++){for(s=0;s<f[r][i].length-g;s++){if(t(f[r][i][s],y,I,Z,te)===!1)return!1;y++}te++}Z++}break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(ox(o.geometries[r],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function YI(e,t={}){let n=0,r=0,i=0;return ox(e,function(s){n+=s[0],r+=s[1],i++}),pm([n/i,r/i],t.properties)}var op=YI;function JI(e,t,n={}){const r=n.steps||64,i=n.properties?n.properties:!Array.isArray(e)&&e.type==="Feature"&&e.properties?e.properties:{},s=[];for(let o=0;o<r;o++)s.push(hy(e,t,o*-360/r,n).geometry.coordinates);return s.push(s[0]),hu([s],i)}var XI=JI,QI=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,ov=Math.ceil,cu=Math.floor,wl="[BigNumber Error] ",hb=wl+"Number primitive has more than 15 significant digits: ",Tu=1e14,ni=14,db=9007199254740991,sv=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],nf=1e7,zl=1e9;function sx(e){var t,n,r,i=j.prototype={constructor:j,toString:null,valueOf:null},s=new j(1),o=20,u=4,f=-7,d=21,g=-1e7,y=1e7,x=!1,_=1,M=0,T={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},D="0123456789abcdefghijklmnopqrstuvwxyz",I=!0;function j(H,U){var Q,F,B,R,$,W,G,J,Y=this;if(!(Y instanceof j))return new j(H,U);if(U==null){if(H&&H._isBigNumber===!0){Y.s=H.s,!H.c||H.e>y?Y.c=Y.e=null:H.e<g?Y.c=[Y.e=0]:(Y.e=H.e,Y.c=H.c.slice());return}if((W=typeof H=="number")&&H*0==0){if(Y.s=1/H<0?(H=-H,-1):1,H===~~H){for(R=0,$=H;$>=10;$/=10,R++);R>y?Y.c=Y.e=null:(Y.e=R,Y.c=[H]);return}J=String(H)}else{if(!QI.test(J=String(H)))return r(Y,J,W);Y.s=J.charCodeAt(0)==45?(J=J.slice(1),-1):1}(R=J.indexOf("."))>-1&&(J=J.replace(".","")),($=J.search(/e/i))>0?(R<0&&(R=$),R+=+J.slice($+1),J=J.substring(0,$)):R<0&&(R=J.length)}else{if(Yo(U,2,D.length,"Base"),U==10&&I)return Y=new j(H),le(Y,o+Y.e+1,u);if(J=String(H),W=typeof H=="number"){if(H*0!=0)return r(Y,J,W,U);if(Y.s=1/H<0?(J=J.slice(1),-1):1,j.DEBUG&&J.replace(/^0\.0*|\./,"").length>15)throw Error(hb+H)}else Y.s=J.charCodeAt(0)===45?(J=J.slice(1),-1):1;for(Q=D.slice(0,U),R=$=0,G=J.length;$<G;$++)if(Q.indexOf(F=J.charAt($))<0){if(F=="."){if($>R){R=G;continue}}else if(!B&&(J==J.toUpperCase()&&(J=J.toLowerCase())||J==J.toLowerCase()&&(J=J.toUpperCase()))){B=!0,$=-1,R=0;continue}return r(Y,String(H),W,U)}W=!1,J=n(J,U,10,Y.s),(R=J.indexOf("."))>-1?J=J.replace(".",""):R=J.length}for($=0;J.charCodeAt($)===48;$++);for(G=J.length;J.charCodeAt(--G)===48;);if(J=J.slice($,++G)){if(G-=$,W&&j.DEBUG&&G>15&&(H>db||H!==cu(H)))throw Error(hb+Y.s*H);if((R=R-$-1)>y)Y.c=Y.e=null;else if(R<g)Y.c=[Y.e=0];else{if(Y.e=R,Y.c=[],$=(R+1)%ni,R<0&&($+=ni),$<G){for($&&Y.c.push(+J.slice(0,$)),G-=ni;$<G;)Y.c.push(+J.slice($,$+=ni));$=ni-(J=J.slice($)).length}else $-=G;for(;$--;J+="0");Y.c.push(+J)}}else Y.c=[Y.e=0]}j.clone=sx,j.ROUND_UP=0,j.ROUND_DOWN=1,j.ROUND_CEIL=2,j.ROUND_FLOOR=3,j.ROUND_HALF_UP=4,j.ROUND_HALF_DOWN=5,j.ROUND_HALF_EVEN=6,j.ROUND_HALF_CEIL=7,j.ROUND_HALF_FLOOR=8,j.EUCLID=9,j.config=j.set=function(H){var U,Q;if(H!=null)if(typeof H=="object"){if(H.hasOwnProperty(U="DECIMAL_PLACES")&&(Q=H[U],Yo(Q,0,zl,U),o=Q),H.hasOwnProperty(U="ROUNDING_MODE")&&(Q=H[U],Yo(Q,0,8,U),u=Q),H.hasOwnProperty(U="EXPONENTIAL_AT")&&(Q=H[U],Q&&Q.pop?(Yo(Q[0],-1e9,0,U),Yo(Q[1],0,zl,U),f=Q[0],d=Q[1]):(Yo(Q,-1e9,zl,U),f=-(d=Q<0?-Q:Q))),H.hasOwnProperty(U="RANGE"))if(Q=H[U],Q&&Q.pop)Yo(Q[0],-1e9,-1,U),Yo(Q[1],1,zl,U),g=Q[0],y=Q[1];else if(Yo(Q,-1e9,zl,U),Q)g=-(y=Q<0?-Q:Q);else throw Error(wl+U+" cannot be zero: "+Q);if(H.hasOwnProperty(U="CRYPTO"))if(Q=H[U],Q===!!Q)if(Q)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))x=Q;else throw x=!Q,Error(wl+"crypto unavailable");else x=Q;else throw Error(wl+U+" not true or false: "+Q);if(H.hasOwnProperty(U="MODULO_MODE")&&(Q=H[U],Yo(Q,0,9,U),_=Q),H.hasOwnProperty(U="POW_PRECISION")&&(Q=H[U],Yo(Q,0,zl,U),M=Q),H.hasOwnProperty(U="FORMAT"))if(Q=H[U],typeof Q=="object")T=Q;else throw Error(wl+U+" not an object: "+Q);if(H.hasOwnProperty(U="ALPHABET"))if(Q=H[U],typeof Q=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(Q))I=Q.slice(0,10)=="0123456789",D=Q;else throw Error(wl+U+" invalid: "+Q)}else throw Error(wl+"Object expected: "+H);return{DECIMAL_PLACES:o,ROUNDING_MODE:u,EXPONENTIAL_AT:[f,d],RANGE:[g,y],CRYPTO:x,MODULO_MODE:_,POW_PRECISION:M,FORMAT:T,ALPHABET:D}},j.isBigNumber=function(H){if(!H||H._isBigNumber!==!0)return!1;if(!j.DEBUG)return!0;var U,Q,F=H.c,B=H.e,R=H.s;e:if({}.toString.call(F)=="[object Array]"){if((R===1||R===-1)&&B>=-1e9&&B<=zl&&B===cu(B)){if(F[0]===0){if(B===0&&F.length===1)return!0;break e}if(U=(B+1)%ni,U<1&&(U+=ni),String(F[0]).length==U){for(U=0;U<F.length;U++)if(Q=F[U],Q<0||Q>=Tu||Q!==cu(Q))break e;if(Q!==0)return!0}}}else if(F===null&&B===null&&(R===null||R===1||R===-1))return!0;throw Error(wl+"Invalid BigNumber: "+H)},j.maximum=j.max=function(){return te(arguments,-1)},j.minimum=j.min=function(){return te(arguments,1)},j.random=function(){var H=9007199254740992,U=Math.random()*H&2097151?function(){return cu(Math.random()*H)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(Q){var F,B,R,$,W,G=0,J=[],Y=new j(s);if(Q==null?Q=o:Yo(Q,0,zl),$=ov(Q/ni),x)if(crypto.getRandomValues){for(F=crypto.getRandomValues(new Uint32Array($*=2));G<$;)W=F[G]*131072+(F[G+1]>>>11),W>=9e15?(B=crypto.getRandomValues(new Uint32Array(2)),F[G]=B[0],F[G+1]=B[1]):(J.push(W%1e14),G+=2);G=$/2}else if(crypto.randomBytes){for(F=crypto.randomBytes($*=7);G<$;)W=(F[G]&31)*281474976710656+F[G+1]*1099511627776+F[G+2]*4294967296+F[G+3]*16777216+(F[G+4]<<16)+(F[G+5]<<8)+F[G+6],W>=9e15?crypto.randomBytes(7).copy(F,G):(J.push(W%1e14),G+=7);G=$/7}else throw x=!1,Error(wl+"crypto unavailable");if(!x)for(;G<$;)W=U(),W<9e15&&(J[G++]=W%1e14);for($=J[--G],Q%=ni,$&&Q&&(W=sv[ni-Q],J[G]=cu($/W)*W);J[G]===0;J.pop(),G--);if(G<0)J=[R=0];else{for(R=-1;J[0]===0;J.splice(0,1),R-=ni);for(G=1,W=J[0];W>=10;W/=10,G++);G<ni&&(R-=ni-G)}return Y.e=R,Y.c=J,Y}}(),j.sum=function(){for(var H=1,U=arguments,Q=new j(U[0]);H<U.length;)Q=Q.plus(U[H++]);return Q},n=function(){var H="0123456789";function U(Q,F,B,R){for(var $,W=[0],G,J=0,Y=Q.length;J<Y;){for(G=W.length;G--;W[G]*=F);for(W[0]+=R.indexOf(Q.charAt(J++)),$=0;$<W.length;$++)W[$]>B-1&&(W[$+1]==null&&(W[$+1]=0),W[$+1]+=W[$]/B|0,W[$]%=B)}return W.reverse()}return function(Q,F,B,R,$){var W,G,J,Y,pe,Le,De,N,ee=Q.indexOf("."),fe=o,ce=u;for(ee>=0&&(Y=M,M=0,Q=Q.replace(".",""),N=new j(F),Le=N.pow(Q.length-ee),M=Y,N.c=U(Ic(lu(Le.c),Le.e,"0"),10,B,H),N.e=N.c.length),De=U(Q,F,B,$?(W=D,H):(W=H,D)),J=Y=De.length;De[--Y]==0;De.pop());if(!De[0])return W.charAt(0);if(ee<0?--J:(Le.c=De,Le.e=J,Le.s=R,Le=t(Le,N,fe,ce,B),De=Le.c,pe=Le.r,J=Le.e),G=J+fe+1,ee=De[G],Y=B/2,pe=pe||G<0||De[G+1]!=null,pe=ce<4?(ee!=null||pe)&&(ce==0||ce==(Le.s<0?3:2)):ee>Y||ee==Y&&(ce==4||pe||ce==6&&De[G-1]&1||ce==(Le.s<0?8:7)),G<1||!De[0])Q=pe?Ic(W.charAt(1),-fe,W.charAt(0)):W.charAt(0);else{if(De.length=G,pe)for(--B;++De[--G]>B;)De[G]=0,G||(++J,De=[1].concat(De));for(Y=De.length;!De[--Y];);for(ee=0,Q="";ee<=Y;Q+=W.charAt(De[ee++]));Q=Ic(Q,J,W.charAt(0))}return Q}}(),t=function(){function H(F,B,R){var $,W,G,J,Y=0,pe=F.length,Le=B%nf,De=B/nf|0;for(F=F.slice();pe--;)G=F[pe]%nf,J=F[pe]/nf|0,$=De*G+J*Le,W=Le*G+$%nf*nf+Y,Y=(W/R|0)+($/nf|0)+De*J,F[pe]=W%R;return Y&&(F=[Y].concat(F)),F}function U(F,B,R,$){var W,G;if(R!=$)G=R>$?1:-1;else for(W=G=0;W<R;W++)if(F[W]!=B[W]){G=F[W]>B[W]?1:-1;break}return G}function Q(F,B,R,$){for(var W=0;R--;)F[R]-=W,W=F[R]<B[R]?1:0,F[R]=W*$+F[R]-B[R];for(;!F[0]&&F.length>1;F.splice(0,1));}return function(F,B,R,$,W){var G,J,Y,pe,Le,De,N,ee,fe,ce,_e,se,k,ae,ke,Pe,Ge,K=F.s==B.s?1:-1,de=F.c,ye=B.c;if(!de||!de[0]||!ye||!ye[0])return new j(!F.s||!B.s||(de?ye&&de[0]==ye[0]:!ye)?NaN:de&&de[0]==0||!ye?K*0:K/0);for(ee=new j(K),fe=ee.c=[],J=F.e-B.e,K=R+J+1,W||(W=Tu,J=fu(F.e/ni)-fu(B.e/ni),K=K/ni|0),Y=0;ye[Y]==(de[Y]||0);Y++);if(ye[Y]>(de[Y]||0)&&J--,K<0)fe.push(1),pe=!0;else{for(ae=de.length,Pe=ye.length,Y=0,K+=2,Le=cu(W/(ye[0]+1)),Le>1&&(ye=H(ye,Le,W),de=H(de,Le,W),Pe=ye.length,ae=de.length),k=Pe,ce=de.slice(0,Pe),_e=ce.length;_e<Pe;ce[_e++]=0);Ge=ye.slice(),Ge=[0].concat(Ge),ke=ye[0],ye[1]>=W/2&&ke++;do{if(Le=0,G=U(ye,ce,Pe,_e),G<0){if(se=ce[0],Pe!=_e&&(se=se*W+(ce[1]||0)),Le=cu(se/ke),Le>1)for(Le>=W&&(Le=W-1),De=H(ye,Le,W),N=De.length,_e=ce.length;U(De,ce,N,_e)==1;)Le--,Q(De,Pe<N?Ge:ye,N,W),N=De.length,G=1;else Le==0&&(G=Le=1),De=ye.slice(),N=De.length;if(N<_e&&(De=[0].concat(De)),Q(ce,De,_e,W),_e=ce.length,G==-1)for(;U(ye,ce,Pe,_e)<1;)Le++,Q(ce,Pe<_e?Ge:ye,_e,W),_e=ce.length}else G===0&&(Le++,ce=[0]);fe[Y++]=Le,ce[0]?ce[_e++]=de[k]||0:(ce=[de[k]],_e=1)}while((k++<ae||ce[0]!=null)&&K--);pe=ce[0]!=null,fe[0]||fe.splice(0,1)}if(W==Tu){for(Y=1,K=fe[0];K>=10;K/=10,Y++);le(ee,R+(ee.e=Y+J*ni-1)+1,$,pe)}else ee.e=J,ee.r=+pe;return ee}}();function Z(H,U,Q,F){var B,R,$,W,G;if(Q==null?Q=u:Yo(Q,0,8),!H.c)return H.toString();if(B=H.c[0],$=H.e,U==null)G=lu(H.c),G=F==1||F==2&&($<=f||$>=d)?_g(G,$):Ic(G,$,"0");else if(H=le(new j(H),U,Q),R=H.e,G=lu(H.c),W=G.length,F==1||F==2&&(U<=R||R<=f)){for(;W<U;G+="0",W++);G=_g(G,R)}else if(U-=$,G=Ic(G,R,"0"),R+1>W){if(--U>0)for(G+=".";U--;G+="0");}else if(U+=R-W,U>0)for(R+1==W&&(G+=".");U--;G+="0");return H.s<0&&B?"-"+G:G}function te(H,U){for(var Q,F,B=1,R=new j(H[0]);B<H.length;B++)F=new j(H[B]),(!F.s||(Q=Uf(R,F))===U||Q===0&&R.s===U)&&(R=F);return R}function ue(H,U,Q){for(var F=1,B=U.length;!U[--B];U.pop());for(B=U[0];B>=10;B/=10,F++);return(Q=F+Q*ni-1)>y?H.c=H.e=null:Q<g?H.c=[H.e=0]:(H.e=Q,H.c=U),H}r=function(){var H=/^(-?)0([xbo])(?=\w[\w.]*$)/i,U=/^([^.]+)\.$/,Q=/^\.([^.]+)$/,F=/^-?(Infinity|NaN)$/,B=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(R,$,W,G){var J,Y=W?$:$.replace(B,"");if(F.test(Y))R.s=isNaN(Y)?null:Y<0?-1:1;else{if(!W&&(Y=Y.replace(H,function(pe,Le,De){return J=(De=De.toLowerCase())=="x"?16:De=="b"?2:8,!G||G==J?Le:pe}),G&&(J=G,Y=Y.replace(U,"$1").replace(Q,"0.$1")),$!=Y))return new j(Y,J);if(j.DEBUG)throw Error(wl+"Not a"+(G?" base "+G:"")+" number: "+$);R.s=null}R.c=R.e=null}}();function le(H,U,Q,F){var B,R,$,W,G,J,Y,pe=H.c,Le=sv;if(pe){e:{for(B=1,W=pe[0];W>=10;W/=10,B++);if(R=U-B,R<0)R+=ni,$=U,G=pe[J=0],Y=cu(G/Le[B-$-1]%10);else if(J=ov((R+1)/ni),J>=pe.length)if(F){for(;pe.length<=J;pe.push(0));G=Y=0,B=1,R%=ni,$=R-ni+1}else break e;else{for(G=W=pe[J],B=1;W>=10;W/=10,B++);R%=ni,$=R-ni+B,Y=$<0?0:cu(G/Le[B-$-1]%10)}if(F=F||U<0||pe[J+1]!=null||($<0?G:G%Le[B-$-1]),F=Q<4?(Y||F)&&(Q==0||Q==(H.s<0?3:2)):Y>5||Y==5&&(Q==4||F||Q==6&&(R>0?$>0?G/Le[B-$]:0:pe[J-1])%10&1||Q==(H.s<0?8:7)),U<1||!pe[0])return pe.length=0,F?(U-=H.e+1,pe[0]=Le[(ni-U%ni)%ni],H.e=-U||0):pe[0]=H.e=0,H;if(R==0?(pe.length=J,W=1,J--):(pe.length=J+1,W=Le[ni-R],pe[J]=$>0?cu(G/Le[B-$]%Le[$])*W:0),F)for(;;)if(J==0){for(R=1,$=pe[0];$>=10;$/=10,R++);for($=pe[0]+=W,W=1;$>=10;$/=10,W++);R!=W&&(H.e++,pe[0]==Tu&&(pe[0]=1));break}else{if(pe[J]+=W,pe[J]!=Tu)break;pe[J--]=0,W=1}for(R=pe.length;pe[--R]===0;pe.pop());}H.e>y?H.c=H.e=null:H.e<g&&(H.c=[H.e=0])}return H}function ge(H){var U,Q=H.e;return Q===null?H.toString():(U=lu(H.c),U=Q<=f||Q>=d?_g(U,Q):Ic(U,Q,"0"),H.s<0?"-"+U:U)}return i.absoluteValue=i.abs=function(){var H=new j(this);return H.s<0&&(H.s=1),H},i.comparedTo=function(H,U){return Uf(this,new j(H,U))},i.decimalPlaces=i.dp=function(H,U){var Q,F,B,R=this;if(H!=null)return Yo(H,0,zl),U==null?U=u:Yo(U,0,8),le(new j(R),H+R.e+1,U);if(!(Q=R.c))return null;if(F=((B=Q.length-1)-fu(this.e/ni))*ni,B=Q[B])for(;B%10==0;B/=10,F--);return F<0&&(F=0),F},i.dividedBy=i.div=function(H,U){return t(this,new j(H,U),o,u)},i.dividedToIntegerBy=i.idiv=function(H,U){return t(this,new j(H,U),0,1)},i.exponentiatedBy=i.pow=function(H,U){var Q,F,B,R,$,W,G,J,Y,pe=this;if(H=new j(H),H.c&&!H.isInteger())throw Error(wl+"Exponent not an integer: "+ge(H));if(U!=null&&(U=new j(U)),W=H.e>14,!pe.c||!pe.c[0]||pe.c[0]==1&&!pe.e&&pe.c.length==1||!H.c||!H.c[0])return Y=new j(Math.pow(+ge(pe),W?H.s*(2-yg(H)):+ge(H))),U?Y.mod(U):Y;if(G=H.s<0,U){if(U.c?!U.c[0]:!U.s)return new j(NaN);F=!G&&pe.isInteger()&&U.isInteger(),F&&(pe=pe.mod(U))}else{if(H.e>9&&(pe.e>0||pe.e<-1||(pe.e==0?pe.c[0]>1||W&&pe.c[1]>=24e7:pe.c[0]<8e13||W&&pe.c[0]<=9999975e7)))return R=pe.s<0&&yg(H)?-0:0,pe.e>-1&&(R=1/R),new j(G?1/R:R);M&&(R=ov(M/ni+2))}for(W?(Q=new j(.5),G&&(H.s=1),J=yg(H)):(B=Math.abs(+ge(H)),J=B%2),Y=new j(s);;){if(J){if(Y=Y.times(pe),!Y.c)break;R?Y.c.length>R&&(Y.c.length=R):F&&(Y=Y.mod(U))}if(B){if(B=cu(B/2),B===0)break;J=B%2}else if(H=H.times(Q),le(H,H.e+1,1),H.e>14)J=yg(H);else{if(B=+ge(H),B===0)break;J=B%2}pe=pe.times(pe),R?pe.c&&pe.c.length>R&&(pe.c.length=R):F&&(pe=pe.mod(U))}return F?Y:(G&&(Y=s.div(Y)),U?Y.mod(U):R?le(Y,M,u,$):Y)},i.integerValue=function(H){var U=new j(this);return H==null?H=u:Yo(H,0,8),le(U,U.e+1,H)},i.isEqualTo=i.eq=function(H,U){return Uf(this,new j(H,U))===0},i.isFinite=function(){return!!this.c},i.isGreaterThan=i.gt=function(H,U){return Uf(this,new j(H,U))>0},i.isGreaterThanOrEqualTo=i.gte=function(H,U){return(U=Uf(this,new j(H,U)))===1||U===0},i.isInteger=function(){return!!this.c&&fu(this.e/ni)>this.c.length-2},i.isLessThan=i.lt=function(H,U){return Uf(this,new j(H,U))<0},i.isLessThanOrEqualTo=i.lte=function(H,U){return(U=Uf(this,new j(H,U)))===-1||U===0},i.isNaN=function(){return!this.s},i.isNegative=function(){return this.s<0},i.isPositive=function(){return this.s>0},i.isZero=function(){return!!this.c&&this.c[0]==0},i.minus=function(H,U){var Q,F,B,R,$=this,W=$.s;if(H=new j(H,U),U=H.s,!W||!U)return new j(NaN);if(W!=U)return H.s=-U,$.plus(H);var G=$.e/ni,J=H.e/ni,Y=$.c,pe=H.c;if(!G||!J){if(!Y||!pe)return Y?(H.s=-U,H):new j(pe?$:NaN);if(!Y[0]||!pe[0])return pe[0]?(H.s=-U,H):new j(Y[0]?$:u==3?-0:0)}if(G=fu(G),J=fu(J),Y=Y.slice(),W=G-J){for((R=W<0)?(W=-W,B=Y):(J=G,B=pe),B.reverse(),U=W;U--;B.push(0));B.reverse()}else for(F=(R=(W=Y.length)<(U=pe.length))?W:U,W=U=0;U<F;U++)if(Y[U]!=pe[U]){R=Y[U]<pe[U];break}if(R&&(B=Y,Y=pe,pe=B,H.s=-H.s),U=(F=pe.length)-(Q=Y.length),U>0)for(;U--;Y[Q++]=0);for(U=Tu-1;F>W;){if(Y[--F]<pe[F]){for(Q=F;Q&&!Y[--Q];Y[Q]=U);--Y[Q],Y[F]+=Tu}Y[F]-=pe[F]}for(;Y[0]==0;Y.splice(0,1),--J);return Y[0]?ue(H,Y,J):(H.s=u==3?-1:1,H.c=[H.e=0],H)},i.modulo=i.mod=function(H,U){var Q,F,B=this;return H=new j(H,U),!B.c||!H.s||H.c&&!H.c[0]?new j(NaN):!H.c||B.c&&!B.c[0]?new j(B):(_==9?(F=H.s,H.s=1,Q=t(B,H,0,3),H.s=F,Q.s*=F):Q=t(B,H,0,_),H=B.minus(Q.times(H)),!H.c[0]&&_==1&&(H.s=B.s),H)},i.multipliedBy=i.times=function(H,U){var Q,F,B,R,$,W,G,J,Y,pe,Le,De,N,ee,fe,ce=this,_e=ce.c,se=(H=new j(H,U)).c;if(!_e||!se||!_e[0]||!se[0])return!ce.s||!H.s||_e&&!_e[0]&&!se||se&&!se[0]&&!_e?H.c=H.e=H.s=null:(H.s*=ce.s,!_e||!se?H.c=H.e=null:(H.c=[0],H.e=0)),H;for(F=fu(ce.e/ni)+fu(H.e/ni),H.s*=ce.s,G=_e.length,pe=se.length,G<pe&&(N=_e,_e=se,se=N,B=G,G=pe,pe=B),B=G+pe,N=[];B--;N.push(0));for(ee=Tu,fe=nf,B=pe;--B>=0;){for(Q=0,Le=se[B]%fe,De=se[B]/fe|0,$=G,R=B+$;R>B;)J=_e[--$]%fe,Y=_e[$]/fe|0,W=De*J+Y*Le,J=Le*J+W%fe*fe+N[R]+Q,Q=(J/ee|0)+(W/fe|0)+De*Y,N[R--]=J%ee;N[R]=Q}return Q?++F:N.splice(0,1),ue(H,N,F)},i.negated=function(){var H=new j(this);return H.s=-H.s||null,H},i.plus=function(H,U){var Q,F=this,B=F.s;if(H=new j(H,U),U=H.s,!B||!U)return new j(NaN);if(B!=U)return H.s=-U,F.minus(H);var R=F.e/ni,$=H.e/ni,W=F.c,G=H.c;if(!R||!$){if(!W||!G)return new j(B/0);if(!W[0]||!G[0])return G[0]?H:new j(W[0]?F:B*0)}if(R=fu(R),$=fu($),W=W.slice(),B=R-$){for(B>0?($=R,Q=G):(B=-B,Q=W),Q.reverse();B--;Q.push(0));Q.reverse()}for(B=W.length,U=G.length,B-U<0&&(Q=G,G=W,W=Q,U=B),B=0;U;)B=(W[--U]=W[U]+G[U]+B)/Tu|0,W[U]=Tu===W[U]?0:W[U]%Tu;return B&&(W=[B].concat(W),++$),ue(H,W,$)},i.precision=i.sd=function(H,U){var Q,F,B,R=this;if(H!=null&&H!==!!H)return Yo(H,1,zl),U==null?U=u:Yo(U,0,8),le(new j(R),H,U);if(!(Q=R.c))return null;if(B=Q.length-1,F=B*ni+1,B=Q[B]){for(;B%10==0;B/=10,F--);for(B=Q[0];B>=10;B/=10,F++);}return H&&R.e+1>F&&(F=R.e+1),F},i.shiftedBy=function(H){return Yo(H,-9007199254740991,db),this.times("1e"+H)},i.squareRoot=i.sqrt=function(){var H,U,Q,F,B,R=this,$=R.c,W=R.s,G=R.e,J=o+4,Y=new j("0.5");if(W!==1||!$||!$[0])return new j(!W||W<0&&(!$||$[0])?NaN:$?R:1/0);if(W=Math.sqrt(+ge(R)),W==0||W==1/0?(U=lu($),(U.length+G)%2==0&&(U+="0"),W=Math.sqrt(+U),G=fu((G+1)/2)-(G<0||G%2),W==1/0?U="5e"+G:(U=W.toExponential(),U=U.slice(0,U.indexOf("e")+1)+G),Q=new j(U)):Q=new j(W+""),Q.c[0]){for(G=Q.e,W=G+J,W<3&&(W=0);;)if(B=Q,Q=Y.times(B.plus(t(R,B,J,1))),lu(B.c).slice(0,W)===(U=lu(Q.c)).slice(0,W))if(Q.e<G&&--W,U=U.slice(W-3,W+1),U=="9999"||!F&&U=="4999"){if(!F&&(le(B,B.e+o+2,0),B.times(B).eq(R))){Q=B;break}J+=4,W+=4,F=1}else{(!+U||!+U.slice(1)&&U.charAt(0)=="5")&&(le(Q,Q.e+o+2,1),H=!Q.times(Q).eq(R));break}}return le(Q,Q.e+o+1,u,H)},i.toExponential=function(H,U){return H!=null&&(Yo(H,0,zl),H++),Z(this,H,U,1)},i.toFixed=function(H,U){return H!=null&&(Yo(H,0,zl),H=H+this.e+1),Z(this,H,U)},i.toFormat=function(H,U,Q){var F,B=this;if(Q==null)H!=null&&U&&typeof U=="object"?(Q=U,U=null):H&&typeof H=="object"?(Q=H,H=U=null):Q=T;else if(typeof Q!="object")throw Error(wl+"Argument not an object: "+Q);if(F=B.toFixed(H,U),B.c){var R,$=F.split("."),W=+Q.groupSize,G=+Q.secondaryGroupSize,J=Q.groupSeparator||"",Y=$[0],pe=$[1],Le=B.s<0,De=Le?Y.slice(1):Y,N=De.length;if(G&&(R=W,W=G,G=R,N-=R),W>0&&N>0){for(R=N%W||W,Y=De.substr(0,R);R<N;R+=W)Y+=J+De.substr(R,W);G>0&&(Y+=J+De.slice(R)),Le&&(Y="-"+Y)}F=pe?Y+(Q.decimalSeparator||"")+((G=+Q.fractionGroupSize)?pe.replace(new RegExp("\\d{"+G+"}\\B","g"),"$&"+(Q.fractionGroupSeparator||"")):pe):Y}return(Q.prefix||"")+F+(Q.suffix||"")},i.toFraction=function(H){var U,Q,F,B,R,$,W,G,J,Y,pe,Le,De=this,N=De.c;if(H!=null&&(W=new j(H),!W.isInteger()&&(W.c||W.s!==1)||W.lt(s)))throw Error(wl+"Argument "+(W.isInteger()?"out of range: ":"not an integer: ")+ge(W));if(!N)return new j(De);for(U=new j(s),J=Q=new j(s),F=G=new j(s),Le=lu(N),R=U.e=Le.length-De.e-1,U.c[0]=sv[($=R%ni)<0?ni+$:$],H=!H||W.comparedTo(U)>0?R>0?U:J:W,$=y,y=1/0,W=new j(Le),G.c[0]=0;Y=t(W,U,0,1),B=Q.plus(Y.times(F)),B.comparedTo(H)!=1;)Q=F,F=B,J=G.plus(Y.times(B=J)),G=B,U=W.minus(Y.times(B=U)),W=B;return B=t(H.minus(Q),F,0,1),G=G.plus(B.times(J)),Q=Q.plus(B.times(F)),G.s=J.s=De.s,R=R*2,pe=t(J,F,R,u).minus(De).abs().comparedTo(t(G,Q,R,u).minus(De).abs())<1?[J,F]:[G,Q],y=$,pe},i.toNumber=function(){return+ge(this)},i.toPrecision=function(H,U){return H!=null&&Yo(H,1,zl),Z(this,H,U,2)},i.toString=function(H){var U,Q=this,F=Q.s,B=Q.e;return B===null?F?(U="Infinity",F<0&&(U="-"+U)):U="NaN":(H==null?U=B<=f||B>=d?_g(lu(Q.c),B):Ic(lu(Q.c),B,"0"):H===10&&I?(Q=le(new j(Q),o+B+1,u),U=Ic(lu(Q.c),Q.e,"0")):(Yo(H,2,D.length,"Base"),U=n(Ic(lu(Q.c),B,"0"),10,H,F,!0)),F<0&&Q.c[0]&&(U="-"+U)),U},i.valueOf=i.toJSON=function(){return ge(this)},i._isBigNumber=!0,i[Symbol.toStringTag]="BigNumber",i[Symbol.for("nodejs.util.inspect.custom")]=i.valueOf,e!=null&&j.set(e),j}function fu(e){var t=e|0;return e>0||e===t?t:t-1}function lu(e){for(var t,n,r=1,i=e.length,s=e[0]+"";r<i;){for(t=e[r++]+"",n=ni-t.length;n--;t="0"+t);s+=t}for(i=s.length;s.charCodeAt(--i)===48;);return s.slice(0,i+1||1)}function Uf(e,t){var n,r,i=e.c,s=t.c,o=e.s,u=t.s,f=e.e,d=t.e;if(!o||!u)return null;if(n=i&&!i[0],r=s&&!s[0],n||r)return n?r?0:-u:o;if(o!=u)return o;if(n=o<0,r=f==d,!i||!s)return r?0:!i^n?1:-1;if(!r)return f>d^n?1:-1;for(u=(f=i.length)<(d=s.length)?f:d,o=0;o<u;o++)if(i[o]!=s[o])return i[o]>s[o]^n?1:-1;return f==d?0:f>d^n?1:-1}function Yo(e,t,n,r){if(e<t||e>n||e!==cu(e))throw Error(wl+(r||"Argument")+(typeof e=="number"?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function yg(e){var t=e.c.length-1;return fu(e.e/ni)==t&&e.c[t]%2!=0}function _g(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function Ic(e,t,n){var r,i;if(t<0){for(i=n+".";++t;i+=n);e=i+e}else if(r=e.length,++t>r){for(i=n,t-=r;--t;i+=n);e+=i}else t<r&&(e=e.slice(0,t)+"."+e.slice(t));return e}var fc=sx(),e7=class{constructor(e){Gt(this,"key");Gt(this,"left",null);Gt(this,"right",null);this.key=e}},Ad=class extends e7{constructor(e){super(e)}},t7=class{constructor(){Gt(this,"size",0);Gt(this,"modificationCount",0);Gt(this,"splayCount",0)}splay(e){const t=this.root;if(t==null)return this.compare(e,e),-1;let n=null,r=null,i=null,s=null,o=t;const u=this.compare;let f;for(;;)if(f=u(o.key,e),f>0){let d=o.left;if(d==null||(f=u(d.key,e),f>0&&(o.left=d.right,d.right=o,o=d,d=o.left,d==null)))break;n==null?r=o:n.left=o,n=o,o=d}else if(f<0){let d=o.right;if(d==null||(f=u(d.key,e),f<0&&(o.right=d.left,d.left=o,o=d,d=o.right,d==null)))break;i==null?s=o:i.right=o,i=o,o=d}else break;return i!=null&&(i.right=o.left,o.left=s),n!=null&&(n.left=o.right,o.right=r),this.root!==o&&(this.root=o,this.splayCount++),f}splayMin(e){let t=e,n=t.left;for(;n!=null;){const r=n;t.left=r.right,r.right=t,t=r,n=t.left}return t}splayMax(e){let t=e,n=t.right;for(;n!=null;){const r=n;t.right=r.left,r.left=t,t=r,n=t.right}return t}_delete(e){if(this.root==null||this.splay(e)!=0)return null;let n=this.root;const r=n,i=n.left;if(this.size--,i==null)this.root=n.right;else{const s=n.right;n=this.splayMax(i),n.right=s,this.root=n}return this.modificationCount++,r}addNewRoot(e,t){this.size++,this.modificationCount++;const n=this.root;if(n==null){this.root=e;return}t<0?(e.left=n,e.right=n.right,n.right=null):(e.right=n,e.left=n.left,n.left=null),this.root=e}_first(){const e=this.root;return e==null?null:(this.root=this.splayMin(e),this.root)}_last(){const e=this.root;return e==null?null:(this.root=this.splayMax(e),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(e){return this.validKey(e)&&this.splay(e)==0}defaultCompare(){return(e,t)=>e<t?-1:e>t?1:0}wrap(){return{getRoot:()=>this.root,setRoot:e=>{this.root=e},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:e=>{this.splayCount=e},splay:e=>this.splay(e),has:e=>this.has(e)}}},tw,nw,gm=class zd extends t7{constructor(n,r){super();Gt(this,"root",null);Gt(this,"compare");Gt(this,"validKey");Gt(this,tw,"[object Set]");this.compare=n??this.defaultCompare(),this.validKey=r??(i=>i!=null&&i!=null)}delete(n){return this.validKey(n)?this._delete(n)!=null:!1}deleteAll(n){for(const r of n)this.delete(r)}forEach(n){const r=this[Symbol.iterator]();let i;for(;i=r.next(),!i.done;)n(i.value,i.value,this)}add(n){const r=this.splay(n);return r!=0&&this.addNewRoot(new Ad(n),r),this}addAndReturn(n){const r=this.splay(n);return r!=0&&this.addNewRoot(new Ad(n),r),this.root.key}addAll(n){for(const r of n)this.add(r)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(n){if(n==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(n)<0)return this.root.key;let i=this.root.left;if(i==null)return null;let s=i.right;for(;s!=null;)i=s,s=i.right;return i.key}firstAfter(n){if(n==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(n)>0)return this.root.key;let i=this.root.right;if(i==null)return null;let s=i.left;for(;s!=null;)i=s,s=i.left;return i.key}retainAll(n){const r=new zd(this.compare,this.validKey),i=this.modificationCount;for(const s of n){if(i!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(s)&&this.splay(s)==0&&r.add(this.root.key)}r.size!=this.size&&(this.root=r.root,this.size=r.size,this.modificationCount++)}lookup(n){return!this.validKey(n)||this.splay(n)!=0?null:this.root.key}intersection(n){const r=new zd(this.compare,this.validKey);for(const i of this)n.has(i)&&r.add(i);return r}difference(n){const r=new zd(this.compare,this.validKey);for(const i of this)n.has(i)||r.add(i);return r}union(n){const r=this.clone();return r.addAll(n),r}clone(){const n=new zd(this.compare,this.validKey);return n.size=this.size,n.root=this.copyNode(this.root),n}copyNode(n){if(n==null)return null;function r(s,o){let u,f;do{if(u=s.left,f=s.right,u!=null){const d=new Ad(u.key);o.left=d,r(u,d)}if(f!=null){const d=new Ad(f.key);o.right=d,s=f,o=d}}while(f!=null)}const i=new Ad(n.key);return r(n,i),i}toSet(){return this.clone()}entries(){return new r7(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[(nw=Symbol.iterator,tw=Symbol.toStringTag,nw)](){return new n7(this.wrap())}},ax=class{constructor(e){Gt(this,"tree");Gt(this,"path",new Array);Gt(this,"modificationCount",null);Gt(this,"splayCount");this.tree=e,this.splayCount=e.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const e=this.path[this.path.length-1];return this.getValue(e)}rebuildPath(e){this.path.splice(0,this.path.length),this.tree.splay(e),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(e){for(;e!=null;)this.path.push(e),e=e.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let n=this.tree.getRoot();for(;n!=null;)this.path.push(n),n=n.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let e=this.path[this.path.length-1],t=e.right;if(t!=null){for(;t!=null;)this.path.push(t),t=t.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===e;)e=this.path.pop();return this.path.length>0}},n7=class extends ax{getValue(e){return e.key}},r7=class extends ax{getValue(e){return[e.key,e.key]}},lx=e=>()=>e,c1=e=>{const t=e?(n,r)=>r.minus(n).abs().isLessThanOrEqualTo(e):lx(!1);return(n,r)=>t(n,r)?0:n.comparedTo(r)};function i7(e){const t=e?(n,r,i,s,o)=>n.exponentiatedBy(2).isLessThanOrEqualTo(s.minus(r).exponentiatedBy(2).plus(o.minus(i).exponentiatedBy(2)).times(e)):lx(!1);return(n,r,i)=>{const s=n.x,o=n.y,u=i.x,f=i.y,d=o.minus(f).times(r.x.minus(u)).minus(s.minus(u).times(r.y.minus(f)));return t(d,s,o,u,f)?0:d.comparedTo(0)}}var o7=e=>e,s7=e=>{if(e){const t=new gm(c1(e)),n=new gm(c1(e)),r=(s,o)=>o.addAndReturn(s),i=s=>({x:r(s.x,t),y:r(s.y,n)});return i({x:new fc(0),y:new fc(0)}),i}return o7},f1=e=>({set:t=>{Gc=f1(t)},reset:()=>f1(e),compare:c1(e),snap:s7(e),orient:i7(e)}),Gc=f1(),kd=(e,t)=>e.ll.x.isLessThanOrEqualTo(t.x)&&t.x.isLessThanOrEqualTo(e.ur.x)&&e.ll.y.isLessThanOrEqualTo(t.y)&&t.y.isLessThanOrEqualTo(e.ur.y),h1=(e,t)=>{if(t.ur.x.isLessThan(e.ll.x)||e.ur.x.isLessThan(t.ll.x)||t.ur.y.isLessThan(e.ll.y)||e.ur.y.isLessThan(t.ll.y))return null;const n=e.ll.x.isLessThan(t.ll.x)?t.ll.x:e.ll.x,r=e.ur.x.isLessThan(t.ur.x)?e.ur.x:t.ur.x,i=e.ll.y.isLessThan(t.ll.y)?t.ll.y:e.ll.y,s=e.ur.y.isLessThan(t.ur.y)?e.ur.y:t.ur.y;return{ll:{x:n,y:i},ur:{x:r,y:s}}},Fg=(e,t)=>e.x.times(t.y).minus(e.y.times(t.x)),ux=(e,t)=>e.x.times(t.x).plus(e.y.times(t.y)),mm=e=>ux(e,e).sqrt(),a7=(e,t,n)=>{const r={x:t.x.minus(e.x),y:t.y.minus(e.y)},i={x:n.x.minus(e.x),y:n.y.minus(e.y)};return Fg(i,r).div(mm(i)).div(mm(r))},l7=(e,t,n)=>{const r={x:t.x.minus(e.x),y:t.y.minus(e.y)},i={x:n.x.minus(e.x),y:n.y.minus(e.y)};return ux(i,r).div(mm(i)).div(mm(r))},pb=(e,t,n)=>t.y.isZero()?null:{x:e.x.plus(t.x.div(t.y).times(n.minus(e.y))),y:n},gb=(e,t,n)=>t.x.isZero()?null:{x:n,y:e.y.plus(t.y.div(t.x).times(n.minus(e.x)))},u7=(e,t,n,r)=>{if(t.x.isZero())return gb(n,r,e.x);if(r.x.isZero())return gb(e,t,n.x);if(t.y.isZero())return pb(n,r,e.y);if(r.y.isZero())return pb(e,t,n.y);const i=Fg(t,r);if(i.isZero())return null;const s={x:n.x.minus(e.x),y:n.y.minus(e.y)},o=Fg(s,t).div(i),u=Fg(s,r).div(i),f=e.x.plus(u.times(t.x)),d=n.x.plus(o.times(r.x)),g=e.y.plus(u.times(t.y)),y=n.y.plus(o.times(r.y)),x=f.plus(d).div(2),_=g.plus(y).div(2);return{x,y:_}},uc=class cx{constructor(t,n){Gt(this,"point");Gt(this,"isLeft");Gt(this,"segment");Gt(this,"otherSE");Gt(this,"consumedBy");t.events===void 0?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=n}static compare(t,n){const r=cx.comparePoints(t.point,n.point);return r!==0?r:(t.point!==n.point&&t.link(n),t.isLeft!==n.isLeft?t.isLeft?1:-1:vm.compare(t.segment,n.segment))}static comparePoints(t,n){return t.x.isLessThan(n.x)?-1:t.x.isGreaterThan(n.x)?1:t.y.isLessThan(n.y)?-1:t.y.isGreaterThan(n.y)?1:0}link(t){if(t.point===this.point)throw new Error("Tried to link already linked events");const n=t.point.events;for(let r=0,i=n.length;r<i;r++){const s=n[r];this.point.events.push(s),s.point=this.point}this.checkForConsuming()}checkForConsuming(){const t=this.point.events.length;for(let n=0;n<t;n++){const r=this.point.events[n];if(r.segment.consumedBy===void 0)for(let i=n+1;i<t;i++){const s=this.point.events[i];s.consumedBy===void 0&&r.otherSE.point.events===s.otherSE.point.events&&r.segment.consume(s.segment)}}}getAvailableLinkedEvents(){const t=[];for(let n=0,r=this.point.events.length;n<r;n++){const i=this.point.events[n];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&t.push(i)}return t}getLeftmostComparator(t){const n=new Map,r=i=>{const s=i.otherSE;n.set(i,{sine:a7(this.point,t.point,s.point),cosine:l7(this.point,t.point,s.point)})};return(i,s)=>{n.has(i)||r(i),n.has(s)||r(s);const{sine:o,cosine:u}=n.get(i),{sine:f,cosine:d}=n.get(s);return o.isGreaterThanOrEqualTo(0)&&f.isGreaterThanOrEqualTo(0)?u.isLessThan(d)?1:u.isGreaterThan(d)?-1:0:o.isLessThan(0)&&f.isLessThan(0)?u.isLessThan(d)?-1:u.isGreaterThan(d)?1:0:f.isLessThan(o)?-1:f.isGreaterThan(o)?1:0}}},c7=class d1{constructor(t){Gt(this,"events");Gt(this,"poly");Gt(this,"_isExteriorRing");Gt(this,"_enclosingRing");this.events=t;for(let n=0,r=t.length;n<r;n++)t[n].segment.ringOut=this;this.poly=null}static factory(t){const n=[];for(let r=0,i=t.length;r<i;r++){const s=t[r];if(!s.isInResult()||s.ringOut)continue;let o=null,u=s.leftSE,f=s.rightSE;const d=[u],g=u.point,y=[];for(;o=u,u=f,d.push(u),u.point!==g;)for(;;){const x=u.getAvailableLinkedEvents();if(x.length===0){const T=d[0].point,D=d[d.length-1].point;throw new Error(`Unable to complete output ring starting at [${T.x}, ${T.y}]. Last matching segment found ends at [${D.x}, ${D.y}].`)}if(x.length===1){f=x[0].otherSE;break}let _=null;for(let T=0,D=y.length;T<D;T++)if(y[T].point===u.point){_=T;break}if(_!==null){const T=y.splice(_)[0],D=d.splice(T.index);D.unshift(D[0].otherSE),n.push(new d1(D.reverse()));continue}y.push({index:d.length,point:u.point});const M=u.getLeftmostComparator(o);f=x.sort(M)[0].otherSE;break}n.push(new d1(d))}return n}getGeom(){let t=this.events[0].point;const n=[t];for(let d=1,g=this.events.length-1;d<g;d++){const y=this.events[d].point,x=this.events[d+1].point;Gc.orient(y,t,x)!==0&&(n.push(y),t=y)}if(n.length===1)return null;const r=n[0],i=n[1];Gc.orient(r,t,i)===0&&n.shift(),n.push(n[0]);const s=this.isExteriorRing()?1:-1,o=this.isExteriorRing()?0:n.length-1,u=this.isExteriorRing()?n.length:-1,f=[];for(let d=o;d!=u;d+=s)f.push([n[d].x.toNumber(),n[d].y.toNumber()]);return f}isExteriorRing(){if(this._isExteriorRing===void 0){const t=this.enclosingRing();this._isExteriorRing=t?!t.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var i,s;let t=this.events[0];for(let o=1,u=this.events.length;o<u;o++){const f=this.events[o];uc.compare(t,f)>0&&(t=f)}let n=t.segment.prevInResult(),r=n?n.prevInResult():null;for(;;){if(!n)return null;if(!r)return n.ringOut;if(r.ringOut!==n.ringOut)return((i=r.ringOut)==null?void 0:i.enclosingRing())!==n.ringOut?n.ringOut:(s=n.ringOut)==null?void 0:s.enclosingRing();n=r.prevInResult(),r=n?n.prevInResult():null}}},mb=class{constructor(e){Gt(this,"exteriorRing");Gt(this,"interiorRings");this.exteriorRing=e,e.poly=this,this.interiorRings=[]}addInterior(e){this.interiorRings.push(e),e.poly=this}getGeom(){const e=this.exteriorRing.getGeom();if(e===null)return null;const t=[e];for(let n=0,r=this.interiorRings.length;n<r;n++){const i=this.interiorRings[n].getGeom();i!==null&&t.push(i)}return t}},f7=class{constructor(e){Gt(this,"rings");Gt(this,"polys");this.rings=e,this.polys=this._composePolys(e)}getGeom(){const e=[];for(let t=0,n=this.polys.length;t<n;t++){const r=this.polys[t].getGeom();r!==null&&e.push(r)}return e}_composePolys(e){var n;const t=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];if(!s.poly)if(s.isExteriorRing())t.push(new mb(s));else{const o=s.enclosingRing();o!=null&&o.poly||t.push(new mb(o)),(n=o==null?void 0:o.poly)==null||n.addInterior(s)}}return t}},h7=class{constructor(e,t=vm.compare){Gt(this,"queue");Gt(this,"tree");Gt(this,"segments");this.queue=e,this.tree=new gm(t),this.segments=[]}process(e){const t=e.segment,n=[];if(e.consumedBy)return e.isLeft?this.queue.delete(e.otherSE):this.tree.delete(t),n;e.isLeft&&this.tree.add(t);let r=t,i=t;do r=this.tree.lastBefore(r);while(r!=null&&r.consumedBy!=null);do i=this.tree.firstAfter(i);while(i!=null&&i.consumedBy!=null);if(e.isLeft){let s=null;if(r){const u=r.getIntersection(t);if(u!==null&&(t.isAnEndpoint(u)||(s=u),!r.isAnEndpoint(u))){const f=this._splitSafely(r,u);for(let d=0,g=f.length;d<g;d++)n.push(f[d])}}let o=null;if(i){const u=i.getIntersection(t);if(u!==null&&(t.isAnEndpoint(u)||(o=u),!i.isAnEndpoint(u))){const f=this._splitSafely(i,u);for(let d=0,g=f.length;d<g;d++)n.push(f[d])}}if(s!==null||o!==null){let u=null;s===null?u=o:o===null?u=s:u=uc.comparePoints(s,o)<=0?s:o,this.queue.delete(t.rightSE),n.push(t.rightSE);const f=t.split(u);for(let d=0,g=f.length;d<g;d++)n.push(f[d])}n.length>0?(this.tree.delete(t),n.push(e)):(this.segments.push(t),t.prev=r)}else{if(r&&i){const s=r.getIntersection(i);if(s!==null){if(!r.isAnEndpoint(s)){const o=this._splitSafely(r,s);for(let u=0,f=o.length;u<f;u++)n.push(o[u])}if(!i.isAnEndpoint(s)){const o=this._splitSafely(i,s);for(let u=0,f=o.length;u<f;u++)n.push(o[u])}}}this.tree.delete(t)}return n}_splitSafely(e,t){this.tree.delete(e);const n=e.rightSE;this.queue.delete(n);const r=e.split(t);return r.push(n),e.consumedBy===void 0&&this.tree.add(e),r}},d7=class{constructor(){Gt(this,"type");Gt(this,"numMultiPolys")}run(e,t,n){$d.type=e;const r=[new yb(t,!0)];for(let d=0,g=n.length;d<g;d++)r.push(new yb(n[d],!1));if($d.numMultiPolys=r.length,$d.type==="difference"){const d=r[0];let g=1;for(;g<r.length;)h1(r[g].bbox,d.bbox)!==null?g++:r.splice(g,1)}if($d.type==="intersection")for(let d=0,g=r.length;d<g;d++){const y=r[d];for(let x=d+1,_=r.length;x<_;x++)if(h1(y.bbox,r[x].bbox)===null)return[]}const i=new gm(uc.compare);for(let d=0,g=r.length;d<g;d++){const y=r[d].getSweepEvents();for(let x=0,_=y.length;x<_;x++)i.add(y[x])}const s=new h7(i);let o=null;for(i.size!=0&&(o=i.first(),i.delete(o));o;){const d=s.process(o);for(let g=0,y=d.length;g<y;g++){const x=d[g];x.consumedBy===void 0&&i.add(x)}i.size!=0?(o=i.first(),i.delete(o)):o=null}Gc.reset();const u=c7.factory(s.segments);return new f7(u).getGeom()}},$d=new d7,p1=$d,p7=0,vm=class jg{constructor(t,n,r,i){Gt(this,"id");Gt(this,"leftSE");Gt(this,"rightSE");Gt(this,"rings");Gt(this,"windings");Gt(this,"ringOut");Gt(this,"consumedBy");Gt(this,"prev");Gt(this,"_prevInResult");Gt(this,"_beforeState");Gt(this,"_afterState");Gt(this,"_isInResult");this.id=++p7,this.leftSE=t,t.segment=this,t.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=t,this.rings=r,this.windings=i}static compare(t,n){const r=t.leftSE.point.x,i=n.leftSE.point.x,s=t.rightSE.point.x,o=n.rightSE.point.x;if(o.isLessThan(r))return 1;if(s.isLessThan(i))return-1;const u=t.leftSE.point.y,f=n.leftSE.point.y,d=t.rightSE.point.y,g=n.rightSE.point.y;if(r.isLessThan(i)){if(f.isLessThan(u)&&f.isLessThan(d))return 1;if(f.isGreaterThan(u)&&f.isGreaterThan(d))return-1;const y=t.comparePoint(n.leftSE.point);if(y<0)return 1;if(y>0)return-1;const x=n.comparePoint(t.rightSE.point);return x!==0?x:-1}if(r.isGreaterThan(i)){if(u.isLessThan(f)&&u.isLessThan(g))return-1;if(u.isGreaterThan(f)&&u.isGreaterThan(g))return 1;const y=n.comparePoint(t.leftSE.point);if(y!==0)return y;const x=t.comparePoint(n.rightSE.point);return x<0?1:x>0?-1:1}if(u.isLessThan(f))return-1;if(u.isGreaterThan(f))return 1;if(s.isLessThan(o)){const y=n.comparePoint(t.rightSE.point);if(y!==0)return y}if(s.isGreaterThan(o)){const y=t.comparePoint(n.rightSE.point);if(y<0)return 1;if(y>0)return-1}if(!s.eq(o)){const y=d.minus(u),x=s.minus(r),_=g.minus(f),M=o.minus(i);if(y.isGreaterThan(x)&&_.isLessThan(M))return 1;if(y.isLessThan(x)&&_.isGreaterThan(M))return-1}return s.isGreaterThan(o)?1:s.isLessThan(o)||d.isLessThan(g)?-1:d.isGreaterThan(g)?1:t.id<n.id?-1:t.id>n.id?1:0}static fromRing(t,n,r){let i,s,o;const u=uc.comparePoints(t,n);if(u<0)i=t,s=n,o=1;else if(u>0)i=n,s=t,o=-1;else throw new Error(`Tried to create degenerate segment at [${t.x}, ${t.y}]`);const f=new uc(i,!0),d=new uc(s,!1);return new jg(f,d,[r],[o])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const t=this.leftSE.point.y,n=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t.isLessThan(n)?t:n},ur:{x:this.rightSE.point.x,y:t.isGreaterThan(n)?t:n}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(t){return t.x.eq(this.leftSE.point.x)&&t.y.eq(this.leftSE.point.y)||t.x.eq(this.rightSE.point.x)&&t.y.eq(this.rightSE.point.y)}comparePoint(t){return Gc.orient(this.leftSE.point,t,this.rightSE.point)}getIntersection(t){const n=this.bbox(),r=t.bbox(),i=h1(n,r);if(i===null)return null;const s=this.leftSE.point,o=this.rightSE.point,u=t.leftSE.point,f=t.rightSE.point,d=kd(n,u)&&this.comparePoint(u)===0,g=kd(r,s)&&t.comparePoint(s)===0,y=kd(n,f)&&this.comparePoint(f)===0,x=kd(r,o)&&t.comparePoint(o)===0;if(g&&d)return x&&!y?o:!x&&y?f:null;if(g)return y&&s.x.eq(f.x)&&s.y.eq(f.y)?null:s;if(d)return x&&o.x.eq(u.x)&&o.y.eq(u.y)?null:u;if(x&&y)return null;if(x)return o;if(y)return f;const _=u7(s,this.vector(),u,t.vector());return _===null||!kd(i,_)?null:Gc.snap(_)}split(t){const n=[],r=t.events!==void 0,i=new uc(t,!0),s=new uc(t,!1),o=this.rightSE;this.replaceRightSE(s),n.push(s),n.push(i);const u=new jg(i,o,this.rings.slice(),this.windings.slice());return uc.comparePoints(u.leftSE.point,u.rightSE.point)>0&&u.swapEvents(),uc.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(i.checkForConsuming(),s.checkForConsuming()),n}swapEvents(){const t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let n=0,r=this.windings.length;n<r;n++)this.windings[n]*=-1}consume(t){let n=this,r=t;for(;n.consumedBy;)n=n.consumedBy;for(;r.consumedBy;)r=r.consumedBy;const i=jg.compare(n,r);if(i!==0){if(i>0){const s=n;n=r,r=s}if(n.prev===r){const s=n;n=r,r=s}for(let s=0,o=r.rings.length;s<o;s++){const u=r.rings[s],f=r.windings[s],d=n.rings.indexOf(u);d===-1?(n.rings.push(u),n.windings.push(f)):n.windings[d]+=f}r.rings=null,r.windings=null,r.consumedBy=n,r.leftSE.consumedBy=n.leftSE,r.rightSE.consumedBy=n.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};const n=this._afterState.rings,r=this._afterState.windings,i=this._afterState.multiPolys;for(let u=0,f=this.rings.length;u<f;u++){const d=this.rings[u],g=this.windings[u],y=n.indexOf(d);y===-1?(n.push(d),r.push(g)):r[y]+=g}const s=[],o=[];for(let u=0,f=n.length;u<f;u++){if(r[u]===0)continue;const d=n[u],g=d.poly;if(o.indexOf(g)===-1)if(d.isExterior)s.push(g);else{o.indexOf(g)===-1&&o.push(g);const y=s.indexOf(d.poly);y!==-1&&s.splice(y,1)}}for(let u=0,f=s.length;u<f;u++){const d=s[u].multiPoly;i.indexOf(d)===-1&&i.push(d)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const t=this.beforeState().multiPolys,n=this.afterState().multiPolys;switch(p1.type){case"union":{const r=t.length===0,i=n.length===0;this._isInResult=r!==i;break}case"intersection":{let r,i;t.length<n.length?(r=t.length,i=n.length):(r=n.length,i=t.length),this._isInResult=i===p1.numMultiPolys&&r<i;break}case"xor":{const r=Math.abs(t.length-n.length);this._isInResult=r%2===1;break}case"difference":{const r=i=>i.length===1&&i[0].isSubject;this._isInResult=r(t)!==r(n);break}}return this._isInResult}},vb=class{constructor(e,t,n){Gt(this,"poly");Gt(this,"isExterior");Gt(this,"segments");Gt(this,"bbox");if(!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=t,this.isExterior=n,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const r=Gc.snap({x:new fc(e[0][0]),y:new fc(e[0][1])});this.bbox={ll:{x:r.x,y:r.y},ur:{x:r.x,y:r.y}};let i=r;for(let s=1,o=e.length;s<o;s++){if(typeof e[s][0]!="number"||typeof e[s][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const u=Gc.snap({x:new fc(e[s][0]),y:new fc(e[s][1])});u.x.eq(i.x)&&u.y.eq(i.y)||(this.segments.push(vm.fromRing(i,u,this)),u.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=u.x),u.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=u.y),u.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=u.x),u.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=u.y),i=u)}(!r.x.eq(i.x)||!r.y.eq(i.y))&&this.segments.push(vm.fromRing(i,r,this))}getSweepEvents(){const e=[];for(let t=0,n=this.segments.length;t<n;t++){const r=this.segments[t];e.push(r.leftSE),e.push(r.rightSE)}return e}},g7=class{constructor(e,t){Gt(this,"multiPoly");Gt(this,"exteriorRing");Gt(this,"interiorRings");Gt(this,"bbox");if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new vb(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let n=1,r=e.length;n<r;n++){const i=new vb(e[n],this,!1);i.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=i.bbox.ur.y),this.interiorRings.push(i)}this.multiPoly=t}getSweepEvents(){const e=this.exteriorRing.getSweepEvents();for(let t=0,n=this.interiorRings.length;t<n;t++){const r=this.interiorRings[t].getSweepEvents();for(let i=0,s=r.length;i<s;i++)e.push(r[i])}return e}},yb=class{constructor(e,t){Gt(this,"isSubject");Gt(this,"polys");Gt(this,"bbox");if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:new fc(Number.POSITIVE_INFINITY),y:new fc(Number.POSITIVE_INFINITY)},ur:{x:new fc(Number.NEGATIVE_INFINITY),y:new fc(Number.NEGATIVE_INFINITY)}};for(let n=0,r=e.length;n<r;n++){const i=new g7(e[n],this);i.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=i.bbox.ur.y),this.polys.push(i)}this.isSubject=t}getSweepEvents(){const e=[];for(let t=0,n=this.polys.length;t<n;t++){const r=this.polys[t].getSweepEvents();for(let i=0,s=r.length;i<s;i++)e.push(r[i])}return e}},m7=(e,...t)=>p1.run("intersection",e,t);Gc.set;function v7(e,t){var n,r,i,s,o,u,f,d,g,y,x=0,_=e.type==="FeatureCollection",M=e.type==="Feature",T=_?e.features.length:1;for(n=0;n<T;n++){for(u=_?e.features[n].geometry:M?e.geometry:e,d=_?e.features[n].properties:M?e.properties:{},g=_?e.features[n].bbox:M?e.bbox:void 0,y=_?e.features[n].id:M?e.id:void 0,f=u?u.type==="GeometryCollection":!1,o=f?u.geometries.length:1,i=0;i<o;i++){if(s=f?u.geometries[i]:u,s===null){if(t(null,x,d,g,y)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(s,x,d,g,y)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<s.geometries.length;r++)if(t(s.geometries[r],x,d,g,y)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}x++}}function y7(e,t={}){const n=[];if(v7(e,i=>{n.push(i.coordinates)}),n.length<2)throw new Error("Must specify at least 2 geometries");const r=m7(n[0],...n.slice(1));return r.length===0?null:r.length===1?hu(r[0],t.properties):jI(r,t.properties)}var _7=y7;function fx(e,t,n){if(e!==null)for(var r,i,s,o,u,f,d,g=0,y=0,x,_=e.type,M=_==="FeatureCollection",T=_==="Feature",D=M?e.features.length:1,I=0;I<D;I++){d=M?e.features[I].geometry:T?e.geometry:e,x=d?d.type==="GeometryCollection":!1,u=x?d.geometries.length:1;for(var j=0;j<u;j++){var Z=0,te=0;if(o=x?d.geometries[j]:d,o!==null){f=o.coordinates;var ue=o.type;switch(g=0,ue){case null:break;case"Point":if(t(f,y,I,Z,te)===!1)return!1;y++,Z++;break;case"LineString":case"MultiPoint":for(r=0;r<f.length;r++){if(t(f[r],y,I,Z,te)===!1)return!1;y++,ue==="MultiPoint"&&Z++}ue==="LineString"&&Z++;break;case"Polygon":case"MultiLineString":for(r=0;r<f.length;r++){for(i=0;i<f[r].length-g;i++){if(t(f[r][i],y,I,Z,te)===!1)return!1;y++}ue==="MultiLineString"&&Z++,ue==="Polygon"&&te++}ue==="Polygon"&&Z++;break;case"MultiPolygon":for(r=0;r<f.length;r++){for(te=0,i=0;i<f[r].length;i++){for(s=0;s<f[r][i].length-g;s++){if(t(f[r][i][s],y,I,Z,te)===!1)return!1;y++}te++}Z++}break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(fx(o.geometries[r],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function b7(e,t){var n,r,i,s,o,u,f,d,g,y,x=0,_=e.type==="FeatureCollection",M=e.type==="Feature",T=_?e.features.length:1;for(n=0;n<T;n++){for(u=_?e.features[n].geometry:M?e.geometry:e,d=_?e.features[n].properties:M?e.properties:{},g=_?e.features[n].bbox:M?e.bbox:void 0,y=_?e.features[n].id:M?e.id:void 0,f=u?u.type==="GeometryCollection":!1,o=f?u.geometries.length:1,i=0;i<o;i++){if(s=f?u.geometries[i]:u,s===null){if(t(null,x,d,g,y)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(s,x,d,g,y)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<s.geometries.length;r++)if(t(s.geometries[r],x,d,g,y)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}x++}}function w7(e,t){b7(e,function(n,r,i,s,o){var u=n===null?null:n.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return t(sd(n,i,{bbox:s,id:o}),r,0)===!1?!1:void 0}var f;switch(u){case"MultiPoint":f="Point";break;case"MultiLineString":f="LineString";break;case"MultiPolygon":f="Polygon";break}for(var d=0;d<n.coordinates.length;d++){var g=n.coordinates[d],y={type:f,coordinates:g};if(t(sd(y,i),r,d)===!1)return!1}})}function x7(e,t){w7(e,function(n,r,i){var s=0;if(n.geometry){var o=n.geometry.type;if(!(o==="Point"||o==="MultiPoint")){var u,f=0,d=0,g=0;if(fx(n,function(y,x,_,M,T){if(u===void 0||r>f||M>d||T>g){u=y,f=r,d=M,g=T,s=0;return}var D=du([u,y],n.properties);if(t(D,r,i,T,s)===!1)return!1;s++,u=y})===!1)return!1}}})}function L7(e,t,n){var r=n,i=!1;return x7(e,function(s,o,u,f,d){i===!1&&n===void 0?r=s:r=t(r,s,o,u,f,d),i=!0}),r}function ym(e,t={}){return L7(e,(n,r)=>{const i=r.geometry.coordinates;return n+dy(i[0],i[1],t)},0)}var Vf=ym;class gf extends Vn.Polygon{constructor(n,r={}){super(n,{...r,pmIgnore:!1,interactive:!0});Gt(this,"properties");this.properties=hn.measure("Polygon.constructor.initProperties",()=>({type:"Polygon",category:r.category||"forages",accessLevel:r.accessLevel||"visitor",style:{color:r.color||"#2b6451",weight:r.weight||3,opacity:r.opacity||1,fillColor:r.fillColor||"#2b6451",fillOpacity:r.fillOpacity||.2,dashArray:r.dashArray||"",name:r.name||""}})),this.updateProperties(),this.on({add:()=>this.updateProperties(),edit:()=>this.updateProperties(),drag:()=>this.updateProperties()})}updateProperties(){hn.measure("Polygon.updateProperties",()=>{var n,r,i,s,o;try{const u=this.getLatLngs()[0];if(!u||u.length<3){console.warn("Polygon has less than 3 points, cannot calculate properties");return}const f=u.map(I=>[I.lng,I.lat]);f.push(f[0]);const d=hu([f]),g=ix(d),y=ym(du([...f]),{units:"meters"}),x=op(d),_=Vn.latLng(x.geometry.coordinates[1],x.geometry.coordinates[0]),M=((r=(n=this.properties)==null?void 0:n.style)==null?void 0:r.name)||"",T=((i=this.properties)==null?void 0:i.category)||"forages",D=((s=this.properties)==null?void 0:s.accessLevel)||"visitor";this.properties={type:"Polygon",coordinates:u.map(I=>({lat:I.lat,lng:I.lng})),surface:g,perimeter:y,center:{lat:_.lat,lng:_.lng},vertices:u.length,category:T,accessLevel:D,style:{...this.options,color:this.options.color||"#2b6451",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#2b6451",fillOpacity:this.options.fillOpacity||.2,dashArray:((o=this.options)==null?void 0:o.dashArray)||"",name:M}},this.fire("properties:updated",{shape:this,properties:this.properties})}catch(u){console.error("Failed to calculate polygon properties",u)}})}setName(n){hn.measure("Polygon.setName",()=>{this.properties.style||(this.properties.style={}),this.properties.style.name=n,this.fire("properties:updated",{shape:this,properties:this.properties})})}getName(){return hn.measure("Polygon.getName",()=>{var n,r;return((r=(n=this.properties)==null?void 0:n.style)==null?void 0:r.name)||""})}setLatLngs(n){return hn.measure("Polygon.setLatLngs",()=>(super.setLatLngs(n),this.updateProperties(),this))}getMidPoints(){return hn.measure("Polygon.getMidPoints",()=>{const n=this.getLatLngs()[0],r=[];if(n.length<2)return r;for(let i=0;i<n.length;i++){const s=n[i],o=n[(i+1)%n.length];r.push(Vn.latLng((s.lat+o.lat)/2,(s.lng+o.lng)/2))}return r})}moveVertex(n,r){hn.measure("Polygon.moveVertex",()=>{const i=this.getLatLngs()[0];n>=0&&n<i.length&&(i[n]=r,Vn.Polygon.prototype.setLatLngs.call(this,[i]))})}addVertex(n,r){hn.measure("Polygon.addVertex",()=>{const i=this.getLatLngs()[0];n>=0&&n<i.length&&(i.splice((n+1)%i.length,0,r),Vn.Polygon.prototype.setLatLngs.call(this,[i]))})}move(n){return hn.measure("Polygon.move",()=>{const i=this.getLatLngs()[0].map(s=>Vn.latLng(s.lat+n.lat,s.lng+n.lng));return Vn.Polygon.prototype.setLatLngs.call(this,[i]),this})}getCenter(){return hn.measure("Polygon.getCenter",()=>{const n=this.getLatLngs()[0];if(!n||n.length===0)return new Vn.LatLng(0,0);try{const r=n.filter(d=>d&&typeof d.lat=="number"&&typeof d.lng=="number"&&!isNaN(d.lat)&&!isNaN(d.lng)&&Math.abs(d.lat)<=90&&Math.abs(d.lng)<=180);if(r.length===0)return console.warn("Aucun point valide dans le polygone pour calculer le centre"),new Vn.LatLng(0,0);const i=r.map(d=>[d.lng,d.lat]);i.push(i[0]);const s=hu([i]),o=op(s),u=o.geometry.coordinates[1],f=o.geometry.coordinates[0];if(typeof u!="number"||typeof f!="number"||isNaN(u)||isNaN(f)||Math.abs(u)>90||Math.abs(f)>180)throw new Error("Centroid calculé invalide");return Vn.latLng(u,f)}catch(r){console.warn("Erreur lors du calcul du centroïde avec turf.js, utilisation de la méthode simple",r);let i=0,s=0,o=0;for(const u of n)u&&typeof u.lat=="number"&&typeof u.lng=="number"&&!isNaN(u.lat)&&!isNaN(u.lng)&&Math.abs(u.lat)<=90&&Math.abs(u.lng)<=180&&(i+=u.lat,s+=u.lng,o++);return o===0?(console.error("Impossible de calculer un centre valide pour le polygone"),new Vn.LatLng(0,0)):new Vn.LatLng(i/o,s/o)}})}getSegmentLengths(){return hn.measure("Polygon.getSegmentLengths",()=>{const n=this.getLatLngs()[0],r=[];if(n.length<2)return r;for(let i=0;i<n.length;i++){const s=n[i],o=n[(i+1)%n.length];r.push(s.distanceTo(o))}return r})}}class Ns extends Vn.Polyline{constructor(n,r={}){super(n,{...r,pmIgnore:!1,interactive:!0});Gt(this,"properties");Gt(this,"cachedProperties",{});Gt(this,"needsUpdate",!0);this.properties=hn.measure("Line.constructor.initProperties",()=>({type:"Line",category:r.category||"forages",accessLevel:r.accessLevel||"visitor",style:{...r||{},name:r.name||""}})),this.updateProperties(),this.on("add",()=>{this.updateProperties()})}updateProperties(){hn.measure("Line.updateProperties",()=>{var i,s,o,u,f;const n=this.getLatLngs();if(!n||n.length<2){console.warn("Line has less than 2 points, cannot calculate properties");return}const r=n.map(d=>[d.lng,d.lat]);try{const d=du(r),g=ym(d,{units:"meters"});let y;if(n.length===2)y=Vn.latLng((n[0].lat+n[1].lat)/2,(n[0].lng+n[1].lng)/2);else{const D=u1(d,g/2,{units:"meters"});y=Vn.latLng(D.geometry.coordinates[1],D.geometry.coordinates[0])}const x=10,_=((s=(i=this.properties)==null?void 0:i.style)==null?void 0:s.name)||"",M=((o=this.properties)==null?void 0:o.category)||"forages",T=((u=this.properties)==null?void 0:u.accessLevel)||"visitor";this.properties={type:"Line",length:g,coordinates:n.map(D=>({lat:D.lat,lng:D.lng})),center:{lat:y.lat,lng:y.lng},vertices:n.length,surfaceInfluence:g*x,dimensions:{width:x},category:M,accessLevel:T,style:{...this.options,color:this.options.color||"#2b6451",weight:this.options.weight||3,opacity:this.options.opacity||1,dashArray:((f=this.options)==null?void 0:f.dashArray)||"",name:_}},this.cachedProperties.length=g,this.cachedProperties.center=y,this.cachedProperties.midPoints=void 0,this.cachedProperties.segmentLengths=void 0,this.needsUpdate=!1,this.fire("properties:updated",{shape:this,properties:this.properties})}catch(d){console.error("Failed to calculate line properties",d)}})}setName(n){hn.measure("Line.setName",()=>{this.properties.style||(this.properties.style={}),this.properties.style.name=n,this.fire("properties:updated",{shape:this,properties:this.properties})})}getName(){return hn.measure("Line.getName",()=>{var n,r;return((r=(n=this.properties)==null?void 0:n.style)==null?void 0:r.name)||""})}invalidateCache(){hn.measure("Line.invalidateCache",()=>{this.needsUpdate=!0,this.cachedProperties={}})}setLatLngs(n){return super.setLatLngs(n),this.needsUpdate=!0,this.cachedProperties={},this.fire("latlngs:updated",{latlngs:this.getLatLngs()}),this}getMidPoints(){return hn.measure("Line.getMidPoints",()=>{if(!this.needsUpdate&&this.cachedProperties.midPoints)return this.cachedProperties.midPoints;const n=this.getLatLngs(),r=[];if(n.length<2)return r;for(let i=0;i<n.length-1;i++){const s=n[i],o=n[i+1];if(!s||!o){console.warn("Points invalides détectés pour le segment",i);continue}r.push(Vn.latLng((s.lat+o.lat)/2,(s.lng+o.lng)/2))}return this.cachedProperties.midPoints=r,r})}getMidPointAt(n){return hn.measure("Line.getMidPointAt",()=>{const r=this.getLatLngs();if(n<0||n>=r.length-1||r.length<2)return null;const i=r[n],s=r[n+1];return!i||!s?(console.warn("Points invalides pour calcul du midpoint au segment",n),null):Vn.latLng((i.lat+s.lat)/2,(i.lng+s.lng)/2)})}moveVertex(n,r,i=!1){hn.measure("Line.moveVertex",()=>{const s=this.getLatLngs();n>=0&&n<s.length&&(s[n]=r,this.setLatLngs(s),this.needsUpdate=!0,this.cachedProperties={},this.fire("vertex:moved",{index:n,latlng:r,allPoints:s}),i&&this.updateProperties())})}addVertex(n,r,i=!1){hn.measure("Line.addVertex",()=>{const s=this.getLatLngs();n>=0&&n<s.length-1&&(s.splice(n+1,0,r),Vn.Polyline.prototype.setLatLngs.call(this,s),this.needsUpdate=!0,this.cachedProperties.midPoints=void 0,this.cachedProperties.segmentLengths=void 0,this.cachedProperties.center=void 0,this.cachedProperties.length=void 0,i&&this.updateProperties())})}move(n,r=!0){return hn.measure("Line.move",()=>{this.fire("move:start");const i=this.getLatLngs(),s=i.map(o=>Vn.latLng(o.lat+n.lat,o.lng+n.lng));return this.setLatLngs(s),this.needsUpdate=!0,this.cachedProperties={},this.fire("move",{delta:n,newPositions:s,oldPositions:i}),r&&(this.updateProperties(),this.fire("properties:updated",{shape:this,properties:this.properties}),this.fire("move:end")),this})}getCenter(){return hn.measure("Line.getCenter",()=>{if(!this.needsUpdate&&this.cachedProperties.center)return this.cachedProperties.center;const n=this.getLatLngs();if(n.length<2)return n[0]||new Vn.LatLng(0,0);try{const r=n.map(f=>[f.lng,f.lat]),i=du(r),s=ym(i,{units:"meters"}),o=u1(i,s/2,{units:"meters"}),u=Vn.latLng(o.geometry.coordinates[1],o.geometry.coordinates[0]);return this.cachedProperties.center=u,u}catch(r){console.warn("Error calculating line center with turf.js, using simple method",r);const i=n.reduce((u,f)=>u+f.lat,0)/n.length,s=n.reduce((u,f)=>u+f.lng,0)/n.length,o=new Vn.LatLng(i,s);return this.cachedProperties.center=o,o}})}getSegmentLengths(){return hn.measure("Line.getSegmentLengths",()=>{if(!this.needsUpdate&&this.cachedProperties.segmentLengths)return this.cachedProperties.segmentLengths;const n=this.getLatLngs(),r=[];if(n.length<2)return r;for(let i=0;i<n.length-1;i++){const s=n[i],o=n[i+1];r.push(s.distanceTo(o))}return this.cachedProperties.segmentLengths=r,r})}getSegmentLengthAt(n){return hn.measure("Line.getSegmentLengthAt",()=>{const r=this.getLatLngs();if(n<0||n>=r.length-1||r.length<2)return 0;const i=r[n],s=r[n+1];return i.distanceTo(s)})}getLengthToVertex(n){return hn.measure("Line.getLengthToVertex",()=>{const r=this.getLatLngs();let i=0;if(n<=0||r.length<2)return 0;for(let s=0;s<Math.min(n,r.length-1);s++)i+=r[s].distanceTo(r[s+1]);return i})}getLength(){return hn.measure("Line.getLength",()=>{if(!this.needsUpdate&&this.cachedProperties.length)return this.cachedProperties.length;const n=this.getLatLngs();let r=0;for(let i=0;i<n.length-1;i++)r+=n[i].distanceTo(n[i+1]);return this.cachedProperties.length=r,r})}}const Qa=class Qa extends Ns{constructor(n,r={}){super(n,{...r,color:"#FF4500",weight:4,opacity:.8,interactive:!1,pmIgnore:!0});Gt(this,"elevationData",[]);Gt(this,"elevationProfile",null);Gt(this,"elevationMarker",null);Gt(this,"isZooming",!1);Gt(this,"simpleLine",null);Gt(this,"isDestroyed",!1);Gt(this,"zoomAnimationTimeout",null);this.properties=hn.measure("ElevationLine.constructor.initProperties",()=>({...this.properties,type:"ElevationLine",category:r.category||"forages",accessLevel:r.accessLevel||"visitor",style:{...this.properties.style||{},name:r.name||""},elevationProfile:null,maxElevation:0,minElevation:0,elevationGain:0,elevationLoss:0,dataSource:"pending"})),this.setupEventListeners()}setupEventListeners(){hn.measure("ElevationLine.setupEventListeners",()=>{this.on("move",()=>this.updateElevationProfile()),this.on("add",()=>{this._map&&(this._map.on("zoomstart",this.handleZoomStart,this),this._map.on("zoomend",this.handleZoomEnd,this),this._map.on("zoomanim",this._animateZoom,this))}),this.on("remove",()=>{this.cleanupEventListeners()})})}cleanupEventListeners(){this._map&&(this._map.off("zoomstart",this.handleZoomStart,this),this._map.off("zoomend",this.handleZoomEnd,this),this._map.off("zoomanim",this._animateZoom,this)),this.zoomAnimationTimeout&&(clearTimeout(this.zoomAnimationTimeout),this.zoomAnimationTimeout=null)}_animateZoom(n){if(this.isDestroyed||!this._map||!this.getLatLngs().length){console.debug("[ElevationLine] Animation de zoom ignorée - ligne détruite ou carte non disponible");return}this.zoomAnimationTimeout&&(clearTimeout(this.zoomAnimationTimeout),this.zoomAnimationTimeout=null);try{this.elevationMarker&&this.elevationMarker.remove();const r=this._path;r&&(r.style.display="none");const i=this.getLatLngs();if(i&&i.length>0&&this._map&&!this.isDestroyed){if(!this._map.getContainer()){console.debug("[ElevationLine] Carte non valide pendant l'animation de zoom");return}if(this.simpleLine?this.simpleLine.setLatLngs(i):(this.simpleLine=Vn.polyline(i,{color:"#FF4500",weight:3,opacity:.6,smoothFactor:1,interactive:!1}),this._map&&this._map.getContainer()&&this.simpleLine.addTo(this._map)),this.simpleLine&&this.simpleLine._path){const s=this.simpleLine._path.style.transform;this.simpleLine._path.style.transform="",this.zoomAnimationTimeout=setTimeout(()=>{if(this.isDestroyed||!this._map||!this._map.getContainer()){this.cleanup();return}try{this.simpleLine&&this.simpleLine._path&&(this.simpleLine._path.style.transform=s,this.simpleLine._path.style.display=""),r&&!this.isDestroyed&&(r.style.display=""),this._map&&this._map.hasLayer(this)&&!this.isDestroyed&&this.redraw()}catch(o){console.warn("[ElevationLine] Erreur lors de la restauration après animation:",o),this.cleanup()}},300)}}}catch(r){console.debug("[ElevationLine] Animation de zoom ignorée:",r),this.zoomAnimationTimeout=setTimeout(()=>{if(this.isDestroyed||!this._map||!this._map.getContainer()){this.cleanup();return}try{this._path&&(this._path.style.display=""),this._map&&this._map.hasLayer(this)&&!this.isDestroyed&&this.redraw()}catch(i){console.error("[ElevationLine] Erreur lors de la restauration après animation:",i),this.cleanup()}},300)}}handleZoomStart(){this.isDestroyed||hn.measure("ElevationLine.handleZoomStart",()=>{if(!(this.isZooming||!this._map)){this.isZooming=!0;try{this.elevationMarker&&this.elevationMarker.remove();const n=this._path;n&&(n.style.display="none"),this.isDestroyed||this.setStyle({opacity:.3})}catch(n){console.error("[ElevationLine] Error in handleZoomStart:",n),this.cleanup()}}})}handleZoomEnd(){this.isDestroyed||hn.measure("ElevationLine.handleZoomEnd",()=>{if(!this._map){this.isZooming=!1;return}try{this.simpleLine&&this._map&&(this.simpleLine.remove(),this.simpleLine=null);const n=this._path;n&&(n.style.display=""),this.isDestroyed||this.setStyle({opacity:.8}),this.zoomAnimationTimeout&&clearTimeout(this.zoomAnimationTimeout),this.zoomAnimationTimeout=setTimeout(()=>{if(!(this.isDestroyed||!this._map))try{this._map&&this._map.hasLayer(this)&&!this.isDestroyed&&this.redraw()}catch(r){console.warn("[ElevationLine] Erreur lors du redraw après zoom:",r),this.cleanup()}},50)}catch(n){console.error("[ElevationLine] Error in handleZoomEnd:",n)}finally{this.isZooming=!1}})}cleanup(){hn.measure("ElevationLine.cleanup",()=>{if(this.isZooming=!1,this.hideElevationMarker(),this.zoomAnimationTimeout&&(clearTimeout(this.zoomAnimationTimeout),this.zoomAnimationTimeout=null),this.simpleLine&&this._map){try{this.simpleLine.remove()}catch(r){console.error("[ElevationLine] Error removing simpleLine:",r)}this.simpleLine=null}if(this.elevationProfile){try{this.elevationProfile.remove()}catch(r){console.error("[ElevationLine] Error removing elevationProfile:",r)}this.elevationProfile=null}const n=this._path;n&&(n.style.display=""),!this.isDestroyed&&this._map&&this._map.hasLayer(this)&&this.setStyle({opacity:.8})})}calculateOptimalSampleCount(){return hn.measure("ElevationLine.calculateOptimalSampleCount",()=>{const n=this.getLength(),r=Math.ceil(n/Qa.SAMPLE_DISTANCE);return Math.min(Math.max(r,Qa.MIN_SAMPLES),Qa.MAX_SAMPLES)})}async fetchElevationData(n=0){return hn.measure("ElevationLine.fetchElevationData",async()=>{if(this.getLatLngs().length===0)return;const i=this.getLength();let s="";const o=this.calculateOptimalSampleCount();console.log(`[ElevationLine] Using ${o} sample points for ${i.toFixed(0)}m line`);const u=[];for(let f=0;f<o;f++){const d=f/(o-1)*i,g=this.getPointAtDistance(d);g&&u.push(`${g.lat},${g.lng}`)}s=u.join("|");try{const f=await fetch(`${Qa.API_URL}?locations=${s}`);if(!f.ok)throw new Error(`HTTP error ${f.status}`);const d=await f.json();if(!d.results||!Array.isArray(d.results))throw new Error("Invalid API response format");this.elevationData=d.results.map((g,y)=>({distance:y/(o-1)*i,elevation:g.elevation})),this.properties.dataSource="api"}catch(f){if(console.warn(`[ElevationLine] API fetch attempt ${n+1}/${Qa.MAX_RETRIES} failed:`,f),n<Qa.MAX_RETRIES)return await new Promise(d=>setTimeout(d,Qa.RETRY_DELAY)),this.fetchElevationData(n+1);console.warn("[ElevationLine] All API attempts failed, falling back to simulation"),this.simulateElevationData(),this.properties.dataSource="simulation"}this.calculateElevationStatistics()})}simulateElevationData(){hn.measure("ElevationLine.simulateElevationData",()=>{const n=this.getLength(),r=this.calculateOptimalSampleCount();this.elevationData=Array.from({length:r},(i,s)=>{const o=s/(r-1)*n,u=100+Math.sin(o/n*Math.PI*2)*50;return{distance:o,elevation:u}})})}calculateElevationStatistics(){hn.measure("ElevationLine.calculateElevationStatistics",()=>{if(!this.elevationData.length)return;const n=this.elevationData.map(g=>g.elevation),r=n.length?Math.max(...n):0,i=n.length?Math.min(...n):0;let s=0,o=0,u=0,f=0,d=0;console.log("[ElevationLine][calculateElevationStatistics] Données brutes:",{elevationsCount:n.length,maxElevation:r,minElevation:i});for(let g=1;g<this.elevationData.length;g++){const y=this.elevationData[g-1],x=this.elevationData[g],_=x.elevation-y.elevation;_>0?s+=_:o+=Math.abs(_);const M=x.distance-y.distance;if(M>0){const T=_/M*100;u=Math.max(u,Math.abs(T)),f+=Math.abs(T),d++}}console.log("[ElevationLine][calculateElevationStatistics] Calculs intermédiaires:",{gain:s,loss:o,maxSlope:u,averageSlope:d>0?f/d:0}),this.properties={...this.properties,type:"ElevationLine",maxElevation:r,minElevation:i,elevationGain:s,elevationLoss:o,maxSlope:u,averageSlope:d>0?f/d:0,elevationData:this.elevationData,dataSource:this.properties.dataSource,length:this.getLength()},console.log("[ElevationLine][calculateElevationStatistics] Propriétés mises à jour:",this.properties)})}showElevationAt(n){hn.measure("ElevationLine.showElevationAt",()=>{if(!(!this.elevationData.length||!this._map))try{const r=this.elevationData.reduce((s,o)=>Math.abs(o.distance-n)<Math.abs(s.distance-n)?o:s),i=this.getPointAtDistance(n);if(!i)return;this.elevationMarker?(this.elevationMarker.setLatLng(i),this.elevationMarker.setTooltipContent(`Distance: ${this.formatDistance(r.distance)}<br>Altitude: ${this.formatElevation(r.elevation)}`)):(this.elevationMarker=Vn.circleMarker(i,{radius:6,color:"#FF4500",fillColor:"#FF4500",fillOpacity:1,weight:2,className:"elevation-marker"}),this.elevationMarker.bindTooltip(`Distance: ${this.formatDistance(r.distance)}<br>Altitude: ${this.formatElevation(r.elevation)}`,{permanent:!0,direction:"top",offset:[0,-10],className:"elevation-marker-tooltip"}),this._map&&this._map.hasLayer(this)&&this.elevationMarker.addTo(this._map)),this.fire("elevation:show",{distance:n,elevation:r.elevation,latLng:i})}catch(r){console.error("[ElevationLine] Erreur lors de l'affichage de l'élévation:",r),this.hideElevationMarker()}})}hideElevationMarker(){hn.measure("ElevationLine.hideElevationMarker",()=>{this.elevationMarker&&(this.elevationMarker.remove(),this.elevationMarker=null)})}getPointAtDistance(n){return hn.measure("ElevationLine.getPointAtDistance",()=>{try{const i=this.getLatLngs().map(u=>[u.lng,u.lat]),s=du(i),o=u1(s,n,{units:"meters"});return Vn.latLng(o.geometry.coordinates[1],o.geometry.coordinates[0])}catch(r){return console.error("Error calculating point at distance",r),null}})}moveVertex(n,r,i=!1){hn.measure("ElevationLine.moveVertex",()=>{super.moveVertex(n,r,!1),this.properties.type="ElevationLine",i&&this.updateElevationProfile()})}addVertex(n,r,i=!1){hn.measure("ElevationLine.addVertex",()=>{console.warn("[ElevationLine] Tentative d'ajout de vertex ignorée - non autorisé pour un profil altimétrique")})}setLatLngs(n){return hn.measure("ElevationLine.setLatLngs",()=>(super.setLatLngs(n),this.properties.type="ElevationLine",this.updateElevationProfile(),this))}move(n,r=!0){return hn.measure("ElevationLine.move",()=>(super.move(n,!1),this.properties.type="ElevationLine",r&&this.updateElevationProfile(),this))}setName(n){hn.measure("ElevationLine.setName",()=>{this.properties.style||(this.properties.style={}),this.properties.style.name=n,this.fire("properties:updated",{shape:this,properties:this.properties})})}getName(){return hn.measure("ElevationLine.getName",()=>{var n,r;return((r=(n=this.properties)==null?void 0:n.style)==null?void 0:r.name)||""})}formatDistance(n){return hn.measure("ElevationLine.formatDistance",()=>n>=1e3?`${(n/1e3).toFixed(2)} km`:`${n.toFixed(0)} m`)}formatElevation(n){return hn.measure("ElevationLine.formatElevation",()=>`${n.toFixed(0)} m`)}onAdd(n){return hn.measure("ElevationLine.onAdd",()=>(super.onAdd(n),this))}onRemove(n){return this.isDestroyed=!0,this.cleanupEventListeners(),this.cleanup(),super.onRemove(n)}async updateElevationProfile(){return hn.measure("ElevationLine.updateElevationProfile",async()=>{try{if(this.properties.elevationData&&this.properties.dataSource==="restored"){this.elevationData=this.properties.elevationData,this.calculateElevationStatistics(),this._map&&this._map.hasLayer(this)&&this.redraw(),this.fire("elevation:updated",{shape:this,elevationData:this.elevationData,properties:this.properties});return}await this.fetchElevationData(),this.updateProperties(),this._map&&this._map.hasLayer(this)&&this.redraw(),this.fire("elevation:updated",{shape:this,elevationData:this.elevationData,properties:this.properties})}catch(n){console.error("[ElevationLine] Erreur lors de la mise à jour du profil d'élévation:",n),this.properties.dataSource="error"}})}updateProperties(){hn.measure("ElevationLine.updateProperties",()=>{var n,r;if(super.updateProperties(),this.elevationData&&this.elevationData.length>0){const i=this.elevationData.map(D=>D.elevation),s=Math.max(...i),o=Math.min(...i);let u=0,f=0,d=0,g=0,y=0;for(let D=1;D<this.elevationData.length;D++){const I=this.elevationData[D-1],j=this.elevationData[D],Z=j.elevation-I.elevation;Z>0?u+=Z:f+=Math.abs(Z);const te=j.distance-I.distance;if(te>0){const ue=Z/te*100;d=Math.max(d,Math.abs(ue)),g+=Math.abs(ue),y++}}const _=this.getLatLngs().map(D=>({lat:D.lat,lng:D.lng})),M=((n=this.properties)==null?void 0:n.category)||"forages",T=((r=this.properties)==null?void 0:r.accessLevel)||"visitor";this.properties={...this.properties,type:"ElevationLine",coordinates:_,elevationData:this.elevationData.map(D=>({distance:D.distance,elevation:D.elevation})),maxElevation:s,minElevation:o,elevationGain:u,elevationLoss:f,maxSlope:d,averageSlope:y>0?g/y:0,dataSource:this.properties.dataSource||"api",category:M,accessLevel:T},this.fire("properties:updated",{shape:this,properties:this.properties})}})}getElevationData(){return hn.measure("ElevationLine.getElevationData",()=>this.elevationData)}};Gt(Qa,"API_URL","https://api.open-elevation.com/api/v1/lookup"),Gt(Qa,"RETRY_DELAY",2e3),Gt(Qa,"MAX_RETRIES",3),Gt(Qa,"SAMPLE_DISTANCE",100),Gt(Qa,"MIN_SAMPLES",10),Gt(Qa,"MAX_SAMPLES",50);let Cf=Qa;var _m={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */_m.exports;(function(e,t){(function(){var n,r="4.17.21",i=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",u="Invalid `variable` option passed into `_.template`",f="__lodash_hash_undefined__",d=500,g="__lodash_placeholder__",y=1,x=2,_=4,M=1,T=2,D=1,I=2,j=4,Z=8,te=16,ue=32,le=64,ge=128,H=256,U=512,Q=30,F="...",B=800,R=16,$=1,W=2,G=3,J=1/0,Y=9007199254740991,pe=17976931348623157e292,Le=NaN,De=4294967295,N=De-1,ee=De>>>1,fe=[["ary",ge],["bind",D],["bindKey",I],["curry",Z],["curryRight",te],["flip",U],["partial",ue],["partialRight",le],["rearg",H]],ce="[object Arguments]",_e="[object Array]",se="[object AsyncFunction]",k="[object Boolean]",ae="[object Date]",ke="[object DOMException]",Pe="[object Error]",Ge="[object Function]",K="[object GeneratorFunction]",de="[object Map]",ye="[object Number]",me="[object Null]",Ue="[object Object]",Qe="[object Promise]",Ze="[object Proxy]",He="[object RegExp]",Xe="[object Set]",tt="[object String]",Mt="[object Symbol]",Lt="[object Undefined]",jt="[object WeakMap]",zt="[object WeakSet]",sn="[object ArrayBuffer]",pn="[object DataView]",et="[object Float32Array]",ot="[object Float64Array]",rt="[object Int8Array]",Ht="[object Int16Array]",Qt="[object Int32Array]",On="[object Uint8Array]",wn="[object Uint8ClampedArray]",Tn="[object Uint16Array]",ar="[object Uint32Array]",xn=/\b__p \+= '';/g,Mn=/\b(__p \+=) '' \+/g,Pn=/(__e\(.*?\)|\b__t\)) \+\n'';/g,fr=/&(?:amp|lt|gt|quot|#39);/g,yr=/[&<>"']/g,at=RegExp(fr.source),We=RegExp(yr.source),It=/<%-([\s\S]+?)%>/g,En=/<%([\s\S]+?)%>/g,Jn=/<%=([\s\S]+?)%>/g,Zn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,qt=/^\w*$/,mn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Bt=/[\\^$.*+?()[\]{}|]/g,Kt=RegExp(Bt.source),Ln=/^\s+/,mr=/\s/,lt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Cn=/\{\n\/\* \[wrapped with (.+)\] \*/,xr=/,? & /,Ii=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Fr=/[()=,{}\[\]\/\s]/,Pr=/\\(\\)?/g,lr=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Hr=/\w*$/,ir=/^[-+]0x[0-9a-f]+$/i,Or=/^0b[01]+$/i,jr=/^\[object .+?Constructor\]$/,rn=/^0o[0-7]+$/i,ji=/^(?:0|[1-9]\d*)$/,_i=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,gi=/($^)/,Kr=/['\n\r\u2028\u2029\\]/g,Br="\\ud800-\\udfff",Rr="\\u0300-\\u036f",dr="\\ufe20-\\ufe2f",zi="\\u20d0-\\u20ff",Ss=Rr+dr+zi,Cs="\\u2700-\\u27bf",si="a-z\\xdf-\\xf6\\xf8-\\xff",jn="\\xac\\xb1\\xd7\\xf7",Po="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ci="\\u2000-\\u206f",hr=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",qn="A-Z\\xc0-\\xd6\\xd8-\\xde",bo="\\ufe0e\\ufe0f",wo=jn+Po+ci+hr,Lr="['’]",Us="["+Br+"]",Gn="["+wo+"]",_r="["+Ss+"]",Yr="\\d+",_n="["+Cs+"]",tn="["+si+"]",ai="[^"+Br+wo+Yr+Cs+si+qn+"]",fo="\\ud83c[\\udffb-\\udfff]",xo="(?:"+_r+"|"+fo+")",Mi="[^"+Br+"]",fs="(?:\\ud83c[\\udde6-\\uddff]){2}",Qo="[\\ud800-\\udbff][\\udc00-\\udfff]",Ro="["+qn+"]",di="\\u200d",Is="(?:"+tn+"|"+ai+")",Fo="(?:"+Ro+"|"+ai+")",eo="(?:"+Lr+"(?:d|ll|m|re|s|t|ve))?",Lo="(?:"+Lr+"(?:D|LL|M|RE|S|T|VE))?",Vs=xo+"?",va="["+bo+"]?",to="(?:"+di+"(?:"+[Mi,fs,Qo].join("|")+")"+va+Vs+")*",il="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ya="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",gr=va+Vs+to,br="(?:"+[_n,fs,Qo].join("|")+")"+gr,Jr="(?:"+[Mi+_r+"?",_r,fs,Qo,Us].join("|")+")",Nr=RegExp(Lr,"g"),jo=RegExp(_r,"g"),ol=RegExp(fo+"(?="+fo+")|"+Jr+gr,"g"),sl=RegExp([Ro+"?"+tn+"+"+eo+"(?="+[Gn,Ro,"$"].join("|")+")",Fo+"+"+Lo+"(?="+[Gn,Ro+Is,"$"].join("|")+")",Ro+"?"+Is+"+"+eo,Ro+"+"+Lo,ya,il,Yr,br].join("|"),"g"),Gs=RegExp("["+di+Br+Ss+bo+"]"),Ua=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,bu=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ml=-1,Sr={};Sr[et]=Sr[ot]=Sr[rt]=Sr[Ht]=Sr[Qt]=Sr[On]=Sr[wn]=Sr[Tn]=Sr[ar]=!0,Sr[ce]=Sr[_e]=Sr[sn]=Sr[k]=Sr[pn]=Sr[ae]=Sr[Pe]=Sr[Ge]=Sr[de]=Sr[ye]=Sr[Ue]=Sr[He]=Sr[Xe]=Sr[tt]=Sr[jt]=!1;var qr={};qr[ce]=qr[_e]=qr[sn]=qr[pn]=qr[k]=qr[ae]=qr[et]=qr[ot]=qr[rt]=qr[Ht]=qr[Qt]=qr[de]=qr[ye]=qr[Ue]=qr[He]=qr[Xe]=qr[tt]=qr[Mt]=qr[On]=qr[wn]=qr[Tn]=qr[ar]=!0,qr[Pe]=qr[Ge]=qr[jt]=!1;var Va={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Ku={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Al={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Jl={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},al=parseFloat,kl=parseInt,Xl=typeof ea=="object"&&ea&&ea.Object===Object&&ea,Xr=typeof self=="object"&&self&&self.Object===Object&&self,no=Xl||Xr||Function("return this")(),or=t&&!t.nodeType&&t,ro=or&&!0&&e&&!e.nodeType&&e,ll=ro&&ro.exports===or,_a=ll&&Xl.process,Ui=function(){try{var _t=ro&&ro.require&&ro.require("util").types;return _t||_a&&_a.binding&&_a.binding("util")}catch{}}(),Ql=Ui&&Ui.isArrayBuffer,ta=Ui&&Ui.isDate,Tl=Ui&&Ui.isMap,Nl=Ui&&Ui.isRegExp,Os=Ui&&Ui.isSet,Dl=Ui&&Ui.isTypedArray;function bi(_t,Zt,At){switch(At.length){case 0:return _t.call(Zt);case 1:return _t.call(Zt,At[0]);case 2:return _t.call(Zt,At[0],At[1]);case 3:return _t.call(Zt,At[0],At[1],At[2])}return _t.apply(Zt,At)}function Yu(_t,Zt,At,An){for(var Kn=-1,wr=_t==null?0:_t.length;++Kn<wr;){var Vi=_t[Kn];Zt(An,Vi,At(Vi),_t)}return An}function Mo(_t,Zt){for(var At=-1,An=_t==null?0:_t.length;++At<An&&Zt(_t[At],At,_t)!==!1;);return _t}function Hs(_t,Zt){for(var At=_t==null?0:_t.length;At--&&Zt(_t[At],At,_t)!==!1;);return _t}function Il(_t,Zt){for(var At=-1,An=_t==null?0:_t.length;++At<An;)if(!Zt(_t[At],At,_t))return!1;return!0}function qs(_t,Zt){for(var At=-1,An=_t==null?0:_t.length,Kn=0,wr=[];++At<An;){var Vi=_t[At];Zt(Vi,At,_t)&&(wr[Kn++]=Vi)}return wr}function ul(_t,Zt){var At=_t==null?0:_t.length;return!!At&&cn(_t,Zt,0)>-1}function cl(_t,Zt,At){for(var An=-1,Kn=_t==null?0:_t.length;++An<Kn;)if(At(Zt,_t[An]))return!0;return!1}function wi(_t,Zt){for(var At=-1,An=_t==null?0:_t.length,Kn=Array(An);++At<An;)Kn[At]=Zt(_t[At],At,_t);return Kn}function Es(_t,Zt){for(var At=-1,An=Zt.length,Kn=_t.length;++At<An;)_t[Kn+At]=Zt[At];return _t}function ba(_t,Zt,At,An){var Kn=-1,wr=_t==null?0:_t.length;for(An&&wr&&(At=_t[++Kn]);++Kn<wr;)At=Zt(At,_t[Kn],Kn,_t);return At}function io(_t,Zt,At,An){var Kn=_t==null?0:_t.length;for(An&&Kn&&(At=_t[--Kn]);Kn--;)At=Zt(At,_t[Kn],Kn,_t);return At}function O(_t,Zt){for(var At=-1,An=_t==null?0:_t.length;++At<An;)if(Zt(_t[At],At,_t))return!0;return!1}var be=vr("length");function Ke(_t){return _t.split("")}function ft(_t){return _t.match(Ii)||[]}function xt(_t,Zt,At){var An;return At(_t,function(Kn,wr,Vi){if(Zt(Kn,wr,Vi))return An=wr,!1}),An}function $t(_t,Zt,At,An){for(var Kn=_t.length,wr=At+(An?1:-1);An?wr--:++wr<Kn;)if(Zt(_t[wr],wr,_t))return wr;return-1}function cn(_t,Zt,At){return Zt===Zt?So(_t,Zt,At):$t(_t,zn,At)}function Nn(_t,Zt,At,An){for(var Kn=At-1,wr=_t.length;++Kn<wr;)if(An(_t[Kn],Zt))return Kn;return-1}function zn(_t){return _t!==_t}function nr(_t,Zt){var At=_t==null?0:_t.length;return At?xi(_t,Zt)/At:Le}function vr(_t){return function(Zt){return Zt==null?n:Zt[_t]}}function Ur(_t){return function(Zt){return _t==null?n:_t[Zt]}}function $i(_t,Zt,At,An,Kn){return Kn(_t,function(wr,Vi,Li){At=An?(An=!1,wr):Zt(At,wr,Vi,Li)}),At}function pi(_t,Zt){var At=_t.length;for(_t.sort(Zt);At--;)_t[At]=_t[At].value;return _t}function xi(_t,Zt){for(var At,An=-1,Kn=_t.length;++An<Kn;){var wr=Zt(_t[An]);wr!==n&&(At=At===n?wr:At+wr)}return At}function oo(_t,Zt){for(var At=-1,An=Array(_t);++At<_t;)An[At]=Zt(At);return An}function ho(_t,Zt){return wi(Zt,function(At){return[At,_t[At]]})}function Ps(_t){return _t&&_t.slice(0,xa(_t)+1).replace(Ln,"")}function Vr(_t){return function(Zt){return _t(Zt)}}function zo(_t,Zt){return wi(Zt,function(At){return _t[At]})}function fl(_t,Zt){return _t.has(Zt)}function es(_t,Zt){for(var At=-1,An=_t.length;++At<An&&cn(Zt,_t[At],0)>-1;);return At}function eu(_t,Zt){for(var At=_t.length;At--&&cn(Zt,_t[At],0)>-1;);return At}function na(_t,Zt){for(var At=_t.length,An=0;At--;)_t[At]===Zt&&++An;return An}var wu=Ur(Va),Ga=Ur(Ku);function Ha(_t){return"\\"+Jl[_t]}function po(_t,Zt){return _t==null?n:_t[Zt]}function ra(_t){return Gs.test(_t)}function Ms(_t){return Ua.test(_t)}function hs(_t){for(var Zt,At=[];!(Zt=_t.next()).done;)At.push(Zt.value);return At}function hl(_t){var Zt=-1,At=Array(_t.size);return _t.forEach(function(An,Kn){At[++Zt]=[Kn,An]}),At}function $o(_t,Zt){return function(At){return _t(Zt(At))}}function ts(_t,Zt){for(var At=-1,An=_t.length,Kn=0,wr=[];++At<An;){var Vi=_t[At];(Vi===Zt||Vi===g)&&(_t[At]=g,wr[Kn++]=At)}return wr}function ns(_t){var Zt=-1,At=Array(_t.size);return _t.forEach(function(An){At[++Zt]=An}),At}function Ju(_t){var Zt=-1,At=Array(_t.size);return _t.forEach(function(An){At[++Zt]=[An,An]}),At}function So(_t,Zt,At){for(var An=At-1,Kn=_t.length;++An<Kn;)if(_t[An]===Zt)return An;return-1}function wa(_t,Zt,At){for(var An=At+1;An--;)if(_t[An]===Zt)return An;return An}function Uo(_t){return ra(_t)?Go(_t):be(_t)}function Vo(_t){return ra(_t)?Ao(_t):Ke(_t)}function xa(_t){for(var Zt=_t.length;Zt--&&mr.test(_t.charAt(Zt)););return Zt}var La=Ur(Al);function Go(_t){for(var Zt=ol.lastIndex=0;ol.test(_t);)++Zt;return Zt}function Ao(_t){return _t.match(ol)||[]}function ia(_t){return _t.match(sl)||[]}var As=function _t(Zt){Zt=Zt==null?no:Ho.defaults(no.Object(),Zt,Ho.pick(no,bu));var At=Zt.Array,An=Zt.Date,Kn=Zt.Error,wr=Zt.Function,Vi=Zt.Math,Li=Zt.Object,Ol=Zt.RegExp,rs=Zt.String,Gi=Zt.TypeError,oa=At.prototype,Sa=wr.prototype,sa=Li.prototype,aa=Zt["__core-js_shared__"],la=Sa.toString,Qr=sa.hasOwnProperty,Ws=0,ko=function(){var c=/[^.]+$/.exec(aa&&aa.keys&&aa.keys.IE_PROTO||"");return c?"Symbol(src)_1."+c:""}(),Si=sa.toString,Ai=la.call(Li),so=no._,Ri=Ol("^"+la.call(Qr).replace(Bt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ks=ll?Zt.Buffer:n,ds=Zt.Symbol,Bs=Zt.Uint8Array,xu=ks?ks.allocUnsafe:n,ua=$o(Li.getPrototypeOf,Li),go=Li.create,Oi=sa.propertyIsEnumerable,qo=oa.splice,ps=ds?ds.isConcatSpreadable:n,pr=ds?ds.iterator:n,Ca=ds?ds.toStringTag:n,Ea=function(){try{var c=Rf(Li,"defineProperty");return c({},"",{}),c}catch{}}(),Zs=Zt.clearTimeout!==no.clearTimeout&&Zt.clearTimeout,is=An&&An.now!==no.Date.now&&An.now,bc=Zt.setTimeout!==no.setTimeout&&Zt.setTimeout,To=Vi.ceil,No=Vi.floor,Ks=Li.getOwnPropertySymbols,a=ks?ks.isBuffer:n,p=Zt.isFinite,S=oa.join,V=$o(Li.keys,Li),ie=Vi.max,Ce=Vi.min,st=An.now,Pt=Zt.parseInt,Ut=Vi.random,an=oa.reverse,Dn=Rf(Zt,"DataView"),Xn=Rf(Zt,"Map"),zr=Rf(Zt,"Promise"),mo=Rf(Zt,"Set"),Ji=Rf(Zt,"WeakMap"),Do=Rf(Li,"create"),Hi=Ji&&new Ji,gs={},wc=Ff(Dn),ca=Ff(Xn),Ys=Ff(zr),Rs=Ff(mo),kf=Ff(Ji),tu=ds?ds.prototype:n,mi=tu?tu.valueOf:n,Wo=tu?tu.toString:n;function Ne(c){if(os(c)&&!ti(c)&&!(c instanceof Gr)){if(c instanceof Io)return c;if(Qr.call(c,"__wrapped__"))return Jy(c)}return new Io(c)}var ms=function(){function c(){}return function(m){if(!Ko(m))return{};if(go)return go(m);c.prototype=m;var A=new c;return c.prototype=n,A}}();function Lu(){}function Io(c,m){this.__wrapped__=c,this.__actions__=[],this.__chain__=!!m,this.__index__=0,this.__values__=n}Ne.templateSettings={escape:It,evaluate:En,interpolate:Jn,variable:"",imports:{_:Ne}},Ne.prototype=Lu.prototype,Ne.prototype.constructor=Ne,Io.prototype=ms(Lu.prototype),Io.prototype.constructor=Io;function Gr(c){this.__wrapped__=c,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=De,this.__views__=[]}function Wc(){var c=new Gr(this.__wrapped__);return c.__actions__=pl(this.__actions__),c.__dir__=this.__dir__,c.__filtered__=this.__filtered__,c.__iteratees__=pl(this.__iteratees__),c.__takeCount__=this.__takeCount__,c.__views__=pl(this.__views__),c}function uh(){if(this.__filtered__){var c=new Gr(this);c.__dir__=-1,c.__filtered__=!0}else c=this.clone(),c.__dir__*=-1;return c}function Zc(){var c=this.__wrapped__.value(),m=this.__dir__,A=ti(c),ne=m<0,xe=A?c.length:0,Re=h3(0,xe,this.__views__),it=Re.start,mt=Re.end,Et=mt-it,ln=ne?mt:it-1,un=this.__iteratees__,vn=un.length,Un=0,sr=Ce(Et,this.__takeCount__);if(!A||!ne&&xe==Et&&sr==Et)return nu(c,this.__actions__);var Mr=[];e:for(;Et--&&Un<sr;){ln+=m;for(var fi=-1,Ar=c[ln];++fi<vn;){var Ci=un[fi],Ti=Ci.iteratee,Fl=Ci.type,Ka=Ti(Ar);if(Fl==W)Ar=Ka;else if(!Ka){if(Fl==$)continue e;break e}}Mr[Un++]=Ar}return Mr}Gr.prototype=ms(Lu.prototype),Gr.prototype.constructor=Gr;function qa(c){var m=-1,A=c==null?0:c.length;for(this.clear();++m<A;){var ne=c[m];this.set(ne[0],ne[1])}}function xc(){this.__data__=Do?Do(null):{},this.size=0}function Tf(c){var m=this.has(c)&&delete this.__data__[c];return this.size-=m?1:0,m}function gd(c){var m=this.__data__;if(Do){var A=m[c];return A===f?n:A}return Qr.call(m,c)?m[c]:n}function Xu(c){var m=this.__data__;return Do?m[c]!==n:Qr.call(m,c)}function Kc(c,m){var A=this.__data__;return this.size+=this.has(c)?0:1,A[c]=Do&&m===n?f:m,this}qa.prototype.clear=xc,qa.prototype.delete=Tf,qa.prototype.get=gd,qa.prototype.has=Xu,qa.prototype.set=Kc;function Bl(c){var m=-1,A=c==null?0:c.length;for(this.clear();++m<A;){var ne=c[m];this.set(ne[0],ne[1])}}function md(){this.__data__=[],this.size=0}function Yc(c){var m=this.__data__,A=yt(m,c);if(A<0)return!1;var ne=m.length-1;return A==ne?m.pop():qo.call(m,A,1),--this.size,!0}function Jc(c){var m=this.__data__,A=yt(m,c);return A<0?n:m[A][1]}function ch(c){return yt(this.__data__,c)>-1}function fh(c,m){var A=this.__data__,ne=yt(A,c);return ne<0?(++this.size,A.push([c,m])):A[ne][1]=m,this}Bl.prototype.clear=md,Bl.prototype.delete=Yc,Bl.prototype.get=Jc,Bl.prototype.has=ch,Bl.prototype.set=fh;function Pa(c){var m=-1,A=c==null?0:c.length;for(this.clear();++m<A;){var ne=c[m];this.set(ne[0],ne[1])}}function hh(){this.size=0,this.__data__={hash:new qa,map:new(Xn||Bl),string:new qa}}function dh(c){var m=Xp(this,c).delete(c);return this.size-=m?1:0,m}function ph(c){return Xp(this,c).get(c)}function b(c){return Xp(this,c).has(c)}function P(c,m){var A=Xp(this,c),ne=A.size;return A.set(c,m),this.size+=A.size==ne?0:1,this}Pa.prototype.clear=hh,Pa.prototype.delete=dh,Pa.prototype.get=ph,Pa.prototype.has=b,Pa.prototype.set=P;function q(c){var m=-1,A=c==null?0:c.length;for(this.__data__=new Pa;++m<A;)this.add(c[m])}function oe(c){return this.__data__.set(c,f),this}function we(c){return this.__data__.has(c)}q.prototype.add=q.prototype.push=oe,q.prototype.has=we;function Ee(c){var m=this.__data__=new Bl(c);this.size=m.size}function Ae(){this.__data__=new Bl,this.size=0}function Te(c){var m=this.__data__,A=m.delete(c);return this.size=m.size,A}function Ie(c){return this.__data__.get(c)}function Ve(c){return this.__data__.has(c)}function dt(c,m){var A=this.__data__;if(A instanceof Bl){var ne=A.__data__;if(!Xn||ne.length<i-1)return ne.push([c,m]),this.size=++A.size,this;A=this.__data__=new Pa(ne)}return A.set(c,m),this.size=A.size,this}Ee.prototype.clear=Ae,Ee.prototype.delete=Te,Ee.prototype.get=Ie,Ee.prototype.has=Ve,Ee.prototype.set=dt;function Nt(c,m){var A=ti(c),ne=!A&&jf(c),xe=!A&&!ne&&Qc(c),Re=!A&&!ne&&!xe&&Lh(c),it=A||ne||xe||Re,mt=it?oo(c.length,rs):[],Et=mt.length;for(var ln in c)(m||Qr.call(c,ln))&&!(it&&(ln=="length"||xe&&(ln=="offset"||ln=="parent")||Re&&(ln=="buffer"||ln=="byteLength"||ln=="byteOffset")||Mc(ln,Et)))&&mt.push(ln);return mt}function Dt(c){var m=c.length;return m?c[If(0,m-1)]:n}function wt(c,m){return Qp(pl(c),Qn(m,0,c.length))}function Yt(c){return Qp(pl(c))}function Vt(c,m,A){(A!==n&&!Au(c[m],A)||A===n&&!(m in c))&&kn(c,m,A)}function pt(c,m,A){var ne=c[m];(!(Qr.call(c,m)&&Au(ne,A))||A===n&&!(m in c))&&kn(c,m,A)}function yt(c,m){for(var A=c.length;A--;)if(Au(c[A][0],m))return A;return-1}function en(c,m,A,ne){return z(c,function(xe,Re,it){m(ne,xe,A(xe),it)}),ne}function fn(c,m){return c&&tc(m,Js(m),c)}function nn(c,m){return c&&tc(m,ml(m),c)}function kn(c,m,A){m=="__proto__"&&Ea?Ea(c,m,{configurable:!0,enumerable:!0,value:A,writable:!0}):c[m]=A}function Sn(c,m){for(var A=-1,ne=m.length,xe=At(ne),Re=c==null;++A<ne;)xe[A]=Re?n:P0(c,m[A]);return xe}function Qn(c,m,A){return c===c&&(A!==n&&(c=c<=A?c:A),m!==n&&(c=c>=m?c:m)),c}function l(c,m,A,ne,xe,Re){var it,mt=m&y,Et=m&x,ln=m&_;if(A&&(it=xe?A(c,ne,xe,Re):A(c)),it!==n)return it;if(!Ko(c))return c;var un=ti(c);if(un){if(it=p3(c),!mt)return pl(c,it)}else{var vn=Aa(c),Un=vn==Ge||vn==K;if(Qc(c))return Ly(c,mt);if(vn==Ue||vn==ce||Un&&!xe){if(it=Et||Un?{}:Uy(c),!mt)return Et?r3(c,nn(it,c)):n3(c,fn(it,c))}else{if(!qr[vn])return xe?c:{};it=g3(c,vn,mt)}}Re||(Re=new Ee);var sr=Re.get(c);if(sr)return sr;Re.set(c,it),v2(c)?c.forEach(function(Ar){it.add(l(Ar,m,A,Ar,c,Re))}):g2(c)&&c.forEach(function(Ar,Ci){it.set(Ci,l(Ar,m,A,Ci,c,Re))});var Mr=ln?Et?d0:h0:Et?ml:Js,fi=un?n:Mr(c);return Mo(fi||c,function(Ar,Ci){fi&&(Ci=Ar,Ar=c[Ci]),pt(it,Ci,l(Ar,m,A,Ci,c,Re))}),it}function h(c){var m=Js(c);return function(A){return v(A,c,m)}}function v(c,m,A){var ne=A.length;if(c==null)return!ne;for(c=Li(c);ne--;){var xe=A[ne],Re=m[xe],it=c[xe];if(it===n&&!(xe in c)||!Re(it))return!1}return!0}function w(c,m,A){if(typeof c!="function")throw new Gi(o);return wd(function(){c.apply(n,A)},m)}function C(c,m,A,ne){var xe=-1,Re=ul,it=!0,mt=c.length,Et=[],ln=m.length;if(!mt)return Et;A&&(m=wi(m,Vr(A))),ne?(Re=cl,it=!1):m.length>=i&&(Re=fl,it=!1,m=new q(m));e:for(;++xe<mt;){var un=c[xe],vn=A==null?un:A(un);if(un=ne||un!==0?un:0,it&&vn===vn){for(var Un=ln;Un--;)if(m[Un]===vn)continue e;Et.push(un)}else Re(m,vn,ne)||Et.push(un)}return Et}var z=My(Xt),X=My(yn,!0);function re(c,m){var A=!0;return z(c,function(ne,xe,Re){return A=!!m(ne,xe,Re),A}),A}function he(c,m,A){for(var ne=-1,xe=c.length;++ne<xe;){var Re=c[ne],it=m(Re);if(it!=null&&(mt===n?it===it&&!Rl(it):A(it,mt)))var mt=it,Et=Re}return Et}function Se(c,m,A,ne){var xe=c.length;for(A=ui(A),A<0&&(A=-A>xe?0:xe+A),ne=ne===n||ne>xe?xe:ui(ne),ne<0&&(ne+=xe),ne=A>ne?0:_2(ne);A<ne;)c[A++]=m;return c}function Je(c,m){var A=[];return z(c,function(ne,xe,Re){m(ne,xe,Re)&&A.push(ne)}),A}function ze(c,m,A,ne,xe){var Re=-1,it=c.length;for(A||(A=v3),xe||(xe=[]);++Re<it;){var mt=c[Re];m>0&&A(mt)?m>1?ze(mt,m-1,A,ne,xe):Es(xe,mt):ne||(xe[xe.length]=mt)}return xe}var vt=Ay(),kt=Ay(!0);function Xt(c,m){return c&&vt(c,m,Js)}function yn(c,m){return c&&kt(c,m,Js)}function bn(c,m){return qs(m,function(A){return Ac(c[A])})}function ur(c,m){m=Mu(m,c);for(var A=0,ne=m.length;c!=null&&A<ne;)c=c[nc(m[A++])];return A&&A==ne?c:n}function Ye(c,m,A){var ne=m(c);return ti(c)?ne:Es(ne,A(c))}function nt(c){return c==null?c===n?Lt:me:Ca&&Ca in Li(c)?f3(c):S3(c)}function ht(c,m){return c>m}function Ot(c,m){return c!=null&&Qr.call(c,m)}function bt(c,m){return c!=null&&m in Li(c)}function Tt(c,m,A){return c>=Ce(m,A)&&c<ie(m,A)}function ve(c,m,A){for(var ne=A?cl:ul,xe=c[0].length,Re=c.length,it=Re,mt=At(Re),Et=1/0,ln=[];it--;){var un=c[it];it&&m&&(un=wi(un,Vr(m))),Et=Ce(un.length,Et),mt[it]=!A&&(m||xe>=120&&un.length>=120)?new q(it&&un):n}un=c[0];var vn=-1,Un=mt[0];e:for(;++vn<xe&&ln.length<Et;){var sr=un[vn],Mr=m?m(sr):sr;if(sr=A||sr!==0?sr:0,!(Un?fl(Un,Mr):ne(ln,Mr,A))){for(it=Re;--it;){var fi=mt[it];if(!(fi?fl(fi,Mr):ne(c[it],Mr,A)))continue e}Un&&Un.push(Mr),ln.push(sr)}}return ln}function Me(c,m,A,ne){return Xt(c,function(xe,Re,it){m(ne,A(xe),Re,it)}),ne}function Be(c,m,A){m=Mu(m,c),c=qy(c,m);var ne=c==null?c:c[nc(ou(m))];return ne==null?n:bi(ne,c,A)}function Oe(c){return os(c)&&nt(c)==ce}function Fe(c){return os(c)&&nt(c)==sn}function je(c){return os(c)&&nt(c)==ae}function ut(c,m,A,ne,xe){return c===m?!0:c==null||m==null||!os(c)&&!os(m)?c!==c&&m!==m:ct(c,m,A,ne,ut,xe)}function ct(c,m,A,ne,xe,Re){var it=ti(c),mt=ti(m),Et=it?_e:Aa(c),ln=mt?_e:Aa(m);Et=Et==ce?Ue:Et,ln=ln==ce?Ue:ln;var un=Et==Ue,vn=ln==Ue,Un=Et==ln;if(Un&&Qc(c)){if(!Qc(m))return!1;it=!0,un=!1}if(Un&&!un)return Re||(Re=new Ee),it||Lh(c)?jy(c,m,A,ne,xe,Re):u3(c,m,Et,A,ne,xe,Re);if(!(A&M)){var sr=un&&Qr.call(c,"__wrapped__"),Mr=vn&&Qr.call(m,"__wrapped__");if(sr||Mr){var fi=sr?c.value():c,Ar=Mr?m.value():m;return Re||(Re=new Ee),xe(fi,Ar,A,ne,Re)}}return Un?(Re||(Re=new Ee),c3(c,m,A,ne,xe,Re)):!1}function gt(c){return os(c)&&Aa(c)==de}function St(c,m,A,ne){var xe=A.length,Re=xe,it=!ne;if(c==null)return!Re;for(c=Li(c);xe--;){var mt=A[xe];if(it&&mt[2]?mt[1]!==c[mt[0]]:!(mt[0]in c))return!1}for(;++xe<Re;){mt=A[xe];var Et=mt[0],ln=c[Et],un=mt[1];if(it&&mt[2]){if(ln===n&&!(Et in c))return!1}else{var vn=new Ee;if(ne)var Un=ne(ln,un,Et,c,m,vn);if(!(Un===n?ut(un,ln,M|T,ne,vn):Un))return!1}}return!0}function Ct(c){if(!Ko(c)||_3(c))return!1;var m=Ac(c)?Ri:jr;return m.test(Ff(c))}function on(c){return os(c)&&nt(c)==He}function $n(c){return os(c)&&Aa(c)==Xe}function Hn(c){return os(c)&&og(c.length)&&!!Sr[nt(c)]}function er(c){return typeof c=="function"?c:c==null?vl:typeof c=="object"?ti(c)?Su(c[0],c[1]):vs(c):k2(c)}function vi(c){if(!bd(c))return V(c);var m=[];for(var A in Li(c))Qr.call(c,A)&&A!="constructor"&&m.push(A);return m}function ki(c){if(!Ko(c))return L3(c);var m=bd(c),A=[];for(var ne in c)ne=="constructor"&&(m||!Qr.call(c,ne))||A.push(ne);return A}function ei(c,m){return c<m}function Fi(c,m){var A=-1,ne=gl(c)?At(c.length):[];return z(c,function(xe,Re,it){ne[++A]=m(xe,Re,it)}),ne}function vs(c){var m=g0(c);return m.length==1&&m[0][2]?Gy(m[0][0],m[0][1]):function(A){return A===c||St(A,c,m)}}function Su(c,m){return v0(c)&&Vy(m)?Gy(nc(c),m):function(A){var ne=P0(A,c);return ne===n&&ne===m?M0(A,c):ut(m,ne,M|T)}}function fa(c,m,A,ne,xe){c!==m&&vt(m,function(Re,it){if(xe||(xe=new Ee),Ko(Re))Nf(c,m,it,A,fa,ne,xe);else{var mt=ne?ne(_0(c,it),Re,it+"",c,m,xe):n;mt===n&&(mt=Re),Vt(c,it,mt)}},ml)}function Nf(c,m,A,ne,xe,Re,it){var mt=_0(c,A),Et=_0(m,A),ln=it.get(Et);if(ln){Vt(c,A,ln);return}var un=Re?Re(mt,Et,A+"",c,m,it):n,vn=un===n;if(vn){var Un=ti(Et),sr=!Un&&Qc(Et),Mr=!Un&&!sr&&Lh(Et);un=Et,Un||sr||Mr?ti(mt)?un=mt:ys(mt)?un=pl(mt):sr?(vn=!1,un=Ly(Et,!0)):Mr?(vn=!1,un=Sy(Et,!0)):un=[]:xd(Et)||jf(Et)?(un=mt,jf(mt)?un=b2(mt):(!Ko(mt)||Ac(mt))&&(un=Uy(Et))):vn=!1}vn&&(it.set(Et,un),xe(un,Et,ne,Re,it),it.delete(Et)),Vt(c,A,un)}function Wa(c,m){var A=c.length;if(A)return m+=m<0?A:0,Mc(m,A)?c[m]:n}function Qu(c,m,A){m.length?m=wi(m,function(Re){return ti(Re)?function(it){return ur(it,Re.length===1?Re[0]:Re)}:Re}):m=[vl];var ne=-1;m=wi(m,Vr(Cr()));var xe=Fi(c,function(Re,it,mt){var Et=wi(m,function(ln){return ln(Re)});return{criteria:Et,index:++ne,value:Re}});return pi(xe,function(Re,it){return t3(Re,it,A)})}function ha(c,m){return Zo(c,m,function(A,ne){return M0(c,ne)})}function Zo(c,m,A){for(var ne=-1,xe=m.length,Re={};++ne<xe;){var it=m[ne],mt=ur(c,it);A(mt,it)&&Lc(Re,Mu(it,c),mt)}return Re}function ao(c){return function(m){return ur(m,c)}}function gh(c,m,A,ne){var xe=ne?Nn:cn,Re=-1,it=m.length,mt=c;for(c===m&&(m=pl(m)),A&&(mt=wi(c,Vr(A)));++Re<it;)for(var Et=0,ln=m[Re],un=A?A(ln):ln;(Et=xe(mt,un,Et,ne))>-1;)mt!==c&&qo.call(mt,Et,1),qo.call(c,Et,1);return c}function Df(c,m){for(var A=c?m.length:0,ne=A-1;A--;){var xe=m[A];if(A==ne||xe!==Re){var Re=xe;Mc(xe)?qo.call(c,xe,1):Sc(c,xe)}}return c}function If(c,m){return c+No(Ut()*(m-c+1))}function Of(c,m,A,ne){for(var xe=-1,Re=ie(To((m-c)/(A||1)),0),it=At(Re);Re--;)it[ne?Re:++xe]=c,c+=A;return it}function mh(c,m){var A="";if(!c||m<1||m>Y)return A;do m%2&&(A+=c),m=No(m/2),m&&(c+=c);while(m);return A}function li(c,m){return b0(Hy(c,m,vl),c+"")}function vh(c){return Dt(Sh(c))}function $p(c,m){var A=Sh(c);return Qp(A,Qn(m,0,A.length))}function Lc(c,m,A,ne){if(!Ko(c))return c;m=Mu(m,c);for(var xe=-1,Re=m.length,it=Re-1,mt=c;mt!=null&&++xe<Re;){var Et=nc(m[xe]),ln=A;if(Et==="__proto__"||Et==="constructor"||Et==="prototype")return c;if(xe!=it){var un=mt[Et];ln=ne?ne(un,Et,mt):n,ln===n&&(ln=Ko(un)?un:Mc(m[xe+1])?[]:{})}pt(mt,Et,ln),mt=mt[Et]}return c}var Cu=Hi?function(c,m){return Hi.set(c,m),c}:vl,Up=Ea?function(c,m){return Ea(c,"toString",{configurable:!0,enumerable:!1,value:k0(m),writable:!0})}:vl;function Vp(c){return Qp(Sh(c))}function dl(c,m,A){var ne=-1,xe=c.length;m<0&&(m=-m>xe?0:xe+m),A=A>xe?xe:A,A<0&&(A+=xe),xe=m>A?0:A-m>>>0,m>>>=0;for(var Re=At(xe);++ne<xe;)Re[ne]=c[ne+m];return Re}function Gp(c,m){var A;return z(c,function(ne,xe,Re){return A=m(ne,xe,Re),!A}),!!A}function Eu(c,m,A){var ne=0,xe=c==null?ne:c.length;if(typeof m=="number"&&m===m&&xe<=ee){for(;ne<xe;){var Re=ne+xe>>>1,it=c[Re];it!==null&&!Rl(it)&&(A?it<=m:it<m)?ne=Re+1:xe=Re}return xe}return vd(c,m,vl,A)}function vd(c,m,A,ne){var xe=0,Re=c==null?0:c.length;if(Re===0)return 0;m=A(m);for(var it=m!==m,mt=m===null,Et=Rl(m),ln=m===n;xe<Re;){var un=No((xe+Re)/2),vn=A(c[un]),Un=vn!==n,sr=vn===null,Mr=vn===vn,fi=Rl(vn);if(it)var Ar=ne||Mr;else ln?Ar=Mr&&(ne||Un):mt?Ar=Mr&&Un&&(ne||!sr):Et?Ar=Mr&&Un&&!sr&&(ne||!fi):sr||fi?Ar=!1:Ar=ne?vn<=m:vn<m;Ar?xe=un+1:Re=un}return Ce(Re,N)}function yd(c,m){for(var A=-1,ne=c.length,xe=0,Re=[];++A<ne;){var it=c[A],mt=m?m(it):it;if(!A||!Au(mt,Et)){var Et=mt;Re[xe++]=it===0?0:it}}return Re}function Hp(c){return typeof c=="number"?c:Rl(c)?Le:+c}function Ma(c){if(typeof c=="string")return c;if(ti(c))return wi(c,Ma)+"";if(Rl(c))return Wo?Wo.call(c):"";var m=c+"";return m=="0"&&1/c==-1/0?"-0":m}function ec(c,m,A){var ne=-1,xe=ul,Re=c.length,it=!0,mt=[],Et=mt;if(A)it=!1,xe=cl;else if(Re>=i){var ln=m?null:a3(c);if(ln)return ns(ln);it=!1,xe=fl,Et=new q}else Et=m?[]:mt;e:for(;++ne<Re;){var un=c[ne],vn=m?m(un):un;if(un=A||un!==0?un:0,it&&vn===vn){for(var Un=Et.length;Un--;)if(Et[Un]===vn)continue e;m&&Et.push(vn),mt.push(un)}else xe(Et,vn,A)||(Et!==mt&&Et.push(vn),mt.push(un))}return mt}function Sc(c,m){return m=Mu(m,c),c=qy(c,m),c==null||delete c[nc(ou(m))]}function yh(c,m,A,ne){return Lc(c,m,A(ur(c,m)),ne)}function Cc(c,m,A,ne){for(var xe=c.length,Re=ne?xe:-1;(ne?Re--:++Re<xe)&&m(c[Re],Re,c););return A?dl(c,ne?0:Re,ne?Re+1:xe):dl(c,ne?Re+1:0,ne?xe:Re)}function nu(c,m){var A=c;return A instanceof Gr&&(A=A.value()),ba(m,function(ne,xe){return xe.func.apply(xe.thisArg,Es([ne],xe.args))},A)}function ru(c,m,A){var ne=c.length;if(ne<2)return ne?ec(c[0]):[];for(var xe=-1,Re=At(ne);++xe<ne;)for(var it=c[xe],mt=-1;++mt<ne;)mt!=xe&&(Re[xe]=C(Re[xe]||it,c[mt],m,A));return ec(ze(Re,1),m,A)}function Pu(c,m,A){for(var ne=-1,xe=c.length,Re=m.length,it={};++ne<xe;){var mt=ne<Re?m[ne]:n;A(it,c[ne],mt)}return it}function Xc(c){return ys(c)?c:[]}function Bf(c){return typeof c=="function"?c:vl}function Mu(c,m){return ti(c)?c:v0(c,m)?[c]:Yy(Zi(c))}var l0=li;function iu(c,m,A){var ne=c.length;return A=A===n?ne:A,!m&&A>=ne?c:dl(c,m,A)}var _h=Zs||function(c){return no.clearTimeout(c)};function Ly(c,m){if(m)return c.slice();var A=c.length,ne=xu?xu(A):new c.constructor(A);return c.copy(ne),ne}function u0(c){var m=new c.constructor(c.byteLength);return new Bs(m).set(new Bs(c)),m}function Xx(c,m){var A=m?u0(c.buffer):c.buffer;return new c.constructor(A,c.byteOffset,c.byteLength)}function Qx(c){var m=new c.constructor(c.source,Hr.exec(c));return m.lastIndex=c.lastIndex,m}function e3(c){return mi?Li(mi.call(c)):{}}function Sy(c,m){var A=m?u0(c.buffer):c.buffer;return new c.constructor(A,c.byteOffset,c.length)}function Cy(c,m){if(c!==m){var A=c!==n,ne=c===null,xe=c===c,Re=Rl(c),it=m!==n,mt=m===null,Et=m===m,ln=Rl(m);if(!mt&&!ln&&!Re&&c>m||Re&&it&&Et&&!mt&&!ln||ne&&it&&Et||!A&&Et||!xe)return 1;if(!ne&&!Re&&!ln&&c<m||ln&&A&&xe&&!ne&&!Re||mt&&A&&xe||!it&&xe||!Et)return-1}return 0}function t3(c,m,A){for(var ne=-1,xe=c.criteria,Re=m.criteria,it=xe.length,mt=A.length;++ne<it;){var Et=Cy(xe[ne],Re[ne]);if(Et){if(ne>=mt)return Et;var ln=A[ne];return Et*(ln=="desc"?-1:1)}}return c.index-m.index}function Ey(c,m,A,ne){for(var xe=-1,Re=c.length,it=A.length,mt=-1,Et=m.length,ln=ie(Re-it,0),un=At(Et+ln),vn=!ne;++mt<Et;)un[mt]=m[mt];for(;++xe<it;)(vn||xe<Re)&&(un[A[xe]]=c[xe]);for(;ln--;)un[mt++]=c[xe++];return un}function Py(c,m,A,ne){for(var xe=-1,Re=c.length,it=-1,mt=A.length,Et=-1,ln=m.length,un=ie(Re-mt,0),vn=At(un+ln),Un=!ne;++xe<un;)vn[xe]=c[xe];for(var sr=xe;++Et<ln;)vn[sr+Et]=m[Et];for(;++it<mt;)(Un||xe<Re)&&(vn[sr+A[it]]=c[xe++]);return vn}function pl(c,m){var A=-1,ne=c.length;for(m||(m=At(ne));++A<ne;)m[A]=c[A];return m}function tc(c,m,A,ne){var xe=!A;A||(A={});for(var Re=-1,it=m.length;++Re<it;){var mt=m[Re],Et=ne?ne(A[mt],c[mt],mt,A,c):n;Et===n&&(Et=c[mt]),xe?kn(A,mt,Et):pt(A,mt,Et)}return A}function n3(c,m){return tc(c,m0(c),m)}function r3(c,m){return tc(c,zy(c),m)}function qp(c,m){return function(A,ne){var xe=ti(A)?Yu:en,Re=m?m():{};return xe(A,c,Cr(ne,2),Re)}}function bh(c){return li(function(m,A){var ne=-1,xe=A.length,Re=xe>1?A[xe-1]:n,it=xe>2?A[2]:n;for(Re=c.length>3&&typeof Re=="function"?(xe--,Re):n,it&&Za(A[0],A[1],it)&&(Re=xe<3?n:Re,xe=1),m=Li(m);++ne<xe;){var mt=A[ne];mt&&c(m,mt,ne,Re)}return m})}function My(c,m){return function(A,ne){if(A==null)return A;if(!gl(A))return c(A,ne);for(var xe=A.length,Re=m?xe:-1,it=Li(A);(m?Re--:++Re<xe)&&ne(it[Re],Re,it)!==!1;);return A}}function Ay(c){return function(m,A,ne){for(var xe=-1,Re=Li(m),it=ne(m),mt=it.length;mt--;){var Et=it[c?mt:++xe];if(A(Re[Et],Et,Re)===!1)break}return m}}function i3(c,m,A){var ne=m&D,xe=_d(c);function Re(){var it=this&&this!==no&&this instanceof Re?xe:c;return it.apply(ne?A:this,arguments)}return Re}function ky(c){return function(m){m=Zi(m);var A=ra(m)?Vo(m):n,ne=A?A[0]:m.charAt(0),xe=A?iu(A,1).join(""):m.slice(1);return ne[c]()+xe}}function wh(c){return function(m){return ba(M2(P2(m).replace(Nr,"")),c,"")}}function _d(c){return function(){var m=arguments;switch(m.length){case 0:return new c;case 1:return new c(m[0]);case 2:return new c(m[0],m[1]);case 3:return new c(m[0],m[1],m[2]);case 4:return new c(m[0],m[1],m[2],m[3]);case 5:return new c(m[0],m[1],m[2],m[3],m[4]);case 6:return new c(m[0],m[1],m[2],m[3],m[4],m[5]);case 7:return new c(m[0],m[1],m[2],m[3],m[4],m[5],m[6])}var A=ms(c.prototype),ne=c.apply(A,m);return Ko(ne)?ne:A}}function o3(c,m,A){var ne=_d(c);function xe(){for(var Re=arguments.length,it=At(Re),mt=Re,Et=xh(xe);mt--;)it[mt]=arguments[mt];var ln=Re<3&&it[0]!==Et&&it[Re-1]!==Et?[]:ts(it,Et);if(Re-=ln.length,Re<A)return Oy(c,m,Wp,xe.placeholder,n,it,ln,n,n,A-Re);var un=this&&this!==no&&this instanceof xe?ne:c;return bi(un,this,it)}return xe}function Ty(c){return function(m,A,ne){var xe=Li(m);if(!gl(m)){var Re=Cr(A,3);m=Js(m),A=function(mt){return Re(xe[mt],mt,xe)}}var it=c(m,A,ne);return it>-1?xe[Re?m[it]:it]:n}}function Ny(c){return Pc(function(m){var A=m.length,ne=A,xe=Io.prototype.thru;for(c&&m.reverse();ne--;){var Re=m[ne];if(typeof Re!="function")throw new Gi(o);if(xe&&!it&&Jp(Re)=="wrapper")var it=new Io([],!0)}for(ne=it?ne:A;++ne<A;){Re=m[ne];var mt=Jp(Re),Et=mt=="wrapper"?p0(Re):n;Et&&y0(Et[0])&&Et[1]==(ge|Z|ue|H)&&!Et[4].length&&Et[9]==1?it=it[Jp(Et[0])].apply(it,Et[3]):it=Re.length==1&&y0(Re)?it[mt]():it.thru(Re)}return function(){var ln=arguments,un=ln[0];if(it&&ln.length==1&&ti(un))return it.plant(un).value();for(var vn=0,Un=A?m[vn].apply(this,ln):un;++vn<A;)Un=m[vn].call(this,Un);return Un}})}function Wp(c,m,A,ne,xe,Re,it,mt,Et,ln){var un=m&ge,vn=m&D,Un=m&I,sr=m&(Z|te),Mr=m&U,fi=Un?n:_d(c);function Ar(){for(var Ci=arguments.length,Ti=At(Ci),Fl=Ci;Fl--;)Ti[Fl]=arguments[Fl];if(sr)var Ka=xh(Ar),jl=na(Ti,Ka);if(ne&&(Ti=Ey(Ti,ne,xe,sr)),Re&&(Ti=Py(Ti,Re,it,sr)),Ci-=jl,sr&&Ci<ln){var _s=ts(Ti,Ka);return Oy(c,m,Wp,Ar.placeholder,A,Ti,_s,mt,Et,ln-Ci)}var ku=vn?A:this,Tc=Un?ku[c]:c;return Ci=Ti.length,mt?Ti=C3(Ti,mt):Mr&&Ci>1&&Ti.reverse(),un&&Et<Ci&&(Ti.length=Et),this&&this!==no&&this instanceof Ar&&(Tc=fi||_d(Tc)),Tc.apply(ku,Ti)}return Ar}function Dy(c,m){return function(A,ne){return Me(A,c,m(ne),{})}}function Zp(c,m){return function(A,ne){var xe;if(A===n&&ne===n)return m;if(A!==n&&(xe=A),ne!==n){if(xe===n)return ne;typeof A=="string"||typeof ne=="string"?(A=Ma(A),ne=Ma(ne)):(A=Hp(A),ne=Hp(ne)),xe=c(A,ne)}return xe}}function c0(c){return Pc(function(m){return m=wi(m,Vr(Cr())),li(function(A){var ne=this;return c(m,function(xe){return bi(xe,ne,A)})})})}function Kp(c,m){m=m===n?" ":Ma(m);var A=m.length;if(A<2)return A?mh(m,c):m;var ne=mh(m,To(c/Uo(m)));return ra(m)?iu(Vo(ne),0,c).join(""):ne.slice(0,c)}function s3(c,m,A,ne){var xe=m&D,Re=_d(c);function it(){for(var mt=-1,Et=arguments.length,ln=-1,un=ne.length,vn=At(un+Et),Un=this&&this!==no&&this instanceof it?Re:c;++ln<un;)vn[ln]=ne[ln];for(;Et--;)vn[ln++]=arguments[++mt];return bi(Un,xe?A:this,vn)}return it}function Iy(c){return function(m,A,ne){return ne&&typeof ne!="number"&&Za(m,A,ne)&&(A=ne=n),m=kc(m),A===n?(A=m,m=0):A=kc(A),ne=ne===n?m<A?1:-1:kc(ne),Of(m,A,ne,c)}}function Yp(c){return function(m,A){return typeof m=="string"&&typeof A=="string"||(m=su(m),A=su(A)),c(m,A)}}function Oy(c,m,A,ne,xe,Re,it,mt,Et,ln){var un=m&Z,vn=un?it:n,Un=un?n:it,sr=un?Re:n,Mr=un?n:Re;m|=un?ue:le,m&=~(un?le:ue),m&j||(m&=-4);var fi=[c,m,xe,sr,vn,Mr,Un,mt,Et,ln],Ar=A.apply(n,fi);return y0(c)&&Wy(Ar,fi),Ar.placeholder=ne,Zy(Ar,c,m)}function f0(c){var m=Vi[c];return function(A,ne){if(A=su(A),ne=ne==null?0:Ce(ui(ne),292),ne&&p(A)){var xe=(Zi(A)+"e").split("e"),Re=m(xe[0]+"e"+(+xe[1]+ne));return xe=(Zi(Re)+"e").split("e"),+(xe[0]+"e"+(+xe[1]-ne))}return m(A)}}var a3=mo&&1/ns(new mo([,-0]))[1]==J?function(c){return new mo(c)}:D0;function By(c){return function(m){var A=Aa(m);return A==de?hl(m):A==Xe?Ju(m):ho(m,c(m))}}function Ec(c,m,A,ne,xe,Re,it,mt){var Et=m&I;if(!Et&&typeof c!="function")throw new Gi(o);var ln=ne?ne.length:0;if(ln||(m&=-97,ne=xe=n),it=it===n?it:ie(ui(it),0),mt=mt===n?mt:ui(mt),ln-=xe?xe.length:0,m&le){var un=ne,vn=xe;ne=xe=n}var Un=Et?n:p0(c),sr=[c,m,A,ne,xe,un,vn,Re,it,mt];if(Un&&x3(sr,Un),c=sr[0],m=sr[1],A=sr[2],ne=sr[3],xe=sr[4],mt=sr[9]=sr[9]===n?Et?0:c.length:ie(sr[9]-ln,0),!mt&&m&(Z|te)&&(m&=-25),!m||m==D)var Mr=i3(c,m,A);else m==Z||m==te?Mr=o3(c,m,mt):(m==ue||m==(D|ue))&&!xe.length?Mr=s3(c,m,A,ne):Mr=Wp.apply(n,sr);var fi=Un?Cu:Wy;return Zy(fi(Mr,sr),c,m)}function Ry(c,m,A,ne){return c===n||Au(c,sa[A])&&!Qr.call(ne,A)?m:c}function Fy(c,m,A,ne,xe,Re){return Ko(c)&&Ko(m)&&(Re.set(m,c),fa(c,m,n,Fy,Re),Re.delete(m)),c}function l3(c){return xd(c)?n:c}function jy(c,m,A,ne,xe,Re){var it=A&M,mt=c.length,Et=m.length;if(mt!=Et&&!(it&&Et>mt))return!1;var ln=Re.get(c),un=Re.get(m);if(ln&&un)return ln==m&&un==c;var vn=-1,Un=!0,sr=A&T?new q:n;for(Re.set(c,m),Re.set(m,c);++vn<mt;){var Mr=c[vn],fi=m[vn];if(ne)var Ar=it?ne(fi,Mr,vn,m,c,Re):ne(Mr,fi,vn,c,m,Re);if(Ar!==n){if(Ar)continue;Un=!1;break}if(sr){if(!O(m,function(Ci,Ti){if(!fl(sr,Ti)&&(Mr===Ci||xe(Mr,Ci,A,ne,Re)))return sr.push(Ti)})){Un=!1;break}}else if(!(Mr===fi||xe(Mr,fi,A,ne,Re))){Un=!1;break}}return Re.delete(c),Re.delete(m),Un}function u3(c,m,A,ne,xe,Re,it){switch(A){case pn:if(c.byteLength!=m.byteLength||c.byteOffset!=m.byteOffset)return!1;c=c.buffer,m=m.buffer;case sn:return!(c.byteLength!=m.byteLength||!Re(new Bs(c),new Bs(m)));case k:case ae:case ye:return Au(+c,+m);case Pe:return c.name==m.name&&c.message==m.message;case He:case tt:return c==m+"";case de:var mt=hl;case Xe:var Et=ne&M;if(mt||(mt=ns),c.size!=m.size&&!Et)return!1;var ln=it.get(c);if(ln)return ln==m;ne|=T,it.set(c,m);var un=jy(mt(c),mt(m),ne,xe,Re,it);return it.delete(c),un;case Mt:if(mi)return mi.call(c)==mi.call(m)}return!1}function c3(c,m,A,ne,xe,Re){var it=A&M,mt=h0(c),Et=mt.length,ln=h0(m),un=ln.length;if(Et!=un&&!it)return!1;for(var vn=Et;vn--;){var Un=mt[vn];if(!(it?Un in m:Qr.call(m,Un)))return!1}var sr=Re.get(c),Mr=Re.get(m);if(sr&&Mr)return sr==m&&Mr==c;var fi=!0;Re.set(c,m),Re.set(m,c);for(var Ar=it;++vn<Et;){Un=mt[vn];var Ci=c[Un],Ti=m[Un];if(ne)var Fl=it?ne(Ti,Ci,Un,m,c,Re):ne(Ci,Ti,Un,c,m,Re);if(!(Fl===n?Ci===Ti||xe(Ci,Ti,A,ne,Re):Fl)){fi=!1;break}Ar||(Ar=Un=="constructor")}if(fi&&!Ar){var Ka=c.constructor,jl=m.constructor;Ka!=jl&&"constructor"in c&&"constructor"in m&&!(typeof Ka=="function"&&Ka instanceof Ka&&typeof jl=="function"&&jl instanceof jl)&&(fi=!1)}return Re.delete(c),Re.delete(m),fi}function Pc(c){return b0(Hy(c,n,e2),c+"")}function h0(c){return Ye(c,Js,m0)}function d0(c){return Ye(c,ml,zy)}var p0=Hi?function(c){return Hi.get(c)}:D0;function Jp(c){for(var m=c.name+"",A=gs[m],ne=Qr.call(gs,m)?A.length:0;ne--;){var xe=A[ne],Re=xe.func;if(Re==null||Re==c)return xe.name}return m}function xh(c){var m=Qr.call(Ne,"placeholder")?Ne:c;return m.placeholder}function Cr(){var c=Ne.iteratee||T0;return c=c===T0?er:c,arguments.length?c(arguments[0],arguments[1]):c}function Xp(c,m){var A=c.__data__;return y3(m)?A[typeof m=="string"?"string":"hash"]:A.map}function g0(c){for(var m=Js(c),A=m.length;A--;){var ne=m[A],xe=c[ne];m[A]=[ne,xe,Vy(xe)]}return m}function Rf(c,m){var A=po(c,m);return Ct(A)?A:n}function f3(c){var m=Qr.call(c,Ca),A=c[Ca];try{c[Ca]=n;var ne=!0}catch{}var xe=Si.call(c);return ne&&(m?c[Ca]=A:delete c[Ca]),xe}var m0=Ks?function(c){return c==null?[]:(c=Li(c),qs(Ks(c),function(m){return Oi.call(c,m)}))}:I0,zy=Ks?function(c){for(var m=[];c;)Es(m,m0(c)),c=ua(c);return m}:I0,Aa=nt;(Dn&&Aa(new Dn(new ArrayBuffer(1)))!=pn||Xn&&Aa(new Xn)!=de||zr&&Aa(zr.resolve())!=Qe||mo&&Aa(new mo)!=Xe||Ji&&Aa(new Ji)!=jt)&&(Aa=function(c){var m=nt(c),A=m==Ue?c.constructor:n,ne=A?Ff(A):"";if(ne)switch(ne){case wc:return pn;case ca:return de;case Ys:return Qe;case Rs:return Xe;case kf:return jt}return m});function h3(c,m,A){for(var ne=-1,xe=A.length;++ne<xe;){var Re=A[ne],it=Re.size;switch(Re.type){case"drop":c+=it;break;case"dropRight":m-=it;break;case"take":m=Ce(m,c+it);break;case"takeRight":c=ie(c,m-it);break}}return{start:c,end:m}}function d3(c){var m=c.match(Cn);return m?m[1].split(xr):[]}function $y(c,m,A){m=Mu(m,c);for(var ne=-1,xe=m.length,Re=!1;++ne<xe;){var it=nc(m[ne]);if(!(Re=c!=null&&A(c,it)))break;c=c[it]}return Re||++ne!=xe?Re:(xe=c==null?0:c.length,!!xe&&og(xe)&&Mc(it,xe)&&(ti(c)||jf(c)))}function p3(c){var m=c.length,A=new c.constructor(m);return m&&typeof c[0]=="string"&&Qr.call(c,"index")&&(A.index=c.index,A.input=c.input),A}function Uy(c){return typeof c.constructor=="function"&&!bd(c)?ms(ua(c)):{}}function g3(c,m,A){var ne=c.constructor;switch(m){case sn:return u0(c);case k:case ae:return new ne(+c);case pn:return Xx(c,A);case et:case ot:case rt:case Ht:case Qt:case On:case wn:case Tn:case ar:return Sy(c,A);case de:return new ne;case ye:case tt:return new ne(c);case He:return Qx(c);case Xe:return new ne;case Mt:return e3(c)}}function m3(c,m){var A=m.length;if(!A)return c;var ne=A-1;return m[ne]=(A>1?"& ":"")+m[ne],m=m.join(A>2?", ":" "),c.replace(lt,`{
/* [wrapped with `+m+`] */
`)}function v3(c){return ti(c)||jf(c)||!!(ps&&c&&c[ps])}function Mc(c,m){var A=typeof c;return m=m??Y,!!m&&(A=="number"||A!="symbol"&&ji.test(c))&&c>-1&&c%1==0&&c<m}function Za(c,m,A){if(!Ko(A))return!1;var ne=typeof m;return(ne=="number"?gl(A)&&Mc(m,A.length):ne=="string"&&m in A)?Au(A[m],c):!1}function v0(c,m){if(ti(c))return!1;var A=typeof c;return A=="number"||A=="symbol"||A=="boolean"||c==null||Rl(c)?!0:qt.test(c)||!Zn.test(c)||m!=null&&c in Li(m)}function y3(c){var m=typeof c;return m=="string"||m=="number"||m=="symbol"||m=="boolean"?c!=="__proto__":c===null}function y0(c){var m=Jp(c),A=Ne[m];if(typeof A!="function"||!(m in Gr.prototype))return!1;if(c===A)return!0;var ne=p0(A);return!!ne&&c===ne[0]}function _3(c){return!!ko&&ko in c}var b3=aa?Ac:O0;function bd(c){var m=c&&c.constructor,A=typeof m=="function"&&m.prototype||sa;return c===A}function Vy(c){return c===c&&!Ko(c)}function Gy(c,m){return function(A){return A==null?!1:A[c]===m&&(m!==n||c in Li(A))}}function w3(c){var m=rg(c,function(ne){return A.size===d&&A.clear(),ne}),A=m.cache;return m}function x3(c,m){var A=c[1],ne=m[1],xe=A|ne,Re=xe<(D|I|ge),it=ne==ge&&A==Z||ne==ge&&A==H&&c[7].length<=m[8]||ne==(ge|H)&&m[7].length<=m[8]&&A==Z;if(!(Re||it))return c;ne&D&&(c[2]=m[2],xe|=A&D?0:j);var mt=m[3];if(mt){var Et=c[3];c[3]=Et?Ey(Et,mt,m[4]):mt,c[4]=Et?ts(c[3],g):m[4]}return mt=m[5],mt&&(Et=c[5],c[5]=Et?Py(Et,mt,m[6]):mt,c[6]=Et?ts(c[5],g):m[6]),mt=m[7],mt&&(c[7]=mt),ne&ge&&(c[8]=c[8]==null?m[8]:Ce(c[8],m[8])),c[9]==null&&(c[9]=m[9]),c[0]=m[0],c[1]=xe,c}function L3(c){var m=[];if(c!=null)for(var A in Li(c))m.push(A);return m}function S3(c){return Si.call(c)}function Hy(c,m,A){return m=ie(m===n?c.length-1:m,0),function(){for(var ne=arguments,xe=-1,Re=ie(ne.length-m,0),it=At(Re);++xe<Re;)it[xe]=ne[m+xe];xe=-1;for(var mt=At(m+1);++xe<m;)mt[xe]=ne[xe];return mt[m]=A(it),bi(c,this,mt)}}function qy(c,m){return m.length<2?c:ur(c,dl(m,0,-1))}function C3(c,m){for(var A=c.length,ne=Ce(m.length,A),xe=pl(c);ne--;){var Re=m[ne];c[ne]=Mc(Re,A)?xe[Re]:n}return c}function _0(c,m){if(!(m==="constructor"&&typeof c[m]=="function")&&m!="__proto__")return c[m]}var Wy=Ky(Cu),wd=bc||function(c,m){return no.setTimeout(c,m)},b0=Ky(Up);function Zy(c,m,A){var ne=m+"";return b0(c,m3(ne,E3(d3(ne),A)))}function Ky(c){var m=0,A=0;return function(){var ne=st(),xe=R-(ne-A);if(A=ne,xe>0){if(++m>=B)return arguments[0]}else m=0;return c.apply(n,arguments)}}function Qp(c,m){var A=-1,ne=c.length,xe=ne-1;for(m=m===n?ne:m;++A<m;){var Re=If(A,xe),it=c[Re];c[Re]=c[A],c[A]=it}return c.length=m,c}var Yy=w3(function(c){var m=[];return c.charCodeAt(0)===46&&m.push(""),c.replace(mn,function(A,ne,xe,Re){m.push(xe?Re.replace(Pr,"$1"):ne||A)}),m});function nc(c){if(typeof c=="string"||Rl(c))return c;var m=c+"";return m=="0"&&1/c==-1/0?"-0":m}function Ff(c){if(c!=null){try{return la.call(c)}catch{}try{return c+""}catch{}}return""}function E3(c,m){return Mo(fe,function(A){var ne="_."+A[0];m&A[1]&&!ul(c,ne)&&c.push(ne)}),c.sort()}function Jy(c){if(c instanceof Gr)return c.clone();var m=new Io(c.__wrapped__,c.__chain__);return m.__actions__=pl(c.__actions__),m.__index__=c.__index__,m.__values__=c.__values__,m}function P3(c,m,A){(A?Za(c,m,A):m===n)?m=1:m=ie(ui(m),0);var ne=c==null?0:c.length;if(!ne||m<1)return[];for(var xe=0,Re=0,it=At(To(ne/m));xe<ne;)it[Re++]=dl(c,xe,xe+=m);return it}function M3(c){for(var m=-1,A=c==null?0:c.length,ne=0,xe=[];++m<A;){var Re=c[m];Re&&(xe[ne++]=Re)}return xe}function A3(){var c=arguments.length;if(!c)return[];for(var m=At(c-1),A=arguments[0],ne=c;ne--;)m[ne-1]=arguments[ne];return Es(ti(A)?pl(A):[A],ze(m,1))}var k3=li(function(c,m){return ys(c)?C(c,ze(m,1,ys,!0)):[]}),T3=li(function(c,m){var A=ou(m);return ys(A)&&(A=n),ys(c)?C(c,ze(m,1,ys,!0),Cr(A,2)):[]}),N3=li(function(c,m){var A=ou(m);return ys(A)&&(A=n),ys(c)?C(c,ze(m,1,ys,!0),n,A):[]});function D3(c,m,A){var ne=c==null?0:c.length;return ne?(m=A||m===n?1:ui(m),dl(c,m<0?0:m,ne)):[]}function I3(c,m,A){var ne=c==null?0:c.length;return ne?(m=A||m===n?1:ui(m),m=ne-m,dl(c,0,m<0?0:m)):[]}function O3(c,m){return c&&c.length?Cc(c,Cr(m,3),!0,!0):[]}function B3(c,m){return c&&c.length?Cc(c,Cr(m,3),!0):[]}function R3(c,m,A,ne){var xe=c==null?0:c.length;return xe?(A&&typeof A!="number"&&Za(c,m,A)&&(A=0,ne=xe),Se(c,m,A,ne)):[]}function Xy(c,m,A){var ne=c==null?0:c.length;if(!ne)return-1;var xe=A==null?0:ui(A);return xe<0&&(xe=ie(ne+xe,0)),$t(c,Cr(m,3),xe)}function Qy(c,m,A){var ne=c==null?0:c.length;if(!ne)return-1;var xe=ne-1;return A!==n&&(xe=ui(A),xe=A<0?ie(ne+xe,0):Ce(xe,ne-1)),$t(c,Cr(m,3),xe,!0)}function e2(c){var m=c==null?0:c.length;return m?ze(c,1):[]}function F3(c){var m=c==null?0:c.length;return m?ze(c,J):[]}function j3(c,m){var A=c==null?0:c.length;return A?(m=m===n?1:ui(m),ze(c,m)):[]}function z3(c){for(var m=-1,A=c==null?0:c.length,ne={};++m<A;){var xe=c[m];ne[xe[0]]=xe[1]}return ne}function t2(c){return c&&c.length?c[0]:n}function $3(c,m,A){var ne=c==null?0:c.length;if(!ne)return-1;var xe=A==null?0:ui(A);return xe<0&&(xe=ie(ne+xe,0)),cn(c,m,xe)}function U3(c){var m=c==null?0:c.length;return m?dl(c,0,-1):[]}var V3=li(function(c){var m=wi(c,Xc);return m.length&&m[0]===c[0]?ve(m):[]}),G3=li(function(c){var m=ou(c),A=wi(c,Xc);return m===ou(A)?m=n:A.pop(),A.length&&A[0]===c[0]?ve(A,Cr(m,2)):[]}),H3=li(function(c){var m=ou(c),A=wi(c,Xc);return m=typeof m=="function"?m:n,m&&A.pop(),A.length&&A[0]===c[0]?ve(A,n,m):[]});function q3(c,m){return c==null?"":S.call(c,m)}function ou(c){var m=c==null?0:c.length;return m?c[m-1]:n}function W3(c,m,A){var ne=c==null?0:c.length;if(!ne)return-1;var xe=ne;return A!==n&&(xe=ui(A),xe=xe<0?ie(ne+xe,0):Ce(xe,ne-1)),m===m?wa(c,m,xe):$t(c,zn,xe,!0)}function Z3(c,m){return c&&c.length?Wa(c,ui(m)):n}var K3=li(n2);function n2(c,m){return c&&c.length&&m&&m.length?gh(c,m):c}function Y3(c,m,A){return c&&c.length&&m&&m.length?gh(c,m,Cr(A,2)):c}function J3(c,m,A){return c&&c.length&&m&&m.length?gh(c,m,n,A):c}var X3=Pc(function(c,m){var A=c==null?0:c.length,ne=Sn(c,m);return Df(c,wi(m,function(xe){return Mc(xe,A)?+xe:xe}).sort(Cy)),ne});function Q3(c,m){var A=[];if(!(c&&c.length))return A;var ne=-1,xe=[],Re=c.length;for(m=Cr(m,3);++ne<Re;){var it=c[ne];m(it,ne,c)&&(A.push(it),xe.push(ne))}return Df(c,xe),A}function w0(c){return c==null?c:an.call(c)}function eL(c,m,A){var ne=c==null?0:c.length;return ne?(A&&typeof A!="number"&&Za(c,m,A)?(m=0,A=ne):(m=m==null?0:ui(m),A=A===n?ne:ui(A)),dl(c,m,A)):[]}function tL(c,m){return Eu(c,m)}function nL(c,m,A){return vd(c,m,Cr(A,2))}function rL(c,m){var A=c==null?0:c.length;if(A){var ne=Eu(c,m);if(ne<A&&Au(c[ne],m))return ne}return-1}function iL(c,m){return Eu(c,m,!0)}function oL(c,m,A){return vd(c,m,Cr(A,2),!0)}function sL(c,m){var A=c==null?0:c.length;if(A){var ne=Eu(c,m,!0)-1;if(Au(c[ne],m))return ne}return-1}function aL(c){return c&&c.length?yd(c):[]}function lL(c,m){return c&&c.length?yd(c,Cr(m,2)):[]}function uL(c){var m=c==null?0:c.length;return m?dl(c,1,m):[]}function cL(c,m,A){return c&&c.length?(m=A||m===n?1:ui(m),dl(c,0,m<0?0:m)):[]}function fL(c,m,A){var ne=c==null?0:c.length;return ne?(m=A||m===n?1:ui(m),m=ne-m,dl(c,m<0?0:m,ne)):[]}function hL(c,m){return c&&c.length?Cc(c,Cr(m,3),!1,!0):[]}function dL(c,m){return c&&c.length?Cc(c,Cr(m,3)):[]}var pL=li(function(c){return ec(ze(c,1,ys,!0))}),gL=li(function(c){var m=ou(c);return ys(m)&&(m=n),ec(ze(c,1,ys,!0),Cr(m,2))}),mL=li(function(c){var m=ou(c);return m=typeof m=="function"?m:n,ec(ze(c,1,ys,!0),n,m)});function vL(c){return c&&c.length?ec(c):[]}function yL(c,m){return c&&c.length?ec(c,Cr(m,2)):[]}function _L(c,m){return m=typeof m=="function"?m:n,c&&c.length?ec(c,n,m):[]}function x0(c){if(!(c&&c.length))return[];var m=0;return c=qs(c,function(A){if(ys(A))return m=ie(A.length,m),!0}),oo(m,function(A){return wi(c,vr(A))})}function r2(c,m){if(!(c&&c.length))return[];var A=x0(c);return m==null?A:wi(A,function(ne){return bi(m,n,ne)})}var bL=li(function(c,m){return ys(c)?C(c,m):[]}),wL=li(function(c){return ru(qs(c,ys))}),xL=li(function(c){var m=ou(c);return ys(m)&&(m=n),ru(qs(c,ys),Cr(m,2))}),LL=li(function(c){var m=ou(c);return m=typeof m=="function"?m:n,ru(qs(c,ys),n,m)}),SL=li(x0);function CL(c,m){return Pu(c||[],m||[],pt)}function EL(c,m){return Pu(c||[],m||[],Lc)}var PL=li(function(c){var m=c.length,A=m>1?c[m-1]:n;return A=typeof A=="function"?(c.pop(),A):n,r2(c,A)});function i2(c){var m=Ne(c);return m.__chain__=!0,m}function ML(c,m){return m(c),c}function eg(c,m){return m(c)}var AL=Pc(function(c){var m=c.length,A=m?c[0]:0,ne=this.__wrapped__,xe=function(Re){return Sn(Re,c)};return m>1||this.__actions__.length||!(ne instanceof Gr)||!Mc(A)?this.thru(xe):(ne=ne.slice(A,+A+(m?1:0)),ne.__actions__.push({func:eg,args:[xe],thisArg:n}),new Io(ne,this.__chain__).thru(function(Re){return m&&!Re.length&&Re.push(n),Re}))});function kL(){return i2(this)}function TL(){return new Io(this.value(),this.__chain__)}function NL(){this.__values__===n&&(this.__values__=y2(this.value()));var c=this.__index__>=this.__values__.length,m=c?n:this.__values__[this.__index__++];return{done:c,value:m}}function DL(){return this}function IL(c){for(var m,A=this;A instanceof Lu;){var ne=Jy(A);ne.__index__=0,ne.__values__=n,m?xe.__wrapped__=ne:m=ne;var xe=ne;A=A.__wrapped__}return xe.__wrapped__=c,m}function OL(){var c=this.__wrapped__;if(c instanceof Gr){var m=c;return this.__actions__.length&&(m=new Gr(this)),m=m.reverse(),m.__actions__.push({func:eg,args:[w0],thisArg:n}),new Io(m,this.__chain__)}return this.thru(w0)}function BL(){return nu(this.__wrapped__,this.__actions__)}var RL=qp(function(c,m,A){Qr.call(c,A)?++c[A]:kn(c,A,1)});function FL(c,m,A){var ne=ti(c)?Il:re;return A&&Za(c,m,A)&&(m=n),ne(c,Cr(m,3))}function jL(c,m){var A=ti(c)?qs:Je;return A(c,Cr(m,3))}var zL=Ty(Xy),$L=Ty(Qy);function UL(c,m){return ze(tg(c,m),1)}function VL(c,m){return ze(tg(c,m),J)}function GL(c,m,A){return A=A===n?1:ui(A),ze(tg(c,m),A)}function o2(c,m){var A=ti(c)?Mo:z;return A(c,Cr(m,3))}function s2(c,m){var A=ti(c)?Hs:X;return A(c,Cr(m,3))}var HL=qp(function(c,m,A){Qr.call(c,A)?c[A].push(m):kn(c,A,[m])});function qL(c,m,A,ne){c=gl(c)?c:Sh(c),A=A&&!ne?ui(A):0;var xe=c.length;return A<0&&(A=ie(xe+A,0)),sg(c)?A<=xe&&c.indexOf(m,A)>-1:!!xe&&cn(c,m,A)>-1}var WL=li(function(c,m,A){var ne=-1,xe=typeof m=="function",Re=gl(c)?At(c.length):[];return z(c,function(it){Re[++ne]=xe?bi(m,it,A):Be(it,m,A)}),Re}),ZL=qp(function(c,m,A){kn(c,A,m)});function tg(c,m){var A=ti(c)?wi:Fi;return A(c,Cr(m,3))}function KL(c,m,A,ne){return c==null?[]:(ti(m)||(m=m==null?[]:[m]),A=ne?n:A,ti(A)||(A=A==null?[]:[A]),Qu(c,m,A))}var YL=qp(function(c,m,A){c[A?0:1].push(m)},function(){return[[],[]]});function JL(c,m,A){var ne=ti(c)?ba:$i,xe=arguments.length<3;return ne(c,Cr(m,4),A,xe,z)}function XL(c,m,A){var ne=ti(c)?io:$i,xe=arguments.length<3;return ne(c,Cr(m,4),A,xe,X)}function QL(c,m){var A=ti(c)?qs:Je;return A(c,ig(Cr(m,3)))}function eS(c){var m=ti(c)?Dt:vh;return m(c)}function tS(c,m,A){(A?Za(c,m,A):m===n)?m=1:m=ui(m);var ne=ti(c)?wt:$p;return ne(c,m)}function nS(c){var m=ti(c)?Yt:Vp;return m(c)}function rS(c){if(c==null)return 0;if(gl(c))return sg(c)?Uo(c):c.length;var m=Aa(c);return m==de||m==Xe?c.size:vi(c).length}function iS(c,m,A){var ne=ti(c)?O:Gp;return A&&Za(c,m,A)&&(m=n),ne(c,Cr(m,3))}var oS=li(function(c,m){if(c==null)return[];var A=m.length;return A>1&&Za(c,m[0],m[1])?m=[]:A>2&&Za(m[0],m[1],m[2])&&(m=[m[0]]),Qu(c,ze(m,1),[])}),ng=is||function(){return no.Date.now()};function sS(c,m){if(typeof m!="function")throw new Gi(o);return c=ui(c),function(){if(--c<1)return m.apply(this,arguments)}}function a2(c,m,A){return m=A?n:m,m=c&&m==null?c.length:m,Ec(c,ge,n,n,n,n,m)}function l2(c,m){var A;if(typeof m!="function")throw new Gi(o);return c=ui(c),function(){return--c>0&&(A=m.apply(this,arguments)),c<=1&&(m=n),A}}var L0=li(function(c,m,A){var ne=D;if(A.length){var xe=ts(A,xh(L0));ne|=ue}return Ec(c,ne,m,A,xe)}),u2=li(function(c,m,A){var ne=D|I;if(A.length){var xe=ts(A,xh(u2));ne|=ue}return Ec(m,ne,c,A,xe)});function c2(c,m,A){m=A?n:m;var ne=Ec(c,Z,n,n,n,n,n,m);return ne.placeholder=c2.placeholder,ne}function f2(c,m,A){m=A?n:m;var ne=Ec(c,te,n,n,n,n,n,m);return ne.placeholder=f2.placeholder,ne}function h2(c,m,A){var ne,xe,Re,it,mt,Et,ln=0,un=!1,vn=!1,Un=!0;if(typeof c!="function")throw new Gi(o);m=su(m)||0,Ko(A)&&(un=!!A.leading,vn="maxWait"in A,Re=vn?ie(su(A.maxWait)||0,m):Re,Un="trailing"in A?!!A.trailing:Un);function sr(_s){var ku=ne,Tc=xe;return ne=xe=n,ln=_s,it=c.apply(Tc,ku),it}function Mr(_s){return ln=_s,mt=wd(Ci,m),un?sr(_s):it}function fi(_s){var ku=_s-Et,Tc=_s-ln,T2=m-ku;return vn?Ce(T2,Re-Tc):T2}function Ar(_s){var ku=_s-Et,Tc=_s-ln;return Et===n||ku>=m||ku<0||vn&&Tc>=Re}function Ci(){var _s=ng();if(Ar(_s))return Ti(_s);mt=wd(Ci,fi(_s))}function Ti(_s){return mt=n,Un&&ne?sr(_s):(ne=xe=n,it)}function Fl(){mt!==n&&_h(mt),ln=0,ne=Et=xe=mt=n}function Ka(){return mt===n?it:Ti(ng())}function jl(){var _s=ng(),ku=Ar(_s);if(ne=arguments,xe=this,Et=_s,ku){if(mt===n)return Mr(Et);if(vn)return _h(mt),mt=wd(Ci,m),sr(Et)}return mt===n&&(mt=wd(Ci,m)),it}return jl.cancel=Fl,jl.flush=Ka,jl}var aS=li(function(c,m){return w(c,1,m)}),lS=li(function(c,m,A){return w(c,su(m)||0,A)});function uS(c){return Ec(c,U)}function rg(c,m){if(typeof c!="function"||m!=null&&typeof m!="function")throw new Gi(o);var A=function(){var ne=arguments,xe=m?m.apply(this,ne):ne[0],Re=A.cache;if(Re.has(xe))return Re.get(xe);var it=c.apply(this,ne);return A.cache=Re.set(xe,it)||Re,it};return A.cache=new(rg.Cache||Pa),A}rg.Cache=Pa;function ig(c){if(typeof c!="function")throw new Gi(o);return function(){var m=arguments;switch(m.length){case 0:return!c.call(this);case 1:return!c.call(this,m[0]);case 2:return!c.call(this,m[0],m[1]);case 3:return!c.call(this,m[0],m[1],m[2])}return!c.apply(this,m)}}function cS(c){return l2(2,c)}var fS=l0(function(c,m){m=m.length==1&&ti(m[0])?wi(m[0],Vr(Cr())):wi(ze(m,1),Vr(Cr()));var A=m.length;return li(function(ne){for(var xe=-1,Re=Ce(ne.length,A);++xe<Re;)ne[xe]=m[xe].call(this,ne[xe]);return bi(c,this,ne)})}),S0=li(function(c,m){var A=ts(m,xh(S0));return Ec(c,ue,n,m,A)}),d2=li(function(c,m){var A=ts(m,xh(d2));return Ec(c,le,n,m,A)}),hS=Pc(function(c,m){return Ec(c,H,n,n,n,m)});function dS(c,m){if(typeof c!="function")throw new Gi(o);return m=m===n?m:ui(m),li(c,m)}function pS(c,m){if(typeof c!="function")throw new Gi(o);return m=m==null?0:ie(ui(m),0),li(function(A){var ne=A[m],xe=iu(A,0,m);return ne&&Es(xe,ne),bi(c,this,xe)})}function gS(c,m,A){var ne=!0,xe=!0;if(typeof c!="function")throw new Gi(o);return Ko(A)&&(ne="leading"in A?!!A.leading:ne,xe="trailing"in A?!!A.trailing:xe),h2(c,m,{leading:ne,maxWait:m,trailing:xe})}function mS(c){return a2(c,1)}function vS(c,m){return S0(Bf(m),c)}function yS(){if(!arguments.length)return[];var c=arguments[0];return ti(c)?c:[c]}function _S(c){return l(c,_)}function bS(c,m){return m=typeof m=="function"?m:n,l(c,_,m)}function wS(c){return l(c,y|_)}function xS(c,m){return m=typeof m=="function"?m:n,l(c,y|_,m)}function LS(c,m){return m==null||v(c,m,Js(m))}function Au(c,m){return c===m||c!==c&&m!==m}var SS=Yp(ht),CS=Yp(function(c,m){return c>=m}),jf=Oe(function(){return arguments}())?Oe:function(c){return os(c)&&Qr.call(c,"callee")&&!Oi.call(c,"callee")},ti=At.isArray,ES=Ql?Vr(Ql):Fe;function gl(c){return c!=null&&og(c.length)&&!Ac(c)}function ys(c){return os(c)&&gl(c)}function PS(c){return c===!0||c===!1||os(c)&&nt(c)==k}var Qc=a||O0,MS=ta?Vr(ta):je;function AS(c){return os(c)&&c.nodeType===1&&!xd(c)}function kS(c){if(c==null)return!0;if(gl(c)&&(ti(c)||typeof c=="string"||typeof c.splice=="function"||Qc(c)||Lh(c)||jf(c)))return!c.length;var m=Aa(c);if(m==de||m==Xe)return!c.size;if(bd(c))return!vi(c).length;for(var A in c)if(Qr.call(c,A))return!1;return!0}function TS(c,m){return ut(c,m)}function NS(c,m,A){A=typeof A=="function"?A:n;var ne=A?A(c,m):n;return ne===n?ut(c,m,n,A):!!ne}function C0(c){if(!os(c))return!1;var m=nt(c);return m==Pe||m==ke||typeof c.message=="string"&&typeof c.name=="string"&&!xd(c)}function DS(c){return typeof c=="number"&&p(c)}function Ac(c){if(!Ko(c))return!1;var m=nt(c);return m==Ge||m==K||m==se||m==Ze}function p2(c){return typeof c=="number"&&c==ui(c)}function og(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=Y}function Ko(c){var m=typeof c;return c!=null&&(m=="object"||m=="function")}function os(c){return c!=null&&typeof c=="object"}var g2=Tl?Vr(Tl):gt;function IS(c,m){return c===m||St(c,m,g0(m))}function OS(c,m,A){return A=typeof A=="function"?A:n,St(c,m,g0(m),A)}function BS(c){return m2(c)&&c!=+c}function RS(c){if(b3(c))throw new Kn(s);return Ct(c)}function FS(c){return c===null}function jS(c){return c==null}function m2(c){return typeof c=="number"||os(c)&&nt(c)==ye}function xd(c){if(!os(c)||nt(c)!=Ue)return!1;var m=ua(c);if(m===null)return!0;var A=Qr.call(m,"constructor")&&m.constructor;return typeof A=="function"&&A instanceof A&&la.call(A)==Ai}var E0=Nl?Vr(Nl):on;function zS(c){return p2(c)&&c>=-9007199254740991&&c<=Y}var v2=Os?Vr(Os):$n;function sg(c){return typeof c=="string"||!ti(c)&&os(c)&&nt(c)==tt}function Rl(c){return typeof c=="symbol"||os(c)&&nt(c)==Mt}var Lh=Dl?Vr(Dl):Hn;function $S(c){return c===n}function US(c){return os(c)&&Aa(c)==jt}function VS(c){return os(c)&&nt(c)==zt}var GS=Yp(ei),HS=Yp(function(c,m){return c<=m});function y2(c){if(!c)return[];if(gl(c))return sg(c)?Vo(c):pl(c);if(pr&&c[pr])return hs(c[pr]());var m=Aa(c),A=m==de?hl:m==Xe?ns:Sh;return A(c)}function kc(c){if(!c)return c===0?c:0;if(c=su(c),c===J||c===-1/0){var m=c<0?-1:1;return m*pe}return c===c?c:0}function ui(c){var m=kc(c),A=m%1;return m===m?A?m-A:m:0}function _2(c){return c?Qn(ui(c),0,De):0}function su(c){if(typeof c=="number")return c;if(Rl(c))return Le;if(Ko(c)){var m=typeof c.valueOf=="function"?c.valueOf():c;c=Ko(m)?m+"":m}if(typeof c!="string")return c===0?c:+c;c=Ps(c);var A=Or.test(c);return A||rn.test(c)?kl(c.slice(2),A?2:8):ir.test(c)?Le:+c}function b2(c){return tc(c,ml(c))}function qS(c){return c?Qn(ui(c),-9007199254740991,Y):c===0?c:0}function Zi(c){return c==null?"":Ma(c)}var WS=bh(function(c,m){if(bd(m)||gl(m)){tc(m,Js(m),c);return}for(var A in m)Qr.call(m,A)&&pt(c,A,m[A])}),w2=bh(function(c,m){tc(m,ml(m),c)}),ag=bh(function(c,m,A,ne){tc(m,ml(m),c,ne)}),ZS=bh(function(c,m,A,ne){tc(m,Js(m),c,ne)}),KS=Pc(Sn);function YS(c,m){var A=ms(c);return m==null?A:fn(A,m)}var JS=li(function(c,m){c=Li(c);var A=-1,ne=m.length,xe=ne>2?m[2]:n;for(xe&&Za(m[0],m[1],xe)&&(ne=1);++A<ne;)for(var Re=m[A],it=ml(Re),mt=-1,Et=it.length;++mt<Et;){var ln=it[mt],un=c[ln];(un===n||Au(un,sa[ln])&&!Qr.call(c,ln))&&(c[ln]=Re[ln])}return c}),XS=li(function(c){return c.push(n,Fy),bi(x2,n,c)});function QS(c,m){return xt(c,Cr(m,3),Xt)}function eC(c,m){return xt(c,Cr(m,3),yn)}function tC(c,m){return c==null?c:vt(c,Cr(m,3),ml)}function nC(c,m){return c==null?c:kt(c,Cr(m,3),ml)}function rC(c,m){return c&&Xt(c,Cr(m,3))}function iC(c,m){return c&&yn(c,Cr(m,3))}function oC(c){return c==null?[]:bn(c,Js(c))}function sC(c){return c==null?[]:bn(c,ml(c))}function P0(c,m,A){var ne=c==null?n:ur(c,m);return ne===n?A:ne}function aC(c,m){return c!=null&&$y(c,m,Ot)}function M0(c,m){return c!=null&&$y(c,m,bt)}var lC=Dy(function(c,m,A){m!=null&&typeof m.toString!="function"&&(m=Si.call(m)),c[m]=A},k0(vl)),uC=Dy(function(c,m,A){m!=null&&typeof m.toString!="function"&&(m=Si.call(m)),Qr.call(c,m)?c[m].push(A):c[m]=[A]},Cr),cC=li(Be);function Js(c){return gl(c)?Nt(c):vi(c)}function ml(c){return gl(c)?Nt(c,!0):ki(c)}function fC(c,m){var A={};return m=Cr(m,3),Xt(c,function(ne,xe,Re){kn(A,m(ne,xe,Re),ne)}),A}function hC(c,m){var A={};return m=Cr(m,3),Xt(c,function(ne,xe,Re){kn(A,xe,m(ne,xe,Re))}),A}var dC=bh(function(c,m,A){fa(c,m,A)}),x2=bh(function(c,m,A,ne){fa(c,m,A,ne)}),pC=Pc(function(c,m){var A={};if(c==null)return A;var ne=!1;m=wi(m,function(Re){return Re=Mu(Re,c),ne||(ne=Re.length>1),Re}),tc(c,d0(c),A),ne&&(A=l(A,y|x|_,l3));for(var xe=m.length;xe--;)Sc(A,m[xe]);return A});function gC(c,m){return L2(c,ig(Cr(m)))}var mC=Pc(function(c,m){return c==null?{}:ha(c,m)});function L2(c,m){if(c==null)return{};var A=wi(d0(c),function(ne){return[ne]});return m=Cr(m),Zo(c,A,function(ne,xe){return m(ne,xe[0])})}function vC(c,m,A){m=Mu(m,c);var ne=-1,xe=m.length;for(xe||(xe=1,c=n);++ne<xe;){var Re=c==null?n:c[nc(m[ne])];Re===n&&(ne=xe,Re=A),c=Ac(Re)?Re.call(c):Re}return c}function yC(c,m,A){return c==null?c:Lc(c,m,A)}function _C(c,m,A,ne){return ne=typeof ne=="function"?ne:n,c==null?c:Lc(c,m,A,ne)}var S2=By(Js),C2=By(ml);function bC(c,m,A){var ne=ti(c),xe=ne||Qc(c)||Lh(c);if(m=Cr(m,4),A==null){var Re=c&&c.constructor;xe?A=ne?new Re:[]:Ko(c)?A=Ac(Re)?ms(ua(c)):{}:A={}}return(xe?Mo:Xt)(c,function(it,mt,Et){return m(A,it,mt,Et)}),A}function wC(c,m){return c==null?!0:Sc(c,m)}function xC(c,m,A){return c==null?c:yh(c,m,Bf(A))}function LC(c,m,A,ne){return ne=typeof ne=="function"?ne:n,c==null?c:yh(c,m,Bf(A),ne)}function Sh(c){return c==null?[]:zo(c,Js(c))}function SC(c){return c==null?[]:zo(c,ml(c))}function CC(c,m,A){return A===n&&(A=m,m=n),A!==n&&(A=su(A),A=A===A?A:0),m!==n&&(m=su(m),m=m===m?m:0),Qn(su(c),m,A)}function EC(c,m,A){return m=kc(m),A===n?(A=m,m=0):A=kc(A),c=su(c),Tt(c,m,A)}function PC(c,m,A){if(A&&typeof A!="boolean"&&Za(c,m,A)&&(m=A=n),A===n&&(typeof m=="boolean"?(A=m,m=n):typeof c=="boolean"&&(A=c,c=n)),c===n&&m===n?(c=0,m=1):(c=kc(c),m===n?(m=c,c=0):m=kc(m)),c>m){var ne=c;c=m,m=ne}if(A||c%1||m%1){var xe=Ut();return Ce(c+xe*(m-c+al("1e-"+((xe+"").length-1))),m)}return If(c,m)}var MC=wh(function(c,m,A){return m=m.toLowerCase(),c+(A?E2(m):m)});function E2(c){return A0(Zi(c).toLowerCase())}function P2(c){return c=Zi(c),c&&c.replace(_i,wu).replace(jo,"")}function AC(c,m,A){c=Zi(c),m=Ma(m);var ne=c.length;A=A===n?ne:Qn(ui(A),0,ne);var xe=A;return A-=m.length,A>=0&&c.slice(A,xe)==m}function kC(c){return c=Zi(c),c&&We.test(c)?c.replace(yr,Ga):c}function TC(c){return c=Zi(c),c&&Kt.test(c)?c.replace(Bt,"\\$&"):c}var NC=wh(function(c,m,A){return c+(A?"-":"")+m.toLowerCase()}),DC=wh(function(c,m,A){return c+(A?" ":"")+m.toLowerCase()}),IC=ky("toLowerCase");function OC(c,m,A){c=Zi(c),m=ui(m);var ne=m?Uo(c):0;if(!m||ne>=m)return c;var xe=(m-ne)/2;return Kp(No(xe),A)+c+Kp(To(xe),A)}function BC(c,m,A){c=Zi(c),m=ui(m);var ne=m?Uo(c):0;return m&&ne<m?c+Kp(m-ne,A):c}function RC(c,m,A){c=Zi(c),m=ui(m);var ne=m?Uo(c):0;return m&&ne<m?Kp(m-ne,A)+c:c}function FC(c,m,A){return A||m==null?m=0:m&&(m=+m),Pt(Zi(c).replace(Ln,""),m||0)}function jC(c,m,A){return(A?Za(c,m,A):m===n)?m=1:m=ui(m),mh(Zi(c),m)}function zC(){var c=arguments,m=Zi(c[0]);return c.length<3?m:m.replace(c[1],c[2])}var $C=wh(function(c,m,A){return c+(A?"_":"")+m.toLowerCase()});function UC(c,m,A){return A&&typeof A!="number"&&Za(c,m,A)&&(m=A=n),A=A===n?De:A>>>0,A?(c=Zi(c),c&&(typeof m=="string"||m!=null&&!E0(m))&&(m=Ma(m),!m&&ra(c))?iu(Vo(c),0,A):c.split(m,A)):[]}var VC=wh(function(c,m,A){return c+(A?" ":"")+A0(m)});function GC(c,m,A){return c=Zi(c),A=A==null?0:Qn(ui(A),0,c.length),m=Ma(m),c.slice(A,A+m.length)==m}function HC(c,m,A){var ne=Ne.templateSettings;A&&Za(c,m,A)&&(m=n),c=Zi(c),m=ag({},m,ne,Ry);var xe=ag({},m.imports,ne.imports,Ry),Re=Js(xe),it=zo(xe,Re),mt,Et,ln=0,un=m.interpolate||gi,vn="__p += '",Un=Ol((m.escape||gi).source+"|"+un.source+"|"+(un===Jn?lr:gi).source+"|"+(m.evaluate||gi).source+"|$","g"),sr="//# sourceURL="+(Qr.call(m,"sourceURL")?(m.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ml+"]")+`
`;c.replace(Un,function(Ar,Ci,Ti,Fl,Ka,jl){return Ti||(Ti=Fl),vn+=c.slice(ln,jl).replace(Kr,Ha),Ci&&(mt=!0,vn+=`' +
__e(`+Ci+`) +
'`),Ka&&(Et=!0,vn+=`';
`+Ka+`;
__p += '`),Ti&&(vn+=`' +
((__t = (`+Ti+`)) == null ? '' : __t) +
'`),ln=jl+Ar.length,Ar}),vn+=`';
`;var Mr=Qr.call(m,"variable")&&m.variable;if(!Mr)vn=`with (obj) {
`+vn+`
}
`;else if(Fr.test(Mr))throw new Kn(u);vn=(Et?vn.replace(xn,""):vn).replace(Mn,"$1").replace(Pn,"$1;"),vn="function("+(Mr||"obj")+`) {
`+(Mr?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(mt?", __e = _.escape":"")+(Et?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+vn+`return __p
}`;var fi=A2(function(){return wr(Re,sr+"return "+vn).apply(n,it)});if(fi.source=vn,C0(fi))throw fi;return fi}function qC(c){return Zi(c).toLowerCase()}function WC(c){return Zi(c).toUpperCase()}function ZC(c,m,A){if(c=Zi(c),c&&(A||m===n))return Ps(c);if(!c||!(m=Ma(m)))return c;var ne=Vo(c),xe=Vo(m),Re=es(ne,xe),it=eu(ne,xe)+1;return iu(ne,Re,it).join("")}function KC(c,m,A){if(c=Zi(c),c&&(A||m===n))return c.slice(0,xa(c)+1);if(!c||!(m=Ma(m)))return c;var ne=Vo(c),xe=eu(ne,Vo(m))+1;return iu(ne,0,xe).join("")}function YC(c,m,A){if(c=Zi(c),c&&(A||m===n))return c.replace(Ln,"");if(!c||!(m=Ma(m)))return c;var ne=Vo(c),xe=es(ne,Vo(m));return iu(ne,xe).join("")}function JC(c,m){var A=Q,ne=F;if(Ko(m)){var xe="separator"in m?m.separator:xe;A="length"in m?ui(m.length):A,ne="omission"in m?Ma(m.omission):ne}c=Zi(c);var Re=c.length;if(ra(c)){var it=Vo(c);Re=it.length}if(A>=Re)return c;var mt=A-Uo(ne);if(mt<1)return ne;var Et=it?iu(it,0,mt).join(""):c.slice(0,mt);if(xe===n)return Et+ne;if(it&&(mt+=Et.length-mt),E0(xe)){if(c.slice(mt).search(xe)){var ln,un=Et;for(xe.global||(xe=Ol(xe.source,Zi(Hr.exec(xe))+"g")),xe.lastIndex=0;ln=xe.exec(un);)var vn=ln.index;Et=Et.slice(0,vn===n?mt:vn)}}else if(c.indexOf(Ma(xe),mt)!=mt){var Un=Et.lastIndexOf(xe);Un>-1&&(Et=Et.slice(0,Un))}return Et+ne}function XC(c){return c=Zi(c),c&&at.test(c)?c.replace(fr,La):c}var QC=wh(function(c,m,A){return c+(A?" ":"")+m.toUpperCase()}),A0=ky("toUpperCase");function M2(c,m,A){return c=Zi(c),m=A?n:m,m===n?Ms(c)?ia(c):ft(c):c.match(m)||[]}var A2=li(function(c,m){try{return bi(c,n,m)}catch(A){return C0(A)?A:new Kn(A)}}),eE=Pc(function(c,m){return Mo(m,function(A){A=nc(A),kn(c,A,L0(c[A],c))}),c});function tE(c){var m=c==null?0:c.length,A=Cr();return c=m?wi(c,function(ne){if(typeof ne[1]!="function")throw new Gi(o);return[A(ne[0]),ne[1]]}):[],li(function(ne){for(var xe=-1;++xe<m;){var Re=c[xe];if(bi(Re[0],this,ne))return bi(Re[1],this,ne)}})}function nE(c){return h(l(c,y))}function k0(c){return function(){return c}}function rE(c,m){return c==null||c!==c?m:c}var iE=Ny(),oE=Ny(!0);function vl(c){return c}function T0(c){return er(typeof c=="function"?c:l(c,y))}function sE(c){return vs(l(c,y))}function aE(c,m){return Su(c,l(m,y))}var lE=li(function(c,m){return function(A){return Be(A,c,m)}}),uE=li(function(c,m){return function(A){return Be(c,A,m)}});function N0(c,m,A){var ne=Js(m),xe=bn(m,ne);A==null&&!(Ko(m)&&(xe.length||!ne.length))&&(A=m,m=c,c=this,xe=bn(m,Js(m)));var Re=!(Ko(A)&&"chain"in A)||!!A.chain,it=Ac(c);return Mo(xe,function(mt){var Et=m[mt];c[mt]=Et,it&&(c.prototype[mt]=function(){var ln=this.__chain__;if(Re||ln){var un=c(this.__wrapped__),vn=un.__actions__=pl(this.__actions__);return vn.push({func:Et,args:arguments,thisArg:c}),un.__chain__=ln,un}return Et.apply(c,Es([this.value()],arguments))})}),c}function cE(){return no._===this&&(no._=so),this}function D0(){}function fE(c){return c=ui(c),li(function(m){return Wa(m,c)})}var hE=c0(wi),dE=c0(Il),pE=c0(O);function k2(c){return v0(c)?vr(nc(c)):ao(c)}function gE(c){return function(m){return c==null?n:ur(c,m)}}var mE=Iy(),vE=Iy(!0);function I0(){return[]}function O0(){return!1}function yE(){return{}}function _E(){return""}function bE(){return!0}function wE(c,m){if(c=ui(c),c<1||c>Y)return[];var A=De,ne=Ce(c,De);m=Cr(m),c-=De;for(var xe=oo(ne,m);++A<c;)m(A);return xe}function xE(c){return ti(c)?wi(c,nc):Rl(c)?[c]:pl(Yy(Zi(c)))}function LE(c){var m=++Ws;return Zi(c)+m}var SE=Zp(function(c,m){return c+m},0),CE=f0("ceil"),EE=Zp(function(c,m){return c/m},1),PE=f0("floor");function ME(c){return c&&c.length?he(c,vl,ht):n}function AE(c,m){return c&&c.length?he(c,Cr(m,2),ht):n}function kE(c){return nr(c,vl)}function TE(c,m){return nr(c,Cr(m,2))}function NE(c){return c&&c.length?he(c,vl,ei):n}function DE(c,m){return c&&c.length?he(c,Cr(m,2),ei):n}var IE=Zp(function(c,m){return c*m},1),OE=f0("round"),BE=Zp(function(c,m){return c-m},0);function RE(c){return c&&c.length?xi(c,vl):0}function FE(c,m){return c&&c.length?xi(c,Cr(m,2)):0}return Ne.after=sS,Ne.ary=a2,Ne.assign=WS,Ne.assignIn=w2,Ne.assignInWith=ag,Ne.assignWith=ZS,Ne.at=KS,Ne.before=l2,Ne.bind=L0,Ne.bindAll=eE,Ne.bindKey=u2,Ne.castArray=yS,Ne.chain=i2,Ne.chunk=P3,Ne.compact=M3,Ne.concat=A3,Ne.cond=tE,Ne.conforms=nE,Ne.constant=k0,Ne.countBy=RL,Ne.create=YS,Ne.curry=c2,Ne.curryRight=f2,Ne.debounce=h2,Ne.defaults=JS,Ne.defaultsDeep=XS,Ne.defer=aS,Ne.delay=lS,Ne.difference=k3,Ne.differenceBy=T3,Ne.differenceWith=N3,Ne.drop=D3,Ne.dropRight=I3,Ne.dropRightWhile=O3,Ne.dropWhile=B3,Ne.fill=R3,Ne.filter=jL,Ne.flatMap=UL,Ne.flatMapDeep=VL,Ne.flatMapDepth=GL,Ne.flatten=e2,Ne.flattenDeep=F3,Ne.flattenDepth=j3,Ne.flip=uS,Ne.flow=iE,Ne.flowRight=oE,Ne.fromPairs=z3,Ne.functions=oC,Ne.functionsIn=sC,Ne.groupBy=HL,Ne.initial=U3,Ne.intersection=V3,Ne.intersectionBy=G3,Ne.intersectionWith=H3,Ne.invert=lC,Ne.invertBy=uC,Ne.invokeMap=WL,Ne.iteratee=T0,Ne.keyBy=ZL,Ne.keys=Js,Ne.keysIn=ml,Ne.map=tg,Ne.mapKeys=fC,Ne.mapValues=hC,Ne.matches=sE,Ne.matchesProperty=aE,Ne.memoize=rg,Ne.merge=dC,Ne.mergeWith=x2,Ne.method=lE,Ne.methodOf=uE,Ne.mixin=N0,Ne.negate=ig,Ne.nthArg=fE,Ne.omit=pC,Ne.omitBy=gC,Ne.once=cS,Ne.orderBy=KL,Ne.over=hE,Ne.overArgs=fS,Ne.overEvery=dE,Ne.overSome=pE,Ne.partial=S0,Ne.partialRight=d2,Ne.partition=YL,Ne.pick=mC,Ne.pickBy=L2,Ne.property=k2,Ne.propertyOf=gE,Ne.pull=K3,Ne.pullAll=n2,Ne.pullAllBy=Y3,Ne.pullAllWith=J3,Ne.pullAt=X3,Ne.range=mE,Ne.rangeRight=vE,Ne.rearg=hS,Ne.reject=QL,Ne.remove=Q3,Ne.rest=dS,Ne.reverse=w0,Ne.sampleSize=tS,Ne.set=yC,Ne.setWith=_C,Ne.shuffle=nS,Ne.slice=eL,Ne.sortBy=oS,Ne.sortedUniq=aL,Ne.sortedUniqBy=lL,Ne.split=UC,Ne.spread=pS,Ne.tail=uL,Ne.take=cL,Ne.takeRight=fL,Ne.takeRightWhile=hL,Ne.takeWhile=dL,Ne.tap=ML,Ne.throttle=gS,Ne.thru=eg,Ne.toArray=y2,Ne.toPairs=S2,Ne.toPairsIn=C2,Ne.toPath=xE,Ne.toPlainObject=b2,Ne.transform=bC,Ne.unary=mS,Ne.union=pL,Ne.unionBy=gL,Ne.unionWith=mL,Ne.uniq=vL,Ne.uniqBy=yL,Ne.uniqWith=_L,Ne.unset=wC,Ne.unzip=x0,Ne.unzipWith=r2,Ne.update=xC,Ne.updateWith=LC,Ne.values=Sh,Ne.valuesIn=SC,Ne.without=bL,Ne.words=M2,Ne.wrap=vS,Ne.xor=wL,Ne.xorBy=xL,Ne.xorWith=LL,Ne.zip=SL,Ne.zipObject=CL,Ne.zipObjectDeep=EL,Ne.zipWith=PL,Ne.entries=S2,Ne.entriesIn=C2,Ne.extend=w2,Ne.extendWith=ag,N0(Ne,Ne),Ne.add=SE,Ne.attempt=A2,Ne.camelCase=MC,Ne.capitalize=E2,Ne.ceil=CE,Ne.clamp=CC,Ne.clone=_S,Ne.cloneDeep=wS,Ne.cloneDeepWith=xS,Ne.cloneWith=bS,Ne.conformsTo=LS,Ne.deburr=P2,Ne.defaultTo=rE,Ne.divide=EE,Ne.endsWith=AC,Ne.eq=Au,Ne.escape=kC,Ne.escapeRegExp=TC,Ne.every=FL,Ne.find=zL,Ne.findIndex=Xy,Ne.findKey=QS,Ne.findLast=$L,Ne.findLastIndex=Qy,Ne.findLastKey=eC,Ne.floor=PE,Ne.forEach=o2,Ne.forEachRight=s2,Ne.forIn=tC,Ne.forInRight=nC,Ne.forOwn=rC,Ne.forOwnRight=iC,Ne.get=P0,Ne.gt=SS,Ne.gte=CS,Ne.has=aC,Ne.hasIn=M0,Ne.head=t2,Ne.identity=vl,Ne.includes=qL,Ne.indexOf=$3,Ne.inRange=EC,Ne.invoke=cC,Ne.isArguments=jf,Ne.isArray=ti,Ne.isArrayBuffer=ES,Ne.isArrayLike=gl,Ne.isArrayLikeObject=ys,Ne.isBoolean=PS,Ne.isBuffer=Qc,Ne.isDate=MS,Ne.isElement=AS,Ne.isEmpty=kS,Ne.isEqual=TS,Ne.isEqualWith=NS,Ne.isError=C0,Ne.isFinite=DS,Ne.isFunction=Ac,Ne.isInteger=p2,Ne.isLength=og,Ne.isMap=g2,Ne.isMatch=IS,Ne.isMatchWith=OS,Ne.isNaN=BS,Ne.isNative=RS,Ne.isNil=jS,Ne.isNull=FS,Ne.isNumber=m2,Ne.isObject=Ko,Ne.isObjectLike=os,Ne.isPlainObject=xd,Ne.isRegExp=E0,Ne.isSafeInteger=zS,Ne.isSet=v2,Ne.isString=sg,Ne.isSymbol=Rl,Ne.isTypedArray=Lh,Ne.isUndefined=$S,Ne.isWeakMap=US,Ne.isWeakSet=VS,Ne.join=q3,Ne.kebabCase=NC,Ne.last=ou,Ne.lastIndexOf=W3,Ne.lowerCase=DC,Ne.lowerFirst=IC,Ne.lt=GS,Ne.lte=HS,Ne.max=ME,Ne.maxBy=AE,Ne.mean=kE,Ne.meanBy=TE,Ne.min=NE,Ne.minBy=DE,Ne.stubArray=I0,Ne.stubFalse=O0,Ne.stubObject=yE,Ne.stubString=_E,Ne.stubTrue=bE,Ne.multiply=IE,Ne.nth=Z3,Ne.noConflict=cE,Ne.noop=D0,Ne.now=ng,Ne.pad=OC,Ne.padEnd=BC,Ne.padStart=RC,Ne.parseInt=FC,Ne.random=PC,Ne.reduce=JL,Ne.reduceRight=XL,Ne.repeat=jC,Ne.replace=zC,Ne.result=vC,Ne.round=OE,Ne.runInContext=_t,Ne.sample=eS,Ne.size=rS,Ne.snakeCase=$C,Ne.some=iS,Ne.sortedIndex=tL,Ne.sortedIndexBy=nL,Ne.sortedIndexOf=rL,Ne.sortedLastIndex=iL,Ne.sortedLastIndexBy=oL,Ne.sortedLastIndexOf=sL,Ne.startCase=VC,Ne.startsWith=GC,Ne.subtract=BE,Ne.sum=RE,Ne.sumBy=FE,Ne.template=HC,Ne.times=wE,Ne.toFinite=kc,Ne.toInteger=ui,Ne.toLength=_2,Ne.toLower=qC,Ne.toNumber=su,Ne.toSafeInteger=qS,Ne.toString=Zi,Ne.toUpper=WC,Ne.trim=ZC,Ne.trimEnd=KC,Ne.trimStart=YC,Ne.truncate=JC,Ne.unescape=XC,Ne.uniqueId=LE,Ne.upperCase=QC,Ne.upperFirst=A0,Ne.each=o2,Ne.eachRight=s2,Ne.first=t2,N0(Ne,function(){var c={};return Xt(Ne,function(m,A){Qr.call(Ne.prototype,A)||(c[A]=m)}),c}(),{chain:!1}),Ne.VERSION=r,Mo(["bind","bindKey","curry","curryRight","partial","partialRight"],function(c){Ne[c].placeholder=Ne}),Mo(["drop","take"],function(c,m){Gr.prototype[c]=function(A){A=A===n?1:ie(ui(A),0);var ne=this.__filtered__&&!m?new Gr(this):this.clone();return ne.__filtered__?ne.__takeCount__=Ce(A,ne.__takeCount__):ne.__views__.push({size:Ce(A,De),type:c+(ne.__dir__<0?"Right":"")}),ne},Gr.prototype[c+"Right"]=function(A){return this.reverse()[c](A).reverse()}}),Mo(["filter","map","takeWhile"],function(c,m){var A=m+1,ne=A==$||A==G;Gr.prototype[c]=function(xe){var Re=this.clone();return Re.__iteratees__.push({iteratee:Cr(xe,3),type:A}),Re.__filtered__=Re.__filtered__||ne,Re}}),Mo(["head","last"],function(c,m){var A="take"+(m?"Right":"");Gr.prototype[c]=function(){return this[A](1).value()[0]}}),Mo(["initial","tail"],function(c,m){var A="drop"+(m?"":"Right");Gr.prototype[c]=function(){return this.__filtered__?new Gr(this):this[A](1)}}),Gr.prototype.compact=function(){return this.filter(vl)},Gr.prototype.find=function(c){return this.filter(c).head()},Gr.prototype.findLast=function(c){return this.reverse().find(c)},Gr.prototype.invokeMap=li(function(c,m){return typeof c=="function"?new Gr(this):this.map(function(A){return Be(A,c,m)})}),Gr.prototype.reject=function(c){return this.filter(ig(Cr(c)))},Gr.prototype.slice=function(c,m){c=ui(c);var A=this;return A.__filtered__&&(c>0||m<0)?new Gr(A):(c<0?A=A.takeRight(-c):c&&(A=A.drop(c)),m!==n&&(m=ui(m),A=m<0?A.dropRight(-m):A.take(m-c)),A)},Gr.prototype.takeRightWhile=function(c){return this.reverse().takeWhile(c).reverse()},Gr.prototype.toArray=function(){return this.take(De)},Xt(Gr.prototype,function(c,m){var A=/^(?:filter|find|map|reject)|While$/.test(m),ne=/^(?:head|last)$/.test(m),xe=Ne[ne?"take"+(m=="last"?"Right":""):m],Re=ne||/^find/.test(m);xe&&(Ne.prototype[m]=function(){var it=this.__wrapped__,mt=ne?[1]:arguments,Et=it instanceof Gr,ln=mt[0],un=Et||ti(it),vn=function(Ci){var Ti=xe.apply(Ne,Es([Ci],mt));return ne&&Un?Ti[0]:Ti};un&&A&&typeof ln=="function"&&ln.length!=1&&(Et=un=!1);var Un=this.__chain__,sr=!!this.__actions__.length,Mr=Re&&!Un,fi=Et&&!sr;if(!Re&&un){it=fi?it:new Gr(this);var Ar=c.apply(it,mt);return Ar.__actions__.push({func:eg,args:[vn],thisArg:n}),new Io(Ar,Un)}return Mr&&fi?c.apply(this,mt):(Ar=this.thru(vn),Mr?ne?Ar.value()[0]:Ar.value():Ar)})}),Mo(["pop","push","shift","sort","splice","unshift"],function(c){var m=oa[c],A=/^(?:push|sort|unshift)$/.test(c)?"tap":"thru",ne=/^(?:pop|shift)$/.test(c);Ne.prototype[c]=function(){var xe=arguments;if(ne&&!this.__chain__){var Re=this.value();return m.apply(ti(Re)?Re:[],xe)}return this[A](function(it){return m.apply(ti(it)?it:[],xe)})}}),Xt(Gr.prototype,function(c,m){var A=Ne[m];if(A){var ne=A.name+"";Qr.call(gs,ne)||(gs[ne]=[]),gs[ne].push({name:m,func:A})}}),gs[Wp(n,I).name]=[{name:"wrapper",func:n}],Gr.prototype.clone=Wc,Gr.prototype.reverse=uh,Gr.prototype.value=Zc,Ne.prototype.at=AL,Ne.prototype.chain=kL,Ne.prototype.commit=TL,Ne.prototype.next=NL,Ne.prototype.plant=IL,Ne.prototype.reverse=OL,Ne.prototype.toJSON=Ne.prototype.valueOf=Ne.prototype.value=BL,Ne.prototype.first=Ne.prototype.head,pr&&(Ne.prototype[pr]=DL),Ne},Ho=As();ro?((ro.exports=Ho)._=Ho,or._=Ho):no._=Ho}).call(ea)})(_m,_m.exports);var hx=_m.exports;class pa extends Vn.Polygon{constructor(n,r={}){super([],{...r,pmIgnore:!1,interactive:!0});Gt(this,"_width");Gt(this,"_height");Gt(this,"_center");Gt(this,"_rotation");Gt(this,"_isMapReady",!1);Gt(this,"properties");Gt(this,"_helperPoints",{corners:[],midPoints:[]});Gt(this,"_throttledUpdateProperties");const i=n instanceof Vn.LatLngBounds?n:Vn.latLngBounds(n);if(this._center=i.getCenter(),this._rotation=0,console.log("[Rectangle][constructor] Initialisation avec options:",{bounds:i,center:this._center,hasExplicitDimensions:!!(r.width&&r.height),width:r.width,height:r.height}),r.width&&r.height)this._width=r.width,this._height=r.height,console.log("[Rectangle][constructor] Utilisation des dimensions explicites:",{width:this._width,height:this._height});else{const s=i.getSouthWest(),o=i.getNorthEast();this._width=hn.measure("Rectangle.constructor.calculateWidth",()=>{const u=rv([s.lng,s.lat],[o.lng,s.lat],{units:"meters"});return Math.max(u,1)}),this._height=hn.measure("Rectangle.constructor.calculateHeight",()=>{const u=rv([s.lng,s.lat],[s.lng,o.lat],{units:"meters"});return Math.max(u,1)}),console.log("[Rectangle][constructor] Dimensions calculées depuis bounds:",{width:this._width,height:this._height})}(this._width<1||this._height<1)&&this._getPixelsPerMeter()>0&&(this._width=Math.max(this._width,1),this._height=Math.max(this._height,1),this._updatePolygonCoordinates()),this.properties=hn.measure("Rectangle.constructor.initProperties",()=>({type:"Rectangle",style:{...r,name:r.name||""},rotation:this._rotation})),this._throttledUpdateProperties=hn.measure("Rectangle.constructor.initThrottle",()=>hx.throttle(()=>{this.updateProperties()},100)),this.on("add",()=>{this._isMapReady=!0,this._updatePolygonCoordinates(),this.updateProperties()}),this.on("remove",()=>{this._isMapReady=!1})}_updatePolygonCoordinates(){hn.measure("Rectangle._updatePolygonCoordinates",()=>{if(!this._isMapReady||!this._map)return;console.log("[Rectangle][_updatePolygonCoordinates] Début mise à jour avec:",{width:this._width,height:this._height,center:this._center,rotation:this._rotation}),this._width=Math.max(this._width,1),this._height=Math.max(this._height,1);const n=this._width/2,r=this._height/2,i=lb([this._center.lng,this._center.lat],r,0,{units:"meters"}).geometry.coordinates,s=lb([this._center.lng,this._center.lat],n,90,{units:"meters"}).geometry.coordinates,o=Math.abs(i[1]-this._center.lat)*2,u=Math.abs(s[0]-this._center.lng)*2,f=[Vn.latLng(this._center.lat+o/2,this._center.lng-u/2),Vn.latLng(this._center.lat+o/2,this._center.lng+u/2),Vn.latLng(this._center.lat-o/2,this._center.lng+u/2),Vn.latLng(this._center.lat-o/2,this._center.lng-u/2)];if(this._rotation===0){this.setLatLngs(f);return}const d=this._map.latLngToContainerPoint(this._center),g=f.map(D=>this._map.latLngToContainerPoint(D)),y=-this._rotation*Math.PI/180,x=Math.cos(y),_=Math.sin(y),T=g.map(D=>{const I=D.x-d.x,j=D.y-d.y;return Vn.point(d.x+(I*x-j*_),d.y+(I*_+j*x))}).map(D=>this._map.containerPointToLatLng(D));console.log("[Rectangle][_updatePolygonCoordinates] Résultat final:",{corners:T,dimensions:{width:this._width,height:this._height}}),this.setLatLngs(T),this.fire("coordinates:updated",{corners:T,center:this._center,rotation:this._rotation,dimensions:{width:this._width,height:this._height}})})}_getPixelsPerMeter(){return hn.measure("Rectangle._getPixelsPerMeter",()=>{if(!this._isMapReady||!this._map)return 1;const n=Math.max(this._width/1e3,1e-4),r=this._map.latLngToContainerPoint(this._center),s=this._map.latLngToContainerPoint(Vn.latLng(this._center.lat,this._center.lng+n)).x-r.x,o=rv([this._center.lng,this._center.lat],[this._center.lng+n,this._center.lat],{units:"meters"}),u=Math.abs(s/o);return isNaN(u)||u<=0?(console.warn("[Rectangle][_getPixelsPerMeter] Ratio invalide, utilisation de la valeur par défaut"),1):u})}getRotatedCorners(){return hn.measure("Rectangle.getRotatedCorners",()=>{try{const n=this.getLatLngs();if(!n||!Array.isArray(n)||n.length===0){const r=this._width/2,i=this._height/2;return[Vn.latLng(this._center.lat+i,this._center.lng-r),Vn.latLng(this._center.lat+i,this._center.lng+r),Vn.latLng(this._center.lat-i,this._center.lng+r),Vn.latLng(this._center.lat-i,this._center.lng-r)]}return n[0]}catch(n){console.warn("Error in getRotatedCorners:",n);const r=this._width/2,i=this._height/2;return[Vn.latLng(this._center.lat+i,this._center.lng-r),Vn.latLng(this._center.lat+i,this._center.lng+r),Vn.latLng(this._center.lat-i,this._center.lng+r),Vn.latLng(this._center.lat-i,this._center.lng-r)]}})}getMidPoints(){return hn.measure("Rectangle.getMidPoints",()=>{try{const n=this.getRotatedCorners();if(!n||n.length<4){const i=this._width/2,s=this._height/2;return[Vn.latLng(this._center.lat+s,this._center.lng),Vn.latLng(this._center.lat,this._center.lng+i),Vn.latLng(this._center.lat-s,this._center.lng),Vn.latLng(this._center.lat,this._center.lng-i)]}if(!n.every(i=>i&&typeof i.lat=="number"&&typeof i.lng=="number"))throw new Error("Invalid corner coordinates");return[this._getMidPoint(n[3],n[0]),this._getMidPoint(n[0],n[1]),this._getMidPoint(n[1],n[2]),this._getMidPoint(n[2],n[3])]}catch(n){console.warn("Error in getMidPoints:",n);const r=this._width/2,i=this._height/2;return[Vn.latLng(this._center.lat+i,this._center.lng),Vn.latLng(this._center.lat,this._center.lng+r),Vn.latLng(this._center.lat-i,this._center.lng),Vn.latLng(this._center.lat,this._center.lng-r)]}})}_getMidPoint(n,r){return hn.measure("Rectangle._getMidPoint",()=>{if(!n||!r||typeof n.lat!="number"||typeof n.lng!="number"||typeof r.lat!="number"||typeof r.lng!="number")throw new Error("Invalid points for midpoint calculation");return Vn.latLng((n.lat+r.lat)/2,(n.lng+r.lng)/2)})}getCenter(){return hn.measure("Rectangle.getCenter",()=>this._center)}setCenter(n){hn.measure("Rectangle.setCenter",()=>{this._center=n,this._updatePolygonCoordinates(),this.updateProperties(),this.updateHelperPointPositions()})}getRotation(){return hn.measure("Rectangle.getRotation",()=>this._rotation)}setRotation(n,r=!1){hn.measure("Rectangle.setRotation",()=>{this._rotation=(n%360+360)%360,this._updatePolygonCoordinates(),r&&this.updateProperties(),this.updateHelperPointPositions(),this.fire("rotation:updated",{angle:this._rotation,corners:this.getRotatedCorners(),center:this._center})})}finalizeRotation(){hn.measure("Rectangle.finalizeRotation",()=>{this.updateProperties()})}getDimensions(){return hn.measure("Rectangle.getDimensions",()=>({width:this._width,height:this._height}))}setDimensions(n,r){hn.measure("Rectangle.setDimensions",()=>{console.log("[Rectangle][setDimensions] Début de la mise à jour des dimensions:",{oldWidth:this._width,oldHeight:this._height,newWidth:n,newHeight:r}),this._width=n,this._height=r,console.log("[Rectangle][setDimensions] Mise à jour des coordonnées du polygone"),this._updatePolygonCoordinates(),console.log("[Rectangle][setDimensions] Mise à jour des propriétés"),this.updateProperties(),console.log("[Rectangle][setDimensions] Émission de l'événement dimensions:updated"),this.fire("dimensions:updated",{width:this._width,height:this._height,corners:this.getRotatedCorners(),center:this._center}),this.updateHelperPointPositions()})}resizeFromCorner(n,r){hn.measure("Rectangle.resizeFromCorner",()=>{if(!(!this._isMapReady||!this._map))try{const i=this._map.latLngToContainerPoint(this._center),s=this._map.latLngToContainerPoint(r),o=s.x-i.x,u=s.y-i.y,f=-this._rotation*Math.PI/180,d=Math.cos(f),g=Math.sin(f),y=o*d-u*g,x=o*g+u*d,_=this._getPixelsPerMeter(),M=n===0||n===3?-1:1,T=n===0||n===1?1:-1,D=Math.max(Math.abs(y*2)/_,1),I=Math.max(Math.abs(x*2)/_,1),j=D*_/2,Z=I*_/2,te=M*j*d-T*Z*g,ue=M*j*g+T*Z*d,le=Vn.point(s.x-te,s.y-ue),ge=this._map.containerPointToLatLng(le),Q=[Vn.point(le.x-j,le.y+Z),Vn.point(le.x+j,le.y+Z),Vn.point(le.x+j,le.y-Z),Vn.point(le.x-j,le.y-Z)].map(F=>{const B=F.x-le.x,R=F.y-le.y;return Vn.point(le.x+(B*d-R*g),le.y+(B*g+R*d))}).map(F=>this._map.containerPointToLatLng(F));this._width=D,this._height=I,this._center=ge,this.setLatLngs(Q),this.fire("coordinates:updated",{corners:Q,center:this._center,rotation:this._rotation})}catch(i){console.warn("Error in resizeFromCorner:",i)}})}resizeFromSide(n,r){hn.measure("Rectangle.resizeFromSide",()=>{if(!this._isMapReady||!this._map)return;const i=this._map.latLngToContainerPoint(this._center),s=this._map.latLngToContainerPoint(r),o=s.x-i.x,u=s.y-i.y,f=-this._rotation*Math.PI/180,d=Math.cos(f),g=Math.sin(f),y=o*d-u*g,x=o*g+u*d,_=this._getPixelsPerMeter();n%2===0?this._height=Math.abs(x*2)/_:this._width=Math.abs(y*2)/_,this._updatePolygonCoordinates(),this.updateProperties()})}moveFromCenter(n){hn.measure("Rectangle.moveFromCenter",()=>{this._center=n,this._updatePolygonCoordinates(),this.updateProperties()})}updateProperties(){hn.measure("Rectangle.updateProperties",()=>{var i,s,o;const n=this.getRotatedCorners(),r=((s=(i=this.properties)==null?void 0:i.style)==null?void 0:s.name)||"";this.properties={...this.properties,width:this._width,height:this._height,surface:this._width*this._height,perimeter:2*(this._width+this._height),center:this._center,corners:n,midPoints:this.getMidPoints(),rotation:this._rotation,style:{...this.options,color:this.options.color||"#2b6451",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#2b6451",fillOpacity:this.options.fillOpacity||.2,dashArray:((o=this.options)==null?void 0:o.dashArray)||"",name:r}},this.fire("properties:updated",{shape:this,properties:this.properties,corners:n,midPoints:this.getMidPoints()})})}setName(n){hn.measure("Rectangle.setName",()=>{this.properties.style||(this.properties.style={}),this.properties.style.name=n,this.fire("properties:updated",{shape:this,properties:this.properties})})}getName(){return hn.measure("Rectangle.getName",()=>{var n,r;return((r=(n=this.properties)==null?void 0:n.style)==null?void 0:r.name)||""})}generateHelperPoints(n,r="rgba(220, 38, 38, 0.5)",i="rgba(37, 99, 235, 0.5)"){hn.measure("Rectangle.generateHelperPoints",()=>{this.clearHelperPoints();const s=this.getRotatedCorners(),o=this.getMidPoints();this._helperPoints.corners=s.map(u=>Vn.circleMarker(u,{radius:5,color:r,fillColor:r,fillOpacity:.6,weight:1,opacity:.8,className:"rectangle-helper-corner",pmIgnore:!0,interactive:!1}).addTo(n)),this._helperPoints.midPoints=o.map(u=>Vn.circleMarker(u,{radius:5,color:i,fillColor:i,fillOpacity:.6,weight:1,opacity:.8,className:"rectangle-helper-midpoint",pmIgnore:!0,interactive:!1}).addTo(n))})}clearHelperPoints(){hn.measure("Rectangle.clearHelperPoints",()=>{this._helperPoints.corners.forEach(n=>{if(n&&n.remove)try{n.remove()}catch(r){console.warn("Erreur lors de la suppression d'un point d'aide de coin:",r)}}),this._helperPoints.midPoints.forEach(n=>{if(n&&n.remove)try{n.remove()}catch(r){console.warn("Erreur lors de la suppression d'un point d'aide de milieu:",r)}}),this._helperPoints.corners=[],this._helperPoints.midPoints=[]})}updateHelperPointPositions(){hn.measure("Rectangle.updateHelperPointPositions",()=>{if(this._helperPoints.corners.length===0&&this._helperPoints.midPoints.length===0)return;const n=this.getRotatedCorners(),r=this.getMidPoints();n.forEach((i,s)=>{this._helperPoints.corners[s]&&this._helperPoints.corners[s].setLatLng(i)}),r.forEach((i,s)=>{this._helperPoints.midPoints[s]&&this._helperPoints.midPoints[s].setLatLng(i)})})}findClosestHelperPoint(n){return hn.measure("Rectangle.findClosestHelperPoint",()=>{const r=this.getRotatedCorners(),i=this.getMidPoints(),s=[...r,...i];if(s.length===0)return null;let o=s[0],u=n.distanceTo(o);for(let f=1;f<s.length;f++){const d=n.distanceTo(s[f]);d<u&&(u=d,o=s[f])}return o})}toggleHelperPoints(n,r,i,s){hn.measure("Rectangle.toggleHelperPoints",()=>{r&&n?this.generateHelperPoints(n,i,s):this.clearHelperPoints()})}containsPoint(n){return hn.measure("Rectangle.containsPoint",()=>{const r=this.getRotatedCorners();if(r.length!==4)return!1;let i=!1;for(let s=0,o=r.length-1;s<r.length;o=s++){const u=r[s].lng,f=r[s].lat,d=r[o].lng,g=r[o].lat;f>n.lat!=g>n.lat&&n.lng<(d-u)*(n.lat-f)/(g-f)+u&&(i=!i)}return i})}}var Yi=(e=>(e.PRIVATE="private",e.COMPANY="company",e.EMPLOYEE="employee",e.VISITOR="visitor",e))(Yi||{});const Rp=Np("notes",()=>{const e=Ft([]),t=Ft([]),n=cr(()=>F=>e.value.find(B=>B.id===F)),r=cr(()=>F=>{const B=e.value.find(R=>R.id===F);return B?B.color:"#6B7280"}),i=cr(()=>F=>t.value.filter(B=>B.columnId===F).sort((B,R)=>B.order-R.order)),s=cr(()=>e.value.find(F=>F.isDefault)||e.value[0]),o=cr(()=>[...e.value].sort((F,B)=>F.order-B.order)),u=cr(()=>F=>{const B=ma();if(!B.user)return!1;if(B.isAdmin)return!0;switch(F.accessLevel){case"private":return!0;case"company":return B.isAdmin||B.isEntreprise;case"employee":return B.isAdmin||B.isEntreprise||B.isSalarie;case"visitor":return B.isAdmin||B.isEntreprise||B.isSalarie||B.isVisiteur;default:return!1}}),f=cr(()=>t.value.filter(F=>u.value(F))),d=cr(()=>F=>f.value.filter(B=>B.columnId===F).sort((B,R)=>B.order-R.order));async function g(){console.log(`
[NotesStore][loadColumns] Initialisation des colonnes fixes...`);try{const F=[{id:"1",title:"Idées",color:"#8B5CF6",order:0,isDefault:!1},{id:"2",title:"À faire",color:"#F59E0B",order:1,isDefault:!0},{id:"3",title:"En cours",color:"#3B82F6",order:2,isDefault:!1},{id:"4",title:"Terminées",color:"#10B981",order:3,isDefault:!1},{id:"5",title:"Autres",color:"#6B7280",order:4,isDefault:!1}];e.value=F,console.log("[NotesStore][loadColumns] Colonnes fixes initialisées:",e.value)}catch(F){throw console.error("[NotesStore][loadColumns] Erreur:",F),F}}async function y(F){console.log(`
[NotesStore][addColumn] Fonction désactivée - Utilisation de colonnes fixes`)}async function x(F,B){console.log(`
[NotesStore][updateColumn] Mise à jour locale de la colonne:`,F,B);try{const R=e.value.findIndex($=>$.id===F);R!==-1&&(e.value[R]={...e.value[R],...B},console.log("[NotesStore][updateColumn] État des colonnes après mise à jour:",e.value))}catch(R){throw console.error("[NotesStore][updateColumn] Erreur:",R),R}}async function _(F){console.log(`
[NotesStore][removeColumn] Fonction désactivée - Utilisation de colonnes fixes`)}async function M(F){console.log(`
[NotesStore][reorderColumns] Réorganisation locale des colonnes`);try{F.forEach((B,R)=>{const $=e.value.find(W=>W.id===B);$&&($.order=R)}),console.log("[NotesStore][reorderColumns] Nouvel ordre des colonnes:",e.value)}catch(B){throw console.error("[NotesStore][reorderColumns] Erreur:",B),B}}function T(F){if(!F)return"private";switch(F.toLowerCase()){case"private":return"private";case"company":return"company";case"employee":return"employee";case"visitor":return"visitor";default:return console.warn(`[NotesStore] Niveau d'accès inconnu: ${F}, utilisation de PRIVATE par défaut`),"private"}}function D(F){if(!F.id)throw console.error("[NotesStore][addNote] Erreur: ID du backend manquant"),new Error("L'ID du backend est requis pour ajouter une note");const B=new Date().toISOString(),R=t.value.filter(G=>G.columnId===F.columnId),$=R.length>0?Math.max(...R.map(G=>G.order))+1:0,W=T(F.access_level);return console.log("[NotesStore][addNote] Ajout d'une note avec ID backend:",F.id,"et niveau d'accès:",W),t.value.push({...F,id:F.id,order:$,accessLevel:W,createdAt:B,updatedAt:B,comments:[],photos:[]}),F.id}function I(F,B){const R=t.value.findIndex($=>$.id===F);if(R!==-1){const $=T(B.access_level),W={...t.value[R],...B,accessLevel:$,updatedAt:new Date().toISOString()};t.value[R]=W,console.log("[NotesStore][updateNote] Note mise à jour avec niveau d'accès:",W.accessLevel)}}function j(F){t.value.findIndex(R=>R.id===F)!==-1?(console.log("[NotesStore][removeNote] Suppression de la note avec ID:",F),t.value=t.value.filter(R=>R.id!==F)):console.warn("[NotesStore][removeNote] Tentative de suppression d'une note inexistante avec ID:",F)}function Z(F,B){const R=t.value.findIndex($=>$.id===F);if(R!==-1){const $=t.value[R];if($.columnId!==B){const G=t.value.filter(pe=>pe.columnId===B),J=G.length>0?Math.max(...G.map(pe=>pe.order))+1:0,Y={...$,columnId:B,order:J,updatedAt:new Date().toISOString()};t.value[R]=Y}else t.value[R]={...t.value[R],updatedAt:new Date().toISOString()}}}function te(F,B){B.forEach((R,$)=>{const W=t.value.findIndex(G=>G.id===R&&G.columnId===F);W!==-1&&(t.value[W]={...t.value[W],order:$,updatedAt:new Date().toISOString()})})}function ue(F){switch(F){case"private":return"Privé";case"company":return"Entreprise";case"employee":return"Salariés";case"visitor":return"Visiteurs";default:return"Inconnu"}}async function le(F,B){try{const R=ma();if(!R.user)throw new Error("Vous devez être connecté pour ajouter un commentaire");if(!R.isEntreprise&&!R.isAdmin)throw new Error("Seules les entreprises peuvent ajouter des commentaires");if(!t.value.some(Le=>Le.id===F))throw new Error(`La note avec l'ID ${F} n'existe pas`);const G=(await pu.addComment(F,B)).data,J=t.value.findIndex(Le=>Le.id===F);if(J===-1)return;const Y=t.value[J];Y.comments||(Y.comments=[]);const pe={id:G.id,text:G.text,createdAt:G.created_at,userId:G.user,userName:G.user_name,userRole:G.user_role};return Y.comments.push(pe),Y.updatedAt=new Date().toISOString(),t.value[J]={...Y},pe.id}catch(R){throw console.error("Erreur lors de l'ajout du commentaire:",R),R}}async function ge(F,B){try{const R=t.value.findIndex(G=>G.id===F);if(R===-1)throw new Error(`La note avec l'ID ${F} n'existe pas`);const $=t.value[R];if(!$.comments||$.comments.length===0)throw new Error("Aucun commentaire trouvé pour cette note");if(!$.comments.some(G=>G.id===B))throw new Error(`Le commentaire avec l'ID ${B} n'existe pas`);await pu.deleteComment(F,B),$.comments=$.comments.filter(G=>G.id!==B),$.updatedAt=new Date().toISOString(),t.value[R]={...$}}catch(R){throw console.error("Erreur lors de la suppression du commentaire:",R),R}}async function H(F,B){try{if(B.id&&B.image){const R=t.value.findIndex(G=>G.id===F);if(R===-1)return;const $=t.value[R];$.photos||($.photos=[]);const W={id:B.id,url:B.image,caption:B.caption,createdAt:B.created_at};return $.photos.push(W),$.updatedAt=new Date().toISOString(),t.value[R]={...$},W.id}else{const R=new FormData;R.append("image",B.url),B.caption&&R.append("caption",B.caption);const W=(await pu.addPhoto(F,R)).data,G=t.value.findIndex(pe=>pe.id===F);if(G===-1)return;const J=t.value[G];J.photos||(J.photos=[]);const Y={id:W.id,url:W.image,caption:W.caption,createdAt:W.created_at};return J.photos.push(Y),J.updatedAt=new Date().toISOString(),t.value[G]={...J},Y.id}}catch(R){throw console.error("Erreur lors de l'ajout de la photo:",R),R}}async function U(F,B){try{await pu.deletePhoto(F,B);const R=t.value.findIndex(W=>W.id===F);if(R===-1||!t.value[R].photos)return;const $=t.value[R];$.photos=$.photos.filter(W=>W.id!==B),$.updatedAt=new Date().toISOString(),t.value[R]={...$}}catch(R){throw console.error("Erreur lors de la suppression de la photo:",R),R}}async function Q(F,B,R){try{await pu.updatePhoto(F,B,{caption:R});const $=t.value.findIndex(J=>J.id===F);if($===-1||!t.value[$].photos)return;const W=t.value[$],G=W.photos.findIndex(J=>J.id===B);if(G===-1)return;W.photos[G].caption=R,W.updatedAt=new Date().toISOString(),t.value[$]={...W}}catch($){throw console.error("Erreur lors de la mise à jour de la légende:",$),$}}return{columns:e,notes:t,getColumnById:n,getColumnColor:r,getNotesByColumn:i,getDefaultColumn:s,getSortedColumns:o,hasAccessToNote:u,getAccessibleNotes:f,getAccessibleNotesByColumn:d,getAccessLevelLabel:ue,loadColumns:g,addColumn:y,updateColumn:x,removeColumn:_,reorderColumns:M,addNote:D,updateNote:I,removeNote:j,moveNote:Z,reorderNotes:te,addComment:le,removeComment:ge,addPhoto:H,removePhoto:U,updatePhoto:Q}});class Fp extends Rt.Marker{constructor(n,r={}){const s=`<div class="geo-note-marker" style="color: ${r.color||"#2b6451"};"></div>`,u={icon:Rt.divIcon({html:s,className:"",iconSize:[24,36],iconAnchor:[12,36],popupAnchor:[0,-36]}),draggable:!1,autoPan:!0};super(n,u);Gt(this,"properties");Gt(this,"_planSaved",!1);this.properties={type:"Note",name:r.name||"Note géolocalisée",description:r.description||"",columnId:r.columnId||"1",accessLevel:r.accessLevel||Yi.PRIVATE,category:r.category||"forages",style:{color:r.color||"#2b6451",weight:r.weight||2,fillColor:r.fillColor||"#2b6451",fillOpacity:r.fillOpacity!==void 0?r.fillOpacity:.8,radius:r.radius||12},comments:[],photos:[],order:0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},console.log("[GeoNote][constructor] Note créée avec columnId:",this.properties.columnId),this.bindPopup(this.createPopupContent()),this.on("dblclick",this.onDoubleClick),window.addEventListener("geonote:updateStyle",f=>{f.detail.noteId===this._leaflet_id&&(this.setNoteStyle(f.detail.style),this.bindPopup(this.createPopupContent()))}),console.log("[GeoNote][constructor] Note créée:",{location:n,name:this.properties.name,type:this.properties.type,style:this.properties.style})}createPopupContent(){const n=document.createElement("div");n.className="geo-note-popup",n.style.display="flex",n.style.flexDirection="column";const r=document.createElement("div");r.className="geo-note-header",n.appendChild(r);const i=document.createElement("div");i.className="geo-note-title",i.textContent=this.properties.name,r.appendChild(i);const s=document.createElement("div");s.className="geo-note-badges",r.appendChild(s);const o=document.createElement("div");o.className="geo-note-badge",o.style.backgroundColor=this.getColumnColor(this.properties.columnId),o.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
        <path d="M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5z" />
        <path d="M11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" />
      </svg>
      ${this.getColumnLabel(this.properties.columnId)}
    `,s.appendChild(o);const u=document.createElement("div");if(u.className="geo-note-badge",u.style.backgroundColor=this.getAccessLevelColor(this.properties.accessLevel),u.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" />
      </svg>
      ${this.getAccessLevelLabel(this.properties.accessLevel)}
    `,s.appendChild(u),this.properties.description&&this.properties.description.trim()!==""){const y=document.createElement("div");y.className="geo-note-content",n.appendChild(y);const x=document.createElement("div");x.className="geo-note-description",x.textContent=this.properties.description,y.appendChild(x)}const f=document.createElement("div");f.className="geo-note-buttons",f.style.display="flex",f.style.width="100%",f.style.marginTop="auto",f.style.borderTop="1px solid #E5E7EB",n.appendChild(f);const d=document.createElement("button");d.className="geo-note-edit-button",d.style.flex="1",d.style.height="36px",d.style.border="none",d.style.borderRight="1px solid #E5E7EB",d.style.background="transparent",d.style.color="#4B5563",d.style.fontSize="11px",d.style.fontWeight="500",d.style.display="flex",d.style.alignItems="center",d.style.justifyContent="center",d.style.cursor="pointer",d.style.padding="0",d.style.margin="0",d.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-3 h-3 mr-1 inline-block align-text-bottom">
        <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z" />
      </svg>
      Éditer
    `,d.onclick=y=>{y.stopPropagation(),this.editNote()},f.appendChild(d);const g=document.createElement("button");return g.className="geo-note-open-button",g.style.flex="1",g.style.height="36px",g.style.border="none",g.style.background="transparent",g.style.color="#3B82F6",g.style.fontSize="11px",g.style.fontWeight="500",g.style.display="flex",g.style.alignItems="center",g.style.justifyContent="center",g.style.cursor="pointer",g.style.padding="0",g.style.margin="0",g.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-3 h-3 mr-1 inline-block align-text-bottom">
        <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd" />
      </svg>
      Ouvrir
    `,g.onclick=y=>{y.stopPropagation(),this.openInGoogleMaps()},f.appendChild(g),n}getColumnColor(n){return{1:"#8B5CF6",2:"#F59E0B",3:"#3B82F6",4:"#10B981",5:"#6B7280"}[n]||"#6B7280"}getColumnLabel(n){return{1:"Idées",2:"À faire",3:"En cours",4:"Terminées",5:"Autres"}[n]||"Colonne "+n}getAccessLevelLabel(n){switch(n){case Yi.PRIVATE:return"Privé";case Yi.COMPANY:return"Entreprise";case Yi.EMPLOYEE:return"Salariés";case Yi.VISITOR:return"Visiteurs";default:return"Inconnu"}}getAccessLevelColor(n){switch(n){case Yi.PRIVATE:return"#9CA3AF";case Yi.COMPANY:return"#EF4444";case Yi.EMPLOYEE:return"#F59E0B";case Yi.VISITOR:return"#10B981";default:return"#6B7280"}}onDoubleClick(n){Rt.DomEvent.stopPropagation(n),this.editNote()}editNote(){this.closePopup();const n=this.properties.id||this._leaflet_id;console.log(`[GeoNote][editNote] Édition de note - ID backend: ${this.properties.id}, ID Leaflet: ${this._leaflet_id}, ID utilisé: ${n}`);const r={id:n,title:this.properties.name,description:this.properties.description,location:{type:"Point",coordinates:[this.getLatLng().lng,this.getLatLng().lat]},columnId:this.properties.columnId||"1",accessLevel:this.properties.accessLevel||"company",style:this.properties.style||{color:"#2b6451",weight:2,opacity:1,fillColor:"#2b6451",fillOpacity:.6,radius:8},order:0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),comments:this.properties.comments||[],photos:this.properties.photos||[]};console.log("[GeoNote][editNote] Édition de note avec columnId:",r.columnId),console.log("[GeoNote] Émission de l'événement note:edit avec",r);const i=new CustomEvent("geonote:edit",{detail:{note:r}});window.dispatchEvent(i),this.fire("note:edit",{note:r})}openInGoogleMaps(){this.closePopup();const n=this.getLatLng().lat,r=this.getLatLng().lng,i=`https://www.google.com/maps/dir/?api=1&destination=${n},${r}`;window.open(i,"_blank")}updateProperties(){var s,o;this.properties.type="Note",this.properties.category||(this.properties.category="forages"),this.properties.accessLevel||(this.properties.accessLevel=Yi.PRIVATE);const n=(s=this.getElement())==null?void 0:s.querySelector(".geo-note-marker"),r=n?window.getComputedStyle(n).color:"#2b6451",i=((o=this.properties.style)==null?void 0:o.radius)||12;this.properties.style={color:r,fillColor:r,weight:2,fillOpacity:.8,radius:i}}setNoteStyle(n){if(n.color||n.fillColor){const i=`<div class="geo-note-marker" style="color: ${n.color||n.fillColor||"#2b6451"};"></div>`,s=Rt.divIcon({html:i,className:"",iconSize:[24,36],iconAnchor:[12,36],popupAnchor:[0,-36]});this.setIcon(s)}this.properties&&this.properties.style&&(this.properties.style={...this.properties.style,color:n.color||this.properties.style.color,weight:n.weight||this.properties.style.weight,fillColor:n.fillColor||this.properties.style.fillColor,fillOpacity:n.fillOpacity!==void 0?n.fillOpacity:this.properties.style.fillOpacity,radius:n.radius||this.properties.style.radius||12}),this.updateProperties()}toBackendFormat(n){this.updateProperties();const r=this.getLatLng(),s={...{...this.properties.style,radius:this.properties.style.radius||12},_accessLevel:this.properties.accessLevel,accessLevel:this.properties.accessLevel},o=this.properties.columnId||"1";return console.log("[GeoNote][toBackendFormat] Sauvegarde de note avec columnId:",o),{id:n,type_forme:"Note",data:{location:{type:"Point",coordinates:[r.lng,r.lat]},name:this.properties.name,description:this.properties.description,columnId:o,accessLevel:this.properties.accessLevel,category:this.properties.category||"forages",style:s,comments:this.properties.comments||[],photos:this.properties.photos||[],order:this.properties.order||0,createdAt:this.properties.createdAt||new Date().toISOString(),updatedAt:new Date().toISOString()}}}updateFromBackendData(n){this.properties.type="Note";const r=n.style?{...n.style,radius:n.style.radius||12}:this.properties.style,i=n.columnId||this.properties.columnId||"1";console.log("[GeoNote][updateFromBackendData] Mise à jour de note avec columnId:",i),this.properties={...this.properties,name:n.name||this.properties.name,description:n.description||this.properties.description,columnId:i,accessLevel:n.accessLevel||this.properties.accessLevel,category:n.category||this.properties.category||"forages",style:r,comments:n.comments||this.properties.comments||[],photos:n.photos||this.properties.photos||[],order:n.order||this.properties.order||0,createdAt:n.createdAt||this.properties.createdAt,updatedAt:n.updatedAt||new Date().toISOString()},this.setNoteStyle(r),this.bindPopup(this.createPopupContent()),console.log("[GeoNote][updateFromBackendData] Note mise à jour:",{name:this.properties.name,type:this.properties.type,style:this.properties.style})}static fromBackendData(n){var u,f,d,g,y,x,_;let r;if(typeof n.location=="object"&&!Array.isArray(n.location)&&n.location.type==="Point"){const M=n.location.coordinates;console.log("[GeoNote][fromBackendData] Coordonnées GeoJSON reçues:",M),r=[M[1],M[0]]}else if(Array.isArray(n.location)&&n.location.length===2)r=n.location;else throw new Error("Les données de la note ne contiennent pas de position valide");console.log("[GeoNote][fromBackendData] Création d'une note à partir des données:",n),console.log("[GeoNote][fromBackendData] Position utilisée:",r);const i=((u=n.style)==null?void 0:u._accessLevel)||((f=n.style)==null?void 0:f.accessLevel)||n.accessLevel||Yi.PRIVATE;console.log("[GeoNote][fromBackendData] Niveau d'accès récupéré:",i,"Style:",n.style),n.accessLevel=i;const s=n.columnId||"1";console.log("[GeoNote][fromBackendData] Création de note avec columnId:",s);const o=new Fp(r,{name:n.name,description:n.description,columnId:s,accessLevel:i,category:n.category||"forages",color:(d=n.style)==null?void 0:d.color,weight:(g=n.style)==null?void 0:g.weight,fillColor:(y=n.style)==null?void 0:y.fillColor,fillOpacity:(x=n.style)==null?void 0:x.fillOpacity,radius:(_=n.style)==null?void 0:_.radius});return o.properties.type="Note",o.properties.comments=n.comments||[],o.properties.photos=n.photos||[],o.properties.order=n.order||0,o.properties.createdAt=n.createdAt||new Date().toISOString(),o.properties.updatedAt=n.updatedAt||new Date().toISOString(),n.style&&o.setNoteStyle(n.style),o.bindPopup(o.createPopupContent()),console.log("[GeoNote][fromBackendData] Note créée:",{location:r,name:o.properties.name,type:o.properties.type,style:o.properties.style}),o}triggerPlanSave(){if(this._planSaved)return;console.log("[GeoNote][triggerPlanSave] Déclenchement de la sauvegarde automatique du plan");const n=new CustomEvent("geonote:savePlan");window.dispatchEvent(n),this._planSaved=!0}resetPlanSaveState(){this._planSaved=!1}}function S7(e){return e&&Array.isArray(e.points)&&e.points.length>0&&Array.isArray(e.points[0])&&e.points[0].length===2}function C7(e){if(!e||typeof e!="object")return console.log("[DrawingStore] ElevationData invalide: pas un objet",{data:e}),!1;const t=Array.isArray(e.points)&&e.points.length>0&&Array.isArray(e.points[0])&&e.points[0].length===2,n=typeof e.style=="object"&&e.style!==null,r=!e.elevationData||Array.isArray(e.elevationData)&&e.elevationData.every(i=>typeof i=="object"&&"distance"in i&&"elevation"in i);return t&&n&&r}function E7(e){return e&&Array.isArray(e.points)&&e.points.length>0&&Array.isArray(e.points[0])&&e.points[0].length===2}function _b(e){var t,n,r,i,s,o,u,f,d,g,y,x,_,M,T,D,I,j,Z,te,ue,le,ge,H,U,Q,F;if(console.log("[DrawingStore] Conversion de la forme en élément",{type:(t=e.properties)==null?void 0:t.type,name:(r=(n=e.properties)==null?void 0:n.style)==null?void 0:r.name,properties:e.properties}),((i=e.properties)==null?void 0:i.type)==="Note"){const B=e.getLatLng();return{type_forme:"Note",data:{points:[[B.lng,B.lat]],style:{color:((s=e.properties.style)==null?void 0:s.color)||"#2b6451",weight:((o=e.properties.style)==null?void 0:o.weight)||3,opacity:((u=e.properties.style)==null?void 0:u.opacity)||1,fillColor:((f=e.properties.style)==null?void 0:f.fillColor)||"#2b6451",fillOpacity:((d=e.properties.style)==null?void 0:d.fillOpacity)||.2,name:((g=e.properties.style)==null?void 0:g.name)||""}}}}if(e instanceof Cf||((y=e.properties)==null?void 0:y.type)==="ElevationLine")return{type_forme:"ElevationLine",data:{points:e.getLatLngs().map($=>[$.lng,$.lat]),style:{color:((x=e.properties.style)==null?void 0:x.color)||"#2b6451",weight:((_=e.properties.style)==null?void 0:_.weight)||4,opacity:((M=e.properties.style)==null?void 0:M.opacity)||.8,name:((T=e.properties.style)==null?void 0:T.name)||""},category:e.properties.category||"forages",accessLevel:e.properties.accessLevel||"visitor",elevationData:e.properties.elevationData,minElevation:e.properties.minElevation,maxElevation:e.properties.maxElevation,elevationGain:e.properties.elevationGain,elevationLoss:e.properties.elevationLoss,averageSlope:e.properties.averageSlope,maxSlope:e.properties.maxSlope}};if(e instanceof gf||((D=e.properties)==null?void 0:D.type)==="Polygon")return{type_forme:"Polygon",data:{points:e.getLatLngs()[0].map($=>[$.lng,$.lat]),style:{color:((I=e.properties.style)==null?void 0:I.color)||"#2b6451",weight:((j=e.properties.style)==null?void 0:j.weight)||3,opacity:((Z=e.properties.style)==null?void 0:Z.opacity)||1,fillColor:((te=e.properties.style)==null?void 0:te.fillColor)||"#2b6451",fillOpacity:((ue=e.properties.style)==null?void 0:ue.fillOpacity)||.2,name:((le=e.properties.style)==null?void 0:le.name)||""},category:e.properties.category||"forages",accessLevel:e.properties.accessLevel||"visitor"}};if(e instanceof Ns||((ge=e.properties)==null?void 0:ge.type)==="Line")return{type_forme:"Line",data:{points:e.getLatLngs().map($=>[$.lng,$.lat]),category:e.properties.category||"forages",accessLevel:e.properties.accessLevel||"visitor",style:{color:((H=e.properties.style)==null?void 0:H.color)||"#2b6451",weight:((U=e.properties.style)==null?void 0:U.weight)||3,opacity:((Q=e.properties.style)==null?void 0:Q.opacity)||1,name:((F=e.properties.style)==null?void 0:F.name)||""}}};throw new Error("Type de forme non reconnu")}function P7(e){var t,n,r,i,s,o,u,f,d,g,y,x,_,M,T,D,I,j,Z,te,ue,le,ge,H,U,Q,F,B,R,$,W,G,J,Y,pe,Le,De,N,ee,fe,ce,_e,se;switch(console.log("[DrawingStore] Conversion de l'élément stocké en forme",{element:e}),e.type_forme){case"Polygon":{const k=e.data;if(!S7(k))return console.error("[DrawingStore] Données invalides pour Polygon"),null;const ae=k.points.map(Ge=>Vn.latLng(Ge[1],Ge[0])),ke=((t=k.style)==null?void 0:t._accessLevel)||((n=k.style)==null?void 0:n.accessLevel)||k.accessLevel||"visitor";console.log("[DrawingStore] Polygon - Niveau d'accès récupéré:",ke,"Style:",k.style),k.accessLevel=ke;const Pe=new gf([ae],{color:((r=k.style)==null?void 0:r.color)||"#2b6451",weight:((i=k.style)==null?void 0:i.weight)||3,opacity:((s=k.style)==null?void 0:s.opacity)||1,fillColor:((o=k.style)==null?void 0:o.fillColor)||"#2b6451",fillOpacity:((u=k.style)==null?void 0:u.fillOpacity)||.2,dashArray:((f=k.style)==null?void 0:f.dashArray)||"",name:((d=k.style)==null?void 0:d.name)||"",category:k.category||"forages",accessLevel:ke});return Pe.updateProperties(),Pe}case"ElevationLine":{const k=e.data;if(!C7(k))return console.error("[DrawingStore] Données invalides pour ElevationLine"),null;const ae=k.points.map(Ge=>Vn.latLng(Ge[1],Ge[0])),ke=((g=k.style)==null?void 0:g._accessLevel)||((y=k.style)==null?void 0:y.accessLevel)||k.accessLevel||"visitor";console.log("[DrawingStore] ElevationLine - Niveau d'accès récupéré:",ke,"Style:",k.style),k.accessLevel=ke;const Pe=new Cf(ae,{color:((x=k.style)==null?void 0:x.color)||"#2b6451",weight:((_=k.style)==null?void 0:_.weight)||4,opacity:((M=k.style)==null?void 0:M.opacity)||.8,name:((T=k.style)==null?void 0:T.name)||"",category:k.category||"forages",accessLevel:ke});return Pe.properties={type:"ElevationLine",category:k.category||"forages",accessLevel:ke,style:{...k.style||{},name:((D=k.style)==null?void 0:D.name)||""},elevationData:k.elevationData,minElevation:k.minElevation,maxElevation:k.maxElevation,elevationGain:k.elevationGain,elevationLoss:k.elevationLoss,averageSlope:k.averageSlope,maxSlope:k.maxSlope,dataSource:"restored"},k.elevationData&&Pe.updateElevationProfile(),console.log("[DrawingStore] ElevationLine restored:",{points:ae.length,hasElevationData:!!k.elevationData,name:(I=k.style)==null?void 0:I.name,properties:Pe.properties}),Pe}case"Line":{const k=e.data;if(!E7(k))return console.error("[DrawingStore] Données invalides pour Ligne"),null;const ae=k.points.map(Ge=>Vn.latLng(Ge[1],Ge[0])),ke=((j=k.style)==null?void 0:j._accessLevel)||((Z=k.style)==null?void 0:Z.accessLevel)||k.accessLevel||"visitor";console.log("[DrawingStore] Line - Niveau d'accès récupéré:",ke,"Style:",k.style),k.accessLevel=ke;const Pe=new Ns(ae,{...k.style||{},name:((te=k.style)==null?void 0:te.name)||"",category:k.category||"forages",accessLevel:ke});return Pe.updateProperties(),Pe}case"Rectangle":{const k=e.data;if(console.log("[DrawingStore][convertStoredElementToShape] Restauration Rectangle:",{data:k,bounds:k.bounds,width:k.width,height:k.height,rotation:k.rotation}),!k.bounds)return console.error("[DrawingStore] Données de bounds manquantes pour Rectangle"),null;const ae=new Vn.LatLngBounds(Vn.latLng(k.bounds.southWest[1],k.bounds.southWest[0]),Vn.latLng(k.bounds.northEast[1],k.bounds.northEast[0])),ke=new pa(ae,{color:((ue=k.style)==null?void 0:ue.color)||"#2b6451",weight:((le=k.style)==null?void 0:le.weight)||3,opacity:((ge=k.style)==null?void 0:ge.opacity)||1,fillColor:((H=k.style)==null?void 0:H.fillColor)||"#2b6451",fillOpacity:((U=k.style)==null?void 0:U.fillOpacity)||.2,dashArray:((Q=k.style)==null?void 0:Q.dashArray)||"",name:((F=k.style)==null?void 0:F.name)||"",width:k.width,height:k.height});return k.rotation&&ke.setRotation(k.rotation),console.log("[DrawingStore][convertStoredElementToShape] Rectangle restauré:",{bounds:ke.getBounds(),dimensions:ke.getDimensions(),properties:ke.properties}),ke}case"Circle":{console.log("[DrawingStore] Traitement d'un Circle à partir de l'API",{id:e.id,data:e.data,hasName:((R=(B=e.data)==null?void 0:B.style)==null?void 0:R.name)!==void 0,name:(W=($=e.data)==null?void 0:$.style)==null?void 0:W.name});const k=e.data;if(!k.center||!k.radius)return console.error("[DrawingStore] Données invalides pour Circle"),null;const ae=Vn.circle([k.center[1],k.center[0]],{color:((G=k.style)==null?void 0:G.color)||"#2b6451",weight:((J=k.style)==null?void 0:J.weight)||3,opacity:((Y=k.style)==null?void 0:Y.opacity)||1,fillColor:((pe=k.style)==null?void 0:pe.fillColor)||"#2b6451",fillOpacity:((Le=k.style)==null?void 0:Le.fillOpacity)||.2,dashArray:((De=k.style)==null?void 0:De.dashArray)||"",radius:k.radius});return ae.properties={type:"Circle",radius:k.radius,diameter:k.radius*2,surface:Math.PI*k.radius*k.radius,perimeter:2*Math.PI*k.radius,style:{...k.style||{},name:((N=k.style)==null?void 0:N.name)||""}},console.log("[DrawingStore] Cercle créé:",{centerType:typeof k.center,center:k.center,radius:k.radius,style:ae.properties.style,name:ae.properties.style.name}),ae}case"Note":{console.log("[DrawingStore] Traitement d'une Note à partir de l'API",{id:e.id,data:e.data});const k=e.data;if(!k.location)return console.error("[DrawingStore] Données invalides pour Note"),null;try{const ae={location:k.location,name:k.name||"Note géolocalisée",description:k.description||"",columnId:k.columnId||"en-cours",accessLevel:k.accessLevel||"private",category:k.category||"forages",style:{color:((ee=k.style)==null?void 0:ee.color)||"#2b6451",weight:((fe=k.style)==null?void 0:fe.weight)||2,fillColor:((ce=k.style)==null?void 0:ce.fillColor)||"#2b6451",fillOpacity:((_e=k.style)==null?void 0:_e.fillOpacity)||.8,radius:((se=k.style)==null?void 0:se.radius)||12},comments:k.comments||[],photos:k.photos||[],order:k.order||0,createdAt:k.createdAt||new Date().toISOString(),updatedAt:k.updatedAt||new Date().toISOString()};console.log("[DrawingStore] Données préparées pour la note:",ae);const ke=Fp.fromBackendData(ae);return ke._dbId=e.id,console.log("[DrawingStore] Note créée:",{id:e.id,location:ae.location,name:ae.name,type:ke.properties.type}),ke}catch(ae){return console.error("[DrawingStore] Erreur lors de la création de la Note:",ae),null}}default:return console.warn("[DrawingStore] Type non géré pour la restauration:",e.type_forme),null}}const ad=Np("drawing",{state:()=>({currentMapId:null,elements:[],selectedElement:null,unsavedChanges:!1,loading:!1,error:null,currentTool:"",filters:{accessLevels:{company:!0,employee:!0,visitor:!0},categories:{forages:!0,clients:!0,entrepots:!0,livraisons:!0,cultures:!0,parcelles:!0},shapeTypes:{Polygon:!0,Line:!0,ElevationLine:!0,Note:!0}},currentStyle:{strokeStyle:"solid",strokeWidth:2,strokeColor:"#2563EB",fillColor:"#3B82F6",fillOpacity:.2},lastUsedType:null,performanceMonitor:pd()}),getters:{hasUnsavedChanges:e=>e.unsavedChanges,getCurrentElements:e=>e.elements,getSelectedElement:e=>e.selectedElement,getCurrentTool:e=>e.currentTool,getCurrentStyle:e=>e.currentStyle,getLastUsedType:e=>e.lastUsedType,getFilters:e=>e.filters,getFilteredElements:e=>{if(e.elements.length===0)return console.log("[DrawingStore][getFilteredElements] Aucun élément dans le store, retour d'un tableau vide"),[];console.log("[DrawingStore][getFilteredElements] Début du filtrage avec",{totalElements:e.elements.length,filters:JSON.stringify({accessLevels:e.filters.accessLevels,categories:e.filters.categories,shapeTypes:e.filters.shapeTypes})}),console.log("[DrawingStore][getFilteredElements] Éléments dans le store:",e.elements.map(n=>({id:n.id,type_forme:n.type_forme,data:n.data?JSON.stringify(n.data):null})));const t=e.elements.filter(n=>{var f,d;if(console.log(`[DrawingStore][getFilteredElements] Vérification de l'élément ${n.id} (${n.type_forme})`),!(n.type_forme in e.filters.shapeTypes?e.filters.shapeTypes[n.type_forme]:!0))return console.log(`[DrawingStore][getFilteredElements] Élément ${n.id} filtré par type: ${n.type_forme} (non visible)`),!1;const i=((f=n.data)==null?void 0:f.category)||"default";if(!(i in e.filters.categories?e.filters.categories[i]:!0))return console.log(`[DrawingStore][getFilteredElements] Élément ${n.id} filtré par catégorie: ${i} (non visible)`),!1;const o=((d=n.data)==null?void 0:d.accessLevel)||"visitor";let u=!0;return o==="company"?u=e.filters.accessLevels.company:o==="employee"?u=e.filters.accessLevels.employee:o==="visitor"&&(u=e.filters.accessLevels.visitor),u?(console.log(`[DrawingStore][getFilteredElements] Élément ${n.id} visible: type=${n.type_forme}, catégorie=${i}, accès=${o}`),!0):(console.log(`[DrawingStore][getFilteredElements] Élément ${n.id} filtré par niveau d'accès: ${o} (non visible)`),!1)});return console.log("[DrawingStore][getFilteredElements] Résultat du filtrage:",{total:e.elements.length,filtered:t.length,filteredIds:t.map(n=>n.id)}),t}},actions:{setCurrentPlan(e){window.dispatchEvent(new CustomEvent("clearControlPoints")),this.currentMapId=e,e===null&&this.clearElements(),this.selectedElement=null,this.unsavedChanges=!1,this.currentTool="",this.lastUsedType=null,this.currentStyle={strokeStyle:"solid",strokeWidth:2,strokeColor:"#2563EB",fillColor:"#3B82F6",fillOpacity:.2},this.filters={accessLevels:{company:!0,employee:!0,visitor:!0},categories:{forages:!0,clients:!0,entrepots:!0,livraisons:!0,cultures:!0,parcelles:!0},shapeTypes:{Polygon:!0,Line:!0,ElevationLine:!0,Note:!0}}},clearCurrentPlan(){(this.currentMapId!==null||this.elements.length>0)&&(this.currentMapId=null,this.elements=[],this.selectedElement=null,this.unsavedChanges=!1,this.loading=!1,this.error=null)},clearElements(){this.elements=[],this.selectedElement=null,this.unsavedChanges=!1,this.error=null},addElement(e){var n;const t=this.performanceMonitor.startMeasure("addElement","DrawingStore");try{if(console.log("[DrawingStore] Ajout d'un élément",{element:e,isLeafletLayer:e instanceof Vn.Layer,hasProperties:!!e.properties,properties:e.properties,type:(n=e.properties)==null?void 0:n.type}),e instanceof Vn.Layer&&e.properties){const r=this.performanceMonitor.measure("addElement_convert",()=>_b(e),"DrawingStore");console.log("[DrawingStore] Élément converti avant ajout",{original:e,converted:r,type:r.type_forme,data:r.data}),this.elements.push(r)}else!e.type_forme&&this.lastUsedType&&(e.type_forme=this.lastUsedType),this.elements.push(e);this.unsavedChanges=!0}finally{t()}},updateElement(e){const t=this.elements.findIndex(n=>n.id===e.id);if(t!==-1){const n=this.elements[t].type_forme;this.elements[t]={...e,type_forme:n},this.unsavedChanges=!0}},removeElement(e){const t=this.elements.findIndex(n=>n.id===e);t!==-1&&(this.elements.splice(t,1),this.unsavedChanges=!0)},selectElement(e){this.selectedElement=e},setCurrentTool(e){this.currentTool=e,["CERCLE","RECTANGLE","DEMI_CERCLE","LIGNE","TEXTE"].includes(e)&&(this.lastUsedType=e)},setCurrentStyle(e){if(!e||Object.keys(e).length===0){this.currentStyle={strokeStyle:"solid",strokeWidth:2,strokeColor:"#2563EB",fillColor:"#3B82F6",fillOpacity:.2};return}this.currentStyle={...this.currentStyle,...e}},updateFilters(e){if(console.log("[DrawingStore][updateFilters] Mise à jour des filtres:",JSON.stringify(e,null,2)),console.log("[DrawingStore][updateFilters] Filtres avant mise à jour:",JSON.stringify(this.filters,null,2)),e.accessLevels){const t={...this.filters.accessLevels};this.filters.accessLevels={...this.filters.accessLevels,...e.accessLevels},console.log("[DrawingStore][updateFilters] Niveaux d'accès mis à jour:",{avant:t,après:this.filters.accessLevels})}if(e.categories){const t={...this.filters.categories};this.filters.categories={...this.filters.categories,...e.categories},console.log("[DrawingStore][updateFilters] Catégories mises à jour:",{avant:t,après:this.filters.categories});const n=Object.keys(e.categories).filter(r=>t[r]!==this.filters.categories[r]);if(n.length>0){console.log(`[DrawingStore][updateFilters] Catégories modifiées: ${n.join(", ")}`);const r=n.filter(i=>t[i]===!1&&this.filters.categories[i]===!0);r.length>0&&(console.log(`[DrawingStore][updateFilters] Catégories réactivées: ${r.join(", ")}`),window.dispatchEvent(new CustomEvent("categoriesReactivated",{detail:{categories:r}})))}}if(e.shapeTypes){const t={...this.filters.shapeTypes};this.filters.shapeTypes={...this.filters.shapeTypes,...e.shapeTypes},console.log("[DrawingStore][updateFilters] Types de formes mis à jour:",{avant:t,après:this.filters.shapeTypes});const n=Object.keys(e.shapeTypes).filter(r=>t[r]!==this.filters.shapeTypes[r]);if(n.length>0){console.log(`[DrawingStore][updateFilters] Types de formes modifiés: ${n.join(", ")}`);const r=n.filter(i=>t[i]===!1&&this.filters.shapeTypes[i]===!0);r.length>0&&(console.log(`[DrawingStore][updateFilters] Types de formes réactivés: ${r.join(", ")}`),window.dispatchEvent(new CustomEvent("shapeTypesReactivated",{detail:{shapeTypes:r}})))}}console.log("[DrawingStore][updateFilters] Filtres mis à jour:",JSON.stringify(this.filters,null,2)),console.log("[DrawingStore][updateFilters] Émission de l'event filtersChanged"),window.dispatchEvent(new CustomEvent("filtersChanged",{detail:{filters:this.filters}}))},async loadPlanElements(e){const t=this.performanceMonitor.startMeasure("loadPlanElements","DrawingStore");if(this.currentMapId===e&&this.elements.length>0)return console.log(`[DrawingStore] Plan ${e} déjà chargé avec ${this.elements.length} éléments`),t(),this.elements;this.loading=!0;try{console.log("[DrawingStore] Début du chargement du plan",{planId:e});const r=(await this.performanceMonitor.measureAsync("loadPlanElements_apiCall",()=>Rn.get(`/plans/${e}/`),"DrawingStore")).data;return console.log("[DrawingStore] Données du plan reçues",{formes:r.formes,preferences:r.preferences}),r.formes&&Array.isArray(r.formes)&&r.formes.forEach((i,s)=>{var o,u,f;console.log(`[DrawingStore] Analyse détaillée forme ${s}:`,{id:i.id,type_forme:i.type_forme,hasData:!!i.data,dataKeys:i.data?Object.keys(i.data):[],name:(o=i.data)==null?void 0:o.name,hasName:i.data&&"name"in i.data,centerType:(u=i.data)!=null&&u.center?typeof i.data.center:"undefined",center:(f=i.data)==null?void 0:f.center})}),this.elements=r.formes.map(i=>{var s;if(console.log("[DrawingStore] Traitement de la forme stockée",{id:i.id,type_forme:i.type_forme,data:i.data}),i.type_forme)return console.log("[DrawingStore] Forme déjà au format élément",{type_forme:i.type_forme,data:i.data,hasName:i.data&&"name"in i.data,name:(s=i.data)==null?void 0:s.name}),{id:i.id,type_forme:i.type_forme,data:i.data||{}};try{const o=P7(i);if(o)return console.log("[DrawingStore] Forme convertie avec succès",{originalType:i.type_forme,convertedType:o.type,properties:o.properties}),_b(o)}catch(o){console.error("[DrawingStore] Erreur lors de la conversion de la forme",{error:o,forme:i})}return console.warn("[DrawingStore] Utilisation de la forme sans conversion",{type_forme:i.type_forme,data:i.data}),i}),console.log(`[DrawingStore] Plan ${e} - Chargé ${this.elements.length} éléments`,{elements:this.elements.map(i=>({id:i.id,type_forme:i.type_forme}))}),this.currentMapId=e,this.unsavedChanges=!1,r.preferences&&(console.log("[DrawingStore] Chargement des préférences",r.preferences),r.preferences.currentTool&&this.setCurrentTool(r.preferences.currentTool),r.preferences.currentStyle&&(this.currentStyle={...this.currentStyle,...r.preferences.currentStyle}),r.preferences.lastUsedType&&(this.lastUsedType=r.preferences.lastUsedType)),this.elements}catch(n){throw console.error("[DrawingStore] Erreur lors du chargement des éléments:",n),this.error="Erreur lors du chargement des éléments du plan",n}finally{this.loading=!1,t()}},async saveToPlan(e,t){const n=this.performanceMonitor.startMeasure("saveToPlan","DrawingStore");this.loading=!0;try{const r=e||this.currentMapId;if(console.log("[DrawingStore][saveToPlan] Début de la sauvegarde",{targetPlanId:r,currentPlanId:this.currentMapId,elementsCount:this.elements.length,elementsToDelete:t==null?void 0:t.elementsToDelete}),!r)throw new Error("Aucun plan sélectionné pour la sauvegarde");const i=this.performanceMonitor.measure("saveToPlan_prepareElements",()=>this.elements.map(f=>({...f,type_forme:f.type_forme||this.lastUsedType})),"DrawingStore"),s=(t==null?void 0:t.elementsToDelete)||[],o=`/plans/${r}/save_with_elements/`,u=await this.performanceMonitor.measureAsync("saveToPlan_apiCall",()=>Rn.post(o,{formes:i,connexions:[],annotations:[],elementsToDelete:s,preferences:{currentTool:this.currentTool,currentStyle:this.currentStyle,lastUsedType:this.lastUsedType}}),"DrawingStore");return this.elements=this.performanceMonitor.measure("saveToPlan_processResponse",()=>{const f=new Set(s);return u.data.formes.filter(d=>!f.has(d.id)).map(d=>({...d,type_forme:d.type_forme}))},"DrawingStore"),console.log("[DrawingStore][saveToPlan] Éléments après filtrage:",{totalElements:this.elements.length,elementsToDelete:s}),this.unsavedChanges=!1,u.data}catch(r){throw console.error("[DrawingStore][saveToPlan] ERREUR:",r),console.error("[DrawingStore][saveToPlan] Stack trace:",r instanceof Error?r.stack:"No stack trace"),this.error="Erreur lors de la sauvegarde du plan",r}finally{this.loading=!1,n()}}}}),M7={class:"h-full flex flex-col bg-white overflow-y-auto"},A7={class:"border-b border-gray-200"},k7={class:"flex -mb-px"},T7={class:"flex-1 overflow-y-auto"},N7={key:0,class:"p-3"},D7={class:"grid grid-cols-4 gap-1.5 mb-4"},I7=["onClick","title"],O7=["innerHTML"],B7={key:1,class:"p-3"},R7={class:"grid grid-cols-6 gap-2 mb-4"},F7=["onClick","title"],j7={key:0,class:"space-y-4"},z7={class:"flex items-center gap-4"},$7={class:"flex items-center gap-2"},U7={class:"flex items-center gap-4"},V7=["value"],G7={key:0,class:"flex items-center gap-4"},H7={class:"flex items-center gap-2"},q7={key:1,class:"space-y-4"},W7={class:"flex items-center gap-4"},Z7={class:"flex items-center gap-2"},K7={class:"flex items-center gap-4"},Y7={class:"flex items-center gap-2"},J7={key:2,class:"p-3"},X7={key:0},Q7={class:"mb-4"},eO={class:"mb-4"},tO={class:"mb-4"},nO={class:"grid grid-cols-1 gap-4"},rO={key:0,class:"space-y-1"},iO={class:"flex justify-between items-center"},oO={class:"text-sm font-medium text-gray-500"},sO={class:"flex justify-between items-center"},aO={class:"text-sm font-medium text-gray-500"},lO={class:"text-sm font-medium text-gray-500"},uO={class:"flex flex-col space-y-2 w-full"},cO={class:"flex justify-between items-center"},fO={class:"text-sm font-medium text-gray-500 ml-2"},hO={class:"flex justify-between items-center"},dO={class:"text-sm font-medium text-gray-500 ml-2"},pO={class:"flex justify-between items-center"},gO={class:"text-sm font-medium text-gray-500 ml-2"},mO={class:"flex justify-between items-center"},vO={class:"text-sm font-medium text-gray-500 ml-2"},yO={class:"flex justify-between items-center"},_O={class:"text-sm font-medium text-gray-500 ml-2"},bO={ref:"elevationProfileContainer",class:"elevation-profile-container w-full h-48 bg-gray-50 rounded border border-gray-200 relative mt-4"},wO={ref:"elevationCanvas"},xO={key:1,class:"text-center text-sm text-gray-500"},LO={key:3,class:"p-3 space-y-4"},SO={class:"space-y-2"},CO={class:"space-y-2"},EO={class:"space-y-1"},PO={class:"flex items-center"},MO={class:"flex items-center"},AO={class:"flex items-center"},kO={class:"flex items-center"},TO={class:"flex items-center"},NO={class:"flex items-center"},DO={class:"space-y-2"},IO={class:"space-y-1"},OO={class:"flex items-center"},BO={class:"flex items-center"},RO={class:"flex items-center"},FO={class:"flex items-center"},jO={key:0,class:"p-3 border-t border-gray-200"},zO={class:"mt-3"},$O={class:"mb-4"},UO={class:"grid grid-cols-2 gap-2"},VO={class:"grid grid-cols-2 gap-2"},GO=cs({__name:"DrawingTools",props:{currentTool:{type:String,default:""},selectedShape:{type:Object,default:null},allLayers:{type:Array,default:()=>[]}},emits:["tool-change","style-update","properties-update","delete-shape","filter-change"],setup(e,{emit:t}){const n=e,r=ad(),i=[{type:"Polygon",label:"Polygone"},{type:"Line",label:"Ligne"},{type:"ElevationLine",label:"Profil altimétrique"},{type:"Note",label:"Note géolocalisée"}],s=se=>{switch(se){case"Polygon":return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5l16 0l0 14l-16 0l0 -14z"/></svg>';case"Line":return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 20l16 -16"/></svg>';case"ElevationLine":return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 20h18l-3-3l-4 4l-4-7l-4 4l-3-3"/></svg>';case"Note":return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 2l4 4m-6 0l2-2 4 4-2 2-4-4z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h8" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 14h4" /></svg>';default:return""}},o=Ft("tools");Co(o,(se,k)=>{console.log("[DrawingTools][watch activeTab] Changement d'onglet:",{newTab:se,oldTab:k}),se==="filters"&&k!=="filters"&&(console.log("[DrawingTools][watch activeTab] Passage à l'onglet filtres"),console.log("[DrawingTools][watch activeTab] État actuel des filtres dans le store:",JSON.stringify({accessLevels:{...r.filters.accessLevels},categories:{...r.filters.categories},shapeTypes:{...r.filters.shapeTypes}},null,2)),console.log("[DrawingTools][watch activeTab] État actuel des filtres locaux:",JSON.stringify({accessLevels:{...le.accessLevels},categories:{...le.categories},shapeTypes:{...le.shapeTypes}},null,2)),n.selectedShape&&(console.log("[DrawingTools][watch activeTab] Désélection de la forme actuelle lors du passage à l'onglet filtres"),_e("tool-change","")),setTimeout(()=>{Le()},0)),k==="filters"&&se!=="filters"&&(console.log("[DrawingTools][watch activeTab] Sortie de l'onglet filtres, application des changements"),console.log("[DrawingTools][watch activeTab] État des filtres locaux avant application:",JSON.stringify({accessLevels:{...le.accessLevels},categories:{...le.categories},shapeTypes:{...le.shapeTypes}},null,2)),Le())});const u=Ft({samplePoints:!0,circleSections:!0}),f=Ft("#2b6451"),d=Ft(2),g=Ft("solid"),y=Ft("#2b6451"),x=Ft(.2),_=Ft(!0),M=Ft(""),T=Ft("default"),D=Ft("visitor"),I=Ft({radius:4,color:"#2b6451",fillOpacity:.6,weight:2}),j=Ft({radius:6,color:"#EF4444",fillOpacity:.8,weight:2}),Z=["#2b6451","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899"],te=[{value:"solid",label:"Continu"},{value:"dashed",label:"Tirets"},{value:"dotted",label:"Pointillés"}],ue=Ft("company"),le=Yl({accessLevels:{company:!0,employee:!1,visitor:!1},categories:{forages:!0,clients:!0,entrepots:!0,livraisons:!0,cultures:!0,parcelles:!0},shapeTypes:{Polygon:!0,Line:!0,ElevationLine:!0,Note:!0}}),ge=se=>{console.log(`[DrawingTools][updateAccessLevelFilter] Changement du niveau d'accès: ${se}`),ue.value=se,se==="company"?(le.accessLevels.company=!0,le.accessLevels.employee=!1,le.accessLevels.visitor=!1):se==="employee"?(le.accessLevels.company=!1,le.accessLevels.employee=!0,le.accessLevels.visitor=!1):se==="visitor"&&(le.accessLevels.company=!1,le.accessLevels.employee=!1,le.accessLevels.visitor=!0),Le()},H=se=>{console.log(`[DrawingTools][updateAccessLevelFilterAndDeselect] Changement du niveau d'accès: ${se}`),n.selectedShape&&(console.log("[DrawingTools][updateAccessLevelFilterAndDeselect] Désélection de la forme actuelle"),_e("tool-change","")),ge(se)};console.log("[DrawingTools] Initialisation des filtres:",JSON.stringify({local:{accessLevels:{...le.accessLevels},categories:{...le.categories},shapeTypes:{...le.shapeTypes}},store:{accessLevels:{...r.filters.accessLevels},categories:{...r.filters.categories},shapeTypes:{...r.filters.shapeTypes}}},null,2));const U=cr(()=>n.selectedShape&&n.selectedShape.properties||null),Q=se=>{u.value[se]=!u.value[se]},F=se=>{f.value=se,y.value=se,B({strokeColor:se,fillColor:se})},B=se=>{n.selectedShape&&_e("style-update",se)},R=()=>{n.selectedShape&&_e("properties-update",{name:M.value})},$=()=>{n.selectedShape&&_e("properties-update",{category:T.value})},W=()=>{n.selectedShape&&_e("properties-update",{accessLevel:D.value})},G=()=>{var se;!n.selectedShape||((se=U.value)==null?void 0:se.type)!=="ElevationLine"||_e("style-update",{samplePointStyle:I.value})},J=()=>{var se;!n.selectedShape||((se=U.value)==null?void 0:se.type)!=="ElevationLine"||_e("style-update",{minMaxPointStyle:j.value})},Y=()=>{console.log("[DrawingTools][resetFilters] Début de la réinitialisation des filtres"),console.log("[DrawingTools][resetFilters] État actuel des filtres:",JSON.stringify({accessLevels:{...le.accessLevels},categories:{...le.categories},shapeTypes:{...le.shapeTypes}},null,2));const se={accessLevels:{company:!0,employee:!0,visitor:!0},categories:{forages:!0,clients:!0,entrepots:!0,livraisons:!0,cultures:!0,parcelles:!0},shapeTypes:{Polygon:!0,Line:!0,ElevationLine:!0,Note:!0}};console.log("[DrawingTools][resetFilters] Nouveaux filtres à appliquer:",JSON.stringify(se,null,2)),console.log("[DrawingTools][resetFilters] Mise à jour des filtres locaux"),le.accessLevels.company=!0,le.accessLevels.employee=!0,le.accessLevels.visitor=!0,le.categories.forages=!0,le.categories.clients=!0,le.categories.entrepots=!0,le.categories.livraisons=!0,le.categories.cultures=!0,le.categories.parcelles=!0,le.shapeTypes.Polygon=!0,le.shapeTypes.Line=!0,le.shapeTypes.ElevationLine=!0,le.shapeTypes.Note=!0,console.log("[DrawingTools][resetFilters] Filtres locaux après mise à jour:",JSON.stringify({accessLevels:{...le.accessLevels},categories:{...le.categories},shapeTypes:{...le.shapeTypes}},null,2)),console.log("[DrawingTools][resetFilters] Mise à jour des filtres dans le store"),r.updateFilters(se),console.log("[DrawingTools][resetFilters] Émission de l'event filter-change"),_e("filter-change",se),console.log("[DrawingTools][resetFilters] Mise à jour forcée de l'affichage"),console.log("[DrawingTools][resetFilters] Filtres réinitialisés avec succès")},pe=()=>{console.log("[DrawingTools][resetFiltersAndDeselect] Début de la réinitialisation des filtres avec désélection"),fe(),Y(),console.log("[DrawingTools][resetFiltersAndDeselect] Filtres réinitialisés et forme désélectionnée avec succès")},Le=()=>{const se={...le.accessLevels},k={...le.categories},ae={...le.shapeTypes};console.log("[DrawingTools][applyFilters] Application des filtres:",JSON.stringify({accessLevels:se,categories:k,shapeTypes:ae},null,2));const ke={accessLevels:se,categories:k,shapeTypes:ae};console.log("[DrawingTools][applyFilters] Envoi des filtres au store:",JSON.stringify(ke,null,2)),r.updateFilters(ke),console.log("[DrawingTools][applyFilters] Émission de l'event filter-change"),_e("filter-change",ke),setTimeout(()=>{console.log("[DrawingTools][applyFilters] Mise à jour forcée de l'affichage"),window.dispatchEvent(new CustomEvent("filtersChanged",{detail:{filters:ke}}))},0),console.log("[DrawingTools][applyFilters] Filtres appliqués avec succès")},De=se=>`${Math.round(se)} m`,N=se=>se>=1e4?`${(se/1e4).toFixed(2)} ha`:`${Math.round(se)} m²`,ee=se=>`${se.toFixed(1)}%`,fe=()=>{n.selectedShape&&(console.log("[DrawingTools][deselectCurrentShape] Désélection de la forme actuelle"),_e("tool-change",""))},ce=()=>{fe(),o.value="filters"},_e=t;return bp(()=>{var se,k,ae,ke,Pe,Ge,K;if(n.selectedShape){console.log("[DrawingTools][watchEffect] Mise à jour des propriétés pour la forme sélectionnée:",{type:n.selectedShape.type,properties:n.selectedShape.properties,options:n.selectedShape.options,layer:(se=n.selectedShape.layer)==null?void 0:se._leaflet_id});const de=n.selectedShape.options||{};f.value=de.color||"#2b6451",d.value=de.weight||3,g.value=de.dashArray?"dashed":"solid",y.value=de.fillColor||"#2b6451",x.value=de.fillOpacity||.2;const ye=n.selectedShape.type||((k=n.selectedShape.properties)==null?void 0:k.type)||"";_.value=ye!=="Line",console.log("[DrawingTools][watchEffect] Type de forme détecté:",ye),M.value=((ae=n.selectedShape.properties)==null?void 0:ae.name)||"",T.value=((ke=n.selectedShape.properties)==null?void 0:ke.category)||"forages",D.value=((Pe=n.selectedShape.properties)==null?void 0:Pe.accessLevel)||"visitor",ye==="ElevationLine"&&((Ge=n.selectedShape.properties)!=null&&Ge.samplePointStyle&&(I.value={...n.selectedShape.properties.samplePointStyle}),(K=n.selectedShape.properties)!=null&&K.minMaxPointStyle&&(j.value={...n.selectedShape.properties.minMaxPointStyle})),console.log("[DrawingTools][watchEffect] Propriétés mises à jour avec succès")}}),$s(()=>{console.log("[DrawingTools][onMounted] Initialisation des filtres depuis le store");const se=r.filters;console.log("[DrawingTools][onMounted] Filtres du store:",JSON.stringify({accessLevels:{...se.accessLevels},categories:{...se.categories},shapeTypes:{...se.shapeTypes}},null,2)),le.accessLevels.company=se.accessLevels.company,le.accessLevels.employee=se.accessLevels.employee,le.accessLevels.visitor=se.accessLevels.visitor,le.categories.forages=se.categories.forages,le.categories.clients=se.categories.clients,le.categories.entrepots=se.categories.entrepots,le.categories.livraisons=se.categories.livraisons,le.categories.cultures=se.categories.cultures,le.categories.parcelles=se.categories.parcelles,le.shapeTypes.Polygon=se.shapeTypes.Polygon,le.shapeTypes.Line=se.shapeTypes.Line,le.shapeTypes.ElevationLine=se.shapeTypes.ElevationLine,le.shapeTypes.Note=se.shapeTypes.Note,console.log("[DrawingTools][onMounted] Filtres locaux après initialisation:",JSON.stringify({accessLevels:{...le.accessLevels},categories:{...le.categories},shapeTypes:{...le.shapeTypes}},null,2))}),Co(le,(se,k)=>{console.log("[DrawingTools][watch filters] Changement détecté:",{activeTab:o.value,newFilters:JSON.stringify({accessLevels:se.accessLevels,categories:se.categories,shapeTypes:se.shapeTypes}),oldFilters:JSON.stringify({accessLevels:k.accessLevels,categories:k.categories,shapeTypes:k.shapeTypes})});const ae=Object.keys(se.accessLevels).filter(K=>k.accessLevels[K]!==se.accessLevels[K]),ke=Object.keys(se.categories).filter(K=>k.categories[K]!==se.categories[K]),Pe=Object.keys(se.shapeTypes).filter(K=>k.shapeTypes[K]!==se.shapeTypes[K]),Ge=ae.length>0||ke.length>0||Pe.length>0;console.log("[DrawingTools][watch filters] Différences détectées:",{accessLevelsDiff:ae,categoriesDiff:ke,shapeTypesDiff:Pe,hasChanges:Ge}),o.value==="filters"?(console.log("[DrawingTools][watch filters] Onglet filtres actif, application des filtres"),Le()):console.log("[DrawingTools][watch filters] Onglet filtres non actif, pas d'application automatique")},{deep:!0}),(se,k)=>{var ae,ke,Pe,Ge;return $e(),qe("div",M7,[k[96]||(k[96]=E("div",{class:"p-3 bg-gray-50 border-b border-gray-200 flex justify-between items-center md:flex hidden"},[E("h3",{class:"text-sm font-semibold text-gray-700"},"Outils de dessin")],-1)),E("div",A7,[E("nav",k7,[E("button",{onClick:k[0]||(k[0]=K=>o.value="tools"),class:Bi([o.value==="tools"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","flex-1 py-3 px-1 text-center border-b-2 font-medium text-sm"])},k[45]||(k[45]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mx-auto mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1),E("span",null,"Outils",-1)]),2),e.selectedShape&&((ae=e.selectedShape.properties)==null?void 0:ae.type)!=="Note"?($e(),qe("button",{key:0,onClick:k[1]||(k[1]=K=>o.value="style"),class:Bi([o.value==="style"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","flex-1 py-3 px-1 text-center border-b-2 font-medium text-sm"])},k[46]||(k[46]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mx-auto mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})],-1),E("span",null,"Style",-1)]),2)):dn("",!0),e.selectedShape?($e(),qe("button",{key:1,onClick:k[2]||(k[2]=K=>o.value="properties"),class:Bi([o.value==="properties"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","flex-1 py-3 px-1 text-center border-b-2 font-medium text-sm"])},k[47]||(k[47]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mx-auto mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1),E("span",null,"Propriétés",-1)]),2)):dn("",!0),E("button",{onClick:ce,class:Bi([o.value==="filters"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","flex-1 py-3 px-1 text-center border-b-2 font-medium text-sm"])},k[48]||(k[48]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mx-auto mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})],-1),E("span",null,"Filtres",-1)]),2)])]),E("div",T7,[o.value==="tools"?($e(),qe("div",N7,[E("div",D7,[($e(!0),qe(Bn,null,Er(i.filter(K=>K.type!=="delete"),K=>($e(),qe("button",{key:K.type,class:Bi(["flex items-center justify-center p-2 rounded-md border",{"bg-blue-50 border-blue-300 text-blue-700 shadow-sm":e.currentTool===K.type}]),onClick:de=>se.$emit("tool-change",e.currentTool===K.type?"":K.type),title:K.label},[E("span",{class:"icon",innerHTML:s(K.type)},null,8,O7)],10,I7))),128))]),e.selectedShape?($e(),qe("button",{key:0,class:Bi(["w-full mt-2 p-2 rounded-md border border-red-200 bg-red-50 text-red-600 hover:bg-red-100 flex items-center justify-center",{"bg-red-100":e.currentTool==="delete"}]),onClick:k[3]||(k[3]=K=>se.$emit("delete-shape")),title:"Supprimer la forme"},k[49]||(k[49]=[E("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),E("span",{class:"text-sm"},"Supprimer",-1)]),2)):dn("",!0)])):dn("",!0),o.value==="style"&&e.selectedShape&&((ke=e.selectedShape.properties)==null?void 0:ke.type)!=="Note"?($e(),qe("div",B7,[E("div",R7,[($e(),qe(Bn,null,Er(Z,K=>E("button",{key:K,class:"w-8 h-8 rounded-full",style:ql({backgroundColor:K}),onClick:de=>F(K),title:K},null,12,F7)),64))]),((Pe=U.value)==null?void 0:Pe.type)!=="TextRectangle"?($e(),qe("div",j7,[E("div",z7,[k[50]||(k[50]=E("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Contour",-1)),E("div",$7,[Fn(E("input",{type:"color","onUpdate:modelValue":k[4]||(k[4]=K=>f.value=K),class:"w-16 h-8 rounded border",onChange:k[5]||(k[5]=K=>B({strokeColor:f.value})),title:"Couleur du contour"},null,544),[[ri,f.value]]),Fn(E("input",{type:"range","onUpdate:modelValue":k[6]||(k[6]=K=>d.value=K),min:"1",max:"10",class:"w-16 h-2 rounded-md",onChange:k[7]||(k[7]=K=>B({strokeWidth:d.value})),title:"Épaisseur du contour"},null,544),[[ri,d.value]])])]),E("div",U7,[k[51]||(k[51]=E("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Style",-1)),Fn(E("select",{"onUpdate:modelValue":k[8]||(k[8]=K=>g.value=K),class:"w-full rounded border",onChange:k[9]||(k[9]=K=>B({strokeStyle:g.value}))},[($e(),qe(Bn,null,Er(te,K=>E("option",{key:K.value,value:K.value},Wt(K.label),9,V7)),64))],544),[[uo,g.value]])]),_.value?($e(),qe("div",G7,[k[52]||(k[52]=E("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Remplir",-1)),E("div",H7,[Fn(E("input",{type:"color","onUpdate:modelValue":k[10]||(k[10]=K=>y.value=K),class:"w-16 h-8 rounded border",onChange:k[11]||(k[11]=K=>B({fillColor:y.value})),title:"Couleur de remplissage"},null,544),[[ri,y.value]]),Fn(E("input",{type:"range","onUpdate:modelValue":k[12]||(k[12]=K=>x.value=K),min:"0",max:"1",step:"0.1",class:"w-16 h-2 rounded-md",onChange:k[13]||(k[13]=K=>B({fillOpacity:x.value})),title:"Opacité du remplissage"},null,544),[[ri,x.value]])])])):dn("",!0)])):dn("",!0),((Ge=U.value)==null?void 0:Ge.type)==="TextRectangle"?($e(),qe("div",q7,[E("div",W7,[k[53]||(k[53]=E("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Contour",-1)),E("div",Z7,[Fn(E("input",{type:"color","onUpdate:modelValue":k[14]||(k[14]=K=>f.value=K),class:"w-16 h-8 rounded border",onChange:k[15]||(k[15]=K=>B({strokeColor:f.value})),title:"Couleur du contour"},null,544),[[ri,f.value]]),Fn(E("input",{type:"range","onUpdate:modelValue":k[16]||(k[16]=K=>d.value=K),min:"1",max:"10",class:"w-16 h-2 rounded-md",onChange:k[17]||(k[17]=K=>B({strokeWidth:d.value})),title:"Épaisseur du contour"},null,544),[[ri,d.value]])])]),E("div",K7,[k[54]||(k[54]=E("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Remplir",-1)),E("div",Y7,[Fn(E("input",{type:"color","onUpdate:modelValue":k[18]||(k[18]=K=>y.value=K),class:"w-16 h-8 rounded border",onChange:k[19]||(k[19]=K=>B({fillColor:y.value})),title:"Couleur de remplissage"},null,544),[[ri,y.value]]),Fn(E("input",{type:"range","onUpdate:modelValue":k[20]||(k[20]=K=>x.value=K),min:"0",max:"1",step:"0.1",class:"w-16 h-2 rounded-md",onChange:k[21]||(k[21]=K=>B({fillOpacity:x.value})),title:"Opacité du remplissage"},null,544),[[ri,x.value]])])])])):dn("",!0)])):dn("",!0),o.value==="properties"&&e.selectedShape?($e(),qe("div",J7,[U.value?($e(),qe("div",X7,[E("div",Q7,[k[55]||(k[55]=E("label",{for:"shapeName",class:"block text-sm font-medium text-gray-700 mb-1"},"Nom de la forme",-1)),Fn(E("input",{type:"text",id:"shapeName","onUpdate:modelValue":k[22]||(k[22]=K=>M.value=K),onChange:R,placeholder:"Donnez un nom à cette forme",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"},null,544),[[ri,M.value]])]),E("div",eO,[k[57]||(k[57]=E("label",{for:"shapeCategory",class:"block text-sm font-medium text-gray-700 mb-1"},"Catégorie",-1)),Fn(E("select",{id:"shapeCategory","onUpdate:modelValue":k[23]||(k[23]=K=>T.value=K),onChange:$,class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"},k[56]||(k[56]=[cc('<option value="forages" data-v-9dccca1e>Forages</option><option value="clients" data-v-9dccca1e>Clients</option><option value="entrepots" data-v-9dccca1e>Entrepôts</option><option value="livraisons" data-v-9dccca1e>Lieux de livraison</option><option value="cultures" data-v-9dccca1e>Cultures</option><option value="parcelles" data-v-9dccca1e>Noms des parcelles</option><option value="default" data-v-9dccca1e>Autre</option>',7)]),544),[[uo,T.value]])]),E("div",tO,[k[59]||(k[59]=E("label",{for:"accessLevel",class:"block text-sm font-medium text-gray-700 mb-1"},"Niveau d'accès",-1)),k[60]||(k[60]=E("div",{class:"p-2 bg-blue-50 rounded mb-2 text-xs text-blue-700"}," Définit qui peut voir cet élément sur la carte. ",-1)),Fn(E("select",{id:"accessLevel","onUpdate:modelValue":k[24]||(k[24]=K=>D.value=K),onChange:W,class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"},k[58]||(k[58]=[E("option",{value:"company"},"Entreprise uniquement",-1),E("option",{value:"employee"},"Entreprise et salariés",-1),E("option",{value:"visitor"},"Tous (visiteurs inclus)",-1)]),544),[[uo,D.value]])]),E("div",nO,[U.value.type==="Polygon"?($e(),qe("div",rO,[E("div",iO,[k[61]||(k[61]=E("span",{class:"text-sm font-semibold text-gray-700"},"Surface :",-1)),E("span",oO,Wt(N(U.value.surface||0)),1)]),E("div",sO,[k[62]||(k[62]=E("span",{class:"text-sm font-semibold text-gray-700"},"Périmètre :",-1)),E("span",aO,Wt(De(U.value.perimeter||0)),1)])])):U.value.type==="Line"?($e(),qe(Bn,{key:1},[k[63]||(k[63]=E("span",{class:"text-sm font-semibold text-gray-700"},"Longueur :",-1)),E("span",lO,Wt(De(U.value.length||0)),1)],64)):U.value.type==="ElevationLine"?($e(),qe(Bn,{key:2},[E("div",uO,[E("div",cO,[k[64]||(k[64]=E("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Distance totale :",-1)),E("span",fO,Wt(De(U.value.length||0)),1)]),E("div",hO,[k[65]||(k[65]=E("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Dénivelé + :",-1)),E("span",dO,Wt(De(U.value.elevationGain||0)),1)]),E("div",pO,[k[66]||(k[66]=E("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Dénivelé - :",-1)),E("span",gO,Wt(De(U.value.elevationLoss||0)),1)]),E("div",mO,[k[67]||(k[67]=E("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Pente moy. :",-1)),E("span",vO,Wt(ee(U.value.averageSlope||0)),1)]),E("div",yO,[k[68]||(k[68]=E("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Pente max :",-1)),E("span",_O,Wt(ee(U.value.maxSlope||0)),1)])]),E("div",bO,[E("canvas",wO,null,512)],512)],64)):dn("",!0)])])):($e(),qe("div",xO," Aucune propriété disponible "))])):dn("",!0),o.value==="filters"?($e(),qe("div",LO,[E("div",SO,[k[71]||(k[71]=E("h4",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wider"},"Niveau d'accès",-1)),k[72]||(k[72]=E("div",{class:"p-2 bg-blue-50 rounded mb-2 text-xs text-blue-700"}," Sélectionnez votre niveau d'accès pour filtrer les éléments visibles sur la carte. ",-1)),E("div",null,[Fn(E("select",{"onUpdate:modelValue":k[25]||(k[25]=K=>ue.value=K),onChange:k[26]||(k[26]=K=>H(ue.value)),class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 text-sm"},k[69]||(k[69]=[E("option",{value:"company"},"Entreprise (accès à tout)",-1),E("option",{value:"employee"},"Salariés (accès niveau salariés et visiteurs)",-1),E("option",{value:"visitor"},"Visiteurs (accès niveau visiteurs uniquement)",-1)]),544),[[uo,ue.value]]),k[70]||(k[70]=E("div",{class:"mt-2 text-xs text-gray-500"},[E("p",null,[E("strong",null,"Entreprise"),Pi(" : Vous verrez tous les éléments (entreprise, salariés, visiteurs)")]),E("p",null,[E("strong",null,"Salariés"),Pi(" : Vous verrez les éléments pour salariés et visiteurs")]),E("p",null,[E("strong",null,"Visiteurs"),Pi(" : Vous ne verrez que les éléments pour visiteurs")])],-1))])]),E("div",CO,[k[79]||(k[79]=E("h4",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wider"},"Éléments",-1)),E("div",EO,[E("label",PO,[Fn(E("input",{type:"checkbox","onUpdate:modelValue":k[27]||(k[27]=K=>le.categories.forages=K),onChange:fe,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[Ll,le.categories.forages]]),k[73]||(k[73]=E("span",{class:"ml-2 text-sm text-gray-700"},"Forages",-1))]),E("label",MO,[Fn(E("input",{type:"checkbox","onUpdate:modelValue":k[28]||(k[28]=K=>le.categories.clients=K),onChange:fe,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[Ll,le.categories.clients]]),k[74]||(k[74]=E("span",{class:"ml-2 text-sm text-gray-700"},"Clients",-1))]),E("label",AO,[Fn(E("input",{type:"checkbox","onUpdate:modelValue":k[29]||(k[29]=K=>le.categories.entrepots=K),onChange:fe,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[Ll,le.categories.entrepots]]),k[75]||(k[75]=E("span",{class:"ml-2 text-sm text-gray-700"},"Entrepôts",-1))]),E("label",kO,[Fn(E("input",{type:"checkbox","onUpdate:modelValue":k[30]||(k[30]=K=>le.categories.livraisons=K),onChange:fe,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[Ll,le.categories.livraisons]]),k[76]||(k[76]=E("span",{class:"ml-2 text-sm text-gray-700"},"Lieux de livraison",-1))]),E("label",TO,[Fn(E("input",{type:"checkbox","onUpdate:modelValue":k[31]||(k[31]=K=>le.categories.cultures=K),onChange:fe,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[Ll,le.categories.cultures]]),k[77]||(k[77]=E("span",{class:"ml-2 text-sm text-gray-700"},"Cultures",-1))]),E("label",NO,[Fn(E("input",{type:"checkbox","onUpdate:modelValue":k[32]||(k[32]=K=>le.categories.parcelles=K),onChange:fe,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[Ll,le.categories.parcelles]]),k[78]||(k[78]=E("span",{class:"ml-2 text-sm text-gray-700"},"Noms des parcelles",-1))])])]),E("div",DO,[k[84]||(k[84]=E("h4",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wider"},"Types de formes",-1)),E("div",IO,[E("label",OO,[Fn(E("input",{type:"checkbox","onUpdate:modelValue":k[33]||(k[33]=K=>le.shapeTypes.Polygon=K),onChange:fe,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[Ll,le.shapeTypes.Polygon]]),k[80]||(k[80]=E("span",{class:"ml-2 text-sm text-gray-700"},"Polygones",-1))]),E("label",BO,[Fn(E("input",{type:"checkbox","onUpdate:modelValue":k[34]||(k[34]=K=>le.shapeTypes.Line=K),onChange:fe,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[Ll,le.shapeTypes.Line]]),k[81]||(k[81]=E("span",{class:"ml-2 text-sm text-gray-700"},"Lignes",-1))]),E("label",RO,[Fn(E("input",{type:"checkbox","onUpdate:modelValue":k[35]||(k[35]=K=>le.shapeTypes.ElevationLine=K),onChange:fe,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[Ll,le.shapeTypes.ElevationLine]]),k[82]||(k[82]=E("span",{class:"ml-2 text-sm text-gray-700"},"Profils altimétriques",-1))]),E("label",FO,[Fn(E("input",{type:"checkbox","onUpdate:modelValue":k[36]||(k[36]=K=>le.shapeTypes.Note=K),onChange:fe,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[Ll,le.shapeTypes.Note]]),k[83]||(k[83]=E("span",{class:"ml-2 text-sm text-gray-700"},"Notes",-1))])])]),E("div",{class:"pt-2"},[E("button",{onClick:pe,class:"w-full px-3 py-2 bg-gray-100 text-gray-700 text-sm rounded hover:bg-gray-200 transition-colors"}," Réinitialiser ")])])):dn("",!0)]),e.selectedShape&&U.value&&U.value.type==="ElevationLine"?($e(),qe("div",jO,[E("button",{class:"flex items-center justify-between w-full text-sm font-semibold text-gray-700",onClick:k[37]||(k[37]=K=>Q("samplePoints"))},[k[86]||(k[86]=E("span",null,"Points d'échantillonnage",-1)),($e(),qe("svg",{class:Bi(["w-4 h-4",{"rotate-180":!u.value.samplePoints}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},k[85]||(k[85]=[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),Fn(E("div",zO,[E("div",$O,[k[91]||(k[91]=E("h4",{class:"text-sm font-semibold mb-2"},"Points normaux",-1)),E("div",UO,[E("div",null,[k[87]||(k[87]=E("label",{class:"text-xs text-gray-600"},"Taille",-1)),Fn(E("input",{type:"number","onUpdate:modelValue":k[38]||(k[38]=K=>I.value.radius=K),min:"2",max:"10",step:"1",class:"w-full px-2 py-1 border rounded",onChange:G},null,544),[[ri,I.value.radius]])]),E("div",null,[k[88]||(k[88]=E("label",{class:"text-xs text-gray-600"},"Couleur",-1)),Fn(E("input",{type:"color","onUpdate:modelValue":k[39]||(k[39]=K=>I.value.color=K),class:"w-full h-8 px-1 border rounded",onChange:G},null,544),[[ri,I.value.color]])]),E("div",null,[k[89]||(k[89]=E("label",{class:"text-xs text-gray-600"},"Opacité",-1)),Fn(E("input",{type:"range","onUpdate:modelValue":k[40]||(k[40]=K=>I.value.fillOpacity=K),min:"0",max:"1",step:"0.1",class:"w-full",onChange:G},null,544),[[ri,I.value.fillOpacity]])]),E("div",null,[k[90]||(k[90]=E("label",{class:"text-xs text-gray-600"},"Bordure",-1)),Fn(E("input",{type:"number","onUpdate:modelValue":k[41]||(k[41]=K=>I.value.weight=K),min:"1",max:"5",step:"1",class:"w-full px-2 py-1 border rounded",onChange:G},null,544),[[ri,I.value.weight]])])])]),E("div",null,[k[95]||(k[95]=E("h4",{class:"text-sm font-semibold mb-2"},"Points min/max",-1)),E("div",VO,[E("div",null,[k[92]||(k[92]=E("label",{class:"text-xs text-gray-600"},"Taille",-1)),Fn(E("input",{type:"number","onUpdate:modelValue":k[42]||(k[42]=K=>j.value.radius=K),min:"4",max:"12",step:"1",class:"w-full px-2 py-1 border rounded",onChange:J},null,544),[[ri,j.value.radius]])]),E("div",null,[k[93]||(k[93]=E("label",{class:"text-xs text-gray-600"},"Bordure",-1)),Fn(E("input",{type:"number","onUpdate:modelValue":k[43]||(k[43]=K=>j.value.weight=K),min:"1",max:"5",step:"1",class:"w-full px-2 py-1 border rounded",onChange:J},null,544),[[ri,j.value.weight]])]),E("div",null,[k[94]||(k[94]=E("label",{class:"text-xs text-gray-600"},"Opacité",-1)),Fn(E("input",{type:"range","onUpdate:modelValue":k[44]||(k[44]=K=>j.value.fillOpacity=K),min:"0",max:"1",step:"0.1",class:"w-full",onChange:J},null,544),[[ri,j.value.fillOpacity]])])])])],512),[[qm,!u.value.samplePoints]])])):dn("",!0)])}}}),HO=Bp(GO,[["__scopeId","data-v-9dccca1e"]]),qO={class:"map-toolbar w-full"},WO={class:"hidden md:flex items-center space-x-2"},ZO={class:"dropdown"},KO={class:"dropdown-menu"},YO=["onClick"],JO={key:0,class:"border-l pl-2 flex-1"},XO={class:"flex items-center"},QO={class:"plan-info"},eB={class:"plan-name"},tB={key:0,class:"plan-description"},nB={class:"border-l pl-2 ml-auto"},rB={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},iB={key:1,class:"h-4 w-4 mr-2 text-primary-600",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},oB={key:"saving"},sB={key:"success",class:"save-success-text"},aB={key:"default"},lB={class:"md:hidden"},uB={class:"flex justify-between items-center"},cB={key:0,class:"truncate mx-2 text-sm font-medium"},fB={key:0,class:"mobile-menu mt-0 bg-white shadow-lg p-4 z-[2000] fixed left-0 right-0 w-full"},hB={class:"flex justify-between items-center mb-3 border-b pb-2"},dB={class:"flex flex-col space-y-4"},pB={key:0,class:"flex flex-col pb-3 border-b"},gB={class:"text-sm font-semibold text-gray-800"},mB={key:0,class:"text-xs text-gray-600 mt-1"},vB={class:"flex flex-col"},yB={class:"grid grid-cols-3 gap-2"},_B=["onClick"],bB={key:0,class:"animate-spin h-4 w-4 mr-2 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},wB={key:1,class:"h-4 w-4 mr-2 text-primary-600",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},xB={key:"saving"},LB={key:"success",class:"save-success-text"},SB={key:"default"},CB=cs({__name:"MapToolbar",props:{lastSave:{},planName:{},planDescription:{},saveStatus:{}},emits:["change-map-type","create-new-plan","load-plan","save-plan","adjust-view","generate-summary"],setup(e,{emit:t}){const n=t,r=e,i=Ft("Hybride"),s=Ft(!1),o=D=>{const I=D.currentTarget,j=I.nextElementSibling;if(j&&j.classList.contains("dropdown-menu")){const Z=I.getBoundingClientRect();j.style.top=`${Z.bottom}px`,j.style.left=`${Z.left}px`}},u={Hybride:"Hybride",Cadastre:"Cadastre",IGN:"IGN"},f=cr(()=>r.lastSave?new Date(r.lastSave).toLocaleString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Jamais"),d=D=>{i.value=D,n("change-map-type",D),T()},g=()=>{n("create-new-plan"),T()},y=()=>{n("load-plan"),T()},x=()=>{n("save-plan"),T()},_=()=>{n("adjust-view"),T()},M=()=>{n("generate-summary"),T()},T=()=>{s.value=!1};return(D,I)=>($e(),qe("div",qO,[E("div",WO,[E("div",ZO,[E("button",{class:"btn-toolbar dropdown-toggle",onMouseover:o},[I[2]||(I[2]=E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[E("path",{"fill-rule":"evenodd",d:"M12 1.586l-4 4V17h8V5.586l-4-4zM2 17V9.276l4-3.638V17H2zM2 8.162V3h4.5L12 8.5V17H6V5.638L2 8.162z","clip-rule":"evenodd"})],-1)),E("span",null,Wt(u[i.value]),1)],32),E("div",KO,[($e(),qe(Bn,null,Er(u,(j,Z)=>E("button",{key:Z,class:Bi(["dropdown-item",{active:Z===i.value}]),onClick:te=>d(Z)},Wt(j),11,YO)),64))])]),D.planName?($e(),qe("div",JO,[E("div",XO,[E("div",QO,[E("h2",eB,Wt(D.planName),1),D.planDescription?($e(),qe("p",tB,Wt(D.planDescription),1)):dn("",!0)])])])):dn("",!0),E("div",{class:"border-l pl-2"},[E("div",{class:"flex items-center space-x-1"},[E("button",{onClick:g,class:"btn-toolbar",title:"Nouveau plan"},I[3]||(I[3]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[E("path",{"fill-rule":"evenodd",d:"M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V8z","clip-rule":"evenodd"})],-1),E("span",{class:"hidden lg:inline ml-1"},"Nouveau",-1)])),E("button",{onClick:y,class:"btn-toolbar",title:"Charger un plan"},I[4]||(I[4]=[cc('<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" data-v-a33ebaa5><path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" data-v-a33ebaa5></path><path d="M10 9a1 1 0 011-1h5a1 1 0 110 2h-5a1 1 0 01-1-1z" data-v-a33ebaa5></path><path fill-rule="evenodd" d="M13 5a1 1 0 011 1v4a1 1 0 11-2 0V6a1 1 0 011-1z" clip-rule="evenodd" data-v-a33ebaa5></path></svg><span class="hidden lg:inline ml-1" data-v-a33ebaa5>Charger</span>',2)])),E("button",{onClick:x,class:"btn-toolbar",title:"Enregistrer le plan"},I[5]||(I[5]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[E("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6h5a2 2 0 012 2v7a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2h5v5.586l-1.293-1.293zM9 4a1 1 0 012 0v2H9V4z"})],-1),E("span",{class:"hidden lg:inline ml-1"},"Enregistrer",-1)]))])]),E("div",{class:"border-l pl-2"},[E("div",{class:"flex items-center space-x-1"},[E("button",{onClick:_,class:"btn-toolbar",title:"Ajuster la vue"},I[6]||(I[6]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[E("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1),E("span",{class:"hidden lg:inline ml-1"},"Ajuster",-1)])),E("button",{onClick:M,class:"btn-toolbar",title:"Générer une synthèse"},I[7]||(I[7]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[E("path",{"fill-rule":"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})],-1),E("span",{class:"hidden lg:inline ml-1"},"Synthèse",-1)]))])]),E("div",nB,[E("div",{class:Bi(["text-xs hidden lg:flex items-center",{"text-gray-500":!D.saveStatus,"text-primary-600 font-medium":D.saveStatus==="success","text-blue-600 font-medium":D.saveStatus==="saving"}])},[D.saveStatus==="saving"?($e(),qe("svg",rB,I[8]||(I[8]=[E("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),E("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):dn("",!0),D.saveStatus==="success"?($e(),qe("svg",iB,I[9]||(I[9]=[E("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):dn("",!0),hi(Gv,{name:"fade-slide",mode:"out-in"},{default:Gl(()=>[D.saveStatus==="saving"?($e(),qe("span",oB," Sauvegarde en cours... ")):D.saveStatus==="success"?($e(),qe("span",sB," Sauvegarde réussie ! ")):($e(),qe("span",aB," Dernière modification : "+Wt(f.value),1))]),_:1})],2)])]),E("div",lB,[E("div",uB,[E("button",{onClick:I[0]||(I[0]=j=>s.value=!s.value),class:"p-2 rounded-md border bg-white shadow-sm"},I[10]||(I[10]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-600",viewBox:"0 0 20 20",fill:"currentColor"},[E("path",{"fill-rule":"evenodd",d:"M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})],-1)])),D.planName?($e(),qe("div",cB,Wt(D.planName),1)):dn("",!0),E("div",{class:"flex space-x-2"},[E("button",{onClick:g,class:"p-2 rounded-md border bg-white shadow-sm flex items-center justify-center"},I[11]||(I[11]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-600",viewBox:"0 0 20 20",fill:"currentColor"},[E("path",{"fill-rule":"evenodd",d:"M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V8z","clip-rule":"evenodd"})],-1)])),E("button",{onClick:x,class:"p-2 rounded-md border bg-white shadow-sm flex items-center justify-center"},I[12]||(I[12]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-600",viewBox:"0 0 20 20",fill:"currentColor"},[E("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6h5a2 2 0 012 2v7a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2h5v5.586l-1.293-1.293zM9 4a1 1 0 012 0v2H9V4z"})],-1)])),E("button",{onClick:_,class:"p-2 rounded-md border bg-white shadow-sm flex items-center justify-center"},I[13]||(I[13]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-600",viewBox:"0 0 20 20",fill:"currentColor"},[E("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1)]))])]),s.value?($e(),qe("div",fB,[E("div",hB,[I[15]||(I[15]=E("h3",{class:"text-base font-semibold text-gray-800"},"Menu",-1)),E("button",{onClick:I[1]||(I[1]=j=>s.value=!1),class:"p-1 rounded-full hover:bg-gray-100"},I[14]||(I[14]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),E("div",dB,[D.planName?($e(),qe("div",pB,[E("h3",gB,Wt(D.planName),1),D.planDescription?($e(),qe("p",mB,Wt(D.planDescription),1)):dn("",!0)])):dn("",!0),E("div",vB,[I[16]||(I[16]=E("span",{class:"text-sm font-medium text-gray-700 mb-2"},"Type de carte",-1)),E("div",yB,[($e(),qe(Bn,null,Er(u,(j,Z)=>E("button",{key:Z,class:Bi(["px-3 py-2 text-sm rounded-md border shadow-sm",{"bg-blue-50 border-blue-300 text-blue-700 font-medium":Z===i.value}]),onClick:te=>d(Z)},Wt(j),11,_B)),64))])]),E("div",{class:"flex flex-col"},[I[20]||(I[20]=E("span",{class:"text-sm font-medium text-gray-700 mb-2"},"Outils de plan",-1)),E("div",{class:"grid grid-cols-3 gap-2"},[E("button",{onClick:g,class:"px-3 py-2 text-sm rounded-md border shadow-sm flex items-center justify-center bg-white"},I[17]||(I[17]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[E("path",{"fill-rule":"evenodd",d:"M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V8z","clip-rule":"evenodd"})],-1),Pi(" Nouveau ")])),E("button",{onClick:y,class:"px-3 py-2 text-sm rounded-md border shadow-sm flex items-center justify-center bg-white"},I[18]||(I[18]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[E("path",{"fill-rule":"evenodd",d:"M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z","clip-rule":"evenodd"}),E("path",{d:"M10 9a1 1 0 011-1h5a1 1 0 110 2h-5a1 1 0 01-1-1z"}),E("path",{"fill-rule":"evenodd",d:"M13 5a1 1 0 011 1v4a1 1 0 11-2 0V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),Pi(" Charger ")])),E("button",{onClick:M,class:"px-3 py-2 text-sm rounded-md border shadow-sm flex items-center justify-center bg-white"},I[19]||(I[19]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[E("path",{"fill-rule":"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})],-1),Pi(" Synthèse ")]))])]),E("div",{class:Bi(["text-sm text-center pt-3 border-t flex items-center justify-center space-x-1 mt-2",{"text-gray-500":!D.saveStatus,"text-primary-600 font-medium":D.saveStatus==="success","text-blue-600 font-medium":D.saveStatus==="saving"}])},[D.saveStatus==="saving"?($e(),qe("svg",bB,I[21]||(I[21]=[E("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),E("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):dn("",!0),D.saveStatus==="success"?($e(),qe("svg",wB,I[22]||(I[22]=[E("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):dn("",!0),hi(Gv,{name:"fade-slide",mode:"out-in"},{default:Gl(()=>[D.saveStatus==="saving"?($e(),qe("span",xB," Sauvegarde en cours... ")):D.saveStatus==="success"?($e(),qe("span",LB," Sauvegarde réussie ! ")):($e(),qe("span",SB," Dernière modification : "+Wt(f.value),1))]),_:1})],2)])])):dn("",!0)])]))}}),EB=Bp(CB,[["__scopeId","data-v-a33ebaa5"]]),PB={class:"comment-thread"},MB={key:0,class:"space-y-3 mb-4"},AB={class:"flex justify-between items-start"},kB={class:"flex items-center"},TB={class:"font-medium text-sm text-gray-900"},NB={class:"flex items-center"},DB={class:"text-xs text-gray-500"},IB=["onClick"],OB={class:"mt-1 text-sm text-gray-700 whitespace-pre-wrap"},BB={key:1,class:"text-center text-sm text-gray-500 italic my-4"},RB={key:2,class:"mt-3"},FB={class:"flex justify-end mt-2"},jB=["disabled"],zB={key:3,class:"text-center text-sm text-gray-500 italic mt-2"},$B=cs({__name:"CommentThread",props:{noteId:{},comments:{}},emits:["update:comments"],setup(e,{emit:t}){const n=e,r=ma(),i=Rp(),s=Uu(),o=Ft(""),u=cr(()=>r.isEntreprise||r.isAdmin);function f(M){return r.user&&M.userId===r.user.id||r.isAdmin}async function d(){var M;if(o.value.trim())try{await i.addComment(n.noteId,o.value.trim()),o.value="",s.success("Commentaire ajouté avec succès")}catch(T){if(console.error("Erreur lors de l'ajout du commentaire:",T),(M=T.response)!=null&&M.data){const D=T.response.data;D.note?s.error(`Erreur: ${D.note[0]}`):D.user?s.error(`Erreur: ${D.user[0]}`):D.text?s.error(`Erreur: ${D.text[0]}`):s.error("Erreur lors de l'ajout du commentaire")}else s.error("Erreur lors de l'ajout du commentaire")}}async function g(M){var T;if(confirm("Voulez-vous vraiment supprimer ce commentaire ?"))try{await i.removeComment(n.noteId,M),s.success("Commentaire supprimé")}catch(D){if(console.error("Erreur lors de la suppression du commentaire:",D),(T=D.response)!=null&&T.data){const I=D.response.data;I.detail?s.error(`Erreur: ${I.detail}`):s.error("Erreur lors de la suppression du commentaire")}else s.error("Erreur lors de la suppression du commentaire")}}function y(M){const T=new Date(M);return new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(T)}function x(M){switch(M){case"admin":return"bg-purple-100 text-purple-800";case"entreprise":return"bg-blue-100 text-blue-800";case"salarie":return"bg-green-100 text-green-800";case"visiteur":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}}function _(M){switch(M){case"admin":return"Admin";case"entreprise":return"Entreprise";case"salarie":return"Salarié";case"visiteur":return"Visiteur";default:return M}}return(M,T)=>($e(),qe("div",PB,[M.comments&&M.comments.length>0?($e(),qe("div",MB,[($e(!0),qe(Bn,null,Er(M.comments,D=>($e(),qe("div",{key:D.id,class:"bg-gray-50 rounded-lg p-3"},[E("div",AB,[E("div",kB,[E("div",TB,Wt(D.userName),1),E("span",{class:Bi(["ml-2 text-xs px-2 py-0.5 rounded-full",x(D.userRole)])},Wt(_(D.userRole)),3)]),E("div",NB,[E("span",DB,Wt(y(D.createdAt)),1),f(D)?($e(),qe("button",{key:0,onClick:I=>g(D.id),class:"ml-2 text-gray-400 hover:text-red-500"},T[1]||(T[1]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,IB)):dn("",!0)])]),E("p",OB,Wt(D.text),1)]))),128))])):($e(),qe("div",BB," Aucun commentaire pour le moment ")),u.value?($e(),qe("div",RB,[Fn(E("textarea",{"onUpdate:modelValue":T[0]||(T[0]=D=>o.value=D),placeholder:"Ajouter un commentaire...",class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:"2"},null,512),[[ri,o.value]]),E("div",FB,[E("button",{onClick:d,disabled:!o.value.trim(),class:"px-3 py-1 text-sm font-medium text-white bg-primary-600 rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed"}," Ajouter ",8,jB)])])):($e(),qe("div",zB," Seuls les utilisateurs de l'entreprise peuvent ajouter des commentaires "))]))}}),UB={class:"photo-gallery"},VB={key:0,class:"grid grid-cols-2 gap-2 mb-4"},GB=["src","alt","onClick"],HB={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-all duration-200 rounded-lg flex items-center justify-center"},qB={class:"opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex space-x-2"},WB=["onClick"],ZB=["onClick"],KB={key:0,class:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white text-xs p-1 truncate rounded-b-lg"},YB={key:1,class:"text-center text-sm text-gray-500 italic my-4"},JB={class:"flex space-x-2 mt-3"},XB={for:"photo-upload",class:"flex-1 flex items-center justify-center px-3 py-2 text-sm font-medium text-white bg-primary-600 rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 cursor-pointer"},QB={key:2,class:"fixed inset-0 z-[3002] flex items-center justify-center p-4 bg-black bg-opacity-75"},eR={class:"relative max-w-3xl max-h-[90vh] bg-white rounded-lg overflow-hidden"},tR=["src","alt"],nR={key:1,class:"p-3 bg-white"},rR={class:"text-sm text-gray-700"},iR={key:3,class:"fixed inset-0 z-[3002] flex items-center justify-center p-4 bg-black bg-opacity-75"},oR={class:"w-full max-w-md bg-white rounded-lg overflow-hidden"},sR={class:"p-4"},aR={class:"p-4 bg-gray-50 flex justify-end space-x-3"},lR={key:4,class:"fixed inset-0 z-[3002] flex items-center justify-center p-4 bg-black bg-opacity-75"},uR={class:"w-full max-w-md bg-white rounded-lg overflow-hidden"},cR={class:"p-4 border-b flex justify-between items-center"},fR={class:"relative"},hR=["src"],dR={class:"p-4 bg-gray-50 flex justify-center"},pR={key:1,class:"flex space-x-3"},gR=cs({__name:"PhotoGallery",props:{noteId:{},photos:{}},emits:["update:photos"],setup(e,{emit:t}){const n=e,r=Rp(),i=Uu(),s=Ft(null),o=Ft(null);let u=null;const f=Ft(!1),d=Ft(!1),g=Ft(!1),y=Ft(null),x=Ft(null),_=Ft(""),M=Ft(null);function T(Q){y.value=Q,f.value=!0}function D(Q){x.value=Q,_.value=Q.caption||"",d.value=!0}function I(){if(x.value)try{r.updatePhoto(n.noteId,x.value.id,_.value),d.value=!1,i.success("Légende mise à jour")}catch(Q){console.error("Erreur lors de la mise à jour de la légende:",Q),i.error("Erreur lors de la mise à jour de la légende")}}function j(Q){if(confirm("Êtes-vous sûr de vouloir supprimer cette photo ?"))try{r.removePhoto(n.noteId,Q),i.success("Photo supprimée")}catch(F){console.error("Erreur lors de la suppression de la photo:",F),i.error("Erreur lors de la suppression de la photo")}}async function Z(Q){const F=Q.target;if(!F.files||F.files.length===0)return;const B=F.files[0];if(!B.type.startsWith("image/")){i.error("Le fichier doit être une image");return}if(B.size>5*1024*1024){i.error("L'image est trop volumineuse (max 5MB)");return}try{const R=await te(B);r.addPhoto(n.noteId,{url:R}),F.value="",i.success("Photo ajoutée")}catch(R){console.error("Erreur lors de l'ajout de la photo:",R),i.error("Erreur lors de l'ajout de la photo")}}function te(Q){return new Promise((F,B)=>{const R=new FileReader;R.onload=()=>F(R.result),R.onerror=B,R.readAsDataURL(Q)})}async function ue(){g.value=!0,M.value=null;try{u=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}}}),s.value&&(s.value.srcObject=u)}catch(Q){console.error("Erreur lors de l'accès à la caméra:",Q),i.error("Impossible d'accéder à la caméra"),g.value=!1}}function le(){if(!s.value||!o.value)return;const Q=s.value,F=o.value;F.width=Q.videoWidth,F.height=Q.videoHeight;const B=F.getContext("2d");B&&(B.drawImage(Q,0,0,F.width,F.height),M.value=F.toDataURL("image/jpeg"))}function ge(){M.value=null}function H(){if(M.value)try{r.addPhoto(n.noteId,{url:M.value}),g.value=!1,U(),i.success("Photo ajoutée")}catch(Q){console.error("Erreur lors de l'ajout de la photo:",Q),i.error("Erreur lors de l'ajout de la photo")}}function U(){u&&(u.getTracks().forEach(Q=>Q.stop()),u=null)}return mc(()=>{U()}),(Q,F)=>($e(),qe("div",UB,[Q.photos&&Q.photos.length>0?($e(),qe("div",VB,[($e(!0),qe(Bn,null,Er(Q.photos,B=>($e(),qe("div",{key:B.id,class:"relative group"},[E("img",{src:B.url,alt:B.caption||"Photo",class:"w-full h-32 object-cover rounded-lg cursor-pointer",onClick:R=>T(B)},null,8,GB),E("div",HB,[E("div",qB,[E("button",{onClick:Sf(R=>D(B),["stop"]),class:"p-1 bg-white rounded-full text-gray-700 hover:text-primary-600",title:"Modifier la légende"},F[4]||(F[4]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,WB),E("button",{onClick:Sf(R=>j(B.id),["stop"]),class:"p-1 bg-white rounded-full text-gray-700 hover:text-red-600",title:"Supprimer la photo"},F[5]||(F[5]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,ZB)])]),B.caption?($e(),qe("div",KB,Wt(B.caption),1)):dn("",!0)]))),128))])):($e(),qe("div",YB," Aucune photo pour le moment ")),E("div",JB,[E("button",{onClick:ue,class:"flex-1 flex items-center justify-center px-3 py-2 text-sm font-medium text-white bg-primary-600 rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2"},F[6]||(F[6]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1),Pi(" Prendre une photo ")])),E("label",XB,[F[7]||(F[7]=E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0l-4 4m4-4v12"})],-1)),F[8]||(F[8]=Pi(" Téléverser ")),E("input",{id:"photo-upload",type:"file",accept:"image/*",class:"hidden",onChange:Z},null,32)])]),f.value?($e(),qe("div",QB,[E("div",eR,[E("button",{onClick:F[0]||(F[0]=B=>f.value=!1),class:"absolute top-2 right-2 z-10 p-1 bg-white rounded-full text-gray-700 hover:text-red-600 shadow-md"},F[9]||(F[9]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),y.value?($e(),qe("img",{key:0,src:y.value.url,alt:y.value.caption||"Photo",class:"max-h-[80vh] max-w-full object-contain"},null,8,tR)):dn("",!0),y.value&&y.value.caption?($e(),qe("div",nR,[E("p",rR,Wt(y.value.caption),1)])):dn("",!0)])])):dn("",!0),d.value?($e(),qe("div",iR,[E("div",oR,[F[10]||(F[10]=E("div",{class:"p-4 border-b"},[E("h3",{class:"text-lg font-medium text-gray-900"},"Modifier la légende")],-1)),E("div",sR,[Fn(E("textarea",{"onUpdate:modelValue":F[1]||(F[1]=B=>_.value=B),placeholder:"Ajouter une légende...",class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:"3"},null,512),[[ri,_.value]])]),E("div",aR,[E("button",{onClick:F[2]||(F[2]=B=>d.value=!1),class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2"}," Annuler "),E("button",{onClick:I,class:"px-4 py-2 text-sm font-medium text-white bg-primary-600 rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2"}," Enregistrer ")])])])):dn("",!0),g.value?($e(),qe("div",lR,[E("div",uR,[E("div",cR,[F[12]||(F[12]=E("h3",{class:"text-lg font-medium text-gray-900"},"Prendre une photo",-1)),E("button",{onClick:F[3]||(F[3]=B=>g.value=!1),class:"text-gray-400 hover:text-gray-500"},F[11]||(F[11]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),E("div",fR,[M.value?($e(),qe("img",{key:1,src:M.value,class:"w-full h-64 object-cover",alt:"Captured"},null,8,hR)):($e(),qe("video",{key:0,ref_key:"videoElement",ref:s,autoplay:"",class:"w-full h-64 object-cover"},null,512)),E("canvas",{ref_key:"canvasElement",ref:o,class:"hidden"},null,512)]),E("div",dR,[M.value?($e(),qe("div",pR,[E("button",{onClick:ge,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2"}," Reprendre "),E("button",{onClick:H,class:"px-4 py-2 text-sm font-medium text-white bg-primary-600 rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2"}," Utiliser ")])):($e(),qe("button",{key:0,onClick:le,class:"px-4 py-2 text-sm font-medium text-white bg-primary-600 rounded-full w-12 h-12 flex items-center justify-center hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2"},F[13]||(F[13]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"})],-1)])))])])])):dn("",!0)]))}}),mR={class:"fixed z-[9999] inset-0 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},vR={class:"flex items-center justify-center min-h-screen w-full"},yR={class:"relative bg-white w-full h-full md:rounded-lg md:max-w-2xl md:h-auto md:max-h-[90vh] md:my-8 shadow-xl transform transition-all overflow-hidden"},_R={class:"p-4 md:p-6 flex-1 overflow-y-auto"},bR={class:"flex justify-between items-center mb-4 border-b pb-4"},wR={class:"text-xl font-semibold text-gray-900"},xR={class:"mb-4 border-b border-gray-200"},LR={class:"flex space-x-4","aria-label":"Tabs"},SR={key:0,class:"ml-1 px-2 py-0.5 text-xs rounded-full bg-primary-100 text-primary-800"},CR={key:0,class:"ml-1 px-2 py-0.5 text-xs rounded-full bg-primary-100 text-primary-800"},ER={key:0},PR={class:"mb-4"},MR={class:"mb-4"},AR={class:"mb-4"},kR=["value"],TR={class:"mb-4"},NR=["value"],DR={class:"mb-4"},IR={class:"mt-1 flex space-x-2"},OR=["onClick"],BR={key:1,class:"mt-4"},RR={key:2,class:"mt-4"},dx=cs({__name:"NoteEditModal",props:{note:{},isNewNote:{type:Boolean},location:{}},emits:["close","save"],setup(e,{emit:t}){const n=e,r=t,i=Rp(),s=Uu(),o=Ft("info"),u=Ft({title:"",description:"",columnId:"",accessLevel:Yi.PRIVATE,style:{color:"#3B82F6",weight:2,opacity:1,fillColor:"#3B82F6",fillOpacity:.6,radius:8},comments:[],photos:[]});function f(D){return Array.isArray(D)?D:typeof D=="object"&&"type"in D&&"coordinates"in D?[D.coordinates[1],D.coordinates[0]]:(console.error("[NoteEditModal] Format de localisation non reconnu:",D),[0,0])}function d(D){if(!D)return new Date().toISOString();try{const I=new Date(D);return isNaN(I.getTime())?(console.warn("[NoteEditModal] Date invalide:",D),new Date().toISOString()):I.toISOString()}catch(I){return console.error("[NoteEditModal] Erreur lors de la création de la date:",I),new Date().toISOString()}}$s(()=>{if(console.log("[NoteEditModal] onMounted - props:",n),n.note){console.log("[NoteEditModal] Édition d'une note existante:",n.note);const D=JSON.parse(JSON.stringify(n.note));D.createdAt=d(D.createdAt),D.updatedAt=d(D.updatedAt),u.value=D}else if(n.isNewNote&&n.location){console.log("[NoteEditModal] Création d'une nouvelle note avec location:",n.location);const D=f(n.location);u.value={title:"Nouvelle note",description:"",location:D,columnId:i.getDefaultColumn.id||"1",accessLevel:Yi.PRIVATE,style:{color:"#3B82F6",weight:2,opacity:1,fillColor:"#3B82F6",fillOpacity:.6,radius:8},comments:[],photos:[],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},console.log("[NoteEditModal] Niveau d'accès initial:",u.value.accessLevel)}else console.error("[NoteEditModal] Erreur: Ni note existante ni nouvelle note avec location");console.log("[NoteEditModal] editingNote.value après initialisation:",u.value)});const g=cr(()=>i.getSortedColumns),y=[{id:Yi.PRIVATE,title:"Privé",description:"Visible uniquement par vous"},{id:Yi.COMPANY,title:"Entreprise",description:"Visible par l'entreprise uniquement"},{id:Yi.EMPLOYEE,title:"Salariés",description:"Visible par l'entreprise et les salariés"},{id:Yi.VISITOR,title:"Visiteurs",description:"Visible par tous"}],x=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#6B7280"];function _(D){var j;u.value.style.color=D,u.value.style.fillColor=D;const I=new CustomEvent("geonote:updateStyle",{detail:{noteId:(j=n.note)==null?void 0:j.id,style:{color:D,fillColor:D}}});window.dispatchEvent(I)}function M(){r("close")}async function T(){var D;try{const I=Array.isArray(u.value.location)?{type:"Point",coordinates:[u.value.location[1],u.value.location[0]]}:u.value.location,j={title:u.value.title,description:u.value.description,location:I,columnId:u.value.columnId,style:u.value.style,access_level:u.value.accessLevel,comments:u.value.comments||[],photos:u.value.photos||[]};console.log("[NoteEditModal] Données de note à sauvegarder:",j),console.log("[NoteEditModal] Niveau d'accès:",u.value.accessLevel);let Z;if((D=n.note)!=null&&D.id)Z=(await pu.updateNote(n.note.id,{...j,access_level:u.value.accessLevel})).data,i.updateNote(n.note.id,{...u.value,...Z,accessLevel:u.value.accessLevel,updatedAt:new Date().toISOString()}),s.success("Note mise à jour avec succès");else{if(Z=(await pu.createNote({...j,access_level:u.value.accessLevel})).data,!Z.id)throw new Error("Le backend n'a pas fourni d'ID pour la nouvelle note");const ue=i.getDefaultColumn,le={...j,id:Z.id,columnId:j.columnId||ue.id,accessLevel:u.value.accessLevel,style:j.style||{color:"#3B82F6",weight:2,opacity:1,fillColor:"#3B82F6",fillOpacity:.2}};console.log("[NoteEditModal] Note à ajouter au store avec ID backend:",Z.id),i.addNote(le),s.success("Note créée avec succès")}r("save",Z),r("close")}catch(I){console.error("[NoteEditModal] Erreur lors de la sauvegarde de la note:",I),s.error("Erreur lors de la sauvegarde de la note")}}return(D,I)=>{var j,Z,te,ue,le;return $e(),qe("div",mR,[E("div",vR,[I[16]||(I[16]=E("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true"},null,-1)),E("div",yR,[E("form",{onSubmit:Sf(T,["prevent"]),class:"h-full md:h-auto flex flex-col"},[E("div",_R,[E("div",bR,[E("h3",wR,Wt((j=D.note)!=null&&j.id?"Modifier la note":"Nouvelle note"),1),E("button",{type:"button",onClick:M,class:"text-gray-400 hover:text-gray-500"},I[7]||(I[7]=[E("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),E("div",xR,[E("nav",LR,[E("button",{type:"button",onClick:I[0]||(I[0]=ge=>o.value="info"),class:Bi(["px-3 py-2 text-sm font-medium border-b-2 focus:outline-none",o.value==="info"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])}," Informations ",2),E("button",{type:"button",onClick:I[1]||(I[1]=ge=>o.value="comments"),class:Bi(["px-3 py-2 text-sm font-medium border-b-2 focus:outline-none",o.value==="comments"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},[I[8]||(I[8]=Pi(" Commentaires ")),(te=(Z=D.note)==null?void 0:Z.comments)!=null&&te.length?($e(),qe("span",SR,Wt(D.note.comments.length),1)):dn("",!0)],2),E("button",{type:"button",onClick:I[2]||(I[2]=ge=>o.value="photos"),class:Bi(["px-3 py-2 text-sm font-medium border-b-2 focus:outline-none",o.value==="photos"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},[I[9]||(I[9]=Pi(" Photos ")),(le=(ue=D.note)==null?void 0:ue.photos)!=null&&le.length?($e(),qe("span",CR,Wt(D.note.photos.length),1)):dn("",!0)],2)])]),o.value==="info"?($e(),qe("div",ER,[E("div",PR,[I[10]||(I[10]=E("label",{for:"title",class:"block text-sm font-medium text-gray-700"},"Titre",-1)),Fn(E("input",{type:"text",id:"title","onUpdate:modelValue":I[3]||(I[3]=ge=>u.value.title=ge),required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},null,512),[[ri,u.value.title]])]),E("div",MR,[I[11]||(I[11]=E("label",{for:"description",class:"block text-sm font-medium text-gray-700"},"Description",-1)),Fn(E("textarea",{id:"description","onUpdate:modelValue":I[4]||(I[4]=ge=>u.value.description=ge),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},null,512),[[ri,u.value.description]])]),E("div",AR,[I[12]||(I[12]=E("label",{for:"column",class:"block text-sm font-medium text-gray-700"},"État",-1)),Fn(E("select",{id:"column","onUpdate:modelValue":I[5]||(I[5]=ge=>u.value.columnId=ge),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},[($e(!0),qe(Bn,null,Er(g.value,ge=>($e(),qe("option",{key:ge.id,value:ge.id},Wt(ge.title),9,kR))),128))],512),[[uo,u.value.columnId]])]),E("div",TR,[I[13]||(I[13]=E("label",{for:"accessLevel",class:"block text-sm font-medium text-gray-700"},"Niveau d'accès",-1)),Fn(E("select",{id:"accessLevel","onUpdate:modelValue":I[6]||(I[6]=ge=>u.value.accessLevel=ge),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},[($e(),qe(Bn,null,Er(y,ge=>E("option",{key:ge.id,value:ge.id},Wt(ge.title)+" - "+Wt(ge.description),9,NR)),64))],512),[[uo,u.value.accessLevel]])]),E("div",DR,[I[14]||(I[14]=E("label",{class:"block text-sm font-medium text-gray-700"},"Couleur",-1)),E("div",IR,[($e(),qe(Bn,null,Er(x,ge=>E("div",{key:ge,class:Bi(["w-8 h-8 rounded-full cursor-pointer border-2",{"border-gray-400":u.value.style.color!==ge,"border-black":u.value.style.color===ge}]),style:ql({backgroundColor:ge}),onClick:H=>_(ge)},null,14,OR)),64))])])])):o.value==="comments"?($e(),qe("div",BR,[D.note?($e(),$a($B,{key:0,noteId:D.note.id,comments:D.note.comments||[]},null,8,["noteId","comments"])):dn("",!0)])):o.value==="photos"?($e(),qe("div",RR,[D.note?($e(),$a(gR,{key:0,noteId:D.note.id,photos:D.note.photos||[]},null,8,["noteId","photos"])):dn("",!0)])):dn("",!0)]),E("div",{class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},[I[15]||(I[15]=E("button",{type:"submit",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-primary-600 text-base font-medium text-white hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:ml-3 sm:w-auto sm:text-sm"}," Enregistrer ",-1)),E("button",{onClick:M,type:"button",class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"}," Annuler ")])],32)])])])}}});(()=>{var Sn,Qn;var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,i=Object.getPrototypeOf,s=Object.prototype.hasOwnProperty,o=(l,h)=>()=>(h||l((h={exports:{}}).exports,h),h.exports),u=(l,h,v,w)=>{if(h&&typeof h=="object"||typeof h=="function")for(let C of r(h))!s.call(l,C)&&C!==v&&t(l,C,{get:()=>h[C],enumerable:!(w=n(h,C))||w.enumerable});return l},f=(l,h,v)=>(v=l!=null?e(i(l)):{},u(h||!l||!l.__esModule?t(v,"default",{value:l,enumerable:!0}):v,l)),d=o((l,h)=>{function v(){this.__data__=[],this.size=0}h.exports=v}),g=o((l,h)=>{function v(w,C){return w===C||w!==w&&C!==C}h.exports=v}),y=o((l,h)=>{var v=g();function w(C,z){for(var X=C.length;X--;)if(v(C[X][0],z))return X;return-1}h.exports=w}),x=o((l,h)=>{var v=y(),w=Array.prototype,C=w.splice;function z(X){var re=this.__data__,he=v(re,X);if(he<0)return!1;var Se=re.length-1;return he==Se?re.pop():C.call(re,he,1),--this.size,!0}h.exports=z}),_=o((l,h)=>{var v=y();function w(C){var z=this.__data__,X=v(z,C);return X<0?void 0:z[X][1]}h.exports=w}),M=o((l,h)=>{var v=y();function w(C){return v(this.__data__,C)>-1}h.exports=w}),T=o((l,h)=>{var v=y();function w(C,z){var X=this.__data__,re=v(X,C);return re<0?(++this.size,X.push([C,z])):X[re][1]=z,this}h.exports=w}),D=o((l,h)=>{var v=d(),w=x(),C=_(),z=M(),X=T();function re(he){var Se=-1,Je=he==null?0:he.length;for(this.clear();++Se<Je;){var ze=he[Se];this.set(ze[0],ze[1])}}re.prototype.clear=v,re.prototype.delete=w,re.prototype.get=C,re.prototype.has=z,re.prototype.set=X,h.exports=re}),I=o((l,h)=>{var v=D();function w(){this.__data__=new v,this.size=0}h.exports=w}),j=o((l,h)=>{function v(w){var C=this.__data__,z=C.delete(w);return this.size=C.size,z}h.exports=v}),Z=o((l,h)=>{function v(w){return this.__data__.get(w)}h.exports=v}),te=o((l,h)=>{function v(w){return this.__data__.has(w)}h.exports=v}),ue=o((l,h)=>{var v=typeof ea=="object"&&ea&&ea.Object===Object&&ea;h.exports=v}),le=o((l,h)=>{var v=ue(),w=typeof self=="object"&&self&&self.Object===Object&&self,C=v||w||Function("return this")();h.exports=C}),ge=o((l,h)=>{var v=le(),w=v.Symbol;h.exports=w}),H=o((l,h)=>{var v=ge(),w=Object.prototype,C=w.hasOwnProperty,z=w.toString,X=v?v.toStringTag:void 0;function re(he){var Se=C.call(he,X),Je=he[X];try{he[X]=void 0;var ze=!0}catch{}var vt=z.call(he);return ze&&(Se?he[X]=Je:delete he[X]),vt}h.exports=re}),U=o((l,h)=>{var v=Object.prototype,w=v.toString;function C(z){return w.call(z)}h.exports=C}),Q=o((l,h)=>{var v=ge(),w=H(),C=U(),z="[object Null]",X="[object Undefined]",re=v?v.toStringTag:void 0;function he(Se){return Se==null?Se===void 0?X:z:re&&re in Object(Se)?w(Se):C(Se)}h.exports=he}),F=o((l,h)=>{function v(w){var C=typeof w;return w!=null&&(C=="object"||C=="function")}h.exports=v}),B=o((l,h)=>{var v=Q(),w=F(),C="[object AsyncFunction]",z="[object Function]",X="[object GeneratorFunction]",re="[object Proxy]";function he(Se){if(!w(Se))return!1;var Je=v(Se);return Je==z||Je==X||Je==C||Je==re}h.exports=he}),R=o((l,h)=>{var v=le(),w=v["__core-js_shared__"];h.exports=w}),$=o((l,h)=>{var v=R(),w=function(){var z=/[^.]+$/.exec(v&&v.keys&&v.keys.IE_PROTO||"");return z?"Symbol(src)_1."+z:""}();function C(z){return!!w&&w in z}h.exports=C}),W=o((l,h)=>{var v=Function.prototype,w=v.toString;function C(z){if(z!=null){try{return w.call(z)}catch{}try{return z+""}catch{}}return""}h.exports=C}),G=o((l,h)=>{var v=B(),w=$(),C=F(),z=W(),X=/[\\^$.*+?()[\]{}|]/g,re=/^\[object .+?Constructor\]$/,he=Function.prototype,Se=Object.prototype,Je=he.toString,ze=Se.hasOwnProperty,vt=RegExp("^"+Je.call(ze).replace(X,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function kt(Xt){if(!C(Xt)||w(Xt))return!1;var yn=v(Xt)?vt:re;return yn.test(z(Xt))}h.exports=kt}),J=o((l,h)=>{function v(w,C){return w==null?void 0:w[C]}h.exports=v}),Y=o((l,h)=>{var v=G(),w=J();function C(z,X){var re=w(z,X);return v(re)?re:void 0}h.exports=C}),pe=o((l,h)=>{var v=Y(),w=le(),C=v(w,"Map");h.exports=C}),Le=o((l,h)=>{var v=Y(),w=v(Object,"create");h.exports=w}),De=o((l,h)=>{var v=Le();function w(){this.__data__=v?v(null):{},this.size=0}h.exports=w}),N=o((l,h)=>{function v(w){var C=this.has(w)&&delete this.__data__[w];return this.size-=C?1:0,C}h.exports=v}),ee=o((l,h)=>{var v=Le(),w="__lodash_hash_undefined__",C=Object.prototype,z=C.hasOwnProperty;function X(re){var he=this.__data__;if(v){var Se=he[re];return Se===w?void 0:Se}return z.call(he,re)?he[re]:void 0}h.exports=X}),fe=o((l,h)=>{var v=Le(),w=Object.prototype,C=w.hasOwnProperty;function z(X){var re=this.__data__;return v?re[X]!==void 0:C.call(re,X)}h.exports=z}),ce=o((l,h)=>{var v=Le(),w="__lodash_hash_undefined__";function C(z,X){var re=this.__data__;return this.size+=this.has(z)?0:1,re[z]=v&&X===void 0?w:X,this}h.exports=C}),_e=o((l,h)=>{var v=De(),w=N(),C=ee(),z=fe(),X=ce();function re(he){var Se=-1,Je=he==null?0:he.length;for(this.clear();++Se<Je;){var ze=he[Se];this.set(ze[0],ze[1])}}re.prototype.clear=v,re.prototype.delete=w,re.prototype.get=C,re.prototype.has=z,re.prototype.set=X,h.exports=re}),se=o((l,h)=>{var v=_e(),w=D(),C=pe();function z(){this.size=0,this.__data__={hash:new v,map:new(C||w),string:new v}}h.exports=z}),k=o((l,h)=>{function v(w){var C=typeof w;return C=="string"||C=="number"||C=="symbol"||C=="boolean"?w!=="__proto__":w===null}h.exports=v}),ae=o((l,h)=>{var v=k();function w(C,z){var X=C.__data__;return v(z)?X[typeof z=="string"?"string":"hash"]:X.map}h.exports=w}),ke=o((l,h)=>{var v=ae();function w(C){var z=v(this,C).delete(C);return this.size-=z?1:0,z}h.exports=w}),Pe=o((l,h)=>{var v=ae();function w(C){return v(this,C).get(C)}h.exports=w}),Ge=o((l,h)=>{var v=ae();function w(C){return v(this,C).has(C)}h.exports=w}),K=o((l,h)=>{var v=ae();function w(C,z){var X=v(this,C),re=X.size;return X.set(C,z),this.size+=X.size==re?0:1,this}h.exports=w}),de=o((l,h)=>{var v=se(),w=ke(),C=Pe(),z=Ge(),X=K();function re(he){var Se=-1,Je=he==null?0:he.length;for(this.clear();++Se<Je;){var ze=he[Se];this.set(ze[0],ze[1])}}re.prototype.clear=v,re.prototype.delete=w,re.prototype.get=C,re.prototype.has=z,re.prototype.set=X,h.exports=re}),ye=o((l,h)=>{var v=D(),w=pe(),C=de(),z=200;function X(re,he){var Se=this.__data__;if(Se instanceof v){var Je=Se.__data__;if(!w||Je.length<z-1)return Je.push([re,he]),this.size=++Se.size,this;Se=this.__data__=new C(Je)}return Se.set(re,he),this.size=Se.size,this}h.exports=X}),me=o((l,h)=>{var v=D(),w=I(),C=j(),z=Z(),X=te(),re=ye();function he(Se){var Je=this.__data__=new v(Se);this.size=Je.size}he.prototype.clear=w,he.prototype.delete=C,he.prototype.get=z,he.prototype.has=X,he.prototype.set=re,h.exports=he}),Ue=o((l,h)=>{var v=Y(),w=function(){try{var C=v(Object,"defineProperty");return C({},"",{}),C}catch{}}();h.exports=w}),Qe=o((l,h)=>{var v=Ue();function w(C,z,X){z=="__proto__"&&v?v(C,z,{configurable:!0,enumerable:!0,value:X,writable:!0}):C[z]=X}h.exports=w}),Ze=o((l,h)=>{var v=Qe(),w=g();function C(z,X,re){(re!==void 0&&!w(z[X],re)||re===void 0&&!(X in z))&&v(z,X,re)}h.exports=C}),He=o((l,h)=>{function v(w){return function(C,z,X){for(var re=-1,he=Object(C),Se=X(C),Je=Se.length;Je--;){var ze=Se[w?Je:++re];if(z(he[ze],ze,he)===!1)break}return C}}h.exports=v}),Xe=o((l,h)=>{var v=He(),w=v();h.exports=w}),tt=o((l,h)=>{var v=le(),w=typeof l=="object"&&l&&!l.nodeType&&l,C=w&&typeof h=="object"&&h&&!h.nodeType&&h,z=C&&C.exports===w,X=z?v.Buffer:void 0,re=X?X.allocUnsafe:void 0;function he(Se,Je){if(Je)return Se.slice();var ze=Se.length,vt=re?re(ze):new Se.constructor(ze);return Se.copy(vt),vt}h.exports=he}),Mt=o((l,h)=>{var v=le(),w=v.Uint8Array;h.exports=w}),Lt=o((l,h)=>{var v=Mt();function w(C){var z=new C.constructor(C.byteLength);return new v(z).set(new v(C)),z}h.exports=w}),jt=o((l,h)=>{var v=Lt();function w(C,z){var X=z?v(C.buffer):C.buffer;return new C.constructor(X,C.byteOffset,C.length)}h.exports=w}),zt=o((l,h)=>{function v(w,C){var z=-1,X=w.length;for(C||(C=Array(X));++z<X;)C[z]=w[z];return C}h.exports=v}),sn=o((l,h)=>{var v=F(),w=Object.create,C=function(){function z(){}return function(X){if(!v(X))return{};if(w)return w(X);z.prototype=X;var re=new z;return z.prototype=void 0,re}}();h.exports=C}),pn=o((l,h)=>{function v(w,C){return function(z){return w(C(z))}}h.exports=v}),et=o((l,h)=>{var v=pn(),w=v(Object.getPrototypeOf,Object);h.exports=w}),ot=o((l,h)=>{var v=Object.prototype;function w(C){var z=C&&C.constructor,X=typeof z=="function"&&z.prototype||v;return C===X}h.exports=w}),rt=o((l,h)=>{var v=sn(),w=et(),C=ot();function z(X){return typeof X.constructor=="function"&&!C(X)?v(w(X)):{}}h.exports=z}),Ht=o((l,h)=>{function v(w){return w!=null&&typeof w=="object"}h.exports=v}),Qt=o((l,h)=>{var v=Q(),w=Ht(),C="[object Arguments]";function z(X){return w(X)&&v(X)==C}h.exports=z}),On=o((l,h)=>{var v=Qt(),w=Ht(),C=Object.prototype,z=C.hasOwnProperty,X=C.propertyIsEnumerable,re=v(function(){return arguments}())?v:function(he){return w(he)&&z.call(he,"callee")&&!X.call(he,"callee")};h.exports=re}),wn=o((l,h)=>{var v=Array.isArray;h.exports=v}),Tn=o((l,h)=>{var v=9007199254740991;function w(C){return typeof C=="number"&&C>-1&&C%1==0&&C<=v}h.exports=w}),ar=o((l,h)=>{var v=B(),w=Tn();function C(z){return z!=null&&w(z.length)&&!v(z)}h.exports=C}),xn=o((l,h)=>{var v=ar(),w=Ht();function C(z){return w(z)&&v(z)}h.exports=C}),Mn=o((l,h)=>{function v(){return!1}h.exports=v}),Pn=o((l,h)=>{var v=le(),w=Mn(),C=typeof l=="object"&&l&&!l.nodeType&&l,z=C&&typeof h=="object"&&h&&!h.nodeType&&h,X=z&&z.exports===C,re=X?v.Buffer:void 0,he=re?re.isBuffer:void 0,Se=he||w;h.exports=Se}),fr=o((l,h)=>{var v=Q(),w=et(),C=Ht(),z="[object Object]",X=Function.prototype,re=Object.prototype,he=X.toString,Se=re.hasOwnProperty,Je=he.call(Object);function ze(vt){if(!C(vt)||v(vt)!=z)return!1;var kt=w(vt);if(kt===null)return!0;var Xt=Se.call(kt,"constructor")&&kt.constructor;return typeof Xt=="function"&&Xt instanceof Xt&&he.call(Xt)==Je}h.exports=ze}),yr=o((l,h)=>{var v=Q(),w=Tn(),C=Ht(),z="[object Arguments]",X="[object Array]",re="[object Boolean]",he="[object Date]",Se="[object Error]",Je="[object Function]",ze="[object Map]",vt="[object Number]",kt="[object Object]",Xt="[object RegExp]",yn="[object Set]",bn="[object String]",ur="[object WeakMap]",Ye="[object ArrayBuffer]",nt="[object DataView]",ht="[object Float32Array]",Ot="[object Float64Array]",bt="[object Int8Array]",Tt="[object Int16Array]",ve="[object Int32Array]",Me="[object Uint8Array]",Be="[object Uint8ClampedArray]",Oe="[object Uint16Array]",Fe="[object Uint32Array]",je={};je[ht]=je[Ot]=je[bt]=je[Tt]=je[ve]=je[Me]=je[Be]=je[Oe]=je[Fe]=!0,je[z]=je[X]=je[Ye]=je[re]=je[nt]=je[he]=je[Se]=je[Je]=je[ze]=je[vt]=je[kt]=je[Xt]=je[yn]=je[bn]=je[ur]=!1;function ut(ct){return C(ct)&&w(ct.length)&&!!je[v(ct)]}h.exports=ut}),at=o((l,h)=>{function v(w){return function(C){return w(C)}}h.exports=v}),We=o((l,h)=>{var v=ue(),w=typeof l=="object"&&l&&!l.nodeType&&l,C=w&&typeof h=="object"&&h&&!h.nodeType&&h,z=C&&C.exports===w,X=z&&v.process,re=function(){try{var he=C&&C.require&&C.require("util").types;return he||X&&X.binding&&X.binding("util")}catch{}}();h.exports=re}),It=o((l,h)=>{var v=yr(),w=at(),C=We(),z=C&&C.isTypedArray,X=z?w(z):v;h.exports=X}),En=o((l,h)=>{function v(w,C){if(!(C==="constructor"&&typeof w[C]=="function")&&C!="__proto__")return w[C]}h.exports=v}),Jn=o((l,h)=>{var v=Qe(),w=g(),C=Object.prototype,z=C.hasOwnProperty;function X(re,he,Se){var Je=re[he];(!(z.call(re,he)&&w(Je,Se))||Se===void 0&&!(he in re))&&v(re,he,Se)}h.exports=X}),Zn=o((l,h)=>{var v=Jn(),w=Qe();function C(z,X,re,he){var Se=!re;re||(re={});for(var Je=-1,ze=X.length;++Je<ze;){var vt=X[Je],kt=he?he(re[vt],z[vt],vt,re,z):void 0;kt===void 0&&(kt=z[vt]),Se?w(re,vt,kt):v(re,vt,kt)}return re}h.exports=C}),qt=o((l,h)=>{function v(w,C){for(var z=-1,X=Array(w);++z<w;)X[z]=C(z);return X}h.exports=v}),mn=o((l,h)=>{var v=9007199254740991,w=/^(?:0|[1-9]\d*)$/;function C(z,X){var re=typeof z;return X=X??v,!!X&&(re=="number"||re!="symbol"&&w.test(z))&&z>-1&&z%1==0&&z<X}h.exports=C}),Bt=o((l,h)=>{var v=qt(),w=On(),C=wn(),z=Pn(),X=mn(),re=It(),he=Object.prototype,Se=he.hasOwnProperty;function Je(ze,vt){var kt=C(ze),Xt=!kt&&w(ze),yn=!kt&&!Xt&&z(ze),bn=!kt&&!Xt&&!yn&&re(ze),ur=kt||Xt||yn||bn,Ye=ur?v(ze.length,String):[],nt=Ye.length;for(var ht in ze)(vt||Se.call(ze,ht))&&!(ur&&(ht=="length"||yn&&(ht=="offset"||ht=="parent")||bn&&(ht=="buffer"||ht=="byteLength"||ht=="byteOffset")||X(ht,nt)))&&Ye.push(ht);return Ye}h.exports=Je}),Kt=o((l,h)=>{function v(w){var C=[];if(w!=null)for(var z in Object(w))C.push(z);return C}h.exports=v}),Ln=o((l,h)=>{var v=F(),w=ot(),C=Kt(),z=Object.prototype,X=z.hasOwnProperty;function re(he){if(!v(he))return C(he);var Se=w(he),Je=[];for(var ze in he)ze=="constructor"&&(Se||!X.call(he,ze))||Je.push(ze);return Je}h.exports=re}),mr=o((l,h)=>{var v=Bt(),w=Ln(),C=ar();function z(X){return C(X)?v(X,!0):w(X)}h.exports=z}),lt=o((l,h)=>{var v=Zn(),w=mr();function C(z){return v(z,w(z))}h.exports=C}),Cn=o((l,h)=>{var v=Ze(),w=tt(),C=jt(),z=zt(),X=rt(),re=On(),he=wn(),Se=xn(),Je=Pn(),ze=B(),vt=F(),kt=fr(),Xt=It(),yn=En(),bn=lt();function ur(Ye,nt,ht,Ot,bt,Tt,ve){var Me=yn(Ye,ht),Be=yn(nt,ht),Oe=ve.get(Be);if(Oe){v(Ye,ht,Oe);return}var Fe=Tt?Tt(Me,Be,ht+"",Ye,nt,ve):void 0,je=Fe===void 0;if(je){var ut=he(Be),ct=!ut&&Je(Be),gt=!ut&&!ct&&Xt(Be);Fe=Be,ut||ct||gt?he(Me)?Fe=Me:Se(Me)?Fe=z(Me):ct?(je=!1,Fe=w(Be,!0)):gt?(je=!1,Fe=C(Be,!0)):Fe=[]:kt(Be)||re(Be)?(Fe=Me,re(Me)?Fe=bn(Me):(!vt(Me)||ze(Me))&&(Fe=X(Be))):je=!1}je&&(ve.set(Be,Fe),bt(Fe,Be,Ot,Tt,ve),ve.delete(Be)),v(Ye,ht,Fe)}h.exports=ur}),xr=o((l,h)=>{var v=me(),w=Ze(),C=Xe(),z=Cn(),X=F(),re=mr(),he=En();function Se(Je,ze,vt,kt,Xt){Je!==ze&&C(ze,function(yn,bn){if(Xt||(Xt=new v),X(yn))z(Je,ze,bn,vt,Se,kt,Xt);else{var ur=kt?kt(he(Je,bn),yn,bn+"",Je,ze,Xt):void 0;ur===void 0&&(ur=yn),w(Je,bn,ur)}},re)}h.exports=Se}),Ii=o((l,h)=>{function v(w){return w}h.exports=v}),Fr=o((l,h)=>{function v(w,C,z){switch(z.length){case 0:return w.call(C);case 1:return w.call(C,z[0]);case 2:return w.call(C,z[0],z[1]);case 3:return w.call(C,z[0],z[1],z[2])}return w.apply(C,z)}h.exports=v}),Pr=o((l,h)=>{var v=Fr(),w=Math.max;function C(z,X,re){return X=w(X===void 0?z.length-1:X,0),function(){for(var he=arguments,Se=-1,Je=w(he.length-X,0),ze=Array(Je);++Se<Je;)ze[Se]=he[X+Se];Se=-1;for(var vt=Array(X+1);++Se<X;)vt[Se]=he[Se];return vt[X]=re(ze),v(z,this,vt)}}h.exports=C}),lr=o((l,h)=>{function v(w){return function(){return w}}h.exports=v}),Hr=o((l,h)=>{var v=lr(),w=Ue(),C=Ii(),z=w?function(X,re){return w(X,"toString",{configurable:!0,enumerable:!1,value:v(re),writable:!0})}:C;h.exports=z}),ir=o((l,h)=>{var v=800,w=16,C=Date.now;function z(X){var re=0,he=0;return function(){var Se=C(),Je=w-(Se-he);if(he=Se,Je>0){if(++re>=v)return arguments[0]}else re=0;return X.apply(void 0,arguments)}}h.exports=z}),Or=o((l,h)=>{var v=Hr(),w=ir(),C=w(v);h.exports=C}),jr=o((l,h)=>{var v=Ii(),w=Pr(),C=Or();function z(X,re){return C(w(X,re,v),X+"")}h.exports=z}),rn=o((l,h)=>{var v=g(),w=ar(),C=mn(),z=F();function X(re,he,Se){if(!z(Se))return!1;var Je=typeof he;return(Je=="number"?w(Se)&&C(he,Se.length):Je=="string"&&he in Se)?v(Se[he],re):!1}h.exports=X}),ji=o((l,h)=>{var v=jr(),w=rn();function C(z){return v(function(X,re){var he=-1,Se=re.length,Je=Se>1?re[Se-1]:void 0,ze=Se>2?re[2]:void 0;for(Je=z.length>3&&typeof Je=="function"?(Se--,Je):void 0,ze&&w(re[0],re[1],ze)&&(Je=Se<3?void 0:Je,Se=1),X=Object(X);++he<Se;){var vt=re[he];vt&&z(X,vt,he,Je)}return X})}h.exports=C}),_i=o((l,h)=>{var v=xr(),w=ji(),C=w(function(z,X,re){v(z,X,re)});h.exports=C}),gi=o((l,h)=>{var v=Q(),w=Ht(),C="[object Symbol]";function z(X){return typeof X=="symbol"||w(X)&&v(X)==C}h.exports=z}),Kr=o((l,h)=>{var v=wn(),w=gi(),C=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,z=/^\w*$/;function X(re,he){if(v(re))return!1;var Se=typeof re;return Se=="number"||Se=="symbol"||Se=="boolean"||re==null||w(re)?!0:z.test(re)||!C.test(re)||he!=null&&re in Object(he)}h.exports=X}),Br=o((l,h)=>{var v=de(),w="Expected a function";function C(z,X){if(typeof z!="function"||X!=null&&typeof X!="function")throw new TypeError(w);var re=function(){var he=arguments,Se=X?X.apply(this,he):he[0],Je=re.cache;if(Je.has(Se))return Je.get(Se);var ze=z.apply(this,he);return re.cache=Je.set(Se,ze)||Je,ze};return re.cache=new(C.Cache||v),re}C.Cache=v,h.exports=C}),Rr=o((l,h)=>{var v=Br(),w=500;function C(z){var X=v(z,function(he){return re.size===w&&re.clear(),he}),re=X.cache;return X}h.exports=C}),dr=o((l,h)=>{var v=Rr(),w=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,C=/\\(\\)?/g,z=v(function(X){var re=[];return X.charCodeAt(0)===46&&re.push(""),X.replace(w,function(he,Se,Je,ze){re.push(Je?ze.replace(C,"$1"):Se||he)}),re});h.exports=z}),zi=o((l,h)=>{function v(w,C){for(var z=-1,X=w==null?0:w.length,re=Array(X);++z<X;)re[z]=C(w[z],z,w);return re}h.exports=v}),Ss=o((l,h)=>{var v=ge(),w=zi(),C=wn(),z=gi(),X=v?v.prototype:void 0,re=X?X.toString:void 0;function he(Se){if(typeof Se=="string")return Se;if(C(Se))return w(Se,he)+"";if(z(Se))return re?re.call(Se):"";var Je=Se+"";return Je=="0"&&1/Se==-1/0?"-0":Je}h.exports=he}),Cs=o((l,h)=>{var v=Ss();function w(C){return C==null?"":v(C)}h.exports=w}),si=o((l,h)=>{var v=wn(),w=Kr(),C=dr(),z=Cs();function X(re,he){return v(re)?re:w(re,he)?[re]:C(z(re))}h.exports=X}),jn=o((l,h)=>{var v=gi();function w(C){if(typeof C=="string"||v(C))return C;var z=C+"";return z=="0"&&1/C==-1/0?"-0":z}h.exports=w}),Po=o((l,h)=>{var v=si(),w=jn();function C(z,X){X=v(X,z);for(var re=0,he=X.length;z!=null&&re<he;)z=z[w(X[re++])];return re&&re==he?z:void 0}h.exports=C}),ci=o((l,h)=>{var v=Po();function w(C,z,X){var re=C==null?void 0:v(C,z);return re===void 0?X:re}h.exports=w}),hr=o((l,h)=>{(function(v,w){typeof l=="object"&&typeof h<"u"?h.exports=w():(v=v||self).RBush=w()})(l,function(){function v(Ye,nt,ht,Ot,bt){(function Tt(ve,Me,Be,Oe,Fe){for(;Oe>Be;){if(Oe-Be>600){var je=Oe-Be+1,ut=Me-Be+1,ct=Math.log(je),gt=.5*Math.exp(2*ct/3),St=.5*Math.sqrt(ct*gt*(je-gt)/je)*(ut-je/2<0?-1:1),Ct=Math.max(Be,Math.floor(Me-ut*gt/je+St)),on=Math.min(Oe,Math.floor(Me+(je-ut)*gt/je+St));Tt(ve,Me,Ct,on,Fe)}var $n=ve[Me],Hn=Be,er=Oe;for(w(ve,Be,Me),Fe(ve[Oe],$n)>0&&w(ve,Be,Oe);Hn<er;){for(w(ve,Hn,er),Hn++,er--;Fe(ve[Hn],$n)<0;)Hn++;for(;Fe(ve[er],$n)>0;)er--}Fe(ve[Be],$n)===0?w(ve,Be,er):w(ve,++er,Oe),er<=Me&&(Be=er+1),Me<=er&&(Oe=er-1)}})(Ye,nt,ht||0,Ot||Ye.length-1,bt||C)}function w(Ye,nt,ht){var Ot=Ye[nt];Ye[nt]=Ye[ht],Ye[ht]=Ot}function C(Ye,nt){return Ye<nt?-1:Ye>nt?1:0}var z=function(Ye){Ye===void 0&&(Ye=9),this._maxEntries=Math.max(4,Ye),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function X(Ye,nt,ht){if(!ht)return nt.indexOf(Ye);for(var Ot=0;Ot<nt.length;Ot++)if(ht(Ye,nt[Ot]))return Ot;return-1}function re(Ye,nt){he(Ye,0,Ye.children.length,nt,Ye)}function he(Ye,nt,ht,Ot,bt){bt||(bt=bn(null)),bt.minX=1/0,bt.minY=1/0,bt.maxX=-1/0,bt.maxY=-1/0;for(var Tt=nt;Tt<ht;Tt++){var ve=Ye.children[Tt];Se(bt,Ye.leaf?Ot(ve):ve)}return bt}function Se(Ye,nt){return Ye.minX=Math.min(Ye.minX,nt.minX),Ye.minY=Math.min(Ye.minY,nt.minY),Ye.maxX=Math.max(Ye.maxX,nt.maxX),Ye.maxY=Math.max(Ye.maxY,nt.maxY),Ye}function Je(Ye,nt){return Ye.minX-nt.minX}function ze(Ye,nt){return Ye.minY-nt.minY}function vt(Ye){return(Ye.maxX-Ye.minX)*(Ye.maxY-Ye.minY)}function kt(Ye){return Ye.maxX-Ye.minX+(Ye.maxY-Ye.minY)}function Xt(Ye,nt){return Ye.minX<=nt.minX&&Ye.minY<=nt.minY&&nt.maxX<=Ye.maxX&&nt.maxY<=Ye.maxY}function yn(Ye,nt){return nt.minX<=Ye.maxX&&nt.minY<=Ye.maxY&&nt.maxX>=Ye.minX&&nt.maxY>=Ye.minY}function bn(Ye){return{children:Ye,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ur(Ye,nt,ht,Ot,bt){for(var Tt=[nt,ht];Tt.length;)if(!((ht=Tt.pop())-(nt=Tt.pop())<=Ot)){var ve=nt+Math.ceil((ht-nt)/Ot/2)*Ot;v(Ye,ve,nt,ht,bt),Tt.push(nt,ve,ve,ht)}}return z.prototype.all=function(){return this._all(this.data,[])},z.prototype.search=function(Ye){var nt=this.data,ht=[];if(!yn(Ye,nt))return ht;for(var Ot=this.toBBox,bt=[];nt;){for(var Tt=0;Tt<nt.children.length;Tt++){var ve=nt.children[Tt],Me=nt.leaf?Ot(ve):ve;yn(Ye,Me)&&(nt.leaf?ht.push(ve):Xt(Ye,Me)?this._all(ve,ht):bt.push(ve))}nt=bt.pop()}return ht},z.prototype.collides=function(Ye){var nt=this.data;if(!yn(Ye,nt))return!1;for(var ht=[];nt;){for(var Ot=0;Ot<nt.children.length;Ot++){var bt=nt.children[Ot],Tt=nt.leaf?this.toBBox(bt):bt;if(yn(Ye,Tt)){if(nt.leaf||Xt(Ye,Tt))return!0;ht.push(bt)}}nt=ht.pop()}return!1},z.prototype.load=function(Ye){if(!Ye||!Ye.length)return this;if(Ye.length<this._minEntries){for(var nt=0;nt<Ye.length;nt++)this.insert(Ye[nt]);return this}var ht=this._build(Ye.slice(),0,Ye.length-1,0);if(this.data.children.length)if(this.data.height===ht.height)this._splitRoot(this.data,ht);else{if(this.data.height<ht.height){var Ot=this.data;this.data=ht,ht=Ot}this._insert(ht,this.data.height-ht.height-1,!0)}else this.data=ht;return this},z.prototype.insert=function(Ye){return Ye&&this._insert(Ye,this.data.height-1),this},z.prototype.clear=function(){return this.data=bn([]),this},z.prototype.remove=function(Ye,nt){if(!Ye)return this;for(var ht,Ot,bt,Tt=this.data,ve=this.toBBox(Ye),Me=[],Be=[];Tt||Me.length;){if(Tt||(Tt=Me.pop(),Ot=Me[Me.length-1],ht=Be.pop(),bt=!0),Tt.leaf){var Oe=X(Ye,Tt.children,nt);if(Oe!==-1)return Tt.children.splice(Oe,1),Me.push(Tt),this._condense(Me),this}bt||Tt.leaf||!Xt(Tt,ve)?Ot?(ht++,Tt=Ot.children[ht],bt=!1):Tt=null:(Me.push(Tt),Be.push(ht),ht=0,Ot=Tt,Tt=Tt.children[0])}return this},z.prototype.toBBox=function(Ye){return Ye},z.prototype.compareMinX=function(Ye,nt){return Ye.minX-nt.minX},z.prototype.compareMinY=function(Ye,nt){return Ye.minY-nt.minY},z.prototype.toJSON=function(){return this.data},z.prototype.fromJSON=function(Ye){return this.data=Ye,this},z.prototype._all=function(Ye,nt){for(var ht=[];Ye;)Ye.leaf?nt.push.apply(nt,Ye.children):ht.push.apply(ht,Ye.children),Ye=ht.pop();return nt},z.prototype._build=function(Ye,nt,ht,Ot){var bt,Tt=ht-nt+1,ve=this._maxEntries;if(Tt<=ve)return re(bt=bn(Ye.slice(nt,ht+1)),this.toBBox),bt;Ot||(Ot=Math.ceil(Math.log(Tt)/Math.log(ve)),ve=Math.ceil(Tt/Math.pow(ve,Ot-1))),(bt=bn([])).leaf=!1,bt.height=Ot;var Me=Math.ceil(Tt/ve),Be=Me*Math.ceil(Math.sqrt(ve));ur(Ye,nt,ht,Be,this.compareMinX);for(var Oe=nt;Oe<=ht;Oe+=Be){var Fe=Math.min(Oe+Be-1,ht);ur(Ye,Oe,Fe,Me,this.compareMinY);for(var je=Oe;je<=Fe;je+=Me){var ut=Math.min(je+Me-1,Fe);bt.children.push(this._build(Ye,je,ut,Ot-1))}}return re(bt,this.toBBox),bt},z.prototype._chooseSubtree=function(Ye,nt,ht,Ot){for(;Ot.push(nt),!nt.leaf&&Ot.length-1!==ht;){for(var bt=1/0,Tt=1/0,ve=void 0,Me=0;Me<nt.children.length;Me++){var Be=nt.children[Me],Oe=vt(Be),Fe=(je=Ye,ut=Be,(Math.max(ut.maxX,je.maxX)-Math.min(ut.minX,je.minX))*(Math.max(ut.maxY,je.maxY)-Math.min(ut.minY,je.minY))-Oe);Fe<Tt?(Tt=Fe,bt=Oe<bt?Oe:bt,ve=Be):Fe===Tt&&Oe<bt&&(bt=Oe,ve=Be)}nt=ve||nt.children[0]}var je,ut;return nt},z.prototype._insert=function(Ye,nt,ht){var Ot=ht?Ye:this.toBBox(Ye),bt=[],Tt=this._chooseSubtree(Ot,this.data,nt,bt);for(Tt.children.push(Ye),Se(Tt,Ot);nt>=0&&bt[nt].children.length>this._maxEntries;)this._split(bt,nt),nt--;this._adjustParentBBoxes(Ot,bt,nt)},z.prototype._split=function(Ye,nt){var ht=Ye[nt],Ot=ht.children.length,bt=this._minEntries;this._chooseSplitAxis(ht,bt,Ot);var Tt=this._chooseSplitIndex(ht,bt,Ot),ve=bn(ht.children.splice(Tt,ht.children.length-Tt));ve.height=ht.height,ve.leaf=ht.leaf,re(ht,this.toBBox),re(ve,this.toBBox),nt?Ye[nt-1].children.push(ve):this._splitRoot(ht,ve)},z.prototype._splitRoot=function(Ye,nt){this.data=bn([Ye,nt]),this.data.height=Ye.height+1,this.data.leaf=!1,re(this.data,this.toBBox)},z.prototype._chooseSplitIndex=function(Ye,nt,ht){for(var Ot,bt,Tt,ve,Me,Be,Oe,Fe=1/0,je=1/0,ut=nt;ut<=ht-nt;ut++){var ct=he(Ye,0,ut,this.toBBox),gt=he(Ye,ut,ht,this.toBBox),St=(bt=ct,Tt=gt,ve=void 0,Me=void 0,Be=void 0,Oe=void 0,ve=Math.max(bt.minX,Tt.minX),Me=Math.max(bt.minY,Tt.minY),Be=Math.min(bt.maxX,Tt.maxX),Oe=Math.min(bt.maxY,Tt.maxY),Math.max(0,Be-ve)*Math.max(0,Oe-Me)),Ct=vt(ct)+vt(gt);St<Fe?(Fe=St,Ot=ut,je=Ct<je?Ct:je):St===Fe&&Ct<je&&(je=Ct,Ot=ut)}return Ot||ht-nt},z.prototype._chooseSplitAxis=function(Ye,nt,ht){var Ot=Ye.leaf?this.compareMinX:Je,bt=Ye.leaf?this.compareMinY:ze;this._allDistMargin(Ye,nt,ht,Ot)<this._allDistMargin(Ye,nt,ht,bt)&&Ye.children.sort(Ot)},z.prototype._allDistMargin=function(Ye,nt,ht,Ot){Ye.children.sort(Ot);for(var bt=this.toBBox,Tt=he(Ye,0,nt,bt),ve=he(Ye,ht-nt,ht,bt),Me=kt(Tt)+kt(ve),Be=nt;Be<ht-nt;Be++){var Oe=Ye.children[Be];Se(Tt,Ye.leaf?bt(Oe):Oe),Me+=kt(Tt)}for(var Fe=ht-nt-1;Fe>=nt;Fe--){var je=Ye.children[Fe];Se(ve,Ye.leaf?bt(je):je),Me+=kt(ve)}return Me},z.prototype._adjustParentBBoxes=function(Ye,nt,ht){for(var Ot=ht;Ot>=0;Ot--)Se(nt[Ot],Ye)},z.prototype._condense=function(Ye){for(var nt=Ye.length-1,ht=void 0;nt>=0;nt--)Ye[nt].children.length===0?nt>0?(ht=Ye[nt-1].children).splice(ht.indexOf(Ye[nt]),1):this.clear():re(Ye[nt],this.toBBox)},z})}),qn=o(l=>{Object.defineProperty(l,"__esModule",{value:!0}),l.earthRadius=63710088e-1,l.factors={centimeters:l.earthRadius*100,centimetres:l.earthRadius*100,degrees:l.earthRadius/111325,feet:l.earthRadius*3.28084,inches:l.earthRadius*39.37,kilometers:l.earthRadius/1e3,kilometres:l.earthRadius/1e3,meters:l.earthRadius,metres:l.earthRadius,miles:l.earthRadius/1609.344,millimeters:l.earthRadius*1e3,millimetres:l.earthRadius*1e3,nauticalmiles:l.earthRadius/1852,radians:1,yards:l.earthRadius*1.0936},l.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/l.earthRadius,yards:1.0936133},l.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function h(Oe,Fe,je){je===void 0&&(je={});var ut={type:"Feature"};return(je.id===0||je.id)&&(ut.id=je.id),je.bbox&&(ut.bbox=je.bbox),ut.properties=Fe||{},ut.geometry=Oe,ut}l.feature=h;function v(Oe,Fe,je){switch(Oe){case"Point":return w(Fe).geometry;case"LineString":return re(Fe).geometry;case"Polygon":return z(Fe).geometry;case"MultiPoint":return ze(Fe).geometry;case"MultiLineString":return Je(Fe).geometry;case"MultiPolygon":return vt(Fe).geometry;default:throw new Error(Oe+" is invalid")}}l.geometry=v;function w(Oe,Fe,je){if(je===void 0&&(je={}),!Oe)throw new Error("coordinates is required");if(!Array.isArray(Oe))throw new Error("coordinates must be an Array");if(Oe.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Tt(Oe[0])||!Tt(Oe[1]))throw new Error("coordinates must contain numbers");var ut={type:"Point",coordinates:Oe};return h(ut,Fe,je)}l.point=w;function C(Oe,Fe,je){return je===void 0&&(je={}),Se(Oe.map(function(ut){return w(ut,Fe)}),je)}l.points=C;function z(Oe,Fe,je){je===void 0&&(je={});for(var ut=0,ct=Oe;ut<ct.length;ut++){var gt=ct[ut];if(gt.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var St=0;St<gt[gt.length-1].length;St++)if(gt[gt.length-1][St]!==gt[0][St])throw new Error("First and last Position are not equivalent.")}var Ct={type:"Polygon",coordinates:Oe};return h(Ct,Fe,je)}l.polygon=z;function X(Oe,Fe,je){return je===void 0&&(je={}),Se(Oe.map(function(ut){return z(ut,Fe)}),je)}l.polygons=X;function re(Oe,Fe,je){if(je===void 0&&(je={}),Oe.length<2)throw new Error("coordinates must be an array of two or more positions");var ut={type:"LineString",coordinates:Oe};return h(ut,Fe,je)}l.lineString=re;function he(Oe,Fe,je){return je===void 0&&(je={}),Se(Oe.map(function(ut){return re(ut,Fe)}),je)}l.lineStrings=he;function Se(Oe,Fe){Fe===void 0&&(Fe={});var je={type:"FeatureCollection"};return Fe.id&&(je.id=Fe.id),Fe.bbox&&(je.bbox=Fe.bbox),je.features=Oe,je}l.featureCollection=Se;function Je(Oe,Fe,je){je===void 0&&(je={});var ut={type:"MultiLineString",coordinates:Oe};return h(ut,Fe,je)}l.multiLineString=Je;function ze(Oe,Fe,je){je===void 0&&(je={});var ut={type:"MultiPoint",coordinates:Oe};return h(ut,Fe,je)}l.multiPoint=ze;function vt(Oe,Fe,je){je===void 0&&(je={});var ut={type:"MultiPolygon",coordinates:Oe};return h(ut,Fe,je)}l.multiPolygon=vt;function kt(Oe,Fe,je){je===void 0&&(je={});var ut={type:"GeometryCollection",geometries:Oe};return h(ut,Fe,je)}l.geometryCollection=kt;function Xt(Oe,Fe){if(Fe===void 0&&(Fe=0),Fe&&!(Fe>=0))throw new Error("precision must be a positive number");var je=Math.pow(10,Fe||0);return Math.round(Oe*je)/je}l.round=Xt;function yn(Oe,Fe){Fe===void 0&&(Fe="kilometers");var je=l.factors[Fe];if(!je)throw new Error(Fe+" units is invalid");return Oe*je}l.radiansToLength=yn;function bn(Oe,Fe){Fe===void 0&&(Fe="kilometers");var je=l.factors[Fe];if(!je)throw new Error(Fe+" units is invalid");return Oe/je}l.lengthToRadians=bn;function ur(Oe,Fe){return nt(bn(Oe,Fe))}l.lengthToDegrees=ur;function Ye(Oe){var Fe=Oe%360;return Fe<0&&(Fe+=360),Fe}l.bearingToAzimuth=Ye;function nt(Oe){var Fe=Oe%(2*Math.PI);return Fe*180/Math.PI}l.radiansToDegrees=nt;function ht(Oe){var Fe=Oe%360;return Fe*Math.PI/180}l.degreesToRadians=ht;function Ot(Oe,Fe,je){if(Fe===void 0&&(Fe="kilometers"),je===void 0&&(je="kilometers"),!(Oe>=0))throw new Error("length must be a positive number");return yn(bn(Oe,Fe),je)}l.convertLength=Ot;function bt(Oe,Fe,je){if(Fe===void 0&&(Fe="meters"),je===void 0&&(je="kilometers"),!(Oe>=0))throw new Error("area must be a positive number");var ut=l.areaFactors[Fe];if(!ut)throw new Error("invalid original units");var ct=l.areaFactors[je];if(!ct)throw new Error("invalid final units");return Oe/ut*ct}l.convertArea=bt;function Tt(Oe){return!isNaN(Oe)&&Oe!==null&&!Array.isArray(Oe)}l.isNumber=Tt;function ve(Oe){return!!Oe&&Oe.constructor===Object}l.isObject=ve;function Me(Oe){if(!Oe)throw new Error("bbox is required");if(!Array.isArray(Oe))throw new Error("bbox must be an Array");if(Oe.length!==4&&Oe.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");Oe.forEach(function(Fe){if(!Tt(Fe))throw new Error("bbox must only contain numbers")})}l.validateBBox=Me;function Be(Oe){if(!Oe)throw new Error("id is required");if(["string","number"].indexOf(typeof Oe)===-1)throw new Error("id must be a number or a string")}l.validateId=Be}),bo=o(l=>{Object.defineProperty(l,"__esModule",{value:!0});var h=qn();function v(nt,ht,Ot){if(nt!==null)for(var bt,Tt,ve,Me,Be,Oe,Fe,je=0,ut=0,ct,gt=nt.type,St=gt==="FeatureCollection",Ct=gt==="Feature",on=St?nt.features.length:1,$n=0;$n<on;$n++){Fe=St?nt.features[$n].geometry:Ct?nt.geometry:nt,ct=Fe?Fe.type==="GeometryCollection":!1,Be=ct?Fe.geometries.length:1;for(var Hn=0;Hn<Be;Hn++){var er=0,vi=0;if(Me=ct?Fe.geometries[Hn]:Fe,Me!==null){Oe=Me.coordinates;var ki=Me.type;switch(je=Ot&&(ki==="Polygon"||ki==="MultiPolygon")?1:0,ki){case null:break;case"Point":if(ht(Oe,ut,$n,er,vi)===!1)return!1;ut++,er++;break;case"LineString":case"MultiPoint":for(bt=0;bt<Oe.length;bt++){if(ht(Oe[bt],ut,$n,er,vi)===!1)return!1;ut++,ki==="MultiPoint"&&er++}ki==="LineString"&&er++;break;case"Polygon":case"MultiLineString":for(bt=0;bt<Oe.length;bt++){for(Tt=0;Tt<Oe[bt].length-je;Tt++){if(ht(Oe[bt][Tt],ut,$n,er,vi)===!1)return!1;ut++}ki==="MultiLineString"&&er++,ki==="Polygon"&&vi++}ki==="Polygon"&&er++;break;case"MultiPolygon":for(bt=0;bt<Oe.length;bt++){for(vi=0,Tt=0;Tt<Oe[bt].length;Tt++){for(ve=0;ve<Oe[bt][Tt].length-je;ve++){if(ht(Oe[bt][Tt][ve],ut,$n,er,vi)===!1)return!1;ut++}vi++}er++}break;case"GeometryCollection":for(bt=0;bt<Me.geometries.length;bt++)if(v(Me.geometries[bt],ht,Ot)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function w(nt,ht,Ot,bt){var Tt=Ot;return v(nt,function(ve,Me,Be,Oe,Fe){Me===0&&Ot===void 0?Tt=ve:Tt=ht(Tt,ve,Me,Be,Oe,Fe)},bt),Tt}function C(nt,ht){var Ot;switch(nt.type){case"FeatureCollection":for(Ot=0;Ot<nt.features.length&&ht(nt.features[Ot].properties,Ot)!==!1;Ot++);break;case"Feature":ht(nt.properties,0);break}}function z(nt,ht,Ot){var bt=Ot;return C(nt,function(Tt,ve){ve===0&&Ot===void 0?bt=Tt:bt=ht(bt,Tt,ve)}),bt}function X(nt,ht){if(nt.type==="Feature")ht(nt,0);else if(nt.type==="FeatureCollection")for(var Ot=0;Ot<nt.features.length&&ht(nt.features[Ot],Ot)!==!1;Ot++);}function re(nt,ht,Ot){var bt=Ot;return X(nt,function(Tt,ve){ve===0&&Ot===void 0?bt=Tt:bt=ht(bt,Tt,ve)}),bt}function he(nt){var ht=[];return v(nt,function(Ot){ht.push(Ot)}),ht}function Se(nt,ht){var Ot,bt,Tt,ve,Me,Be,Oe,Fe,je,ut,ct=0,gt=nt.type==="FeatureCollection",St=nt.type==="Feature",Ct=gt?nt.features.length:1;for(Ot=0;Ot<Ct;Ot++){for(Be=gt?nt.features[Ot].geometry:St?nt.geometry:nt,Fe=gt?nt.features[Ot].properties:St?nt.properties:{},je=gt?nt.features[Ot].bbox:St?nt.bbox:void 0,ut=gt?nt.features[Ot].id:St?nt.id:void 0,Oe=Be?Be.type==="GeometryCollection":!1,Me=Oe?Be.geometries.length:1,Tt=0;Tt<Me;Tt++){if(ve=Oe?Be.geometries[Tt]:Be,ve===null){if(ht(null,ct,Fe,je,ut)===!1)return!1;continue}switch(ve.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(ht(ve,ct,Fe,je,ut)===!1)return!1;break}case"GeometryCollection":{for(bt=0;bt<ve.geometries.length;bt++)if(ht(ve.geometries[bt],ct,Fe,je,ut)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}ct++}}function Je(nt,ht,Ot){var bt=Ot;return Se(nt,function(Tt,ve,Me,Be,Oe){ve===0&&Ot===void 0?bt=Tt:bt=ht(bt,Tt,ve,Me,Be,Oe)}),bt}function ze(nt,ht){Se(nt,function(Ot,bt,Tt,ve,Me){var Be=Ot===null?null:Ot.type;switch(Be){case null:case"Point":case"LineString":case"Polygon":return ht(h.feature(Ot,Tt,{bbox:ve,id:Me}),bt,0)===!1?!1:void 0}var Oe;switch(Be){case"MultiPoint":Oe="Point";break;case"MultiLineString":Oe="LineString";break;case"MultiPolygon":Oe="Polygon";break}for(var Fe=0;Fe<Ot.coordinates.length;Fe++){var je=Ot.coordinates[Fe],ut={type:Oe,coordinates:je};if(ht(h.feature(ut,Tt),bt,Fe)===!1)return!1}})}function vt(nt,ht,Ot){var bt=Ot;return ze(nt,function(Tt,ve,Me){ve===0&&Me===0&&Ot===void 0?bt=Tt:bt=ht(bt,Tt,ve,Me)}),bt}function kt(nt,ht){ze(nt,function(Ot,bt,Tt){var ve=0;if(Ot.geometry){var Me=Ot.geometry.type;if(!(Me==="Point"||Me==="MultiPoint")){var Be,Oe=0,Fe=0,je=0;if(v(Ot,function(ut,ct,gt,St,Ct){if(Be===void 0||bt>Oe||St>Fe||Ct>je){Be=ut,Oe=bt,Fe=St,je=Ct,ve=0;return}var on=h.lineString([Be,ut],Ot.properties);if(ht(on,bt,Tt,Ct,ve)===!1)return!1;ve++,Be=ut})===!1)return!1}}})}function Xt(nt,ht,Ot){var bt=Ot,Tt=!1;return kt(nt,function(ve,Me,Be,Oe,Fe){Tt===!1&&Ot===void 0?bt=ve:bt=ht(bt,ve,Me,Be,Oe,Fe),Tt=!0}),bt}function yn(nt,ht){if(!nt)throw new Error("geojson is required");ze(nt,function(Ot,bt,Tt){if(Ot.geometry!==null){var ve=Ot.geometry.type,Me=Ot.geometry.coordinates;switch(ve){case"LineString":if(ht(Ot,bt,Tt,0,0)===!1)return!1;break;case"Polygon":for(var Be=0;Be<Me.length;Be++)if(ht(h.lineString(Me[Be],Ot.properties),bt,Tt,Be)===!1)return!1;break}}})}function bn(nt,ht,Ot){var bt=Ot;return yn(nt,function(Tt,ve,Me,Be){ve===0&&Ot===void 0?bt=Tt:bt=ht(bt,Tt,ve,Me,Be)}),bt}function ur(nt,ht){if(ht=ht||{},!h.isObject(ht))throw new Error("options is invalid");var Ot=ht.featureIndex||0,bt=ht.multiFeatureIndex||0,Tt=ht.geometryIndex||0,ve=ht.segmentIndex||0,Me=ht.properties,Be;switch(nt.type){case"FeatureCollection":Ot<0&&(Ot=nt.features.length+Ot),Me=Me||nt.features[Ot].properties,Be=nt.features[Ot].geometry;break;case"Feature":Me=Me||nt.properties,Be=nt.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Be=nt;break;default:throw new Error("geojson is invalid")}if(Be===null)return null;var Oe=Be.coordinates;switch(Be.type){case"Point":case"MultiPoint":return null;case"LineString":return ve<0&&(ve=Oe.length+ve-1),h.lineString([Oe[ve],Oe[ve+1]],Me,ht);case"Polygon":return Tt<0&&(Tt=Oe.length+Tt),ve<0&&(ve=Oe[Tt].length+ve-1),h.lineString([Oe[Tt][ve],Oe[Tt][ve+1]],Me,ht);case"MultiLineString":return bt<0&&(bt=Oe.length+bt),ve<0&&(ve=Oe[bt].length+ve-1),h.lineString([Oe[bt][ve],Oe[bt][ve+1]],Me,ht);case"MultiPolygon":return bt<0&&(bt=Oe.length+bt),Tt<0&&(Tt=Oe[bt].length+Tt),ve<0&&(ve=Oe[bt][Tt].length-ve-1),h.lineString([Oe[bt][Tt][ve],Oe[bt][Tt][ve+1]],Me,ht)}throw new Error("geojson is invalid")}function Ye(nt,ht){if(ht=ht||{},!h.isObject(ht))throw new Error("options is invalid");var Ot=ht.featureIndex||0,bt=ht.multiFeatureIndex||0,Tt=ht.geometryIndex||0,ve=ht.coordIndex||0,Me=ht.properties,Be;switch(nt.type){case"FeatureCollection":Ot<0&&(Ot=nt.features.length+Ot),Me=Me||nt.features[Ot].properties,Be=nt.features[Ot].geometry;break;case"Feature":Me=Me||nt.properties,Be=nt.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Be=nt;break;default:throw new Error("geojson is invalid")}if(Be===null)return null;var Oe=Be.coordinates;switch(Be.type){case"Point":return h.point(Oe,Me,ht);case"MultiPoint":return bt<0&&(bt=Oe.length+bt),h.point(Oe[bt],Me,ht);case"LineString":return ve<0&&(ve=Oe.length+ve),h.point(Oe[ve],Me,ht);case"Polygon":return Tt<0&&(Tt=Oe.length+Tt),ve<0&&(ve=Oe[Tt].length+ve),h.point(Oe[Tt][ve],Me,ht);case"MultiLineString":return bt<0&&(bt=Oe.length+bt),ve<0&&(ve=Oe[bt].length+ve),h.point(Oe[bt][ve],Me,ht);case"MultiPolygon":return bt<0&&(bt=Oe.length+bt),Tt<0&&(Tt=Oe[bt].length+Tt),ve<0&&(ve=Oe[bt][Tt].length-ve),h.point(Oe[bt][Tt][ve],Me,ht)}throw new Error("geojson is invalid")}l.coordAll=he,l.coordEach=v,l.coordReduce=w,l.featureEach=X,l.featureReduce=re,l.findPoint=Ye,l.findSegment=ur,l.flattenEach=ze,l.flattenReduce=vt,l.geomEach=Se,l.geomReduce=Je,l.lineEach=yn,l.lineReduce=bn,l.propEach=C,l.propReduce=z,l.segmentEach=kt,l.segmentReduce=Xt}),wo=o(l=>{Object.defineProperty(l,"__esModule",{value:!0});var h=bo();function v(w){var C=[1/0,1/0,-1/0,-1/0];return h.coordEach(w,function(z){C[0]>z[0]&&(C[0]=z[0]),C[1]>z[1]&&(C[1]=z[1]),C[2]<z[0]&&(C[2]=z[0]),C[3]<z[1]&&(C[3]=z[1])}),C}v.default=v,l.default=v}),Lr=o((l,h)=>{var v=hr(),w=qn(),C=bo(),z=wo().default,X=C.featureEach;C.coordEach,w.polygon;var re=w.featureCollection;function he(Se){var Je=new v(Se);return Je.insert=function(ze){if(ze.type!=="Feature")throw new Error("invalid feature");return ze.bbox=ze.bbox?ze.bbox:z(ze),v.prototype.insert.call(this,ze)},Je.load=function(ze){var vt=[];return Array.isArray(ze)?ze.forEach(function(kt){if(kt.type!=="Feature")throw new Error("invalid features");kt.bbox=kt.bbox?kt.bbox:z(kt),vt.push(kt)}):X(ze,function(kt){if(kt.type!=="Feature")throw new Error("invalid features");kt.bbox=kt.bbox?kt.bbox:z(kt),vt.push(kt)}),v.prototype.load.call(this,vt)},Je.remove=function(ze,vt){if(ze.type!=="Feature")throw new Error("invalid feature");return ze.bbox=ze.bbox?ze.bbox:z(ze),v.prototype.remove.call(this,ze,vt)},Je.clear=function(){return v.prototype.clear.call(this)},Je.search=function(ze){var vt=v.prototype.search.call(this,this.toBBox(ze));return re(vt)},Je.collides=function(ze){return v.prototype.collides.call(this,this.toBBox(ze))},Je.all=function(){var ze=v.prototype.all.call(this);return re(ze)},Je.toJSON=function(){return v.prototype.toJSON.call(this)},Je.fromJSON=function(ze){return v.prototype.fromJSON.call(this,ze)},Je.toBBox=function(ze){var vt;if(ze.bbox)vt=ze.bbox;else if(Array.isArray(ze)&&ze.length===4)vt=ze;else if(Array.isArray(ze)&&ze.length===6)vt=[ze[0],ze[1],ze[3],ze[4]];else if(ze.type==="Feature")vt=z(ze);else if(ze.type==="FeatureCollection")vt=z(ze);else throw new Error("invalid geojson");return{minX:vt[0],minY:vt[1],maxX:vt[2],maxY:vt[3]}},Je}h.exports=he,h.exports.default=he});Array.prototype.findIndex=Array.prototype.findIndex||function(l){if(this===null)throw new TypeError("Array.prototype.findIndex called on null or undefined");if(typeof l!="function")throw new TypeError("callback must be a function");for(var h=Object(this),v=h.length>>>0,w=arguments[1],C=0;C<v;C++)if(l.call(w,h[C],C,h))return C;return-1},Array.prototype.find=Array.prototype.find||function(l){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof l!="function")throw new TypeError("callback must be a function");for(var h=Object(this),v=h.length>>>0,w=arguments[1],C=0;C<v;C++){var z=h[C];if(l.call(w,z,C,h))return z}},typeof Object.assign!="function"&&(Object.assign=function(l){if(l==null)throw new TypeError("Cannot convert undefined or null to object");l=Object(l);for(var h=1;h<arguments.length;h++){var v=arguments[h];if(v!=null)for(var w in v)Object.prototype.hasOwnProperty.call(v,w)&&(l[w]=v[w])}return l}),function(l){l.forEach(function(h){h.hasOwnProperty("remove")||Object.defineProperty(h,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})}([Element.prototype,CharacterData.prototype,DocumentType.prototype]),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(l,h){if(this==null)throw new TypeError('"this" is null or not defined');var v=Object(this),w=v.length>>>0;if(w===0)return!1;var C=h|0,z=Math.max(C>=0?C:w-Math.abs(C),0);function X(re,he){return re===he||typeof re=="number"&&typeof he=="number"&&isNaN(re)&&isNaN(he)}for(;z<w;){if(X(v[z],l))return!0;z++}return!1}});var Us={version:"2.18.3"},Gn=f(_i()),_r={tooltips:{placeMarker:"Click to place marker",firstVertex:"Click to place first vertex",continueLine:"Click to continue drawing",finishLine:"Click any existing marker to finish",finishPoly:"Click first marker to finish",finishRect:"Click to finish",startCircle:"Click to place circle center",finishCircle:"Click to finish circle",placeCircleMarker:"Click to place circle marker",placeText:"Click to place text",selectFirstLayerFor:"Select first layer for {action}",selectSecondLayerFor:"Select second layer for {action}"},actions:{finish:"Finish",cancel:"Cancel",removeLastVertex:"Remove Last Vertex"},buttonTitles:{drawMarkerButton:"Draw Marker",drawPolyButton:"Draw Polygons",drawLineButton:"Draw Polyline",drawCircleButton:"Draw Circle",drawRectButton:"Draw Rectangle",editButton:"Edit Layers",dragButton:"Drag Layers",cutButton:"Cut Layers",deleteButton:"Remove Layers",drawCircleMarkerButton:"Draw Circle Marker",snappingButton:"Snap dragged marker to other layers and vertices",pinningButton:"Pin shared vertices together",rotateButton:"Rotate Layers",drawTextButton:"Draw Text",scaleButton:"Scale Layers",autoTracingButton:"Auto trace Line",snapGuidesButton:"Show SnapGuides",unionButton:"Union layers",differenceButton:"Subtract layers"},measurements:{totalLength:"Length",segmentLength:"Segment length",area:"Area",radius:"Radius",perimeter:"Perimeter",height:"Height",width:"Width",coordinates:"Position",coordinatesMarker:"Position Marker"}},Yr={tooltips:{placeMarker:"Platziere den Marker mit Klick",firstVertex:"Platziere den ersten Marker mit Klick",continueLine:"Klicke, um weiter zu zeichnen",finishLine:"Beende mit Klick auf existierenden Marker",finishPoly:"Beende mit Klick auf ersten Marker",finishRect:"Beende mit Klick",startCircle:"Platziere das Kreiszentrum mit Klick",finishCircle:"Beende den Kreis mit Klick",placeCircleMarker:"Platziere den Kreismarker mit Klick",placeText:"Platziere den Text mit Klick"},actions:{finish:"Beenden",cancel:"Abbrechen",removeLastVertex:"Letzten Vertex löschen"},buttonTitles:{drawMarkerButton:"Marker zeichnen",drawPolyButton:"Polygon zeichnen",drawLineButton:"Polyline zeichnen",drawCircleButton:"Kreis zeichnen",drawRectButton:"Rechteck zeichnen",editButton:"Layer editieren",dragButton:"Layer bewegen",cutButton:"Layer schneiden",deleteButton:"Layer löschen",drawCircleMarkerButton:"Kreismarker zeichnen",snappingButton:"Bewegter Layer an andere Layer oder Vertexe einhacken",pinningButton:"Vertexe an der gleichen Position verknüpfen",rotateButton:"Layer drehen",drawTextButton:"Text zeichnen",scaleButton:"Layer skalieren",autoTracingButton:"Linie automatisch nachzeichen"},measurements:{totalLength:"Länge",segmentLength:"Segment Länge",area:"Fläche",radius:"Radius",perimeter:"Umfang",height:"Höhe",width:"Breite",coordinates:"Position",coordinatesMarker:"Position Marker"}},_n={tooltips:{placeMarker:"Clicca per posizionare un Marker",firstVertex:"Clicca per posizionare il primo vertice",continueLine:"Clicca per continuare a disegnare",finishLine:"Clicca qualsiasi marker esistente per terminare",finishPoly:"Clicca il primo marker per terminare",finishRect:"Clicca per terminare",startCircle:"Clicca per posizionare il punto centrale del cerchio",finishCircle:"Clicca per terminare il cerchio",placeCircleMarker:"Clicca per posizionare un Marker del cherchio"},actions:{finish:"Termina",cancel:"Annulla",removeLastVertex:"Rimuovi l'ultimo vertice"},buttonTitles:{drawMarkerButton:"Disegna Marker",drawPolyButton:"Disegna Poligoni",drawLineButton:"Disegna Polilinea",drawCircleButton:"Disegna Cerchio",drawRectButton:"Disegna Rettangolo",editButton:"Modifica Livelli",dragButton:"Sposta Livelli",cutButton:"Ritaglia Livelli",deleteButton:"Elimina Livelli",drawCircleMarkerButton:"Disegna Marker del Cerchio",snappingButton:"Snap ha trascinato il pennarello su altri strati e vertici",pinningButton:"Pin condiviso vertici insieme",rotateButton:"Ruota livello"}},tn={tooltips:{placeMarker:"Klik untuk menempatkan marker",firstVertex:"Klik untuk menempatkan vertex pertama",continueLine:"Klik untuk meneruskan digitasi",finishLine:"Klik pada sembarang marker yang ada untuk mengakhiri",finishPoly:"Klik marker pertama untuk mengakhiri",finishRect:"Klik untuk mengakhiri",startCircle:"Klik untuk menempatkan titik pusat lingkaran",finishCircle:"Klik untuk mengakhiri lingkaran",placeCircleMarker:"Klik untuk menempatkan penanda lingkarann"},actions:{finish:"Selesai",cancel:"Batal",removeLastVertex:"Hilangkan Vertex Terakhir"},buttonTitles:{drawMarkerButton:"Digitasi Marker",drawPolyButton:"Digitasi Polygon",drawLineButton:"Digitasi Polyline",drawCircleButton:"Digitasi Lingkaran",drawRectButton:"Digitasi Segi Empat",editButton:"Edit Layer",dragButton:"Geser Layer",cutButton:"Potong Layer",deleteButton:"Hilangkan Layer",drawCircleMarkerButton:"Digitasi Penanda Lingkaran",snappingButton:"Jepretkan penanda yang ditarik ke lapisan dan simpul lain",pinningButton:"Sematkan simpul bersama bersama",rotateButton:"Putar lapisan"}},ai={tooltips:{placeMarker:"Adaugă un punct",firstVertex:"Apasă aici pentru a adăuga primul Vertex",continueLine:"Apasă aici pentru a continua desenul",finishLine:"Apasă pe orice obiect pentru a finisa desenul",finishPoly:"Apasă pe primul obiect pentru a finisa",finishRect:"Apasă pentru a finisa",startCircle:"Apasă pentru a desena un cerc",finishCircle:"Apasă pentru a finisa un cerc",placeCircleMarker:"Adaugă un punct"},actions:{finish:"Termină",cancel:"Anulează",removeLastVertex:"Șterge ultimul Vertex"},buttonTitles:{drawMarkerButton:"Adaugă o bulină",drawPolyButton:"Desenează un poligon",drawLineButton:"Desenează o linie",drawCircleButton:"Desenează un cerc",drawRectButton:"Desenează un dreptunghi",editButton:"Editează straturile",dragButton:"Mută straturile",cutButton:"Taie straturile",deleteButton:"Șterge straturile",drawCircleMarkerButton:"Desenează marcatorul cercului",snappingButton:"Fixați marcatorul glisat pe alte straturi și vârfuri",pinningButton:"Fixați vârfurile partajate împreună",rotateButton:"Rotiți stratul"}},fo={tooltips:{placeMarker:"Нажмите, чтобы нанести маркер",firstVertex:"Нажмите, чтобы нанести первый объект",continueLine:"Нажмите, чтобы продолжить рисование",finishLine:"Нажмите любой существующий маркер для завершения",finishPoly:"Выберите первую точку, чтобы закончить",finishRect:"Нажмите, чтобы закончить",startCircle:"Нажмите, чтобы добавить центр круга",finishCircle:"Нажмите, чтобы задать радиус",placeCircleMarker:"Нажмите, чтобы нанести круговой маркер"},actions:{finish:"Завершить",cancel:"Отменить",removeLastVertex:"Отменить последнее действие"},buttonTitles:{drawMarkerButton:"Добавить маркер",drawPolyButton:"Рисовать полигон",drawLineButton:"Рисовать кривую",drawCircleButton:"Рисовать круг",drawRectButton:"Рисовать прямоугольник",editButton:"Редактировать слой",dragButton:"Перенести слой",cutButton:"Вырезать слой",deleteButton:"Удалить слой",drawCircleMarkerButton:"Добавить круговой маркер",snappingButton:"Привязать перетаскиваемый маркер к другим слоям и вершинам",pinningButton:"Связать общие точки вместе",rotateButton:"Поворот слоя"}},xo={tooltips:{placeMarker:"Presiona para colocar un marcador",firstVertex:"Presiona para colocar el primer vértice",continueLine:"Presiona para continuar dibujando",finishLine:"Presiona cualquier marcador existente para finalizar",finishPoly:"Presiona el primer marcador para finalizar",finishRect:"Presiona para finalizar",startCircle:"Presiona para colocar el centro del círculo",finishCircle:"Presiona para finalizar el círculo",placeCircleMarker:"Presiona para colocar un marcador de círculo"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Eliminar último vértice"},buttonTitles:{drawMarkerButton:"Dibujar Marcador",drawPolyButton:"Dibujar Polígono",drawLineButton:"Dibujar Línea",drawCircleButton:"Dibujar Círculo",drawRectButton:"Dibujar Rectángulo",editButton:"Editar Capas",dragButton:"Arrastrar Capas",cutButton:"Cortar Capas",deleteButton:"Eliminar Capas",drawCircleMarkerButton:"Dibujar Marcador de Círculo",snappingButton:"El marcador de Snap arrastrado a otras capas y vértices",pinningButton:"Fijar juntos los vértices compartidos",rotateButton:"Rotar capa"}},Mi={tooltips:{placeMarker:"Klik om een marker te plaatsen",firstVertex:"Klik om het eerste punt te plaatsen",continueLine:"Klik om te blijven tekenen",finishLine:"Klik op een bestaand punt om te beëindigen",finishPoly:"Klik op het eerst punt om te beëindigen",finishRect:"Klik om te beëindigen",startCircle:"Klik om het middelpunt te plaatsen",finishCircle:"Klik om de cirkel te beëindigen",placeCircleMarker:"Klik om een marker te plaatsen"},actions:{finish:"Bewaar",cancel:"Annuleer",removeLastVertex:"Verwijder laatste punt"},buttonTitles:{drawMarkerButton:"Plaats Marker",drawPolyButton:"Teken een vlak",drawLineButton:"Teken een lijn",drawCircleButton:"Teken een cirkel",drawRectButton:"Teken een vierkant",editButton:"Bewerk",dragButton:"Verplaats",cutButton:"Knip",deleteButton:"Verwijder",drawCircleMarkerButton:"Plaats Marker",snappingButton:"Snap gesleepte marker naar andere lagen en hoekpunten",pinningButton:"Speld gedeelde hoekpunten samen",rotateButton:"Laag roteren"}},fs={tooltips:{placeMarker:"Cliquez pour placer un marqueur",firstVertex:"Cliquez pour placer le premier sommet",continueLine:"Cliquez pour continuer à dessiner",finishLine:"Cliquez sur n'importe quel marqueur pour terminer",finishPoly:"Cliquez sur le premier marqueur pour terminer",finishRect:"Cliquez pour terminer",startCircle:"Cliquez pour placer le centre du cercle",finishCircle:"Cliquez pour finir le cercle",placeCircleMarker:"Cliquez pour placer le marqueur circulaire"},actions:{finish:"Terminer",cancel:"Annuler",removeLastVertex:"Retirer le dernier sommet"},buttonTitles:{drawMarkerButton:"Placer des marqueurs",drawPolyButton:"Dessiner des polygones",drawLineButton:"Dessiner des polylignes",drawCircleButton:"Dessiner un cercle",drawRectButton:"Dessiner un rectangle",editButton:"Éditer des calques",dragButton:"Déplacer des calques",cutButton:"Couper des calques",deleteButton:"Supprimer des calques",drawCircleMarkerButton:"Dessiner un marqueur circulaire",snappingButton:"Glisser le marqueur vers d'autres couches et sommets",pinningButton:"Épingler ensemble les sommets partagés",rotateButton:"Tourner des calques"}},Qo={tooltips:{placeMarker:"单击放置标记",firstVertex:"单击放置首个顶点",continueLine:"单击继续绘制",finishLine:"单击任何存在的标记以完成",finishPoly:"单击第一个标记以完成",finishRect:"单击完成",startCircle:"单击放置圆心",finishCircle:"单击完成圆形",placeCircleMarker:"点击放置圆形标记"},actions:{finish:"完成",cancel:"取消",removeLastVertex:"移除最后的顶点"},buttonTitles:{drawMarkerButton:"绘制标记",drawPolyButton:"绘制多边形",drawLineButton:"绘制线段",drawCircleButton:"绘制圆形",drawRectButton:"绘制长方形",editButton:"编辑图层",dragButton:"拖拽图层",cutButton:"剪切图层",deleteButton:"删除图层",drawCircleMarkerButton:"画圆圈标记",snappingButton:"将拖动的标记捕捉到其他图层和顶点",pinningButton:"将共享顶点固定在一起",rotateButton:"旋转图层"}},Ro={tooltips:{placeMarker:"單擊放置標記",firstVertex:"單擊放置第一個頂點",continueLine:"單擊繼續繪製",finishLine:"單擊任何存在的標記以完成",finishPoly:"單擊第一個標記以完成",finishRect:"單擊完成",startCircle:"單擊放置圓心",finishCircle:"單擊完成圓形",placeCircleMarker:"點擊放置圓形標記"},actions:{finish:"完成",cancel:"取消",removeLastVertex:"移除最後一個頂點"},buttonTitles:{drawMarkerButton:"放置標記",drawPolyButton:"繪製多邊形",drawLineButton:"繪製線段",drawCircleButton:"繪製圓形",drawRectButton:"繪製方形",editButton:"編輯圖形",dragButton:"移動圖形",cutButton:"裁切圖形",deleteButton:"刪除圖形",drawCircleMarkerButton:"畫圓圈標記",snappingButton:"將拖動的標記對齊到其他圖層和頂點",pinningButton:"將共享頂點固定在一起",rotateButton:"旋轉圖形"}},di={tooltips:{placeMarker:"Clique para posicionar o marcador",firstVertex:"Clique para posicionar o primeiro vértice",continueLine:"Clique para continuar desenhando",finishLine:"Clique em qualquer marcador existente para finalizar",finishPoly:"Clique no primeiro marcador para finalizar",finishRect:"Clique para finalizar",startCircle:"Clique para posicionar o centro do círculo",finishCircle:"Clique para finalizar o círculo",placeCircleMarker:"Clique para posicionar o marcador circular",placeText:"Clique para inserir texto"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Remover último vértice"},buttonTitles:{drawMarkerButton:"Desenhar Marcador",drawPolyButton:"Desenhar Polígonos",drawLineButton:"Desenhar Linha Poligonal",drawCircleButton:"Desenhar Círculo",drawRectButton:"Desenhar Retângulo",editButton:"Editar Camadas",dragButton:"Arrastar Camadas",cutButton:"Recortar Camadas",deleteButton:"Remover Camadas",drawCircleMarkerButton:"Desenhar Marcador de Círculo",snappingButton:"Ajustar marcador arrastado a outras camadas e vértices",pinningButton:"Unir vértices compartilhados",rotateButton:"Rotacionar Camadas",drawTextButton:"Desenhar Texto",scaleButton:"Redimensionar Camadas",autoTracingButton:"Traçado Automático de Linha"},measurements:{totalLength:"Comprimento",segmentLength:"Comprimento do Segmento",area:"Área",radius:"Raio",perimeter:"Perímetro",height:"Altura",width:"Largura",coordinates:"Posição",coordinatesMarker:"Marcador de Posição"}},Is={tooltips:{placeMarker:"Clique para colocar marcador",firstVertex:"Clique para colocar primeiro vértice",continueLine:"Clique para continuar a desenhar",finishLine:"Clique num marcador existente para terminar",finishPoly:"Clique no primeiro marcador para terminar",finishRect:"Clique para terminar",startCircle:"Clique para colocar o centro do círculo",finishCircle:"Clique para terminar o círculo",placeCircleMarker:"Clique para colocar marcador de círculo",placeText:"Clique para colocar texto"},actions:{finish:"Terminar",cancel:"Cancelar",removeLastVertex:"Remover Último Vértice"},buttonTitles:{drawMarkerButton:"Desenhar Marcador",drawPolyButton:"Desenhar Polígonos",drawLineButton:"Desenhar Polilinha",drawCircleButton:"Desenhar Círculo",drawRectButton:"Desenhar Retângulo",editButton:"Editar Camadas",dragButton:"Arrastar Camadas",cutButton:"Cortar Camadas",deleteButton:"Remover Camadas",drawCircleMarkerButton:"Desenhar Marcador de Círculo",snappingButton:"Ajustar marcador arrastado a outras camadas e vértices",pinningButton:"Unir vértices partilhados",rotateButton:"Rodar Camadas",drawTextButton:"Desenhar Texto",scaleButton:"Escalar Camadas",autoTracingButton:"Traçado Automático de Linha"},measurements:{totalLength:"Comprimento",segmentLength:"Comprimento do Segmento",area:"Área",radius:"Raio",perimeter:"Perímetro",height:"Altura",width:"Largura",coordinates:"Posição",coordinatesMarker:"Marcador de Posição"}},Fo={tooltips:{placeMarker:"Kliknij, aby umieścić znacznik",firstVertex:"Kliknij, aby umieścić pierwszy wierzchołek",continueLine:"Kliknij, aby kontynuować rysowanie",finishLine:"Kliknij dowolny istniejący znacznik, aby zakończyć",finishPoly:"Kliknij pierwszy znacznik, aby zakończyć",finishRect:"Kliknij, aby zakończyć",startCircle:"Kliknij, aby umieścić środek okręgu",finishCircle:"Kliknij, aby zakończyć okrąg",placeCircleMarker:"Kliknij, aby umieścić znacznik okręgu",placeText:"Kliknij, aby umieścić tekst"},actions:{finish:"Zakończ",cancel:"Anuluj",removeLastVertex:"Usuń ostatni wierzchołek"},buttonTitles:{drawMarkerButton:"Rysuj znacznik",drawPolyButton:"Rysuj wielokąt",drawLineButton:"Rysuj linię",drawCircleButton:"Rysuj okrąg",drawRectButton:"Rysuj prostokąt",editButton:"Edytuj warstwy",dragButton:"Przeciągnij warstwy",cutButton:"Wytnij warstwy",deleteButton:"Usuń warstwy",drawCircleMarkerButton:"Rysuj znacznik okrągły",snappingButton:"Przyciągnij przenoszony znacznik do innych warstw i wierzchołków",pinningButton:"Przypnij wspólne wierzchołki razem",rotateButton:"Obróć warstwy",drawTextButton:"Rysuj tekst",scaleButton:"Skaluj warstwy",autoTracingButton:"Automatyczne śledzenie linii"},measurements:{totalLength:"Długość",segmentLength:"Długość odcinka",area:"Obszar",radius:"Promień",perimeter:"Obwód",height:"Wysokość",width:"Szerokość",coordinates:"Pozycja",coordinatesMarker:"Znacznik pozycji"}},eo={tooltips:{placeMarker:"Klicka för att placera markör",firstVertex:"Klicka för att placera första hörnet",continueLine:"Klicka för att fortsätta rita",finishLine:"Klicka på en existerande punkt för att slutföra",finishPoly:"Klicka på den första punkten för att slutföra",finishRect:"Klicka för att slutföra",startCircle:"Klicka för att placera cirkelns centrum",finishCircle:"Klicka för att slutföra cirkeln",placeCircleMarker:"Klicka för att placera cirkelmarkör"},actions:{finish:"Slutför",cancel:"Avbryt",removeLastVertex:"Ta bort sista hörnet"},buttonTitles:{drawMarkerButton:"Rita Markör",drawPolyButton:"Rita Polygoner",drawLineButton:"Rita Linje",drawCircleButton:"Rita Cirkel",drawRectButton:"Rita Rektangel",editButton:"Redigera Lager",dragButton:"Dra Lager",cutButton:"Klipp i Lager",deleteButton:"Ta bort Lager",drawCircleMarkerButton:"Rita Cirkelmarkör",snappingButton:"Snäpp dra markören till andra lager och hörn",pinningButton:"Fäst delade hörn tillsammans",rotateButton:"Rotera lagret"}},Lo={tooltips:{placeMarker:"Κάντε κλικ για να τοποθετήσετε Δείκτη",firstVertex:"Κάντε κλικ για να τοποθετήσετε το πρώτο σημείο",continueLine:"Κάντε κλικ για να συνεχίσετε να σχεδιάζετε",finishLine:"Κάντε κλικ σε οποιονδήποτε υπάρχον σημείο για να ολοκληρωθεί",finishPoly:"Κάντε κλικ στο πρώτο σημείο για να τελειώσετε",finishRect:"Κάντε κλικ για να τελειώσετε",startCircle:"Κάντε κλικ για να τοποθετήσετε κέντρο Κύκλου",finishCircle:"Κάντε κλικ για να ολοκληρώσετε τον Κύκλο",placeCircleMarker:"Κάντε κλικ για να τοποθετήσετε Κυκλικό Δείκτη"},actions:{finish:"Τέλος",cancel:"Ακύρωση",removeLastVertex:"Κατάργηση τελευταίου σημείου"},buttonTitles:{drawMarkerButton:"Σχεδίαση Δείκτη",drawPolyButton:"Σχεδίαση Πολυγώνου",drawLineButton:"Σχεδίαση Γραμμής",drawCircleButton:"Σχεδίαση Κύκλου",drawRectButton:"Σχεδίαση Ορθογωνίου",editButton:"Επεξεργασία Επιπέδων",dragButton:"Μεταφορά Επιπέδων",cutButton:"Αποκοπή Επιπέδων",deleteButton:"Κατάργηση Επιπέδων",drawCircleMarkerButton:"Σχεδίαση Κυκλικού Δείκτη",snappingButton:"Προσκόλληση του Δείκτη μεταφοράς σε άλλα Επίπεδα και Κορυφές",pinningButton:"Περικοπή κοινών κορυφών μαζί",rotateButton:"Περιστρέψτε το στρώμα"}},Vs={tooltips:{placeMarker:"Kattintson a jelölő elhelyezéséhez",firstVertex:"Kattintson az első pont elhelyezéséhez",continueLine:"Kattintson a következő pont elhelyezéséhez",finishLine:"A befejezéshez kattintson egy meglévő pontra",finishPoly:"A befejezéshez kattintson az első pontra",finishRect:"Kattintson a befejezéshez",startCircle:"Kattintson a kör középpontjának elhelyezéséhez",finishCircle:"Kattintson a kör befejezéséhez",placeCircleMarker:"Kattintson a körjelölő elhelyezéséhez"},actions:{finish:"Befejezés",cancel:"Mégse",removeLastVertex:"Utolsó pont eltávolítása"},buttonTitles:{drawMarkerButton:"Jelölő rajzolása",drawPolyButton:"Poligon rajzolása",drawLineButton:"Vonal rajzolása",drawCircleButton:"Kör rajzolása",drawRectButton:"Négyzet rajzolása",editButton:"Elemek szerkesztése",dragButton:"Elemek mozgatása",cutButton:"Elemek vágása",deleteButton:"Elemek törlése",drawCircleMarkerButton:"Kör jelölő rajzolása",snappingButton:"Kapcsolja a jelöltőt másik elemhez vagy ponthoz",pinningButton:"Közös pontok összekötése",rotateButton:"Fólia elforgatása"}},va={tooltips:{placeMarker:"Tryk for at placere en markør",firstVertex:"Tryk for at placere det første punkt",continueLine:"Tryk for at fortsætte linjen",finishLine:"Tryk på et eksisterende punkt for at afslutte",finishPoly:"Tryk på det første punkt for at afslutte",finishRect:"Tryk for at afslutte",startCircle:"Tryk for at placere cirklens center",finishCircle:"Tryk for at afslutte cirklen",placeCircleMarker:"Tryk for at placere en cirkelmarkør"},actions:{finish:"Afslut",cancel:"Afbryd",removeLastVertex:"Fjern sidste punkt"},buttonTitles:{drawMarkerButton:"Placer markør",drawPolyButton:"Tegn polygon",drawLineButton:"Tegn linje",drawCircleButton:"Tegn cirkel",drawRectButton:"Tegn firkant",editButton:"Rediger",dragButton:"Træk",cutButton:"Klip",deleteButton:"Fjern",drawCircleMarkerButton:"Tegn cirkelmarkør",snappingButton:"Fastgør trukket markør til andre elementer",pinningButton:"Sammenlæg delte elementer",rotateButton:"Roter laget"}},to={tooltips:{placeMarker:"Klikk for å plassere punkt",firstVertex:"Klikk for å plassere første punkt",continueLine:"Klikk for å tegne videre",finishLine:"Klikk på et eksisterende punkt for å fullføre",finishPoly:"Klikk første punkt for å fullføre",finishRect:"Klikk for å fullføre",startCircle:"Klikk for å sette sirkel midtpunkt",finishCircle:"Klikk for å fullføre sirkel",placeCircleMarker:"Klikk for å plassere sirkel",placeText:"Klikk for å plassere tekst"},actions:{finish:"Fullfør",cancel:"Kanseller",removeLastVertex:"Fjern forrige punkt"},buttonTitles:{drawMarkerButton:"Tegn punkt",drawPolyButton:"Tegn flate",drawLineButton:"Tegn linje",drawCircleButton:"Tegn sirkel",drawRectButton:"Tegn rektangel",editButton:"Rediger objekter",dragButton:"Dra objekter",cutButton:"Kutt objekter",deleteButton:"Fjern objekter",drawCircleMarkerButton:"Tegn sirkel-punkt",snappingButton:"Fest dratt punkt til andre objekter og punkt",pinningButton:"Pin delte punkter sammen",rotateButton:"Rotér objekter",drawTextButton:"Tegn tekst",scaleButton:"Skalér objekter",autoTracingButton:"Automatisk sporing av linje"},measurements:{totalLength:"Lengde",segmentLength:"Segmentlengde",area:"Område",radius:"Radius",perimeter:"Omriss",height:"Høyde",width:"Bredde",coordinates:"Posisjon",coordinatesMarker:"Posisjonsmarkør"}},il={tooltips:{placeMarker:"کلیک برای جانمایی نشان",firstVertex:"کلیک برای رسم اولین رأس",continueLine:"کلیک برای ادامه رسم",finishLine:"کلیک روی هر نشان موجود برای پایان",finishPoly:"کلیک روی اولین نشان برای پایان",finishRect:"کلیک برای پایان",startCircle:"کلیک برای رسم مرکز دایره",finishCircle:"کلیک برای پایان رسم دایره",placeCircleMarker:"کلیک برای رسم نشان دایره",placeText:"کلیک برای نوشتن متن"},actions:{finish:"پایان",cancel:"لفو",removeLastVertex:"حذف آخرین رأس"},buttonTitles:{drawMarkerButton:"درج نشان",drawPolyButton:"رسم چندضلعی",drawLineButton:"رسم خط",drawCircleButton:"رسم دایره",drawRectButton:"رسم چهارضلعی",editButton:"ویرایش لایه‌ها",dragButton:"جابجایی لایه‌ها",cutButton:"برش لایه‌ها",deleteButton:"حذف لایه‌ها",drawCircleMarkerButton:"رسم نشان دایره",snappingButton:"نشانگر را به لایه‌ها و رئوس دیگر بکشید",pinningButton:"رئوس مشترک را با هم پین کنید",rotateButton:"چرخش لایه",drawTextButton:"رسم متن",scaleButton:"مقیاس‌گذاری",autoTracingButton:"ردیاب خودکار"},measurements:{totalLength:"طول",segmentLength:"طول بخش",area:"ناحیه",radius:"شعاع",perimeter:"محیط",height:"ارتفاع",width:"عرض",coordinates:"موقعیت",coordinatesMarker:"موقعیت نشان"}},ya={tooltips:{placeMarker:"Натисніть, щоб нанести маркер",firstVertex:"Натисніть, щоб нанести першу вершину",continueLine:"Натисніть, щоб продовжити малювати",finishLine:"Натисніть будь-який існуючий маркер для завершення",finishPoly:"Виберіть перший маркер, щоб завершити",finishRect:"Натисніть, щоб завершити",startCircle:"Натисніть, щоб додати центр кола",finishCircle:"Натисніть, щоб завершити коло",placeCircleMarker:"Натисніть, щоб нанести круговий маркер"},actions:{finish:"Завершити",cancel:"Відмінити",removeLastVertex:"Видалити попередню вершину"},buttonTitles:{drawMarkerButton:"Малювати маркер",drawPolyButton:"Малювати полігон",drawLineButton:"Малювати криву",drawCircleButton:"Малювати коло",drawRectButton:"Малювати прямокутник",editButton:"Редагувати шари",dragButton:"Перенести шари",cutButton:"Вирізати шари",deleteButton:"Видалити шари",drawCircleMarkerButton:"Малювати круговий маркер",snappingButton:"Прив’язати перетягнутий маркер до інших шарів та вершин",pinningButton:"Зв'язати спільні вершини разом",rotateButton:"Повернути шар"}},gr={tooltips:{placeMarker:"İşaretçi yerleştirmek için tıklayın",firstVertex:"İlk tepe noktasını yerleştirmek için tıklayın",continueLine:"Çizime devam etmek için tıklayın",finishLine:"Bitirmek için mevcut herhangi bir işaretçiyi tıklayın",finishPoly:"Bitirmek için ilk işaretçiyi tıklayın",finishRect:"Bitirmek için tıklayın",startCircle:"Daire merkezine yerleştirmek için tıklayın",finishCircle:"Daireyi bitirmek için tıklayın",placeCircleMarker:"Daire işaretçisi yerleştirmek için tıklayın"},actions:{finish:"Bitir",cancel:"İptal",removeLastVertex:"Son köşeyi kaldır"},buttonTitles:{drawMarkerButton:"Çizim İşaretçisi",drawPolyButton:"Çokgenler çiz",drawLineButton:"Çoklu çizgi çiz",drawCircleButton:"Çember çiz",drawRectButton:"Dikdörtgen çiz",editButton:"Katmanları düzenle",dragButton:"Katmanları sürükle",cutButton:"Katmanları kes",deleteButton:"Katmanları kaldır",drawCircleMarkerButton:"Daire işaretçisi çiz",snappingButton:"Sürüklenen işaretçiyi diğer katmanlara ve köşelere yapıştır",pinningButton:"Paylaşılan köşeleri birbirine sabitle",rotateButton:"Katmanı döndür"}},br={tooltips:{placeMarker:"Kliknutím vytvoříte značku",firstVertex:"Kliknutím vytvoříte první objekt",continueLine:"Kliknutím pokračujte v kreslení",finishLine:"Kliknutí na libovolnou existující značku pro dokončení",finishPoly:"Vyberte první bod pro dokončení",finishRect:"Klikněte pro dokončení",startCircle:"Kliknutím přidejte střed kruhu",finishCircle:"Нажмите, чтобы задать радиус",placeCircleMarker:"Kliknutím nastavte poloměr"},actions:{finish:"Dokončit",cancel:"Zrušit",removeLastVertex:"Zrušit poslední akci"},buttonTitles:{drawMarkerButton:"Přidat značku",drawPolyButton:"Nakreslit polygon",drawLineButton:"Nakreslit křivku",drawCircleButton:"Nakreslit kruh",drawRectButton:"Nakreslit obdélník",editButton:"Upravit vrstvu",dragButton:"Přeneste vrstvu",cutButton:"Vyjmout vrstvu",deleteButton:"Smazat vrstvu",drawCircleMarkerButton:"Přidat kruhovou značku",snappingButton:"Navázat tažnou značku k dalším vrstvám a vrcholům",pinningButton:"Spojit společné body dohromady",rotateButton:"Otočte vrstvu"}},Jr={tooltips:{placeMarker:"クリックしてマーカーを配置",firstVertex:"クリックして最初の頂点を配置",continueLine:"クリックして描画を続ける",finishLine:"任意のマーカーをクリックして終了",finishPoly:"最初のマーカーをクリックして終了",finishRect:"クリックして終了",startCircle:"クリックして円の中心を配置",finishCircle:"クリックして円の描画を終了",placeCircleMarker:"クリックして円マーカーを配置",placeText:"クリックしてテキストを配置"},actions:{finish:"終了",cancel:"キャンセル",removeLastVertex:"最後の頂点を削除"},buttonTitles:{drawMarkerButton:"マーカーを描画",drawPolyButton:"ポリゴンを描画",drawLineButton:"折れ線を描画",drawCircleButton:"円を描画",drawRectButton:"矩形を描画",editButton:"レイヤーを編集",dragButton:"レイヤーをドラッグ",cutButton:"レイヤーを切り取り",deleteButton:"レイヤーを削除",drawCircleMarkerButton:"円マーカーを描画",snappingButton:"ドラッグしたマーカーを他のレイヤーや頂点にスナップする",pinningButton:"共有する頂点を同時に動かす",rotateButton:"レイヤーを回転",drawTextButton:"テキストを描画"}},Nr={tooltips:{placeMarker:"Klikkaa asettaaksesi merkin",firstVertex:"Klikkaa asettaakseni ensimmäisen osuuden",continueLine:"Klikkaa jatkaaksesi piirtämistä",finishLine:"Klikkaa olemassa olevaa merkkiä lopettaaksesi",finishPoly:"Klikkaa ensimmäistä merkkiä lopettaaksesi",finishRect:"Klikkaa lopettaaksesi",startCircle:"Klikkaa asettaaksesi ympyrän keskipisteen",finishCircle:"Klikkaa lopettaaksesi ympyrän",placeCircleMarker:"Klikkaa asettaaksesi ympyrämerkin",placeText:"Klikkaa asettaaksesi tekstin"},actions:{finish:"Valmis",cancel:"Peruuta",removeLastVertex:"Poista viimeinen osuus"},buttonTitles:{drawMarkerButton:"Piirrä merkkejä",drawPolyButton:"Piirrä monikulmioita",drawLineButton:"Piirrä viivoja",drawCircleButton:"Piirrä ympyrä",drawRectButton:"Piirrä neliskulmioita",editButton:"Muokkaa",dragButton:"Siirrä",cutButton:"Leikkaa",deleteButton:"Poista",drawCircleMarkerButton:"Piirrä ympyrämerkki",snappingButton:"Kiinnitä siirrettävä merkki toisiin muotoihin",pinningButton:"Kiinnitä jaetut muodot yhteen",rotateButton:"Käännä",drawTextButton:"Piirrä tekstiä"}},jo={tooltips:{placeMarker:"마커 위치를 클릭하세요",firstVertex:"첫번째 꼭지점 위치을 클릭하세요",continueLine:"계속 그리려면 클릭하세요",finishLine:"끝내려면 기존 마커를 클릭하세요",finishPoly:"끝내려면 처음 마커를 클릭하세요",finishRect:"끝내려면 클릭하세요",startCircle:"원의 중심이 될 위치를 클릭하세요",finishCircle:"원을 끝내려면 클릭하세요",placeCircleMarker:"원 마커 위치를 클릭하세요",placeText:"텍스트 위치를 클릭하세요"},actions:{finish:"끝내기",cancel:"취소",removeLastVertex:"마지막 꼭지점 제거"},buttonTitles:{drawMarkerButton:"마커 그리기",drawPolyButton:"다각형 그리기",drawLineButton:"다각선 그리기",drawCircleButton:"원 그리기",drawRectButton:"직사각형 그리기",editButton:"레이어 편집하기",dragButton:"레이어 끌기",cutButton:"레이어 자르기",deleteButton:"레이어 제거하기",drawCircleMarkerButton:"원 마커 그리기",snappingButton:"잡아끈 마커를 다른 레이어 및 꼭지점에 들러붙게 하기",pinningButton:"공유 꼭지점을 함께 찍기",rotateButton:"레이어 회전하기",drawTextButton:"텍스트 그리기"}},ol={tooltips:{placeMarker:"Маркерди жайгаштыруу үчүн басыңыз",firstVertex:"Биринчи чокуну жайгаштырууну үчүн басыңыз",continueLine:"Сүрөт тартууну улантуу үчүн басыңыз",finishLine:"Аяктоо үчүн учурдагы маркерди басыңыз",finishPoly:"Бүтүрүү үчүн биринчи маркерди басыңыз",finishRect:"Бүтүрүү үчүн басыңыз",startCircle:"Айлананын борборун жайгаштырууну үчүн басыңыз",finishCircle:"Айлананы бүтүрүү үчүн басыңыз",placeCircleMarker:"Тегерек маркерди жайгаштыруу үчүн басыңыз",placeText:"Текстти жайгаштыруу үчүн басыңыз"},actions:{finish:"Аягы",cancel:"Жок кылуу",removeLastVertex:"Акыркы чокуну өчүрүү"},buttonTitles:{drawMarkerButton:"Маркерди чизуу",drawPolyButton:"Полигон чизуу",drawLineButton:"Полилиния чизуу",drawCircleButton:"Дайынды чизуу",drawRectButton:"Прямоугольник чизуу",editButton:"Слоопту түзөтүү",dragButton:"Слоопту карап сүйлөү",cutButton:"Слооптун башын кесүү",deleteButton:"Слооптун өчүрүү",drawCircleMarkerButton:"Дайынды маркерди чизуу",snappingButton:"Башка слооптордун жана вертекстердин арасына чекилдөө",pinningButton:"Бөлүшкөн вертекстерди бирге тутуштуруу",rotateButton:"Слооптун өзгөртүү",drawTextButton:"Текст чизуу",scaleButton:"Слооптун өлчөмүн өзгөртүү",autoTracingButton:"Автоматтык тизмеги чизуу"},measurements:{totalLength:"Узундук",segmentLength:"Сегмент узундугу",area:"Аймак",radius:"Радиус",perimeter:"Периметр",height:"Диаметр",width:"Кенчилик",coordinates:"Координаттар",coordinatesMarker:"Маркердин координаттары"}},sl=Is,Gs={en:_r,de:Yr,it:_n,id:tn,ro:ai,ru:fo,es:xo,nl:Mi,fr:fs,pt:sl,pt_br:di,pt_pt:Is,zh:Qo,zh_tw:Ro,pl:Fo,sv:eo,el:Lo,hu:Vs,da:va,no:to,fa:il,ua:ya,tr:gr,cz:br,ja:Jr,fi:Nr,ko:jo,ky:ol},Ua={_globalEditModeEnabled:!1,enableGlobalEditMode(l){let h={...l};this._globalEditModeEnabled=!0,this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),L.PM.Utils.findLayers(this.map).forEach(v=>{this._isRelevantForEdit(v)&&v.pm.enable(h)}),this.throttledReInitEdit||(this.throttledReInitEdit=L.Util.throttle(this.handleLayerAdditionInGlobalEditMode,100,this)),this._addedLayersEdit={},this.map.on("layeradd",this._layerAddedEdit,this),this.map.on("layeradd",this.throttledReInitEdit,this),this._fireGlobalEditModeToggled(!0)},disableGlobalEditMode(){this._globalEditModeEnabled=!1,L.PM.Utils.findLayers(this.map).forEach(l=>{l.pm.disable()}),this.map.off("layeradd",this._layerAddedEdit,this),this.map.off("layeradd",this.throttledReInitEdit,this),this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),this._fireGlobalEditModeToggled(!1)},globalEditEnabled(){return this.globalEditModeEnabled()},globalEditModeEnabled(){return this._globalEditModeEnabled},toggleGlobalEditMode(l=this.globalOptions){this.globalEditModeEnabled()?this.disableGlobalEditMode():this.enableGlobalEditMode(l)},handleLayerAdditionInGlobalEditMode(){let l=this._addedLayersEdit;if(this._addedLayersEdit={},this.globalEditModeEnabled())for(let h in l){let v=l[h];this._isRelevantForEdit(v)&&v.pm.enable({...this.globalOptions})}},_layerAddedEdit({layer:l}){this._addedLayersEdit[L.stamp(l)]=l},_isRelevantForEdit(l){return l.pm&&!(l instanceof L.LayerGroup)&&(!L.PM.optIn&&!l.options.pmIgnore||L.PM.optIn&&l.options.pmIgnore===!1)&&!l._pmTempLayer&&l.pm.options.allowEditing}},bu=Ua,Ml={_globalDragModeEnabled:!1,enableGlobalDragMode(){let l=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!0,this._addedLayersDrag={},l.forEach(h=>{this._isRelevantForDrag(h)&&h.pm.enableLayerDrag()}),this.throttledReInitDrag||(this.throttledReInitDrag=L.Util.throttle(this.reinitGlobalDragMode,100,this)),this.map.on("layeradd",this._layerAddedDrag,this),this.map.on("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!0)},disableGlobalDragMode(){let l=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!1,l.forEach(h=>{h.pm.disableLayerDrag()}),this.map.off("layeradd",this._layerAddedDrag,this),this.map.off("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!1)},globalDragModeEnabled(){return!!this._globalDragModeEnabled},toggleGlobalDragMode(){this.globalDragModeEnabled()?this.disableGlobalDragMode():this.enableGlobalDragMode()},reinitGlobalDragMode(){let l=this._addedLayersDrag;if(this._addedLayersDrag={},this.globalDragModeEnabled())for(let h in l){let v=l[h];this._isRelevantForDrag(v)&&v.pm.enableLayerDrag()}},_layerAddedDrag({layer:l}){this._addedLayersDrag[L.stamp(l)]=l},_isRelevantForDrag(l){return l.pm&&!(l instanceof L.LayerGroup)&&(!L.PM.optIn&&!l.options.pmIgnore||L.PM.optIn&&l.options.pmIgnore===!1)&&!l._pmTempLayer&&l.pm.options.draggable}},Sr=Ml,qr={_globalRemovalModeEnabled:!1,enableGlobalRemovalMode(){this._globalRemovalModeEnabled=!0,this.map.eachLayer(l=>{this._isRelevantForRemoval(l)&&(l.pm.enabled()&&l.pm.disable(),l.on("click",this.removeLayer,this))}),this.throttledReInitRemoval||(this.throttledReInitRemoval=L.Util.throttle(this.handleLayerAdditionInGlobalRemovalMode,100,this)),this._addedLayersRemoval={},this.map.on("layeradd",this._layerAddedRemoval,this),this.map.on("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!0)},disableGlobalRemovalMode(){this._globalRemovalModeEnabled=!1,this.map.eachLayer(l=>{l.off("click",this.removeLayer,this)}),this.map.off("layeradd",this._layerAddedRemoval,this),this.map.off("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!1)},globalRemovalEnabled(){return this.globalRemovalModeEnabled()},globalRemovalModeEnabled(){return!!this._globalRemovalModeEnabled},toggleGlobalRemovalMode(){this.globalRemovalModeEnabled()?this.disableGlobalRemovalMode():this.enableGlobalRemovalMode()},removeLayer(l){let h=l.target;this._isRelevantForRemoval(h)&&!h.pm.dragging()&&(h.removeFrom(this.map.pm._getContainingLayer()),h.remove(),h instanceof L.LayerGroup?(this._fireRemoveLayerGroup(h),this._fireRemoveLayerGroup(this.map,h)):(h.pm._fireRemove(h),h.pm._fireRemove(this.map,h)))},_isRelevantForRemoval(l){return l.pm&&!(l instanceof L.LayerGroup)&&(!L.PM.optIn&&!l.options.pmIgnore||L.PM.optIn&&l.options.pmIgnore===!1)&&!l._pmTempLayer&&l.pm.options.allowRemoval},handleLayerAdditionInGlobalRemovalMode(){let l=this._addedLayersRemoval;if(this._addedLayersRemoval={},this.globalRemovalModeEnabled())for(let h in l){let v=l[h];this._isRelevantForRemoval(v)&&(v.pm.enabled()&&v.pm.disable(),v.on("click",this.removeLayer,this))}},_layerAddedRemoval({layer:l}){this._addedLayersRemoval[L.stamp(l)]=l}},Va=qr,Ku={_globalRotateModeEnabled:!1,enableGlobalRotateMode(){this._globalRotateModeEnabled=!0,L.PM.Utils.findLayers(this.map).filter(l=>l instanceof L.Polyline).forEach(l=>{this._isRelevantForRotate(l)&&l.pm.enableRotate()}),this.throttledReInitRotate||(this.throttledReInitRotate=L.Util.throttle(this.handleLayerAdditionInGlobalRotateMode,100,this)),this._addedLayersRotate={},this.map.on("layeradd",this._layerAddedRotate,this),this.map.on("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},disableGlobalRotateMode(){this._globalRotateModeEnabled=!1,L.PM.Utils.findLayers(this.map).filter(l=>l instanceof L.Polyline).forEach(l=>{l.pm.disableRotate()}),this.map.off("layeradd",this._layerAddedRotate,this),this.map.off("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},globalRotateModeEnabled(){return!!this._globalRotateModeEnabled},toggleGlobalRotateMode(){this.globalRotateModeEnabled()?this.disableGlobalRotateMode():this.enableGlobalRotateMode()},_isRelevantForRotate(l){return l.pm&&l instanceof L.Polyline&&!(l instanceof L.LayerGroup)&&(!L.PM.optIn&&!l.options.pmIgnore||L.PM.optIn&&l.options.pmIgnore===!1)&&!l._pmTempLayer&&l.pm.options.allowRotation},handleLayerAdditionInGlobalRotateMode(){let l=this._addedLayersRotate;if(this._addedLayersRotate={},this.globalRotateModeEnabled())for(let h in l){let v=l[h];this._isRelevantForRemoval(v)&&v.pm.enableRotate()}},_layerAddedRotate({layer:l}){this._addedLayersRotate[L.stamp(l)]=l}},Al=Ku,Jl=f(_i()),al={_fireDrawStart(l="Draw",h={}){this.__fire(this._map,"pm:drawstart",{shape:this._shape,workingLayer:this._layer},l,h)},_fireDrawEnd(l="Draw",h={}){this.__fire(this._map,"pm:drawend",{shape:this._shape},l,h)},_fireCreate(l,h="Draw",v={}){this.__fire(this._map,"pm:create",{shape:this._shape,marker:l,layer:l},h,v)},_fireCenterPlaced(l="Draw",h={}){let v=l==="Draw"?this._layer:void 0,w=l!=="Draw"?this._layer:void 0;this.__fire(this._layer,"pm:centerplaced",{shape:this._shape,workingLayer:v,layer:w,latlng:this._layer.getLatLng()},l,h)},_fireCut(l,h,v,w="Draw",C={}){this.__fire(l,"pm:cut",{shape:this._shape,layer:h,originalLayer:v},w,C)},_fireEdit(l=this._layer,h="Edit",v={}){this.__fire(l,"pm:edit",{layer:this._layer,shape:this.getShape()},h,v)},_fireEnable(l="Edit",h={}){this.__fire(this._layer,"pm:enable",{layer:this._layer,shape:this.getShape()},l,h)},_fireDisable(l="Edit",h={}){this.__fire(this._layer,"pm:disable",{layer:this._layer,shape:this.getShape()},l,h)},_fireUpdate(l="Edit",h={}){this.__fire(this._layer,"pm:update",{layer:this._layer,shape:this.getShape()},l,h)},_fireMarkerDragStart(l,h=void 0,v="Edit",w={}){this.__fire(this._layer,"pm:markerdragstart",{layer:this._layer,markerEvent:l,shape:this.getShape(),indexPath:h},v,w)},_fireMarkerDrag(l,h=void 0,v="Edit",w={}){this.__fire(this._layer,"pm:markerdrag",{layer:this._layer,markerEvent:l,shape:this.getShape(),indexPath:h},v,w)},_fireMarkerDragEnd(l,h=void 0,v=void 0,w="Edit",C={}){this.__fire(this._layer,"pm:markerdragend",{layer:this._layer,markerEvent:l,shape:this.getShape(),indexPath:h,intersectionReset:v},w,C)},_fireDragStart(l="Edit",h={}){this.__fire(this._layer,"pm:dragstart",{layer:this._layer,shape:this.getShape()},l,h)},_fireDrag(l,h="Edit",v={}){this.__fire(this._layer,"pm:drag",{...l,shape:this.getShape()},h,v)},_fireDragEnd(l="Edit",h={}){this.__fire(this._layer,"pm:dragend",{layer:this._layer,shape:this.getShape()},l,h)},_fireDragEnable(l="Edit",h={}){this.__fire(this._layer,"pm:dragenable",{layer:this._layer,shape:this.getShape()},l,h)},_fireDragDisable(l="Edit",h={}){this.__fire(this._layer,"pm:dragdisable",{layer:this._layer,shape:this.getShape()},l,h)},_fireRemove(l,h=l,v="Edit",w={}){this.__fire(l,"pm:remove",{layer:h,shape:this.getShape()},v,w)},_fireVertexAdded(l,h,v,w="Edit",C={}){this.__fire(this._layer,"pm:vertexadded",{layer:this._layer,workingLayer:this._layer,marker:l,indexPath:h,latlng:v,shape:this.getShape()},w,C)},_fireVertexRemoved(l,h,v="Edit",w={}){this.__fire(this._layer,"pm:vertexremoved",{layer:this._layer,marker:l,indexPath:h,shape:this.getShape()},v,w)},_fireVertexClick(l,h,v="Edit",w={}){this.__fire(this._layer,"pm:vertexclick",{layer:this._layer,markerEvent:l,indexPath:h,shape:this.getShape()},v,w)},_fireIntersect(l,h=this._layer,v="Edit",w={}){this.__fire(h,"pm:intersect",{layer:this._layer,intersection:l,shape:this.getShape()},v,w)},_fireLayerReset(l,h,v="Edit",w={}){this.__fire(this._layer,"pm:layerreset",{layer:this._layer,markerEvent:l,indexPath:h,shape:this.getShape()},v,w)},_fireChange(l,h="Edit",v={}){this.__fire(this._layer,"pm:change",{layer:this._layer,latlngs:l,shape:this.getShape()},h,v)},_fireTextChange(l,h="Edit",v={}){this.__fire(this._layer,"pm:textchange",{layer:this._layer,text:l,shape:this.getShape()},h,v)},_fireTextFocus(l="Edit",h={}){this.__fire(this._layer,"pm:textfocus",{layer:this._layer,shape:this.getShape()},l,h)},_fireTextBlur(l="Edit",h={}){this.__fire(this._layer,"pm:textblur",{layer:this._layer,shape:this.getShape()},l,h)},_fireSnapDrag(l,h,v="Snapping",w={}){this.__fire(l,"pm:snapdrag",h,v,w)},_fireSnap(l,h,v="Snapping",w={}){this.__fire(l,"pm:snap",h,v,w)},_fireUnsnap(l,h,v="Snapping",w={}){this.__fire(l,"pm:unsnap",h,v,w)},_fireRotationEnable(l,h,v="Rotation",w={}){this.__fire(l,"pm:rotateenable",{layer:this._layer,helpLayer:this._rotatePoly,shape:this.getShape()},v,w)},_fireRotationDisable(l,h="Rotation",v={}){this.__fire(l,"pm:rotatedisable",{layer:this._layer,shape:this.getShape()},h,v)},_fireRotationStart(l,h,v="Rotation",w={}){this.__fire(l,"pm:rotatestart",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:this._startAngle,originLatLngs:h},v,w)},_fireRotation(l,h,v,w=this._rotationLayer,C="Rotation",z={}){this.__fire(l,"pm:rotate",{layer:w,helpLayer:this._layer,startAngle:this._startAngle,angle:w.pm.getAngle(),angleDiff:h,oldLatLngs:v,newLatLngs:w.getLatLngs()},C,z)},_fireRotationEnd(l,h,v,w="Rotation",C={}){this.__fire(l,"pm:rotateend",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:h,angle:this._rotationLayer.pm.getAngle(),originLatLngs:v,newLatLngs:this._rotationLayer.getLatLngs()},w,C)},_fireActionClick(l,h,v,w="Toolbar",C={}){this.__fire(this._map,"pm:actionclick",{text:l.text,action:l,btnName:h,button:v},w,C)},_fireButtonClick(l,h,v="Toolbar",w={}){this.__fire(this._map,"pm:buttonclick",{btnName:l,button:h},v,w)},_fireLangChange(l,h,v,w,C="Global",z={}){this.__fire(this.map,"pm:langchange",{oldLang:l,activeLang:h,fallback:v,translations:w},C,z)},_fireGlobalDragModeToggled(l,h="Global",v={}){this.__fire(this.map,"pm:globaldragmodetoggled",{enabled:l,map:this.map},h,v)},_fireGlobalEditModeToggled(l,h="Global",v={}){this.__fire(this.map,"pm:globaleditmodetoggled",{enabled:l,map:this.map},h,v)},_fireGlobalRemovalModeToggled(l,h="Global",v={}){this.__fire(this.map,"pm:globalremovalmodetoggled",{enabled:l,map:this.map},h,v)},_fireGlobalCutModeToggled(l="Global",h={}){this.__fire(this._map,"pm:globalcutmodetoggled",{enabled:!!this._enabled,map:this._map},l,h)},_fireGlobalDrawModeToggled(l="Global",h={}){this.__fire(this._map,"pm:globaldrawmodetoggled",{enabled:this._enabled,shape:this._shape,map:this._map},l,h)},_fireGlobalRotateModeToggled(l="Global",h={}){this.__fire(this.map,"pm:globalrotatemodetoggled",{enabled:this.globalRotateModeEnabled(),map:this.map},l,h)},_fireRemoveLayerGroup(l,h=l,v="Edit",w={}){this.__fire(l,"pm:remove",{layer:h,shape:void 0},v,w)},_fireKeyeventEvent(l,h,v,w="Global",C={}){this.__fire(this.map,"pm:keyevent",{event:l,eventType:h,focusOn:v},w,C)},__fire(l,h,v,w,C={}){v=(0,Jl.default)(v,C,{source:w}),L.PM.Utils._fireEvent(l,h,v)}},kl=al,Xl=()=>({_lastEvents:{keydown:void 0,keyup:void 0,current:void 0},_initKeyListener(l){this.map=l,L.DomEvent.on(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.on(window,"blur",this._onBlur,this),l.once("unload",this._unbindKeyListenerEvents,this)},_unbindKeyListenerEvents(){L.DomEvent.off(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.off(window,"blur",this._onBlur,this)},_onKeyListener(l){let h="document";this.map.getContainer().contains(l.target)&&(h="map");let v={event:l,eventType:l.type,focusOn:h};this._lastEvents[l.type]=v,this._lastEvents.current=v,this.map.pm._fireKeyeventEvent(l,l.type,h)},_onBlur(l){l.altKey=!1;let h={event:l,eventType:l.type,focusOn:"document"};this._lastEvents[l.type]=h,this._lastEvents.current=h},getLastKeyEvent(l="current"){return this._lastEvents[l]},isShiftKeyPressed(){var l;return(l=this._lastEvents.current)==null?void 0:l.event.shiftKey},isAltKeyPressed(){var l;return(l=this._lastEvents.current)==null?void 0:l.event.altKey},isCtrlKeyPressed(){var l;return(l=this._lastEvents.current)==null?void 0:l.event.ctrlKey},isMetaKeyPressed(){var l;return(l=this._lastEvents.current)==null?void 0:l.event.metaKey},getPressedKey(){var l;return(l=this._lastEvents.current)==null?void 0:l.event.key}}),Xr=Xl,no=f(ci());function or(l){let h=L.PM.activeLang;return(0,no.default)(Gs[h],l)||(0,no.default)(Gs.en,l)||l}function ro(l){for(let h=0;h<l.length;h+=1){let v=l[h];if(Array.isArray(v)){if(ro(v))return!0}else if(v!=null&&v!=="")return!0}return!1}function ll(l){return l.reduce((h,v)=>{if(v.length!==0){let w=Array.isArray(v)?ll(v):v;Array.isArray(w)?w.length!==0&&h.push(w):h.push(w)}return h},[])}function _a(l,h,v){let w={a:L.CRS.Earth.R,b:63567523142e-4,f:.0033528106647474805},{a:C,b:z,f:X}=w,re=l.lng,he=l.lat,Se=v,Je=Math.PI,ze=h*Je/180,vt=Math.sin(ze),kt=Math.cos(ze),Xt=(1-X)*Math.tan(he*Je/180),yn=1/Math.sqrt(1+Xt*Xt),bn=Xt*yn,ur=Math.atan2(Xt,kt),Ye=yn*vt,nt=1-Ye*Ye,ht=nt*(C*C-z*z)/(z*z),Ot=1+ht/16384*(4096+ht*(-768+ht*(320-175*ht))),bt=ht/1024*(256+ht*(-128+ht*(74-47*ht))),Tt=Se/(z*Ot),ve=2*Math.PI,Me,Be,Oe;for(;Math.abs(Tt-ve)>1e-12;){Me=Math.cos(2*ur+Tt),Be=Math.sin(Tt),Oe=Math.cos(Tt);let on=bt*Be*(Me+bt/4*(Oe*(-1+2*Me*Me)-bt/6*Me*(-3+4*Be*Be)*(-3+4*Me*Me)));ve=Tt,Tt=Se/(z*Ot)+on}let Fe=bn*Be-yn*Oe*kt,je=Math.atan2(bn*Oe+yn*Be*kt,(1-X)*Math.sqrt(Ye*Ye+Fe*Fe)),ut=Math.atan2(Be*vt,yn*Oe-bn*Be*kt),ct=X/16*nt*(4+X*(4-3*nt)),gt=ut-(1-ct)*X*Ye*(Tt+ct*Be*(Me+ct*Oe*(-1+2*Me*Me))),St=re+gt*180/Je,Ct=je*180/Je;return L.latLng(St,Ct)}function Ui(l,h,v,w,C=!0){let z,X,re,he=[];for(let Se=0;Se<v;Se+=1){if(C)z=Se*360/v+w,X=_a(l,z,h),re=L.latLng(X.lng,X.lat);else{let Je=l.lat+Math.cos(2*Se*Math.PI/v)*h,ze=l.lng+Math.sin(2*Se*Math.PI/v)*h;re=L.latLng(Je,ze)}he.push(re)}return he}function Ql(l,h,v){h=(h+360)%360;let w=Math.PI/180,C=180/Math.PI,{R:z}=L.CRS.Earth,X=l.lng*w,re=l.lat*w,he=h*w,Se=Math.sin(re),Je=Math.cos(re),ze=Math.cos(v/z),vt=Math.sin(v/z),kt=Math.asin(Se*ze+Je*vt*Math.cos(he)),Xt=X+Math.atan2(Math.sin(he)*vt*Je,ze-Se*Math.sin(kt));Xt*=C;let yn=Xt-360,bn=Xt<-180?Xt+360:Xt;return Xt=Xt>180?yn:bn,L.latLng([kt*C,Xt])}function ta(l,h,v){let w=l.latLngToContainerPoint(h),C=l.latLngToContainerPoint(v),z=Math.atan2(C.y-w.y,C.x-w.x)*180/Math.PI+90;return z+=z<0?360:0,z}function Tl(l,h,v,w){let C=ta(l,h,v);return Ql(h,C,w)}function Nl(l,h,v="asc"){if(!h||Object.keys(h).length===0)return(he,Se)=>he-Se;let w=Object.keys(h),C,z=w.length-1,X={};for(;z>=0;)C=w[z],X[C.toLowerCase()]=h[C],z-=1;function re(he){if(he instanceof L.Marker)return"Marker";if(he instanceof L.Circle)return"Circle";if(he instanceof L.CircleMarker)return"CircleMarker";if(he instanceof L.Rectangle)return"Rectangle";if(he instanceof L.Polygon)return"Polygon";if(he instanceof L.Polyline)return"Line"}return(he,Se)=>{let Je,ze;if(Je=re(he.layer).toLowerCase(),ze=re(Se.layer).toLowerCase(),!Je||!ze)return 0;let vt=Je in X?X[Je]:Number.MAX_SAFE_INTEGER,kt=ze in X?X[ze]:Number.MAX_SAFE_INTEGER,Xt=0;return vt<kt?Xt=-1:vt>kt&&(Xt=1),v==="desc"?Xt*-1:Xt}}function Os(l,h=l.getLatLngs()){return l instanceof L.Polygon?L.polygon(h).getLatLngs():L.polyline(h).getLatLngs()}function Dl(l,h){var v,w,C,z;if((w=(v=h.options.crs)==null?void 0:v.projection)!=null&&w.MAX_LATITUDE){let X=(z=(C=h.options.crs)==null?void 0:C.projection)==null?void 0:z.MAX_LATITUDE;l.lat=Math.max(Math.min(X,l.lat),-X)}return l}function bi(l){return l.options.renderer||l._map&&(l._map._getPaneRenderer(l.options.pane)||l._map.options.renderer||l._map._renderer)||l._renderer}var Yu=L.Class.extend({includes:[bu,Sr,Va,Al,kl],initialize(l){this.map=l,this.Draw=new L.PM.Draw(l),this.Toolbar=new L.PM.Toolbar(l),this.Keyboard=Xr(),this.globalOptions={snappable:!0,layerGroup:void 0,snappingOrder:["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],panes:{vertexPane:"markerPane",layerPane:"overlayPane",markerPane:"markerPane"},draggable:!0},this.Keyboard._initKeyListener(l)},setLang(l="en",h,v="en"){if(l=l.trim().toLowerCase(),!/^[a-z]{2}$/.test(l)){let C=l.replace(/[-_\s]/g,"-").replace(/^(\w{2})$/,"$1-").match(/([a-z]{2})-?([a-z]{2})?/);if(C){let z=[`${C[1]}_${C[2]}`,`${C[1]}`];for(let X of z)if(Gs[X]){l=X;break}}}let w=L.PM.activeLang;h&&(Gs[l]=(0,Gn.default)(Gs[v],h)),L.PM.activeLang=l,this.map.pm.Toolbar.reinit(),this._fireLangChange(w,l,v,Gs[l])},addControls(l){this.Toolbar.addControls(l)},removeControls(){this.Toolbar.removeControls()},toggleControls(){this.Toolbar.toggleControls()},controlsVisible(){return this.Toolbar.isVisible},enableDraw(l="Polygon",h){l==="Poly"&&(l="Polygon"),this.Draw.enable(l,h)},disableDraw(l="Polygon"){l==="Poly"&&(l="Polygon"),this.Draw.disable(l)},setPathOptions(l,h={}){let v=h.ignoreShapes||[],w=h.merge||!1;this.map.pm.Draw.shapes.forEach(C=>{v.indexOf(C)===-1&&this.map.pm.Draw[C].setPathOptions(l,w)})},getGlobalOptions(){return this.globalOptions},setGlobalOptions(l){let h=(0,Gn.default)(this.globalOptions,l);h.editable&&(h.resizeableCircleMarker=h.editable,delete h.editable);let v=!1;this.map.pm.Draw.CircleMarker.enabled()&&!!this.map.pm.Draw.CircleMarker.options.resizeableCircleMarker!=!!h.resizeableCircleMarker&&(this.map.pm.Draw.CircleMarker.disable(),v=!0);let w=!1;this.map.pm.Draw.Circle.enabled()&&!!this.map.pm.Draw.Circle.options.resizeableCircle!=!!h.resizeableCircle&&(this.map.pm.Draw.Circle.disable(),w=!0),this.map.pm.Draw.shapes.forEach(C=>{this.map.pm.Draw[C].setOptions(h)}),v&&this.map.pm.Draw.CircleMarker.enable(),w&&this.map.pm.Draw.Circle.enable(),L.PM.Utils.findLayers(this.map).forEach(C=>{C.pm.setOptions(h)}),this.map.fire("pm:globaloptionschanged"),this.globalOptions=h,this.applyGlobalOptions()},applyGlobalOptions(){L.PM.Utils.findLayers(this.map).forEach(l=>{l.pm.enabled()&&l.pm.applyOptions()})},globalDrawModeEnabled(){return!!this.Draw.getActiveShape()},globalCutModeEnabled(){return!!this.Draw.Cut.enabled()},enableGlobalCutMode(l){return this.Draw.Cut.enable(l)},toggleGlobalCutMode(l){return this.Draw.Cut.toggle(l)},disableGlobalCutMode(){return this.Draw.Cut.disable()},getGeomanLayers(l=!1){let h=L.PM.Utils.findLayers(this.map);if(!l)return h;let v=L.featureGroup();return v._pmTempLayer=!0,h.forEach(w=>{v.addLayer(w)}),v},getGeomanDrawLayers(l=!1){let h=L.PM.Utils.findLayers(this.map).filter(w=>w._drawnByGeoman===!0);if(!l)return h;let v=L.featureGroup();return v._pmTempLayer=!0,h.forEach(w=>{v.addLayer(w)}),v},_getContainingLayer(){return this.globalOptions.layerGroup&&this.globalOptions.layerGroup instanceof L.LayerGroup?this.globalOptions.layerGroup:this.map},_isCRSSimple(){return this.map.options.crs===L.CRS.Simple},_touchEventCounter:0,_addTouchEvents(l){this._touchEventCounter===0&&(L.DomEvent.on(l,"touchmove",this._canvasTouchMove,this),L.DomEvent.on(l,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter+=1},_removeTouchEvents(l){this._touchEventCounter===1&&(L.DomEvent.off(l,"touchmove",this._canvasTouchMove,this),L.DomEvent.off(l,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter=this._touchEventCounter<=1?0:this._touchEventCounter-1},_canvasTouchMove(l){bi(this.map)._onMouseMove(this._createMouseEvent("mousemove",l))},_canvasTouchClick(l){let h="";l.type==="touchstart"||l.type==="pointerdown"?h="mousedown":(l.type==="touchend"||l.type==="pointerup"||l.type==="touchcancel"||l.type==="pointercancel")&&(h="mouseup"),h&&bi(this.map)._onClick(this._createMouseEvent(h,l))},_createMouseEvent(l,h){let v,w=h.touches[0]||h.changedTouches[0];try{v=new MouseEvent(l,{bubbles:h.bubbles,cancelable:h.cancelable,view:h.view,detail:w.detail,screenX:w.screenX,screenY:w.screenY,clientX:w.clientX,clientY:w.clientY,ctrlKey:h.ctrlKey,altKey:h.altKey,shiftKey:h.shiftKey,metaKey:h.metaKey,button:h.button,relatedTarget:h.relatedTarget})}catch{v=document.createEvent("MouseEvents"),v.initMouseEvent(l,h.bubbles,h.cancelable,h.view,w.detail,w.screenX,w.screenY,w.clientX,w.clientY,h.ctrlKey,h.altKey,h.shiftKey,h.metaKey,h.button,h.relatedTarget)}return v}}),Mo=Yu,Hs=L.Control.extend({includes:[kl],options:{position:"topleft",disableByOtherButtons:!0},initialize(l){this._button=L.Util.extend({},this.options,l)},onAdd(l){return this._map=l,this._map.pm.Toolbar.options.oneBlock?this._container=this._map.pm.Toolbar._createContainer(this.options.position):this._button.tool==="edit"?this._container=this._map.pm.Toolbar.editContainer:this._button.tool==="options"?this._container=this._map.pm.Toolbar.optionsContainer:this._button.tool==="custom"?this._container=this._map.pm.Toolbar.customContainer:this._container=this._map.pm.Toolbar.drawContainer,this._renderButton(),this._container},_renderButton(){let l=this.buttonsDomNode;this.buttonsDomNode=this._makeButton(this._button),l?l.replaceWith(this.buttonsDomNode):this._container.appendChild(this.buttonsDomNode)},onRemove(){return this.buttonsDomNode.remove(),this._container},getText(){return this._button.text},getIconUrl(){return this._button.iconUrl},destroy(){this._button={},this._update()},toggle(l){return typeof l=="boolean"?this._button.toggleStatus=l:this._button.toggleStatus=!this._button.toggleStatus,this._applyStyleClasses(),this._updateActiveAction(this._button),this._button.toggleStatus},toggled(){return this._button.toggleStatus},onCreate(){this.toggle(!1)},disable(){this.toggle(!1),this._button.disabled=!0,this._updateDisabled()},enable(){this._button.disabled=!1,this._updateDisabled(),this._updateActiveAction(this._button)},_triggerClick(l){l&&l.preventDefault(),!this._button.disabled&&(this._button.onClick(l,{button:this,event:l}),this._clicked(l),this._button.afterClick(l,{button:this,event:l}))},_makeButton(l){let h=this.options.position.indexOf("right")>-1?"pos-right":"",v=L.DomUtil.create("div",`button-container  ${h}`,this._container);l.title&&v.setAttribute("title",l.title);let w=L.DomUtil.create("a","leaflet-buttons-control-button",v);w.setAttribute("role","button"),w.setAttribute("tabindex","0"),w.href="#";let C=L.DomUtil.create("div",`leaflet-pm-actions-container ${h}`,v),z=l.actions,X={cancel:{text:or("actions.cancel"),title:or("actions.cancel"),onClick(){this._triggerClick()}},finishMode:{text:or("actions.finish"),title:or("actions.finish"),onClick(){this._triggerClick()}},removeLastVertex:{text:or("actions.removeLastVertex"),title:or("actions.removeLastVertex"),onClick(){this._map.pm.Draw[l.jsClass]._removeLastVertex()}},finish:{text:or("actions.finish"),title:or("actions.finish"),onClick(he){this._map.pm.Draw[l.jsClass]._finishShape(he)}}};l._preparedActions=z.map(he=>{let Se=typeof he=="string"?he:he.name,Je;if(X[Se])Je=X[Se];else if(he.text)Je=he;else return Je;let ze=L.DomUtil.create("a",`leaflet-pm-action ${h} action-${Se}`,C);if(ze.setAttribute("role","button"),ze.setAttribute("tabindex","0"),ze.href="#",Je.title&&(ze.title=Je.title),ze.innerHTML=Je.text,L.DomEvent.disableClickPropagation(ze),L.DomEvent.on(ze,"click",L.DomEvent.stop),Je._node=ze,!l.disabled&&Je.onClick){let vt=kt=>{kt.preventDefault();let Xt="",{buttons:yn}=this._map.pm.Toolbar;for(let bn in yn)if(yn[bn]._button===l){Xt=bn;break}this._fireActionClick(Je,Xt,l)};L.DomEvent.addListener(ze,"click",vt,this),L.DomEvent.addListener(ze,"click",Je.onClick,this),L.DomEvent.addListener(ze,"click",()=>this._updateActiveAction(l))}return Je}),this._updateActiveAction(l),l.toggleStatus&&L.DomUtil.addClass(v,"active");let re=L.DomUtil.create("div","control-icon",w);return l.iconUrl&&re.setAttribute("src",l.iconUrl),l.className&&L.DomUtil.addClass(re,l.className),L.DomEvent.disableClickPropagation(w),L.DomEvent.on(w,"click",L.DomEvent.stop),l.disabled||(L.DomEvent.addListener(w,"click",this._onBtnClick,this),L.DomEvent.addListener(w,"click",this._triggerClick,this)),l.disabled&&(L.DomUtil.addClass(w,"pm-disabled"),w.setAttribute("aria-disabled","true")),v},_applyStyleClasses(){this._container&&(!this._button.toggleStatus||this._button.cssToggle===!1?(L.DomUtil.removeClass(this.buttonsDomNode,"active"),L.DomUtil.removeClass(this._container,"activeChild")):(L.DomUtil.addClass(this.buttonsDomNode,"active"),L.DomUtil.addClass(this._container,"activeChild")))},_onBtnClick(){if(this._button.disabled)return;this._button.disableOtherButtons&&this._map.pm.Toolbar.triggerClickOnToggledButtons(this);let l="",{buttons:h}=this._map.pm.Toolbar;for(let v in h)if(h[v]._button===this._button){l=v;break}this._fireButtonClick(l,this._button)},_clicked(){this._button.doToggle&&this.toggle()},_updateDisabled(){if(!this._container)return;let l="pm-disabled",h=this.buttonsDomNode.children[0];this._button.disabled?(L.DomUtil.addClass(h,l),h.setAttribute("aria-disabled","true")):(L.DomUtil.removeClass(h,l),h.setAttribute("aria-disabled","false"))},_updateActiveAction(l){var h;(h=l._preparedActions)==null||h.forEach(v=>{v!=null&&v._node&&(v.isActive&&v.isActive.call(this)?L.DomUtil.addClass(v._node,"active-action"):L.DomUtil.removeClass(v._node,"active-action"))})}}),Il=Hs;L.Control.PMButton=Il;var qs=L.Class.extend({options:{drawMarker:!0,drawRectangle:!0,drawPolyline:!0,drawPolygon:!0,drawCircle:!0,drawCircleMarker:!0,drawText:!0,editMode:!0,dragMode:!0,cutPolygon:!0,removalMode:!0,rotateMode:!0,snappingOption:!0,drawControls:!0,editControls:!0,optionsControls:!0,customControls:!0,oneBlock:!1,position:"topleft",positions:{draw:"",edit:"",options:"",custom:""}},customButtons:[],initialize(l){this.customButtons=[],this.options.positions={draw:"",edit:"",options:"",custom:""},this.init(l)},reinit(){let l=this.isVisible;this.removeControls(),this._defineButtons(),l&&this.addControls()},init(l){this.map=l,this.buttons={},this.isVisible=!1,this.drawContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-draw leaflet-bar leaflet-control"),this.editContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-edit leaflet-bar leaflet-control"),this.optionsContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-options leaflet-bar leaflet-control"),this.customContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-custom leaflet-bar leaflet-control"),this._defineButtons()},_createContainer(l){let h=`${l}Container`;return this[h]||(this[h]=L.DomUtil.create("div",`leaflet-pm-toolbar leaflet-pm-${l} leaflet-bar leaflet-control`)),this[h]},getButtons(){return this.buttons},addControls(l=this.options){typeof l.editPolygon<"u"&&(l.editMode=l.editPolygon),typeof l.deleteLayer<"u"&&(l.removalMode=l.deleteLayer),L.Util.setOptions(this,l),this.applyIconStyle(),this.isVisible=!0,this._showHideButtons()},applyIconStyle(){let l=this.getButtons(),h={geomanIcons:{drawMarker:"control-icon leaflet-pm-icon-marker",drawPolyline:"control-icon leaflet-pm-icon-polyline",drawRectangle:"control-icon leaflet-pm-icon-rectangle",drawPolygon:"control-icon leaflet-pm-icon-polygon",drawCircle:"control-icon leaflet-pm-icon-circle",drawCircleMarker:"control-icon leaflet-pm-icon-circle-marker",editMode:"control-icon leaflet-pm-icon-edit",dragMode:"control-icon leaflet-pm-icon-drag",cutPolygon:"control-icon leaflet-pm-icon-cut",removalMode:"control-icon leaflet-pm-icon-delete",drawText:"control-icon leaflet-pm-icon-text"}};for(let v in l){let w=l[v];L.Util.setOptions(w,{className:h.geomanIcons[v]})}},removeControls(){let l=this.getButtons();for(let h in l)l[h].remove();this.isVisible=!1},toggleControls(l=this.options){this.isVisible?this.removeControls():this.addControls(l)},_addButton(l,h){return this.buttons[l]=h,this.options[l]=!!this.options[l]||!1,this.buttons[l]},triggerClickOnToggledButtons(l){for(let h in this.buttons){let v=this.buttons[h];v._button.disableByOtherButtons&&v!==l&&v.toggled()&&v._triggerClick()}},toggleButton(l,h,v=!0){l==="editPolygon"&&(l="editMode"),l==="deleteLayer"&&(l="removalMode");let w=l;return v&&this.triggerClickOnToggledButtons(this.buttons[w]),this.buttons[w]?this.buttons[w].toggle(h):!1},_defineButtons(){let l={className:"control-icon leaflet-pm-icon-marker",title:or("buttonTitles.drawMarkerButton"),jsClass:"Marker",onClick:()=>{},afterClick:(vt,kt)=>{this.map.pm.Draw[kt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},h={title:or("buttonTitles.drawPolyButton"),className:"control-icon leaflet-pm-icon-polygon",jsClass:"Polygon",onClick:()=>{},afterClick:(vt,kt)=>{this.map.pm.Draw[kt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},v={className:"control-icon leaflet-pm-icon-polyline",title:or("buttonTitles.drawLineButton"),jsClass:"Line",onClick:()=>{},afterClick:(vt,kt)=>{this.map.pm.Draw[kt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},w={title:or("buttonTitles.drawCircleButton"),className:"control-icon leaflet-pm-icon-circle",jsClass:"Circle",onClick:()=>{},afterClick:(vt,kt)=>{this.map.pm.Draw[kt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},C={title:or("buttonTitles.drawCircleMarkerButton"),className:"control-icon leaflet-pm-icon-circle-marker",jsClass:"CircleMarker",onClick:()=>{},afterClick:(vt,kt)=>{this.map.pm.Draw[kt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},z={title:or("buttonTitles.drawRectButton"),className:"control-icon leaflet-pm-icon-rectangle",jsClass:"Rectangle",onClick:()=>{},afterClick:(vt,kt)=>{this.map.pm.Draw[kt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},X={title:or("buttonTitles.editButton"),className:"control-icon leaflet-pm-icon-edit",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalEditMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},re={title:or("buttonTitles.dragButton"),className:"control-icon leaflet-pm-icon-drag",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalDragMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},he={title:or("buttonTitles.cutButton"),className:"control-icon leaflet-pm-icon-cut",jsClass:"Cut",onClick:()=>{},afterClick:(vt,kt)=>{this.map.pm.Draw[kt.button._button.jsClass].toggle({snappable:!0,cursorMarker:!0,allowSelfIntersection:!1})},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finish","removeLastVertex","cancel"]},Se={title:or("buttonTitles.deleteButton"),className:"control-icon leaflet-pm-icon-delete",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRemovalMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},Je={title:or("buttonTitles.rotateButton"),className:"control-icon leaflet-pm-icon-rotate",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRotateMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},ze={className:"control-icon leaflet-pm-icon-text",title:or("buttonTitles.drawTextButton"),jsClass:"Text",onClick:()=>{},afterClick:(vt,kt)=>{this.map.pm.Draw[kt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]};this._addButton("drawMarker",new L.Control.PMButton(l)),this._addButton("drawPolyline",new L.Control.PMButton(v)),this._addButton("drawRectangle",new L.Control.PMButton(z)),this._addButton("drawPolygon",new L.Control.PMButton(h)),this._addButton("drawCircle",new L.Control.PMButton(w)),this._addButton("drawCircleMarker",new L.Control.PMButton(C)),this._addButton("drawText",new L.Control.PMButton(ze)),this._addButton("editMode",new L.Control.PMButton(X)),this._addButton("dragMode",new L.Control.PMButton(re)),this._addButton("cutPolygon",new L.Control.PMButton(he)),this._addButton("removalMode",new L.Control.PMButton(Se)),this._addButton("rotateMode",new L.Control.PMButton(Je))},_showHideButtons(){if(!this.isVisible)return;this.removeControls(),this.isVisible=!0;let l=this.getButtons(),h=[];this.options.drawControls===!1&&(h=h.concat(Object.keys(l).filter(v=>!l[v]._button.tool))),this.options.editControls===!1&&(h=h.concat(Object.keys(l).filter(v=>l[v]._button.tool==="edit"))),this.options.optionsControls===!1&&(h=h.concat(Object.keys(l).filter(v=>l[v]._button.tool==="options"))),this.options.customControls===!1&&(h=h.concat(Object.keys(l).filter(v=>l[v]._button.tool==="custom")));for(let v in l)if(this.options[v]&&h.indexOf(v)===-1){let w=l[v]._button.tool;w||(w="draw"),l[v].setPosition(this._getBtnPosition(w)),l[v].addTo(this.map)}},_getBtnPosition(l){return this.options.positions&&this.options.positions[l]?this.options.positions[l]:this.options.position},setBlockPosition(l,h){this.options.positions[l]=h,this._showHideButtons(),this.changeControlOrder()},getBlockPositions(){return this.options.positions},copyDrawControl(l,h){if(h)typeof h!="object"&&(h={name:h});else throw new TypeError("Button has no name");let v=this._btnNameMapping(l);if(!h.name)throw new TypeError("Button has no name");if(this.buttons[h.name])throw new TypeError("Button with this name already exists");let w=this.map.pm.Draw.createNewDrawInstance(h.name,v);h={...this.buttons[v]._button,...h};let C=this.createCustomControl(h);return{drawInstance:w,control:C}},createCustomControl(l){if(!l.name)throw new TypeError("Button has no name");if(this.buttons[l.name])throw new TypeError("Button with this name already exists");l.onClick||(l.onClick=()=>{}),l.afterClick||(l.afterClick=()=>{}),l.toggle!==!1&&(l.toggle=!0),l.block&&(l.block=l.block.toLowerCase()),(!l.block||l.block==="draw")&&(l.block=""),l.className?l.className.indexOf("control-icon")===-1&&(l.className=`control-icon ${l.className}`):l.className="control-icon";let h={tool:l.block,className:l.className,title:l.title||"",jsClass:l.name,onClick:l.onClick,afterClick:l.afterClick,doToggle:l.toggle,toggleStatus:!1,disableOtherButtons:l.disableOtherButtons??!0,disableByOtherButtons:l.disableByOtherButtons??!0,cssToggle:l.toggle,position:this.options.position,actions:l.actions||[],disabled:!!l.disabled};this.options[l.name]!==!1&&(this.options[l.name]=!0);let v=this._addButton(l.name,new L.Control.PMButton(h));return this.changeControlOrder(),v},controlExists(l){return!!this.getButton(l)},getButton(l){return this.getButtons()[l]},getButtonsInBlock(l){let h={};if(l)for(let v in this.getButtons()){let w=this.getButtons()[v];(w._button.tool===l||l==="draw"&&!w._button.tool)&&(h[v]=w)}return h},changeControlOrder(l=[]){let h=this._shapeMapping(),v=[];l.forEach(z=>{h[z]?v.push(h[z]):v.push(z)});let w=this.getButtons(),C={};v.forEach(z=>{w[z]&&(C[z]=w[z])}),Object.keys(w).filter(z=>!w[z]._button.tool||w[z]._button.tool==="draw").forEach(z=>{v.indexOf(z)===-1&&(C[z]=w[z])}),Object.keys(w).filter(z=>w[z]._button.tool==="edit").forEach(z=>{v.indexOf(z)===-1&&(C[z]=w[z])}),Object.keys(w).filter(z=>w[z]._button.tool==="options").forEach(z=>{v.indexOf(z)===-1&&(C[z]=w[z])}),Object.keys(w).filter(z=>w[z]._button.tool==="custom").forEach(z=>{v.indexOf(z)===-1&&(C[z]=w[z])}),Object.keys(w).forEach(z=>{v.indexOf(z)===-1&&(C[z]=w[z])}),this.map.pm.Toolbar.buttons=C,this._showHideButtons()},getControlOrder(){let l=this.getButtons(),h=[];for(let v in l)h.push(v);return h},changeActionsOfControl(l,h){let v=this._btnNameMapping(l);if(!v)throw new TypeError("No name passed");if(!h)throw new TypeError("No actions passed");if(!this.buttons[v])throw new TypeError("Button with this name not exists");this.buttons[v]._button.actions=h,this.changeControlOrder()},setButtonDisabled(l,h){let v=this._btnNameMapping(l);h?this.buttons[v].disable():this.buttons[v].enable()},_shapeMapping(){return{Marker:"drawMarker",Circle:"drawCircle",Polygon:"drawPolygon",Rectangle:"drawRectangle",Polyline:"drawPolyline",Line:"drawPolyline",CircleMarker:"drawCircleMarker",Edit:"editMode",Drag:"dragMode",Cut:"cutPolygon",Removal:"removalMode",Rotate:"rotateMode",Text:"drawText"}},_btnNameMapping(l){let h=this._shapeMapping();return h[l]?h[l]:l}}),ul=qs,cl=f(_i()),wi={_initSnappableMarkers(){this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,this._assignEvents(this._markers),this._layer.off("pm:dragstart",this._unsnap,this),this._layer.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){this._layer.off("pm:dragstart",this._unsnap,this)},_assignEvents(l){l.forEach(h=>{if(Array.isArray(h)){this._assignEvents(h);return}h.off("drag",this._handleSnapping,this),h.on("drag",this._handleSnapping,this),h.off("dragend",this._cleanupSnapping,this),h.on("dragend",this._cleanupSnapping,this)})},_cleanupSnapping(l){if(l){let h=l.target;h._snapped=!1}delete this._snapList,this.throttledList&&(this._map.off("layeradd",this.throttledList,this),this.throttledList=void 0),this._map.off("layerremove",this._handleSnapLayerRemoval,this),this.debugIndicatorLines&&this.debugIndicatorLines.forEach(h=>{h.remove()})},_handleThrottleSnapping(){this.throttledList&&this._createSnapList()},_handleSnapping(l){var re,he,Se;let h=l.target;if(h._snapped=!1,this.throttledList||(this.throttledList=L.Util.throttle(this._handleThrottleSnapping,100,this)),((re=l==null?void 0:l.originalEvent)==null?void 0:re.altKey)||((Se=(he=this._map)==null?void 0:he.pm)==null?void 0:Se.Keyboard.isAltKeyPressed())||(this._snapList===void 0&&(this._createSnapList(),this._map.off("layeradd",this.throttledList,this),this._map.on("layeradd",this.throttledList,this)),this._snapList.length<=0))return!1;let v=this._calcClosestLayer(h.getLatLng(),this._snapList);if(Object.keys(v).length===0)return!1;let w=v.layer instanceof L.Marker||v.layer instanceof L.CircleMarker||!this.options.snapSegment,C;w?C=v.latlng:C=this._checkPrioritiySnapping(v);let z=this.options.snapDistance,X={marker:h,shape:this._shape,snapLatLng:C,segment:v.segment,layer:this._layer,workingLayer:this._layer,layerInteractedWith:v.layer,distance:v.distance};if(this._fireSnapDrag(X.marker,X),this._fireSnapDrag(this._layer,X),v.distance<z){h._orgLatLng=h.getLatLng(),h.setLatLng(C),h._snapped=!0,h._snapInfo=X;let Je=()=>{this._snapLatLng=C,this._fireSnap(h,X),this._fireSnap(this._layer,X)},ze=this._snapLatLng||{},vt=C||{};(ze.lat!==vt.lat||ze.lng!==vt.lng)&&Je()}else this._snapLatLng&&(this._unsnap(X),h._snapped=!1,h._snapInfo=void 0,this._fireUnsnap(X.marker,X),this._fireUnsnap(this._layer,X));return!0},_createSnapList(){let l=[],h=[],v=this._map;v.off("layerremove",this._handleSnapLayerRemoval,this),v.on("layerremove",this._handleSnapLayerRemoval,this),v.eachLayer(w=>{if((w instanceof L.Polyline||w instanceof L.Marker||w instanceof L.CircleMarker||w instanceof L.ImageOverlay)&&w.options.snapIgnore!==!0){if(w.options.snapIgnore===void 0&&(!L.PM.optIn&&w.options.pmIgnore===!0||L.PM.optIn&&w.options.pmIgnore!==!1))return;(w instanceof L.Circle||w instanceof L.CircleMarker)&&w.pm&&w.pm._hiddenPolyCircle?l.push(w.pm._hiddenPolyCircle):w instanceof L.ImageOverlay&&(w=L.rectangle(w.getBounds())),l.push(w);let C=L.polyline([],{color:"red",pmIgnore:!0});C._pmTempLayer=!0,h.push(C),(w instanceof L.Circle||w instanceof L.CircleMarker)&&h.push(C)}}),l=l.filter(w=>this._layer!==w),l=l.filter(w=>w._latlng||w._latlngs&&ro(w._latlngs)),l=l.filter(w=>!w._pmTempLayer),this._otherSnapLayers?(this._otherSnapLayers.forEach(()=>{let w=L.polyline([],{color:"red",pmIgnore:!0});w._pmTempLayer=!0,h.push(w)}),this._snapList=l.concat(this._otherSnapLayers)):this._snapList=l,this.debugIndicatorLines=h},_handleSnapLayerRemoval({layer:l}){if(!l._leaflet_id)return;let h=this._snapList.findIndex(v=>v._leaflet_id===l._leaflet_id);h>-1&&this._snapList.splice(h,1)},_calcClosestLayer(l,h){return this._calcClosestLayers(l,h,1)[0]},_calcClosestLayers(l,h,v=1){let w=[],C={};h.forEach((X,re)=>{var Se;if(X._parentCopy&&X._parentCopy===this._layer||((Se=X.getLatLngs)==null?void 0:Se.call(X).flat(5).length)<2)return;let he=this._calcLayerDistances(l,X);if(he.distance=Math.floor(he.distance),this.debugIndicatorLines){if(!this.debugIndicatorLines[re]){let Je=L.polyline([],{color:"red",pmIgnore:!0});Je._pmTempLayer=!0,this.debugIndicatorLines[re]=Je}this.debugIndicatorLines[re].setLatLngs([l,he.latlng])}v===1&&(C.distance===void 0||he.distance-5<=C.distance)?(he.distance+5<C.distance&&(w=[]),C=he,C.layer=X,w.push(C)):v!==1&&(C={},C=he,C.layer=X,w.push(C))}),v!==1&&(w=w.sort((X,re)=>X.distance-re.distance)),v===-1&&(v=w.length);let z=this._getClosestLayerByPriority(w,v);return L.Util.isArray(z)?z:[z]},_calcLayerDistances(l,h){let v=this._map,w=h instanceof L.Marker||h instanceof L.CircleMarker,C=h instanceof L.Polygon,z=l;if(w){let X=h.getLatLng();return{latlng:{...X},distance:this._getDistance(v,X,z)}}return this._calcLatLngDistances(z,h.getLatLngs(),v,C)},_calcLatLngDistances(l,h,v,w=!1){let C,z,X,re=he=>{he.forEach((Se,Je)=>{if(Array.isArray(Se)){re(Se);return}if(this.options.snapSegment){let ze=Se,vt;w?vt=Je+1===he.length?0:Je+1:vt=Je+1===he.length?void 0:Je+1;let kt=he[vt];if(kt){let Xt=this._getDistanceToSegment(v,l,ze,kt);(z===void 0||Xt<z)&&(z=Xt,X=[ze,kt])}}else{let ze=this._getDistance(v,l,Se);(z===void 0||ze<z)&&(z=ze,C=Se)}})};return re(h),this.options.snapSegment?{latlng:{...this._getClosestPointOnSegment(v,l,X[0],X[1])},segment:X,distance:z}:{latlng:C,distance:z}},_getClosestLayerByPriority(l,h=1){l=l.sort((X,re)=>X._leaflet_id-re._leaflet_id);let v=["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],w=this._map.pm.globalOptions.snappingOrder||[],C=0,z={};return w.concat(v).forEach(X=>{z[X]||(C+=1,z[X]=C)}),l.sort(Nl("instanceofShape",z)),h===1?l[0]||{}:l.slice(0,h)},_checkPrioritiySnapping(l){let h=this._map,v=l.segment[0],w=l.segment[1],C=l.latlng,z=C;if(this.options.snapVertex){let X=this._getDistance(h,v,C),re=this._getDistance(h,w,C),he=X<re?v:w,Se=X<re?X:re;if(this.options.snapMiddle){let ze=L.PM.Utils.calcMiddleLatLng(h,v,w),vt=this._getDistance(h,ze,C);vt<X&&vt<re&&(he=ze,Se=vt)}let Je=this.options.snapDistance;Se<Je&&(z=he)}return{...z}},_unsnap(){delete this._snapLatLng},_getClosestPointOnSegment(l,h,v,w){let C=l.getMaxZoom();C===1/0&&(C=l.getZoom());let z=l.project(h,C),X=l.project(v,C),re=l.project(w,C),he=L.LineUtil.closestPointOnSegment(z,X,re);return l.unproject(he,C)},_getDistanceToSegment(l,h,v,w){let C=l.latLngToContainerPoint(h),z=l.latLngToContainerPoint(v),X=l.latLngToContainerPoint(w);return L.LineUtil.pointToSegmentDistance(C,z,X)},_getDistance(l,h,v){return l.latLngToContainerPoint(h).distanceTo(l.latLngToContainerPoint(v))}},Es=wi,ba=L.Class.extend({includes:[Es,kl],options:{snappable:!0,snapDistance:20,snapMiddle:!1,allowSelfIntersection:!0,tooltips:!0,templineStyle:{},hintlineStyle:{color:"#3388ff",dashArray:"5,5"},pathOptions:null,cursorMarker:!0,finishOn:null,markerStyle:{draggable:!0,icon:L.icon()},hideMiddleMarkers:!1,minRadiusCircle:null,maxRadiusCircle:null,minRadiusCircleMarker:null,maxRadiusCircleMarker:null,resizeableCircleMarker:!1,resizeableCircle:!0,markerEditable:!0,continueDrawing:!1,snapSegment:!0,requireSnapToFinish:!1,rectangleAngle:0,textOptions:{text:null,focusAfterDraw:null,removeIfEmpty:null,className:null},snapVertex:!0},setOptions(l){L.Util.setOptions(this,l),this.setStyle(this.options)},setStyle(){},getOptions(){return this.options},initialize(l){let h=new L.Icon.Default;h.options.tooltipAnchor=[0,0],this.options.markerStyle.icon=h,this._map=l,this.shapes=["Marker","CircleMarker","Line","Polygon","Rectangle","Circle","Cut","Text"],this.shapes.forEach(v=>{this[v]=new L.PM.Draw[v](this._map)}),this.Marker.setOptions({continueDrawing:!0}),this.CircleMarker.setOptions({continueDrawing:!0})},setPathOptions(l,h=!1){h?this.options.pathOptions=(0,cl.default)(this.options.pathOptions,l):this.options.pathOptions=l},getShapes(){return this.shapes},getShape(){return this._shape},enable(l,h){if(!l)throw new Error(`Error: Please pass a shape as a parameter. Possible shapes are: ${this.getShapes().join(",")}`);this.disable(),this[l].enable(h)},disable(){this.shapes.forEach(l=>{this[l].disable()})},addControls(){this.shapes.forEach(l=>{this[l].addButton()})},getActiveShape(){let l;return this.shapes.forEach(h=>{this[h]._enabled&&(l=h)}),l},_setGlobalDrawMode(){this._shape==="Cut"?this._fireGlobalCutModeToggled():this._fireGlobalDrawModeToggled();let l=[];this._map.eachLayer(h=>{(h instanceof L.Polyline||h instanceof L.Marker||h instanceof L.Circle||h instanceof L.CircleMarker||h instanceof L.ImageOverlay)&&(h._pmTempLayer||l.push(h))}),this._enabled?l.forEach(h=>{L.PM.Utils.disablePopup(h)}):l.forEach(h=>{L.PM.Utils.enablePopup(h)})},createNewDrawInstance(l,h){let v=this._getShapeFromBtnName(h);if(this[l])throw new TypeError("Draw Type already exists");if(!L.PM.Draw[v])throw new TypeError(`There is no class L.PM.Draw.${v}`);return this[l]=new L.PM.Draw[v](this._map),this[l].toolbarButtonName=l,this[l]._shape=l,this.shapes.push(l),this[h]&&this[l].setOptions(this[h].options),this[l].setOptions(this[l].options),this[l]},_getShapeFromBtnName(l){let h={drawMarker:"Marker",drawCircle:"Circle",drawPolygon:"Polygon",drawPolyline:"Line",drawRectangle:"Rectangle",drawCircleMarker:"CircleMarker",editMode:"Edit",dragMode:"Drag",cutPolygon:"Cut",removalMode:"Removal",rotateMode:"Rotate",drawText:"Text"};return h[l]?h[l]:this[l]?this[l]._shape:l},_finishLayer(l){l.pm&&(l.pm.setOptions(this.options),l.pm._shape=this._shape,l.pm._map=this._map),this._addDrawnLayerProp(l)},_addDrawnLayerProp(l){l._drawnByGeoman=!0},_setPane(l,h){h==="layerPane"?l.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":h==="vertexPane"?l.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":h==="markerPane"&&(l.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},_isFirstLayer(){return(this._map||this._layer._map).pm.getGeomanLayers().length===0}}),io=ba;io.Marker=io.extend({initialize(l){this._map=l,this._shape="Marker",this.toolbarButtonName="drawMarker"},enable(l){L.Util.setOptions(this,l),this._enabled=!0,this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),this.options.markerStyle),this._setPane(this._hintMarker,"markerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.tooltips&&this._hintMarker.bindTooltip(or("tooltips.placeMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this.options.markerEditable&&this._map.eachLayer(h=>{this.isRelevantMarker(h)&&h.pm.enable()}),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createMarker,this),this._hintMarker.remove(),this._map.off("mousemove",this._syncHintMarker,this),this._map.eachLayer(l=>{this.isRelevantMarker(l)&&l.pm.disable()}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(l){this.enabled()?this.disable():this.enable(l)},isRelevantMarker(l){return l instanceof L.Marker&&l.pm&&!l._pmTempLayer&&!l.pm._initTextMarker},_syncHintMarker(l){if(this._hintMarker.setLatLng(l.latlng),this.options.snappable){let h=l;h.target=this._hintMarker,this._handleSnapping(h)}this._fireChange(this._hintMarker.getLatLng(),"Draw")},_createMarker(l){if(!l.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(l.latlng);let h=this._hintMarker.getLatLng(),v=new L.Marker(h,this.options.markerStyle);this._setPane(v,"markerPane"),this._finishLayer(v),v.pm||(v.options.draggable=!1),v.addTo(this._map.pm._getContainingLayer()),v.pm&&this.options.markerEditable?v.pm.enable():v.dragging&&v.dragging.disable(),this._fireCreate(v),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},setStyle(){var l,h;(l=this.options.markerStyle)!=null&&l.icon&&((h=this._hintMarker)==null||h.setIcon(this.options.markerStyle.icon))}});var O=63710088e-1,be={centimeters:O*100,centimetres:O*100,degrees:O/111325,feet:O*3.28084,inches:O*39.37,kilometers:O/1e3,kilometres:O/1e3,meters:O,metres:O,miles:O/1609.344,millimeters:O*1e3,millimetres:O*1e3,nauticalmiles:O/1852,radians:1,yards:O*1.0936};function Ke(l,h,v){v===void 0&&(v={});var w={type:"Feature"};return(v.id===0||v.id)&&(w.id=v.id),v.bbox&&(w.bbox=v.bbox),w.properties=h||{},w.geometry=l,w}function ft(l,h,v){if(v===void 0&&(v={}),!l)throw new Error("coordinates is required");if(!Array.isArray(l))throw new Error("coordinates must be an Array");if(l.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!vr(l[0])||!vr(l[1]))throw new Error("coordinates must contain numbers");var w={type:"Point",coordinates:l};return Ke(w,h,v)}function xt(l,h,v){if(v===void 0&&(v={}),l.length<2)throw new Error("coordinates must be an array of two or more positions");var w={type:"LineString",coordinates:l};return Ke(w,h,v)}function $t(l,h){h===void 0&&(h={});var v={type:"FeatureCollection"};return h.id&&(v.id=h.id),h.bbox&&(v.bbox=h.bbox),v.features=l,v}function cn(l,h){h===void 0&&(h="kilometers");var v=be[h];if(!v)throw new Error(h+" units is invalid");return l*v}function Nn(l,h){h===void 0&&(h="kilometers");var v=be[h];if(!v)throw new Error(h+" units is invalid");return l/v}function zn(l){var h=l%(2*Math.PI);return h*180/Math.PI}function nr(l){var h=l%360;return h*Math.PI/180}function vr(l){return!isNaN(l)&&l!==null&&!Array.isArray(l)}function Ur(l){var h,v,w={type:"FeatureCollection",features:[]};if(l.type==="Feature"?v=l.geometry:v=l,v.type==="LineString")h=[v.coordinates];else if(v.type==="MultiLineString")h=v.coordinates;else if(v.type==="MultiPolygon")h=[].concat.apply([],v.coordinates);else if(v.type==="Polygon")h=v.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return h.forEach(function(C){h.forEach(function(z){for(var X=0;X<C.length-1;X++)for(var re=X;re<z.length-1;re++)if(!(C===z&&(Math.abs(X-re)===1||X===0&&re===C.length-2&&C[X][0]===C[C.length-1][0]&&C[X][1]===C[C.length-1][1]))){var he=$i(C[X][0],C[X][1],C[X+1][0],C[X+1][1],z[re][0],z[re][1],z[re+1][0],z[re+1][1]);he&&w.features.push(ft([he[0],he[1]]))}})}),w}function $i(l,h,v,w,C,z,X,re){var he,Se,Je,ze,vt,kt={x:null,y:null,onLine1:!1,onLine2:!1};return he=(re-z)*(v-l)-(X-C)*(w-h),he===0?kt.x!==null&&kt.y!==null?kt:!1:(Se=h-z,Je=l-C,ze=(X-C)*Se-(re-z)*Je,vt=(v-l)*Se-(w-h)*Je,Se=ze/he,Je=vt/he,kt.x=l+Se*(v-l),kt.y=h+Se*(w-h),Se>=0&&Se<=1&&(kt.onLine1=!0),Je>=0&&Je<=1&&(kt.onLine2=!0),kt.onLine1&&kt.onLine2?[kt.x,kt.y]:!1)}io.Line=io.extend({initialize(l){this._map=l,this._shape="Line",this.toolbarButtonName="drawPolyline",this._doesSelfIntersect=!1},enable(l){L.Util.setOptions(this,l),this._enabled=!0,this._markers=[],this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.polyline([],{...this.options.templineStyle,pmIgnore:!1}),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(or("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createVertex,this),this.options.finishOn&&this.options.finishOn!=="snap"&&this._map.on(this.options.finishOn,this._finishShape,this),this.options.finishOn==="dblclick"&&(this.tempMapDoubleClickZoomState=this._map.doubleClickZoom._enabled,this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.disable()),this._map.on("mousemove",this._syncHintMarker,this),this._hintMarker.on("move",this._syncHintLine,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this.isRed=!1,this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createVertex,this),this._map.off("mousemove",this._syncHintMarker,this),this.options.finishOn&&this.options.finishOn!=="snap"&&this._map.off(this.options.finishOn,this._finishShape,this),this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.enable(),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(l){this.enabled()?this.disable():this.enable(l)},_syncHintLine(){let l=this._layer.getLatLngs();if(l.length>0){let h=l[l.length-1];this._hintline.setLatLngs([h,this._hintMarker.getLatLng()])}},_syncHintMarker(l){if(this._hintMarker.setLatLng(l.latlng),this.options.snappable){let v=l;v.target=this._hintMarker,this._handleSnapping(v)}this.options.allowSelfIntersection||this._handleSelfIntersection(!0,this._hintMarker.getLatLng());let h=this._layer._defaultShape().slice();h.push(this._hintMarker.getLatLng()),this._change(h)},hasSelfIntersection(){return Ur(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersection(l,h){let v=L.polyline(this._layer.getLatLngs());l&&(h||(h=this._hintMarker.getLatLng()),v.addLatLng(h));let w=Ur(v.toGeoJSON(15));this._doesSelfIntersect=w.features.length>0,this._doesSelfIntersect?this.isRed||(this.isRed=!0,this._hintline.setStyle({color:"#f00000ff"}),this._fireIntersect(w,this._map,"Draw")):this._hintline.isEmpty()||(this.isRed=!1,this._hintline.setStyle(this.options.hintlineStyle))},_createVertex(l){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,l.latlng),this._doesSelfIntersect))return;this._hintMarker._snapped||this._hintMarker.setLatLng(l.latlng);let h=this._hintMarker.getLatLng(),v=this._layer.getLatLngs(),w=v[v.length-1];if(h.equals(v[0])||v.length>0&&h.equals(w)){this._finishShape();return}this._layer._latlngInfo=this._layer._latlngInfo||[],this._layer._latlngInfo.push({latlng:h,snapInfo:this._hintMarker._snapInfo}),this._layer.addLatLng(h);let C=this._createMarker(h);this._setTooltipText(),this._setHintLineAfterNewVertex(h),this._fireVertexAdded(C,void 0,h,"Draw"),this._change(this._layer.getLatLngs()),this.options.finishOn==="snap"&&this._hintMarker._snapped&&this._finishShape(l)},_setHintLineAfterNewVertex(l){this._hintline.setLatLngs([l,l])},_removeLastVertex(){let l=this._markers;if(l.length<=1){this.disable();return}let h=this._layer.getLatLngs(),v=l[l.length-1],{indexPath:w}=L.PM.Utils.findDeepMarkerIndex(l,v);l.pop(),this._layerGroup.removeLayer(v);let C=l[l.length-1],z=h.indexOf(C.getLatLng());h=h.slice(0,z+1),this._layer.setLatLngs(h),this._layer._latlngInfo.pop(),this._syncHintLine(),this._setTooltipText(),this._fireVertexRemoved(v,w,"Draw"),this._change(this._layer.getLatLngs())},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!1),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let l=this._layer.getLatLngs();if(l.length<=1)return;let h=L.polyline(l,this.options.pathOptions);this._setPane(h,"layerPane"),this._finishLayer(h),h.addTo(this._map.pm._getContainingLayer()),this._fireCreate(h),this.options.snappable&&this._cleanupSnapping();let v=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(v))},_createMarker(l){let h=new L.Marker(l,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(h,"vertexPane"),h._pmTempLayer=!0,this._layerGroup.addLayer(h),this._markers.push(h),h.on("click",this._finishShape,this),h},_setTooltipText(){let{length:l}=this._layer.getLatLngs().flat(),h="";l<=1?h=or("tooltips.continueLine"):h=or("tooltips.finishLine"),this._hintMarker.setTooltipContent(h)},_change(l){this._fireChange(l,"Draw")},setStyle(){var l,h;(l=this._layer)==null||l.setStyle(this.options.templineStyle),(h=this._hintline)==null||h.setStyle(this.options.hintlineStyle)}}),io.Polygon=io.Line.extend({initialize(l){this._map=l,this._shape="Polygon",this.toolbarButtonName="drawPolygon"},enable(l){L.PM.Draw.Line.prototype.enable.call(this,l),this._layer.pm._shape="Polygon"},_createMarker(l){let h=new L.Marker(l,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(h,"vertexPane"),h._pmTempLayer=!0,this._layerGroup.addLayer(h),this._markers.push(h),this._layer.getLatLngs().flat().length===1?(h.on("click",this._finishShape,this),this._tempSnapLayerIndex=this._otherSnapLayers.push(h)-1,this.options.snappable&&this._cleanupSnapping()):h.on("click",()=>1),h},_setTooltipText(){let{length:l}=this._layer.getLatLngs().flat(),h="";l<=2?h=or("tooltips.continueLine"):h=or("tooltips.finishPoly"),this._hintMarker.setTooltipContent(h)},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let l=this._layer.getLatLngs();if(l.length<=2)return;let h=L.polygon(l,this.options.pathOptions);this._setPane(h,"layerPane"),this._finishLayer(h),h.addTo(this._map.pm._getContainingLayer()),this._fireCreate(h),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex;let v=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(v))}}),io.Rectangle=io.extend({initialize(l){this._map=l,this._shape="Rectangle",this.toolbarButtonName="drawRectangle"},enable(l){if(L.Util.setOptions(this,l),this._enabled=!0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.rectangle([[0,0],[0,0]],this.options.pathOptions),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._startMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-start-marker"}),draggable:!1,zIndexOffset:-100,opacity:this.options.cursorMarker?1:0}),this._setPane(this._startMarker,"vertexPane"),this._startMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._startMarker),this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:150,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(or("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this.options.cursorMarker){this._styleMarkers=[];for(let h=0;h<2;h+=1){let v=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-style-marker"}),draggable:!1,zIndexOffset:100});this._setPane(v,"vertexPane"),v._pmTempLayer=!0,this._layerGroup.addLayer(v),this._styleMarkers.push(v)}}this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._placeStartingMarkers,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._finishShape,this),this._map.off("click",this._placeStartingMarkers,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(l){this.enabled()?this.disable():this.enable(l)},_placeStartingMarkers(l){this._hintMarker._snapped||this._hintMarker.setLatLng(l.latlng);let h=this._hintMarker.getLatLng();L.DomUtil.addClass(this._startMarker._icon,"visible"),this._startMarker.setLatLng(h),this.options.cursorMarker&&this._styleMarkers&&this._styleMarkers.forEach(v=>{L.DomUtil.addClass(v._icon,"visible"),v.setLatLng(h)}),this._map.off("click",this._placeStartingMarkers,this),this._map.on("click",this._finishShape,this),this._hintMarker.setTooltipContent(or("tooltips.finishRect")),this._setRectangleOrigin()},_setRectangleOrigin(){let l=this._startMarker.getLatLng();l&&(this._layerGroup.addLayer(this._layer),this._layer.setLatLngs([l,l]),this._hintMarker.on("move",this._syncRectangleSize,this))},_syncHintMarker(l){if(this._hintMarker.setLatLng(l.latlng),this.options.snappable){let v=l;v.target=this._hintMarker,this._handleSnapping(v)}let h=this._layerGroup&&this._layerGroup.hasLayer(this._layer)?this._layer.getLatLngs():[this._hintMarker.getLatLng()];this._fireChange(h,"Draw")},_syncRectangleSize(){let l=Dl(this._startMarker.getLatLng(),this._map),h=Dl(this._hintMarker.getLatLng(),this._map),v=L.PM.Utils._getRotatedRectangle(l,h,this.options.rectangleAngle||0,this._map);if(this._layer.setLatLngs(v),this.options.cursorMarker&&this._styleMarkers){let w=[];v.forEach(C=>{!C.equals(l,1e-8)&&!C.equals(h,1e-8)&&w.push(C)}),w.forEach((C,z)=>{try{this._styleMarkers[z].setLatLng(C)}catch{}})}},_findCorners(){let l=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(l[0],l[2],this.options.rectangleAngle||0,this._map)},_finishShape(l){this._hintMarker._snapped||this._hintMarker.setLatLng(l.latlng);let h=this._hintMarker.getLatLng(),v=this._startMarker.getLatLng();if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||v.equals(h))return;let w=L.rectangle([v,h],this.options.pathOptions);if(this.options.rectangleAngle){let z=L.PM.Utils._getRotatedRectangle(v,h,this.options.rectangleAngle||0,this._map);w.setLatLngs(z),w.pm&&w.pm._setAngle(this.options.rectangleAngle||0)}this._setPane(w,"layerPane"),this._finishLayer(w),w.addTo(this._map.pm._getContainingLayer()),this._fireCreate(w);let C=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(C))},setStyle(){var l;(l=this._layer)==null||l.setStyle(this.options.pathOptions)}}),io.CircleMarker=io.extend({initialize(l){this._map=l,this._shape="CircleMarker",this.toolbarButtonName="drawCircleMarker",this._layerIsDragging=!1,this._BaseCircleClass=L.CircleMarker,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._defaultRadius=10},enable(l){if(L.Util.setOptions(this,l),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),this._enabled=!0,this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._map.getContainer().classList.add("geoman-draw-cursor"),this.options[this._editableOption]){let h={};L.extend(h,this.options.templineStyle),h.radius=0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=new this._BaseCircleClass(this._map.getCenter(),h),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._centerMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon"}),draggable:!1,zIndexOffset:100}),this._setPane(this._centerMarker,"vertexPane"),this._centerMarker._pmTempLayer=!0,this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:110,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(or("tooltips.startCircle"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._map.on("click",this._placeCenterMarker,this)}else this._map.on("click",this._createMarker,this),this._hintMarker=new this._BaseCircleClass(this._map.getCenter(),{radius:this._defaultRadius,...this.options.templineStyle}),this._setPane(this._hintMarker,"layerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this._layer=this._hintMarker,this.options.tooltips&&this._hintMarker.bindTooltip(or("tooltips.placeCircleMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip();this._map.on("mousemove",this._syncHintMarker,this),this._extendingEnable(),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},_extendingEnable(){!this.options[this._editableOption]&&this.options.markerEditable&&this._map.eachLayer(l=>{this.isRelevantMarker(l)&&l.pm.enable()}),this._layer.bringToBack()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this.options[this._editableOption]?(this._map.off("click",this._finishShape,this),this._map.off("click",this._placeCenterMarker,this),this._map.removeLayer(this._layerGroup)):(this._map.off("click",this._createMarker,this),this._extendingDisable(),this._hintMarker.remove()),this._map.off("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},_extendingDisable(){this._map.eachLayer(l=>{this.isRelevantMarker(l)&&l.pm.disable()})},enabled(){return this._enabled},toggle(l){this.enabled()?this.disable():this.enable(l)},_placeCenterMarker(l){this._hintMarker._snapped||this._hintMarker.setLatLng(l.latlng),this._layerGroup.addLayer(this._layer),this._layerGroup.addLayer(this._centerMarker);let h=this._hintMarker.getLatLng();this._centerMarker.setLatLng(h),this._map.off("click",this._placeCenterMarker,this),this._map.on("click",this._finishShape,this),this._placeCircleCenter()},_placeCircleCenter(){let l=this._centerMarker.getLatLng();l&&(this._layer.setLatLng(l),this._hintMarker.on("move",this._syncHintLine,this),this._hintMarker.on("move",this._syncCircleRadius,this),this._hintMarker.setTooltipContent(or("tooltips.finishCircle")),this._fireCenterPlaced(),this._fireChange(this._layer.getLatLng(),"Draw"))},_syncHintLine(){let l=this._centerMarker.getLatLng(),h=this._getNewDestinationOfHintMarker();this._hintline.setLatLngs([l,h])},_syncCircleRadius(){let l=this._centerMarker.getLatLng(),h=this._hintMarker.getLatLng(),v=this._distanceCalculation(l,h);this.options[this._minRadiusOption]&&v<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&v>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(v)},_syncHintMarker(l){if(this._hintMarker.setLatLng(l.latlng),this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker()),this.options.snappable){let v=l;v.target=this._hintMarker,this._handleSnapping(v)}this._handleHintMarkerSnapping();let h=this._layerGroup&&this._layerGroup.hasLayer(this._centerMarker)?this._centerMarker.getLatLng():this._hintMarker.getLatLng();this._fireChange(h,"Draw")},isRelevantMarker(l){return l instanceof L.CircleMarker&&!(l instanceof L.Circle)&&l.pm&&!l._pmTempLayer},_createMarker(l){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||!l.latlng||this._layerIsDragging)return;this._hintMarker._snapped||this._hintMarker.setLatLng(l.latlng);let h=this._hintMarker.getLatLng(),v=new this._BaseCircleClass(h,{radius:this._defaultRadius,...this.options.pathOptions});this._setPane(v,"layerPane"),this._finishLayer(v),v.addTo(this._map.pm._getContainingLayer()),this._extendingCreateMarker(v),this._fireCreate(v),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},_extendingCreateMarker(l){l.pm&&this.options.markerEditable&&l.pm.enable()},_finishShape(l){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(l.latlng);let h=this._centerMarker.getLatLng(),v=this._defaultRadius;if(this.options[this._editableOption]){let X=this._hintMarker.getLatLng();v=this._distanceCalculation(h,X),this.options[this._minRadiusOption]&&v<this.options[this._minRadiusOption]?v=this.options[this._minRadiusOption]:this.options[this._maxRadiusOption]&&v>this.options[this._maxRadiusOption]&&(v=this.options[this._maxRadiusOption])}let w={...this.options.pathOptions,radius:v},C=new this._BaseCircleClass(h,w);this._setPane(C,"layerPane"),this._finishLayer(C),C.addTo(this._map.pm._getContainingLayer()),C.pm&&C.pm._updateHiddenPolyCircle(),this._fireCreate(C);let z=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(z))},_getNewDestinationOfHintMarker(){let l=this._hintMarker.getLatLng();if(this.options[this._editableOption]){if(!this._layerGroup.hasLayer(this._centerMarker))return l;let h=this._centerMarker.getLatLng(),v=this._distanceCalculation(h,l);this.options[this._minRadiusOption]&&v<this.options[this._minRadiusOption]?l=Tl(this._map,h,l,this._getMinDistanceInMeter()):this.options[this._maxRadiusOption]&&v>this.options[this._maxRadiusOption]&&(l=Tl(this._map,h,l,this._getMaxDistanceInMeter()))}return l},_getMinDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,this._centerMarker.getLatLng())},_getMaxDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,this._centerMarker.getLatLng())},_handleHintMarkerSnapping(){if(this.options[this._editableOption]){if(this._hintMarker._snapped){let l=this._centerMarker.getLatLng(),h=this._hintMarker.getLatLng(),v=this._distanceCalculation(l,h);this._layerGroup.hasLayer(this._centerMarker)&&(this.options[this._minRadiusOption]&&v<this.options[this._minRadiusOption]?this._hintMarker.setLatLng(this._hintMarker._orgLatLng):this.options[this._maxRadiusOption]&&v>this.options[this._maxRadiusOption]&&this._hintMarker.setLatLng(this._hintMarker._orgLatLng))}this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker())}},setStyle(){var h,v;let l={};L.extend(l,this.options.templineStyle),this.options[this._editableOption]&&(l.radius=0),(h=this._layer)==null||h.setStyle(l),(v=this._hintline)==null||v.setStyle(this.options.hintlineStyle)},_distanceCalculation(l,h){return this._map.project(l).distanceTo(this._map.project(h))}}),io.Circle=io.CircleMarker.extend({initialize(l){this._map=l,this._shape="Circle",this.toolbarButtonName="drawCircle",this._BaseCircleClass=L.Circle,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizeableCircle",this._defaultRadius=100},_extendingEnable(){},_extendingDisable(){},_extendingCreateMarker(){},isRelevantMarker(){},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_distanceCalculation(l,h){return this._map.distance(l,h)}});function pi(l){if(!l)throw new Error("coord is required");if(!Array.isArray(l)){if(l.type==="Feature"&&l.geometry!==null&&l.geometry.type==="Point")return l.geometry.coordinates;if(l.type==="Point")return l.coordinates}if(Array.isArray(l)&&l.length>=2&&!Array.isArray(l[0])&&!Array.isArray(l[1]))return l;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function xi(l){if(Array.isArray(l))return l;if(l.type==="Feature"){if(l.geometry!==null)return l.geometry.coordinates}else if(l.coordinates)return l.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function oo(l){return l.type==="Feature"?l.geometry:l}function ho(l,h){return l.type==="FeatureCollection"?"FeatureCollection":l.type==="GeometryCollection"?"GeometryCollection":l.type==="Feature"&&l.geometry!==null?l.geometry.type:l.type}function Ps(l,h,v){if(l!==null)for(var w,C,z,X,re,he,Se,Je=0,ze=0,vt,kt=l.type,Xt=kt==="FeatureCollection",yn=kt==="Feature",bn=Xt?l.features.length:1,ur=0;ur<bn;ur++){Se=Xt?l.features[ur].geometry:yn?l.geometry:l,vt=Se?Se.type==="GeometryCollection":!1,re=vt?Se.geometries.length:1;for(var Ye=0;Ye<re;Ye++){var nt=0,ht=0;if(X=vt?Se.geometries[Ye]:Se,X!==null){he=X.coordinates;var Ot=X.type;switch(Je=0,Ot){case null:break;case"Point":if(h(he,ze,ur,nt,ht)===!1)return!1;ze++,nt++;break;case"LineString":case"MultiPoint":for(w=0;w<he.length;w++){if(h(he[w],ze,ur,nt,ht)===!1)return!1;ze++,Ot==="MultiPoint"&&nt++}Ot==="LineString"&&nt++;break;case"Polygon":case"MultiLineString":for(w=0;w<he.length;w++){for(C=0;C<he[w].length-Je;C++){if(h(he[w][C],ze,ur,nt,ht)===!1)return!1;ze++}Ot==="MultiLineString"&&nt++,Ot==="Polygon"&&ht++}Ot==="Polygon"&&nt++;break;case"MultiPolygon":for(w=0;w<he.length;w++){for(ht=0,C=0;C<he[w].length;C++){for(z=0;z<he[w][C].length-Je;z++){if(h(he[w][C][z],ze,ur,nt,ht)===!1)return!1;ze++}ht++}nt++}break;case"GeometryCollection":for(w=0;w<X.geometries.length;w++)if(Ps(X.geometries[w],h)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Vr(l,h){if(l.type==="Feature")h(l,0);else if(l.type==="FeatureCollection")for(var v=0;v<l.features.length&&h(l.features[v],v)!==!1;v++);}function zo(l,h,v){var w=v;return Vr(l,function(C,z){z===0&&v===void 0?w=C:w=h(w,C,z)}),w}function fl(l,h){var v,w,C,z,X,re,he,Se,Je,ze,vt=0,kt=l.type==="FeatureCollection",Xt=l.type==="Feature",yn=kt?l.features.length:1;for(v=0;v<yn;v++){for(re=kt?l.features[v].geometry:Xt?l.geometry:l,Se=kt?l.features[v].properties:Xt?l.properties:{},Je=kt?l.features[v].bbox:Xt?l.bbox:void 0,ze=kt?l.features[v].id:Xt?l.id:void 0,he=re?re.type==="GeometryCollection":!1,X=he?re.geometries.length:1,C=0;C<X;C++){if(z=he?re.geometries[C]:re,z===null){if(h(null,vt,Se,Je,ze)===!1)return!1;continue}switch(z.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(h(z,vt,Se,Je,ze)===!1)return!1;break}case"GeometryCollection":{for(w=0;w<z.geometries.length;w++)if(h(z.geometries[w],vt,Se,Je,ze)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}vt++}}function es(l,h){fl(l,function(v,w,C,z,X){var re=v===null?null:v.type;switch(re){case null:case"Point":case"LineString":case"Polygon":return h(Ke(v,C,{bbox:z,id:X}),w,0)===!1?!1:void 0}var he;switch(re){case"MultiPoint":he="Point";break;case"MultiLineString":he="LineString";break;case"MultiPolygon":he="Polygon";break}for(var Se=0;Se<v.coordinates.length;Se++){var Je=v.coordinates[Se],ze={type:he,coordinates:Je};if(h(Ke(ze,C),w,Se)===!1)return!1}})}function eu(l){if(!l)throw new Error("geojson is required");var h=[];return es(l,function(v){na(v,h)}),$t(h)}function na(l,h){var v=[],w=l.geometry;if(w!==null){switch(w.type){case"Polygon":v=xi(w);break;case"LineString":v=[xi(w)]}v.forEach(function(C){var z=wu(C,l.properties);z.forEach(function(X){X.id=h.length,h.push(X)})})}}function wu(l,h){var v=[];return l.reduce(function(w,C){var z=xt([w,C],h);return z.bbox=Ga(w,C),v.push(z),C}),v}function Ga(l,h){var v=l[0],w=l[1],C=h[0],z=h[1],X=v<C?v:C,re=w<z?w:z,he=v>C?v:C,Se=w>z?w:z;return[X,re,he,Se]}var Ha=eu,po=f(Lr(),1);function ra(l,h){var v={},w=[];if(l.type==="LineString"&&(l=Ke(l)),h.type==="LineString"&&(h=Ke(h)),l.type==="Feature"&&h.type==="Feature"&&l.geometry!==null&&h.geometry!==null&&l.geometry.type==="LineString"&&h.geometry.type==="LineString"&&l.geometry.coordinates.length===2&&h.geometry.coordinates.length===2){var C=Ms(l,h);return C&&w.push(C),$t(w)}var z=(0,po.default)();return z.load(Ha(h)),Vr(Ha(l),function(X){Vr(z.search(X),function(re){var he=Ms(X,re);if(he){var Se=xi(he).join(",");v[Se]||(v[Se]=!0,w.push(he))}})}),$t(w)}function Ms(l,h){var v=xi(l),w=xi(h);if(v.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(w.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var C=v[0][0],z=v[0][1],X=v[1][0],re=v[1][1],he=w[0][0],Se=w[0][1],Je=w[1][0],ze=w[1][1],vt=(ze-Se)*(X-C)-(Je-he)*(re-z),kt=(Je-he)*(z-Se)-(ze-Se)*(C-he),Xt=(X-C)*(z-Se)-(re-z)*(C-he);if(vt===0)return null;var yn=kt/vt,bn=Xt/vt;if(yn>=0&&yn<=1&&bn>=0&&bn<=1){var ur=C+yn*(X-C),Ye=z+yn*(re-z);return ft([ur,Ye])}return null}var hs=ra,hl=f(Lr(),1);function $o(l,h,v){v===void 0&&(v={});var w=pi(l),C=pi(h),z=nr(C[1]-w[1]),X=nr(C[0]-w[0]),re=nr(w[1]),he=nr(C[1]),Se=Math.pow(Math.sin(z/2),2)+Math.pow(Math.sin(X/2),2)*Math.cos(re)*Math.cos(he);return cn(2*Math.atan2(Math.sqrt(Se),Math.sqrt(1-Se)),v.units)}var ts=$o;function ns(l){var h=l[0],v=l[1],w=l[2],C=l[3],z=ts(l.slice(0,2),[w,v]),X=ts(l.slice(0,2),[h,C]);if(z>=X){var re=(v+C)/2;return[h,re-(w-h)/2,w,re+(w-h)/2]}else{var he=(h+w)/2;return[he-(C-v)/2,v,he+(C-v)/2,C]}}var Ju=ns;function So(l){var h=[1/0,1/0,-1/0,-1/0];return Ps(l,function(v){h[0]>v[0]&&(h[0]=v[0]),h[1]>v[1]&&(h[1]=v[1]),h[2]<v[0]&&(h[2]=v[0]),h[3]<v[1]&&(h[3]=v[1])}),h}So.default=So;var wa=So;function Uo(l,h){h===void 0&&(h={});var v=h.precision,w=h.coordinates,C=h.mutate;if(v=v==null||isNaN(v)?6:v,w=w==null||isNaN(w)?3:w,!l)throw new Error("<geojson> is required");if(typeof v!="number")throw new Error("<precision> must be a number");if(typeof w!="number")throw new Error("<coordinates> must be a number");(C===!1||C===void 0)&&(l=JSON.parse(JSON.stringify(l)));var z=Math.pow(10,v);return Ps(l,function(X){Vo(X,z,w)}),l}function Vo(l,h,v){l.length>v&&l.splice(v,l.length);for(var w=0;w<l.length;w++)l[w]=Math.round(l[w]*h)/h;return l}var xa=Uo;function La(l,h,v){if(v===void 0&&(v={}),v.final===!0)return Go(l,h);var w=pi(l),C=pi(h),z=nr(w[0]),X=nr(C[0]),re=nr(w[1]),he=nr(C[1]),Se=Math.sin(X-z)*Math.cos(he),Je=Math.cos(re)*Math.sin(he)-Math.sin(re)*Math.cos(he)*Math.cos(X-z);return zn(Math.atan2(Se,Je))}function Go(l,h){var v=La(h,l);return v=(v+180)%360,v}function Ao(l,h,v,w){w===void 0&&(w={});var C=pi(l),z=nr(C[0]),X=nr(C[1]),re=nr(v),he=Nn(h,w.units),Se=Math.asin(Math.sin(X)*Math.cos(he)+Math.cos(X)*Math.sin(he)*Math.cos(re)),Je=z+Math.atan2(Math.sin(re)*Math.sin(he)*Math.cos(X),Math.cos(he)-Math.sin(X)*Math.sin(Se)),ze=zn(Je),vt=zn(Se);return ft([ze,vt],w.properties)}function ia(l,h,v){v===void 0&&(v={});var w=ft([1/0,1/0],{dist:1/0}),C=0;return es(l,function(z){for(var X=xi(z),re=0;re<X.length-1;re++){var he=ft(X[re]);he.properties.dist=ts(h,he,v);var Se=ft(X[re+1]);Se.properties.dist=ts(h,Se,v);var Je=ts(he,Se,v),ze=Math.max(he.properties.dist,Se.properties.dist),vt=La(he,Se),kt=Ao(h,ze,vt+90,v),Xt=Ao(h,ze,vt-90,v),yn=hs(xt([kt.geometry.coordinates,Xt.geometry.coordinates]),xt([he.geometry.coordinates,Se.geometry.coordinates])),bn=null;yn.features.length>0&&(bn=yn.features[0],bn.properties.dist=ts(h,bn,v),bn.properties.location=C+ts(he,bn,v)),he.properties.dist<w.properties.dist&&(w=he,w.properties.index=re,w.properties.location=C),Se.properties.dist<w.properties.dist&&(w=Se,w.properties.index=re+1,w.properties.location=C+Je),bn&&bn.properties.dist<w.properties.dist&&(w=bn,w.properties.index=re),C+=Je}}),w}var As=ia;function Ho(l,h){if(!l)throw new Error("line is required");if(!h)throw new Error("splitter is required");var v=ho(l),w=ho(h);if(v!=="LineString")throw new Error("line must be LineString");if(w==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(w==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var C=xa(h,{precision:7});switch(w){case"Point":return Zt(l,C);case"MultiPoint":return _t(l,C);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return _t(l,hs(l,C))}}function _t(l,h){var v=[],w=(0,hl.default)();return es(h,function(C){if(v.forEach(function(re,he){re.id=he}),!v.length)v=Zt(l,C).features,v.forEach(function(re){re.bbox||(re.bbox=Ju(wa(re)))}),w.load($t(v));else{var z=w.search(C);if(z.features.length){var X=At(C,z);v=v.filter(function(re){return re.id!==X.id}),w.remove(X),Vr(Zt(X,C),function(re){v.push(re),w.insert(re)})}}}),$t(v)}function Zt(l,h){var v=[],w=xi(l)[0],C=xi(l)[l.geometry.coordinates.length-1];if(An(w,pi(h))||An(C,pi(h)))return $t([l]);var z=(0,hl.default)(),X=Ha(l);z.load(X);var re=z.search(h);if(!re.features.length)return $t([l]);var he=At(h,re),Se=[w],Je=zo(X,function(ze,vt,kt){var Xt=xi(vt)[1],yn=pi(h);return kt===he.id?(ze.push(yn),v.push(xt(ze)),An(yn,Xt)?[yn]:[yn,Xt]):(ze.push(Xt),ze)},Se);return Je.length>1&&v.push(xt(Je)),$t(v)}function At(l,h){if(!h.features.length)throw new Error("lines must contain features");if(h.features.length===1)return h.features[0];var v,w=1/0;return Vr(h,function(C){var z=As(C,l),X=z.properties.dist;X<w&&(v=C,w=X)}),v}function An(l,h){return l[0]===h[0]&&l[1]===h[1]}var Kn=Ho;function wr(l,h,v){if(v===void 0&&(v={}),!l)throw new Error("point is required");if(!h)throw new Error("polygon is required");var w=pi(l),C=oo(h),z=C.type,X=h.bbox,re=C.coordinates;if(X&&Li(w,X)===!1)return!1;z==="Polygon"&&(re=[re]);for(var he=!1,Se=0;Se<re.length&&!he;Se++)if(Vi(w,re[Se][0],v.ignoreBoundary)){for(var Je=!1,ze=1;ze<re[Se].length&&!Je;)Vi(w,re[Se][ze],!v.ignoreBoundary)&&(Je=!0),ze++;Je||(he=!0)}return he}function Vi(l,h,v){var w=!1;h[0][0]===h[h.length-1][0]&&h[0][1]===h[h.length-1][1]&&(h=h.slice(0,h.length-1));for(var C=0,z=h.length-1;C<h.length;z=C++){var X=h[C][0],re=h[C][1],he=h[z][0],Se=h[z][1],Je=l[1]*(X-he)+re*(he-l[0])+Se*(l[0]-X)===0&&(X-l[0])*(he-l[0])<=0&&(re-l[1])*(Se-l[1])<=0;if(Je)return!v;var ze=re>l[1]!=Se>l[1]&&l[0]<(he-X)*(l[1]-re)/(Se-re)+X;ze&&(w=!w)}return w}function Li(l,h){return h[0]<=l[0]&&h[1]<=l[1]&&h[2]>=l[0]&&h[3]>=l[1]}function Ol(l,h,v){v===void 0&&(v={});for(var w=pi(l),C=xi(h),z=0;z<C.length-1;z++){var X=!1;if(v.ignoreEndVertices&&(z===0&&(X="start"),z===C.length-2&&(X="end"),z===0&&z+1===C.length-1&&(X="both")),rs(C[z],C[z+1],w,X,typeof v.epsilon>"u"?null:v.epsilon))return!0}return!1}function rs(l,h,v,w,C){var z=v[0],X=v[1],re=l[0],he=l[1],Se=h[0],Je=h[1],ze=v[0]-re,vt=v[1]-he,kt=Se-re,Xt=Je-he,yn=ze*Xt-vt*kt;if(C!==null){if(Math.abs(yn)>C)return!1}else if(yn!==0)return!1;if(w){if(w==="start")return Math.abs(kt)>=Math.abs(Xt)?kt>0?re<z&&z<=Se:Se<=z&&z<re:Xt>0?he<X&&X<=Je:Je<=X&&X<he;if(w==="end")return Math.abs(kt)>=Math.abs(Xt)?kt>0?re<=z&&z<Se:Se<z&&z<=re:Xt>0?he<=X&&X<Je:Je<X&&X<=he;if(w==="both")return Math.abs(kt)>=Math.abs(Xt)?kt>0?re<z&&z<Se:Se<z&&z<re:Xt>0?he<X&&X<Je:Je<X&&X<he}else return Math.abs(kt)>=Math.abs(Xt)?kt>0?re<=z&&z<=Se:Se<=z&&z<=re:Xt>0?he<=X&&X<=Je:Je<=X&&X<=he;return!1}var Gi=Ol;function oa(l,h){var v=oo(l),w=oo(h),C=v.type,z=w.type,X=v.coordinates,re=w.coordinates;switch(C){case"Point":switch(z){case"Point":return Ai(X,re);default:throw new Error("feature2 "+z+" geometry not supported")}case"MultiPoint":switch(z){case"Point":return Sa(v,w);case"MultiPoint":return sa(v,w);default:throw new Error("feature2 "+z+" geometry not supported")}case"LineString":switch(z){case"Point":return Gi(w,v,{ignoreEndVertices:!0});case"LineString":return Qr(v,w);case"MultiPoint":return aa(v,w);default:throw new Error("feature2 "+z+" geometry not supported")}case"Polygon":switch(z){case"Point":return wr(w,v,{ignoreBoundary:!0});case"LineString":return Ws(v,w);case"Polygon":return ko(v,w);case"MultiPoint":return la(v,w);default:throw new Error("feature2 "+z+" geometry not supported")}default:throw new Error("feature1 "+C+" geometry not supported")}}function Sa(l,h){var v,w=!1;for(v=0;v<l.coordinates.length;v++)if(Ai(l.coordinates[v],h.coordinates)){w=!0;break}return w}function sa(l,h){for(var v=0,w=h.coordinates;v<w.length;v++){for(var C=w[v],z=!1,X=0,re=l.coordinates;X<re.length;X++){var he=re[X];if(Ai(C,he)){z=!0;break}}if(!z)return!1}return!0}function aa(l,h){for(var v=!1,w=0,C=h.coordinates;w<C.length;w++){var z=C[w];if(Gi(z,l,{ignoreEndVertices:!0})&&(v=!0),!Gi(z,l))return!1}return!!v}function la(l,h){for(var v=0,w=h.coordinates;v<w.length;v++){var C=w[v];if(!wr(C,l,{ignoreBoundary:!0}))return!1}return!0}function Qr(l,h){for(var v=!1,w=0,C=h.coordinates;w<C.length;w++){var z=C[w];if(Gi({type:"Point",coordinates:z},l,{ignoreEndVertices:!0})&&(v=!0),!Gi({type:"Point",coordinates:z},l,{ignoreEndVertices:!1}))return!1}return v}function Ws(l,h){var v=!1,w=0,C=wa(l),z=wa(h);if(!Si(C,z))return!1;for(w;w<h.coordinates.length-1;w++){var X=so(h.coordinates[w],h.coordinates[w+1]);if(wr({type:"Point",coordinates:X},l,{ignoreBoundary:!0})){v=!0;break}}return v}function ko(l,h){if(l.type==="Feature"&&l.geometry===null||h.type==="Feature"&&h.geometry===null)return!1;var v=wa(l),w=wa(h);if(!Si(v,w))return!1;for(var C=oo(h).coordinates,z=0,X=C;z<X.length;z++)for(var re=X[z],he=0,Se=re;he<Se.length;he++){var Je=Se[he];if(!wr(Je,l))return!1}return!0}function Si(l,h){return!(l[0]>h[0]||l[2]<h[2]||l[1]>h[1]||l[3]<h[3])}function Ai(l,h){return l[0]===h[0]&&l[1]===h[1]}function so(l,h){return[(l[0]+h[0])/2,(l[1]+h[1])/2]}var Ri=f(ci()),ks=l=>()=>l,ds=l=>{let h=l?(v,w)=>w.minus(v).abs().isLessThanOrEqualTo(l):ks(!1);return(v,w)=>h(v,w)?0:v.comparedTo(w)};function Bs(l){let h=l?(v,w,C,z,X)=>v.exponentiatedBy(2).isLessThanOrEqualTo(z.minus(w).exponentiatedBy(2).plus(X.minus(C).exponentiatedBy(2)).times(l)):ks(!1);return(v,w,C)=>{let z=v.x,X=v.y,re=C.x,he=C.y,Se=X.minus(he).times(w.x.minus(re)).minus(z.minus(re).times(w.y.minus(he)));return h(Se,z,X,re,he)?0:Se.comparedTo(0)}}var xu=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,ua=Math.ceil,go=Math.floor,Oi="[BigNumber Error] ",qo=Oi+"Number primitive has more than 15 significant digits: ",ps=1e14,pr=14,Ca=9007199254740991,Ea=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],Zs=1e7,is=1e9;function bc(l){var h,v,w,C=Ye.prototype={constructor:Ye,toString:null,valueOf:null},z=new Ye(1),X=20,re=4,he=-7,Se=21,Je=-1e7,ze=1e7,vt=!1,kt=1,Xt=0,yn={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},bn="0123456789abcdefghijklmnopqrstuvwxyz",ur=!0;function Ye(ve,Me){var Be,Oe,Fe,je,ut,ct,gt,St,Ct=this;if(!(Ct instanceof Ye))return new Ye(ve,Me);if(Me==null){if(ve&&ve._isBigNumber===!0){Ct.s=ve.s,!ve.c||ve.e>ze?Ct.c=Ct.e=null:ve.e<Je?Ct.c=[Ct.e=0]:(Ct.e=ve.e,Ct.c=ve.c.slice());return}if((ct=typeof ve=="number")&&ve*0==0){if(Ct.s=1/ve<0?(ve=-ve,-1):1,ve===~~ve){for(je=0,ut=ve;ut>=10;ut/=10,je++);je>ze?Ct.c=Ct.e=null:(Ct.e=je,Ct.c=[ve]);return}St=String(ve)}else{if(!xu.test(St=String(ve)))return w(Ct,St,ct);Ct.s=St.charCodeAt(0)==45?(St=St.slice(1),-1):1}(je=St.indexOf("."))>-1&&(St=St.replace(".","")),(ut=St.search(/e/i))>0?(je<0&&(je=ut),je+=+St.slice(ut+1),St=St.substring(0,ut)):je<0&&(je=St.length)}else{if(a(Me,2,bn.length,"Base"),Me==10&&ur)return Ct=new Ye(ve),bt(Ct,X+Ct.e+1,re);if(St=String(ve),ct=typeof ve=="number"){if(ve*0!=0)return w(Ct,St,ct,Me);if(Ct.s=1/ve<0?(St=St.slice(1),-1):1,Ye.DEBUG&&St.replace(/^0\.0*|\./,"").length>15)throw Error(qo+ve)}else Ct.s=St.charCodeAt(0)===45?(St=St.slice(1),-1):1;for(Be=bn.slice(0,Me),je=ut=0,gt=St.length;ut<gt;ut++)if(Be.indexOf(Oe=St.charAt(ut))<0){if(Oe=="."){if(ut>je){je=gt;continue}}else if(!Fe&&(St==St.toUpperCase()&&(St=St.toLowerCase())||St==St.toLowerCase()&&(St=St.toUpperCase()))){Fe=!0,ut=-1,je=0;continue}return w(Ct,String(ve),ct,Me)}ct=!1,St=v(St,Me,10,Ct.s),(je=St.indexOf("."))>-1?St=St.replace(".",""):je=St.length}for(ut=0;St.charCodeAt(ut)===48;ut++);for(gt=St.length;St.charCodeAt(--gt)===48;);if(St=St.slice(ut,++gt)){if(gt-=ut,ct&&Ye.DEBUG&&gt>15&&(ve>Ca||ve!==go(ve)))throw Error(qo+Ct.s*ve);if((je=je-ut-1)>ze)Ct.c=Ct.e=null;else if(je<Je)Ct.c=[Ct.e=0];else{if(Ct.e=je,Ct.c=[],ut=(je+1)%pr,je<0&&(ut+=pr),ut<gt){for(ut&&Ct.c.push(+St.slice(0,ut)),gt-=pr;ut<gt;)Ct.c.push(+St.slice(ut,ut+=pr));ut=pr-(St=St.slice(ut)).length}else ut-=gt;for(;ut--;St+="0");Ct.c.push(+St)}}else Ct.c=[Ct.e=0]}Ye.clone=bc,Ye.ROUND_UP=0,Ye.ROUND_DOWN=1,Ye.ROUND_CEIL=2,Ye.ROUND_FLOOR=3,Ye.ROUND_HALF_UP=4,Ye.ROUND_HALF_DOWN=5,Ye.ROUND_HALF_EVEN=6,Ye.ROUND_HALF_CEIL=7,Ye.ROUND_HALF_FLOOR=8,Ye.EUCLID=9,Ye.config=Ye.set=function(ve){var Me,Be;if(ve!=null)if(typeof ve=="object"){if(ve.hasOwnProperty(Me="DECIMAL_PLACES")&&(Be=ve[Me],a(Be,0,is,Me),X=Be),ve.hasOwnProperty(Me="ROUNDING_MODE")&&(Be=ve[Me],a(Be,0,8,Me),re=Be),ve.hasOwnProperty(Me="EXPONENTIAL_AT")&&(Be=ve[Me],Be&&Be.pop?(a(Be[0],-1e9,0,Me),a(Be[1],0,is,Me),he=Be[0],Se=Be[1]):(a(Be,-1e9,is,Me),he=-(Se=Be<0?-Be:Be))),ve.hasOwnProperty(Me="RANGE"))if(Be=ve[Me],Be&&Be.pop)a(Be[0],-1e9,-1,Me),a(Be[1],1,is,Me),Je=Be[0],ze=Be[1];else if(a(Be,-1e9,is,Me),Be)Je=-(ze=Be<0?-Be:Be);else throw Error(Oi+Me+" cannot be zero: "+Be);if(ve.hasOwnProperty(Me="CRYPTO"))if(Be=ve[Me],Be===!!Be)if(Be)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))vt=Be;else throw vt=!Be,Error(Oi+"crypto unavailable");else vt=Be;else throw Error(Oi+Me+" not true or false: "+Be);if(ve.hasOwnProperty(Me="MODULO_MODE")&&(Be=ve[Me],a(Be,0,9,Me),kt=Be),ve.hasOwnProperty(Me="POW_PRECISION")&&(Be=ve[Me],a(Be,0,is,Me),Xt=Be),ve.hasOwnProperty(Me="FORMAT"))if(Be=ve[Me],typeof Be=="object")yn=Be;else throw Error(Oi+Me+" not an object: "+Be);if(ve.hasOwnProperty(Me="ALPHABET"))if(Be=ve[Me],typeof Be=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(Be))ur=Be.slice(0,10)=="0123456789",bn=Be;else throw Error(Oi+Me+" invalid: "+Be)}else throw Error(Oi+"Object expected: "+ve);return{DECIMAL_PLACES:X,ROUNDING_MODE:re,EXPONENTIAL_AT:[he,Se],RANGE:[Je,ze],CRYPTO:vt,MODULO_MODE:kt,POW_PRECISION:Xt,FORMAT:yn,ALPHABET:bn}},Ye.isBigNumber=function(ve){if(!ve||ve._isBigNumber!==!0)return!1;if(!Ye.DEBUG)return!0;var Me,Be,Oe=ve.c,Fe=ve.e,je=ve.s;e:if({}.toString.call(Oe)=="[object Array]"){if((je===1||je===-1)&&Fe>=-1e9&&Fe<=is&&Fe===go(Fe)){if(Oe[0]===0){if(Fe===0&&Oe.length===1)return!0;break e}if(Me=(Fe+1)%pr,Me<1&&(Me+=pr),String(Oe[0]).length==Me){for(Me=0;Me<Oe.length;Me++)if(Be=Oe[Me],Be<0||Be>=ps||Be!==go(Be))break e;if(Be!==0)return!0}}}else if(Oe===null&&Fe===null&&(je===null||je===1||je===-1))return!0;throw Error(Oi+"Invalid BigNumber: "+ve)},Ye.maximum=Ye.max=function(){return ht(arguments,-1)},Ye.minimum=Ye.min=function(){return ht(arguments,1)},Ye.random=function(){var ve=9007199254740992,Me=Math.random()*ve&2097151?function(){return go(Math.random()*ve)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(Be){var Oe,Fe,je,ut,ct,gt=0,St=[],Ct=new Ye(z);if(Be==null?Be=X:a(Be,0,is),ut=ua(Be/pr),vt)if(crypto.getRandomValues){for(Oe=crypto.getRandomValues(new Uint32Array(ut*=2));gt<ut;)ct=Oe[gt]*131072+(Oe[gt+1]>>>11),ct>=9e15?(Fe=crypto.getRandomValues(new Uint32Array(2)),Oe[gt]=Fe[0],Oe[gt+1]=Fe[1]):(St.push(ct%1e14),gt+=2);gt=ut/2}else if(crypto.randomBytes){for(Oe=crypto.randomBytes(ut*=7);gt<ut;)ct=(Oe[gt]&31)*281474976710656+Oe[gt+1]*1099511627776+Oe[gt+2]*4294967296+Oe[gt+3]*16777216+(Oe[gt+4]<<16)+(Oe[gt+5]<<8)+Oe[gt+6],ct>=9e15?crypto.randomBytes(7).copy(Oe,gt):(St.push(ct%1e14),gt+=7);gt=ut/7}else throw vt=!1,Error(Oi+"crypto unavailable");if(!vt)for(;gt<ut;)ct=Me(),ct<9e15&&(St[gt++]=ct%1e14);for(ut=St[--gt],Be%=pr,ut&&Be&&(ct=Ea[pr-Be],St[gt]=go(ut/ct)*ct);St[gt]===0;St.pop(),gt--);if(gt<0)St=[je=0];else{for(je=-1;St[0]===0;St.splice(0,1),je-=pr);for(gt=1,ct=St[0];ct>=10;ct/=10,gt++);gt<pr&&(je-=pr-gt)}return Ct.e=je,Ct.c=St,Ct}}(),Ye.sum=function(){for(var ve=1,Me=arguments,Be=new Ye(Me[0]);ve<Me.length;)Be=Be.plus(Me[ve++]);return Be},v=function(){var ve="0123456789";function Me(Be,Oe,Fe,je){for(var ut,ct=[0],gt,St=0,Ct=Be.length;St<Ct;){for(gt=ct.length;gt--;ct[gt]*=Oe);for(ct[0]+=je.indexOf(Be.charAt(St++)),ut=0;ut<ct.length;ut++)ct[ut]>Fe-1&&(ct[ut+1]==null&&(ct[ut+1]=0),ct[ut+1]+=ct[ut]/Fe|0,ct[ut]%=Fe)}return ct.reverse()}return function(Be,Oe,Fe,je,ut){var ct,gt,St,Ct,on,$n,Hn,er,vi=Be.indexOf("."),ki=X,ei=re;for(vi>=0&&(Ct=Xt,Xt=0,Be=Be.replace(".",""),er=new Ye(Oe),$n=er.pow(Be.length-vi),Xt=Ct,er.c=Me(V(No($n.c),$n.e,"0"),10,Fe,ve),er.e=er.c.length),Hn=Me(Be,Oe,Fe,ut?(ct=bn,ve):(ct=ve,bn)),St=Ct=Hn.length;Hn[--Ct]==0;Hn.pop());if(!Hn[0])return ct.charAt(0);if(vi<0?--St:($n.c=Hn,$n.e=St,$n.s=je,$n=h($n,er,ki,ei,Fe),Hn=$n.c,on=$n.r,St=$n.e),gt=St+ki+1,vi=Hn[gt],Ct=Fe/2,on=on||gt<0||Hn[gt+1]!=null,on=ei<4?(vi!=null||on)&&(ei==0||ei==($n.s<0?3:2)):vi>Ct||vi==Ct&&(ei==4||on||ei==6&&Hn[gt-1]&1||ei==($n.s<0?8:7)),gt<1||!Hn[0])Be=on?V(ct.charAt(1),-ki,ct.charAt(0)):ct.charAt(0);else{if(Hn.length=gt,on)for(--Fe;++Hn[--gt]>Fe;)Hn[gt]=0,gt||(++St,Hn=[1].concat(Hn));for(Ct=Hn.length;!Hn[--Ct];);for(vi=0,Be="";vi<=Ct;Be+=ct.charAt(Hn[vi++]));Be=V(Be,St,ct.charAt(0))}return Be}}(),h=function(){function ve(Oe,Fe,je){var ut,ct,gt,St,Ct=0,on=Oe.length,$n=Fe%Zs,Hn=Fe/Zs|0;for(Oe=Oe.slice();on--;)gt=Oe[on]%Zs,St=Oe[on]/Zs|0,ut=Hn*gt+St*$n,ct=$n*gt+ut%Zs*Zs+Ct,Ct=(ct/je|0)+(ut/Zs|0)+Hn*St,Oe[on]=ct%je;return Ct&&(Oe=[Ct].concat(Oe)),Oe}function Me(Oe,Fe,je,ut){var ct,gt;if(je!=ut)gt=je>ut?1:-1;else for(ct=gt=0;ct<je;ct++)if(Oe[ct]!=Fe[ct]){gt=Oe[ct]>Fe[ct]?1:-1;break}return gt}function Be(Oe,Fe,je,ut){for(var ct=0;je--;)Oe[je]-=ct,ct=Oe[je]<Fe[je]?1:0,Oe[je]=ct*ut+Oe[je]-Fe[je];for(;!Oe[0]&&Oe.length>1;Oe.splice(0,1));}return function(Oe,Fe,je,ut,ct){var gt,St,Ct,on,$n,Hn,er,vi,ki,ei,Fi,vs,Su,fa,Nf,Wa,Qu,ha=Oe.s==Fe.s?1:-1,Zo=Oe.c,ao=Fe.c;if(!Zo||!Zo[0]||!ao||!ao[0])return new Ye(!Oe.s||!Fe.s||(Zo?ao&&Zo[0]==ao[0]:!ao)?NaN:Zo&&Zo[0]==0||!ao?ha*0:ha/0);for(vi=new Ye(ha),ki=vi.c=[],St=Oe.e-Fe.e,ha=je+St+1,ct||(ct=ps,St=To(Oe.e/pr)-To(Fe.e/pr),ha=ha/pr|0),Ct=0;ao[Ct]==(Zo[Ct]||0);Ct++);if(ao[Ct]>(Zo[Ct]||0)&&St--,ha<0)ki.push(1),on=!0;else{for(fa=Zo.length,Wa=ao.length,Ct=0,ha+=2,$n=go(ct/(ao[0]+1)),$n>1&&(ao=ve(ao,$n,ct),Zo=ve(Zo,$n,ct),Wa=ao.length,fa=Zo.length),Su=Wa,ei=Zo.slice(0,Wa),Fi=ei.length;Fi<Wa;ei[Fi++]=0);Qu=ao.slice(),Qu=[0].concat(Qu),Nf=ao[0],ao[1]>=ct/2&&Nf++;do{if($n=0,gt=Me(ao,ei,Wa,Fi),gt<0){if(vs=ei[0],Wa!=Fi&&(vs=vs*ct+(ei[1]||0)),$n=go(vs/Nf),$n>1)for($n>=ct&&($n=ct-1),Hn=ve(ao,$n,ct),er=Hn.length,Fi=ei.length;Me(Hn,ei,er,Fi)==1;)$n--,Be(Hn,Wa<er?Qu:ao,er,ct),er=Hn.length,gt=1;else $n==0&&(gt=$n=1),Hn=ao.slice(),er=Hn.length;if(er<Fi&&(Hn=[0].concat(Hn)),Be(ei,Hn,Fi,ct),Fi=ei.length,gt==-1)for(;Me(ao,ei,Wa,Fi)<1;)$n++,Be(ei,Wa<Fi?Qu:ao,Fi,ct),Fi=ei.length}else gt===0&&($n++,ei=[0]);ki[Ct++]=$n,ei[0]?ei[Fi++]=Zo[Su]||0:(ei=[Zo[Su]],Fi=1)}while((Su++<fa||ei[0]!=null)&&ha--);on=ei[0]!=null,ki[0]||ki.splice(0,1)}if(ct==ps){for(Ct=1,ha=ki[0];ha>=10;ha/=10,Ct++);bt(vi,je+(vi.e=Ct+St*pr-1)+1,ut,on)}else vi.e=St,vi.r=+on;return vi}}();function nt(ve,Me,Be,Oe){var Fe,je,ut,ct,gt;if(Be==null?Be=re:a(Be,0,8),!ve.c)return ve.toString();if(Fe=ve.c[0],ut=ve.e,Me==null)gt=No(ve.c),gt=Oe==1||Oe==2&&(ut<=he||ut>=Se)?S(gt,ut):V(gt,ut,"0");else if(ve=bt(new Ye(ve),Me,Be),je=ve.e,gt=No(ve.c),ct=gt.length,Oe==1||Oe==2&&(Me<=je||je<=he)){for(;ct<Me;gt+="0",ct++);gt=S(gt,je)}else if(Me-=ut,gt=V(gt,je,"0"),je+1>ct){if(--Me>0)for(gt+=".";Me--;gt+="0");}else if(Me+=je-ct,Me>0)for(je+1==ct&&(gt+=".");Me--;gt+="0");return ve.s<0&&Fe?"-"+gt:gt}function ht(ve,Me){for(var Be,Oe,Fe=1,je=new Ye(ve[0]);Fe<ve.length;Fe++)Oe=new Ye(ve[Fe]),(!Oe.s||(Be=Ks(je,Oe))===Me||Be===0&&je.s===Me)&&(je=Oe);return je}function Ot(ve,Me,Be){for(var Oe=1,Fe=Me.length;!Me[--Fe];Me.pop());for(Fe=Me[0];Fe>=10;Fe/=10,Oe++);return(Be=Oe+Be*pr-1)>ze?ve.c=ve.e=null:Be<Je?ve.c=[ve.e=0]:(ve.e=Be,ve.c=Me),ve}w=function(){var ve=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Me=/^([^.]+)\.$/,Be=/^\.([^.]+)$/,Oe=/^-?(Infinity|NaN)$/,Fe=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(je,ut,ct,gt){var St,Ct=ct?ut:ut.replace(Fe,"");if(Oe.test(Ct))je.s=isNaN(Ct)?null:Ct<0?-1:1;else{if(!ct&&(Ct=Ct.replace(ve,function(on,$n,Hn){return St=(Hn=Hn.toLowerCase())=="x"?16:Hn=="b"?2:8,!gt||gt==St?$n:on}),gt&&(St=gt,Ct=Ct.replace(Me,"$1").replace(Be,"0.$1")),ut!=Ct))return new Ye(Ct,St);if(Ye.DEBUG)throw Error(Oi+"Not a"+(gt?" base "+gt:"")+" number: "+ut);je.s=null}je.c=je.e=null}}();function bt(ve,Me,Be,Oe){var Fe,je,ut,ct,gt,St,Ct,on=ve.c,$n=Ea;if(on){e:{for(Fe=1,ct=on[0];ct>=10;ct/=10,Fe++);if(je=Me-Fe,je<0)je+=pr,ut=Me,gt=on[St=0],Ct=go(gt/$n[Fe-ut-1]%10);else if(St=ua((je+1)/pr),St>=on.length)if(Oe){for(;on.length<=St;on.push(0));gt=Ct=0,Fe=1,je%=pr,ut=je-pr+1}else break e;else{for(gt=ct=on[St],Fe=1;ct>=10;ct/=10,Fe++);je%=pr,ut=je-pr+Fe,Ct=ut<0?0:go(gt/$n[Fe-ut-1]%10)}if(Oe=Oe||Me<0||on[St+1]!=null||(ut<0?gt:gt%$n[Fe-ut-1]),Oe=Be<4?(Ct||Oe)&&(Be==0||Be==(ve.s<0?3:2)):Ct>5||Ct==5&&(Be==4||Oe||Be==6&&(je>0?ut>0?gt/$n[Fe-ut]:0:on[St-1])%10&1||Be==(ve.s<0?8:7)),Me<1||!on[0])return on.length=0,Oe?(Me-=ve.e+1,on[0]=$n[(pr-Me%pr)%pr],ve.e=-Me||0):on[0]=ve.e=0,ve;if(je==0?(on.length=St,ct=1,St--):(on.length=St+1,ct=$n[pr-je],on[St]=ut>0?go(gt/$n[Fe-ut]%$n[ut])*ct:0),Oe)for(;;)if(St==0){for(je=1,ut=on[0];ut>=10;ut/=10,je++);for(ut=on[0]+=ct,ct=1;ut>=10;ut/=10,ct++);je!=ct&&(ve.e++,on[0]==ps&&(on[0]=1));break}else{if(on[St]+=ct,on[St]!=ps)break;on[St--]=0,ct=1}for(je=on.length;on[--je]===0;on.pop());}ve.e>ze?ve.c=ve.e=null:ve.e<Je&&(ve.c=[ve.e=0])}return ve}function Tt(ve){var Me,Be=ve.e;return Be===null?ve.toString():(Me=No(ve.c),Me=Be<=he||Be>=Se?S(Me,Be):V(Me,Be,"0"),ve.s<0?"-"+Me:Me)}return C.absoluteValue=C.abs=function(){var ve=new Ye(this);return ve.s<0&&(ve.s=1),ve},C.comparedTo=function(ve,Me){return Ks(this,new Ye(ve,Me))},C.decimalPlaces=C.dp=function(ve,Me){var Be,Oe,Fe,je=this;if(ve!=null)return a(ve,0,is),Me==null?Me=re:a(Me,0,8),bt(new Ye(je),ve+je.e+1,Me);if(!(Be=je.c))return null;if(Oe=((Fe=Be.length-1)-To(this.e/pr))*pr,Fe=Be[Fe])for(;Fe%10==0;Fe/=10,Oe--);return Oe<0&&(Oe=0),Oe},C.dividedBy=C.div=function(ve,Me){return h(this,new Ye(ve,Me),X,re)},C.dividedToIntegerBy=C.idiv=function(ve,Me){return h(this,new Ye(ve,Me),0,1)},C.exponentiatedBy=C.pow=function(ve,Me){var Be,Oe,Fe,je,ut,ct,gt,St,Ct,on=this;if(ve=new Ye(ve),ve.c&&!ve.isInteger())throw Error(Oi+"Exponent not an integer: "+Tt(ve));if(Me!=null&&(Me=new Ye(Me)),ct=ve.e>14,!on.c||!on.c[0]||on.c[0]==1&&!on.e&&on.c.length==1||!ve.c||!ve.c[0])return Ct=new Ye(Math.pow(+Tt(on),ct?ve.s*(2-p(ve)):+Tt(ve))),Me?Ct.mod(Me):Ct;if(gt=ve.s<0,Me){if(Me.c?!Me.c[0]:!Me.s)return new Ye(NaN);Oe=!gt&&on.isInteger()&&Me.isInteger(),Oe&&(on=on.mod(Me))}else{if(ve.e>9&&(on.e>0||on.e<-1||(on.e==0?on.c[0]>1||ct&&on.c[1]>=24e7:on.c[0]<8e13||ct&&on.c[0]<=9999975e7)))return je=on.s<0&&p(ve)?-0:0,on.e>-1&&(je=1/je),new Ye(gt?1/je:je);Xt&&(je=ua(Xt/pr+2))}for(ct?(Be=new Ye(.5),gt&&(ve.s=1),St=p(ve)):(Fe=Math.abs(+Tt(ve)),St=Fe%2),Ct=new Ye(z);;){if(St){if(Ct=Ct.times(on),!Ct.c)break;je?Ct.c.length>je&&(Ct.c.length=je):Oe&&(Ct=Ct.mod(Me))}if(Fe){if(Fe=go(Fe/2),Fe===0)break;St=Fe%2}else if(ve=ve.times(Be),bt(ve,ve.e+1,1),ve.e>14)St=p(ve);else{if(Fe=+Tt(ve),Fe===0)break;St=Fe%2}on=on.times(on),je?on.c&&on.c.length>je&&(on.c.length=je):Oe&&(on=on.mod(Me))}return Oe?Ct:(gt&&(Ct=z.div(Ct)),Me?Ct.mod(Me):je?bt(Ct,Xt,re,ut):Ct)},C.integerValue=function(ve){var Me=new Ye(this);return ve==null?ve=re:a(ve,0,8),bt(Me,Me.e+1,ve)},C.isEqualTo=C.eq=function(ve,Me){return Ks(this,new Ye(ve,Me))===0},C.isFinite=function(){return!!this.c},C.isGreaterThan=C.gt=function(ve,Me){return Ks(this,new Ye(ve,Me))>0},C.isGreaterThanOrEqualTo=C.gte=function(ve,Me){return(Me=Ks(this,new Ye(ve,Me)))===1||Me===0},C.isInteger=function(){return!!this.c&&To(this.e/pr)>this.c.length-2},C.isLessThan=C.lt=function(ve,Me){return Ks(this,new Ye(ve,Me))<0},C.isLessThanOrEqualTo=C.lte=function(ve,Me){return(Me=Ks(this,new Ye(ve,Me)))===-1||Me===0},C.isNaN=function(){return!this.s},C.isNegative=function(){return this.s<0},C.isPositive=function(){return this.s>0},C.isZero=function(){return!!this.c&&this.c[0]==0},C.minus=function(ve,Me){var Be,Oe,Fe,je,ut=this,ct=ut.s;if(ve=new Ye(ve,Me),Me=ve.s,!ct||!Me)return new Ye(NaN);if(ct!=Me)return ve.s=-Me,ut.plus(ve);var gt=ut.e/pr,St=ve.e/pr,Ct=ut.c,on=ve.c;if(!gt||!St){if(!Ct||!on)return Ct?(ve.s=-Me,ve):new Ye(on?ut:NaN);if(!Ct[0]||!on[0])return on[0]?(ve.s=-Me,ve):new Ye(Ct[0]?ut:re==3?-0:0)}if(gt=To(gt),St=To(St),Ct=Ct.slice(),ct=gt-St){for((je=ct<0)?(ct=-ct,Fe=Ct):(St=gt,Fe=on),Fe.reverse(),Me=ct;Me--;Fe.push(0));Fe.reverse()}else for(Oe=(je=(ct=Ct.length)<(Me=on.length))?ct:Me,ct=Me=0;Me<Oe;Me++)if(Ct[Me]!=on[Me]){je=Ct[Me]<on[Me];break}if(je&&(Fe=Ct,Ct=on,on=Fe,ve.s=-ve.s),Me=(Oe=on.length)-(Be=Ct.length),Me>0)for(;Me--;Ct[Be++]=0);for(Me=ps-1;Oe>ct;){if(Ct[--Oe]<on[Oe]){for(Be=Oe;Be&&!Ct[--Be];Ct[Be]=Me);--Ct[Be],Ct[Oe]+=ps}Ct[Oe]-=on[Oe]}for(;Ct[0]==0;Ct.splice(0,1),--St);return Ct[0]?Ot(ve,Ct,St):(ve.s=re==3?-1:1,ve.c=[ve.e=0],ve)},C.modulo=C.mod=function(ve,Me){var Be,Oe,Fe=this;return ve=new Ye(ve,Me),!Fe.c||!ve.s||ve.c&&!ve.c[0]?new Ye(NaN):!ve.c||Fe.c&&!Fe.c[0]?new Ye(Fe):(kt==9?(Oe=ve.s,ve.s=1,Be=h(Fe,ve,0,3),ve.s=Oe,Be.s*=Oe):Be=h(Fe,ve,0,kt),ve=Fe.minus(Be.times(ve)),!ve.c[0]&&kt==1&&(ve.s=Fe.s),ve)},C.multipliedBy=C.times=function(ve,Me){var Be,Oe,Fe,je,ut,ct,gt,St,Ct,on,$n,Hn,er,vi,ki,ei=this,Fi=ei.c,vs=(ve=new Ye(ve,Me)).c;if(!Fi||!vs||!Fi[0]||!vs[0])return!ei.s||!ve.s||Fi&&!Fi[0]&&!vs||vs&&!vs[0]&&!Fi?ve.c=ve.e=ve.s=null:(ve.s*=ei.s,!Fi||!vs?ve.c=ve.e=null:(ve.c=[0],ve.e=0)),ve;for(Oe=To(ei.e/pr)+To(ve.e/pr),ve.s*=ei.s,gt=Fi.length,on=vs.length,gt<on&&(er=Fi,Fi=vs,vs=er,Fe=gt,gt=on,on=Fe),Fe=gt+on,er=[];Fe--;er.push(0));for(vi=ps,ki=Zs,Fe=on;--Fe>=0;){for(Be=0,$n=vs[Fe]%ki,Hn=vs[Fe]/ki|0,ut=gt,je=Fe+ut;je>Fe;)St=Fi[--ut]%ki,Ct=Fi[ut]/ki|0,ct=Hn*St+Ct*$n,St=$n*St+ct%ki*ki+er[je]+Be,Be=(St/vi|0)+(ct/ki|0)+Hn*Ct,er[je--]=St%vi;er[je]=Be}return Be?++Oe:er.splice(0,1),Ot(ve,er,Oe)},C.negated=function(){var ve=new Ye(this);return ve.s=-ve.s||null,ve},C.plus=function(ve,Me){var Be,Oe=this,Fe=Oe.s;if(ve=new Ye(ve,Me),Me=ve.s,!Fe||!Me)return new Ye(NaN);if(Fe!=Me)return ve.s=-Me,Oe.minus(ve);var je=Oe.e/pr,ut=ve.e/pr,ct=Oe.c,gt=ve.c;if(!je||!ut){if(!ct||!gt)return new Ye(Fe/0);if(!ct[0]||!gt[0])return gt[0]?ve:new Ye(ct[0]?Oe:Fe*0)}if(je=To(je),ut=To(ut),ct=ct.slice(),Fe=je-ut){for(Fe>0?(ut=je,Be=gt):(Fe=-Fe,Be=ct),Be.reverse();Fe--;Be.push(0));Be.reverse()}for(Fe=ct.length,Me=gt.length,Fe-Me<0&&(Be=gt,gt=ct,ct=Be,Me=Fe),Fe=0;Me;)Fe=(ct[--Me]=ct[Me]+gt[Me]+Fe)/ps|0,ct[Me]=ps===ct[Me]?0:ct[Me]%ps;return Fe&&(ct=[Fe].concat(ct),++ut),Ot(ve,ct,ut)},C.precision=C.sd=function(ve,Me){var Be,Oe,Fe,je=this;if(ve!=null&&ve!==!!ve)return a(ve,1,is),Me==null?Me=re:a(Me,0,8),bt(new Ye(je),ve,Me);if(!(Be=je.c))return null;if(Fe=Be.length-1,Oe=Fe*pr+1,Fe=Be[Fe]){for(;Fe%10==0;Fe/=10,Oe--);for(Fe=Be[0];Fe>=10;Fe/=10,Oe++);}return ve&&je.e+1>Oe&&(Oe=je.e+1),Oe},C.shiftedBy=function(ve){return a(ve,-9007199254740991,Ca),this.times("1e"+ve)},C.squareRoot=C.sqrt=function(){var ve,Me,Be,Oe,Fe,je=this,ut=je.c,ct=je.s,gt=je.e,St=X+4,Ct=new Ye("0.5");if(ct!==1||!ut||!ut[0])return new Ye(!ct||ct<0&&(!ut||ut[0])?NaN:ut?je:1/0);if(ct=Math.sqrt(+Tt(je)),ct==0||ct==1/0?(Me=No(ut),(Me.length+gt)%2==0&&(Me+="0"),ct=Math.sqrt(+Me),gt=To((gt+1)/2)-(gt<0||gt%2),ct==1/0?Me="5e"+gt:(Me=ct.toExponential(),Me=Me.slice(0,Me.indexOf("e")+1)+gt),Be=new Ye(Me)):Be=new Ye(ct+""),Be.c[0]){for(gt=Be.e,ct=gt+St,ct<3&&(ct=0);;)if(Fe=Be,Be=Ct.times(Fe.plus(h(je,Fe,St,1))),No(Fe.c).slice(0,ct)===(Me=No(Be.c)).slice(0,ct))if(Be.e<gt&&--ct,Me=Me.slice(ct-3,ct+1),Me=="9999"||!Oe&&Me=="4999"){if(!Oe&&(bt(Fe,Fe.e+X+2,0),Fe.times(Fe).eq(je))){Be=Fe;break}St+=4,ct+=4,Oe=1}else{(!+Me||!+Me.slice(1)&&Me.charAt(0)=="5")&&(bt(Be,Be.e+X+2,1),ve=!Be.times(Be).eq(je));break}}return bt(Be,Be.e+X+1,re,ve)},C.toExponential=function(ve,Me){return ve!=null&&(a(ve,0,is),ve++),nt(this,ve,Me,1)},C.toFixed=function(ve,Me){return ve!=null&&(a(ve,0,is),ve=ve+this.e+1),nt(this,ve,Me)},C.toFormat=function(ve,Me,Be){var Oe,Fe=this;if(Be==null)ve!=null&&Me&&typeof Me=="object"?(Be=Me,Me=null):ve&&typeof ve=="object"?(Be=ve,ve=Me=null):Be=yn;else if(typeof Be!="object")throw Error(Oi+"Argument not an object: "+Be);if(Oe=Fe.toFixed(ve,Me),Fe.c){var je,ut=Oe.split("."),ct=+Be.groupSize,gt=+Be.secondaryGroupSize,St=Be.groupSeparator||"",Ct=ut[0],on=ut[1],$n=Fe.s<0,Hn=$n?Ct.slice(1):Ct,er=Hn.length;if(gt&&(je=ct,ct=gt,gt=je,er-=je),ct>0&&er>0){for(je=er%ct||ct,Ct=Hn.substr(0,je);je<er;je+=ct)Ct+=St+Hn.substr(je,ct);gt>0&&(Ct+=St+Hn.slice(je)),$n&&(Ct="-"+Ct)}Oe=on?Ct+(Be.decimalSeparator||"")+((gt=+Be.fractionGroupSize)?on.replace(new RegExp("\\d{"+gt+"}\\B","g"),"$&"+(Be.fractionGroupSeparator||"")):on):Ct}return(Be.prefix||"")+Oe+(Be.suffix||"")},C.toFraction=function(ve){var Me,Be,Oe,Fe,je,ut,ct,gt,St,Ct,on,$n,Hn=this,er=Hn.c;if(ve!=null&&(ct=new Ye(ve),!ct.isInteger()&&(ct.c||ct.s!==1)||ct.lt(z)))throw Error(Oi+"Argument "+(ct.isInteger()?"out of range: ":"not an integer: ")+Tt(ct));if(!er)return new Ye(Hn);for(Me=new Ye(z),St=Be=new Ye(z),Oe=gt=new Ye(z),$n=No(er),je=Me.e=$n.length-Hn.e-1,Me.c[0]=Ea[(ut=je%pr)<0?pr+ut:ut],ve=!ve||ct.comparedTo(Me)>0?je>0?Me:St:ct,ut=ze,ze=1/0,ct=new Ye($n),gt.c[0]=0;Ct=h(ct,Me,0,1),Fe=Be.plus(Ct.times(Oe)),Fe.comparedTo(ve)!=1;)Be=Oe,Oe=Fe,St=gt.plus(Ct.times(Fe=St)),gt=Fe,Me=ct.minus(Ct.times(Fe=Me)),ct=Fe;return Fe=h(ve.minus(Be),Oe,0,1),gt=gt.plus(Fe.times(St)),Be=Be.plus(Fe.times(Oe)),gt.s=St.s=Hn.s,je=je*2,on=h(St,Oe,je,re).minus(Hn).abs().comparedTo(h(gt,Be,je,re).minus(Hn).abs())<1?[St,Oe]:[gt,Be],ze=ut,on},C.toNumber=function(){return+Tt(this)},C.toPrecision=function(ve,Me){return ve!=null&&a(ve,1,is),nt(this,ve,Me,2)},C.toString=function(ve){var Me,Be=this,Oe=Be.s,Fe=Be.e;return Fe===null?Oe?(Me="Infinity",Oe<0&&(Me="-"+Me)):Me="NaN":(ve==null?Me=Fe<=he||Fe>=Se?S(No(Be.c),Fe):V(No(Be.c),Fe,"0"):ve===10&&ur?(Be=bt(new Ye(Be),X+Fe+1,re),Me=V(No(Be.c),Be.e,"0")):(a(ve,2,bn.length,"Base"),Me=v(V(No(Be.c),Fe,"0"),10,ve,Oe,!0)),Oe<0&&Be.c[0]&&(Me="-"+Me)),Me},C.valueOf=C.toJSON=function(){return Tt(this)},C._isBigNumber=!0,C[Symbol.toStringTag]="BigNumber",C[Symbol.for("nodejs.util.inspect.custom")]=C.valueOf,l!=null&&Ye.set(l),Ye}function To(l){var h=l|0;return l>0||l===h?h:h-1}function No(l){for(var h,v,w=1,C=l.length,z=l[0]+"";w<C;){for(h=l[w++]+"",v=pr-h.length;v--;h="0"+h);z+=h}for(C=z.length;z.charCodeAt(--C)===48;);return z.slice(0,C+1||1)}function Ks(l,h){var v,w,C=l.c,z=h.c,X=l.s,re=h.s,he=l.e,Se=h.e;if(!X||!re)return null;if(v=C&&!C[0],w=z&&!z[0],v||w)return v?w?0:-re:X;if(X!=re)return X;if(v=X<0,w=he==Se,!C||!z)return w?0:!C^v?1:-1;if(!w)return he>Se^v?1:-1;for(re=(he=C.length)<(Se=z.length)?he:Se,X=0;X<re;X++)if(C[X]!=z[X])return C[X]>z[X]^v?1:-1;return he==Se?0:he>Se^v?1:-1}function a(l,h,v,w){if(l<h||l>v||l!==go(l))throw Error(Oi+(w||"Argument")+(typeof l=="number"?l<h||l>v?" out of range: ":" not an integer: ":" not a primitive number: ")+String(l))}function p(l){var h=l.c.length-1;return To(l.e/pr)==h&&l.c[h]%2!=0}function S(l,h){return(l.length>1?l.charAt(0)+"."+l.slice(1):l)+(h<0?"e":"e+")+h}function V(l,h,v){var w,C;if(h<0){for(C=v+".";++h;C+=v);l=C+l}else if(w=l.length,++h>w){for(C=v,h-=w;--h;C+=v);l+=C}else h<w&&(l=l.slice(0,h)+"."+l.slice(h));return l}var ie=bc(),Ce=ie,st=class{constructor(l){Gt(this,"key");Gt(this,"left",null);Gt(this,"right",null);this.key=l}},Pt=class extends st{constructor(l){super(l)}},Ut=class{constructor(){Gt(this,"size",0);Gt(this,"modificationCount",0);Gt(this,"splayCount",0)}splay(l){let h=this.root;if(h==null)return this.compare(l,l),-1;let v=null,w=null,C=null,z=null,X=h,re=this.compare,he;for(;;)if(he=re(X.key,l),he>0){let Se=X.left;if(Se==null||(he=re(Se.key,l),he>0&&(X.left=Se.right,Se.right=X,X=Se,Se=X.left,Se==null)))break;v==null?w=X:v.left=X,v=X,X=Se}else if(he<0){let Se=X.right;if(Se==null||(he=re(Se.key,l),he<0&&(X.right=Se.left,Se.left=X,X=Se,Se=X.right,Se==null)))break;C==null?z=X:C.right=X,C=X,X=Se}else break;return C!=null&&(C.right=X.left,X.left=z),v!=null&&(v.left=X.right,X.right=w),this.root!==X&&(this.root=X,this.splayCount++),he}splayMin(l){let h=l,v=h.left;for(;v!=null;){let w=v;h.left=w.right,w.right=h,h=w,v=h.left}return h}splayMax(l){let h=l,v=h.right;for(;v!=null;){let w=v;h.right=w.left,w.left=h,h=w,v=h.right}return h}_delete(l){if(this.root==null||this.splay(l)!=0)return null;let h=this.root,v=h,w=h.left;if(this.size--,w==null)this.root=h.right;else{let C=h.right;h=this.splayMax(w),h.right=C,this.root=h}return this.modificationCount++,v}addNewRoot(l,h){this.size++,this.modificationCount++;let v=this.root;if(v==null){this.root=l;return}h<0?(l.left=v,l.right=v.right,v.right=null):(l.right=v,l.left=v.left,v.left=null),this.root=l}_first(){let l=this.root;return l==null?null:(this.root=this.splayMin(l),this.root)}_last(){let l=this.root;return l==null?null:(this.root=this.splayMax(l),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(l){return this.validKey(l)&&this.splay(l)==0}defaultCompare(){return(l,h)=>l<h?-1:l>h?1:0}wrap(){return{getRoot:()=>this.root,setRoot:l=>{this.root=l},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:l=>{this.splayCount=l},splay:l=>this.splay(l),has:l=>this.has(l)}}},an=class Ud extends Ut{constructor(v,w){super();Gt(this,"root",null);Gt(this,"compare");Gt(this,"validKey");Gt(this,Sn,"[object Set]");this.compare=v??this.defaultCompare(),this.validKey=w??(C=>C!=null&&C!=null)}delete(v){return this.validKey(v)?this._delete(v)!=null:!1}deleteAll(v){for(let w of v)this.delete(w)}forEach(v){let w=this[Symbol.iterator](),C;for(;C=w.next(),!C.done;)v(C.value,C.value,this)}add(v){let w=this.splay(v);return w!=0&&this.addNewRoot(new Pt(v),w),this}addAndReturn(v){let w=this.splay(v);return w!=0&&this.addNewRoot(new Pt(v),w),this.root.key}addAll(v){for(let w of v)this.add(w)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(v){if(v==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(v)<0)return this.root.key;let w=this.root.left;if(w==null)return null;let C=w.right;for(;C!=null;)w=C,C=w.right;return w.key}firstAfter(v){if(v==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(v)>0)return this.root.key;let w=this.root.right;if(w==null)return null;let C=w.left;for(;C!=null;)w=C,C=w.left;return w.key}retainAll(v){let w=new Ud(this.compare,this.validKey),C=this.modificationCount;for(let z of v){if(C!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(z)&&this.splay(z)==0&&w.add(this.root.key)}w.size!=this.size&&(this.root=w.root,this.size=w.size,this.modificationCount++)}lookup(v){return!this.validKey(v)||this.splay(v)!=0?null:this.root.key}intersection(v){let w=new Ud(this.compare,this.validKey);for(let C of this)v.has(C)&&w.add(C);return w}difference(v){let w=new Ud(this.compare,this.validKey);for(let C of this)v.has(C)||w.add(C);return w}union(v){let w=this.clone();return w.addAll(v),w}clone(){let v=new Ud(this.compare,this.validKey);return v.size=this.size,v.root=this.copyNode(this.root),v}copyNode(v){if(v==null)return null;function w(z,X){let re,he;do{if(re=z.left,he=z.right,re!=null){let Se=new Pt(re.key);X.left=Se,w(re,Se)}if(he!=null){let Se=new Pt(he.key);X.right=Se,z=he,X=Se}}while(he!=null)}let C=new Pt(v.key);return w(v,C),C}toSet(){return this.clone()}entries(){return new zr(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[(Qn=Symbol.iterator,Sn=Symbol.toStringTag,Qn)](){return new Xn(this.wrap())}},Dn=class{constructor(l){Gt(this,"tree");Gt(this,"path",new Array);Gt(this,"modificationCount",null);Gt(this,"splayCount");this.tree=l,this.splayCount=l.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;let l=this.path[this.path.length-1];return this.getValue(l)}rebuildPath(l){this.path.splice(0,this.path.length),this.tree.splay(l),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(l){for(;l!=null;)this.path.push(l),l=l.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let v=this.tree.getRoot();for(;v!=null;)this.path.push(v),v=v.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let l=this.path[this.path.length-1],h=l.right;if(h!=null){for(;h!=null;)this.path.push(h),h=h.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===l;)l=this.path.pop();return this.path.length>0}},Xn=class extends Dn{getValue(l){return l.key}},zr=class extends Dn{getValue(l){return[l.key,l.key]}},mo=l=>l,Ji=l=>{if(l){let h=new an(ds(l)),v=new an(ds(l)),w=(z,X)=>X.addAndReturn(z),C=z=>({x:w(z.x,h),y:w(z.y,v)});return C({x:new Ce(0),y:new Ce(0)}),C}return mo},Do=l=>({set:h=>{Hi=Do(h)},reset:()=>Do(l),compare:ds(l),snap:Ji(l),orient:Bs(l)}),Hi=Do(),gs=(l,h)=>l.ll.x.isLessThanOrEqualTo(h.x)&&h.x.isLessThanOrEqualTo(l.ur.x)&&l.ll.y.isLessThanOrEqualTo(h.y)&&h.y.isLessThanOrEqualTo(l.ur.y),wc=(l,h)=>{if(h.ur.x.isLessThan(l.ll.x)||l.ur.x.isLessThan(h.ll.x)||h.ur.y.isLessThan(l.ll.y)||l.ur.y.isLessThan(h.ll.y))return null;let v=l.ll.x.isLessThan(h.ll.x)?h.ll.x:l.ll.x,w=l.ur.x.isLessThan(h.ur.x)?l.ur.x:h.ur.x,C=l.ll.y.isLessThan(h.ll.y)?h.ll.y:l.ll.y,z=l.ur.y.isLessThan(h.ur.y)?l.ur.y:h.ur.y;return{ll:{x:v,y:C},ur:{x:w,y:z}}},ca=(l,h)=>l.x.times(h.y).minus(l.y.times(h.x)),Ys=(l,h)=>l.x.times(h.x).plus(l.y.times(h.y)),Rs=l=>Ys(l,l).sqrt(),kf=(l,h,v)=>{let w={x:h.x.minus(l.x),y:h.y.minus(l.y)},C={x:v.x.minus(l.x),y:v.y.minus(l.y)};return ca(C,w).div(Rs(C)).div(Rs(w))},tu=(l,h,v)=>{let w={x:h.x.minus(l.x),y:h.y.minus(l.y)},C={x:v.x.minus(l.x),y:v.y.minus(l.y)};return Ys(C,w).div(Rs(C)).div(Rs(w))},mi=(l,h,v)=>h.y.isZero()?null:{x:l.x.plus(h.x.div(h.y).times(v.minus(l.y))),y:v},Wo=(l,h,v)=>h.x.isZero()?null:{x:v,y:l.y.plus(h.y.div(h.x).times(v.minus(l.x)))},Ne=(l,h,v,w)=>{if(h.x.isZero())return Wo(v,w,l.x);if(w.x.isZero())return Wo(l,h,v.x);if(h.y.isZero())return mi(v,w,l.y);if(w.y.isZero())return mi(l,h,v.y);let C=ca(h,w);if(C.isZero())return null;let z={x:v.x.minus(l.x),y:v.y.minus(l.y)},X=ca(z,h).div(C),re=ca(z,w).div(C),he=l.x.plus(re.times(h.x)),Se=v.x.plus(X.times(w.x)),Je=l.y.plus(re.times(h.y)),ze=v.y.plus(X.times(w.y)),vt=he.plus(Se).div(2),kt=Je.plus(ze).div(2);return{x:vt,y:kt}},ms=class px{constructor(h,v){Gt(this,"point");Gt(this,"isLeft");Gt(this,"segment");Gt(this,"otherSE");Gt(this,"consumedBy");h.events===void 0?h.events=[this]:h.events.push(this),this.point=h,this.isLeft=v}static compare(h,v){let w=px.comparePoints(h.point,v.point);return w!==0?w:(h.point!==v.point&&h.link(v),h.isLeft!==v.isLeft?h.isLeft?1:-1:Io.compare(h.segment,v.segment))}static comparePoints(h,v){return h.x.isLessThan(v.x)?-1:h.x.isGreaterThan(v.x)?1:h.y.isLessThan(v.y)?-1:h.y.isGreaterThan(v.y)?1:0}link(h){if(h.point===this.point)throw new Error("Tried to link already linked events");let v=h.point.events;for(let w=0,C=v.length;w<C;w++){let z=v[w];this.point.events.push(z),z.point=this.point}this.checkForConsuming()}checkForConsuming(){let h=this.point.events.length;for(let v=0;v<h;v++){let w=this.point.events[v];if(w.segment.consumedBy===void 0)for(let C=v+1;C<h;C++){let z=this.point.events[C];z.consumedBy===void 0&&w.otherSE.point.events===z.otherSE.point.events&&w.segment.consume(z.segment)}}}getAvailableLinkedEvents(){let h=[];for(let v=0,w=this.point.events.length;v<w;v++){let C=this.point.events[v];C!==this&&!C.segment.ringOut&&C.segment.isInResult()&&h.push(C)}return h}getLeftmostComparator(h){let v=new Map,w=C=>{let z=C.otherSE;v.set(C,{sine:kf(this.point,h.point,z.point),cosine:tu(this.point,h.point,z.point)})};return(C,z)=>{v.has(C)||w(C),v.has(z)||w(z);let{sine:X,cosine:re}=v.get(C),{sine:he,cosine:Se}=v.get(z);return X.isGreaterThanOrEqualTo(0)&&he.isGreaterThanOrEqualTo(0)?re.isLessThan(Se)?1:re.isGreaterThan(Se)?-1:0:X.isLessThan(0)&&he.isLessThan(0)?re.isLessThan(Se)?-1:re.isGreaterThan(Se)?1:0:he.isLessThan(X)?-1:he.isGreaterThan(X)?1:0}}},Lu=0,Io=class zg{constructor(h,v,w,C){Gt(this,"id");Gt(this,"leftSE");Gt(this,"rightSE");Gt(this,"rings");Gt(this,"windings");Gt(this,"ringOut");Gt(this,"consumedBy");Gt(this,"prev");Gt(this,"_prevInResult");Gt(this,"_beforeState");Gt(this,"_afterState");Gt(this,"_isInResult");this.id=++Lu,this.leftSE=h,h.segment=this,h.otherSE=v,this.rightSE=v,v.segment=this,v.otherSE=h,this.rings=w,this.windings=C}static compare(h,v){let w=h.leftSE.point.x,C=v.leftSE.point.x,z=h.rightSE.point.x,X=v.rightSE.point.x;if(X.isLessThan(w))return 1;if(z.isLessThan(C))return-1;let re=h.leftSE.point.y,he=v.leftSE.point.y,Se=h.rightSE.point.y,Je=v.rightSE.point.y;if(w.isLessThan(C)){if(he.isLessThan(re)&&he.isLessThan(Se))return 1;if(he.isGreaterThan(re)&&he.isGreaterThan(Se))return-1;let ze=h.comparePoint(v.leftSE.point);if(ze<0)return 1;if(ze>0)return-1;let vt=v.comparePoint(h.rightSE.point);return vt!==0?vt:-1}if(w.isGreaterThan(C)){if(re.isLessThan(he)&&re.isLessThan(Je))return-1;if(re.isGreaterThan(he)&&re.isGreaterThan(Je))return 1;let ze=v.comparePoint(h.leftSE.point);if(ze!==0)return ze;let vt=h.comparePoint(v.rightSE.point);return vt<0?1:vt>0?-1:1}if(re.isLessThan(he))return-1;if(re.isGreaterThan(he))return 1;if(z.isLessThan(X)){let ze=v.comparePoint(h.rightSE.point);if(ze!==0)return ze}if(z.isGreaterThan(X)){let ze=h.comparePoint(v.rightSE.point);if(ze<0)return 1;if(ze>0)return-1}if(!z.eq(X)){let ze=Se.minus(re),vt=z.minus(w),kt=Je.minus(he),Xt=X.minus(C);if(ze.isGreaterThan(vt)&&kt.isLessThan(Xt))return 1;if(ze.isLessThan(vt)&&kt.isGreaterThan(Xt))return-1}return z.isGreaterThan(X)?1:z.isLessThan(X)||Se.isLessThan(Je)?-1:Se.isGreaterThan(Je)?1:h.id<v.id?-1:h.id>v.id?1:0}static fromRing(h,v,w){let C,z,X,re=ms.comparePoints(h,v);if(re<0)C=h,z=v,X=1;else if(re>0)C=v,z=h,X=-1;else throw new Error(`Tried to create degenerate segment at [${h.x}, ${h.y}]`);let he=new ms(C,!0),Se=new ms(z,!1);return new zg(he,Se,[w],[X])}replaceRightSE(h){this.rightSE=h,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){let h=this.leftSE.point.y,v=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:h.isLessThan(v)?h:v},ur:{x:this.rightSE.point.x,y:h.isGreaterThan(v)?h:v}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(h){return h.x.eq(this.leftSE.point.x)&&h.y.eq(this.leftSE.point.y)||h.x.eq(this.rightSE.point.x)&&h.y.eq(this.rightSE.point.y)}comparePoint(h){return Hi.orient(this.leftSE.point,h,this.rightSE.point)}getIntersection(h){let v=this.bbox(),w=h.bbox(),C=wc(v,w);if(C===null)return null;let z=this.leftSE.point,X=this.rightSE.point,re=h.leftSE.point,he=h.rightSE.point,Se=gs(v,re)&&this.comparePoint(re)===0,Je=gs(w,z)&&h.comparePoint(z)===0,ze=gs(v,he)&&this.comparePoint(he)===0,vt=gs(w,X)&&h.comparePoint(X)===0;if(Je&&Se)return vt&&!ze?X:!vt&&ze?he:null;if(Je)return ze&&z.x.eq(he.x)&&z.y.eq(he.y)?null:z;if(Se)return vt&&X.x.eq(re.x)&&X.y.eq(re.y)?null:re;if(vt&&ze)return null;if(vt)return X;if(ze)return he;let kt=Ne(z,this.vector(),re,h.vector());return kt===null||!gs(C,kt)?null:Hi.snap(kt)}split(h){let v=[],w=h.events!==void 0,C=new ms(h,!0),z=new ms(h,!1),X=this.rightSE;this.replaceRightSE(z),v.push(z),v.push(C);let re=new zg(C,X,this.rings.slice(),this.windings.slice());return ms.comparePoints(re.leftSE.point,re.rightSE.point)>0&&re.swapEvents(),ms.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),w&&(C.checkForConsuming(),z.checkForConsuming()),v}swapEvents(){let h=this.rightSE;this.rightSE=this.leftSE,this.leftSE=h,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let v=0,w=this.windings.length;v<w;v++)this.windings[v]*=-1}consume(h){let v=this,w=h;for(;v.consumedBy;)v=v.consumedBy;for(;w.consumedBy;)w=w.consumedBy;let C=zg.compare(v,w);if(C!==0){if(C>0){let z=v;v=w,w=z}if(v.prev===w){let z=v;v=w,w=z}for(let z=0,X=w.rings.length;z<X;z++){let re=w.rings[z],he=w.windings[z],Se=v.rings.indexOf(re);Se===-1?(v.rings.push(re),v.windings.push(he)):v.windings[Se]+=he}w.rings=null,w.windings=null,w.consumedBy=v,w.leftSE.consumedBy=v.leftSE,w.rightSE.consumedBy=v.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{let h=this.prev.consumedBy||this.prev;this._beforeState=h.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;let h=this.beforeState();this._afterState={rings:h.rings.slice(0),windings:h.windings.slice(0),multiPolys:[]};let v=this._afterState.rings,w=this._afterState.windings,C=this._afterState.multiPolys;for(let re=0,he=this.rings.length;re<he;re++){let Se=this.rings[re],Je=this.windings[re],ze=v.indexOf(Se);ze===-1?(v.push(Se),w.push(Je)):w[ze]+=Je}let z=[],X=[];for(let re=0,he=v.length;re<he;re++){if(w[re]===0)continue;let Se=v[re],Je=Se.poly;if(X.indexOf(Je)===-1)if(Se.isExterior)z.push(Je);else{X.indexOf(Je)===-1&&X.push(Je);let ze=z.indexOf(Se.poly);ze!==-1&&z.splice(ze,1)}}for(let re=0,he=z.length;re<he;re++){let Se=z[re].multiPoly;C.indexOf(Se)===-1&&C.push(Se)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;let h=this.beforeState().multiPolys,v=this.afterState().multiPolys;switch(Kc.type){case"union":{let w=h.length===0,C=v.length===0;this._isInResult=w!==C;break}case"intersection":{let w,C;h.length<v.length?(w=h.length,C=v.length):(w=v.length,C=h.length),this._isInResult=C===Kc.numMultiPolys&&w<C;break}case"xor":{let w=Math.abs(h.length-v.length);this._isInResult=w%2===1;break}case"difference":{let w=C=>C.length===1&&C[0].isSubject;this._isInResult=w(h)!==w(v);break}}return this._isInResult}},Gr=class{constructor(l,h,v){Gt(this,"poly");Gt(this,"isExterior");Gt(this,"segments");Gt(this,"bbox");if(!Array.isArray(l)||l.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=h,this.isExterior=v,this.segments=[],typeof l[0][0]!="number"||typeof l[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let w=Hi.snap({x:new Ce(l[0][0]),y:new Ce(l[0][1])});this.bbox={ll:{x:w.x,y:w.y},ur:{x:w.x,y:w.y}};let C=w;for(let z=1,X=l.length;z<X;z++){if(typeof l[z][0]!="number"||typeof l[z][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let re=Hi.snap({x:new Ce(l[z][0]),y:new Ce(l[z][1])});re.x.eq(C.x)&&re.y.eq(C.y)||(this.segments.push(Io.fromRing(C,re,this)),re.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=re.x),re.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=re.y),re.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=re.x),re.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=re.y),C=re)}(!w.x.eq(C.x)||!w.y.eq(C.y))&&this.segments.push(Io.fromRing(C,w,this))}getSweepEvents(){let l=[];for(let h=0,v=this.segments.length;h<v;h++){let w=this.segments[h];l.push(w.leftSE),l.push(w.rightSE)}return l}},Wc=class{constructor(l,h){Gt(this,"multiPoly");Gt(this,"exteriorRing");Gt(this,"interiorRings");Gt(this,"bbox");if(!Array.isArray(l))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Gr(l[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let v=1,w=l.length;v<w;v++){let C=new Gr(l[v],this,!1);C.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=C.bbox.ll.x),C.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=C.bbox.ll.y),C.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=C.bbox.ur.x),C.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=C.bbox.ur.y),this.interiorRings.push(C)}this.multiPoly=h}getSweepEvents(){let l=this.exteriorRing.getSweepEvents();for(let h=0,v=this.interiorRings.length;h<v;h++){let w=this.interiorRings[h].getSweepEvents();for(let C=0,z=w.length;C<z;C++)l.push(w[C])}return l}},uh=class{constructor(l,h){Gt(this,"isSubject");Gt(this,"polys");Gt(this,"bbox");if(!Array.isArray(l))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof l[0][0][0]=="number"&&(l=[l])}catch{}this.polys=[],this.bbox={ll:{x:new Ce(Number.POSITIVE_INFINITY),y:new Ce(Number.POSITIVE_INFINITY)},ur:{x:new Ce(Number.NEGATIVE_INFINITY),y:new Ce(Number.NEGATIVE_INFINITY)}};for(let v=0,w=l.length;v<w;v++){let C=new Wc(l[v],this);C.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=C.bbox.ll.x),C.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=C.bbox.ll.y),C.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=C.bbox.ur.x),C.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=C.bbox.ur.y),this.polys.push(C)}this.isSubject=h}getSweepEvents(){let l=[];for(let h=0,v=this.polys.length;h<v;h++){let w=this.polys[h].getSweepEvents();for(let C=0,z=w.length;C<z;C++)l.push(w[C])}return l}},Zc=class g1{constructor(h){Gt(this,"events");Gt(this,"poly");Gt(this,"_isExteriorRing");Gt(this,"_enclosingRing");this.events=h;for(let v=0,w=h.length;v<w;v++)h[v].segment.ringOut=this;this.poly=null}static factory(h){let v=[];for(let w=0,C=h.length;w<C;w++){let z=h[w];if(!z.isInResult()||z.ringOut)continue;let X=null,re=z.leftSE,he=z.rightSE,Se=[re],Je=re.point,ze=[];for(;X=re,re=he,Se.push(re),re.point!==Je;)for(;;){let vt=re.getAvailableLinkedEvents();if(vt.length===0){let yn=Se[0].point,bn=Se[Se.length-1].point;throw new Error(`Unable to complete output ring starting at [${yn.x}, ${yn.y}]. Last matching segment found ends at [${bn.x}, ${bn.y}].`)}if(vt.length===1){he=vt[0].otherSE;break}let kt=null;for(let yn=0,bn=ze.length;yn<bn;yn++)if(ze[yn].point===re.point){kt=yn;break}if(kt!==null){let yn=ze.splice(kt)[0],bn=Se.splice(yn.index);bn.unshift(bn[0].otherSE),v.push(new g1(bn.reverse()));continue}ze.push({index:Se.length,point:re.point});let Xt=re.getLeftmostComparator(X);he=vt.sort(Xt)[0].otherSE;break}v.push(new g1(Se))}return v}getGeom(){let h=this.events[0].point,v=[h];for(let Se=1,Je=this.events.length-1;Se<Je;Se++){let ze=this.events[Se].point,vt=this.events[Se+1].point;Hi.orient(ze,h,vt)!==0&&(v.push(ze),h=ze)}if(v.length===1)return null;let w=v[0],C=v[1];Hi.orient(w,h,C)===0&&v.shift(),v.push(v[0]);let z=this.isExteriorRing()?1:-1,X=this.isExteriorRing()?0:v.length-1,re=this.isExteriorRing()?v.length:-1,he=[];for(let Se=X;Se!=re;Se+=z)he.push([v[Se].x.toNumber(),v[Se].y.toNumber()]);return he}isExteriorRing(){if(this._isExteriorRing===void 0){let h=this.enclosingRing();this._isExteriorRing=h?!h.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var C,z;let h=this.events[0];for(let X=1,re=this.events.length;X<re;X++){let he=this.events[X];ms.compare(h,he)>0&&(h=he)}let v=h.segment.prevInResult(),w=v?v.prevInResult():null;for(;;){if(!v)return null;if(!w)return v.ringOut;if(w.ringOut!==v.ringOut)return((C=w.ringOut)==null?void 0:C.enclosingRing())!==v.ringOut?v.ringOut:(z=v.ringOut)==null?void 0:z.enclosingRing();v=w.prevInResult(),w=v?v.prevInResult():null}}},qa=class{constructor(l){Gt(this,"exteriorRing");Gt(this,"interiorRings");this.exteriorRing=l,l.poly=this,this.interiorRings=[]}addInterior(l){this.interiorRings.push(l),l.poly=this}getGeom(){let l=this.exteriorRing.getGeom();if(l===null)return null;let h=[l];for(let v=0,w=this.interiorRings.length;v<w;v++){let C=this.interiorRings[v].getGeom();C!==null&&h.push(C)}return h}},xc=class{constructor(l){Gt(this,"rings");Gt(this,"polys");this.rings=l,this.polys=this._composePolys(l)}getGeom(){let l=[];for(let h=0,v=this.polys.length;h<v;h++){let w=this.polys[h].getGeom();w!==null&&l.push(w)}return l}_composePolys(l){var v;let h=[];for(let w=0,C=l.length;w<C;w++){let z=l[w];if(!z.poly)if(z.isExteriorRing())h.push(new qa(z));else{let X=z.enclosingRing();X!=null&&X.poly||h.push(new qa(X)),(v=X==null?void 0:X.poly)==null||v.addInterior(z)}}return h}},Tf=class{constructor(l,h=Io.compare){Gt(this,"queue");Gt(this,"tree");Gt(this,"segments");this.queue=l,this.tree=new an(h),this.segments=[]}process(l){let h=l.segment,v=[];if(l.consumedBy)return l.isLeft?this.queue.delete(l.otherSE):this.tree.delete(h),v;l.isLeft&&this.tree.add(h);let w=h,C=h;do w=this.tree.lastBefore(w);while(w!=null&&w.consumedBy!=null);do C=this.tree.firstAfter(C);while(C!=null&&C.consumedBy!=null);if(l.isLeft){let z=null;if(w){let re=w.getIntersection(h);if(re!==null&&(h.isAnEndpoint(re)||(z=re),!w.isAnEndpoint(re))){let he=this._splitSafely(w,re);for(let Se=0,Je=he.length;Se<Je;Se++)v.push(he[Se])}}let X=null;if(C){let re=C.getIntersection(h);if(re!==null&&(h.isAnEndpoint(re)||(X=re),!C.isAnEndpoint(re))){let he=this._splitSafely(C,re);for(let Se=0,Je=he.length;Se<Je;Se++)v.push(he[Se])}}if(z!==null||X!==null){let re=null;z===null?re=X:X===null?re=z:re=ms.comparePoints(z,X)<=0?z:X,this.queue.delete(h.rightSE),v.push(h.rightSE);let he=h.split(re);for(let Se=0,Je=he.length;Se<Je;Se++)v.push(he[Se])}v.length>0?(this.tree.delete(h),v.push(l)):(this.segments.push(h),h.prev=w)}else{if(w&&C){let z=w.getIntersection(C);if(z!==null){if(!w.isAnEndpoint(z)){let X=this._splitSafely(w,z);for(let re=0,he=X.length;re<he;re++)v.push(X[re])}if(!C.isAnEndpoint(z)){let X=this._splitSafely(C,z);for(let re=0,he=X.length;re<he;re++)v.push(X[re])}}}this.tree.delete(h)}return v}_splitSafely(l,h){this.tree.delete(l);let v=l.rightSE;this.queue.delete(v);let w=l.split(h);return w.push(v),l.consumedBy===void 0&&this.tree.add(l),w}},gd=class{constructor(){Gt(this,"type");Gt(this,"numMultiPolys")}run(l,h,v){Xu.type=l;let w=[new uh(h,!0)];for(let he=0,Se=v.length;he<Se;he++)w.push(new uh(v[he],!1));if(Xu.numMultiPolys=w.length,Xu.type==="difference"){let he=w[0],Se=1;for(;Se<w.length;)wc(w[Se].bbox,he.bbox)!==null?Se++:w.splice(Se,1)}if(Xu.type==="intersection")for(let he=0,Se=w.length;he<Se;he++){let Je=w[he];for(let ze=he+1,vt=w.length;ze<vt;ze++)if(wc(Je.bbox,w[ze].bbox)===null)return[]}let C=new an(ms.compare);for(let he=0,Se=w.length;he<Se;he++){let Je=w[he].getSweepEvents();for(let ze=0,vt=Je.length;ze<vt;ze++)C.add(Je[ze])}let z=new Tf(C),X=null;for(C.size!=0&&(X=C.first(),C.delete(X));X;){let he=z.process(X);for(let Se=0,Je=he.length;Se<Je;Se++){let ze=he[Se];ze.consumedBy===void 0&&C.add(ze)}C.size!=0?(X=C.first(),C.delete(X)):X=null}Hi.reset();let re=Zc.factory(z.segments);return new xc(re).getGeom()}},Xu=new gd,Kc=Xu,Bl=(l,...h)=>Kc.run("intersection",l,h),md=(l,...h)=>Kc.run("difference",l,h);Hi.set;function Yc(l){let h={type:"Feature"};return h.geometry=l,h}function Jc(l){return l.type==="Feature"?l.geometry:l}function ch(l){return l&&l.geometry&&l.geometry.coordinates?l.geometry.coordinates:l}function fh(l){return Yc({type:"LineString",coordinates:l})}function Pa(l){return Yc({type:"MultiLineString",coordinates:l})}function hh(l){return Yc({type:"Polygon",coordinates:l})}function dh(l){return Yc({type:"MultiPolygon",coordinates:l})}function ph(l,h){let v=Jc(l),w=Jc(h),C=Bl(v.coordinates,w.coordinates);return C.length===0?null:C.length===1?hh(C[0]):dh(C)}function b(l,h){let v=Jc(l),w=Jc(h),C=md(v.coordinates,w.coordinates);return C.length===0?null:C.length===1?hh(C[0]):dh(C)}function P(l){return Array.isArray(l)?1+P(l[0]):-1}function q(l){l instanceof L.Polyline&&(l=l.toGeoJSON(15));let h=ch(l),v=P(h),w=[];return v>1?h.forEach(C=>{w.push(fh(C))}):w.push(l),w}function oe(l){let h=[];return l.eachLayer(v=>{h.push(ch(v.toGeoJSON(15)))}),Pa(h)}io.Cut=io.Polygon.extend({initialize(l){this._map=l,this._shape="Cut",this.toolbarButtonName="cutPolygon"},_finishShape(){if(this._editedLayers=[],!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let l=this._layer.getLatLngs();if(l.length<=2)return;let h=L.polygon(l,this.options.pathOptions);h._latlngInfos=this._layer._latlngInfo,this.cut(h),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex,this._editedLayers.forEach(({layer:w,originalLayer:C})=>{this._fireCut(C,w,C),this._fireCut(this._map,w,C),C.pm._fireEdit()}),this._editedLayers=[];let v=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(v))},cut(l){let h=this._map._layers,v=l._latlngInfos||[];Object.keys(h).map(w=>h[w]).filter(w=>w.pm).filter(w=>!w._pmTempLayer).filter(w=>!L.PM.optIn&&!w.options.pmIgnore||L.PM.optIn&&w.options.pmIgnore===!1).filter(w=>w instanceof L.Polyline).filter(w=>w!==l).filter(w=>w.pm.options.allowCutting).filter(w=>this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0?this.options.layersToCut.indexOf(w)>-1:!0).filter(w=>!this._layerGroup.hasLayer(w)).filter(w=>{try{let C=!!hs(l.toGeoJSON(15),w.toGeoJSON(15)).features.length>0;return C||w instanceof L.Polyline&&!(w instanceof L.Polygon)?C:!!ph(l.toGeoJSON(15),w.toGeoJSON(15))}catch{return w instanceof L.Polygon&&console.error("You can't cut polygons with self-intersections"),!1}}).forEach(w=>{let C;if(w instanceof L.Polygon){C=L.polygon(w.getLatLngs());let he=C.getLatLngs();v.forEach(Se=>{if(Se&&Se.snapInfo){let{latlng:Je}=Se,ze=this._calcClosestLayer(Je,[C]);if(ze&&ze.segment&&ze.distance<this.options.snapDistance){let{segment:vt}=ze;if(vt&&vt.length===2){let{indexPath:kt,parentPath:Xt,newIndex:yn}=L.PM.Utils._getIndexFromSegment(he,vt);(kt.length>1?(0,Ri.default)(he,Xt):he).splice(yn,0,Je)}}}})}else C=w;let z=this._cutLayer(l,C),X=L.geoJSON(z,w.options);X.getLayers().length===1&&([X]=X.getLayers()),this._setPane(X,"layerPane");let re=X.addTo(this._map.pm._getContainingLayer());if(re.pm.enable(w.pm.options),re.pm.disable(),w._pmTempLayer=!0,l._pmTempLayer=!0,w.remove(),w.removeFrom(this._map.pm._getContainingLayer()),l.remove(),l.removeFrom(this._map.pm._getContainingLayer()),re.getLayers&&re.getLayers().length===0&&this._map.pm.removeLayer({target:re}),re instanceof L.LayerGroup?(re.eachLayer(he=>{this._addDrawnLayerProp(he)}),this._addDrawnLayerProp(re)):this._addDrawnLayerProp(re),this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0){let he=this.options.layersToCut.indexOf(w);he>-1&&this.options.layersToCut.splice(he,1)}this._editedLayers.push({layer:re,originalLayer:w})})},_cutLayer(l,h){let v=L.geoJSON(),w;if(h instanceof L.Polygon)w=b(h.toGeoJSON(15),l.toGeoJSON(15));else{let C=q(h);C.forEach(z=>{let X=Kn(z,l.toGeoJSON(15)),re;X&&X.features.length>0?re=L.geoJSON(X):re=L.geoJSON(z),re.getLayers().forEach(he=>{oa(l.toGeoJSON(15),he.toGeoJSON(15))||he.addTo(v)})}),C.length>1?w=oe(v):w=v.toGeoJSON(15)}return w},_change:L.Util.falseFn}),io.Text=io.extend({initialize(l){this._map=l,this._shape="Text",this.toolbarButtonName="drawText"},enable(l){L.Util.setOptions(this,l),this._enabled=!0,this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(or("tooltips.placeText"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this._map.getContainer().classList.add("geoman-draw-cursor"),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){var l;this._enabled&&(this._enabled=!1,this._map.off("click",this._createMarker,this),(l=this._hintMarker)==null||l.remove(),this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("mousemove",this._syncHintMarker,this),this._map.off("mousemove",this._showHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(l){this.enabled()?this.disable():this.enable(l)},_syncHintMarker(l){if(this._hintMarker.setLatLng(l.latlng),this.options.snappable){let h=l;h.target=this._hintMarker,this._handleSnapping(h)}},_createMarker(l){var C,z,X,re;if(!l.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(l.latlng);let h=this._hintMarker.getLatLng();if(this.textArea=this._createTextArea(),(C=this.options.textOptions)==null?void 0:C.className){let he=this.options.textOptions.className.split(" ");this.textArea.classList.add(...he)}let v=this._createTextIcon(this.textArea),w=new L.Marker(h,{textMarker:!0,_textMarkerOverPM:!0,icon:v});if(this._setPane(w,"markerPane"),this._finishLayer(w),w.pm||(w.options.draggable=!1),w.addTo(this._map.pm._getContainingLayer()),w.pm){w.pm.textArea=this.textArea,L.setOptions(w.pm,{removeIfEmpty:((z=this.options.textOptions)==null?void 0:z.removeIfEmpty)??!0});let he=((X=this.options.textOptions)==null?void 0:X.focusAfterDraw)??!0;w.pm._createTextMarker(he),(re=this.options.textOptions)!=null&&re.text&&w.pm.setText(this.options.textOptions.text)}this._fireCreate(w),this._cleanupSnapping(),this.disable(),this.options.continueDrawing&&this._map.once("mousemove",this._showHintMarkerAfterMoving,this)},_showHintMarkerAfterMoving(l){this.enable(),this._hintMarker.setLatLng(l.latlng)},_createTextArea(){let l=document.createElement("textarea");return l.readOnly=!0,l.classList.add("pm-textarea","pm-disabled"),l},_createTextIcon(l){return L.divIcon({className:"pm-text-marker",html:l})}});var we={enableLayerDrag(){if(!this.options.draggable||!this._layer._map)return;this.disable(),this._layerDragEnabled=!0,this._map||(this._map=this._layer._map),(this._layer instanceof L.Marker||this._layer instanceof L.ImageOverlay)&&L.DomEvent.on(this._getDOMElem(),"dragstart",this._stopDOMImageDrag),this._layer.dragging&&this._layer.dragging.disable(),this._tempDragCoord=null,bi(this._layer)instanceof L.Canvas?(this._layer.on("mouseout",this.removeDraggingClass,this),this._layer.on("mouseover",this.addDraggingClass,this)):this.addDraggingClass(),this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!0;let l=this._getDOMElem();l&&(bi(this._layer)instanceof L.Canvas?(this._layer.on("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._addTouchEvents(l)):L.DomEvent.on(l,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._fireDragEnable()},disableLayerDrag(){this._layerDragEnabled=!1,bi(this._layer)instanceof L.Canvas?(this._layer.off("mouseout",this.removeDraggingClass,this),this._layer.off("mouseover",this.addDraggingClass,this)):this.removeDraggingClass(),this._originalMapDragState&&this._dragging&&this._map.dragging.enable(),this._safeToCacheDragState=!1,this._layer.dragging&&this._layer.dragging.disable();let l=this._getDOMElem();l&&(bi(this._layer)instanceof L.Canvas?(this._layer.off("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._removeTouchEvents(l)):L.DomEvent.off(l,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._layerDragged&&this._fireUpdate(),this._layerDragged=!1,this._fireDragDisable()},dragging(){return this._dragging},layerDragEnabled(){return!!this._layerDragEnabled},_simulateMouseDownEvent(l){let h=l.touches?l.touches[0]:l,v={originalEvent:h,target:this._layer};return v.containerPoint=this._map.mouseEventToContainerPoint(h),v.latlng=this._map.containerPointToLatLng(v.containerPoint),this._dragMixinOnMouseDown(v),!1},_simulateMouseMoveEvent(l){let h=l.touches?l.touches[0]:l,v={originalEvent:h,target:this._layer};return v.containerPoint=this._map.mouseEventToContainerPoint(h),v.latlng=this._map.containerPointToLatLng(v.containerPoint),this._dragMixinOnMouseMove(v),!1},_simulateMouseUpEvent(l){let h={originalEvent:l.touches?l.touches[0]:l,target:this._layer};return l.type.indexOf("touch")===-1&&(h.containerPoint=this._map.mouseEventToContainerPoint(l),h.latlng=this._map.containerPointToLatLng(h.containerPoint)),this._dragMixinOnMouseUp(h),!1},_dragMixinOnMouseDown(l){if(l.originalEvent.button>0)return;this._overwriteEventIfItComesFromMarker(l);let h=l._fromLayerSync,v=this._syncLayers("_dragMixinOnMouseDown",l);if(this._layer instanceof L.Marker&&(this.options.snappable&&!h&&!v?this._initSnappableMarkers():this._disableSnapping()),this._layer instanceof L.CircleMarker){let w="resizeableCircleMarker";this._layer instanceof L.Circle&&(w="resizeableCircle"),this.options.snappable&&!h&&!v?this._layer.pm.options[w]||this._initSnappableMarkersDrag():this._layer.pm.options[w]?this._layer.pm._disableSnapping():this._layer.pm._disableSnappingDrag()}this._safeToCacheDragState&&(this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!1),this._tempDragCoord=l.latlng,L.DomEvent.on(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),L.DomEvent.on(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this)},_dragMixinOnMouseMove(l){this._overwriteEventIfItComesFromMarker(l);let h=this._getDOMElem();this._syncLayers("_dragMixinOnMouseMove",l),this._dragging||(this._dragging=!0,L.DomUtil.addClass(h,"leaflet-pm-dragging"),this._layer instanceof L.Marker||this._layer.bringToFront(),this._originalMapDragState&&this._map.dragging.disable(),this._fireDragStart()),this._tempDragCoord||(this._tempDragCoord=l.latlng),this._onLayerDrag(l),this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle()},_dragMixinOnMouseUp(l){let h=this._getDOMElem();return this._syncLayers("_dragMixinOnMouseUp",l),this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0,L.DomEvent.off(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this),L.DomEvent.off(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),this._dragging?(this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle(),this._layerDragged=!0,window.setTimeout(()=>{this._dragging=!1,h&&L.DomUtil.removeClass(h,"leaflet-pm-dragging"),this._fireDragEnd(),this._fireEdit(),this._layerEdited=!0},10),!0):!1},_onLayerDrag(l){let{latlng:h}=l,v={lat:h.lat-this._tempDragCoord.lat,lng:h.lng-this._tempDragCoord.lng},w=C=>C.map(z=>{if(Array.isArray(z))return w(z);let X={lat:z.lat+v.lat,lng:z.lng+v.lng};return(z.alt||z.alt===0)&&(X.alt=z.alt),X});if(this._layer instanceof L.Circle&&this._layer.options.resizeableCircle||this._layer instanceof L.CircleMarker&&this._layer.options.resizeableCircleMarker){let C=w([this._layer.getLatLng()]);this._layer.setLatLng(C[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.CircleMarker||this._layer instanceof L.Marker){let C=this._layer.getLatLng();this._layer._snapped&&(C=this._layer._orgLatLng);let z=w([C]);this._layer.setLatLng(z[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.ImageOverlay){let C=w([this._layer.getBounds().getNorthWest(),this._layer.getBounds().getSouthEast()]);this._layer.setBounds(C),this._fireChange(this._layer.getBounds(),"Edit")}else{let C=w(this._layer.getLatLngs());this._layer.setLatLngs(C),this._fireChange(this._layer.getLatLngs(),"Edit")}this._tempDragCoord=h,l.layer=this._layer,this._fireDrag(l)},addDraggingClass(){let l=this._getDOMElem();l&&L.DomUtil.addClass(l,"leaflet-pm-draggable")},removeDraggingClass(){let l=this._getDOMElem();l&&L.DomUtil.removeClass(l,"leaflet-pm-draggable")},_getDOMElem(){let l=null;return this._layer._path?l=this._layer._path:this._layer._renderer&&this._layer._renderer._container?l=this._layer._renderer._container:this._layer._image?l=this._layer._image:this._layer._icon&&(l=this._layer._icon),l},_overwriteEventIfItComesFromMarker(l){l.target.getLatLng&&(!l.target._radius||l.target._radius<=10)&&(l.containerPoint=this._map.mouseEventToContainerPoint(l.originalEvent),l.latlng=this._map.containerPointToLatLng(l.containerPoint))},_syncLayers(l,h){if(this.enabled())return!1;if(!h._fromLayerSync&&this._layer===h.target&&this.options.syncLayersOnDrag){h._fromLayerSync=!0;let v=[];if(L.Util.isArray(this.options.syncLayersOnDrag))v=this.options.syncLayersOnDrag,this.options.syncLayersOnDrag.forEach(w=>{w instanceof L.LayerGroup&&(v=v.concat(w.pm.getLayers(!0)))});else if(this.options.syncLayersOnDrag===!0&&this._parentLayerGroup)for(let w in this._parentLayerGroup){let C=this._parentLayerGroup[w];C.pm&&(v=C.pm.getLayers(!0))}return L.Util.isArray(v)&&v.length>0&&(v=v.filter(w=>!!w.pm).filter(w=>!!w.pm.options.draggable),v.forEach(w=>{w!==this._layer&&w.pm[l]&&(w._snapped=!1,w.pm[l](h))})),v.length>0}return!1},_stopDOMImageDrag(l){return l.preventDefault(),!1}},Ee=we,Ae=f(ci());function Te(l,h,v,w){return v.unproject(h.transform(v.project(l,w)),w)}function Ie(l,h,v){let w=v.getMaxZoom();if(w===1/0&&(w=v.getZoom()),L.Util.isArray(l)){let C=[];return l.forEach(z=>{C.push(Ie(z,h,v))}),C}return l instanceof L.LatLng?Te(l,h,v,w):null}function Ve(l,h){h instanceof L.Layer&&(h=h.getLatLng());let v=l.getMaxZoom();return v===1/0&&(v=l.getZoom()),l.project(h,v)}function dt(l,h){let v=l.getMaxZoom();return v===1/0&&(v=l.getZoom()),l.unproject(h,v)}var Nt={_onRotateStart(l){this._preventRenderingMarkers(!0),this._rotationOriginLatLng=this._getRotationCenter().clone(),this._rotationOriginPoint=Ve(this._map,this._rotationOriginLatLng),this._rotationStartPoint=Ve(this._map,l.target.getLatLng()),this._initialRotateLatLng=Os(this._layer),this._startAngle=this.getAngle();let h=Os(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._fireRotationStart(this._rotationLayer,h),this._fireRotationStart(this._map,h)},_onRotate(l){let h=Ve(this._map,l.target.getLatLng()),v=this._rotationStartPoint,w=this._rotationOriginPoint,C=Math.atan2(h.y-w.y,h.x-w.x)-Math.atan2(v.y-w.y,v.x-w.x);this._layer.setLatLngs(this._rotateLayer(C,this._initialRotateLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let z=this;function X(Je,ze=[],vt=-1){if(vt>-1&&ze.push(vt),L.Util.isArray(Je[0]))Je.forEach((kt,Xt)=>X(kt,ze.slice(),Xt));else{let kt=ze.length>0?(0,Ae.default)(z._markers,ze):z._markers[0];Je.forEach((Xt,yn)=>{kt[yn].setLatLng(Xt)})}}X(this._layer.getLatLngs());let re=Os(this._rotationLayer);this._rotationLayer.setLatLngs(this._rotateLayer(C,this._rotationLayer.pm._rotateOrgLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let he=C*180/Math.PI;he=he<0?he+360:he;let Se=he+this._startAngle;this._setAngle(Se),this._rotationLayer.pm._setAngle(Se),this._fireRotation(this._rotationLayer,he,re),this._fireRotation(this._map,he,re),this._rotationLayer.pm._fireChange(this._rotationLayer.getLatLngs(),"Rotation")},_onRotateEnd(){let l=this._startAngle;delete this._rotationOriginLatLng,delete this._rotationOriginPoint,delete this._rotationStartPoint,delete this._initialRotateLatLng,delete this._startAngle;let h=Os(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._rotationLayer.pm._rotateOrgLatLng=Os(this._rotationLayer),this._fireRotationEnd(this._rotationLayer,l,h),this._fireRotationEnd(this._map,l,h),this._rotationLayer.pm._fireEdit(this._rotationLayer,"Rotation"),this._preventRenderingMarkers(!1),this._layerRotated=!0},_rotateLayer(l,h,v,w,C){let z=Ve(C,v);return this._matrix=w.clone().rotate(l,z).flip(),Ie(h,this._matrix,C)},_setAngle(l){l=l<0?l+360:l,this._angle=l%360},_getRotationCenter(){if(this._rotationCenter)return this._rotationCenter;let l=L.polygon(this._layer.getLatLngs(),{stroke:!1,fill:!1,pmIgnore:!0}).addTo(this._layer._map),h=l.getCenter();return l.removeFrom(this._layer._map),h},enableRotate(){if(!this.options.allowRotation){this.disableRotate();return}this.rotateEnabled()&&this.disableRotate(),this._layer instanceof L.Rectangle&&this._angle===void 0&&this.setInitAngle(ta(this._layer._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);let l={fill:!1,stroke:!1,pmIgnore:!1,snapIgnore:!0};this._rotatePoly=L.polygon(this._layer.getLatLngs(),l),this._rotatePoly._pmTempLayer=!0,this._rotatePoly.addTo(this._layer._map),this._rotatePoly.pm._setAngle(this.getAngle()),this._rotatePoly.pm.setRotationCenter(this.getRotationCenter()),this._rotatePoly.pm.setOptions(this._layer._map.pm.getGlobalOptions()),this._rotatePoly.pm.setOptions({rotate:!0,snappable:!1,hideMiddleMarkers:!0}),this._rotatePoly.pm._rotationLayer=this._layer,this._rotatePoly.pm.enable(),this._rotateOrgLatLng=Os(this._layer),this._rotateEnabled=!0,this._layer.on("remove",this.disableRotate,this),this._fireRotationEnable(this._layer),this._fireRotationEnable(this._layer._map)},disableRotate(){this.rotateEnabled()&&(this._rotatePoly.pm._layerRotated&&this._fireUpdate(),this._rotatePoly.pm._layerRotated=!1,this._rotatePoly.pm.disable(),this._rotatePoly.remove(),this._rotatePoly.pm.setOptions({rotate:!1}),this._rotatePoly=void 0,this._rotateOrgLatLng=void 0,this._layer.off("remove",this.disableRotate,this),this._rotateEnabled=!1,this._fireRotationDisable(this._layer),this._fireRotationDisable(this._layer._map))},rotateEnabled(){return!!this._rotateEnabled},rotateLayer(l){let h=this.getAngle(),v=this._layer.getLatLngs(),w=l*(Math.PI/180);this._layer.setLatLngs(this._rotateLayer(w,this._layer.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._layer._map)),this._rotateOrgLatLng=L.polygon(this._layer.getLatLngs()).getLatLngs(),this._setAngle(this.getAngle()+l),this.rotateEnabled()&&this._rotatePoly&&this._rotatePoly.pm.enabled()&&(this._rotatePoly.setLatLngs(this._rotateLayer(w,this._rotatePoly.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._rotatePoly._map)),this._rotatePoly.pm._initMarkers());let C=this.getAngle()-h;C=C<0?C+360:C,this._startAngle=h,this._fireRotation(this._layer,C,v,this._layer),this._fireRotation(this._map||this._layer._map,C,v,this._layer),delete this._startAngle,this._fireChange(this._layer.getLatLngs(),"Rotation")},rotateLayerToAngle(l){let h=l-this.getAngle();this.rotateLayer(h)},getAngle(){return this._angle||0},setInitAngle(l){this._setAngle(l)},getRotationCenter(){return this._getRotationCenter()},setRotationCenter(l){this._rotationCenter=l,this._rotatePoly&&this._rotatePoly.pm.setRotationCenter(l)}},Dt=Nt,wt=L.Class.extend({includes:[Ee,Es,Dt,kl],options:{snappable:!0,snapDistance:20,allowSelfIntersection:!0,allowSelfIntersectionEdit:!1,preventMarkerRemoval:!1,removeLayerBelowMinVertexCount:!0,limitMarkersToCount:-1,hideMiddleMarkers:!1,snapSegment:!0,syncLayersOnDrag:!1,draggable:!0,allowEditing:!0,allowRemoval:!0,allowCutting:!0,allowRotation:!0,addVertexOn:"click",removeVertexOn:"contextmenu",removeVertexValidation:void 0,addVertexValidation:void 0,moveVertexValidation:void 0,resizeableCircleMarker:!1,resizeableCircle:!0,snapMiddle:!1,snapVertex:!0},setOptions(l){L.Util.setOptions(this,l)},getOptions(){return this.options},applyOptions(){},isPolygon(){return this._layer instanceof L.Polygon},getShape(){return this._shape},_setPane(l,h){h==="layerPane"?l.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":h==="vertexPane"?l.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":h==="markerPane"&&(l.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},remove(){(this._map||this._layer._map).pm.removeLayer({target:this._layer})},_vertexValidation(l,h){let v=h.target,w={layer:this._layer,marker:v,event:h},C="";return l==="move"?C="moveVertexValidation":l==="add"?C="addVertexValidation":l==="remove"&&(C="removeVertexValidation"),this.options[C]&&typeof this.options[C]=="function"&&!this.options[C](w)?(l==="move"&&(v._cancelDragEventChain=v.getLatLng()),!1):(v._cancelDragEventChain=null,!0)},_vertexValidationDrag(l){return l._cancelDragEventChain?(l._latlng=l._cancelDragEventChain,l.update(),!1):!0},_vertexValidationDragEnd(l){return l._cancelDragEventChain?(l._cancelDragEventChain=null,!1):!0}}),Yt=wt;Yt.LayerGroup=L.Class.extend({initialize(l){this._layerGroup=l,this._layers=this.getLayers(),this._getMap(),this._layers.forEach(w=>this._initLayer(w));let h=w=>{if(w.layer._pmTempLayer)return;this._layers=this.getLayers();let C=this._layers.filter(z=>!z.pm._parentLayerGroup||!(this._layerGroup._leaflet_id in z.pm._parentLayerGroup));C.forEach(z=>{this._initLayer(z)}),C.length>0&&this._getMap()&&this._getMap().pm.globalEditModeEnabled()&&this.enabled()&&this.enable(this.getOptions())};this._layerGroup.on("layeradd",L.Util.throttle(h,100,this),this),this._layerGroup.on("layerremove",w=>{this._removeLayerFromGroup(w.target)},this);let v=w=>{w.target._pmTempLayer||(this._layers=this.getLayers())};this._layerGroup.on("layerremove",L.Util.throttle(v,100,this),this)},enable(l,h=[]){h.length===0&&(this._layers=this.getLayers()),this._options=l,this._layers.forEach(v=>{v instanceof L.LayerGroup?h.indexOf(v._leaflet_id)===-1&&(h.push(v._leaflet_id),v.pm.enable(l,h)):v.pm.enable(l)})},disable(l=[]){l.length===0&&(this._layers=this.getLayers()),this._layers.forEach(h=>{h instanceof L.LayerGroup?l.indexOf(h._leaflet_id)===-1&&(l.push(h._leaflet_id),h.pm.disable(l)):h.pm.disable()})},enabled(l=[]){return l.length===0&&(this._layers=this.getLayers()),!!this._layers.find(h=>h instanceof L.LayerGroup?l.indexOf(h._leaflet_id)===-1?(l.push(h._leaflet_id),h.pm.enabled(l)):!1:h.pm.enabled())},toggleEdit(l,h=[]){h.length===0&&(this._layers=this.getLayers()),this._options=l,this._layers.forEach(v=>{v instanceof L.LayerGroup?h.indexOf(v._leaflet_id)===-1&&(h.push(v._leaflet_id),v.pm.toggleEdit(l,h)):v.pm.toggleEdit(l)})},_initLayer(l){let h=L.Util.stamp(this._layerGroup);l.pm._parentLayerGroup||(l.pm._parentLayerGroup={}),l.pm._parentLayerGroup[h]=this._layerGroup},_removeLayerFromGroup(l){if(l.pm&&l.pm._layerGroup){let h=L.Util.stamp(this._layerGroup);delete l.pm._layerGroup[h]}},dragging(){return this._layers=this.getLayers(),this._layers?!!this._layers.find(l=>l.pm.dragging()):!1},getOptions(){return this.options},_getMap(){var l;return this._map||((l=this._layers.find(h=>!!h._map))==null?void 0:l._map)||null},getLayers(l=!1,h=!0,v=!0,w=[]){let C=[];return l?this._layerGroup.getLayers().forEach(z=>{C.push(z),z instanceof L.LayerGroup&&w.indexOf(z._leaflet_id)===-1&&(w.push(z._leaflet_id),C=C.concat(z.pm.getLayers(!0,!0,!0,w)))}):C=this._layerGroup.getLayers(),v&&(C=C.filter(z=>!(z instanceof L.LayerGroup))),h&&(C=C.filter(z=>!!z.pm),C=C.filter(z=>!z._pmTempLayer),C=C.filter(z=>!L.PM.optIn&&!z.options.pmIgnore||L.PM.optIn&&z.options.pmIgnore===!1)),C},setOptions(l,h=[]){h.length===0&&(this._layers=this.getLayers()),this.options=l,this._layers.forEach(v=>{v.pm&&(v instanceof L.LayerGroup?h.indexOf(v._leaflet_id)===-1&&(h.push(v._leaflet_id),v.pm.setOptions(l,h)):v.pm.setOptions(l))})}}),Yt.Marker=Yt.extend({_shape:"Marker",initialize(l){this._layer=l,this._enabled=!1,this._layer.on("dragend",this._onDragEnd,this)},enable(l={draggable:!0}){if(L.Util.setOptions(this,l),!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._fireEnable()},disable(){this.enabled()&&(this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this._layer.off("contextmenu",this._removeMarker,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1)},enabled(){return this._enabled},toggleEdit(l){this.enabled()?this.disable():this.enable(l)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this.options.draggable?this.enableLayerDrag():this.disableLayerDrag(),this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_removeMarker(l){let h=l.target;h.remove(),this._fireRemove(h),this._fireRemove(this._map,h)},_onDragEnd(){this._fireEdit(),this._layerEdited=!0},_initSnappableMarkers(){let l=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,l.off("pm:drag",this._handleSnapping,this),l.on("pm:drag",this._handleSnapping,this),l.off("pm:dragend",this._cleanupSnapping,this),l.on("pm:dragend",this._cleanupSnapping,this),l.off("pm:dragstart",this._unsnap,this),l.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let l=this._layer;l.off("pm:drag",this._handleSnapping,this),l.off("pm:dragend",this._cleanupSnapping,this),l.off("pm:dragstart",this._unsnap,this)}});var Vt=f(ci()),pt={filterMarkerGroup(){this.markerCache=[],this.createCache(),this._layer.on("pm:edit",this.createCache,this),this.applyLimitFilters({}),this.throttledApplyLimitFilters||(this.throttledApplyLimitFilters=L.Util.throttle(this.applyLimitFilters,100,this)),this._layer.on("pm:disable",this._removeMarkerLimitEvents,this),this._layer.on("remove",this._removeMarkerLimitEvents,this),this.options.limitMarkersToCount>-1&&(this._layer.on("pm:vertexremoved",this._initMarkers,this),this._map.on("mousemove",this.throttledApplyLimitFilters,this))},_removeMarkerLimitEvents(){this._map.off("mousemove",this.throttledApplyLimitFilters,this),this._layer.off("pm:edit",this.createCache,this),this._layer.off("pm:disable",this._removeMarkerLimitEvents,this),this._layer.off("pm:vertexremoved",this._initMarkers,this)},createCache(){let l=[...this._markerGroup.getLayers(),...this.markerCache];this.markerCache=l.filter((h,v,w)=>w.indexOf(h)===v)},_removeFromCache(l){let h=this.markerCache.indexOf(l);h>-1&&this.markerCache.splice(h,1)},renderLimits(l){this.markerCache.forEach(h=>{l.includes(h)?this._markerGroup.addLayer(h):this._markerGroup.removeLayer(h)})},applyLimitFilters({latlng:l={lat:0,lng:0}}){if(this._preventRenderMarkers)return;let h=[...this._filterClosestMarkers(l)];this.renderLimits(h)},_filterClosestMarkers(l){let h=[...this.markerCache],v=this.options.limitMarkersToCount;return v===-1?h:(h.sort((w,C)=>{let z=w._latlng.distanceTo(l),X=C._latlng.distanceTo(l);return z-X}),h.filter((w,C)=>v>-1?C<v:!0))},_preventRenderMarkers:!1,_preventRenderingMarkers(l){this._preventRenderMarkers=!!l}},yt=pt;Yt.Line=Yt.extend({includes:[yt],_shape:"Line",initialize(l){this._layer=l,this._enabled=!1},enable(l){if(L.Util.setOptions(this,l),this._map=this._layer._map,!!this._map){if(!this.options.allowEditing){this.disable();return}this.enabled()&&this.disable(),this._enabled=!0,this._initMarkers(),this.applyOptions(),this._layer.on("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.on("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this),this.options.allowSelfIntersection?this.cachedColor=void 0:(this._layer.options.color!=="#f00000ff"?(this.cachedColor=this._layer.options.color,this.isRed=!1):this.isRed=!0,this._handleLayerStyle()),this._fireEnable()}},disable(){if(!this.enabled()||this._dragging)return;this._enabled=!1,this._markerGroup.clearLayers(),this._markerGroup.removeFrom(this._map),this._layer.off("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.off("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this);let l=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(l,"leaflet-pm-draggable"),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()},enabled(){return this._enabled},toggleEdit(l){return this.enabled()?this.disable():this.enable(l),this.enabled()},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initMarkers(){let l=this._map,h=this._layer.getLatLngs();this._markerGroup&&(this._markerGroup.removeFrom(l),this._markerGroup.clearLayers()),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0;let v=w=>{if(Array.isArray(w[0]))return w.map(v,this);let C=w.map(this._createMarker,this);return this.options.hideMiddleMarkers!==!0&&w.map((z,X)=>{let re=this.isPolygon()?(X+1)%w.length:X+1;return this._createMiddleMarker(C[X],C[re])}),C};this._markers=v(h),this.filterMarkerGroup(),l.addLayer(this._markerGroup)},_createMarker(l){let h=new L.Marker(l,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(h,"vertexPane"),h._pmTempLayer=!0,this.options.rotate?(h.on("dragstart",this._onRotateStart,this),h.on("drag",this._onRotate,this),h.on("dragend",this._onRotateEnd,this)):(h.on("click",this._onVertexClick,this),h.on("dragstart",this._onMarkerDragStart,this),h.on("move",this._onMarkerDrag,this),h.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||h.on(this.options.removeVertexOn,this._removeMarker,this)),this._markerGroup.addLayer(h),h},_createMiddleMarker(l,h){if(!l||!h)return!1;let v=L.PM.Utils.calcMiddleLatLng(this._map,l.getLatLng(),h.getLatLng()),w=this._createMarker(v),C=L.divIcon({className:"marker-icon marker-icon-middle"});return w.setIcon(C),w.leftM=l,w.rightM=h,l._middleMarkerNext=w,h._middleMarkerPrev=w,w.on(this.options.addVertexOn,this._onMiddleMarkerClick,this),w.on("movestart",this._onMiddleMarkerMoveStart,this),w},_onMiddleMarkerClick(l){let h=l.target;if(!this._vertexValidation("add",l))return;let v=L.divIcon({className:"marker-icon"});h.setIcon(v),this._addMarker(h,h.leftM,h.rightM)},_onMiddleMarkerMoveStart(l){let h=l.target;if(h.on("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidation("add",l)){h.on("move",this._onMiddleMarkerMovePrevent,this);return}h._dragging=!0,this._addMarker(h,h.leftM,h.rightM)},_onMiddleMarkerMovePrevent(l){let h=l.target;this._vertexValidationDrag(h)},_onMiddleMarkerMoveEnd(l){let h=l.target;if(h.off("move",this._onMiddleMarkerMovePrevent,this),h.off("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidationDragEnd(h))return;let v=L.divIcon({className:"marker-icon"});h.setIcon(v),setTimeout(()=>{delete h._dragging},100)},_addMarker(l,h,v){l.off("movestart",this._onMiddleMarkerMoveStart,this),l.off(this.options.addVertexOn,this._onMiddleMarkerClick,this);let w=l.getLatLng(),C=this._layer._latlngs;delete l.leftM,delete l.rightM;let{indexPath:z,index:X,parentPath:re}=L.PM.Utils.findDeepMarkerIndex(this._markers,h),he=z.length>1?(0,Vt.default)(C,re):C,Se=z.length>1?(0,Vt.default)(this._markers,re):this._markers;he.splice(X+1,0,w),Se.splice(X+1,0,l),this._layer.setLatLngs(C),this.options.hideMiddleMarkers!==!0&&(this._createMiddleMarker(h,l),this._createMiddleMarker(l,v)),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit"),this._fireVertexAdded(l,L.PM.Utils.findDeepMarkerIndex(this._markers,l).indexPath,w),this.options.snappable&&this._initSnappableMarkers()},hasSelfIntersection(){return Ur(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersectionOnVertexRemoval(){this._handleLayerStyle(!0)&&(this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers())},_handleLayerStyle(l){let h=this._layer,v,w;if(this.options.allowSelfIntersection?v=!1:(w=Ur(this._layer.toGeoJSON(15)),v=w.features.length>0),v){if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!0),this.isRed)return v;l?this._flashLayer():(h.setStyle({color:"#f00000ff"}),this.isRed=!0),this._fireIntersect(w)}else h.setStyle({color:this.cachedColor}),this.isRed=!1,!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!1);return v},_flashLayer(){this.cachedColor||(this.cachedColor=this._layer.options.color),this._layer.setStyle({color:"#f00000ff"}),this.isRed=!0,window.setTimeout(()=>{this._layer.setStyle({color:this.cachedColor}),this.isRed=!1},200)},_updateDisabledMarkerStyle(l,h){l.forEach(v=>{Array.isArray(v)?this._updateDisabledMarkerStyle(v,h):v._icon&&(h&&!this._checkMarkerAllowedToDrag(v)?L.DomUtil.addClass(v._icon,"vertexmarker-disabled"):L.DomUtil.removeClass(v._icon,"vertexmarker-disabled"))})},_removeMarker(l){let h=l.target;if(!this._vertexValidation("remove",l))return;this.options.allowSelfIntersection||(this._coordsBeforeEdit=Os(this._layer,this._layer.getLatLngs()));let v=this._layer.getLatLngs(),{indexPath:w,index:C,parentPath:z}=L.PM.Utils.findDeepMarkerIndex(this._markers,h);if(!w)return;let X=w.length>1?(0,Vt.default)(v,z):v,re=w.length>1?(0,Vt.default)(this._markers,z):this._markers,he=z[z.length-1]>0&&this._layer instanceof L.Polygon;if(!this.options.removeLayerBelowMinVertexCount&&!he&&(X.length<=2||this.isPolygon()&&X.length<=3)){this._flashLayer();return}X.splice(C,1),this._layer.setLatLngs(v),this.isPolygon()&&X.length<=2&&X.splice(0,X.length);let Se=!1;if(X.length<=1&&(X.splice(0,X.length),z.length>1&&w.length>1&&(v=ll(v)),this._layer.setLatLngs(v),this._initMarkers(),Se=!0),ro(v)||this._layer.remove(),v=ll(v),this._layer.setLatLngs(v),this._markers=ll(this._markers),!Se&&(re=w.length>1?(0,Vt.default)(this._markers,z):this._markers,h._middleMarkerPrev&&(this._markerGroup.removeLayer(h._middleMarkerPrev),this._removeFromCache(h._middleMarkerPrev)),h._middleMarkerNext&&(this._markerGroup.removeLayer(h._middleMarkerNext),this._removeFromCache(h._middleMarkerNext)),this._markerGroup.removeLayer(h),this._removeFromCache(h),re)){let Je,ze;if(this.isPolygon()?(Je=(C+1)%re.length,ze=(C+(re.length-1))%re.length):(ze=C-1<0?void 0:C-1,Je=C+1>=re.length?void 0:C+1),Je!==ze){let vt=re[ze],kt=re[Je];this.options.hideMiddleMarkers!==!0&&this._createMiddleMarker(vt,kt)}re.splice(C,1)}this._fireEdit(),this._layerEdited=!0,this._fireVertexRemoved(h,w),this._fireChange(this._layer.getLatLngs(),"Edit")},updatePolygonCoordsFromMarkerDrag(l){let h=this._layer.getLatLngs(),v=l.getLatLng(),{indexPath:w,index:C,parentPath:z}=L.PM.Utils.findDeepMarkerIndex(this._markers,l);(w.length>1?(0,Vt.default)(h,z):h).splice(C,1,v),this._layer.setLatLngs(h)},_getNeighborMarkers(l){let{indexPath:h,index:v,parentPath:w}=L.PM.Utils.findDeepMarkerIndex(this._markers,l),C=h.length>1?(0,Vt.default)(this._markers,w):this._markers,z=(v+1)%C.length,X=(v+(C.length-1))%C.length,re=C[X],he=C[z];return{prevMarker:re,nextMarker:he}},_checkMarkerAllowedToDrag(l){let{prevMarker:h,nextMarker:v}=this._getNeighborMarkers(l),w=L.polyline([h.getLatLng(),l.getLatLng()]),C=L.polyline([l.getLatLng(),v.getLatLng()]),z=hs(this._layer.toGeoJSON(15),w.toGeoJSON(15)).features.length,X=hs(this._layer.toGeoJSON(15),C.toGeoJSON(15)).features.length;return l.getLatLng()===this._markers[0][0].getLatLng()?X+=1:l.getLatLng()===this._markers[0][this._markers[0].length-1].getLatLng()&&(z+=1),!(z<=2&&X<=2)},_onMarkerDragStart(l){let h=l.target;if(this.cachedColor||(this.cachedColor=this._layer.options.color),!this._vertexValidation("move",l))return;let{indexPath:v}=L.PM.Utils.findDeepMarkerIndex(this._markers,h);this._fireMarkerDragStart(l,v),this.options.allowSelfIntersection||(this._coordsBeforeEdit=Os(this._layer,this._layer.getLatLngs())),!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()?this._markerAllowedToDrag=this._checkMarkerAllowedToDrag(h):this._markerAllowedToDrag=null},_onMarkerDrag(l){let h=l.target;if(!this._vertexValidationDrag(h))return;let{indexPath:v,index:w,parentPath:C}=L.PM.Utils.findDeepMarkerIndex(this._markers,h);if(!v)return;if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()&&this._markerAllowedToDrag===!1){this._layer.setLatLngs(this._coordsBeforeEdit),this._initMarkers(),this._handleLayerStyle();return}this.updatePolygonCoordsFromMarkerDrag(h);let z=v.length>1?(0,Vt.default)(this._markers,C):this._markers,X=(w+1)%z.length,re=(w+(z.length-1))%z.length,he=h.getLatLng(),Se=z[re].getLatLng(),Je=z[X].getLatLng();if(h._middleMarkerNext){let ze=L.PM.Utils.calcMiddleLatLng(this._map,he,Je);h._middleMarkerNext.setLatLng(ze)}if(h._middleMarkerPrev){let ze=L.PM.Utils.calcMiddleLatLng(this._map,he,Se);h._middleMarkerPrev.setLatLng(ze)}this.options.allowSelfIntersection||this._handleLayerStyle(),this._fireMarkerDrag(l,v),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(l){let h=l.target;if(!this._vertexValidationDragEnd(h))return;let{indexPath:v}=L.PM.Utils.findDeepMarkerIndex(this._markers,h),w=!this.options.allowSelfIntersection&&this.hasSelfIntersection();w&&this.options.allowSelfIntersectionEdit&&this._markerAllowedToDrag&&(w=!1);let C=!this.options.allowSelfIntersection&&w;if(this._fireMarkerDragEnd(l,v,C),C){this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers(),this.options.snappable&&this._initSnappableMarkers(),this._handleLayerStyle(),this._fireLayerReset(l,v);return}!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._handleLayerStyle(),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_onVertexClick(l){let h=l.target;if(h._dragging)return;let{indexPath:v}=L.PM.Utils.findDeepMarkerIndex(this._markers,h);this._fireVertexClick(l,v)}}),Yt.Polygon=Yt.Line.extend({_shape:"Polygon",_checkMarkerAllowedToDrag(l){let{prevMarker:h,nextMarker:v}=this._getNeighborMarkers(l),w=L.polyline([h.getLatLng(),l.getLatLng()]),C=L.polyline([l.getLatLng(),v.getLatLng()]),z=hs(this._layer.toGeoJSON(15),w.toGeoJSON(15)).features.length,X=hs(this._layer.toGeoJSON(15),C.toGeoJSON(15)).features.length;return!(z<=2&&X<=2)}}),Yt.Rectangle=Yt.Polygon.extend({_shape:"Rectangle",_initMarkers(){let l=this._map,h=this._findCorners();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0,l.addLayer(this._markerGroup),this._markers=[],this._markers[0]=h.map(this._createMarker,this),[this._cornerMarkers]=this._markers,this._layer.getLatLngs()[0].forEach((v,w)=>{let C=this._cornerMarkers.find(z=>z._index===w);C&&C.setLatLng(v)})},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this._addMarkerEvents()},_createMarker(l,h){let v=new L.Marker(l,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(v,"vertexPane"),v._origLatLng=l,v._index=h,v._pmTempLayer=!0,v.on("click",this._onVertexClick,this),this._markerGroup.addLayer(v),v},_addMarkerEvents(){this._markers[0].forEach(l=>{l.on("dragstart",this._onMarkerDragStart,this),l.on("drag",this._onMarkerDrag,this),l.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||l.on("contextmenu",this._removeMarker,this)})},_removeMarker(){return null},_onMarkerDragStart(l){if(!this._vertexValidation("move",l))return;let h=l.target,v=this._cornerMarkers;h._oppositeCornerLatLng=v.find(C=>C._index===(h._index+2)%4).getLatLng(),h._snapped=!1;let{indexPath:w}=L.PM.Utils.findDeepMarkerIndex(this._markers,h);this._fireMarkerDragStart(l,w)},_onMarkerDrag(l){let h=l.target;if(!this._vertexValidationDrag(h)||h._index===void 0)return;this._adjustRectangleForMarkerMove(h);let{indexPath:v}=L.PM.Utils.findDeepMarkerIndex(this._markers,h);this._fireMarkerDrag(l,v),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(l){let h=l.target;if(!this._vertexValidationDragEnd(h))return;this._cornerMarkers.forEach(w=>{delete w._oppositeCornerLatLng});let{indexPath:v}=L.PM.Utils.findDeepMarkerIndex(this._markers,h);this._fireMarkerDragEnd(l,v),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_adjustRectangleForMarkerMove(l){L.extend(l._origLatLng,l._latlng);let h=L.PM.Utils._getRotatedRectangle(l.getLatLng(),l._oppositeCornerLatLng,this.getAngle(),this._map);this._layer.setLatLngs(h),this._adjustAllMarkers(l),this._layer.redraw()},_adjustAllMarkers(l){let h=this._layer.getLatLngs()[0];if(h&&h.length!==4&&h.length>0)h.forEach((v,w)=>{this._cornerMarkers[w].setLatLng(v)}),this._cornerMarkers.slice(h.length).forEach(v=>{v.setLatLng(h[0])});else if(!h||!h.length)console.error("The layer has no LatLngs");else{let v=h.findIndex(w=>l.getLatLng().equals(w));v>-1?(this._cornerMarkers[(l._index+1)%4].setLatLng(h[(v+1)%4]),this._cornerMarkers[(l._index+2)%4].setLatLng(h[(v+2)%4]),this._cornerMarkers[(l._index+3)%4].setLatLng(h[(v+3)%4])):this._cornerMarkers.forEach(w=>{w.setLatLng(h[w._index])})}},_findCorners(){this._angle===void 0&&this.setInitAngle(ta(this._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);let l=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(l[0],l[2],this.getAngle(),this._map||this)}}),Yt.CircleMarker=Yt.extend({_shape:"CircleMarker",initialize(l){this._layer=l,this._enabled=!1,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._updateHiddenPolyCircle()},enable(l={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,l),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._extendingEnable(),this._updateHiddenPolyCircle(),this._fireEnable()},_extendingEnable(){this._layer.on("pm:dragstart",this._onDragStart,this),this._layer.on("pm:drag",this._onMarkerDrag,this),this._layer.on("pm:dragend",this._onMarkerDragEnd,this)},disable(){this.dragging()||(this._map||(this._map=this._layer._map),this._map&&this.enabled()&&(this.layerDragEnabled()&&this.disableLayerDrag(),this._helperLayers&&(this._helperLayers.clearLayers(),this._helperLayers.removeFrom(this._map)),this.options[this._editableOption]?(this._map.off("move",this._syncMarkers,this),this._outerMarker.off("drag",this._handleOuterMarkerSnapping,this)):this._map.off("move",this._updateHiddenPolyCircle,this),this._extendingDisable(),this._layer.off("remove",this.disable,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1))},_extendingDisable(){this._layer.off("contextmenu",this._removeMarker,this)},enabled(){return this._enabled},toggleEdit(l){this.enabled()?this.disable():this.enable(l)},applyOptions(){this.options[this._editableOption]?(this._initMarkers(),this._map.on("move",this._syncMarkers,this),this.options.snappable?(this._initSnappableMarkers(),this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this),this._outerMarker.on("move",this._syncHintLine,this),this._outerMarker.on("move",this._syncCircleRadius,this)):this._disableSnapping()):(this.options.draggable&&this.enableLayerDrag(),this._map.on("move",this._updateHiddenPolyCircle,this),this.options.snappable?this._initSnappableMarkersDrag():this._disableSnappingDrag()),this._extendingApplyOptions()},_extendingApplyOptions(){this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_initMarkers(){let l=this._map;this._helperLayers&&(this._helperLayers.removeFrom(l),this._helperLayers.clearLayers()),this._helperLayers=new L.FeatureGroup,this._helperLayers._pmTempLayer=!0,this._helperLayers.addTo(l);let h=this._layer.getLatLng(),v=this._layer._radius,w=this._getLatLngOnCircle(h,v);this._centerMarker=this._createCenterMarker(h),this._outerMarker=this._createOuterMarker(w),this._markers=[this._centerMarker,this._outerMarker],this._createHintLine(this._centerMarker,this._outerMarker)},_getLatLngOnCircle(l,h){let v=this._map.project(l),w=L.point(v.x+h,v.y);return this._map.unproject(w)},_createHintLine(l,h){let v=l.getLatLng(),w=h.getLatLng();this._hintline=L.polyline([v,w],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._helperLayers.addLayer(this._hintline)},_createCenterMarker(l){let h=this._createMarker(l);return this.options.draggable?(L.DomUtil.addClass(h._icon,"leaflet-pm-draggable"),h.on("move",this._moveCircle,this)):h.dragging.disable(),h},_createOuterMarker(l){let h=this._createMarker(l);return h.on("drag",this._resizeCircle,this),h},_createMarker(l){let h=new L.Marker(l,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(h,"vertexPane"),h._origLatLng=l,h._pmTempLayer=!0,h.on("dragstart",this._onMarkerDragStart,this),h.on("drag",this._onMarkerDrag,this),h.on("dragend",this._onMarkerDragEnd,this),h.on("click",this._onVertexClick,this),this._helperLayers.addLayer(h),h},_moveCircle(l){if(l.target._cancelDragEventChain)return;let h=this._centerMarker.getLatLng();this._layer.setLatLng(h);let v=this._layer._radius,w=this._getLatLngOnCircle(h,v);this._outerMarker._latlng=w,this._outerMarker.update(),this._syncHintLine(),this._updateHiddenPolyCircle(),this._fireCenterPlaced("Edit"),this._fireChange(this._layer.getLatLng(),"Edit")},_syncMarkers(){let l=this._layer.getLatLng(),h=this._layer._radius,v=this._getLatLngOnCircle(l,h);this._outerMarker.setLatLng(v),this._centerMarker.setLatLng(l),this._syncHintLine(),this._updateHiddenPolyCircle()},_resizeCircle(){this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker()),this._syncHintLine(),this._syncCircleRadius()},_syncCircleRadius(){let l=this._centerMarker.getLatLng(),h=this._outerMarker.getLatLng(),v=this._distanceCalculation(l,h);this.options[this._minRadiusOption]&&v<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&v>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(v),this._updateHiddenPolyCircle(),this._fireChange(this._layer.getLatLng(),"Edit")},_syncHintLine(){let l=this._centerMarker.getLatLng(),h=this._outerMarker.getLatLng();this._hintline.setLatLngs([l,h])},_removeMarker(){this.options[this._editableOption]&&this.disable(),this._layer.remove(),this._fireRemove(this._layer),this._fireRemove(this._map,this._layer)},_onDragStart(){this._map.pm.Draw.CircleMarker._layerIsDragging=!0},_onMarkerDragStart(l){this._vertexValidation("move",l)&&this._fireMarkerDragStart(l)},_onMarkerDrag(l){let h=l.target;h instanceof L.Marker&&!this._vertexValidationDrag(h)||this._fireMarkerDrag(l)},_onMarkerDragEnd(l){this._extedingMarkerDragEnd();let h=l.target;this._vertexValidationDragEnd(h)&&(this.options[this._editableOption]&&(this._fireEdit(),this._layerEdited=!0),this._fireMarkerDragEnd(l))},_extedingMarkerDragEnd(){this._map.pm.Draw.CircleMarker._layerIsDragging=!1},_initSnappableMarkersDrag(){let l=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,l.off("pm:drag",this._handleSnapping,this),l.on("pm:drag",this._handleSnapping,this),l.off("pm:dragend",this._cleanupSnapping,this),l.on("pm:dragend",this._cleanupSnapping,this),l.off("pm:dragstart",this._unsnap,this),l.on("pm:dragstart",this._unsnap,this)},_disableSnappingDrag(){let l=this._layer;l.off("pm:drag",this._handleSnapping,this),l.off("pm:dragend",this._cleanupSnapping,this),l.off("pm:dragstart",this._unsnap,this)},_updateHiddenPolyCircle(){let l=this._layer._map||this._map;if(l){let h=L.PM.Utils.pxRadiusToMeterRadius(this._layer.getRadius(),l,this._layer.getLatLng()),v=L.circle(this._layer.getLatLng(),this._layer.options);v.setRadius(h);let w=l&&l.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(v,200,!w).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(v,200,!w),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)}},_getNewDestinationOfOuterMarker(){let l=this._centerMarker.getLatLng(),h=this._outerMarker.getLatLng(),v=this._distanceCalculation(l,h);return this.options[this._minRadiusOption]&&v<this.options[this._minRadiusOption]?h=Tl(this._map,l,h,this._getMinDistanceInMeter(l)):this.options[this._maxRadiusOption]&&v>this.options[this._maxRadiusOption]&&(h=Tl(this._map,l,h,this._getMaxDistanceInMeter(l))),h},_handleOuterMarkerSnapping(){if(this._outerMarker._snapped){let l=this._centerMarker.getLatLng(),h=this._outerMarker.getLatLng(),v=this._distanceCalculation(l,h);this.options[this._minRadiusOption]&&v<this.options[this._minRadiusOption]?this._outerMarker.setLatLng(this._outerMarker._orgLatLng):this.options[this._maxRadiusOption]&&v>this.options[this._maxRadiusOption]&&this._outerMarker.setLatLng(this._outerMarker._orgLatLng)}this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker())},_distanceCalculation(l,h){return this._map.project(l).distanceTo(this._map.project(h))},_getMinDistanceInMeter(l){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,l)},_getMaxDistanceInMeter(l){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,l)},_onVertexClick(l){l.target._dragging||this._fireVertexClick(l,void 0)}}),Yt.Circle=Yt.CircleMarker.extend({_shape:"Circle",initialize(l){this._layer=l,this._enabled=!1,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizeableCircle",this._updateHiddenPolyCircle()},enable(l){L.PM.Edit.CircleMarker.prototype.enable.call(this,l||{})},_extendingEnable(){},_extendingDisable(){this._layer.off("remove",this.disable,this);let l=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(l,"leaflet-pm-draggable")},_extendingApplyOptions(){},_syncMarkers(){},_removeMarker(){},_onDragStart(){},_extedingMarkerDragEnd(){},_updateHiddenPolyCircle(){let l=this._map&&this._map.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(this._layer,200,!l).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(this._layer,200,!l),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)},_distanceCalculation(l,h){return this._map.distance(l,h)},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_onVertexClick(l){l.target._dragging||this._fireVertexClick(l,void 0)}}),Yt.ImageOverlay=Yt.extend({_shape:"ImageOverlay",initialize(l){this._layer=l,this._enabled=!1},toggleEdit(l){this.enabled()?this.disable():this.enable(l)},enabled(){return this._enabled},enable(l={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,l),this._map=this._layer._map,!!this._map){if(!this.options.allowEditing){this.disable();return}this.enabled()||this.disable(),this.enableLayerDrag(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._otherSnapLayers=this._findCorners(),this._fireEnable()}},disable(){this._dragging||(this._map||(this._map=this._layer._map),this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this.enabled()||(this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()),this._enabled=!1)},_findCorners(){let l=this._layer.getBounds(),h=l.getNorthWest(),v=l.getNorthEast(),w=l.getSouthEast(),C=l.getSouthWest();return[h,v,w,C]}}),Yt.Text=Yt.extend({_shape:"Text",initialize(l){this._layer=l,this._enabled=!1},enable(l){if(L.Util.setOptions(this,l),!!this.textArea){if(!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._safeToCacheDragState=!0,this._focusChange(),this.textArea.readOnly=!1,this.textArea.classList.remove("pm-disabled"),this._layer.on("remove",this.disable,this),L.DomEvent.on(this.textArea,"input",this._autoResize,this),L.DomEvent.on(this.textArea,"focus",this._focusChange,this),L.DomEvent.on(this.textArea,"blur",this._focusChange,this),this._layer.on("dblclick",L.DomEvent.stop),L.DomEvent.off(this.textArea,"mousedown",this._preventTextSelection),this._enabled=!0,this._fireEnable()}},disable(){if(!this.enabled())return;this._layer.off("remove",this.disable,this),L.DomEvent.off(this.textArea,"input",this._autoResize,this),L.DomEvent.off(this.textArea,"focus",this._focusChange,this),L.DomEvent.off(this.textArea,"blur",this._focusChange,this),L.DomEvent.off(document,"click",this._documentClick,this),this._focusChange(),this.textArea.readOnly=!0,this.textArea.classList.add("pm-disabled");let l=document.activeElement;this.textArea.focus(),this.textArea.selectionStart=0,this.textArea.selectionEnd=0,L.DomEvent.on(this.textArea,"mousedown",this._preventTextSelection),l.focus(),this._disableOnBlurActive=!1,this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1},enabled(){return this._enabled},toggleEdit(l){this.enabled()?this.disable():this.enable(l)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initSnappableMarkers(){let l=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,l.off("pm:drag",this._handleSnapping,this),l.on("pm:drag",this._handleSnapping,this),l.off("pm:dragend",this._cleanupSnapping,this),l.on("pm:dragend",this._cleanupSnapping,this),l.off("pm:dragstart",this._unsnap,this),l.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let l=this._layer;l.off("pm:drag",this._handleSnapping,this),l.off("pm:dragend",this._cleanupSnapping,this),l.off("pm:dragstart",this._unsnap,this)},_autoResize(){this.textArea.style.height="1px",this.textArea.style.width="1px";let l=this.textArea.scrollHeight>21?this.textArea.scrollHeight:21,h=this.textArea.scrollWidth>16?this.textArea.scrollWidth:16;this.textArea.style.height=`${l}px`,this.textArea.style.width=`${h}px`,this._layer.options.text=this.getText(),this._fireTextChange(this.getText())},_disableOnBlur(){this._disableOnBlurActive=!0,setTimeout(()=>{this.enabled()&&L.DomEvent.on(document,"click",this._documentClick,this)},100)},_documentClick(l){l.target!==this.textArea&&(this.disable(),!this.getText()&&this.options.removeIfEmpty&&this.remove())},_focusChange(l={}){let h=this._hasFocus;this._hasFocus=l.type==="focus",!h!=!this._hasFocus&&(this._hasFocus?(this._applyFocus(),this._focusText=this.getText(),this._fireTextFocus()):(this._removeFocus(),this._fireTextBlur(),this._focusText!==this.getText()&&(this._fireEdit(),this._layerEdited=!0)))},_applyFocus(){this.textArea.classList.add("pm-hasfocus"),this._map.dragging&&(this._safeToCacheDragState&&(this._originalMapDragState=this._map.dragging._enabled,this._safeToCacheDragState=!1),this._map.dragging.disable())},_removeFocus(){this._map.dragging&&(this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0),this.textArea.classList.remove("pm-hasfocus")},focus(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.focus()},blur(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.blur(),this._disableOnBlurActive&&this.disable()},hasFocus(){return this._hasFocus},getElement(){return this.textArea},setText(l){l&&(this.textArea.value=l),this._autoResize()},getText(){return this.textArea.value},_initTextMarker(){if(this.textArea=L.PM.Draw.Text.prototype._createTextArea.call(this),this.options.className){let h=this.options.className.split(" ");this.textArea.classList.add(...h)}let l=L.PM.Draw.Text.prototype._createTextIcon.call(this,this.textArea);this._layer.setIcon(l),this._layer.once("add",this._createTextMarker,this)},_createTextMarker(l=!1){this._layer.off("add",this._createTextMarker,this),this._layer.getElement().tabIndex=-1,this.textArea.wrap="off",this.textArea.style.overflow="hidden",this.textArea.style.height=L.DomUtil.getStyle(this.textArea,"font-size"),this.textArea.style.width="1px",this._layer.options.text&&this.setText(this._layer.options.text),this._autoResize(),l===!0&&(this.enable(),this.focus(),this._disableOnBlur())},_preventTextSelection(l){l.preventDefault()}});var en=function(l,h,v,w,C,z){this._matrix=[l,h,v,w,C,z]};en.init=()=>new L.PM.Matrix(1,0,0,1,0,0),en.prototype={transform(l){return this._transform(l.clone())},_transform(l){let h=this._matrix,{x:v,y:w}=l;return l.x=h[0]*v+h[1]*w+h[4],l.y=h[2]*v+h[3]*w+h[5],l},untransform(l){let h=this._matrix;return new L.Point((l.x/h[0]-h[4])/h[0],(l.y/h[2]-h[5])/h[2])},clone(){let l=this._matrix;return new L.PM.Matrix(l[0],l[1],l[2],l[3],l[4],l[5])},translate(l){if(l===void 0)return new L.Point(this._matrix[4],this._matrix[5]);let h,v;return typeof l=="number"?(h=l,v=l):(h=l.x,v=l.y),this._add(1,0,0,1,h,v)},scale(l,h){if(l===void 0)return new L.Point(this._matrix[0],this._matrix[3]);let v,w;return h=h||L.point(0,0),typeof l=="number"?(v=l,w=l):(v=l.x,w=l.y),this._add(v,0,0,w,h.x,h.y)._add(1,0,0,1,-h.x,-h.y)},rotate(l,h){let v=Math.cos(l),w=Math.sin(l);return h=h||new L.Point(0,0),this._add(v,w,-w,v,h.x,h.y)._add(1,0,0,1,-h.x,-h.y)},flip(){return this._matrix[1]*=-1,this._matrix[2]*=-1,this},_add(l,h,v,w,C,z){let X=[[],[],[]],re=this._matrix,he=[[re[0],re[2],re[4]],[re[1],re[3],re[5]],[0,0,1]],Se=[[l,v,C],[h,w,z],[0,0,1]],Je;l&&l instanceof L.PM.Matrix&&(re=l._matrix,Se=[[re[0],re[2],re[4]],[re[1],re[3],re[5]],[0,0,1]]);for(let ze=0;ze<3;ze+=1)for(let vt=0;vt<3;vt+=1){Je=0;for(let kt=0;kt<3;kt+=1)Je+=he[ze][kt]*Se[kt][vt];X[ze][vt]=Je}return this._matrix=[X[0][0],X[1][0],X[0][1],X[1][1],X[0][2],X[1][2]],this}};var fn=en,nn={calcMiddleLatLng(l,h,v){let w=l.project(h),C=l.project(v);return l.unproject(w._add(C)._divideBy(2))},findLayers(l){let h=[];return l.eachLayer(v=>{(v instanceof L.Polyline||v instanceof L.Marker||v instanceof L.Circle||v instanceof L.CircleMarker||v instanceof L.ImageOverlay)&&h.push(v)}),h=h.filter(v=>!!v.pm),h=h.filter(v=>!v._pmTempLayer),h=h.filter(v=>!L.PM.optIn&&!v.options.pmIgnore||L.PM.optIn&&v.options.pmIgnore===!1),h},circleToPolygon(l,h=60,v=!0){let w=l.getLatLng(),C=l.getRadius(),z=Ui(w,C,h,0,v),X=[];for(let re=0;re<z.length;re+=1){let he=[z[re].lat,z[re].lng];X.push(he)}return L.polygon(X,l.options)},disablePopup(l){l.getPopup()&&(l._tempPopupCopy=l.getPopup(),l.unbindPopup())},enablePopup(l){l._tempPopupCopy&&(l.bindPopup(l._tempPopupCopy),delete l._tempPopupCopy)},_fireEvent(l,h,v,w=!1){l.fire(h,v,w);let{groups:C}=this.getAllParentGroups(l);C.forEach(z=>{z.fire(h,v,w)})},getAllParentGroups(l){let h=[],v=[],w=C=>{for(let z in C._eventParents)if(h.indexOf(z)===-1){h.push(z);let X=C._eventParents[z];v.push(X),w(X)}};return!l._pmLastGroupFetch||!l._pmLastGroupFetch.time||new Date().getTime()-l._pmLastGroupFetch.time>1e3?(w(l),l._pmLastGroupFetch={time:new Date().getTime(),groups:v,groupIds:h},{groupIds:h,groups:v}):{groups:l._pmLastGroupFetch.groups,groupIds:l._pmLastGroupFetch.groupIds}},createGeodesicPolygon:Ui,getTranslation:or,findDeepCoordIndex(l,h,v=!0){let w,C=X=>(re,he)=>{let Se=X.concat(he);if(v){if(re.lat&&re.lat===h.lat&&re.lng===h.lng)return w=Se,!0}else if(re.lat&&L.latLng(re).equals(h))return w=Se,!0;return Array.isArray(re)&&re.some(C(Se))};l.some(C([]));let z={};return w&&(z={indexPath:w,index:w[w.length-1],parentPath:w.slice(0,w.length-1)}),z},findDeepMarkerIndex(l,h){let v,w=z=>(X,re)=>{let he=z.concat(re);return X._leaflet_id===h._leaflet_id?(v=he,!0):Array.isArray(X)&&X.some(w(he))};l.some(w([]));let C={};return v&&(C={indexPath:v,index:v[v.length-1],parentPath:v.slice(0,v.length-1)}),C},_getIndexFromSegment(l,h){if(h&&h.length===2){let v=this.findDeepCoordIndex(l,h[0]),w=this.findDeepCoordIndex(l,h[1]),C=Math.max(v.index,w.index);return(v.index===0||w.index===0)&&C!==1&&(C+=1),{indexA:v,indexB:w,newIndex:C,indexPath:v.indexPath,parentPath:v.parentPath}}return null},_getRotatedRectangle(l,h,v,w){let C=Ve(w,l),z=Ve(w,h),X=v*Math.PI/180,re=Math.cos(X),he=Math.sin(X),Se=(z.x-C.x)*re+(z.y-C.y)*he,Je=(z.y-C.y)*re-(z.x-C.x)*he,ze=Se*re+C.x,vt=Se*he+C.y,kt=-Je*he+C.x,Xt=Je*re+C.y,yn=dt(w,C),bn=dt(w,{x:ze,y:vt}),ur=dt(w,z),Ye=dt(w,{x:kt,y:Xt});return[yn,bn,ur,Ye]},pxRadiusToMeterRadius(l,h,v){let w=h.project(v),C=L.point(w.x+l,w.y);return h.distance(h.unproject(C),v)}},kn=nn;L.PM=L.PM||{version:Us.version,Map:Mo,Toolbar:ul,Draw:io,Edit:Yt,Utils:kn,Matrix:fn,activeLang:"en",optIn:!1,initialize(l){this.addInitHooks(l)},setOptIn(l){this.optIn=!!l},addInitHooks(){function l(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Map(this)):this.options.pmIgnore||(this.pm=new L.PM.Map(this)),this.pm&&this.pm.setGlobalOptions({})}L.Map.addInitHook(l);function h(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.LayerGroup(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.LayerGroup(this))}L.LayerGroup.addInitHook(h);function v(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this)):this.options.pmIgnore||(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this))}L.Marker.addInitHook(v);function w(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.CircleMarker(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.CircleMarker(this))}L.CircleMarker.addInitHook(w);function C(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Line(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Line(this))}L.Polyline.addInitHook(C);function z(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Polygon(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Polygon(this))}L.Polygon.addInitHook(z);function X(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Rectangle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Rectangle(this))}L.Rectangle.addInitHook(X);function re(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Circle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Circle(this))}L.Circle.addInitHook(re);function he(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.ImageOverlay(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.ImageOverlay(this))}L.ImageOverlay.addInitHook(he)},reInitLayer(l){l instanceof L.LayerGroup&&l.eachLayer(h=>{this.reInitLayer(h)}),l.pm||L.PM.optIn&&l.options.pmIgnore!==!1||l.options.pmIgnore||(l instanceof L.Map?l.pm=new L.PM.Map(l):l instanceof L.Marker?l.options.textMarker?(l.pm=new L.PM.Edit.Text(l),l.pm._initTextMarker(),l.pm._createTextMarker(!1)):l.pm=new L.PM.Edit.Marker(l):l instanceof L.Circle?l.pm=new L.PM.Edit.Circle(l):l instanceof L.CircleMarker?l.pm=new L.PM.Edit.CircleMarker(l):l instanceof L.Rectangle?l.pm=new L.PM.Edit.Rectangle(l):l instanceof L.Polygon?l.pm=new L.PM.Edit.Polygon(l):l instanceof L.Polyline?l.pm=new L.PM.Edit.Line(l):l instanceof L.LayerGroup?l.pm=new L.PM.Edit.LayerGroup(l):l instanceof L.ImageOverlay&&(l.pm=new L.PM.Edit.ImageOverlay(l)))}},L.version==="1.7.1"&&L.Canvas.include({_onClick(l){let h=this._map.mouseEventToLayerPoint(l),v,w;for(let C=this._drawFirst;C;C=C.next)v=C.layer,v.options.interactive&&v._containsPoint(h)&&(!(l.type==="click"||l.type==="preclick")||!this._map._draggableMoved(v))&&(w=v);w&&(L.DomEvent.fakeStop(l),this._fireEvent([w],l))}}),L.PM.initialize()})();class Rh extends Vn.Circle{constructor(n,r){const i=r.radius||10;super(n,i,r);Gt(this,"properties");Gt(this,"angleCache",new Map);Gt(this,"lastCenter");Gt(this,"lastCenterCosLat");Gt(this,"_pendingNameUpdate",!1);Gt(this,"_nameUpdateTimeout",null);hn.measure("Circle.constructor.init",()=>{this.properties={type:"Circle",style:{name:r.name||""}},requestAnimationFrame(()=>{this.updateProperties()}),this.on("add",()=>{requestAnimationFrame(()=>{this.updateProperties()})})},"Circle")}updateProperties(){hn.measure("Circle.updateProperties",()=>{var u,f,d,g;const n=this.getRadius(),r=this.getLatLng(),i=((f=(u=this.properties)==null?void 0:u.style)==null?void 0:f.name)||"",s=((d=this.properties)==null?void 0:d.style)||{},o={type:"Circle",radius:n,diameter:n*2,surface:Math.PI*Math.pow(n,2),perimeter:2*Math.PI*n,center:{lat:r.lat,lng:r.lng},style:{...s,color:this.options.color||"#2b6451",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#2b6451",fillOpacity:this.options.fillOpacity||.2,dashArray:((g=this.options)==null?void 0:g.dashArray)||"",name:i}};JSON.stringify(this.properties)!==JSON.stringify(o)&&(this.properties=o,this.fire("properties:updated",{shape:this,properties:this.properties}))},"Circle")}setName(n){hn.measure("Circle.setName",()=>{var r,i;((i=(r=this.properties)==null?void 0:r.style)==null?void 0:i.name)!==n&&(this.properties.style||(this.properties.style={}),this.properties.style.name=n,!this._pendingNameUpdate&&(this._pendingNameUpdate=!0,this._nameUpdateTimeout&&clearTimeout(this._nameUpdateTimeout),this._nameUpdateTimeout=setTimeout(()=>{this._pendingNameUpdate=!1,this._nameUpdateTimeout=null,this.fire("properties:updated",{shape:this,properties:this.properties})},100)))},"Circle")}getName(){return hn.measure("Circle.getName",()=>{var n,r;return((r=(n=this.properties)==null?void 0:n.style)==null?void 0:r.name)||""},"Circle")}setRadius(n){return hn.measure("Circle.setRadius",()=>(super.setRadius(n),this.updateProperties(),this),"Circle")}setLatLng(n){return hn.measure("Circle.setLatLng",()=>(super.setLatLng(n),this.updateProperties(),this),"Circle")}calculatePointOnCircle(n){return hn.measure("Circle.calculatePointOnCircle",()=>{const r=this.getLatLng(),i=this.getRadius();let s=this.angleCache.get(n);if(!s){const o=n*Math.PI/180;s={sin:Math.sin(o),cos:Math.cos(o)},this.angleCache.set(n,s)}return(!this.lastCenter||!this.lastCenter.equals(r))&&(this.lastCenter=r,this.lastCenterCosLat=Math.cos(r.lat*Math.PI/180)),Vn.latLng(r.lat+i/111319.9*s.sin,r.lng+i/(111319.9*this.lastCenterCosLat)*s.cos)},"Circle")}getCardinalPoints(){return hn.measure("Circle.getCardinalPoints",()=>[0,45,90,135,180,225,270,315].map(n=>this.calculatePointOnCircle(n)),"Circle")}calculateAngleFromPoint(n){return hn.measure("Circle.calculateAngleFromPoint",()=>{const r=this.getLatLng(),i=n.lng-r.lng,s=n.lat-r.lat;let o=Math.atan2(s,i)*180/Math.PI;return o<0&&(o+=360),o},"Circle")}resizeFromControlPoint(n){hn.measure("Circle.resizeFromControlPoint",()=>{const i=this.getLatLng().distanceTo(n);i>0&&super.setRadius(i)},"Circle")}clearCache(){this.angleCache.clear(),this.lastCenter=void 0,this.lastCenterCosLat=void 0}}const bm=(e,t)=>{if(!e||typeof e!="string"||!e.startsWith("#"))return`rgba(0, 0, 0, ${t})`;const n=parseInt(e.slice(1,3),16),r=parseInt(e.slice(3,5),16),i=parseInt(e.slice(5,7),16);return`rgba(${n}, ${r}, ${i}, ${t})`},bb=(e,t)=>{e.style.fontSize=t.fontSize,e.style.color=t.color,e.style.backgroundColor=bm(t.backgroundColor,t.backgroundOpacity),t.hasBorder?e.style.border=`${t.borderWidth} solid ${bm(t.borderColor,t.borderOpacity)}`:e.style.border="none",e.style.padding=t.padding,e.style.borderRadius=t.borderRadius},yl=e=>{document.querySelectorAll(".drawing-help-message").forEach(r=>r.remove());const n=Rt.DomUtil.create("div","drawing-help-message");return n.innerHTML=e,n.style.cssText=`
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 8px 16px;
    border-radius: 4px;
    font-size: 14px;
    z-index: 2000;
    pointer-events: none;
    text-align: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  `,document.body.appendChild(n),n};function wb(e,t,n){const r=156543.03392*Math.cos(t*Math.PI/180)/Math.pow(2,n);return e/r}const qi=(e,t="m",n="")=>{let r,i;return t==="m²"?e>=1e4?(r=(e/1e4).toFixed(2),i="ha"):(r=e.toFixed(2),i="m²"):t==="m"?e>=1e3?(r=(e/1e3).toFixed(2),i="km"):(r=e.toFixed(2),i="m"):(r=e.toFixed(2),i=t),n?`${n}: ${r} ${i}`:`${r} ${i}`},FR=e=>({...e,clientX:e.clientX,clientY:e.clientY,button:e.button||0,buttons:e.buttons||0,altKey:e.altKey||!1}),jR=(e,t)=>{let n;return function(...r){window.clearTimeout(n),n=window.setTimeout(()=>e.apply(this,r),t)}},Mh=(e,t)=>{let n=0;return function(...r){const i=Date.now();if(!(i-n<t))return n=i,e.apply(this,r)}};function zR(){const e=Ft(null),t=Ft(null),n=Ft(null),r=Ft(null),i=Ft(""),s=Ft(null),o=Ft(!1),u=Ft(null);window.addEventListener("clearControlPoints",()=>{s.value=null,n.value&&n.value.clearLayers(),r.value&&r.value.clearLayers(),document.querySelectorAll(".measure-tooltip").forEach(N=>N.remove()),document.querySelectorAll(".drawing-help-message").forEach(N=>N.remove())}),mc(()=>{window.removeEventListener("clearControlPoints",()=>{}),e.value&&(e.value.remove(),e.value=null)});const f=(N,ee="Double-cliquez pour éditer")=>{const fe={fontSize:"14px",color:"#000000",backgroundColor:"#FFFFFF",backgroundOpacity:1,borderColor:"#000000",borderWidth:"1px",borderOpacity:1,padding:"5px 10px",borderRadius:"3px",hasBorder:!0,rotation:0,physicalSize:2},ce=(me,Ue)=>{var Xe;const Qe=((Xe=e.value)==null?void 0:Xe.getZoom())||14,Ze=N.lat,He=wb(Ue.physicalSize,Ze,Qe);return`<div class="text-container" style="width:${He}px;height:${He}px;transform:rotate(${Ue.rotation}deg)">
        <div class="text-annotation" style="font-size:${He*.2}px;color:${Ue.color};background-color:${bm(Ue.backgroundColor,Ue.backgroundOpacity)};border:${Ue.hasBorder?Ue.borderWidth+" solid "+bm(Ue.borderColor,Ue.borderOpacity):"none"};padding:${Ue.padding};border-radius:${Ue.borderRadius}">${me}</div>
        <div class="text-controls"><div class="control-button rotate"></div><div class="control-button move"></div></div>
      </div>`},_e=()=>{if(!e.value)return;const me=k.getIcon(),Ue={html:ce(k.properties.text,k.properties.style),className:me.options.className};k.setIcon(Rt.divIcon(Ue))},se=Rt.divIcon({html:ce(ee,fe),className:"text-container",iconSize:[40,40],iconAnchor:[20,20]}),k=Rt.marker(N,{icon:se,draggable:!1,pmIgnore:!0});k.properties={type:"text",text:ee,style:{...fe}},e.value&&(e.value.on("zoomend",_e),k.on("remove",()=>{var me;(me=e.value)==null||me.off("zoomend",_e)})),_e();let ae=!1,ke=!1,Pe=0,Ge=0;const K=me=>{if(!e.value)return;const Ue=me.target;if(Ue.classList.contains("rotate")){ae=!0;const Qe=k.getLatLng(),Ze=e.value.mouseEventToLatLng(me);Pe=Math.atan2(Ze.lat-Qe.lat,Ze.lng-Qe.lng)*180/Math.PI,Ge=k.properties.style.rotation||0}else Ue.classList.contains("move")&&(ke=!0);document.addEventListener("mousemove",de),document.addEventListener("mouseup",ye)},de=me=>{if(!(!ke||!e.value)){if(ae){const Ue=k.getLatLng(),Qe=e.value.mouseEventToLatLng(me),Ze=Math.atan2(Qe.lat-Ue.lat,Qe.lng-Ue.lng)*180/Math.PI,He=(Ge+(Ze-Pe))%360;k.properties.style.rotation=He;const Xe=k.getIcon(),tt={html:ce(k.properties.text,k.properties.style),className:Xe.options.className};k.setIcon(Rt.divIcon(tt))}else if(ke){const Ue=FR(me),Qe=e.value.mouseEventToLatLng(Ue);k.setLatLng(Qe)}}},ye=()=>{ae=!1,ke=!1,document.removeEventListener("mousemove",de),document.removeEventListener("mouseup",ye)};return k.on("add",()=>{const me=k.getElement();me&&me.querySelectorAll(".control-button").forEach(Qe=>{Qe.addEventListener("mousedown",K)})}),k.on("remove",()=>{const me=k.getElement();me&&me.querySelectorAll(".control-button").forEach(Qe=>{Qe.removeEventListener("mousedown",K)})}),k.on("dblclick",me=>{var tt;Rt.DomEvent.stopPropagation(me);const Ue=(tt=k.getElement())==null?void 0:tt.querySelector(".text-annotation");if(!Ue)return;Ue.contentEditable="true",Ue.focus(),Ue.classList.add("editing");const Qe=window.getSelection(),Ze=document.createRange();Ze.selectNodeContents(Ue),Qe==null||Qe.removeAllRanges(),Qe==null||Qe.addRange(Ze);const He=()=>{Ue.contentEditable="false",Ue.classList.remove("editing");const Mt=Ue.innerText.trim();if(Mt){k.properties.text=Mt;const Lt=k.getIcon(),jt={html:ce(Mt,k.properties.style),className:Lt.options.className};k.setIcon(Rt.divIcon(jt))}Ue.removeEventListener("blur",He),Ue.removeEventListener("keydown",Xe)},Xe=Mt=>{Mt.key==="Enter"&&!Mt.shiftKey&&(Mt.preventDefault(),He())};Ue.addEventListener("blur",He),Ue.addEventListener("keydown",Xe)}),k},d=(N,ee)=>{const fe=Rt.DomUtil.create("div","measure-tooltip");if(fe.innerHTML=ee,fe.style.cssText=`
      position: fixed;
      background-color: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      z-index: 2000;
      pointer-events: none;
      white-space: pre-line;
    `,document.body.appendChild(fe),e.value){const ce=e.value.latLngToContainerPoint(N);fe.style.left=`${ce.x+10}px`,fe.style.top=`${ce.y-25}px`}return fe},g=Mh((N,ee,fe)=>{if(N&&(N.innerHTML=fe,e.value)){const ce=e.value.latLngToContainerPoint(ee);N.style.left=`${ce.x+10}px`,N.style.top=`${ce.y-25}px`}},100),y=(N,ee,fe)=>{N.on("mouseover",()=>{const ce=d(N.getLatLng(),fe());N.measureDiv=ce}),N.on("mousemove",ce=>{N.measureDiv&&e.value&&g(N.measureDiv,ce.latlng,fe())}),N.on("mouseout",()=>{N.measureDiv&&(N.measureDiv.remove(),N.measureDiv=void 0)})};let x=[];const _=()=>{var N;x.cleanup&&x.cleanup(),n.value&&n.value.clearLayers(),x=[],(N=r.value)==null||N.clearLayers(),document.querySelectorAll(".measure-tooltip").forEach(ee=>ee.remove()),t.value&&t.value.getLayers().forEach(ee=>{ee instanceof pa&&ee.clearHelperPoints()})},M=(N,ee="#2563EB")=>{const fe=Rt.circleMarker(N,{radius:6,color:ee,fillColor:ee,fillOpacity:1,weight:2,className:"control-point",pmIgnore:!0});return n.value&&n.value.addLayer(fe),fe},T=(N,ee)=>{var ce,_e,se,k,ae,ke;console.log("Input layer:",{type:ee,instanceof:{Circle:N instanceof Rt.Circle,Rectangle:N instanceof Rt.Rectangle,Polygon:N instanceof Rt.Polygon,Polyline:N instanceof Rt.Polyline,ElevationLine:N instanceof Cf,Line:N instanceof Ns},options:N.options});const fe={type:ee,style:N.options||{}};try{if(N instanceof Rt.Circle){const Pe=N.getRadius();fe.radius=Pe,fe.diameter=Pe*2,fe.surface=Math.PI*Math.pow(Pe,2),fe.perimeter=2*Math.PI*Pe,fe.center=N.getLatLng()}else if(N instanceof Rt.Rectangle){const Pe=N.getBounds(),Ge=Pe.getNorthEast(),K=Pe.getSouthWest(),de=du([[K.lng,K.lat],[Ge.lng,K.lat]]),ye=du([[K.lng,K.lat],[K.lng,Ge.lat]]),me=Vf(de,{units:"meters"}),Ue=Vf(ye,{units:"meters"});fe.width=me,fe.height=Ue,fe.surface=me*Ue,fe.perimeter=2*(me+Ue),fe.dimensions={width:me,height:Ue}}else if(N instanceof Rt.Polygon)try{const Ge=N.getLatLngs()[0].map(de=>[de.lng,de.lat]);Ge.push(Ge[0]);const K=hu([Ge]);fe.surface=ic(K),fe.perimeter=Vf(du(Ge),{units:"meters"})}catch(Pe){console.error("Erreur lors du calcul des propriétés du polygone",Pe)}else if(N instanceof Rt.Polyline&&!(N instanceof Rt.Polygon))try{const Pe=N.getLatLngs();let Ge=0;for(let K=1;K<Pe.length;K++)Ge+=Pe[K].distanceTo(Pe[K-1]);fe.length=Ge}catch(Pe){console.error("Erreur lors du calcul de la longueur de la ligne",Pe)}fe.style={...fe.style,color:((ce=N.options)==null?void 0:ce.color)||"#3388ff",weight:((_e=N.options)==null?void 0:_e.weight)||3,opacity:((se=N.options)==null?void 0:se.opacity)||1,fillColor:((k=N.options)==null?void 0:k.fillColor)||"#3388ff",fillOpacity:((ae=N.options)==null?void 0:ae.fillOpacity)||.2,dashArray:((ke=N.options)==null?void 0:ke.dashArray)||""}}catch(Pe){console.error("Error calculating shape properties:",Pe)}return fe},D=(N,ee=2)=>{var k;if(!e.value){console.warn("Map is not available for text size update");return}const fe=e.value.getZoom(),ce=N.getLatLng().lat,_e=wb(ee,ce,fe),se=(k=N.getElement())==null?void 0:k.querySelector(".text-annotation");se&&(N.properties.style.fontSize=`${_e}px`,N.properties.physicalWidth=ee,N.properties.physicalHeight=ee,bb(se,N.properties.style))},I=(N,ee,fe)=>{const ce=Rt.map(N).setView(ee,fe);e.value=ce,Rt.tileLayer("/osm_tiles/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:5}).addTo(ce);const _e=new Rt.FeatureGroup;return _e.addTo(ce),t.value=_e,n.value=Rt.featureGroup().addTo(ce),r.value=Rt.featureGroup().addTo(ce),ce.pm.setGlobalOptions({snappable:!0,snapDistance:20,allowSelfIntersection:!1,preventMarkerRemoval:!0,syncLayersOnDrag:!0,layerGroup:_e,snapLayers:[_e,r.value],templineStyle:{color:"#3388ff",weight:2,opacity:.7,dashArray:"6,6",radius:6},hintlineStyle:{color:"#3388ff",weight:2,opacity:.7,dashArray:"6,6",radius:6}}),ce.on("pm:drawstart",se=>{o.value=!0,se.shape==="Circle"&&i.value==="Semicircle"&&(ce.getContainer().style.cursor="crosshair")}),ce.on("pm:drawend",()=>{o.value=!1,ce.getContainer().style.cursor="",s.value&&yl("Cliquez sur la forme pour afficher les points de contrôle")}),ce.on("pm:create",Le),_e.on("click",se=>{var ae,ke,Pe,Ge,K,de,ye,me,Ue,Qe,Ze,He,Xe,tt,Mt;Rt.DomEvent.stopPropagation(se);const k=se.layer;if(k.name&&!((ae=k.properties)!=null&&ae.name)?(k.properties||(k.properties={}),k.properties.name=k.name):(ke=k.properties)!=null&&ke.name&&!k.name&&(k.name=k.properties.name),console.log("[featureGroup click] État du nom:",{directName:k.name,propertiesName:(Pe=k.properties)==null?void 0:Pe.name,fullProperties:k.properties}),(Ge=r.value)==null||Ge.clearLayers(),_(),s.value=k,k instanceof Rh)U(k);else if(k instanceof Rt.Circle){console.log("[useMapDrawing] Création du cercle personnalisé:",{propertyDescriptor:Object.getOwnPropertyDescriptor(k,"name"),directName:k.name,propertiesName:(K=k.properties)==null?void 0:K.name,styleNameBeforeTransfer:(ye=(de=k.properties)==null?void 0:de.style)==null?void 0:ye.name,nameIsEnumerable:Object.keys(k).includes("name"),allProperties:Object.keys(k.properties||{}),_dbId:k._dbId});const Lt=k.name,jt=(me=k.properties)==null?void 0:me.name,zt=(Qe=(Ue=k.properties)==null?void 0:Ue.style)==null?void 0:Qe.name,sn=k._dbId,pn=new Rh(k.getLatLng(),{...k.options,radius:k.getRadius()});k.properties?pn.properties={...k.properties||{}}:pn.updateProperties();const et=Lt||jt||zt;et&&(pn.properties.name=et,pn.properties.style||(pn.properties.style={}),pn.properties.style.name=et,pn.name=et),sn&&(pn._dbId=sn),console.log("[useMapDrawing] Cercle après conversion:",{name:pn.name,propertiesName:pn.properties.name,stylePropertyName:(Ze=pn.properties.style)==null?void 0:Ze.name,allProperties:Object.keys(pn.properties||{})}),(He=t.value)==null||He.removeLayer(k),(Xe=t.value)==null||Xe.addLayer(pn),s.value=pn,U(pn)}else if(k instanceof pa)Q(k);else if(k instanceof Rt.Rectangle){const Lt=new pa(k.getBounds(),{...k.options});Lt.updateProperties(),(tt=t.value)==null||tt.removeLayer(k),(Mt=t.value)==null||Mt.addLayer(Lt),s.value=Lt,Q(Lt)}else k instanceof Rt.Polygon?B(k):(k instanceof Ns||k instanceof Rt.Polyline)&&F(k)}),ce.on("pm:edit",se=>{var ae,ke,Pe;console.log("[pm:edit] Début",{layer:se.layer,currentProperties:se.layer.properties});const k=se.layer;if(k){const Ge=((ae=k.properties)==null?void 0:ae.type)||"unknown";if(ge(k,Ge),console.log("[pm:edit] Après updateLayerProperties",{updatedProperties:k.properties,selectedShape:s.value}),k instanceof Rh)U(k);else if(k instanceof pa)Q(k);else if(k instanceof Rt.Rectangle){const K=new pa(k.getBounds(),{...k.options});K.updateProperties(),(ke=t.value)==null||ke.removeLayer(k),(Pe=t.value)==null||Pe.addLayer(K),s.value=K,Q(K)}else k instanceof Rt.Polygon?B(k):k instanceof Ns?(k.updateProperties(),ge(k,"Line"),F(k)):k instanceof Rt.Polyline&&F(k)}}),ce.on("pm:dragstart",()=>{document.querySelectorAll(".drawing-help-message").forEach(se=>se.remove()),yl("Déplacez la forme à l'endroit souhaité")}),ce.on("pm:dragend",se=>{var ae,ke,Pe;console.log("[pm:dragend] Début",{layer:se.layer,currentProperties:se.layer.properties});const k=se.layer;if(k){const Ge=((ae=k.properties)==null?void 0:ae.type)||"unknown";if(k instanceof Rt.Rectangle&&!(k instanceof pa)){const K=new pa(k.getBounds(),{...k.options});K.updateProperties(),(ke=t.value)==null||ke.removeLayer(k),(Pe=t.value)==null||Pe.addLayer(K),s.value=K,Q(K)}else k instanceof Ns?(k.updateProperties(),ge(k,"Line"),F(k)):ge(k,Ge);console.log("[pm:dragend] Après updateLayerProperties",{updatedProperties:k.properties,selectedShape:s.value})}setTimeout(()=>{yl("Cliquez sur la forme pour afficher les points de contrôle")},100)}),ce.on("pm:remove",()=>{var se;(se=document.querySelector(".drawing-help-message"))==null||se.remove()}),ce.on("pm:select",()=>{document.querySelectorAll(".drawing-help-message").forEach(se=>se.remove()),yl("Utilisez les points de contrôle pour modifier la forme")}),ce.on("pm:unselect",()=>{document.querySelectorAll(".drawing-help-message").forEach(se=>se.remove())}),ce.on("zoomstart",()=>{s.value&&(_(),s.value=null,document.querySelectorAll(".drawing-help-message").forEach(se=>se.remove()))}),ce},j=()=>{if(!(!e.value||!t.value||!t.value.getLayers().length))try{const N=t.value.getBounds();if(N.isValid()){const ee={zoomAnimation:e.value.options.zoomAnimation,fadeAnimation:e.value.options.fadeAnimation,markerZoomAnimation:e.value.options.markerZoomAnimation};e.value.options.zoomAnimation=!1,e.value.options.fadeAnimation=!1,e.value.options.markerZoomAnimation=!1,e.value.fitBounds(N,{padding:[50,50],maxZoom:18,animate:!1,duration:0,noMoveStart:!0}),e.value.invalidateSize({animate:!1,pan:!1}),setTimeout(()=>{try{e.value.options.fadeAnimation=ee.fadeAnimation,setTimeout(()=>{try{e.value.options.zoomAnimation=ee.zoomAnimation,e.value.options.markerZoomAnimation=ee.markerZoomAnimation}catch(fe){console.warn("[useMapDrawing] Erreur lors de la restauration des animations:",fe)}},500)}catch(fe){console.warn("[useMapDrawing] Erreur lors de la restauration des animations:",fe)}},500)}}catch(N){if(console.warn("[useMapDrawing] Error adjusting view:",N),e.value)try{e.value.options.zoomAnimation=!0,e.value.options.fadeAnimation=!0,e.value.options.markerZoomAnimation=!0,e.value.invalidateSize({animate:!1,pan:!1})}catch(ee){console.error("[useMapDrawing] Erreur lors de la restauration après échec:",ee)}}},Z=N=>{var fe;if(!e.value)return;document.querySelectorAll(".drawing-help-message").forEach(ce=>ce.remove());try{const ce=e.value.pm;ce.globalEditModeEnabled()&&ce.disableGlobalEditMode(),ce.globalRemovalModeEnabled()&&ce.disableGlobalRemovalMode(),ce.disableDraw(),_(),(fe=r.value)==null||fe.clearLayers()}catch(ce){console.error("Error disabling modes:",ce)}if(i.value=N,!N){_();return}let ee=N;switch(N){case"Note":ee="GeoNote";break;case"Polygon":ee="Polygon";break;case"Line":ee="Line";break;case"ElevationLine":ee="ElevationLine";break;default:ee=N}N=ee,De(),setTimeout(()=>{var ce,_e,se,k,ae,ke,Pe,Ge,K,de,ye,me,Ue;try{switch(N){case"Polygon":yl("Cliquez pour ajouter des points, double-cliquez pour terminer le polygone"),(ce=e.value)==null||ce.pm.enableDraw("Polygon",{finishOn:"dblclick",continueDrawing:!1,snapMiddle:!0,snapDistance:20}),(_e=e.value)==null||_e.off("pm:create"),(se=e.value)==null||se.on("pm:create",Ze=>{var He,Xe,tt;if(Ze.shape==="Polygon"&&Ze.layer){const Mt=Ze.layer.getLatLngs()[0];(He=e.value)==null||He.removeLayer(Ze.layer),(Xe=t.value)!=null&&Xe.hasLayer(Ze.layer)&&t.value.removeLayer(Ze.layer);const Lt=new gf(Mt,{color:"#3B82F6",weight:3,fillColor:"#3B82F6",fillOpacity:.2});t.value&&(t.value.addLayer(Lt),s.value=Lt,Lt.updateProperties()),(tt=e.value)==null||tt.pm.disableDraw(),De()}});break;case"Circle":t.value&&t.value.getLayers().filter(He=>He instanceof pa).forEach(He=>{He.toggleHelperPoints(e.value,!0,"#DC2626","#2563EB")}),e.value.pm.setGlobalOptions({snapDistance:15,snapSegment:!0,snapVertices:!0,snapLayers:[t.value,r.value],snapMiddle:!0,snapIntersections:!0}),yl("Positionnez le centre du cercle. Points bleus : milieu des côtés, Points rouges : sommets, Point vert : centre"),e.value.pm.enableDraw("Circle",{finishOn:"mouseup",continueDrawing:!1});break;case"Rectangle":yl("Cliquez et maintenez pour dessiner un rectangle, relâchez pour terminer"),(k=e.value)==null||k.pm.enableDraw("Rectangle",{finishOn:"mouseup"});break;case"Polygon":yl("Cliquez pour ajouter des points, double-cliquez pour terminer le polygone"),(ae=e.value)==null||ae.pm.enableDraw("Polygon",{finishOn:"dblclick",continueDrawing:!1,snapMiddle:!0,snapDistance:20});break;case"Line":yl("Cliquez pour ajouter des points, double-cliquez pour terminer la ligne"),(ke=e.value)==null||ke.pm.enableDraw("Line",{finishOn:"dblclick",continueDrawing:!1,snapMiddle:!0,snapDistance:20}),(Pe=e.value)==null||Pe.off("pm:create"),(Ge=e.value)==null||Ge.on("pm:create",Ze=>{var He,Xe,tt;if(Ze.shape==="Line"&&Ze.layer){const Mt=Ze.layer.getLatLngs();(He=e.value)==null||He.removeLayer(Ze.layer),(Xe=t.value)!=null&&Xe.hasLayer(Ze.layer)&&t.value.removeLayer(Ze.layer);const Lt=new Ns(Mt,{color:"#3B82F6",weight:3,opacity:.8});t.value&&(t.value.addLayer(Lt),s.value=Lt,Lt.updateProperties()),(tt=e.value)==null||tt.pm.disableDraw(),De()}});break;case"Text":if(yl("Cliquez pour ajouter du texte, double-cliquez pour éditer"),e.value){const Ze=He=>{if(!e.value||!t.value)return;const Xe=f(He.latlng);t.value.addLayer(Xe),s.value=Xe,e.value.off("click",Ze),Z("")};e.value.on("click",Ze)}break;case"GeoNote":if(yl("Cliquez pour ajouter une note géolocalisée, double-cliquez pour éditer"),e.value){const Ze=async He=>{if(!(!e.value||!t.value))try{const Xe=ad(),tt=new Fp(He.latlng,{color:"#3B82F6",name:"Note géolocalisée",description:"",columnId:"1"});t.value.addLayer(tt),s.value=tt,tt.updateProperties();const Mt={plan:Xe.currentMapId,title:tt.properties.name,description:tt.properties.description,location:{type:"Point",coordinates:[He.latlng.lng,He.latlng.lat]},access_level:tt.properties.accessLevel,style:tt.properties.style,category:tt.properties.category};console.log("[useMapDrawing] Sauvegarde de la note géolocalisée dans le backend:",Mt),zc(()=>Promise.resolve().then(()=>oT),void 0).then(async({noteService:Lt})=>{try{const jt=await Lt.createNote(Mt);console.log("[useMapDrawing] Note sauvegardée avec succès:",jt.data);const zt=jt.data.id,sn=tt._leaflet_id;console.log(`[useMapDrawing] ID Leaflet: ${sn}, ID backend: ${zt}`),tt._dbId=zt,tt.properties.id=zt,jt.data.column_id&&(tt.properties.columnId=jt.data.column_id,console.log("[useMapDrawing] colonne mise à jour avec:",jt.data.column_id)),window.dispatchEvent(new CustomEvent("note:created",{detail:{note:jt.data,geoNote:tt,leafletId:sn,backendId:zt}})),tt.openPopup(),tt.triggerPlanSave()}catch(jt){console.error("[useMapDrawing] Erreur lors de la sauvegarde de la note:",jt),zc(async()=>{const{useNotificationStore:zt}=await Promise.resolve().then(()=>p8);return{useNotificationStore:zt}},void 0).then(({useNotificationStore:zt})=>{zt().error("Erreur lors de la création de la note")})}}),e.value.off("click",Ze),Z("")}catch(Xe){console.error("[useMapDrawing] Erreur lors de la création de la note:",Xe),e.value.off("click",Ze),Z("")}};e.value.on("click",Ze)}break;case"delete":yl("Cliquez sur une forme pour la supprimer"),(K=e.value)==null||K.pm.enableGlobalRemovalMode();break;case"ElevationLine":yl("Cliquez et maintenez pour tracer le profil altimétrique"),(de=e.value)==null||de.pm.enableDraw("Line",{finishOn:"mouseup",continueDrawing:!1,allowSelfIntersection:!1,templineStyle:{color:"#FF4500",weight:4,opacity:.8}}),(ye=e.value)==null||ye.pm.setGlobalOptions({continueDrawing:!1,finishOn:"mouseup",preventMarkerRemoval:!0,preventVertexEdit:!0,preventMarkerEdit:!0}),(me=e.value)==null||me.off("pm:create"),(Ue=e.value)==null||Ue.on("pm:create",async Ze=>{var He,Xe,tt;if(Ze.shape==="Line"&&Ze.layer){const Mt=Ze.layer.getLatLngs();(He=e.value)==null||He.removeLayer(Ze.layer),(Xe=t.value)!=null&&Xe.hasLayer(Ze.layer)&&t.value.removeLayer(Ze.layer);const Lt=new Cf(Mt,{color:"#FF4500",weight:4,opacity:.8,interactive:!1,pmIgnore:!0});if(t.value){t.value.addLayer(Lt),s.value=Lt,await Lt.updateElevationProfile();const jt=T(Lt,"ElevationLine");Object.assign(Lt.properties,{...jt,...Lt.properties,type:"ElevationLine",elevationData:Lt.getElevationData()}),s.value=null,Xs(()=>{s.value=Lt})}(tt=e.value)==null||tt.pm.disableDraw(),i.value="",De()}});break}}catch(Qe){console.error("[setDrawingTool] Erreur lors de la configuration de l'outil:",Qe)}},100)},te=N=>{var fe;if(!s.value)return;const ee=s.value;if(ee.properties=ee.properties||{},ee.properties.style=ee.properties.style||{},ee.properties.style={...ee.properties.style,...N},ee.properties.type==="text"){const ce=ee.properties._textLayer,_e=(fe=ce==null?void 0:ce.getElement())==null?void 0:fe.querySelector(".text-annotation");_e&&bb(_e,ee.properties.style);const se={color:N.borderColor||ee.properties.style.borderColor,weight:parseInt(N.borderWidth||ee.properties.style.borderWidth),opacity:N.borderOpacity??ee.properties.style.borderOpacity};"setStyle"in ee&&ee.setStyle(se)}else if(ee.properties.type==="TextRectangle")console.log("[updateShapeStyle] TextRectangle supprimé selon les exigences");else{const ce={};N.fillColor&&(ce.fillColor=N.fillColor),N.fillOpacity!==void 0&&(ce.fillOpacity=N.fillOpacity),N.strokeColor&&(ce.color=N.strokeColor),N.strokeOpacity!==void 0&&(ce.opacity=N.strokeOpacity),N.strokeWidth!==void 0&&(ce.weight=N.strokeWidth),N.dashArray&&(ce.dashArray=N.dashArray),"setStyle"in ee&&ee.setStyle(ce)}},ue=N=>{var k,ae,ke,Pe,Ge;if(!s.value){console.warn("[useMapDrawing] Cannot update properties: no shape selected");return}console.log("[useMapDrawing] Updating shape properties",{before:s.value.properties,newProps:N,layerType:(k=s.value.properties)==null?void 0:k.type,beforeName:s.value.name,beforePropertiesName:(ae=s.value.properties)==null?void 0:ae.name,beforeCategory:(ke=s.value.properties)==null?void 0:ke.category,nameIsDirectProperty:"name"in s.value,dbId:s.value._dbId}),s.value.properties||(s.value.properties={});const ee=s.value.properties.type;console.log(`[useMapDrawing] Type actuel de la forme: ${ee}`),s.value.properties.category||(s.value.properties.category="forages"),s.value.properties.accessLevel||(s.value.properties.accessLevel="visitor"),s.value._dbId||(s.value._dbId=Date.now()+Math.floor(Math.random()*1e3),console.log(`[useMapDrawing] Assigned temporary dbId: ${s.value._dbId}`));const fe=s.value.properties.type;console.log(`[useMapDrawing] Type original avant mise à jour: ${fe}`);const ce=s.value.properties.category;console.log(`[useMapDrawing] Catégorie existante: ${ce}`);const _e="category"in N&&N.category!==ce;if(Object.keys(N).forEach(K=>{K==="type"&&fe?console.log(`[useMapDrawing] Préservation du type original: ${fe}`):s.value.properties[K]=N[K],K==="name"&&(console.log(`[useMapDrawing] Setting name "${N[K]}" directly on layer`),s.value.name=N[K]),K==="category"&&console.log(`[useMapDrawing] Mise à jour de la catégorie: ${ce} -> ${N[K]}`)}),fe&&(s.value.properties.type=fe),ce&&!_e&&(console.log(`[useMapDrawing] Restauration de la catégorie originale: ${ce}`),s.value.properties.category=ce),s.value._dbId&&_e){const K=ad(),de=K.elements.find(ye=>ye.id===s.value._dbId);if(de){console.log(`[useMapDrawing] Mise à jour de la catégorie dans le store: ${s.value.properties.category} pour l'élément ${s.value._dbId}`);const ye=de;ye.data||(ye.data={}),ye.data.category=s.value.properties.category,K.$patch({unsavedChanges:!0})}}const se=new CustomEvent("shape:propertiesUpdated",{detail:{shape:s.value,properties:s.value.properties,categoryUpdated:_e}});if(window.dispatchEvent(se),console.log("[useMapDrawing] Updated shape properties",{after:s.value.properties,name:s.value.name,propertiesName:(Pe=s.value.properties)==null?void 0:Pe.name,allLayerKeys:Object.keys(s.value),allPropertiesKeys:Object.keys(s.value.properties||{})}),((Ge=s.value.properties)==null?void 0:Ge.type)==="Circle"){const K=s.value,de=K.getRadius();K.properties.radius=de,K.properties.diameter=de*2,K.properties.surface=Math.PI*de*de,K.properties.perimeter=2*Math.PI*de,N.name&&(console.log(`[useMapDrawing] Ensuring circle name "${N.name}" is set in multiple places`),K.properties.name=N.name,K.properties.style.name=N.name,K.name=N.name,console.log("[useMapDrawing] Circle name verification:",{circleDirectName:K.name,circlePropertiesName:K.properties.name,nameIsEnumerable:Object.keys(K).includes("name"),propertiesNameIsEnumerable:Object.keys(K.properties).includes("name")}))}},le=N=>{console.log("[forceShapeUpdate] Début",{currentProperties:N.properties,selectedShapeRef:s.value}),s.value=null,Xs(()=>{s.value=N,console.log("[forceShapeUpdate] Après mise à jour",{selectedShape:s.value,properties:s.value.properties})})},ge=(N,ee)=>{console.log("[updateLayerProperties] Début",{layer:N,shapeType:ee,currentProperties:N.properties}),jR((ce,_e)=>{const se=T(ce,_e);console.log("[updateLayerProperties] Nouvelles propriétés calculées",{newProperties:se}),ce.properties={...se},le(ce),ce.fire("properties:updated",{shape:ce,properties:ce.properties}),console.log("[updateLayerProperties] Fin",{finalProperties:ce.properties,selectedShape:s.value})},100)(N,ee)},H=(N,ee)=>Rt.latLng((N.lat+ee.lat)/2,(N.lng+ee.lng)/2),U=N=>{if(!e.value||!t.value)return;_();const ee=N.getLatLng(),fe=N.getRadius(),ce=M(ee,"#059669");x.push(ce),y(ce,N,()=>[qi(fe,"m","Rayon"),qi(fe*2,"m","Diamètre"),qi(Math.PI*Math.pow(fe,2),"m²","Surface")].join("<br>"));const _e=[],se=[0,45,90,135,180,225,270,315];se.forEach(k=>{const ae=N.calculatePointOnCircle(k),ke=M(ae,"#2563EB");_e.push(ke),x.push(ke),y(ke,N,()=>qi(fe,"m","Rayon")),ke.on("mousedown",Pe=>{if(!e.value)return;Rt.DomEvent.stopPropagation(Pe),e.value.dragging.disable();let Ge=!0;const K=ye=>{Ge&&(N.resizeFromControlPoint(ye.latlng),_e.forEach((me,Ue)=>{const Qe=N.calculatePointOnCircle(se[Ue]);me.setLatLng(Qe)}),ce.setLatLng(N.getLatLng()),ke.measureDiv&&(ke.measureDiv.innerHTML=qi(N.getRadius(),"m","Rayon")))},de=()=>{Ge=!1,e.value&&(e.value.off("mousemove",K),document.removeEventListener("mouseup",de),e.value.dragging.enable(),N.updateProperties(),s.value=null,Xs(()=>{s.value=N}),ge(N,"Circle"))};e.value.on("mousemove",K),document.addEventListener("mouseup",de)})}),ce.on("mousedown",k=>{if(!e.value)return;Rt.DomEvent.stopPropagation(k),e.value.dragging.disable();let ae=!0;const ke=N.getLatLng(),Pe=k.latlng,Ge=de=>{if(!ae)return;const ye=de.latlng.lng-Pe.lng,me=de.latlng.lat-Pe.lat,Ue=Rt.latLng(ke.lat+me,ke.lng+ye);Rt.Circle.prototype.setLatLng.call(N,Ue),ce.setLatLng(Ue),_e.forEach((Qe,Ze)=>{const He=N.calculatePointOnCircle(se[Ze]);Qe.setLatLng(He)}),ce.measureDiv&&(ce.measureDiv.innerHTML=[qi(N.getRadius(),"m","Rayon"),qi(N.getRadius()*2,"m","Diamètre"),qi(Math.PI*Math.pow(N.getRadius(),2),"m²","Surface")].join("<br>"))},K=()=>{ae=!1,e.value&&(e.value.off("mousemove",Ge),document.removeEventListener("mouseup",K),e.value.dragging.enable(),N.updateProperties(),s.value=null,Xs(()=>{s.value=N}),ge(N,"Circle"))};e.value.on("mousemove",Ge),document.addEventListener("mouseup",K)}),N.on("circle:resized",()=>{ge(N,"Circle")}),s.value=N},Q=N=>{var Ge;if(!e.value||!t.value)return;if(!(N instanceof pa)){console.warn("La couche n'est pas une instance de Rectangle");return}const ee=N;_();const fe=ee.getCenter(),ce=ee.getRotatedCorners(),_e=ee.getMidPoints(),se=M(fe,"#059669");x.push(se),y(se,ee,()=>{const{width:K,height:de}=ee.getDimensions(),ye=K*de,me=ee.getRotation();return[qi(K,"m","Largeur"),qi(de,"m","Hauteur"),qi(ye,"m²","Surface"),`Rotation: ${me.toFixed(1)}°`].join("<br>")});const k=M(Rt.latLng(fe.lat+(ce[0].lat-fe.lat)*1.2,fe.lng+(ce[0].lng-fe.lng)*1.2),"#F97316");x.push(k);const ae=Rt.polyline([fe,k.getLatLng()],{color:"#F97316",weight:1,opacity:.6,dashArray:"4",pmIgnore:!0});(Ge=n.value)==null||Ge.addLayer(ae);const ke=ce.map(K=>{const de=M(K,"#DC2626");return x.push(de),y(de,ee,()=>{const{width:ye,height:me}=ee.getDimensions();return[qi(ye,"m","Largeur"),qi(me,"m","Hauteur")].join("<br>")}),de}),Pe=_e.map((K,de)=>{const ye=M(K,"#2b6451");return x.push(ye),y(ye,ee,()=>{const{width:me,height:Ue}=ee.getDimensions(),Qe=de%2===0?me:Ue;return[qi(Qe,"m","Longueur du côté"),qi(Qe/2,"m","Distance au coin")].join("<br>")}),ye});se.on("mousedown",K=>{if(!e.value)return;Rt.DomEvent.stopPropagation(K),e.value.dragging.disable();let de=!0;const ye=Ue=>{if(!de)return;ee.moveFromCenter(Ue.latlng);const Qe=ee.getRotatedCorners(),Ze=ee.getMidPoints();ke.forEach((Xe,tt)=>Xe.setLatLng(Qe[tt])),Pe.forEach((Xe,tt)=>Xe.setLatLng(Ze[tt])),se.setLatLng(Ue.latlng);const He=Rt.latLng(Ue.latlng.lat+(Qe[0].lat-Ue.latlng.lat)*1.2,Ue.latlng.lng+(Qe[0].lng-Ue.latlng.lng)*1.2);k.setLatLng(He),ae.setLatLngs([Ue.latlng,He])},me=()=>{de=!1,e.value&&(e.value.off("mousemove",ye),document.removeEventListener("mouseup",me),e.value.dragging.enable(),ee.updateProperties(),s.value=null,Xs(()=>{s.value=ee}))};e.value.on("mousemove",ye),document.addEventListener("mouseup",me)}),k.on("mousedown",K=>{if(!e.value)return;Rt.DomEvent.stopPropagation(K),e.value.dragging.disable();let de=!1;const ye=K.latlng,me=ee.getRotation(),Ue=ee.getCenter(),Qe=ye.lng-Ue.lng,Ze=ye.lat-Ue.lat,He=Math.atan2(Ze,Qe)*180/Math.PI;x.forEach(Mt=>{Mt!==k&&(Mt.setStyle({opacity:0,fillOpacity:0}),Mt.measureDiv&&(Mt.measureDiv.style.display="none"))});const Xe=Mh(Mt=>{de||(de=!0);const Lt=Mt.latlng.lng-Ue.lng,jt=Mt.latlng.lat-Ue.lat;let sn=Math.atan2(jt,Lt)*180/Math.PI-He,pn=(me+sn)%360;pn<0&&(pn+=360),ee.setRotation(pn,!1),k.setLatLng(Mt.latlng),ae.setLatLngs([Ue,Mt.latlng])},16),tt=()=>{e.value&&(e.value.off("mousemove",Xe),document.removeEventListener("mouseup",tt),e.value.dragging.enable(),de&&ee.finalizeRotation(),s.value=null,Xs(()=>{s.value=ee,_(),Q(ee)}))};e.value.on("mousemove",Xe),document.addEventListener("mouseup",tt)}),ee.on("coordinates:updated",K=>{const{corners:de,center:ye}=K,me=ee.getMidPoints();ke.forEach((Qe,Ze)=>Qe.setLatLng(de[Ze])),Pe.forEach((Qe,Ze)=>Qe.setLatLng(me[Ze])),se.setLatLng(ye);const Ue=Rt.latLng(ye.lat+(de[0].lat-ye.lat)*1.2,ye.lng+(de[0].lng-ye.lng)*1.2);k.setLatLng(Ue),ae.setLatLngs([ye,Ue])})},F=N=>{if(!e.value||!t.value)return;_();const ee=N.getLatLngs();if(!ee||ee.length===0){console.warn("Pas de points pour la ligne");return}let fe=null;if(N instanceof Ns){const ce=N.getCenter();fe=M(ce,"#059669"),x.push(fe),y(fe,N,()=>{const _e=N.getLength()||0;return qi(_e,"m","Longueur totale")}),fe.on("mousedown",_e=>{if(!e.value)return;Rt.DomEvent.stopPropagation(_e),e.value.dragging.disable();let se=!0;const k=N.getLatLngs().map(K=>Rt.latLng(K.lat,K.lng)),ae=_e.latlng;N instanceof Ns&&(N.off("move:end"),N.off("vertex:moved"),N.off("latlngs:updated"),N.off("properties:updated")),x.forEach((K,de)=>{de>0&&(K.setStyle({opacity:0,fillOpacity:0}),K.measureDiv&&(K.measureDiv.style.display="none"))});const Pe=Mh(K=>{if(!se)return;const de=K.latlng.lng-ae.lng,ye=K.latlng.lat-ae.lat,me=k.map(Ue=>Rt.latLng(Ue.lat+ye,Ue.lng+de));Rt.Polyline.prototype.setLatLngs.call(N,me),fe==null||fe.setLatLng(K.latlng)},16),Ge=()=>{if(se=!1,!!e.value){if(e.value.off("mousemove",Pe),document.removeEventListener("mouseup",Ge),e.value.dragging.enable(),N instanceof Ns){const K=()=>{_(),F(N)};N.on("move:end",K),N.on("vertex:moved",K),N.on("latlngs:updated",K),N.on("properties:updated",K),N.updateProperties(),ge(N,"Line")}_(),F(N)}};e.value.on("mousemove",Pe),document.addEventListener("mouseup",Ge)})}if(ee.forEach((ce,_e)=>{const se=M(ce,"#DC2626");x.push(se),y(se,N,()=>{if(N instanceof Ns){const k=N.getLength()||0,ae=N.getLengthToVertex(_e);return[qi(ae,"m","Distance depuis le début"),qi(k,"m","Longueur totale")].join("<br>")}return""}),se.on("mousedown",k=>{if(!e.value)return;Rt.DomEvent.stopPropagation(k),e.value.dragging.disable();let ae=!0;N instanceof Ns&&(N.off("move:end"),N.off("vertex:moved"),N.off("latlngs:updated"),N.off("properties:updated")),x.forEach((Ge,K)=>{K!==_e+1&&(Ge.setStyle({opacity:0,fillOpacity:0}),Ge.measureDiv&&(Ge.measureDiv.style.display="none"))});const ke=Mh(Ge=>{if(!ae)return;const K=N.getLatLngs();K[_e]=Ge.latlng,Rt.Polyline.prototype.setLatLngs.call(N,K),se.setLatLng(Ge.latlng)},16),Pe=()=>{if(ae=!1,!!e.value){if(e.value.off("mousemove",ke),document.removeEventListener("mouseup",Pe),e.value.dragging.enable(),N instanceof Ns){const Ge=()=>{_(),F(N)};N.on("move:end",Ge),N.on("vertex:moved",Ge),N.on("latlngs:updated",Ge),N.on("properties:updated",Ge),N.updateProperties(),ge(N,"Line")}_(),F(N)}};e.value.on("mousemove",ke),document.addEventListener("mouseup",Pe)})}),ee.length>=2)for(let ce=0;ce<ee.length-1;ce++){const _e=ee[ce],se=ee[ce+1],k=Rt.latLng((_e.lat+se.lat)/2,(_e.lng+se.lng)/2),ae=M(k,"#2b6451");x.push(ae),y(ae,N,()=>{if(N instanceof Ns){const ke=N.getSegmentLengthAt(ce),Pe=N.getLength()||0,Ge=N.getLengthToVertex(ce)+ke/2;return[qi(ke,"m","Longueur du segment"),qi(ke/2,"m","Demi-segment"),qi(Ge,"m","Distance depuis le début"),qi(Pe,"m","Longueur totale")].join("<br>")}return""})}if(N instanceof Ns){const ce=()=>{_(),F(N)};N.on("move:start",()=>{x.forEach((_e,se)=>{se>0&&(_e.setStyle({opacity:0,fillOpacity:0}),_e.measureDiv&&(_e.measureDiv.style.display="none"))})}),N.on("move:end",ce),N.on("vertex:moved",ce),N.on("latlngs:updated",ce),N.on("properties:updated",ce),x.cleanup=()=>{N.off("move:start",()=>{}),N.off("move:end",ce),N.off("vertex:moved",ce),N.off("latlngs:updated",ce),N.off("properties:updated",ce)}}},B=N=>{if(!e.value||!t.value)return;_();const ee=N.getLatLngs()[0],fe=ee.map(Pe=>[Pe.lng,Pe.lat]);fe.push(fe[0]);const ce=hu([fe]),_e=ic(ce),se=ee.reduce((Pe,Ge,K)=>{const de=ee[(K+1)%ee.length];return Pe+Ge.distanceTo(de)},0);let k;if(typeof N.getCenter=="function")try{k=N.getCenter()}catch(Pe){console.warn("Erreur lors de la récupération du centre du polygone via getCenter(), utilisation de la méthode alternative",Pe);const Ge=op(ce);k=Rt.latLng(Ge.geometry.coordinates[1],Ge.geometry.coordinates[0])}else{const Pe=op(ce);k=Rt.latLng(Pe.geometry.coordinates[1],Pe.geometry.coordinates[0])}const ae=M(k,"#059669");x.push(ae),y(ae,N,()=>[qi(se,"m","Périmètre"),qi(_e,"m²","Surface")].join("<br>")),ae.on("mousedown",Pe=>{if(!e.value)return;Rt.DomEvent.stopPropagation(Pe),e.value.dragging.disable();let Ge=!0;const K=Pe.latlng,de=[...ee];x.forEach((Qe,Ze)=>{Ze>0&&Qe.setStyle({opacity:0,fillOpacity:0})});const ye=Mh(Qe=>{if(!Ge)return;const Ze=Qe.latlng.lng-K.lng,He=Qe.latlng.lat-K.lat,Xe=de.map(tt=>Rt.latLng(tt.lat+He,tt.lng+Ze));Rt.Polygon.prototype.setLatLngs.call(N,[Xe]),ae.setLatLng(Qe.latlng)},16),me=Qe=>{Ge&&ye(Qe)},Ue=()=>{if(Ge=!1,!!e.value){if(e.value.off("mousemove",me),document.removeEventListener("mouseup",Ue),e.value.dragging.enable(),N.properties){const Qe=N.getLatLngs()[0],Ze=Qe.map(Xe=>[Xe.lng,Xe.lat]);Ze.push(Ze[0]);const He=hu([Ze]);N.properties.area=ic(He),N.properties.perimeter=Qe.reduce((Xe,tt,Mt)=>{const Lt=Qe[(Mt+1)%Qe.length];return Xe+tt.distanceTo(Lt)},0),N.properties.surface=N.properties.area}_(),B(N),s.value=null,Xs(()=>{s.value=N})}};e.value.on("mousemove",me),document.addEventListener("mouseup",Ue)}),ee.forEach((Pe,Ge)=>{const K=M(Pe,"#DC2626");x.push(K),y(K,N,()=>{const de=ee[(Ge-1+ee.length)%ee.length],ye=ee[(Ge+1)%ee.length],me=Pe.distanceTo(de),Ue=Pe.distanceTo(ye);return[qi(me,"m","Distance au point précédent"),qi(Ue,"m","Distance au point suivant"),qi(se,"m","Périmètre total"),qi(_e,"m²","Surface")].join("<br>")}),K.on("mousedown",de=>{if(Rt.DomEvent.stopPropagation(de),!e.value)return;e.value.dragging.disable();let ye=!0;ae&&(ae.setStyle({opacity:0,fillOpacity:0}),ae.measureDiv&&(ae.measureDiv.style.display="none"));const me=Mh(Ze=>{if(!ye)return;ee[Ge]=Ze.latlng,Rt.Polygon.prototype.setLatLngs.call(N,[ee]),K.setLatLng(Ze.latlng);const He=x.slice(ee.length+1),Xe=(Ge-1+ee.length)%ee.length,tt=He[Xe];if(tt){const Lt=ee[Xe],jt=ee[Ge],zt=Rt.latLng((Lt.lat+jt.lat)/2,(Lt.lng+jt.lng)/2);tt.setLatLng(zt)}const Mt=He[Ge];if(Mt){const Lt=ee[Ge],jt=ee[(Ge+1)%ee.length],zt=Rt.latLng((Lt.lat+jt.lat)/2,(Lt.lng+jt.lng)/2);Mt.setLatLng(zt)}},16),Ue=Ze=>{ye&&me(Ze)},Qe=()=>{if(ye=!1,!!e.value){if(e.value.off("mousemove",Ue),document.removeEventListener("mouseup",Qe),e.value.dragging.enable(),N.properties){const Ze=N.getLatLngs()[0].map(Xe=>[Xe.lng,Xe.lat]);Ze.push(Ze[0]);const He=hu([Ze]);N.properties.area=ic(He),N.properties.perimeter=ee.reduce((Xe,tt,Mt)=>{const Lt=ee[(Mt+1)%ee.length];return Xe+tt.distanceTo(Lt)},0),N.properties.surface=N.properties.area}_(),B(N),s.value=null,Xs(()=>{s.value=N})}};e.value.on("mousemove",Ue),document.addEventListener("mouseup",Qe)})}),(()=>{const Pe=N.getLatLngs()[0];x.slice(Pe.length+1).forEach(K=>{n.value&&n.value.removeLayer(K)}),x=x.slice(0,Pe.length+1);const Ge=new Array(Pe.length);for(let K=0;K<Pe.length;K++){const de=Pe[K],ye=Pe[(K+1)%Pe.length];Ge[K]=H(de,ye)}Ge.forEach((K,de)=>{const ye=M(K,"#2b6451");x.push(ye),y(ye,N,()=>{const me=Pe[de],Ue=Pe[(de+1)%Pe.length],Qe=me.distanceTo(Ue);return[qi(Qe,"m","Longueur du segment"),qi(se,"m","Périmètre total"),qi(_e,"m²","Surface")].join("<br>")}),ye.on("mousedown",me=>{if(!e.value)return;Rt.DomEvent.stopPropagation(me),e.value.dragging.disable();let Ue=!0;const Qe=de;ae&&(ae.setStyle({opacity:0,fillOpacity:0}),ae.measureDiv&&(ae.measureDiv.style.display="none"));const Ze=[...N.getLatLngs()[0]];Ze.splice((Qe+1)%Ze.length,0,K),N.setLatLngs([Ze]),_(),B(N);const He=Qe+1,Xe=1+He,tt=He<x.length-1?x[Xe]:null;if(tt){const Mt=jt=>{if(!Ue)return;const zt=N.getLatLngs()[0];zt[He]=jt.latlng,N.setLatLngs([zt]),tt.setLatLng(jt.latlng);const sn=x.slice(1+zt.length),pn=(He-1+zt.length)%zt.length,et=He;if(sn[pn]){const ot=zt[pn],rt=zt[He],Ht=Rt.latLng((ot.lat+rt.lat)/2,(ot.lng+rt.lng)/2);sn[pn].setLatLng(Ht)}if(sn[et]){const ot=zt[He],rt=zt[(He+1)%zt.length],Ht=Rt.latLng((ot.lat+rt.lat)/2,(ot.lng+rt.lng)/2);sn[et].setLatLng(Ht)}},Lt=()=>{if(Ue=!1,!!e.value){if(e.value.off("mousemove",Mt),document.removeEventListener("mouseup",Lt),e.value.dragging.enable(),N.properties){const jt=N.getLatLngs()[0].map(sn=>[sn.lng,sn.lat]);jt.push(jt[0]);const zt=hu([jt]);N.properties.area=ic(zt),N.properties.perimeter=N.getLatLngs()[0].reduce((sn,pn,et,ot)=>{const rt=ot[(et+1)%ot.length];return sn+pn.distanceTo(rt)},0)}_(),B(N),s.value=null,Xs(()=>{s.value=N})}};e.value.on("mousemove",Mt),document.addEventListener("mouseup",Lt)}else e.value.dragging.enable(),_(),B(N)})})})()},R=N=>{if(!(!e.value||!r.value)){console.log("[generateTempControlPoints] Génération des points temporaires pour",{layerType:N.constructor.name,properties:N.properties}),r.value.clearLayers();try{if(N instanceof pa)N.generateHelperPoints(e.value);else if(N instanceof Rh){if("getLatLng"in N&&typeof N.getLatLng=="function"){const ee=N.getLatLng();if(ee){const fe=Rt.circleMarker(ee,{radius:5,color:"#059669",fillColor:"#059669",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});r.value.addLayer(fe)}}}else if(N instanceof gf||N instanceof Rt.Polygon){let ee=[];if("getLatLngs"in N){const ce=N.getLatLngs();if(Array.isArray(ce)&&ce.length>0){const _e=ce[0];Array.isArray(_e)?ee=_e:_e instanceof Rt.LatLng&&(ee=ce)}}let fe=null;if(N instanceof gf&&typeof N.getCenter=="function")fe=N.getCenter();else if(ee.length>0){const ce=ee.map(k=>[k.lng,k.lat]);ce.push(ce[0]);const _e=hu([ce]),se=op(_e);fe=Rt.latLng(se.geometry.coordinates[1],se.geometry.coordinates[0])}if(fe){const ce=Rt.circleMarker(fe,{radius:5,color:"#059669",fillColor:"#059669",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});r.value.addLayer(ce)}ee.forEach(ce=>{if(ce){const _e=Rt.circleMarker(ce,{radius:5,color:"#DC2626",fillColor:"#DC2626",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});r.value.addLayer(_e)}});for(let ce=0;ce<ee.length;ce++){const _e=ee[ce],se=ee[(ce+1)%ee.length];if(_e&&se){const k=Rt.latLng((_e.lat+se.lat)/2,(_e.lng+se.lng)/2),ae=Rt.circleMarker(k,{radius:5,color:"#2563EB",fillColor:"#2563EB",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});r.value.addLayer(ae)}}}console.log("[generateTempControlPoints] Points temporaires générés",{count:r.value.getLayers().length})}catch(ee){console.error("[generateTempControlPoints] Erreur lors de la génération des points temporaires:",ee)}}},$=N=>{console.log("Nombre total de couches:",N.length);const ee=N.filter(k=>{var Pe;if(!k)return!1;let ae=0,ke={width:0,height:0};if(k instanceof Rt.Circle){ae=Math.PI*Math.pow(k.getRadius(),2);const Ge=k.getRadius();console.log(`
Forme détectée: Circle`),console.log(`- Surface propre: ${ae.toFixed(2)} m²`),console.log(`- Rayon: ${Ge.toFixed(2)} m`),console.log("- Angle: Cercle complet (360°)")}else if(k instanceof pa||k instanceof Rt.Rectangle){const Ge=k.getBounds(),K=Ge.getSouthWest(),de=Ge.getNorthEast(),ye=du([[K.lng,K.lat],[de.lng,K.lat]]),me=du([[K.lng,K.lat],[K.lng,de.lat]]);ke.width=Vf(ye,{units:"meters"}),ke.height=Vf(me,{units:"meters"}),ae=ke.width*ke.height,console.log(`
Forme détectée: Rectangle`),console.log(`- Surface propre: ${ae.toFixed(2)} m²`),console.log(`- Largeur: ${ke.width.toFixed(2)} m`),console.log(`- Hauteur: ${ke.height.toFixed(2)} m`)}else if(((Pe=k.properties)==null?void 0:Pe.type)==="Semicircle"){const Ge=k.getStartAngle(),K=k.getStopAngle(),de=(K-Ge+360)%360,ye=k.getRadius();ae=Math.PI*Math.pow(ye,2)*de/360,console.log(`
Forme détectée: Semicircle`),console.log(`- Surface propre: ${ae.toFixed(2)} m²`),console.log(`- Rayon: ${ye.toFixed(2)} m`),console.log(`- Angle de début: ${Ge.toFixed(2)}°`),console.log(`- Angle de fin: ${K.toFixed(2)}°`),console.log(`- Angle d'ouverture: ${de.toFixed(2)}°`)}return ae>0});if(ee.length===0)return 0;const fe=new Set,ce=[];for(const k of ee)if(!fe.has(k)){const ae=J(ee,k);ae.length>0&&(ce.push(ae),ae.forEach(ke=>fe.add(ke)))}console.log(`
Nombre de groupes de formes connectées: ${ce.length}`);const _e=ce.map((k,ae)=>{console.log(`
Calcul pour le groupe ${ae+1} (${k.length} formes):`);const ke=k.map(ye=>{var me,Ue,Qe;try{let Ze;if(ye instanceof Rt.Circle){const He=ye.getLatLng(),Xe=ye.getRadius();Ze=XI([He.lng,He.lat],Xe/1e3,{units:"kilometers",steps:256});const tt=ic(Ze),Mt=((me=ye.properties)==null?void 0:me.surface)||0;return console.log(`
Conversion Cercle -> GeoJSON`),console.log(`- Rayon: ${Xe.toFixed(2)}m`),console.log(`- Surface propriété: ${Mt.toFixed(2)}m²`),console.log(`- Surface GeoJSON: ${tt.toFixed(2)}m²`),Ze}else if(ye instanceof pa||ye instanceof Rt.Rectangle){const He=ye.getBounds(),Xe=He.getSouthWest(),tt=He.getNorthEast(),Mt=Rt.latLng(tt.lat,Xe.lng),Lt=Rt.latLng(Xe.lat,tt.lng),jt=[[Xe.lng,Xe.lat],[Lt.lng,Lt.lat],[tt.lng,tt.lat],[Mt.lng,Mt.lat],[Xe.lng,Xe.lat]];Ze=hu([jt]);const zt=ic(Ze),sn=du([[Xe.lng,Xe.lat],[tt.lng,Xe.lat]]),pn=du([[Xe.lng,Xe.lat],[Xe.lng,tt.lat]]),et=Vf(sn,{units:"meters"}),ot=Vf(pn,{units:"meters"}),rt=et*ot;return console.log(`
Conversion Rectangle -> GeoJSON`),console.log(`- Largeur: ${et.toFixed(2)}m`),console.log(`- Hauteur: ${ot.toFixed(2)}m`),console.log(`- Surface théorique: ${rt.toFixed(2)}m²`),console.log(`- Surface GeoJSON: ${zt.toFixed(2)}m²`),console.log(`- Différence: ${Math.abs(rt-zt).toFixed(2)}m² (${(Math.abs(rt-zt)/rt*100).toFixed(2)}%)`),Ze}else if(((Ue=ye.properties)==null?void 0:Ue.type)==="Semicircle"){const He=ye.getCenter(),Xe=ye.getRadius(),tt=ye.getStartAngle(),Mt=ye.getStopAngle(),Lt=[],jt=64;Lt.push([He.lng,He.lat]);for(let pn=0;pn<=jt;pn++){const ot=(tt+(Mt-tt+360)%360*pn/jt)*Math.PI/180,rt=Xe*Math.cos(ot),Qt=Xe*Math.sin(ot)/111319.9,On=rt/(111319.9*Math.cos(He.lat*Math.PI/180));Lt.push([He.lng+On,He.lat+Qt])}Lt.push([He.lng,He.lat]),Ze=hu([Lt]);const zt=ic(Ze),sn=((Qe=ye.properties)==null?void 0:Qe.surface)||0;return console.log(`
Conversion Semicircle -> GeoJSON`),console.log(`- Rayon: ${Xe.toFixed(2)}m`),console.log(`- Surface propriété: ${sn.toFixed(2)}m²`),console.log(`- Surface GeoJSON: ${zt.toFixed(2)}m²`),console.log(`- Différence: ${Math.abs(sn-zt).toFixed(2)}m² (${(Math.abs(sn-zt)/sn*100).toFixed(2)}%)`),Ze}return null}catch(Ze){return console.error("[useMapDrawing] Erreur lors de la conversion en GeoJSON:",Ze),null}}).filter(ye=>ye!==null);if(ke.length===0)return 0;const Pe=ke.map(ye=>{const me=ic(ye);return console.log(`Surface individuelle: ${me.toFixed(2)}m²`),me});let Ge=0;for(let ye=0;ye<ke.length;ye++)for(let me=ye+1;me<ke.length;me++)try{const Ue=FI([ke[ye],ke[me]]),Qe=_7(Ue);if(Qe){const Ze=ic(Qe);Ge+=Ze,console.log(`Intersection entre formes ${ye+1} et ${me+1}: ${Ze.toFixed(2)}m²`)}}catch(Ue){console.error(`Erreur lors du calcul d'intersection entre les formes ${ye+1} et ${me+1}:`,Ue)}const K=Pe.reduce((ye,me)=>ye+me,0),de=K-Ge;return console.log(`
Calcul de la surface d'irrigation pour le groupe ${ae+1}:`),console.log(`- Surface totale (somme): ${K.toFixed(2)}m²`),console.log(`- Surface d'intersection: ${Ge.toFixed(2)}m²`),console.log(`- Surface d'irrigation finale: ${de.toFixed(2)}m²`),de}),se=Math.max(..._e);return console.log(`
Surface d'irrigation maximale parmi les groupes: ${se.toFixed(2)}m²`),se},W=()=>{u.value&&(e.value.removeLayer(u.value),u.value=null)},G=(N,ee)=>{if(!e.value)return;W();const fe=ee?J(N,ee):N;if(u.value||(u.value=Rt.layerGroup().addTo(e.value)),fe.forEach(ce=>{var se;const _e=(se=ce.properties)==null?void 0:se.type;if(_e==="Circle"||_e==="Semicircle"){const k=ce.getLatLng(),ae=ce.getRadius(),ke=Rt.circle(k,{radius:ae,fillColor:"#3B82F6",fillOpacity:.1,stroke:!0,color:"#3B82F6",weight:1,opacity:.8,dashArray:"5, 5",interactive:!1,renderer:Rt.canvas({padding:.5})}),Pe=Rt.circle(k,{radius:ae,fillColor:"#3B82F6",fillOpacity:.05,stroke:!1,interactive:!1,renderer:Rt.canvas({padding:.5})});u.value&&(u.value.addLayer(Pe),u.value.addLayer(ke))}else if(_e==="Rectangle"||_e==="Polygon"){const k=ce.getLatLngs(),ae=Rt.polygon(k,{fillColor:"#3B82F6",fillOpacity:.1,stroke:!0,color:"#3B82F6",weight:1,opacity:.8,dashArray:"5, 5",interactive:!1,renderer:Rt.canvas({padding:.5})}),ke=Rt.polygon(k,{fillColor:"#3B82F6",fillOpacity:.05,stroke:!1,interactive:!1,renderer:Rt.canvas({padding:.5})});u.value&&(u.value.addLayer(ke),u.value.addLayer(ae))}}),ee&&fe.length>1&&e.value){const ce=Rt.latLngBounds([]);fe.forEach(k=>{k.getBounds?ce.extend(k.getBounds()):k.getLatLng&&ce.extend(k.getLatLng())});const _e=ce.getCenter(),se=Rt.tooltip({permanent:!0,direction:"center",className:"connected-group-tooltip"}).setContent("<div>Groupe connecté</div>").setLatLng(_e);u.value&&u.value.addLayer(Rt.marker(_e,{opacity:0,interactive:!1}).bindTooltip(se).openTooltip())}},J=(N,ee)=>{if(!ee)return[];const fe=new Set,ce=[ee],_e=[ee];for(ee._leaflet_id!==void 0&&fe.add(ee._leaflet_id);ce.length>0;){const se=ce.shift();for(const k of N){if(k===se||fe.has(k._leaflet_id))continue;Y(se,k)&&(_e.push(k),ce.push(k),fe.add(k._leaflet_id))}}return _e},Y=(N,ee)=>{let fe=null,ce=null;if(N.getBounds&&typeof N.getBounds=="function")fe=N.getBounds();else if(N.getLatLng&&N.getRadius){const _e=N.getLatLng(),se=N.getRadius();fe=Rt.latLngBounds([_e.lat-se/111e3,_e.lng-se/(111e3*Math.cos(_e.lat*Math.PI/180))],[_e.lat+se/111e3,_e.lng+se/(111e3*Math.cos(_e.lat*Math.PI/180))])}if(ee.getBounds&&typeof ee.getBounds=="function")ce=ee.getBounds();else if(ee.getLatLng&&ee.getRadius){const _e=ee.getLatLng(),se=ee.getRadius();ce=Rt.latLngBounds([_e.lat-se/111e3,_e.lng-se/(111e3*Math.cos(_e.lat*Math.PI/180))],[_e.lat+se/111e3,_e.lng+se/(111e3*Math.cos(_e.lat*Math.PI/180))])}return!(!fe||!ce||!fe.intersects(ce))},pe=(N,ee)=>{var ce;const fe=J(N,ee);return fe.length===1&&(ce=ee.properties)!=null&&ce.surface?ee.properties.surface:$(fe)},Le=N=>{var ce,_e,se,k,ae,ke,Pe,Ge,K;const ee=N.layer;(ce=t.value)==null||ce.addLayer(ee);let fe="unknown";if(ee instanceof Rt.Circle?fe=i.value==="Semicircle"?"Semicircle":"Circle":ee instanceof Rt.Rectangle?fe="Rectangle":ee instanceof Rt.Polygon?fe="Polygon":ee instanceof Rt.Polyline&&!(ee instanceof Rt.Polygon)&&(fe="Line"),ee.properties=T(ee,fe),ee.properties||(ee.properties={}),ee.properties.category||(ee.properties.category="forages"),ee.properties.accessLevel||(ee.properties.accessLevel="visitor"),ee._dbId=Date.now()+Math.floor(Math.random()*1e3),s.value=ee,console.log("[useMapDrawing] Input layer:",{type:fe,instanceof:{Circle:ee instanceof Rt.Circle,Rectangle:ee instanceof Rt.Rectangle,Polygon:ee instanceof Rt.Polygon,Polyline:ee instanceof Rt.Polyline},options:ee.options,properties:ee.properties,_dbId:ee._dbId}),window.dispatchEvent(new CustomEvent("shape:created",{detail:{shape:ee,type:fe,properties:ee.properties}})),ee.on("mouseover",()=>{console.log("[mouseover] Survol de la forme",{type:fe,isSelected:s.value===ee}),(!s.value||s.value!==ee)&&R(ee)}),ee.on("mouseout",()=>{var de;console.log("[mouseout] Sortie de la forme",{type:fe,isSelected:s.value===ee}),(!s.value||s.value!==ee)&&((de=r.value)==null||de.clearLayers())}),fe==="Semicircle")console.log("Conversion en demi-cercle désactivée selon les exigences");else if(fe==="Circle"){(_e=t.value)==null||_e.removeLayer(ee);const de=new Rh(ee.getLatLng(),{radius:ee.getRadius(),...ee.options});de.properties={...T(de,"Circle"),type:"Circle"},Object.defineProperty(de,"name",{value:de.properties.name,writable:!0,enumerable:!0,configurable:!0}),console.log("[useMapDrawing] Création du cercle personnalisé:",{propertyDescriptor:Object.getOwnPropertyDescriptor(de,"name"),directName:de.name,propertiesName:de.properties.name,nameIsEnumerable:Object.keys(de).includes("name"),allProperties:Object.keys(de.properties),allKeys:Object.keys(de)}),(se=t.value)==null||se.addLayer(de),s.value=de,U(de)}else if(fe==="Rectangle"){(k=t.value)==null||k.removeLayer(ee);const de=new pa(ee.getBounds(),{...ee.options});de.updateProperties(),(ae=t.value)==null||ae.addLayer(de),s.value=de,Q(de)}else if(ee instanceof Rt.Polygon){const de=ee.getLatLngs()[0],ye=new gf([de],{...ee.options});ye.updateProperties(),(ke=t.value)==null||ke.removeLayer(ee),(Pe=t.value)==null||Pe.addLayer(ye),s.value=ye,B(ye)}else if(ee instanceof Ns)F(ee);else if(ee instanceof Rt.Polyline&&!(ee instanceof Rt.Polygon)){const de=ee.getLatLngs(),ye=new Ns(de,{...ee.options});ye.updateProperties(),(Ge=t.value)==null||Ge.removeLayer(ee),(K=t.value)==null||K.addLayer(ye),s.value=ye,F(ye)}yl("Cliquez sur la forme pour afficher les points de contrôle")},De=()=>{e.value&&(e.value.off("pm:create"),e.value.on("pm:create",Le))};return{map:e,featureGroup:t,controlPointsGroup:n,tempControlPointsGroup:r,currentTool:i,selectedShape:s,isDrawing:o,initMap:I,setDrawingTool:Z,updateShapeStyle:te,updateShapeProperties:ue,updateTextFixedSize:D,adjustView:j,clearActiveControlPoints:_,calculateTotalCoverageArea:$,showCoverageOverlay:G,hideCoverageOverlay:W,calculateConnectedCoverageArea:pe,getConnectedShapes:J}}function $R(){const{isEnabled:e,startMeasure:t}=pd(),n=Ft(null),r=Ft(""),i=Ft("Hybride"),s=Ft(null),o=t("createBaseMaps","useMapState"),u={Hybride:Rt.layerGroup([Rt.tileLayer("/osm_tiles/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:4,maxNativeZoom:19,tileSize:256,zoomOffset:0,bounds:Rt.latLngBounds(Rt.latLng(41.333,-5.566),Rt.latLng(51.089,9.555)),crossOrigin:!0,detectRetina:!0,opacity:.6}),Rt.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"© Esri",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:4,maxNativeZoom:20,tileSize:256,zoomOffset:0,bounds:Rt.latLngBounds(Rt.latLng(41.333,-5.566),Rt.latLng(51.089,9.555)),crossOrigin:!0,detectRetina:!0,opacity:.6})]),Cadastre:Rt.tileLayer("https://data.geopf.fr/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=CADASTRALPARCELS.PARCELLAIRE_EXPRESS&STYLE=normal&FORMAT=image/png&TILEMATRIXSET=PM&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}",{attribution:"Cadastre - Carte © IGN/Geoportail",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:4,maxNativeZoom:18,tileSize:256,zoomOffset:0,bounds:Rt.latLngBounds(Rt.latLng(41.333,-5.566),Rt.latLng(51.089,9.555)),crossOrigin:!0,detectRetina:!0}),IGN:Rt.tileLayer("https://data.geopf.fr/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2&STYLE=normal&FORMAT=image/png&TILEMATRIXSET=PM&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}",{attribution:"Carte IGN © IGN/Geoportail",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:4,maxNativeZoom:18,tileSize:256,zoomOffset:0,bounds:Rt.latLngBounds(Rt.latLng(41.333,-5.566),Rt.latLng(51.089,9.555)),crossOrigin:!0,detectRetina:!0})};o();const f=hn.createPerformanceTracker(x=>{hn.measure("initMap:setOptions",()=>{n.value=x,x.options.zoomSnap=.25,x.options.zoomDelta=.25,x.options.wheelPxPerZoomLevel=100,x.options.zoomAnimation=!0,x.options.fadeAnimation=!0,x.options.markerZoomAnimation=!0,x.options.minZoom=2,x.options.maxZoom=19,x.options.scrollWheelZoom=!0,x.options.doubleClickZoom=!0;const _=Rt.latLngBounds(Rt.latLng(-90,-180),Rt.latLng(90,180));x.setMaxBounds(_),x.options.maxBoundsViscosity=1,x.options.trackResize=!0;let M=null;x.getZoom(),x.on("zoomstart",()=>{x.getZoom(),x.options.zoomAnimation=!1,x.options.markerZoomAnimation=!1}),x.on("zoomend",()=>{M&&clearTimeout(M),M=setTimeout(()=>{setTimeout(()=>{x.options.zoomAnimation=!0,x.options.markerZoomAnimation=!0,x.invalidateSize({animate:!1,pan:!1});const D=x.getBounds(),I=x.options.maxBounds;I&&!D.intersects(I)&&x.panInsideBounds(I,{animate:!1})},250)},250)});const T=x._zoomAnimation;T&&(x._zoomAnimation=function(D){try{this._animatingZoom||T.call(this,D)}catch{console.warn("Animation de zoom interrompue, restauration de la vue..."),this._resetView(this.getCenter(),this.getZoom())}})},"useMapState"),hn.measure("initMap:addInitialLayer",()=>{x&&x.whenReady(()=>{const _=i.value;if(u[_]){if(console.log(`Initialisation de la couche de base: ${_}`),s.value&&x.hasLayer(s.value))try{x.removeLayer(s.value),console.log("Couche active précédente supprimée")}catch(M){console.warn("Erreur lors de la suppression de la couche active précédente:",M)}s.value=u[_];try{s.value.addTo(x),console.log(`Couche ${_} ajoutée à la carte`)}catch(M){console.error(`Erreur lors de l'ajout de la couche ${_}:`,M)}}else console.warn(`Couche de base non disponible: ${_}`)})},"useMapState"),x.on("baselayerchange",_=>{const M=t("baselayerchange","useMapState",{layer:_.name});i.value=_.name,s.value=_.layer,M()}),e.value&&(x.on("movestart",()=>{t("mapMove","useMapState",{startCenter:x.getCenter()})}),x.on("moveend",()=>{t("mapMoveEnd","useMapState",{endCenter:x.getCenter()})()}),x.on("tileloadstart",()=>{t("tileLoad","useMapState")}),x.on("tileload",()=>{t("tileLoadEnd","useMapState")()}))},"initMap","useMapState"),d=hn.createAsyncPerformanceTracker(async x=>{if(!n.value||!u[x]){console.warn(`Impossible de changer la carte de base: ${n.value?"type de carte non disponible":"carte non initialisée"}`);return}try{if(i.value===x)return;console.log(`Changement de carte: ${i.value} -> ${x}`);const _=n.value,M=_.getCenter(),T=_.getZoom();_.options.zoomAnimation=!1,_.options.fadeAnimation=!1,_.options.markerZoomAnimation=!1;const D=u[x];if(s.value&&_.hasLayer(s.value))try{_.removeLayer(s.value),console.log(`Couche précédente ${i.value} supprimée`)}catch(I){console.warn("Erreur lors de la suppression de la couche active:",I)}try{D instanceof Rt.LayerGroup,D.addTo(_),console.log(`Nouvelle couche ${x} ajoutée`)}catch(I){console.error("Erreur lors de l'ajout de la nouvelle couche:",I);try{_.hasLayer(D)&&_.removeLayer(D),D.addTo(_),console.log(`Récupération: couche ${x} réajoutée`)}catch(j){throw console.error("Échec de la récupération:",j),new Error("Impossible d'ajouter la nouvelle couche")}}s.value=D,i.value=x;try{_.setView(M,T,{animate:!1,duration:0,noMoveStart:!0}),console.log(`Vue réinitialisée: centre=${M}, zoom=${T}`)}catch(I){console.warn("Erreur lors de la réinitialisation de la vue:",I)}try{_.invalidateSize({animate:!1,pan:!1})}catch(I){console.warn("Erreur lors du rafraîchissement de la carte:",I)}setTimeout(()=>{_.options.zoomAnimation=!0,_.options.fadeAnimation=!0,_.options.markerZoomAnimation=!0,console.log("Animations restaurées")},500)}catch(_){if(console.error("Erreur lors du changement de carte de base:",_),n.value)try{const M=n.value;M.eachLayer(D=>{(D instanceof Rt.TileLayer||D instanceof Rt.LayerGroup)&&M.removeLayer(D)});const T=u[x];T.addTo(M),s.value=T,i.value=x,M.options.zoomAnimation=!0,M.options.fadeAnimation=!0,M.options.markerZoomAnimation=!0,M.invalidateSize({animate:!1,pan:!1}),console.log("Récupération effectuée après erreur")}catch(M){console.error("Erreur lors de la récupération après échec:",M)}}},"changeBaseMap","useMapState"),g=hn.createAsyncPerformanceTracker(async()=>{if(!(!n.value||!r.value))try{const x=await hn.measureAsync("searchLocation:fetchData",async()=>await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(r.value)}`),"useMapState"),_=await hn.measureAsync("searchLocation:parseResponse",async()=>await x.json(),"useMapState");_&&_.length>0&&hn.measure("searchLocation:updateView",()=>{const{lat:M,lon:T}=_[0];n.value.setView([M,T],13,{animate:i.value!=="Cadastre"})},"useMapState")}catch(x){console.error("Erreur lors de la recherche de localisation:",x)}},"searchLocation","useMapState");return{map:n,searchQuery:r,currentBaseMap:i,baseMaps:u,initMap:f,searchLocation:g,changeBaseMap:d,cleanup:()=>{const x=t("cleanup","useMapState");n.value&&(n.value.remove(),n.value=null),s.value&&(s.value=null),x()},isPerformanceEnabled:e}}const py=Np("irrigation",{state:()=>({plans:[],currentPlan:null,loading:!1,error:null,autoSaveInterval:null,unsavedChanges:!1,planHistory:[],performanceMonitor:pd()}),getters:{getPlanById:e=>t=>e.plans.find(n=>n.id===t),hasUnsavedChanges:e=>e.unsavedChanges,getCurrentPlanHistory:e=>e.planHistory},actions:{async fetchPlans(){var n,r;const e=this.performanceMonitor.startMeasure("fetchPlans","IrrigationStore"),t=ma();this.loading=!0;try{let i="/plans/";const s={};t.isSalarie?s.salarie=(n=t.user)==null?void 0:n.id:t.isVisiteur&&(s.visiteur=(r=t.user)==null?void 0:r.id);const o=await this.performanceMonitor.measureAsync("fetchPlans_apiCall",()=>Rn.get(i,{params:s}),"IrrigationStore");this.plans=o.data}catch(i){throw this.error="Erreur lors du chargement des plans",i}finally{this.loading=!1,e()}},async fetchPlansWithDetails(){var n,r;const e=this.performanceMonitor.startMeasure("fetchPlansWithDetails","IrrigationStore"),t=ma();this.loading=!0;try{let i="/plans/";const s={include_details:!0};t.isSalarie?s.salarie=(n=t.user)==null?void 0:n.id:t.isVisiteur&&(s.visiteur=(r=t.user)==null?void 0:r.id);const o=await this.performanceMonitor.measureAsync("fetchPlansWithDetails_apiCall",()=>Rn.get(i,{params:s}),"IrrigationStore"),u=this.performanceMonitor.measure("fetchPlansWithDetails_processResponse",()=>o.data.map(f=>({...f,entreprise:typeof f.entreprise=="object"?f.entreprise:null,salarie:typeof f.salarie=="object"?f.salarie:null,visiteur:typeof f.visiteur=="object"?f.visiteur:null})),"IrrigationStore");return this.plans=u,{data:u}}catch(i){throw console.error("[IrrigationStore] Error fetching plans:",i),this.error="Erreur lors du chargement des plans",i}finally{this.loading=!1,e()}},async fetchClientPlans(e){this.loading=!0;try{return(await Fd.getVisiteurPlans(e)).data}catch(t){throw this.error="Erreur lors du chargement des plans du client",t}finally{this.loading=!1}},async createPlan(e){var r;const t=this.performanceMonitor.startMeasure("createPlan","IrrigationStore");this.clearCurrentPlan(),this.loading=!0;const n=Uu();try{const i=ma();((r=i.user)==null?void 0:r.user_type)==="visiteur"&&(e={...e,visiteur:i.user.id,salarie_id:i.user.enterprise_id,entreprise_id:i.user.enterprise_id});const s=this.performanceMonitor.measure("createPlan_formatData",()=>({...e,entreprise:e.entreprise?typeof e.entreprise=="object"&&e.entreprise&&"id"in e.entreprise?e.entreprise.id:Number(e.entreprise):null,salarie:e.salarie?typeof e.salarie=="object"&&e.salarie&&"id"in e.salarie?e.salarie.id:Number(e.salarie):null,visiteur:e.visiteur?typeof e.visiteur=="object"&&e.visiteur&&"id"in e.visiteur?e.visiteur.id:Number(e.visiteur):null}),"IrrigationStore"),o=await this.performanceMonitor.measureAsync("createPlan_apiCall",()=>Fd.createPlan(s),"IrrigationStore");return this.plans.push(o.data),n.success(`Le plan "${o.data.nom}" a été créé avec succès`),o.data}catch(i){const s=i instanceof Error?i.message:String(i);throw console.error("Error creating plan:",s),this.error=s,n.error(`Erreur lors de la création du plan : ${s}`),i}finally{this.loading=!1,t()}},async createPlanForClient(e,t){this.clearCurrentPlan(),this.loading=!0;try{const n={...e,visiteur:t},r=await Fd.createPlanForVisiteur(n);return this.plans.push(r.data),r.data}catch(n){const r=n instanceof Error?n.message:String(n);throw console.error("Error creating plan for client:",r),this.error="Erreur lors de la création du plan pour le client",n}finally{this.loading=!1}},startAutoSave(){this.autoSaveInterval||(this.autoSaveInterval=setInterval(async()=>{this.unsavedChanges&&this.currentPlan&&await this.savePlan(this.currentPlan.id)},3e4))},stopAutoSave(){this.autoSaveInterval&&(clearInterval(this.autoSaveInterval),this.autoSaveInterval=null)},async savePlan(e){const t=this.performanceMonitor.startMeasure("savePlan","IrrigationStore");if(!this.unsavedChanges){console.log("[IrrigationStore][savePlan] Aucun changement à sauvegarder"),t();return}this.loading=!0;try{const n=await this.performanceMonitor.measureAsync("savePlan_apiCall",()=>{var r;return Rn.patch(`/plans/${e}/`,{...this.currentPlan,version:((r=this.currentPlan)==null?void 0:r.version)||1})},"IrrigationStore");return this.performanceMonitor.measure("savePlan_updateState",()=>{var i;const r=this.plans.findIndex(s=>s.id===e);r!==-1&&(this.plans[r]=n.data),((i=this.currentPlan)==null?void 0:i.id)===e&&(this.currentPlan=n.data)},"IrrigationStore"),this.unsavedChanges=!1,n.data}catch(n){throw console.error("[IrrigationStore][savePlan] ERREUR:",n),this.error="Erreur lors de la sauvegarde du plan",n}finally{this.loading=!1,t()}},async updatePlanDetails(e,t){const n=this.performanceMonitor.startMeasure("updatePlanDetails","IrrigationStore"),r=Uu();try{const i=await this.performanceMonitor.measureAsync("updatePlanDetails_apiCall",()=>{const{visiteur_id:s,salarie_id:o,entreprise_id:u,...f}=t,d={...f};return s!==void 0&&(d.visiteur_id=s),o!==void 0&&(d.salarie_id=o),u!==void 0&&(d.entreprise_id=u),Rn.patch(`/plans/${e}/`,d)},"IrrigationStore");return this.performanceMonitor.measure("updatePlanDetails_updateState",()=>{this.currentPlan&&this.currentPlan.id===e&&(this.currentPlan={...this.currentPlan,...i.data});const s=this.plans.findIndex(o=>o.id===e);s!==-1&&(this.plans[s]={...this.plans[s],...i.data})},"IrrigationStore"),i.data}catch(i){throw console.error("Erreur lors de la mise à jour du plan:",i),r.error(`Erreur lors de la mise à jour du plan : ${i instanceof Error?i.message:String(i)}`),i}finally{n()}},async fetchPlanHistory(e){this.loading=!0;try{const t=await Rn.get(`/plans/${e}/historique/`);return this.planHistory=t.data,t.data}catch(t){throw this.error="Erreur lors de la récupération de l'historique",t}finally{this.loading=!1}},async restorePlanVersion(e,t){var n;this.loading=!0;try{const r=await Rn.post(`/plans/${e}/restaurer/`,{version_id:t});((n=this.currentPlan)==null?void 0:n.id)===e&&(this.currentPlan=r.data);const i=this.plans.findIndex(s=>s.id===e);return i!==-1&&(this.plans[i]=r.data),r.data}catch(r){throw this.error="Erreur lors de la restauration de la version",r}finally{this.loading=!1}},setCurrentPlan(e){this.currentPlan=e,this.startAutoSave()},clearCurrentPlan(){this.currentPlan=null,this.unsavedChanges=!1,this.autoSaveInterval&&(clearInterval(this.autoSaveInterval),this.autoSaveInterval=null)},markUnsavedChanges(){this.unsavedChanges=!0},async deletePlan(e){var n;this.loading=!0;const t=Uu();try{const r=this.plans.find(i=>i.id===e);await Fd.deletePlan(e),this.plans=this.plans.filter(i=>i.id!==e),((n=this.currentPlan)==null?void 0:n.id)===e&&this.clearCurrentPlan(),t.success(`Le plan "${(r==null?void 0:r.nom)||""}" a été supprimé avec succès`)}catch(r){throw this.error="Erreur lors de la suppression du plan",t.error(`Erreur lors de la suppression du plan : ${r instanceof Error?r.message:String(r)}`),r}finally{this.loading=!1}}}}),UR={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[3001] overflow-y-auto"},VR={class:"bg-white w-full h-full md:rounded-lg md:max-w-4xl md:h-auto md:max-h-[90vh] md:my-8 relative overflow-y-auto"},GR={class:"p-4 md:p-6 pt-0 overflow-y-auto max-h-[calc(100vh-80px)] md:max-h-[calc(90vh-80px)]"},HR={key:0,class:"mb-4"},qR={key:0,class:"animate-pulse"},WR=["value"],ZR={key:1,class:"mb-4"},KR={key:0,class:"animate-pulse"},YR=["disabled"],JR={value:null},XR=["value"],QR={key:2,class:"mb-4"},eF={key:0,class:"animate-pulse"},tF=["disabled"],nF={value:null},rF=["value"],iF={class:"mb-4"},oF={class:"mb-6"},sF={class:"flex justify-end space-x-3"},aF=["disabled"],lF={key:0},uF={key:1},gx=cs({__name:"NewPlanModal",props:{modelValue:{type:Boolean}},emits:["update:modelValue","created","salarieSelected","visiteurSelected"],setup(e,{expose:t,emit:n}){function r(R){return R?typeof R=="object"?R.id:R:null}function i(R){if(R===null)throw new Error("Invalid ID");return R}const s=e,o=n,u=ma(),f=py(),d=ad(),g=Ft(!1),y=Ft(null),x=Ft([]),_=Ft([]),M=Ft([]),T=Ft(null),D=Ft(null),I=Ft(!1),j=Ft(!1),Z=Ft(!1),te=Ft({nom:"",description:"",entreprise:null,salarie:null,visiteur:null}),ue=cr(()=>{var R,$,W;return((R=u.user)==null?void 0:R.user_type)==="admin"?te.value.nom.trim()&&te.value.entreprise&&te.value.salarie&&te.value.visiteur:(($=u.user)==null?void 0:$.user_type)==="entreprise"?te.value.nom.trim()&&te.value.salarie&&te.value.visiteur:((W=u.user)==null?void 0:W.user_type)==="salarie"?te.value.nom.trim()&&te.value.visiteur:te.value.nom.trim()});Co(()=>te.value.entreprise,async R=>{if(!s.modelValue)return;te.value.salarie=null,te.value.visiteur=null,_.value=[];const $=r(R);console.log("[NewPlanModal] Entreprise sélectionnée:",$),$?await le($):x.value=[]}),Co(()=>te.value.salarie,async R=>{if(!s.modelValue)return;te.value.visiteur=null;const $=r(R);$?await ge($):_.value=[]}),Co(()=>s.modelValue,R=>{var $,W,G;R?(($=u.user)==null?void 0:$.user_type)==="admin"?F():((W=u.user)==null?void 0:W.user_type)==="entreprise"?le(u.user.id):((G=u.user)==null?void 0:G.user_type)==="salarie"&&ge(u.user.id):(te.value={nom:"",description:"",entreprise:null,salarie:null,visiteur:null},T.value=null,D.value=null,_.value=[],x.value=[],M.value=[],y.value=null)});async function le(R){I.value=!0;try{console.log("[NewPlanModal] Chargement des salaries pour entreprise:",R);const $=await el.getUsers({role:"SALARIE",entreprise:R});console.log("[NewPlanModal] Réponse salaries:",$.data),x.value=$.data}catch($){console.error("[NewPlanModal] Error loading salaries:",$),x.value=[]}finally{I.value=!1}}async function ge(R){j.value=!0;try{const $=await el.getUsers({role:"VISITEUR",salarie:R});_.value=$.data}catch($){console.error("[NewPlanModal] Error loading visiteurs:",$),_.value=[]}finally{j.value=!1}}async function H(R){s.modelValue&&(T.value=R,te.value.salarie=R.id,await ge(R.id),o("salarieSelected",R))}function U(R){s.modelValue&&(D.value=R,te.value.visiteur=R.id,o("visiteurSelected",R))}function Q(){o("update:modelValue",!1),te.value={nom:"",description:"",entreprise:null,salarie:null,visiteur:null},T.value=null,D.value=null,_.value=[],y.value=null}async function F(){Z.value=!0;try{const R=await u.fetchEnterprises();M.value=R}catch(R){console.error("[NewPlanModal] Error loading entreprises:",R),M.value=[]}finally{Z.value=!1}}async function B(){var R,$;y.value=null,g.value=!0;try{const W={nom:te.value.nom.trim(),description:te.value.description.trim()},G=u.user;if(!G)throw new Error("User not found");if(G.user_type==="admin"){if(!te.value.entreprise||!te.value.salarie||!te.value.visiteur)throw new Error("Missing required fields");W.entreprise=i(r(te.value.entreprise)),W.salarie=i(r(te.value.salarie)),W.visiteur=te.value.visiteur}else if(G.user_type==="entreprise"){if(!te.value.salarie||!te.value.visiteur)throw new Error("Missing required fields");W.entreprise=G.id,W.salarie=i(r(te.value.salarie)),W.visiteur=te.value.visiteur}else if(G.user_type==="salarie"){if(!G.entreprise||!te.value.visiteur)throw new Error("Missing required fields");W.entreprise=G.entreprise.id,W.salarie=G.id,W.visiteur=te.value.visiteur}else if(G.user_type==="visiteur"){if(!G.entreprise||!G.salarie)throw new Error("Missing required fields");W.entreprise=G.entreprise.id,W.salarie=G.salarie.id,W.visiteur=G.id}console.log("Données du plan à créer:",W),f.clearCurrentPlan(),d.setCurrentPlan(null);const J=await f.createPlan(W);o("created",J.id),Q()}catch(W){console.error("[NewPlanModal] Error creating plan:",W),console.error("Response data:",(R=W.response)==null?void 0:R.data);let G="Une erreur est survenue lors de la création du plan";($=W.response)!=null&&$.data&&(typeof W.response.data=="object"?G=Object.entries(W.response.data).map(([J,Y])=>Array.isArray(Y)?`${J}: ${Y.join(", ")}`:`${J}: ${Y}`).join(`
`):typeof W.response.data=="string"&&(G=W.response.data)),y.value=G}finally{g.value=!1}}return t({salaries:x,visiteurs:_,selectedSalarie:T,selectedVisiteur:D,loadSalaries:le,loadVisiteurs:ge,selectSalarie:H,selectVisiteur:U}),(R,$)=>{var W,G,J,Y;return R.modelValue?($e(),qe("div",UR,[E("div",VR,[E("div",{class:"flex justify-between items-center mb-4 sticky top-0 bg-white p-4 md:p-6 pb-4 border-b z-10"},[$[6]||($[6]=E("h2",{class:"text-xl font-semibold text-gray-900"},"Créer un nouveau plan",-1)),E("button",{onClick:Q,class:"text-gray-400 hover:text-gray-500"},$[5]||($[5]=[E("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),E("div",GR,[Wn(u).isAdmin?($e(),qe("div",HR,[$[9]||($[9]=E("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Entreprise",-1)),Z.value?($e(),qe("div",qR,$[7]||($[7]=[E("div",{class:"h-10 bg-gray-200 rounded"},null,-1)]))):Fn(($e(),qe("select",{key:1,"onUpdate:modelValue":$[0]||($[0]=pe=>te.value.entreprise=pe),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"},[$[8]||($[8]=E("option",{value:null},"Sélectionnez une entreprise",-1)),($e(!0),qe(Bn,null,Er(M.value,pe=>($e(),qe("option",{key:pe.id,value:pe.id},Wt(Wn(Vl)(pe)),9,WR))),128))],512)),[[uo,te.value.entreprise]])])):dn("",!0),((W=Wn(u).user)==null?void 0:W.user_type)==="admin"||((G=Wn(u).user)==null?void 0:G.user_type)==="entreprise"?($e(),qe("div",ZR,[$[11]||($[11]=E("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Salarie",-1)),I.value?($e(),qe("div",KR,$[10]||($[10]=[E("div",{class:"h-10 bg-gray-200 rounded"},null,-1)]))):Fn(($e(),qe("select",{key:1,id:"edit-salarie","onUpdate:modelValue":$[1]||($[1]=pe=>te.value.salarie=pe),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:Wn(u).isAdmin&&!te.value.entreprise},[E("option",JR,Wt(x.value.length?"Sélectionnez un salarie":"Aucun salarie disponible"),1),($e(!0),qe(Bn,null,Er(x.value,pe=>($e(),qe("option",{key:pe.id,value:pe.id},Wt(Wn(Vl)(pe)),9,XR))),128))],8,YR)),[[uo,te.value.salarie]])])):dn("",!0),((J=Wn(u).user)==null?void 0:J.user_type)!=="visiteur"?($e(),qe("div",QR,[$[13]||($[13]=E("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Visiteur",-1)),j.value?($e(),qe("div",eF,$[12]||($[12]=[E("div",{class:"h-10 bg-gray-200 rounded"},null,-1)]))):Fn(($e(),qe("select",{key:1,id:"edit-visiteur","onUpdate:modelValue":$[2]||($[2]=pe=>te.value.visiteur=pe),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:!_.value.length||((Y=Wn(u).user)==null?void 0:Y.user_type)!=="salarie"&&!te.value.salarie},[E("option",nF,Wt(_.value.length?"Sélectionnez un visiteur":"Aucun visiteur disponible"),1),($e(!0),qe(Bn,null,Er(_.value,pe=>($e(),qe("option",{key:pe.id,value:pe.id},Wt(Wn(Vl)(pe)),9,rF))),128))],8,tF)),[[uo,te.value.visiteur]])])):dn("",!0),E("div",iF,[$[14]||($[14]=E("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nom du plan",-1)),Fn(E("input",{id:"edit-nom","onUpdate:modelValue":$[3]||($[3]=pe=>te.value.nom=pe),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Entrez le nom du plan"},null,512),[[ri,te.value.nom]])]),E("div",oF,[$[15]||($[15]=E("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description",-1)),Fn(E("textarea",{id:"edit-description","onUpdate:modelValue":$[4]||($[4]=pe=>te.value.description=pe),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",rows:"3",placeholder:"Entrez une description (optionnel)"},null,512),[[ri,te.value.description]])]),E("div",sF,[E("button",{onClick:Q,class:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500"}," Annuler "),E("button",{onClick:B,class:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:!ue.value||g.value},[g.value?($e(),qe("span",lF,"Création en cours...")):($e(),qe("span",uF,"Créer"))],8,aF)])])])])):dn("",!0)}}});function Xi(e){"@babel/helpers - typeof";return Xi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xi(e)}var Fa=Uint8Array,Hl=Uint16Array,gy=Int32Array,i0=new Fa([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),o0=new Fa([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),m1=new Fa([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),mx=function(e,t){for(var n=new Hl(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];for(var i=new gy(n[30]),r=1;r<30;++r)for(var s=n[r];s<n[r+1];++s)i[s]=s-n[r]<<5|r;return{b:n,r:i}},vx=mx(i0,2),yx=vx.b,v1=vx.r;yx[28]=258,v1[258]=28;var _x=mx(o0,0),cF=_x.b,xb=_x.r,y1=new Hl(32768);for(var Eo=0;Eo<32768;++Eo){var rf=(Eo&43690)>>1|(Eo&21845)<<1;rf=(rf&52428)>>2|(rf&13107)<<2,rf=(rf&61680)>>4|(rf&3855)<<4,y1[Eo]=((rf&65280)>>8|(rf&255)<<8)>>1}var pc=function(e,t,n){for(var r=e.length,i=0,s=new Hl(t);i<r;++i)e[i]&&++s[e[i]-1];var o=new Hl(t);for(i=1;i<t;++i)o[i]=o[i-1]+s[i-1]<<1;var u;if(n){u=new Hl(1<<t);var f=15-t;for(i=0;i<r;++i)if(e[i])for(var d=i<<4|e[i],g=t-e[i],y=o[e[i]-1]++<<g,x=y|(1<<g)-1;y<=x;++y)u[y1[y]>>f]=d}else for(u=new Hl(r),i=0;i<r;++i)e[i]&&(u[i]=y1[o[e[i]-1]++]>>15-e[i]);return u},Ef=new Fa(288);for(var Eo=0;Eo<144;++Eo)Ef[Eo]=8;for(var Eo=144;Eo<256;++Eo)Ef[Eo]=9;for(var Eo=256;Eo<280;++Eo)Ef[Eo]=7;for(var Eo=280;Eo<288;++Eo)Ef[Eo]=8;var Ep=new Fa(32);for(var Eo=0;Eo<32;++Eo)Ep[Eo]=5;var fF=pc(Ef,9,0),hF=pc(Ef,9,1),dF=pc(Ep,5,0),pF=pc(Ep,5,1),av=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},Nu=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(t&7)&n},lv=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(t&7)},my=function(e){return(e+7)/8|0},bx=function(e,t,n){return(n==null||n>e.length)&&(n=e.length),new Fa(e.subarray(t,n))},gF=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ru=function(e,t,n){var r=new Error(t||gF[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,Ru),!n)throw r;return r},mF=function(e,t,n,r){var i=e.length,s=0;if(!i||t.f&&!t.l)return n||new Fa(0);var o=!n,u=o||t.i!=2,f=t.i;o&&(n=new Fa(i*3));var d=function(Pe){var Ge=n.length;if(Pe>Ge){var K=new Fa(Math.max(Ge*2,Pe));K.set(n),n=K}},g=t.f||0,y=t.p||0,x=t.b||0,_=t.l,M=t.d,T=t.m,D=t.n,I=i*8;do{if(!_){g=Nu(e,y,1);var j=Nu(e,y+1,3);if(y+=3,j)if(j==1)_=hF,M=pF,T=9,D=5;else if(j==2){var le=Nu(e,y,31)+257,ge=Nu(e,y+10,15)+4,H=le+Nu(e,y+5,31)+1;y+=14;for(var U=new Fa(H),Q=new Fa(19),F=0;F<ge;++F)Q[m1[F]]=Nu(e,y+F*3,7);y+=ge*3;for(var B=av(Q),R=(1<<B)-1,$=pc(Q,B,1),F=0;F<H;){var W=$[Nu(e,y,R)];y+=W&15;var Z=W>>4;if(Z<16)U[F++]=Z;else{var G=0,J=0;for(Z==16?(J=3+Nu(e,y,3),y+=2,G=U[F-1]):Z==17?(J=3+Nu(e,y,7),y+=3):Z==18&&(J=11+Nu(e,y,127),y+=7);J--;)U[F++]=G}}var Y=U.subarray(0,le),pe=U.subarray(le);T=av(Y),D=av(pe),_=pc(Y,T,1),M=pc(pe,D,1)}else Ru(1);else{var Z=my(y)+4,te=e[Z-4]|e[Z-3]<<8,ue=Z+te;if(ue>i){f&&Ru(0);break}u&&d(x+te),n.set(e.subarray(Z,ue),x),t.b=x+=te,t.p=y=ue*8,t.f=g;continue}if(y>I){f&&Ru(0);break}}u&&d(x+131072);for(var Le=(1<<T)-1,De=(1<<D)-1,N=y;;N=y){var G=_[lv(e,y)&Le],ee=G>>4;if(y+=G&15,y>I){f&&Ru(0);break}if(G||Ru(2),ee<256)n[x++]=ee;else if(ee==256){N=y,_=null;break}else{var fe=ee-254;if(ee>264){var F=ee-257,ce=i0[F];fe=Nu(e,y,(1<<ce)-1)+yx[F],y+=ce}var _e=M[lv(e,y)&De],se=_e>>4;_e||Ru(3),y+=_e&15;var pe=cF[se];if(se>3){var ce=o0[se];pe+=lv(e,y)&(1<<ce)-1,y+=ce}if(y>I){f&&Ru(0);break}u&&d(x+131072);var k=x+fe;if(x<pe){var ae=s-pe,ke=Math.min(pe,k);for(ae+x<0&&Ru(3);x<ke;++x)n[x]=r[ae+x]}for(;x<k;++x)n[x]=n[x-pe]}}t.l=_,t.p=N,t.b=x,t.f=g,_&&(g=1,t.m=T,t.d=M,t.n=D)}while(!g);return x!=n.length&&o?bx(n,0,x):n.subarray(0,x)},Oc=function(e,t,n){n<<=t&7;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8},Td=function(e,t,n){n<<=t&7;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8,e[r+2]|=n>>16},uv=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var i=n.length,s=n.slice();if(!i)return{t:xx,l:0};if(i==1){var o=new Fa(n[0].s+1);return o[n[0].s]=1,{t:o,l:1}}n.sort(function(ue,le){return ue.f-le.f}),n.push({s:-1,f:25001});var u=n[0],f=n[1],d=0,g=1,y=2;for(n[0]={s:-1,f:u.f+f.f,l:u,r:f};g!=i-1;)u=n[n[d].f<n[y].f?d++:y++],f=n[d!=g&&n[d].f<n[y].f?d++:y++],n[g++]={s:-1,f:u.f+f.f,l:u,r:f};for(var x=s[0].s,r=1;r<i;++r)s[r].s>x&&(x=s[r].s);var _=new Hl(x+1),M=_1(n[g-1],_,0);if(M>t){var r=0,T=0,D=M-t,I=1<<D;for(s.sort(function(le,ge){return _[ge.s]-_[le.s]||le.f-ge.f});r<i;++r){var j=s[r].s;if(_[j]>t)T+=I-(1<<M-_[j]),_[j]=t;else break}for(T>>=D;T>0;){var Z=s[r].s;_[Z]<t?T-=1<<t-_[Z]++-1:++r}for(;r>=0&&T;--r){var te=s[r].s;_[te]==t&&(--_[te],++T)}M=t}return{t:new Fa(_),l:M}},_1=function(e,t,n){return e.s==-1?Math.max(_1(e.l,t,n+1),_1(e.r,t,n+1)):t[e.s]=n},Lb=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new Hl(++t),r=0,i=e[0],s=1,o=function(f){n[r++]=f},u=1;u<=t;++u)if(e[u]==i&&u!=t)++s;else{if(!i&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(i),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(i);s=1,i=e[u]}return{c:n.subarray(0,r),n:t}},Nd=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},wx=function(e,t,n){var r=n.length,i=my(t+2);e[i]=r&255,e[i+1]=r>>8,e[i+2]=e[i]^255,e[i+3]=e[i+1]^255;for(var s=0;s<r;++s)e[i+s+4]=n[s];return(i+4+r)*8},Sb=function(e,t,n,r,i,s,o,u,f,d,g){Oc(t,g++,n),++i[256];for(var y=uv(i,15),x=y.t,_=y.l,M=uv(s,15),T=M.t,D=M.l,I=Lb(x),j=I.c,Z=I.n,te=Lb(T),ue=te.c,le=te.n,ge=new Hl(19),H=0;H<j.length;++H)++ge[j[H]&31];for(var H=0;H<ue.length;++H)++ge[ue[H]&31];for(var U=uv(ge,7),Q=U.t,F=U.l,B=19;B>4&&!Q[m1[B-1]];--B);var R=d+5<<3,$=Nd(i,Ef)+Nd(s,Ep)+o,W=Nd(i,x)+Nd(s,T)+o+14+3*B+Nd(ge,Q)+2*ge[16]+3*ge[17]+7*ge[18];if(f>=0&&R<=$&&R<=W)return wx(t,g,e.subarray(f,f+d));var G,J,Y,pe;if(Oc(t,g,1+(W<$)),g+=2,W<$){G=pc(x,_,0),J=x,Y=pc(T,D,0),pe=T;var Le=pc(Q,F,0);Oc(t,g,Z-257),Oc(t,g+5,le-1),Oc(t,g+10,B-4),g+=14;for(var H=0;H<B;++H)Oc(t,g+3*H,Q[m1[H]]);g+=3*B;for(var De=[j,ue],N=0;N<2;++N)for(var ee=De[N],H=0;H<ee.length;++H){var fe=ee[H]&31;Oc(t,g,Le[fe]),g+=Q[fe],fe>15&&(Oc(t,g,ee[H]>>5&127),g+=ee[H]>>12)}}else G=fF,J=Ef,Y=dF,pe=Ep;for(var H=0;H<u;++H){var ce=r[H];if(ce>255){var fe=ce>>18&31;Td(t,g,G[fe+257]),g+=J[fe+257],fe>7&&(Oc(t,g,ce>>23&31),g+=i0[fe]);var _e=ce&31;Td(t,g,Y[_e]),g+=pe[_e],_e>3&&(Td(t,g,ce>>5&8191),g+=o0[_e])}else Td(t,g,G[ce]),g+=J[ce]}return Td(t,g,G[256]),g+J[256]},vF=new gy([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),xx=new Fa(0),yF=function(e,t,n,r,i,s){var o=s.z||e.length,u=new Fa(r+o+5*(1+Math.ceil(o/7e3))+i),f=u.subarray(r,u.length-i),d=s.l,g=(s.r||0)&7;if(t){g&&(f[0]=s.r>>3);for(var y=vF[t-1],x=y>>13,_=y&8191,M=(1<<n)-1,T=s.p||new Hl(32768),D=s.h||new Hl(M+1),I=Math.ceil(n/3),j=2*I,Z=function(de){return(e[de]^e[de+1]<<I^e[de+2]<<j)&M},te=new gy(25e3),ue=new Hl(288),le=new Hl(32),ge=0,H=0,U=s.i||0,Q=0,F=s.w||0,B=0;U+2<o;++U){var R=Z(U),$=U&32767,W=D[R];if(T[$]=W,D[R]=$,F<=U){var G=o-U;if((ge>7e3||Q>24576)&&(G>423||!d)){g=Sb(e,f,0,te,ue,le,H,Q,B,U-B,g),Q=ge=H=0,B=U;for(var J=0;J<286;++J)ue[J]=0;for(var J=0;J<30;++J)le[J]=0}var Y=2,pe=0,Le=_,De=$-W&32767;if(G>2&&R==Z(U-De))for(var N=Math.min(x,G)-1,ee=Math.min(32767,U),fe=Math.min(258,G);De<=ee&&--Le&&$!=W;){if(e[U+Y]==e[U+Y-De]){for(var ce=0;ce<fe&&e[U+ce]==e[U+ce-De];++ce);if(ce>Y){if(Y=ce,pe=De,ce>N)break;for(var _e=Math.min(De,ce-2),se=0,J=0;J<_e;++J){var k=U-De+J&32767,ae=T[k],ke=k-ae&32767;ke>se&&(se=ke,W=k)}}}$=W,W=T[$],De+=$-W&32767}if(pe){te[Q++]=268435456|v1[Y]<<18|xb[pe];var Pe=v1[Y]&31,Ge=xb[pe]&31;H+=i0[Pe]+o0[Ge],++ue[257+Pe],++le[Ge],F=U+Y,++ge}else te[Q++]=e[U],++ue[e[U]]}}for(U=Math.max(U,F);U<o;++U)te[Q++]=e[U],++ue[e[U]];g=Sb(e,f,d,te,ue,le,H,Q,B,U-B,g),d||(s.r=g&7|f[g/8|0]<<3,g-=7,s.h=D,s.p=T,s.i=U,s.w=F)}else{for(var U=s.w||0;U<o+d;U+=65535){var K=U+65535;K>=o&&(f[g/8|0]=d,K=o),g=wx(f,g+1,e.subarray(U,K))}s.i=o}return bx(u,0,r+my(g)+i)},Lx=function(){var e=1,t=0;return{p:function(n){for(var r=e,i=t,s=n.length|0,o=0;o!=s;){for(var u=Math.min(o+2655,s);o<u;++o)i+=r+=n[o];r=(r&65535)+15*(r>>16),i=(i&65535)+15*(i>>16)}e=r,t=i},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},_F=function(e,t,n,r,i){if(!i&&(i={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),o=new Fa(s.length+e.length);o.set(s),o.set(e,s.length),e=o,i.w=s.length}return yF(e,t.level==null?6:t.level,t.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,n,r,i)},Sx=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},bF=function(e,t){var n=t.level,r=n==0?0:n<6?1:n==9?3:2;if(e[0]=120,e[1]=r<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var i=Lx();i.p(t.dictionary),Sx(e,2,i.d())}},wF=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&Ru(6,"invalid zlib data"),(e[1]>>5&1)==1&&Ru(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function b1(e,t){t||(t={});var n=Lx();n.p(e);var r=_F(e,t,t.dictionary?6:2,4);return bF(r,t),Sx(r,r.length-4,n.d()),r}function xF(e,t){return mF(e.subarray(wF(e),-4),{i:2},t,t)}var LF=typeof TextDecoder<"u"&&new TextDecoder,SF=0;try{LF.decode(xx,{stream:!0}),SF=1}catch{}var Ir=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function cv(){Ir.console&&typeof Ir.console.log=="function"&&Ir.console.log.apply(Ir.console,arguments)}var lo={log:cv,warn:function(e){Ir.console&&(typeof Ir.console.warn=="function"?Ir.console.warn.apply(Ir.console,arguments):cv.call(null,arguments))},error:function(e){Ir.console&&(typeof Ir.console.error=="function"?Ir.console.error.apply(Ir.console,arguments):cv(e))}};function fv(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){qf(r.response,t,n)},r.onerror=function(){lo.error("could not download file")},r.send()}function Cb(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function bg(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var sp,w1,qf=Ir.saveAs||((typeof window>"u"?"undefined":Xi(window))!=="object"||window!==Ir?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,n){var r=Ir.URL||Ir.webkitURL,i=document.createElement("a");t=t||e.name||"download",i.download=t,i.rel="noopener",typeof e=="string"?(i.href=e,i.origin!==location.origin?Cb(i.href)?fv(e,t,n):bg(i,i.target="_blank"):bg(i)):(i.href=r.createObjectURL(e),setTimeout(function(){r.revokeObjectURL(i.href)},4e4),setTimeout(function(){bg(i)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,n){if(t=t||e.name||"download",typeof e=="string")if(Cb(e))fv(e,t,n);else{var r=document.createElement("a");r.href=e,r.target="_blank",setTimeout(function(){bg(r)})}else navigator.msSaveOrOpenBlob(function(i,s){return s===void 0?s={autoBom:!1}:Xi(s)!=="object"&&(lo.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(e,n),t)}:function(e,t,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof e=="string")return fv(e,t,n);var i=e.type==="application/octet-stream",s=/constructor/i.test(Ir.HTMLElement)||Ir.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||i&&s)&&(typeof FileReader>"u"?"undefined":Xi(FileReader))==="object"){var u=new FileReader;u.onloadend=function(){var g=u.result;g=o?g:g.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=g:location=g,r=null},u.readAsDataURL(e)}else{var f=Ir.URL||Ir.webkitURL,d=f.createObjectURL(e);r?r.location=d:location.href=d,r=null,setTimeout(function(){f.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Cx(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(u){return[parseInt(u[1]),parseInt(u[2]),parseInt(u[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(u){return[parseInt(u[1],16),parseInt(u[2],16),parseInt(u[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(u){return[parseInt(u[1]+u[1],16),parseInt(u[2]+u[2],16),parseInt(u[3]+u[3],16)]}}],r=0;r<n.length;r++){var i=n[r].re,s=n[r].process,o=i.exec(e);o&&(t=s(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var u=this.r.toString(16),f=this.g.toString(16),d=this.b.toString(16);return u.length==1&&(u="0"+u),f.length==1&&(f="0"+f),d.length==1&&(d="0"+d),"#"+u+f+d}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function hv(e,t){var n=e[0],r=e[1],i=e[2],s=e[3];n=ka(n,r,i,s,t[0],7,-680876936),s=ka(s,n,r,i,t[1],12,-389564586),i=ka(i,s,n,r,t[2],17,606105819),r=ka(r,i,s,n,t[3],22,-1044525330),n=ka(n,r,i,s,t[4],7,-176418897),s=ka(s,n,r,i,t[5],12,1200080426),i=ka(i,s,n,r,t[6],17,-1473231341),r=ka(r,i,s,n,t[7],22,-45705983),n=ka(n,r,i,s,t[8],7,1770035416),s=ka(s,n,r,i,t[9],12,-1958414417),i=ka(i,s,n,r,t[10],17,-42063),r=ka(r,i,s,n,t[11],22,-1990404162),n=ka(n,r,i,s,t[12],7,1804603682),s=ka(s,n,r,i,t[13],12,-40341101),i=ka(i,s,n,r,t[14],17,-1502002290),n=Ta(n,r=ka(r,i,s,n,t[15],22,1236535329),i,s,t[1],5,-165796510),s=Ta(s,n,r,i,t[6],9,-1069501632),i=Ta(i,s,n,r,t[11],14,643717713),r=Ta(r,i,s,n,t[0],20,-373897302),n=Ta(n,r,i,s,t[5],5,-701558691),s=Ta(s,n,r,i,t[10],9,38016083),i=Ta(i,s,n,r,t[15],14,-660478335),r=Ta(r,i,s,n,t[4],20,-405537848),n=Ta(n,r,i,s,t[9],5,568446438),s=Ta(s,n,r,i,t[14],9,-1019803690),i=Ta(i,s,n,r,t[3],14,-187363961),r=Ta(r,i,s,n,t[8],20,1163531501),n=Ta(n,r,i,s,t[13],5,-1444681467),s=Ta(s,n,r,i,t[2],9,-51403784),i=Ta(i,s,n,r,t[7],14,1735328473),n=Na(n,r=Ta(r,i,s,n,t[12],20,-1926607734),i,s,t[5],4,-378558),s=Na(s,n,r,i,t[8],11,-2022574463),i=Na(i,s,n,r,t[11],16,1839030562),r=Na(r,i,s,n,t[14],23,-35309556),n=Na(n,r,i,s,t[1],4,-1530992060),s=Na(s,n,r,i,t[4],11,1272893353),i=Na(i,s,n,r,t[7],16,-155497632),r=Na(r,i,s,n,t[10],23,-1094730640),n=Na(n,r,i,s,t[13],4,681279174),s=Na(s,n,r,i,t[0],11,-358537222),i=Na(i,s,n,r,t[3],16,-722521979),r=Na(r,i,s,n,t[6],23,76029189),n=Na(n,r,i,s,t[9],4,-640364487),s=Na(s,n,r,i,t[12],11,-421815835),i=Na(i,s,n,r,t[15],16,530742520),n=Da(n,r=Na(r,i,s,n,t[2],23,-995338651),i,s,t[0],6,-198630844),s=Da(s,n,r,i,t[7],10,1126891415),i=Da(i,s,n,r,t[14],15,-1416354905),r=Da(r,i,s,n,t[5],21,-57434055),n=Da(n,r,i,s,t[12],6,1700485571),s=Da(s,n,r,i,t[3],10,-1894986606),i=Da(i,s,n,r,t[10],15,-1051523),r=Da(r,i,s,n,t[1],21,-2054922799),n=Da(n,r,i,s,t[8],6,1873313359),s=Da(s,n,r,i,t[15],10,-30611744),i=Da(i,s,n,r,t[6],15,-1560198380),r=Da(r,i,s,n,t[13],21,1309151649),n=Da(n,r,i,s,t[4],6,-145523070),s=Da(s,n,r,i,t[11],10,-1120210379),i=Da(i,s,n,r,t[2],15,718787259),r=Da(r,i,s,n,t[9],21,-343485551),e[0]=mf(n,e[0]),e[1]=mf(r,e[1]),e[2]=mf(i,e[2]),e[3]=mf(s,e[3])}function s0(e,t,n,r,i,s){return t=mf(mf(t,e),mf(r,s)),mf(t<<i|t>>>32-i,n)}function ka(e,t,n,r,i,s,o){return s0(t&n|~t&r,e,t,i,s,o)}function Ta(e,t,n,r,i,s,o){return s0(t&r|n&~r,e,t,i,s,o)}function Na(e,t,n,r,i,s,o){return s0(t^n^r,e,t,i,s,o)}function Da(e,t,n,r,i,s,o){return s0(n^(t|~r),e,t,i,s,o)}function Ex(e){var t,n=e.length,r=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)hv(r,CF(e.substring(t-64,t)));e=e.substring(t-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)i[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(hv(r,i),t=0;t<16;t++)i[t]=0;return i[14]=8*n,hv(r,i),r}function CF(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}sp=Ir.atob.bind(Ir),w1=Ir.btoa.bind(Ir);var Eb="0123456789abcdef".split("");function EF(e){for(var t="",n=0;n<4;n++)t+=Eb[e>>8*n+4&15]+Eb[e>>8*n&15];return t}function PF(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function x1(e){return Ex(e).map(PF).join("")}var MF=function(e){for(var t=0;t<e.length;t++)e[t]=EF(e[t]);return e.join("")}(Ex("hello"))!="5d41402abc4b2a76b9719d911017c592";function mf(e,t){if(MF){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function L1(e,t){var n,r,i,s;if(e!==n){for(var o=(i=e,s=1+(256/e.length>>0),new Array(s+1).join(i)),u=[],f=0;f<256;f++)u[f]=f;var d=0;for(f=0;f<256;f++){var g=u[f];d=(d+g+o.charCodeAt(f))%256,u[f]=u[d],u[d]=g}n=e,r=u}else u=r;var y=t.length,x=0,_=0,M="";for(f=0;f<y;f++)_=(_+(g=u[x=(x+1)%256]))%256,u[x]=u[_],u[_]=g,o=u[(u[x]+u[_])%256],M+=String.fromCharCode(t.charCodeAt(f)^o);return M}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Pb={print:4,modify:8,copy:16,"annot-forms":32};function Fh(e,t,n,r){this.v=1,this.r=2;var i=192;e.forEach(function(u){if(Pb.perm!==void 0)throw new Error("Invalid permission: "+u);i+=Pb[u]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var s=(t+this.padding).substr(0,32),o=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^i)),this.encryptionKey=x1(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=L1(this.encryptionKey,this.padding)}function jh(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",n=e.length,r=0;r<n;r++){var i=e.charCodeAt(r);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?t+="#"+("0"+i.toString(16)).slice(-2):t+=e[r]}return t}function Mb(e){if(Xi(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(n,r,i){if(i=i||!1,typeof n!="string"||typeof r!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(n)||(t[n]={});var s=Math.random().toString(35);return t[n][s]=[r,!!i],s},this.unsubscribe=function(n){for(var r in t)if(t[r][n])return delete t[r][n],Object.keys(t[r]).length===0&&delete t[r],!0;return!1},this.publish=function(n){if(t.hasOwnProperty(n)){var r=Array.prototype.slice.call(arguments,1),i=[];for(var s in t[n]){var o=t[n][s];try{o[0].apply(e,r)}catch(u){Ir.console&&lo.error("jsPDF PubSub Error",u.message,u)}o[1]&&i.push(s)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function wm(e){if(!(this instanceof wm))return new wm(e);var t="opacity,stroke-opacity".split(",");for(var n in e)e.hasOwnProperty(n)&&t.indexOf(n)>=0&&(this[n]=e[n]);this.id="",this.objectNumber=-1}function Px(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Zf(e,t,n,r,i){if(!(this instanceof Zf))return new Zf(e,t,n,r,i);this.type=e==="axial"?2:3,this.coords=t,this.colors=n,Px.call(this,r,i)}function Uh(e,t,n,r,i){if(!(this instanceof Uh))return new Uh(e,t,n,r,i);this.boundingBox=e,this.xStep=t,this.yStep=n,this.stream="",this.cloneIndex=0,Px.call(this,r,i)}function kr(e){var t,n=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],i=arguments[2],s=arguments[3],o=[],u=1,f=16,d="S",g=null;Xi(e=e||{})==="object"&&(n=e.orientation,r=e.unit||r,i=e.format||i,s=e.compress||e.compressPdf||s,(g=e.encryption||null)!==null&&(g.userPassword=g.userPassword||"",g.ownerPassword=g.ownerPassword||"",g.userPermissions=g.userPermissions||[]),u=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(f=e.floatPrecision),d=e.defaultPathOperation||"S"),o=e.filters||(s===!0?["FlateEncode"]:o),r=r||"mm",n=(""+(n||"P")).toLowerCase();var y=e.putOnlyUsedFonts||!1,x={},_={internal:{},__private__:{}};_.__private__.PubSub=Mb;var M="1.3",T=_.__private__.getPdfVersion=function(){return M};_.__private__.setPdfVersion=function(O){M=O};var D={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};_.__private__.getPageFormats=function(){return D};var I=_.__private__.getPageFormat=function(O){return D[O]};i=i||"a4";var j={COMPAT:"compat",ADVANCED:"advanced"},Z=j.COMPAT;function te(){this.saveGraphicsState(),me(new mn(rt,0,0,-rt,0,ba()*rt).toString()+" cm"),this.setFontSize(this.getFontSize()/rt),d="n",Z=j.ADVANCED}function ue(){this.restoreGraphicsState(),d="S",Z=j.COMPAT}var le=_.__private__.combineFontStyleAndFontWeight=function(O,be){if(O=="bold"&&be=="normal"||O=="bold"&&be==400||O=="normal"&&be=="italic"||O=="bold"&&be=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return be&&(O=be==400||be==="normal"?O==="italic"?"italic":"normal":be!=700&&be!=="bold"||O!=="normal"?(be==700?"bold":be)+""+O:"bold"),O};_.advancedAPI=function(O){var be=Z===j.COMPAT;return be&&te.call(this),typeof O!="function"||(O(this),be&&ue.call(this)),this},_.compatAPI=function(O){var be=Z===j.ADVANCED;return be&&ue.call(this),typeof O!="function"||(O(this),be&&te.call(this)),this},_.isAdvancedAPI=function(){return Z===j.ADVANCED};var ge,H=function(O){if(Z!==j.ADVANCED)throw new Error(O+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},U=_.roundToPrecision=_.__private__.roundToPrecision=function(O,be){var Ke=t||be;if(isNaN(O)||isNaN(Ke))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return O.toFixed(Ke).replace(/0+$/,"")};ge=_.hpf=_.__private__.hpf=typeof f=="number"?function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.hpf");return U(O,f)}:f==="smart"?function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.hpf");return U(O,O>-1&&O<1?16:5)}:function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.hpf");return U(O,16)};var Q=_.f2=_.__private__.f2=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.f2");return U(O,2)},F=_.__private__.f3=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.f3");return U(O,3)},B=_.scale=_.__private__.scale=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.scale");return Z===j.COMPAT?O*rt:Z===j.ADVANCED?O:void 0},R=function(O){return Z===j.COMPAT?ba()-O:Z===j.ADVANCED?O:void 0},$=function(O){return B(R(O))};_.__private__.setPrecision=_.setPrecision=function(O){typeof parseInt(O,10)=="number"&&(t=parseInt(O,10))};var W,G="00000000000000000000000000000000",J=_.__private__.getFileId=function(){return G},Y=_.__private__.setFileId=function(O){return G=O!==void 0&&/^[a-fA-F0-9]{32}$/.test(O)?O.toUpperCase():G.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),g!==null&&(to=new Fh(g.userPermissions,g.userPassword,g.ownerPassword,G)),G};_.setFileId=function(O){return Y(O),this},_.getFileId=function(){return J()};var pe=_.__private__.convertDateToPDFDate=function(O){var be=O.getTimezoneOffset(),Ke=be<0?"+":"-",ft=Math.floor(Math.abs(be/60)),xt=Math.abs(be%60),$t=[Ke,fe(ft),"'",fe(xt),"'"].join("");return["D:",O.getFullYear(),fe(O.getMonth()+1),fe(O.getDate()),fe(O.getHours()),fe(O.getMinutes()),fe(O.getSeconds()),$t].join("")},Le=_.__private__.convertPDFDateToDate=function(O){var be=parseInt(O.substr(2,4),10),Ke=parseInt(O.substr(6,2),10)-1,ft=parseInt(O.substr(8,2),10),xt=parseInt(O.substr(10,2),10),$t=parseInt(O.substr(12,2),10),cn=parseInt(O.substr(14,2),10);return new Date(be,Ke,ft,xt,$t,cn,0)},De=_.__private__.setCreationDate=function(O){var be;if(O===void 0&&(O=new Date),O instanceof Date)be=pe(O);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(O))throw new Error("Invalid argument passed to jsPDF.setCreationDate");be=O}return W=be},N=_.__private__.getCreationDate=function(O){var be=W;return O==="jsDate"&&(be=Le(W)),be};_.setCreationDate=function(O){return De(O),this},_.getCreationDate=function(O){return N(O)};var ee,fe=_.__private__.padd2=function(O){return("0"+parseInt(O)).slice(-2)},ce=_.__private__.padd2Hex=function(O){return("00"+(O=O.toString())).substr(O.length)},_e=0,se=[],k=[],ae=0,ke=[],Pe=[],Ge=!1,K=k,de=function(){_e=0,ae=0,k=[],se=[],ke=[],Ii=lt(),Fr=lt()};_.__private__.setCustomOutputDestination=function(O){Ge=!0,K=O};var ye=function(O){Ge||(K=O)};_.__private__.resetCustomOutputDestination=function(){Ge=!1,K=k};var me=_.__private__.out=function(O){return O=O.toString(),ae+=O.length+1,K.push(O),K},Ue=_.__private__.write=function(O){return me(arguments.length===1?O.toString():Array.prototype.join.call(arguments," "))},Qe=_.__private__.getArrayBuffer=function(O){for(var be=O.length,Ke=new ArrayBuffer(be),ft=new Uint8Array(Ke);be--;)ft[be]=O.charCodeAt(be);return Ke},Ze=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];_.__private__.getStandardFonts=function(){return Ze};var He=e.fontSize||16;_.__private__.setFontSize=_.setFontSize=function(O){return He=Z===j.ADVANCED?O/rt:O,this};var Xe,tt=_.__private__.getFontSize=_.getFontSize=function(){return Z===j.COMPAT?He:He*rt},Mt=e.R2L||!1;_.__private__.setR2L=_.setR2L=function(O){return Mt=O,this},_.__private__.getR2L=_.getR2L=function(){return Mt};var Lt,jt=_.__private__.setZoomMode=function(O){var be=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(O))Xe=O;else if(isNaN(O)){if(be.indexOf(O)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+O+'" is not recognized.');Xe=O}else Xe=parseInt(O,10)};_.__private__.getZoomMode=function(){return Xe};var zt,sn=_.__private__.setPageMode=function(O){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(O)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+O+'" is not recognized.');Lt=O};_.__private__.getPageMode=function(){return Lt};var pn=_.__private__.setLayoutMode=function(O){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(O)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+O+'" is not recognized.');zt=O};_.__private__.getLayoutMode=function(){return zt},_.__private__.setDisplayMode=_.setDisplayMode=function(O,be,Ke){return jt(O),pn(be),sn(Ke),this};var et={title:"",subject:"",author:"",keywords:"",creator:""};_.__private__.getDocumentProperty=function(O){if(Object.keys(et).indexOf(O)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return et[O]},_.__private__.getDocumentProperties=function(){return et},_.__private__.setDocumentProperties=_.setProperties=_.setDocumentProperties=function(O){for(var be in et)et.hasOwnProperty(be)&&O[be]&&(et[be]=O[be]);return this},_.__private__.setDocumentProperty=function(O,be){if(Object.keys(et).indexOf(O)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return et[O]=be};var ot,rt,Ht,Qt,On,wn={},Tn={},ar=[],xn={},Mn={},Pn={},fr={},yr=null,at=0,We=[],It=new Mb(_),En=e.hotfixes||[],Jn={},Zn={},qt=[],mn=function O(be,Ke,ft,xt,$t,cn){if(!(this instanceof O))return new O(be,Ke,ft,xt,$t,cn);isNaN(be)&&(be=1),isNaN(Ke)&&(Ke=0),isNaN(ft)&&(ft=0),isNaN(xt)&&(xt=1),isNaN($t)&&($t=0),isNaN(cn)&&(cn=0),this._matrix=[be,Ke,ft,xt,$t,cn]};Object.defineProperty(mn.prototype,"sx",{get:function(){return this._matrix[0]},set:function(O){this._matrix[0]=O}}),Object.defineProperty(mn.prototype,"shy",{get:function(){return this._matrix[1]},set:function(O){this._matrix[1]=O}}),Object.defineProperty(mn.prototype,"shx",{get:function(){return this._matrix[2]},set:function(O){this._matrix[2]=O}}),Object.defineProperty(mn.prototype,"sy",{get:function(){return this._matrix[3]},set:function(O){this._matrix[3]=O}}),Object.defineProperty(mn.prototype,"tx",{get:function(){return this._matrix[4]},set:function(O){this._matrix[4]=O}}),Object.defineProperty(mn.prototype,"ty",{get:function(){return this._matrix[5]},set:function(O){this._matrix[5]=O}}),Object.defineProperty(mn.prototype,"a",{get:function(){return this._matrix[0]},set:function(O){this._matrix[0]=O}}),Object.defineProperty(mn.prototype,"b",{get:function(){return this._matrix[1]},set:function(O){this._matrix[1]=O}}),Object.defineProperty(mn.prototype,"c",{get:function(){return this._matrix[2]},set:function(O){this._matrix[2]=O}}),Object.defineProperty(mn.prototype,"d",{get:function(){return this._matrix[3]},set:function(O){this._matrix[3]=O}}),Object.defineProperty(mn.prototype,"e",{get:function(){return this._matrix[4]},set:function(O){this._matrix[4]=O}}),Object.defineProperty(mn.prototype,"f",{get:function(){return this._matrix[5]},set:function(O){this._matrix[5]=O}}),Object.defineProperty(mn.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(mn.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(mn.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(mn.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),mn.prototype.join=function(O){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(ge).join(O)},mn.prototype.multiply=function(O){var be=O.sx*this.sx+O.shy*this.shx,Ke=O.sx*this.shy+O.shy*this.sy,ft=O.shx*this.sx+O.sy*this.shx,xt=O.shx*this.shy+O.sy*this.sy,$t=O.tx*this.sx+O.ty*this.shx+this.tx,cn=O.tx*this.shy+O.ty*this.sy+this.ty;return new mn(be,Ke,ft,xt,$t,cn)},mn.prototype.decompose=function(){var O=this.sx,be=this.shy,Ke=this.shx,ft=this.sy,xt=this.tx,$t=this.ty,cn=Math.sqrt(O*O+be*be),Nn=(O/=cn)*Ke+(be/=cn)*ft;Ke-=O*Nn,ft-=be*Nn;var zn=Math.sqrt(Ke*Ke+ft*ft);return Nn/=zn,O*(ft/=zn)<be*(Ke/=zn)&&(O=-O,be=-be,Nn=-Nn,cn=-cn),{scale:new mn(cn,0,0,zn,0,0),translate:new mn(1,0,0,1,xt,$t),rotate:new mn(O,be,-be,O,0,0),skew:new mn(1,0,Nn,1,0,0)}},mn.prototype.toString=function(O){return this.join(" ")},mn.prototype.inversed=function(){var O=this.sx,be=this.shy,Ke=this.shx,ft=this.sy,xt=this.tx,$t=this.ty,cn=1/(O*ft-be*Ke),Nn=ft*cn,zn=-be*cn,nr=-Ke*cn,vr=O*cn;return new mn(Nn,zn,nr,vr,-Nn*xt-nr*$t,-zn*xt-vr*$t)},mn.prototype.applyToPoint=function(O){var be=O.x*this.sx+O.y*this.shx+this.tx,Ke=O.x*this.shy+O.y*this.sy+this.ty;return new Mo(be,Ke)},mn.prototype.applyToRectangle=function(O){var be=this.applyToPoint(O),Ke=this.applyToPoint(new Mo(O.x+O.w,O.y+O.h));return new Hs(be.x,be.y,Ke.x-be.x,Ke.y-be.y)},mn.prototype.clone=function(){var O=this.sx,be=this.shy,Ke=this.shx,ft=this.sy,xt=this.tx,$t=this.ty;return new mn(O,be,Ke,ft,xt,$t)},_.Matrix=mn;var Bt=_.matrixMult=function(O,be){return be.multiply(O)},Kt=new mn(1,0,0,1,0,0);_.unitMatrix=_.identityMatrix=Kt;var Ln=function(O,be){if(!Mn[O]){var Ke=(be instanceof Zf?"Sh":"P")+(Object.keys(xn).length+1).toString(10);be.id=Ke,Mn[O]=Ke,xn[Ke]=be,It.publish("addPattern",be)}};_.ShadingPattern=Zf,_.TilingPattern=Uh,_.addShadingPattern=function(O,be){return H("addShadingPattern()"),Ln(O,be),this},_.beginTilingPattern=function(O){H("beginTilingPattern()"),qs(O.boundingBox[0],O.boundingBox[1],O.boundingBox[2]-O.boundingBox[0],O.boundingBox[3]-O.boundingBox[1],O.matrix)},_.endTilingPattern=function(O,be){H("endTilingPattern()"),be.stream=Pe[ee].join(`
`),Ln(O,be),It.publish("endTilingPattern",be),qt.pop().restore()};var mr=_.__private__.newObject=function(){var O=lt();return Cn(O,!0),O},lt=_.__private__.newObjectDeferred=function(){return _e++,se[_e]=function(){return ae},_e},Cn=function(O,be){return be=typeof be=="boolean"&&be,se[O]=ae,be&&me(O+" 0 obj"),O},xr=_.__private__.newAdditionalObject=function(){var O={objId:lt(),content:""};return ke.push(O),O},Ii=lt(),Fr=lt(),Pr=_.__private__.decodeColorString=function(O){var be=O.split(" ");if(be.length!==2||be[1]!=="g"&&be[1]!=="G")be.length===5&&(be[4]==="k"||be[4]==="K")&&(be=[(1-be[0])*(1-be[3]),(1-be[1])*(1-be[3]),(1-be[2])*(1-be[3]),"r"]);else{var Ke=parseFloat(be[0]);be=[Ke,Ke,Ke,"r"]}for(var ft="#",xt=0;xt<3;xt++)ft+=("0"+Math.floor(255*parseFloat(be[xt])).toString(16)).slice(-2);return ft},lr=_.__private__.encodeColorString=function(O){var be;typeof O=="string"&&(O={ch1:O});var Ke=O.ch1,ft=O.ch2,xt=O.ch3,$t=O.ch4,cn=O.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Ke=="string"&&Ke.charAt(0)!=="#"){var Nn=new Cx(Ke);if(Nn.ok)Ke=Nn.toHex();else if(!/^\d*\.?\d*$/.test(Ke))throw new Error('Invalid color "'+Ke+'" passed to jsPDF.encodeColorString.')}if(typeof Ke=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Ke)&&(Ke="#"+Ke[1]+Ke[1]+Ke[2]+Ke[2]+Ke[3]+Ke[3]),typeof Ke=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Ke)){var zn=parseInt(Ke.substr(1),16);Ke=zn>>16&255,ft=zn>>8&255,xt=255&zn}if(ft===void 0||$t===void 0&&Ke===ft&&ft===xt)if(typeof Ke=="string")be=Ke+" "+cn[0];else switch(O.precision){case 2:be=Q(Ke/255)+" "+cn[0];break;case 3:default:be=F(Ke/255)+" "+cn[0]}else if($t===void 0||Xi($t)==="object"){if($t&&!isNaN($t.a)&&$t.a===0)return be=["1.","1.","1.",cn[1]].join(" ");if(typeof Ke=="string")be=[Ke,ft,xt,cn[1]].join(" ");else switch(O.precision){case 2:be=[Q(Ke/255),Q(ft/255),Q(xt/255),cn[1]].join(" ");break;default:case 3:be=[F(Ke/255),F(ft/255),F(xt/255),cn[1]].join(" ")}}else if(typeof Ke=="string")be=[Ke,ft,xt,$t,cn[2]].join(" ");else switch(O.precision){case 2:be=[Q(Ke),Q(ft),Q(xt),Q($t),cn[2]].join(" ");break;case 3:default:be=[F(Ke),F(ft),F(xt),F($t),cn[2]].join(" ")}return be},Hr=_.__private__.getFilters=function(){return o},ir=_.__private__.putStream=function(O){var be=(O=O||{}).data||"",Ke=O.filters||Hr(),ft=O.alreadyAppliedFilters||[],xt=O.addLength1||!1,$t=be.length,cn=O.objectId,Nn=function(oo){return oo};if(g!==null&&cn===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");g!==null&&(Nn=to.encryptor(cn,0));var zn={};Ke===!0&&(Ke=["FlateEncode"]);var nr=O.additionalKeyValues||[],vr=(zn=kr.API.processDataByFilters!==void 0?kr.API.processDataByFilters(be,Ke):{data:be,reverseChain:[]}).reverseChain+(Array.isArray(ft)?ft.join(" "):ft.toString());if(zn.data.length!==0&&(nr.push({key:"Length",value:zn.data.length}),xt===!0&&nr.push({key:"Length1",value:$t})),vr.length!=0)if(vr.split("/").length-1==1)nr.push({key:"Filter",value:vr});else{nr.push({key:"Filter",value:"["+vr+"]"});for(var Ur=0;Ur<nr.length;Ur+=1)if(nr[Ur].key==="DecodeParms"){for(var $i=[],pi=0;pi<zn.reverseChain.split("/").length-1;pi+=1)$i.push("null");$i.push(nr[Ur].value),nr[Ur].value="["+$i.join(" ")+"]"}}me("<<");for(var xi=0;xi<nr.length;xi++)me("/"+nr[xi].key+" "+nr[xi].value);me(">>"),zn.data.length!==0&&(me("stream"),me(Nn(zn.data)),me("endstream"))},Or=_.__private__.putPage=function(O){var be=O.number,Ke=O.data,ft=O.objId,xt=O.contentsObjId;Cn(ft,!0),me("<</Type /Page"),me("/Parent "+O.rootDictionaryObjId+" 0 R"),me("/Resources "+O.resourceDictionaryObjId+" 0 R"),me("/MediaBox ["+parseFloat(ge(O.mediaBox.bottomLeftX))+" "+parseFloat(ge(O.mediaBox.bottomLeftY))+" "+ge(O.mediaBox.topRightX)+" "+ge(O.mediaBox.topRightY)+"]"),O.cropBox!==null&&me("/CropBox ["+ge(O.cropBox.bottomLeftX)+" "+ge(O.cropBox.bottomLeftY)+" "+ge(O.cropBox.topRightX)+" "+ge(O.cropBox.topRightY)+"]"),O.bleedBox!==null&&me("/BleedBox ["+ge(O.bleedBox.bottomLeftX)+" "+ge(O.bleedBox.bottomLeftY)+" "+ge(O.bleedBox.topRightX)+" "+ge(O.bleedBox.topRightY)+"]"),O.trimBox!==null&&me("/TrimBox ["+ge(O.trimBox.bottomLeftX)+" "+ge(O.trimBox.bottomLeftY)+" "+ge(O.trimBox.topRightX)+" "+ge(O.trimBox.topRightY)+"]"),O.artBox!==null&&me("/ArtBox ["+ge(O.artBox.bottomLeftX)+" "+ge(O.artBox.bottomLeftY)+" "+ge(O.artBox.topRightX)+" "+ge(O.artBox.topRightY)+"]"),typeof O.userUnit=="number"&&O.userUnit!==1&&me("/UserUnit "+O.userUnit),It.publish("putPage",{objId:ft,pageContext:We[be],pageNumber:be,page:Ke}),me("/Contents "+xt+" 0 R"),me(">>"),me("endobj");var $t=Ke.join(`
`);return Z===j.ADVANCED&&($t+=`
Q`),Cn(xt,!0),ir({data:$t,filters:Hr(),objectId:xt}),me("endobj"),ft},jr=_.__private__.putPages=function(){var O,be,Ke=[];for(O=1;O<=at;O++)We[O].objId=lt(),We[O].contentsObjId=lt();for(O=1;O<=at;O++)Ke.push(Or({number:O,data:Pe[O],objId:We[O].objId,contentsObjId:We[O].contentsObjId,mediaBox:We[O].mediaBox,cropBox:We[O].cropBox,bleedBox:We[O].bleedBox,trimBox:We[O].trimBox,artBox:We[O].artBox,userUnit:We[O].userUnit,rootDictionaryObjId:Ii,resourceDictionaryObjId:Fr}));Cn(Ii,!0),me("<</Type /Pages");var ft="/Kids [";for(be=0;be<at;be++)ft+=Ke[be]+" 0 R ";me(ft+"]"),me("/Count "+at),me(">>"),me("endobj"),It.publish("postPutPages")},rn=function(O){It.publish("putFont",{font:O,out:me,newObject:mr,putStream:ir}),O.isAlreadyPutted!==!0&&(O.objectNumber=mr(),me("<<"),me("/Type /Font"),me("/BaseFont /"+jh(O.postScriptName)),me("/Subtype /Type1"),typeof O.encoding=="string"&&me("/Encoding /"+O.encoding),me("/FirstChar 32"),me("/LastChar 255"),me(">>"),me("endobj"))},ji=function(){for(var O in wn)wn.hasOwnProperty(O)&&(y===!1||y===!0&&x.hasOwnProperty(O))&&rn(wn[O])},_i=function(O){O.objectNumber=mr();var be=[];be.push({key:"Type",value:"/XObject"}),be.push({key:"Subtype",value:"/Form"}),be.push({key:"BBox",value:"["+[ge(O.x),ge(O.y),ge(O.x+O.width),ge(O.y+O.height)].join(" ")+"]"}),be.push({key:"Matrix",value:"["+O.matrix.toString()+"]"});var Ke=O.pages[1].join(`
`);ir({data:Ke,additionalKeyValues:be,objectId:O.objectNumber}),me("endobj")},gi=function(){for(var O in Jn)Jn.hasOwnProperty(O)&&_i(Jn[O])},Kr=function(O,be){var Ke,ft=[],xt=1/(be-1);for(Ke=0;Ke<1;Ke+=xt)ft.push(Ke);if(ft.push(1),O[0].offset!=0){var $t={offset:0,color:O[0].color};O.unshift($t)}if(O[O.length-1].offset!=1){var cn={offset:1,color:O[O.length-1].color};O.push(cn)}for(var Nn="",zn=0,nr=0;nr<ft.length;nr++){for(Ke=ft[nr];Ke>O[zn+1].offset;)zn++;var vr=O[zn].offset,Ur=(Ke-vr)/(O[zn+1].offset-vr),$i=O[zn].color,pi=O[zn+1].color;Nn+=ce(Math.round((1-Ur)*$i[0]+Ur*pi[0]).toString(16))+ce(Math.round((1-Ur)*$i[1]+Ur*pi[1]).toString(16))+ce(Math.round((1-Ur)*$i[2]+Ur*pi[2]).toString(16))}return Nn.trim()},Br=function(O,be){be||(be=21);var Ke=mr(),ft=Kr(O.colors,be),xt=[];xt.push({key:"FunctionType",value:"0"}),xt.push({key:"Domain",value:"[0.0 1.0]"}),xt.push({key:"Size",value:"["+be+"]"}),xt.push({key:"BitsPerSample",value:"8"}),xt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),xt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ir({data:ft,additionalKeyValues:xt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Ke}),me("endobj"),O.objectNumber=mr(),me("<< /ShadingType "+O.type),me("/ColorSpace /DeviceRGB");var $t="/Coords ["+ge(parseFloat(O.coords[0]))+" "+ge(parseFloat(O.coords[1]))+" ";O.type===2?$t+=ge(parseFloat(O.coords[2]))+" "+ge(parseFloat(O.coords[3])):$t+=ge(parseFloat(O.coords[2]))+" "+ge(parseFloat(O.coords[3]))+" "+ge(parseFloat(O.coords[4]))+" "+ge(parseFloat(O.coords[5])),me($t+="]"),O.matrix&&me("/Matrix ["+O.matrix.toString()+"]"),me("/Function "+Ke+" 0 R"),me("/Extend [true true]"),me(">>"),me("endobj")},Rr=function(O,be){var Ke=lt(),ft=mr();be.push({resourcesOid:Ke,objectOid:ft}),O.objectNumber=ft;var xt=[];xt.push({key:"Type",value:"/Pattern"}),xt.push({key:"PatternType",value:"1"}),xt.push({key:"PaintType",value:"1"}),xt.push({key:"TilingType",value:"1"}),xt.push({key:"BBox",value:"["+O.boundingBox.map(ge).join(" ")+"]"}),xt.push({key:"XStep",value:ge(O.xStep)}),xt.push({key:"YStep",value:ge(O.yStep)}),xt.push({key:"Resources",value:Ke+" 0 R"}),O.matrix&&xt.push({key:"Matrix",value:"["+O.matrix.toString()+"]"}),ir({data:O.stream,additionalKeyValues:xt,objectId:O.objectNumber}),me("endobj")},dr=function(O){var be;for(be in xn)xn.hasOwnProperty(be)&&(xn[be]instanceof Zf?Br(xn[be]):xn[be]instanceof Uh&&Rr(xn[be],O))},zi=function(O){for(var be in O.objectNumber=mr(),me("<<"),O)switch(be){case"opacity":me("/ca "+Q(O[be]));break;case"stroke-opacity":me("/CA "+Q(O[be]))}me(">>"),me("endobj")},Ss=function(){var O;for(O in Pn)Pn.hasOwnProperty(O)&&zi(Pn[O])},Cs=function(){for(var O in me("/XObject <<"),Jn)Jn.hasOwnProperty(O)&&Jn[O].objectNumber>=0&&me("/"+O+" "+Jn[O].objectNumber+" 0 R");It.publish("putXobjectDict"),me(">>")},si=function(){to.oid=mr(),me("<<"),me("/Filter /Standard"),me("/V "+to.v),me("/R "+to.r),me("/U <"+to.toHexString(to.U)+">"),me("/O <"+to.toHexString(to.O)+">"),me("/P "+to.P),me(">>"),me("endobj")},jn=function(){for(var O in me("/Font <<"),wn)wn.hasOwnProperty(O)&&(y===!1||y===!0&&x.hasOwnProperty(O))&&me("/"+O+" "+wn[O].objectNumber+" 0 R");me(">>")},Po=function(){if(Object.keys(xn).length>0){for(var O in me("/Shading <<"),xn)xn.hasOwnProperty(O)&&xn[O]instanceof Zf&&xn[O].objectNumber>=0&&me("/"+O+" "+xn[O].objectNumber+" 0 R");It.publish("putShadingPatternDict"),me(">>")}},ci=function(O){if(Object.keys(xn).length>0){for(var be in me("/Pattern <<"),xn)xn.hasOwnProperty(be)&&xn[be]instanceof _.TilingPattern&&xn[be].objectNumber>=0&&xn[be].objectNumber<O&&me("/"+be+" "+xn[be].objectNumber+" 0 R");It.publish("putTilingPatternDict"),me(">>")}},hr=function(){if(Object.keys(Pn).length>0){var O;for(O in me("/ExtGState <<"),Pn)Pn.hasOwnProperty(O)&&Pn[O].objectNumber>=0&&me("/"+O+" "+Pn[O].objectNumber+" 0 R");It.publish("putGStateDict"),me(">>")}},qn=function(O){Cn(O.resourcesOid,!0),me("<<"),me("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),jn(),Po(),ci(O.objectOid),hr(),Cs(),me(">>"),me("endobj")},bo=function(){var O=[];ji(),Ss(),gi(),dr(O),It.publish("putResources"),O.forEach(qn),qn({resourcesOid:Fr,objectOid:Number.MAX_SAFE_INTEGER}),It.publish("postPutResources")},wo=function(){It.publish("putAdditionalObjects");for(var O=0;O<ke.length;O++){var be=ke[O];Cn(be.objId,!0),me(be.content),me("endobj")}It.publish("postPutAdditionalObjects")},Lr=function(O){Tn[O.fontName]=Tn[O.fontName]||{},Tn[O.fontName][O.fontStyle]=O.id},Us=function(O,be,Ke,ft,xt){var $t={id:"F"+(Object.keys(wn).length+1).toString(10),postScriptName:O,fontName:be,fontStyle:Ke,encoding:ft,isStandardFont:xt||!1,metadata:{}};return It.publish("addFont",{font:$t,instance:this}),wn[$t.id]=$t,Lr($t),$t.id},Gn=function(O){for(var be=0,Ke=Ze.length;be<Ke;be++){var ft=Us.call(this,O[be][0],O[be][1],O[be][2],Ze[be][3],!0);y===!1&&(x[ft]=!0);var xt=O[be][0].split("-");Lr({id:ft,fontName:xt[0],fontStyle:xt[1]||""})}It.publish("addFonts",{fonts:wn,dictionary:Tn})},_r=function(O){return O.foo=function(){try{return O.apply(this,arguments)}catch(ft){var be=ft.stack||"";~be.indexOf(" at ")&&(be=be.split(" at ")[1]);var Ke="Error in function "+be.split(`
`)[0].split("<")[0]+": "+ft.message;if(!Ir.console)throw new Error(Ke);Ir.console.error(Ke,ft),Ir.alert&&alert(Ke)}},O.foo.bar=O,O.foo},Yr=function(O,be){var Ke,ft,xt,$t,cn,Nn,zn,nr,vr;if(xt=(be=be||{}).sourceEncoding||"Unicode",cn=be.outputEncoding,(be.autoencode||cn)&&wn[ot].metadata&&wn[ot].metadata[xt]&&wn[ot].metadata[xt].encoding&&($t=wn[ot].metadata[xt].encoding,!cn&&wn[ot].encoding&&(cn=wn[ot].encoding),!cn&&$t.codePages&&(cn=$t.codePages[0]),typeof cn=="string"&&(cn=$t[cn]),cn)){for(zn=!1,Nn=[],Ke=0,ft=O.length;Ke<ft;Ke++)(nr=cn[O.charCodeAt(Ke)])?Nn.push(String.fromCharCode(nr)):Nn.push(O[Ke]),Nn[Ke].charCodeAt(0)>>8&&(zn=!0);O=Nn.join("")}for(Ke=O.length;zn===void 0&&Ke!==0;)O.charCodeAt(Ke-1)>>8&&(zn=!0),Ke--;if(!zn)return O;for(Nn=be.noBOM?[]:[254,255],Ke=0,ft=O.length;Ke<ft;Ke++){if((vr=(nr=O.charCodeAt(Ke))>>8)>>8)throw new Error("Character at position "+Ke+" of string '"+O+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Nn.push(vr),Nn.push(nr-(vr<<8))}return String.fromCharCode.apply(void 0,Nn)},_n=_.__private__.pdfEscape=_.pdfEscape=function(O,be){return Yr(O,be).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},tn=_.__private__.beginPage=function(O){Pe[++at]=[],We[at]={objId:0,contentsObjId:0,userUnit:Number(u),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(O[0]),topRightY:Number(O[1])}},xo(at),ye(Pe[ee])},ai=function(O,be){var Ke,ft,xt;switch(n=be||n,typeof O=="string"&&(Ke=I(O.toLowerCase()),Array.isArray(Ke)&&(ft=Ke[0],xt=Ke[1])),Array.isArray(O)&&(ft=O[0]*rt,xt=O[1]*rt),isNaN(ft)&&(ft=i[0],xt=i[1]),(ft>14400||xt>14400)&&(lo.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ft=Math.min(14400,ft),xt=Math.min(14400,xt)),i=[ft,xt],n.substr(0,1)){case"l":xt>ft&&(i=[xt,ft]);break;case"p":ft>xt&&(i=[xt,ft])}tn(i),kl(Jl),me(Ui),Dl!==0&&me(Dl+" J"),bi!==0&&me(bi+" j"),It.publish("addPage",{pageNumber:at})},fo=function(O){O>0&&O<=at&&(Pe.splice(O,1),We.splice(O,1),at--,ee>at&&(ee=at),this.setPage(ee))},xo=function(O){O>0&&O<=at&&(ee=O)},Mi=_.__private__.getNumberOfPages=_.getNumberOfPages=function(){return Pe.length-1},fs=function(O,be,Ke){var ft,xt=void 0;return Ke=Ke||{},O=O!==void 0?O:wn[ot].fontName,be=be!==void 0?be:wn[ot].fontStyle,ft=O.toLowerCase(),Tn[ft]!==void 0&&Tn[ft][be]!==void 0?xt=Tn[ft][be]:Tn[O]!==void 0&&Tn[O][be]!==void 0?xt=Tn[O][be]:Ke.disableWarning===!1&&lo.warn("Unable to look up font label for font '"+O+"', '"+be+"'. Refer to getFontList() for available fonts."),xt||Ke.noFallback||(xt=Tn.times[be])==null&&(xt=Tn.times.normal),xt},Qo=_.__private__.putInfo=function(){var O=mr(),be=function(ft){return ft};for(var Ke in g!==null&&(be=to.encryptor(O,0)),me("<<"),me("/Producer ("+_n(be("jsPDF "+kr.version))+")"),et)et.hasOwnProperty(Ke)&&et[Ke]&&me("/"+Ke.substr(0,1).toUpperCase()+Ke.substr(1)+" ("+_n(be(et[Ke]))+")");me("/CreationDate ("+_n(be(W))+")"),me(">>"),me("endobj")},Ro=_.__private__.putCatalog=function(O){var be=(O=O||{}).rootDictionaryObjId||Ii;switch(mr(),me("<<"),me("/Type /Catalog"),me("/Pages "+be+" 0 R"),Xe||(Xe="fullwidth"),Xe){case"fullwidth":me("/OpenAction [3 0 R /FitH null]");break;case"fullheight":me("/OpenAction [3 0 R /FitV null]");break;case"fullpage":me("/OpenAction [3 0 R /Fit]");break;case"original":me("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Ke=""+Xe;Ke.substr(Ke.length-1)==="%"&&(Xe=parseInt(Xe)/100),typeof Xe=="number"&&me("/OpenAction [3 0 R /XYZ null null "+Q(Xe)+"]")}switch(zt||(zt="continuous"),zt){case"continuous":me("/PageLayout /OneColumn");break;case"single":me("/PageLayout /SinglePage");break;case"two":case"twoleft":me("/PageLayout /TwoColumnLeft");break;case"tworight":me("/PageLayout /TwoColumnRight")}Lt&&me("/PageMode /"+Lt),It.publish("putCatalog"),me(">>"),me("endobj")},di=_.__private__.putTrailer=function(){me("trailer"),me("<<"),me("/Size "+(_e+1)),me("/Root "+_e+" 0 R"),me("/Info "+(_e-1)+" 0 R"),g!==null&&me("/Encrypt "+to.oid+" 0 R"),me("/ID [ <"+G+"> <"+G+"> ]"),me(">>")},Is=_.__private__.putHeader=function(){me("%PDF-"+M),me("%ºß¬à")},Fo=_.__private__.putXRef=function(){var O="0000000000";me("xref"),me("0 "+(_e+1)),me("0000000000 65535 f ");for(var be=1;be<=_e;be++)typeof se[be]=="function"?me((O+se[be]()).slice(-10)+" 00000 n "):se[be]!==void 0?me((O+se[be]).slice(-10)+" 00000 n "):me("0000000000 00000 n ")},eo=_.__private__.buildDocument=function(){de(),ye(k),It.publish("buildDocument"),Is(),jr(),wo(),bo(),g!==null&&si(),Qo(),Ro();var O=ae;return Fo(),di(),me("startxref"),me(""+O),me("%%EOF"),ye(Pe[ee]),k.join(`
`)},Lo=_.__private__.getBlob=function(O){return new Blob([Qe(O)],{type:"application/pdf"})},Vs=_.output=_.__private__.output=_r(function(O,be){switch(typeof(be=be||{})=="string"?be={filename:be}:be.filename=be.filename||"generated.pdf",O){case void 0:return eo();case"save":_.save(be.filename);break;case"arraybuffer":return Qe(eo());case"blob":return Lo(eo());case"bloburi":case"bloburl":if(Ir.URL!==void 0&&typeof Ir.URL.createObjectURL=="function")return Ir.URL&&Ir.URL.createObjectURL(Lo(eo()))||void 0;lo.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Ke="",ft=eo();try{Ke=w1(ft)}catch{Ke=w1(unescape(encodeURIComponent(ft)))}return"data:application/pdf;filename="+be.filename+";base64,"+Ke;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ir)==="[object Window]"){var xt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",$t=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';be.pdfObjectUrl&&(xt=be.pdfObjectUrl,$t="");var cn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+xt+'"'+$t+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(be)+");<\/script></body></html>",Nn=Ir.open();return Nn!==null&&Nn.document.write(cn),Nn}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ir)==="[object Window]"){var zn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(be.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+be.filename+'" width="500px" height="400px" /></body></html>',nr=Ir.open();if(nr!==null){nr.document.write(zn);var vr=this;nr.document.documentElement.querySelector("#pdfViewer").onload=function(){nr.document.title=be.filename,nr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(vr.output("bloburl"))}}return nr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ir)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Ur='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",be)+'"></iframe></body></html>',$i=Ir.open();if($i!==null&&($i.document.write(Ur),$i.document.title=be.filename),$i||typeof safari>"u")return $i;break;case"datauri":case"dataurl":return Ir.document.location.href=this.output("datauristring",be);default:return null}}),va=function(O){return Array.isArray(En)===!0&&En.indexOf(O)>-1};switch(r){case"pt":rt=1;break;case"mm":rt=72/25.4;break;case"cm":rt=72/2.54;break;case"in":rt=72;break;case"px":rt=va("px_scaling")==1?.75:96/72;break;case"pc":case"em":rt=12;break;case"ex":rt=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);rt=r}var to=null;De(),Y();var il=function(O){return g!==null?to.encryptor(O,0):function(be){return be}},ya=_.__private__.getPageInfo=_.getPageInfo=function(O){if(isNaN(O)||O%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:We[O].objId,pageNumber:O,pageContext:We[O]}},gr=_.__private__.getPageInfoByObjId=function(O){if(isNaN(O)||O%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var be in We)if(We[be].objId===O)break;return ya(be)},br=_.__private__.getCurrentPageInfo=_.getCurrentPageInfo=function(){return{objId:We[ee].objId,pageNumber:ee,pageContext:We[ee]}};_.addPage=function(){return ai.apply(this,arguments),this},_.setPage=function(){return xo.apply(this,arguments),ye.call(this,Pe[ee]),this},_.insertPage=function(O){return this.addPage(),this.movePage(ee,O),this},_.movePage=function(O,be){var Ke,ft;if(O>be){Ke=Pe[O],ft=We[O];for(var xt=O;xt>be;xt--)Pe[xt]=Pe[xt-1],We[xt]=We[xt-1];Pe[be]=Ke,We[be]=ft,this.setPage(be)}else if(O<be){Ke=Pe[O],ft=We[O];for(var $t=O;$t<be;$t++)Pe[$t]=Pe[$t+1],We[$t]=We[$t+1];Pe[be]=Ke,We[be]=ft,this.setPage(be)}return this},_.deletePage=function(){return fo.apply(this,arguments),this},_.__private__.text=_.text=function(O,be,Ke,ft,xt){var $t,cn,Nn,zn,nr,vr,Ur,$i,pi,xi=(ft=ft||{}).scope||this;if(typeof O=="number"&&typeof be=="number"&&(typeof Ke=="string"||Array.isArray(Ke))){var oo=Ke;Ke=be,be=O,O=oo}if(arguments[3]instanceof mn?(H("The transform parameter of text() with a Matrix value"),pi=xt):(Nn=arguments[4],zn=arguments[5],Xi(Ur=arguments[3])==="object"&&Ur!==null||(typeof Nn=="string"&&(zn=Nn,Nn=null),typeof Ur=="string"&&(zn=Ur,Ur=null),typeof Ur=="number"&&(Nn=Ur,Ur=null),ft={flags:Ur,angle:Nn,align:zn})),isNaN(be)||isNaN(Ke)||O==null)throw new Error("Invalid arguments passed to jsPDF.text");if(O.length===0)return xi;var ho="",Ps=!1,Vr=typeof ft.lineHeightFactor=="number"?ft.lineHeightFactor:Al,zo=xi.internal.scaleFactor;function fl(Si){return Si=Si.split("	").join(Array(ft.TabLen||9).join(" ")),_n(Si,Ur)}function es(Si){for(var Ai,so=Si.concat(),Ri=[],ks=so.length;ks--;)typeof(Ai=so.shift())=="string"?Ri.push(Ai):Array.isArray(Si)&&(Ai.length===1||Ai[1]===void 0&&Ai[2]===void 0)?Ri.push(Ai[0]):Ri.push([Ai[0],Ai[1],Ai[2]]);return Ri}function eu(Si,Ai){var so;if(typeof Si=="string")so=Ai(Si)[0];else if(Array.isArray(Si)){for(var Ri,ks,ds=Si.concat(),Bs=[],xu=ds.length;xu--;)typeof(Ri=ds.shift())=="string"?Bs.push(Ai(Ri)[0]):Array.isArray(Ri)&&typeof Ri[0]=="string"&&(ks=Ai(Ri[0],Ri[1],Ri[2]),Bs.push([ks[0],ks[1],ks[2]]));so=Bs}return so}var na=!1,wu=!0;if(typeof O=="string")na=!0;else if(Array.isArray(O)){var Ga=O.concat();cn=[];for(var Ha,po=Ga.length;po--;)(typeof(Ha=Ga.shift())!="string"||Array.isArray(Ha)&&typeof Ha[0]!="string")&&(wu=!1);na=wu}if(na===!1)throw new Error('Type of text must be string or Array. "'+O+'" is not recognized.');typeof O=="string"&&(O=O.match(/[\r?\n]/)?O.split(/\r\n|\r|\n/g):[O]);var ra=He/xi.internal.scaleFactor,Ms=ra*(Vr-1);switch(ft.baseline){case"bottom":Ke-=Ms;break;case"top":Ke+=ra-Ms;break;case"hanging":Ke+=ra-2*Ms;break;case"middle":Ke+=ra/2-Ms}if((vr=ft.maxWidth||0)>0&&(typeof O=="string"?O=xi.splitTextToSize(O,vr):Object.prototype.toString.call(O)==="[object Array]"&&(O=O.reduce(function(Si,Ai){return Si.concat(xi.splitTextToSize(Ai,vr))},[]))),$t={text:O,x:be,y:Ke,options:ft,mutex:{pdfEscape:_n,activeFontKey:ot,fonts:wn,activeFontSize:He}},It.publish("preProcessText",$t),O=$t.text,Nn=(ft=$t.options).angle,!(pi instanceof mn)&&Nn&&typeof Nn=="number"){Nn*=Math.PI/180,ft.rotationDirection===0&&(Nn=-Nn),Z===j.ADVANCED&&(Nn=-Nn);var hs=Math.cos(Nn),hl=Math.sin(Nn);pi=new mn(hs,hl,-hl,hs,0,0)}else Nn&&Nn instanceof mn&&(pi=Nn);Z!==j.ADVANCED||pi||(pi=Kt),(nr=ft.charSpace||Nl)!==void 0&&(ho+=ge(B(nr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),($i=ft.horizontalScale)!==void 0&&(ho+=ge(100*$i)+` Tz
`),ft.lang;var $o=-1,ts=ft.renderingMode!==void 0?ft.renderingMode:ft.stroke,ns=xi.internal.getCurrentPageInfo().pageContext;switch(ts){case 0:case!1:case"fill":$o=0;break;case 1:case!0:case"stroke":$o=1;break;case 2:case"fillThenStroke":$o=2;break;case 3:case"invisible":$o=3;break;case 4:case"fillAndAddForClipping":$o=4;break;case 5:case"strokeAndAddPathForClipping":$o=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":$o=6;break;case 7:case"addToPathForClipping":$o=7}var Ju=ns.usedRenderingMode!==void 0?ns.usedRenderingMode:-1;$o!==-1?ho+=$o+` Tr
`:Ju!==-1&&(ho+=`0 Tr
`),$o!==-1&&(ns.usedRenderingMode=$o),zn=ft.align||"left";var So,wa=He*Vr,Uo=xi.internal.pageSize.getWidth(),Vo=wn[ot];nr=ft.charSpace||Nl,vr=ft.maxWidth||0,Ur=Object.assign({autoencode:!0,noBOM:!0},ft.flags);var xa=[],La=function(Si){return xi.getStringUnitWidth(Si,{font:Vo,charSpace:nr,fontSize:He,doKerning:!1})*He/zo};if(Object.prototype.toString.call(O)==="[object Array]"){var Go;cn=es(O),zn!=="left"&&(So=cn.map(La));var Ao,ia=0;if(zn==="right"){be-=So[0],O=[],po=cn.length;for(var As=0;As<po;As++)As===0?(Ao=or(be),Go=ro(Ke)):(Ao=B(ia-So[As]),Go=-wa),O.push([cn[As],Ao,Go]),ia=So[As]}else if(zn==="center"){be-=So[0]/2,O=[],po=cn.length;for(var Ho=0;Ho<po;Ho++)Ho===0?(Ao=or(be),Go=ro(Ke)):(Ao=B((ia-So[Ho])/2),Go=-wa),O.push([cn[Ho],Ao,Go]),ia=So[Ho]}else if(zn==="left"){O=[],po=cn.length;for(var _t=0;_t<po;_t++)O.push(cn[_t])}else if(zn==="justify"&&Vo.encoding==="Identity-H"){O=[],po=cn.length,vr=vr!==0?vr:Uo;for(var Zt=0,At=0;At<po;At++)if(Go=At===0?ro(Ke):-wa,Ao=At===0?or(be):Zt,At<po-1){var An=B((vr-So[At])/(cn[At].split(" ").length-1)),Kn=cn[At].split(" ");O.push([Kn[0]+" ",Ao,Go]),Zt=0;for(var wr=1;wr<Kn.length;wr++){var Vi=(La(Kn[wr-1]+" "+Kn[wr])-La(Kn[wr]))*zo+An;wr==Kn.length-1?O.push([Kn[wr],Vi,0]):O.push([Kn[wr]+" ",Vi,0]),Zt-=Vi}}else O.push([cn[At],Ao,Go]);O.push(["",Zt,0])}else{if(zn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(O=[],po=cn.length,vr=vr!==0?vr:Uo,At=0;At<po;At++)Go=At===0?ro(Ke):-wa,Ao=At===0?or(be):0,At<po-1?xa.push(ge(B((vr-So[At])/(cn[At].split(" ").length-1)))):xa.push(0),O.push([cn[At],Ao,Go])}}var Li=typeof ft.R2L=="boolean"?ft.R2L:Mt;Li===!0&&(O=eu(O,function(Si,Ai,so){return[Si.split("").reverse().join(""),Ai,so]})),$t={text:O,x:be,y:Ke,options:ft,mutex:{pdfEscape:_n,activeFontKey:ot,fonts:wn,activeFontSize:He}},It.publish("postProcessText",$t),O=$t.text,Ps=$t.mutex.isHex||!1;var Ol=wn[ot].encoding;Ol!=="WinAnsiEncoding"&&Ol!=="StandardEncoding"||(O=eu(O,function(Si,Ai,so){return[fl(Si),Ai,so]})),cn=es(O),O=[];for(var rs,Gi,oa,Sa=0,sa=1,aa=Array.isArray(cn[0])?sa:Sa,la="",Qr=function(Si,Ai,so){var Ri="";return so instanceof mn?(so=typeof ft.angle=="number"?Bt(so,new mn(1,0,0,1,Si,Ai)):Bt(new mn(1,0,0,1,Si,Ai),so),Z===j.ADVANCED&&(so=Bt(new mn(1,0,0,-1,0,0),so)),Ri=so.join(" ")+` Tm
`):Ri=ge(Si)+" "+ge(Ai)+` Td
`,Ri},Ws=0;Ws<cn.length;Ws++){switch(la="",aa){case sa:oa=(Ps?"<":"(")+cn[Ws][0]+(Ps?">":")"),rs=parseFloat(cn[Ws][1]),Gi=parseFloat(cn[Ws][2]);break;case Sa:oa=(Ps?"<":"(")+cn[Ws]+(Ps?">":")"),rs=or(be),Gi=ro(Ke)}xa!==void 0&&xa[Ws]!==void 0&&(la=xa[Ws]+` Tw
`),Ws===0?O.push(la+Qr(rs,Gi,pi)+oa):aa===Sa?O.push(la+oa):aa===sa&&O.push(la+Qr(rs,Gi,pi)+oa)}O=aa===Sa?O.join(` Tj
T* `):O.join(` Tj
`),O+=` Tj
`;var ko=`BT
/`;return ko+=ot+" "+He+` Tf
`,ko+=ge(He*Vr)+` TL
`,ko+=ta+`
`,ko+=ho,ko+=O,me(ko+="ET"),x[ot]=!0,xi};var Jr=_.__private__.clip=_.clip=function(O){return me(O==="evenodd"?"W*":"W"),this};_.clipEvenOdd=function(){return Jr("evenodd")},_.__private__.discardPath=_.discardPath=function(){return me("n"),this};var Nr=_.__private__.isValidStyle=function(O){var be=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(O)!==-1&&(be=!0),be};_.__private__.setDefaultPathOperation=_.setDefaultPathOperation=function(O){return Nr(O)&&(d=O),this};var jo=_.__private__.getStyle=_.getStyle=function(O){var be=d;switch(O){case"D":case"S":be="S";break;case"F":be="f";break;case"FD":case"DF":be="B";break;case"f":case"f*":case"B":case"B*":be=O}return be},ol=_.close=function(){return me("h"),this};_.stroke=function(){return me("S"),this},_.fill=function(O){return sl("f",O),this},_.fillEvenOdd=function(O){return sl("f*",O),this},_.fillStroke=function(O){return sl("B",O),this},_.fillStrokeEvenOdd=function(O){return sl("B*",O),this};var sl=function(O,be){Xi(be)==="object"?bu(be,O):me(O)},Gs=function(O){O===null||Z===j.ADVANCED&&O===void 0||(O=jo(O),me(O))};function Ua(O,be,Ke,ft,xt){var $t=new Uh(be||this.boundingBox,Ke||this.xStep,ft||this.yStep,this.gState,xt||this.matrix);$t.stream=this.stream;var cn=O+"$$"+this.cloneIndex+++"$$";return Ln(cn,$t),$t}var bu=function(O,be){var Ke=Mn[O.key],ft=xn[Ke];if(ft instanceof Zf)me("q"),me(Ml(be)),ft.gState&&_.setGState(ft.gState),me(O.matrix.toString()+" cm"),me("/"+Ke+" sh"),me("Q");else if(ft instanceof Uh){var xt=new mn(1,0,0,-1,0,ba());O.matrix&&(xt=xt.multiply(O.matrix||Kt),Ke=Ua.call(ft,O.key,O.boundingBox,O.xStep,O.yStep,xt).id),me("q"),me("/Pattern cs"),me("/"+Ke+" scn"),ft.gState&&_.setGState(ft.gState),me(be),me("Q")}},Ml=function(O){switch(O){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Sr=_.moveTo=function(O,be){return me(ge(B(O))+" "+ge($(be))+" m"),this},qr=_.lineTo=function(O,be){return me(ge(B(O))+" "+ge($(be))+" l"),this},Va=_.curveTo=function(O,be,Ke,ft,xt,$t){return me([ge(B(O)),ge($(be)),ge(B(Ke)),ge($(ft)),ge(B(xt)),ge($($t)),"c"].join(" ")),this};_.__private__.line=_.line=function(O,be,Ke,ft,xt){if(isNaN(O)||isNaN(be)||isNaN(Ke)||isNaN(ft)||!Nr(xt))throw new Error("Invalid arguments passed to jsPDF.line");return Z===j.COMPAT?this.lines([[Ke-O,ft-be]],O,be,[1,1],xt||"S"):this.lines([[Ke-O,ft-be]],O,be,[1,1]).stroke()},_.__private__.lines=_.lines=function(O,be,Ke,ft,xt,$t){var cn,Nn,zn,nr,vr,Ur,$i,pi,xi,oo,ho,Ps;if(typeof O=="number"&&(Ps=Ke,Ke=be,be=O,O=Ps),ft=ft||[1,1],$t=$t||!1,isNaN(be)||isNaN(Ke)||!Array.isArray(O)||!Array.isArray(ft)||!Nr(xt)||typeof $t!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Sr(be,Ke),cn=ft[0],Nn=ft[1],nr=O.length,oo=be,ho=Ke,zn=0;zn<nr;zn++)(vr=O[zn]).length===2?(oo=vr[0]*cn+oo,ho=vr[1]*Nn+ho,qr(oo,ho)):(Ur=vr[0]*cn+oo,$i=vr[1]*Nn+ho,pi=vr[2]*cn+oo,xi=vr[3]*Nn+ho,oo=vr[4]*cn+oo,ho=vr[5]*Nn+ho,Va(Ur,$i,pi,xi,oo,ho));return $t&&ol(),Gs(xt),this},_.path=function(O){for(var be=0;be<O.length;be++){var Ke=O[be],ft=Ke.c;switch(Ke.op){case"m":Sr(ft[0],ft[1]);break;case"l":qr(ft[0],ft[1]);break;case"c":Va.apply(this,ft);break;case"h":ol()}}return this},_.__private__.rect=_.rect=function(O,be,Ke,ft,xt){if(isNaN(O)||isNaN(be)||isNaN(Ke)||isNaN(ft)||!Nr(xt))throw new Error("Invalid arguments passed to jsPDF.rect");return Z===j.COMPAT&&(ft=-ft),me([ge(B(O)),ge($(be)),ge(B(Ke)),ge(B(ft)),"re"].join(" ")),Gs(xt),this},_.__private__.triangle=_.triangle=function(O,be,Ke,ft,xt,$t,cn){if(isNaN(O)||isNaN(be)||isNaN(Ke)||isNaN(ft)||isNaN(xt)||isNaN($t)||!Nr(cn))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Ke-O,ft-be],[xt-Ke,$t-ft],[O-xt,be-$t]],O,be,[1,1],cn,!0),this},_.__private__.roundedRect=_.roundedRect=function(O,be,Ke,ft,xt,$t,cn){if(isNaN(O)||isNaN(be)||isNaN(Ke)||isNaN(ft)||isNaN(xt)||isNaN($t)||!Nr(cn))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Nn=4/3*(Math.SQRT2-1);return xt=Math.min(xt,.5*Ke),$t=Math.min($t,.5*ft),this.lines([[Ke-2*xt,0],[xt*Nn,0,xt,$t-$t*Nn,xt,$t],[0,ft-2*$t],[0,$t*Nn,-xt*Nn,$t,-xt,$t],[2*xt-Ke,0],[-xt*Nn,0,-xt,-$t*Nn,-xt,-$t],[0,2*$t-ft],[0,-$t*Nn,xt*Nn,-$t,xt,-$t]],O+xt,be,[1,1],cn,!0),this},_.__private__.ellipse=_.ellipse=function(O,be,Ke,ft,xt){if(isNaN(O)||isNaN(be)||isNaN(Ke)||isNaN(ft)||!Nr(xt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var $t=4/3*(Math.SQRT2-1)*Ke,cn=4/3*(Math.SQRT2-1)*ft;return Sr(O+Ke,be),Va(O+Ke,be-cn,O+$t,be-ft,O,be-ft),Va(O-$t,be-ft,O-Ke,be-cn,O-Ke,be),Va(O-Ke,be+cn,O-$t,be+ft,O,be+ft),Va(O+$t,be+ft,O+Ke,be+cn,O+Ke,be),Gs(xt),this},_.__private__.circle=_.circle=function(O,be,Ke,ft){if(isNaN(O)||isNaN(be)||isNaN(Ke)||!Nr(ft))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(O,be,Ke,Ke,ft)},_.setFont=function(O,be,Ke){return Ke&&(be=le(be,Ke)),ot=fs(O,be,{disableWarning:!1}),this};var Ku=_.__private__.getFont=_.getFont=function(){return wn[fs.apply(_,arguments)]};_.__private__.getFontList=_.getFontList=function(){var O,be,Ke={};for(O in Tn)if(Tn.hasOwnProperty(O))for(be in Ke[O]=[],Tn[O])Tn[O].hasOwnProperty(be)&&Ke[O].push(be);return Ke},_.addFont=function(O,be,Ke,ft,xt){var $t=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&$t.indexOf(arguments[3])!==-1?xt=arguments[3]:arguments[3]&&$t.indexOf(arguments[3])==-1&&(Ke=le(Ke,ft)),xt=xt||"Identity-H",Us.call(this,O,be,Ke,xt)};var Al,Jl=e.lineWidth||.200025,al=_.__private__.getLineWidth=_.getLineWidth=function(){return Jl},kl=_.__private__.setLineWidth=_.setLineWidth=function(O){return Jl=O,me(ge(B(O))+" w"),this};_.__private__.setLineDash=kr.API.setLineDash=kr.API.setLineDashPattern=function(O,be){if(O=O||[],be=be||0,isNaN(be)||!Array.isArray(O))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return O=O.map(function(Ke){return ge(B(Ke))}).join(" "),be=ge(B(be)),me("["+O+"] "+be+" d"),this};var Xl=_.__private__.getLineHeight=_.getLineHeight=function(){return He*Al};_.__private__.getLineHeight=_.getLineHeight=function(){return He*Al};var Xr=_.__private__.setLineHeightFactor=_.setLineHeightFactor=function(O){return typeof(O=O||1.15)=="number"&&(Al=O),this},no=_.__private__.getLineHeightFactor=_.getLineHeightFactor=function(){return Al};Xr(e.lineHeight);var or=_.__private__.getHorizontalCoordinate=function(O){return B(O)},ro=_.__private__.getVerticalCoordinate=function(O){return Z===j.ADVANCED?O:We[ee].mediaBox.topRightY-We[ee].mediaBox.bottomLeftY-B(O)},ll=_.__private__.getHorizontalCoordinateString=_.getHorizontalCoordinateString=function(O){return ge(or(O))},_a=_.__private__.getVerticalCoordinateString=_.getVerticalCoordinateString=function(O){return ge(ro(O))},Ui=e.strokeColor||"0 G";_.__private__.getStrokeColor=_.getDrawColor=function(){return Pr(Ui)},_.__private__.setStrokeColor=_.setDrawColor=function(O,be,Ke,ft){return Ui=lr({ch1:O,ch2:be,ch3:Ke,ch4:ft,pdfColorType:"draw",precision:2}),me(Ui),this};var Ql=e.fillColor||"0 g";_.__private__.getFillColor=_.getFillColor=function(){return Pr(Ql)},_.__private__.setFillColor=_.setFillColor=function(O,be,Ke,ft){return Ql=lr({ch1:O,ch2:be,ch3:Ke,ch4:ft,pdfColorType:"fill",precision:2}),me(Ql),this};var ta=e.textColor||"0 g",Tl=_.__private__.getTextColor=_.getTextColor=function(){return Pr(ta)};_.__private__.setTextColor=_.setTextColor=function(O,be,Ke,ft){return ta=lr({ch1:O,ch2:be,ch3:Ke,ch4:ft,pdfColorType:"text",precision:3}),this};var Nl=e.charSpace,Os=_.__private__.getCharSpace=_.getCharSpace=function(){return parseFloat(Nl||0)};_.__private__.setCharSpace=_.setCharSpace=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Nl=O,this};var Dl=0;_.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},_.__private__.setLineCap=_.setLineCap=function(O){var be=_.CapJoinStyles[O];if(be===void 0)throw new Error("Line cap style of '"+O+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Dl=be,me(be+" J"),this};var bi=0;_.__private__.setLineJoin=_.setLineJoin=function(O){var be=_.CapJoinStyles[O];if(be===void 0)throw new Error("Line join style of '"+O+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return bi=be,me(be+" j"),this},_.__private__.setLineMiterLimit=_.__private__.setMiterLimit=_.setLineMiterLimit=_.setMiterLimit=function(O){if(O=O||0,isNaN(O))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return me(ge(B(O))+" M"),this},_.GState=wm,_.setGState=function(O){(O=typeof O=="string"?Pn[fr[O]]:Yu(null,O)).equals(yr)||(me("/"+O.id+" gs"),yr=O)};var Yu=function(O,be){if(!O||!fr[O]){var Ke=!1;for(var ft in Pn)if(Pn.hasOwnProperty(ft)&&Pn[ft].equals(be)){Ke=!0;break}if(Ke)be=Pn[ft];else{var xt="GS"+(Object.keys(Pn).length+1).toString(10);Pn[xt]=be,be.id=xt}return O&&(fr[O]=be.id),It.publish("addGState",be),be}};_.addGState=function(O,be){return Yu(O,be),this},_.saveGraphicsState=function(){return me("q"),ar.push({key:ot,size:He,color:ta}),this},_.restoreGraphicsState=function(){me("Q");var O=ar.pop();return ot=O.key,He=O.size,ta=O.color,yr=null,this},_.setCurrentTransformationMatrix=function(O){return me(O.toString()+" cm"),this},_.comment=function(O){return me("#"+O),this};var Mo=function(O,be){var Ke=O||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Ke},set:function($t){isNaN($t)||(Ke=parseFloat($t))}});var ft=be||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ft},set:function($t){isNaN($t)||(ft=parseFloat($t))}});var xt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return xt},set:function($t){xt=$t.toString()}}),this},Hs=function(O,be,Ke,ft){Mo.call(this,O,be),this.type="rect";var xt=Ke||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return xt},set:function(cn){isNaN(cn)||(xt=parseFloat(cn))}});var $t=ft||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return $t},set:function(cn){isNaN(cn)||($t=parseFloat(cn))}}),this},Il=function(){this.page=at,this.currentPage=ee,this.pages=Pe.slice(0),this.pagesContext=We.slice(0),this.x=Ht,this.y=Qt,this.matrix=On,this.width=wi(ee),this.height=ba(ee),this.outputDestination=K,this.id="",this.objectNumber=-1};Il.prototype.restore=function(){at=this.page,ee=this.currentPage,We=this.pagesContext,Pe=this.pages,Ht=this.x,Qt=this.y,On=this.matrix,Es(ee,this.width),io(ee,this.height),K=this.outputDestination};var qs=function(O,be,Ke,ft,xt){qt.push(new Il),at=ee=0,Pe=[],Ht=O,Qt=be,On=xt,tn([Ke,ft])},ul=function(O){if(Zn[O])qt.pop().restore();else{var be=new Il,Ke="Xo"+(Object.keys(Jn).length+1).toString(10);be.id=Ke,Zn[O]=Ke,Jn[Ke]=be,It.publish("addFormObject",be),qt.pop().restore()}};for(var cl in _.beginFormObject=function(O,be,Ke,ft,xt){return qs(O,be,Ke,ft,xt),this},_.endFormObject=function(O){return ul(O),this},_.doFormObject=function(O,be){var Ke=Jn[Zn[O]];return me("q"),me(be.toString()+" cm"),me("/"+Ke.id+" Do"),me("Q"),this},_.getFormObject=function(O){var be=Jn[Zn[O]];return{x:be.x,y:be.y,width:be.width,height:be.height,matrix:be.matrix}},_.save=function(O,be){return O=O||"generated.pdf",(be=be||{}).returnPromise=be.returnPromise||!1,be.returnPromise===!1?(qf(Lo(eo()),O),typeof qf.unload=="function"&&Ir.setTimeout&&setTimeout(qf.unload,911),this):new Promise(function(Ke,ft){try{var xt=qf(Lo(eo()),O);typeof qf.unload=="function"&&Ir.setTimeout&&setTimeout(qf.unload,911),Ke(xt)}catch($t){ft($t.message)}})},kr.API)kr.API.hasOwnProperty(cl)&&(cl==="events"&&kr.API.events.length?function(O,be){var Ke,ft,xt;for(xt=be.length-1;xt!==-1;xt--)Ke=be[xt][0],ft=be[xt][1],O.subscribe.apply(O,[Ke].concat(typeof ft=="function"?[ft]:ft))}(It,kr.API.events):_[cl]=kr.API[cl]);var wi=_.getPageWidth=function(O){return(We[O=O||ee].mediaBox.topRightX-We[O].mediaBox.bottomLeftX)/rt},Es=_.setPageWidth=function(O,be){We[O].mediaBox.topRightX=be*rt+We[O].mediaBox.bottomLeftX},ba=_.getPageHeight=function(O){return(We[O=O||ee].mediaBox.topRightY-We[O].mediaBox.bottomLeftY)/rt},io=_.setPageHeight=function(O,be){We[O].mediaBox.topRightY=be*rt+We[O].mediaBox.bottomLeftY};return _.internal={pdfEscape:_n,getStyle:jo,getFont:Ku,getFontSize:tt,getCharSpace:Os,getTextColor:Tl,getLineHeight:Xl,getLineHeightFactor:no,getLineWidth:al,write:Ue,getHorizontalCoordinate:or,getVerticalCoordinate:ro,getCoordinateString:ll,getVerticalCoordinateString:_a,collections:{},newObject:mr,newAdditionalObject:xr,newObjectDeferred:lt,newObjectDeferredBegin:Cn,getFilters:Hr,putStream:ir,events:It,scaleFactor:rt,pageSize:{getWidth:function(){return wi(ee)},setWidth:function(O){Es(ee,O)},getHeight:function(){return ba(ee)},setHeight:function(O){io(ee,O)}},encryptionOptions:g,encryption:to,getEncryptor:il,output:Vs,getNumberOfPages:Mi,pages:Pe,out:me,f2:Q,f3:F,getPageInfo:ya,getPageInfoByObjId:gr,getCurrentPageInfo:br,getPDFVersion:T,Point:Mo,Rectangle:Hs,Matrix:mn,hasHotfix:va},Object.defineProperty(_.internal.pageSize,"width",{get:function(){return wi(ee)},set:function(O){Es(ee,O)},enumerable:!0,configurable:!0}),Object.defineProperty(_.internal.pageSize,"height",{get:function(){return ba(ee)},set:function(O){io(ee,O)},enumerable:!0,configurable:!0}),Gn.call(_,Ze),ot="F1",ai(i,n),It.publish("initialized"),_}Fh.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},Fh.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Fh.prototype.hexToBytes=function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(String.fromCharCode(parseInt(e.substr(n,2),16)));return t.join("")},Fh.prototype.processOwnerPassword=function(e,t){return L1(x1(t).substr(0,5),e)},Fh.prototype.encryptor=function(e,t){var n=x1(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(r){return L1(n,r)}},wm.prototype.equals=function(e){var t,n="id,objectNumber,equals";if(!e||Xi(e)!==Xi(this))return!1;var r=0;for(t in this)if(!(n.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;r++}for(t in e)e.hasOwnProperty(t)&&n.indexOf(t)<0&&r--;return r===0},kr.API={events:[]},kr.version="2.5.2";var ls=kr.API,vy=1,lh=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ah=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Zr=function(e){return e.toFixed(2)},of=function(e){return e.toFixed(5)};ls.__acroform__={};var Pl=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},Ab=function(e){return e*vy},sc=function(e){var t=new Ax,n=Yn.internal.getHeight(e)||0,r=Yn.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Zr(r)),Number(Zr(n))],t},AF=ls.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},kF=ls.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},TF=ls.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},bs=ls.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return TF(e,t-1)},ws=ls.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return AF(e,t-1)},xs=ls.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return kF(e,t-1)},NF=ls.__acroform__.calculateCoordinates=function(e,t){var n=t.internal.getHorizontalCoordinate,r=t.internal.getVerticalCoordinate,i=e[0],s=e[1],o=e[2],u=e[3],f={};return f.lowerLeft_X=n(i)||0,f.lowerLeft_Y=r(s+u)||0,f.upperRight_X=n(i+o)||0,f.upperRight_Y=r(s)||0,[Number(Zr(f.lowerLeft_X)),Number(Zr(f.lowerLeft_Y)),Number(Zr(f.upperRight_X)),Number(Zr(f.upperRight_Y))]},DF=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],n=e._V||e.DV,r=S1(e,n),i=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+i+" "+Zr(r.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(r.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=sc(e);return s.scope=e.scope,s.stream=t.join(`
`),s}},S1=function(e,t){var n=e.fontSize===0?e.maxFontSize:e.fontSize,r={text:"",fontSize:""},i=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");i=e.multiline?i.map(function(F){return F.split(`
`)}):i.map(function(F){return[F]});var s=n,o=Yn.internal.getHeight(e)||0;o=o<0?-o:o;var u=Yn.internal.getWidth(e)||0;u=u<0?-u:u;var f=function(F,B,R){if(F+1<i.length){var $=B+" "+i[F+1][0];return wg($,e,R).width<=u-4}return!1};s++;e:for(;s>0;){t="",s--;var d,g,y=wg("3",e,s).height,x=e.multiline?o-s:(o-y)/2,_=x+=2,M=0,T=0,D=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+wg(t,e,s=12).width+", FieldWidth:"+u+`
`;break}for(var I="",j=0,Z=0;Z<i.length;Z++)if(i.hasOwnProperty(Z)){var te=!1;if(i[Z].length!==1&&D!==i[Z].length-1){if((y+2)*(j+2)+2>o)continue e;I+=i[Z][D],te=!0,T=Z,Z--}else{I=(I+=i[Z][D]+" ").substr(I.length-1)==" "?I.substr(0,I.length-1):I;var ue=parseInt(Z),le=f(ue,I,s),ge=Z>=i.length-1;if(le&&!ge){I+=" ",D=0;continue}if(le||ge){if(ge)T=ue;else if(e.multiline&&(y+2)*(j+2)+2>o)continue e}else{if(!e.multiline||(y+2)*(j+2)+2>o)continue e;T=ue}}for(var H="",U=M;U<=T;U++){var Q=i[U];if(e.multiline){if(U===T){H+=Q[D]+" ",D=(D+1)%Q.length;continue}if(U===M){H+=Q[Q.length-1]+" ";continue}}H+=Q[0]+" "}switch(H=H.substr(H.length-1)==" "?H.substr(0,H.length-1):H,g=wg(H,e,s).width,e.textAlign){case"right":d=u-g-2;break;case"center":d=(u-g)/2;break;case"left":default:d=2}t+=Zr(d)+" "+Zr(_)+` Td
`,t+="("+lh(H)+`) Tj
`,t+=-Zr(d)+` 0 Td
`,_=-(s+2),g=0,M=te?T:T+1,j++,I=""}break}return r.text=t,r.fontSize=s,r},wg=function(e,t,n){var r=t.scope.internal.getFont(t.fontName,t.fontStyle),i=t.scope.getStringUnitWidth(e,{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:t.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:i}},IF={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},OF=function(e,t){var n={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(r){return r.type===n.type&&r.object===n.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(n)},BF=function(e,t){for(var n in e)if(e.hasOwnProperty(n)){var r=n,i=e[n];t.internal.newObjectDeferredBegin(i.objId,!0),Xi(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete e[r]}},RF=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Wu.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(IF)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");vy=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new kx,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in r)if(r.hasOwnProperty(i)){var s=r[i];s.objId=void 0,s.hasAnnotation&&OF(s,n)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(n){(function(r,i){var s=!r;for(var o in r||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(o)){var u=r[o],f=[],d=u.Rect;if(u.Rect&&(u.Rect=NF(u.Rect,i)),i.internal.newObjectDeferredBegin(u.objId,!0),u.DA=Yn.createDefaultAppearanceStream(u),Xi(u)==="object"&&typeof u.getKeyValueListForStream=="function"&&(f=u.getKeyValueListForStream()),u.Rect=d,u.hasAppearanceStream&&!u.appearanceStreamContent){var g=DF(u);f.push({key:"AP",value:"<</N "+g+">>"}),i.internal.acroformPlugin.xForms.push(g)}if(u.appearanceStreamContent){var y="";for(var x in u.appearanceStreamContent)if(u.appearanceStreamContent.hasOwnProperty(x)){var _=u.appearanceStreamContent[x];if(y+="/"+x+" ",y+="<<",Object.keys(_).length>=1||Array.isArray(_)){for(var o in _)if(_.hasOwnProperty(o)){var M=_[o];typeof M=="function"&&(M=M.call(i,u)),y+="/"+o+" "+M+" ",i.internal.acroformPlugin.xForms.indexOf(M)>=0||i.internal.acroformPlugin.xForms.push(M)}}else typeof(M=_)=="function"&&(M=M.call(i,u)),y+="/"+o+" "+M,i.internal.acroformPlugin.xForms.indexOf(M)>=0||i.internal.acroformPlugin.xForms.push(M);y+=">>"}f.push({key:"AP",value:`<<
`+y+">>"})}i.internal.putStream({additionalKeyValues:f,objectId:u.objId}),i.internal.out("endobj")}s&&BF(i.internal.acroformPlugin.xForms,i)})(n,e)}),e.internal.acroformPlugin.isInitialized=!0}},Mx=ls.__acroform__.arrayToPdfArray=function(e,t,n){var r=function(o){return o};if(Array.isArray(e)){for(var i="[",s=0;s<e.length;s++)switch(s!==0&&(i+=" "),Xi(e[s])){case"boolean":case"number":case"object":i+=e[s].toString();break;case"string":e[s].substr(0,1)!=="/"?(t!==void 0&&n&&(r=n.internal.getEncryptor(t)),i+="("+lh(r(e[s].toString()))+")"):i+=e[s].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},dv=function(e,t,n){var r=function(i){return i};return t!==void 0&&n&&(r=n.internal.getEncryptor(t)),(e=e||"").toString(),e="("+lh(r(e))+")"},hc=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};hc.prototype.toString=function(){return this.objId+" 0 R"},hc.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},hc.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var n in t)if(Object.getOwnPropertyDescriptor(this,t[n]).configurable===!1){var r=t[n],i=this[r];i&&(Array.isArray(i)?e.push({key:r,value:Mx(i,this.objId,this.scope)}):i instanceof hc?(i.scope=this.scope,e.push({key:r,value:i.objId+" 0 R"})):typeof i!="function"&&e.push({key:r,value:i}))}return e};var Ax=function(){hc.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){e=n.trim()},get:function(){return e||null}})};Pl(Ax,hc);var kx=function(){hc.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var n=function(r){return r};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+lh(n(e))+")"}},set:function(n){e=n}})};Pl(kx,hc);var Wu=function e(){hc.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(I){if(isNaN(I))throw new Error('Invalid value "'+I+'" for attribute F supplied.');t=I}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!bs(t,3)},set:function(I){I?this.F=ws(t,3):this.F=xs(t,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(I){if(isNaN(I))throw new Error('Invalid value "'+I+'" for attribute Ff supplied.');n=I}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(I){r=I!==void 0?I:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(I){r[0]=I}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(I){r[1]=I}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(I){r[2]=I}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(I){r[3]=I}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(I){switch(I){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=I;break;default:throw new Error('Invalid value "'+I+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof xm)return;s="FieldObject"+e.FieldNum++}var I=function(j){return j};return this.scope&&(I=this.scope.internal.getEncryptor(this.objId)),"("+lh(I(s))+")"},set:function(I){s=I.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(I){s=I}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(I){o=I}});var u="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return u},set:function(I){u=I}});var f=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return f},set:function(I){f=I}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/vy:d},set:function(I){d=I}});var g="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return g},set:function(I){g=I}});var y="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!y||this instanceof xm||this instanceof th))return dv(y,this.objId,this.scope)},set:function(I){I=I.toString(),y=I}});var x=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(x)return this instanceof Qs?x:dv(x,this.objId,this.scope)},set:function(I){I=I.toString(),x=this instanceof Qs?I:I.substr(0,1)==="("?Ah(I.substr(1,I.length-2)):Ah(I)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Qs?Ah(x.substr(1,x.length-1)):x},set:function(I){I=I.toString(),x=this instanceof Qs?"/"+I:I}});var _=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(_)return _},set:function(I){this.V=I}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(_)return this instanceof Qs?_:dv(_,this.objId,this.scope)},set:function(I){I=I.toString(),_=this instanceof Qs?I:I.substr(0,1)==="("?Ah(I.substr(1,I.length-2)):Ah(I)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Qs?Ah(_.substr(1,_.length-1)):_},set:function(I){I=I.toString(),_=this instanceof Qs?"/"+I:I}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var M,T=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return T},set:function(I){I=!!I,T=I}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(M)return M},set:function(I){M=I}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,1)},set:function(I){I?this.Ff=ws(this.Ff,1):this.Ff=xs(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,2)},set:function(I){I?this.Ff=ws(this.Ff,2):this.Ff=xs(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,3)},set:function(I){I?this.Ff=ws(this.Ff,3):this.Ff=xs(this.Ff,3)}});var D=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(D!==null)return D},set:function(I){if([0,1,2].indexOf(I)===-1)throw new Error('Invalid value "'+I+'" for attribute Q supplied.');D=I}}),Object.defineProperty(this,"textAlign",{get:function(){var I;switch(D){case 0:default:I="left";break;case 1:I="center";break;case 2:I="right"}return I},configurable:!0,enumerable:!0,set:function(I){switch(I){case"right":case 2:D=2;break;case"center":case 1:D=1;break;case"left":case 0:default:D=0}}})};Pl(Wu,hc);var Yh=function(){Wu.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(n){e=n}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Mx(t,this.objId,this.scope)},set:function(n){var r,i;i=[],typeof(r=n)=="string"&&(i=function(s,o,u){u||(u=1);for(var f,d=[];f=o.exec(s);)d.push(f[u]);return d}(r,/\((.*?)\)/g)),t=i}}),this.getOptions=function(){return t},this.setOptions=function(n){t=n,this.sort&&t.sort()},this.addOption=function(n){n=(n=n||"").toString(),t.push(n),this.sort&&t.sort()},this.removeOption=function(n,r){for(r=r||!1,n=(n=n||"").toString();t.indexOf(n)!==-1&&(t.splice(t.indexOf(n),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,18)},set:function(n){n?this.Ff=ws(this.Ff,18):this.Ff=xs(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=ws(this.Ff,19):this.Ff=xs(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,20)},set:function(n){n?(this.Ff=ws(this.Ff,20),t.sort()):this.Ff=xs(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,22)},set:function(n){n?this.Ff=ws(this.Ff,22):this.Ff=xs(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,23)},set:function(n){n?this.Ff=ws(this.Ff,23):this.Ff=xs(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,27)},set:function(n){n?this.Ff=ws(this.Ff,27):this.Ff=xs(this.Ff,27)}}),this.hasAppearanceStream=!1};Pl(Yh,Wu);var Jh=function(){Yh.call(this),this.fontName="helvetica",this.combo=!1};Pl(Jh,Yh);var Xh=function(){Jh.call(this),this.combo=!0};Pl(Xh,Jh);var $g=function(){Xh.call(this),this.edit=!0};Pl($g,Xh);var Qs=function(){Wu.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,15)},set:function(n){n?this.Ff=ws(this.Ff,15):this.Ff=xs(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,16)},set:function(n){n?this.Ff=ws(this.Ff,16):this.Ff=xs(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,17)},set:function(n){n?this.Ff=ws(this.Ff,17):this.Ff=xs(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,26)},set:function(n){n?this.Ff=ws(this.Ff,26):this.Ff=xs(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(s){return s};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var r,i=[];for(r in i.push("<<"),t)i.push("/"+r+" ("+lh(n(t[r]))+")");return i.push(">>"),i.join(`
`)}},set:function(n){Xi(n)==="object"&&(t=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(n){typeof n=="string"&&(t.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(n){e="/"+n}})};Pl(Qs,Wu);var Ug=function(){Qs.call(this),this.pushButton=!0};Pl(Ug,Qs);var Qh=function(){Qs.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Pl(Qh,Qs);var xm=function(){var e,t;Wu.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(i){e=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(i){t=i}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(u){return u};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),r)o.push("/"+s+" ("+lh(i(r[s]))+")");return o.push(">>"),o.join(`
`)},set:function(i){Xi(i)==="object"&&(r=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(i){typeof i=="string"&&(r.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(i){n=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(i){n="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Yn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Pl(xm,Wu),Qh.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var n=this.Kids[t];n.appearanceStreamContent=e.createAppearanceStream(n.optionName),n.caption=e.getCA()}},Qh.prototype.createOption=function(e){var t=new xm;return t.Parent=this,t.optionName=e,this.Kids.push(t),FF.call(this.scope,t),t};var Vg=function(){Qs.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Yn.CheckBox.createAppearanceStream()};Pl(Vg,Qs);var th=function(){Wu.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,13)},set:function(t){t?this.Ff=ws(this.Ff,13):this.Ff=xs(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,21)},set:function(t){t?this.Ff=ws(this.Ff,21):this.Ff=xs(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,23)},set:function(t){t?this.Ff=ws(this.Ff,23):this.Ff=xs(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,24)},set:function(t){t?this.Ff=ws(this.Ff,24):this.Ff=xs(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,25)},set:function(t){t?this.Ff=ws(this.Ff,25):this.Ff=xs(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,26)},set:function(t){t?this.Ff=ws(this.Ff,26):this.Ff=xs(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Pl(th,Wu);var Gg=function(){th.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!bs(this.Ff,14)},set:function(e){e?this.Ff=ws(this.Ff,14):this.Ff=xs(this.Ff,14)}}),this.password=!0};Pl(Gg,th);var Yn={CheckBox:{createAppearanceStream:function(){return{N:{On:Yn.CheckBox.YesNormal},D:{On:Yn.CheckBox.YesPushDown,Off:Yn.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=sc(e);t.scope=e.scope;var n=[],r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),s=S1(e,e.caption);return n.push("0.749023 g"),n.push("0 0 "+Zr(Yn.internal.getWidth(e))+" "+Zr(Yn.internal.getHeight(e))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+r+" "+Zr(s.fontSize)+" Tf "+i),n.push("BT"),n.push(s.text),n.push("ET"),n.push("Q"),n.push("EMC"),t.stream=n.join(`
`),t},YesNormal:function(e){var t=sc(e);t.scope=e.scope;var n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color),i=[],s=Yn.internal.getHeight(e),o=Yn.internal.getWidth(e),u=S1(e,e.caption);return i.push("1 g"),i.push("0 0 "+Zr(o)+" "+Zr(s)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Zr(o-1)+" "+Zr(s-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+n+" "+Zr(u.fontSize)+" Tf "+r),i.push(u.text),i.push("ET"),i.push("Q"),t.stream=i.join(`
`),t},OffPushDown:function(e){var t=sc(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+Zr(Yn.internal.getWidth(e))+" "+Zr(Yn.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:Yn.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=Yn.RadioButton.Circle.YesNormal,t.D[e]=Yn.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=sc(e);t.scope=e.scope;var n=[],r=Yn.internal.getWidth(e)<=Yn.internal.getHeight(e)?Yn.internal.getWidth(e)/4:Yn.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var i=Yn.internal.Bezier_C,s=Number((r*i).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+of(Yn.internal.getWidth(e)/2)+" "+of(Yn.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),n.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),n.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),n.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t},YesPushDown:function(e){var t=sc(e);t.scope=e.scope;var n=[],r=Yn.internal.getWidth(e)<=Yn.internal.getHeight(e)?Yn.internal.getWidth(e)/4:Yn.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),s=Number((i*Yn.internal.Bezier_C).toFixed(5)),o=Number((r*Yn.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+of(Yn.internal.getWidth(e)/2)+" "+of(Yn.internal.getHeight(e)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),n.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),n.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),n.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+of(Yn.internal.getWidth(e)/2)+" "+of(Yn.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),n.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),n.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),n.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=sc(e);t.scope=e.scope;var n=[],r=Yn.internal.getWidth(e)<=Yn.internal.getHeight(e)?Yn.internal.getWidth(e)/4:Yn.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),s=Number((i*Yn.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+of(Yn.internal.getWidth(e)/2)+" "+of(Yn.internal.getHeight(e)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),n.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),n.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),n.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:Yn.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=Yn.RadioButton.Cross.YesNormal,t.D[e]=Yn.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=sc(e);t.scope=e.scope;var n=[],r=Yn.internal.calculateCross(e);return n.push("q"),n.push("1 1 "+Zr(Yn.internal.getWidth(e)-2)+" "+Zr(Yn.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Zr(r.x1.x)+" "+Zr(r.x1.y)+" m"),n.push(Zr(r.x2.x)+" "+Zr(r.x2.y)+" l"),n.push(Zr(r.x4.x)+" "+Zr(r.x4.y)+" m"),n.push(Zr(r.x3.x)+" "+Zr(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},YesPushDown:function(e){var t=sc(e);t.scope=e.scope;var n=Yn.internal.calculateCross(e),r=[];return r.push("0.749023 g"),r.push("0 0 "+Zr(Yn.internal.getWidth(e))+" "+Zr(Yn.internal.getHeight(e))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+Zr(Yn.internal.getWidth(e)-2)+" "+Zr(Yn.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Zr(n.x1.x)+" "+Zr(n.x1.y)+" m"),r.push(Zr(n.x2.x)+" "+Zr(n.x2.y)+" l"),r.push(Zr(n.x4.x)+" "+Zr(n.x4.y)+" m"),r.push(Zr(n.x3.x)+" "+Zr(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=sc(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+Zr(Yn.internal.getWidth(e))+" "+Zr(Yn.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+n}};Yn.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=Yn.internal.getWidth(e),n=Yn.internal.getHeight(e),r=Math.min(t,n);return{x1:{x:(t-r)/2,y:(n-r)/2+r},x2:{x:(t-r)/2+r,y:(n-r)/2},x3:{x:(t-r)/2,y:(n-r)/2},x4:{x:(t-r)/2+r,y:(n-r)/2+r}}}},Yn.internal.getWidth=function(e){var t=0;return Xi(e)==="object"&&(t=Ab(e.Rect[2])),t},Yn.internal.getHeight=function(e){var t=0;return Xi(e)==="object"&&(t=Ab(e.Rect[3])),t};var FF=ls.addField=function(e){if(RF(this,e),!(e instanceof Wu))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};ls.AcroFormChoiceField=Yh,ls.AcroFormListBox=Jh,ls.AcroFormComboBox=Xh,ls.AcroFormEditBox=$g,ls.AcroFormButton=Qs,ls.AcroFormPushButton=Ug,ls.AcroFormRadioButton=Qh,ls.AcroFormCheckBox=Vg,ls.AcroFormTextField=th,ls.AcroFormPasswordField=Gg,ls.AcroFormAppearance=Yn,ls.AcroForm={ChoiceField:Yh,ListBox:Jh,ComboBox:Xh,EditBox:$g,Button:Qs,PushButton:Ug,RadioButton:Qh,CheckBox:Vg,TextField:th,PasswordField:Gg,Appearance:Yn},kr.AcroForm={ChoiceField:Yh,ListBox:Jh,ComboBox:Xh,EditBox:$g,Button:Qs,PushButton:Ug,RadioButton:Qh,CheckBox:Vg,TextField:th,PasswordField:Gg,Appearance:Yn};kr.AcroForm;function Tx(e){return e.reduce(function(t,n,r){return t[n]=r,t},{})}(function(e){e.__addimage__={};var t="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=e.__addimage__.getImageFileTypeByImageData=function(F,B){var R,$,W,G,J,Y=t;if((B=B||t)==="RGBA"||F.data!==void 0&&F.data instanceof Uint8ClampedArray&&"height"in F&&"width"in F)return"RGBA";if(le(F))for(J in n)for(W=n[J],R=0;R<W.length;R+=1){for(G=!0,$=0;$<W[R].length;$+=1)if(W[R][$]!==void 0&&W[R][$]!==F[$]){G=!1;break}if(G===!0){Y=J;break}}else for(J in n)for(W=n[J],R=0;R<W.length;R+=1){for(G=!0,$=0;$<W[R].length;$+=1)if(W[R][$]!==void 0&&W[R][$]!==F.charCodeAt($)){G=!1;break}if(G===!0){Y=J;break}}return Y===t&&B!==t&&(Y=B),Y},i=function F(B){for(var R=this.internal.write,$=this.internal.putStream,W=(0,this.internal.getFilters)();W.indexOf("FlateEncode")!==-1;)W.splice(W.indexOf("FlateEncode"),1);B.objectId=this.internal.newObject();var G=[];if(G.push({key:"Type",value:"/XObject"}),G.push({key:"Subtype",value:"/Image"}),G.push({key:"Width",value:B.width}),G.push({key:"Height",value:B.height}),B.colorSpace===D.INDEXED?G.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(B.palette.length/3-1)+" "+("sMask"in B&&B.sMask!==void 0?B.objectId+2:B.objectId+1)+" 0 R]"}):(G.push({key:"ColorSpace",value:"/"+B.colorSpace}),B.colorSpace===D.DEVICE_CMYK&&G.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),G.push({key:"BitsPerComponent",value:B.bitsPerComponent}),"decodeParameters"in B&&B.decodeParameters!==void 0&&G.push({key:"DecodeParms",value:"<<"+B.decodeParameters+">>"}),"transparency"in B&&Array.isArray(B.transparency)){for(var J="",Y=0,pe=B.transparency.length;Y<pe;Y++)J+=B.transparency[Y]+" "+B.transparency[Y]+" ";G.push({key:"Mask",value:"["+J+"]"})}B.sMask!==void 0&&G.push({key:"SMask",value:B.objectId+1+" 0 R"});var Le=B.filter!==void 0?["/"+B.filter]:void 0;if($({data:B.data,additionalKeyValues:G,alreadyAppliedFilters:Le,objectId:B.objectId}),R("endobj"),"sMask"in B&&B.sMask!==void 0){var De="/Predictor "+B.predictor+" /Colors 1 /BitsPerComponent "+B.bitsPerComponent+" /Columns "+B.width,N={width:B.width,height:B.height,colorSpace:"DeviceGray",bitsPerComponent:B.bitsPerComponent,decodeParameters:De,data:B.sMask};"filter"in B&&(N.filter=B.filter),F.call(this,N)}if(B.colorSpace===D.INDEXED){var ee=this.internal.newObject();$({data:H(new Uint8Array(B.palette)),objectId:ee}),R("endobj")}},s=function(){var F=this.internal.collections.addImage_images;for(var B in F)i.call(this,F[B])},o=function(){var F,B=this.internal.collections.addImage_images,R=this.internal.write;for(var $ in B)R("/I"+(F=B[$]).index,F.objectId,"0","R")},u=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",o))},f=function(){var F=this.internal.collections.addImage_images;return u.call(this),F},d=function(){return Object.keys(this.internal.collections.addImage_images).length},g=function(F){return typeof e["process"+F.toUpperCase()]=="function"},y=function(F){return Xi(F)==="object"&&F.nodeType===1},x=function(F,B){if(F.nodeName==="IMG"&&F.hasAttribute("src")){var R=""+F.getAttribute("src");if(R.indexOf("data:image/")===0)return sp(unescape(R).split("base64,").pop());var $=e.loadFile(R,!0);if($!==void 0)return $}if(F.nodeName==="CANVAS"){if(F.width===0||F.height===0)throw new Error("Given canvas must have data. Canvas width: "+F.width+", height: "+F.height);var W;switch(B){case"PNG":W="image/png";break;case"WEBP":W="image/webp";break;case"JPEG":case"JPG":default:W="image/jpeg"}return sp(F.toDataURL(W,1).split("base64,").pop())}},_=function(F){var B=this.internal.collections.addImage_images;if(B){for(var R in B)if(F===B[R].alias)return B[R]}},M=function(F,B,R){return F||B||(F=-96,B=-96),F<0&&(F=-1*R.width*72/F/this.internal.scaleFactor),B<0&&(B=-1*R.height*72/B/this.internal.scaleFactor),F===0&&(F=B*R.width/R.height),B===0&&(B=F*R.height/R.width),[F,B]},T=function(F,B,R,$,W,G){var J=M.call(this,R,$,W),Y=this.internal.getCoordinateString,pe=this.internal.getVerticalCoordinateString,Le=f.call(this);if(R=J[0],$=J[1],Le[W.index]=W,G){G*=Math.PI/180;var De=Math.cos(G),N=Math.sin(G),ee=function(ce){return ce.toFixed(4)},fe=[ee(De),ee(N),ee(-1*N),ee(De),0,0,"cm"]}this.internal.write("q"),G?(this.internal.write([1,"0","0",1,Y(F),pe(B+$),"cm"].join(" ")),this.internal.write(fe.join(" ")),this.internal.write([Y(R),"0","0",Y($),"0","0","cm"].join(" "))):this.internal.write([Y(R),"0","0",Y($),Y(F),pe(B+$),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+W.index+" Do"),this.internal.write("Q")},D=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var I=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},j=e.__addimage__.sHashCode=function(F){var B,R,$=0;if(typeof F=="string")for(R=F.length,B=0;B<R;B++)$=($<<5)-$+F.charCodeAt(B),$|=0;else if(le(F))for(R=F.byteLength/2,B=0;B<R;B++)$=($<<5)-$+F[B],$|=0;return $},Z=e.__addimage__.validateStringAsBase64=function(F){(F=F||"").toString().trim();var B=!0;return F.length===0&&(B=!1),F.length%4!=0&&(B=!1),/^[A-Za-z0-9+/]+$/.test(F.substr(0,F.length-2))===!1&&(B=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(F.substr(-2))===!1&&(B=!1),B},te=e.__addimage__.extractImageFromDataUrl=function(F){var B=(F=F||"").split("base64,"),R=null;if(B.length===2){var $=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(B[0]);Array.isArray($)&&(R={mimeType:$[1],charset:$[2],data:B[1]})}return R},ue=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(F){return ue()&&F instanceof ArrayBuffer};var le=e.__addimage__.isArrayBufferView=function(F){return ue()&&typeof Uint32Array<"u"&&(F instanceof Int8Array||F instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&F instanceof Uint8ClampedArray||F instanceof Int16Array||F instanceof Uint16Array||F instanceof Int32Array||F instanceof Uint32Array||F instanceof Float32Array||F instanceof Float64Array)},ge=e.__addimage__.binaryStringToUint8Array=function(F){for(var B=F.length,R=new Uint8Array(B),$=0;$<B;$++)R[$]=F.charCodeAt($);return R},H=e.__addimage__.arrayBufferToBinaryString=function(F){for(var B="",R=le(F)?F:new Uint8Array(F),$=0;$<R.length;$+=8192)B+=String.fromCharCode.apply(null,R.subarray($,$+8192));return B};e.addImage=function(){var F,B,R,$,W,G,J,Y,pe;if(typeof arguments[1]=="number"?(B=t,R=arguments[1],$=arguments[2],W=arguments[3],G=arguments[4],J=arguments[5],Y=arguments[6],pe=arguments[7]):(B=arguments[1],R=arguments[2],$=arguments[3],W=arguments[4],G=arguments[5],J=arguments[6],Y=arguments[7],pe=arguments[8]),Xi(F=arguments[0])==="object"&&!y(F)&&"imageData"in F){var Le=F;F=Le.imageData,B=Le.format||B||t,R=Le.x||R||0,$=Le.y||$||0,W=Le.w||Le.width||W,G=Le.h||Le.height||G,J=Le.alias||J,Y=Le.compression||Y,pe=Le.rotation||Le.angle||pe}var De=this.internal.getFilters();if(Y===void 0&&De.indexOf("FlateEncode")!==-1&&(Y="SLOW"),isNaN(R)||isNaN($))throw new Error("Invalid coordinates passed to jsPDF.addImage");u.call(this);var N=U.call(this,F,B,J,Y);return T.call(this,R,$,W,G,N,pe),this};var U=function(F,B,R,$){var W,G,J;if(typeof F=="string"&&r(F)===t){F=unescape(F);var Y=Q(F,!1);(Y!==""||(Y=e.loadFile(F,!0))!==void 0)&&(F=Y)}if(y(F)&&(F=x(F,B)),B=r(F,B),!g(B))throw new Error("addImage does not support files of type '"+B+"', please ensure that a plugin for '"+B+"' support is added.");if(((J=R)==null||J.length===0)&&(R=function(pe){return typeof pe=="string"||le(pe)?j(pe):le(pe.data)?j(pe.data):null}(F)),(W=_.call(this,R))||(ue()&&(F instanceof Uint8Array||B==="RGBA"||(G=F,F=ge(F))),W=this["process"+B.toUpperCase()](F,d.call(this),R,function(pe){return pe&&typeof pe=="string"&&(pe=pe.toUpperCase()),pe in e.image_compression?pe:I.NONE}($),G)),!W)throw new Error("An unknown error occurred whilst processing the image.");return W},Q=e.__addimage__.convertBase64ToBinaryString=function(F,B){var R;B=typeof B!="boolean"||B;var $,W="";if(typeof F=="string"){$=(R=te(F))!==null?R.data:F;try{W=sp($)}catch(G){if(B)throw Z($)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+G.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return W};e.getImageProperties=function(F){var B,R,$="";if(y(F)&&(F=x(F)),typeof F=="string"&&r(F)===t&&(($=Q(F,!1))===""&&($=e.loadFile(F)||""),F=$),R=r(F),!g(R))throw new Error("addImage does not support files of type '"+R+"', please ensure that a plugin for '"+R+"' support is added.");if(!ue()||F instanceof Uint8Array||(F=ge(F)),!(B=this["process"+R.toUpperCase()](F)))throw new Error("An unknown error occurred whilst processing the image");return B.fileType=R,B}})(kr.API),function(e){var t=function(n){if(n!==void 0&&n!="")return!0};kr.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(n){for(var r,i,s,o=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString,f=this.internal.getPageInfoByObjId(n.objId),d=n.pageContext.annotations,g=!1,y=0;y<d.length&&!g;y++)switch((r=d[y]).type){case"link":(t(r.options.url)||t(r.options.pageNumber))&&(g=!0);break;case"reference":case"text":case"freetext":g=!0}if(g!=0){this.internal.write("/Annots [");for(var x=0;x<d.length;x++){r=d[x];var _=this.internal.pdfEscape,M=this.internal.getEncryptor(n.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var T=this.internal.newAdditionalObject(),D=this.internal.newAdditionalObject(),I=this.internal.getEncryptor(T.objId),j=r.title||"Note";s="<</Type /Annot /Subtype /Text "+(i="/Rect ["+o(r.bounds.x)+" "+u(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w)+" "+u(r.bounds.y)+"] ")+"/Contents ("+_(I(r.contents))+")",s+=" /Popup "+D.objId+" 0 R",s+=" /P "+f.objId+" 0 R",s+=" /T ("+_(I(j))+") >>",T.content=s;var Z=T.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+o(r.bounds.x+30)+" "+u(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w+30)+" "+u(r.bounds.y)+"] ")+" /Parent "+Z,r.open&&(s+=" /Open true"),s+=" >>",D.content=s,this.internal.write(T.objId,"0 R",D.objId,"0 R");break;case"freetext":i="/Rect ["+o(r.bounds.x)+" "+u(r.bounds.y)+" "+o(r.bounds.x+r.bounds.w)+" "+u(r.bounds.y+r.bounds.h)+"] ";var te=r.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+_(M(r.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+te+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(r.options.name){var ue=this.annotations._nameMap[r.options.name];r.options.pageNumber=ue.page,r.options.top=ue.y}else r.options.top||(r.options.top=0);if(i="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",s="",r.options.url)s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+_(M(r.options.url))+") >>";else if(r.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,s+=" /FitV "+r.options.left+"]";break;case"XYZ":default:var le=u(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),s+=" /XYZ "+r.options.left+" "+le+" "+r.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),e.createAnnotation=function(n){var r=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":r.pageContext.annotations.push(n)}},e.link=function(n,r,i,s,o){var u=this.internal.getCurrentPageInfo(),f=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;u.pageContext.annotations.push({finalBounds:{x:f(n),y:d(r),w:f(n+i),h:d(r+s)},options:o,type:"link"})},e.textWithLink=function(n,r,i,s){var o,u,f=this.getTextWidth(n),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){u=s.maxWidth;var g=this.splitTextToSize(n,u).length;o=Math.ceil(d*g)}else u=f,o=d;return this.text(n,r,i,s),i+=.2*d,s.align==="center"&&(r-=f/2),s.align==="right"&&(r-=f),this.link(r,i-d,u,o,s),f},e.getTextWidth=function(n){var r=this.internal.getFontSize();return this.getStringUnitWidth(n)*r/this.internal.scaleFactor}}(kr.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(T){return t[T.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(T){return typeof T=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(T)},u=e.__arabicParser__.isArabicEndLetter=function(T){return o(T)&&s(T)&&t[T.charCodeAt(0)].length<=2},f=e.__arabicParser__.isArabicAlfLetter=function(T){return o(T)&&i.indexOf(T.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(T){return o(T)&&s(T)&&t[T.charCodeAt(0)].length>=1};var d=e.__arabicParser__.arabicLetterHasFinalForm=function(T){return o(T)&&s(T)&&t[T.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(T){return o(T)&&s(T)&&t[T.charCodeAt(0)].length>=3};var g=e.__arabicParser__.arabicLetterHasMedialForm=function(T){return o(T)&&s(T)&&t[T.charCodeAt(0)].length==4},y=e.__arabicParser__.resolveLigatures=function(T){var D=0,I=n,j="",Z=0;for(D=0;D<T.length;D+=1)I[T.charCodeAt(D)]!==void 0?(Z++,typeof(I=I[T.charCodeAt(D)])=="number"&&(j+=String.fromCharCode(I),I=n,Z=0),D===T.length-1&&(I=n,j+=T.charAt(D-(Z-1)),D-=Z-1,Z=0)):(I=n,j+=T.charAt(D-Z),D-=Z,Z=0);return j};e.__arabicParser__.isArabicDiacritic=function(T){return T!==void 0&&r[T.charCodeAt(0)]!==void 0};var x=e.__arabicParser__.getCorrectForm=function(T,D,I){return o(T)?s(T)===!1?-1:!d(T)||!o(D)&&!o(I)||!o(I)&&u(D)||u(T)&&!o(D)||u(T)&&f(D)||u(T)&&u(D)?0:g(T)&&o(D)&&!u(D)&&o(I)&&d(I)?3:u(T)||!o(I)?1:2:-1},_=function(T){var D=0,I=0,j=0,Z="",te="",ue="",le=(T=T||"").split("\\s+"),ge=[];for(D=0;D<le.length;D+=1){for(ge.push(""),I=0;I<le[D].length;I+=1)Z=le[D][I],te=le[D][I-1],ue=le[D][I+1],o(Z)?(j=x(Z,te,ue),ge[D]+=j!==-1?String.fromCharCode(t[Z.charCodeAt(0)][j]):Z):ge[D]+=Z;ge[D]=y(ge[D])}return ge.join(" ")},M=e.__arabicParser__.processArabic=e.processArabic=function(){var T,D=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,I=[];if(Array.isArray(D)){var j=0;for(I=[],j=0;j<D.length;j+=1)Array.isArray(D[j])?I.push([_(D[j][0]),D[j][1],D[j][2]]):I.push([_(D[j])]);T=I}else T=_(D);return typeof arguments[0]=="string"?T:(arguments[0].text=T,arguments[0])};e.events.push(["preProcessText",M])}(kr.API),kr.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(e){var t=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(u){n=u}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(u){r=isNaN(u)||Number.isInteger(u)===!1||u<0?150:u,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(u){i=isNaN(u)||Number.isInteger(u)===!1||u<0?300:u,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(u){s=u}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(u){o=u}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(n,r){var i;if((n=n||"2d")!=="2d")return null;for(i in r)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=r[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(kr.API),function(e){var t={left:0,top:0,bottom:0,right:0},n=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var f=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return f},set:function(T){f=T}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(T){d=T}});var g=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return g},set:function(T){g=T}});var y=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return y},set:function(T){y=T}});var x=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return x},set:function(T){x=T}});var _=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return _},set:function(T){_=T}});var M=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return M},set:function(T){M=T}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(f){return r.call(this),this.internal.__cell__.headerFunction=typeof f=="function"?f:void 0,this},e.getTextDimensions=function(f,d){r.call(this);var g=(d=d||{}).fontSize||this.getFontSize(),y=d.font||this.getFont(),x=d.scaleFactor||this.internal.scaleFactor,_=0,M=0,T=0,D=this;if(!Array.isArray(f)&&typeof f!="string"){if(typeof f!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");f=String(f)}var I=d.maxWidth;I>0?typeof f=="string"?f=this.splitTextToSize(f,I):Object.prototype.toString.call(f)==="[object Array]"&&(f=f.reduce(function(Z,te){return Z.concat(D.splitTextToSize(te,I))},[])):f=Array.isArray(f)?f:[f];for(var j=0;j<f.length;j++)_<(T=this.getStringUnitWidth(f[j],{font:y})*g)&&(_=T);return _!==0&&(M=f.length),{w:_/=x,h:Math.max((M*g*this.getLineHeightFactor()-g*(this.getLineHeightFactor()-1))/x,0)}},e.cellAddPage=function(){r.call(this),this.addPage();var f=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(f.left,f.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var f;f=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var d=this.internal.__cell__.lastCell,g=this.internal.__cell__.padding,y=this.internal.__cell__.margins||t,x=this.internal.__cell__.tableHeaderRow,_=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===f.lineNumber?(f.x=(d.x||0)+(d.width||0),f.y=d.y||0):d.y+d.height+f.height+y.bottom>this.getPageHeight()?(this.cellAddPage(),f.y=y.top,_&&x&&(this.printHeaderRow(f.lineNumber,!0),f.y+=x[0].height)):f.y=d.y+d.height||f.y),f.text[0]!==void 0&&(this.rect(f.x,f.y,f.width,f.height,n===!0?"FD":void 0),f.align==="right"?this.text(f.text,f.x+f.width-g,f.y+g,{align:"right",baseline:"top"}):f.align==="center"?this.text(f.text,f.x+f.width/2,f.y+g,{align:"center",baseline:"top",maxWidth:f.width-g-g}):this.text(f.text,f.x+g,f.y+g,{align:"left",baseline:"top",maxWidth:f.width-g-g})),this.internal.__cell__.lastCell=f,this};e.table=function(f,d,g,y,x){if(r.call(this),!g)throw new Error("No data for PDF table.");var _,M,T,D,I=[],j=[],Z=[],te={},ue={},le=[],ge=[],H=(x=x||{}).autoSize||!1,U=x.printHeaders!==!1,Q=x.css&&x.css["font-size"]!==void 0?16*x.css["font-size"]:x.fontSize||12,F=x.margins||Object.assign({width:this.getPageWidth()},t),B=typeof x.padding=="number"?x.padding:3,R=x.headerBackgroundColor||"#c8c8c8",$=x.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=U,this.internal.__cell__.margins=F,this.internal.__cell__.table_font_size=Q,this.internal.__cell__.padding=B,this.internal.__cell__.headerBackgroundColor=R,this.internal.__cell__.headerTextColor=$,this.setFontSize(Q),y==null)j=I=Object.keys(g[0]),Z=I.map(function(){return"left"});else if(Array.isArray(y)&&Xi(y[0])==="object")for(I=y.map(function(Le){return Le.name}),j=y.map(function(Le){return Le.prompt||Le.name||""}),Z=y.map(function(Le){return Le.align||"left"}),_=0;_<y.length;_+=1)ue[y[_].name]=y[_].width*(19.049976/25.4);else Array.isArray(y)&&typeof y[0]=="string"&&(j=I=y,Z=I.map(function(){return"left"}));if(H||Array.isArray(y)&&typeof y[0]=="string")for(_=0;_<I.length;_+=1){for(te[D=I[_]]=g.map(function(Le){return Le[D]}),this.setFont(void 0,"bold"),le.push(this.getTextDimensions(j[_],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),M=te[D],this.setFont(void 0,"normal"),T=0;T<M.length;T+=1)le.push(this.getTextDimensions(M[T],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);ue[D]=Math.max.apply(null,le)+B+B,le=[]}if(U){var W={};for(_=0;_<I.length;_+=1)W[I[_]]={},W[I[_]].text=j[_],W[I[_]].align=Z[_];var G=u.call(this,W,ue);ge=I.map(function(Le){return new s(f,d,ue[Le],G,W[Le].text,void 0,W[Le].align)}),this.setTableHeaderRow(ge),this.printHeaderRow(1,!1)}var J=y.reduce(function(Le,De){return Le[De.name]=De.align,Le},{});for(_=0;_<g.length;_+=1){"rowStart"in x&&x.rowStart instanceof Function&&x.rowStart({row:_,data:g[_]},this);var Y=u.call(this,g[_],ue);for(T=0;T<I.length;T+=1){var pe=g[_][I[T]];"cellStart"in x&&x.cellStart instanceof Function&&x.cellStart({row:_,col:T,data:pe},this),o.call(this,new s(f,d,ue[I[T]],Y,pe,_+2,J[I[T]]))}}return this.internal.__cell__.table_x=f,this.internal.__cell__.table_y=d,this};var u=function(f,d){var g=this.internal.__cell__.padding,y=this.internal.__cell__.table_font_size,x=this.internal.scaleFactor;return Object.keys(f).map(function(_){var M=f[_];return this.splitTextToSize(M.hasOwnProperty("text")?M.text:M,d[_]-g-g)},this).map(function(_){return this.getLineHeightFactor()*_.length*y/x+g+g},this).reduce(function(_,M){return Math.max(_,M)},0)};e.setTableHeaderRow=function(f){r.call(this),this.internal.__cell__.tableHeaderRow=f},e.printHeaderRow=function(f,d){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var g;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var y=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(y[0],y[1],y[2],y[3],void 0,-1)}this.setFont(void 0,"bold");for(var x=[],_=0;_<this.internal.__cell__.tableHeaderRow.length;_+=1){g=this.internal.__cell__.tableHeaderRow[_].clone(),d&&(g.y=this.internal.__cell__.margins.top||0,x.push(g)),g.lineNumber=f;var M=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,g),this.setTextColor(M)}x.length>0&&this.setTableHeaderRow(x),this.setFont(void 0,"normal"),n=!1}}(kr.API);var Nx={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Dx=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],C1=Tx(Dx),Ix=[100,200,300,400,500,600,700,800,900],jF=Tx(Ix);function E1(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),n=function(s){return Nx[s=s||"normal"]?s:"normal"}(e.style),r=function(s){if(!s)return 400;if(typeof s=="number")return s>=100&&s<=900&&s%100==0?s:400;if(/^\d00$/.test(s))return parseInt(s);switch(s){case"bold":return 700;case"normal":default:return 400}}(e.weight),i=function(s){return typeof C1[s=s||"normal"]=="number"?s:"normal"}(e.stretch);return{family:t,style:n,weight:r,stretch:i,src:e.src||[],ref:e.ref||{name:t,style:[i,n,r].join(" ")}}}function kb(e,t,n,r){var i;for(i=n;i>=0&&i<t.length;i+=r)if(e[t[i]])return e[t[i]];for(i=n;i>=0&&i<t.length;i-=r)if(e[t[i]])return e[t[i]]}var zF={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Tb={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Nb(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function $F(e,t,n){for(var r=(n=n||{}).defaultFontFamily||"times",i=Object.assign({},zF,n.genericFontFamilies||{}),s=null,o=null,u=0;u<t.length;++u)if(i[(s=E1(t[u])).family]&&(s.family=i[s.family]),e.hasOwnProperty(s.family)){o=e[s.family];break}if(!(o=o||e[r]))throw new Error("Could not find a font-family for the rule '"+Nb(s)+"' and default family '"+r+"'.");if(o=function(f,d){if(d[f])return d[f];var g=C1[f],y=g<=C1.normal?-1:1,x=kb(d,Dx,g,y);if(!x)throw new Error("Could not find a matching font-stretch value for "+f);return x}(s.stretch,o),o=function(f,d){if(d[f])return d[f];for(var g=Nx[f],y=0;y<g.length;++y)if(d[g[y]])return d[g[y]];throw new Error("Could not find a matching font-style for "+f)}(s.style,o),!(o=function(f,d){if(d[f])return d[f];if(f===400&&d[500])return d[500];if(f===500&&d[400])return d[400];var g=jF[f],y=kb(d,Ix,g,f<400?-1:1);if(!y)throw new Error("Could not find a matching font-weight for value "+f);return y}(s.weight,o)))throw new Error("Failed to resolve a font for the rule '"+Nb(s)+"'.");return o}function Db(e){return e.trimLeft()}function UF(e,t){for(var n=0;n<e.length;){if(e.charAt(n)===t)return[e.substring(0,n),e.substring(n+1)];n+=1}return null}function VF(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var xg,Ib,Ob,pv=["times"];(function(e){var t,n,r,i,s,o,u,f,d,g=function(N){return N=N||{},this.isStrokeTransparent=N.isStrokeTransparent||!1,this.strokeOpacity=N.strokeOpacity||1,this.strokeStyle=N.strokeStyle||"#000000",this.fillStyle=N.fillStyle||"#000000",this.isFillTransparent=N.isFillTransparent||!1,this.fillOpacity=N.fillOpacity||1,this.font=N.font||"10px sans-serif",this.textBaseline=N.textBaseline||"alphabetic",this.textAlign=N.textAlign||"left",this.lineWidth=N.lineWidth||1,this.lineJoin=N.lineJoin||"miter",this.lineCap=N.lineCap||"butt",this.path=N.path||[],this.transform=N.transform!==void 0?N.transform.clone():new f,this.globalCompositeOperation=N.globalCompositeOperation||"normal",this.globalAlpha=N.globalAlpha||1,this.clip_path=N.clip_path||[],this.currentPoint=N.currentPoint||new o,this.miterLimit=N.miterLimit||10,this.lastPoint=N.lastPoint||new o,this.lineDashOffset=N.lineDashOffset||0,this.lineDash=N.lineDash||[],this.margin=N.margin||[0,0,0,0],this.prevPageLastElemOffset=N.prevPageLastElemOffset||0,this.ignoreClearRect=typeof N.ignoreClearRect!="boolean"||N.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new y(this),t=this.internal.f2,n=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,u=this.internal.Rectangle,f=this.internal.Matrix,d=new g}]);var y=function(N){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var ee=N;Object.defineProperty(this,"pdf",{get:function(){return ee}});var fe=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return fe},set:function(ye){fe=!!ye}});var ce=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return ce},set:function(ye){ce=!!ye}});var _e=0;Object.defineProperty(this,"posX",{get:function(){return _e},set:function(ye){isNaN(ye)||(_e=ye)}});var se=0;Object.defineProperty(this,"posY",{get:function(){return se},set:function(ye){isNaN(ye)||(se=ye)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(ye){var me;typeof ye=="number"?me=[ye,ye,ye,ye]:((me=new Array(4))[0]=ye[0],me[1]=ye.length>=2?ye[1]:me[0],me[2]=ye.length>=3?ye[2]:me[0],me[3]=ye.length>=4?ye[3]:me[1]),d.margin=me}});var k=!1;Object.defineProperty(this,"autoPaging",{get:function(){return k},set:function(ye){k=ye}});var ae=0;Object.defineProperty(this,"lastBreak",{get:function(){return ae},set:function(ye){ae=ye}});var ke=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ke},set:function(ye){ke=ye}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(ye){ye instanceof g&&(d=ye)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(ye){d.path=ye}});var Pe=[];Object.defineProperty(this,"ctxStack",{get:function(){return Pe},set:function(ye){Pe=ye}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ye){var me;me=x(ye),this.ctx.fillStyle=me.style,this.ctx.isFillTransparent=me.a===0,this.ctx.fillOpacity=me.a,this.pdf.setFillColor(me.r,me.g,me.b,{a:me.a}),this.pdf.setTextColor(me.r,me.g,me.b,{a:me.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ye){var me=x(ye);this.ctx.strokeStyle=me.style,this.ctx.isStrokeTransparent=me.a===0,this.ctx.strokeOpacity=me.a,me.a===0?this.pdf.setDrawColor(255,255,255):(me.a,this.pdf.setDrawColor(me.r,me.g,me.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ye){["butt","round","square"].indexOf(ye)!==-1&&(this.ctx.lineCap=ye,this.pdf.setLineCap(ye))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ye){isNaN(ye)||(this.ctx.lineWidth=ye,this.pdf.setLineWidth(ye))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ye){["bevel","round","miter"].indexOf(ye)!==-1&&(this.ctx.lineJoin=ye,this.pdf.setLineJoin(ye))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ye){isNaN(ye)||(this.ctx.miterLimit=ye,this.pdf.setMiterLimit(ye))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ye){this.ctx.textBaseline=ye}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ye){["right","end","center","left","start"].indexOf(ye)!==-1&&(this.ctx.textAlign=ye)}});var Ge=null;function K(ye,me){if(Ge===null){var Ue=function(Qe){var Ze=[];return Object.keys(Qe).forEach(function(He){Qe[He].forEach(function(Xe){var tt=null;switch(Xe){case"bold":tt={family:He,weight:"bold"};break;case"italic":tt={family:He,style:"italic"};break;case"bolditalic":tt={family:He,weight:"bold",style:"italic"};break;case"":case"normal":tt={family:He}}tt!==null&&(tt.ref={name:He,style:Xe},Ze.push(tt))})}),Ze}(ye.getFontList());Ge=function(Qe){for(var Ze={},He=0;He<Qe.length;++He){var Xe=E1(Qe[He]),tt=Xe.family,Mt=Xe.stretch,Lt=Xe.style,jt=Xe.weight;Ze[tt]=Ze[tt]||{},Ze[tt][Mt]=Ze[tt][Mt]||{},Ze[tt][Mt][Lt]=Ze[tt][Mt][Lt]||{},Ze[tt][Mt][Lt][jt]=Xe}return Ze}(Ue.concat(me))}return Ge}var de=null;Object.defineProperty(this,"fontFaces",{get:function(){return de},set:function(ye){Ge=null,de=ye}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ye){var me;if(this.ctx.font=ye,(me=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(ye))!==null){var Ue=me[1],Qe=(me[2],me[3]),Ze=me[4],He=(me[5],me[6]),Xe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ze)[2];Ze=Math.floor(Xe==="px"?parseFloat(Ze)*this.pdf.internal.scaleFactor:Xe==="em"?parseFloat(Ze)*this.pdf.getFontSize():parseFloat(Ze)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ze);var tt=function(et){var ot,rt,Ht=[],Qt=et.trim();if(Qt==="")return pv;if(Qt in Tb)return[Tb[Qt]];for(;Qt!=="";){switch(rt=null,ot=(Qt=Db(Qt)).charAt(0)){case'"':case"'":rt=UF(Qt.substring(1),ot);break;default:rt=VF(Qt)}if(rt===null||(Ht.push(rt[0]),(Qt=Db(rt[1]))!==""&&Qt.charAt(0)!==","))return pv;Qt=Qt.replace(/^,/,"")}return Ht}(He);if(this.fontFaces){var Mt=$F(K(this.pdf,this.fontFaces),tt.map(function(et){return{family:et,stretch:"normal",weight:Qe,style:Ue}}));this.pdf.setFont(Mt.ref.name,Mt.ref.style)}else{var Lt="";(Qe==="bold"||parseInt(Qe,10)>=700||Ue==="bold")&&(Lt="bold"),Ue==="italic"&&(Lt+="italic"),Lt.length===0&&(Lt="normal");for(var jt="",zt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},sn=0;sn<tt.length;sn++){if(this.pdf.internal.getFont(tt[sn],Lt,{noFallback:!0,disableWarning:!0})!==void 0){jt=tt[sn];break}if(Lt==="bolditalic"&&this.pdf.internal.getFont(tt[sn],"bold",{noFallback:!0,disableWarning:!0})!==void 0)jt=tt[sn],Lt="bold";else if(this.pdf.internal.getFont(tt[sn],"normal",{noFallback:!0,disableWarning:!0})!==void 0){jt=tt[sn],Lt="normal";break}}if(jt===""){for(var pn=0;pn<tt.length;pn++)if(zt[tt[pn]]){jt=zt[tt[pn]];break}}jt=jt===""?"Times":jt,this.pdf.setFont(jt,Lt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ye){this.ctx.globalCompositeOperation=ye}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ye){this.ctx.globalAlpha=ye}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ye){this.ctx.lineDashOffset=ye,De.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ye){this.ctx.lineDash=ye,De.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ye){this.ctx.ignoreClearRect=!!ye}})};y.prototype.setLineDash=function(N){this.lineDash=N},y.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},y.prototype.fill=function(){te.call(this,"fill",!1)},y.prototype.stroke=function(){te.call(this,"stroke",!1)},y.prototype.beginPath=function(){this.path=[{type:"begin"}]},y.prototype.moveTo=function(N,ee){if(isNaN(N)||isNaN(ee))throw lo.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var fe=this.ctx.transform.applyToPoint(new o(N,ee));this.path.push({type:"mt",x:fe.x,y:fe.y}),this.ctx.lastPoint=new o(N,ee)},y.prototype.closePath=function(){var N=new o(0,0),ee=0;for(ee=this.path.length-1;ee!==-1;ee--)if(this.path[ee].type==="begin"&&Xi(this.path[ee+1])==="object"&&typeof this.path[ee+1].x=="number"){N=new o(this.path[ee+1].x,this.path[ee+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(N.x,N.y)},y.prototype.lineTo=function(N,ee){if(isNaN(N)||isNaN(ee))throw lo.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var fe=this.ctx.transform.applyToPoint(new o(N,ee));this.path.push({type:"lt",x:fe.x,y:fe.y}),this.ctx.lastPoint=new o(fe.x,fe.y)},y.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),te.call(this,null,!0)},y.prototype.quadraticCurveTo=function(N,ee,fe,ce){if(isNaN(fe)||isNaN(ce)||isNaN(N)||isNaN(ee))throw lo.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var _e=this.ctx.transform.applyToPoint(new o(fe,ce)),se=this.ctx.transform.applyToPoint(new o(N,ee));this.path.push({type:"qct",x1:se.x,y1:se.y,x:_e.x,y:_e.y}),this.ctx.lastPoint=new o(_e.x,_e.y)},y.prototype.bezierCurveTo=function(N,ee,fe,ce,_e,se){if(isNaN(_e)||isNaN(se)||isNaN(N)||isNaN(ee)||isNaN(fe)||isNaN(ce))throw lo.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var k=this.ctx.transform.applyToPoint(new o(_e,se)),ae=this.ctx.transform.applyToPoint(new o(N,ee)),ke=this.ctx.transform.applyToPoint(new o(fe,ce));this.path.push({type:"bct",x1:ae.x,y1:ae.y,x2:ke.x,y2:ke.y,x:k.x,y:k.y}),this.ctx.lastPoint=new o(k.x,k.y)},y.prototype.arc=function(N,ee,fe,ce,_e,se){if(isNaN(N)||isNaN(ee)||isNaN(fe)||isNaN(ce)||isNaN(_e))throw lo.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(se=!!se,!this.ctx.transform.isIdentity){var k=this.ctx.transform.applyToPoint(new o(N,ee));N=k.x,ee=k.y;var ae=this.ctx.transform.applyToPoint(new o(0,fe)),ke=this.ctx.transform.applyToPoint(new o(0,0));fe=Math.sqrt(Math.pow(ae.x-ke.x,2)+Math.pow(ae.y-ke.y,2))}Math.abs(_e-ce)>=2*Math.PI&&(ce=0,_e=2*Math.PI),this.path.push({type:"arc",x:N,y:ee,radius:fe,startAngle:ce,endAngle:_e,counterclockwise:se})},y.prototype.arcTo=function(N,ee,fe,ce,_e){throw new Error("arcTo not implemented.")},y.prototype.rect=function(N,ee,fe,ce){if(isNaN(N)||isNaN(ee)||isNaN(fe)||isNaN(ce))throw lo.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(N,ee),this.lineTo(N+fe,ee),this.lineTo(N+fe,ee+ce),this.lineTo(N,ee+ce),this.lineTo(N,ee),this.lineTo(N+fe,ee),this.lineTo(N,ee)},y.prototype.fillRect=function(N,ee,fe,ce){if(isNaN(N)||isNaN(ee)||isNaN(fe)||isNaN(ce))throw lo.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!_.call(this)){var _e={};this.lineCap!=="butt"&&(_e.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(_e.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(N,ee,fe,ce),this.fill(),_e.hasOwnProperty("lineCap")&&(this.lineCap=_e.lineCap),_e.hasOwnProperty("lineJoin")&&(this.lineJoin=_e.lineJoin)}},y.prototype.strokeRect=function(N,ee,fe,ce){if(isNaN(N)||isNaN(ee)||isNaN(fe)||isNaN(ce))throw lo.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");M.call(this)||(this.beginPath(),this.rect(N,ee,fe,ce),this.stroke())},y.prototype.clearRect=function(N,ee,fe,ce){if(isNaN(N)||isNaN(ee)||isNaN(fe)||isNaN(ce))throw lo.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(N,ee,fe,ce))},y.prototype.save=function(N){N=typeof N!="boolean"||N;for(var ee=this.pdf.internal.getCurrentPageInfo().pageNumber,fe=0;fe<this.pdf.internal.getNumberOfPages();fe++)this.pdf.setPage(fe+1),this.pdf.internal.out("q");if(this.pdf.setPage(ee),N){this.ctx.fontSize=this.pdf.internal.getFontSize();var ce=new g(this.ctx);this.ctxStack.push(this.ctx),this.ctx=ce}},y.prototype.restore=function(N){N=typeof N!="boolean"||N;for(var ee=this.pdf.internal.getCurrentPageInfo().pageNumber,fe=0;fe<this.pdf.internal.getNumberOfPages();fe++)this.pdf.setPage(fe+1),this.pdf.internal.out("Q");this.pdf.setPage(ee),N&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},y.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var x=function(N){var ee,fe,ce,_e;if(N.isCanvasGradient===!0&&(N=N.getColor()),!N)return{r:0,g:0,b:0,a:0,style:N};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(N))ee=0,fe=0,ce=0,_e=0;else{var se=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(N);if(se!==null)ee=parseInt(se[1]),fe=parseInt(se[2]),ce=parseInt(se[3]),_e=1;else if((se=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(N))!==null)ee=parseInt(se[1]),fe=parseInt(se[2]),ce=parseInt(se[3]),_e=parseFloat(se[4]);else{if(_e=1,typeof N=="string"&&N.charAt(0)!=="#"){var k=new Cx(N);N=k.ok?k.toHex():"#000000"}N.length===4?(ee=N.substring(1,2),ee+=ee,fe=N.substring(2,3),fe+=fe,ce=N.substring(3,4),ce+=ce):(ee=N.substring(1,3),fe=N.substring(3,5),ce=N.substring(5,7)),ee=parseInt(ee,16),fe=parseInt(fe,16),ce=parseInt(ce,16)}}return{r:ee,g:fe,b:ce,a:_e,style:N}},_=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},M=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};y.prototype.fillText=function(N,ee,fe,ce){if(isNaN(ee)||isNaN(fe)||typeof N!="string")throw lo.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(ce=isNaN(ce)?void 0:ce,!_.call(this)){var _e=Y(this.ctx.transform.rotation),se=this.ctx.transform.scaleX;B.call(this,{text:N,x:ee,y:fe,scale:se,angle:_e,align:this.textAlign,maxWidth:ce})}},y.prototype.strokeText=function(N,ee,fe,ce){if(isNaN(ee)||isNaN(fe)||typeof N!="string")throw lo.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!M.call(this)){ce=isNaN(ce)?void 0:ce;var _e=Y(this.ctx.transform.rotation),se=this.ctx.transform.scaleX;B.call(this,{text:N,x:ee,y:fe,scale:se,renderingMode:"stroke",angle:_e,align:this.textAlign,maxWidth:ce})}},y.prototype.measureText=function(N){if(typeof N!="string")throw lo.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var ee=this.pdf,fe=this.pdf.internal.scaleFactor,ce=ee.internal.getFontSize(),_e=ee.getStringUnitWidth(N)*ce/ee.internal.scaleFactor,se=function(k){var ae=(k=k||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ae}}),this};return new se({width:_e*=Math.round(96*fe/72*1e4)/1e4})},y.prototype.scale=function(N,ee){if(isNaN(N)||isNaN(ee))throw lo.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var fe=new f(N,0,0,ee,0,0);this.ctx.transform=this.ctx.transform.multiply(fe)},y.prototype.rotate=function(N){if(isNaN(N))throw lo.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var ee=new f(Math.cos(N),Math.sin(N),-Math.sin(N),Math.cos(N),0,0);this.ctx.transform=this.ctx.transform.multiply(ee)},y.prototype.translate=function(N,ee){if(isNaN(N)||isNaN(ee))throw lo.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var fe=new f(1,0,0,1,N,ee);this.ctx.transform=this.ctx.transform.multiply(fe)},y.prototype.transform=function(N,ee,fe,ce,_e,se){if(isNaN(N)||isNaN(ee)||isNaN(fe)||isNaN(ce)||isNaN(_e)||isNaN(se))throw lo.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var k=new f(N,ee,fe,ce,_e,se);this.ctx.transform=this.ctx.transform.multiply(k)},y.prototype.setTransform=function(N,ee,fe,ce,_e,se){N=isNaN(N)?1:N,ee=isNaN(ee)?0:ee,fe=isNaN(fe)?0:fe,ce=isNaN(ce)?1:ce,_e=isNaN(_e)?0:_e,se=isNaN(se)?0:se,this.ctx.transform=new f(N,ee,fe,ce,_e,se)};var T=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};y.prototype.drawImage=function(N,ee,fe,ce,_e,se,k,ae,ke){var Pe=this.pdf.getImageProperties(N),Ge=1,K=1,de=1,ye=1;ce!==void 0&&ae!==void 0&&(de=ae/ce,ye=ke/_e,Ge=Pe.width/ce*ae/ce,K=Pe.height/_e*ke/_e),se===void 0&&(se=ee,k=fe,ee=0,fe=0),ce!==void 0&&ae===void 0&&(ae=ce,ke=_e),ce===void 0&&ae===void 0&&(ae=Pe.width,ke=Pe.height);for(var me,Ue=this.ctx.transform.decompose(),Qe=Y(Ue.rotate.shx),Ze=new f,He=(Ze=(Ze=(Ze=Ze.multiply(Ue.translate)).multiply(Ue.skew)).multiply(Ue.scale)).applyToRectangle(new u(se-ee*de,k-fe*ye,ce*Ge,_e*K)),Xe=D.call(this,He),tt=[],Mt=0;Mt<Xe.length;Mt+=1)tt.indexOf(Xe[Mt])===-1&&tt.push(Xe[Mt]);if(Z(tt),this.autoPaging)for(var Lt=tt[0],jt=tt[tt.length-1],zt=Lt;zt<jt+1;zt++){this.pdf.setPage(zt);var sn=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],pn=zt===1?this.posY+this.margin[0]:this.margin[0],et=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ot=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],rt=zt===1?0:et+(zt-2)*ot;if(this.ctx.clip_path.length!==0){var Ht=this.path;me=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=j(me,this.posX+this.margin[3],-rt+pn+this.ctx.prevPageLastElemOffset),ue.call(this,"fill",!0),this.path=Ht}var Qt=JSON.parse(JSON.stringify(He));Qt=j([Qt],this.posX+this.margin[3],-rt+pn+this.ctx.prevPageLastElemOffset)[0];var On=(zt>Lt||zt<jt)&&T.call(this);On&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],sn,ot,null).clip().discardPath()),this.pdf.addImage(N,"JPEG",Qt.x,Qt.y,Qt.w,Qt.h,null,null,Qe),On&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(N,"JPEG",He.x,He.y,He.w,He.h,null,null,Qe)};var D=function(N,ee,fe){var ce=[];ee=ee||this.pdf.internal.pageSize.width,fe=fe||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var _e=this.posY+this.ctx.prevPageLastElemOffset;switch(N.type){default:case"mt":case"lt":ce.push(Math.floor((N.y+_e)/fe)+1);break;case"arc":ce.push(Math.floor((N.y+_e-N.radius)/fe)+1),ce.push(Math.floor((N.y+_e+N.radius)/fe)+1);break;case"qct":var se=pe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,N.x1,N.y1,N.x,N.y);ce.push(Math.floor((se.y+_e)/fe)+1),ce.push(Math.floor((se.y+se.h+_e)/fe)+1);break;case"bct":var k=Le(this.ctx.lastPoint.x,this.ctx.lastPoint.y,N.x1,N.y1,N.x2,N.y2,N.x,N.y);ce.push(Math.floor((k.y+_e)/fe)+1),ce.push(Math.floor((k.y+k.h+_e)/fe)+1);break;case"rect":ce.push(Math.floor((N.y+_e)/fe)+1),ce.push(Math.floor((N.y+N.h+_e)/fe)+1)}for(var ae=0;ae<ce.length;ae+=1)for(;this.pdf.internal.getNumberOfPages()<ce[ae];)I.call(this);return ce},I=function(){var N=this.fillStyle,ee=this.strokeStyle,fe=this.font,ce=this.lineCap,_e=this.lineWidth,se=this.lineJoin;this.pdf.addPage(),this.fillStyle=N,this.strokeStyle=ee,this.font=fe,this.lineCap=ce,this.lineWidth=_e,this.lineJoin=se},j=function(N,ee,fe){for(var ce=0;ce<N.length;ce++)switch(N[ce].type){case"bct":N[ce].x2+=ee,N[ce].y2+=fe;case"qct":N[ce].x1+=ee,N[ce].y1+=fe;case"mt":case"lt":case"arc":default:N[ce].x+=ee,N[ce].y+=fe}return N},Z=function(N){return N.sort(function(ee,fe){return ee-fe})},te=function(N,ee){for(var fe,ce,_e=this.fillStyle,se=this.strokeStyle,k=this.lineCap,ae=this.lineWidth,ke=Math.abs(ae*this.ctx.transform.scaleX),Pe=this.lineJoin,Ge=JSON.parse(JSON.stringify(this.path)),K=JSON.parse(JSON.stringify(this.path)),de=[],ye=0;ye<K.length;ye++)if(K[ye].x!==void 0)for(var me=D.call(this,K[ye]),Ue=0;Ue<me.length;Ue+=1)de.indexOf(me[Ue])===-1&&de.push(me[Ue]);for(var Qe=0;Qe<de.length;Qe++)for(;this.pdf.internal.getNumberOfPages()<de[Qe];)I.call(this);if(Z(de),this.autoPaging)for(var Ze=de[0],He=de[de.length-1],Xe=Ze;Xe<He+1;Xe++){this.pdf.setPage(Xe),this.fillStyle=_e,this.strokeStyle=se,this.lineCap=k,this.lineWidth=ke,this.lineJoin=Pe;var tt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Mt=Xe===1?this.posY+this.margin[0]:this.margin[0],Lt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],jt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],zt=Xe===1?0:Lt+(Xe-2)*jt;if(this.ctx.clip_path.length!==0){var sn=this.path;fe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=j(fe,this.posX+this.margin[3],-zt+Mt+this.ctx.prevPageLastElemOffset),ue.call(this,N,!0),this.path=sn}if(ce=JSON.parse(JSON.stringify(Ge)),this.path=j(ce,this.posX+this.margin[3],-zt+Mt+this.ctx.prevPageLastElemOffset),ee===!1||Xe===0){var pn=(Xe>Ze||Xe<He)&&T.call(this);pn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],tt,jt,null).clip().discardPath()),ue.call(this,N,ee),pn&&this.pdf.restoreGraphicsState()}this.lineWidth=ae}else this.lineWidth=ke,ue.call(this,N,ee),this.lineWidth=ae;this.path=Ge},ue=function(N,ee){if((N!=="stroke"||ee||!M.call(this))&&(N==="stroke"||ee||!_.call(this))){for(var fe,ce,_e=[],se=this.path,k=0;k<se.length;k++){var ae=se[k];switch(ae.type){case"begin":_e.push({begin:!0});break;case"close":_e.push({close:!0});break;case"mt":_e.push({start:ae,deltas:[],abs:[]});break;case"lt":var ke=_e.length;if(se[k-1]&&!isNaN(se[k-1].x)&&(fe=[ae.x-se[k-1].x,ae.y-se[k-1].y],ke>0)){for(;ke>=0;ke--)if(_e[ke-1].close!==!0&&_e[ke-1].begin!==!0){_e[ke-1].deltas.push(fe),_e[ke-1].abs.push(ae);break}}break;case"bct":fe=[ae.x1-se[k-1].x,ae.y1-se[k-1].y,ae.x2-se[k-1].x,ae.y2-se[k-1].y,ae.x-se[k-1].x,ae.y-se[k-1].y],_e[_e.length-1].deltas.push(fe);break;case"qct":var Pe=se[k-1].x+2/3*(ae.x1-se[k-1].x),Ge=se[k-1].y+2/3*(ae.y1-se[k-1].y),K=ae.x+2/3*(ae.x1-ae.x),de=ae.y+2/3*(ae.y1-ae.y),ye=ae.x,me=ae.y;fe=[Pe-se[k-1].x,Ge-se[k-1].y,K-se[k-1].x,de-se[k-1].y,ye-se[k-1].x,me-se[k-1].y],_e[_e.length-1].deltas.push(fe);break;case"arc":_e.push({deltas:[],abs:[],arc:!0}),Array.isArray(_e[_e.length-1].abs)&&_e[_e.length-1].abs.push(ae)}}ce=ee?null:N==="stroke"?"stroke":"fill";for(var Ue=!1,Qe=0;Qe<_e.length;Qe++)if(_e[Qe].arc)for(var Ze=_e[Qe].abs,He=0;He<Ze.length;He++){var Xe=Ze[He];Xe.type==="arc"?H.call(this,Xe.x,Xe.y,Xe.radius,Xe.startAngle,Xe.endAngle,Xe.counterclockwise,void 0,ee,!Ue):R.call(this,Xe.x,Xe.y),Ue=!0}else if(_e[Qe].close===!0)this.pdf.internal.out("h"),Ue=!1;else if(_e[Qe].begin!==!0){var tt=_e[Qe].start.x,Mt=_e[Qe].start.y;$.call(this,_e[Qe].deltas,tt,Mt),Ue=!0}ce&&U.call(this,ce),ee&&Q.call(this)}},le=function(N){var ee=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,fe=ee*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return N-fe;case"top":return N+ee-fe;case"hanging":return N+ee-2*fe;case"middle":return N+ee/2-fe;case"ideographic":return N;case"alphabetic":default:return N}},ge=function(N){return N+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};y.prototype.createLinearGradient=function(){var N=function(){};return N.colorStops=[],N.addColorStop=function(ee,fe){this.colorStops.push([ee,fe])},N.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},N.isCanvasGradient=!0,N},y.prototype.createPattern=function(){return this.createLinearGradient()},y.prototype.createRadialGradient=function(){return this.createLinearGradient()};var H=function(N,ee,fe,ce,_e,se,k,ae,ke){for(var Pe=G.call(this,fe,ce,_e,se),Ge=0;Ge<Pe.length;Ge++){var K=Pe[Ge];Ge===0&&(ke?F.call(this,K.x1+N,K.y1+ee):R.call(this,K.x1+N,K.y1+ee)),W.call(this,N,ee,K.x2,K.y2,K.x3,K.y3,K.x4,K.y4)}ae?Q.call(this):U.call(this,k)},U=function(N){switch(N){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},Q=function(){this.pdf.clip(),this.pdf.discardPath()},F=function(N,ee){this.pdf.internal.out(n(N)+" "+r(ee)+" m")},B=function(N){var ee;switch(N.align){case"right":case"end":ee="right";break;case"center":ee="center";break;case"left":case"start":default:ee="left"}var fe=this.pdf.getTextDimensions(N.text),ce=le.call(this,N.y),_e=ge.call(this,ce)-fe.h,se=this.ctx.transform.applyToPoint(new o(N.x,ce)),k=this.ctx.transform.decompose(),ae=new f;ae=(ae=(ae=ae.multiply(k.translate)).multiply(k.skew)).multiply(k.scale);for(var ke,Pe,Ge,K=this.ctx.transform.applyToRectangle(new u(N.x,ce,fe.w,fe.h)),de=ae.applyToRectangle(new u(N.x,_e,fe.w,fe.h)),ye=D.call(this,de),me=[],Ue=0;Ue<ye.length;Ue+=1)me.indexOf(ye[Ue])===-1&&me.push(ye[Ue]);if(Z(me),this.autoPaging)for(var Qe=me[0],Ze=me[me.length-1],He=Qe;He<Ze+1;He++){this.pdf.setPage(He);var Xe=He===1?this.posY+this.margin[0]:this.margin[0],tt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Mt=this.pdf.internal.pageSize.height-this.margin[2],Lt=Mt-this.margin[0],jt=this.pdf.internal.pageSize.width-this.margin[1],zt=jt-this.margin[3],sn=He===1?0:tt+(He-2)*Lt;if(this.ctx.clip_path.length!==0){var pn=this.path;ke=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=j(ke,this.posX+this.margin[3],-1*sn+Xe),ue.call(this,"fill",!0),this.path=pn}var et=j([JSON.parse(JSON.stringify(de))],this.posX+this.margin[3],-sn+Xe+this.ctx.prevPageLastElemOffset)[0];N.scale>=.01&&(Pe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Pe*N.scale),Ge=this.lineWidth,this.lineWidth=Ge*N.scale);var ot=this.autoPaging!=="text";if(ot||et.y+et.h<=Mt){if(ot||et.y>=Xe&&et.x<=jt){var rt=ot?N.text:this.pdf.splitTextToSize(N.text,N.maxWidth||jt-et.x)[0],Ht=j([JSON.parse(JSON.stringify(K))],this.posX+this.margin[3],-sn+Xe+this.ctx.prevPageLastElemOffset)[0],Qt=ot&&(He>Qe||He<Ze)&&T.call(this);Qt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],zt,Lt,null).clip().discardPath()),this.pdf.text(rt,Ht.x,Ht.y,{angle:N.angle,align:ee,renderingMode:N.renderingMode}),Qt&&this.pdf.restoreGraphicsState()}}else et.y<Mt&&(this.ctx.prevPageLastElemOffset+=Mt-et.y);N.scale>=.01&&(this.pdf.setFontSize(Pe),this.lineWidth=Ge)}else N.scale>=.01&&(Pe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Pe*N.scale),Ge=this.lineWidth,this.lineWidth=Ge*N.scale),this.pdf.text(N.text,se.x+this.posX,se.y+this.posY,{angle:N.angle,align:ee,renderingMode:N.renderingMode,maxWidth:N.maxWidth}),N.scale>=.01&&(this.pdf.setFontSize(Pe),this.lineWidth=Ge)},R=function(N,ee,fe,ce){fe=fe||0,ce=ce||0,this.pdf.internal.out(n(N+fe)+" "+r(ee+ce)+" l")},$=function(N,ee,fe){return this.pdf.lines(N,ee,fe,null,null)},W=function(N,ee,fe,ce,_e,se,k,ae){this.pdf.internal.out([t(i(fe+N)),t(s(ce+ee)),t(i(_e+N)),t(s(se+ee)),t(i(k+N)),t(s(ae+ee)),"c"].join(" "))},G=function(N,ee,fe,ce){for(var _e=2*Math.PI,se=Math.PI/2;ee>fe;)ee-=_e;var k=Math.abs(fe-ee);k<_e&&ce&&(k=_e-k);for(var ae=[],ke=ce?-1:1,Pe=ee;k>1e-5;){var Ge=Pe+ke*Math.min(k,se);ae.push(J.call(this,N,Pe,Ge)),k-=Math.abs(Ge-Pe),Pe=Ge}return ae},J=function(N,ee,fe){var ce=(fe-ee)/2,_e=N*Math.cos(ce),se=N*Math.sin(ce),k=_e,ae=-se,ke=k*k+ae*ae,Pe=ke+k*_e+ae*se,Ge=4/3*(Math.sqrt(2*ke*Pe)-Pe)/(k*se-ae*_e),K=k-Ge*ae,de=ae+Ge*k,ye=K,me=-de,Ue=ce+ee,Qe=Math.cos(Ue),Ze=Math.sin(Ue);return{x1:N*Math.cos(ee),y1:N*Math.sin(ee),x2:K*Qe-de*Ze,y2:K*Ze+de*Qe,x3:ye*Qe-me*Ze,y3:ye*Ze+me*Qe,x4:N*Math.cos(fe),y4:N*Math.sin(fe)}},Y=function(N){return 180*N/Math.PI},pe=function(N,ee,fe,ce,_e,se){var k=N+.5*(fe-N),ae=ee+.5*(ce-ee),ke=_e+.5*(fe-_e),Pe=se+.5*(ce-se),Ge=Math.min(N,_e,k,ke),K=Math.max(N,_e,k,ke),de=Math.min(ee,se,ae,Pe),ye=Math.max(ee,se,ae,Pe);return new u(Ge,de,K-Ge,ye-de)},Le=function(N,ee,fe,ce,_e,se,k,ae){var ke,Pe,Ge,K,de,ye,me,Ue,Qe,Ze,He,Xe,tt,Mt,Lt=fe-N,jt=ce-ee,zt=_e-fe,sn=se-ce,pn=k-_e,et=ae-se;for(Pe=0;Pe<41;Pe++)Qe=(me=(Ge=N+(ke=Pe/40)*Lt)+ke*((de=fe+ke*zt)-Ge))+ke*(de+ke*(_e+ke*pn-de)-me),Ze=(Ue=(K=ee+ke*jt)+ke*((ye=ce+ke*sn)-K))+ke*(ye+ke*(se+ke*et-ye)-Ue),Pe==0?(He=Qe,Xe=Ze,tt=Qe,Mt=Ze):(He=Math.min(He,Qe),Xe=Math.min(Xe,Ze),tt=Math.max(tt,Qe),Mt=Math.max(Mt,Ze));return new u(Math.round(He),Math.round(Xe),Math.round(tt-He),Math.round(Mt-Xe))},De=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var N,ee,fe=(N=this.ctx.lineDash,ee=this.ctx.lineDashOffset,JSON.stringify({lineDash:N,lineDashOffset:ee}));this.prevLineDash!==fe&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=fe)}}})(kr.API),function(e){var t=function(s){var o,u,f,d,g,y,x,_,M,T;for(u=[],f=0,d=(s+=o="\0\0\0\0".slice(s.length%4||4)).length;d>f;f+=4)(g=(s.charCodeAt(f)<<24)+(s.charCodeAt(f+1)<<16)+(s.charCodeAt(f+2)<<8)+s.charCodeAt(f+3))!==0?(y=(g=((g=((g=((g=(g-(T=g%85))/85)-(M=g%85))/85)-(_=g%85))/85)-(x=g%85))/85)%85,u.push(y+33,x+33,_+33,M+33,T+33)):u.push(122);return function(D,I){for(var j=I;j>0;j--)D.pop()}(u,o.length),String.fromCharCode.apply(String,u)+"~>"},n=function(s){var o,u,f,d,g,y=String,x="length",_=255,M="charCodeAt",T="slice",D="replace";for(s[T](-2),s=s[T](0,-2)[D](/\s/g,"")[D]("z","!!!!!"),f=[],d=0,g=(s+=o="uuuuu"[T](s[x]%5||5))[x];g>d;d+=5)u=52200625*(s[M](d)-33)+614125*(s[M](d+1)-33)+7225*(s[M](d+2)-33)+85*(s[M](d+3)-33)+(s[M](d+4)-33),f.push(_&u>>24,_&u>>16,_&u>>8,_&u);return function(I,j){for(var Z=j;Z>0;Z--)I.pop()}(f,o[x]),y.fromCharCode.apply(y,f)},r=function(s){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),o.test(s)===!1)return"";for(var u="",f=0;f<s.length;f+=2)u+=String.fromCharCode("0x"+(s[f]+s[f+1]));return u},i=function(s){for(var o=new Uint8Array(s.length),u=s.length;u--;)o[u]=s.charCodeAt(u);return s=(o=b1(o)).reduce(function(f,d){return f+String.fromCharCode(d)},"")};e.processDataByFilters=function(s,o){var u=0,f=s||"",d=[];for(typeof(o=o||[])=="string"&&(o=[o]),u=0;u<o.length;u+=1)switch(o[u]){case"ASCII85Decode":case"/ASCII85Decode":f=n(f),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":f=t(f),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":f=r(f),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":f=f.split("").map(function(g){return("0"+g.charCodeAt().toString(16)).slice(-2)}).join("")+">",d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":f=i(f),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[u]+'" is not implemented')}return{data:f,reverseChain:d.reverse().join(" ")}}}(kr.API),function(e){e.loadFile=function(t,n,r){return function(i,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var u=void 0;try{u=function(f,d,g){var y=new XMLHttpRequest,x=0,_=function(M){var T=M.length,D=[],I=String.fromCharCode;for(x=0;x<T;x+=1)D.push(I(255&M.charCodeAt(x)));return D.join("")};if(y.open("GET",f,!d),y.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(y.onload=function(){y.status===200?g(_(this.responseText)):g(void 0)}),y.send(null),d&&y.status===200)return _(y.responseText)}(i,s,o)}catch{}return u}(t,n,r)},e.loadImageFile=e.loadFile}(kr.API),function(e){function t(){return(Ir.html2canvas?Promise.resolve(Ir.html2canvas):zc(()=>import("./html2canvas.esm.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function n(){return(Ir.DOMPurify?Promise.resolve(Ir.DOMPurify):zc(()=>import("./purify.es.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var r=function(o){var u=Xi(o);return u==="undefined"?"undefined":u==="string"||o instanceof String?"string":u==="number"||o instanceof Number?"number":u==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":u==="object"?"object":"unknown"},i=function(o,u){var f=document.createElement(o);for(var d in u.className&&(f.className=u.className),u.innerHTML&&u.dompurify&&(f.innerHTML=u.dompurify.sanitize(u.innerHTML)),u.style)f.style[d]=u.style[d];return f},s=function o(u){var f=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),d=o.convert(Promise.resolve(),f);return d=(d=d.setProgress(1,o,1,[o])).set(u)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(o,u){return o.__proto__=u||s.prototype,o},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(o,u){return this.then(function(){switch(u=u||function(f){switch(r(f)){case"string":return"string";case"element":return f.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o)){case"string":return this.then(n).then(function(f){return this.set({src:i("div",{innerHTML:o,dompurify:f})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},s.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},u=function f(d,g){for(var y=d.nodeType===3?document.createTextNode(d.nodeValue):d.cloneNode(!1),x=d.firstChild;x;x=x.nextSibling)g!==!0&&x.nodeType===1&&x.nodeName==="SCRIPT"||y.appendChild(f(x,g));return d.nodeType===1&&(d.nodeName==="CANVAS"?(y.width=d.width,y.height=d.height,y.getContext("2d").drawImage(d,0,0)):d.nodeName!=="TEXTAREA"&&d.nodeName!=="SELECT"||(y.value=d.value),y.addEventListener("load",function(){y.scrollTop=d.scrollTop,y.scrollLeft=d.scrollLeft},!0)),y}(this.prop.src,this.opt.html2canvas.javascriptEnabled);u.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(u),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(u){var f=Object.assign({},this.opt.html2canvas);return delete f.onrendered,u(this.prop.container,f)}).then(function(u){(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(u){var f=this.opt.jsPDF,d=this.opt.fontFaces,g=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,y=Object.assign({async:!0,allowTaint:!0,scale:g,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete y.onrendered,f.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,f.context2d.posX=this.opt.x,f.context2d.posY=this.opt.y,f.context2d.margin=this.opt.margin,f.context2d.fontFaces=d,d)for(var x=0;x<d.length;++x){var _=d[x],M=_.src.find(function(T){return T.format==="truetype"});M&&f.addFont(M.url,_.ref.name,_.ref.style)}return y.windowHeight=y.windowHeight||0,y.windowHeight=y.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):y.windowHeight,f.context2d.save(!0),u(this.prop.container,y)}).then(function(u){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(o,u,f){return(f=f||"pdf").toLowerCase()==="img"||f.toLowerCase()==="image"?this.outputImg(o,u):this.outputPdf(o,u)},s.prototype.outputPdf=function(o,u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,u)})},s.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},s.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(o){if(r(o)!=="object")return this;var u=Object.keys(o||{}).map(function(f){if(f in s.template.prop)return function(){this.prop[f]=o[f]};switch(f){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[f]=o[f]}}},this);return this.then(function(){return this.thenList(u)})},s.prototype.get=function(o,u){return this.then(function(){var f=o in s.template.prop?this.prop[o]:this.opt[o];return u?u(f):f})},s.prototype.setMargin=function(o){return this.then(function(){switch(r(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},s.prototype.setPageSize=function(o){function u(f,d){return Math.floor(f*d/72*96)}return this.then(function(){(o=o||kr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:u(o.inner.width,o.k),height:u(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},s.prototype.setProgress=function(o,u,f,d){return o!=null&&(this.progress.val=o),u!=null&&(this.progress.state=u),f!=null&&(this.progress.n=f),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(o,u,f,d){return this.setProgress(o?this.progress.val+o:null,u||null,f?this.progress.n+f:null,d?this.progress.stack.concat(d):null)},s.prototype.then=function(o,u){var f=this;return this.thenCore(o,u,function(d,g){return f.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(y){return f.updateProgress(null,d),y}).then(d,g).then(function(y){return f.updateProgress(1),y})})},s.prototype.thenCore=function(o,u,f){f=f||Promise.prototype.then,o&&(o=o.bind(this)),u&&(u=u.bind(this));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:s.convert(Object.assign({},this),Promise.prototype),g=f.call(d,o,u);return s.convert(g,this.__proto__)},s.prototype.thenExternal=function(o,u){return Promise.prototype.then.call(this,o,u)},s.prototype.thenList=function(o){var u=this;return o.forEach(function(f){u=u.thenCore(f)}),u},s.prototype.catch=function(o){o&&(o=o.bind(this));var u=Promise.prototype.catch.call(this,o);return s.convert(u,this)},s.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},s.prototype.error=function(o){return this.then(function(){throw new Error(o)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,kr.getPageSize=function(o,u,f){if(Xi(o)==="object"){var d=o;o=d.orientation,u=d.unit||u,f=d.format||f}u=u||"mm",f=f||"a4",o=(""+(o||"P")).toLowerCase();var g,y=(""+f).toLowerCase(),x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(u){case"pt":g=1;break;case"mm":g=72/25.4;break;case"cm":g=72/2.54;break;case"in":g=72;break;case"px":g=.75;break;case"pc":case"em":g=12;break;case"ex":g=6;break;default:throw"Invalid unit: "+u}var _,M=0,T=0;if(x.hasOwnProperty(y))M=x[y][1]/g,T=x[y][0]/g;else try{M=f[1],T=f[0]}catch{throw new Error("Invalid format: "+f)}if(o==="p"||o==="portrait")o="p",T>M&&(_=T,T=M,M=_);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",M>T&&(_=T,T=M,M=_)}return{width:T,height:M,unit:u,k:g,orientation:o}},e.html=function(o,u){(u=u||{}).callback=u.callback||function(){},u.html2canvas=u.html2canvas||{},u.html2canvas.canvas=u.html2canvas.canvas||this.canvas,u.jsPDF=u.jsPDF||this,u.fontFaces=u.fontFaces?u.fontFaces.map(E1):null;var f=new s(u);return u.worker?f:f.from(o).doCallback()}}(kr.API),kr.API.addJS=function(e){return Ob=e,this.internal.events.subscribe("postPutResources",function(){xg=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(xg+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Ib=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Ob+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){xg!==void 0&&Ib!==void 0&&this.internal.out("/Names <</JavaScript "+xg+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var n=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=n.outline.render().split(/\r\n/),s=0;s<i.length;s++){var o=i[s],u=r.exec(o);if(u!=null){var f=u[1];n.internal.newObjectDeferredBegin(f,!1)}n.internal.write(o)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,g=[];for(s=0;s<d;s++){var y=n.internal.newObject();g.push(y);var x=n.internal.getPageInfo(s+1);n.internal.write("<< /D["+x.objId+" 0 R /XYZ null null null]>> endobj")}var _=n.internal.newObject();for(n.internal.write("<< /Names [ "),s=0;s<g.length;s++)n.internal.write("(page_"+(s+1)+")"+g[s]+" 0 R");n.internal.write(" ] >>","endobj"),t=n.internal.newObject(),n.internal.write("<< /Dests "+_+" 0 R"),n.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(r,i,s){var o={title:i,options:s,children:[]};return r==null&&(r=this.root),r.children.push(o),o},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(r){r.id=n.internal.newObjectDeferred();for(var i=0;i<r.children.length;i++)this.genIds_r(r.children[i])},n.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},n.outline.renderItems=function(r){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<r.children.length;s++){var o=r.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(r)),s>0&&this.line("/Prev "+this.makeRef(r.children[s-1])),s<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var u=this.count=this.count_r({count:0},o);if(u>0&&this.line("/Count "+u),o.options&&o.options.pageNumber){var f=n.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+f.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var d=0;d<r.children.length;d++)this.renderItems(r.children[d])},n.outline.line=function(r){this.ctx.val+=r+`\r
`},n.outline.makeRef=function(r){return r.id+" 0 R"},n.outline.makeString=function(r){return"("+n.internal.pdfEscape(r)+")"},n.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(r,i){for(var s=0;s<i.children.length;s++)r.count++,this.count_r(r,i.children[s]);return r.count}}])}(kr.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(n,r,i,s,o,u){var f,d=this.decode.DCT_DECODE,g=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=o||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,(f=function(y){for(var x,_=256*y.charCodeAt(4)+y.charCodeAt(5),M=y.length,T={width:0,height:0,numcomponents:1},D=4;D<M;D+=2){if(D+=_,t.indexOf(y.charCodeAt(D+1))!==-1){x=256*y.charCodeAt(D+5)+y.charCodeAt(D+6),T={width:256*y.charCodeAt(D+7)+y.charCodeAt(D+8),height:x,numcomponents:y.charCodeAt(D+9)};break}_=256*y.charCodeAt(D+2)+y.charCodeAt(D+3)}return T}(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n)).numcomponents){case 1:u=this.color_spaces.DEVICE_GRAY;break;case 4:u=this.color_spaces.DEVICE_CMYK;break;case 3:u=this.color_spaces.DEVICE_RGB}g={data:n,width:f.width,height:f.height,colorSpace:u,bitsPerComponent:8,filter:d,index:r,alias:i}}return g}}(kr.API);var kh,Lg,Bb,Rb,Fb,GF=function(){var e,t,n;function r(s){var o,u,f,d,g,y,x,_,M,T,D,I,j,Z;for(this.data=s,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},y=null;;){switch(o=this.readUInt32(),M=(function(){var te,ue;for(ue=[],te=0;te<4;++te)ue.push(String.fromCharCode(this.data[this.pos++]));return ue}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(o);break;case"fcTL":y&&this.animation.frames.push(y),this.pos+=4,y={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},g=this.readUInt16(),d=this.readUInt16()||100,y.delay=1e3*g/d,y.disposeOp=this.data[this.pos++],y.blendOp=this.data[this.pos++],y.data=[];break;case"IDAT":case"fdAT":for(M==="fdAT"&&(this.pos+=4,o-=4),s=(y!=null?y.data:void 0)||this.imgData,I=0;0<=o?I<o:I>o;0<=o?++I:--I)s.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(f=this.palette.length/3,this.transparency.indexed=this.read(o),this.transparency.indexed.length>f)throw new Error("More transparent colors than palette size");if((T=f-this.transparency.indexed.length)>0)for(j=0;0<=T?j<T:j>T;0<=T?++j:--j)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(o)[0];break;case 2:this.transparency.rgb=this.read(o)}break;case"tEXt":x=(D=this.read(o)).indexOf(0),_=String.fromCharCode.apply(String,D.slice(0,x)),this.text[_]=String.fromCharCode.apply(String,D.slice(x+1));break;case"IEND":return y&&this.animation.frames.push(y),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(Z=this.colorType)===4||Z===6,u=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*u,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=o}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}r.prototype.read=function(s){var o,u;for(u=[],o=0;0<=s?o<s:o>s;0<=s?++o:--o)u.push(this.data[this.pos++]);return u},r.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.decodePixels=function(s){var o=this.pixelBitlength/8,u=new Uint8Array(this.width*this.height*o),f=0,d=this;if(s==null&&(s=this.imgData),s.length===0)return new Uint8Array(0);function g(y,x,_,M){var T,D,I,j,Z,te,ue,le,ge,H,U,Q,F,B,R,$,W,G,J,Y,pe,Le=Math.ceil((d.width-y)/_),De=Math.ceil((d.height-x)/M),N=d.width==Le&&d.height==De;for(B=o*Le,Q=N?u:new Uint8Array(B*De),te=s.length,F=0,D=0;F<De&&f<te;){switch(s[f++]){case 0:for(j=W=0;W<B;j=W+=1)Q[D++]=s[f++];break;case 1:for(j=G=0;G<B;j=G+=1)T=s[f++],Z=j<o?0:Q[D-o],Q[D++]=(T+Z)%256;break;case 2:for(j=J=0;J<B;j=J+=1)T=s[f++],I=(j-j%o)/o,R=F&&Q[(F-1)*B+I*o+j%o],Q[D++]=(R+T)%256;break;case 3:for(j=Y=0;Y<B;j=Y+=1)T=s[f++],I=(j-j%o)/o,Z=j<o?0:Q[D-o],R=F&&Q[(F-1)*B+I*o+j%o],Q[D++]=(T+Math.floor((Z+R)/2))%256;break;case 4:for(j=pe=0;pe<B;j=pe+=1)T=s[f++],I=(j-j%o)/o,Z=j<o?0:Q[D-o],F===0?R=$=0:(R=Q[(F-1)*B+I*o+j%o],$=I&&Q[(F-1)*B+(I-1)*o+j%o]),ue=Z+R-$,le=Math.abs(ue-Z),H=Math.abs(ue-R),U=Math.abs(ue-$),ge=le<=H&&le<=U?Z:H<=U?R:$,Q[D++]=(T+ge)%256;break;default:throw new Error("Invalid filter algorithm: "+s[f-1])}if(!N){var ee=((x+F*M)*d.width+y)*o,fe=F*B;for(j=0;j<Le;j+=1){for(var ce=0;ce<o;ce+=1)u[ee++]=Q[fe++];ee+=(_-1)*o}}F++}}return s=xF(s),d.interlaceMethod==1?(g(0,0,8,8),g(4,0,8,8),g(0,4,4,8),g(2,0,4,4),g(0,2,2,4),g(1,0,2,2),g(0,1,1,2)):g(0,0,1,1),u},r.prototype.decodePalette=function(){var s,o,u,f,d,g,y,x,_;for(u=this.palette,g=this.transparency.indexed||[],d=new Uint8Array((g.length||0)+u.length),f=0,s=0,o=y=0,x=u.length;y<x;o=y+=3)d[f++]=u[o],d[f++]=u[o+1],d[f++]=u[o+2],d[f++]=(_=g[s++])!=null?_:255;return d},r.prototype.copyToImageData=function(s,o){var u,f,d,g,y,x,_,M,T,D,I;if(f=this.colors,T=null,u=this.hasAlphaChannel,this.palette.length&&(T=(I=this._decodedPalette)!=null?I:this._decodedPalette=this.decodePalette(),f=4,u=!0),M=(d=s.data||s).length,y=T||o,g=x=0,f===1)for(;g<M;)_=T?4*o[g/4]:x,D=y[_++],d[g++]=D,d[g++]=D,d[g++]=D,d[g++]=u?y[_++]:255,x=_;else for(;g<M;)_=T?4*o[g/4]:x,d[g++]=y[_++],d[g++]=y[_++],d[g++]=y[_++],d[g++]=u?y[_++]:255,x=_},r.prototype.decode=function(){var s;return s=new Uint8Array(this.width*this.height*4),this.copyToImageData(s,this.decodePixels()),s};var i=function(){if(Object.prototype.toString.call(Ir)==="[object Window]"){try{t=Ir.document.createElement("canvas"),n=t.getContext("2d")}catch{return!1}return!0}return!1};return i(),e=function(s){var o;if(i()===!0)return n.width=s.width,n.height=s.height,n.clearRect(0,0,s.width,s.height),n.putImageData(s,0,0),(o=new Image).src=t.toDataURL(),o;throw new Error("This method requires a Browser with Canvas-capability.")},r.prototype.decodeFrames=function(s){var o,u,f,d,g,y,x,_;if(this.animation){for(_=[],u=g=0,y=(x=this.animation.frames).length;g<y;u=++g)o=x[u],f=s.createImageData(o.width,o.height),d=this.decodePixels(new Uint8Array(o.data)),this.copyToImageData(f,d),o.imageData=f,_.push(o.image=e(f));return _}},r.prototype.renderFrame=function(s,o){var u,f,d;return u=(f=this.animation.frames)[o],d=f[o-1],o===0&&s.clearRect(0,0,this.width,this.height),(d!=null?d.disposeOp:void 0)===1?s.clearRect(d.xOffset,d.yOffset,d.width,d.height):(d!=null?d.disposeOp:void 0)===2&&s.putImageData(d.imageData,d.xOffset,d.yOffset),u.blendOp===0&&s.clearRect(u.xOffset,u.yOffset,u.width,u.height),s.drawImage(u.image,u.xOffset,u.yOffset)},r.prototype.animate=function(s){var o,u,f,d,g,y,x=this;return u=0,y=this.animation,d=y.numFrames,f=y.frames,g=y.numPlays,(o=function(){var _,M;if(_=u++%d,M=f[_],x.renderFrame(s,_),d>1&&u/d<g)return x.animation._timeout=setTimeout(o,M.delay)})()},r.prototype.stopAnimation=function(){var s;return clearTimeout((s=this.animation)!=null?s._timeout:void 0)},r.prototype.render=function(s){var o,u;return s._png&&s._png.stopAnimation(),s._png=this,s.width=this.width,s.height=this.height,o=s.getContext("2d"),this.animation?(this.decodeFrames(o),this.animate(o)):(u=o.createImageData(this.width,this.height),this.copyToImageData(u,this.decodePixels()),o.putImageData(u,0,0))},r}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function HF(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=e[t++]|e[t++]<<8,r=e[t++]|e[t++]<<8,i=e[t++],s=i>>7,o=1<<(7&i)+1;e[t++],e[t++];var u=null,f=null;s&&(u=t,f=o,t+=3*o);var d=!0,g=[],y=0,x=null,_=0,M=null;for(this.width=n,this.height=r;d&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,M=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((F=e[t++])>=0))throw Error("Invalid block size");if(F===0)break;t+=F}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var T=e[t++];y=e[t++]|e[t++]<<8,x=e[t++],!(1&T)&&(x=null),_=T>>2&7,t++;break;case 254:for(;;){if(!((F=e[t++])>=0))throw Error("Invalid block size");if(F===0)break;t+=F}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var D=e[t++]|e[t++]<<8,I=e[t++]|e[t++]<<8,j=e[t++]|e[t++]<<8,Z=e[t++]|e[t++]<<8,te=e[t++],ue=te>>6&1,le=1<<(7&te)+1,ge=u,H=f,U=!1;te>>7&&(U=!0,ge=t,H=le,t+=3*le);var Q=t;for(t++;;){var F;if(!((F=e[t++])>=0))throw Error("Invalid block size");if(F===0)break;t+=F}g.push({x:D,y:I,width:j,height:Z,has_local_palette:U,palette_offset:ge,palette_size:H,data_offset:Q,data_length:t-Q,transparent_index:x,interlaced:!!ue,delay:y,disposal:_});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return g.length},this.loopCount=function(){return M},this.frameInfo=function(B){if(B<0||B>=g.length)throw new Error("Frame index out of range.");return g[B]},this.decodeAndBlitFrameBGRA=function(B,R){var $=this.frameInfo(B),W=$.width*$.height,G=new Uint8Array(W);jb(e,$.data_offset,G,W);var J=$.palette_offset,Y=$.transparent_index;Y===null&&(Y=256);var pe=$.width,Le=n-pe,De=pe,N=4*($.y*n+$.x),ee=4*(($.y+$.height)*n+$.x),fe=N,ce=4*Le;$.interlaced===!0&&(ce+=4*n*7);for(var _e=8,se=0,k=G.length;se<k;++se){var ae=G[se];if(De===0&&(De=pe,(fe+=ce)>=ee&&(ce=4*Le+4*n*(_e-1),fe=N+(pe+Le)*(_e<<1),_e>>=1)),ae===Y)fe+=4;else{var ke=e[J+3*ae],Pe=e[J+3*ae+1],Ge=e[J+3*ae+2];R[fe++]=Ge,R[fe++]=Pe,R[fe++]=ke,R[fe++]=255}--De}},this.decodeAndBlitFrameRGBA=function(B,R){var $=this.frameInfo(B),W=$.width*$.height,G=new Uint8Array(W);jb(e,$.data_offset,G,W);var J=$.palette_offset,Y=$.transparent_index;Y===null&&(Y=256);var pe=$.width,Le=n-pe,De=pe,N=4*($.y*n+$.x),ee=4*(($.y+$.height)*n+$.x),fe=N,ce=4*Le;$.interlaced===!0&&(ce+=4*n*7);for(var _e=8,se=0,k=G.length;se<k;++se){var ae=G[se];if(De===0&&(De=pe,(fe+=ce)>=ee&&(ce=4*Le+4*n*(_e-1),fe=N+(pe+Le)*(_e<<1),_e>>=1)),ae===Y)fe+=4;else{var ke=e[J+3*ae],Pe=e[J+3*ae+1],Ge=e[J+3*ae+2];R[fe++]=ke,R[fe++]=Pe,R[fe++]=Ge,R[fe++]=255}--De}}}function jb(e,t,n,r){for(var i=e[t++],s=1<<i,o=s+1,u=o+1,f=i+1,d=(1<<f)-1,g=0,y=0,x=0,_=e[t++],M=new Int32Array(4096),T=null;;){for(;g<16&&_!==0;)y|=e[t++]<<g,g+=8,_===1?_=e[t++]:--_;if(g<f)break;var D=y&d;if(y>>=f,g-=f,D!==s){if(D===o)break;for(var I=D<u?D:T,j=0,Z=I;Z>s;)Z=M[Z]>>8,++j;var te=Z;if(x+j+(I!==D?1:0)>r)return void lo.log("Warning, gif stream longer than expected.");n[x++]=te;var ue=x+=j;for(I!==D&&(n[x++]=te),Z=I;j--;)Z=M[Z],n[--ue]=255&Z,Z>>=8;T!==null&&u<4096&&(M[u++]=T<<8|te,u>=d+1&&f<12&&(++f,d=d<<1|1)),T=D}else u=o+1,d=(1<<(f=i+1))-1,T=null}return x!==r&&lo.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function gv(e){var t,n,r,i,s,o=Math.floor,u=new Array(64),f=new Array(64),d=new Array(64),g=new Array(64),y=new Array(65535),x=new Array(65535),_=new Array(64),M=new Array(64),T=[],D=0,I=7,j=new Array(64),Z=new Array(64),te=new Array(64),ue=new Array(256),le=new Array(2048),ge=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],H=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],U=[0,1,2,3,4,5,6,7,8,9,10,11],Q=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],F=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],B=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],R=[0,1,2,3,4,5,6,7,8,9,10,11],$=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],W=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function G(N,ee){for(var fe=0,ce=0,_e=new Array,se=1;se<=16;se++){for(var k=1;k<=N[se];k++)_e[ee[ce]]=[],_e[ee[ce]][0]=fe,_e[ee[ce]][1]=se,ce++,fe++;fe*=2}return _e}function J(N){for(var ee=N[0],fe=N[1]-1;fe>=0;)ee&1<<fe&&(D|=1<<I),fe--,--I<0&&(D==255?(Y(255),Y(0)):Y(D),I=7,D=0)}function Y(N){T.push(N)}function pe(N){Y(N>>8&255),Y(255&N)}function Le(N,ee,fe,ce,_e){for(var se,k=_e[0],ae=_e[240],ke=function(Ze,He){var Xe,tt,Mt,Lt,jt,zt,sn,pn,et,ot,rt=0;for(et=0;et<8;++et){Xe=Ze[rt],tt=Ze[rt+1],Mt=Ze[rt+2],Lt=Ze[rt+3],jt=Ze[rt+4],zt=Ze[rt+5],sn=Ze[rt+6];var Ht=Xe+(pn=Ze[rt+7]),Qt=Xe-pn,On=tt+sn,wn=tt-sn,Tn=Mt+zt,ar=Mt-zt,xn=Lt+jt,Mn=Lt-jt,Pn=Ht+xn,fr=Ht-xn,yr=On+Tn,at=On-Tn;Ze[rt]=Pn+yr,Ze[rt+4]=Pn-yr;var We=.707106781*(at+fr);Ze[rt+2]=fr+We,Ze[rt+6]=fr-We;var It=.382683433*((Pn=Mn+ar)-(at=wn+Qt)),En=.5411961*Pn+It,Jn=1.306562965*at+It,Zn=.707106781*(yr=ar+wn),qt=Qt+Zn,mn=Qt-Zn;Ze[rt+5]=mn+En,Ze[rt+3]=mn-En,Ze[rt+1]=qt+Jn,Ze[rt+7]=qt-Jn,rt+=8}for(rt=0,et=0;et<8;++et){Xe=Ze[rt],tt=Ze[rt+8],Mt=Ze[rt+16],Lt=Ze[rt+24],jt=Ze[rt+32],zt=Ze[rt+40],sn=Ze[rt+48];var Bt=Xe+(pn=Ze[rt+56]),Kt=Xe-pn,Ln=tt+sn,mr=tt-sn,lt=Mt+zt,Cn=Mt-zt,xr=Lt+jt,Ii=Lt-jt,Fr=Bt+xr,Pr=Bt-xr,lr=Ln+lt,Hr=Ln-lt;Ze[rt]=Fr+lr,Ze[rt+32]=Fr-lr;var ir=.707106781*(Hr+Pr);Ze[rt+16]=Pr+ir,Ze[rt+48]=Pr-ir;var Or=.382683433*((Fr=Ii+Cn)-(Hr=mr+Kt)),jr=.5411961*Fr+Or,rn=1.306562965*Hr+Or,ji=.707106781*(lr=Cn+mr),_i=Kt+ji,gi=Kt-ji;Ze[rt+40]=gi+jr,Ze[rt+24]=gi-jr,Ze[rt+8]=_i+rn,Ze[rt+56]=_i-rn,rt++}for(et=0;et<64;++et)ot=Ze[et]*He[et],_[et]=ot>0?ot+.5|0:ot-.5|0;return _}(N,ee),Pe=0;Pe<64;++Pe)M[ge[Pe]]=ke[Pe];var Ge=M[0]-fe;fe=M[0],Ge==0?J(ce[0]):(J(ce[x[se=32767+Ge]]),J(y[se]));for(var K=63;K>0&&M[K]==0;)K--;if(K==0)return J(k),fe;for(var de,ye=1;ye<=K;){for(var me=ye;M[ye]==0&&ye<=K;)++ye;var Ue=ye-me;if(Ue>=16){de=Ue>>4;for(var Qe=1;Qe<=de;++Qe)J(ae);Ue&=15}se=32767+M[ye],J(_e[(Ue<<4)+x[se]]),J(y[se]),ye++}return K!=63&&J(k),fe}function De(N){N=Math.min(Math.max(N,1),100),s!=N&&(function(ee){for(var fe=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],ce=0;ce<64;ce++){var _e=o((fe[ce]*ee+50)/100);_e=Math.min(Math.max(_e,1),255),u[ge[ce]]=_e}for(var se=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],k=0;k<64;k++){var ae=o((se[k]*ee+50)/100);ae=Math.min(Math.max(ae,1),255),f[ge[k]]=ae}for(var ke=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Pe=0,Ge=0;Ge<8;Ge++)for(var K=0;K<8;K++)d[Pe]=1/(u[ge[Pe]]*ke[Ge]*ke[K]*8),g[Pe]=1/(f[ge[Pe]]*ke[Ge]*ke[K]*8),Pe++}(N<50?Math.floor(5e3/N):Math.floor(200-2*N)),s=N)}this.encode=function(N,ee){ee&&De(ee),T=new Array,D=0,I=7,pe(65496),pe(65504),pe(16),Y(74),Y(70),Y(73),Y(70),Y(0),Y(1),Y(1),Y(0),pe(1),pe(1),Y(0),Y(0),function(){pe(65499),pe(132),Y(0);for(var tt=0;tt<64;tt++)Y(u[tt]);Y(1);for(var Mt=0;Mt<64;Mt++)Y(f[Mt])}(),function(tt,Mt){pe(65472),pe(17),Y(8),pe(Mt),pe(tt),Y(3),Y(1),Y(17),Y(0),Y(2),Y(17),Y(1),Y(3),Y(17),Y(1)}(N.width,N.height),function(){pe(65476),pe(418),Y(0);for(var tt=0;tt<16;tt++)Y(H[tt+1]);for(var Mt=0;Mt<=11;Mt++)Y(U[Mt]);Y(16);for(var Lt=0;Lt<16;Lt++)Y(Q[Lt+1]);for(var jt=0;jt<=161;jt++)Y(F[jt]);Y(1);for(var zt=0;zt<16;zt++)Y(B[zt+1]);for(var sn=0;sn<=11;sn++)Y(R[sn]);Y(17);for(var pn=0;pn<16;pn++)Y($[pn+1]);for(var et=0;et<=161;et++)Y(W[et])}(),pe(65498),pe(12),Y(3),Y(1),Y(0),Y(2),Y(17),Y(3),Y(17),Y(0),Y(63),Y(0);var fe=0,ce=0,_e=0;D=0,I=7,this.encode.displayName="_encode_";for(var se,k,ae,ke,Pe,Ge,K,de,ye,me=N.data,Ue=N.width,Qe=N.height,Ze=4*Ue,He=0;He<Qe;){for(se=0;se<Ze;){for(Pe=Ze*He+se,K=-1,de=0,ye=0;ye<64;ye++)Ge=Pe+(de=ye>>3)*Ze+(K=4*(7&ye)),He+de>=Qe&&(Ge-=Ze*(He+1+de-Qe)),se+K>=Ze&&(Ge-=se+K-Ze+4),k=me[Ge++],ae=me[Ge++],ke=me[Ge++],j[ye]=(le[k]+le[ae+256>>0]+le[ke+512>>0]>>16)-128,Z[ye]=(le[k+768>>0]+le[ae+1024>>0]+le[ke+1280>>0]>>16)-128,te[ye]=(le[k+1280>>0]+le[ae+1536>>0]+le[ke+1792>>0]>>16)-128;fe=Le(j,d,fe,t,r),ce=Le(Z,g,ce,n,i),_e=Le(te,g,_e,n,i),se+=32}He+=8}if(I>=0){var Xe=[];Xe[1]=I+1,Xe[0]=(1<<I+1)-1,J(Xe)}return pe(65497),new Uint8Array(T)},e=e||50,function(){for(var N=String.fromCharCode,ee=0;ee<256;ee++)ue[ee]=N(ee)}(),t=G(H,U),n=G(B,R),r=G(Q,F),i=G($,W),function(){for(var N=1,ee=2,fe=1;fe<=15;fe++){for(var ce=N;ce<ee;ce++)x[32767+ce]=fe,y[32767+ce]=[],y[32767+ce][1]=fe,y[32767+ce][0]=ce;for(var _e=-(ee-1);_e<=-N;_e++)x[32767+_e]=fe,y[32767+_e]=[],y[32767+_e][1]=fe,y[32767+_e][0]=ee-1+_e;N<<=1,ee<<=1}}(),function(){for(var N=0;N<256;N++)le[N]=19595*N,le[N+256>>0]=38470*N,le[N+512>>0]=7471*N+32768,le[N+768>>0]=-11059*N,le[N+1024>>0]=-21709*N,le[N+1280>>0]=32768*N+8421375,le[N+1536>>0]=-27439*N,le[N+1792>>0]=-5329*N}(),De(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Du(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function zb(e){function t(H){if(!H)throw Error("assert :P")}function n(H,U,Q){for(var F=0;4>F;F++)if(H[U+F]!=Q.charCodeAt(F))return!0;return!1}function r(H,U,Q,F,B){for(var R=0;R<B;R++)H[U+R]=Q[F+R]}function i(H,U,Q,F){for(var B=0;B<F;B++)H[U+B]=Q}function s(H){return new Int32Array(H)}function o(H,U){for(var Q=[],F=0;F<H;F++)Q.push(new U);return Q}function u(H,U){var Q=[];return function F(B,R,$){for(var W=$[R],G=0;G<W&&(B.push($.length>R+1?[]:new U),!($.length<R+1));G++)F(B[G],R+1,$)}(Q,0,H),Q}var f=function(){var H=this;function U(b,P){for(var q=1<<P-1>>>0;b&q;)q>>>=1;return q?(b&q-1)+q:b}function Q(b,P,q,oe,we){t(!(oe%q));do b[P+(oe-=q)]=we;while(0<oe)}function F(b,P,q,oe,we){if(t(2328>=we),512>=we)var Ee=s(512);else if((Ee=s(we))==null)return 0;return function(Ae,Te,Ie,Ve,dt,Nt){var Dt,wt,Yt=Te,Vt=1<<Ie,pt=s(16),yt=s(16);for(t(dt!=0),t(Ve!=null),t(Ae!=null),t(0<Ie),wt=0;wt<dt;++wt){if(15<Ve[wt])return 0;++pt[Ve[wt]]}if(pt[0]==dt)return 0;for(yt[1]=0,Dt=1;15>Dt;++Dt){if(pt[Dt]>1<<Dt)return 0;yt[Dt+1]=yt[Dt]+pt[Dt]}for(wt=0;wt<dt;++wt)Dt=Ve[wt],0<Ve[wt]&&(Nt[yt[Dt]++]=wt);if(yt[15]==1)return(Ve=new B).g=0,Ve.value=Nt[0],Q(Ae,Yt,1,Vt,Ve),Vt;var en,fn=-1,nn=Vt-1,kn=0,Sn=1,Qn=1,l=1<<Ie;for(wt=0,Dt=1,dt=2;Dt<=Ie;++Dt,dt<<=1){if(Sn+=Qn<<=1,0>(Qn-=pt[Dt]))return 0;for(;0<pt[Dt];--pt[Dt])(Ve=new B).g=Dt,Ve.value=Nt[wt++],Q(Ae,Yt+kn,dt,l,Ve),kn=U(kn,Dt)}for(Dt=Ie+1,dt=2;15>=Dt;++Dt,dt<<=1){if(Sn+=Qn<<=1,0>(Qn-=pt[Dt]))return 0;for(;0<pt[Dt];--pt[Dt]){if(Ve=new B,(kn&nn)!=fn){for(Yt+=l,en=1<<(fn=Dt)-Ie;15>fn&&!(0>=(en-=pt[fn]));)++fn,en<<=1;Vt+=l=1<<(en=fn-Ie),Ae[Te+(fn=kn&nn)].g=en+Ie,Ae[Te+fn].value=Yt-Te-fn}Ve.g=Dt-Ie,Ve.value=Nt[wt++],Q(Ae,Yt+(kn>>Ie),dt,l,Ve),kn=U(kn,Dt)}}return Sn!=2*yt[15]-1?0:Vt}(b,P,q,oe,we,Ee)}function B(){this.value=this.g=0}function R(){this.value=this.g=0}function $(){this.G=o(5,B),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(po,R)}function W(b,P,q,oe){t(b!=null),t(P!=null),t(2147483648>oe),b.Ca=254,b.I=0,b.b=-8,b.Ka=0,b.oa=P,b.pa=q,b.Jd=P,b.Yc=q+oe,b.Zc=4<=oe?q+oe-4+1:q,se(b)}function G(b,P){for(var q=0;0<P--;)q|=ae(b,128)<<P;return q}function J(b,P){var q=G(b,P);return k(b)?-q:q}function Y(b,P,q,oe){var we,Ee=0;for(t(b!=null),t(P!=null),t(4294967288>oe),b.Sb=oe,b.Ra=0,b.u=0,b.h=0,4<oe&&(oe=4),we=0;we<oe;++we)Ee+=P[q+we]<<8*we;b.Ra=Ee,b.bb=oe,b.oa=P,b.pa=q}function pe(b){for(;8<=b.u&&b.bb<b.Sb;)b.Ra>>>=8,b.Ra+=b.oa[b.pa+b.bb]<<hs-8>>>0,++b.bb,b.u-=8;fe(b)&&(b.h=1,b.u=0)}function Le(b,P){if(t(0<=P),!b.h&&P<=Ms){var q=ee(b)&ra[P];return b.u+=P,pe(b),q}return b.h=1,b.u=0}function De(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function N(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function ee(b){return b.Ra>>>(b.u&hs-1)>>>0}function fe(b){return t(b.bb<=b.Sb),b.h||b.bb==b.Sb&&b.u>hs}function ce(b,P){b.u=P,b.h=fe(b)}function _e(b){b.u>=hl&&(t(b.u>=hl),pe(b))}function se(b){t(b!=null&&b.oa!=null),b.pa<b.Zc?(b.I=(b.oa[b.pa++]|b.I<<8)>>>0,b.b+=8):(t(b!=null&&b.oa!=null),b.pa<b.Yc?(b.b+=8,b.I=b.oa[b.pa++]|b.I<<8):b.Ka?b.b=0:(b.I<<=8,b.b+=8,b.Ka=1))}function k(b){return G(b,1)}function ae(b,P){var q=b.Ca;0>b.b&&se(b);var oe=b.b,we=q*P>>>8,Ee=(b.I>>>oe>we)+0;for(Ee?(q-=we,b.I-=we+1<<oe>>>0):q=we+1,oe=q,we=0;256<=oe;)we+=8,oe>>=8;return oe=7^we+$o[oe],b.b-=oe,b.Ca=(q<<oe)-1,Ee}function ke(b,P,q){b[P+0]=q>>24&255,b[P+1]=q>>16&255,b[P+2]=q>>8&255,b[P+3]=q>>0&255}function Pe(b,P){return b[P+0]<<0|b[P+1]<<8}function Ge(b,P){return Pe(b,P)|b[P+2]<<16}function K(b,P){return Pe(b,P)|Pe(b,P+2)<<16}function de(b,P){var q=1<<P;return t(b!=null),t(0<P),b.X=s(q),b.X==null?0:(b.Mb=32-P,b.Xa=P,1)}function ye(b,P){t(b!=null),t(P!=null),t(b.Xa==P.Xa),r(P.X,0,b.X,0,1<<P.Xa)}function me(){this.X=[],this.Xa=this.Mb=0}function Ue(b,P,q,oe){t(q!=null),t(oe!=null);var we=q[0],Ee=oe[0];return we==0&&(we=(b*Ee+P/2)/P),Ee==0&&(Ee=(P*we+b/2)/b),0>=we||0>=Ee?0:(q[0]=we,oe[0]=Ee,1)}function Qe(b,P){return b+(1<<P)-1>>>P}function Ze(b,P){return((4278255360&b)+(4278255360&P)>>>0&4278255360)+((16711935&b)+(16711935&P)>>>0&16711935)>>>0}function He(b,P){H[P]=function(q,oe,we,Ee,Ae,Te,Ie){var Ve;for(Ve=0;Ve<Ae;++Ve){var dt=H[b](Te[Ie+Ve-1],we,Ee+Ve);Te[Ie+Ve]=Ze(q[oe+Ve],dt)}}}function Xe(){this.ud=this.hd=this.jd=0}function tt(b,P){return((4278124286&(b^P))>>>1)+(b&P)>>>0}function Mt(b){return 0<=b&&256>b?b:0>b?0:255<b?255:void 0}function Lt(b,P){return Mt(b+(b-P+.5>>1))}function jt(b,P,q){return Math.abs(P-q)-Math.abs(b-q)}function zt(b,P,q,oe,we,Ee,Ae){for(oe=Ee[Ae-1],q=0;q<we;++q)Ee[Ae+q]=oe=Ze(b[P+q],oe)}function sn(b,P,q,oe,we){var Ee;for(Ee=0;Ee<q;++Ee){var Ae=b[P+Ee],Te=Ae>>8&255,Ie=16711935&(Ie=(Ie=16711935&Ae)+((Te<<16)+Te));oe[we+Ee]=(4278255360&Ae)+Ie>>>0}}function pn(b,P){P.jd=b>>0&255,P.hd=b>>8&255,P.ud=b>>16&255}function et(b,P,q,oe,we,Ee){var Ae;for(Ae=0;Ae<oe;++Ae){var Te=P[q+Ae],Ie=Te>>>8,Ve=Te,dt=255&(dt=(dt=Te>>>16)+((b.jd<<24>>24)*(Ie<<24>>24)>>>5));Ve=255&(Ve=(Ve=Ve+((b.hd<<24>>24)*(Ie<<24>>24)>>>5))+((b.ud<<24>>24)*(dt<<24>>24)>>>5)),we[Ee+Ae]=(4278255360&Te)+(dt<<16)+Ve}}function ot(b,P,q,oe,we){H[P]=function(Ee,Ae,Te,Ie,Ve,dt,Nt,Dt,wt){for(Ie=Nt;Ie<Dt;++Ie)for(Nt=0;Nt<wt;++Nt)Ve[dt++]=we(Te[oe(Ee[Ae++])])},H[b]=function(Ee,Ae,Te,Ie,Ve,dt,Nt){var Dt=8>>Ee.b,wt=Ee.Ea,Yt=Ee.K[0],Vt=Ee.w;if(8>Dt)for(Ee=(1<<Ee.b)-1,Vt=(1<<Dt)-1;Ae<Te;++Ae){var pt,yt=0;for(pt=0;pt<wt;++pt)pt&Ee||(yt=oe(Ie[Ve++])),dt[Nt++]=we(Yt[yt&Vt]),yt>>=Dt}else H["VP8LMapColor"+q](Ie,Ve,Yt,Vt,dt,Nt,Ae,Te,wt)}}function rt(b,P,q,oe,we){for(q=P+q;P<q;){var Ee=b[P++];oe[we++]=Ee>>16&255,oe[we++]=Ee>>8&255,oe[we++]=Ee>>0&255}}function Ht(b,P,q,oe,we){for(q=P+q;P<q;){var Ee=b[P++];oe[we++]=Ee>>16&255,oe[we++]=Ee>>8&255,oe[we++]=Ee>>0&255,oe[we++]=Ee>>24&255}}function Qt(b,P,q,oe,we){for(q=P+q;P<q;){var Ee=(Ae=b[P++])>>16&240|Ae>>12&15,Ae=Ae>>0&240|Ae>>28&15;oe[we++]=Ee,oe[we++]=Ae}}function On(b,P,q,oe,we){for(q=P+q;P<q;){var Ee=(Ae=b[P++])>>16&248|Ae>>13&7,Ae=Ae>>5&224|Ae>>3&31;oe[we++]=Ee,oe[we++]=Ae}}function wn(b,P,q,oe,we){for(q=P+q;P<q;){var Ee=b[P++];oe[we++]=Ee>>0&255,oe[we++]=Ee>>8&255,oe[we++]=Ee>>16&255}}function Tn(b,P,q,oe,we,Ee){if(Ee==0)for(q=P+q;P<q;)ke(oe,((Ee=b[P++])[0]>>24|Ee[1]>>8&65280|Ee[2]<<8&16711680|Ee[3]<<24)>>>0),we+=32;else r(oe,we,b,P,q)}function ar(b,P){H[P][0]=H[b+"0"],H[P][1]=H[b+"1"],H[P][2]=H[b+"2"],H[P][3]=H[b+"3"],H[P][4]=H[b+"4"],H[P][5]=H[b+"5"],H[P][6]=H[b+"6"],H[P][7]=H[b+"7"],H[P][8]=H[b+"8"],H[P][9]=H[b+"9"],H[P][10]=H[b+"10"],H[P][11]=H[b+"11"],H[P][12]=H[b+"12"],H[P][13]=H[b+"13"],H[P][14]=H[b+"0"],H[P][15]=H[b+"0"]}function xn(b){return b==To||b==No||b==Ks||b==a}function Mn(){this.eb=[],this.size=this.A=this.fb=0}function Pn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function fr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Mn,this.f.kb=new Pn,this.sd=null}function yr(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function at(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function We(b){return alert("todo:WebPSamplerProcessPlane"),b.T}function It(b,P){var q=b.T,oe=P.ba.f.RGBA,we=oe.eb,Ee=oe.fb+b.ka*oe.A,Ae=Wo[P.ba.S],Te=b.y,Ie=b.O,Ve=b.f,dt=b.N,Nt=b.ea,Dt=b.W,wt=P.cc,Yt=P.dc,Vt=P.Mc,pt=P.Nc,yt=b.ka,en=b.ka+b.T,fn=b.U,nn=fn+1>>1;for(yt==0?Ae(Te,Ie,null,null,Ve,dt,Nt,Dt,Ve,dt,Nt,Dt,we,Ee,null,null,fn):(Ae(P.ec,P.fc,Te,Ie,wt,Yt,Vt,pt,Ve,dt,Nt,Dt,we,Ee-oe.A,we,Ee,fn),++q);yt+2<en;yt+=2)wt=Ve,Yt=dt,Vt=Nt,pt=Dt,dt+=b.Rc,Dt+=b.Rc,Ee+=2*oe.A,Ae(Te,(Ie+=2*b.fa)-b.fa,Te,Ie,wt,Yt,Vt,pt,Ve,dt,Nt,Dt,we,Ee-oe.A,we,Ee,fn);return Ie+=b.fa,b.j+en<b.o?(r(P.ec,P.fc,Te,Ie,fn),r(P.cc,P.dc,Ve,dt,nn),r(P.Mc,P.Nc,Nt,Dt,nn),q--):1&en||Ae(Te,Ie,null,null,Ve,dt,Nt,Dt,Ve,dt,Nt,Dt,we,Ee+oe.A,null,null,fn),q}function En(b,P,q){var oe=b.F,we=[b.J];if(oe!=null){var Ee=b.U,Ae=P.ba.S,Te=Ae==Zs||Ae==Ks;P=P.ba.f.RGBA;var Ie=[0],Ve=b.ka;Ie[0]=b.T,b.Kb&&(Ve==0?--Ie[0]:(--Ve,we[0]-=b.width),b.j+b.ka+b.T==b.o&&(Ie[0]=b.o-b.j-Ve));var dt=P.eb;Ve=P.fb+Ve*P.A,b=Ai(oe,we[0],b.width,Ee,Ie,dt,Ve+(Te?0:3),P.A),t(q==Ie),b&&xn(Ae)&&ko(dt,Ve,Te,Ee,Ie,P.A)}return 0}function Jn(b){var P=b.ma,q=P.ba.S,oe=11>q,we=q==pr||q==Ea||q==Zs||q==is||q==12||xn(q);if(P.memory=null,P.Ib=null,P.Jb=null,P.Nd=null,!wu(P.Oa,b,we?11:12))return 0;if(we&&xn(q)&&cn(),b.da)alert("todo:use_scaling");else{if(oe){if(P.Ib=We,b.Kb){if(q=b.U+1>>1,P.memory=s(b.U+2*q),P.memory==null)return 0;P.ec=P.memory,P.fc=0,P.cc=P.ec,P.dc=P.fc+b.U,P.Mc=P.cc,P.Nc=P.dc+q,P.Ib=It,cn()}}else alert("todo:EmitYUV");we&&(P.Jb=En,oe&&xt())}if(oe&&!Xu){for(b=0;256>b;++b)Kc[b]=89858*(b-128)+qa>>Zc,Yc[b]=-22014*(b-128)+qa,md[b]=-45773*(b-128),Bl[b]=113618*(b-128)+qa>>Zc;for(b=xc;b<Tf;++b)P=76283*(b-16)+qa>>Zc,Jc[b-xc]=Vr(P,255),ch[b-xc]=Vr(P+8>>4,15);Xu=1}return 1}function Zn(b){var P=b.ma,q=b.U,oe=b.T;return t(!(1&b.ka)),0>=q||0>=oe?0:(q=P.Ib(b,P),P.Jb!=null&&P.Jb(b,P,q),P.Dc+=q,1)}function qt(b){b.ma.memory=null}function mn(b,P,q,oe){return Le(b,8)!=47?0:(P[0]=Le(b,14)+1,q[0]=Le(b,14)+1,oe[0]=Le(b,1),Le(b,3)!=0?0:!b.h)}function Bt(b,P){if(4>b)return b+1;var q=b-2>>1;return(2+(1&b)<<q)+Le(P,q)+1}function Kt(b,P){return 120<P?P-120:1<=(q=((q=st[P-1])>>4)*b+(8-(15&q)))?q:1;var q}function Ln(b,P,q){var oe=ee(q),we=b[P+=255&oe].g-8;return 0<we&&(ce(q,q.u+8),oe=ee(q),P+=b[P].value,P+=oe&(1<<we)-1),ce(q,q.u+b[P].g),b[P].value}function mr(b,P,q){return q.g+=b.g,q.value+=b.value<<P>>>0,t(8>=q.g),b.g}function lt(b,P,q){var oe=b.xc;return t((P=oe==0?0:b.vc[b.md*(q>>oe)+(P>>oe)])<b.Wb),b.Ya[P]}function Cn(b,P,q,oe){var we=b.ab,Ee=b.c*P,Ae=b.C;P=Ae+P;var Te=q,Ie=oe;for(oe=b.Ta,q=b.Ua;0<we--;){var Ve=b.gc[we],dt=Ae,Nt=P,Dt=Te,wt=Ie,Yt=(Ie=oe,Te=q,Ve.Ea);switch(t(dt<Nt),t(Nt<=Ve.nc),Ve.hc){case 2:Ju(Dt,wt,(Nt-dt)*Yt,Ie,Te);break;case 0:var Vt=dt,pt=Nt,yt=Ie,en=Te,fn=(l=Ve).Ea;Vt==0&&(ts(Dt,wt,null,null,1,yt,en),zt(Dt,wt+1,0,0,fn-1,yt,en+1),wt+=fn,en+=fn,++Vt);for(var nn=1<<l.b,kn=nn-1,Sn=Qe(fn,l.b),Qn=l.K,l=l.w+(Vt>>l.b)*Sn;Vt<pt;){var h=Qn,v=l,w=1;for(ns(Dt,wt,yt,en-fn,1,yt,en);w<fn;){var C=(w&~kn)+nn;C>fn&&(C=fn),(0,xa[h[v++]>>8&15])(Dt,wt+ +w,yt,en+w-fn,C-w,yt,en+w),w=C}wt+=fn,en+=fn,++Vt&kn||(l+=Sn)}Nt!=Ve.nc&&r(Ie,Te-Yt,Ie,Te+(Nt-dt-1)*Yt,Yt);break;case 1:for(Yt=Dt,pt=wt,fn=(Dt=Ve.Ea)-(en=Dt&~(yt=(wt=1<<Ve.b)-1)),Vt=Qe(Dt,Ve.b),nn=Ve.K,Ve=Ve.w+(dt>>Ve.b)*Vt;dt<Nt;){for(kn=nn,Sn=Ve,Qn=new Xe,l=pt+en,h=pt+Dt;pt<l;)pn(kn[Sn++],Qn),La(Qn,Yt,pt,wt,Ie,Te),pt+=wt,Te+=wt;pt<h&&(pn(kn[Sn++],Qn),La(Qn,Yt,pt,fn,Ie,Te),pt+=fn,Te+=fn),++dt&yt||(Ve+=Vt)}break;case 3:if(Dt==Ie&&wt==Te&&0<Ve.b){for(pt=Ie,Dt=Yt=Te+(Nt-dt)*Yt-(en=(Nt-dt)*Qe(Ve.Ea,Ve.b)),wt=Ie,yt=Te,Vt=[],en=(fn=en)-1;0<=en;--en)Vt[en]=wt[yt+en];for(en=fn-1;0<=en;--en)pt[Dt+en]=Vt[en];So(Ve,dt,Nt,Ie,Yt,Ie,Te)}else So(Ve,dt,Nt,Dt,wt,Ie,Te)}Te=oe,Ie=q}Ie!=q&&r(oe,q,Te,Ie,Ee)}function xr(b,P){var q=b.V,oe=b.Ba+b.c*b.C,we=P-b.C;if(t(P<=b.l.o),t(16>=we),0<we){var Ee=b.l,Ae=b.Ta,Te=b.Ua,Ie=Ee.width;if(Cn(b,we,q,oe),we=Te=[Te],t((q=b.C)<(oe=P)),t(Ee.v<Ee.va),oe>Ee.o&&(oe=Ee.o),q<Ee.j){var Ve=Ee.j-q;q=Ee.j,we[0]+=Ve*Ie}if(q>=oe?q=0:(we[0]+=4*Ee.v,Ee.ka=q-Ee.j,Ee.U=Ee.va-Ee.v,Ee.T=oe-q,q=1),q){if(Te=Te[0],11>(q=b.ca).S){var dt=q.f.RGBA,Nt=(oe=q.S,we=Ee.U,Ee=Ee.T,Ve=dt.eb,dt.A),Dt=Ee;for(dt=dt.fb+b.Ma*dt.A;0<Dt--;){var wt=Ae,Yt=Te,Vt=we,pt=Ve,yt=dt;switch(oe){case ps:Go(wt,Yt,Vt,pt,yt);break;case pr:Ao(wt,Yt,Vt,pt,yt);break;case To:Ao(wt,Yt,Vt,pt,yt),ko(pt,yt,0,Vt,1,0);break;case Ca:Ho(wt,Yt,Vt,pt,yt);break;case Ea:Tn(wt,Yt,Vt,pt,yt,1);break;case No:Tn(wt,Yt,Vt,pt,yt,1),ko(pt,yt,0,Vt,1,0);break;case Zs:Tn(wt,Yt,Vt,pt,yt,0);break;case Ks:Tn(wt,Yt,Vt,pt,yt,0),ko(pt,yt,1,Vt,1,0);break;case is:ia(wt,Yt,Vt,pt,yt);break;case a:ia(wt,Yt,Vt,pt,yt),Si(pt,yt,Vt,1,0);break;case bc:As(wt,Yt,Vt,pt,yt);break;default:t(0)}Te+=Ie,dt+=Nt}b.Ma+=Ee}else alert("todo:EmitRescaledRowsYUVA");t(b.Ma<=q.height)}}b.C=P,t(b.C<=b.i)}function Ii(b){var P;if(0<b.ua)return 0;for(P=0;P<b.Wb;++P){var q=b.Ya[P].G,oe=b.Ya[P].H;if(0<q[1][oe[1]+0].g||0<q[2][oe[2]+0].g||0<q[3][oe[3]+0].g)return 0}return 1}function Fr(b,P,q,oe,we,Ee){if(b.Z!=0){var Ae=b.qd,Te=b.rd;for(t(mi[b.Z]!=null);P<q;++P)mi[b.Z](Ae,Te,oe,we,oe,we,Ee),Ae=oe,Te=we,we+=Ee;b.qd=Ae,b.rd=Te}}function Pr(b,P){var q=b.l.ma,oe=q.Z==0||q.Z==1?b.l.j:b.C;if(oe=b.C<oe?oe:b.C,t(P<=b.l.o),P>oe){var we=b.l.width,Ee=q.ca,Ae=q.tb+we*oe,Te=b.V,Ie=b.Ba+b.c*oe,Ve=b.gc;t(b.ab==1),t(Ve[0].hc==3),Uo(Ve[0],oe,P,Te,Ie,Ee,Ae),Fr(q,oe,P,Ee,Ae,we)}b.C=b.Ma=P}function lr(b,P,q,oe,we,Ee,Ae){var Te=b.$/oe,Ie=b.$%oe,Ve=b.m,dt=b.s,Nt=q+b.$,Dt=Nt;we=q+oe*we;var wt=q+oe*Ee,Yt=280+dt.ua,Vt=b.Pb?Te:16777216,pt=0<dt.ua?dt.Wa:null,yt=dt.wc,en=Nt<wt?lt(dt,Ie,Te):null;t(b.C<Ee),t(wt<=we);var fn=!1;e:for(;;){for(;fn||Nt<wt;){var nn=0;if(Te>=Vt){var kn=Nt-q;t((Vt=b).Pb),Vt.wd=Vt.m,Vt.xd=kn,0<Vt.s.ua&&ye(Vt.s.Wa,Vt.s.vb),Vt=Te+Ut}if(Ie&yt||(en=lt(dt,Ie,Te)),t(en!=null),en.Qb&&(P[Nt]=en.qb,fn=!0),!fn)if(_e(Ve),en.jc){nn=Ve,kn=P;var Sn=Nt,Qn=en.pd[ee(nn)&po-1];t(en.jc),256>Qn.g?(ce(nn,nn.u+Qn.g),kn[Sn]=Qn.value,nn=0):(ce(nn,nn.u+Qn.g-256),t(256<=Qn.value),nn=Qn.value),nn==0&&(fn=!0)}else nn=Ln(en.G[0],en.H[0],Ve);if(Ve.h)break;if(fn||256>nn){if(!fn)if(en.nd)P[Nt]=(en.qb|nn<<8)>>>0;else{if(_e(Ve),fn=Ln(en.G[1],en.H[1],Ve),_e(Ve),kn=Ln(en.G[2],en.H[2],Ve),Sn=Ln(en.G[3],en.H[3],Ve),Ve.h)break;P[Nt]=(Sn<<24|fn<<16|nn<<8|kn)>>>0}if(fn=!1,++Nt,++Ie>=oe&&(Ie=0,++Te,Ae!=null&&Te<=Ee&&!(Te%16)&&Ae(b,Te),pt!=null))for(;Dt<Nt;)nn=P[Dt++],pt.X[(506832829*nn&4294967295)>>>pt.Mb]=nn}else if(280>nn){if(nn=Bt(nn-256,Ve),kn=Ln(en.G[4],en.H[4],Ve),_e(Ve),kn=Kt(oe,kn=Bt(kn,Ve)),Ve.h)break;if(Nt-q<kn||we-Nt<nn)break e;for(Sn=0;Sn<nn;++Sn)P[Nt+Sn]=P[Nt+Sn-kn];for(Nt+=nn,Ie+=nn;Ie>=oe;)Ie-=oe,++Te,Ae!=null&&Te<=Ee&&!(Te%16)&&Ae(b,Te);if(t(Nt<=we),Ie&yt&&(en=lt(dt,Ie,Te)),pt!=null)for(;Dt<Nt;)nn=P[Dt++],pt.X[(506832829*nn&4294967295)>>>pt.Mb]=nn}else{if(!(nn<Yt))break e;for(fn=nn-280,t(pt!=null);Dt<Nt;)nn=P[Dt++],pt.X[(506832829*nn&4294967295)>>>pt.Mb]=nn;nn=Nt,t(!(fn>>>(kn=pt).Xa)),P[nn]=kn.X[fn],fn=!0}fn||t(Ve.h==fe(Ve))}if(b.Pb&&Ve.h&&Nt<we)t(b.m.h),b.a=5,b.m=b.wd,b.$=b.xd,0<b.s.ua&&ye(b.s.vb,b.s.Wa);else{if(Ve.h)break e;Ae!=null&&Ae(b,Te>Ee?Ee:Te),b.a=0,b.$=Nt-q}return 1}return b.a=3,0}function Hr(b){t(b!=null),b.vc=null,b.yc=null,b.Ya=null;var P=b.Wa;P!=null&&(P.X=null),b.vb=null,t(b!=null)}function ir(){var b=new ul;return b==null?null:(b.a=0,b.xb=tu,ar("Predictor","VP8LPredictors"),ar("Predictor","VP8LPredictors_C"),ar("PredictorAdd","VP8LPredictorsAdd"),ar("PredictorAdd","VP8LPredictorsAdd_C"),Ju=sn,La=et,Go=rt,Ao=Ht,ia=Qt,As=On,Ho=wn,H.VP8LMapColor32b=wa,H.VP8LMapColor8b=Vo,b)}function Or(b,P,q,oe,we){var Ee=1,Ae=[b],Te=[P],Ie=oe.m,Ve=oe.s,dt=null,Nt=0;e:for(;;){if(q)for(;Ee&&Le(Ie,1);){var Dt=Ae,wt=Te,Yt=oe,Vt=1,pt=Yt.m,yt=Yt.gc[Yt.ab],en=Le(pt,2);if(Yt.Oc&1<<en)Ee=0;else{switch(Yt.Oc|=1<<en,yt.hc=en,yt.Ea=Dt[0],yt.nc=wt[0],yt.K=[null],++Yt.ab,t(4>=Yt.ab),en){case 0:case 1:yt.b=Le(pt,3)+2,Vt=Or(Qe(yt.Ea,yt.b),Qe(yt.nc,yt.b),0,Yt,yt.K),yt.K=yt.K[0];break;case 3:var fn,nn=Le(pt,8)+1,kn=16<nn?0:4<nn?1:2<nn?2:3;if(Dt[0]=Qe(yt.Ea,kn),yt.b=kn,fn=Vt=Or(nn,1,0,Yt,yt.K)){var Sn,Qn=nn,l=yt,h=1<<(8>>l.b),v=s(h);if(v==null)fn=0;else{var w=l.K[0],C=l.w;for(v[0]=l.K[0][0],Sn=1;Sn<1*Qn;++Sn)v[Sn]=Ze(w[C+Sn],v[Sn-1]);for(;Sn<4*h;++Sn)v[Sn]=0;l.K[0]=null,l.K[0]=v,fn=1}}Vt=fn;break;case 2:break;default:t(0)}Ee=Vt}}if(Ae=Ae[0],Te=Te[0],Ee&&Le(Ie,1)&&!(Ee=1<=(Nt=Le(Ie,4))&&11>=Nt)){oe.a=3;break e}var z;if(z=Ee)t:{var X,re,he,Se=oe,Je=Ae,ze=Te,vt=Nt,kt=q,Xt=Se.m,yn=Se.s,bn=[null],ur=1,Ye=0,nt=Pt[vt];n:for(;;){if(kt&&Le(Xt,1)){var ht=Le(Xt,3)+2,Ot=Qe(Je,ht),bt=Qe(ze,ht),Tt=Ot*bt;if(!Or(Ot,bt,0,Se,bn))break n;for(bn=bn[0],yn.xc=ht,X=0;X<Tt;++X){var ve=bn[X]>>8&65535;bn[X]=ve,ve>=ur&&(ur=ve+1)}}if(Xt.h)break n;for(re=0;5>re;++re){var Me=V[re];!re&&0<vt&&(Me+=1<<vt),Ye<Me&&(Ye=Me)}var Be=o(ur*nt,B),Oe=ur,Fe=o(Oe,$);if(Fe==null)var je=null;else t(65536>=Oe),je=Fe;var ut=s(Ye);if(je==null||ut==null||Be==null){Se.a=1;break n}var ct=Be;for(X=he=0;X<ur;++X){var gt=je[X],St=gt.G,Ct=gt.H,on=0,$n=1,Hn=0;for(re=0;5>re;++re){Me=V[re],St[re]=ct,Ct[re]=he,!re&&0<vt&&(Me+=1<<vt);i:{var er,vi=Me,ki=Se,ei=ut,Fi=ct,vs=he,Su=0,fa=ki.m,Nf=Le(fa,1);if(i(ei,0,0,vi),Nf){var Wa=Le(fa,1)+1,Qu=Le(fa,1),ha=Le(fa,Qu==0?1:8);ei[ha]=1,Wa==2&&(ei[ha=Le(fa,8)]=1);var Zo=1}else{var ao=s(19),gh=Le(fa,4)+4;if(19<gh){ki.a=3;var Df=0;break i}for(er=0;er<gh;++er)ao[Ce[er]]=Le(fa,3);var If=void 0,Of=void 0,mh=ki,li=ao,vh=vi,$p=ei,Lc=0,Cu=mh.m,Up=8,Vp=o(128,B);r:for(;F(Vp,0,7,li,19);){if(Le(Cu,1)){var dl=2+2*Le(Cu,3);if((If=2+Le(Cu,dl))>vh)break r}else If=vh;for(Of=0;Of<vh&&If--;){_e(Cu);var Gp=Vp[0+(127&ee(Cu))];ce(Cu,Cu.u+Gp.g);var Eu=Gp.value;if(16>Eu)$p[Of++]=Eu,Eu!=0&&(Up=Eu);else{var vd=Eu==16,yd=Eu-16,Hp=S[yd],Ma=Le(Cu,p[yd])+Hp;if(Of+Ma>vh)break r;for(var ec=vd?Up:0;0<Ma--;)$p[Of++]=ec}}Lc=1;break r}Lc||(mh.a=3),Zo=Lc}(Zo=Zo&&!fa.h)&&(Su=F(Fi,vs,8,ei,vi)),Zo&&Su!=0?Df=Su:(ki.a=3,Df=0)}if(Df==0)break n;if($n&&ie[re]==1&&($n=ct[he].g==0),on+=ct[he].g,he+=Df,3>=re){var Sc,yh=ut[0];for(Sc=1;Sc<Me;++Sc)ut[Sc]>yh&&(yh=ut[Sc]);Hn+=yh}}if(gt.nd=$n,gt.Qb=0,$n&&(gt.qb=(St[3][Ct[3]+0].value<<24|St[1][Ct[1]+0].value<<16|St[2][Ct[2]+0].value)>>>0,on==0&&256>St[0][Ct[0]+0].value&&(gt.Qb=1,gt.qb+=St[0][Ct[0]+0].value<<8)),gt.jc=!gt.Qb&&6>Hn,gt.jc){var Cc,nu=gt;for(Cc=0;Cc<po;++Cc){var ru=Cc,Pu=nu.pd[ru],Xc=nu.G[0][nu.H[0]+ru];256<=Xc.value?(Pu.g=Xc.g+256,Pu.value=Xc.value):(Pu.g=0,Pu.value=0,ru>>=mr(Xc,8,Pu),ru>>=mr(nu.G[1][nu.H[1]+ru],16,Pu),ru>>=mr(nu.G[2][nu.H[2]+ru],0,Pu),mr(nu.G[3][nu.H[3]+ru],24,Pu))}}}yn.vc=bn,yn.Wb=ur,yn.Ya=je,yn.yc=Be,z=1;break t}z=0}if(!(Ee=z)){oe.a=3;break e}if(0<Nt){if(Ve.ua=1<<Nt,!de(Ve.Wa,Nt)){oe.a=1,Ee=0;break e}}else Ve.ua=0;var Bf=oe,Mu=Ae,l0=Te,iu=Bf.s,_h=iu.xc;if(Bf.c=Mu,Bf.i=l0,iu.md=Qe(Mu,_h),iu.wc=_h==0?-1:(1<<_h)-1,q){oe.xb=kf;break e}if((dt=s(Ae*Te))==null){oe.a=1,Ee=0;break e}Ee=(Ee=lr(oe,dt,0,Ae,Te,Te,null))&&!Ie.h;break e}return Ee?(we!=null?we[0]=dt:(t(dt==null),t(q)),oe.$=0,q||Hr(Ve)):Hr(Ve),Ee}function jr(b,P){var q=b.c*b.i,oe=q+P+16*P;return t(b.c<=P),b.V=s(oe),b.V==null?(b.Ta=null,b.Ua=0,b.a=1,0):(b.Ta=b.V,b.Ua=b.Ba+q+P,1)}function rn(b,P){var q=b.C,oe=P-q,we=b.V,Ee=b.Ba+b.c*q;for(t(P<=b.l.o);0<oe;){var Ae=16<oe?16:oe,Te=b.l.ma,Ie=b.l.width,Ve=Ie*Ae,dt=Te.ca,Nt=Te.tb+Ie*q,Dt=b.Ta,wt=b.Ua;Cn(b,Ae,we,Ee),so(Dt,wt,dt,Nt,Ve),Fr(Te,q,q+Ae,dt,Nt,Ie),oe-=Ae,we+=Ae*b.c,q+=Ae}t(q==P),b.C=b.Ma=P}function ji(){this.ub=this.yd=this.td=this.Rb=0}function _i(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function gi(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Kr(){this.Yb=function(){var b=[];return function P(q,oe,we){for(var Ee=we[oe],Ae=0;Ae<Ee&&(q.push(we.length>oe+1?[]:0),!(we.length<oe+1));Ae++)P(q[Ae],oe+1,we)}(b,0,[3,11]),b}()}function Br(){this.jb=s(3),this.Wc=u([4,8],Kr),this.Xc=u([4,17],Kr)}function Rr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function dr(){this.ld=this.La=this.dd=this.tc=0}function zi(){this.Na=this.la=0}function Ss(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Cs(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function si(){this.uc=this.M=this.Nb=0,this.wa=Array(new dr),this.Y=0,this.ya=Array(new Cs),this.aa=0,this.l=new ci}function jn(){this.y=s(16),this.f=s(8),this.ea=s(8)}function Po(){this.cb=this.a=0,this.sc="",this.m=new De,this.Od=new ji,this.Kc=new _i,this.ed=new Rr,this.Qa=new gi,this.Ic=this.$c=this.Aa=0,this.D=new si,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,De),this.ia=0,this.pb=o(4,Ss),this.Pa=new Br,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new jn),this.Hd=0,this.rb=Array(new zi),this.sb=0,this.wa=Array(new dr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Cs),this.L=this.aa=0,this.gd=u([4,2],dr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ci(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function hr(){var b=new Po;return b!=null&&(b.a=0,b.sc="OK",b.cb=0,b.Xb=0,Xn||(Xn=Lr)),b}function qn(b,P,q){return b.a==0&&(b.a=P,b.sc=q,b.cb=0),0}function bo(b,P,q){return 3<=q&&b[P+0]==157&&b[P+1]==1&&b[P+2]==42}function wo(b,P){if(b==null)return 0;if(b.a=0,b.sc="OK",P==null)return qn(b,2,"null VP8Io passed to VP8GetHeaders()");var q=P.data,oe=P.w,we=P.ha;if(4>we)return qn(b,7,"Truncated header.");var Ee=q[oe+0]|q[oe+1]<<8|q[oe+2]<<16,Ae=b.Od;if(Ae.Rb=!(1&Ee),Ae.td=Ee>>1&7,Ae.yd=Ee>>4&1,Ae.ub=Ee>>5,3<Ae.td)return qn(b,3,"Incorrect keyframe parameters.");if(!Ae.yd)return qn(b,4,"Frame not displayable.");oe+=3,we-=3;var Te=b.Kc;if(Ae.Rb){if(7>we)return qn(b,7,"cannot parse picture header");if(!bo(q,oe,we))return qn(b,3,"Bad code word");Te.c=16383&(q[oe+4]<<8|q[oe+3]),Te.Td=q[oe+4]>>6,Te.i=16383&(q[oe+6]<<8|q[oe+5]),Te.Ud=q[oe+6]>>6,oe+=7,we-=7,b.za=Te.c+15>>4,b.Ub=Te.i+15>>4,P.width=Te.c,P.height=Te.i,P.Da=0,P.j=0,P.v=0,P.va=P.width,P.o=P.height,P.da=0,P.ib=P.width,P.hb=P.height,P.U=P.width,P.T=P.height,i((Ee=b.Pa).jb,0,255,Ee.jb.length),t((Ee=b.Qa)!=null),Ee.Cb=0,Ee.Bb=0,Ee.Fb=1,i(Ee.Zb,0,0,Ee.Zb.length),i(Ee.Lb,0,0,Ee.Lb)}if(Ae.ub>we)return qn(b,7,"bad partition length");W(Ee=b.m,q,oe,Ae.ub),oe+=Ae.ub,we-=Ae.ub,Ae.Rb&&(Te.Ld=k(Ee),Te.Kd=k(Ee)),Te=b.Qa;var Ie,Ve=b.Pa;if(t(Ee!=null),t(Te!=null),Te.Cb=k(Ee),Te.Cb){if(Te.Bb=k(Ee),k(Ee)){for(Te.Fb=k(Ee),Ie=0;4>Ie;++Ie)Te.Zb[Ie]=k(Ee)?J(Ee,7):0;for(Ie=0;4>Ie;++Ie)Te.Lb[Ie]=k(Ee)?J(Ee,6):0}if(Te.Bb)for(Ie=0;3>Ie;++Ie)Ve.jb[Ie]=k(Ee)?G(Ee,8):255}else Te.Bb=0;if(Ee.Ka)return qn(b,3,"cannot parse segment header");if((Te=b.ed).zd=k(Ee),Te.Tb=G(Ee,6),Te.wb=G(Ee,3),Te.Pc=k(Ee),Te.Pc&&k(Ee)){for(Ve=0;4>Ve;++Ve)k(Ee)&&(Te.vd[Ve]=J(Ee,6));for(Ve=0;4>Ve;++Ve)k(Ee)&&(Te.od[Ve]=J(Ee,6))}if(b.L=Te.Tb==0?0:Te.zd?1:2,Ee.Ka)return qn(b,3,"cannot parse filter header");var dt=we;if(we=Ie=oe,oe=Ie+dt,Te=dt,b.Xb=(1<<G(b.m,2))-1,dt<3*(Ve=b.Xb))q=7;else{for(Ie+=3*Ve,Te-=3*Ve,dt=0;dt<Ve;++dt){var Nt=q[we+0]|q[we+1]<<8|q[we+2]<<16;Nt>Te&&(Nt=Te),W(b.Jc[+dt],q,Ie,Nt),Ie+=Nt,Te-=Nt,we+=3}W(b.Jc[+Ve],q,Ie,Te),q=Ie<oe?0:5}if(q!=0)return qn(b,q,"cannot parse partitions");for(q=G(Ie=b.m,7),we=k(Ie)?J(Ie,4):0,oe=k(Ie)?J(Ie,4):0,Te=k(Ie)?J(Ie,4):0,Ve=k(Ie)?J(Ie,4):0,Ie=k(Ie)?J(Ie,4):0,dt=b.Qa,Nt=0;4>Nt;++Nt){if(dt.Cb){var Dt=dt.Zb[Nt];dt.Fb||(Dt+=q)}else{if(0<Nt){b.pb[Nt]=b.pb[0];continue}Dt=q}var wt=b.pb[Nt];wt.Sc[0]=an[Vr(Dt+we,127)],wt.Sc[1]=Dn[Vr(Dt+0,127)],wt.Eb[0]=2*an[Vr(Dt+oe,127)],wt.Eb[1]=101581*Dn[Vr(Dt+Te,127)]>>16,8>wt.Eb[1]&&(wt.Eb[1]=8),wt.Qc[0]=an[Vr(Dt+Ve,117)],wt.Qc[1]=Dn[Vr(Dt+Ie,127)],wt.lc=Dt+Ie}if(!Ae.Rb)return qn(b,4,"Not a key frame.");for(k(Ee),Ae=b.Pa,q=0;4>q;++q){for(we=0;8>we;++we)for(oe=0;3>oe;++oe)for(Te=0;11>Te;++Te)Ve=ae(Ee,gs[q][we][oe][Te])?G(Ee,8):Do[q][we][oe][Te],Ae.Wc[q][we].Yb[oe][Te]=Ve;for(we=0;17>we;++we)Ae.Xc[q][we]=Ae.Wc[q][wc[we]]}return b.kc=k(Ee),b.kc&&(b.Bd=G(Ee,8)),b.cb=1}function Lr(b,P,q,oe,we,Ee,Ae){var Te=P[we].Yb[q];for(q=0;16>we;++we){if(!ae(b,Te[q+0]))return we;for(;!ae(b,Te[q+1]);)if(Te=P[++we].Yb[0],q=0,we==16)return 16;var Ie=P[we+1].Yb;if(ae(b,Te[q+2])){var Ve=b,dt=0;if(ae(Ve,(Dt=Te)[(Nt=q)+3]))if(ae(Ve,Dt[Nt+6])){for(Te=0,Nt=2*(dt=ae(Ve,Dt[Nt+8]))+(Dt=ae(Ve,Dt[Nt+9+dt])),dt=0,Dt=zr[Nt];Dt[Te];++Te)dt+=dt+ae(Ve,Dt[Te]);dt+=3+(8<<Nt)}else ae(Ve,Dt[Nt+7])?(dt=7+2*ae(Ve,165),dt+=ae(Ve,145)):dt=5+ae(Ve,159);else dt=ae(Ve,Dt[Nt+4])?3+ae(Ve,Dt[Nt+5]):2;Te=Ie[2]}else dt=1,Te=Ie[1];Ie=Ae+mo[we],0>(Ve=b).b&&se(Ve);var Nt,Dt=Ve.b,wt=(Nt=Ve.Ca>>1)-(Ve.I>>Dt)>>31;--Ve.b,Ve.Ca+=wt,Ve.Ca|=1,Ve.I-=(Nt+1&wt)<<Dt,Ee[Ie]=((dt^wt)-wt)*oe[(0<we)+0]}return 16}function Us(b){var P=b.rb[b.sb-1];P.la=0,P.Na=0,i(b.zc,0,0,b.zc.length),b.ja=0}function Gn(b,P){if(b==null)return 0;if(P==null)return qn(b,2,"NULL VP8Io parameter in VP8Decode().");if(!b.cb&&!wo(b,P))return 0;if(t(b.cb),P.ac==null||P.ac(P)){P.ob&&(b.L=0);var q=Pa[b.L];if(b.L==2?(b.yb=0,b.zb=0):(b.yb=P.v-q>>4,b.zb=P.j-q>>4,0>b.yb&&(b.yb=0),0>b.zb&&(b.zb=0)),b.Va=P.o+15+q>>4,b.Hb=P.va+15+q>>4,b.Hb>b.za&&(b.Hb=b.za),b.Va>b.Ub&&(b.Va=b.Ub),0<b.L){var oe=b.ed;for(q=0;4>q;++q){var we;if(b.Qa.Cb){var Ee=b.Qa.Lb[q];b.Qa.Fb||(Ee+=oe.Tb)}else Ee=oe.Tb;for(we=0;1>=we;++we){var Ae=b.gd[q][we],Te=Ee;if(oe.Pc&&(Te+=oe.vd[0],we&&(Te+=oe.od[0])),0<(Te=0>Te?0:63<Te?63:Te)){var Ie=Te;0<oe.wb&&(Ie=4<oe.wb?Ie>>2:Ie>>1)>9-oe.wb&&(Ie=9-oe.wb),1>Ie&&(Ie=1),Ae.dd=Ie,Ae.tc=2*Te+Ie,Ae.ld=40<=Te?2:15<=Te?1:0}else Ae.tc=0;Ae.La=we}}}q=0}else qn(b,6,"Frame setup failed"),q=b.a;if(q=q==0){if(q){b.$c=0,0<b.Aa||(b.Ic=dh);e:{q=b.Ic,oe=4*(Ie=b.za);var Ve=32*Ie,dt=Ie+1,Nt=0<b.L?Ie*(0<b.Aa?2:1):0,Dt=(b.Aa==2?2:1)*Ie;if((Ae=oe+832+(we=3*(16*q+Pa[b.L])/2*Ve)+(Ee=b.Fa!=null&&0<b.Fa.length?b.Kc.c*b.Kc.i:0))!=Ae)q=0;else{if(Ae>b.Vb){if(b.Vb=0,b.Ec=s(Ae),b.Fc=0,b.Ec==null){q=qn(b,1,"no memory during frame initialization.");break e}b.Vb=Ae}Ae=b.Ec,Te=b.Fc,b.Ac=Ae,b.Bc=Te,Te+=oe,b.Gd=o(Ve,jn),b.Hd=0,b.rb=o(dt+1,zi),b.sb=1,b.wa=Nt?o(Nt,dr):null,b.Y=0,b.D.Nb=0,b.D.wa=b.wa,b.D.Y=b.Y,0<b.Aa&&(b.D.Y+=Ie),t(!0),b.oc=Ae,b.pc=Te,Te+=832,b.ya=o(Dt,Cs),b.aa=0,b.D.ya=b.ya,b.D.aa=b.aa,b.Aa==2&&(b.D.aa+=Ie),b.R=16*Ie,b.B=8*Ie,Ie=(Ve=Pa[b.L])*b.R,Ve=Ve/2*b.B,b.sa=Ae,b.ta=Te+Ie,b.qa=b.sa,b.ra=b.ta+16*q*b.R+Ve,b.Ha=b.qa,b.Ia=b.ra+8*q*b.B+Ve,b.$c=0,Te+=we,b.mb=Ee?Ae:null,b.nb=Ee?Te:null,t(Te+Ee<=b.Fc+b.Vb),Us(b),i(b.Ac,b.Bc,0,oe),q=1}}if(q){if(P.ka=0,P.y=b.sa,P.O=b.ta,P.f=b.qa,P.N=b.ra,P.ea=b.Ha,P.Vd=b.Ia,P.fa=b.R,P.Rc=b.B,P.F=null,P.J=0,!xu){for(q=-255;255>=q;++q)Ri[255+q]=0>q?-q:q;for(q=-1020;1020>=q;++q)ks[1020+q]=-128>q?-128:127<q?127:q;for(q=-112;112>=q;++q)ds[112+q]=-16>q?-16:15<q?15:q;for(q=-255;510>=q;++q)Bs[255+q]=0>q?0:255<q?255:q;xu=1}_t=Qo,Zt=fo,An=xo,Kn=Mi,wr=fs,At=ai,Vi=Ql,Li=ta,Ol=Os,rs=Dl,Gi=Tl,oa=Nl,Sa=bi,sa=Yu,aa=no,la=or,Qr=ro,Ws=ll,Ys[0]=Nr,Ys[1]=di,Ys[2]=br,Ys[3]=Jr,Ys[4]=jo,Ys[5]=sl,Ys[6]=ol,Ys[7]=Gs,Ys[8]=bu,Ys[9]=Ua,ca[0]=va,ca[1]=Fo,ca[2]=eo,ca[3]=Lo,ca[4]=to,ca[5]=il,ca[6]=ya,Rs[0]=Va,Rs[1]=Is,Rs[2]=Ml,Rs[3]=Sr,Rs[4]=Al,Rs[5]=Ku,Rs[6]=Jl,q=1}else q=0}q&&(q=function(wt,Yt){for(wt.M=0;wt.M<wt.Va;++wt.M){var Vt,pt=wt.Jc[wt.M&wt.Xb],yt=wt.m,en=wt;for(Vt=0;Vt<en.za;++Vt){var fn=yt,nn=en,kn=nn.Ac,Sn=nn.Bc+4*Vt,Qn=nn.zc,l=nn.ya[nn.aa+Vt];if(nn.Qa.Bb?l.$b=ae(fn,nn.Pa.jb[0])?2+ae(fn,nn.Pa.jb[2]):ae(fn,nn.Pa.jb[1]):l.$b=0,nn.kc&&(l.Ad=ae(fn,nn.Bd)),l.Za=!ae(fn,145)+0,l.Za){var h=l.Ob,v=0;for(nn=0;4>nn;++nn){var w,C=Qn[0+nn];for(w=0;4>w;++w){C=Hi[kn[Sn+w]][C];for(var z=Ji[ae(fn,C[0])];0<z;)z=Ji[2*z+ae(fn,C[z])];C=-z,kn[Sn+w]=C}r(h,v,kn,Sn,4),v+=4,Qn[0+nn]=C}}else C=ae(fn,156)?ae(fn,128)?1:3:ae(fn,163)?2:0,l.Ob[0]=C,i(kn,Sn,C,4),i(Qn,0,C,4);l.Dd=ae(fn,142)?ae(fn,114)?ae(fn,183)?1:3:2:0}if(en.m.Ka)return qn(wt,7,"Premature end-of-partition0 encountered.");for(;wt.ja<wt.za;++wt.ja){if(en=pt,fn=(yt=wt).rb[yt.sb-1],kn=yt.rb[yt.sb+yt.ja],Vt=yt.ya[yt.aa+yt.ja],Sn=yt.kc?Vt.Ad:0)fn.la=kn.la=0,Vt.Za||(fn.Na=kn.Na=0),Vt.Hc=0,Vt.Gc=0,Vt.ia=0;else{var X,re;if(fn=kn,kn=en,Sn=yt.Pa.Xc,Qn=yt.ya[yt.aa+yt.ja],l=yt.pb[Qn.$b],nn=Qn.ad,h=0,v=yt.rb[yt.sb-1],C=w=0,i(nn,h,0,384),Qn.Za)var he=0,Se=Sn[3];else{z=s(16);var Je=fn.Na+v.Na;if(Je=Xn(kn,Sn[1],Je,l.Eb,0,z,0),fn.Na=v.Na=(0<Je)+0,1<Je)_t(z,0,nn,h);else{var ze=z[0]+3>>3;for(z=0;256>z;z+=16)nn[h+z]=ze}he=1,Se=Sn[0]}var vt=15&fn.la,kt=15&v.la;for(z=0;4>z;++z){var Xt=1&kt;for(ze=re=0;4>ze;++ze)vt=vt>>1|(Xt=(Je=Xn(kn,Se,Je=Xt+(1&vt),l.Sc,he,nn,h))>he)<<7,re=re<<2|(3<Je?3:1<Je?2:nn[h+0]!=0),h+=16;vt>>=4,kt=kt>>1|Xt<<7,w=(w<<8|re)>>>0}for(Se=vt,he=kt>>4,X=0;4>X;X+=2){for(re=0,vt=fn.la>>4+X,kt=v.la>>4+X,z=0;2>z;++z){for(Xt=1&kt,ze=0;2>ze;++ze)Je=Xt+(1&vt),vt=vt>>1|(Xt=0<(Je=Xn(kn,Sn[2],Je,l.Qc,0,nn,h)))<<3,re=re<<2|(3<Je?3:1<Je?2:nn[h+0]!=0),h+=16;vt>>=2,kt=kt>>1|Xt<<5}C|=re<<4*X,Se|=vt<<4<<X,he|=(240&kt)<<X}fn.la=Se,v.la=he,Qn.Hc=w,Qn.Gc=C,Qn.ia=43690&C?0:l.ia,Sn=!(w|C)}if(0<yt.L&&(yt.wa[yt.Y+yt.ja]=yt.gd[Vt.$b][Vt.Za],yt.wa[yt.Y+yt.ja].La|=!Sn),en.Ka)return qn(wt,7,"Premature end-of-file encountered.")}if(Us(wt),yt=Yt,en=1,Vt=(pt=wt).D,fn=0<pt.L&&pt.M>=pt.zb&&pt.M<=pt.Va,pt.Aa==0)e:{if(Vt.M=pt.M,Vt.uc=fn,eu(pt,Vt),en=1,Vt=(re=pt.D).Nb,fn=(C=Pa[pt.L])*pt.R,kn=C/2*pt.B,z=16*Vt*pt.R,ze=8*Vt*pt.B,Sn=pt.sa,Qn=pt.ta-fn+z,l=pt.qa,nn=pt.ra-kn+ze,h=pt.Ha,v=pt.Ia-kn+ze,kt=(vt=re.M)==0,w=vt>=pt.Va-1,pt.Aa==2&&eu(pt,re),re.uc)for(Xt=(Je=pt).D.M,t(Je.D.uc),re=Je.yb;re<Je.Hb;++re){he=re,Se=Xt;var yn=(bn=(Me=Je).D).Nb;X=Me.R;var bn=bn.wa[bn.Y+he],ur=Me.sa,Ye=Me.ta+16*yn*X+16*he,nt=bn.dd,ht=bn.tc;if(ht!=0)if(t(3<=ht),Me.L==1)0<he&&la(ur,Ye,X,ht+4),bn.La&&Ws(ur,Ye,X,ht),0<Se&&aa(ur,Ye,X,ht+4),bn.La&&Qr(ur,Ye,X,ht);else{var Ot=Me.B,bt=Me.qa,Tt=Me.ra+8*yn*Ot+8*he,ve=Me.Ha,Me=Me.Ia+8*yn*Ot+8*he;yn=bn.ld,0<he&&(Li(ur,Ye,X,ht+4,nt,yn),rs(bt,Tt,ve,Me,Ot,ht+4,nt,yn)),bn.La&&(oa(ur,Ye,X,ht,nt,yn),sa(bt,Tt,ve,Me,Ot,ht,nt,yn)),0<Se&&(Vi(ur,Ye,X,ht+4,nt,yn),Ol(bt,Tt,ve,Me,Ot,ht+4,nt,yn)),bn.La&&(Gi(ur,Ye,X,ht,nt,yn),Sa(bt,Tt,ve,Me,Ot,ht,nt,yn))}}if(pt.ia&&alert("todo:DitherRow"),yt.put!=null){if(re=16*vt,vt=16*(vt+1),kt?(yt.y=pt.sa,yt.O=pt.ta+z,yt.f=pt.qa,yt.N=pt.ra+ze,yt.ea=pt.Ha,yt.W=pt.Ia+ze):(re-=C,yt.y=Sn,yt.O=Qn,yt.f=l,yt.N=nn,yt.ea=h,yt.W=v),w||(vt-=C),vt>yt.o&&(vt=yt.o),yt.F=null,yt.J=null,pt.Fa!=null&&0<pt.Fa.length&&re<vt&&(yt.J=io(pt,yt,re,vt-re),yt.F=pt.mb,yt.F==null&&yt.F.length==0)){en=qn(pt,3,"Could not decode alpha data.");break e}re<yt.j&&(C=yt.j-re,re=yt.j,t(!(1&C)),yt.O+=pt.R*C,yt.N+=pt.B*(C>>1),yt.W+=pt.B*(C>>1),yt.F!=null&&(yt.J+=yt.width*C)),re<vt&&(yt.O+=yt.v,yt.N+=yt.v>>1,yt.W+=yt.v>>1,yt.F!=null&&(yt.J+=yt.v),yt.ka=re-yt.j,yt.U=yt.va-yt.v,yt.T=vt-re,en=yt.put(yt))}Vt+1!=pt.Ic||w||(r(pt.sa,pt.ta-fn,Sn,Qn+16*pt.R,fn),r(pt.qa,pt.ra-kn,l,nn+8*pt.B,kn),r(pt.Ha,pt.Ia-kn,h,v+8*pt.B,kn))}if(!en)return qn(wt,6,"Output aborted.")}return 1}(b,P)),P.bc!=null&&P.bc(P),q&=1}return q?(b.cb=0,q):0}function _r(b,P,q,oe,we){we=b[P+q+32*oe]+(we>>3),b[P+q+32*oe]=-256&we?0>we?0:255:we}function Yr(b,P,q,oe,we,Ee){_r(b,P,0,q,oe+we),_r(b,P,1,q,oe+Ee),_r(b,P,2,q,oe-Ee),_r(b,P,3,q,oe-we)}function _n(b){return(20091*b>>16)+b}function tn(b,P,q,oe){var we,Ee=0,Ae=s(16);for(we=0;4>we;++we){var Te=b[P+0]+b[P+8],Ie=b[P+0]-b[P+8],Ve=(35468*b[P+4]>>16)-_n(b[P+12]),dt=_n(b[P+4])+(35468*b[P+12]>>16);Ae[Ee+0]=Te+dt,Ae[Ee+1]=Ie+Ve,Ae[Ee+2]=Ie-Ve,Ae[Ee+3]=Te-dt,Ee+=4,P++}for(we=Ee=0;4>we;++we)Te=(b=Ae[Ee+0]+4)+Ae[Ee+8],Ie=b-Ae[Ee+8],Ve=(35468*Ae[Ee+4]>>16)-_n(Ae[Ee+12]),_r(q,oe,0,0,Te+(dt=_n(Ae[Ee+4])+(35468*Ae[Ee+12]>>16))),_r(q,oe,1,0,Ie+Ve),_r(q,oe,2,0,Ie-Ve),_r(q,oe,3,0,Te-dt),Ee++,oe+=32}function ai(b,P,q,oe){var we=b[P+0]+4,Ee=35468*b[P+4]>>16,Ae=_n(b[P+4]),Te=35468*b[P+1]>>16;Yr(q,oe,0,we+Ae,b=_n(b[P+1]),Te),Yr(q,oe,1,we+Ee,b,Te),Yr(q,oe,2,we-Ee,b,Te),Yr(q,oe,3,we-Ae,b,Te)}function fo(b,P,q,oe,we){tn(b,P,q,oe),we&&tn(b,P+16,q,oe+4)}function xo(b,P,q,oe){Zt(b,P+0,q,oe,1),Zt(b,P+32,q,oe+128,1)}function Mi(b,P,q,oe){var we;for(b=b[P+0]+4,we=0;4>we;++we)for(P=0;4>P;++P)_r(q,oe,P,we,b)}function fs(b,P,q,oe){b[P+0]&&Kn(b,P+0,q,oe),b[P+16]&&Kn(b,P+16,q,oe+4),b[P+32]&&Kn(b,P+32,q,oe+128),b[P+48]&&Kn(b,P+48,q,oe+128+4)}function Qo(b,P,q,oe){var we,Ee=s(16);for(we=0;4>we;++we){var Ae=b[P+0+we]+b[P+12+we],Te=b[P+4+we]+b[P+8+we],Ie=b[P+4+we]-b[P+8+we],Ve=b[P+0+we]-b[P+12+we];Ee[0+we]=Ae+Te,Ee[8+we]=Ae-Te,Ee[4+we]=Ve+Ie,Ee[12+we]=Ve-Ie}for(we=0;4>we;++we)Ae=(b=Ee[0+4*we]+3)+Ee[3+4*we],Te=Ee[1+4*we]+Ee[2+4*we],Ie=Ee[1+4*we]-Ee[2+4*we],Ve=b-Ee[3+4*we],q[oe+0]=Ae+Te>>3,q[oe+16]=Ve+Ie>>3,q[oe+32]=Ae-Te>>3,q[oe+48]=Ve-Ie>>3,oe+=64}function Ro(b,P,q){var oe,we=P-32,Ee=Oi,Ae=255-b[we-1];for(oe=0;oe<q;++oe){var Te,Ie=Ee,Ve=Ae+b[P-1];for(Te=0;Te<q;++Te)b[P+Te]=Ie[Ve+b[we+Te]];P+=32}}function di(b,P){Ro(b,P,4)}function Is(b,P){Ro(b,P,8)}function Fo(b,P){Ro(b,P,16)}function eo(b,P){var q;for(q=0;16>q;++q)r(b,P+32*q,b,P-32,16)}function Lo(b,P){var q;for(q=16;0<q;--q)i(b,P,b[P-1],16),P+=32}function Vs(b,P,q){var oe;for(oe=0;16>oe;++oe)i(P,q+32*oe,b,16)}function va(b,P){var q,oe=16;for(q=0;16>q;++q)oe+=b[P-1+32*q]+b[P+q-32];Vs(oe>>5,b,P)}function to(b,P){var q,oe=8;for(q=0;16>q;++q)oe+=b[P-1+32*q];Vs(oe>>4,b,P)}function il(b,P){var q,oe=8;for(q=0;16>q;++q)oe+=b[P+q-32];Vs(oe>>4,b,P)}function ya(b,P){Vs(128,b,P)}function gr(b,P,q){return b+2*P+q+2>>2}function br(b,P){var q,oe=P-32;for(oe=new Uint8Array([gr(b[oe-1],b[oe+0],b[oe+1]),gr(b[oe+0],b[oe+1],b[oe+2]),gr(b[oe+1],b[oe+2],b[oe+3]),gr(b[oe+2],b[oe+3],b[oe+4])]),q=0;4>q;++q)r(b,P+32*q,oe,0,oe.length)}function Jr(b,P){var q=b[P-1],oe=b[P-1+32],we=b[P-1+64],Ee=b[P-1+96];ke(b,P+0,16843009*gr(b[P-1-32],q,oe)),ke(b,P+32,16843009*gr(q,oe,we)),ke(b,P+64,16843009*gr(oe,we,Ee)),ke(b,P+96,16843009*gr(we,Ee,Ee))}function Nr(b,P){var q,oe=4;for(q=0;4>q;++q)oe+=b[P+q-32]+b[P-1+32*q];for(oe>>=3,q=0;4>q;++q)i(b,P+32*q,oe,4)}function jo(b,P){var q=b[P-1+0],oe=b[P-1+32],we=b[P-1+64],Ee=b[P-1-32],Ae=b[P+0-32],Te=b[P+1-32],Ie=b[P+2-32],Ve=b[P+3-32];b[P+0+96]=gr(oe,we,b[P-1+96]),b[P+1+96]=b[P+0+64]=gr(q,oe,we),b[P+2+96]=b[P+1+64]=b[P+0+32]=gr(Ee,q,oe),b[P+3+96]=b[P+2+64]=b[P+1+32]=b[P+0+0]=gr(Ae,Ee,q),b[P+3+64]=b[P+2+32]=b[P+1+0]=gr(Te,Ae,Ee),b[P+3+32]=b[P+2+0]=gr(Ie,Te,Ae),b[P+3+0]=gr(Ve,Ie,Te)}function ol(b,P){var q=b[P+1-32],oe=b[P+2-32],we=b[P+3-32],Ee=b[P+4-32],Ae=b[P+5-32],Te=b[P+6-32],Ie=b[P+7-32];b[P+0+0]=gr(b[P+0-32],q,oe),b[P+1+0]=b[P+0+32]=gr(q,oe,we),b[P+2+0]=b[P+1+32]=b[P+0+64]=gr(oe,we,Ee),b[P+3+0]=b[P+2+32]=b[P+1+64]=b[P+0+96]=gr(we,Ee,Ae),b[P+3+32]=b[P+2+64]=b[P+1+96]=gr(Ee,Ae,Te),b[P+3+64]=b[P+2+96]=gr(Ae,Te,Ie),b[P+3+96]=gr(Te,Ie,Ie)}function sl(b,P){var q=b[P-1+0],oe=b[P-1+32],we=b[P-1+64],Ee=b[P-1-32],Ae=b[P+0-32],Te=b[P+1-32],Ie=b[P+2-32],Ve=b[P+3-32];b[P+0+0]=b[P+1+64]=Ee+Ae+1>>1,b[P+1+0]=b[P+2+64]=Ae+Te+1>>1,b[P+2+0]=b[P+3+64]=Te+Ie+1>>1,b[P+3+0]=Ie+Ve+1>>1,b[P+0+96]=gr(we,oe,q),b[P+0+64]=gr(oe,q,Ee),b[P+0+32]=b[P+1+96]=gr(q,Ee,Ae),b[P+1+32]=b[P+2+96]=gr(Ee,Ae,Te),b[P+2+32]=b[P+3+96]=gr(Ae,Te,Ie),b[P+3+32]=gr(Te,Ie,Ve)}function Gs(b,P){var q=b[P+0-32],oe=b[P+1-32],we=b[P+2-32],Ee=b[P+3-32],Ae=b[P+4-32],Te=b[P+5-32],Ie=b[P+6-32],Ve=b[P+7-32];b[P+0+0]=q+oe+1>>1,b[P+1+0]=b[P+0+64]=oe+we+1>>1,b[P+2+0]=b[P+1+64]=we+Ee+1>>1,b[P+3+0]=b[P+2+64]=Ee+Ae+1>>1,b[P+0+32]=gr(q,oe,we),b[P+1+32]=b[P+0+96]=gr(oe,we,Ee),b[P+2+32]=b[P+1+96]=gr(we,Ee,Ae),b[P+3+32]=b[P+2+96]=gr(Ee,Ae,Te),b[P+3+64]=gr(Ae,Te,Ie),b[P+3+96]=gr(Te,Ie,Ve)}function Ua(b,P){var q=b[P-1+0],oe=b[P-1+32],we=b[P-1+64],Ee=b[P-1+96];b[P+0+0]=q+oe+1>>1,b[P+2+0]=b[P+0+32]=oe+we+1>>1,b[P+2+32]=b[P+0+64]=we+Ee+1>>1,b[P+1+0]=gr(q,oe,we),b[P+3+0]=b[P+1+32]=gr(oe,we,Ee),b[P+3+32]=b[P+1+64]=gr(we,Ee,Ee),b[P+3+64]=b[P+2+64]=b[P+0+96]=b[P+1+96]=b[P+2+96]=b[P+3+96]=Ee}function bu(b,P){var q=b[P-1+0],oe=b[P-1+32],we=b[P-1+64],Ee=b[P-1+96],Ae=b[P-1-32],Te=b[P+0-32],Ie=b[P+1-32],Ve=b[P+2-32];b[P+0+0]=b[P+2+32]=q+Ae+1>>1,b[P+0+32]=b[P+2+64]=oe+q+1>>1,b[P+0+64]=b[P+2+96]=we+oe+1>>1,b[P+0+96]=Ee+we+1>>1,b[P+3+0]=gr(Te,Ie,Ve),b[P+2+0]=gr(Ae,Te,Ie),b[P+1+0]=b[P+3+32]=gr(q,Ae,Te),b[P+1+32]=b[P+3+64]=gr(oe,q,Ae),b[P+1+64]=b[P+3+96]=gr(we,oe,q),b[P+1+96]=gr(Ee,we,oe)}function Ml(b,P){var q;for(q=0;8>q;++q)r(b,P+32*q,b,P-32,8)}function Sr(b,P){var q;for(q=0;8>q;++q)i(b,P,b[P-1],8),P+=32}function qr(b,P,q){var oe;for(oe=0;8>oe;++oe)i(P,q+32*oe,b,8)}function Va(b,P){var q,oe=8;for(q=0;8>q;++q)oe+=b[P+q-32]+b[P-1+32*q];qr(oe>>4,b,P)}function Ku(b,P){var q,oe=4;for(q=0;8>q;++q)oe+=b[P+q-32];qr(oe>>3,b,P)}function Al(b,P){var q,oe=4;for(q=0;8>q;++q)oe+=b[P-1+32*q];qr(oe>>3,b,P)}function Jl(b,P){qr(128,b,P)}function al(b,P,q){var oe=b[P-q],we=b[P+0],Ee=3*(we-oe)+ua[1020+b[P-2*q]-b[P+q]],Ae=go[112+(Ee+4>>3)];b[P-q]=Oi[255+oe+go[112+(Ee+3>>3)]],b[P+0]=Oi[255+we-Ae]}function kl(b,P,q,oe){var we=b[P+0],Ee=b[P+q];return qo[255+b[P-2*q]-b[P-q]]>oe||qo[255+Ee-we]>oe}function Xl(b,P,q,oe){return 4*qo[255+b[P-q]-b[P+0]]+qo[255+b[P-2*q]-b[P+q]]<=oe}function Xr(b,P,q,oe,we){var Ee=b[P-3*q],Ae=b[P-2*q],Te=b[P-q],Ie=b[P+0],Ve=b[P+q],dt=b[P+2*q],Nt=b[P+3*q];return 4*qo[255+Te-Ie]+qo[255+Ae-Ve]>oe?0:qo[255+b[P-4*q]-Ee]<=we&&qo[255+Ee-Ae]<=we&&qo[255+Ae-Te]<=we&&qo[255+Nt-dt]<=we&&qo[255+dt-Ve]<=we&&qo[255+Ve-Ie]<=we}function no(b,P,q,oe){var we=2*oe+1;for(oe=0;16>oe;++oe)Xl(b,P+oe,q,we)&&al(b,P+oe,q)}function or(b,P,q,oe){var we=2*oe+1;for(oe=0;16>oe;++oe)Xl(b,P+oe*q,1,we)&&al(b,P+oe*q,1)}function ro(b,P,q,oe){var we;for(we=3;0<we;--we)no(b,P+=4*q,q,oe)}function ll(b,P,q,oe){var we;for(we=3;0<we;--we)or(b,P+=4,q,oe)}function _a(b,P,q,oe,we,Ee,Ae,Te){for(Ee=2*Ee+1;0<we--;){if(Xr(b,P,q,Ee,Ae))if(kl(b,P,q,Te))al(b,P,q);else{var Ie=b,Ve=P,dt=q,Nt=Ie[Ve-2*dt],Dt=Ie[Ve-dt],wt=Ie[Ve+0],Yt=Ie[Ve+dt],Vt=Ie[Ve+2*dt],pt=27*(en=ua[1020+3*(wt-Dt)+ua[1020+Nt-Yt]])+63>>7,yt=18*en+63>>7,en=9*en+63>>7;Ie[Ve-3*dt]=Oi[255+Ie[Ve-3*dt]+en],Ie[Ve-2*dt]=Oi[255+Nt+yt],Ie[Ve-dt]=Oi[255+Dt+pt],Ie[Ve+0]=Oi[255+wt-pt],Ie[Ve+dt]=Oi[255+Yt-yt],Ie[Ve+2*dt]=Oi[255+Vt-en]}P+=oe}}function Ui(b,P,q,oe,we,Ee,Ae,Te){for(Ee=2*Ee+1;0<we--;){if(Xr(b,P,q,Ee,Ae))if(kl(b,P,q,Te))al(b,P,q);else{var Ie=b,Ve=P,dt=q,Nt=Ie[Ve-dt],Dt=Ie[Ve+0],wt=Ie[Ve+dt],Yt=go[112+((Vt=3*(Dt-Nt))+4>>3)],Vt=go[112+(Vt+3>>3)],pt=Yt+1>>1;Ie[Ve-2*dt]=Oi[255+Ie[Ve-2*dt]+pt],Ie[Ve-dt]=Oi[255+Nt+Vt],Ie[Ve+0]=Oi[255+Dt-Yt],Ie[Ve+dt]=Oi[255+wt-pt]}P+=oe}}function Ql(b,P,q,oe,we,Ee){_a(b,P,q,1,16,oe,we,Ee)}function ta(b,P,q,oe,we,Ee){_a(b,P,1,q,16,oe,we,Ee)}function Tl(b,P,q,oe,we,Ee){var Ae;for(Ae=3;0<Ae;--Ae)Ui(b,P+=4*q,q,1,16,oe,we,Ee)}function Nl(b,P,q,oe,we,Ee){var Ae;for(Ae=3;0<Ae;--Ae)Ui(b,P+=4,1,q,16,oe,we,Ee)}function Os(b,P,q,oe,we,Ee,Ae,Te){_a(b,P,we,1,8,Ee,Ae,Te),_a(q,oe,we,1,8,Ee,Ae,Te)}function Dl(b,P,q,oe,we,Ee,Ae,Te){_a(b,P,1,we,8,Ee,Ae,Te),_a(q,oe,1,we,8,Ee,Ae,Te)}function bi(b,P,q,oe,we,Ee,Ae,Te){Ui(b,P+4*we,we,1,8,Ee,Ae,Te),Ui(q,oe+4*we,we,1,8,Ee,Ae,Te)}function Yu(b,P,q,oe,we,Ee,Ae,Te){Ui(b,P+4,1,we,8,Ee,Ae,Te),Ui(q,oe+4,1,we,8,Ee,Ae,Te)}function Mo(){this.ba=new fr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new at,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Hs(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Il(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function qs(){this.ua=0,this.Wa=new me,this.vb=new me,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new $,this.yc=new B}function ul(){this.xb=this.a=0,this.l=new ci,this.ca=new fr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new N,this.Pb=0,this.wd=new N,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new qs,this.ab=0,this.gc=o(4,Il),this.Oc=0}function cl(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new ci,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function wi(b,P,q,oe,we,Ee,Ae){for(b=b==null?0:b[P+0],P=0;P<Ae;++P)we[Ee+P]=b+q[oe+P]&255,b=we[Ee+P]}function Es(b,P,q,oe,we,Ee,Ae){var Te;if(b==null)wi(null,null,q,oe,we,Ee,Ae);else for(Te=0;Te<Ae;++Te)we[Ee+Te]=b[P+Te]+q[oe+Te]&255}function ba(b,P,q,oe,we,Ee,Ae){if(b==null)wi(null,null,q,oe,we,Ee,Ae);else{var Te,Ie=b[P+0],Ve=Ie,dt=Ie;for(Te=0;Te<Ae;++Te)Ve=dt+(Ie=b[P+Te])-Ve,dt=q[oe+Te]+(-256&Ve?0>Ve?0:255:Ve)&255,Ve=Ie,we[Ee+Te]=dt}}function io(b,P,q,oe){var we=P.width,Ee=P.o;if(t(b!=null&&P!=null),0>q||0>=oe||q+oe>Ee)return null;if(!b.Cc){if(b.ga==null){var Ae;if(b.ga=new cl,(Ae=b.ga==null)||(Ae=P.width*P.o,t(b.Gb.length==0),b.Gb=s(Ae),b.Uc=0,b.Gb==null?Ae=0:(b.mb=b.Gb,b.nb=b.Uc,b.rc=null,Ae=1),Ae=!Ae),!Ae){Ae=b.ga;var Te=b.Fa,Ie=b.P,Ve=b.qc,dt=b.mb,Nt=b.nb,Dt=Ie+1,wt=Ve-1,Yt=Ae.l;if(t(Te!=null&&dt!=null&&P!=null),mi[0]=null,mi[1]=wi,mi[2]=Es,mi[3]=ba,Ae.ca=dt,Ae.tb=Nt,Ae.c=P.width,Ae.i=P.height,t(0<Ae.c&&0<Ae.i),1>=Ve)P=0;else if(Ae.$a=Te[Ie+0]>>0&3,Ae.Z=Te[Ie+0]>>2&3,Ae.Lc=Te[Ie+0]>>4&3,Ie=Te[Ie+0]>>6&3,0>Ae.$a||1<Ae.$a||4<=Ae.Z||1<Ae.Lc||Ie)P=0;else if(Yt.put=Zn,Yt.ac=Jn,Yt.bc=qt,Yt.ma=Ae,Yt.width=P.width,Yt.height=P.height,Yt.Da=P.Da,Yt.v=P.v,Yt.va=P.va,Yt.j=P.j,Yt.o=P.o,Ae.$a)e:{t(Ae.$a==1),P=ir();t:for(;;){if(P==null){P=0;break e}if(t(Ae!=null),Ae.mc=P,P.c=Ae.c,P.i=Ae.i,P.l=Ae.l,P.l.ma=Ae,P.l.width=Ae.c,P.l.height=Ae.i,P.a=0,Y(P.m,Te,Dt,wt),!Or(Ae.c,Ae.i,1,P,null)||(P.ab==1&&P.gc[0].hc==3&&Ii(P.s)?(Ae.ic=1,Te=P.c*P.i,P.Ta=null,P.Ua=0,P.V=s(Te),P.Ba=0,P.V==null?(P.a=1,P=0):P=1):(Ae.ic=0,P=jr(P,Ae.c)),!P))break t;P=1;break e}Ae.mc=null,P=0}else P=wt>=Ae.c*Ae.i;Ae=!P}if(Ae)return null;b.ga.Lc!=1?b.Ga=0:oe=Ee-q}t(b.ga!=null),t(q+oe<=Ee);e:{if(P=(Te=b.ga).c,Ee=Te.l.o,Te.$a==0){if(Dt=b.rc,wt=b.Vc,Yt=b.Fa,Ie=b.P+1+q*P,Ve=b.mb,dt=b.nb+q*P,t(Ie<=b.P+b.qc),Te.Z!=0)for(t(mi[Te.Z]!=null),Ae=0;Ae<oe;++Ae)mi[Te.Z](Dt,wt,Yt,Ie,Ve,dt,P),Dt=Ve,wt=dt,dt+=P,Ie+=P;else for(Ae=0;Ae<oe;++Ae)r(Ve,dt,Yt,Ie,P),Dt=Ve,wt=dt,dt+=P,Ie+=P;b.rc=Dt,b.Vc=wt}else{if(t(Te.mc!=null),P=q+oe,t((Ae=Te.mc)!=null),t(P<=Ae.i),Ae.C>=P)P=1;else if(Te.ic||xt(),Te.ic){Te=Ae.V,Dt=Ae.Ba,wt=Ae.c;var Vt=Ae.i,pt=(Yt=1,Ie=Ae.$/wt,Ve=Ae.$%wt,dt=Ae.m,Nt=Ae.s,Ae.$),yt=wt*Vt,en=wt*P,fn=Nt.wc,nn=pt<en?lt(Nt,Ve,Ie):null;t(pt<=yt),t(P<=Vt),t(Ii(Nt));t:for(;;){for(;!dt.h&&pt<en;){if(Ve&fn||(nn=lt(Nt,Ve,Ie)),t(nn!=null),_e(dt),256>(Vt=Ln(nn.G[0],nn.H[0],dt)))Te[Dt+pt]=Vt,++pt,++Ve>=wt&&(Ve=0,++Ie<=P&&!(Ie%16)&&Pr(Ae,Ie));else{if(!(280>Vt)){Yt=0;break t}Vt=Bt(Vt-256,dt);var kn,Sn=Ln(nn.G[4],nn.H[4],dt);if(_e(dt),!(pt>=(Sn=Kt(wt,Sn=Bt(Sn,dt)))&&yt-pt>=Vt)){Yt=0;break t}for(kn=0;kn<Vt;++kn)Te[Dt+pt+kn]=Te[Dt+pt+kn-Sn];for(pt+=Vt,Ve+=Vt;Ve>=wt;)Ve-=wt,++Ie<=P&&!(Ie%16)&&Pr(Ae,Ie);pt<en&&Ve&fn&&(nn=lt(Nt,Ve,Ie))}t(dt.h==fe(dt))}Pr(Ae,Ie>P?P:Ie);break t}!Yt||dt.h&&pt<yt?(Yt=0,Ae.a=dt.h?5:3):Ae.$=pt,P=Yt}else P=lr(Ae,Ae.V,Ae.Ba,Ae.c,Ae.i,P,rn);if(!P){oe=0;break e}}q+oe>=Ee&&(b.Cc=1),oe=1}if(!oe)return null;if(b.Cc&&((oe=b.ga)!=null&&(oe.mc=null),b.ga=null,0<b.Ga))return alert("todo:WebPDequantizeLevels"),null}return b.nb+q*we}function O(b,P,q,oe,we,Ee){for(;0<we--;){var Ae,Te=b,Ie=P+(q?1:0),Ve=b,dt=P+(q?0:3);for(Ae=0;Ae<oe;++Ae){var Nt=Ve[dt+4*Ae];Nt!=255&&(Nt*=32897,Te[Ie+4*Ae+0]=Te[Ie+4*Ae+0]*Nt>>23,Te[Ie+4*Ae+1]=Te[Ie+4*Ae+1]*Nt>>23,Te[Ie+4*Ae+2]=Te[Ie+4*Ae+2]*Nt>>23)}P+=Ee}}function be(b,P,q,oe,we){for(;0<oe--;){var Ee;for(Ee=0;Ee<q;++Ee){var Ae=b[P+2*Ee+0],Te=15&(Ve=b[P+2*Ee+1]),Ie=4369*Te,Ve=(240&Ve|Ve>>4)*Ie>>16;b[P+2*Ee+0]=(240&Ae|Ae>>4)*Ie>>16&240|(15&Ae|Ae<<4)*Ie>>16>>4&15,b[P+2*Ee+1]=240&Ve|Te}P+=we}}function Ke(b,P,q,oe,we,Ee,Ae,Te){var Ie,Ve,dt=255;for(Ve=0;Ve<we;++Ve){for(Ie=0;Ie<oe;++Ie){var Nt=b[P+Ie];Ee[Ae+4*Ie]=Nt,dt&=Nt}P+=q,Ae+=Te}return dt!=255}function ft(b,P,q,oe,we){var Ee;for(Ee=0;Ee<we;++Ee)q[oe+Ee]=b[P+Ee]>>8}function xt(){ko=O,Si=be,Ai=Ke,so=ft}function $t(b,P,q){H[b]=function(oe,we,Ee,Ae,Te,Ie,Ve,dt,Nt,Dt,wt,Yt,Vt,pt,yt,en,fn){var nn,kn=fn-1>>1,Sn=Te[Ie+0]|Ve[dt+0]<<16,Qn=Nt[Dt+0]|wt[Yt+0]<<16;t(oe!=null);var l=3*Sn+Qn+131074>>2;for(P(oe[we+0],255&l,l>>16,Vt,pt),Ee!=null&&(l=3*Qn+Sn+131074>>2,P(Ee[Ae+0],255&l,l>>16,yt,en)),nn=1;nn<=kn;++nn){var h=Te[Ie+nn]|Ve[dt+nn]<<16,v=Nt[Dt+nn]|wt[Yt+nn]<<16,w=Sn+h+Qn+v+524296,C=w+2*(h+Qn)>>3;l=C+Sn>>1,Sn=(w=w+2*(Sn+v)>>3)+h>>1,P(oe[we+2*nn-1],255&l,l>>16,Vt,pt+(2*nn-1)*q),P(oe[we+2*nn-0],255&Sn,Sn>>16,Vt,pt+(2*nn-0)*q),Ee!=null&&(l=w+Qn>>1,Sn=C+v>>1,P(Ee[Ae+2*nn-1],255&l,l>>16,yt,en+(2*nn-1)*q),P(Ee[Ae+2*nn+0],255&Sn,Sn>>16,yt,en+(2*nn+0)*q)),Sn=h,Qn=v}1&fn||(l=3*Sn+Qn+131074>>2,P(oe[we+fn-1],255&l,l>>16,Vt,pt+(fn-1)*q),Ee!=null&&(l=3*Qn+Sn+131074>>2,P(Ee[Ae+fn-1],255&l,l>>16,yt,en+(fn-1)*q)))}}function cn(){Wo[ps]=Ne,Wo[pr]=Lu,Wo[Ca]=ms,Wo[Ea]=Io,Wo[Zs]=Gr,Wo[is]=Wc,Wo[bc]=uh,Wo[To]=Lu,Wo[No]=Io,Wo[Ks]=Gr,Wo[a]=Wc}function Nn(b){return b&-16384?0>b?0:255:b>>gd}function zn(b,P){return Nn((19077*b>>8)+(26149*P>>8)-14234)}function nr(b,P,q){return Nn((19077*b>>8)-(6419*P>>8)-(13320*q>>8)+8708)}function vr(b,P){return Nn((19077*b>>8)+(33050*P>>8)-17685)}function Ur(b,P,q,oe,we){oe[we+0]=zn(b,q),oe[we+1]=nr(b,P,q),oe[we+2]=vr(b,P)}function $i(b,P,q,oe,we){oe[we+0]=vr(b,P),oe[we+1]=nr(b,P,q),oe[we+2]=zn(b,q)}function pi(b,P,q,oe,we){var Ee=nr(b,P,q);P=Ee<<3&224|vr(b,P)>>3,oe[we+0]=248&zn(b,q)|Ee>>5,oe[we+1]=P}function xi(b,P,q,oe,we){var Ee=240&vr(b,P)|15;oe[we+0]=240&zn(b,q)|nr(b,P,q)>>4,oe[we+1]=Ee}function oo(b,P,q,oe,we){oe[we+0]=255,Ur(b,P,q,oe,we+1)}function ho(b,P,q,oe,we){$i(b,P,q,oe,we),oe[we+3]=255}function Ps(b,P,q,oe,we){Ur(b,P,q,oe,we),oe[we+3]=255}function Vr(b,P){return 0>b?0:b>P?P:b}function zo(b,P,q){H[b]=function(oe,we,Ee,Ae,Te,Ie,Ve,dt,Nt){for(var Dt=dt+(-2&Nt)*q;dt!=Dt;)P(oe[we+0],Ee[Ae+0],Te[Ie+0],Ve,dt),P(oe[we+1],Ee[Ae+0],Te[Ie+0],Ve,dt+q),we+=2,++Ae,++Ie,dt+=2*q;1&Nt&&P(oe[we+0],Ee[Ae+0],Te[Ie+0],Ve,dt)}}function fl(b,P,q){return q==0?b==0?P==0?6:5:P==0?4:0:q}function es(b,P,q,oe,we){switch(b>>>30){case 3:Zt(P,q,oe,we,0);break;case 2:At(P,q,oe,we);break;case 1:Kn(P,q,oe,we)}}function eu(b,P){var q,oe,we=P.M,Ee=P.Nb,Ae=b.oc,Te=b.pc+40,Ie=b.oc,Ve=b.pc+584,dt=b.oc,Nt=b.pc+600;for(q=0;16>q;++q)Ae[Te+32*q-1]=129;for(q=0;8>q;++q)Ie[Ve+32*q-1]=129,dt[Nt+32*q-1]=129;for(0<we?Ae[Te-1-32]=Ie[Ve-1-32]=dt[Nt-1-32]=129:(i(Ae,Te-32-1,127,21),i(Ie,Ve-32-1,127,9),i(dt,Nt-32-1,127,9)),oe=0;oe<b.za;++oe){var Dt=P.ya[P.aa+oe];if(0<oe){for(q=-1;16>q;++q)r(Ae,Te+32*q-4,Ae,Te+32*q+12,4);for(q=-1;8>q;++q)r(Ie,Ve+32*q-4,Ie,Ve+32*q+4,4),r(dt,Nt+32*q-4,dt,Nt+32*q+4,4)}var wt=b.Gd,Yt=b.Hd+oe,Vt=Dt.ad,pt=Dt.Hc;if(0<we&&(r(Ae,Te-32,wt[Yt].y,0,16),r(Ie,Ve-32,wt[Yt].f,0,8),r(dt,Nt-32,wt[Yt].ea,0,8)),Dt.Za){var yt=Ae,en=Te-32+16;for(0<we&&(oe>=b.za-1?i(yt,en,wt[Yt].y[15],4):r(yt,en,wt[Yt+1].y,0,4)),q=0;4>q;q++)yt[en+128+q]=yt[en+256+q]=yt[en+384+q]=yt[en+0+q];for(q=0;16>q;++q,pt<<=2)yt=Ae,en=Te+fh[q],Ys[Dt.Ob[q]](yt,en),es(pt,Vt,16*+q,yt,en)}else if(yt=fl(oe,we,Dt.Ob[0]),ca[yt](Ae,Te),pt!=0)for(q=0;16>q;++q,pt<<=2)es(pt,Vt,16*+q,Ae,Te+fh[q]);for(q=Dt.Gc,yt=fl(oe,we,Dt.Dd),Rs[yt](Ie,Ve),Rs[yt](dt,Nt),pt=Vt,yt=Ie,en=Ve,255&(Dt=q>>0)&&(170&Dt?An(pt,256,yt,en):wr(pt,256,yt,en)),Dt=dt,pt=Nt,255&(q>>=8)&&(170&q?An(Vt,320,Dt,pt):wr(Vt,320,Dt,pt)),we<b.Ub-1&&(r(wt[Yt].y,0,Ae,Te+480,16),r(wt[Yt].f,0,Ie,Ve+224,8),r(wt[Yt].ea,0,dt,Nt+224,8)),q=8*Ee*b.B,wt=b.sa,Yt=b.ta+16*oe+16*Ee*b.R,Vt=b.qa,Dt=b.ra+8*oe+q,pt=b.Ha,yt=b.Ia+8*oe+q,q=0;16>q;++q)r(wt,Yt+q*b.R,Ae,Te+32*q,16);for(q=0;8>q;++q)r(Vt,Dt+q*b.B,Ie,Ve+32*q,8),r(pt,yt+q*b.B,dt,Nt+32*q,8)}}function na(b,P,q,oe,we,Ee,Ae,Te,Ie){var Ve=[0],dt=[0],Nt=0,Dt=Ie!=null?Ie.kd:0,wt=Ie??new Hs;if(b==null||12>q)return 7;wt.data=b,wt.w=P,wt.ha=q,P=[P],q=[q],wt.gb=[wt.gb];e:{var Yt=P,Vt=q,pt=wt.gb;if(t(b!=null),t(Vt!=null),t(pt!=null),pt[0]=0,12<=Vt[0]&&!n(b,Yt[0],"RIFF")){if(n(b,Yt[0]+8,"WEBP")){pt=3;break e}var yt=K(b,Yt[0]+4);if(12>yt||4294967286<yt){pt=3;break e}if(Dt&&yt>Vt[0]-8){pt=7;break e}pt[0]=yt,Yt[0]+=12,Vt[0]-=12}pt=0}if(pt!=0)return pt;for(yt=0<wt.gb[0],q=q[0];;){e:{var en=b;Vt=P,pt=q;var fn=Ve,nn=dt,kn=Yt=[0];if((l=Nt=[Nt])[0]=0,8>pt[0])pt=7;else{if(!n(en,Vt[0],"VP8X")){if(K(en,Vt[0]+4)!=10){pt=3;break e}if(18>pt[0]){pt=7;break e}var Sn=K(en,Vt[0]+8),Qn=1+Ge(en,Vt[0]+12);if(2147483648<=Qn*(en=1+Ge(en,Vt[0]+15))){pt=3;break e}kn!=null&&(kn[0]=Sn),fn!=null&&(fn[0]=Qn),nn!=null&&(nn[0]=en),Vt[0]+=18,pt[0]-=18,l[0]=1}pt=0}}if(Nt=Nt[0],Yt=Yt[0],pt!=0)return pt;if(Vt=!!(2&Yt),!yt&&Nt)return 3;if(Ee!=null&&(Ee[0]=!!(16&Yt)),Ae!=null&&(Ae[0]=Vt),Te!=null&&(Te[0]=0),Ae=Ve[0],Yt=dt[0],Nt&&Vt&&Ie==null){pt=0;break}if(4>q){pt=7;break}if(yt&&Nt||!yt&&!Nt&&!n(b,P[0],"ALPH")){q=[q],wt.na=[wt.na],wt.P=[wt.P],wt.Sa=[wt.Sa];e:{Sn=b,pt=P,yt=q;var l=wt.gb;fn=wt.na,nn=wt.P,kn=wt.Sa,Qn=22,t(Sn!=null),t(yt!=null),en=pt[0];var h=yt[0];for(t(fn!=null),t(kn!=null),fn[0]=null,nn[0]=null,kn[0]=0;;){if(pt[0]=en,yt[0]=h,8>h){pt=7;break e}var v=K(Sn,en+4);if(4294967286<v){pt=3;break e}var w=8+v+1&-2;if(Qn+=w,0<l&&Qn>l){pt=3;break e}if(!n(Sn,en,"VP8 ")||!n(Sn,en,"VP8L")){pt=0;break e}if(h[0]<w){pt=7;break e}n(Sn,en,"ALPH")||(fn[0]=Sn,nn[0]=en+8,kn[0]=v),en+=w,h-=w}}if(q=q[0],wt.na=wt.na[0],wt.P=wt.P[0],wt.Sa=wt.Sa[0],pt!=0)break}q=[q],wt.Ja=[wt.Ja],wt.xa=[wt.xa];e:if(l=b,pt=P,yt=q,fn=wt.gb[0],nn=wt.Ja,kn=wt.xa,Sn=pt[0],en=!n(l,Sn,"VP8 "),Qn=!n(l,Sn,"VP8L"),t(l!=null),t(yt!=null),t(nn!=null),t(kn!=null),8>yt[0])pt=7;else{if(en||Qn){if(l=K(l,Sn+4),12<=fn&&l>fn-12){pt=3;break e}if(Dt&&l>yt[0]-8){pt=7;break e}nn[0]=l,pt[0]+=8,yt[0]-=8,kn[0]=Qn}else kn[0]=5<=yt[0]&&l[Sn+0]==47&&!(l[Sn+4]>>5),nn[0]=yt[0];pt=0}if(q=q[0],wt.Ja=wt.Ja[0],wt.xa=wt.xa[0],P=P[0],pt!=0)break;if(4294967286<wt.Ja)return 3;if(Te==null||Vt||(Te[0]=wt.xa?2:1),Ae=[Ae],Yt=[Yt],wt.xa){if(5>q){pt=7;break}Te=Ae,Dt=Yt,Vt=Ee,b==null||5>q?b=0:5<=q&&b[P+0]==47&&!(b[P+4]>>5)?(yt=[0],l=[0],fn=[0],Y(nn=new N,b,P,q),mn(nn,yt,l,fn)?(Te!=null&&(Te[0]=yt[0]),Dt!=null&&(Dt[0]=l[0]),Vt!=null&&(Vt[0]=fn[0]),b=1):b=0):b=0}else{if(10>q){pt=7;break}Te=Yt,b==null||10>q||!bo(b,P+3,q-3)?b=0:(Dt=b[P+0]|b[P+1]<<8|b[P+2]<<16,Vt=16383&(b[P+7]<<8|b[P+6]),b=16383&(b[P+9]<<8|b[P+8]),1&Dt||3<(Dt>>1&7)||!(Dt>>4&1)||Dt>>5>=wt.Ja||!Vt||!b?b=0:(Ae&&(Ae[0]=Vt),Te&&(Te[0]=b),b=1))}if(!b||(Ae=Ae[0],Yt=Yt[0],Nt&&(Ve[0]!=Ae||dt[0]!=Yt)))return 3;Ie!=null&&(Ie[0]=wt,Ie.offset=P-Ie.w,t(4294967286>P-Ie.w),t(Ie.offset==Ie.ha-q));break}return pt==0||pt==7&&Nt&&Ie==null?(Ee!=null&&(Ee[0]|=wt.na!=null&&0<wt.na.length),oe!=null&&(oe[0]=Ae),we!=null&&(we[0]=Yt),0):pt}function wu(b,P,q){var oe=P.width,we=P.height,Ee=0,Ae=0,Te=oe,Ie=we;if(P.Da=b!=null&&0<b.Da,P.Da&&(Te=b.cd,Ie=b.bd,Ee=b.v,Ae=b.j,11>q||(Ee&=-2,Ae&=-2),0>Ee||0>Ae||0>=Te||0>=Ie||Ee+Te>oe||Ae+Ie>we))return 0;if(P.v=Ee,P.j=Ae,P.va=Ee+Te,P.o=Ae+Ie,P.U=Te,P.T=Ie,P.da=b!=null&&0<b.da,P.da){if(!Ue(Te,Ie,q=[b.ib],Ee=[b.hb]))return 0;P.ib=q[0],P.hb=Ee[0]}return P.ob=b!=null&&b.ob,P.Kb=b==null||!b.Sd,P.da&&(P.ob=P.ib<3*oe/4&&P.hb<3*we/4,P.Kb=0),1}function Ga(b){if(b==null)return 2;if(11>b.S){var P=b.f.RGBA;P.fb+=(b.height-1)*P.A,P.A=-P.A}else P=b.f.kb,b=b.height,P.O+=(b-1)*P.fa,P.fa=-P.fa,P.N+=(b-1>>1)*P.Ab,P.Ab=-P.Ab,P.W+=(b-1>>1)*P.Db,P.Db=-P.Db,P.F!=null&&(P.J+=(b-1)*P.lb,P.lb=-P.lb);return 0}function Ha(b,P,q,oe){if(oe==null||0>=b||0>=P)return 2;if(q!=null){if(q.Da){var we=q.cd,Ee=q.bd,Ae=-2&q.v,Te=-2&q.j;if(0>Ae||0>Te||0>=we||0>=Ee||Ae+we>b||Te+Ee>P)return 2;b=we,P=Ee}if(q.da){if(!Ue(b,P,we=[q.ib],Ee=[q.hb]))return 2;b=we[0],P=Ee[0]}}oe.width=b,oe.height=P;e:{var Ie=oe.width,Ve=oe.height;if(b=oe.S,0>=Ie||0>=Ve||!(b>=ps&&13>b))b=2;else{if(0>=oe.Rd&&oe.sd==null){Ae=Ee=we=P=0;var dt=(Te=Ie*ph[b])*Ve;if(11>b||(Ee=(Ve+1)/2*(P=(Ie+1)/2),b==12&&(Ae=(we=Ie)*Ve)),(Ve=s(dt+2*Ee+Ae))==null){b=1;break e}oe.sd=Ve,11>b?((Ie=oe.f.RGBA).eb=Ve,Ie.fb=0,Ie.A=Te,Ie.size=dt):((Ie=oe.f.kb).y=Ve,Ie.O=0,Ie.fa=Te,Ie.Fd=dt,Ie.f=Ve,Ie.N=0+dt,Ie.Ab=P,Ie.Cd=Ee,Ie.ea=Ve,Ie.W=0+dt+Ee,Ie.Db=P,Ie.Ed=Ee,b==12&&(Ie.F=Ve,Ie.J=0+dt+2*Ee),Ie.Tc=Ae,Ie.lb=we)}if(P=1,we=oe.S,Ee=oe.width,Ae=oe.height,we>=ps&&13>we)if(11>we)b=oe.f.RGBA,P&=(Te=Math.abs(b.A))*(Ae-1)+Ee<=b.size,P&=Te>=Ee*ph[we],P&=b.eb!=null;else{b=oe.f.kb,Te=(Ee+1)/2,dt=(Ae+1)/2,Ie=Math.abs(b.fa),Ve=Math.abs(b.Ab);var Nt=Math.abs(b.Db),Dt=Math.abs(b.lb),wt=Dt*(Ae-1)+Ee;P&=Ie*(Ae-1)+Ee<=b.Fd,P&=Ve*(dt-1)+Te<=b.Cd,P=(P&=Nt*(dt-1)+Te<=b.Ed)&Ie>=Ee&Ve>=Te&Nt>=Te,P&=b.y!=null,P&=b.f!=null,P&=b.ea!=null,we==12&&(P&=Dt>=Ee,P&=wt<=b.Tc,P&=b.F!=null)}else P=0;b=P?0:2}}return b!=0||q!=null&&q.fd&&(b=Ga(oe)),b}var po=64,ra=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ms=24,hs=32,hl=8,$o=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];He("Predictor0","PredictorAdd0"),H.Predictor0=function(){return 4278190080},H.Predictor1=function(b){return b},H.Predictor2=function(b,P,q){return P[q+0]},H.Predictor3=function(b,P,q){return P[q+1]},H.Predictor4=function(b,P,q){return P[q-1]},H.Predictor5=function(b,P,q){return tt(tt(b,P[q+1]),P[q+0])},H.Predictor6=function(b,P,q){return tt(b,P[q-1])},H.Predictor7=function(b,P,q){return tt(b,P[q+0])},H.Predictor8=function(b,P,q){return tt(P[q-1],P[q+0])},H.Predictor9=function(b,P,q){return tt(P[q+0],P[q+1])},H.Predictor10=function(b,P,q){return tt(tt(b,P[q-1]),tt(P[q+0],P[q+1]))},H.Predictor11=function(b,P,q){var oe=P[q+0];return 0>=jt(oe>>24&255,b>>24&255,(P=P[q-1])>>24&255)+jt(oe>>16&255,b>>16&255,P>>16&255)+jt(oe>>8&255,b>>8&255,P>>8&255)+jt(255&oe,255&b,255&P)?oe:b},H.Predictor12=function(b,P,q){var oe=P[q+0];return(Mt((b>>24&255)+(oe>>24&255)-((P=P[q-1])>>24&255))<<24|Mt((b>>16&255)+(oe>>16&255)-(P>>16&255))<<16|Mt((b>>8&255)+(oe>>8&255)-(P>>8&255))<<8|Mt((255&b)+(255&oe)-(255&P)))>>>0},H.Predictor13=function(b,P,q){var oe=P[q-1];return(Lt((b=tt(b,P[q+0]))>>24&255,oe>>24&255)<<24|Lt(b>>16&255,oe>>16&255)<<16|Lt(b>>8&255,oe>>8&255)<<8|Lt(b>>0&255,oe>>0&255))>>>0};var ts=H.PredictorAdd0;H.PredictorAdd1=zt,He("Predictor2","PredictorAdd2"),He("Predictor3","PredictorAdd3"),He("Predictor4","PredictorAdd4"),He("Predictor5","PredictorAdd5"),He("Predictor6","PredictorAdd6"),He("Predictor7","PredictorAdd7"),He("Predictor8","PredictorAdd8"),He("Predictor9","PredictorAdd9"),He("Predictor10","PredictorAdd10"),He("Predictor11","PredictorAdd11"),He("Predictor12","PredictorAdd12"),He("Predictor13","PredictorAdd13");var ns=H.PredictorAdd2;ot("ColorIndexInverseTransform","MapARGB","32b",function(b){return b>>8&255},function(b){return b}),ot("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(b){return b},function(b){return b>>8&255});var Ju,So=H.ColorIndexInverseTransform,wa=H.MapARGB,Uo=H.VP8LColorIndexInverseTransformAlpha,Vo=H.MapAlpha,xa=H.VP8LPredictorsAdd=[];xa.length=16,(H.VP8LPredictors=[]).length=16,(H.VP8LPredictorsAdd_C=[]).length=16,(H.VP8LPredictors_C=[]).length=16;var La,Go,Ao,ia,As,Ho,_t,Zt,At,An,Kn,wr,Vi,Li,Ol,rs,Gi,oa,Sa,sa,aa,la,Qr,Ws,ko,Si,Ai,so,Ri=s(511),ks=s(2041),ds=s(225),Bs=s(767),xu=0,ua=ks,go=ds,Oi=Bs,qo=Ri,ps=0,pr=1,Ca=2,Ea=3,Zs=4,is=5,bc=6,To=7,No=8,Ks=9,a=10,p=[2,3,7],S=[3,3,11],V=[280,256,256,256,40],ie=[0,1,1,1,0],Ce=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],st=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Pt=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Ut=8,an=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Dn=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Xn=null,zr=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],mo=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Ji=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Do=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Hi=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],gs=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],wc=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ca=[],Ys=[],Rs=[],kf=1,tu=2,mi=[],Wo=[];$t("UpsampleRgbLinePair",Ur,3),$t("UpsampleBgrLinePair",$i,3),$t("UpsampleRgbaLinePair",Ps,4),$t("UpsampleBgraLinePair",ho,4),$t("UpsampleArgbLinePair",oo,4),$t("UpsampleRgba4444LinePair",xi,2),$t("UpsampleRgb565LinePair",pi,2);var Ne=H.UpsampleRgbLinePair,ms=H.UpsampleBgrLinePair,Lu=H.UpsampleRgbaLinePair,Io=H.UpsampleBgraLinePair,Gr=H.UpsampleArgbLinePair,Wc=H.UpsampleRgba4444LinePair,uh=H.UpsampleRgb565LinePair,Zc=16,qa=1<<Zc-1,xc=-227,Tf=482,gd=6,Xu=0,Kc=s(256),Bl=s(256),md=s(256),Yc=s(256),Jc=s(Tf-xc),ch=s(Tf-xc);zo("YuvToRgbRow",Ur,3),zo("YuvToBgrRow",$i,3),zo("YuvToRgbaRow",Ps,4),zo("YuvToBgraRow",ho,4),zo("YuvToArgbRow",oo,4),zo("YuvToRgba4444Row",xi,2),zo("YuvToRgb565Row",pi,2);var fh=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Pa=[0,2,8],hh=[8,7,6,4,4,2,2,2,1,1,1,1],dh=1;this.WebPDecodeRGBA=function(b,P,q,oe,we){var Ee=pr,Ae=new Mo,Te=new fr;Ae.ba=Te,Te.S=Ee,Te.width=[Te.width],Te.height=[Te.height];var Ie=Te.width,Ve=Te.height,dt=new yr;if(dt==null||b==null)var Nt=2;else t(dt!=null),Nt=na(b,P,q,dt.width,dt.height,dt.Pd,dt.Qd,dt.format,null);if(Nt!=0?Ie=0:(Ie!=null&&(Ie[0]=dt.width[0]),Ve!=null&&(Ve[0]=dt.height[0]),Ie=1),Ie){Te.width=Te.width[0],Te.height=Te.height[0],oe!=null&&(oe[0]=Te.width),we!=null&&(we[0]=Te.height);e:{if(oe=new ci,(we=new Hs).data=b,we.w=P,we.ha=q,we.kd=1,P=[0],t(we!=null),((b=na(we.data,we.w,we.ha,null,null,null,P,null,we))==0||b==7)&&P[0]&&(b=4),(P=b)==0){if(t(Ae!=null),oe.data=we.data,oe.w=we.w+we.offset,oe.ha=we.ha-we.offset,oe.put=Zn,oe.ac=Jn,oe.bc=qt,oe.ma=Ae,we.xa){if((b=ir())==null){Ae=1;break e}if(function(Dt,wt){var Yt=[0],Vt=[0],pt=[0];t:for(;;){if(Dt==null)return 0;if(wt==null)return Dt.a=2,0;if(Dt.l=wt,Dt.a=0,Y(Dt.m,wt.data,wt.w,wt.ha),!mn(Dt.m,Yt,Vt,pt)){Dt.a=3;break t}if(Dt.xb=tu,wt.width=Yt[0],wt.height=Vt[0],!Or(Yt[0],Vt[0],1,Dt,null))break t;return 1}return t(Dt.a!=0),0}(b,oe)){if(oe=(P=Ha(oe.width,oe.height,Ae.Oa,Ae.ba))==0){t:{oe=b;n:for(;;){if(oe==null){oe=0;break t}if(t(oe.s.yc!=null),t(oe.s.Ya!=null),t(0<oe.s.Wb),t((q=oe.l)!=null),t((we=q.ma)!=null),oe.xb!=0){if(oe.ca=we.ba,oe.tb=we.tb,t(oe.ca!=null),!wu(we.Oa,q,Ea)){oe.a=2;break n}if(!jr(oe,q.width)||q.da)break n;if((q.da||xn(oe.ca.S))&&xt(),11>oe.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),oe.ca.f.kb.F!=null&&xt()),oe.Pb&&0<oe.s.ua&&oe.s.vb.X==null&&!de(oe.s.vb,oe.s.Wa.Xa)){oe.a=1;break n}oe.xb=0}if(!lr(oe,oe.V,oe.Ba,oe.c,oe.i,q.o,xr))break n;we.Dc=oe.Ma,oe=1;break t}t(oe.a!=0),oe=0}oe=!oe}oe&&(P=b.a)}else P=b.a}else{if((b=new hr)==null){Ae=1;break e}if(b.Fa=we.na,b.P=we.P,b.qc=we.Sa,wo(b,oe)){if((P=Ha(oe.width,oe.height,Ae.Oa,Ae.ba))==0){if(b.Aa=0,q=Ae.Oa,t((we=b)!=null),q!=null){if(0<(Ie=0>(Ie=q.Md)?0:100<Ie?255:255*Ie/100)){for(Ve=dt=0;4>Ve;++Ve)12>(Nt=we.pb[Ve]).lc&&(Nt.ia=Ie*hh[0>Nt.lc?0:Nt.lc]>>3),dt|=Nt.ia;dt&&(alert("todo:VP8InitRandom"),we.ia=1)}we.Ga=q.Id,100<we.Ga?we.Ga=100:0>we.Ga&&(we.Ga=0)}Gn(b,oe)||(P=b.a)}}else P=b.a}P==0&&Ae.Oa!=null&&Ae.Oa.fd&&(P=Ga(Ae.ba))}Ae=P}Ee=Ae!=0?null:11>Ee?Te.f.RGBA.eb:Te.f.kb.y}else Ee=null;return Ee};var ph=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(H,U){for(var Q="",F=0;F<4;F++)Q+=String.fromCharCode(H[U++]);return Q}function g(H,U){return(H[U+0]<<0|H[U+1]<<8|H[U+2]<<16)>>>0}function y(H,U){return(H[U+0]<<0|H[U+1]<<8|H[U+2]<<16|H[U+3]<<24)>>>0}new f;var x=[0],_=[0],M=[],T=new f,D=e,I=function(H,U){var Q={},F=0,B=!1,R=0,$=0;if(Q.frames=[],!function(ee,fe,ce,_e){for(var se=0;se<_e;se++)if(ee[fe+se]!=ce.charCodeAt(se))return!0;return!1}(H,U,"RIFF",4)){var W,G;for(y(H,U+=4),U+=8;U<H.length;){var J=d(H,U),Y=y(H,U+=4);U+=4;var pe=Y+(1&Y);switch(J){case"VP8 ":case"VP8L":Q.frames[F]===void 0&&(Q.frames[F]={}),(N=Q.frames[F]).src_off=B?$:U-8,N.src_size=R+Y+8,F++,B&&(B=!1,R=0,$=0);break;case"VP8X":(N=Q.header={}).feature_flags=H[U];var Le=U+4;N.canvas_width=1+g(H,Le),Le+=3,N.canvas_height=1+g(H,Le),Le+=3;break;case"ALPH":B=!0,R=pe+8,$=U-8;break;case"ANIM":(N=Q.header).bgcolor=y(H,U),Le=U+4,N.loop_count=(W=H)[(G=Le)+0]<<0|W[G+1]<<8,Le+=2;break;case"ANMF":var De,N;(N=Q.frames[F]={}).offset_x=2*g(H,U),U+=3,N.offset_y=2*g(H,U),U+=3,N.width=1+g(H,U),U+=3,N.height=1+g(H,U),U+=3,N.duration=g(H,U),U+=3,De=H[U++],N.dispose=1&De,N.blend=De>>1&1}J!="ANMF"&&(U+=pe)}return Q}}(D,0);I.response=D,I.rgbaoutput=!0,I.dataurl=!1;var j=I.header?I.header:null,Z=I.frames?I.frames:null;if(j){j.loop_counter=j.loop_count,x=[j.canvas_height],_=[j.canvas_width];for(var te=0;te<Z.length&&Z[te].blend!=0;te++);}var ue=Z[0],le=T.WebPDecodeRGBA(D,ue.src_off,ue.src_size,_,x);ue.rgba=le,ue.imgwidth=_[0],ue.imgheight=x[0];for(var ge=0;ge<_[0]*x[0]*4;ge++)M[ge]=le[ge];return this.width=_,this.height=x,this.data=M,this}(function(e){var t=function(){return typeof b1=="function"},n=function(x,_,M,T){var D=4,I=o;switch(T){case e.image_compression.FAST:D=1,I=s;break;case e.image_compression.MEDIUM:D=6,I=u;break;case e.image_compression.SLOW:D=9,I=f}x=r(x,_,M,I);var j=b1(x,{level:D});return e.__addimage__.arrayBufferToBinaryString(j)},r=function(x,_,M,T){for(var D,I,j,Z=x.length/_,te=new Uint8Array(x.length+Z),ue=g(),le=0;le<Z;le+=1){if(j=le*_,D=x.subarray(j,j+_),T)te.set(T(D,M,I),j+le);else{for(var ge,H=ue.length,U=[];ge<H;ge+=1)U[ge]=ue[ge](D,M,I);var Q=y(U.concat());te.set(U[Q],j+le)}I=D}return te},i=function(x){var _=Array.apply([],x);return _.unshift(0),_},s=function(x,_){var M,T=[],D=x.length;T[0]=1;for(var I=0;I<D;I+=1)M=x[I-_]||0,T[I+1]=x[I]-M+256&255;return T},o=function(x,_,M){var T,D=[],I=x.length;D[0]=2;for(var j=0;j<I;j+=1)T=M&&M[j]||0,D[j+1]=x[j]-T+256&255;return D},u=function(x,_,M){var T,D,I=[],j=x.length;I[0]=3;for(var Z=0;Z<j;Z+=1)T=x[Z-_]||0,D=M&&M[Z]||0,I[Z+1]=x[Z]+256-(T+D>>>1)&255;return I},f=function(x,_,M){var T,D,I,j,Z=[],te=x.length;Z[0]=4;for(var ue=0;ue<te;ue+=1)T=x[ue-_]||0,D=M&&M[ue]||0,I=M&&M[ue-_]||0,j=d(T,D,I),Z[ue+1]=x[ue]-j+256&255;return Z},d=function(x,_,M){if(x===_&&_===M)return x;var T=Math.abs(_-M),D=Math.abs(x-M),I=Math.abs(x+_-M-M);return T<=D&&T<=I?x:D<=I?_:M},g=function(){return[i,s,o,u,f]},y=function(x){var _=x.map(function(M){return M.reduce(function(T,D){return T+Math.abs(D)},0)});return _.indexOf(Math.min.apply(null,_))};e.processPNG=function(x,_,M,T){var D,I,j,Z,te,ue,le,ge,H,U,Q,F,B,R,$,W=this.decode.FLATE_DECODE,G="";if(this.__addimage__.isArrayBuffer(x)&&(x=new Uint8Array(x)),this.__addimage__.isArrayBufferView(x)){if(x=(j=new GF(x)).imgData,I=j.bits,D=j.colorSpace,te=j.colors,[4,6].indexOf(j.colorType)!==-1){if(j.bits===8){H=(ge=j.pixelBitlength==32?new Uint32Array(j.decodePixels().buffer):j.pixelBitlength==16?new Uint16Array(j.decodePixels().buffer):new Uint8Array(j.decodePixels().buffer)).length,Q=new Uint8Array(H*j.colors),U=new Uint8Array(H);var J,Y=j.pixelBitlength-j.bits;for(R=0,$=0;R<H;R++){for(B=ge[R],J=0;J<Y;)Q[$++]=B>>>J&255,J+=j.bits;U[R]=B>>>J&255}}if(j.bits===16){H=(ge=new Uint32Array(j.decodePixels().buffer)).length,Q=new Uint8Array(H*(32/j.pixelBitlength)*j.colors),U=new Uint8Array(H*(32/j.pixelBitlength)),F=j.colors>1,R=0,$=0;for(var pe=0;R<H;)B=ge[R++],Q[$++]=B>>>0&255,F&&(Q[$++]=B>>>16&255,B=ge[R++],Q[$++]=B>>>0&255),U[pe++]=B>>>16&255;I=8}T!==e.image_compression.NONE&&t()?(x=n(Q,j.width*j.colors,j.colors,T),le=n(U,j.width,1,T)):(x=Q,le=U,W=void 0)}if(j.colorType===3&&(D=this.color_spaces.INDEXED,ue=j.palette,j.transparency.indexed)){var Le=j.transparency.indexed,De=0;for(R=0,H=Le.length;R<H;++R)De+=Le[R];if((De/=255)===H-1&&Le.indexOf(0)!==-1)Z=[Le.indexOf(0)];else if(De!==H){for(ge=j.decodePixels(),U=new Uint8Array(ge.length),R=0,H=ge.length;R<H;R++)U[R]=Le[ge[R]];le=n(U,j.width,1)}}var N=function(ee){var fe;switch(ee){case e.image_compression.FAST:fe=11;break;case e.image_compression.MEDIUM:fe=13;break;case e.image_compression.SLOW:fe=14;break;default:fe=12}return fe}(T);return W===this.decode.FLATE_DECODE&&(G="/Predictor "+N+" "),G+="/Colors "+te+" /BitsPerComponent "+I+" /Columns "+j.width,(this.__addimage__.isArrayBuffer(x)||this.__addimage__.isArrayBufferView(x))&&(x=this.__addimage__.arrayBufferToBinaryString(x)),(le&&this.__addimage__.isArrayBuffer(le)||this.__addimage__.isArrayBufferView(le))&&(le=this.__addimage__.arrayBufferToBinaryString(le)),{alias:M,data:x,index:_,filter:W,decodeParameters:G,transparency:Z,palette:ue,sMask:le,predictor:N,width:j.width,height:j.height,bitsPerComponent:I,colorSpace:D}}}})(kr.API),function(e){e.processGIF89A=function(t,n,r,i){var s=new HF(t),o=s.width,u=s.height,f=[];s.decodeAndBlitFrameRGBA(0,f);var d={data:f,width:o,height:u},g=new gv(100).encode(d,100);return e.processJPEG.call(this,g,n,r,i)},e.processGIF87A=e.processGIF89A}(kr.API),Du.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:i,green:r,blue:n,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Du.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(n){lo.log("bit decode error:"+n)}},Du.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),n=t%4;for(e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,i=0;i<t;i++)for(var s=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+8*i*4,u=0;u<8&&8*i+u<this.width;u++){var f=this.palette[s>>7-u&1];this.data[o+4*u]=f.blue,this.data[o+4*u+1]=f.green,this.data[o+4*u+2]=f.red,this.data[o+4*u+3]=255}n!==0&&(this.pos+=4-n)}},Du.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<e;i++){var s=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+2*i*4,u=s>>4,f=15&s,d=this.palette[u];if(this.data[o]=d.blue,this.data[o+1]=d.green,this.data[o+2]=d.red,this.data[o+3]=255,2*i+1>=this.width)break;d=this.palette[f],this.data[o+4]=d.blue,this.data[o+4+1]=d.green,this.data[o+4+2]=d.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},Du.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+4*r;if(i<this.palette.length){var o=this.palette[i];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}e!==0&&(this.pos+=4-e)}},Du.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,u=(s>>5&t)/t*255|0,f=(s>>10&t)/t*255|0,d=s>>15?255:0,g=r*this.width*4+4*i;this.data[g]=f,this.data[g+1]=u,this.data[g+2]=o,this.data[g+3]=d}this.pos+=e}},Du.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),n=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var u=(o&t)/t*255|0,f=(o>>5&n)/n*255|0,d=(o>>11)/t*255|0,g=i*this.width*4+4*s;this.data[g]=d,this.data[g+1]=f,this.data[g+2]=u,this.data[g+3]=255}this.pos+=e}},Du.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*n;this.data[o]=s,this.data[o+1]=i,this.data[o+2]=r,this.data[o+3]=255}this.pos+=this.width%4}},Du.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),u=t*this.width*4+4*n;this.data[u]=s,this.data[u+1]=i,this.data[u+2]=r,this.data[u+3]=o}},Du.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,n,r,i){var s=new Du(t,!1),o=s.width,u=s.height,f={data:s.getData(),width:o,height:u},d=new gv(100).encode(f,100);return e.processJPEG.call(this,d,n,r,i)}}(kr.API),zb.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,n,r,i){var s=new zb(t),o=s.width,u=s.height,f={data:s.getData(),width:o,height:u},d=new gv(100).encode(f,100);return e.processJPEG.call(this,d,n,r,i)}}(kr.API),kr.API.processRGBA=function(e,t,n){for(var r=e.data,i=r.length,s=new Uint8Array(i/4*3),o=new Uint8Array(i/4),u=0,f=0,d=0;d<i;d+=4){var g=r[d],y=r[d+1],x=r[d+2],_=r[d+3];s[u++]=g,s[u++]=y,s[u++]=x,o[f++]=_}var M=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:M,index:t,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},kr.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},kh=kr.API,Lg=kh.getCharWidthsArray=function(e,t){var n,r,i=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),u=t.widths?t.widths:i.metadata.Unicode.widths,f=u.fof?u.fof:1,d=t.kerning?t.kerning:i.metadata.Unicode.kerning,g=d.fof?d.fof:1,y=t.doKerning!==!1,x=0,_=e.length,M=0,T=u[0]||f,D=[];for(n=0;n<_;n++)r=e.charCodeAt(n),typeof i.metadata.widthOfString=="function"?D.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(r))+o*(1e3/s)||0)/1e3):(x=y&&Xi(d[r])==="object"&&!isNaN(parseInt(d[r][M],10))?d[r][M]/g:0,D.push((u[r]||T)/f+x)),M=r;return D},Bb=kh.getStringUnitWidth=function(e,t){var n=(t=t||{}).fontSize||this.internal.getFontSize(),r=t.font||this.internal.getFont(),i=t.charSpace||this.internal.getCharSpace();return kh.processArabic&&(e=kh.processArabic(e)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(e,n,i)/n:Lg.apply(this,arguments).reduce(function(s,o){return s+o},0)},Rb=function(e,t,n,r){for(var i=[],s=0,o=e.length,u=0;s!==o&&u+t[s]<n;)u+=t[s],s++;i.push(e.slice(0,s));var f=s;for(u=0;s!==o;)u+t[s]>r&&(i.push(e.slice(f,s)),u=0,f=s),u+=t[s],s++;return f!==s&&i.push(e.slice(f,s)),i},Fb=function(e,t,n){n||(n={});var r,i,s,o,u,f,d,g=[],y=[g],x=n.textIndent||0,_=0,M=0,T=e.split(" "),D=Lg.apply(this,[" ",n])[0];if(f=n.lineIndent===-1?T[0].length+2:n.lineIndent||0){var I=Array(f).join(" "),j=[];T.map(function(te){(te=te.split(/\s*\n/)).length>1?j=j.concat(te.map(function(ue,le){return(le&&ue.length?`
`:"")+ue})):j.push(te[0])}),T=j,f=Bb.apply(this,[I,n])}for(s=0,o=T.length;s<o;s++){var Z=0;if(r=T[s],f&&r[0]==`
`&&(r=r.substr(1),Z=1),x+_+(M=(i=Lg.apply(this,[r,n])).reduce(function(te,ue){return te+ue},0))>t||Z){if(M>t){for(u=Rb.apply(this,[r,i,t-(x+_),t]),g.push(u.shift()),g=[u.pop()];u.length;)y.push([u.shift()]);M=i.slice(r.length-(g[0]?g[0].length:0)).reduce(function(te,ue){return te+ue},0)}else g=[r];y.push(g),x=M+f,_=D}else g.push(r),x+=_+M,_=D}return d=f?function(te,ue){return(ue?I:"")+te.join(" ")}:function(te){return te.join(" ")},y.map(d)},kh.splitTextToSize=function(e,t,n){var r,i=(n=n||{}).fontSize||this.internal.getFontSize(),s=(function(g){if(g.widths&&g.kerning)return{widths:g.widths,kerning:g.kerning};var y=this.internal.getFont(g.fontName,g.fontStyle);return y.metadata.Unicode?{widths:y.metadata.Unicode.widths||{0:1},kerning:y.metadata.Unicode.kerning||{}}:{font:y.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);r=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/i;s.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/i:0,s.lineIndent=n.lineIndent;var u,f,d=[];for(u=0,f=r.length;u<f;u++)d=d.concat(Fb.apply(this,[r[u],o,s]));return d},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",n={},r={},i=0;i<t.length;i++)n[t[i]]="0123456789abcdef"[i],r["0123456789abcdef"[i]]=t[i];var s=function(y){return"0x"+parseInt(y,10).toString(16)},o=e.__fontmetrics__.compress=function(y){var x,_,M,T,D=["{"];for(var I in y){if(x=y[I],isNaN(parseInt(I,10))?_="'"+I+"'":(I=parseInt(I,10),_=(_=s(I).slice(2)).slice(0,-1)+r[_.slice(-1)]),typeof x=="number")x<0?(M=s(x).slice(3),T="-"):(M=s(x).slice(2),T=""),M=T+M.slice(0,-1)+r[M.slice(-1)];else{if(Xi(x)!=="object")throw new Error("Don't know what to do with value type "+Xi(x)+".");M=o(x)}D.push(_+M)}return D.push("}"),D.join("")},u=e.__fontmetrics__.uncompress=function(y){if(typeof y!="string")throw new Error("Invalid argument passed to uncompress.");for(var x,_,M,T,D={},I=1,j=D,Z=[],te="",ue="",le=y.length-1,ge=1;ge<le;ge+=1)(T=y[ge])=="'"?x?(M=x.join(""),x=void 0):x=[]:x?x.push(T):T=="{"?(Z.push([j,M]),j={},M=void 0):T=="}"?((_=Z.pop())[0][_[1]]=j,M=void 0,j=_[0]):T=="-"?I=-1:M===void 0?n.hasOwnProperty(T)?(te+=n[T],M=parseInt(te,16)*I,I=1,te=""):te+=T:n.hasOwnProperty(T)?(ue+=n[T],j[M]=parseInt(ue,16)*I,I=1,M=void 0,ue=""):ue+=T;return D},f={codePages:["WinAnsiEncoding"],WinAnsiEncoding:u("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:f,"Courier-Bold":f,"Courier-BoldOblique":f,"Courier-Oblique":f,Helvetica:f,"Helvetica-Bold":f,"Helvetica-BoldOblique":f,"Helvetica-Oblique":f,"Times-Roman":f,"Times-Bold":f,"Times-BoldItalic":f,"Times-Italic":f}},g={Unicode:{"Courier-Oblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":u("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":u("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:u("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:u("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":u("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":u("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(y){var x=y.font,_=g.Unicode[x.postScriptName];_&&(x.metadata.Unicode={},x.metadata.Unicode.widths=_.widths,x.metadata.Unicode.kerning=_.kerning);var M=d.Unicode[x.postScriptName];M&&(x.metadata.Unicode.encoding=M,x.encoding=M.codePages[0])}])}(kr.API),function(e){var t=function(n){for(var r=n.length,i=new Uint8Array(r),s=0;s<r;s++)i[s]=n.charCodeAt(s);return i};e.API.events.push(["addFont",function(n){var r=void 0,i=n.font,s=n.instance;if(!i.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(r=s.existsFileInVFS(i.postScriptName)===!1?s.loadFile(i.postScriptName):s.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(o,u){u=/^\x00\x01\x00\x00/.test(u)?t(u):t(sp(u)),o.metadata=e.API.TTFFont.open(u),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(i,r)}}])}(kr),function(e){function t(){return(Ir.canvg?Promise.resolve(Ir.canvg):zc(()=>import("./index.es.js"),[])).catch(function(n){return Promise.reject(new Error("Could not load canvg: "+n))}).then(function(n){return n.default?n.default:n})}kr.API.addSvgAsImage=function(n,r,i,s,o,u,f,d){if(isNaN(r)||isNaN(i))throw lo.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(o))throw lo.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var g=document.createElement("canvas");g.width=s,g.height=o;var y=g.getContext("2d");y.fillStyle="#fff",y.fillRect(0,0,g.width,g.height);var x={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},_=this;return t().then(function(M){return M.fromString(y,n,x)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(M){return M.render(x)}).then(function(){_.addImage(g.toDataURL("image/jpeg",1),r,i,s,o,f,d)})}}(),kr.API.putTotalPages=function(e){var t,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),n=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var i=0;i<this.internal.pages[r].length;i++)this.internal.pages[r][i]=this.internal.pages[r][i].replace(t,n);return this},kr.API.viewerPreferences=function(e,t){var n;e=e||{},t=t||!1;var r,i,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},u=Object.keys(o),f=[],d=0,g=0,y=0;function x(M,T){var D,I=!1;for(D=0;D<M.length;D+=1)M[D]===T&&(I=!0);return I}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var _=u.length;for(y=0;y<_;y+=1)n[u[y]].value=n[u[y]].defaultValue,n[u[y]].explicitSet=!1}if(Xi(e)==="object"){for(i in e)if(s=e[i],x(u,i)&&s!==void 0){if(n[i].type==="boolean"&&typeof s=="boolean")n[i].value=s;else if(n[i].type==="name"&&x(n[i].valueSet,s))n[i].value=s;else if(n[i].type==="integer"&&Number.isInteger(s))n[i].value=s;else if(n[i].type==="array"){for(d=0;d<s.length;d+=1)if(r=!0,s[d].length===1&&typeof s[d][0]=="number")f.push(String(s[d]-1));else if(s[d].length>1){for(g=0;g<s[d].length;g+=1)typeof s[d][g]!="number"&&(r=!1);r===!0&&f.push([s[d][0]-1,s[d][1]-1].join(" "))}n[i].value="["+f.join(" ")+"]"}else n[i].value=n[i].defaultValue;n[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var M,T=[];for(M in n)n[M].explicitSet===!0&&(n[M].type==="name"?T.push("/"+M+" /"+n[M].value):T.push("/"+M+" "+n[M].value));T.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+T.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(e){var t=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(r)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),u=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),f=unescape(encodeURIComponent("</x:xmpmeta>")),d=s.length+o.length+u.length+i.length+f.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(i+s+o+u+f),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(r,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",t)),this}}(kr.API),function(e){var t=e.API,n=t.pdfEscape16=function(s,o){for(var u,f=o.metadata.Unicode.widths,d=["","0","00","000","0000"],g=[""],y=0,x=s.length;y<x;++y){if(u=o.metadata.characterToGlyph(s.charCodeAt(y)),o.metadata.glyIdsUsed.push(u),o.metadata.toUnicode[u]=s.charCodeAt(y),f.indexOf(u)==-1&&(f.push(u),f.push([parseInt(o.metadata.widthOfGlyph(u),10)])),u=="0")return g.join("");u=u.toString(16),g.push(d[4-u.length],u)}return g.join("")},r=function(s){var o,u,f,d,g,y,x;for(g=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,f=[],y=0,x=(u=Object.keys(s).sort(function(_,M){return _-M})).length;y<x;y++)o=u[y],f.length>=100&&(g+=`
`+f.length+` beginbfchar
`+f.join(`
`)+`
endbfchar`,f=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(d=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),f.push("<"+o+"><"+d+">"));return f.length&&(g+=`
`+f.length+` beginbfchar
`+f.join(`
`)+`
endbfchar
`),g+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(o){var u=o.font,f=o.out,d=o.newObject,g=o.putStream;if(u.metadata instanceof e.API.TTFFont&&u.encoding==="Identity-H"){for(var y=u.metadata.Unicode.widths,x=u.metadata.subset.encode(u.metadata.glyIdsUsed,1),_="",M=0;M<x.length;M++)_+=String.fromCharCode(x[M]);var T=d();g({data:_,addLength1:!0,objectId:T}),f("endobj");var D=d();g({data:r(u.metadata.toUnicode),addLength1:!0,objectId:D}),f("endobj");var I=d();f("<<"),f("/Type /FontDescriptor"),f("/FontName /"+jh(u.fontName)),f("/FontFile2 "+T+" 0 R"),f("/FontBBox "+e.API.PDFObject.convert(u.metadata.bbox)),f("/Flags "+u.metadata.flags),f("/StemV "+u.metadata.stemV),f("/ItalicAngle "+u.metadata.italicAngle),f("/Ascent "+u.metadata.ascender),f("/Descent "+u.metadata.decender),f("/CapHeight "+u.metadata.capHeight),f(">>"),f("endobj");var j=d();f("<<"),f("/Type /Font"),f("/BaseFont /"+jh(u.fontName)),f("/FontDescriptor "+I+" 0 R"),f("/W "+e.API.PDFObject.convert(y)),f("/CIDToGIDMap /Identity"),f("/DW 1000"),f("/Subtype /CIDFontType2"),f("/CIDSystemInfo"),f("<<"),f("/Supplement 0"),f("/Registry (Adobe)"),f("/Ordering ("+u.encoding+")"),f(">>"),f(">>"),f("endobj"),u.objectNumber=d(),f("<<"),f("/Type /Font"),f("/Subtype /Type0"),f("/ToUnicode "+D+" 0 R"),f("/BaseFont /"+jh(u.fontName)),f("/Encoding /"+u.encoding),f("/DescendantFonts ["+j+" 0 R]"),f(">>"),f("endobj"),u.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(o){var u=o.font,f=o.out,d=o.newObject,g=o.putStream;if(u.metadata instanceof e.API.TTFFont&&u.encoding==="WinAnsiEncoding"){for(var y=u.metadata.rawData,x="",_=0;_<y.length;_++)x+=String.fromCharCode(y[_]);var M=d();g({data:x,addLength1:!0,objectId:M}),f("endobj");var T=d();g({data:r(u.metadata.toUnicode),addLength1:!0,objectId:T}),f("endobj");var D=d();f("<<"),f("/Descent "+u.metadata.decender),f("/CapHeight "+u.metadata.capHeight),f("/StemV "+u.metadata.stemV),f("/Type /FontDescriptor"),f("/FontFile2 "+M+" 0 R"),f("/Flags 96"),f("/FontBBox "+e.API.PDFObject.convert(u.metadata.bbox)),f("/FontName /"+jh(u.fontName)),f("/ItalicAngle "+u.metadata.italicAngle),f("/Ascent "+u.metadata.ascender),f(">>"),f("endobj"),u.objectNumber=d();for(var I=0;I<u.metadata.hmtx.widths.length;I++)u.metadata.hmtx.widths[I]=parseInt(u.metadata.hmtx.widths[I]*(1e3/u.metadata.head.unitsPerEm));f("<</Subtype/TrueType/Type/Font/ToUnicode "+T+" 0 R/BaseFont/"+jh(u.fontName)+"/FontDescriptor "+D+" 0 R/Encoding/"+u.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(u.metadata.hmtx.widths)+">>"),f("endobj"),u.isAlreadyPutted=!0}})(s)}]);var i=function(s){var o,u=s.text||"",f=s.x,d=s.y,g=s.options||{},y=s.mutex||{},x=y.pdfEscape,_=y.activeFontKey,M=y.fonts,T=_,D="",I=0,j="",Z=M[T].encoding;if(M[T].encoding!=="Identity-H")return{text:u,x:f,y:d,options:g,mutex:y};for(j=u,T=_,Array.isArray(u)&&(j=u[0]),I=0;I<j.length;I+=1)M[T].metadata.hasOwnProperty("cmap")&&(o=M[T].metadata.cmap.unicode.codeMap[j[I].charCodeAt(0)]),o||j[I].charCodeAt(0)<256&&M[T].metadata.hasOwnProperty("Unicode")?D+=j[I]:D+="";var te="";return parseInt(T.slice(1))<14||Z==="WinAnsiEncoding"?te=x(D,T).split("").map(function(ue){return ue.charCodeAt(0).toString(16)}).join(""):Z==="Identity-H"&&(te=n(D,M[T])),y.isHex=!0,{text:te,x:f,y:d,options:g,mutex:y}};t.events.push(["postProcessText",function(s){var o=s.text||"",u=[],f={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var d=0;for(d=0;d<o.length;d+=1)Array.isArray(o[d])&&o[d].length===3?u.push([i(Object.assign({},f,{text:o[d][0]})).text,o[d][1],o[d][2]]):u.push(i(Object.assign({},f,{text:o[d]})).text);s.text=u}else s.text=i(Object.assign({},f,{text:o})).text}])}(kr),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(n){return t.call(this),this.internal.vFS[n]!==void 0},e.addFileToVFS=function(n,r){return t.call(this),this.internal.vFS[n]=r,this},e.getFileFromVFS=function(n){return t.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}}(kr.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(r){var i,s,o,u,f,d,g,y=t,x=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],_=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],M={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},T={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},D=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],I=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),j=!1,Z=0;this.__bidiEngine__={};var te=function(F){var B=F.charCodeAt(),R=B>>8,$=T[R];return $!==void 0?y[256*$+(255&B)]:R===252||R===253?"AL":I.test(R)?"L":R===8?"R":"N"},ue=function(F){for(var B,R=0;R<F.length;R++){if((B=te(F.charAt(R)))==="L")return!1;if(B==="R")return!0}return!1},le=function(F,B,R,$){var W,G,J,Y,pe=B[$];switch(pe){case"L":case"R":j=!1;break;case"N":case"AN":break;case"EN":j&&(pe="AN");break;case"AL":j=!0,pe="R";break;case"WS":pe="N";break;case"CS":$<1||$+1>=B.length||(W=R[$-1])!=="EN"&&W!=="AN"||(G=B[$+1])!=="EN"&&G!=="AN"?pe="N":j&&(G="AN"),pe=G===W?G:"N";break;case"ES":pe=(W=$>0?R[$-1]:"B")==="EN"&&$+1<B.length&&B[$+1]==="EN"?"EN":"N";break;case"ET":if($>0&&R[$-1]==="EN"){pe="EN";break}if(j){pe="N";break}for(J=$+1,Y=B.length;J<Y&&B[J]==="ET";)J++;pe=J<Y&&B[J]==="EN"?"EN":"N";break;case"NSM":if(o&&!u){for(Y=B.length,J=$+1;J<Y&&B[J]==="NSM";)J++;if(J<Y){var Le=F[$],De=Le>=1425&&Le<=2303||Le===64286;if(W=B[J],De&&(W==="R"||W==="AL")){pe="R";break}}}pe=$<1||(W=B[$-1])==="B"?"N":R[$-1];break;case"B":j=!1,i=!0,pe=Z;break;case"S":s=!0,pe="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":j=!1;break;case"BN":pe="N"}return pe},ge=function(F,B,R){var $=F.split("");return R&&H($,R,{hiLevel:Z}),$.reverse(),B&&B.reverse(),$.join("")},H=function(F,B,R){var $,W,G,J,Y,pe=-1,Le=F.length,De=0,N=[],ee=Z?_:x,fe=[];for(j=!1,i=!1,s=!1,W=0;W<Le;W++)fe[W]=te(F[W]);for(G=0;G<Le;G++){if(Y=De,N[G]=le(F,fe,N,G),$=240&(De=ee[Y][M[N[G]]]),De&=15,B[G]=J=ee[De][5],$>0)if($===16){for(W=pe;W<G;W++)B[W]=1;pe=-1}else pe=-1;if(ee[De][6])pe===-1&&(pe=G);else if(pe>-1){for(W=pe;W<G;W++)B[W]=J;pe=-1}fe[G]==="B"&&(B[G]=0),R.hiLevel|=J}s&&function(ce,_e,se){for(var k=0;k<se;k++)if(ce[k]==="S"){_e[k]=Z;for(var ae=k-1;ae>=0&&ce[ae]==="WS";ae--)_e[ae]=Z}}(fe,B,Le)},U=function(F,B,R,$,W){if(!(W.hiLevel<F)){if(F===1&&Z===1&&!i)return B.reverse(),void(R&&R.reverse());for(var G,J,Y,pe,Le=B.length,De=0;De<Le;){if($[De]>=F){for(Y=De+1;Y<Le&&$[Y]>=F;)Y++;for(pe=De,J=Y-1;pe<J;pe++,J--)G=B[pe],B[pe]=B[J],B[J]=G,R&&(G=R[pe],R[pe]=R[J],R[J]=G);De=Y}De++}}},Q=function(F,B,R){var $=F.split(""),W={hiLevel:Z};return R||(R=[]),H($,R,W),function(G,J,Y){if(Y.hiLevel!==0&&g)for(var pe,Le=0;Le<G.length;Le++)J[Le]===1&&(pe=D.indexOf(G[Le]))>=0&&(G[Le]=D[pe+1])}($,R,W),U(2,$,B,R,W),U(1,$,B,R,W),$.join("")};return this.__bidiEngine__.doBidiReorder=function(F,B,R){if(function(W,G){if(G)for(var J=0;J<W.length;J++)G[J]=J;u===void 0&&(u=ue(W)),d===void 0&&(d=ue(W))}(F,B),o||!f||d)if(o&&f&&u^d)Z=u?1:0,F=ge(F,B,R);else if(!o&&f&&d)Z=u?1:0,F=Q(F,B,R),F=ge(F,B);else if(!o||u||f||d){if(o&&!f&&u^d)F=ge(F,B),u?(Z=0,F=Q(F,B,R)):(Z=1,F=Q(F,B,R),F=ge(F,B));else if(o&&u&&!f&&d)Z=1,F=Q(F,B,R),F=ge(F,B);else if(!o&&!f&&u^d){var $=g;u?(Z=1,F=Q(F,B,R),Z=0,g=!1,F=Q(F,B,R),g=$):(Z=0,F=Q(F,B,R),F=ge(F,B),Z=1,g=!1,F=Q(F,B,R),g=$,F=ge(F,B))}}else Z=0,F=Q(F,B,R);else Z=u?1:0,F=Q(F,B,R);return F},this.__bidiEngine__.setOptions=function(F){F&&(o=F.isInputVisual,f=F.isOutputVisual,u=F.isInputRtl,d=F.isOutputRtl,g=F.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(r){var i=r.text,s=(r.x,r.y,r.options||{}),o=(r.mutex,s.lang,[]);if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,n.setOptions(s),Object.prototype.toString.call(i)==="[object Array]"){var u=0;for(o=[],u=0;u<i.length;u+=1)Object.prototype.toString.call(i[u])==="[object Array]"?o.push([n.doBidiReorder(i[u][0]),i[u][1],i[u][2]]):o.push([n.doBidiReorder(i[u])]);r.text=o}else r.text=n.doBidiReorder(i);n.setOptions({isInputVisual:!0})}])}(kr),kr.API.TTFFont=function(){function e(t){var n;if(this.rawData=t,n=this.contents=new Pf(t),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new s9(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new qF(this.contents),this.head=new ZF(this),this.name=new QF(this),this.cmap=new Ox(this),this.toUnicode={},this.hhea=new KF(this),this.maxp=new e9(this),this.hmtx=new t9(this),this.post=new JF(this),this.os2=new YF(this),this.loca=new o9(this),this.glyf=new n9(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,n,r,i,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,u,f,d;for(d=[],o=0,u=(f=this.bbox).length;o<u;o++)t=f[o],d.push(Math.round(t*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(r=255&(i=this.post.italic_angle),32768&(n=i>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var n;return((n=this.cmap.unicode)!=null?n.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*n},e.prototype.widthOfString=function(t,n,r){var i,s,o,u;for(o=0,s=0,u=(t=""+t).length;0<=u?s<u:s>u;s=0<=u?++s:--s)i=t.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(i))+r*(1e3/n)||0;return o*(n/1e3)},e.prototype.lineHeight=function(t,n){var r;return n==null&&(n=!1),r=n?this.lineGap:0,(this.ascender+r-this.decender)/1e3*t},e}();var Zu,Pf=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var n,r;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r[n]=String.fromCharCode(this.readByte());return r.join("")},e.prototype.writeString=function(t){var n,r,i;for(i=[],n=0,r=t.length;0<=r?n<r:n>r;n=0<=r?++n:--n)i.push(this.writeByte(t.charCodeAt(n)));return i},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,n,r,i,s,o,u,f;return t=this.readByte(),n=this.readByte(),r=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),u=this.readByte(),f=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^n)+1099511627776*(255^r)+4294967296*(255^i)+16777216*(255^s)+65536*(255^o)+256*(255^u)+(255^f)+1):72057594037927940*t+281474976710656*n+1099511627776*r+4294967296*i+16777216*s+65536*o+256*u+f},e.prototype.writeLongLong=function(t){var n,r;return n=Math.floor(t/4294967296),r=4294967295&t,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var n,r;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n.push(this.readByte());return n},e.prototype.write=function(t){var n,r,i,s;for(s=[],r=0,i=t.length;r<i;r++)n=t[r],s.push(this.writeByte(n));return s},e}(),qF=function(){var e;function t(n){var r,i,s;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},i=0,s=this.tableCount;0<=s?i<s:i>s;i=0<=s?++i:--i)r={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[r.tag]=r}return t.prototype.encode=function(n){var r,i,s,o,u,f,d,g,y,x,_,M,T;for(T in _=Object.keys(n).length,f=Math.log(2),y=16*Math.floor(Math.log(_)/f),o=Math.floor(y/f),g=16*_-y,(i=new Pf).writeInt(this.scalarType),i.writeShort(_),i.writeShort(y),i.writeShort(o),i.writeShort(g),s=16*_,d=i.pos+s,u=null,M=[],n)for(x=n[T],i.writeString(T),i.writeInt(e(x)),i.writeInt(d),i.writeInt(x.length),M=M.concat(x),T==="head"&&(u=d),d+=x.length;d%4;)M.push(0),d++;return i.write(M),r=2981146554-e(i.data),i.pos=u+8,i.writeUInt32(r),i.data},e=function(n){var r,i,s,o;for(n=Bx.call(n);n.length%4;)n.push(0);for(s=new Pf(n),i=0,r=0,o=n.length;r<o;r=r+=4)i+=s.readUInt32();return 4294967295&i},t}(),WF={}.hasOwnProperty,_c=function(e,t){for(var n in t)WF.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};Zu=function(){function e(t){var n;this.file=t,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var ZF=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return _c(t,Zu),t.prototype.tag="head",t.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.revision=n.readInt(),this.checkSumAdjustment=n.readInt(),this.magicNumber=n.readInt(),this.flags=n.readShort(),this.unitsPerEm=n.readShort(),this.created=n.readLongLong(),this.modified=n.readLongLong(),this.xMin=n.readShort(),this.yMin=n.readShort(),this.xMax=n.readShort(),this.yMax=n.readShort(),this.macStyle=n.readShort(),this.lowestRecPPEM=n.readShort(),this.fontDirectionHint=n.readShort(),this.indexToLocFormat=n.readShort(),this.glyphDataFormat=n.readShort()},t.prototype.encode=function(n){var r;return(r=new Pf).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(n),r.writeShort(this.glyphDataFormat),r.data},t}(),$b=function(){function e(t,n){var r,i,s,o,u,f,d,g,y,x,_,M,T,D,I,j,Z;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=n+t.readInt(),y=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(f=0;f<256;++f)this.codeMap[f]=t.readByte();break;case 4:for(_=t.readUInt16(),x=_/2,t.pos+=6,s=function(){var te,ue;for(ue=[],f=te=0;0<=x?te<x:te>x;f=0<=x?++te:--te)ue.push(t.readUInt16());return ue}(),t.pos+=2,T=function(){var te,ue;for(ue=[],f=te=0;0<=x?te<x:te>x;f=0<=x?++te:--te)ue.push(t.readUInt16());return ue}(),d=function(){var te,ue;for(ue=[],f=te=0;0<=x?te<x:te>x;f=0<=x?++te:--te)ue.push(t.readUInt16());return ue}(),g=function(){var te,ue;for(ue=[],f=te=0;0<=x?te<x:te>x;f=0<=x?++te:--te)ue.push(t.readUInt16());return ue}(),i=(this.length-t.pos+this.offset)/2,u=function(){var te,ue;for(ue=[],f=te=0;0<=i?te<i:te>i;f=0<=i?++te:--te)ue.push(t.readUInt16());return ue}(),f=I=0,Z=s.length;I<Z;f=++I)for(D=s[f],r=j=M=T[f];M<=D?j<=D:j>=D;r=M<=D?++j:--j)g[f]===0?o=r+d[f]:(o=u[g[f]/2+(r-M)-(x-f)]||0)!==0&&(o+=d[f]),this.codeMap[r]=65535&o}t.pos=y}return e.encode=function(t,n){var r,i,s,o,u,f,d,g,y,x,_,M,T,D,I,j,Z,te,ue,le,ge,H,U,Q,F,B,R,$,W,G,J,Y,pe,Le,De,N,ee,fe,ce,_e,se,k,ae,ke,Pe,Ge;switch($=new Pf,o=Object.keys(t).sort(function(K,de){return K-de}),n){case"macroman":for(T=0,D=function(){var K=[];for(M=0;M<256;++M)K.push(0);return K}(),j={0:0},s={},W=0,pe=o.length;W<pe;W++)j[ae=t[i=o[W]]]==null&&(j[ae]=++T),s[i]={old:t[i],new:j[t[i]]},D[i]=j[t[i]];return $.writeUInt16(1),$.writeUInt16(0),$.writeUInt32(12),$.writeUInt16(0),$.writeUInt16(262),$.writeUInt16(0),$.write(D),{charMap:s,subtable:$.data,maxGlyphID:T+1};case"unicode":for(B=[],y=[],Z=0,j={},r={},I=d=null,G=0,Le=o.length;G<Le;G++)j[ue=t[i=o[G]]]==null&&(j[ue]=++Z),r[i]={old:ue,new:j[ue]},u=j[ue]-i,I!=null&&u===d||(I&&y.push(I),B.push(i),d=u),I=i;for(I&&y.push(I),y.push(65535),B.push(65535),Q=2*(U=B.length),H=2*Math.pow(Math.log(U)/Math.LN2,2),x=Math.log(H/2)/Math.LN2,ge=2*U-H,f=[],le=[],_=[],M=J=0,De=B.length;J<De;M=++J){if(F=B[M],g=y[M],F===65535){f.push(0),le.push(0);break}if(F-(R=r[F].new)>=32768)for(f.push(0),le.push(2*(_.length+U-M)),i=Y=F;F<=g?Y<=g:Y>=g;i=F<=g?++Y:--Y)_.push(r[i].new);else f.push(R-F),le.push(0)}for($.writeUInt16(3),$.writeUInt16(1),$.writeUInt32(12),$.writeUInt16(4),$.writeUInt16(16+8*U+2*_.length),$.writeUInt16(0),$.writeUInt16(Q),$.writeUInt16(H),$.writeUInt16(x),$.writeUInt16(ge),se=0,N=y.length;se<N;se++)i=y[se],$.writeUInt16(i);for($.writeUInt16(0),k=0,ee=B.length;k<ee;k++)i=B[k],$.writeUInt16(i);for(ke=0,fe=f.length;ke<fe;ke++)u=f[ke],$.writeUInt16(u);for(Pe=0,ce=le.length;Pe<ce;Pe++)te=le[Pe],$.writeUInt16(te);for(Ge=0,_e=_.length;Ge<_e;Ge++)T=_[Ge],$.writeUInt16(T);return{charMap:r,subtable:$.data,maxGlyphID:Z+1}}},e}(),Ox=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return _c(t,Zu),t.prototype.tag="cmap",t.prototype.parse=function(n){var r,i,s;for(n.pos=this.offset,this.version=n.readUInt16(),s=n.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=s?i<s:i>s;i=0<=s?++i:--i)r=new $b(n,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(n,r){var i,s;return r==null&&(r="macroman"),i=$b.encode(n,r),(s=new Pf).writeUInt16(0),s.writeUInt16(1),i.table=s.data.concat(i.subtable),i},t}(),KF=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return _c(t,Zu),t.prototype.tag="hhea",t.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.ascender=n.readShort(),this.decender=n.readShort(),this.lineGap=n.readShort(),this.advanceWidthMax=n.readShort(),this.minLeftSideBearing=n.readShort(),this.minRightSideBearing=n.readShort(),this.xMaxExtent=n.readShort(),this.caretSlopeRise=n.readShort(),this.caretSlopeRun=n.readShort(),this.caretOffset=n.readShort(),n.pos+=8,this.metricDataFormat=n.readShort(),this.numberOfMetrics=n.readUInt16()},t}(),YF=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return _c(t,Zu),t.prototype.tag="OS/2",t.prototype.parse=function(n){if(n.pos=this.offset,this.version=n.readUInt16(),this.averageCharWidth=n.readShort(),this.weightClass=n.readUInt16(),this.widthClass=n.readUInt16(),this.type=n.readShort(),this.ySubscriptXSize=n.readShort(),this.ySubscriptYSize=n.readShort(),this.ySubscriptXOffset=n.readShort(),this.ySubscriptYOffset=n.readShort(),this.ySuperscriptXSize=n.readShort(),this.ySuperscriptYSize=n.readShort(),this.ySuperscriptXOffset=n.readShort(),this.ySuperscriptYOffset=n.readShort(),this.yStrikeoutSize=n.readShort(),this.yStrikeoutPosition=n.readShort(),this.familyClass=n.readShort(),this.panose=function(){var r,i;for(i=[],r=0;r<10;++r)i.push(n.readByte());return i}(),this.charRange=function(){var r,i;for(i=[],r=0;r<4;++r)i.push(n.readInt());return i}(),this.vendorID=n.readString(4),this.selection=n.readShort(),this.firstCharIndex=n.readShort(),this.lastCharIndex=n.readShort(),this.version>0&&(this.ascent=n.readShort(),this.descent=n.readShort(),this.lineGap=n.readShort(),this.winAscent=n.readShort(),this.winDescent=n.readShort(),this.codePageRange=function(){var r,i;for(i=[],r=0;r<2;r=++r)i.push(n.readInt());return i}(),this.version>1))return this.xHeight=n.readShort(),this.capHeight=n.readShort(),this.defaultChar=n.readShort(),this.breakChar=n.readShort(),this.maxContext=n.readShort()},t}(),JF=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return _c(t,Zu),t.prototype.tag="post",t.prototype.parse=function(n){var r,i,s;switch(n.pos=this.offset,this.format=n.readInt(),this.italicAngle=n.readInt(),this.underlinePosition=n.readShort(),this.underlineThickness=n.readShort(),this.isFixedPitch=n.readInt(),this.minMemType42=n.readInt(),this.maxMemType42=n.readInt(),this.minMemType1=n.readInt(),this.maxMemType1=n.readInt(),this.format){case 65536:break;case 131072:var o;for(i=n.readUInt16(),this.glyphNameIndex=[],o=0;0<=i?o<i:o>i;o=0<=i?++o:--o)this.glyphNameIndex.push(n.readUInt16());for(this.names=[],s=[];n.pos<this.offset+this.length;)r=n.readByte(),s.push(this.names.push(n.readString(r)));return s;case 151552:return i=n.readUInt16(),this.offsets=n.read(i);case 196608:break;case 262144:return this.map=(function(){var u,f,d;for(d=[],o=u=0,f=this.file.maxp.numGlyphs;0<=f?u<f:u>f;o=0<=f?++u:--u)d.push(n.readUInt32());return d}).call(this)}},t}(),XF=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},QF=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return _c(t,Zu),t.prototype.tag="name",t.prototype.parse=function(n){var r,i,s,o,u,f,d,g,y,x,_;for(n.pos=this.offset,n.readShort(),r=n.readShort(),f=n.readShort(),i=[],o=0;0<=r?o<r:o>r;o=0<=r?++o:--o)i.push({platformID:n.readShort(),encodingID:n.readShort(),languageID:n.readShort(),nameID:n.readShort(),length:n.readShort(),offset:this.offset+f+n.readShort()});for(d={},o=y=0,x=i.length;y<x;o=++y)s=i[o],n.pos=s.offset,g=n.readString(s.length),u=new XF(g,s),d[_=s.nameID]==null&&(d[_]=[]),d[s.nameID].push(u);this.strings=d,this.copyright=d[0],this.fontFamily=d[1],this.fontSubfamily=d[2],this.uniqueSubfamily=d[3],this.fontName=d[4],this.version=d[5];try{this.postscriptName=d[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=d[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=d[7],this.manufacturer=d[8],this.designer=d[9],this.description=d[10],this.vendorUrl=d[11],this.designerUrl=d[12],this.license=d[13],this.licenseUrl=d[14],this.preferredFamily=d[15],this.preferredSubfamily=d[17],this.compatibleFull=d[18],this.sampleText=d[19]},t}(),e9=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return _c(t,Zu),t.prototype.tag="maxp",t.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.numGlyphs=n.readUInt16(),this.maxPoints=n.readUInt16(),this.maxContours=n.readUInt16(),this.maxCompositePoints=n.readUInt16(),this.maxComponentContours=n.readUInt16(),this.maxZones=n.readUInt16(),this.maxTwilightPoints=n.readUInt16(),this.maxStorage=n.readUInt16(),this.maxFunctionDefs=n.readUInt16(),this.maxInstructionDefs=n.readUInt16(),this.maxStackElements=n.readUInt16(),this.maxSizeOfInstructions=n.readUInt16(),this.maxComponentElements=n.readUInt16(),this.maxComponentDepth=n.readUInt16()},t}(),t9=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return _c(t,Zu),t.prototype.tag="hmtx",t.prototype.parse=function(n){var r,i,s,o,u,f,d;for(n.pos=this.offset,this.metrics=[],r=0,f=this.file.hhea.numberOfMetrics;0<=f?r<f:r>f;r=0<=f?++r:--r)this.metrics.push({advance:n.readUInt16(),lsb:n.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var g,y;for(y=[],r=g=0;0<=s?g<s:g>s;r=0<=s?++g:--g)y.push(n.readInt16());return y}(),this.widths=(function(){var g,y,x,_;for(_=[],g=0,y=(x=this.metrics).length;g<y;g++)o=x[g],_.push(o.advance);return _}).call(this),i=this.widths[this.widths.length-1],d=[],r=u=0;0<=s?u<s:u>s;r=0<=s?++u:--u)d.push(this.widths.push(i));return d},t.prototype.forGlyph=function(n){return n in this.metrics?this.metrics[n]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[n-this.metrics.length]}},t}(),Bx=[].slice,n9=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return _c(t,Zu),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(n){var r,i,s,o,u,f,d,g,y,x;return n in this.cache?this.cache[n]:(o=this.file.loca,r=this.file.contents,i=o.indexOf(n),(s=o.lengthOf(n))===0?this.cache[n]=null:(r.pos=this.offset+i,u=(f=new Pf(r.read(s))).readShort(),g=f.readShort(),x=f.readShort(),d=f.readShort(),y=f.readShort(),this.cache[n]=u===-1?new i9(f,g,x,d,y):new r9(f,u,g,x,d,y),this.cache[n]))},t.prototype.encode=function(n,r,i){var s,o,u,f,d;for(u=[],o=[],f=0,d=r.length;f<d;f++)s=n[r[f]],o.push(u.length),s&&(u=u.concat(s.encode(i)));return o.push(u.length),{table:u,offsets:o}},t}(),r9=function(){function e(t,n,r,i,s,o){this.raw=t,this.numberOfContours=n,this.xMin=r,this.yMin=i,this.xMax=s,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),i9=function(){function e(t,n,r,i,s){var o,u;for(this.raw=t,this.xMin=n,this.yMin=r,this.xMax=i,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;u=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&u;)o.pos+=1&u?4:2,128&u?o.pos+=8:64&u?o.pos+=4:8&u&&(o.pos+=2)}return e.prototype.encode=function(){var t,n,r;for(n=new Pf(Bx.call(this.raw.data)),t=0,r=this.glyphIDs.length;t<r;++t)n.pos=this.glyphOffsets[t];return n.data},e}(),o9=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return _c(t,Zu),t.prototype.tag="loca",t.prototype.parse=function(n){var r,i;return n.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var s,o;for(o=[],i=0,s=this.length;i<s;i+=2)o.push(2*n.readUInt16());return o}).call(this):(function(){var s,o;for(o=[],i=0,s=this.length;i<s;i+=4)o.push(n.readUInt32());return o}).call(this)},t.prototype.indexOf=function(n){return this.offsets[n]},t.prototype.lengthOf=function(n){return this.offsets[n+1]-this.offsets[n]},t.prototype.encode=function(n,r){for(var i=new Uint32Array(this.offsets.length),s=0,o=0,u=0;u<i.length;++u)if(i[u]=s,o<r.length&&r[o]==u){++o,i[u]=s;var f=this.offsets[u],d=this.offsets[u+1]-f;d>0&&(s+=d)}for(var g=new Array(4*i.length),y=0;y<i.length;++y)g[4*y+3]=255&i[y],g[4*y+2]=(65280&i[y])>>8,g[4*y+1]=(16711680&i[y])>>16,g[4*y]=(4278190080&i[y])>>24;return g},t}(),s9=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,n,r,i,s;for(n in i=this.font.cmap.tables[0].codeMap,t={},s=this.subset)r=s[n],t[n]=i[r];return t},e.prototype.glyphsFor=function(t){var n,r,i,s,o,u,f;for(i={},o=0,u=t.length;o<u;o++)i[s=t[o]]=this.font.glyf.glyphFor(s);for(s in n=[],i)(r=i[s])!=null&&r.compound&&n.push.apply(n,r.glyphIDs);if(n.length>0)for(s in f=this.glyphsFor(n))r=f[s],i[s]=r;return i},e.prototype.encode=function(t,n){var r,i,s,o,u,f,d,g,y,x,_,M,T,D,I;for(i in r=Ox.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),_={0:0},I=r.charMap)_[(f=I[i]).old]=f.new;for(M in x=r.maxGlyphID,o)M in _||(_[M]=x++);return g=function(j){var Z,te;for(Z in te={},j)te[j[Z]]=Z;return te}(_),y=Object.keys(g).sort(function(j,Z){return j-Z}),T=function(){var j,Z,te;for(te=[],j=0,Z=y.length;j<Z;j++)u=y[j],te.push(g[u]);return te}(),s=this.font.glyf.encode(o,T,_),d=this.font.loca.encode(s.offsets,T),D={cmap:this.font.cmap.raw(),glyf:s.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(D["OS/2"]=this.font.os2.raw()),this.font.directory.encode(D)},e}();kr.API.PDFObject=function(){var e;function t(){}return e=function(n,r){return(Array(r+1).join("0")+n).slice(-r)},t.convert=function(n){var r,i,s,o;if(Array.isArray(n))return"["+function(){var u,f,d;for(d=[],u=0,f=n.length;u<f;u++)r=n[u],d.push(t.convert(r));return d}().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+e(n.getUTCFullYear(),4)+e(n.getUTCMonth(),2)+e(n.getUTCDate(),2)+e(n.getUTCHours(),2)+e(n.getUTCMinutes(),2)+e(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(i in s=["<<"],n)o=n[i],s.push("/"+i+" "+t.convert(o));return s.push(">>"),s.join(`
`)}return""+n},t}();const a9={class:"h-full flex"},l9={class:"flex-1 relative"},u9={key:0,class:"absolute inset-0 bg-black/30 backdrop-blur-sm z-[2000] flex items-center justify-center"},c9={key:1,class:"absolute inset-0 flex items-center justify-center bg-gray-50 z-[3000]"},f9={class:"text-center max-w-lg mx-auto p-8"},h9={class:"space-y-4"},d9={class:"map-parent"},p9={key:0,class:"fixed left-0 right-0 z-[1500]",style:{top:"var(--header-height)"}},g9={class:"map-content flex flex-col md:flex-row relative"},m9={class:"flex-1 relative"},v9={key:0,class:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-75 z-50"},y9={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center z-[9999] p-4 overflow-y-auto"},_9={class:"bg-white rounded-lg p-6 max-w-2xl w-full my-8 relative"},b9={class:"flex justify-between items-center mb-4 sticky top-0 bg-white pb-4 border-b"},w9={class:"overflow-y-auto max-h-[calc(100vh-12rem)]"},x9={key:0,class:"space-y-4"},L9={key:0,class:"space-y-2"},S9={class:"grid grid-cols-1 gap-2"},C9=["onClick"],E9={class:"font-medium text-gray-900"},P9={key:1,class:"space-y-2"},M9={class:"flex items-center mb-4"},A9={class:"text-sm text-gray-600"},k9={class:"grid grid-cols-1 gap-2"},T9=["onClick"],N9={class:"font-medium text-gray-900"},D9={key:2,class:"space-y-2"},I9={class:"flex items-center mb-4"},O9={class:"text-sm text-gray-600"},B9={class:"grid grid-cols-1 gap-2"},R9={key:0,class:"text-center py-8"},F9=["onClick"],j9={class:"font-medium text-gray-900"},z9={key:3,class:"space-y-2"},$9={class:"flex items-center mb-4"},U9={class:"text-sm text-gray-600"},V9={class:"grid grid-cols-1 gap-2"},G9=["onClick"],H9={class:"font-medium text-gray-900"},q9={class:"text-sm text-gray-500"},W9={class:"text-xs text-gray-400 mt-1"},Z9={key:1,class:"space-y-4"},K9={key:0,class:"space-y-2"},Y9={class:"grid grid-cols-1 gap-2"},J9={key:0,class:"text-center py-8"},X9=["onClick"],Q9={class:"font-medium text-gray-900"},ej={key:1,class:"space-y-2"},tj={class:"flex items-center mb-4"},nj={class:"text-sm text-gray-600"},rj={class:"grid grid-cols-1 gap-2"},ij=["onClick"],oj={class:"font-medium text-gray-900"},sj={class:"text-sm text-gray-500"},aj={class:"text-xs text-gray-400 mt-1"},lj={key:2,class:"space-y-4"},uj={key:3,class:"space-y-4"},cj={key:0,class:"text-center py-8"},fj={key:1,class:"space-y-2"},hj=["onClick"],dj={class:"font-medium text-gray-900"},pj={class:"text-sm text-gray-500"},gj={class:"text-xs text-gray-400 mt-1"},Ub=cs({__name:"MapView",emits:["shape-selected"],setup(e,{emit:t}){const n=Ft(null),r=Ft(!1),i=py(),s=ad(),o=Rp(),u=Uu(),f=Ft([]),{currentTool:d,selectedShape:g,map:y,initMap:x,setDrawingTool:_,updateShapeStyle:M,updateShapeProperties:T,featureGroup:D,adjustView:I,clearActiveControlPoints:j,calculateConnectedCoverageArea:Z}=zR(),{initMap:te,changeBaseMap:ue}=$R(),le=Ft(!1),ge=Ft(!1),H=Ft(!1),U=Ft(null),Q=Ft(null),F=Ft(!1),B=Ft(null),R=ma(),$=Ft([]),W=Ft([]),G=Ft([]),J=Ft(null),Y=Ft(null),pe=Ft(null),Le=Ft(!1),De=Ft(!1),N=Ft(!1),ee=Ft(null),fe=cr(()=>{var at,We;return console.log("[MapView][filteredClients] Computing with:",{userType:(at=R.user)==null?void 0:at.user_type,selectedSalarie:J.value,salarieVisiteurs:W.value,visiteurCount:((We=W.value)==null?void 0:We.length)||0}),R.isSalarie||J.value?W.value:[]}),ce=cr(()=>{var Zn,qt,mn;if(!g.value)return null;console.log("[MapView][selectedShape] Initial layer state:",{layer:g.value,hasName:"name"in g.value,name:g.value.name,hasProperties:"properties"in g.value,propertiesName:(Zn=g.value.properties)==null?void 0:Zn.name,allLayerKeys:Object.keys(g.value),allPropertiesKeys:g.value.properties?Object.keys(g.value.properties):[],_leaflet_id:g.value._leaflet_id,_dbId:g.value._dbId,descriptor:Object.getOwnPropertyDescriptor(g.value,"name")});const at=g.value.properties||{};let We="unknown";at.type?We=at.type:g.value instanceof Rt.Circle?We="Circle":g.value instanceof pa||g.value instanceof Rt.Rectangle?We="Rectangle":g.value instanceof gf||g.value instanceof Rt.Polygon?We="Polygon":g.value instanceof Cf?We="ElevationLine":(g.value instanceof Ns||g.value instanceof Rt.Polyline&&!(g.value instanceof Rt.Polygon))&&(We="Line"),console.log(`[MapView][selectedShape] Type de forme détecté: ${We}`),at.type||(g.value.properties||(g.value.properties={}),g.value.properties.type=We);let It;if(at.style&&at.style.name)It=at.style.name,console.log("[MapView][selectedShape] Using name from style:",It);else if(at.name)It=at.name,console.log("[MapView][selectedShape] Using name from properties:",It);else if(g.value.name)It=g.value.name,console.log("[MapView][selectedShape] Using name from layer:",It);else{const Bt=Object.getOwnPropertyDescriptor(g.value,"name");Bt&&Bt.value&&(It=Bt.value,console.log("[MapView][selectedShape] Found name in non-enumerable layer property:",It));const Kt=["_name","displayName","title"];for(const Ln of Kt)if(g.value[Ln]){It=g.value[Ln],console.log(`[MapView][selectedShape] Found name in ${Ln}:`,It);break}}It&&(console.log(`[MapView][selectedShape] Ensuring name "${It}" is set everywhere`),g.value.properties||(g.value.properties={}),g.value.properties.name=It,g.value.properties.style||(g.value.properties.style={}),g.value.properties.style.name=It,g.value.name=It,typeof g.value.setName=="function"&&(g.value.setName(It),console.log(`[MapView][selectedShape] Used setName method to set name "${It}"`))),g.value.properties.category||(g.value.properties.category="forages"),g.value.properties.accessLevel||(g.value.properties.accessLevel="visitor"),console.log("[MapView][selectedShape] Preparing properties for DrawingTools:",{type:We,name:at.name,foundName:It,hasNameProperty:"name"in at,allPropertiesKeys:Object.keys(at),layerId:g.value._leaflet_id,rawProperties:at,layerName:g.value.name,layerPropertiesName:(qt=g.value.properties)==null?void 0:qt.name});const En={...at,type:We,name:It||g.value.name||at.name||void 0,category:g.value.properties.category||"forages",accessLevel:g.value.properties.accessLevel||"visitor"},Jn={type:We,properties:En,layer:g.value,options:g.value.options||{}};return console.log("[MapView][selectedShape] Final shape object for DrawingTools:",{type:Jn.type,hasName:"name"in Jn.properties,name:Jn.properties.name,layerName:Jn.layer.name,layerPropertiesName:(mn=Jn.layer.properties)==null?void 0:mn.name}),Jn});function _e(at){const We=at.getCenter(),It=at.getZoom(),En={lat:We.lat,lng:We.lng,zoom:It};document.cookie=`mapState=${JSON.stringify(En)};max-age=2592000;path=/`}function se(){const We=document.cookie.split(";").find(It=>It.trim().startsWith("mapState="));if(We)try{return JSON.parse(We.split("=")[1])}catch(It){return console.error("Erreur lors de la lecture du cookie de position:",It),null}return null}$s(async()=>{var at,We;console.log("[MapView][onMounted] Initialisation du composant MapView"),console.log("[MapView][onMounted] État initial des filtres dans le store:",JSON.stringify({accessLevels:{...s.filters.accessLevels},categories:{...s.filters.categories},shapeTypes:{...s.filters.shapeTypes}},null,2));try{if(await i.fetchPlans(),(R.isAdmin||R.isEntreprise)&&await rt(),R.isEntreprise){Le.value=!0;try{const Bt=await Rn.get("/users/",{params:{role:"SALARIE",entreprise:(at=R.user)==null?void 0:at.id}});$.value=Bt.data}catch(Bt){console.error("Error loading salaries:",Bt),$.value=[]}finally{Le.value=!1}}if(R.isSalarie){De.value=!0;try{const Bt=await R.fetchSalarieVisiteurs(((We=R.user)==null?void 0:We.id)||0);W.value=Array.isArray(Bt)?Bt:[Bt]}catch(Bt){console.error("Error loading clients:",Bt)}finally{De.value=!1}}const It=se(),En=It?[It.lat,It.lng]:[46.603354,1.888334],Jn=(It==null?void 0:It.zoom)??6;if(n.value&&!y.value){const Bt=x(n.value,En,Jn);Bt.pm.setLang("fr"),Bt.pm.addControls({rotateMode:!1}),te(Bt),Bt.on("moveend",()=>{_e(Bt)}),window.addEventListener("map-set-location",Kt=>{if(Bt&&Kt.detail){const{lat:Ln,lng:mr,zoom:lt}=Kt.detail;Bt.flyTo([Ln,mr],lt,{duration:1.5,easeLinearity:.25})}}),D.value&&(D.value.on("layeradd",Kt=>{const Ln=Kt.layer;Ln&&Ln._leaflet_id&&f.value.findIndex(lt=>lt.layer&&lt.layer._leaflet_id===Ln._leaflet_id)===-1&&(console.log(`[MapView][featureGroup.layeradd] Ajout de la couche ${Ln._leaflet_id} à shapes.value`),f.value.push({layer:Ln,id:Ln._dbId||Ln._leaflet_id}))}),D.value.on("layerremove",Kt=>{const Ln=Kt.layer;Ln&&Ln._leaflet_id&&console.log(`[MapView][featureGroup.layerremove] Couche ${Ln._leaflet_id} supprimée du featureGroup mais conservée dans shapes.value`)}))}const Zn=localStorage.getItem("lastPlanId");if(Zn)try{console.log("[MapView][onMounted] Chargement immédiat du dernier plan:",Zn),await Ge(parseInt(Zn));const Bt=document.querySelector(".map-parent");Bt instanceof HTMLElement&&(Bt.style.display="block")}catch(Bt){console.error("[MapView][onMounted] Erreur chargement dernier plan:",Bt),U.value=null,i.clearCurrentPlan(),s.clearCurrentPlan(),ke(),localStorage.removeItem("lastPlanId")}else console.log("[MapView][onMounted] Aucun dernier plan à charger"),U.value=null,i.clearCurrentPlan(),s.clearCurrentPlan(),ke();window.addEventListener("shape:created",Bt=>{const{shape:Kt,type:Ln,properties:mr}=Bt.detail;console.log("[MapView] Nouvelle forme créée",{shape:Kt,type:Ln,properties:mr}),s.addElement(Kt),_("")}),window.addEventListener("geonote:savePlan",()=>{console.log("[MapView] Événement geonote:savePlan reçu - Sauvegarde automatique du plan"),K()}),window.addEventListener("categoriesReactivated",Bt=>{console.log("[MapView][categoriesReactivated] Événement reçu:",Bt.detail),Mn()}),window.addEventListener("shapeTypesReactivated",Bt=>{console.log("[MapView][shapeTypesReactivated] Événement reçu:",Bt.detail),Mn()});const qt=Bt=>{if(console.log("[MapView] Édition de note via Leaflet",Bt),console.log("[MapView] Type de e:",typeof Bt,"Contenu de e:",JSON.stringify(Bt)),!Bt||!Bt.note){console.error("[MapView] Erreur: e.note est undefined ou null",Bt);return}const Kt=Bt.note;console.log("[MapView] Note à éditer:",Kt),Q.value={id:Kt.id,title:Kt.title||Kt.name,description:Kt.description,location:Kt.location,columnId:Kt.columnId||o.getDefaultColumn.id,accessLevel:Kt.accessLevel,style:Kt.style||{color:"#3B82F6",weight:2,opacity:1,fillColor:"#3B82F6",fillOpacity:.6,radius:8},order:0,createdAt:Kt.createdAt||new Date().toISOString(),updatedAt:Kt.updatedAt||new Date().toISOString(),comments:Kt.comments||[],photos:Kt.photos||[]},console.log("[MapView] editingMapNote.value après conversion:",Q.value),H.value=!0,console.log("[MapView] showNoteEditModal.value:",H.value)},mn=Bt=>{if(console.log("[MapView] Édition de note via événement global",Bt),!Bt.detail||!Bt.detail.note){console.error("[MapView] Erreur: event.detail.note est undefined ou null",Bt);return}const Kt=Bt.detail.note;console.log("[MapView] Note à éditer (global):",Kt),Q.value={id:Kt.id,title:Kt.title||Kt.name,description:Kt.description,location:Kt.location,columnId:Kt.columnId||o.getDefaultColumn.id,accessLevel:Kt.accessLevel,style:Kt.style||{color:"#3B82F6",weight:2,opacity:1,fillColor:"#3B82F6",fillOpacity:.6,radius:8},order:0,createdAt:Kt.createdAt||new Date().toISOString(),updatedAt:Kt.updatedAt||new Date().toISOString(),comments:Kt.comments||[],photos:Kt.photos||[]},H.value=!0};window.addEventListener("geonote:edit",mn),D.value&&(D.value.off("note:edit"),D.value.on("note:edit",qt))}catch(It){console.error("Error during component mount:",It),U.value=null,i.clearCurrentPlan(),s.clearCurrentPlan(),ke(),localStorage.removeItem("lastPlanId")}}),Co(()=>s.hasUnsavedChanges,at=>{console.log("[MapView][watch drawingStore.hasUnsavedChanges]",at),at&&U.value&&i.markUnsavedChanges()}),Co(()=>s.filters,(at,We)=>{if(console.log("[MapView][watch drawingStore.filters] Changement de filtres détecté:",JSON.stringify(at,null,2)),We){const It=JSON.stringify(We.accessLevels)!==JSON.stringify(at.accessLevels),En=JSON.stringify(We.categories)!==JSON.stringify(at.categories),Jn=JSON.stringify(We.shapeTypes)!==JSON.stringify(at.shapeTypes);console.log("[MapView][watch drawingStore.filters] Changements détectés:",{accessLevelsChanged:It,categoriesChanged:En,shapeTypesChanged:Jn}),It||En||Jn?(console.log("[MapView][watch drawingStore.filters] Mise à jour de l'affichage suite au changement de filtres"),Mn()):console.log("[MapView][watch drawingStore.filters] Aucun changement réel, pas de mise à jour")}else console.log("[MapView][watch drawingStore.filters] Mise à jour de l'affichage suite au changement de filtres"),Mn()},{deep:!0});const k=at=>{console.log("[MapView][filtersChanged] Événement reçu:",at.detail),Mn()};$s(()=>{window.addEventListener("filtersChanged",k)}),mc(()=>{window.removeEventListener("filtersChanged",k),console.log("[MapView][filtersChanged] Événement désactivé")}),Co(()=>s.getFilteredElements,(at,We)=>{console.log("[MapView][watch drawingStore.getFilteredElements] Mise à jour de l'affichage, éléments filtrés:",{nouveaux:at.length,anciens:We?We.length:"aucun",ids:at.map(It=>It.id)}),console.log("[MapView][watch drawingStore.getFilteredElements] Mise à jour de l'affichage suite au changement d'elements filtrés"),Mn()},{deep:!0}),Co(y,async at=>{var We;console.log(`
[MapView][watch map] Nouvelle carte:`,!!at),at&&i.currentPlan&&!((We=D.value)!=null&&We.getLayers().length)&&(console.log("[MapView][watch map] Chargement initial des éléments du plan:",i.currentPlan.id),ke(),await s.loadPlanElements(i.currentPlan.id))}),Co(()=>i.currentPlan,async(at,We)=>{var It,En,Jn;if((at==null?void 0:at.id)===(We==null?void 0:We.id)){console.log("[MapView][watch currentPlan] Plan identique, pas de rechargement nécessaire");return}console.log(`
[MapView][watch currentPlan] ====== CHANGEMENT DE PLAN ======`),console.log("[MapView][watch currentPlan] Nouveau plan:",at==null?void 0:at.id);try{if(at){console.log("[MapView][watch currentPlan] Mise à jour du plan courant..."),U.value=at;const Zn=document.querySelector(".map-parent");Zn instanceof HTMLElement&&(Zn.style.display="block"),console.log("[MapView][watch currentPlan] Plan mis à jour avec succès")}else{console.log("[MapView][watch currentPlan] Nettoyage du plan courant..."),U.value=null,ke();const Zn=document.querySelector(".map-parent");Zn instanceof HTMLElement&&(Zn.style.display="none")}}catch(Zn){console.error("[MapView][watch currentPlan] ERREUR:",Zn),U.value=null,ke()}console.log("[MapView][watch currentPlan] État final:",{currentPlanId:(It=U.value)==null?void 0:It.id,storePlanId:(En=i.currentPlan)==null?void 0:En.id,mapVisible:y.value!==null,mapParentDisplay:(Jn=document.querySelector(".map-parent"))==null?void 0:Jn.getAttribute("style")}),console.log(`[MapView][watch currentPlan] ====== FIN CHANGEMENT ======
`)},{immediate:!0}),fd(()=>{y.value&&y.value.off("moveend"),window.removeEventListener("shape:created",()=>{})});function ae(){r.value=!r.value}function ke(){D.value&&(D.value.eachLayer(at=>{var We;((We=at.properties)==null?void 0:We.type)==="Note"&&typeof at.resetPlanSaveState=="function"&&at.resetPlanSaveState()}),D.value.clearLayers()),f.value=[],j(),g.value=null,d.value=""}async function Pe(at){return await hn.measureAsync("refreshMapWithPlan",async()=>{try{hn.measure("refreshMapWithPlan:clearMap",()=>{ke()},"MapView"),await hn.measureAsync("refreshMapWithPlan:loadPlanElements",async()=>{await s.loadPlanElements(at)},"MapView");const We=hn.measure("refreshMapWithPlan:getPlanById",()=>i.getPlanById(at),"MapView");We?(hn.measure("refreshMapWithPlan:updateCurrentPlan",()=>{U.value=We,i.setCurrentPlan(We),s.setCurrentPlan(We.id),localStorage.setItem("lastPlanId",We.id.toString())},"MapView"),y.value&&D.value&&await hn.measureAsync("refreshMapWithPlan:addShapesToMap",async()=>{console.log("[MapView][refreshMapWithPlan] Éléments disponibles:",{count:s.getCurrentElements.length,elements:s.getCurrentElements.map(Zn=>{var qt;return{id:Zn.id,type:Zn.type_forme,hasName:Zn.data&&"name"in Zn.data,name:(qt=Zn.data)==null?void 0:qt.name}})});const It=s.getCurrentElements.reduce((Zn,qt)=>(Zn[qt.type_forme]||(Zn[qt.type_forme]=[]),Zn[qt.type_forme].push(qt),Zn),{}),En=10,Jn=Object.entries(It).map(async([Zn,qt])=>{for(let mn=0;mn<qt.length;mn+=En){const Bt=qt.slice(mn,mn+En);await Promise.all(Bt.map(async Kt=>{await hn.measureAsync(`refreshMapWithPlan:createElement:${Kt.type_forme}`,async()=>{var mr;if(!D.value||!Kt.data)return;let Ln=null;switch(Kt.type_forme){case"Circle":{const lt=Kt.data;lt.center&&lt.radius&&(Ln=new Rh(Rt.latLng(lt.center[1],lt.center[0]),{...lt.style,radius:lt.radius}),lt.name&&(Ln.properties={type:"Circle",name:lt.name,style:lt.style,radius:lt.radius,diameter:lt.radius*2,surface:Math.PI*lt.radius*lt.radius,perimeter:2*Math.PI*lt.radius},Ln.name=lt.name));break}case"Rectangle":{const lt=Kt.data;if(lt.bounds){const Cn=Rt.latLngBounds(Rt.latLng(lt.bounds.southWest[1],lt.bounds.southWest[0]),Rt.latLng(lt.bounds.northEast[1],lt.bounds.northEast[0]));Ln=new pa(Cn,lt.style),lt.name&&(Ln.properties={name:lt.name},Ln.name=lt.name)}break}case"Polygon":{const lt=Kt.data;if(lt.points&&lt.points.length>0){const Cn=lt.points.map(xr=>Rt.latLng(xr[1],xr[0]));Ln=new gf(Cn,lt.style),lt.name&&(Ln.properties={name:lt.name},Ln.name=lt.name)}break}case"Line":{const lt=Kt.data;if(lt.points&&lt.points.length>0){const Cn=lt.points.map(xr=>Rt.latLng(xr[1],xr[0]));Ln=new Ns(Cn,lt.style),lt.name&&(Ln.properties={name:lt.name},Ln.name=lt.name)}break}case"ElevationLine":{const lt=Kt.data;if(lt.points&&lt.points.length>0){const Cn=lt.points.map(xr=>Rt.latLng(xr[1],xr[0]));Ln=new Cf(Cn,lt.style),lt.name&&(Ln.properties={name:lt.name,type:"ElevationLine",elevationData:lt.elevationData,minElevation:lt.minElevation,maxElevation:lt.maxElevation,elevationGain:lt.elevationGain,elevationLoss:lt.elevationLoss,averageSlope:lt.averageSlope,maxSlope:lt.maxSlope},Ln.name=lt.name),lt.elevationData&&(Ln.elevationData=lt.elevationData)}break}case"Note":{console.log("[MapView][refreshMapWithPlan] Création d'une note:",Kt.data);const lt=Kt.data;if(lt.location&&Array.isArray(lt.location)&&lt.location.length===2)try{lt.category||(lt.category="forages",console.log("[MapView][refreshMapWithPlan] Catégorie par défaut ajoutée:",lt.category)),lt.accessLevel||(lt.accessLevel="private",console.log("[MapView][refreshMapWithPlan] Niveau d'accès par défaut ajouté:",lt.accessLevel));const Cn=Fp.fromBackendData(lt);Cn._dbId=Kt.id,Ln=Cn,console.log("[MapView][refreshMapWithPlan] Note créée:",{id:Kt.id,location:lt.location,name:lt.name,category:lt.category,accessLevel:lt.accessLevel,type:Cn.properties.type})}catch(Cn){console.error("[MapView][refreshMapWithPlan] Erreur lors de la création de la Note:",Cn)}else console.error("[MapView][refreshMapWithPlan] Données invalides pour Note:",lt);break}}Ln&&(Ln._dbId=Kt.id,(mr=D.value)==null||mr.addLayer(Ln),f.value.push({id:Kt.id,type:Kt.type_forme,layer:Ln,properties:Ln.properties}))},"MapView")})),await new Promise(Kt=>setTimeout(Kt,0))}});await Promise.all(Jn),hn.measure("refreshMapWithPlan:adjustView",()=>{I()},"MapView")},"MapView"),console.log(`Plan ${at} chargé avec succès avec ${s.getCurrentElements.length} formes`)):console.error(`Plan ${at} introuvable après chargement`),ge.value=!1}catch(We){throw console.error("Erreur lors du rafraîchissement de la carte:",We),We}},"MapView")}async function Ge(at){return await hn.measureAsync("loadPlan",async()=>{var We;console.log(`
[MapView][loadPlan] ====== DÉBUT CHARGEMENT PLAN ======`),console.log("[MapView][loadPlan] Tentative de chargement du plan:",at);try{const It=await hn.measureAsync("loadPlan:getPlanFromStore",async()=>i.getPlanById(at),"MapView");if(console.log("[MapView][loadPlan] Plan trouvé dans le store:",!!It),!It){console.log("[MapView][loadPlan] Plan non trouvé dans le store, vérification API...");try{await hn.measureAsync("loadPlan:apiCheck",async()=>{await Rn.get(`/plans/${at}/`)},"MapView")}catch(En){throw((We=En.response)==null?void 0:We.status)===404&&(console.warn("[MapView][loadPlan] Plan non trouvé - Nettoyage du localStorage"),localStorage.removeItem("lastPlanId"),U.value=null,i.clearCurrentPlan(),s.clearCurrentPlan(),ke()),En}}console.log("[MapView][loadPlan] Rafraîchissement de la carte..."),await hn.measureAsync("loadPlan:refreshMap",async()=>{await Pe(at)},"MapView"),ge.value=!1,console.log("[MapView][loadPlan] Invalidation de la taille de la carte..."),jt(),console.log("[MapView][loadPlan] Plan chargé avec succès:",{planId:at,elementsCount:s.getCurrentElements.length})}catch(It){throw console.error("Erreur lors du chargement du plan:",It),hn.measure("loadPlan:errorRecovery",()=>{U.value=null,i.clearCurrentPlan(),s.clearCurrentPlan(),ke(),localStorage.removeItem("lastPlanId")},"MapView"),It}},"MapView")}async function K(){var at;if(!U.value||!D.value){console.warn("Aucun plan actif ou groupe de formes à sauvegarder");return}F.value=!0,B.value="saving";try{const We=[],It=new Set(s.getCurrentElements.filter(qt=>qt.id!==void 0).map(qt=>qt.id)),En=new Set;console.log("[savePlan] Début de la sauvegarde",{featureGroupLayers:D.value.getLayers().length,existingIds:Array.from(It),currentElements:s.getCurrentElements}),D.value.eachLayer(qt=>{var Ln,mr,lt,Cn,xr,Ii,Fr,Pr,lr,Hr,ir,Or,jr,rn,ji,_i,gi,Kr,Br;console.log("[savePlan] Traitement de la couche",{type:(Ln=qt.properties)==null?void 0:Ln.type,name:(mr=qt.properties)==null?void 0:mr.name,isPolygon:qt instanceof Rt.Polygon,properties:qt.properties});let mn,Bt;const Kt={color:qt.options.color||"#2b6451",weight:qt.options.weight||3,opacity:qt.options.opacity||1,fillColor:qt.options.fillColor||"#2b6451",fillOpacity:qt.options.fillOpacity||.2,dashArray:qt.options.dashArray||""};if(qt instanceof pa){mn="Rectangle";const Rr=qt.getBounds();Bt={bounds:{southWest:[Rr.getSouthWest().lng,Rr.getSouthWest().lat],northEast:[Rr.getNorthEast().lng,Rr.getNorthEast().lat]},style:Kt,name:((lt=qt.properties)==null?void 0:lt.name)||"",rotation:qt.getRotation(),width:qt.getDimensions().width,height:qt.getDimensions().height,center:[qt.getCenter().lng,qt.getCenter().lat]}}else if(qt instanceof Rt.Circle)mn="Circle",Bt={center:[qt.getLatLng().lng,qt.getLatLng().lat],radius:qt.getRadius(),name:((Cn=qt.properties)==null?void 0:Cn.name)||"",style:Kt};else if(qt instanceof Rt.Rectangle){mn="Rectangle";const Rr=qt.getBounds();Bt={bounds:{southWest:[Rr.getSouthWest().lng,Rr.getSouthWest().lat],northEast:[Rr.getNorthEast().lng,Rr.getNorthEast().lat]},name:((xr=qt.properties)==null?void 0:xr.name)||"",style:Kt}}else if(qt instanceof Rt.Polyline&&!(qt instanceof Rt.Polygon))if(((Ii=qt.properties)==null?void 0:Ii.type)==="ElevationLine"){mn="ElevationLine";const Rr=qt.getLatLngs(),dr=((Fr=qt.properties)==null?void 0:Fr.category)||"forages",zi=((Pr=qt.properties)==null?void 0:Pr.accessLevel)||"visitor";console.log("[savePlan] ElevationLine - Catégorie:",dr,"Niveau d'accès:",zi),Bt={points:Rr.map(Ss=>[Ss.lng,Ss.lat]),style:{...Kt,color:((lr=qt.properties.style)==null?void 0:lr.color)||"#FF4500",weight:((Hr=qt.properties.style)==null?void 0:Hr.weight)||4,opacity:((ir=qt.properties.style)==null?void 0:ir.opacity)||.8,_accessLevel:zi,accessLevel:zi},name:((Or=qt.properties)==null?void 0:Or.name)||"",category:dr,accessLevel:zi,elevationData:qt.properties.elevationData,samplePointStyle:qt.properties.samplePointStyle,minMaxPointStyle:qt.properties.minMaxPointStyle,minElevation:qt.properties.minElevation,maxElevation:qt.properties.maxElevation,elevationGain:qt.properties.elevationGain,elevationLoss:qt.properties.elevationLoss,averageSlope:qt.properties.averageSlope,maxSlope:qt.properties.maxSlope}}else{mn="Line";const Rr=qt.getLatLngs(),dr=((jr=qt.properties)==null?void 0:jr.category)||"forages",zi=((rn=qt.properties)==null?void 0:rn.accessLevel)||"visitor";console.log("[savePlan] Line - Catégorie:",dr,"Niveau d'accès:",zi),Bt={points:Rr.map(Ss=>[Ss.lng,Ss.lat]),name:((ji=qt.properties)==null?void 0:ji.name)||"",category:dr,accessLevel:zi,style:{...Kt,_accessLevel:zi,accessLevel:zi}}}else if(qt instanceof Rt.Polygon&&!(qt instanceof Rt.Rectangle)){mn="Polygon";const Rr=qt.getLatLngs()[0],dr=((_i=qt.properties)==null?void 0:_i.category)||"forages",zi=((gi=qt.properties)==null?void 0:gi.accessLevel)||"visitor";console.log("[savePlan] Polygon - Catégorie:",dr,"Niveau d'accès:",zi),Bt={points:Rr.map(Ss=>[Ss.lng,Ss.lat]),name:((Kr=qt.properties)==null?void 0:Kr.name)||"",category:dr,accessLevel:zi,style:{...Kt,_accessLevel:zi,accessLevel:zi}}}else if(((Br=qt.properties)==null?void 0:Br.type)==="Note"){console.log("[savePlan] Traitement d'une GeoNote");const Rr=qt;if(Rr.toBackendFormat){Rr.properties.category||(Rr.properties.category="forages",console.log("[savePlan] Catégorie par défaut ajoutée:",Rr.properties.category)),Rr.properties.accessLevel||(Rr.properties.accessLevel="private",console.log("[savePlan] Niveau d'accès par défaut ajouté:",Rr.properties.accessLevel));const dr=Rr.toBackendFormat(Rr._dbId);mn=dr.type_forme,Bt=dr.data,Rr._dbId&&typeof Rr._dbId=="number"&&En.add(Rr._dbId),console.log("[savePlan] Données de la note préparées pour la sauvegarde:",{id:Rr._dbId,type:mn,category:Bt.category,accessLevel:Bt.accessLevel})}}if(mn&&Bt){let Rr=qt._elementId;qt._dbId&&(Rr=qt._dbId,typeof Rr=="number"&&En.add(Rr)),We.push({id:Rr,type_forme:mn,data:Bt})}}),console.log("[savePlan] Éléments à sauvegarder",{totalElements:We.length,elements:We.map(qt=>({type:qt.type_forme,hasPoints:"points"in qt.data,hasStyle:"style"in qt.data}))});const Jn=Array.from(It).filter(qt=>!En.has(qt));console.log("[savePlan] Éléments supprimés:",{existingIds:Array.from(It),currentLayerIds:Array.from(En),elementsToDelete:Jn}),s.elements=We.filter(qt=>!qt.id||!Jn.includes(qt.id));const Zn=await s.saveToPlan(U.value.id,{elementsToDelete:Jn});if(Zn&&((at=U.value)!=null&&at.id)){const qt=U.value.id;U.value={...U.value,...Zn},i.updatePlanDetails(qt,Zn)}B.value="success",D.value&&D.value.eachLayer(qt=>{var mn;((mn=qt.properties)==null?void 0:mn.type)==="Note"&&typeof qt.resetPlanSaveState=="function"&&qt.resetPlanSaveState()}),setTimeout(()=>{B.value=null},3e3)}catch(We){console.error("Erreur lors de la sauvegarde du plan:",We),B.value=null}finally{F.value=!1}}mc(()=>{R.user||Ze(),i.clearCurrentPlan(),s.clearCurrentPlan(),D.value&&D.value.off("note:edit"),window.removeEventListener("geonote:edit",()=>{}),window.removeEventListener("categoriesReactivated",()=>{}),window.removeEventListener("shapeTypesReactivated",()=>{}),window.removeEventListener("shape:created",()=>{}),window.removeEventListener("map-set-location",()=>{})});function de(at){if(console.log("[MapView][updateShapeProperties] Mise à jour des propriétés:",at),T(at),at.category&&g.value&&g.value._dbId){const We=g.value._dbId,It=s.elements.find(En=>En.id===We);if(It){console.log(`[MapView][updateShapeProperties] Mise à jour de la catégorie dans le store: ${at.category} pour l'élément ${We}`);const En=It;En.data||(En.data={}),En.data.category=at.category,s.$patch({unsavedChanges:!0})}}}function ye(at){try{const We=new Date(at);return isNaN(We.getTime())?(console.error("Date invalide reçue:",at),"Date invalide"):new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Paris"}).format(We)}catch(We){return console.error("Erreur lors du formatage de la date:",We),"Date invalide"}}const me=()=>{D.value&&I()},Ue=()=>{if(g.value&&D.value){const at=g.value._leaflet_id,We=g.value._dbId;_(""),D.value.removeLayer(g.value),f.value=f.value.filter(It=>It.layer&&It.layer._leaflet_id!==at),console.log(`[MapView][deleteSelectedShape] Forme ${at} (dbId: ${We}) supprimée du featureGroup et de shapes.value`),g.value=null}};async function Qe(at){console.log(`onPlanCreated - Tentative de chargement du plan ${at}`),await i.fetchPlans();const We=i.getPlanById(at);We?(console.log(`Plan ${at} trouvé, chargement en cours...`),localStorage.setItem("lastPlanId",at.toString()),U.value=We,i.setCurrentPlan(We),s.setCurrentPlan(We.id),le.value=!1,jt(),console.log(`Plan ${at} chargé avec succès`)):console.error(`Plan ${at} introuvable après création! Vérifiez les permissions.`)}Co(J,async at=>{var We;if(at&&((We=R.user)==null?void 0:We.user_type)==="admin"){De.value=!0;try{const It=await R.fetchSalarieVisiteurs(at.id);W.value=Array.isArray(It)?It:[It]}catch(It){console.error("[MapView][watch selectedSalarie] Error:",It),W.value=[]}finally{De.value=!1}}});function Ze(){localStorage.removeItem("lastPlanId")}function He(at,We="m"){return We==="m²"?`${(at/1e4).toFixed(2)} ha`:We==="m"?at>=1e3?`${(at/1e3).toFixed(2)} km`:`${at.toFixed(2)} m`:`${at.toFixed(2)} ${We}`}const Xe=Ft(!1);function tt(at){return{Circle:"Cercle",Rectangle:"Rectangle",Semicircle:"Demi-cercle",Line:"Ligne",Polygon:"Polygone",TextRectangle:"Annotation",ElevationLine:"Profil altimétrique"}[at]||at}async function Mt(){var We,It,En,Jn,Zn,qt,mn,Bt,Kt,Ln;if(!U.value||!y.value||!D.value){console.error("[generateSynthesis] Plan, map ou featureGroup manquant");return}const at=U.value;try{console.log("[generateSynthesis] Début de la génération"),console.log("[generateSynthesis] Plan courant complet:",at),await K();let Hr=at;if(!at.salarie_details&&!at.entreprise_details&&!at.client_details){console.log("[generateSynthesis] Détails manquants, tentative de récupération...");try{const dr=await Rn.get(`/plans/${at.id}/`);dr.status===200&&(console.log("[generateSynthesis] Plan mis à jour:",dr.data),U.value={...at,...dr.data},Hr=dr.data,i.updatePlanDetails(at.id,dr.data))}catch(dr){console.error("[generateSynthesis] Erreur lors de la récupération des détails:",dr)}}await new Promise(dr=>setTimeout(dr,1e3)),Xe.value=!0;const ir=Hr.salarie_details,Or=Hr.client_details,jr=(ir==null?void 0:ir.entreprise_details)||Hr.entreprise_details;console.log("[generateSynthesis] Détails du plan utilisé:",Hr),console.log("[generateSynthesis] Détails des utilisateurs:",{salarie:ir?{id:ir.id,nom:`${ir.first_name} ${ir.last_name}`,company:ir.company_name,logo:ir.logo}:null,entreprise:jr?{id:jr.id,nom:`${jr.first_name} ${jr.last_name}`,company:jr.company_name,logo:jr.logo}:null,client:Or?{id:Or.id,nom:`${Or.first_name} ${Or.last_name}`,company:Or.company_name}:null}),g.value&&(j(),g.value=null);const rn=new kr("l","mm","a4");console.log("[generateSynthesis] Chargement du logo de l'application");const ji=new Image;ji.src=ib,await new Promise(dr=>{ji.onload=()=>{console.log("[generateSynthesis] Logo application chargé"),dr()},ji.onerror=zi=>{console.error("[generateSynthesis] Erreur chargement logo application:",zi),dr()}}),console.log("[generateSynthesis] Tentative de chargement du logo entreprise:",jr==null?void 0:jr.logo);let _i=null;jr!=null&&jr.logo&&(_i=new Image,_i.src=jr.logo,await new Promise(dr=>{_i?(_i.onload=()=>{console.log("[generateSynthesis] Logo entreprise chargé avec succès"),dr()},_i.onerror=zi=>{console.error("[generateSynthesis] Erreur chargement logo entreprise:",zi),dr()}):dr()})),console.log("[generateSynthesis] Tentative de chargement du logo salarie:",ir==null?void 0:ir.logo);let gi=null;ir!=null&&ir.logo&&(gi=new Image,gi.src=ir.logo,await new Promise(dr=>{gi?(gi.onload=()=>{console.log("[generateSynthesis] Logo salarie chargé avec succès"),dr()},gi.onerror=zi=>{console.error("[generateSynthesis] Erreur chargement logo salarie:",zi),dr()}):dr()})),console.log("[generateSynthesis] Ajout des logos au PDF:",{logoApplication:!0,logoEntreprise:_i!==null,logoSalarie:gi!==null}),_i!==null&&rn.addImage(_i,"JPEG",148.5-40-30,20,40,40),rn.addImage(ji,"JPEG",148.5-40/2,20,40,40),gi!==null&&rn.addImage(gi,"JPEG",148.5+30,20,40,40),rn.setFontSize(24),rn.setTextColor(0),rn.text(at.nom||"Sans titre",297/2,100,{align:"center"});let Kr=120;if(jr&&(rn.setFontSize(14),rn.setFont("helvetica","bold"),rn.text("Entreprise:",20,Kr),rn.setFont("helvetica","normal"),rn.text(`${jr.first_name} ${jr.last_name}${jr.company_name?` (${jr.company_name})`:""}`,20,Kr+6),Kr+=15),ir&&(rn.setFontSize(14),rn.setFont("helvetica","bold"),rn.text("Salarie:",20,Kr),rn.setFont("helvetica","normal"),rn.text(`${ir.first_name} ${ir.last_name}${ir.company_name?` (${ir.company_name})`:""}`,20,Kr+6),Kr+=15),Or&&(rn.setFontSize(14),rn.setFont("helvetica","bold"),rn.text("Client:",20,Kr),rn.setFont("helvetica","normal"),rn.text(`${Or.first_name} ${Or.last_name}${Or.company_name?` (${Or.company_name})`:""}`,20,Kr+6),Kr+=15),at.description){rn.setFont("helvetica","bold"),rn.text("Description:",20,Kr),rn.setFont("helvetica","normal");const dr=rn.splitTextToSize(at.description,150);rn.text(dr,20,Kr+6),Kr+=8*dr.length+10}Kr=Math.min(Kr,180),rn.setFontSize(10),rn.setTextColor(100),rn.text(`Date de création: ${ye(at.date_creation)}`,20,190),rn.text(`Dernière modification: ${ye(at.date_modification)}`,277,190,{align:"right"});const Br=[];D.value.eachLayer(dr=>Br.push(dr));const Rr=Rt.simpleMapScreenshoter({hideElementsWithSelectors:[".leaflet-control-container",".leaflet-pm-toolbar",".leaflet-grid-layer",".leaflet-grid-label"],preventDownload:!0}).addTo(y.value);await new Promise(dr=>setTimeout(dr,3e3));for(let dr=0;dr<Br.length;dr++){rn.addPage(),rn.setFillColor(248,250,252),rn.setDrawColor(226,232,240),rn.rect(0,0,297,25,"F"),rn.setFontSize(10),rn.setTextColor(50,50,50),rn.setFont("helvetica","bold"),rn.text(at.nom||"Sans titre",20,12);let Cs=297-20-(15*(1+(_i!==null?1:0)+(gi!==null?1:0))+5*(1+(_i!==null?1:0)));_i!==null&&(rn.addImage(_i,"JPEG",Cs,5,15,15),Cs+=20),rn.addImage(ji,"JPEG",Cs,5,15,15),Cs+=20,gi!==null&&rn.addImage(gi,"JPEG",Cs,5,15,15),rn.setDrawColor(200,200,200),rn.setLineWidth(.5),rn.line(0,25,297,25);const si=Br[dr],jn=si.properties;if(jn){rn.setTextColor(0),rn.setFontSize(14),rn.setFont("helvetica","bold");const Po=jn.name||tt(jn.type);let ci="";if(jn.type!=="TextRectangle"){const qn=Z(Br,si);ci=qn>0?` (surface totale d'irrigation : ${He(qn,"m²")})`:""}const hr=`${Po}${ci}`;rn.text(hr,20,35)}if(jn&&jn.type==="ElevationLine")try{const Po=((We=si.getBounds)==null?void 0:We.call(si))||((It=si.getLatLng)==null?void 0:It.call(si));Po&&y.value.fitBounds(Po instanceof Rt.LatLng?Rt.latLngBounds([Po]):Po,{padding:[50,50]});try{const _n=((En=si.getBounds)==null?void 0:En.call(si))||((Jn=si.getLatLng)==null?void 0:Jn.call(si));if(!_n||!y.value)console.warn("[generateSynthesis] Bounds ou carte invalide");else{const tn=_n instanceof Rt.LatLng?Rt.latLngBounds([_n]):_n;tn&&tn.isValid&&tn.isValid()&&y.value.getContainer()&&document.body.contains(y.value.getContainer())&&y.value.fitBounds(tn,{padding:[50,50],animate:!1})}}catch(_n){console.warn("[generateSynthesis] Erreur lors de l'ajustement de la vue:",_n)}await new Promise(_n=>setTimeout(_n,2e3)),y.value.invalidateSize();try{y.value&&y.value.getContainer()&&document.body.contains(y.value.getContainer())?y.value.invalidateSize({animate:!1}):console.warn("[generateSynthesis] Carte non valide pour l'invalidation de taille")}catch(_n){console.warn("[generateSynthesis] Erreur lors de l'invalidation de la taille de la carte:",_n)}await new Promise(_n=>{const tn=()=>{var Mi;const ai=(Mi=y.value)==null?void 0:Mi.getContainer();if(!ai){_n();return}const fo=ai.querySelectorAll(".leaflet-tile-loaded");ai.querySelectorAll(".leaflet-tile-loading").length===0&&fo.length>0?_n():setTimeout(tn,100)};tn()});const ci=await Rr.takeScreen("image"),hr=await new Promise((_n,tn)=>{const ai=new Image;ai.onload=()=>_n(ai),ai.onerror=fo=>tn(fo),ai.src=ci}),qn=40,bo=237/2,wo=Math.min(70,hr.height*bo/hr.width);if(rn.addImage(hr,"PNG",20,qn,bo,wo),jn.elevationData&&jn.elevationData.length>0){const _n=document.createElement("canvas");_n.width=800,_n.height=400;const tn=_n.getContext("2d");if(tn){const ai=jn.elevationData,fo=jn.minElevation,xo=jn.maxElevation,fs=(xo-fo)*.05,Qo=fo-fs,Ro=xo+fs,di=40,Is=_n.width-2*di,Fo=_n.height-2*di,eo=Jr=>di+Jr/ai[ai.length-1].distance*Is,Lo=Jr=>di+Fo-(Jr-Qo)/(Ro-Qo)*Fo;tn.fillStyle="#f8fafc",tn.fillRect(0,0,_n.width,_n.height),tn.fillStyle="#334155",tn.font="bold 20px Arial",tn.textAlign="center",tn.fillText("Profil altimétrique",_n.width/2,25),tn.strokeStyle="#e2e8f0",tn.lineWidth=1,tn.beginPath(),tn.moveTo(di,di),tn.lineTo(di,Fo+di),tn.lineTo(Is+di,Fo+di),tn.strokeStyle="#94a3b8",tn.stroke();const Vs=5;for(let Jr=0;Jr<=Vs;Jr++){const Nr=Qo+Jr/Vs*(Ro-Qo),jo=Lo(Nr);tn.beginPath(),tn.strokeStyle="#e2e8f0",tn.moveTo(di,jo),tn.lineTo(Is+di,jo),tn.stroke(),tn.beginPath(),tn.strokeStyle="#94a3b8",tn.moveTo(di-5,jo),tn.lineTo(di,jo),tn.stroke(),tn.fillStyle="#64748b",tn.font="12px Arial",tn.textAlign="right",tn.fillText(`${Math.round(Nr)}m`,di-8,jo+4)}const va=5,to=ai[ai.length-1].distance;for(let Jr=0;Jr<=va;Jr++){const Nr=Jr/va*to,jo=eo(Nr);tn.beginPath(),tn.strokeStyle="#e2e8f0",tn.moveTo(jo,di),tn.lineTo(jo,Fo+di),tn.stroke(),tn.beginPath(),tn.strokeStyle="#94a3b8",tn.moveTo(jo,Fo+di),tn.lineTo(jo,Fo+di+5),tn.stroke(),tn.fillStyle="#64748b",tn.font="12px Arial",tn.textAlign="center",tn.fillText(`${Math.round(Nr)}m`,jo,Fo+di+16)}const il=tn.createLinearGradient(0,di,0,Fo+di);il.addColorStop(0,"rgba(255, 69, 0, 0.8)"),il.addColorStop(1,"rgba(255, 69, 0, 0.2)"),tn.beginPath(),tn.moveTo(eo(ai[0].distance),Lo(ai[0].elevation)),ai.forEach((Jr,Nr)=>{Nr>0&&tn.lineTo(eo(Jr.distance),Lo(Jr.elevation))}),tn.strokeStyle="#FF4500",tn.lineWidth=2,tn.stroke(),tn.lineTo(eo(ai[ai.length-1].distance),Lo(Qo)),tn.lineTo(eo(ai[0].distance),Lo(Qo)),tn.closePath(),tn.fillStyle=il,tn.fill(),ai.forEach(Jr=>{tn.beginPath(),tn.arc(eo(Jr.distance),Lo(Jr.elevation),3,0,Math.PI*2),tn.fillStyle="#FF4500",tn.fill(),tn.strokeStyle="white",tn.lineWidth=1,tn.stroke()});let ya=0,gr=0;for(let Jr=0;Jr<ai.length;Jr++)ai[Jr].elevation===fo&&(ya=Jr),ai[Jr].elevation===xo&&(gr=Jr);tn.beginPath(),tn.arc(eo(ai[gr].distance),Lo(ai[gr].elevation),6,0,Math.PI*2),tn.fillStyle="#059669",tn.fill(),tn.strokeStyle="white",tn.lineWidth=2,tn.stroke(),tn.beginPath(),tn.arc(eo(ai[ya].distance),Lo(ai[ya].elevation),6,0,Math.PI*2),tn.fillStyle="#DC2626",tn.fill(),tn.strokeStyle="white",tn.lineWidth=2,tn.stroke(),tn.font="12px Arial",tn.fillStyle="#059669",tn.textAlign="left",tn.fillText(`Point haut: ${He(xo,"m")}`,di,Fo+di+35),tn.fillStyle="#DC2626",tn.fillText(`Point bas: ${He(fo,"m")}`,di+200,Fo+di+35);const br=_n.toDataURL("image/png");rn.addImage(br,"PNG",20+bo+20,qn,bo,wo)}}const Lr=qn+wo+15;rn.setFillColor(248,250,252),rn.setDrawColor(226,232,240),rn.roundedRect(20,Lr,257,50,3,3,"FD"),rn.setFont("helvetica","bold"),rn.setFontSize(12),rn.setTextColor(51,65,85),rn.text("Caractéristiques",30,Lr+10);const Us=[{label:"Distance totale",value:He(jn.length||0)},{label:"Dénivelé positif",value:He(jn.elevationGain||0,"m")},{label:"Dénivelé négatif",value:He(jn.elevationLoss||0,"m")}],Gn=[{label:"Pente moyenne",value:`${(jn.averageSlope||0).toFixed(1)}%`},{label:"Pente maximale",value:`${(jn.maxSlope||0).toFixed(1)}%`},{label:"Altitude min/max",value:`${He(jn.minElevation||0,"m")} / ${He(jn.maxElevation||0,"m")}`}];let _r=Lr+20;rn.setFont("helvetica","normal"),rn.setFontSize(10),Us.forEach(_n=>{rn.setTextColor(100,116,139),rn.text(_n.label,30,_r),rn.setTextColor(15,23,42),rn.setFont("helvetica","bold"),rn.text(_n.value,110,_r),rn.setFont("helvetica","normal"),_r+=9}),_r=Lr+20;const Yr=297/2;Gn.forEach(_n=>{rn.setTextColor(100,116,139),rn.text(_n.label,Yr,_r),rn.setTextColor(15,23,42),rn.setFont("helvetica","bold"),rn.text(_n.value,Yr+80,_r),rn.setFont("helvetica","normal"),_r+=9})}catch(Po){console.error("[generateSynthesis] Erreur traitement profil altimétrique:",Po)}else{const Po=((Zn=si.getBounds)==null?void 0:Zn.call(si))||((qt=si.getLatLng)==null?void 0:qt.call(si));Po&&y.value.fitBounds(Po instanceof Rt.LatLng?Rt.latLngBounds([Po]):Po,{padding:[50,50]});try{const ci=((mn=si.getBounds)==null?void 0:mn.call(si))||((Bt=si.getLatLng)==null?void 0:Bt.call(si));if(!ci||!y.value)console.warn("[generateSynthesis] Bounds ou carte invalide");else{const hr=ci instanceof Rt.LatLng?Rt.latLngBounds([ci]):ci;hr&&hr.isValid&&hr.isValid()&&y.value.getContainer()&&document.body.contains(y.value.getContainer())&&y.value.fitBounds(hr,{padding:[50,50],animate:!1})}}catch(ci){console.warn("[generateSynthesis] Erreur lors de l'ajustement de la vue:",ci)}await new Promise(ci=>setTimeout(ci,2e3)),y.value.invalidateSize(),await new Promise(ci=>{const hr=()=>{var Lr;const qn=(Lr=y.value)==null?void 0:Lr.getContainer();if(!qn){ci();return}const bo=qn.querySelectorAll(".leaflet-tile-loaded");qn.querySelectorAll(".leaflet-tile-loading").length===0&&bo.length>0?ci():setTimeout(hr,100)};hr()});try{const ci=await Rr.takeScreen("image"),hr=await new Promise((Lr,Us)=>{const Gn=new Image;Gn.onload=()=>Lr(Gn),Gn.onerror=_r=>Us(_r),Gn.src=ci}),qn=45,bo=297*.6-30;let wo=hr.height*bo/hr.width;if(wo>210*.9&&(wo=210*.9),rn.addImage(hr,"PNG",20,qn,bo,wo),jn){let Lr=function(tn,ai,fo,xo,Mi){rn.setTextColor(100,116,139),rn.setFont("helvetica","normal"),rn.text(tn,fo+10,xo),rn.setTextColor(15,23,42),rn.setFont("helvetica","bold"),rn.text(ai,fo+Mi-10,xo,{align:"right"})},Gn=0;if(jn.type==="Circle")Gn=4;else if(jn.type==="Rectangle")Gn=4;else if(jn.type==="Line")Gn=1,(Kt=jn.dimensions)!=null&&Kt.width&&Gn++,jn.surfaceInfluence&&Gn++;else if(jn.type==="Semicircle")Gn=6;else if(jn.type==="Polygon")Gn=2;else if(jn.type==="CircleWithSections"&&(Gn=3,jn.sections&&jn.sections.length>0)){const tn=Math.ceil(jn.sections.length/3);Gn+=tn*3}const _r=Math.max(15+Gn*12+30,60),Yr=297-188.2-20;rn.setFillColor(248,250,252),rn.setDrawColor(226,232,240),rn.roundedRect(188.2,qn,Yr,_r,3,3,"FD"),rn.setFont("helvetica","bold"),rn.setFontSize(12),rn.setTextColor(51,65,85),rn.text("Caractéristiques",188.2+10,qn+15);let _n=qn+30;rn.setFontSize(10),jn.type==="Circle"?(Lr("Rayon",He(jn.radius),188.2,_n,Yr),_n+=12,Lr("Diamètre",He(jn.radius*2),188.2,_n,Yr),_n+=12,Lr("Surface",He(jn.surface,"m²"),188.2,_n,Yr),_n+=12,Lr("Périmètre",He(jn.perimeter),188.2,_n,Yr)):jn.type==="Rectangle"?(Lr("Largeur",He(jn.width),188.2,_n,Yr),_n+=12,Lr("Hauteur",He(jn.height),188.2,_n,Yr),_n+=12,Lr("Surface",He(jn.surface,"m²"),188.2,_n,Yr),_n+=12,Lr("Périmètre",He(jn.perimeter),188.2,_n,Yr)):jn.type==="Line"?(Lr("Longueur",He(jn.length),188.2,_n,Yr),_n+=12,(Ln=jn.dimensions)!=null&&Ln.width&&(Lr("Largeur d'influence",He(jn.dimensions.width),188.2,_n,Yr),_n+=12),jn.surfaceInfluence&&Lr("Surface d'influence",He(jn.surfaceInfluence,"m²"),188.2,_n,Yr)):jn.type==="Semicircle"?(Lr("Rayon",He(jn.radius),188.2,_n,Yr),_n+=12,Lr("Diamètre",He(jn.radius*2),188.2,_n,Yr),_n+=12,Lr("Surface",He(jn.surface,"m²"),188.2,_n,Yr),_n+=12,Lr("Périmètre",He(jn.perimeter),188.2,_n,Yr),_n+=12,Lr("Longueur d'arc",He(jn.arcLength),188.2,_n,Yr),_n+=12,Lr("Angle d'ouverture",`${jn.openingAngle.toFixed(1)}°`,188.2,_n,Yr)):jn.type==="Polygon"?(Lr("Surface",He(jn.surface,"m²"),188.2,_n,Yr),_n+=12,Lr("Périmètre",He(jn.perimeter),188.2,_n,Yr)):jn.type==="CircleWithSections"&&(Lr("Rayon",He(jn.radius),188.2,_n,Yr),_n+=12,Lr("Surface totale",He(jn.surface,"m²"),188.2,_n,Yr),_n+=12,Lr("Périmètre",He(jn.perimeter),188.2,_n,Yr),_n+=20,jn.sections&&jn.sections.length>0&&(_n=yr(jn.sections,rn,188.2,_n,Yr)))}}catch(ci){console.error(`[generateSynthesis] Erreur capture forme ${dr+1}:`,ci)}}}y.value.removeControl(Rr),rn.save(`synthese_${at.nom}.pdf`)}catch(mr){console.error("[generateSynthesis] Erreur:",mr),alert("Une erreur est survenue lors de la génération de la synthèse. Veuillez réessayer.")}finally{Xe.value=!1}}const Lt=hx.debounce(()=>{const at=hn.startMeasure("invalidateMapSize","MapView");if(!y.value){at();return}Xs(()=>{hn.measure("invalidateMapSize:nextTick",()=>{var We;try{if(y.value&&y.value.getContainer()&&document.body.contains(y.value.getContainer())){if(y.value.invalidateSize({animate:!1}),(We=D.value)!=null&&We.getLayers().length)try{I()}catch(It){console.warn("[invalidateMapSize] Erreur lors de l'ajustement de la vue:",It)}}else console.warn("[invalidateMapSize] Carte non valide pour l'invalidation")}catch(It){console.warn("[invalidateMapSize] Erreur lors de l'invalidation de la taille de la carte:",It)}at()},"MapView")})},250);function jt(){Lt()}Co(U,(at,We)=>{at&&at.id!==(We==null?void 0:We.id)&&Xs(()=>{jt()})});const zt=Ft(null),sn=Ft(!1),pn=Ft([]),et=cr(()=>{if(console.log("[MapView][filteredSalaries] Computing with:",{selectedEntreprise:zt.value,salaries:$.value,salariesLength:$.value.length}),!zt.value)return[];const at=$.value.filter(We=>{var Jn,Zn,qt;const It=We.entreprise,En=typeof It=="object"&&It!==null?It.id:It;return console.log("[MapView][filteredSalaries] Checking salarie:",{salarie:We,salarieEntreprise:It,salarieEntrepriseId:En,selectedEntrepriseId:(Jn=zt.value)==null?void 0:Jn.id,matches:En===((Zn=zt.value)==null?void 0:Zn.id)}),En===((qt=zt.value)==null?void 0:qt.id)});return console.log("[MapView][filteredSalaries] Filtered result:",at),at});function ot(at){if(!at)return"";const We=at.first_name||"",It=at.last_name?at.last_name.toUpperCase():"",En=at.company_name||at.role||"";return`${We} ${It} (${En})`}async function rt(){sn.value=!0;try{const at=await Rn.get("/users/",{params:{role:"ENTREPRISE"}});pn.value=at.data}catch(at){console.error("[MapView] Error loading entreprises:",at),pn.value=[]}finally{sn.value=!1}}async function Ht(at){console.log("[MapView][selectEntreprise] Sélection de l'entreprise:",at),zt.value=at,Le.value=!0;try{console.log("[MapView][selectEntreprise] Envoi de la requête avec params:",{role:"SALARIE",entreprise:at.id});const We=await Rn.get("/users/",{params:{role:"SALARIE",entreprise:at.id}});console.log("[MapView][selectEntreprise] Réponse reçue:",We.data),$.value=We.data,console.log("[MapView][selectEntreprise] Salaries mis à jour:",$.value)}catch(We){console.error("[MapView] Error loading salaries for entreprise:",We),$.value=[]}finally{Le.value=!1}}function Qt(){zt.value=null,J.value=null,pe.value=null,$.value=[],W.value=[],G.value=[]}function On(){J.value=null,pe.value=null,W.value=[],G.value=[]}function wn(){pe.value=null,G.value=[]}async function Tn(at){var We,It,En,Jn,Zn,qt;console.log(`
[MapView][selectSalarie] ====== DÉBUT SÉLECTION SALARIE ======`),console.log("Informations du salarie:",{id:at.id,username:at.username,company:at.company_name,role:at.role}),console.log("Contexte utilisateur:",{userType:(We=R.user)==null?void 0:We.user_type,userId:(It=R.user)==null?void 0:It.id,userRole:(En=R.user)==null?void 0:En.role,selectedEntrepriseId:(Jn=zt.value)==null?void 0:Jn.id}),J.value=at,De.value=!0;try{const mn={role:"VISITEUR",salarie:at.id};R.isEntreprise?(console.log("Ajout de l'ID de l'entreprise connectée:",(Zn=R.user)==null?void 0:Zn.id),mn.entreprise=(qt=R.user)==null?void 0:qt.id):zt.value&&(console.log("Ajout de l'ID de l'entreprise sélectionnée:",zt.value.id),mn.entreprise=zt.value.id),console.log("Paramètres de la requête:",mn);const Bt=await Rn.get("/users/",{params:mn});console.log("Réponse reçue du serveur:",{status:Bt.status,dataLength:Array.isArray(Bt.data)?Bt.data.length:"non-array",data:Bt.data}),Array.isArray(Bt.data)?(W.value=Bt.data,console.log(`${Bt.data.length} visiteurs chargés`),Bt.data.forEach((Kt,Ln)=>{console.log(`Visiteur ${Ln+1}:`,{id:Kt.id,username:Kt.username,company:Kt.company_name,salarie:Kt.salarie})})):(console.warn("Format de réponse inattendu:",Bt.data),W.value=[]),W.value.length===0&&console.warn("Aucun visiteur trouvé pour ce salarie")}catch(mn){if(console.error("ERREUR lors du chargement des visiteurs:",mn),mn&&typeof mn=="object"&&"response"in mn){const Bt=mn;console.error("Détails de l'erreur:",{status:Bt.response.status,data:Bt.response.data})}W.value=[]}finally{De.value=!1,console.log(`[MapView][selectSalarie] ====== FIN SÉLECTION SALARIE ======
`)}}function ar(){H.value=!1,Q.value=null}function xn(at){console.log("[MapView][handleFilterChange] Nouveaux filtres reçus:",JSON.stringify(at,null,2)),console.log("[MapView][handleFilterChange] Filtres actuels dans le store:",JSON.stringify({accessLevels:{...s.filters.accessLevels},categories:{...s.filters.categories},shapeTypes:{...s.filters.shapeTypes}},null,2)),console.log("[MapView][handleFilterChange] Mise à jour des filtres dans le store"),s.updateFilters(at),console.log("[MapView][handleFilterChange] Éléments dans le store:",{count:s.elements.length,ids:s.elements.map(We=>We.id)}),console.log("[MapView][handleFilterChange] Mise à jour de l'affichage de la carte"),Mn(),setTimeout(()=>{console.log("[MapView][handleFilterChange] Mise à jour forcée de l'affichage"),Mn()},100),console.log("[MapView][handleFilterChange] Traitement des filtres terminé")}function Mn(){if(!D.value)return;const at={accessLevels:{...s.filters.accessLevels},categories:{...s.filters.categories},shapeTypes:{...s.filters.shapeTypes}};console.log("[MapView][updateMapDisplay] Mise à jour de l'affichage avec filtres:",JSON.stringify(at,null,2));const We={count:s.elements.length,elements:s.elements.map(lt=>({id:lt.id,type_forme:lt.type_forme}))};console.log("[MapView][updateMapDisplay] Éléments dans le store:",JSON.stringify(We,null,2));const It=s.getFilteredElements;console.log("[MapView][updateMapDisplay] Éléments filtrés:",{total:s.elements.length,filtered:It.length,filteredIds:It.map(lt=>lt.id)});const En=D.value.getLayers();console.log("[MapView][updateMapDisplay] Couches actuelles:",En.length);const Jn=En.map(lt=>({_leaflet_id:lt._leaflet_id,_dbId:lt._dbId,hasProperties:!!lt.properties,propertyType:lt.properties?lt.properties.type:null,category:lt.properties?lt.properties.category:null}));console.log("[MapView][updateMapDisplay] Détails des couches:",JSON.stringify(Jn,null,2)),console.log("[MapView][updateMapDisplay] État des filtres pour les catégories:",{forages:s.filters.categories.forages,clients:s.filters.categories.clients,entrepots:s.filters.categories.entrepots,livraisons:s.filters.categories.livraisons,cultures:s.filters.categories.cultures,parcelles:s.filters.categories.parcelles});const Zn=new Map;f.value.forEach(lt=>{lt.layer&&lt.id&&Zn.set(lt.id,lt.layer)});const qt=new Map;En.forEach(lt=>{lt._dbId&&qt.set(lt,lt._dbId)});const mn=new Set(It.map(lt=>lt.id));console.log("[MapView][updateMapDisplay] Début du traitement des couches");const Bt=Array.from(mn);console.log("[MapView][updateMapDisplay] IDs des éléments filtrés:",JSON.stringify(Bt));let Kt=0,Ln=0,mr=0;En.forEach(lt=>{var _i,gi;const Cn=lt._dbId,xr=lt._leaflet_id;if(!Cn){if(!lt.properties){mr++,console.log(`[MapView][updateMapDisplay] Couche ${xr} sans dbId et sans propriétés, ignorée`);return}lt._dbId=Date.now()+Math.floor(Math.random()*1e3),console.log(`[MapView][updateMapDisplay] Couche ${xr} sans dbId, ID temporaire assigné: ${lt._dbId}`)}const Ii=lt.properties||{},Fr=Ii.type||lt.type_forme||"";let Pr=Ii.category;if(lt._dbId){const Kr=s.elements.find(Br=>Br.id===lt._dbId);if(Kr){const Br=Kr.data;Br&&Br.category&&(Pr!==Br.category&&(console.log(`[MapView][updateMapDisplay] Catégorie différente détectée - Propriétés: ${Pr}, Store: ${Br.category} pour la couche ${lt._dbId}`),Pr=Br.category),lt.properties||(lt.properties={}),lt.properties.category=Pr)}}Pr||(Pr="default");const lr=Ii.accessLevel||"visitor";console.log(`[MapView][updateMapDisplay] Couche ${xr} (dbId: ${lt._dbId}): type=${Fr}, category=${Pr}, accessLevel=${lr}`),console.log("[MapView][updateMapDisplay] Filtres actuels:",JSON.stringify(s.filters));let Hr=!1;Fr?Hr=Fr in s.filters.shapeTypes&&s.filters.shapeTypes[Fr]===!0:Hr=s.filters.shapeTypes.Polygon===!0;let ir=!1;Pr?Pr in s.filters.categories?(ir=s.filters.categories[Pr]===!0,console.log(`[MapView][updateMapDisplay] Vérification de la catégorie ${Pr}: ${ir}`)):(ir=s.filters.categories.forages===!0,console.log(`[MapView][updateMapDisplay] Catégorie ${Pr} non trouvée dans les filtres, utilisation de 'forages': ${ir}`)):(ir=s.filters.categories.forages===!0,console.log(`[MapView][updateMapDisplay] Catégorie non spécifiée, utilisation de 'forages': ${ir}`));let Or=!1;const jr={company:s.filters.accessLevels.company===!0,employee:s.filters.accessLevels.employee===!0,visitor:s.filters.accessLevels.visitor===!0};let rn="visitor";jr.company?rn="company":jr.employee?rn="employee":jr.visitor&&(rn="visitor"),console.log(`[MapView][updateMapDisplay] Niveau d'accès sélectionné par l'utilisateur: ${rn}`),rn==="company"?Or=!0:rn==="employee"?Or=lr==="employee"||lr==="visitor":rn==="visitor"&&(Or=lr==="visitor"),console.log(`[MapView][updateMapDisplay] Niveau d'accès de la couche: ${lr}, visible: ${Or}`);const ji=Hr&&ir&&Or;console.log(`[MapView][updateMapDisplay] Visibilité de la couche ${xr}: typeVisible=${Hr}, categoryVisible=${ir}, accessLevelVisible=${Or}, isVisible=${ji}`),console.log(`[MapView][updateMapDisplay] Détails de la couche ${xr}: type=${Fr}, category=${Pr}, accessLevel=${lr}`),console.log("[MapView][updateMapDisplay] Filtres actuels:",JSON.stringify({accessLevels:s.filters.accessLevels,categories:s.filters.categories,shapeTypes:s.filters.shapeTypes},null,2)),ji?D.value.hasLayer(lt)?(Kt++,console.log(`[MapView][updateMapDisplay] Couche ${lt._dbId} (${Fr}) déjà visible avec catégorie ${((gi=lt.properties)==null?void 0:gi.category)||"non définie"}`)):(Pr&&Pr!=="default"&&(!lt.properties||!lt.properties.category)&&(lt.properties||(lt.properties={}),lt.properties.category=Pr,console.log(`[MapView][updateMapDisplay] Catégorie définie avant ajout: ${Pr} pour la couche ${lt._dbId}`)),D.value.addLayer(lt),Kt++,console.log(`[MapView][updateMapDisplay] Affichage de la couche ${lt._dbId} (${Fr}) avec catégorie ${((_i=lt.properties)==null?void 0:_i.category)||"non définie"}`)):D.value.hasLayer(lt)?(D.value.removeLayer(lt),Ln++,console.log(`[MapView][updateMapDisplay] Masquage de la couche ${lt._dbId} (${Fr}) - Filtres non respectés`)):(Ln++,console.log(`[MapView][updateMapDisplay] Couche ${lt._dbId} (${Fr}) déjà masquée`))}),console.log("[MapView][updateMapDisplay] Début de la restauration des couches filtrées"),console.log("[MapView][updateMapDisplay] Nombre de formes dans shapes.value:",f.value.length),f.value.forEach(lt=>{var gi;if(!lt.layer){console.log("[MapView][updateMapDisplay] Forme sans couche, ignorée");return}const Cn=lt.layer,xr=Cn._leaflet_id,Ii=Cn._dbId;if(console.log(`[MapView][updateMapDisplay] Traitement de la forme ${xr} (dbId: ${Ii})`),D.value.hasLayer(Cn)){console.log(`[MapView][updateMapDisplay] La couche ${xr} est déjà dans le featureGroup, ignorée`);return}const Fr=Cn.properties||{},Pr=Fr.type||Cn.type_forme||"";let lr=null;if(Cn._dbId){const Kr=s.elements.find(Br=>Br.id===Cn._dbId);if(Kr){const Br=Kr.data;Br&&Br.category&&(lr=Br.category,console.log(`[MapView][updateMapDisplay] Catégorie récupérée depuis le store: ${lr} pour la couche ${Cn._dbId}`))}}!lr&&Fr.category&&(lr=Fr.category,console.log(`[MapView][updateMapDisplay] Catégorie récupérée depuis les propriétés: ${lr} pour la couche ${xr}`)),lr||(lr="default");const Hr=Fr.accessLevel||"visitor";if(Cn.properties||(Cn.properties={}),lr&&lr!=="default"&&(Cn.properties.category=lr,console.log(`[MapView][updateMapDisplay] Catégorie définie/restaurée: ${lr} pour la couche ${Cn._dbId}`),Cn._dbId)){const Kr=s.elements.find(Br=>Br.id===Cn._dbId);if(Kr){const Br=Kr;Br.data||(Br.data={}),Br.data.category!==lr&&(console.log(`[MapView][updateMapDisplay] Mise à jour de la catégorie dans le store: ${lr} pour l'élément ${Cn._dbId}`),Br.data.category=lr,s.$patch({unsavedChanges:!0}))}}Cn.properties.accessLevel||(Cn.properties.accessLevel="visitor"),console.log(`[MapView][updateMapDisplay] Propriétés de la couche ${xr}: type=${Pr}, category=${lr}, accessLevel=${Hr}`);let ir=!1;Pr?ir=Pr in s.filters.shapeTypes&&s.filters.shapeTypes[Pr]===!0:ir=s.filters.shapeTypes.Polygon===!0;let Or=!1;lr?lr in s.filters.categories?(Or=s.filters.categories[lr]===!0,console.log(`[MapView][updateMapDisplay] Vérification de la catégorie ${lr}: ${Or}`)):(Or=s.filters.categories.forages===!0,console.log(`[MapView][updateMapDisplay] Catégorie ${lr} non trouvée, utilisation de 'forages': ${Or}`)):(Or=s.filters.categories.forages===!0,console.log(`[MapView][updateMapDisplay] Pas de catégorie, utilisation de 'forages': ${Or}`));let jr=!1;const rn={company:s.filters.accessLevels.company===!0,employee:s.filters.accessLevels.employee===!0,visitor:s.filters.accessLevels.visitor===!0};let ji="visitor";rn.company?ji="company":rn.employee?ji="employee":rn.visitor&&(ji="visitor"),console.log(`[MapView][updateMapDisplay] Niveau d'accès sélectionné par l'utilisateur (2ème étape): ${ji}`),ji==="company"?jr=!0:ji==="employee"?jr=Hr==="employee"||Hr==="visitor":ji==="visitor"&&(jr=Hr==="visitor"),console.log(`[MapView][updateMapDisplay] Niveau d'accès de la couche (2ème étape): ${Hr}, visible: ${jr}`);const _i=ir&&Or&&jr;if(console.log(`[MapView][updateMapDisplay] Visibilité de la couche ${xr}: typeVisible=${ir}, categoryVisible=${Or}, accessLevelVisible=${jr}, isVisible=${_i}`),_i){if(lr&&lr!=="default"&&(Cn.properties||(Cn.properties={}),Cn.properties.category=lr,console.log(`[MapView][updateMapDisplay] Catégorie définie avant restauration: ${lr} pour la couche ${xr}`),Cn._dbId)){const Kr=s.elements.find(Br=>Br.id===Cn._dbId);if(Kr){const Br=Kr;Br.data||(Br.data={}),Br.data.category!==lr&&(console.log(`[MapView][updateMapDisplay] Mise à jour de la catégorie dans le store avant restauration: ${lr} pour l'élément ${Cn._dbId}`),Br.data.category=lr,s.$patch({unsavedChanges:!0}))}}D.value.addLayer(Cn),Kt++,console.log(`[MapView][updateMapDisplay] Restauration de la couche ${xr} (${Pr}) avec catégorie ${((gi=Cn.properties)==null?void 0:gi.category)||"non définie"} - Filtres respectés`)}else console.log(`[MapView][updateMapDisplay] La couche ${xr} (${Pr}) reste masquée - Filtres non respectés`)}),console.log(`[MapView][updateMapDisplay] Restauration terminée: ${Kt} couches visibles au total`),console.log(`[MapView][updateMapDisplay] Statistiques: ${Kt} couches visibles, ${Ln} couches masquées, ${mr} couches sans dbId`),console.log("[MapView][updateMapDisplay] Mise à jour terminée")}function Pn(at){if(D.value){const It=D.value.getLayers().find(En=>En._leaflet_id===at.id);It&&(It.properties.name=at.title,It.properties.description=at.description,It.properties.columnId=at.columnId,It.properties.accessLevel=at.accessLevel,It.properties.category||(It.properties.category="forages"),It.setNoteStyle({color:at.style.color,fillColor:at.style.fillColor,weight:at.style.weight,fillOpacity:at.style.fillOpacity,radius:at.style.radius}),It.closePopup(),It.unbindPopup(),It.bindPopup(It.createPopupContent()),console.log("[handleNoteSave] Note mise à jour:",{name:It.properties.name,category:It.properties.category,accessLevel:It.properties.accessLevel,columnId:It.properties.columnId}),o.notes.find(Jn=>Jn.id===at.id)?(o.updateNote(at.id,{title:at.title,description:at.description,columnId:at.columnId,accessLevel:at.accessLevel,style:at.style,updatedAt:new Date().toISOString()}),console.log("[handleNoteSave] Note mise à jour dans le store avec columnId:",at.columnId)):(o.addNote({title:at.title,description:at.description,location:[at.location[0],at.location[1]],columnId:at.columnId||"1",style:at.style,accessLevel:at.accessLevel}),console.log("[handleNoteSave] Note ajoutée au store avec columnId:",at.columnId||"1")))}u.success("Note enregistrée avec succès")}async function fr(at){var We;pe.value=at,N.value=!0;try{const It={visiteur:at.id};R.isEntreprise?It.entreprise=(We=R.user)==null?void 0:We.id:zt.value&&(It.entreprise=zt.value.id),J.value&&(It.salarie=J.value.id);const En=await Rn.get("/plans/",{params:It});G.value=En.data}catch(It){console.error("[MapView] Error loading client plans:",It),G.value=[]}finally{N.value=!1}}function yr(at,We,It,En,Jn){if(!at||at.length===0)return En;const Zn=[...at].sort((Cn,xr)=>(xr.surface||0)-(Cn.surface||0)),qt=Jn,mn=7,Bt=6,Kt=2,Ln=[{header:"Nom",width:.3,align:"left"},{header:"Surface",width:.2,align:"right"},{header:"Angles",width:.25,align:"right"},{header:"Rayon",width:.15,align:"right"},{header:"Type",width:.1,align:"center"}],mr=mn+Bt*Zn.length;We.setFillColor(248,250,252),We.setDrawColor(226,232,240),We.roundedRect(It,En,qt,mr+Kt*2,2,2,"FD"),We.setFillColor(241,245,249),We.rect(It+Kt,En+Kt,qt-Kt*2,mn,"F"),We.setFont("helvetica","bold"),We.setFontSize(7),We.setTextColor(51,65,85);let lt=It+Kt;return Ln.forEach(Cn=>{const xr=Cn.width*(qt-Kt*2);Cn.align==="right"?We.text(Cn.header,lt+xr-Kt,En+Kt+5,{align:"right"}):Cn.align==="center"?We.text(Cn.header,lt+xr/2,En+Kt+5,{align:"center"}):We.text(Cn.header,lt+Kt/2,En+Kt+5),lt+=xr}),We.setFont("helvetica","normal"),We.setFontSize(6.5),We.setTextColor(71,85,105),Zn.forEach((Cn,xr)=>{const Ii=En+mn+Kt+xr*Bt;xr%2===0&&(We.setFillColor(250,252,254),We.rect(It+Kt,Ii,qt-Kt*2,Bt,"F"));let Fr=It+Kt;const Pr=Cn.name||`Section ${xr+1}`;We.text(Pr,Fr+Kt/2,Ii+4),Fr+=Ln[0].width*(qt-Kt*2);const lr=He(Cn.surface||0,"m²");We.text(lr,Fr+Ln[1].width*(qt-Kt*2)-Kt,Ii+4,{align:"right"}),Fr+=Ln[1].width*(qt-Kt*2);const Hr=Cn.startAngle===0&&Cn.endAngle===360?"Complet":`${Cn.startAngle}°-${Cn.endAngle}°`;We.text(Hr,Fr+Ln[2].width*(qt-Kt*2)-Kt,Ii+4,{align:"right"}),Fr+=Ln[2].width*(qt-Kt*2);const ir=He(Cn.radius||0);We.text(ir,Fr+Ln[3].width*(qt-Kt*2)-Kt,Ii+4,{align:"right"}),Fr+=Ln[3].width*(qt-Kt*2);const Or=Cn.startAngle===0&&Cn.endAngle===360?"C":"P";We.text(Or,Fr+Ln[4].width*(qt-Kt*2)/2,Ii+4,{align:"center"})}),We.setDrawColor(226,232,240),We.setLineWidth(.05),We.line(It+Kt,En+mn+Kt,It+qt-Kt,En+mn+Kt),En+mr+Kt*2}return(at,We)=>{var It,En,Jn,Zn,qt,mn;return $e(),qe(Bn,null,[E("div",a9,[E("div",l9,[Xe.value?($e(),qe("div",u9,We[8]||(We[8]=[cc('<div class="bg-white/90 rounded-2xl p-8 max-w-md shadow-2xl border border-gray-100"><div class="flex flex-col items-center"><div class="relative w-24 h-24 mb-6"><div class="absolute inset-0 border-4 border-primary-200 rounded-full"></div><div class="absolute inset-0 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"></div><div class="absolute inset-2 border-2 border-primary-400/30 rounded-full animate-pulse"></div><div class="absolute inset-0 flex items-center justify-center"><svg class="w-8 h-8 text-primary-600 animate-bounce" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div></div><h3 class="text-xl font-semibold text-gray-900 mb-2"> Génération de la synthèse </h3><div class="space-y-2 text-center"><p class="text-primary-600 font-medium"> Capture des formes en cours... </p><p class="text-sm text-gray-500"> Nous optimisons la qualité de vos captures pour un rendu parfait </p></div></div></div>',1)]))):dn("",!0),U.value?dn("",!0):($e(),qe("div",c9,[E("div",f9,[We[11]||(We[11]=cc('<div class="relative w-48 h-48 mx-auto mb-12 rounded-full bg-gradient-to-br from-primary-100 to-primary-50 p-8 shadow-lg ring-4 ring-white"><img src="'+ib+'" alt="TagMap Logo" class="w-full h-full object-contain filter drop-shadow-md"><div class="absolute inset-0 rounded-full bg-gradient-to-t from-transparent to-white/10 pointer-events-none"></div></div><h1 class="text-3xl font-bold text-gray-900 mb-4">Bienvenue sur TagMap</h1><p class="text-gray-600 mb-8">Pour commencer à dessiner, vous devez d&#39;abord créer un nouveau plan ou charger un plan existant.</p>',3)),E("div",h9,[E("button",{onClick:We[0]||(We[0]=Bt=>le.value=!0),class:"w-full flex items-center justify-center px-4 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors duration-200"},We[9]||(We[9]=[E("svg",{class:"w-6 h-6 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),Pi(" Créer un nouveau plan ")])),E("button",{onClick:We[1]||(We[1]=Bt=>ge.value=!0),class:"w-full flex items-center justify-center px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors duration-200"},We[10]||(We[10]=[E("svg",{class:"w-6 h-6 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),Pi(" Charger un plan existant ")]))])])])),Fn(E("div",d9,[($e(),$a(kg,{to:"body"},[U.value&&!Xe.value?($e(),qe("div",p9,[hi(EB,{"last-save":(It=U.value)!=null&&It.date_modification?new Date(U.value.date_modification):void 0,"plan-name":(En=U.value)==null?void 0:En.nom,"plan-description":(Jn=U.value)==null?void 0:Jn.description,"save-status":B.value,onChangeMapType:Wn(ue),onCreateNewPlan:We[2]||(We[2]=Bt=>le.value=!0),onLoadPlan:We[3]||(We[3]=Bt=>ge.value=!0),onSavePlan:K,onAdjustView:me,onGenerateSummary:Mt},null,8,["last-save","plan-name","plan-description","save-status","onChangeMapType"])])):dn("",!0)])),E("div",g9,[r.value&&U.value&&!Xe.value?($e(),qe("div",{key:0,onClick:ae,class:"md:hidden fixed inset-0 bg-black/30 z-[1999] transition-opacity duration-300"})):dn("",!0),U.value&&!Xe.value?($e(),qe("div",{key:1,onClick:ae,class:"md:hidden fixed left-0 right-0 z-[2500] bg-white py-3 px-3 shadow-lg border-t border-gray-200 flex items-center justify-between",style:{height:"var(--mobile-bottom-toolbar-height)",bottom:"0"}},We[12]||(We[12]=[cc('<div class="flex items-center w-full justify-center"><div class="flex items-center space-x-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"></path></svg><span class="text-sm text-gray-500 font-medium">Outils de dessin</span></div></div>',1)]))):dn("",!0),E("div",m9,[E("div",{ref_key:"mapContainer",ref:n,class:"absolute inset-0 z-[1000]"},null,512)]),U.value&&!Xe.value?($e(),qe("div",{key:2,class:Bi([r.value?"translate-y-0":"translate-y-full md:translate-y-0","w-full md:w-64 bg-white border-t md:border-t-0 md:border-l border-gray-200 flex-shrink-0 z-[2000] transition-transform duration-300 ease-out","fixed md:relative bottom-0 md:bottom-auto right-0 md:top-0 h-[80%] md:h-auto rounded-t-xl md:rounded-none shadow-lg md:shadow-none overflow-y-auto"]),style:{bottom:"var(--mobile-bottom-toolbar-height)"}},[E("div",{class:"md:hidden w-full flex justify-between items-center px-4 py-2 border-b border-gray-200"},[E("div",{class:"flex items-center"},[E("div",{onClick:ae,class:"w-10 h-1.5 bg-gray-300 rounded-full cursor-pointer mr-3"})]),E("button",{onClick:ae,class:"p-1.5 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors"},We[13]||(We[13]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-700",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),hi(HO,{"current-tool":Wn(d),"selected-shape":ce.value,"all-layers":((Zn=Wn(D))==null?void 0:Zn.getLayers())||[],onToolChange:Wn(_),onStyleUpdate:Wn(M),onPropertiesUpdate:de,onDeleteShape:Ue,onFilterChange:xn},null,8,["current-tool","selected-shape","all-layers","onToolChange","onStyleUpdate"])],2)):dn("",!0)]),Xe.value?($e(),qe("div",v9,We[14]||(We[14]=[cc('<div class="text-center"><div class="mb-4"><svg class="animate-spin h-10 w-10 mx-auto text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></div><p class="text-lg font-medium text-gray-900">Génération de la synthèse en cours...</p><p class="text-sm text-gray-500 mt-2">Veuillez patienter pendant que nous analysons votre plan.</p></div>',1)]))):dn("",!0)],512),[[qm,U.value]]),($e(),$a(kg,{to:"body"},[hi(gx,{ref_key:"newPlanModalRef",ref:ee,modelValue:le.value,"onUpdate:modelValue":We[4]||(We[4]=Bt=>le.value=Bt),onCreated:Qe,onSalarieSelected:We[5]||(We[5]=Bt=>J.value=Bt),onVisiteurSelected:We[6]||(We[6]=Bt=>Y.value=Bt)},null,8,["modelValue"])])),($e(),$a(kg,{to:"body"},[ge.value?($e(),qe("div",y9,[E("div",_9,[E("div",b9,[We[16]||(We[16]=E("h2",{class:"text-xl font-semibold text-gray-900"},"Charger un plan existant",-1)),E("button",{onClick:We[7]||(We[7]=Bt=>ge.value=!1),class:"text-gray-400 hover:text-gray-500 focus:outline-none"},We[15]||(We[15]=[E("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),E("div",w9,[Wn(R).isAdmin?($e(),qe("div",x9,[zt.value?J.value?pe.value?($e(),qe("div",z9,[E("div",$9,[E("button",{onClick:wn,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},We[31]||(We[31]=[E("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),Pi(" Retour à la liste des clients ")])),We[32]||(We[32]=E("span",{class:"mx-2 text-gray-400"},"|",-1)),E("span",U9,Wt(ot(pe.value)),1)]),We[34]||(We[34]=E("h3",{class:"font-medium text-gray-700"},"Plans disponibles",-1)),E("div",V9,[N.value?($e(),qe(Bn,{key:0},Er(3,Bt=>E("div",{key:Bt,class:"animate-pulse"},We[33]||(We[33]=[E("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[E("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),E("div",{class:"h-4 bg-gray-100 rounded w-2/3 mb-2"}),E("div",{class:"h-3 bg-gray-50 rounded w-1/3"})],-1)]))),64)):($e(!0),qe(Bn,{key:1},Er(G.value,Bt=>($e(),qe("button",{key:Bt.id,onClick:Kt=>Ge(Bt.id),class:"w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[E("div",H9,Wt(Bt.nom),1),E("div",q9,Wt(Bt.description),1),E("div",W9," Modifié le "+Wt(ye(Bt.date_modification)),1)],8,G9))),128))])])):($e(),qe("div",D9,[E("div",I9,[E("button",{onClick:On,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},We[25]||(We[25]=[E("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),Pi(" Retour à la liste des salaries ")])),We[26]||(We[26]=E("span",{class:"mx-2 text-gray-400"},"|",-1)),E("span",O9,Wt(ot(J.value)),1)]),We[30]||(We[30]=E("h3",{class:"font-medium text-gray-700"},"Sélectionnez un visiteur",-1)),E("div",B9,[De.value?($e(),qe(Bn,{key:0},Er(3,Bt=>E("div",{key:Bt,class:"animate-pulse"},We[27]||(We[27]=[E("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[E("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),E("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):($e(),qe(Bn,{key:1},[fe.value.length===0?($e(),qe("div",R9,We[28]||(We[28]=[E("div",{class:"text-gray-500 mb-2"},"Aucun visiteur trouvé pour ce salarie",-1),E("div",{class:"text-sm text-gray-400"}," Veuillez vérifier que des visiteurs ont été assignés à ce salarie ",-1)]))):($e(!0),qe(Bn,{key:1},Er(fe.value,Bt=>($e(),qe("button",{key:Bt.id,onClick:Kt=>fr(Bt),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[E("div",null,[E("div",j9,Wt(ot(Bt)),1)]),We[29]||(We[29]=E("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,F9))),128))],64))])])):($e(),qe("div",P9,[E("div",M9,[E("button",{onClick:Qt,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},We[20]||(We[20]=[E("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),Pi(" Retour à la liste des entreprises ")])),We[21]||(We[21]=E("span",{class:"mx-2 text-gray-400"},"|",-1)),E("span",A9,Wt(ot(zt.value)),1)]),We[24]||(We[24]=E("h3",{class:"font-medium text-gray-700"},"Sélectionnez un salarie",-1)),E("div",k9,[Le.value?($e(),qe(Bn,{key:0},Er(3,Bt=>E("div",{key:Bt,class:"animate-pulse"},We[22]||(We[22]=[E("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[E("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),E("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):($e(!0),qe(Bn,{key:1},Er(et.value,Bt=>($e(),qe("button",{key:Bt.id,onClick:Kt=>Tn(Bt),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[E("div",null,[E("div",N9,Wt(ot(Bt)),1)]),We[23]||(We[23]=E("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,T9))),128))])])):($e(),qe("div",L9,[We[19]||(We[19]=E("h3",{class:"font-medium text-gray-700"},"Sélectionnez une entreprise",-1)),E("div",S9,[sn.value?($e(),qe(Bn,{key:0},Er(3,Bt=>E("div",{key:Bt,class:"animate-pulse"},We[17]||(We[17]=[E("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[E("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),E("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):($e(!0),qe(Bn,{key:1},Er(pn.value,Bt=>($e(),qe("button",{key:Bt.id,onClick:Kt=>Ht(Bt),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[E("div",null,[E("div",E9,Wt(ot(Bt)),1)]),We[18]||(We[18]=E("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,C9))),128))])]))])):Wn(R).isSalarie?($e(),qe("div",Z9,[pe.value?($e(),qe("div",ej,[E("div",tj,[E("button",{onClick:wn,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},We[39]||(We[39]=[E("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),Pi(" Retour à la liste des clients ")])),We[40]||(We[40]=E("span",{class:"mx-2 text-gray-400"},"|",-1)),E("span",nj,Wt(ot(pe.value)),1)]),We[42]||(We[42]=E("h3",{class:"font-medium text-gray-700"},"Plans disponibles",-1)),E("div",rj,[N.value?($e(),qe(Bn,{key:0},Er(3,Bt=>E("div",{key:Bt,class:"animate-pulse"},We[41]||(We[41]=[E("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[E("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),E("div",{class:"h-4 bg-gray-100 rounded w-2/3 mb-2"}),E("div",{class:"h-3 bg-gray-50 rounded w-1/3"})],-1)]))),64)):($e(!0),qe(Bn,{key:1},Er(G.value,Bt=>($e(),qe("button",{key:Bt.id,onClick:Kt=>Ge(Bt.id),class:"w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[E("div",oj,Wt(Bt.nom),1),E("div",sj,Wt(Bt.description),1),E("div",aj," Modifié le "+Wt(ye(Bt.date_modification)),1)],8,ij))),128))])])):($e(),qe("div",K9,[We[38]||(We[38]=E("h3",{class:"font-medium text-gray-700"},"Sélectionnez un visiteur",-1)),E("div",Y9,[De.value?($e(),qe(Bn,{key:0},Er(3,Bt=>E("div",{key:Bt,class:"animate-pulse"},We[35]||(We[35]=[E("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[E("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),E("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):($e(),qe(Bn,{key:1},[fe.value.length===0?($e(),qe("div",J9,We[36]||(We[36]=[E("div",{class:"text-gray-500 mb-2"},"Aucun visiteur trouvé pour ce salarie",-1),E("div",{class:"text-sm text-gray-400"}," Veuillez vérifier que des visiteurs ont été assignés à ce salarie ",-1)]))):($e(!0),qe(Bn,{key:1},Er(fe.value,Bt=>($e(),qe("button",{key:Bt.id,onClick:Kt=>fr(Bt),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[E("div",null,[E("div",Q9,Wt(ot(Bt)),1)]),We[37]||(We[37]=E("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,X9))),128))],64))])]))])):Wn(R).isEntreprise?($e(),qe("div",lj,Wt(Wn(R).isEntreprise?"...":""),1)):($e(),qe("div",uj,[Wn(i).plans.length===0?($e(),qe("div",cj,We[43]||(We[43]=[E("p",{class:"text-gray-500"},"Aucun plan disponible",-1)]))):($e(),qe("div",fj,[($e(!0),qe(Bn,null,Er(Wn(i).plans,Bt=>($e(),qe("button",{key:Bt.id,onClick:Kt=>Ge(Bt.id),class:"w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[E("div",dj,Wt(Bt.nom),1),E("div",pj,Wt(Bt.description),1),E("div",gj," Modifié le "+Wt(ye(Bt.date_modification)),1)],8,hj))),128))]))]))])])])):dn("",!0)]))])]),H.value?($e(),$a(dx,{key:0,note:Q.value,"is-new-note":!((qt=Q.value)!=null&&qt.id),location:(mn=Q.value)==null?void 0:mn.location,onClose:ar,onSave:Pn},null,8,["note","is-new-note","location"])):dn("",!0)],64)}}}),mj={class:"fixed inset-0 z-[3001] overflow-y-auto"},vj={class:"flex items-center justify-center min-h-screen w-full p-0"},yj={class:"relative bg-white w-full h-full max-h-full overflow-y-auto md:rounded-lg md:max-w-4xl md:h-auto md:max-h-[90vh] md:my-8 shadow-xl transform transition-all",role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"},_j={class:"p-4 md:p-6"},bj={class:"flex justify-between items-center mb-4 border-b pb-4"},wj={class:"text-xl font-semibold text-gray-900",id:"modal-headline"},xj={class:"mt-4"},Lj={key:0,class:"mb-4 rounded-md bg-red-50 p-4"},Sj={class:"flex"},Cj={class:"ml-3"},Ej={class:"text-sm font-medium text-red-800"},Pj={key:0},Mj={key:1},Aj=["value"],kj={key:2},Tj={key:3},Nj=["value"],Dj={class:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-2"},Ij={key:0,class:"mt-2 text-sm text-red-600"},Oj={key:0,class:"mt-2 text-sm text-red-600"},Bj={key:4},Rj={class:"flex items-center"},Fj={key:5},jj={key:6},zj={key:0,class:"mt-2 text-sm text-red-600"},$j={class:"flex justify-end space-x-3"},Uj=["disabled"],Vj={key:0,class:"mr-2"},Gj=cs({__name:"UserFormModal",props:{user:{type:Object,default:()=>({})},salaries:{type:Array,default:()=>[]},entreprises:{type:Array,default:()=>[]},isAdmin:{type:Boolean,default:!1},isEntreprise:{type:Boolean,default:!1},currentSalarie:{type:String,default:void 0},currentEntreprise:{type:String,default:void 0},apiErrors:{type:Array,default:()=>[]},refreshKey:{type:Number,default:0}},emits:["close","save","refresh"],setup(e,{emit:t}){const n=e,r=t,i=Ft(!1),s=Ft(""),o=Ft(""),u=Ft(""),f=Ft(""),d=Ft(""),g=Yl({id:void 0,first_name:"",last_name:"",username:"",email:"",password:"",company_name:"",role:n.isEntreprise?"SALARIE":n.isAdmin?"ADMIN":"VISITEUR",salarie:null,entreprise:null,is_active:!0,storage_quota:50,storage_used:0});$s(()=>{var x;(x=n.user)!=null&&x.id?(g.id=n.user.id,g.first_name=n.user.first_name||"",g.last_name=n.user.last_name||"",g.username=n.user.username||"",g.email=n.user.email||"",g.company_name=n.user.company_name||"",g.role=n.user.role||"VISITEUR",g.is_active=n.user.is_active??!0,n.user.salarie?typeof n.user.salarie=="object"?g.salarie=n.user.salarie.id:g.salarie=n.user.salarie:n.user.salarie_id?g.salarie=n.user.salarie_id:n.currentSalarie&&(g.salarie=parseInt(n.currentSalarie)),n.user.entreprise?typeof n.user.entreprise=="object"?g.entreprise=n.user.entreprise.id:g.entreprise=n.user.entreprise:n.user.entreprise_id?g.entreprise=n.user.entreprise_id:n.currentEntreprise&&(g.entreprise=parseInt(n.currentEntreprise))):(n.currentSalarie&&(g.salarie=parseInt(n.currentSalarie)),n.currentEntreprise&&(g.entreprise=parseInt(n.currentEntreprise)),n.isEntreprise?g.role="SALARIE":n.isAdmin||(g.role="VISITEUR"))}),bp(()=>{g.role==="ADMIN"||g.role==="ENTREPRISE"?(g.salarie=null,g.entreprise=null):g.role==="SALARIE"&&(g.salarie=null,n.isEntreprise&&n.currentEntreprise&&(g.entreprise=parseInt(n.currentEntreprise)))}),bp(()=>{s.value="",o.value="",u.value="",f.value="",n.apiErrors&&n.apiErrors.length>0&&n.apiErrors.forEach(x=>{switch(x.field){case"email":s.value=x.message;break;case"username":o.value=x.message;break;case"password":u.value=x.message;break;case"non_field_error":default:f.value=x.message;break}})});async function y(){s.value="",o.value="",u.value="",f.value="";let x=!0;if(g.id||(g.password!==d.value?(u.value="Les mots de passe ne correspondent pas",x=!1):g.password.length<8&&(u.value="Le mot de passe doit contenir au moins 8 caractères",x=!1)),!!x){i.value=!0;try{const _={...g};g.id&&delete _.password,n.isEntreprise&&["SALARIE","VISITEUR"].includes(g.role)&&(_.entreprise_id=n.currentEntreprise?parseInt(n.currentEntreprise):void 0),_.salarie&&(_.salarie_id=_.salarie,delete _.salarie),n.currentSalarie&&g.role==="VISITEUR"&&(_.salarie_id=parseInt(n.currentSalarie)),await r("save",_),r("refresh")}catch(_){console.error("Erreur locale:",_)}finally{i.value=!1}}}return(x,_)=>($e(),qe("div",mj,[E("div",vj,[_[35]||(_[35]=E("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[E("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),E("div",yj,[E("div",null,[E("div",_j,[E("div",bj,[E("h3",wj,Wt(e.user?"Modifier l'utilisateur":"Nouvel utilisateur"),1),E("button",{type:"button",onClick:_[0]||(_[0]=M=>x.$emit("close")),class:"text-gray-400 hover:text-gray-500"},_[14]||(_[14]=[E("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),E("div",xj,[f.value?($e(),qe("div",Lj,[E("div",Sj,[_[15]||(_[15]=E("div",{class:"flex-shrink-0"},[E("svg",{class:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[E("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),E("div",Cj,[E("h3",Ej,Wt(f.value),1)])])])):dn("",!0),E("form",{onSubmit:Sf(y,["prevent"]),class:"space-y-6"},[e.isAdmin?($e(),qe("div",Pj,[_[17]||(_[17]=E("label",{for:"role",class:"block text-sm font-medium text-gray-700"},"Type d'utilisateur",-1)),Fn(E("select",{id:"role","onUpdate:modelValue":_[1]||(_[1]=M=>g.role=M),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:""},_[16]||(_[16]=[E("option",{value:"ADMIN"},"Administrateur",-1),E("option",{value:"ENTREPRISE"},"Entreprise",-1),E("option",{value:"SALARIE"},"Salarie",-1),E("option",{value:"VISITEUR"},"Visiteur",-1)]),512),[[uo,g.role]])])):dn("",!0),e.isAdmin&&g.role==="SALARIE"?($e(),qe("div",Mj,[_[19]||(_[19]=E("label",{for:"entreprise",class:"block text-sm font-medium text-gray-700"},"Entreprise",-1)),Fn(E("select",{id:"entreprise","onUpdate:modelValue":_[2]||(_[2]=M=>g.entreprise=M),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},[_[18]||(_[18]=E("option",{value:null},"-- Sélectionner une entreprise --",-1)),($e(!0),qe(Bn,null,Er(e.entreprises,M=>($e(),qe("option",{key:M.id,value:M.id},Wt(M.first_name)+" "+Wt(M.last_name)+" ("+Wt(M.company_name||"Entreprise")+") ",9,Aj))),128))],512),[[uo,g.entreprise]])])):dn("",!0),e.isEntreprise&&!g.id?($e(),qe("div",kj,[_[21]||(_[21]=E("label",{for:"role",class:"block text-sm font-medium text-gray-700"},"Type d'utilisateur",-1)),Fn(E("select",{id:"role","onUpdate:modelValue":_[3]||(_[3]=M=>g.role=M),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:""},_[20]||(_[20]=[E("option",{value:"SALARIE"},"Salarie",-1),E("option",{value:"VISITEUR"},"Visiteur",-1)]),512),[[uo,g.role]])])):dn("",!0),(e.isAdmin||e.isEntreprise)&&g.role==="VISITEUR"&&!e.currentSalarie?($e(),qe("div",Tj,[_[23]||(_[23]=E("label",{for:"salarie",class:"block text-sm font-medium text-gray-700"},"Salarie",-1)),Fn(E("select",{id:"salarie","onUpdate:modelValue":_[4]||(_[4]=M=>g.salarie=M),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:""},[_[22]||(_[22]=E("option",{value:null},"-- Sélectionner un salarie --",-1)),($e(!0),qe(Bn,null,Er(e.salaries,M=>($e(),qe("option",{key:M.id,value:M.id},Wt(M.first_name)+" "+Wt(M.last_name)+" ("+Wt(M.company_name||"Salarie")+") ",9,Nj))),128))],512),[[uo,g.salarie]])])):dn("",!0),E("div",Dj,[E("div",null,[_[24]||(_[24]=E("label",{for:"first_name",class:"block text-sm font-medium text-gray-700"},"Prénom",-1)),Fn(E("input",{type:"text",id:"first_name","onUpdate:modelValue":_[5]||(_[5]=M=>g.first_name=M),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[ri,g.first_name]])]),E("div",null,[_[25]||(_[25]=E("label",{for:"last_name",class:"block text-sm font-medium text-gray-700"},"Nom",-1)),Fn(E("input",{type:"text",id:"last_name","onUpdate:modelValue":_[6]||(_[6]=M=>g.last_name=M),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[ri,g.last_name]])])]),E("div",null,[_[26]||(_[26]=E("label",{for:"email",class:"block text-sm font-medium text-gray-700"},"Email",-1)),Fn(E("input",{type:"email",id:"email","onUpdate:modelValue":_[7]||(_[7]=M=>g.email=M),required:"",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[ri,g.email]]),s.value?($e(),qe("div",Ij,Wt(s.value),1)):dn("",!0)]),E("div",null,[_[27]||(_[27]=E("label",{for:"username",class:"block text-sm font-medium text-gray-700"},"Nom d'utilisateur",-1)),Fn(E("input",{type:"text",id:"username","onUpdate:modelValue":_[8]||(_[8]=M=>g.username=M),required:"",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[ri,g.username]]),o.value?($e(),qe("div",Oj,Wt(o.value),1)):dn("",!0)]),E("div",null,[_[28]||(_[28]=E("label",{for:"company_name",class:"block text-sm font-medium text-gray-700"},"Entreprise",-1)),Fn(E("input",{type:"text",id:"company_name","onUpdate:modelValue":_[9]||(_[9]=M=>g.company_name=M),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[ri,g.company_name]])]),g.role==="ENTREPRISE"||g.role==="SALARIE"?($e(),qe("div",Bj,[_[30]||(_[30]=E("label",{for:"storage_quota",class:"block text-sm font-medium text-gray-700"},"Quota de stockage (MB)",-1)),E("div",Rj,[Fn(E("input",{type:"number",id:"storage_quota","onUpdate:modelValue":_[10]||(_[10]=M=>g.storage_quota=M),min:"1",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[ri,g.storage_quota]]),_[29]||(_[29]=E("span",{class:"ml-2 text-sm text-gray-500"},"MB",-1))]),_[31]||(_[31]=E("p",{class:"mt-1 text-sm text-gray-500"},"Espace de stockage maximum pour les photos des notes",-1))])):dn("",!0),g.id?dn("",!0):($e(),qe("div",Fj,[_[32]||(_[32]=E("label",{for:"password",class:"block text-sm font-medium text-gray-700"},"Mot de passe",-1)),Fn(E("input",{type:"password",id:"password","onUpdate:modelValue":_[11]||(_[11]=M=>g.password=M),required:"",autocomplete:"new-password",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[ri,g.password]])])),g.id?dn("",!0):($e(),qe("div",jj,[_[33]||(_[33]=E("label",{for:"password_confirm",class:"block text-sm font-medium text-gray-700"},"Confirmer le mot de passe",-1)),Fn(E("input",{type:"password",id:"password_confirm","onUpdate:modelValue":_[12]||(_[12]=M=>d.value=M),required:"",autocomplete:"new-password",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[ri,d.value]]),u.value?($e(),qe("div",zj,Wt(u.value),1)):dn("",!0)])),E("div",$j,[E("button",{type:"button",onClick:_[13]||(_[13]=M=>x.$emit("close")),class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"}," Annuler "),E("button",{type:"submit",disabled:i.value,class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},[i.value?($e(),qe("span",Vj,_[34]||(_[34]=[E("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[E("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),E("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):dn("",!0),Pi(" "+Wt(g.id?"Enregistrer":"Créer"),1)],8,Uj)])],32)])])])])])]))}}),Hj={class:"fixed inset-0 z-[3001] overflow-y-auto"},qj={class:"flex items-center justify-center min-h-screen w-full"},Wj={class:"relative bg-white w-full h-full md:rounded-lg md:max-w-lg md:h-auto md:max-h-[90vh] md:my-8 shadow-xl transform transition-all overflow-hidden",role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"},Zj={class:"p-4 md:p-6"},Kj={class:"flex items-start"},Yj={class:"ml-4 flex-1"},Jj={class:"text-lg leading-6 font-medium text-gray-900",id:"modal-headline"},Xj={class:"mt-2"},Qj={class:"text-sm text-gray-500"},ez={class:"mt-6 flex flex-col-reverse sm:flex-row-reverse sm:justify-end gap-3"},Rx=cs({__name:"ConfirmationModal",props:{title:{type:String,required:!0},message:{type:String,required:!0}},emits:["confirm","cancel"],setup(e){return(t,n)=>($e(),qe("div",Hj,[E("div",qj,[n[3]||(n[3]=E("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[E("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),E("div",Wj,[E("div",Zj,[E("div",Kj,[n[2]||(n[2]=E("div",{class:"flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100"},[E("svg",{class:"h-6 w-6 text-red-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),E("div",Yj,[E("h3",Jj,Wt(e.title),1),E("div",Xj,[E("p",Qj,Wt(e.message),1)])])]),E("div",ez,[E("button",{type:"button",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:w-auto sm:text-sm",onClick:n[0]||(n[0]=r=>t.$emit("confirm"))}," Confirmer "),E("button",{type:"button",class:"w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:w-auto sm:text-sm",onClick:n[1]||(n[1]=r=>t.$emit("cancel"))}," Annuler ")])])])])]))}}),tz={class:"h-full bg-gray-50"},nz={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},rz={class:"flex justify-between items-center mb-8"},iz={class:"text-3xl font-extrabold text-gray-900"},oz={key:0},sz={key:1},az={key:2},lz={key:0},uz={key:1},cz={key:2},fz={class:"bg-white shadow rounded-lg mb-6 p-4"},hz={class:"space-y-4"},dz={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},pz={key:0},gz={key:0,value:"ADMIN"},mz={key:1,value:"ENTREPRISE"},vz={key:1},yz=["value"],_z={key:2},bz=["value"],wz={class:"w-full"},xz={class:"bg-white shadow rounded-lg"},Lz={class:"overflow-x-auto"},Sz={class:"min-w-full divide-y divide-gray-200"},Cz={class:"bg-gray-50"},Ez={key:0,scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},Pz={key:1,scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},Mz={class:"bg-white divide-y divide-gray-200"},Az={key:0,class:"animate-pulse"},kz={key:1},Tz={class:"px-6 py-4 whitespace-nowrap"},Nz={class:"flex items-center"},Dz={class:"flex-shrink-0 h-10 w-10"},Iz={class:"h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center"},Oz={class:"text-primary-600 font-medium"},Bz={class:"ml-4"},Rz={class:"text-sm font-medium text-gray-900"},Fz={class:"text-sm text-gray-500"},jz={class:"px-6 py-4 whitespace-nowrap"},zz={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},$z={key:0,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Uz={key:1,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Vz={class:"px-6 py-4 whitespace-nowrap"},Gz={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Hz=["onClick"],qz=["onClick"],Wz={key:0,class:"fixed inset-0 z-[3001] overflow-y-auto"},Zz=cs({__name:"UserListView",setup(e){const t=ma(),n=Uu(),r=Ft([]),i=Ft([]),s=Ft([]),o=Ft(!1),u=Ft(!1),f=Ft(null),d=Ft(null),g=Ft(!0),y=Ft([]),x=Yl({role:"",search:"",salarie:"",entreprise:""}),_=cr(()=>t.isAdmin),M=cr(()=>t.isEntreprise),T=cr(()=>t.isSalarie),D=cr(()=>_.value?r.value.filter($=>$.role==="SALARIE"):M.value?r.value.filter($=>{var W,G;return $.role==="SALARIE"&&((W=$.entreprise)==null?void 0:W.id)===((G=t.user)==null?void 0:G.id)}):[]),I=cr(()=>{let $=r.value;if(M.value&&($=$.filter(W=>{var G,J,Y,pe,Le;return W.role==="SALARIE"?((G=W.entreprise)==null?void 0:G.id)===((J=t.user)==null?void 0:J.id):W.role==="VISITEUR"?((pe=(Y=W.salarie)==null?void 0:Y.entreprise)==null?void 0:pe.id)===((Le=t.user)==null?void 0:Le.id):!1})),T.value&&($=$.filter(W=>{var G,J;return W.role==="VISITEUR"&&(W.salarie_id===((G=t.user)==null?void 0:G.id)||W.salarie&&W.salarie.id===((J=t.user)==null?void 0:J.id))})),(_.value||M.value)&&(x.role&&($=$.filter(W=>W.role===x.role)),x.salarie&&($=$.filter(W=>{var J;const G=((J=W.salarie)==null?void 0:J.id)||W.salarie_id;return(G==null?void 0:G.toString())===x.salarie.toString()})),x.entreprise&&_.value&&($=$.filter(W=>{var G,J,Y,pe,Le;return W.role==="SALARIE"?((J=(G=W.entreprise)==null?void 0:G.id)==null?void 0:J.toString())===x.entreprise.toString():W.role==="VISITEUR"?((Le=(pe=(Y=W.salarie)==null?void 0:Y.entreprise)==null?void 0:pe.id)==null?void 0:Le.toString())===x.entreprise.toString():!1}))),x.search){const W=x.search.toLowerCase();$=$.filter(G=>{var J,Y,pe,Le;return((J=G.username)==null?void 0:J.toLowerCase().includes(W))||((Y=G.email)==null?void 0:Y.toLowerCase().includes(W))||((pe=G.first_name)==null?void 0:pe.toLowerCase().includes(W))||((Le=G.last_name)==null?void 0:Le.toLowerCase().includes(W))||G.company_name&&G.company_name.toLowerCase().includes(W)})}return $});$s(async()=>{await j(),await Z()});async function j(){var $,W,G;g.value=!0;try{if(_.value)r.value=await t.fetchUsers();else if(M.value){const[J,Y]=await Promise.all([np({role:"SALARIE",entrepriseId:($=t.user)==null?void 0:$.id}),np({role:"VISITEUR",entrepriseId:(W=t.user)==null?void 0:W.id})]);r.value=[...J,...Y]}else T.value&&(r.value=await np({role:"VISITEUR",salarieId:(G=t.user)==null?void 0:G.id,includeDetails:!0}),console.log("Visiteurs récupérés:",r.value))}catch(J){console.error("Erreur lors de la récupération des utilisateurs:",J),n.error("Erreur lors de la récupération des utilisateurs")}finally{g.value=!1}}async function Z(){try{_.value?await Promise.all([te(),le()]):M.value&&await ue()}catch($){console.error("Erreur lors de la récupération des dépendances:",$)}}async function te(){var $;try{_.value?i.value=await t.fetchUsersByRole({role:"SALARIE"}):M.value&&(i.value=await t.fetchEntrepriseSalaries(($=t.user)==null?void 0:$.id))}catch(W){console.error("Erreur lors de la récupération des salaries:",W)}}async function ue(){var $,W;if(!(!M.value||!(($=t.user)!=null&&$.id)))try{i.value=await t.fetchEntrepriseSalaries((W=t.user)==null?void 0:W.id)}catch(G){console.error("Erreur lors de la récupération des salaries de l'entreprise:",G)}}async function le(){try{s.value=await t.fetchEnterprises()}catch($){console.error("Erreur lors de la récupération des entreprises:",$)}}function ge(){f.value=null,o.value=!0}function H($){f.value={...$},o.value=!0}function U(){o.value=!1,f.value=null,y.value=[]}async function Q($){var G,J,Y,pe,Le,De;y.value=[];const W=!!$.id;try{const N={...$};_.value?(N.entreprise&&typeof N.entreprise=="object"?N.entreprise_id=N.entreprise.id:typeof N.entreprise=="number"&&(N.entreprise_id=N.entreprise),N.salarie&&typeof N.salarie=="object"?N.salarie_id=N.salarie.id:typeof N.salarie=="number"&&(N.salarie_id=N.salarie)):M.value?(N.entreprise_id=(G=t.user)==null?void 0:G.id,N.role==="VISITEUR"&&(N.salarie&&typeof N.salarie=="object"?N.salarie_id=N.salarie.id:typeof N.salarie=="number"&&(N.salarie_id=N.salarie))):T.value&&(N.role="VISITEUR",N.salarie_id=(J=t.user)==null?void 0:J.id),N.role==="SALARIE"?((Y=N.entreprise)!=null&&Y.id?(N.entreprise_id=N.entreprise.id,delete N.entreprise):typeof N.entreprise=="number"&&(N.entreprise_id=N.entreprise,delete N.entreprise),delete N.salarie):N.role==="VISITEUR"&&((pe=N.salarie)!=null&&pe.id?(N.salarie_id=N.salarie.id,delete N.salarie):typeof N.salarie=="number"&&(N.salarie_id=N.salarie,delete N.salarie),delete N.entreprise,delete N.entreprise_id),W?(await t.updateUser($.id,N),n.success("Utilisateur modifié avec succès")):(await t.createUser(N),n.success("Utilisateur créé avec succès")),await Promise.all([j(),Z()]),U()}catch(N){console.error("Error saving user:",((Le=N.response)==null?void 0:Le.data)||N),y.value=R5(N),n.error("Erreur lors de la sauvegarde de l'utilisateur");const ee=((De=N.response)==null?void 0:De.data)||{};let fe="";throw typeof ee=="object"&&(fe=Object.entries(ee).map(([ce,_e])=>Array.isArray(_e)?`${ce}: ${_e[0]}`:`${ce}: ${_e}`).filter(ce=>ce).join(`
`)),fe||(fe="Une erreur est survenue lors de la sauvegarde"),new Error(fe)}}function F($){d.value=$,u.value=!0}async function B(){if(d.value)try{await t.deleteUser(d.value.id),n.success("Utilisateur supprimé avec succès"),await Promise.all([j(),Z()]),u.value=!1,d.value=null}catch($){throw console.error("Erreur lors de la suppression de l'utilisateur:",$),n.error("Erreur lors de la suppression de l'utilisateur"),$}}function R($){var W,G,J,Y,pe,Le,De,N;return _.value?!0:M.value?$.role==="SALARIE"?((W=$.entreprise)==null?void 0:W.id)===((G=t.user)==null?void 0:G.id):$.role==="VISITEUR"?((Y=(J=$.salarie)==null?void 0:J.entreprise)==null?void 0:Y.id)===((pe=t.user)==null?void 0:pe.id):!1:T.value?$.role==="VISITEUR"&&($.salarie_id===((Le=t.user)==null?void 0:Le.id)||((De=$.salarie)==null?void 0:De.id)===((N=t.user)==null?void 0:N.id)):!1}return($,W)=>{var G,J,Y,pe;return $e(),qe("div",tz,[E("div",nz,[E("div",rz,[E("h1",iz,[_.value?($e(),qe("span",oz,"Gestion des utilisateurs")):M.value?($e(),qe("span",sz,"Gestion des salaries et visiteurs")):T.value?($e(),qe("span",az,"Gestion des visiteurs")):dn("",!0)]),E("button",{onClick:ge,class:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},[W[5]||(W[5]=E("svg",{class:"-ml-1 mr-2 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[E("path",{"fill-rule":"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z","clip-rule":"evenodd"})],-1)),_.value?($e(),qe("span",lz,"Nouvel utilisateur")):M.value?($e(),qe("span",uz,"Nouveau salarie/visiteur")):T.value?($e(),qe("span",cz,"Nouvel visiteur")):dn("",!0)])]),E("div",fz,[E("div",hz,[E("div",dz,[_.value||M.value?($e(),qe("div",pz,[W[9]||(W[9]=E("label",{for:"role-filter",class:"block text-sm font-medium text-gray-700"},"Rôle",-1)),Fn(E("select",{id:"role-filter","onUpdate:modelValue":W[0]||(W[0]=Le=>x.role=Le),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[W[6]||(W[6]=E("option",{value:""},"Tous les rôles",-1)),_.value?($e(),qe("option",gz,"Administrateur")):dn("",!0),_.value?($e(),qe("option",mz,"Entreprise")):dn("",!0),W[7]||(W[7]=E("option",{value:"SALARIE"},"Salarie",-1)),W[8]||(W[8]=E("option",{value:"VISITEUR"},"Visiteur",-1))],512),[[uo,x.role]])])):dn("",!0),_.value?($e(),qe("div",vz,[W[11]||(W[11]=E("label",{for:"entreprise-filter",class:"block text-sm font-medium text-gray-700"},"Entreprise",-1)),Fn(E("select",{id:"entreprise-filter","onUpdate:modelValue":W[1]||(W[1]=Le=>x.entreprise=Le),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[W[10]||(W[10]=E("option",{value:""},"Toutes les entreprises",-1)),($e(!0),qe(Bn,null,Er(s.value,Le=>($e(),qe("option",{key:Le.id,value:Le.id},Wt(Wn(Vl)(Le)),9,yz))),128))],512),[[uo,x.entreprise]])])):dn("",!0),_.value||M.value?($e(),qe("div",_z,[W[13]||(W[13]=E("label",{for:"salarie-filter",class:"block text-sm font-medium text-gray-700"},"Salarie",-1)),Fn(E("select",{id:"salarie-filter","onUpdate:modelValue":W[2]||(W[2]=Le=>x.salarie=Le),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[W[12]||(W[12]=E("option",{value:""},"Tous les salaries",-1)),($e(!0),qe(Bn,null,Er(D.value,Le=>($e(),qe("option",{key:Le.id,value:Le.id},Wt(Wn(Vl)(Le)),9,bz))),128))],512),[[uo,x.salarie]])])):dn("",!0)]),E("div",wz,[W[14]||(W[14]=E("label",{for:"search",class:"block text-sm font-medium text-gray-700"},"Recherche",-1)),Fn(E("input",{type:"text",id:"search","onUpdate:modelValue":W[3]||(W[3]=Le=>x.search=Le),placeholder:"Rechercher par nom, email, entreprise...",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},null,512),[[ri,x.search]])])])]),E("div",xz,[E("div",Lz,[E("table",Sz,[E("thead",Cz,[E("tr",null,[W[15]||(W[15]=E("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Utilisateur ",-1)),W[16]||(W[16]=E("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Rôle ",-1)),W[17]||(W[17]=E("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Email ",-1)),_.value||M.value?($e(),qe("th",Ez," Entreprise ")):dn("",!0),_.value||M.value?($e(),qe("th",Pz," Salarie ")):dn("",!0),W[18]||(W[18]=E("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Statut ",-1)),W[19]||(W[19]=E("th",{scope:"col",class:"relative px-6 py-3"},[E("span",{class:"sr-only"},"Actions")],-1))])]),E("tbody",Mz,[g.value?($e(),qe("tr",Az,W[20]||(W[20]=[E("td",{colspan:"7",class:"py-4 px-6"},[E("div",{class:"h-4 bg-gray-200 rounded w-3/4"})],-1)]))):I.value.length===0?($e(),qe("tr",kz,W[21]||(W[21]=[E("td",{colspan:"7",class:"py-4 px-6 text-center text-gray-500"}," Aucun utilisateur trouvé ",-1)]))):dn("",!0),($e(!0),qe(Bn,null,Er(I.value,Le=>{var De;return $e(),qe("tr",{key:Le.id},[E("td",Tz,[E("div",Nz,[E("div",Dz,[E("div",Iz,[E("span",Oz,Wt(Wn(aT)(Le.first_name,Le.last_name)),1)])]),E("div",Bz,[E("div",Rz,Wt(Wn(Vl)(Le)),1),E("div",Fz,Wt(Le.username),1)])])]),E("td",jz,[E("span",{class:Bi(Wn(cT)())},Wt(Wn(uT)(Le.role)),3)]),E("td",zz,Wt(Le.email),1),_.value||M.value?($e(),qe("td",$z,[Le.role==="ENTREPRISE"?($e(),qe(Bn,{key:0},[Pi(" - ")],64)):Le.role==="SALARIE"?($e(),qe(Bn,{key:1},[Pi(Wt(Le.entreprise?Wn(Vl)(Le.entreprise):"Non assigné"),1)],64)):Le.role==="VISITEUR"?($e(),qe(Bn,{key:2},[Pi(Wt((De=Le.salarie)!=null&&De.entreprise?Wn(Vl)(Le.salarie.entreprise):"Non assigné"),1)],64)):($e(),qe(Bn,{key:3},[Pi(" - ")],64))])):dn("",!0),_.value||M.value?($e(),qe("td",Uz,[Le.role==="ENTREPRISE"||Le.role==="ADMIN"?($e(),qe(Bn,{key:0},[Pi(" - ")],64)):Le.role==="SALARIE"?($e(),qe(Bn,{key:1},[Pi(" - ")],64)):($e(),qe(Bn,{key:2},[Pi(Wt(Le.salarie?Wn(Vl)(Le.salarie):"Non assigné"),1)],64))])):dn("",!0),E("td",Vz,[E("span",{class:Bi(Wn(fT)(Le.is_active))},Wt(Le.is_active?"Actif":"Inactif"),3)]),E("td",Gz,[E("button",{onClick:N=>H(Le),class:"text-primary-600 hover:text-primary-900 mr-4"}," Modifier ",8,Hz),R(Le)?($e(),qe("button",{key:0,onClick:N=>F(Le),class:"text-red-600 hover:text-red-900"}," Supprimer ",8,qz)):dn("",!0)])])}),128))])])])])]),o.value?($e(),qe("div",Wz,[hi(Gj,{user:f.value,salaries:i.value,entreprises:s.value,"is-admin":_.value,"is-entreprise":M.value,"current-salarie":T.value?(J=(G=Wn(t).user)==null?void 0:G.id)==null?void 0:J.toString():void 0,"current-entreprise":M.value?(pe=(Y=Wn(t).user)==null?void 0:Y.id)==null?void 0:pe.toString():void 0,"api-errors":y.value,onClose:U,onSave:Q},null,8,["user","salaries","entreprises","is-admin","is-entreprise","current-salarie","current-entreprise","api-errors"])])):dn("",!0),u.value?($e(),$a(Rx,{key:1,title:"Supprimer l'utilisateur",message:"Êtes-vous sûr de vouloir supprimer cet utilisateur ? Cette action est irréversible.",onConfirm:B,onCancel:W[4]||(W[4]=Le=>u.value=!1)})):dn("",!0)])}}}),Kz={class:"h-full bg-gray-50"},Yz={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},Jz={class:"sm:flex sm:items-center"},Xz={class:"sm:flex-auto"},Qz={class:"text-2xl font-semibold text-gray-900"},e$={class:"mt-2 text-sm text-gray-700"},t$={key:0,class:"mt-8"},n$={class:"mb-6"},r$=["value"],i$={class:"mb-6"},o$={value:null},s$=["value"],a$={key:0,class:"mb-6"},l$={value:null},u$=["value"],c$={key:1,class:"mt-8"},f$={class:"mb-6"},h$=["value"],d$={class:"mt-8"},p$={class:"overflow-hidden shadow-sm ring-1 ring-black ring-opacity-5 rounded-lg"},g$={class:"overflow-x-auto"},m$={class:"min-w-full divide-y divide-gray-300"},v$={class:"bg-gray-50"},y$={scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6 lg:pl-8"},_$={class:"ml-2 flex-none rounded"},b$={scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},w$={class:"ml-2 flex-none rounded"},x$={class:"divide-y divide-gray-200 bg-white"},L$={key:0},S$={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 lg:pl-8"},C$={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},E$={class:"px-3 py-4 text-sm text-gray-900"},P$={key:0,class:"flex items-center"},M$={class:"h-8 w-8 flex-shrink-0"},A$={class:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center"},k$={class:"text-primary-700 font-medium text-sm"},T$={class:"ml-3"},N$={class:"font-medium"},D$={key:1,class:"text-gray-500"},I$={class:"px-3 py-4 text-sm text-gray-900"},O$={key:0,class:"flex items-center"},B$={class:"h-8 w-8 flex-shrink-0"},R$={class:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center"},F$={class:"text-primary-700 font-medium text-sm"},j$={class:"ml-3"},z$={class:"font-medium"},$$={key:1,class:"text-gray-500"},U$={class:"px-3 py-4 text-sm text-gray-900"},V$={key:0,class:"flex items-center"},G$={class:"h-8 w-8 flex-shrink-0"},H$={class:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center"},q$={class:"text-primary-700 font-medium text-sm"},W$={class:"ml-3"},Z$={class:"font-medium"},K$={key:1,class:"text-gray-500"},Y$={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},J$={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6 lg:pr-8"},X$=["onClick"],Q$=["onClick"],eU=["onClick"],tU={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[2000]"},nU={class:"bg-white rounded-lg p-6 max-w-md w-full"},rU={class:"flex justify-between items-center mb-4"},iU=["disabled"],oU=["disabled"],sU={key:0,class:"space-y-4"},aU={key:0},lU=["disabled"],uU=["value"],cU=["disabled"],fU=["value"],hU={key:0,class:"mt-1 text-sm text-gray-500"},dU=["disabled"],pU=["value"],gU={key:0,class:"mt-1 text-sm text-gray-500"},mU={key:1,class:"mt-4 bg-red-50 p-4 rounded-md"},vU={class:"flex"},yU={class:"ml-3"},_U={class:"text-sm font-medium text-red-800"},bU={class:"mt-5 sm:mt-6 sm:grid sm:grid-cols-2 sm:gap-3"},wU=["disabled"],xU={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},LU=cs({__name:"PlansView",setup(e){const t=Op(),n=py(),r=ma(),i=Ft([]),s=Ft([]),o=Ft([]),u=Ft([]),f=Ft(!1),d=Ft(!1),g=Ft(!1),y=Ft(null),x=Ft({nom:"",description:"",client:null}),_=Ft({id:0,nom:"",description:"",entreprise:null,salarie:null,visiteur:null}),M=Ft(!1),T=Ft(null),D=Ft(null),I=Ft(null),j=Ft("date_modification"),Z=Ft("desc"),te=Ft(null),ue=cr(()=>D.value?u.value.filter(k=>typeof k.salarie=="object"&&k.salarie?k.salarie.id===D.value:k.salarie===D.value||k.salarie_id===D.value):u.value),le=cr(()=>{let k=i.value;console.log(`
[PlansView] Filtering plans:`,k.map(ke=>({id:ke.id,entreprise:ke.entreprise,salarie:ke.salarie,visiteur:ke.visiteur}))),r.isAdmin?(te.value&&(k=k.filter(ke=>{var Pe;return typeof ke.entreprise=="object"?((Pe=ke.entreprise)==null?void 0:Pe.id)===te.value:ke.entreprise===te.value})),D.value&&(k=k.filter(ke=>{var Pe;return typeof ke.salarie=="object"?((Pe=ke.salarie)==null?void 0:Pe.id)===D.value:ke.salarie===D.value}),I.value&&(k=k.filter(ke=>{var Pe;return typeof ke.visiteur=="object"?((Pe=ke.visiteur)==null?void 0:Pe.id)===I.value:ke.visiteur===I.value})))):r.isSalarie&&(k=k.filter(ke=>{var Pe,Ge,K;return typeof ke.salarie=="object"?((Pe=ke.salarie)==null?void 0:Pe.id)===((Ge=r.user)==null?void 0:Ge.id):ke.salarie===((K=r.user)==null?void 0:K.id)}),I.value&&(k=k.filter(ke=>{var Pe;return typeof ke.visiteur=="object"?((Pe=ke.visiteur)==null?void 0:Pe.id)===I.value:ke.visiteur===I.value})));const ae=[...k].sort((ke,Pe)=>{if(j.value==="nom")return Z.value==="asc"?ke.nom.localeCompare(Pe.nom):Pe.nom.localeCompare(ke.nom);{const Ge=new Date(ke[j.value]).getTime(),K=new Date(Pe[j.value]).getTime();return Z.value==="asc"?Ge-K:K-Ge}});return console.log("[PlansView] Final filtered and sorted plans:",ae.map(ke=>({id:ke.id,entreprise:ke.entreprise,salarie:ke.salarie,visiteur:ke.visiteur}))),ae}),ge=cr(()=>r.isAdmin?{title:"Tous les plans",description:"Liste complète des plans",plans:i.value}:r.isSalarie?{title:"Plans des visiteurs",description:"Plans où vous êtes assigné comme salarie",plans:i.value.filter(k=>{var ae,ke,Pe;return typeof k.salarie=="object"?((ae=k.salarie)==null?void 0:ae.id)===((ke=r.user)==null?void 0:ke.id):k.salarie===((Pe=r.user)==null?void 0:Pe.id)})}:{title:"Mes plans",description:"Plans qui vous sont assignés ou que vous avez créés",plans:i.value.filter(k=>{var Pe,Ge,K,de;const ae=k.createur.id===((Pe=r.user)==null?void 0:Pe.id);let ke=!1;return typeof k.visiteur=="object"?ke=((Ge=k.visiteur)==null?void 0:Ge.id)===((K=r.user)==null?void 0:K.id):ke=k.visiteur===((de=r.user)==null?void 0:de.id),ke||ae})}),H=cr(()=>te.value?s.value.filter(k=>{var ae;return typeof k.entreprise=="object"?((ae=k.entreprise)==null?void 0:ae.id)===te.value:k.entreprise_id===te.value}):s.value),U=cr(()=>_.value.entreprise?s.value.filter(k=>{var ae;return typeof k.entreprise=="object"?((ae=k.entreprise)==null?void 0:ae.id)===_.value.entreprise:k.entreprise_id===_.value.entreprise}):[]),Q=cr(()=>!_.value.entreprise||!_.value.salarie?[]:u.value.filter(k=>typeof k.salarie=="object"&&k.salarie?k.salarie.id===_.value.salarie:k.salarie===_.value.salarie||k.salarie_id===_.value.salarie));$s(async()=>{var k;await F(),r.isAdmin?await B():r.isSalarie&&await $(((k=r.user)==null?void 0:k.id)||0)});async function F(){try{const k=await n.fetchPlansWithDetails();i.value=k.data}catch(k){console.error("Erreur lors du chargement des plans:",k)}}async function B(){try{console.log("Chargement des entreprises..."),o.value=await r.fetchEnterprises(),console.log("Entreprises chargées:",o.value)}catch(k){console.error("Erreur lors du chargement des entreprises:",k)}}async function R(k){try{if(console.log("Chargement des salaries pour l'entreprise:",k),k===void 0){const ae=await r.fetchUsersByRole({role:"SALARIE"});s.value=ae}else s.value=await r.fetchEntrepriseSalaries(k);console.log("Salaries chargés:",s.value)}catch(ae){console.error("Erreur lors du chargement des salaries:",ae)}}async function $(k){try{console.log("Chargement des visiteurs pour le salarie:",k);const ae=await np({role:"VISITEUR",salarieId:k});u.value=ae.map(ke=>({...ke,salarie_id:k})),console.log("Visiteurs chargés:",u.value)}catch(ae){console.error("Erreur lors du chargement des visiteurs:",ae)}}function W(){f.value=!0,x.value={nom:"",description:"",client:null}}async function G(k){console.log(`
[PlansView][editPlan] ====== DÉBUT ÉDITION PLAN ======`),console.log("[PlansView][editPlan] Plan reçu:",{id:k.id,nom:k.nom,entreprise:k.entreprise,salarie:k.salarie,visiteur:k.visiteur});try{console.log("[PlansView][editPlan] Définition du plan courant dans le store..."),n.setCurrentPlan(k),console.log("[PlansView][editPlan] Sauvegarde de l'ID dans localStorage:",k.id),localStorage.setItem("lastPlanId",k.id.toString()),console.log("[PlansView][editPlan] Redirection vers la vue carte..."),await t.push("/"),console.log(`[PlansView][editPlan] ====== FIN ÉDITION PLAN ======
`)}catch(ae){console.error("[PlansView][editPlan] ERREUR:",ae),ae instanceof Error&&console.error("[PlansView][editPlan] Stack trace:",ae.stack),alert("Une erreur est survenue lors du chargement du plan")}}async function J(k){k!=null&&k.id&&(y.value=k,g.value=!0)}async function Y(){var k,ae;if((k=y.value)!=null&&k.id)try{await n.deletePlan(y.value.id),await F(),((ae=n.currentPlan)==null?void 0:ae.id)===y.value.id&&n.clearCurrentPlan()}catch(ke){console.error("Erreur lors de la suppression du plan:",ke),alert("Une erreur est survenue lors de la suppression du plan")}finally{g.value=!1,y.value=null}}function pe(){g.value=!1,y.value=null}function Le(k){return new Date(k).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}function De(k){if(!k)return"";const ae=k.first_name||"",ke=k.last_name||"";return(ae.charAt(0)+ke.charAt(0)).toUpperCase()}async function N(k){M.value=!0,T.value=null;try{r.isAdmin&&!o.value.length&&await B();const ae=typeof k.entreprise=="object"&&k.entreprise?k.entreprise.id:k.entreprise,ke=typeof k.salarie=="object"&&k.salarie?k.salarie.id:k.salarie,Pe=typeof k.visiteur=="object"&&k.visiteur?k.visiteur.id:k.visiteur;_.value={id:k.id,nom:k.nom,description:k.description,entreprise:ae||null,salarie:ke||null,visiteur:Pe||null},ae&&await R(ae),ke&&await $(ke),d.value=!0}catch(ae){console.error("Erreur lors de l'ouverture du modal:",ae),T.value="Erreur lors du chargement des données"}finally{M.value=!1}}async function ee(){var k,ae,ke,Pe,Ge;T.value=null,M.value=!0;try{if(!_.value.nom.trim())throw new Error("Le nom du plan est requis");if(_.value.visiteur&&!_.value.salarie)throw new Error("Un salarie doit être sélectionné pour assigner un visiteur");if(_.value.salarie&&!_.value.entreprise)throw new Error("Une entreprise doit être sélectionnée pour assigner un salarie");console.log("Données envoyées pour la mise à jour:",{id:_.value.id,nom:_.value.nom.trim(),description:_.value.description.trim(),entreprise_id:_.value.entreprise,salarie_id:_.value.salarie,visiteur_id:_.value.visiteur});const K=await n.updatePlanDetails(_.value.id,{nom:_.value.nom.trim(),description:_.value.description.trim(),entreprise_id:_.value.entreprise,salarie_id:_.value.salarie,visiteur_id:_.value.visiteur});console.log("Réponse de la mise à jour:",K),K&&(d.value=!1,await F())}catch(K){if(console.error("Erreur lors de la mise à jour du plan:",K),(ae=(k=K.response)==null?void 0:k.data)!=null&&ae.detail)T.value=K.response.data.detail;else if((Pe=(ke=K.response)==null?void 0:ke.data)!=null&&Pe.non_field_errors)T.value=K.response.data.non_field_errors[0];else if((Ge=K.response)!=null&&Ge.data){const de=Object.entries(K.response.data).map(([ye,me])=>`${ye}: ${Array.isArray(me)?me[0]:me}`);T.value=de.join(`
`)}else T.value=K.message||"Une erreur est survenue lors de la mise à jour du plan"}finally{M.value=!1}}Co(()=>te.value,async k=>{D.value=null,I.value=null,k?await R(k):await R()}),Co(()=>D.value,async k=>{I.value=null,k&&await $(k)}),Co(()=>_.value.entreprise,async k=>{k===null?(_.value.salarie=null,_.value.visiteur=null):await R(k)}),Co(()=>_.value.salarie,async k=>{_.value.visiteur=null,k&&await $(k)});function fe(k){var Ge,K,de;const ae=r.user;if(!ae)return!1;if(ae.user_type==="admin")return!0;if(ae.user_type==="entreprise")return typeof k.entreprise=="object"?((Ge=k.entreprise)==null?void 0:Ge.id)===ae.id:k.entreprise===ae.id;if(ae.user_type==="salarie")return typeof k.salarie=="object"?((K=k.salarie)==null?void 0:K.id)===ae.id:k.salarie===ae.id;const ke=k.createur.id===ae.id;let Pe=!1;return typeof k.visiteur=="object"?Pe=((de=k.visiteur)==null?void 0:de.id)===ae.id:Pe=k.visiteur===ae.id,Pe||ke}async function ce(k){await F(),localStorage.setItem("lastPlanId",k.toString()),console.log(`Plan ${k} créé et défini comme plan actif`),t.push("/")}function _e(k){j.value===k?Z.value=Z.value==="asc"?"desc":"asc":(j.value=k,Z.value="desc")}function se(k){return k?Vl(k):""}return(k,ae)=>{var ke;return $e(),qe("div",Kz,[E("div",Yz,[E("div",Jz,[E("div",Xz,[E("h1",Qz,Wt(ge.value.title),1),E("p",e$,Wt(ge.value.description),1)]),E("div",{class:"mt-4 sm:mt-0 sm:ml-16 sm:flex-none"},[E("button",{onClick:W,class:"inline-flex items-center justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:w-auto"}," Nouveau plan ")])]),Wn(r).isAdmin?($e(),qe("div",t$,[E("div",n$,[ae[15]||(ae[15]=E("label",{for:"entreprise-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par entreprise",-1)),Fn(E("select",{id:"entreprise-filter","onUpdate:modelValue":ae[0]||(ae[0]=Pe=>te.value=Pe),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[ae[14]||(ae[14]=E("option",{value:null},"Toutes les entreprises",-1)),($e(!0),qe(Bn,null,Er(o.value,Pe=>($e(),qe("option",{key:Pe.id,value:Pe.id},Wt(se(Pe)),9,r$))),128))],512),[[uo,te.value]])]),E("div",i$,[ae[16]||(ae[16]=E("label",{for:"salarie-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par salarie",-1)),Fn(E("select",{id:"salarie-filter","onUpdate:modelValue":ae[1]||(ae[1]=Pe=>D.value=Pe),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[E("option",o$,Wt(H.value.length?"Tous les salaries":"Aucun salarie disponible"),1),($e(!0),qe(Bn,null,Er(H.value,Pe=>($e(),qe("option",{key:Pe.id,value:Pe.id},Wt(se(Pe)),9,s$))),128))],512),[[uo,D.value]])]),D.value?($e(),qe("div",a$,[ae[17]||(ae[17]=E("label",{for:"visiteur-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par visiteur",-1)),Fn(E("select",{id:"visiteur-filter","onUpdate:modelValue":ae[2]||(ae[2]=Pe=>I.value=Pe),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[E("option",l$,Wt(ue.value.length?"Tous les visiteurs":"Aucun visiteur disponible"),1),($e(!0),qe(Bn,null,Er(ue.value,Pe=>($e(),qe("option",{key:Pe.id,value:Pe.id},Wt(se(Pe)),9,u$))),128))],512),[[uo,I.value]])])):dn("",!0)])):Wn(r).isSalarie?($e(),qe("div",c$,[E("div",f$,[ae[19]||(ae[19]=E("label",{for:"visiteur-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par visiteur",-1)),Fn(E("select",{id:"visiteur-filter","onUpdate:modelValue":ae[3]||(ae[3]=Pe=>I.value=Pe),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[ae[18]||(ae[18]=E("option",{value:null},"Tous les visiteurs",-1)),($e(!0),qe(Bn,null,Er(u.value,Pe=>($e(),qe("option",{key:Pe.id,value:Pe.id},Wt(se(Pe)),9,h$))),128))],512),[[uo,I.value]])])])):dn("",!0),E("div",d$,[E("div",p$,[E("div",g$,[E("table",m$,[E("thead",v$,[E("tr",null,[E("th",y$,[E("button",{onClick:ae[4]||(ae[4]=Pe=>_e("nom")),class:"group inline-flex items-center"},[ae[21]||(ae[21]=Pi(" Nom ")),E("span",_$,[($e(),qe("svg",{class:Bi(["h-5 w-5",{"text-gray-900":j.value==="nom","text-gray-400":j.value!=="nom","rotate-180":j.value==="nom"&&Z.value==="asc"}]),viewBox:"0 0 20 20",fill:"currentColor"},ae[20]||(ae[20]=[E("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)]),2))])])]),ae[24]||(ae[24]=E("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Description ",-1)),ae[25]||(ae[25]=E("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Entreprise ",-1)),ae[26]||(ae[26]=E("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Salarie ",-1)),ae[27]||(ae[27]=E("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Visiteur ",-1)),E("th",b$,[E("button",{onClick:ae[5]||(ae[5]=Pe=>_e("date_modification")),class:"group inline-flex items-center"},[ae[23]||(ae[23]=Pi(" Dernière modification ")),E("span",w$,[($e(),qe("svg",{class:Bi(["h-5 w-5",{"text-gray-900":j.value==="date_modification","text-gray-400":j.value!=="date_modification","rotate-180":j.value==="date_modification"&&Z.value==="asc"}]),viewBox:"0 0 20 20",fill:"currentColor"},ae[22]||(ae[22]=[E("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)]),2))])])]),ae[28]||(ae[28]=E("th",{scope:"col",class:"relative py-3.5 pl-3 pr-4 sm:pr-6 lg:pr-8"},[E("span",{class:"sr-only"},"Actions")],-1))])]),E("tbody",x$,[le.value.length===0?($e(),qe("tr",L$,ae[29]||(ae[29]=[E("td",{colspan:"7",class:"py-4 px-6 text-center text-gray-500"}," Aucun plan disponible ",-1)]))):dn("",!0),($e(!0),qe(Bn,null,Er(le.value,Pe=>($e(),qe("tr",{key:Pe.id,class:"hover:bg-gray-50"},[E("td",S$,Wt(Pe.nom),1),E("td",C$,Wt(Pe.description||"-"),1),E("td",E$,[Pe.entreprise&&typeof Pe.entreprise=="object"?($e(),qe("div",P$,[E("div",M$,[E("div",A$,[E("span",k$,Wt(De(Pe.entreprise)),1)])]),E("div",T$,[E("div",N$,Wt(Wn(Vl)(Pe.entreprise)),1)])])):($e(),qe("div",D$," Non assigné "))]),E("td",I$,[Pe.salarie&&typeof Pe.salarie=="object"?($e(),qe("div",O$,[E("div",B$,[E("div",R$,[E("span",F$,Wt(De(Pe.salarie)),1)])]),E("div",j$,[E("div",z$,Wt(Wn(Vl)(Pe.salarie)),1)])])):($e(),qe("div",$$," Non assigné "))]),E("td",U$,[Pe.visiteur&&typeof Pe.visiteur=="object"?($e(),qe("div",V$,[E("div",G$,[E("div",H$,[E("span",q$,Wt(De(Pe.visiteur)),1)])]),E("div",W$,[E("div",Z$,Wt(Wn(Vl)(Pe.visiteur)),1)])])):($e(),qe("div",K$," Non assigné "))]),E("td",Y$,Wt(Le(Pe.date_modification)),1),E("td",J$,[E("button",{onClick:Ge=>G(Pe),class:"text-primary-600 hover:text-primary-900 mr-4"}," Ouvrir ",8,X$),E("button",{onClick:Ge=>N(Pe),class:"text-primary-600 hover:text-primary-900 mr-4"}," Modifier ",8,Q$),fe(Pe)?($e(),qe("button",{key:0,onClick:Ge=>J(Pe),class:"text-red-600 hover:text-red-900"}," Supprimer ",8,eU)):dn("",!0)])]))),128))])])])])]),hi(gx,{modelValue:f.value,"onUpdate:modelValue":ae[6]||(ae[6]=Pe=>f.value=Pe),salaries:s.value,clients:u.value,onCreated:ce},null,8,["modelValue","salaries","clients"]),d.value?($e(),qe("div",tU,[E("div",nU,[E("div",rU,[ae[31]||(ae[31]=E("h2",{class:"text-xl font-semibold text-gray-900"},"Modifier le plan",-1)),E("button",{onClick:ae[7]||(ae[7]=Pe=>d.value=!1),class:"text-gray-400 hover:text-gray-500 focus:outline-none"},ae[30]||(ae[30]=[E("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),E("form",{onSubmit:Sf(ee,["prevent"]),class:"space-y-4"},[E("div",null,[ae[32]||(ae[32]=E("label",{for:"edit-nom",class:"block text-sm font-medium text-gray-700"}," Nom ",-1)),Fn(E("input",{type:"text",id:"edit-nom","onUpdate:modelValue":ae[8]||(ae[8]=Pe=>_.value.nom=Pe),disabled:M.value,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",required:""},null,8,iU),[[ri,_.value.nom]])]),E("div",null,[ae[33]||(ae[33]=E("label",{for:"edit-description",class:"block text-sm font-medium text-gray-700"}," Description ",-1)),Fn(E("textarea",{id:"edit-description","onUpdate:modelValue":ae[9]||(ae[9]=Pe=>_.value.description=Pe),disabled:M.value,rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm disabled:bg-gray-100 disabled:cursor-not-allowed"},null,8,oU),[[ri,_.value.description]])]),Wn(r).isAdmin||((ke=Wn(r).user)==null?void 0:ke.user_type)==="entreprise"?($e(),qe("div",sU,[Wn(r).isAdmin?($e(),qe("div",aU,[ae[35]||(ae[35]=E("label",{for:"edit-entreprise",class:"block text-sm font-medium text-gray-700"}," Entreprise ",-1)),Fn(E("select",{id:"edit-entreprise","onUpdate:modelValue":ae[10]||(ae[10]=Pe=>_.value.entreprise=Pe),disabled:M.value,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed"},[ae[34]||(ae[34]=E("option",{value:null},"Sélectionner une entreprise",-1)),($e(!0),qe(Bn,null,Er(o.value,Pe=>($e(),qe("option",{key:Pe.id,value:Pe.id},Wt(se(Pe)),9,uU))),128))],8,lU),[[uo,_.value.entreprise]])])):dn("",!0),E("div",null,[ae[37]||(ae[37]=E("label",{for:"edit-salarie",class:"block text-sm font-medium text-gray-700"}," Salarie ",-1)),Fn(E("select",{id:"edit-salarie","onUpdate:modelValue":ae[11]||(ae[11]=Pe=>_.value.salarie=Pe),disabled:Wn(r).isAdmin&&!_.value.entreprise||M.value,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed"},[ae[36]||(ae[36]=E("option",{value:null},"Sélectionner un salarie",-1)),($e(!0),qe(Bn,null,Er(U.value,Pe=>($e(),qe("option",{key:Pe.id,value:Pe.id},Wt(se(Pe)),9,fU))),128))],8,cU),[[uo,_.value.salarie]]),Wn(r).isAdmin&&!_.value.entreprise?($e(),qe("p",hU," Veuillez d'abord sélectionner une entreprise ")):dn("",!0)]),E("div",null,[ae[39]||(ae[39]=E("label",{for:"edit-visiteur",class:"block text-sm font-medium text-gray-700"}," Visiteur ",-1)),Fn(E("select",{id:"edit-visiteur","onUpdate:modelValue":ae[12]||(ae[12]=Pe=>_.value.visiteur=Pe),disabled:!_.value.salarie||M.value,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed"},[ae[38]||(ae[38]=E("option",{value:null},"Sélectionner un visiteur",-1)),($e(!0),qe(Bn,null,Er(Q.value,Pe=>($e(),qe("option",{key:Pe.id,value:Pe.id},Wt(se(Pe)),9,pU))),128))],8,dU),[[uo,_.value.visiteur]]),_.value.salarie?dn("",!0):($e(),qe("p",gU," Veuillez d'abord sélectionner un salarie "))])])):dn("",!0),T.value?($e(),qe("div",mU,[E("div",vU,[ae[40]||(ae[40]=E("div",{class:"flex-shrink-0"},[E("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[E("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),E("div",yU,[E("p",_U,Wt(T.value),1)])])])):dn("",!0),E("div",bU,[E("button",{type:"button",class:"mt-3 inline-flex w-full justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-base font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:mt-0 sm:text-sm",onClick:ae[13]||(ae[13]=Pe=>d.value=!1)}," Annuler "),E("button",{type:"submit",disabled:M.value,class:"inline-flex w-full justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:text-sm disabled:opacity-50"},[M.value?($e(),qe("svg",xU,ae[41]||(ae[41]=[E("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),E("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):dn("",!0),Pi(" "+Wt(M.value?"Enregistrement...":"Enregistrer"),1)],8,wU)])],32)])])):dn("",!0),g.value?($e(),$a(Rx,{key:3,title:"Supprimer le plan",message:"Êtes-vous sûr de vouloir supprimer ce plan ? Cette action est irréversible.",onConfirm:Y,onCancel:pe})):dn("",!0)])])}}});var Fx={exports:{}};const SU=J5(v6);/**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Vb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function yc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Vb(Object(n),!0).forEach(function(r){CU(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Hg(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Hg=function(t){return typeof t}:Hg=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hg(e)}function CU(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yu(){return yu=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yu.apply(this,arguments)}function EU(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,s;for(s=0;s<r.length;s++)i=r[s],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function PU(e,t){if(e==null)return{};var n=EU(e,t),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)r=s[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function MU(e){return AU(e)||kU(e)||TU(e)||NU()}function AU(e){if(Array.isArray(e))return P1(e)}function kU(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function TU(e,t){if(e){if(typeof e=="string")return P1(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P1(e,t)}}function P1(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function NU(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var DU="1.14.0";function $c(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var qc=$c(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),jp=$c(/Edge/i),Gb=$c(/firefox/i),ap=$c(/safari/i)&&!$c(/chrome/i)&&!$c(/android/i),jx=$c(/iP(ad|od|hone)/i),IU=$c(/chrome/i)&&$c(/android/i),zx={capture:!1,passive:!1};function Ei(e,t,n){e.addEventListener(t,n,!qc&&zx)}function yi(e,t,n){e.removeEventListener(t,n,!qc&&zx)}function Lm(e,t){if(t){if(t[0]===">"&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch{return!1}return!1}}function OU(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function Fu(e,t,n,r){if(e){n=n||document;do{if(t!=null&&(t[0]===">"?e.parentNode===n&&Lm(e,t):Lm(e,t))||r&&e===n)return e;if(e===n)break}while(e=OU(e))}return null}var Hb=/\s+/g;function Jo(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var r=(" "+e.className+" ").replace(Hb," ").replace(" "+t+" "," ");e.className=(r+(n?" "+t:"")).replace(Hb," ")}}function rr(e,t,n){var r=e&&e.style;if(r){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),t===void 0?n:n[t];!(t in r)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),r[t]=n+(typeof n=="string"?"":"px")}}function nh(e,t){var n="";if(typeof e=="string")n=e;else do{var r=rr(e,"transform");r&&r!=="none"&&(n=r+" "+n)}while(!t&&(e=e.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(n)}function $x(e,t,n){if(e){var r=e.getElementsByTagName(t),i=0,s=r.length;if(n)for(;i<s;i++)n(r[i],i);return r}return[]}function gc(){var e=document.scrollingElement;return e||document.documentElement}function Bo(e,t,n,r,i){if(!(!e.getBoundingClientRect&&e!==window)){var s,o,u,f,d,g,y;if(e!==window&&e.parentNode&&e!==gc()?(s=e.getBoundingClientRect(),o=s.top,u=s.left,f=s.bottom,d=s.right,g=s.height,y=s.width):(o=0,u=0,f=window.innerHeight,d=window.innerWidth,g=window.innerHeight,y=window.innerWidth),(t||n)&&e!==window&&(i=i||e.parentNode,!qc))do if(i&&i.getBoundingClientRect&&(rr(i,"transform")!=="none"||n&&rr(i,"position")!=="static")){var x=i.getBoundingClientRect();o-=x.top+parseInt(rr(i,"border-top-width")),u-=x.left+parseInt(rr(i,"border-left-width")),f=o+s.height,d=u+s.width;break}while(i=i.parentNode);if(r&&e!==window){var _=nh(i||e),M=_&&_.a,T=_&&_.d;_&&(o/=T,u/=M,y/=M,g/=T,f=o+g,d=u+y)}return{top:o,left:u,bottom:f,right:d,width:y,height:g}}}function qb(e,t,n){for(var r=vf(e,!0),i=Bo(e)[t];r;){var s=Bo(r)[n],o=void 0;if(o=i>=s,!o)return r;if(r===gc())break;r=vf(r,!1)}return!1}function ld(e,t,n,r){for(var i=0,s=0,o=e.children;s<o.length;){if(o[s].style.display!=="none"&&o[s]!==Dr.ghost&&(r||o[s]!==Dr.dragged)&&Fu(o[s],n.draggable,e,!1)){if(i===t)return o[s];i++}s++}return null}function yy(e,t){for(var n=e.lastElementChild;n&&(n===Dr.ghost||rr(n,"display")==="none"||t&&!Lm(n,t));)n=n.previousElementSibling;return n||null}function us(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==Dr.clone&&(!t||Lm(e,t))&&n++;return n}function Wb(e){var t=0,n=0,r=gc();if(e)do{var i=nh(e),s=i.a,o=i.d;t+=e.scrollLeft*s,n+=e.scrollTop*o}while(e!==r&&(e=e.parentNode));return[t,n]}function BU(e,t){for(var n in e)if(e.hasOwnProperty(n)){for(var r in t)if(t.hasOwnProperty(r)&&t[r]===e[n][r])return Number(n)}return-1}function vf(e,t){if(!e||!e.getBoundingClientRect)return gc();var n=e,r=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var i=rr(n);if(n.clientWidth<n.scrollWidth&&(i.overflowX=="auto"||i.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(i.overflowY=="auto"||i.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return gc();if(r||t)return n;r=!0}}while(n=n.parentNode);return gc()}function RU(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function mv(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}var lp;function Ux(e,t){return function(){if(!lp){var n=arguments,r=this;n.length===1?e.call(r,n[0]):e.apply(r,n),lp=setTimeout(function(){lp=void 0},t)}}}function FU(){clearTimeout(lp),lp=void 0}function Vx(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function _y(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}function Zb(e,t){rr(e,"position","absolute"),rr(e,"top",t.top),rr(e,"left",t.left),rr(e,"width",t.width),rr(e,"height",t.height)}function vv(e){rr(e,"position",""),rr(e,"top",""),rr(e,"left",""),rr(e,"width",""),rr(e,"height","")}var ja="Sortable"+new Date().getTime();function jU(){var e=[],t;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var r=[].slice.call(this.el.children);r.forEach(function(i){if(!(rr(i,"display")==="none"||i===Dr.ghost)){e.push({target:i,rect:Bo(i)});var s=yc({},e[e.length-1].rect);if(i.thisAnimationDuration){var o=nh(i,!0);o&&(s.top-=o.f,s.left-=o.e)}i.fromRect=s}})}},addAnimationState:function(r){e.push(r)},removeAnimationState:function(r){e.splice(BU(e,{target:r}),1)},animateAll:function(r){var i=this;if(!this.options.animation){clearTimeout(t),typeof r=="function"&&r();return}var s=!1,o=0;e.forEach(function(u){var f=0,d=u.target,g=d.fromRect,y=Bo(d),x=d.prevFromRect,_=d.prevToRect,M=u.rect,T=nh(d,!0);T&&(y.top-=T.f,y.left-=T.e),d.toRect=y,d.thisAnimationDuration&&mv(x,y)&&!mv(g,y)&&(M.top-y.top)/(M.left-y.left)===(g.top-y.top)/(g.left-y.left)&&(f=$U(M,x,_,i.options)),mv(y,g)||(d.prevFromRect=g,d.prevToRect=y,f||(f=i.options.animation),i.animate(d,M,y,f)),f&&(s=!0,o=Math.max(o,f),clearTimeout(d.animationResetTimer),d.animationResetTimer=setTimeout(function(){d.animationTime=0,d.prevFromRect=null,d.fromRect=null,d.prevToRect=null,d.thisAnimationDuration=null},f),d.thisAnimationDuration=f)}),clearTimeout(t),s?t=setTimeout(function(){typeof r=="function"&&r()},o):typeof r=="function"&&r(),e=[]},animate:function(r,i,s,o){if(o){rr(r,"transition",""),rr(r,"transform","");var u=nh(this.el),f=u&&u.a,d=u&&u.d,g=(i.left-s.left)/(f||1),y=(i.top-s.top)/(d||1);r.animatingX=!!g,r.animatingY=!!y,rr(r,"transform","translate3d("+g+"px,"+y+"px,0)"),this.forRepaintDummy=zU(r),rr(r,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),rr(r,"transform","translate3d(0,0,0)"),typeof r.animated=="number"&&clearTimeout(r.animated),r.animated=setTimeout(function(){rr(r,"transition",""),rr(r,"transform",""),r.animated=!1,r.animatingX=!1,r.animatingY=!1},o)}}}}function zU(e){return e.offsetWidth}function $U(e,t,n,r){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*r.animation}var Th=[],yv={initializeByDefault:!0},zp={mount:function(t){for(var n in yv)yv.hasOwnProperty(n)&&!(n in t)&&(t[n]=yv[n]);Th.forEach(function(r){if(r.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),Th.push(t)},pluginEvent:function(t,n,r){var i=this;this.eventCanceled=!1,r.cancel=function(){i.eventCanceled=!0};var s=t+"Global";Th.forEach(function(o){n[o.pluginName]&&(n[o.pluginName][s]&&n[o.pluginName][s](yc({sortable:n},r)),n.options[o.pluginName]&&n[o.pluginName][t]&&n[o.pluginName][t](yc({sortable:n},r)))})},initializePlugins:function(t,n,r,i){Th.forEach(function(u){var f=u.pluginName;if(!(!t.options[f]&&!u.initializeByDefault)){var d=new u(t,n,t.options);d.sortable=t,d.options=t.options,t[f]=d,yu(r,d.defaults)}});for(var s in t.options)if(t.options.hasOwnProperty(s)){var o=this.modifyOption(t,s,t.options[s]);typeof o<"u"&&(t.options[s]=o)}},getEventProperties:function(t,n){var r={};return Th.forEach(function(i){typeof i.eventProperties=="function"&&yu(r,i.eventProperties.call(n[i.pluginName],t))}),r},modifyOption:function(t,n,r){var i;return Th.forEach(function(s){t[s.pluginName]&&s.optionListeners&&typeof s.optionListeners[n]=="function"&&(i=s.optionListeners[n].call(t[s.pluginName],r))}),i}};function Vd(e){var t=e.sortable,n=e.rootEl,r=e.name,i=e.targetEl,s=e.cloneEl,o=e.toEl,u=e.fromEl,f=e.oldIndex,d=e.newIndex,g=e.oldDraggableIndex,y=e.newDraggableIndex,x=e.originalEvent,_=e.putSortable,M=e.extraEventProperties;if(t=t||n&&n[ja],!!t){var T,D=t.options,I="on"+r.charAt(0).toUpperCase()+r.substr(1);window.CustomEvent&&!qc&&!jp?T=new CustomEvent(r,{bubbles:!0,cancelable:!0}):(T=document.createEvent("Event"),T.initEvent(r,!0,!0)),T.to=o||n,T.from=u||n,T.item=i||n,T.clone=s,T.oldIndex=f,T.newIndex=d,T.oldDraggableIndex=g,T.newDraggableIndex=y,T.originalEvent=x,T.pullMode=_?_.lastPutMode:void 0;var j=yc(yc({},M),zp.getEventProperties(r,t));for(var Z in j)T[Z]=j[Z];n&&n.dispatchEvent(T),D[I]&&D[I].call(t,T)}}var UU=["evt"],_l=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=r.evt,s=PU(r,UU);zp.pluginEvent.bind(Dr)(t,n,yc({dragEl:In,parentEl:ss,ghostEl:ii,rootEl:Oo,nextEl:Wf,lastDownEl:qg,cloneEl:as,cloneHidden:pf,dragStarted:Gd,putSortable:da,activeSortable:Dr.active,originalEvent:i,oldIndex:Vh,oldDraggableIndex:up,newIndex:Ul,newDraggableIndex:df,hideGhostForTarget:Wx,unhideGhostForTarget:Zx,cloneNowHidden:function(){pf=!0},cloneNowShown:function(){pf=!1},dispatchSortableEvent:function(u){Ja({sortable:n,name:u,originalEvent:i})}},s))};function Ja(e){Vd(yc({putSortable:da,cloneEl:as,targetEl:In,rootEl:Oo,oldIndex:Vh,oldDraggableIndex:up,newIndex:Ul,newDraggableIndex:df},e))}var In,ss,ii,Oo,Wf,qg,as,pf,Vh,Ul,up,df,Sg,da,zh=!1,Sm=!1,Cm=[],Gf,Iu,_v,bv,Kb,Yb,Gd,Nh,cp,fp=!1,Cg=!1,Wg,Ia,wv=[],M1=!1,Em=[],a0=typeof document<"u",Eg=jx,Jb=jp||qc?"cssFloat":"float",VU=a0&&!IU&&!jx&&"draggable"in document.createElement("div"),Gx=function(){if(a0){if(qc)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}}(),Hx=function(t,n){var r=rr(t),i=parseInt(r.width)-parseInt(r.paddingLeft)-parseInt(r.paddingRight)-parseInt(r.borderLeftWidth)-parseInt(r.borderRightWidth),s=ld(t,0,n),o=ld(t,1,n),u=s&&rr(s),f=o&&rr(o),d=u&&parseInt(u.marginLeft)+parseInt(u.marginRight)+Bo(s).width,g=f&&parseInt(f.marginLeft)+parseInt(f.marginRight)+Bo(o).width;if(r.display==="flex")return r.flexDirection==="column"||r.flexDirection==="column-reverse"?"vertical":"horizontal";if(r.display==="grid")return r.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(s&&u.float&&u.float!=="none"){var y=u.float==="left"?"left":"right";return o&&(f.clear==="both"||f.clear===y)?"vertical":"horizontal"}return s&&(u.display==="block"||u.display==="flex"||u.display==="table"||u.display==="grid"||d>=i&&r[Jb]==="none"||o&&r[Jb]==="none"&&d+g>i)?"vertical":"horizontal"},GU=function(t,n,r){var i=r?t.left:t.top,s=r?t.right:t.bottom,o=r?t.width:t.height,u=r?n.left:n.top,f=r?n.right:n.bottom,d=r?n.width:n.height;return i===u||s===f||i+o/2===u+d/2},HU=function(t,n){var r;return Cm.some(function(i){var s=i[ja].options.emptyInsertThreshold;if(!(!s||yy(i))){var o=Bo(i),u=t>=o.left-s&&t<=o.right+s,f=n>=o.top-s&&n<=o.bottom+s;if(u&&f)return r=i}}),r},qx=function(t){function n(s,o){return function(u,f,d,g){var y=u.options.group.name&&f.options.group.name&&u.options.group.name===f.options.group.name;if(s==null&&(o||y))return!0;if(s==null||s===!1)return!1;if(o&&s==="clone")return s;if(typeof s=="function")return n(s(u,f,d,g),o)(u,f,d,g);var x=(o?u:f).options.group.name;return s===!0||typeof s=="string"&&s===x||s.join&&s.indexOf(x)>-1}}var r={},i=t.group;(!i||Hg(i)!="object")&&(i={name:i}),r.name=i.name,r.checkPull=n(i.pull,!0),r.checkPut=n(i.put),r.revertClone=i.revertClone,t.group=r},Wx=function(){!Gx&&ii&&rr(ii,"display","none")},Zx=function(){!Gx&&ii&&rr(ii,"display","")};a0&&document.addEventListener("click",function(e){if(Sm)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Sm=!1,!1},!0);var Hf=function(t){if(In){t=t.touches?t.touches[0]:t;var n=HU(t.clientX,t.clientY);if(n){var r={};for(var i in t)t.hasOwnProperty(i)&&(r[i]=t[i]);r.target=r.rootEl=n,r.preventDefault=void 0,r.stopPropagation=void 0,n[ja]._onDragOver(r)}}},qU=function(t){In&&In.parentNode[ja]._isOutsideThisEl(t.target)};function Dr(e,t){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=yu({},t),e[ja]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Hx(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(o,u){o.setData("Text",u.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Dr.supportPointer!==!1&&"PointerEvent"in window&&!ap,emptyInsertThreshold:5};zp.initializePlugins(this,e,n);for(var r in n)!(r in t)&&(t[r]=n[r]);qx(t);for(var i in this)i.charAt(0)==="_"&&typeof this[i]=="function"&&(this[i]=this[i].bind(this));this.nativeDraggable=t.forceFallback?!1:VU,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?Ei(e,"pointerdown",this._onTapStart):(Ei(e,"mousedown",this._onTapStart),Ei(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(Ei(e,"dragover",this),Ei(e,"dragenter",this)),Cm.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),yu(this,jU())}Dr.prototype={constructor:Dr,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(Nh=null)},_getDirection:function(t,n){return typeof this.options.direction=="function"?this.options.direction.call(this,t,n,In):this.options.direction},_onTapStart:function(t){if(t.cancelable){var n=this,r=this.el,i=this.options,s=i.preventOnFilter,o=t.type,u=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,f=(u||t).target,d=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||f,g=i.filter;if(eV(r),!In&&!(/mousedown|pointerdown/.test(o)&&t.button!==0||i.disabled)&&!d.isContentEditable&&!(!this.nativeDraggable&&ap&&f&&f.tagName.toUpperCase()==="SELECT")&&(f=Fu(f,i.draggable,r,!1),!(f&&f.animated)&&qg!==f)){if(Vh=us(f),up=us(f,i.draggable),typeof g=="function"){if(g.call(this,t,f,this)){Ja({sortable:n,rootEl:d,name:"filter",targetEl:f,toEl:r,fromEl:r}),_l("filter",n,{evt:t}),s&&t.cancelable&&t.preventDefault();return}}else if(g&&(g=g.split(",").some(function(y){if(y=Fu(d,y.trim(),r,!1),y)return Ja({sortable:n,rootEl:y,name:"filter",targetEl:f,fromEl:r,toEl:r}),_l("filter",n,{evt:t}),!0}),g)){s&&t.cancelable&&t.preventDefault();return}i.handle&&!Fu(d,i.handle,r,!1)||this._prepareDragStart(t,u,f)}}},_prepareDragStart:function(t,n,r){var i=this,s=i.el,o=i.options,u=s.ownerDocument,f;if(r&&!In&&r.parentNode===s){var d=Bo(r);if(Oo=s,In=r,ss=In.parentNode,Wf=In.nextSibling,qg=r,Sg=o.group,Dr.dragged=In,Gf={target:In,clientX:(n||t).clientX,clientY:(n||t).clientY},Kb=Gf.clientX-d.left,Yb=Gf.clientY-d.top,this._lastX=(n||t).clientX,this._lastY=(n||t).clientY,In.style["will-change"]="all",f=function(){if(_l("delayEnded",i,{evt:t}),Dr.eventCanceled){i._onDrop();return}i._disableDelayedDragEvents(),!Gb&&i.nativeDraggable&&(In.draggable=!0),i._triggerDragStart(t,n),Ja({sortable:i,name:"choose",originalEvent:t}),Jo(In,o.chosenClass,!0)},o.ignore.split(",").forEach(function(g){$x(In,g.trim(),xv)}),Ei(u,"dragover",Hf),Ei(u,"mousemove",Hf),Ei(u,"touchmove",Hf),Ei(u,"mouseup",i._onDrop),Ei(u,"touchend",i._onDrop),Ei(u,"touchcancel",i._onDrop),Gb&&this.nativeDraggable&&(this.options.touchStartThreshold=4,In.draggable=!0),_l("delayStart",this,{evt:t}),o.delay&&(!o.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(jp||qc))){if(Dr.eventCanceled){this._onDrop();return}Ei(u,"mouseup",i._disableDelayedDrag),Ei(u,"touchend",i._disableDelayedDrag),Ei(u,"touchcancel",i._disableDelayedDrag),Ei(u,"mousemove",i._delayedDragTouchMoveHandler),Ei(u,"touchmove",i._delayedDragTouchMoveHandler),o.supportPointer&&Ei(u,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(f,o.delay)}else f()}},_delayedDragTouchMoveHandler:function(t){var n=t.touches?t.touches[0]:t;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){In&&xv(In),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;yi(t,"mouseup",this._disableDelayedDrag),yi(t,"touchend",this._disableDelayedDrag),yi(t,"touchcancel",this._disableDelayedDrag),yi(t,"mousemove",this._delayedDragTouchMoveHandler),yi(t,"touchmove",this._delayedDragTouchMoveHandler),yi(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,n){n=n||t.pointerType=="touch"&&t,!this.nativeDraggable||n?this.options.supportPointer?Ei(document,"pointermove",this._onTouchMove):n?Ei(document,"touchmove",this._onTouchMove):Ei(document,"mousemove",this._onTouchMove):(Ei(In,"dragend",this),Ei(Oo,"dragstart",this._onDragStart));try{document.selection?Zg(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,n){if(zh=!1,Oo&&In){_l("dragStarted",this,{evt:n}),this.nativeDraggable&&Ei(document,"dragover",qU);var r=this.options;!t&&Jo(In,r.dragClass,!1),Jo(In,r.ghostClass,!0),Dr.active=this,t&&this._appendGhost(),Ja({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(Iu){this._lastX=Iu.clientX,this._lastY=Iu.clientY,Wx();for(var t=document.elementFromPoint(Iu.clientX,Iu.clientY),n=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(Iu.clientX,Iu.clientY),t!==n);)n=t;if(In.parentNode[ja]._isOutsideThisEl(t),n)do{if(n[ja]){var r=void 0;if(r=n[ja]._onDragOver({clientX:Iu.clientX,clientY:Iu.clientY,target:t,rootEl:n}),r&&!this.options.dragoverBubble)break}t=n}while(n=n.parentNode);Zx()}},_onTouchMove:function(t){if(Gf){var n=this.options,r=n.fallbackTolerance,i=n.fallbackOffset,s=t.touches?t.touches[0]:t,o=ii&&nh(ii,!0),u=ii&&o&&o.a,f=ii&&o&&o.d,d=Eg&&Ia&&Wb(Ia),g=(s.clientX-Gf.clientX+i.x)/(u||1)+(d?d[0]-wv[0]:0)/(u||1),y=(s.clientY-Gf.clientY+i.y)/(f||1)+(d?d[1]-wv[1]:0)/(f||1);if(!Dr.active&&!zh){if(r&&Math.max(Math.abs(s.clientX-this._lastX),Math.abs(s.clientY-this._lastY))<r)return;this._onDragStart(t,!0)}if(ii){o?(o.e+=g-(_v||0),o.f+=y-(bv||0)):o={a:1,b:0,c:0,d:1,e:g,f:y};var x="matrix(".concat(o.a,",").concat(o.b,",").concat(o.c,",").concat(o.d,",").concat(o.e,",").concat(o.f,")");rr(ii,"webkitTransform",x),rr(ii,"mozTransform",x),rr(ii,"msTransform",x),rr(ii,"transform",x),_v=g,bv=y,Iu=s}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!ii){var t=this.options.fallbackOnBody?document.body:Oo,n=Bo(In,!0,Eg,!0,t),r=this.options;if(Eg){for(Ia=t;rr(Ia,"position")==="static"&&rr(Ia,"transform")==="none"&&Ia!==document;)Ia=Ia.parentNode;Ia!==document.body&&Ia!==document.documentElement?(Ia===document&&(Ia=gc()),n.top+=Ia.scrollTop,n.left+=Ia.scrollLeft):Ia=gc(),wv=Wb(Ia)}ii=In.cloneNode(!0),Jo(ii,r.ghostClass,!1),Jo(ii,r.fallbackClass,!0),Jo(ii,r.dragClass,!0),rr(ii,"transition",""),rr(ii,"transform",""),rr(ii,"box-sizing","border-box"),rr(ii,"margin",0),rr(ii,"top",n.top),rr(ii,"left",n.left),rr(ii,"width",n.width),rr(ii,"height",n.height),rr(ii,"opacity","0.8"),rr(ii,"position",Eg?"absolute":"fixed"),rr(ii,"zIndex","100000"),rr(ii,"pointerEvents","none"),Dr.ghost=ii,t.appendChild(ii),rr(ii,"transform-origin",Kb/parseInt(ii.style.width)*100+"% "+Yb/parseInt(ii.style.height)*100+"%")}},_onDragStart:function(t,n){var r=this,i=t.dataTransfer,s=r.options;if(_l("dragStart",this,{evt:t}),Dr.eventCanceled){this._onDrop();return}_l("setupClone",this),Dr.eventCanceled||(as=_y(In),as.draggable=!1,as.style["will-change"]="",this._hideClone(),Jo(as,this.options.chosenClass,!1),Dr.clone=as),r.cloneId=Zg(function(){_l("clone",r),!Dr.eventCanceled&&(r.options.removeCloneOnHide||Oo.insertBefore(as,In),r._hideClone(),Ja({sortable:r,name:"clone"}))}),!n&&Jo(In,s.dragClass,!0),n?(Sm=!0,r._loopId=setInterval(r._emulateDragOver,50)):(yi(document,"mouseup",r._onDrop),yi(document,"touchend",r._onDrop),yi(document,"touchcancel",r._onDrop),i&&(i.effectAllowed="move",s.setData&&s.setData.call(r,i,In)),Ei(document,"drop",r),rr(In,"transform","translateZ(0)")),zh=!0,r._dragStartId=Zg(r._dragStarted.bind(r,n,t)),Ei(document,"selectstart",r),Gd=!0,ap&&rr(document.body,"user-select","none")},_onDragOver:function(t){var n=this.el,r=t.target,i,s,o,u=this.options,f=u.group,d=Dr.active,g=Sg===f,y=u.sort,x=da||d,_,M=this,T=!1;if(M1)return;function D(Y,pe){_l(Y,M,yc({evt:t,isOwner:g,axis:_?"vertical":"horizontal",revert:o,dragRect:i,targetRect:s,canSort:y,fromSortable:x,target:r,completed:j,onMove:function(De,N){return Pg(Oo,n,In,i,De,Bo(De),t,N)},changed:Z},pe))}function I(){D("dragOverAnimationCapture"),M.captureAnimationState(),M!==x&&x.captureAnimationState()}function j(Y){return D("dragOverCompleted",{insertion:Y}),Y&&(g?d._hideClone():d._showClone(M),M!==x&&(Jo(In,da?da.options.ghostClass:d.options.ghostClass,!1),Jo(In,u.ghostClass,!0)),da!==M&&M!==Dr.active?da=M:M===Dr.active&&da&&(da=null),x===M&&(M._ignoreWhileAnimating=r),M.animateAll(function(){D("dragOverAnimationComplete"),M._ignoreWhileAnimating=null}),M!==x&&(x.animateAll(),x._ignoreWhileAnimating=null)),(r===In&&!In.animated||r===n&&!r.animated)&&(Nh=null),!u.dragoverBubble&&!t.rootEl&&r!==document&&(In.parentNode[ja]._isOutsideThisEl(t.target),!Y&&Hf(t)),!u.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),T=!0}function Z(){Ul=us(In),df=us(In,u.draggable),Ja({sortable:M,name:"change",toEl:n,newIndex:Ul,newDraggableIndex:df,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),r=Fu(r,u.draggable,n,!0),D("dragOver"),Dr.eventCanceled)return T;if(In.contains(t.target)||r.animated&&r.animatingX&&r.animatingY||M._ignoreWhileAnimating===r)return j(!1);if(Sm=!1,d&&!u.disabled&&(g?y||(o=ss!==Oo):da===this||(this.lastPutMode=Sg.checkPull(this,d,In,t))&&f.checkPut(this,d,In,t))){if(_=this._getDirection(t,r)==="vertical",i=Bo(In),D("dragOverValid"),Dr.eventCanceled)return T;if(o)return ss=Oo,I(),this._hideClone(),D("revert"),Dr.eventCanceled||(Wf?Oo.insertBefore(In,Wf):Oo.appendChild(In)),j(!0);var te=yy(n,u.draggable);if(!te||YU(t,_,this)&&!te.animated){if(te===In)return j(!1);if(te&&n===t.target&&(r=te),r&&(s=Bo(r)),Pg(Oo,n,In,i,r,s,t,!!r)!==!1)return I(),n.appendChild(In),ss=n,Z(),j(!0)}else if(te&&KU(t,_,this)){var ue=ld(n,0,u,!0);if(ue===In)return j(!1);if(r=ue,s=Bo(r),Pg(Oo,n,In,i,r,s,t,!1)!==!1)return I(),n.insertBefore(In,ue),ss=n,Z(),j(!0)}else if(r.parentNode===n){s=Bo(r);var le=0,ge,H=In.parentNode!==n,U=!GU(In.animated&&In.toRect||i,r.animated&&r.toRect||s,_),Q=_?"top":"left",F=qb(r,"top","top")||qb(In,"top","top"),B=F?F.scrollTop:void 0;Nh!==r&&(ge=s[Q],fp=!1,Cg=!U&&u.invertSwap||H),le=JU(t,r,s,_,U?1:u.swapThreshold,u.invertedSwapThreshold==null?u.swapThreshold:u.invertedSwapThreshold,Cg,Nh===r);var R;if(le!==0){var $=us(In);do $-=le,R=ss.children[$];while(R&&(rr(R,"display")==="none"||R===ii))}if(le===0||R===r)return j(!1);Nh=r,cp=le;var W=r.nextElementSibling,G=!1;G=le===1;var J=Pg(Oo,n,In,i,r,s,t,G);if(J!==!1)return(J===1||J===-1)&&(G=J===1),M1=!0,setTimeout(ZU,30),I(),G&&!W?n.appendChild(In):r.parentNode.insertBefore(In,G?W:r),F&&Vx(F,0,B-F.scrollTop),ss=In.parentNode,ge!==void 0&&!Cg&&(Wg=Math.abs(ge-Bo(r)[Q])),Z(),j(!0)}if(n.contains(In))return j(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){yi(document,"mousemove",this._onTouchMove),yi(document,"touchmove",this._onTouchMove),yi(document,"pointermove",this._onTouchMove),yi(document,"dragover",Hf),yi(document,"mousemove",Hf),yi(document,"touchmove",Hf)},_offUpEvents:function(){var t=this.el.ownerDocument;yi(t,"mouseup",this._onDrop),yi(t,"touchend",this._onDrop),yi(t,"pointerup",this._onDrop),yi(t,"touchcancel",this._onDrop),yi(document,"selectstart",this)},_onDrop:function(t){var n=this.el,r=this.options;if(Ul=us(In),df=us(In,r.draggable),_l("drop",this,{evt:t}),ss=In&&In.parentNode,Ul=us(In),df=us(In,r.draggable),Dr.eventCanceled){this._nulling();return}zh=!1,Cg=!1,fp=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),A1(this.cloneId),A1(this._dragStartId),this.nativeDraggable&&(yi(document,"drop",this),yi(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),ap&&rr(document.body,"user-select",""),rr(In,"transform",""),t&&(Gd&&(t.cancelable&&t.preventDefault(),!r.dropBubble&&t.stopPropagation()),ii&&ii.parentNode&&ii.parentNode.removeChild(ii),(Oo===ss||da&&da.lastPutMode!=="clone")&&as&&as.parentNode&&as.parentNode.removeChild(as),In&&(this.nativeDraggable&&yi(In,"dragend",this),xv(In),In.style["will-change"]="",Gd&&!zh&&Jo(In,da?da.options.ghostClass:this.options.ghostClass,!1),Jo(In,this.options.chosenClass,!1),Ja({sortable:this,name:"unchoose",toEl:ss,newIndex:null,newDraggableIndex:null,originalEvent:t}),Oo!==ss?(Ul>=0&&(Ja({rootEl:ss,name:"add",toEl:ss,fromEl:Oo,originalEvent:t}),Ja({sortable:this,name:"remove",toEl:ss,originalEvent:t}),Ja({rootEl:ss,name:"sort",toEl:ss,fromEl:Oo,originalEvent:t}),Ja({sortable:this,name:"sort",toEl:ss,originalEvent:t})),da&&da.save()):Ul!==Vh&&Ul>=0&&(Ja({sortable:this,name:"update",toEl:ss,originalEvent:t}),Ja({sortable:this,name:"sort",toEl:ss,originalEvent:t})),Dr.active&&((Ul==null||Ul===-1)&&(Ul=Vh,df=up),Ja({sortable:this,name:"end",toEl:ss,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){_l("nulling",this),Oo=In=ss=ii=Wf=as=qg=pf=Gf=Iu=Gd=Ul=df=Vh=up=Nh=cp=da=Sg=Dr.dragged=Dr.ghost=Dr.clone=Dr.active=null,Em.forEach(function(t){t.checked=!0}),Em.length=_v=bv=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":In&&(this._onDragOver(t),WU(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],n,r=this.el.children,i=0,s=r.length,o=this.options;i<s;i++)n=r[i],Fu(n,o.draggable,this.el,!1)&&t.push(n.getAttribute(o.dataIdAttr)||QU(n));return t},sort:function(t,n){var r={},i=this.el;this.toArray().forEach(function(s,o){var u=i.children[o];Fu(u,this.options.draggable,i,!1)&&(r[s]=u)},this),n&&this.captureAnimationState(),t.forEach(function(s){r[s]&&(i.removeChild(r[s]),i.appendChild(r[s]))}),n&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,n){return Fu(t,n||this.options.draggable,this.el,!1)},option:function(t,n){var r=this.options;if(n===void 0)return r[t];var i=zp.modifyOption(this,t,n);typeof i<"u"?r[t]=i:r[t]=n,t==="group"&&qx(r)},destroy:function(){_l("destroy",this);var t=this.el;t[ja]=null,yi(t,"mousedown",this._onTapStart),yi(t,"touchstart",this._onTapStart),yi(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(yi(t,"dragover",this),yi(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Cm.splice(Cm.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!pf){if(_l("hideClone",this),Dr.eventCanceled)return;rr(as,"display","none"),this.options.removeCloneOnHide&&as.parentNode&&as.parentNode.removeChild(as),pf=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(pf){if(_l("showClone",this),Dr.eventCanceled)return;In.parentNode==Oo&&!this.options.group.revertClone?Oo.insertBefore(as,In):Wf?Oo.insertBefore(as,Wf):Oo.appendChild(as),this.options.group.revertClone&&this.animate(In,as),rr(as,"display",""),pf=!1}}};function WU(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function Pg(e,t,n,r,i,s,o,u){var f,d=e[ja],g=d.options.onMove,y;return window.CustomEvent&&!qc&&!jp?f=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(f=document.createEvent("Event"),f.initEvent("move",!0,!0)),f.to=t,f.from=e,f.dragged=n,f.draggedRect=r,f.related=i||t,f.relatedRect=s||Bo(t),f.willInsertAfter=u,f.originalEvent=o,e.dispatchEvent(f),g&&(y=g.call(d,f,o)),y}function xv(e){e.draggable=!1}function ZU(){M1=!1}function KU(e,t,n){var r=Bo(ld(n.el,0,n.options,!0)),i=10;return t?e.clientX<r.left-i||e.clientY<r.top&&e.clientX<r.right:e.clientY<r.top-i||e.clientY<r.bottom&&e.clientX<r.left}function YU(e,t,n){var r=Bo(yy(n.el,n.options.draggable)),i=10;return t?e.clientX>r.right+i||e.clientX<=r.right&&e.clientY>r.bottom&&e.clientX>=r.left:e.clientX>r.right&&e.clientY>r.top||e.clientX<=r.right&&e.clientY>r.bottom+i}function JU(e,t,n,r,i,s,o,u){var f=r?e.clientY:e.clientX,d=r?n.height:n.width,g=r?n.top:n.left,y=r?n.bottom:n.right,x=!1;if(!o){if(u&&Wg<d*i){if(!fp&&(cp===1?f>g+d*s/2:f<y-d*s/2)&&(fp=!0),fp)x=!0;else if(cp===1?f<g+Wg:f>y-Wg)return-cp}else if(f>g+d*(1-i)/2&&f<y-d*(1-i)/2)return XU(t)}return x=x||o,x&&(f<g+d*s/2||f>y-d*s/2)?f>g+d/2?1:-1:0}function XU(e){return us(In)<us(e)?1:-1}function QU(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,r=0;n--;)r+=t.charCodeAt(n);return r.toString(36)}function eV(e){Em.length=0;for(var t=e.getElementsByTagName("input"),n=t.length;n--;){var r=t[n];r.checked&&Em.push(r)}}function Zg(e){return setTimeout(e,0)}function A1(e){return clearTimeout(e)}a0&&Ei(document,"touchmove",function(e){(Dr.active||zh)&&e.cancelable&&e.preventDefault()});Dr.utils={on:Ei,off:yi,css:rr,find:$x,is:function(t,n){return!!Fu(t,n,t,!1)},extend:RU,throttle:Ux,closest:Fu,toggleClass:Jo,clone:_y,index:us,nextTick:Zg,cancelNextTick:A1,detectDirection:Hx,getChild:ld};Dr.get=function(e){return e[ja]};Dr.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach(function(r){if(!r.prototype||!r.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(r));r.utils&&(Dr.utils=yc(yc({},Dr.utils),r.utils)),zp.mount(r)})};Dr.create=function(e,t){return new Dr(e,t)};Dr.version=DU;var Ts=[],Hd,k1,T1=!1,Lv,Sv,Pm,qd;function tV(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return e.prototype={dragStarted:function(n){var r=n.originalEvent;this.sortable.nativeDraggable?Ei(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Ei(document,"pointermove",this._handleFallbackAutoScroll):r.touches?Ei(document,"touchmove",this._handleFallbackAutoScroll):Ei(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var r=n.originalEvent;!this.options.dragOverBubble&&!r.rootEl&&this._handleAutoScroll(r)},drop:function(){this.sortable.nativeDraggable?yi(document,"dragover",this._handleAutoScroll):(yi(document,"pointermove",this._handleFallbackAutoScroll),yi(document,"touchmove",this._handleFallbackAutoScroll),yi(document,"mousemove",this._handleFallbackAutoScroll)),Xb(),Kg(),FU()},nulling:function(){Pm=k1=Hd=T1=qd=Lv=Sv=null,Ts.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,r){var i=this,s=(n.touches?n.touches[0]:n).clientX,o=(n.touches?n.touches[0]:n).clientY,u=document.elementFromPoint(s,o);if(Pm=n,r||this.options.forceAutoScrollFallback||jp||qc||ap){Cv(n,this.options,u,r);var f=vf(u,!0);T1&&(!qd||s!==Lv||o!==Sv)&&(qd&&Xb(),qd=setInterval(function(){var d=vf(document.elementFromPoint(s,o),!0);d!==f&&(f=d,Kg()),Cv(n,i.options,d,r)},10),Lv=s,Sv=o)}else{if(!this.options.bubbleScroll||vf(u,!0)===gc()){Kg();return}Cv(n,this.options,vf(u,!1),!1)}}},yu(e,{pluginName:"scroll",initializeByDefault:!0})}function Kg(){Ts.forEach(function(e){clearInterval(e.pid)}),Ts=[]}function Xb(){clearInterval(qd)}var Cv=Ux(function(e,t,n,r){if(t.scroll){var i=(e.touches?e.touches[0]:e).clientX,s=(e.touches?e.touches[0]:e).clientY,o=t.scrollSensitivity,u=t.scrollSpeed,f=gc(),d=!1,g;k1!==n&&(k1=n,Kg(),Hd=t.scroll,g=t.scrollFn,Hd===!0&&(Hd=vf(n,!0)));var y=0,x=Hd;do{var _=x,M=Bo(_),T=M.top,D=M.bottom,I=M.left,j=M.right,Z=M.width,te=M.height,ue=void 0,le=void 0,ge=_.scrollWidth,H=_.scrollHeight,U=rr(_),Q=_.scrollLeft,F=_.scrollTop;_===f?(ue=Z<ge&&(U.overflowX==="auto"||U.overflowX==="scroll"||U.overflowX==="visible"),le=te<H&&(U.overflowY==="auto"||U.overflowY==="scroll"||U.overflowY==="visible")):(ue=Z<ge&&(U.overflowX==="auto"||U.overflowX==="scroll"),le=te<H&&(U.overflowY==="auto"||U.overflowY==="scroll"));var B=ue&&(Math.abs(j-i)<=o&&Q+Z<ge)-(Math.abs(I-i)<=o&&!!Q),R=le&&(Math.abs(D-s)<=o&&F+te<H)-(Math.abs(T-s)<=o&&!!F);if(!Ts[y])for(var $=0;$<=y;$++)Ts[$]||(Ts[$]={});(Ts[y].vx!=B||Ts[y].vy!=R||Ts[y].el!==_)&&(Ts[y].el=_,Ts[y].vx=B,Ts[y].vy=R,clearInterval(Ts[y].pid),(B!=0||R!=0)&&(d=!0,Ts[y].pid=setInterval((function(){r&&this.layer===0&&Dr.active._onTouchMove(Pm);var W=Ts[this.layer].vy?Ts[this.layer].vy*u:0,G=Ts[this.layer].vx?Ts[this.layer].vx*u:0;typeof g=="function"&&g.call(Dr.dragged.parentNode[ja],G,W,e,Pm,Ts[this.layer].el)!=="continue"||Vx(Ts[this.layer].el,G,W)}).bind({layer:y}),24))),y++}while(t.bubbleScroll&&x!==f&&(x=vf(x,!1)));T1=d}},30),Kx=function(t){var n=t.originalEvent,r=t.putSortable,i=t.dragEl,s=t.activeSortable,o=t.dispatchSortableEvent,u=t.hideGhostForTarget,f=t.unhideGhostForTarget;if(n){var d=r||s;u();var g=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,y=document.elementFromPoint(g.clientX,g.clientY);f(),d&&!d.el.contains(y)&&(o("spill"),this.onSpill({dragEl:i,putSortable:r}))}};function by(){}by.prototype={startIndex:null,dragStart:function(t){var n=t.oldDraggableIndex;this.startIndex=n},onSpill:function(t){var n=t.dragEl,r=t.putSortable;this.sortable.captureAnimationState(),r&&r.captureAnimationState();var i=ld(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(n,i):this.sortable.el.appendChild(n),this.sortable.animateAll(),r&&r.animateAll()},drop:Kx};yu(by,{pluginName:"revertOnSpill"});function wy(){}wy.prototype={onSpill:function(t){var n=t.dragEl,r=t.putSortable,i=r||this.sortable;i.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),i.animateAll()},drop:Kx};yu(wy,{pluginName:"removeOnSpill"});var uu;function nV(){function e(){this.defaults={swapClass:"sortable-swap-highlight"}}return e.prototype={dragStart:function(n){var r=n.dragEl;uu=r},dragOverValid:function(n){var r=n.completed,i=n.target,s=n.onMove,o=n.activeSortable,u=n.changed,f=n.cancel;if(o.options.swap){var d=this.sortable.el,g=this.options;if(i&&i!==d){var y=uu;s(i)!==!1?(Jo(i,g.swapClass,!0),uu=i):uu=null,y&&y!==uu&&Jo(y,g.swapClass,!1)}u(),r(!0),f()}},drop:function(n){var r=n.activeSortable,i=n.putSortable,s=n.dragEl,o=i||this.sortable,u=this.options;uu&&Jo(uu,u.swapClass,!1),uu&&(u.swap||i&&i.options.swap)&&s!==uu&&(o.captureAnimationState(),o!==r&&r.captureAnimationState(),rV(s,uu),o.animateAll(),o!==r&&r.animateAll())},nulling:function(){uu=null}},yu(e,{pluginName:"swap",eventProperties:function(){return{swapItem:uu}}})}function rV(e,t){var n=e.parentNode,r=t.parentNode,i,s;!n||!r||n.isEqualNode(t)||r.isEqualNode(e)||(i=us(e),s=us(t),n.isEqualNode(r)&&i<s&&s++,n.insertBefore(t,n.children[i]),r.insertBefore(e,r.children[s]))}var Wr=[],$l=[],Dd,Ou,Id=!1,bl=!1,Dh=!1,vo,Od,Mg;function iV(){function e(t){for(var n in this)n.charAt(0)==="_"&&typeof this[n]=="function"&&(this[n]=this[n].bind(this));t.options.supportPointer?Ei(document,"pointerup",this._deselectMultiDrag):(Ei(document,"mouseup",this._deselectMultiDrag),Ei(document,"touchend",this._deselectMultiDrag)),Ei(document,"keydown",this._checkKeyDown),Ei(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(i,s){var o="";Wr.length&&Ou===t?Wr.forEach(function(u,f){o+=(f?", ":"")+u.textContent}):o=s.textContent,i.setData("Text",o)}}}return e.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(n){var r=n.dragEl;vo=r},delayEnded:function(){this.isMultiDrag=~Wr.indexOf(vo)},setupClone:function(n){var r=n.sortable,i=n.cancel;if(this.isMultiDrag){for(var s=0;s<Wr.length;s++)$l.push(_y(Wr[s])),$l[s].sortableIndex=Wr[s].sortableIndex,$l[s].draggable=!1,$l[s].style["will-change"]="",Jo($l[s],this.options.selectedClass,!1),Wr[s]===vo&&Jo($l[s],this.options.chosenClass,!1);r._hideClone(),i()}},clone:function(n){var r=n.sortable,i=n.rootEl,s=n.dispatchSortableEvent,o=n.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||Wr.length&&Ou===r&&(Qb(!0,i),s("clone"),o()))},showClone:function(n){var r=n.cloneNowShown,i=n.rootEl,s=n.cancel;this.isMultiDrag&&(Qb(!1,i),$l.forEach(function(o){rr(o,"display","")}),r(),Mg=!1,s())},hideClone:function(n){var r=this;n.sortable;var i=n.cloneNowHidden,s=n.cancel;this.isMultiDrag&&($l.forEach(function(o){rr(o,"display","none"),r.options.removeCloneOnHide&&o.parentNode&&o.parentNode.removeChild(o)}),i(),Mg=!0,s())},dragStartGlobal:function(n){n.sortable,!this.isMultiDrag&&Ou&&Ou.multiDrag._deselectMultiDrag(),Wr.forEach(function(r){r.sortableIndex=us(r)}),Wr=Wr.sort(function(r,i){return r.sortableIndex-i.sortableIndex}),Dh=!0},dragStarted:function(n){var r=this,i=n.sortable;if(this.isMultiDrag){if(this.options.sort&&(i.captureAnimationState(),this.options.animation)){Wr.forEach(function(o){o!==vo&&rr(o,"position","absolute")});var s=Bo(vo,!1,!0,!0);Wr.forEach(function(o){o!==vo&&Zb(o,s)}),bl=!0,Id=!0}i.animateAll(function(){bl=!1,Id=!1,r.options.animation&&Wr.forEach(function(o){vv(o)}),r.options.sort&&Ag()})}},dragOver:function(n){var r=n.target,i=n.completed,s=n.cancel;bl&&~Wr.indexOf(r)&&(i(!1),s())},revert:function(n){var r=n.fromSortable,i=n.rootEl,s=n.sortable,o=n.dragRect;Wr.length>1&&(Wr.forEach(function(u){s.addAnimationState({target:u,rect:bl?Bo(u):o}),vv(u),u.fromRect=o,r.removeAnimationState(u)}),bl=!1,oV(!this.options.removeCloneOnHide,i))},dragOverCompleted:function(n){var r=n.sortable,i=n.isOwner,s=n.insertion,o=n.activeSortable,u=n.parentEl,f=n.putSortable,d=this.options;if(s){if(i&&o._hideClone(),Id=!1,d.animation&&Wr.length>1&&(bl||!i&&!o.options.sort&&!f)){var g=Bo(vo,!1,!0,!0);Wr.forEach(function(x){x!==vo&&(Zb(x,g),u.appendChild(x))}),bl=!0}if(!i)if(bl||Ag(),Wr.length>1){var y=Mg;o._showClone(r),o.options.animation&&!Mg&&y&&$l.forEach(function(x){o.addAnimationState({target:x,rect:Od}),x.fromRect=Od,x.thisAnimationDuration=null})}else o._showClone(r)}},dragOverAnimationCapture:function(n){var r=n.dragRect,i=n.isOwner,s=n.activeSortable;if(Wr.forEach(function(u){u.thisAnimationDuration=null}),s.options.animation&&!i&&s.multiDrag.isMultiDrag){Od=yu({},r);var o=nh(vo,!0);Od.top-=o.f,Od.left-=o.e}},dragOverAnimationComplete:function(){bl&&(bl=!1,Ag())},drop:function(n){var r=n.originalEvent,i=n.rootEl,s=n.parentEl,o=n.sortable,u=n.dispatchSortableEvent,f=n.oldIndex,d=n.putSortable,g=d||this.sortable;if(r){var y=this.options,x=s.children;if(!Dh)if(y.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),Jo(vo,y.selectedClass,!~Wr.indexOf(vo)),~Wr.indexOf(vo))Wr.splice(Wr.indexOf(vo),1),Dd=null,Vd({sortable:o,rootEl:i,name:"deselect",targetEl:vo});else{if(Wr.push(vo),Vd({sortable:o,rootEl:i,name:"select",targetEl:vo}),r.shiftKey&&Dd&&o.el.contains(Dd)){var _=us(Dd),M=us(vo);if(~_&&~M&&_!==M){var T,D;for(M>_?(D=_,T=M):(D=M,T=_+1);D<T;D++)~Wr.indexOf(x[D])||(Jo(x[D],y.selectedClass,!0),Wr.push(x[D]),Vd({sortable:o,rootEl:i,name:"select",targetEl:x[D]}))}}else Dd=vo;Ou=g}if(Dh&&this.isMultiDrag){if(bl=!1,(s[ja].options.sort||s!==i)&&Wr.length>1){var I=Bo(vo),j=us(vo,":not(."+this.options.selectedClass+")");if(!Id&&y.animation&&(vo.thisAnimationDuration=null),g.captureAnimationState(),!Id&&(y.animation&&(vo.fromRect=I,Wr.forEach(function(te){if(te.thisAnimationDuration=null,te!==vo){var ue=bl?Bo(te):I;te.fromRect=ue,g.addAnimationState({target:te,rect:ue})}})),Ag(),Wr.forEach(function(te){x[j]?s.insertBefore(te,x[j]):s.appendChild(te),j++}),f===us(vo))){var Z=!1;Wr.forEach(function(te){if(te.sortableIndex!==us(te)){Z=!0;return}}),Z&&u("update")}Wr.forEach(function(te){vv(te)}),g.animateAll()}Ou=g}(i===s||d&&d.lastPutMode!=="clone")&&$l.forEach(function(te){te.parentNode&&te.parentNode.removeChild(te)})}},nullingGlobal:function(){this.isMultiDrag=Dh=!1,$l.length=0},destroyGlobal:function(){this._deselectMultiDrag(),yi(document,"pointerup",this._deselectMultiDrag),yi(document,"mouseup",this._deselectMultiDrag),yi(document,"touchend",this._deselectMultiDrag),yi(document,"keydown",this._checkKeyDown),yi(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(n){if(!(typeof Dh<"u"&&Dh)&&Ou===this.sortable&&!(n&&Fu(n.target,this.options.draggable,this.sortable.el,!1))&&!(n&&n.button!==0))for(;Wr.length;){var r=Wr[0];Jo(r,this.options.selectedClass,!1),Wr.shift(),Vd({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:r})}},_checkKeyDown:function(n){n.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(n){n.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},yu(e,{pluginName:"multiDrag",utils:{select:function(n){var r=n.parentNode[ja];!r||!r.options.multiDrag||~Wr.indexOf(n)||(Ou&&Ou!==r&&(Ou.multiDrag._deselectMultiDrag(),Ou=r),Jo(n,r.options.selectedClass,!0),Wr.push(n))},deselect:function(n){var r=n.parentNode[ja],i=Wr.indexOf(n);!r||!r.options.multiDrag||!~i||(Jo(n,r.options.selectedClass,!1),Wr.splice(i,1))}},eventProperties:function(){var n=this,r=[],i=[];return Wr.forEach(function(s){r.push({multiDragElement:s,index:s.sortableIndex});var o;bl&&s!==vo?o=-1:bl?o=us(s,":not(."+n.options.selectedClass+")"):o=us(s),i.push({multiDragElement:s,index:o})}),{items:MU(Wr),clones:[].concat($l),oldIndicies:r,newIndicies:i}},optionListeners:{multiDragKey:function(n){return n=n.toLowerCase(),n==="ctrl"?n="Control":n.length>1&&(n=n.charAt(0).toUpperCase()+n.substr(1)),n}}})}function oV(e,t){Wr.forEach(function(n,r){var i=t.children[n.sortableIndex+(e?Number(r):0)];i?t.insertBefore(n,i):t.appendChild(n)})}function Qb(e,t){$l.forEach(function(n,r){var i=t.children[n.sortableIndex+(e?Number(r):0)];i?t.insertBefore(n,i):t.appendChild(n)})}function Ag(){Wr.forEach(function(e){e!==vo&&e.parentNode&&e.parentNode.removeChild(e)})}Dr.mount(new tV);Dr.mount(wy,by);const sV=Object.freeze(Object.defineProperty({__proto__:null,MultiDrag:iV,Sortable:Dr,Swap:nV,default:Dr},Symbol.toStringTag,{value:"Module"})),aV=J5(sV);(function(e,t){(function(r,i){e.exports=i(SU,aV)})(typeof self<"u"?self:ea,function(n,r){return function(i){var s={};function o(u){if(s[u])return s[u].exports;var f=s[u]={i:u,l:!1,exports:{}};return i[u].call(f.exports,f,f.exports,o),f.l=!0,f.exports}return o.m=i,o.c=s,o.d=function(u,f,d){o.o(u,f)||Object.defineProperty(u,f,{enumerable:!0,get:d})},o.r=function(u){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(u,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(u,"__esModule",{value:!0})},o.t=function(u,f){if(f&1&&(u=o(u)),f&8||f&4&&typeof u=="object"&&u&&u.__esModule)return u;var d=Object.create(null);if(o.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:u}),f&2&&typeof u!="string")for(var g in u)o.d(d,g,(function(y){return u[y]}).bind(null,g));return d},o.n=function(u){var f=u&&u.__esModule?function(){return u.default}:function(){return u};return o.d(f,"a",f),f},o.o=function(u,f){return Object.prototype.hasOwnProperty.call(u,f)},o.p="",o(o.s="fb15")}({"00ee":function(i,s,o){var u=o("b622"),f=u("toStringTag"),d={};d[f]="z",i.exports=String(d)==="[object z]"},"0366":function(i,s,o){var u=o("1c0b");i.exports=function(f,d,g){if(u(f),d===void 0)return f;switch(g){case 0:return function(){return f.call(d)};case 1:return function(y){return f.call(d,y)};case 2:return function(y,x){return f.call(d,y,x)};case 3:return function(y,x,_){return f.call(d,y,x,_)}}return function(){return f.apply(d,arguments)}}},"057f":function(i,s,o){var u=o("fc6a"),f=o("241c").f,d={}.toString,g=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],y=function(x){try{return f(x)}catch{return g.slice()}};i.exports.f=function(_){return g&&d.call(_)=="[object Window]"?y(_):f(u(_))}},"06cf":function(i,s,o){var u=o("83ab"),f=o("d1e7"),d=o("5c6c"),g=o("fc6a"),y=o("c04e"),x=o("5135"),_=o("0cfb"),M=Object.getOwnPropertyDescriptor;s.f=u?M:function(D,I){if(D=g(D),I=y(I,!0),_)try{return M(D,I)}catch{}if(x(D,I))return d(!f.f.call(D,I),D[I])}},"0cfb":function(i,s,o){var u=o("83ab"),f=o("d039"),d=o("cc12");i.exports=!u&&!f(function(){return Object.defineProperty(d("div"),"a",{get:function(){return 7}}).a!=7})},"13d5":function(i,s,o){var u=o("23e7"),f=o("d58f").left,d=o("a640"),g=o("ae40"),y=d("reduce"),x=g("reduce",{1:0});u({target:"Array",proto:!0,forced:!y||!x},{reduce:function(M){return f(this,M,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"14c3":function(i,s,o){var u=o("c6b6"),f=o("9263");i.exports=function(d,g){var y=d.exec;if(typeof y=="function"){var x=y.call(d,g);if(typeof x!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return x}if(u(d)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return f.call(d,g)}},"159b":function(i,s,o){var u=o("da84"),f=o("fdbc"),d=o("17c2"),g=o("9112");for(var y in f){var x=u[y],_=x&&x.prototype;if(_&&_.forEach!==d)try{g(_,"forEach",d)}catch{_.forEach=d}}},"17c2":function(i,s,o){var u=o("b727").forEach,f=o("a640"),d=o("ae40"),g=f("forEach"),y=d("forEach");i.exports=!g||!y?function(_){return u(this,_,arguments.length>1?arguments[1]:void 0)}:[].forEach},"1be4":function(i,s,o){var u=o("d066");i.exports=u("document","documentElement")},"1c0b":function(i,s){i.exports=function(o){if(typeof o!="function")throw TypeError(String(o)+" is not a function");return o}},"1c7e":function(i,s,o){var u=o("b622"),f=u("iterator"),d=!1;try{var g=0,y={next:function(){return{done:!!g++}},return:function(){d=!0}};y[f]=function(){return this},Array.from(y,function(){throw 2})}catch{}i.exports=function(x,_){if(!_&&!d)return!1;var M=!1;try{var T={};T[f]=function(){return{next:function(){return{done:M=!0}}}},x(T)}catch{}return M}},"1d80":function(i,s){i.exports=function(o){if(o==null)throw TypeError("Can't call method on "+o);return o}},"1dde":function(i,s,o){var u=o("d039"),f=o("b622"),d=o("2d00"),g=f("species");i.exports=function(y){return d>=51||!u(function(){var x=[],_=x.constructor={};return _[g]=function(){return{foo:1}},x[y](Boolean).foo!==1})}},"23cb":function(i,s,o){var u=o("a691"),f=Math.max,d=Math.min;i.exports=function(g,y){var x=u(g);return x<0?f(x+y,0):d(x,y)}},"23e7":function(i,s,o){var u=o("da84"),f=o("06cf").f,d=o("9112"),g=o("6eeb"),y=o("ce4e"),x=o("e893"),_=o("94ca");i.exports=function(M,T){var D=M.target,I=M.global,j=M.stat,Z,te,ue,le,ge,H;if(I?te=u:j?te=u[D]||y(D,{}):te=(u[D]||{}).prototype,te)for(ue in T){if(ge=T[ue],M.noTargetGet?(H=f(te,ue),le=H&&H.value):le=te[ue],Z=_(I?ue:D+(j?".":"#")+ue,M.forced),!Z&&le!==void 0){if(typeof ge==typeof le)continue;x(ge,le)}(M.sham||le&&le.sham)&&d(ge,"sham",!0),g(te,ue,ge,M)}}},"241c":function(i,s,o){var u=o("ca84"),f=o("7839"),d=f.concat("length","prototype");s.f=Object.getOwnPropertyNames||function(y){return u(y,d)}},"25f0":function(i,s,o){var u=o("6eeb"),f=o("825a"),d=o("d039"),g=o("ad6d"),y="toString",x=RegExp.prototype,_=x[y],M=d(function(){return _.call({source:"a",flags:"b"})!="/a/b"}),T=_.name!=y;(M||T)&&u(RegExp.prototype,y,function(){var I=f(this),j=String(I.source),Z=I.flags,te=String(Z===void 0&&I instanceof RegExp&&!("flags"in x)?g.call(I):Z);return"/"+j+"/"+te},{unsafe:!0})},"2ca0":function(i,s,o){var u=o("23e7"),f=o("06cf").f,d=o("50c4"),g=o("5a34"),y=o("1d80"),x=o("ab13"),_=o("c430"),M="".startsWith,T=Math.min,D=x("startsWith"),I=!_&&!D&&!!function(){var j=f(String.prototype,"startsWith");return j&&!j.writable}();u({target:"String",proto:!0,forced:!I&&!D},{startsWith:function(Z){var te=String(y(this));g(Z);var ue=d(T(arguments.length>1?arguments[1]:void 0,te.length)),le=String(Z);return M?M.call(te,le,ue):te.slice(ue,ue+le.length)===le}})},"2d00":function(i,s,o){var u=o("da84"),f=o("342f"),d=u.process,g=d&&d.versions,y=g&&g.v8,x,_;y?(x=y.split("."),_=x[0]+x[1]):f&&(x=f.match(/Edge\/(\d+)/),(!x||x[1]>=74)&&(x=f.match(/Chrome\/(\d+)/),x&&(_=x[1]))),i.exports=_&&+_},"342f":function(i,s,o){var u=o("d066");i.exports=u("navigator","userAgent")||""},"35a1":function(i,s,o){var u=o("f5df"),f=o("3f8c"),d=o("b622"),g=d("iterator");i.exports=function(y){if(y!=null)return y[g]||y["@@iterator"]||f[u(y)]}},"37e8":function(i,s,o){var u=o("83ab"),f=o("9bf2"),d=o("825a"),g=o("df75");i.exports=u?Object.defineProperties:function(x,_){d(x);for(var M=g(_),T=M.length,D=0,I;T>D;)f.f(x,I=M[D++],_[I]);return x}},"3bbe":function(i,s,o){var u=o("861d");i.exports=function(f){if(!u(f)&&f!==null)throw TypeError("Can't set "+String(f)+" as a prototype");return f}},"3ca3":function(i,s,o){var u=o("6547").charAt,f=o("69f3"),d=o("7dd0"),g="String Iterator",y=f.set,x=f.getterFor(g);d(String,"String",function(_){y(this,{type:g,string:String(_),index:0})},function(){var M=x(this),T=M.string,D=M.index,I;return D>=T.length?{value:void 0,done:!0}:(I=u(T,D),M.index+=I.length,{value:I,done:!1})})},"3f8c":function(i,s){i.exports={}},4160:function(i,s,o){var u=o("23e7"),f=o("17c2");u({target:"Array",proto:!0,forced:[].forEach!=f},{forEach:f})},"428f":function(i,s,o){var u=o("da84");i.exports=u},"44ad":function(i,s,o){var u=o("d039"),f=o("c6b6"),d="".split;i.exports=u(function(){return!Object("z").propertyIsEnumerable(0)})?function(g){return f(g)=="String"?d.call(g,""):Object(g)}:Object},"44d2":function(i,s,o){var u=o("b622"),f=o("7c73"),d=o("9bf2"),g=u("unscopables"),y=Array.prototype;y[g]==null&&d.f(y,g,{configurable:!0,value:f(null)}),i.exports=function(x){y[g][x]=!0}},"44e7":function(i,s,o){var u=o("861d"),f=o("c6b6"),d=o("b622"),g=d("match");i.exports=function(y){var x;return u(y)&&((x=y[g])!==void 0?!!x:f(y)=="RegExp")}},4930:function(i,s,o){var u=o("d039");i.exports=!!Object.getOwnPropertySymbols&&!u(function(){return!String(Symbol())})},"4d64":function(i,s,o){var u=o("fc6a"),f=o("50c4"),d=o("23cb"),g=function(y){return function(x,_,M){var T=u(x),D=f(T.length),I=d(M,D),j;if(y&&_!=_){for(;D>I;)if(j=T[I++],j!=j)return!0}else for(;D>I;I++)if((y||I in T)&&T[I]===_)return y||I||0;return!y&&-1}};i.exports={includes:g(!0),indexOf:g(!1)}},"4de4":function(i,s,o){var u=o("23e7"),f=o("b727").filter,d=o("1dde"),g=o("ae40"),y=d("filter"),x=g("filter");u({target:"Array",proto:!0,forced:!y||!x},{filter:function(M){return f(this,M,arguments.length>1?arguments[1]:void 0)}})},"4df4":function(i,s,o){var u=o("0366"),f=o("7b0b"),d=o("9bdd"),g=o("e95a"),y=o("50c4"),x=o("8418"),_=o("35a1");i.exports=function(T){var D=f(T),I=typeof this=="function"?this:Array,j=arguments.length,Z=j>1?arguments[1]:void 0,te=Z!==void 0,ue=_(D),le=0,ge,H,U,Q,F,B;if(te&&(Z=u(Z,j>2?arguments[2]:void 0,2)),ue!=null&&!(I==Array&&g(ue)))for(Q=ue.call(D),F=Q.next,H=new I;!(U=F.call(Q)).done;le++)B=te?d(Q,Z,[U.value,le],!0):U.value,x(H,le,B);else for(ge=y(D.length),H=new I(ge);ge>le;le++)B=te?Z(D[le],le):D[le],x(H,le,B);return H.length=le,H}},"4fad":function(i,s,o){var u=o("23e7"),f=o("6f53").entries;u({target:"Object",stat:!0},{entries:function(g){return f(g)}})},"50c4":function(i,s,o){var u=o("a691"),f=Math.min;i.exports=function(d){return d>0?f(u(d),9007199254740991):0}},5135:function(i,s){var o={}.hasOwnProperty;i.exports=function(u,f){return o.call(u,f)}},5319:function(i,s,o){var u=o("d784"),f=o("825a"),d=o("7b0b"),g=o("50c4"),y=o("a691"),x=o("1d80"),_=o("8aa5"),M=o("14c3"),T=Math.max,D=Math.min,I=Math.floor,j=/\$([$&'`]|\d\d?|<[^>]*>)/g,Z=/\$([$&'`]|\d\d?)/g,te=function(ue){return ue===void 0?ue:String(ue)};u("replace",2,function(ue,le,ge,H){var U=H.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,Q=H.REPLACE_KEEPS_$0,F=U?"$":"$0";return[function($,W){var G=x(this),J=$==null?void 0:$[ue];return J!==void 0?J.call($,G,W):le.call(String(G),$,W)},function(R,$){if(!U&&Q||typeof $=="string"&&$.indexOf(F)===-1){var W=ge(le,R,this,$);if(W.done)return W.value}var G=f(R),J=String(this),Y=typeof $=="function";Y||($=String($));var pe=G.global;if(pe){var Le=G.unicode;G.lastIndex=0}for(var De=[];;){var N=M(G,J);if(N===null||(De.push(N),!pe))break;var ee=String(N[0]);ee===""&&(G.lastIndex=_(J,g(G.lastIndex),Le))}for(var fe="",ce=0,_e=0;_e<De.length;_e++){N=De[_e];for(var se=String(N[0]),k=T(D(y(N.index),J.length),0),ae=[],ke=1;ke<N.length;ke++)ae.push(te(N[ke]));var Pe=N.groups;if(Y){var Ge=[se].concat(ae,k,J);Pe!==void 0&&Ge.push(Pe);var K=String($.apply(void 0,Ge))}else K=B(se,J,k,ae,Pe,$);k>=ce&&(fe+=J.slice(ce,k)+K,ce=k+se.length)}return fe+J.slice(ce)}];function B(R,$,W,G,J,Y){var pe=W+R.length,Le=G.length,De=Z;return J!==void 0&&(J=d(J),De=j),le.call(Y,De,function(N,ee){var fe;switch(ee.charAt(0)){case"$":return"$";case"&":return R;case"`":return $.slice(0,W);case"'":return $.slice(pe);case"<":fe=J[ee.slice(1,-1)];break;default:var ce=+ee;if(ce===0)return N;if(ce>Le){var _e=I(ce/10);return _e===0?N:_e<=Le?G[_e-1]===void 0?ee.charAt(1):G[_e-1]+ee.charAt(1):N}fe=G[ce-1]}return fe===void 0?"":fe})}})},5692:function(i,s,o){var u=o("c430"),f=o("c6cd");(i.exports=function(d,g){return f[d]||(f[d]=g!==void 0?g:{})})("versions",[]).push({version:"3.6.5",mode:u?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},"56ef":function(i,s,o){var u=o("d066"),f=o("241c"),d=o("7418"),g=o("825a");i.exports=u("Reflect","ownKeys")||function(x){var _=f.f(g(x)),M=d.f;return M?_.concat(M(x)):_}},"5a34":function(i,s,o){var u=o("44e7");i.exports=function(f){if(u(f))throw TypeError("The method doesn't accept regular expressions");return f}},"5c6c":function(i,s){i.exports=function(o,u){return{enumerable:!(o&1),configurable:!(o&2),writable:!(o&4),value:u}}},"5db7":function(i,s,o){var u=o("23e7"),f=o("a2bf"),d=o("7b0b"),g=o("50c4"),y=o("1c0b"),x=o("65f0");u({target:"Array",proto:!0},{flatMap:function(M){var T=d(this),D=g(T.length),I;return y(M),I=x(T,0),I.length=f(I,T,T,D,0,1,M,arguments.length>1?arguments[1]:void 0),I}})},6547:function(i,s,o){var u=o("a691"),f=o("1d80"),d=function(g){return function(y,x){var _=String(f(y)),M=u(x),T=_.length,D,I;return M<0||M>=T?g?"":void 0:(D=_.charCodeAt(M),D<55296||D>56319||M+1===T||(I=_.charCodeAt(M+1))<56320||I>57343?g?_.charAt(M):D:g?_.slice(M,M+2):(D-55296<<10)+(I-56320)+65536)}};i.exports={codeAt:d(!1),charAt:d(!0)}},"65f0":function(i,s,o){var u=o("861d"),f=o("e8b5"),d=o("b622"),g=d("species");i.exports=function(y,x){var _;return f(y)&&(_=y.constructor,typeof _=="function"&&(_===Array||f(_.prototype))?_=void 0:u(_)&&(_=_[g],_===null&&(_=void 0))),new(_===void 0?Array:_)(x===0?0:x)}},"69f3":function(i,s,o){var u=o("7f9a"),f=o("da84"),d=o("861d"),g=o("9112"),y=o("5135"),x=o("f772"),_=o("d012"),M=f.WeakMap,T,D,I,j=function(U){return I(U)?D(U):T(U,{})},Z=function(U){return function(Q){var F;if(!d(Q)||(F=D(Q)).type!==U)throw TypeError("Incompatible receiver, "+U+" required");return F}};if(u){var te=new M,ue=te.get,le=te.has,ge=te.set;T=function(U,Q){return ge.call(te,U,Q),Q},D=function(U){return ue.call(te,U)||{}},I=function(U){return le.call(te,U)}}else{var H=x("state");_[H]=!0,T=function(U,Q){return g(U,H,Q),Q},D=function(U){return y(U,H)?U[H]:{}},I=function(U){return y(U,H)}}i.exports={set:T,get:D,has:I,enforce:j,getterFor:Z}},"6eeb":function(i,s,o){var u=o("da84"),f=o("9112"),d=o("5135"),g=o("ce4e"),y=o("8925"),x=o("69f3"),_=x.get,M=x.enforce,T=String(String).split("String");(i.exports=function(D,I,j,Z){var te=Z?!!Z.unsafe:!1,ue=Z?!!Z.enumerable:!1,le=Z?!!Z.noTargetGet:!1;if(typeof j=="function"&&(typeof I=="string"&&!d(j,"name")&&f(j,"name",I),M(j).source=T.join(typeof I=="string"?I:"")),D===u){ue?D[I]=j:g(I,j);return}else te?!le&&D[I]&&(ue=!0):delete D[I];ue?D[I]=j:f(D,I,j)})(Function.prototype,"toString",function(){return typeof this=="function"&&_(this).source||y(this)})},"6f53":function(i,s,o){var u=o("83ab"),f=o("df75"),d=o("fc6a"),g=o("d1e7").f,y=function(x){return function(_){for(var M=d(_),T=f(M),D=T.length,I=0,j=[],Z;D>I;)Z=T[I++],(!u||g.call(M,Z))&&j.push(x?[Z,M[Z]]:M[Z]);return j}};i.exports={entries:y(!0),values:y(!1)}},"73d9":function(i,s,o){var u=o("44d2");u("flatMap")},7418:function(i,s){s.f=Object.getOwnPropertySymbols},"746f":function(i,s,o){var u=o("428f"),f=o("5135"),d=o("e538"),g=o("9bf2").f;i.exports=function(y){var x=u.Symbol||(u.Symbol={});f(x,y)||g(x,y,{value:d.f(y)})}},7839:function(i,s){i.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"7b0b":function(i,s,o){var u=o("1d80");i.exports=function(f){return Object(u(f))}},"7c73":function(i,s,o){var u=o("825a"),f=o("37e8"),d=o("7839"),g=o("d012"),y=o("1be4"),x=o("cc12"),_=o("f772"),M=">",T="<",D="prototype",I="script",j=_("IE_PROTO"),Z=function(){},te=function(U){return T+I+M+U+T+"/"+I+M},ue=function(U){U.write(te("")),U.close();var Q=U.parentWindow.Object;return U=null,Q},le=function(){var U=x("iframe"),Q="java"+I+":",F;return U.style.display="none",y.appendChild(U),U.src=String(Q),F=U.contentWindow.document,F.open(),F.write(te("document.F=Object")),F.close(),F.F},ge,H=function(){try{ge=document.domain&&new ActiveXObject("htmlfile")}catch{}H=ge?ue(ge):le();for(var U=d.length;U--;)delete H[D][d[U]];return H()};g[j]=!0,i.exports=Object.create||function(Q,F){var B;return Q!==null?(Z[D]=u(Q),B=new Z,Z[D]=null,B[j]=Q):B=H(),F===void 0?B:f(B,F)}},"7dd0":function(i,s,o){var u=o("23e7"),f=o("9ed3"),d=o("e163"),g=o("d2bb"),y=o("d44e"),x=o("9112"),_=o("6eeb"),M=o("b622"),T=o("c430"),D=o("3f8c"),I=o("ae93"),j=I.IteratorPrototype,Z=I.BUGGY_SAFARI_ITERATORS,te=M("iterator"),ue="keys",le="values",ge="entries",H=function(){return this};i.exports=function(U,Q,F,B,R,$,W){f(F,Q,B);var G=function(_e){if(_e===R&&De)return De;if(!Z&&_e in pe)return pe[_e];switch(_e){case ue:return function(){return new F(this,_e)};case le:return function(){return new F(this,_e)};case ge:return function(){return new F(this,_e)}}return function(){return new F(this)}},J=Q+" Iterator",Y=!1,pe=U.prototype,Le=pe[te]||pe["@@iterator"]||R&&pe[R],De=!Z&&Le||G(R),N=Q=="Array"&&pe.entries||Le,ee,fe,ce;if(N&&(ee=d(N.call(new U)),j!==Object.prototype&&ee.next&&(!T&&d(ee)!==j&&(g?g(ee,j):typeof ee[te]!="function"&&x(ee,te,H)),y(ee,J,!0,!0),T&&(D[J]=H))),R==le&&Le&&Le.name!==le&&(Y=!0,De=function(){return Le.call(this)}),(!T||W)&&pe[te]!==De&&x(pe,te,De),D[Q]=De,R)if(fe={values:G(le),keys:$?De:G(ue),entries:G(ge)},W)for(ce in fe)(Z||Y||!(ce in pe))&&_(pe,ce,fe[ce]);else u({target:Q,proto:!0,forced:Z||Y},fe);return fe}},"7f9a":function(i,s,o){var u=o("da84"),f=o("8925"),d=u.WeakMap;i.exports=typeof d=="function"&&/native code/.test(f(d))},"825a":function(i,s,o){var u=o("861d");i.exports=function(f){if(!u(f))throw TypeError(String(f)+" is not an object");return f}},"83ab":function(i,s,o){var u=o("d039");i.exports=!u(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},8418:function(i,s,o){var u=o("c04e"),f=o("9bf2"),d=o("5c6c");i.exports=function(g,y,x){var _=u(y);_ in g?f.f(g,_,d(0,x)):g[_]=x}},"861d":function(i,s){i.exports=function(o){return typeof o=="object"?o!==null:typeof o=="function"}},8875:function(i,s,o){var u,f,d;(function(g,y){f=[],u=y,d=typeof u=="function"?u.apply(s,f):u,d!==void 0&&(i.exports=d)})(typeof self<"u"?self:this,function(){function g(){var y=Object.getOwnPropertyDescriptor(document,"currentScript");if(!y&&"currentScript"in document&&document.currentScript||y&&y.get!==g&&document.currentScript)return document.currentScript;try{throw new Error}catch(ge){var x=/.*at [^(]*\((.*):(.+):(.+)\)$/ig,_=/@([^@]*):(\d+):(\d+)\s*$/ig,M=x.exec(ge.stack)||_.exec(ge.stack),T=M&&M[1]||!1,D=M&&M[2]||!1,I=document.location.href.replace(document.location.hash,""),j,Z,te,ue=document.getElementsByTagName("script");T===I&&(j=document.documentElement.outerHTML,Z=new RegExp("(?:[^\\n]+?\\n){0,"+(D-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),te=j.replace(Z,"$1").trim());for(var le=0;le<ue.length;le++)if(ue[le].readyState==="interactive"||ue[le].src===T||T===I&&ue[le].innerHTML&&ue[le].innerHTML.trim()===te)return ue[le];return null}}return g})},8925:function(i,s,o){var u=o("c6cd"),f=Function.toString;typeof u.inspectSource!="function"&&(u.inspectSource=function(d){return f.call(d)}),i.exports=u.inspectSource},"8aa5":function(i,s,o){var u=o("6547").charAt;i.exports=function(f,d,g){return d+(g?u(f,d).length:1)}},"8bbf":function(i,s){i.exports=n},"90e3":function(i,s){var o=0,u=Math.random();i.exports=function(f){return"Symbol("+String(f===void 0?"":f)+")_"+(++o+u).toString(36)}},9112:function(i,s,o){var u=o("83ab"),f=o("9bf2"),d=o("5c6c");i.exports=u?function(g,y,x){return f.f(g,y,d(1,x))}:function(g,y,x){return g[y]=x,g}},9263:function(i,s,o){var u=o("ad6d"),f=o("9f7f"),d=RegExp.prototype.exec,g=String.prototype.replace,y=d,x=function(){var D=/a/,I=/b*/g;return d.call(D,"a"),d.call(I,"a"),D.lastIndex!==0||I.lastIndex!==0}(),_=f.UNSUPPORTED_Y||f.BROKEN_CARET,M=/()??/.exec("")[1]!==void 0,T=x||M||_;T&&(y=function(I){var j=this,Z,te,ue,le,ge=_&&j.sticky,H=u.call(j),U=j.source,Q=0,F=I;return ge&&(H=H.replace("y",""),H.indexOf("g")===-1&&(H+="g"),F=String(I).slice(j.lastIndex),j.lastIndex>0&&(!j.multiline||j.multiline&&I[j.lastIndex-1]!==`
`)&&(U="(?: "+U+")",F=" "+F,Q++),te=new RegExp("^(?:"+U+")",H)),M&&(te=new RegExp("^"+U+"$(?!\\s)",H)),x&&(Z=j.lastIndex),ue=d.call(ge?te:j,F),ge?ue?(ue.input=ue.input.slice(Q),ue[0]=ue[0].slice(Q),ue.index=j.lastIndex,j.lastIndex+=ue[0].length):j.lastIndex=0:x&&ue&&(j.lastIndex=j.global?ue.index+ue[0].length:Z),M&&ue&&ue.length>1&&g.call(ue[0],te,function(){for(le=1;le<arguments.length-2;le++)arguments[le]===void 0&&(ue[le]=void 0)}),ue}),i.exports=y},"94ca":function(i,s,o){var u=o("d039"),f=/#|\.prototype\./,d=function(M,T){var D=y[g(M)];return D==_?!0:D==x?!1:typeof T=="function"?u(T):!!T},g=d.normalize=function(M){return String(M).replace(f,".").toLowerCase()},y=d.data={},x=d.NATIVE="N",_=d.POLYFILL="P";i.exports=d},"99af":function(i,s,o){var u=o("23e7"),f=o("d039"),d=o("e8b5"),g=o("861d"),y=o("7b0b"),x=o("50c4"),_=o("8418"),M=o("65f0"),T=o("1dde"),D=o("b622"),I=o("2d00"),j=D("isConcatSpreadable"),Z=9007199254740991,te="Maximum allowed index exceeded",ue=I>=51||!f(function(){var U=[];return U[j]=!1,U.concat()[0]!==U}),le=T("concat"),ge=function(U){if(!g(U))return!1;var Q=U[j];return Q!==void 0?!!Q:d(U)},H=!ue||!le;u({target:"Array",proto:!0,forced:H},{concat:function(Q){var F=y(this),B=M(F,0),R=0,$,W,G,J,Y;for($=-1,G=arguments.length;$<G;$++)if(Y=$===-1?F:arguments[$],ge(Y)){if(J=x(Y.length),R+J>Z)throw TypeError(te);for(W=0;W<J;W++,R++)W in Y&&_(B,R,Y[W])}else{if(R>=Z)throw TypeError(te);_(B,R++,Y)}return B.length=R,B}})},"9bdd":function(i,s,o){var u=o("825a");i.exports=function(f,d,g,y){try{return y?d(u(g)[0],g[1]):d(g)}catch(_){var x=f.return;throw x!==void 0&&u(x.call(f)),_}}},"9bf2":function(i,s,o){var u=o("83ab"),f=o("0cfb"),d=o("825a"),g=o("c04e"),y=Object.defineProperty;s.f=u?y:function(_,M,T){if(d(_),M=g(M,!0),d(T),f)try{return y(_,M,T)}catch{}if("get"in T||"set"in T)throw TypeError("Accessors not supported");return"value"in T&&(_[M]=T.value),_}},"9ed3":function(i,s,o){var u=o("ae93").IteratorPrototype,f=o("7c73"),d=o("5c6c"),g=o("d44e"),y=o("3f8c"),x=function(){return this};i.exports=function(_,M,T){var D=M+" Iterator";return _.prototype=f(u,{next:d(1,T)}),g(_,D,!1,!0),y[D]=x,_}},"9f7f":function(i,s,o){var u=o("d039");function f(d,g){return RegExp(d,g)}s.UNSUPPORTED_Y=u(function(){var d=f("a","y");return d.lastIndex=2,d.exec("abcd")!=null}),s.BROKEN_CARET=u(function(){var d=f("^r","gy");return d.lastIndex=2,d.exec("str")!=null})},a2bf:function(i,s,o){var u=o("e8b5"),f=o("50c4"),d=o("0366"),g=function(y,x,_,M,T,D,I,j){for(var Z=T,te=0,ue=I?d(I,j,3):!1,le;te<M;){if(te in _){if(le=ue?ue(_[te],te,x):_[te],D>0&&u(le))Z=g(y,x,le,f(le.length),Z,D-1)-1;else{if(Z>=9007199254740991)throw TypeError("Exceed the acceptable array length");y[Z]=le}Z++}te++}return Z};i.exports=g},a352:function(i,s){i.exports=r},a434:function(i,s,o){var u=o("23e7"),f=o("23cb"),d=o("a691"),g=o("50c4"),y=o("7b0b"),x=o("65f0"),_=o("8418"),M=o("1dde"),T=o("ae40"),D=M("splice"),I=T("splice",{ACCESSORS:!0,0:0,1:2}),j=Math.max,Z=Math.min,te=9007199254740991,ue="Maximum allowed length exceeded";u({target:"Array",proto:!0,forced:!D||!I},{splice:function(ge,H){var U=y(this),Q=g(U.length),F=f(ge,Q),B=arguments.length,R,$,W,G,J,Y;if(B===0?R=$=0:B===1?(R=0,$=Q-F):(R=B-2,$=Z(j(d(H),0),Q-F)),Q+R-$>te)throw TypeError(ue);for(W=x(U,$),G=0;G<$;G++)J=F+G,J in U&&_(W,G,U[J]);if(W.length=$,R<$){for(G=F;G<Q-$;G++)J=G+$,Y=G+R,J in U?U[Y]=U[J]:delete U[Y];for(G=Q;G>Q-$+R;G--)delete U[G-1]}else if(R>$)for(G=Q-$;G>F;G--)J=G+$-1,Y=G+R-1,J in U?U[Y]=U[J]:delete U[Y];for(G=0;G<R;G++)U[G+F]=arguments[G+2];return U.length=Q-$+R,W}})},a4d3:function(i,s,o){var u=o("23e7"),f=o("da84"),d=o("d066"),g=o("c430"),y=o("83ab"),x=o("4930"),_=o("fdbf"),M=o("d039"),T=o("5135"),D=o("e8b5"),I=o("861d"),j=o("825a"),Z=o("7b0b"),te=o("fc6a"),ue=o("c04e"),le=o("5c6c"),ge=o("7c73"),H=o("df75"),U=o("241c"),Q=o("057f"),F=o("7418"),B=o("06cf"),R=o("9bf2"),$=o("d1e7"),W=o("9112"),G=o("6eeb"),J=o("5692"),Y=o("f772"),pe=o("d012"),Le=o("90e3"),De=o("b622"),N=o("e538"),ee=o("746f"),fe=o("d44e"),ce=o("69f3"),_e=o("b727").forEach,se=Y("hidden"),k="Symbol",ae="prototype",ke=De("toPrimitive"),Pe=ce.set,Ge=ce.getterFor(k),K=Object[ae],de=f.Symbol,ye=d("JSON","stringify"),me=B.f,Ue=R.f,Qe=Q.f,Ze=$.f,He=J("symbols"),Xe=J("op-symbols"),tt=J("string-to-symbol-registry"),Mt=J("symbol-to-string-registry"),Lt=J("wks"),jt=f.QObject,zt=!jt||!jt[ae]||!jt[ae].findChild,sn=y&&M(function(){return ge(Ue({},"a",{get:function(){return Ue(this,"a",{value:7}).a}})).a!=7})?function(xn,Mn,Pn){var fr=me(K,Mn);fr&&delete K[Mn],Ue(xn,Mn,Pn),fr&&xn!==K&&Ue(K,Mn,fr)}:Ue,pn=function(xn,Mn){var Pn=He[xn]=ge(de[ae]);return Pe(Pn,{type:k,tag:xn,description:Mn}),y||(Pn.description=Mn),Pn},et=_?function(xn){return typeof xn=="symbol"}:function(xn){return Object(xn)instanceof de},ot=function(Mn,Pn,fr){Mn===K&&ot(Xe,Pn,fr),j(Mn);var yr=ue(Pn,!0);return j(fr),T(He,yr)?(fr.enumerable?(T(Mn,se)&&Mn[se][yr]&&(Mn[se][yr]=!1),fr=ge(fr,{enumerable:le(0,!1)})):(T(Mn,se)||Ue(Mn,se,le(1,{})),Mn[se][yr]=!0),sn(Mn,yr,fr)):Ue(Mn,yr,fr)},rt=function(Mn,Pn){j(Mn);var fr=te(Pn),yr=H(fr).concat(Tn(fr));return _e(yr,function(at){(!y||Qt.call(fr,at))&&ot(Mn,at,fr[at])}),Mn},Ht=function(Mn,Pn){return Pn===void 0?ge(Mn):rt(ge(Mn),Pn)},Qt=function(Mn){var Pn=ue(Mn,!0),fr=Ze.call(this,Pn);return this===K&&T(He,Pn)&&!T(Xe,Pn)?!1:fr||!T(this,Pn)||!T(He,Pn)||T(this,se)&&this[se][Pn]?fr:!0},On=function(Mn,Pn){var fr=te(Mn),yr=ue(Pn,!0);if(!(fr===K&&T(He,yr)&&!T(Xe,yr))){var at=me(fr,yr);return at&&T(He,yr)&&!(T(fr,se)&&fr[se][yr])&&(at.enumerable=!0),at}},wn=function(Mn){var Pn=Qe(te(Mn)),fr=[];return _e(Pn,function(yr){!T(He,yr)&&!T(pe,yr)&&fr.push(yr)}),fr},Tn=function(Mn){var Pn=Mn===K,fr=Qe(Pn?Xe:te(Mn)),yr=[];return _e(fr,function(at){T(He,at)&&(!Pn||T(K,at))&&yr.push(He[at])}),yr};if(x||(de=function(){if(this instanceof de)throw TypeError("Symbol is not a constructor");var Mn=!arguments.length||arguments[0]===void 0?void 0:String(arguments[0]),Pn=Le(Mn),fr=function(yr){this===K&&fr.call(Xe,yr),T(this,se)&&T(this[se],Pn)&&(this[se][Pn]=!1),sn(this,Pn,le(1,yr))};return y&&zt&&sn(K,Pn,{configurable:!0,set:fr}),pn(Pn,Mn)},G(de[ae],"toString",function(){return Ge(this).tag}),G(de,"withoutSetter",function(xn){return pn(Le(xn),xn)}),$.f=Qt,R.f=ot,B.f=On,U.f=Q.f=wn,F.f=Tn,N.f=function(xn){return pn(De(xn),xn)},y&&(Ue(de[ae],"description",{configurable:!0,get:function(){return Ge(this).description}}),g||G(K,"propertyIsEnumerable",Qt,{unsafe:!0}))),u({global:!0,wrap:!0,forced:!x,sham:!x},{Symbol:de}),_e(H(Lt),function(xn){ee(xn)}),u({target:k,stat:!0,forced:!x},{for:function(xn){var Mn=String(xn);if(T(tt,Mn))return tt[Mn];var Pn=de(Mn);return tt[Mn]=Pn,Mt[Pn]=Mn,Pn},keyFor:function(Mn){if(!et(Mn))throw TypeError(Mn+" is not a symbol");if(T(Mt,Mn))return Mt[Mn]},useSetter:function(){zt=!0},useSimple:function(){zt=!1}}),u({target:"Object",stat:!0,forced:!x,sham:!y},{create:Ht,defineProperty:ot,defineProperties:rt,getOwnPropertyDescriptor:On}),u({target:"Object",stat:!0,forced:!x},{getOwnPropertyNames:wn,getOwnPropertySymbols:Tn}),u({target:"Object",stat:!0,forced:M(function(){F.f(1)})},{getOwnPropertySymbols:function(Mn){return F.f(Z(Mn))}}),ye){var ar=!x||M(function(){var xn=de();return ye([xn])!="[null]"||ye({a:xn})!="{}"||ye(Object(xn))!="{}"});u({target:"JSON",stat:!0,forced:ar},{stringify:function(Mn,Pn,fr){for(var yr=[Mn],at=1,We;arguments.length>at;)yr.push(arguments[at++]);if(We=Pn,!(!I(Pn)&&Mn===void 0||et(Mn)))return D(Pn)||(Pn=function(It,En){if(typeof We=="function"&&(En=We.call(this,It,En)),!et(En))return En}),yr[1]=Pn,ye.apply(null,yr)}})}de[ae][ke]||W(de[ae],ke,de[ae].valueOf),fe(de,k),pe[se]=!0},a630:function(i,s,o){var u=o("23e7"),f=o("4df4"),d=o("1c7e"),g=!d(function(y){Array.from(y)});u({target:"Array",stat:!0,forced:g},{from:f})},a640:function(i,s,o){var u=o("d039");i.exports=function(f,d){var g=[][f];return!!g&&u(function(){g.call(null,d||function(){throw 1},1)})}},a691:function(i,s){var o=Math.ceil,u=Math.floor;i.exports=function(f){return isNaN(f=+f)?0:(f>0?u:o)(f)}},ab13:function(i,s,o){var u=o("b622"),f=u("match");i.exports=function(d){var g=/./;try{"/./"[d](g)}catch{try{return g[f]=!1,"/./"[d](g)}catch{}}return!1}},ac1f:function(i,s,o){var u=o("23e7"),f=o("9263");u({target:"RegExp",proto:!0,forced:/./.exec!==f},{exec:f})},ad6d:function(i,s,o){var u=o("825a");i.exports=function(){var f=u(this),d="";return f.global&&(d+="g"),f.ignoreCase&&(d+="i"),f.multiline&&(d+="m"),f.dotAll&&(d+="s"),f.unicode&&(d+="u"),f.sticky&&(d+="y"),d}},ae40:function(i,s,o){var u=o("83ab"),f=o("d039"),d=o("5135"),g=Object.defineProperty,y={},x=function(_){throw _};i.exports=function(_,M){if(d(y,_))return y[_];M||(M={});var T=[][_],D=d(M,"ACCESSORS")?M.ACCESSORS:!1,I=d(M,0)?M[0]:x,j=d(M,1)?M[1]:void 0;return y[_]=!!T&&!f(function(){if(D&&!u)return!0;var Z={length:-1};D?g(Z,1,{enumerable:!0,get:x}):Z[1]=1,T.call(Z,I,j)})}},ae93:function(i,s,o){var u=o("e163"),f=o("9112"),d=o("5135"),g=o("b622"),y=o("c430"),x=g("iterator"),_=!1,M=function(){return this},T,D,I;[].keys&&(I=[].keys(),"next"in I?(D=u(u(I)),D!==Object.prototype&&(T=D)):_=!0),T==null&&(T={}),!y&&!d(T,x)&&f(T,x,M),i.exports={IteratorPrototype:T,BUGGY_SAFARI_ITERATORS:_}},b041:function(i,s,o){var u=o("00ee"),f=o("f5df");i.exports=u?{}.toString:function(){return"[object "+f(this)+"]"}},b0c0:function(i,s,o){var u=o("83ab"),f=o("9bf2").f,d=Function.prototype,g=d.toString,y=/^\s*function ([^ (]*)/,x="name";u&&!(x in d)&&f(d,x,{configurable:!0,get:function(){try{return g.call(this).match(y)[1]}catch{return""}}})},b622:function(i,s,o){var u=o("da84"),f=o("5692"),d=o("5135"),g=o("90e3"),y=o("4930"),x=o("fdbf"),_=f("wks"),M=u.Symbol,T=x?M:M&&M.withoutSetter||g;i.exports=function(D){return d(_,D)||(y&&d(M,D)?_[D]=M[D]:_[D]=T("Symbol."+D)),_[D]}},b64b:function(i,s,o){var u=o("23e7"),f=o("7b0b"),d=o("df75"),g=o("d039"),y=g(function(){d(1)});u({target:"Object",stat:!0,forced:y},{keys:function(_){return d(f(_))}})},b727:function(i,s,o){var u=o("0366"),f=o("44ad"),d=o("7b0b"),g=o("50c4"),y=o("65f0"),x=[].push,_=function(M){var T=M==1,D=M==2,I=M==3,j=M==4,Z=M==6,te=M==5||Z;return function(ue,le,ge,H){for(var U=d(ue),Q=f(U),F=u(le,ge,3),B=g(Q.length),R=0,$=H||y,W=T?$(ue,B):D?$(ue,0):void 0,G,J;B>R;R++)if((te||R in Q)&&(G=Q[R],J=F(G,R,U),M)){if(T)W[R]=J;else if(J)switch(M){case 3:return!0;case 5:return G;case 6:return R;case 2:x.call(W,G)}else if(j)return!1}return Z?-1:I||j?j:W}};i.exports={forEach:_(0),map:_(1),filter:_(2),some:_(3),every:_(4),find:_(5),findIndex:_(6)}},c04e:function(i,s,o){var u=o("861d");i.exports=function(f,d){if(!u(f))return f;var g,y;if(d&&typeof(g=f.toString)=="function"&&!u(y=g.call(f))||typeof(g=f.valueOf)=="function"&&!u(y=g.call(f))||!d&&typeof(g=f.toString)=="function"&&!u(y=g.call(f)))return y;throw TypeError("Can't convert object to primitive value")}},c430:function(i,s){i.exports=!1},c6b6:function(i,s){var o={}.toString;i.exports=function(u){return o.call(u).slice(8,-1)}},c6cd:function(i,s,o){var u=o("da84"),f=o("ce4e"),d="__core-js_shared__",g=u[d]||f(d,{});i.exports=g},c740:function(i,s,o){var u=o("23e7"),f=o("b727").findIndex,d=o("44d2"),g=o("ae40"),y="findIndex",x=!0,_=g(y);y in[]&&Array(1)[y](function(){x=!1}),u({target:"Array",proto:!0,forced:x||!_},{findIndex:function(T){return f(this,T,arguments.length>1?arguments[1]:void 0)}}),d(y)},c8ba:function(i,s){var o;o=function(){return this}();try{o=o||new Function("return this")()}catch{typeof window=="object"&&(o=window)}i.exports=o},c975:function(i,s,o){var u=o("23e7"),f=o("4d64").indexOf,d=o("a640"),g=o("ae40"),y=[].indexOf,x=!!y&&1/[1].indexOf(1,-0)<0,_=d("indexOf"),M=g("indexOf",{ACCESSORS:!0,1:0});u({target:"Array",proto:!0,forced:x||!_||!M},{indexOf:function(D){return x?y.apply(this,arguments)||0:f(this,D,arguments.length>1?arguments[1]:void 0)}})},ca84:function(i,s,o){var u=o("5135"),f=o("fc6a"),d=o("4d64").indexOf,g=o("d012");i.exports=function(y,x){var _=f(y),M=0,T=[],D;for(D in _)!u(g,D)&&u(_,D)&&T.push(D);for(;x.length>M;)u(_,D=x[M++])&&(~d(T,D)||T.push(D));return T}},caad:function(i,s,o){var u=o("23e7"),f=o("4d64").includes,d=o("44d2"),g=o("ae40"),y=g("indexOf",{ACCESSORS:!0,1:0});u({target:"Array",proto:!0,forced:!y},{includes:function(_){return f(this,_,arguments.length>1?arguments[1]:void 0)}}),d("includes")},cc12:function(i,s,o){var u=o("da84"),f=o("861d"),d=u.document,g=f(d)&&f(d.createElement);i.exports=function(y){return g?d.createElement(y):{}}},ce4e:function(i,s,o){var u=o("da84"),f=o("9112");i.exports=function(d,g){try{f(u,d,g)}catch{u[d]=g}return g}},d012:function(i,s){i.exports={}},d039:function(i,s){i.exports=function(o){try{return!!o()}catch{return!0}}},d066:function(i,s,o){var u=o("428f"),f=o("da84"),d=function(g){return typeof g=="function"?g:void 0};i.exports=function(g,y){return arguments.length<2?d(u[g])||d(f[g]):u[g]&&u[g][y]||f[g]&&f[g][y]}},d1e7:function(i,s,o){var u={}.propertyIsEnumerable,f=Object.getOwnPropertyDescriptor,d=f&&!u.call({1:2},1);s.f=d?function(y){var x=f(this,y);return!!x&&x.enumerable}:u},d28b:function(i,s,o){var u=o("746f");u("iterator")},d2bb:function(i,s,o){var u=o("825a"),f=o("3bbe");i.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var d=!1,g={},y;try{y=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,y.call(g,[]),d=g instanceof Array}catch{}return function(_,M){return u(_),f(M),d?y.call(_,M):_.__proto__=M,_}}():void 0)},d3b7:function(i,s,o){var u=o("00ee"),f=o("6eeb"),d=o("b041");u||f(Object.prototype,"toString",d,{unsafe:!0})},d44e:function(i,s,o){var u=o("9bf2").f,f=o("5135"),d=o("b622"),g=d("toStringTag");i.exports=function(y,x,_){y&&!f(y=_?y:y.prototype,g)&&u(y,g,{configurable:!0,value:x})}},d58f:function(i,s,o){var u=o("1c0b"),f=o("7b0b"),d=o("44ad"),g=o("50c4"),y=function(x){return function(_,M,T,D){u(M);var I=f(_),j=d(I),Z=g(I.length),te=x?Z-1:0,ue=x?-1:1;if(T<2)for(;;){if(te in j){D=j[te],te+=ue;break}if(te+=ue,x?te<0:Z<=te)throw TypeError("Reduce of empty array with no initial value")}for(;x?te>=0:Z>te;te+=ue)te in j&&(D=M(D,j[te],te,I));return D}};i.exports={left:y(!1),right:y(!0)}},d784:function(i,s,o){o("ac1f");var u=o("6eeb"),f=o("d039"),d=o("b622"),g=o("9263"),y=o("9112"),x=d("species"),_=!f(function(){var j=/./;return j.exec=function(){var Z=[];return Z.groups={a:"7"},Z},"".replace(j,"$<a>")!=="7"}),M=function(){return"a".replace(/./,"$0")==="$0"}(),T=d("replace"),D=function(){return/./[T]?/./[T]("a","$0")==="":!1}(),I=!f(function(){var j=/(?:)/,Z=j.exec;j.exec=function(){return Z.apply(this,arguments)};var te="ab".split(j);return te.length!==2||te[0]!=="a"||te[1]!=="b"});i.exports=function(j,Z,te,ue){var le=d(j),ge=!f(function(){var R={};return R[le]=function(){return 7},""[j](R)!=7}),H=ge&&!f(function(){var R=!1,$=/a/;return j==="split"&&($={},$.constructor={},$.constructor[x]=function(){return $},$.flags="",$[le]=/./[le]),$.exec=function(){return R=!0,null},$[le](""),!R});if(!ge||!H||j==="replace"&&!(_&&M&&!D)||j==="split"&&!I){var U=/./[le],Q=te(le,""[j],function(R,$,W,G,J){return $.exec===g?ge&&!J?{done:!0,value:U.call($,W,G)}:{done:!0,value:R.call(W,$,G)}:{done:!1}},{REPLACE_KEEPS_$0:M,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:D}),F=Q[0],B=Q[1];u(String.prototype,j,F),u(RegExp.prototype,le,Z==2?function(R,$){return B.call(R,this,$)}:function(R){return B.call(R,this)})}ue&&y(RegExp.prototype[le],"sham",!0)}},d81d:function(i,s,o){var u=o("23e7"),f=o("b727").map,d=o("1dde"),g=o("ae40"),y=d("map"),x=g("map");u({target:"Array",proto:!0,forced:!y||!x},{map:function(M){return f(this,M,arguments.length>1?arguments[1]:void 0)}})},da84:function(i,s,o){(function(u){var f=function(d){return d&&d.Math==Math&&d};i.exports=f(typeof globalThis=="object"&&globalThis)||f(typeof window=="object"&&window)||f(typeof self=="object"&&self)||f(typeof u=="object"&&u)||Function("return this")()}).call(this,o("c8ba"))},dbb4:function(i,s,o){var u=o("23e7"),f=o("83ab"),d=o("56ef"),g=o("fc6a"),y=o("06cf"),x=o("8418");u({target:"Object",stat:!0,sham:!f},{getOwnPropertyDescriptors:function(M){for(var T=g(M),D=y.f,I=d(T),j={},Z=0,te,ue;I.length>Z;)ue=D(T,te=I[Z++]),ue!==void 0&&x(j,te,ue);return j}})},dbf1:function(i,s,o){(function(u){o.d(s,"a",function(){return d});function f(){return typeof window<"u"?window.console:u.console}var d=f()}).call(this,o("c8ba"))},ddb0:function(i,s,o){var u=o("da84"),f=o("fdbc"),d=o("e260"),g=o("9112"),y=o("b622"),x=y("iterator"),_=y("toStringTag"),M=d.values;for(var T in f){var D=u[T],I=D&&D.prototype;if(I){if(I[x]!==M)try{g(I,x,M)}catch{I[x]=M}if(I[_]||g(I,_,T),f[T]){for(var j in d)if(I[j]!==d[j])try{g(I,j,d[j])}catch{I[j]=d[j]}}}}},df75:function(i,s,o){var u=o("ca84"),f=o("7839");i.exports=Object.keys||function(g){return u(g,f)}},e01a:function(i,s,o){var u=o("23e7"),f=o("83ab"),d=o("da84"),g=o("5135"),y=o("861d"),x=o("9bf2").f,_=o("e893"),M=d.Symbol;if(f&&typeof M=="function"&&(!("description"in M.prototype)||M().description!==void 0)){var T={},D=function(){var le=arguments.length<1||arguments[0]===void 0?void 0:String(arguments[0]),ge=this instanceof D?new M(le):le===void 0?M():M(le);return le===""&&(T[ge]=!0),ge};_(D,M);var I=D.prototype=M.prototype;I.constructor=D;var j=I.toString,Z=String(M("test"))=="Symbol(test)",te=/^Symbol\((.*)\)[^)]+$/;x(I,"description",{configurable:!0,get:function(){var le=y(this)?this.valueOf():this,ge=j.call(le);if(g(T,le))return"";var H=Z?ge.slice(7,-1):ge.replace(te,"$1");return H===""?void 0:H}}),u({global:!0,forced:!0},{Symbol:D})}},e163:function(i,s,o){var u=o("5135"),f=o("7b0b"),d=o("f772"),g=o("e177"),y=d("IE_PROTO"),x=Object.prototype;i.exports=g?Object.getPrototypeOf:function(_){return _=f(_),u(_,y)?_[y]:typeof _.constructor=="function"&&_ instanceof _.constructor?_.constructor.prototype:_ instanceof Object?x:null}},e177:function(i,s,o){var u=o("d039");i.exports=!u(function(){function f(){}return f.prototype.constructor=null,Object.getPrototypeOf(new f)!==f.prototype})},e260:function(i,s,o){var u=o("fc6a"),f=o("44d2"),d=o("3f8c"),g=o("69f3"),y=o("7dd0"),x="Array Iterator",_=g.set,M=g.getterFor(x);i.exports=y(Array,"Array",function(T,D){_(this,{type:x,target:u(T),index:0,kind:D})},function(){var T=M(this),D=T.target,I=T.kind,j=T.index++;return!D||j>=D.length?(T.target=void 0,{value:void 0,done:!0}):I=="keys"?{value:j,done:!1}:I=="values"?{value:D[j],done:!1}:{value:[j,D[j]],done:!1}},"values"),d.Arguments=d.Array,f("keys"),f("values"),f("entries")},e439:function(i,s,o){var u=o("23e7"),f=o("d039"),d=o("fc6a"),g=o("06cf").f,y=o("83ab"),x=f(function(){g(1)}),_=!y||x;u({target:"Object",stat:!0,forced:_,sham:!y},{getOwnPropertyDescriptor:function(T,D){return g(d(T),D)}})},e538:function(i,s,o){var u=o("b622");s.f=u},e893:function(i,s,o){var u=o("5135"),f=o("56ef"),d=o("06cf"),g=o("9bf2");i.exports=function(y,x){for(var _=f(x),M=g.f,T=d.f,D=0;D<_.length;D++){var I=_[D];u(y,I)||M(y,I,T(x,I))}}},e8b5:function(i,s,o){var u=o("c6b6");i.exports=Array.isArray||function(d){return u(d)=="Array"}},e95a:function(i,s,o){var u=o("b622"),f=o("3f8c"),d=u("iterator"),g=Array.prototype;i.exports=function(y){return y!==void 0&&(f.Array===y||g[d]===y)}},f5df:function(i,s,o){var u=o("00ee"),f=o("c6b6"),d=o("b622"),g=d("toStringTag"),y=f(function(){return arguments}())=="Arguments",x=function(_,M){try{return _[M]}catch{}};i.exports=u?f:function(_){var M,T,D;return _===void 0?"Undefined":_===null?"Null":typeof(T=x(M=Object(_),g))=="string"?T:y?f(M):(D=f(M))=="Object"&&typeof M.callee=="function"?"Arguments":D}},f772:function(i,s,o){var u=o("5692"),f=o("90e3"),d=u("keys");i.exports=function(g){return d[g]||(d[g]=f(g))}},fb15:function(i,s,o){if(o.r(s),typeof window<"u"){var u=window.document.currentScript;{var f=o("8875");u=f(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:f})}var d=u&&u.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);d&&(o.p=d[1])}o("99af"),o("4de4"),o("4160"),o("c975"),o("d81d"),o("a434"),o("159b"),o("a4d3"),o("e439"),o("dbb4"),o("b64b");function g(et,ot,rt){return ot in et?Object.defineProperty(et,ot,{value:rt,enumerable:!0,configurable:!0,writable:!0}):et[ot]=rt,et}function y(et,ot){var rt=Object.keys(et);if(Object.getOwnPropertySymbols){var Ht=Object.getOwnPropertySymbols(et);ot&&(Ht=Ht.filter(function(Qt){return Object.getOwnPropertyDescriptor(et,Qt).enumerable})),rt.push.apply(rt,Ht)}return rt}function x(et){for(var ot=1;ot<arguments.length;ot++){var rt=arguments[ot]!=null?arguments[ot]:{};ot%2?y(Object(rt),!0).forEach(function(Ht){g(et,Ht,rt[Ht])}):Object.getOwnPropertyDescriptors?Object.defineProperties(et,Object.getOwnPropertyDescriptors(rt)):y(Object(rt)).forEach(function(Ht){Object.defineProperty(et,Ht,Object.getOwnPropertyDescriptor(rt,Ht))})}return et}function _(et){if(Array.isArray(et))return et}o("e01a"),o("d28b"),o("e260"),o("d3b7"),o("3ca3"),o("ddb0");function M(et,ot){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(et)))){var rt=[],Ht=!0,Qt=!1,On=void 0;try{for(var wn=et[Symbol.iterator](),Tn;!(Ht=(Tn=wn.next()).done)&&(rt.push(Tn.value),!(ot&&rt.length===ot));Ht=!0);}catch(ar){Qt=!0,On=ar}finally{try{!Ht&&wn.return!=null&&wn.return()}finally{if(Qt)throw On}}return rt}}o("a630"),o("fb6a"),o("b0c0"),o("25f0");function T(et,ot){(ot==null||ot>et.length)&&(ot=et.length);for(var rt=0,Ht=new Array(ot);rt<ot;rt++)Ht[rt]=et[rt];return Ht}function D(et,ot){if(et){if(typeof et=="string")return T(et,ot);var rt=Object.prototype.toString.call(et).slice(8,-1);if(rt==="Object"&&et.constructor&&(rt=et.constructor.name),rt==="Map"||rt==="Set")return Array.from(et);if(rt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(rt))return T(et,ot)}}function I(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function j(et,ot){return _(et)||M(et,ot)||D(et,ot)||I()}function Z(et){if(Array.isArray(et))return T(et)}function te(et){if(typeof Symbol<"u"&&Symbol.iterator in Object(et))return Array.from(et)}function ue(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function le(et){return Z(et)||te(et)||D(et)||ue()}var ge=o("a352"),H=o.n(ge);function U(et){et.parentElement!==null&&et.parentElement.removeChild(et)}function Q(et,ot,rt){var Ht=rt===0?et.children[0]:et.children[rt-1].nextSibling;et.insertBefore(ot,Ht)}var F=o("dbf1");o("13d5"),o("4fad"),o("ac1f"),o("5319");function B(et){var ot=Object.create(null);return function(Ht){var Qt=ot[Ht];return Qt||(ot[Ht]=et(Ht))}}var R=/-(\w)/g,$=B(function(et){return et.replace(R,function(ot,rt){return rt.toUpperCase()})});o("5db7"),o("73d9");var W=["Start","Add","Remove","Update","End"],G=["Choose","Unchoose","Sort","Filter","Clone"],J=["Move"],Y=[J,W,G].flatMap(function(et){return et}).map(function(et){return"on".concat(et)}),pe={manage:J,manageAndEmit:W,emit:G};function Le(et){return Y.indexOf(et)!==-1}o("caad"),o("2ca0");var De=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"];function N(et){return De.includes(et)}function ee(et){return["transition-group","TransitionGroup"].includes(et)}function fe(et){return["id","class","role","style"].includes(et)||et.startsWith("data-")||et.startsWith("aria-")||et.startsWith("on")}function ce(et){return et.reduce(function(ot,rt){var Ht=j(rt,2),Qt=Ht[0],On=Ht[1];return ot[Qt]=On,ot},{})}function _e(et){var ot=et.$attrs,rt=et.componentData,Ht=rt===void 0?{}:rt,Qt=ce(Object.entries(ot).filter(function(On){var wn=j(On,2),Tn=wn[0];return wn[1],fe(Tn)}));return x(x({},Qt),Ht)}function se(et){var ot=et.$attrs,rt=et.callBackBuilder,Ht=ce(k(ot));Object.entries(rt).forEach(function(On){var wn=j(On,2),Tn=wn[0],ar=wn[1];pe[Tn].forEach(function(xn){Ht["on".concat(xn)]=ar(xn)})});var Qt="[data-draggable]".concat(Ht.draggable||"");return x(x({},Ht),{},{draggable:Qt})}function k(et){return Object.entries(et).filter(function(ot){var rt=j(ot,2),Ht=rt[0];return rt[1],!fe(Ht)}).map(function(ot){var rt=j(ot,2),Ht=rt[0],Qt=rt[1];return[$(Ht),Qt]}).filter(function(ot){var rt=j(ot,2),Ht=rt[0];return rt[1],!Le(Ht)})}o("c740");function ae(et,ot){if(!(et instanceof ot))throw new TypeError("Cannot call a class as a function")}function ke(et,ot){for(var rt=0;rt<ot.length;rt++){var Ht=ot[rt];Ht.enumerable=Ht.enumerable||!1,Ht.configurable=!0,"value"in Ht&&(Ht.writable=!0),Object.defineProperty(et,Ht.key,Ht)}}function Pe(et,ot,rt){return ot&&ke(et.prototype,ot),et}var Ge=function(ot){var rt=ot.el;return rt},K=function(ot,rt){return ot.__draggable_context=rt},de=function(ot){return ot.__draggable_context},ye=function(){function et(ot){var rt=ot.nodes,Ht=rt.header,Qt=rt.default,On=rt.footer,wn=ot.root,Tn=ot.realList;ae(this,et),this.defaultNodes=Qt,this.children=[].concat(le(Ht),le(Qt),le(On)),this.externalComponent=wn.externalComponent,this.rootTransition=wn.transition,this.tag=wn.tag,this.realList=Tn}return Pe(et,[{key:"render",value:function(rt,Ht){var Qt=this.tag,On=this.children,wn=this._isRootComponent,Tn=wn?{default:function(){return On}}:On;return rt(Qt,Ht,Tn)}},{key:"updated",value:function(){var rt=this.defaultNodes,Ht=this.realList;rt.forEach(function(Qt,On){K(Ge(Qt),{element:Ht[On],index:On})})}},{key:"getUnderlyingVm",value:function(rt){return de(rt)}},{key:"getVmIndexFromDomIndex",value:function(rt,Ht){var Qt=this.defaultNodes,On=Qt.length,wn=Ht.children,Tn=wn.item(rt);if(Tn===null)return On;var ar=de(Tn);if(ar)return ar.index;if(On===0)return 0;var xn=Ge(Qt[0]),Mn=le(wn).findIndex(function(Pn){return Pn===xn});return rt<Mn?0:On}},{key:"_isRootComponent",get:function(){return this.externalComponent||this.rootTransition}}]),et}(),me=o("8bbf");function Ue(et,ot){var rt=et[ot];return rt?rt():[]}function Qe(et){var ot=et.$slots,rt=et.realList,Ht=et.getKey,Qt=rt||[],On=["header","footer"].map(function(Pn){return Ue(ot,Pn)}),wn=j(On,2),Tn=wn[0],ar=wn[1],xn=ot.item;if(!xn)throw new Error("draggable element must have an item slot");var Mn=Qt.flatMap(function(Pn,fr){return xn({element:Pn,index:fr}).map(function(yr){return yr.key=Ht(Pn),yr.props=x(x({},yr.props||{}),{},{"data-draggable":!0}),yr})});if(Mn.length!==Qt.length)throw new Error("Item slot must have only one child");return{header:Tn,footer:ar,default:Mn}}function Ze(et){var ot=ee(et),rt=!N(et)&&!ot;return{transition:ot,externalComponent:rt,tag:rt?Object(me.resolveComponent)(et):ot?me.TransitionGroup:et}}function He(et){var ot=et.$slots,rt=et.tag,Ht=et.realList,Qt=et.getKey,On=Qe({$slots:ot,realList:Ht,getKey:Qt}),wn=Ze(rt);return new ye({nodes:On,root:wn,realList:Ht})}function Xe(et,ot){var rt=this;Object(me.nextTick)(function(){return rt.$emit(et.toLowerCase(),ot)})}function tt(et){var ot=this;return function(rt,Ht){if(ot.realList!==null)return ot["onDrag".concat(et)](rt,Ht)}}function Mt(et){var ot=this,rt=tt.call(this,et);return function(Ht,Qt){rt.call(ot,Ht,Qt),Xe.call(ot,et,Ht)}}var Lt=null,jt={list:{type:Array,required:!1,default:null},modelValue:{type:Array,required:!1,default:null},itemKey:{type:[String,Function],required:!0},clone:{type:Function,default:function(ot){return ot}},tag:{type:String,default:"div"},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},zt=["update:modelValue","change"].concat(le([].concat(le(pe.manageAndEmit),le(pe.emit)).map(function(et){return et.toLowerCase()}))),sn=Object(me.defineComponent)({name:"draggable",inheritAttrs:!1,props:jt,emits:zt,data:function(){return{error:!1}},render:function(){try{this.error=!1;var ot=this.$slots,rt=this.$attrs,Ht=this.tag,Qt=this.componentData,On=this.realList,wn=this.getKey,Tn=He({$slots:ot,tag:Ht,realList:On,getKey:wn});this.componentStructure=Tn;var ar=_e({$attrs:rt,componentData:Qt});return Tn.render(me.h,ar)}catch(xn){return this.error=!0,Object(me.h)("pre",{style:{color:"red"}},xn.stack)}},created:function(){this.list!==null&&this.modelValue!==null&&F.a.error("modelValue and list props are mutually exclusive! Please set one or another.")},mounted:function(){var ot=this;if(!this.error){var rt=this.$attrs,Ht=this.$el,Qt=this.componentStructure;Qt.updated();var On=se({$attrs:rt,callBackBuilder:{manageAndEmit:function(ar){return Mt.call(ot,ar)},emit:function(ar){return Xe.bind(ot,ar)},manage:function(ar){return tt.call(ot,ar)}}}),wn=Ht.nodeType===1?Ht:Ht.parentElement;this._sortable=new H.a(wn,On),this.targetDomElement=wn,wn.__draggable_component__=this}},updated:function(){this.componentStructure.updated()},beforeUnmount:function(){this._sortable!==void 0&&this._sortable.destroy()},computed:{realList:function(){var ot=this.list;return ot||this.modelValue},getKey:function(){var ot=this.itemKey;return typeof ot=="function"?ot:function(rt){return rt[ot]}}},watch:{$attrs:{handler:function(ot){var rt=this._sortable;rt&&k(ot).forEach(function(Ht){var Qt=j(Ht,2),On=Qt[0],wn=Qt[1];rt.option(On,wn)})},deep:!0}},methods:{getUnderlyingVm:function(ot){return this.componentStructure.getUnderlyingVm(ot)||null},getUnderlyingPotencialDraggableComponent:function(ot){return ot.__draggable_component__},emitChanges:function(ot){var rt=this;Object(me.nextTick)(function(){return rt.$emit("change",ot)})},alterList:function(ot){if(this.list){ot(this.list);return}var rt=le(this.modelValue);ot(rt),this.$emit("update:modelValue",rt)},spliceList:function(){var ot=arguments,rt=function(Qt){return Qt.splice.apply(Qt,le(ot))};this.alterList(rt)},updatePosition:function(ot,rt){var Ht=function(On){return On.splice(rt,0,On.splice(ot,1)[0])};this.alterList(Ht)},getRelatedContextFromMoveEvent:function(ot){var rt=ot.to,Ht=ot.related,Qt=this.getUnderlyingPotencialDraggableComponent(rt);if(!Qt)return{component:Qt};var On=Qt.realList,wn={list:On,component:Qt};if(rt!==Ht&&On){var Tn=Qt.getUnderlyingVm(Ht)||{};return x(x({},Tn),wn)}return wn},getVmIndexFromDomIndex:function(ot){return this.componentStructure.getVmIndexFromDomIndex(ot,this.targetDomElement)},onDragStart:function(ot){this.context=this.getUnderlyingVm(ot.item),ot.item._underlying_vm_=this.clone(this.context.element),Lt=ot.item},onDragAdd:function(ot){var rt=ot.item._underlying_vm_;if(rt!==void 0){U(ot.item);var Ht=this.getVmIndexFromDomIndex(ot.newIndex);this.spliceList(Ht,0,rt);var Qt={element:rt,newIndex:Ht};this.emitChanges({added:Qt})}},onDragRemove:function(ot){if(Q(this.$el,ot.item,ot.oldIndex),ot.pullMode==="clone"){U(ot.clone);return}var rt=this.context,Ht=rt.index,Qt=rt.element;this.spliceList(Ht,1);var On={element:Qt,oldIndex:Ht};this.emitChanges({removed:On})},onDragUpdate:function(ot){U(ot.item),Q(ot.from,ot.item,ot.oldIndex);var rt=this.context.index,Ht=this.getVmIndexFromDomIndex(ot.newIndex);this.updatePosition(rt,Ht);var Qt={element:this.context.element,oldIndex:rt,newIndex:Ht};this.emitChanges({moved:Qt})},computeFutureIndex:function(ot,rt){if(!ot.element)return 0;var Ht=le(rt.to.children).filter(function(Tn){return Tn.style.display!=="none"}),Qt=Ht.indexOf(rt.related),On=ot.component.getVmIndexFromDomIndex(Qt),wn=Ht.indexOf(Lt)!==-1;return wn||!rt.willInsertAfter?On:On+1},onDragMove:function(ot,rt){var Ht=this.move,Qt=this.realList;if(!Ht||!Qt)return!0;var On=this.getRelatedContextFromMoveEvent(ot),wn=this.computeFutureIndex(On,ot),Tn=x(x({},this.context),{},{futureIndex:wn}),ar=x(x({},ot),{},{relatedContext:On,draggedContext:Tn});return Ht(ar,rt)},onDragEnd:function(){Lt=null}}}),pn=sn;s.default=pn},fb6a:function(i,s,o){var u=o("23e7"),f=o("861d"),d=o("e8b5"),g=o("23cb"),y=o("50c4"),x=o("fc6a"),_=o("8418"),M=o("b622"),T=o("1dde"),D=o("ae40"),I=T("slice"),j=D("slice",{ACCESSORS:!0,0:0,1:2}),Z=M("species"),te=[].slice,ue=Math.max;u({target:"Array",proto:!0,forced:!I||!j},{slice:function(ge,H){var U=x(this),Q=y(U.length),F=g(ge,Q),B=g(H===void 0?Q:H,Q),R,$,W;if(d(U)&&(R=U.constructor,typeof R=="function"&&(R===Array||d(R.prototype))?R=void 0:f(R)&&(R=R[Z],R===null&&(R=void 0)),R===Array||R===void 0))return te.call(U,F,B);for($=new(R===void 0?Array:R)(ue(B-F,0)),W=0;F<B;F++,W++)F in U&&_($,W,U[F]);return $.length=W,$}})},fc6a:function(i,s,o){var u=o("44ad"),f=o("1d80");i.exports=function(d){return u(f(d))}},fdbc:function(i,s){i.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},fdbf:function(i,s,o){var u=o("4930");i.exports=u&&!Symbol.sham&&typeof Symbol.iterator=="symbol"}}).default})})(Fx);var lV=Fx.exports;const ew=fy(lV),uV={class:"h-full bg-gray-50"},cV={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},fV={class:"mt-6 bg-white shadow rounded-lg p-4"},hV={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},dV=["value"],pV={key:0,class:"mt-6 p-6 text-center bg-white shadow rounded-lg"},gV={key:1,class:"mt-6 overflow-x-auto pb-4"},mV={key:0,class:"p-6 text-center bg-white shadow rounded-lg mb-4"},vV={class:"column-wrapper w-80 flex-shrink-0"},yV={class:"bg-white rounded-lg shadow overflow-hidden"},_V={class:"flex items-center"},bV={class:"flex items-center"},wV={class:"text-xs text-gray-500 bg-white px-2 py-1 rounded-full"},xV={class:"p-2 max-h-[calc(100vh-250px)] overflow-y-auto"},LV={class:"min-h-[100px] draggable-container"},SV={class:"note-container"},CV={class:"bg-white rounded-md shadow-sm border border-gray-200 overflow-hidden"},EV={class:"p-3 flex items-center justify-between note-drag-handle cursor-move no-select"},PV={class:"flex items-center"},MV={class:"text-sm font-medium text-gray-900 truncate"},AV={class:"px-3 py-2"},kV={class:"text-sm text-gray-500 line-clamp-2"},TV={class:"px-3 py-2 bg-gray-50 border-t border-gray-100 flex justify-between items-center"},NV={class:"text-xs text-gray-500"},DV={class:"flex space-x-1"},IV=["onClick"],OV=["onClick"],BV=["onClick"],RV=["onClick"],FV={key:0,class:"fixed z-[3001] inset-0 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},jV={class:"flex items-center justify-center min-h-screen w-full"},zV={class:"relative bg-white w-full h-full md:rounded-lg md:max-w-lg md:h-auto md:max-h-[90vh] md:my-8 shadow-xl transform transition-all overflow-hidden"},$V={class:"mt-6 flex flex-col-reverse sm:flex-row-reverse sm:justify-end gap-3 p-4 md:px-6"},UV=cs({__name:"NotesView",setup(e){const t=Op(),n=Uu(),r=Rp(),i=ad(),s=Ft(!0),o=Ft(!1),u=Ft(!1),f=Ft(null),d=Ft(null),g=Ft("info"),y=Ft(null),x=cr({get:()=>{const J=r.getSortedColumns;return console.log("[NotesView][columnsForDrag] Colonnes triées:",J),J},set:J=>{console.log("[NotesView][columnsForDrag] Mise à jour de l'ordre des colonnes:",J);const Y=J.map(pe=>pe.id.toString());r.reorderColumns(Y)}}),_=[{id:Yi.PRIVATE,title:"Privé",description:"Visible uniquement par vous"},{id:Yi.COMPANY,title:"Entreprise",description:"Visible uniquement par l'entreprise"},{id:Yi.EMPLOYEE,title:"Salariés",description:"Visible par l'entreprise et ses salariés"},{id:Yi.VISITOR,title:"Visiteurs",description:"Visible par tous (entreprise, salariés et visiteurs)"}],M=Yl({search:"",date:"",accessLevel:""});function T(J){if(!J)return"Date non définie";try{const Y=new Date(J);return isNaN(Y.getTime())?(console.warn("[safeFormatDate] Date invalide:",J),"Date invalide"):new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(Y)}catch(Y){return console.error("[safeFormatDate] Erreur lors du formatage de la date:",Y),"Date invalide"}}function D(J){if(!J)return null;try{const Y=new Date(J);return isNaN(Y.getTime())?(console.warn("[safeDate] Date invalide:",J),null):Y}catch(Y){return console.error("[safeDate] Erreur lors de la création de la date:",Y),null}}function I(J){return T(J)}const j=cr(()=>{let J=r.getAccessibleNotes;if(M.search){const Y=M.search.toLowerCase();J=J.filter(pe=>pe.title.toLowerCase().includes(Y)||pe.description.toLowerCase().includes(Y))}if(M.accessLevel&&(J=J.filter(Y=>Y.accessLevel===M.accessLevel)),M.date){const Y=new Date;Y.setHours(0,0,0,0);const pe=new Date(Y);pe.setDate(Y.getDate()-Y.getDay());const Le=new Date(Y.getFullYear(),Y.getMonth(),1);J=J.filter(De=>{const N=D(De.createdAt);return N?M.date==="today"?N>=Y:M.date==="week"?N>=pe:M.date==="month"?N>=Le:!0:!1})}return J}),Z=cr(()=>J=>{const Y=r.getNotesByColumn(J);return console.log(`[NotesView][getNotesByColumn] Notes pour la colonne ${J}:`,Y),Y});function te(J){if(J==null)return"Non défini";switch(J){case Yi.PRIVATE:return"Privé";case Yi.COMPANY:return"Entreprise";case Yi.EMPLOYEE:return"Salariés";case Yi.VISITOR:return"Visiteurs";default:return"Non défini"}}function ue(J){if(J==null)return"#9CA3AF";switch(J){case Yi.PRIVATE:return"#9CA3AF";case Yi.COMPANY:return"#EF4444";case Yi.EMPLOYEE:return"#F59E0B";case Yi.VISITOR:return"#10B981";default:return"#6B7280"}}$s(()=>{console.log("[NotesView] Composant monté"),le().then(()=>{console.log("[NotesView] Données chargées avec succès")}).catch(J=>{console.error("[NotesView] Erreur lors du chargement des données:",J),n.error("Erreur lors du chargement des données")})});async function le(){console.log(`
[NotesView][loadInitialData] Début du chargement des données`);try{s.value=!0,console.log("[NotesView][loadInitialData] Chargement des colonnes..."),await r.loadColumns(),console.log("[NotesView][loadInitialData] Colonnes chargées:",r.columns),console.log("[NotesView][loadInitialData] Chargement des notes...");const J=await pu.getNotes();console.log("[NotesView][loadInitialData] Notes reçues:",J.data),J.data.length>0?(console.log("[NotesView][loadInitialData] Détails des notes:"),J.data.forEach((De,N)=>{console.log(`Note ${N+1}:`,{id:De.id,title:De.title,columnId:De.column||De.column_id,access_level:De.access_level,column:De.column})})):console.warn("[NotesView][loadInitialData] Aucune note reçue du backend!");const Y=r.columns.map(De=>De.id),pe=J.data.filter(De=>{const N=(De.column||De.column_id||"").toString();return N===""||!Y.includes(N)});if(pe.length>0){console.warn(`[NotesView][loadInitialData] ${pe.length} notes avec des colonnes invalides:`,pe),console.log("[NotesView][loadInitialData] Assignation des notes à la colonne À faire (2)");for(const De of pe)try{await pu.updateNote(De.id,{column:"2"})}catch(N){console.error(`[NotesView][loadInitialData] Erreur lors de l'assignation de la note ${De.id} à la colonne À faire:`,N)}}const Le=J.data.map(De=>({id:De.id,title:De.title,description:De.description,location:De.location,columnId:(De.column||De.column_id||"2").toString(),access_level:De.access_level,style:De.style||{},comments:De.comments||[],photos:De.photos||[],order:De.order||0,createdAt:De.created_at,updatedAt:De.updated_at}));r.notes.length=0,Le.forEach(De=>{r.addNote(De)}),console.log("[NotesView][loadInitialData] Notes chargées dans le store");for(const De of r.columns){const N=r.getNotesByColumn(De.id);console.log(`[NotesView][loadInitialData] Colonne ${De.title} (${De.id}): ${N.length} notes`),N.length>0&&N.forEach(ee=>{console.log(`  - Note ID=${ee.id}, Titre="${ee.title}", Niveau d'accès=${ee.accessLevel}, Colonne=${ee.columnId}`)})}}catch(J){console.error("[NotesView][loadInitialData] Erreur:",J),n.error("Erreur lors du chargement des données")}finally{s.value=!1,console.log("[NotesView][loadInitialData] Chargement terminé")}}function ge(){t.push({path:"/",query:{tool:"Note"}})}function H(J){t.push({path:"/",query:{lat:Array.isArray(J.location)?J.location[0].toString():J.location.coordinates[1].toString(),lng:Array.isArray(J.location)?J.location[1].toString():J.location.coordinates[0].toString(),noteId:J.id.toString()}})}function U(J){let Y,pe;Array.isArray(J.location)?(Y=J.location[0],pe=J.location[1]):(Y=J.location.coordinates[1],pe=J.location.coordinates[0]);const Le=`https://www.google.com/maps/dir/?api=1&destination=${Y},${pe}`;window.open(Le,"_blank")}function Q(J){d.value=JSON.parse(JSON.stringify(J)),g.value="info",u.value=!0}async function F(){if(u.value=!1,y.value&&d.value)try{const J={location:d.value.location,name:d.value.title,description:d.value.description,columnId:d.value.columnId,accessLevel:d.value.accessLevel,style:d.value.style,comments:d.value.comments||[],photos:d.value.photos||[],order:d.value.order,createdAt:d.value.createdAt,updatedAt:new Date().toISOString()},Y=i.elements.findIndex(pe=>{var Le;return pe.type_forme==="Note"&&pe.id===((Le=d.value)==null?void 0:Le.id)});Y!==-1?i.elements[Y].data=J:i.elements.push({id:d.value.id,type_forme:"Note",data:J}),await i.saveToPlan(y.value),n.success("Note sauvegardée et plan mis à jour avec succès")}catch(J){console.error("Erreur lors de la sauvegarde de la note:",J),n.error("Erreur lors de la sauvegarde de la note")}}function B(J){f.value=J,o.value=!0}async function R(){if(f.value)try{try{await pu.deleteNote(f.value.id)}catch(J){if(J.response&&J.response.status===404)console.log("[NotesView][deleteNote] Note non trouvée dans le backend (404), suppression locale uniquement");else throw J}r.removeNote(f.value.id),n.success("Note supprimée avec succès")}catch(J){console.error("Erreur lors de la suppression de la note:",J),n.error("Erreur lors de la suppression de la note")}finally{o.value=!1,f.value=null}}function $(){n.success("Ordre des colonnes mis à jour")}async function W(J,Y){console.log("[NotesView][onDragChange] Événement:",J),console.log("[NotesView][onDragChange] Colonne cible:",Y);try{if(J.added){const{element:pe}=J.added;console.log("[NotesView][onDragChange] Note à déplacer:",pe);const Le=typeof pe=="object"&&pe.id?pe.id:null;if(!Le)throw console.error("[NotesView][onDragChange] ID de note invalide:",pe),new Error("ID de note invalide");r.moveNote(Le,Y);const N=Z.value(Y).map(fe=>fe.id);r.reorderNotes(Y,N);const ee=r.getColumnById(Y);n.success(`Note déplacée vers ${(ee==null?void 0:ee.title)||"une autre colonne"}`),await G(Le,{columnId:Y})}if(J.moved){const pe=Z.value(Y),Le=pe.map(De=>De.id);r.reorderNotes(Y,Le),n.success("Ordre des notes mis à jour");for(const[De,N]of pe.entries())await G(N.id,{order:De})}}catch(pe){console.error("[NotesView][onDragChange] Erreur:",pe),n.error("Une erreur est survenue lors du déplacement de la note")}}async function G(J,Y){console.log("[NotesView][updateNoteInBackend] Mise à jour de la note:",J,Y);try{const pe=r.notes.find(N=>N.id===J);if(!pe){console.error("[NotesView][updateNoteInBackend] Note non trouvée:",J);return}const Le={...Y};if(Y.columnId){const N=r.getColumnById(Y.columnId);N?(console.log(`[NotesView][updateNoteInBackend] Mise à jour de la colonne: ${N.id} (${N.title})`),Le.column=parseInt(N.id,10),delete Le.columnId,delete Le.column_id):console.warn(`[NotesView][updateNoteInBackend] Colonne non trouvée: ${Y.columnId}`)}const De={...pe,...Le,updatedAt:new Date().toISOString()};console.log("[NotesView][updateNoteInBackend] Données envoyées au backend:",De),await pu.updateNote(J,De),console.log("[NotesView][updateNoteInBackend] Note mise à jour avec succès")}catch(pe){throw console.error("[NotesView][updateNoteInBackend] Erreur:",pe),pe}}return(J,Y)=>{var pe,Le;return $e(),qe("div",uV,[E("div",cV,[E("div",{class:"sm:flex sm:items-center"},[Y[6]||(Y[6]=E("div",{class:"sm:flex-auto"},[E("h1",{class:"text-2xl font-semibold text-gray-900"},"Notes"),E("p",{class:"mt-2 text-sm text-gray-700"}," Liste de toutes vos notes. ")],-1)),E("div",{class:"mt-4 sm:mt-0 sm:ml-16 sm:flex-none"},[E("button",{onClick:ge,class:"inline-flex items-center justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:w-auto"}," Créer une note ")])]),E("div",fV,[E("div",hV,[E("div",null,[Y[7]||(Y[7]=E("label",{for:"search",class:"block text-sm font-medium text-gray-700"},"Recherche",-1)),Fn(E("input",{type:"text",id:"search","onUpdate:modelValue":Y[0]||(Y[0]=De=>M.search=De),placeholder:"Rechercher par titre ou description...",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},null,512),[[ri,M.search]])]),E("div",null,[Y[9]||(Y[9]=E("label",{for:"date",class:"block text-sm font-medium text-gray-700"},"Date",-1)),Fn(E("select",{id:"date","onUpdate:modelValue":Y[1]||(Y[1]=De=>M.date=De),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},Y[8]||(Y[8]=[E("option",{value:""},"Toutes les dates",-1),E("option",{value:"today"},"Aujourd'hui",-1),E("option",{value:"week"},"Cette semaine",-1),E("option",{value:"month"},"Ce mois",-1)]),512),[[uo,M.date]])]),E("div",null,[Y[11]||(Y[11]=E("label",{for:"accessLevel",class:"block text-sm font-medium text-gray-700"},"Niveau d'accès",-1)),Fn(E("select",{id:"accessLevel","onUpdate:modelValue":Y[2]||(Y[2]=De=>M.accessLevel=De),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},[Y[10]||(Y[10]=E("option",{value:""},"Tous les niveaux",-1)),($e(),qe(Bn,null,Er(_,De=>E("option",{key:De.id,value:De.id},Wt(De.title),9,dV)),64))],512),[[uo,M.accessLevel]])])])]),s.value?($e(),qe("div",pV,Y[12]||(Y[12]=[E("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"},null,-1),E("p",{class:"mt-2 text-sm text-gray-500"},"Chargement des notes...",-1)]))):($e(),qe("div",gV,[j.value.length===0&&x.value.length===0?($e(),qe("div",mV,Y[13]||(Y[13]=[E("p",{class:"text-sm text-gray-500"},"Aucune note ni colonne trouvée",-1)]))):dn("",!0),hi(Wn(ew),{modelValue:x.value,"onUpdate:modelValue":Y[3]||(Y[3]=De=>x.value=De),class:"flex space-x-4 min-w-max","item-key":"id",handle:".column-drag-handle",onEnd:$,animation:150},{item:Gl(({element:De})=>[E("div",vV,[E("div",yV,[E("div",{class:"p-3 flex items-center justify-between column-drag-handle cursor-move no-select",style:ql({backgroundColor:De.color+"20",borderBottom:"2px solid "+De.color})},[E("div",_V,[Y[14]||(Y[14]=E("svg",{class:"h-4 w-4 mr-2 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8h16M4 16h16"})],-1)),E("h3",{class:"text-sm font-semibold",style:ql({color:De.color})},Wt(De.title),5)]),E("div",bV,[E("span",wV,Wt(Z.value(De.id).length),1)])],4),E("div",xV,[E("div",LV,[hi(Wn(ew),{list:Z.value(De.id),class:"space-y-2",group:"notes","item-key":"id",handle:".note-drag-handle",onChange:N=>W(N,De.id),animation:150,"ghost-class":"ghost-card","chosen-class":"chosen","drag-class":"dragging"},{item:Gl(({element:N})=>[E("div",SV,[E("div",CV,[E("div",EV,[E("div",PV,[Y[15]||(Y[15]=E("svg",{class:"h-4 w-4 mr-2 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8h16M4 16h16"})],-1)),E("h4",MV,Wt(N.title),1)]),E("div",null,[E("span",{class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium",style:ql({backgroundColor:ue(N.accessLevel)+"20",color:ue(N.accessLevel)})},Wt(te(N.accessLevel)||"Non défini"),5)])]),E("div",AV,[E("p",kV,Wt(N.description||"Aucune description"),1)]),E("div",TV,[E("span",NV,Wt(N.updatedAt?I(N.updatedAt):N.createdAt?I(N.createdAt):"Date non définie"),1),E("div",DV,[E("button",{onClick:ee=>U(N),class:"p-1 text-gray-400 hover:text-primary-500 focus:outline-none",title:"Ouvrir dans Google Maps"},Y[16]||(Y[16]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1)]),8,IV),E("button",{onClick:ee=>H(N),class:"p-1 text-gray-400 hover:text-primary-500 focus:outline-none",title:"Voir sur la carte"},Y[17]||(Y[17]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})],-1)]),8,OV),E("button",{onClick:ee=>Q(N),class:"p-1 text-gray-400 hover:text-primary-500 focus:outline-none",title:"Éditer la note"},Y[18]||(Y[18]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,BV),E("button",{onClick:ee=>B(N),class:"p-1 text-gray-400 hover:text-red-500 focus:outline-none",title:"Supprimer la note"},Y[19]||(Y[19]=[E("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,RV)])])])])]),"empty-content":Gl(()=>Y[20]||(Y[20]=[E("div",{class:"p-4 text-center text-gray-400 text-sm italic"}," Aucune note dans cette colonne ",-1)])),_:2},1032,["list","onChange"])])])])])]),_:1},8,["modelValue"])]))]),o.value?($e(),qe("div",FV,[E("div",jV,[Y[22]||(Y[22]=E("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true"},null,-1)),E("div",zV,[Y[21]||(Y[21]=cc('<div class="p-4 md:p-6" data-v-e88493b1><div class="flex items-start" data-v-e88493b1><div class="flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100" data-v-e88493b1><svg class="h-6 w-6 text-red-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true" data-v-e88493b1><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" data-v-e88493b1></path></svg></div><div class="ml-4 flex-1" data-v-e88493b1><h3 class="text-lg leading-6 font-medium text-gray-900" id="modal-title" data-v-e88493b1> Supprimer la note </h3><div class="mt-2" data-v-e88493b1><p class="text-sm text-gray-500" data-v-e88493b1> Êtes-vous sûr de vouloir supprimer cette note ? Cette action est irréversible. </p></div></div></div></div>',1)),E("div",$V,[E("button",{onClick:R,type:"button",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:w-auto sm:text-sm"}," Supprimer "),E("button",{onClick:Y[4]||(Y[4]=De=>o.value=!1),type:"button",class:"w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:w-auto sm:text-sm"}," Annuler ")])])])])):dn("",!0),u.value?($e(),$a(dx,{key:1,note:d.value,"is-new-note":!((pe=d.value)!=null&&pe.id),location:(Le=d.value)==null?void 0:Le.location,onClose:Y[5]||(Y[5]=De=>u.value=!1),onSave:F},null,8,["note","is-new-note","location"])):dn("",!0)])}}}),VV=Bp(UV,[["__scopeId","data-v-e88493b1"]]),Yx=h8({history:VT("/"),routes:[{path:"/",name:"home",component:Ub,meta:{requiresAuth:!0,allowedRoles:["admin","entreprise","salarie","visiteur"]}},{path:"/plans",name:"plans",component:LU,meta:{requiresAuth:!0,allowedRoles:["admin","entreprise","salarie","visiteur"]}},{path:"/users",name:"users",component:Zz,meta:{requiresAuth:!0,allowedRoles:["admin","entreprise","salarie"]}},{path:"/profile",name:"profile",component:()=>zc(()=>import("./ProfileView.js"),[]),meta:{requiresAuth:!0,allowedRoles:["admin","entreprise","salarie","visiteur"]}},{path:"/login",name:"login",component:RI,meta:{requiresGuest:!0}},{path:"/forgot-password",name:"forgot-password",component:()=>zc(()=>import("./ForgotPasswordView.js"),[]),meta:{requiresGuest:!0}},{path:"/reset-password/:token",name:"reset-password",component:()=>zc(()=>import("./ResetPasswordView.js"),[]),meta:{requiresGuest:!0}},{path:"/change-password",name:"changePassword",component:oI,meta:{requiresAuth:!0,allowedRoles:["admin","entreprise","salarie","visiteur"]}},{path:"/notes",name:"notes",component:VV,meta:{requiresAuth:!0,allowedRoles:["admin","entreprise","salarie","visiteur"]}},{path:"/map",name:"map",component:Ub,meta:{requiresAuth:!0}},{path:"/:pathMatch(.*)*",name:"not-found",component:()=>zc(()=>import("./NotFoundView.js"),[])}]});Yx.beforeEach(async(e,t,n)=>{var u,f;const r=ma();if(console.log("Route:",e.path,"Auth state:",{initialized:r.initialized,isAuthenticated:r.isAuthenticated,user:r.user}),!r.initialized)try{await r.initialize(window.INITIAL_STATE)}catch(d){console.error("Error initializing auth store:",d)}const i=r.isAuthenticated,s=(u=r.user)==null?void 0:u.must_change_password,o=(f=r.user)==null?void 0:f.user_type;if(e.meta.requiresAuth&&!i){n("/login");return}if(i&&s&&e.name!=="changePassword"){n({name:"changePassword"});return}if(e.name==="changePassword"&&!s){n({name:"home"});return}if(e.meta.allowedRoles&&o&&!e.meta.allowedRoles.includes(o)){n({name:"home"});return}if(e.meta.requiresGuest&&i){n({name:"home"});return}n()});const xy=cm(RD),Jx=y6();xy.use(Jx);xy.use(Yx);const GV=ma(Jx);window.INITIAL_STATE&&GV.initialize(window.INITIAL_STATE);xy.mount("#app");export{Xi as _,Yl as a,E as b,qe as c,cs as d,dn as e,Wn as f,Pi as g,Fn as h,$e as i,cc as j,hi as k,Gl as l,Yw as m,Bi as n,$s as o,cG as p,Op as q,Ft as r,ea as s,Wt as t,ma as u,ri as v,Sf as w,fy as x};

var Dx=Object.defineProperty;var Ox=(e,n,t)=>n in e?Dx(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var Pt=(e,n,t)=>Ox(e,typeof n!="symbol"?n+"":n,t);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Kg(e){const n=Object.create(null);for(const t of e.split(","))n[t]=1;return t=>t in n}const jr={},Oh=[],Cu=()=>{},Ix=()=>!1,_p=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Jg=e=>e.startsWith("onUpdate:"),Eo=Object.assign,Yg=(e,n)=>{const t=e.indexOf(n);t>-1&&e.splice(t,1)},Fx=Object.prototype.hasOwnProperty,Cr=(e,n)=>Fx.call(e,n),ti=Array.isArray,Ih=e=>Zf(e)==="[object Map]",Zh=e=>Zf(e)==="[object Set]",I1=e=>Zf(e)==="[object Date]",Li=e=>typeof e=="function",Is=e=>typeof e=="string",Eu=e=>typeof e=="symbol",Ur=e=>e!==null&&typeof e=="object",Yy=e=>(Ur(e)||Li(e))&&Li(e.then)&&Li(e.catch),Xy=Object.prototype.toString,Zf=e=>Xy.call(e),zx=e=>Zf(e).slice(8,-1),Qy=e=>Zf(e)==="[object Object]",Xg=e=>Is(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Cf=Kg(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),bp=e=>{const n=Object.create(null);return t=>n[t]||(n[t]=e(t))},jx=/-(\w)/g,kl=bp(e=>e.replace(jx,(n,t)=>t?t.toUpperCase():"")),Ux=/\B([A-Z])/g,uh=bp(e=>e.replace(Ux,"-$1").toLowerCase()),wp=bp(e=>e.charAt(0).toUpperCase()+e.slice(1)),w0=bp(e=>e?`on${wp(e)}`:""),_c=(e,n)=>!Object.is(e,n),Nd=(e,...n)=>{for(let t=0;t<e.length;t++)e[t](...n)},e_=(e,n,t,i=!1)=>{Object.defineProperty(e,n,{configurable:!0,enumerable:!1,writable:i,value:t})},Jd=e=>{const n=parseFloat(e);return isNaN(n)?e:n},$x=e=>{const n=Is(e)?Number(e):NaN;return isNaN(n)?e:n};let F1;const xp=()=>F1||(F1=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Jc(e){if(ti(e)){const n={};for(let t=0;t<e.length;t++){const i=e[t],r=Is(i)?Hx(i):Jc(i);if(r)for(const o in r)n[o]=r[o]}return n}else if(Is(e)||Ur(e))return e}const qx=/;(?![^(]*\))/g,Vx=/:([^]+)/,Gx=/\/\*[^]*?\*\//g;function Hx(e){const n={};return e.replace(Gx,"").split(qx).forEach(t=>{if(t){const i=t.split(Vx);i.length>1&&(n[i[0].trim()]=i[1].trim())}}),n}function Jr(e){let n="";if(Is(e))n=e;else if(ti(e))for(let t=0;t<e.length;t++){const i=Jr(e[t]);i&&(n+=i+" ")}else if(Ur(e))for(const t in e)e[t]&&(n+=t+" ");return n.trim()}const Wx="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Zx=Kg(Wx);function t_(e){return!!e||e===""}function Kx(e,n){if(e.length!==n.length)return!1;let t=!0;for(let i=0;t&&i<e.length;i++)t=sh(e[i],n[i]);return t}function sh(e,n){if(e===n)return!0;let t=I1(e),i=I1(n);if(t||i)return t&&i?e.getTime()===n.getTime():!1;if(t=Eu(e),i=Eu(n),t||i)return e===n;if(t=ti(e),i=ti(n),t||i)return t&&i?Kx(e,n):!1;if(t=Ur(e),i=Ur(n),t||i){if(!t||!i)return!1;const r=Object.keys(e).length,o=Object.keys(n).length;if(r!==o)return!1;for(const l in e){const h=e.hasOwnProperty(l),g=n.hasOwnProperty(l);if(h&&!g||!h&&g||!sh(e[l],n[l]))return!1}}return String(e)===String(n)}function Qg(e,n){return e.findIndex(t=>sh(t,n))}const n_=e=>!!(e&&e.__v_isRef===!0),Ht=e=>Is(e)?e:e==null?"":ti(e)||Ur(e)&&(e.toString===Xy||!Li(e.toString))?n_(e)?Ht(e.value):JSON.stringify(e,i_,2):String(e),i_=(e,n)=>n_(n)?i_(e,n.value):Ih(n)?{[`Map(${n.size})`]:[...n.entries()].reduce((t,[i,r],o)=>(t[x0(i,o)+" =>"]=r,t),{})}:Zh(n)?{[`Set(${n.size})`]:[...n.values()].map(t=>x0(t))}:Eu(n)?x0(n):Ur(n)&&!ti(n)&&!Qy(n)?String(n):n,x0=(e,n="")=>{var t;return Eu(e)?`Symbol(${(t=e.description)!=null?t:n})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let La;class r_{constructor(n=!1){this.detached=n,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=La,!n&&La&&(this.index=(La.scopes||(La.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let n,t;if(this.scopes)for(n=0,t=this.scopes.length;n<t;n++)this.scopes[n].pause();for(n=0,t=this.effects.length;n<t;n++)this.effects[n].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let n,t;if(this.scopes)for(n=0,t=this.scopes.length;n<t;n++)this.scopes[n].resume();for(n=0,t=this.effects.length;n<t;n++)this.effects[n].resume()}}run(n){if(this._active){const t=La;try{return La=this,n()}finally{La=t}}}on(){La=this}off(){La=this.parent}stop(n){if(this._active){this._active=!1;let t,i;for(t=0,i=this.effects.length;t<i;t++)this.effects[t].stop();for(this.effects.length=0,t=0,i=this.cleanups.length;t<i;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,i=this.scopes.length;t<i;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!n){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0}}}function s_(e){return new r_(e)}function o_(){return La}function Jx(e,n=!1){La&&La.cleanups.push(e)}let Kr;const L0=new WeakSet;class a_{constructor(n){this.fn=n,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,La&&La.active&&La.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,L0.has(this)&&(L0.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||u_(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,z1(this),c_(this);const n=Kr,t=Jl;Kr=this,Jl=!0;try{return this.fn()}finally{h_(this),Kr=n,Jl=t,this.flags&=-3}}stop(){if(this.flags&1){for(let n=this.deps;n;n=n.nextDep)nm(n);this.deps=this.depsTail=void 0,z1(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?L0.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){eg(this)&&this.run()}get dirty(){return eg(this)}}let l_=0,Sf,Pf;function u_(e,n=!1){if(e.flags|=8,n){e.next=Pf,Pf=e;return}e.next=Sf,Sf=e}function em(){l_++}function tm(){if(--l_>0)return;if(Pf){let n=Pf;for(Pf=void 0;n;){const t=n.next;n.next=void 0,n.flags&=-9,n=t}}let e;for(;Sf;){let n=Sf;for(Sf=void 0;n;){const t=n.next;if(n.next=void 0,n.flags&=-9,n.flags&1)try{n.trigger()}catch(i){e||(e=i)}n=t}}if(e)throw e}function c_(e){for(let n=e.deps;n;n=n.nextDep)n.version=-1,n.prevActiveLink=n.dep.activeLink,n.dep.activeLink=n}function h_(e){let n,t=e.depsTail,i=t;for(;i;){const r=i.prevDep;i.version===-1?(i===t&&(t=r),nm(i),Yx(i)):n=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=r}e.deps=n,e.depsTail=t}function eg(e){for(let n=e.deps;n;n=n.nextDep)if(n.dep.version!==n.version||n.dep.computed&&(f_(n.dep.computed)||n.dep.version!==n.version))return!0;return!!e._dirty}function f_(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===If))return;e.globalVersion=If;const n=e.dep;if(e.flags|=2,n.version>0&&!e.isSSR&&e.deps&&!eg(e)){e.flags&=-3;return}const t=Kr,i=Jl;Kr=e,Jl=!0;try{c_(e);const r=e.fn(e._value);(n.version===0||_c(r,e._value))&&(e._value=r,n.version++)}catch(r){throw n.version++,r}finally{Kr=t,Jl=i,h_(e),e.flags&=-3}}function nm(e,n=!1){const{dep:t,prevSub:i,nextSub:r}=e;if(i&&(i.nextSub=r,e.prevSub=void 0),r&&(r.prevSub=i,e.nextSub=void 0),t.subs===e&&(t.subs=i,!i&&t.computed)){t.computed.flags&=-5;for(let o=t.computed.deps;o;o=o.nextDep)nm(o,!0)}!n&&!--t.sc&&t.map&&t.map.delete(t.key)}function Yx(e){const{prevDep:n,nextDep:t}=e;n&&(n.nextDep=t,e.prevDep=void 0),t&&(t.prevDep=n,e.nextDep=void 0)}let Jl=!0;const d_=[];function Ec(){d_.push(Jl),Jl=!1}function Ac(){const e=d_.pop();Jl=e===void 0?!0:e}function z1(e){const{cleanup:n}=e;if(e.cleanup=void 0,n){const t=Kr;Kr=void 0;try{n()}finally{Kr=t}}}let If=0;class Xx{constructor(n,t){this.sub=n,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class im{constructor(n){this.computed=n,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(n){if(!Kr||!Jl||Kr===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==Kr)t=this.activeLink=new Xx(Kr,this),Kr.deps?(t.prevDep=Kr.depsTail,Kr.depsTail.nextDep=t,Kr.depsTail=t):Kr.deps=Kr.depsTail=t,p_(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const i=t.nextDep;i.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=i),t.prevDep=Kr.depsTail,t.nextDep=void 0,Kr.depsTail.nextDep=t,Kr.depsTail=t,Kr.deps===t&&(Kr.deps=i)}return t}trigger(n){this.version++,If++,this.notify(n)}notify(n){em();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{tm()}}}function p_(e){if(e.dep.sc++,e.sub.flags&4){const n=e.dep.computed;if(n&&!e.dep.subs){n.flags|=20;for(let i=n.deps;i;i=i.nextDep)p_(i)}const t=e.dep.subs;t!==e&&(e.prevSub=t,t&&(t.nextSub=e)),e.dep.subs=e}}const Yd=new WeakMap,th=Symbol(""),tg=Symbol(""),Ff=Symbol("");function oa(e,n,t){if(Jl&&Kr){let i=Yd.get(e);i||Yd.set(e,i=new Map);let r=i.get(t);r||(i.set(t,r=new im),r.map=i,r.key=t),r.track()}}function Ku(e,n,t,i,r,o){const l=Yd.get(e);if(!l){If++;return}const h=g=>{g&&g.trigger()};if(em(),n==="clear")l.forEach(h);else{const g=ti(e),v=g&&Xg(t);if(g&&t==="length"){const _=Number(i);l.forEach((x,E)=>{(E==="length"||E===Ff||!Eu(E)&&E>=_)&&h(x)})}else switch((t!==void 0||l.has(void 0))&&h(l.get(t)),v&&h(l.get(Ff)),n){case"add":g?v&&h(l.get("length")):(h(l.get(th)),Ih(e)&&h(l.get(tg)));break;case"delete":g||(h(l.get(th)),Ih(e)&&h(l.get(tg)));break;case"set":Ih(e)&&h(l.get(th));break}}tm()}function Qx(e,n){const t=Yd.get(e);return t&&t.get(n)}function Eh(e){const n=cr(e);return n===e?n:(oa(n,"iterate",Ff),El(e)?n:n.map(aa))}function Lp(e){return oa(e=cr(e),"iterate",Ff),e}const eL={__proto__:null,[Symbol.iterator](){return C0(this,Symbol.iterator,aa)},concat(...e){return Eh(this).concat(...e.map(n=>ti(n)?Eh(n):n))},entries(){return C0(this,"entries",e=>(e[1]=aa(e[1]),e))},every(e,n){return $u(this,"every",e,n,void 0,arguments)},filter(e,n){return $u(this,"filter",e,n,t=>t.map(aa),arguments)},find(e,n){return $u(this,"find",e,n,aa,arguments)},findIndex(e,n){return $u(this,"findIndex",e,n,void 0,arguments)},findLast(e,n){return $u(this,"findLast",e,n,aa,arguments)},findLastIndex(e,n){return $u(this,"findLastIndex",e,n,void 0,arguments)},forEach(e,n){return $u(this,"forEach",e,n,void 0,arguments)},includes(...e){return S0(this,"includes",e)},indexOf(...e){return S0(this,"indexOf",e)},join(e){return Eh(this).join(e)},lastIndexOf(...e){return S0(this,"lastIndexOf",e)},map(e,n){return $u(this,"map",e,n,void 0,arguments)},pop(){return lf(this,"pop")},push(...e){return lf(this,"push",e)},reduce(e,...n){return j1(this,"reduce",e,n)},reduceRight(e,...n){return j1(this,"reduceRight",e,n)},shift(){return lf(this,"shift")},some(e,n){return $u(this,"some",e,n,void 0,arguments)},splice(...e){return lf(this,"splice",e)},toReversed(){return Eh(this).toReversed()},toSorted(e){return Eh(this).toSorted(e)},toSpliced(...e){return Eh(this).toSpliced(...e)},unshift(...e){return lf(this,"unshift",e)},values(){return C0(this,"values",aa)}};function C0(e,n,t){const i=Lp(e),r=i[n]();return i!==e&&!El(e)&&(r._next=r.next,r.next=()=>{const o=r._next();return o.value&&(o.value=t(o.value)),o}),r}const tL=Array.prototype;function $u(e,n,t,i,r,o){const l=Lp(e),h=l!==e&&!El(e),g=l[n];if(g!==tL[n]){const x=g.apply(e,o);return h?aa(x):x}let v=t;l!==e&&(h?v=function(x,E){return t.call(this,aa(x),E,e)}:t.length>2&&(v=function(x,E){return t.call(this,x,E,e)}));const _=g.call(l,v,i);return h&&r?r(_):_}function j1(e,n,t,i){const r=Lp(e);let o=t;return r!==e&&(El(e)?t.length>3&&(o=function(l,h,g){return t.call(this,l,h,g,e)}):o=function(l,h,g){return t.call(this,l,aa(h),g,e)}),r[n](o,...i)}function S0(e,n,t){const i=cr(e);oa(i,"iterate",Ff);const r=i[n](...t);return(r===-1||r===!1)&&om(t[0])?(t[0]=cr(t[0]),i[n](...t)):r}function lf(e,n,t=[]){Ec(),em();const i=cr(e)[n].apply(e,t);return tm(),Ac(),i}const nL=Kg("__proto__,__v_isRef,__isVue"),g_=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Eu));function iL(e){Eu(e)||(e=String(e));const n=cr(this);return oa(n,"has",e),n.hasOwnProperty(e)}class m_{constructor(n=!1,t=!1){this._isReadonly=n,this._isShallow=t}get(n,t,i){if(t==="__v_skip")return n.__v_skip;const r=this._isReadonly,o=this._isShallow;if(t==="__v_isReactive")return!r;if(t==="__v_isReadonly")return r;if(t==="__v_isShallow")return o;if(t==="__v_raw")return i===(r?o?dL:b_:o?__:y_).get(n)||Object.getPrototypeOf(n)===Object.getPrototypeOf(i)?n:void 0;const l=ti(n);if(!r){let g;if(l&&(g=eL[t]))return g;if(t==="hasOwnProperty")return iL}const h=Reflect.get(n,t,Ys(n)?n:i);return(Eu(t)?g_.has(t):nL(t))||(r||oa(n,"get",t),o)?h:Ys(h)?l&&Xg(t)?h:h.value:Ur(h)?r?mu(h):Au(h):h}}class v_ extends m_{constructor(n=!1){super(!1,n)}set(n,t,i,r){let o=n[t];if(!this._isShallow){const g=oh(o);if(!El(i)&&!oh(i)&&(o=cr(o),i=cr(i)),!ti(n)&&Ys(o)&&!Ys(i))return g?!1:(o.value=i,!0)}const l=ti(n)&&Xg(t)?Number(t)<n.length:Cr(n,t),h=Reflect.set(n,t,i,Ys(n)?n:r);return n===cr(r)&&(l?_c(i,o)&&Ku(n,"set",t,i):Ku(n,"add",t,i)),h}deleteProperty(n,t){const i=Cr(n,t);n[t];const r=Reflect.deleteProperty(n,t);return r&&i&&Ku(n,"delete",t,void 0),r}has(n,t){const i=Reflect.has(n,t);return(!Eu(t)||!g_.has(t))&&oa(n,"has",t),i}ownKeys(n){return oa(n,"iterate",ti(n)?"length":th),Reflect.ownKeys(n)}}class rL extends m_{constructor(n=!1){super(!0,n)}set(n,t){return!0}deleteProperty(n,t){return!0}}const sL=new v_,oL=new rL,aL=new v_(!0);const ng=e=>e,bd=e=>Reflect.getPrototypeOf(e);function lL(e,n,t){return function(...i){const r=this.__v_raw,o=cr(r),l=Ih(o),h=e==="entries"||e===Symbol.iterator&&l,g=e==="keys"&&l,v=r[e](...i),_=t?ng:n?ig:aa;return!n&&oa(o,"iterate",g?tg:th),{next(){const{value:x,done:E}=v.next();return E?{value:x,done:E}:{value:h?[_(x[0]),_(x[1])]:_(x),done:E}},[Symbol.iterator](){return this}}}}function wd(e){return function(...n){return e==="delete"?!1:e==="clear"?void 0:this}}function uL(e,n){const t={get(r){const o=this.__v_raw,l=cr(o),h=cr(r);e||(_c(r,h)&&oa(l,"get",r),oa(l,"get",h));const{has:g}=bd(l),v=n?ng:e?ig:aa;if(g.call(l,r))return v(o.get(r));if(g.call(l,h))return v(o.get(h));o!==l&&o.get(r)},get size(){const r=this.__v_raw;return!e&&oa(cr(r),"iterate",th),Reflect.get(r,"size",r)},has(r){const o=this.__v_raw,l=cr(o),h=cr(r);return e||(_c(r,h)&&oa(l,"has",r),oa(l,"has",h)),r===h?o.has(r):o.has(r)||o.has(h)},forEach(r,o){const l=this,h=l.__v_raw,g=cr(h),v=n?ng:e?ig:aa;return!e&&oa(g,"iterate",th),h.forEach((_,x)=>r.call(o,v(_),v(x),l))}};return Eo(t,e?{add:wd("add"),set:wd("set"),delete:wd("delete"),clear:wd("clear")}:{add(r){!n&&!El(r)&&!oh(r)&&(r=cr(r));const o=cr(this);return bd(o).has.call(o,r)||(o.add(r),Ku(o,"add",r,r)),this},set(r,o){!n&&!El(o)&&!oh(o)&&(o=cr(o));const l=cr(this),{has:h,get:g}=bd(l);let v=h.call(l,r);v||(r=cr(r),v=h.call(l,r));const _=g.call(l,r);return l.set(r,o),v?_c(o,_)&&Ku(l,"set",r,o):Ku(l,"add",r,o),this},delete(r){const o=cr(this),{has:l,get:h}=bd(o);let g=l.call(o,r);g||(r=cr(r),g=l.call(o,r)),h&&h.call(o,r);const v=o.delete(r);return g&&Ku(o,"delete",r,void 0),v},clear(){const r=cr(this),o=r.size!==0,l=r.clear();return o&&Ku(r,"clear",void 0,void 0),l}}),["keys","values","entries",Symbol.iterator].forEach(r=>{t[r]=lL(r,e,n)}),t}function rm(e,n){const t=uL(e,n);return(i,r,o)=>r==="__v_isReactive"?!e:r==="__v_isReadonly"?e:r==="__v_raw"?i:Reflect.get(Cr(t,r)&&r in i?t:i,r,o)}const cL={get:rm(!1,!1)},hL={get:rm(!1,!0)},fL={get:rm(!0,!1)};const y_=new WeakMap,__=new WeakMap,b_=new WeakMap,dL=new WeakMap;function pL(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function gL(e){return e.__v_skip||!Object.isExtensible(e)?0:pL(zx(e))}function Au(e){return oh(e)?e:sm(e,!1,sL,cL,y_)}function w_(e){return sm(e,!1,aL,hL,__)}function mu(e){return sm(e,!0,oL,fL,b_)}function sm(e,n,t,i,r){if(!Ur(e)||e.__v_raw&&!(n&&e.__v_isReactive))return e;const o=r.get(e);if(o)return o;const l=gL(e);if(l===0)return e;const h=new Proxy(e,l===2?i:t);return r.set(e,h),h}function bc(e){return oh(e)?bc(e.__v_raw):!!(e&&e.__v_isReactive)}function oh(e){return!!(e&&e.__v_isReadonly)}function El(e){return!!(e&&e.__v_isShallow)}function om(e){return e?!!e.__v_raw:!1}function cr(e){const n=e&&e.__v_raw;return n?cr(n):e}function am(e){return!Cr(e,"__v_skip")&&Object.isExtensible(e)&&e_(e,"__v_skip",!0),e}const aa=e=>Ur(e)?Au(e):e,ig=e=>Ur(e)?mu(e):e;function Ys(e){return e?e.__v_isRef===!0:!1}function un(e){return x_(e,!1)}function mL(e){return x_(e,!0)}function x_(e,n){return Ys(e)?e:new vL(e,n)}class vL{constructor(n,t){this.dep=new im,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?n:cr(n),this._value=t?n:aa(n),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(n){const t=this._rawValue,i=this.__v_isShallow||El(n)||oh(n);n=i?n:cr(n),_c(n,t)&&(this._rawValue=n,this._value=i?n:aa(n),this.dep.trigger())}}function Wn(e){return Ys(e)?e.value:e}const yL={get:(e,n,t)=>n==="__v_raw"?e:Wn(Reflect.get(e,n,t)),set:(e,n,t,i)=>{const r=e[n];return Ys(r)&&!Ys(t)?(r.value=t,!0):Reflect.set(e,n,t,i)}};function L_(e){return bc(e)?e:new Proxy(e,yL)}function _L(e){const n=ti(e)?new Array(e.length):{};for(const t in e)n[t]=wL(e,t);return n}class bL{constructor(n,t,i){this._object=n,this._key=t,this._defaultValue=i,this.__v_isRef=!0,this._value=void 0}get value(){const n=this._object[this._key];return this._value=n===void 0?this._defaultValue:n}set value(n){this._object[this._key]=n}get dep(){return Qx(cr(this._object),this._key)}}function wL(e,n,t){const i=e[n];return Ys(i)?i:new bL(e,n,t)}class xL{constructor(n,t,i){this.fn=n,this.setter=t,this._value=void 0,this.dep=new im(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=If-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&Kr!==this)return u_(this,!0),!0}get value(){const n=this.dep.track();return f_(this),n&&(n.version=this.dep.version),this._value}set value(n){this.setter&&this.setter(n)}}function LL(e,n,t=!1){let i,r;return Li(e)?i=e:(i=e.get,r=e.set),new xL(i,r,t)}const xd={},Xd=new WeakMap;let Gc;function CL(e,n=!1,t=Gc){if(t){let i=Xd.get(t);i||Xd.set(t,i=[]),i.push(e)}}function SL(e,n,t=jr){const{immediate:i,deep:r,once:o,scheduler:l,augmentJob:h,call:g}=t,v=Se=>r?Se:El(Se)||r===!1||r===0?Ju(Se,1):Ju(Se);let _,x,E,b,D=!1,$=!1;if(Ys(e)?(x=()=>e.value,D=El(e)):bc(e)?(x=()=>v(e),D=!0):ti(e)?($=!0,D=e.some(Se=>bc(Se)||El(Se)),x=()=>e.map(Se=>{if(Ys(Se))return Se.value;if(bc(Se))return v(Se);if(Li(Se))return g?g(Se,2):Se()})):Li(e)?n?x=g?()=>g(e,2):e:x=()=>{if(E){Ec();try{E()}finally{Ac()}}const Se=Gc;Gc=_;try{return g?g(e,3,[b]):e(b)}finally{Gc=Se}}:x=Cu,n&&r){const Se=x,Ie=r===!0?1/0:r;x=()=>Ju(Se(),Ie)}const Q=o_(),F=()=>{_.stop(),Q&&Q.active&&Yg(Q.effects,_)};if(o&&n){const Se=n;n=(...Ie)=>{Se(...Ie),F()}}let G=$?new Array(e.length).fill(xd):xd;const me=Se=>{if(!(!(_.flags&1)||!_.dirty&&!Se))if(n){const Ie=_.run();if(r||D||($?Ie.some((nt,Ve)=>_c(nt,G[Ve])):_c(Ie,G))){E&&E();const nt=Gc;Gc=_;try{const Ve=[Ie,G===xd?void 0:$&&G[0]===xd?[]:G,b];g?g(n,3,Ve):n(...Ve),G=Ie}finally{Gc=nt}}}else _.run()};return h&&h(me),_=new a_(x),_.scheduler=l?()=>l(me,!1):me,b=Se=>CL(Se,!1,_),E=_.onStop=()=>{const Se=Xd.get(_);if(Se){if(g)g(Se,4);else for(const Ie of Se)Ie();Xd.delete(_)}},n?i?me(!0):G=_.run():l?l(me.bind(null,!0),!0):_.run(),F.pause=_.pause.bind(_),F.resume=_.resume.bind(_),F.stop=F,F}function Ju(e,n=1/0,t){if(n<=0||!Ur(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),n--,Ys(e))Ju(e.value,n,t);else if(ti(e))for(let i=0;i<e.length;i++)Ju(e[i],n,t);else if(Zh(e)||Ih(e))e.forEach(i=>{Ju(i,n,t)});else if(Qy(e)){for(const i in e)Ju(e[i],n,t);for(const i of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,i)&&Ju(e[i],n,t)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Kf(e,n,t,i){try{return i?e(...i):e()}catch(r){Cp(r,n,t)}}function Yl(e,n,t,i){if(Li(e)){const r=Kf(e,n,t,i);return r&&Yy(r)&&r.catch(o=>{Cp(o,n,t)}),r}if(ti(e)){const r=[];for(let o=0;o<e.length;o++)r.push(Yl(e[o],n,t,i));return r}}function Cp(e,n,t,i=!0){const r=n?n.vnode:null,{errorHandler:o,throwUnhandledErrorInProduction:l}=n&&n.appContext.config||jr;if(n){let h=n.parent;const g=n.proxy,v=`https://vuejs.org/error-reference/#runtime-${t}`;for(;h;){const _=h.ec;if(_){for(let x=0;x<_.length;x++)if(_[x](e,g,v)===!1)return}h=h.parent}if(o){Ec(),Kf(o,null,10,[e,g,v]),Ac();return}}PL(e,t,r,i,l)}function PL(e,n,t,i=!0,r=!1){if(r)throw e;console.error(e)}const Ca=[];let vu=-1;const Fh=[];let dc=null,Th=0;const C_=Promise.resolve();let Qd=null;function Ds(e){const n=Qd||C_;return e?n.then(this?e.bind(this):e):n}function EL(e){let n=vu+1,t=Ca.length;for(;n<t;){const i=n+t>>>1,r=Ca[i],o=zf(r);o<e||o===e&&r.flags&2?n=i+1:t=i}return n}function lm(e){if(!(e.flags&1)){const n=zf(e),t=Ca[Ca.length-1];!t||!(e.flags&2)&&n>=zf(t)?Ca.push(e):Ca.splice(EL(n),0,e),e.flags|=1,S_()}}function S_(){Qd||(Qd=C_.then(E_))}function AL(e){ti(e)?Fh.push(...e):dc&&e.id===-1?dc.splice(Th+1,0,e):e.flags&1||(Fh.push(e),e.flags|=1),S_()}function U1(e,n,t=vu+1){for(;t<Ca.length;t++){const i=Ca[t];if(i&&i.flags&2){if(e&&i.id!==e.uid)continue;Ca.splice(t,1),t--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function P_(e){if(Fh.length){const n=[...new Set(Fh)].sort((t,i)=>zf(t)-zf(i));if(Fh.length=0,dc){dc.push(...n);return}for(dc=n,Th=0;Th<dc.length;Th++){const t=dc[Th];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}dc=null,Th=0}}const zf=e=>e.id==null?e.flags&2?-1:1/0:e.id;function E_(e){try{for(vu=0;vu<Ca.length;vu++){const n=Ca[vu];n&&!(n.flags&8)&&(n.flags&4&&(n.flags&=-2),Kf(n,n.i,n.i?15:14),n.flags&4||(n.flags&=-2))}}finally{for(;vu<Ca.length;vu++){const n=Ca[vu];n&&(n.flags&=-2)}vu=-1,Ca.length=0,P_(),Qd=null,(Ca.length||Fh.length)&&E_()}}let Sa=null,A_=null;function ep(e){const n=Sa;return Sa=e,A_=e&&e.type.__scopeId||null,n}function vc(e,n=Sa,t){if(!n||e._n)return e;const i=(...r)=>{i._d&&tv(-1);const o=ep(n);let l;try{l=e(...r)}finally{ep(o),i._d&&tv(1)}return l};return i._n=!0,i._c=!0,i._d=!0,i}function Dn(e,n){if(Sa===null)return e;const t=kp(Sa),i=e.dirs||(e.dirs=[]);for(let r=0;r<n.length;r++){let[o,l,h,g=jr]=n[r];o&&(Li(o)&&(o={mounted:o,updated:o}),o.deep&&Ju(l),i.push({dir:o,instance:t,value:l,oldValue:void 0,arg:h,modifiers:g}))}return e}function zc(e,n,t,i){const r=e.dirs,o=n&&n.dirs;for(let l=0;l<r.length;l++){const h=r[l];o&&(h.oldValue=o[l].value);let g=h.dir[i];g&&(Ec(),Yl(g,t,8,[e.el,h,e,n]),Ac())}}const M_=Symbol("_vte"),k_=e=>e.__isTeleport,Ef=e=>e&&(e.disabled||e.disabled===""),$1=e=>e&&(e.defer||e.defer===""),q1=e=>typeof SVGElement<"u"&&e instanceof SVGElement,V1=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,rg=(e,n)=>{const t=e&&e.to;return Is(t)?n?n(t):null:t},T_={name:"Teleport",__isTeleport:!0,process(e,n,t,i,r,o,l,h,g,v){const{mc:_,pc:x,pbc:E,o:{insert:b,querySelector:D,createText:$,createComment:Q}}=v,F=Ef(n.props);let{shapeFlag:G,children:me,dynamicChildren:Se}=n;if(e==null){const Ie=n.el=$(""),nt=n.anchor=$("");b(Ie,t,i),b(nt,t,i);const Ve=(W,ue)=>{G&16&&(r&&r.isCE&&(r.ce._teleportTarget=W),_(me,W,ue,r,o,l,h,g))},O=()=>{const W=n.target=rg(n.props,D),ue=B_(W,n,$,b);W&&(l!=="svg"&&q1(W)?l="svg":l!=="mathml"&&V1(W)&&(l="mathml"),F||(Ve(W,ue),Rd(n,!1)))};F&&(Ve(t,nt),Rd(n,!0)),$1(n.props)?xa(()=>{O(),n.el.__isMounted=!0},o):O()}else{if($1(n.props)&&!e.el.__isMounted){xa(()=>{T_.process(e,n,t,i,r,o,l,h,g,v),delete e.el.__isMounted},o);return}n.el=e.el,n.targetStart=e.targetStart;const Ie=n.anchor=e.anchor,nt=n.target=e.target,Ve=n.targetAnchor=e.targetAnchor,O=Ef(e.props),W=O?t:nt,ue=O?Ie:Ve;if(l==="svg"||q1(nt)?l="svg":(l==="mathml"||V1(nt))&&(l="mathml"),Se?(E(e.dynamicChildren,Se,W,r,o,l,h),cm(e,n,!0)):g||x(e,n,W,ue,r,o,l,h,!1),F)O?n.props&&e.props&&n.props.to!==e.props.to&&(n.props.to=e.props.to):Ld(n,t,Ie,v,1);else if((n.props&&n.props.to)!==(e.props&&e.props.to)){const z=n.target=rg(n.props,D);z&&Ld(n,z,null,v,0)}else O&&Ld(n,nt,Ve,v,1);Rd(n,F)}},remove(e,n,t,{um:i,o:{remove:r}},o){const{shapeFlag:l,children:h,anchor:g,targetStart:v,targetAnchor:_,target:x,props:E}=e;if(x&&(r(v),r(_)),o&&r(g),l&16){const b=o||!Ef(E);for(let D=0;D<h.length;D++){const $=h[D];i($,n,t,b,!!$.dynamicChildren)}}},move:Ld,hydrate:ML};function Ld(e,n,t,{o:{insert:i},m:r},o=2){o===0&&i(e.targetAnchor,n,t);const{el:l,anchor:h,shapeFlag:g,children:v,props:_}=e,x=o===2;if(x&&i(l,n,t),(!x||Ef(_))&&g&16)for(let E=0;E<v.length;E++)r(v[E],n,t,2);x&&i(h,n,t)}function ML(e,n,t,i,r,o,{o:{nextSibling:l,parentNode:h,querySelector:g,insert:v,createText:_}},x){const E=n.target=rg(n.props,g);if(E){const b=Ef(n.props),D=E._lpa||E.firstChild;if(n.shapeFlag&16)if(b)n.anchor=x(l(e),n,h(e),t,i,r,o),n.targetStart=D,n.targetAnchor=D&&l(D);else{n.anchor=l(e);let $=D;for(;$;){if($&&$.nodeType===8){if($.data==="teleport start anchor")n.targetStart=$;else if($.data==="teleport anchor"){n.targetAnchor=$,E._lpa=n.targetAnchor&&l(n.targetAnchor);break}}$=l($)}n.targetAnchor||B_(E,n,_,v),x(D&&l(D),n,E,t,i,r,o)}Rd(n,b)}return n.anchor&&l(n.anchor)}const P0=T_;function Rd(e,n){const t=e.ctx;if(t&&t.ut){let i,r;for(n?(i=e.el,r=e.anchor):(i=e.targetStart,r=e.targetAnchor);i&&i!==r;)i.nodeType===1&&i.setAttribute("data-v-owner",t.uid),i=i.nextSibling;t.ut()}}function B_(e,n,t,i){const r=n.targetStart=t(""),o=n.targetAnchor=t("");return r[M_]=o,e&&(i(r,e),i(o,e)),o}const pc=Symbol("_leaveCb"),Cd=Symbol("_enterCb");function kL(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Tl(()=>{e.isMounted=!0}),Ep(()=>{e.isUnmounting=!0}),e}const wl=[Function,Array],N_={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:wl,onEnter:wl,onAfterEnter:wl,onEnterCancelled:wl,onBeforeLeave:wl,onLeave:wl,onAfterLeave:wl,onLeaveCancelled:wl,onBeforeAppear:wl,onAppear:wl,onAfterAppear:wl,onAppearCancelled:wl},R_=e=>{const n=e.subTree;return n.component?R_(n.component):n},TL={name:"BaseTransition",props:N_,setup(e,{slots:n}){const t=MC(),i=kL();return()=>{const r=n.default&&I_(n.default(),!0);if(!r||!r.length)return;const o=D_(r),l=cr(e),{mode:h}=l;if(i.isLeaving)return E0(o);const g=G1(o);if(!g)return E0(o);let v=sg(g,l,i,t,x=>v=x);g.type!==$a&&jf(g,v);let _=t.subTree&&G1(t.subTree);if(_&&_.type!==$a&&!Wc(g,_)&&R_(t).type!==$a){let x=sg(_,l,i,t);if(jf(_,x),h==="out-in"&&g.type!==$a)return i.isLeaving=!0,x.afterLeave=()=>{i.isLeaving=!1,t.job.flags&8||t.update(),delete x.afterLeave,_=void 0},E0(o);h==="in-out"&&g.type!==$a?x.delayLeave=(E,b,D)=>{const $=O_(i,_);$[String(_.key)]=_,E[pc]=()=>{b(),E[pc]=void 0,delete v.delayedLeave,_=void 0},v.delayedLeave=()=>{D(),delete v.delayedLeave,_=void 0}}:_=void 0}else _&&(_=void 0);return o}}};function D_(e){let n=e[0];if(e.length>1){for(const t of e)if(t.type!==$a){n=t;break}}return n}const BL=TL;function O_(e,n){const{leavingVNodes:t}=e;let i=t.get(n.type);return i||(i=Object.create(null),t.set(n.type,i)),i}function sg(e,n,t,i,r){const{appear:o,mode:l,persisted:h=!1,onBeforeEnter:g,onEnter:v,onAfterEnter:_,onEnterCancelled:x,onBeforeLeave:E,onLeave:b,onAfterLeave:D,onLeaveCancelled:$,onBeforeAppear:Q,onAppear:F,onAfterAppear:G,onAppearCancelled:me}=n,Se=String(e.key),Ie=O_(t,e),nt=(W,ue)=>{W&&Yl(W,i,9,ue)},Ve=(W,ue)=>{const z=ue[1];nt(W,ue),ti(W)?W.every(R=>R.length<=1)&&z():W.length<=1&&z()},O={mode:l,persisted:h,beforeEnter(W){let ue=g;if(!t.isMounted)if(o)ue=Q||g;else return;W[pc]&&W[pc](!0);const z=Ie[Se];z&&Wc(e,z)&&z.el[pc]&&z.el[pc](),nt(ue,[W])},enter(W){let ue=v,z=_,R=x;if(!t.isMounted)if(o)ue=F||v,z=G||_,R=me||x;else return;let J=!1;const V=W[Cd]=U=>{J||(J=!0,U?nt(R,[W]):nt(z,[W]),O.delayedLeave&&O.delayedLeave(),W[Cd]=void 0)};ue?Ve(ue,[W,V]):V()},leave(W,ue){const z=String(e.key);if(W[Cd]&&W[Cd](!0),t.isUnmounting)return ue();nt(E,[W]);let R=!1;const J=W[pc]=V=>{R||(R=!0,ue(),V?nt($,[W]):nt(D,[W]),W[pc]=void 0,Ie[z]===e&&delete Ie[z])};Ie[z]=e,b?Ve(b,[W,J]):J()},clone(W){const ue=sg(W,n,t,i,r);return r&&r(ue),ue}};return O}function E0(e){if(Sp(e))return e=Lc(e),e.children=null,e}function G1(e){if(!Sp(e))return k_(e.type)&&e.children?D_(e.children):e;const{shapeFlag:n,children:t}=e;if(t){if(n&16)return t[0];if(n&32&&Li(t.default))return t.default()}}function jf(e,n){e.shapeFlag&6&&e.component?(e.transition=n,jf(e.component.subTree,n)):e.shapeFlag&128?(e.ssContent.transition=n.clone(e.ssContent),e.ssFallback.transition=n.clone(e.ssFallback)):e.transition=n}function I_(e,n=!1,t){let i=[],r=0;for(let o=0;o<e.length;o++){let l=e[o];const h=t==null?l.key:String(t)+String(l.key!=null?l.key:o);l.type===zn?(l.patchFlag&128&&r++,i=i.concat(I_(l.children,n,h))):(n||l.type!==$a)&&i.push(h!=null?Lc(l,{key:h}):l)}if(r>1)for(let o=0;o<i.length;o++)i[o].patchFlag=-2;return i}/*! #__NO_SIDE_EFFECTS__ */function Pa(e,n){return Li(e)?Eo({name:e.name},n,{setup:e}):e}function F_(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function tp(e,n,t,i,r=!1){if(ti(e)){e.forEach((D,$)=>tp(D,n&&(ti(n)?n[$]:n),t,i,r));return}if(Af(i)&&!r){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&tp(e,n,t,i.component.subTree);return}const o=i.shapeFlag&4?kp(i.component):i.el,l=r?null:o,{i:h,r:g}=e,v=n&&n.r,_=h.refs===jr?h.refs={}:h.refs,x=h.setupState,E=cr(x),b=x===jr?()=>!1:D=>Cr(E,D);if(v!=null&&v!==g&&(Is(v)?(_[v]=null,b(v)&&(x[v]=null)):Ys(v)&&(v.value=null)),Li(g))Kf(g,h,12,[l,_]);else{const D=Is(g),$=Ys(g);if(D||$){const Q=()=>{if(e.f){const F=D?b(g)?x[g]:_[g]:g.value;r?ti(F)&&Yg(F,o):ti(F)?F.includes(o)||F.push(o):D?(_[g]=[o],b(g)&&(x[g]=_[g])):(g.value=[o],e.k&&(_[e.k]=g.value))}else D?(_[g]=l,b(g)&&(x[g]=l)):$&&(g.value=l,e.k&&(_[e.k]=l))};l?(Q.id=-1,xa(Q,t)):Q()}}}xp().requestIdleCallback;xp().cancelIdleCallback;const Af=e=>!!e.type.__asyncLoader,Sp=e=>e.type.__isKeepAlive;function NL(e,n){z_(e,"a",n)}function RL(e,n){z_(e,"da",n)}function z_(e,n,t=Po){const i=e.__wdc||(e.__wdc=()=>{let r=t;for(;r;){if(r.isDeactivated)return;r=r.parent}return e()});if(Pp(n,i,t),t){let r=t.parent;for(;r&&r.parent;)Sp(r.parent.vnode)&&DL(i,n,t,r),r=r.parent}}function DL(e,n,t,i){const r=Pp(n,e,i,!0);Kh(()=>{Yg(i[n],r)},t)}function Pp(e,n,t=Po,i=!1){if(t){const r=t[e]||(t[e]=[]),o=n.__weh||(n.__weh=(...l)=>{Ec();const h=Jf(t),g=Yl(n,t,e,l);return h(),Ac(),g});return i?r.unshift(o):r.push(o),o}}const Qu=e=>(n,t=Po)=>{(!$f||e==="sp")&&Pp(e,(...i)=>n(...i),t)},OL=Qu("bm"),Tl=Qu("m"),IL=Qu("bu"),FL=Qu("u"),Ep=Qu("bum"),Kh=Qu("um"),zL=Qu("sp"),jL=Qu("rtg"),UL=Qu("rtc");function $L(e,n=Po){Pp("ec",e,n)}const qL="components";function VL(e,n){return HL(qL,e,!0,n)||e}const GL=Symbol.for("v-ndc");function HL(e,n,t=!0,i=!1){const r=Sa||Po;if(r){const o=r.type;{const h=RC(o,!1);if(h&&(h===n||h===kl(n)||h===wp(kl(n))))return o}const l=H1(r[e]||o[e],n)||H1(r.appContext[e],n);return!l&&i?o:l}}function H1(e,n){return e&&(e[n]||e[kl(n)]||e[wp(kl(n))])}function Ti(e,n,t,i){let r;const o=t,l=ti(e);if(l||Is(e)){const h=l&&bc(e);let g=!1;h&&(g=!El(e),e=Lp(e)),r=new Array(e.length);for(let v=0,_=e.length;v<_;v++)r[v]=n(g?aa(e[v]):e[v],v,void 0,o)}else if(typeof e=="number"){r=new Array(e);for(let h=0;h<e;h++)r[h]=n(h+1,h,void 0,o)}else if(Ur(e))if(e[Symbol.iterator])r=Array.from(e,(h,g)=>n(h,g,void 0,o));else{const h=Object.keys(e);r=new Array(h.length);for(let g=0,v=h.length;g<v;g++){const _=h[g];r[g]=n(e[_],_,g,o)}}else r=[];return r}const og=e=>e?r2(e)?kp(e):og(e.parent):null,Mf=Eo(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>og(e.parent),$root:e=>og(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>U_(e),$forceUpdate:e=>e.f||(e.f=()=>{lm(e.update)}),$nextTick:e=>e.n||(e.n=Ds.bind(e.proxy)),$watch:e=>pC.bind(e)}),A0=(e,n)=>e!==jr&&!e.__isScriptSetup&&Cr(e,n),WL={get({_:e},n){if(n==="__v_skip")return!0;const{ctx:t,setupState:i,data:r,props:o,accessCache:l,type:h,appContext:g}=e;let v;if(n[0]!=="$"){const b=l[n];if(b!==void 0)switch(b){case 1:return i[n];case 2:return r[n];case 4:return t[n];case 3:return o[n]}else{if(A0(i,n))return l[n]=1,i[n];if(r!==jr&&Cr(r,n))return l[n]=2,r[n];if((v=e.propsOptions[0])&&Cr(v,n))return l[n]=3,o[n];if(t!==jr&&Cr(t,n))return l[n]=4,t[n];ag&&(l[n]=0)}}const _=Mf[n];let x,E;if(_)return n==="$attrs"&&oa(e.attrs,"get",""),_(e);if((x=h.__cssModules)&&(x=x[n]))return x;if(t!==jr&&Cr(t,n))return l[n]=4,t[n];if(E=g.config.globalProperties,Cr(E,n))return E[n]},set({_:e},n,t){const{data:i,setupState:r,ctx:o}=e;return A0(r,n)?(r[n]=t,!0):i!==jr&&Cr(i,n)?(i[n]=t,!0):Cr(e.props,n)||n[0]==="$"&&n.slice(1)in e?!1:(o[n]=t,!0)},has({_:{data:e,setupState:n,accessCache:t,ctx:i,appContext:r,propsOptions:o}},l){let h;return!!t[l]||e!==jr&&Cr(e,l)||A0(n,l)||(h=o[0])&&Cr(h,l)||Cr(i,l)||Cr(Mf,l)||Cr(r.config.globalProperties,l)},defineProperty(e,n,t){return t.get!=null?e._.accessCache[n]=0:Cr(t,"value")&&this.set(e,n,t.value,null),Reflect.defineProperty(e,n,t)}};function W1(e){return ti(e)?e.reduce((n,t)=>(n[t]=null,n),{}):e}let ag=!0;function ZL(e){const n=U_(e),t=e.proxy,i=e.ctx;ag=!1,n.beforeCreate&&Z1(n.beforeCreate,e,"bc");const{data:r,computed:o,methods:l,watch:h,provide:g,inject:v,created:_,beforeMount:x,mounted:E,beforeUpdate:b,updated:D,activated:$,deactivated:Q,beforeDestroy:F,beforeUnmount:G,destroyed:me,unmounted:Se,render:Ie,renderTracked:nt,renderTriggered:Ve,errorCaptured:O,serverPrefetch:W,expose:ue,inheritAttrs:z,components:R,directives:J,filters:V}=n;if(v&&KL(v,i,null),l)for(const ce in l){const re=l[ce];Li(re)&&(i[ce]=re.bind(t))}if(r){const ce=r.call(t,t);Ur(ce)&&(e.data=Au(ce))}if(ag=!0,o)for(const ce in o){const re=o[ce],Pe=Li(re)?re.bind(t,t):Li(re.get)?re.get.bind(t,t):Cu,Me=!Li(re)&&Li(re.set)?re.set.bind(t):Cu,ot=Ni({get:Pe,set:Me});Object.defineProperty(i,ce,{enumerable:!0,configurable:!0,get:()=>ot.value,set:X=>ot.value=X})}if(h)for(const ce in h)j_(h[ce],i,t,ce);if(g){const ce=Li(g)?g.call(t):g;Reflect.ownKeys(ce).forEach(re=>{Dd(re,ce[re])})}_&&Z1(_,e,"c");function Y(ce,re){ti(re)?re.forEach(Pe=>ce(Pe.bind(t))):re&&ce(re.bind(t))}if(Y(OL,x),Y(Tl,E),Y(IL,b),Y(FL,D),Y(NL,$),Y(RL,Q),Y($L,O),Y(UL,nt),Y(jL,Ve),Y(Ep,G),Y(Kh,Se),Y(zL,W),ti(ue))if(ue.length){const ce=e.exposed||(e.exposed={});ue.forEach(re=>{Object.defineProperty(ce,re,{get:()=>t[re],set:Pe=>t[re]=Pe})})}else e.exposed||(e.exposed={});Ie&&e.render===Cu&&(e.render=Ie),z!=null&&(e.inheritAttrs=z),R&&(e.components=R),J&&(e.directives=J),W&&F_(e)}function KL(e,n,t=Cu){ti(e)&&(e=lg(e));for(const i in e){const r=e[i];let o;Ur(r)?"default"in r?o=Al(r.from||i,r.default,!0):o=Al(r.from||i):o=Al(r),Ys(o)?Object.defineProperty(n,i,{enumerable:!0,configurable:!0,get:()=>o.value,set:l=>o.value=l}):n[i]=o}}function Z1(e,n,t){Yl(ti(e)?e.map(i=>i.bind(n.proxy)):e.bind(n.proxy),n,t)}function j_(e,n,t,i){let r=i.includes(".")?Q_(t,i):()=>t[i];if(Is(e)){const o=n[e];Li(o)&&So(r,o)}else if(Li(e))So(r,e.bind(t));else if(Ur(e))if(ti(e))e.forEach(o=>j_(o,n,t,i));else{const o=Li(e.handler)?e.handler.bind(t):n[e.handler];Li(o)&&So(r,o,e)}}function U_(e){const n=e.type,{mixins:t,extends:i}=n,{mixins:r,optionsCache:o,config:{optionMergeStrategies:l}}=e.appContext,h=o.get(n);let g;return h?g=h:!r.length&&!t&&!i?g=n:(g={},r.length&&r.forEach(v=>np(g,v,l,!0)),np(g,n,l)),Ur(n)&&o.set(n,g),g}function np(e,n,t,i=!1){const{mixins:r,extends:o}=n;o&&np(e,o,t,!0),r&&r.forEach(l=>np(e,l,t,!0));for(const l in n)if(!(i&&l==="expose")){const h=JL[l]||t&&t[l];e[l]=h?h(e[l],n[l]):n[l]}return e}const JL={data:K1,props:J1,emits:J1,methods:yf,computed:yf,beforeCreate:_a,created:_a,beforeMount:_a,mounted:_a,beforeUpdate:_a,updated:_a,beforeDestroy:_a,beforeUnmount:_a,destroyed:_a,unmounted:_a,activated:_a,deactivated:_a,errorCaptured:_a,serverPrefetch:_a,components:yf,directives:yf,watch:XL,provide:K1,inject:YL};function K1(e,n){return n?e?function(){return Eo(Li(e)?e.call(this,this):e,Li(n)?n.call(this,this):n)}:n:e}function YL(e,n){return yf(lg(e),lg(n))}function lg(e){if(ti(e)){const n={};for(let t=0;t<e.length;t++)n[e[t]]=e[t];return n}return e}function _a(e,n){return e?[...new Set([].concat(e,n))]:n}function yf(e,n){return e?Eo(Object.create(null),e,n):n}function J1(e,n){return e?ti(e)&&ti(n)?[...new Set([...e,...n])]:Eo(Object.create(null),W1(e),W1(n??{})):n}function XL(e,n){if(!e)return n;if(!n)return e;const t=Eo(Object.create(null),e);for(const i in n)t[i]=_a(e[i],n[i]);return t}function $_(){return{app:null,config:{isNativeTag:Ix,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let QL=0;function eC(e,n){return function(i,r=null){Li(i)||(i=Eo({},i)),r!=null&&!Ur(r)&&(r=null);const o=$_(),l=new WeakSet,h=[];let g=!1;const v=o.app={_uid:QL++,_component:i,_props:r,_container:null,_context:o,_instance:null,version:OC,get config(){return o.config},set config(_){},use(_,...x){return l.has(_)||(_&&Li(_.install)?(l.add(_),_.install(v,...x)):Li(_)&&(l.add(_),_(v,...x))),v},mixin(_){return o.mixins.includes(_)||o.mixins.push(_),v},component(_,x){return x?(o.components[_]=x,v):o.components[_]},directive(_,x){return x?(o.directives[_]=x,v):o.directives[_]},mount(_,x,E){if(!g){const b=v._ceVNode||Yr(i,r);return b.appContext=o,E===!0?E="svg":E===!1&&(E=void 0),e(b,_,E),g=!0,v._container=_,_.__vue_app__=v,kp(b.component)}},onUnmount(_){h.push(_)},unmount(){g&&(Yl(h,v._instance,16),e(null,v._container),delete v._container.__vue_app__)},provide(_,x){return o.provides[_]=x,v},runWithContext(_){const x=nh;nh=v;try{return _()}finally{nh=x}}};return v}}let nh=null;function Dd(e,n){if(Po){let t=Po.provides;const i=Po.parent&&Po.parent.provides;i===t&&(t=Po.provides=Object.create(i)),t[e]=n}}function Al(e,n,t=!1){const i=Po||Sa;if(i||nh){const r=nh?nh._context.provides:i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(r&&e in r)return r[e];if(arguments.length>1)return t&&Li(n)?n.call(i&&i.proxy):n}}function tC(){return!!(Po||Sa||nh)}const q_={},V_=()=>Object.create(q_),G_=e=>Object.getPrototypeOf(e)===q_;function nC(e,n,t,i=!1){const r={},o=V_();e.propsDefaults=Object.create(null),H_(e,n,r,o);for(const l in e.propsOptions[0])l in r||(r[l]=void 0);t?e.props=i?r:w_(r):e.type.props?e.props=r:e.props=o,e.attrs=o}function iC(e,n,t,i){const{props:r,attrs:o,vnode:{patchFlag:l}}=e,h=cr(r),[g]=e.propsOptions;let v=!1;if((i||l>0)&&!(l&16)){if(l&8){const _=e.vnode.dynamicProps;for(let x=0;x<_.length;x++){let E=_[x];if(Ap(e.emitsOptions,E))continue;const b=n[E];if(g)if(Cr(o,E))b!==o[E]&&(o[E]=b,v=!0);else{const D=kl(E);r[D]=ug(g,h,D,b,e,!1)}else b!==o[E]&&(o[E]=b,v=!0)}}}else{H_(e,n,r,o)&&(v=!0);let _;for(const x in h)(!n||!Cr(n,x)&&((_=uh(x))===x||!Cr(n,_)))&&(g?t&&(t[x]!==void 0||t[_]!==void 0)&&(r[x]=ug(g,h,x,void 0,e,!0)):delete r[x]);if(o!==h)for(const x in o)(!n||!Cr(n,x))&&(delete o[x],v=!0)}v&&Ku(e.attrs,"set","")}function H_(e,n,t,i){const[r,o]=e.propsOptions;let l=!1,h;if(n)for(let g in n){if(Cf(g))continue;const v=n[g];let _;r&&Cr(r,_=kl(g))?!o||!o.includes(_)?t[_]=v:(h||(h={}))[_]=v:Ap(e.emitsOptions,g)||(!(g in i)||v!==i[g])&&(i[g]=v,l=!0)}if(o){const g=cr(t),v=h||jr;for(let _=0;_<o.length;_++){const x=o[_];t[x]=ug(r,g,x,v[x],e,!Cr(v,x))}}return l}function ug(e,n,t,i,r,o){const l=e[t];if(l!=null){const h=Cr(l,"default");if(h&&i===void 0){const g=l.default;if(l.type!==Function&&!l.skipFactory&&Li(g)){const{propsDefaults:v}=r;if(t in v)i=v[t];else{const _=Jf(r);i=v[t]=g.call(null,n),_()}}else i=g;r.ce&&r.ce._setProp(t,i)}l[0]&&(o&&!h?i=!1:l[1]&&(i===""||i===uh(t))&&(i=!0))}return i}const rC=new WeakMap;function W_(e,n,t=!1){const i=t?rC:n.propsCache,r=i.get(e);if(r)return r;const o=e.props,l={},h=[];let g=!1;if(!Li(e)){const _=x=>{g=!0;const[E,b]=W_(x,n,!0);Eo(l,E),b&&h.push(...b)};!t&&n.mixins.length&&n.mixins.forEach(_),e.extends&&_(e.extends),e.mixins&&e.mixins.forEach(_)}if(!o&&!g)return Ur(e)&&i.set(e,Oh),Oh;if(ti(o))for(let _=0;_<o.length;_++){const x=kl(o[_]);Y1(x)&&(l[x]=jr)}else if(o)for(const _ in o){const x=kl(_);if(Y1(x)){const E=o[_],b=l[x]=ti(E)||Li(E)?{type:E}:Eo({},E),D=b.type;let $=!1,Q=!0;if(ti(D))for(let F=0;F<D.length;++F){const G=D[F],me=Li(G)&&G.name;if(me==="Boolean"){$=!0;break}else me==="String"&&(Q=!1)}else $=Li(D)&&D.name==="Boolean";b[0]=$,b[1]=Q,($||Cr(b,"default"))&&h.push(x)}}const v=[l,h];return Ur(e)&&i.set(e,v),v}function Y1(e){return e[0]!=="$"&&!Cf(e)}const Z_=e=>e[0]==="_"||e==="$stable",um=e=>ti(e)?e.map(bu):[bu(e)],sC=(e,n,t)=>{if(n._n)return n;const i=vc((...r)=>um(n(...r)),t);return i._c=!1,i},K_=(e,n,t)=>{const i=e._ctx;for(const r in e){if(Z_(r))continue;const o=e[r];if(Li(o))n[r]=sC(r,o,i);else if(o!=null){const l=um(o);n[r]=()=>l}}},J_=(e,n)=>{const t=um(n);e.slots.default=()=>t},Y_=(e,n,t)=>{for(const i in n)(t||i!=="_")&&(e[i]=n[i])},oC=(e,n,t)=>{const i=e.slots=V_();if(e.vnode.shapeFlag&32){const r=n._;r?(Y_(i,n,t),t&&e_(i,"_",r,!0)):K_(n,i)}else n&&J_(e,n)},aC=(e,n,t)=>{const{vnode:i,slots:r}=e;let o=!0,l=jr;if(i.shapeFlag&32){const h=n._;h?t&&h===1?o=!1:Y_(r,n,t):(o=!n.$stable,K_(n,r)),l=n}else n&&(J_(e,n),l={default:1});if(o)for(const h in r)!Z_(h)&&l[h]==null&&delete r[h]},xa=wC;function lC(e){return uC(e)}function uC(e,n){const t=xp();t.__VUE__=!0;const{insert:i,remove:r,patchProp:o,createElement:l,createText:h,createComment:g,setText:v,setElementText:_,parentNode:x,nextSibling:E,setScopeId:b=Cu,insertStaticContent:D}=e,$=(ne,ae,xe,ye=null,le=null,je=null,Re=void 0,Ae=null,qe=!!ae.dynamicChildren)=>{if(ne===ae)return;ne&&!Wc(ne,ae)&&(ye=te(ne),X(ne,le,je,!0),ne=null),ae.patchFlag===-2&&(qe=!1,ae.dynamicChildren=null);const{type:Oe,ref:et,shapeFlag:Je}=ae;switch(Oe){case Mp:Q(ne,ae,xe,ye);break;case $a:F(ne,ae,xe,ye);break;case Od:ne==null&&G(ae,xe,ye,Re);break;case zn:R(ne,ae,xe,ye,le,je,Re,Ae,qe);break;default:Je&1?Ie(ne,ae,xe,ye,le,je,Re,Ae,qe):Je&6?J(ne,ae,xe,ye,le,je,Re,Ae,qe):(Je&64||Je&128)&&Oe.process(ne,ae,xe,ye,le,je,Re,Ae,qe,se)}et!=null&&le&&tp(et,ne&&ne.ref,je,ae||ne,!ae)},Q=(ne,ae,xe,ye)=>{if(ne==null)i(ae.el=h(ae.children),xe,ye);else{const le=ae.el=ne.el;ae.children!==ne.children&&v(le,ae.children)}},F=(ne,ae,xe,ye)=>{ne==null?i(ae.el=g(ae.children||""),xe,ye):ae.el=ne.el},G=(ne,ae,xe,ye)=>{[ne.el,ne.anchor]=D(ne.children,ae,xe,ye,ne.el,ne.anchor)},me=({el:ne,anchor:ae},xe,ye)=>{let le;for(;ne&&ne!==ae;)le=E(ne),i(ne,xe,ye),ne=le;i(ae,xe,ye)},Se=({el:ne,anchor:ae})=>{let xe;for(;ne&&ne!==ae;)xe=E(ne),r(ne),ne=xe;r(ae)},Ie=(ne,ae,xe,ye,le,je,Re,Ae,qe)=>{ae.type==="svg"?Re="svg":ae.type==="math"&&(Re="mathml"),ne==null?nt(ae,xe,ye,le,je,Re,Ae,qe):W(ne,ae,le,je,Re,Ae,qe)},nt=(ne,ae,xe,ye,le,je,Re,Ae)=>{let qe,Oe;const{props:et,shapeFlag:Je,transition:mt,dirs:_t}=ne;if(qe=ne.el=l(ne.type,je,et&&et.is,et),Je&8?_(qe,ne.children):Je&16&&O(ne.children,qe,null,ye,le,M0(ne,je),Re,Ae),_t&&zc(ne,null,ye,"created"),Ve(qe,ne,ne.scopeId,Re,ye),et){for(const Xt in et)Xt!=="value"&&!Cf(Xt)&&o(qe,Xt,null,et[Xt],je,ye);"value"in et&&o(qe,"value",null,et.value,je),(Oe=et.onVnodeBeforeMount)&&fu(Oe,ye,ne)}_t&&zc(ne,null,ye,"beforeMount");const $t=cC(le,mt);$t&&mt.beforeEnter(qe),i(qe,ae,xe),((Oe=et&&et.onVnodeMounted)||$t||_t)&&xa(()=>{Oe&&fu(Oe,ye,ne),$t&&mt.enter(qe),_t&&zc(ne,null,ye,"mounted")},le)},Ve=(ne,ae,xe,ye,le)=>{if(xe&&b(ne,xe),ye)for(let je=0;je<ye.length;je++)b(ne,ye[je]);if(le){let je=le.subTree;if(ae===je||t2(je.type)&&(je.ssContent===ae||je.ssFallback===ae)){const Re=le.vnode;Ve(ne,Re,Re.scopeId,Re.slotScopeIds,le.parent)}}},O=(ne,ae,xe,ye,le,je,Re,Ae,qe=0)=>{for(let Oe=qe;Oe<ne.length;Oe++){const et=ne[Oe]=Ae?gc(ne[Oe]):bu(ne[Oe]);$(null,et,ae,xe,ye,le,je,Re,Ae)}},W=(ne,ae,xe,ye,le,je,Re)=>{const Ae=ae.el=ne.el;let{patchFlag:qe,dynamicChildren:Oe,dirs:et}=ae;qe|=ne.patchFlag&16;const Je=ne.props||jr,mt=ae.props||jr;let _t;if(xe&&jc(xe,!1),(_t=mt.onVnodeBeforeUpdate)&&fu(_t,xe,ae,ne),et&&zc(ae,ne,xe,"beforeUpdate"),xe&&jc(xe,!0),(Je.innerHTML&&mt.innerHTML==null||Je.textContent&&mt.textContent==null)&&_(Ae,""),Oe?ue(ne.dynamicChildren,Oe,Ae,xe,ye,M0(ae,le),je):Re||re(ne,ae,Ae,null,xe,ye,M0(ae,le),je,!1),qe>0){if(qe&16)z(Ae,Je,mt,xe,le);else if(qe&2&&Je.class!==mt.class&&o(Ae,"class",null,mt.class,le),qe&4&&o(Ae,"style",Je.style,mt.style,le),qe&8){const $t=ae.dynamicProps;for(let Xt=0;Xt<$t.length;Xt++){const Xe=$t[Xt],Kt=Je[Xe],Qt=mt[Xe];(Qt!==Kt||Xe==="value")&&o(Ae,Xe,Kt,Qt,le,xe)}}qe&1&&ne.children!==ae.children&&_(Ae,ae.children)}else!Re&&Oe==null&&z(Ae,Je,mt,xe,le);((_t=mt.onVnodeUpdated)||et)&&xa(()=>{_t&&fu(_t,xe,ae,ne),et&&zc(ae,ne,xe,"updated")},ye)},ue=(ne,ae,xe,ye,le,je,Re)=>{for(let Ae=0;Ae<ae.length;Ae++){const qe=ne[Ae],Oe=ae[Ae],et=qe.el&&(qe.type===zn||!Wc(qe,Oe)||qe.shapeFlag&70)?x(qe.el):xe;$(qe,Oe,et,null,ye,le,je,Re,!0)}},z=(ne,ae,xe,ye,le)=>{if(ae!==xe){if(ae!==jr)for(const je in ae)!Cf(je)&&!(je in xe)&&o(ne,je,ae[je],null,le,ye);for(const je in xe){if(Cf(je))continue;const Re=xe[je],Ae=ae[je];Re!==Ae&&je!=="value"&&o(ne,je,Ae,Re,le,ye)}"value"in xe&&o(ne,"value",ae.value,xe.value,le)}},R=(ne,ae,xe,ye,le,je,Re,Ae,qe)=>{const Oe=ae.el=ne?ne.el:h(""),et=ae.anchor=ne?ne.anchor:h("");let{patchFlag:Je,dynamicChildren:mt,slotScopeIds:_t}=ae;_t&&(Ae=Ae?Ae.concat(_t):_t),ne==null?(i(Oe,xe,ye),i(et,xe,ye),O(ae.children||[],xe,et,le,je,Re,Ae,qe)):Je>0&&Je&64&&mt&&ne.dynamicChildren?(ue(ne.dynamicChildren,mt,xe,le,je,Re,Ae),(ae.key!=null||le&&ae===le.subTree)&&cm(ne,ae,!0)):re(ne,ae,xe,et,le,je,Re,Ae,qe)},J=(ne,ae,xe,ye,le,je,Re,Ae,qe)=>{ae.slotScopeIds=Ae,ne==null?ae.shapeFlag&512?le.ctx.activate(ae,xe,ye,Re,qe):V(ae,xe,ye,le,je,Re,qe):U(ne,ae,qe)},V=(ne,ae,xe,ye,le,je,Re)=>{const Ae=ne.component=AC(ne,ye,le);if(Sp(ne)&&(Ae.ctx.renderer=se),kC(Ae,!1,Re),Ae.asyncDep){if(le&&le.registerDep(Ae,Y,Re),!ne.el){const qe=Ae.subTree=Yr($a);F(null,qe,ae,xe)}}else Y(Ae,ne,ae,xe,le,je,Re)},U=(ne,ae,xe)=>{const ye=ae.component=ne.component;if(_C(ne,ae,xe))if(ye.asyncDep&&!ye.asyncResolved){ce(ye,ae,xe);return}else ye.next=ae,ye.update();else ae.el=ne.el,ye.vnode=ae},Y=(ne,ae,xe,ye,le,je,Re)=>{const Ae=()=>{if(ne.isMounted){let{next:Je,bu:mt,u:_t,parent:$t,vnode:Xt}=ne;{const We=X_(ne);if(We){Je&&(Je.el=Xt.el,ce(ne,Je,Re)),We.asyncDep.then(()=>{ne.isUnmounted||Ae()});return}}let Xe=Je,Kt;jc(ne,!1),Je?(Je.el=Xt.el,ce(ne,Je,Re)):Je=Xt,mt&&Nd(mt),(Kt=Je.props&&Je.props.onVnodeBeforeUpdate)&&fu(Kt,$t,Je,Xt),jc(ne,!0);const Qt=Q1(ne),Qe=ne.subTree;ne.subTree=Qt,$(Qe,Qt,x(Qe.el),te(Qe),ne,le,je),Je.el=Qt.el,Xe===null&&bC(ne,Qt.el),_t&&xa(_t,le),(Kt=Je.props&&Je.props.onVnodeUpdated)&&xa(()=>fu(Kt,$t,Je,Xt),le)}else{let Je;const{el:mt,props:_t}=ae,{bm:$t,m:Xt,parent:Xe,root:Kt,type:Qt}=ne,Qe=Af(ae);jc(ne,!1),$t&&Nd($t),!Qe&&(Je=_t&&_t.onVnodeBeforeMount)&&fu(Je,Xe,ae),jc(ne,!0);{Kt.ce&&Kt.ce._injectChildStyle(Qt);const We=ne.subTree=Q1(ne);$(null,We,xe,ye,ne,le,je),ae.el=We.el}if(Xt&&xa(Xt,le),!Qe&&(Je=_t&&_t.onVnodeMounted)){const We=ae;xa(()=>fu(Je,Xe,We),le)}(ae.shapeFlag&256||Xe&&Af(Xe.vnode)&&Xe.vnode.shapeFlag&256)&&ne.a&&xa(ne.a,le),ne.isMounted=!0,ae=xe=ye=null}};ne.scope.on();const qe=ne.effect=new a_(Ae);ne.scope.off();const Oe=ne.update=qe.run.bind(qe),et=ne.job=qe.runIfDirty.bind(qe);et.i=ne,et.id=ne.uid,qe.scheduler=()=>lm(et),jc(ne,!0),Oe()},ce=(ne,ae,xe)=>{ae.component=ne;const ye=ne.vnode.props;ne.vnode=ae,ne.next=null,iC(ne,ae.props,ye,xe),aC(ne,ae.children,xe),Ec(),U1(ne),Ac()},re=(ne,ae,xe,ye,le,je,Re,Ae,qe=!1)=>{const Oe=ne&&ne.children,et=ne?ne.shapeFlag:0,Je=ae.children,{patchFlag:mt,shapeFlag:_t}=ae;if(mt>0){if(mt&128){Me(Oe,Je,xe,ye,le,je,Re,Ae,qe);return}else if(mt&256){Pe(Oe,Je,xe,ye,le,je,Re,Ae,qe);return}}_t&8?(et&16&&he(Oe,le,je),Je!==Oe&&_(xe,Je)):et&16?_t&16?Me(Oe,Je,xe,ye,le,je,Re,Ae,qe):he(Oe,le,je,!0):(et&8&&_(xe,""),_t&16&&O(Je,xe,ye,le,je,Re,Ae,qe))},Pe=(ne,ae,xe,ye,le,je,Re,Ae,qe)=>{ne=ne||Oh,ae=ae||Oh;const Oe=ne.length,et=ae.length,Je=Math.min(Oe,et);let mt;for(mt=0;mt<Je;mt++){const _t=ae[mt]=qe?gc(ae[mt]):bu(ae[mt]);$(ne[mt],_t,xe,null,le,je,Re,Ae,qe)}Oe>et?he(ne,le,je,!0,!1,Je):O(ae,xe,ye,le,je,Re,Ae,qe,Je)},Me=(ne,ae,xe,ye,le,je,Re,Ae,qe)=>{let Oe=0;const et=ae.length;let Je=ne.length-1,mt=et-1;for(;Oe<=Je&&Oe<=mt;){const _t=ne[Oe],$t=ae[Oe]=qe?gc(ae[Oe]):bu(ae[Oe]);if(Wc(_t,$t))$(_t,$t,xe,null,le,je,Re,Ae,qe);else break;Oe++}for(;Oe<=Je&&Oe<=mt;){const _t=ne[Je],$t=ae[mt]=qe?gc(ae[mt]):bu(ae[mt]);if(Wc(_t,$t))$(_t,$t,xe,null,le,je,Re,Ae,qe);else break;Je--,mt--}if(Oe>Je){if(Oe<=mt){const _t=mt+1,$t=_t<et?ae[_t].el:ye;for(;Oe<=mt;)$(null,ae[Oe]=qe?gc(ae[Oe]):bu(ae[Oe]),xe,$t,le,je,Re,Ae,qe),Oe++}}else if(Oe>mt)for(;Oe<=Je;)X(ne[Oe],le,je,!0),Oe++;else{const _t=Oe,$t=Oe,Xt=new Map;for(Oe=$t;Oe<=mt;Oe++){const _n=ae[Oe]=qe?gc(ae[Oe]):bu(ae[Oe]);_n.key!=null&&Xt.set(_n.key,Oe)}let Xe,Kt=0;const Qt=mt-$t+1;let Qe=!1,We=0;const Ut=new Array(Qt);for(Oe=0;Oe<Qt;Oe++)Ut[Oe]=0;for(Oe=_t;Oe<=Je;Oe++){const _n=ne[Oe];if(Kt>=Qt){X(_n,le,je,!0);continue}let mn;if(_n.key!=null)mn=Xt.get(_n.key);else for(Xe=$t;Xe<=mt;Xe++)if(Ut[Xe-$t]===0&&Wc(_n,ae[Xe])){mn=Xe;break}mn===void 0?X(_n,le,je,!0):(Ut[mn-$t]=Oe+1,mn>=We?We=mn:Qe=!0,$(_n,ae[mn],xe,null,le,je,Re,Ae,qe),Kt++)}const pn=Qe?hC(Ut):Oh;for(Xe=pn.length-1,Oe=Qt-1;Oe>=0;Oe--){const _n=$t+Oe,mn=ae[_n],rt=_n+1<et?ae[_n+1].el:ye;Ut[Oe]===0?$(null,mn,xe,rt,le,je,Re,Ae,qe):Qe&&(Xe<0||Oe!==pn[Xe]?ot(mn,xe,rt,2):Xe--)}}},ot=(ne,ae,xe,ye,le=null)=>{const{el:je,type:Re,transition:Ae,children:qe,shapeFlag:Oe}=ne;if(Oe&6){ot(ne.component.subTree,ae,xe,ye);return}if(Oe&128){ne.suspense.move(ae,xe,ye);return}if(Oe&64){Re.move(ne,ae,xe,se);return}if(Re===zn){i(je,ae,xe);for(let Je=0;Je<qe.length;Je++)ot(qe[Je],ae,xe,ye);i(ne.anchor,ae,xe);return}if(Re===Od){me(ne,ae,xe);return}if(ye!==2&&Oe&1&&Ae)if(ye===0)Ae.beforeEnter(je),i(je,ae,xe),xa(()=>Ae.enter(je),le);else{const{leave:Je,delayLeave:mt,afterLeave:_t}=Ae,$t=()=>i(je,ae,xe),Xt=()=>{Je(je,()=>{$t(),_t&&_t()})};mt?mt(je,$t,Xt):Xt()}else i(je,ae,xe)},X=(ne,ae,xe,ye=!1,le=!1)=>{const{type:je,props:Re,ref:Ae,children:qe,dynamicChildren:Oe,shapeFlag:et,patchFlag:Je,dirs:mt,cacheIndex:_t}=ne;if(Je===-2&&(le=!1),Ae!=null&&tp(Ae,null,xe,ne,!0),_t!=null&&(ae.renderCache[_t]=void 0),et&256){ae.ctx.deactivate(ne);return}const $t=et&1&&mt,Xt=!Af(ne);let Xe;if(Xt&&(Xe=Re&&Re.onVnodeBeforeUnmount)&&fu(Xe,ae,ne),et&6)H(ne.component,xe,ye);else{if(et&128){ne.suspense.unmount(xe,ye);return}$t&&zc(ne,null,ae,"beforeUnmount"),et&64?ne.type.remove(ne,ae,xe,se,ye):Oe&&!Oe.hasOnce&&(je!==zn||Je>0&&Je&64)?he(Oe,ae,xe,!1,!0):(je===zn&&Je&384||!le&&et&16)&&he(qe,ae,xe),ye&&Ee(ne)}(Xt&&(Xe=Re&&Re.onVnodeUnmounted)||$t)&&xa(()=>{Xe&&fu(Xe,ae,ne),$t&&zc(ne,null,ae,"unmounted")},xe)},Ee=ne=>{const{type:ae,el:xe,anchor:ye,transition:le}=ne;if(ae===zn){B(xe,ye);return}if(ae===Od){Se(ne);return}const je=()=>{r(xe),le&&!le.persisted&&le.afterLeave&&le.afterLeave()};if(ne.shapeFlag&1&&le&&!le.persisted){const{leave:Re,delayLeave:Ae}=le,qe=()=>Re(xe,je);Ae?Ae(ne.el,je,qe):qe()}else je()},B=(ne,ae)=>{let xe;for(;ne!==ae;)xe=E(ne),r(ne),ne=xe;r(ae)},H=(ne,ae,xe)=>{const{bum:ye,scope:le,job:je,subTree:Re,um:Ae,m:qe,a:Oe}=ne;X1(qe),X1(Oe),ye&&Nd(ye),le.stop(),je&&(je.flags|=8,X(Re,ne,ae,xe)),Ae&&xa(Ae,ae),xa(()=>{ne.isUnmounted=!0},ae),ae&&ae.pendingBranch&&!ae.isUnmounted&&ne.asyncDep&&!ne.asyncResolved&&ne.suspenseId===ae.pendingId&&(ae.deps--,ae.deps===0&&ae.resolve())},he=(ne,ae,xe,ye=!1,le=!1,je=0)=>{for(let Re=je;Re<ne.length;Re++)X(ne[Re],ae,xe,ye,le)},te=ne=>{if(ne.shapeFlag&6)return te(ne.component.subTree);if(ne.shapeFlag&128)return ne.suspense.next();const ae=E(ne.anchor||ne.el),xe=ae&&ae[M_];return xe?E(xe):ae};let ie=!1;const ee=(ne,ae,xe)=>{ne==null?ae._vnode&&X(ae._vnode,null,null,!0):$(ae._vnode||null,ne,ae,null,null,null,xe),ae._vnode=ne,ie||(ie=!0,U1(),P_(),ie=!1)},se={p:$,um:X,m:ot,r:Ee,mt:V,mc:O,pc:re,pbc:ue,n:te,o:e};return{render:ee,hydrate:void 0,createApp:eC(ee)}}function M0({type:e,props:n},t){return t==="svg"&&e==="foreignObject"||t==="mathml"&&e==="annotation-xml"&&n&&n.encoding&&n.encoding.includes("html")?void 0:t}function jc({effect:e,job:n},t){t?(e.flags|=32,n.flags|=4):(e.flags&=-33,n.flags&=-5)}function cC(e,n){return(!e||e&&!e.pendingBranch)&&n&&!n.persisted}function cm(e,n,t=!1){const i=e.children,r=n.children;if(ti(i)&&ti(r))for(let o=0;o<i.length;o++){const l=i[o];let h=r[o];h.shapeFlag&1&&!h.dynamicChildren&&((h.patchFlag<=0||h.patchFlag===32)&&(h=r[o]=gc(r[o]),h.el=l.el),!t&&h.patchFlag!==-2&&cm(l,h)),h.type===Mp&&(h.el=l.el)}}function hC(e){const n=e.slice(),t=[0];let i,r,o,l,h;const g=e.length;for(i=0;i<g;i++){const v=e[i];if(v!==0){if(r=t[t.length-1],e[r]<v){n[i]=r,t.push(i);continue}for(o=0,l=t.length-1;o<l;)h=o+l>>1,e[t[h]]<v?o=h+1:l=h;v<e[t[o]]&&(o>0&&(n[i]=t[o-1]),t[o]=i)}}for(o=t.length,l=t[o-1];o-- >0;)t[o]=l,l=n[l];return t}function X_(e){const n=e.subTree.component;if(n)return n.asyncDep&&!n.asyncResolved?n:X_(n)}function X1(e){if(e)for(let n=0;n<e.length;n++)e[n].flags|=8}const fC=Symbol.for("v-scx"),dC=()=>Al(fC);function cg(e,n){return hm(e,null,n)}function So(e,n,t){return hm(e,n,t)}function hm(e,n,t=jr){const{immediate:i,deep:r,flush:o,once:l}=t,h=Eo({},t),g=n&&i||!n&&o!=="post";let v;if($f){if(o==="sync"){const b=dC();v=b.__watcherHandles||(b.__watcherHandles=[])}else if(!g){const b=()=>{};return b.stop=Cu,b.resume=Cu,b.pause=Cu,b}}const _=Po;h.call=(b,D,$)=>Yl(b,_,D,$);let x=!1;o==="post"?h.scheduler=b=>{xa(b,_&&_.suspense)}:o!=="sync"&&(x=!0,h.scheduler=(b,D)=>{D?b():lm(b)}),h.augmentJob=b=>{n&&(b.flags|=4),x&&(b.flags|=2,_&&(b.id=_.uid,b.i=_))};const E=SL(e,n,h);return $f&&(v?v.push(E):g&&E()),E}function pC(e,n,t){const i=this.proxy,r=Is(e)?e.includes(".")?Q_(i,e):()=>i[e]:e.bind(i,i);let o;Li(n)?o=n:(o=n.handler,t=n);const l=Jf(this),h=hm(r,o.bind(i),t);return l(),h}function Q_(e,n){const t=n.split(".");return()=>{let i=e;for(let r=0;r<t.length&&i;r++)i=i[t[r]];return i}}const gC=(e,n)=>n==="modelValue"||n==="model-value"?e.modelModifiers:e[`${n}Modifiers`]||e[`${kl(n)}Modifiers`]||e[`${uh(n)}Modifiers`];function mC(e,n,...t){if(e.isUnmounted)return;const i=e.vnode.props||jr;let r=t;const o=n.startsWith("update:"),l=o&&gC(i,n.slice(7));l&&(l.trim&&(r=t.map(_=>Is(_)?_.trim():_)),l.number&&(r=t.map(Jd)));let h,g=i[h=w0(n)]||i[h=w0(kl(n))];!g&&o&&(g=i[h=w0(uh(n))]),g&&Yl(g,e,6,r);const v=i[h+"Once"];if(v){if(!e.emitted)e.emitted={};else if(e.emitted[h])return;e.emitted[h]=!0,Yl(v,e,6,r)}}function e2(e,n,t=!1){const i=n.emitsCache,r=i.get(e);if(r!==void 0)return r;const o=e.emits;let l={},h=!1;if(!Li(e)){const g=v=>{const _=e2(v,n,!0);_&&(h=!0,Eo(l,_))};!t&&n.mixins.length&&n.mixins.forEach(g),e.extends&&g(e.extends),e.mixins&&e.mixins.forEach(g)}return!o&&!h?(Ur(e)&&i.set(e,null),null):(ti(o)?o.forEach(g=>l[g]=null):Eo(l,o),Ur(e)&&i.set(e,l),l)}function Ap(e,n){return!e||!_p(n)?!1:(n=n.slice(2).replace(/Once$/,""),Cr(e,n[0].toLowerCase()+n.slice(1))||Cr(e,uh(n))||Cr(e,n))}function Q1(e){const{type:n,vnode:t,proxy:i,withProxy:r,propsOptions:[o],slots:l,attrs:h,emit:g,render:v,renderCache:_,props:x,data:E,setupState:b,ctx:D,inheritAttrs:$}=e,Q=ep(e);let F,G;try{if(t.shapeFlag&4){const Se=r||i,Ie=Se;F=bu(v.call(Ie,Se,_,x,b,E,D)),G=h}else{const Se=n;F=bu(Se.length>1?Se(x,{attrs:h,slots:l,emit:g}):Se(x,null)),G=n.props?h:vC(h)}}catch(Se){kf.length=0,Cp(Se,e,1),F=Yr($a)}let me=F;if(G&&$!==!1){const Se=Object.keys(G),{shapeFlag:Ie}=me;Se.length&&Ie&7&&(o&&Se.some(Jg)&&(G=yC(G,o)),me=Lc(me,G,!1,!0))}return t.dirs&&(me=Lc(me,null,!1,!0),me.dirs=me.dirs?me.dirs.concat(t.dirs):t.dirs),t.transition&&jf(me,t.transition),F=me,ep(Q),F}const vC=e=>{let n;for(const t in e)(t==="class"||t==="style"||_p(t))&&((n||(n={}))[t]=e[t]);return n},yC=(e,n)=>{const t={};for(const i in e)(!Jg(i)||!(i.slice(9)in n))&&(t[i]=e[i]);return t};function _C(e,n,t){const{props:i,children:r,component:o}=e,{props:l,children:h,patchFlag:g}=n,v=o.emitsOptions;if(n.dirs||n.transition)return!0;if(t&&g>=0){if(g&1024)return!0;if(g&16)return i?ev(i,l,v):!!l;if(g&8){const _=n.dynamicProps;for(let x=0;x<_.length;x++){const E=_[x];if(l[E]!==i[E]&&!Ap(v,E))return!0}}}else return(r||h)&&(!h||!h.$stable)?!0:i===l?!1:i?l?ev(i,l,v):!0:!!l;return!1}function ev(e,n,t){const i=Object.keys(n);if(i.length!==Object.keys(e).length)return!0;for(let r=0;r<i.length;r++){const o=i[r];if(n[o]!==e[o]&&!Ap(t,o))return!0}return!1}function bC({vnode:e,parent:n},t){for(;n;){const i=n.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i===e)(e=n.vnode).el=t,n=n.parent;else break}}const t2=e=>e.__isSuspense;function wC(e,n){n&&n.pendingBranch?ti(e)?n.effects.push(...e):n.effects.push(e):AL(e)}const zn=Symbol.for("v-fgt"),Mp=Symbol.for("v-txt"),$a=Symbol.for("v-cmt"),Od=Symbol.for("v-stc"),kf=[];let al=null;function Ye(e=!1){kf.push(al=e?null:[])}function xC(){kf.pop(),al=kf[kf.length-1]||null}let Uf=1;function tv(e,n=!1){Uf+=e,e<0&&al&&n&&(al.hasOnce=!0)}function n2(e){return e.dynamicChildren=Uf>0?al||Oh:null,xC(),Uf>0&&al&&al.push(e),e}function tt(e,n,t,i,r,o){return n2(M(e,n,t,i,r,o,!0))}function Su(e,n,t,i,r){return n2(Yr(e,n,t,i,r,!0))}function ip(e){return e?e.__v_isVNode===!0:!1}function Wc(e,n){return e.type===n.type&&e.key===n.key}const i2=({key:e})=>e??null,Id=({ref:e,ref_key:n,ref_for:t})=>(typeof e=="number"&&(e=""+e),e!=null?Is(e)||Ys(e)||Li(e)?{i:Sa,r:e,k:n,f:!!t}:e:null);function M(e,n=null,t=null,i=0,r=null,o=e===zn?0:1,l=!1,h=!1){const g={__v_isVNode:!0,__v_skip:!0,type:e,props:n,key:n&&i2(n),ref:n&&Id(n),scopeId:A_,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:Sa};return h?(fm(g,t),o&128&&e.normalize(g)):t&&(g.shapeFlag|=Is(t)?8:16),Uf>0&&!l&&al&&(g.patchFlag>0||o&6)&&g.patchFlag!==32&&al.push(g),g}const Yr=LC;function LC(e,n=null,t=null,i=0,r=null,o=!1){if((!e||e===GL)&&(e=$a),ip(e)){const h=Lc(e,n,!0);return t&&fm(h,t),Uf>0&&!o&&al&&(h.shapeFlag&6?al[al.indexOf(e)]=h:al.push(h)),h.patchFlag=-2,h}if(DC(e)&&(e=e.__vccOpts),n){n=CC(n);let{class:h,style:g}=n;h&&!Is(h)&&(n.class=Jr(h)),Ur(g)&&(om(g)&&!ti(g)&&(g=Eo({},g)),n.style=Jc(g))}const l=Is(e)?1:t2(e)?128:k_(e)?64:Ur(e)?4:Li(e)?2:0;return M(e,n,t,i,r,l,o,!0)}function CC(e){return e?om(e)||G_(e)?Eo({},e):e:null}function Lc(e,n,t=!1,i=!1){const{props:r,ref:o,patchFlag:l,children:h,transition:g}=e,v=n?SC(r||{},n):r,_={__v_isVNode:!0,__v_skip:!0,type:e.type,props:v,key:v&&i2(v),ref:n&&n.ref?t&&o?ti(o)?o.concat(Id(n)):[o,Id(n)]:Id(n):o,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:h,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:n&&e.type!==zn?l===-1?16:l|16:l,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:g,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Lc(e.ssContent),ssFallback:e.ssFallback&&Lc(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return g&&i&&jf(_,g.clone(_)),_}function Br(e=" ",n=0){return Yr(Mp,null,e,n)}function wc(e,n){const t=Yr(Od,null,e);return t.staticCount=n,t}function wn(e="",n=!1){return n?(Ye(),Su($a,null,e)):Yr($a,null,e)}function bu(e){return e==null||typeof e=="boolean"?Yr($a):ti(e)?Yr(zn,null,e.slice()):ip(e)?gc(e):Yr(Mp,null,String(e))}function gc(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Lc(e)}function fm(e,n){let t=0;const{shapeFlag:i}=e;if(n==null)n=null;else if(ti(n))t=16;else if(typeof n=="object")if(i&65){const r=n.default;r&&(r._c&&(r._d=!1),fm(e,r()),r._c&&(r._d=!0));return}else{t=32;const r=n._;!r&&!G_(n)?n._ctx=Sa:r===3&&Sa&&(Sa.slots._===1?n._=1:(n._=2,e.patchFlag|=1024))}else Li(n)?(n={default:n,_ctx:Sa},t=32):(n=String(n),i&64?(t=16,n=[Br(n)]):t=8);e.children=n,e.shapeFlag|=t}function SC(...e){const n={};for(let t=0;t<e.length;t++){const i=e[t];for(const r in i)if(r==="class")n.class!==i.class&&(n.class=Jr([n.class,i.class]));else if(r==="style")n.style=Jc([n.style,i.style]);else if(_p(r)){const o=n[r],l=i[r];l&&o!==l&&!(ti(o)&&o.includes(l))&&(n[r]=o?[].concat(o,l):l)}else r!==""&&(n[r]=i[r])}return n}function fu(e,n,t,i=null){Yl(e,n,7,[t,i])}const PC=$_();let EC=0;function AC(e,n,t){const i=e.type,r=(n?n.appContext:e.appContext)||PC,o={uid:EC++,vnode:e,type:i,parent:n,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new r_(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:n?n.provides:Object.create(r.provides),ids:n?n.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:W_(i,r),emitsOptions:e2(i,r),emit:null,emitted:null,propsDefaults:jr,inheritAttrs:i.inheritAttrs,ctx:jr,data:jr,props:jr,attrs:jr,slots:jr,refs:jr,setupState:jr,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return o.ctx={_:o},o.root=n?n.root:o,o.emit=mC.bind(null,o),e.ce&&e.ce(o),o}let Po=null;const MC=()=>Po||Sa;let rp,hg;{const e=xp(),n=(t,i)=>{let r;return(r=e[t])||(r=e[t]=[]),r.push(i),o=>{r.length>1?r.forEach(l=>l(o)):r[0](o)}};rp=n("__VUE_INSTANCE_SETTERS__",t=>Po=t),hg=n("__VUE_SSR_SETTERS__",t=>$f=t)}const Jf=e=>{const n=Po;return rp(e),e.scope.on(),()=>{e.scope.off(),rp(n)}},nv=()=>{Po&&Po.scope.off(),rp(null)};function r2(e){return e.vnode.shapeFlag&4}let $f=!1;function kC(e,n=!1,t=!1){n&&hg(n);const{props:i,children:r}=e.vnode,o=r2(e);nC(e,i,o,n),oC(e,r,t);const l=o?TC(e,n):void 0;return n&&hg(!1),l}function TC(e,n){const t=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,WL);const{setup:i}=t;if(i){Ec();const r=e.setupContext=i.length>1?NC(e):null,o=Jf(e),l=Kf(i,e,0,[e.props,r]),h=Yy(l);if(Ac(),o(),(h||e.sp)&&!Af(e)&&F_(e),h){if(l.then(nv,nv),n)return l.then(g=>{iv(e,g)}).catch(g=>{Cp(g,e,0)});e.asyncDep=l}else iv(e,l)}else s2(e)}function iv(e,n,t){Li(n)?e.type.__ssrInlineRender?e.ssrRender=n:e.render=n:Ur(n)&&(e.setupState=L_(n)),s2(e)}function s2(e,n,t){const i=e.type;e.render||(e.render=i.render||Cu);{const r=Jf(e);Ec();try{ZL(e)}finally{Ac(),r()}}}const BC={get(e,n){return oa(e,"get",""),e[n]}};function NC(e){const n=t=>{e.exposed=t||{}};return{attrs:new Proxy(e.attrs,BC),slots:e.slots,emit:e.emit,expose:n}}function kp(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(L_(am(e.exposed)),{get(n,t){if(t in n)return n[t];if(t in Mf)return Mf[t](e)},has(n,t){return t in n||t in Mf}})):e.proxy}function RC(e,n=!0){return Li(e)?e.displayName||e.name:e.name||n&&e.__name}function DC(e){return Li(e)&&"__vccOpts"in e}const Ni=(e,n)=>LL(e,n,$f);function dm(e,n,t){const i=arguments.length;return i===2?Ur(n)&&!ti(n)?ip(n)?Yr(e,null,[n]):Yr(e,n):Yr(e,null,n):(i>3?t=Array.prototype.slice.call(arguments,2):i===3&&ip(t)&&(t=[t]),Yr(e,n,t))}const OC="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let fg;const rv=typeof window<"u"&&window.trustedTypes;if(rv)try{fg=rv.createPolicy("vue",{createHTML:e=>e})}catch{}const o2=fg?e=>fg.createHTML(e):e=>e,IC="http://www.w3.org/2000/svg",FC="http://www.w3.org/1998/Math/MathML",Zu=typeof document<"u"?document:null,sv=Zu&&Zu.createElement("template"),zC={insert:(e,n,t)=>{n.insertBefore(e,t||null)},remove:e=>{const n=e.parentNode;n&&n.removeChild(e)},createElement:(e,n,t,i)=>{const r=n==="svg"?Zu.createElementNS(IC,e):n==="mathml"?Zu.createElementNS(FC,e):t?Zu.createElement(e,{is:t}):Zu.createElement(e);return e==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:e=>Zu.createTextNode(e),createComment:e=>Zu.createComment(e),setText:(e,n)=>{e.nodeValue=n},setElementText:(e,n)=>{e.textContent=n},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Zu.querySelector(e),setScopeId(e,n){e.setAttribute(n,"")},insertStaticContent(e,n,t,i,r,o){const l=t?t.previousSibling:n.lastChild;if(r&&(r===o||r.nextSibling))for(;n.insertBefore(r.cloneNode(!0),t),!(r===o||!(r=r.nextSibling)););else{sv.innerHTML=o2(i==="svg"?`<svg>${e}</svg>`:i==="mathml"?`<math>${e}</math>`:e);const h=sv.content;if(i==="svg"||i==="mathml"){const g=h.firstChild;for(;g.firstChild;)h.appendChild(g.firstChild);h.removeChild(g)}n.insertBefore(h,t)}return[l?l.nextSibling:n.firstChild,t?t.previousSibling:n.lastChild]}},ac="transition",uf="animation",qf=Symbol("_vtc"),a2={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},jC=Eo({},N_,a2),UC=e=>(e.displayName="Transition",e.props=jC,e),ov=UC((e,{slots:n})=>dm(BL,$C(e),n)),Uc=(e,n=[])=>{ti(e)?e.forEach(t=>t(...n)):e&&e(...n)},av=e=>e?ti(e)?e.some(n=>n.length>1):e.length>1:!1;function $C(e){const n={};for(const R in e)R in a2||(n[R]=e[R]);if(e.css===!1)return n;const{name:t="v",type:i,duration:r,enterFromClass:o=`${t}-enter-from`,enterActiveClass:l=`${t}-enter-active`,enterToClass:h=`${t}-enter-to`,appearFromClass:g=o,appearActiveClass:v=l,appearToClass:_=h,leaveFromClass:x=`${t}-leave-from`,leaveActiveClass:E=`${t}-leave-active`,leaveToClass:b=`${t}-leave-to`}=e,D=qC(r),$=D&&D[0],Q=D&&D[1],{onBeforeEnter:F,onEnter:G,onEnterCancelled:me,onLeave:Se,onLeaveCancelled:Ie,onBeforeAppear:nt=F,onAppear:Ve=G,onAppearCancelled:O=me}=n,W=(R,J,V,U)=>{R._enterCancelled=U,$c(R,J?_:h),$c(R,J?v:l),V&&V()},ue=(R,J)=>{R._isLeaving=!1,$c(R,x),$c(R,b),$c(R,E),J&&J()},z=R=>(J,V)=>{const U=R?Ve:G,Y=()=>W(J,R,V);Uc(U,[J,Y]),lv(()=>{$c(J,R?g:o),qu(J,R?_:h),av(U)||uv(J,i,$,Y)})};return Eo(n,{onBeforeEnter(R){Uc(F,[R]),qu(R,o),qu(R,l)},onBeforeAppear(R){Uc(nt,[R]),qu(R,g),qu(R,v)},onEnter:z(!1),onAppear:z(!0),onLeave(R,J){R._isLeaving=!0;const V=()=>ue(R,J);qu(R,x),R._enterCancelled?(qu(R,E),fv()):(fv(),qu(R,E)),lv(()=>{R._isLeaving&&($c(R,x),qu(R,b),av(Se)||uv(R,i,Q,V))}),Uc(Se,[R,V])},onEnterCancelled(R){W(R,!1,void 0,!0),Uc(me,[R])},onAppearCancelled(R){W(R,!0,void 0,!0),Uc(O,[R])},onLeaveCancelled(R){ue(R),Uc(Ie,[R])}})}function qC(e){if(e==null)return null;if(Ur(e))return[k0(e.enter),k0(e.leave)];{const n=k0(e);return[n,n]}}function k0(e){return $x(e)}function qu(e,n){n.split(/\s+/).forEach(t=>t&&e.classList.add(t)),(e[qf]||(e[qf]=new Set)).add(n)}function $c(e,n){n.split(/\s+/).forEach(i=>i&&e.classList.remove(i));const t=e[qf];t&&(t.delete(n),t.size||(e[qf]=void 0))}function lv(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let VC=0;function uv(e,n,t,i){const r=e._endId=++VC,o=()=>{r===e._endId&&i()};if(t!=null)return setTimeout(o,t);const{type:l,timeout:h,propCount:g}=GC(e,n);if(!l)return i();const v=l+"end";let _=0;const x=()=>{e.removeEventListener(v,E),o()},E=b=>{b.target===e&&++_>=g&&x()};setTimeout(()=>{_<g&&x()},h+1),e.addEventListener(v,E)}function GC(e,n){const t=window.getComputedStyle(e),i=D=>(t[D]||"").split(", "),r=i(`${ac}Delay`),o=i(`${ac}Duration`),l=cv(r,o),h=i(`${uf}Delay`),g=i(`${uf}Duration`),v=cv(h,g);let _=null,x=0,E=0;n===ac?l>0&&(_=ac,x=l,E=o.length):n===uf?v>0&&(_=uf,x=v,E=g.length):(x=Math.max(l,v),_=x>0?l>v?ac:uf:null,E=_?_===ac?o.length:g.length:0);const b=_===ac&&/\b(transform|all)(,|$)/.test(i(`${ac}Property`).toString());return{type:_,timeout:x,propCount:E,hasTransform:b}}function cv(e,n){for(;e.length<n.length;)e=e.concat(e);return Math.max(...n.map((t,i)=>hv(t)+hv(e[i])))}function hv(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function fv(){return document.body.offsetHeight}function HC(e,n,t){const i=e[qf];i&&(n=(n?[n,...i]:[...i]).join(" ")),n==null?e.removeAttribute("class"):t?e.setAttribute("class",n):e.className=n}const sp=Symbol("_vod"),l2=Symbol("_vsh"),_f={beforeMount(e,{value:n},{transition:t}){e[sp]=e.style.display==="none"?"":e.style.display,t&&n?t.beforeEnter(e):cf(e,n)},mounted(e,{value:n},{transition:t}){t&&n&&t.enter(e)},updated(e,{value:n,oldValue:t},{transition:i}){!n!=!t&&(i?n?(i.beforeEnter(e),cf(e,!0),i.enter(e)):i.leave(e,()=>{cf(e,!1)}):cf(e,n))},beforeUnmount(e,{value:n}){cf(e,n)}};function cf(e,n){e.style.display=n?e[sp]:"none",e[l2]=!n}const WC=Symbol(""),ZC=/(^|;)\s*display\s*:/;function KC(e,n,t){const i=e.style,r=Is(t);let o=!1;if(t&&!r){if(n)if(Is(n))for(const l of n.split(";")){const h=l.slice(0,l.indexOf(":")).trim();t[h]==null&&Fd(i,h,"")}else for(const l in n)t[l]==null&&Fd(i,l,"");for(const l in t)l==="display"&&(o=!0),Fd(i,l,t[l])}else if(r){if(n!==t){const l=i[WC];l&&(t+=";"+l),i.cssText=t,o=ZC.test(t)}}else n&&e.removeAttribute("style");sp in e&&(e[sp]=o?i.display:"",e[l2]&&(i.display="none"))}const dv=/\s*!important$/;function Fd(e,n,t){if(ti(t))t.forEach(i=>Fd(e,n,i));else if(t==null&&(t=""),n.startsWith("--"))e.setProperty(n,t);else{const i=JC(e,n);dv.test(t)?e.setProperty(uh(i),t.replace(dv,""),"important"):e[i]=t}}const pv=["Webkit","Moz","ms"],T0={};function JC(e,n){const t=T0[n];if(t)return t;let i=kl(n);if(i!=="filter"&&i in e)return T0[n]=i;i=wp(i);for(let r=0;r<pv.length;r++){const o=pv[r]+i;if(o in e)return T0[n]=o}return n}const gv="http://www.w3.org/1999/xlink";function mv(e,n,t,i,r,o=Zx(n)){i&&n.startsWith("xlink:")?t==null?e.removeAttributeNS(gv,n.slice(6,n.length)):e.setAttributeNS(gv,n,t):t==null||o&&!t_(t)?e.removeAttribute(n):e.setAttribute(n,o?"":Eu(t)?String(t):t)}function vv(e,n,t,i,r){if(n==="innerHTML"||n==="textContent"){t!=null&&(e[n]=n==="innerHTML"?o2(t):t);return}const o=e.tagName;if(n==="value"&&o!=="PROGRESS"&&!o.includes("-")){const h=o==="OPTION"?e.getAttribute("value")||"":e.value,g=t==null?e.type==="checkbox"?"on":"":String(t);(h!==g||!("_value"in e))&&(e.value=g),t==null&&e.removeAttribute(n),e._value=t;return}let l=!1;if(t===""||t==null){const h=typeof e[n];h==="boolean"?t=t_(t):t==null&&h==="string"?(t="",l=!0):h==="number"&&(t=0,l=!0)}try{e[n]=t}catch{}l&&e.removeAttribute(r||n)}function Yu(e,n,t,i){e.addEventListener(n,t,i)}function YC(e,n,t,i){e.removeEventListener(n,t,i)}const yv=Symbol("_vei");function XC(e,n,t,i,r=null){const o=e[yv]||(e[yv]={}),l=o[n];if(i&&l)l.value=i;else{const[h,g]=QC(n);if(i){const v=o[n]=nS(i,r);Yu(e,h,v,g)}else l&&(YC(e,h,l,g),o[n]=void 0)}}const _v=/(?:Once|Passive|Capture)$/;function QC(e){let n;if(_v.test(e)){n={};let i;for(;i=e.match(_v);)e=e.slice(0,e.length-i[0].length),n[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):uh(e.slice(2)),n]}let B0=0;const eS=Promise.resolve(),tS=()=>B0||(eS.then(()=>B0=0),B0=Date.now());function nS(e,n){const t=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=t.attached)return;Yl(iS(i,t.value),n,5,[i])};return t.value=e,t.attached=tS(),t}function iS(e,n){if(ti(n)){const t=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{t.call(e),e._stopped=!0},n.map(i=>r=>!r._stopped&&i&&i(r))}else return n}const bv=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,rS=(e,n,t,i,r,o)=>{const l=r==="svg";n==="class"?HC(e,i,l):n==="style"?KC(e,t,i):_p(n)?Jg(n)||XC(e,n,t,i,o):(n[0]==="."?(n=n.slice(1),!0):n[0]==="^"?(n=n.slice(1),!1):sS(e,n,i,l))?(vv(e,n,i),!e.tagName.includes("-")&&(n==="value"||n==="checked"||n==="selected")&&mv(e,n,i,l,o,n!=="value")):e._isVueCE&&(/[A-Z]/.test(n)||!Is(i))?vv(e,kl(n),i,o,n):(n==="true-value"?e._trueValue=i:n==="false-value"&&(e._falseValue=i),mv(e,n,i,l))};function sS(e,n,t,i){if(i)return!!(n==="innerHTML"||n==="textContent"||n in e&&bv(n)&&Li(t));if(n==="spellcheck"||n==="draggable"||n==="translate"||n==="form"||n==="list"&&e.tagName==="INPUT"||n==="type"&&e.tagName==="TEXTAREA")return!1;if(n==="width"||n==="height"){const r=e.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return bv(n)&&Is(t)?!1:n in e}const Cc=e=>{const n=e.props["onUpdate:modelValue"]||!1;return ti(n)?t=>Nd(n,t):n};function oS(e){e.target.composing=!0}function wv(e){const n=e.target;n.composing&&(n.composing=!1,n.dispatchEvent(new Event("input")))}const Ml=Symbol("_assign"),ki={created(e,{modifiers:{lazy:n,trim:t,number:i}},r){e[Ml]=Cc(r);const o=i||r.props&&r.props.type==="number";Yu(e,n?"change":"input",l=>{if(l.target.composing)return;let h=e.value;t&&(h=h.trim()),o&&(h=Jd(h)),e[Ml](h)}),t&&Yu(e,"change",()=>{e.value=e.value.trim()}),n||(Yu(e,"compositionstart",oS),Yu(e,"compositionend",wv),Yu(e,"change",wv))},mounted(e,{value:n}){e.value=n??""},beforeUpdate(e,{value:n,oldValue:t,modifiers:{lazy:i,trim:r,number:o}},l){if(e[Ml]=Cc(l),e.composing)return;const h=(o||e.type==="number")&&!/^0\d/.test(e.value)?Jd(e.value):e.value,g=n??"";h!==g&&(document.activeElement===e&&e.type!=="range"&&(i&&n===t||r&&e.value.trim()===g)||(e.value=g))}},u2={deep:!0,created(e,n,t){e[Ml]=Cc(t),Yu(e,"change",()=>{const i=e._modelValue,r=Vh(e),o=e.checked,l=e[Ml];if(ti(i)){const h=Qg(i,r),g=h!==-1;if(o&&!g)l(i.concat(r));else if(!o&&g){const v=[...i];v.splice(h,1),l(v)}}else if(Zh(i)){const h=new Set(i);o?h.add(r):h.delete(r),l(h)}else l(c2(e,o))})},mounted:xv,beforeUpdate(e,n,t){e[Ml]=Cc(t),xv(e,n,t)}};function xv(e,{value:n,oldValue:t},i){e._modelValue=n;let r;if(ti(n))r=Qg(n,i.props.value)>-1;else if(Zh(n))r=n.has(i.props.value);else{if(n===t)return;r=sh(n,c2(e,!0))}e.checked!==r&&(e.checked=r)}const aS={created(e,{value:n},t){e.checked=sh(n,t.props.value),e[Ml]=Cc(t),Yu(e,"change",()=>{e[Ml](Vh(e))})},beforeUpdate(e,{value:n,oldValue:t},i){e[Ml]=Cc(i),n!==t&&(e.checked=sh(n,i.props.value))}},Ws={deep:!0,created(e,{value:n,modifiers:{number:t}},i){const r=Zh(n);Yu(e,"change",()=>{const o=Array.prototype.filter.call(e.options,l=>l.selected).map(l=>t?Jd(Vh(l)):Vh(l));e[Ml](e.multiple?r?new Set(o):o:o[0]),e._assigning=!0,Ds(()=>{e._assigning=!1})}),e[Ml]=Cc(i)},mounted(e,{value:n}){Lv(e,n)},beforeUpdate(e,n,t){e[Ml]=Cc(t)},updated(e,{value:n}){e._assigning||Lv(e,n)}};function Lv(e,n){const t=e.multiple,i=ti(n);if(!(t&&!i&&!Zh(n))){for(let r=0,o=e.options.length;r<o;r++){const l=e.options[r],h=Vh(l);if(t)if(i){const g=typeof h;g==="string"||g==="number"?l.selected=n.some(v=>String(v)===String(h)):l.selected=Qg(n,h)>-1}else l.selected=n.has(h);else if(sh(Vh(l),n)){e.selectedIndex!==r&&(e.selectedIndex=r);return}}!t&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function Vh(e){return"_value"in e?e._value:e.value}function c2(e,n){const t=n?"_trueValue":"_falseValue";return t in e?e[t]:n}const lS={created(e,n,t){Sd(e,n,t,null,"created")},mounted(e,n,t){Sd(e,n,t,null,"mounted")},beforeUpdate(e,n,t,i){Sd(e,n,t,i,"beforeUpdate")},updated(e,n,t,i){Sd(e,n,t,i,"updated")}};function uS(e,n){switch(e){case"SELECT":return Ws;case"TEXTAREA":return ki;default:switch(n){case"checkbox":return u2;case"radio":return aS;default:return ki}}}function Sd(e,n,t,i,r){const l=uS(e.tagName,t.props&&t.props.type)[r];l&&l(e,n,t,i)}const cS=["ctrl","shift","alt","meta"],hS={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,n)=>cS.some(t=>e[`${t}Key`]&&!n.includes(t))},Tp=(e,n)=>{const t=e._withMods||(e._withMods={}),i=n.join(".");return t[i]||(t[i]=(r,...o)=>{for(let l=0;l<n.length;l++){const h=hS[n[l]];if(h&&h(r,n))return}return e(r,...o)})},fS=Eo({patchProp:rS},zC);let Cv;function dS(){return Cv||(Cv=lC(fS))}const pS=(...e)=>{const n=dS().createApp(...e),{mount:t}=n;return n.mount=i=>{const r=mS(i);if(!r)return;const o=n._component;!Li(o)&&!o.render&&!o.template&&(o.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const l=t(r,!1,gS(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),l},n};function gS(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function mS(e){return Is(e)?document.querySelector(e):e}/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let h2;const Bp=e=>h2=e,f2=Symbol();function dg(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var Tf;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Tf||(Tf={}));function vS(){const e=s_(!0),n=e.run(()=>un({}));let t=[],i=[];const r=am({install(o){Bp(r),r._a=o,o.provide(f2,r),o.config.globalProperties.$pinia=r,i.forEach(l=>t.push(l)),i=[]},use(o){return this._a?t.push(o):i.push(o),this},_p:t,_a:null,_e:e,_s:new Map,state:n});return r}const d2=()=>{};function Sv(e,n,t,i=d2){e.push(n);const r=()=>{const o=e.indexOf(n);o>-1&&(e.splice(o,1),i())};return!t&&o_()&&Jx(r),r}function Ah(e,...n){e.slice().forEach(t=>{t(...n)})}const yS=e=>e(),Pv=Symbol(),N0=Symbol();function pg(e,n){e instanceof Map&&n instanceof Map?n.forEach((t,i)=>e.set(i,t)):e instanceof Set&&n instanceof Set&&n.forEach(e.add,e);for(const t in n){if(!n.hasOwnProperty(t))continue;const i=n[t],r=e[t];dg(r)&&dg(i)&&e.hasOwnProperty(t)&&!Ys(i)&&!bc(i)?e[t]=pg(r,i):e[t]=i}return e}const _S=Symbol();function bS(e){return!dg(e)||!e.hasOwnProperty(_S)}const{assign:fc}=Object;function wS(e){return!!(Ys(e)&&e.effect)}function xS(e,n,t,i){const{state:r,actions:o,getters:l}=n,h=t.state.value[e];let g;function v(){h||(t.state.value[e]=r?r():{});const _=_L(t.state.value[e]);return fc(_,o,Object.keys(l||{}).reduce((x,E)=>(x[E]=am(Ni(()=>{Bp(t);const b=t._s.get(e);return l[E].call(b,b)})),x),{}))}return g=p2(e,v,n,t,i,!0),g}function p2(e,n,t={},i,r,o){let l;const h=fc({actions:{}},t),g={deep:!0};let v,_,x=[],E=[],b;const D=i.state.value[e];!o&&!D&&(i.state.value[e]={}),un({});let $;function Q(O){let W;v=_=!1,typeof O=="function"?(O(i.state.value[e]),W={type:Tf.patchFunction,storeId:e,events:b}):(pg(i.state.value[e],O),W={type:Tf.patchObject,payload:O,storeId:e,events:b});const ue=$=Symbol();Ds().then(()=>{$===ue&&(v=!0)}),_=!0,Ah(x,W,i.state.value[e])}const F=o?function(){const{state:W}=t,ue=W?W():{};this.$patch(z=>{fc(z,ue)})}:d2;function G(){l.stop(),x=[],E=[],i._s.delete(e)}const me=(O,W="")=>{if(Pv in O)return O[N0]=W,O;const ue=function(){Bp(i);const z=Array.from(arguments),R=[],J=[];function V(ce){R.push(ce)}function U(ce){J.push(ce)}Ah(E,{args:z,name:ue[N0],store:Ie,after:V,onError:U});let Y;try{Y=O.apply(this&&this.$id===e?this:Ie,z)}catch(ce){throw Ah(J,ce),ce}return Y instanceof Promise?Y.then(ce=>(Ah(R,ce),ce)).catch(ce=>(Ah(J,ce),Promise.reject(ce))):(Ah(R,Y),Y)};return ue[Pv]=!0,ue[N0]=W,ue},Se={_p:i,$id:e,$onAction:Sv.bind(null,E),$patch:Q,$reset:F,$subscribe(O,W={}){const ue=Sv(x,O,W.detached,()=>z()),z=l.run(()=>So(()=>i.state.value[e],R=>{(W.flush==="sync"?_:v)&&O({storeId:e,type:Tf.direct,events:b},R)},fc({},g,W)));return ue},$dispose:G},Ie=Au(Se);i._s.set(e,Ie);const Ve=(i._a&&i._a.runWithContext||yS)(()=>i._e.run(()=>(l=s_()).run(()=>n({action:me}))));for(const O in Ve){const W=Ve[O];if(Ys(W)&&!wS(W)||bc(W))o||(D&&bS(W)&&(Ys(W)?W.value=D[O]:pg(W,D[O])),i.state.value[e][O]=W);else if(typeof W=="function"){const ue=me(W,O);Ve[O]=ue,h.actions[O]=W}}return fc(Ie,Ve),fc(cr(Ie),Ve),Object.defineProperty(Ie,"$state",{get:()=>i.state.value[e],set:O=>{Q(W=>{fc(W,O)})}}),i._p.forEach(O=>{fc(Ie,l.run(()=>O({store:Ie,app:i._a,pinia:i,options:h})))}),D&&o&&t.hydrate&&t.hydrate(Ie.$state,D),v=!0,_=!0,Ie}/*! #__NO_SIDE_EFFECTS__ */function Np(e,n,t){let i,r;const o=typeof n=="function";typeof e=="string"?(i=e,r=o?t:n):(r=e,i=e.id);function l(h,g){const v=tC();return h=h||(v?Al(f2,null):null),h&&Bp(h),h=h2,h._s.has(i)||(o?p2(i,n,r,h):xS(i,r,h)),h._s.get(i)}return l.$id=i,l}function g2(e,n){return function(){return e.apply(n,arguments)}}const{toString:LS}=Object.prototype,{getPrototypeOf:pm}=Object,Rp=(e=>n=>{const t=LS.call(n);return e[t]||(e[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),eu=e=>(e=e.toLowerCase(),n=>Rp(n)===e),Dp=e=>n=>typeof n===e,{isArray:Jh}=Array,Vf=Dp("undefined");function CS(e){return e!==null&&!Vf(e)&&e.constructor!==null&&!Vf(e.constructor)&&ul(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const m2=eu("ArrayBuffer");function SS(e){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(e):n=e&&e.buffer&&m2(e.buffer),n}const PS=Dp("string"),ul=Dp("function"),v2=Dp("number"),Op=e=>e!==null&&typeof e=="object",ES=e=>e===!0||e===!1,zd=e=>{if(Rp(e)!=="object")return!1;const n=pm(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},AS=eu("Date"),MS=eu("File"),kS=eu("Blob"),TS=eu("FileList"),BS=e=>Op(e)&&ul(e.pipe),NS=e=>{let n;return e&&(typeof FormData=="function"&&e instanceof FormData||ul(e.append)&&((n=Rp(e))==="formdata"||n==="object"&&ul(e.toString)&&e.toString()==="[object FormData]"))},RS=eu("URLSearchParams"),[DS,OS,IS,FS]=["ReadableStream","Request","Response","Headers"].map(eu),zS=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Yf(e,n,{allOwnKeys:t=!1}={}){if(e===null||typeof e>"u")return;let i,r;if(typeof e!="object"&&(e=[e]),Jh(e))for(i=0,r=e.length;i<r;i++)n.call(null,e[i],i,e);else{const o=t?Object.getOwnPropertyNames(e):Object.keys(e),l=o.length;let h;for(i=0;i<l;i++)h=o[i],n.call(null,e[h],h,e)}}function y2(e,n){n=n.toLowerCase();const t=Object.keys(e);let i=t.length,r;for(;i-- >0;)if(r=t[i],n===r.toLowerCase())return r;return null}const Yc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,_2=e=>!Vf(e)&&e!==Yc;function gg(){const{caseless:e}=_2(this)&&this||{},n={},t=(i,r)=>{const o=e&&y2(n,r)||r;zd(n[o])&&zd(i)?n[o]=gg(n[o],i):zd(i)?n[o]=gg({},i):Jh(i)?n[o]=i.slice():n[o]=i};for(let i=0,r=arguments.length;i<r;i++)arguments[i]&&Yf(arguments[i],t);return n}const jS=(e,n,t,{allOwnKeys:i}={})=>(Yf(n,(r,o)=>{t&&ul(r)?e[o]=g2(r,t):e[o]=r},{allOwnKeys:i}),e),US=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),$S=(e,n,t,i)=>{e.prototype=Object.create(n.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:n.prototype}),t&&Object.assign(e.prototype,t)},qS=(e,n,t,i)=>{let r,o,l;const h={};if(n=n||{},e==null)return n;do{for(r=Object.getOwnPropertyNames(e),o=r.length;o-- >0;)l=r[o],(!i||i(l,e,n))&&!h[l]&&(n[l]=e[l],h[l]=!0);e=t!==!1&&pm(e)}while(e&&(!t||t(e,n))&&e!==Object.prototype);return n},VS=(e,n,t)=>{e=String(e),(t===void 0||t>e.length)&&(t=e.length),t-=n.length;const i=e.indexOf(n,t);return i!==-1&&i===t},GS=e=>{if(!e)return null;if(Jh(e))return e;let n=e.length;if(!v2(n))return null;const t=new Array(n);for(;n-- >0;)t[n]=e[n];return t},HS=(e=>n=>e&&n instanceof e)(typeof Uint8Array<"u"&&pm(Uint8Array)),WS=(e,n)=>{const i=(e&&e[Symbol.iterator]).call(e);let r;for(;(r=i.next())&&!r.done;){const o=r.value;n.call(e,o[0],o[1])}},ZS=(e,n)=>{let t;const i=[];for(;(t=e.exec(n))!==null;)i.push(t);return i},KS=eu("HTMLFormElement"),JS=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,i,r){return i.toUpperCase()+r}),Ev=(({hasOwnProperty:e})=>(n,t)=>e.call(n,t))(Object.prototype),YS=eu("RegExp"),b2=(e,n)=>{const t=Object.getOwnPropertyDescriptors(e),i={};Yf(t,(r,o)=>{let l;(l=n(r,o,e))!==!1&&(i[o]=l||r)}),Object.defineProperties(e,i)},XS=e=>{b2(e,(n,t)=>{if(ul(e)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const i=e[t];if(ul(i)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},QS=(e,n)=>{const t={},i=r=>{r.forEach(o=>{t[o]=!0})};return Jh(e)?i(e):i(String(e).split(n)),t},eP=()=>{},tP=(e,n)=>e!=null&&Number.isFinite(e=+e)?e:n;function nP(e){return!!(e&&ul(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const iP=e=>{const n=new Array(10),t=(i,r)=>{if(Op(i)){if(n.indexOf(i)>=0)return;if(!("toJSON"in i)){n[r]=i;const o=Jh(i)?[]:{};return Yf(i,(l,h)=>{const g=t(l,r+1);!Vf(g)&&(o[h]=g)}),n[r]=void 0,o}}return i};return t(e,0)},rP=eu("AsyncFunction"),sP=e=>e&&(Op(e)||ul(e))&&ul(e.then)&&ul(e.catch),w2=((e,n)=>e?setImmediate:n?((t,i)=>(Yc.addEventListener("message",({source:r,data:o})=>{r===Yc&&o===t&&i.length&&i.shift()()},!1),r=>{i.push(r),Yc.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",ul(Yc.postMessage)),oP=typeof queueMicrotask<"u"?queueMicrotask.bind(Yc):typeof process<"u"&&process.nextTick||w2,Gt={isArray:Jh,isArrayBuffer:m2,isBuffer:CS,isFormData:NS,isArrayBufferView:SS,isString:PS,isNumber:v2,isBoolean:ES,isObject:Op,isPlainObject:zd,isReadableStream:DS,isRequest:OS,isResponse:IS,isHeaders:FS,isUndefined:Vf,isDate:AS,isFile:MS,isBlob:kS,isRegExp:YS,isFunction:ul,isStream:BS,isURLSearchParams:RS,isTypedArray:HS,isFileList:TS,forEach:Yf,merge:gg,extend:jS,trim:zS,stripBOM:US,inherits:$S,toFlatObject:qS,kindOf:Rp,kindOfTest:eu,endsWith:VS,toArray:GS,forEachEntry:WS,matchAll:ZS,isHTMLForm:KS,hasOwnProperty:Ev,hasOwnProp:Ev,reduceDescriptors:b2,freezeMethods:XS,toObjectSet:QS,toCamelCase:JS,noop:eP,toFiniteNumber:tP,findKey:y2,global:Yc,isContextDefined:_2,isSpecCompliantForm:nP,toJSONObject:iP,isAsyncFn:rP,isThenable:sP,setImmediate:w2,asap:oP};function Bi(e,n,t,i,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",n&&(this.code=n),t&&(this.config=t),i&&(this.request=i),r&&(this.response=r,this.status=r.status?r.status:null)}Gt.inherits(Bi,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Gt.toJSONObject(this.config),code:this.code,status:this.status}}});const x2=Bi.prototype,L2={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{L2[e]={value:e}});Object.defineProperties(Bi,L2);Object.defineProperty(x2,"isAxiosError",{value:!0});Bi.from=(e,n,t,i,r,o)=>{const l=Object.create(x2);return Gt.toFlatObject(e,l,function(g){return g!==Error.prototype},h=>h!=="isAxiosError"),Bi.call(l,e.message,n,t,i,r),l.cause=e,l.name=e.name,o&&Object.assign(l,o),l};const aP=null;function mg(e){return Gt.isPlainObject(e)||Gt.isArray(e)}function C2(e){return Gt.endsWith(e,"[]")?e.slice(0,-2):e}function Av(e,n,t){return e?e.concat(n).map(function(r,o){return r=C2(r),!t&&o?"["+r+"]":r}).join(t?".":""):n}function lP(e){return Gt.isArray(e)&&!e.some(mg)}const uP=Gt.toFlatObject(Gt,{},null,function(n){return/^is[A-Z]/.test(n)});function Ip(e,n,t){if(!Gt.isObject(e))throw new TypeError("target must be an object");n=n||new FormData,t=Gt.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function($,Q){return!Gt.isUndefined(Q[$])});const i=t.metaTokens,r=t.visitor||_,o=t.dots,l=t.indexes,g=(t.Blob||typeof Blob<"u"&&Blob)&&Gt.isSpecCompliantForm(n);if(!Gt.isFunction(r))throw new TypeError("visitor must be a function");function v(D){if(D===null)return"";if(Gt.isDate(D))return D.toISOString();if(!g&&Gt.isBlob(D))throw new Bi("Blob is not supported. Use a Buffer instead.");return Gt.isArrayBuffer(D)||Gt.isTypedArray(D)?g&&typeof Blob=="function"?new Blob([D]):Buffer.from(D):D}function _(D,$,Q){let F=D;if(D&&!Q&&typeof D=="object"){if(Gt.endsWith($,"{}"))$=i?$:$.slice(0,-2),D=JSON.stringify(D);else if(Gt.isArray(D)&&lP(D)||(Gt.isFileList(D)||Gt.endsWith($,"[]"))&&(F=Gt.toArray(D)))return $=C2($),F.forEach(function(me,Se){!(Gt.isUndefined(me)||me===null)&&n.append(l===!0?Av([$],Se,o):l===null?$:$+"[]",v(me))}),!1}return mg(D)?!0:(n.append(Av(Q,$,o),v(D)),!1)}const x=[],E=Object.assign(uP,{defaultVisitor:_,convertValue:v,isVisitable:mg});function b(D,$){if(!Gt.isUndefined(D)){if(x.indexOf(D)!==-1)throw Error("Circular reference detected in "+$.join("."));x.push(D),Gt.forEach(D,function(F,G){(!(Gt.isUndefined(F)||F===null)&&r.call(n,F,Gt.isString(G)?G.trim():G,$,E))===!0&&b(F,$?$.concat(G):[G])}),x.pop()}}if(!Gt.isObject(e))throw new TypeError("data must be an object");return b(e),n}function Mv(e){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(i){return n[i]})}function gm(e,n){this._pairs=[],e&&Ip(e,this,n)}const S2=gm.prototype;S2.append=function(n,t){this._pairs.push([n,t])};S2.toString=function(n){const t=n?function(i){return n.call(this,i,Mv)}:Mv;return this._pairs.map(function(r){return t(r[0])+"="+t(r[1])},"").join("&")};function cP(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function P2(e,n,t){if(!n)return e;const i=t&&t.encode||cP;Gt.isFunction(t)&&(t={serialize:t});const r=t&&t.serialize;let o;if(r?o=r(n,t):o=Gt.isURLSearchParams(n)?n.toString():new gm(n,t).toString(i),o){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+o}return e}class kv{constructor(){this.handlers=[]}use(n,t,i){return this.handlers.push({fulfilled:n,rejected:t,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){Gt.forEach(this.handlers,function(i){i!==null&&n(i)})}}const E2={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},hP=typeof URLSearchParams<"u"?URLSearchParams:gm,fP=typeof FormData<"u"?FormData:null,dP=typeof Blob<"u"?Blob:null,pP={isBrowser:!0,classes:{URLSearchParams:hP,FormData:fP,Blob:dP},protocols:["http","https","file","blob","url","data"]},mm=typeof window<"u"&&typeof document<"u",vg=typeof navigator=="object"&&navigator||void 0,gP=mm&&(!vg||["ReactNative","NativeScript","NS"].indexOf(vg.product)<0),mP=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",vP=mm&&window.location.href||"http://localhost",yP=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:mm,hasStandardBrowserEnv:gP,hasStandardBrowserWebWorkerEnv:mP,navigator:vg,origin:vP},Symbol.toStringTag,{value:"Module"})),la={...yP,...pP};function _P(e,n){return Ip(e,new la.classes.URLSearchParams,Object.assign({visitor:function(t,i,r,o){return la.isNode&&Gt.isBuffer(t)?(this.append(i,t.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},n))}function bP(e){return Gt.matchAll(/\w+|\[(\w*)]/g,e).map(n=>n[0]==="[]"?"":n[1]||n[0])}function wP(e){const n={},t=Object.keys(e);let i;const r=t.length;let o;for(i=0;i<r;i++)o=t[i],n[o]=e[o];return n}function A2(e){function n(t,i,r,o){let l=t[o++];if(l==="__proto__")return!0;const h=Number.isFinite(+l),g=o>=t.length;return l=!l&&Gt.isArray(r)?r.length:l,g?(Gt.hasOwnProp(r,l)?r[l]=[r[l],i]:r[l]=i,!h):((!r[l]||!Gt.isObject(r[l]))&&(r[l]=[]),n(t,i,r[l],o)&&Gt.isArray(r[l])&&(r[l]=wP(r[l])),!h)}if(Gt.isFormData(e)&&Gt.isFunction(e.entries)){const t={};return Gt.forEachEntry(e,(i,r)=>{n(bP(i),r,t,0)}),t}return null}function xP(e,n,t){if(Gt.isString(e))try{return(n||JSON.parse)(e),Gt.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(t||JSON.stringify)(e)}const Xf={transitional:E2,adapter:["xhr","http","fetch"],transformRequest:[function(n,t){const i=t.getContentType()||"",r=i.indexOf("application/json")>-1,o=Gt.isObject(n);if(o&&Gt.isHTMLForm(n)&&(n=new FormData(n)),Gt.isFormData(n))return r?JSON.stringify(A2(n)):n;if(Gt.isArrayBuffer(n)||Gt.isBuffer(n)||Gt.isStream(n)||Gt.isFile(n)||Gt.isBlob(n)||Gt.isReadableStream(n))return n;if(Gt.isArrayBufferView(n))return n.buffer;if(Gt.isURLSearchParams(n))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let h;if(o){if(i.indexOf("application/x-www-form-urlencoded")>-1)return _P(n,this.formSerializer).toString();if((h=Gt.isFileList(n))||i.indexOf("multipart/form-data")>-1){const g=this.env&&this.env.FormData;return Ip(h?{"files[]":n}:n,g&&new g,this.formSerializer)}}return o||r?(t.setContentType("application/json",!1),xP(n)):n}],transformResponse:[function(n){const t=this.transitional||Xf.transitional,i=t&&t.forcedJSONParsing,r=this.responseType==="json";if(Gt.isResponse(n)||Gt.isReadableStream(n))return n;if(n&&Gt.isString(n)&&(i&&!this.responseType||r)){const l=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(n)}catch(h){if(l)throw h.name==="SyntaxError"?Bi.from(h,Bi.ERR_BAD_RESPONSE,this,null,this.response):h}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:la.classes.FormData,Blob:la.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Gt.forEach(["delete","get","head","post","put","patch"],e=>{Xf.headers[e]={}});const LP=Gt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),CP=e=>{const n={};let t,i,r;return e&&e.split(`
`).forEach(function(l){r=l.indexOf(":"),t=l.substring(0,r).trim().toLowerCase(),i=l.substring(r+1).trim(),!(!t||n[t]&&LP[t])&&(t==="set-cookie"?n[t]?n[t].push(i):n[t]=[i]:n[t]=n[t]?n[t]+", "+i:i)}),n},Tv=Symbol("internals");function hf(e){return e&&String(e).trim().toLowerCase()}function jd(e){return e===!1||e==null?e:Gt.isArray(e)?e.map(jd):String(e)}function SP(e){const n=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=t.exec(e);)n[i[1]]=i[2];return n}const PP=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function R0(e,n,t,i,r){if(Gt.isFunction(i))return i.call(this,n,t);if(r&&(n=t),!!Gt.isString(n)){if(Gt.isString(i))return n.indexOf(i)!==-1;if(Gt.isRegExp(i))return i.test(n)}}function EP(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,t,i)=>t.toUpperCase()+i)}function AP(e,n){const t=Gt.toCamelCase(" "+n);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+t,{value:function(r,o,l){return this[i].call(this,n,r,o,l)},configurable:!0})})}let qa=class{constructor(n){n&&this.set(n)}set(n,t,i){const r=this;function o(h,g,v){const _=hf(g);if(!_)throw new Error("header name must be a non-empty string");const x=Gt.findKey(r,_);(!x||r[x]===void 0||v===!0||v===void 0&&r[x]!==!1)&&(r[x||g]=jd(h))}const l=(h,g)=>Gt.forEach(h,(v,_)=>o(v,_,g));if(Gt.isPlainObject(n)||n instanceof this.constructor)l(n,t);else if(Gt.isString(n)&&(n=n.trim())&&!PP(n))l(CP(n),t);else if(Gt.isHeaders(n))for(const[h,g]of n.entries())o(g,h,i);else n!=null&&o(t,n,i);return this}get(n,t){if(n=hf(n),n){const i=Gt.findKey(this,n);if(i){const r=this[i];if(!t)return r;if(t===!0)return SP(r);if(Gt.isFunction(t))return t.call(this,r,i);if(Gt.isRegExp(t))return t.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,t){if(n=hf(n),n){const i=Gt.findKey(this,n);return!!(i&&this[i]!==void 0&&(!t||R0(this,this[i],i,t)))}return!1}delete(n,t){const i=this;let r=!1;function o(l){if(l=hf(l),l){const h=Gt.findKey(i,l);h&&(!t||R0(i,i[h],h,t))&&(delete i[h],r=!0)}}return Gt.isArray(n)?n.forEach(o):o(n),r}clear(n){const t=Object.keys(this);let i=t.length,r=!1;for(;i--;){const o=t[i];(!n||R0(this,this[o],o,n,!0))&&(delete this[o],r=!0)}return r}normalize(n){const t=this,i={};return Gt.forEach(this,(r,o)=>{const l=Gt.findKey(i,o);if(l){t[l]=jd(r),delete t[o];return}const h=n?EP(o):String(o).trim();h!==o&&delete t[o],t[h]=jd(r),i[h]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const t=Object.create(null);return Gt.forEach(this,(i,r)=>{i!=null&&i!==!1&&(t[r]=n&&Gt.isArray(i)?i.join(", "):i)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,t])=>n+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...t){const i=new this(n);return t.forEach(r=>i.set(r)),i}static accessor(n){const i=(this[Tv]=this[Tv]={accessors:{}}).accessors,r=this.prototype;function o(l){const h=hf(l);i[h]||(AP(r,l),i[h]=!0)}return Gt.isArray(n)?n.forEach(o):o(n),this}};qa.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Gt.reduceDescriptors(qa.prototype,({value:e},n)=>{let t=n[0].toUpperCase()+n.slice(1);return{get:()=>e,set(i){this[t]=i}}});Gt.freezeMethods(qa);function D0(e,n){const t=this||Xf,i=n||t,r=qa.from(i.headers);let o=i.data;return Gt.forEach(e,function(h){o=h.call(t,o,r.normalize(),n?n.status:void 0)}),r.normalize(),o}function M2(e){return!!(e&&e.__CANCEL__)}function Yh(e,n,t){Bi.call(this,e??"canceled",Bi.ERR_CANCELED,n,t),this.name="CanceledError"}Gt.inherits(Yh,Bi,{__CANCEL__:!0});function k2(e,n,t){const i=t.config.validateStatus;!t.status||!i||i(t.status)?e(t):n(new Bi("Request failed with status code "+t.status,[Bi.ERR_BAD_REQUEST,Bi.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function MP(e){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}function kP(e,n){e=e||10;const t=new Array(e),i=new Array(e);let r=0,o=0,l;return n=n!==void 0?n:1e3,function(g){const v=Date.now(),_=i[o];l||(l=v),t[r]=g,i[r]=v;let x=o,E=0;for(;x!==r;)E+=t[x++],x=x%e;if(r=(r+1)%e,r===o&&(o=(o+1)%e),v-l<n)return;const b=_&&v-_;return b?Math.round(E*1e3/b):void 0}}function TP(e,n){let t=0,i=1e3/n,r,o;const l=(v,_=Date.now())=>{t=_,r=null,o&&(clearTimeout(o),o=null),e.apply(null,v)};return[(...v)=>{const _=Date.now(),x=_-t;x>=i?l(v,_):(r=v,o||(o=setTimeout(()=>{o=null,l(r)},i-x)))},()=>r&&l(r)]}const op=(e,n,t=3)=>{let i=0;const r=kP(50,250);return TP(o=>{const l=o.loaded,h=o.lengthComputable?o.total:void 0,g=l-i,v=r(g),_=l<=h;i=l;const x={loaded:l,total:h,progress:h?l/h:void 0,bytes:g,rate:v||void 0,estimated:v&&h&&_?(h-l)/v:void 0,event:o,lengthComputable:h!=null,[n?"download":"upload"]:!0};e(x)},t)},Bv=(e,n)=>{const t=e!=null;return[i=>n[0]({lengthComputable:t,total:e,loaded:i}),n[1]]},Nv=e=>(...n)=>Gt.asap(()=>e(...n)),BP=la.hasStandardBrowserEnv?((e,n)=>t=>(t=new URL(t,la.origin),e.protocol===t.protocol&&e.host===t.host&&(n||e.port===t.port)))(new URL(la.origin),la.navigator&&/(msie|trident)/i.test(la.navigator.userAgent)):()=>!0,NP=la.hasStandardBrowserEnv?{write(e,n,t,i,r,o){const l=[e+"="+encodeURIComponent(n)];Gt.isNumber(t)&&l.push("expires="+new Date(t).toGMTString()),Gt.isString(i)&&l.push("path="+i),Gt.isString(r)&&l.push("domain="+r),o===!0&&l.push("secure"),document.cookie=l.join("; ")},read(e){const n=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function RP(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function DP(e,n){return n?e.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):e}function T2(e,n,t){let i=!RP(n);return e&&(i||t==!1)?DP(e,n):n}const Rv=e=>e instanceof qa?{...e}:e;function ah(e,n){n=n||{};const t={};function i(v,_,x,E){return Gt.isPlainObject(v)&&Gt.isPlainObject(_)?Gt.merge.call({caseless:E},v,_):Gt.isPlainObject(_)?Gt.merge({},_):Gt.isArray(_)?_.slice():_}function r(v,_,x,E){if(Gt.isUndefined(_)){if(!Gt.isUndefined(v))return i(void 0,v,x,E)}else return i(v,_,x,E)}function o(v,_){if(!Gt.isUndefined(_))return i(void 0,_)}function l(v,_){if(Gt.isUndefined(_)){if(!Gt.isUndefined(v))return i(void 0,v)}else return i(void 0,_)}function h(v,_,x){if(x in n)return i(v,_);if(x in e)return i(void 0,v)}const g={url:o,method:o,data:o,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:h,headers:(v,_,x)=>r(Rv(v),Rv(_),x,!0)};return Gt.forEach(Object.keys(Object.assign({},e,n)),function(_){const x=g[_]||r,E=x(e[_],n[_],_);Gt.isUndefined(E)&&x!==h||(t[_]=E)}),t}const B2=e=>{const n=ah({},e);let{data:t,withXSRFToken:i,xsrfHeaderName:r,xsrfCookieName:o,headers:l,auth:h}=n;n.headers=l=qa.from(l),n.url=P2(T2(n.baseURL,n.url,n.allowAbsoluteUrls),e.params,e.paramsSerializer),h&&l.set("Authorization","Basic "+btoa((h.username||"")+":"+(h.password?unescape(encodeURIComponent(h.password)):"")));let g;if(Gt.isFormData(t)){if(la.hasStandardBrowserEnv||la.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if((g=l.getContentType())!==!1){const[v,..._]=g?g.split(";").map(x=>x.trim()).filter(Boolean):[];l.setContentType([v||"multipart/form-data",..._].join("; "))}}if(la.hasStandardBrowserEnv&&(i&&Gt.isFunction(i)&&(i=i(n)),i||i!==!1&&BP(n.url))){const v=r&&o&&NP.read(o);v&&l.set(r,v)}return n},OP=typeof XMLHttpRequest<"u",IP=OP&&function(e){return new Promise(function(t,i){const r=B2(e);let o=r.data;const l=qa.from(r.headers).normalize();let{responseType:h,onUploadProgress:g,onDownloadProgress:v}=r,_,x,E,b,D;function $(){b&&b(),D&&D(),r.cancelToken&&r.cancelToken.unsubscribe(_),r.signal&&r.signal.removeEventListener("abort",_)}let Q=new XMLHttpRequest;Q.open(r.method.toUpperCase(),r.url,!0),Q.timeout=r.timeout;function F(){if(!Q)return;const me=qa.from("getAllResponseHeaders"in Q&&Q.getAllResponseHeaders()),Ie={data:!h||h==="text"||h==="json"?Q.responseText:Q.response,status:Q.status,statusText:Q.statusText,headers:me,config:e,request:Q};k2(function(Ve){t(Ve),$()},function(Ve){i(Ve),$()},Ie),Q=null}"onloadend"in Q?Q.onloadend=F:Q.onreadystatechange=function(){!Q||Q.readyState!==4||Q.status===0&&!(Q.responseURL&&Q.responseURL.indexOf("file:")===0)||setTimeout(F)},Q.onabort=function(){Q&&(i(new Bi("Request aborted",Bi.ECONNABORTED,e,Q)),Q=null)},Q.onerror=function(){i(new Bi("Network Error",Bi.ERR_NETWORK,e,Q)),Q=null},Q.ontimeout=function(){let Se=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const Ie=r.transitional||E2;r.timeoutErrorMessage&&(Se=r.timeoutErrorMessage),i(new Bi(Se,Ie.clarifyTimeoutError?Bi.ETIMEDOUT:Bi.ECONNABORTED,e,Q)),Q=null},o===void 0&&l.setContentType(null),"setRequestHeader"in Q&&Gt.forEach(l.toJSON(),function(Se,Ie){Q.setRequestHeader(Ie,Se)}),Gt.isUndefined(r.withCredentials)||(Q.withCredentials=!!r.withCredentials),h&&h!=="json"&&(Q.responseType=r.responseType),v&&([E,D]=op(v,!0),Q.addEventListener("progress",E)),g&&Q.upload&&([x,b]=op(g),Q.upload.addEventListener("progress",x),Q.upload.addEventListener("loadend",b)),(r.cancelToken||r.signal)&&(_=me=>{Q&&(i(!me||me.type?new Yh(null,e,Q):me),Q.abort(),Q=null)},r.cancelToken&&r.cancelToken.subscribe(_),r.signal&&(r.signal.aborted?_():r.signal.addEventListener("abort",_)));const G=MP(r.url);if(G&&la.protocols.indexOf(G)===-1){i(new Bi("Unsupported protocol "+G+":",Bi.ERR_BAD_REQUEST,e));return}Q.send(o||null)})},FP=(e,n)=>{const{length:t}=e=e?e.filter(Boolean):[];if(n||t){let i=new AbortController,r;const o=function(v){if(!r){r=!0,h();const _=v instanceof Error?v:this.reason;i.abort(_ instanceof Bi?_:new Yh(_ instanceof Error?_.message:_))}};let l=n&&setTimeout(()=>{l=null,o(new Bi(`timeout ${n} of ms exceeded`,Bi.ETIMEDOUT))},n);const h=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(v=>{v.unsubscribe?v.unsubscribe(o):v.removeEventListener("abort",o)}),e=null)};e.forEach(v=>v.addEventListener("abort",o));const{signal:g}=i;return g.unsubscribe=()=>Gt.asap(h),g}},zP=function*(e,n){let t=e.byteLength;if(t<n){yield e;return}let i=0,r;for(;i<t;)r=i+n,yield e.slice(i,r),i=r},jP=async function*(e,n){for await(const t of UP(e))yield*zP(t,n)},UP=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const n=e.getReader();try{for(;;){const{done:t,value:i}=await n.read();if(t)break;yield i}}finally{await n.cancel()}},Dv=(e,n,t,i)=>{const r=jP(e,n);let o=0,l,h=g=>{l||(l=!0,i&&i(g))};return new ReadableStream({async pull(g){try{const{done:v,value:_}=await r.next();if(v){h(),g.close();return}let x=_.byteLength;if(t){let E=o+=x;t(E)}g.enqueue(new Uint8Array(_))}catch(v){throw h(v),v}},cancel(g){return h(g),r.return()}},{highWaterMark:2})},Fp=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",N2=Fp&&typeof ReadableStream=="function",$P=Fp&&(typeof TextEncoder=="function"?(e=>n=>e.encode(n))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),R2=(e,...n)=>{try{return!!e(...n)}catch{return!1}},qP=N2&&R2(()=>{let e=!1;const n=new Request(la.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!n}),Ov=64*1024,yg=N2&&R2(()=>Gt.isReadableStream(new Response("").body)),ap={stream:yg&&(e=>e.body)};Fp&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(n=>{!ap[n]&&(ap[n]=Gt.isFunction(e[n])?t=>t[n]():(t,i)=>{throw new Bi(`Response type '${n}' is not supported`,Bi.ERR_NOT_SUPPORT,i)})})})(new Response);const VP=async e=>{if(e==null)return 0;if(Gt.isBlob(e))return e.size;if(Gt.isSpecCompliantForm(e))return(await new Request(la.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(Gt.isArrayBufferView(e)||Gt.isArrayBuffer(e))return e.byteLength;if(Gt.isURLSearchParams(e)&&(e=e+""),Gt.isString(e))return(await $P(e)).byteLength},GP=async(e,n)=>{const t=Gt.toFiniteNumber(e.getContentLength());return t??VP(n)},HP=Fp&&(async e=>{let{url:n,method:t,data:i,signal:r,cancelToken:o,timeout:l,onDownloadProgress:h,onUploadProgress:g,responseType:v,headers:_,withCredentials:x="same-origin",fetchOptions:E}=B2(e);v=v?(v+"").toLowerCase():"text";let b=FP([r,o&&o.toAbortSignal()],l),D;const $=b&&b.unsubscribe&&(()=>{b.unsubscribe()});let Q;try{if(g&&qP&&t!=="get"&&t!=="head"&&(Q=await GP(_,i))!==0){let Ie=new Request(n,{method:"POST",body:i,duplex:"half"}),nt;if(Gt.isFormData(i)&&(nt=Ie.headers.get("content-type"))&&_.setContentType(nt),Ie.body){const[Ve,O]=Bv(Q,op(Nv(g)));i=Dv(Ie.body,Ov,Ve,O)}}Gt.isString(x)||(x=x?"include":"omit");const F="credentials"in Request.prototype;D=new Request(n,{...E,signal:b,method:t.toUpperCase(),headers:_.normalize().toJSON(),body:i,duplex:"half",credentials:F?x:void 0});let G=await fetch(D);const me=yg&&(v==="stream"||v==="response");if(yg&&(h||me&&$)){const Ie={};["status","statusText","headers"].forEach(W=>{Ie[W]=G[W]});const nt=Gt.toFiniteNumber(G.headers.get("content-length")),[Ve,O]=h&&Bv(nt,op(Nv(h),!0))||[];G=new Response(Dv(G.body,Ov,Ve,()=>{O&&O(),$&&$()}),Ie)}v=v||"text";let Se=await ap[Gt.findKey(ap,v)||"text"](G,e);return!me&&$&&$(),await new Promise((Ie,nt)=>{k2(Ie,nt,{data:Se,headers:qa.from(G.headers),status:G.status,statusText:G.statusText,config:e,request:D})})}catch(F){throw $&&$(),F&&F.name==="TypeError"&&/fetch/i.test(F.message)?Object.assign(new Bi("Network Error",Bi.ERR_NETWORK,e,D),{cause:F.cause||F}):Bi.from(F,F&&F.code,e,D)}}),_g={http:aP,xhr:IP,fetch:HP};Gt.forEach(_g,(e,n)=>{if(e){try{Object.defineProperty(e,"name",{value:n})}catch{}Object.defineProperty(e,"adapterName",{value:n})}});const Iv=e=>`- ${e}`,WP=e=>Gt.isFunction(e)||e===null||e===!1,D2={getAdapter:e=>{e=Gt.isArray(e)?e:[e];const{length:n}=e;let t,i;const r={};for(let o=0;o<n;o++){t=e[o];let l;if(i=t,!WP(t)&&(i=_g[(l=String(t)).toLowerCase()],i===void 0))throw new Bi(`Unknown adapter '${l}'`);if(i)break;r[l||"#"+o]=i}if(!i){const o=Object.entries(r).map(([h,g])=>`adapter ${h} `+(g===!1?"is not supported by the environment":"is not available in the build"));let l=n?o.length>1?`since :
`+o.map(Iv).join(`
`):" "+Iv(o[0]):"as no adapter specified";throw new Bi("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return i},adapters:_g};function O0(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Yh(null,e)}function Fv(e){return O0(e),e.headers=qa.from(e.headers),e.data=D0.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),D2.getAdapter(e.adapter||Xf.adapter)(e).then(function(i){return O0(e),i.data=D0.call(e,e.transformResponse,i),i.headers=qa.from(i.headers),i},function(i){return M2(i)||(O0(e),i&&i.response&&(i.response.data=D0.call(e,e.transformResponse,i.response),i.response.headers=qa.from(i.response.headers))),Promise.reject(i)})}const O2="1.8.4",zp={};["object","boolean","number","function","string","symbol"].forEach((e,n)=>{zp[e]=function(i){return typeof i===e||"a"+(n<1?"n ":" ")+e}});const zv={};zp.transitional=function(n,t,i){function r(o,l){return"[Axios v"+O2+"] Transitional option '"+o+"'"+l+(i?". "+i:"")}return(o,l,h)=>{if(n===!1)throw new Bi(r(l," has been removed"+(t?" in "+t:"")),Bi.ERR_DEPRECATED);return t&&!zv[l]&&(zv[l]=!0,console.warn(r(l," has been deprecated since v"+t+" and will be removed in the near future"))),n?n(o,l,h):!0}};zp.spelling=function(n){return(t,i)=>(console.warn(`${i} is likely a misspelling of ${n}`),!0)};function ZP(e,n,t){if(typeof e!="object")throw new Bi("options must be an object",Bi.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let r=i.length;for(;r-- >0;){const o=i[r],l=n[o];if(l){const h=e[o],g=h===void 0||l(h,o,e);if(g!==!0)throw new Bi("option "+o+" must be "+g,Bi.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Bi("Unknown option "+o,Bi.ERR_BAD_OPTION)}}const Ud={assertOptions:ZP,validators:zp},du=Ud.validators;let ih=class{constructor(n){this.defaults=n,this.interceptors={request:new kv,response:new kv}}async request(n,t){try{return await this._request(n,t)}catch(i){if(i instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const o=r.stack?r.stack.replace(/^.+\n/,""):"";try{i.stack?o&&!String(i.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+o):i.stack=o}catch{}}throw i}}_request(n,t){typeof n=="string"?(t=t||{},t.url=n):t=n||{},t=ah(this.defaults,t);const{transitional:i,paramsSerializer:r,headers:o}=t;i!==void 0&&Ud.assertOptions(i,{silentJSONParsing:du.transitional(du.boolean),forcedJSONParsing:du.transitional(du.boolean),clarifyTimeoutError:du.transitional(du.boolean)},!1),r!=null&&(Gt.isFunction(r)?t.paramsSerializer={serialize:r}:Ud.assertOptions(r,{encode:du.function,serialize:du.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Ud.assertOptions(t,{baseUrl:du.spelling("baseURL"),withXsrfToken:du.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let l=o&&Gt.merge(o.common,o[t.method]);o&&Gt.forEach(["delete","get","head","post","put","patch","common"],D=>{delete o[D]}),t.headers=qa.concat(l,o);const h=[];let g=!0;this.interceptors.request.forEach(function($){typeof $.runWhen=="function"&&$.runWhen(t)===!1||(g=g&&$.synchronous,h.unshift($.fulfilled,$.rejected))});const v=[];this.interceptors.response.forEach(function($){v.push($.fulfilled,$.rejected)});let _,x=0,E;if(!g){const D=[Fv.bind(this),void 0];for(D.unshift.apply(D,h),D.push.apply(D,v),E=D.length,_=Promise.resolve(t);x<E;)_=_.then(D[x++],D[x++]);return _}E=h.length;let b=t;for(x=0;x<E;){const D=h[x++],$=h[x++];try{b=D(b)}catch(Q){$.call(this,Q);break}}try{_=Fv.call(this,b)}catch(D){return Promise.reject(D)}for(x=0,E=v.length;x<E;)_=_.then(v[x++],v[x++]);return _}getUri(n){n=ah(this.defaults,n);const t=T2(n.baseURL,n.url,n.allowAbsoluteUrls);return P2(t,n.params,n.paramsSerializer)}};Gt.forEach(["delete","get","head","options"],function(n){ih.prototype[n]=function(t,i){return this.request(ah(i||{},{method:n,url:t,data:(i||{}).data}))}});Gt.forEach(["post","put","patch"],function(n){function t(i){return function(o,l,h){return this.request(ah(h||{},{method:n,headers:i?{"Content-Type":"multipart/form-data"}:{},url:o,data:l}))}}ih.prototype[n]=t(),ih.prototype[n+"Form"]=t(!0)});let KP=class I2{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(o){t=o});const i=this;this.promise.then(r=>{if(!i._listeners)return;let o=i._listeners.length;for(;o-- >0;)i._listeners[o](r);i._listeners=null}),this.promise.then=r=>{let o;const l=new Promise(h=>{i.subscribe(h),o=h}).then(r);return l.cancel=function(){i.unsubscribe(o)},l},n(function(o,l,h){i.reason||(i.reason=new Yh(o,l,h),t(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const t=this._listeners.indexOf(n);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const n=new AbortController,t=i=>{n.abort(i)};return this.subscribe(t),n.signal.unsubscribe=()=>this.unsubscribe(t),n.signal}static source(){let n;return{token:new I2(function(r){n=r}),cancel:n}}};function JP(e){return function(t){return e.apply(null,t)}}function YP(e){return Gt.isObject(e)&&e.isAxiosError===!0}const bg={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(bg).forEach(([e,n])=>{bg[n]=e});function F2(e){const n=new ih(e),t=g2(ih.prototype.request,n);return Gt.extend(t,ih.prototype,n,{allOwnKeys:!0}),Gt.extend(t,n,null,{allOwnKeys:!0}),t.create=function(r){return F2(ah(e,r))},t}const Xs=F2(Xf);Xs.Axios=ih;Xs.CanceledError=Yh;Xs.CancelToken=KP;Xs.isCancel=M2;Xs.VERSION=O2;Xs.toFormData=Ip;Xs.AxiosError=Bi;Xs.Cancel=Xs.CanceledError;Xs.all=function(n){return Promise.all(n)};Xs.spread=JP;Xs.isAxiosError=YP;Xs.mergeConfig=ah;Xs.AxiosHeaders=qa;Xs.formToJSON=e=>A2(Gt.isHTMLForm(e)?new FormData(e):e);Xs.getAdapter=D2.getAdapter;Xs.HttpStatusCode=bg;Xs.default=Xs;const{Axios:GI,AxiosError:HI,CanceledError:WI,isCancel:ZI,CancelToken:KI,VERSION:JI,all:YI,Cancel:XI,isAxiosError:QI,spread:eF,toFormData:tF,AxiosHeaders:nF,HttpStatusCode:iF,formToJSON:rF,getAdapter:sF,mergeConfig:oF}=Xs,cn=Au({measures:[],longTasks:[],memorySnapshots:[],framesPerSecond:0,lastFpsUpdate:0,frameCount:0,isRecording:!1,isEnabled:!1,startTime:0,currentOperation:null,operationStack:[],operationHistory:[]});let xc=null,Xc=null;const XP=1e3;function jp(){if(cn.isEnabled){cn.isRecording=!0,cn.startTime=performance.now(),cn.frameCount=0,cn.lastFpsUpdate=performance.now();try{window.PerformanceObserver&&PerformanceObserver.supportedEntryTypes.includes("longtask")&&(xc=new PerformanceObserver(e=>{e.getEntries().forEach(t=>{cn.longTasks.push({duration:t.duration,startTime:t.startTime,name:t.name,component:Xl()})})}),xc.observe({entryTypes:["longtask"]}))}catch(e){console.warn("PerformanceObserver pour longues tâches non supporté",e)}QP(),vm()}}function lp(){cn.isRecording=!1,xc&&(xc.disconnect(),xc=null),$2()}function wg(){xc&&(xc.disconnect(),xc=null),$2(),cn.measures=[],cn.longTasks=[],cn.memorySnapshots=[],cn.operationHistory=[],cn.frameCount=0,cn.framesPerSecond=0,cn.lastFpsUpdate=0,cn.isEnabled&&jp()}function z2(e,n,t){if(!cn.isEnabled||!cn.isRecording)return()=>{};const i=performance.now(),r=cn.currentOperation;return cn.currentOperation=e,cn.operationStack.push(e),()=>{const o=performance.now()-i;cn.operationStack.pop(),cn.currentOperation=cn.operationStack[cn.operationStack.length-1]||null,cn.measures.push({name:e,startTime:i,duration:o,component:n||Xl(),info:t,parentOperation:r||void 0}),o>10&&cn.operationHistory.push({operation:e,component:n||Xl()||"unknown",durationMs:o,timestamp:Date.now()})}}async function j2(e,n,t,i){if(!cn.isEnabled||!cn.isRecording)return n();const r=performance.now(),o=cn.currentOperation;cn.currentOperation=e,cn.operationStack.push(e);try{return await n()}finally{const l=performance.now()-r;cn.operationStack.pop(),cn.currentOperation=cn.operationStack[cn.operationStack.length-1]||null,cn.measures.push({name:e,startTime:r,duration:l,component:t||Xl(),info:i,parentOperation:o||void 0}),l>10&&cn.operationHistory.push({operation:e,component:t||Xl()||"unknown",durationMs:l,timestamp:Date.now()})}}function U2(e,n,t,i){if(!cn.isEnabled||!cn.isRecording)return n();const r=performance.now(),o=cn.currentOperation;cn.currentOperation=e,cn.operationStack.push(e);try{return n()}finally{const l=performance.now()-r;cn.operationStack.pop(),cn.currentOperation=cn.operationStack[cn.operationStack.length-1]||null,cn.measures.push({name:e,startTime:r,duration:l,component:t||Xl(),info:i,parentOperation:o||void 0}),l>10&&cn.operationHistory.push({operation:e,component:t||Xl()||"unknown",durationMs:l,timestamp:Date.now()})}}function vm(){!cn.isEnabled||!cn.isRecording||(performance.memory?cn.memorySnapshots.push({jsHeapSizeLimit:performance.memory.jsHeapSizeLimit,totalJSHeapSize:performance.memory.totalJSHeapSize,usedJSHeapSize:performance.memory.usedJSHeapSize,timestamp:performance.now()}):cn.memorySnapshots.push({timestamp:performance.now()}))}function QP(){Xc!==null&&cancelAnimationFrame(Xc),cn.frameCount=0,cn.lastFpsUpdate=performance.now();function e(){cn.frameCount++;const n=performance.now();n-cn.lastFpsUpdate>=XP&&(cn.framesPerSecond=Math.round(cn.frameCount*1e3/(n-cn.lastFpsUpdate)),cn.frameCount=0,cn.lastFpsUpdate=n),cn.isRecording&&(Xc=requestAnimationFrame(e))}Xc=requestAnimationFrame(e)}function $2(){Xc!==null&&(cancelAnimationFrame(Xc),Xc=null)}function Xl(){return""}function xg(e){cn.isEnabled=e,e&&!cn.isRecording?jp():!e&&cn.isRecording&&lp()}function q2(e,n,t){return(...i)=>{if(!cn.isEnabled||!cn.isRecording)return e(...i);const r=performance.now();try{return e(...i)}finally{const o=performance.now()-r;cn.measures.push({name:n,startTime:r,duration:o,component:t||Xl(),info:{args:i}}),o>10&&cn.operationHistory.push({operation:n,component:t||Xl()||"unknown",durationMs:o,timestamp:Date.now()})}}}function V2(e,n,t){return async(...i)=>{if(!cn.isEnabled||!cn.isRecording)return await e(...i);const r=performance.now();try{return await e(...i)}finally{const o=performance.now()-r;cn.measures.push({name:n,startTime:r,duration:o,component:t||Xl(),info:{args:i}}),o>10&&cn.operationHistory.push({operation:n,component:t||Xl()||"unknown",durationMs:o,timestamp:Date.now()})}}}function eE(e,n){const t=cn.measures.filter(l=>l.startTime>=e&&l.startTime+l.duration<=n),i=new Map,r=[];t.forEach(l=>{l.parentOperation?(i.has(l.parentOperation)||i.set(l.parentOperation,[]),i.get(l.parentOperation).push(l)):r.push(l)});function o(l){const h=i.get(l.name)||[];return{operation:l.name,duration:l.duration,component:l.component,children:h.sort((g,v)=>v.duration-g.duration).map(g=>o(g))}}return r.sort((l,h)=>h.duration-l.duration).map(l=>o(l))}function Lg(e,n){const t=e||cn.startTime,i=n||performance.now(),r=eE(t,i),o=i-t,l=new Map;function h(v){const _=l.get(v.operation)||{duration:0,component:v.component};_.duration+=v.duration,l.set(v.operation,_),v.children.forEach(x=>h(x))}r.forEach(v=>h(v));const g=Array.from(l.entries()).map(([v,{duration:_,component:x}])=>({operation:v,duration:_,component:x,impact:_/o*100})).sort((v,_)=>_.impact-v.impact).slice(0,10);return{criticalPaths:r,totalTime:o,bottlenecks:g}}function Xh(){const e=un(!1);Tl(()=>{try{const i=new URL(window.location.href).searchParams.get("perf")==="true";e.value=i,xg(i),wg()}catch(t){console.warn("Erreur lors de la vérification du paramètre perf:",t),e.value=!1,xg(!1)}}),Kh(()=>{cn.isRecording&&lp()});const n=(t,i)=>{if(!cn.isEnabled||!cn.isRecording)return null;const r=cn.measures.find(v=>v.name===t&&v.startTime===i);if(!r)return null;const o=r.startTime+r.duration,l=cn.measures.filter(v=>v.startTime>=r.startTime&&v.startTime<=o&&v!==r),h=cn.longTasks.filter(v=>v.startTime>=r.startTime&&v.startTime<=o),g=cn.memorySnapshots.filter(v=>v.timestamp>=r.startTime&&v.timestamp<=o);return{operation:{name:r.name,component:r.component,startTime:r.startTime,duration:r.duration,info:r.info},context:{relatedOperations:l.map(v=>({name:v.name,component:v.component,startTime:v.startTime-r.startTime,duration:v.duration,info:v.info})),longTasks:h.map(v=>({duration:v.duration,startTime:v.startTime-r.startTime,name:v.name,component:v.component})),memorySnapshots:g.map(v=>({...v,timestamp:v.timestamp-r.startTime}))},summary:{totalRelatedOperations:l.length,totalLongTasks:h.length,maxLongTaskDuration:Math.max(...h.map(v=>v.duration),0),memoryDelta:g.length>1?(g[g.length-1].usedJSHeapSize||0)-(g[0].usedJSHeapSize||0):0}}};return{isEnabled:mu(un(cn.isEnabled)),isQueryParamEnabled:mu(e),isRecording:mu(un(cn.isRecording)),measures:mu(un(cn.measures)),longTasks:mu(un(cn.longTasks)),memorySnapshots:mu(un(cn.memorySnapshots)),framesPerSecond:mu(un(cn.framesPerSecond)),operationHistory:mu(un(cn.operationHistory)),startRecording:jp,stopRecording:lp,clearRecording:wg,startMeasure:z2,measure:U2,measureAsync:j2,captureMemorySnapshot:vm,createPerformanceTracker:q2,createAsyncPerformanceTracker:V2,getOperationDetails:n,getSlowOperations:()=>!cn.isEnabled||!cn.isRecording?[]:[...cn.measures].sort((t,i)=>i.duration-t.duration).slice(0,10),getLongTasks:()=>!cn.isEnabled||!cn.isRecording?[]:[...cn.longTasks].sort((t,i)=>i.duration-t.duration),getPerformanceReport:()=>{if(!cn.isEnabled||!cn.isRecording)return null;const t=Lg();return{totalMeasures:cn.measures.length,totalLongTasks:cn.longTasks.length,slowestOperations:[...cn.measures].sort((i,r)=>r.duration-i.duration).slice(0,10),averageFps:cn.framesPerSecond,memoryUsage:cn.memorySnapshots.length>0?cn.memorySnapshots[cn.memorySnapshots.length-1]:null,operationsByComponent:tE(cn.measures),criticalPaths:t.criticalPaths,bottlenecks:t.bottlenecks,recordingDuration:cn.isRecording?performance.now()-cn.startTime:null}},analyzeCriticalPaths:Lg}}function tE(e){if(!cn.isEnabled||!cn.isRecording)return{};const n={};return e.forEach(t=>{const i=t.component||"unknown";n[i]||(n[i]={totalTime:0,callCount:0,operations:{}}),n[i].totalTime+=t.duration,n[i].callCount++,n[i].operations[t.name]||(n[i].operations[t.name]={totalTime:0,callCount:0}),n[i].operations[t.name].totalTime+=t.duration,n[i].operations[t.name].callCount++}),n}const Ct={startRecording:jp,stopRecording:lp,clearRecording:wg,startMeasure:z2,measure:U2,measureAsync:j2,captureMemorySnapshot:vm,createPerformanceTracker:q2,createAsyncPerformanceTracker:V2,setEnabled:xg,analyzeCriticalPaths:Lg},Kn=Xs.create({baseURL:"/api",headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0}),ro=Xh();function G2(e){var i;const t=`; ${document.cookie}`.split(`; ${e}=`);return t.length===2&&((i=t.pop())==null?void 0:i.split(";").shift())||null}Kn.interceptors.request.use(async e=>{const n=ro.startMeasure("api_request_interceptor","ApiService");try{const t=G2("access_token");return t&&(e.headers.Authorization=`Bearer ${t}`),console.log("Request config:",{url:e.url,method:e.method,headers:e.headers,withCredentials:e.withCredentials}),e}finally{n()}},e=>(console.error("Request interceptor error:",e),Promise.reject(e)));Kn.interceptors.response.use(e=>e,async e=>{var i;const n=ro.startMeasure("api_response_interceptor","ApiService"),t=e.config;try{if(((i=e.response)==null?void 0:i.status)===401&&!t._retry){t._retry=!0;const r=Va();await ro.measureAsync("token_refresh",()=>r.refreshToken(),"ApiService");const o=G2("access_token");if(o)return t.headers.Authorization=`Bearer ${o}`,Kn(t)}return Promise.reject(e)}catch(r){return console.error("Token refresh failed:",r),window.location.href="/login",Promise.reject(r)}finally{n()}});function nE(e){var t;const n=[];if((t=e.response)!=null&&t.data){const i=e.response.data;typeof i=="object"&&!Array.isArray(i)?Object.entries(i).forEach(([r,o])=>{Array.isArray(o)?o.forEach(l=>{n.push({field:r,message:l})}):typeof o=="string"&&n.push({field:r,message:o})}):typeof i=="string"?n.push({field:"non_field_error",message:i}):i.detail&&n.push({field:"non_field_error",message:i.detail})}else e.message&&n.push({field:"non_field_error",message:`Erreur de connexion: ${e.message}`});return n.length===0&&n.push({field:"non_field_error",message:"Une erreur inconnue s'est produite"}),n}async function $d(e){console.log("[fetchUsersByHierarchy] Récupération des utilisateurs:",e);const n={role:e.role};e.usineId&&(n.usine=e.usineId),e.concessionnaireId&&(n.concessionnaire=e.concessionnaireId),e.includeDetails&&(n.include_plans=!0),e.search&&(n.search=e.search),console.log("[fetchUsersByHierarchy] Filtres appliqués:",n);try{const t=await Wl.getUsers(n);return console.log(`[fetchUsersByHierarchy] Résultat (${t.data.length} utilisateurs):`,t.data),t.data}catch(t){throw console.error("[fetchUsersByHierarchy] Erreur lors de la récupération des utilisateurs:",t),t}}const Wl={async getUsers(e={}){const n=ro.startMeasure("get_users","UserService");try{return await ro.measureAsync("get_users_request",()=>Kn.get("/users/",{params:e}),"UserService")}finally{n()}},async getUser(e){return await Kn.get(`/users/${e}/`)},async createUser(e){return await Kn.post("/users/",e)},async updateUser(e,n){return await Kn.patch(`/users/${e}/`,n)},async deleteUser(e){return await Kn.delete(`/users/${e}/`)},async getUsines(){return await Kn.get("/users/",{params:{role:"USINE"}})},async getConcessionnaires(e){const n={role:"CONCESSIONNAIRE"};return e&&(n.usine=e),await Kn.get("/users/",{params:n})},async getConcessionnaireAgriculteurs(e){return await Kn.get("/users/",{params:{role:"AGRICULTEUR",concessionnaire:e}})},async getUsineAgriculteurs(e){return await Kn.get("/users/",{params:{role:"AGRICULTEUR",usine:e}})},async getUsersByHierarchy(e){const n=ro.startMeasure("get_users_hierarchy","UserService");try{const t=ro.measure("prepare_hierarchy_filters",()=>{const i={role:e.role};return e.usineId&&(i.usine=e.usineId),e.concessionnaireId&&(i.concessionnaire=e.concessionnaireId),e.includeDetails&&(i.include_plans=!0),e.search&&(i.search=e.search),i},"UserService");return await ro.measureAsync("get_users_hierarchy_request",()=>Kn.get("/users/",{params:t}),"UserService")}finally{n()}},async getUsineConcessionnaires(e){return await Kn.get("/users/",{params:{role:"CONCESSIONNAIRE",usine:e}})},async getAgriculteurs(e,n){const t={role:"AGRICULTEUR"};return e&&(t.concessionnaire=e),n&&(t.usine=n),await Kn.get("/users/",{params:t})},async assignUsineToConcessionnaire(e,n){return await Kn.patch(`/users/${e}/`,{usine:n})},async assignConcessionnaireToAgriculteur(e,n){return await Kn.patch(`/users/${e}/`,{concessionnaire:n})},formatLogoFileName(e){return ro.measure("format_logo_filename",()=>{var r;const n=new Date().getTime(),t=((r=e.name.split(".").pop())==null?void 0:r.toLowerCase())||"";return`${e.name.split(".")[0].toLowerCase().replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}-${n}.${t}`},"UserService")},async uploadLogo(e){const n=ro.startMeasure("upload_logo","UserService");try{const t=new FormData,i=this.formatLogoFileName(e),r=new File([e],i,{type:e.type});return t.append("logo",r),await ro.measureAsync("upload_logo_request",()=>Kn.post("/users/upload_logo/",t,{headers:{"Content-Type":"multipart/form-data"}}),"UserService")}finally{n()}}},Pd={async getPlans(){const e=ro.startMeasure("get_plans","IrrigationService");try{return await ro.measureAsync("get_plans_request",()=>Kn.get("/plans/"),"IrrigationService")}finally{e()}},async createPlan(e){const n=ro.startMeasure("create_plan","IrrigationService");try{const t=ro.measure("format_plan_data",()=>({...e,usine:e.usine?typeof e.usine=="object"&&"id"in e.usine?e.usine.id:Number(e.usine):null,concessionnaire:e.concessionnaire?typeof e.concessionnaire=="object"&&"id"in e.concessionnaire?e.concessionnaire.id:Number(e.concessionnaire):null,agriculteur:e.agriculteur?typeof e.agriculteur=="object"&&"id"in e.agriculteur?e.agriculteur.id:Number(e.agriculteur):null}),"IrrigationService");return await ro.measureAsync("create_plan_request",()=>Kn.post("/plans/",t),"IrrigationService")}finally{n()}},async updatePlan(e,n){const t=ro.startMeasure("update_plan","IrrigationService");try{return await ro.measureAsync("update_plan_request",()=>Kn.put(`/plans/${e}/`,n),"IrrigationService")}finally{t()}},async deletePlan(e){const n=ro.startMeasure("delete_plan","IrrigationService");try{return await ro.measureAsync("delete_plan_request",()=>Kn.delete(`/plans/${e}/`),"IrrigationService")}finally{n()}},async getAgriculteurPlans(e){return await Kn.get("/plans/",{params:{agriculteur:e}})},async createPlanForAgriculteur(e){return await Kn.post("/plans/",e)},async getUsinePlans(e){return await Kn.get("/plans/",{params:{usine:e}})},async getConcessionnairePlans(e){return await Kn.get("/plans/",{params:{concessionnaire:e}})},async createPlanForConcessionnaire(e,n){const t={...e,concessionnaire:n};return await Kn.post("/plans/",t)},async createPlanForUsine(e,n){const t={...e,usine:n};return await Kn.post("/plans/",t)}};Kn.defaults.baseURL="/api";Kn.defaults.headers.common["Content-Type"]="application/json";Kn.defaults.withCredentials=!0;function up(e){var i;const t=`; ${document.cookie}`.split(`; ${e}=`);return t.length===2&&((i=t.pop())==null?void 0:i.split(";").shift())||null}Kn.interceptors.request.use(e=>{const n=up("access_token");return n&&(e.headers.Authorization=`Bearer ${n}`),e},e=>(console.error("Request interceptor error:",e),Promise.reject(e)));Kn.interceptors.response.use(e=>e,async e=>{var i,r;const n=Va(),t=e.config;if(((i=e.response)==null?void 0:i.status)===401&&!t._retry&&!((r=t.url)!=null&&r.includes("/token/refresh/"))){t._retry=!0;try{if(!up("access_token"))throw new Error("No token available");await n.refreshToken();const l=up("access_token");if(l)return t.headers.Authorization=`Bearer ${l}`,Kn(t)}catch(o){console.error("Token refresh failed:",o),await n.logout(),window.location.pathname!=="/login"&&(window.location.href="/login")}}return Promise.reject(e)});function iE(e,n,t=1){const i=new Date;i.setTime(i.getTime()+t*24*60*60*1e3);const r=`expires=${i.toUTCString()}`;document.cookie=`${e}=${n};${r};path=/;secure;samesite=Strict`}function ol(e){if(!e)return"-";const n=e.first_name||"",t=e.last_name?e.last_name.toUpperCase():"",i=`${n} ${t}`.trim(),r=e.company_name||e.role||"";return!i&&!r?"-":i?r?`${i} (${r})`:i:`(${r})`}function rE(e="",n=""){return`${(e==null?void 0:e.charAt(0))||""}${(n==null?void 0:n.charAt(0))||""}`.toUpperCase()}const sE={ADMIN:"Administrateur",ENTREPRISE:"Entreprise",SALARIE:"Salarié",VISITEUR:"Visiteur"};function oE(e){return sE[e]||e}function aE(){return"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800"}function lE(e){return e?"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800":"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800"}async function uE({role:e,usineId:n,concessionnaireId:t,includeDetails:i=!1}){const r={role:e};return n&&(r.usine=n),t&&(r.concessionnaire=t),i&&(r.include_plans=!0),(await Wl.getUsers(r)).data}const Va=Np("auth",{state:()=>({user:null,isAuthenticated:!1,mustChangePassword:!1,initialized:!1,loading:!1,error:null,enterprises:[],employees:[],visitors:[]}),getters:{isAdmin:e=>{var n;return((n=e.user)==null?void 0:n.user_type)==="admin"},isEnterprise:e=>{var n;return((n=e.user)==null?void 0:n.user_type)==="entreprise"},isEmployee:e=>{var n;return((n=e.user)==null?void 0:n.user_type)==="salarie"},isVisitor:e=>{var n;return((n=e.user)==null?void 0:n.user_type)==="visiteur"},currentUser:e=>e.user,hasEnterprise:e=>{var n;return!!((n=e.user)!=null&&n.enterprise_id)},hasEmployee:e=>{var n;return!!((n=e.user)!=null&&n.employee_id)}},actions:{async initialize(e){if(!e){const t=await this.restoreSession();return this.initialized=!0,t}if(e.isAuthenticated&&e.user)return this.user=e.user,this.isAuthenticated=!0,this.mustChangePassword=e.user.must_change_password||!1,this.initialized=!0,!0;const n=await this.restoreSession();return this.initialized=!0,n},async restoreSession(){try{if(!up("access_token"))return this.isAuthenticated=!1,this.user=null,!1;const n=await Kn.post("/token/refresh/");return n.data.user?(this.user=n.data.user,this.isAuthenticated=!0,this.mustChangePassword=n.data.user.must_change_password||!1,!0):(await this.fetchUserProfile(),!0)}catch(e){return console.error("Failed to restore session:",e),this.isAuthenticated=!1,this.user=null,!1}},async login(e,n){var t,i,r;try{const o=await Kn.post("/token/",{username:e,password:n});if(!o.data.access)throw new Error("Token d'accès non reçu");document.cookie=`access_token=${o.data.access}; path=/; secure; samesite=Strict`;const l=await this.fetchUserProfile();return this.user=l,this.isAuthenticated=!0,!0}catch(o){throw this.isAuthenticated=!1,this.user=null,((t=o.response)==null?void 0:t.status)===401?new Error("Identifiants incorrects"):(r=(i=o.response)==null?void 0:i.data)!=null&&r.detail?new Error(o.response.data.detail):o}},async logout(){this.user=null,this.isAuthenticated=!1,this.mustChangePassword=!1,document.cookie="access_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="refresh_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT"},async checkAuth(){try{return await this.fetchUserProfile(),!0}catch{return this.isAuthenticated=!1,this.user=null,!1}},async fetchUserProfile(){try{const e=await Kn.get("/users/me/");return this.user=e.data,this.isAuthenticated=!0,this.mustChangePassword=e.data.must_change_password||!1,e.data}catch(e){throw this.isAuthenticated=!1,this.user=null,e}},async changePassword(e,n){try{const t=await Kn.post("/users/change_password/",{old_password:e,password:n});return this.user={...this.user,must_change_password:!1},t.data}catch(t){throw console.error("Password change error:",t),t}},async refreshToken(){var e,n,t,i;try{const r=await Kn.post("/token/refresh/",{},{withCredentials:!0}),{access:o}=r.data;if(!o)throw new Error("No access token received");return iE("access_token",o,1),this.isAuthenticated=!0,o}catch(r){throw console.error("Error refreshing token:",{status:(e=r.response)==null?void 0:e.status,data:(n=r.response)==null?void 0:n.data}),(((t=r.response)==null?void 0:t.status)===401||((i=r.response)==null?void 0:i.status)===403)&&await this.logout(),r}},async fetchUsers(e={}){this.loading=!0;try{return(await Wl.getUsers(e)).data}catch(n){throw this.error="Erreur lors de la récupération des utilisateurs",n}finally{this.loading=!1}},async fetchEnterprises(){this.loading=!0;try{const e=await Wl.getEnterprises();return this.enterprises=e.data,this.enterprises}catch(e){throw this.error="Erreur lors de la récupération des entreprises",e}finally{this.loading=!1}},async fetchEnterpriseEmployees(e){this.loading=!0;try{const n=await Wl.getEnterpriseEmployees(e);return this.employees=n.data,this.employees}catch(n){throw this.error="Erreur lors de la récupération des salariés",n}finally{this.loading=!1}},async fetchEnterpriseVisitors(e){this.loading=!0;try{const n=await Wl.getEnterpriseVisitors(e);return this.visitors=n.data,this.visitors}catch(n){throw this.error="Erreur lors de la récupération des visiteurs",n}finally{this.loading=!1}},async createUser(e){this.loading=!0;try{return(await Wl.createUser(e)).data}catch(n){throw this.error="Erreur lors de la création de l'utilisateur",n}finally{this.loading=!1}},async updateUser(e,n){this.loading=!0;try{return(await Wl.updateUser(e,n)).data}catch(t){throw this.error="Erreur lors de la mise à jour de l'utilisateur",t}finally{this.loading=!1}},async deleteUser(e){this.loading=!0;try{return await Wl.deleteUser(e),!0}catch(n){throw this.error="Erreur lors de la suppression de l'utilisateur",n}finally{this.loading=!1}},async fetchEnterprisesLegacy(){this.loading=!0;try{const e=await Kn.get("/users/",{params:{role:"entreprise"}});this.enterprises=e.data}catch(e){throw this.error="Erreur lors de la récupération des entreprises",e}finally{this.loading=!1}},async setEnterprise(e,n){this.loading=!0;try{await Kn.patch(`/users/${e}/`,{enterprise:n}),this.user&&this.user.id===e&&(this.user.enterprise_id=n)}catch(t){throw this.error="Erreur lors de la mise à jour de l'entreprise",t}finally{this.loading=!1}},async updateUserRole(e,n){this.loading=!0;try{const t=await Kn.patch(`/users/${e}/`,{role:n});return this.user&&this.user.id===e&&(this.user.user_type=n),t.data}catch(t){throw this.error="Erreur lors de la mise à jour du rôle",t}finally{this.loading=!1}},async updateUserEmail(e){var n;this.loading=!0;try{const t=await Kn.patch(`/users/${(n=this.user)==null?void 0:n.id}/`,{email:e});return this.user&&(this.user.email=e),t.data}catch(t){throw this.error="Erreur lors de la mise à jour de l'email",t}finally{this.loading=!1}},async uploadLogo(e){this.loading=!0;try{const n=await Wl.uploadLogo(e);return this.user&&n.data.logo&&(this.user.logo=n.data.logo),n.data}catch(n){throw this.error="Erreur lors du téléversement du logo",n}finally{this.loading=!1}},checkAccess(e){return this.user?e.includes(this.user.user_type):!1},async fetchUsersByRole(e){this.loading=!0;try{return await uE(e)}catch(n){throw console.error(`Error fetching ${e.role}:`,n),n}finally{this.loading=!1}}}});/*!
  * vue-router v4.5.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const Bh=typeof document<"u";function H2(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function cE(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&H2(e.default)}const Lr=Object.assign;function I0(e,n){const t={};for(const i in n){const r=n[i];t[i]=Ql(r)?r.map(e):e(r)}return t}const Bf=()=>{},Ql=Array.isArray,W2=/#/g,hE=/&/g,fE=/\//g,dE=/=/g,pE=/\?/g,Z2=/\+/g,gE=/%5B/g,mE=/%5D/g,K2=/%5E/g,vE=/%60/g,J2=/%7B/g,yE=/%7C/g,Y2=/%7D/g,_E=/%20/g;function ym(e){return encodeURI(""+e).replace(yE,"|").replace(gE,"[").replace(mE,"]")}function bE(e){return ym(e).replace(J2,"{").replace(Y2,"}").replace(K2,"^")}function Cg(e){return ym(e).replace(Z2,"%2B").replace(_E,"+").replace(W2,"%23").replace(hE,"%26").replace(vE,"`").replace(J2,"{").replace(Y2,"}").replace(K2,"^")}function wE(e){return Cg(e).replace(dE,"%3D")}function xE(e){return ym(e).replace(W2,"%23").replace(pE,"%3F")}function LE(e){return e==null?"":xE(e).replace(fE,"%2F")}function Gf(e){try{return decodeURIComponent(""+e)}catch{}return""+e}const CE=/\/$/,SE=e=>e.replace(CE,"");function F0(e,n,t="/"){let i,r={},o="",l="";const h=n.indexOf("#");let g=n.indexOf("?");return h<g&&h>=0&&(g=-1),g>-1&&(i=n.slice(0,g),o=n.slice(g+1,h>-1?h:n.length),r=e(o)),h>-1&&(i=i||n.slice(0,h),l=n.slice(h,n.length)),i=ME(i??n,t),{fullPath:i+(o&&"?")+o+l,path:i,query:r,hash:Gf(l)}}function PE(e,n){const t=n.query?e(n.query):"";return n.path+(t&&"?")+t+(n.hash||"")}function jv(e,n){return!n||!e.toLowerCase().startsWith(n.toLowerCase())?e:e.slice(n.length)||"/"}function EE(e,n,t){const i=n.matched.length-1,r=t.matched.length-1;return i>-1&&i===r&&Gh(n.matched[i],t.matched[r])&&X2(n.params,t.params)&&e(n.query)===e(t.query)&&n.hash===t.hash}function Gh(e,n){return(e.aliasOf||e)===(n.aliasOf||n)}function X2(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const t in e)if(!AE(e[t],n[t]))return!1;return!0}function AE(e,n){return Ql(e)?Uv(e,n):Ql(n)?Uv(n,e):e===n}function Uv(e,n){return Ql(n)?e.length===n.length&&e.every((t,i)=>t===n[i]):e.length===1&&e[0]===n}function ME(e,n){if(e.startsWith("/"))return e;if(!e)return n;const t=n.split("/"),i=e.split("/"),r=i[i.length-1];(r===".."||r===".")&&i.push("");let o=t.length-1,l,h;for(l=0;l<i.length;l++)if(h=i[l],h!==".")if(h==="..")o>1&&o--;else break;return t.slice(0,o).join("/")+"/"+i.slice(l).join("/")}const lc={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Hf;(function(e){e.pop="pop",e.push="push"})(Hf||(Hf={}));var Nf;(function(e){e.back="back",e.forward="forward",e.unknown=""})(Nf||(Nf={}));function kE(e){if(!e)if(Bh){const n=document.querySelector("base");e=n&&n.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),SE(e)}const TE=/^[^#]+#/;function BE(e,n){return e.replace(TE,"#")+n}function NE(e,n){const t=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:n.behavior,left:i.left-t.left-(n.left||0),top:i.top-t.top-(n.top||0)}}const Up=()=>({left:window.scrollX,top:window.scrollY});function RE(e){let n;if("el"in e){const t=e.el,i=typeof t=="string"&&t.startsWith("#"),r=typeof t=="string"?i?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!r)return;n=NE(r,e)}else n=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(n):window.scrollTo(n.left!=null?n.left:window.scrollX,n.top!=null?n.top:window.scrollY)}function $v(e,n){return(history.state?history.state.position-n:-1)+e}const Sg=new Map;function DE(e,n){Sg.set(e,n)}function OE(e){const n=Sg.get(e);return Sg.delete(e),n}let IE=()=>location.protocol+"//"+location.host;function Q2(e,n){const{pathname:t,search:i,hash:r}=n,o=e.indexOf("#");if(o>-1){let h=r.includes(e.slice(o))?e.slice(o).length:1,g=r.slice(h);return g[0]!=="/"&&(g="/"+g),jv(g,"")}return jv(t,e)+i+r}function FE(e,n,t,i){let r=[],o=[],l=null;const h=({state:E})=>{const b=Q2(e,location),D=t.value,$=n.value;let Q=0;if(E){if(t.value=b,n.value=E,l&&l===D){l=null;return}Q=$?E.position-$.position:0}else i(b);r.forEach(F=>{F(t.value,D,{delta:Q,type:Hf.pop,direction:Q?Q>0?Nf.forward:Nf.back:Nf.unknown})})};function g(){l=t.value}function v(E){r.push(E);const b=()=>{const D=r.indexOf(E);D>-1&&r.splice(D,1)};return o.push(b),b}function _(){const{history:E}=window;E.state&&E.replaceState(Lr({},E.state,{scroll:Up()}),"")}function x(){for(const E of o)E();o=[],window.removeEventListener("popstate",h),window.removeEventListener("beforeunload",_)}return window.addEventListener("popstate",h),window.addEventListener("beforeunload",_,{passive:!0}),{pauseListeners:g,listen:v,destroy:x}}function qv(e,n,t,i=!1,r=!1){return{back:e,current:n,forward:t,replaced:i,position:window.history.length,scroll:r?Up():null}}function zE(e){const{history:n,location:t}=window,i={value:Q2(e,t)},r={value:n.state};r.value||o(i.value,{back:null,current:i.value,forward:null,position:n.length-1,replaced:!0,scroll:null},!0);function o(g,v,_){const x=e.indexOf("#"),E=x>-1?(t.host&&document.querySelector("base")?e:e.slice(x))+g:IE()+e+g;try{n[_?"replaceState":"pushState"](v,"",E),r.value=v}catch(b){console.error(b),t[_?"replace":"assign"](E)}}function l(g,v){const _=Lr({},n.state,qv(r.value.back,g,r.value.forward,!0),v,{position:r.value.position});o(g,_,!0),i.value=g}function h(g,v){const _=Lr({},r.value,n.state,{forward:g,scroll:Up()});o(_.current,_,!0);const x=Lr({},qv(i.value,g,null),{position:_.position+1},v);o(g,x,!1),i.value=g}return{location:i,state:r,push:h,replace:l}}function jE(e){e=kE(e);const n=zE(e),t=FE(e,n.state,n.location,n.replace);function i(o,l=!0){l||t.pauseListeners(),history.go(o)}const r=Lr({location:"",base:e,go:i,createHref:BE.bind(null,e)},n,t);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>n.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>n.state.value}),r}function UE(e){return typeof e=="string"||e&&typeof e=="object"}function e4(e){return typeof e=="string"||typeof e=="symbol"}const t4=Symbol("");var Vv;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(Vv||(Vv={}));function Hh(e,n){return Lr(new Error,{type:e,[t4]:!0},n)}function Vu(e,n){return e instanceof Error&&t4 in e&&(n==null||!!(e.type&n))}const Gv="[^/]+?",$E={sensitive:!1,strict:!1,start:!0,end:!0},qE=/[.+*?^${}()[\]/\\]/g;function VE(e,n){const t=Lr({},$E,n),i=[];let r=t.start?"^":"";const o=[];for(const v of e){const _=v.length?[]:[90];t.strict&&!v.length&&(r+="/");for(let x=0;x<v.length;x++){const E=v[x];let b=40+(t.sensitive?.25:0);if(E.type===0)x||(r+="/"),r+=E.value.replace(qE,"\\$&"),b+=40;else if(E.type===1){const{value:D,repeatable:$,optional:Q,regexp:F}=E;o.push({name:D,repeatable:$,optional:Q});const G=F||Gv;if(G!==Gv){b+=10;try{new RegExp(`(${G})`)}catch(Se){throw new Error(`Invalid custom RegExp for param "${D}" (${G}): `+Se.message)}}let me=$?`((?:${G})(?:/(?:${G}))*)`:`(${G})`;x||(me=Q&&v.length<2?`(?:/${me})`:"/"+me),Q&&(me+="?"),r+=me,b+=20,Q&&(b+=-8),$&&(b+=-20),G===".*"&&(b+=-50)}_.push(b)}i.push(_)}if(t.strict&&t.end){const v=i.length-1;i[v][i[v].length-1]+=.7000000000000001}t.strict||(r+="/?"),t.end?r+="$":t.strict&&!r.endsWith("/")&&(r+="(?:/|$)");const l=new RegExp(r,t.sensitive?"":"i");function h(v){const _=v.match(l),x={};if(!_)return null;for(let E=1;E<_.length;E++){const b=_[E]||"",D=o[E-1];x[D.name]=b&&D.repeatable?b.split("/"):b}return x}function g(v){let _="",x=!1;for(const E of e){(!x||!_.endsWith("/"))&&(_+="/"),x=!1;for(const b of E)if(b.type===0)_+=b.value;else if(b.type===1){const{value:D,repeatable:$,optional:Q}=b,F=D in v?v[D]:"";if(Ql(F)&&!$)throw new Error(`Provided param "${D}" is an array but it is not repeatable (* or + modifiers)`);const G=Ql(F)?F.join("/"):F;if(!G)if(Q)E.length<2&&(_.endsWith("/")?_=_.slice(0,-1):x=!0);else throw new Error(`Missing required param "${D}"`);_+=G}}return _||"/"}return{re:l,score:i,keys:o,parse:h,stringify:g}}function GE(e,n){let t=0;for(;t<e.length&&t<n.length;){const i=n[t]-e[t];if(i)return i;t++}return e.length<n.length?e.length===1&&e[0]===80?-1:1:e.length>n.length?n.length===1&&n[0]===80?1:-1:0}function n4(e,n){let t=0;const i=e.score,r=n.score;for(;t<i.length&&t<r.length;){const o=GE(i[t],r[t]);if(o)return o;t++}if(Math.abs(r.length-i.length)===1){if(Hv(i))return 1;if(Hv(r))return-1}return r.length-i.length}function Hv(e){const n=e[e.length-1];return e.length>0&&n[n.length-1]<0}const HE={type:0,value:""},WE=/[a-zA-Z0-9_]/;function ZE(e){if(!e)return[[]];if(e==="/")return[[HE]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function n(b){throw new Error(`ERR (${t})/"${v}": ${b}`)}let t=0,i=t;const r=[];let o;function l(){o&&r.push(o),o=[]}let h=0,g,v="",_="";function x(){v&&(t===0?o.push({type:0,value:v}):t===1||t===2||t===3?(o.length>1&&(g==="*"||g==="+")&&n(`A repeatable param (${v}) must be alone in its segment. eg: '/:ids+.`),o.push({type:1,value:v,regexp:_,repeatable:g==="*"||g==="+",optional:g==="*"||g==="?"})):n("Invalid state to consume buffer"),v="")}function E(){v+=g}for(;h<e.length;){if(g=e[h++],g==="\\"&&t!==2){i=t,t=4;continue}switch(t){case 0:g==="/"?(v&&x(),l()):g===":"?(x(),t=1):E();break;case 4:E(),t=i;break;case 1:g==="("?t=2:WE.test(g)?E():(x(),t=0,g!=="*"&&g!=="?"&&g!=="+"&&h--);break;case 2:g===")"?_[_.length-1]=="\\"?_=_.slice(0,-1)+g:t=3:_+=g;break;case 3:x(),t=0,g!=="*"&&g!=="?"&&g!=="+"&&h--,_="";break;default:n("Unknown state");break}}return t===2&&n(`Unfinished custom RegExp for param "${v}"`),x(),l(),r}function KE(e,n,t){const i=VE(ZE(e.path),t),r=Lr(i,{record:e,parent:n,children:[],alias:[]});return n&&!r.record.aliasOf==!n.record.aliasOf&&n.children.push(r),r}function JE(e,n){const t=[],i=new Map;n=Jv({strict:!1,end:!0,sensitive:!1},n);function r(x){return i.get(x)}function o(x,E,b){const D=!b,$=Zv(x);$.aliasOf=b&&b.record;const Q=Jv(n,x),F=[$];if("alias"in x){const Se=typeof x.alias=="string"?[x.alias]:x.alias;for(const Ie of Se)F.push(Zv(Lr({},$,{components:b?b.record.components:$.components,path:Ie,aliasOf:b?b.record:$})))}let G,me;for(const Se of F){const{path:Ie}=Se;if(E&&Ie[0]!=="/"){const nt=E.record.path,Ve=nt[nt.length-1]==="/"?"":"/";Se.path=E.record.path+(Ie&&Ve+Ie)}if(G=KE(Se,E,Q),b?b.alias.push(G):(me=me||G,me!==G&&me.alias.push(G),D&&x.name&&!Kv(G)&&l(x.name)),i4(G)&&g(G),$.children){const nt=$.children;for(let Ve=0;Ve<nt.length;Ve++)o(nt[Ve],G,b&&b.children[Ve])}b=b||G}return me?()=>{l(me)}:Bf}function l(x){if(e4(x)){const E=i.get(x);E&&(i.delete(x),t.splice(t.indexOf(E),1),E.children.forEach(l),E.alias.forEach(l))}else{const E=t.indexOf(x);E>-1&&(t.splice(E,1),x.record.name&&i.delete(x.record.name),x.children.forEach(l),x.alias.forEach(l))}}function h(){return t}function g(x){const E=QE(x,t);t.splice(E,0,x),x.record.name&&!Kv(x)&&i.set(x.record.name,x)}function v(x,E){let b,D={},$,Q;if("name"in x&&x.name){if(b=i.get(x.name),!b)throw Hh(1,{location:x});Q=b.record.name,D=Lr(Wv(E.params,b.keys.filter(me=>!me.optional).concat(b.parent?b.parent.keys.filter(me=>me.optional):[]).map(me=>me.name)),x.params&&Wv(x.params,b.keys.map(me=>me.name))),$=b.stringify(D)}else if(x.path!=null)$=x.path,b=t.find(me=>me.re.test($)),b&&(D=b.parse($),Q=b.record.name);else{if(b=E.name?i.get(E.name):t.find(me=>me.re.test(E.path)),!b)throw Hh(1,{location:x,currentLocation:E});Q=b.record.name,D=Lr({},E.params,x.params),$=b.stringify(D)}const F=[];let G=b;for(;G;)F.unshift(G.record),G=G.parent;return{name:Q,path:$,params:D,matched:F,meta:XE(F)}}e.forEach(x=>o(x));function _(){t.length=0,i.clear()}return{addRoute:o,resolve:v,removeRoute:l,clearRoutes:_,getRoutes:h,getRecordMatcher:r}}function Wv(e,n){const t={};for(const i of n)i in e&&(t[i]=e[i]);return t}function Zv(e){const n={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:YE(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(n,"mods",{value:{}}),n}function YE(e){const n={},t=e.props||!1;if("component"in e)n.default=t;else for(const i in e.components)n[i]=typeof t=="object"?t[i]:t;return n}function Kv(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function XE(e){return e.reduce((n,t)=>Lr(n,t.meta),{})}function Jv(e,n){const t={};for(const i in e)t[i]=i in n?n[i]:e[i];return t}function QE(e,n){let t=0,i=n.length;for(;t!==i;){const o=t+i>>1;n4(e,n[o])<0?i=o:t=o+1}const r=eA(e);return r&&(i=n.lastIndexOf(r,i-1)),i}function eA(e){let n=e;for(;n=n.parent;)if(i4(n)&&n4(e,n)===0)return n}function i4({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function tA(e){const n={};if(e===""||e==="?")return n;const i=(e[0]==="?"?e.slice(1):e).split("&");for(let r=0;r<i.length;++r){const o=i[r].replace(Z2," "),l=o.indexOf("="),h=Gf(l<0?o:o.slice(0,l)),g=l<0?null:Gf(o.slice(l+1));if(h in n){let v=n[h];Ql(v)||(v=n[h]=[v]),v.push(g)}else n[h]=g}return n}function Yv(e){let n="";for(let t in e){const i=e[t];if(t=wE(t),i==null){i!==void 0&&(n+=(n.length?"&":"")+t);continue}(Ql(i)?i.map(o=>o&&Cg(o)):[i&&Cg(i)]).forEach(o=>{o!==void 0&&(n+=(n.length?"&":"")+t,o!=null&&(n+="="+o))})}return n}function nA(e){const n={};for(const t in e){const i=e[t];i!==void 0&&(n[t]=Ql(i)?i.map(r=>r==null?null:""+r):i==null?i:""+i)}return n}const iA=Symbol(""),Xv=Symbol(""),$p=Symbol(""),_m=Symbol(""),Pg=Symbol("");function ff(){let e=[];function n(i){return e.push(i),()=>{const r=e.indexOf(i);r>-1&&e.splice(r,1)}}function t(){e=[]}return{add:n,list:()=>e.slice(),reset:t}}function mc(e,n,t,i,r,o=l=>l()){const l=i&&(i.enterCallbacks[r]=i.enterCallbacks[r]||[]);return()=>new Promise((h,g)=>{const v=E=>{E===!1?g(Hh(4,{from:t,to:n})):E instanceof Error?g(E):UE(E)?g(Hh(2,{from:n,to:E})):(l&&i.enterCallbacks[r]===l&&typeof E=="function"&&l.push(E),h())},_=o(()=>e.call(i&&i.instances[r],n,t,v));let x=Promise.resolve(_);e.length<3&&(x=x.then(v)),x.catch(E=>g(E))})}function z0(e,n,t,i,r=o=>o()){const o=[];for(const l of e)for(const h in l.components){let g=l.components[h];if(!(n!=="beforeRouteEnter"&&!l.instances[h]))if(H2(g)){const _=(g.__vccOpts||g)[n];_&&o.push(mc(_,t,i,l,h,r))}else{let v=g();o.push(()=>v.then(_=>{if(!_)throw new Error(`Couldn't resolve component "${h}" at "${l.path}"`);const x=cE(_)?_.default:_;l.mods[h]=_,l.components[h]=x;const b=(x.__vccOpts||x)[n];return b&&mc(b,t,i,l,h,r)()}))}}return o}function Qv(e){const n=Al($p),t=Al(_m),i=Ni(()=>{const g=Wn(e.to);return n.resolve(g)}),r=Ni(()=>{const{matched:g}=i.value,{length:v}=g,_=g[v-1],x=t.matched;if(!_||!x.length)return-1;const E=x.findIndex(Gh.bind(null,_));if(E>-1)return E;const b=ey(g[v-2]);return v>1&&ey(_)===b&&x[x.length-1].path!==b?x.findIndex(Gh.bind(null,g[v-2])):E}),o=Ni(()=>r.value>-1&&aA(t.params,i.value.params)),l=Ni(()=>r.value>-1&&r.value===t.matched.length-1&&X2(t.params,i.value.params));function h(g={}){if(oA(g)){const v=n[Wn(e.replace)?"replace":"push"](Wn(e.to)).catch(Bf);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>v),v}return Promise.resolve()}return{route:i,href:Ni(()=>i.value.href),isActive:o,isExactActive:l,navigate:h}}function rA(e){return e.length===1?e[0]:e}const sA=Pa({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Qv,setup(e,{slots:n}){const t=Au(Qv(e)),{options:i}=Al($p),r=Ni(()=>({[ty(e.activeClass,i.linkActiveClass,"router-link-active")]:t.isActive,[ty(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const o=n.default&&rA(n.default(t));return e.custom?o:dm("a",{"aria-current":t.isExactActive?e.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:r.value},o)}}}),bf=sA;function oA(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const n=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(n))return}return e.preventDefault&&e.preventDefault(),!0}}function aA(e,n){for(const t in n){const i=n[t],r=e[t];if(typeof i=="string"){if(i!==r)return!1}else if(!Ql(r)||r.length!==i.length||i.some((o,l)=>o!==r[l]))return!1}return!0}function ey(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const ty=(e,n,t)=>e??n??t,lA=Pa({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:n,slots:t}){const i=Al(Pg),r=Ni(()=>e.route||i.value),o=Al(Xv,0),l=Ni(()=>{let v=Wn(o);const{matched:_}=r.value;let x;for(;(x=_[v])&&!x.components;)v++;return v}),h=Ni(()=>r.value.matched[l.value]);Dd(Xv,Ni(()=>l.value+1)),Dd(iA,h),Dd(Pg,r);const g=un();return So(()=>[g.value,h.value,e.name],([v,_,x],[E,b,D])=>{_&&(_.instances[x]=v,b&&b!==_&&v&&v===E&&(_.leaveGuards.size||(_.leaveGuards=b.leaveGuards),_.updateGuards.size||(_.updateGuards=b.updateGuards))),v&&_&&(!b||!Gh(_,b)||!E)&&(_.enterCallbacks[x]||[]).forEach($=>$(v))},{flush:"post"}),()=>{const v=r.value,_=e.name,x=h.value,E=x&&x.components[_];if(!E)return ny(t.default,{Component:E,route:v});const b=x.props[_],D=b?b===!0?v.params:typeof b=="function"?b(v):b:null,Q=dm(E,Lr({},D,n,{onVnodeUnmounted:F=>{F.component.isUnmounted&&(x.instances[_]=null)},ref:g}));return ny(t.default,{Component:Q,route:v})||Q}}});function ny(e,n){if(!e)return null;const t=e(n);return t.length===1?t[0]:t}const r4=lA;function uA(e){const n=JE(e.routes,e),t=e.parseQuery||tA,i=e.stringifyQuery||Yv,r=e.history,o=ff(),l=ff(),h=ff(),g=mL(lc);let v=lc;Bh&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const _=I0.bind(null,te=>""+te),x=I0.bind(null,LE),E=I0.bind(null,Gf);function b(te,ie){let ee,se;return e4(te)?(ee=n.getRecordMatcher(te),se=ie):se=te,n.addRoute(se,ee)}function D(te){const ie=n.getRecordMatcher(te);ie&&n.removeRoute(ie)}function $(){return n.getRoutes().map(te=>te.record)}function Q(te){return!!n.getRecordMatcher(te)}function F(te,ie){if(ie=Lr({},ie||g.value),typeof te=="string"){const xe=F0(t,te,ie.path),ye=n.resolve({path:xe.path},ie),le=r.createHref(xe.fullPath);return Lr(xe,ye,{params:E(ye.params),hash:Gf(xe.hash),redirectedFrom:void 0,href:le})}let ee;if(te.path!=null)ee=Lr({},te,{path:F0(t,te.path,ie.path).path});else{const xe=Lr({},te.params);for(const ye in xe)xe[ye]==null&&delete xe[ye];ee=Lr({},te,{params:x(xe)}),ie.params=x(ie.params)}const se=n.resolve(ee,ie),Ce=te.hash||"";se.params=_(E(se.params));const ne=PE(i,Lr({},te,{hash:bE(Ce),path:se.path})),ae=r.createHref(ne);return Lr({fullPath:ne,hash:Ce,query:i===Yv?nA(te.query):te.query||{}},se,{redirectedFrom:void 0,href:ae})}function G(te){return typeof te=="string"?F0(t,te,g.value.path):Lr({},te)}function me(te,ie){if(v!==te)return Hh(8,{from:ie,to:te})}function Se(te){return Ve(te)}function Ie(te){return Se(Lr(G(te),{replace:!0}))}function nt(te){const ie=te.matched[te.matched.length-1];if(ie&&ie.redirect){const{redirect:ee}=ie;let se=typeof ee=="function"?ee(te):ee;return typeof se=="string"&&(se=se.includes("?")||se.includes("#")?se=G(se):{path:se},se.params={}),Lr({query:te.query,hash:te.hash,params:se.path!=null?{}:te.params},se)}}function Ve(te,ie){const ee=v=F(te),se=g.value,Ce=te.state,ne=te.force,ae=te.replace===!0,xe=nt(ee);if(xe)return Ve(Lr(G(xe),{state:typeof xe=="object"?Lr({},Ce,xe.state):Ce,force:ne,replace:ae}),ie||ee);const ye=ee;ye.redirectedFrom=ie;let le;return!ne&&EE(i,se,ee)&&(le=Hh(16,{to:ye,from:se}),ot(se,se,!0,!1)),(le?Promise.resolve(le):ue(ye,se)).catch(je=>Vu(je)?Vu(je,2)?je:Me(je):re(je,ye,se)).then(je=>{if(je){if(Vu(je,2))return Ve(Lr({replace:ae},G(je.to),{state:typeof je.to=="object"?Lr({},Ce,je.to.state):Ce,force:ne}),ie||ye)}else je=R(ye,se,!0,ae,Ce);return z(ye,se,je),je})}function O(te,ie){const ee=me(te,ie);return ee?Promise.reject(ee):Promise.resolve()}function W(te){const ie=B.values().next().value;return ie&&typeof ie.runWithContext=="function"?ie.runWithContext(te):te()}function ue(te,ie){let ee;const[se,Ce,ne]=cA(te,ie);ee=z0(se.reverse(),"beforeRouteLeave",te,ie);for(const xe of se)xe.leaveGuards.forEach(ye=>{ee.push(mc(ye,te,ie))});const ae=O.bind(null,te,ie);return ee.push(ae),he(ee).then(()=>{ee=[];for(const xe of o.list())ee.push(mc(xe,te,ie));return ee.push(ae),he(ee)}).then(()=>{ee=z0(Ce,"beforeRouteUpdate",te,ie);for(const xe of Ce)xe.updateGuards.forEach(ye=>{ee.push(mc(ye,te,ie))});return ee.push(ae),he(ee)}).then(()=>{ee=[];for(const xe of ne)if(xe.beforeEnter)if(Ql(xe.beforeEnter))for(const ye of xe.beforeEnter)ee.push(mc(ye,te,ie));else ee.push(mc(xe.beforeEnter,te,ie));return ee.push(ae),he(ee)}).then(()=>(te.matched.forEach(xe=>xe.enterCallbacks={}),ee=z0(ne,"beforeRouteEnter",te,ie,W),ee.push(ae),he(ee))).then(()=>{ee=[];for(const xe of l.list())ee.push(mc(xe,te,ie));return ee.push(ae),he(ee)}).catch(xe=>Vu(xe,8)?xe:Promise.reject(xe))}function z(te,ie,ee){h.list().forEach(se=>W(()=>se(te,ie,ee)))}function R(te,ie,ee,se,Ce){const ne=me(te,ie);if(ne)return ne;const ae=ie===lc,xe=Bh?history.state:{};ee&&(se||ae?r.replace(te.fullPath,Lr({scroll:ae&&xe&&xe.scroll},Ce)):r.push(te.fullPath,Ce)),g.value=te,ot(te,ie,ee,ae),Me()}let J;function V(){J||(J=r.listen((te,ie,ee)=>{if(!H.listening)return;const se=F(te),Ce=nt(se);if(Ce){Ve(Lr(Ce,{replace:!0,force:!0}),se).catch(Bf);return}v=se;const ne=g.value;Bh&&DE($v(ne.fullPath,ee.delta),Up()),ue(se,ne).catch(ae=>Vu(ae,12)?ae:Vu(ae,2)?(Ve(Lr(G(ae.to),{force:!0}),se).then(xe=>{Vu(xe,20)&&!ee.delta&&ee.type===Hf.pop&&r.go(-1,!1)}).catch(Bf),Promise.reject()):(ee.delta&&r.go(-ee.delta,!1),re(ae,se,ne))).then(ae=>{ae=ae||R(se,ne,!1),ae&&(ee.delta&&!Vu(ae,8)?r.go(-ee.delta,!1):ee.type===Hf.pop&&Vu(ae,20)&&r.go(-1,!1)),z(se,ne,ae)}).catch(Bf)}))}let U=ff(),Y=ff(),ce;function re(te,ie,ee){Me(te);const se=Y.list();return se.length?se.forEach(Ce=>Ce(te,ie,ee)):console.error(te),Promise.reject(te)}function Pe(){return ce&&g.value!==lc?Promise.resolve():new Promise((te,ie)=>{U.add([te,ie])})}function Me(te){return ce||(ce=!te,V(),U.list().forEach(([ie,ee])=>te?ee(te):ie()),U.reset()),te}function ot(te,ie,ee,se){const{scrollBehavior:Ce}=e;if(!Bh||!Ce)return Promise.resolve();const ne=!ee&&OE($v(te.fullPath,0))||(se||!ee)&&history.state&&history.state.scroll||null;return Ds().then(()=>Ce(te,ie,ne)).then(ae=>ae&&RE(ae)).catch(ae=>re(ae,te,ie))}const X=te=>r.go(te);let Ee;const B=new Set,H={currentRoute:g,listening:!0,addRoute:b,removeRoute:D,clearRoutes:n.clearRoutes,hasRoute:Q,getRoutes:$,resolve:F,options:e,push:Se,replace:Ie,go:X,back:()=>X(-1),forward:()=>X(1),beforeEach:o.add,beforeResolve:l.add,afterEach:h.add,onError:Y.add,isReady:Pe,install(te){const ie=this;te.component("RouterLink",bf),te.component("RouterView",r4),te.config.globalProperties.$router=ie,Object.defineProperty(te.config.globalProperties,"$route",{enumerable:!0,get:()=>Wn(g)}),Bh&&!Ee&&g.value===lc&&(Ee=!0,Se(r.location).catch(Ce=>{}));const ee={};for(const Ce in lc)Object.defineProperty(ee,Ce,{get:()=>g.value[Ce],enumerable:!0});te.provide($p,ie),te.provide(_m,w_(ee)),te.provide(Pg,g);const se=te.unmount;B.add(te),te.unmount=function(){B.delete(te),B.size<1&&(v=lc,J&&J(),J=null,g.value=lc,Ee=!1,ce=!1),se()}}};function he(te){return te.reduce((ie,ee)=>ie.then(()=>W(ee)),Promise.resolve())}return H}function cA(e,n){const t=[],i=[],r=[],o=Math.max(n.matched.length,e.matched.length);for(let l=0;l<o;l++){const h=n.matched[l];h&&(e.matched.find(v=>Gh(v,h))?i.push(h):t.push(h));const g=e.matched[l];g&&(n.matched.find(v=>Gh(v,g))||r.push(g))}return[t,i,r]}function qp(){return Al($p)}function aF(e){return Al(_m)}const Rf=Np("notification",()=>{const e=un([]),n=un(0),t=un(null),i=Ni(()=>[...e.value].sort((x,E)=>E.timestamp-x.timestamp));function r({type:x,message:E,duration:b=5e3}){const D=++n.value,$=Date.now(),Q={id:D,type:x,message:E,duration:b,timestamp:$};return e.value.push(Q),t.value=D,b>0&&setTimeout(()=>{v(D)},b),D}const o=(x,E=5e3)=>r({type:"success",message:x,duration:E}),l=(x,E=5e3)=>r({type:"error",message:x,duration:E}),h=(x,E=5e3)=>r({type:"info",message:x,duration:E}),g=(x,E=5e3)=>r({type:"warning",message:x,duration:E});function v(x){const E=e.value.findIndex(b=>b.id===x);E!==-1&&e.value.splice(E,1),t.value===x&&(t.value=null)}function _(){e.value=[],t.value=null}return{notifications:i,lastAddedId:t,addNotification:r,removeNotification:v,clearAll:_,success:o,error:l,info:h,warning:g}});var qo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function s4(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function hA(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}var o4=hA,fA=typeof qo=="object"&&qo&&qo.Object===Object&&qo,dA=fA,pA=dA,gA=typeof self=="object"&&self&&self.Object===Object&&self,mA=pA||gA||Function("return this")(),a4=mA,vA=a4,yA=function(){return vA.Date.now()},_A=yA,bA=/\s/;function wA(e){for(var n=e.length;n--&&bA.test(e.charAt(n)););return n}var xA=wA,LA=xA,CA=/^\s+/;function SA(e){return e&&e.slice(0,LA(e)+1).replace(CA,"")}var PA=SA,EA=a4,AA=EA.Symbol,l4=AA,iy=l4,u4=Object.prototype,MA=u4.hasOwnProperty,kA=u4.toString,df=iy?iy.toStringTag:void 0;function TA(e){var n=MA.call(e,df),t=e[df];try{e[df]=void 0;var i=!0}catch{}var r=kA.call(e);return i&&(n?e[df]=t:delete e[df]),r}var BA=TA,NA=Object.prototype,RA=NA.toString;function DA(e){return RA.call(e)}var OA=DA,ry=l4,IA=BA,FA=OA,zA="[object Null]",jA="[object Undefined]",sy=ry?ry.toStringTag:void 0;function UA(e){return e==null?e===void 0?jA:zA:sy&&sy in Object(e)?IA(e):FA(e)}var $A=UA;function qA(e){return e!=null&&typeof e=="object"}var VA=qA,GA=$A,HA=VA,WA="[object Symbol]";function ZA(e){return typeof e=="symbol"||HA(e)&&GA(e)==WA}var KA=ZA,JA=PA,oy=o4,YA=KA,ay=NaN,XA=/^[-+]0x[0-9a-f]+$/i,QA=/^0b[01]+$/i,eM=/^0o[0-7]+$/i,tM=parseInt;function nM(e){if(typeof e=="number")return e;if(YA(e))return ay;if(oy(e)){var n=typeof e.valueOf=="function"?e.valueOf():e;e=oy(n)?n+"":n}if(typeof e!="string")return e===0?e:+e;e=JA(e);var t=QA.test(e);return t||eM.test(e)?tM(e.slice(2),t?2:8):XA.test(e)?ay:+e}var iM=nM,rM=o4,j0=_A,ly=iM,sM="Expected a function",oM=Math.max,aM=Math.min;function lM(e,n,t){var i,r,o,l,h,g,v=0,_=!1,x=!1,E=!0;if(typeof e!="function")throw new TypeError(sM);n=ly(n)||0,rM(t)&&(_=!!t.leading,x="maxWait"in t,o=x?oM(ly(t.maxWait)||0,n):o,E="trailing"in t?!!t.trailing:E);function b(nt){var Ve=i,O=r;return i=r=void 0,v=nt,l=e.apply(O,Ve),l}function D(nt){return v=nt,h=setTimeout(F,n),_?b(nt):l}function $(nt){var Ve=nt-g,O=nt-v,W=n-Ve;return x?aM(W,o-O):W}function Q(nt){var Ve=nt-g,O=nt-v;return g===void 0||Ve>=n||Ve<0||x&&O>=o}function F(){var nt=j0();if(Q(nt))return G(nt);h=setTimeout(F,$(nt))}function G(nt){return h=void 0,E&&i?b(nt):(i=r=void 0,l)}function me(){h!==void 0&&clearTimeout(h),v=0,i=g=r=h=void 0}function Se(){return h===void 0?l:G(j0())}function Ie(){var nt=j0(),Ve=Q(nt);if(i=arguments,r=this,g=nt,Ve){if(h===void 0)return D(g);if(x)return clearTimeout(h),h=setTimeout(F,n),b(g)}return h===void 0&&(h=setTimeout(F,n)),l}return Ie.cancel=me,Ie.flush=Se,Ie}var uM=lM;const cM=s4(uM),hM={class:"relative w-full"},fM={key:0,class:"search-results w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto"},dM=["onClick"],uy=Pa({__name:"SearchBar",emits:["select-location"],setup(e,{emit:n}){const t=un(""),i=un([]),r=n,o=cM(async g=>{if(g.length<3){i.value=[];return}try{const _=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(g)}`)).json();i.value=_}catch(v){console.error("Erreur lors de la recherche d'adresse:",v),i.value=[]}},300);function l(){o(t.value)}function h(g){t.value=g.display_name,i.value=[],r("select-location",{lat:parseFloat(g.lat),lng:parseFloat(g.lon)})}return(g,v)=>(Ye(),tt("div",hM,[Dn(M("input",{"onUpdate:modelValue":v[0]||(v[0]=_=>t.value=_),onInput:l,type:"text",placeholder:"Rechercher une adresse...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"},null,544),[[ki,t.value]]),i.value.length>0?(Ye(),tt("div",fM,[(Ye(!0),tt(zn,null,Ti(i.value,_=>(Ye(),tt("div",{key:_.place_id,onClick:x=>h(_),class:"px-4 py-2 hover:bg-gray-100 cursor-pointer"},Ht(_.display_name),9,dM))),128))])):wn("",!0)]))}}),pM={class:"perf-title"},gM={class:"perf-basic-stats"},mM={class:"perf-stat"},vM={class:"perf-stat"},yM={class:"perf-expand-btn"},_M={key:0,class:"perf-content"},bM={class:"perf-section"},wM={class:"perf-metrics"},xM={class:"perf-metric"},LM={class:"perf-metric-value"},CM={class:"perf-metric"},SM={class:"perf-metric-value"},PM={class:"perf-metric"},EM={class:"perf-metric-value"},AM={class:"perf-metric"},MM={class:"perf-metric-value"},kM={class:"perf-section"},TM={class:"perf-metrics"},BM={key:0,class:"perf-metric"},NM={class:"perf-metric-value"},RM={key:1,class:"perf-metric"},DM={class:"perf-metric-value"},OM={key:2,class:"perf-metric"},IM={class:"perf-metric-value"},FM={class:"perf-section"},zM={class:"perf-table"},jM={class:"perf-table-cell"},UM={class:"perf-table-cell"},$M={class:"perf-table-cell"},qM={class:"perf-table-cell"},VM=["onClick"],GM={key:0,class:"perf-empty"},HM=Pa({__name:"PerformancePanel",props:{position:{}},setup(e){const t=e.position||"bottom-left",i=un(!1),{isQueryParamEnabled:r,isRecording:o,measures:l,longTasks:h,memorySnapshots:g,framesPerSecond:v,operationHistory:_,startRecording:x,stopRecording:E,clearRecording:b,captureMemorySnapshot:D,getSlowOperations:$,getPerformanceReport:Q,getOperationDetails:F}=Xh(),G=Ni(()=>{const R=Q()??{totalMeasures:0,totalLongTasks:0,slowestOperations:[],averageFps:0,memoryUsage:null};return{totalMeasures:R.totalMeasures,totalLongTasks:R.totalLongTasks,averageDuration:R.slowestOperations.length>0?R.slowestOperations.reduce((J,V)=>J+V.duration,0)/R.slowestOperations.length:0,fps:R.averageFps,slowestOperations:R.slowestOperations,memoryUsage:R.memoryUsage}}),me=Ni(()=>(Q()??{slowestOperations:[]}).slowestOperations.slice(0,5).map(J=>({operation:J.name,component:J.component||"unknown",durationMs:J.duration,timestamp:J.startTime}))),Se=un(null);Tl(()=>{r.value&&(Se.value=window.setInterval(()=>{D()},1e3))}),Kh(()=>{Se.value!==null&&clearInterval(Se.value)});function Ie(R){return R===void 0?"N/A":R<1024?R+" B":R<1024*1024?(R/1024).toFixed(2)+" KB":R<1024*1024*1024?(R/(1024*1024)).toFixed(2)+" MB":(R/(1024*1024*1024)).toFixed(2)+" GB"}function nt(R){return R.toFixed(2)}const Ve=()=>{D()};function O(){const R=Q(),J="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(R,null,2)),V=document.createElement("a");V.setAttribute("href",J),V.setAttribute("download","performance_report.json"),document.body.appendChild(V),V.click(),V.remove()}function W(){b(),Ve()}function ue(){const R=Q();navigator.clipboard.writeText(JSON.stringify(R,null,2)).then(()=>{alert("Données de performance copiées dans le presse-papiers")}).catch(J=>{console.error("Erreur lors de la copie des données",J),alert("Erreur lors de la copie des données")})}async function z(R){const J=F(R.operation,R.timestamp);if(!J){alert("Impossible de trouver les détails de cette opération");return}const V={operation:{...J.operation,startTimeRelative:"0ms",startTimeAbsolute:new Date(J.operation.startTime).toISOString()},context:{...J.context,relatedOperations:J.context.relatedOperations.map(U=>({...U,startTime:`+${U.startTime.toFixed(2)}ms`})),longTasks:J.context.longTasks.map(U=>({...U,startTime:`+${U.startTime.toFixed(2)}ms`})),memorySnapshots:J.context.memorySnapshots.map(U=>({...U,timestamp:`+${U.timestamp.toFixed(2)}ms`,usedJSHeapSize:U.usedJSHeapSize?Ie(U.usedJSHeapSize):"N/A",totalJSHeapSize:U.totalJSHeapSize?Ie(U.totalJSHeapSize):"N/A"}))},summary:{...J.summary,memoryDelta:Ie(J.summary.memoryDelta),maxLongTaskDuration:`${J.summary.maxLongTaskDuration.toFixed(2)}ms`}};try{await navigator.clipboard.writeText(JSON.stringify(V,null,2)),alert("Détails de l'opération copiés dans le presse-papiers")}catch(U){console.error("Erreur lors de la copie des détails",U),alert("Erreur lors de la copie des détails")}}return(R,J)=>{var V,U,Y,ce,re,Pe;return Wn(r)?(Ye(),tt("div",{key:0,class:Jr(["performance-panel",`position-${Wn(t)}`,{expanded:i.value}])},[M("div",{class:"perf-header",onClick:J[0]||(J[0]=Me=>i.value=!i.value)},[M("div",pM,[M("div",{class:Jr(["perf-indicator",{active:Wn(o)}])},null,2),J[1]||(J[1]=M("span",null,"Performance",-1))]),M("div",gM,[M("span",mM,Ht(G.value.fps)+" FPS",1),M("span",vM,Ht(nt(G.value.averageDuration))+"ms",1)]),M("button",yM,Ht(i.value?"▼":"▲"),1)]),i.value?(Ye(),tt("div",_M,[M("div",bM,[J[6]||(J[6]=M("h3",null,"Métriques générales",-1)),M("div",wM,[M("div",xM,[J[2]||(J[2]=M("span",{class:"perf-metric-label"},"Mesures",-1)),M("span",LM,Ht(G.value.totalMeasures),1)]),M("div",CM,[J[3]||(J[3]=M("span",{class:"perf-metric-label"},"Tâches longues",-1)),M("span",SM,Ht(G.value.totalLongTasks),1)]),M("div",PM,[J[4]||(J[4]=M("span",{class:"perf-metric-label"},"Durée moyenne",-1)),M("span",EM,Ht(nt(G.value.averageDuration))+"ms",1)]),M("div",AM,[J[5]||(J[5]=M("span",{class:"perf-metric-label"},"FPS",-1)),M("span",MM,Ht(G.value.fps),1)])])]),M("div",kM,[J[10]||(J[10]=M("h3",null,"Mémoire",-1)),M("div",TM,[((V=G.value.memoryUsage)==null?void 0:V.usedJSHeapSize)!==void 0?(Ye(),tt("div",BM,[J[7]||(J[7]=M("span",{class:"perf-metric-label"},"Utilisée",-1)),M("span",NM,Ht(Ie((U=G.value.memoryUsage)==null?void 0:U.usedJSHeapSize)),1)])):wn("",!0),((Y=G.value.memoryUsage)==null?void 0:Y.totalJSHeapSize)!==void 0?(Ye(),tt("div",RM,[J[8]||(J[8]=M("span",{class:"perf-metric-label"},"Totale",-1)),M("span",DM,Ht(Ie((ce=G.value.memoryUsage)==null?void 0:ce.totalJSHeapSize)),1)])):wn("",!0),((re=G.value.memoryUsage)==null?void 0:re.jsHeapSizeLimit)!==void 0?(Ye(),tt("div",OM,[J[9]||(J[9]=M("span",{class:"perf-metric-label"},"Limite",-1)),M("span",IM,Ht(Ie((Pe=G.value.memoryUsage)==null?void 0:Pe.jsHeapSizeLimit)),1)])):wn("",!0)])]),M("div",FM,[J[13]||(J[13]=M("h3",null,"Opérations les plus lentes",-1)),M("div",zM,[J[12]||(J[12]=wc('<div class="perf-table-header" data-v-fefe39b0><div class="perf-table-cell" data-v-fefe39b0>Opération</div><div class="perf-table-cell" data-v-fefe39b0>Composant</div><div class="perf-table-cell" data-v-fefe39b0>Durée</div><div class="perf-table-cell" data-v-fefe39b0>Actions</div></div>',1)),(Ye(!0),tt(zn,null,Ti(me.value,Me=>(Ye(),tt("div",{class:"perf-table-row",key:Me.timestamp},[M("div",jM,Ht(Me.operation),1),M("div",UM,Ht(Me.component),1),M("div",$M,Ht(nt(Me.durationMs))+"ms",1),M("div",qM,[M("button",{onClick:ot=>z(Me),class:"perf-action-button",title:"Copier les détails"},J[11]||(J[11]=[M("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)]),8,VM)])]))),128)),me.value.length===0?(Ye(),tt("div",GM," Aucune opération enregistrée ")):wn("",!0)])]),M("div",{class:"perf-actions"},[M("button",{onClick:W,class:"perf-button"}," Réinitialiser "),M("button",{onClick:O,class:"perf-button"}," Télécharger "),M("button",{onClick:ue,class:"perf-button"}," Copier ")])])):wn("",!0)],2)):wn("",!0)}}}),bm=(e,n)=>{const t=e.__vccOpts||e;for(const[i,r]of n)t[i]=r;return t},WM=bm(HM,[["__scopeId","data-v-fefe39b0"]]),ZM={class:"h-screen flex flex-col"},KM={key:0,class:"bg-white shadow-sm z-[2000] flex-shrink-0"},JM={class:"mx-auto px-4 sm:px-6 lg:px-8"},YM={class:"flex h-16 items-center justify-between"},XM={class:"flex items-center"},QM={class:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},e6={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"},t6={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},n6={class:"hidden md:flex md:ml-6 space-x-8"},i6={key:0,class:"hidden md:block flex-1 mx-8"},r6={key:1,class:"flex-1"},s6={class:"flex items-center space-x-2 md:space-x-4"},o6={key:0,class:"hidden md:flex items-center justify-center p-2 text-amber-500 hover:text-amber-600 rounded-full hover:bg-amber-50 focus:outline-none focus:ring-2 focus:ring-amber-400",title:"Performance activée"},a6={class:"relative"},l6={key:0,class:"absolute right-0 mt-2 w-80 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-[3000]"},u6={class:"px-4 py-2 border-b border-gray-100 flex justify-between items-center"},c6={class:"max-h-72 overflow-y-auto"},h6={key:0,class:"px-4 py-3 text-sm text-gray-500 text-center"},f6={class:"flex items-start"},d6={class:"flex-shrink-0 mr-3"},p6={key:0,class:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor"},g6={key:1,class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},m6={key:2,class:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},v6={key:3,class:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor"},y6={class:"flex-1"},_6={class:"text-sm text-gray-800"},b6=["onClick"],w6={class:"relative"},x6={class:"hidden md:flex flex-col items-end"},L6={class:"text-sm font-medium text-gray-700"},C6={key:0,class:"text-xs text-gray-500"},S6=["src","alt"],P6={key:0,class:"absolute right-0 mt-2 w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-[3000]"},E6={class:"md:hidden px-4 py-2 border-b border-gray-100"},A6={class:"text-sm font-medium text-gray-700"},M6={class:"text-xs text-gray-500"},k6={key:0,class:"md:hidden bg-white border-t border-gray-200"},T6={class:"space-y-1 px-2 pb-3 pt-2"},B6={key:0,class:"px-4 py-3 border-t border-gray-200"},N6=Pa({__name:"App",setup(e){const n=qp(),t=Va(),i=Rf(),{isQueryParamEnabled:r}=Xh(),o=un(!1),l=un(!1),h=un(!1),g=un(!1),v=un(null),_=un(!1),x=un(null),E=un("13px"),b=un("65px");Tl(()=>{window.addEventListener("resize",D)}),Ep(()=>{window.removeEventListener("resize",D)});function D(){if(!x.value)return;const z=x.value.getBoundingClientRect();E.value=`${z.top+window.scrollY+5}px`;const R=z.left+z.width/2;b.value=`${window.innerWidth-R-22}px`}const $=Ni(()=>{const z=t.user;if(!z)return"";const R=`${z.first_name} ${z.last_name.toUpperCase()}`;return z.company_name?`${R} (${z.company_name})`:R}),Q=Ni(()=>{var R;switch((R=t.user)==null?void 0:R.user_type){case"admin":return"Accès administrateur";case"entreprise":return"Accès entreprise";case"salarie":return"Accès salarié";case"visiteur":return"Accès visiteur";default:return""}}),F=Ni(()=>{var z;return((z=t.user)==null?void 0:z.user_type)==="admin"}),G=Ni(()=>t.isAuthenticated),me=[{name:"Carte",to:"/"},{name:"Notes",to:"/notes"}],Se=Ni(()=>{var R;if(!G.value)return[];const z=[...me];return(F.value||((R=t.user)==null?void 0:R.user_type)==="entreprise")&&z.push({name:"Utilisateurs",to:"/users"}),z}),Ie=Ni(()=>G.value?[{name:"Mon profil",to:"/profile"}]:[]);async function nt(){try{await t.logout(),n.push("/login")}catch(z){console.error("Erreur lors de la déconnexion:",z)}}function Ve(z){window.dispatchEvent(new CustomEvent("map-set-location",{detail:{lat:z.lat,lng:z.lng,zoom:16}}))}Tl(async()=>{console.log("App mounted, checking auth...");try{if(localStorage.getItem("token")){console.log("Token found, checking auth..."),await t.checkAuth(),await t.fetchUserProfile();const R=localStorage.getItem("lastPlanId");R&&window.dispatchEvent(new CustomEvent("load-last-plan",{detail:{planId:R}}))}else console.log("No token found")}catch(z){console.error("Auth check error:",z),n.push("/login")}});const O=Ni(()=>{const z="TagMap";if(!G.value)return`${z} - Connexion`;const R=n.currentRoute.value,V={home:"Carte",notes:"Notes",users:"Utilisateurs",profile:"Mon profil",changePassword:"Changement de mot de passe",map:"Carte"}[R.name]||"";return V?`${z} - ${V}`:z});So(O,z=>{document.title=z},{immediate:!0});const W=Ni(()=>i.notifications.length);function ue(){i.clearAll(),h.value=!1}return cg(()=>{if(i.lastAddedId!==null){const z=i.notifications.find(R=>R.id===i.lastAddedId);z&&Ds(()=>{D(),g.value=!0,v.value={id:z.id,message:z.message,type:z.type},requestAnimationFrame(()=>{setTimeout(()=>{_.value=!0,setTimeout(()=>{_.value=!1,setTimeout(()=>{var R;((R=v.value)==null?void 0:R.id)===z.id&&(v.value=null,g.value=!1)},300)},4e3)},50)})})}}),(z,R)=>{var J;return Ye(),tt("div",ZM,[G.value?(Ye(),tt("header",KM,[M("nav",JM,[M("div",YM,[M("div",XM,[M("button",{onClick:R[0]||(R[0]=V=>l.value=!l.value),class:"inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500 md:hidden"},[R[5]||(R[5]=M("span",{class:"sr-only"},"Ouvrir le menu",-1)),(Ye(),tt("svg",QM,[l.value?(Ye(),tt("path",t6)):(Ye(),tt("path",e6))]))]),Yr(Wn(bf),{to:"/",class:"text-xl font-semibold text-primary-600 truncate ml-2 md:ml-0"},{default:vc(()=>R[6]||(R[6]=[M("span",{class:"md:inline hidden"},"TagMap",-1),M("span",{class:"md:hidden inline"},"TM",-1)])),_:1}),M("div",n6,[(Ye(!0),tt(zn,null,Ti(Se.value,V=>(Ye(),Su(Wn(bf),{key:V.name,to:V.to,class:Jr(["text-sm font-medium transition-colors duration-200",[z.$route.path===V.to?"text-primary-600 border-b-2 border-primary-500":"text-gray-500 hover:text-gray-900"]])},{default:vc(()=>[Br(Ht(V.name),1)]),_:2},1032,["to","class"]))),128))])]),z.$route.path==="/"?(Ye(),tt("div",i6,[Yr(uy,{onSelectLocation:Ve})])):(Ye(),tt("div",r6)),M("div",s6,[Wn(r)?(Ye(),tt("button",o6,R[7]||(R[7]=[M("span",{class:"sr-only"},"Performance",-1),M("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)]))):wn("",!0),M("div",a6,[M("button",{ref_key:"bellButtonRef",ref:x,onClick:R[1]||(R[1]=V=>h.value=!h.value),class:Jr(["relative flex items-center justify-center p-2 text-gray-400 hover:text-gray-500 rounded-full hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",{"animate-bell":g.value}])},R[8]||(R[8]=[M("span",{class:"sr-only"},"Voir les notifications",-1),M("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})],-1)]),2),h.value?(Ye(),tt("div",l6,[M("div",u6,[R[9]||(R[9]=M("h3",{class:"text-sm font-semibold text-gray-700"},"Notifications",-1)),W.value>0?(Ye(),tt("button",{key:0,onClick:ue,class:"text-xs text-primary-600 hover:text-primary-800"}," Tout effacer ")):wn("",!0)]),M("div",c6,[W.value===0?(Ye(),tt("div",h6," Aucune notification ")):wn("",!0),(Ye(!0),tt(zn,null,Ti(Wn(i).notifications,V=>(Ye(),tt("div",{key:V.id,class:"px-4 py-3 border-b border-gray-100 last:border-0 hover:bg-gray-50"},[M("div",f6,[M("div",d6,[V.type==="success"?(Ye(),tt("svg",p6,R[10]||(R[10]=[M("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):V.type==="error"?(Ye(),tt("svg",g6,R[11]||(R[11]=[M("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"},null,-1)]))):V.type==="warning"?(Ye(),tt("svg",m6,R[12]||(R[12]=[M("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)]))):(Ye(),tt("svg",v6,R[13]||(R[13]=[M("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"},null,-1)])))]),M("div",y6,[M("p",_6,Ht(V.message),1),M("button",{onClick:U=>Wn(i).removeNotification(V.id),class:"text-xs text-primary-600 hover:text-primary-800 mt-1"}," Fermer ",8,b6)])])]))),128))])])):wn("",!0)]),M("div",w6,[M("button",{onClick:R[2]||(R[2]=V=>o.value=!o.value),class:"flex items-center space-x-2 md:space-x-3 focus:outline-none"},[M("div",x6,[M("span",L6,Ht($.value),1),Q.value?(Ye(),tt("span",C6,Ht(Q.value),1)):wn("",!0)]),M("img",{class:"h-8 w-8 rounded-full ring-2 ring-white",src:((J=Wn(t).user)==null?void 0:J.logo)||"https://ui-avatars.com/api/?name="+encodeURIComponent($.value),alt:$.value},null,8,S6)]),o.value?(Ye(),tt("div",P6,[M("div",E6,[M("div",A6,Ht($.value),1),M("div",M6,Ht(Q.value),1)]),(Ye(!0),tt(zn,null,Ti(Ie.value,V=>(Ye(),Su(Wn(bf),{key:V.name,to:V.to,class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",onClick:R[3]||(R[3]=U=>o.value=!1)},{default:vc(()=>[Br(Ht(V.name),1)]),_:2},1032,["to"]))),128)),M("button",{onClick:nt,class:"block w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-gray-50"}," Déconnexion ")])):wn("",!0)])])]),l.value?(Ye(),tt("div",k6,[M("div",T6,[(Ye(!0),tt(zn,null,Ti(Se.value,V=>(Ye(),Su(Wn(bf),{key:V.name,to:V.to,class:Jr(["block px-3 py-2 rounded-md text-base font-medium",[z.$route.path===V.to?"bg-primary-50 text-primary-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"]]),onClick:R[4]||(R[4]=U=>l.value=!1)},{default:vc(()=>[Br(Ht(V.name),1)]),_:2},1032,["to","class"]))),128))]),z.$route.path==="/"?(Ye(),tt("div",B6,[Yr(uy,{onSelectLocation:Ve})])):wn("",!0)])):wn("",!0)])])):wn("",!0),M("main",{class:Jr([z.$route.path==="/"?"overflow-hidden":"overflow-auto","flex-1 flex flex-col h-[calc(100vh-64px)]"])},[Yr(Wn(r4))],2),Yr(WM,{position:"bottom-left"})])}}}),R6="modulepreload",D6=function(e){return"/static/frontend/"+e},cy={},Qc=function(n,t,i){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),h=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));r=Promise.allSettled(t.map(g=>{if(g=D6(g),g in cy)return;cy[g]=!0;const v=g.endsWith(".css"),_=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${_}`))return;const x=document.createElement("link");if(x.rel=v?"stylesheet":R6,v||(x.as="script"),x.crossOrigin="",x.href=g,h&&x.setAttribute("nonce",h),document.head.appendChild(x),v)return new Promise((E,b)=>{x.addEventListener("load",E),x.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${g}`)))})}))}function o(l){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=l,window.dispatchEvent(h),!h.defaultPrevented)throw l}return r.then(l=>{for(const h of l||[])h.status==="rejected"&&o(h.reason);return n().catch(o)})},O6={class:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8"},I6={class:"max-w-md w-full space-y-8"},F6={class:"space-y-4"},z6={class:"mt-1"},j6={class:"mt-1"},U6={class:"mt-1"},$6={key:0,class:"rounded-md bg-red-50 p-4"},q6={class:"flex"},V6={class:"ml-3"},G6={class:"text-sm font-medium text-red-800"},H6={key:1,class:"rounded-md bg-yellow-50 p-4"},W6={class:"flex"},Z6={class:"ml-3"},K6={class:"mt-2 text-sm text-yellow-700"},J6={class:"list-disc pl-5 space-y-1"},Y6=["disabled"],X6={class:"absolute left-0 inset-y-0 flex items-center pl-3"},Q6={key:0,class:"h-5 w-5 text-primary-500 group-hover:text-primary-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},ek={key:1,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},tk=Pa({__name:"ChangePasswordForm",setup(e){const n=qp(),t=Va(),i=Au({oldPassword:"",newPassword:"",confirmPassword:""}),r=un(!1),o=un("");Tl(()=>{var v,_;console.log("ChangePasswordForm mounted, auth state:",{isAuthenticated:t.isAuthenticated,userId:(v=t.user)==null?void 0:v.id,mustChangePassword:(_=t.user)==null?void 0:_.must_change_password})});const l=Ni(()=>{const v=[];return i.newPassword&&i.newPassword.length<8&&v.push("Le nouveau mot de passe doit contenir au moins 8 caractères"),i.newPassword&&i.confirmPassword&&i.newPassword!==i.confirmPassword&&v.push("Les mots de passe ne correspondent pas"),v}),h=Ni(()=>i.oldPassword.length>0&&i.newPassword.length>=8&&i.newPassword===i.confirmPassword);async function g(){var v,_,x,E,b,D,$,Q;if(!h.value){o.value="Veuillez corriger les erreurs avant de continuer";return}if(!((v=t.user)!=null&&v.id)){o.value="Erreur : utilisateur non identifié";return}r.value=!0,o.value="";try{console.log("Submitting password change..."),await t.changePassword(i.oldPassword,i.newPassword),console.log("Password changed successfully"),n.push("/")}catch(F){console.error("Password change failed:",F),(x=(_=F.response)==null?void 0:_.data)!=null&&x.detail?o.value=F.response.data.detail:(b=(E=F.response)==null?void 0:E.data)!=null&&b.old_password?o.value=F.response.data.old_password[0]:($=(D=F.response)==null?void 0:D.data)!=null&&$.password?o.value=F.response.data.password[0]:((Q=F.response)==null?void 0:Q.status)===401?(o.value="Session expirée, veuillez vous reconnecter",await t.logout(),n.push("/login")):o.value="Une erreur est survenue lors du changement de mot de passe"}finally{r.value=!1}}return(v,_)=>(Ye(),tt("div",O6,[M("div",I6,[_[12]||(_[12]=M("div",null,[M("h2",{class:"mt-6 text-center text-3xl font-extrabold text-gray-900"}," Changement de mot de passe "),M("p",{class:"mt-2 text-center text-sm text-gray-600"}," Pour des raisons de sécurité, vous devez changer votre mot de passe. ")],-1)),M("form",{class:"mt-8 space-y-6",onSubmit:Tp(g,["prevent"])},[M("div",F6,[M("div",null,[_[3]||(_[3]=M("label",{for:"old-password",class:"block text-sm font-medium text-gray-700"},"Ancien mot de passe",-1)),M("div",z6,[Dn(M("input",{id:"old-password","onUpdate:modelValue":_[0]||(_[0]=x=>i.oldPassword=x),name:"old-password",type:"password",required:"",autocomplete:"current-password",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Entrez votre mot de passe actuel"},null,512),[[ki,i.oldPassword]])])]),M("div",null,[_[4]||(_[4]=M("label",{for:"new-password",class:"block text-sm font-medium text-gray-700"},"Nouveau mot de passe",-1)),M("div",j6,[Dn(M("input",{id:"new-password","onUpdate:modelValue":_[1]||(_[1]=x=>i.newPassword=x),name:"new-password",type:"password",required:"",autocomplete:"new-password",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Entrez votre nouveau mot de passe"},null,512),[[ki,i.newPassword]])]),_[5]||(_[5]=M("p",{class:"mt-1 text-sm text-gray-500"}," Le mot de passe doit contenir au moins 8 caractères ",-1))]),M("div",null,[_[6]||(_[6]=M("label",{for:"confirm-password",class:"block text-sm font-medium text-gray-700"},"Confirmer le mot de passe",-1)),M("div",U6,[Dn(M("input",{id:"confirm-password","onUpdate:modelValue":_[2]||(_[2]=x=>i.confirmPassword=x),name:"confirm-password",type:"password",required:"",autocomplete:"new-password",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Confirmez votre nouveau mot de passe"},null,512),[[ki,i.confirmPassword]])])])]),o.value?(Ye(),tt("div",$6,[M("div",q6,[_[7]||(_[7]=M("div",{class:"flex-shrink-0"},[M("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),M("div",V6,[M("h3",G6,Ht(o.value),1)])])])):wn("",!0),l.value.length>0?(Ye(),tt("div",H6,[M("div",W6,[_[9]||(_[9]=M("div",{class:"flex-shrink-0"},[M("svg",{class:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])],-1)),M("div",Z6,[_[8]||(_[8]=M("h3",{class:"text-sm font-medium text-yellow-800"},"Attention",-1)),M("div",K6,[M("ul",J6,[(Ye(!0),tt(zn,null,Ti(l.value,(x,E)=>(Ye(),tt("li",{key:E},Ht(x),1))),128))])])])])])):wn("",!0),M("div",null,[M("button",{type:"submit",disabled:r.value||!h.value,class:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50"},[M("span",X6,[r.value?(Ye(),tt("svg",ek,_[11]||(_[11]=[M("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),M("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(Ye(),tt("svg",Q6,_[10]||(_[10]=[M("path",{"fill-rule":"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule":"evenodd"},null,-1)])))]),Br(" "+Ht(r.value?"Modification en cours...":"Changer le mot de passe"),1)],8,Y6)])],32)])]))}}),Eg="/static/frontend/assets/logo.svg",nk={class:"min-h-screen bg-white from-blue-50 to-white flex flex-col justify-center py-12 sm:px-6 lg:px-8"},ik={class:"mt-8 sm:mx-auto sm:w-full sm:max-w-md"},rk={class:"bg-white py-8 px-6 shadow-lg rounded-md sm:px-10"},sk={key:0,class:"rounded-md bg-red-50 p-4"},ok={class:"flex"},ak={class:"ml-3"},lk={class:"text-sm font-medium text-red-800"},uk={class:"mt-1"},ck={class:"mt-1 relative"},hk=["type"],fk={key:0,class:"h-5 w-5 text-gray-400 hover:text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},dk={key:1,class:"h-5 w-5 text-gray-400 hover:text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},pk={class:"flex items-center justify-between"},gk={class:"flex items-center"},mk={class:"text-sm"},vk=["disabled"],yk={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},_k=Pa({__name:"LoginView",setup(e){const n=qp(),t=Va(),i=un(!1),r=un(null),o=un(!1),l=Au({username:"",password:"",rememberMe:!1});Tl(()=>{var g;console.log("LoginView mounted"),console.log("INITIAL_STATE:",window.INITIAL_STATE),(g=window.INITIAL_STATE)!=null&&g.isAuthenticated&&(console.log("User is authenticated, redirecting to home"),n.push("/"))});async function h(){var g,v,_,x,E,b,D,$,Q;i.value=!0,r.value=null;try{if(!l.username||!l.password){r.value="Veuillez remplir tous les champs";return}await t.login(l.username,l.password),(g=t.user)!=null&&g.must_change_password?n.push("/change-password"):n.push("/")}catch(F){console.error("Login error:",F),((v=F==null?void 0:F.response)==null?void 0:v.status)===500?r.value="Le service est temporairement indisponible. Veuillez réessayer dans quelques instants.":((_=F==null?void 0:F.response)==null?void 0:_.status)===401||((x=F==null?void 0:F.response)==null?void 0:x.status)===403?r.value="Identifiants incorrects. Veuillez vérifier votre nom d'utilisateur et mot de passe.":(b=(E=F==null?void 0:F.response)==null?void 0:E.data)!=null&&b.detail?r.value=F.response.data.detail:(Q=($=(D=F==null?void 0:F.response)==null?void 0:D.data)==null?void 0:$.non_field_errors)!=null&&Q[0]?r.value=F.response.data.non_field_errors[0]:(F==null?void 0:F.message)==="Network Error"?r.value="Impossible de se connecter au serveur. Veuillez vérifier votre connexion internet.":r.value="Une erreur est survenue lors de la connexion. Veuillez réessayer."}finally{i.value=!1}}return(g,v)=>{const _=VL("router-link");return Ye(),tt("div",nk,[v[12]||(v[12]=M("div",{class:"sm:mx-auto sm:w-full sm:max-w-md"},[M("img",{src:Eg,alt:"TagMap Logo",class:"mx-auto h-40 w-auto transition-transform duration-300 hover:scale-110"}),M("h2",{class:"mt-2 text-center text-3xl font-bold text-gray-800"}," TagMap "),M("p",{class:"mt-2 text-center text-sm text-gray-600"}," Connectez-vous pour accéder à votre espace ")],-1)),M("div",ik,[M("div",rk,[M("form",{class:"space-y-6",onSubmit:Tp(h,["prevent"])},[r.value?(Ye(),tt("div",sk,[M("div",ok,[v[4]||(v[4]=M("div",{class:"flex-shrink-0"},[M("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),M("div",ak,[M("h3",lk,Ht(r.value),1)])])])):wn("",!0),M("div",null,[v[5]||(v[5]=M("label",{for:"username",class:"block text-sm font-medium text-gray-700"}," Nom d'utilisateur ",-1)),M("div",uk,[Dn(M("input",{id:"username","onUpdate:modelValue":v[0]||(v[0]=x=>l.username=x),name:"username",type:"text",required:"",autocomplete:"username",class:"appearance-none block w-full h-11 px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 sm:text-sm","aria-label":"Nom d'utilisateur"},null,512),[[ki,l.username]])])]),M("div",null,[v[8]||(v[8]=M("label",{for:"password",class:"block text-sm font-medium text-gray-700"}," Mot de passe ",-1)),M("div",ck,[Dn(M("input",{id:"password","onUpdate:modelValue":v[1]||(v[1]=x=>l.password=x),type:o.value?"text":"password",name:"password",required:"",autocomplete:"current-password",class:"appearance-none block w-full h-11 px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 sm:text-sm pr-10","aria-label":"Mot de passe"},null,8,hk),[[lS,l.password]]),M("button",{type:"button",onClick:v[2]||(v[2]=x=>o.value=!o.value),class:"absolute inset-y-0 right-0 pr-3 flex items-center","aria-label":"Afficher/masquer le mot de passe"},[o.value?(Ye(),tt("svg",fk,v[6]||(v[6]=[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)]))):(Ye(),tt("svg",dk,v[7]||(v[7]=[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])))])])]),M("div",pk,[M("div",gk,[Dn(M("input",{id:"remember-me","onUpdate:modelValue":v[3]||(v[3]=x=>l.rememberMe=x),name:"remember-me",type:"checkbox",class:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded","aria-label":"Se souvenir de moi"},null,512),[[u2,l.rememberMe]]),v[9]||(v[9]=M("label",{for:"remember-me",class:"ml-2 block text-sm text-gray-900"}," Se souvenir de moi ",-1))]),M("div",mk,[Yr(_,{to:"/forgot-password",class:"font-medium text-primary-600 hover:text-primary-500 transition-colors duration-200"},{default:vc(()=>v[10]||(v[10]=[Br(" Mot de passe oublié ? ")])),_:1})])]),M("div",null,[M("button",{type:"submit",disabled:i.value,class:"w-full h-11 flex justify-center items-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Se connecter"},[i.value?(Ye(),tt("svg",yk,v[11]||(v[11]=[M("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),M("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):wn("",!0),Br(" "+Ht(i.value?"Connexion en cours...":"Se connecter"),1)],8,vk)])],32)])])])}}});var Ag={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,n){(function(t,i){i(n)})(qo,function(t){var i="1.9.4";function r(s){var f,w,T,Z;for(w=1,T=arguments.length;w<T;w++){Z=arguments[w];for(f in Z)s[f]=Z[f]}return s}var o=Object.create||function(){function s(){}return function(f){return s.prototype=f,new s}}();function l(s,f){var w=Array.prototype.slice;if(s.bind)return s.bind.apply(s,w.call(arguments,1));var T=w.call(arguments,2);return function(){return s.apply(f,T.length?T.concat(w.call(arguments)):arguments)}}var h=0;function g(s){return"_leaflet_id"in s||(s._leaflet_id=++h),s._leaflet_id}function v(s,f,w){var T,Z,_e,at;return at=function(){T=!1,Z&&(_e.apply(w,Z),Z=!1)},_e=function(){T?Z=arguments:(s.apply(w,arguments),setTimeout(at,f),T=!0)},_e}function _(s,f,w){var T=f[1],Z=f[0],_e=T-Z;return s===T&&w?s:((s-Z)%_e+_e)%_e+Z}function x(){return!1}function E(s,f){if(f===!1)return s;var w=Math.pow(10,f===void 0?6:f);return Math.round(s*w)/w}function b(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function D(s){return b(s).split(/\s+/)}function $(s,f){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?o(s.options):{});for(var w in f)s.options[w]=f[w];return s.options}function Q(s,f,w){var T=[];for(var Z in s)T.push(encodeURIComponent(w?Z.toUpperCase():Z)+"="+encodeURIComponent(s[Z]));return(!f||f.indexOf("?")===-1?"?":"&")+T.join("&")}var F=/\{ *([\w_ -]+) *\}/g;function G(s,f){return s.replace(F,function(w,T){var Z=f[T];if(Z===void 0)throw new Error("No value provided for variable "+w);return typeof Z=="function"&&(Z=Z(f)),Z})}var me=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function Se(s,f){for(var w=0;w<s.length;w++)if(s[w]===f)return w;return-1}var Ie="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function nt(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var Ve=0;function O(s){var f=+new Date,w=Math.max(0,16-(f-Ve));return Ve=f+w,window.setTimeout(s,w)}var W=window.requestAnimationFrame||nt("RequestAnimationFrame")||O,ue=window.cancelAnimationFrame||nt("CancelAnimationFrame")||nt("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function z(s,f,w){if(w&&W===O)s.call(f);else return W.call(window,l(s,f))}function R(s){s&&ue.call(window,s)}var J={__proto__:null,extend:r,create:o,bind:l,get lastId(){return h},stamp:g,throttle:v,wrapNum:_,falseFn:x,formatNum:E,trim:b,splitWords:D,setOptions:$,getParamString:Q,template:G,isArray:me,indexOf:Se,emptyImageUrl:Ie,requestFn:W,cancelFn:ue,requestAnimFrame:z,cancelAnimFrame:R};function V(){}V.extend=function(s){var f=function(){$(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},w=f.__super__=this.prototype,T=o(w);T.constructor=f,f.prototype=T;for(var Z in this)Object.prototype.hasOwnProperty.call(this,Z)&&Z!=="prototype"&&Z!=="__super__"&&(f[Z]=this[Z]);return s.statics&&r(f,s.statics),s.includes&&(U(s.includes),r.apply(null,[T].concat(s.includes))),r(T,s),delete T.statics,delete T.includes,T.options&&(T.options=w.options?o(w.options):{},r(T.options,s.options)),T._initHooks=[],T.callInitHooks=function(){if(!this._initHooksCalled){w.callInitHooks&&w.callInitHooks.call(this),this._initHooksCalled=!0;for(var _e=0,at=T._initHooks.length;_e<at;_e++)T._initHooks[_e].call(this)}},f},V.include=function(s){var f=this.prototype.options;return r(this.prototype,s),s.options&&(this.prototype.options=f,this.mergeOptions(s.options)),this},V.mergeOptions=function(s){return r(this.prototype.options,s),this},V.addInitHook=function(s){var f=Array.prototype.slice.call(arguments,1),w=typeof s=="function"?s:function(){this[s].apply(this,f)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(w),this};function U(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=me(s)?s:[s];for(var f=0;f<s.length;f++)s[f]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Y={on:function(s,f,w){if(typeof s=="object")for(var T in s)this._on(T,s[T],f);else{s=D(s);for(var Z=0,_e=s.length;Z<_e;Z++)this._on(s[Z],f,w)}return this},off:function(s,f,w){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var T in s)this._off(T,s[T],f);else{s=D(s);for(var Z=arguments.length===1,_e=0,at=s.length;_e<at;_e++)Z?this._off(s[_e]):this._off(s[_e],f,w)}return this},_on:function(s,f,w,T){if(typeof f!="function"){console.warn("wrong listener type: "+typeof f);return}if(this._listens(s,f,w)===!1){w===this&&(w=void 0);var Z={fn:f,ctx:w};T&&(Z.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(Z)}},_off:function(s,f,w){var T,Z,_e;if(this._events&&(T=this._events[s],!!T)){if(arguments.length===1){if(this._firingCount)for(Z=0,_e=T.length;Z<_e;Z++)T[Z].fn=x;delete this._events[s];return}if(typeof f!="function"){console.warn("wrong listener type: "+typeof f);return}var at=this._listens(s,f,w);if(at!==!1){var Tt=T[at];this._firingCount&&(Tt.fn=x,this._events[s]=T=T.slice()),T.splice(at,1)}}},fire:function(s,f,w){if(!this.listens(s,w))return this;var T=r({},f,{type:s,target:this,sourceTarget:f&&f.sourceTarget||this});if(this._events){var Z=this._events[s];if(Z){this._firingCount=this._firingCount+1||1;for(var _e=0,at=Z.length;_e<at;_e++){var Tt=Z[_e],zt=Tt.fn;Tt.once&&this.off(s,zt,Tt.ctx),zt.call(Tt.ctx||this,T)}this._firingCount--}}return w&&this._propagateEvent(T),this},listens:function(s,f,w,T){typeof s!="string"&&console.warn('"string" type argument expected');var Z=f;typeof f!="function"&&(T=!!f,Z=void 0,w=void 0);var _e=this._events&&this._events[s];if(_e&&_e.length&&this._listens(s,Z,w)!==!1)return!0;if(T){for(var at in this._eventParents)if(this._eventParents[at].listens(s,f,w,T))return!0}return!1},_listens:function(s,f,w){if(!this._events)return!1;var T=this._events[s]||[];if(!f)return!!T.length;w===this&&(w=void 0);for(var Z=0,_e=T.length;Z<_e;Z++)if(T[Z].fn===f&&T[Z].ctx===w)return Z;return!1},once:function(s,f,w){if(typeof s=="object")for(var T in s)this._on(T,s[T],f,!0);else{s=D(s);for(var Z=0,_e=s.length;Z<_e;Z++)this._on(s[Z],f,w,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[g(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[g(s)],this},_propagateEvent:function(s){for(var f in this._eventParents)this._eventParents[f].fire(s.type,r({layer:s.target,propagatedFrom:s.target},s),!0)}};Y.addEventListener=Y.on,Y.removeEventListener=Y.clearAllEventListeners=Y.off,Y.addOneTimeEventListener=Y.once,Y.fireEvent=Y.fire,Y.hasEventListeners=Y.listens;var ce=V.extend(Y);function re(s,f,w){this.x=w?Math.round(s):s,this.y=w?Math.round(f):f}var Pe=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};re.prototype={clone:function(){return new re(this.x,this.y)},add:function(s){return this.clone()._add(Me(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(Me(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new re(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new re(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Pe(this.x),this.y=Pe(this.y),this},distanceTo:function(s){s=Me(s);var f=s.x-this.x,w=s.y-this.y;return Math.sqrt(f*f+w*w)},equals:function(s){return s=Me(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=Me(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+E(this.x)+", "+E(this.y)+")"}};function Me(s,f,w){return s instanceof re?s:me(s)?new re(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new re(s.x,s.y):new re(s,f,w)}function ot(s,f){if(s)for(var w=f?[s,f]:s,T=0,Z=w.length;T<Z;T++)this.extend(w[T])}ot.prototype={extend:function(s){var f,w;if(!s)return this;if(s instanceof re||typeof s[0]=="number"||"x"in s)f=w=Me(s);else if(s=X(s),f=s.min,w=s.max,!f||!w)return this;return!this.min&&!this.max?(this.min=f.clone(),this.max=w.clone()):(this.min.x=Math.min(f.x,this.min.x),this.max.x=Math.max(w.x,this.max.x),this.min.y=Math.min(f.y,this.min.y),this.max.y=Math.max(w.y,this.max.y)),this},getCenter:function(s){return Me((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return Me(this.min.x,this.max.y)},getTopRight:function(){return Me(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var f,w;return typeof s[0]=="number"||s instanceof re?s=Me(s):s=X(s),s instanceof ot?(f=s.min,w=s.max):f=w=s,f.x>=this.min.x&&w.x<=this.max.x&&f.y>=this.min.y&&w.y<=this.max.y},intersects:function(s){s=X(s);var f=this.min,w=this.max,T=s.min,Z=s.max,_e=Z.x>=f.x&&T.x<=w.x,at=Z.y>=f.y&&T.y<=w.y;return _e&&at},overlaps:function(s){s=X(s);var f=this.min,w=this.max,T=s.min,Z=s.max,_e=Z.x>f.x&&T.x<w.x,at=Z.y>f.y&&T.y<w.y;return _e&&at},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var f=this.min,w=this.max,T=Math.abs(f.x-w.x)*s,Z=Math.abs(f.y-w.y)*s;return X(Me(f.x-T,f.y-Z),Me(w.x+T,w.y+Z))},equals:function(s){return s?(s=X(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function X(s,f){return!s||s instanceof ot?s:new ot(s,f)}function Ee(s,f){if(s)for(var w=f?[s,f]:s,T=0,Z=w.length;T<Z;T++)this.extend(w[T])}Ee.prototype={extend:function(s){var f=this._southWest,w=this._northEast,T,Z;if(s instanceof H)T=s,Z=s;else if(s instanceof Ee){if(T=s._southWest,Z=s._northEast,!T||!Z)return this}else return s?this.extend(he(s)||B(s)):this;return!f&&!w?(this._southWest=new H(T.lat,T.lng),this._northEast=new H(Z.lat,Z.lng)):(f.lat=Math.min(T.lat,f.lat),f.lng=Math.min(T.lng,f.lng),w.lat=Math.max(Z.lat,w.lat),w.lng=Math.max(Z.lng,w.lng)),this},pad:function(s){var f=this._southWest,w=this._northEast,T=Math.abs(f.lat-w.lat)*s,Z=Math.abs(f.lng-w.lng)*s;return new Ee(new H(f.lat-T,f.lng-Z),new H(w.lat+T,w.lng+Z))},getCenter:function(){return new H((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new H(this.getNorth(),this.getWest())},getSouthEast:function(){return new H(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof H||"lat"in s?s=he(s):s=B(s);var f=this._southWest,w=this._northEast,T,Z;return s instanceof Ee?(T=s.getSouthWest(),Z=s.getNorthEast()):T=Z=s,T.lat>=f.lat&&Z.lat<=w.lat&&T.lng>=f.lng&&Z.lng<=w.lng},intersects:function(s){s=B(s);var f=this._southWest,w=this._northEast,T=s.getSouthWest(),Z=s.getNorthEast(),_e=Z.lat>=f.lat&&T.lat<=w.lat,at=Z.lng>=f.lng&&T.lng<=w.lng;return _e&&at},overlaps:function(s){s=B(s);var f=this._southWest,w=this._northEast,T=s.getSouthWest(),Z=s.getNorthEast(),_e=Z.lat>f.lat&&T.lat<w.lat,at=Z.lng>f.lng&&T.lng<w.lng;return _e&&at},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,f){return s?(s=B(s),this._southWest.equals(s.getSouthWest(),f)&&this._northEast.equals(s.getNorthEast(),f)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function B(s,f){return s instanceof Ee?s:new Ee(s,f)}function H(s,f,w){if(isNaN(s)||isNaN(f))throw new Error("Invalid LatLng object: ("+s+", "+f+")");this.lat=+s,this.lng=+f,w!==void 0&&(this.alt=+w)}H.prototype={equals:function(s,f){if(!s)return!1;s=he(s);var w=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return w<=(f===void 0?1e-9:f)},toString:function(s){return"LatLng("+E(this.lat,s)+", "+E(this.lng,s)+")"},distanceTo:function(s){return ie.distance(this,he(s))},wrap:function(){return ie.wrapLatLng(this)},toBounds:function(s){var f=180*s/40075017,w=f/Math.cos(Math.PI/180*this.lat);return B([this.lat-f,this.lng-w],[this.lat+f,this.lng+w])},clone:function(){return new H(this.lat,this.lng,this.alt)}};function he(s,f,w){return s instanceof H?s:me(s)&&typeof s[0]!="object"?s.length===3?new H(s[0],s[1],s[2]):s.length===2?new H(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new H(s.lat,"lng"in s?s.lng:s.lon,s.alt):f===void 0?null:new H(s,f,w)}var te={latLngToPoint:function(s,f){var w=this.projection.project(s),T=this.scale(f);return this.transformation._transform(w,T)},pointToLatLng:function(s,f){var w=this.scale(f),T=this.transformation.untransform(s,w);return this.projection.unproject(T)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var f=this.projection.bounds,w=this.scale(s),T=this.transformation.transform(f.min,w),Z=this.transformation.transform(f.max,w);return new ot(T,Z)},infinite:!1,wrapLatLng:function(s){var f=this.wrapLng?_(s.lng,this.wrapLng,!0):s.lng,w=this.wrapLat?_(s.lat,this.wrapLat,!0):s.lat,T=s.alt;return new H(w,f,T)},wrapLatLngBounds:function(s){var f=s.getCenter(),w=this.wrapLatLng(f),T=f.lat-w.lat,Z=f.lng-w.lng;if(T===0&&Z===0)return s;var _e=s.getSouthWest(),at=s.getNorthEast(),Tt=new H(_e.lat-T,_e.lng-Z),zt=new H(at.lat-T,at.lng-Z);return new Ee(Tt,zt)}},ie=r({},te,{wrapLng:[-180,180],R:6371e3,distance:function(s,f){var w=Math.PI/180,T=s.lat*w,Z=f.lat*w,_e=Math.sin((f.lat-s.lat)*w/2),at=Math.sin((f.lng-s.lng)*w/2),Tt=_e*_e+Math.cos(T)*Math.cos(Z)*at*at,zt=2*Math.atan2(Math.sqrt(Tt),Math.sqrt(1-Tt));return this.R*zt}}),ee=6378137,se={R:ee,MAX_LATITUDE:85.0511287798,project:function(s){var f=Math.PI/180,w=this.MAX_LATITUDE,T=Math.max(Math.min(w,s.lat),-w),Z=Math.sin(T*f);return new re(this.R*s.lng*f,this.R*Math.log((1+Z)/(1-Z))/2)},unproject:function(s){var f=180/Math.PI;return new H((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*f,s.x*f/this.R)},bounds:function(){var s=ee*Math.PI;return new ot([-s,-s],[s,s])}()};function Ce(s,f,w,T){if(me(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=f,this._c=w,this._d=T}Ce.prototype={transform:function(s,f){return this._transform(s.clone(),f)},_transform:function(s,f){return f=f||1,s.x=f*(this._a*s.x+this._b),s.y=f*(this._c*s.y+this._d),s},untransform:function(s,f){return f=f||1,new re((s.x/f-this._b)/this._a,(s.y/f-this._d)/this._c)}};function ne(s,f,w,T){return new Ce(s,f,w,T)}var ae=r({},ie,{code:"EPSG:3857",projection:se,transformation:function(){var s=.5/(Math.PI*se.R);return ne(s,.5,-s,.5)}()}),xe=r({},ae,{code:"EPSG:900913"});function ye(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function le(s,f){var w="",T,Z,_e,at,Tt,zt;for(T=0,_e=s.length;T<_e;T++){for(Tt=s[T],Z=0,at=Tt.length;Z<at;Z++)zt=Tt[Z],w+=(Z?"L":"M")+zt.x+" "+zt.y;w+=f?yn.svg?"z":"x":""}return w||"M0 0"}var je=document.documentElement.style,Re="ActiveXObject"in window,Ae=Re&&!document.addEventListener,qe="msLaunchUri"in navigator&&!("documentMode"in document),Oe=Zt("webkit"),et=Zt("android"),Je=Zt("android 2")||Zt("android 3"),mt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),_t=et&&Zt("Google")&&mt<537&&!("AudioNode"in window),$t=!!window.opera,Xt=!qe&&Zt("chrome"),Xe=Zt("gecko")&&!Oe&&!$t&&!Re,Kt=!Xt&&Zt("safari"),Qt=Zt("phantom"),Qe="OTransition"in je,We=navigator.platform.indexOf("Win")===0,Ut=Re&&"transition"in je,pn="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Je,_n="MozPerspective"in je,mn=!window.L_DISABLE_3D&&(Ut||pn||_n)&&!Qe&&!Qt,rt=typeof orientation<"u"||Zt("mobile"),vn=rt&&Oe,ni=rt&&pn,fn=!window.PointerEvent&&window.MSPointerEvent,Mn=!!(window.PointerEvent||fn),Sr="ontouchstart"in window||!!window.TouchEvent,Ii=!window.L_NO_TOUCH&&(Sr||Mn),Mt=rt&&$t,On=rt&&Xe,Fi=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,zi=function(){var s=!1;try{var f=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",x,f),window.removeEventListener("testPassiveEventSupport",x,f)}catch{}return s}(),Xr=function(){return!!document.createElement("canvas").getContext}(),$r=!!(document.createElementNS&&ye("svg").createSVGRect),Nn=!!$r&&function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),pi=!$r&&function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var f=s.firstChild;return f.style.behavior="url(#default#VML)",f&&typeof f.adj=="object"}catch{return!1}}(),hr=navigator.platform.indexOf("Mac")===0,bi=navigator.platform.indexOf("Linux")===0;function Zt(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var yn={ie:Re,ielt9:Ae,edge:qe,webkit:Oe,android:et,android23:Je,androidStock:_t,opera:$t,chrome:Xt,gecko:Xe,safari:Kt,phantom:Qt,opera12:Qe,win:We,ie3d:Ut,webkit3d:pn,gecko3d:_n,any3d:mn,mobile:rt,mobileWebkit:vn,mobileWebkit3d:ni,msPointer:fn,pointer:Mn,touch:Ii,touchNative:Sr,mobileOpera:Mt,mobileGecko:On,retina:Fi,passiveEvents:zi,canvas:Xr,svg:$r,vml:pi,inlineSvg:Nn,mac:hr,linux:bi},er=yn.msPointer?"MSPointerDown":"pointerdown",kr=yn.msPointer?"MSPointerMove":"pointermove",tr=yn.msPointer?"MSPointerUp":"pointerup",qr=yn.msPointer?"MSPointerCancel":"pointercancel",Vr={touchstart:er,touchmove:kr,touchend:tr,touchcancel:qr},Qn={touchstart:es,touchmove:dr,touchend:dr,touchcancel:dr},fr={},fs=!1;function Qr(s,f,w){return f==="touchstart"&&Vi(),Qn[f]?(w=Qn[f].bind(this,w),s.addEventListener(Vr[f],w,!1),w):(console.warn("wrong event specified:",f),x)}function Ci(s,f,w){if(!Vr[f]){console.warn("wrong event specified:",f);return}s.removeEventListener(Vr[f],w,!1)}function An(s){fr[s.pointerId]=s}function Pr(s){fr[s.pointerId]&&(fr[s.pointerId]=s)}function Ui(s){delete fr[s.pointerId]}function Vi(){fs||(document.addEventListener(er,An,!0),document.addEventListener(kr,Pr,!0),document.addEventListener(tr,Ui,!0),document.addEventListener(qr,Ui,!0),fs=!0)}function dr(s,f){if(f.pointerType!==(f.MSPOINTER_TYPE_MOUSE||"mouse")){f.touches=[];for(var w in fr)f.touches.push(fr[w]);f.changedTouches=[f],s(f)}}function es(s,f){f.MSPOINTER_TYPE_TOUCH&&f.pointerType===f.MSPOINTER_TYPE_TOUCH&&oi(f),dr(s,f)}function Fs(s){var f={},w,T;for(T in s)w=s[T],f[T]=w&&w.bind?w.bind(s):w;return s=f,f.type="dblclick",f.detail=2,f.isTrusted=!1,f._simulated=!0,f}var di=200;function co(s,f){s.addEventListener("dblclick",f);var w=0,T;function Z(_e){if(_e.detail!==1){T=_e.detail;return}if(!(_e.pointerType==="mouse"||_e.sourceCapabilities&&!_e.sourceCapabilities.firesTouchEvents)){var at=fa(_e);if(!(at.some(function(zt){return zt instanceof HTMLLabelElement&&zt.attributes.for})&&!at.some(function(zt){return zt instanceof HTMLInputElement||zt instanceof HTMLSelectElement}))){var Tt=Date.now();Tt-w<=di?(T++,T===2&&f(Fs(_e))):T=1,w=Tt}}}return s.addEventListener("click",Z),{dblclick:f,simDblclick:Z}}function mr(s,f){s.removeEventListener("dblclick",f.dblclick),s.removeEventListener("click",f.simDblclick)}var Er=Ao(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),mi=Ao(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),xn=mi==="webkitTransition"||mi==="OTransition"?mi+"End":"transitionend";function on(s){return typeof s=="string"?document.getElementById(s):s}function ii(s,f){var w=s.style[f]||s.currentStyle&&s.currentStyle[f];if((!w||w==="auto")&&document.defaultView){var T=document.defaultView.getComputedStyle(s,null);w=T?T[f]:null}return w==="auto"?null:w}function Xn(s,f,w){var T=document.createElement(s);return T.className=f||"",w&&w.appendChild(T),T}function jn(s){var f=s.parentNode;f&&f.removeChild(s)}function rs(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function Ps(s){var f=s.parentNode;f&&f.lastChild!==s&&f.appendChild(s)}function Tr(s){var f=s.parentNode;f&&f.firstChild!==s&&f.insertBefore(s,f.firstChild)}function so(s,f){if(s.classList!==void 0)return s.classList.contains(f);var w=sr(s);return w.length>0&&new RegExp("(^|\\s)"+f+"(\\s|$)").test(w)}function ln(s,f){if(s.classList!==void 0)for(var w=D(f),T=0,Z=w.length;T<Z;T++)s.classList.add(w[T]);else if(!so(s,f)){var _e=sr(s);vr(s,(_e?_e+" ":"")+f)}}function Jn(s,f){s.classList!==void 0?s.classList.remove(f):vr(s,b((" "+sr(s)+" ").replace(" "+f+" "," ")))}function vr(s,f){s.className.baseVal===void 0?s.className=f:s.className.baseVal=f}function sr(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function pr(s,f){"opacity"in s.style?s.style.opacity=f:"filter"in s.style&&Ea(s,f)}function Ea(s,f){var w=!1,T="DXImageTransform.Microsoft.Alpha";try{w=s.filters.item(T)}catch{if(f===1)return}f=Math.round(f*100),w?(w.Enabled=f!==100,w.Opacity=f):s.style.filter+=" progid:"+T+"(opacity="+f+")"}function Ao(s){for(var f=document.documentElement.style,w=0;w<s.length;w++)if(s[w]in f)return s[w];return!1}function ho(s,f,w){var T=f||new re(0,0);s.style[Er]=(yn.ie3d?"translate("+T.x+"px,"+T.y+"px)":"translate3d("+T.x+"px,"+T.y+"px,0)")+(w?" scale("+w+")":"")}function ar(s,f){s._leaflet_pos=f,yn.any3d?ho(s,f):(s.style.left=f.x+"px",s.style.top=f.y+"px")}function Es(s){return s._leaflet_pos||new re(0,0)}var oo,As,Wi;if("onselectstart"in document)oo=function(){li(window,"selectstart",oi)},As=function(){Ri(window,"selectstart",oi)};else{var ds=Ao(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);oo=function(){if(ds){var s=document.documentElement.style;Wi=s[ds],s[ds]="none"}},As=function(){ds&&(document.documentElement.style[ds]=Wi,Wi=void 0)}}function ps(){li(window,"dragstart",oi)}function fo(){Ri(window,"dragstart",oi)}var Vo,ca;function Ha(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(ts(),Vo=s,ca=s.style.outlineStyle,s.style.outlineStyle="none",li(window,"keydown",ts))}function ts(){Vo&&(Vo.style.outlineStyle=ca,Vo=void 0,ca=void 0,Ri(window,"keydown",ts))}function iu(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function cl(s){var f=s.getBoundingClientRect();return{x:f.width/s.offsetWidth||1,y:f.height/s.offsetHeight||1,boundingClientRect:f}}var ri={__proto__:null,TRANSFORM:Er,TRANSITION:mi,TRANSITION_END:xn,get:on,getStyle:ii,create:Xn,remove:jn,empty:rs,toFront:Ps,toBack:Tr,hasClass:so,addClass:ln,removeClass:Jn,setClass:vr,getClass:sr,setOpacity:pr,testProp:Ao,setTransform:ho,setPosition:ar,getPosition:Es,get disableTextSelection(){return oo},get enableTextSelection(){return As},disableImageDrag:ps,enableImageDrag:fo,preventOutline:Ha,restoreOutline:ts,getSizedParentNode:iu,getScale:cl};function li(s,f,w,T){if(f&&typeof f=="object")for(var Z in f)Ma(s,Z,f[Z],w);else{f=D(f);for(var _e=0,at=f.length;_e<at;_e++)Ma(s,f[_e],w,T)}return this}var po="_leaflet_events";function Ri(s,f,w,T){if(arguments.length===1)Bl(s),delete s[po];else if(f&&typeof f=="object")for(var Z in f)go(s,Z,f[Z],w);else if(f=D(f),arguments.length===2)Bl(s,function(Tt){return Se(f,Tt)!==-1});else for(var _e=0,at=f.length;_e<at;_e++)go(s,f[_e],w,T);return this}function Bl(s,f){for(var w in s[po]){var T=w.split(/\d/)[0];(!f||f(T))&&go(s,T,null,null,w)}}var Aa={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ma(s,f,w,T){var Z=f+g(w)+(T?"_"+g(T):"");if(s[po]&&s[po][Z])return this;var _e=function(Tt){return w.call(T||s,Tt||window.event)},at=_e;!yn.touchNative&&yn.pointer&&f.indexOf("touch")===0?_e=Qr(s,f,_e):yn.touch&&f==="dblclick"?_e=co(s,_e):"addEventListener"in s?f==="touchstart"||f==="touchmove"||f==="wheel"||f==="mousewheel"?s.addEventListener(Aa[f]||f,_e,yn.passiveEvents?{passive:!1}:!1):f==="mouseenter"||f==="mouseleave"?(_e=function(Tt){Tt=Tt||window.event,ka(s,Tt)&&at(Tt)},s.addEventListener(Aa[f],_e,!1)):s.addEventListener(f,at,!1):s.attachEvent("on"+f,_e),s[po]=s[po]||{},s[po][Z]=_e}function go(s,f,w,T,Z){Z=Z||f+g(w)+(T?"_"+g(T):"");var _e=s[po]&&s[po][Z];if(!_e)return this;!yn.touchNative&&yn.pointer&&f.indexOf("touch")===0?Ci(s,f,_e):yn.touch&&f==="dblclick"?mr(s,_e):"removeEventListener"in s?s.removeEventListener(Aa[f]||f,_e,!1):s.detachEvent("on"+f,_e),s[po][Z]=null}function ha(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function Nl(s){return Ma(s,"wheel",ha),this}function Wa(s){return li(s,"mousedown touchstart dblclick contextmenu",ha),s._leaflet_disable_click=!0,this}function oi(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function wi(s){return oi(s),ha(s),this}function fa(s){if(s.composedPath)return s.composedPath();for(var f=[],w=s.target;w;)f.push(w),w=w.parentNode;return f}function ru(s,f){if(!f)return new re(s.clientX,s.clientY);var w=cl(f),T=w.boundingClientRect;return new re((s.clientX-T.left)/w.x-f.clientLeft,(s.clientY-T.top)/w.y-f.clientTop)}var Za=yn.linux&&yn.chrome?window.devicePixelRatio:yn.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function hl(s){return yn.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/Za:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function ka(s,f){var w=f.relatedTarget;if(!w)return!0;try{for(;w&&w!==s;)w=w.parentNode}catch{return!1}return w!==s}var Ka={__proto__:null,on:li,off:Ri,stopPropagation:ha,disableScrollPropagation:Nl,disableClickPropagation:Wa,preventDefault:oi,stop:wi,getPropagationPath:fa,getMousePosition:ru,getWheelDelta:hl,isExternalTarget:ka,addListener:li,removeListener:Ri},fl=ce.extend({run:function(s,f,w,T){this.stop(),this._el=s,this._inProgress=!0,this._duration=w||.25,this._easeOutPower=1/Math.max(T||.5,.2),this._startPos=Es(s),this._offset=f.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=z(this._animate,this),this._step()},_step:function(s){var f=+new Date-this._startTime,w=this._duration*1e3;f<w?this._runFrame(this._easeOut(f/w),s):(this._runFrame(1),this._complete())},_runFrame:function(s,f){var w=this._startPos.add(this._offset.multiplyBy(s));f&&w._round(),ar(this._el,w),this.fire("step")},_complete:function(){R(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),Si=ce.extend({options:{crs:ae,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,f){f=$(this,f),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),f.maxBounds&&this.setMaxBounds(f.maxBounds),f.zoom!==void 0&&(this._zoom=this._limitZoom(f.zoom)),f.center&&f.zoom!==void 0&&this.setView(he(f.center),f.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=mi&&yn.any3d&&!yn.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),li(this._proxy,xn,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,f,w){if(f=f===void 0?this._zoom:this._limitZoom(f),s=this._limitCenter(he(s),f,this.options.maxBounds),w=w||{},this._stop(),this._loaded&&!w.reset&&w!==!0){w.animate!==void 0&&(w.zoom=r({animate:w.animate},w.zoom),w.pan=r({animate:w.animate,duration:w.duration},w.pan));var T=this._zoom!==f?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,f,w.zoom):this._tryAnimatedPan(s,w.pan);if(T)return clearTimeout(this._sizeTimer),this}return this._resetView(s,f,w.pan&&w.pan.noMoveStart),this},setZoom:function(s,f){return this._loaded?this.setView(this.getCenter(),s,{zoom:f}):(this._zoom=s,this)},zoomIn:function(s,f){return s=s||(yn.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,f)},zoomOut:function(s,f){return s=s||(yn.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,f)},setZoomAround:function(s,f,w){var T=this.getZoomScale(f),Z=this.getSize().divideBy(2),_e=s instanceof re?s:this.latLngToContainerPoint(s),at=_e.subtract(Z).multiplyBy(1-1/T),Tt=this.containerPointToLatLng(Z.add(at));return this.setView(Tt,f,{zoom:w})},_getBoundsCenterZoom:function(s,f){f=f||{},s=s.getBounds?s.getBounds():B(s);var w=Me(f.paddingTopLeft||f.padding||[0,0]),T=Me(f.paddingBottomRight||f.padding||[0,0]),Z=this.getBoundsZoom(s,!1,w.add(T));if(Z=typeof f.maxZoom=="number"?Math.min(f.maxZoom,Z):Z,Z===1/0)return{center:s.getCenter(),zoom:Z};var _e=T.subtract(w).divideBy(2),at=this.project(s.getSouthWest(),Z),Tt=this.project(s.getNorthEast(),Z),zt=this.unproject(at.add(Tt).divideBy(2).add(_e),Z);return{center:zt,zoom:Z}},fitBounds:function(s,f){if(s=B(s),!s.isValid())throw new Error("Bounds are not valid.");var w=this._getBoundsCenterZoom(s,f);return this.setView(w.center,w.zoom,f)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,f){return this.setView(s,this._zoom,{pan:f})},panBy:function(s,f){if(s=Me(s).round(),f=f||{},!s.x&&!s.y)return this.fire("moveend");if(f.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new fl,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),f.noMoveStart||this.fire("movestart"),f.animate!==!1){ln(this._mapPane,"leaflet-pan-anim");var w=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,w,f.duration||.25,f.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,f,w){if(w=w||{},w.animate===!1||!yn.any3d)return this.setView(s,f,w);this._stop();var T=this.project(this.getCenter()),Z=this.project(s),_e=this.getSize(),at=this._zoom;s=he(s),f=f===void 0?at:f;var Tt=Math.max(_e.x,_e.y),zt=Tt*this.getZoomScale(at,f),tn=Z.distanceTo(T)||1,En=1.42,Un=En*En;function gi(Gi){var xs=Gi?-1:1,Te=Gi?zt:Tt,qs=zt*zt-Tt*Tt+xs*Un*Un*tn*tn,Ol=2*Te*Un*tn,hs=qs/Ol,_i=Math.sqrt(hs*hs+1)-hs,ec=_i<1e-9?-18:Math.log(_i);return ec}function Zr(Gi){return(Math.exp(Gi)-Math.exp(-Gi))/2}function Ar(Gi){return(Math.exp(Gi)+Math.exp(-Gi))/2}function cs(Gi){return Zr(Gi)/Ar(Gi)}var wr=gi(0);function $s(Gi){return Tt*(Ar(wr)/Ar(wr+En*Gi))}function Tu(Gi){return Tt*(Ar(wr)*cs(wr+En*Gi)-Zr(wr))/Un}function Fo(Gi){return 1-Math.pow(1-Gi,1.5)}var wo=Date.now(),uo=(gi(1)-wr)/En,Mc=w.duration?1e3*w.duration:1e3*uo*.8;function gl(){var Gi=(Date.now()-wo)/Mc,xs=Fo(Gi)*uo;Gi<=1?(this._flyToFrame=z(gl,this),this._move(this.unproject(T.add(Z.subtract(T).multiplyBy(Tu(xs)/tn)),at),this.getScaleZoom(Tt/$s(xs),at),{flyTo:!0})):this._move(s,f)._moveEnd(!0)}return this._moveStart(!0,w.noMoveStart),gl.call(this),this},flyToBounds:function(s,f){var w=this._getBoundsCenterZoom(s,f);return this.flyTo(w.center,w.zoom,f)},setMaxBounds:function(s){return s=B(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var f=this.options.minZoom;return this.options.minZoom=s,this._loaded&&f!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var f=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&f!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,f){this._enforcingBounds=!0;var w=this.getCenter(),T=this._limitCenter(w,this._zoom,B(s));return w.equals(T)||this.panTo(T,f),this._enforcingBounds=!1,this},panInside:function(s,f){f=f||{};var w=Me(f.paddingTopLeft||f.padding||[0,0]),T=Me(f.paddingBottomRight||f.padding||[0,0]),Z=this.project(this.getCenter()),_e=this.project(s),at=this.getPixelBounds(),Tt=X([at.min.add(w),at.max.subtract(T)]),zt=Tt.getSize();if(!Tt.contains(_e)){this._enforcingBounds=!0;var tn=_e.subtract(Tt.getCenter()),En=Tt.extend(_e).getSize().subtract(zt);Z.x+=tn.x<0?-En.x:En.x,Z.y+=tn.y<0?-En.y:En.y,this.panTo(this.unproject(Z),f),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=r({animate:!1,pan:!0},s===!0?{animate:!0}:s);var f=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var w=this.getSize(),T=f.divideBy(2).round(),Z=w.divideBy(2).round(),_e=T.subtract(Z);return!_e.x&&!_e.y?this:(s.animate&&s.pan?this.panBy(_e):(s.pan&&this._rawPanBy(_e),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:f,newSize:w}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=r({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var f=l(this._handleGeolocationResponse,this),w=l(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(f,w,s):navigator.geolocation.getCurrentPosition(f,w,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var f=s.code,w=s.message||(f===1?"permission denied":f===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:f,message:"Geolocation error: "+w+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var f=s.coords.latitude,w=s.coords.longitude,T=new H(f,w),Z=T.toBounds(s.coords.accuracy*2),_e=this._locateOptions;if(_e.setView){var at=this.getBoundsZoom(Z);this.setView(T,_e.maxZoom?Math.min(at,_e.maxZoom):at)}var Tt={latlng:T,bounds:Z,timestamp:s.timestamp};for(var zt in s.coords)typeof s.coords[zt]=="number"&&(Tt[zt]=s.coords[zt]);this.fire("locationfound",Tt)}},addHandler:function(s,f){if(!f)return this;var w=this[s]=new f(this);return this._handlers.push(w),this.options[s]&&w.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),jn(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(R(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)jn(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,f){var w="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),T=Xn("div",w,f||this._mapPane);return s&&(this._panes[s]=T),T},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),f=this.unproject(s.getBottomLeft()),w=this.unproject(s.getTopRight());return new Ee(f,w)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,f,w){s=B(s),w=Me(w||[0,0]);var T=this.getZoom()||0,Z=this.getMinZoom(),_e=this.getMaxZoom(),at=s.getNorthWest(),Tt=s.getSouthEast(),zt=this.getSize().subtract(w),tn=X(this.project(Tt,T),this.project(at,T)).getSize(),En=yn.any3d?this.options.zoomSnap:1,Un=zt.x/tn.x,gi=zt.y/tn.y,Zr=f?Math.max(Un,gi):Math.min(Un,gi);return T=this.getScaleZoom(Zr,T),En&&(T=Math.round(T/(En/100))*(En/100),T=f?Math.ceil(T/En)*En:Math.floor(T/En)*En),Math.max(Z,Math.min(_e,T))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new re(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,f){var w=this._getTopLeftPoint(s,f);return new ot(w,w.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,f){var w=this.options.crs;return f=f===void 0?this._zoom:f,w.scale(s)/w.scale(f)},getScaleZoom:function(s,f){var w=this.options.crs;f=f===void 0?this._zoom:f;var T=w.zoom(s*w.scale(f));return isNaN(T)?1/0:T},project:function(s,f){return f=f===void 0?this._zoom:f,this.options.crs.latLngToPoint(he(s),f)},unproject:function(s,f){return f=f===void 0?this._zoom:f,this.options.crs.pointToLatLng(Me(s),f)},layerPointToLatLng:function(s){var f=Me(s).add(this.getPixelOrigin());return this.unproject(f)},latLngToLayerPoint:function(s){var f=this.project(he(s))._round();return f._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(he(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(B(s))},distance:function(s,f){return this.options.crs.distance(he(s),he(f))},containerPointToLayerPoint:function(s){return Me(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return Me(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var f=this.containerPointToLayerPoint(Me(s));return this.layerPointToLatLng(f)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(he(s)))},mouseEventToContainerPoint:function(s){return ru(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var f=this._container=on(s);if(f){if(f._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");li(f,"scroll",this._onScroll,this),this._containerId=g(f)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&yn.any3d,ln(s,"leaflet-container"+(yn.touch?" leaflet-touch":"")+(yn.retina?" leaflet-retina":"")+(yn.ielt9?" leaflet-oldie":"")+(yn.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var f=ii(s,"position");f!=="absolute"&&f!=="relative"&&f!=="fixed"&&f!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ar(this._mapPane,new re(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ln(s.markerPane,"leaflet-zoom-hide"),ln(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,f,w){ar(this._mapPane,new re(0,0));var T=!this._loaded;this._loaded=!0,f=this._limitZoom(f),this.fire("viewprereset");var Z=this._zoom!==f;this._moveStart(Z,w)._move(s,f)._moveEnd(Z),this.fire("viewreset"),T&&this.fire("load")},_moveStart:function(s,f){return s&&this.fire("zoomstart"),f||this.fire("movestart"),this},_move:function(s,f,w,T){f===void 0&&(f=this._zoom);var Z=this._zoom!==f;return this._zoom=f,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),T?w&&w.pinch&&this.fire("zoom",w):((Z||w&&w.pinch)&&this.fire("zoom",w),this.fire("move",w)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return R(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){ar(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[g(this._container)]=this;var f=s?Ri:li;f(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&f(window,"resize",this._onResize,this),yn.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){R(this._resizeRequest),this._resizeRequest=z(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,f){for(var w=[],T,Z=f==="mouseout"||f==="mouseover",_e=s.target||s.srcElement,at=!1;_e;){if(T=this._targets[g(_e)],T&&(f==="click"||f==="preclick")&&this._draggableMoved(T)){at=!0;break}if(T&&T.listens(f,!0)&&(Z&&!ka(_e,s)||(w.push(T),Z))||_e===this._container)break;_e=_e.parentNode}return!w.length&&!at&&!Z&&this.listens(f,!0)&&(w=[this]),w},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var f=s.target||s.srcElement;if(!(!this._loaded||f._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(f))){var w=s.type;w==="mousedown"&&Ha(f),this._fireDOMEvent(s,w)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,f,w){if(s.type==="click"){var T=r({},s);T.type="preclick",this._fireDOMEvent(T,T.type,w)}var Z=this._findEventTargets(s,f);if(w){for(var _e=[],at=0;at<w.length;at++)w[at].listens(f,!0)&&_e.push(w[at]);Z=_e.concat(Z)}if(Z.length){f==="contextmenu"&&oi(s);var Tt=Z[0],zt={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var tn=Tt.getLatLng&&(!Tt._radius||Tt._radius<=10);zt.containerPoint=tn?this.latLngToContainerPoint(Tt.getLatLng()):this.mouseEventToContainerPoint(s),zt.layerPoint=this.containerPointToLayerPoint(zt.containerPoint),zt.latlng=tn?Tt.getLatLng():this.layerPointToLatLng(zt.layerPoint)}for(at=0;at<Z.length;at++)if(Z[at].fire(f,zt,!0),zt.originalEvent._stopped||Z[at].options.bubblingMouseEvents===!1&&Se(this._mouseEvents,f)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,f=this._handlers.length;s<f;s++)this._handlers[s].disable()},whenReady:function(s,f){return this._loaded?s.call(f||this,{target:this}):this.on("load",s,f),this},_getMapPanePos:function(){return Es(this._mapPane)||new re(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,f){var w=s&&f!==void 0?this._getNewPixelOrigin(s,f):this.getPixelOrigin();return w.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,f){var w=this.getSize()._divideBy(2);return this.project(s,f)._subtract(w)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,f,w){var T=this._getNewPixelOrigin(w,f);return this.project(s,f)._subtract(T)},_latLngBoundsToNewLayerBounds:function(s,f,w){var T=this._getNewPixelOrigin(w,f);return X([this.project(s.getSouthWest(),f)._subtract(T),this.project(s.getNorthWest(),f)._subtract(T),this.project(s.getSouthEast(),f)._subtract(T),this.project(s.getNorthEast(),f)._subtract(T)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,f,w){if(!w)return s;var T=this.project(s,f),Z=this.getSize().divideBy(2),_e=new ot(T.subtract(Z),T.add(Z)),at=this._getBoundsOffset(_e,w,f);return Math.abs(at.x)<=1&&Math.abs(at.y)<=1?s:this.unproject(T.add(at),f)},_limitOffset:function(s,f){if(!f)return s;var w=this.getPixelBounds(),T=new ot(w.min.add(s),w.max.add(s));return s.add(this._getBoundsOffset(T,f))},_getBoundsOffset:function(s,f,w){var T=X(this.project(f.getNorthEast(),w),this.project(f.getSouthWest(),w)),Z=T.min.subtract(s.min),_e=T.max.subtract(s.max),at=this._rebound(Z.x,-_e.x),Tt=this._rebound(Z.y,-_e.y);return new re(at,Tt)},_rebound:function(s,f){return s+f>0?Math.round(s-f)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(f))},_limitZoom:function(s){var f=this.getMinZoom(),w=this.getMaxZoom(),T=yn.any3d?this.options.zoomSnap:1;return T&&(s=Math.round(s/T)*T),Math.max(f,Math.min(w,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Jn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,f){var w=this._getCenterOffset(s)._trunc();return(f&&f.animate)!==!0&&!this.getSize().contains(w)?!1:(this.panBy(w,f),!0)},_createAnimProxy:function(){var s=this._proxy=Xn("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(f){var w=Er,T=this._proxy.style[w];ho(this._proxy,this.project(f.center,f.zoom),this.getZoomScale(f.zoom,1)),T===this._proxy.style[w]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){jn(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),f=this.getZoom();ho(this._proxy,this.project(s,f),this.getZoomScale(f,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,f,w){if(this._animatingZoom)return!0;if(w=w||{},!this._zoomAnimated||w.animate===!1||this._nothingToAnimate()||Math.abs(f-this._zoom)>this.options.zoomAnimationThreshold)return!1;var T=this.getZoomScale(f),Z=this._getCenterOffset(s)._divideBy(1-1/T);return w.animate!==!0&&!this.getSize().contains(Z)?!1:(z(function(){this._moveStart(!0,w.noMoveStart||!1)._animateZoom(s,f,!0)},this),!0)},_animateZoom:function(s,f,w,T){this._mapPane&&(w&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=f,ln(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:f,noUpdate:T}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Jn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Nr(s,f){return new Si(s,f)}var Gn=V.extend({options:{position:"topright"},initialize:function(s){$(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var f=this._map;return f&&f.removeControl(this),this.options.position=s,f&&f.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var f=this._container=this.onAdd(s),w=this.getPosition(),T=s._controlCorners[w];return ln(f,"leaflet-control"),w.indexOf("bottom")!==-1?T.insertBefore(f,T.firstChild):T.appendChild(f),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(jn(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),Rr=function(s){return new Gn(s)};Si.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},f="leaflet-",w=this._controlContainer=Xn("div",f+"control-container",this._container);function T(Z,_e){var at=f+Z+" "+f+_e;s[Z+_e]=Xn("div",at,w)}T("top","left"),T("top","right"),T("bottom","left"),T("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)jn(this._controlCorners[s]);jn(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Ta=Gn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,f,w,T){return w<T?-1:T<w?1:0}},initialize:function(s,f,w){$(this,w),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var T in s)this._addLayer(s[T],T);for(T in f)this._addLayer(f[T],T,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var f=0;f<this._layers.length;f++)this._layers[f].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return Gn.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,f){return this._addLayer(s,f),this._map?this._update():this},addOverlay:function(s,f){return this._addLayer(s,f,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var f=this._getLayer(g(s));return f&&this._layers.splice(this._layers.indexOf(f),1),this._map?this._update():this},expand:function(){ln(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(ln(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):Jn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Jn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",f=this._container=Xn("div",s),w=this.options.collapsed;f.setAttribute("aria-haspopup",!0),Wa(f),Nl(f);var T=this._section=Xn("section",s+"-list");w&&(this._map.on("click",this.collapse,this),li(f,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var Z=this._layersLink=Xn("a",s+"-toggle",f);Z.href="#",Z.title="Layers",Z.setAttribute("role","button"),li(Z,{keydown:function(_e){_e.keyCode===13&&this._expandSafely()},click:function(_e){oi(_e),this._expandSafely()}},this),w||this.expand(),this._baseLayersList=Xn("div",s+"-base",T),this._separator=Xn("div",s+"-separator",T),this._overlaysList=Xn("div",s+"-overlays",T),f.appendChild(T)},_getLayer:function(s){for(var f=0;f<this._layers.length;f++)if(this._layers[f]&&g(this._layers[f].layer)===s)return this._layers[f]},_addLayer:function(s,f,w){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:f,overlay:w}),this.options.sortLayers&&this._layers.sort(l(function(T,Z){return this.options.sortFunction(T.layer,Z.layer,T.name,Z.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;rs(this._baseLayersList),rs(this._overlaysList),this._layerControlInputs=[];var s,f,w,T,Z=0;for(w=0;w<this._layers.length;w++)T=this._layers[w],this._addItem(T),f=f||T.overlay,s=s||!T.overlay,Z+=T.overlay?0:1;return this.options.hideSingleBase&&(s=s&&Z>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=f&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var f=this._getLayer(g(s.target)),w=f.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;w&&this._map.fire(w,f)},_createRadioElement:function(s,f){var w='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(f?' checked="checked"':"")+"/>",T=document.createElement("div");return T.innerHTML=w,T.firstChild},_addItem:function(s){var f=document.createElement("label"),w=this._map.hasLayer(s.layer),T;s.overlay?(T=document.createElement("input"),T.type="checkbox",T.className="leaflet-control-layers-selector",T.defaultChecked=w):T=this._createRadioElement("leaflet-base-layers_"+g(this),w),this._layerControlInputs.push(T),T.layerId=g(s.layer),li(T,"click",this._onInputClick,this);var Z=document.createElement("span");Z.innerHTML=" "+s.name;var _e=document.createElement("span");f.appendChild(_e),_e.appendChild(T),_e.appendChild(Z);var at=s.overlay?this._overlaysList:this._baseLayersList;return at.appendChild(f),this._checkDisabledLayers(),f},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,f,w,T=[],Z=[];this._handlingClick=!0;for(var _e=s.length-1;_e>=0;_e--)f=s[_e],w=this._getLayer(f.layerId).layer,f.checked?T.push(w):f.checked||Z.push(w);for(_e=0;_e<Z.length;_e++)this._map.hasLayer(Z[_e])&&this._map.removeLayer(Z[_e]);for(_e=0;_e<T.length;_e++)this._map.hasLayer(T[_e])||this._map.addLayer(T[_e]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,f,w,T=this._map.getZoom(),Z=s.length-1;Z>=0;Z--)f=s[Z],w=this._getLayer(f.layerId).layer,f.disabled=w.options.minZoom!==void 0&&T<w.options.minZoom||w.options.maxZoom!==void 0&&T>w.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,li(s,"click",oi),this.expand();var f=this;setTimeout(function(){Ri(s,"click",oi),f._preventClick=!1})}}),Go=function(s,f,w){return new Ta(s,f,w)},yr=Gn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var f="leaflet-control-zoom",w=Xn("div",f+" leaflet-bar"),T=this.options;return this._zoomInButton=this._createButton(T.zoomInText,T.zoomInTitle,f+"-in",w,this._zoomIn),this._zoomOutButton=this._createButton(T.zoomOutText,T.zoomOutTitle,f+"-out",w,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),w},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,f,w,T,Z){var _e=Xn("a",w,T);return _e.innerHTML=s,_e.href="#",_e.title=f,_e.setAttribute("role","button"),_e.setAttribute("aria-label",f),Wa(_e),li(_e,"click",wi),li(_e,"click",Z,this),li(_e,"click",this._refocusOnMap,this),_e},_updateDisabled:function(){var s=this._map,f="leaflet-disabled";Jn(this._zoomInButton,f),Jn(this._zoomOutButton,f),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(ln(this._zoomOutButton,f),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(ln(this._zoomInButton,f),this._zoomInButton.setAttribute("aria-disabled","true"))}});Si.mergeOptions({zoomControl:!0}),Si.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new yr,this.addControl(this.zoomControl))});var dl=function(s){return new yr(s)},Mo=Gn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var f="leaflet-control-scale",w=Xn("div",f),T=this.options;return this._addScales(T,f+"-line",w),s.on(T.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),w},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,f,w){s.metric&&(this._mScale=Xn("div",f,w)),s.imperial&&(this._iScale=Xn("div",f,w))},_update:function(){var s=this._map,f=s.getSize().y/2,w=s.distance(s.containerPointToLatLng([0,f]),s.containerPointToLatLng([this.options.maxWidth,f]));this._updateScales(w)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var f=this._getRoundNum(s),w=f<1e3?f+" m":f/1e3+" km";this._updateScale(this._mScale,w,f/s)},_updateImperial:function(s){var f=s*3.2808399,w,T,Z;f>5280?(w=f/5280,T=this._getRoundNum(w),this._updateScale(this._iScale,T+" mi",T/w)):(Z=this._getRoundNum(f),this._updateScale(this._iScale,Z+" ft",Z/f))},_updateScale:function(s,f,w){s.style.width=Math.round(this.options.maxWidth*w)+"px",s.innerHTML=f},_getRoundNum:function(s){var f=Math.pow(10,(Math.floor(s)+"").length-1),w=s/f;return w=w>=10?10:w>=5?5:w>=3?3:w>=2?2:1,f*w}}),Ja=function(s){return new Mo(s)},Ya='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',ao=Gn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(yn.inlineSvg?Ya+" ":"")+"Leaflet</a>"},initialize:function(s){$(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=Xn("div","leaflet-control-attribution"),Wa(this._container);for(var f in s._layers)s._layers[f].getAttribution&&this.addAttribution(s._layers[f].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var f in this._attributions)this._attributions[f]&&s.push(f);var w=[];this.options.prefix&&w.push(this.options.prefix),s.length&&w.push(s.join(", ")),this._container.innerHTML=w.join(' <span aria-hidden="true">|</span> ')}}});Si.mergeOptions({attributionControl:!0}),Si.addInitHook(function(){this.options.attributionControl&&new ao().addTo(this)});var Xa=function(s){return new ao(s)};Gn.Layers=Ta,Gn.Zoom=yr,Gn.Scale=Mo,Gn.Attribution=ao,Rr.layers=Go,Rr.zoom=dl,Rr.scale=Ja,Rr.attribution=Xa;var Zi=V.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Zi.addTo=function(s,f){return s.addHandler(f,this),this};var su={Events:Y},ss=yn.touch?"touchstart mousedown":"mousedown",mo=ce.extend({options:{clickTolerance:3},initialize:function(s,f,w,T){$(this,T),this._element=s,this._dragStartTarget=f||s,this._preventOutline=w},enable:function(){this._enabled||(li(this._dragStartTarget,ss,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(mo._dragging===this&&this.finishDrag(!0),Ri(this._dragStartTarget,ss,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!so(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){mo._dragging===this&&this.finishDrag();return}if(!(mo._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(mo._dragging=this,this._preventOutline&&Ha(this._element),ps(),oo(),!this._moving)){this.fire("down");var f=s.touches?s.touches[0]:s,w=iu(this._element);this._startPoint=new re(f.clientX,f.clientY),this._startPos=Es(this._element),this._parentScale=cl(w);var T=s.type==="mousedown";li(document,T?"mousemove":"touchmove",this._onMove,this),li(document,T?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var f=s.touches&&s.touches.length===1?s.touches[0]:s,w=new re(f.clientX,f.clientY)._subtract(this._startPoint);!w.x&&!w.y||Math.abs(w.x)+Math.abs(w.y)<this.options.clickTolerance||(w.x/=this._parentScale.x,w.y/=this._parentScale.y,oi(s),this._moved||(this.fire("dragstart"),this._moved=!0,ln(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ln(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(w),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),ar(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){Jn(document.body,"leaflet-dragging"),this._lastTarget&&(Jn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ri(document,"mousemove touchmove",this._onMove,this),Ri(document,"mouseup touchend touchcancel",this._onUp,this),fo(),As();var f=this._moved&&this._moving;this._moving=!1,mo._dragging=!1,f&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function Qa(s,f,w){var T,Z=[1,4,2,8],_e,at,Tt,zt,tn,En,Un,gi;for(_e=0,En=s.length;_e<En;_e++)s[_e]._code=Ft(s[_e],f);for(Tt=0;Tt<4;Tt++){for(Un=Z[Tt],T=[],_e=0,En=s.length,at=En-1;_e<En;at=_e++)zt=s[_e],tn=s[at],zt._code&Un?tn._code&Un||(gi=St(tn,zt,Un,f,w),gi._code=Ft(gi,f),T.push(gi)):(tn._code&Un&&(gi=St(tn,zt,Un,f,w),gi._code=Ft(gi,f),T.push(gi)),T.push(zt));s=T}return s}function vo(s,f){var w,T,Z,_e,at,Tt,zt,tn,En;if(!s||s.length===0)throw new Error("latlngs not passed");kn(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var Un=he([0,0]),gi=B(s),Zr=gi.getNorthWest().distanceTo(gi.getSouthWest())*gi.getNorthEast().distanceTo(gi.getNorthWest());Zr<1700&&(Un=Ba(s));var Ar=s.length,cs=[];for(w=0;w<Ar;w++){var wr=he(s[w]);cs.push(f.project(he([wr.lat-Un.lat,wr.lng-Un.lng])))}for(Tt=zt=tn=0,w=0,T=Ar-1;w<Ar;T=w++)Z=cs[w],_e=cs[T],at=Z.y*_e.x-_e.y*Z.x,zt+=(Z.x+_e.x)*at,tn+=(Z.y+_e.y)*at,Tt+=at*3;Tt===0?En=cs[0]:En=[zt/Tt,tn/Tt];var $s=f.unproject(Me(En));return he([$s.lat+Un.lat,$s.lng+Un.lng])}function Ba(s){for(var f=0,w=0,T=0,Z=0;Z<s.length;Z++){var _e=he(s[Z]);f+=_e.lat,w+=_e.lng,T++}return he([f/T,w/T])}var Na={__proto__:null,clipPolygon:Qa,polygonCenter:vo,centroid:Ba};function Ki(s,f){if(!f||!s.length)return s.slice();var w=f*f;return s=de(s,w),s=Dr(s,w),s}function Qs(s,f,w){return Math.sqrt(Pn(s,f,w,!0))}function Ho(s,f,w){return Pn(s,f,w)}function Dr(s,f){var w=s.length,T=typeof Uint8Array<"u"?Uint8Array:Array,Z=new T(w);Z[0]=Z[w-1]=1,A(s,Z,f,0,w-1);var _e,at=[];for(_e=0;_e<w;_e++)Z[_e]&&at.push(s[_e]);return at}function A(s,f,w,T,Z){var _e=0,at,Tt,zt;for(Tt=T+1;Tt<=Z-1;Tt++)zt=Pn(s[Tt],s[T],s[Z],!0),zt>_e&&(at=Tt,_e=zt);_e>w&&(f[at]=1,A(s,f,w,T,at),A(s,f,w,at,Z))}function de(s,f){for(var w=[s[0]],T=1,Z=0,_e=s.length;T<_e;T++)sn(s[T],s[Z])>f&&(w.push(s[T]),Z=T);return Z<_e-1&&w.push(s[_e-1]),w}var He;function ct(s,f,w,T,Z){var _e=T?He:Ft(s,w),at=Ft(f,w),Tt,zt,tn;for(He=at;;){if(!(_e|at))return[s,f];if(_e&at)return!1;Tt=_e||at,zt=St(s,f,Tt,w,Z),tn=Ft(zt,w),Tt===_e?(s=zt,_e=tn):(f=zt,at=tn)}}function St(s,f,w,T,Z){var _e=f.x-s.x,at=f.y-s.y,Tt=T.min,zt=T.max,tn,En;return w&8?(tn=s.x+_e*(zt.y-s.y)/at,En=zt.y):w&4?(tn=s.x+_e*(Tt.y-s.y)/at,En=Tt.y):w&2?(tn=zt.x,En=s.y+at*(zt.x-s.x)/_e):w&1&&(tn=Tt.x,En=s.y+at*(Tt.x-s.x)/_e),new re(tn,En,Z)}function Ft(s,f){var w=0;return s.x<f.min.x?w|=1:s.x>f.max.x&&(w|=2),s.y<f.min.y?w|=4:s.y>f.max.y&&(w|=8),w}function sn(s,f){var w=f.x-s.x,T=f.y-s.y;return w*w+T*T}function Pn(s,f,w,T){var Z=f.x,_e=f.y,at=w.x-Z,Tt=w.y-_e,zt=at*at+Tt*Tt,tn;return zt>0&&(tn=((s.x-Z)*at+(s.y-_e)*Tt)/zt,tn>1?(Z=w.x,_e=w.y):tn>0&&(Z+=at*tn,_e+=Tt*tn)),at=s.x-Z,Tt=s.y-_e,T?at*at+Tt*Tt:new re(Z,_e)}function kn(s){return!me(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function Vn(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),kn(s)}function ei(s,f){var w,T,Z,_e,at,Tt,zt,tn;if(!s||s.length===0)throw new Error("latlngs not passed");kn(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var En=he([0,0]),Un=B(s),gi=Un.getNorthWest().distanceTo(Un.getSouthWest())*Un.getNorthEast().distanceTo(Un.getNorthWest());gi<1700&&(En=Ba(s));var Zr=s.length,Ar=[];for(w=0;w<Zr;w++){var cs=he(s[w]);Ar.push(f.project(he([cs.lat-En.lat,cs.lng-En.lng])))}for(w=0,T=0;w<Zr-1;w++)T+=Ar[w].distanceTo(Ar[w+1])/2;if(T===0)tn=Ar[0];else for(w=0,_e=0;w<Zr-1;w++)if(at=Ar[w],Tt=Ar[w+1],Z=at.distanceTo(Tt),_e+=Z,_e>T){zt=(_e-T)/Z,tn=[Tt.x-zt*(Tt.x-at.x),Tt.y-zt*(Tt.y-at.y)];break}var wr=f.unproject(Me(tn));return he([wr.lat+En.lat,wr.lng+En.lng])}var vi={__proto__:null,simplify:Ki,pointToSegmentDistance:Qs,closestPointOnSegment:Ho,clipSegment:ct,_getEdgeIntersection:St,_getBitCode:Ft,_sqClosestPointOnSegment:Pn,isFlat:kn,_flat:Vn,polylineCenter:ei},gr={project:function(s){return new re(s.lng,s.lat)},unproject:function(s){return new H(s.y,s.x)},bounds:new ot([-180,-90],[180,90])},$i={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ot([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var f=Math.PI/180,w=this.R,T=s.lat*f,Z=this.R_MINOR/w,_e=Math.sqrt(1-Z*Z),at=_e*Math.sin(T),Tt=Math.tan(Math.PI/4-T/2)/Math.pow((1-at)/(1+at),_e/2);return T=-w*Math.log(Math.max(Tt,1e-10)),new re(s.lng*f*w,T)},unproject:function(s){for(var f=180/Math.PI,w=this.R,T=this.R_MINOR/w,Z=Math.sqrt(1-T*T),_e=Math.exp(-s.y/w),at=Math.PI/2-2*Math.atan(_e),Tt=0,zt=.1,tn;Tt<15&&Math.abs(zt)>1e-7;Tt++)tn=Z*Math.sin(at),tn=Math.pow((1-tn)/(1+tn),Z/2),zt=Math.PI/2-2*Math.atan(_e*tn)-at,at+=zt;return new H(at*f,s.x*f/w)}},Ji={__proto__:null,LonLat:gr,Mercator:$i,SphericalMercator:se},Or=r({},ie,{code:"EPSG:3395",projection:$i,transformation:function(){var s=.5/(Math.PI*$i.R);return ne(s,.5,-s,.5)}()}),Gr=r({},ie,{code:"EPSG:4326",projection:gr,transformation:ne(1/180,1,-1/180,.5)}),eo=r({},te,{projection:gr,transformation:ne(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,f){var w=f.lng-s.lng,T=f.lat-s.lat;return Math.sqrt(w*w+T*T)},infinite:!0});te.Earth=ie,te.EPSG3395=Or,te.EPSG3857=ae,te.EPSG900913=xe,te.EPSG4326=Gr,te.Simple=eo;var yi=ce.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[g(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[g(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var f=s.target;if(f.hasLayer(this)){if(this._map=f,this._zoomAnimated=f._zoomAnimated,this.getEvents){var w=this.getEvents();f.on(w,this),this.once("remove",function(){f.off(w,this)},this)}this.onAdd(f),this.fire("add"),f.fire("layeradd",{layer:this})}}});Si.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var f=g(s);return this._layers[f]?this:(this._layers[f]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var f=g(s);return this._layers[f]?(this._loaded&&s.onRemove(this),delete this._layers[f],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return g(s)in this._layers},eachLayer:function(s,f){for(var w in this._layers)s.call(f,this._layers[w]);return this},_addLayers:function(s){s=s?me(s)?s:[s]:[];for(var f=0,w=s.length;f<w;f++)this.addLayer(s[f])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[g(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var f=g(s);this._zoomBoundLayers[f]&&(delete this._zoomBoundLayers[f],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,f=-1/0,w=this._getZoomSpan();for(var T in this._zoomBoundLayers){var Z=this._zoomBoundLayers[T].options;s=Z.minZoom===void 0?s:Math.min(s,Z.minZoom),f=Z.maxZoom===void 0?f:Math.max(f,Z.maxZoom)}this._layersMaxZoom=f===-1/0?void 0:f,this._layersMinZoom=s===1/0?void 0:s,w!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var gs=yi.extend({initialize:function(s,f){$(this,f),this._layers={};var w,T;if(s)for(w=0,T=s.length;w<T;w++)this.addLayer(s[w])},addLayer:function(s){var f=this.getLayerId(s);return this._layers[f]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var f=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[f]&&this._map.removeLayer(this._layers[f]),delete this._layers[f],this},hasLayer:function(s){var f=typeof s=="number"?s:this.getLayerId(s);return f in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var f=Array.prototype.slice.call(arguments,1),w,T;for(w in this._layers)T=this._layers[w],T[s]&&T[s].apply(T,f);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,f){for(var w in this._layers)s.call(f,this._layers[w]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return g(s)}}),Ra=function(s,f){return new gs(s,f)},Ms=gs.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),gs.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),gs.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new Ee;for(var f in this._layers){var w=this._layers[f];s.extend(w.getBounds?w.getBounds():w.getLatLng())}return s}}),pl=function(s,f){return new Ms(s,f)},ko=V.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){$(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,f){var w=this._getIconUrl(s);if(!w){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var T=this._createImg(w,f&&f.tagName==="IMG"?f:null);return this._setIconStyles(T,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(T.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),T},_setIconStyles:function(s,f){var w=this.options,T=w[f+"Size"];typeof T=="number"&&(T=[T,T]);var Z=Me(T),_e=Me(f==="shadow"&&w.shadowAnchor||w.iconAnchor||Z&&Z.divideBy(2,!0));s.className="leaflet-marker-"+f+" "+(w.className||""),_e&&(s.style.marginLeft=-_e.x+"px",s.style.marginTop=-_e.y+"px"),Z&&(s.style.width=Z.x+"px",s.style.height=Z.y+"px")},_createImg:function(s,f){return f=f||document.createElement("img"),f.src=s,f},_getIconUrl:function(s){return yn.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function Rl(s){return new ko(s)}var da=ko.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof da.imagePath!="string"&&(da.imagePath=this._detectIconPath()),(this.options.imagePath||da.imagePath)+ko.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var f=function(w,T,Z){var _e=T.exec(w);return _e&&_e[Z]};return s=f(s,/^url\((['"])?(.+)\1\)$/,2),s&&f(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=Xn("div","leaflet-default-icon-path",document.body),f=ii(s,"background-image")||ii(s,"backgroundImage");if(document.body.removeChild(s),f=this._stripUrl(f),f)return f;var w=document.querySelector('link[href$="leaflet.css"]');return w?w.href.substring(0,w.href.length-11-1):""}}),pa=Zi.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new mo(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ln(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Jn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var f=this._marker,w=f._map,T=this._marker.options.autoPanSpeed,Z=this._marker.options.autoPanPadding,_e=Es(f._icon),at=w.getPixelBounds(),Tt=w.getPixelOrigin(),zt=X(at.min._subtract(Tt).add(Z),at.max._subtract(Tt).subtract(Z));if(!zt.contains(_e)){var tn=Me((Math.max(zt.max.x,_e.x)-zt.max.x)/(at.max.x-zt.max.x)-(Math.min(zt.min.x,_e.x)-zt.min.x)/(at.min.x-zt.min.x),(Math.max(zt.max.y,_e.y)-zt.max.y)/(at.max.y-zt.max.y)-(Math.min(zt.min.y,_e.y)-zt.min.y)/(at.min.y-zt.min.y)).multiplyBy(T);w.panBy(tn,{animate:!1}),this._draggable._newPos._add(tn),this._draggable._startPos._add(tn),ar(f._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=z(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(R(this._panRequest),this._panRequest=z(this._adjustPan.bind(this,s)))},_onDrag:function(s){var f=this._marker,w=f._shadow,T=Es(f._icon),Z=f._map.layerPointToLatLng(T);w&&ar(w,T),f._latlng=Z,s.latlng=Z,s.oldLatLng=this._oldLatLng,f.fire("move",s).fire("drag",s)},_onDragEnd:function(s){R(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),Hr=yi.extend({options:{icon:new da,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,f){$(this,f),this._latlng=he(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var f=this._latlng;return this._latlng=he(s),this.update(),this.fire("move",{oldLatLng:f,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,f="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),w=s.icon.createIcon(this._icon),T=!1;w!==this._icon&&(this._icon&&this._removeIcon(),T=!0,s.title&&(w.title=s.title),w.tagName==="IMG"&&(w.alt=s.alt||"")),ln(w,f),s.keyboard&&(w.tabIndex="0",w.setAttribute("role","button")),this._icon=w,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&li(w,"focus",this._panOnFocus,this);var Z=s.icon.createShadow(this._shadow),_e=!1;Z!==this._shadow&&(this._removeShadow(),_e=!0),Z&&(ln(Z,f),Z.alt=""),this._shadow=Z,s.opacity<1&&this._updateOpacity(),T&&this.getPane().appendChild(this._icon),this._initInteraction(),Z&&_e&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ri(this._icon,"focus",this._panOnFocus,this),jn(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&jn(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&ar(this._icon,s),this._shadow&&ar(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var f=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(f)},_initInteraction:function(){if(this.options.interactive&&(ln(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),pa)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new pa(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&pr(this._icon,s),this._shadow&&pr(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var f=this.options.icon.options,w=f.iconSize?Me(f.iconSize):Me(0,0),T=f.iconAnchor?Me(f.iconAnchor):Me(0,0);s.panInside(this._latlng,{paddingTopLeft:T,paddingBottomRight:w.subtract(T)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function To(s,f){return new Hr(s,f)}var to=yi.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return $(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),zs=to.extend({options:{fill:!0,radius:10},initialize:function(s,f){$(this,f),this._latlng=he(s),this._radius=this.options.radius},setLatLng:function(s){var f=this._latlng;return this._latlng=he(s),this.redraw(),this.fire("move",{oldLatLng:f,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var f=s&&s.radius||this._radius;return to.prototype.setStyle.call(this,s),this.setRadius(f),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,f=this._radiusY||s,w=this._clickTolerance(),T=[s+w,f+w];this._pxBounds=new ot(this._point.subtract(T),this._point.add(T))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Da(s,f){return new zs(s,f)}var ms=zs.extend({initialize:function(s,f,w){if(typeof f=="number"&&(f=r({},w,{radius:f})),$(this,f),this._latlng=he(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new Ee(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:to.prototype.setStyle,_project:function(){var s=this._latlng.lng,f=this._latlng.lat,w=this._map,T=w.options.crs;if(T.distance===ie.distance){var Z=Math.PI/180,_e=this._mRadius/ie.R/Z,at=w.project([f+_e,s]),Tt=w.project([f-_e,s]),zt=at.add(Tt).divideBy(2),tn=w.unproject(zt).lat,En=Math.acos((Math.cos(_e*Z)-Math.sin(f*Z)*Math.sin(tn*Z))/(Math.cos(f*Z)*Math.cos(tn*Z)))/Z;(isNaN(En)||En===0)&&(En=_e/Math.cos(Math.PI/180*f)),this._point=zt.subtract(w.getPixelOrigin()),this._radius=isNaN(En)?0:zt.x-w.project([tn,s-En]).x,this._radiusY=zt.y-at.y}else{var Un=T.unproject(T.project(this._latlng).subtract([this._mRadius,0]));this._point=w.latLngToLayerPoint(this._latlng),this._radius=this._point.x-w.latLngToLayerPoint(Un).x}this._updateBounds()}});function ks(s,f,w){return new ms(s,f,w)}var Ts=to.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,f){$(this,f),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var f=1/0,w=null,T=Pn,Z,_e,at=0,Tt=this._parts.length;at<Tt;at++)for(var zt=this._parts[at],tn=1,En=zt.length;tn<En;tn++){Z=zt[tn-1],_e=zt[tn];var Un=T(s,Z,_e,!0);Un<f&&(f=Un,w=T(s,Z,_e))}return w&&(w.distance=Math.sqrt(f)),w},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ei(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,f){return f=f||this._defaultShape(),s=he(s),f.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new Ee,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return kn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var f=[],w=kn(s),T=0,Z=s.length;T<Z;T++)w?(f[T]=he(s[T]),this._bounds.extend(f[T])):f[T]=this._convertLatLngs(s[T]);return f},_project:function(){var s=new ot;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),f=new re(s,s);this._rawPxBounds&&(this._pxBounds=new ot([this._rawPxBounds.min.subtract(f),this._rawPxBounds.max.add(f)]))},_projectLatlngs:function(s,f,w){var T=s[0]instanceof H,Z=s.length,_e,at;if(T){for(at=[],_e=0;_e<Z;_e++)at[_e]=this._map.latLngToLayerPoint(s[_e]),w.extend(at[_e]);f.push(at)}else for(_e=0;_e<Z;_e++)this._projectLatlngs(s[_e],f,w)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var f=this._parts,w,T,Z,_e,at,Tt,zt;for(w=0,Z=0,_e=this._rings.length;w<_e;w++)for(zt=this._rings[w],T=0,at=zt.length;T<at-1;T++)Tt=ct(zt[T],zt[T+1],s,T,!0),Tt&&(f[Z]=f[Z]||[],f[Z].push(Tt[0]),(Tt[1]!==zt[T+1]||T===at-2)&&(f[Z].push(Tt[1]),Z++))}},_simplifyPoints:function(){for(var s=this._parts,f=this.options.smoothFactor,w=0,T=s.length;w<T;w++)s[w]=Ki(s[w],f)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,f){var w,T,Z,_e,at,Tt,zt=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(w=0,_e=this._parts.length;w<_e;w++)for(Tt=this._parts[w],T=0,at=Tt.length,Z=at-1;T<at;Z=T++)if(!(!f&&T===0)&&Qs(s,Tt[Z],Tt[T])<=zt)return!0;return!1}});function ou(s,f){return new Ts(s,f)}Ts._flat=Vn;var ns=Ts.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return vo(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var f=Ts.prototype._convertLatLngs.call(this,s),w=f.length;return w>=2&&f[0]instanceof H&&f[0].equals(f[w-1])&&f.pop(),f},_setLatLngs:function(s){Ts.prototype._setLatLngs.call(this,s),kn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return kn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,f=this.options.weight,w=new re(f,f);if(s=new ot(s.min.subtract(w),s.max.add(w)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var T=0,Z=this._rings.length,_e;T<Z;T++)_e=Qa(this._rings[T],s,!0),_e.length&&this._parts.push(_e)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var f=!1,w,T,Z,_e,at,Tt,zt,tn;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(_e=0,zt=this._parts.length;_e<zt;_e++)for(w=this._parts[_e],at=0,tn=w.length,Tt=tn-1;at<tn;Tt=at++)T=w[at],Z=w[Tt],T.y>s.y!=Z.y>s.y&&s.x<(Z.x-T.x)*(s.y-T.y)/(Z.y-T.y)+T.x&&(f=!f);return f||Ts.prototype._containsPoint.call(this,s,!0)}});function Wo(s,f){return new ns(s,f)}var vs=Ms.extend({initialize:function(s,f){$(this,f),this._layers={},s&&this.addData(s)},addData:function(s){var f=me(s)?s:s.features,w,T,Z;if(f){for(w=0,T=f.length;w<T;w++)Z=f[w],(Z.geometries||Z.geometry||Z.features||Z.coordinates)&&this.addData(Z);return this}var _e=this.options;if(_e.filter&&!_e.filter(s))return this;var at=ys(s,_e);return at?(at.feature=bs(s),at.defaultOptions=at.options,this.resetStyle(at),_e.onEachFeature&&_e.onEachFeature(s,at),this.addLayer(at)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=r({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(f){this._setLayerStyle(f,s)},this)},_setLayerStyle:function(s,f){s.setStyle&&(typeof f=="function"&&(f=f(s.feature)),s.setStyle(f))}});function ys(s,f){var w=s.type==="Feature"?s.geometry:s,T=w?w.coordinates:null,Z=[],_e=f&&f.pointToLayer,at=f&&f.coordsToLatLng||Ko,Tt,zt,tn,En;if(!T&&!w)return null;switch(w.type){case"Point":return Tt=at(T),Zo(_e,s,Tt,f);case"MultiPoint":for(tn=0,En=T.length;tn<En;tn++)Tt=at(T[tn]),Z.push(Zo(_e,s,Tt,f));return new Ms(Z);case"LineString":case"MultiLineString":return zt=_s(T,w.type==="LineString"?0:1,at),new Ts(zt,f);case"Polygon":case"MultiPolygon":return zt=_s(T,w.type==="Polygon"?1:2,at),new ns(zt,f);case"GeometryCollection":for(tn=0,En=w.geometries.length;tn<En;tn++){var Un=ys({geometry:w.geometries[tn],type:"Feature",properties:s.properties},f);Un&&Z.push(Un)}return new Ms(Z);case"FeatureCollection":for(tn=0,En=w.features.length;tn<En;tn++){var gi=ys(w.features[tn],f);gi&&Z.push(gi)}return new Ms(Z);default:throw new Error("Invalid GeoJSON object.")}}function Zo(s,f,w,T){return s?s(f,w):new Hr(w,T&&T.markersInheritOptions&&T)}function Ko(s){return new H(s[1],s[0],s[2])}function _s(s,f,w){for(var T=[],Z=0,_e=s.length,at;Z<_e;Z++)at=f?_s(s[Z],f-1,w):(w||Ko)(s[Z]),T.push(at);return T}function os(s,f){return s=he(s),s.alt!==void 0?[E(s.lng,f),E(s.lat,f),E(s.alt,f)]:[E(s.lng,f),E(s.lat,f)]}function Bo(s,f,w,T){for(var Z=[],_e=0,at=s.length;_e<at;_e++)Z.push(f?Bo(s[_e],kn(s[_e])?0:f-1,w,T):os(s[_e],T));return!f&&w&&Z.length>0&&Z.push(Z[0].slice()),Z}function no(s,f){return s.feature?r({},s.feature,{geometry:f}):bs(f)}function bs(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var bt={toGeoJSON:function(s){return no(this,{type:"Point",coordinates:os(this.getLatLng(),s)})}};Hr.include(bt),ms.include(bt),zs.include(bt),Ts.include({toGeoJSON:function(s){var f=!kn(this._latlngs),w=Bo(this._latlngs,f?1:0,!1,s);return no(this,{type:(f?"Multi":"")+"LineString",coordinates:w})}}),ns.include({toGeoJSON:function(s){var f=!kn(this._latlngs),w=f&&!kn(this._latlngs[0]),T=Bo(this._latlngs,w?2:f?1:0,!0,s);return f||(T=[T]),no(this,{type:(w?"Multi":"")+"Polygon",coordinates:T})}}),gs.include({toMultiPoint:function(s){var f=[];return this.eachLayer(function(w){f.push(w.toGeoJSON(s).geometry.coordinates)}),no(this,{type:"MultiPoint",coordinates:f})},toGeoJSON:function(s){var f=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(f==="MultiPoint")return this.toMultiPoint(s);var w=f==="GeometryCollection",T=[];return this.eachLayer(function(Z){if(Z.toGeoJSON){var _e=Z.toGeoJSON(s);if(w)T.push(_e.geometry);else{var at=bs(_e);at.type==="FeatureCollection"?T.push.apply(T,at.features):T.push(at)}}}),w?no(this,{geometries:T,type:"GeometryCollection"}):{type:"FeatureCollection",features:T}}});function qt(s,f){return new vs(s,f)}var Bt=qt,Cn=yi.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,f,w){this._url=s,this._bounds=B(f),$(this,w)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ln(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){jn(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&Ps(this._image),this},bringToBack:function(){return this._map&&Tr(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=B(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",f=this._image=s?this._url:Xn("img");if(ln(f,"leaflet-image-layer"),this._zoomAnimated&&ln(f,"leaflet-zoom-animated"),this.options.className&&ln(f,this.options.className),f.onselectstart=x,f.onmousemove=x,f.onload=l(this.fire,this,"load"),f.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(f.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=f.src;return}f.src=this._url,f.alt=this.options.alt},_animateZoom:function(s){var f=this._map.getZoomScale(s.zoom),w=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;ho(this._image,w,f)},_reset:function(){var s=this._image,f=new ot(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),w=f.getSize();ar(s,f.min),s.style.width=w.x+"px",s.style.height=w.y+"px"},_updateOpacity:function(){pr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),In=function(s,f,w){return new Cn(s,f,w)},si=Cn.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",f=this._image=s?this._url:Xn("video");if(ln(f,"leaflet-image-layer"),this._zoomAnimated&&ln(f,"leaflet-zoom-animated"),this.options.className&&ln(f,this.options.className),f.onselectstart=x,f.onmousemove=x,f.onloadeddata=l(this.fire,this,"load"),s){for(var w=f.getElementsByTagName("source"),T=[],Z=0;Z<w.length;Z++)T.push(w[Z].src);this._url=w.length>0?T:[f.src];return}me(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(f.style,"objectFit")&&(f.style.objectFit="fill"),f.autoplay=!!this.options.autoplay,f.loop=!!this.options.loop,f.muted=!!this.options.muted,f.playsInline=!!this.options.playsInline;for(var _e=0;_e<this._url.length;_e++){var at=Xn("source");at.src=this._url[_e],f.appendChild(at)}}});function _r(s,f,w){return new si(s,f,w)}var Yi=Cn.extend({_initImage:function(){var s=this._image=this._url;ln(s,"leaflet-image-layer"),this._zoomAnimated&&ln(s,"leaflet-zoom-animated"),this.options.className&&ln(s,this.options.className),s.onselectstart=x,s.onmousemove=x}});function el(s,f,w){return new Yi(s,f,w)}var Bs=yi.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,f){s&&(s instanceof H||me(s))?(this._latlng=he(s),$(this,f)):($(this,s),this._source=f),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&pr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&pr(this._container,1),this.bringToFront(),this.options.interactive&&(ln(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(pr(this._container,0),this._removeTimeout=setTimeout(l(jn,void 0,this._container),200)):jn(this._container),this.options.interactive&&(Jn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=he(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Ps(this._container),this},bringToBack:function(){return this._map&&Tr(this._container),this},_prepareOpen:function(s){var f=this._source;if(!f._map)return!1;if(f instanceof Ms){f=null;var w=this._source._layers;for(var T in w)if(w[T]._map){f=w[T];break}if(!f)return!1;this._source=f}if(!s)if(f.getCenter)s=f.getCenter();else if(f.getLatLng)s=f.getLatLng();else if(f.getBounds)s=f.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,f=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof f=="string")s.innerHTML=f;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(f)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),f=Me(this.options.offset),w=this._getAnchor();this._zoomAnimated?ar(this._container,s.add(w)):f=f.add(s).add(w);var T=this._containerBottom=-f.y,Z=this._containerLeft=-Math.round(this._containerWidth/2)+f.x;this._container.style.bottom=T+"px",this._container.style.left=Z+"px"}},_getAnchor:function(){return[0,0]}});Si.include({_initOverlay:function(s,f,w,T){var Z=f;return Z instanceof s||(Z=new s(T).setContent(f)),w&&Z.setLatLng(w),Z}}),yi.include({_initOverlay:function(s,f,w,T){var Z=w;return Z instanceof s?($(Z,T),Z._source=this):(Z=f&&!T?f:new s(T,this),Z.setContent(w)),Z}});var br=Bs.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,Bs.prototype.openOn.call(this,s)},onAdd:function(s){Bs.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof to||this._source.on("preclick",ha))},onRemove:function(s){Bs.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof to||this._source.off("preclick",ha))},getEvents:function(){var s=Bs.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",f=this._container=Xn("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),w=this._wrapper=Xn("div",s+"-content-wrapper",f);if(this._contentNode=Xn("div",s+"-content",w),Wa(f),Nl(this._contentNode),li(f,"contextmenu",ha),this._tipContainer=Xn("div",s+"-tip-container",f),this._tip=Xn("div",s+"-tip",this._tipContainer),this.options.closeButton){var T=this._closeButton=Xn("a",s+"-close-button",f);T.setAttribute("role","button"),T.setAttribute("aria-label","Close popup"),T.href="#close",T.innerHTML='<span aria-hidden="true">&#215;</span>',li(T,"click",function(Z){oi(Z),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,f=s.style;f.width="",f.whiteSpace="nowrap";var w=s.offsetWidth;w=Math.min(w,this.options.maxWidth),w=Math.max(w,this.options.minWidth),f.width=w+1+"px",f.whiteSpace="",f.height="";var T=s.offsetHeight,Z=this.options.maxHeight,_e="leaflet-popup-scrolled";Z&&T>Z?(f.height=Z+"px",ln(s,_e)):Jn(s,_e),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var f=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),w=this._getAnchor();ar(this._container,f.add(w))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,f=parseInt(ii(this._container,"marginBottom"),10)||0,w=this._container.offsetHeight+f,T=this._containerWidth,Z=new re(this._containerLeft,-w-this._containerBottom);Z._add(Es(this._container));var _e=s.layerPointToContainerPoint(Z),at=Me(this.options.autoPanPadding),Tt=Me(this.options.autoPanPaddingTopLeft||at),zt=Me(this.options.autoPanPaddingBottomRight||at),tn=s.getSize(),En=0,Un=0;_e.x+T+zt.x>tn.x&&(En=_e.x+T-tn.x+zt.x),_e.x-En-Tt.x<0&&(En=_e.x-Tt.x),_e.y+w+zt.y>tn.y&&(Un=_e.y+w-tn.y+zt.y),_e.y-Un-Tt.y<0&&(Un=_e.y-Tt.y),(En||Un)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([En,Un]))}},_getAnchor:function(){return Me(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),No=function(s,f){return new br(s,f)};Si.mergeOptions({closePopupOnClick:!0}),Si.include({openPopup:function(s,f,w){return this._initOverlay(br,s,f,w).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),yi.include({bindPopup:function(s,f){return this._popup=this._initOverlay(br,this._popup,s,f),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof Ms||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){wi(s);var f=s.layer||s.target;if(this._popup._source===f&&!(f instanceof to)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=f,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var Jo=Bs.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){Bs.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){Bs.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=Bs.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",f=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Xn("div",f),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+g(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var f,w,T=this._map,Z=this._container,_e=T.latLngToContainerPoint(T.getCenter()),at=T.layerPointToContainerPoint(s),Tt=this.options.direction,zt=Z.offsetWidth,tn=Z.offsetHeight,En=Me(this.options.offset),Un=this._getAnchor();Tt==="top"?(f=zt/2,w=tn):Tt==="bottom"?(f=zt/2,w=0):Tt==="center"?(f=zt/2,w=tn/2):Tt==="right"?(f=0,w=tn/2):Tt==="left"?(f=zt,w=tn/2):at.x<_e.x?(Tt="right",f=0,w=tn/2):(Tt="left",f=zt+(En.x+Un.x)*2,w=tn/2),s=s.subtract(Me(f,w,!0)).add(En).add(Un),Jn(Z,"leaflet-tooltip-right"),Jn(Z,"leaflet-tooltip-left"),Jn(Z,"leaflet-tooltip-top"),Jn(Z,"leaflet-tooltip-bottom"),ln(Z,"leaflet-tooltip-"+Tt),ar(Z,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&pr(this._container,s)},_animateZoom:function(s){var f=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(f)},_getAnchor:function(){return Me(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Ro=function(s,f){return new Jo(s,f)};Si.include({openTooltip:function(s,f,w){return this._initOverlay(Jo,s,f,w).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),yi.include({bindTooltip:function(s,f){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Jo,this._tooltip,s,f),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var f=s?"off":"on",w={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?w.add=this._openTooltip:(w.mouseover=this._openTooltip,w.mouseout=this.closeTooltip,w.click=this._openTooltip,this._map?this._addFocusListeners():w.add=this._addFocusListeners),this._tooltip.options.sticky&&(w.mousemove=this._moveTooltip),this[f](w),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof Ms||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var f=typeof s.getElement=="function"&&s.getElement();f&&(li(f,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),li(f,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var f=typeof s.getElement=="function"&&s.getElement();f&&f.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var f=this;this._map.once("moveend",function(){f._openOnceFlag=!1,f._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var f=s.latlng,w,T;this._tooltip.options.sticky&&s.originalEvent&&(w=this._map.mouseEventToContainerPoint(s.originalEvent),T=this._map.containerPointToLayerPoint(w),f=this._map.layerPointToLatLng(T)),this._tooltip.setLatLng(f)}});var Do=ko.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var f=s&&s.tagName==="DIV"?s:document.createElement("div"),w=this.options;if(w.html instanceof Element?(rs(f),f.appendChild(w.html)):f.innerHTML=w.html!==!1?w.html:"",w.bgPos){var T=Me(w.bgPos);f.style.backgroundPosition=-T.x+"px "+-T.y+"px"}return this._setIconStyles(f,"icon"),f},createShadow:function(){return null}});function Oo(s){return new Do(s)}ko.Default=da;var Pi=yi.extend({options:{tileSize:256,opacity:1,updateWhenIdle:yn.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){$(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),jn(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Ps(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Tr(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=v(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof re?s:new re(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var f=this.getPane().children,w=-s(-1/0,1/0),T=0,Z=f.length,_e;T<Z;T++)_e=f[T].style.zIndex,f[T]!==this._container&&_e&&(w=s(w,+_e));isFinite(w)&&(this.options.zIndex=w+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!yn.ielt9){pr(this._container,this.options.opacity);var s=+new Date,f=!1,w=!1;for(var T in this._tiles){var Z=this._tiles[T];if(!(!Z.current||!Z.loaded)){var _e=Math.min(1,(s-Z.loaded)/200);pr(Z.el,_e),_e<1?f=!0:(Z.active?w=!0:this._onOpaqueTile(Z),Z.active=!0)}}w&&!this._noPrune&&this._pruneTiles(),f&&(R(this._fadeFrame),this._fadeFrame=z(this._updateOpacity,this))}},_onOpaqueTile:x,_initContainer:function(){this._container||(this._container=Xn("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,f=this.options.maxZoom;if(s!==void 0){for(var w in this._levels)w=Number(w),this._levels[w].el.children.length||w===s?(this._levels[w].el.style.zIndex=f-Math.abs(s-w),this._onUpdateLevel(w)):(jn(this._levels[w].el),this._removeTilesAtZoom(w),this._onRemoveLevel(w),delete this._levels[w]);var T=this._levels[s],Z=this._map;return T||(T=this._levels[s]={},T.el=Xn("div","leaflet-tile-container leaflet-zoom-animated",this._container),T.el.style.zIndex=f,T.origin=Z.project(Z.unproject(Z.getPixelOrigin()),s).round(),T.zoom=s,this._setZoomTransform(T,Z.getCenter(),Z.getZoom()),x(T.el.offsetWidth),this._onCreateLevel(T)),this._level=T,T}},_onUpdateLevel:x,_onRemoveLevel:x,_onCreateLevel:x,_pruneTiles:function(){if(this._map){var s,f,w=this._map.getZoom();if(w>this.options.maxZoom||w<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)f=this._tiles[s],f.retain=f.current;for(s in this._tiles)if(f=this._tiles[s],f.current&&!f.active){var T=f.coords;this._retainParent(T.x,T.y,T.z,T.z-5)||this._retainChildren(T.x,T.y,T.z,T.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var f in this._tiles)this._tiles[f].coords.z===s&&this._removeTile(f)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)jn(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,f,w,T){var Z=Math.floor(s/2),_e=Math.floor(f/2),at=w-1,Tt=new re(+Z,+_e);Tt.z=+at;var zt=this._tileCoordsToKey(Tt),tn=this._tiles[zt];return tn&&tn.active?(tn.retain=!0,!0):(tn&&tn.loaded&&(tn.retain=!0),at>T?this._retainParent(Z,_e,at,T):!1)},_retainChildren:function(s,f,w,T){for(var Z=2*s;Z<2*s+2;Z++)for(var _e=2*f;_e<2*f+2;_e++){var at=new re(Z,_e);at.z=w+1;var Tt=this._tileCoordsToKey(at),zt=this._tiles[Tt];if(zt&&zt.active){zt.retain=!0;continue}else zt&&zt.loaded&&(zt.retain=!0);w+1<T&&this._retainChildren(Z,_e,w+1,T)}},_resetView:function(s){var f=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),f,f)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var f=this.options;return f.minNativeZoom!==void 0&&s<f.minNativeZoom?f.minNativeZoom:f.maxNativeZoom!==void 0&&f.maxNativeZoom<s?f.maxNativeZoom:s},_setView:function(s,f,w,T){var Z=Math.round(f);this.options.maxZoom!==void 0&&Z>this.options.maxZoom||this.options.minZoom!==void 0&&Z<this.options.minZoom?Z=void 0:Z=this._clampZoom(Z);var _e=this.options.updateWhenZooming&&Z!==this._tileZoom;(!T||_e)&&(this._tileZoom=Z,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),Z!==void 0&&this._update(s),w||this._pruneTiles(),this._noPrune=!!w),this._setZoomTransforms(s,f)},_setZoomTransforms:function(s,f){for(var w in this._levels)this._setZoomTransform(this._levels[w],s,f)},_setZoomTransform:function(s,f,w){var T=this._map.getZoomScale(w,s.zoom),Z=s.origin.multiplyBy(T).subtract(this._map._getNewPixelOrigin(f,w)).round();yn.any3d?ho(s.el,Z,T):ar(s.el,Z)},_resetGrid:function(){var s=this._map,f=s.options.crs,w=this._tileSize=this.getTileSize(),T=this._tileZoom,Z=this._map.getPixelWorldBounds(this._tileZoom);Z&&(this._globalTileRange=this._pxBoundsToTileRange(Z)),this._wrapX=f.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,f.wrapLng[0]],T).x/w.x),Math.ceil(s.project([0,f.wrapLng[1]],T).x/w.y)],this._wrapY=f.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([f.wrapLat[0],0],T).y/w.x),Math.ceil(s.project([f.wrapLat[1],0],T).y/w.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var f=this._map,w=f._animatingZoom?Math.max(f._animateToZoom,f.getZoom()):f.getZoom(),T=f.getZoomScale(w,this._tileZoom),Z=f.project(s,this._tileZoom).floor(),_e=f.getSize().divideBy(T*2);return new ot(Z.subtract(_e),Z.add(_e))},_update:function(s){var f=this._map;if(f){var w=this._clampZoom(f.getZoom());if(s===void 0&&(s=f.getCenter()),this._tileZoom!==void 0){var T=this._getTiledPixelBounds(s),Z=this._pxBoundsToTileRange(T),_e=Z.getCenter(),at=[],Tt=this.options.keepBuffer,zt=new ot(Z.getBottomLeft().subtract([Tt,-Tt]),Z.getTopRight().add([Tt,-Tt]));if(!(isFinite(Z.min.x)&&isFinite(Z.min.y)&&isFinite(Z.max.x)&&isFinite(Z.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var tn in this._tiles){var En=this._tiles[tn].coords;(En.z!==this._tileZoom||!zt.contains(new re(En.x,En.y)))&&(this._tiles[tn].current=!1)}if(Math.abs(w-this._tileZoom)>1){this._setView(s,w);return}for(var Un=Z.min.y;Un<=Z.max.y;Un++)for(var gi=Z.min.x;gi<=Z.max.x;gi++){var Zr=new re(gi,Un);if(Zr.z=this._tileZoom,!!this._isValidTile(Zr)){var Ar=this._tiles[this._tileCoordsToKey(Zr)];Ar?Ar.current=!0:at.push(Zr)}}if(at.sort(function(wr,$s){return wr.distanceTo(_e)-$s.distanceTo(_e)}),at.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var cs=document.createDocumentFragment();for(gi=0;gi<at.length;gi++)this._addTile(at[gi],cs);this._level.el.appendChild(cs)}}}},_isValidTile:function(s){var f=this._map.options.crs;if(!f.infinite){var w=this._globalTileRange;if(!f.wrapLng&&(s.x<w.min.x||s.x>w.max.x)||!f.wrapLat&&(s.y<w.min.y||s.y>w.max.y))return!1}if(!this.options.bounds)return!0;var T=this._tileCoordsToBounds(s);return B(this.options.bounds).overlaps(T)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var f=this._map,w=this.getTileSize(),T=s.scaleBy(w),Z=T.add(w),_e=f.unproject(T,s.z),at=f.unproject(Z,s.z);return[_e,at]},_tileCoordsToBounds:function(s){var f=this._tileCoordsToNwSe(s),w=new Ee(f[0],f[1]);return this.options.noWrap||(w=this._map.wrapLatLngBounds(w)),w},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var f=s.split(":"),w=new re(+f[0],+f[1]);return w.z=+f[2],w},_removeTile:function(s){var f=this._tiles[s];f&&(jn(f.el),delete this._tiles[s],this.fire("tileunload",{tile:f.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){ln(s,"leaflet-tile");var f=this.getTileSize();s.style.width=f.x+"px",s.style.height=f.y+"px",s.onselectstart=x,s.onmousemove=x,yn.ielt9&&this.options.opacity<1&&pr(s,this.options.opacity)},_addTile:function(s,f){var w=this._getTilePos(s),T=this._tileCoordsToKey(s),Z=this.createTile(this._wrapCoords(s),l(this._tileReady,this,s));this._initTile(Z),this.createTile.length<2&&z(l(this._tileReady,this,s,null,Z)),ar(Z,w),this._tiles[T]={el:Z,coords:s,current:!0},f.appendChild(Z),this.fire("tileloadstart",{tile:Z,coords:s})},_tileReady:function(s,f,w){f&&this.fire("tileerror",{error:f,tile:w,coords:s});var T=this._tileCoordsToKey(s);w=this._tiles[T],w&&(w.loaded=+new Date,this._map._fadeAnimated?(pr(w.el,0),R(this._fadeFrame),this._fadeFrame=z(this._updateOpacity,this)):(w.active=!0,this._pruneTiles()),f||(ln(w.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:w.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),yn.ielt9||!this._map._fadeAnimated?z(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var f=new re(this._wrapX?_(s.x,this._wrapX):s.x,this._wrapY?_(s.y,this._wrapY):s.y);return f.z=s.z,f},_pxBoundsToTileRange:function(s){var f=this.getTileSize();return new ot(s.min.unscaleBy(f).floor(),s.max.unscaleBy(f).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function yo(s){return new Pi(s)}var as=Pi.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,f){this._url=s,f=$(this,f),f.detectRetina&&yn.retina&&f.maxZoom>0?(f.tileSize=Math.floor(f.tileSize/2),f.zoomReverse?(f.zoomOffset--,f.minZoom=Math.min(f.maxZoom,f.minZoom+1)):(f.zoomOffset++,f.maxZoom=Math.max(f.minZoom,f.maxZoom-1)),f.minZoom=Math.max(0,f.minZoom)):f.zoomReverse?f.minZoom=Math.min(f.maxZoom,f.minZoom):f.maxZoom=Math.max(f.minZoom,f.maxZoom),typeof f.subdomains=="string"&&(f.subdomains=f.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,f){return this._url===s&&f===void 0&&(f=!0),this._url=s,f||this.redraw(),this},createTile:function(s,f){var w=document.createElement("img");return li(w,"load",l(this._tileOnLoad,this,f,w)),li(w,"error",l(this._tileOnError,this,f,w)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(w.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(w.referrerPolicy=this.options.referrerPolicy),w.alt="",w.src=this.getTileUrl(s),w},getTileUrl:function(s){var f={r:yn.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var w=this._globalTileRange.max.y-s.y;this.options.tms&&(f.y=w),f["-y"]=w}return G(this._url,r(f,this.options))},_tileOnLoad:function(s,f){yn.ielt9?setTimeout(l(s,this,null,f),0):s(null,f)},_tileOnError:function(s,f,w){var T=this.options.errorTileUrl;T&&f.getAttribute("src")!==T&&(f.src=T),s(w,f)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,f=this.options.maxZoom,w=this.options.zoomReverse,T=this.options.zoomOffset;return w&&(s=f-s),s+T},_getSubdomain:function(s){var f=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[f]},_abortLoading:function(){var s,f;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(f=this._tiles[s].el,f.onload=x,f.onerror=x,!f.complete)){f.src=Ie;var w=this._tiles[s].coords;jn(f),delete this._tiles[s],this.fire("tileabort",{tile:f,coords:w})}},_removeTile:function(s){var f=this._tiles[s];if(f)return f.el.setAttribute("src",Ie),Pi.prototype._removeTile.call(this,s)},_tileReady:function(s,f,w){if(!(!this._map||w&&w.getAttribute("src")===Ie))return Pi.prototype._tileReady.call(this,s,f,w)}});function Xi(s,f){return new as(s,f)}var nr=as.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,f){this._url=s;var w=r({},this.defaultWmsParams);for(var T in f)T in this.options||(w[T]=f[T]);f=$(this,f);var Z=f.detectRetina&&yn.retina?2:1,_e=this.getTileSize();w.width=_e.x*Z,w.height=_e.y*Z,this.wmsParams=w},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var f=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[f]=this._crs.code,as.prototype.onAdd.call(this,s)},getTileUrl:function(s){var f=this._tileCoordsToNwSe(s),w=this._crs,T=X(w.project(f[0]),w.project(f[1])),Z=T.min,_e=T.max,at=(this._wmsVersion>=1.3&&this._crs===Gr?[Z.y,Z.x,_e.y,_e.x]:[Z.x,Z.y,_e.x,_e.y]).join(","),Tt=as.prototype.getTileUrl.call(this,s);return Tt+Q(this.wmsParams,Tt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+at},setParams:function(s,f){return r(this.wmsParams,s),f||this.redraw(),this}});function Ir(s,f){return new nr(s,f)}as.WMS=nr,Xi.wms=Ir;var lr=yi.extend({options:{padding:.1},initialize:function(s){$(this,s),g(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ln(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,f){var w=this._map.getZoomScale(f,this._zoom),T=this._map.getSize().multiplyBy(.5+this.options.padding),Z=this._map.project(this._center,f),_e=T.multiplyBy(-w).add(Z).subtract(this._map._getNewPixelOrigin(s,f));yn.any3d?ho(this._container,_e,w):ar(this._container,_e)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,f=this._map.getSize(),w=this._map.containerPointToLayerPoint(f.multiplyBy(-s)).round();this._bounds=new ot(w,w.add(f.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),io=lr.extend({options:{tolerance:0},getEvents:function(){var s=lr.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){lr.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");li(s,"mousemove",this._onMouseMove,this),li(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),li(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){R(this._redrawRequest),delete this._ctx,jn(this._container),Ri(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var f in this._layers)s=this._layers[f],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){lr.prototype._update.call(this);var s=this._bounds,f=this._container,w=s.getSize(),T=yn.retina?2:1;ar(f,s.min),f.width=T*w.x,f.height=T*w.y,f.style.width=w.x+"px",f.style.height=w.y+"px",yn.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){lr.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[g(s)]=s;var f=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=f),this._drawLast=f,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var f=s._order,w=f.next,T=f.prev;w?w.prev=T:this._drawLast=T,T?T.next=w:this._drawFirst=w,delete s._order,delete this._layers[g(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var f=s.options.dashArray.split(/[, ]+/),w=[],T,Z;for(Z=0;Z<f.length;Z++){if(T=Number(f[Z]),isNaN(T))return;w.push(T)}s.options._dashArray=w}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||z(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var f=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ot,this._redrawBounds.extend(s._pxBounds.min.subtract([f,f])),this._redrawBounds.extend(s._pxBounds.max.add([f,f]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var f=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,f.x,f.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,f=this._redrawBounds;if(this._ctx.save(),f){var w=f.getSize();this._ctx.beginPath(),this._ctx.rect(f.min.x,f.min.y,w.x,w.y),this._ctx.clip()}this._drawing=!0;for(var T=this._drawFirst;T;T=T.next)s=T.layer,(!f||s._pxBounds&&s._pxBounds.intersects(f))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,f){if(this._drawing){var w,T,Z,_e,at=s._parts,Tt=at.length,zt=this._ctx;if(Tt){for(zt.beginPath(),w=0;w<Tt;w++){for(T=0,Z=at[w].length;T<Z;T++)_e=at[w][T],zt[T?"lineTo":"moveTo"](_e.x,_e.y);f&&zt.closePath()}this._fillStroke(zt,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var f=s._point,w=this._ctx,T=Math.max(Math.round(s._radius),1),Z=(Math.max(Math.round(s._radiusY),1)||T)/T;Z!==1&&(w.save(),w.scale(1,Z)),w.beginPath(),w.arc(f.x,f.y/Z,T,0,Math.PI*2,!1),Z!==1&&w.restore(),this._fillStroke(w,s)}},_fillStroke:function(s,f){var w=f.options;w.fill&&(s.globalAlpha=w.fillOpacity,s.fillStyle=w.fillColor||w.color,s.fill(w.fillRule||"evenodd")),w.stroke&&w.weight!==0&&(s.setLineDash&&s.setLineDash(f.options&&f.options._dashArray||[]),s.globalAlpha=w.opacity,s.lineWidth=w.weight,s.strokeStyle=w.color,s.lineCap=w.lineCap,s.lineJoin=w.lineJoin,s.stroke())},_onClick:function(s){for(var f=this._map.mouseEventToLayerPoint(s),w,T,Z=this._drawFirst;Z;Z=Z.next)w=Z.layer,w.options.interactive&&w._containsPoint(f)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(w))&&(T=w);this._fireEvent(T?[T]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var f=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,f)}},_handleMouseOut:function(s){var f=this._hoveredLayer;f&&(Jn(this._container,"leaflet-interactive"),this._fireEvent([f],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,f){if(!this._mouseHoverThrottled){for(var w,T,Z=this._drawFirst;Z;Z=Z.next)w=Z.layer,w.options.interactive&&w._containsPoint(f)&&(T=w);T!==this._hoveredLayer&&(this._handleMouseOut(s),T&&(ln(this._container,"leaflet-interactive"),this._fireEvent([T],s,"mouseover"),this._hoveredLayer=T)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,f,w){this._map._fireDOMEvent(f,w||f.type,s)},_bringToFront:function(s){var f=s._order;if(f){var w=f.next,T=f.prev;if(w)w.prev=T;else return;T?T.next=w:w&&(this._drawFirst=w),f.prev=this._drawLast,this._drawLast.next=f,f.next=null,this._drawLast=f,this._requestRedraw(s)}},_bringToBack:function(s){var f=s._order;if(f){var w=f.next,T=f.prev;if(T)T.next=w;else return;w?w.prev=T:T&&(this._drawLast=T),f.prev=null,f.next=this._drawFirst,this._drawFirst.prev=f,this._drawFirst=f,this._requestRedraw(s)}}});function js(s){return yn.canvas?new io(s):null}var lo=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Dl={_initContainer:function(){this._container=Xn("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(lr.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var f=s._container=lo("shape");ln(f,"leaflet-vml-shape "+(this.options.className||"")),f.coordsize="1 1",s._path=lo("path"),f.appendChild(s._path),this._updateStyle(s),this._layers[g(s)]=s},_addPath:function(s){var f=s._container;this._container.appendChild(f),s.options.interactive&&s.addInteractiveTarget(f)},_removePath:function(s){var f=s._container;jn(f),s.removeInteractiveTarget(f),delete this._layers[g(s)]},_updateStyle:function(s){var f=s._stroke,w=s._fill,T=s.options,Z=s._container;Z.stroked=!!T.stroke,Z.filled=!!T.fill,T.stroke?(f||(f=s._stroke=lo("stroke")),Z.appendChild(f),f.weight=T.weight+"px",f.color=T.color,f.opacity=T.opacity,T.dashArray?f.dashStyle=me(T.dashArray)?T.dashArray.join(" "):T.dashArray.replace(/( *, *)/g," "):f.dashStyle="",f.endcap=T.lineCap.replace("butt","flat"),f.joinstyle=T.lineJoin):f&&(Z.removeChild(f),s._stroke=null),T.fill?(w||(w=s._fill=lo("fill")),Z.appendChild(w),w.color=T.fillColor||T.color,w.opacity=T.fillOpacity):w&&(Z.removeChild(w),s._fill=null)},_updateCircle:function(s){var f=s._point.round(),w=Math.round(s._radius),T=Math.round(s._radiusY||w);this._setPath(s,s._empty()?"M0 0":"AL "+f.x+","+f.y+" "+w+","+T+" 0,"+65535*360)},_setPath:function(s,f){s._path.v=f},_bringToFront:function(s){Ps(s._container)},_bringToBack:function(s){Tr(s._container)}},Io=yn.vml?lo:ye,Wr=lr.extend({_initContainer:function(){this._container=Io("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Io("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){jn(this._container),Ri(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){lr.prototype._update.call(this);var s=this._bounds,f=s.getSize(),w=this._container;(!this._svgSize||!this._svgSize.equals(f))&&(this._svgSize=f,w.setAttribute("width",f.x),w.setAttribute("height",f.y)),ar(w,s.min),w.setAttribute("viewBox",[s.min.x,s.min.y,f.x,f.y].join(" ")),this.fire("update")}},_initPath:function(s){var f=s._path=Io("path");s.options.className&&ln(f,s.options.className),s.options.interactive&&ln(f,"leaflet-interactive"),this._updateStyle(s),this._layers[g(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){jn(s._path),s.removeInteractiveTarget(s._path),delete this._layers[g(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var f=s._path,w=s.options;f&&(w.stroke?(f.setAttribute("stroke",w.color),f.setAttribute("stroke-opacity",w.opacity),f.setAttribute("stroke-width",w.weight),f.setAttribute("stroke-linecap",w.lineCap),f.setAttribute("stroke-linejoin",w.lineJoin),w.dashArray?f.setAttribute("stroke-dasharray",w.dashArray):f.removeAttribute("stroke-dasharray"),w.dashOffset?f.setAttribute("stroke-dashoffset",w.dashOffset):f.removeAttribute("stroke-dashoffset")):f.setAttribute("stroke","none"),w.fill?(f.setAttribute("fill",w.fillColor||w.color),f.setAttribute("fill-opacity",w.fillOpacity),f.setAttribute("fill-rule",w.fillRule||"evenodd")):f.setAttribute("fill","none"))},_updatePoly:function(s,f){this._setPath(s,le(s._parts,f))},_updateCircle:function(s){var f=s._point,w=Math.max(Math.round(s._radius),1),T=Math.max(Math.round(s._radiusY),1)||w,Z="a"+w+","+T+" 0 1,0 ",_e=s._empty()?"M0 0":"M"+(f.x-w)+","+f.y+Z+w*2+",0 "+Z+-w*2+",0 ";this._setPath(s,_e)},_setPath:function(s,f){s._path.setAttribute("d",f)},_bringToFront:function(s){Ps(s._path)},_bringToBack:function(s){Tr(s._path)}});yn.vml&&Wr.include(Dl);function or(s){return yn.svg||yn.vml?new Wr(s):null}Si.include({getRenderer:function(s){var f=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return f||(f=this._renderer=this._createRenderer()),this.hasLayer(f)||this.addLayer(f),f},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var f=this._paneRenderers[s];return f===void 0&&(f=this._createRenderer({pane:s}),this._paneRenderers[s]=f),f},_createRenderer:function(s){return this.options.preferCanvas&&js(s)||or(s)}});var ws=ns.extend({initialize:function(s,f){ns.prototype.initialize.call(this,this._boundsToLatLngs(s),f)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=B(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function Us(s,f){return new ws(s,f)}Wr.create=Io,Wr.pointsToPath=le,vs.geometryToLayer=ys,vs.coordsToLatLng=Ko,vs.coordsToLatLngs=_s,vs.latLngToCoords=os,vs.latLngsToCoords=Bo,vs.getFeature=no,vs.asFeature=bs,Si.mergeOptions({boxZoom:!0});var Yn=Zi.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){li(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ri(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){jn(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),oo(),ps(),this._startPoint=this._map.mouseEventToContainerPoint(s),li(document,{contextmenu:wi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=Xn("div","leaflet-zoom-box",this._container),ln(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var f=new ot(this._point,this._startPoint),w=f.getSize();ar(this._box,f.min),this._box.style.width=w.x+"px",this._box.style.height=w.y+"px"},_finish:function(){this._moved&&(jn(this._box),Jn(this._container,"leaflet-crosshair")),As(),fo(),Ri(document,{contextmenu:wi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var f=new Ee(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(f).fire("boxzoomend",{boxZoomBounds:f})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Si.addInitHook("addHandler","boxZoom",Yn),Si.mergeOptions({doubleClickZoom:!0});var Yo=Zi.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var f=this._map,w=f.getZoom(),T=f.options.zoomDelta,Z=s.originalEvent.shiftKey?w-T:w+T;f.options.doubleClickZoom==="center"?f.setZoom(Z):f.setZoomAround(s.containerPoint,Z)}});Si.addInitHook("addHandler","doubleClickZoom",Yo),Si.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Xo=Zi.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new mo(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}ln(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Jn(this._map._container,"leaflet-grab"),Jn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var f=B(this._map.options.maxBounds);this._offsetLimit=X(this._map.latLngToContainerPoint(f.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(f.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var f=this._lastTime=+new Date,w=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(w),this._times.push(f),this._prunePositions(f)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),f=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=f.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,f){return s-(s-f)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),f=this._offsetLimit;s.x<f.min.x&&(s.x=this._viscousLimit(s.x,f.min.x)),s.y<f.min.y&&(s.y=this._viscousLimit(s.y,f.min.y)),s.x>f.max.x&&(s.x=this._viscousLimit(s.x,f.max.x)),s.y>f.max.y&&(s.y=this._viscousLimit(s.y,f.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,f=Math.round(s/2),w=this._initialWorldOffset,T=this._draggable._newPos.x,Z=(T-f+w)%s+f-w,_e=(T+f+w)%s-f-w,at=Math.abs(Z+w)<Math.abs(_e+w)?Z:_e;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=at},_onDragEnd:function(s){var f=this._map,w=f.options,T=!w.inertia||s.noInertia||this._times.length<2;if(f.fire("dragend",s),T)f.fire("moveend");else{this._prunePositions(+new Date);var Z=this._lastPos.subtract(this._positions[0]),_e=(this._lastTime-this._times[0])/1e3,at=w.easeLinearity,Tt=Z.multiplyBy(at/_e),zt=Tt.distanceTo([0,0]),tn=Math.min(w.inertiaMaxSpeed,zt),En=Tt.multiplyBy(tn/zt),Un=tn/(w.inertiaDeceleration*at),gi=En.multiplyBy(-Un/2).round();!gi.x&&!gi.y?f.fire("moveend"):(gi=f._limitOffset(gi,f.options.maxBounds),z(function(){f.panBy(gi,{duration:Un,easeLinearity:at,noMoveStart:!0,animate:!0})}))}}});Si.addInitHook("addHandler","dragging",Xo),Si.mergeOptions({keyboard:!0,keyboardPanDelta:80});var _o=Zi.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),li(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ri(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,f=document.documentElement,w=s.scrollTop||f.scrollTop,T=s.scrollLeft||f.scrollLeft;this._map._container.focus(),window.scrollTo(T,w)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var f=this._panKeys={},w=this.keyCodes,T,Z;for(T=0,Z=w.left.length;T<Z;T++)f[w.left[T]]=[-1*s,0];for(T=0,Z=w.right.length;T<Z;T++)f[w.right[T]]=[s,0];for(T=0,Z=w.down.length;T<Z;T++)f[w.down[T]]=[0,s];for(T=0,Z=w.up.length;T<Z;T++)f[w.up[T]]=[0,-1*s]},_setZoomDelta:function(s){var f=this._zoomKeys={},w=this.keyCodes,T,Z;for(T=0,Z=w.zoomIn.length;T<Z;T++)f[w.zoomIn[T]]=s;for(T=0,Z=w.zoomOut.length;T<Z;T++)f[w.zoomOut[T]]=-s},_addHooks:function(){li(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ri(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var f=s.keyCode,w=this._map,T;if(f in this._panKeys){if(!w._panAnim||!w._panAnim._inProgress)if(T=this._panKeys[f],s.shiftKey&&(T=Me(T).multiplyBy(3)),w.options.maxBounds&&(T=w._limitOffset(Me(T),w.options.maxBounds)),w.options.worldCopyJump){var Z=w.wrapLatLng(w.unproject(w.project(w.getCenter()).add(T)));w.panTo(Z)}else w.panBy(T)}else if(f in this._zoomKeys)w.setZoom(w.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[f]);else if(f===27&&w._popup&&w._popup.options.closeOnEscapeKey)w.closePopup();else return;wi(s)}}});Si.addInitHook("addHandler","keyboard",_o),Si.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Ns=Zi.extend({addHooks:function(){li(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ri(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var f=hl(s),w=this._map.options.wheelDebounceTime;this._delta+=f,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var T=Math.max(w-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),T),wi(s)},_performZoom:function(){var s=this._map,f=s.getZoom(),w=this._map.options.zoomSnap||0;s._stop();var T=this._delta/(this._map.options.wheelPxPerZoomLevel*4),Z=4*Math.log(2/(1+Math.exp(-Math.abs(T))))/Math.LN2,_e=w?Math.ceil(Z/w)*w:Z,at=s._limitZoom(f+(this._delta>0?_e:-_e))-f;this._delta=0,this._startTime=null,at&&(s.options.scrollWheelZoom==="center"?s.setZoom(f+at):s.setZoomAround(this._lastMousePos,f+at))}});Si.addInitHook("addHandler","scrollWheelZoom",Ns);var ku=600;Si.mergeOptions({tapHold:yn.touchNative&&yn.safari&&yn.mobile,tapTolerance:15});var ls=Zi.extend({addHooks:function(){li(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ri(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var f=s.touches[0];this._startPos=this._newPos=new re(f.clientX,f.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(li(document,"touchend",oi),li(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",f))},this),ku),li(document,"touchend touchcancel contextmenu",this._cancel,this),li(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){Ri(document,"touchend",oi),Ri(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),Ri(document,"touchend touchcancel contextmenu",this._cancel,this),Ri(document,"touchmove",this._onMove,this)},_onMove:function(s){var f=s.touches[0];this._newPos=new re(f.clientX,f.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,f){var w=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:f.screenX,screenY:f.screenY,clientX:f.clientX,clientY:f.clientY});w._simulated=!0,f.target.dispatchEvent(w)}});Si.addInitHook("addHandler","tapHold",ls),Si.mergeOptions({touchZoom:yn.touch,bounceAtZoomLimits:!0});var us=Zi.extend({addHooks:function(){ln(this._map._container,"leaflet-touch-zoom"),li(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Jn(this._map._container,"leaflet-touch-zoom"),Ri(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var f=this._map;if(!(!s.touches||s.touches.length!==2||f._animatingZoom||this._zooming)){var w=f.mouseEventToContainerPoint(s.touches[0]),T=f.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=f.getSize()._divideBy(2),this._startLatLng=f.containerPointToLatLng(this._centerPoint),f.options.touchZoom!=="center"&&(this._pinchStartLatLng=f.containerPointToLatLng(w.add(T)._divideBy(2))),this._startDist=w.distanceTo(T),this._startZoom=f.getZoom(),this._moved=!1,this._zooming=!0,f._stop(),li(document,"touchmove",this._onTouchMove,this),li(document,"touchend touchcancel",this._onTouchEnd,this),oi(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var f=this._map,w=f.mouseEventToContainerPoint(s.touches[0]),T=f.mouseEventToContainerPoint(s.touches[1]),Z=w.distanceTo(T)/this._startDist;if(this._zoom=f.getScaleZoom(Z,this._startZoom),!f.options.bounceAtZoomLimits&&(this._zoom<f.getMinZoom()&&Z<1||this._zoom>f.getMaxZoom()&&Z>1)&&(this._zoom=f._limitZoom(this._zoom)),f.options.touchZoom==="center"){if(this._center=this._startLatLng,Z===1)return}else{var _e=w._add(T)._divideBy(2)._subtract(this._centerPoint);if(Z===1&&_e.x===0&&_e.y===0)return;this._center=f.unproject(f.project(this._pinchStartLatLng,this._zoom).subtract(_e),this._zoom)}this._moved||(f._moveStart(!0,!1),this._moved=!0),R(this._animRequest);var at=l(f._move,f,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=z(at,this,!0),oi(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,R(this._animRequest),Ri(document,"touchmove",this._onTouchMove,this),Ri(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Si.addInitHook("addHandler","touchZoom",us),Si.BoxZoom=Yn,Si.DoubleClickZoom=Yo,Si.Drag=Xo,Si.Keyboard=_o,Si.ScrollWheelZoom=Ns,Si.TapHold=ls,Si.TouchZoom=us,t.Bounds=ot,t.Browser=yn,t.CRS=te,t.Canvas=io,t.Circle=ms,t.CircleMarker=zs,t.Class=V,t.Control=Gn,t.DivIcon=Do,t.DivOverlay=Bs,t.DomEvent=Ka,t.DomUtil=ri,t.Draggable=mo,t.Evented=ce,t.FeatureGroup=Ms,t.GeoJSON=vs,t.GridLayer=Pi,t.Handler=Zi,t.Icon=ko,t.ImageOverlay=Cn,t.LatLng=H,t.LatLngBounds=Ee,t.Layer=yi,t.LayerGroup=gs,t.LineUtil=vi,t.Map=Si,t.Marker=Hr,t.Mixin=su,t.Path=to,t.Point=re,t.PolyUtil=Na,t.Polygon=ns,t.Polyline=Ts,t.Popup=br,t.PosAnimation=fl,t.Projection=Ji,t.Rectangle=ws,t.Renderer=lr,t.SVG=Wr,t.SVGOverlay=Yi,t.TileLayer=as,t.Tooltip=Jo,t.Transformation=Ce,t.Util=J,t.VideoOverlay=si,t.bind=l,t.bounds=X,t.canvas=js,t.circle=ks,t.circleMarker=Da,t.control=Rr,t.divIcon=Oo,t.extend=r,t.featureGroup=pl,t.geoJSON=qt,t.geoJson=Bt,t.gridLayer=yo,t.icon=Rl,t.imageOverlay=In,t.latLng=he,t.latLngBounds=B,t.layerGroup=Ra,t.map=Nr,t.marker=To,t.point=Me,t.polygon=Wo,t.polyline=ou,t.popup=No,t.rectangle=Us,t.setOptions=$,t.stamp=g,t.svg=or,t.svgOverlay=el,t.tileLayer=Xi,t.tooltip=Ro,t.transformation=ne,t.version=i,t.videoOverlay=_r;var bo=window.L;t.noConflict=function(){return window.L=bo,this},window.L=t})})(Ag,Ag.exports);var wt=Ag.exports;const hn=s4(wt);var hy={exports:{}};(function(e,n){(function(t,i){i(n)})(qo,function(t){var i=typeof window<"u"?window:typeof qo<"u"?qo:typeof self<"u"?self:{};function r(v,_){return v(_={exports:{}},_.exports),_.exports}var o=r(function(v,_){(function(x){const E={escape:function(U){return U.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},parseExtension:b,mimeType:function(U){return U=b(U).toLowerCase(),function(){var Y="application/font-woff",ce="image/jpeg";return{woff:Y,woff2:Y,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:ce,jpeg:ce,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}()[U]||""},dataAsUrl:function(U,Y){return`data:${Y};base64,`+U},isDataUrl:function(U){return U.search(/^(data:)/)!==-1},canvasToBlob:function(U){return U.toBlob?new Promise(function(ce){U.toBlob(ce)}):(Y=U,new Promise(function(ce){const re=Ve(Y.toDataURL().split(",")[1]);var Pe=re.length;const Me=new Uint8Array(Pe);for(let ot=0;ot<Pe;ot++)Me[ot]=re.charCodeAt(ot);ce(new Blob([Me],{type:"image/png"}))}));var Y},resolveUrl:function(U,Y){const ce=document.implementation.createHTMLDocument(),re=ce.createElement("base"),Pe=(ce.head.appendChild(re),ce.createElement("a"));return ce.body.appendChild(Pe),re.href=Y,Pe.href=U,Pe.href},getAndEncode:function(U){let Y=Ie.impl.urlCache.find(function(ce){return ce.url===U});return Y||(Y={url:U,promise:null},Ie.impl.urlCache.push(Y)),Y.promise===null&&(Ie.impl.options.cacheBust&&(U+=(/\?/.test(U)?"&":"?")+new Date().getTime()),Y.promise=new Promise(function(ce){const re=Ie.impl.options.httpTimeout,Pe=new XMLHttpRequest;let Me;var ot;function X(Ee){console.error(Ee),ce("")}Pe.onreadystatechange=function(){if(Pe.readyState===4)if(Pe.status!==200)Me?ce(Me):X(`cannot fetch resource: ${U}, status: `+Pe.status);else{const Ee=new FileReader;Ee.onloadend=function(){var B=Ee.result.split(/,/)[1];ce(B)},Ee.readAsDataURL(Pe.response)}},Pe.ontimeout=function(){Me?ce(Me):X(`timeout of ${re}ms occured while fetching resource: `+U)},Pe.responseType="blob",Pe.timeout=re,Ie.impl.options.useCredentials&&(Pe.withCredentials=!0),Pe.open("GET",U,!0),Pe.send(),Ie.impl.options.imagePlaceholder&&(ot=Ie.impl.options.imagePlaceholder.split(/,/))&&ot[1]&&(Me=ot[1])})),Y.promise},uid:function(){let U=0;return function(){return"u"+("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+U++}}(),delay:function(U){return function(Y){return new Promise(function(ce){setTimeout(function(){ce(Y)},U)})}},asArray:function(U){const Y=[],ce=U.length;for(let re=0;re<ce;re++)Y.push(U[re]);return Y},escapeXhtml:function(U){return U.replace(/%/g,"%25").replace(/#/g,"%23").replace(/\n/g,"%0A")},makeImage:function(U){return U!=="data:,"?new Promise(function(Y,ce){const re=new Image;Ie.impl.options.useCredentials&&(re.crossOrigin="use-credentials"),re.onload=function(){Y(re)},re.onerror=ce,re.src=U}):Promise.resolve()},width:function(U){var Y=D(U,"border-left-width"),ce=D(U,"border-right-width");return U.scrollWidth+Y+ce},height:function(U){var Y=D(U,"border-top-width"),ce=D(U,"border-bottom-width");return U.scrollHeight+Y+ce}};function b(U){return(U=/\.([^\.\/]*?)(\?|$)/g.exec(U))?U[1]:""}function D(U,Y){const ce=nt(U).getPropertyValue(Y);return parseFloat(ce.replace("px",""))}const $=function(){const U=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(Pe,Me,ot){return Y(Pe)?Promise.resolve(Pe).then(ce).then(function(X){let Ee=Promise.resolve(Pe);return X.forEach(function(B){Ee=Ee.then(function(H){return re(H,B,Me,ot)})}),Ee}):Promise.resolve(Pe)},shouldProcess:Y,impl:{readUrls:ce,inline:re}};function Y(Pe){return Pe.search(U)!==-1}function ce(Pe){const Me=[];for(var ot;(ot=U.exec(Pe))!==null;)Me.push(ot[1]);return Me.filter(function(X){return!E.isDataUrl(X)})}function re(Pe,Me,ot,X){return Promise.resolve(Me).then(function(Ee){return ot?E.resolveUrl(Ee,ot):Ee}).then(X||E.getAndEncode).then(function(Ee){return E.dataAsUrl(Ee,E.mimeType(Me))}).then(function(Ee){return Pe.replace((B=Me,new RegExp(`(url\\(['"]?)(${E.escape(B)})(['"]?\\))`,"g")),`$1${Ee}$3`);var B})}}(),Q={resolveAll:function(){return F().then(function(U){return Promise.all(U.map(function(Y){return Y.resolve()}))}).then(function(U){return U.join(`
`)})},impl:{readAll:F}};function F(){return Promise.resolve(E.asArray(document.styleSheets)).then(function(Y){const ce=[];return Y.forEach(function(re){if(Object.getPrototypeOf(re).hasOwnProperty("cssRules"))try{E.asArray(re.cssRules||[]).forEach(ce.push.bind(ce))}catch(Pe){console.log("Error while reading CSS rules from "+re.href,Pe.toString())}}),ce}).then(function(Y){return Y.filter(function(ce){return ce.type===CSSRule.FONT_FACE_RULE}).filter(function(ce){return $.shouldProcess(ce.style.getPropertyValue("src"))})}).then(function(Y){return Y.map(U)});function U(Y){return{resolve:function(){var ce=(Y.parentStyleSheet||{}).href;return $.inlineAll(Y.cssText,ce)},src:function(){return Y.style.getPropertyValue("src")}}}}const G={inlineAll:function U(Y){return Y instanceof Element?function(ce){const re=ce.style.getPropertyValue("background");return re?$.inlineAll(re).then(function(Pe){ce.style.setProperty("background",Pe,re)}).then(function(){return ce}):Promise.resolve(ce)}(Y).then(function(){return Y instanceof HTMLImageElement?me(Y).inline():Promise.all(E.asArray(Y.childNodes).map(function(ce){return U(ce)}))}):Promise.resolve(Y)},impl:{newImage:me}};function me(U){return{inline:function(Y){return E.isDataUrl(U.src)?Promise.resolve():Promise.resolve(U.src).then(Y||E.getAndEncode).then(function(ce){return E.dataAsUrl(ce,E.mimeType(U.src))}).then(function(ce){return new Promise(function(re){U.onload=re,U.onerror=re,U.src=ce})})}}}const Se={imagePlaceholder:void 0,cacheBust:!1,useCredentials:!1},Ie={toSvg:O,toPng:function(U,Y){return(Y=Y||{}).raster=!0,W(U,Y).then(function(ce){return ce.toDataURL()})},toJpeg:function(U,Y){return(Y=Y||{}).raster=!0,W(U,Y).then(function(ce){return ce.toDataURL("image/jpeg",Y.quality||1)})},toBlob:function(U,Y){return(Y=Y||{}).raster=!0,W(U,Y).then(E.canvasToBlob)},toPixelData:function(U,Y){return(Y=Y||{}).raster=!0,W(U,Y).then(function(ce){return ce.getContext("2d").getImageData(0,0,E.width(U),E.height(U)).data})},toCanvas:function(U,Y){return(Y=Y||{}).raster=!0,W(U,Y||{})},impl:{fontFaces:Q,images:G,util:E,inliner:$,urlCache:[],options:{}}},nt=(v.exports=Ie,x.getComputedStyle||window.getComputedStyle),Ve=x.atob||window.atob;function O(U,Y){var ce=Y=Y||{};return ce.imagePlaceholder===void 0?Ie.impl.options.imagePlaceholder=Se.imagePlaceholder:Ie.impl.options.imagePlaceholder=ce.imagePlaceholder,ce.cacheBust===void 0?Ie.impl.options.cacheBust=Se.cacheBust:Ie.impl.options.cacheBust=ce.cacheBust,ce.useCredentials===void 0?Ie.impl.options.useCredentials=Se.useCredentials:Ie.impl.options.useCredentials=ce.useCredentials,Promise.resolve(U).then(function(re){return function Pe(Me,ot,X,Ee,B=null){return X||!ot||ot(Me)?Promise.resolve(Me).then(function(H){return H instanceof HTMLCanvasElement?E.makeImage(H.toDataURL()):H.nodeName==="IFRAME"?html2canvas(H.contentDocument.body).then(he=>he.toDataURL()).then(E.makeImage):H.cloneNode(!1)}).then(function(H){return function(he,te){const ie=he.childNodes;return ie.length===0?Promise.resolve(te):function(ee,se){const Ce=nt(he);let ne=Promise.resolve();return se.forEach(function(ae){ne=ne.then(function(){return Pe(ae,ot,!1,Ee,Ce)}).then(function(xe){xe&&ee.appendChild(xe)})}),ne}(te,E.asArray(ie)).then(function(){return te})}(Me,H)}).then(function(H){return function(he,te,ie){return te instanceof Element?Promise.resolve().then(function(){(function(ee,se){const Ce=nt(ee);Ce.cssText?(se.style.cssText=Ce.cssText,function(ne,ae){ae.font=ne.font,ae.fontFamily=ne.fontFamily,ae.fontFeatureSettings=ne.fontFeatureSettings,ae.fontKerning=ne.fontKerning,ae.fontSize=ne.fontSize,ae.fontStretch=ne.fontStretch,ae.fontStyle=ne.fontStyle,ae.fontVariant=ne.fontVariant,ae.fontVariantCaps=ne.fontVariantCaps,ae.fontVariantEastAsian=ne.fontVariantEastAsian,ae.fontVariantLigatures=ne.fontVariantLigatures,ae.fontVariantNumeric=ne.fontVariantNumeric,ae.fontVariationSettings=ne.fontVariationSettings,ae.fontWeight=ne.fontWeight}(Ce,se.style)):(ie?function(ne,ae,xe,ye){const le=xe.style,je=ne.style;for(var Re of ae){var Ae=ae.getPropertyValue(Re),qe=je.getPropertyValue(Re),Oe=(je.setProperty(Re,ye?"initial":"unset"),ae.getPropertyValue(Re));Oe!==Ae?le.setProperty(Re,Ae):le.removeProperty(Re),je.setProperty(Re,qe)}}(ee,Ce,se,X):function(ne,ae,xe){const ye=function(je){if(V[je])return V[je];J||((J=document.createElement("iframe")).style.visibility="hidden",J.style.position="fixed",document.body.appendChild(J),J.contentWindow.document.write('<!DOCTYPE html><meta charset="UTF-8"><title>sandbox</title><body>'));const Re=document.createElement(je),Ae=(J.contentWindow.document.body.appendChild(Re),Re.textContent=".",J.contentWindow.getComputedStyle(Re)),qe={};return E.asArray(Ae).forEach(function(Oe){qe[Oe]=Oe==="width"||Oe==="height"?"auto":Ae.getPropertyValue(Oe)}),J.contentWindow.document.body.removeChild(Re),V[je]=qe}(xe.tagName),le=xe.style;E.asArray(ne).forEach(function(je){var Re=ne.getPropertyValue(je);(Re!==ye[je]||ae&&Re!==ae.getPropertyValue(je))&&le.setProperty(je,Re,ne.getPropertyPriority(je))})}(Ce,B,se),X&&(["inset-block","inset-block-start","inset-block-end"].forEach(ne=>se.style.removeProperty(ne)),["left","right","top","bottom"].forEach(ne=>{se.style.getPropertyValue(ne)&&se.style.setProperty(ne,"0px")})))})(he,te)}).then(function(){[":before",":after"].forEach(function(ee){(function(se){const Ce=nt(he,se),ne=Ce.getPropertyValue("content");if(ne!==""&&ne!=="none"){const ae=E.uid(),xe=te.getAttribute("class"),ye=(xe&&te.setAttribute("class",xe+" "+ae),document.createElement("style"));ye.appendChild(function(){const le=`.${ae}:`+se,je=(Ce.cssText?function(){return`${Ce.cssText} content: ${Ce.getPropertyValue("content")};`}:function(){return E.asArray(Ce).map(function(Re){return Re+": "+Ce.getPropertyValue(Re)+(Ce.getPropertyPriority(Re)?" !important":"")}).join("; ")+";"})();return document.createTextNode(le+`{${je}}`)}()),te.appendChild(ye)}})(ee)})}).then(function(){he instanceof HTMLTextAreaElement&&(te.innerHTML=he.value),he instanceof HTMLInputElement&&te.setAttribute("value",he.value)}).then(function(){te instanceof SVGElement&&(te.setAttribute("xmlns","http://www.w3.org/2000/svg"),te instanceof SVGRectElement&&["width","height"].forEach(function(ee){const se=te.getAttribute(ee);se&&te.style.setProperty(ee,se)}))}).then(function(){return te}):te}(Me,H,Ee)}):Promise.resolve()}(re,Y.filter,!0,!Y.raster)}).then(ue).then(z).then(function(re){Y.bgcolor&&(re.style.backgroundColor=Y.bgcolor),Y.width&&(re.style.width=Y.width+"px"),Y.height&&(re.style.height=Y.height+"px"),Y.style&&Object.keys(Y.style).forEach(function(Me){re.style[Me]=Y.style[Me]});let Pe=null;return typeof Y.onclone=="function"&&(Pe=Y.onclone(re)),Promise.resolve(Pe).then(function(){return re})}).then(function(re){return re=re,Pe=Y.width||E.width(U),Me=Y.height||E.height(U),Promise.resolve(re).then(function(ot){return ot.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(ot)}).then(E.escapeXhtml).then(function(ot){return`<foreignObject x="0" y="0" width="100%" height="100%">${ot}</foreignObject>`}).then(function(ot){return`<svg xmlns="http://www.w3.org/2000/svg" width="${Pe}" height="${Me}">${ot}</svg>`}).then(function(ot){return"data:image/svg+xml;charset=utf-8,"+ot});var Pe,Me}).then(function(re){return Ie.impl.urlCache=[],re})}function W(U,Y){return O(U,Y).then(E.makeImage).then(E.delay(0)).then(function(ce){var re=typeof Y.scale!="number"?1:Y.scale;const Pe=function(ot,X){const Ee=document.createElement("canvas");if(Ee.width=(Y.width||E.width(ot))*X,Ee.height=(Y.height||E.height(ot))*X,Y.bgcolor){const B=Ee.getContext("2d");B.fillStyle=Y.bgcolor,B.fillRect(0,0,Ee.width,Ee.height)}return Ee}(U,re),Me=Pe.getContext("2d");return Me.mozImageSmoothingEnabled=!1,Me.msImageSmoothingEnabled=!1,Me.imageSmoothingEnabled=!1,ce&&(Me.scale(re,re),Me.drawImage(ce,0,0)),J&&(document.body.removeChild(J),J=null,R&&clearTimeout(R),R=setTimeout(()=>{R=null,V={}},2e4)),Pe})}function ue(U){return Q.resolveAll().then(function(Y){const ce=document.createElement("style");return U.appendChild(ce),ce.appendChild(document.createTextNode(Y)),U})}function z(U){return G.inlineAll(U).then(function(){return U})}let R=null,J=null,V={}})(i)}),l=r(function(v,_){(function(){function x(Q,F,G){var me=new XMLHttpRequest;me.open("GET",Q),me.responseType="blob",me.onload=function(){$(me.response,F,G)},me.onerror=function(){console.error("could not download file")},me.send()}function E(Q){var F=new XMLHttpRequest;F.open("HEAD",Q,!1);try{F.send()}catch{}return 200<=F.status&&299>=F.status}function b(Q){try{Q.dispatchEvent(new MouseEvent("click"))}catch{var F=document.createEvent("MouseEvents");F.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),Q.dispatchEvent(F)}}var D=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof i=="object"&&i.global===i?i:void 0,$=D.saveAs||(typeof window!="object"||window!==D?function(){}:"download"in HTMLAnchorElement.prototype?function(Q,F,G){var me=D.URL||D.webkitURL,Se=document.createElement("a");F=F||Q.name||"download",Se.download=F,Se.rel="noopener",typeof Q=="string"?(Se.href=Q,Se.origin===location.origin?b(Se):E(Se.href)?x(Q,F,G):b(Se,Se.target="_blank")):(Se.href=me.createObjectURL(Q),setTimeout(function(){me.revokeObjectURL(Se.href)},4e4),setTimeout(function(){b(Se)},0))}:"msSaveOrOpenBlob"in navigator?function(Q,F,G){if(F=F||Q.name||"download",typeof Q!="string")navigator.msSaveOrOpenBlob(function(Se,Ie){return Ie===void 0?Ie={autoBom:!1}:typeof Ie!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),Ie={autoBom:!Ie}),Ie.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(Se.type)?new Blob(["\uFEFF",Se],{type:Se.type}):Se}(Q,G),F);else if(E(Q))x(Q,F,G);else{var me=document.createElement("a");me.href=Q,me.target="_blank",setTimeout(function(){b(me)})}}:function(Q,F,G,me){if((me=me||open("","_blank"))&&(me.document.title=me.document.body.innerText="downloading..."),typeof Q=="string")return x(Q,F,G);var Se=Q.type==="application/octet-stream",Ie=/constructor/i.test(D.HTMLElement)||D.safari,nt=/CriOS\/[\d]+/.test(navigator.userAgent);if((nt||Se&&Ie)&&typeof FileReader=="object"){var Ve=new FileReader;Ve.onloadend=function(){var ue=Ve.result;ue=nt?ue:ue.replace(/^data:[^;]*;/,"data:attachment/file;"),me?me.location.href=ue:location=ue,me=null},Ve.readAsDataURL(Q)}else{var O=D.URL||D.webkitURL,W=O.createObjectURL(Q);me?me.location=W:location.href=W,me=null,setTimeout(function(){O.revokeObjectURL(W)},4e4)}});D.saveAs=$.saveAs=$,v.exports=$})()}),h=L.Control.extend({options:{cropImageByInnerWH:!0,hidden:!1,domtoimageOptions:{},position:"topleft",screenName:"screen",iconUrl:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/PjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDMyIDMyIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAzMiAzMjsiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxnPjxnIGlkPSJjYW1lcmEiPjxwYXRoIHN0eWxlPSJmaWxsOiMwMTAwMDI7IiBkPSJNMTYsOS41MDFjLTQuNDE5LDAtOCwzLjU4MS04LDhjMCw0LjQxOCwzLjU4MSw4LDgsOGM0LjQxOCwwLDgtMy41ODIsOC04UzIwLjQxOCw5LjUwMSwxNiw5LjUwMXogTTIwLjU1NSwyMS40MDZjLTIuMTU2LDIuNTE2LTUuOTQzLDIuODA3LTguNDU5LDAuNjVjLTIuNTE3LTIuMTU2LTIuODA3LTUuOTQ0LTAuNjUtOC40NTljMi4xNTUtMi41MTcsNS45NDMtMi44MDcsOC40NTktMC42NUMyMi40MiwxNS4xMDIsMjIuNzExLDE4Ljg5MSwyMC41NTUsMjEuNDA2eiIvPjxwYXRoIHN0eWxlPSJmaWxsOiMwMTAwMDI7IiBkPSJNMTYsMTMuNTAxYy0yLjIwOSwwLTMuOTk5LDEuNzkxLTQsMy45OTl2MC4wMDJjMCwwLjI3NSwwLjIyNCwwLjUsMC41LDAuNXMwLjUtMC4yMjUsMC41LTAuNVYxNy41YzAuMDAxLTEuNjU2LDEuMzQzLTIuOTk5LDMtMi45OTljMC4yNzYsMCwwLjUtMC4yMjQsMC41LTAuNVMxNi4yNzYsMTMuNTAxLDE2LDEzLjUwMXoiLz48cGF0aCBzdHlsZT0iZmlsbDojMDEwMDAyOyIgZD0iTTI5LjQ5Miw4LjU0MmwtNC4zMzQtMC43MjNsLTEuMzczLTMuNDM0QzIzLjMyNiwzLjI0LDIyLjIzMiwyLjUsMjEsMi41SDExYy0xLjIzMiwwLTIuMzI2LDAuNzQtMi43ODYsMS44ODZMNi44NDIsNy44MTlMMi41MDksOC41NDJDMS4wNTUsOC43ODMsMCwxMC4wMjcsMCwxMS41djE1YzAsMS42NTQsMS4zNDYsMywzLDNoMjZjMS42NTQsMCwzLTEuMzQ2LDMtM3YtMTVDMzIsMTAuMDI3LDMwLjk0NSw4Ljc4MywyOS40OTIsOC41NDJ6IE0zMCwyNi41YzAsMC41NTMtMC40NDcsMS0xLDFIM2MtMC41NTMsMC0xLTAuNDQ3LTEtMXYtMTVjMC0wLjQ4OSwwLjM1NC0wLjkwNiwwLjgzNi0wLjk4Nkw4LjI4LDkuNjA3bDEuNzkxLTQuNDc4QzEwLjIyNCw0Ljc1LDEwLjU5MSw0LjUsMTEsNC41aDEwYzAuNDA4LDAsMC43NzUsMC4yNDksMC45MjgsMC42MjlsMS43OTEsNC40NzhsNS40NDUsMC45MDdDMjkuNjQ2LDEwLjU5NCwzMCwxMS4wMTEsMzAsMTEuNVYyNi41eiIvPjwvZz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PC9zdmc+",hideElementsWithSelectors:[".leaflet-control-container"],onCropBorderSize:2,caption:null,captionFontSize:15,captionFont:"Arial",captionColor:"black",captionBgColor:"white",captionOffset:5,mimeType:"image/png",debugMode:!1,preventDownload:!1,onPixelDataFail:function(v){var _=v.node,x=v.error;return console.warn("Map node is very big "+_.scrollWidth+"x"+_.scrollHeight),console.warn(`Add function: SimpleMapScreenshoter({
              onPixelDataFail: function({ node, plugin, error, mapPane, domtoimageOptions }) {
                 // Solutions:
                 // decrease size of map
                 // or decrease zoom level
                 // or remove elements with big distanses
                 // and after that return image in Promise - plugin._getPixelDataOfNormalMap
                 return plugin._getPixelDataOfNormalMap(domtoimageOptions)
              }
            })`),Promise.reject(x)}},onAdd:function(){return this._container=L.DomUtil.create("div","leaflet-control-simpleMapScreenshoter"),this._link=null,this._screenState={status:1,promise:null},this.options.hidden===!1&&this._addScreenBtn(),this._onUserStartInteractWithMap=this._onUserStartInteractWithMap.bind(this),this._onUserEndInteractWithMap=this._onUserEndInteractWithMap.bind(this),this._map.on("zoomstart",this._onUserStartInteractWithMap),this._map.on("move",this._onUserStartInteractWithMap),this._map.on("zoomend",this._onUserEndInteractWithMap),this._map.on("moveend",this._onUserEndInteractWithMap),this._container},takeScreen:function(){var v=this,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"blob",x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},E={};for(var b in this.options)x.hasOwnProperty(b)?E[b]=x[b]:E[b]=this.options[b];return this._screenState.status===2?this._screenState.promise:(this._map.fire("simpleMapScreenshoter.takeScreen"),this._screenState.status=2,this._setElementsVisible(!1),this._screenState.promise=this._waitEndOfInteractions().then(function(){return v._getPixelData(E)}).then(function(D){return v._setElementsVisible(!0),v._toCanvas(D,E)}).then(function(D){return _==="image"?v._canvasToImage(D,E):_==="canvas"?D:v._canvasToBlob(D,E)}).then(function(D){return v._screenState.status=1,v._map.fire("simpleMapScreenshoter.done"),D}).catch(function(D){return v._setElementsVisible(!0),v._screenState.status=1,v._map.fire("simpleMapScreenshoter.error",{e:D}),Promise.reject(D)}),this._screenState.promise)},_setElementsVisible:function(){var v=this,_=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.options.hideElementsWithSelectors.forEach(function(x){var E=v._map._container.querySelectorAll(x),b=!0,D=!1,$=void 0;try{for(var Q,F=E[Symbol.iterator]();!(b=(Q=F.next()).done);b=!0)Q.value.style.opacity=_===!1?0:1}catch(G){D=!0,$=G}finally{try{!b&&F.return&&F.return()}finally{if(D)throw $}}})},_canvasToImage:function(v,_){var x=_.mimeType,E=v.toDataURL(x);return E.indexOf("base64")===-1?Promise.reject(new Error("Base64 image generation error")):Promise.resolve(E)},_canvasToBlob:function(v,_){var x=_.mimeType;return new Promise(function(E,b){v.toBlob(function(D){E(D)},x)})},_toCanvas:function(v,_){var x=_.captionOffset,E=_.caption,b=_.captionFontSize,D=_.captionFont,$=_.captionColor,Q=_.captionBgColor,F=this._node,G=F.screenHeight,me=F.screenWidth,Se=document.createElement("canvas");Se.width=me,Se.height=G;for(var Ie=Se.getContext("2d"),nt=Ie.createImageData(me,G),Ve=0;Ve<v.length;++Ve)nt.data[Ve]=v[Ve];Ie.putImageData(nt,0,0),nt=null;var O=document.createElement("canvas"),W=O.getContext("2d"),ue=0,z=0,R=G,J=me;if(this.options.cropImageByInnerWH===!0){for(var V=[],U=0,Y=0;Y<G;++Y){U=0;for(var ce=0;ce<me;++ce)v[4*Y*me+4*ce+4]===0&&U++;U===me&&V.push(Y)}var re=this._getMinAndMaxOnValuesBreak(V);ue=re.min;for(var Pe=me,Me=re.max,ot=[],X=0,Ee=z;Ee<Pe;++Ee){X=0;for(var B=0;B<G;++B)v[4*B*me+4*Ee+4]===0&&X++;X===G&&ot.push(Ee)}var H=this._getMinAndMaxOnValuesBreak(ot);z=H.min,Pe=H.max,(z===0&&Pe===0||Pe===null)&&(Pe=me),(ue===0&&Me===0||Me===null)&&(Me=G),this.options.debugMode===!0&&(console.log("emptyYLine",V),console.log("minMaxY",re),console.log("emptyXLine",ot),console.log("minMaxX",H),console.log("debugX",{}),console.log("debugY",{})),ue===0&&Me===G&&z===0&&Pe===me||(ue+=this.options.onCropBorderSize,Me-=this.options.onCropBorderSize,z+=this.options.onCropBorderSize,Pe-=this.options.onCropBorderSize),R=Me-ue,J=Pe-z,O.width=J,O.height=R}else O.width=J,O.height=R;var he=null;return E&&(he=typeof E=="function"?E.call(this):E),he!==null&&(O.height=O.height+(x+b+x),W.beginPath(),W.rect(0,0,O.width,O.height),W.fillStyle=Q,W.fill(),W.save()),W.drawImage(Se,z,ue,J,R,0,0,J,R),he!==null&&(W.font=b+"px "+D,W.fillStyle=$,W.fillText(he,x,R+x+b)),Promise.resolve(O)},_getMinAndMaxOnValuesBreak:function(v){for(var _=0,x=0,E=!1,b=1;b<v.length;b++){if(v[b]-1!==v[b-1]){x=v[b],E=!0;break}_=v[b]}return E===!1&&v[0]>1?(_=0,x=v[0]):E===!1&&(_=v[v.length-1]||0,x=null),{min:_,max:x}},_getPixelData:function(v){var _=this,x=v.domtoimageOptions,E=x===void 0?{}:x;return this._getPixelDataOfNormalMap(E).catch(function(b){return console.warn("May be map size very big on that zoom level, we have error:",b.toString()),console.warn("You can manually hide map elements with large distances between them for fix that warn"),_._getPixelDataOfBigMap(E)})},_getPixelDataOfNormalMap:function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=this._map.getContainer();return this._node={node:_,screenHeight:_.scrollHeight,screenWidth:_.scrollWidth},o.toPixelData(_,v)},_getPixelDataOfBigMap:function(){var v=this,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},x=this._map.getContainer(),E=this._map.getPane("mapPane");E.style.width=2*x.clientWidth+"px",E.style.height=2*x.clientHeight+"px",E.style.overflow="hidden";var b=function(){E.style.width="initial",E.style.height="initial",E.style.overflow="initial"};return this._node={node:x,screenHeight:x.scrollHeight,screenWidth:x.scrollWidth},o.toPixelData(x,_).then(function(D){return b(),D}).catch(function(D){return b(),x.scrollHeight>=4e3||x.scrollWidth>=4e3?v.options.onPixelDataFail({plugin:v,node:x,mapPane:E,error:D,domtoimageOptions:_}):Promise.reject(D)})},_addScreenBtn:function(){this._link=L.DomUtil.create("a","leaflet-control-simpleMapScreenshoter-btn",this._container),this._addCss(),L.DomEvent.addListener(this._link,"click",this._onScreenBtn,this),L.DomEvent.disableClickPropagation(this._link)},_addCss:function(){var v=`
    .leaflet-control-simpleMapScreenshoter{
       border: 2px solid rgba(0,0,0,0.2);
       background-clip: padding-box;
    }
    .leaflet-control-simpleMapScreenshoter a{
       background-color: #fff;
       border-bottom: 1px solid #ccc;
       width: 30px;
       height: 30px;
       line-height: 30px;
       display: block;
       text-align: center;
       text-decoration: none;
       color: black;
       overflow: hidden;
       border-radius: 2px;
       background-image: url('`+this.options.iconUrl+`');
       background-position: 46% 41%;
       background-repeat: no-repeat;
       background-size: 63%;
    }
    .leaflet-control-simpleMapScreenshoter a:hover{
       cursor: pointer;
    }
    `,_=document.head||document.getElementsByTagName("head")[0],x=document.createElement("style");x.appendChild(document.createTextNode(v)),_.appendChild(x)},_onScreenBtn:function(){var v=this;this._map.fire("simpleMapScreenshoter.click"),this.options.preventDownload||this.takeScreen().then(function(_){var x=typeof v.options.screenName=="function"?v.options.screenName.call(v):v.options.screenName;l.saveAs(_,x+".png")}).catch(function(_){v._map.fire("simpleMapScreenshoter.error",{e:_})})},_onUserStartInteractWithMap:function(){this._interaction=!0},_onUserEndInteractWithMap:function(){this._interaction=!1},_waitEndOfInteractions:function(){var v=this;return new Promise(function(_){var x=setInterval(function(){v._interaction||(_(),clearInterval(x))},100)})}}),g=(L.Control.SimpleMapScreenshoter=h,L.simpleMapScreenshoter=function(v){return new L.Control.SimpleMapScreenshoter(v)},h);t.default=g,t.SimpleMapScreenshoter=h,Object.defineProperty(t,"__esModule",{value:!0})})})(hy,hy.exports);(()=>{var Ln,$n;var e=Object.create,n=Object.defineProperty,t=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,r=Object.getPrototypeOf,o=Object.prototype.hasOwnProperty,l=(a,c)=>()=>(c||a((c={exports:{}}).exports,c),c.exports),h=(a,c,p,y)=>{if(c&&typeof c=="object"||typeof c=="function")for(let C of i(c))!o.call(a,C)&&C!==p&&n(a,C,{get:()=>c[C],enumerable:!(y=t(c,C))||y.enumerable});return a},g=(a,c,p)=>(p=a!=null?e(r(a)):{},h(c||!a||!a.__esModule?n(p,"default",{value:a,enumerable:!0}):p,a)),v=l((a,c)=>{function p(){this.__data__=[],this.size=0}c.exports=p}),_=l((a,c)=>{function p(y,C){return y===C||y!==y&&C!==C}c.exports=p}),x=l((a,c)=>{var p=_();function y(C,k){for(var I=C.length;I--;)if(p(C[I][0],k))return I;return-1}c.exports=y}),E=l((a,c)=>{var p=x(),y=Array.prototype,C=y.splice;function k(I){var q=this.__data__,oe=p(q,I);if(oe<0)return!1;var ve=q.length-1;return oe==ve?q.pop():C.call(q,oe,1),--this.size,!0}c.exports=k}),b=l((a,c)=>{var p=x();function y(C){var k=this.__data__,I=p(k,C);return I<0?void 0:k[I][1]}c.exports=y}),D=l((a,c)=>{var p=x();function y(C){return p(this.__data__,C)>-1}c.exports=y}),$=l((a,c)=>{var p=x();function y(C,k){var I=this.__data__,q=p(I,C);return q<0?(++this.size,I.push([C,k])):I[q][1]=k,this}c.exports=y}),Q=l((a,c)=>{var p=v(),y=E(),C=b(),k=D(),I=$();function q(oe){var ve=-1,Ke=oe==null?0:oe.length;for(this.clear();++ve<Ke;){var $e=oe[ve];this.set($e[0],$e[1])}}q.prototype.clear=p,q.prototype.delete=y,q.prototype.get=C,q.prototype.has=k,q.prototype.set=I,c.exports=q}),F=l((a,c)=>{var p=Q();function y(){this.__data__=new p,this.size=0}c.exports=y}),G=l((a,c)=>{function p(y){var C=this.__data__,k=C.delete(y);return this.size=C.size,k}c.exports=p}),me=l((a,c)=>{function p(y){return this.__data__.get(y)}c.exports=p}),Se=l((a,c)=>{function p(y){return this.__data__.has(y)}c.exports=p}),Ie=l((a,c)=>{var p=typeof qo=="object"&&qo&&qo.Object===Object&&qo;c.exports=p}),nt=l((a,c)=>{var p=Ie(),y=typeof self=="object"&&self&&self.Object===Object&&self,C=p||y||Function("return this")();c.exports=C}),Ve=l((a,c)=>{var p=nt(),y=p.Symbol;c.exports=y}),O=l((a,c)=>{var p=Ve(),y=Object.prototype,C=y.hasOwnProperty,k=y.toString,I=p?p.toStringTag:void 0;function q(oe){var ve=C.call(oe,I),Ke=oe[I];try{oe[I]=void 0;var $e=!0}catch{}var vt=k.call(oe);return $e&&(ve?oe[I]=Ke:delete oe[I]),vt}c.exports=q}),W=l((a,c)=>{var p=Object.prototype,y=p.toString;function C(k){return y.call(k)}c.exports=C}),ue=l((a,c)=>{var p=Ve(),y=O(),C=W(),k="[object Null]",I="[object Undefined]",q=p?p.toStringTag:void 0;function oe(ve){return ve==null?ve===void 0?I:k:q&&q in Object(ve)?y(ve):C(ve)}c.exports=oe}),z=l((a,c)=>{function p(y){var C=typeof y;return y!=null&&(C=="object"||C=="function")}c.exports=p}),R=l((a,c)=>{var p=ue(),y=z(),C="[object AsyncFunction]",k="[object Function]",I="[object GeneratorFunction]",q="[object Proxy]";function oe(ve){if(!y(ve))return!1;var Ke=p(ve);return Ke==k||Ke==I||Ke==C||Ke==q}c.exports=oe}),J=l((a,c)=>{var p=nt(),y=p["__core-js_shared__"];c.exports=y}),V=l((a,c)=>{var p=J(),y=function(){var k=/[^.]+$/.exec(p&&p.keys&&p.keys.IE_PROTO||"");return k?"Symbol(src)_1."+k:""}();function C(k){return!!y&&y in k}c.exports=C}),U=l((a,c)=>{var p=Function.prototype,y=p.toString;function C(k){if(k!=null){try{return y.call(k)}catch{}try{return k+""}catch{}}return""}c.exports=C}),Y=l((a,c)=>{var p=R(),y=V(),C=z(),k=U(),I=/[\\^$.*+?()[\]{}|]/g,q=/^\[object .+?Constructor\]$/,oe=Function.prototype,ve=Object.prototype,Ke=oe.toString,$e=ve.hasOwnProperty,vt=RegExp("^"+Ke.call($e).replace(I,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Nt(Wt){if(!C(Wt)||y(Wt))return!1;var gn=p(Wt)?vt:q;return gn.test(k(Wt))}c.exports=Nt}),ce=l((a,c)=>{function p(y,C){return y==null?void 0:y[C]}c.exports=p}),re=l((a,c)=>{var p=Y(),y=ce();function C(k,I){var q=y(k,I);return p(q)?q:void 0}c.exports=C}),Pe=l((a,c)=>{var p=re(),y=nt(),C=p(y,"Map");c.exports=C}),Me=l((a,c)=>{var p=re(),y=p(Object,"create");c.exports=y}),ot=l((a,c)=>{var p=Me();function y(){this.__data__=p?p(null):{},this.size=0}c.exports=y}),X=l((a,c)=>{function p(y){var C=this.has(y)&&delete this.__data__[y];return this.size-=C?1:0,C}c.exports=p}),Ee=l((a,c)=>{var p=Me(),y="__lodash_hash_undefined__",C=Object.prototype,k=C.hasOwnProperty;function I(q){var oe=this.__data__;if(p){var ve=oe[q];return ve===y?void 0:ve}return k.call(oe,q)?oe[q]:void 0}c.exports=I}),B=l((a,c)=>{var p=Me(),y=Object.prototype,C=y.hasOwnProperty;function k(I){var q=this.__data__;return p?q[I]!==void 0:C.call(q,I)}c.exports=k}),H=l((a,c)=>{var p=Me(),y="__lodash_hash_undefined__";function C(k,I){var q=this.__data__;return this.size+=this.has(k)?0:1,q[k]=p&&I===void 0?y:I,this}c.exports=C}),he=l((a,c)=>{var p=ot(),y=X(),C=Ee(),k=B(),I=H();function q(oe){var ve=-1,Ke=oe==null?0:oe.length;for(this.clear();++ve<Ke;){var $e=oe[ve];this.set($e[0],$e[1])}}q.prototype.clear=p,q.prototype.delete=y,q.prototype.get=C,q.prototype.has=k,q.prototype.set=I,c.exports=q}),te=l((a,c)=>{var p=he(),y=Q(),C=Pe();function k(){this.size=0,this.__data__={hash:new p,map:new(C||y),string:new p}}c.exports=k}),ie=l((a,c)=>{function p(y){var C=typeof y;return C=="string"||C=="number"||C=="symbol"||C=="boolean"?y!=="__proto__":y===null}c.exports=p}),ee=l((a,c)=>{var p=ie();function y(C,k){var I=C.__data__;return p(k)?I[typeof k=="string"?"string":"hash"]:I.map}c.exports=y}),se=l((a,c)=>{var p=ee();function y(C){var k=p(this,C).delete(C);return this.size-=k?1:0,k}c.exports=y}),Ce=l((a,c)=>{var p=ee();function y(C){return p(this,C).get(C)}c.exports=y}),ne=l((a,c)=>{var p=ee();function y(C){return p(this,C).has(C)}c.exports=y}),ae=l((a,c)=>{var p=ee();function y(C,k){var I=p(this,C),q=I.size;return I.set(C,k),this.size+=I.size==q?0:1,this}c.exports=y}),xe=l((a,c)=>{var p=te(),y=se(),C=Ce(),k=ne(),I=ae();function q(oe){var ve=-1,Ke=oe==null?0:oe.length;for(this.clear();++ve<Ke;){var $e=oe[ve];this.set($e[0],$e[1])}}q.prototype.clear=p,q.prototype.delete=y,q.prototype.get=C,q.prototype.has=k,q.prototype.set=I,c.exports=q}),ye=l((a,c)=>{var p=Q(),y=Pe(),C=xe(),k=200;function I(q,oe){var ve=this.__data__;if(ve instanceof p){var Ke=ve.__data__;if(!y||Ke.length<k-1)return Ke.push([q,oe]),this.size=++ve.size,this;ve=this.__data__=new C(Ke)}return ve.set(q,oe),this.size=ve.size,this}c.exports=I}),le=l((a,c)=>{var p=Q(),y=F(),C=G(),k=me(),I=Se(),q=ye();function oe(ve){var Ke=this.__data__=new p(ve);this.size=Ke.size}oe.prototype.clear=y,oe.prototype.delete=C,oe.prototype.get=k,oe.prototype.has=I,oe.prototype.set=q,c.exports=oe}),je=l((a,c)=>{var p=re(),y=function(){try{var C=p(Object,"defineProperty");return C({},"",{}),C}catch{}}();c.exports=y}),Re=l((a,c)=>{var p=je();function y(C,k,I){k=="__proto__"&&p?p(C,k,{configurable:!0,enumerable:!0,value:I,writable:!0}):C[k]=I}c.exports=y}),Ae=l((a,c)=>{var p=Re(),y=_();function C(k,I,q){(q!==void 0&&!y(k[I],q)||q===void 0&&!(I in k))&&p(k,I,q)}c.exports=C}),qe=l((a,c)=>{function p(y){return function(C,k,I){for(var q=-1,oe=Object(C),ve=I(C),Ke=ve.length;Ke--;){var $e=ve[y?Ke:++q];if(k(oe[$e],$e,oe)===!1)break}return C}}c.exports=p}),Oe=l((a,c)=>{var p=qe(),y=p();c.exports=y}),et=l((a,c)=>{var p=nt(),y=typeof a=="object"&&a&&!a.nodeType&&a,C=y&&typeof c=="object"&&c&&!c.nodeType&&c,k=C&&C.exports===y,I=k?p.Buffer:void 0,q=I?I.allocUnsafe:void 0;function oe(ve,Ke){if(Ke)return ve.slice();var $e=ve.length,vt=q?q($e):new ve.constructor($e);return ve.copy(vt),vt}c.exports=oe}),Je=l((a,c)=>{var p=nt(),y=p.Uint8Array;c.exports=y}),mt=l((a,c)=>{var p=Je();function y(C){var k=new C.constructor(C.byteLength);return new p(k).set(new p(C)),k}c.exports=y}),_t=l((a,c)=>{var p=mt();function y(C,k){var I=k?p(C.buffer):C.buffer;return new C.constructor(I,C.byteOffset,C.length)}c.exports=y}),$t=l((a,c)=>{function p(y,C){var k=-1,I=y.length;for(C||(C=Array(I));++k<I;)C[k]=y[k];return C}c.exports=p}),Xt=l((a,c)=>{var p=z(),y=Object.create,C=function(){function k(){}return function(I){if(!p(I))return{};if(y)return y(I);k.prototype=I;var q=new k;return k.prototype=void 0,q}}();c.exports=C}),Xe=l((a,c)=>{function p(y,C){return function(k){return y(C(k))}}c.exports=p}),Kt=l((a,c)=>{var p=Xe(),y=p(Object.getPrototypeOf,Object);c.exports=y}),Qt=l((a,c)=>{var p=Object.prototype;function y(C){var k=C&&C.constructor,I=typeof k=="function"&&k.prototype||p;return C===I}c.exports=y}),Qe=l((a,c)=>{var p=Xt(),y=Kt(),C=Qt();function k(I){return typeof I.constructor=="function"&&!C(I)?p(y(I)):{}}c.exports=k}),We=l((a,c)=>{function p(y){return y!=null&&typeof y=="object"}c.exports=p}),Ut=l((a,c)=>{var p=ue(),y=We(),C="[object Arguments]";function k(I){return y(I)&&p(I)==C}c.exports=k}),pn=l((a,c)=>{var p=Ut(),y=We(),C=Object.prototype,k=C.hasOwnProperty,I=C.propertyIsEnumerable,q=p(function(){return arguments}())?p:function(oe){return y(oe)&&k.call(oe,"callee")&&!I.call(oe,"callee")};c.exports=q}),_n=l((a,c)=>{var p=Array.isArray;c.exports=p}),mn=l((a,c)=>{var p=9007199254740991;function y(C){return typeof C=="number"&&C>-1&&C%1==0&&C<=p}c.exports=y}),rt=l((a,c)=>{var p=R(),y=mn();function C(k){return k!=null&&y(k.length)&&!p(k)}c.exports=C}),vn=l((a,c)=>{var p=rt(),y=We();function C(k){return y(k)&&p(k)}c.exports=C}),ni=l((a,c)=>{function p(){return!1}c.exports=p}),fn=l((a,c)=>{var p=nt(),y=ni(),C=typeof a=="object"&&a&&!a.nodeType&&a,k=C&&typeof c=="object"&&c&&!c.nodeType&&c,I=k&&k.exports===C,q=I?p.Buffer:void 0,oe=q?q.isBuffer:void 0,ve=oe||y;c.exports=ve}),Mn=l((a,c)=>{var p=ue(),y=Kt(),C=We(),k="[object Object]",I=Function.prototype,q=Object.prototype,oe=I.toString,ve=q.hasOwnProperty,Ke=oe.call(Object);function $e(vt){if(!C(vt)||p(vt)!=k)return!1;var Nt=y(vt);if(Nt===null)return!0;var Wt=ve.call(Nt,"constructor")&&Nt.constructor;return typeof Wt=="function"&&Wt instanceof Wt&&oe.call(Wt)==Ke}c.exports=$e}),Sr=l((a,c)=>{var p=ue(),y=mn(),C=We(),k="[object Arguments]",I="[object Array]",q="[object Boolean]",oe="[object Date]",ve="[object Error]",Ke="[object Function]",$e="[object Map]",vt="[object Number]",Nt="[object Object]",Wt="[object RegExp]",gn="[object Set]",bn="[object String]",Zn="[object WeakMap]",Ze="[object ArrayBuffer]",it="[object DataView]",ht="[object Float32Array]",It="[object Float64Array]",xt="[object Int8Array]",Rt="[object Int16Array]",fe="[object Int32Array]",we="[object Uint8Array]",De="[object Uint8ClampedArray]",Ne="[object Uint16Array]",ze="[object Uint32Array]",Ue={};Ue[ht]=Ue[It]=Ue[xt]=Ue[Rt]=Ue[fe]=Ue[we]=Ue[De]=Ue[Ne]=Ue[ze]=!0,Ue[k]=Ue[I]=Ue[Ze]=Ue[q]=Ue[it]=Ue[oe]=Ue[ve]=Ue[Ke]=Ue[$e]=Ue[vt]=Ue[Nt]=Ue[Wt]=Ue[gn]=Ue[bn]=Ue[Zn]=!1;function lt(ut){return C(ut)&&y(ut.length)&&!!Ue[p(ut)]}c.exports=lt}),Ii=l((a,c)=>{function p(y){return function(C){return y(C)}}c.exports=p}),Mt=l((a,c)=>{var p=Ie(),y=typeof a=="object"&&a&&!a.nodeType&&a,C=y&&typeof c=="object"&&c&&!c.nodeType&&c,k=C&&C.exports===y,I=k&&p.process,q=function(){try{var oe=C&&C.require&&C.require("util").types;return oe||I&&I.binding&&I.binding("util")}catch{}}();c.exports=q}),On=l((a,c)=>{var p=Sr(),y=Ii(),C=Mt(),k=C&&C.isTypedArray,I=k?y(k):p;c.exports=I}),Fi=l((a,c)=>{function p(y,C){if(!(C==="constructor"&&typeof y[C]=="function")&&C!="__proto__")return y[C]}c.exports=p}),zi=l((a,c)=>{var p=Re(),y=_(),C=Object.prototype,k=C.hasOwnProperty;function I(q,oe,ve){var Ke=q[oe];(!(k.call(q,oe)&&y(Ke,ve))||ve===void 0&&!(oe in q))&&p(q,oe,ve)}c.exports=I}),Xr=l((a,c)=>{var p=zi(),y=Re();function C(k,I,q,oe){var ve=!q;q||(q={});for(var Ke=-1,$e=I.length;++Ke<$e;){var vt=I[Ke],Nt=oe?oe(q[vt],k[vt],vt,q,k):void 0;Nt===void 0&&(Nt=k[vt]),ve?y(q,vt,Nt):p(q,vt,Nt)}return q}c.exports=C}),$r=l((a,c)=>{function p(y,C){for(var k=-1,I=Array(y);++k<y;)I[k]=C(k);return I}c.exports=p}),Nn=l((a,c)=>{var p=9007199254740991,y=/^(?:0|[1-9]\d*)$/;function C(k,I){var q=typeof k;return I=I??p,!!I&&(q=="number"||q!="symbol"&&y.test(k))&&k>-1&&k%1==0&&k<I}c.exports=C}),pi=l((a,c)=>{var p=$r(),y=pn(),C=_n(),k=fn(),I=Nn(),q=On(),oe=Object.prototype,ve=oe.hasOwnProperty;function Ke($e,vt){var Nt=C($e),Wt=!Nt&&y($e),gn=!Nt&&!Wt&&k($e),bn=!Nt&&!Wt&&!gn&&q($e),Zn=Nt||Wt||gn||bn,Ze=Zn?p($e.length,String):[],it=Ze.length;for(var ht in $e)(vt||ve.call($e,ht))&&!(Zn&&(ht=="length"||gn&&(ht=="offset"||ht=="parent")||bn&&(ht=="buffer"||ht=="byteLength"||ht=="byteOffset")||I(ht,it)))&&Ze.push(ht);return Ze}c.exports=Ke}),hr=l((a,c)=>{function p(y){var C=[];if(y!=null)for(var k in Object(y))C.push(k);return C}c.exports=p}),bi=l((a,c)=>{var p=z(),y=Qt(),C=hr(),k=Object.prototype,I=k.hasOwnProperty;function q(oe){if(!p(oe))return C(oe);var ve=y(oe),Ke=[];for(var $e in oe)$e=="constructor"&&(ve||!I.call(oe,$e))||Ke.push($e);return Ke}c.exports=q}),Zt=l((a,c)=>{var p=pi(),y=bi(),C=rt();function k(I){return C(I)?p(I,!0):y(I)}c.exports=k}),yn=l((a,c)=>{var p=Xr(),y=Zt();function C(k){return p(k,y(k))}c.exports=C}),er=l((a,c)=>{var p=Ae(),y=et(),C=_t(),k=$t(),I=Qe(),q=pn(),oe=_n(),ve=vn(),Ke=fn(),$e=R(),vt=z(),Nt=Mn(),Wt=On(),gn=Fi(),bn=yn();function Zn(Ze,it,ht,It,xt,Rt,fe){var we=gn(Ze,ht),De=gn(it,ht),Ne=fe.get(De);if(Ne){p(Ze,ht,Ne);return}var ze=Rt?Rt(we,De,ht+"",Ze,it,fe):void 0,Ue=ze===void 0;if(Ue){var lt=oe(De),ut=!lt&&Ke(De),pt=!lt&&!ut&&Wt(De);ze=De,lt||ut||pt?oe(we)?ze=we:ve(we)?ze=k(we):ut?(Ue=!1,ze=y(De,!0)):pt?(Ue=!1,ze=C(De,!0)):ze=[]:Nt(De)||q(De)?(ze=we,q(we)?ze=bn(we):(!vt(we)||$e(we))&&(ze=I(De))):Ue=!1}Ue&&(fe.set(De,ze),xt(ze,De,It,Rt,fe),fe.delete(De)),p(Ze,ht,ze)}c.exports=Zn}),kr=l((a,c)=>{var p=le(),y=Ae(),C=Oe(),k=er(),I=z(),q=Zt(),oe=Fi();function ve(Ke,$e,vt,Nt,Wt){Ke!==$e&&C($e,function(gn,bn){if(Wt||(Wt=new p),I(gn))k(Ke,$e,bn,vt,ve,Nt,Wt);else{var Zn=Nt?Nt(oe(Ke,bn),gn,bn+"",Ke,$e,Wt):void 0;Zn===void 0&&(Zn=gn),y(Ke,bn,Zn)}},q)}c.exports=ve}),tr=l((a,c)=>{function p(y){return y}c.exports=p}),qr=l((a,c)=>{function p(y,C,k){switch(k.length){case 0:return y.call(C);case 1:return y.call(C,k[0]);case 2:return y.call(C,k[0],k[1]);case 3:return y.call(C,k[0],k[1],k[2])}return y.apply(C,k)}c.exports=p}),Vr=l((a,c)=>{var p=qr(),y=Math.max;function C(k,I,q){return I=y(I===void 0?k.length-1:I,0),function(){for(var oe=arguments,ve=-1,Ke=y(oe.length-I,0),$e=Array(Ke);++ve<Ke;)$e[ve]=oe[I+ve];ve=-1;for(var vt=Array(I+1);++ve<I;)vt[ve]=oe[ve];return vt[I]=q($e),p(k,this,vt)}}c.exports=C}),Qn=l((a,c)=>{function p(y){return function(){return y}}c.exports=p}),fr=l((a,c)=>{var p=Qn(),y=je(),C=tr(),k=y?function(I,q){return y(I,"toString",{configurable:!0,enumerable:!1,value:p(q),writable:!0})}:C;c.exports=k}),fs=l((a,c)=>{var p=800,y=16,C=Date.now;function k(I){var q=0,oe=0;return function(){var ve=C(),Ke=y-(ve-oe);if(oe=ve,Ke>0){if(++q>=p)return arguments[0]}else q=0;return I.apply(void 0,arguments)}}c.exports=k}),Qr=l((a,c)=>{var p=fr(),y=fs(),C=y(p);c.exports=C}),Ci=l((a,c)=>{var p=tr(),y=Vr(),C=Qr();function k(I,q){return C(y(I,q,p),I+"")}c.exports=k}),An=l((a,c)=>{var p=_(),y=rt(),C=Nn(),k=z();function I(q,oe,ve){if(!k(ve))return!1;var Ke=typeof oe;return(Ke=="number"?y(ve)&&C(oe,ve.length):Ke=="string"&&oe in ve)?p(ve[oe],q):!1}c.exports=I}),Pr=l((a,c)=>{var p=Ci(),y=An();function C(k){return p(function(I,q){var oe=-1,ve=q.length,Ke=ve>1?q[ve-1]:void 0,$e=ve>2?q[2]:void 0;for(Ke=k.length>3&&typeof Ke=="function"?(ve--,Ke):void 0,$e&&y(q[0],q[1],$e)&&(Ke=ve<3?void 0:Ke,ve=1),I=Object(I);++oe<ve;){var vt=q[oe];vt&&k(I,vt,oe,Ke)}return I})}c.exports=C}),Ui=l((a,c)=>{var p=kr(),y=Pr(),C=y(function(k,I,q){p(k,I,q)});c.exports=C}),Vi=l((a,c)=>{var p=ue(),y=We(),C="[object Symbol]";function k(I){return typeof I=="symbol"||y(I)&&p(I)==C}c.exports=k}),dr=l((a,c)=>{var p=_n(),y=Vi(),C=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,k=/^\w*$/;function I(q,oe){if(p(q))return!1;var ve=typeof q;return ve=="number"||ve=="symbol"||ve=="boolean"||q==null||y(q)?!0:k.test(q)||!C.test(q)||oe!=null&&q in Object(oe)}c.exports=I}),es=l((a,c)=>{var p=xe(),y="Expected a function";function C(k,I){if(typeof k!="function"||I!=null&&typeof I!="function")throw new TypeError(y);var q=function(){var oe=arguments,ve=I?I.apply(this,oe):oe[0],Ke=q.cache;if(Ke.has(ve))return Ke.get(ve);var $e=k.apply(this,oe);return q.cache=Ke.set(ve,$e)||Ke,$e};return q.cache=new(C.Cache||p),q}C.Cache=p,c.exports=C}),Fs=l((a,c)=>{var p=es(),y=500;function C(k){var I=p(k,function(oe){return q.size===y&&q.clear(),oe}),q=I.cache;return I}c.exports=C}),di=l((a,c)=>{var p=Fs(),y=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,C=/\\(\\)?/g,k=p(function(I){var q=[];return I.charCodeAt(0)===46&&q.push(""),I.replace(y,function(oe,ve,Ke,$e){q.push(Ke?$e.replace(C,"$1"):ve||oe)}),q});c.exports=k}),co=l((a,c)=>{function p(y,C){for(var k=-1,I=y==null?0:y.length,q=Array(I);++k<I;)q[k]=C(y[k],k,y);return q}c.exports=p}),mr=l((a,c)=>{var p=Ve(),y=co(),C=_n(),k=Vi(),I=p?p.prototype:void 0,q=I?I.toString:void 0;function oe(ve){if(typeof ve=="string")return ve;if(C(ve))return y(ve,oe)+"";if(k(ve))return q?q.call(ve):"";var Ke=ve+"";return Ke=="0"&&1/ve==-1/0?"-0":Ke}c.exports=oe}),Er=l((a,c)=>{var p=mr();function y(C){return C==null?"":p(C)}c.exports=y}),mi=l((a,c)=>{var p=_n(),y=dr(),C=di(),k=Er();function I(q,oe){return p(q)?q:y(q,oe)?[q]:C(k(q))}c.exports=I}),xn=l((a,c)=>{var p=Vi();function y(C){if(typeof C=="string"||p(C))return C;var k=C+"";return k=="0"&&1/C==-1/0?"-0":k}c.exports=y}),on=l((a,c)=>{var p=mi(),y=xn();function C(k,I){I=p(I,k);for(var q=0,oe=I.length;k!=null&&q<oe;)k=k[y(I[q++])];return q&&q==oe?k:void 0}c.exports=C}),ii=l((a,c)=>{var p=on();function y(C,k,I){var q=C==null?void 0:p(C,k);return q===void 0?I:q}c.exports=y}),Xn=l((a,c)=>{(function(p,y){typeof a=="object"&&typeof c<"u"?c.exports=y():(p=p||self).RBush=y()})(a,function(){function p(Ze,it,ht,It,xt){(function Rt(fe,we,De,Ne,ze){for(;Ne>De;){if(Ne-De>600){var Ue=Ne-De+1,lt=we-De+1,ut=Math.log(Ue),pt=.5*Math.exp(2*ut/3),Et=.5*Math.sqrt(ut*pt*(Ue-pt)/Ue)*(lt-Ue/2<0?-1:1),At=Math.max(De,Math.floor(we-lt*pt/Ue+Et)),en=Math.min(Ne,Math.floor(we+(Ue-lt)*pt/Ue+Et));Rt(fe,we,At,en,ze)}var Tn=fe[we],Rn=De,qn=Ne;for(y(fe,De,we),ze(fe[Ne],Tn)>0&&y(fe,De,Ne);Rn<qn;){for(y(fe,Rn,qn),Rn++,qn--;ze(fe[Rn],Tn)<0;)Rn++;for(;ze(fe[qn],Tn)>0;)qn--}ze(fe[De],Tn)===0?y(fe,De,qn):y(fe,++qn,Ne),qn<=we&&(De=qn+1),we<=qn&&(Ne=qn-1)}})(Ze,it,ht||0,It||Ze.length-1,xt||C)}function y(Ze,it,ht){var It=Ze[it];Ze[it]=Ze[ht],Ze[ht]=It}function C(Ze,it){return Ze<it?-1:Ze>it?1:0}var k=function(Ze){Ze===void 0&&(Ze=9),this._maxEntries=Math.max(4,Ze),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function I(Ze,it,ht){if(!ht)return it.indexOf(Ze);for(var It=0;It<it.length;It++)if(ht(Ze,it[It]))return It;return-1}function q(Ze,it){oe(Ze,0,Ze.children.length,it,Ze)}function oe(Ze,it,ht,It,xt){xt||(xt=bn(null)),xt.minX=1/0,xt.minY=1/0,xt.maxX=-1/0,xt.maxY=-1/0;for(var Rt=it;Rt<ht;Rt++){var fe=Ze.children[Rt];ve(xt,Ze.leaf?It(fe):fe)}return xt}function ve(Ze,it){return Ze.minX=Math.min(Ze.minX,it.minX),Ze.minY=Math.min(Ze.minY,it.minY),Ze.maxX=Math.max(Ze.maxX,it.maxX),Ze.maxY=Math.max(Ze.maxY,it.maxY),Ze}function Ke(Ze,it){return Ze.minX-it.minX}function $e(Ze,it){return Ze.minY-it.minY}function vt(Ze){return(Ze.maxX-Ze.minX)*(Ze.maxY-Ze.minY)}function Nt(Ze){return Ze.maxX-Ze.minX+(Ze.maxY-Ze.minY)}function Wt(Ze,it){return Ze.minX<=it.minX&&Ze.minY<=it.minY&&it.maxX<=Ze.maxX&&it.maxY<=Ze.maxY}function gn(Ze,it){return it.minX<=Ze.maxX&&it.minY<=Ze.maxY&&it.maxX>=Ze.minX&&it.maxY>=Ze.minY}function bn(Ze){return{children:Ze,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Zn(Ze,it,ht,It,xt){for(var Rt=[it,ht];Rt.length;)if(!((ht=Rt.pop())-(it=Rt.pop())<=It)){var fe=it+Math.ceil((ht-it)/It/2)*It;p(Ze,fe,it,ht,xt),Rt.push(it,fe,fe,ht)}}return k.prototype.all=function(){return this._all(this.data,[])},k.prototype.search=function(Ze){var it=this.data,ht=[];if(!gn(Ze,it))return ht;for(var It=this.toBBox,xt=[];it;){for(var Rt=0;Rt<it.children.length;Rt++){var fe=it.children[Rt],we=it.leaf?It(fe):fe;gn(Ze,we)&&(it.leaf?ht.push(fe):Wt(Ze,we)?this._all(fe,ht):xt.push(fe))}it=xt.pop()}return ht},k.prototype.collides=function(Ze){var it=this.data;if(!gn(Ze,it))return!1;for(var ht=[];it;){for(var It=0;It<it.children.length;It++){var xt=it.children[It],Rt=it.leaf?this.toBBox(xt):xt;if(gn(Ze,Rt)){if(it.leaf||Wt(Ze,Rt))return!0;ht.push(xt)}}it=ht.pop()}return!1},k.prototype.load=function(Ze){if(!Ze||!Ze.length)return this;if(Ze.length<this._minEntries){for(var it=0;it<Ze.length;it++)this.insert(Ze[it]);return this}var ht=this._build(Ze.slice(),0,Ze.length-1,0);if(this.data.children.length)if(this.data.height===ht.height)this._splitRoot(this.data,ht);else{if(this.data.height<ht.height){var It=this.data;this.data=ht,ht=It}this._insert(ht,this.data.height-ht.height-1,!0)}else this.data=ht;return this},k.prototype.insert=function(Ze){return Ze&&this._insert(Ze,this.data.height-1),this},k.prototype.clear=function(){return this.data=bn([]),this},k.prototype.remove=function(Ze,it){if(!Ze)return this;for(var ht,It,xt,Rt=this.data,fe=this.toBBox(Ze),we=[],De=[];Rt||we.length;){if(Rt||(Rt=we.pop(),It=we[we.length-1],ht=De.pop(),xt=!0),Rt.leaf){var Ne=I(Ze,Rt.children,it);if(Ne!==-1)return Rt.children.splice(Ne,1),we.push(Rt),this._condense(we),this}xt||Rt.leaf||!Wt(Rt,fe)?It?(ht++,Rt=It.children[ht],xt=!1):Rt=null:(we.push(Rt),De.push(ht),ht=0,It=Rt,Rt=Rt.children[0])}return this},k.prototype.toBBox=function(Ze){return Ze},k.prototype.compareMinX=function(Ze,it){return Ze.minX-it.minX},k.prototype.compareMinY=function(Ze,it){return Ze.minY-it.minY},k.prototype.toJSON=function(){return this.data},k.prototype.fromJSON=function(Ze){return this.data=Ze,this},k.prototype._all=function(Ze,it){for(var ht=[];Ze;)Ze.leaf?it.push.apply(it,Ze.children):ht.push.apply(ht,Ze.children),Ze=ht.pop();return it},k.prototype._build=function(Ze,it,ht,It){var xt,Rt=ht-it+1,fe=this._maxEntries;if(Rt<=fe)return q(xt=bn(Ze.slice(it,ht+1)),this.toBBox),xt;It||(It=Math.ceil(Math.log(Rt)/Math.log(fe)),fe=Math.ceil(Rt/Math.pow(fe,It-1))),(xt=bn([])).leaf=!1,xt.height=It;var we=Math.ceil(Rt/fe),De=we*Math.ceil(Math.sqrt(fe));Zn(Ze,it,ht,De,this.compareMinX);for(var Ne=it;Ne<=ht;Ne+=De){var ze=Math.min(Ne+De-1,ht);Zn(Ze,Ne,ze,we,this.compareMinY);for(var Ue=Ne;Ue<=ze;Ue+=we){var lt=Math.min(Ue+we-1,ze);xt.children.push(this._build(Ze,Ue,lt,It-1))}}return q(xt,this.toBBox),xt},k.prototype._chooseSubtree=function(Ze,it,ht,It){for(;It.push(it),!it.leaf&&It.length-1!==ht;){for(var xt=1/0,Rt=1/0,fe=void 0,we=0;we<it.children.length;we++){var De=it.children[we],Ne=vt(De),ze=(Ue=Ze,lt=De,(Math.max(lt.maxX,Ue.maxX)-Math.min(lt.minX,Ue.minX))*(Math.max(lt.maxY,Ue.maxY)-Math.min(lt.minY,Ue.minY))-Ne);ze<Rt?(Rt=ze,xt=Ne<xt?Ne:xt,fe=De):ze===Rt&&Ne<xt&&(xt=Ne,fe=De)}it=fe||it.children[0]}var Ue,lt;return it},k.prototype._insert=function(Ze,it,ht){var It=ht?Ze:this.toBBox(Ze),xt=[],Rt=this._chooseSubtree(It,this.data,it,xt);for(Rt.children.push(Ze),ve(Rt,It);it>=0&&xt[it].children.length>this._maxEntries;)this._split(xt,it),it--;this._adjustParentBBoxes(It,xt,it)},k.prototype._split=function(Ze,it){var ht=Ze[it],It=ht.children.length,xt=this._minEntries;this._chooseSplitAxis(ht,xt,It);var Rt=this._chooseSplitIndex(ht,xt,It),fe=bn(ht.children.splice(Rt,ht.children.length-Rt));fe.height=ht.height,fe.leaf=ht.leaf,q(ht,this.toBBox),q(fe,this.toBBox),it?Ze[it-1].children.push(fe):this._splitRoot(ht,fe)},k.prototype._splitRoot=function(Ze,it){this.data=bn([Ze,it]),this.data.height=Ze.height+1,this.data.leaf=!1,q(this.data,this.toBBox)},k.prototype._chooseSplitIndex=function(Ze,it,ht){for(var It,xt,Rt,fe,we,De,Ne,ze=1/0,Ue=1/0,lt=it;lt<=ht-it;lt++){var ut=oe(Ze,0,lt,this.toBBox),pt=oe(Ze,lt,ht,this.toBBox),Et=(xt=ut,Rt=pt,fe=void 0,we=void 0,De=void 0,Ne=void 0,fe=Math.max(xt.minX,Rt.minX),we=Math.max(xt.minY,Rt.minY),De=Math.min(xt.maxX,Rt.maxX),Ne=Math.min(xt.maxY,Rt.maxY),Math.max(0,De-fe)*Math.max(0,Ne-we)),At=vt(ut)+vt(pt);Et<ze?(ze=Et,It=lt,Ue=At<Ue?At:Ue):Et===ze&&At<Ue&&(Ue=At,It=lt)}return It||ht-it},k.prototype._chooseSplitAxis=function(Ze,it,ht){var It=Ze.leaf?this.compareMinX:Ke,xt=Ze.leaf?this.compareMinY:$e;this._allDistMargin(Ze,it,ht,It)<this._allDistMargin(Ze,it,ht,xt)&&Ze.children.sort(It)},k.prototype._allDistMargin=function(Ze,it,ht,It){Ze.children.sort(It);for(var xt=this.toBBox,Rt=oe(Ze,0,it,xt),fe=oe(Ze,ht-it,ht,xt),we=Nt(Rt)+Nt(fe),De=it;De<ht-it;De++){var Ne=Ze.children[De];ve(Rt,Ze.leaf?xt(Ne):Ne),we+=Nt(Rt)}for(var ze=ht-it-1;ze>=it;ze--){var Ue=Ze.children[ze];ve(fe,Ze.leaf?xt(Ue):Ue),we+=Nt(fe)}return we},k.prototype._adjustParentBBoxes=function(Ze,it,ht){for(var It=ht;It>=0;It--)ve(it[It],Ze)},k.prototype._condense=function(Ze){for(var it=Ze.length-1,ht=void 0;it>=0;it--)Ze[it].children.length===0?it>0?(ht=Ze[it-1].children).splice(ht.indexOf(Ze[it]),1):this.clear():q(Ze[it],this.toBBox)},k})}),jn=l(a=>{Object.defineProperty(a,"__esModule",{value:!0}),a.earthRadius=63710088e-1,a.factors={centimeters:a.earthRadius*100,centimetres:a.earthRadius*100,degrees:a.earthRadius/111325,feet:a.earthRadius*3.28084,inches:a.earthRadius*39.37,kilometers:a.earthRadius/1e3,kilometres:a.earthRadius/1e3,meters:a.earthRadius,metres:a.earthRadius,miles:a.earthRadius/1609.344,millimeters:a.earthRadius*1e3,millimetres:a.earthRadius*1e3,nauticalmiles:a.earthRadius/1852,radians:1,yards:a.earthRadius*1.0936},a.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/a.earthRadius,yards:1.0936133},a.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function c(Ne,ze,Ue){Ue===void 0&&(Ue={});var lt={type:"Feature"};return(Ue.id===0||Ue.id)&&(lt.id=Ue.id),Ue.bbox&&(lt.bbox=Ue.bbox),lt.properties=ze||{},lt.geometry=Ne,lt}a.feature=c;function p(Ne,ze,Ue){switch(Ne){case"Point":return y(ze).geometry;case"LineString":return q(ze).geometry;case"Polygon":return k(ze).geometry;case"MultiPoint":return $e(ze).geometry;case"MultiLineString":return Ke(ze).geometry;case"MultiPolygon":return vt(ze).geometry;default:throw new Error(Ne+" is invalid")}}a.geometry=p;function y(Ne,ze,Ue){if(Ue===void 0&&(Ue={}),!Ne)throw new Error("coordinates is required");if(!Array.isArray(Ne))throw new Error("coordinates must be an Array");if(Ne.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Rt(Ne[0])||!Rt(Ne[1]))throw new Error("coordinates must contain numbers");var lt={type:"Point",coordinates:Ne};return c(lt,ze,Ue)}a.point=y;function C(Ne,ze,Ue){return Ue===void 0&&(Ue={}),ve(Ne.map(function(lt){return y(lt,ze)}),Ue)}a.points=C;function k(Ne,ze,Ue){Ue===void 0&&(Ue={});for(var lt=0,ut=Ne;lt<ut.length;lt++){var pt=ut[lt];if(pt.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var Et=0;Et<pt[pt.length-1].length;Et++)if(pt[pt.length-1][Et]!==pt[0][Et])throw new Error("First and last Position are not equivalent.")}var At={type:"Polygon",coordinates:Ne};return c(At,ze,Ue)}a.polygon=k;function I(Ne,ze,Ue){return Ue===void 0&&(Ue={}),ve(Ne.map(function(lt){return k(lt,ze)}),Ue)}a.polygons=I;function q(Ne,ze,Ue){if(Ue===void 0&&(Ue={}),Ne.length<2)throw new Error("coordinates must be an array of two or more positions");var lt={type:"LineString",coordinates:Ne};return c(lt,ze,Ue)}a.lineString=q;function oe(Ne,ze,Ue){return Ue===void 0&&(Ue={}),ve(Ne.map(function(lt){return q(lt,ze)}),Ue)}a.lineStrings=oe;function ve(Ne,ze){ze===void 0&&(ze={});var Ue={type:"FeatureCollection"};return ze.id&&(Ue.id=ze.id),ze.bbox&&(Ue.bbox=ze.bbox),Ue.features=Ne,Ue}a.featureCollection=ve;function Ke(Ne,ze,Ue){Ue===void 0&&(Ue={});var lt={type:"MultiLineString",coordinates:Ne};return c(lt,ze,Ue)}a.multiLineString=Ke;function $e(Ne,ze,Ue){Ue===void 0&&(Ue={});var lt={type:"MultiPoint",coordinates:Ne};return c(lt,ze,Ue)}a.multiPoint=$e;function vt(Ne,ze,Ue){Ue===void 0&&(Ue={});var lt={type:"MultiPolygon",coordinates:Ne};return c(lt,ze,Ue)}a.multiPolygon=vt;function Nt(Ne,ze,Ue){Ue===void 0&&(Ue={});var lt={type:"GeometryCollection",geometries:Ne};return c(lt,ze,Ue)}a.geometryCollection=Nt;function Wt(Ne,ze){if(ze===void 0&&(ze=0),ze&&!(ze>=0))throw new Error("precision must be a positive number");var Ue=Math.pow(10,ze||0);return Math.round(Ne*Ue)/Ue}a.round=Wt;function gn(Ne,ze){ze===void 0&&(ze="kilometers");var Ue=a.factors[ze];if(!Ue)throw new Error(ze+" units is invalid");return Ne*Ue}a.radiansToLength=gn;function bn(Ne,ze){ze===void 0&&(ze="kilometers");var Ue=a.factors[ze];if(!Ue)throw new Error(ze+" units is invalid");return Ne/Ue}a.lengthToRadians=bn;function Zn(Ne,ze){return it(bn(Ne,ze))}a.lengthToDegrees=Zn;function Ze(Ne){var ze=Ne%360;return ze<0&&(ze+=360),ze}a.bearingToAzimuth=Ze;function it(Ne){var ze=Ne%(2*Math.PI);return ze*180/Math.PI}a.radiansToDegrees=it;function ht(Ne){var ze=Ne%360;return ze*Math.PI/180}a.degreesToRadians=ht;function It(Ne,ze,Ue){if(ze===void 0&&(ze="kilometers"),Ue===void 0&&(Ue="kilometers"),!(Ne>=0))throw new Error("length must be a positive number");return gn(bn(Ne,ze),Ue)}a.convertLength=It;function xt(Ne,ze,Ue){if(ze===void 0&&(ze="meters"),Ue===void 0&&(Ue="kilometers"),!(Ne>=0))throw new Error("area must be a positive number");var lt=a.areaFactors[ze];if(!lt)throw new Error("invalid original units");var ut=a.areaFactors[Ue];if(!ut)throw new Error("invalid final units");return Ne/lt*ut}a.convertArea=xt;function Rt(Ne){return!isNaN(Ne)&&Ne!==null&&!Array.isArray(Ne)}a.isNumber=Rt;function fe(Ne){return!!Ne&&Ne.constructor===Object}a.isObject=fe;function we(Ne){if(!Ne)throw new Error("bbox is required");if(!Array.isArray(Ne))throw new Error("bbox must be an Array");if(Ne.length!==4&&Ne.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");Ne.forEach(function(ze){if(!Rt(ze))throw new Error("bbox must only contain numbers")})}a.validateBBox=we;function De(Ne){if(!Ne)throw new Error("id is required");if(["string","number"].indexOf(typeof Ne)===-1)throw new Error("id must be a number or a string")}a.validateId=De}),rs=l(a=>{Object.defineProperty(a,"__esModule",{value:!0});var c=jn();function p(it,ht,It){if(it!==null)for(var xt,Rt,fe,we,De,Ne,ze,Ue=0,lt=0,ut,pt=it.type,Et=pt==="FeatureCollection",At=pt==="Feature",en=Et?it.features.length:1,Tn=0;Tn<en;Tn++){ze=Et?it.features[Tn].geometry:At?it.geometry:it,ut=ze?ze.type==="GeometryCollection":!1,De=ut?ze.geometries.length:1;for(var Rn=0;Rn<De;Rn++){var qn=0,Hi=0;if(we=ut?ze.geometries[Rn]:ze,we!==null){Ne=we.coordinates;var ir=we.type;switch(Ue=It&&(ir==="Polygon"||ir==="MultiPolygon")?1:0,ir){case null:break;case"Point":if(ht(Ne,lt,Tn,qn,Hi)===!1)return!1;lt++,qn++;break;case"LineString":case"MultiPoint":for(xt=0;xt<Ne.length;xt++){if(ht(Ne[xt],lt,Tn,qn,Hi)===!1)return!1;lt++,ir==="MultiPoint"&&qn++}ir==="LineString"&&qn++;break;case"Polygon":case"MultiLineString":for(xt=0;xt<Ne.length;xt++){for(Rt=0;Rt<Ne[xt].length-Ue;Rt++){if(ht(Ne[xt][Rt],lt,Tn,qn,Hi)===!1)return!1;lt++}ir==="MultiLineString"&&qn++,ir==="Polygon"&&Hi++}ir==="Polygon"&&qn++;break;case"MultiPolygon":for(xt=0;xt<Ne.length;xt++){for(Hi=0,Rt=0;Rt<Ne[xt].length;Rt++){for(fe=0;fe<Ne[xt][Rt].length-Ue;fe++){if(ht(Ne[xt][Rt][fe],lt,Tn,qn,Hi)===!1)return!1;lt++}Hi++}qn++}break;case"GeometryCollection":for(xt=0;xt<we.geometries.length;xt++)if(p(we.geometries[xt],ht,It)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function y(it,ht,It,xt){var Rt=It;return p(it,function(fe,we,De,Ne,ze){we===0&&It===void 0?Rt=fe:Rt=ht(Rt,fe,we,De,Ne,ze)},xt),Rt}function C(it,ht){var It;switch(it.type){case"FeatureCollection":for(It=0;It<it.features.length&&ht(it.features[It].properties,It)!==!1;It++);break;case"Feature":ht(it.properties,0);break}}function k(it,ht,It){var xt=It;return C(it,function(Rt,fe){fe===0&&It===void 0?xt=Rt:xt=ht(xt,Rt,fe)}),xt}function I(it,ht){if(it.type==="Feature")ht(it,0);else if(it.type==="FeatureCollection")for(var It=0;It<it.features.length&&ht(it.features[It],It)!==!1;It++);}function q(it,ht,It){var xt=It;return I(it,function(Rt,fe){fe===0&&It===void 0?xt=Rt:xt=ht(xt,Rt,fe)}),xt}function oe(it){var ht=[];return p(it,function(It){ht.push(It)}),ht}function ve(it,ht){var It,xt,Rt,fe,we,De,Ne,ze,Ue,lt,ut=0,pt=it.type==="FeatureCollection",Et=it.type==="Feature",At=pt?it.features.length:1;for(It=0;It<At;It++){for(De=pt?it.features[It].geometry:Et?it.geometry:it,ze=pt?it.features[It].properties:Et?it.properties:{},Ue=pt?it.features[It].bbox:Et?it.bbox:void 0,lt=pt?it.features[It].id:Et?it.id:void 0,Ne=De?De.type==="GeometryCollection":!1,we=Ne?De.geometries.length:1,Rt=0;Rt<we;Rt++){if(fe=Ne?De.geometries[Rt]:De,fe===null){if(ht(null,ut,ze,Ue,lt)===!1)return!1;continue}switch(fe.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(ht(fe,ut,ze,Ue,lt)===!1)return!1;break}case"GeometryCollection":{for(xt=0;xt<fe.geometries.length;xt++)if(ht(fe.geometries[xt],ut,ze,Ue,lt)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}ut++}}function Ke(it,ht,It){var xt=It;return ve(it,function(Rt,fe,we,De,Ne){fe===0&&It===void 0?xt=Rt:xt=ht(xt,Rt,fe,we,De,Ne)}),xt}function $e(it,ht){ve(it,function(It,xt,Rt,fe,we){var De=It===null?null:It.type;switch(De){case null:case"Point":case"LineString":case"Polygon":return ht(c.feature(It,Rt,{bbox:fe,id:we}),xt,0)===!1?!1:void 0}var Ne;switch(De){case"MultiPoint":Ne="Point";break;case"MultiLineString":Ne="LineString";break;case"MultiPolygon":Ne="Polygon";break}for(var ze=0;ze<It.coordinates.length;ze++){var Ue=It.coordinates[ze],lt={type:Ne,coordinates:Ue};if(ht(c.feature(lt,Rt),xt,ze)===!1)return!1}})}function vt(it,ht,It){var xt=It;return $e(it,function(Rt,fe,we){fe===0&&we===0&&It===void 0?xt=Rt:xt=ht(xt,Rt,fe,we)}),xt}function Nt(it,ht){$e(it,function(It,xt,Rt){var fe=0;if(It.geometry){var we=It.geometry.type;if(!(we==="Point"||we==="MultiPoint")){var De,Ne=0,ze=0,Ue=0;if(p(It,function(lt,ut,pt,Et,At){if(De===void 0||xt>Ne||Et>ze||At>Ue){De=lt,Ne=xt,ze=Et,Ue=At,fe=0;return}var en=c.lineString([De,lt],It.properties);if(ht(en,xt,Rt,At,fe)===!1)return!1;fe++,De=lt})===!1)return!1}}})}function Wt(it,ht,It){var xt=It,Rt=!1;return Nt(it,function(fe,we,De,Ne,ze){Rt===!1&&It===void 0?xt=fe:xt=ht(xt,fe,we,De,Ne,ze),Rt=!0}),xt}function gn(it,ht){if(!it)throw new Error("geojson is required");$e(it,function(It,xt,Rt){if(It.geometry!==null){var fe=It.geometry.type,we=It.geometry.coordinates;switch(fe){case"LineString":if(ht(It,xt,Rt,0,0)===!1)return!1;break;case"Polygon":for(var De=0;De<we.length;De++)if(ht(c.lineString(we[De],It.properties),xt,Rt,De)===!1)return!1;break}}})}function bn(it,ht,It){var xt=It;return gn(it,function(Rt,fe,we,De){fe===0&&It===void 0?xt=Rt:xt=ht(xt,Rt,fe,we,De)}),xt}function Zn(it,ht){if(ht=ht||{},!c.isObject(ht))throw new Error("options is invalid");var It=ht.featureIndex||0,xt=ht.multiFeatureIndex||0,Rt=ht.geometryIndex||0,fe=ht.segmentIndex||0,we=ht.properties,De;switch(it.type){case"FeatureCollection":It<0&&(It=it.features.length+It),we=we||it.features[It].properties,De=it.features[It].geometry;break;case"Feature":we=we||it.properties,De=it.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":De=it;break;default:throw new Error("geojson is invalid")}if(De===null)return null;var Ne=De.coordinates;switch(De.type){case"Point":case"MultiPoint":return null;case"LineString":return fe<0&&(fe=Ne.length+fe-1),c.lineString([Ne[fe],Ne[fe+1]],we,ht);case"Polygon":return Rt<0&&(Rt=Ne.length+Rt),fe<0&&(fe=Ne[Rt].length+fe-1),c.lineString([Ne[Rt][fe],Ne[Rt][fe+1]],we,ht);case"MultiLineString":return xt<0&&(xt=Ne.length+xt),fe<0&&(fe=Ne[xt].length+fe-1),c.lineString([Ne[xt][fe],Ne[xt][fe+1]],we,ht);case"MultiPolygon":return xt<0&&(xt=Ne.length+xt),Rt<0&&(Rt=Ne[xt].length+Rt),fe<0&&(fe=Ne[xt][Rt].length-fe-1),c.lineString([Ne[xt][Rt][fe],Ne[xt][Rt][fe+1]],we,ht)}throw new Error("geojson is invalid")}function Ze(it,ht){if(ht=ht||{},!c.isObject(ht))throw new Error("options is invalid");var It=ht.featureIndex||0,xt=ht.multiFeatureIndex||0,Rt=ht.geometryIndex||0,fe=ht.coordIndex||0,we=ht.properties,De;switch(it.type){case"FeatureCollection":It<0&&(It=it.features.length+It),we=we||it.features[It].properties,De=it.features[It].geometry;break;case"Feature":we=we||it.properties,De=it.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":De=it;break;default:throw new Error("geojson is invalid")}if(De===null)return null;var Ne=De.coordinates;switch(De.type){case"Point":return c.point(Ne,we,ht);case"MultiPoint":return xt<0&&(xt=Ne.length+xt),c.point(Ne[xt],we,ht);case"LineString":return fe<0&&(fe=Ne.length+fe),c.point(Ne[fe],we,ht);case"Polygon":return Rt<0&&(Rt=Ne.length+Rt),fe<0&&(fe=Ne[Rt].length+fe),c.point(Ne[Rt][fe],we,ht);case"MultiLineString":return xt<0&&(xt=Ne.length+xt),fe<0&&(fe=Ne[xt].length+fe),c.point(Ne[xt][fe],we,ht);case"MultiPolygon":return xt<0&&(xt=Ne.length+xt),Rt<0&&(Rt=Ne[xt].length+Rt),fe<0&&(fe=Ne[xt][Rt].length-fe),c.point(Ne[xt][Rt][fe],we,ht)}throw new Error("geojson is invalid")}a.coordAll=oe,a.coordEach=p,a.coordReduce=y,a.featureEach=I,a.featureReduce=q,a.findPoint=Ze,a.findSegment=Zn,a.flattenEach=$e,a.flattenReduce=vt,a.geomEach=ve,a.geomReduce=Ke,a.lineEach=gn,a.lineReduce=bn,a.propEach=C,a.propReduce=k,a.segmentEach=Nt,a.segmentReduce=Wt}),Ps=l(a=>{Object.defineProperty(a,"__esModule",{value:!0});var c=rs();function p(y){var C=[1/0,1/0,-1/0,-1/0];return c.coordEach(y,function(k){C[0]>k[0]&&(C[0]=k[0]),C[1]>k[1]&&(C[1]=k[1]),C[2]<k[0]&&(C[2]=k[0]),C[3]<k[1]&&(C[3]=k[1])}),C}p.default=p,a.default=p}),Tr=l((a,c)=>{var p=Xn(),y=jn(),C=rs(),k=Ps().default,I=C.featureEach;C.coordEach,y.polygon;var q=y.featureCollection;function oe(ve){var Ke=new p(ve);return Ke.insert=function($e){if($e.type!=="Feature")throw new Error("invalid feature");return $e.bbox=$e.bbox?$e.bbox:k($e),p.prototype.insert.call(this,$e)},Ke.load=function($e){var vt=[];return Array.isArray($e)?$e.forEach(function(Nt){if(Nt.type!=="Feature")throw new Error("invalid features");Nt.bbox=Nt.bbox?Nt.bbox:k(Nt),vt.push(Nt)}):I($e,function(Nt){if(Nt.type!=="Feature")throw new Error("invalid features");Nt.bbox=Nt.bbox?Nt.bbox:k(Nt),vt.push(Nt)}),p.prototype.load.call(this,vt)},Ke.remove=function($e,vt){if($e.type!=="Feature")throw new Error("invalid feature");return $e.bbox=$e.bbox?$e.bbox:k($e),p.prototype.remove.call(this,$e,vt)},Ke.clear=function(){return p.prototype.clear.call(this)},Ke.search=function($e){var vt=p.prototype.search.call(this,this.toBBox($e));return q(vt)},Ke.collides=function($e){return p.prototype.collides.call(this,this.toBBox($e))},Ke.all=function(){var $e=p.prototype.all.call(this);return q($e)},Ke.toJSON=function(){return p.prototype.toJSON.call(this)},Ke.fromJSON=function($e){return p.prototype.fromJSON.call(this,$e)},Ke.toBBox=function($e){var vt;if($e.bbox)vt=$e.bbox;else if(Array.isArray($e)&&$e.length===4)vt=$e;else if(Array.isArray($e)&&$e.length===6)vt=[$e[0],$e[1],$e[3],$e[4]];else if($e.type==="Feature")vt=k($e);else if($e.type==="FeatureCollection")vt=k($e);else throw new Error("invalid geojson");return{minX:vt[0],minY:vt[1],maxX:vt[2],maxY:vt[3]}},Ke}c.exports=oe,c.exports.default=oe});Array.prototype.findIndex=Array.prototype.findIndex||function(a){if(this===null)throw new TypeError("Array.prototype.findIndex called on null or undefined");if(typeof a!="function")throw new TypeError("callback must be a function");for(var c=Object(this),p=c.length>>>0,y=arguments[1],C=0;C<p;C++)if(a.call(y,c[C],C,c))return C;return-1},Array.prototype.find=Array.prototype.find||function(a){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof a!="function")throw new TypeError("callback must be a function");for(var c=Object(this),p=c.length>>>0,y=arguments[1],C=0;C<p;C++){var k=c[C];if(a.call(y,k,C,c))return k}},typeof Object.assign!="function"&&(Object.assign=function(a){if(a==null)throw new TypeError("Cannot convert undefined or null to object");a=Object(a);for(var c=1;c<arguments.length;c++){var p=arguments[c];if(p!=null)for(var y in p)Object.prototype.hasOwnProperty.call(p,y)&&(a[y]=p[y])}return a}),function(a){a.forEach(function(c){c.hasOwnProperty("remove")||Object.defineProperty(c,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})}([Element.prototype,CharacterData.prototype,DocumentType.prototype]),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(a,c){if(this==null)throw new TypeError('"this" is null or not defined');var p=Object(this),y=p.length>>>0;if(y===0)return!1;var C=c|0,k=Math.max(C>=0?C:y-Math.abs(C),0);function I(q,oe){return q===oe||typeof q=="number"&&typeof oe=="number"&&isNaN(q)&&isNaN(oe)}for(;k<y;){if(I(p[k],a))return!0;k++}return!1}});var so={version:"2.18.3"},ln=g(Ui()),Jn={tooltips:{placeMarker:"Click to place marker",firstVertex:"Click to place first vertex",continueLine:"Click to continue drawing",finishLine:"Click any existing marker to finish",finishPoly:"Click first marker to finish",finishRect:"Click to finish",startCircle:"Click to place circle center",finishCircle:"Click to finish circle",placeCircleMarker:"Click to place circle marker",placeText:"Click to place text",selectFirstLayerFor:"Select first layer for {action}",selectSecondLayerFor:"Select second layer for {action}"},actions:{finish:"Finish",cancel:"Cancel",removeLastVertex:"Remove Last Vertex"},buttonTitles:{drawMarkerButton:"Draw Marker",drawPolyButton:"Draw Polygons",drawLineButton:"Draw Polyline",drawCircleButton:"Draw Circle",drawRectButton:"Draw Rectangle",editButton:"Edit Layers",dragButton:"Drag Layers",cutButton:"Cut Layers",deleteButton:"Remove Layers",drawCircleMarkerButton:"Draw Circle Marker",snappingButton:"Snap dragged marker to other layers and vertices",pinningButton:"Pin shared vertices together",rotateButton:"Rotate Layers",drawTextButton:"Draw Text",scaleButton:"Scale Layers",autoTracingButton:"Auto trace Line",snapGuidesButton:"Show SnapGuides",unionButton:"Union layers",differenceButton:"Subtract layers"},measurements:{totalLength:"Length",segmentLength:"Segment length",area:"Area",radius:"Radius",perimeter:"Perimeter",height:"Height",width:"Width",coordinates:"Position",coordinatesMarker:"Position Marker"}},vr={tooltips:{placeMarker:"Platziere den Marker mit Klick",firstVertex:"Platziere den ersten Marker mit Klick",continueLine:"Klicke, um weiter zu zeichnen",finishLine:"Beende mit Klick auf existierenden Marker",finishPoly:"Beende mit Klick auf ersten Marker",finishRect:"Beende mit Klick",startCircle:"Platziere das Kreiszentrum mit Klick",finishCircle:"Beende den Kreis mit Klick",placeCircleMarker:"Platziere den Kreismarker mit Klick",placeText:"Platziere den Text mit Klick"},actions:{finish:"Beenden",cancel:"Abbrechen",removeLastVertex:"Letzten Vertex löschen"},buttonTitles:{drawMarkerButton:"Marker zeichnen",drawPolyButton:"Polygon zeichnen",drawLineButton:"Polyline zeichnen",drawCircleButton:"Kreis zeichnen",drawRectButton:"Rechteck zeichnen",editButton:"Layer editieren",dragButton:"Layer bewegen",cutButton:"Layer schneiden",deleteButton:"Layer löschen",drawCircleMarkerButton:"Kreismarker zeichnen",snappingButton:"Bewegter Layer an andere Layer oder Vertexe einhacken",pinningButton:"Vertexe an der gleichen Position verknüpfen",rotateButton:"Layer drehen",drawTextButton:"Text zeichnen",scaleButton:"Layer skalieren",autoTracingButton:"Linie automatisch nachzeichen"},measurements:{totalLength:"Länge",segmentLength:"Segment Länge",area:"Fläche",radius:"Radius",perimeter:"Umfang",height:"Höhe",width:"Breite",coordinates:"Position",coordinatesMarker:"Position Marker"}},sr={tooltips:{placeMarker:"Clicca per posizionare un Marker",firstVertex:"Clicca per posizionare il primo vertice",continueLine:"Clicca per continuare a disegnare",finishLine:"Clicca qualsiasi marker esistente per terminare",finishPoly:"Clicca il primo marker per terminare",finishRect:"Clicca per terminare",startCircle:"Clicca per posizionare il punto centrale del cerchio",finishCircle:"Clicca per terminare il cerchio",placeCircleMarker:"Clicca per posizionare un Marker del cherchio"},actions:{finish:"Termina",cancel:"Annulla",removeLastVertex:"Rimuovi l'ultimo vertice"},buttonTitles:{drawMarkerButton:"Disegna Marker",drawPolyButton:"Disegna Poligoni",drawLineButton:"Disegna Polilinea",drawCircleButton:"Disegna Cerchio",drawRectButton:"Disegna Rettangolo",editButton:"Modifica Livelli",dragButton:"Sposta Livelli",cutButton:"Ritaglia Livelli",deleteButton:"Elimina Livelli",drawCircleMarkerButton:"Disegna Marker del Cerchio",snappingButton:"Snap ha trascinato il pennarello su altri strati e vertici",pinningButton:"Pin condiviso vertici insieme",rotateButton:"Ruota livello"}},pr={tooltips:{placeMarker:"Klik untuk menempatkan marker",firstVertex:"Klik untuk menempatkan vertex pertama",continueLine:"Klik untuk meneruskan digitasi",finishLine:"Klik pada sembarang marker yang ada untuk mengakhiri",finishPoly:"Klik marker pertama untuk mengakhiri",finishRect:"Klik untuk mengakhiri",startCircle:"Klik untuk menempatkan titik pusat lingkaran",finishCircle:"Klik untuk mengakhiri lingkaran",placeCircleMarker:"Klik untuk menempatkan penanda lingkarann"},actions:{finish:"Selesai",cancel:"Batal",removeLastVertex:"Hilangkan Vertex Terakhir"},buttonTitles:{drawMarkerButton:"Digitasi Marker",drawPolyButton:"Digitasi Polygon",drawLineButton:"Digitasi Polyline",drawCircleButton:"Digitasi Lingkaran",drawRectButton:"Digitasi Segi Empat",editButton:"Edit Layer",dragButton:"Geser Layer",cutButton:"Potong Layer",deleteButton:"Hilangkan Layer",drawCircleMarkerButton:"Digitasi Penanda Lingkaran",snappingButton:"Jepretkan penanda yang ditarik ke lapisan dan simpul lain",pinningButton:"Sematkan simpul bersama bersama",rotateButton:"Putar lapisan"}},Ea={tooltips:{placeMarker:"Adaugă un punct",firstVertex:"Apasă aici pentru a adăuga primul Vertex",continueLine:"Apasă aici pentru a continua desenul",finishLine:"Apasă pe orice obiect pentru a finisa desenul",finishPoly:"Apasă pe primul obiect pentru a finisa",finishRect:"Apasă pentru a finisa",startCircle:"Apasă pentru a desena un cerc",finishCircle:"Apasă pentru a finisa un cerc",placeCircleMarker:"Adaugă un punct"},actions:{finish:"Termină",cancel:"Anulează",removeLastVertex:"Șterge ultimul Vertex"},buttonTitles:{drawMarkerButton:"Adaugă o bulină",drawPolyButton:"Desenează un poligon",drawLineButton:"Desenează o linie",drawCircleButton:"Desenează un cerc",drawRectButton:"Desenează un dreptunghi",editButton:"Editează straturile",dragButton:"Mută straturile",cutButton:"Taie straturile",deleteButton:"Șterge straturile",drawCircleMarkerButton:"Desenează marcatorul cercului",snappingButton:"Fixați marcatorul glisat pe alte straturi și vârfuri",pinningButton:"Fixați vârfurile partajate împreună",rotateButton:"Rotiți stratul"}},Ao={tooltips:{placeMarker:"Нажмите, чтобы нанести маркер",firstVertex:"Нажмите, чтобы нанести первый объект",continueLine:"Нажмите, чтобы продолжить рисование",finishLine:"Нажмите любой существующий маркер для завершения",finishPoly:"Выберите первую точку, чтобы закончить",finishRect:"Нажмите, чтобы закончить",startCircle:"Нажмите, чтобы добавить центр круга",finishCircle:"Нажмите, чтобы задать радиус",placeCircleMarker:"Нажмите, чтобы нанести круговой маркер"},actions:{finish:"Завершить",cancel:"Отменить",removeLastVertex:"Отменить последнее действие"},buttonTitles:{drawMarkerButton:"Добавить маркер",drawPolyButton:"Рисовать полигон",drawLineButton:"Рисовать кривую",drawCircleButton:"Рисовать круг",drawRectButton:"Рисовать прямоугольник",editButton:"Редактировать слой",dragButton:"Перенести слой",cutButton:"Вырезать слой",deleteButton:"Удалить слой",drawCircleMarkerButton:"Добавить круговой маркер",snappingButton:"Привязать перетаскиваемый маркер к другим слоям и вершинам",pinningButton:"Связать общие точки вместе",rotateButton:"Поворот слоя"}},ho={tooltips:{placeMarker:"Presiona para colocar un marcador",firstVertex:"Presiona para colocar el primer vértice",continueLine:"Presiona para continuar dibujando",finishLine:"Presiona cualquier marcador existente para finalizar",finishPoly:"Presiona el primer marcador para finalizar",finishRect:"Presiona para finalizar",startCircle:"Presiona para colocar el centro del círculo",finishCircle:"Presiona para finalizar el círculo",placeCircleMarker:"Presiona para colocar un marcador de círculo"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Eliminar último vértice"},buttonTitles:{drawMarkerButton:"Dibujar Marcador",drawPolyButton:"Dibujar Polígono",drawLineButton:"Dibujar Línea",drawCircleButton:"Dibujar Círculo",drawRectButton:"Dibujar Rectángulo",editButton:"Editar Capas",dragButton:"Arrastrar Capas",cutButton:"Cortar Capas",deleteButton:"Eliminar Capas",drawCircleMarkerButton:"Dibujar Marcador de Círculo",snappingButton:"El marcador de Snap arrastrado a otras capas y vértices",pinningButton:"Fijar juntos los vértices compartidos",rotateButton:"Rotar capa"}},ar={tooltips:{placeMarker:"Klik om een marker te plaatsen",firstVertex:"Klik om het eerste punt te plaatsen",continueLine:"Klik om te blijven tekenen",finishLine:"Klik op een bestaand punt om te beëindigen",finishPoly:"Klik op het eerst punt om te beëindigen",finishRect:"Klik om te beëindigen",startCircle:"Klik om het middelpunt te plaatsen",finishCircle:"Klik om de cirkel te beëindigen",placeCircleMarker:"Klik om een marker te plaatsen"},actions:{finish:"Bewaar",cancel:"Annuleer",removeLastVertex:"Verwijder laatste punt"},buttonTitles:{drawMarkerButton:"Plaats Marker",drawPolyButton:"Teken een vlak",drawLineButton:"Teken een lijn",drawCircleButton:"Teken een cirkel",drawRectButton:"Teken een vierkant",editButton:"Bewerk",dragButton:"Verplaats",cutButton:"Knip",deleteButton:"Verwijder",drawCircleMarkerButton:"Plaats Marker",snappingButton:"Snap gesleepte marker naar andere lagen en hoekpunten",pinningButton:"Speld gedeelde hoekpunten samen",rotateButton:"Laag roteren"}},Es={tooltips:{placeMarker:"Cliquez pour placer un marqueur",firstVertex:"Cliquez pour placer le premier sommet",continueLine:"Cliquez pour continuer à dessiner",finishLine:"Cliquez sur n'importe quel marqueur pour terminer",finishPoly:"Cliquez sur le premier marqueur pour terminer",finishRect:"Cliquez pour terminer",startCircle:"Cliquez pour placer le centre du cercle",finishCircle:"Cliquez pour finir le cercle",placeCircleMarker:"Cliquez pour placer le marqueur circulaire"},actions:{finish:"Terminer",cancel:"Annuler",removeLastVertex:"Retirer le dernier sommet"},buttonTitles:{drawMarkerButton:"Placer des marqueurs",drawPolyButton:"Dessiner des polygones",drawLineButton:"Dessiner des polylignes",drawCircleButton:"Dessiner un cercle",drawRectButton:"Dessiner un rectangle",editButton:"Éditer des calques",dragButton:"Déplacer des calques",cutButton:"Couper des calques",deleteButton:"Supprimer des calques",drawCircleMarkerButton:"Dessiner un marqueur circulaire",snappingButton:"Glisser le marqueur vers d'autres couches et sommets",pinningButton:"Épingler ensemble les sommets partagés",rotateButton:"Tourner des calques"}},oo={tooltips:{placeMarker:"单击放置标记",firstVertex:"单击放置首个顶点",continueLine:"单击继续绘制",finishLine:"单击任何存在的标记以完成",finishPoly:"单击第一个标记以完成",finishRect:"单击完成",startCircle:"单击放置圆心",finishCircle:"单击完成圆形",placeCircleMarker:"点击放置圆形标记"},actions:{finish:"完成",cancel:"取消",removeLastVertex:"移除最后的顶点"},buttonTitles:{drawMarkerButton:"绘制标记",drawPolyButton:"绘制多边形",drawLineButton:"绘制线段",drawCircleButton:"绘制圆形",drawRectButton:"绘制长方形",editButton:"编辑图层",dragButton:"拖拽图层",cutButton:"剪切图层",deleteButton:"删除图层",drawCircleMarkerButton:"画圆圈标记",snappingButton:"将拖动的标记捕捉到其他图层和顶点",pinningButton:"将共享顶点固定在一起",rotateButton:"旋转图层"}},As={tooltips:{placeMarker:"單擊放置標記",firstVertex:"單擊放置第一個頂點",continueLine:"單擊繼續繪製",finishLine:"單擊任何存在的標記以完成",finishPoly:"單擊第一個標記以完成",finishRect:"單擊完成",startCircle:"單擊放置圓心",finishCircle:"單擊完成圓形",placeCircleMarker:"點擊放置圓形標記"},actions:{finish:"完成",cancel:"取消",removeLastVertex:"移除最後一個頂點"},buttonTitles:{drawMarkerButton:"放置標記",drawPolyButton:"繪製多邊形",drawLineButton:"繪製線段",drawCircleButton:"繪製圓形",drawRectButton:"繪製方形",editButton:"編輯圖形",dragButton:"移動圖形",cutButton:"裁切圖形",deleteButton:"刪除圖形",drawCircleMarkerButton:"畫圓圈標記",snappingButton:"將拖動的標記對齊到其他圖層和頂點",pinningButton:"將共享頂點固定在一起",rotateButton:"旋轉圖形"}},Wi={tooltips:{placeMarker:"Clique para posicionar o marcador",firstVertex:"Clique para posicionar o primeiro vértice",continueLine:"Clique para continuar desenhando",finishLine:"Clique em qualquer marcador existente para finalizar",finishPoly:"Clique no primeiro marcador para finalizar",finishRect:"Clique para finalizar",startCircle:"Clique para posicionar o centro do círculo",finishCircle:"Clique para finalizar o círculo",placeCircleMarker:"Clique para posicionar o marcador circular",placeText:"Clique para inserir texto"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Remover último vértice"},buttonTitles:{drawMarkerButton:"Desenhar Marcador",drawPolyButton:"Desenhar Polígonos",drawLineButton:"Desenhar Linha Poligonal",drawCircleButton:"Desenhar Círculo",drawRectButton:"Desenhar Retângulo",editButton:"Editar Camadas",dragButton:"Arrastar Camadas",cutButton:"Recortar Camadas",deleteButton:"Remover Camadas",drawCircleMarkerButton:"Desenhar Marcador de Círculo",snappingButton:"Ajustar marcador arrastado a outras camadas e vértices",pinningButton:"Unir vértices compartilhados",rotateButton:"Rotacionar Camadas",drawTextButton:"Desenhar Texto",scaleButton:"Redimensionar Camadas",autoTracingButton:"Traçado Automático de Linha"},measurements:{totalLength:"Comprimento",segmentLength:"Comprimento do Segmento",area:"Área",radius:"Raio",perimeter:"Perímetro",height:"Altura",width:"Largura",coordinates:"Posição",coordinatesMarker:"Marcador de Posição"}},ds={tooltips:{placeMarker:"Clique para colocar marcador",firstVertex:"Clique para colocar primeiro vértice",continueLine:"Clique para continuar a desenhar",finishLine:"Clique num marcador existente para terminar",finishPoly:"Clique no primeiro marcador para terminar",finishRect:"Clique para terminar",startCircle:"Clique para colocar o centro do círculo",finishCircle:"Clique para terminar o círculo",placeCircleMarker:"Clique para colocar marcador de círculo",placeText:"Clique para colocar texto"},actions:{finish:"Terminar",cancel:"Cancelar",removeLastVertex:"Remover Último Vértice"},buttonTitles:{drawMarkerButton:"Desenhar Marcador",drawPolyButton:"Desenhar Polígonos",drawLineButton:"Desenhar Polilinha",drawCircleButton:"Desenhar Círculo",drawRectButton:"Desenhar Retângulo",editButton:"Editar Camadas",dragButton:"Arrastar Camadas",cutButton:"Cortar Camadas",deleteButton:"Remover Camadas",drawCircleMarkerButton:"Desenhar Marcador de Círculo",snappingButton:"Ajustar marcador arrastado a outras camadas e vértices",pinningButton:"Unir vértices partilhados",rotateButton:"Rodar Camadas",drawTextButton:"Desenhar Texto",scaleButton:"Escalar Camadas",autoTracingButton:"Traçado Automático de Linha"},measurements:{totalLength:"Comprimento",segmentLength:"Comprimento do Segmento",area:"Área",radius:"Raio",perimeter:"Perímetro",height:"Altura",width:"Largura",coordinates:"Posição",coordinatesMarker:"Marcador de Posição"}},ps={tooltips:{placeMarker:"Kliknij, aby umieścić znacznik",firstVertex:"Kliknij, aby umieścić pierwszy wierzchołek",continueLine:"Kliknij, aby kontynuować rysowanie",finishLine:"Kliknij dowolny istniejący znacznik, aby zakończyć",finishPoly:"Kliknij pierwszy znacznik, aby zakończyć",finishRect:"Kliknij, aby zakończyć",startCircle:"Kliknij, aby umieścić środek okręgu",finishCircle:"Kliknij, aby zakończyć okrąg",placeCircleMarker:"Kliknij, aby umieścić znacznik okręgu",placeText:"Kliknij, aby umieścić tekst"},actions:{finish:"Zakończ",cancel:"Anuluj",removeLastVertex:"Usuń ostatni wierzchołek"},buttonTitles:{drawMarkerButton:"Rysuj znacznik",drawPolyButton:"Rysuj wielokąt",drawLineButton:"Rysuj linię",drawCircleButton:"Rysuj okrąg",drawRectButton:"Rysuj prostokąt",editButton:"Edytuj warstwy",dragButton:"Przeciągnij warstwy",cutButton:"Wytnij warstwy",deleteButton:"Usuń warstwy",drawCircleMarkerButton:"Rysuj znacznik okrągły",snappingButton:"Przyciągnij przenoszony znacznik do innych warstw i wierzchołków",pinningButton:"Przypnij wspólne wierzchołki razem",rotateButton:"Obróć warstwy",drawTextButton:"Rysuj tekst",scaleButton:"Skaluj warstwy",autoTracingButton:"Automatyczne śledzenie linii"},measurements:{totalLength:"Długość",segmentLength:"Długość odcinka",area:"Obszar",radius:"Promień",perimeter:"Obwód",height:"Wysokość",width:"Szerokość",coordinates:"Pozycja",coordinatesMarker:"Znacznik pozycji"}},fo={tooltips:{placeMarker:"Klicka för att placera markör",firstVertex:"Klicka för att placera första hörnet",continueLine:"Klicka för att fortsätta rita",finishLine:"Klicka på en existerande punkt för att slutföra",finishPoly:"Klicka på den första punkten för att slutföra",finishRect:"Klicka för att slutföra",startCircle:"Klicka för att placera cirkelns centrum",finishCircle:"Klicka för att slutföra cirkeln",placeCircleMarker:"Klicka för att placera cirkelmarkör"},actions:{finish:"Slutför",cancel:"Avbryt",removeLastVertex:"Ta bort sista hörnet"},buttonTitles:{drawMarkerButton:"Rita Markör",drawPolyButton:"Rita Polygoner",drawLineButton:"Rita Linje",drawCircleButton:"Rita Cirkel",drawRectButton:"Rita Rektangel",editButton:"Redigera Lager",dragButton:"Dra Lager",cutButton:"Klipp i Lager",deleteButton:"Ta bort Lager",drawCircleMarkerButton:"Rita Cirkelmarkör",snappingButton:"Snäpp dra markören till andra lager och hörn",pinningButton:"Fäst delade hörn tillsammans",rotateButton:"Rotera lagret"}},Vo={tooltips:{placeMarker:"Κάντε κλικ για να τοποθετήσετε Δείκτη",firstVertex:"Κάντε κλικ για να τοποθετήσετε το πρώτο σημείο",continueLine:"Κάντε κλικ για να συνεχίσετε να σχεδιάζετε",finishLine:"Κάντε κλικ σε οποιονδήποτε υπάρχον σημείο για να ολοκληρωθεί",finishPoly:"Κάντε κλικ στο πρώτο σημείο για να τελειώσετε",finishRect:"Κάντε κλικ για να τελειώσετε",startCircle:"Κάντε κλικ για να τοποθετήσετε κέντρο Κύκλου",finishCircle:"Κάντε κλικ για να ολοκληρώσετε τον Κύκλο",placeCircleMarker:"Κάντε κλικ για να τοποθετήσετε Κυκλικό Δείκτη"},actions:{finish:"Τέλος",cancel:"Ακύρωση",removeLastVertex:"Κατάργηση τελευταίου σημείου"},buttonTitles:{drawMarkerButton:"Σχεδίαση Δείκτη",drawPolyButton:"Σχεδίαση Πολυγώνου",drawLineButton:"Σχεδίαση Γραμμής",drawCircleButton:"Σχεδίαση Κύκλου",drawRectButton:"Σχεδίαση Ορθογωνίου",editButton:"Επεξεργασία Επιπέδων",dragButton:"Μεταφορά Επιπέδων",cutButton:"Αποκοπή Επιπέδων",deleteButton:"Κατάργηση Επιπέδων",drawCircleMarkerButton:"Σχεδίαση Κυκλικού Δείκτη",snappingButton:"Προσκόλληση του Δείκτη μεταφοράς σε άλλα Επίπεδα και Κορυφές",pinningButton:"Περικοπή κοινών κορυφών μαζί",rotateButton:"Περιστρέψτε το στρώμα"}},ca={tooltips:{placeMarker:"Kattintson a jelölő elhelyezéséhez",firstVertex:"Kattintson az első pont elhelyezéséhez",continueLine:"Kattintson a következő pont elhelyezéséhez",finishLine:"A befejezéshez kattintson egy meglévő pontra",finishPoly:"A befejezéshez kattintson az első pontra",finishRect:"Kattintson a befejezéshez",startCircle:"Kattintson a kör középpontjának elhelyezéséhez",finishCircle:"Kattintson a kör befejezéséhez",placeCircleMarker:"Kattintson a körjelölő elhelyezéséhez"},actions:{finish:"Befejezés",cancel:"Mégse",removeLastVertex:"Utolsó pont eltávolítása"},buttonTitles:{drawMarkerButton:"Jelölő rajzolása",drawPolyButton:"Poligon rajzolása",drawLineButton:"Vonal rajzolása",drawCircleButton:"Kör rajzolása",drawRectButton:"Négyzet rajzolása",editButton:"Elemek szerkesztése",dragButton:"Elemek mozgatása",cutButton:"Elemek vágása",deleteButton:"Elemek törlése",drawCircleMarkerButton:"Kör jelölő rajzolása",snappingButton:"Kapcsolja a jelöltőt másik elemhez vagy ponthoz",pinningButton:"Közös pontok összekötése",rotateButton:"Fólia elforgatása"}},Ha={tooltips:{placeMarker:"Tryk for at placere en markør",firstVertex:"Tryk for at placere det første punkt",continueLine:"Tryk for at fortsætte linjen",finishLine:"Tryk på et eksisterende punkt for at afslutte",finishPoly:"Tryk på det første punkt for at afslutte",finishRect:"Tryk for at afslutte",startCircle:"Tryk for at placere cirklens center",finishCircle:"Tryk for at afslutte cirklen",placeCircleMarker:"Tryk for at placere en cirkelmarkør"},actions:{finish:"Afslut",cancel:"Afbryd",removeLastVertex:"Fjern sidste punkt"},buttonTitles:{drawMarkerButton:"Placer markør",drawPolyButton:"Tegn polygon",drawLineButton:"Tegn linje",drawCircleButton:"Tegn cirkel",drawRectButton:"Tegn firkant",editButton:"Rediger",dragButton:"Træk",cutButton:"Klip",deleteButton:"Fjern",drawCircleMarkerButton:"Tegn cirkelmarkør",snappingButton:"Fastgør trukket markør til andre elementer",pinningButton:"Sammenlæg delte elementer",rotateButton:"Roter laget"}},ts={tooltips:{placeMarker:"Klikk for å plassere punkt",firstVertex:"Klikk for å plassere første punkt",continueLine:"Klikk for å tegne videre",finishLine:"Klikk på et eksisterende punkt for å fullføre",finishPoly:"Klikk første punkt for å fullføre",finishRect:"Klikk for å fullføre",startCircle:"Klikk for å sette sirkel midtpunkt",finishCircle:"Klikk for å fullføre sirkel",placeCircleMarker:"Klikk for å plassere sirkel",placeText:"Klikk for å plassere tekst"},actions:{finish:"Fullfør",cancel:"Kanseller",removeLastVertex:"Fjern forrige punkt"},buttonTitles:{drawMarkerButton:"Tegn punkt",drawPolyButton:"Tegn flate",drawLineButton:"Tegn linje",drawCircleButton:"Tegn sirkel",drawRectButton:"Tegn rektangel",editButton:"Rediger objekter",dragButton:"Dra objekter",cutButton:"Kutt objekter",deleteButton:"Fjern objekter",drawCircleMarkerButton:"Tegn sirkel-punkt",snappingButton:"Fest dratt punkt til andre objekter og punkt",pinningButton:"Pin delte punkter sammen",rotateButton:"Rotér objekter",drawTextButton:"Tegn tekst",scaleButton:"Skalér objekter",autoTracingButton:"Automatisk sporing av linje"},measurements:{totalLength:"Lengde",segmentLength:"Segmentlengde",area:"Område",radius:"Radius",perimeter:"Omriss",height:"Høyde",width:"Bredde",coordinates:"Posisjon",coordinatesMarker:"Posisjonsmarkør"}},iu={tooltips:{placeMarker:"کلیک برای جانمایی نشان",firstVertex:"کلیک برای رسم اولین رأس",continueLine:"کلیک برای ادامه رسم",finishLine:"کلیک روی هر نشان موجود برای پایان",finishPoly:"کلیک روی اولین نشان برای پایان",finishRect:"کلیک برای پایان",startCircle:"کلیک برای رسم مرکز دایره",finishCircle:"کلیک برای پایان رسم دایره",placeCircleMarker:"کلیک برای رسم نشان دایره",placeText:"کلیک برای نوشتن متن"},actions:{finish:"پایان",cancel:"لفو",removeLastVertex:"حذف آخرین رأس"},buttonTitles:{drawMarkerButton:"درج نشان",drawPolyButton:"رسم چندضلعی",drawLineButton:"رسم خط",drawCircleButton:"رسم دایره",drawRectButton:"رسم چهارضلعی",editButton:"ویرایش لایه‌ها",dragButton:"جابجایی لایه‌ها",cutButton:"برش لایه‌ها",deleteButton:"حذف لایه‌ها",drawCircleMarkerButton:"رسم نشان دایره",snappingButton:"نشانگر را به لایه‌ها و رئوس دیگر بکشید",pinningButton:"رئوس مشترک را با هم پین کنید",rotateButton:"چرخش لایه",drawTextButton:"رسم متن",scaleButton:"مقیاس‌گذاری",autoTracingButton:"ردیاب خودکار"},measurements:{totalLength:"طول",segmentLength:"طول بخش",area:"ناحیه",radius:"شعاع",perimeter:"محیط",height:"ارتفاع",width:"عرض",coordinates:"موقعیت",coordinatesMarker:"موقعیت نشان"}},cl={tooltips:{placeMarker:"Натисніть, щоб нанести маркер",firstVertex:"Натисніть, щоб нанести першу вершину",continueLine:"Натисніть, щоб продовжити малювати",finishLine:"Натисніть будь-який існуючий маркер для завершення",finishPoly:"Виберіть перший маркер, щоб завершити",finishRect:"Натисніть, щоб завершити",startCircle:"Натисніть, щоб додати центр кола",finishCircle:"Натисніть, щоб завершити коло",placeCircleMarker:"Натисніть, щоб нанести круговий маркер"},actions:{finish:"Завершити",cancel:"Відмінити",removeLastVertex:"Видалити попередню вершину"},buttonTitles:{drawMarkerButton:"Малювати маркер",drawPolyButton:"Малювати полігон",drawLineButton:"Малювати криву",drawCircleButton:"Малювати коло",drawRectButton:"Малювати прямокутник",editButton:"Редагувати шари",dragButton:"Перенести шари",cutButton:"Вирізати шари",deleteButton:"Видалити шари",drawCircleMarkerButton:"Малювати круговий маркер",snappingButton:"Прив’язати перетягнутий маркер до інших шарів та вершин",pinningButton:"Зв'язати спільні вершини разом",rotateButton:"Повернути шар"}},ri={tooltips:{placeMarker:"İşaretçi yerleştirmek için tıklayın",firstVertex:"İlk tepe noktasını yerleştirmek için tıklayın",continueLine:"Çizime devam etmek için tıklayın",finishLine:"Bitirmek için mevcut herhangi bir işaretçiyi tıklayın",finishPoly:"Bitirmek için ilk işaretçiyi tıklayın",finishRect:"Bitirmek için tıklayın",startCircle:"Daire merkezine yerleştirmek için tıklayın",finishCircle:"Daireyi bitirmek için tıklayın",placeCircleMarker:"Daire işaretçisi yerleştirmek için tıklayın"},actions:{finish:"Bitir",cancel:"İptal",removeLastVertex:"Son köşeyi kaldır"},buttonTitles:{drawMarkerButton:"Çizim İşaretçisi",drawPolyButton:"Çokgenler çiz",drawLineButton:"Çoklu çizgi çiz",drawCircleButton:"Çember çiz",drawRectButton:"Dikdörtgen çiz",editButton:"Katmanları düzenle",dragButton:"Katmanları sürükle",cutButton:"Katmanları kes",deleteButton:"Katmanları kaldır",drawCircleMarkerButton:"Daire işaretçisi çiz",snappingButton:"Sürüklenen işaretçiyi diğer katmanlara ve köşelere yapıştır",pinningButton:"Paylaşılan köşeleri birbirine sabitle",rotateButton:"Katmanı döndür"}},li={tooltips:{placeMarker:"Kliknutím vytvoříte značku",firstVertex:"Kliknutím vytvoříte první objekt",continueLine:"Kliknutím pokračujte v kreslení",finishLine:"Kliknutí na libovolnou existující značku pro dokončení",finishPoly:"Vyberte první bod pro dokončení",finishRect:"Klikněte pro dokončení",startCircle:"Kliknutím přidejte střed kruhu",finishCircle:"Нажмите, чтобы задать радиус",placeCircleMarker:"Kliknutím nastavte poloměr"},actions:{finish:"Dokončit",cancel:"Zrušit",removeLastVertex:"Zrušit poslední akci"},buttonTitles:{drawMarkerButton:"Přidat značku",drawPolyButton:"Nakreslit polygon",drawLineButton:"Nakreslit křivku",drawCircleButton:"Nakreslit kruh",drawRectButton:"Nakreslit obdélník",editButton:"Upravit vrstvu",dragButton:"Přeneste vrstvu",cutButton:"Vyjmout vrstvu",deleteButton:"Smazat vrstvu",drawCircleMarkerButton:"Přidat kruhovou značku",snappingButton:"Navázat tažnou značku k dalším vrstvám a vrcholům",pinningButton:"Spojit společné body dohromady",rotateButton:"Otočte vrstvu"}},po={tooltips:{placeMarker:"クリックしてマーカーを配置",firstVertex:"クリックして最初の頂点を配置",continueLine:"クリックして描画を続ける",finishLine:"任意のマーカーをクリックして終了",finishPoly:"最初のマーカーをクリックして終了",finishRect:"クリックして終了",startCircle:"クリックして円の中心を配置",finishCircle:"クリックして円の描画を終了",placeCircleMarker:"クリックして円マーカーを配置",placeText:"クリックしてテキストを配置"},actions:{finish:"終了",cancel:"キャンセル",removeLastVertex:"最後の頂点を削除"},buttonTitles:{drawMarkerButton:"マーカーを描画",drawPolyButton:"ポリゴンを描画",drawLineButton:"折れ線を描画",drawCircleButton:"円を描画",drawRectButton:"矩形を描画",editButton:"レイヤーを編集",dragButton:"レイヤーをドラッグ",cutButton:"レイヤーを切り取り",deleteButton:"レイヤーを削除",drawCircleMarkerButton:"円マーカーを描画",snappingButton:"ドラッグしたマーカーを他のレイヤーや頂点にスナップする",pinningButton:"共有する頂点を同時に動かす",rotateButton:"レイヤーを回転",drawTextButton:"テキストを描画"}},Ri={tooltips:{placeMarker:"Klikkaa asettaaksesi merkin",firstVertex:"Klikkaa asettaakseni ensimmäisen osuuden",continueLine:"Klikkaa jatkaaksesi piirtämistä",finishLine:"Klikkaa olemassa olevaa merkkiä lopettaaksesi",finishPoly:"Klikkaa ensimmäistä merkkiä lopettaaksesi",finishRect:"Klikkaa lopettaaksesi",startCircle:"Klikkaa asettaaksesi ympyrän keskipisteen",finishCircle:"Klikkaa lopettaaksesi ympyrän",placeCircleMarker:"Klikkaa asettaaksesi ympyrämerkin",placeText:"Klikkaa asettaaksesi tekstin"},actions:{finish:"Valmis",cancel:"Peruuta",removeLastVertex:"Poista viimeinen osuus"},buttonTitles:{drawMarkerButton:"Piirrä merkkejä",drawPolyButton:"Piirrä monikulmioita",drawLineButton:"Piirrä viivoja",drawCircleButton:"Piirrä ympyrä",drawRectButton:"Piirrä neliskulmioita",editButton:"Muokkaa",dragButton:"Siirrä",cutButton:"Leikkaa",deleteButton:"Poista",drawCircleMarkerButton:"Piirrä ympyrämerkki",snappingButton:"Kiinnitä siirrettävä merkki toisiin muotoihin",pinningButton:"Kiinnitä jaetut muodot yhteen",rotateButton:"Käännä",drawTextButton:"Piirrä tekstiä"}},Bl={tooltips:{placeMarker:"마커 위치를 클릭하세요",firstVertex:"첫번째 꼭지점 위치을 클릭하세요",continueLine:"계속 그리려면 클릭하세요",finishLine:"끝내려면 기존 마커를 클릭하세요",finishPoly:"끝내려면 처음 마커를 클릭하세요",finishRect:"끝내려면 클릭하세요",startCircle:"원의 중심이 될 위치를 클릭하세요",finishCircle:"원을 끝내려면 클릭하세요",placeCircleMarker:"원 마커 위치를 클릭하세요",placeText:"텍스트 위치를 클릭하세요"},actions:{finish:"끝내기",cancel:"취소",removeLastVertex:"마지막 꼭지점 제거"},buttonTitles:{drawMarkerButton:"마커 그리기",drawPolyButton:"다각형 그리기",drawLineButton:"다각선 그리기",drawCircleButton:"원 그리기",drawRectButton:"직사각형 그리기",editButton:"레이어 편집하기",dragButton:"레이어 끌기",cutButton:"레이어 자르기",deleteButton:"레이어 제거하기",drawCircleMarkerButton:"원 마커 그리기",snappingButton:"잡아끈 마커를 다른 레이어 및 꼭지점에 들러붙게 하기",pinningButton:"공유 꼭지점을 함께 찍기",rotateButton:"레이어 회전하기",drawTextButton:"텍스트 그리기"}},Aa={tooltips:{placeMarker:"Маркерди жайгаштыруу үчүн басыңыз",firstVertex:"Биринчи чокуну жайгаштырууну үчүн басыңыз",continueLine:"Сүрөт тартууну улантуу үчүн басыңыз",finishLine:"Аяктоо үчүн учурдагы маркерди басыңыз",finishPoly:"Бүтүрүү үчүн биринчи маркерди басыңыз",finishRect:"Бүтүрүү үчүн басыңыз",startCircle:"Айлананын борборун жайгаштырууну үчүн басыңыз",finishCircle:"Айлананы бүтүрүү үчүн басыңыз",placeCircleMarker:"Тегерек маркерди жайгаштыруу үчүн басыңыз",placeText:"Текстти жайгаштыруу үчүн басыңыз"},actions:{finish:"Аягы",cancel:"Жок кылуу",removeLastVertex:"Акыркы чокуну өчүрүү"},buttonTitles:{drawMarkerButton:"Маркерди чизуу",drawPolyButton:"Полигон чизуу",drawLineButton:"Полилиния чизуу",drawCircleButton:"Дайынды чизуу",drawRectButton:"Прямоугольник чизуу",editButton:"Слоопту түзөтүү",dragButton:"Слоопту карап сүйлөү",cutButton:"Слооптун башын кесүү",deleteButton:"Слооптун өчүрүү",drawCircleMarkerButton:"Дайынды маркерди чизуу",snappingButton:"Башка слооптордун жана вертекстердин арасына чекилдөө",pinningButton:"Бөлүшкөн вертекстерди бирге тутуштуруу",rotateButton:"Слооптун өзгөртүү",drawTextButton:"Текст чизуу",scaleButton:"Слооптун өлчөмүн өзгөртүү",autoTracingButton:"Автоматтык тизмеги чизуу"},measurements:{totalLength:"Узундук",segmentLength:"Сегмент узундугу",area:"Аймак",radius:"Радиус",perimeter:"Периметр",height:"Диаметр",width:"Кенчилик",coordinates:"Координаттар",coordinatesMarker:"Маркердин координаттары"}},Ma=ds,go={en:Jn,de:vr,it:sr,id:pr,ro:Ea,ru:Ao,es:ho,nl:ar,fr:Es,pt:Ma,pt_br:Wi,pt_pt:ds,zh:oo,zh_tw:As,pl:ps,sv:fo,el:Vo,hu:ca,da:Ha,no:ts,fa:iu,ua:cl,tr:ri,cz:li,ja:po,fi:Ri,ko:Bl,ky:Aa},ha={_globalEditModeEnabled:!1,enableGlobalEditMode(a){let c={...a};this._globalEditModeEnabled=!0,this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),L.PM.Utils.findLayers(this.map).forEach(p=>{this._isRelevantForEdit(p)&&p.pm.enable(c)}),this.throttledReInitEdit||(this.throttledReInitEdit=L.Util.throttle(this.handleLayerAdditionInGlobalEditMode,100,this)),this._addedLayersEdit={},this.map.on("layeradd",this._layerAddedEdit,this),this.map.on("layeradd",this.throttledReInitEdit,this),this._fireGlobalEditModeToggled(!0)},disableGlobalEditMode(){this._globalEditModeEnabled=!1,L.PM.Utils.findLayers(this.map).forEach(a=>{a.pm.disable()}),this.map.off("layeradd",this._layerAddedEdit,this),this.map.off("layeradd",this.throttledReInitEdit,this),this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),this._fireGlobalEditModeToggled(!1)},globalEditEnabled(){return this.globalEditModeEnabled()},globalEditModeEnabled(){return this._globalEditModeEnabled},toggleGlobalEditMode(a=this.globalOptions){this.globalEditModeEnabled()?this.disableGlobalEditMode():this.enableGlobalEditMode(a)},handleLayerAdditionInGlobalEditMode(){let a=this._addedLayersEdit;if(this._addedLayersEdit={},this.globalEditModeEnabled())for(let c in a){let p=a[c];this._isRelevantForEdit(p)&&p.pm.enable({...this.globalOptions})}},_layerAddedEdit({layer:a}){this._addedLayersEdit[L.stamp(a)]=a},_isRelevantForEdit(a){return a.pm&&!(a instanceof L.LayerGroup)&&(!L.PM.optIn&&!a.options.pmIgnore||L.PM.optIn&&a.options.pmIgnore===!1)&&!a._pmTempLayer&&a.pm.options.allowEditing}},Nl=ha,Wa={_globalDragModeEnabled:!1,enableGlobalDragMode(){let a=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!0,this._addedLayersDrag={},a.forEach(c=>{this._isRelevantForDrag(c)&&c.pm.enableLayerDrag()}),this.throttledReInitDrag||(this.throttledReInitDrag=L.Util.throttle(this.reinitGlobalDragMode,100,this)),this.map.on("layeradd",this._layerAddedDrag,this),this.map.on("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!0)},disableGlobalDragMode(){let a=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!1,a.forEach(c=>{c.pm.disableLayerDrag()}),this.map.off("layeradd",this._layerAddedDrag,this),this.map.off("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!1)},globalDragModeEnabled(){return!!this._globalDragModeEnabled},toggleGlobalDragMode(){this.globalDragModeEnabled()?this.disableGlobalDragMode():this.enableGlobalDragMode()},reinitGlobalDragMode(){let a=this._addedLayersDrag;if(this._addedLayersDrag={},this.globalDragModeEnabled())for(let c in a){let p=a[c];this._isRelevantForDrag(p)&&p.pm.enableLayerDrag()}},_layerAddedDrag({layer:a}){this._addedLayersDrag[L.stamp(a)]=a},_isRelevantForDrag(a){return a.pm&&!(a instanceof L.LayerGroup)&&(!L.PM.optIn&&!a.options.pmIgnore||L.PM.optIn&&a.options.pmIgnore===!1)&&!a._pmTempLayer&&a.pm.options.draggable}},oi=Wa,wi={_globalRemovalModeEnabled:!1,enableGlobalRemovalMode(){this._globalRemovalModeEnabled=!0,this.map.eachLayer(a=>{this._isRelevantForRemoval(a)&&(a.pm.enabled()&&a.pm.disable(),a.on("click",this.removeLayer,this))}),this.throttledReInitRemoval||(this.throttledReInitRemoval=L.Util.throttle(this.handleLayerAdditionInGlobalRemovalMode,100,this)),this._addedLayersRemoval={},this.map.on("layeradd",this._layerAddedRemoval,this),this.map.on("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!0)},disableGlobalRemovalMode(){this._globalRemovalModeEnabled=!1,this.map.eachLayer(a=>{a.off("click",this.removeLayer,this)}),this.map.off("layeradd",this._layerAddedRemoval,this),this.map.off("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!1)},globalRemovalEnabled(){return this.globalRemovalModeEnabled()},globalRemovalModeEnabled(){return!!this._globalRemovalModeEnabled},toggleGlobalRemovalMode(){this.globalRemovalModeEnabled()?this.disableGlobalRemovalMode():this.enableGlobalRemovalMode()},removeLayer(a){let c=a.target;this._isRelevantForRemoval(c)&&!c.pm.dragging()&&(c.removeFrom(this.map.pm._getContainingLayer()),c.remove(),c instanceof L.LayerGroup?(this._fireRemoveLayerGroup(c),this._fireRemoveLayerGroup(this.map,c)):(c.pm._fireRemove(c),c.pm._fireRemove(this.map,c)))},_isRelevantForRemoval(a){return a.pm&&!(a instanceof L.LayerGroup)&&(!L.PM.optIn&&!a.options.pmIgnore||L.PM.optIn&&a.options.pmIgnore===!1)&&!a._pmTempLayer&&a.pm.options.allowRemoval},handleLayerAdditionInGlobalRemovalMode(){let a=this._addedLayersRemoval;if(this._addedLayersRemoval={},this.globalRemovalModeEnabled())for(let c in a){let p=a[c];this._isRelevantForRemoval(p)&&(p.pm.enabled()&&p.pm.disable(),p.on("click",this.removeLayer,this))}},_layerAddedRemoval({layer:a}){this._addedLayersRemoval[L.stamp(a)]=a}},fa=wi,ru={_globalRotateModeEnabled:!1,enableGlobalRotateMode(){this._globalRotateModeEnabled=!0,L.PM.Utils.findLayers(this.map).filter(a=>a instanceof L.Polyline).forEach(a=>{this._isRelevantForRotate(a)&&a.pm.enableRotate()}),this.throttledReInitRotate||(this.throttledReInitRotate=L.Util.throttle(this.handleLayerAdditionInGlobalRotateMode,100,this)),this._addedLayersRotate={},this.map.on("layeradd",this._layerAddedRotate,this),this.map.on("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},disableGlobalRotateMode(){this._globalRotateModeEnabled=!1,L.PM.Utils.findLayers(this.map).filter(a=>a instanceof L.Polyline).forEach(a=>{a.pm.disableRotate()}),this.map.off("layeradd",this._layerAddedRotate,this),this.map.off("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},globalRotateModeEnabled(){return!!this._globalRotateModeEnabled},toggleGlobalRotateMode(){this.globalRotateModeEnabled()?this.disableGlobalRotateMode():this.enableGlobalRotateMode()},_isRelevantForRotate(a){return a.pm&&a instanceof L.Polyline&&!(a instanceof L.LayerGroup)&&(!L.PM.optIn&&!a.options.pmIgnore||L.PM.optIn&&a.options.pmIgnore===!1)&&!a._pmTempLayer&&a.pm.options.allowRotation},handleLayerAdditionInGlobalRotateMode(){let a=this._addedLayersRotate;if(this._addedLayersRotate={},this.globalRotateModeEnabled())for(let c in a){let p=a[c];this._isRelevantForRemoval(p)&&p.pm.enableRotate()}},_layerAddedRotate({layer:a}){this._addedLayersRotate[L.stamp(a)]=a}},Za=ru,hl=g(Ui()),ka={_fireDrawStart(a="Draw",c={}){this.__fire(this._map,"pm:drawstart",{shape:this._shape,workingLayer:this._layer},a,c)},_fireDrawEnd(a="Draw",c={}){this.__fire(this._map,"pm:drawend",{shape:this._shape},a,c)},_fireCreate(a,c="Draw",p={}){this.__fire(this._map,"pm:create",{shape:this._shape,marker:a,layer:a},c,p)},_fireCenterPlaced(a="Draw",c={}){let p=a==="Draw"?this._layer:void 0,y=a!=="Draw"?this._layer:void 0;this.__fire(this._layer,"pm:centerplaced",{shape:this._shape,workingLayer:p,layer:y,latlng:this._layer.getLatLng()},a,c)},_fireCut(a,c,p,y="Draw",C={}){this.__fire(a,"pm:cut",{shape:this._shape,layer:c,originalLayer:p},y,C)},_fireEdit(a=this._layer,c="Edit",p={}){this.__fire(a,"pm:edit",{layer:this._layer,shape:this.getShape()},c,p)},_fireEnable(a="Edit",c={}){this.__fire(this._layer,"pm:enable",{layer:this._layer,shape:this.getShape()},a,c)},_fireDisable(a="Edit",c={}){this.__fire(this._layer,"pm:disable",{layer:this._layer,shape:this.getShape()},a,c)},_fireUpdate(a="Edit",c={}){this.__fire(this._layer,"pm:update",{layer:this._layer,shape:this.getShape()},a,c)},_fireMarkerDragStart(a,c=void 0,p="Edit",y={}){this.__fire(this._layer,"pm:markerdragstart",{layer:this._layer,markerEvent:a,shape:this.getShape(),indexPath:c},p,y)},_fireMarkerDrag(a,c=void 0,p="Edit",y={}){this.__fire(this._layer,"pm:markerdrag",{layer:this._layer,markerEvent:a,shape:this.getShape(),indexPath:c},p,y)},_fireMarkerDragEnd(a,c=void 0,p=void 0,y="Edit",C={}){this.__fire(this._layer,"pm:markerdragend",{layer:this._layer,markerEvent:a,shape:this.getShape(),indexPath:c,intersectionReset:p},y,C)},_fireDragStart(a="Edit",c={}){this.__fire(this._layer,"pm:dragstart",{layer:this._layer,shape:this.getShape()},a,c)},_fireDrag(a,c="Edit",p={}){this.__fire(this._layer,"pm:drag",{...a,shape:this.getShape()},c,p)},_fireDragEnd(a="Edit",c={}){this.__fire(this._layer,"pm:dragend",{layer:this._layer,shape:this.getShape()},a,c)},_fireDragEnable(a="Edit",c={}){this.__fire(this._layer,"pm:dragenable",{layer:this._layer,shape:this.getShape()},a,c)},_fireDragDisable(a="Edit",c={}){this.__fire(this._layer,"pm:dragdisable",{layer:this._layer,shape:this.getShape()},a,c)},_fireRemove(a,c=a,p="Edit",y={}){this.__fire(a,"pm:remove",{layer:c,shape:this.getShape()},p,y)},_fireVertexAdded(a,c,p,y="Edit",C={}){this.__fire(this._layer,"pm:vertexadded",{layer:this._layer,workingLayer:this._layer,marker:a,indexPath:c,latlng:p,shape:this.getShape()},y,C)},_fireVertexRemoved(a,c,p="Edit",y={}){this.__fire(this._layer,"pm:vertexremoved",{layer:this._layer,marker:a,indexPath:c,shape:this.getShape()},p,y)},_fireVertexClick(a,c,p="Edit",y={}){this.__fire(this._layer,"pm:vertexclick",{layer:this._layer,markerEvent:a,indexPath:c,shape:this.getShape()},p,y)},_fireIntersect(a,c=this._layer,p="Edit",y={}){this.__fire(c,"pm:intersect",{layer:this._layer,intersection:a,shape:this.getShape()},p,y)},_fireLayerReset(a,c,p="Edit",y={}){this.__fire(this._layer,"pm:layerreset",{layer:this._layer,markerEvent:a,indexPath:c,shape:this.getShape()},p,y)},_fireChange(a,c="Edit",p={}){this.__fire(this._layer,"pm:change",{layer:this._layer,latlngs:a,shape:this.getShape()},c,p)},_fireTextChange(a,c="Edit",p={}){this.__fire(this._layer,"pm:textchange",{layer:this._layer,text:a,shape:this.getShape()},c,p)},_fireTextFocus(a="Edit",c={}){this.__fire(this._layer,"pm:textfocus",{layer:this._layer,shape:this.getShape()},a,c)},_fireTextBlur(a="Edit",c={}){this.__fire(this._layer,"pm:textblur",{layer:this._layer,shape:this.getShape()},a,c)},_fireSnapDrag(a,c,p="Snapping",y={}){this.__fire(a,"pm:snapdrag",c,p,y)},_fireSnap(a,c,p="Snapping",y={}){this.__fire(a,"pm:snap",c,p,y)},_fireUnsnap(a,c,p="Snapping",y={}){this.__fire(a,"pm:unsnap",c,p,y)},_fireRotationEnable(a,c,p="Rotation",y={}){this.__fire(a,"pm:rotateenable",{layer:this._layer,helpLayer:this._rotatePoly,shape:this.getShape()},p,y)},_fireRotationDisable(a,c="Rotation",p={}){this.__fire(a,"pm:rotatedisable",{layer:this._layer,shape:this.getShape()},c,p)},_fireRotationStart(a,c,p="Rotation",y={}){this.__fire(a,"pm:rotatestart",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:this._startAngle,originLatLngs:c},p,y)},_fireRotation(a,c,p,y=this._rotationLayer,C="Rotation",k={}){this.__fire(a,"pm:rotate",{layer:y,helpLayer:this._layer,startAngle:this._startAngle,angle:y.pm.getAngle(),angleDiff:c,oldLatLngs:p,newLatLngs:y.getLatLngs()},C,k)},_fireRotationEnd(a,c,p,y="Rotation",C={}){this.__fire(a,"pm:rotateend",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:c,angle:this._rotationLayer.pm.getAngle(),originLatLngs:p,newLatLngs:this._rotationLayer.getLatLngs()},y,C)},_fireActionClick(a,c,p,y="Toolbar",C={}){this.__fire(this._map,"pm:actionclick",{text:a.text,action:a,btnName:c,button:p},y,C)},_fireButtonClick(a,c,p="Toolbar",y={}){this.__fire(this._map,"pm:buttonclick",{btnName:a,button:c},p,y)},_fireLangChange(a,c,p,y,C="Global",k={}){this.__fire(this.map,"pm:langchange",{oldLang:a,activeLang:c,fallback:p,translations:y},C,k)},_fireGlobalDragModeToggled(a,c="Global",p={}){this.__fire(this.map,"pm:globaldragmodetoggled",{enabled:a,map:this.map},c,p)},_fireGlobalEditModeToggled(a,c="Global",p={}){this.__fire(this.map,"pm:globaleditmodetoggled",{enabled:a,map:this.map},c,p)},_fireGlobalRemovalModeToggled(a,c="Global",p={}){this.__fire(this.map,"pm:globalremovalmodetoggled",{enabled:a,map:this.map},c,p)},_fireGlobalCutModeToggled(a="Global",c={}){this.__fire(this._map,"pm:globalcutmodetoggled",{enabled:!!this._enabled,map:this._map},a,c)},_fireGlobalDrawModeToggled(a="Global",c={}){this.__fire(this._map,"pm:globaldrawmodetoggled",{enabled:this._enabled,shape:this._shape,map:this._map},a,c)},_fireGlobalRotateModeToggled(a="Global",c={}){this.__fire(this.map,"pm:globalrotatemodetoggled",{enabled:this.globalRotateModeEnabled(),map:this.map},a,c)},_fireRemoveLayerGroup(a,c=a,p="Edit",y={}){this.__fire(a,"pm:remove",{layer:c,shape:void 0},p,y)},_fireKeyeventEvent(a,c,p,y="Global",C={}){this.__fire(this.map,"pm:keyevent",{event:a,eventType:c,focusOn:p},y,C)},__fire(a,c,p,y,C={}){p=(0,hl.default)(p,C,{source:y}),L.PM.Utils._fireEvent(a,c,p)}},Ka=ka,fl=()=>({_lastEvents:{keydown:void 0,keyup:void 0,current:void 0},_initKeyListener(a){this.map=a,L.DomEvent.on(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.on(window,"blur",this._onBlur,this),a.once("unload",this._unbindKeyListenerEvents,this)},_unbindKeyListenerEvents(){L.DomEvent.off(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.off(window,"blur",this._onBlur,this)},_onKeyListener(a){let c="document";this.map.getContainer().contains(a.target)&&(c="map");let p={event:a,eventType:a.type,focusOn:c};this._lastEvents[a.type]=p,this._lastEvents.current=p,this.map.pm._fireKeyeventEvent(a,a.type,c)},_onBlur(a){a.altKey=!1;let c={event:a,eventType:a.type,focusOn:"document"};this._lastEvents[a.type]=c,this._lastEvents.current=c},getLastKeyEvent(a="current"){return this._lastEvents[a]},isShiftKeyPressed(){var a;return(a=this._lastEvents.current)==null?void 0:a.event.shiftKey},isAltKeyPressed(){var a;return(a=this._lastEvents.current)==null?void 0:a.event.altKey},isCtrlKeyPressed(){var a;return(a=this._lastEvents.current)==null?void 0:a.event.ctrlKey},isMetaKeyPressed(){var a;return(a=this._lastEvents.current)==null?void 0:a.event.metaKey},getPressedKey(){var a;return(a=this._lastEvents.current)==null?void 0:a.event.key}}),Si=fl,Nr=g(ii());function Gn(a){let c=L.PM.activeLang;return(0,Nr.default)(go[c],a)||(0,Nr.default)(go.en,a)||a}function Rr(a){for(let c=0;c<a.length;c+=1){let p=a[c];if(Array.isArray(p)){if(Rr(p))return!0}else if(p!=null&&p!=="")return!0}return!1}function Ta(a){return a.reduce((c,p)=>{if(p.length!==0){let y=Array.isArray(p)?Ta(p):p;Array.isArray(y)?y.length!==0&&c.push(y):c.push(y)}return c},[])}function Go(a,c,p){let y={a:L.CRS.Earth.R,b:63567523142e-4,f:.0033528106647474805},{a:C,b:k,f:I}=y,q=a.lng,oe=a.lat,ve=p,Ke=Math.PI,$e=c*Ke/180,vt=Math.sin($e),Nt=Math.cos($e),Wt=(1-I)*Math.tan(oe*Ke/180),gn=1/Math.sqrt(1+Wt*Wt),bn=Wt*gn,Zn=Math.atan2(Wt,Nt),Ze=gn*vt,it=1-Ze*Ze,ht=it*(C*C-k*k)/(k*k),It=1+ht/16384*(4096+ht*(-768+ht*(320-175*ht))),xt=ht/1024*(256+ht*(-128+ht*(74-47*ht))),Rt=ve/(k*It),fe=2*Math.PI,we,De,Ne;for(;Math.abs(Rt-fe)>1e-12;){we=Math.cos(2*Zn+Rt),De=Math.sin(Rt),Ne=Math.cos(Rt);let en=xt*De*(we+xt/4*(Ne*(-1+2*we*we)-xt/6*we*(-3+4*De*De)*(-3+4*we*we)));fe=Rt,Rt=ve/(k*It)+en}let ze=bn*De-gn*Ne*Nt,Ue=Math.atan2(bn*Ne+gn*De*Nt,(1-I)*Math.sqrt(Ze*Ze+ze*ze)),lt=Math.atan2(De*vt,gn*Ne-bn*De*Nt),ut=I/16*it*(4+I*(4-3*it)),pt=lt-(1-ut)*I*Ze*(Rt+ut*De*(we+ut*Ne*(-1+2*we*we))),Et=q+pt*180/Ke,At=Ue*180/Ke;return L.latLng(Et,At)}function yr(a,c,p,y,C=!0){let k,I,q,oe=[];for(let ve=0;ve<p;ve+=1){if(C)k=ve*360/p+y,I=Go(a,k,c),q=L.latLng(I.lng,I.lat);else{let Ke=a.lat+Math.cos(2*ve*Math.PI/p)*c,$e=a.lng+Math.sin(2*ve*Math.PI/p)*c;q=L.latLng(Ke,$e)}oe.push(q)}return oe}function dl(a,c,p){c=(c+360)%360;let y=Math.PI/180,C=180/Math.PI,{R:k}=L.CRS.Earth,I=a.lng*y,q=a.lat*y,oe=c*y,ve=Math.sin(q),Ke=Math.cos(q),$e=Math.cos(p/k),vt=Math.sin(p/k),Nt=Math.asin(ve*$e+Ke*vt*Math.cos(oe)),Wt=I+Math.atan2(Math.sin(oe)*vt*Ke,$e-ve*Math.sin(Nt));Wt*=C;let gn=Wt-360,bn=Wt<-180?Wt+360:Wt;return Wt=Wt>180?gn:bn,L.latLng([Nt*C,Wt])}function Mo(a,c,p){let y=a.latLngToContainerPoint(c),C=a.latLngToContainerPoint(p),k=Math.atan2(C.y-y.y,C.x-y.x)*180/Math.PI+90;return k+=k<0?360:0,k}function Ja(a,c,p,y){let C=Mo(a,c,p);return dl(c,C,y)}function Ya(a,c,p="asc"){if(!c||Object.keys(c).length===0)return(oe,ve)=>oe-ve;let y=Object.keys(c),C,k=y.length-1,I={};for(;k>=0;)C=y[k],I[C.toLowerCase()]=c[C],k-=1;function q(oe){if(oe instanceof L.Marker)return"Marker";if(oe instanceof L.Circle)return"Circle";if(oe instanceof L.CircleMarker)return"CircleMarker";if(oe instanceof L.Rectangle)return"Rectangle";if(oe instanceof L.Polygon)return"Polygon";if(oe instanceof L.Polyline)return"Line"}return(oe,ve)=>{let Ke,$e;if(Ke=q(oe.layer).toLowerCase(),$e=q(ve.layer).toLowerCase(),!Ke||!$e)return 0;let vt=Ke in I?I[Ke]:Number.MAX_SAFE_INTEGER,Nt=$e in I?I[$e]:Number.MAX_SAFE_INTEGER,Wt=0;return vt<Nt?Wt=-1:vt>Nt&&(Wt=1),p==="desc"?Wt*-1:Wt}}function ao(a,c=a.getLatLngs()){return a instanceof L.Polygon?L.polygon(c).getLatLngs():L.polyline(c).getLatLngs()}function Xa(a,c){var p,y,C,k;if((y=(p=c.options.crs)==null?void 0:p.projection)!=null&&y.MAX_LATITUDE){let I=(k=(C=c.options.crs)==null?void 0:C.projection)==null?void 0:k.MAX_LATITUDE;a.lat=Math.max(Math.min(I,a.lat),-I)}return a}function Zi(a){return a.options.renderer||a._map&&(a._map._getPaneRenderer(a.options.pane)||a._map.options.renderer||a._map._renderer)||a._renderer}var su=L.Class.extend({includes:[Nl,oi,fa,Za,Ka],initialize(a){this.map=a,this.Draw=new L.PM.Draw(a),this.Toolbar=new L.PM.Toolbar(a),this.Keyboard=Si(),this.globalOptions={snappable:!0,layerGroup:void 0,snappingOrder:["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],panes:{vertexPane:"markerPane",layerPane:"overlayPane",markerPane:"markerPane"},draggable:!0},this.Keyboard._initKeyListener(a)},setLang(a="en",c,p="en"){if(a=a.trim().toLowerCase(),!/^[a-z]{2}$/.test(a)){let C=a.replace(/[-_\s]/g,"-").replace(/^(\w{2})$/,"$1-").match(/([a-z]{2})-?([a-z]{2})?/);if(C){let k=[`${C[1]}_${C[2]}`,`${C[1]}`];for(let I of k)if(go[I]){a=I;break}}}let y=L.PM.activeLang;c&&(go[a]=(0,ln.default)(go[p],c)),L.PM.activeLang=a,this.map.pm.Toolbar.reinit(),this._fireLangChange(y,a,p,go[a])},addControls(a){this.Toolbar.addControls(a)},removeControls(){this.Toolbar.removeControls()},toggleControls(){this.Toolbar.toggleControls()},controlsVisible(){return this.Toolbar.isVisible},enableDraw(a="Polygon",c){a==="Poly"&&(a="Polygon"),this.Draw.enable(a,c)},disableDraw(a="Polygon"){a==="Poly"&&(a="Polygon"),this.Draw.disable(a)},setPathOptions(a,c={}){let p=c.ignoreShapes||[],y=c.merge||!1;this.map.pm.Draw.shapes.forEach(C=>{p.indexOf(C)===-1&&this.map.pm.Draw[C].setPathOptions(a,y)})},getGlobalOptions(){return this.globalOptions},setGlobalOptions(a){let c=(0,ln.default)(this.globalOptions,a);c.editable&&(c.resizeableCircleMarker=c.editable,delete c.editable);let p=!1;this.map.pm.Draw.CircleMarker.enabled()&&!!this.map.pm.Draw.CircleMarker.options.resizeableCircleMarker!=!!c.resizeableCircleMarker&&(this.map.pm.Draw.CircleMarker.disable(),p=!0);let y=!1;this.map.pm.Draw.Circle.enabled()&&!!this.map.pm.Draw.Circle.options.resizeableCircle!=!!c.resizeableCircle&&(this.map.pm.Draw.Circle.disable(),y=!0),this.map.pm.Draw.shapes.forEach(C=>{this.map.pm.Draw[C].setOptions(c)}),p&&this.map.pm.Draw.CircleMarker.enable(),y&&this.map.pm.Draw.Circle.enable(),L.PM.Utils.findLayers(this.map).forEach(C=>{C.pm.setOptions(c)}),this.map.fire("pm:globaloptionschanged"),this.globalOptions=c,this.applyGlobalOptions()},applyGlobalOptions(){L.PM.Utils.findLayers(this.map).forEach(a=>{a.pm.enabled()&&a.pm.applyOptions()})},globalDrawModeEnabled(){return!!this.Draw.getActiveShape()},globalCutModeEnabled(){return!!this.Draw.Cut.enabled()},enableGlobalCutMode(a){return this.Draw.Cut.enable(a)},toggleGlobalCutMode(a){return this.Draw.Cut.toggle(a)},disableGlobalCutMode(){return this.Draw.Cut.disable()},getGeomanLayers(a=!1){let c=L.PM.Utils.findLayers(this.map);if(!a)return c;let p=L.featureGroup();return p._pmTempLayer=!0,c.forEach(y=>{p.addLayer(y)}),p},getGeomanDrawLayers(a=!1){let c=L.PM.Utils.findLayers(this.map).filter(y=>y._drawnByGeoman===!0);if(!a)return c;let p=L.featureGroup();return p._pmTempLayer=!0,c.forEach(y=>{p.addLayer(y)}),p},_getContainingLayer(){return this.globalOptions.layerGroup&&this.globalOptions.layerGroup instanceof L.LayerGroup?this.globalOptions.layerGroup:this.map},_isCRSSimple(){return this.map.options.crs===L.CRS.Simple},_touchEventCounter:0,_addTouchEvents(a){this._touchEventCounter===0&&(L.DomEvent.on(a,"touchmove",this._canvasTouchMove,this),L.DomEvent.on(a,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter+=1},_removeTouchEvents(a){this._touchEventCounter===1&&(L.DomEvent.off(a,"touchmove",this._canvasTouchMove,this),L.DomEvent.off(a,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter=this._touchEventCounter<=1?0:this._touchEventCounter-1},_canvasTouchMove(a){Zi(this.map)._onMouseMove(this._createMouseEvent("mousemove",a))},_canvasTouchClick(a){let c="";a.type==="touchstart"||a.type==="pointerdown"?c="mousedown":(a.type==="touchend"||a.type==="pointerup"||a.type==="touchcancel"||a.type==="pointercancel")&&(c="mouseup"),c&&Zi(this.map)._onClick(this._createMouseEvent(c,a))},_createMouseEvent(a,c){let p,y=c.touches[0]||c.changedTouches[0];try{p=new MouseEvent(a,{bubbles:c.bubbles,cancelable:c.cancelable,view:c.view,detail:y.detail,screenX:y.screenX,screenY:y.screenY,clientX:y.clientX,clientY:y.clientY,ctrlKey:c.ctrlKey,altKey:c.altKey,shiftKey:c.shiftKey,metaKey:c.metaKey,button:c.button,relatedTarget:c.relatedTarget})}catch{p=document.createEvent("MouseEvents"),p.initMouseEvent(a,c.bubbles,c.cancelable,c.view,y.detail,y.screenX,y.screenY,y.clientX,y.clientY,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,c.button,c.relatedTarget)}return p}}),ss=su,mo=L.Control.extend({includes:[Ka],options:{position:"topleft",disableByOtherButtons:!0},initialize(a){this._button=L.Util.extend({},this.options,a)},onAdd(a){return this._map=a,this._map.pm.Toolbar.options.oneBlock?this._container=this._map.pm.Toolbar._createContainer(this.options.position):this._button.tool==="edit"?this._container=this._map.pm.Toolbar.editContainer:this._button.tool==="options"?this._container=this._map.pm.Toolbar.optionsContainer:this._button.tool==="custom"?this._container=this._map.pm.Toolbar.customContainer:this._container=this._map.pm.Toolbar.drawContainer,this._renderButton(),this._container},_renderButton(){let a=this.buttonsDomNode;this.buttonsDomNode=this._makeButton(this._button),a?a.replaceWith(this.buttonsDomNode):this._container.appendChild(this.buttonsDomNode)},onRemove(){return this.buttonsDomNode.remove(),this._container},getText(){return this._button.text},getIconUrl(){return this._button.iconUrl},destroy(){this._button={},this._update()},toggle(a){return typeof a=="boolean"?this._button.toggleStatus=a:this._button.toggleStatus=!this._button.toggleStatus,this._applyStyleClasses(),this._updateActiveAction(this._button),this._button.toggleStatus},toggled(){return this._button.toggleStatus},onCreate(){this.toggle(!1)},disable(){this.toggle(!1),this._button.disabled=!0,this._updateDisabled()},enable(){this._button.disabled=!1,this._updateDisabled(),this._updateActiveAction(this._button)},_triggerClick(a){a&&a.preventDefault(),!this._button.disabled&&(this._button.onClick(a,{button:this,event:a}),this._clicked(a),this._button.afterClick(a,{button:this,event:a}))},_makeButton(a){let c=this.options.position.indexOf("right")>-1?"pos-right":"",p=L.DomUtil.create("div",`button-container  ${c}`,this._container);a.title&&p.setAttribute("title",a.title);let y=L.DomUtil.create("a","leaflet-buttons-control-button",p);y.setAttribute("role","button"),y.setAttribute("tabindex","0"),y.href="#";let C=L.DomUtil.create("div",`leaflet-pm-actions-container ${c}`,p),k=a.actions,I={cancel:{text:Gn("actions.cancel"),title:Gn("actions.cancel"),onClick(){this._triggerClick()}},finishMode:{text:Gn("actions.finish"),title:Gn("actions.finish"),onClick(){this._triggerClick()}},removeLastVertex:{text:Gn("actions.removeLastVertex"),title:Gn("actions.removeLastVertex"),onClick(){this._map.pm.Draw[a.jsClass]._removeLastVertex()}},finish:{text:Gn("actions.finish"),title:Gn("actions.finish"),onClick(oe){this._map.pm.Draw[a.jsClass]._finishShape(oe)}}};a._preparedActions=k.map(oe=>{let ve=typeof oe=="string"?oe:oe.name,Ke;if(I[ve])Ke=I[ve];else if(oe.text)Ke=oe;else return Ke;let $e=L.DomUtil.create("a",`leaflet-pm-action ${c} action-${ve}`,C);if($e.setAttribute("role","button"),$e.setAttribute("tabindex","0"),$e.href="#",Ke.title&&($e.title=Ke.title),$e.innerHTML=Ke.text,L.DomEvent.disableClickPropagation($e),L.DomEvent.on($e,"click",L.DomEvent.stop),Ke._node=$e,!a.disabled&&Ke.onClick){let vt=Nt=>{Nt.preventDefault();let Wt="",{buttons:gn}=this._map.pm.Toolbar;for(let bn in gn)if(gn[bn]._button===a){Wt=bn;break}this._fireActionClick(Ke,Wt,a)};L.DomEvent.addListener($e,"click",vt,this),L.DomEvent.addListener($e,"click",Ke.onClick,this),L.DomEvent.addListener($e,"click",()=>this._updateActiveAction(a))}return Ke}),this._updateActiveAction(a),a.toggleStatus&&L.DomUtil.addClass(p,"active");let q=L.DomUtil.create("div","control-icon",y);return a.iconUrl&&q.setAttribute("src",a.iconUrl),a.className&&L.DomUtil.addClass(q,a.className),L.DomEvent.disableClickPropagation(y),L.DomEvent.on(y,"click",L.DomEvent.stop),a.disabled||(L.DomEvent.addListener(y,"click",this._onBtnClick,this),L.DomEvent.addListener(y,"click",this._triggerClick,this)),a.disabled&&(L.DomUtil.addClass(y,"pm-disabled"),y.setAttribute("aria-disabled","true")),p},_applyStyleClasses(){this._container&&(!this._button.toggleStatus||this._button.cssToggle===!1?(L.DomUtil.removeClass(this.buttonsDomNode,"active"),L.DomUtil.removeClass(this._container,"activeChild")):(L.DomUtil.addClass(this.buttonsDomNode,"active"),L.DomUtil.addClass(this._container,"activeChild")))},_onBtnClick(){if(this._button.disabled)return;this._button.disableOtherButtons&&this._map.pm.Toolbar.triggerClickOnToggledButtons(this);let a="",{buttons:c}=this._map.pm.Toolbar;for(let p in c)if(c[p]._button===this._button){a=p;break}this._fireButtonClick(a,this._button)},_clicked(){this._button.doToggle&&this.toggle()},_updateDisabled(){if(!this._container)return;let a="pm-disabled",c=this.buttonsDomNode.children[0];this._button.disabled?(L.DomUtil.addClass(c,a),c.setAttribute("aria-disabled","true")):(L.DomUtil.removeClass(c,a),c.setAttribute("aria-disabled","false"))},_updateActiveAction(a){var c;(c=a._preparedActions)==null||c.forEach(p=>{p!=null&&p._node&&(p.isActive&&p.isActive.call(this)?L.DomUtil.addClass(p._node,"active-action"):L.DomUtil.removeClass(p._node,"active-action"))})}}),Qa=mo;L.Control.PMButton=Qa;var vo=L.Class.extend({options:{drawMarker:!0,drawRectangle:!0,drawPolyline:!0,drawPolygon:!0,drawCircle:!0,drawCircleMarker:!0,drawText:!0,editMode:!0,dragMode:!0,cutPolygon:!0,removalMode:!0,rotateMode:!0,snappingOption:!0,drawControls:!0,editControls:!0,optionsControls:!0,customControls:!0,oneBlock:!1,position:"topleft",positions:{draw:"",edit:"",options:"",custom:""}},customButtons:[],initialize(a){this.customButtons=[],this.options.positions={draw:"",edit:"",options:"",custom:""},this.init(a)},reinit(){let a=this.isVisible;this.removeControls(),this._defineButtons(),a&&this.addControls()},init(a){this.map=a,this.buttons={},this.isVisible=!1,this.drawContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-draw leaflet-bar leaflet-control"),this.editContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-edit leaflet-bar leaflet-control"),this.optionsContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-options leaflet-bar leaflet-control"),this.customContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-custom leaflet-bar leaflet-control"),this._defineButtons()},_createContainer(a){let c=`${a}Container`;return this[c]||(this[c]=L.DomUtil.create("div",`leaflet-pm-toolbar leaflet-pm-${a} leaflet-bar leaflet-control`)),this[c]},getButtons(){return this.buttons},addControls(a=this.options){typeof a.editPolygon<"u"&&(a.editMode=a.editPolygon),typeof a.deleteLayer<"u"&&(a.removalMode=a.deleteLayer),L.Util.setOptions(this,a),this.applyIconStyle(),this.isVisible=!0,this._showHideButtons()},applyIconStyle(){let a=this.getButtons(),c={geomanIcons:{drawMarker:"control-icon leaflet-pm-icon-marker",drawPolyline:"control-icon leaflet-pm-icon-polyline",drawRectangle:"control-icon leaflet-pm-icon-rectangle",drawPolygon:"control-icon leaflet-pm-icon-polygon",drawCircle:"control-icon leaflet-pm-icon-circle",drawCircleMarker:"control-icon leaflet-pm-icon-circle-marker",editMode:"control-icon leaflet-pm-icon-edit",dragMode:"control-icon leaflet-pm-icon-drag",cutPolygon:"control-icon leaflet-pm-icon-cut",removalMode:"control-icon leaflet-pm-icon-delete",drawText:"control-icon leaflet-pm-icon-text"}};for(let p in a){let y=a[p];L.Util.setOptions(y,{className:c.geomanIcons[p]})}},removeControls(){let a=this.getButtons();for(let c in a)a[c].remove();this.isVisible=!1},toggleControls(a=this.options){this.isVisible?this.removeControls():this.addControls(a)},_addButton(a,c){return this.buttons[a]=c,this.options[a]=!!this.options[a]||!1,this.buttons[a]},triggerClickOnToggledButtons(a){for(let c in this.buttons){let p=this.buttons[c];p._button.disableByOtherButtons&&p!==a&&p.toggled()&&p._triggerClick()}},toggleButton(a,c,p=!0){a==="editPolygon"&&(a="editMode"),a==="deleteLayer"&&(a="removalMode");let y=a;return p&&this.triggerClickOnToggledButtons(this.buttons[y]),this.buttons[y]?this.buttons[y].toggle(c):!1},_defineButtons(){let a={className:"control-icon leaflet-pm-icon-marker",title:Gn("buttonTitles.drawMarkerButton"),jsClass:"Marker",onClick:()=>{},afterClick:(vt,Nt)=>{this.map.pm.Draw[Nt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},c={title:Gn("buttonTitles.drawPolyButton"),className:"control-icon leaflet-pm-icon-polygon",jsClass:"Polygon",onClick:()=>{},afterClick:(vt,Nt)=>{this.map.pm.Draw[Nt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},p={className:"control-icon leaflet-pm-icon-polyline",title:Gn("buttonTitles.drawLineButton"),jsClass:"Line",onClick:()=>{},afterClick:(vt,Nt)=>{this.map.pm.Draw[Nt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},y={title:Gn("buttonTitles.drawCircleButton"),className:"control-icon leaflet-pm-icon-circle",jsClass:"Circle",onClick:()=>{},afterClick:(vt,Nt)=>{this.map.pm.Draw[Nt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},C={title:Gn("buttonTitles.drawCircleMarkerButton"),className:"control-icon leaflet-pm-icon-circle-marker",jsClass:"CircleMarker",onClick:()=>{},afterClick:(vt,Nt)=>{this.map.pm.Draw[Nt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},k={title:Gn("buttonTitles.drawRectButton"),className:"control-icon leaflet-pm-icon-rectangle",jsClass:"Rectangle",onClick:()=>{},afterClick:(vt,Nt)=>{this.map.pm.Draw[Nt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},I={title:Gn("buttonTitles.editButton"),className:"control-icon leaflet-pm-icon-edit",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalEditMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},q={title:Gn("buttonTitles.dragButton"),className:"control-icon leaflet-pm-icon-drag",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalDragMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},oe={title:Gn("buttonTitles.cutButton"),className:"control-icon leaflet-pm-icon-cut",jsClass:"Cut",onClick:()=>{},afterClick:(vt,Nt)=>{this.map.pm.Draw[Nt.button._button.jsClass].toggle({snappable:!0,cursorMarker:!0,allowSelfIntersection:!1})},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finish","removeLastVertex","cancel"]},ve={title:Gn("buttonTitles.deleteButton"),className:"control-icon leaflet-pm-icon-delete",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRemovalMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},Ke={title:Gn("buttonTitles.rotateButton"),className:"control-icon leaflet-pm-icon-rotate",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRotateMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},$e={className:"control-icon leaflet-pm-icon-text",title:Gn("buttonTitles.drawTextButton"),jsClass:"Text",onClick:()=>{},afterClick:(vt,Nt)=>{this.map.pm.Draw[Nt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]};this._addButton("drawMarker",new L.Control.PMButton(a)),this._addButton("drawPolyline",new L.Control.PMButton(p)),this._addButton("drawRectangle",new L.Control.PMButton(k)),this._addButton("drawPolygon",new L.Control.PMButton(c)),this._addButton("drawCircle",new L.Control.PMButton(y)),this._addButton("drawCircleMarker",new L.Control.PMButton(C)),this._addButton("drawText",new L.Control.PMButton($e)),this._addButton("editMode",new L.Control.PMButton(I)),this._addButton("dragMode",new L.Control.PMButton(q)),this._addButton("cutPolygon",new L.Control.PMButton(oe)),this._addButton("removalMode",new L.Control.PMButton(ve)),this._addButton("rotateMode",new L.Control.PMButton(Ke))},_showHideButtons(){if(!this.isVisible)return;this.removeControls(),this.isVisible=!0;let a=this.getButtons(),c=[];this.options.drawControls===!1&&(c=c.concat(Object.keys(a).filter(p=>!a[p]._button.tool))),this.options.editControls===!1&&(c=c.concat(Object.keys(a).filter(p=>a[p]._button.tool==="edit"))),this.options.optionsControls===!1&&(c=c.concat(Object.keys(a).filter(p=>a[p]._button.tool==="options"))),this.options.customControls===!1&&(c=c.concat(Object.keys(a).filter(p=>a[p]._button.tool==="custom")));for(let p in a)if(this.options[p]&&c.indexOf(p)===-1){let y=a[p]._button.tool;y||(y="draw"),a[p].setPosition(this._getBtnPosition(y)),a[p].addTo(this.map)}},_getBtnPosition(a){return this.options.positions&&this.options.positions[a]?this.options.positions[a]:this.options.position},setBlockPosition(a,c){this.options.positions[a]=c,this._showHideButtons(),this.changeControlOrder()},getBlockPositions(){return this.options.positions},copyDrawControl(a,c){if(c)typeof c!="object"&&(c={name:c});else throw new TypeError("Button has no name");let p=this._btnNameMapping(a);if(!c.name)throw new TypeError("Button has no name");if(this.buttons[c.name])throw new TypeError("Button with this name already exists");let y=this.map.pm.Draw.createNewDrawInstance(c.name,p);c={...this.buttons[p]._button,...c};let C=this.createCustomControl(c);return{drawInstance:y,control:C}},createCustomControl(a){if(!a.name)throw new TypeError("Button has no name");if(this.buttons[a.name])throw new TypeError("Button with this name already exists");a.onClick||(a.onClick=()=>{}),a.afterClick||(a.afterClick=()=>{}),a.toggle!==!1&&(a.toggle=!0),a.block&&(a.block=a.block.toLowerCase()),(!a.block||a.block==="draw")&&(a.block=""),a.className?a.className.indexOf("control-icon")===-1&&(a.className=`control-icon ${a.className}`):a.className="control-icon";let c={tool:a.block,className:a.className,title:a.title||"",jsClass:a.name,onClick:a.onClick,afterClick:a.afterClick,doToggle:a.toggle,toggleStatus:!1,disableOtherButtons:a.disableOtherButtons??!0,disableByOtherButtons:a.disableByOtherButtons??!0,cssToggle:a.toggle,position:this.options.position,actions:a.actions||[],disabled:!!a.disabled};this.options[a.name]!==!1&&(this.options[a.name]=!0);let p=this._addButton(a.name,new L.Control.PMButton(c));return this.changeControlOrder(),p},controlExists(a){return!!this.getButton(a)},getButton(a){return this.getButtons()[a]},getButtonsInBlock(a){let c={};if(a)for(let p in this.getButtons()){let y=this.getButtons()[p];(y._button.tool===a||a==="draw"&&!y._button.tool)&&(c[p]=y)}return c},changeControlOrder(a=[]){let c=this._shapeMapping(),p=[];a.forEach(k=>{c[k]?p.push(c[k]):p.push(k)});let y=this.getButtons(),C={};p.forEach(k=>{y[k]&&(C[k]=y[k])}),Object.keys(y).filter(k=>!y[k]._button.tool||y[k]._button.tool==="draw").forEach(k=>{p.indexOf(k)===-1&&(C[k]=y[k])}),Object.keys(y).filter(k=>y[k]._button.tool==="edit").forEach(k=>{p.indexOf(k)===-1&&(C[k]=y[k])}),Object.keys(y).filter(k=>y[k]._button.tool==="options").forEach(k=>{p.indexOf(k)===-1&&(C[k]=y[k])}),Object.keys(y).filter(k=>y[k]._button.tool==="custom").forEach(k=>{p.indexOf(k)===-1&&(C[k]=y[k])}),Object.keys(y).forEach(k=>{p.indexOf(k)===-1&&(C[k]=y[k])}),this.map.pm.Toolbar.buttons=C,this._showHideButtons()},getControlOrder(){let a=this.getButtons(),c=[];for(let p in a)c.push(p);return c},changeActionsOfControl(a,c){let p=this._btnNameMapping(a);if(!p)throw new TypeError("No name passed");if(!c)throw new TypeError("No actions passed");if(!this.buttons[p])throw new TypeError("Button with this name not exists");this.buttons[p]._button.actions=c,this.changeControlOrder()},setButtonDisabled(a,c){let p=this._btnNameMapping(a);c?this.buttons[p].disable():this.buttons[p].enable()},_shapeMapping(){return{Marker:"drawMarker",Circle:"drawCircle",Polygon:"drawPolygon",Rectangle:"drawRectangle",Polyline:"drawPolyline",Line:"drawPolyline",CircleMarker:"drawCircleMarker",Edit:"editMode",Drag:"dragMode",Cut:"cutPolygon",Removal:"removalMode",Rotate:"rotateMode",Text:"drawText"}},_btnNameMapping(a){let c=this._shapeMapping();return c[a]?c[a]:a}}),Ba=vo,Na=g(Ui()),Ki={_initSnappableMarkers(){this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,this._assignEvents(this._markers),this._layer.off("pm:dragstart",this._unsnap,this),this._layer.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){this._layer.off("pm:dragstart",this._unsnap,this)},_assignEvents(a){a.forEach(c=>{if(Array.isArray(c)){this._assignEvents(c);return}c.off("drag",this._handleSnapping,this),c.on("drag",this._handleSnapping,this),c.off("dragend",this._cleanupSnapping,this),c.on("dragend",this._cleanupSnapping,this)})},_cleanupSnapping(a){if(a){let c=a.target;c._snapped=!1}delete this._snapList,this.throttledList&&(this._map.off("layeradd",this.throttledList,this),this.throttledList=void 0),this._map.off("layerremove",this._handleSnapLayerRemoval,this),this.debugIndicatorLines&&this.debugIndicatorLines.forEach(c=>{c.remove()})},_handleThrottleSnapping(){this.throttledList&&this._createSnapList()},_handleSnapping(a){var q,oe,ve;let c=a.target;if(c._snapped=!1,this.throttledList||(this.throttledList=L.Util.throttle(this._handleThrottleSnapping,100,this)),((q=a==null?void 0:a.originalEvent)==null?void 0:q.altKey)||((ve=(oe=this._map)==null?void 0:oe.pm)==null?void 0:ve.Keyboard.isAltKeyPressed())||(this._snapList===void 0&&(this._createSnapList(),this._map.off("layeradd",this.throttledList,this),this._map.on("layeradd",this.throttledList,this)),this._snapList.length<=0))return!1;let p=this._calcClosestLayer(c.getLatLng(),this._snapList);if(Object.keys(p).length===0)return!1;let y=p.layer instanceof L.Marker||p.layer instanceof L.CircleMarker||!this.options.snapSegment,C;y?C=p.latlng:C=this._checkPrioritiySnapping(p);let k=this.options.snapDistance,I={marker:c,shape:this._shape,snapLatLng:C,segment:p.segment,layer:this._layer,workingLayer:this._layer,layerInteractedWith:p.layer,distance:p.distance};if(this._fireSnapDrag(I.marker,I),this._fireSnapDrag(this._layer,I),p.distance<k){c._orgLatLng=c.getLatLng(),c.setLatLng(C),c._snapped=!0,c._snapInfo=I;let Ke=()=>{this._snapLatLng=C,this._fireSnap(c,I),this._fireSnap(this._layer,I)},$e=this._snapLatLng||{},vt=C||{};($e.lat!==vt.lat||$e.lng!==vt.lng)&&Ke()}else this._snapLatLng&&(this._unsnap(I),c._snapped=!1,c._snapInfo=void 0,this._fireUnsnap(I.marker,I),this._fireUnsnap(this._layer,I));return!0},_createSnapList(){let a=[],c=[],p=this._map;p.off("layerremove",this._handleSnapLayerRemoval,this),p.on("layerremove",this._handleSnapLayerRemoval,this),p.eachLayer(y=>{if((y instanceof L.Polyline||y instanceof L.Marker||y instanceof L.CircleMarker||y instanceof L.ImageOverlay)&&y.options.snapIgnore!==!0){if(y.options.snapIgnore===void 0&&(!L.PM.optIn&&y.options.pmIgnore===!0||L.PM.optIn&&y.options.pmIgnore!==!1))return;(y instanceof L.Circle||y instanceof L.CircleMarker)&&y.pm&&y.pm._hiddenPolyCircle?a.push(y.pm._hiddenPolyCircle):y instanceof L.ImageOverlay&&(y=L.rectangle(y.getBounds())),a.push(y);let C=L.polyline([],{color:"red",pmIgnore:!0});C._pmTempLayer=!0,c.push(C),(y instanceof L.Circle||y instanceof L.CircleMarker)&&c.push(C)}}),a=a.filter(y=>this._layer!==y),a=a.filter(y=>y._latlng||y._latlngs&&Rr(y._latlngs)),a=a.filter(y=>!y._pmTempLayer),this._otherSnapLayers?(this._otherSnapLayers.forEach(()=>{let y=L.polyline([],{color:"red",pmIgnore:!0});y._pmTempLayer=!0,c.push(y)}),this._snapList=a.concat(this._otherSnapLayers)):this._snapList=a,this.debugIndicatorLines=c},_handleSnapLayerRemoval({layer:a}){if(!a._leaflet_id)return;let c=this._snapList.findIndex(p=>p._leaflet_id===a._leaflet_id);c>-1&&this._snapList.splice(c,1)},_calcClosestLayer(a,c){return this._calcClosestLayers(a,c,1)[0]},_calcClosestLayers(a,c,p=1){let y=[],C={};c.forEach((I,q)=>{var ve;if(I._parentCopy&&I._parentCopy===this._layer||((ve=I.getLatLngs)==null?void 0:ve.call(I).flat(5).length)<2)return;let oe=this._calcLayerDistances(a,I);if(oe.distance=Math.floor(oe.distance),this.debugIndicatorLines){if(!this.debugIndicatorLines[q]){let Ke=L.polyline([],{color:"red",pmIgnore:!0});Ke._pmTempLayer=!0,this.debugIndicatorLines[q]=Ke}this.debugIndicatorLines[q].setLatLngs([a,oe.latlng])}p===1&&(C.distance===void 0||oe.distance-5<=C.distance)?(oe.distance+5<C.distance&&(y=[]),C=oe,C.layer=I,y.push(C)):p!==1&&(C={},C=oe,C.layer=I,y.push(C))}),p!==1&&(y=y.sort((I,q)=>I.distance-q.distance)),p===-1&&(p=y.length);let k=this._getClosestLayerByPriority(y,p);return L.Util.isArray(k)?k:[k]},_calcLayerDistances(a,c){let p=this._map,y=c instanceof L.Marker||c instanceof L.CircleMarker,C=c instanceof L.Polygon,k=a;if(y){let I=c.getLatLng();return{latlng:{...I},distance:this._getDistance(p,I,k)}}return this._calcLatLngDistances(k,c.getLatLngs(),p,C)},_calcLatLngDistances(a,c,p,y=!1){let C,k,I,q=oe=>{oe.forEach((ve,Ke)=>{if(Array.isArray(ve)){q(ve);return}if(this.options.snapSegment){let $e=ve,vt;y?vt=Ke+1===oe.length?0:Ke+1:vt=Ke+1===oe.length?void 0:Ke+1;let Nt=oe[vt];if(Nt){let Wt=this._getDistanceToSegment(p,a,$e,Nt);(k===void 0||Wt<k)&&(k=Wt,I=[$e,Nt])}}else{let $e=this._getDistance(p,a,ve);(k===void 0||$e<k)&&(k=$e,C=ve)}})};return q(c),this.options.snapSegment?{latlng:{...this._getClosestPointOnSegment(p,a,I[0],I[1])},segment:I,distance:k}:{latlng:C,distance:k}},_getClosestLayerByPriority(a,c=1){a=a.sort((I,q)=>I._leaflet_id-q._leaflet_id);let p=["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],y=this._map.pm.globalOptions.snappingOrder||[],C=0,k={};return y.concat(p).forEach(I=>{k[I]||(C+=1,k[I]=C)}),a.sort(Ya("instanceofShape",k)),c===1?a[0]||{}:a.slice(0,c)},_checkPrioritiySnapping(a){let c=this._map,p=a.segment[0],y=a.segment[1],C=a.latlng,k=C;if(this.options.snapVertex){let I=this._getDistance(c,p,C),q=this._getDistance(c,y,C),oe=I<q?p:y,ve=I<q?I:q;if(this.options.snapMiddle){let $e=L.PM.Utils.calcMiddleLatLng(c,p,y),vt=this._getDistance(c,$e,C);vt<I&&vt<q&&(oe=$e,ve=vt)}let Ke=this.options.snapDistance;ve<Ke&&(k=oe)}return{...k}},_unsnap(){delete this._snapLatLng},_getClosestPointOnSegment(a,c,p,y){let C=a.getMaxZoom();C===1/0&&(C=a.getZoom());let k=a.project(c,C),I=a.project(p,C),q=a.project(y,C),oe=L.LineUtil.closestPointOnSegment(k,I,q);return a.unproject(oe,C)},_getDistanceToSegment(a,c,p,y){let C=a.latLngToContainerPoint(c),k=a.latLngToContainerPoint(p),I=a.latLngToContainerPoint(y);return L.LineUtil.pointToSegmentDistance(C,k,I)},_getDistance(a,c,p){return a.latLngToContainerPoint(c).distanceTo(a.latLngToContainerPoint(p))}},Qs=Ki,Ho=L.Class.extend({includes:[Qs,Ka],options:{snappable:!0,snapDistance:20,snapMiddle:!1,allowSelfIntersection:!0,tooltips:!0,templineStyle:{},hintlineStyle:{color:"#3388ff",dashArray:"5,5"},pathOptions:null,cursorMarker:!0,finishOn:null,markerStyle:{draggable:!0,icon:L.icon()},hideMiddleMarkers:!1,minRadiusCircle:null,maxRadiusCircle:null,minRadiusCircleMarker:null,maxRadiusCircleMarker:null,resizeableCircleMarker:!1,resizeableCircle:!0,markerEditable:!0,continueDrawing:!1,snapSegment:!0,requireSnapToFinish:!1,rectangleAngle:0,textOptions:{text:null,focusAfterDraw:null,removeIfEmpty:null,className:null},snapVertex:!0},setOptions(a){L.Util.setOptions(this,a),this.setStyle(this.options)},setStyle(){},getOptions(){return this.options},initialize(a){let c=new L.Icon.Default;c.options.tooltipAnchor=[0,0],this.options.markerStyle.icon=c,this._map=a,this.shapes=["Marker","CircleMarker","Line","Polygon","Rectangle","Circle","Cut","Text"],this.shapes.forEach(p=>{this[p]=new L.PM.Draw[p](this._map)}),this.Marker.setOptions({continueDrawing:!0}),this.CircleMarker.setOptions({continueDrawing:!0})},setPathOptions(a,c=!1){c?this.options.pathOptions=(0,Na.default)(this.options.pathOptions,a):this.options.pathOptions=a},getShapes(){return this.shapes},getShape(){return this._shape},enable(a,c){if(!a)throw new Error(`Error: Please pass a shape as a parameter. Possible shapes are: ${this.getShapes().join(",")}`);this.disable(),this[a].enable(c)},disable(){this.shapes.forEach(a=>{this[a].disable()})},addControls(){this.shapes.forEach(a=>{this[a].addButton()})},getActiveShape(){let a;return this.shapes.forEach(c=>{this[c]._enabled&&(a=c)}),a},_setGlobalDrawMode(){this._shape==="Cut"?this._fireGlobalCutModeToggled():this._fireGlobalDrawModeToggled();let a=[];this._map.eachLayer(c=>{(c instanceof L.Polyline||c instanceof L.Marker||c instanceof L.Circle||c instanceof L.CircleMarker||c instanceof L.ImageOverlay)&&(c._pmTempLayer||a.push(c))}),this._enabled?a.forEach(c=>{L.PM.Utils.disablePopup(c)}):a.forEach(c=>{L.PM.Utils.enablePopup(c)})},createNewDrawInstance(a,c){let p=this._getShapeFromBtnName(c);if(this[a])throw new TypeError("Draw Type already exists");if(!L.PM.Draw[p])throw new TypeError(`There is no class L.PM.Draw.${p}`);return this[a]=new L.PM.Draw[p](this._map),this[a].toolbarButtonName=a,this[a]._shape=a,this.shapes.push(a),this[c]&&this[a].setOptions(this[c].options),this[a].setOptions(this[a].options),this[a]},_getShapeFromBtnName(a){let c={drawMarker:"Marker",drawCircle:"Circle",drawPolygon:"Polygon",drawPolyline:"Line",drawRectangle:"Rectangle",drawCircleMarker:"CircleMarker",editMode:"Edit",dragMode:"Drag",cutPolygon:"Cut",removalMode:"Removal",rotateMode:"Rotate",drawText:"Text"};return c[a]?c[a]:this[a]?this[a]._shape:a},_finishLayer(a){a.pm&&(a.pm.setOptions(this.options),a.pm._shape=this._shape,a.pm._map=this._map),this._addDrawnLayerProp(a)},_addDrawnLayerProp(a){a._drawnByGeoman=!0},_setPane(a,c){c==="layerPane"?a.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":c==="vertexPane"?a.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":c==="markerPane"&&(a.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},_isFirstLayer(){return(this._map||this._layer._map).pm.getGeomanLayers().length===0}}),Dr=Ho;Dr.Marker=Dr.extend({initialize(a){this._map=a,this._shape="Marker",this.toolbarButtonName="drawMarker"},enable(a){L.Util.setOptions(this,a),this._enabled=!0,this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),this.options.markerStyle),this._setPane(this._hintMarker,"markerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.tooltips&&this._hintMarker.bindTooltip(Gn("tooltips.placeMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this.options.markerEditable&&this._map.eachLayer(c=>{this.isRelevantMarker(c)&&c.pm.enable()}),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createMarker,this),this._hintMarker.remove(),this._map.off("mousemove",this._syncHintMarker,this),this._map.eachLayer(a=>{this.isRelevantMarker(a)&&a.pm.disable()}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(a){this.enabled()?this.disable():this.enable(a)},isRelevantMarker(a){return a instanceof L.Marker&&a.pm&&!a._pmTempLayer&&!a.pm._initTextMarker},_syncHintMarker(a){if(this._hintMarker.setLatLng(a.latlng),this.options.snappable){let c=a;c.target=this._hintMarker,this._handleSnapping(c)}this._fireChange(this._hintMarker.getLatLng(),"Draw")},_createMarker(a){if(!a.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(a.latlng);let c=this._hintMarker.getLatLng(),p=new L.Marker(c,this.options.markerStyle);this._setPane(p,"markerPane"),this._finishLayer(p),p.pm||(p.options.draggable=!1),p.addTo(this._map.pm._getContainingLayer()),p.pm&&this.options.markerEditable?p.pm.enable():p.dragging&&p.dragging.disable(),this._fireCreate(p),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},setStyle(){var a,c;(a=this.options.markerStyle)!=null&&a.icon&&((c=this._hintMarker)==null||c.setIcon(this.options.markerStyle.icon))}});var A=63710088e-1,de={centimeters:A*100,centimetres:A*100,degrees:A/111325,feet:A*3.28084,inches:A*39.37,kilometers:A/1e3,kilometres:A/1e3,meters:A,metres:A,miles:A/1609.344,millimeters:A*1e3,millimetres:A*1e3,nauticalmiles:A/1852,radians:1,yards:A*1.0936};function He(a,c,p){p===void 0&&(p={});var y={type:"Feature"};return(p.id===0||p.id)&&(y.id=p.id),p.bbox&&(y.bbox=p.bbox),y.properties=c||{},y.geometry=a,y}function ct(a,c,p){if(p===void 0&&(p={}),!a)throw new Error("coordinates is required");if(!Array.isArray(a))throw new Error("coordinates must be an Array");if(a.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ei(a[0])||!ei(a[1]))throw new Error("coordinates must contain numbers");var y={type:"Point",coordinates:a};return He(y,c,p)}function St(a,c,p){if(p===void 0&&(p={}),a.length<2)throw new Error("coordinates must be an array of two or more positions");var y={type:"LineString",coordinates:a};return He(y,c,p)}function Ft(a,c){c===void 0&&(c={});var p={type:"FeatureCollection"};return c.id&&(p.id=c.id),c.bbox&&(p.bbox=c.bbox),p.features=a,p}function sn(a,c){c===void 0&&(c="kilometers");var p=de[c];if(!p)throw new Error(c+" units is invalid");return a*p}function Pn(a,c){c===void 0&&(c="kilometers");var p=de[c];if(!p)throw new Error(c+" units is invalid");return a/p}function kn(a){var c=a%(2*Math.PI);return c*180/Math.PI}function Vn(a){var c=a%360;return c*Math.PI/180}function ei(a){return!isNaN(a)&&a!==null&&!Array.isArray(a)}function vi(a){var c,p,y={type:"FeatureCollection",features:[]};if(a.type==="Feature"?p=a.geometry:p=a,p.type==="LineString")c=[p.coordinates];else if(p.type==="MultiLineString")c=p.coordinates;else if(p.type==="MultiPolygon")c=[].concat.apply([],p.coordinates);else if(p.type==="Polygon")c=p.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return c.forEach(function(C){c.forEach(function(k){for(var I=0;I<C.length-1;I++)for(var q=I;q<k.length-1;q++)if(!(C===k&&(Math.abs(I-q)===1||I===0&&q===C.length-2&&C[I][0]===C[C.length-1][0]&&C[I][1]===C[C.length-1][1]))){var oe=gr(C[I][0],C[I][1],C[I+1][0],C[I+1][1],k[q][0],k[q][1],k[q+1][0],k[q+1][1]);oe&&y.features.push(ct([oe[0],oe[1]]))}})}),y}function gr(a,c,p,y,C,k,I,q){var oe,ve,Ke,$e,vt,Nt={x:null,y:null,onLine1:!1,onLine2:!1};return oe=(q-k)*(p-a)-(I-C)*(y-c),oe===0?Nt.x!==null&&Nt.y!==null?Nt:!1:(ve=c-k,Ke=a-C,$e=(I-C)*ve-(q-k)*Ke,vt=(p-a)*ve-(y-c)*Ke,ve=$e/oe,Ke=vt/oe,Nt.x=a+ve*(p-a),Nt.y=c+ve*(y-c),ve>=0&&ve<=1&&(Nt.onLine1=!0),Ke>=0&&Ke<=1&&(Nt.onLine2=!0),Nt.onLine1&&Nt.onLine2?[Nt.x,Nt.y]:!1)}Dr.Line=Dr.extend({initialize(a){this._map=a,this._shape="Line",this.toolbarButtonName="drawPolyline",this._doesSelfIntersect=!1},enable(a){L.Util.setOptions(this,a),this._enabled=!0,this._markers=[],this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.polyline([],{...this.options.templineStyle,pmIgnore:!1}),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(Gn("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createVertex,this),this.options.finishOn&&this.options.finishOn!=="snap"&&this._map.on(this.options.finishOn,this._finishShape,this),this.options.finishOn==="dblclick"&&(this.tempMapDoubleClickZoomState=this._map.doubleClickZoom._enabled,this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.disable()),this._map.on("mousemove",this._syncHintMarker,this),this._hintMarker.on("move",this._syncHintLine,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this.isRed=!1,this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createVertex,this),this._map.off("mousemove",this._syncHintMarker,this),this.options.finishOn&&this.options.finishOn!=="snap"&&this._map.off(this.options.finishOn,this._finishShape,this),this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.enable(),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(a){this.enabled()?this.disable():this.enable(a)},_syncHintLine(){let a=this._layer.getLatLngs();if(a.length>0){let c=a[a.length-1];this._hintline.setLatLngs([c,this._hintMarker.getLatLng()])}},_syncHintMarker(a){if(this._hintMarker.setLatLng(a.latlng),this.options.snappable){let p=a;p.target=this._hintMarker,this._handleSnapping(p)}this.options.allowSelfIntersection||this._handleSelfIntersection(!0,this._hintMarker.getLatLng());let c=this._layer._defaultShape().slice();c.push(this._hintMarker.getLatLng()),this._change(c)},hasSelfIntersection(){return vi(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersection(a,c){let p=L.polyline(this._layer.getLatLngs());a&&(c||(c=this._hintMarker.getLatLng()),p.addLatLng(c));let y=vi(p.toGeoJSON(15));this._doesSelfIntersect=y.features.length>0,this._doesSelfIntersect?this.isRed||(this.isRed=!0,this._hintline.setStyle({color:"#f00000ff"}),this._fireIntersect(y,this._map,"Draw")):this._hintline.isEmpty()||(this.isRed=!1,this._hintline.setStyle(this.options.hintlineStyle))},_createVertex(a){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,a.latlng),this._doesSelfIntersect))return;this._hintMarker._snapped||this._hintMarker.setLatLng(a.latlng);let c=this._hintMarker.getLatLng(),p=this._layer.getLatLngs(),y=p[p.length-1];if(c.equals(p[0])||p.length>0&&c.equals(y)){this._finishShape();return}this._layer._latlngInfo=this._layer._latlngInfo||[],this._layer._latlngInfo.push({latlng:c,snapInfo:this._hintMarker._snapInfo}),this._layer.addLatLng(c);let C=this._createMarker(c);this._setTooltipText(),this._setHintLineAfterNewVertex(c),this._fireVertexAdded(C,void 0,c,"Draw"),this._change(this._layer.getLatLngs()),this.options.finishOn==="snap"&&this._hintMarker._snapped&&this._finishShape(a)},_setHintLineAfterNewVertex(a){this._hintline.setLatLngs([a,a])},_removeLastVertex(){let a=this._markers;if(a.length<=1){this.disable();return}let c=this._layer.getLatLngs(),p=a[a.length-1],{indexPath:y}=L.PM.Utils.findDeepMarkerIndex(a,p);a.pop(),this._layerGroup.removeLayer(p);let C=a[a.length-1],k=c.indexOf(C.getLatLng());c=c.slice(0,k+1),this._layer.setLatLngs(c),this._layer._latlngInfo.pop(),this._syncHintLine(),this._setTooltipText(),this._fireVertexRemoved(p,y,"Draw"),this._change(this._layer.getLatLngs())},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!1),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let a=this._layer.getLatLngs();if(a.length<=1)return;let c=L.polyline(a,this.options.pathOptions);this._setPane(c,"layerPane"),this._finishLayer(c),c.addTo(this._map.pm._getContainingLayer()),this._fireCreate(c),this.options.snappable&&this._cleanupSnapping();let p=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(p))},_createMarker(a){let c=new L.Marker(a,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(c,"vertexPane"),c._pmTempLayer=!0,this._layerGroup.addLayer(c),this._markers.push(c),c.on("click",this._finishShape,this),c},_setTooltipText(){let{length:a}=this._layer.getLatLngs().flat(),c="";a<=1?c=Gn("tooltips.continueLine"):c=Gn("tooltips.finishLine"),this._hintMarker.setTooltipContent(c)},_change(a){this._fireChange(a,"Draw")},setStyle(){var a,c;(a=this._layer)==null||a.setStyle(this.options.templineStyle),(c=this._hintline)==null||c.setStyle(this.options.hintlineStyle)}}),Dr.Polygon=Dr.Line.extend({initialize(a){this._map=a,this._shape="Polygon",this.toolbarButtonName="drawPolygon"},enable(a){L.PM.Draw.Line.prototype.enable.call(this,a),this._layer.pm._shape="Polygon"},_createMarker(a){let c=new L.Marker(a,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(c,"vertexPane"),c._pmTempLayer=!0,this._layerGroup.addLayer(c),this._markers.push(c),this._layer.getLatLngs().flat().length===1?(c.on("click",this._finishShape,this),this._tempSnapLayerIndex=this._otherSnapLayers.push(c)-1,this.options.snappable&&this._cleanupSnapping()):c.on("click",()=>1),c},_setTooltipText(){let{length:a}=this._layer.getLatLngs().flat(),c="";a<=2?c=Gn("tooltips.continueLine"):c=Gn("tooltips.finishPoly"),this._hintMarker.setTooltipContent(c)},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let a=this._layer.getLatLngs();if(a.length<=2)return;let c=L.polygon(a,this.options.pathOptions);this._setPane(c,"layerPane"),this._finishLayer(c),c.addTo(this._map.pm._getContainingLayer()),this._fireCreate(c),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex;let p=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(p))}}),Dr.Rectangle=Dr.extend({initialize(a){this._map=a,this._shape="Rectangle",this.toolbarButtonName="drawRectangle"},enable(a){if(L.Util.setOptions(this,a),this._enabled=!0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.rectangle([[0,0],[0,0]],this.options.pathOptions),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._startMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-start-marker"}),draggable:!1,zIndexOffset:-100,opacity:this.options.cursorMarker?1:0}),this._setPane(this._startMarker,"vertexPane"),this._startMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._startMarker),this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:150,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(Gn("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this.options.cursorMarker){this._styleMarkers=[];for(let c=0;c<2;c+=1){let p=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-style-marker"}),draggable:!1,zIndexOffset:100});this._setPane(p,"vertexPane"),p._pmTempLayer=!0,this._layerGroup.addLayer(p),this._styleMarkers.push(p)}}this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._placeStartingMarkers,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._finishShape,this),this._map.off("click",this._placeStartingMarkers,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(a){this.enabled()?this.disable():this.enable(a)},_placeStartingMarkers(a){this._hintMarker._snapped||this._hintMarker.setLatLng(a.latlng);let c=this._hintMarker.getLatLng();L.DomUtil.addClass(this._startMarker._icon,"visible"),this._startMarker.setLatLng(c),this.options.cursorMarker&&this._styleMarkers&&this._styleMarkers.forEach(p=>{L.DomUtil.addClass(p._icon,"visible"),p.setLatLng(c)}),this._map.off("click",this._placeStartingMarkers,this),this._map.on("click",this._finishShape,this),this._hintMarker.setTooltipContent(Gn("tooltips.finishRect")),this._setRectangleOrigin()},_setRectangleOrigin(){let a=this._startMarker.getLatLng();a&&(this._layerGroup.addLayer(this._layer),this._layer.setLatLngs([a,a]),this._hintMarker.on("move",this._syncRectangleSize,this))},_syncHintMarker(a){if(this._hintMarker.setLatLng(a.latlng),this.options.snappable){let p=a;p.target=this._hintMarker,this._handleSnapping(p)}let c=this._layerGroup&&this._layerGroup.hasLayer(this._layer)?this._layer.getLatLngs():[this._hintMarker.getLatLng()];this._fireChange(c,"Draw")},_syncRectangleSize(){let a=Xa(this._startMarker.getLatLng(),this._map),c=Xa(this._hintMarker.getLatLng(),this._map),p=L.PM.Utils._getRotatedRectangle(a,c,this.options.rectangleAngle||0,this._map);if(this._layer.setLatLngs(p),this.options.cursorMarker&&this._styleMarkers){let y=[];p.forEach(C=>{!C.equals(a,1e-8)&&!C.equals(c,1e-8)&&y.push(C)}),y.forEach((C,k)=>{try{this._styleMarkers[k].setLatLng(C)}catch{}})}},_findCorners(){let a=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(a[0],a[2],this.options.rectangleAngle||0,this._map)},_finishShape(a){this._hintMarker._snapped||this._hintMarker.setLatLng(a.latlng);let c=this._hintMarker.getLatLng(),p=this._startMarker.getLatLng();if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||p.equals(c))return;let y=L.rectangle([p,c],this.options.pathOptions);if(this.options.rectangleAngle){let k=L.PM.Utils._getRotatedRectangle(p,c,this.options.rectangleAngle||0,this._map);y.setLatLngs(k),y.pm&&y.pm._setAngle(this.options.rectangleAngle||0)}this._setPane(y,"layerPane"),this._finishLayer(y),y.addTo(this._map.pm._getContainingLayer()),this._fireCreate(y);let C=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(C))},setStyle(){var a;(a=this._layer)==null||a.setStyle(this.options.pathOptions)}}),Dr.CircleMarker=Dr.extend({initialize(a){this._map=a,this._shape="CircleMarker",this.toolbarButtonName="drawCircleMarker",this._layerIsDragging=!1,this._BaseCircleClass=L.CircleMarker,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._defaultRadius=10},enable(a){if(L.Util.setOptions(this,a),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),this._enabled=!0,this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._map.getContainer().classList.add("geoman-draw-cursor"),this.options[this._editableOption]){let c={};L.extend(c,this.options.templineStyle),c.radius=0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=new this._BaseCircleClass(this._map.getCenter(),c),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._centerMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon"}),draggable:!1,zIndexOffset:100}),this._setPane(this._centerMarker,"vertexPane"),this._centerMarker._pmTempLayer=!0,this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:110,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(Gn("tooltips.startCircle"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._map.on("click",this._placeCenterMarker,this)}else this._map.on("click",this._createMarker,this),this._hintMarker=new this._BaseCircleClass(this._map.getCenter(),{radius:this._defaultRadius,...this.options.templineStyle}),this._setPane(this._hintMarker,"layerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this._layer=this._hintMarker,this.options.tooltips&&this._hintMarker.bindTooltip(Gn("tooltips.placeCircleMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip();this._map.on("mousemove",this._syncHintMarker,this),this._extendingEnable(),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},_extendingEnable(){!this.options[this._editableOption]&&this.options.markerEditable&&this._map.eachLayer(a=>{this.isRelevantMarker(a)&&a.pm.enable()}),this._layer.bringToBack()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this.options[this._editableOption]?(this._map.off("click",this._finishShape,this),this._map.off("click",this._placeCenterMarker,this),this._map.removeLayer(this._layerGroup)):(this._map.off("click",this._createMarker,this),this._extendingDisable(),this._hintMarker.remove()),this._map.off("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},_extendingDisable(){this._map.eachLayer(a=>{this.isRelevantMarker(a)&&a.pm.disable()})},enabled(){return this._enabled},toggle(a){this.enabled()?this.disable():this.enable(a)},_placeCenterMarker(a){this._hintMarker._snapped||this._hintMarker.setLatLng(a.latlng),this._layerGroup.addLayer(this._layer),this._layerGroup.addLayer(this._centerMarker);let c=this._hintMarker.getLatLng();this._centerMarker.setLatLng(c),this._map.off("click",this._placeCenterMarker,this),this._map.on("click",this._finishShape,this),this._placeCircleCenter()},_placeCircleCenter(){let a=this._centerMarker.getLatLng();a&&(this._layer.setLatLng(a),this._hintMarker.on("move",this._syncHintLine,this),this._hintMarker.on("move",this._syncCircleRadius,this),this._hintMarker.setTooltipContent(Gn("tooltips.finishCircle")),this._fireCenterPlaced(),this._fireChange(this._layer.getLatLng(),"Draw"))},_syncHintLine(){let a=this._centerMarker.getLatLng(),c=this._getNewDestinationOfHintMarker();this._hintline.setLatLngs([a,c])},_syncCircleRadius(){let a=this._centerMarker.getLatLng(),c=this._hintMarker.getLatLng(),p=this._distanceCalculation(a,c);this.options[this._minRadiusOption]&&p<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&p>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(p)},_syncHintMarker(a){if(this._hintMarker.setLatLng(a.latlng),this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker()),this.options.snappable){let p=a;p.target=this._hintMarker,this._handleSnapping(p)}this._handleHintMarkerSnapping();let c=this._layerGroup&&this._layerGroup.hasLayer(this._centerMarker)?this._centerMarker.getLatLng():this._hintMarker.getLatLng();this._fireChange(c,"Draw")},isRelevantMarker(a){return a instanceof L.CircleMarker&&!(a instanceof L.Circle)&&a.pm&&!a._pmTempLayer},_createMarker(a){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||!a.latlng||this._layerIsDragging)return;this._hintMarker._snapped||this._hintMarker.setLatLng(a.latlng);let c=this._hintMarker.getLatLng(),p=new this._BaseCircleClass(c,{radius:this._defaultRadius,...this.options.pathOptions});this._setPane(p,"layerPane"),this._finishLayer(p),p.addTo(this._map.pm._getContainingLayer()),this._extendingCreateMarker(p),this._fireCreate(p),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},_extendingCreateMarker(a){a.pm&&this.options.markerEditable&&a.pm.enable()},_finishShape(a){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(a.latlng);let c=this._centerMarker.getLatLng(),p=this._defaultRadius;if(this.options[this._editableOption]){let I=this._hintMarker.getLatLng();p=this._distanceCalculation(c,I),this.options[this._minRadiusOption]&&p<this.options[this._minRadiusOption]?p=this.options[this._minRadiusOption]:this.options[this._maxRadiusOption]&&p>this.options[this._maxRadiusOption]&&(p=this.options[this._maxRadiusOption])}let y={...this.options.pathOptions,radius:p},C=new this._BaseCircleClass(c,y);this._setPane(C,"layerPane"),this._finishLayer(C),C.addTo(this._map.pm._getContainingLayer()),C.pm&&C.pm._updateHiddenPolyCircle(),this._fireCreate(C);let k=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(k))},_getNewDestinationOfHintMarker(){let a=this._hintMarker.getLatLng();if(this.options[this._editableOption]){if(!this._layerGroup.hasLayer(this._centerMarker))return a;let c=this._centerMarker.getLatLng(),p=this._distanceCalculation(c,a);this.options[this._minRadiusOption]&&p<this.options[this._minRadiusOption]?a=Ja(this._map,c,a,this._getMinDistanceInMeter()):this.options[this._maxRadiusOption]&&p>this.options[this._maxRadiusOption]&&(a=Ja(this._map,c,a,this._getMaxDistanceInMeter()))}return a},_getMinDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,this._centerMarker.getLatLng())},_getMaxDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,this._centerMarker.getLatLng())},_handleHintMarkerSnapping(){if(this.options[this._editableOption]){if(this._hintMarker._snapped){let a=this._centerMarker.getLatLng(),c=this._hintMarker.getLatLng(),p=this._distanceCalculation(a,c);this._layerGroup.hasLayer(this._centerMarker)&&(this.options[this._minRadiusOption]&&p<this.options[this._minRadiusOption]?this._hintMarker.setLatLng(this._hintMarker._orgLatLng):this.options[this._maxRadiusOption]&&p>this.options[this._maxRadiusOption]&&this._hintMarker.setLatLng(this._hintMarker._orgLatLng))}this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker())}},setStyle(){var c,p;let a={};L.extend(a,this.options.templineStyle),this.options[this._editableOption]&&(a.radius=0),(c=this._layer)==null||c.setStyle(a),(p=this._hintline)==null||p.setStyle(this.options.hintlineStyle)},_distanceCalculation(a,c){return this._map.project(a).distanceTo(this._map.project(c))}}),Dr.Circle=Dr.CircleMarker.extend({initialize(a){this._map=a,this._shape="Circle",this.toolbarButtonName="drawCircle",this._BaseCircleClass=L.Circle,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizeableCircle",this._defaultRadius=100},_extendingEnable(){},_extendingDisable(){},_extendingCreateMarker(){},isRelevantMarker(){},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_distanceCalculation(a,c){return this._map.distance(a,c)}});function $i(a){if(!a)throw new Error("coord is required");if(!Array.isArray(a)){if(a.type==="Feature"&&a.geometry!==null&&a.geometry.type==="Point")return a.geometry.coordinates;if(a.type==="Point")return a.coordinates}if(Array.isArray(a)&&a.length>=2&&!Array.isArray(a[0])&&!Array.isArray(a[1]))return a;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Ji(a){if(Array.isArray(a))return a;if(a.type==="Feature"){if(a.geometry!==null)return a.geometry.coordinates}else if(a.coordinates)return a.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Or(a){return a.type==="Feature"?a.geometry:a}function Gr(a,c){return a.type==="FeatureCollection"?"FeatureCollection":a.type==="GeometryCollection"?"GeometryCollection":a.type==="Feature"&&a.geometry!==null?a.geometry.type:a.type}function eo(a,c,p){if(a!==null)for(var y,C,k,I,q,oe,ve,Ke=0,$e=0,vt,Nt=a.type,Wt=Nt==="FeatureCollection",gn=Nt==="Feature",bn=Wt?a.features.length:1,Zn=0;Zn<bn;Zn++){ve=Wt?a.features[Zn].geometry:gn?a.geometry:a,vt=ve?ve.type==="GeometryCollection":!1,q=vt?ve.geometries.length:1;for(var Ze=0;Ze<q;Ze++){var it=0,ht=0;if(I=vt?ve.geometries[Ze]:ve,I!==null){oe=I.coordinates;var It=I.type;switch(Ke=0,It){case null:break;case"Point":if(c(oe,$e,Zn,it,ht)===!1)return!1;$e++,it++;break;case"LineString":case"MultiPoint":for(y=0;y<oe.length;y++){if(c(oe[y],$e,Zn,it,ht)===!1)return!1;$e++,It==="MultiPoint"&&it++}It==="LineString"&&it++;break;case"Polygon":case"MultiLineString":for(y=0;y<oe.length;y++){for(C=0;C<oe[y].length-Ke;C++){if(c(oe[y][C],$e,Zn,it,ht)===!1)return!1;$e++}It==="MultiLineString"&&it++,It==="Polygon"&&ht++}It==="Polygon"&&it++;break;case"MultiPolygon":for(y=0;y<oe.length;y++){for(ht=0,C=0;C<oe[y].length;C++){for(k=0;k<oe[y][C].length-Ke;k++){if(c(oe[y][C][k],$e,Zn,it,ht)===!1)return!1;$e++}ht++}it++}break;case"GeometryCollection":for(y=0;y<I.geometries.length;y++)if(eo(I.geometries[y],c)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function yi(a,c){if(a.type==="Feature")c(a,0);else if(a.type==="FeatureCollection")for(var p=0;p<a.features.length&&c(a.features[p],p)!==!1;p++);}function gs(a,c,p){var y=p;return yi(a,function(C,k){k===0&&p===void 0?y=C:y=c(y,C,k)}),y}function Ra(a,c){var p,y,C,k,I,q,oe,ve,Ke,$e,vt=0,Nt=a.type==="FeatureCollection",Wt=a.type==="Feature",gn=Nt?a.features.length:1;for(p=0;p<gn;p++){for(q=Nt?a.features[p].geometry:Wt?a.geometry:a,ve=Nt?a.features[p].properties:Wt?a.properties:{},Ke=Nt?a.features[p].bbox:Wt?a.bbox:void 0,$e=Nt?a.features[p].id:Wt?a.id:void 0,oe=q?q.type==="GeometryCollection":!1,I=oe?q.geometries.length:1,C=0;C<I;C++){if(k=oe?q.geometries[C]:q,k===null){if(c(null,vt,ve,Ke,$e)===!1)return!1;continue}switch(k.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(c(k,vt,ve,Ke,$e)===!1)return!1;break}case"GeometryCollection":{for(y=0;y<k.geometries.length;y++)if(c(k.geometries[y],vt,ve,Ke,$e)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}vt++}}function Ms(a,c){Ra(a,function(p,y,C,k,I){var q=p===null?null:p.type;switch(q){case null:case"Point":case"LineString":case"Polygon":return c(He(p,C,{bbox:k,id:I}),y,0)===!1?!1:void 0}var oe;switch(q){case"MultiPoint":oe="Point";break;case"MultiLineString":oe="LineString";break;case"MultiPolygon":oe="Polygon";break}for(var ve=0;ve<p.coordinates.length;ve++){var Ke=p.coordinates[ve],$e={type:oe,coordinates:Ke};if(c(He($e,C),y,ve)===!1)return!1}})}function pl(a){if(!a)throw new Error("geojson is required");var c=[];return Ms(a,function(p){ko(p,c)}),Ft(c)}function ko(a,c){var p=[],y=a.geometry;if(y!==null){switch(y.type){case"Polygon":p=Ji(y);break;case"LineString":p=[Ji(y)]}p.forEach(function(C){var k=Rl(C,a.properties);k.forEach(function(I){I.id=c.length,c.push(I)})})}}function Rl(a,c){var p=[];return a.reduce(function(y,C){var k=St([y,C],c);return k.bbox=da(y,C),p.push(k),C}),p}function da(a,c){var p=a[0],y=a[1],C=c[0],k=c[1],I=p<C?p:C,q=y<k?y:k,oe=p>C?p:C,ve=y>k?y:k;return[I,q,oe,ve]}var pa=pl,Hr=g(Tr(),1);function To(a,c){var p={},y=[];if(a.type==="LineString"&&(a=He(a)),c.type==="LineString"&&(c=He(c)),a.type==="Feature"&&c.type==="Feature"&&a.geometry!==null&&c.geometry!==null&&a.geometry.type==="LineString"&&c.geometry.type==="LineString"&&a.geometry.coordinates.length===2&&c.geometry.coordinates.length===2){var C=to(a,c);return C&&y.push(C),Ft(y)}var k=(0,Hr.default)();return k.load(pa(c)),yi(pa(a),function(I){yi(k.search(I),function(q){var oe=to(I,q);if(oe){var ve=Ji(oe).join(",");p[ve]||(p[ve]=!0,y.push(oe))}})}),Ft(y)}function to(a,c){var p=Ji(a),y=Ji(c);if(p.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(y.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var C=p[0][0],k=p[0][1],I=p[1][0],q=p[1][1],oe=y[0][0],ve=y[0][1],Ke=y[1][0],$e=y[1][1],vt=($e-ve)*(I-C)-(Ke-oe)*(q-k),Nt=(Ke-oe)*(k-ve)-($e-ve)*(C-oe),Wt=(I-C)*(k-ve)-(q-k)*(C-oe);if(vt===0)return null;var gn=Nt/vt,bn=Wt/vt;if(gn>=0&&gn<=1&&bn>=0&&bn<=1){var Zn=C+gn*(I-C),Ze=k+gn*(q-k);return ct([Zn,Ze])}return null}var zs=To,Da=g(Tr(),1);function ms(a,c,p){p===void 0&&(p={});var y=$i(a),C=$i(c),k=Vn(C[1]-y[1]),I=Vn(C[0]-y[0]),q=Vn(y[1]),oe=Vn(C[1]),ve=Math.pow(Math.sin(k/2),2)+Math.pow(Math.sin(I/2),2)*Math.cos(q)*Math.cos(oe);return sn(2*Math.atan2(Math.sqrt(ve),Math.sqrt(1-ve)),p.units)}var ks=ms;function Ts(a){var c=a[0],p=a[1],y=a[2],C=a[3],k=ks(a.slice(0,2),[y,p]),I=ks(a.slice(0,2),[c,C]);if(k>=I){var q=(p+C)/2;return[c,q-(y-c)/2,y,q+(y-c)/2]}else{var oe=(c+y)/2;return[oe-(C-p)/2,p,oe+(C-p)/2,C]}}var ou=Ts;function ns(a){var c=[1/0,1/0,-1/0,-1/0];return eo(a,function(p){c[0]>p[0]&&(c[0]=p[0]),c[1]>p[1]&&(c[1]=p[1]),c[2]<p[0]&&(c[2]=p[0]),c[3]<p[1]&&(c[3]=p[1])}),c}ns.default=ns;var Wo=ns;function vs(a,c){c===void 0&&(c={});var p=c.precision,y=c.coordinates,C=c.mutate;if(p=p==null||isNaN(p)?6:p,y=y==null||isNaN(y)?3:y,!a)throw new Error("<geojson> is required");if(typeof p!="number")throw new Error("<precision> must be a number");if(typeof y!="number")throw new Error("<coordinates> must be a number");(C===!1||C===void 0)&&(a=JSON.parse(JSON.stringify(a)));var k=Math.pow(10,p);return eo(a,function(I){ys(I,k,y)}),a}function ys(a,c,p){a.length>p&&a.splice(p,a.length);for(var y=0;y<a.length;y++)a[y]=Math.round(a[y]*c)/c;return a}var Zo=vs;function Ko(a,c,p){if(p===void 0&&(p={}),p.final===!0)return _s(a,c);var y=$i(a),C=$i(c),k=Vn(y[0]),I=Vn(C[0]),q=Vn(y[1]),oe=Vn(C[1]),ve=Math.sin(I-k)*Math.cos(oe),Ke=Math.cos(q)*Math.sin(oe)-Math.sin(q)*Math.cos(oe)*Math.cos(I-k);return kn(Math.atan2(ve,Ke))}function _s(a,c){var p=Ko(c,a);return p=(p+180)%360,p}function os(a,c,p,y){y===void 0&&(y={});var C=$i(a),k=Vn(C[0]),I=Vn(C[1]),q=Vn(p),oe=Pn(c,y.units),ve=Math.asin(Math.sin(I)*Math.cos(oe)+Math.cos(I)*Math.sin(oe)*Math.cos(q)),Ke=k+Math.atan2(Math.sin(q)*Math.sin(oe)*Math.cos(I),Math.cos(oe)-Math.sin(I)*Math.sin(ve)),$e=kn(Ke),vt=kn(ve);return ct([$e,vt],y.properties)}function Bo(a,c,p){p===void 0&&(p={});var y=ct([1/0,1/0],{dist:1/0}),C=0;return Ms(a,function(k){for(var I=Ji(k),q=0;q<I.length-1;q++){var oe=ct(I[q]);oe.properties.dist=ks(c,oe,p);var ve=ct(I[q+1]);ve.properties.dist=ks(c,ve,p);var Ke=ks(oe,ve,p),$e=Math.max(oe.properties.dist,ve.properties.dist),vt=Ko(oe,ve),Nt=os(c,$e,vt+90,p),Wt=os(c,$e,vt-90,p),gn=zs(St([Nt.geometry.coordinates,Wt.geometry.coordinates]),St([oe.geometry.coordinates,ve.geometry.coordinates])),bn=null;gn.features.length>0&&(bn=gn.features[0],bn.properties.dist=ks(c,bn,p),bn.properties.location=C+ks(oe,bn,p)),oe.properties.dist<y.properties.dist&&(y=oe,y.properties.index=q,y.properties.location=C),ve.properties.dist<y.properties.dist&&(y=ve,y.properties.index=q+1,y.properties.location=C+Ke),bn&&bn.properties.dist<y.properties.dist&&(y=bn,y.properties.index=q),C+=Ke}}),y}var no=Bo;function bs(a,c){if(!a)throw new Error("line is required");if(!c)throw new Error("splitter is required");var p=Gr(a),y=Gr(c);if(p!=="LineString")throw new Error("line must be LineString");if(y==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(y==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var C=Zo(c,{precision:7});switch(y){case"Point":return qt(a,C);case"MultiPoint":return bt(a,C);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return bt(a,zs(a,C))}}function bt(a,c){var p=[],y=(0,Da.default)();return Ms(c,function(C){if(p.forEach(function(q,oe){q.id=oe}),!p.length)p=qt(a,C).features,p.forEach(function(q){q.bbox||(q.bbox=ou(Wo(q)))}),y.load(Ft(p));else{var k=y.search(C);if(k.features.length){var I=Bt(C,k);p=p.filter(function(q){return q.id!==I.id}),y.remove(I),yi(qt(I,C),function(q){p.push(q),y.insert(q)})}}}),Ft(p)}function qt(a,c){var p=[],y=Ji(a)[0],C=Ji(a)[a.geometry.coordinates.length-1];if(Cn(y,$i(c))||Cn(C,$i(c)))return Ft([a]);var k=(0,Da.default)(),I=pa(a);k.load(I);var q=k.search(c);if(!q.features.length)return Ft([a]);var oe=Bt(c,q),ve=[y],Ke=gs(I,function($e,vt,Nt){var Wt=Ji(vt)[1],gn=$i(c);return Nt===oe.id?($e.push(gn),p.push(St($e)),Cn(gn,Wt)?[gn]:[gn,Wt]):($e.push(Wt),$e)},ve);return Ke.length>1&&p.push(St(Ke)),Ft(p)}function Bt(a,c){if(!c.features.length)throw new Error("lines must contain features");if(c.features.length===1)return c.features[0];var p,y=1/0;return yi(c,function(C){var k=no(C,a),I=k.properties.dist;I<y&&(p=C,y=I)}),p}function Cn(a,c){return a[0]===c[0]&&a[1]===c[1]}var In=bs;function si(a,c,p){if(p===void 0&&(p={}),!a)throw new Error("point is required");if(!c)throw new Error("polygon is required");var y=$i(a),C=Or(c),k=C.type,I=c.bbox,q=C.coordinates;if(I&&Yi(y,I)===!1)return!1;k==="Polygon"&&(q=[q]);for(var oe=!1,ve=0;ve<q.length&&!oe;ve++)if(_r(y,q[ve][0],p.ignoreBoundary)){for(var Ke=!1,$e=1;$e<q[ve].length&&!Ke;)_r(y,q[ve][$e],!p.ignoreBoundary)&&(Ke=!0),$e++;Ke||(oe=!0)}return oe}function _r(a,c,p){var y=!1;c[0][0]===c[c.length-1][0]&&c[0][1]===c[c.length-1][1]&&(c=c.slice(0,c.length-1));for(var C=0,k=c.length-1;C<c.length;k=C++){var I=c[C][0],q=c[C][1],oe=c[k][0],ve=c[k][1],Ke=a[1]*(I-oe)+q*(oe-a[0])+ve*(a[0]-I)===0&&(I-a[0])*(oe-a[0])<=0&&(q-a[1])*(ve-a[1])<=0;if(Ke)return!p;var $e=q>a[1]!=ve>a[1]&&a[0]<(oe-I)*(a[1]-q)/(ve-q)+I;$e&&(y=!y)}return y}function Yi(a,c){return c[0]<=a[0]&&c[1]<=a[1]&&c[2]>=a[0]&&c[3]>=a[1]}function el(a,c,p){p===void 0&&(p={});for(var y=$i(a),C=Ji(c),k=0;k<C.length-1;k++){var I=!1;if(p.ignoreEndVertices&&(k===0&&(I="start"),k===C.length-2&&(I="end"),k===0&&k+1===C.length-1&&(I="both")),Bs(C[k],C[k+1],y,I,typeof p.epsilon>"u"?null:p.epsilon))return!0}return!1}function Bs(a,c,p,y,C){var k=p[0],I=p[1],q=a[0],oe=a[1],ve=c[0],Ke=c[1],$e=p[0]-q,vt=p[1]-oe,Nt=ve-q,Wt=Ke-oe,gn=$e*Wt-vt*Nt;if(C!==null){if(Math.abs(gn)>C)return!1}else if(gn!==0)return!1;if(y){if(y==="start")return Math.abs(Nt)>=Math.abs(Wt)?Nt>0?q<k&&k<=ve:ve<=k&&k<q:Wt>0?oe<I&&I<=Ke:Ke<=I&&I<oe;if(y==="end")return Math.abs(Nt)>=Math.abs(Wt)?Nt>0?q<=k&&k<ve:ve<k&&k<=q:Wt>0?oe<=I&&I<Ke:Ke<I&&I<=oe;if(y==="both")return Math.abs(Nt)>=Math.abs(Wt)?Nt>0?q<k&&k<ve:ve<k&&k<q:Wt>0?oe<I&&I<Ke:Ke<I&&I<oe}else return Math.abs(Nt)>=Math.abs(Wt)?Nt>0?q<=k&&k<=ve:ve<=k&&k<=q:Wt>0?oe<=I&&I<=Ke:Ke<=I&&I<=oe;return!1}var br=el;function No(a,c){var p=Or(a),y=Or(c),C=p.type,k=y.type,I=p.coordinates,q=y.coordinates;switch(C){case"Point":switch(k){case"Point":return nr(I,q);default:throw new Error("feature2 "+k+" geometry not supported")}case"MultiPoint":switch(k){case"Point":return Jo(p,y);case"MultiPoint":return Ro(p,y);default:throw new Error("feature2 "+k+" geometry not supported")}case"LineString":switch(k){case"Point":return br(y,p,{ignoreEndVertices:!0});case"LineString":return Pi(p,y);case"MultiPoint":return Do(p,y);default:throw new Error("feature2 "+k+" geometry not supported")}case"Polygon":switch(k){case"Point":return si(y,p,{ignoreBoundary:!0});case"LineString":return yo(p,y);case"Polygon":return as(p,y);case"MultiPoint":return Oo(p,y);default:throw new Error("feature2 "+k+" geometry not supported")}default:throw new Error("feature1 "+C+" geometry not supported")}}function Jo(a,c){var p,y=!1;for(p=0;p<a.coordinates.length;p++)if(nr(a.coordinates[p],c.coordinates)){y=!0;break}return y}function Ro(a,c){for(var p=0,y=c.coordinates;p<y.length;p++){for(var C=y[p],k=!1,I=0,q=a.coordinates;I<q.length;I++){var oe=q[I];if(nr(C,oe)){k=!0;break}}if(!k)return!1}return!0}function Do(a,c){for(var p=!1,y=0,C=c.coordinates;y<C.length;y++){var k=C[y];if(br(k,a,{ignoreEndVertices:!0})&&(p=!0),!br(k,a))return!1}return!!p}function Oo(a,c){for(var p=0,y=c.coordinates;p<y.length;p++){var C=y[p];if(!si(C,a,{ignoreBoundary:!0}))return!1}return!0}function Pi(a,c){for(var p=!1,y=0,C=c.coordinates;y<C.length;y++){var k=C[y];if(br({type:"Point",coordinates:k},a,{ignoreEndVertices:!0})&&(p=!0),!br({type:"Point",coordinates:k},a,{ignoreEndVertices:!1}))return!1}return p}function yo(a,c){var p=!1,y=0,C=Wo(a),k=Wo(c);if(!Xi(C,k))return!1;for(y;y<c.coordinates.length-1;y++){var I=Ir(c.coordinates[y],c.coordinates[y+1]);if(si({type:"Point",coordinates:I},a,{ignoreBoundary:!0})){p=!0;break}}return p}function as(a,c){if(a.type==="Feature"&&a.geometry===null||c.type==="Feature"&&c.geometry===null)return!1;var p=Wo(a),y=Wo(c);if(!Xi(p,y))return!1;for(var C=Or(c).coordinates,k=0,I=C;k<I.length;k++)for(var q=I[k],oe=0,ve=q;oe<ve.length;oe++){var Ke=ve[oe];if(!si(Ke,a))return!1}return!0}function Xi(a,c){return!(a[0]>c[0]||a[2]<c[2]||a[1]>c[1]||a[3]<c[3])}function nr(a,c){return a[0]===c[0]&&a[1]===c[1]}function Ir(a,c){return[(a[0]+c[0])/2,(a[1]+c[1])/2]}var lr=g(ii()),io=a=>()=>a,js=a=>{let c=a?(p,y)=>y.minus(p).abs().isLessThanOrEqualTo(a):io(!1);return(p,y)=>c(p,y)?0:p.comparedTo(y)};function lo(a){let c=a?(p,y,C,k,I)=>p.exponentiatedBy(2).isLessThanOrEqualTo(k.minus(y).exponentiatedBy(2).plus(I.minus(C).exponentiatedBy(2)).times(a)):io(!1);return(p,y,C)=>{let k=p.x,I=p.y,q=C.x,oe=C.y,ve=I.minus(oe).times(y.x.minus(q)).minus(k.minus(q).times(y.y.minus(oe)));return c(ve,k,I,q,oe)?0:ve.comparedTo(0)}}var Dl=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,Io=Math.ceil,Wr=Math.floor,or="[BigNumber Error] ",ws=or+"Number primitive has more than 15 significant digits: ",Us=1e14,Yn=14,Yo=9007199254740991,Xo=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],_o=1e7,Ns=1e9;function ku(a){var c,p,y,C=Ze.prototype={constructor:Ze,toString:null,valueOf:null},k=new Ze(1),I=20,q=4,oe=-7,ve=21,Ke=-1e7,$e=1e7,vt=!1,Nt=1,Wt=0,gn={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},bn="0123456789abcdefghijklmnopqrstuvwxyz",Zn=!0;function Ze(fe,we){var De,Ne,ze,Ue,lt,ut,pt,Et,At=this;if(!(At instanceof Ze))return new Ze(fe,we);if(we==null){if(fe&&fe._isBigNumber===!0){At.s=fe.s,!fe.c||fe.e>$e?At.c=At.e=null:fe.e<Ke?At.c=[At.e=0]:(At.e=fe.e,At.c=fe.c.slice());return}if((ut=typeof fe=="number")&&fe*0==0){if(At.s=1/fe<0?(fe=-fe,-1):1,fe===~~fe){for(Ue=0,lt=fe;lt>=10;lt/=10,Ue++);Ue>$e?At.c=At.e=null:(At.e=Ue,At.c=[fe]);return}Et=String(fe)}else{if(!Dl.test(Et=String(fe)))return y(At,Et,ut);At.s=Et.charCodeAt(0)==45?(Et=Et.slice(1),-1):1}(Ue=Et.indexOf("."))>-1&&(Et=Et.replace(".","")),(lt=Et.search(/e/i))>0?(Ue<0&&(Ue=lt),Ue+=+Et.slice(lt+1),Et=Et.substring(0,lt)):Ue<0&&(Ue=Et.length)}else{if(s(we,2,bn.length,"Base"),we==10&&Zn)return At=new Ze(fe),xt(At,I+At.e+1,q);if(Et=String(fe),ut=typeof fe=="number"){if(fe*0!=0)return y(At,Et,ut,we);if(At.s=1/fe<0?(Et=Et.slice(1),-1):1,Ze.DEBUG&&Et.replace(/^0\.0*|\./,"").length>15)throw Error(ws+fe)}else At.s=Et.charCodeAt(0)===45?(Et=Et.slice(1),-1):1;for(De=bn.slice(0,we),Ue=lt=0,pt=Et.length;lt<pt;lt++)if(De.indexOf(Ne=Et.charAt(lt))<0){if(Ne=="."){if(lt>Ue){Ue=pt;continue}}else if(!ze&&(Et==Et.toUpperCase()&&(Et=Et.toLowerCase())||Et==Et.toLowerCase()&&(Et=Et.toUpperCase()))){ze=!0,lt=-1,Ue=0;continue}return y(At,String(fe),ut,we)}ut=!1,Et=p(Et,we,10,At.s),(Ue=Et.indexOf("."))>-1?Et=Et.replace(".",""):Ue=Et.length}for(lt=0;Et.charCodeAt(lt)===48;lt++);for(pt=Et.length;Et.charCodeAt(--pt)===48;);if(Et=Et.slice(lt,++pt)){if(pt-=lt,ut&&Ze.DEBUG&&pt>15&&(fe>Yo||fe!==Wr(fe)))throw Error(ws+At.s*fe);if((Ue=Ue-lt-1)>$e)At.c=At.e=null;else if(Ue<Ke)At.c=[At.e=0];else{if(At.e=Ue,At.c=[],lt=(Ue+1)%Yn,Ue<0&&(lt+=Yn),lt<pt){for(lt&&At.c.push(+Et.slice(0,lt)),pt-=Yn;lt<pt;)At.c.push(+Et.slice(lt,lt+=Yn));lt=Yn-(Et=Et.slice(lt)).length}else lt-=pt;for(;lt--;Et+="0");At.c.push(+Et)}}else At.c=[At.e=0]}Ze.clone=ku,Ze.ROUND_UP=0,Ze.ROUND_DOWN=1,Ze.ROUND_CEIL=2,Ze.ROUND_FLOOR=3,Ze.ROUND_HALF_UP=4,Ze.ROUND_HALF_DOWN=5,Ze.ROUND_HALF_EVEN=6,Ze.ROUND_HALF_CEIL=7,Ze.ROUND_HALF_FLOOR=8,Ze.EUCLID=9,Ze.config=Ze.set=function(fe){var we,De;if(fe!=null)if(typeof fe=="object"){if(fe.hasOwnProperty(we="DECIMAL_PLACES")&&(De=fe[we],s(De,0,Ns,we),I=De),fe.hasOwnProperty(we="ROUNDING_MODE")&&(De=fe[we],s(De,0,8,we),q=De),fe.hasOwnProperty(we="EXPONENTIAL_AT")&&(De=fe[we],De&&De.pop?(s(De[0],-1e9,0,we),s(De[1],0,Ns,we),oe=De[0],ve=De[1]):(s(De,-1e9,Ns,we),oe=-(ve=De<0?-De:De))),fe.hasOwnProperty(we="RANGE"))if(De=fe[we],De&&De.pop)s(De[0],-1e9,-1,we),s(De[1],1,Ns,we),Ke=De[0],$e=De[1];else if(s(De,-1e9,Ns,we),De)Ke=-($e=De<0?-De:De);else throw Error(or+we+" cannot be zero: "+De);if(fe.hasOwnProperty(we="CRYPTO"))if(De=fe[we],De===!!De)if(De)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))vt=De;else throw vt=!De,Error(or+"crypto unavailable");else vt=De;else throw Error(or+we+" not true or false: "+De);if(fe.hasOwnProperty(we="MODULO_MODE")&&(De=fe[we],s(De,0,9,we),Nt=De),fe.hasOwnProperty(we="POW_PRECISION")&&(De=fe[we],s(De,0,Ns,we),Wt=De),fe.hasOwnProperty(we="FORMAT"))if(De=fe[we],typeof De=="object")gn=De;else throw Error(or+we+" not an object: "+De);if(fe.hasOwnProperty(we="ALPHABET"))if(De=fe[we],typeof De=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(De))Zn=De.slice(0,10)=="0123456789",bn=De;else throw Error(or+we+" invalid: "+De)}else throw Error(or+"Object expected: "+fe);return{DECIMAL_PLACES:I,ROUNDING_MODE:q,EXPONENTIAL_AT:[oe,ve],RANGE:[Ke,$e],CRYPTO:vt,MODULO_MODE:Nt,POW_PRECISION:Wt,FORMAT:gn,ALPHABET:bn}},Ze.isBigNumber=function(fe){if(!fe||fe._isBigNumber!==!0)return!1;if(!Ze.DEBUG)return!0;var we,De,Ne=fe.c,ze=fe.e,Ue=fe.s;e:if({}.toString.call(Ne)=="[object Array]"){if((Ue===1||Ue===-1)&&ze>=-1e9&&ze<=Ns&&ze===Wr(ze)){if(Ne[0]===0){if(ze===0&&Ne.length===1)return!0;break e}if(we=(ze+1)%Yn,we<1&&(we+=Yn),String(Ne[0]).length==we){for(we=0;we<Ne.length;we++)if(De=Ne[we],De<0||De>=Us||De!==Wr(De))break e;if(De!==0)return!0}}}else if(Ne===null&&ze===null&&(Ue===null||Ue===1||Ue===-1))return!0;throw Error(or+"Invalid BigNumber: "+fe)},Ze.maximum=Ze.max=function(){return ht(arguments,-1)},Ze.minimum=Ze.min=function(){return ht(arguments,1)},Ze.random=function(){var fe=9007199254740992,we=Math.random()*fe&2097151?function(){return Wr(Math.random()*fe)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(De){var Ne,ze,Ue,lt,ut,pt=0,Et=[],At=new Ze(k);if(De==null?De=I:s(De,0,Ns),lt=Io(De/Yn),vt)if(crypto.getRandomValues){for(Ne=crypto.getRandomValues(new Uint32Array(lt*=2));pt<lt;)ut=Ne[pt]*131072+(Ne[pt+1]>>>11),ut>=9e15?(ze=crypto.getRandomValues(new Uint32Array(2)),Ne[pt]=ze[0],Ne[pt+1]=ze[1]):(Et.push(ut%1e14),pt+=2);pt=lt/2}else if(crypto.randomBytes){for(Ne=crypto.randomBytes(lt*=7);pt<lt;)ut=(Ne[pt]&31)*281474976710656+Ne[pt+1]*1099511627776+Ne[pt+2]*4294967296+Ne[pt+3]*16777216+(Ne[pt+4]<<16)+(Ne[pt+5]<<8)+Ne[pt+6],ut>=9e15?crypto.randomBytes(7).copy(Ne,pt):(Et.push(ut%1e14),pt+=7);pt=lt/7}else throw vt=!1,Error(or+"crypto unavailable");if(!vt)for(;pt<lt;)ut=we(),ut<9e15&&(Et[pt++]=ut%1e14);for(lt=Et[--pt],De%=Yn,lt&&De&&(ut=Xo[Yn-De],Et[pt]=Wr(lt/ut)*ut);Et[pt]===0;Et.pop(),pt--);if(pt<0)Et=[Ue=0];else{for(Ue=-1;Et[0]===0;Et.splice(0,1),Ue-=Yn);for(pt=1,ut=Et[0];ut>=10;ut/=10,pt++);pt<Yn&&(Ue-=Yn-pt)}return At.e=Ue,At.c=Et,At}}(),Ze.sum=function(){for(var fe=1,we=arguments,De=new Ze(we[0]);fe<we.length;)De=De.plus(we[fe++]);return De},p=function(){var fe="0123456789";function we(De,Ne,ze,Ue){for(var lt,ut=[0],pt,Et=0,At=De.length;Et<At;){for(pt=ut.length;pt--;ut[pt]*=Ne);for(ut[0]+=Ue.indexOf(De.charAt(Et++)),lt=0;lt<ut.length;lt++)ut[lt]>ze-1&&(ut[lt+1]==null&&(ut[lt+1]=0),ut[lt+1]+=ut[lt]/ze|0,ut[lt]%=ze)}return ut.reverse()}return function(De,Ne,ze,Ue,lt){var ut,pt,Et,At,en,Tn,Rn,qn,Hi=De.indexOf("."),ir=I,Ei=q;for(Hi>=0&&(At=Wt,Wt=0,De=De.replace(".",""),qn=new Ze(Ne),Tn=qn.pow(De.length-Hi),Wt=At,qn.c=we(T(us(Tn.c),Tn.e,"0"),10,ze,fe),qn.e=qn.c.length),Rn=we(De,Ne,ze,lt?(ut=bn,fe):(ut=fe,bn)),Et=At=Rn.length;Rn[--At]==0;Rn.pop());if(!Rn[0])return ut.charAt(0);if(Hi<0?--Et:(Tn.c=Rn,Tn.e=Et,Tn.s=Ue,Tn=c(Tn,qn,ir,Ei,ze),Rn=Tn.c,en=Tn.r,Et=Tn.e),pt=Et+ir+1,Hi=Rn[pt],At=ze/2,en=en||pt<0||Rn[pt+1]!=null,en=Ei<4?(Hi!=null||en)&&(Ei==0||Ei==(Tn.s<0?3:2)):Hi>At||Hi==At&&(Ei==4||en||Ei==6&&Rn[pt-1]&1||Ei==(Tn.s<0?8:7)),pt<1||!Rn[0])De=en?T(ut.charAt(1),-ir,ut.charAt(0)):ut.charAt(0);else{if(Rn.length=pt,en)for(--ze;++Rn[--pt]>ze;)Rn[pt]=0,pt||(++Et,Rn=[1].concat(Rn));for(At=Rn.length;!Rn[--At];);for(Hi=0,De="";Hi<=At;De+=ut.charAt(Rn[Hi++]));De=T(De,Et,ut.charAt(0))}return De}}(),c=function(){function fe(Ne,ze,Ue){var lt,ut,pt,Et,At=0,en=Ne.length,Tn=ze%_o,Rn=ze/_o|0;for(Ne=Ne.slice();en--;)pt=Ne[en]%_o,Et=Ne[en]/_o|0,lt=Rn*pt+Et*Tn,ut=Tn*pt+lt%_o*_o+At,At=(ut/Ue|0)+(lt/_o|0)+Rn*Et,Ne[en]=ut%Ue;return At&&(Ne=[At].concat(Ne)),Ne}function we(Ne,ze,Ue,lt){var ut,pt;if(Ue!=lt)pt=Ue>lt?1:-1;else for(ut=pt=0;ut<Ue;ut++)if(Ne[ut]!=ze[ut]){pt=Ne[ut]>ze[ut]?1:-1;break}return pt}function De(Ne,ze,Ue,lt){for(var ut=0;Ue--;)Ne[Ue]-=ut,ut=Ne[Ue]<ze[Ue]?1:0,Ne[Ue]=ut*lt+Ne[Ue]-ze[Ue];for(;!Ne[0]&&Ne.length>1;Ne.splice(0,1));}return function(Ne,ze,Ue,lt,ut){var pt,Et,At,en,Tn,Rn,qn,Hi,ir,Ei,ur,Vs,Il,zo,Tc,ma,lu,jo=Ne.s==ze.s?1:-1,Ls=Ne.c,Fr=ze.c;if(!Ls||!Ls[0]||!Fr||!Fr[0])return new Ze(!Ne.s||!ze.s||(Ls?Fr&&Ls[0]==Fr[0]:!Fr)?NaN:Ls&&Ls[0]==0||!Fr?jo*0:jo/0);for(Hi=new Ze(jo),ir=Hi.c=[],Et=Ne.e-ze.e,jo=Ue+Et+1,ut||(ut=Us,Et=ls(Ne.e/Yn)-ls(ze.e/Yn),jo=jo/Yn|0),At=0;Fr[At]==(Ls[At]||0);At++);if(Fr[At]>(Ls[At]||0)&&Et--,jo<0)ir.push(1),en=!0;else{for(zo=Ls.length,ma=Fr.length,At=0,jo+=2,Tn=Wr(ut/(Fr[0]+1)),Tn>1&&(Fr=fe(Fr,Tn,ut),Ls=fe(Ls,Tn,ut),ma=Fr.length,zo=Ls.length),Il=ma,Ei=Ls.slice(0,ma),ur=Ei.length;ur<ma;Ei[ur++]=0);lu=Fr.slice(),lu=[0].concat(lu),Tc=Fr[0],Fr[1]>=ut/2&&Tc++;do{if(Tn=0,pt=we(Fr,Ei,ma,ur),pt<0){if(Vs=Ei[0],ma!=ur&&(Vs=Vs*ut+(Ei[1]||0)),Tn=Wr(Vs/Tc),Tn>1)for(Tn>=ut&&(Tn=ut-1),Rn=fe(Fr,Tn,ut),qn=Rn.length,ur=Ei.length;we(Rn,Ei,qn,ur)==1;)Tn--,De(Rn,ma<qn?lu:Fr,qn,ut),qn=Rn.length,pt=1;else Tn==0&&(pt=Tn=1),Rn=Fr.slice(),qn=Rn.length;if(qn<ur&&(Rn=[0].concat(Rn)),De(Ei,Rn,ur,ut),ur=Ei.length,pt==-1)for(;we(Fr,Ei,ma,ur)<1;)Tn++,De(Ei,ma<ur?lu:Fr,ur,ut),ur=Ei.length}else pt===0&&(Tn++,Ei=[0]);ir[At++]=Tn,Ei[0]?Ei[ur++]=Ls[Il]||0:(Ei=[Ls[Il]],ur=1)}while((Il++<zo||Ei[0]!=null)&&jo--);en=Ei[0]!=null,ir[0]||ir.splice(0,1)}if(ut==Us){for(At=1,jo=ir[0];jo>=10;jo/=10,At++);xt(Hi,Ue+(Hi.e=At+Et*Yn-1)+1,lt,en)}else Hi.e=Et,Hi.r=+en;return Hi}}();function it(fe,we,De,Ne){var ze,Ue,lt,ut,pt;if(De==null?De=q:s(De,0,8),!fe.c)return fe.toString();if(ze=fe.c[0],lt=fe.e,we==null)pt=us(fe.c),pt=Ne==1||Ne==2&&(lt<=oe||lt>=ve)?w(pt,lt):T(pt,lt,"0");else if(fe=xt(new Ze(fe),we,De),Ue=fe.e,pt=us(fe.c),ut=pt.length,Ne==1||Ne==2&&(we<=Ue||Ue<=oe)){for(;ut<we;pt+="0",ut++);pt=w(pt,Ue)}else if(we-=lt,pt=T(pt,Ue,"0"),Ue+1>ut){if(--we>0)for(pt+=".";we--;pt+="0");}else if(we+=Ue-ut,we>0)for(Ue+1==ut&&(pt+=".");we--;pt+="0");return fe.s<0&&ze?"-"+pt:pt}function ht(fe,we){for(var De,Ne,ze=1,Ue=new Ze(fe[0]);ze<fe.length;ze++)Ne=new Ze(fe[ze]),(!Ne.s||(De=bo(Ue,Ne))===we||De===0&&Ue.s===we)&&(Ue=Ne);return Ue}function It(fe,we,De){for(var Ne=1,ze=we.length;!we[--ze];we.pop());for(ze=we[0];ze>=10;ze/=10,Ne++);return(De=Ne+De*Yn-1)>$e?fe.c=fe.e=null:De<Ke?fe.c=[fe.e=0]:(fe.e=De,fe.c=we),fe}y=function(){var fe=/^(-?)0([xbo])(?=\w[\w.]*$)/i,we=/^([^.]+)\.$/,De=/^\.([^.]+)$/,Ne=/^-?(Infinity|NaN)$/,ze=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(Ue,lt,ut,pt){var Et,At=ut?lt:lt.replace(ze,"");if(Ne.test(At))Ue.s=isNaN(At)?null:At<0?-1:1;else{if(!ut&&(At=At.replace(fe,function(en,Tn,Rn){return Et=(Rn=Rn.toLowerCase())=="x"?16:Rn=="b"?2:8,!pt||pt==Et?Tn:en}),pt&&(Et=pt,At=At.replace(we,"$1").replace(De,"0.$1")),lt!=At))return new Ze(At,Et);if(Ze.DEBUG)throw Error(or+"Not a"+(pt?" base "+pt:"")+" number: "+lt);Ue.s=null}Ue.c=Ue.e=null}}();function xt(fe,we,De,Ne){var ze,Ue,lt,ut,pt,Et,At,en=fe.c,Tn=Xo;if(en){e:{for(ze=1,ut=en[0];ut>=10;ut/=10,ze++);if(Ue=we-ze,Ue<0)Ue+=Yn,lt=we,pt=en[Et=0],At=Wr(pt/Tn[ze-lt-1]%10);else if(Et=Io((Ue+1)/Yn),Et>=en.length)if(Ne){for(;en.length<=Et;en.push(0));pt=At=0,ze=1,Ue%=Yn,lt=Ue-Yn+1}else break e;else{for(pt=ut=en[Et],ze=1;ut>=10;ut/=10,ze++);Ue%=Yn,lt=Ue-Yn+ze,At=lt<0?0:Wr(pt/Tn[ze-lt-1]%10)}if(Ne=Ne||we<0||en[Et+1]!=null||(lt<0?pt:pt%Tn[ze-lt-1]),Ne=De<4?(At||Ne)&&(De==0||De==(fe.s<0?3:2)):At>5||At==5&&(De==4||Ne||De==6&&(Ue>0?lt>0?pt/Tn[ze-lt]:0:en[Et-1])%10&1||De==(fe.s<0?8:7)),we<1||!en[0])return en.length=0,Ne?(we-=fe.e+1,en[0]=Tn[(Yn-we%Yn)%Yn],fe.e=-we||0):en[0]=fe.e=0,fe;if(Ue==0?(en.length=Et,ut=1,Et--):(en.length=Et+1,ut=Tn[Yn-Ue],en[Et]=lt>0?Wr(pt/Tn[ze-lt]%Tn[lt])*ut:0),Ne)for(;;)if(Et==0){for(Ue=1,lt=en[0];lt>=10;lt/=10,Ue++);for(lt=en[0]+=ut,ut=1;lt>=10;lt/=10,ut++);Ue!=ut&&(fe.e++,en[0]==Us&&(en[0]=1));break}else{if(en[Et]+=ut,en[Et]!=Us)break;en[Et--]=0,ut=1}for(Ue=en.length;en[--Ue]===0;en.pop());}fe.e>$e?fe.c=fe.e=null:fe.e<Ke&&(fe.c=[fe.e=0])}return fe}function Rt(fe){var we,De=fe.e;return De===null?fe.toString():(we=us(fe.c),we=De<=oe||De>=ve?w(we,De):T(we,De,"0"),fe.s<0?"-"+we:we)}return C.absoluteValue=C.abs=function(){var fe=new Ze(this);return fe.s<0&&(fe.s=1),fe},C.comparedTo=function(fe,we){return bo(this,new Ze(fe,we))},C.decimalPlaces=C.dp=function(fe,we){var De,Ne,ze,Ue=this;if(fe!=null)return s(fe,0,Ns),we==null?we=q:s(we,0,8),xt(new Ze(Ue),fe+Ue.e+1,we);if(!(De=Ue.c))return null;if(Ne=((ze=De.length-1)-ls(this.e/Yn))*Yn,ze=De[ze])for(;ze%10==0;ze/=10,Ne--);return Ne<0&&(Ne=0),Ne},C.dividedBy=C.div=function(fe,we){return c(this,new Ze(fe,we),I,q)},C.dividedToIntegerBy=C.idiv=function(fe,we){return c(this,new Ze(fe,we),0,1)},C.exponentiatedBy=C.pow=function(fe,we){var De,Ne,ze,Ue,lt,ut,pt,Et,At,en=this;if(fe=new Ze(fe),fe.c&&!fe.isInteger())throw Error(or+"Exponent not an integer: "+Rt(fe));if(we!=null&&(we=new Ze(we)),ut=fe.e>14,!en.c||!en.c[0]||en.c[0]==1&&!en.e&&en.c.length==1||!fe.c||!fe.c[0])return At=new Ze(Math.pow(+Rt(en),ut?fe.s*(2-f(fe)):+Rt(fe))),we?At.mod(we):At;if(pt=fe.s<0,we){if(we.c?!we.c[0]:!we.s)return new Ze(NaN);Ne=!pt&&en.isInteger()&&we.isInteger(),Ne&&(en=en.mod(we))}else{if(fe.e>9&&(en.e>0||en.e<-1||(en.e==0?en.c[0]>1||ut&&en.c[1]>=24e7:en.c[0]<8e13||ut&&en.c[0]<=9999975e7)))return Ue=en.s<0&&f(fe)?-0:0,en.e>-1&&(Ue=1/Ue),new Ze(pt?1/Ue:Ue);Wt&&(Ue=Io(Wt/Yn+2))}for(ut?(De=new Ze(.5),pt&&(fe.s=1),Et=f(fe)):(ze=Math.abs(+Rt(fe)),Et=ze%2),At=new Ze(k);;){if(Et){if(At=At.times(en),!At.c)break;Ue?At.c.length>Ue&&(At.c.length=Ue):Ne&&(At=At.mod(we))}if(ze){if(ze=Wr(ze/2),ze===0)break;Et=ze%2}else if(fe=fe.times(De),xt(fe,fe.e+1,1),fe.e>14)Et=f(fe);else{if(ze=+Rt(fe),ze===0)break;Et=ze%2}en=en.times(en),Ue?en.c&&en.c.length>Ue&&(en.c.length=Ue):Ne&&(en=en.mod(we))}return Ne?At:(pt&&(At=k.div(At)),we?At.mod(we):Ue?xt(At,Wt,q,lt):At)},C.integerValue=function(fe){var we=new Ze(this);return fe==null?fe=q:s(fe,0,8),xt(we,we.e+1,fe)},C.isEqualTo=C.eq=function(fe,we){return bo(this,new Ze(fe,we))===0},C.isFinite=function(){return!!this.c},C.isGreaterThan=C.gt=function(fe,we){return bo(this,new Ze(fe,we))>0},C.isGreaterThanOrEqualTo=C.gte=function(fe,we){return(we=bo(this,new Ze(fe,we)))===1||we===0},C.isInteger=function(){return!!this.c&&ls(this.e/Yn)>this.c.length-2},C.isLessThan=C.lt=function(fe,we){return bo(this,new Ze(fe,we))<0},C.isLessThanOrEqualTo=C.lte=function(fe,we){return(we=bo(this,new Ze(fe,we)))===-1||we===0},C.isNaN=function(){return!this.s},C.isNegative=function(){return this.s<0},C.isPositive=function(){return this.s>0},C.isZero=function(){return!!this.c&&this.c[0]==0},C.minus=function(fe,we){var De,Ne,ze,Ue,lt=this,ut=lt.s;if(fe=new Ze(fe,we),we=fe.s,!ut||!we)return new Ze(NaN);if(ut!=we)return fe.s=-we,lt.plus(fe);var pt=lt.e/Yn,Et=fe.e/Yn,At=lt.c,en=fe.c;if(!pt||!Et){if(!At||!en)return At?(fe.s=-we,fe):new Ze(en?lt:NaN);if(!At[0]||!en[0])return en[0]?(fe.s=-we,fe):new Ze(At[0]?lt:q==3?-0:0)}if(pt=ls(pt),Et=ls(Et),At=At.slice(),ut=pt-Et){for((Ue=ut<0)?(ut=-ut,ze=At):(Et=pt,ze=en),ze.reverse(),we=ut;we--;ze.push(0));ze.reverse()}else for(Ne=(Ue=(ut=At.length)<(we=en.length))?ut:we,ut=we=0;we<Ne;we++)if(At[we]!=en[we]){Ue=At[we]<en[we];break}if(Ue&&(ze=At,At=en,en=ze,fe.s=-fe.s),we=(Ne=en.length)-(De=At.length),we>0)for(;we--;At[De++]=0);for(we=Us-1;Ne>ut;){if(At[--Ne]<en[Ne]){for(De=Ne;De&&!At[--De];At[De]=we);--At[De],At[Ne]+=Us}At[Ne]-=en[Ne]}for(;At[0]==0;At.splice(0,1),--Et);return At[0]?It(fe,At,Et):(fe.s=q==3?-1:1,fe.c=[fe.e=0],fe)},C.modulo=C.mod=function(fe,we){var De,Ne,ze=this;return fe=new Ze(fe,we),!ze.c||!fe.s||fe.c&&!fe.c[0]?new Ze(NaN):!fe.c||ze.c&&!ze.c[0]?new Ze(ze):(Nt==9?(Ne=fe.s,fe.s=1,De=c(ze,fe,0,3),fe.s=Ne,De.s*=Ne):De=c(ze,fe,0,Nt),fe=ze.minus(De.times(fe)),!fe.c[0]&&Nt==1&&(fe.s=ze.s),fe)},C.multipliedBy=C.times=function(fe,we){var De,Ne,ze,Ue,lt,ut,pt,Et,At,en,Tn,Rn,qn,Hi,ir,Ei=this,ur=Ei.c,Vs=(fe=new Ze(fe,we)).c;if(!ur||!Vs||!ur[0]||!Vs[0])return!Ei.s||!fe.s||ur&&!ur[0]&&!Vs||Vs&&!Vs[0]&&!ur?fe.c=fe.e=fe.s=null:(fe.s*=Ei.s,!ur||!Vs?fe.c=fe.e=null:(fe.c=[0],fe.e=0)),fe;for(Ne=ls(Ei.e/Yn)+ls(fe.e/Yn),fe.s*=Ei.s,pt=ur.length,en=Vs.length,pt<en&&(qn=ur,ur=Vs,Vs=qn,ze=pt,pt=en,en=ze),ze=pt+en,qn=[];ze--;qn.push(0));for(Hi=Us,ir=_o,ze=en;--ze>=0;){for(De=0,Tn=Vs[ze]%ir,Rn=Vs[ze]/ir|0,lt=pt,Ue=ze+lt;Ue>ze;)Et=ur[--lt]%ir,At=ur[lt]/ir|0,ut=Rn*Et+At*Tn,Et=Tn*Et+ut%ir*ir+qn[Ue]+De,De=(Et/Hi|0)+(ut/ir|0)+Rn*At,qn[Ue--]=Et%Hi;qn[Ue]=De}return De?++Ne:qn.splice(0,1),It(fe,qn,Ne)},C.negated=function(){var fe=new Ze(this);return fe.s=-fe.s||null,fe},C.plus=function(fe,we){var De,Ne=this,ze=Ne.s;if(fe=new Ze(fe,we),we=fe.s,!ze||!we)return new Ze(NaN);if(ze!=we)return fe.s=-we,Ne.minus(fe);var Ue=Ne.e/Yn,lt=fe.e/Yn,ut=Ne.c,pt=fe.c;if(!Ue||!lt){if(!ut||!pt)return new Ze(ze/0);if(!ut[0]||!pt[0])return pt[0]?fe:new Ze(ut[0]?Ne:ze*0)}if(Ue=ls(Ue),lt=ls(lt),ut=ut.slice(),ze=Ue-lt){for(ze>0?(lt=Ue,De=pt):(ze=-ze,De=ut),De.reverse();ze--;De.push(0));De.reverse()}for(ze=ut.length,we=pt.length,ze-we<0&&(De=pt,pt=ut,ut=De,we=ze),ze=0;we;)ze=(ut[--we]=ut[we]+pt[we]+ze)/Us|0,ut[we]=Us===ut[we]?0:ut[we]%Us;return ze&&(ut=[ze].concat(ut),++lt),It(fe,ut,lt)},C.precision=C.sd=function(fe,we){var De,Ne,ze,Ue=this;if(fe!=null&&fe!==!!fe)return s(fe,1,Ns),we==null?we=q:s(we,0,8),xt(new Ze(Ue),fe,we);if(!(De=Ue.c))return null;if(ze=De.length-1,Ne=ze*Yn+1,ze=De[ze]){for(;ze%10==0;ze/=10,Ne--);for(ze=De[0];ze>=10;ze/=10,Ne++);}return fe&&Ue.e+1>Ne&&(Ne=Ue.e+1),Ne},C.shiftedBy=function(fe){return s(fe,-9007199254740991,Yo),this.times("1e"+fe)},C.squareRoot=C.sqrt=function(){var fe,we,De,Ne,ze,Ue=this,lt=Ue.c,ut=Ue.s,pt=Ue.e,Et=I+4,At=new Ze("0.5");if(ut!==1||!lt||!lt[0])return new Ze(!ut||ut<0&&(!lt||lt[0])?NaN:lt?Ue:1/0);if(ut=Math.sqrt(+Rt(Ue)),ut==0||ut==1/0?(we=us(lt),(we.length+pt)%2==0&&(we+="0"),ut=Math.sqrt(+we),pt=ls((pt+1)/2)-(pt<0||pt%2),ut==1/0?we="5e"+pt:(we=ut.toExponential(),we=we.slice(0,we.indexOf("e")+1)+pt),De=new Ze(we)):De=new Ze(ut+""),De.c[0]){for(pt=De.e,ut=pt+Et,ut<3&&(ut=0);;)if(ze=De,De=At.times(ze.plus(c(Ue,ze,Et,1))),us(ze.c).slice(0,ut)===(we=us(De.c)).slice(0,ut))if(De.e<pt&&--ut,we=we.slice(ut-3,ut+1),we=="9999"||!Ne&&we=="4999"){if(!Ne&&(xt(ze,ze.e+I+2,0),ze.times(ze).eq(Ue))){De=ze;break}Et+=4,ut+=4,Ne=1}else{(!+we||!+we.slice(1)&&we.charAt(0)=="5")&&(xt(De,De.e+I+2,1),fe=!De.times(De).eq(Ue));break}}return xt(De,De.e+I+1,q,fe)},C.toExponential=function(fe,we){return fe!=null&&(s(fe,0,Ns),fe++),it(this,fe,we,1)},C.toFixed=function(fe,we){return fe!=null&&(s(fe,0,Ns),fe=fe+this.e+1),it(this,fe,we)},C.toFormat=function(fe,we,De){var Ne,ze=this;if(De==null)fe!=null&&we&&typeof we=="object"?(De=we,we=null):fe&&typeof fe=="object"?(De=fe,fe=we=null):De=gn;else if(typeof De!="object")throw Error(or+"Argument not an object: "+De);if(Ne=ze.toFixed(fe,we),ze.c){var Ue,lt=Ne.split("."),ut=+De.groupSize,pt=+De.secondaryGroupSize,Et=De.groupSeparator||"",At=lt[0],en=lt[1],Tn=ze.s<0,Rn=Tn?At.slice(1):At,qn=Rn.length;if(pt&&(Ue=ut,ut=pt,pt=Ue,qn-=Ue),ut>0&&qn>0){for(Ue=qn%ut||ut,At=Rn.substr(0,Ue);Ue<qn;Ue+=ut)At+=Et+Rn.substr(Ue,ut);pt>0&&(At+=Et+Rn.slice(Ue)),Tn&&(At="-"+At)}Ne=en?At+(De.decimalSeparator||"")+((pt=+De.fractionGroupSize)?en.replace(new RegExp("\\d{"+pt+"}\\B","g"),"$&"+(De.fractionGroupSeparator||"")):en):At}return(De.prefix||"")+Ne+(De.suffix||"")},C.toFraction=function(fe){var we,De,Ne,ze,Ue,lt,ut,pt,Et,At,en,Tn,Rn=this,qn=Rn.c;if(fe!=null&&(ut=new Ze(fe),!ut.isInteger()&&(ut.c||ut.s!==1)||ut.lt(k)))throw Error(or+"Argument "+(ut.isInteger()?"out of range: ":"not an integer: ")+Rt(ut));if(!qn)return new Ze(Rn);for(we=new Ze(k),Et=De=new Ze(k),Ne=pt=new Ze(k),Tn=us(qn),Ue=we.e=Tn.length-Rn.e-1,we.c[0]=Xo[(lt=Ue%Yn)<0?Yn+lt:lt],fe=!fe||ut.comparedTo(we)>0?Ue>0?we:Et:ut,lt=$e,$e=1/0,ut=new Ze(Tn),pt.c[0]=0;At=c(ut,we,0,1),ze=De.plus(At.times(Ne)),ze.comparedTo(fe)!=1;)De=Ne,Ne=ze,Et=pt.plus(At.times(ze=Et)),pt=ze,we=ut.minus(At.times(ze=we)),ut=ze;return ze=c(fe.minus(De),Ne,0,1),pt=pt.plus(ze.times(Et)),De=De.plus(ze.times(Ne)),pt.s=Et.s=Rn.s,Ue=Ue*2,en=c(Et,Ne,Ue,q).minus(Rn).abs().comparedTo(c(pt,De,Ue,q).minus(Rn).abs())<1?[Et,Ne]:[pt,De],$e=lt,en},C.toNumber=function(){return+Rt(this)},C.toPrecision=function(fe,we){return fe!=null&&s(fe,1,Ns),it(this,fe,we,2)},C.toString=function(fe){var we,De=this,Ne=De.s,ze=De.e;return ze===null?Ne?(we="Infinity",Ne<0&&(we="-"+we)):we="NaN":(fe==null?we=ze<=oe||ze>=ve?w(us(De.c),ze):T(us(De.c),ze,"0"):fe===10&&Zn?(De=xt(new Ze(De),I+ze+1,q),we=T(us(De.c),De.e,"0")):(s(fe,2,bn.length,"Base"),we=p(T(us(De.c),ze,"0"),10,fe,Ne,!0)),Ne<0&&De.c[0]&&(we="-"+we)),we},C.valueOf=C.toJSON=function(){return Rt(this)},C._isBigNumber=!0,C[Symbol.toStringTag]="BigNumber",C[Symbol.for("nodejs.util.inspect.custom")]=C.valueOf,a!=null&&Ze.set(a),Ze}function ls(a){var c=a|0;return a>0||a===c?c:c-1}function us(a){for(var c,p,y=1,C=a.length,k=a[0]+"";y<C;){for(c=a[y++]+"",p=Yn-c.length;p--;c="0"+c);k+=c}for(C=k.length;k.charCodeAt(--C)===48;);return k.slice(0,C+1||1)}function bo(a,c){var p,y,C=a.c,k=c.c,I=a.s,q=c.s,oe=a.e,ve=c.e;if(!I||!q)return null;if(p=C&&!C[0],y=k&&!k[0],p||y)return p?y?0:-q:I;if(I!=q)return I;if(p=I<0,y=oe==ve,!C||!k)return y?0:!C^p?1:-1;if(!y)return oe>ve^p?1:-1;for(q=(oe=C.length)<(ve=k.length)?oe:ve,I=0;I<q;I++)if(C[I]!=k[I])return C[I]>k[I]^p?1:-1;return oe==ve?0:oe>ve^p?1:-1}function s(a,c,p,y){if(a<c||a>p||a!==Wr(a))throw Error(or+(y||"Argument")+(typeof a=="number"?a<c||a>p?" out of range: ":" not an integer: ":" not a primitive number: ")+String(a))}function f(a){var c=a.c.length-1;return ls(a.e/Yn)==c&&a.c[c]%2!=0}function w(a,c){return(a.length>1?a.charAt(0)+"."+a.slice(1):a)+(c<0?"e":"e+")+c}function T(a,c,p){var y,C;if(c<0){for(C=p+".";++c;C+=p);a=C+a}else if(y=a.length,++c>y){for(C=p,c-=y;--c;C+=p);a+=C}else c<y&&(a=a.slice(0,c)+"."+a.slice(c));return a}var Z=ku(),_e=Z,at=class{constructor(a){Pt(this,"key");Pt(this,"left",null);Pt(this,"right",null);this.key=a}},Tt=class extends at{constructor(a){super(a)}},zt=class{constructor(){Pt(this,"size",0);Pt(this,"modificationCount",0);Pt(this,"splayCount",0)}splay(a){let c=this.root;if(c==null)return this.compare(a,a),-1;let p=null,y=null,C=null,k=null,I=c,q=this.compare,oe;for(;;)if(oe=q(I.key,a),oe>0){let ve=I.left;if(ve==null||(oe=q(ve.key,a),oe>0&&(I.left=ve.right,ve.right=I,I=ve,ve=I.left,ve==null)))break;p==null?y=I:p.left=I,p=I,I=ve}else if(oe<0){let ve=I.right;if(ve==null||(oe=q(ve.key,a),oe<0&&(I.right=ve.left,ve.left=I,I=ve,ve=I.right,ve==null)))break;C==null?k=I:C.right=I,C=I,I=ve}else break;return C!=null&&(C.right=I.left,I.left=k),p!=null&&(p.left=I.right,I.right=y),this.root!==I&&(this.root=I,this.splayCount++),oe}splayMin(a){let c=a,p=c.left;for(;p!=null;){let y=p;c.left=y.right,y.right=c,c=y,p=c.left}return c}splayMax(a){let c=a,p=c.right;for(;p!=null;){let y=p;c.right=y.left,y.left=c,c=y,p=c.right}return c}_delete(a){if(this.root==null||this.splay(a)!=0)return null;let c=this.root,p=c,y=c.left;if(this.size--,y==null)this.root=c.right;else{let C=c.right;c=this.splayMax(y),c.right=C,this.root=c}return this.modificationCount++,p}addNewRoot(a,c){this.size++,this.modificationCount++;let p=this.root;if(p==null){this.root=a;return}c<0?(a.left=p,a.right=p.right,p.right=null):(a.right=p,a.left=p.left,p.left=null),this.root=a}_first(){let a=this.root;return a==null?null:(this.root=this.splayMin(a),this.root)}_last(){let a=this.root;return a==null?null:(this.root=this.splayMax(a),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(a){return this.validKey(a)&&this.splay(a)==0}defaultCompare(){return(a,c)=>a<c?-1:a>c?1:0}wrap(){return{getRoot:()=>this.root,setRoot:a=>{this.root=a},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:a=>{this.splayCount=a},splay:a=>this.splay(a),has:a=>this.has(a)}}},tn=class wf extends zt{constructor(p,y){super();Pt(this,"root",null);Pt(this,"compare");Pt(this,"validKey");Pt(this,Ln,"[object Set]");this.compare=p??this.defaultCompare(),this.validKey=y??(C=>C!=null&&C!=null)}delete(p){return this.validKey(p)?this._delete(p)!=null:!1}deleteAll(p){for(let y of p)this.delete(y)}forEach(p){let y=this[Symbol.iterator](),C;for(;C=y.next(),!C.done;)p(C.value,C.value,this)}add(p){let y=this.splay(p);return y!=0&&this.addNewRoot(new Tt(p),y),this}addAndReturn(p){let y=this.splay(p);return y!=0&&this.addNewRoot(new Tt(p),y),this.root.key}addAll(p){for(let y of p)this.add(y)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(p){if(p==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(p)<0)return this.root.key;let y=this.root.left;if(y==null)return null;let C=y.right;for(;C!=null;)y=C,C=y.right;return y.key}firstAfter(p){if(p==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(p)>0)return this.root.key;let y=this.root.right;if(y==null)return null;let C=y.left;for(;C!=null;)y=C,C=y.left;return y.key}retainAll(p){let y=new wf(this.compare,this.validKey),C=this.modificationCount;for(let k of p){if(C!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(k)&&this.splay(k)==0&&y.add(this.root.key)}y.size!=this.size&&(this.root=y.root,this.size=y.size,this.modificationCount++)}lookup(p){return!this.validKey(p)||this.splay(p)!=0?null:this.root.key}intersection(p){let y=new wf(this.compare,this.validKey);for(let C of this)p.has(C)&&y.add(C);return y}difference(p){let y=new wf(this.compare,this.validKey);for(let C of this)p.has(C)||y.add(C);return y}union(p){let y=this.clone();return y.addAll(p),y}clone(){let p=new wf(this.compare,this.validKey);return p.size=this.size,p.root=this.copyNode(this.root),p}copyNode(p){if(p==null)return null;function y(k,I){let q,oe;do{if(q=k.left,oe=k.right,q!=null){let ve=new Tt(q.key);I.left=ve,y(q,ve)}if(oe!=null){let ve=new Tt(oe.key);I.right=ve,k=oe,I=ve}}while(oe!=null)}let C=new Tt(p.key);return y(p,C),C}toSet(){return this.clone()}entries(){return new gi(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[($n=Symbol.iterator,Ln=Symbol.toStringTag,$n)](){return new Un(this.wrap())}},En=class{constructor(a){Pt(this,"tree");Pt(this,"path",new Array);Pt(this,"modificationCount",null);Pt(this,"splayCount");this.tree=a,this.splayCount=a.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;let a=this.path[this.path.length-1];return this.getValue(a)}rebuildPath(a){this.path.splice(0,this.path.length),this.tree.splay(a),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(a){for(;a!=null;)this.path.push(a),a=a.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let p=this.tree.getRoot();for(;p!=null;)this.path.push(p),p=p.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let a=this.path[this.path.length-1],c=a.right;if(c!=null){for(;c!=null;)this.path.push(c),c=c.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===a;)a=this.path.pop();return this.path.length>0}},Un=class extends En{getValue(a){return a.key}},gi=class extends En{getValue(a){return[a.key,a.key]}},Zr=a=>a,Ar=a=>{if(a){let c=new tn(js(a)),p=new tn(js(a)),y=(k,I)=>I.addAndReturn(k),C=k=>({x:y(k.x,c),y:y(k.y,p)});return C({x:new _e(0),y:new _e(0)}),C}return Zr},cs=a=>({set:c=>{wr=cs(c)},reset:()=>cs(a),compare:js(a),snap:Ar(a),orient:lo(a)}),wr=cs(),$s=(a,c)=>a.ll.x.isLessThanOrEqualTo(c.x)&&c.x.isLessThanOrEqualTo(a.ur.x)&&a.ll.y.isLessThanOrEqualTo(c.y)&&c.y.isLessThanOrEqualTo(a.ur.y),Tu=(a,c)=>{if(c.ur.x.isLessThan(a.ll.x)||a.ur.x.isLessThan(c.ll.x)||c.ur.y.isLessThan(a.ll.y)||a.ur.y.isLessThan(c.ll.y))return null;let p=a.ll.x.isLessThan(c.ll.x)?c.ll.x:a.ll.x,y=a.ur.x.isLessThan(c.ur.x)?a.ur.x:c.ur.x,C=a.ll.y.isLessThan(c.ll.y)?c.ll.y:a.ll.y,k=a.ur.y.isLessThan(c.ur.y)?a.ur.y:c.ur.y;return{ll:{x:p,y:C},ur:{x:y,y:k}}},Fo=(a,c)=>a.x.times(c.y).minus(a.y.times(c.x)),wo=(a,c)=>a.x.times(c.x).plus(a.y.times(c.y)),uo=a=>wo(a,a).sqrt(),Mc=(a,c,p)=>{let y={x:c.x.minus(a.x),y:c.y.minus(a.y)},C={x:p.x.minus(a.x),y:p.y.minus(a.y)};return Fo(C,y).div(uo(C)).div(uo(y))},gl=(a,c,p)=>{let y={x:c.x.minus(a.x),y:c.y.minus(a.y)},C={x:p.x.minus(a.x),y:p.y.minus(a.y)};return wo(C,y).div(uo(C)).div(uo(y))},Gi=(a,c,p)=>c.y.isZero()?null:{x:a.x.plus(c.x.div(c.y).times(p.minus(a.y))),y:p},xs=(a,c,p)=>c.x.isZero()?null:{x:p,y:a.y.plus(c.y.div(c.x).times(p.minus(a.x)))},Te=(a,c,p,y)=>{if(c.x.isZero())return xs(p,y,a.x);if(y.x.isZero())return xs(a,c,p.x);if(c.y.isZero())return Gi(p,y,a.y);if(y.y.isZero())return Gi(a,c,p.y);let C=Fo(c,y);if(C.isZero())return null;let k={x:p.x.minus(a.x),y:p.y.minus(a.y)},I=Fo(k,c).div(C),q=Fo(k,y).div(C),oe=a.x.plus(q.times(c.x)),ve=p.x.plus(I.times(y.x)),Ke=a.y.plus(q.times(c.y)),$e=p.y.plus(I.times(y.y)),vt=oe.plus(ve).div(2),Nt=Ke.plus($e).div(2);return{x:vt,y:Nt}},qs=class c4{constructor(c,p){Pt(this,"point");Pt(this,"isLeft");Pt(this,"segment");Pt(this,"otherSE");Pt(this,"consumedBy");c.events===void 0?c.events=[this]:c.events.push(this),this.point=c,this.isLeft=p}static compare(c,p){let y=c4.comparePoints(c.point,p.point);return y!==0?y:(c.point!==p.point&&c.link(p),c.isLeft!==p.isLeft?c.isLeft?1:-1:hs.compare(c.segment,p.segment))}static comparePoints(c,p){return c.x.isLessThan(p.x)?-1:c.x.isGreaterThan(p.x)?1:c.y.isLessThan(p.y)?-1:c.y.isGreaterThan(p.y)?1:0}link(c){if(c.point===this.point)throw new Error("Tried to link already linked events");let p=c.point.events;for(let y=0,C=p.length;y<C;y++){let k=p[y];this.point.events.push(k),k.point=this.point}this.checkForConsuming()}checkForConsuming(){let c=this.point.events.length;for(let p=0;p<c;p++){let y=this.point.events[p];if(y.segment.consumedBy===void 0)for(let C=p+1;C<c;C++){let k=this.point.events[C];k.consumedBy===void 0&&y.otherSE.point.events===k.otherSE.point.events&&y.segment.consume(k.segment)}}}getAvailableLinkedEvents(){let c=[];for(let p=0,y=this.point.events.length;p<y;p++){let C=this.point.events[p];C!==this&&!C.segment.ringOut&&C.segment.isInResult()&&c.push(C)}return c}getLeftmostComparator(c){let p=new Map,y=C=>{let k=C.otherSE;p.set(C,{sine:Mc(this.point,c.point,k.point),cosine:gl(this.point,c.point,k.point)})};return(C,k)=>{p.has(C)||y(C),p.has(k)||y(k);let{sine:I,cosine:q}=p.get(C),{sine:oe,cosine:ve}=p.get(k);return I.isGreaterThanOrEqualTo(0)&&oe.isGreaterThanOrEqualTo(0)?q.isLessThan(ve)?1:q.isGreaterThan(ve)?-1:0:I.isLessThan(0)&&oe.isLessThan(0)?q.isLessThan(ve)?-1:q.isGreaterThan(ve)?1:0:oe.isLessThan(I)?-1:oe.isGreaterThan(I)?1:0}}},Ol=0,hs=class qd{constructor(c,p,y,C){Pt(this,"id");Pt(this,"leftSE");Pt(this,"rightSE");Pt(this,"rings");Pt(this,"windings");Pt(this,"ringOut");Pt(this,"consumedBy");Pt(this,"prev");Pt(this,"_prevInResult");Pt(this,"_beforeState");Pt(this,"_afterState");Pt(this,"_isInResult");this.id=++Ol,this.leftSE=c,c.segment=this,c.otherSE=p,this.rightSE=p,p.segment=this,p.otherSE=c,this.rings=y,this.windings=C}static compare(c,p){let y=c.leftSE.point.x,C=p.leftSE.point.x,k=c.rightSE.point.x,I=p.rightSE.point.x;if(I.isLessThan(y))return 1;if(k.isLessThan(C))return-1;let q=c.leftSE.point.y,oe=p.leftSE.point.y,ve=c.rightSE.point.y,Ke=p.rightSE.point.y;if(y.isLessThan(C)){if(oe.isLessThan(q)&&oe.isLessThan(ve))return 1;if(oe.isGreaterThan(q)&&oe.isGreaterThan(ve))return-1;let $e=c.comparePoint(p.leftSE.point);if($e<0)return 1;if($e>0)return-1;let vt=p.comparePoint(c.rightSE.point);return vt!==0?vt:-1}if(y.isGreaterThan(C)){if(q.isLessThan(oe)&&q.isLessThan(Ke))return-1;if(q.isGreaterThan(oe)&&q.isGreaterThan(Ke))return 1;let $e=p.comparePoint(c.leftSE.point);if($e!==0)return $e;let vt=c.comparePoint(p.rightSE.point);return vt<0?1:vt>0?-1:1}if(q.isLessThan(oe))return-1;if(q.isGreaterThan(oe))return 1;if(k.isLessThan(I)){let $e=p.comparePoint(c.rightSE.point);if($e!==0)return $e}if(k.isGreaterThan(I)){let $e=c.comparePoint(p.rightSE.point);if($e<0)return 1;if($e>0)return-1}if(!k.eq(I)){let $e=ve.minus(q),vt=k.minus(y),Nt=Ke.minus(oe),Wt=I.minus(C);if($e.isGreaterThan(vt)&&Nt.isLessThan(Wt))return 1;if($e.isLessThan(vt)&&Nt.isGreaterThan(Wt))return-1}return k.isGreaterThan(I)?1:k.isLessThan(I)||ve.isLessThan(Ke)?-1:ve.isGreaterThan(Ke)?1:c.id<p.id?-1:c.id>p.id?1:0}static fromRing(c,p,y){let C,k,I,q=qs.comparePoints(c,p);if(q<0)C=c,k=p,I=1;else if(q>0)C=p,k=c,I=-1;else throw new Error(`Tried to create degenerate segment at [${c.x}, ${c.y}]`);let oe=new qs(C,!0),ve=new qs(k,!1);return new qd(oe,ve,[y],[I])}replaceRightSE(c){this.rightSE=c,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){let c=this.leftSE.point.y,p=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:c.isLessThan(p)?c:p},ur:{x:this.rightSE.point.x,y:c.isGreaterThan(p)?c:p}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(c){return c.x.eq(this.leftSE.point.x)&&c.y.eq(this.leftSE.point.y)||c.x.eq(this.rightSE.point.x)&&c.y.eq(this.rightSE.point.y)}comparePoint(c){return wr.orient(this.leftSE.point,c,this.rightSE.point)}getIntersection(c){let p=this.bbox(),y=c.bbox(),C=Tu(p,y);if(C===null)return null;let k=this.leftSE.point,I=this.rightSE.point,q=c.leftSE.point,oe=c.rightSE.point,ve=$s(p,q)&&this.comparePoint(q)===0,Ke=$s(y,k)&&c.comparePoint(k)===0,$e=$s(p,oe)&&this.comparePoint(oe)===0,vt=$s(y,I)&&c.comparePoint(I)===0;if(Ke&&ve)return vt&&!$e?I:!vt&&$e?oe:null;if(Ke)return $e&&k.x.eq(oe.x)&&k.y.eq(oe.y)?null:k;if(ve)return vt&&I.x.eq(q.x)&&I.y.eq(q.y)?null:q;if(vt&&$e)return null;if(vt)return I;if($e)return oe;let Nt=Te(k,this.vector(),q,c.vector());return Nt===null||!$s(C,Nt)?null:wr.snap(Nt)}split(c){let p=[],y=c.events!==void 0,C=new qs(c,!0),k=new qs(c,!1),I=this.rightSE;this.replaceRightSE(k),p.push(k),p.push(C);let q=new qd(C,I,this.rings.slice(),this.windings.slice());return qs.comparePoints(q.leftSE.point,q.rightSE.point)>0&&q.swapEvents(),qs.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),y&&(C.checkForConsuming(),k.checkForConsuming()),p}swapEvents(){let c=this.rightSE;this.rightSE=this.leftSE,this.leftSE=c,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let p=0,y=this.windings.length;p<y;p++)this.windings[p]*=-1}consume(c){let p=this,y=c;for(;p.consumedBy;)p=p.consumedBy;for(;y.consumedBy;)y=y.consumedBy;let C=qd.compare(p,y);if(C!==0){if(C>0){let k=p;p=y,y=k}if(p.prev===y){let k=p;p=y,y=k}for(let k=0,I=y.rings.length;k<I;k++){let q=y.rings[k],oe=y.windings[k],ve=p.rings.indexOf(q);ve===-1?(p.rings.push(q),p.windings.push(oe)):p.windings[ve]+=oe}y.rings=null,y.windings=null,y.consumedBy=p,y.leftSE.consumedBy=p.leftSE,y.rightSE.consumedBy=p.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{let c=this.prev.consumedBy||this.prev;this._beforeState=c.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;let c=this.beforeState();this._afterState={rings:c.rings.slice(0),windings:c.windings.slice(0),multiPolys:[]};let p=this._afterState.rings,y=this._afterState.windings,C=this._afterState.multiPolys;for(let q=0,oe=this.rings.length;q<oe;q++){let ve=this.rings[q],Ke=this.windings[q],$e=p.indexOf(ve);$e===-1?(p.push(ve),y.push(Ke)):y[$e]+=Ke}let k=[],I=[];for(let q=0,oe=p.length;q<oe;q++){if(y[q]===0)continue;let ve=p[q],Ke=ve.poly;if(I.indexOf(Ke)===-1)if(ve.isExterior)k.push(Ke);else{I.indexOf(Ke)===-1&&I.push(Ke);let $e=k.indexOf(ve.poly);$e!==-1&&k.splice($e,1)}}for(let q=0,oe=k.length;q<oe;q++){let ve=k[q].multiPoly;C.indexOf(ve)===-1&&C.push(ve)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;let c=this.beforeState().multiPolys,p=this.afterState().multiPolys;switch(nc.type){case"union":{let y=c.length===0,C=p.length===0;this._isInResult=y!==C;break}case"intersection":{let y,C;c.length<p.length?(y=c.length,C=p.length):(y=p.length,C=c.length),this._isInResult=C===nc.numMultiPolys&&y<C;break}case"xor":{let y=Math.abs(c.length-p.length);this._isInResult=y%2===1;break}case"difference":{let y=C=>C.length===1&&C[0].isSubject;this._isInResult=y(c)!==y(p);break}}return this._isInResult}},_i=class{constructor(a,c,p){Pt(this,"poly");Pt(this,"isExterior");Pt(this,"segments");Pt(this,"bbox");if(!Array.isArray(a)||a.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=c,this.isExterior=p,this.segments=[],typeof a[0][0]!="number"||typeof a[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let y=wr.snap({x:new _e(a[0][0]),y:new _e(a[0][1])});this.bbox={ll:{x:y.x,y:y.y},ur:{x:y.x,y:y.y}};let C=y;for(let k=1,I=a.length;k<I;k++){if(typeof a[k][0]!="number"||typeof a[k][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let q=wr.snap({x:new _e(a[k][0]),y:new _e(a[k][1])});q.x.eq(C.x)&&q.y.eq(C.y)||(this.segments.push(hs.fromRing(C,q,this)),q.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=q.x),q.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=q.y),q.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=q.x),q.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=q.y),C=q)}(!y.x.eq(C.x)||!y.y.eq(C.y))&&this.segments.push(hs.fromRing(C,y,this))}getSweepEvents(){let a=[];for(let c=0,p=this.segments.length;c<p;c++){let y=this.segments[c];a.push(y.leftSE),a.push(y.rightSE)}return a}},ec=class{constructor(a,c){Pt(this,"multiPoly");Pt(this,"exteriorRing");Pt(this,"interiorRings");Pt(this,"bbox");if(!Array.isArray(a))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new _i(a[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let p=1,y=a.length;p<y;p++){let C=new _i(a[p],this,!1);C.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=C.bbox.ll.x),C.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=C.bbox.ll.y),C.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=C.bbox.ur.x),C.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=C.bbox.ur.y),this.interiorRings.push(C)}this.multiPoly=c}getSweepEvents(){let a=this.exteriorRing.getSweepEvents();for(let c=0,p=this.interiorRings.length;c<p;c++){let y=this.interiorRings[c].getSweepEvents();for(let C=0,k=y.length;C<k;C++)a.push(y[C])}return a}},hh=class{constructor(a,c){Pt(this,"isSubject");Pt(this,"polys");Pt(this,"bbox");if(!Array.isArray(a))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof a[0][0][0]=="number"&&(a=[a])}catch{}this.polys=[],this.bbox={ll:{x:new _e(Number.POSITIVE_INFINITY),y:new _e(Number.POSITIVE_INFINITY)},ur:{x:new _e(Number.NEGATIVE_INFINITY),y:new _e(Number.NEGATIVE_INFINITY)}};for(let p=0,y=a.length;p<y;p++){let C=new ec(a[p],this);C.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=C.bbox.ll.x),C.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=C.bbox.ll.y),C.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=C.bbox.ur.x),C.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=C.bbox.ur.y),this.polys.push(C)}this.isSubject=c}getSweepEvents(){let a=[];for(let c=0,p=this.polys.length;c<p;c++){let y=this.polys[c].getSweepEvents();for(let C=0,k=y.length;C<k;C++)a.push(y[C])}return a}},tc=class Mg{constructor(c){Pt(this,"events");Pt(this,"poly");Pt(this,"_isExteriorRing");Pt(this,"_enclosingRing");this.events=c;for(let p=0,y=c.length;p<y;p++)c[p].segment.ringOut=this;this.poly=null}static factory(c){let p=[];for(let y=0,C=c.length;y<C;y++){let k=c[y];if(!k.isInResult()||k.ringOut)continue;let I=null,q=k.leftSE,oe=k.rightSE,ve=[q],Ke=q.point,$e=[];for(;I=q,q=oe,ve.push(q),q.point!==Ke;)for(;;){let vt=q.getAvailableLinkedEvents();if(vt.length===0){let gn=ve[0].point,bn=ve[ve.length-1].point;throw new Error(`Unable to complete output ring starting at [${gn.x}, ${gn.y}]. Last matching segment found ends at [${bn.x}, ${bn.y}].`)}if(vt.length===1){oe=vt[0].otherSE;break}let Nt=null;for(let gn=0,bn=$e.length;gn<bn;gn++)if($e[gn].point===q.point){Nt=gn;break}if(Nt!==null){let gn=$e.splice(Nt)[0],bn=ve.splice(gn.index);bn.unshift(bn[0].otherSE),p.push(new Mg(bn.reverse()));continue}$e.push({index:ve.length,point:q.point});let Wt=q.getLeftmostComparator(I);oe=vt.sort(Wt)[0].otherSE;break}p.push(new Mg(ve))}return p}getGeom(){let c=this.events[0].point,p=[c];for(let ve=1,Ke=this.events.length-1;ve<Ke;ve++){let $e=this.events[ve].point,vt=this.events[ve+1].point;wr.orient($e,c,vt)!==0&&(p.push($e),c=$e)}if(p.length===1)return null;let y=p[0],C=p[1];wr.orient(y,c,C)===0&&p.shift(),p.push(p[0]);let k=this.isExteriorRing()?1:-1,I=this.isExteriorRing()?0:p.length-1,q=this.isExteriorRing()?p.length:-1,oe=[];for(let ve=I;ve!=q;ve+=k)oe.push([p[ve].x.toNumber(),p[ve].y.toNumber()]);return oe}isExteriorRing(){if(this._isExteriorRing===void 0){let c=this.enclosingRing();this._isExteriorRing=c?!c.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var C,k;let c=this.events[0];for(let I=1,q=this.events.length;I<q;I++){let oe=this.events[I];qs.compare(c,oe)>0&&(c=oe)}let p=c.segment.prevInResult(),y=p?p.prevInResult():null;for(;;){if(!p)return null;if(!y)return p.ringOut;if(y.ringOut!==p.ringOut)return((C=y.ringOut)==null?void 0:C.enclosingRing())!==p.ringOut?p.ringOut:(k=p.ringOut)==null?void 0:k.enclosingRing();p=y.prevInResult(),y=p?p.prevInResult():null}}},ga=class{constructor(a){Pt(this,"exteriorRing");Pt(this,"interiorRings");this.exteriorRing=a,a.poly=this,this.interiorRings=[]}addInterior(a){this.interiorRings.push(a),a.poly=this}getGeom(){let a=this.exteriorRing.getGeom();if(a===null)return null;let c=[a];for(let p=0,y=this.interiorRings.length;p<y;p++){let C=this.interiorRings[p].getGeom();C!==null&&c.push(C)}return c}},Bu=class{constructor(a){Pt(this,"rings");Pt(this,"polys");this.rings=a,this.polys=this._composePolys(a)}getGeom(){let a=[];for(let c=0,p=this.polys.length;c<p;c++){let y=this.polys[c].getGeom();y!==null&&a.push(y)}return a}_composePolys(a){var p;let c=[];for(let y=0,C=a.length;y<C;y++){let k=a[y];if(!k.poly)if(k.isExteriorRing())c.push(new ga(k));else{let I=k.enclosingRing();I!=null&&I.poly||c.push(new ga(I)),(p=I==null?void 0:I.poly)==null||p.addInterior(k)}}return c}},kc=class{constructor(a,c=hs.compare){Pt(this,"queue");Pt(this,"tree");Pt(this,"segments");this.queue=a,this.tree=new tn(c),this.segments=[]}process(a){let c=a.segment,p=[];if(a.consumedBy)return a.isLeft?this.queue.delete(a.otherSE):this.tree.delete(c),p;a.isLeft&&this.tree.add(c);let y=c,C=c;do y=this.tree.lastBefore(y);while(y!=null&&y.consumedBy!=null);do C=this.tree.firstAfter(C);while(C!=null&&C.consumedBy!=null);if(a.isLeft){let k=null;if(y){let q=y.getIntersection(c);if(q!==null&&(c.isAnEndpoint(q)||(k=q),!y.isAnEndpoint(q))){let oe=this._splitSafely(y,q);for(let ve=0,Ke=oe.length;ve<Ke;ve++)p.push(oe[ve])}}let I=null;if(C){let q=C.getIntersection(c);if(q!==null&&(c.isAnEndpoint(q)||(I=q),!C.isAnEndpoint(q))){let oe=this._splitSafely(C,q);for(let ve=0,Ke=oe.length;ve<Ke;ve++)p.push(oe[ve])}}if(k!==null||I!==null){let q=null;k===null?q=I:I===null?q=k:q=qs.comparePoints(k,I)<=0?k:I,this.queue.delete(c.rightSE),p.push(c.rightSE);let oe=c.split(q);for(let ve=0,Ke=oe.length;ve<Ke;ve++)p.push(oe[ve])}p.length>0?(this.tree.delete(c),p.push(a)):(this.segments.push(c),c.prev=y)}else{if(y&&C){let k=y.getIntersection(C);if(k!==null){if(!y.isAnEndpoint(k)){let I=this._splitSafely(y,k);for(let q=0,oe=I.length;q<oe;q++)p.push(I[q])}if(!C.isAnEndpoint(k)){let I=this._splitSafely(C,k);for(let q=0,oe=I.length;q<oe;q++)p.push(I[q])}}}this.tree.delete(c)}return p}_splitSafely(a,c){this.tree.delete(a);let p=a.rightSE;this.queue.delete(p);let y=a.split(c);return y.push(p),a.consumedBy===void 0&&this.tree.add(a),y}},Qh=class{constructor(){Pt(this,"type");Pt(this,"numMultiPolys")}run(a,c,p){au.type=a;let y=[new hh(c,!0)];for(let oe=0,ve=p.length;oe<ve;oe++)y.push(new hh(p[oe],!1));if(au.numMultiPolys=y.length,au.type==="difference"){let oe=y[0],ve=1;for(;ve<y.length;)Tu(y[ve].bbox,oe.bbox)!==null?ve++:y.splice(ve,1)}if(au.type==="intersection")for(let oe=0,ve=y.length;oe<ve;oe++){let Ke=y[oe];for(let $e=oe+1,vt=y.length;$e<vt;$e++)if(Tu(Ke.bbox,y[$e].bbox)===null)return[]}let C=new tn(qs.compare);for(let oe=0,ve=y.length;oe<ve;oe++){let Ke=y[oe].getSweepEvents();for(let $e=0,vt=Ke.length;$e<vt;$e++)C.add(Ke[$e])}let k=new kc(C),I=null;for(C.size!=0&&(I=C.first(),C.delete(I));I;){let oe=k.process(I);for(let ve=0,Ke=oe.length;ve<Ke;ve++){let $e=oe[ve];$e.consumedBy===void 0&&C.add($e)}C.size!=0?(I=C.first(),C.delete(I)):I=null}wr.reset();let q=tc.factory(k.segments);return new Bu(q).getGeom()}},au=new Qh,nc=au,tl=(a,...c)=>nc.run("intersection",a,c),ef=(a,...c)=>nc.run("difference",a,c);wr.set;function ic(a){let c={type:"Feature"};return c.geometry=a,c}function rc(a){return a.type==="Feature"?a.geometry:a}function fh(a){return a&&a.geometry&&a.geometry.coordinates?a.geometry.coordinates:a}function dh(a){return ic({type:"LineString",coordinates:a})}function Qo(a){return ic({type:"MultiLineString",coordinates:a})}function ph(a){return ic({type:"Polygon",coordinates:a})}function gh(a){return ic({type:"MultiPolygon",coordinates:a})}function mh(a,c){let p=rc(a),y=rc(c),C=tl(p.coordinates,y.coordinates);return C.length===0?null:C.length===1?ph(C[0]):gh(C)}function m(a,c){let p=rc(a),y=rc(c),C=ef(p.coordinates,y.coordinates);return C.length===0?null:C.length===1?ph(C[0]):gh(C)}function S(a){return Array.isArray(a)?1+S(a[0]):-1}function N(a){a instanceof L.Polyline&&(a=a.toGeoJSON(15));let c=fh(a),p=S(c),y=[];return p>1?c.forEach(C=>{y.push(dh(C))}):y.push(a),y}function K(a){let c=[];return a.eachLayer(p=>{c.push(fh(p.toGeoJSON(15)))}),Qo(c)}Dr.Cut=Dr.Polygon.extend({initialize(a){this._map=a,this._shape="Cut",this.toolbarButtonName="cutPolygon"},_finishShape(){if(this._editedLayers=[],!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let a=this._layer.getLatLngs();if(a.length<=2)return;let c=L.polygon(a,this.options.pathOptions);c._latlngInfos=this._layer._latlngInfo,this.cut(c),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex,this._editedLayers.forEach(({layer:y,originalLayer:C})=>{this._fireCut(C,y,C),this._fireCut(this._map,y,C),C.pm._fireEdit()}),this._editedLayers=[];let p=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(p))},cut(a){let c=this._map._layers,p=a._latlngInfos||[];Object.keys(c).map(y=>c[y]).filter(y=>y.pm).filter(y=>!y._pmTempLayer).filter(y=>!L.PM.optIn&&!y.options.pmIgnore||L.PM.optIn&&y.options.pmIgnore===!1).filter(y=>y instanceof L.Polyline).filter(y=>y!==a).filter(y=>y.pm.options.allowCutting).filter(y=>this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0?this.options.layersToCut.indexOf(y)>-1:!0).filter(y=>!this._layerGroup.hasLayer(y)).filter(y=>{try{let C=!!zs(a.toGeoJSON(15),y.toGeoJSON(15)).features.length>0;return C||y instanceof L.Polyline&&!(y instanceof L.Polygon)?C:!!mh(a.toGeoJSON(15),y.toGeoJSON(15))}catch{return y instanceof L.Polygon&&console.error("You can't cut polygons with self-intersections"),!1}}).forEach(y=>{let C;if(y instanceof L.Polygon){C=L.polygon(y.getLatLngs());let oe=C.getLatLngs();p.forEach(ve=>{if(ve&&ve.snapInfo){let{latlng:Ke}=ve,$e=this._calcClosestLayer(Ke,[C]);if($e&&$e.segment&&$e.distance<this.options.snapDistance){let{segment:vt}=$e;if(vt&&vt.length===2){let{indexPath:Nt,parentPath:Wt,newIndex:gn}=L.PM.Utils._getIndexFromSegment(oe,vt);(Nt.length>1?(0,lr.default)(oe,Wt):oe).splice(gn,0,Ke)}}}})}else C=y;let k=this._cutLayer(a,C),I=L.geoJSON(k,y.options);I.getLayers().length===1&&([I]=I.getLayers()),this._setPane(I,"layerPane");let q=I.addTo(this._map.pm._getContainingLayer());if(q.pm.enable(y.pm.options),q.pm.disable(),y._pmTempLayer=!0,a._pmTempLayer=!0,y.remove(),y.removeFrom(this._map.pm._getContainingLayer()),a.remove(),a.removeFrom(this._map.pm._getContainingLayer()),q.getLayers&&q.getLayers().length===0&&this._map.pm.removeLayer({target:q}),q instanceof L.LayerGroup?(q.eachLayer(oe=>{this._addDrawnLayerProp(oe)}),this._addDrawnLayerProp(q)):this._addDrawnLayerProp(q),this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0){let oe=this.options.layersToCut.indexOf(y);oe>-1&&this.options.layersToCut.splice(oe,1)}this._editedLayers.push({layer:q,originalLayer:y})})},_cutLayer(a,c){let p=L.geoJSON(),y;if(c instanceof L.Polygon)y=m(c.toGeoJSON(15),a.toGeoJSON(15));else{let C=N(c);C.forEach(k=>{let I=In(k,a.toGeoJSON(15)),q;I&&I.features.length>0?q=L.geoJSON(I):q=L.geoJSON(k),q.getLayers().forEach(oe=>{No(a.toGeoJSON(15),oe.toGeoJSON(15))||oe.addTo(p)})}),C.length>1?y=K(p):y=p.toGeoJSON(15)}return y},_change:L.Util.falseFn}),Dr.Text=Dr.extend({initialize(a){this._map=a,this._shape="Text",this.toolbarButtonName="drawText"},enable(a){L.Util.setOptions(this,a),this._enabled=!0,this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(Gn("tooltips.placeText"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this._map.getContainer().classList.add("geoman-draw-cursor"),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){var a;this._enabled&&(this._enabled=!1,this._map.off("click",this._createMarker,this),(a=this._hintMarker)==null||a.remove(),this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("mousemove",this._syncHintMarker,this),this._map.off("mousemove",this._showHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(a){this.enabled()?this.disable():this.enable(a)},_syncHintMarker(a){if(this._hintMarker.setLatLng(a.latlng),this.options.snappable){let c=a;c.target=this._hintMarker,this._handleSnapping(c)}},_createMarker(a){var C,k,I,q;if(!a.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(a.latlng);let c=this._hintMarker.getLatLng();if(this.textArea=this._createTextArea(),(C=this.options.textOptions)==null?void 0:C.className){let oe=this.options.textOptions.className.split(" ");this.textArea.classList.add(...oe)}let p=this._createTextIcon(this.textArea),y=new L.Marker(c,{textMarker:!0,_textMarkerOverPM:!0,icon:p});if(this._setPane(y,"markerPane"),this._finishLayer(y),y.pm||(y.options.draggable=!1),y.addTo(this._map.pm._getContainingLayer()),y.pm){y.pm.textArea=this.textArea,L.setOptions(y.pm,{removeIfEmpty:((k=this.options.textOptions)==null?void 0:k.removeIfEmpty)??!0});let oe=((I=this.options.textOptions)==null?void 0:I.focusAfterDraw)??!0;y.pm._createTextMarker(oe),(q=this.options.textOptions)!=null&&q.text&&y.pm.setText(this.options.textOptions.text)}this._fireCreate(y),this._cleanupSnapping(),this.disable(),this.options.continueDrawing&&this._map.once("mousemove",this._showHintMarkerAfterMoving,this)},_showHintMarkerAfterMoving(a){this.enable(),this._hintMarker.setLatLng(a.latlng)},_createTextArea(){let a=document.createElement("textarea");return a.readOnly=!0,a.classList.add("pm-textarea","pm-disabled"),a},_createTextIcon(a){return L.divIcon({className:"pm-text-marker",html:a})}});var pe={enableLayerDrag(){if(!this.options.draggable||!this._layer._map)return;this.disable(),this._layerDragEnabled=!0,this._map||(this._map=this._layer._map),(this._layer instanceof L.Marker||this._layer instanceof L.ImageOverlay)&&L.DomEvent.on(this._getDOMElem(),"dragstart",this._stopDOMImageDrag),this._layer.dragging&&this._layer.dragging.disable(),this._tempDragCoord=null,Zi(this._layer)instanceof L.Canvas?(this._layer.on("mouseout",this.removeDraggingClass,this),this._layer.on("mouseover",this.addDraggingClass,this)):this.addDraggingClass(),this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!0;let a=this._getDOMElem();a&&(Zi(this._layer)instanceof L.Canvas?(this._layer.on("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._addTouchEvents(a)):L.DomEvent.on(a,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._fireDragEnable()},disableLayerDrag(){this._layerDragEnabled=!1,Zi(this._layer)instanceof L.Canvas?(this._layer.off("mouseout",this.removeDraggingClass,this),this._layer.off("mouseover",this.addDraggingClass,this)):this.removeDraggingClass(),this._originalMapDragState&&this._dragging&&this._map.dragging.enable(),this._safeToCacheDragState=!1,this._layer.dragging&&this._layer.dragging.disable();let a=this._getDOMElem();a&&(Zi(this._layer)instanceof L.Canvas?(this._layer.off("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._removeTouchEvents(a)):L.DomEvent.off(a,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._layerDragged&&this._fireUpdate(),this._layerDragged=!1,this._fireDragDisable()},dragging(){return this._dragging},layerDragEnabled(){return!!this._layerDragEnabled},_simulateMouseDownEvent(a){let c=a.touches?a.touches[0]:a,p={originalEvent:c,target:this._layer};return p.containerPoint=this._map.mouseEventToContainerPoint(c),p.latlng=this._map.containerPointToLatLng(p.containerPoint),this._dragMixinOnMouseDown(p),!1},_simulateMouseMoveEvent(a){let c=a.touches?a.touches[0]:a,p={originalEvent:c,target:this._layer};return p.containerPoint=this._map.mouseEventToContainerPoint(c),p.latlng=this._map.containerPointToLatLng(p.containerPoint),this._dragMixinOnMouseMove(p),!1},_simulateMouseUpEvent(a){let c={originalEvent:a.touches?a.touches[0]:a,target:this._layer};return a.type.indexOf("touch")===-1&&(c.containerPoint=this._map.mouseEventToContainerPoint(a),c.latlng=this._map.containerPointToLatLng(c.containerPoint)),this._dragMixinOnMouseUp(c),!1},_dragMixinOnMouseDown(a){if(a.originalEvent.button>0)return;this._overwriteEventIfItComesFromMarker(a);let c=a._fromLayerSync,p=this._syncLayers("_dragMixinOnMouseDown",a);if(this._layer instanceof L.Marker&&(this.options.snappable&&!c&&!p?this._initSnappableMarkers():this._disableSnapping()),this._layer instanceof L.CircleMarker){let y="resizeableCircleMarker";this._layer instanceof L.Circle&&(y="resizeableCircle"),this.options.snappable&&!c&&!p?this._layer.pm.options[y]||this._initSnappableMarkersDrag():this._layer.pm.options[y]?this._layer.pm._disableSnapping():this._layer.pm._disableSnappingDrag()}this._safeToCacheDragState&&(this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!1),this._tempDragCoord=a.latlng,L.DomEvent.on(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),L.DomEvent.on(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this)},_dragMixinOnMouseMove(a){this._overwriteEventIfItComesFromMarker(a);let c=this._getDOMElem();this._syncLayers("_dragMixinOnMouseMove",a),this._dragging||(this._dragging=!0,L.DomUtil.addClass(c,"leaflet-pm-dragging"),this._layer instanceof L.Marker||this._layer.bringToFront(),this._originalMapDragState&&this._map.dragging.disable(),this._fireDragStart()),this._tempDragCoord||(this._tempDragCoord=a.latlng),this._onLayerDrag(a),this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle()},_dragMixinOnMouseUp(a){let c=this._getDOMElem();return this._syncLayers("_dragMixinOnMouseUp",a),this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0,L.DomEvent.off(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this),L.DomEvent.off(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),this._dragging?(this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle(),this._layerDragged=!0,window.setTimeout(()=>{this._dragging=!1,c&&L.DomUtil.removeClass(c,"leaflet-pm-dragging"),this._fireDragEnd(),this._fireEdit(),this._layerEdited=!0},10),!0):!1},_onLayerDrag(a){let{latlng:c}=a,p={lat:c.lat-this._tempDragCoord.lat,lng:c.lng-this._tempDragCoord.lng},y=C=>C.map(k=>{if(Array.isArray(k))return y(k);let I={lat:k.lat+p.lat,lng:k.lng+p.lng};return(k.alt||k.alt===0)&&(I.alt=k.alt),I});if(this._layer instanceof L.Circle&&this._layer.options.resizeableCircle||this._layer instanceof L.CircleMarker&&this._layer.options.resizeableCircleMarker){let C=y([this._layer.getLatLng()]);this._layer.setLatLng(C[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.CircleMarker||this._layer instanceof L.Marker){let C=this._layer.getLatLng();this._layer._snapped&&(C=this._layer._orgLatLng);let k=y([C]);this._layer.setLatLng(k[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.ImageOverlay){let C=y([this._layer.getBounds().getNorthWest(),this._layer.getBounds().getSouthEast()]);this._layer.setBounds(C),this._fireChange(this._layer.getBounds(),"Edit")}else{let C=y(this._layer.getLatLngs());this._layer.setLatLngs(C),this._fireChange(this._layer.getLatLngs(),"Edit")}this._tempDragCoord=c,a.layer=this._layer,this._fireDrag(a)},addDraggingClass(){let a=this._getDOMElem();a&&L.DomUtil.addClass(a,"leaflet-pm-draggable")},removeDraggingClass(){let a=this._getDOMElem();a&&L.DomUtil.removeClass(a,"leaflet-pm-draggable")},_getDOMElem(){let a=null;return this._layer._path?a=this._layer._path:this._layer._renderer&&this._layer._renderer._container?a=this._layer._renderer._container:this._layer._image?a=this._layer._image:this._layer._icon&&(a=this._layer._icon),a},_overwriteEventIfItComesFromMarker(a){a.target.getLatLng&&(!a.target._radius||a.target._radius<=10)&&(a.containerPoint=this._map.mouseEventToContainerPoint(a.originalEvent),a.latlng=this._map.containerPointToLatLng(a.containerPoint))},_syncLayers(a,c){if(this.enabled())return!1;if(!c._fromLayerSync&&this._layer===c.target&&this.options.syncLayersOnDrag){c._fromLayerSync=!0;let p=[];if(L.Util.isArray(this.options.syncLayersOnDrag))p=this.options.syncLayersOnDrag,this.options.syncLayersOnDrag.forEach(y=>{y instanceof L.LayerGroup&&(p=p.concat(y.pm.getLayers(!0)))});else if(this.options.syncLayersOnDrag===!0&&this._parentLayerGroup)for(let y in this._parentLayerGroup){let C=this._parentLayerGroup[y];C.pm&&(p=C.pm.getLayers(!0))}return L.Util.isArray(p)&&p.length>0&&(p=p.filter(y=>!!y.pm).filter(y=>!!y.pm.options.draggable),p.forEach(y=>{y!==this._layer&&y.pm[a]&&(y._snapped=!1,y.pm[a](c))})),p.length>0}return!1},_stopDOMImageDrag(a){return a.preventDefault(),!1}},be=pe,Le=g(ii());function ke(a,c,p,y){return p.unproject(c.transform(p.project(a,y)),y)}function Be(a,c,p){let y=p.getMaxZoom();if(y===1/0&&(y=p.getZoom()),L.Util.isArray(a)){let C=[];return a.forEach(k=>{C.push(Be(k,c,p))}),C}return a instanceof L.LatLng?ke(a,c,p,y):null}function Ge(a,c){c instanceof L.Layer&&(c=c.getLatLng());let p=a.getMaxZoom();return p===1/0&&(p=a.getZoom()),a.project(c,p)}function ft(a,c){let p=a.getMaxZoom();return p===1/0&&(p=a.getZoom()),a.unproject(c,p)}var Dt={_onRotateStart(a){this._preventRenderingMarkers(!0),this._rotationOriginLatLng=this._getRotationCenter().clone(),this._rotationOriginPoint=Ge(this._map,this._rotationOriginLatLng),this._rotationStartPoint=Ge(this._map,a.target.getLatLng()),this._initialRotateLatLng=ao(this._layer),this._startAngle=this.getAngle();let c=ao(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._fireRotationStart(this._rotationLayer,c),this._fireRotationStart(this._map,c)},_onRotate(a){let c=Ge(this._map,a.target.getLatLng()),p=this._rotationStartPoint,y=this._rotationOriginPoint,C=Math.atan2(c.y-y.y,c.x-y.x)-Math.atan2(p.y-y.y,p.x-y.x);this._layer.setLatLngs(this._rotateLayer(C,this._initialRotateLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let k=this;function I(Ke,$e=[],vt=-1){if(vt>-1&&$e.push(vt),L.Util.isArray(Ke[0]))Ke.forEach((Nt,Wt)=>I(Nt,$e.slice(),Wt));else{let Nt=$e.length>0?(0,Le.default)(k._markers,$e):k._markers[0];Ke.forEach((Wt,gn)=>{Nt[gn].setLatLng(Wt)})}}I(this._layer.getLatLngs());let q=ao(this._rotationLayer);this._rotationLayer.setLatLngs(this._rotateLayer(C,this._rotationLayer.pm._rotateOrgLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let oe=C*180/Math.PI;oe=oe<0?oe+360:oe;let ve=oe+this._startAngle;this._setAngle(ve),this._rotationLayer.pm._setAngle(ve),this._fireRotation(this._rotationLayer,oe,q),this._fireRotation(this._map,oe,q),this._rotationLayer.pm._fireChange(this._rotationLayer.getLatLngs(),"Rotation")},_onRotateEnd(){let a=this._startAngle;delete this._rotationOriginLatLng,delete this._rotationOriginPoint,delete this._rotationStartPoint,delete this._initialRotateLatLng,delete this._startAngle;let c=ao(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._rotationLayer.pm._rotateOrgLatLng=ao(this._rotationLayer),this._fireRotationEnd(this._rotationLayer,a,c),this._fireRotationEnd(this._map,a,c),this._rotationLayer.pm._fireEdit(this._rotationLayer,"Rotation"),this._preventRenderingMarkers(!1),this._layerRotated=!0},_rotateLayer(a,c,p,y,C){let k=Ge(C,p);return this._matrix=y.clone().rotate(a,k).flip(),Be(c,this._matrix,C)},_setAngle(a){a=a<0?a+360:a,this._angle=a%360},_getRotationCenter(){if(this._rotationCenter)return this._rotationCenter;let a=L.polygon(this._layer.getLatLngs(),{stroke:!1,fill:!1,pmIgnore:!0}).addTo(this._layer._map),c=a.getCenter();return a.removeFrom(this._layer._map),c},enableRotate(){if(!this.options.allowRotation){this.disableRotate();return}this.rotateEnabled()&&this.disableRotate(),this._layer instanceof L.Rectangle&&this._angle===void 0&&this.setInitAngle(Mo(this._layer._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);let a={fill:!1,stroke:!1,pmIgnore:!1,snapIgnore:!0};this._rotatePoly=L.polygon(this._layer.getLatLngs(),a),this._rotatePoly._pmTempLayer=!0,this._rotatePoly.addTo(this._layer._map),this._rotatePoly.pm._setAngle(this.getAngle()),this._rotatePoly.pm.setRotationCenter(this.getRotationCenter()),this._rotatePoly.pm.setOptions(this._layer._map.pm.getGlobalOptions()),this._rotatePoly.pm.setOptions({rotate:!0,snappable:!1,hideMiddleMarkers:!0}),this._rotatePoly.pm._rotationLayer=this._layer,this._rotatePoly.pm.enable(),this._rotateOrgLatLng=ao(this._layer),this._rotateEnabled=!0,this._layer.on("remove",this.disableRotate,this),this._fireRotationEnable(this._layer),this._fireRotationEnable(this._layer._map)},disableRotate(){this.rotateEnabled()&&(this._rotatePoly.pm._layerRotated&&this._fireUpdate(),this._rotatePoly.pm._layerRotated=!1,this._rotatePoly.pm.disable(),this._rotatePoly.remove(),this._rotatePoly.pm.setOptions({rotate:!1}),this._rotatePoly=void 0,this._rotateOrgLatLng=void 0,this._layer.off("remove",this.disableRotate,this),this._rotateEnabled=!1,this._fireRotationDisable(this._layer),this._fireRotationDisable(this._layer._map))},rotateEnabled(){return!!this._rotateEnabled},rotateLayer(a){let c=this.getAngle(),p=this._layer.getLatLngs(),y=a*(Math.PI/180);this._layer.setLatLngs(this._rotateLayer(y,this._layer.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._layer._map)),this._rotateOrgLatLng=L.polygon(this._layer.getLatLngs()).getLatLngs(),this._setAngle(this.getAngle()+a),this.rotateEnabled()&&this._rotatePoly&&this._rotatePoly.pm.enabled()&&(this._rotatePoly.setLatLngs(this._rotateLayer(y,this._rotatePoly.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._rotatePoly._map)),this._rotatePoly.pm._initMarkers());let C=this.getAngle()-c;C=C<0?C+360:C,this._startAngle=c,this._fireRotation(this._layer,C,p,this._layer),this._fireRotation(this._map||this._layer._map,C,p,this._layer),delete this._startAngle,this._fireChange(this._layer.getLatLngs(),"Rotation")},rotateLayerToAngle(a){let c=a-this.getAngle();this.rotateLayer(c)},getAngle(){return this._angle||0},setInitAngle(a){this._setAngle(a)},getRotationCenter(){return this._getRotationCenter()},setRotationCenter(a){this._rotationCenter=a,this._rotatePoly&&this._rotatePoly.pm.setRotationCenter(a)}},Ot=Dt,Lt=L.Class.extend({includes:[be,Qs,Ot,Ka],options:{snappable:!0,snapDistance:20,allowSelfIntersection:!0,allowSelfIntersectionEdit:!1,preventMarkerRemoval:!1,removeLayerBelowMinVertexCount:!0,limitMarkersToCount:-1,hideMiddleMarkers:!1,snapSegment:!0,syncLayersOnDrag:!1,draggable:!0,allowEditing:!0,allowRemoval:!0,allowCutting:!0,allowRotation:!0,addVertexOn:"click",removeVertexOn:"contextmenu",removeVertexValidation:void 0,addVertexValidation:void 0,moveVertexValidation:void 0,resizeableCircleMarker:!1,resizeableCircle:!0,snapMiddle:!1,snapVertex:!0},setOptions(a){L.Util.setOptions(this,a)},getOptions(){return this.options},applyOptions(){},isPolygon(){return this._layer instanceof L.Polygon},getShape(){return this._shape},_setPane(a,c){c==="layerPane"?a.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":c==="vertexPane"?a.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":c==="markerPane"&&(a.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},remove(){(this._map||this._layer._map).pm.removeLayer({target:this._layer})},_vertexValidation(a,c){let p=c.target,y={layer:this._layer,marker:p,event:c},C="";return a==="move"?C="moveVertexValidation":a==="add"?C="addVertexValidation":a==="remove"&&(C="removeVertexValidation"),this.options[C]&&typeof this.options[C]=="function"&&!this.options[C](y)?(a==="move"&&(p._cancelDragEventChain=p.getLatLng()),!1):(p._cancelDragEventChain=null,!0)},_vertexValidationDrag(a){return a._cancelDragEventChain?(a._latlng=a._cancelDragEventChain,a.update(),!1):!0},_vertexValidationDragEnd(a){return a._cancelDragEventChain?(a._cancelDragEventChain=null,!1):!0}}),Vt=Lt;Vt.LayerGroup=L.Class.extend({initialize(a){this._layerGroup=a,this._layers=this.getLayers(),this._getMap(),this._layers.forEach(y=>this._initLayer(y));let c=y=>{if(y.layer._pmTempLayer)return;this._layers=this.getLayers();let C=this._layers.filter(k=>!k.pm._parentLayerGroup||!(this._layerGroup._leaflet_id in k.pm._parentLayerGroup));C.forEach(k=>{this._initLayer(k)}),C.length>0&&this._getMap()&&this._getMap().pm.globalEditModeEnabled()&&this.enabled()&&this.enable(this.getOptions())};this._layerGroup.on("layeradd",L.Util.throttle(c,100,this),this),this._layerGroup.on("layerremove",y=>{this._removeLayerFromGroup(y.target)},this);let p=y=>{y.target._pmTempLayer||(this._layers=this.getLayers())};this._layerGroup.on("layerremove",L.Util.throttle(p,100,this),this)},enable(a,c=[]){c.length===0&&(this._layers=this.getLayers()),this._options=a,this._layers.forEach(p=>{p instanceof L.LayerGroup?c.indexOf(p._leaflet_id)===-1&&(c.push(p._leaflet_id),p.pm.enable(a,c)):p.pm.enable(a)})},disable(a=[]){a.length===0&&(this._layers=this.getLayers()),this._layers.forEach(c=>{c instanceof L.LayerGroup?a.indexOf(c._leaflet_id)===-1&&(a.push(c._leaflet_id),c.pm.disable(a)):c.pm.disable()})},enabled(a=[]){return a.length===0&&(this._layers=this.getLayers()),!!this._layers.find(c=>c instanceof L.LayerGroup?a.indexOf(c._leaflet_id)===-1?(a.push(c._leaflet_id),c.pm.enabled(a)):!1:c.pm.enabled())},toggleEdit(a,c=[]){c.length===0&&(this._layers=this.getLayers()),this._options=a,this._layers.forEach(p=>{p instanceof L.LayerGroup?c.indexOf(p._leaflet_id)===-1&&(c.push(p._leaflet_id),p.pm.toggleEdit(a,c)):p.pm.toggleEdit(a)})},_initLayer(a){let c=L.Util.stamp(this._layerGroup);a.pm._parentLayerGroup||(a.pm._parentLayerGroup={}),a.pm._parentLayerGroup[c]=this._layerGroup},_removeLayerFromGroup(a){if(a.pm&&a.pm._layerGroup){let c=L.Util.stamp(this._layerGroup);delete a.pm._layerGroup[c]}},dragging(){return this._layers=this.getLayers(),this._layers?!!this._layers.find(a=>a.pm.dragging()):!1},getOptions(){return this.options},_getMap(){var a;return this._map||((a=this._layers.find(c=>!!c._map))==null?void 0:a._map)||null},getLayers(a=!1,c=!0,p=!0,y=[]){let C=[];return a?this._layerGroup.getLayers().forEach(k=>{C.push(k),k instanceof L.LayerGroup&&y.indexOf(k._leaflet_id)===-1&&(y.push(k._leaflet_id),C=C.concat(k.pm.getLayers(!0,!0,!0,y)))}):C=this._layerGroup.getLayers(),p&&(C=C.filter(k=>!(k instanceof L.LayerGroup))),c&&(C=C.filter(k=>!!k.pm),C=C.filter(k=>!k._pmTempLayer),C=C.filter(k=>!L.PM.optIn&&!k.options.pmIgnore||L.PM.optIn&&k.options.pmIgnore===!1)),C},setOptions(a,c=[]){c.length===0&&(this._layers=this.getLayers()),this.options=a,this._layers.forEach(p=>{p.pm&&(p instanceof L.LayerGroup?c.indexOf(p._leaflet_id)===-1&&(c.push(p._leaflet_id),p.pm.setOptions(a,c)):p.pm.setOptions(a))})}}),Vt.Marker=Vt.extend({_shape:"Marker",initialize(a){this._layer=a,this._enabled=!1,this._layer.on("dragend",this._onDragEnd,this)},enable(a={draggable:!0}){if(L.Util.setOptions(this,a),!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._fireEnable()},disable(){this.enabled()&&(this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this._layer.off("contextmenu",this._removeMarker,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1)},enabled(){return this._enabled},toggleEdit(a){this.enabled()?this.disable():this.enable(a)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this.options.draggable?this.enableLayerDrag():this.disableLayerDrag(),this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_removeMarker(a){let c=a.target;c.remove(),this._fireRemove(c),this._fireRemove(this._map,c)},_onDragEnd(){this._fireEdit(),this._layerEdited=!0},_initSnappableMarkers(){let a=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,a.off("pm:drag",this._handleSnapping,this),a.on("pm:drag",this._handleSnapping,this),a.off("pm:dragend",this._cleanupSnapping,this),a.on("pm:dragend",this._cleanupSnapping,this),a.off("pm:dragstart",this._unsnap,this),a.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let a=this._layer;a.off("pm:drag",this._handleSnapping,this),a.off("pm:dragend",this._cleanupSnapping,this),a.off("pm:dragstart",this._unsnap,this)}});var jt=g(ii()),dt={filterMarkerGroup(){this.markerCache=[],this.createCache(),this._layer.on("pm:edit",this.createCache,this),this.applyLimitFilters({}),this.throttledApplyLimitFilters||(this.throttledApplyLimitFilters=L.Util.throttle(this.applyLimitFilters,100,this)),this._layer.on("pm:disable",this._removeMarkerLimitEvents,this),this._layer.on("remove",this._removeMarkerLimitEvents,this),this.options.limitMarkersToCount>-1&&(this._layer.on("pm:vertexremoved",this._initMarkers,this),this._map.on("mousemove",this.throttledApplyLimitFilters,this))},_removeMarkerLimitEvents(){this._map.off("mousemove",this.throttledApplyLimitFilters,this),this._layer.off("pm:edit",this.createCache,this),this._layer.off("pm:disable",this._removeMarkerLimitEvents,this),this._layer.off("pm:vertexremoved",this._initMarkers,this)},createCache(){let a=[...this._markerGroup.getLayers(),...this.markerCache];this.markerCache=a.filter((c,p,y)=>y.indexOf(c)===p)},_removeFromCache(a){let c=this.markerCache.indexOf(a);c>-1&&this.markerCache.splice(c,1)},renderLimits(a){this.markerCache.forEach(c=>{a.includes(c)?this._markerGroup.addLayer(c):this._markerGroup.removeLayer(c)})},applyLimitFilters({latlng:a={lat:0,lng:0}}){if(this._preventRenderMarkers)return;let c=[...this._filterClosestMarkers(a)];this.renderLimits(c)},_filterClosestMarkers(a){let c=[...this.markerCache],p=this.options.limitMarkersToCount;return p===-1?c:(c.sort((y,C)=>{let k=y._latlng.distanceTo(a),I=C._latlng.distanceTo(a);return k-I}),c.filter((y,C)=>p>-1?C<p:!0))},_preventRenderMarkers:!1,_preventRenderingMarkers(a){this._preventRenderMarkers=!!a}},yt=dt;Vt.Line=Vt.extend({includes:[yt],_shape:"Line",initialize(a){this._layer=a,this._enabled=!1},enable(a){if(L.Util.setOptions(this,a),this._map=this._layer._map,!!this._map){if(!this.options.allowEditing){this.disable();return}this.enabled()&&this.disable(),this._enabled=!0,this._initMarkers(),this.applyOptions(),this._layer.on("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.on("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this),this.options.allowSelfIntersection?this.cachedColor=void 0:(this._layer.options.color!=="#f00000ff"?(this.cachedColor=this._layer.options.color,this.isRed=!1):this.isRed=!0,this._handleLayerStyle()),this._fireEnable()}},disable(){if(!this.enabled()||this._dragging)return;this._enabled=!1,this._markerGroup.clearLayers(),this._markerGroup.removeFrom(this._map),this._layer.off("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.off("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this);let a=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(a,"leaflet-pm-draggable"),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()},enabled(){return this._enabled},toggleEdit(a){return this.enabled()?this.disable():this.enable(a),this.enabled()},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initMarkers(){let a=this._map,c=this._layer.getLatLngs();this._markerGroup&&(this._markerGroup.removeFrom(a),this._markerGroup.clearLayers()),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0;let p=y=>{if(Array.isArray(y[0]))return y.map(p,this);let C=y.map(this._createMarker,this);return this.options.hideMiddleMarkers!==!0&&y.map((k,I)=>{let q=this.isPolygon()?(I+1)%y.length:I+1;return this._createMiddleMarker(C[I],C[q])}),C};this._markers=p(c),this.filterMarkerGroup(),a.addLayer(this._markerGroup)},_createMarker(a){let c=new L.Marker(a,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(c,"vertexPane"),c._pmTempLayer=!0,this.options.rotate?(c.on("dragstart",this._onRotateStart,this),c.on("drag",this._onRotate,this),c.on("dragend",this._onRotateEnd,this)):(c.on("click",this._onVertexClick,this),c.on("dragstart",this._onMarkerDragStart,this),c.on("move",this._onMarkerDrag,this),c.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||c.on(this.options.removeVertexOn,this._removeMarker,this)),this._markerGroup.addLayer(c),c},_createMiddleMarker(a,c){if(!a||!c)return!1;let p=L.PM.Utils.calcMiddleLatLng(this._map,a.getLatLng(),c.getLatLng()),y=this._createMarker(p),C=L.divIcon({className:"marker-icon marker-icon-middle"});return y.setIcon(C),y.leftM=a,y.rightM=c,a._middleMarkerNext=y,c._middleMarkerPrev=y,y.on(this.options.addVertexOn,this._onMiddleMarkerClick,this),y.on("movestart",this._onMiddleMarkerMoveStart,this),y},_onMiddleMarkerClick(a){let c=a.target;if(!this._vertexValidation("add",a))return;let p=L.divIcon({className:"marker-icon"});c.setIcon(p),this._addMarker(c,c.leftM,c.rightM)},_onMiddleMarkerMoveStart(a){let c=a.target;if(c.on("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidation("add",a)){c.on("move",this._onMiddleMarkerMovePrevent,this);return}c._dragging=!0,this._addMarker(c,c.leftM,c.rightM)},_onMiddleMarkerMovePrevent(a){let c=a.target;this._vertexValidationDrag(c)},_onMiddleMarkerMoveEnd(a){let c=a.target;if(c.off("move",this._onMiddleMarkerMovePrevent,this),c.off("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidationDragEnd(c))return;let p=L.divIcon({className:"marker-icon"});c.setIcon(p),setTimeout(()=>{delete c._dragging},100)},_addMarker(a,c,p){a.off("movestart",this._onMiddleMarkerMoveStart,this),a.off(this.options.addVertexOn,this._onMiddleMarkerClick,this);let y=a.getLatLng(),C=this._layer._latlngs;delete a.leftM,delete a.rightM;let{indexPath:k,index:I,parentPath:q}=L.PM.Utils.findDeepMarkerIndex(this._markers,c),oe=k.length>1?(0,jt.default)(C,q):C,ve=k.length>1?(0,jt.default)(this._markers,q):this._markers;oe.splice(I+1,0,y),ve.splice(I+1,0,a),this._layer.setLatLngs(C),this.options.hideMiddleMarkers!==!0&&(this._createMiddleMarker(c,a),this._createMiddleMarker(a,p)),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit"),this._fireVertexAdded(a,L.PM.Utils.findDeepMarkerIndex(this._markers,a).indexPath,y),this.options.snappable&&this._initSnappableMarkers()},hasSelfIntersection(){return vi(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersectionOnVertexRemoval(){this._handleLayerStyle(!0)&&(this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers())},_handleLayerStyle(a){let c=this._layer,p,y;if(this.options.allowSelfIntersection?p=!1:(y=vi(this._layer.toGeoJSON(15)),p=y.features.length>0),p){if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!0),this.isRed)return p;a?this._flashLayer():(c.setStyle({color:"#f00000ff"}),this.isRed=!0),this._fireIntersect(y)}else c.setStyle({color:this.cachedColor}),this.isRed=!1,!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!1);return p},_flashLayer(){this.cachedColor||(this.cachedColor=this._layer.options.color),this._layer.setStyle({color:"#f00000ff"}),this.isRed=!0,window.setTimeout(()=>{this._layer.setStyle({color:this.cachedColor}),this.isRed=!1},200)},_updateDisabledMarkerStyle(a,c){a.forEach(p=>{Array.isArray(p)?this._updateDisabledMarkerStyle(p,c):p._icon&&(c&&!this._checkMarkerAllowedToDrag(p)?L.DomUtil.addClass(p._icon,"vertexmarker-disabled"):L.DomUtil.removeClass(p._icon,"vertexmarker-disabled"))})},_removeMarker(a){let c=a.target;if(!this._vertexValidation("remove",a))return;this.options.allowSelfIntersection||(this._coordsBeforeEdit=ao(this._layer,this._layer.getLatLngs()));let p=this._layer.getLatLngs(),{indexPath:y,index:C,parentPath:k}=L.PM.Utils.findDeepMarkerIndex(this._markers,c);if(!y)return;let I=y.length>1?(0,jt.default)(p,k):p,q=y.length>1?(0,jt.default)(this._markers,k):this._markers,oe=k[k.length-1]>0&&this._layer instanceof L.Polygon;if(!this.options.removeLayerBelowMinVertexCount&&!oe&&(I.length<=2||this.isPolygon()&&I.length<=3)){this._flashLayer();return}I.splice(C,1),this._layer.setLatLngs(p),this.isPolygon()&&I.length<=2&&I.splice(0,I.length);let ve=!1;if(I.length<=1&&(I.splice(0,I.length),k.length>1&&y.length>1&&(p=Ta(p)),this._layer.setLatLngs(p),this._initMarkers(),ve=!0),Rr(p)||this._layer.remove(),p=Ta(p),this._layer.setLatLngs(p),this._markers=Ta(this._markers),!ve&&(q=y.length>1?(0,jt.default)(this._markers,k):this._markers,c._middleMarkerPrev&&(this._markerGroup.removeLayer(c._middleMarkerPrev),this._removeFromCache(c._middleMarkerPrev)),c._middleMarkerNext&&(this._markerGroup.removeLayer(c._middleMarkerNext),this._removeFromCache(c._middleMarkerNext)),this._markerGroup.removeLayer(c),this._removeFromCache(c),q)){let Ke,$e;if(this.isPolygon()?(Ke=(C+1)%q.length,$e=(C+(q.length-1))%q.length):($e=C-1<0?void 0:C-1,Ke=C+1>=q.length?void 0:C+1),Ke!==$e){let vt=q[$e],Nt=q[Ke];this.options.hideMiddleMarkers!==!0&&this._createMiddleMarker(vt,Nt)}q.splice(C,1)}this._fireEdit(),this._layerEdited=!0,this._fireVertexRemoved(c,y),this._fireChange(this._layer.getLatLngs(),"Edit")},updatePolygonCoordsFromMarkerDrag(a){let c=this._layer.getLatLngs(),p=a.getLatLng(),{indexPath:y,index:C,parentPath:k}=L.PM.Utils.findDeepMarkerIndex(this._markers,a);(y.length>1?(0,jt.default)(c,k):c).splice(C,1,p),this._layer.setLatLngs(c)},_getNeighborMarkers(a){let{indexPath:c,index:p,parentPath:y}=L.PM.Utils.findDeepMarkerIndex(this._markers,a),C=c.length>1?(0,jt.default)(this._markers,y):this._markers,k=(p+1)%C.length,I=(p+(C.length-1))%C.length,q=C[I],oe=C[k];return{prevMarker:q,nextMarker:oe}},_checkMarkerAllowedToDrag(a){let{prevMarker:c,nextMarker:p}=this._getNeighborMarkers(a),y=L.polyline([c.getLatLng(),a.getLatLng()]),C=L.polyline([a.getLatLng(),p.getLatLng()]),k=zs(this._layer.toGeoJSON(15),y.toGeoJSON(15)).features.length,I=zs(this._layer.toGeoJSON(15),C.toGeoJSON(15)).features.length;return a.getLatLng()===this._markers[0][0].getLatLng()?I+=1:a.getLatLng()===this._markers[0][this._markers[0].length-1].getLatLng()&&(k+=1),!(k<=2&&I<=2)},_onMarkerDragStart(a){let c=a.target;if(this.cachedColor||(this.cachedColor=this._layer.options.color),!this._vertexValidation("move",a))return;let{indexPath:p}=L.PM.Utils.findDeepMarkerIndex(this._markers,c);this._fireMarkerDragStart(a,p),this.options.allowSelfIntersection||(this._coordsBeforeEdit=ao(this._layer,this._layer.getLatLngs())),!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()?this._markerAllowedToDrag=this._checkMarkerAllowedToDrag(c):this._markerAllowedToDrag=null},_onMarkerDrag(a){let c=a.target;if(!this._vertexValidationDrag(c))return;let{indexPath:p,index:y,parentPath:C}=L.PM.Utils.findDeepMarkerIndex(this._markers,c);if(!p)return;if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()&&this._markerAllowedToDrag===!1){this._layer.setLatLngs(this._coordsBeforeEdit),this._initMarkers(),this._handleLayerStyle();return}this.updatePolygonCoordsFromMarkerDrag(c);let k=p.length>1?(0,jt.default)(this._markers,C):this._markers,I=(y+1)%k.length,q=(y+(k.length-1))%k.length,oe=c.getLatLng(),ve=k[q].getLatLng(),Ke=k[I].getLatLng();if(c._middleMarkerNext){let $e=L.PM.Utils.calcMiddleLatLng(this._map,oe,Ke);c._middleMarkerNext.setLatLng($e)}if(c._middleMarkerPrev){let $e=L.PM.Utils.calcMiddleLatLng(this._map,oe,ve);c._middleMarkerPrev.setLatLng($e)}this.options.allowSelfIntersection||this._handleLayerStyle(),this._fireMarkerDrag(a,p),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(a){let c=a.target;if(!this._vertexValidationDragEnd(c))return;let{indexPath:p}=L.PM.Utils.findDeepMarkerIndex(this._markers,c),y=!this.options.allowSelfIntersection&&this.hasSelfIntersection();y&&this.options.allowSelfIntersectionEdit&&this._markerAllowedToDrag&&(y=!1);let C=!this.options.allowSelfIntersection&&y;if(this._fireMarkerDragEnd(a,p,C),C){this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers(),this.options.snappable&&this._initSnappableMarkers(),this._handleLayerStyle(),this._fireLayerReset(a,p);return}!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._handleLayerStyle(),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_onVertexClick(a){let c=a.target;if(c._dragging)return;let{indexPath:p}=L.PM.Utils.findDeepMarkerIndex(this._markers,c);this._fireVertexClick(a,p)}}),Vt.Polygon=Vt.Line.extend({_shape:"Polygon",_checkMarkerAllowedToDrag(a){let{prevMarker:c,nextMarker:p}=this._getNeighborMarkers(a),y=L.polyline([c.getLatLng(),a.getLatLng()]),C=L.polyline([a.getLatLng(),p.getLatLng()]),k=zs(this._layer.toGeoJSON(15),y.toGeoJSON(15)).features.length,I=zs(this._layer.toGeoJSON(15),C.toGeoJSON(15)).features.length;return!(k<=2&&I<=2)}}),Vt.Rectangle=Vt.Polygon.extend({_shape:"Rectangle",_initMarkers(){let a=this._map,c=this._findCorners();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0,a.addLayer(this._markerGroup),this._markers=[],this._markers[0]=c.map(this._createMarker,this),[this._cornerMarkers]=this._markers,this._layer.getLatLngs()[0].forEach((p,y)=>{let C=this._cornerMarkers.find(k=>k._index===y);C&&C.setLatLng(p)})},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this._addMarkerEvents()},_createMarker(a,c){let p=new L.Marker(a,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(p,"vertexPane"),p._origLatLng=a,p._index=c,p._pmTempLayer=!0,p.on("click",this._onVertexClick,this),this._markerGroup.addLayer(p),p},_addMarkerEvents(){this._markers[0].forEach(a=>{a.on("dragstart",this._onMarkerDragStart,this),a.on("drag",this._onMarkerDrag,this),a.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||a.on("contextmenu",this._removeMarker,this)})},_removeMarker(){return null},_onMarkerDragStart(a){if(!this._vertexValidation("move",a))return;let c=a.target,p=this._cornerMarkers;c._oppositeCornerLatLng=p.find(C=>C._index===(c._index+2)%4).getLatLng(),c._snapped=!1;let{indexPath:y}=L.PM.Utils.findDeepMarkerIndex(this._markers,c);this._fireMarkerDragStart(a,y)},_onMarkerDrag(a){let c=a.target;if(!this._vertexValidationDrag(c)||c._index===void 0)return;this._adjustRectangleForMarkerMove(c);let{indexPath:p}=L.PM.Utils.findDeepMarkerIndex(this._markers,c);this._fireMarkerDrag(a,p),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(a){let c=a.target;if(!this._vertexValidationDragEnd(c))return;this._cornerMarkers.forEach(y=>{delete y._oppositeCornerLatLng});let{indexPath:p}=L.PM.Utils.findDeepMarkerIndex(this._markers,c);this._fireMarkerDragEnd(a,p),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_adjustRectangleForMarkerMove(a){L.extend(a._origLatLng,a._latlng);let c=L.PM.Utils._getRotatedRectangle(a.getLatLng(),a._oppositeCornerLatLng,this.getAngle(),this._map);this._layer.setLatLngs(c),this._adjustAllMarkers(a),this._layer.redraw()},_adjustAllMarkers(a){let c=this._layer.getLatLngs()[0];if(c&&c.length!==4&&c.length>0)c.forEach((p,y)=>{this._cornerMarkers[y].setLatLng(p)}),this._cornerMarkers.slice(c.length).forEach(p=>{p.setLatLng(c[0])});else if(!c||!c.length)console.error("The layer has no LatLngs");else{let p=c.findIndex(y=>a.getLatLng().equals(y));p>-1?(this._cornerMarkers[(a._index+1)%4].setLatLng(c[(p+1)%4]),this._cornerMarkers[(a._index+2)%4].setLatLng(c[(p+2)%4]),this._cornerMarkers[(a._index+3)%4].setLatLng(c[(p+3)%4])):this._cornerMarkers.forEach(y=>{y.setLatLng(c[y._index])})}},_findCorners(){this._angle===void 0&&this.setInitAngle(Mo(this._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);let a=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(a[0],a[2],this.getAngle(),this._map||this)}}),Vt.CircleMarker=Vt.extend({_shape:"CircleMarker",initialize(a){this._layer=a,this._enabled=!1,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._updateHiddenPolyCircle()},enable(a={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,a),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._extendingEnable(),this._updateHiddenPolyCircle(),this._fireEnable()},_extendingEnable(){this._layer.on("pm:dragstart",this._onDragStart,this),this._layer.on("pm:drag",this._onMarkerDrag,this),this._layer.on("pm:dragend",this._onMarkerDragEnd,this)},disable(){this.dragging()||(this._map||(this._map=this._layer._map),this._map&&this.enabled()&&(this.layerDragEnabled()&&this.disableLayerDrag(),this._helperLayers&&(this._helperLayers.clearLayers(),this._helperLayers.removeFrom(this._map)),this.options[this._editableOption]?(this._map.off("move",this._syncMarkers,this),this._outerMarker.off("drag",this._handleOuterMarkerSnapping,this)):this._map.off("move",this._updateHiddenPolyCircle,this),this._extendingDisable(),this._layer.off("remove",this.disable,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1))},_extendingDisable(){this._layer.off("contextmenu",this._removeMarker,this)},enabled(){return this._enabled},toggleEdit(a){this.enabled()?this.disable():this.enable(a)},applyOptions(){this.options[this._editableOption]?(this._initMarkers(),this._map.on("move",this._syncMarkers,this),this.options.snappable?(this._initSnappableMarkers(),this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this),this._outerMarker.on("move",this._syncHintLine,this),this._outerMarker.on("move",this._syncCircleRadius,this)):this._disableSnapping()):(this.options.draggable&&this.enableLayerDrag(),this._map.on("move",this._updateHiddenPolyCircle,this),this.options.snappable?this._initSnappableMarkersDrag():this._disableSnappingDrag()),this._extendingApplyOptions()},_extendingApplyOptions(){this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_initMarkers(){let a=this._map;this._helperLayers&&(this._helperLayers.removeFrom(a),this._helperLayers.clearLayers()),this._helperLayers=new L.FeatureGroup,this._helperLayers._pmTempLayer=!0,this._helperLayers.addTo(a);let c=this._layer.getLatLng(),p=this._layer._radius,y=this._getLatLngOnCircle(c,p);this._centerMarker=this._createCenterMarker(c),this._outerMarker=this._createOuterMarker(y),this._markers=[this._centerMarker,this._outerMarker],this._createHintLine(this._centerMarker,this._outerMarker)},_getLatLngOnCircle(a,c){let p=this._map.project(a),y=L.point(p.x+c,p.y);return this._map.unproject(y)},_createHintLine(a,c){let p=a.getLatLng(),y=c.getLatLng();this._hintline=L.polyline([p,y],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._helperLayers.addLayer(this._hintline)},_createCenterMarker(a){let c=this._createMarker(a);return this.options.draggable?(L.DomUtil.addClass(c._icon,"leaflet-pm-draggable"),c.on("move",this._moveCircle,this)):c.dragging.disable(),c},_createOuterMarker(a){let c=this._createMarker(a);return c.on("drag",this._resizeCircle,this),c},_createMarker(a){let c=new L.Marker(a,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(c,"vertexPane"),c._origLatLng=a,c._pmTempLayer=!0,c.on("dragstart",this._onMarkerDragStart,this),c.on("drag",this._onMarkerDrag,this),c.on("dragend",this._onMarkerDragEnd,this),c.on("click",this._onVertexClick,this),this._helperLayers.addLayer(c),c},_moveCircle(a){if(a.target._cancelDragEventChain)return;let c=this._centerMarker.getLatLng();this._layer.setLatLng(c);let p=this._layer._radius,y=this._getLatLngOnCircle(c,p);this._outerMarker._latlng=y,this._outerMarker.update(),this._syncHintLine(),this._updateHiddenPolyCircle(),this._fireCenterPlaced("Edit"),this._fireChange(this._layer.getLatLng(),"Edit")},_syncMarkers(){let a=this._layer.getLatLng(),c=this._layer._radius,p=this._getLatLngOnCircle(a,c);this._outerMarker.setLatLng(p),this._centerMarker.setLatLng(a),this._syncHintLine(),this._updateHiddenPolyCircle()},_resizeCircle(){this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker()),this._syncHintLine(),this._syncCircleRadius()},_syncCircleRadius(){let a=this._centerMarker.getLatLng(),c=this._outerMarker.getLatLng(),p=this._distanceCalculation(a,c);this.options[this._minRadiusOption]&&p<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&p>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(p),this._updateHiddenPolyCircle(),this._fireChange(this._layer.getLatLng(),"Edit")},_syncHintLine(){let a=this._centerMarker.getLatLng(),c=this._outerMarker.getLatLng();this._hintline.setLatLngs([a,c])},_removeMarker(){this.options[this._editableOption]&&this.disable(),this._layer.remove(),this._fireRemove(this._layer),this._fireRemove(this._map,this._layer)},_onDragStart(){this._map.pm.Draw.CircleMarker._layerIsDragging=!0},_onMarkerDragStart(a){this._vertexValidation("move",a)&&this._fireMarkerDragStart(a)},_onMarkerDrag(a){let c=a.target;c instanceof L.Marker&&!this._vertexValidationDrag(c)||this._fireMarkerDrag(a)},_onMarkerDragEnd(a){this._extedingMarkerDragEnd();let c=a.target;this._vertexValidationDragEnd(c)&&(this.options[this._editableOption]&&(this._fireEdit(),this._layerEdited=!0),this._fireMarkerDragEnd(a))},_extedingMarkerDragEnd(){this._map.pm.Draw.CircleMarker._layerIsDragging=!1},_initSnappableMarkersDrag(){let a=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,a.off("pm:drag",this._handleSnapping,this),a.on("pm:drag",this._handleSnapping,this),a.off("pm:dragend",this._cleanupSnapping,this),a.on("pm:dragend",this._cleanupSnapping,this),a.off("pm:dragstart",this._unsnap,this),a.on("pm:dragstart",this._unsnap,this)},_disableSnappingDrag(){let a=this._layer;a.off("pm:drag",this._handleSnapping,this),a.off("pm:dragend",this._cleanupSnapping,this),a.off("pm:dragstart",this._unsnap,this)},_updateHiddenPolyCircle(){let a=this._layer._map||this._map;if(a){let c=L.PM.Utils.pxRadiusToMeterRadius(this._layer.getRadius(),a,this._layer.getLatLng()),p=L.circle(this._layer.getLatLng(),this._layer.options);p.setRadius(c);let y=a&&a.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(p,200,!y).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(p,200,!y),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)}},_getNewDestinationOfOuterMarker(){let a=this._centerMarker.getLatLng(),c=this._outerMarker.getLatLng(),p=this._distanceCalculation(a,c);return this.options[this._minRadiusOption]&&p<this.options[this._minRadiusOption]?c=Ja(this._map,a,c,this._getMinDistanceInMeter(a)):this.options[this._maxRadiusOption]&&p>this.options[this._maxRadiusOption]&&(c=Ja(this._map,a,c,this._getMaxDistanceInMeter(a))),c},_handleOuterMarkerSnapping(){if(this._outerMarker._snapped){let a=this._centerMarker.getLatLng(),c=this._outerMarker.getLatLng(),p=this._distanceCalculation(a,c);this.options[this._minRadiusOption]&&p<this.options[this._minRadiusOption]?this._outerMarker.setLatLng(this._outerMarker._orgLatLng):this.options[this._maxRadiusOption]&&p>this.options[this._maxRadiusOption]&&this._outerMarker.setLatLng(this._outerMarker._orgLatLng)}this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker())},_distanceCalculation(a,c){return this._map.project(a).distanceTo(this._map.project(c))},_getMinDistanceInMeter(a){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,a)},_getMaxDistanceInMeter(a){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,a)},_onVertexClick(a){a.target._dragging||this._fireVertexClick(a,void 0)}}),Vt.Circle=Vt.CircleMarker.extend({_shape:"Circle",initialize(a){this._layer=a,this._enabled=!1,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizeableCircle",this._updateHiddenPolyCircle()},enable(a){L.PM.Edit.CircleMarker.prototype.enable.call(this,a||{})},_extendingEnable(){},_extendingDisable(){this._layer.off("remove",this.disable,this);let a=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(a,"leaflet-pm-draggable")},_extendingApplyOptions(){},_syncMarkers(){},_removeMarker(){},_onDragStart(){},_extedingMarkerDragEnd(){},_updateHiddenPolyCircle(){let a=this._map&&this._map.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(this._layer,200,!a).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(this._layer,200,!a),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)},_distanceCalculation(a,c){return this._map.distance(a,c)},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_onVertexClick(a){a.target._dragging||this._fireVertexClick(a,void 0)}}),Vt.ImageOverlay=Vt.extend({_shape:"ImageOverlay",initialize(a){this._layer=a,this._enabled=!1},toggleEdit(a){this.enabled()?this.disable():this.enable(a)},enabled(){return this._enabled},enable(a={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,a),this._map=this._layer._map,!!this._map){if(!this.options.allowEditing){this.disable();return}this.enabled()||this.disable(),this.enableLayerDrag(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._otherSnapLayers=this._findCorners(),this._fireEnable()}},disable(){this._dragging||(this._map||(this._map=this._layer._map),this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this.enabled()||(this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()),this._enabled=!1)},_findCorners(){let a=this._layer.getBounds(),c=a.getNorthWest(),p=a.getNorthEast(),y=a.getSouthEast(),C=a.getSouthWest();return[c,p,y,C]}}),Vt.Text=Vt.extend({_shape:"Text",initialize(a){this._layer=a,this._enabled=!1},enable(a){if(L.Util.setOptions(this,a),!!this.textArea){if(!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._safeToCacheDragState=!0,this._focusChange(),this.textArea.readOnly=!1,this.textArea.classList.remove("pm-disabled"),this._layer.on("remove",this.disable,this),L.DomEvent.on(this.textArea,"input",this._autoResize,this),L.DomEvent.on(this.textArea,"focus",this._focusChange,this),L.DomEvent.on(this.textArea,"blur",this._focusChange,this),this._layer.on("dblclick",L.DomEvent.stop),L.DomEvent.off(this.textArea,"mousedown",this._preventTextSelection),this._enabled=!0,this._fireEnable()}},disable(){if(!this.enabled())return;this._layer.off("remove",this.disable,this),L.DomEvent.off(this.textArea,"input",this._autoResize,this),L.DomEvent.off(this.textArea,"focus",this._focusChange,this),L.DomEvent.off(this.textArea,"blur",this._focusChange,this),L.DomEvent.off(document,"click",this._documentClick,this),this._focusChange(),this.textArea.readOnly=!0,this.textArea.classList.add("pm-disabled");let a=document.activeElement;this.textArea.focus(),this.textArea.selectionStart=0,this.textArea.selectionEnd=0,L.DomEvent.on(this.textArea,"mousedown",this._preventTextSelection),a.focus(),this._disableOnBlurActive=!1,this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1},enabled(){return this._enabled},toggleEdit(a){this.enabled()?this.disable():this.enable(a)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initSnappableMarkers(){let a=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,a.off("pm:drag",this._handleSnapping,this),a.on("pm:drag",this._handleSnapping,this),a.off("pm:dragend",this._cleanupSnapping,this),a.on("pm:dragend",this._cleanupSnapping,this),a.off("pm:dragstart",this._unsnap,this),a.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let a=this._layer;a.off("pm:drag",this._handleSnapping,this),a.off("pm:dragend",this._cleanupSnapping,this),a.off("pm:dragstart",this._unsnap,this)},_autoResize(){this.textArea.style.height="1px",this.textArea.style.width="1px";let a=this.textArea.scrollHeight>21?this.textArea.scrollHeight:21,c=this.textArea.scrollWidth>16?this.textArea.scrollWidth:16;this.textArea.style.height=`${a}px`,this.textArea.style.width=`${c}px`,this._layer.options.text=this.getText(),this._fireTextChange(this.getText())},_disableOnBlur(){this._disableOnBlurActive=!0,setTimeout(()=>{this.enabled()&&L.DomEvent.on(document,"click",this._documentClick,this)},100)},_documentClick(a){a.target!==this.textArea&&(this.disable(),!this.getText()&&this.options.removeIfEmpty&&this.remove())},_focusChange(a={}){let c=this._hasFocus;this._hasFocus=a.type==="focus",!c!=!this._hasFocus&&(this._hasFocus?(this._applyFocus(),this._focusText=this.getText(),this._fireTextFocus()):(this._removeFocus(),this._fireTextBlur(),this._focusText!==this.getText()&&(this._fireEdit(),this._layerEdited=!0)))},_applyFocus(){this.textArea.classList.add("pm-hasfocus"),this._map.dragging&&(this._safeToCacheDragState&&(this._originalMapDragState=this._map.dragging._enabled,this._safeToCacheDragState=!1),this._map.dragging.disable())},_removeFocus(){this._map.dragging&&(this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0),this.textArea.classList.remove("pm-hasfocus")},focus(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.focus()},blur(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.blur(),this._disableOnBlurActive&&this.disable()},hasFocus(){return this._hasFocus},getElement(){return this.textArea},setText(a){a&&(this.textArea.value=a),this._autoResize()},getText(){return this.textArea.value},_initTextMarker(){if(this.textArea=L.PM.Draw.Text.prototype._createTextArea.call(this),this.options.className){let c=this.options.className.split(" ");this.textArea.classList.add(...c)}let a=L.PM.Draw.Text.prototype._createTextIcon.call(this,this.textArea);this._layer.setIcon(a),this._layer.once("add",this._createTextMarker,this)},_createTextMarker(a=!1){this._layer.off("add",this._createTextMarker,this),this._layer.getElement().tabIndex=-1,this.textArea.wrap="off",this.textArea.style.overflow="hidden",this.textArea.style.height=L.DomUtil.getStyle(this.textArea,"font-size"),this.textArea.style.width="1px",this._layer.options.text&&this.setText(this._layer.options.text),this._autoResize(),a===!0&&(this.enable(),this.focus(),this._disableOnBlur())},_preventTextSelection(a){a.preventDefault()}});var Jt=function(a,c,p,y,C,k){this._matrix=[a,c,p,y,C,k]};Jt.init=()=>new L.PM.Matrix(1,0,0,1,0,0),Jt.prototype={transform(a){return this._transform(a.clone())},_transform(a){let c=this._matrix,{x:p,y}=a;return a.x=c[0]*p+c[1]*y+c[4],a.y=c[2]*p+c[3]*y+c[5],a},untransform(a){let c=this._matrix;return new L.Point((a.x/c[0]-c[4])/c[0],(a.y/c[2]-c[5])/c[2])},clone(){let a=this._matrix;return new L.PM.Matrix(a[0],a[1],a[2],a[3],a[4],a[5])},translate(a){if(a===void 0)return new L.Point(this._matrix[4],this._matrix[5]);let c,p;return typeof a=="number"?(c=a,p=a):(c=a.x,p=a.y),this._add(1,0,0,1,c,p)},scale(a,c){if(a===void 0)return new L.Point(this._matrix[0],this._matrix[3]);let p,y;return c=c||L.point(0,0),typeof a=="number"?(p=a,y=a):(p=a.x,y=a.y),this._add(p,0,0,y,c.x,c.y)._add(1,0,0,1,-c.x,-c.y)},rotate(a,c){let p=Math.cos(a),y=Math.sin(a);return c=c||new L.Point(0,0),this._add(p,y,-y,p,c.x,c.y)._add(1,0,0,1,-c.x,-c.y)},flip(){return this._matrix[1]*=-1,this._matrix[2]*=-1,this},_add(a,c,p,y,C,k){let I=[[],[],[]],q=this._matrix,oe=[[q[0],q[2],q[4]],[q[1],q[3],q[5]],[0,0,1]],ve=[[a,p,C],[c,y,k],[0,0,1]],Ke;a&&a instanceof L.PM.Matrix&&(q=a._matrix,ve=[[q[0],q[2],q[4]],[q[1],q[3],q[5]],[0,0,1]]);for(let $e=0;$e<3;$e+=1)for(let vt=0;vt<3;vt+=1){Ke=0;for(let Nt=0;Nt<3;Nt+=1)Ke+=oe[$e][Nt]*ve[Nt][vt];I[$e][vt]=Ke}return this._matrix=[I[0][0],I[1][0],I[0][1],I[1][1],I[0][2],I[1][2]],this}};var an=Jt,Yt={calcMiddleLatLng(a,c,p){let y=a.project(c),C=a.project(p);return a.unproject(y._add(C)._divideBy(2))},findLayers(a){let c=[];return a.eachLayer(p=>{(p instanceof L.Polyline||p instanceof L.Marker||p instanceof L.Circle||p instanceof L.CircleMarker||p instanceof L.ImageOverlay)&&c.push(p)}),c=c.filter(p=>!!p.pm),c=c.filter(p=>!p._pmTempLayer),c=c.filter(p=>!L.PM.optIn&&!p.options.pmIgnore||L.PM.optIn&&p.options.pmIgnore===!1),c},circleToPolygon(a,c=60,p=!0){let y=a.getLatLng(),C=a.getRadius(),k=yr(y,C,c,0,p),I=[];for(let q=0;q<k.length;q+=1){let oe=[k[q].lat,k[q].lng];I.push(oe)}return L.polygon(I,a.options)},disablePopup(a){a.getPopup()&&(a._tempPopupCopy=a.getPopup(),a.unbindPopup())},enablePopup(a){a._tempPopupCopy&&(a.bindPopup(a._tempPopupCopy),delete a._tempPopupCopy)},_fireEvent(a,c,p,y=!1){a.fire(c,p,y);let{groups:C}=this.getAllParentGroups(a);C.forEach(k=>{k.fire(c,p,y)})},getAllParentGroups(a){let c=[],p=[],y=C=>{for(let k in C._eventParents)if(c.indexOf(k)===-1){c.push(k);let I=C._eventParents[k];p.push(I),y(I)}};return!a._pmLastGroupFetch||!a._pmLastGroupFetch.time||new Date().getTime()-a._pmLastGroupFetch.time>1e3?(y(a),a._pmLastGroupFetch={time:new Date().getTime(),groups:p,groupIds:c},{groupIds:c,groups:p}):{groups:a._pmLastGroupFetch.groups,groupIds:a._pmLastGroupFetch.groupIds}},createGeodesicPolygon:yr,getTranslation:Gn,findDeepCoordIndex(a,c,p=!0){let y,C=I=>(q,oe)=>{let ve=I.concat(oe);if(p){if(q.lat&&q.lat===c.lat&&q.lng===c.lng)return y=ve,!0}else if(q.lat&&L.latLng(q).equals(c))return y=ve,!0;return Array.isArray(q)&&q.some(C(ve))};a.some(C([]));let k={};return y&&(k={indexPath:y,index:y[y.length-1],parentPath:y.slice(0,y.length-1)}),k},findDeepMarkerIndex(a,c){let p,y=k=>(I,q)=>{let oe=k.concat(q);return I._leaflet_id===c._leaflet_id?(p=oe,!0):Array.isArray(I)&&I.some(y(oe))};a.some(y([]));let C={};return p&&(C={indexPath:p,index:p[p.length-1],parentPath:p.slice(0,p.length-1)}),C},_getIndexFromSegment(a,c){if(c&&c.length===2){let p=this.findDeepCoordIndex(a,c[0]),y=this.findDeepCoordIndex(a,c[1]),C=Math.max(p.index,y.index);return(p.index===0||y.index===0)&&C!==1&&(C+=1),{indexA:p,indexB:y,newIndex:C,indexPath:p.indexPath,parentPath:p.parentPath}}return null},_getRotatedRectangle(a,c,p,y){let C=Ge(y,a),k=Ge(y,c),I=p*Math.PI/180,q=Math.cos(I),oe=Math.sin(I),ve=(k.x-C.x)*q+(k.y-C.y)*oe,Ke=(k.y-C.y)*q-(k.x-C.x)*oe,$e=ve*q+C.x,vt=ve*oe+C.y,Nt=-Ke*oe+C.x,Wt=Ke*q+C.y,gn=ft(y,C),bn=ft(y,{x:$e,y:vt}),Zn=ft(y,k),Ze=ft(y,{x:Nt,y:Wt});return[gn,bn,Zn,Ze]},pxRadiusToMeterRadius(a,c,p){let y=c.project(p),C=L.point(y.x+a,y.y);return c.distance(c.unproject(C),p)}},Sn=Yt;L.PM=L.PM||{version:so.version,Map:ss,Toolbar:Ba,Draw:Dr,Edit:Vt,Utils:Sn,Matrix:an,activeLang:"en",optIn:!1,initialize(a){this.addInitHooks(a)},setOptIn(a){this.optIn=!!a},addInitHooks(){function a(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Map(this)):this.options.pmIgnore||(this.pm=new L.PM.Map(this)),this.pm&&this.pm.setGlobalOptions({})}L.Map.addInitHook(a);function c(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.LayerGroup(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.LayerGroup(this))}L.LayerGroup.addInitHook(c);function p(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this)):this.options.pmIgnore||(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this))}L.Marker.addInitHook(p);function y(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.CircleMarker(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.CircleMarker(this))}L.CircleMarker.addInitHook(y);function C(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Line(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Line(this))}L.Polyline.addInitHook(C);function k(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Polygon(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Polygon(this))}L.Polygon.addInitHook(k);function I(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Rectangle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Rectangle(this))}L.Rectangle.addInitHook(I);function q(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Circle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Circle(this))}L.Circle.addInitHook(q);function oe(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.ImageOverlay(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.ImageOverlay(this))}L.ImageOverlay.addInitHook(oe)},reInitLayer(a){a instanceof L.LayerGroup&&a.eachLayer(c=>{this.reInitLayer(c)}),a.pm||L.PM.optIn&&a.options.pmIgnore!==!1||a.options.pmIgnore||(a instanceof L.Map?a.pm=new L.PM.Map(a):a instanceof L.Marker?a.options.textMarker?(a.pm=new L.PM.Edit.Text(a),a.pm._initTextMarker(),a.pm._createTextMarker(!1)):a.pm=new L.PM.Edit.Marker(a):a instanceof L.Circle?a.pm=new L.PM.Edit.Circle(a):a instanceof L.CircleMarker?a.pm=new L.PM.Edit.CircleMarker(a):a instanceof L.Rectangle?a.pm=new L.PM.Edit.Rectangle(a):a instanceof L.Polygon?a.pm=new L.PM.Edit.Polygon(a):a instanceof L.Polyline?a.pm=new L.PM.Edit.Line(a):a instanceof L.LayerGroup?a.pm=new L.PM.Edit.LayerGroup(a):a instanceof L.ImageOverlay&&(a.pm=new L.PM.Edit.ImageOverlay(a)))}},L.version==="1.7.1"&&L.Canvas.include({_onClick(a){let c=this._map.mouseEventToLayerPoint(a),p,y;for(let C=this._drawFirst;C;C=C.next)p=C.layer,p.options.interactive&&p._containsPoint(c)&&(!(a.type==="click"||a.type==="preclick")||!this._map._draggableMoved(p))&&(y=p);y&&(L.DomEvent.fakeStop(a),this._fireEvent([y],a))}}),L.PM.initialize()})();class yu extends hn.Rectangle{constructor(t,i="Double-cliquez pour éditer",r={}){var g,v,_,x,E,b,D,$;const o=t instanceof hn.LatLngBounds?t:hn.latLngBounds(t);if(!o.isValid()){console.warn("[TextRectangle] Limites invalides, utilisation de limites par défaut");const Q=hn.latLng(0,0);o.extend(hn.latLng(Q.lat+.001,Q.lng+.001)),o.extend(hn.latLng(Q.lat-.001,Q.lng-.001))}const l={...r.textStyle,color:r.textColor||((g=r.textStyle)==null?void 0:g.color)||"#000000",fontFamily:r.fontFamily||((v=r.textStyle)==null?void 0:v.fontFamily)||"Arial, sans-serif",textAlign:r.textAlign||((_=r.textStyle)==null?void 0:_.textAlign)||"center",backgroundColor:r.backgroundColor||((x=r.textStyle)==null?void 0:x.backgroundColor)||"#FFFFFF",backgroundOpacity:r.backgroundOpacity??((E=r.textStyle)==null?void 0:E.backgroundOpacity)??1,bold:r.bold||((b=r.textStyle)==null?void 0:b.bold)||!1,italic:r.italic||((D=r.textStyle)==null?void 0:D.italic)||!1,fontSize:(($=r.textStyle)==null?void 0:$.fontSize)||"14px"},h={pmIgnore:!1,interactive:!0,fill:!0,stroke:!0,className:"leaflet-text-rectangle",...r,textStyle:l};super(o,h);Pt(this,"properties",{type:"TextRectangle",text:"",width:0,height:0,area:0,rotation:0,style:{textStyle:{color:"#000000",fontSize:"14px",fontFamily:"Arial, sans-serif",textAlign:"center",backgroundColor:"#FFFFFF",backgroundOpacity:1,bold:!1,italic:!1}}});Pt(this,"_textNode",null);Pt(this,"_isEditing",!1);Pt(this,"_editableDiv",null);Pt(this,"_text");Pt(this,"_rotation",0);Pt(this,"_textStyle",{color:"#000000",fontSize:"14px",fontFamily:"Arial, sans-serif",textAlign:"center",backgroundColor:"#FFFFFF",backgroundOpacity:1,bold:!1,italic:!1});Pt(this,"_initialBounds",null);Pt(this,"_isResizing",!1);Pt(this,"_resizePreview",null);Pt(this,"_minWidth",50);Pt(this,"_minHeight",30);Pt(this,"_maxWidth",2e3);Pt(this,"_maxHeight",1e3);Pt(this,"_onKeyDown",t=>{Ct.measure("TextRectangle._onKeyDown",()=>{t.key==="Enter"&&t.ctrlKey?(t.preventDefault(),this._finishEditing()):t.key==="Escape"&&(t.preventDefault(),this._cancelEditing())})});Pt(this,"_finishEditing",()=>{Ct.measure("TextRectangle._finishEditing",()=>{if(this._editableDiv)try{const t=this._editableDiv.innerText.trim()||"Double-cliquez pour éditer";this._cleanupEditableDiv(),this.setText(t),this._textRedraw(),this.fire("edit:end"),this.map&&!this.map.dragging.enabled()&&this.map.dragging.enable()}catch(t){console.error("[TextRectangle] Erreur lors de la finalisation de l'édition :",t),this._cleanupEditableDiv()}})});Pt(this,"_cancelEditing",()=>{this._textRedraw(),this._cleanupEditableDiv(),this.map&&!this.map.dragging.enabled()&&this.map.dragging.enable()});Pt(this,"_updateTextPosition",()=>{Ct.measure("TextRectangle._updateTextPosition",()=>{this.updateProperties(),this._textRedraw()})});Pt(this,"_onZoomEnd",()=>{Ct.measure("TextRectangle._onZoomEnd",()=>{this._path&&(this._path.style.display=""),this._textNode&&(this._textNode.style.display=""),this._textRedraw()})});Pt(this,"_onAdd",()=>{Ct.measure("TextRectangle._onAdd",()=>{this._textRedraw(),this.map&&(this.map.on("zoomend",this._onZoomEnd.bind(this)),this.map.on("zoomanim",this._animateZoom.bind(this)))})});Pt(this,"_onRemove",()=>{Ct.measure("TextRectangle._onRemove",()=>{this._removeTextNode(),this.map&&(this.map.off("zoomend",this._onZoomEnd),this.map.off("zoomanim",this._animateZoom))})});this._text=i,this._textStyle={...l},this.properties={type:"TextRectangle",text:this._text,width:0,height:0,area:0,rotation:this._rotation,style:{...h,textStyle:{...this._textStyle},name:r.name||""}},this.on({add:this._onAdd,remove:this._onRemove,dblclick:this._onDoubleClick,dragend:this._updateTextPosition,"pm:edit":this._updateTextPosition,"pm:dragend":this._updateTextPosition,"pm:markerdragend":this._updateTextPosition,"pm:vertexadded":this._updateTextPosition,"pm:vertexremoved":this._updateTextPosition}),this.pm&&this.pm.enableLayerDrag()}get map(){return this._map}set map(t){this._map=t}setText(t,i){Ct.measure("TextRectangle.setText",()=>{const r=this.properties.text;this._text=t,i&&(this._textStyle={...this._textStyle,...i}),this.properties.text=t||"Double-cliquez pour éditer",console.log("[TextRectangle] Mise à jour du texte",{oldText:r,newText:this.properties.text,hasTextNode:!!this._textNode}),this._textRedraw(),this.fire("text:updated",{text:this.properties.text,oldText:r,bounds:this.getBounds(),style:this.properties.style}),this.fire("properties:updated",{shape:this,properties:this.properties,source:"setText"})})}setTextStyle(t){Ct.measure("TextRectangle.setTextStyle",()=>{var i,r;console.log("[TextRectangle] Setting text style",{currentStyle:{...this._textStyle},newStyle:t,currentProps:(r=(i=this.properties)==null?void 0:i.style)==null?void 0:r.textStyle}),this._textStyle={...this._textStyle,...t},this.properties.style.textStyle?this.properties.style.textStyle={...this.properties.style.textStyle,...t}:this.properties.style.textStyle={...this._textStyle},t.fontSize&&(this._textStyle.fontSize=t.fontSize,this.properties.style.textStyle.fontSize=t.fontSize),console.log("[TextRectangle] After style update",{textStyle:{...this._textStyle},propsTextStyle:{...this.properties.style.textStyle}}),this._textRedraw(),this.fire("properties:updated",{shape:this,properties:this.properties})})}setRotation(t){Ct.measure("TextRectangle.setRotation",()=>{this.properties.rotation=t%360,this._textRedraw(),this.fire("properties:updated",{shape:this,properties:this.properties})})}getTextElement(){return this._textNode}updateProperties(){Ct.measure("TextRectangle.updateProperties",()=>{var l,h;const t=this.getBounds(),i=t.getCenter(),r=this.getDimensions().width,o=this.getDimensions().height;this.properties={type:"TextRectangle",text:this._text,width:r,height:o,area:r*o,rotation:this._rotation,center:{lat:i.lat,lng:i.lng},bounds:{northEast:{lat:t.getNorthEast().lat,lng:t.getNorthEast().lng},southWest:{lat:t.getSouthWest().lat,lng:t.getSouthWest().lng}},style:{...this.options,textStyle:{...this._textStyle},name:((h=(l=this.properties)==null?void 0:l.style)==null?void 0:h.name)||""}},this.fire("properties:updated",{shape:this,properties:this.properties})})}setBounds(t){return Ct.measure("TextRectangle.setBounds",()=>{const i=t instanceof hn.LatLngBounds?t:hn.latLngBounds(t);return hn.Rectangle.prototype.setBounds.call(this,i),this._textRedraw(),this.updateProperties(),this})}startResize(){Ct.measure("TextRectangle.startResize",()=>{if(!this._isResizing&&(this._isResizing=!0,this._initialBounds=this.getBounds(),this.map&&!this._resizePreview))try{if(this._resizePreview=hn.rectangle(this._initialBounds,{color:this.options.color||"#3388ff",weight:this.options.weight||2,opacity:.8,fillColor:this.options.fillColor||"#3388ff",fillOpacity:.2,dashArray:this.options.dashArray||"5,5",className:"resize-preview"}).addTo(this.map),this._rotation!==0){const t=this._resizePreview._path;t&&(t.style.transformOrigin="center",t.style.transform=`rotate(${this._rotation}deg)`)}this._textNode&&(this._textNode.style.opacity="0.5")}catch(t){console.error("[TextRectangle] Erreur lors de la création du rectangle fantôme:",t),this._cleanupResizePreview()}})}updateResizePreview(t){Ct.measure("TextRectangle.updateResizePreview",()=>{if(!(!this._isResizing||!this._resizePreview||!this.map))try{const i=this.map.latLngToContainerPoint(t.getNorthWest()),r=this.map.latLngToContainerPoint(t.getSouthEast()),o=Math.abs(r.x-i.x),l=Math.abs(r.y-i.y);if(o<this._minWidth||l<this._minHeight||o>this._maxWidth||l>this._maxHeight)return;if(this._resizePreview.setBounds(t),this._rotation!==0){const h=this._resizePreview._path;h&&(h.style.transformOrigin="center",h.style.transform=`rotate(${this._rotation}deg)`)}if(this._textNode){const h=Math.min(o,l)*.1,g=Math.max(10,Math.min(48,h)),v=g*1.2,x=this.properties.text.split(`
`).length*v,E=i.y+(l-x)/2,b=this._calculateTextX(i.x,r.x,5);if(this._textNode.setAttribute("x",b.toString()),this._textNode.setAttribute("y",E.toString()),this._textNode.querySelectorAll("tspan").forEach((D,$)=>{D.setAttribute("x",b.toString()),D.setAttribute("dy",$===0?"0":`${v}px`),D.style.fontSize=`${g}px`}),this._rotation!==0){const D=this.map.latLngToLayerPoint(t.getCenter());this._textNode.setAttribute("transform",`rotate(${this._rotation}, ${D.x}, ${D.y})`)}}this.fire("resize:update",{bounds:t})}catch(i){console.error("[TextRectangle] Erreur lors de la mise à jour du rectangle fantôme:",i),this._cleanupResizePreview()}})}endResize(t){Ct.measure("TextRectangle.endResize",()=>{if(this._isResizing)try{if(this._cleanupResizePreview(),this._textNode&&(this._textNode.style.opacity="1"),this.map){const i=this.map.latLngToContainerPoint(t.getNorthWest()),r=this.map.latLngToContainerPoint(t.getSouthEast()),o=Math.abs(r.x-i.x),l=Math.abs(r.y-i.y);if(o<this._minWidth||l<this._minHeight||o>this._maxWidth||l>this._maxHeight){this.cancelResize();return}}this.setBounds(t),this._textRedraw(),this.fire("resize:end",{bounds:t})}catch(i){console.error("[TextRectangle] Erreur lors de la fin du redimensionnement:",i),this.cancelResize()}finally{this._isResizing=!1}})}cancelResize(){Ct.measure("TextRectangle.cancelResize",()=>{if(!(!this._isResizing||!this._initialBounds))try{this._cleanupResizePreview(),this._textNode&&(this._textNode.style.opacity="1"),this.setBounds(this._initialBounds)}catch(t){console.error("[TextRectangle] Erreur lors de l'annulation du redimensionnement:",t)}finally{this._isResizing=!1,this._initialBounds=null}})}_cleanupResizePreview(){Ct.measure("TextRectangle._cleanupResizePreview",()=>{if(this._resizePreview&&this.map)try{this.map.removeLayer(this._resizePreview)}catch(t){console.error("[TextRectangle] Erreur lors du nettoyage du rectangle fantôme:",t)}finally{this._resizePreview=null}})}_onDoubleClick(t){Ct.measure("TextRectangle._onDoubleClick",()=>{this._isEditing||this._isResizing||(hn.DomEvent.stopPropagation(t),this.fire("edit:start"),this._isEditing=!0,this._removeTextNode(),this._createEditableDiv())})}_createEditableDiv(){Ct.measure("TextRectangle._createEditableDiv",()=>{var t;if(this.map)try{const i=this.getBounds(),r=this.map.latLngToContainerPoint(i.getNorthWest()),o=this.map.latLngToContainerPoint(i.getSouthEast()),l=o.x-r.x,h=o.y-r.y,g=document.createElement("div");g.className="leaflet-text-rectangle-editor",g.contentEditable="true",g.innerText=this.properties.text;let v=Math.min(l,h)*.1;const _=((t=this.properties.style.textStyle)==null?void 0:t.fontSize)||"",x=parseInt(_),E=isNaN(x)?v:x,b=Math.max(10,Math.min(48,E));if(Object.assign(g.style,{position:"absolute",left:`${r.x}px`,top:`${r.y}px`,width:`${l}px`,height:`${h}px`,backgroundColor:this.properties.style.fillColor||"#FFFFFF",opacity:`${this.properties.style.fillOpacity??1}`,color:this.properties.style.textColor||"#000000",fontSize:`${b}px`,fontFamily:this.properties.style.fontFamily||"Arial, sans-serif",fontWeight:this.properties.style.bold?"bold":"normal",fontStyle:this.properties.style.italic?"italic":"normal",textAlign:this.properties.style.textAlign||"center",border:`${this.properties.style.weight||2}px solid ${this.properties.style.color||"#3388ff"}`,borderRadius:"2px",padding:"4px",boxSizing:"border-box",zIndex:"1000",overflow:"auto",whiteSpace:"pre-wrap",wordBreak:"break-word",cursor:"text",userSelect:"text",outline:"none",display:"flex",alignItems:"center",justifyContent:this._getJustifyContent()}),this.properties.rotation!==0){const F=this.map.latLngToContainerPoint(i.getCenter());g.style.transformOrigin=`${F.x-r.x}px ${F.y-r.y}px`,g.style.transform=`rotate(${this.properties.rotation}deg)`}this.map.getContainer().appendChild(g),this._editableDiv=g,g.focus();const $=window.getSelection(),Q=document.createRange();Q.selectNodeContents(g),$==null||$.removeAllRanges(),$==null||$.addRange(Q),g.addEventListener("keydown",this._onKeyDown.bind(this)),g.addEventListener("blur",this._finishEditing.bind(this)),g.addEventListener("paste",F=>{var me;F.preventDefault();const G=((me=F.clipboardData)==null?void 0:me.getData("text/plain"))||"";document.execCommand("insertText",!1,G)}),this.map.dragging.enabled()&&this.map.dragging.disable(),console.log("[TextRectangle] Div éditable créé",{position:{left:r.x,top:r.y},size:{width:l,height:h},fontSize:b,styles:this.properties.style})}catch(i){console.error("[TextRectangle] Erreur lors de la création de l'éditeur :",i),this._isEditing=!1}})}_getJustifyContent(){return Ct.measure("TextRectangle._getJustifyContent",()=>{switch(this.properties.style.textAlign||"center"){case"left":return"flex-start";case"right":return"flex-end";case"center":default:return"center"}})}_cleanupEditableDiv(){Ct.measure("TextRectangle._cleanupEditableDiv",()=>{this._editableDiv&&(this._editableDiv.removeEventListener("keydown",this._onKeyDown),this._editableDiv.removeEventListener("blur",this._finishEditing),this._editableDiv.parentNode&&this._editableDiv.parentNode.removeChild(this._editableDiv),this._editableDiv=null,this._isEditing=!1)})}_textRedraw(){Ct.measure("TextRectangle._textRedraw",()=>{var i;if(!hn.Browser.svg||!this.map||this._isEditing||!this._path){console.log("[TextRectangle] _textRedraw ignoré",{reason:hn.Browser.svg?this.map?this._isEditing?"En cours d'édition":"Chemin SVG non trouvé":"Carte non disponible":"SVG non supporté"});return}this._removeTextNode();const t=this.properties.text;if(t)try{const r=this._path;if(!r){console.warn("[TextRectangle] Chemin SVG non trouvé");return}const o=r.ownerSVGElement;if(!o){console.warn("[TextRectangle] Élément SVG parent non trouvé");return}if(!this.map||!this.map.getContainer()||!this._map){console.warn("[TextRectangle] Carte non valide pour le rendu");return}const l=hn.SVG.create("text");l.setAttribute("class","leaflet-text-rectangle-text"),l.style.zIndex="1000",Object.assign(l.style,{fill:this.properties.style.textColor||"#000000",fontFamily:this.properties.style.fontFamily||"Arial, sans-serif",fontWeight:this.properties.style.bold?"bold":"normal",fontStyle:this.properties.style.italic?"italic":"normal",stroke:"white",strokeWidth:"0.5px",paintOrder:"stroke fill",pointerEvents:"none",userSelect:"none"});try{const h=this.getBounds();if(!h.isValid()){console.warn("[TextRectangle] Limites non valides pour le rendu");return}let g,v;try{g=this.map.latLngToLayerPoint(h.getNorthWest()),v=this.map.latLngToLayerPoint(h.getSouthEast())}catch(Ve){console.warn("[TextRectangle] Erreur de conversion de coordonnées:",Ve);return}const _=v.x-g.x,x=v.y-g.y;if(_<=0||x<=0||isNaN(_)||isNaN(x)){console.warn("[TextRectangle] Dimensions non valides:",{rectWidth:_,rectHeight:x});return}let E=Math.min(_,x)*.1;const b=((i=this.properties.style.textStyle)==null?void 0:i.fontSize)||"",D=parseInt(b),$=isNaN(D)?E:D,Q=Math.max(12,Math.min(48,$)),F=t.split(`
`),G=Q*1.2,me=F.length*G,Se=g.y+(x-me)/2,Ie=this._getTextAnchor(),nt=this._calculateTextX(g.x,v.x,5);if(l.setAttribute("text-anchor",Ie),l.setAttribute("dominant-baseline","hanging"),l.setAttribute("vector-effect","non-scaling-stroke"),F.forEach((Ve,O)=>{const W=hn.SVG.create("tspan");W.textContent=Ve,W.setAttribute("x",nt.toString()),W.setAttribute("dy",O===0?"0":`${G}px`),W.style.fontSize=`${Q}px`,W.style.textShadow="1px 1px 2px rgba(255,255,255,0.8)",l.appendChild(W)}),l.setAttribute("y",Se.toString()),this.properties.rotation!==0)try{const Ve=this.map.latLngToLayerPoint(h.getCenter());l.setAttribute("transform",`rotate(${this.properties.rotation}, ${Ve.x}, ${Ve.y})`)}catch(Ve){console.warn("[TextRectangle] Erreur lors de la rotation:",Ve)}this._textNode=l,o.appendChild(l),l.parentNode&&l.parentNode.appendChild(l),this.fire("text:redrawn",{text:t,fontSize:Q,position:{x:nt,y:Se},dimensions:{width:_,height:x}})}catch(h){console.error("[TextRectangle] Erreur lors des calculs de coordonnées:",h),this._textNode&&this._textNode.parentNode&&(this._textNode.parentNode.removeChild(this._textNode),this._textNode=null)}}catch(r){console.error("[TextRectangle] Erreur lors du rendu du texte:",r)}})}_calculateTextX(t,i,r){return Ct.measure("TextRectangle._calculateTextX",()=>{const o=i-t;switch(this.properties.style.textAlign){case"left":return t+r;case"right":return i-r;case"center":default:return t+o/2}})}_getTextAnchor(){return Ct.measure("TextRectangle._getTextAnchor",()=>{switch(this.properties.style.textAlign){case"left":return"start";case"right":return"end";case"center":default:return"middle"}})}_removeTextNode(){Ct.measure("TextRectangle._removeTextNode",()=>{this._textNode&&this._textNode.parentNode&&(this._textNode.parentNode.removeChild(this._textNode),this._textNode=null)})}getDimensions(){return Ct.measure("TextRectangle.getDimensions",()=>{const t=this.getBounds();if(!this.map)return{width:0,height:0};const i=t.getSouthWest(),r=hn.latLng(t.getSouth(),t.getEast()),o=this.map.distance(i,r),l=this.map.distance(i,hn.latLng(t.getNorth(),t.getWest()));return{width:o,height:l}})}getMidPoints(){return Ct.measure("TextRectangle.getMidPoints",()=>{const t=this.getBounds(),i=t.getNorthWest(),r=t.getNorthEast(),o=t.getSouthEast(),l=t.getSouthWest();return[hn.latLng((i.lat+r.lat)/2,(i.lng+r.lng)/2),hn.latLng((r.lat+o.lat)/2,(r.lng+o.lng)/2),hn.latLng((l.lat+o.lat)/2,(l.lng+o.lng)/2),hn.latLng((i.lat+l.lat)/2,(i.lng+l.lng)/2)]})}setName(t){Ct.measure("TextRectangle.setName",()=>{this.properties.style||(this.properties.style={textStyle:this._textStyle,name:t}),this.properties.style.name=t,this.fire("properties:updated",{shape:this,properties:this.properties,source:"setName"})})}getName(){return Ct.measure("TextRectangle.getName",()=>{var t,i;return((i=(t=this.properties)==null?void 0:t.style)==null?void 0:i.name)||""})}_animateZoom(t){if(this.map)try{const i=this._path;if(i&&(i.style.display="none"),this._textNode&&(this._textNode.style.display="none"),i){const r=i.style.transform;i.style.transform="",setTimeout(()=>{i&&(i.style.transform=r,i.style.display=""),this._textNode&&(this._textNode.style.display="",this._textRedraw())},300)}}catch(i){console.warn("[TextRectangle] Erreur pendant l'animation du zoom:",i),setTimeout(()=>{try{this._path&&(this._path.style.display=""),this._textNode&&(this._textNode.style.display="",this._textRedraw())}catch(r){console.error("[TextRectangle] Erreur lors de la restauration après animation:",r)}},300)}}}var ba=63710088e-1,h4={centimeters:ba*100,centimetres:ba*100,degrees:360/(2*Math.PI),feet:ba*3.28084,inches:ba*39.37,kilometers:ba/1e3,kilometres:ba/1e3,meters:ba,metres:ba,miles:ba/1609.344,millimeters:ba*1e3,millimetres:ba*1e3,nauticalmiles:ba/1852,radians:1,yards:ba*1.0936};function Wh(e,n,t={}){const i={type:"Feature"};return(t.id===0||t.id)&&(i.id=t.id),t.bbox&&(i.bbox=t.bbox),i.properties=n||{},i.geometry=e,i}function cp(e,n,t={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!fy(e[0])||!fy(e[1]))throw new Error("coordinates must contain numbers");return Wh({type:"Point",coordinates:e},n,t)}function Sl(e,n,t={}){for(const r of e){if(r.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(r[r.length-1].length!==r[0].length)throw new Error("First and last Position are not equivalent.");for(let o=0;o<r[r.length-1].length;o++)if(r[r.length-1][o]!==r[0][o])throw new Error("First and last Position are not equivalent.")}return Wh({type:"Polygon",coordinates:e},n,t)}function Pl(e,n,t={}){if(e.length<2)throw new Error("coordinates must be an array of two or more positions");return Wh({type:"LineString",coordinates:e},n,t)}function bk(e,n={}){const t={type:"FeatureCollection"};return n.id&&(t.id=n.id),n.bbox&&(t.bbox=n.bbox),t.features=e,t}function wk(e,n,t={}){return Wh({type:"MultiPolygon",coordinates:e},n,t)}function xk(e,n="kilometers"){const t=h4[n];if(!t)throw new Error(n+" units is invalid");return e*t}function Lk(e,n="kilometers"){const t=h4[n];if(!t)throw new Error(n+" units is invalid");return e/t}function kg(e){return e%(2*Math.PI)*180/Math.PI}function Kl(e){return e%360*Math.PI/180}function fy(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function dy(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Ck(e){return e.type==="Feature"?e.geometry:e}function f4(e,n,t={}){if(t.final===!0)return Sk(e,n);const i=dy(e),r=dy(n),o=Kl(i[0]),l=Kl(r[0]),h=Kl(i[1]),g=Kl(r[1]),v=Math.sin(l-o)*Math.cos(g),_=Math.cos(h)*Math.sin(g)-Math.sin(h)*Math.cos(g)*Math.cos(l-o);return kg(Math.atan2(v,_))}function Sk(e,n){let t=f4(n,e);return t=(t+180)%360,t}function Pk(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function wm(e,n,t,i={}){const r=Pk(e),o=Kl(r[0]),l=Kl(r[1]),h=Kl(t),g=Lk(n,i.units),v=Math.asin(Math.sin(l)*Math.cos(g)+Math.cos(l)*Math.sin(g)*Math.cos(h)),_=o+Math.atan2(Math.sin(h)*Math.sin(g)*Math.cos(l),Math.cos(g)-Math.sin(l)*Math.sin(v)),x=kg(_),E=kg(v);return cp([x,E],i.properties)}var py=wm;function gy(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function xm(e,n,t={}){var i=gy(e),r=gy(n),o=Kl(r[1]-i[1]),l=Kl(r[0]-i[0]),h=Kl(i[1]),g=Kl(r[1]),v=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(l/2),2)*Math.cos(h)*Math.cos(g);return xk(2*Math.atan2(Math.sqrt(v),Math.sqrt(1-v)),t.units)}var U0=xm;function Ek(e,n,t={}){const r=Ck(e).coordinates;let o=0;for(let l=0;l<r.length&&!(n>=o&&l===r.length-1);l++)if(o>=n){const h=n-o;if(h){const g=f4(r[l],r[l-1])-180;return wm(r[l],h,g,t)}else return cp(r[l])}else o+=xm(r[l],r[l+1],t);return cp(r[r.length-1])}var Tg=Ek;function Ak(e,n){var t,i,r,o,l,h,g,v,_,x,E=0,b=e.type==="FeatureCollection",D=e.type==="Feature",$=b?e.features.length:1;for(t=0;t<$;t++){for(h=b?e.features[t].geometry:D?e.geometry:e,v=b?e.features[t].properties:D?e.properties:{},_=b?e.features[t].bbox:D?e.bbox:void 0,x=b?e.features[t].id:D?e.id:void 0,g=h?h.type==="GeometryCollection":!1,l=g?h.geometries.length:1,r=0;r<l;r++){if(o=g?h.geometries[r]:h,o===null){if(n(null,E,v,_,x)===!1)return!1;continue}switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(n(o,E,v,_,x)===!1)return!1;break}case"GeometryCollection":{for(i=0;i<o.geometries.length;i++)if(n(o.geometries[i],E,v,_,x)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}E++}}function Mk(e,n,t){var i=t;return Ak(e,function(r,o,l,h,g){o===0&&t===void 0?i=r:i=n(i,r,o,l,h,g)}),i}function d4(e){return Mk(e,(n,t)=>n+kk(t),0)}function kk(e){let n=0,t;switch(e.type){case"Polygon":return my(e.coordinates);case"MultiPolygon":for(t=0;t<e.coordinates.length;t++)n+=my(e.coordinates[t]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function my(e){let n=0;if(e&&e.length>0){n+=Math.abs(vy(e[0]));for(let t=1;t<e.length;t++)n-=Math.abs(vy(e[t]))}return n}var Tk=ba*ba/2,$0=Math.PI/180;function vy(e){const n=e.length-1;if(n<=2)return 0;let t=0,i=0;for(;i<n;){const r=e[i],o=e[i+1===n?0:i+1],l=e[i+2>=n?(i+2)%n:i+2],h=r[0]*$0,g=o[1]*$0,v=l[0]*$0;t+=(v-h)*Math.sin(g),i++}return t*Tk}var pu=d4;function p4(e,n,t){if(e!==null)for(var i,r,o,l,h,g,v,_=0,x=0,E,b=e.type,D=b==="FeatureCollection",$=b==="Feature",Q=D?e.features.length:1,F=0;F<Q;F++){v=D?e.features[F].geometry:$?e.geometry:e,E=v?v.type==="GeometryCollection":!1,h=E?v.geometries.length:1;for(var G=0;G<h;G++){var me=0,Se=0;if(l=E?v.geometries[G]:v,l!==null){g=l.coordinates;var Ie=l.type;switch(_=Ie==="Polygon"||Ie==="MultiPolygon"?1:0,Ie){case null:break;case"Point":if(n(g,x,F,me,Se)===!1)return!1;x++,me++;break;case"LineString":case"MultiPoint":for(i=0;i<g.length;i++){if(n(g[i],x,F,me,Se)===!1)return!1;x++,Ie==="MultiPoint"&&me++}Ie==="LineString"&&me++;break;case"Polygon":case"MultiLineString":for(i=0;i<g.length;i++){for(r=0;r<g[i].length-_;r++){if(n(g[i][r],x,F,me,Se)===!1)return!1;x++}Ie==="MultiLineString"&&me++,Ie==="Polygon"&&Se++}Ie==="Polygon"&&me++;break;case"MultiPolygon":for(i=0;i<g.length;i++){for(Se=0,r=0;r<g[i].length;r++){for(o=0;o<g[i][r].length-_;o++){if(n(g[i][r][o],x,F,me,Se)===!1)return!1;x++}Se++}me++}break;case"GeometryCollection":for(i=0;i<l.geometries.length;i++)if(p4(l.geometries[i],n)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Bk(e,n={}){let t=0,i=0,r=0;return p4(e,function(o){t+=o[0],i+=o[1],r++}),cp([t/r,i/r],n.properties)}var Df=Bk;function Nk(e,n,t={}){const i=t.steps||64,r=t.properties?t.properties:!Array.isArray(e)&&e.type==="Feature"&&e.properties?e.properties:{},o=[];for(let l=0;l<i;l++)o.push(wm(e,n,l*-360/i,t).geometry.coordinates);return o.push(o[0]),Sl([o],r)}var Rk=Nk,Dk=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,q0=Math.ceil,Ll=Math.floor,Ua="[BigNumber Error] ",yy=Ua+"Number primitive has more than 15 significant digits: ",Vl=1e14,Mi=14,_y=9007199254740991,V0=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],uc=1e7,sl=1e9;function g4(e){var n,t,i,r=G.prototype={constructor:G,toString:null,valueOf:null},o=new G(1),l=20,h=4,g=-7,v=21,_=-1e7,x=1e7,E=!1,b=1,D=0,$={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},Q="0123456789abcdefghijklmnopqrstuvwxyz",F=!0;function G(O,W){var ue,z,R,J,V,U,Y,ce,re=this;if(!(re instanceof G))return new G(O,W);if(W==null){if(O&&O._isBigNumber===!0){re.s=O.s,!O.c||O.e>x?re.c=re.e=null:O.e<_?re.c=[re.e=0]:(re.e=O.e,re.c=O.c.slice());return}if((U=typeof O=="number")&&O*0==0){if(re.s=1/O<0?(O=-O,-1):1,O===~~O){for(J=0,V=O;V>=10;V/=10,J++);J>x?re.c=re.e=null:(re.e=J,re.c=[O]);return}ce=String(O)}else{if(!Dk.test(ce=String(O)))return i(re,ce,U);re.s=ce.charCodeAt(0)==45?(ce=ce.slice(1),-1):1}(J=ce.indexOf("."))>-1&&(ce=ce.replace(".","")),(V=ce.search(/e/i))>0?(J<0&&(J=V),J+=+ce.slice(V+1),ce=ce.substring(0,V)):J<0&&(J=ce.length)}else{if(Ss(W,2,Q.length,"Base"),W==10&&F)return re=new G(O),nt(re,l+re.e+1,h);if(ce=String(O),U=typeof O=="number"){if(O*0!=0)return i(re,ce,U,W);if(re.s=1/O<0?(ce=ce.slice(1),-1):1,G.DEBUG&&ce.replace(/^0\.0*|\./,"").length>15)throw Error(yy+O)}else re.s=ce.charCodeAt(0)===45?(ce=ce.slice(1),-1):1;for(ue=Q.slice(0,W),J=V=0,Y=ce.length;V<Y;V++)if(ue.indexOf(z=ce.charAt(V))<0){if(z=="."){if(V>J){J=Y;continue}}else if(!R&&(ce==ce.toUpperCase()&&(ce=ce.toLowerCase())||ce==ce.toLowerCase()&&(ce=ce.toUpperCase()))){R=!0,V=-1,J=0;continue}return i(re,String(O),U,W)}U=!1,ce=t(ce,W,10,re.s),(J=ce.indexOf("."))>-1?ce=ce.replace(".",""):J=ce.length}for(V=0;ce.charCodeAt(V)===48;V++);for(Y=ce.length;ce.charCodeAt(--Y)===48;);if(ce=ce.slice(V,++Y)){if(Y-=V,U&&G.DEBUG&&Y>15&&(O>_y||O!==Ll(O)))throw Error(yy+re.s*O);if((J=J-V-1)>x)re.c=re.e=null;else if(J<_)re.c=[re.e=0];else{if(re.e=J,re.c=[],V=(J+1)%Mi,J<0&&(V+=Mi),V<Y){for(V&&re.c.push(+ce.slice(0,V)),Y-=Mi;V<Y;)re.c.push(+ce.slice(V,V+=Mi));V=Mi-(ce=ce.slice(V)).length}else V-=Y;for(;V--;ce+="0");re.c.push(+ce)}}else re.c=[re.e=0]}G.clone=g4,G.ROUND_UP=0,G.ROUND_DOWN=1,G.ROUND_CEIL=2,G.ROUND_FLOOR=3,G.ROUND_HALF_UP=4,G.ROUND_HALF_DOWN=5,G.ROUND_HALF_EVEN=6,G.ROUND_HALF_CEIL=7,G.ROUND_HALF_FLOOR=8,G.EUCLID=9,G.config=G.set=function(O){var W,ue;if(O!=null)if(typeof O=="object"){if(O.hasOwnProperty(W="DECIMAL_PLACES")&&(ue=O[W],Ss(ue,0,sl,W),l=ue),O.hasOwnProperty(W="ROUNDING_MODE")&&(ue=O[W],Ss(ue,0,8,W),h=ue),O.hasOwnProperty(W="EXPONENTIAL_AT")&&(ue=O[W],ue&&ue.pop?(Ss(ue[0],-1e9,0,W),Ss(ue[1],0,sl,W),g=ue[0],v=ue[1]):(Ss(ue,-1e9,sl,W),g=-(v=ue<0?-ue:ue))),O.hasOwnProperty(W="RANGE"))if(ue=O[W],ue&&ue.pop)Ss(ue[0],-1e9,-1,W),Ss(ue[1],1,sl,W),_=ue[0],x=ue[1];else if(Ss(ue,-1e9,sl,W),ue)_=-(x=ue<0?-ue:ue);else throw Error(Ua+W+" cannot be zero: "+ue);if(O.hasOwnProperty(W="CRYPTO"))if(ue=O[W],ue===!!ue)if(ue)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))E=ue;else throw E=!ue,Error(Ua+"crypto unavailable");else E=ue;else throw Error(Ua+W+" not true or false: "+ue);if(O.hasOwnProperty(W="MODULO_MODE")&&(ue=O[W],Ss(ue,0,9,W),b=ue),O.hasOwnProperty(W="POW_PRECISION")&&(ue=O[W],Ss(ue,0,sl,W),D=ue),O.hasOwnProperty(W="FORMAT"))if(ue=O[W],typeof ue=="object")$=ue;else throw Error(Ua+W+" not an object: "+ue);if(O.hasOwnProperty(W="ALPHABET"))if(ue=O[W],typeof ue=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(ue))F=ue.slice(0,10)=="0123456789",Q=ue;else throw Error(Ua+W+" invalid: "+ue)}else throw Error(Ua+"Object expected: "+O);return{DECIMAL_PLACES:l,ROUNDING_MODE:h,EXPONENTIAL_AT:[g,v],RANGE:[_,x],CRYPTO:E,MODULO_MODE:b,POW_PRECISION:D,FORMAT:$,ALPHABET:Q}},G.isBigNumber=function(O){if(!O||O._isBigNumber!==!0)return!1;if(!G.DEBUG)return!0;var W,ue,z=O.c,R=O.e,J=O.s;e:if({}.toString.call(z)=="[object Array]"){if((J===1||J===-1)&&R>=-1e9&&R<=sl&&R===Ll(R)){if(z[0]===0){if(R===0&&z.length===1)return!0;break e}if(W=(R+1)%Mi,W<1&&(W+=Mi),String(z[0]).length==W){for(W=0;W<z.length;W++)if(ue=z[W],ue<0||ue>=Vl||ue!==Ll(ue))break e;if(ue!==0)return!0}}}else if(z===null&&R===null&&(J===null||J===1||J===-1))return!0;throw Error(Ua+"Invalid BigNumber: "+O)},G.maximum=G.max=function(){return Se(arguments,-1)},G.minimum=G.min=function(){return Se(arguments,1)},G.random=function(){var O=9007199254740992,W=Math.random()*O&2097151?function(){return Ll(Math.random()*O)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(ue){var z,R,J,V,U,Y=0,ce=[],re=new G(o);if(ue==null?ue=l:Ss(ue,0,sl),V=q0(ue/Mi),E)if(crypto.getRandomValues){for(z=crypto.getRandomValues(new Uint32Array(V*=2));Y<V;)U=z[Y]*131072+(z[Y+1]>>>11),U>=9e15?(R=crypto.getRandomValues(new Uint32Array(2)),z[Y]=R[0],z[Y+1]=R[1]):(ce.push(U%1e14),Y+=2);Y=V/2}else if(crypto.randomBytes){for(z=crypto.randomBytes(V*=7);Y<V;)U=(z[Y]&31)*281474976710656+z[Y+1]*1099511627776+z[Y+2]*4294967296+z[Y+3]*16777216+(z[Y+4]<<16)+(z[Y+5]<<8)+z[Y+6],U>=9e15?crypto.randomBytes(7).copy(z,Y):(ce.push(U%1e14),Y+=7);Y=V/7}else throw E=!1,Error(Ua+"crypto unavailable");if(!E)for(;Y<V;)U=W(),U<9e15&&(ce[Y++]=U%1e14);for(V=ce[--Y],ue%=Mi,V&&ue&&(U=V0[Mi-ue],ce[Y]=Ll(V/U)*U);ce[Y]===0;ce.pop(),Y--);if(Y<0)ce=[J=0];else{for(J=-1;ce[0]===0;ce.splice(0,1),J-=Mi);for(Y=1,U=ce[0];U>=10;U/=10,Y++);Y<Mi&&(J-=Mi-Y)}return re.e=J,re.c=ce,re}}(),G.sum=function(){for(var O=1,W=arguments,ue=new G(W[0]);O<W.length;)ue=ue.plus(W[O++]);return ue},t=function(){var O="0123456789";function W(ue,z,R,J){for(var V,U=[0],Y,ce=0,re=ue.length;ce<re;){for(Y=U.length;Y--;U[Y]*=z);for(U[0]+=J.indexOf(ue.charAt(ce++)),V=0;V<U.length;V++)U[V]>R-1&&(U[V+1]==null&&(U[V+1]=0),U[V+1]+=U[V]/R|0,U[V]%=R)}return U.reverse()}return function(ue,z,R,J,V){var U,Y,ce,re,Pe,Me,ot,X,Ee=ue.indexOf("."),B=l,H=h;for(Ee>=0&&(re=D,D=0,ue=ue.replace(".",""),X=new G(z),Me=X.pow(ue.length-Ee),D=re,X.c=W(Gu(xl(Me.c),Me.e,"0"),10,R,O),X.e=X.c.length),ot=W(ue,z,R,V?(U=Q,O):(U=O,Q)),ce=re=ot.length;ot[--re]==0;ot.pop());if(!ot[0])return U.charAt(0);if(Ee<0?--ce:(Me.c=ot,Me.e=ce,Me.s=J,Me=n(Me,X,B,H,R),ot=Me.c,Pe=Me.r,ce=Me.e),Y=ce+B+1,Ee=ot[Y],re=R/2,Pe=Pe||Y<0||ot[Y+1]!=null,Pe=H<4?(Ee!=null||Pe)&&(H==0||H==(Me.s<0?3:2)):Ee>re||Ee==re&&(H==4||Pe||H==6&&ot[Y-1]&1||H==(Me.s<0?8:7)),Y<1||!ot[0])ue=Pe?Gu(U.charAt(1),-B,U.charAt(0)):U.charAt(0);else{if(ot.length=Y,Pe)for(--R;++ot[--Y]>R;)ot[Y]=0,Y||(++ce,ot=[1].concat(ot));for(re=ot.length;!ot[--re];);for(Ee=0,ue="";Ee<=re;ue+=U.charAt(ot[Ee++]));ue=Gu(ue,ce,U.charAt(0))}return ue}}(),n=function(){function O(z,R,J){var V,U,Y,ce,re=0,Pe=z.length,Me=R%uc,ot=R/uc|0;for(z=z.slice();Pe--;)Y=z[Pe]%uc,ce=z[Pe]/uc|0,V=ot*Y+ce*Me,U=Me*Y+V%uc*uc+re,re=(U/J|0)+(V/uc|0)+ot*ce,z[Pe]=U%J;return re&&(z=[re].concat(z)),z}function W(z,R,J,V){var U,Y;if(J!=V)Y=J>V?1:-1;else for(U=Y=0;U<J;U++)if(z[U]!=R[U]){Y=z[U]>R[U]?1:-1;break}return Y}function ue(z,R,J,V){for(var U=0;J--;)z[J]-=U,U=z[J]<R[J]?1:0,z[J]=U*V+z[J]-R[J];for(;!z[0]&&z.length>1;z.splice(0,1));}return function(z,R,J,V,U){var Y,ce,re,Pe,Me,ot,X,Ee,B,H,he,te,ie,ee,se,Ce,ne,ae=z.s==R.s?1:-1,xe=z.c,ye=R.c;if(!xe||!xe[0]||!ye||!ye[0])return new G(!z.s||!R.s||(xe?ye&&xe[0]==ye[0]:!ye)?NaN:xe&&xe[0]==0||!ye?ae*0:ae/0);for(Ee=new G(ae),B=Ee.c=[],ce=z.e-R.e,ae=J+ce+1,U||(U=Vl,ce=Cl(z.e/Mi)-Cl(R.e/Mi),ae=ae/Mi|0),re=0;ye[re]==(xe[re]||0);re++);if(ye[re]>(xe[re]||0)&&ce--,ae<0)B.push(1),Pe=!0;else{for(ee=xe.length,Ce=ye.length,re=0,ae+=2,Me=Ll(U/(ye[0]+1)),Me>1&&(ye=O(ye,Me,U),xe=O(xe,Me,U),Ce=ye.length,ee=xe.length),ie=Ce,H=xe.slice(0,Ce),he=H.length;he<Ce;H[he++]=0);ne=ye.slice(),ne=[0].concat(ne),se=ye[0],ye[1]>=U/2&&se++;do{if(Me=0,Y=W(ye,H,Ce,he),Y<0){if(te=H[0],Ce!=he&&(te=te*U+(H[1]||0)),Me=Ll(te/se),Me>1)for(Me>=U&&(Me=U-1),ot=O(ye,Me,U),X=ot.length,he=H.length;W(ot,H,X,he)==1;)Me--,ue(ot,Ce<X?ne:ye,X,U),X=ot.length,Y=1;else Me==0&&(Y=Me=1),ot=ye.slice(),X=ot.length;if(X<he&&(ot=[0].concat(ot)),ue(H,ot,he,U),he=H.length,Y==-1)for(;W(ye,H,Ce,he)<1;)Me++,ue(H,Ce<he?ne:ye,he,U),he=H.length}else Y===0&&(Me++,H=[0]);B[re++]=Me,H[0]?H[he++]=xe[ie]||0:(H=[xe[ie]],he=1)}while((ie++<ee||H[0]!=null)&&ae--);Pe=H[0]!=null,B[0]||B.splice(0,1)}if(U==Vl){for(re=1,ae=B[0];ae>=10;ae/=10,re++);nt(Ee,J+(Ee.e=re+ce*Mi-1)+1,V,Pe)}else Ee.e=ce,Ee.r=+Pe;return Ee}}();function me(O,W,ue,z){var R,J,V,U,Y;if(ue==null?ue=h:Ss(ue,0,8),!O.c)return O.toString();if(R=O.c[0],V=O.e,W==null)Y=xl(O.c),Y=z==1||z==2&&(V<=g||V>=v)?Ad(Y,V):Gu(Y,V,"0");else if(O=nt(new G(O),W,ue),J=O.e,Y=xl(O.c),U=Y.length,z==1||z==2&&(W<=J||J<=g)){for(;U<W;Y+="0",U++);Y=Ad(Y,J)}else if(W-=V,Y=Gu(Y,J,"0"),J+1>U){if(--W>0)for(Y+=".";W--;Y+="0");}else if(W+=J-U,W>0)for(J+1==U&&(Y+=".");W--;Y+="0");return O.s<0&&R?"-"+Y:Y}function Se(O,W){for(var ue,z,R=1,J=new G(O[0]);R<O.length;R++)z=new G(O[R]),(!z.s||(ue=qc(J,z))===W||ue===0&&J.s===W)&&(J=z);return J}function Ie(O,W,ue){for(var z=1,R=W.length;!W[--R];W.pop());for(R=W[0];R>=10;R/=10,z++);return(ue=z+ue*Mi-1)>x?O.c=O.e=null:ue<_?O.c=[O.e=0]:(O.e=ue,O.c=W),O}i=function(){var O=/^(-?)0([xbo])(?=\w[\w.]*$)/i,W=/^([^.]+)\.$/,ue=/^\.([^.]+)$/,z=/^-?(Infinity|NaN)$/,R=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(J,V,U,Y){var ce,re=U?V:V.replace(R,"");if(z.test(re))J.s=isNaN(re)?null:re<0?-1:1;else{if(!U&&(re=re.replace(O,function(Pe,Me,ot){return ce=(ot=ot.toLowerCase())=="x"?16:ot=="b"?2:8,!Y||Y==ce?Me:Pe}),Y&&(ce=Y,re=re.replace(W,"$1").replace(ue,"0.$1")),V!=re))return new G(re,ce);if(G.DEBUG)throw Error(Ua+"Not a"+(Y?" base "+Y:"")+" number: "+V);J.s=null}J.c=J.e=null}}();function nt(O,W,ue,z){var R,J,V,U,Y,ce,re,Pe=O.c,Me=V0;if(Pe){e:{for(R=1,U=Pe[0];U>=10;U/=10,R++);if(J=W-R,J<0)J+=Mi,V=W,Y=Pe[ce=0],re=Ll(Y/Me[R-V-1]%10);else if(ce=q0((J+1)/Mi),ce>=Pe.length)if(z){for(;Pe.length<=ce;Pe.push(0));Y=re=0,R=1,J%=Mi,V=J-Mi+1}else break e;else{for(Y=U=Pe[ce],R=1;U>=10;U/=10,R++);J%=Mi,V=J-Mi+R,re=V<0?0:Ll(Y/Me[R-V-1]%10)}if(z=z||W<0||Pe[ce+1]!=null||(V<0?Y:Y%Me[R-V-1]),z=ue<4?(re||z)&&(ue==0||ue==(O.s<0?3:2)):re>5||re==5&&(ue==4||z||ue==6&&(J>0?V>0?Y/Me[R-V]:0:Pe[ce-1])%10&1||ue==(O.s<0?8:7)),W<1||!Pe[0])return Pe.length=0,z?(W-=O.e+1,Pe[0]=Me[(Mi-W%Mi)%Mi],O.e=-W||0):Pe[0]=O.e=0,O;if(J==0?(Pe.length=ce,U=1,ce--):(Pe.length=ce+1,U=Me[Mi-J],Pe[ce]=V>0?Ll(Y/Me[R-V]%Me[V])*U:0),z)for(;;)if(ce==0){for(J=1,V=Pe[0];V>=10;V/=10,J++);for(V=Pe[0]+=U,U=1;V>=10;V/=10,U++);J!=U&&(O.e++,Pe[0]==Vl&&(Pe[0]=1));break}else{if(Pe[ce]+=U,Pe[ce]!=Vl)break;Pe[ce--]=0,U=1}for(J=Pe.length;Pe[--J]===0;Pe.pop());}O.e>x?O.c=O.e=null:O.e<_&&(O.c=[O.e=0])}return O}function Ve(O){var W,ue=O.e;return ue===null?O.toString():(W=xl(O.c),W=ue<=g||ue>=v?Ad(W,ue):Gu(W,ue,"0"),O.s<0?"-"+W:W)}return r.absoluteValue=r.abs=function(){var O=new G(this);return O.s<0&&(O.s=1),O},r.comparedTo=function(O,W){return qc(this,new G(O,W))},r.decimalPlaces=r.dp=function(O,W){var ue,z,R,J=this;if(O!=null)return Ss(O,0,sl),W==null?W=h:Ss(W,0,8),nt(new G(J),O+J.e+1,W);if(!(ue=J.c))return null;if(z=((R=ue.length-1)-Cl(this.e/Mi))*Mi,R=ue[R])for(;R%10==0;R/=10,z--);return z<0&&(z=0),z},r.dividedBy=r.div=function(O,W){return n(this,new G(O,W),l,h)},r.dividedToIntegerBy=r.idiv=function(O,W){return n(this,new G(O,W),0,1)},r.exponentiatedBy=r.pow=function(O,W){var ue,z,R,J,V,U,Y,ce,re,Pe=this;if(O=new G(O),O.c&&!O.isInteger())throw Error(Ua+"Exponent not an integer: "+Ve(O));if(W!=null&&(W=new G(W)),U=O.e>14,!Pe.c||!Pe.c[0]||Pe.c[0]==1&&!Pe.e&&Pe.c.length==1||!O.c||!O.c[0])return re=new G(Math.pow(+Ve(Pe),U?O.s*(2-Ed(O)):+Ve(O))),W?re.mod(W):re;if(Y=O.s<0,W){if(W.c?!W.c[0]:!W.s)return new G(NaN);z=!Y&&Pe.isInteger()&&W.isInteger(),z&&(Pe=Pe.mod(W))}else{if(O.e>9&&(Pe.e>0||Pe.e<-1||(Pe.e==0?Pe.c[0]>1||U&&Pe.c[1]>=24e7:Pe.c[0]<8e13||U&&Pe.c[0]<=9999975e7)))return J=Pe.s<0&&Ed(O)?-0:0,Pe.e>-1&&(J=1/J),new G(Y?1/J:J);D&&(J=q0(D/Mi+2))}for(U?(ue=new G(.5),Y&&(O.s=1),ce=Ed(O)):(R=Math.abs(+Ve(O)),ce=R%2),re=new G(o);;){if(ce){if(re=re.times(Pe),!re.c)break;J?re.c.length>J&&(re.c.length=J):z&&(re=re.mod(W))}if(R){if(R=Ll(R/2),R===0)break;ce=R%2}else if(O=O.times(ue),nt(O,O.e+1,1),O.e>14)ce=Ed(O);else{if(R=+Ve(O),R===0)break;ce=R%2}Pe=Pe.times(Pe),J?Pe.c&&Pe.c.length>J&&(Pe.c.length=J):z&&(Pe=Pe.mod(W))}return z?re:(Y&&(re=o.div(re)),W?re.mod(W):J?nt(re,D,h,V):re)},r.integerValue=function(O){var W=new G(this);return O==null?O=h:Ss(O,0,8),nt(W,W.e+1,O)},r.isEqualTo=r.eq=function(O,W){return qc(this,new G(O,W))===0},r.isFinite=function(){return!!this.c},r.isGreaterThan=r.gt=function(O,W){return qc(this,new G(O,W))>0},r.isGreaterThanOrEqualTo=r.gte=function(O,W){return(W=qc(this,new G(O,W)))===1||W===0},r.isInteger=function(){return!!this.c&&Cl(this.e/Mi)>this.c.length-2},r.isLessThan=r.lt=function(O,W){return qc(this,new G(O,W))<0},r.isLessThanOrEqualTo=r.lte=function(O,W){return(W=qc(this,new G(O,W)))===-1||W===0},r.isNaN=function(){return!this.s},r.isNegative=function(){return this.s<0},r.isPositive=function(){return this.s>0},r.isZero=function(){return!!this.c&&this.c[0]==0},r.minus=function(O,W){var ue,z,R,J,V=this,U=V.s;if(O=new G(O,W),W=O.s,!U||!W)return new G(NaN);if(U!=W)return O.s=-W,V.plus(O);var Y=V.e/Mi,ce=O.e/Mi,re=V.c,Pe=O.c;if(!Y||!ce){if(!re||!Pe)return re?(O.s=-W,O):new G(Pe?V:NaN);if(!re[0]||!Pe[0])return Pe[0]?(O.s=-W,O):new G(re[0]?V:h==3?-0:0)}if(Y=Cl(Y),ce=Cl(ce),re=re.slice(),U=Y-ce){for((J=U<0)?(U=-U,R=re):(ce=Y,R=Pe),R.reverse(),W=U;W--;R.push(0));R.reverse()}else for(z=(J=(U=re.length)<(W=Pe.length))?U:W,U=W=0;W<z;W++)if(re[W]!=Pe[W]){J=re[W]<Pe[W];break}if(J&&(R=re,re=Pe,Pe=R,O.s=-O.s),W=(z=Pe.length)-(ue=re.length),W>0)for(;W--;re[ue++]=0);for(W=Vl-1;z>U;){if(re[--z]<Pe[z]){for(ue=z;ue&&!re[--ue];re[ue]=W);--re[ue],re[z]+=Vl}re[z]-=Pe[z]}for(;re[0]==0;re.splice(0,1),--ce);return re[0]?Ie(O,re,ce):(O.s=h==3?-1:1,O.c=[O.e=0],O)},r.modulo=r.mod=function(O,W){var ue,z,R=this;return O=new G(O,W),!R.c||!O.s||O.c&&!O.c[0]?new G(NaN):!O.c||R.c&&!R.c[0]?new G(R):(b==9?(z=O.s,O.s=1,ue=n(R,O,0,3),O.s=z,ue.s*=z):ue=n(R,O,0,b),O=R.minus(ue.times(O)),!O.c[0]&&b==1&&(O.s=R.s),O)},r.multipliedBy=r.times=function(O,W){var ue,z,R,J,V,U,Y,ce,re,Pe,Me,ot,X,Ee,B,H=this,he=H.c,te=(O=new G(O,W)).c;if(!he||!te||!he[0]||!te[0])return!H.s||!O.s||he&&!he[0]&&!te||te&&!te[0]&&!he?O.c=O.e=O.s=null:(O.s*=H.s,!he||!te?O.c=O.e=null:(O.c=[0],O.e=0)),O;for(z=Cl(H.e/Mi)+Cl(O.e/Mi),O.s*=H.s,Y=he.length,Pe=te.length,Y<Pe&&(X=he,he=te,te=X,R=Y,Y=Pe,Pe=R),R=Y+Pe,X=[];R--;X.push(0));for(Ee=Vl,B=uc,R=Pe;--R>=0;){for(ue=0,Me=te[R]%B,ot=te[R]/B|0,V=Y,J=R+V;J>R;)ce=he[--V]%B,re=he[V]/B|0,U=ot*ce+re*Me,ce=Me*ce+U%B*B+X[J]+ue,ue=(ce/Ee|0)+(U/B|0)+ot*re,X[J--]=ce%Ee;X[J]=ue}return ue?++z:X.splice(0,1),Ie(O,X,z)},r.negated=function(){var O=new G(this);return O.s=-O.s||null,O},r.plus=function(O,W){var ue,z=this,R=z.s;if(O=new G(O,W),W=O.s,!R||!W)return new G(NaN);if(R!=W)return O.s=-W,z.minus(O);var J=z.e/Mi,V=O.e/Mi,U=z.c,Y=O.c;if(!J||!V){if(!U||!Y)return new G(R/0);if(!U[0]||!Y[0])return Y[0]?O:new G(U[0]?z:R*0)}if(J=Cl(J),V=Cl(V),U=U.slice(),R=J-V){for(R>0?(V=J,ue=Y):(R=-R,ue=U),ue.reverse();R--;ue.push(0));ue.reverse()}for(R=U.length,W=Y.length,R-W<0&&(ue=Y,Y=U,U=ue,W=R),R=0;W;)R=(U[--W]=U[W]+Y[W]+R)/Vl|0,U[W]=Vl===U[W]?0:U[W]%Vl;return R&&(U=[R].concat(U),++V),Ie(O,U,V)},r.precision=r.sd=function(O,W){var ue,z,R,J=this;if(O!=null&&O!==!!O)return Ss(O,1,sl),W==null?W=h:Ss(W,0,8),nt(new G(J),O,W);if(!(ue=J.c))return null;if(R=ue.length-1,z=R*Mi+1,R=ue[R]){for(;R%10==0;R/=10,z--);for(R=ue[0];R>=10;R/=10,z++);}return O&&J.e+1>z&&(z=J.e+1),z},r.shiftedBy=function(O){return Ss(O,-9007199254740991,_y),this.times("1e"+O)},r.squareRoot=r.sqrt=function(){var O,W,ue,z,R,J=this,V=J.c,U=J.s,Y=J.e,ce=l+4,re=new G("0.5");if(U!==1||!V||!V[0])return new G(!U||U<0&&(!V||V[0])?NaN:V?J:1/0);if(U=Math.sqrt(+Ve(J)),U==0||U==1/0?(W=xl(V),(W.length+Y)%2==0&&(W+="0"),U=Math.sqrt(+W),Y=Cl((Y+1)/2)-(Y<0||Y%2),U==1/0?W="5e"+Y:(W=U.toExponential(),W=W.slice(0,W.indexOf("e")+1)+Y),ue=new G(W)):ue=new G(U+""),ue.c[0]){for(Y=ue.e,U=Y+ce,U<3&&(U=0);;)if(R=ue,ue=re.times(R.plus(n(J,R,ce,1))),xl(R.c).slice(0,U)===(W=xl(ue.c)).slice(0,U))if(ue.e<Y&&--U,W=W.slice(U-3,U+1),W=="9999"||!z&&W=="4999"){if(!z&&(nt(R,R.e+l+2,0),R.times(R).eq(J))){ue=R;break}ce+=4,U+=4,z=1}else{(!+W||!+W.slice(1)&&W.charAt(0)=="5")&&(nt(ue,ue.e+l+2,1),O=!ue.times(ue).eq(J));break}}return nt(ue,ue.e+l+1,h,O)},r.toExponential=function(O,W){return O!=null&&(Ss(O,0,sl),O++),me(this,O,W,1)},r.toFixed=function(O,W){return O!=null&&(Ss(O,0,sl),O=O+this.e+1),me(this,O,W)},r.toFormat=function(O,W,ue){var z,R=this;if(ue==null)O!=null&&W&&typeof W=="object"?(ue=W,W=null):O&&typeof O=="object"?(ue=O,O=W=null):ue=$;else if(typeof ue!="object")throw Error(Ua+"Argument not an object: "+ue);if(z=R.toFixed(O,W),R.c){var J,V=z.split("."),U=+ue.groupSize,Y=+ue.secondaryGroupSize,ce=ue.groupSeparator||"",re=V[0],Pe=V[1],Me=R.s<0,ot=Me?re.slice(1):re,X=ot.length;if(Y&&(J=U,U=Y,Y=J,X-=J),U>0&&X>0){for(J=X%U||U,re=ot.substr(0,J);J<X;J+=U)re+=ce+ot.substr(J,U);Y>0&&(re+=ce+ot.slice(J)),Me&&(re="-"+re)}z=Pe?re+(ue.decimalSeparator||"")+((Y=+ue.fractionGroupSize)?Pe.replace(new RegExp("\\d{"+Y+"}\\B","g"),"$&"+(ue.fractionGroupSeparator||"")):Pe):re}return(ue.prefix||"")+z+(ue.suffix||"")},r.toFraction=function(O){var W,ue,z,R,J,V,U,Y,ce,re,Pe,Me,ot=this,X=ot.c;if(O!=null&&(U=new G(O),!U.isInteger()&&(U.c||U.s!==1)||U.lt(o)))throw Error(Ua+"Argument "+(U.isInteger()?"out of range: ":"not an integer: ")+Ve(U));if(!X)return new G(ot);for(W=new G(o),ce=ue=new G(o),z=Y=new G(o),Me=xl(X),J=W.e=Me.length-ot.e-1,W.c[0]=V0[(V=J%Mi)<0?Mi+V:V],O=!O||U.comparedTo(W)>0?J>0?W:ce:U,V=x,x=1/0,U=new G(Me),Y.c[0]=0;re=n(U,W,0,1),R=ue.plus(re.times(z)),R.comparedTo(O)!=1;)ue=z,z=R,ce=Y.plus(re.times(R=ce)),Y=R,W=U.minus(re.times(R=W)),U=R;return R=n(O.minus(ue),z,0,1),Y=Y.plus(R.times(ce)),ue=ue.plus(R.times(z)),Y.s=ce.s=ot.s,J=J*2,Pe=n(ce,z,J,h).minus(ot).abs().comparedTo(n(Y,ue,J,h).minus(ot).abs())<1?[ce,z]:[Y,ue],x=V,Pe},r.toNumber=function(){return+Ve(this)},r.toPrecision=function(O,W){return O!=null&&Ss(O,1,sl),me(this,O,W,2)},r.toString=function(O){var W,ue=this,z=ue.s,R=ue.e;return R===null?z?(W="Infinity",z<0&&(W="-"+W)):W="NaN":(O==null?W=R<=g||R>=v?Ad(xl(ue.c),R):Gu(xl(ue.c),R,"0"):O===10&&F?(ue=nt(new G(ue),l+R+1,h),W=Gu(xl(ue.c),ue.e,"0")):(Ss(O,2,Q.length,"Base"),W=t(Gu(xl(ue.c),R,"0"),10,O,z,!0)),z<0&&ue.c[0]&&(W="-"+W)),W},r.valueOf=r.toJSON=function(){return Ve(this)},r._isBigNumber=!0,r[Symbol.toStringTag]="BigNumber",r[Symbol.for("nodejs.util.inspect.custom")]=r.valueOf,e!=null&&G.set(e),G}function Cl(e){var n=e|0;return e>0||e===n?n:n-1}function xl(e){for(var n,t,i=1,r=e.length,o=e[0]+"";i<r;){for(n=e[i++]+"",t=Mi-n.length;t--;n="0"+n);o+=n}for(r=o.length;o.charCodeAt(--r)===48;);return o.slice(0,r+1||1)}function qc(e,n){var t,i,r=e.c,o=n.c,l=e.s,h=n.s,g=e.e,v=n.e;if(!l||!h)return null;if(t=r&&!r[0],i=o&&!o[0],t||i)return t?i?0:-h:l;if(l!=h)return l;if(t=l<0,i=g==v,!r||!o)return i?0:!r^t?1:-1;if(!i)return g>v^t?1:-1;for(h=(g=r.length)<(v=o.length)?g:v,l=0;l<h;l++)if(r[l]!=o[l])return r[l]>o[l]^t?1:-1;return g==v?0:g>v^t?1:-1}function Ss(e,n,t,i){if(e<n||e>t||e!==Ll(e))throw Error(Ua+(i||"Argument")+(typeof e=="number"?e<n||e>t?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function Ed(e){var n=e.c.length-1;return Cl(e.e/Mi)==n&&e.c[n]%2!=0}function Ad(e,n){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(n<0?"e":"e+")+n}function Gu(e,n,t){var i,r;if(n<0){for(r=t+".";++n;r+=t);e=r+e}else if(i=e.length,++n>i){for(r=t,n-=i;--n;r+=t);e+=r}else n<i&&(e=e.slice(0,n)+"."+e.slice(n));return e}var xu=g4(),Ok=class{constructor(e){Pt(this,"key");Pt(this,"left",null);Pt(this,"right",null);this.key=e}},pf=class extends Ok{constructor(e){super(e)}},Ik=class{constructor(){Pt(this,"size",0);Pt(this,"modificationCount",0);Pt(this,"splayCount",0)}splay(e){const n=this.root;if(n==null)return this.compare(e,e),-1;let t=null,i=null,r=null,o=null,l=n;const h=this.compare;let g;for(;;)if(g=h(l.key,e),g>0){let v=l.left;if(v==null||(g=h(v.key,e),g>0&&(l.left=v.right,v.right=l,l=v,v=l.left,v==null)))break;t==null?i=l:t.left=l,t=l,l=v}else if(g<0){let v=l.right;if(v==null||(g=h(v.key,e),g<0&&(l.right=v.left,v.left=l,l=v,v=l.right,v==null)))break;r==null?o=l:r.right=l,r=l,l=v}else break;return r!=null&&(r.right=l.left,l.left=o),t!=null&&(t.left=l.right,l.right=i),this.root!==l&&(this.root=l,this.splayCount++),g}splayMin(e){let n=e,t=n.left;for(;t!=null;){const i=t;n.left=i.right,i.right=n,n=i,t=n.left}return n}splayMax(e){let n=e,t=n.right;for(;t!=null;){const i=t;n.right=i.left,i.left=n,n=i,t=n.right}return n}_delete(e){if(this.root==null||this.splay(e)!=0)return null;let t=this.root;const i=t,r=t.left;if(this.size--,r==null)this.root=t.right;else{const o=t.right;t=this.splayMax(r),t.right=o,this.root=t}return this.modificationCount++,i}addNewRoot(e,n){this.size++,this.modificationCount++;const t=this.root;if(t==null){this.root=e;return}n<0?(e.left=t,e.right=t.right,t.right=null):(e.right=t,e.left=t.left,t.left=null),this.root=e}_first(){const e=this.root;return e==null?null:(this.root=this.splayMin(e),this.root)}_last(){const e=this.root;return e==null?null:(this.root=this.splayMax(e),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(e){return this.validKey(e)&&this.splay(e)==0}defaultCompare(){return(e,n)=>e<n?-1:e>n?1:0}wrap(){return{getRoot:()=>this.root,setRoot:e=>{this.root=e},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:e=>{this.splayCount=e},splay:e=>this.splay(e),has:e=>this.has(e)}}},Ky,Jy,hp=class xf extends Ik{constructor(t,i){super();Pt(this,"root",null);Pt(this,"compare");Pt(this,"validKey");Pt(this,Ky,"[object Set]");this.compare=t??this.defaultCompare(),this.validKey=i??(r=>r!=null&&r!=null)}delete(t){return this.validKey(t)?this._delete(t)!=null:!1}deleteAll(t){for(const i of t)this.delete(i)}forEach(t){const i=this[Symbol.iterator]();let r;for(;r=i.next(),!r.done;)t(r.value,r.value,this)}add(t){const i=this.splay(t);return i!=0&&this.addNewRoot(new pf(t),i),this}addAndReturn(t){const i=this.splay(t);return i!=0&&this.addNewRoot(new pf(t),i),this.root.key}addAll(t){for(const i of t)this.add(i)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(t){if(t==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(t)<0)return this.root.key;let r=this.root.left;if(r==null)return null;let o=r.right;for(;o!=null;)r=o,o=r.right;return r.key}firstAfter(t){if(t==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(t)>0)return this.root.key;let r=this.root.right;if(r==null)return null;let o=r.left;for(;o!=null;)r=o,o=r.left;return r.key}retainAll(t){const i=new xf(this.compare,this.validKey),r=this.modificationCount;for(const o of t){if(r!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(o)&&this.splay(o)==0&&i.add(this.root.key)}i.size!=this.size&&(this.root=i.root,this.size=i.size,this.modificationCount++)}lookup(t){return!this.validKey(t)||this.splay(t)!=0?null:this.root.key}intersection(t){const i=new xf(this.compare,this.validKey);for(const r of this)t.has(r)&&i.add(r);return i}difference(t){const i=new xf(this.compare,this.validKey);for(const r of this)t.has(r)||i.add(r);return i}union(t){const i=this.clone();return i.addAll(t),i}clone(){const t=new xf(this.compare,this.validKey);return t.size=this.size,t.root=this.copyNode(this.root),t}copyNode(t){if(t==null)return null;function i(o,l){let h,g;do{if(h=o.left,g=o.right,h!=null){const v=new pf(h.key);l.left=v,i(h,v)}if(g!=null){const v=new pf(g.key);l.right=v,o=g,l=v}}while(g!=null)}const r=new pf(t.key);return i(t,r),r}toSet(){return this.clone()}entries(){return new zk(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[(Jy=Symbol.iterator,Ky=Symbol.toStringTag,Jy)](){return new Fk(this.wrap())}},m4=class{constructor(e){Pt(this,"tree");Pt(this,"path",new Array);Pt(this,"modificationCount",null);Pt(this,"splayCount");this.tree=e,this.splayCount=e.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const e=this.path[this.path.length-1];return this.getValue(e)}rebuildPath(e){this.path.splice(0,this.path.length),this.tree.splay(e),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(e){for(;e!=null;)this.path.push(e),e=e.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let t=this.tree.getRoot();for(;t!=null;)this.path.push(t),t=t.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let e=this.path[this.path.length-1],n=e.right;if(n!=null){for(;n!=null;)this.path.push(n),n=n.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===e;)e=this.path.pop();return this.path.length>0}},Fk=class extends m4{getValue(e){return e.key}},zk=class extends m4{getValue(e){return[e.key,e.key]}},v4=e=>()=>e,Bg=e=>{const n=e?(t,i)=>i.minus(t).abs().isLessThanOrEqualTo(e):v4(!1);return(t,i)=>n(t,i)?0:t.comparedTo(i)};function jk(e){const n=e?(t,i,r,o,l)=>t.exponentiatedBy(2).isLessThanOrEqualTo(o.minus(i).exponentiatedBy(2).plus(l.minus(r).exponentiatedBy(2)).times(e)):v4(!1);return(t,i,r)=>{const o=t.x,l=t.y,h=r.x,g=r.y,v=l.minus(g).times(i.x.minus(h)).minus(o.minus(h).times(i.y.minus(g)));return n(v,o,l,h,g)?0:v.comparedTo(0)}}var Uk=e=>e,$k=e=>{if(e){const n=new hp(Bg(e)),t=new hp(Bg(e)),i=(o,l)=>l.addAndReturn(o),r=o=>({x:i(o.x,n),y:i(o.y,t)});return r({x:new xu(0),y:new xu(0)}),r}return Uk},Ng=e=>({set:n=>{Xu=Ng(n)},reset:()=>Ng(e),compare:Bg(e),snap:$k(e),orient:jk(e)}),Xu=Ng(),gf=(e,n)=>e.ll.x.isLessThanOrEqualTo(n.x)&&n.x.isLessThanOrEqualTo(e.ur.x)&&e.ll.y.isLessThanOrEqualTo(n.y)&&n.y.isLessThanOrEqualTo(e.ur.y),Rg=(e,n)=>{if(n.ur.x.isLessThan(e.ll.x)||e.ur.x.isLessThan(n.ll.x)||n.ur.y.isLessThan(e.ll.y)||e.ur.y.isLessThan(n.ll.y))return null;const t=e.ll.x.isLessThan(n.ll.x)?n.ll.x:e.ll.x,i=e.ur.x.isLessThan(n.ur.x)?e.ur.x:n.ur.x,r=e.ll.y.isLessThan(n.ll.y)?n.ll.y:e.ll.y,o=e.ur.y.isLessThan(n.ur.y)?e.ur.y:n.ur.y;return{ll:{x:t,y:r},ur:{x:i,y:o}}},Vd=(e,n)=>e.x.times(n.y).minus(e.y.times(n.x)),y4=(e,n)=>e.x.times(n.x).plus(e.y.times(n.y)),fp=e=>y4(e,e).sqrt(),qk=(e,n,t)=>{const i={x:n.x.minus(e.x),y:n.y.minus(e.y)},r={x:t.x.minus(e.x),y:t.y.minus(e.y)};return Vd(r,i).div(fp(r)).div(fp(i))},Vk=(e,n,t)=>{const i={x:n.x.minus(e.x),y:n.y.minus(e.y)},r={x:t.x.minus(e.x),y:t.y.minus(e.y)};return y4(r,i).div(fp(r)).div(fp(i))},by=(e,n,t)=>n.y.isZero()?null:{x:e.x.plus(n.x.div(n.y).times(t.minus(e.y))),y:t},wy=(e,n,t)=>n.x.isZero()?null:{x:t,y:e.y.plus(n.y.div(n.x).times(t.minus(e.x)))},Gk=(e,n,t,i)=>{if(n.x.isZero())return wy(t,i,e.x);if(i.x.isZero())return wy(e,n,t.x);if(n.y.isZero())return by(t,i,e.y);if(i.y.isZero())return by(e,n,t.y);const r=Vd(n,i);if(r.isZero())return null;const o={x:t.x.minus(e.x),y:t.y.minus(e.y)},l=Vd(o,n).div(r),h=Vd(o,i).div(r),g=e.x.plus(h.times(n.x)),v=t.x.plus(l.times(i.x)),_=e.y.plus(h.times(n.y)),x=t.y.plus(l.times(i.y)),E=g.plus(v).div(2),b=_.plus(x).div(2);return{x:E,y:b}},_u=class _4{constructor(n,t){Pt(this,"point");Pt(this,"isLeft");Pt(this,"segment");Pt(this,"otherSE");Pt(this,"consumedBy");n.events===void 0?n.events=[this]:n.events.push(this),this.point=n,this.isLeft=t}static compare(n,t){const i=_4.comparePoints(n.point,t.point);return i!==0?i:(n.point!==t.point&&n.link(t),n.isLeft!==t.isLeft?n.isLeft?1:-1:dp.compare(n.segment,t.segment))}static comparePoints(n,t){return n.x.isLessThan(t.x)?-1:n.x.isGreaterThan(t.x)?1:n.y.isLessThan(t.y)?-1:n.y.isGreaterThan(t.y)?1:0}link(n){if(n.point===this.point)throw new Error("Tried to link already linked events");const t=n.point.events;for(let i=0,r=t.length;i<r;i++){const o=t[i];this.point.events.push(o),o.point=this.point}this.checkForConsuming()}checkForConsuming(){const n=this.point.events.length;for(let t=0;t<n;t++){const i=this.point.events[t];if(i.segment.consumedBy===void 0)for(let r=t+1;r<n;r++){const o=this.point.events[r];o.consumedBy===void 0&&i.otherSE.point.events===o.otherSE.point.events&&i.segment.consume(o.segment)}}}getAvailableLinkedEvents(){const n=[];for(let t=0,i=this.point.events.length;t<i;t++){const r=this.point.events[t];r!==this&&!r.segment.ringOut&&r.segment.isInResult()&&n.push(r)}return n}getLeftmostComparator(n){const t=new Map,i=r=>{const o=r.otherSE;t.set(r,{sine:qk(this.point,n.point,o.point),cosine:Vk(this.point,n.point,o.point)})};return(r,o)=>{t.has(r)||i(r),t.has(o)||i(o);const{sine:l,cosine:h}=t.get(r),{sine:g,cosine:v}=t.get(o);return l.isGreaterThanOrEqualTo(0)&&g.isGreaterThanOrEqualTo(0)?h.isLessThan(v)?1:h.isGreaterThan(v)?-1:0:l.isLessThan(0)&&g.isLessThan(0)?h.isLessThan(v)?-1:h.isGreaterThan(v)?1:0:g.isLessThan(l)?-1:g.isGreaterThan(l)?1:0}}},Hk=class Dg{constructor(n){Pt(this,"events");Pt(this,"poly");Pt(this,"_isExteriorRing");Pt(this,"_enclosingRing");this.events=n;for(let t=0,i=n.length;t<i;t++)n[t].segment.ringOut=this;this.poly=null}static factory(n){const t=[];for(let i=0,r=n.length;i<r;i++){const o=n[i];if(!o.isInResult()||o.ringOut)continue;let l=null,h=o.leftSE,g=o.rightSE;const v=[h],_=h.point,x=[];for(;l=h,h=g,v.push(h),h.point!==_;)for(;;){const E=h.getAvailableLinkedEvents();if(E.length===0){const $=v[0].point,Q=v[v.length-1].point;throw new Error(`Unable to complete output ring starting at [${$.x}, ${$.y}]. Last matching segment found ends at [${Q.x}, ${Q.y}].`)}if(E.length===1){g=E[0].otherSE;break}let b=null;for(let $=0,Q=x.length;$<Q;$++)if(x[$].point===h.point){b=$;break}if(b!==null){const $=x.splice(b)[0],Q=v.splice($.index);Q.unshift(Q[0].otherSE),t.push(new Dg(Q.reverse()));continue}x.push({index:v.length,point:h.point});const D=h.getLeftmostComparator(l);g=E.sort(D)[0].otherSE;break}t.push(new Dg(v))}return t}getGeom(){let n=this.events[0].point;const t=[n];for(let v=1,_=this.events.length-1;v<_;v++){const x=this.events[v].point,E=this.events[v+1].point;Xu.orient(x,n,E)!==0&&(t.push(x),n=x)}if(t.length===1)return null;const i=t[0],r=t[1];Xu.orient(i,n,r)===0&&t.shift(),t.push(t[0]);const o=this.isExteriorRing()?1:-1,l=this.isExteriorRing()?0:t.length-1,h=this.isExteriorRing()?t.length:-1,g=[];for(let v=l;v!=h;v+=o)g.push([t[v].x.toNumber(),t[v].y.toNumber()]);return g}isExteriorRing(){if(this._isExteriorRing===void 0){const n=this.enclosingRing();this._isExteriorRing=n?!n.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var r,o;let n=this.events[0];for(let l=1,h=this.events.length;l<h;l++){const g=this.events[l];_u.compare(n,g)>0&&(n=g)}let t=n.segment.prevInResult(),i=t?t.prevInResult():null;for(;;){if(!t)return null;if(!i)return t.ringOut;if(i.ringOut!==t.ringOut)return((r=i.ringOut)==null?void 0:r.enclosingRing())!==t.ringOut?t.ringOut:(o=t.ringOut)==null?void 0:o.enclosingRing();t=i.prevInResult(),i=t?t.prevInResult():null}}},xy=class{constructor(e){Pt(this,"exteriorRing");Pt(this,"interiorRings");this.exteriorRing=e,e.poly=this,this.interiorRings=[]}addInterior(e){this.interiorRings.push(e),e.poly=this}getGeom(){const e=this.exteriorRing.getGeom();if(e===null)return null;const n=[e];for(let t=0,i=this.interiorRings.length;t<i;t++){const r=this.interiorRings[t].getGeom();r!==null&&n.push(r)}return n}},Wk=class{constructor(e){Pt(this,"rings");Pt(this,"polys");this.rings=e,this.polys=this._composePolys(e)}getGeom(){const e=[];for(let n=0,t=this.polys.length;n<t;n++){const i=this.polys[n].getGeom();i!==null&&e.push(i)}return e}_composePolys(e){var t;const n=[];for(let i=0,r=e.length;i<r;i++){const o=e[i];if(!o.poly)if(o.isExteriorRing())n.push(new xy(o));else{const l=o.enclosingRing();l!=null&&l.poly||n.push(new xy(l)),(t=l==null?void 0:l.poly)==null||t.addInterior(o)}}return n}},Zk=class{constructor(e,n=dp.compare){Pt(this,"queue");Pt(this,"tree");Pt(this,"segments");this.queue=e,this.tree=new hp(n),this.segments=[]}process(e){const n=e.segment,t=[];if(e.consumedBy)return e.isLeft?this.queue.delete(e.otherSE):this.tree.delete(n),t;e.isLeft&&this.tree.add(n);let i=n,r=n;do i=this.tree.lastBefore(i);while(i!=null&&i.consumedBy!=null);do r=this.tree.firstAfter(r);while(r!=null&&r.consumedBy!=null);if(e.isLeft){let o=null;if(i){const h=i.getIntersection(n);if(h!==null&&(n.isAnEndpoint(h)||(o=h),!i.isAnEndpoint(h))){const g=this._splitSafely(i,h);for(let v=0,_=g.length;v<_;v++)t.push(g[v])}}let l=null;if(r){const h=r.getIntersection(n);if(h!==null&&(n.isAnEndpoint(h)||(l=h),!r.isAnEndpoint(h))){const g=this._splitSafely(r,h);for(let v=0,_=g.length;v<_;v++)t.push(g[v])}}if(o!==null||l!==null){let h=null;o===null?h=l:l===null?h=o:h=_u.comparePoints(o,l)<=0?o:l,this.queue.delete(n.rightSE),t.push(n.rightSE);const g=n.split(h);for(let v=0,_=g.length;v<_;v++)t.push(g[v])}t.length>0?(this.tree.delete(n),t.push(e)):(this.segments.push(n),n.prev=i)}else{if(i&&r){const o=i.getIntersection(r);if(o!==null){if(!i.isAnEndpoint(o)){const l=this._splitSafely(i,o);for(let h=0,g=l.length;h<g;h++)t.push(l[h])}if(!r.isAnEndpoint(o)){const l=this._splitSafely(r,o);for(let h=0,g=l.length;h<g;h++)t.push(l[h])}}}this.tree.delete(n)}return t}_splitSafely(e,n){this.tree.delete(e);const t=e.rightSE;this.queue.delete(t);const i=e.split(n);return i.push(t),e.consumedBy===void 0&&this.tree.add(e),i}},Kk=class{constructor(){Pt(this,"type");Pt(this,"numMultiPolys")}run(e,n,t){Lf.type=e;const i=[new Cy(n,!0)];for(let v=0,_=t.length;v<_;v++)i.push(new Cy(t[v],!1));if(Lf.numMultiPolys=i.length,Lf.type==="difference"){const v=i[0];let _=1;for(;_<i.length;)Rg(i[_].bbox,v.bbox)!==null?_++:i.splice(_,1)}if(Lf.type==="intersection")for(let v=0,_=i.length;v<_;v++){const x=i[v];for(let E=v+1,b=i.length;E<b;E++)if(Rg(x.bbox,i[E].bbox)===null)return[]}const r=new hp(_u.compare);for(let v=0,_=i.length;v<_;v++){const x=i[v].getSweepEvents();for(let E=0,b=x.length;E<b;E++)r.add(x[E])}const o=new Zk(r);let l=null;for(r.size!=0&&(l=r.first(),r.delete(l));l;){const v=o.process(l);for(let _=0,x=v.length;_<x;_++){const E=v[_];E.consumedBy===void 0&&r.add(E)}r.size!=0?(l=r.first(),r.delete(l)):l=null}Xu.reset();const h=Hk.factory(o.segments);return new Wk(h).getGeom()}},Lf=new Kk,Og=Lf,Jk=0,dp=class Gd{constructor(n,t,i,r){Pt(this,"id");Pt(this,"leftSE");Pt(this,"rightSE");Pt(this,"rings");Pt(this,"windings");Pt(this,"ringOut");Pt(this,"consumedBy");Pt(this,"prev");Pt(this,"_prevInResult");Pt(this,"_beforeState");Pt(this,"_afterState");Pt(this,"_isInResult");this.id=++Jk,this.leftSE=n,n.segment=this,n.otherSE=t,this.rightSE=t,t.segment=this,t.otherSE=n,this.rings=i,this.windings=r}static compare(n,t){const i=n.leftSE.point.x,r=t.leftSE.point.x,o=n.rightSE.point.x,l=t.rightSE.point.x;if(l.isLessThan(i))return 1;if(o.isLessThan(r))return-1;const h=n.leftSE.point.y,g=t.leftSE.point.y,v=n.rightSE.point.y,_=t.rightSE.point.y;if(i.isLessThan(r)){if(g.isLessThan(h)&&g.isLessThan(v))return 1;if(g.isGreaterThan(h)&&g.isGreaterThan(v))return-1;const x=n.comparePoint(t.leftSE.point);if(x<0)return 1;if(x>0)return-1;const E=t.comparePoint(n.rightSE.point);return E!==0?E:-1}if(i.isGreaterThan(r)){if(h.isLessThan(g)&&h.isLessThan(_))return-1;if(h.isGreaterThan(g)&&h.isGreaterThan(_))return 1;const x=t.comparePoint(n.leftSE.point);if(x!==0)return x;const E=n.comparePoint(t.rightSE.point);return E<0?1:E>0?-1:1}if(h.isLessThan(g))return-1;if(h.isGreaterThan(g))return 1;if(o.isLessThan(l)){const x=t.comparePoint(n.rightSE.point);if(x!==0)return x}if(o.isGreaterThan(l)){const x=n.comparePoint(t.rightSE.point);if(x<0)return 1;if(x>0)return-1}if(!o.eq(l)){const x=v.minus(h),E=o.minus(i),b=_.minus(g),D=l.minus(r);if(x.isGreaterThan(E)&&b.isLessThan(D))return 1;if(x.isLessThan(E)&&b.isGreaterThan(D))return-1}return o.isGreaterThan(l)?1:o.isLessThan(l)||v.isLessThan(_)?-1:v.isGreaterThan(_)?1:n.id<t.id?-1:n.id>t.id?1:0}static fromRing(n,t,i){let r,o,l;const h=_u.comparePoints(n,t);if(h<0)r=n,o=t,l=1;else if(h>0)r=t,o=n,l=-1;else throw new Error(`Tried to create degenerate segment at [${n.x}, ${n.y}]`);const g=new _u(r,!0),v=new _u(o,!1);return new Gd(g,v,[i],[l])}replaceRightSE(n){this.rightSE=n,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const n=this.leftSE.point.y,t=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:n.isLessThan(t)?n:t},ur:{x:this.rightSE.point.x,y:n.isGreaterThan(t)?n:t}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(n){return n.x.eq(this.leftSE.point.x)&&n.y.eq(this.leftSE.point.y)||n.x.eq(this.rightSE.point.x)&&n.y.eq(this.rightSE.point.y)}comparePoint(n){return Xu.orient(this.leftSE.point,n,this.rightSE.point)}getIntersection(n){const t=this.bbox(),i=n.bbox(),r=Rg(t,i);if(r===null)return null;const o=this.leftSE.point,l=this.rightSE.point,h=n.leftSE.point,g=n.rightSE.point,v=gf(t,h)&&this.comparePoint(h)===0,_=gf(i,o)&&n.comparePoint(o)===0,x=gf(t,g)&&this.comparePoint(g)===0,E=gf(i,l)&&n.comparePoint(l)===0;if(_&&v)return E&&!x?l:!E&&x?g:null;if(_)return x&&o.x.eq(g.x)&&o.y.eq(g.y)?null:o;if(v)return E&&l.x.eq(h.x)&&l.y.eq(h.y)?null:h;if(E&&x)return null;if(E)return l;if(x)return g;const b=Gk(o,this.vector(),h,n.vector());return b===null||!gf(r,b)?null:Xu.snap(b)}split(n){const t=[],i=n.events!==void 0,r=new _u(n,!0),o=new _u(n,!1),l=this.rightSE;this.replaceRightSE(o),t.push(o),t.push(r);const h=new Gd(r,l,this.rings.slice(),this.windings.slice());return _u.comparePoints(h.leftSE.point,h.rightSE.point)>0&&h.swapEvents(),_u.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),i&&(r.checkForConsuming(),o.checkForConsuming()),t}swapEvents(){const n=this.rightSE;this.rightSE=this.leftSE,this.leftSE=n,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let t=0,i=this.windings.length;t<i;t++)this.windings[t]*=-1}consume(n){let t=this,i=n;for(;t.consumedBy;)t=t.consumedBy;for(;i.consumedBy;)i=i.consumedBy;const r=Gd.compare(t,i);if(r!==0){if(r>0){const o=t;t=i,i=o}if(t.prev===i){const o=t;t=i,i=o}for(let o=0,l=i.rings.length;o<l;o++){const h=i.rings[o],g=i.windings[o],v=t.rings.indexOf(h);v===-1?(t.rings.push(h),t.windings.push(g)):t.windings[v]+=g}i.rings=null,i.windings=null,i.consumedBy=t,i.leftSE.consumedBy=t.leftSE,i.rightSE.consumedBy=t.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const n=this.prev.consumedBy||this.prev;this._beforeState=n.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const n=this.beforeState();this._afterState={rings:n.rings.slice(0),windings:n.windings.slice(0),multiPolys:[]};const t=this._afterState.rings,i=this._afterState.windings,r=this._afterState.multiPolys;for(let h=0,g=this.rings.length;h<g;h++){const v=this.rings[h],_=this.windings[h],x=t.indexOf(v);x===-1?(t.push(v),i.push(_)):i[x]+=_}const o=[],l=[];for(let h=0,g=t.length;h<g;h++){if(i[h]===0)continue;const v=t[h],_=v.poly;if(l.indexOf(_)===-1)if(v.isExterior)o.push(_);else{l.indexOf(_)===-1&&l.push(_);const x=o.indexOf(v.poly);x!==-1&&o.splice(x,1)}}for(let h=0,g=o.length;h<g;h++){const v=o[h].multiPoly;r.indexOf(v)===-1&&r.push(v)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const n=this.beforeState().multiPolys,t=this.afterState().multiPolys;switch(Og.type){case"union":{const i=n.length===0,r=t.length===0;this._isInResult=i!==r;break}case"intersection":{let i,r;n.length<t.length?(i=n.length,r=t.length):(i=t.length,r=n.length),this._isInResult=r===Og.numMultiPolys&&i<r;break}case"xor":{const i=Math.abs(n.length-t.length);this._isInResult=i%2===1;break}case"difference":{const i=r=>r.length===1&&r[0].isSubject;this._isInResult=i(n)!==i(t);break}}return this._isInResult}},Ly=class{constructor(e,n,t){Pt(this,"poly");Pt(this,"isExterior");Pt(this,"segments");Pt(this,"bbox");if(!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=t,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const i=Xu.snap({x:new xu(e[0][0]),y:new xu(e[0][1])});this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};let r=i;for(let o=1,l=e.length;o<l;o++){if(typeof e[o][0]!="number"||typeof e[o][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const h=Xu.snap({x:new xu(e[o][0]),y:new xu(e[o][1])});h.x.eq(r.x)&&h.y.eq(r.y)||(this.segments.push(dp.fromRing(r,h,this)),h.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=h.x),h.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=h.y),h.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=h.x),h.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=h.y),r=h)}(!i.x.eq(r.x)||!i.y.eq(r.y))&&this.segments.push(dp.fromRing(r,i,this))}getSweepEvents(){const e=[];for(let n=0,t=this.segments.length;n<t;n++){const i=this.segments[n];e.push(i.leftSE),e.push(i.rightSE)}return e}},Yk=class{constructor(e,n){Pt(this,"multiPoly");Pt(this,"exteriorRing");Pt(this,"interiorRings");Pt(this,"bbox");if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Ly(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let t=1,i=e.length;t<i;t++){const r=new Ly(e[t],this,!1);r.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=r.bbox.ll.x),r.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=r.bbox.ll.y),r.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=r.bbox.ur.x),r.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=r.bbox.ur.y),this.interiorRings.push(r)}this.multiPoly=n}getSweepEvents(){const e=this.exteriorRing.getSweepEvents();for(let n=0,t=this.interiorRings.length;n<t;n++){const i=this.interiorRings[n].getSweepEvents();for(let r=0,o=i.length;r<o;r++)e.push(i[r])}return e}},Cy=class{constructor(e,n){Pt(this,"isSubject");Pt(this,"polys");Pt(this,"bbox");if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:new xu(Number.POSITIVE_INFINITY),y:new xu(Number.POSITIVE_INFINITY)},ur:{x:new xu(Number.NEGATIVE_INFINITY),y:new xu(Number.NEGATIVE_INFINITY)}};for(let t=0,i=e.length;t<i;t++){const r=new Yk(e[t],this);r.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=r.bbox.ll.x),r.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=r.bbox.ll.y),r.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=r.bbox.ur.x),r.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=r.bbox.ur.y),this.polys.push(r)}this.isSubject=n}getSweepEvents(){const e=[];for(let n=0,t=this.polys.length;n<t;n++){const i=this.polys[n].getSweepEvents();for(let r=0,o=i.length;r<o;r++)e.push(i[r])}return e}},Xk=(e,...n)=>Og.run("intersection",e,n);Xu.set;function Qk(e,n){var t,i,r,o,l,h,g,v,_,x,E=0,b=e.type==="FeatureCollection",D=e.type==="Feature",$=b?e.features.length:1;for(t=0;t<$;t++){for(h=b?e.features[t].geometry:D?e.geometry:e,v=b?e.features[t].properties:D?e.properties:{},_=b?e.features[t].bbox:D?e.bbox:void 0,x=b?e.features[t].id:D?e.id:void 0,g=h?h.type==="GeometryCollection":!1,l=g?h.geometries.length:1,r=0;r<l;r++){if(o=g?h.geometries[r]:h,o===null){if(n(null,E,v,_,x)===!1)return!1;continue}switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(n(o,E,v,_,x)===!1)return!1;break}case"GeometryCollection":{for(i=0;i<o.geometries.length;i++)if(n(o.geometries[i],E,v,_,x)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}E++}}function e8(e,n={}){const t=[];if(Qk(e,r=>{t.push(r.coordinates)}),t.length<2)throw new Error("Must specify at least 2 geometries");const i=Xk(t[0],...t.slice(1));return i.length===0?null:i.length===1?Sl(i[0],n.properties):wk(i,n.properties)}var t8=e8;function b4(e,n,t){if(e!==null)for(var i,r,o,l,h,g,v,_=0,x=0,E,b=e.type,D=b==="FeatureCollection",$=b==="Feature",Q=D?e.features.length:1,F=0;F<Q;F++){v=D?e.features[F].geometry:$?e.geometry:e,E=v?v.type==="GeometryCollection":!1,h=E?v.geometries.length:1;for(var G=0;G<h;G++){var me=0,Se=0;if(l=E?v.geometries[G]:v,l!==null){g=l.coordinates;var Ie=l.type;switch(_=0,Ie){case null:break;case"Point":if(n(g,x,F,me,Se)===!1)return!1;x++,me++;break;case"LineString":case"MultiPoint":for(i=0;i<g.length;i++){if(n(g[i],x,F,me,Se)===!1)return!1;x++,Ie==="MultiPoint"&&me++}Ie==="LineString"&&me++;break;case"Polygon":case"MultiLineString":for(i=0;i<g.length;i++){for(r=0;r<g[i].length-_;r++){if(n(g[i][r],x,F,me,Se)===!1)return!1;x++}Ie==="MultiLineString"&&me++,Ie==="Polygon"&&Se++}Ie==="Polygon"&&me++;break;case"MultiPolygon":for(i=0;i<g.length;i++){for(Se=0,r=0;r<g[i].length;r++){for(o=0;o<g[i][r].length-_;o++){if(n(g[i][r][o],x,F,me,Se)===!1)return!1;x++}Se++}me++}break;case"GeometryCollection":for(i=0;i<l.geometries.length;i++)if(b4(l.geometries[i],n)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function n8(e,n){var t,i,r,o,l,h,g,v,_,x,E=0,b=e.type==="FeatureCollection",D=e.type==="Feature",$=b?e.features.length:1;for(t=0;t<$;t++){for(h=b?e.features[t].geometry:D?e.geometry:e,v=b?e.features[t].properties:D?e.properties:{},_=b?e.features[t].bbox:D?e.bbox:void 0,x=b?e.features[t].id:D?e.id:void 0,g=h?h.type==="GeometryCollection":!1,l=g?h.geometries.length:1,r=0;r<l;r++){if(o=g?h.geometries[r]:h,o===null){if(n(null,E,v,_,x)===!1)return!1;continue}switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(n(o,E,v,_,x)===!1)return!1;break}case"GeometryCollection":{for(i=0;i<o.geometries.length;i++)if(n(o.geometries[i],E,v,_,x)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}E++}}function i8(e,n){n8(e,function(t,i,r,o,l){var h=t===null?null:t.type;switch(h){case null:case"Point":case"LineString":case"Polygon":return n(Wh(t,r,{bbox:o,id:l}),i,0)===!1?!1:void 0}var g;switch(h){case"MultiPoint":g="Point";break;case"MultiLineString":g="LineString";break;case"MultiPolygon":g="Polygon";break}for(var v=0;v<t.coordinates.length;v++){var _=t.coordinates[v],x={type:g,coordinates:_};if(n(Wh(x,r),i,v)===!1)return!1}})}function r8(e,n){i8(e,function(t,i,r){var o=0;if(t.geometry){var l=t.geometry.type;if(!(l==="Point"||l==="MultiPoint")){var h,g=0,v=0,_=0;if(b4(t,function(x,E,b,D,$){if(h===void 0||i>g||D>v||$>_){h=x,g=i,v=D,_=$,o=0;return}var Q=Pl([h,x],t.properties);if(n(Q,i,r,$,o)===!1)return!1;o++,h=x})===!1)return!1}}})}function s8(e,n,t){var i=t,r=!1;return r8(e,function(o,l,h,g,v){r===!1&&t===void 0?i=o:i=n(i,o,l,h,g,v),r=!0}),i}function pp(e,n={}){return s8(e,(t,i)=>{const r=i.geometry.coordinates;return t+xm(r[0],r[1],n)},0)}var Vc=pp;class zh extends hn.Polygon{constructor(t,i={}){super(t,{...i,pmIgnore:!1,interactive:!0});Pt(this,"properties");this.properties=Ct.measure("Polygon.constructor.initProperties",()=>({type:"Polygon",style:{color:i.color||"#3388ff",weight:i.weight||3,opacity:i.opacity||1,fillColor:i.fillColor||"#3388ff",fillOpacity:i.fillOpacity||.2,dashArray:i.dashArray||"",name:i.name||""}})),this.updateProperties(),this.on({add:()=>this.updateProperties(),edit:()=>this.updateProperties(),drag:()=>this.updateProperties()})}updateProperties(){Ct.measure("Polygon.updateProperties",()=>{var t,i,r;try{const o=this.getLatLngs()[0];if(!o||o.length<3){console.warn("Polygon has less than 3 points, cannot calculate properties");return}const l=o.map(b=>[b.lng,b.lat]);l.push(l[0]);const h=Sl([l]),g=d4(h),v=pp(Pl([...l]),{units:"meters"}),_=Df(h),x=hn.latLng(_.geometry.coordinates[1],_.geometry.coordinates[0]),E=((i=(t=this.properties)==null?void 0:t.style)==null?void 0:i.name)||"";this.properties={type:"Polygon",coordinates:o.map(b=>({lat:b.lat,lng:b.lng})),surface:g,perimeter:v,center:{lat:x.lat,lng:x.lng},vertices:o.length,style:{...this.options,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#3388ff",fillOpacity:this.options.fillOpacity||.2,dashArray:((r=this.options)==null?void 0:r.dashArray)||"",name:E}},this.fire("properties:updated",{shape:this,properties:this.properties})}catch(o){console.error("Failed to calculate polygon properties",o)}})}setName(t){Ct.measure("Polygon.setName",()=>{this.properties.style||(this.properties.style={}),this.properties.style.name=t,this.fire("properties:updated",{shape:this,properties:this.properties})})}getName(){return Ct.measure("Polygon.getName",()=>{var t,i;return((i=(t=this.properties)==null?void 0:t.style)==null?void 0:i.name)||""})}setLatLngs(t){return Ct.measure("Polygon.setLatLngs",()=>(super.setLatLngs(t),this.updateProperties(),this))}getMidPoints(){return Ct.measure("Polygon.getMidPoints",()=>{const t=this.getLatLngs()[0],i=[];if(t.length<2)return i;for(let r=0;r<t.length;r++){const o=t[r],l=t[(r+1)%t.length];i.push(hn.latLng((o.lat+l.lat)/2,(o.lng+l.lng)/2))}return i})}moveVertex(t,i){Ct.measure("Polygon.moveVertex",()=>{const r=this.getLatLngs()[0];t>=0&&t<r.length&&(r[t]=i,hn.Polygon.prototype.setLatLngs.call(this,[r]))})}addVertex(t,i){Ct.measure("Polygon.addVertex",()=>{const r=this.getLatLngs()[0];t>=0&&t<r.length&&(r.splice((t+1)%r.length,0,i),hn.Polygon.prototype.setLatLngs.call(this,[r]))})}move(t){return Ct.measure("Polygon.move",()=>{const r=this.getLatLngs()[0].map(o=>hn.latLng(o.lat+t.lat,o.lng+t.lng));return hn.Polygon.prototype.setLatLngs.call(this,[r]),this})}getCenter(){return Ct.measure("Polygon.getCenter",()=>{const t=this.getLatLngs()[0];if(!t||t.length===0)return new hn.LatLng(0,0);try{const i=t.filter(v=>v&&typeof v.lat=="number"&&typeof v.lng=="number"&&!isNaN(v.lat)&&!isNaN(v.lng)&&Math.abs(v.lat)<=90&&Math.abs(v.lng)<=180);if(i.length===0)return console.warn("Aucun point valide dans le polygone pour calculer le centre"),new hn.LatLng(0,0);const r=i.map(v=>[v.lng,v.lat]);r.push(r[0]);const o=Sl([r]),l=Df(o),h=l.geometry.coordinates[1],g=l.geometry.coordinates[0];if(typeof h!="number"||typeof g!="number"||isNaN(h)||isNaN(g)||Math.abs(h)>90||Math.abs(g)>180)throw new Error("Centroid calculé invalide");return hn.latLng(h,g)}catch(i){console.warn("Erreur lors du calcul du centroïde avec turf.js, utilisation de la méthode simple",i);let r=0,o=0,l=0;for(const h of t)h&&typeof h.lat=="number"&&typeof h.lng=="number"&&!isNaN(h.lat)&&!isNaN(h.lng)&&Math.abs(h.lat)<=90&&Math.abs(h.lng)<=180&&(r+=h.lat,o+=h.lng,l++);return l===0?(console.error("Impossible de calculer un centre valide pour le polygone"),new hn.LatLng(0,0)):new hn.LatLng(r/l,o/l)}})}getSegmentLengths(){return Ct.measure("Polygon.getSegmentLengths",()=>{const t=this.getLatLngs()[0],i=[];if(t.length<2)return i;for(let r=0;r<t.length;r++){const o=t[r],l=t[(r+1)%t.length];i.push(o.distanceTo(l))}return i})}}class Lo extends hn.Polyline{constructor(t,i={}){super(t,{...i,pmIgnore:!1,interactive:!0});Pt(this,"properties");Pt(this,"cachedProperties",{});Pt(this,"needsUpdate",!0);this.properties=Ct.measure("Line.constructor.initProperties",()=>({type:"Line",style:{...i||{},name:i.name||""}})),this.updateProperties(),this.on("add",()=>{this.updateProperties()})}updateProperties(){Ct.measure("Line.updateProperties",()=>{var r,o,l;const t=this.getLatLngs();if(!t||t.length<2){console.warn("Line has less than 2 points, cannot calculate properties");return}const i=t.map(h=>[h.lng,h.lat]);try{const h=Pl(i),g=pp(h,{units:"meters"});let v;if(t.length===2)v=hn.latLng((t[0].lat+t[1].lat)/2,(t[0].lng+t[1].lng)/2);else{const E=Tg(h,g/2,{units:"meters"});v=hn.latLng(E.geometry.coordinates[1],E.geometry.coordinates[0])}const _=10,x=((o=(r=this.properties)==null?void 0:r.style)==null?void 0:o.name)||"";this.properties={type:"Line",length:g,coordinates:t.map(E=>({lat:E.lat,lng:E.lng})),center:{lat:v.lat,lng:v.lng},vertices:t.length,surfaceInfluence:g*_,dimensions:{width:_},style:{...this.options,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,dashArray:((l=this.options)==null?void 0:l.dashArray)||"",name:x}},this.cachedProperties.length=g,this.cachedProperties.center=v,this.cachedProperties.midPoints=void 0,this.cachedProperties.segmentLengths=void 0,this.needsUpdate=!1,this.fire("properties:updated",{shape:this,properties:this.properties})}catch(h){console.error("Failed to calculate line properties",h)}})}setName(t){Ct.measure("Line.setName",()=>{this.properties.style||(this.properties.style={}),this.properties.style.name=t,this.fire("properties:updated",{shape:this,properties:this.properties})})}getName(){return Ct.measure("Line.getName",()=>{var t,i;return((i=(t=this.properties)==null?void 0:t.style)==null?void 0:i.name)||""})}invalidateCache(){Ct.measure("Line.invalidateCache",()=>{this.needsUpdate=!0,this.cachedProperties={}})}setLatLngs(t){return super.setLatLngs(t),this.needsUpdate=!0,this.cachedProperties={},this.fire("latlngs:updated",{latlngs:this.getLatLngs()}),this}getMidPoints(){return Ct.measure("Line.getMidPoints",()=>{if(!this.needsUpdate&&this.cachedProperties.midPoints)return this.cachedProperties.midPoints;const t=this.getLatLngs(),i=[];if(t.length<2)return i;for(let r=0;r<t.length-1;r++){const o=t[r],l=t[r+1];if(!o||!l){console.warn("Points invalides détectés pour le segment",r);continue}i.push(hn.latLng((o.lat+l.lat)/2,(o.lng+l.lng)/2))}return this.cachedProperties.midPoints=i,i})}getMidPointAt(t){return Ct.measure("Line.getMidPointAt",()=>{const i=this.getLatLngs();if(t<0||t>=i.length-1||i.length<2)return null;const r=i[t],o=i[t+1];return!r||!o?(console.warn("Points invalides pour calcul du midpoint au segment",t),null):hn.latLng((r.lat+o.lat)/2,(r.lng+o.lng)/2)})}moveVertex(t,i,r=!1){Ct.measure("Line.moveVertex",()=>{const o=this.getLatLngs();t>=0&&t<o.length&&(o[t]=i,this.setLatLngs(o),this.needsUpdate=!0,this.cachedProperties={},this.fire("vertex:moved",{index:t,latlng:i,allPoints:o}),r&&this.updateProperties())})}addVertex(t,i,r=!1){Ct.measure("Line.addVertex",()=>{const o=this.getLatLngs();t>=0&&t<o.length-1&&(o.splice(t+1,0,i),hn.Polyline.prototype.setLatLngs.call(this,o),this.needsUpdate=!0,this.cachedProperties.midPoints=void 0,this.cachedProperties.segmentLengths=void 0,this.cachedProperties.center=void 0,this.cachedProperties.length=void 0,r&&this.updateProperties())})}move(t,i=!0){return Ct.measure("Line.move",()=>{this.fire("move:start");const r=this.getLatLngs(),o=r.map(l=>hn.latLng(l.lat+t.lat,l.lng+t.lng));return this.setLatLngs(o),this.needsUpdate=!0,this.cachedProperties={},this.fire("move",{delta:t,newPositions:o,oldPositions:r}),i&&(this.updateProperties(),this.fire("properties:updated",{shape:this,properties:this.properties}),this.fire("move:end")),this})}getCenter(){return Ct.measure("Line.getCenter",()=>{if(!this.needsUpdate&&this.cachedProperties.center)return this.cachedProperties.center;const t=this.getLatLngs();if(t.length<2)return t[0]||new hn.LatLng(0,0);try{const i=t.map(g=>[g.lng,g.lat]),r=Pl(i),o=pp(r,{units:"meters"}),l=Tg(r,o/2,{units:"meters"}),h=hn.latLng(l.geometry.coordinates[1],l.geometry.coordinates[0]);return this.cachedProperties.center=h,h}catch(i){console.warn("Error calculating line center with turf.js, using simple method",i);const r=t.reduce((h,g)=>h+g.lat,0)/t.length,o=t.reduce((h,g)=>h+g.lng,0)/t.length,l=new hn.LatLng(r,o);return this.cachedProperties.center=l,l}})}getSegmentLengths(){return Ct.measure("Line.getSegmentLengths",()=>{if(!this.needsUpdate&&this.cachedProperties.segmentLengths)return this.cachedProperties.segmentLengths;const t=this.getLatLngs(),i=[];if(t.length<2)return i;for(let r=0;r<t.length-1;r++){const o=t[r],l=t[r+1];i.push(o.distanceTo(l))}return this.cachedProperties.segmentLengths=i,i})}getSegmentLengthAt(t){return Ct.measure("Line.getSegmentLengthAt",()=>{const i=this.getLatLngs();if(t<0||t>=i.length-1||i.length<2)return 0;const r=i[t],o=i[t+1];return r.distanceTo(o)})}getLengthToVertex(t){return Ct.measure("Line.getLengthToVertex",()=>{const i=this.getLatLngs();let r=0;if(t<=0||i.length<2)return 0;for(let o=0;o<Math.min(t,i.length-1);o++)r+=i[o].distanceTo(i[o+1]);return r})}getLength(){return Ct.measure("Line.getLength",()=>{if(!this.needsUpdate&&this.cachedProperties.length)return this.cachedProperties.length;const t=this.getLatLngs();let i=0;for(let r=0;r<t.length-1;r++)i+=t[r].distanceTo(t[r+1]);return this.cachedProperties.length=i,i})}}const wa=class wa extends Lo{constructor(t,i={}){super(t,{...i,color:"#FF4500",weight:4,opacity:.8,interactive:!1,pmIgnore:!0});Pt(this,"elevationData",[]);Pt(this,"elevationProfile",null);Pt(this,"elevationMarker",null);Pt(this,"samplePoints",[]);Pt(this,"sampleTooltips",[]);Pt(this,"isZooming",!1);Pt(this,"simpleLine",null);Pt(this,"isDestroyed",!1);Pt(this,"zoomAnimationTimeout",null);Pt(this,"samplePointStyle",{radius:4,color:"#FF4500",fillColor:"#FF4500",fillOpacity:.6,weight:2,opacity:.8});Pt(this,"minMaxPointStyle",{radius:6,weight:3,opacity:1,fillOpacity:1});this.properties=Ct.measure("ElevationLine.constructor.initProperties",()=>({...this.properties,type:"ElevationLine",style:{...this.properties.style||{},name:i.name||""},elevationProfile:null,maxElevation:0,minElevation:0,elevationGain:0,elevationLoss:0,dataSource:"pending",samplePointStyle:this.samplePointStyle,minMaxPointStyle:this.minMaxPointStyle})),this.setupEventListeners()}setupEventListeners(){Ct.measure("ElevationLine.setupEventListeners",()=>{this.on("move",()=>this.updateElevationProfile()),this.on("add",()=>{this._map&&(this._map.on("zoomstart",this.handleZoomStart,this),this._map.on("zoomend",this.handleZoomEnd,this),this._map.on("zoomanim",this._animateZoom,this))}),this.on("remove",()=>{this.cleanupEventListeners()})})}cleanupEventListeners(){this._map&&(this._map.off("zoomstart",this.handleZoomStart,this),this._map.off("zoomend",this.handleZoomEnd,this),this._map.off("zoomanim",this._animateZoom,this)),this.zoomAnimationTimeout&&(clearTimeout(this.zoomAnimationTimeout),this.zoomAnimationTimeout=null)}_animateZoom(t){if(this.isDestroyed||!this._map||!this.getLatLngs().length){console.debug("[ElevationLine] Animation de zoom ignorée - ligne détruite ou carte non disponible");return}this.zoomAnimationTimeout&&(clearTimeout(this.zoomAnimationTimeout),this.zoomAnimationTimeout=null);try{this.clearSamplePoints(),this.elevationMarker&&this.elevationMarker.remove();const i=this._path;i&&(i.style.display="none");const r=this.getLatLngs();if(r&&r.length>0&&this._map&&!this.isDestroyed&&(this.simpleLine?this.simpleLine.setLatLngs(r):this.simpleLine=hn.polyline(r,{color:"#FF4500",weight:3,opacity:.6,smoothFactor:1,interactive:!1}).addTo(this._map),this.simpleLine&&this.simpleLine._path)){const o=this.simpleLine._path.style.transform;this.simpleLine._path.style.transform="",this.zoomAnimationTimeout=setTimeout(()=>{if(this.isDestroyed||!this._map){this.cleanup();return}try{this.simpleLine&&this.simpleLine._path&&(this.simpleLine._path.style.transform=o,this.simpleLine._path.style.display=""),i&&!this.isDestroyed&&(i.style.display=""),this._map&&this._map.hasLayer(this)&&!this.isDestroyed&&(this.redraw(),this.showSamplePoints())}catch(l){console.warn("[ElevationLine] Erreur lors de la restauration après animation:",l),this.cleanup()}},300)}}catch(i){console.debug("[ElevationLine] Animation de zoom ignorée:",i),this.zoomAnimationTimeout=setTimeout(()=>{if(this.isDestroyed||!this._map){this.cleanup();return}try{this._path&&(this._path.style.display=""),this._map&&this._map.hasLayer(this)&&!this.isDestroyed&&(this.redraw(),this.showSamplePoints())}catch(r){console.error("[ElevationLine] Erreur lors de la restauration après animation:",r),this.cleanup()}},300)}}handleZoomStart(){this.isDestroyed||Ct.measure("ElevationLine.handleZoomStart",()=>{if(!(this.isZooming||!this._map)){this.isZooming=!0;try{this.clearSamplePoints(),this.elevationMarker&&this.elevationMarker.remove();const t=this._path;t&&(t.style.display="none"),this.isDestroyed||this.setStyle({opacity:.3})}catch(t){console.error("[ElevationLine] Error in handleZoomStart:",t),this.cleanup()}}})}handleZoomEnd(){this.isDestroyed||Ct.measure("ElevationLine.handleZoomEnd",()=>{if(!this._map){this.isZooming=!1;return}try{this.simpleLine&&this._map&&(this.simpleLine.remove(),this.simpleLine=null);const t=this._path;t&&(t.style.display=""),this.isDestroyed||this.setStyle({opacity:.8}),this.zoomAnimationTimeout&&clearTimeout(this.zoomAnimationTimeout),this.zoomAnimationTimeout=setTimeout(()=>{if(!(this.isDestroyed||!this._map))try{this._map&&this._map.hasLayer(this)&&!this.isDestroyed&&(this.redraw(),this.showSamplePoints())}catch(i){console.warn("[ElevationLine] Erreur lors du redraw après zoom:",i),this.cleanup()}},50)}catch(t){console.error("[ElevationLine] Error in handleZoomEnd:",t)}finally{this.isZooming=!1}})}cleanup(){Ct.measure("ElevationLine.cleanup",()=>{if(this.isZooming=!1,this.clearSamplePoints(),this.hideElevationMarker(),this.zoomAnimationTimeout&&(clearTimeout(this.zoomAnimationTimeout),this.zoomAnimationTimeout=null),this.simpleLine&&this._map){try{this.simpleLine.remove()}catch(i){console.error("[ElevationLine] Error removing simpleLine:",i)}this.simpleLine=null}if(this.elevationProfile){try{this.elevationProfile.remove()}catch(i){console.error("[ElevationLine] Error removing elevationProfile:",i)}this.elevationProfile=null}const t=this._path;t&&(t.style.display=""),!this.isDestroyed&&this._map&&this._map.hasLayer(this)&&this.setStyle({opacity:.8})})}calculateOptimalSampleCount(){return Ct.measure("ElevationLine.calculateOptimalSampleCount",()=>{const t=this.getLength(),i=Math.ceil(t/wa.SAMPLE_DISTANCE);return Math.min(Math.max(i,wa.MIN_SAMPLES),wa.MAX_SAMPLES)})}async fetchElevationData(t=0){return Ct.measure("ElevationLine.fetchElevationData",async()=>{if(this.getLatLngs().length===0)return;const r=this.getLength();let o="";const l=this.calculateOptimalSampleCount();console.log(`[ElevationLine] Using ${l} sample points for ${r.toFixed(0)}m line`);const h=[];for(let g=0;g<l;g++){const v=g/(l-1)*r,_=this.getPointAtDistance(v);_&&h.push(`${_.lat},${_.lng}`)}o=h.join("|");try{const g=await fetch(`${wa.API_URL}?locations=${o}`);if(!g.ok)throw new Error(`HTTP error ${g.status}`);const v=await g.json();if(!v.results||!Array.isArray(v.results))throw new Error("Invalid API response format");this.elevationData=v.results.map((_,x)=>({distance:x/(l-1)*r,elevation:_.elevation})),this.properties.dataSource="api"}catch(g){if(console.warn(`[ElevationLine] API fetch attempt ${t+1}/${wa.MAX_RETRIES} failed:`,g),t<wa.MAX_RETRIES)return await new Promise(v=>setTimeout(v,wa.RETRY_DELAY)),this.fetchElevationData(t+1);console.warn("[ElevationLine] All API attempts failed, falling back to simulation"),this.simulateElevationData(),this.properties.dataSource="simulation"}this.calculateElevationStatistics()})}simulateElevationData(){Ct.measure("ElevationLine.simulateElevationData",()=>{const t=this.getLength(),i=this.calculateOptimalSampleCount();this.elevationData=Array.from({length:i},(r,o)=>{const l=o/(i-1)*t,h=100+Math.sin(l/t*Math.PI*2)*50;return{distance:l,elevation:h}})})}calculateElevationStatistics(){Ct.measure("ElevationLine.calculateElevationStatistics",()=>{if(!this.elevationData.length)return;const t=this.elevationData.map(_=>_.elevation),i=t.length?Math.max(...t):0,r=t.length?Math.min(...t):0;let o=0,l=0,h=0,g=0,v=0;console.log("[ElevationLine][calculateElevationStatistics] Données brutes:",{elevationsCount:t.length,maxElevation:i,minElevation:r});for(let _=1;_<this.elevationData.length;_++){const x=this.elevationData[_-1],E=this.elevationData[_],b=E.elevation-x.elevation;b>0?o+=b:l+=Math.abs(b);const D=E.distance-x.distance;if(D>0){const $=b/D*100;h=Math.max(h,Math.abs($)),g+=Math.abs($),v++}}console.log("[ElevationLine][calculateElevationStatistics] Calculs intermédiaires:",{gain:o,loss:l,maxSlope:h,averageSlope:v>0?g/v:0}),this.properties={...this.properties,type:"ElevationLine",maxElevation:i,minElevation:r,elevationGain:o,elevationLoss:l,maxSlope:h,averageSlope:v>0?g/v:0,elevationData:this.elevationData,dataSource:this.properties.dataSource,length:this.getLength()},console.log("[ElevationLine][calculateElevationStatistics] Propriétés mises à jour:",this.properties)})}showSamplePoints(){Ct.measure("ElevationLine.showSamplePoints",()=>{if(this.clearSamplePoints(),!this.elevationData.length)return;const t=this.elevationData.map(o=>o.elevation),i=Math.max(...t),r=Math.min(...t);this.elevationData.forEach(o=>{const l=this.getPointAtDistance(o.distance);if(!l)return;const h=o.elevation===r,g=o.elevation===i;let v={...this.samplePointStyle};h?v={...v,...this.minMaxPointStyle,color:"#DC2626",fillColor:"#DC2626"}:g&&(v={...v,...this.minMaxPointStyle,color:"#059669",fillColor:"#059669"});const _=hn.circleMarker(l,v),x=hn.tooltip({permanent:!1,direction:"top",className:"elevation-tooltip",offset:[0,-10]});let E=`
          Distance: ${this.formatDistance(o.distance)}<br>
          Altitude: ${this.formatElevation(o.elevation)}
        `;h&&(E+="<br><strong>Point le plus bas</strong>"),g&&(E+="<br><strong>Point le plus haut</strong>"),x.setContent(E),_.on("mouseover",()=>{_.setStyle({...v,radius:v.radius+2,fillOpacity:1}),_.bindTooltip(x).openTooltip()}),_.on("mouseout",()=>{_.setStyle(v),_.closeTooltip()}),this._map&&(_.addTo(this._map),this.samplePoints.push(_),this.sampleTooltips.push(x))})})}clearSamplePoints(){Ct.measure("ElevationLine.clearSamplePoints",()=>{this.samplePoints.forEach(t=>t.remove()),this.samplePoints=[],this.sampleTooltips.forEach(t=>t.remove()),this.sampleTooltips=[]})}formatDistance(t){return Ct.measure("ElevationLine.formatDistance",()=>t>=1e3?`${(t/1e3).toFixed(2)} km`:`${t.toFixed(0)} m`)}formatElevation(t){return Ct.measure("ElevationLine.formatElevation",()=>`${t.toFixed(0)} m`)}onAdd(t){return Ct.measure("ElevationLine.onAdd",()=>(super.onAdd(t),this.showSamplePoints(),this))}onRemove(t){return this.isDestroyed=!0,this.cleanupEventListeners(),this.cleanup(),super.onRemove(t)}async updateElevationProfile(){return Ct.measure("ElevationLine.updateElevationProfile",async()=>{try{if(this.properties.elevationData&&this.properties.dataSource==="restored"){this.elevationData=this.properties.elevationData,this.calculateElevationStatistics(),this._map&&this._map.hasLayer(this)&&this.showSamplePoints(),this.fire("elevation:updated",{shape:this,elevationData:this.elevationData,properties:this.properties});return}await this.fetchElevationData(),this.updateProperties(),this._map&&this._map.hasLayer(this)&&this.showSamplePoints(),this.fire("elevation:updated",{shape:this,elevationData:this.elevationData,properties:this.properties})}catch(t){console.error("[ElevationLine] Erreur lors de la mise à jour du profil d'élévation:",t),this.properties.dataSource="error"}})}updateProperties(){Ct.measure("ElevationLine.updateProperties",()=>{if(super.updateProperties(),this.elevationData&&this.elevationData.length>0){const t=this.elevationData.map(E=>E.elevation),i=Math.max(...t),r=Math.min(...t);let o=0,l=0,h=0,g=0,v=0;for(let E=1;E<this.elevationData.length;E++){const b=this.elevationData[E-1],D=this.elevationData[E],$=D.elevation-b.elevation;$>0?o+=$:l+=Math.abs($);const Q=D.distance-b.distance;if(Q>0){const F=$/Q*100;h=Math.max(h,Math.abs(F)),g+=Math.abs(F),v++}}const x=this.getLatLngs().map(E=>({lat:E.lat,lng:E.lng}));this.properties={...this.properties,type:"ElevationLine",coordinates:x,elevationData:this.elevationData.map(E=>({distance:E.distance,elevation:E.elevation})),maxElevation:i,minElevation:r,elevationGain:o,elevationLoss:l,maxSlope:h,averageSlope:v>0?g/v:0,dataSource:this.properties.dataSource||"api"},this.fire("properties:updated",{shape:this,properties:this.properties})}})}getElevationData(){return Ct.measure("ElevationLine.getElevationData",()=>this.elevationData)}showElevationAt(t){Ct.measure("ElevationLine.showElevationAt",()=>{if(!(!this.elevationData.length||!this._map))try{const i=this.elevationData.reduce((o,l)=>Math.abs(l.distance-t)<Math.abs(o.distance-t)?l:o),r=this.getPointAtDistance(t);if(!r)return;this.elevationMarker?(this.elevationMarker.setLatLng(r),this.elevationMarker.setTooltipContent(`Distance: ${this.formatDistance(i.distance)}<br>Altitude: ${this.formatElevation(i.elevation)}`)):(this.elevationMarker=hn.circleMarker(r,{radius:6,color:"#FF4500",fillColor:"#FF4500",fillOpacity:1,weight:2,className:"elevation-marker"}),this.elevationMarker.bindTooltip(`Distance: ${this.formatDistance(i.distance)}<br>Altitude: ${this.formatElevation(i.elevation)}`,{permanent:!0,direction:"top",offset:[0,-10],className:"elevation-marker-tooltip"}),this._map&&this._map.hasLayer(this)&&this.elevationMarker.addTo(this._map)),this.fire("elevation:show",{distance:t,elevation:i.elevation,latLng:r})}catch(i){console.error("[ElevationLine] Erreur lors de l'affichage de l'élévation:",i),this.hideElevationMarker()}})}hideElevationMarker(){Ct.measure("ElevationLine.hideElevationMarker",()=>{this.elevationMarker&&(this.elevationMarker.remove(),this.elevationMarker=null)})}getPointAtDistance(t){return Ct.measure("ElevationLine.getPointAtDistance",()=>{try{const r=this.getLatLngs().map(h=>[h.lng,h.lat]),o=Pl(r),l=Tg(o,t,{units:"meters"});return hn.latLng(l.geometry.coordinates[1],l.geometry.coordinates[0])}catch(i){return console.error("Error calculating point at distance",i),null}})}moveVertex(t,i,r=!1){Ct.measure("ElevationLine.moveVertex",()=>{super.moveVertex(t,i,!1),this.properties.type="ElevationLine",r&&this.updateElevationProfile()})}addVertex(t,i,r=!1){Ct.measure("ElevationLine.addVertex",()=>{console.warn("[ElevationLine] Tentative d'ajout de vertex ignorée - non autorisé pour un profil altimétrique")})}setLatLngs(t){return Ct.measure("ElevationLine.setLatLngs",()=>(super.setLatLngs(t),this.properties.type="ElevationLine",this.updateElevationProfile(),this))}move(t,i=!0){return Ct.measure("ElevationLine.move",()=>(super.move(t,!1),this.properties.type="ElevationLine",i&&this.updateElevationProfile(),this))}setSamplePointStyle(t){Ct.measure("ElevationLine.setSamplePointStyle",()=>{this.samplePointStyle={...this.samplePointStyle,...t},this.properties.samplePointStyle=this.samplePointStyle,this._map&&this.showSamplePoints()})}setMinMaxPointStyle(t){Ct.measure("ElevationLine.setMinMaxPointStyle",()=>{this.minMaxPointStyle={...this.minMaxPointStyle,...t},this.properties.minMaxPointStyle=this.minMaxPointStyle,this._map&&this.showSamplePoints()})}setName(t){Ct.measure("ElevationLine.setName",()=>{this.properties.style||(this.properties.style={}),this.properties.style.name=t,this.fire("properties:updated",{shape:this,properties:this.properties})})}getName(){return Ct.measure("ElevationLine.getName",()=>{var t,i;return((i=(t=this.properties)==null?void 0:t.style)==null?void 0:i.name)||""})}};Pt(wa,"API_URL","https://api.open-elevation.com/api/v1/lookup"),Pt(wa,"RETRY_DELAY",2e3),Pt(wa,"MAX_RETRIES",3),Pt(wa,"SAMPLE_DISTANCE",100),Pt(wa,"MIN_SAMPLES",10),Pt(wa,"MAX_SAMPLES",50);let lh=wa;class wu extends hn.Polygon{constructor(t,i,r=0,o=180,l={}){super([[]],{...l,pmIgnore:!1,interactive:!0,className:"leaflet-semicircle"});Pt(this,"center");Pt(this,"radius");Pt(this,"startAngle");Pt(this,"stopAngle");Pt(this,"numPoints");Pt(this,"properties");Pt(this,"pm");Pt(this,"getRadius",()=>this.radius);Pt(this,"getStartAngle",()=>this.startAngle);Pt(this,"getStopAngle",()=>this.stopAngle);this.center=t,this.radius=i,this.startAngle=this.normalizeAngle(r),this.stopAngle=this.normalizeAngle(o),this.numPoints=64,this.properties=Ct.measure("CircleArc.constructor.initProperties",()=>({type:"Semicircle",radius:this.radius,startAngle:this.startAngle,stopAngle:this.stopAngle,style:{...l,startAngle:this.startAngle,stopAngle:this.stopAngle,name:l.name||""}})),this.on("pm:enable",()=>{var h;this.pm&&(this.pm._layers=[],this.pm._markers=[],(h=this.pm._markerGroup)==null||h.clearLayers())}),this.on("pm:vertexadded",()=>{var h;this.pm&&((h=this.pm._markerGroup)==null||h.clearLayers())}),this.on("add",()=>{this._map&&(this.updateGeometry(),this.pm&&this.pm.enable({allowSelfIntersection:!1,preventMarkerRemoval:!0}))}),this.updateProperties()}normalizeAngle(t){return Ct.measure("CircleArc.normalizeAngle",()=>(t%360+360)%360)}calculateArcPoints(){return Ct.measure("CircleArc.calculateArcPoints",()=>{if(!this._map)return[];const t=[],i=this.getOpeningAngle();t.push(this.center);for(let r=0;r<=this.numPoints;r++){const l=(this.startAngle+i*r/this.numPoints)*Math.PI/180,h=this.radius*Math.cos(l),v=this.radius*Math.sin(l)/111319.9,_=h/(111319.9*Math.cos(this.center.lat*Math.PI/180)),x=hn.latLng(this.center.lat+v,this.center.lng+_);t.push(x)}return t.push(this.center),t})}setRadius(t){return Ct.measure("CircleArc.setRadius",()=>t<=0?this:(this.radius=t,this.properties.radius=t,this.updateGeometry(),this.updateProperties(),this))}setAngles(t,i){return Ct.measure("CircleArc.setAngles",()=>{const r=this.normalizeAngle(t),o=this.normalizeAngle(i),l=this.getOpeningAngle();let h=(o-r+360)%360;const g=45;return Math.abs(h-l)>g&&(h>l?h=l+g:h=l-g),h=Math.max(5,Math.min(355,h)),this.startAngle===t?this.stopAngle=(this.startAngle+h)%360:(this.startAngle=r,this.stopAngle=(r+h)%360),this.properties.startAngle=this.startAngle,this.properties.stopAngle=this.stopAngle,this.properties.openingAngle=h,this.properties.style.startAngle=this.startAngle,this.properties.style.stopAngle=this.stopAngle,this.updateGeometry(),this})}setOpeningAngle(t){return Ct.measure("CircleArc.setOpeningAngle",()=>t<5||t>355?this:(this.stopAngle=(this.startAngle+t)%360,this.properties.openingAngle=t,this.updateGeometry(),this.updateProperties(),this))}setCenter(t){return Ct.measure("CircleArc.setCenter",()=>!t.lat||!t.lng?this:(this.center=t,this.updateGeometry(),this.updateProperties(),this))}getCenter(){return Ct.measure("CircleArc.getCenter",()=>this.center)}getOpeningAngle(){return Ct.measure("CircleArc.getOpeningAngle",()=>(this.stopAngle-this.startAngle+360)%360)}calculatePointOnArc(t){return Ct.measure("CircleArc.calculatePointOnArc",()=>{const i=t*Math.PI/180,r=this.radius*Math.cos(i),l=this.radius*Math.sin(i)/111319.9,h=r/(111319.9*Math.cos(this.center.lat*Math.PI/180));return hn.latLng(this.center.lat+l,this.center.lng+h)})}calculateMidpointPosition(){return Ct.measure("CircleArc.calculateMidpointPosition",()=>{const t=this.getOpeningAngle(),i=(this.startAngle+t/2)%360;return this.calculatePointOnArc(i)})}calculateAngleToPoint(t){return Ct.measure("CircleArc.calculateAngleToPoint",()=>Math.atan2(t.lat-this.center.lat,t.lng-this.center.lng)*180/Math.PI)}createControlPoints(t,i){Ct.measure("CircleArc.createControlPoints",()=>{const r=[],o=this.calculatePointOnArc(this.startAngle),l=this.calculatePointOnArc(this.stopAngle),h=this.calculateMidpointPosition(),g=this.createControlPoint(t,this.center,"#059669"),v=this.createControlPoint(t,o,"#DC2626"),_=this.createControlPoint(t,l,"#DC2626"),x=this.createControlPoint(t,h,"#2563EB");r.push(g,v,_,x),i(r)})}createControlPoint(t,i,r){return Ct.measure("CircleArc.createControlPoint",()=>hn.circleMarker(i,{radius:6,color:r,fillColor:r,fillOpacity:1,weight:2,className:"control-point",pmIgnore:!0}).addTo(t))}updateProperties(){Ct.measure("CircleArc.updateProperties",()=>{var l,h,g,v;const t=this.getOpeningAngle(),i=Math.PI*Math.pow(this.radius,2)*t/360,r=2*Math.PI*this.radius*t/360,o=r+2*this.radius;console.log(`
Mise à jour des propriétés du secteur de cercle:`),console.log(`- Rayon: ${this.radius.toFixed(2)}m`),console.log(`- Angle d'ouverture: ${t.toFixed(2)}°`),console.log(`- Surface calculée: ${i.toFixed(2)}m²`),console.log(`- Longueur d'arc: ${r.toFixed(2)}m`),console.log(`- Périmètre total: ${o.toFixed(2)}m`),this.properties={type:"Semicircle",radius:this.radius,startAngle:this.startAngle,stopAngle:this.stopAngle,surface:i,arcLength:r,perimeter:o,openingAngle:t,diameter:this.radius*2,center:{lat:this.center.lat,lng:this.center.lng},style:{...(l=this.properties)==null?void 0:l.style,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#3388ff",fillOpacity:this.options.fillOpacity||.2,dashArray:((h=this.options)==null?void 0:h.dashArray)||"",name:((v=(g=this.properties)==null?void 0:g.style)==null?void 0:v.name)||""}},this.fire("properties:updated",{shape:this,properties:this.properties})})}updateGeometry(){Ct.measure("CircleArc.updateGeometry",()=>{if(!this._map)return;const t=this.calculateArcPoints();t.length>0&&(this.setLatLngs([t]),this.updateProperties())})}toGeoJSON(){return Ct.measure("CircleArc.toGeoJSON",()=>{const t=super.toGeoJSON();return{...t,properties:{...t.properties,type:"Semicircle",radius:this.radius,startAngle:this.startAngle,stopAngle:this.stopAngle,openingAngle:this.getOpeningAngle()}}})}setName(t){Ct.measure("CircleArc.setName",()=>{this.properties.style||(this.properties.style={}),this.properties.style.name=t,this.fire("properties:updated",{shape:this,properties:this.properties})})}getName(){return Ct.measure("CircleArc.getName",()=>{var t,i;return((i=(t=this.properties)==null?void 0:t.style)==null?void 0:i.name)||""})}}var gp={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */gp.exports;(function(e,n){(function(){var t,i="4.17.21",r=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",h="Invalid `variable` option passed into `_.template`",g="__lodash_hash_undefined__",v=500,_="__lodash_placeholder__",x=1,E=2,b=4,D=1,$=2,Q=1,F=2,G=4,me=8,Se=16,Ie=32,nt=64,Ve=128,O=256,W=512,ue=30,z="...",R=800,J=16,V=1,U=2,Y=3,ce=1/0,re=9007199254740991,Pe=17976931348623157e292,Me=NaN,ot=4294967295,X=ot-1,Ee=ot>>>1,B=[["ary",Ve],["bind",Q],["bindKey",F],["curry",me],["curryRight",Se],["flip",W],["partial",Ie],["partialRight",nt],["rearg",O]],H="[object Arguments]",he="[object Array]",te="[object AsyncFunction]",ie="[object Boolean]",ee="[object Date]",se="[object DOMException]",Ce="[object Error]",ne="[object Function]",ae="[object GeneratorFunction]",xe="[object Map]",ye="[object Number]",le="[object Null]",je="[object Object]",Re="[object Promise]",Ae="[object Proxy]",qe="[object RegExp]",Oe="[object Set]",et="[object String]",Je="[object Symbol]",mt="[object Undefined]",_t="[object WeakMap]",$t="[object WeakSet]",Xt="[object ArrayBuffer]",Xe="[object DataView]",Kt="[object Float32Array]",Qt="[object Float64Array]",Qe="[object Int8Array]",We="[object Int16Array]",Ut="[object Int32Array]",pn="[object Uint8Array]",_n="[object Uint8ClampedArray]",mn="[object Uint16Array]",rt="[object Uint32Array]",vn=/\b__p \+= '';/g,ni=/\b(__p \+=) '' \+/g,fn=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Mn=/&(?:amp|lt|gt|quot|#39);/g,Sr=/[&<>"']/g,Ii=RegExp(Mn.source),Mt=RegExp(Sr.source),On=/<%-([\s\S]+?)%>/g,Fi=/<%([\s\S]+?)%>/g,zi=/<%=([\s\S]+?)%>/g,Xr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$r=/^\w*$/,Nn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,pi=/[\\^$.*+?()[\]{}|]/g,hr=RegExp(pi.source),bi=/^\s+/,Zt=/\s/,yn=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,er=/\{\n\/\* \[wrapped with (.+)\] \*/,kr=/,? & /,tr=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,qr=/[()=,{}\[\]\/\s]/,Vr=/\\(\\)?/g,Qn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,fr=/\w*$/,fs=/^[-+]0x[0-9a-f]+$/i,Qr=/^0b[01]+$/i,Ci=/^\[object .+?Constructor\]$/,An=/^0o[0-7]+$/i,Pr=/^(?:0|[1-9]\d*)$/,Ui=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Vi=/($^)/,dr=/['\n\r\u2028\u2029\\]/g,es="\\ud800-\\udfff",Fs="\\u0300-\\u036f",di="\\ufe20-\\ufe2f",co="\\u20d0-\\u20ff",mr=Fs+di+co,Er="\\u2700-\\u27bf",mi="a-z\\xdf-\\xf6\\xf8-\\xff",xn="\\xac\\xb1\\xd7\\xf7",on="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ii="\\u2000-\\u206f",Xn=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",jn="A-Z\\xc0-\\xd6\\xd8-\\xde",rs="\\ufe0e\\ufe0f",Ps=xn+on+ii+Xn,Tr="['’]",so="["+es+"]",ln="["+Ps+"]",Jn="["+mr+"]",vr="\\d+",sr="["+Er+"]",pr="["+mi+"]",Ea="[^"+es+Ps+vr+Er+mi+jn+"]",Ao="\\ud83c[\\udffb-\\udfff]",ho="(?:"+Jn+"|"+Ao+")",ar="[^"+es+"]",Es="(?:\\ud83c[\\udde6-\\uddff]){2}",oo="[\\ud800-\\udbff][\\udc00-\\udfff]",As="["+jn+"]",Wi="\\u200d",ds="(?:"+pr+"|"+Ea+")",ps="(?:"+As+"|"+Ea+")",fo="(?:"+Tr+"(?:d|ll|m|re|s|t|ve))?",Vo="(?:"+Tr+"(?:D|LL|M|RE|S|T|VE))?",ca=ho+"?",Ha="["+rs+"]?",ts="(?:"+Wi+"(?:"+[ar,Es,oo].join("|")+")"+Ha+ca+")*",iu="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",cl="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ri=Ha+ca+ts,li="(?:"+[sr,Es,oo].join("|")+")"+ri,po="(?:"+[ar+Jn+"?",Jn,Es,oo,so].join("|")+")",Ri=RegExp(Tr,"g"),Bl=RegExp(Jn,"g"),Aa=RegExp(Ao+"(?="+Ao+")|"+po+ri,"g"),Ma=RegExp([As+"?"+pr+"+"+fo+"(?="+[ln,As,"$"].join("|")+")",ps+"+"+Vo+"(?="+[ln,As+ds,"$"].join("|")+")",As+"?"+ds+"+"+fo,As+"+"+Vo,cl,iu,vr,li].join("|"),"g"),go=RegExp("["+Wi+es+mr+rs+"]"),ha=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Nl=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Wa=-1,oi={};oi[Kt]=oi[Qt]=oi[Qe]=oi[We]=oi[Ut]=oi[pn]=oi[_n]=oi[mn]=oi[rt]=!0,oi[H]=oi[he]=oi[Xt]=oi[ie]=oi[Xe]=oi[ee]=oi[Ce]=oi[ne]=oi[xe]=oi[ye]=oi[je]=oi[qe]=oi[Oe]=oi[et]=oi[_t]=!1;var wi={};wi[H]=wi[he]=wi[Xt]=wi[Xe]=wi[ie]=wi[ee]=wi[Kt]=wi[Qt]=wi[Qe]=wi[We]=wi[Ut]=wi[xe]=wi[ye]=wi[je]=wi[qe]=wi[Oe]=wi[et]=wi[Je]=wi[pn]=wi[_n]=wi[mn]=wi[rt]=!0,wi[Ce]=wi[ne]=wi[_t]=!1;var fa={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},ru={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Za={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},hl={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ka=parseFloat,Ka=parseInt,fl=typeof qo=="object"&&qo&&qo.Object===Object&&qo,Si=typeof self=="object"&&self&&self.Object===Object&&self,Nr=fl||Si||Function("return this")(),Gn=n&&!n.nodeType&&n,Rr=Gn&&!0&&e&&!e.nodeType&&e,Ta=Rr&&Rr.exports===Gn,Go=Ta&&fl.process,yr=function(){try{var bt=Rr&&Rr.require&&Rr.require("util").types;return bt||Go&&Go.binding&&Go.binding("util")}catch{}}(),dl=yr&&yr.isArrayBuffer,Mo=yr&&yr.isDate,Ja=yr&&yr.isMap,Ya=yr&&yr.isRegExp,ao=yr&&yr.isSet,Xa=yr&&yr.isTypedArray;function Zi(bt,qt,Bt){switch(Bt.length){case 0:return bt.call(qt);case 1:return bt.call(qt,Bt[0]);case 2:return bt.call(qt,Bt[0],Bt[1]);case 3:return bt.call(qt,Bt[0],Bt[1],Bt[2])}return bt.apply(qt,Bt)}function su(bt,qt,Bt,Cn){for(var In=-1,si=bt==null?0:bt.length;++In<si;){var _r=bt[In];qt(Cn,_r,Bt(_r),bt)}return Cn}function ss(bt,qt){for(var Bt=-1,Cn=bt==null?0:bt.length;++Bt<Cn&&qt(bt[Bt],Bt,bt)!==!1;);return bt}function mo(bt,qt){for(var Bt=bt==null?0:bt.length;Bt--&&qt(bt[Bt],Bt,bt)!==!1;);return bt}function Qa(bt,qt){for(var Bt=-1,Cn=bt==null?0:bt.length;++Bt<Cn;)if(!qt(bt[Bt],Bt,bt))return!1;return!0}function vo(bt,qt){for(var Bt=-1,Cn=bt==null?0:bt.length,In=0,si=[];++Bt<Cn;){var _r=bt[Bt];qt(_r,Bt,bt)&&(si[In++]=_r)}return si}function Ba(bt,qt){var Bt=bt==null?0:bt.length;return!!Bt&&sn(bt,qt,0)>-1}function Na(bt,qt,Bt){for(var Cn=-1,In=bt==null?0:bt.length;++Cn<In;)if(Bt(qt,bt[Cn]))return!0;return!1}function Ki(bt,qt){for(var Bt=-1,Cn=bt==null?0:bt.length,In=Array(Cn);++Bt<Cn;)In[Bt]=qt(bt[Bt],Bt,bt);return In}function Qs(bt,qt){for(var Bt=-1,Cn=qt.length,In=bt.length;++Bt<Cn;)bt[In+Bt]=qt[Bt];return bt}function Ho(bt,qt,Bt,Cn){var In=-1,si=bt==null?0:bt.length;for(Cn&&si&&(Bt=bt[++In]);++In<si;)Bt=qt(Bt,bt[In],In,bt);return Bt}function Dr(bt,qt,Bt,Cn){var In=bt==null?0:bt.length;for(Cn&&In&&(Bt=bt[--In]);In--;)Bt=qt(Bt,bt[In],In,bt);return Bt}function A(bt,qt){for(var Bt=-1,Cn=bt==null?0:bt.length;++Bt<Cn;)if(qt(bt[Bt],Bt,bt))return!0;return!1}var de=ei("length");function He(bt){return bt.split("")}function ct(bt){return bt.match(tr)||[]}function St(bt,qt,Bt){var Cn;return Bt(bt,function(In,si,_r){if(qt(In,si,_r))return Cn=si,!1}),Cn}function Ft(bt,qt,Bt,Cn){for(var In=bt.length,si=Bt+(Cn?1:-1);Cn?si--:++si<In;)if(qt(bt[si],si,bt))return si;return-1}function sn(bt,qt,Bt){return qt===qt?ns(bt,qt,Bt):Ft(bt,kn,Bt)}function Pn(bt,qt,Bt,Cn){for(var In=Bt-1,si=bt.length;++In<si;)if(Cn(bt[In],qt))return In;return-1}function kn(bt){return bt!==bt}function Vn(bt,qt){var Bt=bt==null?0:bt.length;return Bt?Ji(bt,qt)/Bt:Me}function ei(bt){return function(qt){return qt==null?t:qt[bt]}}function vi(bt){return function(qt){return bt==null?t:bt[qt]}}function gr(bt,qt,Bt,Cn,In){return In(bt,function(si,_r,Yi){Bt=Cn?(Cn=!1,si):qt(Bt,si,_r,Yi)}),Bt}function $i(bt,qt){var Bt=bt.length;for(bt.sort(qt);Bt--;)bt[Bt]=bt[Bt].value;return bt}function Ji(bt,qt){for(var Bt,Cn=-1,In=bt.length;++Cn<In;){var si=qt(bt[Cn]);si!==t&&(Bt=Bt===t?si:Bt+si)}return Bt}function Or(bt,qt){for(var Bt=-1,Cn=Array(bt);++Bt<bt;)Cn[Bt]=qt(Bt);return Cn}function Gr(bt,qt){return Ki(qt,function(Bt){return[Bt,bt[Bt]]})}function eo(bt){return bt&&bt.slice(0,Zo(bt)+1).replace(bi,"")}function yi(bt){return function(qt){return bt(qt)}}function gs(bt,qt){return Ki(qt,function(Bt){return bt[Bt]})}function Ra(bt,qt){return bt.has(qt)}function Ms(bt,qt){for(var Bt=-1,Cn=bt.length;++Bt<Cn&&sn(qt,bt[Bt],0)>-1;);return Bt}function pl(bt,qt){for(var Bt=bt.length;Bt--&&sn(qt,bt[Bt],0)>-1;);return Bt}function ko(bt,qt){for(var Bt=bt.length,Cn=0;Bt--;)bt[Bt]===qt&&++Cn;return Cn}var Rl=vi(fa),da=vi(ru);function pa(bt){return"\\"+hl[bt]}function Hr(bt,qt){return bt==null?t:bt[qt]}function To(bt){return go.test(bt)}function to(bt){return ha.test(bt)}function zs(bt){for(var qt,Bt=[];!(qt=bt.next()).done;)Bt.push(qt.value);return Bt}function Da(bt){var qt=-1,Bt=Array(bt.size);return bt.forEach(function(Cn,In){Bt[++qt]=[In,Cn]}),Bt}function ms(bt,qt){return function(Bt){return bt(qt(Bt))}}function ks(bt,qt){for(var Bt=-1,Cn=bt.length,In=0,si=[];++Bt<Cn;){var _r=bt[Bt];(_r===qt||_r===_)&&(bt[Bt]=_,si[In++]=Bt)}return si}function Ts(bt){var qt=-1,Bt=Array(bt.size);return bt.forEach(function(Cn){Bt[++qt]=Cn}),Bt}function ou(bt){var qt=-1,Bt=Array(bt.size);return bt.forEach(function(Cn){Bt[++qt]=[Cn,Cn]}),Bt}function ns(bt,qt,Bt){for(var Cn=Bt-1,In=bt.length;++Cn<In;)if(bt[Cn]===qt)return Cn;return-1}function Wo(bt,qt,Bt){for(var Cn=Bt+1;Cn--;)if(bt[Cn]===qt)return Cn;return Cn}function vs(bt){return To(bt)?_s(bt):de(bt)}function ys(bt){return To(bt)?os(bt):He(bt)}function Zo(bt){for(var qt=bt.length;qt--&&Zt.test(bt.charAt(qt)););return qt}var Ko=vi(Za);function _s(bt){for(var qt=Aa.lastIndex=0;Aa.test(bt);)++qt;return qt}function os(bt){return bt.match(Aa)||[]}function Bo(bt){return bt.match(Ma)||[]}var no=function bt(qt){qt=qt==null?Nr:bs.defaults(Nr.Object(),qt,bs.pick(Nr,Nl));var Bt=qt.Array,Cn=qt.Date,In=qt.Error,si=qt.Function,_r=qt.Math,Yi=qt.Object,el=qt.RegExp,Bs=qt.String,br=qt.TypeError,No=Bt.prototype,Jo=si.prototype,Ro=Yi.prototype,Do=qt["__core-js_shared__"],Oo=Jo.toString,Pi=Ro.hasOwnProperty,yo=0,as=function(){var u=/[^.]+$/.exec(Do&&Do.keys&&Do.keys.IE_PROTO||"");return u?"Symbol(src)_1."+u:""}(),Xi=Ro.toString,nr=Oo.call(Yi),Ir=Nr._,lr=el("^"+Oo.call(Pi).replace(pi,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),io=Ta?qt.Buffer:t,js=qt.Symbol,lo=qt.Uint8Array,Dl=io?io.allocUnsafe:t,Io=ms(Yi.getPrototypeOf,Yi),Wr=Yi.create,or=Ro.propertyIsEnumerable,ws=No.splice,Us=js?js.isConcatSpreadable:t,Yn=js?js.iterator:t,Yo=js?js.toStringTag:t,Xo=function(){try{var u=Oc(Yi,"defineProperty");return u({},"",{}),u}catch{}}(),_o=qt.clearTimeout!==Nr.clearTimeout&&qt.clearTimeout,Ns=Cn&&Cn.now!==Nr.Date.now&&Cn.now,ku=qt.setTimeout!==Nr.setTimeout&&qt.setTimeout,ls=_r.ceil,us=_r.floor,bo=Yi.getOwnPropertySymbols,s=io?io.isBuffer:t,f=qt.isFinite,w=No.join,T=ms(Yi.keys,Yi),Z=_r.max,_e=_r.min,at=Cn.now,Tt=qt.parseInt,zt=_r.random,tn=No.reverse,En=Oc(qt,"DataView"),Un=Oc(qt,"Map"),gi=Oc(qt,"Promise"),Zr=Oc(qt,"Set"),Ar=Oc(qt,"WeakMap"),cs=Oc(Yi,"create"),wr=Ar&&new Ar,$s={},Tu=Ic(En),Fo=Ic(Un),wo=Ic(gi),uo=Ic(Zr),Mc=Ic(Ar),gl=js?js.prototype:t,Gi=gl?gl.valueOf:t,xs=gl?gl.toString:t;function Te(u){if(Rs(u)&&!Ai(u)&&!(u instanceof _i)){if(u instanceof hs)return u;if(Pi.call(u,"__wrapped__"))return n1(u)}return new hs(u)}var qs=function(){function u(){}return function(d){if(!Cs(d))return{};if(Wr)return Wr(d);u.prototype=d;var P=new u;return u.prototype=t,P}}();function Ol(){}function hs(u,d){this.__wrapped__=u,this.__actions__=[],this.__chain__=!!d,this.__index__=0,this.__values__=t}Te.templateSettings={escape:On,evaluate:Fi,interpolate:zi,variable:"",imports:{_:Te}},Te.prototype=Ol.prototype,Te.prototype.constructor=Te,hs.prototype=qs(Ol.prototype),hs.prototype.constructor=hs;function _i(u){this.__wrapped__=u,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ot,this.__views__=[]}function ec(){var u=new _i(this.__wrapped__);return u.__actions__=Ia(this.__actions__),u.__dir__=this.__dir__,u.__filtered__=this.__filtered__,u.__iteratees__=Ia(this.__iteratees__),u.__takeCount__=this.__takeCount__,u.__views__=Ia(this.__views__),u}function hh(){if(this.__filtered__){var u=new _i(this);u.__dir__=-1,u.__filtered__=!0}else u=this.clone(),u.__dir__*=-1;return u}function tc(){var u=this.__wrapped__.value(),d=this.__dir__,P=Ai(u),j=d<0,ge=P?u.length:0,Fe=lb(0,ge,this.__views__),st=Fe.start,gt=Fe.end,kt=gt-st,nn=j?gt:st-1,rn=this.__iteratees__,dn=rn.length,Bn=0,Hn=_e(kt,this.__takeCount__);if(!P||!j&&ge==kt&&Hn==kt)return ml(u,this.__actions__);var ui=[];e:for(;kt--&&Bn<Hn;){nn+=d;for(var ji=-1,ci=u[nn];++ji<dn;){var Qi=rn[ji],rr=Qi.iteratee,il=Qi.type,ya=rr(ci);if(il==U)ci=ya;else if(!ya){if(il==V)continue e;break e}}ui[Bn++]=ci}return ui}_i.prototype=qs(Ol.prototype),_i.prototype.constructor=_i;function ga(u){var d=-1,P=u==null?0:u.length;for(this.clear();++d<P;){var j=u[d];this.set(j[0],j[1])}}function Bu(){this.__data__=cs?cs(null):{},this.size=0}function kc(u){var d=this.has(u)&&delete this.__data__[u];return this.size-=d?1:0,d}function Qh(u){var d=this.__data__;if(cs){var P=d[u];return P===g?t:P}return Pi.call(d,u)?d[u]:t}function au(u){var d=this.__data__;return cs?d[u]!==t:Pi.call(d,u)}function nc(u,d){var P=this.__data__;return this.size+=this.has(u)?0:1,P[u]=cs&&d===t?g:d,this}ga.prototype.clear=Bu,ga.prototype.delete=kc,ga.prototype.get=Qh,ga.prototype.has=au,ga.prototype.set=nc;function tl(u){var d=-1,P=u==null?0:u.length;for(this.clear();++d<P;){var j=u[d];this.set(j[0],j[1])}}function ef(){this.__data__=[],this.size=0}function ic(u){var d=this.__data__,P=yt(d,u);if(P<0)return!1;var j=d.length-1;return P==j?d.pop():ws.call(d,P,1),--this.size,!0}function rc(u){var d=this.__data__,P=yt(d,u);return P<0?t:d[P][1]}function fh(u){return yt(this.__data__,u)>-1}function dh(u,d){var P=this.__data__,j=yt(P,u);return j<0?(++this.size,P.push([u,d])):P[j][1]=d,this}tl.prototype.clear=ef,tl.prototype.delete=ic,tl.prototype.get=rc,tl.prototype.has=fh,tl.prototype.set=dh;function Qo(u){var d=-1,P=u==null?0:u.length;for(this.clear();++d<P;){var j=u[d];this.set(j[0],j[1])}}function ph(){this.size=0,this.__data__={hash:new ga,map:new(Un||tl),string:new ga}}function gh(u){var d=cd(this,u).delete(u);return this.size-=d?1:0,d}function mh(u){return cd(this,u).get(u)}function m(u){return cd(this,u).has(u)}function S(u,d){var P=cd(this,u),j=P.size;return P.set(u,d),this.size+=P.size==j?0:1,this}Qo.prototype.clear=ph,Qo.prototype.delete=gh,Qo.prototype.get=mh,Qo.prototype.has=m,Qo.prototype.set=S;function N(u){var d=-1,P=u==null?0:u.length;for(this.__data__=new Qo;++d<P;)this.add(u[d])}function K(u){return this.__data__.set(u,g),this}function pe(u){return this.__data__.has(u)}N.prototype.add=N.prototype.push=K,N.prototype.has=pe;function be(u){var d=this.__data__=new tl(u);this.size=d.size}function Le(){this.__data__=new tl,this.size=0}function ke(u){var d=this.__data__,P=d.delete(u);return this.size=d.size,P}function Be(u){return this.__data__.get(u)}function Ge(u){return this.__data__.has(u)}function ft(u,d){var P=this.__data__;if(P instanceof tl){var j=P.__data__;if(!Un||j.length<r-1)return j.push([u,d]),this.size=++P.size,this;P=this.__data__=new Qo(j)}return P.set(u,d),this.size=P.size,this}be.prototype.clear=Le,be.prototype.delete=ke,be.prototype.get=Be,be.prototype.has=Ge,be.prototype.set=ft;function Dt(u,d){var P=Ai(u),j=!P&&Fc(u),ge=!P&&!j&&oc(u),Fe=!P&&!j&&!ge&&Sh(u),st=P||j||ge||Fe,gt=st?Or(u.length,Bs):[],kt=gt.length;for(var nn in u)(d||Pi.call(u,nn))&&!(st&&(nn=="length"||ge&&(nn=="offset"||nn=="parent")||Fe&&(nn=="buffer"||nn=="byteLength"||nn=="byteOffset")||Fu(nn,kt)))&&gt.push(nn);return gt}function Ot(u){var d=u.length;return d?u[Nc(0,d-1)]:t}function Lt(u,d){return hd(Ia(u),$n(d,0,u.length))}function Vt(u){return hd(Ia(u))}function jt(u,d,P){(P!==t&&!$l(u[d],P)||P===t&&!(d in u))&&Sn(u,d,P)}function dt(u,d,P){var j=u[d];(!(Pi.call(u,d)&&$l(j,P))||P===t&&!(d in u))&&Sn(u,d,P)}function yt(u,d){for(var P=u.length;P--;)if($l(u[P][0],d))return P;return-1}function Jt(u,d,P,j){return k(u,function(ge,Fe,st){d(j,ge,P(ge),st)}),j}function an(u,d){return u&&cu(d,xo(d),u)}function Yt(u,d){return u&&cu(d,za(d),u)}function Sn(u,d,P){d=="__proto__"&&Xo?Xo(u,d,{configurable:!0,enumerable:!0,value:P,writable:!0}):u[d]=P}function Ln(u,d){for(var P=-1,j=d.length,ge=Bt(j),Fe=u==null;++P<j;)ge[P]=Fe?t:f0(u,d[P]);return ge}function $n(u,d,P){return u===u&&(P!==t&&(u=u<=P?u:P),d!==t&&(u=u>=d?u:d)),u}function a(u,d,P,j,ge,Fe){var st,gt=d&x,kt=d&E,nn=d&b;if(P&&(st=ge?P(u,j,ge,Fe):P(u)),st!==t)return st;if(!Cs(u))return u;var rn=Ai(u);if(rn){if(st=cb(u),!gt)return Ia(u,st)}else{var dn=ta(u),Bn=dn==ne||dn==ae;if(oc(u))return Am(u,gt);if(dn==je||dn==H||Bn&&!ge){if(st=kt||Bn?{}:Wm(u),!gt)return kt?Q4(u,Yt(st,u)):X4(u,an(st,u))}else{if(!wi[dn])return ge?u:{};st=hb(u,dn,gt)}}Fe||(Fe=new be);var Hn=Fe.get(u);if(Hn)return Hn;Fe.set(u,st),x1(u)?u.forEach(function(ci){st.add(a(ci,d,P,ci,u,Fe))}):b1(u)&&u.forEach(function(ci,Qi){st.set(Qi,a(ci,d,P,Qi,u,Fe))});var ui=nn?kt?Xp:Yp:kt?za:xo,ji=rn?t:ui(u);return ss(ji||u,function(ci,Qi){ji&&(Qi=ci,ci=u[Qi]),dt(st,Qi,a(ci,d,P,Qi,u,Fe))}),st}function c(u){var d=xo(u);return function(P){return p(P,u,d)}}function p(u,d,P){var j=P.length;if(u==null)return!j;for(u=Yi(u);j--;){var ge=P[j],Fe=d[ge],st=u[ge];if(st===t&&!(ge in u)||!Fe(st))return!1}return!0}function y(u,d,P){if(typeof u!="function")throw new br(l);return of(function(){u.apply(t,P)},d)}function C(u,d,P,j){var ge=-1,Fe=Ba,st=!0,gt=u.length,kt=[],nn=d.length;if(!gt)return kt;P&&(d=Ki(d,yi(P))),j?(Fe=Na,st=!1):d.length>=r&&(Fe=Ra,st=!1,d=new N(d));e:for(;++ge<gt;){var rn=u[ge],dn=P==null?rn:P(rn);if(rn=j||rn!==0?rn:0,st&&dn===dn){for(var Bn=nn;Bn--;)if(d[Bn]===dn)continue e;kt.push(rn)}else Fe(d,dn,j)||kt.push(rn)}return kt}var k=Nm(Wt),I=Nm(gn,!0);function q(u,d){var P=!0;return k(u,function(j,ge,Fe){return P=!!d(j,ge,Fe),P}),P}function oe(u,d,P){for(var j=-1,ge=u.length;++j<ge;){var Fe=u[j],st=d(Fe);if(st!=null&&(gt===t?st===st&&!nl(st):P(st,gt)))var gt=st,kt=Fe}return kt}function ve(u,d,P,j){var ge=u.length;for(P=Oi(P),P<0&&(P=-P>ge?0:ge+P),j=j===t||j>ge?ge:Oi(j),j<0&&(j+=ge),j=P>j?0:C1(j);P<j;)u[P++]=d;return u}function Ke(u,d){var P=[];return k(u,function(j,ge,Fe){d(j,ge,Fe)&&P.push(j)}),P}function $e(u,d,P,j,ge){var Fe=-1,st=u.length;for(P||(P=db),ge||(ge=[]);++Fe<st;){var gt=u[Fe];d>0&&P(gt)?d>1?$e(gt,d-1,P,j,ge):Qs(ge,gt):j||(ge[ge.length]=gt)}return ge}var vt=Rm(),Nt=Rm(!0);function Wt(u,d){return u&&vt(u,d,xo)}function gn(u,d){return u&&Nt(u,d,xo)}function bn(u,d){return vo(d,function(P){return zu(u[P])})}function Zn(u,d){d=Ul(d,u);for(var P=0,j=d.length;u!=null&&P<j;)u=u[hu(d[P++])];return P&&P==j?u:t}function Ze(u,d,P){var j=d(u);return Ai(u)?j:Qs(j,P(u))}function it(u){return u==null?u===t?mt:le:Yo&&Yo in Yi(u)?ab(u):bb(u)}function ht(u,d){return u>d}function It(u,d){return u!=null&&Pi.call(u,d)}function xt(u,d){return u!=null&&d in Yi(u)}function Rt(u,d,P){return u>=_e(d,P)&&u<Z(d,P)}function fe(u,d,P){for(var j=P?Na:Ba,ge=u[0].length,Fe=u.length,st=Fe,gt=Bt(Fe),kt=1/0,nn=[];st--;){var rn=u[st];st&&d&&(rn=Ki(rn,yi(d))),kt=_e(rn.length,kt),gt[st]=!P&&(d||ge>=120&&rn.length>=120)?new N(st&&rn):t}rn=u[0];var dn=-1,Bn=gt[0];e:for(;++dn<ge&&nn.length<kt;){var Hn=rn[dn],ui=d?d(Hn):Hn;if(Hn=P||Hn!==0?Hn:0,!(Bn?Ra(Bn,ui):j(nn,ui,P))){for(st=Fe;--st;){var ji=gt[st];if(!(ji?Ra(ji,ui):j(u[st],ui,P)))continue e}Bn&&Bn.push(ui),nn.push(Hn)}}return nn}function we(u,d,P,j){return Wt(u,function(ge,Fe,st){d(j,P(ge),Fe,st)}),j}function De(u,d,P){d=Ul(d,u),u=Ym(u,d);var j=u==null?u:u[hu(_l(d))];return j==null?t:Zi(j,u,P)}function Ne(u){return Rs(u)&&it(u)==H}function ze(u){return Rs(u)&&it(u)==Xt}function Ue(u){return Rs(u)&&it(u)==ee}function lt(u,d,P,j,ge){return u===d?!0:u==null||d==null||!Rs(u)&&!Rs(d)?u!==u&&d!==d:ut(u,d,P,j,lt,ge)}function ut(u,d,P,j,ge,Fe){var st=Ai(u),gt=Ai(d),kt=st?he:ta(u),nn=gt?he:ta(d);kt=kt==H?je:kt,nn=nn==H?je:nn;var rn=kt==je,dn=nn==je,Bn=kt==nn;if(Bn&&oc(u)){if(!oc(d))return!1;st=!0,rn=!1}if(Bn&&!rn)return Fe||(Fe=new be),st||Sh(u)?Vm(u,d,P,j,ge,Fe):sb(u,d,kt,P,j,ge,Fe);if(!(P&D)){var Hn=rn&&Pi.call(u,"__wrapped__"),ui=dn&&Pi.call(d,"__wrapped__");if(Hn||ui){var ji=Hn?u.value():u,ci=ui?d.value():d;return Fe||(Fe=new be),ge(ji,ci,P,j,Fe)}}return Bn?(Fe||(Fe=new be),ob(u,d,P,j,ge,Fe)):!1}function pt(u){return Rs(u)&&ta(u)==xe}function Et(u,d,P,j){var ge=P.length,Fe=ge,st=!j;if(u==null)return!Fe;for(u=Yi(u);ge--;){var gt=P[ge];if(st&&gt[2]?gt[1]!==u[gt[0]]:!(gt[0]in u))return!1}for(;++ge<Fe;){gt=P[ge];var kt=gt[0],nn=u[kt],rn=gt[1];if(st&&gt[2]){if(nn===t&&!(kt in u))return!1}else{var dn=new be;if(j)var Bn=j(nn,rn,kt,u,d,dn);if(!(Bn===t?lt(rn,nn,D|$,j,dn):Bn))return!1}}return!0}function At(u){if(!Cs(u)||gb(u))return!1;var d=zu(u)?lr:Ci;return d.test(Ic(u))}function en(u){return Rs(u)&&it(u)==qe}function Tn(u){return Rs(u)&&ta(u)==Oe}function Rn(u){return Rs(u)&&vd(u.length)&&!!oi[it(u)]}function qn(u){return typeof u=="function"?u:u==null?ja:typeof u=="object"?Ai(u)?Il(u[0],u[1]):Vs(u):D1(u)}function Hi(u){if(!sf(u))return T(u);var d=[];for(var P in Yi(u))Pi.call(u,P)&&P!="constructor"&&d.push(P);return d}function ir(u){if(!Cs(u))return _b(u);var d=sf(u),P=[];for(var j in u)j=="constructor"&&(d||!Pi.call(u,j))||P.push(j);return P}function Ei(u,d){return u<d}function ur(u,d){var P=-1,j=Fa(u)?Bt(u.length):[];return k(u,function(ge,Fe,st){j[++P]=d(ge,Fe,st)}),j}function Vs(u){var d=e0(u);return d.length==1&&d[0][2]?Km(d[0][0],d[0][1]):function(P){return P===u||Et(P,u,d)}}function Il(u,d){return n0(u)&&Zm(d)?Km(hu(u),d):function(P){var j=f0(P,u);return j===t&&j===d?d0(P,u):lt(d,j,D|$)}}function zo(u,d,P,j,ge){u!==d&&vt(d,function(Fe,st){if(ge||(ge=new be),Cs(Fe))Tc(u,d,st,P,zo,j,ge);else{var gt=j?j(r0(u,st),Fe,st+"",u,d,ge):t;gt===t&&(gt=Fe),jt(u,st,gt)}},za)}function Tc(u,d,P,j,ge,Fe,st){var gt=r0(u,P),kt=r0(d,P),nn=st.get(kt);if(nn){jt(u,P,nn);return}var rn=Fe?Fe(gt,kt,P+"",u,d,st):t,dn=rn===t;if(dn){var Bn=Ai(kt),Hn=!Bn&&oc(kt),ui=!Bn&&!Hn&&Sh(kt);rn=kt,Bn||Hn||ui?Ai(gt)?rn=gt:Gs(gt)?rn=Ia(gt):Hn?(dn=!1,rn=Am(kt,!0)):ui?(dn=!1,rn=Mm(kt,!0)):rn=[]:af(kt)||Fc(kt)?(rn=gt,Fc(gt)?rn=S1(gt):(!Cs(gt)||zu(gt))&&(rn=Wm(kt))):dn=!1}dn&&(st.set(kt,rn),ge(rn,kt,j,Fe,st),st.delete(kt)),jt(u,P,rn)}function ma(u,d){var P=u.length;if(P)return d+=d<0?P:0,Fu(d,P)?u[d]:t}function lu(u,d,P){d.length?d=Ki(d,function(Fe){return Ai(Fe)?function(st){return Zn(st,Fe.length===1?Fe[0]:Fe)}:Fe}):d=[ja];var j=-1;d=Ki(d,yi(ai()));var ge=ur(u,function(Fe,st,gt){var kt=Ki(d,function(nn){return nn(Fe)});return{criteria:kt,index:++j,value:Fe}});return $i(ge,function(Fe,st){return Y4(Fe,st,P)})}function jo(u,d){return Ls(u,d,function(P,j){return d0(u,j)})}function Ls(u,d,P){for(var j=-1,ge=d.length,Fe={};++j<ge;){var st=d[j],gt=Zn(u,st);P(gt,st)&&Nu(Fe,Ul(st,u),gt)}return Fe}function Fr(u){return function(d){return Zn(d,u)}}function vh(u,d,P,j){var ge=j?Pn:sn,Fe=-1,st=d.length,gt=u;for(u===d&&(d=Ia(d)),P&&(gt=Ki(u,yi(P)));++Fe<st;)for(var kt=0,nn=d[Fe],rn=P?P(nn):nn;(kt=ge(gt,rn,kt,j))>-1;)gt!==u&&ws.call(gt,kt,1),ws.call(u,kt,1);return u}function Bc(u,d){for(var P=u?d.length:0,j=P-1;P--;){var ge=d[P];if(P==j||ge!==Fe){var Fe=ge;Fu(ge)?ws.call(u,ge,1):Ru(u,ge)}}return u}function Nc(u,d){return u+us(zt()*(d-u+1))}function Rc(u,d,P,j){for(var ge=-1,Fe=Z(ls((d-u)/(P||1)),0),st=Bt(Fe);Fe--;)st[j?Fe:++ge]=u,u+=P;return st}function yh(u,d){var P="";if(!u||d<1||d>re)return P;do d%2&&(P+=u),d=us(d/2),d&&(u+=u);while(d);return P}function Di(u,d){return s0(Jm(u,d,ja),u+"")}function _h(u){return Ot(Ph(u))}function Qf(u,d){var P=Ph(u);return hd(P,$n(d,0,P.length))}function Nu(u,d,P,j){if(!Cs(u))return u;d=Ul(d,u);for(var ge=-1,Fe=d.length,st=Fe-1,gt=u;gt!=null&&++ge<Fe;){var kt=hu(d[ge]),nn=P;if(kt==="__proto__"||kt==="constructor"||kt==="prototype")return u;if(ge!=st){var rn=gt[kt];nn=j?j(rn,kt,gt):t,nn===t&&(nn=Cs(rn)?rn:Fu(d[ge+1])?[]:{})}dt(gt,kt,nn),gt=gt[kt]}return u}var Fl=wr?function(u,d){return wr.set(u,d),u}:ja,ed=Xo?function(u,d){return Xo(u,"toString",{configurable:!0,enumerable:!1,value:g0(d),writable:!0})}:ja;function td(u){return hd(Ph(u))}function Oa(u,d,P){var j=-1,ge=u.length;d<0&&(d=-d>ge?0:ge+d),P=P>ge?ge:P,P<0&&(P+=ge),ge=d>P?0:P-d>>>0,d>>>=0;for(var Fe=Bt(ge);++j<ge;)Fe[j]=u[j+d];return Fe}function nd(u,d){var P;return k(u,function(j,ge,Fe){return P=d(j,ge,Fe),!P}),!!P}function zl(u,d,P){var j=0,ge=u==null?j:u.length;if(typeof d=="number"&&d===d&&ge<=Ee){for(;j<ge;){var Fe=j+ge>>>1,st=u[Fe];st!==null&&!nl(st)&&(P?st<=d:st<d)?j=Fe+1:ge=Fe}return ge}return tf(u,d,ja,P)}function tf(u,d,P,j){var ge=0,Fe=u==null?0:u.length;if(Fe===0)return 0;d=P(d);for(var st=d!==d,gt=d===null,kt=nl(d),nn=d===t;ge<Fe;){var rn=us((ge+Fe)/2),dn=P(u[rn]),Bn=dn!==t,Hn=dn===null,ui=dn===dn,ji=nl(dn);if(st)var ci=j||ui;else nn?ci=ui&&(j||Bn):gt?ci=ui&&Bn&&(j||!Hn):kt?ci=ui&&Bn&&!Hn&&(j||!ji):Hn||ji?ci=!1:ci=j?dn<=d:dn<d;ci?ge=rn+1:Fe=rn}return _e(Fe,X)}function nf(u,d){for(var P=-1,j=u.length,ge=0,Fe=[];++P<j;){var st=u[P],gt=d?d(st):st;if(!P||!$l(gt,kt)){var kt=gt;Fe[ge++]=st===0?0:st}}return Fe}function id(u){return typeof u=="number"?u:nl(u)?Me:+u}function ea(u){if(typeof u=="string")return u;if(Ai(u))return Ki(u,ea)+"";if(nl(u))return xs?xs.call(u):"";var d=u+"";return d=="0"&&1/u==-1/0?"-0":d}function uu(u,d,P){var j=-1,ge=Ba,Fe=u.length,st=!0,gt=[],kt=gt;if(P)st=!1,ge=Na;else if(Fe>=r){var nn=d?null:ib(u);if(nn)return Ts(nn);st=!1,ge=Ra,kt=new N}else kt=d?[]:gt;e:for(;++j<Fe;){var rn=u[j],dn=d?d(rn):rn;if(rn=P||rn!==0?rn:0,st&&dn===dn){for(var Bn=kt.length;Bn--;)if(kt[Bn]===dn)continue e;d&&kt.push(dn),gt.push(rn)}else ge(kt,dn,P)||(kt!==gt&&kt.push(dn),gt.push(rn))}return gt}function Ru(u,d){return d=Ul(d,u),u=Ym(u,d),u==null||delete u[hu(_l(d))]}function bh(u,d,P,j){return Nu(u,d,P(Zn(u,d)),j)}function Du(u,d,P,j){for(var ge=u.length,Fe=j?ge:-1;(j?Fe--:++Fe<ge)&&d(u[Fe],Fe,u););return P?Oa(u,j?0:Fe,j?Fe+1:ge):Oa(u,j?Fe+1:0,j?ge:Fe)}function ml(u,d){var P=u;return P instanceof _i&&(P=P.value()),Ho(d,function(j,ge){return ge.func.apply(ge.thisArg,Qs([j],ge.args))},P)}function vl(u,d,P){var j=u.length;if(j<2)return j?uu(u[0]):[];for(var ge=-1,Fe=Bt(j);++ge<j;)for(var st=u[ge],gt=-1;++gt<j;)gt!=ge&&(Fe[ge]=C(Fe[ge]||st,u[gt],d,P));return uu($e(Fe,1),d,P)}function jl(u,d,P){for(var j=-1,ge=u.length,Fe=d.length,st={};++j<ge;){var gt=j<Fe?d[j]:t;P(st,u[j],gt)}return st}function sc(u){return Gs(u)?u:[]}function Dc(u){return typeof u=="function"?u:ja}function Ul(u,d){return Ai(u)?u:n0(u,d)?[u]:t1(xr(u))}var Wp=Di;function yl(u,d,P){var j=u.length;return P=P===t?j:P,!d&&P>=j?u:Oa(u,d,P)}var wh=_o||function(u){return Nr.clearTimeout(u)};function Am(u,d){if(d)return u.slice();var P=u.length,j=Dl?Dl(P):new u.constructor(P);return u.copy(j),j}function Zp(u){var d=new u.constructor(u.byteLength);return new lo(d).set(new lo(u)),d}function Z4(u,d){var P=d?Zp(u.buffer):u.buffer;return new u.constructor(P,u.byteOffset,u.byteLength)}function K4(u){var d=new u.constructor(u.source,fr.exec(u));return d.lastIndex=u.lastIndex,d}function J4(u){return Gi?Yi(Gi.call(u)):{}}function Mm(u,d){var P=d?Zp(u.buffer):u.buffer;return new u.constructor(P,u.byteOffset,u.length)}function km(u,d){if(u!==d){var P=u!==t,j=u===null,ge=u===u,Fe=nl(u),st=d!==t,gt=d===null,kt=d===d,nn=nl(d);if(!gt&&!nn&&!Fe&&u>d||Fe&&st&&kt&&!gt&&!nn||j&&st&&kt||!P&&kt||!ge)return 1;if(!j&&!Fe&&!nn&&u<d||nn&&P&&ge&&!j&&!Fe||gt&&P&&ge||!st&&ge||!kt)return-1}return 0}function Y4(u,d,P){for(var j=-1,ge=u.criteria,Fe=d.criteria,st=ge.length,gt=P.length;++j<st;){var kt=km(ge[j],Fe[j]);if(kt){if(j>=gt)return kt;var nn=P[j];return kt*(nn=="desc"?-1:1)}}return u.index-d.index}function Tm(u,d,P,j){for(var ge=-1,Fe=u.length,st=P.length,gt=-1,kt=d.length,nn=Z(Fe-st,0),rn=Bt(kt+nn),dn=!j;++gt<kt;)rn[gt]=d[gt];for(;++ge<st;)(dn||ge<Fe)&&(rn[P[ge]]=u[ge]);for(;nn--;)rn[gt++]=u[ge++];return rn}function Bm(u,d,P,j){for(var ge=-1,Fe=u.length,st=-1,gt=P.length,kt=-1,nn=d.length,rn=Z(Fe-gt,0),dn=Bt(rn+nn),Bn=!j;++ge<rn;)dn[ge]=u[ge];for(var Hn=ge;++kt<nn;)dn[Hn+kt]=d[kt];for(;++st<gt;)(Bn||ge<Fe)&&(dn[Hn+P[st]]=u[ge++]);return dn}function Ia(u,d){var P=-1,j=u.length;for(d||(d=Bt(j));++P<j;)d[P]=u[P];return d}function cu(u,d,P,j){var ge=!P;P||(P={});for(var Fe=-1,st=d.length;++Fe<st;){var gt=d[Fe],kt=j?j(P[gt],u[gt],gt,P,u):t;kt===t&&(kt=u[gt]),ge?Sn(P,gt,kt):dt(P,gt,kt)}return P}function X4(u,d){return cu(u,t0(u),d)}function Q4(u,d){return cu(u,Gm(u),d)}function rd(u,d){return function(P,j){var ge=Ai(P)?su:Jt,Fe=d?d():{};return ge(P,u,ai(j,2),Fe)}}function xh(u){return Di(function(d,P){var j=-1,ge=P.length,Fe=ge>1?P[ge-1]:t,st=ge>2?P[2]:t;for(Fe=u.length>3&&typeof Fe=="function"?(ge--,Fe):t,st&&va(P[0],P[1],st)&&(Fe=ge<3?t:Fe,ge=1),d=Yi(d);++j<ge;){var gt=P[j];gt&&u(d,gt,j,Fe)}return d})}function Nm(u,d){return function(P,j){if(P==null)return P;if(!Fa(P))return u(P,j);for(var ge=P.length,Fe=d?ge:-1,st=Yi(P);(d?Fe--:++Fe<ge)&&j(st[Fe],Fe,st)!==!1;);return P}}function Rm(u){return function(d,P,j){for(var ge=-1,Fe=Yi(d),st=j(d),gt=st.length;gt--;){var kt=st[u?gt:++ge];if(P(Fe[kt],kt,Fe)===!1)break}return d}}function eb(u,d,P){var j=d&Q,ge=rf(u);function Fe(){var st=this&&this!==Nr&&this instanceof Fe?ge:u;return st.apply(j?P:this,arguments)}return Fe}function Dm(u){return function(d){d=xr(d);var P=To(d)?ys(d):t,j=P?P[0]:d.charAt(0),ge=P?yl(P,1).join(""):d.slice(1);return j[u]()+ge}}function Lh(u){return function(d){return Ho(N1(B1(d).replace(Ri,"")),u,"")}}function rf(u){return function(){var d=arguments;switch(d.length){case 0:return new u;case 1:return new u(d[0]);case 2:return new u(d[0],d[1]);case 3:return new u(d[0],d[1],d[2]);case 4:return new u(d[0],d[1],d[2],d[3]);case 5:return new u(d[0],d[1],d[2],d[3],d[4]);case 6:return new u(d[0],d[1],d[2],d[3],d[4],d[5]);case 7:return new u(d[0],d[1],d[2],d[3],d[4],d[5],d[6])}var P=qs(u.prototype),j=u.apply(P,d);return Cs(j)?j:P}}function tb(u,d,P){var j=rf(u);function ge(){for(var Fe=arguments.length,st=Bt(Fe),gt=Fe,kt=Ch(ge);gt--;)st[gt]=arguments[gt];var nn=Fe<3&&st[0]!==kt&&st[Fe-1]!==kt?[]:ks(st,kt);if(Fe-=nn.length,Fe<P)return jm(u,d,sd,ge.placeholder,t,st,nn,t,t,P-Fe);var rn=this&&this!==Nr&&this instanceof ge?j:u;return Zi(rn,this,st)}return ge}function Om(u){return function(d,P,j){var ge=Yi(d);if(!Fa(d)){var Fe=ai(P,3);d=xo(d),P=function(gt){return Fe(ge[gt],gt,ge)}}var st=u(d,P,j);return st>-1?ge[Fe?d[st]:st]:t}}function Im(u){return Iu(function(d){var P=d.length,j=P,ge=hs.prototype.thru;for(u&&d.reverse();j--;){var Fe=d[j];if(typeof Fe!="function")throw new br(l);if(ge&&!st&&ud(Fe)=="wrapper")var st=new hs([],!0)}for(j=st?j:P;++j<P;){Fe=d[j];var gt=ud(Fe),kt=gt=="wrapper"?Qp(Fe):t;kt&&i0(kt[0])&&kt[1]==(Ve|me|Ie|O)&&!kt[4].length&&kt[9]==1?st=st[ud(kt[0])].apply(st,kt[3]):st=Fe.length==1&&i0(Fe)?st[gt]():st.thru(Fe)}return function(){var nn=arguments,rn=nn[0];if(st&&nn.length==1&&Ai(rn))return st.plant(rn).value();for(var dn=0,Bn=P?d[dn].apply(this,nn):rn;++dn<P;)Bn=d[dn].call(this,Bn);return Bn}})}function sd(u,d,P,j,ge,Fe,st,gt,kt,nn){var rn=d&Ve,dn=d&Q,Bn=d&F,Hn=d&(me|Se),ui=d&W,ji=Bn?t:rf(u);function ci(){for(var Qi=arguments.length,rr=Bt(Qi),il=Qi;il--;)rr[il]=arguments[il];if(Hn)var ya=Ch(ci),rl=ko(rr,ya);if(j&&(rr=Tm(rr,j,ge,Hn)),Fe&&(rr=Bm(rr,Fe,st,Hn)),Qi-=rl,Hn&&Qi<nn){var Hs=ks(rr,ya);return jm(u,d,sd,ci.placeholder,P,rr,Hs,gt,kt,nn-Qi)}var ql=dn?P:this,Uu=Bn?ql[u]:u;return Qi=rr.length,gt?rr=wb(rr,gt):ui&&Qi>1&&rr.reverse(),rn&&kt<Qi&&(rr.length=kt),this&&this!==Nr&&this instanceof ci&&(Uu=ji||rf(Uu)),Uu.apply(ql,rr)}return ci}function Fm(u,d){return function(P,j){return we(P,u,d(j),{})}}function od(u,d){return function(P,j){var ge;if(P===t&&j===t)return d;if(P!==t&&(ge=P),j!==t){if(ge===t)return j;typeof P=="string"||typeof j=="string"?(P=ea(P),j=ea(j)):(P=id(P),j=id(j)),ge=u(P,j)}return ge}}function Kp(u){return Iu(function(d){return d=Ki(d,yi(ai())),Di(function(P){var j=this;return u(d,function(ge){return Zi(ge,j,P)})})})}function ad(u,d){d=d===t?" ":ea(d);var P=d.length;if(P<2)return P?yh(d,u):d;var j=yh(d,ls(u/vs(d)));return To(d)?yl(ys(j),0,u).join(""):j.slice(0,u)}function nb(u,d,P,j){var ge=d&Q,Fe=rf(u);function st(){for(var gt=-1,kt=arguments.length,nn=-1,rn=j.length,dn=Bt(rn+kt),Bn=this&&this!==Nr&&this instanceof st?Fe:u;++nn<rn;)dn[nn]=j[nn];for(;kt--;)dn[nn++]=arguments[++gt];return Zi(Bn,ge?P:this,dn)}return st}function zm(u){return function(d,P,j){return j&&typeof j!="number"&&va(d,P,j)&&(P=j=t),d=ju(d),P===t?(P=d,d=0):P=ju(P),j=j===t?d<P?1:-1:ju(j),Rc(d,P,j,u)}}function ld(u){return function(d,P){return typeof d=="string"&&typeof P=="string"||(d=bl(d),P=bl(P)),u(d,P)}}function jm(u,d,P,j,ge,Fe,st,gt,kt,nn){var rn=d&me,dn=rn?st:t,Bn=rn?t:st,Hn=rn?Fe:t,ui=rn?t:Fe;d|=rn?Ie:nt,d&=~(rn?nt:Ie),d&G||(d&=-4);var ji=[u,d,ge,Hn,dn,ui,Bn,gt,kt,nn],ci=P.apply(t,ji);return i0(u)&&Xm(ci,ji),ci.placeholder=j,Qm(ci,u,d)}function Jp(u){var d=_r[u];return function(P,j){if(P=bl(P),j=j==null?0:_e(Oi(j),292),j&&f(P)){var ge=(xr(P)+"e").split("e"),Fe=d(ge[0]+"e"+(+ge[1]+j));return ge=(xr(Fe)+"e").split("e"),+(ge[0]+"e"+(+ge[1]-j))}return d(P)}}var ib=Zr&&1/Ts(new Zr([,-0]))[1]==ce?function(u){return new Zr(u)}:y0;function Um(u){return function(d){var P=ta(d);return P==xe?Da(d):P==Oe?ou(d):Gr(d,u(d))}}function Ou(u,d,P,j,ge,Fe,st,gt){var kt=d&F;if(!kt&&typeof u!="function")throw new br(l);var nn=j?j.length:0;if(nn||(d&=-97,j=ge=t),st=st===t?st:Z(Oi(st),0),gt=gt===t?gt:Oi(gt),nn-=ge?ge.length:0,d&nt){var rn=j,dn=ge;j=ge=t}var Bn=kt?t:Qp(u),Hn=[u,d,P,j,ge,rn,dn,Fe,st,gt];if(Bn&&yb(Hn,Bn),u=Hn[0],d=Hn[1],P=Hn[2],j=Hn[3],ge=Hn[4],gt=Hn[9]=Hn[9]===t?kt?0:u.length:Z(Hn[9]-nn,0),!gt&&d&(me|Se)&&(d&=-25),!d||d==Q)var ui=eb(u,d,P);else d==me||d==Se?ui=tb(u,d,gt):(d==Ie||d==(Q|Ie))&&!ge.length?ui=nb(u,d,P,j):ui=sd.apply(t,Hn);var ji=Bn?Fl:Xm;return Qm(ji(ui,Hn),u,d)}function $m(u,d,P,j){return u===t||$l(u,Ro[P])&&!Pi.call(j,P)?d:u}function qm(u,d,P,j,ge,Fe){return Cs(u)&&Cs(d)&&(Fe.set(d,u),zo(u,d,t,qm,Fe),Fe.delete(d)),u}function rb(u){return af(u)?t:u}function Vm(u,d,P,j,ge,Fe){var st=P&D,gt=u.length,kt=d.length;if(gt!=kt&&!(st&&kt>gt))return!1;var nn=Fe.get(u),rn=Fe.get(d);if(nn&&rn)return nn==d&&rn==u;var dn=-1,Bn=!0,Hn=P&$?new N:t;for(Fe.set(u,d),Fe.set(d,u);++dn<gt;){var ui=u[dn],ji=d[dn];if(j)var ci=st?j(ji,ui,dn,d,u,Fe):j(ui,ji,dn,u,d,Fe);if(ci!==t){if(ci)continue;Bn=!1;break}if(Hn){if(!A(d,function(Qi,rr){if(!Ra(Hn,rr)&&(ui===Qi||ge(ui,Qi,P,j,Fe)))return Hn.push(rr)})){Bn=!1;break}}else if(!(ui===ji||ge(ui,ji,P,j,Fe))){Bn=!1;break}}return Fe.delete(u),Fe.delete(d),Bn}function sb(u,d,P,j,ge,Fe,st){switch(P){case Xe:if(u.byteLength!=d.byteLength||u.byteOffset!=d.byteOffset)return!1;u=u.buffer,d=d.buffer;case Xt:return!(u.byteLength!=d.byteLength||!Fe(new lo(u),new lo(d)));case ie:case ee:case ye:return $l(+u,+d);case Ce:return u.name==d.name&&u.message==d.message;case qe:case et:return u==d+"";case xe:var gt=Da;case Oe:var kt=j&D;if(gt||(gt=Ts),u.size!=d.size&&!kt)return!1;var nn=st.get(u);if(nn)return nn==d;j|=$,st.set(u,d);var rn=Vm(gt(u),gt(d),j,ge,Fe,st);return st.delete(u),rn;case Je:if(Gi)return Gi.call(u)==Gi.call(d)}return!1}function ob(u,d,P,j,ge,Fe){var st=P&D,gt=Yp(u),kt=gt.length,nn=Yp(d),rn=nn.length;if(kt!=rn&&!st)return!1;for(var dn=kt;dn--;){var Bn=gt[dn];if(!(st?Bn in d:Pi.call(d,Bn)))return!1}var Hn=Fe.get(u),ui=Fe.get(d);if(Hn&&ui)return Hn==d&&ui==u;var ji=!0;Fe.set(u,d),Fe.set(d,u);for(var ci=st;++dn<kt;){Bn=gt[dn];var Qi=u[Bn],rr=d[Bn];if(j)var il=st?j(rr,Qi,Bn,d,u,Fe):j(Qi,rr,Bn,u,d,Fe);if(!(il===t?Qi===rr||ge(Qi,rr,P,j,Fe):il)){ji=!1;break}ci||(ci=Bn=="constructor")}if(ji&&!ci){var ya=u.constructor,rl=d.constructor;ya!=rl&&"constructor"in u&&"constructor"in d&&!(typeof ya=="function"&&ya instanceof ya&&typeof rl=="function"&&rl instanceof rl)&&(ji=!1)}return Fe.delete(u),Fe.delete(d),ji}function Iu(u){return s0(Jm(u,t,s1),u+"")}function Yp(u){return Ze(u,xo,t0)}function Xp(u){return Ze(u,za,Gm)}var Qp=wr?function(u){return wr.get(u)}:y0;function ud(u){for(var d=u.name+"",P=$s[d],j=Pi.call($s,d)?P.length:0;j--;){var ge=P[j],Fe=ge.func;if(Fe==null||Fe==u)return ge.name}return d}function Ch(u){var d=Pi.call(Te,"placeholder")?Te:u;return d.placeholder}function ai(){var u=Te.iteratee||m0;return u=u===m0?qn:u,arguments.length?u(arguments[0],arguments[1]):u}function cd(u,d){var P=u.__data__;return pb(d)?P[typeof d=="string"?"string":"hash"]:P.map}function e0(u){for(var d=xo(u),P=d.length;P--;){var j=d[P],ge=u[j];d[P]=[j,ge,Zm(ge)]}return d}function Oc(u,d){var P=Hr(u,d);return At(P)?P:t}function ab(u){var d=Pi.call(u,Yo),P=u[Yo];try{u[Yo]=t;var j=!0}catch{}var ge=Xi.call(u);return j&&(d?u[Yo]=P:delete u[Yo]),ge}var t0=bo?function(u){return u==null?[]:(u=Yi(u),vo(bo(u),function(d){return or.call(u,d)}))}:_0,Gm=bo?function(u){for(var d=[];u;)Qs(d,t0(u)),u=Io(u);return d}:_0,ta=it;(En&&ta(new En(new ArrayBuffer(1)))!=Xe||Un&&ta(new Un)!=xe||gi&&ta(gi.resolve())!=Re||Zr&&ta(new Zr)!=Oe||Ar&&ta(new Ar)!=_t)&&(ta=function(u){var d=it(u),P=d==je?u.constructor:t,j=P?Ic(P):"";if(j)switch(j){case Tu:return Xe;case Fo:return xe;case wo:return Re;case uo:return Oe;case Mc:return _t}return d});function lb(u,d,P){for(var j=-1,ge=P.length;++j<ge;){var Fe=P[j],st=Fe.size;switch(Fe.type){case"drop":u+=st;break;case"dropRight":d-=st;break;case"take":d=_e(d,u+st);break;case"takeRight":u=Z(u,d-st);break}}return{start:u,end:d}}function ub(u){var d=u.match(er);return d?d[1].split(kr):[]}function Hm(u,d,P){d=Ul(d,u);for(var j=-1,ge=d.length,Fe=!1;++j<ge;){var st=hu(d[j]);if(!(Fe=u!=null&&P(u,st)))break;u=u[st]}return Fe||++j!=ge?Fe:(ge=u==null?0:u.length,!!ge&&vd(ge)&&Fu(st,ge)&&(Ai(u)||Fc(u)))}function cb(u){var d=u.length,P=new u.constructor(d);return d&&typeof u[0]=="string"&&Pi.call(u,"index")&&(P.index=u.index,P.input=u.input),P}function Wm(u){return typeof u.constructor=="function"&&!sf(u)?qs(Io(u)):{}}function hb(u,d,P){var j=u.constructor;switch(d){case Xt:return Zp(u);case ie:case ee:return new j(+u);case Xe:return Z4(u,P);case Kt:case Qt:case Qe:case We:case Ut:case pn:case _n:case mn:case rt:return Mm(u,P);case xe:return new j;case ye:case et:return new j(u);case qe:return K4(u);case Oe:return new j;case Je:return J4(u)}}function fb(u,d){var P=d.length;if(!P)return u;var j=P-1;return d[j]=(P>1?"& ":"")+d[j],d=d.join(P>2?", ":" "),u.replace(yn,`{
/* [wrapped with `+d+`] */
`)}function db(u){return Ai(u)||Fc(u)||!!(Us&&u&&u[Us])}function Fu(u,d){var P=typeof u;return d=d??re,!!d&&(P=="number"||P!="symbol"&&Pr.test(u))&&u>-1&&u%1==0&&u<d}function va(u,d,P){if(!Cs(P))return!1;var j=typeof d;return(j=="number"?Fa(P)&&Fu(d,P.length):j=="string"&&d in P)?$l(P[d],u):!1}function n0(u,d){if(Ai(u))return!1;var P=typeof u;return P=="number"||P=="symbol"||P=="boolean"||u==null||nl(u)?!0:$r.test(u)||!Xr.test(u)||d!=null&&u in Yi(d)}function pb(u){var d=typeof u;return d=="string"||d=="number"||d=="symbol"||d=="boolean"?u!=="__proto__":u===null}function i0(u){var d=ud(u),P=Te[d];if(typeof P!="function"||!(d in _i.prototype))return!1;if(u===P)return!0;var j=Qp(P);return!!j&&u===j[0]}function gb(u){return!!as&&as in u}var mb=Do?zu:b0;function sf(u){var d=u&&u.constructor,P=typeof d=="function"&&d.prototype||Ro;return u===P}function Zm(u){return u===u&&!Cs(u)}function Km(u,d){return function(P){return P==null?!1:P[u]===d&&(d!==t||u in Yi(P))}}function vb(u){var d=gd(u,function(j){return P.size===v&&P.clear(),j}),P=d.cache;return d}function yb(u,d){var P=u[1],j=d[1],ge=P|j,Fe=ge<(Q|F|Ve),st=j==Ve&&P==me||j==Ve&&P==O&&u[7].length<=d[8]||j==(Ve|O)&&d[7].length<=d[8]&&P==me;if(!(Fe||st))return u;j&Q&&(u[2]=d[2],ge|=P&Q?0:G);var gt=d[3];if(gt){var kt=u[3];u[3]=kt?Tm(kt,gt,d[4]):gt,u[4]=kt?ks(u[3],_):d[4]}return gt=d[5],gt&&(kt=u[5],u[5]=kt?Bm(kt,gt,d[6]):gt,u[6]=kt?ks(u[5],_):d[6]),gt=d[7],gt&&(u[7]=gt),j&Ve&&(u[8]=u[8]==null?d[8]:_e(u[8],d[8])),u[9]==null&&(u[9]=d[9]),u[0]=d[0],u[1]=ge,u}function _b(u){var d=[];if(u!=null)for(var P in Yi(u))d.push(P);return d}function bb(u){return Xi.call(u)}function Jm(u,d,P){return d=Z(d===t?u.length-1:d,0),function(){for(var j=arguments,ge=-1,Fe=Z(j.length-d,0),st=Bt(Fe);++ge<Fe;)st[ge]=j[d+ge];ge=-1;for(var gt=Bt(d+1);++ge<d;)gt[ge]=j[ge];return gt[d]=P(st),Zi(u,this,gt)}}function Ym(u,d){return d.length<2?u:Zn(u,Oa(d,0,-1))}function wb(u,d){for(var P=u.length,j=_e(d.length,P),ge=Ia(u);j--;){var Fe=d[j];u[j]=Fu(Fe,P)?ge[Fe]:t}return u}function r0(u,d){if(!(d==="constructor"&&typeof u[d]=="function")&&d!="__proto__")return u[d]}var Xm=e1(Fl),of=ku||function(u,d){return Nr.setTimeout(u,d)},s0=e1(ed);function Qm(u,d,P){var j=d+"";return s0(u,fb(j,xb(ub(j),P)))}function e1(u){var d=0,P=0;return function(){var j=at(),ge=J-(j-P);if(P=j,ge>0){if(++d>=R)return arguments[0]}else d=0;return u.apply(t,arguments)}}function hd(u,d){var P=-1,j=u.length,ge=j-1;for(d=d===t?j:d;++P<d;){var Fe=Nc(P,ge),st=u[Fe];u[Fe]=u[P],u[P]=st}return u.length=d,u}var t1=vb(function(u){var d=[];return u.charCodeAt(0)===46&&d.push(""),u.replace(Nn,function(P,j,ge,Fe){d.push(ge?Fe.replace(Vr,"$1"):j||P)}),d});function hu(u){if(typeof u=="string"||nl(u))return u;var d=u+"";return d=="0"&&1/u==-1/0?"-0":d}function Ic(u){if(u!=null){try{return Oo.call(u)}catch{}try{return u+""}catch{}}return""}function xb(u,d){return ss(B,function(P){var j="_."+P[0];d&P[1]&&!Ba(u,j)&&u.push(j)}),u.sort()}function n1(u){if(u instanceof _i)return u.clone();var d=new hs(u.__wrapped__,u.__chain__);return d.__actions__=Ia(u.__actions__),d.__index__=u.__index__,d.__values__=u.__values__,d}function Lb(u,d,P){(P?va(u,d,P):d===t)?d=1:d=Z(Oi(d),0);var j=u==null?0:u.length;if(!j||d<1)return[];for(var ge=0,Fe=0,st=Bt(ls(j/d));ge<j;)st[Fe++]=Oa(u,ge,ge+=d);return st}function Cb(u){for(var d=-1,P=u==null?0:u.length,j=0,ge=[];++d<P;){var Fe=u[d];Fe&&(ge[j++]=Fe)}return ge}function Sb(){var u=arguments.length;if(!u)return[];for(var d=Bt(u-1),P=arguments[0],j=u;j--;)d[j-1]=arguments[j];return Qs(Ai(P)?Ia(P):[P],$e(d,1))}var Pb=Di(function(u,d){return Gs(u)?C(u,$e(d,1,Gs,!0)):[]}),Eb=Di(function(u,d){var P=_l(d);return Gs(P)&&(P=t),Gs(u)?C(u,$e(d,1,Gs,!0),ai(P,2)):[]}),Ab=Di(function(u,d){var P=_l(d);return Gs(P)&&(P=t),Gs(u)?C(u,$e(d,1,Gs,!0),t,P):[]});function Mb(u,d,P){var j=u==null?0:u.length;return j?(d=P||d===t?1:Oi(d),Oa(u,d<0?0:d,j)):[]}function kb(u,d,P){var j=u==null?0:u.length;return j?(d=P||d===t?1:Oi(d),d=j-d,Oa(u,0,d<0?0:d)):[]}function Tb(u,d){return u&&u.length?Du(u,ai(d,3),!0,!0):[]}function Bb(u,d){return u&&u.length?Du(u,ai(d,3),!0):[]}function Nb(u,d,P,j){var ge=u==null?0:u.length;return ge?(P&&typeof P!="number"&&va(u,d,P)&&(P=0,j=ge),ve(u,d,P,j)):[]}function i1(u,d,P){var j=u==null?0:u.length;if(!j)return-1;var ge=P==null?0:Oi(P);return ge<0&&(ge=Z(j+ge,0)),Ft(u,ai(d,3),ge)}function r1(u,d,P){var j=u==null?0:u.length;if(!j)return-1;var ge=j-1;return P!==t&&(ge=Oi(P),ge=P<0?Z(j+ge,0):_e(ge,j-1)),Ft(u,ai(d,3),ge,!0)}function s1(u){var d=u==null?0:u.length;return d?$e(u,1):[]}function Rb(u){var d=u==null?0:u.length;return d?$e(u,ce):[]}function Db(u,d){var P=u==null?0:u.length;return P?(d=d===t?1:Oi(d),$e(u,d)):[]}function Ob(u){for(var d=-1,P=u==null?0:u.length,j={};++d<P;){var ge=u[d];j[ge[0]]=ge[1]}return j}function o1(u){return u&&u.length?u[0]:t}function Ib(u,d,P){var j=u==null?0:u.length;if(!j)return-1;var ge=P==null?0:Oi(P);return ge<0&&(ge=Z(j+ge,0)),sn(u,d,ge)}function Fb(u){var d=u==null?0:u.length;return d?Oa(u,0,-1):[]}var zb=Di(function(u){var d=Ki(u,sc);return d.length&&d[0]===u[0]?fe(d):[]}),jb=Di(function(u){var d=_l(u),P=Ki(u,sc);return d===_l(P)?d=t:P.pop(),P.length&&P[0]===u[0]?fe(P,ai(d,2)):[]}),Ub=Di(function(u){var d=_l(u),P=Ki(u,sc);return d=typeof d=="function"?d:t,d&&P.pop(),P.length&&P[0]===u[0]?fe(P,t,d):[]});function $b(u,d){return u==null?"":w.call(u,d)}function _l(u){var d=u==null?0:u.length;return d?u[d-1]:t}function qb(u,d,P){var j=u==null?0:u.length;if(!j)return-1;var ge=j;return P!==t&&(ge=Oi(P),ge=ge<0?Z(j+ge,0):_e(ge,j-1)),d===d?Wo(u,d,ge):Ft(u,kn,ge,!0)}function Vb(u,d){return u&&u.length?ma(u,Oi(d)):t}var Gb=Di(a1);function a1(u,d){return u&&u.length&&d&&d.length?vh(u,d):u}function Hb(u,d,P){return u&&u.length&&d&&d.length?vh(u,d,ai(P,2)):u}function Wb(u,d,P){return u&&u.length&&d&&d.length?vh(u,d,t,P):u}var Zb=Iu(function(u,d){var P=u==null?0:u.length,j=Ln(u,d);return Bc(u,Ki(d,function(ge){return Fu(ge,P)?+ge:ge}).sort(km)),j});function Kb(u,d){var P=[];if(!(u&&u.length))return P;var j=-1,ge=[],Fe=u.length;for(d=ai(d,3);++j<Fe;){var st=u[j];d(st,j,u)&&(P.push(st),ge.push(j))}return Bc(u,ge),P}function o0(u){return u==null?u:tn.call(u)}function Jb(u,d,P){var j=u==null?0:u.length;return j?(P&&typeof P!="number"&&va(u,d,P)?(d=0,P=j):(d=d==null?0:Oi(d),P=P===t?j:Oi(P)),Oa(u,d,P)):[]}function Yb(u,d){return zl(u,d)}function Xb(u,d,P){return tf(u,d,ai(P,2))}function Qb(u,d){var P=u==null?0:u.length;if(P){var j=zl(u,d);if(j<P&&$l(u[j],d))return j}return-1}function e5(u,d){return zl(u,d,!0)}function t5(u,d,P){return tf(u,d,ai(P,2),!0)}function n5(u,d){var P=u==null?0:u.length;if(P){var j=zl(u,d,!0)-1;if($l(u[j],d))return j}return-1}function i5(u){return u&&u.length?nf(u):[]}function r5(u,d){return u&&u.length?nf(u,ai(d,2)):[]}function s5(u){var d=u==null?0:u.length;return d?Oa(u,1,d):[]}function o5(u,d,P){return u&&u.length?(d=P||d===t?1:Oi(d),Oa(u,0,d<0?0:d)):[]}function a5(u,d,P){var j=u==null?0:u.length;return j?(d=P||d===t?1:Oi(d),d=j-d,Oa(u,d<0?0:d,j)):[]}function l5(u,d){return u&&u.length?Du(u,ai(d,3),!1,!0):[]}function u5(u,d){return u&&u.length?Du(u,ai(d,3)):[]}var c5=Di(function(u){return uu($e(u,1,Gs,!0))}),h5=Di(function(u){var d=_l(u);return Gs(d)&&(d=t),uu($e(u,1,Gs,!0),ai(d,2))}),f5=Di(function(u){var d=_l(u);return d=typeof d=="function"?d:t,uu($e(u,1,Gs,!0),t,d)});function d5(u){return u&&u.length?uu(u):[]}function p5(u,d){return u&&u.length?uu(u,ai(d,2)):[]}function g5(u,d){return d=typeof d=="function"?d:t,u&&u.length?uu(u,t,d):[]}function a0(u){if(!(u&&u.length))return[];var d=0;return u=vo(u,function(P){if(Gs(P))return d=Z(P.length,d),!0}),Or(d,function(P){return Ki(u,ei(P))})}function l1(u,d){if(!(u&&u.length))return[];var P=a0(u);return d==null?P:Ki(P,function(j){return Zi(d,t,j)})}var m5=Di(function(u,d){return Gs(u)?C(u,d):[]}),v5=Di(function(u){return vl(vo(u,Gs))}),y5=Di(function(u){var d=_l(u);return Gs(d)&&(d=t),vl(vo(u,Gs),ai(d,2))}),_5=Di(function(u){var d=_l(u);return d=typeof d=="function"?d:t,vl(vo(u,Gs),t,d)}),b5=Di(a0);function w5(u,d){return jl(u||[],d||[],dt)}function x5(u,d){return jl(u||[],d||[],Nu)}var L5=Di(function(u){var d=u.length,P=d>1?u[d-1]:t;return P=typeof P=="function"?(u.pop(),P):t,l1(u,P)});function u1(u){var d=Te(u);return d.__chain__=!0,d}function C5(u,d){return d(u),u}function fd(u,d){return d(u)}var S5=Iu(function(u){var d=u.length,P=d?u[0]:0,j=this.__wrapped__,ge=function(Fe){return Ln(Fe,u)};return d>1||this.__actions__.length||!(j instanceof _i)||!Fu(P)?this.thru(ge):(j=j.slice(P,+P+(d?1:0)),j.__actions__.push({func:fd,args:[ge],thisArg:t}),new hs(j,this.__chain__).thru(function(Fe){return d&&!Fe.length&&Fe.push(t),Fe}))});function P5(){return u1(this)}function E5(){return new hs(this.value(),this.__chain__)}function A5(){this.__values__===t&&(this.__values__=L1(this.value()));var u=this.__index__>=this.__values__.length,d=u?t:this.__values__[this.__index__++];return{done:u,value:d}}function M5(){return this}function k5(u){for(var d,P=this;P instanceof Ol;){var j=n1(P);j.__index__=0,j.__values__=t,d?ge.__wrapped__=j:d=j;var ge=j;P=P.__wrapped__}return ge.__wrapped__=u,d}function T5(){var u=this.__wrapped__;if(u instanceof _i){var d=u;return this.__actions__.length&&(d=new _i(this)),d=d.reverse(),d.__actions__.push({func:fd,args:[o0],thisArg:t}),new hs(d,this.__chain__)}return this.thru(o0)}function B5(){return ml(this.__wrapped__,this.__actions__)}var N5=rd(function(u,d,P){Pi.call(u,P)?++u[P]:Sn(u,P,1)});function R5(u,d,P){var j=Ai(u)?Qa:q;return P&&va(u,d,P)&&(d=t),j(u,ai(d,3))}function D5(u,d){var P=Ai(u)?vo:Ke;return P(u,ai(d,3))}var O5=Om(i1),I5=Om(r1);function F5(u,d){return $e(dd(u,d),1)}function z5(u,d){return $e(dd(u,d),ce)}function j5(u,d,P){return P=P===t?1:Oi(P),$e(dd(u,d),P)}function c1(u,d){var P=Ai(u)?ss:k;return P(u,ai(d,3))}function h1(u,d){var P=Ai(u)?mo:I;return P(u,ai(d,3))}var U5=rd(function(u,d,P){Pi.call(u,P)?u[P].push(d):Sn(u,P,[d])});function $5(u,d,P,j){u=Fa(u)?u:Ph(u),P=P&&!j?Oi(P):0;var ge=u.length;return P<0&&(P=Z(ge+P,0)),yd(u)?P<=ge&&u.indexOf(d,P)>-1:!!ge&&sn(u,d,P)>-1}var q5=Di(function(u,d,P){var j=-1,ge=typeof d=="function",Fe=Fa(u)?Bt(u.length):[];return k(u,function(st){Fe[++j]=ge?Zi(d,st,P):De(st,d,P)}),Fe}),V5=rd(function(u,d,P){Sn(u,P,d)});function dd(u,d){var P=Ai(u)?Ki:ur;return P(u,ai(d,3))}function G5(u,d,P,j){return u==null?[]:(Ai(d)||(d=d==null?[]:[d]),P=j?t:P,Ai(P)||(P=P==null?[]:[P]),lu(u,d,P))}var H5=rd(function(u,d,P){u[P?0:1].push(d)},function(){return[[],[]]});function W5(u,d,P){var j=Ai(u)?Ho:gr,ge=arguments.length<3;return j(u,ai(d,4),P,ge,k)}function Z5(u,d,P){var j=Ai(u)?Dr:gr,ge=arguments.length<3;return j(u,ai(d,4),P,ge,I)}function K5(u,d){var P=Ai(u)?vo:Ke;return P(u,md(ai(d,3)))}function J5(u){var d=Ai(u)?Ot:_h;return d(u)}function Y5(u,d,P){(P?va(u,d,P):d===t)?d=1:d=Oi(d);var j=Ai(u)?Lt:Qf;return j(u,d)}function X5(u){var d=Ai(u)?Vt:td;return d(u)}function Q5(u){if(u==null)return 0;if(Fa(u))return yd(u)?vs(u):u.length;var d=ta(u);return d==xe||d==Oe?u.size:Hi(u).length}function ew(u,d,P){var j=Ai(u)?A:nd;return P&&va(u,d,P)&&(d=t),j(u,ai(d,3))}var tw=Di(function(u,d){if(u==null)return[];var P=d.length;return P>1&&va(u,d[0],d[1])?d=[]:P>2&&va(d[0],d[1],d[2])&&(d=[d[0]]),lu(u,$e(d,1),[])}),pd=Ns||function(){return Nr.Date.now()};function nw(u,d){if(typeof d!="function")throw new br(l);return u=Oi(u),function(){if(--u<1)return d.apply(this,arguments)}}function f1(u,d,P){return d=P?t:d,d=u&&d==null?u.length:d,Ou(u,Ve,t,t,t,t,d)}function d1(u,d){var P;if(typeof d!="function")throw new br(l);return u=Oi(u),function(){return--u>0&&(P=d.apply(this,arguments)),u<=1&&(d=t),P}}var l0=Di(function(u,d,P){var j=Q;if(P.length){var ge=ks(P,Ch(l0));j|=Ie}return Ou(u,j,d,P,ge)}),p1=Di(function(u,d,P){var j=Q|F;if(P.length){var ge=ks(P,Ch(p1));j|=Ie}return Ou(d,j,u,P,ge)});function g1(u,d,P){d=P?t:d;var j=Ou(u,me,t,t,t,t,t,d);return j.placeholder=g1.placeholder,j}function m1(u,d,P){d=P?t:d;var j=Ou(u,Se,t,t,t,t,t,d);return j.placeholder=m1.placeholder,j}function v1(u,d,P){var j,ge,Fe,st,gt,kt,nn=0,rn=!1,dn=!1,Bn=!0;if(typeof u!="function")throw new br(l);d=bl(d)||0,Cs(P)&&(rn=!!P.leading,dn="maxWait"in P,Fe=dn?Z(bl(P.maxWait)||0,d):Fe,Bn="trailing"in P?!!P.trailing:Bn);function Hn(Hs){var ql=j,Uu=ge;return j=ge=t,nn=Hs,st=u.apply(Uu,ql),st}function ui(Hs){return nn=Hs,gt=of(Qi,d),rn?Hn(Hs):st}function ji(Hs){var ql=Hs-kt,Uu=Hs-nn,O1=d-ql;return dn?_e(O1,Fe-Uu):O1}function ci(Hs){var ql=Hs-kt,Uu=Hs-nn;return kt===t||ql>=d||ql<0||dn&&Uu>=Fe}function Qi(){var Hs=pd();if(ci(Hs))return rr(Hs);gt=of(Qi,ji(Hs))}function rr(Hs){return gt=t,Bn&&j?Hn(Hs):(j=ge=t,st)}function il(){gt!==t&&wh(gt),nn=0,j=kt=ge=gt=t}function ya(){return gt===t?st:rr(pd())}function rl(){var Hs=pd(),ql=ci(Hs);if(j=arguments,ge=this,kt=Hs,ql){if(gt===t)return ui(kt);if(dn)return wh(gt),gt=of(Qi,d),Hn(kt)}return gt===t&&(gt=of(Qi,d)),st}return rl.cancel=il,rl.flush=ya,rl}var iw=Di(function(u,d){return y(u,1,d)}),rw=Di(function(u,d,P){return y(u,bl(d)||0,P)});function sw(u){return Ou(u,W)}function gd(u,d){if(typeof u!="function"||d!=null&&typeof d!="function")throw new br(l);var P=function(){var j=arguments,ge=d?d.apply(this,j):j[0],Fe=P.cache;if(Fe.has(ge))return Fe.get(ge);var st=u.apply(this,j);return P.cache=Fe.set(ge,st)||Fe,st};return P.cache=new(gd.Cache||Qo),P}gd.Cache=Qo;function md(u){if(typeof u!="function")throw new br(l);return function(){var d=arguments;switch(d.length){case 0:return!u.call(this);case 1:return!u.call(this,d[0]);case 2:return!u.call(this,d[0],d[1]);case 3:return!u.call(this,d[0],d[1],d[2])}return!u.apply(this,d)}}function ow(u){return d1(2,u)}var aw=Wp(function(u,d){d=d.length==1&&Ai(d[0])?Ki(d[0],yi(ai())):Ki($e(d,1),yi(ai()));var P=d.length;return Di(function(j){for(var ge=-1,Fe=_e(j.length,P);++ge<Fe;)j[ge]=d[ge].call(this,j[ge]);return Zi(u,this,j)})}),u0=Di(function(u,d){var P=ks(d,Ch(u0));return Ou(u,Ie,t,d,P)}),y1=Di(function(u,d){var P=ks(d,Ch(y1));return Ou(u,nt,t,d,P)}),lw=Iu(function(u,d){return Ou(u,O,t,t,t,d)});function uw(u,d){if(typeof u!="function")throw new br(l);return d=d===t?d:Oi(d),Di(u,d)}function cw(u,d){if(typeof u!="function")throw new br(l);return d=d==null?0:Z(Oi(d),0),Di(function(P){var j=P[d],ge=yl(P,0,d);return j&&Qs(ge,j),Zi(u,this,ge)})}function hw(u,d,P){var j=!0,ge=!0;if(typeof u!="function")throw new br(l);return Cs(P)&&(j="leading"in P?!!P.leading:j,ge="trailing"in P?!!P.trailing:ge),v1(u,d,{leading:j,maxWait:d,trailing:ge})}function fw(u){return f1(u,1)}function dw(u,d){return u0(Dc(d),u)}function pw(){if(!arguments.length)return[];var u=arguments[0];return Ai(u)?u:[u]}function gw(u){return a(u,b)}function mw(u,d){return d=typeof d=="function"?d:t,a(u,b,d)}function vw(u){return a(u,x|b)}function yw(u,d){return d=typeof d=="function"?d:t,a(u,x|b,d)}function _w(u,d){return d==null||p(u,d,xo(d))}function $l(u,d){return u===d||u!==u&&d!==d}var bw=ld(ht),ww=ld(function(u,d){return u>=d}),Fc=Ne(function(){return arguments}())?Ne:function(u){return Rs(u)&&Pi.call(u,"callee")&&!or.call(u,"callee")},Ai=Bt.isArray,xw=dl?yi(dl):ze;function Fa(u){return u!=null&&vd(u.length)&&!zu(u)}function Gs(u){return Rs(u)&&Fa(u)}function Lw(u){return u===!0||u===!1||Rs(u)&&it(u)==ie}var oc=s||b0,Cw=Mo?yi(Mo):Ue;function Sw(u){return Rs(u)&&u.nodeType===1&&!af(u)}function Pw(u){if(u==null)return!0;if(Fa(u)&&(Ai(u)||typeof u=="string"||typeof u.splice=="function"||oc(u)||Sh(u)||Fc(u)))return!u.length;var d=ta(u);if(d==xe||d==Oe)return!u.size;if(sf(u))return!Hi(u).length;for(var P in u)if(Pi.call(u,P))return!1;return!0}function Ew(u,d){return lt(u,d)}function Aw(u,d,P){P=typeof P=="function"?P:t;var j=P?P(u,d):t;return j===t?lt(u,d,t,P):!!j}function c0(u){if(!Rs(u))return!1;var d=it(u);return d==Ce||d==se||typeof u.message=="string"&&typeof u.name=="string"&&!af(u)}function Mw(u){return typeof u=="number"&&f(u)}function zu(u){if(!Cs(u))return!1;var d=it(u);return d==ne||d==ae||d==te||d==Ae}function _1(u){return typeof u=="number"&&u==Oi(u)}function vd(u){return typeof u=="number"&&u>-1&&u%1==0&&u<=re}function Cs(u){var d=typeof u;return u!=null&&(d=="object"||d=="function")}function Rs(u){return u!=null&&typeof u=="object"}var b1=Ja?yi(Ja):pt;function kw(u,d){return u===d||Et(u,d,e0(d))}function Tw(u,d,P){return P=typeof P=="function"?P:t,Et(u,d,e0(d),P)}function Bw(u){return w1(u)&&u!=+u}function Nw(u){if(mb(u))throw new In(o);return At(u)}function Rw(u){return u===null}function Dw(u){return u==null}function w1(u){return typeof u=="number"||Rs(u)&&it(u)==ye}function af(u){if(!Rs(u)||it(u)!=je)return!1;var d=Io(u);if(d===null)return!0;var P=Pi.call(d,"constructor")&&d.constructor;return typeof P=="function"&&P instanceof P&&Oo.call(P)==nr}var h0=Ya?yi(Ya):en;function Ow(u){return _1(u)&&u>=-9007199254740991&&u<=re}var x1=ao?yi(ao):Tn;function yd(u){return typeof u=="string"||!Ai(u)&&Rs(u)&&it(u)==et}function nl(u){return typeof u=="symbol"||Rs(u)&&it(u)==Je}var Sh=Xa?yi(Xa):Rn;function Iw(u){return u===t}function Fw(u){return Rs(u)&&ta(u)==_t}function zw(u){return Rs(u)&&it(u)==$t}var jw=ld(Ei),Uw=ld(function(u,d){return u<=d});function L1(u){if(!u)return[];if(Fa(u))return yd(u)?ys(u):Ia(u);if(Yn&&u[Yn])return zs(u[Yn]());var d=ta(u),P=d==xe?Da:d==Oe?Ts:Ph;return P(u)}function ju(u){if(!u)return u===0?u:0;if(u=bl(u),u===ce||u===-1/0){var d=u<0?-1:1;return d*Pe}return u===u?u:0}function Oi(u){var d=ju(u),P=d%1;return d===d?P?d-P:d:0}function C1(u){return u?$n(Oi(u),0,ot):0}function bl(u){if(typeof u=="number")return u;if(nl(u))return Me;if(Cs(u)){var d=typeof u.valueOf=="function"?u.valueOf():u;u=Cs(d)?d+"":d}if(typeof u!="string")return u===0?u:+u;u=eo(u);var P=Qr.test(u);return P||An.test(u)?Ka(u.slice(2),P?2:8):fs.test(u)?Me:+u}function S1(u){return cu(u,za(u))}function $w(u){return u?$n(Oi(u),-9007199254740991,re):u===0?u:0}function xr(u){return u==null?"":ea(u)}var qw=xh(function(u,d){if(sf(d)||Fa(d)){cu(d,xo(d),u);return}for(var P in d)Pi.call(d,P)&&dt(u,P,d[P])}),P1=xh(function(u,d){cu(d,za(d),u)}),_d=xh(function(u,d,P,j){cu(d,za(d),u,j)}),Vw=xh(function(u,d,P,j){cu(d,xo(d),u,j)}),Gw=Iu(Ln);function Hw(u,d){var P=qs(u);return d==null?P:an(P,d)}var Ww=Di(function(u,d){u=Yi(u);var P=-1,j=d.length,ge=j>2?d[2]:t;for(ge&&va(d[0],d[1],ge)&&(j=1);++P<j;)for(var Fe=d[P],st=za(Fe),gt=-1,kt=st.length;++gt<kt;){var nn=st[gt],rn=u[nn];(rn===t||$l(rn,Ro[nn])&&!Pi.call(u,nn))&&(u[nn]=Fe[nn])}return u}),Zw=Di(function(u){return u.push(t,qm),Zi(E1,t,u)});function Kw(u,d){return St(u,ai(d,3),Wt)}function Jw(u,d){return St(u,ai(d,3),gn)}function Yw(u,d){return u==null?u:vt(u,ai(d,3),za)}function Xw(u,d){return u==null?u:Nt(u,ai(d,3),za)}function Qw(u,d){return u&&Wt(u,ai(d,3))}function e3(u,d){return u&&gn(u,ai(d,3))}function t3(u){return u==null?[]:bn(u,xo(u))}function n3(u){return u==null?[]:bn(u,za(u))}function f0(u,d,P){var j=u==null?t:Zn(u,d);return j===t?P:j}function i3(u,d){return u!=null&&Hm(u,d,It)}function d0(u,d){return u!=null&&Hm(u,d,xt)}var r3=Fm(function(u,d,P){d!=null&&typeof d.toString!="function"&&(d=Xi.call(d)),u[d]=P},g0(ja)),s3=Fm(function(u,d,P){d!=null&&typeof d.toString!="function"&&(d=Xi.call(d)),Pi.call(u,d)?u[d].push(P):u[d]=[P]},ai),o3=Di(De);function xo(u){return Fa(u)?Dt(u):Hi(u)}function za(u){return Fa(u)?Dt(u,!0):ir(u)}function a3(u,d){var P={};return d=ai(d,3),Wt(u,function(j,ge,Fe){Sn(P,d(j,ge,Fe),j)}),P}function l3(u,d){var P={};return d=ai(d,3),Wt(u,function(j,ge,Fe){Sn(P,ge,d(j,ge,Fe))}),P}var u3=xh(function(u,d,P){zo(u,d,P)}),E1=xh(function(u,d,P,j){zo(u,d,P,j)}),c3=Iu(function(u,d){var P={};if(u==null)return P;var j=!1;d=Ki(d,function(Fe){return Fe=Ul(Fe,u),j||(j=Fe.length>1),Fe}),cu(u,Xp(u),P),j&&(P=a(P,x|E|b,rb));for(var ge=d.length;ge--;)Ru(P,d[ge]);return P});function h3(u,d){return A1(u,md(ai(d)))}var f3=Iu(function(u,d){return u==null?{}:jo(u,d)});function A1(u,d){if(u==null)return{};var P=Ki(Xp(u),function(j){return[j]});return d=ai(d),Ls(u,P,function(j,ge){return d(j,ge[0])})}function d3(u,d,P){d=Ul(d,u);var j=-1,ge=d.length;for(ge||(ge=1,u=t);++j<ge;){var Fe=u==null?t:u[hu(d[j])];Fe===t&&(j=ge,Fe=P),u=zu(Fe)?Fe.call(u):Fe}return u}function p3(u,d,P){return u==null?u:Nu(u,d,P)}function g3(u,d,P,j){return j=typeof j=="function"?j:t,u==null?u:Nu(u,d,P,j)}var M1=Um(xo),k1=Um(za);function m3(u,d,P){var j=Ai(u),ge=j||oc(u)||Sh(u);if(d=ai(d,4),P==null){var Fe=u&&u.constructor;ge?P=j?new Fe:[]:Cs(u)?P=zu(Fe)?qs(Io(u)):{}:P={}}return(ge?ss:Wt)(u,function(st,gt,kt){return d(P,st,gt,kt)}),P}function v3(u,d){return u==null?!0:Ru(u,d)}function y3(u,d,P){return u==null?u:bh(u,d,Dc(P))}function _3(u,d,P,j){return j=typeof j=="function"?j:t,u==null?u:bh(u,d,Dc(P),j)}function Ph(u){return u==null?[]:gs(u,xo(u))}function b3(u){return u==null?[]:gs(u,za(u))}function w3(u,d,P){return P===t&&(P=d,d=t),P!==t&&(P=bl(P),P=P===P?P:0),d!==t&&(d=bl(d),d=d===d?d:0),$n(bl(u),d,P)}function x3(u,d,P){return d=ju(d),P===t?(P=d,d=0):P=ju(P),u=bl(u),Rt(u,d,P)}function L3(u,d,P){if(P&&typeof P!="boolean"&&va(u,d,P)&&(d=P=t),P===t&&(typeof d=="boolean"?(P=d,d=t):typeof u=="boolean"&&(P=u,u=t)),u===t&&d===t?(u=0,d=1):(u=ju(u),d===t?(d=u,u=0):d=ju(d)),u>d){var j=u;u=d,d=j}if(P||u%1||d%1){var ge=zt();return _e(u+ge*(d-u+ka("1e-"+((ge+"").length-1))),d)}return Nc(u,d)}var C3=Lh(function(u,d,P){return d=d.toLowerCase(),u+(P?T1(d):d)});function T1(u){return p0(xr(u).toLowerCase())}function B1(u){return u=xr(u),u&&u.replace(Ui,Rl).replace(Bl,"")}function S3(u,d,P){u=xr(u),d=ea(d);var j=u.length;P=P===t?j:$n(Oi(P),0,j);var ge=P;return P-=d.length,P>=0&&u.slice(P,ge)==d}function P3(u){return u=xr(u),u&&Mt.test(u)?u.replace(Sr,da):u}function E3(u){return u=xr(u),u&&hr.test(u)?u.replace(pi,"\\$&"):u}var A3=Lh(function(u,d,P){return u+(P?"-":"")+d.toLowerCase()}),M3=Lh(function(u,d,P){return u+(P?" ":"")+d.toLowerCase()}),k3=Dm("toLowerCase");function T3(u,d,P){u=xr(u),d=Oi(d);var j=d?vs(u):0;if(!d||j>=d)return u;var ge=(d-j)/2;return ad(us(ge),P)+u+ad(ls(ge),P)}function B3(u,d,P){u=xr(u),d=Oi(d);var j=d?vs(u):0;return d&&j<d?u+ad(d-j,P):u}function N3(u,d,P){u=xr(u),d=Oi(d);var j=d?vs(u):0;return d&&j<d?ad(d-j,P)+u:u}function R3(u,d,P){return P||d==null?d=0:d&&(d=+d),Tt(xr(u).replace(bi,""),d||0)}function D3(u,d,P){return(P?va(u,d,P):d===t)?d=1:d=Oi(d),yh(xr(u),d)}function O3(){var u=arguments,d=xr(u[0]);return u.length<3?d:d.replace(u[1],u[2])}var I3=Lh(function(u,d,P){return u+(P?"_":"")+d.toLowerCase()});function F3(u,d,P){return P&&typeof P!="number"&&va(u,d,P)&&(d=P=t),P=P===t?ot:P>>>0,P?(u=xr(u),u&&(typeof d=="string"||d!=null&&!h0(d))&&(d=ea(d),!d&&To(u))?yl(ys(u),0,P):u.split(d,P)):[]}var z3=Lh(function(u,d,P){return u+(P?" ":"")+p0(d)});function j3(u,d,P){return u=xr(u),P=P==null?0:$n(Oi(P),0,u.length),d=ea(d),u.slice(P,P+d.length)==d}function U3(u,d,P){var j=Te.templateSettings;P&&va(u,d,P)&&(d=t),u=xr(u),d=_d({},d,j,$m);var ge=_d({},d.imports,j.imports,$m),Fe=xo(ge),st=gs(ge,Fe),gt,kt,nn=0,rn=d.interpolate||Vi,dn="__p += '",Bn=el((d.escape||Vi).source+"|"+rn.source+"|"+(rn===zi?Qn:Vi).source+"|"+(d.evaluate||Vi).source+"|$","g"),Hn="//# sourceURL="+(Pi.call(d,"sourceURL")?(d.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Wa+"]")+`
`;u.replace(Bn,function(ci,Qi,rr,il,ya,rl){return rr||(rr=il),dn+=u.slice(nn,rl).replace(dr,pa),Qi&&(gt=!0,dn+=`' +
__e(`+Qi+`) +
'`),ya&&(kt=!0,dn+=`';
`+ya+`;
__p += '`),rr&&(dn+=`' +
((__t = (`+rr+`)) == null ? '' : __t) +
'`),nn=rl+ci.length,ci}),dn+=`';
`;var ui=Pi.call(d,"variable")&&d.variable;if(!ui)dn=`with (obj) {
`+dn+`
}
`;else if(qr.test(ui))throw new In(h);dn=(kt?dn.replace(vn,""):dn).replace(ni,"$1").replace(fn,"$1;"),dn="function("+(ui||"obj")+`) {
`+(ui?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(gt?", __e = _.escape":"")+(kt?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+dn+`return __p
}`;var ji=R1(function(){return si(Fe,Hn+"return "+dn).apply(t,st)});if(ji.source=dn,c0(ji))throw ji;return ji}function $3(u){return xr(u).toLowerCase()}function q3(u){return xr(u).toUpperCase()}function V3(u,d,P){if(u=xr(u),u&&(P||d===t))return eo(u);if(!u||!(d=ea(d)))return u;var j=ys(u),ge=ys(d),Fe=Ms(j,ge),st=pl(j,ge)+1;return yl(j,Fe,st).join("")}function G3(u,d,P){if(u=xr(u),u&&(P||d===t))return u.slice(0,Zo(u)+1);if(!u||!(d=ea(d)))return u;var j=ys(u),ge=pl(j,ys(d))+1;return yl(j,0,ge).join("")}function H3(u,d,P){if(u=xr(u),u&&(P||d===t))return u.replace(bi,"");if(!u||!(d=ea(d)))return u;var j=ys(u),ge=Ms(j,ys(d));return yl(j,ge).join("")}function W3(u,d){var P=ue,j=z;if(Cs(d)){var ge="separator"in d?d.separator:ge;P="length"in d?Oi(d.length):P,j="omission"in d?ea(d.omission):j}u=xr(u);var Fe=u.length;if(To(u)){var st=ys(u);Fe=st.length}if(P>=Fe)return u;var gt=P-vs(j);if(gt<1)return j;var kt=st?yl(st,0,gt).join(""):u.slice(0,gt);if(ge===t)return kt+j;if(st&&(gt+=kt.length-gt),h0(ge)){if(u.slice(gt).search(ge)){var nn,rn=kt;for(ge.global||(ge=el(ge.source,xr(fr.exec(ge))+"g")),ge.lastIndex=0;nn=ge.exec(rn);)var dn=nn.index;kt=kt.slice(0,dn===t?gt:dn)}}else if(u.indexOf(ea(ge),gt)!=gt){var Bn=kt.lastIndexOf(ge);Bn>-1&&(kt=kt.slice(0,Bn))}return kt+j}function Z3(u){return u=xr(u),u&&Ii.test(u)?u.replace(Mn,Ko):u}var K3=Lh(function(u,d,P){return u+(P?" ":"")+d.toUpperCase()}),p0=Dm("toUpperCase");function N1(u,d,P){return u=xr(u),d=P?t:d,d===t?to(u)?Bo(u):ct(u):u.match(d)||[]}var R1=Di(function(u,d){try{return Zi(u,t,d)}catch(P){return c0(P)?P:new In(P)}}),J3=Iu(function(u,d){return ss(d,function(P){P=hu(P),Sn(u,P,l0(u[P],u))}),u});function Y3(u){var d=u==null?0:u.length,P=ai();return u=d?Ki(u,function(j){if(typeof j[1]!="function")throw new br(l);return[P(j[0]),j[1]]}):[],Di(function(j){for(var ge=-1;++ge<d;){var Fe=u[ge];if(Zi(Fe[0],this,j))return Zi(Fe[1],this,j)}})}function X3(u){return c(a(u,x))}function g0(u){return function(){return u}}function Q3(u,d){return u==null||u!==u?d:u}var ex=Im(),tx=Im(!0);function ja(u){return u}function m0(u){return qn(typeof u=="function"?u:a(u,x))}function nx(u){return Vs(a(u,x))}function ix(u,d){return Il(u,a(d,x))}var rx=Di(function(u,d){return function(P){return De(P,u,d)}}),sx=Di(function(u,d){return function(P){return De(u,P,d)}});function v0(u,d,P){var j=xo(d),ge=bn(d,j);P==null&&!(Cs(d)&&(ge.length||!j.length))&&(P=d,d=u,u=this,ge=bn(d,xo(d)));var Fe=!(Cs(P)&&"chain"in P)||!!P.chain,st=zu(u);return ss(ge,function(gt){var kt=d[gt];u[gt]=kt,st&&(u.prototype[gt]=function(){var nn=this.__chain__;if(Fe||nn){var rn=u(this.__wrapped__),dn=rn.__actions__=Ia(this.__actions__);return dn.push({func:kt,args:arguments,thisArg:u}),rn.__chain__=nn,rn}return kt.apply(u,Qs([this.value()],arguments))})}),u}function ox(){return Nr._===this&&(Nr._=Ir),this}function y0(){}function ax(u){return u=Oi(u),Di(function(d){return ma(d,u)})}var lx=Kp(Ki),ux=Kp(Qa),cx=Kp(A);function D1(u){return n0(u)?ei(hu(u)):Fr(u)}function hx(u){return function(d){return u==null?t:Zn(u,d)}}var fx=zm(),dx=zm(!0);function _0(){return[]}function b0(){return!1}function px(){return{}}function gx(){return""}function mx(){return!0}function vx(u,d){if(u=Oi(u),u<1||u>re)return[];var P=ot,j=_e(u,ot);d=ai(d),u-=ot;for(var ge=Or(j,d);++P<u;)d(P);return ge}function yx(u){return Ai(u)?Ki(u,hu):nl(u)?[u]:Ia(t1(xr(u)))}function _x(u){var d=++yo;return xr(u)+d}var bx=od(function(u,d){return u+d},0),wx=Jp("ceil"),xx=od(function(u,d){return u/d},1),Lx=Jp("floor");function Cx(u){return u&&u.length?oe(u,ja,ht):t}function Sx(u,d){return u&&u.length?oe(u,ai(d,2),ht):t}function Px(u){return Vn(u,ja)}function Ex(u,d){return Vn(u,ai(d,2))}function Ax(u){return u&&u.length?oe(u,ja,Ei):t}function Mx(u,d){return u&&u.length?oe(u,ai(d,2),Ei):t}var kx=od(function(u,d){return u*d},1),Tx=Jp("round"),Bx=od(function(u,d){return u-d},0);function Nx(u){return u&&u.length?Ji(u,ja):0}function Rx(u,d){return u&&u.length?Ji(u,ai(d,2)):0}return Te.after=nw,Te.ary=f1,Te.assign=qw,Te.assignIn=P1,Te.assignInWith=_d,Te.assignWith=Vw,Te.at=Gw,Te.before=d1,Te.bind=l0,Te.bindAll=J3,Te.bindKey=p1,Te.castArray=pw,Te.chain=u1,Te.chunk=Lb,Te.compact=Cb,Te.concat=Sb,Te.cond=Y3,Te.conforms=X3,Te.constant=g0,Te.countBy=N5,Te.create=Hw,Te.curry=g1,Te.curryRight=m1,Te.debounce=v1,Te.defaults=Ww,Te.defaultsDeep=Zw,Te.defer=iw,Te.delay=rw,Te.difference=Pb,Te.differenceBy=Eb,Te.differenceWith=Ab,Te.drop=Mb,Te.dropRight=kb,Te.dropRightWhile=Tb,Te.dropWhile=Bb,Te.fill=Nb,Te.filter=D5,Te.flatMap=F5,Te.flatMapDeep=z5,Te.flatMapDepth=j5,Te.flatten=s1,Te.flattenDeep=Rb,Te.flattenDepth=Db,Te.flip=sw,Te.flow=ex,Te.flowRight=tx,Te.fromPairs=Ob,Te.functions=t3,Te.functionsIn=n3,Te.groupBy=U5,Te.initial=Fb,Te.intersection=zb,Te.intersectionBy=jb,Te.intersectionWith=Ub,Te.invert=r3,Te.invertBy=s3,Te.invokeMap=q5,Te.iteratee=m0,Te.keyBy=V5,Te.keys=xo,Te.keysIn=za,Te.map=dd,Te.mapKeys=a3,Te.mapValues=l3,Te.matches=nx,Te.matchesProperty=ix,Te.memoize=gd,Te.merge=u3,Te.mergeWith=E1,Te.method=rx,Te.methodOf=sx,Te.mixin=v0,Te.negate=md,Te.nthArg=ax,Te.omit=c3,Te.omitBy=h3,Te.once=ow,Te.orderBy=G5,Te.over=lx,Te.overArgs=aw,Te.overEvery=ux,Te.overSome=cx,Te.partial=u0,Te.partialRight=y1,Te.partition=H5,Te.pick=f3,Te.pickBy=A1,Te.property=D1,Te.propertyOf=hx,Te.pull=Gb,Te.pullAll=a1,Te.pullAllBy=Hb,Te.pullAllWith=Wb,Te.pullAt=Zb,Te.range=fx,Te.rangeRight=dx,Te.rearg=lw,Te.reject=K5,Te.remove=Kb,Te.rest=uw,Te.reverse=o0,Te.sampleSize=Y5,Te.set=p3,Te.setWith=g3,Te.shuffle=X5,Te.slice=Jb,Te.sortBy=tw,Te.sortedUniq=i5,Te.sortedUniqBy=r5,Te.split=F3,Te.spread=cw,Te.tail=s5,Te.take=o5,Te.takeRight=a5,Te.takeRightWhile=l5,Te.takeWhile=u5,Te.tap=C5,Te.throttle=hw,Te.thru=fd,Te.toArray=L1,Te.toPairs=M1,Te.toPairsIn=k1,Te.toPath=yx,Te.toPlainObject=S1,Te.transform=m3,Te.unary=fw,Te.union=c5,Te.unionBy=h5,Te.unionWith=f5,Te.uniq=d5,Te.uniqBy=p5,Te.uniqWith=g5,Te.unset=v3,Te.unzip=a0,Te.unzipWith=l1,Te.update=y3,Te.updateWith=_3,Te.values=Ph,Te.valuesIn=b3,Te.without=m5,Te.words=N1,Te.wrap=dw,Te.xor=v5,Te.xorBy=y5,Te.xorWith=_5,Te.zip=b5,Te.zipObject=w5,Te.zipObjectDeep=x5,Te.zipWith=L5,Te.entries=M1,Te.entriesIn=k1,Te.extend=P1,Te.extendWith=_d,v0(Te,Te),Te.add=bx,Te.attempt=R1,Te.camelCase=C3,Te.capitalize=T1,Te.ceil=wx,Te.clamp=w3,Te.clone=gw,Te.cloneDeep=vw,Te.cloneDeepWith=yw,Te.cloneWith=mw,Te.conformsTo=_w,Te.deburr=B1,Te.defaultTo=Q3,Te.divide=xx,Te.endsWith=S3,Te.eq=$l,Te.escape=P3,Te.escapeRegExp=E3,Te.every=R5,Te.find=O5,Te.findIndex=i1,Te.findKey=Kw,Te.findLast=I5,Te.findLastIndex=r1,Te.findLastKey=Jw,Te.floor=Lx,Te.forEach=c1,Te.forEachRight=h1,Te.forIn=Yw,Te.forInRight=Xw,Te.forOwn=Qw,Te.forOwnRight=e3,Te.get=f0,Te.gt=bw,Te.gte=ww,Te.has=i3,Te.hasIn=d0,Te.head=o1,Te.identity=ja,Te.includes=$5,Te.indexOf=Ib,Te.inRange=x3,Te.invoke=o3,Te.isArguments=Fc,Te.isArray=Ai,Te.isArrayBuffer=xw,Te.isArrayLike=Fa,Te.isArrayLikeObject=Gs,Te.isBoolean=Lw,Te.isBuffer=oc,Te.isDate=Cw,Te.isElement=Sw,Te.isEmpty=Pw,Te.isEqual=Ew,Te.isEqualWith=Aw,Te.isError=c0,Te.isFinite=Mw,Te.isFunction=zu,Te.isInteger=_1,Te.isLength=vd,Te.isMap=b1,Te.isMatch=kw,Te.isMatchWith=Tw,Te.isNaN=Bw,Te.isNative=Nw,Te.isNil=Dw,Te.isNull=Rw,Te.isNumber=w1,Te.isObject=Cs,Te.isObjectLike=Rs,Te.isPlainObject=af,Te.isRegExp=h0,Te.isSafeInteger=Ow,Te.isSet=x1,Te.isString=yd,Te.isSymbol=nl,Te.isTypedArray=Sh,Te.isUndefined=Iw,Te.isWeakMap=Fw,Te.isWeakSet=zw,Te.join=$b,Te.kebabCase=A3,Te.last=_l,Te.lastIndexOf=qb,Te.lowerCase=M3,Te.lowerFirst=k3,Te.lt=jw,Te.lte=Uw,Te.max=Cx,Te.maxBy=Sx,Te.mean=Px,Te.meanBy=Ex,Te.min=Ax,Te.minBy=Mx,Te.stubArray=_0,Te.stubFalse=b0,Te.stubObject=px,Te.stubString=gx,Te.stubTrue=mx,Te.multiply=kx,Te.nth=Vb,Te.noConflict=ox,Te.noop=y0,Te.now=pd,Te.pad=T3,Te.padEnd=B3,Te.padStart=N3,Te.parseInt=R3,Te.random=L3,Te.reduce=W5,Te.reduceRight=Z5,Te.repeat=D3,Te.replace=O3,Te.result=d3,Te.round=Tx,Te.runInContext=bt,Te.sample=J5,Te.size=Q5,Te.snakeCase=I3,Te.some=ew,Te.sortedIndex=Yb,Te.sortedIndexBy=Xb,Te.sortedIndexOf=Qb,Te.sortedLastIndex=e5,Te.sortedLastIndexBy=t5,Te.sortedLastIndexOf=n5,Te.startCase=z3,Te.startsWith=j3,Te.subtract=Bx,Te.sum=Nx,Te.sumBy=Rx,Te.template=U3,Te.times=vx,Te.toFinite=ju,Te.toInteger=Oi,Te.toLength=C1,Te.toLower=$3,Te.toNumber=bl,Te.toSafeInteger=$w,Te.toString=xr,Te.toUpper=q3,Te.trim=V3,Te.trimEnd=G3,Te.trimStart=H3,Te.truncate=W3,Te.unescape=Z3,Te.uniqueId=_x,Te.upperCase=K3,Te.upperFirst=p0,Te.each=c1,Te.eachRight=h1,Te.first=o1,v0(Te,function(){var u={};return Wt(Te,function(d,P){Pi.call(Te.prototype,P)||(u[P]=d)}),u}(),{chain:!1}),Te.VERSION=i,ss(["bind","bindKey","curry","curryRight","partial","partialRight"],function(u){Te[u].placeholder=Te}),ss(["drop","take"],function(u,d){_i.prototype[u]=function(P){P=P===t?1:Z(Oi(P),0);var j=this.__filtered__&&!d?new _i(this):this.clone();return j.__filtered__?j.__takeCount__=_e(P,j.__takeCount__):j.__views__.push({size:_e(P,ot),type:u+(j.__dir__<0?"Right":"")}),j},_i.prototype[u+"Right"]=function(P){return this.reverse()[u](P).reverse()}}),ss(["filter","map","takeWhile"],function(u,d){var P=d+1,j=P==V||P==Y;_i.prototype[u]=function(ge){var Fe=this.clone();return Fe.__iteratees__.push({iteratee:ai(ge,3),type:P}),Fe.__filtered__=Fe.__filtered__||j,Fe}}),ss(["head","last"],function(u,d){var P="take"+(d?"Right":"");_i.prototype[u]=function(){return this[P](1).value()[0]}}),ss(["initial","tail"],function(u,d){var P="drop"+(d?"":"Right");_i.prototype[u]=function(){return this.__filtered__?new _i(this):this[P](1)}}),_i.prototype.compact=function(){return this.filter(ja)},_i.prototype.find=function(u){return this.filter(u).head()},_i.prototype.findLast=function(u){return this.reverse().find(u)},_i.prototype.invokeMap=Di(function(u,d){return typeof u=="function"?new _i(this):this.map(function(P){return De(P,u,d)})}),_i.prototype.reject=function(u){return this.filter(md(ai(u)))},_i.prototype.slice=function(u,d){u=Oi(u);var P=this;return P.__filtered__&&(u>0||d<0)?new _i(P):(u<0?P=P.takeRight(-u):u&&(P=P.drop(u)),d!==t&&(d=Oi(d),P=d<0?P.dropRight(-d):P.take(d-u)),P)},_i.prototype.takeRightWhile=function(u){return this.reverse().takeWhile(u).reverse()},_i.prototype.toArray=function(){return this.take(ot)},Wt(_i.prototype,function(u,d){var P=/^(?:filter|find|map|reject)|While$/.test(d),j=/^(?:head|last)$/.test(d),ge=Te[j?"take"+(d=="last"?"Right":""):d],Fe=j||/^find/.test(d);ge&&(Te.prototype[d]=function(){var st=this.__wrapped__,gt=j?[1]:arguments,kt=st instanceof _i,nn=gt[0],rn=kt||Ai(st),dn=function(Qi){var rr=ge.apply(Te,Qs([Qi],gt));return j&&Bn?rr[0]:rr};rn&&P&&typeof nn=="function"&&nn.length!=1&&(kt=rn=!1);var Bn=this.__chain__,Hn=!!this.__actions__.length,ui=Fe&&!Bn,ji=kt&&!Hn;if(!Fe&&rn){st=ji?st:new _i(this);var ci=u.apply(st,gt);return ci.__actions__.push({func:fd,args:[dn],thisArg:t}),new hs(ci,Bn)}return ui&&ji?u.apply(this,gt):(ci=this.thru(dn),ui?j?ci.value()[0]:ci.value():ci)})}),ss(["pop","push","shift","sort","splice","unshift"],function(u){var d=No[u],P=/^(?:push|sort|unshift)$/.test(u)?"tap":"thru",j=/^(?:pop|shift)$/.test(u);Te.prototype[u]=function(){var ge=arguments;if(j&&!this.__chain__){var Fe=this.value();return d.apply(Ai(Fe)?Fe:[],ge)}return this[P](function(st){return d.apply(Ai(st)?st:[],ge)})}}),Wt(_i.prototype,function(u,d){var P=Te[d];if(P){var j=P.name+"";Pi.call($s,j)||($s[j]=[]),$s[j].push({name:d,func:P})}}),$s[sd(t,F).name]=[{name:"wrapper",func:t}],_i.prototype.clone=ec,_i.prototype.reverse=hh,_i.prototype.value=tc,Te.prototype.at=S5,Te.prototype.chain=P5,Te.prototype.commit=E5,Te.prototype.next=A5,Te.prototype.plant=k5,Te.prototype.reverse=T5,Te.prototype.toJSON=Te.prototype.valueOf=Te.prototype.value=B5,Te.prototype.first=Te.prototype.head,Yn&&(Te.prototype[Yn]=M5),Te},bs=no();Rr?((Rr.exports=bs)._=bs,Gn._=bs):Nr._=bs}).call(qo)})(gp,gp.exports);var w4=gp.exports;class $o extends hn.Polygon{constructor(t,i={}){super([],{...i,pmIgnore:!1,interactive:!0});Pt(this,"_width");Pt(this,"_height");Pt(this,"_center");Pt(this,"_rotation");Pt(this,"_isMapReady",!1);Pt(this,"properties");Pt(this,"_helperPoints",{corners:[],midPoints:[]});Pt(this,"_throttledUpdateProperties");const r=t instanceof hn.LatLngBounds?t:hn.latLngBounds(t);if(this._center=r.getCenter(),this._rotation=0,console.log("[Rectangle][constructor] Initialisation avec options:",{bounds:r,center:this._center,hasExplicitDimensions:!!(i.width&&i.height),width:i.width,height:i.height}),i.width&&i.height)this._width=i.width,this._height=i.height,console.log("[Rectangle][constructor] Utilisation des dimensions explicites:",{width:this._width,height:this._height});else{const o=r.getSouthWest(),l=r.getNorthEast();this._width=Ct.measure("Rectangle.constructor.calculateWidth",()=>{const h=U0([o.lng,o.lat],[l.lng,o.lat],{units:"meters"});return Math.max(h,1)}),this._height=Ct.measure("Rectangle.constructor.calculateHeight",()=>{const h=U0([o.lng,o.lat],[o.lng,l.lat],{units:"meters"});return Math.max(h,1)}),console.log("[Rectangle][constructor] Dimensions calculées depuis bounds:",{width:this._width,height:this._height})}(this._width<1||this._height<1)&&this._getPixelsPerMeter()>0&&(this._width=Math.max(this._width,1),this._height=Math.max(this._height,1),this._updatePolygonCoordinates()),this.properties=Ct.measure("Rectangle.constructor.initProperties",()=>({type:"Rectangle",style:{...i,name:i.name||""},rotation:this._rotation})),this._throttledUpdateProperties=Ct.measure("Rectangle.constructor.initThrottle",()=>w4.throttle(()=>{this.updateProperties()},100)),this.on("add",()=>{this._isMapReady=!0,this._updatePolygonCoordinates(),this.updateProperties()}),this.on("remove",()=>{this._isMapReady=!1})}_updatePolygonCoordinates(){Ct.measure("Rectangle._updatePolygonCoordinates",()=>{if(!this._isMapReady||!this._map)return;console.log("[Rectangle][_updatePolygonCoordinates] Début mise à jour avec:",{width:this._width,height:this._height,center:this._center,rotation:this._rotation}),this._width=Math.max(this._width,1),this._height=Math.max(this._height,1);const t=this._width/2,i=this._height/2,r=py([this._center.lng,this._center.lat],i,0,{units:"meters"}).geometry.coordinates,o=py([this._center.lng,this._center.lat],t,90,{units:"meters"}).geometry.coordinates,l=Math.abs(r[1]-this._center.lat)*2,h=Math.abs(o[0]-this._center.lng)*2,g=[hn.latLng(this._center.lat+l/2,this._center.lng-h/2),hn.latLng(this._center.lat+l/2,this._center.lng+h/2),hn.latLng(this._center.lat-l/2,this._center.lng+h/2),hn.latLng(this._center.lat-l/2,this._center.lng-h/2)];if(this._rotation===0){this.setLatLngs(g);return}const v=this._map.latLngToContainerPoint(this._center),_=g.map(Q=>this._map.latLngToContainerPoint(Q)),x=-this._rotation*Math.PI/180,E=Math.cos(x),b=Math.sin(x),$=_.map(Q=>{const F=Q.x-v.x,G=Q.y-v.y;return hn.point(v.x+(F*E-G*b),v.y+(F*b+G*E))}).map(Q=>this._map.containerPointToLatLng(Q));console.log("[Rectangle][_updatePolygonCoordinates] Résultat final:",{corners:$,dimensions:{width:this._width,height:this._height}}),this.setLatLngs($),this.fire("coordinates:updated",{corners:$,center:this._center,rotation:this._rotation,dimensions:{width:this._width,height:this._height}})})}_getPixelsPerMeter(){return Ct.measure("Rectangle._getPixelsPerMeter",()=>{if(!this._isMapReady||!this._map)return 1;const t=Math.max(this._width/1e3,1e-4),i=this._map.latLngToContainerPoint(this._center),o=this._map.latLngToContainerPoint(hn.latLng(this._center.lat,this._center.lng+t)).x-i.x,l=U0([this._center.lng,this._center.lat],[this._center.lng+t,this._center.lat],{units:"meters"}),h=Math.abs(o/l);return isNaN(h)||h<=0?(console.warn("[Rectangle][_getPixelsPerMeter] Ratio invalide, utilisation de la valeur par défaut"),1):h})}getRotatedCorners(){return Ct.measure("Rectangle.getRotatedCorners",()=>{try{const t=this.getLatLngs();if(!t||!Array.isArray(t)||t.length===0){const i=this._width/2,r=this._height/2;return[hn.latLng(this._center.lat+r,this._center.lng-i),hn.latLng(this._center.lat+r,this._center.lng+i),hn.latLng(this._center.lat-r,this._center.lng+i),hn.latLng(this._center.lat-r,this._center.lng-i)]}return t[0]}catch(t){console.warn("Error in getRotatedCorners:",t);const i=this._width/2,r=this._height/2;return[hn.latLng(this._center.lat+r,this._center.lng-i),hn.latLng(this._center.lat+r,this._center.lng+i),hn.latLng(this._center.lat-r,this._center.lng+i),hn.latLng(this._center.lat-r,this._center.lng-i)]}})}getMidPoints(){return Ct.measure("Rectangle.getMidPoints",()=>{try{const t=this.getRotatedCorners();if(!t||t.length<4){const r=this._width/2,o=this._height/2;return[hn.latLng(this._center.lat+o,this._center.lng),hn.latLng(this._center.lat,this._center.lng+r),hn.latLng(this._center.lat-o,this._center.lng),hn.latLng(this._center.lat,this._center.lng-r)]}if(!t.every(r=>r&&typeof r.lat=="number"&&typeof r.lng=="number"))throw new Error("Invalid corner coordinates");return[this._getMidPoint(t[3],t[0]),this._getMidPoint(t[0],t[1]),this._getMidPoint(t[1],t[2]),this._getMidPoint(t[2],t[3])]}catch(t){console.warn("Error in getMidPoints:",t);const i=this._width/2,r=this._height/2;return[hn.latLng(this._center.lat+r,this._center.lng),hn.latLng(this._center.lat,this._center.lng+i),hn.latLng(this._center.lat-r,this._center.lng),hn.latLng(this._center.lat,this._center.lng-i)]}})}_getMidPoint(t,i){return Ct.measure("Rectangle._getMidPoint",()=>{if(!t||!i||typeof t.lat!="number"||typeof t.lng!="number"||typeof i.lat!="number"||typeof i.lng!="number")throw new Error("Invalid points for midpoint calculation");return hn.latLng((t.lat+i.lat)/2,(t.lng+i.lng)/2)})}getCenter(){return Ct.measure("Rectangle.getCenter",()=>this._center)}setCenter(t){Ct.measure("Rectangle.setCenter",()=>{this._center=t,this._updatePolygonCoordinates(),this.updateProperties(),this.updateHelperPointPositions()})}getRotation(){return Ct.measure("Rectangle.getRotation",()=>this._rotation)}setRotation(t,i=!1){Ct.measure("Rectangle.setRotation",()=>{this._rotation=(t%360+360)%360,this._updatePolygonCoordinates(),i&&this.updateProperties(),this.updateHelperPointPositions(),this.fire("rotation:updated",{angle:this._rotation,corners:this.getRotatedCorners(),center:this._center})})}finalizeRotation(){Ct.measure("Rectangle.finalizeRotation",()=>{this.updateProperties()})}getDimensions(){return Ct.measure("Rectangle.getDimensions",()=>({width:this._width,height:this._height}))}setDimensions(t,i){Ct.measure("Rectangle.setDimensions",()=>{console.log("[Rectangle][setDimensions] Début de la mise à jour des dimensions:",{oldWidth:this._width,oldHeight:this._height,newWidth:t,newHeight:i}),this._width=t,this._height=i,console.log("[Rectangle][setDimensions] Mise à jour des coordonnées du polygone"),this._updatePolygonCoordinates(),console.log("[Rectangle][setDimensions] Mise à jour des propriétés"),this.updateProperties(),console.log("[Rectangle][setDimensions] Émission de l'événement dimensions:updated"),this.fire("dimensions:updated",{width:this._width,height:this._height,corners:this.getRotatedCorners(),center:this._center}),this.updateHelperPointPositions()})}resizeFromCorner(t,i){Ct.measure("Rectangle.resizeFromCorner",()=>{if(!(!this._isMapReady||!this._map))try{const r=this._map.latLngToContainerPoint(this._center),o=this._map.latLngToContainerPoint(i),l=o.x-r.x,h=o.y-r.y,g=-this._rotation*Math.PI/180,v=Math.cos(g),_=Math.sin(g),x=l*v-h*_,E=l*_+h*v,b=this._getPixelsPerMeter(),D=t===0||t===3?-1:1,$=t===0||t===1?1:-1,Q=Math.max(Math.abs(x*2)/b,1),F=Math.max(Math.abs(E*2)/b,1),G=Q*b/2,me=F*b/2,Se=D*G*v-$*me*_,Ie=D*G*_+$*me*v,nt=hn.point(o.x-Se,o.y-Ie),Ve=this._map.containerPointToLatLng(nt),ue=[hn.point(nt.x-G,nt.y+me),hn.point(nt.x+G,nt.y+me),hn.point(nt.x+G,nt.y-me),hn.point(nt.x-G,nt.y-me)].map(z=>{const R=z.x-nt.x,J=z.y-nt.y;return hn.point(nt.x+(R*v-J*_),nt.y+(R*_+J*v))}).map(z=>this._map.containerPointToLatLng(z));this._width=Q,this._height=F,this._center=Ve,this.setLatLngs(ue),this.fire("coordinates:updated",{corners:ue,center:this._center,rotation:this._rotation})}catch(r){console.warn("Error in resizeFromCorner:",r)}})}resizeFromSide(t,i){Ct.measure("Rectangle.resizeFromSide",()=>{if(!this._isMapReady||!this._map)return;const r=this._map.latLngToContainerPoint(this._center),o=this._map.latLngToContainerPoint(i),l=o.x-r.x,h=o.y-r.y,g=-this._rotation*Math.PI/180,v=Math.cos(g),_=Math.sin(g),x=l*v-h*_,E=l*_+h*v,b=this._getPixelsPerMeter();t%2===0?this._height=Math.abs(E*2)/b:this._width=Math.abs(x*2)/b,this._updatePolygonCoordinates(),this.updateProperties()})}moveFromCenter(t){Ct.measure("Rectangle.moveFromCenter",()=>{this._center=t,this._updatePolygonCoordinates(),this.updateProperties()})}updateProperties(){Ct.measure("Rectangle.updateProperties",()=>{var r,o,l;const t=this.getRotatedCorners(),i=((o=(r=this.properties)==null?void 0:r.style)==null?void 0:o.name)||"";this.properties={...this.properties,width:this._width,height:this._height,surface:this._width*this._height,perimeter:2*(this._width+this._height),center:this._center,corners:t,midPoints:this.getMidPoints(),rotation:this._rotation,style:{...this.options,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#3388ff",fillOpacity:this.options.fillOpacity||.2,dashArray:((l=this.options)==null?void 0:l.dashArray)||"",name:i}},this.fire("properties:updated",{shape:this,properties:this.properties,corners:t,midPoints:this.getMidPoints()})})}setName(t){Ct.measure("Rectangle.setName",()=>{this.properties.style||(this.properties.style={}),this.properties.style.name=t,this.fire("properties:updated",{shape:this,properties:this.properties})})}getName(){return Ct.measure("Rectangle.getName",()=>{var t,i;return((i=(t=this.properties)==null?void 0:t.style)==null?void 0:i.name)||""})}generateHelperPoints(t,i="rgba(220, 38, 38, 0.5)",r="rgba(37, 99, 235, 0.5)"){Ct.measure("Rectangle.generateHelperPoints",()=>{this.clearHelperPoints();const o=this.getRotatedCorners(),l=this.getMidPoints();this._helperPoints.corners=o.map(h=>hn.circleMarker(h,{radius:5,color:i,fillColor:i,fillOpacity:.6,weight:1,opacity:.8,className:"rectangle-helper-corner",pmIgnore:!0,interactive:!1}).addTo(t)),this._helperPoints.midPoints=l.map(h=>hn.circleMarker(h,{radius:5,color:r,fillColor:r,fillOpacity:.6,weight:1,opacity:.8,className:"rectangle-helper-midpoint",pmIgnore:!0,interactive:!1}).addTo(t))})}clearHelperPoints(){Ct.measure("Rectangle.clearHelperPoints",()=>{this._helperPoints.corners.forEach(t=>{if(t&&t.remove)try{t.remove()}catch(i){console.warn("Erreur lors de la suppression d'un point d'aide de coin:",i)}}),this._helperPoints.midPoints.forEach(t=>{if(t&&t.remove)try{t.remove()}catch(i){console.warn("Erreur lors de la suppression d'un point d'aide de milieu:",i)}}),this._helperPoints.corners=[],this._helperPoints.midPoints=[]})}updateHelperPointPositions(){Ct.measure("Rectangle.updateHelperPointPositions",()=>{if(this._helperPoints.corners.length===0&&this._helperPoints.midPoints.length===0)return;const t=this.getRotatedCorners(),i=this.getMidPoints();t.forEach((r,o)=>{this._helperPoints.corners[o]&&this._helperPoints.corners[o].setLatLng(r)}),i.forEach((r,o)=>{this._helperPoints.midPoints[o]&&this._helperPoints.midPoints[o].setLatLng(r)})})}findClosestHelperPoint(t){return Ct.measure("Rectangle.findClosestHelperPoint",()=>{const i=this.getRotatedCorners(),r=this.getMidPoints(),o=[...i,...r];if(o.length===0)return null;let l=o[0],h=t.distanceTo(l);for(let g=1;g<o.length;g++){const v=t.distanceTo(o[g]);v<h&&(h=v,l=o[g])}return l})}toggleHelperPoints(t,i,r,o){Ct.measure("Rectangle.toggleHelperPoints",()=>{i&&t?this.generateHelperPoints(t,r,o):this.clearHelperPoints()})}containsPoint(t){return Ct.measure("Rectangle.containsPoint",()=>{const i=this.getRotatedCorners();if(i.length!==4)return!1;let r=!1;for(let o=0,l=i.length-1;o<i.length;l=o++){const h=i[o].lng,g=i[o].lat,v=i[l].lng,_=i[l].lat;g>t.lat!=_>t.lat&&t.lng<(v-h)*(t.lat-g)/(_-g)+h&&(r=!r)}return r})}}class Zc extends hn.Circle{constructor(t,i){const r=i.radius||10;super(t,r,i);Pt(this,"properties");Pt(this,"angleCache",new Map);Pt(this,"lastCenter");Pt(this,"lastCenterCosLat");Pt(this,"_pendingNameUpdate",!1);Pt(this,"_nameUpdateTimeout",null);Ct.measure("Circle.constructor.init",()=>{this.properties={type:"Circle",style:{name:i.name||""}},requestAnimationFrame(()=>{this.updateProperties()}),this.on("add",()=>{requestAnimationFrame(()=>{this.updateProperties()})})},"Circle")}updateProperties(){Ct.measure("Circle.updateProperties",()=>{var h,g,v,_;const t=this.getRadius(),i=this.getLatLng(),r=((g=(h=this.properties)==null?void 0:h.style)==null?void 0:g.name)||"",o=((v=this.properties)==null?void 0:v.style)||{},l={type:"Circle",radius:t,diameter:t*2,surface:Math.PI*Math.pow(t,2),perimeter:2*Math.PI*t,center:{lat:i.lat,lng:i.lng},style:{...o,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#3388ff",fillOpacity:this.options.fillOpacity||.2,dashArray:((_=this.options)==null?void 0:_.dashArray)||"",name:r}};JSON.stringify(this.properties)!==JSON.stringify(l)&&(this.properties=l,this.fire("properties:updated",{shape:this,properties:this.properties}))},"Circle")}setName(t){Ct.measure("Circle.setName",()=>{var i,r;((r=(i=this.properties)==null?void 0:i.style)==null?void 0:r.name)!==t&&(this.properties.style||(this.properties.style={}),this.properties.style.name=t,!this._pendingNameUpdate&&(this._pendingNameUpdate=!0,this._nameUpdateTimeout&&clearTimeout(this._nameUpdateTimeout),this._nameUpdateTimeout=setTimeout(()=>{this._pendingNameUpdate=!1,this._nameUpdateTimeout=null,this.fire("properties:updated",{shape:this,properties:this.properties})},100)))},"Circle")}getName(){return Ct.measure("Circle.getName",()=>{var t,i;return((i=(t=this.properties)==null?void 0:t.style)==null?void 0:i.name)||""},"Circle")}setRadius(t){return Ct.measure("Circle.setRadius",()=>(super.setRadius(t),this.updateProperties(),this),"Circle")}setLatLng(t){return Ct.measure("Circle.setLatLng",()=>(super.setLatLng(t),this.updateProperties(),this),"Circle")}calculatePointOnCircle(t){return Ct.measure("Circle.calculatePointOnCircle",()=>{const i=this.getLatLng(),r=this.getRadius();let o=this.angleCache.get(t);if(!o){const l=t*Math.PI/180;o={sin:Math.sin(l),cos:Math.cos(l)},this.angleCache.set(t,o)}return(!this.lastCenter||!this.lastCenter.equals(i))&&(this.lastCenter=i,this.lastCenterCosLat=Math.cos(i.lat*Math.PI/180)),hn.latLng(i.lat+r/111319.9*o.sin,i.lng+r/(111319.9*this.lastCenterCosLat)*o.cos)},"Circle")}getCardinalPoints(){return Ct.measure("Circle.getCardinalPoints",()=>[0,45,90,135,180,225,270,315].map(t=>this.calculatePointOnCircle(t)),"Circle")}calculateAngleFromPoint(t){return Ct.measure("Circle.calculateAngleFromPoint",()=>{const i=this.getLatLng(),r=t.lng-i.lng,o=t.lat-i.lat;let l=Math.atan2(o,r)*180/Math.PI;return l<0&&(l+=360),l},"Circle")}resizeFromControlPoint(t){Ct.measure("Circle.resizeFromControlPoint",()=>{const r=this.getLatLng().distanceTo(t);r>0&&super.setRadius(r)},"Circle")}clearCache(){this.angleCache.clear(),this.lastCenter=void 0,this.lastCenterCosLat=void 0}}class eh extends Zc{constructor(t,i){super(t,i);Pt(this,"_sections",[]);Pt(this,"_sectionLayers",[]);Pt(this,"_isDragging",!1);Pt(this,"_dragTimeout",null);Ct.measure("CircleWithSections.constructor",()=>(this._sections=i.sections||[],this.properties.type="CircleWithSections",this.properties.sections=this._sections,this.on("add",()=>{setTimeout(()=>this._initSections(),100)}),this.on("remove",()=>this._clearSections()),this.on("dragstart",()=>{this._isDragging=!0,this._clearSections()}),this.on("drag",()=>{this._dragTimeout&&clearTimeout(this._dragTimeout),this._dragTimeout=window.setTimeout(()=>{this._isDragging&&this._map&&this._renderSectionsPreview()},50)}),this.on("dragend",()=>{this._isDragging=!1,this._dragTimeout&&(clearTimeout(this._dragTimeout),this._dragTimeout=null),setTimeout(()=>{this._map&&(this._initSections(),this.updateProperties())},100)}),this.on("zoomanim",()=>{this._map&&this._clearSections()}),this.on("zoomend",()=>{this._map&&setTimeout(()=>{this._map&&(this._clearSections(),this._initSections())},100)}),this.updateProperties(),this))}_initSections(){Ct.measure("CircleWithSections._initSections",()=>{this.getMap()&&(this._clearSections(),setTimeout(()=>{this.getMap()&&this._sections.forEach(i=>{this._renderSection(i)})},0))})}_clearSections(){Ct.measure("CircleWithSections._clearSections",()=>{this._sectionLayers.forEach(t=>{try{t&&t.remove&&this._map&&this._map.hasLayer(t)&&t.remove()}catch(i){console.warn("Erreur lors de la suppression d'une section:",i)}}),this._sectionLayers=[]})}_isFullCircle(t){return Ct.measure("CircleWithSections._isFullCircle",()=>t.startAngle===0&&t.endAngle===360)}_renderSection(t){Ct.measure("CircleWithSections._renderSection",()=>{const i=this.getMap();if(!i)return;const r=this.getLatLng(),o=[];if(this._isFullCircle(t)){console.log("[CircleWithSections] Rendu d'une section circulaire complète",{sectionId:t.id,name:t.name,radius:t.radius});const _=new hn.Circle(r,{radius:t.radius,color:t.color,fillColor:t.color,fillOpacity:.4,weight:2,interactive:!0});_.addTo(i),this._sectionLayers.push(_),_.on("click",x=>{console.log("[CircleWithSections] Clic sur une section circulaire complète",{sectionId:t.id,name:t.name,event:x,parentCircle:this}),this._emitCustomEvent("section:clicked",{section:t,parentCircle:this});const E=this._findFeatureGroup();E&&E.fire("click",{...x,layer:this,target:this,type:"click"})});return}console.log("[CircleWithSections] Rendu d'une section partielle",{sectionId:t.id,name:t.name,startAngle:t.startAngle,endAngle:t.endAngle,radius:t.radius}),o.push(r);const h=32,g=t.endAngle-t.startAngle;for(let _=0;_<=h;_++){const x=t.startAngle+g*_/h,E=this._calculatePointOnCircle(x,t.radius);o.push(E)}o.push(r);const v=new hn.Polygon(o,{color:t.color,fillColor:t.color,fillOpacity:.4,weight:2,interactive:!0});v.addTo(i),this._sectionLayers.push(v),v.on("click",_=>{console.log("[CircleWithSections] Clic sur une section partielle",{sectionId:t.id,name:t.name,event:_,parentCircle:this}),this._emitCustomEvent("section:clicked",{section:t,parentCircle:this});const x=this._findFeatureGroup();x&&x.fire("click",{..._,layer:this,target:this,type:"click"})})})}_findFeatureGroup(){return Ct.measure("CircleWithSections._findFeatureGroup",()=>{if(!this._map)return null;let t=null;return this._map.eachLayer(i=>{i instanceof hn.FeatureGroup&&i.hasLayer(this)&&(t=i)}),t})}_normalizeAngle(t){return Ct.measure("CircleWithSections._normalizeAngle",()=>(t%360+360)%360)}_updateSectionAngles(t,i,r){Ct.measure("CircleWithSections._updateSectionAngles",()=>{const o=this._normalizeAngle(t.startAngle),l=this._normalizeAngle(t.endAngle),h=(l-o+360)%360;let g=i!==null?this._normalizeAngle(i):o,v=r!==null?this._normalizeAngle(r):l,_=(v-g+360)%360;const x=45;Math.abs(_-h)>x&&(_>h?_=h+x:_=h-x,i!==null?v=(g+_)%360:g=(v-_+360)%360),_<355&&(_=Math.max(5,_),i!==null?v=(g+_)%360:g=(v-_+360)%360),t.startAngle=g,t.endAngle=v})}_addMarkerEvents(t,i,r){Ct.measure("CircleWithSections._addMarkerEvents",()=>{let o=!1;const l=this.getMap();if(!l)return;const h=(_,x)=>{if(!o)return;const E=this._calculateAngleFromPoint(_.latlng);x?this._updateSectionAngles(r,E,null):this._updateSectionAngles(r,null,E),this._clearSections(),this._renderSection(r),this._emitCustomEvent("section:visual-update",{section:r,sections:this._sections})},g=()=>{o=!1,l.dragging.enable(),this.updateProperties(),this._emitCustomEvent("section:updated",{section:r,sections:this._sections})};t.on("mousedown",()=>{o=!0,l.dragging.disable()}),t.on("mousemove",_=>{h(_,!0)}),t.on("mouseup",g),t.on("mouseout",()=>{o&&g(),t.setStyle({radius:5,fillOpacity:1}),l.getContainer().style.cursor=""}),i.on("mousedown",()=>{o=!0,l.dragging.disable()}),i.on("mousemove",_=>{h(_,!1)}),i.on("mouseup",g),i.on("mouseout",()=>{o&&g(),i.setStyle({radius:5,fillOpacity:1}),l.getContainer().style.cursor=""});const v=(_,x)=>{x?(_.setStyle({radius:6,fillOpacity:.8}),l.getContainer().style.cursor="pointer"):o||(_.setStyle({radius:5,fillOpacity:1}),l.getContainer().style.cursor="")};t.on("mouseover",()=>v(t,!0)),t.on("mouseout",()=>v(t,!1)),i.on("mouseover",()=>v(i,!0)),i.on("mouseout",()=>v(i,!1)),l.on("mousemove",_=>{if(o){const x=_.originalEvent.target;x===t.getElement()?h(_,!0):x===i.getElement()&&h(_,!1)}}),l.on("mouseup",()=>{o&&g()})})}_calculatePointOnCircle(t,i){return Ct.measure("CircleWithSections._calculatePointOnCircle",()=>{const r=this.getLatLng(),o=t*Math.PI/180,l=i;return hn.latLng(r.lat+l/111319.9*Math.sin(o),r.lng+l/(111319.9*Math.cos(r.lat*Math.PI/180))*Math.cos(o))})}_calculateAngleFromPoint(t){return Ct.measure("CircleWithSections._calculateAngleFromPoint",()=>{const i=this.getLatLng(),r=t.lng-i.lng,o=t.lat-i.lat;let l=Math.atan2(o,r)*180/Math.PI;return l=(90-l)%360,l<0&&(l+=360),Math.round(l)})}updateSection(t,i){return Ct.measure("CircleWithSections.updateSection",()=>{const r=this._sections.findIndex(o=>o.id===t);if(r!==-1){i.radius!==void 0&&(i.radius=Math.max(1,i.radius),i.radius=Math.floor(i.radius)),this._sections[r]={...this._sections[r],...i};const o=this._sections[r];return i.startAngle===0&&i.endAngle===360&&(o.startAngle=0,o.endAngle=360),this.properties.sections=this._sections,this._clearSections(),this._sections.forEach(l=>{this._renderSection(l)}),this._emitCustomEvent("section:updated",{section:this._sections[r],sections:this._sections}),this.updateProperties(),!0}return!1})}addSection(t={}){return Ct.measure("CircleWithSections.addSection",()=>{const i=this.getRadius();let r;if(t.radius!==void 0)r=Math.max(1,t.radius);else{const h=this._sections[this._sections.length-1];h?r=Math.max(h.radius-20,20):r=Math.max(i-20,20)}const o={id:`section-${Date.now()}-${Math.floor(Math.random()*1e3)}`,startAngle:t.startAngle||0,endAngle:t.endAngle||45,radius:Math.floor(r),color:t.color||this._getRandomColor(),name:t.name||`Section ${this._sections.length+1}`};return this._sections.push(o),this.properties.sections=this._sections,this.getMap()&&this._renderSection(o),this._emitCustomEvent("section:added",{section:o,sections:this._sections}),this.updateProperties(),o})}removeSection(t){return Ct.measure("CircleWithSections.removeSection",()=>{const i=this._sections.length;return this._sections=this._sections.filter(r=>r.id!==t),i!==this._sections.length?(this.properties.sections=this._sections,this._clearSections(),this._sections.forEach(r=>{this._renderSection(r)}),this._emitCustomEvent("section:removed",{sectionId:t,sections:this._sections}),this.updateProperties(),!0):!1})}makeFullCircle(t){Ct.measure("CircleWithSections.makeFullCircle",()=>{t.startAngle=0,t.endAngle=360,this._clearSections(),this._renderSection(t),this._emitCustomEvent("section:updated",{section:t,sections:this._sections}),this.updateProperties()})}getSections(){return Ct.measure("CircleWithSections.getSections",()=>[...this._sections])}updateProperties(){Ct.measure("CircleWithSections.updateProperties",()=>{var l,h,g,v;const t=this.getLatLng(),i=this.getRadius();let r=0;const o=this._sections.map(_=>{const E=(_.endAngle-_.startAngle)*Math.PI/180/(2*Math.PI)*Math.PI*Math.pow(_.radius,2),b=Math.round(E*100)/100;return r+=E,{..._,surface:b}});this.properties={type:"CircleWithSections",radius:i,diameter:i*2,surface:Math.PI*Math.pow(i,2),perimeter:2*Math.PI*i,center:{lat:t.lat,lng:t.lng},sections:o,sectionArea:r,style:{...(l=this.properties)==null?void 0:l.style,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#3388ff",fillOpacity:this.options.fillOpacity||.2,dashArray:((h=this.options)==null?void 0:h.dashArray)||"",name:((v=(g=this.properties)==null?void 0:g.style)==null?void 0:v.name)||""}},this.fire("properties:updated",{shape:this,properties:this.properties})})}_getRandomColor(){return Ct.measure("CircleWithSections._getRandomColor",()=>{const t=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899","#14B8A6","#F97316","#6366F1","#84CC16"],i=this._sections.map(o=>o.color),r=t.filter(o=>!i.includes(o));return r.length>0?r[Math.floor(Math.random()*r.length)]:t[Math.floor(Math.random()*t.length)]})}setRadius(t){return Ct.measure("CircleWithSections.setRadius",()=>(super.setRadius(t),this._sections=this._sections.map(i=>({...i,radius:Math.min(i.radius,t)})),this._clearSections(),this._initSections(),this))}setLatLng(t){return Ct.measure("CircleWithSections.setLatLng",()=>(super.setLatLng(t),this._isDragging?this._renderSectionsPreview():(this._clearSections(),this._initSections()),this))}getMap(){return Ct.measure("CircleWithSections.getMap",()=>this._map)}_renderSectionsPreview(){Ct.measure("CircleWithSections._renderSectionsPreview",()=>{const t=this.getMap();if(!(!t||!this._map))try{this._clearSections(),this._sections.forEach(i=>{if(Math.abs(i.endAngle-i.startAngle)>=360)try{const o=new hn.Circle(this.getLatLng(),{radius:i.radius,color:i.color,fillColor:i.color,fillOpacity:.2,weight:1,dashArray:"5,5",interactive:!1});t&&t.hasLayer(this)&&(o.addTo(t),this._sectionLayers.push(o))}catch(o){console.warn("Erreur lors du rendu de la prévisualisation du cercle complet:",o)}else try{const o=[];o.push(this.getLatLng());const l=16,h=i.endAngle-i.startAngle;for(let v=0;v<=l;v++){const _=i.startAngle+h*v/l,x=this._calculatePointOnCircle(_,i.radius);o.push(x)}o.push(this.getLatLng());const g=new hn.Polygon(o,{color:i.color,fillColor:i.color,fillOpacity:.2,weight:1,dashArray:"5,5",interactive:!1});t&&t.hasLayer(this)&&(g.addTo(t),this._sectionLayers.push(g))}catch(o){console.warn("Erreur lors du rendu de la prévisualisation de la section partielle:",o)}})}catch(i){console.error("Erreur lors du rendu des prévisualisations:",i)}})}getMinRadius(){return Ct.measure("CircleWithSections.getMinRadius",()=>1)}_emitCustomEvent(t,i){Ct.measure("CircleWithSections._emitCustomEvent",()=>{this.fire(t,i);const r=new CustomEvent(t,{detail:i,bubbles:!0,cancelable:!0});window.dispatchEvent(r),console.log(`[CircleWithSections] Événement émis: ${t}`,i)})}}function Ig(e){return"content"in e&&"bounds"in e}function o8(e){return e&&Array.isArray(e.points)&&e.points.length>0&&Array.isArray(e.points[0])&&e.points[0].length===2}function a8(e){if(!e||typeof e!="object")return console.log("[DrawingStore] ElevationData invalide: pas un objet",{data:e}),!1;const n=Array.isArray(e.points)&&e.points.length>0&&Array.isArray(e.points[0])&&e.points[0].length===2,t=typeof e.style=="object"&&e.style!==null,i=!e.elevationData||Array.isArray(e.elevationData)&&e.elevationData.every(r=>typeof r=="object"&&"distance"in r&&"elevation"in r);return n&&t&&i}function l8(e){return e&&Array.isArray(e.points)&&e.points.length>0&&Array.isArray(e.points[0])&&e.points[0].length===2}function Sy(e){var n,t,i,r,o,l,h,g,v,_,x,E,b,D,$,Q,F,G,me,Se,Ie,nt,Ve,O,W,ue,z;if(console.log("[DrawingStore] Conversion de la forme en élément",{type:(n=e.properties)==null?void 0:n.type,name:(i=(t=e.properties)==null?void 0:t.style)==null?void 0:i.name,properties:e.properties}),((r=e.properties)==null?void 0:r.type)==="Note"){const R=e.getLatLng();return{type_forme:"Note",data:{location:[R.lng,R.lat],title:e.properties.title||"",description:e.properties.description||"",visibility:e.properties.visibility||"private",attachments:e.properties.attachments||[],style:{color:((o=e.properties.style)==null?void 0:o.color)||"#3388ff",weight:((l=e.properties.style)==null?void 0:l.weight)||3,opacity:((h=e.properties.style)==null?void 0:h.opacity)||1,fillColor:((g=e.properties.style)==null?void 0:g.fillColor)||"#3388ff",fillOpacity:((v=e.properties.style)==null?void 0:v.fillOpacity)||.2,name:((_=e.properties.style)==null?void 0:_.name)||""}}}}if(e instanceof lh||((x=e.properties)==null?void 0:x.type)==="ElevationLine")return{type_forme:"ElevationLine",data:{points:e.getLatLngs().map(V=>[V.lng,V.lat]),style:{color:((E=e.properties.style)==null?void 0:E.color)||"#FF4500",weight:((b=e.properties.style)==null?void 0:b.weight)||4,opacity:((D=e.properties.style)==null?void 0:D.opacity)||.8,name:(($=e.properties.style)==null?void 0:$.name)||""},elevationData:e.properties.elevationData,minElevation:e.properties.minElevation,maxElevation:e.properties.maxElevation,elevationGain:e.properties.elevationGain,elevationLoss:e.properties.elevationLoss,averageSlope:e.properties.averageSlope,maxSlope:e.properties.maxSlope}};if(e instanceof zh||((Q=e.properties)==null?void 0:Q.type)==="Polygon")return{type_forme:"Polygon",data:{points:e.getLatLngs()[0].map(V=>[V.lng,V.lat]),style:{color:((F=e.properties.style)==null?void 0:F.color)||"#3388ff",weight:((G=e.properties.style)==null?void 0:G.weight)||3,opacity:((me=e.properties.style)==null?void 0:me.opacity)||1,fillColor:((Se=e.properties.style)==null?void 0:Se.fillColor)||"#3388ff",fillOpacity:((Ie=e.properties.style)==null?void 0:Ie.fillOpacity)||.2,name:((nt=e.properties.style)==null?void 0:nt.name)||""},area:e.properties.area||0}};if(e instanceof Lo||((Ve=e.properties)==null?void 0:Ve.type)==="Line")return{type_forme:"Line",data:{points:e.getLatLngs().map(V=>[V.lng,V.lat]),style:{color:((O=e.properties.style)==null?void 0:O.color)||"#3388ff",weight:((W=e.properties.style)==null?void 0:W.weight)||3,opacity:((ue=e.properties.style)==null?void 0:ue.opacity)||1,name:((z=e.properties.style)==null?void 0:z.name)||""},length:e.properties.length||0}};throw new Error("Type de forme non reconnu")}function u8(e){var n,t,i,r,o,l,h,g,v,_,x,E,b,D,$,Q,F,G,me,Se,Ie,nt,Ve,O,W,ue,z,R,J,V,U,Y,ce,re,Pe,Me,ot,X,Ee,B,H,he,te,ie,ee,se,Ce,ne,ae,xe,ye,le,je,Re,Ae,qe,Oe,et,Je,mt,_t,$t,Xt;switch(console.log("[DrawingStore] Conversion de l'élément stocké en forme",{element:e}),e.type_forme){case"CircleWithSections":{const Xe=e.data;if(!Xe.center||!Xe.radius)return console.error("[DrawingStore] Données invalides pour CircleWithSections"),null;const Kt=new eh(hn.latLng(Xe.center[1],Xe.center[0]),{color:((n=Xe.style)==null?void 0:n.color)||"#3388ff",weight:((t=Xe.style)==null?void 0:t.weight)||3,opacity:((i=Xe.style)==null?void 0:i.opacity)||1,fillColor:((r=Xe.style)==null?void 0:r.fillColor)||"#3388ff",fillOpacity:((o=Xe.style)==null?void 0:o.fillOpacity)||.2,dashArray:((l=Xe.style)==null?void 0:l.dashArray)||"",name:((h=Xe.style)==null?void 0:h.name)||"",radius:Xe.radius,sections:Xe.sections||[]});return Kt.properties.type="CircleWithSections",console.log("[DrawingStore] CircleWithSections restauré:",{center:Xe.center,radius:Xe.radius,sections:((g=Xe.sections)==null?void 0:g.length)||0}),Kt}case"TextRectangle":{if(!Ig(e.data))return console.error("[DrawingStore] Données invalides pour TextRectangle"),null;const Xe=e.data;if(!Xe.bounds)return console.error("[DrawingStore] Données de bounds manquantes pour TextRectangle"),null;const Kt=new hn.LatLngBounds(hn.latLng(Xe.bounds.southWest[1],Xe.bounds.southWest[0]),hn.latLng(Xe.bounds.northEast[1],Xe.bounds.northEast[0])),Qt={color:((v=Xe.style)==null?void 0:v.color)||"#3388ff",fillColor:((_=Xe.style)==null?void 0:_.fillColor)||"#3388ff",fillOpacity:((x=Xe.style)==null?void 0:x.fillOpacity)||.2,weight:((E=Xe.style)==null?void 0:E.weight)||3,opacity:((b=Xe.style)==null?void 0:b.opacity)||1,name:((D=Xe.style)==null?void 0:D.name)||"",textStyle:{color:(($=Xe.style.textStyle)==null?void 0:$.color)||"#000000",fontSize:((Q=Xe.style.textStyle)==null?void 0:Q.fontSize)||"14px",fontFamily:((F=Xe.style.textStyle)==null?void 0:F.fontFamily)||"Arial, sans-serif",textAlign:((G=Xe.style.textStyle)==null?void 0:G.textAlign)||"center",backgroundColor:((me=Xe.style.textStyle)==null?void 0:me.backgroundColor)||"#FFFFFF",backgroundOpacity:((Se=Xe.style.textStyle)==null?void 0:Se.backgroundOpacity)??1,bold:((Ie=Xe.style.textStyle)==null?void 0:Ie.bold)||!1,italic:((nt=Xe.style.textStyle)==null?void 0:nt.italic)||!1}},Qe=new yu(Kt,Xe.content||"Double-cliquez pour éditer",Qt);return Xe.rotation&&Qe.setRotation(Xe.rotation),(Ve=Xe.style)!=null&&Ve.name&&(Qe.properties.style.name=Xe.style.name),Qe}case"Polygon":{const Xe=e.data;if(!o8(Xe))return console.error("[DrawingStore] Données invalides pour Polygon"),null;const Kt=Xe.points.map(Qe=>hn.latLng(Qe[1],Qe[0])),Qt=new zh([Kt],{color:((O=Xe.style)==null?void 0:O.color)||"#3388ff",weight:((W=Xe.style)==null?void 0:W.weight)||3,opacity:((ue=Xe.style)==null?void 0:ue.opacity)||1,fillColor:((z=Xe.style)==null?void 0:z.fillColor)||"#3388ff",fillOpacity:((R=Xe.style)==null?void 0:R.fillOpacity)||.2,dashArray:((J=Xe.style)==null?void 0:J.dashArray)||"",name:((V=Xe.style)==null?void 0:V.name)||""});return Qt.updateProperties(),Qt}case"ElevationLine":{const Xe=e.data;if(!a8(Xe))return console.error("[DrawingStore] Données invalides pour ElevationLine"),null;const Kt=Xe.points.map(Qe=>hn.latLng(Qe[1],Qe[0])),Qt=new lh(Kt,{color:((U=Xe.style)==null?void 0:U.color)||"#FF4500",weight:((Y=Xe.style)==null?void 0:Y.weight)||4,opacity:((ce=Xe.style)==null?void 0:ce.opacity)||.8,name:((re=Xe.style)==null?void 0:re.name)||""});return Qt.properties={type:"ElevationLine",style:{...Xe.style||{},name:((Pe=Xe.style)==null?void 0:Pe.name)||""},elevationData:Xe.elevationData,minElevation:Xe.minElevation,maxElevation:Xe.maxElevation,elevationGain:Xe.elevationGain,elevationLoss:Xe.elevationLoss,averageSlope:Xe.averageSlope,maxSlope:Xe.maxSlope,dataSource:"restored"},Xe.elevationData&&Qt.updateElevationProfile(),console.log("[DrawingStore] ElevationLine restored:",{points:Kt.length,hasElevationData:!!Xe.elevationData,name:(Me=Xe.style)==null?void 0:Me.name,properties:Qt.properties}),Qt}case"Line":{const Xe=e.data;if(!l8(Xe))return console.error("[DrawingStore] Données invalides pour Ligne"),null;const Kt=Xe.points.map(Qe=>hn.latLng(Qe[1],Qe[0])),Qt=new Lo(Kt,{...Xe.style||{},name:((ot=Xe.style)==null?void 0:ot.name)||""});return Qt.updateProperties(),Qt}case"Semicircle":{const Xe=e.data;if(!Xe.center||!Xe.radius)return console.error("[DrawingStore] Données invalides pour Semicircle"),null;const Kt=hn.latLng(Xe.center[1],Xe.center[0]),Qt=new wu(Kt,Xe.radius,Xe.startAngle||0,Xe.endAngle||180,{color:((X=Xe.style)==null?void 0:X.color)||"#3388ff",weight:((Ee=Xe.style)==null?void 0:Ee.weight)||3,opacity:((B=Xe.style)==null?void 0:B.opacity)||1,fillColor:((H=Xe.style)==null?void 0:H.fillColor)||"#3388ff",fillOpacity:((he=Xe.style)==null?void 0:he.fillOpacity)||.2,dashArray:((te=Xe.style)==null?void 0:te.dashArray)||"",name:((ie=Xe.style)==null?void 0:ie.name)||""});Qt.properties={type:"Semicircle",radius:Xe.radius,startAngle:Xe.startAngle||0,stopAngle:Xe.endAngle||180,style:{...Xe.style||{},name:((ee=Xe.style)==null?void 0:ee.name)||""},center:Kt};const Qe=((Xe.endAngle||180)-(Xe.startAngle||0)+360)%360,We=Math.PI*Math.pow(Xe.radius,2)*Qe/360,Ut=2*Math.PI*Xe.radius*Qe/360,pn=Ut+2*Xe.radius;return Qt.properties.surface=We,Qt.properties.arcLength=Ut,Qt.properties.perimeter=pn,Qt.properties.openingAngle=Qe,Qt.properties.diameter=Xe.radius*2,console.log("[DrawingStore] Semicircle restauré:",{center:Xe.center,radius:Xe.radius,angles:{start:Xe.startAngle,end:Xe.endAngle},properties:Qt.properties}),Qt}case"Rectangle":{const Xe=e.data;if(console.log("[DrawingStore][convertStoredElementToShape] Restauration Rectangle:",{data:Xe,bounds:Xe.bounds,width:Xe.width,height:Xe.height,rotation:Xe.rotation}),!Xe.bounds)return console.error("[DrawingStore] Données de bounds manquantes pour Rectangle"),null;const Kt=new hn.LatLngBounds(hn.latLng(Xe.bounds.southWest[1],Xe.bounds.southWest[0]),hn.latLng(Xe.bounds.northEast[1],Xe.bounds.northEast[0])),Qt=new $o(Kt,{color:((se=Xe.style)==null?void 0:se.color)||"#3388ff",weight:((Ce=Xe.style)==null?void 0:Ce.weight)||3,opacity:((ne=Xe.style)==null?void 0:ne.opacity)||1,fillColor:((ae=Xe.style)==null?void 0:ae.fillColor)||"#3388ff",fillOpacity:((xe=Xe.style)==null?void 0:xe.fillOpacity)||.2,dashArray:((ye=Xe.style)==null?void 0:ye.dashArray)||"",name:((le=Xe.style)==null?void 0:le.name)||"",width:Xe.width,height:Xe.height});return Xe.rotation&&Qt.setRotation(Xe.rotation),console.log("[DrawingStore][convertStoredElementToShape] Rectangle restauré:",{bounds:Qt.getBounds(),dimensions:Qt.getDimensions(),properties:Qt.properties}),Qt}case"Circle":{console.log("[DrawingStore] Traitement d'un Circle à partir de l'API",{id:e.id,data:e.data,hasName:((Re=(je=e.data)==null?void 0:je.style)==null?void 0:Re.name)!==void 0,name:(qe=(Ae=e.data)==null?void 0:Ae.style)==null?void 0:qe.name});const Xe=e.data;if(!Xe.center||!Xe.radius)return console.error("[DrawingStore] Données invalides pour Circle"),null;const Kt=hn.circle([Xe.center[1],Xe.center[0]],{color:((Oe=Xe.style)==null?void 0:Oe.color)||"#3388ff",weight:((et=Xe.style)==null?void 0:et.weight)||3,opacity:((Je=Xe.style)==null?void 0:Je.opacity)||1,fillColor:((mt=Xe.style)==null?void 0:mt.fillColor)||"#3388ff",fillOpacity:((_t=Xe.style)==null?void 0:_t.fillOpacity)||.2,dashArray:(($t=Xe.style)==null?void 0:$t.dashArray)||"",radius:Xe.radius});return Kt.properties={type:"Circle",radius:Xe.radius,diameter:Xe.radius*2,surface:Math.PI*Xe.radius*Xe.radius,perimeter:2*Math.PI*Xe.radius,style:{...Xe.style||{},name:((Xt=Xe.style)==null?void 0:Xt.name)||""}},console.log("[DrawingStore] Cercle créé:",{centerType:typeof Xe.center,center:Xe.center,radius:Xe.radius,style:Kt.properties.style,name:Kt.properties.style.name}),Kt}default:return console.warn("[DrawingStore] Type non géré pour la restauration:",e.type_forme),null}}const x4=Np("drawing",{state:()=>({currentMapId:null,elements:[],selectedElement:null,unsavedChanges:!1,loading:!1,error:null,currentTool:"",currentStyle:{strokeStyle:"solid",strokeWidth:2,strokeColor:"#2563EB",fillColor:"#3B82F6",fillOpacity:.2},lastUsedType:null,performanceMonitor:Xh()}),getters:{hasUnsavedChanges:e=>e.unsavedChanges,getCurrentElements:e=>e.elements,getSelectedElement:e=>e.selectedElement,getCurrentTool:e=>e.currentTool,getCurrentStyle:e=>e.currentStyle,getLastUsedType:e=>e.lastUsedType},actions:{setCurrentPlan(e){window.dispatchEvent(new CustomEvent("clearControlPoints")),this.currentMapId=e,e===null&&this.clearElements(),this.selectedElement=null,this.unsavedChanges=!1,this.currentTool="",this.lastUsedType=null,this.currentStyle={strokeStyle:"solid",strokeWidth:2,strokeColor:"#2563EB",fillColor:"#3B82F6",fillOpacity:.2}},clearCurrentPlan(){(this.currentMapId!==null||this.elements.length>0)&&(this.currentMapId=null,this.elements=[],this.selectedElement=null,this.unsavedChanges=!1,this.loading=!1,this.error=null)},clearElements(){this.elements=[],this.selectedElement=null,this.unsavedChanges=!1,this.error=null},addElement(e){var t;const n=this.performanceMonitor.startMeasure("addElement","DrawingStore");try{if(console.log("[DrawingStore] Ajout d'un élément",{element:e,isLeafletLayer:e instanceof hn.Layer,hasProperties:!!e.properties,properties:e.properties,type:(t=e.properties)==null?void 0:t.type}),e instanceof hn.Layer&&e.properties){const i=this.performanceMonitor.measure("addElement_convert",()=>Sy(e),"DrawingStore");console.log("[DrawingStore] Élément converti avant ajout",{original:e,converted:i,type:i.type_forme,data:i.data}),this.elements.push(i)}else!e.type_forme&&this.lastUsedType&&(e.type_forme=this.lastUsedType),this.elements.push(e);this.unsavedChanges=!0}finally{n()}},updateElement(e){const n=this.elements.findIndex(t=>t.id===e.id);if(n!==-1){const t=this.elements[n].type_forme;this.elements[n]={...e,type_forme:t},this.unsavedChanges=!0}},removeElement(e){const n=this.elements.findIndex(t=>t.id===e);n!==-1&&(this.elements.splice(n,1),this.unsavedChanges=!0)},selectElement(e){this.selectedElement=e},setCurrentTool(e){this.currentTool=e,["CERCLE","RECTANGLE","DEMI_CERCLE","LIGNE","TEXTE"].includes(e)&&(this.lastUsedType=e)},setCurrentStyle(e){if(!e||Object.keys(e).length===0){this.currentStyle={strokeStyle:"solid",strokeWidth:2,strokeColor:"#2563EB",fillColor:"#3B82F6",fillOpacity:.2};return}this.currentStyle={...this.currentStyle,...e}},async loadPlanElements(e){const n=this.performanceMonitor.startMeasure("loadPlanElements","DrawingStore");if(this.currentMapId===e&&this.elements.length>0)return console.log(`[DrawingStore] Plan ${e} déjà chargé avec ${this.elements.length} éléments`),n(),this.elements;this.loading=!0;try{console.log("[DrawingStore] Début du chargement du plan",{planId:e});const i=(await this.performanceMonitor.measureAsync("loadPlanElements_apiCall",()=>Kn.get(`/plans/${e}/`),"DrawingStore")).data;return console.log("[DrawingStore] Données du plan reçues",{formes:i.formes,preferences:i.preferences}),i.formes&&Array.isArray(i.formes)&&i.formes.forEach((r,o)=>{var l,h,g;console.log(`[DrawingStore] Analyse détaillée forme ${o}:`,{id:r.id,type_forme:r.type_forme,hasData:!!r.data,dataKeys:r.data?Object.keys(r.data):[],name:(l=r.data)==null?void 0:l.name,hasName:r.data&&"name"in r.data,centerType:(h=r.data)!=null&&h.center?typeof r.data.center:"undefined",center:(g=r.data)==null?void 0:g.center})}),this.elements=i.formes.map(r=>{var o;if(console.log("[DrawingStore] Traitement de la forme stockée",{id:r.id,type_forme:r.type_forme,data:r.data,isTextRectangle:r.type_forme==="TEXTE"||r.data&&Ig(r.data)}),r.type_forme)return console.log("[DrawingStore] Forme déjà au format élément",{type_forme:r.type_forme,data:r.data,hasName:r.data&&"name"in r.data,name:(o=r.data)==null?void 0:o.name}),{id:r.id,type_forme:r.type_forme,data:r.data||{}};try{const l=u8(r);if(l)return console.log("[DrawingStore] Forme convertie avec succès",{originalType:r.type_forme,convertedType:l.type,properties:l.properties}),Sy(l)}catch(l){console.error("[DrawingStore] Erreur lors de la conversion de la forme",{error:l,forme:r})}return console.warn("[DrawingStore] Utilisation de la forme sans conversion",{type_forme:r.type_forme,data:r.data}),r}),console.log(`[DrawingStore] Plan ${e} - Chargé ${this.elements.length} éléments`,{elements:this.elements.map(r=>({id:r.id,type_forme:r.type_forme,isTextRectangle:r.type_forme==="TextRectangle"||Ig(r.data)}))}),this.currentMapId=e,this.unsavedChanges=!1,i.preferences&&(console.log("[DrawingStore] Chargement des préférences",i.preferences),i.preferences.currentTool&&this.setCurrentTool(i.preferences.currentTool),i.preferences.currentStyle&&(this.currentStyle={...this.currentStyle,...i.preferences.currentStyle}),i.preferences.lastUsedType&&(this.lastUsedType=i.preferences.lastUsedType)),this.elements}catch(t){throw console.error("[DrawingStore] Erreur lors du chargement des éléments:",t),this.error="Erreur lors du chargement des éléments du plan",t}finally{this.loading=!1,n()}},async saveToPlan(e,n){const t=this.performanceMonitor.startMeasure("saveToPlan","DrawingStore");this.loading=!0;try{const i=e||this.currentMapId;if(console.log("[DrawingStore][saveToPlan] Début de la sauvegarde",{targetPlanId:i,currentPlanId:this.currentMapId,elementsCount:this.elements.length,elementsToDelete:n==null?void 0:n.elementsToDelete}),!i)throw new Error("Aucun plan sélectionné pour la sauvegarde");const r=this.performanceMonitor.measure("saveToPlan_prepareElements",()=>this.elements.map(g=>({...g,type_forme:g.type_forme||this.lastUsedType})),"DrawingStore"),o=(n==null?void 0:n.elementsToDelete)||[],l=`/plans/${i}/save_with_elements/`,h=await this.performanceMonitor.measureAsync("saveToPlan_apiCall",()=>Kn.post(l,{formes:r,connexions:[],annotations:[],elementsToDelete:o,preferences:{currentTool:this.currentTool,currentStyle:this.currentStyle,lastUsedType:this.lastUsedType}}),"DrawingStore");return this.elements=this.performanceMonitor.measure("saveToPlan_processResponse",()=>h.data.formes.map(g=>({...g,type_forme:g.type_forme})),"DrawingStore"),this.unsavedChanges=!1,h.data}catch(i){throw console.error("[DrawingStore][saveToPlan] ERREUR:",i),console.error("[DrawingStore][saveToPlan] Stack trace:",i instanceof Error?i.stack:"No stack trace"),this.error="Erreur lors de la sauvegarde du plan",i}finally{this.loading=!1,t()}}}}),c8={class:"h-full flex flex-col bg-white overflow-y-auto"},h8={class:"p-3 border-b border-gray-200"},f8={class:"grid grid-cols-4 gap-1"},d8=["onClick","title"],p8=["innerHTML"],g8={key:0,class:"flex-1 overflow-y-auto"},m8={class:"p-3 border-b border-gray-200"},v8={class:"p-3"},y8={class:"grid grid-cols-6 gap-2 mb-4"},_8=["onClick","title"],b8={key:0,class:"space-y-4"},w8={class:"flex items-center gap-4"},x8={class:"flex items-center gap-2"},L8={class:"flex items-center gap-4"},C8=["value"],S8={key:0,class:"flex items-center gap-4"},P8={class:"flex items-center gap-2"},E8={key:1,class:"space-y-4"},A8={class:"flex items-center gap-4"},M8={class:"flex items-center gap-2"},k8={class:"flex items-center gap-4"},T8={class:"flex items-center gap-2"},B8={class:"flex items-center gap-4"},N8={class:"flex items-center gap-2"},R8={class:"flex items-center gap-4"},D8={class:"flex items-center gap-2 w-full"},O8={class:"flex items-center gap-4"},I8={class:"flex items-center gap-2"},F8={class:"flex items-center gap-4"},z8={class:"flex items-center gap-2"},j8=["onClick","title"],U8=["innerHTML"],$8={key:1,class:"p-3 border-t border-gray-200"},q8={class:"mt-3"},V8={key:0},G8={class:"mb-4"},H8={class:"grid grid-cols-1 gap-4"},W8={key:0,class:"space-y-1"},Z8={class:"flex justify-between items-center"},K8={class:"text-sm font-medium text-gray-500"},J8={class:"flex justify-between items-center"},Y8={class:"text-sm font-medium text-gray-500"},X8={class:"flex justify-between items-center"},Q8={class:"text-sm font-medium text-gray-500"},eT={key:1,class:"space-y-1"},tT={class:"flex justify-between items-center"},nT={class:"text-sm font-medium text-gray-500"},iT={class:"flex justify-between items-center"},rT={class:"text-sm font-medium text-gray-500"},sT={class:"flex justify-between items-center"},oT={class:"text-sm font-medium text-gray-500"},aT={class:"flex justify-between items-center"},lT={class:"text-sm font-medium text-gray-500"},uT={key:2,class:"space-y-1"},cT={class:"flex items-center mb-2"},hT={class:"flex-1 flex items-center"},fT={class:"flex items-center mb-2"},dT={class:"flex-1 flex items-center"},pT={class:"flex justify-between items-center"},gT={class:"text-sm font-medium text-gray-500"},mT={class:"flex justify-between items-center"},vT={class:"text-sm font-medium text-gray-500"},yT={key:3,class:"space-y-1"},_T={class:"flex justify-between items-center"},bT={class:"text-sm font-medium text-gray-500"},wT={class:"flex justify-between items-center"},xT={class:"text-sm font-medium text-gray-500"},LT={class:"flex justify-between items-center"},CT={class:"text-sm font-medium text-gray-500"},ST={class:"flex justify-between items-center"},PT={class:"text-sm font-medium text-gray-500"},ET={class:"text-sm font-medium text-gray-500"},AT={key:5,class:"space-y-1"},MT={class:"flex justify-between items-center"},kT={class:"text-sm font-medium text-gray-500"},TT={class:"flex justify-between items-center"},BT={class:"text-sm font-medium text-gray-500"},NT={class:"flex justify-between items-center"},RT={class:"text-sm font-medium text-gray-500"},DT={class:"flex flex-col space-y-2 w-full"},OT={class:"flex justify-between items-center"},IT={class:"text-sm font-medium text-gray-500 ml-2"},FT={class:"flex justify-between items-center"},zT={class:"text-sm font-medium text-gray-500 ml-2"},jT={class:"flex justify-between items-center"},UT={class:"text-sm font-medium text-gray-500 ml-2"},$T={class:"flex justify-between items-center"},qT={class:"text-sm font-medium text-gray-500 ml-2"},VT={class:"flex justify-between items-center"},GT={class:"text-sm font-medium text-gray-500 ml-2"},HT={ref:"elevationCanvas"},WT={key:1,class:"text-center text-sm text-gray-500"},ZT={key:2,class:"p-3 border-t border-gray-200"},KT={class:"mt-3"},JT={class:"mb-4"},YT={class:"grid grid-cols-2 gap-2"},XT={class:"grid grid-cols-2 gap-2"},QT={key:3,class:"p-3 border-t border-gray-200"},eB={class:"mt-3"},tB={class:"flex justify-between items-center mb-3"},nB={key:0,class:"space-y-3"},iB={class:"pl-3"},rB={class:"flex justify-between items-center mb-2"},sB={class:"flex-grow min-w-0 mr-2"},oB=["onUpdate:modelValue","onChange"],aB=["onClick"],lB={class:"grid grid-cols-2 gap-2 mb-2"},uB={class:"min-w-0"},cB=["onUpdate:modelValue","onChange"],hB={class:"min-w-0"},fB=["onUpdate:modelValue","onChange"],dB={class:"min-w-0"},pB=["onUpdate:modelValue","onChange"],gB={class:"min-w-0"},mB={class:"w-full px-2 py-1 text-sm text-gray-700 bg-gray-50 rounded truncate"},vB={class:"col-span-2"},yB=["onUpdate:modelValue","onChange"],_B={class:"w-full h-8 bg-gray-100 rounded relative overflow-hidden"},bB=["onClick"],wB={key:0,class:"mt-1 text-xs text-center p-1 bg-blue-100 text-blue-800 rounded"},xB={key:1,class:"text-center text-sm text-gray-500 py-2"},LB=Pa({__name:"DrawingTools",setup(e){const n=[{type:"polygon",label:"Polygone"},{type:"line",label:"Ligne"},{type:"elevation",label:"Profil altimétrique"},{type:"note",label:"Note géolocalisée"}],t=i=>{switch(i){case"polygon":return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5l16 0l0 14l-16 0l0 -14z"/></svg>';case"line":return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 20l16 -16"/></svg>';case"elevation":return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 20h18l-3-3l-4 4l-4-7l-4 4l-3-3"/></svg>';case"note":return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/></svg>'}};return un({title:"",description:"",visibility:"private",attachments:[],location:null}),Ni(()=>{var r;switch((r=useAuthStore().user)==null?void 0:r.user_type){case"admin":case"entreprise":return[{value:"private",label:"Privé"},{value:"enterprise",label:"Entreprise"},{value:"employee",label:"Salariés"},{value:"visitor",label:"Visiteurs"}];case"salarie":return[{value:"private",label:"Privé"},{value:"employee",label:"Salariés"},{value:"visitor",label:"Visiteurs"}];default:return[{value:"private",label:"Privé"}]}}),(i,r)=>(Ye(),tt("div",c8,[r[121]||(r[121]=M("div",{class:"p-3 bg-gray-50 border-b border-gray-200"},[M("h3",{class:"text-sm font-semibold text-gray-700"},"Outils de dessin")],-1)),M("div",h8,[M("div",f8,[(Ye(!0),tt(zn,null,Ti(n.filter(o=>o.type!=="delete"),o=>(Ye(),tt("button",{key:o.type,class:Jr(["flex items-center justify-center p-2 rounded border",{"bg-blue-50 border-blue-200 text-blue-700":i.currentTool===o.type}]),onClick:l=>i.$emit("tool-change",i.currentTool===o.type?"":o.type),title:o.label},[M("span",{class:"icon",innerHTML:t(o.type)},null,8,p8)],10,d8))),128))]),i.selectedShape?(Ye(),tt("button",{key:0,class:Jr(["w-full mt-2 p-2 rounded border border-red-200 bg-red-50 text-red-600 hover:bg-red-100",{"bg-red-100":i.currentTool==="delete"}]),onClick:r[0]||(r[0]=o=>i.$emit("delete-shape")),title:"Supprimer la forme"},r[54]||(r[54]=[M("svg",{class:"w-4 h-4 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),2)):wn("",!0)]),i.selectedShape&&i.localProperties?(Ye(),tt("div",g8,[M("div",m8,[M("button",{class:"flex items-center justify-between w-full text-sm font-semibold text-gray-700",onClick:r[1]||(r[1]=o=>i.toggleSection("style"))},[r[56]||(r[56]=M("span",null,"Style",-1)),(Ye(),tt("svg",{class:Jr(["w-4 h-4",{"rotate-180":!i.sectionsCollapsed.style}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},r[55]||(r[55]=[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))])]),Dn(M("div",v8,[M("div",y8,[(Ye(!0),tt(zn,null,Ti(i.predefinedColors,o=>(Ye(),tt("button",{key:o,class:"w-8 h-8 rounded-full",style:Jc({backgroundColor:o}),onClick:l=>i.selectPresetColor(o),title:o},null,12,_8))),128))]),i.localProperties.type!=="TextRectangle"?(Ye(),tt("div",b8,[M("div",w8,[r[57]||(r[57]=M("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Contour",-1)),M("div",x8,[Dn(M("input",{type:"color","onUpdate:modelValue":r[2]||(r[2]=o=>i.strokeColor=o),class:"w-16 h-8 rounded border",onChange:r[3]||(r[3]=o=>i.updateStyle({strokeColor:i.strokeColor})),title:"Couleur du contour"},null,544),[[ki,i.strokeColor]]),Dn(M("input",{type:"range","onUpdate:modelValue":r[4]||(r[4]=o=>i.strokeWidth=o),min:"1",max:"10",class:"w-16 h-2 rounded-md",onChange:r[5]||(r[5]=o=>i.updateStyle({strokeWidth:i.strokeWidth})),title:"Épaisseur du contour"},null,544),[[ki,i.strokeWidth]])])]),M("div",L8,[r[58]||(r[58]=M("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Style",-1)),Dn(M("select",{"onUpdate:modelValue":r[6]||(r[6]=o=>i.strokeStyle=o),class:"w-full rounded border",onChange:r[7]||(r[7]=o=>i.updateStyle({strokeStyle:i.strokeStyle}))},[(Ye(!0),tt(zn,null,Ti(i.strokeStyles,o=>(Ye(),tt("option",{key:o.value,value:o.value},Ht(o.label),9,C8))),128))],544),[[Ws,i.strokeStyle]])]),i.showFillOptions?(Ye(),tt("div",S8,[r[59]||(r[59]=M("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Remplir",-1)),M("div",P8,[Dn(M("input",{type:"color","onUpdate:modelValue":r[8]||(r[8]=o=>i.fillColor=o),class:"w-16 h-8 rounded border",onChange:r[9]||(r[9]=o=>i.updateStyle({fillColor:i.fillColor})),title:"Couleur de remplissage"},null,544),[[ki,i.fillColor]]),Dn(M("input",{type:"range","onUpdate:modelValue":r[10]||(r[10]=o=>i.fillOpacity=o),min:"0",max:"1",step:"0.1",class:"w-16 h-2 rounded-md",onChange:r[11]||(r[11]=o=>i.updateStyle({fillOpacity:i.fillOpacity})),title:"Opacité du remplissage"},null,544),[[ki,i.fillOpacity]])])])):wn("",!0)])):wn("",!0),i.localProperties.type==="TextRectangle"?(Ye(),tt("div",E8,[M("div",A8,[r[60]||(r[60]=M("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Contour",-1)),M("div",M8,[Dn(M("input",{type:"color","onUpdate:modelValue":r[12]||(r[12]=o=>i.strokeColor=o),class:"w-16 h-8 rounded border",onChange:r[13]||(r[13]=o=>i.updateStyle({strokeColor:i.strokeColor})),title:"Couleur du contour"},null,544),[[ki,i.strokeColor]]),Dn(M("input",{type:"range","onUpdate:modelValue":r[14]||(r[14]=o=>i.strokeWidth=o),min:"1",max:"10",class:"w-16 h-2 rounded-md",onChange:r[15]||(r[15]=o=>i.updateStyle({strokeWidth:i.strokeWidth})),title:"Épaisseur du contour"},null,544),[[ki,i.strokeWidth]])])]),M("div",k8,[r[61]||(r[61]=M("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Remplir",-1)),M("div",T8,[Dn(M("input",{type:"color","onUpdate:modelValue":r[16]||(r[16]=o=>i.fillColor=o),class:"w-16 h-8 rounded border",onChange:r[17]||(r[17]=o=>i.updateStyle({fillColor:i.fillColor})),title:"Couleur de remplissage"},null,544),[[ki,i.fillColor]]),Dn(M("input",{type:"range","onUpdate:modelValue":r[18]||(r[18]=o=>i.fillOpacity=o),min:"0",max:"1",step:"0.1",class:"w-16 h-2 rounded-md",onChange:r[19]||(r[19]=o=>i.updateStyle({fillOpacity:i.fillOpacity})),title:"Opacité du remplissage"},null,544),[[ki,i.fillOpacity]])])]),M("div",B8,[r[62]||(r[62]=M("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Texte",-1)),M("div",N8,[Dn(M("input",{type:"color","onUpdate:modelValue":r[20]||(r[20]=o=>i.textColor=o),class:"w-16 h-8 rounded border",onChange:r[21]||(r[21]=o=>i.updateTextStyle({textColor:i.textColor})),title:"Couleur du texte"},null,544),[[ki,i.textColor]])])]),M("div",R8,[r[64]||(r[64]=M("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Taille",-1)),M("div",D8,[Dn(M("select",{"onUpdate:modelValue":r[22]||(r[22]=o=>i.fontSize=o),class:"w-full rounded border",onChange:r[23]||(r[23]=o=>i.updateTextStyle({fontSize:i.fontSize}))},r[63]||(r[63]=[wc('<option value="10px" data-v-0d0ef882>Très petit</option><option value="12px" data-v-0d0ef882>Petit</option><option value="14px" data-v-0d0ef882>Normal</option><option value="16px" data-v-0d0ef882>Moyen</option><option value="18px" data-v-0d0ef882>Grand</option><option value="24px" data-v-0d0ef882>Très grand</option><option value="32px" data-v-0d0ef882>Énorme</option>',7)]),544),[[Ws,i.fontSize]])])]),M("div",O8,[r[66]||(r[66]=M("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Police",-1)),M("div",I8,[Dn(M("select",{"onUpdate:modelValue":r[24]||(r[24]=o=>i.fontFamily=o),class:"w-full rounded border",onChange:r[25]||(r[25]=o=>i.updateTextStyle({fontFamily:i.fontFamily}))},r[65]||(r[65]=[wc('<option value="Arial, sans-serif" data-v-0d0ef882>Arial</option><option value="&#39;Times New Roman&#39;, serif" data-v-0d0ef882>Times</option><option value="&#39;Courier New&#39;, monospace" data-v-0d0ef882>Courier</option><option value="Georgia, serif" data-v-0d0ef882>Georgia</option><option value="Verdana, sans-serif" data-v-0d0ef882>Verdana</option>',5)]),544),[[Ws,i.fontFamily]])])]),M("div",F8,[r[67]||(r[67]=M("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Align.",-1)),M("div",z8,[(Ye(!0),tt(zn,null,Ti(i.textAlignOptions,o=>(Ye(),tt("button",{key:o.value,class:Jr(["flex items-center justify-center p-2 rounded border",{"bg-blue-50 border-blue-200 text-blue-700":i.currentTextAlign===o.value}]),onClick:l=>i.updateTextStyle({textAlign:o.value}),title:o.label},[M("span",{innerHTML:o.icon},null,8,U8)],10,j8))),128)),M("button",{class:Jr(["flex items-center justify-center p-2 rounded border",{"bg-blue-50 border-blue-200 text-blue-700":i.isBold}]),onClick:r[26]||(r[26]=(...o)=>i.toggleBold&&i.toggleBold(...o)),title:"Gras"}," B ",2),M("button",{class:Jr(["flex items-center justify-center p-2 rounded border",{"bg-blue-50 border-blue-200 text-blue-700":i.isItalic}]),onClick:r[27]||(r[27]=(...o)=>i.toggleItalic&&i.toggleItalic(...o)),title:"Italique"}," I ",2)])])])):wn("",!0)],512),[[_f,!i.sectionsCollapsed.style]])])):wn("",!0),i.selectedShape&&i.localProperties&&i.localProperties.type!=="TextRectangle"?(Ye(),tt("div",$8,[M("button",{class:"flex items-center justify-between w-full text-sm font-semibold text-gray-700",onClick:r[28]||(r[28]=o=>i.toggleSection("properties"))},[r[69]||(r[69]=M("span",null,"Propriétés",-1)),(Ye(),tt("svg",{class:Jr(["w-4 h-4",{"rotate-180":!i.sectionsCollapsed.properties}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},r[68]||(r[68]=[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),Dn(M("div",q8,[i.localProperties?(Ye(),tt("div",V8,[M("div",G8,[r[70]||(r[70]=M("label",{for:"shapeName",class:"block text-sm font-medium text-gray-700 mb-1"},"Nom de la forme",-1)),Dn(M("input",{type:"text",id:"shapeName","onUpdate:modelValue":r[29]||(r[29]=o=>i.shapeName=o),onChange:r[30]||(r[30]=(...o)=>i.updateShapeName&&i.updateShapeName(...o)),placeholder:"Donnez un nom à cette forme",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"},null,544),[[ki,i.shapeName]])]),M("div",H8,[i.localProperties.type==="Circle"?(Ye(),tt("div",W8,[M("div",Z8,[r[71]||(r[71]=M("span",{class:"text-sm font-semibold text-gray-700"},"Rayon :",-1)),M("span",K8,Ht(i.formatLength(i.localProperties.radius||0)),1)]),M("div",J8,[r[72]||(r[72]=M("span",{class:"text-sm font-semibold text-gray-700"},"Surface :",-1)),M("span",Y8,Ht(i.formatArea(i.localProperties.surface||0)),1)]),M("div",X8,[r[73]||(r[73]=M("span",{class:"text-sm font-semibold text-gray-700"},"Surface totale d'irrigation :",-1)),M("span",Q8,Ht(i.formatArea(i.totalCoverageArea||0)),1)])])):i.localProperties.type==="CircleWithSections"?(Ye(),tt("div",eT,[M("div",tT,[r[74]||(r[74]=M("span",{class:"text-sm font-semibold text-gray-700"},"Rayon total :",-1)),M("span",nT,Ht(i.formatLength(i.localProperties.radius||0)),1)]),M("div",iT,[r[75]||(r[75]=M("span",{class:"text-sm font-semibold text-gray-700"},"Surface totale :",-1)),M("span",rT,Ht(i.formatArea(i.localProperties.surface||0)),1)]),M("div",sT,[r[76]||(r[76]=M("span",{class:"text-sm font-semibold text-gray-700"},"Surface des sections :",-1)),M("span",oT,Ht(i.formatArea(i.localProperties.sectionArea||0)),1)]),M("div",aT,[r[77]||(r[77]=M("span",{class:"text-sm font-semibold text-gray-700"},"Nombre de sections :",-1)),M("span",lT,Ht(i.circleSections.length),1)])])):i.localProperties.type==="Rectangle"?(Ye(),tt("div",uT,[M("div",cT,[r[79]||(r[79]=M("label",{for:"rectangle-width",class:"text-sm font-semibold text-gray-700 w-20"},"Largeur :",-1)),M("div",hT,[Dn(M("input",{id:"rectangle-width",type:"number","onUpdate:modelValue":r[31]||(r[31]=o=>i.rectangleWidth=o),min:"1",step:"0.01",class:"w-full px-2 py-1 border border-gray-300 rounded-md text-sm",onChange:r[32]||(r[32]=(...o)=>i.updateRectangleDimensions&&i.updateRectangleDimensions(...o))},null,544),[[ki,i.rectangleWidth]]),r[78]||(r[78]=M("span",{class:"text-sm text-gray-500 ml-1"},"m",-1))])]),M("div",fT,[r[81]||(r[81]=M("label",{for:"rectangle-height",class:"text-sm font-semibold text-gray-700 w-20"},"Hauteur :",-1)),M("div",dT,[Dn(M("input",{id:"rectangle-height",type:"number","onUpdate:modelValue":r[33]||(r[33]=o=>i.rectangleHeight=o),min:"1",step:"0.01",class:"w-full px-2 py-1 border border-gray-300 rounded-md text-sm",onChange:r[34]||(r[34]=(...o)=>i.updateRectangleDimensions&&i.updateRectangleDimensions(...o))},null,544),[[ki,i.rectangleHeight]]),r[80]||(r[80]=M("span",{class:"text-sm text-gray-500 ml-1"},"m",-1))])]),M("div",pT,[r[82]||(r[82]=M("span",{class:"text-sm font-semibold text-gray-700"},"Surface :",-1)),M("span",gT,Ht(i.formatArea(i.localProperties.surface||0)),1)]),M("div",mT,[r[83]||(r[83]=M("span",{class:"text-sm font-semibold text-gray-700"},"Surface totale d'irrigation :",-1)),M("span",vT,Ht(i.formatArea(i.totalCoverageArea||0)),1)])])):i.localProperties.type==="Semicircle"?(Ye(),tt("div",yT,[M("div",_T,[r[84]||(r[84]=M("span",{class:"text-sm font-semibold text-gray-700"},"Rayon :",-1)),M("span",bT,Ht(i.formatLength(i.localProperties.radius||0)),1)]),M("div",wT,[r[85]||(r[85]=M("span",{class:"text-sm font-semibold text-gray-700"},"Surface :",-1)),M("span",xT,Ht(i.formatArea(i.localProperties.surface||0)),1)]),M("div",LT,[r[86]||(r[86]=M("span",{class:"text-sm font-semibold text-gray-700"},"Surface totale d'irrigation :",-1)),M("span",CT,Ht(i.formatArea(i.totalCoverageArea||0)),1)]),M("div",ST,[r[87]||(r[87]=M("span",{class:"text-sm font-semibold text-gray-700"},"Angle :",-1)),M("span",PT,Ht(Math.round(i.localProperties.openingAngle||0))+"°",1)])])):i.localProperties.type==="Line"?(Ye(),tt(zn,{key:4},[r[88]||(r[88]=M("span",{class:"text-sm font-semibold text-gray-700"},"Longueur :",-1)),M("span",ET,Ht(i.formatLength(i.localProperties.length||0)),1)],64)):i.localProperties.type==="Polygon"?(Ye(),tt("div",AT,[M("div",MT,[r[89]||(r[89]=M("span",{class:"text-sm font-semibold text-gray-700"},"Surface :",-1)),M("span",kT,Ht(i.formatArea(i.localProperties.surface||0)),1)]),M("div",TT,[r[90]||(r[90]=M("span",{class:"text-sm font-semibold text-gray-700"},"Surface totale d'irrigation :",-1)),M("span",BT,Ht(i.formatArea(i.totalCoverageArea||0)),1)]),M("div",NT,[r[91]||(r[91]=M("span",{class:"text-sm font-semibold text-gray-700"},"Périmètre :",-1)),M("span",RT,Ht(i.formatLength(i.localProperties.perimeter||0)),1)])])):i.localProperties.type==="ElevationLine"?(Ye(),tt(zn,{key:6},[M("div",DT,[M("div",OT,[r[92]||(r[92]=M("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Distance totale :",-1)),M("span",IT,Ht(i.formatLength(i.localProperties.length||0)),1)]),M("div",FT,[r[93]||(r[93]=M("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Dénivelé + :",-1)),M("span",zT,Ht(i.formatLength(i.localProperties.elevationGain||0)),1)]),M("div",jT,[r[94]||(r[94]=M("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Dénivelé - :",-1)),M("span",UT,Ht(i.formatLength(i.localProperties.elevationLoss||0)),1)]),M("div",$T,[r[95]||(r[95]=M("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Pente moy. :",-1)),M("span",qT,Ht(i.formatSlope(i.localProperties.averageSlope||0)),1)]),M("div",VT,[r[96]||(r[96]=M("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Pente max :",-1)),M("span",GT,Ht(i.formatSlope(i.localProperties.maxSlope||0)),1)])]),M("div",{ref:"elevationProfileContainer",class:"elevation-profile-container w-full h-48 bg-gray-50 rounded border border-gray-200 relative mt-4",onMousemove:r[35]||(r[35]=(...o)=>i.handleProfileHover&&i.handleProfileHover(...o)),onMouseleave:r[36]||(r[36]=(...o)=>i.handleProfileLeave&&i.handleProfileLeave(...o))},[M("canvas",HT,null,512)],544)],64)):wn("",!0)])])):(Ye(),tt("div",WT," Aucune propriété disponible "))],512),[[_f,!i.sectionsCollapsed.properties]])])):wn("",!0),i.selectedShape&&i.localProperties&&i.localProperties.type==="ElevationLine"?(Ye(),tt("div",ZT,[M("button",{class:"flex items-center justify-between w-full text-sm font-semibold text-gray-700",onClick:r[37]||(r[37]=o=>i.toggleSection("samplePoints"))},[r[98]||(r[98]=M("span",null,"Points d'échantillonnage",-1)),(Ye(),tt("svg",{class:Jr(["w-4 h-4",{"rotate-180":!i.sectionsCollapsed.samplePoints}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},r[97]||(r[97]=[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),Dn(M("div",KT,[M("div",JT,[r[103]||(r[103]=M("h4",{class:"text-sm font-semibold mb-2"},"Points normaux",-1)),M("div",YT,[M("div",null,[r[99]||(r[99]=M("label",{class:"text-xs text-gray-600"},"Taille",-1)),Dn(M("input",{type:"number","onUpdate:modelValue":r[38]||(r[38]=o=>i.samplePointStyle.radius=o),min:"2",max:"10",step:"1",class:"w-full px-2 py-1 border rounded",onChange:r[39]||(r[39]=(...o)=>i.updateSamplePointStyle&&i.updateSamplePointStyle(...o))},null,544),[[ki,i.samplePointStyle.radius]])]),M("div",null,[r[100]||(r[100]=M("label",{class:"text-xs text-gray-600"},"Couleur",-1)),Dn(M("input",{type:"color","onUpdate:modelValue":r[40]||(r[40]=o=>i.samplePointStyle.color=o),class:"w-full h-8 px-1 border rounded",onChange:r[41]||(r[41]=(...o)=>i.updateSamplePointStyle&&i.updateSamplePointStyle(...o))},null,544),[[ki,i.samplePointStyle.color]])]),M("div",null,[r[101]||(r[101]=M("label",{class:"text-xs text-gray-600"},"Opacité",-1)),Dn(M("input",{type:"range","onUpdate:modelValue":r[42]||(r[42]=o=>i.samplePointStyle.fillOpacity=o),min:"0",max:"1",step:"0.1",class:"w-full",onChange:r[43]||(r[43]=(...o)=>i.updateSamplePointStyle&&i.updateSamplePointStyle(...o))},null,544),[[ki,i.samplePointStyle.fillOpacity]])]),M("div",null,[r[102]||(r[102]=M("label",{class:"text-xs text-gray-600"},"Bordure",-1)),Dn(M("input",{type:"number","onUpdate:modelValue":r[44]||(r[44]=o=>i.samplePointStyle.weight=o),min:"1",max:"5",step:"1",class:"w-full px-2 py-1 border rounded",onChange:r[45]||(r[45]=(...o)=>i.updateSamplePointStyle&&i.updateSamplePointStyle(...o))},null,544),[[ki,i.samplePointStyle.weight]])])])]),M("div",null,[r[107]||(r[107]=M("h4",{class:"text-sm font-semibold mb-2"},"Points min/max",-1)),M("div",XT,[M("div",null,[r[104]||(r[104]=M("label",{class:"text-xs text-gray-600"},"Taille",-1)),Dn(M("input",{type:"number","onUpdate:modelValue":r[46]||(r[46]=o=>i.minMaxPointStyle.radius=o),min:"4",max:"12",step:"1",class:"w-full px-2 py-1 border rounded",onChange:r[47]||(r[47]=(...o)=>i.updateMinMaxPointStyle&&i.updateMinMaxPointStyle(...o))},null,544),[[ki,i.minMaxPointStyle.radius]])]),M("div",null,[r[105]||(r[105]=M("label",{class:"text-xs text-gray-600"},"Bordure",-1)),Dn(M("input",{type:"number","onUpdate:modelValue":r[48]||(r[48]=o=>i.minMaxPointStyle.weight=o),min:"1",max:"5",step:"1",class:"w-full px-2 py-1 border rounded",onChange:r[49]||(r[49]=(...o)=>i.updateMinMaxPointStyle&&i.updateMinMaxPointStyle(...o))},null,544),[[ki,i.minMaxPointStyle.weight]])]),M("div",null,[r[106]||(r[106]=M("label",{class:"text-xs text-gray-600"},"Opacité",-1)),Dn(M("input",{type:"range","onUpdate:modelValue":r[50]||(r[50]=o=>i.minMaxPointStyle.fillOpacity=o),min:"0",max:"1",step:"0.1",class:"w-full",onChange:r[51]||(r[51]=(...o)=>i.updateMinMaxPointStyle&&i.updateMinMaxPointStyle(...o))},null,544),[[ki,i.minMaxPointStyle.fillOpacity]])])])])],512),[[_f,!i.sectionsCollapsed.samplePoints]])])):wn("",!0),i.selectedShape&&i.localProperties&&i.localProperties.type==="CircleWithSections"?(Ye(),tt("div",QT,[M("button",{class:"flex items-center justify-between w-full text-sm font-semibold text-gray-700",onClick:r[52]||(r[52]=o=>i.toggleSection("circleSections"))},[r[109]||(r[109]=M("span",null,"Sections",-1)),(Ye(),tt("svg",{class:Jr(["w-4 h-4",{"rotate-180":!i.sectionsCollapsed.circleSections}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},r[108]||(r[108]=[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),Dn(M("div",eB,[M("div",tB,[r[111]||(r[111]=M("h4",{class:"text-sm font-semibold"},"Sections d'irrigation",-1)),M("button",{class:"p-1 rounded-full bg-blue-500 text-white hover:bg-blue-600",onClick:r[53]||(r[53]=(...o)=>i.addSection&&i.addSection(...o)),title:"Ajouter une section"},r[110]||(r[110]=[M("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)]))]),i.circleSections.length>0?(Ye(),tt("div",nB,[(Ye(!0),tt(zn,null,Ti(i.circleSections,o=>(Ye(),tt("div",{key:o.id,class:"border rounded p-2 relative"},[M("div",{class:"absolute top-0 left-0 w-1 h-full",style:Jc({backgroundColor:o.color})},null,4),M("div",iB,[M("div",rB,[M("div",sB,[Dn(M("input",{type:"text","onUpdate:modelValue":l=>o.name=l,class:"w-full font-medium px-2 py-1 border border-gray-200 focus:border-blue-300 rounded text-sm truncate text-ellipsis",onChange:l=>i.updateSection(o.id,{name:o.name})},null,40,oB),[[ki,o.name]])]),M("button",{class:"text-red-500 hover:text-red-700 p-1 rounded hover:bg-red-50 flex-shrink-0",onClick:l=>i.removeSection(o.id),title:"Supprimer la section"},r[112]||(r[112]=[M("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,aB)]),M("div",lB,[M("div",uB,[r[113]||(r[113]=M("label",{class:"text-xs text-gray-600 block truncate"},"Angle début",-1)),Dn(M("input",{type:"number","onUpdate:modelValue":l=>o.startAngle=l,min:"0",max:"360",step:"5",class:"w-full px-2 py-1 border rounded text-sm",onChange:l=>i.updateSection(o.id,{startAngle:o.startAngle})},null,40,cB),[[ki,o.startAngle,void 0,{number:!0}]])]),M("div",hB,[r[114]||(r[114]=M("label",{class:"text-xs text-gray-600 block truncate"},"Angle fin",-1)),Dn(M("input",{type:"number","onUpdate:modelValue":l=>o.endAngle=l,min:"0",max:"360",step:"5",class:"w-full px-2 py-1 border rounded text-sm",onChange:l=>i.updateSection(o.id,{endAngle:o.endAngle})},null,40,fB),[[ki,o.endAngle,void 0,{number:!0}]])]),M("div",dB,[r[115]||(r[115]=M("label",{class:"text-xs text-gray-600 block truncate"},"Rayon (m)",-1)),Dn(M("input",{type:"number","onUpdate:modelValue":l=>o.radius=l,min:1,step:"1",class:"w-full px-2 py-1 border rounded text-sm",onChange:l=>i.updateSection(o.id,{radius:o.radius})},null,40,pB),[[ki,o.radius,void 0,{number:!0}]])]),M("div",gB,[r[116]||(r[116]=M("label",{class:"text-xs text-gray-600 block truncate"},"Surface",-1)),M("div",mB,Ht(i.formatArea(Math.PI*o.radius*o.radius*(o.endAngle-o.startAngle)/360||0)),1)]),M("div",vB,[r[117]||(r[117]=M("label",{class:"text-xs text-gray-600 block truncate"},"Couleur",-1)),Dn(M("input",{type:"color","onUpdate:modelValue":l=>o.color=l,class:"w-full h-8 px-1 border rounded",onChange:l=>i.updateSection(o.id,{color:o.color})},null,40,yB),[[ki,o.color]])])]),M("div",_B,[i.isFullCircle(o)?(Ye(),tt("div",{key:0,class:"absolute h-full w-full",style:Jc({backgroundColor:o.color,opacity:.5})},null,4)):(Ye(),tt("div",{key:1,class:"absolute h-full",style:Jc({backgroundColor:o.color,opacity:.5,left:o.startAngle/360*100+"%",width:(o.endAngle-o.startAngle+360)%360/360*100+"%"})},null,4)),i.isFullCircle(o)?wn("",!0):(Ye(),tt("button",{key:2,class:"absolute right-0 top-0 p-0.5 text-xs text-gray-500 hover:text-gray-700 z-10",title:"Faire un cercle complet",onClick:l=>i.makeFullCircle(o)},r[118]||(r[118]=[M("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)]),8,bB)),r[119]||(r[119]=wc('<div class="absolute h-full w-px bg-gray-400 left-0" data-v-0d0ef882></div><div class="absolute h-full w-px bg-gray-400 left-25%" data-v-0d0ef882></div><div class="absolute h-full w-px bg-gray-400 left-50%" data-v-0d0ef882></div><div class="absolute h-full w-px bg-gray-400 left-75%" data-v-0d0ef882></div><div class="absolute h-full w-px bg-gray-400 right-0" data-v-0d0ef882></div><div class="absolute text-xs bottom-0 left-0 text-gray-600" data-v-0d0ef882>0°</div><div class="absolute text-xs bottom-0 left-25% -ml-2 text-gray-600" data-v-0d0ef882>90°</div><div class="absolute text-xs bottom-0 left-50% -ml-2 text-gray-600" data-v-0d0ef882>180°</div><div class="absolute text-xs bottom-0 left-75% -ml-2 text-gray-600" data-v-0d0ef882>270°</div><div class="absolute text-xs bottom-0 right-0 -mr-6 text-gray-600" data-v-0d0ef882>360°</div>',10))]),i.isFullCircle(o)?(Ye(),tt("div",wB," Cercle complet (360°) ")):wn("",!0)])]))),128))])):(Ye(),tt("div",xB,r[120]||(r[120]=[Br(" Aucune section d'irrigation définie. "),M("br",null,null,-1),Br(" Cliquez sur le bouton + pour en ajouter. ")])))],512),[[_f,!i.sectionsCollapsed.circleSections]])])):wn("",!0)]))}}),CB=bm(LB,[["__scopeId","data-v-0d0ef882"]]),SB={class:"map-toolbar w-full"},PB={class:"hidden md:flex items-center space-x-2"},EB={class:"dropdown"},AB={class:"dropdown-menu"},MB=["onClick"],kB={key:0,class:"border-l pl-2 flex-1"},TB={class:"flex items-center"},BB={class:"plan-info"},NB={class:"plan-name"},RB={key:0,class:"plan-description"},DB={class:"border-l pl-2 ml-auto"},OB={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},IB={key:1,class:"h-4 w-4 mr-2 text-primary-600",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},FB={key:"saving"},zB={key:"success",class:"save-success-text"},jB={key:"default"},UB={class:"md:hidden"},$B={class:"flex justify-between items-center"},qB={key:0,class:"truncate mx-2 text-sm font-medium"},VB={key:0,class:"mobile-menu mt-2 bg-white shadow-md rounded p-2 z-50"},GB={class:"flex flex-col space-y-2"},HB={key:0,class:"flex flex-col pb-2 border-b"},WB={class:"text-sm font-semibold text-gray-800"},ZB={key:0,class:"text-xs text-gray-600 mt-1"},KB={class:"flex flex-col"},JB={class:"grid grid-cols-2 gap-1"},YB=["onClick"],XB={key:0,class:"animate-spin h-3 w-3 mr-1 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},QB={key:1,class:"h-3 w-3 mr-1 text-primary-600",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},e7={key:"saving"},t7={key:"success",class:"save-success-text"},n7={key:"default"},i7=Pa({__name:"MapToolbar",props:{lastSave:{},planName:{},planDescription:{},saveStatus:{}},emits:["change-map-type","create-new-plan","load-plan","save-plan","adjust-view","generate-summary"],setup(e,{emit:n}){const t=n,i=e,r=un("Ville"),o=un(!1),l=Q=>{const F=Q.currentTarget,G=F.nextElementSibling;if(G&&G.classList.contains("dropdown-menu")){const me=F.getBoundingClientRect();G.style.top=`${me.bottom}px`,G.style.left=`${me.left}px`}},h={Ville:"Ville",Satellite:"Satellite",Cadastre:"Cadastre"},g=Ni(()=>i.lastSave?new Date(i.lastSave).toLocaleString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Jamais"),v=Q=>{r.value=Q,t("change-map-type",Q),$()},_=()=>{t("create-new-plan"),$()},x=()=>{t("load-plan"),$()},E=()=>{t("save-plan"),$()},b=()=>{t("adjust-view"),$()},D=()=>{t("generate-summary"),$()},$=()=>{o.value=!1};return(Q,F)=>(Ye(),tt("div",SB,[M("div",PB,[M("div",EB,[M("button",{class:"btn-toolbar dropdown-toggle",onMouseover:l},[F[1]||(F[1]=M("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{"fill-rule":"evenodd",d:"M12 1.586l-4 4V17h8V5.586l-4-4zM2 17V9.276l4-3.638V17H2zM2 8.162V3h4.5L12 8.5V17H6V5.638L2 8.162z","clip-rule":"evenodd"})],-1)),M("span",null,Ht(h[r.value]),1)],32),M("div",AB,[(Ye(),tt(zn,null,Ti(h,(G,me)=>M("button",{key:me,class:Jr(["dropdown-item",{active:me===r.value}]),onClick:Se=>v(me)},Ht(G),11,MB)),64))])]),Q.planName?(Ye(),tt("div",kB,[M("div",TB,[M("div",BB,[M("h2",NB,Ht(Q.planName),1),Q.planDescription?(Ye(),tt("p",RB,Ht(Q.planDescription),1)):wn("",!0)])])])):wn("",!0),M("div",{class:"border-l pl-2"},[M("div",{class:"flex items-center space-x-1"},[M("button",{onClick:_,class:"btn-toolbar",title:"Nouveau plan"},F[2]||(F[2]=[M("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{"fill-rule":"evenodd",d:"M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V8z","clip-rule":"evenodd"})],-1),M("span",{class:"hidden lg:inline ml-1"},"Nouveau",-1)])),M("button",{onClick:x,class:"btn-toolbar",title:"Charger un plan"},F[3]||(F[3]=[wc('<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" data-v-206c3e68><path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" data-v-206c3e68></path><path d="M10 9a1 1 0 011-1h5a1 1 0 110 2h-5a1 1 0 01-1-1z" data-v-206c3e68></path><path fill-rule="evenodd" d="M13 5a1 1 0 011 1v4a1 1 0 11-2 0V6a1 1 0 011-1z" clip-rule="evenodd" data-v-206c3e68></path></svg><span class="hidden lg:inline ml-1" data-v-206c3e68>Charger</span>',2)])),M("button",{onClick:E,class:"btn-toolbar",title:"Enregistrer le plan"},F[4]||(F[4]=[M("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6h5a2 2 0 012 2v7a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2h5v5.586l-1.293-1.293zM9 4a1 1 0 012 0v2H9V4z"})],-1),M("span",{class:"hidden lg:inline ml-1"},"Enregistrer",-1)]))])]),M("div",{class:"border-l pl-2"},[M("div",{class:"flex items-center space-x-1"},[M("button",{onClick:b,class:"btn-toolbar",title:"Ajuster la vue"},F[5]||(F[5]=[M("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1),M("span",{class:"hidden lg:inline ml-1"},"Ajuster",-1)])),M("button",{onClick:D,class:"btn-toolbar",title:"Générer une synthèse"},F[6]||(F[6]=[M("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{"fill-rule":"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})],-1),M("span",{class:"hidden lg:inline ml-1"},"Synthèse",-1)]))])]),M("div",DB,[M("div",{class:Jr(["text-xs hidden lg:flex items-center",{"text-gray-500":!Q.saveStatus,"text-primary-600 font-medium":Q.saveStatus==="success","text-blue-600 font-medium":Q.saveStatus==="saving"}])},[Q.saveStatus==="saving"?(Ye(),tt("svg",OB,F[7]||(F[7]=[M("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),M("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):wn("",!0),Q.saveStatus==="success"?(Ye(),tt("svg",IB,F[8]||(F[8]=[M("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):wn("",!0),Yr(ov,{name:"fade-slide",mode:"out-in"},{default:vc(()=>[Q.saveStatus==="saving"?(Ye(),tt("span",FB," Sauvegarde en cours... ")):Q.saveStatus==="success"?(Ye(),tt("span",zB," Sauvegarde réussie ! ")):(Ye(),tt("span",jB," Dernière modification : "+Ht(g.value),1))]),_:1})],2)])]),M("div",UB,[M("div",$B,[M("button",{onClick:F[0]||(F[0]=G=>o.value=!o.value),class:"p-1 rounded border"},F[9]||(F[9]=[M("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-600",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{"fill-rule":"evenodd",d:"M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})],-1)])),Q.planName?(Ye(),tt("div",qB,Ht(Q.planName),1)):wn("",!0),M("div",{class:"flex space-x-1"},[M("button",{onClick:_,class:"p-1 rounded border bg-white"},F[10]||(F[10]=[M("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{"fill-rule":"evenodd",d:"M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V8z","clip-rule":"evenodd"})],-1)])),M("button",{onClick:E,class:"p-1 rounded border bg-white"},F[11]||(F[11]=[M("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6h5a2 2 0 012 2v7a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2h5v5.586l-1.293-1.293zM9 4a1 1 0 012 0v2H9V4z"})],-1)])),M("button",{onClick:b,class:"p-1 rounded border bg-white"},F[12]||(F[12]=[M("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1)]))])]),o.value?(Ye(),tt("div",VB,[M("div",GB,[Q.planName?(Ye(),tt("div",HB,[M("h3",WB,Ht(Q.planName),1),Q.planDescription?(Ye(),tt("p",ZB,Ht(Q.planDescription),1)):wn("",!0)])):wn("",!0),M("div",KB,[F[13]||(F[13]=M("span",{class:"text-xs font-medium text-gray-500 mb-1"},"Type de carte",-1)),M("div",JB,[(Ye(),tt(zn,null,Ti(h,(G,me)=>M("button",{key:me,class:Jr(["px-2 py-1 text-xs rounded border",{"bg-blue-50 border-blue-200 text-blue-700":me===r.value}]),onClick:Se=>v(me)},Ht(G),11,YB)),64))])]),M("div",{class:"flex flex-col"},[F[16]||(F[16]=M("span",{class:"text-xs font-medium text-gray-500 mb-1"},"Outils de plan",-1)),M("div",{class:"grid grid-cols-2 gap-1"},[M("button",{onClick:x,class:"px-2 py-1 text-xs rounded border flex items-center justify-center"},F[14]||(F[14]=[M("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{"fill-rule":"evenodd",d:"M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z","clip-rule":"evenodd"}),M("path",{d:"M10 9a1 1 0 011-1h5a1 1 0 110 2h-5a1 1 0 01-1-1z"}),M("path",{"fill-rule":"evenodd",d:"M13 5a1 1 0 011 1v4a1 1 0 11-2 0V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),Br(" Charger ")])),M("button",{onClick:D,class:"px-2 py-1 text-xs rounded border flex items-center justify-center"},F[15]||(F[15]=[M("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{"fill-rule":"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})],-1),Br(" Synthèse ")]))])]),M("div",{class:Jr(["text-xs text-center pt-1 border-t flex items-center justify-center space-x-1",{"text-gray-500":!Q.saveStatus,"text-primary-600 font-medium":Q.saveStatus==="success","text-blue-600 font-medium":Q.saveStatus==="saving"}])},[Q.saveStatus==="saving"?(Ye(),tt("svg",XB,F[17]||(F[17]=[M("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),M("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):wn("",!0),Q.saveStatus==="success"?(Ye(),tt("svg",QB,F[18]||(F[18]=[M("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):wn("",!0),Yr(ov,{name:"fade-slide",mode:"out-in"},{default:vc(()=>[Q.saveStatus==="saving"?(Ye(),tt("span",e7," Sauvegarde en cours... ")):Q.saveStatus==="success"?(Ye(),tt("span",t7," Sauvegarde réussie ! ")):(Ye(),tt("span",n7," Dernière modification : "+Ht(g.value),1))]),_:1})],2)])])):wn("",!0)])]))}}),r7=bm(i7,[["__scopeId","data-v-206c3e68"]]),mp=(e,n)=>{if(!e||typeof e!="string"||!e.startsWith("#"))return`rgba(0, 0, 0, ${n})`;const t=parseInt(e.slice(1,3),16),i=parseInt(e.slice(3,5),16),r=parseInt(e.slice(5,7),16);return`rgba(${t}, ${i}, ${r}, ${n})`},Py=(e,n)=>{e.style.fontSize=n.fontSize,e.style.color=n.color,e.style.backgroundColor=mp(n.backgroundColor,n.backgroundOpacity),n.hasBorder?e.style.border=`${n.borderWidth} solid ${mp(n.borderColor,n.borderOpacity)}`:e.style.border="none",e.style.padding=n.padding,e.style.borderRadius=n.borderRadius},Uo=e=>{document.querySelectorAll(".drawing-help-message").forEach(i=>i.remove());const t=wt.DomUtil.create("div","drawing-help-message");return t.innerHTML=e,t.style.cssText=`
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 8px 16px;
    border-radius: 4px;
    font-size: 14px;
    z-index: 2000;
    pointer-events: none;
    text-align: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  `,document.body.appendChild(t),t};function Ey(e,n,t){const i=156543.03392*Math.cos(n*Math.PI/180)/Math.pow(2,t);return e/i}const qi=(e,n="m",t="")=>{let i,r;return n==="m²"?e>=1e4?(i=(e/1e4).toFixed(2),r="ha"):(i=e.toFixed(2),r="m²"):n==="m"?e>=1e3?(i=(e/1e3).toFixed(2),r="km"):(i=e.toFixed(2),r="m"):(i=e.toFixed(2),r=n),t?`${t}: ${i} ${r}`:`${i} ${r}`},s7=e=>({...e,clientX:e.clientX,clientY:e.clientY,button:e.button||0,buttons:e.buttons||0,altKey:e.altKey||!1}),o7=(e,n)=>{let t;return function(...i){window.clearTimeout(t),t=window.setTimeout(()=>e.apply(this,i),n)}},Hu=(e,n)=>{let t=0;return function(...i){const r=Date.now();if(!(r-t<n))return t=r,e.apply(this,i)}};function a7(){const e=un(null),n=un(null),t=un(null),i=un(null),r=un(""),o=un(null),l=un(!1),h=un(null);window.addEventListener("clearControlPoints",()=>{o.value=null,t.value&&t.value.clearLayers(),i.value&&i.value.clearLayers(),document.querySelectorAll(".measure-tooltip").forEach(B=>B.remove()),document.querySelectorAll(".drawing-help-message").forEach(B=>B.remove())}),Kh(()=>{window.removeEventListener("clearControlPoints",()=>{}),e.value&&(e.value.remove(),e.value=null)});const g=(B,H="Double-cliquez pour éditer")=>{const he={fontSize:"14px",color:"#000000",backgroundColor:"#FFFFFF",backgroundOpacity:1,borderColor:"#000000",borderWidth:"1px",borderOpacity:1,padding:"5px 10px",borderRadius:"3px",hasBorder:!0,rotation:0,physicalSize:2},te=(Re,Ae)=>{var Je;const qe=((Je=e.value)==null?void 0:Je.getZoom())||14,Oe=B.lat,et=Ey(Ae.physicalSize,Oe,qe);return`<div class="text-container" style="width:${et}px;height:${et}px;transform:rotate(${Ae.rotation}deg)">
        <div class="text-annotation" style="font-size:${et*.2}px;color:${Ae.color};background-color:${mp(Ae.backgroundColor,Ae.backgroundOpacity)};border:${Ae.hasBorder?Ae.borderWidth+" solid "+mp(Ae.borderColor,Ae.borderOpacity):"none"};padding:${Ae.padding};border-radius:${Ae.borderRadius}">${Re}</div>
        <div class="text-controls"><div class="control-button rotate"></div><div class="control-button move"></div></div>
      </div>`},ie=()=>{if(!e.value)return;const Re=se.getIcon(),Ae={html:te(se.properties.text,se.properties.style),className:Re.options.className};se.setIcon(wt.divIcon(Ae))},ee=wt.divIcon({html:te(H,he),className:"text-container",iconSize:[40,40],iconAnchor:[20,20]}),se=wt.marker(B,{icon:ee,draggable:!1,pmIgnore:!0});se.properties={type:"text",text:H,style:{...he}},e.value&&(e.value.on("zoomend",ie),se.on("remove",()=>{var Re;(Re=e.value)==null||Re.off("zoomend",ie)})),ie();let Ce=!1,ne=!1,ae=0,xe=0;const ye=Re=>{if(!e.value)return;const Ae=Re.target;if(Ae.classList.contains("rotate")){Ce=!0;const qe=se.getLatLng(),Oe=e.value.mouseEventToLatLng(Re);ae=Math.atan2(Oe.lat-qe.lat,Oe.lng-qe.lng)*180/Math.PI,xe=se.properties.style.rotation||0}else Ae.classList.contains("move")&&(ne=!0);document.addEventListener("mousemove",le),document.addEventListener("mouseup",je)},le=Re=>{if(!(!ne||!e.value)){if(Ce){const Ae=se.getLatLng(),qe=e.value.mouseEventToLatLng(Re),Oe=Math.atan2(qe.lat-Ae.lat,qe.lng-Ae.lng)*180/Math.PI,et=(xe+(Oe-ae))%360;se.properties.style.rotation=et;const Je=se.getIcon(),mt={html:te(se.properties.text,se.properties.style),className:Je.options.className};se.setIcon(wt.divIcon(mt))}else if(ne){const Ae=s7(Re),qe=e.value.mouseEventToLatLng(Ae);se.setLatLng(qe)}}},je=()=>{Ce=!1,ne=!1,document.removeEventListener("mousemove",le),document.removeEventListener("mouseup",je)};return se.on("add",()=>{const Re=se.getElement();Re&&Re.querySelectorAll(".control-button").forEach(qe=>{qe.addEventListener("mousedown",ye)})}),se.on("remove",()=>{const Re=se.getElement();Re&&Re.querySelectorAll(".control-button").forEach(qe=>{qe.removeEventListener("mousedown",ye)})}),se.on("dblclick",Re=>{var mt;wt.DomEvent.stopPropagation(Re);const Ae=(mt=se.getElement())==null?void 0:mt.querySelector(".text-annotation");if(!Ae)return;Ae.contentEditable="true",Ae.focus(),Ae.classList.add("editing");const qe=window.getSelection(),Oe=document.createRange();Oe.selectNodeContents(Ae),qe==null||qe.removeAllRanges(),qe==null||qe.addRange(Oe);const et=()=>{Ae.contentEditable="false",Ae.classList.remove("editing");const _t=Ae.innerText.trim();if(_t){se.properties.text=_t;const $t=se.getIcon(),Xt={html:te(_t,se.properties.style),className:$t.options.className};se.setIcon(wt.divIcon(Xt))}Ae.removeEventListener("blur",et),Ae.removeEventListener("keydown",Je)},Je=_t=>{_t.key==="Enter"&&!_t.shiftKey&&(_t.preventDefault(),et())};Ae.addEventListener("blur",et),Ae.addEventListener("keydown",Je)}),se},v=(B,H)=>{const he=wt.DomUtil.create("div","measure-tooltip");if(he.innerHTML=H,he.style.cssText=`
      position: fixed;
      background-color: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      z-index: 2000;
      pointer-events: none;
      white-space: pre-line;
    `,document.body.appendChild(he),e.value){const te=e.value.latLngToContainerPoint(B);he.style.left=`${te.x+10}px`,he.style.top=`${te.y-25}px`}return he},_=Hu((B,H,he)=>{if(B&&(B.innerHTML=he,e.value)){const te=e.value.latLngToContainerPoint(H);B.style.left=`${te.x+10}px`,B.style.top=`${te.y-25}px`}},100),x=(B,H,he)=>{B.on("mouseover",()=>{const te=v(B.getLatLng(),he());B.measureDiv=te}),B.on("mousemove",te=>{B.measureDiv&&e.value&&_(B.measureDiv,te.latlng,he())}),B.on("mouseout",()=>{B.measureDiv&&(B.measureDiv.remove(),B.measureDiv=void 0)})};let E=[];const b=()=>{var B;E.cleanup&&E.cleanup(),t.value&&t.value.clearLayers(),E=[],(B=i.value)==null||B.clearLayers(),document.querySelectorAll(".measure-tooltip").forEach(H=>H.remove()),n.value&&n.value.getLayers().forEach(H=>{H instanceof $o&&H.clearHelperPoints()})},D=(B,H="#2563EB")=>{const he=wt.circleMarker(B,{radius:6,color:H,fillColor:H,fillOpacity:1,weight:2,className:"control-point",pmIgnore:!0});return t.value&&t.value.addLayer(he),he},$=(B,H)=>{var te,ie,ee,se,Ce,ne,ae,xe,ye,le,je,Re,Ae,qe;console.log("Input layer:",{type:H,instanceof:{Circle:B instanceof wt.Circle,Rectangle:B instanceof wt.Rectangle,Polygon:B instanceof wt.Polygon,Polyline:B instanceof wt.Polyline,CircleArc:B instanceof wu,TextRectangle:B instanceof yu,ElevationLine:B instanceof lh,Line:B instanceof Lo,CircleWithSections:((te=B.properties)==null?void 0:te.type)==="CircleWithSections"},options:B.options});const he={type:H,style:B.options||{}};try{if(B instanceof yu)return B.properties;if(((ie=B.properties)==null?void 0:ie.type)==="CircleWithSections"){const Oe=B.properties;return{...Oe,type:"CircleWithSections",style:{...Oe.style,color:((ee=B.options)==null?void 0:ee.color)||"#3388ff",weight:((se=B.options)==null?void 0:se.weight)||3,opacity:((Ce=B.options)==null?void 0:Ce.opacity)||1,fillColor:((ne=B.options)==null?void 0:ne.fillColor)||"#3388ff",fillOpacity:((ae=B.options)==null?void 0:ae.fillOpacity)||.2,dashArray:((xe=B.options)==null?void 0:xe.dashArray)||""}}}else if(B instanceof wt.Circle){const Oe=B.getRadius();he.radius=Oe,he.diameter=Oe*2,he.surface=Math.PI*Math.pow(Oe,2),he.perimeter=2*Math.PI*Oe,he.center=B.getLatLng()}else if(B instanceof wu){const Oe=B.getRadius?B.getRadius():0,et=B.getCenter?B.getCenter():{lat:0,lng:0},Je=B.getStartAngle?B.getStartAngle():0,mt=B.getStopAngle?B.getStopAngle():180,_t=(mt-Je+360)%360;he.radius=Oe,he.diameter=Oe*2,he.surface=Math.PI*Math.pow(Oe,2)*_t/360,he.arcLength=2*Math.PI*Oe*_t/360,he.perimeter=he.arcLength+2*Oe,he.center=et,he.startAngle=Je,he.stopAngle=mt,he.openingAngle=_t}else if(B instanceof wt.Rectangle){const Oe=B.getBounds(),et=Oe.getNorthEast(),Je=Oe.getSouthWest(),mt=Pl([[Je.lng,Je.lat],[et.lng,Je.lat]]),_t=Pl([[Je.lng,Je.lat],[Je.lng,et.lat]]),$t=Vc(mt,{units:"meters"}),Xt=Vc(_t,{units:"meters"});he.width=$t,he.height=Xt,he.surface=$t*Xt,he.perimeter=2*($t+Xt),he.dimensions={width:$t,height:Xt}}else if(B instanceof wt.Polygon)try{const et=B.getLatLngs()[0].map(mt=>[mt.lng,mt.lat]);et.push(et[0]);const Je=Sl([et]);he.surface=pu(Je),he.perimeter=Vc(Pl(et),{units:"meters"})}catch(Oe){console.error("Erreur lors du calcul des propriétés du polygone",Oe)}else if(B instanceof wt.Polyline&&!(B instanceof wt.Polygon))try{const Oe=B.getLatLngs();let et=0;for(let Je=1;Je<Oe.length;Je++)et+=Oe[Je].distanceTo(Oe[Je-1]);he.length=et}catch(Oe){console.error("Erreur lors du calcul de la longueur de la ligne",Oe)}he.style={...he.style,color:((ye=B.options)==null?void 0:ye.color)||"#3388ff",weight:((le=B.options)==null?void 0:le.weight)||3,opacity:((je=B.options)==null?void 0:je.opacity)||1,fillColor:((Re=B.options)==null?void 0:Re.fillColor)||"#3388ff",fillOpacity:((Ae=B.options)==null?void 0:Ae.fillOpacity)||.2,dashArray:((qe=B.options)==null?void 0:qe.dashArray)||""}}catch(Oe){console.error("Error calculating shape properties:",Oe)}return he},Q=(B,H=2)=>{var se;if(!e.value){console.warn("Map is not available for text size update");return}const he=e.value.getZoom(),te=B.getLatLng().lat,ie=Ey(H,te,he),ee=(se=B.getElement())==null?void 0:se.querySelector(".text-annotation");ee&&(B.properties.style.fontSize=`${ie}px`,B.properties.physicalWidth=H,B.properties.physicalHeight=H,Py(ee,B.properties.style))},F=(B,H,he)=>{const te=wt.map(B).setView(H,he);e.value=te,wt.tileLayer("/osm_tiles/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:5}).addTo(te);const ie=new wt.FeatureGroup;return ie.addTo(te),n.value=ie,t.value=wt.featureGroup().addTo(te),i.value=wt.featureGroup().addTo(te),te.pm.setGlobalOptions({snappable:!0,snapDistance:20,allowSelfIntersection:!1,preventMarkerRemoval:!0,syncLayersOnDrag:!0,layerGroup:ie,snapLayers:[ie,i.value],templineStyle:{color:"#3388ff",weight:2,opacity:.7,dashArray:"6,6",radius:6},hintlineStyle:{color:"#3388ff",weight:2,opacity:.7,dashArray:"6,6",radius:6}}),te.on("pm:drawstart",ee=>{l.value=!0,ee.shape==="Circle"&&r.value==="Semicircle"&&(te.getContainer().style.cursor="crosshair")}),te.on("pm:drawend",()=>{l.value=!1,te.getContainer().style.cursor="",o.value&&Uo("Cliquez sur la forme pour afficher les points de contrôle")}),te.on("pm:create",X),ie.on("click",ee=>{var Ce,ne,ae,xe,ye,le,je,Re,Ae,qe,Oe,et,Je,mt,_t,$t,Xt,Xe,Kt;wt.DomEvent.stopPropagation(ee);const se=ee.layer;if(se.name&&!((Ce=se.properties)!=null&&Ce.name)?(se.properties||(se.properties={}),se.properties.name=se.name):(ne=se.properties)!=null&&ne.name&&!se.name&&(se.name=se.properties.name),console.log("[featureGroup click] État du nom:",{directName:se.name,propertiesName:(ae=se.properties)==null?void 0:ae.name,fullProperties:se.properties}),(xe=i.value)==null||xe.clearLayers(),b(),o.value=se,se instanceof yu){console.log("[featureGroup click] TextRectangle sélectionné",{id:se._leaflet_id,bounds:se.getBounds(),hasTextContainer:!!se.getTextElement(),properties:se.properties}),(ye=e.value)!=null&&ye.pm.globalEditModeEnabled()&&e.value.pm.disableGlobalEditMode(),U(se),Uo("Double-cliquez pour éditer le texte. Utilisez les points rouges pour redimensionner.");return}if(se instanceof eh||((le=se.properties)==null?void 0:le.type)==="CircleWithSections"){console.log("[featureGroup click] CircleWithSections sélectionné",{id:se._leaflet_id,properties:se.properties,sections:(je=se.properties)==null?void 0:je.sections}),W(se),Uo("Utilisez les points de contrôle verts pour manipuler le cercle. Configurez les sections dans le panneau latéral.");return}if(se instanceof wu||((Re=se.properties)==null?void 0:Re.type)==="Semicircle")J(se);else if(se instanceof Zc)W(se);else if(se instanceof wt.Circle){console.log("[useMapDrawing] Création du cercle personnalisé:",{propertyDescriptor:Object.getOwnPropertyDescriptor(se,"name"),directName:se.name,propertiesName:(Ae=se.properties)==null?void 0:Ae.name,styleNameBeforeTransfer:(Oe=(qe=se.properties)==null?void 0:qe.style)==null?void 0:Oe.name,nameIsEnumerable:Object.keys(se).includes("name"),allProperties:Object.keys(se.properties||{}),_dbId:se._dbId});const Qt=se.name,Qe=(et=se.properties)==null?void 0:et.name,We=(mt=(Je=se.properties)==null?void 0:Je.style)==null?void 0:mt.name,Ut=se._dbId,pn=new Zc(se.getLatLng(),{...se.options,radius:se.getRadius()});se.properties?pn.properties={...se.properties||{}}:pn.updateProperties();const _n=Qt||Qe||We;_n&&(pn.properties.name=_n,pn.properties.style||(pn.properties.style={}),pn.properties.style.name=_n,pn.name=_n),Ut&&(pn._dbId=Ut),console.log("[useMapDrawing] Cercle après conversion:",{name:pn.name,propertiesName:pn.properties.name,stylePropertyName:(_t=pn.properties.style)==null?void 0:_t.name,allProperties:Object.keys(pn.properties||{})}),($t=n.value)==null||$t.removeLayer(se),(Xt=n.value)==null||Xt.addLayer(pn),o.value=pn,W(pn)}else if(se instanceof $o)ue(se);else if(se instanceof wt.Rectangle){const Qt=new $o(se.getBounds(),{...se.options});Qt.updateProperties(),(Xe=n.value)==null||Xe.removeLayer(se),(Kt=n.value)==null||Kt.addLayer(Qt),o.value=Qt,ue(Qt)}else se instanceof wt.Polygon?R(se):(se instanceof Lo||se instanceof wt.Polyline)&&z(se)}),te.on("pm:edit",ee=>{var Ce,ne,ae;console.log("[pm:edit] Début",{layer:ee.layer,currentProperties:ee.layer.properties});const se=ee.layer;if(se){const xe=((Ce=se.properties)==null?void 0:Ce.type)||"unknown";if(Ve(se,xe),console.log("[pm:edit] Après updateLayerProperties",{updatedProperties:se.properties,selectedShape:o.value}),xe==="Semicircle")J(se);else if(se instanceof Zc)W(se);else if(se instanceof $o)ue(se);else if(se instanceof wt.Rectangle){const ye=new $o(se.getBounds(),{...se.options});ye.updateProperties(),(ne=n.value)==null||ne.removeLayer(se),(ae=n.value)==null||ae.addLayer(ye),o.value=ye,ue(ye)}else se instanceof wt.Polygon?R(se):se instanceof Lo?(se.updateProperties(),Ve(se,"Line"),z(se)):se instanceof wt.Polyline&&z(se)}}),te.on("pm:dragstart",()=>{document.querySelectorAll(".drawing-help-message").forEach(ee=>ee.remove()),Uo("Déplacez la forme à l'endroit souhaité")}),te.on("pm:dragend",ee=>{var Ce,ne,ae;console.log("[pm:dragend] Début",{layer:ee.layer,currentProperties:ee.layer.properties});const se=ee.layer;if(se){const xe=((Ce=se.properties)==null?void 0:Ce.type)||"unknown";if(se instanceof wt.Rectangle&&!(se instanceof $o)){const ye=new $o(se.getBounds(),{...se.options});ye.updateProperties(),(ne=n.value)==null||ne.removeLayer(se),(ae=n.value)==null||ae.addLayer(ye),o.value=ye,ue(ye)}else se instanceof Lo?(se.updateProperties(),Ve(se,"Line"),z(se)):Ve(se,xe);console.log("[pm:dragend] Après updateLayerProperties",{updatedProperties:se.properties,selectedShape:o.value})}setTimeout(()=>{Uo("Cliquez sur la forme pour afficher les points de contrôle")},100)}),te.on("pm:remove",()=>{var ee;(ee=document.querySelector(".drawing-help-message"))==null||ee.remove()}),te.on("pm:select",ee=>{var Ce;const se=ee.layer;document.querySelectorAll(".drawing-help-message").forEach(ne=>ne.remove()),se instanceof wu||((Ce=se.properties)==null?void 0:Ce.type)==="Semicircle"?Uo(`Points de contrôle : <span style="color: #059669">●</span> Ajuster le rayon, <span style="color: #2563EB">●</span> et <span style="color: #DC2626">●</span> Modifier l'ouverture du demi-cercle`):Uo("Utilisez les points de contrôle pour modifier la forme")}),te.on("pm:unselect",()=>{document.querySelectorAll(".drawing-help-message").forEach(ee=>ee.remove())}),te.on("zoomstart",()=>{o.value&&(b(),o.value=null,document.querySelectorAll(".drawing-help-message").forEach(ee=>ee.remove()))}),te},G=()=>{if(!(!e.value||!n.value||!n.value.getLayers().length))try{const B=n.value.getBounds();if(B.isValid()){const H={zoomAnimation:e.value.options.zoomAnimation,fadeAnimation:e.value.options.fadeAnimation,markerZoomAnimation:e.value.options.markerZoomAnimation};e.value.options.zoomAnimation=!1,e.value.options.fadeAnimation=!1,e.value.options.markerZoomAnimation=!1,e.value.fitBounds(B,{padding:[50,50],maxZoom:18,animate:!1,duration:0,noMoveStart:!0}),e.value.invalidateSize({animate:!1,pan:!1}),setTimeout(()=>{try{e.value.options.fadeAnimation=H.fadeAnimation,setTimeout(()=>{try{e.value.options.zoomAnimation=H.zoomAnimation,e.value.options.markerZoomAnimation=H.markerZoomAnimation}catch(he){console.warn("[useMapDrawing] Erreur lors de la restauration des animations:",he)}},500)}catch(he){console.warn("[useMapDrawing] Erreur lors de la restauration des animations:",he)}},500)}}catch(B){if(console.warn("[useMapDrawing] Error adjusting view:",B),e.value)try{e.value.options.zoomAnimation=!0,e.value.options.fadeAnimation=!0,e.value.options.markerZoomAnimation=!0,e.value.invalidateSize({animate:!1,pan:!1})}catch(H){console.error("[useMapDrawing] Erreur lors de la restauration après échec:",H)}}},me=B=>{var H;if(e.value){document.querySelectorAll(".drawing-help-message").forEach(he=>he.remove());try{const he=e.value.pm;he.globalEditModeEnabled()&&he.disableGlobalEditMode(),he.globalRemovalModeEnabled()&&he.disableGlobalRemovalMode(),he.disableDraw(),b(),(H=i.value)==null||H.clearLayers()}catch(he){console.error("Error disabling modes:",he)}if(r.value=B,!B){b();return}Ee(),setTimeout(()=>{var he,te,ie,ee,se,Ce,ne,ae,xe,ye,le,je;try{switch(B){case"Circle":case"Semicircle":n.value&&n.value.getLayers().filter(qe=>qe instanceof $o).forEach(qe=>{qe.toggleHelperPoints(e.value,!0,"#DC2626","#2563EB")}),e.value.pm.setGlobalOptions({snapDistance:15,snapSegment:!0,snapVertices:!0,snapLayers:[n.value,i.value],snapMiddle:!0,snapIntersections:!0});let Re="Positionnez le centre du cercle. Points bleus : milieu des côtés, Points rouges : sommets, Point vert : centre";B==="Semicircle"&&(Re="Positionnez le centre du demi-cercle. Points bleus : milieu des côtés, Points rouges : sommets, Point vert : centre"),Uo(Re),e.value.pm.enableDraw("Circle",{finishOn:"mouseup",continueDrawing:!1});break;case"CircleWithSections":n.value&&n.value.getLayers().filter(qe=>qe instanceof $o).forEach(qe=>{qe.toggleHelperPoints(e.value,!0,"#DC2626","#2563EB")}),e.value.pm.setGlobalOptions({snapDistance:15,snapSegment:!0,snapVertices:!0,snapLayers:[n.value,i.value],snapMiddle:!0,snapIntersections:!0}),Uo("Positionnez le centre du cercle d'irrigation. Vous pourrez ajouter des sections après sa création."),e.value.pm.enableDraw("Circle",{finishOn:"mouseup",continueDrawing:!1}),e.value.off("pm:create"),e.value.on("pm:create",Ae=>{var qe,Oe,et;if(Ae.shape==="Circle"&&Ae.layer&&r.value==="CircleWithSections"){const Je=Ae.layer,mt=Je.getLatLng(),_t=Je.getRadius();(qe=e.value)==null||qe.removeLayer(Je),(Oe=n.value)!=null&&Oe.hasLayer(Je)&&n.value.removeLayer(Je);const $t=new eh(mt,{radius:_t,color:"#3B82F6",weight:2,fillColor:"#3B82F6",fillOpacity:.2,name:"Cercle d'irrigation"});n.value&&(n.value.addLayer($t),o.value=$t,$t.updateProperties(),console.log("[CircleWithSections] Nouveau cercle avec sections créé",{center:mt,radius:_t,properties:$t.properties}),$t.addSection({startAngle:0,endAngle:90,radius:_t>=20?_t-20:_t,name:"Section 1"})),(et=e.value)==null||et.pm.disableDraw(),Ee()}});break;case"Rectangle":Uo("Cliquez et maintenez pour dessiner un rectangle, relâchez pour terminer"),(he=e.value)==null||he.pm.enableDraw("Rectangle",{finishOn:"mouseup"});break;case"Polygon":Uo("Cliquez pour ajouter des points, double-cliquez pour terminer le polygone"),(te=e.value)==null||te.pm.enableDraw("Polygon",{finishOn:"dblclick",continueDrawing:!1,snapMiddle:!0,snapDistance:20});break;case"Line":Uo("Cliquez pour ajouter des points, double-cliquez pour terminer la ligne"),(ie=e.value)==null||ie.pm.enableDraw("Line",{finishOn:"dblclick",continueDrawing:!1,snapMiddle:!0,snapDistance:20});break;case"Text":if(Uo("Cliquez pour ajouter du texte, double-cliquez pour éditer"),e.value){const Ae=qe=>{if(!e.value||!n.value)return;const Oe=g(qe.latlng);n.value.addLayer(Oe),o.value=Oe,e.value.off("click",Ae),me("")};e.value.on("click",Ae)}break;case"delete":Uo("Cliquez sur une forme pour la supprimer"),(ee=e.value)==null||ee.pm.enableGlobalRemovalMode();break;case"TextRectangle":Uo("Cliquez et maintenez pour dessiner un rectangle avec texte, relâchez pour terminer"),(se=e.value)!=null&&se.pm.globalEditModeEnabled()&&e.value.pm.disableGlobalEditMode(),(Ce=e.value)==null||Ce.pm.enableDraw("Rectangle",{finishOn:"mouseup",continueDrawing:!1,templineStyle:{color:"#3B82F6",weight:2,dashArray:"5,5"}}),(ne=e.value)==null||ne.off("pm:create"),(ae=e.value)==null||ae.on("pm:create",Ae=>{var qe,Oe,et;if(Ae.shape==="Rectangle"&&Ae.layer){const Je=Ae.layer.getBounds();let mt=!1;if(n.value&&n.value.eachLayer(_t=>{if(_t instanceof yu){const $t=_t.getBounds(),Xt=1e-8;Math.abs($t.getNorth()-Je.getNorth())<Xt&&Math.abs($t.getSouth()-Je.getSouth())<Xt&&Math.abs($t.getEast()-Je.getEast())<Xt&&Math.abs($t.getWest()-Je.getWest())<Xt&&(mt=!0,o.value=_t,console.log("[TextRectangle] Rectangle existant trouvé, sélection au lieu de création"))}}),!mt){(qe=e.value)==null||qe.removeLayer(Ae.layer),(Oe=n.value)!=null&&Oe.hasLayer(Ae.layer)&&n.value.removeLayer(Ae.layer);const _t=new yu(Je,"Double-cliquez pour éditer",{color:"#3B82F6",weight:2,fillColor:"#F9FAFB",fillOpacity:.8,textColor:"#000000",fontFamily:"Arial, sans-serif",textAlign:"center",bold:!1,italic:!1});n.value&&(n.value.addLayer(_t),o.value=_t,_t.updateProperties(),U(_t),console.log("[TextRectangle] Nouveau rectangle créé avec succès",{bounds:_t.getBounds(),properties:_t.properties,style:_t.properties.style}))}(et=e.value)==null||et.pm.disableDraw(),Ee()}});break;case"ElevationLine":Uo("Cliquez et maintenez pour tracer le profil altimétrique"),(xe=e.value)==null||xe.pm.enableDraw("Line",{finishOn:"mouseup",continueDrawing:!1,allowSelfIntersection:!1,templineStyle:{color:"#FF4500",weight:4,opacity:.8}}),(ye=e.value)==null||ye.pm.setGlobalOptions({continueDrawing:!1,finishOn:"mouseup",preventMarkerRemoval:!0,preventVertexEdit:!0,preventMarkerEdit:!0}),(le=e.value)==null||le.off("pm:create"),(je=e.value)==null||je.on("pm:create",async Ae=>{var qe,Oe,et;if(Ae.shape==="Line"&&Ae.layer){const Je=Ae.layer.getLatLngs();(qe=e.value)==null||qe.removeLayer(Ae.layer),(Oe=n.value)!=null&&Oe.hasLayer(Ae.layer)&&n.value.removeLayer(Ae.layer);const mt=new lh(Je,{color:"#FF4500",weight:4,opacity:.8,interactive:!1,pmIgnore:!0});if(n.value){n.value.addLayer(mt),o.value=mt,await mt.updateElevationProfile();const _t=$(mt,"ElevationLine");Object.assign(mt.properties,{..._t,...mt.properties,type:"ElevationLine",elevationData:mt.getElevationData()}),o.value=null,Ds(()=>{o.value=mt})}(et=e.value)==null||et.pm.disableDraw(),r.value="",Ee()}});break}}catch(Re){console.error("[setDrawingTool] Erreur lors de la configuration de l'outil:",Re)}},100)}},Se=B=>{var he;if(!o.value)return;const H=o.value;if(H.properties=H.properties||{},H.properties.style=H.properties.style||{},H.properties.style={...H.properties.style,...B},H.properties.type==="text"){const te=H.properties._textLayer,ie=(he=te==null?void 0:te.getElement())==null?void 0:he.querySelector(".text-annotation");ie&&Py(ie,H.properties.style);const ee={color:B.borderColor||H.properties.style.borderColor,weight:parseInt(B.borderWidth||H.properties.style.borderWidth),opacity:B.borderOpacity??H.properties.style.borderOpacity};"setStyle"in H&&H.setStyle(ee)}else if(H.properties.type==="TextRectangle"){if(H instanceof yu){console.log("[updateShapeStyle] Processing TextRectangle style update",{incoming:B,currentStyle:H.properties.style,hasTextStyle:!!H.properties.style.textStyle,textStyleIncoming:B.textStyle});let te={};B.textStyle?(console.log("[updateShapeStyle] Using nested textStyle object",B.textStyle),te={...B.textStyle}):(B.textColor!==void 0&&(te.color=B.textColor),B.fontSize!==void 0&&(te.fontSize=B.fontSize,console.log(`[updateShapeStyle] Setting fontSize to ${B.fontSize}`)),B.fontFamily!==void 0&&(te.fontFamily=B.fontFamily),B.backgroundColor!==void 0&&(te.backgroundColor=B.backgroundColor),B.backgroundOpacity!==void 0&&(te.backgroundOpacity=B.backgroundOpacity),B.textAlign!==void 0&&(te.textAlign=B.textAlign),B.bold!==void 0&&(te.bold=B.bold),B.italic!==void 0&&(te.italic=B.italic)),B.fillColor&&(te.fillColor=B.fillColor),B.fillOpacity!==void 0&&(te.fillOpacity=B.fillOpacity),B.strokeColor&&(te.color=B.strokeColor),B.color&&(te.color=B.color),B.strokeOpacity!==void 0&&(te.opacity=B.strokeOpacity),B.strokeWidth!==void 0&&(te.weight=B.strokeWidth),B.weight!==void 0&&(te.weight=B.weight),B.dashArray&&(te.dashArray=B.dashArray),console.log("[updateShapeStyle] Final textStyles being applied:",te),H.setTextStyle(te)}}else{const te={};B.fillColor&&(te.fillColor=B.fillColor),B.fillOpacity!==void 0&&(te.fillOpacity=B.fillOpacity),B.strokeColor&&(te.color=B.strokeColor),B.strokeOpacity!==void 0&&(te.opacity=B.strokeOpacity),B.strokeWidth!==void 0&&(te.weight=B.strokeWidth),B.dashArray&&(te.dashArray=B.dashArray),"setStyle"in H&&H.setStyle(te)}},Ie=B=>{var he,te,ie,ee;if(!o.value){console.warn("[useMapDrawing] Cannot update properties: no shape selected");return}if(console.log("[useMapDrawing] Updating shape properties",{before:o.value.properties,newProps:B,layerType:(he=o.value.properties)==null?void 0:he.type,beforeName:o.value.name,beforePropertiesName:(te=o.value.properties)==null?void 0:te.name,nameIsDirectProperty:"name"in o.value}),o.value.properties&&Object.keys(B).forEach(se=>{o.value.properties[se]=B[se],se==="name"&&(console.log(`[useMapDrawing] Setting name "${B[se]}" directly on layer`),o.value.name=B[se])}),console.log("[useMapDrawing] Updated shape properties",{after:o.value.properties,name:o.value.name,propertiesName:(ie=o.value.properties)==null?void 0:ie.name,allLayerKeys:Object.keys(o.value),allPropertiesKeys:Object.keys(o.value.properties||{})}),((ee=o.value.properties)==null?void 0:ee.type)==="Circle"){const se=o.value,Ce=se.getRadius();se.properties.radius=Ce,se.properties.diameter=Ce*2,se.properties.surface=Math.PI*Ce*Ce,se.properties.perimeter=2*Math.PI*Ce,B.name&&(console.log(`[useMapDrawing] Ensuring circle name "${B.name}" is set in multiple places`),se.properties.name=B.name,se.properties.style.name=B.name,se.name=B.name,console.log("[useMapDrawing] Circle name verification:",{circleDirectName:se.name,circlePropertiesName:se.properties.name,nameIsEnumerable:Object.keys(se).includes("name"),propertiesNameIsEnumerable:Object.keys(se.properties).includes("name")}))}const H=new CustomEvent("shape:propertiesUpdated",{detail:{shape:o.value,properties:o.value.properties}});window.dispatchEvent(H)},nt=B=>{console.log("[forceShapeUpdate] Début",{currentProperties:B.properties,selectedShapeRef:o.value}),o.value=null,Ds(()=>{o.value=B,console.log("[forceShapeUpdate] Après mise à jour",{selectedShape:o.value,properties:o.value.properties})})},Ve=(B,H)=>{console.log("[updateLayerProperties] Début",{layer:B,shapeType:H,currentProperties:B.properties}),o7((te,ie)=>{const ee=$(te,ie);console.log("[updateLayerProperties] Nouvelles propriétés calculées",{newProperties:ee}),te.properties={...ee},nt(te),te.fire("properties:updated",{shape:te,properties:te.properties}),console.log("[updateLayerProperties] Fin",{finalProperties:te.properties,selectedShape:o.value})},100)(B,H)},O=(B,H)=>wt.latLng((B.lat+H.lat)/2,(B.lng+H.lng)/2),W=B=>{var Ce;if(!e.value||!n.value)return;b();const H=B.getLatLng(),he=B.getRadius(),te=B instanceof eh||((Ce=B.properties)==null?void 0:Ce.type)==="CircleWithSections",ie=D(H,"#059669");E.push(ie),x(ie,B,()=>[qi(he,"m","Rayon"),qi(he*2,"m","Diamètre"),qi(Math.PI*Math.pow(he,2),"m²","Surface")].join("<br>"));const ee=[],se=[0,45,90,135,180,225,270,315];se.forEach(ne=>{const ae=B.calculatePointOnCircle(ne),xe=D(ae,"#2563EB");ee.push(xe),E.push(xe),x(xe,B,()=>qi(he,"m","Rayon")),xe.on("mousedown",ye=>{if(!e.value)return;wt.DomEvent.stopPropagation(ye),e.value.dragging.disable();let le=!0;te&&B._clearSections();const je=Ae=>{le&&(B.resizeFromControlPoint(Ae.latlng),ee.forEach((qe,Oe)=>{const et=B.calculatePointOnCircle(se[Oe]);qe.setLatLng(et)}),ie.setLatLng(B.getLatLng()),xe.measureDiv&&(xe.measureDiv.innerHTML=qi(B.getRadius(),"m","Rayon")))},Re=()=>{le=!1,e.value&&(e.value.off("mousemove",je),document.removeEventListener("mouseup",Re),e.value.dragging.enable(),B.updateProperties(),te&&B._initSections&&setTimeout(()=>{B._initSections()},100),o.value=null,Ds(()=>{o.value=B}),Ve(B,"Circle"))};e.value.on("mousemove",je),document.addEventListener("mouseup",Re)})}),ie.on("mousedown",ne=>{if(!e.value)return;wt.DomEvent.stopPropagation(ne),e.value.dragging.disable();let ae=!0;const xe=B.getLatLng(),ye=ne.latlng;te&&B._clearSections();const le=Re=>{if(!ae)return;const Ae=Re.latlng.lng-ye.lng,qe=Re.latlng.lat-ye.lat,Oe=wt.latLng(xe.lat+qe,xe.lng+Ae);wt.Circle.prototype.setLatLng.call(B,Oe),ie.setLatLng(Oe),ee.forEach((et,Je)=>{const mt=B.calculatePointOnCircle(se[Je]);et.setLatLng(mt)}),ie.measureDiv&&(ie.measureDiv.innerHTML=[qi(B.getRadius(),"m","Rayon"),qi(B.getRadius()*2,"m","Diamètre"),qi(Math.PI*Math.pow(B.getRadius(),2),"m²","Surface")].join("<br>"))},je=()=>{ae=!1,e.value&&(e.value.off("mousemove",le),document.removeEventListener("mouseup",je),e.value.dragging.enable(),B.updateProperties(),te&&B._initSections&&setTimeout(()=>{B._initSections()},100),o.value=null,Ds(()=>{o.value=B}),Ve(B,"Circle"))};e.value.on("mousemove",le),document.addEventListener("mouseup",je)}),B.on("circle:resized",()=>{Ve(B,"Circle")}),o.value=B},ue=B=>{var xe;if(!e.value||!n.value)return;if(!(B instanceof $o)){console.warn("La couche n'est pas une instance de Rectangle");return}const H=B;b();const he=H.getCenter(),te=H.getRotatedCorners(),ie=H.getMidPoints(),ee=D(he,"#059669");E.push(ee),x(ee,H,()=>{const{width:ye,height:le}=H.getDimensions(),je=ye*le,Re=H.getRotation();return[qi(ye,"m","Largeur"),qi(le,"m","Hauteur"),qi(je,"m²","Surface"),`Rotation: ${Re.toFixed(1)}°`].join("<br>")});const se=D(wt.latLng(he.lat+(te[0].lat-he.lat)*1.2,he.lng+(te[0].lng-he.lng)*1.2),"#F97316");E.push(se);const Ce=wt.polyline([he,se.getLatLng()],{color:"#F97316",weight:1,opacity:.6,dashArray:"4",pmIgnore:!0});(xe=t.value)==null||xe.addLayer(Ce);const ne=te.map(ye=>{const le=D(ye,"#DC2626");return E.push(le),x(le,H,()=>{const{width:je,height:Re}=H.getDimensions();return[qi(je,"m","Largeur"),qi(Re,"m","Hauteur")].join("<br>")}),le}),ae=ie.map((ye,le)=>{const je=D(ye,"#2563EB");return E.push(je),x(je,H,()=>{const{width:Re,height:Ae}=H.getDimensions(),qe=le%2===0?Re:Ae;return[qi(qe,"m","Longueur du côté"),qi(qe/2,"m","Distance au coin")].join("<br>")}),je});ee.on("mousedown",ye=>{if(!e.value)return;wt.DomEvent.stopPropagation(ye),e.value.dragging.disable();let le=!0;const je=Ae=>{if(!le)return;H.moveFromCenter(Ae.latlng);const qe=H.getRotatedCorners(),Oe=H.getMidPoints();ne.forEach((Je,mt)=>Je.setLatLng(qe[mt])),ae.forEach((Je,mt)=>Je.setLatLng(Oe[mt])),ee.setLatLng(Ae.latlng);const et=wt.latLng(Ae.latlng.lat+(qe[0].lat-Ae.latlng.lat)*1.2,Ae.latlng.lng+(qe[0].lng-Ae.latlng.lng)*1.2);se.setLatLng(et),Ce.setLatLngs([Ae.latlng,et])},Re=()=>{le=!1,e.value&&(e.value.off("mousemove",je),document.removeEventListener("mouseup",Re),e.value.dragging.enable(),H.updateProperties(),o.value=null,Ds(()=>{o.value=H}))};e.value.on("mousemove",je),document.addEventListener("mouseup",Re)}),se.on("mousedown",ye=>{if(!e.value)return;wt.DomEvent.stopPropagation(ye),e.value.dragging.disable();let le=!1;const je=ye.latlng,Re=H.getRotation(),Ae=H.getCenter(),qe=je.lng-Ae.lng,Oe=je.lat-Ae.lat,et=Math.atan2(Oe,qe)*180/Math.PI;E.forEach(_t=>{_t!==se&&(_t.setStyle({opacity:0,fillOpacity:0}),_t.measureDiv&&(_t.measureDiv.style.display="none"))});const Je=Hu(_t=>{le||(le=!0);const $t=_t.latlng.lng-Ae.lng,Xt=_t.latlng.lat-Ae.lat;let Kt=Math.atan2(Xt,$t)*180/Math.PI-et,Qt=(Re+Kt)%360;Qt<0&&(Qt+=360),H.setRotation(Qt,!1),se.setLatLng(_t.latlng),Ce.setLatLngs([Ae,_t.latlng])},16),mt=()=>{e.value&&(e.value.off("mousemove",Je),document.removeEventListener("mouseup",mt),e.value.dragging.enable(),le&&H.finalizeRotation(),o.value=null,Ds(()=>{o.value=H,b(),ue(H)}))};e.value.on("mousemove",Je),document.addEventListener("mouseup",mt)}),H.on("coordinates:updated",ye=>{const{corners:le,center:je}=ye,Re=H.getMidPoints();ne.forEach((qe,Oe)=>qe.setLatLng(le[Oe])),ae.forEach((qe,Oe)=>qe.setLatLng(Re[Oe])),ee.setLatLng(je);const Ae=wt.latLng(je.lat+(le[0].lat-je.lat)*1.2,je.lng+(le[0].lng-je.lng)*1.2);se.setLatLng(Ae),Ce.setLatLngs([je,Ae])})},z=B=>{if(!e.value||!n.value)return;b();const H=B.getLatLngs();if(!H||H.length===0){console.warn("Pas de points pour la ligne");return}let he=null;if(B instanceof Lo){const te=B.getCenter();he=D(te,"#059669"),E.push(he),x(he,B,()=>{const ie=B.getLength()||0;return qi(ie,"m","Longueur totale")}),he.on("mousedown",ie=>{if(!e.value)return;wt.DomEvent.stopPropagation(ie),e.value.dragging.disable();let ee=!0;const se=B.getLatLngs().map(ye=>wt.latLng(ye.lat,ye.lng)),Ce=ie.latlng;B instanceof Lo&&(B.off("move:end"),B.off("vertex:moved"),B.off("latlngs:updated"),B.off("properties:updated")),E.forEach((ye,le)=>{le>0&&(ye.setStyle({opacity:0,fillOpacity:0}),ye.measureDiv&&(ye.measureDiv.style.display="none"))});const ae=Hu(ye=>{if(!ee)return;const le=ye.latlng.lng-Ce.lng,je=ye.latlng.lat-Ce.lat,Re=se.map(Ae=>wt.latLng(Ae.lat+je,Ae.lng+le));wt.Polyline.prototype.setLatLngs.call(B,Re),he==null||he.setLatLng(ye.latlng)},16),xe=()=>{if(ee=!1,!!e.value){if(e.value.off("mousemove",ae),document.removeEventListener("mouseup",xe),e.value.dragging.enable(),B instanceof Lo){const ye=()=>{b(),z(B)};B.on("move:end",ye),B.on("vertex:moved",ye),B.on("latlngs:updated",ye),B.on("properties:updated",ye),B.updateProperties(),Ve(B,"Line")}b(),z(B)}};e.value.on("mousemove",ae),document.addEventListener("mouseup",xe)})}if(H.forEach((te,ie)=>{const ee=D(te,"#DC2626");E.push(ee),x(ee,B,()=>{if(B instanceof Lo){const se=B.getLength()||0,Ce=B.getLengthToVertex(ie);return[qi(Ce,"m","Distance depuis le début"),qi(se,"m","Longueur totale")].join("<br>")}return""}),ee.on("mousedown",se=>{if(!e.value)return;wt.DomEvent.stopPropagation(se),e.value.dragging.disable();let Ce=!0;B instanceof Lo&&(B.off("move:end"),B.off("vertex:moved"),B.off("latlngs:updated"),B.off("properties:updated")),E.forEach((xe,ye)=>{ye!==ie+1&&(xe.setStyle({opacity:0,fillOpacity:0}),xe.measureDiv&&(xe.measureDiv.style.display="none"))});const ne=Hu(xe=>{if(!Ce)return;const ye=B.getLatLngs();ye[ie]=xe.latlng,wt.Polyline.prototype.setLatLngs.call(B,ye),ee.setLatLng(xe.latlng)},16),ae=()=>{if(Ce=!1,!!e.value){if(e.value.off("mousemove",ne),document.removeEventListener("mouseup",ae),e.value.dragging.enable(),B instanceof Lo){const xe=()=>{b(),z(B)};B.on("move:end",xe),B.on("vertex:moved",xe),B.on("latlngs:updated",xe),B.on("properties:updated",xe),B.updateProperties(),Ve(B,"Line")}b(),z(B)}};e.value.on("mousemove",ne),document.addEventListener("mouseup",ae)})}),H.length>=2)for(let te=0;te<H.length-1;te++){const ie=H[te],ee=H[te+1],se=wt.latLng((ie.lat+ee.lat)/2,(ie.lng+ee.lng)/2),Ce=D(se,"#2563EB");E.push(Ce),x(Ce,B,()=>{if(B instanceof Lo){const ne=B.getSegmentLengthAt(te),ae=B.getLength()||0,xe=B.getLengthToVertex(te)+ne/2;return[qi(ne,"m","Longueur du segment"),qi(ne/2,"m","Demi-segment"),qi(xe,"m","Distance depuis le début"),qi(ae,"m","Longueur totale")].join("<br>")}return""})}if(B instanceof Lo){const te=()=>{b(),z(B)};B.on("move:start",()=>{E.forEach((ie,ee)=>{ee>0&&(ie.setStyle({opacity:0,fillOpacity:0}),ie.measureDiv&&(ie.measureDiv.style.display="none"))})}),B.on("move:end",te),B.on("vertex:moved",te),B.on("latlngs:updated",te),B.on("properties:updated",te),E.cleanup=()=>{B.off("move:start",()=>{}),B.off("move:end",te),B.off("vertex:moved",te),B.off("latlngs:updated",te),B.off("properties:updated",te)}}},R=B=>{if(!e.value||!n.value)return;b();const H=B.getLatLngs()[0],he=H.map(ae=>[ae.lng,ae.lat]);he.push(he[0]);const te=Sl([he]),ie=pu(te),ee=H.reduce((ae,xe,ye)=>{const le=H[(ye+1)%H.length];return ae+xe.distanceTo(le)},0);let se;if(typeof B.getCenter=="function")try{se=B.getCenter()}catch(ae){console.warn("Erreur lors de la récupération du centre du polygone via getCenter(), utilisation de la méthode alternative",ae);const xe=Df(te);se=wt.latLng(xe.geometry.coordinates[1],xe.geometry.coordinates[0])}else{const ae=Df(te);se=wt.latLng(ae.geometry.coordinates[1],ae.geometry.coordinates[0])}const Ce=D(se,"#059669");E.push(Ce),x(Ce,B,()=>[qi(ee,"m","Périmètre"),qi(ie,"m²","Surface")].join("<br>")),Ce.on("mousedown",ae=>{if(!e.value)return;wt.DomEvent.stopPropagation(ae),e.value.dragging.disable();let xe=!0;const ye=ae.latlng,le=[...H];E.forEach((qe,Oe)=>{Oe>0&&qe.setStyle({opacity:0,fillOpacity:0})});const je=Hu(qe=>{if(!xe)return;const Oe=qe.latlng.lng-ye.lng,et=qe.latlng.lat-ye.lat,Je=le.map(mt=>wt.latLng(mt.lat+et,mt.lng+Oe));wt.Polygon.prototype.setLatLngs.call(B,[Je]),Ce.setLatLng(qe.latlng)},16),Re=qe=>{xe&&je(qe)},Ae=()=>{if(xe=!1,!!e.value){if(e.value.off("mousemove",Re),document.removeEventListener("mouseup",Ae),e.value.dragging.enable(),B.properties){const qe=B.getLatLngs()[0],Oe=qe.map(Je=>[Je.lng,Je.lat]);Oe.push(Oe[0]);const et=Sl([Oe]);B.properties.area=pu(et),B.properties.perimeter=qe.reduce((Je,mt,_t)=>{const $t=qe[(_t+1)%qe.length];return Je+mt.distanceTo($t)},0),B.properties.surface=B.properties.area}b(),R(B),o.value=null,Ds(()=>{o.value=B})}};e.value.on("mousemove",Re),document.addEventListener("mouseup",Ae)}),H.forEach((ae,xe)=>{const ye=D(ae,"#DC2626");E.push(ye),x(ye,B,()=>{const le=H[(xe-1+H.length)%H.length],je=H[(xe+1)%H.length],Re=ae.distanceTo(le),Ae=ae.distanceTo(je);return[qi(Re,"m","Distance au point précédent"),qi(Ae,"m","Distance au point suivant"),qi(ee,"m","Périmètre total"),qi(ie,"m²","Surface")].join("<br>")}),ye.on("mousedown",le=>{if(wt.DomEvent.stopPropagation(le),!e.value)return;e.value.dragging.disable();let je=!0;Ce&&(Ce.setStyle({opacity:0,fillOpacity:0}),Ce.measureDiv&&(Ce.measureDiv.style.display="none"));const Re=Hu(Oe=>{if(!je)return;H[xe]=Oe.latlng,wt.Polygon.prototype.setLatLngs.call(B,[H]),ye.setLatLng(Oe.latlng);const et=E.slice(H.length+1),Je=(xe-1+H.length)%H.length,mt=et[Je];if(mt){const $t=H[Je],Xt=H[xe],Xe=wt.latLng(($t.lat+Xt.lat)/2,($t.lng+Xt.lng)/2);mt.setLatLng(Xe)}const _t=et[xe];if(_t){const $t=H[xe],Xt=H[(xe+1)%H.length],Xe=wt.latLng(($t.lat+Xt.lat)/2,($t.lng+Xt.lng)/2);_t.setLatLng(Xe)}},16),Ae=Oe=>{je&&Re(Oe)},qe=()=>{if(je=!1,!!e.value){if(e.value.off("mousemove",Ae),document.removeEventListener("mouseup",qe),e.value.dragging.enable(),B.properties){const Oe=B.getLatLngs()[0].map(Je=>[Je.lng,Je.lat]);Oe.push(Oe[0]);const et=Sl([Oe]);B.properties.area=pu(et),B.properties.perimeter=H.reduce((Je,mt,_t)=>{const $t=H[(_t+1)%H.length];return Je+mt.distanceTo($t)},0),B.properties.surface=B.properties.area}b(),R(B),o.value=null,Ds(()=>{o.value=B})}};e.value.on("mousemove",Ae),document.addEventListener("mouseup",qe)})}),(()=>{const ae=B.getLatLngs()[0];E.slice(ae.length+1).forEach(ye=>{t.value&&t.value.removeLayer(ye)}),E=E.slice(0,ae.length+1);const xe=new Array(ae.length);for(let ye=0;ye<ae.length;ye++){const le=ae[ye],je=ae[(ye+1)%ae.length];xe[ye]=O(le,je)}xe.forEach((ye,le)=>{const je=D(ye,"#2563EB");E.push(je),x(je,B,()=>{const Re=ae[le],Ae=ae[(le+1)%ae.length],qe=Re.distanceTo(Ae);return[qi(qe,"m","Longueur du segment"),qi(ee,"m","Périmètre total"),qi(ie,"m²","Surface")].join("<br>")}),je.on("mousedown",Re=>{if(!e.value)return;wt.DomEvent.stopPropagation(Re),e.value.dragging.disable();let Ae=!0;const qe=le;Ce&&(Ce.setStyle({opacity:0,fillOpacity:0}),Ce.measureDiv&&(Ce.measureDiv.style.display="none"));const Oe=[...B.getLatLngs()[0]];Oe.splice((qe+1)%Oe.length,0,ye),B.setLatLngs([Oe]),b(),R(B);const et=qe+1,Je=1+et,mt=et<E.length-1?E[Je]:null;if(mt){const _t=Xt=>{if(!Ae)return;const Xe=B.getLatLngs()[0];Xe[et]=Xt.latlng,B.setLatLngs([Xe]),mt.setLatLng(Xt.latlng);const Kt=E.slice(1+Xe.length),Qt=(et-1+Xe.length)%Xe.length,Qe=et;if(Kt[Qt]){const We=Xe[Qt],Ut=Xe[et],pn=wt.latLng((We.lat+Ut.lat)/2,(We.lng+Ut.lng)/2);Kt[Qt].setLatLng(pn)}if(Kt[Qe]){const We=Xe[et],Ut=Xe[(et+1)%Xe.length],pn=wt.latLng((We.lat+Ut.lat)/2,(We.lng+Ut.lng)/2);Kt[Qe].setLatLng(pn)}},$t=()=>{if(Ae=!1,!!e.value){if(e.value.off("mousemove",_t),document.removeEventListener("mouseup",$t),e.value.dragging.enable(),B.properties){const Xt=B.getLatLngs()[0].map(Kt=>[Kt.lng,Kt.lat]);Xt.push(Xt[0]);const Xe=Sl([Xt]);B.properties.area=pu(Xe),B.properties.perimeter=B.getLatLngs()[0].reduce((Kt,Qt,Qe,We)=>{const Ut=We[(Qe+1)%We.length];return Kt+Qt.distanceTo(Ut)},0)}b(),R(B),o.value=null,Ds(()=>{o.value=B})}};e.value.on("mousemove",_t),document.addEventListener("mouseup",$t)}else e.value.dragging.enable(),b(),R(B)})})})()},J=B=>{if(!e.value||!n.value)return;b();const H=B.getCenter(),he=B.getStartAngle(),te=B.getStopAngle(),ie=B.getOpeningAngle(),ee=B.calculatePointOnArc(he),se=B.calculatePointOnArc(te),Ce=D(ee,"#DC2626"),ne=D(se,"#DC2626");E.push(Ce,ne);const ae=D(H,"#059669");E.push(ae);let xe=null;if(ie>5){const ye=B.calculateMidpointPosition();xe=D(ye,"#2563EB"),E.push(xe),xe.on("mousedown",le=>{if(!e.value||!xe)return;wt.DomEvent.stopPropagation(le),e.value.dragging.disable();let je=!0;const Re=qe=>{if(!je||!xe)return;const Oe=H.distanceTo(qe.latlng);B.setRadius(Oe);const et=B.calculatePointOnArc(he),Je=B.calculatePointOnArc(te),mt=B.calculateMidpointPosition();Ce.setLatLng(et),ne.setLatLng(Je),xe.setLatLng(mt),B.updateProperties();const _t=xe;_t!=null&&_t.measureDiv&&(_t.measureDiv.innerHTML=qi(Oe,"m","Rayon"))},Ae=()=>{je=!1,e.value&&(e.value.off("mousemove",Re),document.removeEventListener("mouseup",Ae),e.value.dragging.enable(),B.updateProperties(),o.value=null,Ds(()=>{o.value=B}),Ve(B,"Semicircle"))};e.value.on("mousemove",Re),document.addEventListener("mouseup",Ae)})}[Ce,ne].forEach((ye,le)=>{ye.on("mousedown",je=>{if(!e.value)return;wt.DomEvent.stopPropagation(je),e.value.dragging.disable();let Re=!0;const Ae=Oe=>{if(!Re||!e.value)return;const et=Oe.latlng.lng-H.lng,Je=Oe.latlng.lat-H.lat,mt=B.getRadius(),_t=Math.sqrt(et*et+Je*Je),$t=mt/(_t*111319.9*Math.cos(H.lat*Math.PI/180)),Xt=H.lng+et*$t,Xe=H.lat+Je*$t,Kt=(Math.atan2(Xe-H.lat,Xt-H.lng)*180/Math.PI+360)%360;le===0?B.setAngles(Kt,B.getStopAngle()):B.setAngles(B.getStartAngle(),Kt);const Qt=B.getStartAngle(),Qe=B.getStopAngle(),We=B.getOpeningAngle(),Ut=B.calculatePointOnArc(Qt),pn=B.calculatePointOnArc(Qe);if(Ce.setLatLng(Ut),ne.setLatLng(pn),xe&&We>5){const _n=B.calculateMidpointPosition();xe.setLatLng(_n),xe.setStyle({opacity:1,fillOpacity:1})}else xe&&xe.setStyle({opacity:0,fillOpacity:0});B.updateProperties(),o.value=B},qe=()=>{Re=!1,e.value&&(e.value.off("mousemove",Ae),document.removeEventListener("mouseup",qe),e.value.dragging.enable(),B.updateProperties(),o.value=null,Ds(()=>{o.value=B}),Ve(B,"Semicircle"),J(B))};e.value.on("mousemove",Ae),document.addEventListener("mouseup",qe)})}),ae.on("mousedown",ye=>{if(!e.value)return;wt.DomEvent.stopPropagation(ye),e.value.dragging.disable();let le=!0;const je=Ae=>{if(!le)return;B.setCenter(Ae.latlng),ae.setLatLng(Ae.latlng);const qe=B.getStartAngle(),Oe=B.getStopAngle(),et=B.getOpeningAngle(),Je=B.calculatePointOnArc(qe),mt=B.calculatePointOnArc(Oe);if(Ce.setLatLng(Je),ne.setLatLng(mt),xe&&et>5){const _t=B.calculateMidpointPosition();xe.setLatLng(_t),xe.setStyle({opacity:1,fillOpacity:1})}else xe&&xe.setStyle({opacity:0,fillOpacity:0});B.updateProperties(),o.value=B},Re=()=>{le=!1,e.value&&(e.value.off("mousemove",je),document.removeEventListener("mouseup",Re),e.value.dragging.enable(),B.updateProperties(),o.value=null,Ds(()=>{o.value=B}),Ve(B,"Semicircle"))};e.value.on("mousemove",je),document.addEventListener("mouseup",Re)})},V=B=>{var H;if(!(!e.value||!i.value)){console.log("[generateTempControlPoints] Génération des points temporaires pour",{layerType:B.constructor.name,properties:B.properties}),i.value.clearLayers();try{if(B instanceof yu){const he=(H=B.getBounds)==null?void 0:H.call(B).getCenter();if(he){const te=wt.circleMarker(he,{radius:0,className:"text-hint-marker",pmIgnore:!0});i.value.addLayer(te)}}else if(B instanceof $o)B.generateHelperPoints(e.value);else if(B instanceof Zc||B instanceof wu||B instanceof eh){if("getLatLng"in B&&typeof B.getLatLng=="function"){const he=B.getLatLng();if(he){const te=wt.circleMarker(he,{radius:5,color:"#059669",fillColor:"#059669",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});i.value.addLayer(te)}}}else if(B instanceof zh||B instanceof wt.Polygon){let he=[];if("getLatLngs"in B){const ie=B.getLatLngs();if(Array.isArray(ie)&&ie.length>0){const ee=ie[0];Array.isArray(ee)?he=ee:ee instanceof wt.LatLng&&(he=ie)}}let te=null;if(B instanceof zh&&typeof B.getCenter=="function")te=B.getCenter();else if(he.length>0){const ie=he.map(Ce=>[Ce.lng,Ce.lat]);ie.push(ie[0]);const ee=Sl([ie]),se=Df(ee);te=wt.latLng(se.geometry.coordinates[1],se.geometry.coordinates[0])}if(te){const ie=wt.circleMarker(te,{radius:5,color:"#059669",fillColor:"#059669",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});i.value.addLayer(ie)}he.forEach(ie=>{if(ie){const ee=wt.circleMarker(ie,{radius:5,color:"#DC2626",fillColor:"#DC2626",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});i.value.addLayer(ee)}});for(let ie=0;ie<he.length;ie++){const ee=he[ie],se=he[(ie+1)%he.length];if(ee&&se){const Ce=wt.latLng((ee.lat+se.lat)/2,(ee.lng+se.lng)/2),ne=wt.circleMarker(Ce,{radius:5,color:"#2563EB",fillColor:"#2563EB",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});i.value.addLayer(ne)}}}console.log("[generateTempControlPoints] Points temporaires générés",{count:i.value.getLayers().length})}catch(he){console.error("[generateTempControlPoints] Erreur lors de la génération des points temporaires:",he)}}},U=B=>{if(!e.value||!n.value||!B.getBounds)return;const H=B;b(),H.on("edit:start",()=>{b()}),H.on("edit:end",()=>{U(H)});const he=H.getBounds(),te=he.getCenter(),ie=H.properties.rotation||0,ee=le=>{if(ie===0)return le;const je=ie*Math.PI/180,Re=Math.cos(je),Ae=Math.sin(je),qe=le.lng-te.lng,Oe=le.lat-te.lat,et=qe*Re-Oe*Ae,Je=qe*Ae+Oe*Re;return wt.latLng(te.lat+Je,te.lng+et)},se=[he.getNorthWest(),he.getNorthEast(),he.getSouthEast(),he.getSouthWest()].map(le=>ee(le)),Ce=H.getMidPoints().map(le=>ee(le)),ne=D(te,"#059669");ne.addTo(e.value),E.push(ne),x(ne,H,()=>{const{width:le,height:je}=H.getDimensions(),Re=le*je;return[qi(le,"m","Largeur"),qi(je,"m","Hauteur"),qi(Re,"m²","Surface"),`Rotation: ${ie.toFixed(1)}°`].join("<br>")});const ae=se.map((le,je)=>{const Re=D(le,"#DC2626");return Re.addTo(e.value),E.push(Re),x(Re,H,()=>{const{width:Ae,height:qe}=H.getDimensions();return[qi(Ae,"m","Largeur"),qi(qe,"m","Hauteur")].join("<br>")}),Re.on("mousedown",Ae=>{if(!e.value)return;wt.DomEvent.stopPropagation(Ae),e.value.dragging.disable();const qe=(je+2)%4,Oe=se[qe];H.startResize();const et=Hu(_t=>{const $t=wt.latLngBounds(Oe,_t.latlng);H.updateResizePreview($t)},16),Je=_t=>et(_t),mt=()=>{if(!e.value)return;e.value.off("mousemove",Je),document.removeEventListener("mouseup",mt),e.value.dragging.enable();const _t=wt.latLngBounds(Oe,Re.getLatLng());H.endResize(_t),o.value=null,Ds(()=>{o.value=H})};e.value.on("mousemove",Je),document.addEventListener("mouseup",mt)}),Re}),xe=Ce.map((le,je)=>{const Re=D(le,"#2563EB");return Re.addTo(e.value),E.push(Re),x(Re,H,()=>{const{width:Ae,height:qe}=H.getDimensions(),Oe=je%2===0?Ae:qe;return[qi(Oe,"m","Longueur du côté"),qi(Oe/2,"m","Distance au coin"),`Rotation: ${ie.toFixed(1)}°`].join("<br>")}),Re.on("mousedown",Ae=>{if(!e.value)return;wt.DomEvent.stopPropagation(Ae),e.value.dragging.disable(),H.startResize();const qe=Hu(Je=>{const mt=H.getBounds();let _t;switch(je){case 0:_t=wt.latLngBounds(wt.latLng(Je.latlng.lat,mt.getWest()),wt.latLng(mt.getSouth(),mt.getEast()));break;case 1:_t=wt.latLngBounds(wt.latLng(mt.getNorth(),mt.getWest()),wt.latLng(mt.getSouth(),Je.latlng.lng));break;case 2:_t=wt.latLngBounds(wt.latLng(mt.getNorth(),mt.getWest()),wt.latLng(Je.latlng.lat,mt.getEast()));break;case 3:_t=wt.latLngBounds(wt.latLng(mt.getNorth(),Je.latlng.lng),wt.latLng(mt.getSouth(),mt.getEast()));break;default:return}H.updateResizePreview(_t)},16),Oe=Je=>qe(Je),et=()=>{if(!e.value)return;e.value.off("mousemove",Oe),document.removeEventListener("mouseup",et),e.value.dragging.enable();const Je=H.getBounds();let mt;switch(je){case 0:mt=wt.latLngBounds(wt.latLng(Re.getLatLng().lat,Je.getWest()),wt.latLng(Je.getSouth(),Je.getEast()));break;case 1:mt=wt.latLngBounds(wt.latLng(Je.getNorth(),Je.getWest()),wt.latLng(Je.getSouth(),Re.getLatLng().lng));break;case 2:mt=wt.latLngBounds(wt.latLng(Je.getNorth(),Je.getWest()),wt.latLng(Re.getLatLng().lat,Je.getEast()));break;case 3:mt=wt.latLngBounds(wt.latLng(Je.getNorth(),Re.getLatLng().lng),wt.latLng(Je.getSouth(),Je.getEast()));break;default:return}H.endResize(mt),o.value=null,Ds(()=>{o.value=H})};e.value.on("mousemove",Oe),document.addEventListener("mouseup",et)}),Re});ne.on("mousedown",le=>{if(!e.value)return;wt.DomEvent.stopPropagation(le),e.value.dragging.disable();const je=H.getBounds().getCenter(),Re=le.latlng;H.startResize();const Ae=Hu(et=>{const Je=et.latlng.lng-Re.lng,mt=et.latlng.lat-Re.lat,_t=wt.latLng(je.lat+mt,je.lng+Je),$t=H.getBounds(),Xt=$t.getEast()-$t.getWest(),Xe=$t.getNorth()-$t.getSouth(),Kt=wt.latLngBounds(wt.latLng(_t.lat-Xe/2,_t.lng-Xt/2),wt.latLng(_t.lat+Xe/2,_t.lng+Xt/2));H.updateResizePreview(Kt)},16),qe=et=>Ae(et),Oe=()=>{if(!e.value)return;e.value.off("mousemove",qe),document.removeEventListener("mouseup",Oe),e.value.dragging.enable();const et=H.getBounds(),Je=et.getEast()-et.getWest(),mt=et.getNorth()-et.getSouth(),_t=ne.getLatLng(),$t=wt.latLngBounds(wt.latLng(_t.lat-mt/2,_t.lng-Je/2),wt.latLng(_t.lat+mt/2,_t.lng+Je/2));H.endResize($t),o.value=null,Ds(()=>{o.value=H})};e.value.on("mousemove",qe),document.addEventListener("mouseup",Oe)}),H.on("resize:update",le=>{const je=le.bounds,Re=je.getCenter(),Ae=[je.getNorthWest(),je.getNorthEast(),je.getSouthEast(),je.getSouthWest()].map(Oe=>ee(Oe));ae.forEach((Oe,et)=>{Oe.setLatLng(Ae[et])}),ne.setLatLng(Re);const qe=[wt.latLng((Ae[0].lat+Ae[1].lat)/2,(Ae[0].lng+Ae[1].lng)/2),wt.latLng((Ae[1].lat+Ae[2].lat)/2,(Ae[1].lng+Ae[2].lng)/2),wt.latLng((Ae[2].lat+Ae[3].lat)/2,(Ae[2].lng+Ae[3].lng)/2),wt.latLng((Ae[3].lat+Ae[0].lat)/2,(Ae[3].lng+Ae[0].lng)/2)].map(Oe=>ee(Oe));xe.forEach((Oe,et)=>{Oe.setLatLng(qe[et])})});const ye=()=>{H.off("edit:start"),H.off("edit:end"),H.off("resize:update")};E.cleanup=ye},Y=B=>{console.log("Nombre total de couches:",B.length);const H=B.filter(se=>{var ae;if(!se)return!1;let Ce=0,ne={width:0,height:0};if(se instanceof wt.Circle){Ce=Math.PI*Math.pow(se.getRadius(),2);const xe=se.getRadius();console.log(`
Forme détectée: Circle`),console.log(`- Surface propre: ${Ce.toFixed(2)} m²`),console.log(`- Rayon: ${xe.toFixed(2)} m`),console.log("- Angle: Cercle complet (360°)")}else if(se instanceof $o||se instanceof wt.Rectangle){const xe=se.getBounds(),ye=xe.getSouthWest(),le=xe.getNorthEast(),je=Pl([[ye.lng,ye.lat],[le.lng,ye.lat]]),Re=Pl([[ye.lng,ye.lat],[ye.lng,le.lat]]);ne.width=Vc(je,{units:"meters"}),ne.height=Vc(Re,{units:"meters"}),Ce=ne.width*ne.height,console.log(`
Forme détectée: Rectangle`),console.log(`- Surface propre: ${Ce.toFixed(2)} m²`),console.log(`- Largeur: ${ne.width.toFixed(2)} m`),console.log(`- Hauteur: ${ne.height.toFixed(2)} m`)}else if(((ae=se.properties)==null?void 0:ae.type)==="Semicircle"){const xe=se.getStartAngle(),ye=se.getStopAngle(),le=(ye-xe+360)%360,je=se.getRadius();Ce=Math.PI*Math.pow(je,2)*le/360,console.log(`
Forme détectée: Semicircle`),console.log(`- Surface propre: ${Ce.toFixed(2)} m²`),console.log(`- Rayon: ${je.toFixed(2)} m`),console.log(`- Angle de début: ${xe.toFixed(2)}°`),console.log(`- Angle de fin: ${ye.toFixed(2)}°`),console.log(`- Angle d'ouverture: ${le.toFixed(2)}°`)}return Ce>0});if(H.length===0)return 0;const he=new Set,te=[];for(const se of H)if(!he.has(se)){const Ce=Pe(H,se);Ce.length>0&&(te.push(Ce),Ce.forEach(ne=>he.add(ne)))}console.log(`
Nombre de groupes de formes connectées: ${te.length}`);const ie=te.map((se,Ce)=>{console.log(`
Calcul pour le groupe ${Ce+1} (${se.length} formes):`);const ne=se.map(je=>{var Re,Ae,qe;try{let Oe;if(je instanceof wt.Circle){const et=je.getLatLng(),Je=je.getRadius();Oe=Rk([et.lng,et.lat],Je/1e3,{units:"kilometers",steps:256});const mt=pu(Oe),_t=((Re=je.properties)==null?void 0:Re.surface)||0;return console.log(`
Conversion Cercle -> GeoJSON`),console.log(`- Rayon: ${Je.toFixed(2)}m`),console.log(`- Surface propriété: ${_t.toFixed(2)}m²`),console.log(`- Surface GeoJSON: ${mt.toFixed(2)}m²`),Oe}else if(je instanceof $o||je instanceof wt.Rectangle){const et=je.getBounds(),Je=et.getSouthWest(),mt=et.getNorthEast(),_t=wt.latLng(mt.lat,Je.lng),$t=wt.latLng(Je.lat,mt.lng),Xt=[[Je.lng,Je.lat],[$t.lng,$t.lat],[mt.lng,mt.lat],[_t.lng,_t.lat],[Je.lng,Je.lat]];Oe=Sl([Xt]);const Xe=pu(Oe),Kt=Pl([[Je.lng,Je.lat],[mt.lng,Je.lat]]),Qt=Pl([[Je.lng,Je.lat],[Je.lng,mt.lat]]),Qe=Vc(Kt,{units:"meters"}),We=Vc(Qt,{units:"meters"}),Ut=Qe*We;return console.log(`
Conversion Rectangle -> GeoJSON`),console.log(`- Largeur: ${Qe.toFixed(2)}m`),console.log(`- Hauteur: ${We.toFixed(2)}m`),console.log(`- Surface théorique: ${Ut.toFixed(2)}m²`),console.log(`- Surface GeoJSON: ${Xe.toFixed(2)}m²`),console.log(`- Différence: ${Math.abs(Ut-Xe).toFixed(2)}m² (${(Math.abs(Ut-Xe)/Ut*100).toFixed(2)}%)`),Oe}else if(((Ae=je.properties)==null?void 0:Ae.type)==="Semicircle"){const et=je.getCenter(),Je=je.getRadius(),mt=je.getStartAngle(),_t=je.getStopAngle(),$t=[],Xt=64;$t.push([et.lng,et.lat]);for(let Qt=0;Qt<=Xt;Qt++){const We=(mt+(_t-mt+360)%360*Qt/Xt)*Math.PI/180,Ut=Je*Math.cos(We),_n=Je*Math.sin(We)/111319.9,mn=Ut/(111319.9*Math.cos(et.lat*Math.PI/180));$t.push([et.lng+mn,et.lat+_n])}$t.push([et.lng,et.lat]),Oe=Sl([$t]);const Xe=pu(Oe),Kt=((qe=je.properties)==null?void 0:qe.surface)||0;return console.log(`
Conversion Semicircle -> GeoJSON`),console.log(`- Rayon: ${Je.toFixed(2)}m`),console.log(`- Surface propriété: ${Kt.toFixed(2)}m²`),console.log(`- Surface GeoJSON: ${Xe.toFixed(2)}m²`),console.log(`- Différence: ${Math.abs(Kt-Xe).toFixed(2)}m² (${(Math.abs(Kt-Xe)/Kt*100).toFixed(2)}%)`),Oe}return null}catch(Oe){return console.error("[useMapDrawing] Erreur lors de la conversion en GeoJSON:",Oe),null}}).filter(je=>je!==null);if(ne.length===0)return 0;const ae=ne.map(je=>{const Re=pu(je);return console.log(`Surface individuelle: ${Re.toFixed(2)}m²`),Re});let xe=0;for(let je=0;je<ne.length;je++)for(let Re=je+1;Re<ne.length;Re++)try{const Ae=bk([ne[je],ne[Re]]),qe=t8(Ae);if(qe){const Oe=pu(qe);xe+=Oe,console.log(`Intersection entre formes ${je+1} et ${Re+1}: ${Oe.toFixed(2)}m²`)}}catch(Ae){console.error(`Erreur lors du calcul d'intersection entre les formes ${je+1} et ${Re+1}:`,Ae)}const ye=ae.reduce((je,Re)=>je+Re,0),le=ye-xe;return console.log(`
Calcul de la surface d'irrigation pour le groupe ${Ce+1}:`),console.log(`- Surface totale (somme): ${ye.toFixed(2)}m²`),console.log(`- Surface d'intersection: ${xe.toFixed(2)}m²`),console.log(`- Surface d'irrigation finale: ${le.toFixed(2)}m²`),le}),ee=Math.max(...ie);return console.log(`
Surface d'irrigation maximale parmi les groupes: ${ee.toFixed(2)}m²`),ee},ce=()=>{h.value&&(e.value.removeLayer(h.value),h.value=null)},re=(B,H)=>{if(!e.value)return;ce();const he=H?Pe(B,H):B;if(h.value||(h.value=wt.layerGroup().addTo(e.value)),he.forEach(te=>{var ee;const ie=(ee=te.properties)==null?void 0:ee.type;if(ie==="Circle"||ie==="Semicircle"){const se=te.getLatLng(),Ce=te.getRadius(),ne=wt.circle(se,{radius:Ce,fillColor:"#3B82F6",fillOpacity:.1,stroke:!0,color:"#3B82F6",weight:1,opacity:.8,dashArray:"5, 5",interactive:!1,renderer:wt.canvas({padding:.5})}),ae=wt.circle(se,{radius:Ce,fillColor:"#3B82F6",fillOpacity:.05,stroke:!1,interactive:!1,renderer:wt.canvas({padding:.5})});h.value&&(h.value.addLayer(ae),h.value.addLayer(ne))}else if(ie==="Rectangle"||ie==="Polygon"){const se=te.getLatLngs(),Ce=wt.polygon(se,{fillColor:"#3B82F6",fillOpacity:.1,stroke:!0,color:"#3B82F6",weight:1,opacity:.8,dashArray:"5, 5",interactive:!1,renderer:wt.canvas({padding:.5})}),ne=wt.polygon(se,{fillColor:"#3B82F6",fillOpacity:.05,stroke:!1,interactive:!1,renderer:wt.canvas({padding:.5})});h.value&&(h.value.addLayer(ne),h.value.addLayer(Ce))}}),H&&he.length>1&&e.value){const te=wt.latLngBounds([]);he.forEach(se=>{se.getBounds?te.extend(se.getBounds()):se.getLatLng&&te.extend(se.getLatLng())});const ie=te.getCenter(),ee=wt.tooltip({permanent:!0,direction:"center",className:"connected-group-tooltip"}).setContent("<div>Groupe connecté</div>").setLatLng(ie);h.value&&h.value.addLayer(wt.marker(ie,{opacity:0,interactive:!1}).bindTooltip(ee).openTooltip())}},Pe=(B,H)=>{if(!H)return[];const he=new Set,te=[H],ie=[H];for(H._leaflet_id!==void 0&&he.add(H._leaflet_id);te.length>0;){const ee=te.shift();for(const se of B){if(se===ee||he.has(se._leaflet_id))continue;Me(ee,se)&&(ie.push(se),te.push(se),he.add(se._leaflet_id))}}return ie},Me=(B,H)=>{let he=null,te=null;if(B.getBounds&&typeof B.getBounds=="function")he=B.getBounds();else if(B.getLatLng&&B.getRadius){const ie=B.getLatLng(),ee=B.getRadius();he=wt.latLngBounds([ie.lat-ee/111e3,ie.lng-ee/(111e3*Math.cos(ie.lat*Math.PI/180))],[ie.lat+ee/111e3,ie.lng+ee/(111e3*Math.cos(ie.lat*Math.PI/180))])}if(H.getBounds&&typeof H.getBounds=="function")te=H.getBounds();else if(H.getLatLng&&H.getRadius){const ie=H.getLatLng(),ee=H.getRadius();te=wt.latLngBounds([ie.lat-ee/111e3,ie.lng-ee/(111e3*Math.cos(ie.lat*Math.PI/180))],[ie.lat+ee/111e3,ie.lng+ee/(111e3*Math.cos(ie.lat*Math.PI/180))])}return!(!he||!te||!he.intersects(te))},ot=(B,H)=>{var te;const he=Pe(B,H);return he.length===1&&(te=H.properties)!=null&&te.surface?H.properties.surface:Y(he)},X=B=>{var te,ie,ee,se,Ce,ne,ae,xe,ye,le,je;const H=B.layer;(te=n.value)==null||te.addLayer(H);let he="unknown";if(H instanceof wt.Circle?he=r.value==="Semicircle"?"Semicircle":"Circle":H instanceof wt.Rectangle?he="Rectangle":H instanceof wt.Polygon?he="Polygon":H instanceof wt.Polyline&&!(H instanceof wt.Polygon)&&(he="Line"),H.properties=$(H,he),o.value=H,console.log("[useMapDrawing] Input layer:",{type:he,instanceof:{Circle:H instanceof wt.Circle,Rectangle:H instanceof wt.Rectangle,Polygon:H instanceof wt.Polygon,Polyline:H instanceof wt.Polyline},options:H.options,properties:H.properties}),window.dispatchEvent(new CustomEvent("shape:created",{detail:{shape:H,type:he,properties:H.properties}})),H.on("mouseover",()=>{console.log("[mouseover] Survol de la forme",{type:he,isSelected:o.value===H}),(!o.value||o.value!==H)&&V(H)}),H.on("mouseout",()=>{var Re;console.log("[mouseout] Sortie de la forme",{type:he,isSelected:o.value===H}),(!o.value||o.value!==H)&&((Re=i.value)==null||Re.clearLayers())}),he==="Semicircle"){const Re=H.getLatLng(),Ae=H.getRadius();(ie=n.value)==null||ie.removeLayer(H);const qe=new wu(Re,Ae);qe.properties=$(qe,"Semicircle"),(ee=n.value)==null||ee.addLayer(qe),o.value=qe,J(qe)}else if(he==="Circle"){(se=n.value)==null||se.removeLayer(H);const Re=new Zc(H.getLatLng(),{radius:H.getRadius(),...H.options});Re.properties={...$(Re,"Circle"),type:"Circle"},Object.defineProperty(Re,"name",{value:Re.properties.name,writable:!0,enumerable:!0,configurable:!0}),console.log("[useMapDrawing] Création du cercle personnalisé:",{propertyDescriptor:Object.getOwnPropertyDescriptor(Re,"name"),directName:Re.name,propertiesName:Re.properties.name,nameIsEnumerable:Object.keys(Re).includes("name"),allProperties:Object.keys(Re.properties),allKeys:Object.keys(Re)}),(Ce=n.value)==null||Ce.addLayer(Re),o.value=Re,W(Re)}else if(he==="Rectangle"){(ne=n.value)==null||ne.removeLayer(H);const Re=new $o(H.getBounds(),{...H.options});Re.updateProperties(),(ae=n.value)==null||ae.addLayer(Re),o.value=Re,ue(Re)}else if(H instanceof wt.Polygon){const Re=H.getLatLngs()[0],Ae=new zh([Re],{...H.options});Ae.updateProperties(),(xe=n.value)==null||xe.removeLayer(H),(ye=n.value)==null||ye.addLayer(Ae),o.value=Ae,R(Ae)}else if(H instanceof Lo)z(H);else if(H instanceof wt.Polyline&&!(H instanceof wt.Polygon)){const Re=H.getLatLngs(),Ae=new Lo(Re,{...H.options});Ae.updateProperties(),(le=n.value)==null||le.removeLayer(H),(je=n.value)==null||je.addLayer(Ae),o.value=Ae,z(Ae)}Uo("Cliquez sur la forme pour afficher les points de contrôle")},Ee=()=>{e.value&&(e.value.off("pm:create"),e.value.on("pm:create",X))};return{map:e,featureGroup:n,controlPointsGroup:t,tempControlPointsGroup:i,currentTool:r,selectedShape:o,isDrawing:l,initMap:F,setDrawingTool:me,updateShapeStyle:Se,updateShapeProperties:Ie,updateTextFixedSize:Q,adjustView:G,clearActiveControlPoints:b,calculateTotalCoverageArea:Y,showCoverageOverlay:re,hideCoverageOverlay:ce,calculateConnectedCoverageArea:ot,getConnectedShapes:Pe}}function l7(){const{isEnabled:e,startMeasure:n}=Xh(),t=un(null),i=un(""),r=un("Ville"),o=un(null),l=n("createBaseMaps","useMapState"),h={Ville:wt.tileLayer("/osm_tiles/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:4,maxNativeZoom:18,tileSize:256,zoomOffset:0,bounds:wt.latLngBounds(wt.latLng(41.333,-5.566),wt.latLng(51.089,9.555)),crossOrigin:!0,detectRetina:!0}),Satellite:wt.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"© Esri",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:4,maxNativeZoom:18,tileSize:256,zoomOffset:0,bounds:wt.latLngBounds(wt.latLng(41.333,-5.566),wt.latLng(51.089,9.555)),crossOrigin:!0,detectRetina:!0}),Cadastre:wt.tileLayer("https://data.geopf.fr/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=CADASTRALPARCELS.PARCELLAIRE_EXPRESS&STYLE=normal&FORMAT=image/png&TILEMATRIXSET=PM&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}",{attribution:"Cadastre - Carte © IGN/Geoportail",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:4,maxNativeZoom:18,tileSize:256,zoomOffset:0,bounds:wt.latLngBounds(wt.latLng(41.333,-5.566),wt.latLng(51.089,9.555)),crossOrigin:!0,detectRetina:!0})};l();const g=Ct.createPerformanceTracker(E=>{Ct.measure("initMap:setOptions",()=>{t.value=E,E.options.zoomSnap=.25,E.options.zoomDelta=.25,E.options.wheelPxPerZoomLevel=100,E.options.zoomAnimation=!0,E.options.fadeAnimation=!0,E.options.markerZoomAnimation=!0,E.options.minZoom=2,E.options.maxZoom=19,E.options.scrollWheelZoom=!0,E.options.doubleClickZoom=!0;const b=wt.latLngBounds(wt.latLng(-90,-180),wt.latLng(90,180));E.setMaxBounds(b),E.options.maxBoundsViscosity=1,E.options.trackResize=!0;let D=null,$=E.getZoom();E.on("zoomstart",()=>{D&&clearTimeout(D),E.options.zoomAnimation=!1,E.options.markerZoomAnimation=!1,$=E.getZoom()}),E.on("zoom",()=>{const F=E.getZoom();F<$-2&&E.invalidateSize({animate:!1,pan:!1}),$=F}),E.on("zoomend",()=>{D&&clearTimeout(D),D=setTimeout(()=>{setTimeout(()=>{E.options.zoomAnimation=!0,E.options.markerZoomAnimation=!0,E.invalidateSize({animate:!1,pan:!1});const F=E.getBounds(),G=E.options.maxBounds;G&&!F.intersects(G)&&E.panInsideBounds(G,{animate:!1})},250)},250)});const Q=E._zoomAnimation;Q&&(E._zoomAnimation=function(F){try{this._animatingZoom||Q.call(this,F)}catch{console.warn("Animation de zoom interrompue, restauration de la vue..."),this._resetView(this.getCenter(),this.getZoom())}})},"useMapState"),Ct.measure("initMap:addInitialLayer",()=>{o.value=h[r.value],o.value.addTo(E)},"useMapState"),E.on("baselayerchange",b=>{const D=n("baselayerchange","useMapState",{layer:b.name});r.value=b.name,o.value=b.layer,D()}),e.value&&(E.on("movestart",()=>{n("mapMove","useMapState",{startCenter:E.getCenter()})}),E.on("moveend",()=>{n("mapMoveEnd","useMapState",{endCenter:E.getCenter()})()}),E.on("tileloadstart",()=>{n("tileLoad","useMapState")}),E.on("tileload",()=>{n("tileLoadEnd","useMapState")()}))},"initMap","useMapState"),v=Ct.createAsyncPerformanceTracker(async E=>{if(!(!t.value||!h[E]))try{if(r.value===E)return;const b=t.value,D={zoomAnimation:b.options.zoomAnimation,fadeAnimation:b.options.fadeAnimation,markerZoomAnimation:b.options.markerZoomAnimation};b.options.zoomAnimation=!1,b.options.fadeAnimation=!1,b.options.markerZoomAnimation=!1;const $=b.getCenter(),Q=b.getZoom(),F=h[E];if(typeof F.setOpacity=="function"&&F.setOpacity(0),b&&typeof b.addLayer=="function")try{b.addLayer(F)}catch(G){console.warn("Erreur lors de l'ajout de la couche:",G),typeof F.addTo=="function"&&F.addTo(b)}await new Promise(G=>{typeof F.isLoading=="function"&&F.isLoading()?F.once("load",()=>G()):setTimeout(G,100)}),await new Promise(G=>{let me=1;const Se=setInterval(()=>{if(me-=.1,o.value&&typeof o.value.setOpacity=="function"&&o.value.setOpacity(Math.max(0,me)),typeof F.setOpacity=="function"&&F.setOpacity(Math.max(0,1-me)),me<=0){if(clearInterval(Se),o.value&&b&&typeof b.removeLayer=="function")try{b.removeLayer(o.value)}catch(Ie){console.warn("Erreur lors de la suppression de la couche active:",Ie)}o.value=F,r.value=E,G()}},50)});try{b.setView($,Q,{animate:!1,duration:0,noMoveStart:!0})}catch(G){console.warn("Erreur lors de la réinitialisation de la vue:",G)}try{b.invalidateSize({animate:!1,pan:!1})}catch(G){console.warn("Erreur lors de l'invalidation de la taille:",G)}await new Promise(G=>setTimeout(G,300)),E!=="Cadastre"&&setTimeout(()=>{try{b.options.fadeAnimation=D.fadeAnimation,setTimeout(()=>{try{b.options.zoomAnimation=D.zoomAnimation,b.options.markerZoomAnimation=D.markerZoomAnimation}catch(G){console.warn("Erreur lors de la restauration des animations:",G)}},500)}catch(G){console.warn("Erreur lors de la restauration des animations:",G)}},500)}catch(b){if(console.error("Erreur lors du changement de carte de base:",b),t.value)try{const D=t.value;D.options.zoomAnimation=!0,D.options.fadeAnimation=!0,D.options.markerZoomAnimation=!0,D.invalidateSize({animate:!1,pan:!1})}catch(D){console.error("Erreur lors de la restauration après échec:",D)}}},"changeBaseMap","useMapState"),_=Ct.createAsyncPerformanceTracker(async()=>{if(!(!t.value||!i.value))try{const E=await Ct.measureAsync("searchLocation:fetchData",async()=>await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(i.value)}`),"useMapState"),b=await Ct.measureAsync("searchLocation:parseResponse",async()=>await E.json(),"useMapState");b&&b.length>0&&Ct.measure("searchLocation:updateView",()=>{const{lat:D,lon:$}=b[0];t.value.setView([D,$],13,{animate:r.value!=="Cadastre"})},"useMapState")}catch(E){console.error("Erreur lors de la recherche de localisation:",E)}},"searchLocation","useMapState");return{map:t,searchQuery:i,currentBaseMap:r,baseMaps:h,initMap:g,searchLocation:_,changeBaseMap:v,cleanup:()=>{const E=n("cleanup","useMapState");t.value&&(t.value.remove(),t.value=null),o.value&&(o.value=null),E()},isPerformanceEnabled:e}}const Lm=Np("irrigation",{state:()=>({plans:[],currentPlan:null,loading:!1,error:null,autoSaveInterval:null,unsavedChanges:!1,planHistory:[],performanceMonitor:Xh()}),getters:{getPlanById:e=>n=>e.plans.find(t=>t.id===n),hasUnsavedChanges:e=>e.unsavedChanges,getCurrentPlanHistory:e=>e.planHistory},actions:{async fetchPlans(){var t,i;const e=this.performanceMonitor.startMeasure("fetchPlans","IrrigationStore"),n=Va();this.loading=!0;try{let r="/plans/";const o={};n.isConcessionnaire?o.concessionnaire=(t=n.user)==null?void 0:t.id:n.isAgriculteur&&(o.agriculteur=(i=n.user)==null?void 0:i.id);const l=await this.performanceMonitor.measureAsync("fetchPlans_apiCall",()=>Kn.get(r,{params:o}),"IrrigationStore");this.plans=l.data}catch(r){throw this.error="Erreur lors du chargement des plans",r}finally{this.loading=!1,e()}},async fetchPlansWithDetails(){var t,i;const e=this.performanceMonitor.startMeasure("fetchPlansWithDetails","IrrigationStore"),n=Va();this.loading=!0;try{let r="/plans/";const o={include_details:!0};n.isConcessionnaire?o.concessionnaire=(t=n.user)==null?void 0:t.id:n.isAgriculteur&&(o.agriculteur=(i=n.user)==null?void 0:i.id);const l=await this.performanceMonitor.measureAsync("fetchPlansWithDetails_apiCall",()=>Kn.get(r,{params:o}),"IrrigationStore"),h=this.performanceMonitor.measure("fetchPlansWithDetails_processResponse",()=>l.data.map(g=>({...g,usine:typeof g.usine=="object"?g.usine:null,concessionnaire:typeof g.concessionnaire=="object"?g.concessionnaire:null,agriculteur:typeof g.agriculteur=="object"?g.agriculteur:null})),"IrrigationStore");return this.plans=h,{data:h}}catch(r){throw console.error("[IrrigationStore] Error fetching plans:",r),this.error="Erreur lors du chargement des plans",r}finally{this.loading=!1,e()}},async fetchClientPlans(e){this.loading=!0;try{return(await Pd.getAgriculteurPlans(e)).data}catch(n){throw this.error="Erreur lors du chargement des plans du client",n}finally{this.loading=!1}},async createPlan(e){var i;const n=this.performanceMonitor.startMeasure("createPlan","IrrigationStore");this.clearCurrentPlan(),this.loading=!0;const t=Rf();try{const r=Va();((i=r.user)==null?void 0:i.user_type)==="agriculteur"&&(e={...e,agriculteur:r.user.id,concessionnaire:r.user.concessionnaire,usine:r.user.usine});const o=this.performanceMonitor.measure("createPlan_formatData",()=>({...e,usine:e.usine?typeof e.usine=="object"&&e.usine&&"id"in e.usine?e.usine.id:Number(e.usine):null,concessionnaire:e.concessionnaire?typeof e.concessionnaire=="object"&&e.concessionnaire&&"id"in e.concessionnaire?e.concessionnaire.id:Number(e.concessionnaire):null,agriculteur:e.agriculteur?typeof e.agriculteur=="object"&&e.agriculteur&&"id"in e.agriculteur?e.agriculteur.id:Number(e.agriculteur):null}),"IrrigationStore"),l=await this.performanceMonitor.measureAsync("createPlan_apiCall",()=>Pd.createPlan(o),"IrrigationStore");return this.plans.push(l.data),t.success(`Le plan "${l.data.nom}" a été créé avec succès`),l.data}catch(r){const o=r instanceof Error?r.message:String(r);throw console.error("Error creating plan:",o),this.error=o,t.error(`Erreur lors de la création du plan : ${o}`),r}finally{this.loading=!1,n()}},async createPlanForClient(e,n){this.clearCurrentPlan(),this.loading=!0;try{const t={...e,agriculteur:n},i=await Pd.createPlanForAgriculteur(t);return this.plans.push(i.data),i.data}catch(t){const i=t instanceof Error?t.message:String(t);throw console.error("Error creating plan for client:",i),this.error="Erreur lors de la création du plan pour le client",t}finally{this.loading=!1}},startAutoSave(){this.autoSaveInterval||(this.autoSaveInterval=setInterval(async()=>{this.unsavedChanges&&this.currentPlan&&await this.savePlan(this.currentPlan.id)},3e4))},stopAutoSave(){this.autoSaveInterval&&(clearInterval(this.autoSaveInterval),this.autoSaveInterval=null)},async savePlan(e){const n=this.performanceMonitor.startMeasure("savePlan","IrrigationStore");if(!this.unsavedChanges){console.log("[IrrigationStore][savePlan] Aucun changement à sauvegarder"),n();return}this.loading=!0;try{const t=await this.performanceMonitor.measureAsync("savePlan_apiCall",()=>{var i;return Kn.patch(`/plans/${e}/`,{...this.currentPlan,version:((i=this.currentPlan)==null?void 0:i.version)||1})},"IrrigationStore");return this.performanceMonitor.measure("savePlan_updateState",()=>{var r;const i=this.plans.findIndex(o=>o.id===e);i!==-1&&(this.plans[i]=t.data),((r=this.currentPlan)==null?void 0:r.id)===e&&(this.currentPlan=t.data)},"IrrigationStore"),this.unsavedChanges=!1,t.data}catch(t){throw console.error("[IrrigationStore][savePlan] ERREUR:",t),this.error="Erreur lors de la sauvegarde du plan",t}finally{this.loading=!1,n()}},async updatePlanDetails(e,n){const t=this.performanceMonitor.startMeasure("updatePlanDetails","IrrigationStore"),i=Rf();try{const r=await this.performanceMonitor.measureAsync("updatePlanDetails_apiCall",()=>{const{agriculteur_id:o,concessionnaire_id:l,usine_id:h,...g}=n,v={...g};return o!==void 0&&(v.agriculteur_id=o),l!==void 0&&(v.concessionnaire_id=l),h!==void 0&&(v.usine_id=h),Kn.patch(`/plans/${e}/`,v)},"IrrigationStore");return this.performanceMonitor.measure("updatePlanDetails_updateState",()=>{this.currentPlan&&this.currentPlan.id===e&&(this.currentPlan={...this.currentPlan,...r.data});const o=this.plans.findIndex(l=>l.id===e);o!==-1&&(this.plans[o]={...this.plans[o],...r.data})},"IrrigationStore"),r.data}catch(r){throw console.error("Erreur lors de la mise à jour du plan:",r),i.error(`Erreur lors de la mise à jour du plan : ${r instanceof Error?r.message:String(r)}`),r}finally{t()}},async fetchPlanHistory(e){this.loading=!0;try{const n=await Kn.get(`/plans/${e}/historique/`);return this.planHistory=n.data,n.data}catch(n){throw this.error="Erreur lors de la récupération de l'historique",n}finally{this.loading=!1}},async restorePlanVersion(e,n){var t;this.loading=!0;try{const i=await Kn.post(`/plans/${e}/restaurer/`,{version_id:n});((t=this.currentPlan)==null?void 0:t.id)===e&&(this.currentPlan=i.data);const r=this.plans.findIndex(o=>o.id===e);return r!==-1&&(this.plans[r]=i.data),i.data}catch(i){throw this.error="Erreur lors de la restauration de la version",i}finally{this.loading=!1}},setCurrentPlan(e){this.currentPlan=e,this.startAutoSave()},clearCurrentPlan(){this.currentPlan=null,this.unsavedChanges=!1,this.autoSaveInterval&&(clearInterval(this.autoSaveInterval),this.autoSaveInterval=null)},markUnsavedChanges(){this.unsavedChanges=!0},async deletePlan(e){var t;this.loading=!0;const n=Rf();try{const i=this.plans.find(r=>r.id===e);await Pd.deletePlan(e),this.plans=this.plans.filter(r=>r.id!==e),((t=this.currentPlan)==null?void 0:t.id)===e&&this.clearCurrentPlan(),n.success(`Le plan "${(i==null?void 0:i.nom)||""}" a été supprimé avec succès`)}catch(i){throw this.error="Erreur lors de la suppression du plan",n.error(`Erreur lors de la suppression du plan : ${i instanceof Error?i.message:String(i)}`),i}finally{this.loading=!1}}}}),u7={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center z-[9999] p-4 overflow-y-auto"},c7={class:"bg-white rounded-lg p-6 max-w-2xl w-full my-8 relative"},h7={class:"overflow-y-auto max-h-[calc(100vh-12rem)]"},f7={key:0,class:"mb-4"},d7={key:0,class:"animate-pulse"},p7=["value"],g7={key:1,class:"mb-4"},m7={key:0,class:"animate-pulse"},v7=["disabled"],y7={value:null},_7=["value"],b7={key:2,class:"mb-4"},w7={key:0,class:"animate-pulse"},x7=["disabled"],L7={value:null},C7=["value"],S7={class:"mb-4"},P7={class:"mb-6"},E7={class:"flex justify-end space-x-3"},A7=["disabled"],M7={key:0},k7={key:1},L4=Pa({__name:"NewPlanModal",props:{modelValue:{type:Boolean}},emits:["update:modelValue","created","concessionnaireSelected","clientSelected"],setup(e,{expose:n,emit:t}){function i(J){return J?typeof J=="object"?J.id:J:null}function r(J){if(J===null)throw new Error("Invalid ID");return J}const o=e,l=t,h=Va(),g=Lm(),v=x4(),_=un(!1),x=un(null),E=un([]),b=un([]),D=un([]),$=un(null),Q=un(null),F=un(!1),G=un(!1),me=un(!1),Se=un({nom:"",description:"",usine:null,concessionnaire:null,client:null}),Ie=Ni(()=>{var J,V,U;return((J=h.user)==null?void 0:J.user_type)==="admin"?Se.value.nom.trim()&&Se.value.usine&&Se.value.concessionnaire&&Se.value.client:((V=h.user)==null?void 0:V.user_type)==="usine"?Se.value.nom.trim()&&Se.value.concessionnaire&&Se.value.client:((U=h.user)==null?void 0:U.user_type)==="concessionnaire"?Se.value.nom.trim()&&Se.value.client:Se.value.nom.trim()});So(()=>Se.value.usine,async J=>{if(!o.modelValue)return;Se.value.concessionnaire=null,Se.value.client=null,b.value=[];const V=i(J);V?await nt(V):E.value=[]}),So(()=>Se.value.concessionnaire,async J=>{if(!o.modelValue)return;Se.value.client=null;const V=i(J);V?await Ve(V):b.value=[]}),So(()=>o.modelValue,J=>{var V,U,Y;J?((V=h.user)==null?void 0:V.user_type)==="admin"?z():((U=h.user)==null?void 0:U.user_type)==="usine"?nt(h.user.id):((Y=h.user)==null?void 0:Y.user_type)==="concessionnaire"&&Ve(h.user.id):(Se.value={nom:"",description:"",usine:null,concessionnaire:null,client:null},$.value=null,Q.value=null,b.value=[],E.value=[],D.value=[],x.value=null)});async function nt(J){F.value=!0;try{if(J)E.value=await h.fetchUsineConcessionnaires(J);else{const V=await Wl.getConcessionnaires();E.value=V.data}}catch(V){console.error("[NewPlanModal] Error loading concessionnaires:",V),E.value=[]}finally{F.value=!1}}async function Ve(J){G.value=!0;try{b.value=await h.fetchConcessionnaireAgriculteurs(J)}catch(V){console.error("[NewPlanModal] Error loading clients:",V),b.value=[]}finally{G.value=!1}}async function O(J){o.modelValue&&($.value=J,Se.value.concessionnaire=J.id,await Ve(J.id),l("concessionnaireSelected",J))}function W(J){o.modelValue&&(Q.value=J,Se.value.client=J.id,l("clientSelected",J))}function ue(){l("update:modelValue",!1),Se.value={nom:"",description:"",usine:null,concessionnaire:null,client:null},$.value=null,Q.value=null,b.value=[],x.value=null}async function z(){me.value=!0;try{D.value=await h.fetchUsines()}catch(J){console.error("[NewPlanModal] Error loading usines:",J),D.value=[]}finally{me.value=!1}}async function R(){var J,V;x.value=null,_.value=!0;try{const U={nom:Se.value.nom.trim(),description:Se.value.description.trim()},Y=h.user;if(!Y)throw new Error("User not found");if(Y.user_type==="admin"){if(!Se.value.usine||!Se.value.concessionnaire||!Se.value.client)throw new Error("Missing required fields");U.usine=r(i(Se.value.usine)),U.concessionnaire=r(i(Se.value.concessionnaire)),U.agriculteur=Se.value.client}else if(Y.user_type==="usine"){if(!Se.value.concessionnaire||!Se.value.client)throw new Error("Missing required fields");U.usine=Y.id,U.concessionnaire=r(i(Se.value.concessionnaire)),U.agriculteur=Se.value.client}else if(Y.user_type==="concessionnaire"){if(!Y.usine||!Se.value.client)throw new Error("Missing required fields");U.usine=r(i(Y.usine)),U.concessionnaire=Y.id,U.agriculteur=Se.value.client}else if(Y.user_type==="agriculteur"){if(!Y.usine||!Y.concessionnaire)throw new Error("Missing required fields");U.usine=r(i(Y.usine)),U.concessionnaire=r(i(Y.concessionnaire)),U.agriculteur=Y.id}console.log("Données du plan à créer:",U),g.clearCurrentPlan(),v.setCurrentPlan(null);const ce=await g.createPlan(U);l("created",ce.id),ue()}catch(U){console.error("[NewPlanModal] Error creating plan:",U),console.error("Response data:",(J=U.response)==null?void 0:J.data);let Y="Une erreur est survenue lors de la création du plan";(V=U.response)!=null&&V.data&&(typeof U.response.data=="object"?Y=Object.entries(U.response.data).map(([ce,re])=>Array.isArray(re)?`${ce}: ${re.join(", ")}`:`${ce}: ${re}`).join(`
`):typeof U.response.data=="string"&&(Y=U.response.data)),x.value=Y}finally{_.value=!1}}return n({concessionnaires:E,concessionnaireClients:b,selectedConcessionnaire:$,selectedClient:Q,loadConcessionnaires:nt,loadConcessionnaireClients:Ve,selectConcessionnaire:O,selectClient:W}),(J,V)=>{var U,Y,ce,re;return J.modelValue?(Ye(),tt("div",u7,[M("div",c7,[M("div",{class:"flex justify-between items-center mb-4 sticky top-0 bg-white pb-4 border-b"},[V[6]||(V[6]=M("h2",{class:"text-xl font-semibold text-gray-900"},"Créer un nouveau plan",-1)),M("button",{onClick:ue,class:"text-gray-400 hover:text-gray-500"},V[5]||(V[5]=[M("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),M("div",h7,[Wn(h).isAdmin?(Ye(),tt("div",f7,[V[9]||(V[9]=M("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Usine",-1)),me.value?(Ye(),tt("div",d7,V[7]||(V[7]=[M("div",{class:"h-10 bg-gray-200 rounded"},null,-1)]))):Dn((Ye(),tt("select",{key:1,"onUpdate:modelValue":V[0]||(V[0]=Pe=>Se.value.usine=Pe),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"},[V[8]||(V[8]=M("option",{value:null},"Sélectionnez une usine",-1)),(Ye(!0),tt(zn,null,Ti(D.value,Pe=>(Ye(),tt("option",{key:Pe.id,value:Pe.id},Ht(Wn(ol)(Pe)),9,p7))),128))],512)),[[Ws,Se.value.usine]])])):wn("",!0),((U=Wn(h).user)==null?void 0:U.user_type)==="admin"||((Y=Wn(h).user)==null?void 0:Y.user_type)==="usine"?(Ye(),tt("div",g7,[V[11]||(V[11]=M("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Concessionnaire",-1)),F.value?(Ye(),tt("div",m7,V[10]||(V[10]=[M("div",{class:"h-10 bg-gray-200 rounded"},null,-1)]))):Dn((Ye(),tt("select",{key:1,id:"edit-concessionnaire","onUpdate:modelValue":V[1]||(V[1]=Pe=>Se.value.concessionnaire=Pe),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:!E.value.length||Wn(h).isAdmin&&!Se.value.usine},[M("option",y7,Ht(E.value.length?"Sélectionnez un concessionnaire":"Aucun concessionnaire disponible"),1),(Ye(!0),tt(zn,null,Ti(E.value,Pe=>(Ye(),tt("option",{key:Pe.id,value:Pe.id},Ht(Wn(ol)(Pe)),9,_7))),128))],8,v7)),[[Ws,Se.value.concessionnaire]])])):wn("",!0),((ce=Wn(h).user)==null?void 0:ce.user_type)!=="agriculteur"?(Ye(),tt("div",b7,[V[13]||(V[13]=M("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Agriculteur",-1)),G.value?(Ye(),tt("div",w7,V[12]||(V[12]=[M("div",{class:"h-10 bg-gray-200 rounded"},null,-1)]))):Dn((Ye(),tt("select",{key:1,id:"edit-agriculteur","onUpdate:modelValue":V[2]||(V[2]=Pe=>Se.value.client=Pe),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:!b.value.length||((re=Wn(h).user)==null?void 0:re.user_type)!=="concessionnaire"&&!Se.value.concessionnaire},[M("option",L7,Ht(b.value.length?"Sélectionnez un agriculteur":"Aucun agriculteur disponible"),1),(Ye(!0),tt(zn,null,Ti(b.value,Pe=>(Ye(),tt("option",{key:Pe.id,value:Pe.id},Ht(Wn(ol)(Pe)),9,C7))),128))],8,x7)),[[Ws,Se.value.client]])])):wn("",!0),M("div",S7,[V[14]||(V[14]=M("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nom du plan",-1)),Dn(M("input",{id:"edit-nom","onUpdate:modelValue":V[3]||(V[3]=Pe=>Se.value.nom=Pe),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Entrez le nom du plan"},null,512),[[ki,Se.value.nom]])]),M("div",P7,[V[15]||(V[15]=M("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description",-1)),Dn(M("textarea",{id:"edit-description","onUpdate:modelValue":V[4]||(V[4]=Pe=>Se.value.description=Pe),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",rows:"3",placeholder:"Entrez une description (optionnel)"},null,512),[[ki,Se.value.description]])]),M("div",E7,[M("button",{onClick:ue,class:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500"}," Annuler "),M("button",{onClick:R,class:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:!Ie.value||_.value},[_.value?(Ye(),tt("span",M7,"Création en cours...")):(Ye(),tt("span",k7,"Créer"))],8,A7)])])])])):wn("",!0)}}});function Mr(e){"@babel/helpers - typeof";return Mr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Mr(e)}var ua=Uint8Array,ll=Uint16Array,Cm=Int32Array,Vp=new ua([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Gp=new ua([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Fg=new ua([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),C4=function(e,n){for(var t=new ll(31),i=0;i<31;++i)t[i]=n+=1<<e[i-1];for(var r=new Cm(t[30]),i=1;i<30;++i)for(var o=t[i];o<t[i+1];++o)r[o]=o-t[i]<<5|i;return{b:t,r}},S4=C4(Vp,2),P4=S4.b,zg=S4.r;P4[28]=258,zg[258]=28;var E4=C4(Gp,0),T7=E4.b,Ay=E4.r,jg=new ll(32768);for(var is=0;is<32768;++is){var cc=(is&43690)>>1|(is&21845)<<1;cc=(cc&52428)>>2|(cc&13107)<<2,cc=(cc&61680)>>4|(cc&3855)<<4,jg[is]=((cc&65280)>>8|(cc&255)<<8)>>1}var Pu=function(e,n,t){for(var i=e.length,r=0,o=new ll(n);r<i;++r)e[r]&&++o[e[r]-1];var l=new ll(n);for(r=1;r<n;++r)l[r]=l[r-1]+o[r-1]<<1;var h;if(t){h=new ll(1<<n);var g=15-n;for(r=0;r<i;++r)if(e[r])for(var v=r<<4|e[r],_=n-e[r],x=l[e[r]-1]++<<_,E=x|(1<<_)-1;x<=E;++x)h[jg[x]>>g]=v}else for(h=new ll(i),r=0;r<i;++r)e[r]&&(h[r]=jg[l[e[r]-1]++]>>15-e[r]);return h},Sc=new ua(288);for(var is=0;is<144;++is)Sc[is]=8;for(var is=144;is<256;++is)Sc[is]=9;for(var is=256;is<280;++is)Sc[is]=7;for(var is=280;is<288;++is)Sc[is]=8;var Wf=new ua(32);for(var is=0;is<32;++is)Wf[is]=5;var B7=Pu(Sc,9,0),N7=Pu(Sc,9,1),R7=Pu(Wf,5,0),D7=Pu(Wf,5,1),G0=function(e){for(var n=e[0],t=1;t<e.length;++t)e[t]>n&&(n=e[t]);return n},Gl=function(e,n,t){var i=n/8|0;return(e[i]|e[i+1]<<8)>>(n&7)&t},H0=function(e,n){var t=n/8|0;return(e[t]|e[t+1]<<8|e[t+2]<<16)>>(n&7)},Sm=function(e){return(e+7)/8|0},A4=function(e,n,t){return(t==null||t>e.length)&&(t=e.length),new ua(e.subarray(n,t))},O7=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Zl=function(e,n,t){var i=new Error(n||O7[e]);if(i.code=e,Error.captureStackTrace&&Error.captureStackTrace(i,Zl),!t)throw i;return i},I7=function(e,n,t,i){var r=e.length,o=0;if(!r||n.f&&!n.l)return t||new ua(0);var l=!t,h=l||n.i!=2,g=n.i;l&&(t=new ua(r*3));var v=function(Ce){var ne=t.length;if(Ce>ne){var ae=new ua(Math.max(ne*2,Ce));ae.set(t),t=ae}},_=n.f||0,x=n.p||0,E=n.b||0,b=n.l,D=n.d,$=n.m,Q=n.n,F=r*8;do{if(!b){_=Gl(e,x,1);var G=Gl(e,x+1,3);if(x+=3,G)if(G==1)b=N7,D=D7,$=9,Q=5;else if(G==2){var nt=Gl(e,x,31)+257,Ve=Gl(e,x+10,15)+4,O=nt+Gl(e,x+5,31)+1;x+=14;for(var W=new ua(O),ue=new ua(19),z=0;z<Ve;++z)ue[Fg[z]]=Gl(e,x+z*3,7);x+=Ve*3;for(var R=G0(ue),J=(1<<R)-1,V=Pu(ue,R,1),z=0;z<O;){var U=V[Gl(e,x,J)];x+=U&15;var me=U>>4;if(me<16)W[z++]=me;else{var Y=0,ce=0;for(me==16?(ce=3+Gl(e,x,3),x+=2,Y=W[z-1]):me==17?(ce=3+Gl(e,x,7),x+=3):me==18&&(ce=11+Gl(e,x,127),x+=7);ce--;)W[z++]=Y}}var re=W.subarray(0,nt),Pe=W.subarray(nt);$=G0(re),Q=G0(Pe),b=Pu(re,$,1),D=Pu(Pe,Q,1)}else Zl(1);else{var me=Sm(x)+4,Se=e[me-4]|e[me-3]<<8,Ie=me+Se;if(Ie>r){g&&Zl(0);break}h&&v(E+Se),t.set(e.subarray(me,Ie),E),n.b=E+=Se,n.p=x=Ie*8,n.f=_;continue}if(x>F){g&&Zl(0);break}}h&&v(E+131072);for(var Me=(1<<$)-1,ot=(1<<Q)-1,X=x;;X=x){var Y=b[H0(e,x)&Me],Ee=Y>>4;if(x+=Y&15,x>F){g&&Zl(0);break}if(Y||Zl(2),Ee<256)t[E++]=Ee;else if(Ee==256){X=x,b=null;break}else{var B=Ee-254;if(Ee>264){var z=Ee-257,H=Vp[z];B=Gl(e,x,(1<<H)-1)+P4[z],x+=H}var he=D[H0(e,x)&ot],te=he>>4;he||Zl(3),x+=he&15;var Pe=T7[te];if(te>3){var H=Gp[te];Pe+=H0(e,x)&(1<<H)-1,x+=H}if(x>F){g&&Zl(0);break}h&&v(E+131072);var ie=E+B;if(E<Pe){var ee=o-Pe,se=Math.min(Pe,ie);for(ee+E<0&&Zl(3);E<se;++E)t[E]=i[ee+E]}for(;E<ie;++E)t[E]=t[E-Pe]}}n.l=b,n.p=X,n.b=E,n.f=_,b&&(_=1,n.m=$,n.d=D,n.n=Q)}while(!_);return E!=t.length&&l?A4(t,0,E):t.subarray(0,E)},Wu=function(e,n,t){t<<=n&7;var i=n/8|0;e[i]|=t,e[i+1]|=t>>8},mf=function(e,n,t){t<<=n&7;var i=n/8|0;e[i]|=t,e[i+1]|=t>>8,e[i+2]|=t>>16},W0=function(e,n){for(var t=[],i=0;i<e.length;++i)e[i]&&t.push({s:i,f:e[i]});var r=t.length,o=t.slice();if(!r)return{t:k4,l:0};if(r==1){var l=new ua(t[0].s+1);return l[t[0].s]=1,{t:l,l:1}}t.sort(function(Ie,nt){return Ie.f-nt.f}),t.push({s:-1,f:25001});var h=t[0],g=t[1],v=0,_=1,x=2;for(t[0]={s:-1,f:h.f+g.f,l:h,r:g};_!=r-1;)h=t[t[v].f<t[x].f?v++:x++],g=t[v!=_&&t[v].f<t[x].f?v++:x++],t[_++]={s:-1,f:h.f+g.f,l:h,r:g};for(var E=o[0].s,i=1;i<r;++i)o[i].s>E&&(E=o[i].s);var b=new ll(E+1),D=Ug(t[_-1],b,0);if(D>n){var i=0,$=0,Q=D-n,F=1<<Q;for(o.sort(function(nt,Ve){return b[Ve.s]-b[nt.s]||nt.f-Ve.f});i<r;++i){var G=o[i].s;if(b[G]>n)$+=F-(1<<D-b[G]),b[G]=n;else break}for($>>=Q;$>0;){var me=o[i].s;b[me]<n?$-=1<<n-b[me]++-1:++i}for(;i>=0&&$;--i){var Se=o[i].s;b[Se]==n&&(--b[Se],++$)}D=n}return{t:new ua(b),l:D}},Ug=function(e,n,t){return e.s==-1?Math.max(Ug(e.l,n,t+1),Ug(e.r,n,t+1)):n[e.s]=t},My=function(e){for(var n=e.length;n&&!e[--n];);for(var t=new ll(++n),i=0,r=e[0],o=1,l=function(g){t[i++]=g},h=1;h<=n;++h)if(e[h]==r&&h!=n)++o;else{if(!r&&o>2){for(;o>138;o-=138)l(32754);o>2&&(l(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(l(r),--o;o>6;o-=6)l(8304);o>2&&(l(o-3<<5|8208),o=0)}for(;o--;)l(r);o=1,r=e[h]}return{c:t.subarray(0,i),n}},vf=function(e,n){for(var t=0,i=0;i<n.length;++i)t+=e[i]*n[i];return t},M4=function(e,n,t){var i=t.length,r=Sm(n+2);e[r]=i&255,e[r+1]=i>>8,e[r+2]=e[r]^255,e[r+3]=e[r+1]^255;for(var o=0;o<i;++o)e[r+o+4]=t[o];return(r+4+i)*8},ky=function(e,n,t,i,r,o,l,h,g,v,_){Wu(n,_++,t),++r[256];for(var x=W0(r,15),E=x.t,b=x.l,D=W0(o,15),$=D.t,Q=D.l,F=My(E),G=F.c,me=F.n,Se=My($),Ie=Se.c,nt=Se.n,Ve=new ll(19),O=0;O<G.length;++O)++Ve[G[O]&31];for(var O=0;O<Ie.length;++O)++Ve[Ie[O]&31];for(var W=W0(Ve,7),ue=W.t,z=W.l,R=19;R>4&&!ue[Fg[R-1]];--R);var J=v+5<<3,V=vf(r,Sc)+vf(o,Wf)+l,U=vf(r,E)+vf(o,$)+l+14+3*R+vf(Ve,ue)+2*Ve[16]+3*Ve[17]+7*Ve[18];if(g>=0&&J<=V&&J<=U)return M4(n,_,e.subarray(g,g+v));var Y,ce,re,Pe;if(Wu(n,_,1+(U<V)),_+=2,U<V){Y=Pu(E,b,0),ce=E,re=Pu($,Q,0),Pe=$;var Me=Pu(ue,z,0);Wu(n,_,me-257),Wu(n,_+5,nt-1),Wu(n,_+10,R-4),_+=14;for(var O=0;O<R;++O)Wu(n,_+3*O,ue[Fg[O]]);_+=3*R;for(var ot=[G,Ie],X=0;X<2;++X)for(var Ee=ot[X],O=0;O<Ee.length;++O){var B=Ee[O]&31;Wu(n,_,Me[B]),_+=ue[B],B>15&&(Wu(n,_,Ee[O]>>5&127),_+=Ee[O]>>12)}}else Y=B7,ce=Sc,re=R7,Pe=Wf;for(var O=0;O<h;++O){var H=i[O];if(H>255){var B=H>>18&31;mf(n,_,Y[B+257]),_+=ce[B+257],B>7&&(Wu(n,_,H>>23&31),_+=Vp[B]);var he=H&31;mf(n,_,re[he]),_+=Pe[he],he>3&&(mf(n,_,H>>5&8191),_+=Gp[he])}else mf(n,_,Y[H]),_+=ce[H]}return mf(n,_,Y[256]),_+ce[256]},F7=new Cm([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),k4=new ua(0),z7=function(e,n,t,i,r,o){var l=o.z||e.length,h=new ua(i+l+5*(1+Math.ceil(l/7e3))+r),g=h.subarray(i,h.length-r),v=o.l,_=(o.r||0)&7;if(n){_&&(g[0]=o.r>>3);for(var x=F7[n-1],E=x>>13,b=x&8191,D=(1<<t)-1,$=o.p||new ll(32768),Q=o.h||new ll(D+1),F=Math.ceil(t/3),G=2*F,me=function(xe){return(e[xe]^e[xe+1]<<F^e[xe+2]<<G)&D},Se=new Cm(25e3),Ie=new ll(288),nt=new ll(32),Ve=0,O=0,W=o.i||0,ue=0,z=o.w||0,R=0;W+2<l;++W){var J=me(W),V=W&32767,U=Q[J];if($[V]=U,Q[J]=V,z<=W){var Y=l-W;if((Ve>7e3||ue>24576)&&(Y>423||!v)){_=ky(e,g,0,Se,Ie,nt,O,ue,R,W-R,_),ue=Ve=O=0,R=W;for(var ce=0;ce<286;++ce)Ie[ce]=0;for(var ce=0;ce<30;++ce)nt[ce]=0}var re=2,Pe=0,Me=b,ot=V-U&32767;if(Y>2&&J==me(W-ot))for(var X=Math.min(E,Y)-1,Ee=Math.min(32767,W),B=Math.min(258,Y);ot<=Ee&&--Me&&V!=U;){if(e[W+re]==e[W+re-ot]){for(var H=0;H<B&&e[W+H]==e[W+H-ot];++H);if(H>re){if(re=H,Pe=ot,H>X)break;for(var he=Math.min(ot,H-2),te=0,ce=0;ce<he;++ce){var ie=W-ot+ce&32767,ee=$[ie],se=ie-ee&32767;se>te&&(te=se,U=ie)}}}V=U,U=$[V],ot+=V-U&32767}if(Pe){Se[ue++]=268435456|zg[re]<<18|Ay[Pe];var Ce=zg[re]&31,ne=Ay[Pe]&31;O+=Vp[Ce]+Gp[ne],++Ie[257+Ce],++nt[ne],z=W+re,++Ve}else Se[ue++]=e[W],++Ie[e[W]]}}for(W=Math.max(W,z);W<l;++W)Se[ue++]=e[W],++Ie[e[W]];_=ky(e,g,v,Se,Ie,nt,O,ue,R,W-R,_),v||(o.r=_&7|g[_/8|0]<<3,_-=7,o.h=Q,o.p=$,o.i=W,o.w=z)}else{for(var W=o.w||0;W<l+v;W+=65535){var ae=W+65535;ae>=l&&(g[_/8|0]=v,ae=l),_=M4(g,_+1,e.subarray(W,ae))}o.i=l}return A4(h,0,i+Sm(_)+r)},T4=function(){var e=1,n=0;return{p:function(t){for(var i=e,r=n,o=t.length|0,l=0;l!=o;){for(var h=Math.min(l+2655,o);l<h;++l)r+=i+=t[l];i=(i&65535)+15*(i>>16),r=(r&65535)+15*(r>>16)}e=i,n=r},d:function(){return e%=65521,n%=65521,(e&255)<<24|(e&65280)<<8|(n&255)<<8|n>>8}}},j7=function(e,n,t,i,r){if(!r&&(r={l:1},n.dictionary)){var o=n.dictionary.subarray(-32768),l=new ua(o.length+e.length);l.set(o),l.set(e,o.length),e=l,r.w=o.length}return z7(e,n.level==null?6:n.level,n.mem==null?r.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+n.mem,t,i,r)},B4=function(e,n,t){for(;t;++n)e[n]=t,t>>>=8},U7=function(e,n){var t=n.level,i=t==0?0:t<6?1:t==9?3:2;if(e[0]=120,e[1]=i<<6|(n.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,n.dictionary){var r=T4();r.p(n.dictionary),B4(e,2,r.d())}},$7=function(e,n){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&Zl(6,"invalid zlib data"),(e[1]>>5&1)==1&&Zl(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function $g(e,n){n||(n={});var t=T4();t.p(e);var i=j7(e,n,n.dictionary?6:2,4);return U7(i,n),B4(i,i.length-4,t.d()),i}function q7(e,n){return I7(e.subarray($7(e),-4),{i:2},n,n)}var V7=typeof TextDecoder<"u"&&new TextDecoder,G7=0;try{V7.decode(k4,{stream:!0}),G7=1}catch{}var fi=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Z0(){fi.console&&typeof fi.console.log=="function"&&fi.console.log.apply(fi.console,arguments)}var zr={log:Z0,warn:function(e){fi.console&&(typeof fi.console.warn=="function"?fi.console.warn.apply(fi.console,arguments):Z0.call(null,arguments))},error:function(e){fi.console&&(typeof fi.console.error=="function"?fi.console.error.apply(fi.console,arguments):Z0(e))}};function K0(e,n,t){var i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.onload=function(){Hc(i.response,n,t)},i.onerror=function(){zr.error("could not download file")},i.send()}function Ty(e){var n=new XMLHttpRequest;n.open("HEAD",e,!1);try{n.send()}catch{}return n.status>=200&&n.status<=299}function Md(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(n)}}var Of,qg,Hc=fi.saveAs||((typeof window>"u"?"undefined":Mr(window))!=="object"||window!==fi?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,n,t){var i=fi.URL||fi.webkitURL,r=document.createElement("a");n=n||e.name||"download",r.download=n,r.rel="noopener",typeof e=="string"?(r.href=e,r.origin!==location.origin?Ty(r.href)?K0(e,n,t):Md(r,r.target="_blank"):Md(r)):(r.href=i.createObjectURL(e),setTimeout(function(){i.revokeObjectURL(r.href)},4e4),setTimeout(function(){Md(r)},0))}:"msSaveOrOpenBlob"in navigator?function(e,n,t){if(n=n||e.name||"download",typeof e=="string")if(Ty(e))K0(e,n,t);else{var i=document.createElement("a");i.href=e,i.target="_blank",setTimeout(function(){Md(i)})}else navigator.msSaveOrOpenBlob(function(r,o){return o===void 0?o={autoBom:!1}:Mr(o)!=="object"&&(zr.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\uFEFF",r],{type:r.type}):r}(e,t),n)}:function(e,n,t,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),typeof e=="string")return K0(e,n,t);var r=e.type==="application/octet-stream",o=/constructor/i.test(fi.HTMLElement)||fi.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||r&&o)&&(typeof FileReader>"u"?"undefined":Mr(FileReader))==="object"){var h=new FileReader;h.onloadend=function(){var _=h.result;_=l?_:_.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=_:location=_,i=null},h.readAsDataURL(e)}else{var g=fi.URL||fi.webkitURL,v=g.createObjectURL(e);i?i.location=v:location.href=v,i=null,setTimeout(function(){g.revokeObjectURL(v)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function N4(e){var n;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(h){return[parseInt(h[1]),parseInt(h[2]),parseInt(h[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(h){return[parseInt(h[1],16),parseInt(h[2],16),parseInt(h[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(h){return[parseInt(h[1]+h[1],16),parseInt(h[2]+h[2],16),parseInt(h[3]+h[3],16)]}}],i=0;i<t.length;i++){var r=t[i].re,o=t[i].process,l=r.exec(e);l&&(n=o(l),this.r=n[0],this.g=n[1],this.b=n[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var h=this.r.toString(16),g=this.g.toString(16),v=this.b.toString(16);return h.length==1&&(h="0"+h),g.length==1&&(g="0"+g),v.length==1&&(v="0"+v),"#"+h+g+v}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function J0(e,n){var t=e[0],i=e[1],r=e[2],o=e[3];t=na(t,i,r,o,n[0],7,-680876936),o=na(o,t,i,r,n[1],12,-389564586),r=na(r,o,t,i,n[2],17,606105819),i=na(i,r,o,t,n[3],22,-1044525330),t=na(t,i,r,o,n[4],7,-176418897),o=na(o,t,i,r,n[5],12,1200080426),r=na(r,o,t,i,n[6],17,-1473231341),i=na(i,r,o,t,n[7],22,-45705983),t=na(t,i,r,o,n[8],7,1770035416),o=na(o,t,i,r,n[9],12,-1958414417),r=na(r,o,t,i,n[10],17,-42063),i=na(i,r,o,t,n[11],22,-1990404162),t=na(t,i,r,o,n[12],7,1804603682),o=na(o,t,i,r,n[13],12,-40341101),r=na(r,o,t,i,n[14],17,-1502002290),t=ia(t,i=na(i,r,o,t,n[15],22,1236535329),r,o,n[1],5,-165796510),o=ia(o,t,i,r,n[6],9,-1069501632),r=ia(r,o,t,i,n[11],14,643717713),i=ia(i,r,o,t,n[0],20,-373897302),t=ia(t,i,r,o,n[5],5,-701558691),o=ia(o,t,i,r,n[10],9,38016083),r=ia(r,o,t,i,n[15],14,-660478335),i=ia(i,r,o,t,n[4],20,-405537848),t=ia(t,i,r,o,n[9],5,568446438),o=ia(o,t,i,r,n[14],9,-1019803690),r=ia(r,o,t,i,n[3],14,-187363961),i=ia(i,r,o,t,n[8],20,1163531501),t=ia(t,i,r,o,n[13],5,-1444681467),o=ia(o,t,i,r,n[2],9,-51403784),r=ia(r,o,t,i,n[7],14,1735328473),t=ra(t,i=ia(i,r,o,t,n[12],20,-1926607734),r,o,n[5],4,-378558),o=ra(o,t,i,r,n[8],11,-2022574463),r=ra(r,o,t,i,n[11],16,1839030562),i=ra(i,r,o,t,n[14],23,-35309556),t=ra(t,i,r,o,n[1],4,-1530992060),o=ra(o,t,i,r,n[4],11,1272893353),r=ra(r,o,t,i,n[7],16,-155497632),i=ra(i,r,o,t,n[10],23,-1094730640),t=ra(t,i,r,o,n[13],4,681279174),o=ra(o,t,i,r,n[0],11,-358537222),r=ra(r,o,t,i,n[3],16,-722521979),i=ra(i,r,o,t,n[6],23,76029189),t=ra(t,i,r,o,n[9],4,-640364487),o=ra(o,t,i,r,n[12],11,-421815835),r=ra(r,o,t,i,n[15],16,530742520),t=sa(t,i=ra(i,r,o,t,n[2],23,-995338651),r,o,n[0],6,-198630844),o=sa(o,t,i,r,n[7],10,1126891415),r=sa(r,o,t,i,n[14],15,-1416354905),i=sa(i,r,o,t,n[5],21,-57434055),t=sa(t,i,r,o,n[12],6,1700485571),o=sa(o,t,i,r,n[3],10,-1894986606),r=sa(r,o,t,i,n[10],15,-1051523),i=sa(i,r,o,t,n[1],21,-2054922799),t=sa(t,i,r,o,n[8],6,1873313359),o=sa(o,t,i,r,n[15],10,-30611744),r=sa(r,o,t,i,n[6],15,-1560198380),i=sa(i,r,o,t,n[13],21,1309151649),t=sa(t,i,r,o,n[4],6,-145523070),o=sa(o,t,i,r,n[11],10,-1120210379),r=sa(r,o,t,i,n[2],15,718787259),i=sa(i,r,o,t,n[9],21,-343485551),e[0]=yc(t,e[0]),e[1]=yc(i,e[1]),e[2]=yc(r,e[2]),e[3]=yc(o,e[3])}function Hp(e,n,t,i,r,o){return n=yc(yc(n,e),yc(i,o)),yc(n<<r|n>>>32-r,t)}function na(e,n,t,i,r,o,l){return Hp(n&t|~n&i,e,n,r,o,l)}function ia(e,n,t,i,r,o,l){return Hp(n&i|t&~i,e,n,r,o,l)}function ra(e,n,t,i,r,o,l){return Hp(n^t^i,e,n,r,o,l)}function sa(e,n,t,i,r,o,l){return Hp(t^(n|~i),e,n,r,o,l)}function R4(e){var n,t=e.length,i=[1732584193,-271733879,-1732584194,271733878];for(n=64;n<=e.length;n+=64)J0(i,H7(e.substring(n-64,n)));e=e.substring(n-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(n=0;n<e.length;n++)r[n>>2]|=e.charCodeAt(n)<<(n%4<<3);if(r[n>>2]|=128<<(n%4<<3),n>55)for(J0(i,r),n=0;n<16;n++)r[n]=0;return r[14]=8*t,J0(i,r),i}function H7(e){var n,t=[];for(n=0;n<64;n+=4)t[n>>2]=e.charCodeAt(n)+(e.charCodeAt(n+1)<<8)+(e.charCodeAt(n+2)<<16)+(e.charCodeAt(n+3)<<24);return t}Of=fi.atob.bind(fi),qg=fi.btoa.bind(fi);var By="0123456789abcdef".split("");function W7(e){for(var n="",t=0;t<4;t++)n+=By[e>>8*t+4&15]+By[e>>8*t&15];return n}function Z7(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Vg(e){return R4(e).map(Z7).join("")}var K7=function(e){for(var n=0;n<e.length;n++)e[n]=W7(e[n]);return e.join("")}(R4("hello"))!="5d41402abc4b2a76b9719d911017c592";function yc(e,n){if(K7){var t=(65535&e)+(65535&n);return(e>>16)+(n>>16)+(t>>16)<<16|65535&t}return e+n&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Gg(e,n){var t,i,r,o;if(e!==t){for(var l=(r=e,o=1+(256/e.length>>0),new Array(o+1).join(r)),h=[],g=0;g<256;g++)h[g]=g;var v=0;for(g=0;g<256;g++){var _=h[g];v=(v+_+l.charCodeAt(g))%256,h[g]=h[v],h[v]=_}t=e,i=h}else h=i;var x=n.length,E=0,b=0,D="";for(g=0;g<x;g++)b=(b+(_=h[E=(E+1)%256]))%256,h[E]=h[b],h[b]=_,l=h[(h[E]+h[b])%256],D+=String.fromCharCode(n.charCodeAt(g)^l);return D}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Ny={print:4,modify:8,copy:16,"annot-forms":32};function Nh(e,n,t,i){this.v=1,this.r=2;var r=192;e.forEach(function(h){if(Ny.perm!==void 0)throw new Error("Invalid permission: "+h);r+=Ny[h]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var o=(n+this.padding).substr(0,32),l=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,l),this.P=-(1+(255^r)),this.encryptionKey=Vg(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(i)).substr(0,5),this.U=Gg(this.encryptionKey,this.padding)}function Rh(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var n="",t=e.length,i=0;i<t;i++){var r=e.charCodeAt(i);r<33||r===35||r===37||r===40||r===41||r===47||r===60||r===62||r===91||r===93||r===123||r===125||r>126?n+="#"+("0"+r.toString(16)).slice(-2):n+=e[i]}return n}function Ry(e){if(Mr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var n={};this.subscribe=function(t,i,r){if(r=r||!1,typeof t!="string"||typeof i!="function"||typeof r!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");n.hasOwnProperty(t)||(n[t]={});var o=Math.random().toString(35);return n[t][o]=[i,!!r],o},this.unsubscribe=function(t){for(var i in n)if(n[i][t])return delete n[i][t],Object.keys(n[i]).length===0&&delete n[i],!0;return!1},this.publish=function(t){if(n.hasOwnProperty(t)){var i=Array.prototype.slice.call(arguments,1),r=[];for(var o in n[t]){var l=n[t][o];try{l[0].apply(e,i)}catch(h){fi.console&&zr.error("jsPDF PubSub Error",h.message,h)}l[1]&&r.push(o)}r.length&&r.forEach(this.unsubscribe)}},this.getTopics=function(){return n}}function vp(e){if(!(this instanceof vp))return new vp(e);var n="opacity,stroke-opacity".split(",");for(var t in e)e.hasOwnProperty(t)&&n.indexOf(t)>=0&&(this[t]=e[t]);this.id="",this.objectNumber=-1}function D4(e,n){this.gState=e,this.matrix=n,this.id="",this.objectNumber=-1}function Kc(e,n,t,i,r){if(!(this instanceof Kc))return new Kc(e,n,t,i,r);this.type=e==="axial"?2:3,this.coords=n,this.colors=t,D4.call(this,i,r)}function Dh(e,n,t,i,r){if(!(this instanceof Dh))return new Dh(e,n,t,i,r);this.boundingBox=e,this.xStep=n,this.yStep=t,this.stream="",this.cloneIndex=0,D4.call(this,i,r)}function hi(e){var n,t=typeof arguments[0]=="string"?arguments[0]:"p",i=arguments[1],r=arguments[2],o=arguments[3],l=[],h=1,g=16,v="S",_=null;Mr(e=e||{})==="object"&&(t=e.orientation,i=e.unit||i,r=e.format||r,o=e.compress||e.compressPdf||o,(_=e.encryption||null)!==null&&(_.userPassword=_.userPassword||"",_.ownerPassword=_.ownerPassword||"",_.userPermissions=_.userPermissions||[]),h=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(n=e.precision),e.floatPrecision!==void 0&&(g=e.floatPrecision),v=e.defaultPathOperation||"S"),l=e.filters||(o===!0?["FlateEncode"]:l),i=i||"mm",t=(""+(t||"P")).toLowerCase();var x=e.putOnlyUsedFonts||!1,E={},b={internal:{},__private__:{}};b.__private__.PubSub=Ry;var D="1.3",$=b.__private__.getPdfVersion=function(){return D};b.__private__.setPdfVersion=function(A){D=A};var Q={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};b.__private__.getPageFormats=function(){return Q};var F=b.__private__.getPageFormat=function(A){return Q[A]};r=r||"a4";var G={COMPAT:"compat",ADVANCED:"advanced"},me=G.COMPAT;function Se(){this.saveGraphicsState(),le(new Nn(Qe,0,0,-Qe,0,Ho()*Qe).toString()+" cm"),this.setFontSize(this.getFontSize()/Qe),v="n",me=G.ADVANCED}function Ie(){this.restoreGraphicsState(),v="S",me=G.COMPAT}var nt=b.__private__.combineFontStyleAndFontWeight=function(A,de){if(A=="bold"&&de=="normal"||A=="bold"&&de==400||A=="normal"&&de=="italic"||A=="bold"&&de=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return de&&(A=de==400||de==="normal"?A==="italic"?"italic":"normal":de!=700&&de!=="bold"||A!=="normal"?(de==700?"bold":de)+""+A:"bold"),A};b.advancedAPI=function(A){var de=me===G.COMPAT;return de&&Se.call(this),typeof A!="function"||(A(this),de&&Ie.call(this)),this},b.compatAPI=function(A){var de=me===G.ADVANCED;return de&&Ie.call(this),typeof A!="function"||(A(this),de&&Se.call(this)),this},b.isAdvancedAPI=function(){return me===G.ADVANCED};var Ve,O=function(A){if(me!==G.ADVANCED)throw new Error(A+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},W=b.roundToPrecision=b.__private__.roundToPrecision=function(A,de){var He=n||de;if(isNaN(A)||isNaN(He))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return A.toFixed(He).replace(/0+$/,"")};Ve=b.hpf=b.__private__.hpf=typeof g=="number"?function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.hpf");return W(A,g)}:g==="smart"?function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.hpf");return W(A,A>-1&&A<1?16:5)}:function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.hpf");return W(A,16)};var ue=b.f2=b.__private__.f2=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.f2");return W(A,2)},z=b.__private__.f3=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.f3");return W(A,3)},R=b.scale=b.__private__.scale=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.scale");return me===G.COMPAT?A*Qe:me===G.ADVANCED?A:void 0},J=function(A){return me===G.COMPAT?Ho()-A:me===G.ADVANCED?A:void 0},V=function(A){return R(J(A))};b.__private__.setPrecision=b.setPrecision=function(A){typeof parseInt(A,10)=="number"&&(n=parseInt(A,10))};var U,Y="00000000000000000000000000000000",ce=b.__private__.getFileId=function(){return Y},re=b.__private__.setFileId=function(A){return Y=A!==void 0&&/^[a-fA-F0-9]{32}$/.test(A)?A.toUpperCase():Y.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),_!==null&&(ts=new Nh(_.userPermissions,_.userPassword,_.ownerPassword,Y)),Y};b.setFileId=function(A){return re(A),this},b.getFileId=function(){return ce()};var Pe=b.__private__.convertDateToPDFDate=function(A){var de=A.getTimezoneOffset(),He=de<0?"+":"-",ct=Math.floor(Math.abs(de/60)),St=Math.abs(de%60),Ft=[He,B(ct),"'",B(St),"'"].join("");return["D:",A.getFullYear(),B(A.getMonth()+1),B(A.getDate()),B(A.getHours()),B(A.getMinutes()),B(A.getSeconds()),Ft].join("")},Me=b.__private__.convertPDFDateToDate=function(A){var de=parseInt(A.substr(2,4),10),He=parseInt(A.substr(6,2),10)-1,ct=parseInt(A.substr(8,2),10),St=parseInt(A.substr(10,2),10),Ft=parseInt(A.substr(12,2),10),sn=parseInt(A.substr(14,2),10);return new Date(de,He,ct,St,Ft,sn,0)},ot=b.__private__.setCreationDate=function(A){var de;if(A===void 0&&(A=new Date),A instanceof Date)de=Pe(A);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(A))throw new Error("Invalid argument passed to jsPDF.setCreationDate");de=A}return U=de},X=b.__private__.getCreationDate=function(A){var de=U;return A==="jsDate"&&(de=Me(U)),de};b.setCreationDate=function(A){return ot(A),this},b.getCreationDate=function(A){return X(A)};var Ee,B=b.__private__.padd2=function(A){return("0"+parseInt(A)).slice(-2)},H=b.__private__.padd2Hex=function(A){return("00"+(A=A.toString())).substr(A.length)},he=0,te=[],ie=[],ee=0,se=[],Ce=[],ne=!1,ae=ie,xe=function(){he=0,ee=0,ie=[],te=[],se=[],tr=yn(),qr=yn()};b.__private__.setCustomOutputDestination=function(A){ne=!0,ae=A};var ye=function(A){ne||(ae=A)};b.__private__.resetCustomOutputDestination=function(){ne=!1,ae=ie};var le=b.__private__.out=function(A){return A=A.toString(),ee+=A.length+1,ae.push(A),ae},je=b.__private__.write=function(A){return le(arguments.length===1?A.toString():Array.prototype.join.call(arguments," "))},Re=b.__private__.getArrayBuffer=function(A){for(var de=A.length,He=new ArrayBuffer(de),ct=new Uint8Array(He);de--;)ct[de]=A.charCodeAt(de);return He},Ae=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];b.__private__.getStandardFonts=function(){return Ae};var qe=e.fontSize||16;b.__private__.setFontSize=b.setFontSize=function(A){return qe=me===G.ADVANCED?A/Qe:A,this};var Oe,et=b.__private__.getFontSize=b.getFontSize=function(){return me===G.COMPAT?qe:qe*Qe},Je=e.R2L||!1;b.__private__.setR2L=b.setR2L=function(A){return Je=A,this},b.__private__.getR2L=b.getR2L=function(){return Je};var mt,_t=b.__private__.setZoomMode=function(A){var de=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(A))Oe=A;else if(isNaN(A)){if(de.indexOf(A)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+A+'" is not recognized.');Oe=A}else Oe=parseInt(A,10)};b.__private__.getZoomMode=function(){return Oe};var $t,Xt=b.__private__.setPageMode=function(A){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(A)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+A+'" is not recognized.');mt=A};b.__private__.getPageMode=function(){return mt};var Xe=b.__private__.setLayoutMode=function(A){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(A)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+A+'" is not recognized.');$t=A};b.__private__.getLayoutMode=function(){return $t},b.__private__.setDisplayMode=b.setDisplayMode=function(A,de,He){return _t(A),Xe(de),Xt(He),this};var Kt={title:"",subject:"",author:"",keywords:"",creator:""};b.__private__.getDocumentProperty=function(A){if(Object.keys(Kt).indexOf(A)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Kt[A]},b.__private__.getDocumentProperties=function(){return Kt},b.__private__.setDocumentProperties=b.setProperties=b.setDocumentProperties=function(A){for(var de in Kt)Kt.hasOwnProperty(de)&&A[de]&&(Kt[de]=A[de]);return this},b.__private__.setDocumentProperty=function(A,de){if(Object.keys(Kt).indexOf(A)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Kt[A]=de};var Qt,Qe,We,Ut,pn,_n={},mn={},rt=[],vn={},ni={},fn={},Mn={},Sr=null,Ii=0,Mt=[],On=new Ry(b),Fi=e.hotfixes||[],zi={},Xr={},$r=[],Nn=function A(de,He,ct,St,Ft,sn){if(!(this instanceof A))return new A(de,He,ct,St,Ft,sn);isNaN(de)&&(de=1),isNaN(He)&&(He=0),isNaN(ct)&&(ct=0),isNaN(St)&&(St=1),isNaN(Ft)&&(Ft=0),isNaN(sn)&&(sn=0),this._matrix=[de,He,ct,St,Ft,sn]};Object.defineProperty(Nn.prototype,"sx",{get:function(){return this._matrix[0]},set:function(A){this._matrix[0]=A}}),Object.defineProperty(Nn.prototype,"shy",{get:function(){return this._matrix[1]},set:function(A){this._matrix[1]=A}}),Object.defineProperty(Nn.prototype,"shx",{get:function(){return this._matrix[2]},set:function(A){this._matrix[2]=A}}),Object.defineProperty(Nn.prototype,"sy",{get:function(){return this._matrix[3]},set:function(A){this._matrix[3]=A}}),Object.defineProperty(Nn.prototype,"tx",{get:function(){return this._matrix[4]},set:function(A){this._matrix[4]=A}}),Object.defineProperty(Nn.prototype,"ty",{get:function(){return this._matrix[5]},set:function(A){this._matrix[5]=A}}),Object.defineProperty(Nn.prototype,"a",{get:function(){return this._matrix[0]},set:function(A){this._matrix[0]=A}}),Object.defineProperty(Nn.prototype,"b",{get:function(){return this._matrix[1]},set:function(A){this._matrix[1]=A}}),Object.defineProperty(Nn.prototype,"c",{get:function(){return this._matrix[2]},set:function(A){this._matrix[2]=A}}),Object.defineProperty(Nn.prototype,"d",{get:function(){return this._matrix[3]},set:function(A){this._matrix[3]=A}}),Object.defineProperty(Nn.prototype,"e",{get:function(){return this._matrix[4]},set:function(A){this._matrix[4]=A}}),Object.defineProperty(Nn.prototype,"f",{get:function(){return this._matrix[5]},set:function(A){this._matrix[5]=A}}),Object.defineProperty(Nn.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Nn.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Nn.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Nn.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Nn.prototype.join=function(A){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(Ve).join(A)},Nn.prototype.multiply=function(A){var de=A.sx*this.sx+A.shy*this.shx,He=A.sx*this.shy+A.shy*this.sy,ct=A.shx*this.sx+A.sy*this.shx,St=A.shx*this.shy+A.sy*this.sy,Ft=A.tx*this.sx+A.ty*this.shx+this.tx,sn=A.tx*this.shy+A.ty*this.sy+this.ty;return new Nn(de,He,ct,St,Ft,sn)},Nn.prototype.decompose=function(){var A=this.sx,de=this.shy,He=this.shx,ct=this.sy,St=this.tx,Ft=this.ty,sn=Math.sqrt(A*A+de*de),Pn=(A/=sn)*He+(de/=sn)*ct;He-=A*Pn,ct-=de*Pn;var kn=Math.sqrt(He*He+ct*ct);return Pn/=kn,A*(ct/=kn)<de*(He/=kn)&&(A=-A,de=-de,Pn=-Pn,sn=-sn),{scale:new Nn(sn,0,0,kn,0,0),translate:new Nn(1,0,0,1,St,Ft),rotate:new Nn(A,de,-de,A,0,0),skew:new Nn(1,0,Pn,1,0,0)}},Nn.prototype.toString=function(A){return this.join(" ")},Nn.prototype.inversed=function(){var A=this.sx,de=this.shy,He=this.shx,ct=this.sy,St=this.tx,Ft=this.ty,sn=1/(A*ct-de*He),Pn=ct*sn,kn=-de*sn,Vn=-He*sn,ei=A*sn;return new Nn(Pn,kn,Vn,ei,-Pn*St-Vn*Ft,-kn*St-ei*Ft)},Nn.prototype.applyToPoint=function(A){var de=A.x*this.sx+A.y*this.shx+this.tx,He=A.x*this.shy+A.y*this.sy+this.ty;return new ss(de,He)},Nn.prototype.applyToRectangle=function(A){var de=this.applyToPoint(A),He=this.applyToPoint(new ss(A.x+A.w,A.y+A.h));return new mo(de.x,de.y,He.x-de.x,He.y-de.y)},Nn.prototype.clone=function(){var A=this.sx,de=this.shy,He=this.shx,ct=this.sy,St=this.tx,Ft=this.ty;return new Nn(A,de,He,ct,St,Ft)},b.Matrix=Nn;var pi=b.matrixMult=function(A,de){return de.multiply(A)},hr=new Nn(1,0,0,1,0,0);b.unitMatrix=b.identityMatrix=hr;var bi=function(A,de){if(!ni[A]){var He=(de instanceof Kc?"Sh":"P")+(Object.keys(vn).length+1).toString(10);de.id=He,ni[A]=He,vn[He]=de,On.publish("addPattern",de)}};b.ShadingPattern=Kc,b.TilingPattern=Dh,b.addShadingPattern=function(A,de){return O("addShadingPattern()"),bi(A,de),this},b.beginTilingPattern=function(A){O("beginTilingPattern()"),vo(A.boundingBox[0],A.boundingBox[1],A.boundingBox[2]-A.boundingBox[0],A.boundingBox[3]-A.boundingBox[1],A.matrix)},b.endTilingPattern=function(A,de){O("endTilingPattern()"),de.stream=Ce[Ee].join(`
`),bi(A,de),On.publish("endTilingPattern",de),$r.pop().restore()};var Zt=b.__private__.newObject=function(){var A=yn();return er(A,!0),A},yn=b.__private__.newObjectDeferred=function(){return he++,te[he]=function(){return ee},he},er=function(A,de){return de=typeof de=="boolean"&&de,te[A]=ee,de&&le(A+" 0 obj"),A},kr=b.__private__.newAdditionalObject=function(){var A={objId:yn(),content:""};return se.push(A),A},tr=yn(),qr=yn(),Vr=b.__private__.decodeColorString=function(A){var de=A.split(" ");if(de.length!==2||de[1]!=="g"&&de[1]!=="G")de.length===5&&(de[4]==="k"||de[4]==="K")&&(de=[(1-de[0])*(1-de[3]),(1-de[1])*(1-de[3]),(1-de[2])*(1-de[3]),"r"]);else{var He=parseFloat(de[0]);de=[He,He,He,"r"]}for(var ct="#",St=0;St<3;St++)ct+=("0"+Math.floor(255*parseFloat(de[St])).toString(16)).slice(-2);return ct},Qn=b.__private__.encodeColorString=function(A){var de;typeof A=="string"&&(A={ch1:A});var He=A.ch1,ct=A.ch2,St=A.ch3,Ft=A.ch4,sn=A.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof He=="string"&&He.charAt(0)!=="#"){var Pn=new N4(He);if(Pn.ok)He=Pn.toHex();else if(!/^\d*\.?\d*$/.test(He))throw new Error('Invalid color "'+He+'" passed to jsPDF.encodeColorString.')}if(typeof He=="string"&&/^#[0-9A-Fa-f]{3}$/.test(He)&&(He="#"+He[1]+He[1]+He[2]+He[2]+He[3]+He[3]),typeof He=="string"&&/^#[0-9A-Fa-f]{6}$/.test(He)){var kn=parseInt(He.substr(1),16);He=kn>>16&255,ct=kn>>8&255,St=255&kn}if(ct===void 0||Ft===void 0&&He===ct&&ct===St)if(typeof He=="string")de=He+" "+sn[0];else switch(A.precision){case 2:de=ue(He/255)+" "+sn[0];break;case 3:default:de=z(He/255)+" "+sn[0]}else if(Ft===void 0||Mr(Ft)==="object"){if(Ft&&!isNaN(Ft.a)&&Ft.a===0)return de=["1.","1.","1.",sn[1]].join(" ");if(typeof He=="string")de=[He,ct,St,sn[1]].join(" ");else switch(A.precision){case 2:de=[ue(He/255),ue(ct/255),ue(St/255),sn[1]].join(" ");break;default:case 3:de=[z(He/255),z(ct/255),z(St/255),sn[1]].join(" ")}}else if(typeof He=="string")de=[He,ct,St,Ft,sn[2]].join(" ");else switch(A.precision){case 2:de=[ue(He),ue(ct),ue(St),ue(Ft),sn[2]].join(" ");break;case 3:default:de=[z(He),z(ct),z(St),z(Ft),sn[2]].join(" ")}return de},fr=b.__private__.getFilters=function(){return l},fs=b.__private__.putStream=function(A){var de=(A=A||{}).data||"",He=A.filters||fr(),ct=A.alreadyAppliedFilters||[],St=A.addLength1||!1,Ft=de.length,sn=A.objectId,Pn=function(Or){return Or};if(_!==null&&sn===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");_!==null&&(Pn=ts.encryptor(sn,0));var kn={};He===!0&&(He=["FlateEncode"]);var Vn=A.additionalKeyValues||[],ei=(kn=hi.API.processDataByFilters!==void 0?hi.API.processDataByFilters(de,He):{data:de,reverseChain:[]}).reverseChain+(Array.isArray(ct)?ct.join(" "):ct.toString());if(kn.data.length!==0&&(Vn.push({key:"Length",value:kn.data.length}),St===!0&&Vn.push({key:"Length1",value:Ft})),ei.length!=0)if(ei.split("/").length-1==1)Vn.push({key:"Filter",value:ei});else{Vn.push({key:"Filter",value:"["+ei+"]"});for(var vi=0;vi<Vn.length;vi+=1)if(Vn[vi].key==="DecodeParms"){for(var gr=[],$i=0;$i<kn.reverseChain.split("/").length-1;$i+=1)gr.push("null");gr.push(Vn[vi].value),Vn[vi].value="["+gr.join(" ")+"]"}}le("<<");for(var Ji=0;Ji<Vn.length;Ji++)le("/"+Vn[Ji].key+" "+Vn[Ji].value);le(">>"),kn.data.length!==0&&(le("stream"),le(Pn(kn.data)),le("endstream"))},Qr=b.__private__.putPage=function(A){var de=A.number,He=A.data,ct=A.objId,St=A.contentsObjId;er(ct,!0),le("<</Type /Page"),le("/Parent "+A.rootDictionaryObjId+" 0 R"),le("/Resources "+A.resourceDictionaryObjId+" 0 R"),le("/MediaBox ["+parseFloat(Ve(A.mediaBox.bottomLeftX))+" "+parseFloat(Ve(A.mediaBox.bottomLeftY))+" "+Ve(A.mediaBox.topRightX)+" "+Ve(A.mediaBox.topRightY)+"]"),A.cropBox!==null&&le("/CropBox ["+Ve(A.cropBox.bottomLeftX)+" "+Ve(A.cropBox.bottomLeftY)+" "+Ve(A.cropBox.topRightX)+" "+Ve(A.cropBox.topRightY)+"]"),A.bleedBox!==null&&le("/BleedBox ["+Ve(A.bleedBox.bottomLeftX)+" "+Ve(A.bleedBox.bottomLeftY)+" "+Ve(A.bleedBox.topRightX)+" "+Ve(A.bleedBox.topRightY)+"]"),A.trimBox!==null&&le("/TrimBox ["+Ve(A.trimBox.bottomLeftX)+" "+Ve(A.trimBox.bottomLeftY)+" "+Ve(A.trimBox.topRightX)+" "+Ve(A.trimBox.topRightY)+"]"),A.artBox!==null&&le("/ArtBox ["+Ve(A.artBox.bottomLeftX)+" "+Ve(A.artBox.bottomLeftY)+" "+Ve(A.artBox.topRightX)+" "+Ve(A.artBox.topRightY)+"]"),typeof A.userUnit=="number"&&A.userUnit!==1&&le("/UserUnit "+A.userUnit),On.publish("putPage",{objId:ct,pageContext:Mt[de],pageNumber:de,page:He}),le("/Contents "+St+" 0 R"),le(">>"),le("endobj");var Ft=He.join(`
`);return me===G.ADVANCED&&(Ft+=`
Q`),er(St,!0),fs({data:Ft,filters:fr(),objectId:St}),le("endobj"),ct},Ci=b.__private__.putPages=function(){var A,de,He=[];for(A=1;A<=Ii;A++)Mt[A].objId=yn(),Mt[A].contentsObjId=yn();for(A=1;A<=Ii;A++)He.push(Qr({number:A,data:Ce[A],objId:Mt[A].objId,contentsObjId:Mt[A].contentsObjId,mediaBox:Mt[A].mediaBox,cropBox:Mt[A].cropBox,bleedBox:Mt[A].bleedBox,trimBox:Mt[A].trimBox,artBox:Mt[A].artBox,userUnit:Mt[A].userUnit,rootDictionaryObjId:tr,resourceDictionaryObjId:qr}));er(tr,!0),le("<</Type /Pages");var ct="/Kids [";for(de=0;de<Ii;de++)ct+=He[de]+" 0 R ";le(ct+"]"),le("/Count "+Ii),le(">>"),le("endobj"),On.publish("postPutPages")},An=function(A){On.publish("putFont",{font:A,out:le,newObject:Zt,putStream:fs}),A.isAlreadyPutted!==!0&&(A.objectNumber=Zt(),le("<<"),le("/Type /Font"),le("/BaseFont /"+Rh(A.postScriptName)),le("/Subtype /Type1"),typeof A.encoding=="string"&&le("/Encoding /"+A.encoding),le("/FirstChar 32"),le("/LastChar 255"),le(">>"),le("endobj"))},Pr=function(){for(var A in _n)_n.hasOwnProperty(A)&&(x===!1||x===!0&&E.hasOwnProperty(A))&&An(_n[A])},Ui=function(A){A.objectNumber=Zt();var de=[];de.push({key:"Type",value:"/XObject"}),de.push({key:"Subtype",value:"/Form"}),de.push({key:"BBox",value:"["+[Ve(A.x),Ve(A.y),Ve(A.x+A.width),Ve(A.y+A.height)].join(" ")+"]"}),de.push({key:"Matrix",value:"["+A.matrix.toString()+"]"});var He=A.pages[1].join(`
`);fs({data:He,additionalKeyValues:de,objectId:A.objectNumber}),le("endobj")},Vi=function(){for(var A in zi)zi.hasOwnProperty(A)&&Ui(zi[A])},dr=function(A,de){var He,ct=[],St=1/(de-1);for(He=0;He<1;He+=St)ct.push(He);if(ct.push(1),A[0].offset!=0){var Ft={offset:0,color:A[0].color};A.unshift(Ft)}if(A[A.length-1].offset!=1){var sn={offset:1,color:A[A.length-1].color};A.push(sn)}for(var Pn="",kn=0,Vn=0;Vn<ct.length;Vn++){for(He=ct[Vn];He>A[kn+1].offset;)kn++;var ei=A[kn].offset,vi=(He-ei)/(A[kn+1].offset-ei),gr=A[kn].color,$i=A[kn+1].color;Pn+=H(Math.round((1-vi)*gr[0]+vi*$i[0]).toString(16))+H(Math.round((1-vi)*gr[1]+vi*$i[1]).toString(16))+H(Math.round((1-vi)*gr[2]+vi*$i[2]).toString(16))}return Pn.trim()},es=function(A,de){de||(de=21);var He=Zt(),ct=dr(A.colors,de),St=[];St.push({key:"FunctionType",value:"0"}),St.push({key:"Domain",value:"[0.0 1.0]"}),St.push({key:"Size",value:"["+de+"]"}),St.push({key:"BitsPerSample",value:"8"}),St.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),St.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),fs({data:ct,additionalKeyValues:St,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:He}),le("endobj"),A.objectNumber=Zt(),le("<< /ShadingType "+A.type),le("/ColorSpace /DeviceRGB");var Ft="/Coords ["+Ve(parseFloat(A.coords[0]))+" "+Ve(parseFloat(A.coords[1]))+" ";A.type===2?Ft+=Ve(parseFloat(A.coords[2]))+" "+Ve(parseFloat(A.coords[3])):Ft+=Ve(parseFloat(A.coords[2]))+" "+Ve(parseFloat(A.coords[3]))+" "+Ve(parseFloat(A.coords[4]))+" "+Ve(parseFloat(A.coords[5])),le(Ft+="]"),A.matrix&&le("/Matrix ["+A.matrix.toString()+"]"),le("/Function "+He+" 0 R"),le("/Extend [true true]"),le(">>"),le("endobj")},Fs=function(A,de){var He=yn(),ct=Zt();de.push({resourcesOid:He,objectOid:ct}),A.objectNumber=ct;var St=[];St.push({key:"Type",value:"/Pattern"}),St.push({key:"PatternType",value:"1"}),St.push({key:"PaintType",value:"1"}),St.push({key:"TilingType",value:"1"}),St.push({key:"BBox",value:"["+A.boundingBox.map(Ve).join(" ")+"]"}),St.push({key:"XStep",value:Ve(A.xStep)}),St.push({key:"YStep",value:Ve(A.yStep)}),St.push({key:"Resources",value:He+" 0 R"}),A.matrix&&St.push({key:"Matrix",value:"["+A.matrix.toString()+"]"}),fs({data:A.stream,additionalKeyValues:St,objectId:A.objectNumber}),le("endobj")},di=function(A){var de;for(de in vn)vn.hasOwnProperty(de)&&(vn[de]instanceof Kc?es(vn[de]):vn[de]instanceof Dh&&Fs(vn[de],A))},co=function(A){for(var de in A.objectNumber=Zt(),le("<<"),A)switch(de){case"opacity":le("/ca "+ue(A[de]));break;case"stroke-opacity":le("/CA "+ue(A[de]))}le(">>"),le("endobj")},mr=function(){var A;for(A in fn)fn.hasOwnProperty(A)&&co(fn[A])},Er=function(){for(var A in le("/XObject <<"),zi)zi.hasOwnProperty(A)&&zi[A].objectNumber>=0&&le("/"+A+" "+zi[A].objectNumber+" 0 R");On.publish("putXobjectDict"),le(">>")},mi=function(){ts.oid=Zt(),le("<<"),le("/Filter /Standard"),le("/V "+ts.v),le("/R "+ts.r),le("/U <"+ts.toHexString(ts.U)+">"),le("/O <"+ts.toHexString(ts.O)+">"),le("/P "+ts.P),le(">>"),le("endobj")},xn=function(){for(var A in le("/Font <<"),_n)_n.hasOwnProperty(A)&&(x===!1||x===!0&&E.hasOwnProperty(A))&&le("/"+A+" "+_n[A].objectNumber+" 0 R");le(">>")},on=function(){if(Object.keys(vn).length>0){for(var A in le("/Shading <<"),vn)vn.hasOwnProperty(A)&&vn[A]instanceof Kc&&vn[A].objectNumber>=0&&le("/"+A+" "+vn[A].objectNumber+" 0 R");On.publish("putShadingPatternDict"),le(">>")}},ii=function(A){if(Object.keys(vn).length>0){for(var de in le("/Pattern <<"),vn)vn.hasOwnProperty(de)&&vn[de]instanceof b.TilingPattern&&vn[de].objectNumber>=0&&vn[de].objectNumber<A&&le("/"+de+" "+vn[de].objectNumber+" 0 R");On.publish("putTilingPatternDict"),le(">>")}},Xn=function(){if(Object.keys(fn).length>0){var A;for(A in le("/ExtGState <<"),fn)fn.hasOwnProperty(A)&&fn[A].objectNumber>=0&&le("/"+A+" "+fn[A].objectNumber+" 0 R");On.publish("putGStateDict"),le(">>")}},jn=function(A){er(A.resourcesOid,!0),le("<<"),le("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),xn(),on(),ii(A.objectOid),Xn(),Er(),le(">>"),le("endobj")},rs=function(){var A=[];Pr(),mr(),Vi(),di(A),On.publish("putResources"),A.forEach(jn),jn({resourcesOid:qr,objectOid:Number.MAX_SAFE_INTEGER}),On.publish("postPutResources")},Ps=function(){On.publish("putAdditionalObjects");for(var A=0;A<se.length;A++){var de=se[A];er(de.objId,!0),le(de.content),le("endobj")}On.publish("postPutAdditionalObjects")},Tr=function(A){mn[A.fontName]=mn[A.fontName]||{},mn[A.fontName][A.fontStyle]=A.id},so=function(A,de,He,ct,St){var Ft={id:"F"+(Object.keys(_n).length+1).toString(10),postScriptName:A,fontName:de,fontStyle:He,encoding:ct,isStandardFont:St||!1,metadata:{}};return On.publish("addFont",{font:Ft,instance:this}),_n[Ft.id]=Ft,Tr(Ft),Ft.id},ln=function(A){for(var de=0,He=Ae.length;de<He;de++){var ct=so.call(this,A[de][0],A[de][1],A[de][2],Ae[de][3],!0);x===!1&&(E[ct]=!0);var St=A[de][0].split("-");Tr({id:ct,fontName:St[0],fontStyle:St[1]||""})}On.publish("addFonts",{fonts:_n,dictionary:mn})},Jn=function(A){return A.foo=function(){try{return A.apply(this,arguments)}catch(ct){var de=ct.stack||"";~de.indexOf(" at ")&&(de=de.split(" at ")[1]);var He="Error in function "+de.split(`
`)[0].split("<")[0]+": "+ct.message;if(!fi.console)throw new Error(He);fi.console.error(He,ct),fi.alert&&alert(He)}},A.foo.bar=A,A.foo},vr=function(A,de){var He,ct,St,Ft,sn,Pn,kn,Vn,ei;if(St=(de=de||{}).sourceEncoding||"Unicode",sn=de.outputEncoding,(de.autoencode||sn)&&_n[Qt].metadata&&_n[Qt].metadata[St]&&_n[Qt].metadata[St].encoding&&(Ft=_n[Qt].metadata[St].encoding,!sn&&_n[Qt].encoding&&(sn=_n[Qt].encoding),!sn&&Ft.codePages&&(sn=Ft.codePages[0]),typeof sn=="string"&&(sn=Ft[sn]),sn)){for(kn=!1,Pn=[],He=0,ct=A.length;He<ct;He++)(Vn=sn[A.charCodeAt(He)])?Pn.push(String.fromCharCode(Vn)):Pn.push(A[He]),Pn[He].charCodeAt(0)>>8&&(kn=!0);A=Pn.join("")}for(He=A.length;kn===void 0&&He!==0;)A.charCodeAt(He-1)>>8&&(kn=!0),He--;if(!kn)return A;for(Pn=de.noBOM?[]:[254,255],He=0,ct=A.length;He<ct;He++){if((ei=(Vn=A.charCodeAt(He))>>8)>>8)throw new Error("Character at position "+He+" of string '"+A+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Pn.push(ei),Pn.push(Vn-(ei<<8))}return String.fromCharCode.apply(void 0,Pn)},sr=b.__private__.pdfEscape=b.pdfEscape=function(A,de){return vr(A,de).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},pr=b.__private__.beginPage=function(A){Ce[++Ii]=[],Mt[Ii]={objId:0,contentsObjId:0,userUnit:Number(h),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(A[0]),topRightY:Number(A[1])}},ho(Ii),ye(Ce[Ee])},Ea=function(A,de){var He,ct,St;switch(t=de||t,typeof A=="string"&&(He=F(A.toLowerCase()),Array.isArray(He)&&(ct=He[0],St=He[1])),Array.isArray(A)&&(ct=A[0]*Qe,St=A[1]*Qe),isNaN(ct)&&(ct=r[0],St=r[1]),(ct>14400||St>14400)&&(zr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ct=Math.min(14400,ct),St=Math.min(14400,St)),r=[ct,St],t.substr(0,1)){case"l":St>ct&&(r=[St,ct]);break;case"p":ct>St&&(r=[St,ct])}pr(r),Ka(hl),le(yr),Xa!==0&&le(Xa+" J"),Zi!==0&&le(Zi+" j"),On.publish("addPage",{pageNumber:Ii})},Ao=function(A){A>0&&A<=Ii&&(Ce.splice(A,1),Mt.splice(A,1),Ii--,Ee>Ii&&(Ee=Ii),this.setPage(Ee))},ho=function(A){A>0&&A<=Ii&&(Ee=A)},ar=b.__private__.getNumberOfPages=b.getNumberOfPages=function(){return Ce.length-1},Es=function(A,de,He){var ct,St=void 0;return He=He||{},A=A!==void 0?A:_n[Qt].fontName,de=de!==void 0?de:_n[Qt].fontStyle,ct=A.toLowerCase(),mn[ct]!==void 0&&mn[ct][de]!==void 0?St=mn[ct][de]:mn[A]!==void 0&&mn[A][de]!==void 0?St=mn[A][de]:He.disableWarning===!1&&zr.warn("Unable to look up font label for font '"+A+"', '"+de+"'. Refer to getFontList() for available fonts."),St||He.noFallback||(St=mn.times[de])==null&&(St=mn.times.normal),St},oo=b.__private__.putInfo=function(){var A=Zt(),de=function(ct){return ct};for(var He in _!==null&&(de=ts.encryptor(A,0)),le("<<"),le("/Producer ("+sr(de("jsPDF "+hi.version))+")"),Kt)Kt.hasOwnProperty(He)&&Kt[He]&&le("/"+He.substr(0,1).toUpperCase()+He.substr(1)+" ("+sr(de(Kt[He]))+")");le("/CreationDate ("+sr(de(U))+")"),le(">>"),le("endobj")},As=b.__private__.putCatalog=function(A){var de=(A=A||{}).rootDictionaryObjId||tr;switch(Zt(),le("<<"),le("/Type /Catalog"),le("/Pages "+de+" 0 R"),Oe||(Oe="fullwidth"),Oe){case"fullwidth":le("/OpenAction [3 0 R /FitH null]");break;case"fullheight":le("/OpenAction [3 0 R /FitV null]");break;case"fullpage":le("/OpenAction [3 0 R /Fit]");break;case"original":le("/OpenAction [3 0 R /XYZ null null 1]");break;default:var He=""+Oe;He.substr(He.length-1)==="%"&&(Oe=parseInt(Oe)/100),typeof Oe=="number"&&le("/OpenAction [3 0 R /XYZ null null "+ue(Oe)+"]")}switch($t||($t="continuous"),$t){case"continuous":le("/PageLayout /OneColumn");break;case"single":le("/PageLayout /SinglePage");break;case"two":case"twoleft":le("/PageLayout /TwoColumnLeft");break;case"tworight":le("/PageLayout /TwoColumnRight")}mt&&le("/PageMode /"+mt),On.publish("putCatalog"),le(">>"),le("endobj")},Wi=b.__private__.putTrailer=function(){le("trailer"),le("<<"),le("/Size "+(he+1)),le("/Root "+he+" 0 R"),le("/Info "+(he-1)+" 0 R"),_!==null&&le("/Encrypt "+ts.oid+" 0 R"),le("/ID [ <"+Y+"> <"+Y+"> ]"),le(">>")},ds=b.__private__.putHeader=function(){le("%PDF-"+D),le("%ºß¬à")},ps=b.__private__.putXRef=function(){var A="0000000000";le("xref"),le("0 "+(he+1)),le("0000000000 65535 f ");for(var de=1;de<=he;de++)typeof te[de]=="function"?le((A+te[de]()).slice(-10)+" 00000 n "):te[de]!==void 0?le((A+te[de]).slice(-10)+" 00000 n "):le("0000000000 00000 n ")},fo=b.__private__.buildDocument=function(){xe(),ye(ie),On.publish("buildDocument"),ds(),Ci(),Ps(),rs(),_!==null&&mi(),oo(),As();var A=ee;return ps(),Wi(),le("startxref"),le(""+A),le("%%EOF"),ye(Ce[Ee]),ie.join(`
`)},Vo=b.__private__.getBlob=function(A){return new Blob([Re(A)],{type:"application/pdf"})},ca=b.output=b.__private__.output=Jn(function(A,de){switch(typeof(de=de||{})=="string"?de={filename:de}:de.filename=de.filename||"generated.pdf",A){case void 0:return fo();case"save":b.save(de.filename);break;case"arraybuffer":return Re(fo());case"blob":return Vo(fo());case"bloburi":case"bloburl":if(fi.URL!==void 0&&typeof fi.URL.createObjectURL=="function")return fi.URL&&fi.URL.createObjectURL(Vo(fo()))||void 0;zr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var He="",ct=fo();try{He=qg(ct)}catch{He=qg(unescape(encodeURIComponent(ct)))}return"data:application/pdf;filename="+de.filename+";base64,"+He;case"pdfobjectnewwindow":if(Object.prototype.toString.call(fi)==="[object Window]"){var St="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ft=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';de.pdfObjectUrl&&(St=de.pdfObjectUrl,Ft="");var sn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+St+'"'+Ft+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(de)+");<\/script></body></html>",Pn=fi.open();return Pn!==null&&Pn.document.write(sn),Pn}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(fi)==="[object Window]"){var kn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(de.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+de.filename+'" width="500px" height="400px" /></body></html>',Vn=fi.open();if(Vn!==null){Vn.document.write(kn);var ei=this;Vn.document.documentElement.querySelector("#pdfViewer").onload=function(){Vn.document.title=de.filename,Vn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(ei.output("bloburl"))}}return Vn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(fi)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var vi='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",de)+'"></iframe></body></html>',gr=fi.open();if(gr!==null&&(gr.document.write(vi),gr.document.title=de.filename),gr||typeof safari>"u")return gr;break;case"datauri":case"dataurl":return fi.document.location.href=this.output("datauristring",de);default:return null}}),Ha=function(A){return Array.isArray(Fi)===!0&&Fi.indexOf(A)>-1};switch(i){case"pt":Qe=1;break;case"mm":Qe=72/25.4;break;case"cm":Qe=72/2.54;break;case"in":Qe=72;break;case"px":Qe=Ha("px_scaling")==1?.75:96/72;break;case"pc":case"em":Qe=12;break;case"ex":Qe=6;break;default:if(typeof i!="number")throw new Error("Invalid unit: "+i);Qe=i}var ts=null;ot(),re();var iu=function(A){return _!==null?ts.encryptor(A,0):function(de){return de}},cl=b.__private__.getPageInfo=b.getPageInfo=function(A){if(isNaN(A)||A%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Mt[A].objId,pageNumber:A,pageContext:Mt[A]}},ri=b.__private__.getPageInfoByObjId=function(A){if(isNaN(A)||A%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var de in Mt)if(Mt[de].objId===A)break;return cl(de)},li=b.__private__.getCurrentPageInfo=b.getCurrentPageInfo=function(){return{objId:Mt[Ee].objId,pageNumber:Ee,pageContext:Mt[Ee]}};b.addPage=function(){return Ea.apply(this,arguments),this},b.setPage=function(){return ho.apply(this,arguments),ye.call(this,Ce[Ee]),this},b.insertPage=function(A){return this.addPage(),this.movePage(Ee,A),this},b.movePage=function(A,de){var He,ct;if(A>de){He=Ce[A],ct=Mt[A];for(var St=A;St>de;St--)Ce[St]=Ce[St-1],Mt[St]=Mt[St-1];Ce[de]=He,Mt[de]=ct,this.setPage(de)}else if(A<de){He=Ce[A],ct=Mt[A];for(var Ft=A;Ft<de;Ft++)Ce[Ft]=Ce[Ft+1],Mt[Ft]=Mt[Ft+1];Ce[de]=He,Mt[de]=ct,this.setPage(de)}return this},b.deletePage=function(){return Ao.apply(this,arguments),this},b.__private__.text=b.text=function(A,de,He,ct,St){var Ft,sn,Pn,kn,Vn,ei,vi,gr,$i,Ji=(ct=ct||{}).scope||this;if(typeof A=="number"&&typeof de=="number"&&(typeof He=="string"||Array.isArray(He))){var Or=He;He=de,de=A,A=Or}if(arguments[3]instanceof Nn?(O("The transform parameter of text() with a Matrix value"),$i=St):(Pn=arguments[4],kn=arguments[5],Mr(vi=arguments[3])==="object"&&vi!==null||(typeof Pn=="string"&&(kn=Pn,Pn=null),typeof vi=="string"&&(kn=vi,vi=null),typeof vi=="number"&&(Pn=vi,vi=null),ct={flags:vi,angle:Pn,align:kn})),isNaN(de)||isNaN(He)||A==null)throw new Error("Invalid arguments passed to jsPDF.text");if(A.length===0)return Ji;var Gr="",eo=!1,yi=typeof ct.lineHeightFactor=="number"?ct.lineHeightFactor:Za,gs=Ji.internal.scaleFactor;function Ra(Xi){return Xi=Xi.split("	").join(Array(ct.TabLen||9).join(" ")),sr(Xi,vi)}function Ms(Xi){for(var nr,Ir=Xi.concat(),lr=[],io=Ir.length;io--;)typeof(nr=Ir.shift())=="string"?lr.push(nr):Array.isArray(Xi)&&(nr.length===1||nr[1]===void 0&&nr[2]===void 0)?lr.push(nr[0]):lr.push([nr[0],nr[1],nr[2]]);return lr}function pl(Xi,nr){var Ir;if(typeof Xi=="string")Ir=nr(Xi)[0];else if(Array.isArray(Xi)){for(var lr,io,js=Xi.concat(),lo=[],Dl=js.length;Dl--;)typeof(lr=js.shift())=="string"?lo.push(nr(lr)[0]):Array.isArray(lr)&&typeof lr[0]=="string"&&(io=nr(lr[0],lr[1],lr[2]),lo.push([io[0],io[1],io[2]]));Ir=lo}return Ir}var ko=!1,Rl=!0;if(typeof A=="string")ko=!0;else if(Array.isArray(A)){var da=A.concat();sn=[];for(var pa,Hr=da.length;Hr--;)(typeof(pa=da.shift())!="string"||Array.isArray(pa)&&typeof pa[0]!="string")&&(Rl=!1);ko=Rl}if(ko===!1)throw new Error('Type of text must be string or Array. "'+A+'" is not recognized.');typeof A=="string"&&(A=A.match(/[\r?\n]/)?A.split(/\r\n|\r|\n/g):[A]);var To=qe/Ji.internal.scaleFactor,to=To*(yi-1);switch(ct.baseline){case"bottom":He-=to;break;case"top":He+=To-to;break;case"hanging":He+=To-2*to;break;case"middle":He+=To/2-to}if((ei=ct.maxWidth||0)>0&&(typeof A=="string"?A=Ji.splitTextToSize(A,ei):Object.prototype.toString.call(A)==="[object Array]"&&(A=A.reduce(function(Xi,nr){return Xi.concat(Ji.splitTextToSize(nr,ei))},[]))),Ft={text:A,x:de,y:He,options:ct,mutex:{pdfEscape:sr,activeFontKey:Qt,fonts:_n,activeFontSize:qe}},On.publish("preProcessText",Ft),A=Ft.text,Pn=(ct=Ft.options).angle,!($i instanceof Nn)&&Pn&&typeof Pn=="number"){Pn*=Math.PI/180,ct.rotationDirection===0&&(Pn=-Pn),me===G.ADVANCED&&(Pn=-Pn);var zs=Math.cos(Pn),Da=Math.sin(Pn);$i=new Nn(zs,Da,-Da,zs,0,0)}else Pn&&Pn instanceof Nn&&($i=Pn);me!==G.ADVANCED||$i||($i=hr),(Vn=ct.charSpace||Ya)!==void 0&&(Gr+=Ve(R(Vn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(gr=ct.horizontalScale)!==void 0&&(Gr+=Ve(100*gr)+` Tz
`),ct.lang;var ms=-1,ks=ct.renderingMode!==void 0?ct.renderingMode:ct.stroke,Ts=Ji.internal.getCurrentPageInfo().pageContext;switch(ks){case 0:case!1:case"fill":ms=0;break;case 1:case!0:case"stroke":ms=1;break;case 2:case"fillThenStroke":ms=2;break;case 3:case"invisible":ms=3;break;case 4:case"fillAndAddForClipping":ms=4;break;case 5:case"strokeAndAddPathForClipping":ms=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ms=6;break;case 7:case"addToPathForClipping":ms=7}var ou=Ts.usedRenderingMode!==void 0?Ts.usedRenderingMode:-1;ms!==-1?Gr+=ms+` Tr
`:ou!==-1&&(Gr+=`0 Tr
`),ms!==-1&&(Ts.usedRenderingMode=ms),kn=ct.align||"left";var ns,Wo=qe*yi,vs=Ji.internal.pageSize.getWidth(),ys=_n[Qt];Vn=ct.charSpace||Ya,ei=ct.maxWidth||0,vi=Object.assign({autoencode:!0,noBOM:!0},ct.flags);var Zo=[],Ko=function(Xi){return Ji.getStringUnitWidth(Xi,{font:ys,charSpace:Vn,fontSize:qe,doKerning:!1})*qe/gs};if(Object.prototype.toString.call(A)==="[object Array]"){var _s;sn=Ms(A),kn!=="left"&&(ns=sn.map(Ko));var os,Bo=0;if(kn==="right"){de-=ns[0],A=[],Hr=sn.length;for(var no=0;no<Hr;no++)no===0?(os=Gn(de),_s=Rr(He)):(os=R(Bo-ns[no]),_s=-Wo),A.push([sn[no],os,_s]),Bo=ns[no]}else if(kn==="center"){de-=ns[0]/2,A=[],Hr=sn.length;for(var bs=0;bs<Hr;bs++)bs===0?(os=Gn(de),_s=Rr(He)):(os=R((Bo-ns[bs])/2),_s=-Wo),A.push([sn[bs],os,_s]),Bo=ns[bs]}else if(kn==="left"){A=[],Hr=sn.length;for(var bt=0;bt<Hr;bt++)A.push(sn[bt])}else if(kn==="justify"&&ys.encoding==="Identity-H"){A=[],Hr=sn.length,ei=ei!==0?ei:vs;for(var qt=0,Bt=0;Bt<Hr;Bt++)if(_s=Bt===0?Rr(He):-Wo,os=Bt===0?Gn(de):qt,Bt<Hr-1){var Cn=R((ei-ns[Bt])/(sn[Bt].split(" ").length-1)),In=sn[Bt].split(" ");A.push([In[0]+" ",os,_s]),qt=0;for(var si=1;si<In.length;si++){var _r=(Ko(In[si-1]+" "+In[si])-Ko(In[si]))*gs+Cn;si==In.length-1?A.push([In[si],_r,0]):A.push([In[si]+" ",_r,0]),qt-=_r}}else A.push([sn[Bt],os,_s]);A.push(["",qt,0])}else{if(kn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(A=[],Hr=sn.length,ei=ei!==0?ei:vs,Bt=0;Bt<Hr;Bt++)_s=Bt===0?Rr(He):-Wo,os=Bt===0?Gn(de):0,Bt<Hr-1?Zo.push(Ve(R((ei-ns[Bt])/(sn[Bt].split(" ").length-1)))):Zo.push(0),A.push([sn[Bt],os,_s])}}var Yi=typeof ct.R2L=="boolean"?ct.R2L:Je;Yi===!0&&(A=pl(A,function(Xi,nr,Ir){return[Xi.split("").reverse().join(""),nr,Ir]})),Ft={text:A,x:de,y:He,options:ct,mutex:{pdfEscape:sr,activeFontKey:Qt,fonts:_n,activeFontSize:qe}},On.publish("postProcessText",Ft),A=Ft.text,eo=Ft.mutex.isHex||!1;var el=_n[Qt].encoding;el!=="WinAnsiEncoding"&&el!=="StandardEncoding"||(A=pl(A,function(Xi,nr,Ir){return[Ra(Xi),nr,Ir]})),sn=Ms(A),A=[];for(var Bs,br,No,Jo=0,Ro=1,Do=Array.isArray(sn[0])?Ro:Jo,Oo="",Pi=function(Xi,nr,Ir){var lr="";return Ir instanceof Nn?(Ir=typeof ct.angle=="number"?pi(Ir,new Nn(1,0,0,1,Xi,nr)):pi(new Nn(1,0,0,1,Xi,nr),Ir),me===G.ADVANCED&&(Ir=pi(new Nn(1,0,0,-1,0,0),Ir)),lr=Ir.join(" ")+` Tm
`):lr=Ve(Xi)+" "+Ve(nr)+` Td
`,lr},yo=0;yo<sn.length;yo++){switch(Oo="",Do){case Ro:No=(eo?"<":"(")+sn[yo][0]+(eo?">":")"),Bs=parseFloat(sn[yo][1]),br=parseFloat(sn[yo][2]);break;case Jo:No=(eo?"<":"(")+sn[yo]+(eo?">":")"),Bs=Gn(de),br=Rr(He)}Zo!==void 0&&Zo[yo]!==void 0&&(Oo=Zo[yo]+` Tw
`),yo===0?A.push(Oo+Pi(Bs,br,$i)+No):Do===Jo?A.push(Oo+No):Do===Ro&&A.push(Oo+Pi(Bs,br,$i)+No)}A=Do===Jo?A.join(` Tj
T* `):A.join(` Tj
`),A+=` Tj
`;var as=`BT
/`;return as+=Qt+" "+qe+` Tf
`,as+=Ve(qe*yi)+` TL
`,as+=Mo+`
`,as+=Gr,as+=A,le(as+="ET"),E[Qt]=!0,Ji};var po=b.__private__.clip=b.clip=function(A){return le(A==="evenodd"?"W*":"W"),this};b.clipEvenOdd=function(){return po("evenodd")},b.__private__.discardPath=b.discardPath=function(){return le("n"),this};var Ri=b.__private__.isValidStyle=function(A){var de=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(A)!==-1&&(de=!0),de};b.__private__.setDefaultPathOperation=b.setDefaultPathOperation=function(A){return Ri(A)&&(v=A),this};var Bl=b.__private__.getStyle=b.getStyle=function(A){var de=v;switch(A){case"D":case"S":de="S";break;case"F":de="f";break;case"FD":case"DF":de="B";break;case"f":case"f*":case"B":case"B*":de=A}return de},Aa=b.close=function(){return le("h"),this};b.stroke=function(){return le("S"),this},b.fill=function(A){return Ma("f",A),this},b.fillEvenOdd=function(A){return Ma("f*",A),this},b.fillStroke=function(A){return Ma("B",A),this},b.fillStrokeEvenOdd=function(A){return Ma("B*",A),this};var Ma=function(A,de){Mr(de)==="object"?Nl(de,A):le(A)},go=function(A){A===null||me===G.ADVANCED&&A===void 0||(A=Bl(A),le(A))};function ha(A,de,He,ct,St){var Ft=new Dh(de||this.boundingBox,He||this.xStep,ct||this.yStep,this.gState,St||this.matrix);Ft.stream=this.stream;var sn=A+"$$"+this.cloneIndex+++"$$";return bi(sn,Ft),Ft}var Nl=function(A,de){var He=ni[A.key],ct=vn[He];if(ct instanceof Kc)le("q"),le(Wa(de)),ct.gState&&b.setGState(ct.gState),le(A.matrix.toString()+" cm"),le("/"+He+" sh"),le("Q");else if(ct instanceof Dh){var St=new Nn(1,0,0,-1,0,Ho());A.matrix&&(St=St.multiply(A.matrix||hr),He=ha.call(ct,A.key,A.boundingBox,A.xStep,A.yStep,St).id),le("q"),le("/Pattern cs"),le("/"+He+" scn"),ct.gState&&b.setGState(ct.gState),le(de),le("Q")}},Wa=function(A){switch(A){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},oi=b.moveTo=function(A,de){return le(Ve(R(A))+" "+Ve(V(de))+" m"),this},wi=b.lineTo=function(A,de){return le(Ve(R(A))+" "+Ve(V(de))+" l"),this},fa=b.curveTo=function(A,de,He,ct,St,Ft){return le([Ve(R(A)),Ve(V(de)),Ve(R(He)),Ve(V(ct)),Ve(R(St)),Ve(V(Ft)),"c"].join(" ")),this};b.__private__.line=b.line=function(A,de,He,ct,St){if(isNaN(A)||isNaN(de)||isNaN(He)||isNaN(ct)||!Ri(St))throw new Error("Invalid arguments passed to jsPDF.line");return me===G.COMPAT?this.lines([[He-A,ct-de]],A,de,[1,1],St||"S"):this.lines([[He-A,ct-de]],A,de,[1,1]).stroke()},b.__private__.lines=b.lines=function(A,de,He,ct,St,Ft){var sn,Pn,kn,Vn,ei,vi,gr,$i,Ji,Or,Gr,eo;if(typeof A=="number"&&(eo=He,He=de,de=A,A=eo),ct=ct||[1,1],Ft=Ft||!1,isNaN(de)||isNaN(He)||!Array.isArray(A)||!Array.isArray(ct)||!Ri(St)||typeof Ft!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(oi(de,He),sn=ct[0],Pn=ct[1],Vn=A.length,Or=de,Gr=He,kn=0;kn<Vn;kn++)(ei=A[kn]).length===2?(Or=ei[0]*sn+Or,Gr=ei[1]*Pn+Gr,wi(Or,Gr)):(vi=ei[0]*sn+Or,gr=ei[1]*Pn+Gr,$i=ei[2]*sn+Or,Ji=ei[3]*Pn+Gr,Or=ei[4]*sn+Or,Gr=ei[5]*Pn+Gr,fa(vi,gr,$i,Ji,Or,Gr));return Ft&&Aa(),go(St),this},b.path=function(A){for(var de=0;de<A.length;de++){var He=A[de],ct=He.c;switch(He.op){case"m":oi(ct[0],ct[1]);break;case"l":wi(ct[0],ct[1]);break;case"c":fa.apply(this,ct);break;case"h":Aa()}}return this},b.__private__.rect=b.rect=function(A,de,He,ct,St){if(isNaN(A)||isNaN(de)||isNaN(He)||isNaN(ct)||!Ri(St))throw new Error("Invalid arguments passed to jsPDF.rect");return me===G.COMPAT&&(ct=-ct),le([Ve(R(A)),Ve(V(de)),Ve(R(He)),Ve(R(ct)),"re"].join(" ")),go(St),this},b.__private__.triangle=b.triangle=function(A,de,He,ct,St,Ft,sn){if(isNaN(A)||isNaN(de)||isNaN(He)||isNaN(ct)||isNaN(St)||isNaN(Ft)||!Ri(sn))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[He-A,ct-de],[St-He,Ft-ct],[A-St,de-Ft]],A,de,[1,1],sn,!0),this},b.__private__.roundedRect=b.roundedRect=function(A,de,He,ct,St,Ft,sn){if(isNaN(A)||isNaN(de)||isNaN(He)||isNaN(ct)||isNaN(St)||isNaN(Ft)||!Ri(sn))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Pn=4/3*(Math.SQRT2-1);return St=Math.min(St,.5*He),Ft=Math.min(Ft,.5*ct),this.lines([[He-2*St,0],[St*Pn,0,St,Ft-Ft*Pn,St,Ft],[0,ct-2*Ft],[0,Ft*Pn,-St*Pn,Ft,-St,Ft],[2*St-He,0],[-St*Pn,0,-St,-Ft*Pn,-St,-Ft],[0,2*Ft-ct],[0,-Ft*Pn,St*Pn,-Ft,St,-Ft]],A+St,de,[1,1],sn,!0),this},b.__private__.ellipse=b.ellipse=function(A,de,He,ct,St){if(isNaN(A)||isNaN(de)||isNaN(He)||isNaN(ct)||!Ri(St))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ft=4/3*(Math.SQRT2-1)*He,sn=4/3*(Math.SQRT2-1)*ct;return oi(A+He,de),fa(A+He,de-sn,A+Ft,de-ct,A,de-ct),fa(A-Ft,de-ct,A-He,de-sn,A-He,de),fa(A-He,de+sn,A-Ft,de+ct,A,de+ct),fa(A+Ft,de+ct,A+He,de+sn,A+He,de),go(St),this},b.__private__.circle=b.circle=function(A,de,He,ct){if(isNaN(A)||isNaN(de)||isNaN(He)||!Ri(ct))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(A,de,He,He,ct)},b.setFont=function(A,de,He){return He&&(de=nt(de,He)),Qt=Es(A,de,{disableWarning:!1}),this};var ru=b.__private__.getFont=b.getFont=function(){return _n[Es.apply(b,arguments)]};b.__private__.getFontList=b.getFontList=function(){var A,de,He={};for(A in mn)if(mn.hasOwnProperty(A))for(de in He[A]=[],mn[A])mn[A].hasOwnProperty(de)&&He[A].push(de);return He},b.addFont=function(A,de,He,ct,St){var Ft=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ft.indexOf(arguments[3])!==-1?St=arguments[3]:arguments[3]&&Ft.indexOf(arguments[3])==-1&&(He=nt(He,ct)),St=St||"Identity-H",so.call(this,A,de,He,St)};var Za,hl=e.lineWidth||.200025,ka=b.__private__.getLineWidth=b.getLineWidth=function(){return hl},Ka=b.__private__.setLineWidth=b.setLineWidth=function(A){return hl=A,le(Ve(R(A))+" w"),this};b.__private__.setLineDash=hi.API.setLineDash=hi.API.setLineDashPattern=function(A,de){if(A=A||[],de=de||0,isNaN(de)||!Array.isArray(A))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return A=A.map(function(He){return Ve(R(He))}).join(" "),de=Ve(R(de)),le("["+A+"] "+de+" d"),this};var fl=b.__private__.getLineHeight=b.getLineHeight=function(){return qe*Za};b.__private__.getLineHeight=b.getLineHeight=function(){return qe*Za};var Si=b.__private__.setLineHeightFactor=b.setLineHeightFactor=function(A){return typeof(A=A||1.15)=="number"&&(Za=A),this},Nr=b.__private__.getLineHeightFactor=b.getLineHeightFactor=function(){return Za};Si(e.lineHeight);var Gn=b.__private__.getHorizontalCoordinate=function(A){return R(A)},Rr=b.__private__.getVerticalCoordinate=function(A){return me===G.ADVANCED?A:Mt[Ee].mediaBox.topRightY-Mt[Ee].mediaBox.bottomLeftY-R(A)},Ta=b.__private__.getHorizontalCoordinateString=b.getHorizontalCoordinateString=function(A){return Ve(Gn(A))},Go=b.__private__.getVerticalCoordinateString=b.getVerticalCoordinateString=function(A){return Ve(Rr(A))},yr=e.strokeColor||"0 G";b.__private__.getStrokeColor=b.getDrawColor=function(){return Vr(yr)},b.__private__.setStrokeColor=b.setDrawColor=function(A,de,He,ct){return yr=Qn({ch1:A,ch2:de,ch3:He,ch4:ct,pdfColorType:"draw",precision:2}),le(yr),this};var dl=e.fillColor||"0 g";b.__private__.getFillColor=b.getFillColor=function(){return Vr(dl)},b.__private__.setFillColor=b.setFillColor=function(A,de,He,ct){return dl=Qn({ch1:A,ch2:de,ch3:He,ch4:ct,pdfColorType:"fill",precision:2}),le(dl),this};var Mo=e.textColor||"0 g",Ja=b.__private__.getTextColor=b.getTextColor=function(){return Vr(Mo)};b.__private__.setTextColor=b.setTextColor=function(A,de,He,ct){return Mo=Qn({ch1:A,ch2:de,ch3:He,ch4:ct,pdfColorType:"text",precision:3}),this};var Ya=e.charSpace,ao=b.__private__.getCharSpace=b.getCharSpace=function(){return parseFloat(Ya||0)};b.__private__.setCharSpace=b.setCharSpace=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ya=A,this};var Xa=0;b.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},b.__private__.setLineCap=b.setLineCap=function(A){var de=b.CapJoinStyles[A];if(de===void 0)throw new Error("Line cap style of '"+A+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Xa=de,le(de+" J"),this};var Zi=0;b.__private__.setLineJoin=b.setLineJoin=function(A){var de=b.CapJoinStyles[A];if(de===void 0)throw new Error("Line join style of '"+A+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Zi=de,le(de+" j"),this},b.__private__.setLineMiterLimit=b.__private__.setMiterLimit=b.setLineMiterLimit=b.setMiterLimit=function(A){if(A=A||0,isNaN(A))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return le(Ve(R(A))+" M"),this},b.GState=vp,b.setGState=function(A){(A=typeof A=="string"?fn[Mn[A]]:su(null,A)).equals(Sr)||(le("/"+A.id+" gs"),Sr=A)};var su=function(A,de){if(!A||!Mn[A]){var He=!1;for(var ct in fn)if(fn.hasOwnProperty(ct)&&fn[ct].equals(de)){He=!0;break}if(He)de=fn[ct];else{var St="GS"+(Object.keys(fn).length+1).toString(10);fn[St]=de,de.id=St}return A&&(Mn[A]=de.id),On.publish("addGState",de),de}};b.addGState=function(A,de){return su(A,de),this},b.saveGraphicsState=function(){return le("q"),rt.push({key:Qt,size:qe,color:Mo}),this},b.restoreGraphicsState=function(){le("Q");var A=rt.pop();return Qt=A.key,qe=A.size,Mo=A.color,Sr=null,this},b.setCurrentTransformationMatrix=function(A){return le(A.toString()+" cm"),this},b.comment=function(A){return le("#"+A),this};var ss=function(A,de){var He=A||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return He},set:function(Ft){isNaN(Ft)||(He=parseFloat(Ft))}});var ct=de||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ct},set:function(Ft){isNaN(Ft)||(ct=parseFloat(Ft))}});var St="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return St},set:function(Ft){St=Ft.toString()}}),this},mo=function(A,de,He,ct){ss.call(this,A,de),this.type="rect";var St=He||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return St},set:function(sn){isNaN(sn)||(St=parseFloat(sn))}});var Ft=ct||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ft},set:function(sn){isNaN(sn)||(Ft=parseFloat(sn))}}),this},Qa=function(){this.page=Ii,this.currentPage=Ee,this.pages=Ce.slice(0),this.pagesContext=Mt.slice(0),this.x=We,this.y=Ut,this.matrix=pn,this.width=Ki(Ee),this.height=Ho(Ee),this.outputDestination=ae,this.id="",this.objectNumber=-1};Qa.prototype.restore=function(){Ii=this.page,Ee=this.currentPage,Mt=this.pagesContext,Ce=this.pages,We=this.x,Ut=this.y,pn=this.matrix,Qs(Ee,this.width),Dr(Ee,this.height),ae=this.outputDestination};var vo=function(A,de,He,ct,St){$r.push(new Qa),Ii=Ee=0,Ce=[],We=A,Ut=de,pn=St,pr([He,ct])},Ba=function(A){if(Xr[A])$r.pop().restore();else{var de=new Qa,He="Xo"+(Object.keys(zi).length+1).toString(10);de.id=He,Xr[A]=He,zi[He]=de,On.publish("addFormObject",de),$r.pop().restore()}};for(var Na in b.beginFormObject=function(A,de,He,ct,St){return vo(A,de,He,ct,St),this},b.endFormObject=function(A){return Ba(A),this},b.doFormObject=function(A,de){var He=zi[Xr[A]];return le("q"),le(de.toString()+" cm"),le("/"+He.id+" Do"),le("Q"),this},b.getFormObject=function(A){var de=zi[Xr[A]];return{x:de.x,y:de.y,width:de.width,height:de.height,matrix:de.matrix}},b.save=function(A,de){return A=A||"generated.pdf",(de=de||{}).returnPromise=de.returnPromise||!1,de.returnPromise===!1?(Hc(Vo(fo()),A),typeof Hc.unload=="function"&&fi.setTimeout&&setTimeout(Hc.unload,911),this):new Promise(function(He,ct){try{var St=Hc(Vo(fo()),A);typeof Hc.unload=="function"&&fi.setTimeout&&setTimeout(Hc.unload,911),He(St)}catch(Ft){ct(Ft.message)}})},hi.API)hi.API.hasOwnProperty(Na)&&(Na==="events"&&hi.API.events.length?function(A,de){var He,ct,St;for(St=de.length-1;St!==-1;St--)He=de[St][0],ct=de[St][1],A.subscribe.apply(A,[He].concat(typeof ct=="function"?[ct]:ct))}(On,hi.API.events):b[Na]=hi.API[Na]);var Ki=b.getPageWidth=function(A){return(Mt[A=A||Ee].mediaBox.topRightX-Mt[A].mediaBox.bottomLeftX)/Qe},Qs=b.setPageWidth=function(A,de){Mt[A].mediaBox.topRightX=de*Qe+Mt[A].mediaBox.bottomLeftX},Ho=b.getPageHeight=function(A){return(Mt[A=A||Ee].mediaBox.topRightY-Mt[A].mediaBox.bottomLeftY)/Qe},Dr=b.setPageHeight=function(A,de){Mt[A].mediaBox.topRightY=de*Qe+Mt[A].mediaBox.bottomLeftY};return b.internal={pdfEscape:sr,getStyle:Bl,getFont:ru,getFontSize:et,getCharSpace:ao,getTextColor:Ja,getLineHeight:fl,getLineHeightFactor:Nr,getLineWidth:ka,write:je,getHorizontalCoordinate:Gn,getVerticalCoordinate:Rr,getCoordinateString:Ta,getVerticalCoordinateString:Go,collections:{},newObject:Zt,newAdditionalObject:kr,newObjectDeferred:yn,newObjectDeferredBegin:er,getFilters:fr,putStream:fs,events:On,scaleFactor:Qe,pageSize:{getWidth:function(){return Ki(Ee)},setWidth:function(A){Qs(Ee,A)},getHeight:function(){return Ho(Ee)},setHeight:function(A){Dr(Ee,A)}},encryptionOptions:_,encryption:ts,getEncryptor:iu,output:ca,getNumberOfPages:ar,pages:Ce,out:le,f2:ue,f3:z,getPageInfo:cl,getPageInfoByObjId:ri,getCurrentPageInfo:li,getPDFVersion:$,Point:ss,Rectangle:mo,Matrix:Nn,hasHotfix:Ha},Object.defineProperty(b.internal.pageSize,"width",{get:function(){return Ki(Ee)},set:function(A){Qs(Ee,A)},enumerable:!0,configurable:!0}),Object.defineProperty(b.internal.pageSize,"height",{get:function(){return Ho(Ee)},set:function(A){Dr(Ee,A)},enumerable:!0,configurable:!0}),ln.call(b,Ae),Qt="F1",Ea(r,t),On.publish("initialized"),b}Nh.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},Nh.prototype.toHexString=function(e){return e.split("").map(function(n){return("0"+(255&n.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Nh.prototype.hexToBytes=function(e){for(var n=[],t=0;t<e.length;t+=2)n.push(String.fromCharCode(parseInt(e.substr(t,2),16)));return n.join("")},Nh.prototype.processOwnerPassword=function(e,n){return Gg(Vg(n).substr(0,5),e)},Nh.prototype.encryptor=function(e,n){var t=Vg(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&n,n>>8&255)).substr(0,10);return function(i){return Gg(t,i)}},vp.prototype.equals=function(e){var n,t="id,objectNumber,equals";if(!e||Mr(e)!==Mr(this))return!1;var i=0;for(n in this)if(!(t.indexOf(n)>=0)){if(this.hasOwnProperty(n)&&!e.hasOwnProperty(n)||this[n]!==e[n])return!1;i++}for(n in e)e.hasOwnProperty(n)&&t.indexOf(n)<0&&i--;return i===0},hi.API={events:[]},hi.version="2.5.2";var Os=hi.API,Pm=1,ch=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Mh=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},xi=function(e){return e.toFixed(2)},hc=function(e){return e.toFixed(5)};Os.__acroform__={};var Ga=function(e,n){e.prototype=Object.create(n.prototype),e.prototype.constructor=e},Dy=function(e){return e*Pm},gu=function(e){var n=new I4,t=Fn.internal.getHeight(e)||0,i=Fn.internal.getWidth(e)||0;return n.BBox=[0,0,Number(xi(i)),Number(xi(t))],n},J7=Os.__acroform__.setBit=function(e,n){if(e=e||0,n=n||0,isNaN(e)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<n},Y7=Os.__acroform__.clearBit=function(e,n){if(e=e||0,n=n||0,isNaN(e)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<n)},X7=Os.__acroform__.getBit=function(e,n){if(isNaN(e)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<n?1:0},Zs=Os.__acroform__.getBitForPdf=function(e,n){if(isNaN(e)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return X7(e,n-1)},Ks=Os.__acroform__.setBitForPdf=function(e,n){if(isNaN(e)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return J7(e,n-1)},Js=Os.__acroform__.clearBitForPdf=function(e,n){if(isNaN(e)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Y7(e,n-1)},Q7=Os.__acroform__.calculateCoordinates=function(e,n){var t=n.internal.getHorizontalCoordinate,i=n.internal.getVerticalCoordinate,r=e[0],o=e[1],l=e[2],h=e[3],g={};return g.lowerLeft_X=t(r)||0,g.lowerLeft_Y=i(o+h)||0,g.upperRight_X=t(r+l)||0,g.upperRight_Y=i(o)||0,[Number(xi(g.lowerLeft_X)),Number(xi(g.lowerLeft_Y)),Number(xi(g.upperRight_X)),Number(xi(g.upperRight_Y))]},eN=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var n=[],t=e._V||e.DV,i=Hg(e,t),r=e.scope.internal.getFont(e.fontName,e.fontStyle).id;n.push("/Tx BMC"),n.push("q"),n.push("BT"),n.push(e.scope.__private__.encodeColorString(e.color)),n.push("/"+r+" "+xi(i.fontSize)+" Tf"),n.push("1 0 0 1 0 0 Tm"),n.push(i.text),n.push("ET"),n.push("Q"),n.push("EMC");var o=gu(e);return o.scope=e.scope,o.stream=n.join(`
`),o}},Hg=function(e,n){var t=e.fontSize===0?e.maxFontSize:e.fontSize,i={text:"",fontSize:""},r=(n=(n=n.substr(0,1)=="("?n.substr(1):n).substr(n.length-1)==")"?n.substr(0,n.length-1):n).split(" ");r=e.multiline?r.map(function(z){return z.split(`
`)}):r.map(function(z){return[z]});var o=t,l=Fn.internal.getHeight(e)||0;l=l<0?-l:l;var h=Fn.internal.getWidth(e)||0;h=h<0?-h:h;var g=function(z,R,J){if(z+1<r.length){var V=R+" "+r[z+1][0];return kd(V,e,J).width<=h-4}return!1};o++;e:for(;o>0;){n="",o--;var v,_,x=kd("3",e,o).height,E=e.multiline?l-o:(l-x)/2,b=E+=2,D=0,$=0,Q=0;if(o<=0){n=`(...) Tj
`,n+="% Width of Text: "+kd(n,e,o=12).width+", FieldWidth:"+h+`
`;break}for(var F="",G=0,me=0;me<r.length;me++)if(r.hasOwnProperty(me)){var Se=!1;if(r[me].length!==1&&Q!==r[me].length-1){if((x+2)*(G+2)+2>l)continue e;F+=r[me][Q],Se=!0,$=me,me--}else{F=(F+=r[me][Q]+" ").substr(F.length-1)==" "?F.substr(0,F.length-1):F;var Ie=parseInt(me),nt=g(Ie,F,o),Ve=me>=r.length-1;if(nt&&!Ve){F+=" ",Q=0;continue}if(nt||Ve){if(Ve)$=Ie;else if(e.multiline&&(x+2)*(G+2)+2>l)continue e}else{if(!e.multiline||(x+2)*(G+2)+2>l)continue e;$=Ie}}for(var O="",W=D;W<=$;W++){var ue=r[W];if(e.multiline){if(W===$){O+=ue[Q]+" ",Q=(Q+1)%ue.length;continue}if(W===D){O+=ue[ue.length-1]+" ";continue}}O+=ue[0]+" "}switch(O=O.substr(O.length-1)==" "?O.substr(0,O.length-1):O,_=kd(O,e,o).width,e.textAlign){case"right":v=h-_-2;break;case"center":v=(h-_)/2;break;case"left":default:v=2}n+=xi(v)+" "+xi(b)+` Td
`,n+="("+ch(O)+`) Tj
`,n+=-xi(v)+` 0 Td
`,b=-(o+2),_=0,D=Se?$:$+1,G++,F=""}break}return i.text=n,i.fontSize=o,i},kd=function(e,n,t){var i=n.scope.internal.getFont(n.fontName,n.fontStyle),r=n.scope.getStringUnitWidth(e,{font:i,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:n.scope.getStringUnitWidth("3",{font:i,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:r}},tN={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},nN=function(e,n){var t={type:"reference",object:e};n.internal.getPageInfo(e.page).pageContext.annotations.find(function(i){return i.type===t.type&&i.object===t.object})===void 0&&n.internal.getPageInfo(e.page).pageContext.annotations.push(t)},iN=function(e,n){for(var t in e)if(e.hasOwnProperty(t)){var i=t,r=e[t];n.internal.newObjectDeferredBegin(r.objId,!0),Mr(r)==="object"&&typeof r.putStream=="function"&&r.putStream(),delete e[i]}},rN=function(e,n){if(n.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(tu.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(tN)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Pm=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new F4,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var i=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var r in i)if(i.hasOwnProperty(r)){var o=i[r];o.objId=void 0,o.hasAnnotation&&nN(o,t)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(t){(function(i,r){var o=!i;for(var l in i||(r.internal.newObjectDeferredBegin(r.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),r.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),i=i||r.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(i.hasOwnProperty(l)){var h=i[l],g=[],v=h.Rect;if(h.Rect&&(h.Rect=Q7(h.Rect,r)),r.internal.newObjectDeferredBegin(h.objId,!0),h.DA=Fn.createDefaultAppearanceStream(h),Mr(h)==="object"&&typeof h.getKeyValueListForStream=="function"&&(g=h.getKeyValueListForStream()),h.Rect=v,h.hasAppearanceStream&&!h.appearanceStreamContent){var _=eN(h);g.push({key:"AP",value:"<</N "+_+">>"}),r.internal.acroformPlugin.xForms.push(_)}if(h.appearanceStreamContent){var x="";for(var E in h.appearanceStreamContent)if(h.appearanceStreamContent.hasOwnProperty(E)){var b=h.appearanceStreamContent[E];if(x+="/"+E+" ",x+="<<",Object.keys(b).length>=1||Array.isArray(b)){for(var l in b)if(b.hasOwnProperty(l)){var D=b[l];typeof D=="function"&&(D=D.call(r,h)),x+="/"+l+" "+D+" ",r.internal.acroformPlugin.xForms.indexOf(D)>=0||r.internal.acroformPlugin.xForms.push(D)}}else typeof(D=b)=="function"&&(D=D.call(r,h)),x+="/"+l+" "+D,r.internal.acroformPlugin.xForms.indexOf(D)>=0||r.internal.acroformPlugin.xForms.push(D);x+=">>"}g.push({key:"AP",value:`<<
`+x+">>"})}r.internal.putStream({additionalKeyValues:g,objectId:h.objId}),r.internal.out("endobj")}o&&iN(r.internal.acroformPlugin.xForms,r)})(t,e)}),e.internal.acroformPlugin.isInitialized=!0}},O4=Os.__acroform__.arrayToPdfArray=function(e,n,t){var i=function(l){return l};if(Array.isArray(e)){for(var r="[",o=0;o<e.length;o++)switch(o!==0&&(r+=" "),Mr(e[o])){case"boolean":case"number":case"object":r+=e[o].toString();break;case"string":e[o].substr(0,1)!=="/"?(n!==void 0&&t&&(i=t.internal.getEncryptor(n)),r+="("+ch(i(e[o].toString()))+")"):r+=e[o].toString()}return r+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Y0=function(e,n,t){var i=function(r){return r};return n!==void 0&&t&&(i=t.internal.getEncryptor(n)),(e=e||"").toString(),e="("+ch(i(e))+")"},Lu=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Lu.prototype.toString=function(){return this.objId+" 0 R"},Lu.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Lu.prototype.getKeyValueListForStream=function(){var e=[],n=Object.getOwnPropertyNames(this).filter(function(o){return o!="content"&&o!="appearanceStreamContent"&&o!="scope"&&o!="objId"&&o.substring(0,1)!="_"});for(var t in n)if(Object.getOwnPropertyDescriptor(this,n[t]).configurable===!1){var i=n[t],r=this[i];r&&(Array.isArray(r)?e.push({key:i,value:O4(r,this.objId,this.scope)}):r instanceof Lu?(r.scope=this.scope,e.push({key:i,value:r.objId+" 0 R"})):typeof r!="function"&&e.push({key:i,value:r}))}return e};var I4=function(){Lu.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,n=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){e=t.trim()},get:function(){return e||null}})};Ga(I4,Lu);var F4=function(){Lu.call(this);var e,n=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return n.length>0?n:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return n}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var t=function(i){return i};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+ch(t(e))+")"}},set:function(t){e=t}})};Ga(F4,Lu);var tu=function e(){Lu.call(this);var n=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return n},set:function(F){if(isNaN(F))throw new Error('Invalid value "'+F+'" for attribute F supplied.');n=F}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Zs(n,3)},set:function(F){F?this.F=Ks(n,3):this.F=Js(n,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(F){if(isNaN(F))throw new Error('Invalid value "'+F+'" for attribute Ff supplied.');t=F}});var i=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(i.length!==0)return i},set:function(F){i=F!==void 0?F:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[0])?0:i[0]},set:function(F){i[0]=F}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[1])?0:i[1]},set:function(F){i[1]=F}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[2])?0:i[2]},set:function(F){i[2]=F}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[3])?0:i[3]},set:function(F){i[3]=F}});var r="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return r},set:function(F){switch(F){case"/Btn":case"/Tx":case"/Ch":case"/Sig":r=F;break;default:throw new Error('Invalid value "'+F+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof yp)return;o="FieldObject"+e.FieldNum++}var F=function(G){return G};return this.scope&&(F=this.scope.internal.getEncryptor(this.objId)),"("+ch(F(o))+")"},set:function(F){o=F.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(F){o=F}});var l="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return l},set:function(F){l=F}});var h="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return h},set:function(F){h=F}});var g=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return g},set:function(F){g=F}});var v=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return v===void 0?50/Pm:v},set:function(F){v=F}});var _="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return _},set:function(F){_=F}});var x="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!x||this instanceof yp||this instanceof rh))return Y0(x,this.objId,this.scope)},set:function(F){F=F.toString(),x=F}});var E=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(E)return this instanceof Co?E:Y0(E,this.objId,this.scope)},set:function(F){F=F.toString(),E=this instanceof Co?F:F.substr(0,1)==="("?Mh(F.substr(1,F.length-2)):Mh(F)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Co?Mh(E.substr(1,E.length-1)):E},set:function(F){F=F.toString(),E=this instanceof Co?"/"+F:F}});var b=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(b)return b},set:function(F){this.V=F}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(b)return this instanceof Co?b:Y0(b,this.objId,this.scope)},set:function(F){F=F.toString(),b=this instanceof Co?F:F.substr(0,1)==="("?Mh(F.substr(1,F.length-2)):Mh(F)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Co?Mh(b.substr(1,b.length-1)):b},set:function(F){F=F.toString(),b=this instanceof Co?"/"+F:F}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var D,$=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return $},set:function(F){F=!!F,$=F}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(D)return D},set:function(F){D=F}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Zs(this.Ff,1)},set:function(F){F?this.Ff=Ks(this.Ff,1):this.Ff=Js(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Zs(this.Ff,2)},set:function(F){F?this.Ff=Ks(this.Ff,2):this.Ff=Js(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Zs(this.Ff,3)},set:function(F){F?this.Ff=Ks(this.Ff,3):this.Ff=Js(this.Ff,3)}});var Q=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(Q!==null)return Q},set:function(F){if([0,1,2].indexOf(F)===-1)throw new Error('Invalid value "'+F+'" for attribute Q supplied.');Q=F}}),Object.defineProperty(this,"textAlign",{get:function(){var F;switch(Q){case 0:default:F="left";break;case 1:F="center";break;case 2:F="right"}return F},configurable:!0,enumerable:!0,set:function(F){switch(F){case"right":case 2:Q=2;break;case"center":case 1:Q=1;break;case"left":case 0:default:Q=0}}})};Ga(tu,Lu);var jh=function(){tu.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){e=t}});var n=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return O4(n,this.objId,this.scope)},set:function(t){var i,r;r=[],typeof(i=t)=="string"&&(r=function(o,l,h){h||(h=1);for(var g,v=[];g=l.exec(o);)v.push(g[h]);return v}(i,/\((.*?)\)/g)),n=r}}),this.getOptions=function(){return n},this.setOptions=function(t){n=t,this.sort&&n.sort()},this.addOption=function(t){t=(t=t||"").toString(),n.push(t),this.sort&&n.sort()},this.removeOption=function(t,i){for(i=i||!1,t=(t=t||"").toString();n.indexOf(t)!==-1&&(n.splice(n.indexOf(t),1),i!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Zs(this.Ff,18)},set:function(t){t?this.Ff=Ks(this.Ff,18):this.Ff=Js(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Zs(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=Ks(this.Ff,19):this.Ff=Js(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Zs(this.Ff,20)},set:function(t){t?(this.Ff=Ks(this.Ff,20),n.sort()):this.Ff=Js(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Zs(this.Ff,22)},set:function(t){t?this.Ff=Ks(this.Ff,22):this.Ff=Js(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Zs(this.Ff,23)},set:function(t){t?this.Ff=Ks(this.Ff,23):this.Ff=Js(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Zs(this.Ff,27)},set:function(t){t?this.Ff=Ks(this.Ff,27):this.Ff=Js(this.Ff,27)}}),this.hasAppearanceStream=!1};Ga(jh,tu);var Uh=function(){jh.call(this),this.fontName="helvetica",this.combo=!1};Ga(Uh,jh);var $h=function(){Uh.call(this),this.combo=!0};Ga($h,Uh);var Hd=function(){$h.call(this),this.edit=!0};Ga(Hd,$h);var Co=function(){tu.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Zs(this.Ff,15)},set:function(t){t?this.Ff=Ks(this.Ff,15):this.Ff=Js(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Zs(this.Ff,16)},set:function(t){t?this.Ff=Ks(this.Ff,16):this.Ff=Js(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Zs(this.Ff,17)},set:function(t){t?this.Ff=Ks(this.Ff,17):this.Ff=Js(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Zs(this.Ff,26)},set:function(t){t?this.Ff=Ks(this.Ff,26):this.Ff=Js(this.Ff,26)}});var e,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(o){return o};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(n).length!==0){var i,r=[];for(i in r.push("<<"),n)r.push("/"+i+" ("+ch(t(n[i]))+")");return r.push(">>"),r.join(`
`)}},set:function(t){Mr(t)==="object"&&(n=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(t){typeof t=="string"&&(n.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(t){e="/"+t}})};Ga(Co,tu);var Wd=function(){Co.call(this),this.pushButton=!0};Ga(Wd,Co);var qh=function(){Co.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(n){e=n!==void 0?n:[]}})};Ga(qh,Co);var yp=function(){var e,n;tu.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return n},set:function(r){n=r}});var t,i={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(h){return h};this.scope&&(r=this.scope.internal.getEncryptor(this.objId));var o,l=[];for(o in l.push("<<"),i)l.push("/"+o+" ("+ch(r(i[o]))+")");return l.push(">>"),l.join(`
`)},set:function(r){Mr(r)==="object"&&(i=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return i.CA||""},set:function(r){typeof r=="string"&&(i.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Fn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ga(yp,tu),qh.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var n in this.Kids)if(this.Kids.hasOwnProperty(n)){var t=this.Kids[n];t.appearanceStreamContent=e.createAppearanceStream(t.optionName),t.caption=e.getCA()}},qh.prototype.createOption=function(e){var n=new yp;return n.Parent=this,n.optionName=e,this.Kids.push(n),sN.call(this.scope,n),n};var Zd=function(){Co.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Fn.CheckBox.createAppearanceStream()};Ga(Zd,Co);var rh=function(){tu.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Zs(this.Ff,13)},set:function(n){n?this.Ff=Ks(this.Ff,13):this.Ff=Js(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Zs(this.Ff,21)},set:function(n){n?this.Ff=Ks(this.Ff,21):this.Ff=Js(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Zs(this.Ff,23)},set:function(n){n?this.Ff=Ks(this.Ff,23):this.Ff=Js(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Zs(this.Ff,24)},set:function(n){n?this.Ff=Ks(this.Ff,24):this.Ff=Js(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Zs(this.Ff,25)},set:function(n){n?this.Ff=Ks(this.Ff,25):this.Ff=Js(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Zs(this.Ff,26)},set:function(n){n?this.Ff=Ks(this.Ff,26):this.Ff=Js(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(n){Number.isInteger(n)&&(e=n)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ga(rh,tu);var Kd=function(){rh.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Zs(this.Ff,14)},set:function(e){e?this.Ff=Ks(this.Ff,14):this.Ff=Js(this.Ff,14)}}),this.password=!0};Ga(Kd,rh);var Fn={CheckBox:{createAppearanceStream:function(){return{N:{On:Fn.CheckBox.YesNormal},D:{On:Fn.CheckBox.YesPushDown,Off:Fn.CheckBox.OffPushDown}}},YesPushDown:function(e){var n=gu(e);n.scope=e.scope;var t=[],i=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color),o=Hg(e,e.caption);return t.push("0.749023 g"),t.push("0 0 "+xi(Fn.internal.getWidth(e))+" "+xi(Fn.internal.getHeight(e))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+i+" "+xi(o.fontSize)+" Tf "+r),t.push("BT"),t.push(o.text),t.push("ET"),t.push("Q"),t.push("EMC"),n.stream=t.join(`
`),n},YesNormal:function(e){var n=gu(e);n.scope=e.scope;var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),r=[],o=Fn.internal.getHeight(e),l=Fn.internal.getWidth(e),h=Hg(e,e.caption);return r.push("1 g"),r.push("0 0 "+xi(l)+" "+xi(o)+" re"),r.push("f"),r.push("q"),r.push("0 0 1 rg"),r.push("0 0 "+xi(l-1)+" "+xi(o-1)+" re"),r.push("W"),r.push("n"),r.push("0 g"),r.push("BT"),r.push("/"+t+" "+xi(h.fontSize)+" Tf "+i),r.push(h.text),r.push("ET"),r.push("Q"),n.stream=r.join(`
`),n},OffPushDown:function(e){var n=gu(e);n.scope=e.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+xi(Fn.internal.getWidth(e))+" "+xi(Fn.internal.getHeight(e))+" re"),t.push("f"),n.stream=t.join(`
`),n}},RadioButton:{Circle:{createAppearanceStream:function(e){var n={D:{Off:Fn.RadioButton.Circle.OffPushDown},N:{}};return n.N[e]=Fn.RadioButton.Circle.YesNormal,n.D[e]=Fn.RadioButton.Circle.YesPushDown,n},getCA:function(){return"l"},YesNormal:function(e){var n=gu(e);n.scope=e.scope;var t=[],i=Fn.internal.getWidth(e)<=Fn.internal.getHeight(e)?Fn.internal.getWidth(e)/4:Fn.internal.getHeight(e)/4;i=Number((.9*i).toFixed(5));var r=Fn.internal.Bezier_C,o=Number((i*r).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+hc(Fn.internal.getWidth(e)/2)+" "+hc(Fn.internal.getHeight(e)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),t.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),t.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),t.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),t.push("f"),t.push("Q"),n.stream=t.join(`
`),n},YesPushDown:function(e){var n=gu(e);n.scope=e.scope;var t=[],i=Fn.internal.getWidth(e)<=Fn.internal.getHeight(e)?Fn.internal.getWidth(e)/4:Fn.internal.getHeight(e)/4;i=Number((.9*i).toFixed(5));var r=Number((2*i).toFixed(5)),o=Number((r*Fn.internal.Bezier_C).toFixed(5)),l=Number((i*Fn.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+hc(Fn.internal.getWidth(e)/2)+" "+hc(Fn.internal.getHeight(e)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),t.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),t.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),t.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+hc(Fn.internal.getWidth(e)/2)+" "+hc(Fn.internal.getHeight(e)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+l+" "+l+" "+i+" 0 "+i+" c"),t.push("-"+l+" "+i+" -"+i+" "+l+" -"+i+" 0 c"),t.push("-"+i+" -"+l+" -"+l+" -"+i+" 0 -"+i+" c"),t.push(l+" -"+i+" "+i+" -"+l+" "+i+" 0 c"),t.push("f"),t.push("Q"),n.stream=t.join(`
`),n},OffPushDown:function(e){var n=gu(e);n.scope=e.scope;var t=[],i=Fn.internal.getWidth(e)<=Fn.internal.getHeight(e)?Fn.internal.getWidth(e)/4:Fn.internal.getHeight(e)/4;i=Number((.9*i).toFixed(5));var r=Number((2*i).toFixed(5)),o=Number((r*Fn.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+hc(Fn.internal.getWidth(e)/2)+" "+hc(Fn.internal.getHeight(e)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),t.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),t.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),t.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),t.push("f"),t.push("Q"),n.stream=t.join(`
`),n}},Cross:{createAppearanceStream:function(e){var n={D:{Off:Fn.RadioButton.Cross.OffPushDown},N:{}};return n.N[e]=Fn.RadioButton.Cross.YesNormal,n.D[e]=Fn.RadioButton.Cross.YesPushDown,n},getCA:function(){return"8"},YesNormal:function(e){var n=gu(e);n.scope=e.scope;var t=[],i=Fn.internal.calculateCross(e);return t.push("q"),t.push("1 1 "+xi(Fn.internal.getWidth(e)-2)+" "+xi(Fn.internal.getHeight(e)-2)+" re"),t.push("W"),t.push("n"),t.push(xi(i.x1.x)+" "+xi(i.x1.y)+" m"),t.push(xi(i.x2.x)+" "+xi(i.x2.y)+" l"),t.push(xi(i.x4.x)+" "+xi(i.x4.y)+" m"),t.push(xi(i.x3.x)+" "+xi(i.x3.y)+" l"),t.push("s"),t.push("Q"),n.stream=t.join(`
`),n},YesPushDown:function(e){var n=gu(e);n.scope=e.scope;var t=Fn.internal.calculateCross(e),i=[];return i.push("0.749023 g"),i.push("0 0 "+xi(Fn.internal.getWidth(e))+" "+xi(Fn.internal.getHeight(e))+" re"),i.push("f"),i.push("q"),i.push("1 1 "+xi(Fn.internal.getWidth(e)-2)+" "+xi(Fn.internal.getHeight(e)-2)+" re"),i.push("W"),i.push("n"),i.push(xi(t.x1.x)+" "+xi(t.x1.y)+" m"),i.push(xi(t.x2.x)+" "+xi(t.x2.y)+" l"),i.push(xi(t.x4.x)+" "+xi(t.x4.y)+" m"),i.push(xi(t.x3.x)+" "+xi(t.x3.y)+" l"),i.push("s"),i.push("Q"),n.stream=i.join(`
`),n},OffPushDown:function(e){var n=gu(e);n.scope=e.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+xi(Fn.internal.getWidth(e))+" "+xi(Fn.internal.getHeight(e))+" re"),t.push("f"),n.stream=t.join(`
`),n}}},createDefaultAppearanceStream:function(e){var n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,t=e.scope.__private__.encodeColorString(e.color);return"/"+n+" "+e.fontSize+" Tf "+t}};Fn.internal={Bezier_C:.551915024494,calculateCross:function(e){var n=Fn.internal.getWidth(e),t=Fn.internal.getHeight(e),i=Math.min(n,t);return{x1:{x:(n-i)/2,y:(t-i)/2+i},x2:{x:(n-i)/2+i,y:(t-i)/2},x3:{x:(n-i)/2,y:(t-i)/2},x4:{x:(n-i)/2+i,y:(t-i)/2+i}}}},Fn.internal.getWidth=function(e){var n=0;return Mr(e)==="object"&&(n=Dy(e.Rect[2])),n},Fn.internal.getHeight=function(e){var n=0;return Mr(e)==="object"&&(n=Dy(e.Rect[3])),n};var sN=Os.addField=function(e){if(rN(this,e),!(e instanceof tu))throw new Error("Invalid argument passed to jsPDF.addField.");var n;return(n=e).scope.internal.acroformPlugin.printedOut&&(n.scope.internal.acroformPlugin.printedOut=!1,n.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),n.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(n),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Os.AcroFormChoiceField=jh,Os.AcroFormListBox=Uh,Os.AcroFormComboBox=$h,Os.AcroFormEditBox=Hd,Os.AcroFormButton=Co,Os.AcroFormPushButton=Wd,Os.AcroFormRadioButton=qh,Os.AcroFormCheckBox=Zd,Os.AcroFormTextField=rh,Os.AcroFormPasswordField=Kd,Os.AcroFormAppearance=Fn,Os.AcroForm={ChoiceField:jh,ListBox:Uh,ComboBox:$h,EditBox:Hd,Button:Co,PushButton:Wd,RadioButton:qh,CheckBox:Zd,TextField:rh,PasswordField:Kd,Appearance:Fn},hi.AcroForm={ChoiceField:jh,ListBox:Uh,ComboBox:$h,EditBox:Hd,Button:Co,PushButton:Wd,RadioButton:qh,CheckBox:Zd,TextField:rh,PasswordField:Kd,Appearance:Fn};hi.AcroForm;function z4(e){return e.reduce(function(n,t,i){return n[t]=i,n},{})}(function(e){e.__addimage__={};var n="UNKNOWN",t={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=e.__addimage__.getImageFileTypeByImageData=function(z,R){var J,V,U,Y,ce,re=n;if((R=R||n)==="RGBA"||z.data!==void 0&&z.data instanceof Uint8ClampedArray&&"height"in z&&"width"in z)return"RGBA";if(nt(z))for(ce in t)for(U=t[ce],J=0;J<U.length;J+=1){for(Y=!0,V=0;V<U[J].length;V+=1)if(U[J][V]!==void 0&&U[J][V]!==z[V]){Y=!1;break}if(Y===!0){re=ce;break}}else for(ce in t)for(U=t[ce],J=0;J<U.length;J+=1){for(Y=!0,V=0;V<U[J].length;V+=1)if(U[J][V]!==void 0&&U[J][V]!==z.charCodeAt(V)){Y=!1;break}if(Y===!0){re=ce;break}}return re===n&&R!==n&&(re=R),re},r=function z(R){for(var J=this.internal.write,V=this.internal.putStream,U=(0,this.internal.getFilters)();U.indexOf("FlateEncode")!==-1;)U.splice(U.indexOf("FlateEncode"),1);R.objectId=this.internal.newObject();var Y=[];if(Y.push({key:"Type",value:"/XObject"}),Y.push({key:"Subtype",value:"/Image"}),Y.push({key:"Width",value:R.width}),Y.push({key:"Height",value:R.height}),R.colorSpace===Q.INDEXED?Y.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(R.palette.length/3-1)+" "+("sMask"in R&&R.sMask!==void 0?R.objectId+2:R.objectId+1)+" 0 R]"}):(Y.push({key:"ColorSpace",value:"/"+R.colorSpace}),R.colorSpace===Q.DEVICE_CMYK&&Y.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Y.push({key:"BitsPerComponent",value:R.bitsPerComponent}),"decodeParameters"in R&&R.decodeParameters!==void 0&&Y.push({key:"DecodeParms",value:"<<"+R.decodeParameters+">>"}),"transparency"in R&&Array.isArray(R.transparency)){for(var ce="",re=0,Pe=R.transparency.length;re<Pe;re++)ce+=R.transparency[re]+" "+R.transparency[re]+" ";Y.push({key:"Mask",value:"["+ce+"]"})}R.sMask!==void 0&&Y.push({key:"SMask",value:R.objectId+1+" 0 R"});var Me=R.filter!==void 0?["/"+R.filter]:void 0;if(V({data:R.data,additionalKeyValues:Y,alreadyAppliedFilters:Me,objectId:R.objectId}),J("endobj"),"sMask"in R&&R.sMask!==void 0){var ot="/Predictor "+R.predictor+" /Colors 1 /BitsPerComponent "+R.bitsPerComponent+" /Columns "+R.width,X={width:R.width,height:R.height,colorSpace:"DeviceGray",bitsPerComponent:R.bitsPerComponent,decodeParameters:ot,data:R.sMask};"filter"in R&&(X.filter=R.filter),z.call(this,X)}if(R.colorSpace===Q.INDEXED){var Ee=this.internal.newObject();V({data:O(new Uint8Array(R.palette)),objectId:Ee}),J("endobj")}},o=function(){var z=this.internal.collections.addImage_images;for(var R in z)r.call(this,z[R])},l=function(){var z,R=this.internal.collections.addImage_images,J=this.internal.write;for(var V in R)J("/I"+(z=R[V]).index,z.objectId,"0","R")},h=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},g=function(){var z=this.internal.collections.addImage_images;return h.call(this),z},v=function(){return Object.keys(this.internal.collections.addImage_images).length},_=function(z){return typeof e["process"+z.toUpperCase()]=="function"},x=function(z){return Mr(z)==="object"&&z.nodeType===1},E=function(z,R){if(z.nodeName==="IMG"&&z.hasAttribute("src")){var J=""+z.getAttribute("src");if(J.indexOf("data:image/")===0)return Of(unescape(J).split("base64,").pop());var V=e.loadFile(J,!0);if(V!==void 0)return V}if(z.nodeName==="CANVAS"){if(z.width===0||z.height===0)throw new Error("Given canvas must have data. Canvas width: "+z.width+", height: "+z.height);var U;switch(R){case"PNG":U="image/png";break;case"WEBP":U="image/webp";break;case"JPEG":case"JPG":default:U="image/jpeg"}return Of(z.toDataURL(U,1).split("base64,").pop())}},b=function(z){var R=this.internal.collections.addImage_images;if(R){for(var J in R)if(z===R[J].alias)return R[J]}},D=function(z,R,J){return z||R||(z=-96,R=-96),z<0&&(z=-1*J.width*72/z/this.internal.scaleFactor),R<0&&(R=-1*J.height*72/R/this.internal.scaleFactor),z===0&&(z=R*J.width/J.height),R===0&&(R=z*J.height/J.width),[z,R]},$=function(z,R,J,V,U,Y){var ce=D.call(this,J,V,U),re=this.internal.getCoordinateString,Pe=this.internal.getVerticalCoordinateString,Me=g.call(this);if(J=ce[0],V=ce[1],Me[U.index]=U,Y){Y*=Math.PI/180;var ot=Math.cos(Y),X=Math.sin(Y),Ee=function(H){return H.toFixed(4)},B=[Ee(ot),Ee(X),Ee(-1*X),Ee(ot),0,0,"cm"]}this.internal.write("q"),Y?(this.internal.write([1,"0","0",1,re(z),Pe(R+V),"cm"].join(" ")),this.internal.write(B.join(" ")),this.internal.write([re(J),"0","0",re(V),"0","0","cm"].join(" "))):this.internal.write([re(J),"0","0",re(V),re(z),Pe(R+V),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+U.index+" Do"),this.internal.write("Q")},Q=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var F=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},G=e.__addimage__.sHashCode=function(z){var R,J,V=0;if(typeof z=="string")for(J=z.length,R=0;R<J;R++)V=(V<<5)-V+z.charCodeAt(R),V|=0;else if(nt(z))for(J=z.byteLength/2,R=0;R<J;R++)V=(V<<5)-V+z[R],V|=0;return V},me=e.__addimage__.validateStringAsBase64=function(z){(z=z||"").toString().trim();var R=!0;return z.length===0&&(R=!1),z.length%4!=0&&(R=!1),/^[A-Za-z0-9+/]+$/.test(z.substr(0,z.length-2))===!1&&(R=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(z.substr(-2))===!1&&(R=!1),R},Se=e.__addimage__.extractImageFromDataUrl=function(z){var R=(z=z||"").split("base64,"),J=null;if(R.length===2){var V=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(R[0]);Array.isArray(V)&&(J={mimeType:V[1],charset:V[2],data:R[1]})}return J},Ie=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(z){return Ie()&&z instanceof ArrayBuffer};var nt=e.__addimage__.isArrayBufferView=function(z){return Ie()&&typeof Uint32Array<"u"&&(z instanceof Int8Array||z instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&z instanceof Uint8ClampedArray||z instanceof Int16Array||z instanceof Uint16Array||z instanceof Int32Array||z instanceof Uint32Array||z instanceof Float32Array||z instanceof Float64Array)},Ve=e.__addimage__.binaryStringToUint8Array=function(z){for(var R=z.length,J=new Uint8Array(R),V=0;V<R;V++)J[V]=z.charCodeAt(V);return J},O=e.__addimage__.arrayBufferToBinaryString=function(z){for(var R="",J=nt(z)?z:new Uint8Array(z),V=0;V<J.length;V+=8192)R+=String.fromCharCode.apply(null,J.subarray(V,V+8192));return R};e.addImage=function(){var z,R,J,V,U,Y,ce,re,Pe;if(typeof arguments[1]=="number"?(R=n,J=arguments[1],V=arguments[2],U=arguments[3],Y=arguments[4],ce=arguments[5],re=arguments[6],Pe=arguments[7]):(R=arguments[1],J=arguments[2],V=arguments[3],U=arguments[4],Y=arguments[5],ce=arguments[6],re=arguments[7],Pe=arguments[8]),Mr(z=arguments[0])==="object"&&!x(z)&&"imageData"in z){var Me=z;z=Me.imageData,R=Me.format||R||n,J=Me.x||J||0,V=Me.y||V||0,U=Me.w||Me.width||U,Y=Me.h||Me.height||Y,ce=Me.alias||ce,re=Me.compression||re,Pe=Me.rotation||Me.angle||Pe}var ot=this.internal.getFilters();if(re===void 0&&ot.indexOf("FlateEncode")!==-1&&(re="SLOW"),isNaN(J)||isNaN(V))throw new Error("Invalid coordinates passed to jsPDF.addImage");h.call(this);var X=W.call(this,z,R,ce,re);return $.call(this,J,V,U,Y,X,Pe),this};var W=function(z,R,J,V){var U,Y,ce;if(typeof z=="string"&&i(z)===n){z=unescape(z);var re=ue(z,!1);(re!==""||(re=e.loadFile(z,!0))!==void 0)&&(z=re)}if(x(z)&&(z=E(z,R)),R=i(z,R),!_(R))throw new Error("addImage does not support files of type '"+R+"', please ensure that a plugin for '"+R+"' support is added.");if(((ce=J)==null||ce.length===0)&&(J=function(Pe){return typeof Pe=="string"||nt(Pe)?G(Pe):nt(Pe.data)?G(Pe.data):null}(z)),(U=b.call(this,J))||(Ie()&&(z instanceof Uint8Array||R==="RGBA"||(Y=z,z=Ve(z))),U=this["process"+R.toUpperCase()](z,v.call(this),J,function(Pe){return Pe&&typeof Pe=="string"&&(Pe=Pe.toUpperCase()),Pe in e.image_compression?Pe:F.NONE}(V),Y)),!U)throw new Error("An unknown error occurred whilst processing the image.");return U},ue=e.__addimage__.convertBase64ToBinaryString=function(z,R){var J;R=typeof R!="boolean"||R;var V,U="";if(typeof z=="string"){V=(J=Se(z))!==null?J.data:z;try{U=Of(V)}catch(Y){if(R)throw me(V)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Y.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return U};e.getImageProperties=function(z){var R,J,V="";if(x(z)&&(z=E(z)),typeof z=="string"&&i(z)===n&&((V=ue(z,!1))===""&&(V=e.loadFile(z)||""),z=V),J=i(z),!_(J))throw new Error("addImage does not support files of type '"+J+"', please ensure that a plugin for '"+J+"' support is added.");if(!Ie()||z instanceof Uint8Array||(z=Ve(z)),!(R=this["process"+J.toUpperCase()](z)))throw new Error("An unknown error occurred whilst processing the image");return R.fileType=J,R}})(hi.API),function(e){var n=function(t){if(t!==void 0&&t!="")return!0};hi.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(t){for(var i,r,o,l=this.internal.getCoordinateString,h=this.internal.getVerticalCoordinateString,g=this.internal.getPageInfoByObjId(t.objId),v=t.pageContext.annotations,_=!1,x=0;x<v.length&&!_;x++)switch((i=v[x]).type){case"link":(n(i.options.url)||n(i.options.pageNumber))&&(_=!0);break;case"reference":case"text":case"freetext":_=!0}if(_!=0){this.internal.write("/Annots [");for(var E=0;E<v.length;E++){i=v[E];var b=this.internal.pdfEscape,D=this.internal.getEncryptor(t.objId);switch(i.type){case"reference":this.internal.write(" "+i.object.objId+" 0 R ");break;case"text":var $=this.internal.newAdditionalObject(),Q=this.internal.newAdditionalObject(),F=this.internal.getEncryptor($.objId),G=i.title||"Note";o="<</Type /Annot /Subtype /Text "+(r="/Rect ["+l(i.bounds.x)+" "+h(i.bounds.y+i.bounds.h)+" "+l(i.bounds.x+i.bounds.w)+" "+h(i.bounds.y)+"] ")+"/Contents ("+b(F(i.contents))+")",o+=" /Popup "+Q.objId+" 0 R",o+=" /P "+g.objId+" 0 R",o+=" /T ("+b(F(G))+") >>",$.content=o;var me=$.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(r="/Rect ["+l(i.bounds.x+30)+" "+h(i.bounds.y+i.bounds.h)+" "+l(i.bounds.x+i.bounds.w+30)+" "+h(i.bounds.y)+"] ")+" /Parent "+me,i.open&&(o+=" /Open true"),o+=" >>",Q.content=o,this.internal.write($.objId,"0 R",Q.objId,"0 R");break;case"freetext":r="/Rect ["+l(i.bounds.x)+" "+h(i.bounds.y)+" "+l(i.bounds.x+i.bounds.w)+" "+h(i.bounds.y+i.bounds.h)+"] ";var Se=i.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+r+"/Contents ("+b(D(i.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+Se+")",o+=" /Border [0 0 0]",o+=" >>",this.internal.write(o);break;case"link":if(i.options.name){var Ie=this.annotations._nameMap[i.options.name];i.options.pageNumber=Ie.page,i.options.top=Ie.y}else i.options.top||(i.options.top=0);if(r="/Rect ["+i.finalBounds.x+" "+i.finalBounds.y+" "+i.finalBounds.w+" "+i.finalBounds.h+"] ",o="",i.options.url)o="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /A <</S /URI /URI ("+b(D(i.options.url))+") >>";else if(i.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(i.options.pageNumber).objId+" 0 R",i.options.magFactor=i.options.magFactor||"XYZ",i.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+i.options.top+"]";break;case"FitV":i.options.left=i.options.left||0,o+=" /FitV "+i.options.left+"]";break;case"XYZ":default:var nt=h(i.options.top);i.options.left=i.options.left||0,i.options.zoom===void 0&&(i.options.zoom=0),o+=" /XYZ "+i.options.left+" "+nt+" "+i.options.zoom+"]"}o!=""&&(o+=" >>",this.internal.write(o))}}this.internal.write("]")}}]),e.createAnnotation=function(t){var i=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":i.pageContext.annotations.push(t)}},e.link=function(t,i,r,o,l){var h=this.internal.getCurrentPageInfo(),g=this.internal.getCoordinateString,v=this.internal.getVerticalCoordinateString;h.pageContext.annotations.push({finalBounds:{x:g(t),y:v(i),w:g(t+r),h:v(i+o)},options:l,type:"link"})},e.textWithLink=function(t,i,r,o){var l,h,g=this.getTextWidth(t),v=this.internal.getLineHeight()/this.internal.scaleFactor;if(o.maxWidth!==void 0){h=o.maxWidth;var _=this.splitTextToSize(t,h).length;l=Math.ceil(v*_)}else h=g,l=v;return this.text(t,i,r,o),r+=.2*v,o.align==="center"&&(i-=g/2),o.align==="right"&&(i-=g),this.link(i,r-v,h,l,o),g},e.getTextWidth=function(t){var i=this.internal.getFontSize();return this.getStringUnitWidth(t)*i/this.internal.scaleFactor}}(hi.API),function(e){var n={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},i={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},r=[1570,1571,1573,1575];e.__arabicParser__={};var o=e.__arabicParser__.isInArabicSubstitutionA=function($){return n[$.charCodeAt(0)]!==void 0},l=e.__arabicParser__.isArabicLetter=function($){return typeof $=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test($)},h=e.__arabicParser__.isArabicEndLetter=function($){return l($)&&o($)&&n[$.charCodeAt(0)].length<=2},g=e.__arabicParser__.isArabicAlfLetter=function($){return l($)&&r.indexOf($.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function($){return l($)&&o($)&&n[$.charCodeAt(0)].length>=1};var v=e.__arabicParser__.arabicLetterHasFinalForm=function($){return l($)&&o($)&&n[$.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function($){return l($)&&o($)&&n[$.charCodeAt(0)].length>=3};var _=e.__arabicParser__.arabicLetterHasMedialForm=function($){return l($)&&o($)&&n[$.charCodeAt(0)].length==4},x=e.__arabicParser__.resolveLigatures=function($){var Q=0,F=t,G="",me=0;for(Q=0;Q<$.length;Q+=1)F[$.charCodeAt(Q)]!==void 0?(me++,typeof(F=F[$.charCodeAt(Q)])=="number"&&(G+=String.fromCharCode(F),F=t,me=0),Q===$.length-1&&(F=t,G+=$.charAt(Q-(me-1)),Q-=me-1,me=0)):(F=t,G+=$.charAt(Q-me),Q-=me,me=0);return G};e.__arabicParser__.isArabicDiacritic=function($){return $!==void 0&&i[$.charCodeAt(0)]!==void 0};var E=e.__arabicParser__.getCorrectForm=function($,Q,F){return l($)?o($)===!1?-1:!v($)||!l(Q)&&!l(F)||!l(F)&&h(Q)||h($)&&!l(Q)||h($)&&g(Q)||h($)&&h(Q)?0:_($)&&l(Q)&&!h(Q)&&l(F)&&v(F)?3:h($)||!l(F)?1:2:-1},b=function($){var Q=0,F=0,G=0,me="",Se="",Ie="",nt=($=$||"").split("\\s+"),Ve=[];for(Q=0;Q<nt.length;Q+=1){for(Ve.push(""),F=0;F<nt[Q].length;F+=1)me=nt[Q][F],Se=nt[Q][F-1],Ie=nt[Q][F+1],l(me)?(G=E(me,Se,Ie),Ve[Q]+=G!==-1?String.fromCharCode(n[me.charCodeAt(0)][G]):me):Ve[Q]+=me;Ve[Q]=x(Ve[Q])}return Ve.join(" ")},D=e.__arabicParser__.processArabic=e.processArabic=function(){var $,Q=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,F=[];if(Array.isArray(Q)){var G=0;for(F=[],G=0;G<Q.length;G+=1)Array.isArray(Q[G])?F.push([b(Q[G][0]),Q[G][1],Q[G][2]]):F.push([b(Q[G])]);$=F}else $=b(Q);return typeof arguments[0]=="string"?$:(arguments[0].text=$,arguments[0])};e.events.push(["preProcessText",D])}(hi.API),hi.API.autoPrint=function(e){var n;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){n=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+n+" 0 R")})}return this},function(e){var n=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(h){t=h}});var i=150;Object.defineProperty(this,"width",{get:function(){return i},set:function(h){i=isNaN(h)||Number.isInteger(h)===!1||h<0?150:h,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=i+1)}});var r=300;Object.defineProperty(this,"height",{get:function(){return r},set:function(h){r=isNaN(h)||Number.isInteger(h)===!1||h<0?300:h,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=r+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(h){o=h}});var l={};Object.defineProperty(this,"style",{get:function(){return l},set:function(h){l=h}}),Object.defineProperty(this,"parentNode",{})};n.prototype.getContext=function(t,i){var r;if((t=t||"2d")!=="2d")return null;for(r in i)this.pdf.context2d.hasOwnProperty(r)&&(this.pdf.context2d[r]=i[r]);return this.pdf.context2d._canvas=this,this.pdf.context2d},n.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new n,this.canvas.pdf=this}])}(hi.API),function(e){var n={left:0,top:0,bottom:0,right:0},t=!1,i=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},n),this.internal.__cell__.margins.width=this.getPageWidth(),r.call(this))},r=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var g=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return g},set:function($){g=$}});var v=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return v},set:function($){v=$}});var _=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return _},set:function($){_=$}});var x=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return x},set:function($){x=$}});var E=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return E},set:function($){E=$}});var b=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return b},set:function($){b=$}});var D=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return D},set:function($){D=$}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(g){return i.call(this),this.internal.__cell__.headerFunction=typeof g=="function"?g:void 0,this},e.getTextDimensions=function(g,v){i.call(this);var _=(v=v||{}).fontSize||this.getFontSize(),x=v.font||this.getFont(),E=v.scaleFactor||this.internal.scaleFactor,b=0,D=0,$=0,Q=this;if(!Array.isArray(g)&&typeof g!="string"){if(typeof g!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");g=String(g)}var F=v.maxWidth;F>0?typeof g=="string"?g=this.splitTextToSize(g,F):Object.prototype.toString.call(g)==="[object Array]"&&(g=g.reduce(function(me,Se){return me.concat(Q.splitTextToSize(Se,F))},[])):g=Array.isArray(g)?g:[g];for(var G=0;G<g.length;G++)b<($=this.getStringUnitWidth(g[G],{font:x})*_)&&(b=$);return b!==0&&(D=g.length),{w:b/=E,h:Math.max((D*_*this.getLineHeightFactor()-_*(this.getLineHeightFactor()-1))/E,0)}},e.cellAddPage=function(){i.call(this),this.addPage();var g=this.internal.__cell__.margins||n;return this.internal.__cell__.lastCell=new o(g.left,g.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var l=e.cell=function(){var g;g=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),i.call(this);var v=this.internal.__cell__.lastCell,_=this.internal.__cell__.padding,x=this.internal.__cell__.margins||n,E=this.internal.__cell__.tableHeaderRow,b=this.internal.__cell__.printHeaders;return v.lineNumber!==void 0&&(v.lineNumber===g.lineNumber?(g.x=(v.x||0)+(v.width||0),g.y=v.y||0):v.y+v.height+g.height+x.bottom>this.getPageHeight()?(this.cellAddPage(),g.y=x.top,b&&E&&(this.printHeaderRow(g.lineNumber,!0),g.y+=E[0].height)):g.y=v.y+v.height||g.y),g.text[0]!==void 0&&(this.rect(g.x,g.y,g.width,g.height,t===!0?"FD":void 0),g.align==="right"?this.text(g.text,g.x+g.width-_,g.y+_,{align:"right",baseline:"top"}):g.align==="center"?this.text(g.text,g.x+g.width/2,g.y+_,{align:"center",baseline:"top",maxWidth:g.width-_-_}):this.text(g.text,g.x+_,g.y+_,{align:"left",baseline:"top",maxWidth:g.width-_-_})),this.internal.__cell__.lastCell=g,this};e.table=function(g,v,_,x,E){if(i.call(this),!_)throw new Error("No data for PDF table.");var b,D,$,Q,F=[],G=[],me=[],Se={},Ie={},nt=[],Ve=[],O=(E=E||{}).autoSize||!1,W=E.printHeaders!==!1,ue=E.css&&E.css["font-size"]!==void 0?16*E.css["font-size"]:E.fontSize||12,z=E.margins||Object.assign({width:this.getPageWidth()},n),R=typeof E.padding=="number"?E.padding:3,J=E.headerBackgroundColor||"#c8c8c8",V=E.headerTextColor||"#000";if(r.call(this),this.internal.__cell__.printHeaders=W,this.internal.__cell__.margins=z,this.internal.__cell__.table_font_size=ue,this.internal.__cell__.padding=R,this.internal.__cell__.headerBackgroundColor=J,this.internal.__cell__.headerTextColor=V,this.setFontSize(ue),x==null)G=F=Object.keys(_[0]),me=F.map(function(){return"left"});else if(Array.isArray(x)&&Mr(x[0])==="object")for(F=x.map(function(Me){return Me.name}),G=x.map(function(Me){return Me.prompt||Me.name||""}),me=x.map(function(Me){return Me.align||"left"}),b=0;b<x.length;b+=1)Ie[x[b].name]=x[b].width*(19.049976/25.4);else Array.isArray(x)&&typeof x[0]=="string"&&(G=F=x,me=F.map(function(){return"left"}));if(O||Array.isArray(x)&&typeof x[0]=="string")for(b=0;b<F.length;b+=1){for(Se[Q=F[b]]=_.map(function(Me){return Me[Q]}),this.setFont(void 0,"bold"),nt.push(this.getTextDimensions(G[b],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),D=Se[Q],this.setFont(void 0,"normal"),$=0;$<D.length;$+=1)nt.push(this.getTextDimensions(D[$],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);Ie[Q]=Math.max.apply(null,nt)+R+R,nt=[]}if(W){var U={};for(b=0;b<F.length;b+=1)U[F[b]]={},U[F[b]].text=G[b],U[F[b]].align=me[b];var Y=h.call(this,U,Ie);Ve=F.map(function(Me){return new o(g,v,Ie[Me],Y,U[Me].text,void 0,U[Me].align)}),this.setTableHeaderRow(Ve),this.printHeaderRow(1,!1)}var ce=x.reduce(function(Me,ot){return Me[ot.name]=ot.align,Me},{});for(b=0;b<_.length;b+=1){"rowStart"in E&&E.rowStart instanceof Function&&E.rowStart({row:b,data:_[b]},this);var re=h.call(this,_[b],Ie);for($=0;$<F.length;$+=1){var Pe=_[b][F[$]];"cellStart"in E&&E.cellStart instanceof Function&&E.cellStart({row:b,col:$,data:Pe},this),l.call(this,new o(g,v,Ie[F[$]],re,Pe,b+2,ce[F[$]]))}}return this.internal.__cell__.table_x=g,this.internal.__cell__.table_y=v,this};var h=function(g,v){var _=this.internal.__cell__.padding,x=this.internal.__cell__.table_font_size,E=this.internal.scaleFactor;return Object.keys(g).map(function(b){var D=g[b];return this.splitTextToSize(D.hasOwnProperty("text")?D.text:D,v[b]-_-_)},this).map(function(b){return this.getLineHeightFactor()*b.length*x/E+_+_},this).reduce(function(b,D){return Math.max(b,D)},0)};e.setTableHeaderRow=function(g){i.call(this),this.internal.__cell__.tableHeaderRow=g},e.printHeaderRow=function(g,v){if(i.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var _;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var x=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(x[0],x[1],x[2],x[3],void 0,-1)}this.setFont(void 0,"bold");for(var E=[],b=0;b<this.internal.__cell__.tableHeaderRow.length;b+=1){_=this.internal.__cell__.tableHeaderRow[b].clone(),v&&(_.y=this.internal.__cell__.margins.top||0,E.push(_)),_.lineNumber=g;var D=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),l.call(this,_),this.setTextColor(D)}E.length>0&&this.setTableHeaderRow(E),this.setFont(void 0,"normal"),t=!1}}(hi.API);var j4={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},U4=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Wg=z4(U4),$4=[100,200,300,400,500,600,700,800,900],oN=z4($4);function Zg(e){var n=e.family.replace(/"|'/g,"").toLowerCase(),t=function(o){return j4[o=o||"normal"]?o:"normal"}(e.style),i=function(o){if(!o)return 400;if(typeof o=="number")return o>=100&&o<=900&&o%100==0?o:400;if(/^\d00$/.test(o))return parseInt(o);switch(o){case"bold":return 700;case"normal":default:return 400}}(e.weight),r=function(o){return typeof Wg[o=o||"normal"]=="number"?o:"normal"}(e.stretch);return{family:n,style:t,weight:i,stretch:r,src:e.src||[],ref:e.ref||{name:n,style:[r,t,i].join(" ")}}}function Oy(e,n,t,i){var r;for(r=t;r>=0&&r<n.length;r+=i)if(e[n[r]])return e[n[r]];for(r=t;r>=0&&r<n.length;r-=i)if(e[n[r]])return e[n[r]]}var aN={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Iy={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Fy(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function lN(e,n,t){for(var i=(t=t||{}).defaultFontFamily||"times",r=Object.assign({},aN,t.genericFontFamilies||{}),o=null,l=null,h=0;h<n.length;++h)if(r[(o=Zg(n[h])).family]&&(o.family=r[o.family]),e.hasOwnProperty(o.family)){l=e[o.family];break}if(!(l=l||e[i]))throw new Error("Could not find a font-family for the rule '"+Fy(o)+"' and default family '"+i+"'.");if(l=function(g,v){if(v[g])return v[g];var _=Wg[g],x=_<=Wg.normal?-1:1,E=Oy(v,U4,_,x);if(!E)throw new Error("Could not find a matching font-stretch value for "+g);return E}(o.stretch,l),l=function(g,v){if(v[g])return v[g];for(var _=j4[g],x=0;x<_.length;++x)if(v[_[x]])return v[_[x]];throw new Error("Could not find a matching font-style for "+g)}(o.style,l),!(l=function(g,v){if(v[g])return v[g];if(g===400&&v[500])return v[500];if(g===500&&v[400])return v[400];var _=oN[g],x=Oy(v,$4,_,g<400?-1:1);if(!x)throw new Error("Could not find a matching font-weight for value "+g);return x}(o.weight,l)))throw new Error("Failed to resolve a font for the rule '"+Fy(o)+"'.");return l}function zy(e){return e.trimLeft()}function uN(e,n){for(var t=0;t<e.length;){if(e.charAt(t)===n)return[e.substring(0,t),e.substring(t+1)];t+=1}return null}function cN(e){var n=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return n===null?null:[n[0],e.substring(n[0].length)]}var Td,jy,Uy,X0=["times"];(function(e){var n,t,i,r,o,l,h,g,v,_=function(X){return X=X||{},this.isStrokeTransparent=X.isStrokeTransparent||!1,this.strokeOpacity=X.strokeOpacity||1,this.strokeStyle=X.strokeStyle||"#000000",this.fillStyle=X.fillStyle||"#000000",this.isFillTransparent=X.isFillTransparent||!1,this.fillOpacity=X.fillOpacity||1,this.font=X.font||"10px sans-serif",this.textBaseline=X.textBaseline||"alphabetic",this.textAlign=X.textAlign||"left",this.lineWidth=X.lineWidth||1,this.lineJoin=X.lineJoin||"miter",this.lineCap=X.lineCap||"butt",this.path=X.path||[],this.transform=X.transform!==void 0?X.transform.clone():new g,this.globalCompositeOperation=X.globalCompositeOperation||"normal",this.globalAlpha=X.globalAlpha||1,this.clip_path=X.clip_path||[],this.currentPoint=X.currentPoint||new l,this.miterLimit=X.miterLimit||10,this.lastPoint=X.lastPoint||new l,this.lineDashOffset=X.lineDashOffset||0,this.lineDash=X.lineDash||[],this.margin=X.margin||[0,0,0,0],this.prevPageLastElemOffset=X.prevPageLastElemOffset||0,this.ignoreClearRect=typeof X.ignoreClearRect!="boolean"||X.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new x(this),n=this.internal.f2,t=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,r=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,l=this.internal.Point,h=this.internal.Rectangle,g=this.internal.Matrix,v=new _}]);var x=function(X){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var Ee=X;Object.defineProperty(this,"pdf",{get:function(){return Ee}});var B=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return B},set:function(ye){B=!!ye}});var H=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return H},set:function(ye){H=!!ye}});var he=0;Object.defineProperty(this,"posX",{get:function(){return he},set:function(ye){isNaN(ye)||(he=ye)}});var te=0;Object.defineProperty(this,"posY",{get:function(){return te},set:function(ye){isNaN(ye)||(te=ye)}}),Object.defineProperty(this,"margin",{get:function(){return v.margin},set:function(ye){var le;typeof ye=="number"?le=[ye,ye,ye,ye]:((le=new Array(4))[0]=ye[0],le[1]=ye.length>=2?ye[1]:le[0],le[2]=ye.length>=3?ye[2]:le[0],le[3]=ye.length>=4?ye[3]:le[1]),v.margin=le}});var ie=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ie},set:function(ye){ie=ye}});var ee=0;Object.defineProperty(this,"lastBreak",{get:function(){return ee},set:function(ye){ee=ye}});var se=[];Object.defineProperty(this,"pageBreaks",{get:function(){return se},set:function(ye){se=ye}}),Object.defineProperty(this,"ctx",{get:function(){return v},set:function(ye){ye instanceof _&&(v=ye)}}),Object.defineProperty(this,"path",{get:function(){return v.path},set:function(ye){v.path=ye}});var Ce=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ce},set:function(ye){Ce=ye}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ye){var le;le=E(ye),this.ctx.fillStyle=le.style,this.ctx.isFillTransparent=le.a===0,this.ctx.fillOpacity=le.a,this.pdf.setFillColor(le.r,le.g,le.b,{a:le.a}),this.pdf.setTextColor(le.r,le.g,le.b,{a:le.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ye){var le=E(ye);this.ctx.strokeStyle=le.style,this.ctx.isStrokeTransparent=le.a===0,this.ctx.strokeOpacity=le.a,le.a===0?this.pdf.setDrawColor(255,255,255):(le.a,this.pdf.setDrawColor(le.r,le.g,le.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ye){["butt","round","square"].indexOf(ye)!==-1&&(this.ctx.lineCap=ye,this.pdf.setLineCap(ye))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ye){isNaN(ye)||(this.ctx.lineWidth=ye,this.pdf.setLineWidth(ye))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ye){["bevel","round","miter"].indexOf(ye)!==-1&&(this.ctx.lineJoin=ye,this.pdf.setLineJoin(ye))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ye){isNaN(ye)||(this.ctx.miterLimit=ye,this.pdf.setMiterLimit(ye))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ye){this.ctx.textBaseline=ye}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ye){["right","end","center","left","start"].indexOf(ye)!==-1&&(this.ctx.textAlign=ye)}});var ne=null;function ae(ye,le){if(ne===null){var je=function(Re){var Ae=[];return Object.keys(Re).forEach(function(qe){Re[qe].forEach(function(Oe){var et=null;switch(Oe){case"bold":et={family:qe,weight:"bold"};break;case"italic":et={family:qe,style:"italic"};break;case"bolditalic":et={family:qe,weight:"bold",style:"italic"};break;case"":case"normal":et={family:qe}}et!==null&&(et.ref={name:qe,style:Oe},Ae.push(et))})}),Ae}(ye.getFontList());ne=function(Re){for(var Ae={},qe=0;qe<Re.length;++qe){var Oe=Zg(Re[qe]),et=Oe.family,Je=Oe.stretch,mt=Oe.style,_t=Oe.weight;Ae[et]=Ae[et]||{},Ae[et][Je]=Ae[et][Je]||{},Ae[et][Je][mt]=Ae[et][Je][mt]||{},Ae[et][Je][mt][_t]=Oe}return Ae}(je.concat(le))}return ne}var xe=null;Object.defineProperty(this,"fontFaces",{get:function(){return xe},set:function(ye){ne=null,xe=ye}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ye){var le;if(this.ctx.font=ye,(le=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(ye))!==null){var je=le[1],Re=(le[2],le[3]),Ae=le[4],qe=(le[5],le[6]),Oe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ae)[2];Ae=Math.floor(Oe==="px"?parseFloat(Ae)*this.pdf.internal.scaleFactor:Oe==="em"?parseFloat(Ae)*this.pdf.getFontSize():parseFloat(Ae)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ae);var et=function(Kt){var Qt,Qe,We=[],Ut=Kt.trim();if(Ut==="")return X0;if(Ut in Iy)return[Iy[Ut]];for(;Ut!=="";){switch(Qe=null,Qt=(Ut=zy(Ut)).charAt(0)){case'"':case"'":Qe=uN(Ut.substring(1),Qt);break;default:Qe=cN(Ut)}if(Qe===null||(We.push(Qe[0]),(Ut=zy(Qe[1]))!==""&&Ut.charAt(0)!==","))return X0;Ut=Ut.replace(/^,/,"")}return We}(qe);if(this.fontFaces){var Je=lN(ae(this.pdf,this.fontFaces),et.map(function(Kt){return{family:Kt,stretch:"normal",weight:Re,style:je}}));this.pdf.setFont(Je.ref.name,Je.ref.style)}else{var mt="";(Re==="bold"||parseInt(Re,10)>=700||je==="bold")&&(mt="bold"),je==="italic"&&(mt+="italic"),mt.length===0&&(mt="normal");for(var _t="",$t={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Xt=0;Xt<et.length;Xt++){if(this.pdf.internal.getFont(et[Xt],mt,{noFallback:!0,disableWarning:!0})!==void 0){_t=et[Xt];break}if(mt==="bolditalic"&&this.pdf.internal.getFont(et[Xt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)_t=et[Xt],mt="bold";else if(this.pdf.internal.getFont(et[Xt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){_t=et[Xt],mt="normal";break}}if(_t===""){for(var Xe=0;Xe<et.length;Xe++)if($t[et[Xe]]){_t=$t[et[Xe]];break}}_t=_t===""?"Times":_t,this.pdf.setFont(_t,mt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ye){this.ctx.globalCompositeOperation=ye}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ye){this.ctx.globalAlpha=ye}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ye){this.ctx.lineDashOffset=ye,ot.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ye){this.ctx.lineDash=ye,ot.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ye){this.ctx.ignoreClearRect=!!ye}})};x.prototype.setLineDash=function(X){this.lineDash=X},x.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},x.prototype.fill=function(){Se.call(this,"fill",!1)},x.prototype.stroke=function(){Se.call(this,"stroke",!1)},x.prototype.beginPath=function(){this.path=[{type:"begin"}]},x.prototype.moveTo=function(X,Ee){if(isNaN(X)||isNaN(Ee))throw zr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var B=this.ctx.transform.applyToPoint(new l(X,Ee));this.path.push({type:"mt",x:B.x,y:B.y}),this.ctx.lastPoint=new l(X,Ee)},x.prototype.closePath=function(){var X=new l(0,0),Ee=0;for(Ee=this.path.length-1;Ee!==-1;Ee--)if(this.path[Ee].type==="begin"&&Mr(this.path[Ee+1])==="object"&&typeof this.path[Ee+1].x=="number"){X=new l(this.path[Ee+1].x,this.path[Ee+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l(X.x,X.y)},x.prototype.lineTo=function(X,Ee){if(isNaN(X)||isNaN(Ee))throw zr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var B=this.ctx.transform.applyToPoint(new l(X,Ee));this.path.push({type:"lt",x:B.x,y:B.y}),this.ctx.lastPoint=new l(B.x,B.y)},x.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),Se.call(this,null,!0)},x.prototype.quadraticCurveTo=function(X,Ee,B,H){if(isNaN(B)||isNaN(H)||isNaN(X)||isNaN(Ee))throw zr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var he=this.ctx.transform.applyToPoint(new l(B,H)),te=this.ctx.transform.applyToPoint(new l(X,Ee));this.path.push({type:"qct",x1:te.x,y1:te.y,x:he.x,y:he.y}),this.ctx.lastPoint=new l(he.x,he.y)},x.prototype.bezierCurveTo=function(X,Ee,B,H,he,te){if(isNaN(he)||isNaN(te)||isNaN(X)||isNaN(Ee)||isNaN(B)||isNaN(H))throw zr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ie=this.ctx.transform.applyToPoint(new l(he,te)),ee=this.ctx.transform.applyToPoint(new l(X,Ee)),se=this.ctx.transform.applyToPoint(new l(B,H));this.path.push({type:"bct",x1:ee.x,y1:ee.y,x2:se.x,y2:se.y,x:ie.x,y:ie.y}),this.ctx.lastPoint=new l(ie.x,ie.y)},x.prototype.arc=function(X,Ee,B,H,he,te){if(isNaN(X)||isNaN(Ee)||isNaN(B)||isNaN(H)||isNaN(he))throw zr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(te=!!te,!this.ctx.transform.isIdentity){var ie=this.ctx.transform.applyToPoint(new l(X,Ee));X=ie.x,Ee=ie.y;var ee=this.ctx.transform.applyToPoint(new l(0,B)),se=this.ctx.transform.applyToPoint(new l(0,0));B=Math.sqrt(Math.pow(ee.x-se.x,2)+Math.pow(ee.y-se.y,2))}Math.abs(he-H)>=2*Math.PI&&(H=0,he=2*Math.PI),this.path.push({type:"arc",x:X,y:Ee,radius:B,startAngle:H,endAngle:he,counterclockwise:te})},x.prototype.arcTo=function(X,Ee,B,H,he){throw new Error("arcTo not implemented.")},x.prototype.rect=function(X,Ee,B,H){if(isNaN(X)||isNaN(Ee)||isNaN(B)||isNaN(H))throw zr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(X,Ee),this.lineTo(X+B,Ee),this.lineTo(X+B,Ee+H),this.lineTo(X,Ee+H),this.lineTo(X,Ee),this.lineTo(X+B,Ee),this.lineTo(X,Ee)},x.prototype.fillRect=function(X,Ee,B,H){if(isNaN(X)||isNaN(Ee)||isNaN(B)||isNaN(H))throw zr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!b.call(this)){var he={};this.lineCap!=="butt"&&(he.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(he.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(X,Ee,B,H),this.fill(),he.hasOwnProperty("lineCap")&&(this.lineCap=he.lineCap),he.hasOwnProperty("lineJoin")&&(this.lineJoin=he.lineJoin)}},x.prototype.strokeRect=function(X,Ee,B,H){if(isNaN(X)||isNaN(Ee)||isNaN(B)||isNaN(H))throw zr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");D.call(this)||(this.beginPath(),this.rect(X,Ee,B,H),this.stroke())},x.prototype.clearRect=function(X,Ee,B,H){if(isNaN(X)||isNaN(Ee)||isNaN(B)||isNaN(H))throw zr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(X,Ee,B,H))},x.prototype.save=function(X){X=typeof X!="boolean"||X;for(var Ee=this.pdf.internal.getCurrentPageInfo().pageNumber,B=0;B<this.pdf.internal.getNumberOfPages();B++)this.pdf.setPage(B+1),this.pdf.internal.out("q");if(this.pdf.setPage(Ee),X){this.ctx.fontSize=this.pdf.internal.getFontSize();var H=new _(this.ctx);this.ctxStack.push(this.ctx),this.ctx=H}},x.prototype.restore=function(X){X=typeof X!="boolean"||X;for(var Ee=this.pdf.internal.getCurrentPageInfo().pageNumber,B=0;B<this.pdf.internal.getNumberOfPages();B++)this.pdf.setPage(B+1),this.pdf.internal.out("Q");this.pdf.setPage(Ee),X&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},x.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var E=function(X){var Ee,B,H,he;if(X.isCanvasGradient===!0&&(X=X.getColor()),!X)return{r:0,g:0,b:0,a:0,style:X};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(X))Ee=0,B=0,H=0,he=0;else{var te=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(X);if(te!==null)Ee=parseInt(te[1]),B=parseInt(te[2]),H=parseInt(te[3]),he=1;else if((te=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(X))!==null)Ee=parseInt(te[1]),B=parseInt(te[2]),H=parseInt(te[3]),he=parseFloat(te[4]);else{if(he=1,typeof X=="string"&&X.charAt(0)!=="#"){var ie=new N4(X);X=ie.ok?ie.toHex():"#000000"}X.length===4?(Ee=X.substring(1,2),Ee+=Ee,B=X.substring(2,3),B+=B,H=X.substring(3,4),H+=H):(Ee=X.substring(1,3),B=X.substring(3,5),H=X.substring(5,7)),Ee=parseInt(Ee,16),B=parseInt(B,16),H=parseInt(H,16)}}return{r:Ee,g:B,b:H,a:he,style:X}},b=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},D=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};x.prototype.fillText=function(X,Ee,B,H){if(isNaN(Ee)||isNaN(B)||typeof X!="string")throw zr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(H=isNaN(H)?void 0:H,!b.call(this)){var he=re(this.ctx.transform.rotation),te=this.ctx.transform.scaleX;R.call(this,{text:X,x:Ee,y:B,scale:te,angle:he,align:this.textAlign,maxWidth:H})}},x.prototype.strokeText=function(X,Ee,B,H){if(isNaN(Ee)||isNaN(B)||typeof X!="string")throw zr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!D.call(this)){H=isNaN(H)?void 0:H;var he=re(this.ctx.transform.rotation),te=this.ctx.transform.scaleX;R.call(this,{text:X,x:Ee,y:B,scale:te,renderingMode:"stroke",angle:he,align:this.textAlign,maxWidth:H})}},x.prototype.measureText=function(X){if(typeof X!="string")throw zr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var Ee=this.pdf,B=this.pdf.internal.scaleFactor,H=Ee.internal.getFontSize(),he=Ee.getStringUnitWidth(X)*H/Ee.internal.scaleFactor,te=function(ie){var ee=(ie=ie||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ee}}),this};return new te({width:he*=Math.round(96*B/72*1e4)/1e4})},x.prototype.scale=function(X,Ee){if(isNaN(X)||isNaN(Ee))throw zr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var B=new g(X,0,0,Ee,0,0);this.ctx.transform=this.ctx.transform.multiply(B)},x.prototype.rotate=function(X){if(isNaN(X))throw zr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var Ee=new g(Math.cos(X),Math.sin(X),-Math.sin(X),Math.cos(X),0,0);this.ctx.transform=this.ctx.transform.multiply(Ee)},x.prototype.translate=function(X,Ee){if(isNaN(X)||isNaN(Ee))throw zr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var B=new g(1,0,0,1,X,Ee);this.ctx.transform=this.ctx.transform.multiply(B)},x.prototype.transform=function(X,Ee,B,H,he,te){if(isNaN(X)||isNaN(Ee)||isNaN(B)||isNaN(H)||isNaN(he)||isNaN(te))throw zr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ie=new g(X,Ee,B,H,he,te);this.ctx.transform=this.ctx.transform.multiply(ie)},x.prototype.setTransform=function(X,Ee,B,H,he,te){X=isNaN(X)?1:X,Ee=isNaN(Ee)?0:Ee,B=isNaN(B)?0:B,H=isNaN(H)?1:H,he=isNaN(he)?0:he,te=isNaN(te)?0:te,this.ctx.transform=new g(X,Ee,B,H,he,te)};var $=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};x.prototype.drawImage=function(X,Ee,B,H,he,te,ie,ee,se){var Ce=this.pdf.getImageProperties(X),ne=1,ae=1,xe=1,ye=1;H!==void 0&&ee!==void 0&&(xe=ee/H,ye=se/he,ne=Ce.width/H*ee/H,ae=Ce.height/he*se/he),te===void 0&&(te=Ee,ie=B,Ee=0,B=0),H!==void 0&&ee===void 0&&(ee=H,se=he),H===void 0&&ee===void 0&&(ee=Ce.width,se=Ce.height);for(var le,je=this.ctx.transform.decompose(),Re=re(je.rotate.shx),Ae=new g,qe=(Ae=(Ae=(Ae=Ae.multiply(je.translate)).multiply(je.skew)).multiply(je.scale)).applyToRectangle(new h(te-Ee*xe,ie-B*ye,H*ne,he*ae)),Oe=Q.call(this,qe),et=[],Je=0;Je<Oe.length;Je+=1)et.indexOf(Oe[Je])===-1&&et.push(Oe[Je]);if(me(et),this.autoPaging)for(var mt=et[0],_t=et[et.length-1],$t=mt;$t<_t+1;$t++){this.pdf.setPage($t);var Xt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Xe=$t===1?this.posY+this.margin[0]:this.margin[0],Kt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Qt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Qe=$t===1?0:Kt+($t-2)*Qt;if(this.ctx.clip_path.length!==0){var We=this.path;le=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=G(le,this.posX+this.margin[3],-Qe+Xe+this.ctx.prevPageLastElemOffset),Ie.call(this,"fill",!0),this.path=We}var Ut=JSON.parse(JSON.stringify(qe));Ut=G([Ut],this.posX+this.margin[3],-Qe+Xe+this.ctx.prevPageLastElemOffset)[0];var pn=($t>mt||$t<_t)&&$.call(this);pn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Xt,Qt,null).clip().discardPath()),this.pdf.addImage(X,"JPEG",Ut.x,Ut.y,Ut.w,Ut.h,null,null,Re),pn&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(X,"JPEG",qe.x,qe.y,qe.w,qe.h,null,null,Re)};var Q=function(X,Ee,B){var H=[];Ee=Ee||this.pdf.internal.pageSize.width,B=B||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var he=this.posY+this.ctx.prevPageLastElemOffset;switch(X.type){default:case"mt":case"lt":H.push(Math.floor((X.y+he)/B)+1);break;case"arc":H.push(Math.floor((X.y+he-X.radius)/B)+1),H.push(Math.floor((X.y+he+X.radius)/B)+1);break;case"qct":var te=Pe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,X.x1,X.y1,X.x,X.y);H.push(Math.floor((te.y+he)/B)+1),H.push(Math.floor((te.y+te.h+he)/B)+1);break;case"bct":var ie=Me(this.ctx.lastPoint.x,this.ctx.lastPoint.y,X.x1,X.y1,X.x2,X.y2,X.x,X.y);H.push(Math.floor((ie.y+he)/B)+1),H.push(Math.floor((ie.y+ie.h+he)/B)+1);break;case"rect":H.push(Math.floor((X.y+he)/B)+1),H.push(Math.floor((X.y+X.h+he)/B)+1)}for(var ee=0;ee<H.length;ee+=1)for(;this.pdf.internal.getNumberOfPages()<H[ee];)F.call(this);return H},F=function(){var X=this.fillStyle,Ee=this.strokeStyle,B=this.font,H=this.lineCap,he=this.lineWidth,te=this.lineJoin;this.pdf.addPage(),this.fillStyle=X,this.strokeStyle=Ee,this.font=B,this.lineCap=H,this.lineWidth=he,this.lineJoin=te},G=function(X,Ee,B){for(var H=0;H<X.length;H++)switch(X[H].type){case"bct":X[H].x2+=Ee,X[H].y2+=B;case"qct":X[H].x1+=Ee,X[H].y1+=B;case"mt":case"lt":case"arc":default:X[H].x+=Ee,X[H].y+=B}return X},me=function(X){return X.sort(function(Ee,B){return Ee-B})},Se=function(X,Ee){for(var B,H,he=this.fillStyle,te=this.strokeStyle,ie=this.lineCap,ee=this.lineWidth,se=Math.abs(ee*this.ctx.transform.scaleX),Ce=this.lineJoin,ne=JSON.parse(JSON.stringify(this.path)),ae=JSON.parse(JSON.stringify(this.path)),xe=[],ye=0;ye<ae.length;ye++)if(ae[ye].x!==void 0)for(var le=Q.call(this,ae[ye]),je=0;je<le.length;je+=1)xe.indexOf(le[je])===-1&&xe.push(le[je]);for(var Re=0;Re<xe.length;Re++)for(;this.pdf.internal.getNumberOfPages()<xe[Re];)F.call(this);if(me(xe),this.autoPaging)for(var Ae=xe[0],qe=xe[xe.length-1],Oe=Ae;Oe<qe+1;Oe++){this.pdf.setPage(Oe),this.fillStyle=he,this.strokeStyle=te,this.lineCap=ie,this.lineWidth=se,this.lineJoin=Ce;var et=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Je=Oe===1?this.posY+this.margin[0]:this.margin[0],mt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],_t=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],$t=Oe===1?0:mt+(Oe-2)*_t;if(this.ctx.clip_path.length!==0){var Xt=this.path;B=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=G(B,this.posX+this.margin[3],-$t+Je+this.ctx.prevPageLastElemOffset),Ie.call(this,X,!0),this.path=Xt}if(H=JSON.parse(JSON.stringify(ne)),this.path=G(H,this.posX+this.margin[3],-$t+Je+this.ctx.prevPageLastElemOffset),Ee===!1||Oe===0){var Xe=(Oe>Ae||Oe<qe)&&$.call(this);Xe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],et,_t,null).clip().discardPath()),Ie.call(this,X,Ee),Xe&&this.pdf.restoreGraphicsState()}this.lineWidth=ee}else this.lineWidth=se,Ie.call(this,X,Ee),this.lineWidth=ee;this.path=ne},Ie=function(X,Ee){if((X!=="stroke"||Ee||!D.call(this))&&(X==="stroke"||Ee||!b.call(this))){for(var B,H,he=[],te=this.path,ie=0;ie<te.length;ie++){var ee=te[ie];switch(ee.type){case"begin":he.push({begin:!0});break;case"close":he.push({close:!0});break;case"mt":he.push({start:ee,deltas:[],abs:[]});break;case"lt":var se=he.length;if(te[ie-1]&&!isNaN(te[ie-1].x)&&(B=[ee.x-te[ie-1].x,ee.y-te[ie-1].y],se>0)){for(;se>=0;se--)if(he[se-1].close!==!0&&he[se-1].begin!==!0){he[se-1].deltas.push(B),he[se-1].abs.push(ee);break}}break;case"bct":B=[ee.x1-te[ie-1].x,ee.y1-te[ie-1].y,ee.x2-te[ie-1].x,ee.y2-te[ie-1].y,ee.x-te[ie-1].x,ee.y-te[ie-1].y],he[he.length-1].deltas.push(B);break;case"qct":var Ce=te[ie-1].x+2/3*(ee.x1-te[ie-1].x),ne=te[ie-1].y+2/3*(ee.y1-te[ie-1].y),ae=ee.x+2/3*(ee.x1-ee.x),xe=ee.y+2/3*(ee.y1-ee.y),ye=ee.x,le=ee.y;B=[Ce-te[ie-1].x,ne-te[ie-1].y,ae-te[ie-1].x,xe-te[ie-1].y,ye-te[ie-1].x,le-te[ie-1].y],he[he.length-1].deltas.push(B);break;case"arc":he.push({deltas:[],abs:[],arc:!0}),Array.isArray(he[he.length-1].abs)&&he[he.length-1].abs.push(ee)}}H=Ee?null:X==="stroke"?"stroke":"fill";for(var je=!1,Re=0;Re<he.length;Re++)if(he[Re].arc)for(var Ae=he[Re].abs,qe=0;qe<Ae.length;qe++){var Oe=Ae[qe];Oe.type==="arc"?O.call(this,Oe.x,Oe.y,Oe.radius,Oe.startAngle,Oe.endAngle,Oe.counterclockwise,void 0,Ee,!je):J.call(this,Oe.x,Oe.y),je=!0}else if(he[Re].close===!0)this.pdf.internal.out("h"),je=!1;else if(he[Re].begin!==!0){var et=he[Re].start.x,Je=he[Re].start.y;V.call(this,he[Re].deltas,et,Je),je=!0}H&&W.call(this,H),Ee&&ue.call(this)}},nt=function(X){var Ee=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,B=Ee*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return X-B;case"top":return X+Ee-B;case"hanging":return X+Ee-2*B;case"middle":return X+Ee/2-B;case"ideographic":return X;case"alphabetic":default:return X}},Ve=function(X){return X+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};x.prototype.createLinearGradient=function(){var X=function(){};return X.colorStops=[],X.addColorStop=function(Ee,B){this.colorStops.push([Ee,B])},X.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},X.isCanvasGradient=!0,X},x.prototype.createPattern=function(){return this.createLinearGradient()},x.prototype.createRadialGradient=function(){return this.createLinearGradient()};var O=function(X,Ee,B,H,he,te,ie,ee,se){for(var Ce=Y.call(this,B,H,he,te),ne=0;ne<Ce.length;ne++){var ae=Ce[ne];ne===0&&(se?z.call(this,ae.x1+X,ae.y1+Ee):J.call(this,ae.x1+X,ae.y1+Ee)),U.call(this,X,Ee,ae.x2,ae.y2,ae.x3,ae.y3,ae.x4,ae.y4)}ee?ue.call(this):W.call(this,ie)},W=function(X){switch(X){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},ue=function(){this.pdf.clip(),this.pdf.discardPath()},z=function(X,Ee){this.pdf.internal.out(t(X)+" "+i(Ee)+" m")},R=function(X){var Ee;switch(X.align){case"right":case"end":Ee="right";break;case"center":Ee="center";break;case"left":case"start":default:Ee="left"}var B=this.pdf.getTextDimensions(X.text),H=nt.call(this,X.y),he=Ve.call(this,H)-B.h,te=this.ctx.transform.applyToPoint(new l(X.x,H)),ie=this.ctx.transform.decompose(),ee=new g;ee=(ee=(ee=ee.multiply(ie.translate)).multiply(ie.skew)).multiply(ie.scale);for(var se,Ce,ne,ae=this.ctx.transform.applyToRectangle(new h(X.x,H,B.w,B.h)),xe=ee.applyToRectangle(new h(X.x,he,B.w,B.h)),ye=Q.call(this,xe),le=[],je=0;je<ye.length;je+=1)le.indexOf(ye[je])===-1&&le.push(ye[je]);if(me(le),this.autoPaging)for(var Re=le[0],Ae=le[le.length-1],qe=Re;qe<Ae+1;qe++){this.pdf.setPage(qe);var Oe=qe===1?this.posY+this.margin[0]:this.margin[0],et=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Je=this.pdf.internal.pageSize.height-this.margin[2],mt=Je-this.margin[0],_t=this.pdf.internal.pageSize.width-this.margin[1],$t=_t-this.margin[3],Xt=qe===1?0:et+(qe-2)*mt;if(this.ctx.clip_path.length!==0){var Xe=this.path;se=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=G(se,this.posX+this.margin[3],-1*Xt+Oe),Ie.call(this,"fill",!0),this.path=Xe}var Kt=G([JSON.parse(JSON.stringify(xe))],this.posX+this.margin[3],-Xt+Oe+this.ctx.prevPageLastElemOffset)[0];X.scale>=.01&&(Ce=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ce*X.scale),ne=this.lineWidth,this.lineWidth=ne*X.scale);var Qt=this.autoPaging!=="text";if(Qt||Kt.y+Kt.h<=Je){if(Qt||Kt.y>=Oe&&Kt.x<=_t){var Qe=Qt?X.text:this.pdf.splitTextToSize(X.text,X.maxWidth||_t-Kt.x)[0],We=G([JSON.parse(JSON.stringify(ae))],this.posX+this.margin[3],-Xt+Oe+this.ctx.prevPageLastElemOffset)[0],Ut=Qt&&(qe>Re||qe<Ae)&&$.call(this);Ut&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],$t,mt,null).clip().discardPath()),this.pdf.text(Qe,We.x,We.y,{angle:X.angle,align:Ee,renderingMode:X.renderingMode}),Ut&&this.pdf.restoreGraphicsState()}}else Kt.y<Je&&(this.ctx.prevPageLastElemOffset+=Je-Kt.y);X.scale>=.01&&(this.pdf.setFontSize(Ce),this.lineWidth=ne)}else X.scale>=.01&&(Ce=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ce*X.scale),ne=this.lineWidth,this.lineWidth=ne*X.scale),this.pdf.text(X.text,te.x+this.posX,te.y+this.posY,{angle:X.angle,align:Ee,renderingMode:X.renderingMode,maxWidth:X.maxWidth}),X.scale>=.01&&(this.pdf.setFontSize(Ce),this.lineWidth=ne)},J=function(X,Ee,B,H){B=B||0,H=H||0,this.pdf.internal.out(t(X+B)+" "+i(Ee+H)+" l")},V=function(X,Ee,B){return this.pdf.lines(X,Ee,B,null,null)},U=function(X,Ee,B,H,he,te,ie,ee){this.pdf.internal.out([n(r(B+X)),n(o(H+Ee)),n(r(he+X)),n(o(te+Ee)),n(r(ie+X)),n(o(ee+Ee)),"c"].join(" "))},Y=function(X,Ee,B,H){for(var he=2*Math.PI,te=Math.PI/2;Ee>B;)Ee-=he;var ie=Math.abs(B-Ee);ie<he&&H&&(ie=he-ie);for(var ee=[],se=H?-1:1,Ce=Ee;ie>1e-5;){var ne=Ce+se*Math.min(ie,te);ee.push(ce.call(this,X,Ce,ne)),ie-=Math.abs(ne-Ce),Ce=ne}return ee},ce=function(X,Ee,B){var H=(B-Ee)/2,he=X*Math.cos(H),te=X*Math.sin(H),ie=he,ee=-te,se=ie*ie+ee*ee,Ce=se+ie*he+ee*te,ne=4/3*(Math.sqrt(2*se*Ce)-Ce)/(ie*te-ee*he),ae=ie-ne*ee,xe=ee+ne*ie,ye=ae,le=-xe,je=H+Ee,Re=Math.cos(je),Ae=Math.sin(je);return{x1:X*Math.cos(Ee),y1:X*Math.sin(Ee),x2:ae*Re-xe*Ae,y2:ae*Ae+xe*Re,x3:ye*Re-le*Ae,y3:ye*Ae+le*Re,x4:X*Math.cos(B),y4:X*Math.sin(B)}},re=function(X){return 180*X/Math.PI},Pe=function(X,Ee,B,H,he,te){var ie=X+.5*(B-X),ee=Ee+.5*(H-Ee),se=he+.5*(B-he),Ce=te+.5*(H-te),ne=Math.min(X,he,ie,se),ae=Math.max(X,he,ie,se),xe=Math.min(Ee,te,ee,Ce),ye=Math.max(Ee,te,ee,Ce);return new h(ne,xe,ae-ne,ye-xe)},Me=function(X,Ee,B,H,he,te,ie,ee){var se,Ce,ne,ae,xe,ye,le,je,Re,Ae,qe,Oe,et,Je,mt=B-X,_t=H-Ee,$t=he-B,Xt=te-H,Xe=ie-he,Kt=ee-te;for(Ce=0;Ce<41;Ce++)Re=(le=(ne=X+(se=Ce/40)*mt)+se*((xe=B+se*$t)-ne))+se*(xe+se*(he+se*Xe-xe)-le),Ae=(je=(ae=Ee+se*_t)+se*((ye=H+se*Xt)-ae))+se*(ye+se*(te+se*Kt-ye)-je),Ce==0?(qe=Re,Oe=Ae,et=Re,Je=Ae):(qe=Math.min(qe,Re),Oe=Math.min(Oe,Ae),et=Math.max(et,Re),Je=Math.max(Je,Ae));return new h(Math.round(qe),Math.round(Oe),Math.round(et-qe),Math.round(Je-Oe))},ot=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var X,Ee,B=(X=this.ctx.lineDash,Ee=this.ctx.lineDashOffset,JSON.stringify({lineDash:X,lineDashOffset:Ee}));this.prevLineDash!==B&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=B)}}})(hi.API),function(e){var n=function(o){var l,h,g,v,_,x,E,b,D,$;for(h=[],g=0,v=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;v>g;g+=4)(_=(o.charCodeAt(g)<<24)+(o.charCodeAt(g+1)<<16)+(o.charCodeAt(g+2)<<8)+o.charCodeAt(g+3))!==0?(x=(_=((_=((_=((_=(_-($=_%85))/85)-(D=_%85))/85)-(b=_%85))/85)-(E=_%85))/85)%85,h.push(x+33,E+33,b+33,D+33,$+33)):h.push(122);return function(Q,F){for(var G=F;G>0;G--)Q.pop()}(h,l.length),String.fromCharCode.apply(String,h)+"~>"},t=function(o){var l,h,g,v,_,x=String,E="length",b=255,D="charCodeAt",$="slice",Q="replace";for(o[$](-2),o=o[$](0,-2)[Q](/\s/g,"")[Q]("z","!!!!!"),g=[],v=0,_=(o+=l="uuuuu"[$](o[E]%5||5))[E];_>v;v+=5)h=52200625*(o[D](v)-33)+614125*(o[D](v+1)-33)+7225*(o[D](v+2)-33)+85*(o[D](v+3)-33)+(o[D](v+4)-33),g.push(b&h>>24,b&h>>16,b&h>>8,b&h);return function(F,G){for(var me=G;me>0;me--)F.pop()}(g,l[E]),x.fromCharCode.apply(x,g)},i=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var h="",g=0;g<o.length;g+=2)h+=String.fromCharCode("0x"+(o[g]+o[g+1]));return h},r=function(o){for(var l=new Uint8Array(o.length),h=o.length;h--;)l[h]=o.charCodeAt(h);return o=(l=$g(l)).reduce(function(g,v){return g+String.fromCharCode(v)},"")};e.processDataByFilters=function(o,l){var h=0,g=o||"",v=[];for(typeof(l=l||[])=="string"&&(l=[l]),h=0;h<l.length;h+=1)switch(l[h]){case"ASCII85Decode":case"/ASCII85Decode":g=t(g),v.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":g=n(g),v.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":g=i(g),v.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":g=g.split("").map(function(_){return("0"+_.charCodeAt().toString(16)).slice(-2)}).join("")+">",v.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":g=r(g),v.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[h]+'" is not implemented')}return{data:g,reverseChain:v.reverse().join(" ")}}}(hi.API),function(e){e.loadFile=function(n,t,i){return function(r,o,l){o=o!==!1,l=typeof l=="function"?l:function(){};var h=void 0;try{h=function(g,v,_){var x=new XMLHttpRequest,E=0,b=function(D){var $=D.length,Q=[],F=String.fromCharCode;for(E=0;E<$;E+=1)Q.push(F(255&D.charCodeAt(E)));return Q.join("")};if(x.open("GET",g,!v),x.overrideMimeType("text/plain; charset=x-user-defined"),v===!1&&(x.onload=function(){x.status===200?_(b(this.responseText)):_(void 0)}),x.send(null),v&&x.status===200)return b(x.responseText)}(r,o,l)}catch{}return h}(n,t,i)},e.loadImageFile=e.loadFile}(hi.API),function(e){function n(){return(fi.html2canvas?Promise.resolve(fi.html2canvas):Qc(()=>import("./html2canvas.esm.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function t(){return(fi.DOMPurify?Promise.resolve(fi.DOMPurify):Qc(()=>import("./purify.es.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var i=function(l){var h=Mr(l);return h==="undefined"?"undefined":h==="string"||l instanceof String?"string":h==="number"||l instanceof Number?"number":h==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":h==="object"?"object":"unknown"},r=function(l,h){var g=document.createElement(l);for(var v in h.className&&(g.className=h.className),h.innerHTML&&h.dompurify&&(g.innerHTML=h.dompurify.sanitize(h.innerHTML)),h.style)g.style[v]=h.style[v];return g},o=function l(h){var g=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),v=l.convert(Promise.resolve(),g);return v=(v=v.setProgress(1,l,1,[l])).set(h)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,h){return l.__proto__=h||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,h){return this.then(function(){switch(h=h||function(g){switch(i(g)){case"string":return"string";case"element":return g.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l)){case"string":return this.then(t).then(function(g){return this.set({src:r("div",{innerHTML:l,dompurify:g})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},h=function g(v,_){for(var x=v.nodeType===3?document.createTextNode(v.nodeValue):v.cloneNode(!1),E=v.firstChild;E;E=E.nextSibling)_!==!0&&E.nodeType===1&&E.nodeName==="SCRIPT"||x.appendChild(g(E,_));return v.nodeType===1&&(v.nodeName==="CANVAS"?(x.width=v.width,x.height=v.height,x.getContext("2d").drawImage(v,0,0)):v.nodeName!=="TEXTAREA"&&v.nodeName!=="SELECT"||(x.value=v.value),x.addEventListener("load",function(){x.scrollTop=v.scrollTop,x.scrollLeft=v.scrollLeft},!0)),x}(this.prop.src,this.opt.html2canvas.javascriptEnabled);h.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=r("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=r("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(h),this.prop.container.firstChild.appendChild(r("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(n).then(function(h){var g=Object.assign({},this.opt.html2canvas);return delete g.onrendered,h(this.prop.container,g)}).then(function(h){(this.opt.html2canvas.onrendered||function(){})(h),this.prop.canvas=h,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(n).then(function(h){var g=this.opt.jsPDF,v=this.opt.fontFaces,_=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,x=Object.assign({async:!0,allowTaint:!0,scale:_,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete x.onrendered,g.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,g.context2d.posX=this.opt.x,g.context2d.posY=this.opt.y,g.context2d.margin=this.opt.margin,g.context2d.fontFaces=v,v)for(var E=0;E<v.length;++E){var b=v[E],D=b.src.find(function($){return $.format==="truetype"});D&&g.addFont(D.url,b.ref.name,b.ref.style)}return x.windowHeight=x.windowHeight||0,x.windowHeight=x.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):x.windowHeight,g.context2d.save(!0),h(this.prop.container,x)}).then(function(h){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(h),this.prop.canvas=h,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,h,g){return(g=g||"pdf").toLowerCase()==="img"||g.toLowerCase()==="image"?this.outputImg(l,h):this.outputPdf(l,h)},o.prototype.outputPdf=function(l,h){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,h)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(i(l)!=="object")return this;var h=Object.keys(l||{}).map(function(g){if(g in o.template.prop)return function(){this.prop[g]=l[g]};switch(g){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[g]=l[g]}}},this);return this.then(function(){return this.thenList(h)})},o.prototype.get=function(l,h){return this.then(function(){var g=l in o.template.prop?this.prop[l]:this.opt[l];return h?h(g):g})},o.prototype.setMargin=function(l){return this.then(function(){switch(i(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function h(g,v){return Math.floor(g*v/72*96)}return this.then(function(){(l=l||hi.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:h(l.inner.width,l.k),height:h(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,h,g,v){return l!=null&&(this.progress.val=l),h!=null&&(this.progress.state=h),g!=null&&(this.progress.n=g),v!=null&&(this.progress.stack=v),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,h,g,v){return this.setProgress(l?this.progress.val+l:null,h||null,g?this.progress.n+g:null,v?this.progress.stack.concat(v):null)},o.prototype.then=function(l,h){var g=this;return this.thenCore(l,h,function(v,_){return g.updateProgress(null,null,1,[v]),Promise.prototype.then.call(this,function(x){return g.updateProgress(null,v),x}).then(v,_).then(function(x){return g.updateProgress(1),x})})},o.prototype.thenCore=function(l,h,g){g=g||Promise.prototype.then,l&&(l=l.bind(this)),h&&(h=h.bind(this));var v=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:o.convert(Object.assign({},this),Promise.prototype),_=g.call(v,l,h);return o.convert(_,this.__proto__)},o.prototype.thenExternal=function(l,h){return Promise.prototype.then.call(this,l,h)},o.prototype.thenList=function(l){var h=this;return l.forEach(function(g){h=h.thenCore(g)}),h},o.prototype.catch=function(l){l&&(l=l.bind(this));var h=Promise.prototype.catch.call(this,l);return o.convert(h,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,hi.getPageSize=function(l,h,g){if(Mr(l)==="object"){var v=l;l=v.orientation,h=v.unit||h,g=v.format||g}h=h||"mm",g=g||"a4",l=(""+(l||"P")).toLowerCase();var _,x=(""+g).toLowerCase(),E={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(h){case"pt":_=1;break;case"mm":_=72/25.4;break;case"cm":_=72/2.54;break;case"in":_=72;break;case"px":_=.75;break;case"pc":case"em":_=12;break;case"ex":_=6;break;default:throw"Invalid unit: "+h}var b,D=0,$=0;if(E.hasOwnProperty(x))D=E[x][1]/_,$=E[x][0]/_;else try{D=g[1],$=g[0]}catch{throw new Error("Invalid format: "+g)}if(l==="p"||l==="portrait")l="p",$>D&&(b=$,$=D,D=b);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",D>$&&(b=$,$=D,D=b)}return{width:$,height:D,unit:h,k:_,orientation:l}},e.html=function(l,h){(h=h||{}).callback=h.callback||function(){},h.html2canvas=h.html2canvas||{},h.html2canvas.canvas=h.html2canvas.canvas||this.canvas,h.jsPDF=h.jsPDF||this,h.fontFaces=h.fontFaces?h.fontFaces.map(Zg):null;var g=new o(h);return h.worker?g:g.from(l).doCallback()}}(hi.API),hi.API.addJS=function(e){return Uy=e,this.internal.events.subscribe("postPutResources",function(){Td=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Td+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),jy=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Uy+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Td!==void 0&&jy!==void 0&&this.internal.out("/Names <</JavaScript "+Td+" 0 R>>")}),this},function(e){var n;e.events.push(["postPutResources",function(){var t=this,i=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=t.outline.render().split(/\r\n/),o=0;o<r.length;o++){var l=r[o],h=i.exec(l);if(h!=null){var g=h[1];t.internal.newObjectDeferredBegin(g,!1)}t.internal.write(l)}if(this.outline.createNamedDestinations){var v=this.internal.pages.length,_=[];for(o=0;o<v;o++){var x=t.internal.newObject();_.push(x);var E=t.internal.getPageInfo(o+1);t.internal.write("<< /D["+E.objId+" 0 R /XYZ null null null]>> endobj")}var b=t.internal.newObject();for(t.internal.write("<< /Names [ "),o=0;o<_.length;o++)t.internal.write("(page_"+(o+1)+")"+_[o]+" 0 R");t.internal.write(" ] >>","endobj"),n=t.internal.newObject(),t.internal.write("<< /Dests "+b+" 0 R"),t.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+n+" 0 R"))}]),e.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(i,r,o){var l={title:r,options:o,children:[]};return i==null&&(i=this.root),i.children.push(l),l},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(i){i.id=t.internal.newObjectDeferred();for(var r=0;r<i.children.length;r++)this.genIds_r(i.children[r])},t.outline.renderRoot=function(i){this.objStart(i),this.line("/Type /Outlines"),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1]))),this.line("/Count "+this.count_r({count:0},i)),this.objEnd()},t.outline.renderItems=function(i){for(var r=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<i.children.length;o++){var l=i.children[o];this.objStart(l),this.line("/Title "+this.makeString(l.title)),this.line("/Parent "+this.makeRef(i)),o>0&&this.line("/Prev "+this.makeRef(i.children[o-1])),o<i.children.length-1&&this.line("/Next "+this.makeRef(i.children[o+1])),l.children.length>0&&(this.line("/First "+this.makeRef(l.children[0])),this.line("/Last "+this.makeRef(l.children[l.children.length-1])));var h=this.count=this.count_r({count:0},l);if(h>0&&this.line("/Count "+h),l.options&&l.options.pageNumber){var g=t.internal.getPageInfo(l.options.pageNumber);this.line("/Dest ["+g.objId+" 0 R /XYZ 0 "+r(0)+" 0]")}this.objEnd()}for(var v=0;v<i.children.length;v++)this.renderItems(i.children[v])},t.outline.line=function(i){this.ctx.val+=i+`\r
`},t.outline.makeRef=function(i){return i.id+" 0 R"},t.outline.makeString=function(i){return"("+t.internal.pdfEscape(i)+")"},t.outline.objStart=function(i){this.ctx.val+=`\r
`+i.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(i,r){for(var o=0;o<r.children.length;o++)i.count++,this.count_r(i,r.children[o]);return i.count}}])}(hi.API),function(e){var n=[192,193,194,195,196,197,198,199];e.processJPEG=function(t,i,r,o,l,h){var g,v=this.decode.DCT_DECODE,_=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=l||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,(g=function(x){for(var E,b=256*x.charCodeAt(4)+x.charCodeAt(5),D=x.length,$={width:0,height:0,numcomponents:1},Q=4;Q<D;Q+=2){if(Q+=b,n.indexOf(x.charCodeAt(Q+1))!==-1){E=256*x.charCodeAt(Q+5)+x.charCodeAt(Q+6),$={width:256*x.charCodeAt(Q+7)+x.charCodeAt(Q+8),height:E,numcomponents:x.charCodeAt(Q+9)};break}b=256*x.charCodeAt(Q+2)+x.charCodeAt(Q+3)}return $}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:h=this.color_spaces.DEVICE_GRAY;break;case 4:h=this.color_spaces.DEVICE_CMYK;break;case 3:h=this.color_spaces.DEVICE_RGB}_={data:t,width:g.width,height:g.height,colorSpace:h,bitsPerComponent:8,filter:v,index:i,alias:r}}return _}}(hi.API);var kh,Bd,$y,qy,Vy,hN=function(){var e,n,t;function i(o){var l,h,g,v,_,x,E,b,D,$,Q,F,G,me;for(this.data=o,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},x=null;;){switch(l=this.readUInt32(),D=(function(){var Se,Ie;for(Ie=[],Se=0;Se<4;++Se)Ie.push(String.fromCharCode(this.data[this.pos++]));return Ie}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(l);break;case"fcTL":x&&this.animation.frames.push(x),this.pos+=4,x={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},_=this.readUInt16(),v=this.readUInt16()||100,x.delay=1e3*_/v,x.disposeOp=this.data[this.pos++],x.blendOp=this.data[this.pos++],x.data=[];break;case"IDAT":case"fdAT":for(D==="fdAT"&&(this.pos+=4,l-=4),o=(x!=null?x.data:void 0)||this.imgData,F=0;0<=l?F<l:F>l;0<=l?++F:--F)o.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(g=this.palette.length/3,this.transparency.indexed=this.read(l),this.transparency.indexed.length>g)throw new Error("More transparent colors than palette size");if(($=g-this.transparency.indexed.length)>0)for(G=0;0<=$?G<$:G>$;0<=$?++G:--G)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(l)[0];break;case 2:this.transparency.rgb=this.read(l)}break;case"tEXt":E=(Q=this.read(l)).indexOf(0),b=String.fromCharCode.apply(String,Q.slice(0,E)),this.text[b]=String.fromCharCode.apply(String,Q.slice(E+1));break;case"IEND":return x&&this.animation.frames.push(x),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(me=this.colorType)===4||me===6,h=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*h,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=l}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}i.prototype.read=function(o){var l,h;for(h=[],l=0;0<=o?l<o:l>o;0<=o?++l:--l)h.push(this.data[this.pos++]);return h},i.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},i.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},i.prototype.decodePixels=function(o){var l=this.pixelBitlength/8,h=new Uint8Array(this.width*this.height*l),g=0,v=this;if(o==null&&(o=this.imgData),o.length===0)return new Uint8Array(0);function _(x,E,b,D){var $,Q,F,G,me,Se,Ie,nt,Ve,O,W,ue,z,R,J,V,U,Y,ce,re,Pe,Me=Math.ceil((v.width-x)/b),ot=Math.ceil((v.height-E)/D),X=v.width==Me&&v.height==ot;for(R=l*Me,ue=X?h:new Uint8Array(R*ot),Se=o.length,z=0,Q=0;z<ot&&g<Se;){switch(o[g++]){case 0:for(G=U=0;U<R;G=U+=1)ue[Q++]=o[g++];break;case 1:for(G=Y=0;Y<R;G=Y+=1)$=o[g++],me=G<l?0:ue[Q-l],ue[Q++]=($+me)%256;break;case 2:for(G=ce=0;ce<R;G=ce+=1)$=o[g++],F=(G-G%l)/l,J=z&&ue[(z-1)*R+F*l+G%l],ue[Q++]=(J+$)%256;break;case 3:for(G=re=0;re<R;G=re+=1)$=o[g++],F=(G-G%l)/l,me=G<l?0:ue[Q-l],J=z&&ue[(z-1)*R+F*l+G%l],ue[Q++]=($+Math.floor((me+J)/2))%256;break;case 4:for(G=Pe=0;Pe<R;G=Pe+=1)$=o[g++],F=(G-G%l)/l,me=G<l?0:ue[Q-l],z===0?J=V=0:(J=ue[(z-1)*R+F*l+G%l],V=F&&ue[(z-1)*R+(F-1)*l+G%l]),Ie=me+J-V,nt=Math.abs(Ie-me),O=Math.abs(Ie-J),W=Math.abs(Ie-V),Ve=nt<=O&&nt<=W?me:O<=W?J:V,ue[Q++]=($+Ve)%256;break;default:throw new Error("Invalid filter algorithm: "+o[g-1])}if(!X){var Ee=((E+z*D)*v.width+x)*l,B=z*R;for(G=0;G<Me;G+=1){for(var H=0;H<l;H+=1)h[Ee++]=ue[B++];Ee+=(b-1)*l}}z++}}return o=q7(o),v.interlaceMethod==1?(_(0,0,8,8),_(4,0,8,8),_(0,4,4,8),_(2,0,4,4),_(0,2,2,4),_(1,0,2,2),_(0,1,1,2)):_(0,0,1,1),h},i.prototype.decodePalette=function(){var o,l,h,g,v,_,x,E,b;for(h=this.palette,_=this.transparency.indexed||[],v=new Uint8Array((_.length||0)+h.length),g=0,o=0,l=x=0,E=h.length;x<E;l=x+=3)v[g++]=h[l],v[g++]=h[l+1],v[g++]=h[l+2],v[g++]=(b=_[o++])!=null?b:255;return v},i.prototype.copyToImageData=function(o,l){var h,g,v,_,x,E,b,D,$,Q,F;if(g=this.colors,$=null,h=this.hasAlphaChannel,this.palette.length&&($=(F=this._decodedPalette)!=null?F:this._decodedPalette=this.decodePalette(),g=4,h=!0),D=(v=o.data||o).length,x=$||l,_=E=0,g===1)for(;_<D;)b=$?4*l[_/4]:E,Q=x[b++],v[_++]=Q,v[_++]=Q,v[_++]=Q,v[_++]=h?x[b++]:255,E=b;else for(;_<D;)b=$?4*l[_/4]:E,v[_++]=x[b++],v[_++]=x[b++],v[_++]=x[b++],v[_++]=h?x[b++]:255,E=b},i.prototype.decode=function(){var o;return o=new Uint8Array(this.width*this.height*4),this.copyToImageData(o,this.decodePixels()),o};var r=function(){if(Object.prototype.toString.call(fi)==="[object Window]"){try{n=fi.document.createElement("canvas"),t=n.getContext("2d")}catch{return!1}return!0}return!1};return r(),e=function(o){var l;if(r()===!0)return t.width=o.width,t.height=o.height,t.clearRect(0,0,o.width,o.height),t.putImageData(o,0,0),(l=new Image).src=n.toDataURL(),l;throw new Error("This method requires a Browser with Canvas-capability.")},i.prototype.decodeFrames=function(o){var l,h,g,v,_,x,E,b;if(this.animation){for(b=[],h=_=0,x=(E=this.animation.frames).length;_<x;h=++_)l=E[h],g=o.createImageData(l.width,l.height),v=this.decodePixels(new Uint8Array(l.data)),this.copyToImageData(g,v),l.imageData=g,b.push(l.image=e(g));return b}},i.prototype.renderFrame=function(o,l){var h,g,v;return h=(g=this.animation.frames)[l],v=g[l-1],l===0&&o.clearRect(0,0,this.width,this.height),(v!=null?v.disposeOp:void 0)===1?o.clearRect(v.xOffset,v.yOffset,v.width,v.height):(v!=null?v.disposeOp:void 0)===2&&o.putImageData(v.imageData,v.xOffset,v.yOffset),h.blendOp===0&&o.clearRect(h.xOffset,h.yOffset,h.width,h.height),o.drawImage(h.image,h.xOffset,h.yOffset)},i.prototype.animate=function(o){var l,h,g,v,_,x,E=this;return h=0,x=this.animation,v=x.numFrames,g=x.frames,_=x.numPlays,(l=function(){var b,D;if(b=h++%v,D=g[b],E.renderFrame(o,b),v>1&&h/v<_)return E.animation._timeout=setTimeout(l,D.delay)})()},i.prototype.stopAnimation=function(){var o;return clearTimeout((o=this.animation)!=null?o._timeout:void 0)},i.prototype.render=function(o){var l,h;return o._png&&o._png.stopAnimation(),o._png=this,o.width=this.width,o.height=this.height,l=o.getContext("2d"),this.animation?(this.decodeFrames(l),this.animate(l)):(h=l.createImageData(this.width,this.height),this.copyToImageData(h,this.decodePixels()),l.putImageData(h,0,0))},i}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function fN(e){var n=0;if(e[n++]!==71||e[n++]!==73||e[n++]!==70||e[n++]!==56||(e[n++]+1&253)!=56||e[n++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=e[n++]|e[n++]<<8,i=e[n++]|e[n++]<<8,r=e[n++],o=r>>7,l=1<<(7&r)+1;e[n++],e[n++];var h=null,g=null;o&&(h=n,g=l,n+=3*l);var v=!0,_=[],x=0,E=null,b=0,D=null;for(this.width=t,this.height=i;v&&n<e.length;)switch(e[n++]){case 33:switch(e[n++]){case 255:if(e[n]!==11||e[n+1]==78&&e[n+2]==69&&e[n+3]==84&&e[n+4]==83&&e[n+5]==67&&e[n+6]==65&&e[n+7]==80&&e[n+8]==69&&e[n+9]==50&&e[n+10]==46&&e[n+11]==48&&e[n+12]==3&&e[n+13]==1&&e[n+16]==0)n+=14,D=e[n++]|e[n++]<<8,n++;else for(n+=12;;){if(!((z=e[n++])>=0))throw Error("Invalid block size");if(z===0)break;n+=z}break;case 249:if(e[n++]!==4||e[n+4]!==0)throw new Error("Invalid graphics extension block.");var $=e[n++];x=e[n++]|e[n++]<<8,E=e[n++],!(1&$)&&(E=null),b=$>>2&7,n++;break;case 254:for(;;){if(!((z=e[n++])>=0))throw Error("Invalid block size");if(z===0)break;n+=z}break;default:throw new Error("Unknown graphic control label: 0x"+e[n-1].toString(16))}break;case 44:var Q=e[n++]|e[n++]<<8,F=e[n++]|e[n++]<<8,G=e[n++]|e[n++]<<8,me=e[n++]|e[n++]<<8,Se=e[n++],Ie=Se>>6&1,nt=1<<(7&Se)+1,Ve=h,O=g,W=!1;Se>>7&&(W=!0,Ve=n,O=nt,n+=3*nt);var ue=n;for(n++;;){var z;if(!((z=e[n++])>=0))throw Error("Invalid block size");if(z===0)break;n+=z}_.push({x:Q,y:F,width:G,height:me,has_local_palette:W,palette_offset:Ve,palette_size:O,data_offset:ue,data_length:n-ue,transparent_index:E,interlaced:!!Ie,delay:x,disposal:b});break;case 59:v=!1;break;default:throw new Error("Unknown gif block: 0x"+e[n-1].toString(16))}this.numFrames=function(){return _.length},this.loopCount=function(){return D},this.frameInfo=function(R){if(R<0||R>=_.length)throw new Error("Frame index out of range.");return _[R]},this.decodeAndBlitFrameBGRA=function(R,J){var V=this.frameInfo(R),U=V.width*V.height,Y=new Uint8Array(U);Gy(e,V.data_offset,Y,U);var ce=V.palette_offset,re=V.transparent_index;re===null&&(re=256);var Pe=V.width,Me=t-Pe,ot=Pe,X=4*(V.y*t+V.x),Ee=4*((V.y+V.height)*t+V.x),B=X,H=4*Me;V.interlaced===!0&&(H+=4*t*7);for(var he=8,te=0,ie=Y.length;te<ie;++te){var ee=Y[te];if(ot===0&&(ot=Pe,(B+=H)>=Ee&&(H=4*Me+4*t*(he-1),B=X+(Pe+Me)*(he<<1),he>>=1)),ee===re)B+=4;else{var se=e[ce+3*ee],Ce=e[ce+3*ee+1],ne=e[ce+3*ee+2];J[B++]=ne,J[B++]=Ce,J[B++]=se,J[B++]=255}--ot}},this.decodeAndBlitFrameRGBA=function(R,J){var V=this.frameInfo(R),U=V.width*V.height,Y=new Uint8Array(U);Gy(e,V.data_offset,Y,U);var ce=V.palette_offset,re=V.transparent_index;re===null&&(re=256);var Pe=V.width,Me=t-Pe,ot=Pe,X=4*(V.y*t+V.x),Ee=4*((V.y+V.height)*t+V.x),B=X,H=4*Me;V.interlaced===!0&&(H+=4*t*7);for(var he=8,te=0,ie=Y.length;te<ie;++te){var ee=Y[te];if(ot===0&&(ot=Pe,(B+=H)>=Ee&&(H=4*Me+4*t*(he-1),B=X+(Pe+Me)*(he<<1),he>>=1)),ee===re)B+=4;else{var se=e[ce+3*ee],Ce=e[ce+3*ee+1],ne=e[ce+3*ee+2];J[B++]=se,J[B++]=Ce,J[B++]=ne,J[B++]=255}--ot}}}function Gy(e,n,t,i){for(var r=e[n++],o=1<<r,l=o+1,h=l+1,g=r+1,v=(1<<g)-1,_=0,x=0,E=0,b=e[n++],D=new Int32Array(4096),$=null;;){for(;_<16&&b!==0;)x|=e[n++]<<_,_+=8,b===1?b=e[n++]:--b;if(_<g)break;var Q=x&v;if(x>>=g,_-=g,Q!==o){if(Q===l)break;for(var F=Q<h?Q:$,G=0,me=F;me>o;)me=D[me]>>8,++G;var Se=me;if(E+G+(F!==Q?1:0)>i)return void zr.log("Warning, gif stream longer than expected.");t[E++]=Se;var Ie=E+=G;for(F!==Q&&(t[E++]=Se),me=F;G--;)me=D[me],t[--Ie]=255&me,me>>=8;$!==null&&h<4096&&(D[h++]=$<<8|Se,h>=v+1&&g<12&&(++g,v=v<<1|1)),$=Q}else h=l+1,v=(1<<(g=r+1))-1,$=null}return E!==i&&zr.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Q0(e){var n,t,i,r,o,l=Math.floor,h=new Array(64),g=new Array(64),v=new Array(64),_=new Array(64),x=new Array(65535),E=new Array(65535),b=new Array(64),D=new Array(64),$=[],Q=0,F=7,G=new Array(64),me=new Array(64),Se=new Array(64),Ie=new Array(256),nt=new Array(2048),Ve=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],O=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],W=[0,1,2,3,4,5,6,7,8,9,10,11],ue=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],z=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],R=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],J=[0,1,2,3,4,5,6,7,8,9,10,11],V=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],U=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Y(X,Ee){for(var B=0,H=0,he=new Array,te=1;te<=16;te++){for(var ie=1;ie<=X[te];ie++)he[Ee[H]]=[],he[Ee[H]][0]=B,he[Ee[H]][1]=te,H++,B++;B*=2}return he}function ce(X){for(var Ee=X[0],B=X[1]-1;B>=0;)Ee&1<<B&&(Q|=1<<F),B--,--F<0&&(Q==255?(re(255),re(0)):re(Q),F=7,Q=0)}function re(X){$.push(X)}function Pe(X){re(X>>8&255),re(255&X)}function Me(X,Ee,B,H,he){for(var te,ie=he[0],ee=he[240],se=function(Ae,qe){var Oe,et,Je,mt,_t,$t,Xt,Xe,Kt,Qt,Qe=0;for(Kt=0;Kt<8;++Kt){Oe=Ae[Qe],et=Ae[Qe+1],Je=Ae[Qe+2],mt=Ae[Qe+3],_t=Ae[Qe+4],$t=Ae[Qe+5],Xt=Ae[Qe+6];var We=Oe+(Xe=Ae[Qe+7]),Ut=Oe-Xe,pn=et+Xt,_n=et-Xt,mn=Je+$t,rt=Je-$t,vn=mt+_t,ni=mt-_t,fn=We+vn,Mn=We-vn,Sr=pn+mn,Ii=pn-mn;Ae[Qe]=fn+Sr,Ae[Qe+4]=fn-Sr;var Mt=.707106781*(Ii+Mn);Ae[Qe+2]=Mn+Mt,Ae[Qe+6]=Mn-Mt;var On=.382683433*((fn=ni+rt)-(Ii=_n+Ut)),Fi=.5411961*fn+On,zi=1.306562965*Ii+On,Xr=.707106781*(Sr=rt+_n),$r=Ut+Xr,Nn=Ut-Xr;Ae[Qe+5]=Nn+Fi,Ae[Qe+3]=Nn-Fi,Ae[Qe+1]=$r+zi,Ae[Qe+7]=$r-zi,Qe+=8}for(Qe=0,Kt=0;Kt<8;++Kt){Oe=Ae[Qe],et=Ae[Qe+8],Je=Ae[Qe+16],mt=Ae[Qe+24],_t=Ae[Qe+32],$t=Ae[Qe+40],Xt=Ae[Qe+48];var pi=Oe+(Xe=Ae[Qe+56]),hr=Oe-Xe,bi=et+Xt,Zt=et-Xt,yn=Je+$t,er=Je-$t,kr=mt+_t,tr=mt-_t,qr=pi+kr,Vr=pi-kr,Qn=bi+yn,fr=bi-yn;Ae[Qe]=qr+Qn,Ae[Qe+32]=qr-Qn;var fs=.707106781*(fr+Vr);Ae[Qe+16]=Vr+fs,Ae[Qe+48]=Vr-fs;var Qr=.382683433*((qr=tr+er)-(fr=Zt+hr)),Ci=.5411961*qr+Qr,An=1.306562965*fr+Qr,Pr=.707106781*(Qn=er+Zt),Ui=hr+Pr,Vi=hr-Pr;Ae[Qe+40]=Vi+Ci,Ae[Qe+24]=Vi-Ci,Ae[Qe+8]=Ui+An,Ae[Qe+56]=Ui-An,Qe++}for(Kt=0;Kt<64;++Kt)Qt=Ae[Kt]*qe[Kt],b[Kt]=Qt>0?Qt+.5|0:Qt-.5|0;return b}(X,Ee),Ce=0;Ce<64;++Ce)D[Ve[Ce]]=se[Ce];var ne=D[0]-B;B=D[0],ne==0?ce(H[0]):(ce(H[E[te=32767+ne]]),ce(x[te]));for(var ae=63;ae>0&&D[ae]==0;)ae--;if(ae==0)return ce(ie),B;for(var xe,ye=1;ye<=ae;){for(var le=ye;D[ye]==0&&ye<=ae;)++ye;var je=ye-le;if(je>=16){xe=je>>4;for(var Re=1;Re<=xe;++Re)ce(ee);je&=15}te=32767+D[ye],ce(he[(je<<4)+E[te]]),ce(x[te]),ye++}return ae!=63&&ce(ie),B}function ot(X){X=Math.min(Math.max(X,1),100),o!=X&&(function(Ee){for(var B=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],H=0;H<64;H++){var he=l((B[H]*Ee+50)/100);he=Math.min(Math.max(he,1),255),h[Ve[H]]=he}for(var te=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ie=0;ie<64;ie++){var ee=l((te[ie]*Ee+50)/100);ee=Math.min(Math.max(ee,1),255),g[Ve[ie]]=ee}for(var se=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ce=0,ne=0;ne<8;ne++)for(var ae=0;ae<8;ae++)v[Ce]=1/(h[Ve[Ce]]*se[ne]*se[ae]*8),_[Ce]=1/(g[Ve[Ce]]*se[ne]*se[ae]*8),Ce++}(X<50?Math.floor(5e3/X):Math.floor(200-2*X)),o=X)}this.encode=function(X,Ee){Ee&&ot(Ee),$=new Array,Q=0,F=7,Pe(65496),Pe(65504),Pe(16),re(74),re(70),re(73),re(70),re(0),re(1),re(1),re(0),Pe(1),Pe(1),re(0),re(0),function(){Pe(65499),Pe(132),re(0);for(var et=0;et<64;et++)re(h[et]);re(1);for(var Je=0;Je<64;Je++)re(g[Je])}(),function(et,Je){Pe(65472),Pe(17),re(8),Pe(Je),Pe(et),re(3),re(1),re(17),re(0),re(2),re(17),re(1),re(3),re(17),re(1)}(X.width,X.height),function(){Pe(65476),Pe(418),re(0);for(var et=0;et<16;et++)re(O[et+1]);for(var Je=0;Je<=11;Je++)re(W[Je]);re(16);for(var mt=0;mt<16;mt++)re(ue[mt+1]);for(var _t=0;_t<=161;_t++)re(z[_t]);re(1);for(var $t=0;$t<16;$t++)re(R[$t+1]);for(var Xt=0;Xt<=11;Xt++)re(J[Xt]);re(17);for(var Xe=0;Xe<16;Xe++)re(V[Xe+1]);for(var Kt=0;Kt<=161;Kt++)re(U[Kt])}(),Pe(65498),Pe(12),re(3),re(1),re(0),re(2),re(17),re(3),re(17),re(0),re(63),re(0);var B=0,H=0,he=0;Q=0,F=7,this.encode.displayName="_encode_";for(var te,ie,ee,se,Ce,ne,ae,xe,ye,le=X.data,je=X.width,Re=X.height,Ae=4*je,qe=0;qe<Re;){for(te=0;te<Ae;){for(Ce=Ae*qe+te,ae=-1,xe=0,ye=0;ye<64;ye++)ne=Ce+(xe=ye>>3)*Ae+(ae=4*(7&ye)),qe+xe>=Re&&(ne-=Ae*(qe+1+xe-Re)),te+ae>=Ae&&(ne-=te+ae-Ae+4),ie=le[ne++],ee=le[ne++],se=le[ne++],G[ye]=(nt[ie]+nt[ee+256>>0]+nt[se+512>>0]>>16)-128,me[ye]=(nt[ie+768>>0]+nt[ee+1024>>0]+nt[se+1280>>0]>>16)-128,Se[ye]=(nt[ie+1280>>0]+nt[ee+1536>>0]+nt[se+1792>>0]>>16)-128;B=Me(G,v,B,n,i),H=Me(me,_,H,t,r),he=Me(Se,_,he,t,r),te+=32}qe+=8}if(F>=0){var Oe=[];Oe[1]=F+1,Oe[0]=(1<<F+1)-1,ce(Oe)}return Pe(65497),new Uint8Array($)},e=e||50,function(){for(var X=String.fromCharCode,Ee=0;Ee<256;Ee++)Ie[Ee]=X(Ee)}(),n=Y(O,W),t=Y(R,J),i=Y(ue,z),r=Y(V,U),function(){for(var X=1,Ee=2,B=1;B<=15;B++){for(var H=X;H<Ee;H++)E[32767+H]=B,x[32767+H]=[],x[32767+H][1]=B,x[32767+H][0]=H;for(var he=-(Ee-1);he<=-X;he++)E[32767+he]=B,x[32767+he]=[],x[32767+he][1]=B,x[32767+he][0]=Ee-1+he;X<<=1,Ee<<=1}}(),function(){for(var X=0;X<256;X++)nt[X]=19595*X,nt[X+256>>0]=38470*X,nt[X+512>>0]=7471*X+32768,nt[X+768>>0]=-11059*X,nt[X+1024>>0]=-21709*X,nt[X+1280>>0]=32768*X+8421375,nt[X+1536>>0]=-27439*X,nt[X+1792>>0]=-5329*X}(),ot(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Hl(e,n){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!n,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Hy(e){function n(O){if(!O)throw Error("assert :P")}function t(O,W,ue){for(var z=0;4>z;z++)if(O[W+z]!=ue.charCodeAt(z))return!0;return!1}function i(O,W,ue,z,R){for(var J=0;J<R;J++)O[W+J]=ue[z+J]}function r(O,W,ue,z){for(var R=0;R<z;R++)O[W+R]=ue}function o(O){return new Int32Array(O)}function l(O,W){for(var ue=[],z=0;z<O;z++)ue.push(new W);return ue}function h(O,W){var ue=[];return function z(R,J,V){for(var U=V[J],Y=0;Y<U&&(R.push(V.length>J+1?[]:new W),!(V.length<J+1));Y++)z(R[Y],J+1,V)}(ue,0,O),ue}var g=function(){var O=this;function W(m,S){for(var N=1<<S-1>>>0;m&N;)N>>>=1;return N?(m&N-1)+N:m}function ue(m,S,N,K,pe){n(!(K%N));do m[S+(K-=N)]=pe;while(0<K)}function z(m,S,N,K,pe){if(n(2328>=pe),512>=pe)var be=o(512);else if((be=o(pe))==null)return 0;return function(Le,ke,Be,Ge,ft,Dt){var Ot,Lt,Vt=ke,jt=1<<Be,dt=o(16),yt=o(16);for(n(ft!=0),n(Ge!=null),n(Le!=null),n(0<Be),Lt=0;Lt<ft;++Lt){if(15<Ge[Lt])return 0;++dt[Ge[Lt]]}if(dt[0]==ft)return 0;for(yt[1]=0,Ot=1;15>Ot;++Ot){if(dt[Ot]>1<<Ot)return 0;yt[Ot+1]=yt[Ot]+dt[Ot]}for(Lt=0;Lt<ft;++Lt)Ot=Ge[Lt],0<Ge[Lt]&&(Dt[yt[Ot]++]=Lt);if(yt[15]==1)return(Ge=new R).g=0,Ge.value=Dt[0],ue(Le,Vt,1,jt,Ge),jt;var Jt,an=-1,Yt=jt-1,Sn=0,Ln=1,$n=1,a=1<<Be;for(Lt=0,Ot=1,ft=2;Ot<=Be;++Ot,ft<<=1){if(Ln+=$n<<=1,0>($n-=dt[Ot]))return 0;for(;0<dt[Ot];--dt[Ot])(Ge=new R).g=Ot,Ge.value=Dt[Lt++],ue(Le,Vt+Sn,ft,a,Ge),Sn=W(Sn,Ot)}for(Ot=Be+1,ft=2;15>=Ot;++Ot,ft<<=1){if(Ln+=$n<<=1,0>($n-=dt[Ot]))return 0;for(;0<dt[Ot];--dt[Ot]){if(Ge=new R,(Sn&Yt)!=an){for(Vt+=a,Jt=1<<(an=Ot)-Be;15>an&&!(0>=(Jt-=dt[an]));)++an,Jt<<=1;jt+=a=1<<(Jt=an-Be),Le[ke+(an=Sn&Yt)].g=Jt+Be,Le[ke+an].value=Vt-ke-an}Ge.g=Ot-Be,Ge.value=Dt[Lt++],ue(Le,Vt+(Sn>>Be),ft,a,Ge),Sn=W(Sn,Ot)}}return Ln!=2*yt[15]-1?0:jt}(m,S,N,K,pe,be)}function R(){this.value=this.g=0}function J(){this.value=this.g=0}function V(){this.G=l(5,R),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=l(Hr,J)}function U(m,S,N,K){n(m!=null),n(S!=null),n(2147483648>K),m.Ca=254,m.I=0,m.b=-8,m.Ka=0,m.oa=S,m.pa=N,m.Jd=S,m.Yc=N+K,m.Zc=4<=K?N+K-4+1:N,te(m)}function Y(m,S){for(var N=0;0<S--;)N|=ee(m,128)<<S;return N}function ce(m,S){var N=Y(m,S);return ie(m)?-N:N}function re(m,S,N,K){var pe,be=0;for(n(m!=null),n(S!=null),n(4294967288>K),m.Sb=K,m.Ra=0,m.u=0,m.h=0,4<K&&(K=4),pe=0;pe<K;++pe)be+=S[N+pe]<<8*pe;m.Ra=be,m.bb=K,m.oa=S,m.pa=N}function Pe(m){for(;8<=m.u&&m.bb<m.Sb;)m.Ra>>>=8,m.Ra+=m.oa[m.pa+m.bb]<<zs-8>>>0,++m.bb,m.u-=8;B(m)&&(m.h=1,m.u=0)}function Me(m,S){if(n(0<=S),!m.h&&S<=to){var N=Ee(m)&To[S];return m.u+=S,Pe(m),N}return m.h=1,m.u=0}function ot(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function X(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function Ee(m){return m.Ra>>>(m.u&zs-1)>>>0}function B(m){return n(m.bb<=m.Sb),m.h||m.bb==m.Sb&&m.u>zs}function H(m,S){m.u=S,m.h=B(m)}function he(m){m.u>=Da&&(n(m.u>=Da),Pe(m))}function te(m){n(m!=null&&m.oa!=null),m.pa<m.Zc?(m.I=(m.oa[m.pa++]|m.I<<8)>>>0,m.b+=8):(n(m!=null&&m.oa!=null),m.pa<m.Yc?(m.b+=8,m.I=m.oa[m.pa++]|m.I<<8):m.Ka?m.b=0:(m.I<<=8,m.b+=8,m.Ka=1))}function ie(m){return Y(m,1)}function ee(m,S){var N=m.Ca;0>m.b&&te(m);var K=m.b,pe=N*S>>>8,be=(m.I>>>K>pe)+0;for(be?(N-=pe,m.I-=pe+1<<K>>>0):N=pe+1,K=N,pe=0;256<=K;)pe+=8,K>>=8;return K=7^pe+ms[K],m.b-=K,m.Ca=(N<<K)-1,be}function se(m,S,N){m[S+0]=N>>24&255,m[S+1]=N>>16&255,m[S+2]=N>>8&255,m[S+3]=N>>0&255}function Ce(m,S){return m[S+0]<<0|m[S+1]<<8}function ne(m,S){return Ce(m,S)|m[S+2]<<16}function ae(m,S){return Ce(m,S)|Ce(m,S+2)<<16}function xe(m,S){var N=1<<S;return n(m!=null),n(0<S),m.X=o(N),m.X==null?0:(m.Mb=32-S,m.Xa=S,1)}function ye(m,S){n(m!=null),n(S!=null),n(m.Xa==S.Xa),i(S.X,0,m.X,0,1<<S.Xa)}function le(){this.X=[],this.Xa=this.Mb=0}function je(m,S,N,K){n(N!=null),n(K!=null);var pe=N[0],be=K[0];return pe==0&&(pe=(m*be+S/2)/S),be==0&&(be=(S*pe+m/2)/m),0>=pe||0>=be?0:(N[0]=pe,K[0]=be,1)}function Re(m,S){return m+(1<<S)-1>>>S}function Ae(m,S){return((4278255360&m)+(4278255360&S)>>>0&4278255360)+((16711935&m)+(16711935&S)>>>0&16711935)>>>0}function qe(m,S){O[S]=function(N,K,pe,be,Le,ke,Be){var Ge;for(Ge=0;Ge<Le;++Ge){var ft=O[m](ke[Be+Ge-1],pe,be+Ge);ke[Be+Ge]=Ae(N[K+Ge],ft)}}}function Oe(){this.ud=this.hd=this.jd=0}function et(m,S){return((4278124286&(m^S))>>>1)+(m&S)>>>0}function Je(m){return 0<=m&&256>m?m:0>m?0:255<m?255:void 0}function mt(m,S){return Je(m+(m-S+.5>>1))}function _t(m,S,N){return Math.abs(S-N)-Math.abs(m-N)}function $t(m,S,N,K,pe,be,Le){for(K=be[Le-1],N=0;N<pe;++N)be[Le+N]=K=Ae(m[S+N],K)}function Xt(m,S,N,K,pe){var be;for(be=0;be<N;++be){var Le=m[S+be],ke=Le>>8&255,Be=16711935&(Be=(Be=16711935&Le)+((ke<<16)+ke));K[pe+be]=(4278255360&Le)+Be>>>0}}function Xe(m,S){S.jd=m>>0&255,S.hd=m>>8&255,S.ud=m>>16&255}function Kt(m,S,N,K,pe,be){var Le;for(Le=0;Le<K;++Le){var ke=S[N+Le],Be=ke>>>8,Ge=ke,ft=255&(ft=(ft=ke>>>16)+((m.jd<<24>>24)*(Be<<24>>24)>>>5));Ge=255&(Ge=(Ge=Ge+((m.hd<<24>>24)*(Be<<24>>24)>>>5))+((m.ud<<24>>24)*(ft<<24>>24)>>>5)),pe[be+Le]=(4278255360&ke)+(ft<<16)+Ge}}function Qt(m,S,N,K,pe){O[S]=function(be,Le,ke,Be,Ge,ft,Dt,Ot,Lt){for(Be=Dt;Be<Ot;++Be)for(Dt=0;Dt<Lt;++Dt)Ge[ft++]=pe(ke[K(be[Le++])])},O[m]=function(be,Le,ke,Be,Ge,ft,Dt){var Ot=8>>be.b,Lt=be.Ea,Vt=be.K[0],jt=be.w;if(8>Ot)for(be=(1<<be.b)-1,jt=(1<<Ot)-1;Le<ke;++Le){var dt,yt=0;for(dt=0;dt<Lt;++dt)dt&be||(yt=K(Be[Ge++])),ft[Dt++]=pe(Vt[yt&jt]),yt>>=Ot}else O["VP8LMapColor"+N](Be,Ge,Vt,jt,ft,Dt,Le,ke,Lt)}}function Qe(m,S,N,K,pe){for(N=S+N;S<N;){var be=m[S++];K[pe++]=be>>16&255,K[pe++]=be>>8&255,K[pe++]=be>>0&255}}function We(m,S,N,K,pe){for(N=S+N;S<N;){var be=m[S++];K[pe++]=be>>16&255,K[pe++]=be>>8&255,K[pe++]=be>>0&255,K[pe++]=be>>24&255}}function Ut(m,S,N,K,pe){for(N=S+N;S<N;){var be=(Le=m[S++])>>16&240|Le>>12&15,Le=Le>>0&240|Le>>28&15;K[pe++]=be,K[pe++]=Le}}function pn(m,S,N,K,pe){for(N=S+N;S<N;){var be=(Le=m[S++])>>16&248|Le>>13&7,Le=Le>>5&224|Le>>3&31;K[pe++]=be,K[pe++]=Le}}function _n(m,S,N,K,pe){for(N=S+N;S<N;){var be=m[S++];K[pe++]=be>>0&255,K[pe++]=be>>8&255,K[pe++]=be>>16&255}}function mn(m,S,N,K,pe,be){if(be==0)for(N=S+N;S<N;)se(K,((be=m[S++])[0]>>24|be[1]>>8&65280|be[2]<<8&16711680|be[3]<<24)>>>0),pe+=32;else i(K,pe,m,S,N)}function rt(m,S){O[S][0]=O[m+"0"],O[S][1]=O[m+"1"],O[S][2]=O[m+"2"],O[S][3]=O[m+"3"],O[S][4]=O[m+"4"],O[S][5]=O[m+"5"],O[S][6]=O[m+"6"],O[S][7]=O[m+"7"],O[S][8]=O[m+"8"],O[S][9]=O[m+"9"],O[S][10]=O[m+"10"],O[S][11]=O[m+"11"],O[S][12]=O[m+"12"],O[S][13]=O[m+"13"],O[S][14]=O[m+"0"],O[S][15]=O[m+"0"]}function vn(m){return m==ls||m==us||m==bo||m==s}function ni(){this.eb=[],this.size=this.A=this.fb=0}function fn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Mn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ni,this.f.kb=new fn,this.sd=null}function Sr(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ii(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Mt(m){return alert("todo:WebPSamplerProcessPlane"),m.T}function On(m,S){var N=m.T,K=S.ba.f.RGBA,pe=K.eb,be=K.fb+m.ka*K.A,Le=xs[S.ba.S],ke=m.y,Be=m.O,Ge=m.f,ft=m.N,Dt=m.ea,Ot=m.W,Lt=S.cc,Vt=S.dc,jt=S.Mc,dt=S.Nc,yt=m.ka,Jt=m.ka+m.T,an=m.U,Yt=an+1>>1;for(yt==0?Le(ke,Be,null,null,Ge,ft,Dt,Ot,Ge,ft,Dt,Ot,pe,be,null,null,an):(Le(S.ec,S.fc,ke,Be,Lt,Vt,jt,dt,Ge,ft,Dt,Ot,pe,be-K.A,pe,be,an),++N);yt+2<Jt;yt+=2)Lt=Ge,Vt=ft,jt=Dt,dt=Ot,ft+=m.Rc,Ot+=m.Rc,be+=2*K.A,Le(ke,(Be+=2*m.fa)-m.fa,ke,Be,Lt,Vt,jt,dt,Ge,ft,Dt,Ot,pe,be-K.A,pe,be,an);return Be+=m.fa,m.j+Jt<m.o?(i(S.ec,S.fc,ke,Be,an),i(S.cc,S.dc,Ge,ft,Yt),i(S.Mc,S.Nc,Dt,Ot,Yt),N--):1&Jt||Le(ke,Be,null,null,Ge,ft,Dt,Ot,Ge,ft,Dt,Ot,pe,be+K.A,null,null,an),N}function Fi(m,S,N){var K=m.F,pe=[m.J];if(K!=null){var be=m.U,Le=S.ba.S,ke=Le==_o||Le==bo;S=S.ba.f.RGBA;var Be=[0],Ge=m.ka;Be[0]=m.T,m.Kb&&(Ge==0?--Be[0]:(--Ge,pe[0]-=m.width),m.j+m.ka+m.T==m.o&&(Be[0]=m.o-m.j-Ge));var ft=S.eb;Ge=S.fb+Ge*S.A,m=nr(K,pe[0],m.width,be,Be,ft,Ge+(ke?0:3),S.A),n(N==Be),m&&vn(Le)&&as(ft,Ge,ke,be,Be,S.A)}return 0}function zi(m){var S=m.ma,N=S.ba.S,K=11>N,pe=N==Yn||N==Xo||N==_o||N==Ns||N==12||vn(N);if(S.memory=null,S.Ib=null,S.Jb=null,S.Nd=null,!Rl(S.Oa,m,pe?11:12))return 0;if(pe&&vn(N)&&sn(),m.da)alert("todo:use_scaling");else{if(K){if(S.Ib=Mt,m.Kb){if(N=m.U+1>>1,S.memory=o(m.U+2*N),S.memory==null)return 0;S.ec=S.memory,S.fc=0,S.cc=S.ec,S.dc=S.fc+m.U,S.Mc=S.cc,S.Nc=S.dc+N,S.Ib=On,sn()}}else alert("todo:EmitYUV");pe&&(S.Jb=Fi,K&&St())}if(K&&!au){for(m=0;256>m;++m)nc[m]=89858*(m-128)+ga>>tc,ic[m]=-22014*(m-128)+ga,ef[m]=-45773*(m-128),tl[m]=113618*(m-128)+ga>>tc;for(m=Bu;m<kc;++m)S=76283*(m-16)+ga>>tc,rc[m-Bu]=yi(S,255),fh[m-Bu]=yi(S+8>>4,15);au=1}return 1}function Xr(m){var S=m.ma,N=m.U,K=m.T;return n(!(1&m.ka)),0>=N||0>=K?0:(N=S.Ib(m,S),S.Jb!=null&&S.Jb(m,S,N),S.Dc+=N,1)}function $r(m){m.ma.memory=null}function Nn(m,S,N,K){return Me(m,8)!=47?0:(S[0]=Me(m,14)+1,N[0]=Me(m,14)+1,K[0]=Me(m,1),Me(m,3)!=0?0:!m.h)}function pi(m,S){if(4>m)return m+1;var N=m-2>>1;return(2+(1&m)<<N)+Me(S,N)+1}function hr(m,S){return 120<S?S-120:1<=(N=((N=at[S-1])>>4)*m+(8-(15&N)))?N:1;var N}function bi(m,S,N){var K=Ee(N),pe=m[S+=255&K].g-8;return 0<pe&&(H(N,N.u+8),K=Ee(N),S+=m[S].value,S+=K&(1<<pe)-1),H(N,N.u+m[S].g),m[S].value}function Zt(m,S,N){return N.g+=m.g,N.value+=m.value<<S>>>0,n(8>=N.g),m.g}function yn(m,S,N){var K=m.xc;return n((S=K==0?0:m.vc[m.md*(N>>K)+(S>>K)])<m.Wb),m.Ya[S]}function er(m,S,N,K){var pe=m.ab,be=m.c*S,Le=m.C;S=Le+S;var ke=N,Be=K;for(K=m.Ta,N=m.Ua;0<pe--;){var Ge=m.gc[pe],ft=Le,Dt=S,Ot=ke,Lt=Be,Vt=(Be=K,ke=N,Ge.Ea);switch(n(ft<Dt),n(Dt<=Ge.nc),Ge.hc){case 2:ou(Ot,Lt,(Dt-ft)*Vt,Be,ke);break;case 0:var jt=ft,dt=Dt,yt=Be,Jt=ke,an=(a=Ge).Ea;jt==0&&(ks(Ot,Lt,null,null,1,yt,Jt),$t(Ot,Lt+1,0,0,an-1,yt,Jt+1),Lt+=an,Jt+=an,++jt);for(var Yt=1<<a.b,Sn=Yt-1,Ln=Re(an,a.b),$n=a.K,a=a.w+(jt>>a.b)*Ln;jt<dt;){var c=$n,p=a,y=1;for(Ts(Ot,Lt,yt,Jt-an,1,yt,Jt);y<an;){var C=(y&~Sn)+Yt;C>an&&(C=an),(0,Zo[c[p++]>>8&15])(Ot,Lt+ +y,yt,Jt+y-an,C-y,yt,Jt+y),y=C}Lt+=an,Jt+=an,++jt&Sn||(a+=Ln)}Dt!=Ge.nc&&i(Be,ke-Vt,Be,ke+(Dt-ft-1)*Vt,Vt);break;case 1:for(Vt=Ot,dt=Lt,an=(Ot=Ge.Ea)-(Jt=Ot&~(yt=(Lt=1<<Ge.b)-1)),jt=Re(Ot,Ge.b),Yt=Ge.K,Ge=Ge.w+(ft>>Ge.b)*jt;ft<Dt;){for(Sn=Yt,Ln=Ge,$n=new Oe,a=dt+Jt,c=dt+Ot;dt<a;)Xe(Sn[Ln++],$n),Ko($n,Vt,dt,Lt,Be,ke),dt+=Lt,ke+=Lt;dt<c&&(Xe(Sn[Ln++],$n),Ko($n,Vt,dt,an,Be,ke),dt+=an,ke+=an),++ft&yt||(Ge+=jt)}break;case 3:if(Ot==Be&&Lt==ke&&0<Ge.b){for(dt=Be,Ot=Vt=ke+(Dt-ft)*Vt-(Jt=(Dt-ft)*Re(Ge.Ea,Ge.b)),Lt=Be,yt=ke,jt=[],Jt=(an=Jt)-1;0<=Jt;--Jt)jt[Jt]=Lt[yt+Jt];for(Jt=an-1;0<=Jt;--Jt)dt[Ot+Jt]=jt[Jt];ns(Ge,ft,Dt,Be,Vt,Be,ke)}else ns(Ge,ft,Dt,Ot,Lt,Be,ke)}ke=K,Be=N}Be!=N&&i(K,N,ke,Be,be)}function kr(m,S){var N=m.V,K=m.Ba+m.c*m.C,pe=S-m.C;if(n(S<=m.l.o),n(16>=pe),0<pe){var be=m.l,Le=m.Ta,ke=m.Ua,Be=be.width;if(er(m,pe,N,K),pe=ke=[ke],n((N=m.C)<(K=S)),n(be.v<be.va),K>be.o&&(K=be.o),N<be.j){var Ge=be.j-N;N=be.j,pe[0]+=Ge*Be}if(N>=K?N=0:(pe[0]+=4*be.v,be.ka=N-be.j,be.U=be.va-be.v,be.T=K-N,N=1),N){if(ke=ke[0],11>(N=m.ca).S){var ft=N.f.RGBA,Dt=(K=N.S,pe=be.U,be=be.T,Ge=ft.eb,ft.A),Ot=be;for(ft=ft.fb+m.Ma*ft.A;0<Ot--;){var Lt=Le,Vt=ke,jt=pe,dt=Ge,yt=ft;switch(K){case Us:_s(Lt,Vt,jt,dt,yt);break;case Yn:os(Lt,Vt,jt,dt,yt);break;case ls:os(Lt,Vt,jt,dt,yt),as(dt,yt,0,jt,1,0);break;case Yo:bs(Lt,Vt,jt,dt,yt);break;case Xo:mn(Lt,Vt,jt,dt,yt,1);break;case us:mn(Lt,Vt,jt,dt,yt,1),as(dt,yt,0,jt,1,0);break;case _o:mn(Lt,Vt,jt,dt,yt,0);break;case bo:mn(Lt,Vt,jt,dt,yt,0),as(dt,yt,1,jt,1,0);break;case Ns:Bo(Lt,Vt,jt,dt,yt);break;case s:Bo(Lt,Vt,jt,dt,yt),Xi(dt,yt,jt,1,0);break;case ku:no(Lt,Vt,jt,dt,yt);break;default:n(0)}ke+=Be,ft+=Dt}m.Ma+=be}else alert("todo:EmitRescaledRowsYUVA");n(m.Ma<=N.height)}}m.C=S,n(m.C<=m.i)}function tr(m){var S;if(0<m.ua)return 0;for(S=0;S<m.Wb;++S){var N=m.Ya[S].G,K=m.Ya[S].H;if(0<N[1][K[1]+0].g||0<N[2][K[2]+0].g||0<N[3][K[3]+0].g)return 0}return 1}function qr(m,S,N,K,pe,be){if(m.Z!=0){var Le=m.qd,ke=m.rd;for(n(Gi[m.Z]!=null);S<N;++S)Gi[m.Z](Le,ke,K,pe,K,pe,be),Le=K,ke=pe,pe+=be;m.qd=Le,m.rd=ke}}function Vr(m,S){var N=m.l.ma,K=N.Z==0||N.Z==1?m.l.j:m.C;if(K=m.C<K?K:m.C,n(S<=m.l.o),S>K){var pe=m.l.width,be=N.ca,Le=N.tb+pe*K,ke=m.V,Be=m.Ba+m.c*K,Ge=m.gc;n(m.ab==1),n(Ge[0].hc==3),vs(Ge[0],K,S,ke,Be,be,Le),qr(N,K,S,be,Le,pe)}m.C=m.Ma=S}function Qn(m,S,N,K,pe,be,Le){var ke=m.$/K,Be=m.$%K,Ge=m.m,ft=m.s,Dt=N+m.$,Ot=Dt;pe=N+K*pe;var Lt=N+K*be,Vt=280+ft.ua,jt=m.Pb?ke:16777216,dt=0<ft.ua?ft.Wa:null,yt=ft.wc,Jt=Dt<Lt?yn(ft,Be,ke):null;n(m.C<be),n(Lt<=pe);var an=!1;e:for(;;){for(;an||Dt<Lt;){var Yt=0;if(ke>=jt){var Sn=Dt-N;n((jt=m).Pb),jt.wd=jt.m,jt.xd=Sn,0<jt.s.ua&&ye(jt.s.Wa,jt.s.vb),jt=ke+zt}if(Be&yt||(Jt=yn(ft,Be,ke)),n(Jt!=null),Jt.Qb&&(S[Dt]=Jt.qb,an=!0),!an)if(he(Ge),Jt.jc){Yt=Ge,Sn=S;var Ln=Dt,$n=Jt.pd[Ee(Yt)&Hr-1];n(Jt.jc),256>$n.g?(H(Yt,Yt.u+$n.g),Sn[Ln]=$n.value,Yt=0):(H(Yt,Yt.u+$n.g-256),n(256<=$n.value),Yt=$n.value),Yt==0&&(an=!0)}else Yt=bi(Jt.G[0],Jt.H[0],Ge);if(Ge.h)break;if(an||256>Yt){if(!an)if(Jt.nd)S[Dt]=(Jt.qb|Yt<<8)>>>0;else{if(he(Ge),an=bi(Jt.G[1],Jt.H[1],Ge),he(Ge),Sn=bi(Jt.G[2],Jt.H[2],Ge),Ln=bi(Jt.G[3],Jt.H[3],Ge),Ge.h)break;S[Dt]=(Ln<<24|an<<16|Yt<<8|Sn)>>>0}if(an=!1,++Dt,++Be>=K&&(Be=0,++ke,Le!=null&&ke<=be&&!(ke%16)&&Le(m,ke),dt!=null))for(;Ot<Dt;)Yt=S[Ot++],dt.X[(506832829*Yt&4294967295)>>>dt.Mb]=Yt}else if(280>Yt){if(Yt=pi(Yt-256,Ge),Sn=bi(Jt.G[4],Jt.H[4],Ge),he(Ge),Sn=hr(K,Sn=pi(Sn,Ge)),Ge.h)break;if(Dt-N<Sn||pe-Dt<Yt)break e;for(Ln=0;Ln<Yt;++Ln)S[Dt+Ln]=S[Dt+Ln-Sn];for(Dt+=Yt,Be+=Yt;Be>=K;)Be-=K,++ke,Le!=null&&ke<=be&&!(ke%16)&&Le(m,ke);if(n(Dt<=pe),Be&yt&&(Jt=yn(ft,Be,ke)),dt!=null)for(;Ot<Dt;)Yt=S[Ot++],dt.X[(506832829*Yt&4294967295)>>>dt.Mb]=Yt}else{if(!(Yt<Vt))break e;for(an=Yt-280,n(dt!=null);Ot<Dt;)Yt=S[Ot++],dt.X[(506832829*Yt&4294967295)>>>dt.Mb]=Yt;Yt=Dt,n(!(an>>>(Sn=dt).Xa)),S[Yt]=Sn.X[an],an=!0}an||n(Ge.h==B(Ge))}if(m.Pb&&Ge.h&&Dt<pe)n(m.m.h),m.a=5,m.m=m.wd,m.$=m.xd,0<m.s.ua&&ye(m.s.vb,m.s.Wa);else{if(Ge.h)break e;Le!=null&&Le(m,ke>be?be:ke),m.a=0,m.$=Dt-N}return 1}return m.a=3,0}function fr(m){n(m!=null),m.vc=null,m.yc=null,m.Ya=null;var S=m.Wa;S!=null&&(S.X=null),m.vb=null,n(m!=null)}function fs(){var m=new Ba;return m==null?null:(m.a=0,m.xb=gl,rt("Predictor","VP8LPredictors"),rt("Predictor","VP8LPredictors_C"),rt("PredictorAdd","VP8LPredictorsAdd"),rt("PredictorAdd","VP8LPredictorsAdd_C"),ou=Xt,Ko=Kt,_s=Qe,os=We,Bo=Ut,no=pn,bs=_n,O.VP8LMapColor32b=Wo,O.VP8LMapColor8b=ys,m)}function Qr(m,S,N,K,pe){var be=1,Le=[m],ke=[S],Be=K.m,Ge=K.s,ft=null,Dt=0;e:for(;;){if(N)for(;be&&Me(Be,1);){var Ot=Le,Lt=ke,Vt=K,jt=1,dt=Vt.m,yt=Vt.gc[Vt.ab],Jt=Me(dt,2);if(Vt.Oc&1<<Jt)be=0;else{switch(Vt.Oc|=1<<Jt,yt.hc=Jt,yt.Ea=Ot[0],yt.nc=Lt[0],yt.K=[null],++Vt.ab,n(4>=Vt.ab),Jt){case 0:case 1:yt.b=Me(dt,3)+2,jt=Qr(Re(yt.Ea,yt.b),Re(yt.nc,yt.b),0,Vt,yt.K),yt.K=yt.K[0];break;case 3:var an,Yt=Me(dt,8)+1,Sn=16<Yt?0:4<Yt?1:2<Yt?2:3;if(Ot[0]=Re(yt.Ea,Sn),yt.b=Sn,an=jt=Qr(Yt,1,0,Vt,yt.K)){var Ln,$n=Yt,a=yt,c=1<<(8>>a.b),p=o(c);if(p==null)an=0;else{var y=a.K[0],C=a.w;for(p[0]=a.K[0][0],Ln=1;Ln<1*$n;++Ln)p[Ln]=Ae(y[C+Ln],p[Ln-1]);for(;Ln<4*c;++Ln)p[Ln]=0;a.K[0]=null,a.K[0]=p,an=1}}jt=an;break;case 2:break;default:n(0)}be=jt}}if(Le=Le[0],ke=ke[0],be&&Me(Be,1)&&!(be=1<=(Dt=Me(Be,4))&&11>=Dt)){K.a=3;break e}var k;if(k=be)t:{var I,q,oe,ve=K,Ke=Le,$e=ke,vt=Dt,Nt=N,Wt=ve.m,gn=ve.s,bn=[null],Zn=1,Ze=0,it=Tt[vt];n:for(;;){if(Nt&&Me(Wt,1)){var ht=Me(Wt,3)+2,It=Re(Ke,ht),xt=Re($e,ht),Rt=It*xt;if(!Qr(It,xt,0,ve,bn))break n;for(bn=bn[0],gn.xc=ht,I=0;I<Rt;++I){var fe=bn[I]>>8&65535;bn[I]=fe,fe>=Zn&&(Zn=fe+1)}}if(Wt.h)break n;for(q=0;5>q;++q){var we=T[q];!q&&0<vt&&(we+=1<<vt),Ze<we&&(Ze=we)}var De=l(Zn*it,R),Ne=Zn,ze=l(Ne,V);if(ze==null)var Ue=null;else n(65536>=Ne),Ue=ze;var lt=o(Ze);if(Ue==null||lt==null||De==null){ve.a=1;break n}var ut=De;for(I=oe=0;I<Zn;++I){var pt=Ue[I],Et=pt.G,At=pt.H,en=0,Tn=1,Rn=0;for(q=0;5>q;++q){we=T[q],Et[q]=ut,At[q]=oe,!q&&0<vt&&(we+=1<<vt);r:{var qn,Hi=we,ir=ve,Ei=lt,ur=ut,Vs=oe,Il=0,zo=ir.m,Tc=Me(zo,1);if(r(Ei,0,0,Hi),Tc){var ma=Me(zo,1)+1,lu=Me(zo,1),jo=Me(zo,lu==0?1:8);Ei[jo]=1,ma==2&&(Ei[jo=Me(zo,8)]=1);var Ls=1}else{var Fr=o(19),vh=Me(zo,4)+4;if(19<vh){ir.a=3;var Bc=0;break r}for(qn=0;qn<vh;++qn)Fr[_e[qn]]=Me(zo,3);var Nc=void 0,Rc=void 0,yh=ir,Di=Fr,_h=Hi,Qf=Ei,Nu=0,Fl=yh.m,ed=8,td=l(128,R);i:for(;z(td,0,7,Di,19);){if(Me(Fl,1)){var Oa=2+2*Me(Fl,3);if((Nc=2+Me(Fl,Oa))>_h)break i}else Nc=_h;for(Rc=0;Rc<_h&&Nc--;){he(Fl);var nd=td[0+(127&Ee(Fl))];H(Fl,Fl.u+nd.g);var zl=nd.value;if(16>zl)Qf[Rc++]=zl,zl!=0&&(ed=zl);else{var tf=zl==16,nf=zl-16,id=w[nf],ea=Me(Fl,f[nf])+id;if(Rc+ea>_h)break i;for(var uu=tf?ed:0;0<ea--;)Qf[Rc++]=uu}}Nu=1;break i}Nu||(yh.a=3),Ls=Nu}(Ls=Ls&&!zo.h)&&(Il=z(ur,Vs,8,Ei,Hi)),Ls&&Il!=0?Bc=Il:(ir.a=3,Bc=0)}if(Bc==0)break n;if(Tn&&Z[q]==1&&(Tn=ut[oe].g==0),en+=ut[oe].g,oe+=Bc,3>=q){var Ru,bh=lt[0];for(Ru=1;Ru<we;++Ru)lt[Ru]>bh&&(bh=lt[Ru]);Rn+=bh}}if(pt.nd=Tn,pt.Qb=0,Tn&&(pt.qb=(Et[3][At[3]+0].value<<24|Et[1][At[1]+0].value<<16|Et[2][At[2]+0].value)>>>0,en==0&&256>Et[0][At[0]+0].value&&(pt.Qb=1,pt.qb+=Et[0][At[0]+0].value<<8)),pt.jc=!pt.Qb&&6>Rn,pt.jc){var Du,ml=pt;for(Du=0;Du<Hr;++Du){var vl=Du,jl=ml.pd[vl],sc=ml.G[0][ml.H[0]+vl];256<=sc.value?(jl.g=sc.g+256,jl.value=sc.value):(jl.g=0,jl.value=0,vl>>=Zt(sc,8,jl),vl>>=Zt(ml.G[1][ml.H[1]+vl],16,jl),vl>>=Zt(ml.G[2][ml.H[2]+vl],0,jl),Zt(ml.G[3][ml.H[3]+vl],24,jl))}}}gn.vc=bn,gn.Wb=Zn,gn.Ya=Ue,gn.yc=De,k=1;break t}k=0}if(!(be=k)){K.a=3;break e}if(0<Dt){if(Ge.ua=1<<Dt,!xe(Ge.Wa,Dt)){K.a=1,be=0;break e}}else Ge.ua=0;var Dc=K,Ul=Le,Wp=ke,yl=Dc.s,wh=yl.xc;if(Dc.c=Ul,Dc.i=Wp,yl.md=Re(Ul,wh),yl.wc=wh==0?-1:(1<<wh)-1,N){K.xb=Mc;break e}if((ft=o(Le*ke))==null){K.a=1,be=0;break e}be=(be=Qn(K,ft,0,Le,ke,ke,null))&&!Be.h;break e}return be?(pe!=null?pe[0]=ft:(n(ft==null),n(N)),K.$=0,N||fr(Ge)):fr(Ge),be}function Ci(m,S){var N=m.c*m.i,K=N+S+16*S;return n(m.c<=S),m.V=o(K),m.V==null?(m.Ta=null,m.Ua=0,m.a=1,0):(m.Ta=m.V,m.Ua=m.Ba+N+S,1)}function An(m,S){var N=m.C,K=S-N,pe=m.V,be=m.Ba+m.c*N;for(n(S<=m.l.o);0<K;){var Le=16<K?16:K,ke=m.l.ma,Be=m.l.width,Ge=Be*Le,ft=ke.ca,Dt=ke.tb+Be*N,Ot=m.Ta,Lt=m.Ua;er(m,Le,pe,be),Ir(Ot,Lt,ft,Dt,Ge),qr(ke,N,N+Le,ft,Dt,Be),K-=Le,pe+=Le*m.c,N+=Le}n(N==S),m.C=m.Ma=S}function Pr(){this.ub=this.yd=this.td=this.Rb=0}function Ui(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Vi(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function dr(){this.Yb=function(){var m=[];return function S(N,K,pe){for(var be=pe[K],Le=0;Le<be&&(N.push(pe.length>K+1?[]:0),!(pe.length<K+1));Le++)S(N[Le],K+1,pe)}(m,0,[3,11]),m}()}function es(){this.jb=o(3),this.Wc=h([4,8],dr),this.Xc=h([4,17],dr)}function Fs(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function di(){this.ld=this.La=this.dd=this.tc=0}function co(){this.Na=this.la=0}function mr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Er(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function mi(){this.uc=this.M=this.Nb=0,this.wa=Array(new di),this.Y=0,this.ya=Array(new Er),this.aa=0,this.l=new ii}function xn(){this.y=o(16),this.f=o(8),this.ea=o(8)}function on(){this.cb=this.a=0,this.sc="",this.m=new ot,this.Od=new Pr,this.Kc=new Ui,this.ed=new Fs,this.Qa=new Vi,this.Ic=this.$c=this.Aa=0,this.D=new mi,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=l(8,ot),this.ia=0,this.pb=l(4,mr),this.Pa=new es,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new xn),this.Hd=0,this.rb=Array(new co),this.sb=0,this.wa=Array(new di),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Er),this.L=this.aa=0,this.gd=h([4,2],di),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ii(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Xn(){var m=new on;return m!=null&&(m.a=0,m.sc="OK",m.cb=0,m.Xb=0,Un||(Un=Tr)),m}function jn(m,S,N){return m.a==0&&(m.a=S,m.sc=N,m.cb=0),0}function rs(m,S,N){return 3<=N&&m[S+0]==157&&m[S+1]==1&&m[S+2]==42}function Ps(m,S){if(m==null)return 0;if(m.a=0,m.sc="OK",S==null)return jn(m,2,"null VP8Io passed to VP8GetHeaders()");var N=S.data,K=S.w,pe=S.ha;if(4>pe)return jn(m,7,"Truncated header.");var be=N[K+0]|N[K+1]<<8|N[K+2]<<16,Le=m.Od;if(Le.Rb=!(1&be),Le.td=be>>1&7,Le.yd=be>>4&1,Le.ub=be>>5,3<Le.td)return jn(m,3,"Incorrect keyframe parameters.");if(!Le.yd)return jn(m,4,"Frame not displayable.");K+=3,pe-=3;var ke=m.Kc;if(Le.Rb){if(7>pe)return jn(m,7,"cannot parse picture header");if(!rs(N,K,pe))return jn(m,3,"Bad code word");ke.c=16383&(N[K+4]<<8|N[K+3]),ke.Td=N[K+4]>>6,ke.i=16383&(N[K+6]<<8|N[K+5]),ke.Ud=N[K+6]>>6,K+=7,pe-=7,m.za=ke.c+15>>4,m.Ub=ke.i+15>>4,S.width=ke.c,S.height=ke.i,S.Da=0,S.j=0,S.v=0,S.va=S.width,S.o=S.height,S.da=0,S.ib=S.width,S.hb=S.height,S.U=S.width,S.T=S.height,r((be=m.Pa).jb,0,255,be.jb.length),n((be=m.Qa)!=null),be.Cb=0,be.Bb=0,be.Fb=1,r(be.Zb,0,0,be.Zb.length),r(be.Lb,0,0,be.Lb)}if(Le.ub>pe)return jn(m,7,"bad partition length");U(be=m.m,N,K,Le.ub),K+=Le.ub,pe-=Le.ub,Le.Rb&&(ke.Ld=ie(be),ke.Kd=ie(be)),ke=m.Qa;var Be,Ge=m.Pa;if(n(be!=null),n(ke!=null),ke.Cb=ie(be),ke.Cb){if(ke.Bb=ie(be),ie(be)){for(ke.Fb=ie(be),Be=0;4>Be;++Be)ke.Zb[Be]=ie(be)?ce(be,7):0;for(Be=0;4>Be;++Be)ke.Lb[Be]=ie(be)?ce(be,6):0}if(ke.Bb)for(Be=0;3>Be;++Be)Ge.jb[Be]=ie(be)?Y(be,8):255}else ke.Bb=0;if(be.Ka)return jn(m,3,"cannot parse segment header");if((ke=m.ed).zd=ie(be),ke.Tb=Y(be,6),ke.wb=Y(be,3),ke.Pc=ie(be),ke.Pc&&ie(be)){for(Ge=0;4>Ge;++Ge)ie(be)&&(ke.vd[Ge]=ce(be,6));for(Ge=0;4>Ge;++Ge)ie(be)&&(ke.od[Ge]=ce(be,6))}if(m.L=ke.Tb==0?0:ke.zd?1:2,be.Ka)return jn(m,3,"cannot parse filter header");var ft=pe;if(pe=Be=K,K=Be+ft,ke=ft,m.Xb=(1<<Y(m.m,2))-1,ft<3*(Ge=m.Xb))N=7;else{for(Be+=3*Ge,ke-=3*Ge,ft=0;ft<Ge;++ft){var Dt=N[pe+0]|N[pe+1]<<8|N[pe+2]<<16;Dt>ke&&(Dt=ke),U(m.Jc[+ft],N,Be,Dt),Be+=Dt,ke-=Dt,pe+=3}U(m.Jc[+Ge],N,Be,ke),N=Be<K?0:5}if(N!=0)return jn(m,N,"cannot parse partitions");for(N=Y(Be=m.m,7),pe=ie(Be)?ce(Be,4):0,K=ie(Be)?ce(Be,4):0,ke=ie(Be)?ce(Be,4):0,Ge=ie(Be)?ce(Be,4):0,Be=ie(Be)?ce(Be,4):0,ft=m.Qa,Dt=0;4>Dt;++Dt){if(ft.Cb){var Ot=ft.Zb[Dt];ft.Fb||(Ot+=N)}else{if(0<Dt){m.pb[Dt]=m.pb[0];continue}Ot=N}var Lt=m.pb[Dt];Lt.Sc[0]=tn[yi(Ot+pe,127)],Lt.Sc[1]=En[yi(Ot+0,127)],Lt.Eb[0]=2*tn[yi(Ot+K,127)],Lt.Eb[1]=101581*En[yi(Ot+ke,127)]>>16,8>Lt.Eb[1]&&(Lt.Eb[1]=8),Lt.Qc[0]=tn[yi(Ot+Ge,117)],Lt.Qc[1]=En[yi(Ot+Be,127)],Lt.lc=Ot+Be}if(!Le.Rb)return jn(m,4,"Not a key frame.");for(ie(be),Le=m.Pa,N=0;4>N;++N){for(pe=0;8>pe;++pe)for(K=0;3>K;++K)for(ke=0;11>ke;++ke)Ge=ee(be,$s[N][pe][K][ke])?Y(be,8):cs[N][pe][K][ke],Le.Wc[N][pe].Yb[K][ke]=Ge;for(pe=0;17>pe;++pe)Le.Xc[N][pe]=Le.Wc[N][Tu[pe]]}return m.kc=ie(be),m.kc&&(m.Bd=Y(be,8)),m.cb=1}function Tr(m,S,N,K,pe,be,Le){var ke=S[pe].Yb[N];for(N=0;16>pe;++pe){if(!ee(m,ke[N+0]))return pe;for(;!ee(m,ke[N+1]);)if(ke=S[++pe].Yb[0],N=0,pe==16)return 16;var Be=S[pe+1].Yb;if(ee(m,ke[N+2])){var Ge=m,ft=0;if(ee(Ge,(Ot=ke)[(Dt=N)+3]))if(ee(Ge,Ot[Dt+6])){for(ke=0,Dt=2*(ft=ee(Ge,Ot[Dt+8]))+(Ot=ee(Ge,Ot[Dt+9+ft])),ft=0,Ot=gi[Dt];Ot[ke];++ke)ft+=ft+ee(Ge,Ot[ke]);ft+=3+(8<<Dt)}else ee(Ge,Ot[Dt+7])?(ft=7+2*ee(Ge,165),ft+=ee(Ge,145)):ft=5+ee(Ge,159);else ft=ee(Ge,Ot[Dt+4])?3+ee(Ge,Ot[Dt+5]):2;ke=Be[2]}else ft=1,ke=Be[1];Be=Le+Zr[pe],0>(Ge=m).b&&te(Ge);var Dt,Ot=Ge.b,Lt=(Dt=Ge.Ca>>1)-(Ge.I>>Ot)>>31;--Ge.b,Ge.Ca+=Lt,Ge.Ca|=1,Ge.I-=(Dt+1&Lt)<<Ot,be[Be]=((ft^Lt)-Lt)*K[(0<pe)+0]}return 16}function so(m){var S=m.rb[m.sb-1];S.la=0,S.Na=0,r(m.zc,0,0,m.zc.length),m.ja=0}function ln(m,S){if(m==null)return 0;if(S==null)return jn(m,2,"NULL VP8Io parameter in VP8Decode().");if(!m.cb&&!Ps(m,S))return 0;if(n(m.cb),S.ac==null||S.ac(S)){S.ob&&(m.L=0);var N=Qo[m.L];if(m.L==2?(m.yb=0,m.zb=0):(m.yb=S.v-N>>4,m.zb=S.j-N>>4,0>m.yb&&(m.yb=0),0>m.zb&&(m.zb=0)),m.Va=S.o+15+N>>4,m.Hb=S.va+15+N>>4,m.Hb>m.za&&(m.Hb=m.za),m.Va>m.Ub&&(m.Va=m.Ub),0<m.L){var K=m.ed;for(N=0;4>N;++N){var pe;if(m.Qa.Cb){var be=m.Qa.Lb[N];m.Qa.Fb||(be+=K.Tb)}else be=K.Tb;for(pe=0;1>=pe;++pe){var Le=m.gd[N][pe],ke=be;if(K.Pc&&(ke+=K.vd[0],pe&&(ke+=K.od[0])),0<(ke=0>ke?0:63<ke?63:ke)){var Be=ke;0<K.wb&&(Be=4<K.wb?Be>>2:Be>>1)>9-K.wb&&(Be=9-K.wb),1>Be&&(Be=1),Le.dd=Be,Le.tc=2*ke+Be,Le.ld=40<=ke?2:15<=ke?1:0}else Le.tc=0;Le.La=pe}}}N=0}else jn(m,6,"Frame setup failed"),N=m.a;if(N=N==0){if(N){m.$c=0,0<m.Aa||(m.Ic=gh);e:{N=m.Ic,K=4*(Be=m.za);var Ge=32*Be,ft=Be+1,Dt=0<m.L?Be*(0<m.Aa?2:1):0,Ot=(m.Aa==2?2:1)*Be;if((Le=K+832+(pe=3*(16*N+Qo[m.L])/2*Ge)+(be=m.Fa!=null&&0<m.Fa.length?m.Kc.c*m.Kc.i:0))!=Le)N=0;else{if(Le>m.Vb){if(m.Vb=0,m.Ec=o(Le),m.Fc=0,m.Ec==null){N=jn(m,1,"no memory during frame initialization.");break e}m.Vb=Le}Le=m.Ec,ke=m.Fc,m.Ac=Le,m.Bc=ke,ke+=K,m.Gd=l(Ge,xn),m.Hd=0,m.rb=l(ft+1,co),m.sb=1,m.wa=Dt?l(Dt,di):null,m.Y=0,m.D.Nb=0,m.D.wa=m.wa,m.D.Y=m.Y,0<m.Aa&&(m.D.Y+=Be),n(!0),m.oc=Le,m.pc=ke,ke+=832,m.ya=l(Ot,Er),m.aa=0,m.D.ya=m.ya,m.D.aa=m.aa,m.Aa==2&&(m.D.aa+=Be),m.R=16*Be,m.B=8*Be,Be=(Ge=Qo[m.L])*m.R,Ge=Ge/2*m.B,m.sa=Le,m.ta=ke+Be,m.qa=m.sa,m.ra=m.ta+16*N*m.R+Ge,m.Ha=m.qa,m.Ia=m.ra+8*N*m.B+Ge,m.$c=0,ke+=pe,m.mb=be?Le:null,m.nb=be?ke:null,n(ke+be<=m.Fc+m.Vb),so(m),r(m.Ac,m.Bc,0,K),N=1}}if(N){if(S.ka=0,S.y=m.sa,S.O=m.ta,S.f=m.qa,S.N=m.ra,S.ea=m.Ha,S.Vd=m.Ia,S.fa=m.R,S.Rc=m.B,S.F=null,S.J=0,!Dl){for(N=-255;255>=N;++N)lr[255+N]=0>N?-N:N;for(N=-1020;1020>=N;++N)io[1020+N]=-128>N?-128:127<N?127:N;for(N=-112;112>=N;++N)js[112+N]=-16>N?-16:15<N?15:N;for(N=-255;510>=N;++N)lo[255+N]=0>N?0:255<N?255:N;Dl=1}bt=oo,qt=Ao,Cn=ho,In=ar,si=Es,Bt=Ea,_r=dl,Yi=Mo,el=ao,Bs=Xa,br=Ja,No=Ya,Jo=Zi,Ro=su,Do=Nr,Oo=Gn,Pi=Rr,yo=Ta,wo[0]=Ri,wo[1]=Wi,wo[2]=li,wo[3]=po,wo[4]=Bl,wo[5]=Ma,wo[6]=Aa,wo[7]=go,wo[8]=Nl,wo[9]=ha,Fo[0]=Ha,Fo[1]=ps,Fo[2]=fo,Fo[3]=Vo,Fo[4]=ts,Fo[5]=iu,Fo[6]=cl,uo[0]=fa,uo[1]=ds,uo[2]=Wa,uo[3]=oi,uo[4]=Za,uo[5]=ru,uo[6]=hl,N=1}else N=0}N&&(N=function(Lt,Vt){for(Lt.M=0;Lt.M<Lt.Va;++Lt.M){var jt,dt=Lt.Jc[Lt.M&Lt.Xb],yt=Lt.m,Jt=Lt;for(jt=0;jt<Jt.za;++jt){var an=yt,Yt=Jt,Sn=Yt.Ac,Ln=Yt.Bc+4*jt,$n=Yt.zc,a=Yt.ya[Yt.aa+jt];if(Yt.Qa.Bb?a.$b=ee(an,Yt.Pa.jb[0])?2+ee(an,Yt.Pa.jb[2]):ee(an,Yt.Pa.jb[1]):a.$b=0,Yt.kc&&(a.Ad=ee(an,Yt.Bd)),a.Za=!ee(an,145)+0,a.Za){var c=a.Ob,p=0;for(Yt=0;4>Yt;++Yt){var y,C=$n[0+Yt];for(y=0;4>y;++y){C=wr[Sn[Ln+y]][C];for(var k=Ar[ee(an,C[0])];0<k;)k=Ar[2*k+ee(an,C[k])];C=-k,Sn[Ln+y]=C}i(c,p,Sn,Ln,4),p+=4,$n[0+Yt]=C}}else C=ee(an,156)?ee(an,128)?1:3:ee(an,163)?2:0,a.Ob[0]=C,r(Sn,Ln,C,4),r($n,0,C,4);a.Dd=ee(an,142)?ee(an,114)?ee(an,183)?1:3:2:0}if(Jt.m.Ka)return jn(Lt,7,"Premature end-of-partition0 encountered.");for(;Lt.ja<Lt.za;++Lt.ja){if(Jt=dt,an=(yt=Lt).rb[yt.sb-1],Sn=yt.rb[yt.sb+yt.ja],jt=yt.ya[yt.aa+yt.ja],Ln=yt.kc?jt.Ad:0)an.la=Sn.la=0,jt.Za||(an.Na=Sn.Na=0),jt.Hc=0,jt.Gc=0,jt.ia=0;else{var I,q;if(an=Sn,Sn=Jt,Ln=yt.Pa.Xc,$n=yt.ya[yt.aa+yt.ja],a=yt.pb[$n.$b],Yt=$n.ad,c=0,p=yt.rb[yt.sb-1],C=y=0,r(Yt,c,0,384),$n.Za)var oe=0,ve=Ln[3];else{k=o(16);var Ke=an.Na+p.Na;if(Ke=Un(Sn,Ln[1],Ke,a.Eb,0,k,0),an.Na=p.Na=(0<Ke)+0,1<Ke)bt(k,0,Yt,c);else{var $e=k[0]+3>>3;for(k=0;256>k;k+=16)Yt[c+k]=$e}oe=1,ve=Ln[0]}var vt=15&an.la,Nt=15&p.la;for(k=0;4>k;++k){var Wt=1&Nt;for($e=q=0;4>$e;++$e)vt=vt>>1|(Wt=(Ke=Un(Sn,ve,Ke=Wt+(1&vt),a.Sc,oe,Yt,c))>oe)<<7,q=q<<2|(3<Ke?3:1<Ke?2:Yt[c+0]!=0),c+=16;vt>>=4,Nt=Nt>>1|Wt<<7,y=(y<<8|q)>>>0}for(ve=vt,oe=Nt>>4,I=0;4>I;I+=2){for(q=0,vt=an.la>>4+I,Nt=p.la>>4+I,k=0;2>k;++k){for(Wt=1&Nt,$e=0;2>$e;++$e)Ke=Wt+(1&vt),vt=vt>>1|(Wt=0<(Ke=Un(Sn,Ln[2],Ke,a.Qc,0,Yt,c)))<<3,q=q<<2|(3<Ke?3:1<Ke?2:Yt[c+0]!=0),c+=16;vt>>=2,Nt=Nt>>1|Wt<<5}C|=q<<4*I,ve|=vt<<4<<I,oe|=(240&Nt)<<I}an.la=ve,p.la=oe,$n.Hc=y,$n.Gc=C,$n.ia=43690&C?0:a.ia,Ln=!(y|C)}if(0<yt.L&&(yt.wa[yt.Y+yt.ja]=yt.gd[jt.$b][jt.Za],yt.wa[yt.Y+yt.ja].La|=!Ln),Jt.Ka)return jn(Lt,7,"Premature end-of-file encountered.")}if(so(Lt),yt=Vt,Jt=1,jt=(dt=Lt).D,an=0<dt.L&&dt.M>=dt.zb&&dt.M<=dt.Va,dt.Aa==0)e:{if(jt.M=dt.M,jt.uc=an,pl(dt,jt),Jt=1,jt=(q=dt.D).Nb,an=(C=Qo[dt.L])*dt.R,Sn=C/2*dt.B,k=16*jt*dt.R,$e=8*jt*dt.B,Ln=dt.sa,$n=dt.ta-an+k,a=dt.qa,Yt=dt.ra-Sn+$e,c=dt.Ha,p=dt.Ia-Sn+$e,Nt=(vt=q.M)==0,y=vt>=dt.Va-1,dt.Aa==2&&pl(dt,q),q.uc)for(Wt=(Ke=dt).D.M,n(Ke.D.uc),q=Ke.yb;q<Ke.Hb;++q){oe=q,ve=Wt;var gn=(bn=(we=Ke).D).Nb;I=we.R;var bn=bn.wa[bn.Y+oe],Zn=we.sa,Ze=we.ta+16*gn*I+16*oe,it=bn.dd,ht=bn.tc;if(ht!=0)if(n(3<=ht),we.L==1)0<oe&&Oo(Zn,Ze,I,ht+4),bn.La&&yo(Zn,Ze,I,ht),0<ve&&Do(Zn,Ze,I,ht+4),bn.La&&Pi(Zn,Ze,I,ht);else{var It=we.B,xt=we.qa,Rt=we.ra+8*gn*It+8*oe,fe=we.Ha,we=we.Ia+8*gn*It+8*oe;gn=bn.ld,0<oe&&(Yi(Zn,Ze,I,ht+4,it,gn),Bs(xt,Rt,fe,we,It,ht+4,it,gn)),bn.La&&(No(Zn,Ze,I,ht,it,gn),Ro(xt,Rt,fe,we,It,ht,it,gn)),0<ve&&(_r(Zn,Ze,I,ht+4,it,gn),el(xt,Rt,fe,we,It,ht+4,it,gn)),bn.La&&(br(Zn,Ze,I,ht,it,gn),Jo(xt,Rt,fe,we,It,ht,it,gn))}}if(dt.ia&&alert("todo:DitherRow"),yt.put!=null){if(q=16*vt,vt=16*(vt+1),Nt?(yt.y=dt.sa,yt.O=dt.ta+k,yt.f=dt.qa,yt.N=dt.ra+$e,yt.ea=dt.Ha,yt.W=dt.Ia+$e):(q-=C,yt.y=Ln,yt.O=$n,yt.f=a,yt.N=Yt,yt.ea=c,yt.W=p),y||(vt-=C),vt>yt.o&&(vt=yt.o),yt.F=null,yt.J=null,dt.Fa!=null&&0<dt.Fa.length&&q<vt&&(yt.J=Dr(dt,yt,q,vt-q),yt.F=dt.mb,yt.F==null&&yt.F.length==0)){Jt=jn(dt,3,"Could not decode alpha data.");break e}q<yt.j&&(C=yt.j-q,q=yt.j,n(!(1&C)),yt.O+=dt.R*C,yt.N+=dt.B*(C>>1),yt.W+=dt.B*(C>>1),yt.F!=null&&(yt.J+=yt.width*C)),q<vt&&(yt.O+=yt.v,yt.N+=yt.v>>1,yt.W+=yt.v>>1,yt.F!=null&&(yt.J+=yt.v),yt.ka=q-yt.j,yt.U=yt.va-yt.v,yt.T=vt-q,Jt=yt.put(yt))}jt+1!=dt.Ic||y||(i(dt.sa,dt.ta-an,Ln,$n+16*dt.R,an),i(dt.qa,dt.ra-Sn,a,Yt+8*dt.B,Sn),i(dt.Ha,dt.Ia-Sn,c,p+8*dt.B,Sn))}if(!Jt)return jn(Lt,6,"Output aborted.")}return 1}(m,S)),S.bc!=null&&S.bc(S),N&=1}return N?(m.cb=0,N):0}function Jn(m,S,N,K,pe){pe=m[S+N+32*K]+(pe>>3),m[S+N+32*K]=-256&pe?0>pe?0:255:pe}function vr(m,S,N,K,pe,be){Jn(m,S,0,N,K+pe),Jn(m,S,1,N,K+be),Jn(m,S,2,N,K-be),Jn(m,S,3,N,K-pe)}function sr(m){return(20091*m>>16)+m}function pr(m,S,N,K){var pe,be=0,Le=o(16);for(pe=0;4>pe;++pe){var ke=m[S+0]+m[S+8],Be=m[S+0]-m[S+8],Ge=(35468*m[S+4]>>16)-sr(m[S+12]),ft=sr(m[S+4])+(35468*m[S+12]>>16);Le[be+0]=ke+ft,Le[be+1]=Be+Ge,Le[be+2]=Be-Ge,Le[be+3]=ke-ft,be+=4,S++}for(pe=be=0;4>pe;++pe)ke=(m=Le[be+0]+4)+Le[be+8],Be=m-Le[be+8],Ge=(35468*Le[be+4]>>16)-sr(Le[be+12]),Jn(N,K,0,0,ke+(ft=sr(Le[be+4])+(35468*Le[be+12]>>16))),Jn(N,K,1,0,Be+Ge),Jn(N,K,2,0,Be-Ge),Jn(N,K,3,0,ke-ft),be++,K+=32}function Ea(m,S,N,K){var pe=m[S+0]+4,be=35468*m[S+4]>>16,Le=sr(m[S+4]),ke=35468*m[S+1]>>16;vr(N,K,0,pe+Le,m=sr(m[S+1]),ke),vr(N,K,1,pe+be,m,ke),vr(N,K,2,pe-be,m,ke),vr(N,K,3,pe-Le,m,ke)}function Ao(m,S,N,K,pe){pr(m,S,N,K),pe&&pr(m,S+16,N,K+4)}function ho(m,S,N,K){qt(m,S+0,N,K,1),qt(m,S+32,N,K+128,1)}function ar(m,S,N,K){var pe;for(m=m[S+0]+4,pe=0;4>pe;++pe)for(S=0;4>S;++S)Jn(N,K,S,pe,m)}function Es(m,S,N,K){m[S+0]&&In(m,S+0,N,K),m[S+16]&&In(m,S+16,N,K+4),m[S+32]&&In(m,S+32,N,K+128),m[S+48]&&In(m,S+48,N,K+128+4)}function oo(m,S,N,K){var pe,be=o(16);for(pe=0;4>pe;++pe){var Le=m[S+0+pe]+m[S+12+pe],ke=m[S+4+pe]+m[S+8+pe],Be=m[S+4+pe]-m[S+8+pe],Ge=m[S+0+pe]-m[S+12+pe];be[0+pe]=Le+ke,be[8+pe]=Le-ke,be[4+pe]=Ge+Be,be[12+pe]=Ge-Be}for(pe=0;4>pe;++pe)Le=(m=be[0+4*pe]+3)+be[3+4*pe],ke=be[1+4*pe]+be[2+4*pe],Be=be[1+4*pe]-be[2+4*pe],Ge=m-be[3+4*pe],N[K+0]=Le+ke>>3,N[K+16]=Ge+Be>>3,N[K+32]=Le-ke>>3,N[K+48]=Ge-Be>>3,K+=64}function As(m,S,N){var K,pe=S-32,be=or,Le=255-m[pe-1];for(K=0;K<N;++K){var ke,Be=be,Ge=Le+m[S-1];for(ke=0;ke<N;++ke)m[S+ke]=Be[Ge+m[pe+ke]];S+=32}}function Wi(m,S){As(m,S,4)}function ds(m,S){As(m,S,8)}function ps(m,S){As(m,S,16)}function fo(m,S){var N;for(N=0;16>N;++N)i(m,S+32*N,m,S-32,16)}function Vo(m,S){var N;for(N=16;0<N;--N)r(m,S,m[S-1],16),S+=32}function ca(m,S,N){var K;for(K=0;16>K;++K)r(S,N+32*K,m,16)}function Ha(m,S){var N,K=16;for(N=0;16>N;++N)K+=m[S-1+32*N]+m[S+N-32];ca(K>>5,m,S)}function ts(m,S){var N,K=8;for(N=0;16>N;++N)K+=m[S-1+32*N];ca(K>>4,m,S)}function iu(m,S){var N,K=8;for(N=0;16>N;++N)K+=m[S+N-32];ca(K>>4,m,S)}function cl(m,S){ca(128,m,S)}function ri(m,S,N){return m+2*S+N+2>>2}function li(m,S){var N,K=S-32;for(K=new Uint8Array([ri(m[K-1],m[K+0],m[K+1]),ri(m[K+0],m[K+1],m[K+2]),ri(m[K+1],m[K+2],m[K+3]),ri(m[K+2],m[K+3],m[K+4])]),N=0;4>N;++N)i(m,S+32*N,K,0,K.length)}function po(m,S){var N=m[S-1],K=m[S-1+32],pe=m[S-1+64],be=m[S-1+96];se(m,S+0,16843009*ri(m[S-1-32],N,K)),se(m,S+32,16843009*ri(N,K,pe)),se(m,S+64,16843009*ri(K,pe,be)),se(m,S+96,16843009*ri(pe,be,be))}function Ri(m,S){var N,K=4;for(N=0;4>N;++N)K+=m[S+N-32]+m[S-1+32*N];for(K>>=3,N=0;4>N;++N)r(m,S+32*N,K,4)}function Bl(m,S){var N=m[S-1+0],K=m[S-1+32],pe=m[S-1+64],be=m[S-1-32],Le=m[S+0-32],ke=m[S+1-32],Be=m[S+2-32],Ge=m[S+3-32];m[S+0+96]=ri(K,pe,m[S-1+96]),m[S+1+96]=m[S+0+64]=ri(N,K,pe),m[S+2+96]=m[S+1+64]=m[S+0+32]=ri(be,N,K),m[S+3+96]=m[S+2+64]=m[S+1+32]=m[S+0+0]=ri(Le,be,N),m[S+3+64]=m[S+2+32]=m[S+1+0]=ri(ke,Le,be),m[S+3+32]=m[S+2+0]=ri(Be,ke,Le),m[S+3+0]=ri(Ge,Be,ke)}function Aa(m,S){var N=m[S+1-32],K=m[S+2-32],pe=m[S+3-32],be=m[S+4-32],Le=m[S+5-32],ke=m[S+6-32],Be=m[S+7-32];m[S+0+0]=ri(m[S+0-32],N,K),m[S+1+0]=m[S+0+32]=ri(N,K,pe),m[S+2+0]=m[S+1+32]=m[S+0+64]=ri(K,pe,be),m[S+3+0]=m[S+2+32]=m[S+1+64]=m[S+0+96]=ri(pe,be,Le),m[S+3+32]=m[S+2+64]=m[S+1+96]=ri(be,Le,ke),m[S+3+64]=m[S+2+96]=ri(Le,ke,Be),m[S+3+96]=ri(ke,Be,Be)}function Ma(m,S){var N=m[S-1+0],K=m[S-1+32],pe=m[S-1+64],be=m[S-1-32],Le=m[S+0-32],ke=m[S+1-32],Be=m[S+2-32],Ge=m[S+3-32];m[S+0+0]=m[S+1+64]=be+Le+1>>1,m[S+1+0]=m[S+2+64]=Le+ke+1>>1,m[S+2+0]=m[S+3+64]=ke+Be+1>>1,m[S+3+0]=Be+Ge+1>>1,m[S+0+96]=ri(pe,K,N),m[S+0+64]=ri(K,N,be),m[S+0+32]=m[S+1+96]=ri(N,be,Le),m[S+1+32]=m[S+2+96]=ri(be,Le,ke),m[S+2+32]=m[S+3+96]=ri(Le,ke,Be),m[S+3+32]=ri(ke,Be,Ge)}function go(m,S){var N=m[S+0-32],K=m[S+1-32],pe=m[S+2-32],be=m[S+3-32],Le=m[S+4-32],ke=m[S+5-32],Be=m[S+6-32],Ge=m[S+7-32];m[S+0+0]=N+K+1>>1,m[S+1+0]=m[S+0+64]=K+pe+1>>1,m[S+2+0]=m[S+1+64]=pe+be+1>>1,m[S+3+0]=m[S+2+64]=be+Le+1>>1,m[S+0+32]=ri(N,K,pe),m[S+1+32]=m[S+0+96]=ri(K,pe,be),m[S+2+32]=m[S+1+96]=ri(pe,be,Le),m[S+3+32]=m[S+2+96]=ri(be,Le,ke),m[S+3+64]=ri(Le,ke,Be),m[S+3+96]=ri(ke,Be,Ge)}function ha(m,S){var N=m[S-1+0],K=m[S-1+32],pe=m[S-1+64],be=m[S-1+96];m[S+0+0]=N+K+1>>1,m[S+2+0]=m[S+0+32]=K+pe+1>>1,m[S+2+32]=m[S+0+64]=pe+be+1>>1,m[S+1+0]=ri(N,K,pe),m[S+3+0]=m[S+1+32]=ri(K,pe,be),m[S+3+32]=m[S+1+64]=ri(pe,be,be),m[S+3+64]=m[S+2+64]=m[S+0+96]=m[S+1+96]=m[S+2+96]=m[S+3+96]=be}function Nl(m,S){var N=m[S-1+0],K=m[S-1+32],pe=m[S-1+64],be=m[S-1+96],Le=m[S-1-32],ke=m[S+0-32],Be=m[S+1-32],Ge=m[S+2-32];m[S+0+0]=m[S+2+32]=N+Le+1>>1,m[S+0+32]=m[S+2+64]=K+N+1>>1,m[S+0+64]=m[S+2+96]=pe+K+1>>1,m[S+0+96]=be+pe+1>>1,m[S+3+0]=ri(ke,Be,Ge),m[S+2+0]=ri(Le,ke,Be),m[S+1+0]=m[S+3+32]=ri(N,Le,ke),m[S+1+32]=m[S+3+64]=ri(K,N,Le),m[S+1+64]=m[S+3+96]=ri(pe,K,N),m[S+1+96]=ri(be,pe,K)}function Wa(m,S){var N;for(N=0;8>N;++N)i(m,S+32*N,m,S-32,8)}function oi(m,S){var N;for(N=0;8>N;++N)r(m,S,m[S-1],8),S+=32}function wi(m,S,N){var K;for(K=0;8>K;++K)r(S,N+32*K,m,8)}function fa(m,S){var N,K=8;for(N=0;8>N;++N)K+=m[S+N-32]+m[S-1+32*N];wi(K>>4,m,S)}function ru(m,S){var N,K=4;for(N=0;8>N;++N)K+=m[S+N-32];wi(K>>3,m,S)}function Za(m,S){var N,K=4;for(N=0;8>N;++N)K+=m[S-1+32*N];wi(K>>3,m,S)}function hl(m,S){wi(128,m,S)}function ka(m,S,N){var K=m[S-N],pe=m[S+0],be=3*(pe-K)+Io[1020+m[S-2*N]-m[S+N]],Le=Wr[112+(be+4>>3)];m[S-N]=or[255+K+Wr[112+(be+3>>3)]],m[S+0]=or[255+pe-Le]}function Ka(m,S,N,K){var pe=m[S+0],be=m[S+N];return ws[255+m[S-2*N]-m[S-N]]>K||ws[255+be-pe]>K}function fl(m,S,N,K){return 4*ws[255+m[S-N]-m[S+0]]+ws[255+m[S-2*N]-m[S+N]]<=K}function Si(m,S,N,K,pe){var be=m[S-3*N],Le=m[S-2*N],ke=m[S-N],Be=m[S+0],Ge=m[S+N],ft=m[S+2*N],Dt=m[S+3*N];return 4*ws[255+ke-Be]+ws[255+Le-Ge]>K?0:ws[255+m[S-4*N]-be]<=pe&&ws[255+be-Le]<=pe&&ws[255+Le-ke]<=pe&&ws[255+Dt-ft]<=pe&&ws[255+ft-Ge]<=pe&&ws[255+Ge-Be]<=pe}function Nr(m,S,N,K){var pe=2*K+1;for(K=0;16>K;++K)fl(m,S+K,N,pe)&&ka(m,S+K,N)}function Gn(m,S,N,K){var pe=2*K+1;for(K=0;16>K;++K)fl(m,S+K*N,1,pe)&&ka(m,S+K*N,1)}function Rr(m,S,N,K){var pe;for(pe=3;0<pe;--pe)Nr(m,S+=4*N,N,K)}function Ta(m,S,N,K){var pe;for(pe=3;0<pe;--pe)Gn(m,S+=4,N,K)}function Go(m,S,N,K,pe,be,Le,ke){for(be=2*be+1;0<pe--;){if(Si(m,S,N,be,Le))if(Ka(m,S,N,ke))ka(m,S,N);else{var Be=m,Ge=S,ft=N,Dt=Be[Ge-2*ft],Ot=Be[Ge-ft],Lt=Be[Ge+0],Vt=Be[Ge+ft],jt=Be[Ge+2*ft],dt=27*(Jt=Io[1020+3*(Lt-Ot)+Io[1020+Dt-Vt]])+63>>7,yt=18*Jt+63>>7,Jt=9*Jt+63>>7;Be[Ge-3*ft]=or[255+Be[Ge-3*ft]+Jt],Be[Ge-2*ft]=or[255+Dt+yt],Be[Ge-ft]=or[255+Ot+dt],Be[Ge+0]=or[255+Lt-dt],Be[Ge+ft]=or[255+Vt-yt],Be[Ge+2*ft]=or[255+jt-Jt]}S+=K}}function yr(m,S,N,K,pe,be,Le,ke){for(be=2*be+1;0<pe--;){if(Si(m,S,N,be,Le))if(Ka(m,S,N,ke))ka(m,S,N);else{var Be=m,Ge=S,ft=N,Dt=Be[Ge-ft],Ot=Be[Ge+0],Lt=Be[Ge+ft],Vt=Wr[112+((jt=3*(Ot-Dt))+4>>3)],jt=Wr[112+(jt+3>>3)],dt=Vt+1>>1;Be[Ge-2*ft]=or[255+Be[Ge-2*ft]+dt],Be[Ge-ft]=or[255+Dt+jt],Be[Ge+0]=or[255+Ot-Vt],Be[Ge+ft]=or[255+Lt-dt]}S+=K}}function dl(m,S,N,K,pe,be){Go(m,S,N,1,16,K,pe,be)}function Mo(m,S,N,K,pe,be){Go(m,S,1,N,16,K,pe,be)}function Ja(m,S,N,K,pe,be){var Le;for(Le=3;0<Le;--Le)yr(m,S+=4*N,N,1,16,K,pe,be)}function Ya(m,S,N,K,pe,be){var Le;for(Le=3;0<Le;--Le)yr(m,S+=4,1,N,16,K,pe,be)}function ao(m,S,N,K,pe,be,Le,ke){Go(m,S,pe,1,8,be,Le,ke),Go(N,K,pe,1,8,be,Le,ke)}function Xa(m,S,N,K,pe,be,Le,ke){Go(m,S,1,pe,8,be,Le,ke),Go(N,K,1,pe,8,be,Le,ke)}function Zi(m,S,N,K,pe,be,Le,ke){yr(m,S+4*pe,pe,1,8,be,Le,ke),yr(N,K+4*pe,pe,1,8,be,Le,ke)}function su(m,S,N,K,pe,be,Le,ke){yr(m,S+4,1,pe,8,be,Le,ke),yr(N,K+4,1,pe,8,be,Le,ke)}function ss(){this.ba=new Mn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ii,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function mo(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Qa(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function vo(){this.ua=0,this.Wa=new le,this.vb=new le,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new V,this.yc=new R}function Ba(){this.xb=this.a=0,this.l=new ii,this.ca=new Mn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new X,this.Pb=0,this.wd=new X,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new vo,this.ab=0,this.gc=l(4,Qa),this.Oc=0}function Na(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new ii,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Ki(m,S,N,K,pe,be,Le){for(m=m==null?0:m[S+0],S=0;S<Le;++S)pe[be+S]=m+N[K+S]&255,m=pe[be+S]}function Qs(m,S,N,K,pe,be,Le){var ke;if(m==null)Ki(null,null,N,K,pe,be,Le);else for(ke=0;ke<Le;++ke)pe[be+ke]=m[S+ke]+N[K+ke]&255}function Ho(m,S,N,K,pe,be,Le){if(m==null)Ki(null,null,N,K,pe,be,Le);else{var ke,Be=m[S+0],Ge=Be,ft=Be;for(ke=0;ke<Le;++ke)Ge=ft+(Be=m[S+ke])-Ge,ft=N[K+ke]+(-256&Ge?0>Ge?0:255:Ge)&255,Ge=Be,pe[be+ke]=ft}}function Dr(m,S,N,K){var pe=S.width,be=S.o;if(n(m!=null&&S!=null),0>N||0>=K||N+K>be)return null;if(!m.Cc){if(m.ga==null){var Le;if(m.ga=new Na,(Le=m.ga==null)||(Le=S.width*S.o,n(m.Gb.length==0),m.Gb=o(Le),m.Uc=0,m.Gb==null?Le=0:(m.mb=m.Gb,m.nb=m.Uc,m.rc=null,Le=1),Le=!Le),!Le){Le=m.ga;var ke=m.Fa,Be=m.P,Ge=m.qc,ft=m.mb,Dt=m.nb,Ot=Be+1,Lt=Ge-1,Vt=Le.l;if(n(ke!=null&&ft!=null&&S!=null),Gi[0]=null,Gi[1]=Ki,Gi[2]=Qs,Gi[3]=Ho,Le.ca=ft,Le.tb=Dt,Le.c=S.width,Le.i=S.height,n(0<Le.c&&0<Le.i),1>=Ge)S=0;else if(Le.$a=ke[Be+0]>>0&3,Le.Z=ke[Be+0]>>2&3,Le.Lc=ke[Be+0]>>4&3,Be=ke[Be+0]>>6&3,0>Le.$a||1<Le.$a||4<=Le.Z||1<Le.Lc||Be)S=0;else if(Vt.put=Xr,Vt.ac=zi,Vt.bc=$r,Vt.ma=Le,Vt.width=S.width,Vt.height=S.height,Vt.Da=S.Da,Vt.v=S.v,Vt.va=S.va,Vt.j=S.j,Vt.o=S.o,Le.$a)e:{n(Le.$a==1),S=fs();t:for(;;){if(S==null){S=0;break e}if(n(Le!=null),Le.mc=S,S.c=Le.c,S.i=Le.i,S.l=Le.l,S.l.ma=Le,S.l.width=Le.c,S.l.height=Le.i,S.a=0,re(S.m,ke,Ot,Lt),!Qr(Le.c,Le.i,1,S,null)||(S.ab==1&&S.gc[0].hc==3&&tr(S.s)?(Le.ic=1,ke=S.c*S.i,S.Ta=null,S.Ua=0,S.V=o(ke),S.Ba=0,S.V==null?(S.a=1,S=0):S=1):(Le.ic=0,S=Ci(S,Le.c)),!S))break t;S=1;break e}Le.mc=null,S=0}else S=Lt>=Le.c*Le.i;Le=!S}if(Le)return null;m.ga.Lc!=1?m.Ga=0:K=be-N}n(m.ga!=null),n(N+K<=be);e:{if(S=(ke=m.ga).c,be=ke.l.o,ke.$a==0){if(Ot=m.rc,Lt=m.Vc,Vt=m.Fa,Be=m.P+1+N*S,Ge=m.mb,ft=m.nb+N*S,n(Be<=m.P+m.qc),ke.Z!=0)for(n(Gi[ke.Z]!=null),Le=0;Le<K;++Le)Gi[ke.Z](Ot,Lt,Vt,Be,Ge,ft,S),Ot=Ge,Lt=ft,ft+=S,Be+=S;else for(Le=0;Le<K;++Le)i(Ge,ft,Vt,Be,S),Ot=Ge,Lt=ft,ft+=S,Be+=S;m.rc=Ot,m.Vc=Lt}else{if(n(ke.mc!=null),S=N+K,n((Le=ke.mc)!=null),n(S<=Le.i),Le.C>=S)S=1;else if(ke.ic||St(),ke.ic){ke=Le.V,Ot=Le.Ba,Lt=Le.c;var jt=Le.i,dt=(Vt=1,Be=Le.$/Lt,Ge=Le.$%Lt,ft=Le.m,Dt=Le.s,Le.$),yt=Lt*jt,Jt=Lt*S,an=Dt.wc,Yt=dt<Jt?yn(Dt,Ge,Be):null;n(dt<=yt),n(S<=jt),n(tr(Dt));t:for(;;){for(;!ft.h&&dt<Jt;){if(Ge&an||(Yt=yn(Dt,Ge,Be)),n(Yt!=null),he(ft),256>(jt=bi(Yt.G[0],Yt.H[0],ft)))ke[Ot+dt]=jt,++dt,++Ge>=Lt&&(Ge=0,++Be<=S&&!(Be%16)&&Vr(Le,Be));else{if(!(280>jt)){Vt=0;break t}jt=pi(jt-256,ft);var Sn,Ln=bi(Yt.G[4],Yt.H[4],ft);if(he(ft),!(dt>=(Ln=hr(Lt,Ln=pi(Ln,ft)))&&yt-dt>=jt)){Vt=0;break t}for(Sn=0;Sn<jt;++Sn)ke[Ot+dt+Sn]=ke[Ot+dt+Sn-Ln];for(dt+=jt,Ge+=jt;Ge>=Lt;)Ge-=Lt,++Be<=S&&!(Be%16)&&Vr(Le,Be);dt<Jt&&Ge&an&&(Yt=yn(Dt,Ge,Be))}n(ft.h==B(ft))}Vr(Le,Be>S?S:Be);break t}!Vt||ft.h&&dt<yt?(Vt=0,Le.a=ft.h?5:3):Le.$=dt,S=Vt}else S=Qn(Le,Le.V,Le.Ba,Le.c,Le.i,S,An);if(!S){K=0;break e}}N+K>=be&&(m.Cc=1),K=1}if(!K)return null;if(m.Cc&&((K=m.ga)!=null&&(K.mc=null),m.ga=null,0<m.Ga))return alert("todo:WebPDequantizeLevels"),null}return m.nb+N*pe}function A(m,S,N,K,pe,be){for(;0<pe--;){var Le,ke=m,Be=S+(N?1:0),Ge=m,ft=S+(N?0:3);for(Le=0;Le<K;++Le){var Dt=Ge[ft+4*Le];Dt!=255&&(Dt*=32897,ke[Be+4*Le+0]=ke[Be+4*Le+0]*Dt>>23,ke[Be+4*Le+1]=ke[Be+4*Le+1]*Dt>>23,ke[Be+4*Le+2]=ke[Be+4*Le+2]*Dt>>23)}S+=be}}function de(m,S,N,K,pe){for(;0<K--;){var be;for(be=0;be<N;++be){var Le=m[S+2*be+0],ke=15&(Ge=m[S+2*be+1]),Be=4369*ke,Ge=(240&Ge|Ge>>4)*Be>>16;m[S+2*be+0]=(240&Le|Le>>4)*Be>>16&240|(15&Le|Le<<4)*Be>>16>>4&15,m[S+2*be+1]=240&Ge|ke}S+=pe}}function He(m,S,N,K,pe,be,Le,ke){var Be,Ge,ft=255;for(Ge=0;Ge<pe;++Ge){for(Be=0;Be<K;++Be){var Dt=m[S+Be];be[Le+4*Be]=Dt,ft&=Dt}S+=N,Le+=ke}return ft!=255}function ct(m,S,N,K,pe){var be;for(be=0;be<pe;++be)N[K+be]=m[S+be]>>8}function St(){as=A,Xi=de,nr=He,Ir=ct}function Ft(m,S,N){O[m]=function(K,pe,be,Le,ke,Be,Ge,ft,Dt,Ot,Lt,Vt,jt,dt,yt,Jt,an){var Yt,Sn=an-1>>1,Ln=ke[Be+0]|Ge[ft+0]<<16,$n=Dt[Ot+0]|Lt[Vt+0]<<16;n(K!=null);var a=3*Ln+$n+131074>>2;for(S(K[pe+0],255&a,a>>16,jt,dt),be!=null&&(a=3*$n+Ln+131074>>2,S(be[Le+0],255&a,a>>16,yt,Jt)),Yt=1;Yt<=Sn;++Yt){var c=ke[Be+Yt]|Ge[ft+Yt]<<16,p=Dt[Ot+Yt]|Lt[Vt+Yt]<<16,y=Ln+c+$n+p+524296,C=y+2*(c+$n)>>3;a=C+Ln>>1,Ln=(y=y+2*(Ln+p)>>3)+c>>1,S(K[pe+2*Yt-1],255&a,a>>16,jt,dt+(2*Yt-1)*N),S(K[pe+2*Yt-0],255&Ln,Ln>>16,jt,dt+(2*Yt-0)*N),be!=null&&(a=y+$n>>1,Ln=C+p>>1,S(be[Le+2*Yt-1],255&a,a>>16,yt,Jt+(2*Yt-1)*N),S(be[Le+2*Yt+0],255&Ln,Ln>>16,yt,Jt+(2*Yt+0)*N)),Ln=c,$n=p}1&an||(a=3*Ln+$n+131074>>2,S(K[pe+an-1],255&a,a>>16,jt,dt+(an-1)*N),be!=null&&(a=3*$n+Ln+131074>>2,S(be[Le+an-1],255&a,a>>16,yt,Jt+(an-1)*N)))}}function sn(){xs[Us]=Te,xs[Yn]=Ol,xs[Yo]=qs,xs[Xo]=hs,xs[_o]=_i,xs[Ns]=ec,xs[ku]=hh,xs[ls]=Ol,xs[us]=hs,xs[bo]=_i,xs[s]=ec}function Pn(m){return m&-16384?0>m?0:255:m>>Qh}function kn(m,S){return Pn((19077*m>>8)+(26149*S>>8)-14234)}function Vn(m,S,N){return Pn((19077*m>>8)-(6419*S>>8)-(13320*N>>8)+8708)}function ei(m,S){return Pn((19077*m>>8)+(33050*S>>8)-17685)}function vi(m,S,N,K,pe){K[pe+0]=kn(m,N),K[pe+1]=Vn(m,S,N),K[pe+2]=ei(m,S)}function gr(m,S,N,K,pe){K[pe+0]=ei(m,S),K[pe+1]=Vn(m,S,N),K[pe+2]=kn(m,N)}function $i(m,S,N,K,pe){var be=Vn(m,S,N);S=be<<3&224|ei(m,S)>>3,K[pe+0]=248&kn(m,N)|be>>5,K[pe+1]=S}function Ji(m,S,N,K,pe){var be=240&ei(m,S)|15;K[pe+0]=240&kn(m,N)|Vn(m,S,N)>>4,K[pe+1]=be}function Or(m,S,N,K,pe){K[pe+0]=255,vi(m,S,N,K,pe+1)}function Gr(m,S,N,K,pe){gr(m,S,N,K,pe),K[pe+3]=255}function eo(m,S,N,K,pe){vi(m,S,N,K,pe),K[pe+3]=255}function yi(m,S){return 0>m?0:m>S?S:m}function gs(m,S,N){O[m]=function(K,pe,be,Le,ke,Be,Ge,ft,Dt){for(var Ot=ft+(-2&Dt)*N;ft!=Ot;)S(K[pe+0],be[Le+0],ke[Be+0],Ge,ft),S(K[pe+1],be[Le+0],ke[Be+0],Ge,ft+N),pe+=2,++Le,++Be,ft+=2*N;1&Dt&&S(K[pe+0],be[Le+0],ke[Be+0],Ge,ft)}}function Ra(m,S,N){return N==0?m==0?S==0?6:5:S==0?4:0:N}function Ms(m,S,N,K,pe){switch(m>>>30){case 3:qt(S,N,K,pe,0);break;case 2:Bt(S,N,K,pe);break;case 1:In(S,N,K,pe)}}function pl(m,S){var N,K,pe=S.M,be=S.Nb,Le=m.oc,ke=m.pc+40,Be=m.oc,Ge=m.pc+584,ft=m.oc,Dt=m.pc+600;for(N=0;16>N;++N)Le[ke+32*N-1]=129;for(N=0;8>N;++N)Be[Ge+32*N-1]=129,ft[Dt+32*N-1]=129;for(0<pe?Le[ke-1-32]=Be[Ge-1-32]=ft[Dt-1-32]=129:(r(Le,ke-32-1,127,21),r(Be,Ge-32-1,127,9),r(ft,Dt-32-1,127,9)),K=0;K<m.za;++K){var Ot=S.ya[S.aa+K];if(0<K){for(N=-1;16>N;++N)i(Le,ke+32*N-4,Le,ke+32*N+12,4);for(N=-1;8>N;++N)i(Be,Ge+32*N-4,Be,Ge+32*N+4,4),i(ft,Dt+32*N-4,ft,Dt+32*N+4,4)}var Lt=m.Gd,Vt=m.Hd+K,jt=Ot.ad,dt=Ot.Hc;if(0<pe&&(i(Le,ke-32,Lt[Vt].y,0,16),i(Be,Ge-32,Lt[Vt].f,0,8),i(ft,Dt-32,Lt[Vt].ea,0,8)),Ot.Za){var yt=Le,Jt=ke-32+16;for(0<pe&&(K>=m.za-1?r(yt,Jt,Lt[Vt].y[15],4):i(yt,Jt,Lt[Vt+1].y,0,4)),N=0;4>N;N++)yt[Jt+128+N]=yt[Jt+256+N]=yt[Jt+384+N]=yt[Jt+0+N];for(N=0;16>N;++N,dt<<=2)yt=Le,Jt=ke+dh[N],wo[Ot.Ob[N]](yt,Jt),Ms(dt,jt,16*+N,yt,Jt)}else if(yt=Ra(K,pe,Ot.Ob[0]),Fo[yt](Le,ke),dt!=0)for(N=0;16>N;++N,dt<<=2)Ms(dt,jt,16*+N,Le,ke+dh[N]);for(N=Ot.Gc,yt=Ra(K,pe,Ot.Dd),uo[yt](Be,Ge),uo[yt](ft,Dt),dt=jt,yt=Be,Jt=Ge,255&(Ot=N>>0)&&(170&Ot?Cn(dt,256,yt,Jt):si(dt,256,yt,Jt)),Ot=ft,dt=Dt,255&(N>>=8)&&(170&N?Cn(jt,320,Ot,dt):si(jt,320,Ot,dt)),pe<m.Ub-1&&(i(Lt[Vt].y,0,Le,ke+480,16),i(Lt[Vt].f,0,Be,Ge+224,8),i(Lt[Vt].ea,0,ft,Dt+224,8)),N=8*be*m.B,Lt=m.sa,Vt=m.ta+16*K+16*be*m.R,jt=m.qa,Ot=m.ra+8*K+N,dt=m.Ha,yt=m.Ia+8*K+N,N=0;16>N;++N)i(Lt,Vt+N*m.R,Le,ke+32*N,16);for(N=0;8>N;++N)i(jt,Ot+N*m.B,Be,Ge+32*N,8),i(dt,yt+N*m.B,ft,Dt+32*N,8)}}function ko(m,S,N,K,pe,be,Le,ke,Be){var Ge=[0],ft=[0],Dt=0,Ot=Be!=null?Be.kd:0,Lt=Be??new mo;if(m==null||12>N)return 7;Lt.data=m,Lt.w=S,Lt.ha=N,S=[S],N=[N],Lt.gb=[Lt.gb];e:{var Vt=S,jt=N,dt=Lt.gb;if(n(m!=null),n(jt!=null),n(dt!=null),dt[0]=0,12<=jt[0]&&!t(m,Vt[0],"RIFF")){if(t(m,Vt[0]+8,"WEBP")){dt=3;break e}var yt=ae(m,Vt[0]+4);if(12>yt||4294967286<yt){dt=3;break e}if(Ot&&yt>jt[0]-8){dt=7;break e}dt[0]=yt,Vt[0]+=12,jt[0]-=12}dt=0}if(dt!=0)return dt;for(yt=0<Lt.gb[0],N=N[0];;){e:{var Jt=m;jt=S,dt=N;var an=Ge,Yt=ft,Sn=Vt=[0];if((a=Dt=[Dt])[0]=0,8>dt[0])dt=7;else{if(!t(Jt,jt[0],"VP8X")){if(ae(Jt,jt[0]+4)!=10){dt=3;break e}if(18>dt[0]){dt=7;break e}var Ln=ae(Jt,jt[0]+8),$n=1+ne(Jt,jt[0]+12);if(2147483648<=$n*(Jt=1+ne(Jt,jt[0]+15))){dt=3;break e}Sn!=null&&(Sn[0]=Ln),an!=null&&(an[0]=$n),Yt!=null&&(Yt[0]=Jt),jt[0]+=18,dt[0]-=18,a[0]=1}dt=0}}if(Dt=Dt[0],Vt=Vt[0],dt!=0)return dt;if(jt=!!(2&Vt),!yt&&Dt)return 3;if(be!=null&&(be[0]=!!(16&Vt)),Le!=null&&(Le[0]=jt),ke!=null&&(ke[0]=0),Le=Ge[0],Vt=ft[0],Dt&&jt&&Be==null){dt=0;break}if(4>N){dt=7;break}if(yt&&Dt||!yt&&!Dt&&!t(m,S[0],"ALPH")){N=[N],Lt.na=[Lt.na],Lt.P=[Lt.P],Lt.Sa=[Lt.Sa];e:{Ln=m,dt=S,yt=N;var a=Lt.gb;an=Lt.na,Yt=Lt.P,Sn=Lt.Sa,$n=22,n(Ln!=null),n(yt!=null),Jt=dt[0];var c=yt[0];for(n(an!=null),n(Sn!=null),an[0]=null,Yt[0]=null,Sn[0]=0;;){if(dt[0]=Jt,yt[0]=c,8>c){dt=7;break e}var p=ae(Ln,Jt+4);if(4294967286<p){dt=3;break e}var y=8+p+1&-2;if($n+=y,0<a&&$n>a){dt=3;break e}if(!t(Ln,Jt,"VP8 ")||!t(Ln,Jt,"VP8L")){dt=0;break e}if(c[0]<y){dt=7;break e}t(Ln,Jt,"ALPH")||(an[0]=Ln,Yt[0]=Jt+8,Sn[0]=p),Jt+=y,c-=y}}if(N=N[0],Lt.na=Lt.na[0],Lt.P=Lt.P[0],Lt.Sa=Lt.Sa[0],dt!=0)break}N=[N],Lt.Ja=[Lt.Ja],Lt.xa=[Lt.xa];e:if(a=m,dt=S,yt=N,an=Lt.gb[0],Yt=Lt.Ja,Sn=Lt.xa,Ln=dt[0],Jt=!t(a,Ln,"VP8 "),$n=!t(a,Ln,"VP8L"),n(a!=null),n(yt!=null),n(Yt!=null),n(Sn!=null),8>yt[0])dt=7;else{if(Jt||$n){if(a=ae(a,Ln+4),12<=an&&a>an-12){dt=3;break e}if(Ot&&a>yt[0]-8){dt=7;break e}Yt[0]=a,dt[0]+=8,yt[0]-=8,Sn[0]=$n}else Sn[0]=5<=yt[0]&&a[Ln+0]==47&&!(a[Ln+4]>>5),Yt[0]=yt[0];dt=0}if(N=N[0],Lt.Ja=Lt.Ja[0],Lt.xa=Lt.xa[0],S=S[0],dt!=0)break;if(4294967286<Lt.Ja)return 3;if(ke==null||jt||(ke[0]=Lt.xa?2:1),Le=[Le],Vt=[Vt],Lt.xa){if(5>N){dt=7;break}ke=Le,Ot=Vt,jt=be,m==null||5>N?m=0:5<=N&&m[S+0]==47&&!(m[S+4]>>5)?(yt=[0],a=[0],an=[0],re(Yt=new X,m,S,N),Nn(Yt,yt,a,an)?(ke!=null&&(ke[0]=yt[0]),Ot!=null&&(Ot[0]=a[0]),jt!=null&&(jt[0]=an[0]),m=1):m=0):m=0}else{if(10>N){dt=7;break}ke=Vt,m==null||10>N||!rs(m,S+3,N-3)?m=0:(Ot=m[S+0]|m[S+1]<<8|m[S+2]<<16,jt=16383&(m[S+7]<<8|m[S+6]),m=16383&(m[S+9]<<8|m[S+8]),1&Ot||3<(Ot>>1&7)||!(Ot>>4&1)||Ot>>5>=Lt.Ja||!jt||!m?m=0:(Le&&(Le[0]=jt),ke&&(ke[0]=m),m=1))}if(!m||(Le=Le[0],Vt=Vt[0],Dt&&(Ge[0]!=Le||ft[0]!=Vt)))return 3;Be!=null&&(Be[0]=Lt,Be.offset=S-Be.w,n(4294967286>S-Be.w),n(Be.offset==Be.ha-N));break}return dt==0||dt==7&&Dt&&Be==null?(be!=null&&(be[0]|=Lt.na!=null&&0<Lt.na.length),K!=null&&(K[0]=Le),pe!=null&&(pe[0]=Vt),0):dt}function Rl(m,S,N){var K=S.width,pe=S.height,be=0,Le=0,ke=K,Be=pe;if(S.Da=m!=null&&0<m.Da,S.Da&&(ke=m.cd,Be=m.bd,be=m.v,Le=m.j,11>N||(be&=-2,Le&=-2),0>be||0>Le||0>=ke||0>=Be||be+ke>K||Le+Be>pe))return 0;if(S.v=be,S.j=Le,S.va=be+ke,S.o=Le+Be,S.U=ke,S.T=Be,S.da=m!=null&&0<m.da,S.da){if(!je(ke,Be,N=[m.ib],be=[m.hb]))return 0;S.ib=N[0],S.hb=be[0]}return S.ob=m!=null&&m.ob,S.Kb=m==null||!m.Sd,S.da&&(S.ob=S.ib<3*K/4&&S.hb<3*pe/4,S.Kb=0),1}function da(m){if(m==null)return 2;if(11>m.S){var S=m.f.RGBA;S.fb+=(m.height-1)*S.A,S.A=-S.A}else S=m.f.kb,m=m.height,S.O+=(m-1)*S.fa,S.fa=-S.fa,S.N+=(m-1>>1)*S.Ab,S.Ab=-S.Ab,S.W+=(m-1>>1)*S.Db,S.Db=-S.Db,S.F!=null&&(S.J+=(m-1)*S.lb,S.lb=-S.lb);return 0}function pa(m,S,N,K){if(K==null||0>=m||0>=S)return 2;if(N!=null){if(N.Da){var pe=N.cd,be=N.bd,Le=-2&N.v,ke=-2&N.j;if(0>Le||0>ke||0>=pe||0>=be||Le+pe>m||ke+be>S)return 2;m=pe,S=be}if(N.da){if(!je(m,S,pe=[N.ib],be=[N.hb]))return 2;m=pe[0],S=be[0]}}K.width=m,K.height=S;e:{var Be=K.width,Ge=K.height;if(m=K.S,0>=Be||0>=Ge||!(m>=Us&&13>m))m=2;else{if(0>=K.Rd&&K.sd==null){Le=be=pe=S=0;var ft=(ke=Be*mh[m])*Ge;if(11>m||(be=(Ge+1)/2*(S=(Be+1)/2),m==12&&(Le=(pe=Be)*Ge)),(Ge=o(ft+2*be+Le))==null){m=1;break e}K.sd=Ge,11>m?((Be=K.f.RGBA).eb=Ge,Be.fb=0,Be.A=ke,Be.size=ft):((Be=K.f.kb).y=Ge,Be.O=0,Be.fa=ke,Be.Fd=ft,Be.f=Ge,Be.N=0+ft,Be.Ab=S,Be.Cd=be,Be.ea=Ge,Be.W=0+ft+be,Be.Db=S,Be.Ed=be,m==12&&(Be.F=Ge,Be.J=0+ft+2*be),Be.Tc=Le,Be.lb=pe)}if(S=1,pe=K.S,be=K.width,Le=K.height,pe>=Us&&13>pe)if(11>pe)m=K.f.RGBA,S&=(ke=Math.abs(m.A))*(Le-1)+be<=m.size,S&=ke>=be*mh[pe],S&=m.eb!=null;else{m=K.f.kb,ke=(be+1)/2,ft=(Le+1)/2,Be=Math.abs(m.fa),Ge=Math.abs(m.Ab);var Dt=Math.abs(m.Db),Ot=Math.abs(m.lb),Lt=Ot*(Le-1)+be;S&=Be*(Le-1)+be<=m.Fd,S&=Ge*(ft-1)+ke<=m.Cd,S=(S&=Dt*(ft-1)+ke<=m.Ed)&Be>=be&Ge>=ke&Dt>=ke,S&=m.y!=null,S&=m.f!=null,S&=m.ea!=null,pe==12&&(S&=Ot>=be,S&=Lt<=m.Tc,S&=m.F!=null)}else S=0;m=S?0:2}}return m!=0||N!=null&&N.fd&&(m=da(K)),m}var Hr=64,To=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],to=24,zs=32,Da=8,ms=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];qe("Predictor0","PredictorAdd0"),O.Predictor0=function(){return 4278190080},O.Predictor1=function(m){return m},O.Predictor2=function(m,S,N){return S[N+0]},O.Predictor3=function(m,S,N){return S[N+1]},O.Predictor4=function(m,S,N){return S[N-1]},O.Predictor5=function(m,S,N){return et(et(m,S[N+1]),S[N+0])},O.Predictor6=function(m,S,N){return et(m,S[N-1])},O.Predictor7=function(m,S,N){return et(m,S[N+0])},O.Predictor8=function(m,S,N){return et(S[N-1],S[N+0])},O.Predictor9=function(m,S,N){return et(S[N+0],S[N+1])},O.Predictor10=function(m,S,N){return et(et(m,S[N-1]),et(S[N+0],S[N+1]))},O.Predictor11=function(m,S,N){var K=S[N+0];return 0>=_t(K>>24&255,m>>24&255,(S=S[N-1])>>24&255)+_t(K>>16&255,m>>16&255,S>>16&255)+_t(K>>8&255,m>>8&255,S>>8&255)+_t(255&K,255&m,255&S)?K:m},O.Predictor12=function(m,S,N){var K=S[N+0];return(Je((m>>24&255)+(K>>24&255)-((S=S[N-1])>>24&255))<<24|Je((m>>16&255)+(K>>16&255)-(S>>16&255))<<16|Je((m>>8&255)+(K>>8&255)-(S>>8&255))<<8|Je((255&m)+(255&K)-(255&S)))>>>0},O.Predictor13=function(m,S,N){var K=S[N-1];return(mt((m=et(m,S[N+0]))>>24&255,K>>24&255)<<24|mt(m>>16&255,K>>16&255)<<16|mt(m>>8&255,K>>8&255)<<8|mt(m>>0&255,K>>0&255))>>>0};var ks=O.PredictorAdd0;O.PredictorAdd1=$t,qe("Predictor2","PredictorAdd2"),qe("Predictor3","PredictorAdd3"),qe("Predictor4","PredictorAdd4"),qe("Predictor5","PredictorAdd5"),qe("Predictor6","PredictorAdd6"),qe("Predictor7","PredictorAdd7"),qe("Predictor8","PredictorAdd8"),qe("Predictor9","PredictorAdd9"),qe("Predictor10","PredictorAdd10"),qe("Predictor11","PredictorAdd11"),qe("Predictor12","PredictorAdd12"),qe("Predictor13","PredictorAdd13");var Ts=O.PredictorAdd2;Qt("ColorIndexInverseTransform","MapARGB","32b",function(m){return m>>8&255},function(m){return m}),Qt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(m){return m},function(m){return m>>8&255});var ou,ns=O.ColorIndexInverseTransform,Wo=O.MapARGB,vs=O.VP8LColorIndexInverseTransformAlpha,ys=O.MapAlpha,Zo=O.VP8LPredictorsAdd=[];Zo.length=16,(O.VP8LPredictors=[]).length=16,(O.VP8LPredictorsAdd_C=[]).length=16,(O.VP8LPredictors_C=[]).length=16;var Ko,_s,os,Bo,no,bs,bt,qt,Bt,Cn,In,si,_r,Yi,el,Bs,br,No,Jo,Ro,Do,Oo,Pi,yo,as,Xi,nr,Ir,lr=o(511),io=o(2041),js=o(225),lo=o(767),Dl=0,Io=io,Wr=js,or=lo,ws=lr,Us=0,Yn=1,Yo=2,Xo=3,_o=4,Ns=5,ku=6,ls=7,us=8,bo=9,s=10,f=[2,3,7],w=[3,3,11],T=[280,256,256,256,40],Z=[0,1,1,1,0],_e=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],at=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Tt=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],zt=8,tn=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],En=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Un=null,gi=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Zr=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Ar=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],cs=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],wr=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],$s=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Tu=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Fo=[],wo=[],uo=[],Mc=1,gl=2,Gi=[],xs=[];Ft("UpsampleRgbLinePair",vi,3),Ft("UpsampleBgrLinePair",gr,3),Ft("UpsampleRgbaLinePair",eo,4),Ft("UpsampleBgraLinePair",Gr,4),Ft("UpsampleArgbLinePair",Or,4),Ft("UpsampleRgba4444LinePair",Ji,2),Ft("UpsampleRgb565LinePair",$i,2);var Te=O.UpsampleRgbLinePair,qs=O.UpsampleBgrLinePair,Ol=O.UpsampleRgbaLinePair,hs=O.UpsampleBgraLinePair,_i=O.UpsampleArgbLinePair,ec=O.UpsampleRgba4444LinePair,hh=O.UpsampleRgb565LinePair,tc=16,ga=1<<tc-1,Bu=-227,kc=482,Qh=6,au=0,nc=o(256),tl=o(256),ef=o(256),ic=o(256),rc=o(kc-Bu),fh=o(kc-Bu);gs("YuvToRgbRow",vi,3),gs("YuvToBgrRow",gr,3),gs("YuvToRgbaRow",eo,4),gs("YuvToBgraRow",Gr,4),gs("YuvToArgbRow",Or,4),gs("YuvToRgba4444Row",Ji,2),gs("YuvToRgb565Row",$i,2);var dh=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Qo=[0,2,8],ph=[8,7,6,4,4,2,2,2,1,1,1,1],gh=1;this.WebPDecodeRGBA=function(m,S,N,K,pe){var be=Yn,Le=new ss,ke=new Mn;Le.ba=ke,ke.S=be,ke.width=[ke.width],ke.height=[ke.height];var Be=ke.width,Ge=ke.height,ft=new Sr;if(ft==null||m==null)var Dt=2;else n(ft!=null),Dt=ko(m,S,N,ft.width,ft.height,ft.Pd,ft.Qd,ft.format,null);if(Dt!=0?Be=0:(Be!=null&&(Be[0]=ft.width[0]),Ge!=null&&(Ge[0]=ft.height[0]),Be=1),Be){ke.width=ke.width[0],ke.height=ke.height[0],K!=null&&(K[0]=ke.width),pe!=null&&(pe[0]=ke.height);e:{if(K=new ii,(pe=new mo).data=m,pe.w=S,pe.ha=N,pe.kd=1,S=[0],n(pe!=null),((m=ko(pe.data,pe.w,pe.ha,null,null,null,S,null,pe))==0||m==7)&&S[0]&&(m=4),(S=m)==0){if(n(Le!=null),K.data=pe.data,K.w=pe.w+pe.offset,K.ha=pe.ha-pe.offset,K.put=Xr,K.ac=zi,K.bc=$r,K.ma=Le,pe.xa){if((m=fs())==null){Le=1;break e}if(function(Ot,Lt){var Vt=[0],jt=[0],dt=[0];t:for(;;){if(Ot==null)return 0;if(Lt==null)return Ot.a=2,0;if(Ot.l=Lt,Ot.a=0,re(Ot.m,Lt.data,Lt.w,Lt.ha),!Nn(Ot.m,Vt,jt,dt)){Ot.a=3;break t}if(Ot.xb=gl,Lt.width=Vt[0],Lt.height=jt[0],!Qr(Vt[0],jt[0],1,Ot,null))break t;return 1}return n(Ot.a!=0),0}(m,K)){if(K=(S=pa(K.width,K.height,Le.Oa,Le.ba))==0){t:{K=m;n:for(;;){if(K==null){K=0;break t}if(n(K.s.yc!=null),n(K.s.Ya!=null),n(0<K.s.Wb),n((N=K.l)!=null),n((pe=N.ma)!=null),K.xb!=0){if(K.ca=pe.ba,K.tb=pe.tb,n(K.ca!=null),!Rl(pe.Oa,N,Xo)){K.a=2;break n}if(!Ci(K,N.width)||N.da)break n;if((N.da||vn(K.ca.S))&&St(),11>K.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),K.ca.f.kb.F!=null&&St()),K.Pb&&0<K.s.ua&&K.s.vb.X==null&&!xe(K.s.vb,K.s.Wa.Xa)){K.a=1;break n}K.xb=0}if(!Qn(K,K.V,K.Ba,K.c,K.i,N.o,kr))break n;pe.Dc=K.Ma,K=1;break t}n(K.a!=0),K=0}K=!K}K&&(S=m.a)}else S=m.a}else{if((m=new Xn)==null){Le=1;break e}if(m.Fa=pe.na,m.P=pe.P,m.qc=pe.Sa,Ps(m,K)){if((S=pa(K.width,K.height,Le.Oa,Le.ba))==0){if(m.Aa=0,N=Le.Oa,n((pe=m)!=null),N!=null){if(0<(Be=0>(Be=N.Md)?0:100<Be?255:255*Be/100)){for(Ge=ft=0;4>Ge;++Ge)12>(Dt=pe.pb[Ge]).lc&&(Dt.ia=Be*ph[0>Dt.lc?0:Dt.lc]>>3),ft|=Dt.ia;ft&&(alert("todo:VP8InitRandom"),pe.ia=1)}pe.Ga=N.Id,100<pe.Ga?pe.Ga=100:0>pe.Ga&&(pe.Ga=0)}ln(m,K)||(S=m.a)}}else S=m.a}S==0&&Le.Oa!=null&&Le.Oa.fd&&(S=da(Le.ba))}Le=S}be=Le!=0?null:11>be?ke.f.RGBA.eb:ke.f.kb.y}else be=null;return be};var mh=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function v(O,W){for(var ue="",z=0;z<4;z++)ue+=String.fromCharCode(O[W++]);return ue}function _(O,W){return(O[W+0]<<0|O[W+1]<<8|O[W+2]<<16)>>>0}function x(O,W){return(O[W+0]<<0|O[W+1]<<8|O[W+2]<<16|O[W+3]<<24)>>>0}new g;var E=[0],b=[0],D=[],$=new g,Q=e,F=function(O,W){var ue={},z=0,R=!1,J=0,V=0;if(ue.frames=[],!function(Ee,B,H,he){for(var te=0;te<he;te++)if(Ee[B+te]!=H.charCodeAt(te))return!0;return!1}(O,W,"RIFF",4)){var U,Y;for(x(O,W+=4),W+=8;W<O.length;){var ce=v(O,W),re=x(O,W+=4);W+=4;var Pe=re+(1&re);switch(ce){case"VP8 ":case"VP8L":ue.frames[z]===void 0&&(ue.frames[z]={}),(X=ue.frames[z]).src_off=R?V:W-8,X.src_size=J+re+8,z++,R&&(R=!1,J=0,V=0);break;case"VP8X":(X=ue.header={}).feature_flags=O[W];var Me=W+4;X.canvas_width=1+_(O,Me),Me+=3,X.canvas_height=1+_(O,Me),Me+=3;break;case"ALPH":R=!0,J=Pe+8,V=W-8;break;case"ANIM":(X=ue.header).bgcolor=x(O,W),Me=W+4,X.loop_count=(U=O)[(Y=Me)+0]<<0|U[Y+1]<<8,Me+=2;break;case"ANMF":var ot,X;(X=ue.frames[z]={}).offset_x=2*_(O,W),W+=3,X.offset_y=2*_(O,W),W+=3,X.width=1+_(O,W),W+=3,X.height=1+_(O,W),W+=3,X.duration=_(O,W),W+=3,ot=O[W++],X.dispose=1&ot,X.blend=ot>>1&1}ce!="ANMF"&&(W+=Pe)}return ue}}(Q,0);F.response=Q,F.rgbaoutput=!0,F.dataurl=!1;var G=F.header?F.header:null,me=F.frames?F.frames:null;if(G){G.loop_counter=G.loop_count,E=[G.canvas_height],b=[G.canvas_width];for(var Se=0;Se<me.length&&me[Se].blend!=0;Se++);}var Ie=me[0],nt=$.WebPDecodeRGBA(Q,Ie.src_off,Ie.src_size,b,E);Ie.rgba=nt,Ie.imgwidth=b[0],Ie.imgheight=E[0];for(var Ve=0;Ve<b[0]*E[0]*4;Ve++)D[Ve]=nt[Ve];return this.width=b,this.height=E,this.data=D,this}(function(e){var n=function(){return typeof $g=="function"},t=function(E,b,D,$){var Q=4,F=l;switch($){case e.image_compression.FAST:Q=1,F=o;break;case e.image_compression.MEDIUM:Q=6,F=h;break;case e.image_compression.SLOW:Q=9,F=g}E=i(E,b,D,F);var G=$g(E,{level:Q});return e.__addimage__.arrayBufferToBinaryString(G)},i=function(E,b,D,$){for(var Q,F,G,me=E.length/b,Se=new Uint8Array(E.length+me),Ie=_(),nt=0;nt<me;nt+=1){if(G=nt*b,Q=E.subarray(G,G+b),$)Se.set($(Q,D,F),G+nt);else{for(var Ve,O=Ie.length,W=[];Ve<O;Ve+=1)W[Ve]=Ie[Ve](Q,D,F);var ue=x(W.concat());Se.set(W[ue],G+nt)}F=Q}return Se},r=function(E){var b=Array.apply([],E);return b.unshift(0),b},o=function(E,b){var D,$=[],Q=E.length;$[0]=1;for(var F=0;F<Q;F+=1)D=E[F-b]||0,$[F+1]=E[F]-D+256&255;return $},l=function(E,b,D){var $,Q=[],F=E.length;Q[0]=2;for(var G=0;G<F;G+=1)$=D&&D[G]||0,Q[G+1]=E[G]-$+256&255;return Q},h=function(E,b,D){var $,Q,F=[],G=E.length;F[0]=3;for(var me=0;me<G;me+=1)$=E[me-b]||0,Q=D&&D[me]||0,F[me+1]=E[me]+256-($+Q>>>1)&255;return F},g=function(E,b,D){var $,Q,F,G,me=[],Se=E.length;me[0]=4;for(var Ie=0;Ie<Se;Ie+=1)$=E[Ie-b]||0,Q=D&&D[Ie]||0,F=D&&D[Ie-b]||0,G=v($,Q,F),me[Ie+1]=E[Ie]-G+256&255;return me},v=function(E,b,D){if(E===b&&b===D)return E;var $=Math.abs(b-D),Q=Math.abs(E-D),F=Math.abs(E+b-D-D);return $<=Q&&$<=F?E:Q<=F?b:D},_=function(){return[r,o,l,h,g]},x=function(E){var b=E.map(function(D){return D.reduce(function($,Q){return $+Math.abs(Q)},0)});return b.indexOf(Math.min.apply(null,b))};e.processPNG=function(E,b,D,$){var Q,F,G,me,Se,Ie,nt,Ve,O,W,ue,z,R,J,V,U=this.decode.FLATE_DECODE,Y="";if(this.__addimage__.isArrayBuffer(E)&&(E=new Uint8Array(E)),this.__addimage__.isArrayBufferView(E)){if(E=(G=new hN(E)).imgData,F=G.bits,Q=G.colorSpace,Se=G.colors,[4,6].indexOf(G.colorType)!==-1){if(G.bits===8){O=(Ve=G.pixelBitlength==32?new Uint32Array(G.decodePixels().buffer):G.pixelBitlength==16?new Uint16Array(G.decodePixels().buffer):new Uint8Array(G.decodePixels().buffer)).length,ue=new Uint8Array(O*G.colors),W=new Uint8Array(O);var ce,re=G.pixelBitlength-G.bits;for(J=0,V=0;J<O;J++){for(R=Ve[J],ce=0;ce<re;)ue[V++]=R>>>ce&255,ce+=G.bits;W[J]=R>>>ce&255}}if(G.bits===16){O=(Ve=new Uint32Array(G.decodePixels().buffer)).length,ue=new Uint8Array(O*(32/G.pixelBitlength)*G.colors),W=new Uint8Array(O*(32/G.pixelBitlength)),z=G.colors>1,J=0,V=0;for(var Pe=0;J<O;)R=Ve[J++],ue[V++]=R>>>0&255,z&&(ue[V++]=R>>>16&255,R=Ve[J++],ue[V++]=R>>>0&255),W[Pe++]=R>>>16&255;F=8}$!==e.image_compression.NONE&&n()?(E=t(ue,G.width*G.colors,G.colors,$),nt=t(W,G.width,1,$)):(E=ue,nt=W,U=void 0)}if(G.colorType===3&&(Q=this.color_spaces.INDEXED,Ie=G.palette,G.transparency.indexed)){var Me=G.transparency.indexed,ot=0;for(J=0,O=Me.length;J<O;++J)ot+=Me[J];if((ot/=255)===O-1&&Me.indexOf(0)!==-1)me=[Me.indexOf(0)];else if(ot!==O){for(Ve=G.decodePixels(),W=new Uint8Array(Ve.length),J=0,O=Ve.length;J<O;J++)W[J]=Me[Ve[J]];nt=t(W,G.width,1)}}var X=function(Ee){var B;switch(Ee){case e.image_compression.FAST:B=11;break;case e.image_compression.MEDIUM:B=13;break;case e.image_compression.SLOW:B=14;break;default:B=12}return B}($);return U===this.decode.FLATE_DECODE&&(Y="/Predictor "+X+" "),Y+="/Colors "+Se+" /BitsPerComponent "+F+" /Columns "+G.width,(this.__addimage__.isArrayBuffer(E)||this.__addimage__.isArrayBufferView(E))&&(E=this.__addimage__.arrayBufferToBinaryString(E)),(nt&&this.__addimage__.isArrayBuffer(nt)||this.__addimage__.isArrayBufferView(nt))&&(nt=this.__addimage__.arrayBufferToBinaryString(nt)),{alias:D,data:E,index:b,filter:U,decodeParameters:Y,transparency:me,palette:Ie,sMask:nt,predictor:X,width:G.width,height:G.height,bitsPerComponent:F,colorSpace:Q}}}})(hi.API),function(e){e.processGIF89A=function(n,t,i,r){var o=new fN(n),l=o.width,h=o.height,g=[];o.decodeAndBlitFrameRGBA(0,g);var v={data:g,width:l,height:h},_=new Q0(100).encode(v,100);return e.processJPEG.call(this,_,t,i,r)},e.processGIF87A=e.processGIF89A}(hi.API),Hl.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var n=0;n<e;n++){var t=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[n]={red:r,green:i,blue:t,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Hl.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,n=this.width*this.height*4;this.data=new Uint8Array(n),this[e]()}catch(t){zr.log("bit decode error:"+t)}},Hl.prototype.bit1=function(){var e,n=Math.ceil(this.width/8),t=n%4;for(e=this.height-1;e>=0;e--){for(var i=this.bottom_up?e:this.height-1-e,r=0;r<n;r++)for(var o=this.datav.getUint8(this.pos++,!0),l=i*this.width*4+8*r*4,h=0;h<8&&8*r+h<this.width;h++){var g=this.palette[o>>7-h&1];this.data[l+4*h]=g.blue,this.data[l+4*h+1]=g.green,this.data[l+4*h+2]=g.red,this.data[l+4*h+3]=255}t!==0&&(this.pos+=4-t)}},Hl.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),n=e%4,t=this.height-1;t>=0;t--){for(var i=this.bottom_up?t:this.height-1-t,r=0;r<e;r++){var o=this.datav.getUint8(this.pos++,!0),l=i*this.width*4+2*r*4,h=o>>4,g=15&o,v=this.palette[h];if(this.data[l]=v.blue,this.data[l+1]=v.green,this.data[l+2]=v.red,this.data[l+3]=255,2*r+1>=this.width)break;v=this.palette[g],this.data[l+4]=v.blue,this.data[l+4+1]=v.green,this.data[l+4+2]=v.red,this.data[l+4+3]=255}n!==0&&(this.pos+=4-n)}},Hl.prototype.bit8=function(){for(var e=this.width%4,n=this.height-1;n>=0;n--){for(var t=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var r=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*i;if(r<this.palette.length){var l=this.palette[r];this.data[o]=l.red,this.data[o+1]=l.green,this.data[o+2]=l.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}e!==0&&(this.pos+=4-e)}},Hl.prototype.bit15=function(){for(var e=this.width%3,n=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var i=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&n)/n*255|0,h=(o>>5&n)/n*255|0,g=(o>>10&n)/n*255|0,v=o>>15?255:0,_=i*this.width*4+4*r;this.data[_]=g,this.data[_+1]=h,this.data[_+2]=l,this.data[_+3]=v}this.pos+=e}},Hl.prototype.bit16=function(){for(var e=this.width%3,n=parseInt("11111",2),t=parseInt("111111",2),i=this.height-1;i>=0;i--){for(var r=this.bottom_up?i:this.height-1-i,o=0;o<this.width;o++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var h=(l&n)/n*255|0,g=(l>>5&t)/t*255|0,v=(l>>11)/n*255|0,_=r*this.width*4+4*o;this.data[_]=v,this.data[_+1]=g,this.data[_+2]=h,this.data[_+3]=255}this.pos+=e}},Hl.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,t=0;t<this.width;t++){var i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=n*this.width*4+4*t;this.data[l]=o,this.data[l+1]=r,this.data[l+2]=i,this.data[l+3]=255}this.pos+=this.width%4}},Hl.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var n=this.bottom_up?e:this.height-1-e,t=0;t<this.width;t++){var i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),h=n*this.width*4+4*t;this.data[h]=o,this.data[h+1]=r,this.data[h+2]=i,this.data[h+3]=l}},Hl.prototype.getData=function(){return this.data},function(e){e.processBMP=function(n,t,i,r){var o=new Hl(n,!1),l=o.width,h=o.height,g={data:o.getData(),width:l,height:h},v=new Q0(100).encode(g,100);return e.processJPEG.call(this,v,t,i,r)}}(hi.API),Hy.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(n,t,i,r){var o=new Hy(n),l=o.width,h=o.height,g={data:o.getData(),width:l,height:h},v=new Q0(100).encode(g,100);return e.processJPEG.call(this,v,t,i,r)}}(hi.API),hi.API.processRGBA=function(e,n,t){for(var i=e.data,r=i.length,o=new Uint8Array(r/4*3),l=new Uint8Array(r/4),h=0,g=0,v=0;v<r;v+=4){var _=i[v],x=i[v+1],E=i[v+2],b=i[v+3];o[h++]=_,o[h++]=x,o[h++]=E,l[g++]=b}var D=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(l),data:D,index:n,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},hi.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},kh=hi.API,Bd=kh.getCharWidthsArray=function(e,n){var t,i,r=(n=n||{}).font||this.internal.getFont(),o=n.fontSize||this.internal.getFontSize(),l=n.charSpace||this.internal.getCharSpace(),h=n.widths?n.widths:r.metadata.Unicode.widths,g=h.fof?h.fof:1,v=n.kerning?n.kerning:r.metadata.Unicode.kerning,_=v.fof?v.fof:1,x=n.doKerning!==!1,E=0,b=e.length,D=0,$=h[0]||g,Q=[];for(t=0;t<b;t++)i=e.charCodeAt(t),typeof r.metadata.widthOfString=="function"?Q.push((r.metadata.widthOfGlyph(r.metadata.characterToGlyph(i))+l*(1e3/o)||0)/1e3):(E=x&&Mr(v[i])==="object"&&!isNaN(parseInt(v[i][D],10))?v[i][D]/_:0,Q.push((h[i]||$)/g+E)),D=i;return Q},$y=kh.getStringUnitWidth=function(e,n){var t=(n=n||{}).fontSize||this.internal.getFontSize(),i=n.font||this.internal.getFont(),r=n.charSpace||this.internal.getCharSpace();return kh.processArabic&&(e=kh.processArabic(e)),typeof i.metadata.widthOfString=="function"?i.metadata.widthOfString(e,t,r)/t:Bd.apply(this,arguments).reduce(function(o,l){return o+l},0)},qy=function(e,n,t,i){for(var r=[],o=0,l=e.length,h=0;o!==l&&h+n[o]<t;)h+=n[o],o++;r.push(e.slice(0,o));var g=o;for(h=0;o!==l;)h+n[o]>i&&(r.push(e.slice(g,o)),h=0,g=o),h+=n[o],o++;return g!==o&&r.push(e.slice(g,o)),r},Vy=function(e,n,t){t||(t={});var i,r,o,l,h,g,v,_=[],x=[_],E=t.textIndent||0,b=0,D=0,$=e.split(" "),Q=Bd.apply(this,[" ",t])[0];if(g=t.lineIndent===-1?$[0].length+2:t.lineIndent||0){var F=Array(g).join(" "),G=[];$.map(function(Se){(Se=Se.split(/\s*\n/)).length>1?G=G.concat(Se.map(function(Ie,nt){return(nt&&Ie.length?`
`:"")+Ie})):G.push(Se[0])}),$=G,g=$y.apply(this,[F,t])}for(o=0,l=$.length;o<l;o++){var me=0;if(i=$[o],g&&i[0]==`
`&&(i=i.substr(1),me=1),E+b+(D=(r=Bd.apply(this,[i,t])).reduce(function(Se,Ie){return Se+Ie},0))>n||me){if(D>n){for(h=qy.apply(this,[i,r,n-(E+b),n]),_.push(h.shift()),_=[h.pop()];h.length;)x.push([h.shift()]);D=r.slice(i.length-(_[0]?_[0].length:0)).reduce(function(Se,Ie){return Se+Ie},0)}else _=[i];x.push(_),E=D+g,b=Q}else _.push(i),E+=b+D,b=Q}return v=g?function(Se,Ie){return(Ie?F:"")+Se.join(" ")}:function(Se){return Se.join(" ")},x.map(v)},kh.splitTextToSize=function(e,n,t){var i,r=(t=t||{}).fontSize||this.internal.getFontSize(),o=(function(_){if(_.widths&&_.kerning)return{widths:_.widths,kerning:_.kerning};var x=this.internal.getFont(_.fontName,_.fontStyle);return x.metadata.Unicode?{widths:x.metadata.Unicode.widths||{0:1},kerning:x.metadata.Unicode.kerning||{}}:{font:x.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);i=Array.isArray(e)?e:String(e).split(/\r?\n/);var l=1*this.internal.scaleFactor*n/r;o.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/r:0,o.lineIndent=t.lineIndent;var h,g,v=[];for(h=0,g=i.length;h<g;h++)v=v.concat(Vy.apply(this,[i[h],l,o]));return v},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var n="klmnopqrstuvwxyz",t={},i={},r=0;r<n.length;r++)t[n[r]]="0123456789abcdef"[r],i["0123456789abcdef"[r]]=n[r];var o=function(x){return"0x"+parseInt(x,10).toString(16)},l=e.__fontmetrics__.compress=function(x){var E,b,D,$,Q=["{"];for(var F in x){if(E=x[F],isNaN(parseInt(F,10))?b="'"+F+"'":(F=parseInt(F,10),b=(b=o(F).slice(2)).slice(0,-1)+i[b.slice(-1)]),typeof E=="number")E<0?(D=o(E).slice(3),$="-"):(D=o(E).slice(2),$=""),D=$+D.slice(0,-1)+i[D.slice(-1)];else{if(Mr(E)!=="object")throw new Error("Don't know what to do with value type "+Mr(E)+".");D=l(E)}Q.push(b+D)}return Q.push("}"),Q.join("")},h=e.__fontmetrics__.uncompress=function(x){if(typeof x!="string")throw new Error("Invalid argument passed to uncompress.");for(var E,b,D,$,Q={},F=1,G=Q,me=[],Se="",Ie="",nt=x.length-1,Ve=1;Ve<nt;Ve+=1)($=x[Ve])=="'"?E?(D=E.join(""),E=void 0):E=[]:E?E.push($):$=="{"?(me.push([G,D]),G={},D=void 0):$=="}"?((b=me.pop())[0][b[1]]=G,D=void 0,G=b[0]):$=="-"?F=-1:D===void 0?t.hasOwnProperty($)?(Se+=t[$],D=parseInt(Se,16)*F,F=1,Se=""):Se+=$:t.hasOwnProperty($)?(Ie+=t[$],G[D]=parseInt(Ie,16)*F,F=1,D=void 0,Ie=""):Ie+=$;return Q},g={codePages:["WinAnsiEncoding"],WinAnsiEncoding:h("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},v={Unicode:{Courier:g,"Courier-Bold":g,"Courier-BoldOblique":g,"Courier-Oblique":g,Helvetica:g,"Helvetica-Bold":g,"Helvetica-BoldOblique":g,"Helvetica-Oblique":g,"Times-Roman":g,"Times-Bold":g,"Times-BoldItalic":g,"Times-Italic":g}},_={Unicode:{"Courier-Oblique":h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":h("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":h("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":h("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:h("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:h("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":h("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:h("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":h("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":h("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":h("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(x){var E=x.font,b=_.Unicode[E.postScriptName];b&&(E.metadata.Unicode={},E.metadata.Unicode.widths=b.widths,E.metadata.Unicode.kerning=b.kerning);var D=v.Unicode[E.postScriptName];D&&(E.metadata.Unicode.encoding=D,E.encoding=D.codePages[0])}])}(hi.API),function(e){var n=function(t){for(var i=t.length,r=new Uint8Array(i),o=0;o<i;o++)r[o]=t.charCodeAt(o);return r};e.API.events.push(["addFont",function(t){var i=void 0,r=t.font,o=t.instance;if(!r.isStandardFont){if(o===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");if(typeof(i=o.existsFileInVFS(r.postScriptName)===!1?o.loadFile(r.postScriptName):o.getFileFromVFS(r.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");(function(l,h){h=/^\x00\x01\x00\x00/.test(h)?n(h):n(Of(h)),l.metadata=e.API.TTFFont.open(h),l.metadata.Unicode=l.metadata.Unicode||{encoding:{},kerning:{},widths:[]},l.metadata.glyIdsUsed=[0]})(r,i)}}])}(hi),function(e){function n(){return(fi.canvg?Promise.resolve(fi.canvg):Qc(()=>import("./index.es.js"),[])).catch(function(t){return Promise.reject(new Error("Could not load canvg: "+t))}).then(function(t){return t.default?t.default:t})}hi.API.addSvgAsImage=function(t,i,r,o,l,h,g,v){if(isNaN(i)||isNaN(r))throw zr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(o)||isNaN(l))throw zr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var _=document.createElement("canvas");_.width=o,_.height=l;var x=_.getContext("2d");x.fillStyle="#fff",x.fillRect(0,0,_.width,_.height);var E={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},b=this;return n().then(function(D){return D.fromString(x,t,E)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(D){return D.render(E)}).then(function(){b.addImage(_.toDataURL("image/jpeg",1),i,r,o,l,g,v)})}}(),hi.API.putTotalPages=function(e){var n,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(n=new RegExp(e,"g"),t=this.internal.getNumberOfPages()):(n=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var i=1;i<=this.internal.getNumberOfPages();i++)for(var r=0;r<this.internal.pages[i].length;r++)this.internal.pages[i][r]=this.internal.pages[i][r].replace(n,t);return this},hi.API.viewerPreferences=function(e,n){var t;e=e||{},n=n||!1;var i,r,o,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},h=Object.keys(l),g=[],v=0,_=0,x=0;function E(D,$){var Q,F=!1;for(Q=0;Q<D.length;Q+=1)D[Q]===$&&(F=!0);return F}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,e==="reset"||n===!0){var b=h.length;for(x=0;x<b;x+=1)t[h[x]].value=t[h[x]].defaultValue,t[h[x]].explicitSet=!1}if(Mr(e)==="object"){for(r in e)if(o=e[r],E(h,r)&&o!==void 0){if(t[r].type==="boolean"&&typeof o=="boolean")t[r].value=o;else if(t[r].type==="name"&&E(t[r].valueSet,o))t[r].value=o;else if(t[r].type==="integer"&&Number.isInteger(o))t[r].value=o;else if(t[r].type==="array"){for(v=0;v<o.length;v+=1)if(i=!0,o[v].length===1&&typeof o[v][0]=="number")g.push(String(o[v]-1));else if(o[v].length>1){for(_=0;_<o[v].length;_+=1)typeof o[v][_]!="number"&&(i=!1);i===!0&&g.push([o[v][0]-1,o[v][1]-1].join(" "))}t[r].value="["+g.join(" ")+"]"}else t[r].value=t[r].defaultValue;t[r].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var D,$=[];for(D in t)t[D].explicitSet===!0&&(t[D].type==="name"?$.push("/"+D+" /"+t[D].value):$.push("/"+D+" "+t[D].value));$.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+$.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},function(e){var n=function(){var i='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',r=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(i)),l=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),h=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),g=unescape(encodeURIComponent("</x:xmpmeta>")),v=o.length+l.length+h.length+r.length+g.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+v+" >>"),this.internal.write("stream"),this.internal.write(r+o+l+h+g),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(i,r){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:i,namespaceuri:r||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",n)),this}}(hi.API),function(e){var n=e.API,t=n.pdfEscape16=function(o,l){for(var h,g=l.metadata.Unicode.widths,v=["","0","00","000","0000"],_=[""],x=0,E=o.length;x<E;++x){if(h=l.metadata.characterToGlyph(o.charCodeAt(x)),l.metadata.glyIdsUsed.push(h),l.metadata.toUnicode[h]=o.charCodeAt(x),g.indexOf(h)==-1&&(g.push(h),g.push([parseInt(l.metadata.widthOfGlyph(h),10)])),h=="0")return _.join("");h=h.toString(16),_.push(v[4-h.length],h)}return _.join("")},i=function(o){var l,h,g,v,_,x,E;for(_=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,g=[],x=0,E=(h=Object.keys(o).sort(function(b,D){return b-D})).length;x<E;x++)l=h[x],g.length>=100&&(_+=`
`+g.length+` beginbfchar
`+g.join(`
`)+`
endbfchar`,g=[]),o[l]!==void 0&&o[l]!==null&&typeof o[l].toString=="function"&&(v=("0000"+o[l].toString(16)).slice(-4),l=("0000"+(+l).toString(16)).slice(-4),g.push("<"+l+"><"+v+">"));return g.length&&(_+=`
`+g.length+` beginbfchar
`+g.join(`
`)+`
endbfchar
`),_+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};n.events.push(["putFont",function(o){(function(l){var h=l.font,g=l.out,v=l.newObject,_=l.putStream;if(h.metadata instanceof e.API.TTFFont&&h.encoding==="Identity-H"){for(var x=h.metadata.Unicode.widths,E=h.metadata.subset.encode(h.metadata.glyIdsUsed,1),b="",D=0;D<E.length;D++)b+=String.fromCharCode(E[D]);var $=v();_({data:b,addLength1:!0,objectId:$}),g("endobj");var Q=v();_({data:i(h.metadata.toUnicode),addLength1:!0,objectId:Q}),g("endobj");var F=v();g("<<"),g("/Type /FontDescriptor"),g("/FontName /"+Rh(h.fontName)),g("/FontFile2 "+$+" 0 R"),g("/FontBBox "+e.API.PDFObject.convert(h.metadata.bbox)),g("/Flags "+h.metadata.flags),g("/StemV "+h.metadata.stemV),g("/ItalicAngle "+h.metadata.italicAngle),g("/Ascent "+h.metadata.ascender),g("/Descent "+h.metadata.decender),g("/CapHeight "+h.metadata.capHeight),g(">>"),g("endobj");var G=v();g("<<"),g("/Type /Font"),g("/BaseFont /"+Rh(h.fontName)),g("/FontDescriptor "+F+" 0 R"),g("/W "+e.API.PDFObject.convert(x)),g("/CIDToGIDMap /Identity"),g("/DW 1000"),g("/Subtype /CIDFontType2"),g("/CIDSystemInfo"),g("<<"),g("/Supplement 0"),g("/Registry (Adobe)"),g("/Ordering ("+h.encoding+")"),g(">>"),g(">>"),g("endobj"),h.objectNumber=v(),g("<<"),g("/Type /Font"),g("/Subtype /Type0"),g("/ToUnicode "+Q+" 0 R"),g("/BaseFont /"+Rh(h.fontName)),g("/Encoding /"+h.encoding),g("/DescendantFonts ["+G+" 0 R]"),g(">>"),g("endobj"),h.isAlreadyPutted=!0}})(o)}]),n.events.push(["putFont",function(o){(function(l){var h=l.font,g=l.out,v=l.newObject,_=l.putStream;if(h.metadata instanceof e.API.TTFFont&&h.encoding==="WinAnsiEncoding"){for(var x=h.metadata.rawData,E="",b=0;b<x.length;b++)E+=String.fromCharCode(x[b]);var D=v();_({data:E,addLength1:!0,objectId:D}),g("endobj");var $=v();_({data:i(h.metadata.toUnicode),addLength1:!0,objectId:$}),g("endobj");var Q=v();g("<<"),g("/Descent "+h.metadata.decender),g("/CapHeight "+h.metadata.capHeight),g("/StemV "+h.metadata.stemV),g("/Type /FontDescriptor"),g("/FontFile2 "+D+" 0 R"),g("/Flags 96"),g("/FontBBox "+e.API.PDFObject.convert(h.metadata.bbox)),g("/FontName /"+Rh(h.fontName)),g("/ItalicAngle "+h.metadata.italicAngle),g("/Ascent "+h.metadata.ascender),g(">>"),g("endobj"),h.objectNumber=v();for(var F=0;F<h.metadata.hmtx.widths.length;F++)h.metadata.hmtx.widths[F]=parseInt(h.metadata.hmtx.widths[F]*(1e3/h.metadata.head.unitsPerEm));g("<</Subtype/TrueType/Type/Font/ToUnicode "+$+" 0 R/BaseFont/"+Rh(h.fontName)+"/FontDescriptor "+Q+" 0 R/Encoding/"+h.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(h.metadata.hmtx.widths)+">>"),g("endobj"),h.isAlreadyPutted=!0}})(o)}]);var r=function(o){var l,h=o.text||"",g=o.x,v=o.y,_=o.options||{},x=o.mutex||{},E=x.pdfEscape,b=x.activeFontKey,D=x.fonts,$=b,Q="",F=0,G="",me=D[$].encoding;if(D[$].encoding!=="Identity-H")return{text:h,x:g,y:v,options:_,mutex:x};for(G=h,$=b,Array.isArray(h)&&(G=h[0]),F=0;F<G.length;F+=1)D[$].metadata.hasOwnProperty("cmap")&&(l=D[$].metadata.cmap.unicode.codeMap[G[F].charCodeAt(0)]),l||G[F].charCodeAt(0)<256&&D[$].metadata.hasOwnProperty("Unicode")?Q+=G[F]:Q+="";var Se="";return parseInt($.slice(1))<14||me==="WinAnsiEncoding"?Se=E(Q,$).split("").map(function(Ie){return Ie.charCodeAt(0).toString(16)}).join(""):me==="Identity-H"&&(Se=t(Q,D[$])),x.isHex=!0,{text:Se,x:g,y:v,options:_,mutex:x}};n.events.push(["postProcessText",function(o){var l=o.text||"",h=[],g={text:l,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(l)){var v=0;for(v=0;v<l.length;v+=1)Array.isArray(l[v])&&l[v].length===3?h.push([r(Object.assign({},g,{text:l[v][0]})).text,l[v][1],l[v][2]]):h.push(r(Object.assign({},g,{text:l[v]})).text);o.text=h}else o.text=r(Object.assign({},g,{text:l})).text}])}(hi),function(e){var n=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(t){return n.call(this),this.internal.vFS[t]!==void 0},e.addFileToVFS=function(t,i){return n.call(this),this.internal.vFS[t]=i,this},e.getFileFromVFS=function(t){return n.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}}(hi.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(i){var r,o,l,h,g,v,_,x=n,E=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],b=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],D={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},$={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},Q=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],F=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),G=!1,me=0;this.__bidiEngine__={};var Se=function(z){var R=z.charCodeAt(),J=R>>8,V=$[J];return V!==void 0?x[256*V+(255&R)]:J===252||J===253?"AL":F.test(J)?"L":J===8?"R":"N"},Ie=function(z){for(var R,J=0;J<z.length;J++){if((R=Se(z.charAt(J)))==="L")return!1;if(R==="R")return!0}return!1},nt=function(z,R,J,V){var U,Y,ce,re,Pe=R[V];switch(Pe){case"L":case"R":G=!1;break;case"N":case"AN":break;case"EN":G&&(Pe="AN");break;case"AL":G=!0,Pe="R";break;case"WS":Pe="N";break;case"CS":V<1||V+1>=R.length||(U=J[V-1])!=="EN"&&U!=="AN"||(Y=R[V+1])!=="EN"&&Y!=="AN"?Pe="N":G&&(Y="AN"),Pe=Y===U?Y:"N";break;case"ES":Pe=(U=V>0?J[V-1]:"B")==="EN"&&V+1<R.length&&R[V+1]==="EN"?"EN":"N";break;case"ET":if(V>0&&J[V-1]==="EN"){Pe="EN";break}if(G){Pe="N";break}for(ce=V+1,re=R.length;ce<re&&R[ce]==="ET";)ce++;Pe=ce<re&&R[ce]==="EN"?"EN":"N";break;case"NSM":if(l&&!h){for(re=R.length,ce=V+1;ce<re&&R[ce]==="NSM";)ce++;if(ce<re){var Me=z[V],ot=Me>=1425&&Me<=2303||Me===64286;if(U=R[ce],ot&&(U==="R"||U==="AL")){Pe="R";break}}}Pe=V<1||(U=R[V-1])==="B"?"N":J[V-1];break;case"B":G=!1,r=!0,Pe=me;break;case"S":o=!0,Pe="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":G=!1;break;case"BN":Pe="N"}return Pe},Ve=function(z,R,J){var V=z.split("");return J&&O(V,J,{hiLevel:me}),V.reverse(),R&&R.reverse(),V.join("")},O=function(z,R,J){var V,U,Y,ce,re,Pe=-1,Me=z.length,ot=0,X=[],Ee=me?b:E,B=[];for(G=!1,r=!1,o=!1,U=0;U<Me;U++)B[U]=Se(z[U]);for(Y=0;Y<Me;Y++){if(re=ot,X[Y]=nt(z,B,X,Y),V=240&(ot=Ee[re][D[X[Y]]]),ot&=15,R[Y]=ce=Ee[ot][5],V>0)if(V===16){for(U=Pe;U<Y;U++)R[U]=1;Pe=-1}else Pe=-1;if(Ee[ot][6])Pe===-1&&(Pe=Y);else if(Pe>-1){for(U=Pe;U<Y;U++)R[U]=ce;Pe=-1}B[Y]==="B"&&(R[Y]=0),J.hiLevel|=ce}o&&function(H,he,te){for(var ie=0;ie<te;ie++)if(H[ie]==="S"){he[ie]=me;for(var ee=ie-1;ee>=0&&H[ee]==="WS";ee--)he[ee]=me}}(B,R,Me)},W=function(z,R,J,V,U){if(!(U.hiLevel<z)){if(z===1&&me===1&&!r)return R.reverse(),void(J&&J.reverse());for(var Y,ce,re,Pe,Me=R.length,ot=0;ot<Me;){if(V[ot]>=z){for(re=ot+1;re<Me&&V[re]>=z;)re++;for(Pe=ot,ce=re-1;Pe<ce;Pe++,ce--)Y=R[Pe],R[Pe]=R[ce],R[ce]=Y,J&&(Y=J[Pe],J[Pe]=J[ce],J[ce]=Y);ot=re}ot++}}},ue=function(z,R,J){var V=z.split(""),U={hiLevel:me};return J||(J=[]),O(V,J,U),function(Y,ce,re){if(re.hiLevel!==0&&_)for(var Pe,Me=0;Me<Y.length;Me++)ce[Me]===1&&(Pe=Q.indexOf(Y[Me]))>=0&&(Y[Me]=Q[Pe+1])}(V,J,U),W(2,V,R,J,U),W(1,V,R,J,U),V.join("")};return this.__bidiEngine__.doBidiReorder=function(z,R,J){if(function(U,Y){if(Y)for(var ce=0;ce<U.length;ce++)Y[ce]=ce;h===void 0&&(h=Ie(U)),v===void 0&&(v=Ie(U))}(z,R),l||!g||v)if(l&&g&&h^v)me=h?1:0,z=Ve(z,R,J);else if(!l&&g&&v)me=h?1:0,z=ue(z,R,J),z=Ve(z,R);else if(!l||h||g||v){if(l&&!g&&h^v)z=Ve(z,R),h?(me=0,z=ue(z,R,J)):(me=1,z=ue(z,R,J),z=Ve(z,R));else if(l&&h&&!g&&v)me=1,z=ue(z,R,J),z=Ve(z,R);else if(!l&&!g&&h^v){var V=_;h?(me=1,z=ue(z,R,J),me=0,_=!1,z=ue(z,R,J),_=V):(me=0,z=ue(z,R,J),z=Ve(z,R),me=1,_=!1,z=ue(z,R,J),_=V,z=Ve(z,R))}}else me=0,z=ue(z,R,J);else me=h?1:0,z=ue(z,R,J);return z},this.__bidiEngine__.setOptions=function(z){z&&(l=z.isInputVisual,g=z.isOutputVisual,h=z.isInputRtl,v=z.isOutputRtl,_=z.isSymmetricSwapping)},this.__bidiEngine__.setOptions(i),this.__bidiEngine__};var n=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(i){var r=i.text,o=(i.x,i.y,i.options||{}),l=(i.mutex,o.lang,[]);if(o.isInputVisual=typeof o.isInputVisual!="boolean"||o.isInputVisual,t.setOptions(o),Object.prototype.toString.call(r)==="[object Array]"){var h=0;for(l=[],h=0;h<r.length;h+=1)Object.prototype.toString.call(r[h])==="[object Array]"?l.push([t.doBidiReorder(r[h][0]),r[h][1],r[h][2]]):l.push([t.doBidiReorder(r[h])]);i.text=l}else i.text=t.doBidiReorder(r);t.setOptions({isInputVisual:!0})}])}(hi),hi.API.TTFFont=function(){function e(n){var t;if(this.rawData=n,t=this.contents=new Pc(n),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new EN(this),this.registerTTF()}return e.open=function(n){return new e(n)},e.prototype.parse=function(){return this.directory=new dN(this.contents),this.head=new gN(this),this.name=new bN(this),this.cmap=new q4(this),this.toUnicode={},this.hhea=new mN(this),this.maxp=new wN(this),this.hmtx=new xN(this),this.post=new yN(this),this.os2=new vN(this),this.loca=new PN(this),this.glyf=new LN(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var n,t,i,r,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var l,h,g,v;for(v=[],l=0,h=(g=this.bbox).length;l<h;l++)n=g[l],v.push(Math.round(n*this.scaleFactor));return v}).call(this),this.stemV=0,this.post.exists?(i=255&(r=this.post.italic_angle),32768&(t=r>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+i)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(o=this.familyClass)===1||o===2||o===3||o===4||o===5||o===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(n){var t;return((t=this.cmap.unicode)!=null?t.codeMap[n]:void 0)||0},e.prototype.widthOfGlyph=function(n){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(n).advance*t},e.prototype.widthOfString=function(n,t,i){var r,o,l,h;for(l=0,o=0,h=(n=""+n).length;0<=h?o<h:o>h;o=0<=h?++o:--o)r=n.charCodeAt(o),l+=this.widthOfGlyph(this.characterToGlyph(r))+i*(1e3/t)||0;return l*(t/1e3)},e.prototype.lineHeight=function(n,t){var i;return t==null&&(t=!1),i=t?this.lineGap:0,(this.ascender+i-this.decender)/1e3*n},e}();var nu,Pc=function(){function e(n){this.data=n??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(n){return this.data[this.pos++]=n},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(n){return this.writeByte(n>>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt32=function(){var n;return(n=this.readUInt32())>=2147483648?n-4294967296:n},e.prototype.writeInt32=function(n){return n<0&&(n+=4294967296),this.writeUInt32(n)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(n){return this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt16=function(){var n;return(n=this.readUInt16())>=32768?n-65536:n},e.prototype.writeInt16=function(n){return n<0&&(n+=65536),this.writeUInt16(n)},e.prototype.readString=function(n){var t,i;for(i=[],t=0;0<=n?t<n:t>n;t=0<=n?++t:--t)i[t]=String.fromCharCode(this.readByte());return i.join("")},e.prototype.writeString=function(n){var t,i,r;for(r=[],t=0,i=n.length;0<=i?t<i:t>i;t=0<=i?++t:--t)r.push(this.writeByte(n.charCodeAt(t)));return r},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(n){return this.writeInt16(n)},e.prototype.readLongLong=function(){var n,t,i,r,o,l,h,g;return n=this.readByte(),t=this.readByte(),i=this.readByte(),r=this.readByte(),o=this.readByte(),l=this.readByte(),h=this.readByte(),g=this.readByte(),128&n?-1*(72057594037927940*(255^n)+281474976710656*(255^t)+1099511627776*(255^i)+4294967296*(255^r)+16777216*(255^o)+65536*(255^l)+256*(255^h)+(255^g)+1):72057594037927940*n+281474976710656*t+1099511627776*i+4294967296*r+16777216*o+65536*l+256*h+g},e.prototype.writeLongLong=function(n){var t,i;return t=Math.floor(n/4294967296),i=4294967295&n,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(i>>24&255),this.writeByte(i>>16&255),this.writeByte(i>>8&255),this.writeByte(255&i)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(n){return this.writeInt32(n)},e.prototype.read=function(n){var t,i;for(t=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)t.push(this.readByte());return t},e.prototype.write=function(n){var t,i,r,o;for(o=[],i=0,r=n.length;i<r;i++)t=n[i],o.push(this.writeByte(t));return o},e}(),dN=function(){var e;function n(t){var i,r,o;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},r=0,o=this.tableCount;0<=o?r<o:r>o;r=0<=o?++r:--r)i={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[i.tag]=i}return n.prototype.encode=function(t){var i,r,o,l,h,g,v,_,x,E,b,D,$;for($ in b=Object.keys(t).length,g=Math.log(2),x=16*Math.floor(Math.log(b)/g),l=Math.floor(x/g),_=16*b-x,(r=new Pc).writeInt(this.scalarType),r.writeShort(b),r.writeShort(x),r.writeShort(l),r.writeShort(_),o=16*b,v=r.pos+o,h=null,D=[],t)for(E=t[$],r.writeString($),r.writeInt(e(E)),r.writeInt(v),r.writeInt(E.length),D=D.concat(E),$==="head"&&(h=v),v+=E.length;v%4;)D.push(0),v++;return r.write(D),i=2981146554-e(r.data),r.pos=h+8,r.writeUInt32(i),r.data},e=function(t){var i,r,o,l;for(t=V4.call(t);t.length%4;)t.push(0);for(o=new Pc(t),r=0,i=0,l=t.length;i<l;i=i+=4)r+=o.readUInt32();return 4294967295&r},n}(),pN={}.hasOwnProperty,Mu=function(e,n){for(var t in n)pN.call(n,t)&&(e[t]=n[t]);function i(){this.constructor=e}return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};nu=function(){function e(n){var t;this.file=n,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var gN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,nu),n.prototype.tag="head",n.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},n.prototype.encode=function(t){var i;return(i=new Pc).writeInt(this.version),i.writeInt(this.revision),i.writeInt(this.checkSumAdjustment),i.writeInt(this.magicNumber),i.writeShort(this.flags),i.writeShort(this.unitsPerEm),i.writeLongLong(this.created),i.writeLongLong(this.modified),i.writeShort(this.xMin),i.writeShort(this.yMin),i.writeShort(this.xMax),i.writeShort(this.yMax),i.writeShort(this.macStyle),i.writeShort(this.lowestRecPPEM),i.writeShort(this.fontDirectionHint),i.writeShort(t),i.writeShort(this.glyphDataFormat),i.data},n}(),Wy=function(){function e(n,t){var i,r,o,l,h,g,v,_,x,E,b,D,$,Q,F,G,me;switch(this.platformID=n.readUInt16(),this.encodingID=n.readShort(),this.offset=t+n.readInt(),x=n.pos,n.pos=this.offset,this.format=n.readUInt16(),this.length=n.readUInt16(),this.language=n.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(g=0;g<256;++g)this.codeMap[g]=n.readByte();break;case 4:for(b=n.readUInt16(),E=b/2,n.pos+=6,o=function(){var Se,Ie;for(Ie=[],g=Se=0;0<=E?Se<E:Se>E;g=0<=E?++Se:--Se)Ie.push(n.readUInt16());return Ie}(),n.pos+=2,$=function(){var Se,Ie;for(Ie=[],g=Se=0;0<=E?Se<E:Se>E;g=0<=E?++Se:--Se)Ie.push(n.readUInt16());return Ie}(),v=function(){var Se,Ie;for(Ie=[],g=Se=0;0<=E?Se<E:Se>E;g=0<=E?++Se:--Se)Ie.push(n.readUInt16());return Ie}(),_=function(){var Se,Ie;for(Ie=[],g=Se=0;0<=E?Se<E:Se>E;g=0<=E?++Se:--Se)Ie.push(n.readUInt16());return Ie}(),r=(this.length-n.pos+this.offset)/2,h=function(){var Se,Ie;for(Ie=[],g=Se=0;0<=r?Se<r:Se>r;g=0<=r?++Se:--Se)Ie.push(n.readUInt16());return Ie}(),g=F=0,me=o.length;F<me;g=++F)for(Q=o[g],i=G=D=$[g];D<=Q?G<=Q:G>=Q;i=D<=Q?++G:--G)_[g]===0?l=i+v[g]:(l=h[_[g]/2+(i-D)-(E-g)]||0)!==0&&(l+=v[g]),this.codeMap[i]=65535&l}n.pos=x}return e.encode=function(n,t){var i,r,o,l,h,g,v,_,x,E,b,D,$,Q,F,G,me,Se,Ie,nt,Ve,O,W,ue,z,R,J,V,U,Y,ce,re,Pe,Me,ot,X,Ee,B,H,he,te,ie,ee,se,Ce,ne;switch(V=new Pc,l=Object.keys(n).sort(function(ae,xe){return ae-xe}),t){case"macroman":for($=0,Q=function(){var ae=[];for(D=0;D<256;++D)ae.push(0);return ae}(),G={0:0},o={},U=0,Pe=l.length;U<Pe;U++)G[ee=n[r=l[U]]]==null&&(G[ee]=++$),o[r]={old:n[r],new:G[n[r]]},Q[r]=G[n[r]];return V.writeUInt16(1),V.writeUInt16(0),V.writeUInt32(12),V.writeUInt16(0),V.writeUInt16(262),V.writeUInt16(0),V.write(Q),{charMap:o,subtable:V.data,maxGlyphID:$+1};case"unicode":for(R=[],x=[],me=0,G={},i={},F=v=null,Y=0,Me=l.length;Y<Me;Y++)G[Ie=n[r=l[Y]]]==null&&(G[Ie]=++me),i[r]={old:Ie,new:G[Ie]},h=G[Ie]-r,F!=null&&h===v||(F&&x.push(F),R.push(r),v=h),F=r;for(F&&x.push(F),x.push(65535),R.push(65535),ue=2*(W=R.length),O=2*Math.pow(Math.log(W)/Math.LN2,2),E=Math.log(O/2)/Math.LN2,Ve=2*W-O,g=[],nt=[],b=[],D=ce=0,ot=R.length;ce<ot;D=++ce){if(z=R[D],_=x[D],z===65535){g.push(0),nt.push(0);break}if(z-(J=i[z].new)>=32768)for(g.push(0),nt.push(2*(b.length+W-D)),r=re=z;z<=_?re<=_:re>=_;r=z<=_?++re:--re)b.push(i[r].new);else g.push(J-z),nt.push(0)}for(V.writeUInt16(3),V.writeUInt16(1),V.writeUInt32(12),V.writeUInt16(4),V.writeUInt16(16+8*W+2*b.length),V.writeUInt16(0),V.writeUInt16(ue),V.writeUInt16(O),V.writeUInt16(E),V.writeUInt16(Ve),te=0,X=x.length;te<X;te++)r=x[te],V.writeUInt16(r);for(V.writeUInt16(0),ie=0,Ee=R.length;ie<Ee;ie++)r=R[ie],V.writeUInt16(r);for(se=0,B=g.length;se<B;se++)h=g[se],V.writeUInt16(h);for(Ce=0,H=nt.length;Ce<H;Ce++)Se=nt[Ce],V.writeUInt16(Se);for(ne=0,he=b.length;ne<he;ne++)$=b[ne],V.writeUInt16($);return{charMap:i,subtable:V.data,maxGlyphID:me+1}}},e}(),q4=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,nu),n.prototype.tag="cmap",n.prototype.parse=function(t){var i,r,o;for(t.pos=this.offset,this.version=t.readUInt16(),o=t.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=o?r<o:r>o;r=0<=o?++r:--r)i=new Wy(t,this.offset),this.tables.push(i),i.isUnicode&&this.unicode==null&&(this.unicode=i);return!0},n.encode=function(t,i){var r,o;return i==null&&(i="macroman"),r=Wy.encode(t,i),(o=new Pc).writeUInt16(0),o.writeUInt16(1),r.table=o.data.concat(r.subtable),r},n}(),mN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,nu),n.prototype.tag="hhea",n.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},n}(),vN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,nu),n.prototype.tag="OS/2",n.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var i,r;for(r=[],i=0;i<10;++i)r.push(t.readByte());return r}(),this.charRange=function(){var i,r;for(r=[],i=0;i<4;++i)r.push(t.readInt());return r}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var i,r;for(r=[],i=0;i<2;i=++i)r.push(t.readInt());return r}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},n}(),yN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,nu),n.prototype.tag="post",n.prototype.parse=function(t){var i,r,o;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:break;case 131072:var l;for(r=t.readUInt16(),this.glyphNameIndex=[],l=0;0<=r?l<r:l>r;l=0<=r?++l:--l)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],o=[];t.pos<this.offset+this.length;)i=t.readByte(),o.push(this.names.push(t.readString(i)));return o;case 151552:return r=t.readUInt16(),this.offsets=t.read(r);case 196608:break;case 262144:return this.map=(function(){var h,g,v;for(v=[],l=h=0,g=this.file.maxp.numGlyphs;0<=g?h<g:h>g;l=0<=g?++h:--h)v.push(t.readUInt32());return v}).call(this)}},n}(),_N=function(e,n){this.raw=e,this.length=e.length,this.platformID=n.platformID,this.encodingID=n.encodingID,this.languageID=n.languageID},bN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,nu),n.prototype.tag="name",n.prototype.parse=function(t){var i,r,o,l,h,g,v,_,x,E,b;for(t.pos=this.offset,t.readShort(),i=t.readShort(),g=t.readShort(),r=[],l=0;0<=i?l<i:l>i;l=0<=i?++l:--l)r.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+g+t.readShort()});for(v={},l=x=0,E=r.length;x<E;l=++x)o=r[l],t.pos=o.offset,_=t.readString(o.length),h=new _N(_,o),v[b=o.nameID]==null&&(v[b]=[]),v[o.nameID].push(h);this.strings=v,this.copyright=v[0],this.fontFamily=v[1],this.fontSubfamily=v[2],this.uniqueSubfamily=v[3],this.fontName=v[4],this.version=v[5];try{this.postscriptName=v[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=v[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=v[7],this.manufacturer=v[8],this.designer=v[9],this.description=v[10],this.vendorUrl=v[11],this.designerUrl=v[12],this.license=v[13],this.licenseUrl=v[14],this.preferredFamily=v[15],this.preferredSubfamily=v[17],this.compatibleFull=v[18],this.sampleText=v[19]},n}(),wN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,nu),n.prototype.tag="maxp",n.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},n}(),xN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,nu),n.prototype.tag="hmtx",n.prototype.parse=function(t){var i,r,o,l,h,g,v;for(t.pos=this.offset,this.metrics=[],i=0,g=this.file.hhea.numberOfMetrics;0<=g?i<g:i>g;i=0<=g?++i:--i)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(o=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var _,x;for(x=[],i=_=0;0<=o?_<o:_>o;i=0<=o?++_:--_)x.push(t.readInt16());return x}(),this.widths=(function(){var _,x,E,b;for(b=[],_=0,x=(E=this.metrics).length;_<x;_++)l=E[_],b.push(l.advance);return b}).call(this),r=this.widths[this.widths.length-1],v=[],i=h=0;0<=o?h<o:h>o;i=0<=o?++h:--h)v.push(this.widths.push(r));return v},n.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},n}(),V4=[].slice,LN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,nu),n.prototype.tag="glyf",n.prototype.parse=function(){return this.cache={}},n.prototype.glyphFor=function(t){var i,r,o,l,h,g,v,_,x,E;return t in this.cache?this.cache[t]:(l=this.file.loca,i=this.file.contents,r=l.indexOf(t),(o=l.lengthOf(t))===0?this.cache[t]=null:(i.pos=this.offset+r,h=(g=new Pc(i.read(o))).readShort(),_=g.readShort(),E=g.readShort(),v=g.readShort(),x=g.readShort(),this.cache[t]=h===-1?new SN(g,_,E,v,x):new CN(g,h,_,E,v,x),this.cache[t]))},n.prototype.encode=function(t,i,r){var o,l,h,g,v;for(h=[],l=[],g=0,v=i.length;g<v;g++)o=t[i[g]],l.push(h.length),o&&(h=h.concat(o.encode(r)));return l.push(h.length),{table:h,offsets:l}},n}(),CN=function(){function e(n,t,i,r,o,l){this.raw=n,this.numberOfContours=t,this.xMin=i,this.yMin=r,this.xMax=o,this.yMax=l,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),SN=function(){function e(n,t,i,r,o){var l,h;for(this.raw=n,this.xMin=t,this.yMin=i,this.xMax=r,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],l=this.raw;h=l.readShort(),this.glyphOffsets.push(l.pos),this.glyphIDs.push(l.readUInt16()),32&h;)l.pos+=1&h?4:2,128&h?l.pos+=8:64&h?l.pos+=4:8&h&&(l.pos+=2)}return e.prototype.encode=function(){var n,t,i;for(t=new Pc(V4.call(this.raw.data)),n=0,i=this.glyphIDs.length;n<i;++n)t.pos=this.glyphOffsets[n];return t.data},e}(),PN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,nu),n.prototype.tag="loca",n.prototype.parse=function(t){var i,r;return t.pos=this.offset,i=this.file.head.indexToLocFormat,this.offsets=i===0?(function(){var o,l;for(l=[],r=0,o=this.length;r<o;r+=2)l.push(2*t.readUInt16());return l}).call(this):(function(){var o,l;for(l=[],r=0,o=this.length;r<o;r+=4)l.push(t.readUInt32());return l}).call(this)},n.prototype.indexOf=function(t){return this.offsets[t]},n.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},n.prototype.encode=function(t,i){for(var r=new Uint32Array(this.offsets.length),o=0,l=0,h=0;h<r.length;++h)if(r[h]=o,l<i.length&&i[l]==h){++l,r[h]=o;var g=this.offsets[h],v=this.offsets[h+1]-g;v>0&&(o+=v)}for(var _=new Array(4*r.length),x=0;x<r.length;++x)_[4*x+3]=255&r[x],_[4*x+2]=(65280&r[x])>>8,_[4*x+1]=(16711680&r[x])>>16,_[4*x]=(4278190080&r[x])>>24;return _},n}(),EN=function(){function e(n){this.font=n,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var n,t,i,r,o;for(t in r=this.font.cmap.tables[0].codeMap,n={},o=this.subset)i=o[t],n[t]=r[i];return n},e.prototype.glyphsFor=function(n){var t,i,r,o,l,h,g;for(r={},l=0,h=n.length;l<h;l++)r[o=n[l]]=this.font.glyf.glyphFor(o);for(o in t=[],r)(i=r[o])!=null&&i.compound&&t.push.apply(t,i.glyphIDs);if(t.length>0)for(o in g=this.glyphsFor(t))i=g[o],r[o]=i;return r},e.prototype.encode=function(n,t){var i,r,o,l,h,g,v,_,x,E,b,D,$,Q,F;for(r in i=q4.encode(this.generateCmap(),"unicode"),l=this.glyphsFor(n),b={0:0},F=i.charMap)b[(g=F[r]).old]=g.new;for(D in E=i.maxGlyphID,l)D in b||(b[D]=E++);return _=function(G){var me,Se;for(me in Se={},G)Se[G[me]]=me;return Se}(b),x=Object.keys(_).sort(function(G,me){return G-me}),$=function(){var G,me,Se;for(Se=[],G=0,me=x.length;G<me;G++)h=x[G],Se.push(_[h]);return Se}(),o=this.font.glyf.encode(l,$,b),v=this.font.loca.encode(o.offsets,$),Q={cmap:this.font.cmap.raw(),glyf:o.table,loca:v,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(Q["OS/2"]=this.font.os2.raw()),this.font.directory.encode(Q)},e}();hi.API.PDFObject=function(){var e;function n(){}return e=function(t,i){return(Array(i+1).join("0")+t).slice(-i)},n.convert=function(t){var i,r,o,l;if(Array.isArray(t))return"["+function(){var h,g,v;for(v=[],h=0,g=t.length;h<g;h++)i=t[h],v.push(n.convert(i));return v}().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+e(t.getUTCFullYear(),4)+e(t.getUTCMonth(),2)+e(t.getUTCDate(),2)+e(t.getUTCHours(),2)+e(t.getUTCMinutes(),2)+e(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(r in o=["<<"],t)l=t[r],o.push("/"+r+" "+n.convert(l));return o.push(">>"),o.join(`
`)}return""+t},n}();const AN={class:"h-full flex"},MN={class:"flex-1 relative"},kN={key:0,class:"absolute inset-0 bg-black/30 backdrop-blur-sm z-[2000] flex items-center justify-center"},TN={key:1,class:"absolute inset-0 flex items-center justify-center bg-gray-50 z-[3000]"},BN={class:"text-center max-w-lg mx-auto p-8"},NN={class:"space-y-4"},RN={class:"map-parent"},DN={key:0,class:"fixed top-16 left-0 right-0 z-[1500]"},ON={class:"map-content flex"},IN={class:"flex-1 relative"},FN={key:0,class:"w-64 bg-white border-l border-gray-200 flex-shrink-0 z-[2000]"},zN={key:0,class:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-75 z-50"},jN={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center z-[9999] p-4 overflow-y-auto"},UN={class:"bg-white rounded-lg p-6 max-w-2xl w-full my-8 relative"},$N={class:"flex justify-between items-center mb-4 sticky top-0 bg-white pb-4 border-b"},qN={class:"overflow-y-auto max-h-[calc(100vh-12rem)]"},VN={key:0,class:"space-y-4"},GN={key:0,class:"space-y-2"},HN={class:"grid grid-cols-1 gap-2"},WN=["onClick"],ZN={class:"font-medium text-gray-900"},KN={key:1,class:"space-y-2"},JN={class:"flex items-center mb-4"},YN={class:"text-sm text-gray-600"},XN={class:"grid grid-cols-1 gap-2"},QN=["onClick"],eR={class:"font-medium text-gray-900"},tR={key:2,class:"space-y-2"},nR={class:"flex items-center mb-4"},iR={class:"text-sm text-gray-600"},rR={class:"grid grid-cols-1 gap-2"},sR={key:0,class:"text-center py-8"},oR=["onClick"],aR={class:"font-medium text-gray-900"},lR={key:3,class:"space-y-2"},uR={class:"flex items-center mb-4"},cR={class:"text-sm text-gray-600"},hR={class:"grid grid-cols-1 gap-2"},fR=["onClick"],dR={class:"font-medium text-gray-900"},pR={class:"text-sm text-gray-500"},gR={class:"text-xs text-gray-400 mt-1"},mR={key:1,class:"space-y-4"},vR={key:0,class:"space-y-2"},yR={class:"grid grid-cols-1 gap-2"},_R={key:0,class:"text-center py-8"},bR=["onClick"],wR={class:"font-medium text-gray-900"},xR={key:1,class:"space-y-2"},LR={class:"flex items-center mb-4"},CR={class:"text-sm text-gray-600"},SR={class:"grid grid-cols-1 gap-2"},PR=["onClick"],ER={class:"font-medium text-gray-900"},AR={class:"text-sm text-gray-500"},MR={class:"text-xs text-gray-400 mt-1"},kR={key:2,class:"space-y-4"},TR={key:3,class:"space-y-4"},BR={key:0,class:"text-center py-8"},NR={key:1,class:"space-y-2"},RR=["onClick"],DR={class:"font-medium text-gray-900"},OR={class:"text-sm text-gray-500"},IR={class:"text-xs text-gray-400 mt-1"},Zy=Pa({__name:"MapView",emits:["shape-selected"],setup(e,{emit:n}){const t=un(null),i=Lm(),r=x4(),o=un([]),{currentTool:l,selectedShape:h,map:g,initMap:v,setDrawingTool:_,updateShapeStyle:x,updateShapeProperties:E,featureGroup:b,adjustView:D,clearActiveControlPoints:$,calculateConnectedCoverageArea:Q}=a7(),{initMap:F,changeBaseMap:G}=l7(),me=un(!1),Se=un(!1),Ie=un(null),nt=un(!1),Ve=un(null),O=Va(),W=un([]),ue=un([]),z=un([]),R=un(null),J=un(null),V=un(!1),U=un(!1),Y=un(!1),ce=un(null),re=Ni(()=>{var Qe,We;return console.log("[MapView][filteredClients] Computing with:",{userType:(Qe=O.user)==null?void 0:Qe.user_type,selectedConcessionnaire:R.value,concessionnaireAgriculteurs:ue.value,agriculteurCount:((We=ue.value)==null?void 0:We.length)||0}),O.isConcessionnaire||R.value?ue.value:[]}),Pe=Ni(()=>{var _n,mn,rt;if(!h.value)return null;console.log("[MapView][selectedShape] Initial layer state:",{layer:h.value,hasName:"name"in h.value,name:h.value.name,hasProperties:"properties"in h.value,propertiesName:(_n=h.value.properties)==null?void 0:_n.name,allLayerKeys:Object.keys(h.value),allPropertiesKeys:h.value.properties?Object.keys(h.value.properties):[],_leaflet_id:h.value._leaflet_id,_dbId:h.value._dbId,descriptor:Object.getOwnPropertyDescriptor(h.value,"name")});const Qe=h.value.properties||{};let We;if(Qe.style&&Qe.style.name)We=Qe.style.name,console.log("[MapView][selectedShape] Using name from style:",We);else if(Qe.name)We=Qe.name,console.log("[MapView][selectedShape] Using name from properties:",We);else if(h.value.name)We=h.value.name,console.log("[MapView][selectedShape] Using name from layer:",We);else{const vn=Object.getOwnPropertyDescriptor(h.value,"name");vn&&vn.value&&(We=vn.value,console.log("[MapView][selectedShape] Found name in non-enumerable layer property:",We));const ni=["_name","displayName","title"];for(const fn of ni)if(h.value[fn]){We=h.value[fn],console.log(`[MapView][selectedShape] Found name in ${fn}:`,We);break}}We&&(console.log(`[MapView][selectedShape] Ensuring name "${We}" is set everywhere`),h.value.properties||(h.value.properties={}),h.value.properties.name=We,h.value.properties.style||(h.value.properties.style={}),h.value.properties.style.name=We,h.value.name=We,typeof h.value.setName=="function"&&(h.value.setName(We),console.log(`[MapView][selectedShape] Used setName method to set name "${We}"`))),console.log("[MapView][selectedShape] Preparing properties for DrawingTools:",{type:Qe.type,name:Qe.name,foundName:We,hasNameProperty:"name"in Qe,allPropertiesKeys:Object.keys(Qe),layerId:h.value._leaflet_id,rawProperties:Qe,layerName:h.value.name,layerPropertiesName:(mn=h.value.properties)==null?void 0:mn.name});const Ut={...Qe,name:We||h.value.name||Qe.name||void 0},pn={type:Ut.type||"unknown",properties:Ut,layer:h.value};return console.log("[MapView][selectedShape] Final shape object for DrawingTools:",{type:pn.type,hasName:"name"in pn.properties,name:pn.properties.name,layerName:pn.layer.name,layerPropertiesName:(rt=pn.layer.properties)==null?void 0:rt.name}),pn});function Me(Qe){const We=Qe.getCenter(),Ut=Qe.getZoom(),pn={lat:We.lat,lng:We.lng,zoom:Ut};document.cookie=`mapState=${JSON.stringify(pn)};max-age=2592000;path=/`}function ot(){const We=document.cookie.split(";").find(Ut=>Ut.trim().startsWith("mapState="));if(We)try{return JSON.parse(We.split("=")[1])}catch(Ut){return console.error("Erreur lors de la lecture du cookie de position:",Ut),null}return null}Tl(async()=>{var Qe,We;try{if(await i.fetchPlans(),(O.isAdmin||O.isUsine)&&await Je(),O.isUsine){V.value=!0;try{const rt=await Kn.get("/users/",{params:{role:"CONCESSIONNAIRE",usine:(Qe=O.user)==null?void 0:Qe.id}});W.value=rt.data}catch(rt){console.error("Error loading concessionnaires:",rt),W.value=[]}finally{V.value=!1}}if(O.isConcessionnaire){U.value=!0;try{const rt=await O.fetchConcessionnaireAgriculteurs(((We=O.user)==null?void 0:We.id)||0);ue.value=Array.isArray(rt)?rt:[rt]}catch(rt){console.error("Error loading clients:",rt)}finally{U.value=!1}}const Ut=ot(),pn=Ut?[Ut.lat,Ut.lng]:[46.603354,1.888334],_n=(Ut==null?void 0:Ut.zoom)??6;if(t.value&&!g.value){const rt=v(t.value,pn,_n);rt.pm.setLang("fr"),rt.pm.addControls({rotateMode:!1}),F(rt),rt.on("moveend",()=>{Me(rt)}),window.addEventListener("map-set-location",vn=>{if(rt&&vn.detail){const{lat:ni,lng:fn,zoom:Mn}=vn.detail;rt.flyTo([ni,fn],Mn,{duration:1.5,easeLinearity:.25})}})}const mn=localStorage.getItem("lastPlanId");if(mn)try{console.log("[MapView][onMounted] Chargement immédiat du dernier plan:",mn),await B(parseInt(mn));const rt=document.querySelector(".map-parent");rt instanceof HTMLElement&&(rt.style.display="block")}catch(rt){console.error("[MapView][onMounted] Erreur chargement dernier plan:",rt),Ie.value=null,i.clearCurrentPlan(),r.clearCurrentPlan(),X(),localStorage.removeItem("lastPlanId")}else console.log("[MapView][onMounted] Aucun dernier plan à charger"),Ie.value=null,i.clearCurrentPlan(),r.clearCurrentPlan(),X();window.addEventListener("shape:created",rt=>{const{shape:vn,type:ni,properties:fn}=rt.detail;console.log("[MapView] Nouvelle forme créée",{shape:vn,type:ni,properties:fn}),r.addElement(vn),_("")})}catch(Ut){console.error("Error during component mount:",Ut),Ie.value=null,i.clearCurrentPlan(),r.clearCurrentPlan(),X(),localStorage.removeItem("lastPlanId")}}),So(()=>r.hasUnsavedChanges,Qe=>{console.log("[MapView][watch drawingStore.hasUnsavedChanges]",Qe),Qe&&Ie.value&&i.markUnsavedChanges()}),So(g,async Qe=>{var We;console.log(`
[MapView][watch map] Nouvelle carte:`,!!Qe),Qe&&i.currentPlan&&!((We=b.value)!=null&&We.getLayers().length)&&(console.log("[MapView][watch map] Chargement initial des éléments du plan:",i.currentPlan.id),X(),await r.loadPlanElements(i.currentPlan.id))}),So(()=>i.currentPlan,async(Qe,We)=>{var Ut,pn,_n;if((Qe==null?void 0:Qe.id)===(We==null?void 0:We.id)){console.log("[MapView][watch currentPlan] Plan identique, pas de rechargement nécessaire");return}console.log(`
[MapView][watch currentPlan] ====== CHANGEMENT DE PLAN ======`),console.log("[MapView][watch currentPlan] Nouveau plan:",Qe==null?void 0:Qe.id);try{if(Qe){console.log("[MapView][watch currentPlan] Mise à jour du plan courant..."),Ie.value=Qe;const mn=document.querySelector(".map-parent");mn instanceof HTMLElement&&(mn.style.display="block"),console.log("[MapView][watch currentPlan] Plan mis à jour avec succès")}else{console.log("[MapView][watch currentPlan] Nettoyage du plan courant..."),Ie.value=null,X();const mn=document.querySelector(".map-parent");mn instanceof HTMLElement&&(mn.style.display="none")}}catch(mn){console.error("[MapView][watch currentPlan] ERREUR:",mn),Ie.value=null,X()}console.log("[MapView][watch currentPlan] État final:",{currentPlanId:(Ut=Ie.value)==null?void 0:Ut.id,storePlanId:(pn=i.currentPlan)==null?void 0:pn.id,mapVisible:g.value!==null,mapParentDisplay:(_n=document.querySelector(".map-parent"))==null?void 0:_n.getAttribute("style")}),console.log(`[MapView][watch currentPlan] ====== FIN CHANGEMENT ======
`)},{immediate:!0}),Ep(()=>{g.value&&g.value.off("moveend"),window.removeEventListener("shape:created",()=>{})});function X(){b.value&&b.value.clearLayers(),o.value=[],$(),h.value=null,l.value=""}async function Ee(Qe){return await Ct.measureAsync("refreshMapWithPlan",async()=>{try{Ct.measure("refreshMapWithPlan:clearMap",()=>{X()},"MapView"),await Ct.measureAsync("refreshMapWithPlan:loadPlanElements",async()=>{await r.loadPlanElements(Qe)},"MapView");const We=Ct.measure("refreshMapWithPlan:getPlanById",()=>i.getPlanById(Qe),"MapView");We?(Ct.measure("refreshMapWithPlan:updateCurrentPlan",()=>{Ie.value=We,i.setCurrentPlan(We),r.setCurrentPlan(We.id),localStorage.setItem("lastPlanId",We.id.toString())},"MapView"),g.value&&b.value&&await Ct.measureAsync("refreshMapWithPlan:addShapesToMap",async()=>{console.log("[MapView][refreshMapWithPlan] Éléments disponibles:",{count:r.getCurrentElements.length,elements:r.getCurrentElements.map(mn=>{var rt;return{id:mn.id,type:mn.type_forme,hasName:mn.data&&"name"in mn.data,name:(rt=mn.data)==null?void 0:rt.name}})});const Ut=r.getCurrentElements.reduce((mn,rt)=>(mn[rt.type_forme]||(mn[rt.type_forme]=[]),mn[rt.type_forme].push(rt),mn),{}),pn=10,_n=Object.entries(Ut).map(async([mn,rt])=>{for(let vn=0;vn<rt.length;vn+=pn){const ni=rt.slice(vn,vn+pn);await Promise.all(ni.map(async fn=>{await Ct.measureAsync(`refreshMapWithPlan:createElement:${fn.type_forme}`,async()=>{var Sr,Ii;if(!b.value||!fn.data)return;let Mn=null;switch(fn.type_forme){case"TextRectangle":{const Mt=fn.data;if(!Mt.bounds)return;const On=wt.latLngBounds(wt.latLng(Mt.bounds.southWest[1],Mt.bounds.southWest[0]),wt.latLng(Mt.bounds.northEast[1],Mt.bounds.northEast[0]));Mn=new yu(On,Mt.content||"Double-cliquez pour éditer",{...Mt.style,textStyle:Mt.style.textStyle}),Mt.rotation&&typeof Mn.setRotation=="function"&&Mn.setRotation(Mt.rotation),Mt.name&&(Mn.properties={name:Mt.name},Mn.name=Mt.name);break}case"Circle":{const Mt=fn.data;Mt.center&&Mt.radius&&(Mn=new Zc(wt.latLng(Mt.center[1],Mt.center[0]),{...Mt.style,radius:Mt.radius}),Mt.name&&(Mn.properties={type:"Circle",name:Mt.name,style:Mt.style,radius:Mt.radius,diameter:Mt.radius*2,surface:Math.PI*Mt.radius*Mt.radius,perimeter:2*Math.PI*Mt.radius},Mn.name=Mt.name));break}case"Semicircle":{const Mt=fn.data;if(Mt.center&&Mt.radius){const On=wt.latLng(Mt.center[1],Mt.center[0]);Mn=new wu(On,Mt.radius,Mt.startAngle||0,Mt.endAngle||180,{...Mt.style}),Mn.properties={type:"Semicircle",radius:Mt.radius,startAngle:Mt.startAngle||0,stopAngle:Mt.endAngle||180,style:{...Mt.style||{},name:((Sr=Mt.style)==null?void 0:Sr.name)||""},center:On};const Fi=((Mt.endAngle||180)-(Mt.startAngle||0)+360)%360,zi=Math.PI*Math.pow(Mt.radius,2)*Fi/360,Xr=2*Math.PI*Mt.radius*Fi/360,$r=Xr+2*Mt.radius;Mn.properties.surface=zi,Mn.properties.arcLength=Xr,Mn.properties.perimeter=$r,Mn.properties.openingAngle=Fi,Mn.properties.diameter=Mt.radius*2,Mn.updateProperties()}break}case"Rectangle":{const Mt=fn.data;if(Mt.bounds){const On=wt.latLngBounds(wt.latLng(Mt.bounds.southWest[1],Mt.bounds.southWest[0]),wt.latLng(Mt.bounds.northEast[1],Mt.bounds.northEast[0]));Mn=new $o(On,Mt.style),Mt.name&&(Mn.properties={name:Mt.name},Mn.name=Mt.name)}break}case"Polygon":{const Mt=fn.data;if(Mt.points&&Mt.points.length>0){const On=Mt.points.map(Fi=>wt.latLng(Fi[1],Fi[0]));Mn=new zh(On,Mt.style),Mt.name&&(Mn.properties={name:Mt.name},Mn.name=Mt.name)}break}case"Line":{const Mt=fn.data;if(Mt.points&&Mt.points.length>0){const On=Mt.points.map(Fi=>wt.latLng(Fi[1],Fi[0]));Mn=new Lo(On,Mt.style),Mt.name&&(Mn.properties={name:Mt.name},Mn.name=Mt.name)}break}case"ElevationLine":{const Mt=fn.data;if(Mt.points&&Mt.points.length>0){const On=Mt.points.map(Fi=>wt.latLng(Fi[1],Fi[0]));Mn=new lh(On,Mt.style),Mt.name&&(Mn.properties={name:Mt.name,type:"ElevationLine",elevationData:Mt.elevationData,minElevation:Mt.minElevation,maxElevation:Mt.maxElevation,elevationGain:Mt.elevationGain,elevationLoss:Mt.elevationLoss,averageSlope:Mt.averageSlope,maxSlope:Mt.maxSlope},Mn.name=Mt.name),Mt.elevationData&&(Mn.elevationData=Mt.elevationData)}break}case"CircleWithSections":{const Mt=fn.data;if(Mt.center&&Mt.radius){const On=wt.latLng(Mt.center[1],Mt.center[0]);Mn=new eh(On,{...Mt.style,radius:Mt.radius}),Mt.sections&&Mt.sections.forEach(Fi=>{Mn.addSection(Fi)}),Mt.name&&(Mn.properties={name:Mt.name},Mn.name=Mt.name)}break}}Mn&&(Mn._dbId=fn.id,(Ii=b.value)==null||Ii.addLayer(Mn),o.value.push({id:fn.id,type:fn.type_forme,layer:Mn,properties:Mn.properties}))},"MapView")})),await new Promise(fn=>setTimeout(fn,0))}});await Promise.all(_n),Ct.measure("refreshMapWithPlan:adjustView",()=>{D()},"MapView")},"MapView"),console.log(`Plan ${Qe} chargé avec succès avec ${r.getCurrentElements.length} formes`)):console.error(`Plan ${Qe} introuvable après chargement`),Se.value=!1}catch(We){throw console.error("Erreur lors du rafraîchissement de la carte:",We),We}},"MapView")}async function B(Qe){return await Ct.measureAsync("loadPlan",async()=>{var We;console.log(`
[MapView][loadPlan] ====== DÉBUT CHARGEMENT PLAN ======`),console.log("[MapView][loadPlan] Tentative de chargement du plan:",Qe);try{const Ut=await Ct.measureAsync("loadPlan:getPlanFromStore",async()=>i.getPlanById(Qe),"MapView");if(console.log("[MapView][loadPlan] Plan trouvé dans le store:",!!Ut),!Ut){console.log("[MapView][loadPlan] Plan non trouvé dans le store, vérification API...");try{await Ct.measureAsync("loadPlan:apiCheck",async()=>{await Kn.get(`/plans/${Qe}/`)},"MapView")}catch(pn){throw((We=pn.response)==null?void 0:We.status)===404&&(console.warn("[MapView][loadPlan] Plan non trouvé - Nettoyage du localStorage"),localStorage.removeItem("lastPlanId"),Ie.value=null,i.clearCurrentPlan(),r.clearCurrentPlan(),X()),pn}}console.log("[MapView][loadPlan] Rafraîchissement de la carte..."),await Ct.measureAsync("loadPlan:refreshMap",async()=>{await Ee(Qe)},"MapView"),Se.value=!1,console.log("[MapView][loadPlan] Invalidation de la taille de la carte..."),je(),console.log("[MapView][loadPlan] Plan chargé avec succès:",{planId:Qe,elementsCount:r.getCurrentElements.length})}catch(Ut){throw console.error("Erreur lors du chargement du plan:",Ut),Ct.measure("loadPlan:errorRecovery",()=>{Ie.value=null,i.clearCurrentPlan(),r.clearCurrentPlan(),X(),localStorage.removeItem("lastPlanId")},"MapView"),Ut}},"MapView")}async function H(){var Qe;if(!Ie.value||!b.value){console.warn("Aucun plan actif ou groupe de formes à sauvegarder");return}nt.value=!0,Ve.value="saving";try{const We=[],Ut=new Set(r.getCurrentElements.filter(rt=>rt.id!==void 0).map(rt=>rt.id)),pn=new Set;console.log("[savePlan] Début de la sauvegarde",{featureGroupLayers:b.value.getLayers().length,existingIds:Array.from(Ut),currentElements:r.getCurrentElements}),b.value.eachLayer(rt=>{var Mn,Sr,Ii,Mt,On,Fi,zi,Xr,$r,Nn,pi,hr,bi,Zt,yn,er,kr,tr,qr,Vr,Qn,fr,fs,Qr,Ci,An,Pr,Ui,Vi,dr,es,Fs,di,co,mr,Er,mi,xn,on,ii,Xn,jn,rs,Ps,Tr,so;console.log("[savePlan] Traitement de la couche",{type:(Mn=rt.properties)==null?void 0:Mn.type,name:(Sr=rt.properties)==null?void 0:Sr.name,isPolygon:rt instanceof wt.Polygon,isCircleArc:rt instanceof wu,properties:rt.properties});let vn,ni;const fn={color:rt.options.color||"#3388ff",weight:rt.options.weight||3,opacity:rt.options.opacity||1,fillColor:rt.options.fillColor||"#3388ff",fillOpacity:rt.options.fillOpacity||.2,dashArray:rt.options.dashArray||""};if(rt instanceof yu){vn="TextRectangle";const ln=rt.getBounds();ni={bounds:{southWest:[ln.getSouthWest().lng,ln.getSouthWest().lat],northEast:[ln.getNorthEast().lng,ln.getNorthEast().lat]},content:((Ii=rt.properties)==null?void 0:Ii.text)||"",name:((On=(Mt=rt.properties)==null?void 0:Mt.style)==null?void 0:On.name)||"",style:{...fn,textStyle:{color:((Xr=(zi=(Fi=rt.properties)==null?void 0:Fi.style)==null?void 0:zi.textStyle)==null?void 0:Xr.color)||"#000000",fontSize:((pi=(Nn=($r=rt.properties)==null?void 0:$r.style)==null?void 0:Nn.textStyle)==null?void 0:pi.fontSize)||"14px",fontFamily:((Zt=(bi=(hr=rt.properties)==null?void 0:hr.style)==null?void 0:bi.textStyle)==null?void 0:Zt.fontFamily)||"Arial, sans-serif",textAlign:((kr=(er=(yn=rt.properties)==null?void 0:yn.style)==null?void 0:er.textStyle)==null?void 0:kr.textAlign)||"center",backgroundColor:((Vr=(qr=(tr=rt.properties)==null?void 0:tr.style)==null?void 0:qr.textStyle)==null?void 0:Vr.backgroundColor)||"#FFFFFF",backgroundOpacity:((fs=(fr=(Qn=rt.properties)==null?void 0:Qn.style)==null?void 0:fr.textStyle)==null?void 0:fs.backgroundOpacity)??1,bold:((An=(Ci=(Qr=rt.properties)==null?void 0:Qr.style)==null?void 0:Ci.textStyle)==null?void 0:An.bold)||!1,italic:((Vi=(Ui=(Pr=rt.properties)==null?void 0:Pr.style)==null?void 0:Ui.textStyle)==null?void 0:Vi.italic)||!1}},rotation:((dr=rt.properties)==null?void 0:dr.rotation)||0}}else if(rt instanceof $o){vn="Rectangle";const ln=rt.getBounds();ni={bounds:{southWest:[ln.getSouthWest().lng,ln.getSouthWest().lat],northEast:[ln.getNorthEast().lng,ln.getNorthEast().lat]},style:fn,name:((es=rt.properties)==null?void 0:es.name)||"",rotation:rt.getRotation(),width:rt.getDimensions().width,height:rt.getDimensions().height,center:[rt.getCenter().lng,rt.getCenter().lat]}}else if(rt instanceof wu||((Fs=rt.properties)==null?void 0:Fs.type)==="Semicircle"){vn="Semicircle";let ln;typeof rt.getLatLng=="function"?ln=rt.getLatLng():rt.getCenter&&typeof rt.getCenter=="function"?ln=rt.getCenter():rt._latlng?ln=rt._latlng:ln={lat:0,lng:0};const Jn=rt.getRadius?rt.getRadius():0,vr=((di=rt.properties)==null?void 0:di.startAngle)||0,sr=((co=rt.properties)==null?void 0:co.stopAngle)||180;ni={center:[ln.lng,ln.lat],radius:Jn,startAngle:vr,endAngle:sr,name:((mr=rt.properties)==null?void 0:mr.name)||"",style:fn}}else if(rt instanceof eh||((Er=rt.properties)==null?void 0:Er.type)==="CircleWithSections"){vn="CircleWithSections";const ln=rt.getLatLng(),Jn=rt.getRadius(),vr=rt.getSections();ni={center:[ln.lng,ln.lat],radius:Jn,name:((mi=rt.properties)==null?void 0:mi.name)||"",style:fn,sections:vr}}else if(rt instanceof wt.Circle)vn="Circle",ni={center:[rt.getLatLng().lng,rt.getLatLng().lat],radius:rt.getRadius(),name:((xn=rt.properties)==null?void 0:xn.name)||"",style:fn};else if(rt instanceof wt.Rectangle){vn="Rectangle";const ln=rt.getBounds();ni={bounds:{southWest:[ln.getSouthWest().lng,ln.getSouthWest().lat],northEast:[ln.getNorthEast().lng,ln.getNorthEast().lat]},name:((on=rt.properties)==null?void 0:on.name)||"",style:fn}}else rt instanceof wt.Polyline&&!(rt instanceof wt.Polygon)?((ii=rt.properties)==null?void 0:ii.type)==="ElevationLine"?(vn="ElevationLine",ni={points:rt.getLatLngs().map(Jn=>[Jn.lng,Jn.lat]),style:{...fn,color:((Xn=rt.properties.style)==null?void 0:Xn.color)||"#FF4500",weight:((jn=rt.properties.style)==null?void 0:jn.weight)||4,opacity:((rs=rt.properties.style)==null?void 0:rs.opacity)||.8},name:((Ps=rt.properties)==null?void 0:Ps.name)||"",elevationData:rt.properties.elevationData,samplePointStyle:rt.properties.samplePointStyle,minMaxPointStyle:rt.properties.minMaxPointStyle,minElevation:rt.properties.minElevation,maxElevation:rt.properties.maxElevation,elevationGain:rt.properties.elevationGain,elevationLoss:rt.properties.elevationLoss,averageSlope:rt.properties.averageSlope,maxSlope:rt.properties.maxSlope}):(vn="Line",ni={points:rt.getLatLngs().map(Jn=>[Jn.lng,Jn.lat]),name:((Tr=rt.properties)==null?void 0:Tr.name)||"",style:fn}):rt instanceof wt.Polygon&&!(rt instanceof wt.Rectangle)&&(vn="Polygon",ni={points:rt.getLatLngs()[0].map(Jn=>[Jn.lng,Jn.lat]),name:((so=rt.properties)==null?void 0:so.name)||"",style:fn});if(vn&&ni){let ln=rt._elementId;rt._dbId&&(ln=rt._dbId,typeof ln=="number"&&pn.add(ln)),We.push({id:ln,type_forme:vn,data:ni})}}),console.log("[savePlan] Éléments à sauvegarder",{totalElements:We.length,elements:We.map(rt=>({type:rt.type_forme,hasPoints:"points"in rt.data,hasStyle:"style"in rt.data}))});const _n=Array.from(Ut).filter(rt=>!pn.has(rt));r.elements=We;const mn=await r.saveToPlan(Ie.value.id,{elementsToDelete:_n});if(mn&&((Qe=Ie.value)!=null&&Qe.id)){const rt=Ie.value.id;Ie.value={...Ie.value,...mn},i.updatePlanDetails(rt,mn)}Ve.value="success",setTimeout(()=>{Ve.value=null},3e3)}catch(We){console.error("Erreur lors de la sauvegarde du plan:",We),Ve.value=null}finally{nt.value=!1}}Kh(()=>{O.user||Ce(),i.clearCurrentPlan(),r.clearCurrentPlan()});function he(Qe){E(Qe)}function te(Qe){try{const We=new Date(Qe);return isNaN(We.getTime())?(console.error("Date invalide reçue:",Qe),"Date invalide"):new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Paris"}).format(We)}catch(We){return console.error("Erreur lors du formatage de la date:",We),"Date invalide"}}const ie=()=>{b.value&&D()},ee=()=>{h.value&&b.value&&(_(""),b.value.removeLayer(h.value),h.value=null)};async function se(Qe){console.log(`onPlanCreated - Tentative de chargement du plan ${Qe}`),await i.fetchPlans();const We=i.getPlanById(Qe);We?(console.log(`Plan ${Qe} trouvé, chargement en cours...`),localStorage.setItem("lastPlanId",Qe.toString()),Ie.value=We,i.setCurrentPlan(We),r.setCurrentPlan(We.id),me.value=!1,je(),console.log(`Plan ${Qe} chargé avec succès`)):console.error(`Plan ${Qe} introuvable après création! Vérifiez les permissions.`)}So(R,async Qe=>{var We;if(Qe&&((We=O.user)==null?void 0:We.user_type)==="admin"){U.value=!0;try{const Ut=await O.fetchConcessionnaireAgriculteurs(Qe.id);ue.value=Array.isArray(Ut)?Ut:[Ut]}catch(Ut){console.error("[MapView][watch selectedConcessionnaire] Error:",Ut),ue.value=[]}finally{U.value=!1}}});function Ce(){localStorage.removeItem("lastPlanId")}function ne(Qe,We="m"){return We==="m²"?`${(Qe/1e4).toFixed(2)} ha`:We==="m"?Qe>=1e3?`${(Qe/1e3).toFixed(2)} km`:`${Qe.toFixed(2)} m`:`${Qe.toFixed(2)} ${We}`}const ae=un(!1);function xe(Qe){return{Circle:"Cercle",Rectangle:"Rectangle",Semicircle:"Demi-cercle",Line:"Ligne",Polygon:"Polygone",TextRectangle:"Annotation",ElevationLine:"Profil altimétrique"}[Qe]||Qe}async function ye(){var We,Ut,pn,_n,mn,rt,vn,ni,fn,Mn;if(!Ie.value||!g.value||!b.value){console.error("[generateSynthesis] Plan, map ou featureGroup manquant");return}const Qe=Ie.value;try{console.log("[generateSynthesis] Début de la génération"),console.log("[generateSynthesis] Plan courant complet:",Qe),await H();let Nn=Qe;if(!Qe.concessionnaire_details&&!Qe.usine_details&&!Qe.client_details){console.log("[generateSynthesis] Détails manquants, tentative de récupération...");try{const Qn=await Kn.get(`/plans/${Qe.id}/`);Qn.status===200&&(console.log("[generateSynthesis] Plan mis à jour:",Qn.data),Ie.value={...Qe,...Qn.data},Nn=Qn.data,i.updatePlanDetails(Qe.id,Qn.data))}catch(Qn){console.error("[generateSynthesis] Erreur lors de la récupération des détails:",Qn)}}await new Promise(Qn=>setTimeout(Qn,1e3)),ae.value=!0;const pi=Nn.concessionnaire_details,hr=Nn.client_details,bi=(pi==null?void 0:pi.usine_details)||Nn.usine_details;console.log("[generateSynthesis] Détails du plan utilisé:",Nn),console.log("[generateSynthesis] Détails des utilisateurs:",{concessionnaire:pi?{id:pi.id,nom:`${pi.first_name} ${pi.last_name}`,company:pi.company_name,logo:pi.logo}:null,usine:bi?{id:bi.id,nom:`${bi.first_name} ${bi.last_name}`,company:bi.company_name,logo:bi.logo}:null,client:hr?{id:hr.id,nom:`${hr.first_name} ${hr.last_name}`,company:hr.company_name}:null}),h.value&&($(),h.value=null);const Zt=new hi("l","mm","a4");console.log("[generateSynthesis] Chargement du logo de l'application");const yn=new Image;yn.src=Eg,await new Promise(Qn=>{yn.onload=()=>{console.log("[generateSynthesis] Logo application chargé"),Qn()},yn.onerror=fr=>{console.error("[generateSynthesis] Erreur chargement logo application:",fr),Qn()}}),console.log("[generateSynthesis] Tentative de chargement du logo usine:",bi==null?void 0:bi.logo);let er=null;bi!=null&&bi.logo&&(er=new Image,er.src=bi.logo,await new Promise(Qn=>{er?(er.onload=()=>{console.log("[generateSynthesis] Logo usine chargé avec succès"),Qn()},er.onerror=fr=>{console.error("[generateSynthesis] Erreur chargement logo usine:",fr),Qn()}):Qn()})),console.log("[generateSynthesis] Tentative de chargement du logo concessionnaire:",pi==null?void 0:pi.logo);let kr=null;pi!=null&&pi.logo&&(kr=new Image,kr.src=pi.logo,await new Promise(Qn=>{kr?(kr.onload=()=>{console.log("[generateSynthesis] Logo concessionnaire chargé avec succès"),Qn()},kr.onerror=fr=>{console.error("[generateSynthesis] Erreur chargement logo concessionnaire:",fr),Qn()}):Qn()})),console.log("[generateSynthesis] Ajout des logos au PDF:",{logoApplication:!0,logoUsine:er!==null,logoConcessionnaire:kr!==null}),er!==null&&Zt.addImage(er,"JPEG",148.5-40-30,20,40,40),Zt.addImage(yn,"JPEG",148.5-40/2,20,40,40),kr!==null&&Zt.addImage(kr,"JPEG",148.5+30,20,40,40),Zt.setFontSize(24),Zt.setTextColor(0),Zt.text(Qe.nom||"Sans titre",297/2,100,{align:"center"});let tr=120;if(bi&&(Zt.setFontSize(14),Zt.setFont("helvetica","bold"),Zt.text("Usine:",20,tr),Zt.setFont("helvetica","normal"),Zt.text(`${bi.first_name} ${bi.last_name}${bi.company_name?` (${bi.company_name})`:""}`,20,tr+6),tr+=15),pi&&(Zt.setFontSize(14),Zt.setFont("helvetica","bold"),Zt.text("Concessionnaire:",20,tr),Zt.setFont("helvetica","normal"),Zt.text(`${pi.first_name} ${pi.last_name}${pi.company_name?` (${pi.company_name})`:""}`,20,tr+6),tr+=15),hr&&(Zt.setFontSize(14),Zt.setFont("helvetica","bold"),Zt.text("Client:",20,tr),Zt.setFont("helvetica","normal"),Zt.text(`${hr.first_name} ${hr.last_name}${hr.company_name?` (${hr.company_name})`:""}`,20,tr+6),tr+=15),Qe.description){Zt.setFont("helvetica","bold"),Zt.text("Description:",20,tr),Zt.setFont("helvetica","normal");const Qn=Zt.splitTextToSize(Qe.description,150);Zt.text(Qn,20,tr+6),tr+=8*Qn.length+10}tr=Math.min(tr,180),Zt.setFontSize(10),Zt.setTextColor(100),Zt.text(`Date de création: ${te(Qe.date_creation)}`,20,190),Zt.text(`Dernière modification: ${te(Qe.date_modification)}`,277,190,{align:"right"});const qr=[];b.value.eachLayer(Qn=>qr.push(Qn));const Vr=wt.simpleMapScreenshoter({hideElementsWithSelectors:[".leaflet-control-container",".leaflet-pm-toolbar",".leaflet-grid-layer",".leaflet-grid-label"],preventDownload:!0}).addTo(g.value);await new Promise(Qn=>setTimeout(Qn,3e3));for(let Qn=0;Qn<qr.length;Qn++){Zt.addPage(),Zt.setFillColor(248,250,252),Zt.setDrawColor(226,232,240),Zt.rect(0,0,297,25,"F"),Zt.setFontSize(10),Zt.setTextColor(50,50,50),Zt.setFont("helvetica","bold"),Zt.text(Qe.nom||"Sans titre",20,12);let Qr=297-20-(15*(1+(er!==null?1:0)+(kr!==null?1:0))+5*(1+(er!==null?1:0)));er!==null&&(Zt.addImage(er,"JPEG",Qr,5,15,15),Qr+=20),Zt.addImage(yn,"JPEG",Qr,5,15,15),Qr+=20,kr!==null&&Zt.addImage(kr,"JPEG",Qr,5,15,15),Zt.setDrawColor(200,200,200),Zt.setLineWidth(.5),Zt.line(0,25,297,25);const Ci=qr[Qn],An=Ci.properties;if(An){Zt.setTextColor(0),Zt.setFontSize(14),Zt.setFont("helvetica","bold");const Pr=An.name||xe(An.type);let Ui="";if(An.type!=="TextRectangle"){const dr=Q(qr,Ci);Ui=dr>0?` (surface totale d'irrigation : ${ne(dr,"m²")})`:""}const Vi=`${Pr}${Ui}`;Zt.text(Vi,20,35)}if(An&&An.type==="ElevationLine")try{const Pr=((We=Ci.getBounds)==null?void 0:We.call(Ci))||((Ut=Ci.getLatLng)==null?void 0:Ut.call(Ci));Pr&&g.value.fitBounds(Pr instanceof wt.LatLng?wt.latLngBounds([Pr]):Pr,{padding:[50,50]});try{const xn=((pn=Ci.getBounds)==null?void 0:pn.call(Ci))||((_n=Ci.getLatLng)==null?void 0:_n.call(Ci));if(!xn||!g.value)console.warn("[generateSynthesis] Bounds ou carte invalide");else{const on=xn instanceof wt.LatLng?wt.latLngBounds([xn]):xn;on&&on.isValid&&on.isValid()&&g.value.getContainer()&&document.body.contains(g.value.getContainer())&&g.value.fitBounds(on,{padding:[50,50],animate:!1})}}catch(xn){console.warn("[generateSynthesis] Erreur lors de l'ajustement de la vue:",xn)}await new Promise(xn=>setTimeout(xn,2e3)),g.value.invalidateSize();try{g.value&&g.value.getContainer()&&document.body.contains(g.value.getContainer())?g.value.invalidateSize({animate:!1}):console.warn("[generateSynthesis] Carte non valide pour l'invalidation de taille")}catch(xn){console.warn("[generateSynthesis] Erreur lors de l'invalidation de la taille de la carte:",xn)}await new Promise(xn=>{const on=()=>{var rs;const ii=(rs=g.value)==null?void 0:rs.getContainer();if(!ii){xn();return}const Xn=ii.querySelectorAll(".leaflet-tile-loaded");ii.querySelectorAll(".leaflet-tile-loading").length===0&&Xn.length>0?xn():setTimeout(on,100)};on()});const Ui=await Vr.takeScreen("image"),Vi=await new Promise((xn,on)=>{const ii=new Image;ii.onload=()=>xn(ii),ii.onerror=Xn=>on(Xn),ii.src=Ui}),dr=40,es=237/2,Fs=Math.min(70,Vi.height*es/Vi.width);if(Zt.addImage(Vi,"PNG",20,dr,es,Fs),An.elevationData&&An.elevationData.length>0){const xn=document.createElement("canvas");xn.width=800,xn.height=400;const on=xn.getContext("2d");if(on){const ii=An.elevationData,Xn=An.minElevation,jn=An.maxElevation,Ps=(jn-Xn)*.05,Tr=Xn-Ps,so=jn+Ps,ln=40,Jn=xn.width-2*ln,vr=xn.height-2*ln,sr=Wi=>ln+Wi/ii[ii.length-1].distance*Jn,pr=Wi=>ln+vr-(Wi-Tr)/(so-Tr)*vr;on.fillStyle="#f8fafc",on.fillRect(0,0,xn.width,xn.height),on.fillStyle="#334155",on.font="bold 20px Arial",on.textAlign="center",on.fillText("Profil altimétrique",xn.width/2,25),on.strokeStyle="#e2e8f0",on.lineWidth=1,on.beginPath(),on.moveTo(ln,ln),on.lineTo(ln,vr+ln),on.lineTo(Jn+ln,vr+ln),on.strokeStyle="#94a3b8",on.stroke();const Ea=5;for(let Wi=0;Wi<=Ea;Wi++){const ds=Tr+Wi/Ea*(so-Tr),ps=pr(ds);on.beginPath(),on.strokeStyle="#e2e8f0",on.moveTo(ln,ps),on.lineTo(Jn+ln,ps),on.stroke(),on.beginPath(),on.strokeStyle="#94a3b8",on.moveTo(ln-5,ps),on.lineTo(ln,ps),on.stroke(),on.fillStyle="#64748b",on.font="12px Arial",on.textAlign="right",on.fillText(`${Math.round(ds)}m`,ln-8,ps+4)}const Ao=5,ho=ii[ii.length-1].distance;for(let Wi=0;Wi<=Ao;Wi++){const ds=Wi/Ao*ho,ps=sr(ds);on.beginPath(),on.strokeStyle="#e2e8f0",on.moveTo(ps,ln),on.lineTo(ps,vr+ln),on.stroke(),on.beginPath(),on.strokeStyle="#94a3b8",on.moveTo(ps,vr+ln),on.lineTo(ps,vr+ln+5),on.stroke(),on.fillStyle="#64748b",on.font="12px Arial",on.textAlign="center",on.fillText(`${Math.round(ds)}m`,ps,vr+ln+16)}const ar=on.createLinearGradient(0,ln,0,vr+ln);ar.addColorStop(0,"rgba(255, 69, 0, 0.8)"),ar.addColorStop(1,"rgba(255, 69, 0, 0.2)"),on.beginPath(),on.moveTo(sr(ii[0].distance),pr(ii[0].elevation)),ii.forEach((Wi,ds)=>{ds>0&&on.lineTo(sr(Wi.distance),pr(Wi.elevation))}),on.strokeStyle="#FF4500",on.lineWidth=2,on.stroke(),on.lineTo(sr(ii[ii.length-1].distance),pr(Tr)),on.lineTo(sr(ii[0].distance),pr(Tr)),on.closePath(),on.fillStyle=ar,on.fill(),ii.forEach(Wi=>{on.beginPath(),on.arc(sr(Wi.distance),pr(Wi.elevation),3,0,Math.PI*2),on.fillStyle="#FF4500",on.fill(),on.strokeStyle="white",on.lineWidth=1,on.stroke()});let Es=0,oo=0;for(let Wi=0;Wi<ii.length;Wi++)ii[Wi].elevation===Xn&&(Es=Wi),ii[Wi].elevation===jn&&(oo=Wi);on.beginPath(),on.arc(sr(ii[oo].distance),pr(ii[oo].elevation),6,0,Math.PI*2),on.fillStyle="#059669",on.fill(),on.strokeStyle="white",on.lineWidth=2,on.stroke(),on.beginPath(),on.arc(sr(ii[Es].distance),pr(ii[Es].elevation),6,0,Math.PI*2),on.fillStyle="#DC2626",on.fill(),on.strokeStyle="white",on.lineWidth=2,on.stroke(),on.font="12px Arial",on.fillStyle="#059669",on.textAlign="left",on.fillText(`Point haut: ${ne(jn,"m")}`,ln,vr+ln+35),on.fillStyle="#DC2626",on.fillText(`Point bas: ${ne(Xn,"m")}`,ln+200,vr+ln+35);const As=xn.toDataURL("image/png");Zt.addImage(As,"PNG",20+es+20,dr,es,Fs)}}const di=dr+Fs+15;Zt.setFillColor(248,250,252),Zt.setDrawColor(226,232,240),Zt.roundedRect(20,di,257,50,3,3,"FD"),Zt.setFont("helvetica","bold"),Zt.setFontSize(12),Zt.setTextColor(51,65,85),Zt.text("Caractéristiques",30,di+10);const co=[{label:"Distance totale",value:ne(An.length||0)},{label:"Dénivelé positif",value:ne(An.elevationGain||0,"m")},{label:"Dénivelé négatif",value:ne(An.elevationLoss||0,"m")}],mr=[{label:"Pente moyenne",value:`${(An.averageSlope||0).toFixed(1)}%`},{label:"Pente maximale",value:`${(An.maxSlope||0).toFixed(1)}%`},{label:"Altitude min/max",value:`${ne(An.minElevation||0,"m")} / ${ne(An.maxElevation||0,"m")}`}];let Er=di+20;Zt.setFont("helvetica","normal"),Zt.setFontSize(10),co.forEach(xn=>{Zt.setTextColor(100,116,139),Zt.text(xn.label,30,Er),Zt.setTextColor(15,23,42),Zt.setFont("helvetica","bold"),Zt.text(xn.value,110,Er),Zt.setFont("helvetica","normal"),Er+=9}),Er=di+20;const mi=297/2;mr.forEach(xn=>{Zt.setTextColor(100,116,139),Zt.text(xn.label,mi,Er),Zt.setTextColor(15,23,42),Zt.setFont("helvetica","bold"),Zt.text(xn.value,mi+80,Er),Zt.setFont("helvetica","normal"),Er+=9})}catch(Pr){console.error("[generateSynthesis] Erreur traitement profil altimétrique:",Pr)}else{const Pr=((mn=Ci.getBounds)==null?void 0:mn.call(Ci))||((rt=Ci.getLatLng)==null?void 0:rt.call(Ci));Pr&&g.value.fitBounds(Pr instanceof wt.LatLng?wt.latLngBounds([Pr]):Pr,{padding:[50,50]});try{const Ui=((vn=Ci.getBounds)==null?void 0:vn.call(Ci))||((ni=Ci.getLatLng)==null?void 0:ni.call(Ci));if(!Ui||!g.value)console.warn("[generateSynthesis] Bounds ou carte invalide");else{const Vi=Ui instanceof wt.LatLng?wt.latLngBounds([Ui]):Ui;Vi&&Vi.isValid&&Vi.isValid()&&g.value.getContainer()&&document.body.contains(g.value.getContainer())&&g.value.fitBounds(Vi,{padding:[50,50],animate:!1})}}catch(Ui){console.warn("[generateSynthesis] Erreur lors de l'ajustement de la vue:",Ui)}await new Promise(Ui=>setTimeout(Ui,2e3)),g.value.invalidateSize(),await new Promise(Ui=>{const Vi=()=>{var di;const dr=(di=g.value)==null?void 0:di.getContainer();if(!dr){Ui();return}const es=dr.querySelectorAll(".leaflet-tile-loaded");dr.querySelectorAll(".leaflet-tile-loading").length===0&&es.length>0?Ui():setTimeout(Vi,100)};Vi()});try{const Ui=await Vr.takeScreen("image"),Vi=await new Promise((di,co)=>{const mr=new Image;mr.onload=()=>di(mr),mr.onerror=Er=>co(Er),mr.src=Ui}),dr=45,es=297*.6-30;let Fs=Vi.height*es/Vi.width;if(Fs>210*.9&&(Fs=210*.9),Zt.addImage(Vi,"PNG",20,dr,es,Fs),An){let di=function(on,ii,Xn,jn,rs){Zt.setTextColor(100,116,139),Zt.setFont("helvetica","normal"),Zt.text(on,Xn+10,jn),Zt.setTextColor(15,23,42),Zt.setFont("helvetica","bold"),Zt.text(ii,Xn+rs-10,jn,{align:"right"})},mr=0;if(An.type==="Circle")mr=4;else if(An.type==="Rectangle")mr=4;else if(An.type==="Line")mr=1,(fn=An.dimensions)!=null&&fn.width&&mr++,An.surfaceInfluence&&mr++;else if(An.type==="Semicircle")mr=6;else if(An.type==="Polygon")mr=2;else if(An.type==="CircleWithSections"&&(mr=3,An.sections&&An.sections.length>0)){const on=Math.ceil(An.sections.length/3);mr+=on*3}const Er=Math.max(15+mr*12+30,60),mi=297-188.2-20;Zt.setFillColor(248,250,252),Zt.setDrawColor(226,232,240),Zt.roundedRect(188.2,dr,mi,Er,3,3,"FD"),Zt.setFont("helvetica","bold"),Zt.setFontSize(12),Zt.setTextColor(51,65,85),Zt.text("Caractéristiques",188.2+10,dr+15);let xn=dr+30;Zt.setFontSize(10),An.type==="Circle"?(di("Rayon",ne(An.radius),188.2,xn,mi),xn+=12,di("Diamètre",ne(An.radius*2),188.2,xn,mi),xn+=12,di("Surface",ne(An.surface,"m²"),188.2,xn,mi),xn+=12,di("Périmètre",ne(An.perimeter),188.2,xn,mi)):An.type==="Rectangle"?(di("Largeur",ne(An.width),188.2,xn,mi),xn+=12,di("Hauteur",ne(An.height),188.2,xn,mi),xn+=12,di("Surface",ne(An.surface,"m²"),188.2,xn,mi),xn+=12,di("Périmètre",ne(An.perimeter),188.2,xn,mi)):An.type==="Line"?(di("Longueur",ne(An.length),188.2,xn,mi),xn+=12,(Mn=An.dimensions)!=null&&Mn.width&&(di("Largeur d'influence",ne(An.dimensions.width),188.2,xn,mi),xn+=12),An.surfaceInfluence&&di("Surface d'influence",ne(An.surfaceInfluence,"m²"),188.2,xn,mi)):An.type==="Semicircle"?(di("Rayon",ne(An.radius),188.2,xn,mi),xn+=12,di("Diamètre",ne(An.radius*2),188.2,xn,mi),xn+=12,di("Surface",ne(An.surface,"m²"),188.2,xn,mi),xn+=12,di("Périmètre",ne(An.perimeter),188.2,xn,mi),xn+=12,di("Longueur d'arc",ne(An.arcLength),188.2,xn,mi),xn+=12,di("Angle d'ouverture",`${An.openingAngle.toFixed(1)}°`,188.2,xn,mi)):An.type==="Polygon"?(di("Surface",ne(An.surface,"m²"),188.2,xn,mi),xn+=12,di("Périmètre",ne(An.perimeter),188.2,xn,mi)):An.type==="CircleWithSections"&&(di("Rayon",ne(An.radius),188.2,xn,mi),xn+=12,di("Surface totale",ne(An.surface,"m²"),188.2,xn,mi),xn+=12,di("Périmètre",ne(An.perimeter),188.2,xn,mi),xn+=20,An.sections&&An.sections.length>0&&(xn=Qt(An.sections,Zt,188.2,xn,mi)))}}catch(Ui){console.error(`[generateSynthesis] Erreur capture forme ${Qn+1}:`,Ui)}}}g.value.removeControl(Vr),Zt.save(`synthese_${Qe.nom}.pdf`)}catch(Sr){console.error("[generateSynthesis] Erreur:",Sr),alert("Une erreur est survenue lors de la génération de la synthèse. Veuillez réessayer.")}finally{ae.value=!1}}const le=w4.debounce(()=>{const Qe=Ct.startMeasure("invalidateMapSize","MapView");if(!g.value){Qe();return}Ds(()=>{Ct.measure("invalidateMapSize:nextTick",()=>{var We;try{if(g.value&&g.value.getContainer()&&document.body.contains(g.value.getContainer())){if(g.value.invalidateSize({animate:!1}),(We=b.value)!=null&&We.getLayers().length)try{D()}catch(Ut){console.warn("[invalidateMapSize] Erreur lors de l'ajustement de la vue:",Ut)}}else console.warn("[invalidateMapSize] Carte non valide pour l'invalidation")}catch(Ut){console.warn("[invalidateMapSize] Erreur lors de l'invalidation de la taille de la carte:",Ut)}Qe()},"MapView")})},250);function je(){le()}So(Ie,(Qe,We)=>{Qe&&Qe.id!==(We==null?void 0:We.id)&&Ds(()=>{je()})});const Re=un(null),Ae=un(!1),qe=un([]),Oe=Ni(()=>{if(console.log("[MapView][filteredConcessionnaires] Computing with:",{selectedUsine:Re.value,concessionnaires:W.value,concessionnairesLength:W.value.length}),!Re.value)return[];const Qe=W.value.filter(We=>{var _n,mn,rt;const Ut=We.usine,pn=typeof Ut=="object"&&Ut!==null?Ut.id:Ut;return console.log("[MapView][filteredConcessionnaires] Checking concessionnaire:",{concessionnaire:We,concessionnaireUsine:Ut,concessionnaireUsineId:pn,selectedUsineId:(_n=Re.value)==null?void 0:_n.id,matches:pn===((mn=Re.value)==null?void 0:mn.id)}),pn===((rt=Re.value)==null?void 0:rt.id)});return console.log("[MapView][filteredConcessionnaires] Filtered result:",Qe),Qe});function et(Qe){if(!Qe)return"";const We=Qe.first_name||"",Ut=Qe.last_name?Qe.last_name.toUpperCase():"",pn=Qe.company_name||Qe.role||"";return`${We} ${Ut} (${pn})`}async function Je(){Ae.value=!0;try{const Qe=await Kn.get("/users/",{params:{role:"USINE"}});qe.value=Qe.data}catch(Qe){console.error("[MapView] Error loading usines:",Qe),qe.value=[]}finally{Ae.value=!1}}async function mt(Qe){console.log("[MapView][selectUsine] Sélection de l'usine:",Qe),Re.value=Qe,V.value=!0;try{console.log("[MapView][selectUsine] Envoi de la requête avec params:",{role:"CONCESSIONNAIRE",usine:Qe.id});const We=await Kn.get("/users/",{params:{role:"CONCESSIONNAIRE",usine:Qe.id}});console.log("[MapView][selectUsine] Réponse reçue:",We.data),W.value=We.data,console.log("[MapView][selectUsine] Concessionnaires mis à jour:",W.value)}catch(We){console.error("[MapView] Error loading concessionnaires for usine:",We),W.value=[]}finally{V.value=!1}}function _t(){Re.value=null,R.value=null,J.value=null,W.value=[],ue.value=[],z.value=[]}function $t(){R.value=null,J.value=null,ue.value=[],z.value=[]}function Xt(){J.value=null,z.value=[]}async function Xe(Qe){var We,Ut,pn,_n,mn,rt;console.log(`
[MapView][selectConcessionnaire] ====== DÉBUT SÉLECTION CONCESSIONNAIRE ======`),console.log("Informations du concessionnaire:",{id:Qe.id,username:Qe.username,company:Qe.company_name,role:Qe.role}),console.log("Contexte utilisateur:",{userType:(We=O.user)==null?void 0:We.user_type,userId:(Ut=O.user)==null?void 0:Ut.id,userRole:(pn=O.user)==null?void 0:pn.role,selectedUsineId:(_n=Re.value)==null?void 0:_n.id}),R.value=Qe,U.value=!0;try{const vn={role:"AGRICULTEUR",concessionnaire:Qe.id};O.isUsine?(console.log("Ajout de l'ID de l'usine connectée:",(mn=O.user)==null?void 0:mn.id),vn.usine=(rt=O.user)==null?void 0:rt.id):Re.value&&(console.log("Ajout de l'ID de l'usine sélectionnée:",Re.value.id),vn.usine=Re.value.id),console.log("Paramètres de la requête:",vn);const ni=await Kn.get("/users/",{params:vn});console.log("Réponse reçue du serveur:",{status:ni.status,dataLength:Array.isArray(ni.data)?ni.data.length:"non-array",data:ni.data}),Array.isArray(ni.data)?(ue.value=ni.data,console.log(`${ni.data.length} agriculteurs chargés`),ni.data.forEach((fn,Mn)=>{console.log(`Agriculteur ${Mn+1}:`,{id:fn.id,username:fn.username,company:fn.company_name,concessionnaire:fn.concessionnaire})})):(console.warn("Format de réponse inattendu:",ni.data),ue.value=[]),ue.value.length===0&&console.warn("Aucun agriculteur trouvé pour ce concessionnaire")}catch(vn){if(console.error("ERREUR lors du chargement des agriculteurs:",vn),vn&&typeof vn=="object"&&"response"in vn){const ni=vn;console.error("Détails de l'erreur:",{status:ni.response.status,data:ni.response.data})}ue.value=[]}finally{U.value=!1,console.log(`[MapView][selectConcessionnaire] ====== FIN SÉLECTION CONCESSIONNAIRE ======
`)}}async function Kt(Qe){var We;J.value=Qe,Y.value=!0;try{const Ut={agriculteur:Qe.id};O.isUsine?Ut.usine=(We=O.user)==null?void 0:We.id:Re.value&&(Ut.usine=Re.value.id),R.value&&(Ut.concessionnaire=R.value.id);const pn=await Kn.get("/plans/",{params:Ut});z.value=pn.data}catch(Ut){console.error("[MapView] Error loading client plans:",Ut),z.value=[]}finally{Y.value=!1}}function Qt(Qe,We,Ut,pn,_n){if(!Qe||Qe.length===0)return pn;const mn=[...Qe].sort((Mt,On)=>(On.surface||0)-(Mt.surface||0)),rt=_n,vn=7,ni=6,fn=2,Mn=[{header:"Nom",width:.3,align:"left"},{header:"Surface",width:.2,align:"right"},{header:"Angles",width:.25,align:"right"},{header:"Rayon",width:.15,align:"right"},{header:"Type",width:.1,align:"center"}],Sr=vn+ni*mn.length;We.setFillColor(248,250,252),We.setDrawColor(226,232,240),We.roundedRect(Ut,pn,rt,Sr+fn*2,2,2,"FD"),We.setFillColor(241,245,249),We.rect(Ut+fn,pn+fn,rt-fn*2,vn,"F"),We.setFont("helvetica","bold"),We.setFontSize(7),We.setTextColor(51,65,85);let Ii=Ut+fn;return Mn.forEach(Mt=>{const On=Mt.width*(rt-fn*2);Mt.align==="right"?We.text(Mt.header,Ii+On-fn,pn+fn+5,{align:"right"}):Mt.align==="center"?We.text(Mt.header,Ii+On/2,pn+fn+5,{align:"center"}):We.text(Mt.header,Ii+fn/2,pn+fn+5),Ii+=On}),We.setFont("helvetica","normal"),We.setFontSize(6.5),We.setTextColor(71,85,105),mn.forEach((Mt,On)=>{const Fi=pn+vn+fn+On*ni;On%2===0&&(We.setFillColor(250,252,254),We.rect(Ut+fn,Fi,rt-fn*2,ni,"F"));let zi=Ut+fn;const Xr=Mt.name||`Section ${On+1}`;We.text(Xr,zi+fn/2,Fi+4),zi+=Mn[0].width*(rt-fn*2);const $r=ne(Mt.surface||0,"m²");We.text($r,zi+Mn[1].width*(rt-fn*2)-fn,Fi+4,{align:"right"}),zi+=Mn[1].width*(rt-fn*2);const Nn=Mt.startAngle===0&&Mt.endAngle===360?"Complet":`${Mt.startAngle}°-${Mt.endAngle}°`;We.text(Nn,zi+Mn[2].width*(rt-fn*2)-fn,Fi+4,{align:"right"}),zi+=Mn[2].width*(rt-fn*2);const pi=ne(Mt.radius||0);We.text(pi,zi+Mn[3].width*(rt-fn*2)-fn,Fi+4,{align:"right"}),zi+=Mn[3].width*(rt-fn*2);const hr=Mt.startAngle===0&&Mt.endAngle===360?"C":"P";We.text(hr,zi+Mn[4].width*(rt-fn*2)/2,Fi+4,{align:"center"})}),We.setDrawColor(226,232,240),We.setLineWidth(.05),We.line(Ut+fn,pn+vn+fn,Ut+rt-fn,pn+vn+fn),pn+Sr+fn*2}return(Qe,We)=>{var Ut,pn,_n,mn;return Ye(),tt("div",AN,[M("div",MN,[ae.value?(Ye(),tt("div",kN,We[8]||(We[8]=[wc('<div class="bg-white/90 rounded-2xl p-8 max-w-md shadow-2xl border border-gray-100"><div class="flex flex-col items-center"><div class="relative w-24 h-24 mb-6"><div class="absolute inset-0 border-4 border-primary-200 rounded-full"></div><div class="absolute inset-0 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"></div><div class="absolute inset-2 border-2 border-primary-400/30 rounded-full animate-pulse"></div><div class="absolute inset-0 flex items-center justify-center"><svg class="w-8 h-8 text-primary-600 animate-bounce" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div></div><h3 class="text-xl font-semibold text-gray-900 mb-2"> Génération de la synthèse </h3><div class="space-y-2 text-center"><p class="text-primary-600 font-medium"> Capture des formes en cours... </p><p class="text-sm text-gray-500"> Nous optimisons la qualité de vos captures pour un rendu parfait </p></div></div></div>',1)]))):wn("",!0),Ie.value?wn("",!0):(Ye(),tt("div",TN,[M("div",BN,[We[11]||(We[11]=wc('<div class="relative w-48 h-48 mx-auto mb-12 rounded-full bg-gradient-to-br from-primary-100 to-primary-50 p-8 shadow-lg ring-4 ring-white"><img src="'+Eg+'" alt="TagMap Logo" class="w-full h-full object-contain filter drop-shadow-md"><div class="absolute inset-0 rounded-full bg-gradient-to-t from-transparent to-white/10 pointer-events-none"></div></div><h1 class="text-3xl font-bold text-gray-900 mb-4">Bienvenue sur TagMap</h1><p class="text-gray-600 mb-8">Pour commencer à dessiner, vous devez d&#39;abord créer un nouveau plan ou charger un plan existant.</p>',3)),M("div",NN,[M("button",{onClick:We[0]||(We[0]=rt=>me.value=!0),class:"w-full flex items-center justify-center px-4 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors duration-200"},We[9]||(We[9]=[M("svg",{class:"w-6 h-6 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),Br(" Créer un nouveau plan ")])),M("button",{onClick:We[1]||(We[1]=rt=>Se.value=!0),class:"w-full flex items-center justify-center px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors duration-200"},We[10]||(We[10]=[M("svg",{class:"w-6 h-6 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),Br(" Charger un plan existant ")]))])])])),Dn(M("div",RN,[(Ye(),Su(P0,{to:"body"},[Ie.value&&!ae.value?(Ye(),tt("div",DN,[Yr(r7,{"last-save":(Ut=Ie.value)!=null&&Ut.date_modification?new Date(Ie.value.date_modification):void 0,"plan-name":(pn=Ie.value)==null?void 0:pn.nom,"plan-description":(_n=Ie.value)==null?void 0:_n.description,"save-status":Ve.value,onChangeMapType:Wn(G),onCreateNewPlan:We[2]||(We[2]=rt=>me.value=!0),onLoadPlan:We[3]||(We[3]=rt=>Se.value=!0),onSavePlan:H,onAdjustView:ie,onGenerateSummary:ye},null,8,["last-save","plan-name","plan-description","save-status","onChangeMapType"])])):wn("",!0)])),M("div",ON,[M("div",IN,[M("div",{ref_key:"mapContainer",ref:t,class:"absolute inset-0 z-[1000]"},null,512)]),Ie.value&&!ae.value?(Ye(),tt("div",FN,[Yr(CB,{"current-tool":Wn(l),"selected-shape":Pe.value,"all-layers":((mn=Wn(b))==null?void 0:mn.getLayers())||[],onToolChange:Wn(_),onStyleUpdate:Wn(x),onPropertiesUpdate:he,onDeleteShape:ee},null,8,["current-tool","selected-shape","all-layers","onToolChange","onStyleUpdate"])])):wn("",!0)]),ae.value?(Ye(),tt("div",zN,We[12]||(We[12]=[wc('<div class="text-center"><div class="mb-4"><svg class="animate-spin h-10 w-10 mx-auto text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></div><p class="text-lg font-medium text-gray-900">Génération de la synthèse en cours...</p><p class="text-sm text-gray-500 mt-2">Veuillez patienter pendant que nous analysons votre plan.</p></div>',1)]))):wn("",!0)],512),[[_f,Ie.value]]),(Ye(),Su(P0,{to:"body"},[Yr(L4,{ref_key:"newPlanModalRef",ref:ce,modelValue:me.value,"onUpdate:modelValue":We[4]||(We[4]=rt=>me.value=rt),onCreated:se,onConcessionnaireSelected:We[5]||(We[5]=rt=>R.value=rt),onClientSelected:We[6]||(We[6]=rt=>J.value=rt)},null,8,["modelValue"])])),(Ye(),Su(P0,{to:"body"},[Se.value?(Ye(),tt("div",jN,[M("div",UN,[M("div",$N,[We[14]||(We[14]=M("h2",{class:"text-xl font-semibold text-gray-900"},"Charger un plan existant",-1)),M("button",{onClick:We[7]||(We[7]=rt=>Se.value=!1),class:"text-gray-400 hover:text-gray-500 focus:outline-none"},We[13]||(We[13]=[M("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),M("div",qN,[Wn(O).isAdmin?(Ye(),tt("div",VN,[Re.value?R.value?J.value?(Ye(),tt("div",lR,[M("div",uR,[M("button",{onClick:Xt,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},We[29]||(We[29]=[M("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),Br(" Retour à la liste des clients ")])),We[30]||(We[30]=M("span",{class:"mx-2 text-gray-400"},"|",-1)),M("span",cR,Ht(et(J.value)),1)]),We[32]||(We[32]=M("h3",{class:"font-medium text-gray-700"},"Plans disponibles",-1)),M("div",hR,[Y.value?(Ye(),tt(zn,{key:0},Ti(3,rt=>M("div",{key:rt,class:"animate-pulse"},We[31]||(We[31]=[M("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[M("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),M("div",{class:"h-4 bg-gray-100 rounded w-2/3 mb-2"}),M("div",{class:"h-3 bg-gray-50 rounded w-1/3"})],-1)]))),64)):(Ye(!0),tt(zn,{key:1},Ti(z.value,rt=>(Ye(),tt("button",{key:rt.id,onClick:vn=>B(rt.id),class:"w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[M("div",dR,Ht(rt.nom),1),M("div",pR,Ht(rt.description),1),M("div",gR," Modifié le "+Ht(te(rt.date_modification)),1)],8,fR))),128))])])):(Ye(),tt("div",tR,[M("div",nR,[M("button",{onClick:$t,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},We[23]||(We[23]=[M("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),Br(" Retour à la liste des concessionnaires ")])),We[24]||(We[24]=M("span",{class:"mx-2 text-gray-400"},"|",-1)),M("span",iR,Ht(et(R.value)),1)]),We[28]||(We[28]=M("h3",{class:"font-medium text-gray-700"},"Sélectionnez un agriculteur",-1)),M("div",rR,[U.value?(Ye(),tt(zn,{key:0},Ti(3,rt=>M("div",{key:rt,class:"animate-pulse"},We[25]||(We[25]=[M("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[M("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),M("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(Ye(),tt(zn,{key:1},[re.value.length===0?(Ye(),tt("div",sR,We[26]||(We[26]=[M("div",{class:"text-gray-500 mb-2"},"Aucun agriculteur trouvé pour ce concessionnaire",-1),M("div",{class:"text-sm text-gray-400"}," Veuillez vérifier que des agriculteurs ont été assignés à ce concessionnaire ",-1)]))):(Ye(!0),tt(zn,{key:1},Ti(re.value,rt=>(Ye(),tt("button",{key:rt.id,onClick:vn=>Kt(rt),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[M("div",null,[M("div",aR,Ht(et(rt)),1)]),We[27]||(We[27]=M("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,oR))),128))],64))])])):(Ye(),tt("div",KN,[M("div",JN,[M("button",{onClick:_t,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},We[18]||(We[18]=[M("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),Br(" Retour à la liste des usines ")])),We[19]||(We[19]=M("span",{class:"mx-2 text-gray-400"},"|",-1)),M("span",YN,Ht(et(Re.value)),1)]),We[22]||(We[22]=M("h3",{class:"font-medium text-gray-700"},"Sélectionnez un concessionnaire",-1)),M("div",XN,[V.value?(Ye(),tt(zn,{key:0},Ti(3,rt=>M("div",{key:rt,class:"animate-pulse"},We[20]||(We[20]=[M("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[M("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),M("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(Ye(!0),tt(zn,{key:1},Ti(Oe.value,rt=>(Ye(),tt("button",{key:rt.id,onClick:vn=>Xe(rt),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[M("div",null,[M("div",eR,Ht(et(rt)),1)]),We[21]||(We[21]=M("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,QN))),128))])])):(Ye(),tt("div",GN,[We[17]||(We[17]=M("h3",{class:"font-medium text-gray-700"},"Sélectionnez une usine",-1)),M("div",HN,[Ae.value?(Ye(),tt(zn,{key:0},Ti(3,rt=>M("div",{key:rt,class:"animate-pulse"},We[15]||(We[15]=[M("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[M("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),M("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(Ye(!0),tt(zn,{key:1},Ti(qe.value,rt=>(Ye(),tt("button",{key:rt.id,onClick:vn=>mt(rt),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[M("div",null,[M("div",ZN,Ht(et(rt)),1)]),We[16]||(We[16]=M("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,WN))),128))])]))])):Wn(O).isConcessionnaire?(Ye(),tt("div",mR,[J.value?(Ye(),tt("div",xR,[M("div",LR,[M("button",{onClick:Xt,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},We[37]||(We[37]=[M("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),Br(" Retour à la liste des clients ")])),We[38]||(We[38]=M("span",{class:"mx-2 text-gray-400"},"|",-1)),M("span",CR,Ht(et(J.value)),1)]),We[40]||(We[40]=M("h3",{class:"font-medium text-gray-700"},"Plans disponibles",-1)),M("div",SR,[Y.value?(Ye(),tt(zn,{key:0},Ti(3,rt=>M("div",{key:rt,class:"animate-pulse"},We[39]||(We[39]=[M("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[M("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),M("div",{class:"h-4 bg-gray-100 rounded w-2/3 mb-2"}),M("div",{class:"h-3 bg-gray-50 rounded w-1/3"})],-1)]))),64)):(Ye(!0),tt(zn,{key:1},Ti(z.value,rt=>(Ye(),tt("button",{key:rt.id,onClick:vn=>B(rt.id),class:"w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[M("div",ER,Ht(rt.nom),1),M("div",AR,Ht(rt.description),1),M("div",MR," Modifié le "+Ht(te(rt.date_modification)),1)],8,PR))),128))])])):(Ye(),tt("div",vR,[We[36]||(We[36]=M("h3",{class:"font-medium text-gray-700"},"Sélectionnez un agriculteur",-1)),M("div",yR,[U.value?(Ye(),tt(zn,{key:0},Ti(3,rt=>M("div",{key:rt,class:"animate-pulse"},We[33]||(We[33]=[M("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[M("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),M("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(Ye(),tt(zn,{key:1},[re.value.length===0?(Ye(),tt("div",_R,We[34]||(We[34]=[M("div",{class:"text-gray-500 mb-2"},"Aucun agriculteur trouvé pour ce concessionnaire",-1),M("div",{class:"text-sm text-gray-400"}," Veuillez vérifier que des agriculteurs ont été assignés à ce concessionnaire ",-1)]))):(Ye(!0),tt(zn,{key:1},Ti(re.value,rt=>(Ye(),tt("button",{key:rt.id,onClick:vn=>Kt(rt),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[M("div",null,[M("div",wR,Ht(et(rt)),1)]),We[35]||(We[35]=M("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,bR))),128))],64))])]))])):Wn(O).isUsine?(Ye(),tt("div",kR,Ht(Wn(O).isUsine?"...":""),1)):(Ye(),tt("div",TR,[Wn(i).plans.length===0?(Ye(),tt("div",BR,We[41]||(We[41]=[M("p",{class:"text-gray-500"},"Aucun plan disponible",-1)]))):(Ye(),tt("div",NR,[(Ye(!0),tt(zn,null,Ti(Wn(i).plans,rt=>(Ye(),tt("button",{key:rt.id,onClick:vn=>B(rt.id),class:"w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[M("div",DR,Ht(rt.nom),1),M("div",OR,Ht(rt.description),1),M("div",IR," Modifié le "+Ht(te(rt.date_modification)),1)],8,RR))),128))]))]))])])])):wn("",!0)]))])])}}}),FR={class:"fixed inset-0 z-50 overflow-y-auto"},zR={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0"},jR={class:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"},UR={class:"mt-3 text-center sm:mt-0 sm:text-left"},$R={class:"text-lg leading-6 font-medium text-gray-900",id:"modal-headline"},qR={class:"mt-4"},VR={key:0,class:"mb-4 rounded-md bg-red-50 p-4"},GR={class:"flex"},HR={class:"ml-3"},WR={class:"text-sm font-medium text-red-800"},ZR={key:0},KR={key:1},JR=["value"],YR={key:2},XR={key:3},QR=["value"],eD={class:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-2"},tD={key:0,class:"mt-2 text-sm text-red-600"},nD={key:0,class:"mt-2 text-sm text-red-600"},iD={key:4},rD={key:5},sD={key:0,class:"mt-2 text-sm text-red-600"},oD={class:"flex justify-end space-x-3"},aD=["disabled"],lD={key:0,class:"mr-2"},uD=Pa({__name:"UserFormModal",props:{user:{type:Object,default:()=>({})},concessionnaires:{type:Array,default:()=>[]},usines:{type:Array,default:()=>[]},isAdmin:{type:Boolean,default:!1},isUsine:{type:Boolean,default:!1},currentConcessionnaire:{type:String,default:void 0},currentUsine:{type:String,default:void 0},apiErrors:{type:Array,default:()=>[]},refreshKey:{type:Number,default:0}},emits:["close","save","refresh"],setup(e,{emit:n}){const t=e,i=n,r=un(!1),o=un(""),l=un(""),h=un(""),g=un(""),v=un(""),_=Au({id:void 0,first_name:"",last_name:"",username:"",email:"",password:"",company_name:"",role:t.isUsine?"CONCESSIONNAIRE":t.isAdmin?"ADMIN":"AGRICULTEUR",concessionnaire:null,usine:null,is_active:!0});Tl(()=>{var E;(E=t.user)!=null&&E.id?(_.id=t.user.id,_.first_name=t.user.first_name||"",_.last_name=t.user.last_name||"",_.username=t.user.username||"",_.email=t.user.email||"",_.company_name=t.user.company_name||"",_.role=t.user.role||"AGRICULTEUR",_.is_active=t.user.is_active??!0,t.user.concessionnaire?typeof t.user.concessionnaire=="object"?_.concessionnaire=t.user.concessionnaire.id:_.concessionnaire=t.user.concessionnaire:t.user.concessionnaire_id?_.concessionnaire=t.user.concessionnaire_id:t.currentConcessionnaire&&(_.concessionnaire=parseInt(t.currentConcessionnaire)),t.user.usine?typeof t.user.usine=="object"?_.usine=t.user.usine.id:_.usine=t.user.usine:t.user.usine_id?_.usine=t.user.usine_id:t.currentUsine&&(_.usine=parseInt(t.currentUsine))):(t.currentConcessionnaire&&(_.concessionnaire=parseInt(t.currentConcessionnaire)),t.currentUsine&&(_.usine=parseInt(t.currentUsine)),t.isUsine?_.role="CONCESSIONNAIRE":t.isAdmin||(_.role="AGRICULTEUR"))}),cg(()=>{_.role==="ADMIN"||_.role==="USINE"?(_.concessionnaire=null,_.usine=null):_.role==="CONCESSIONNAIRE"&&(_.concessionnaire=null,t.isUsine&&t.currentUsine&&(_.usine=parseInt(t.currentUsine)))}),cg(()=>{o.value="",l.value="",h.value="",g.value="",t.apiErrors&&t.apiErrors.length>0&&t.apiErrors.forEach(E=>{switch(E.field){case"email":o.value=E.message;break;case"username":l.value=E.message;break;case"password":h.value=E.message;break;case"non_field_error":default:g.value=E.message;break}})});async function x(){o.value="",l.value="",h.value="",g.value="";let E=!0;if(_.id||(_.password!==v.value?(h.value="Les mots de passe ne correspondent pas",E=!1):_.password.length<8&&(h.value="Le mot de passe doit contenir au moins 8 caractères",E=!1)),!!E){r.value=!0;try{const b={..._};_.id&&delete b.password,t.isUsine&&["CONCESSIONNAIRE","AGRICULTEUR"].includes(_.role)&&(b.usine_id=t.currentUsine?parseInt(t.currentUsine):void 0),b.concessionnaire&&(b.concessionnaire_id=b.concessionnaire,delete b.concessionnaire),t.currentConcessionnaire&&_.role==="AGRICULTEUR"&&(b.concessionnaire_id=parseInt(t.currentConcessionnaire)),await i("save",b),i("refresh")}catch(b){console.error("Erreur locale:",b)}finally{r.value=!1}}}return(E,b)=>(Ye(),tt("div",FR,[M("div",zR,[b[29]||(b[29]=M("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[M("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),b[30]||(b[30]=M("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),M("div",jR,[M("div",null,[M("div",UR,[M("h3",$R,Ht(e.user?"Modifier l'utilisateur":"Nouvel utilisateur"),1),M("div",qR,[g.value?(Ye(),tt("div",VR,[M("div",GR,[b[12]||(b[12]=M("div",{class:"flex-shrink-0"},[M("svg",{class:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[M("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),M("div",HR,[M("h3",WR,Ht(g.value),1)])])])):wn("",!0),M("form",{onSubmit:Tp(x,["prevent"]),class:"space-y-6"},[e.isAdmin?(Ye(),tt("div",ZR,[b[14]||(b[14]=M("label",{for:"role",class:"block text-sm font-medium text-gray-700"},"Type d'utilisateur",-1)),Dn(M("select",{id:"role","onUpdate:modelValue":b[0]||(b[0]=D=>_.role=D),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:""},b[13]||(b[13]=[M("option",{value:"ADMIN"},"Administrateur",-1),M("option",{value:"USINE"},"Usine",-1),M("option",{value:"CONCESSIONNAIRE"},"Concessionnaire",-1),M("option",{value:"AGRICULTEUR"},"Agriculteur",-1)]),512),[[Ws,_.role]])])):wn("",!0),e.isAdmin&&_.role==="CONCESSIONNAIRE"?(Ye(),tt("div",KR,[b[16]||(b[16]=M("label",{for:"usine",class:"block text-sm font-medium text-gray-700"},"Usine",-1)),Dn(M("select",{id:"usine","onUpdate:modelValue":b[1]||(b[1]=D=>_.usine=D),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},[b[15]||(b[15]=M("option",{value:null},"-- Sélectionner une usine --",-1)),(Ye(!0),tt(zn,null,Ti(e.usines,D=>(Ye(),tt("option",{key:D.id,value:D.id},Ht(D.first_name)+" "+Ht(D.last_name)+" ("+Ht(D.company_name||"Usine")+") ",9,JR))),128))],512),[[Ws,_.usine]])])):wn("",!0),e.isUsine&&!_.id?(Ye(),tt("div",YR,[b[18]||(b[18]=M("label",{for:"role",class:"block text-sm font-medium text-gray-700"},"Type d'utilisateur",-1)),Dn(M("select",{id:"role","onUpdate:modelValue":b[2]||(b[2]=D=>_.role=D),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:""},b[17]||(b[17]=[M("option",{value:"CONCESSIONNAIRE"},"Concessionnaire",-1),M("option",{value:"AGRICULTEUR"},"Agriculteur",-1)]),512),[[Ws,_.role]])])):wn("",!0),(e.isAdmin||e.isUsine)&&_.role==="AGRICULTEUR"&&!e.currentConcessionnaire?(Ye(),tt("div",XR,[b[20]||(b[20]=M("label",{for:"concessionnaire",class:"block text-sm font-medium text-gray-700"},"Concessionnaire",-1)),Dn(M("select",{id:"concessionnaire","onUpdate:modelValue":b[3]||(b[3]=D=>_.concessionnaire=D),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:""},[b[19]||(b[19]=M("option",{value:null},"-- Sélectionner un concessionnaire --",-1)),(Ye(!0),tt(zn,null,Ti(e.concessionnaires,D=>(Ye(),tt("option",{key:D.id,value:D.id},Ht(D.first_name)+" "+Ht(D.last_name)+" ("+Ht(D.company_name||"Concessionnaire")+") ",9,QR))),128))],512),[[Ws,_.concessionnaire]])])):wn("",!0),M("div",eD,[M("div",null,[b[21]||(b[21]=M("label",{for:"first_name",class:"block text-sm font-medium text-gray-700"},"Prénom",-1)),Dn(M("input",{type:"text",id:"first_name","onUpdate:modelValue":b[4]||(b[4]=D=>_.first_name=D),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[ki,_.first_name]])]),M("div",null,[b[22]||(b[22]=M("label",{for:"last_name",class:"block text-sm font-medium text-gray-700"},"Nom",-1)),Dn(M("input",{type:"text",id:"last_name","onUpdate:modelValue":b[5]||(b[5]=D=>_.last_name=D),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[ki,_.last_name]])])]),M("div",null,[b[23]||(b[23]=M("label",{for:"email",class:"block text-sm font-medium text-gray-700"},"Email",-1)),Dn(M("input",{type:"email",id:"email","onUpdate:modelValue":b[6]||(b[6]=D=>_.email=D),required:"",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[ki,_.email]]),o.value?(Ye(),tt("div",tD,Ht(o.value),1)):wn("",!0)]),M("div",null,[b[24]||(b[24]=M("label",{for:"username",class:"block text-sm font-medium text-gray-700"},"Nom d'utilisateur",-1)),Dn(M("input",{type:"text",id:"username","onUpdate:modelValue":b[7]||(b[7]=D=>_.username=D),required:"",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[ki,_.username]]),l.value?(Ye(),tt("div",nD,Ht(l.value),1)):wn("",!0)]),M("div",null,[b[25]||(b[25]=M("label",{for:"company_name",class:"block text-sm font-medium text-gray-700"},"Entreprise",-1)),Dn(M("input",{type:"text",id:"company_name","onUpdate:modelValue":b[8]||(b[8]=D=>_.company_name=D),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[ki,_.company_name]])]),_.id?wn("",!0):(Ye(),tt("div",iD,[b[26]||(b[26]=M("label",{for:"password",class:"block text-sm font-medium text-gray-700"},"Mot de passe",-1)),Dn(M("input",{type:"password",id:"password","onUpdate:modelValue":b[9]||(b[9]=D=>_.password=D),required:"",autocomplete:"new-password",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[ki,_.password]])])),_.id?wn("",!0):(Ye(),tt("div",rD,[b[27]||(b[27]=M("label",{for:"password_confirm",class:"block text-sm font-medium text-gray-700"},"Confirmer le mot de passe",-1)),Dn(M("input",{type:"password",id:"password_confirm","onUpdate:modelValue":b[10]||(b[10]=D=>v.value=D),required:"",autocomplete:"new-password",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[ki,v.value]]),h.value?(Ye(),tt("div",sD,Ht(h.value),1)):wn("",!0)])),M("div",oD,[M("button",{type:"button",onClick:b[11]||(b[11]=D=>E.$emit("close")),class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"}," Annuler "),M("button",{type:"submit",disabled:r.value,class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},[r.value?(Ye(),tt("span",lD,b[28]||(b[28]=[M("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[M("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),M("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):wn("",!0),Br(" "+Ht(_.id?"Enregistrer":"Créer"),1)],8,aD)])],32)])])])])])]))}}),cD={class:"fixed inset-0 z-50 overflow-y-auto"},hD={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0"},fD={class:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"},dD={class:"sm:flex sm:items-start"},pD={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"},gD={class:"text-lg leading-6 font-medium text-gray-900",id:"modal-headline"},mD={class:"mt-2"},vD={class:"text-sm text-gray-500"},yD={class:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse"},G4=Pa({__name:"ConfirmationModal",props:{title:{type:String,required:!0},message:{type:String,required:!0}},emits:["confirm","cancel"],setup(e){return(n,t)=>(Ye(),tt("div",cD,[M("div",hD,[t[3]||(t[3]=M("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[M("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),t[4]||(t[4]=M("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),M("div",fD,[M("div",dD,[t[2]||(t[2]=M("div",{class:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10"},[M("svg",{class:"h-6 w-6 text-red-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),M("div",pD,[M("h3",gD,Ht(e.title),1),M("div",mD,[M("p",vD,Ht(e.message),1)])])]),M("div",yD,[M("button",{type:"button",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:t[0]||(t[0]=i=>n.$emit("confirm"))}," Confirmer "),M("button",{type:"button",class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:mt-0 sm:w-auto sm:text-sm",onClick:t[1]||(t[1]=i=>n.$emit("cancel"))}," Annuler ")])])])]))}}),_D={class:"h-full bg-gray-50"},bD={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},wD={class:"flex justify-between items-center mb-8"},xD={class:"text-3xl font-extrabold text-gray-900"},LD={key:0},CD={key:1},SD={key:2},PD={key:0},ED={key:1},AD={key:2},MD={class:"bg-white shadow rounded-lg mb-6 p-4"},kD={class:"space-y-4"},TD={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},BD={key:0},ND={key:0,value:"ADMIN"},RD={key:1,value:"USINE"},DD={key:1},OD=["value"],ID={key:2},FD=["value"],zD={class:"w-full"},jD={class:"bg-white shadow rounded-lg"},UD={class:"overflow-x-auto"},$D={class:"min-w-full divide-y divide-gray-200"},qD={class:"bg-gray-50"},VD={key:0,scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},GD={key:1,scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},HD={class:"bg-white divide-y divide-gray-200"},WD={key:0,class:"animate-pulse"},ZD={key:1},KD={class:"px-6 py-4 whitespace-nowrap"},JD={class:"flex items-center"},YD={class:"flex-shrink-0 h-10 w-10"},XD={class:"h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center"},QD={class:"text-primary-600 font-medium"},eO={class:"ml-4"},tO={class:"text-sm font-medium text-gray-900"},nO={class:"text-sm text-gray-500"},iO={class:"px-6 py-4 whitespace-nowrap"},rO={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},sO={key:0,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},oO={key:1,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},aO={class:"px-6 py-4 whitespace-nowrap"},lO={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},uO=["onClick"],cO=["onClick"],hO=Pa({__name:"UserListView",setup(e){const n=Va(),t=Rf(),i=un([]),r=un([]),o=un([]),l=un(!1),h=un(!1),g=un(null),v=un(null),_=un(!0),x=un([]),E=Au({role:"",search:"",concessionnaire:"",usine:""}),b=Ni(()=>n.isAdmin),D=Ni(()=>n.isUsine),$=Ni(()=>n.isConcessionnaire),Q=Ni(()=>b.value?i.value.filter(V=>V.role==="CONCESSIONNAIRE"):D.value?i.value.filter(V=>{var U,Y;return V.role==="CONCESSIONNAIRE"&&((U=V.usine)==null?void 0:U.id)===((Y=n.user)==null?void 0:Y.id)}):[]),F=Ni(()=>{let V=i.value;if(D.value&&(V=V.filter(U=>{var Y,ce,re,Pe,Me;return U.role==="CONCESSIONNAIRE"?((Y=U.usine)==null?void 0:Y.id)===((ce=n.user)==null?void 0:ce.id):U.role==="AGRICULTEUR"?((Pe=(re=U.concessionnaire)==null?void 0:re.usine)==null?void 0:Pe.id)===((Me=n.user)==null?void 0:Me.id):!1})),$.value&&(V=V.filter(U=>{var Y,ce;return U.role==="AGRICULTEUR"&&(U.concessionnaire_id===((Y=n.user)==null?void 0:Y.id)||U.concessionnaire&&U.concessionnaire.id===((ce=n.user)==null?void 0:ce.id))})),(b.value||D.value)&&(E.role&&(V=V.filter(U=>U.role===E.role)),E.concessionnaire&&(V=V.filter(U=>{var ce;const Y=((ce=U.concessionnaire)==null?void 0:ce.id)||U.concessionnaire_id;return(Y==null?void 0:Y.toString())===E.concessionnaire.toString()})),E.usine&&b.value&&(V=V.filter(U=>{var Y,ce,re,Pe,Me;return U.role==="CONCESSIONNAIRE"?((ce=(Y=U.usine)==null?void 0:Y.id)==null?void 0:ce.toString())===E.usine.toString():U.role==="AGRICULTEUR"?((Me=(Pe=(re=U.concessionnaire)==null?void 0:re.usine)==null?void 0:Pe.id)==null?void 0:Me.toString())===E.usine.toString():!1}))),E.search){const U=E.search.toLowerCase();V=V.filter(Y=>{var ce,re,Pe,Me;return((ce=Y.username)==null?void 0:ce.toLowerCase().includes(U))||((re=Y.email)==null?void 0:re.toLowerCase().includes(U))||((Pe=Y.first_name)==null?void 0:Pe.toLowerCase().includes(U))||((Me=Y.last_name)==null?void 0:Me.toLowerCase().includes(U))||Y.company_name&&Y.company_name.toLowerCase().includes(U)})}return V});Tl(async()=>{await G(),await me()});async function G(){var V,U,Y;_.value=!0;try{if(b.value)i.value=await n.fetchUsers();else if(D.value){const[ce,re]=await Promise.all([$d({role:"CONCESSIONNAIRE",usineId:(V=n.user)==null?void 0:V.id}),$d({role:"AGRICULTEUR",usineId:(U=n.user)==null?void 0:U.id})]);i.value=[...ce,...re]}else $.value&&(i.value=await $d({role:"AGRICULTEUR",concessionnaireId:(Y=n.user)==null?void 0:Y.id,includeDetails:!0}),console.log("Agriculteurs récupérés:",i.value))}catch(ce){console.error("Erreur lors de la récupération des utilisateurs:",ce),t.error("Erreur lors de la récupération des utilisateurs")}finally{_.value=!1}}async function me(){try{b.value?await Promise.all([Se(),nt()]):D.value&&await Ie()}catch(V){console.error("Erreur lors de la récupération des dépendances:",V)}}async function Se(){var V;try{b.value?r.value=await n.fetchUsersByRole({role:"CONCESSIONNAIRE"}):D.value&&(r.value=await n.fetchUsineConcessionnaires((V=n.user)==null?void 0:V.id))}catch(U){console.error("Erreur lors de la récupération des concessionnaires:",U)}}async function Ie(){var V,U;if(!(!D.value||!((V=n.user)!=null&&V.id)))try{r.value=await n.fetchUsineConcessionnaires((U=n.user)==null?void 0:U.id)}catch(Y){console.error("Erreur lors de la récupération des concessionnaires de l'usine:",Y)}}async function nt(){try{o.value=await n.fetchUsines()}catch(V){console.error("Erreur lors de la récupération des usines:",V)}}function Ve(){g.value=null,l.value=!0}function O(V){g.value={...V},l.value=!0}function W(){l.value=!1,g.value=null,x.value=[]}async function ue(V){var Y,ce,re,Pe,Me,ot;x.value=[];const U=!!V.id;try{const X={...V};b.value?(X.usine&&typeof X.usine=="object"?X.usine_id=X.usine.id:typeof X.usine=="number"&&(X.usine_id=X.usine),X.concessionnaire&&typeof X.concessionnaire=="object"?X.concessionnaire_id=X.concessionnaire.id:typeof X.concessionnaire=="number"&&(X.concessionnaire_id=X.concessionnaire)):D.value?(X.usine_id=(Y=n.user)==null?void 0:Y.id,X.role==="AGRICULTEUR"&&(X.concessionnaire&&typeof X.concessionnaire=="object"?X.concessionnaire_id=X.concessionnaire.id:typeof X.concessionnaire=="number"&&(X.concessionnaire_id=X.concessionnaire))):$.value&&(X.role="AGRICULTEUR",X.concessionnaire_id=(ce=n.user)==null?void 0:ce.id),X.role==="CONCESSIONNAIRE"?((re=X.usine)!=null&&re.id?(X.usine_id=X.usine.id,delete X.usine):typeof X.usine=="number"&&(X.usine_id=X.usine,delete X.usine),delete X.concessionnaire):X.role==="AGRICULTEUR"&&((Pe=X.concessionnaire)!=null&&Pe.id?(X.concessionnaire_id=X.concessionnaire.id,delete X.concessionnaire):typeof X.concessionnaire=="number"&&(X.concessionnaire_id=X.concessionnaire,delete X.concessionnaire),delete X.usine,delete X.usine_id),U?(await n.updateUser(V.id,X),t.success("Utilisateur modifié avec succès")):(await n.createUser(X),t.success("Utilisateur créé avec succès")),await Promise.all([G(),me()]),W()}catch(X){console.error("Error saving user:",((Me=X.response)==null?void 0:Me.data)||X),x.value=nE(X),t.error("Erreur lors de la sauvegarde de l'utilisateur");const Ee=((ot=X.response)==null?void 0:ot.data)||{};let B="";throw typeof Ee=="object"&&(B=Object.entries(Ee).map(([H,he])=>Array.isArray(he)?`${H}: ${he[0]}`:`${H}: ${he}`).filter(H=>H).join(`
`)),B||(B="Une erreur est survenue lors de la sauvegarde"),new Error(B)}}function z(V){v.value=V,h.value=!0}async function R(){if(v.value)try{await n.deleteUser(v.value.id),t.success("Utilisateur supprimé avec succès"),await Promise.all([G(),me()]),h.value=!1,v.value=null}catch(V){throw console.error("Erreur lors de la suppression de l'utilisateur:",V),t.error("Erreur lors de la suppression de l'utilisateur"),V}}function J(V){var U,Y,ce,re,Pe,Me,ot,X;return b.value?!0:D.value?V.role==="CONCESSIONNAIRE"?((U=V.usine)==null?void 0:U.id)===((Y=n.user)==null?void 0:Y.id):V.role==="AGRICULTEUR"?((re=(ce=V.concessionnaire)==null?void 0:ce.usine)==null?void 0:re.id)===((Pe=n.user)==null?void 0:Pe.id):!1:$.value?V.role==="AGRICULTEUR"&&(V.concessionnaire_id===((Me=n.user)==null?void 0:Me.id)||((ot=V.concessionnaire)==null?void 0:ot.id)===((X=n.user)==null?void 0:X.id)):!1}return(V,U)=>{var Y,ce,re,Pe;return Ye(),tt("div",_D,[M("div",bD,[M("div",wD,[M("h1",xD,[b.value?(Ye(),tt("span",LD,"Gestion des utilisateurs")):D.value?(Ye(),tt("span",CD,"Gestion des concessionnaires et agriculteurs")):$.value?(Ye(),tt("span",SD,"Gestion des agriculteurs")):wn("",!0)]),M("button",{onClick:Ve,class:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},[U[5]||(U[5]=M("svg",{class:"-ml-1 mr-2 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{"fill-rule":"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z","clip-rule":"evenodd"})],-1)),b.value?(Ye(),tt("span",PD,"Nouvel utilisateur")):D.value?(Ye(),tt("span",ED,"Nouveau concessionnaire/agriculteur")):$.value?(Ye(),tt("span",AD,"Nouvel agriculteur")):wn("",!0)])]),M("div",MD,[M("div",kD,[M("div",TD,[b.value||D.value?(Ye(),tt("div",BD,[U[9]||(U[9]=M("label",{for:"role-filter",class:"block text-sm font-medium text-gray-700"},"Rôle",-1)),Dn(M("select",{id:"role-filter","onUpdate:modelValue":U[0]||(U[0]=Me=>E.role=Me),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[U[6]||(U[6]=M("option",{value:""},"Tous les rôles",-1)),b.value?(Ye(),tt("option",ND,"Administrateur")):wn("",!0),b.value?(Ye(),tt("option",RD,"Usine")):wn("",!0),U[7]||(U[7]=M("option",{value:"CONCESSIONNAIRE"},"Concessionnaire",-1)),U[8]||(U[8]=M("option",{value:"AGRICULTEUR"},"Agriculteur",-1))],512),[[Ws,E.role]])])):wn("",!0),b.value?(Ye(),tt("div",DD,[U[11]||(U[11]=M("label",{for:"usine-filter",class:"block text-sm font-medium text-gray-700"},"Usine",-1)),Dn(M("select",{id:"usine-filter","onUpdate:modelValue":U[1]||(U[1]=Me=>E.usine=Me),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[U[10]||(U[10]=M("option",{value:""},"Toutes les usines",-1)),(Ye(!0),tt(zn,null,Ti(o.value,Me=>(Ye(),tt("option",{key:Me.id,value:Me.id},Ht(Wn(ol)(Me)),9,OD))),128))],512),[[Ws,E.usine]])])):wn("",!0),b.value||D.value?(Ye(),tt("div",ID,[U[13]||(U[13]=M("label",{for:"concessionnaire-filter",class:"block text-sm font-medium text-gray-700"},"Concessionnaire",-1)),Dn(M("select",{id:"concessionnaire-filter","onUpdate:modelValue":U[2]||(U[2]=Me=>E.concessionnaire=Me),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[U[12]||(U[12]=M("option",{value:""},"Tous les concessionnaires",-1)),(Ye(!0),tt(zn,null,Ti(Q.value,Me=>(Ye(),tt("option",{key:Me.id,value:Me.id},Ht(Wn(ol)(Me)),9,FD))),128))],512),[[Ws,E.concessionnaire]])])):wn("",!0)]),M("div",zD,[U[14]||(U[14]=M("label",{for:"search",class:"block text-sm font-medium text-gray-700"},"Recherche",-1)),Dn(M("input",{type:"text",id:"search","onUpdate:modelValue":U[3]||(U[3]=Me=>E.search=Me),placeholder:"Rechercher par nom, email, entreprise...",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},null,512),[[ki,E.search]])])])]),M("div",jD,[M("div",UD,[M("table",$D,[M("thead",qD,[M("tr",null,[U[15]||(U[15]=M("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Utilisateur ",-1)),U[16]||(U[16]=M("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Rôle ",-1)),U[17]||(U[17]=M("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Email ",-1)),b.value||D.value?(Ye(),tt("th",VD," Usine ")):wn("",!0),b.value||D.value?(Ye(),tt("th",GD," Concessionnaire ")):wn("",!0),U[18]||(U[18]=M("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Statut ",-1)),U[19]||(U[19]=M("th",{scope:"col",class:"relative px-6 py-3"},[M("span",{class:"sr-only"},"Actions")],-1))])]),M("tbody",HD,[_.value?(Ye(),tt("tr",WD,U[20]||(U[20]=[M("td",{colspan:"7",class:"py-4 px-6"},[M("div",{class:"h-4 bg-gray-200 rounded w-3/4"})],-1)]))):F.value.length===0?(Ye(),tt("tr",ZD,U[21]||(U[21]=[M("td",{colspan:"7",class:"py-4 px-6 text-center text-gray-500"}," Aucun utilisateur trouvé ",-1)]))):wn("",!0),(Ye(!0),tt(zn,null,Ti(F.value,Me=>{var ot;return Ye(),tt("tr",{key:Me.id},[M("td",KD,[M("div",JD,[M("div",YD,[M("div",XD,[M("span",QD,Ht(Wn(rE)(Me.first_name,Me.last_name)),1)])]),M("div",eO,[M("div",tO,Ht(Wn(ol)(Me)),1),M("div",nO,Ht(Me.username),1)])])]),M("td",iO,[M("span",{class:Jr(Wn(aE)())},Ht(Wn(oE)(Me.role)),3)]),M("td",rO,Ht(Me.email),1),b.value||D.value?(Ye(),tt("td",sO,[Me.role==="USINE"?(Ye(),tt(zn,{key:0},[Br(" - ")],64)):Me.role==="CONCESSIONNAIRE"?(Ye(),tt(zn,{key:1},[Br(Ht(Me.usine?Wn(ol)(Me.usine):"Non assigné"),1)],64)):Me.role==="AGRICULTEUR"?(Ye(),tt(zn,{key:2},[Br(Ht((ot=Me.concessionnaire)!=null&&ot.usine?Wn(ol)(Me.concessionnaire.usine):"Non assigné"),1)],64)):(Ye(),tt(zn,{key:3},[Br(" - ")],64))])):wn("",!0),b.value||D.value?(Ye(),tt("td",oO,[Me.role==="USINE"||Me.role==="ADMIN"?(Ye(),tt(zn,{key:0},[Br(" - ")],64)):Me.role==="CONCESSIONNAIRE"?(Ye(),tt(zn,{key:1},[Br(" - ")],64)):(Ye(),tt(zn,{key:2},[Br(Ht(Me.concessionnaire?Wn(ol)(Me.concessionnaire):"Non assigné"),1)],64))])):wn("",!0),M("td",aO,[M("span",{class:Jr(Wn(lE)(Me.is_active))},Ht(Me.is_active?"Actif":"Inactif"),3)]),M("td",lO,[M("button",{onClick:X=>O(Me),class:"text-primary-600 hover:text-primary-900 mr-4"}," Modifier ",8,uO),J(Me)?(Ye(),tt("button",{key:0,onClick:X=>z(Me),class:"text-red-600 hover:text-red-900"}," Supprimer ",8,cO)):wn("",!0)])])}),128))])])])])]),l.value?(Ye(),Su(uD,{key:0,user:g.value,concessionnaires:r.value,usines:o.value,"is-admin":b.value,"is-usine":D.value,"current-concessionnaire":$.value?(ce=(Y=Wn(n).user)==null?void 0:Y.id)==null?void 0:ce.toString():void 0,"current-usine":D.value?(Pe=(re=Wn(n).user)==null?void 0:re.id)==null?void 0:Pe.toString():void 0,"api-errors":x.value,onClose:W,onSave:ue},null,8,["user","concessionnaires","usines","is-admin","is-usine","current-concessionnaire","current-usine","api-errors"])):wn("",!0),h.value?(Ye(),Su(G4,{key:1,title:"Supprimer l'utilisateur",message:"Êtes-vous sûr de vouloir supprimer cet utilisateur ? Cette action est irréversible.",onConfirm:R,onCancel:U[4]||(U[4]=Me=>h.value=!1)})):wn("",!0)])}}}),fO={class:"h-full bg-gray-50"},dO={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},pO={class:"sm:flex sm:items-center"},gO={class:"sm:flex-auto"},mO={class:"text-2xl font-semibold text-gray-900"},vO={class:"mt-2 text-sm text-gray-700"},yO={key:0,class:"mt-8"},_O={class:"mb-6"},bO=["value"],wO={class:"mb-6"},xO={value:null},LO=["value"],CO={key:0,class:"mb-6"},SO={value:null},PO=["value"],EO={key:1,class:"mt-8"},AO={class:"mb-6"},MO=["value"],kO={class:"mt-8"},TO={class:"overflow-hidden shadow-sm ring-1 ring-black ring-opacity-5 rounded-lg"},BO={class:"overflow-x-auto"},NO={class:"min-w-full divide-y divide-gray-300"},RO={class:"bg-gray-50"},DO={scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6 lg:pl-8"},OO={class:"ml-2 flex-none rounded"},IO={scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},FO={class:"ml-2 flex-none rounded"},zO={class:"divide-y divide-gray-200 bg-white"},jO={key:0},UO={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 lg:pl-8"},$O={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},qO={class:"px-3 py-4 text-sm text-gray-900"},VO={key:0,class:"flex items-center"},GO={class:"h-8 w-8 flex-shrink-0"},HO={class:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center"},WO={class:"text-primary-700 font-medium text-sm"},ZO={class:"ml-3"},KO={class:"font-medium"},JO={key:1,class:"text-gray-500"},YO={class:"px-3 py-4 text-sm text-gray-900"},XO={key:0,class:"flex items-center"},QO={class:"h-8 w-8 flex-shrink-0"},eI={class:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center"},tI={class:"text-primary-700 font-medium text-sm"},nI={class:"ml-3"},iI={class:"font-medium"},rI={key:1,class:"text-gray-500"},sI={class:"px-3 py-4 text-sm text-gray-900"},oI={key:0,class:"flex items-center"},aI={class:"h-8 w-8 flex-shrink-0"},lI={class:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center"},uI={class:"text-primary-700 font-medium text-sm"},cI={class:"ml-3"},hI={class:"font-medium"},fI={key:1,class:"text-gray-500"},dI={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},pI={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6 lg:pr-8"},gI=["onClick"],mI=["onClick"],vI=["onClick"],yI={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[2000]"},_I={class:"bg-white rounded-lg p-6 max-w-md w-full"},bI={class:"flex justify-between items-center mb-4"},wI=["disabled"],xI=["disabled"],LI={key:0,class:"space-y-4"},CI={key:0},SI=["disabled"],PI=["value"],EI=["disabled"],AI=["value"],MI={key:0,class:"mt-1 text-sm text-gray-500"},kI=["disabled"],TI=["value"],BI={key:0,class:"mt-1 text-sm text-gray-500"},NI={key:1,class:"mt-4 bg-red-50 p-4 rounded-md"},RI={class:"flex"},DI={class:"ml-3"},OI={class:"text-sm font-medium text-red-800"},II={class:"mt-5 sm:mt-6 sm:grid sm:grid-cols-2 sm:gap-3"},FI=["disabled"],zI={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},jI=Pa({__name:"PlansView",setup(e){const n=qp(),t=Lm(),i=Va(),r=un([]),o=un([]),l=un([]),h=un([]),g=un(!1),v=un(!1),_=un(!1),x=un(null),E=un({nom:"",description:"",client:null}),b=un({id:0,nom:"",description:"",usine:null,concessionnaire:null,agriculteur:null}),D=un(!1),$=un(null),Q=un(null),F=un(null),G=un("date_modification"),me=un("desc"),Se=un(null),Ie=Ni(()=>Q.value?h.value.filter(ie=>typeof ie.concessionnaire=="object"&&ie.concessionnaire?ie.concessionnaire.id===Q.value:ie.concessionnaire===Q.value||ie.concessionnaire_id===Q.value):h.value),nt=Ni(()=>{let ie=r.value;console.log(`
[PlansView] Filtering plans:`,ie.map(se=>({id:se.id,usine:se.usine,concessionnaire:se.concessionnaire,agriculteur:se.agriculteur}))),i.isAdmin?(Se.value&&(ie=ie.filter(se=>{var Ce;return typeof se.usine=="object"?((Ce=se.usine)==null?void 0:Ce.id)===Se.value:se.usine===Se.value})),Q.value&&(ie=ie.filter(se=>{var Ce;return typeof se.concessionnaire=="object"?((Ce=se.concessionnaire)==null?void 0:Ce.id)===Q.value:se.concessionnaire===Q.value}),F.value&&(ie=ie.filter(se=>{var Ce;return typeof se.agriculteur=="object"?((Ce=se.agriculteur)==null?void 0:Ce.id)===F.value:se.agriculteur===F.value})))):i.isConcessionnaire&&(ie=ie.filter(se=>{var Ce,ne,ae;return typeof se.concessionnaire=="object"?((Ce=se.concessionnaire)==null?void 0:Ce.id)===((ne=i.user)==null?void 0:ne.id):se.concessionnaire===((ae=i.user)==null?void 0:ae.id)}),F.value&&(ie=ie.filter(se=>{var Ce;return typeof se.agriculteur=="object"?((Ce=se.agriculteur)==null?void 0:Ce.id)===F.value:se.agriculteur===F.value})));const ee=[...ie].sort((se,Ce)=>{if(G.value==="nom")return me.value==="asc"?se.nom.localeCompare(Ce.nom):Ce.nom.localeCompare(se.nom);{const ne=new Date(se[G.value]).getTime(),ae=new Date(Ce[G.value]).getTime();return me.value==="asc"?ne-ae:ae-ne}});return console.log("[PlansView] Final filtered and sorted plans:",ee.map(se=>({id:se.id,usine:se.usine,concessionnaire:se.concessionnaire,agriculteur:se.agriculteur}))),ee}),Ve=Ni(()=>i.isAdmin?{title:"Tous les plans",description:"Liste complète des plans",plans:r.value}:i.isConcessionnaire?{title:"Plans des agriculteurs",description:"Plans où vous êtes assigné comme concessionnaire",plans:r.value.filter(ie=>{var ee,se,Ce;return typeof ie.concessionnaire=="object"?((ee=ie.concessionnaire)==null?void 0:ee.id)===((se=i.user)==null?void 0:se.id):ie.concessionnaire===((Ce=i.user)==null?void 0:Ce.id)})}:{title:"Mes plans",description:"Plans qui vous sont assignés ou que vous avez créés",plans:r.value.filter(ie=>{var Ce,ne,ae,xe;const ee=ie.createur.id===((Ce=i.user)==null?void 0:Ce.id);let se=!1;return typeof ie.agriculteur=="object"?se=((ne=ie.agriculteur)==null?void 0:ne.id)===((ae=i.user)==null?void 0:ae.id):se=ie.agriculteur===((xe=i.user)==null?void 0:xe.id),se||ee})}),O=Ni(()=>Se.value?o.value.filter(ie=>{var ee;return typeof ie.usine=="object"?((ee=ie.usine)==null?void 0:ee.id)===Se.value:ie.usine_id===Se.value}):o.value),W=Ni(()=>b.value.usine?o.value.filter(ie=>{var ee;return typeof ie.usine=="object"?((ee=ie.usine)==null?void 0:ee.id)===b.value.usine:ie.usine_id===b.value.usine}):[]),ue=Ni(()=>!b.value.usine||!b.value.concessionnaire?[]:h.value.filter(ie=>typeof ie.concessionnaire=="object"&&ie.concessionnaire?ie.concessionnaire.id===b.value.concessionnaire:ie.concessionnaire===b.value.concessionnaire||ie.concessionnaire_id===b.value.concessionnaire));Tl(async()=>{var ie;await z(),i.isAdmin?await R():i.isConcessionnaire&&await V(((ie=i.user)==null?void 0:ie.id)||0)});async function z(){try{const ie=await t.fetchPlansWithDetails();r.value=ie.data}catch(ie){console.error("Erreur lors du chargement des plans:",ie)}}async function R(){try{console.log("Chargement des usines..."),l.value=await i.fetchUsines(),console.log("Usines chargées:",l.value)}catch(ie){console.error("Erreur lors du chargement des usines:",ie)}}async function J(ie){try{if(console.log("Chargement des concessionnaires pour l'usine:",ie),ie===void 0){const ee=await i.fetchUsersByRole({role:"CONCESSIONNAIRE"});o.value=ee}else o.value=await i.fetchUsineConcessionnaires(ie);console.log("Concessionnaires chargés:",o.value)}catch(ee){console.error("Erreur lors du chargement des concessionnaires:",ee)}}async function V(ie){try{console.log("Chargement des agriculteurs pour le concessionnaire:",ie);const ee=await $d({role:"AGRICULTEUR",concessionnaireId:ie});h.value=ee.map(se=>({...se,concessionnaire_id:ie})),console.log("Agriculteurs chargés:",h.value)}catch(ee){console.error("Erreur lors du chargement des agriculteurs:",ee)}}function U(){g.value=!0,E.value={nom:"",description:"",client:null}}async function Y(ie){console.log(`
[PlansView][editPlan] ====== DÉBUT ÉDITION PLAN ======`),console.log("[PlansView][editPlan] Plan reçu:",{id:ie.id,nom:ie.nom,usine:ie.usine,concessionnaire:ie.concessionnaire,agriculteur:ie.agriculteur});try{console.log("[PlansView][editPlan] Définition du plan courant dans le store..."),t.setCurrentPlan(ie),console.log("[PlansView][editPlan] Sauvegarde de l'ID dans localStorage:",ie.id),localStorage.setItem("lastPlanId",ie.id.toString()),console.log("[PlansView][editPlan] Redirection vers la vue carte..."),await n.push("/"),console.log(`[PlansView][editPlan] ====== FIN ÉDITION PLAN ======
`)}catch(ee){console.error("[PlansView][editPlan] ERREUR:",ee),ee instanceof Error&&console.error("[PlansView][editPlan] Stack trace:",ee.stack),alert("Une erreur est survenue lors du chargement du plan")}}async function ce(ie){ie!=null&&ie.id&&(x.value=ie,_.value=!0)}async function re(){var ie,ee;if((ie=x.value)!=null&&ie.id)try{await t.deletePlan(x.value.id),await z(),((ee=t.currentPlan)==null?void 0:ee.id)===x.value.id&&t.clearCurrentPlan()}catch(se){console.error("Erreur lors de la suppression du plan:",se),alert("Une erreur est survenue lors de la suppression du plan")}finally{_.value=!1,x.value=null}}function Pe(){_.value=!1,x.value=null}function Me(ie){return new Date(ie).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}function ot(ie){if(!ie)return"";const ee=ie.first_name||"",se=ie.last_name||"";return(ee.charAt(0)+se.charAt(0)).toUpperCase()}async function X(ie){D.value=!0,$.value=null;try{i.isAdmin&&!l.value.length&&await R();const ee=typeof ie.usine=="object"&&ie.usine?ie.usine.id:ie.usine,se=typeof ie.concessionnaire=="object"&&ie.concessionnaire?ie.concessionnaire.id:ie.concessionnaire,Ce=typeof ie.agriculteur=="object"&&ie.agriculteur?ie.agriculteur.id:ie.agriculteur;b.value={id:ie.id,nom:ie.nom,description:ie.description,usine:ee||null,concessionnaire:se||null,agriculteur:Ce||null},ee&&await J(ee),se&&await V(se),v.value=!0}catch(ee){console.error("Erreur lors de l'ouverture du modal:",ee),$.value="Erreur lors du chargement des données"}finally{D.value=!1}}async function Ee(){var ie,ee,se,Ce,ne;$.value=null,D.value=!0;try{if(!b.value.nom.trim())throw new Error("Le nom du plan est requis");if(b.value.agriculteur&&!b.value.concessionnaire)throw new Error("Un concessionnaire doit être sélectionné pour assigner un agriculteur");if(b.value.concessionnaire&&!b.value.usine)throw new Error("Une usine doit être sélectionnée pour assigner un concessionnaire");console.log("Données envoyées pour la mise à jour:",{id:b.value.id,nom:b.value.nom.trim(),description:b.value.description.trim(),usine_id:b.value.usine,concessionnaire_id:b.value.concessionnaire,agriculteur_id:b.value.agriculteur});const ae=await t.updatePlanDetails(b.value.id,{nom:b.value.nom.trim(),description:b.value.description.trim(),usine_id:b.value.usine,concessionnaire_id:b.value.concessionnaire,agriculteur_id:b.value.agriculteur});console.log("Réponse de la mise à jour:",ae),ae&&(v.value=!1,await z())}catch(ae){if(console.error("Erreur lors de la mise à jour du plan:",ae),(ee=(ie=ae.response)==null?void 0:ie.data)!=null&&ee.detail)$.value=ae.response.data.detail;else if((Ce=(se=ae.response)==null?void 0:se.data)!=null&&Ce.non_field_errors)$.value=ae.response.data.non_field_errors[0];else if((ne=ae.response)!=null&&ne.data){const xe=Object.entries(ae.response.data).map(([ye,le])=>`${ye}: ${Array.isArray(le)?le[0]:le}`);$.value=xe.join(`
`)}else $.value=ae.message||"Une erreur est survenue lors de la mise à jour du plan"}finally{D.value=!1}}So(()=>Se.value,async ie=>{Q.value=null,F.value=null,ie?await J(ie):await J()}),So(()=>Q.value,async ie=>{F.value=null,ie&&await V(ie)}),So(()=>b.value.usine,async ie=>{ie===null?(b.value.concessionnaire=null,b.value.agriculteur=null):await J(ie)}),So(()=>b.value.concessionnaire,async ie=>{b.value.agriculteur=null,ie&&await V(ie)});function B(ie){var ne,ae,xe;const ee=i.user;if(!ee)return!1;if(ee.user_type==="admin")return!0;if(ee.user_type==="usine")return typeof ie.usine=="object"?((ne=ie.usine)==null?void 0:ne.id)===ee.id:ie.usine===ee.id;if(ee.user_type==="concessionnaire")return typeof ie.concessionnaire=="object"?((ae=ie.concessionnaire)==null?void 0:ae.id)===ee.id:ie.concessionnaire===ee.id;const se=ie.createur.id===ee.id;let Ce=!1;return typeof ie.agriculteur=="object"?Ce=((xe=ie.agriculteur)==null?void 0:xe.id)===ee.id:Ce=ie.agriculteur===ee.id,Ce||se}async function H(ie){await z(),localStorage.setItem("lastPlanId",ie.toString()),console.log(`Plan ${ie} créé et défini comme plan actif`),n.push("/")}function he(ie){G.value===ie?me.value=me.value==="asc"?"desc":"asc":(G.value=ie,me.value="desc")}function te(ie){return ie?ol(ie):""}return(ie,ee)=>{var se;return Ye(),tt("div",fO,[M("div",dO,[M("div",pO,[M("div",gO,[M("h1",mO,Ht(Ve.value.title),1),M("p",vO,Ht(Ve.value.description),1)]),M("div",{class:"mt-4 sm:mt-0 sm:ml-16 sm:flex-none"},[M("button",{onClick:U,class:"inline-flex items-center justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:w-auto"}," Nouveau plan ")])]),Wn(i).isAdmin?(Ye(),tt("div",yO,[M("div",_O,[ee[15]||(ee[15]=M("label",{for:"usine-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par usine",-1)),Dn(M("select",{id:"usine-filter","onUpdate:modelValue":ee[0]||(ee[0]=Ce=>Se.value=Ce),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[ee[14]||(ee[14]=M("option",{value:null},"Toutes les usines",-1)),(Ye(!0),tt(zn,null,Ti(l.value,Ce=>(Ye(),tt("option",{key:Ce.id,value:Ce.id},Ht(te(Ce)),9,bO))),128))],512),[[Ws,Se.value]])]),M("div",wO,[ee[16]||(ee[16]=M("label",{for:"concessionnaire-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par concessionnaire",-1)),Dn(M("select",{id:"concessionnaire-filter","onUpdate:modelValue":ee[1]||(ee[1]=Ce=>Q.value=Ce),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[M("option",xO,Ht(O.value.length?"Tous les concessionnaires":"Aucun concessionnaire disponible"),1),(Ye(!0),tt(zn,null,Ti(O.value,Ce=>(Ye(),tt("option",{key:Ce.id,value:Ce.id},Ht(te(Ce)),9,LO))),128))],512),[[Ws,Q.value]])]),Q.value?(Ye(),tt("div",CO,[ee[17]||(ee[17]=M("label",{for:"agriculteur-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par agriculteur",-1)),Dn(M("select",{id:"agriculteur-filter","onUpdate:modelValue":ee[2]||(ee[2]=Ce=>F.value=Ce),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[M("option",SO,Ht(Ie.value.length?"Tous les agriculteurs":"Aucun agriculteur disponible"),1),(Ye(!0),tt(zn,null,Ti(Ie.value,Ce=>(Ye(),tt("option",{key:Ce.id,value:Ce.id},Ht(te(Ce)),9,PO))),128))],512),[[Ws,F.value]])])):wn("",!0)])):Wn(i).isConcessionnaire?(Ye(),tt("div",EO,[M("div",AO,[ee[19]||(ee[19]=M("label",{for:"agriculteur-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par agriculteur",-1)),Dn(M("select",{id:"agriculteur-filter","onUpdate:modelValue":ee[3]||(ee[3]=Ce=>F.value=Ce),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[ee[18]||(ee[18]=M("option",{value:null},"Tous les agriculteurs",-1)),(Ye(!0),tt(zn,null,Ti(h.value,Ce=>(Ye(),tt("option",{key:Ce.id,value:Ce.id},Ht(te(Ce)),9,MO))),128))],512),[[Ws,F.value]])])])):wn("",!0),M("div",kO,[M("div",TO,[M("div",BO,[M("table",NO,[M("thead",RO,[M("tr",null,[M("th",DO,[M("button",{onClick:ee[4]||(ee[4]=Ce=>he("nom")),class:"group inline-flex items-center"},[ee[21]||(ee[21]=Br(" Nom ")),M("span",OO,[(Ye(),tt("svg",{class:Jr(["h-5 w-5",{"text-gray-900":G.value==="nom","text-gray-400":G.value!=="nom","rotate-180":G.value==="nom"&&me.value==="asc"}]),viewBox:"0 0 20 20",fill:"currentColor"},ee[20]||(ee[20]=[M("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)]),2))])])]),ee[24]||(ee[24]=M("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Description ",-1)),ee[25]||(ee[25]=M("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Usine ",-1)),ee[26]||(ee[26]=M("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Concessionnaire ",-1)),ee[27]||(ee[27]=M("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Agriculteur ",-1)),M("th",IO,[M("button",{onClick:ee[5]||(ee[5]=Ce=>he("date_modification")),class:"group inline-flex items-center"},[ee[23]||(ee[23]=Br(" Dernière modification ")),M("span",FO,[(Ye(),tt("svg",{class:Jr(["h-5 w-5",{"text-gray-900":G.value==="date_modification","text-gray-400":G.value!=="date_modification","rotate-180":G.value==="date_modification"&&me.value==="asc"}]),viewBox:"0 0 20 20",fill:"currentColor"},ee[22]||(ee[22]=[M("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)]),2))])])]),ee[28]||(ee[28]=M("th",{scope:"col",class:"relative py-3.5 pl-3 pr-4 sm:pr-6 lg:pr-8"},[M("span",{class:"sr-only"},"Actions")],-1))])]),M("tbody",zO,[nt.value.length===0?(Ye(),tt("tr",jO,ee[29]||(ee[29]=[M("td",{colspan:"7",class:"py-4 px-6 text-center text-gray-500"}," Aucun plan disponible ",-1)]))):wn("",!0),(Ye(!0),tt(zn,null,Ti(nt.value,Ce=>(Ye(),tt("tr",{key:Ce.id,class:"hover:bg-gray-50"},[M("td",UO,Ht(Ce.nom),1),M("td",$O,Ht(Ce.description||"-"),1),M("td",qO,[Ce.usine&&typeof Ce.usine=="object"?(Ye(),tt("div",VO,[M("div",GO,[M("div",HO,[M("span",WO,Ht(ot(Ce.usine)),1)])]),M("div",ZO,[M("div",KO,Ht(Wn(ol)(Ce.usine)),1)])])):(Ye(),tt("div",JO," Non assigné "))]),M("td",YO,[Ce.concessionnaire&&typeof Ce.concessionnaire=="object"?(Ye(),tt("div",XO,[M("div",QO,[M("div",eI,[M("span",tI,Ht(ot(Ce.concessionnaire)),1)])]),M("div",nI,[M("div",iI,Ht(Wn(ol)(Ce.concessionnaire)),1)])])):(Ye(),tt("div",rI," Non assigné "))]),M("td",sI,[Ce.agriculteur&&typeof Ce.agriculteur=="object"?(Ye(),tt("div",oI,[M("div",aI,[M("div",lI,[M("span",uI,Ht(ot(Ce.agriculteur)),1)])]),M("div",cI,[M("div",hI,Ht(Wn(ol)(Ce.agriculteur)),1)])])):(Ye(),tt("div",fI," Non assigné "))]),M("td",dI,Ht(Me(Ce.date_modification)),1),M("td",pI,[M("button",{onClick:ne=>Y(Ce),class:"text-primary-600 hover:text-primary-900 mr-4"}," Ouvrir ",8,gI),M("button",{onClick:ne=>X(Ce),class:"text-primary-600 hover:text-primary-900 mr-4"}," Modifier ",8,mI),B(Ce)?(Ye(),tt("button",{key:0,onClick:ne=>ce(Ce),class:"text-red-600 hover:text-red-900"}," Supprimer ",8,vI)):wn("",!0)])]))),128))])])])])]),Yr(L4,{modelValue:g.value,"onUpdate:modelValue":ee[6]||(ee[6]=Ce=>g.value=Ce),concessionnaires:o.value,clients:h.value,onCreated:H},null,8,["modelValue","concessionnaires","clients"]),v.value?(Ye(),tt("div",yI,[M("div",_I,[M("div",bI,[ee[31]||(ee[31]=M("h2",{class:"text-xl font-semibold text-gray-900"},"Modifier le plan",-1)),M("button",{onClick:ee[7]||(ee[7]=Ce=>v.value=!1),class:"text-gray-400 hover:text-gray-500 focus:outline-none"},ee[30]||(ee[30]=[M("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),M("form",{onSubmit:Tp(Ee,["prevent"]),class:"space-y-4"},[M("div",null,[ee[32]||(ee[32]=M("label",{for:"edit-nom",class:"block text-sm font-medium text-gray-700"}," Nom ",-1)),Dn(M("input",{type:"text",id:"edit-nom","onUpdate:modelValue":ee[8]||(ee[8]=Ce=>b.value.nom=Ce),disabled:D.value,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",required:""},null,8,wI),[[ki,b.value.nom]])]),M("div",null,[ee[33]||(ee[33]=M("label",{for:"edit-description",class:"block text-sm font-medium text-gray-700"}," Description ",-1)),Dn(M("textarea",{id:"edit-description","onUpdate:modelValue":ee[9]||(ee[9]=Ce=>b.value.description=Ce),disabled:D.value,rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm disabled:bg-gray-100 disabled:cursor-not-allowed"},null,8,xI),[[ki,b.value.description]])]),Wn(i).isAdmin||((se=Wn(i).user)==null?void 0:se.user_type)==="usine"?(Ye(),tt("div",LI,[Wn(i).isAdmin?(Ye(),tt("div",CI,[ee[35]||(ee[35]=M("label",{for:"edit-usine",class:"block text-sm font-medium text-gray-700"}," Usine ",-1)),Dn(M("select",{id:"edit-usine","onUpdate:modelValue":ee[10]||(ee[10]=Ce=>b.value.usine=Ce),disabled:D.value,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed"},[ee[34]||(ee[34]=M("option",{value:null},"Sélectionner une usine",-1)),(Ye(!0),tt(zn,null,Ti(l.value,Ce=>(Ye(),tt("option",{key:Ce.id,value:Ce.id},Ht(te(Ce)),9,PI))),128))],8,SI),[[Ws,b.value.usine]])])):wn("",!0),M("div",null,[ee[37]||(ee[37]=M("label",{for:"edit-concessionnaire",class:"block text-sm font-medium text-gray-700"}," Concessionnaire ",-1)),Dn(M("select",{id:"edit-concessionnaire","onUpdate:modelValue":ee[11]||(ee[11]=Ce=>b.value.concessionnaire=Ce),disabled:Wn(i).isAdmin&&!b.value.usine||D.value,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed"},[ee[36]||(ee[36]=M("option",{value:null},"Sélectionner un concessionnaire",-1)),(Ye(!0),tt(zn,null,Ti(W.value,Ce=>(Ye(),tt("option",{key:Ce.id,value:Ce.id},Ht(te(Ce)),9,AI))),128))],8,EI),[[Ws,b.value.concessionnaire]]),Wn(i).isAdmin&&!b.value.usine?(Ye(),tt("p",MI," Veuillez d'abord sélectionner une usine ")):wn("",!0)]),M("div",null,[ee[39]||(ee[39]=M("label",{for:"edit-agriculteur",class:"block text-sm font-medium text-gray-700"}," Agriculteur ",-1)),Dn(M("select",{id:"edit-agriculteur","onUpdate:modelValue":ee[12]||(ee[12]=Ce=>b.value.agriculteur=Ce),disabled:!b.value.concessionnaire||D.value,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed"},[ee[38]||(ee[38]=M("option",{value:null},"Sélectionner un agriculteur",-1)),(Ye(!0),tt(zn,null,Ti(ue.value,Ce=>(Ye(),tt("option",{key:Ce.id,value:Ce.id},Ht(te(Ce)),9,TI))),128))],8,kI),[[Ws,b.value.agriculteur]]),b.value.concessionnaire?wn("",!0):(Ye(),tt("p",BI," Veuillez d'abord sélectionner un concessionnaire "))])])):wn("",!0),$.value?(Ye(),tt("div",NI,[M("div",RI,[ee[40]||(ee[40]=M("div",{class:"flex-shrink-0"},[M("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),M("div",DI,[M("p",OI,Ht($.value),1)])])])):wn("",!0),M("div",II,[M("button",{type:"button",class:"mt-3 inline-flex w-full justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-base font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:mt-0 sm:text-sm",onClick:ee[13]||(ee[13]=Ce=>v.value=!1)}," Annuler "),M("button",{type:"submit",disabled:D.value,class:"inline-flex w-full justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:text-sm disabled:opacity-50"},[D.value?(Ye(),tt("svg",zI,ee[41]||(ee[41]=[M("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),M("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):wn("",!0),Br(" "+Ht(D.value?"Enregistrement...":"Enregistrer"),1)],8,FI)])],32)])])):wn("",!0),_.value?(Ye(),Su(G4,{key:3,title:"Supprimer le plan",message:"Êtes-vous sûr de vouloir supprimer ce plan ? Cette action est irréversible.",onConfirm:re,onCancel:Pe})):wn("",!0)])])}}}),H4=uA({history:jE("/"),routes:[{path:"/",name:"home",component:Zy,meta:{requiresAuth:!0,allowedRoles:["admin","usine","concessionnaire","agriculteur"]}},{path:"/plans",name:"plans",component:jI,meta:{requiresAuth:!0,allowedRoles:["admin","usine","concessionnaire","agriculteur"]}},{path:"/users",name:"users",component:hO,meta:{requiresAuth:!0,allowedRoles:["admin","usine","concessionnaire"]}},{path:"/profile",name:"profile",component:()=>Qc(()=>import("./ProfileView.js"),[]),meta:{requiresAuth:!0,allowedRoles:["admin","usine","concessionnaire","agriculteur"]}},{path:"/login",name:"login",component:_k,meta:{requiresGuest:!0}},{path:"/forgot-password",name:"forgot-password",component:()=>Qc(()=>import("./ForgotPasswordView.js"),[]),meta:{requiresGuest:!0}},{path:"/reset-password/:token",name:"reset-password",component:()=>Qc(()=>import("./ResetPasswordView.js"),[]),meta:{requiresGuest:!0}},{path:"/change-password",name:"changePassword",component:tk,meta:{requiresAuth:!0,allowedRoles:["admin","usine","concessionnaire","agriculteur"]}},{path:"/map",name:"map",component:Zy,meta:{requiresAuth:!0}},{path:"/:pathMatch(.*)*",name:"not-found",component:()=>Qc(()=>import("./NotFoundView.js"),[])}]});H4.beforeEach(async(e,n,t)=>{var h,g;const i=Va();if(console.log("Route:",e.path,"Auth state:",{initialized:i.initialized,isAuthenticated:i.isAuthenticated,user:i.user}),!i.initialized)try{await i.initialize(window.INITIAL_STATE)}catch(v){console.error("Error initializing auth store:",v)}const r=i.isAuthenticated,o=(h=i.user)==null?void 0:h.must_change_password,l=(g=i.user)==null?void 0:g.user_type;if(e.meta.requiresAuth&&!r){t("/login");return}if(r&&o&&e.name!=="changePassword"){t({name:"changePassword"});return}if(e.name==="changePassword"&&!o){t({name:"home"});return}if(e.meta.allowedRoles&&l&&!e.meta.allowedRoles.includes(l)){t({name:"home"});return}if(e.meta.requiresGuest&&r){t({name:"home"});return}t()});const Em=pS(N6),W4=vS();Em.use(W4);Em.use(H4);const UI=Va(W4);window.INITIAL_STATE&&UI.initialize(window.INITIAL_STATE);Em.mount("#app");export{Mr as _,Au as a,M as b,tt as c,Pa as d,wn as e,Wn as f,Br as g,Dn as h,Ye as i,wc as j,Yr as k,vc as l,VL as m,Jr as n,Tl as o,aF as p,qp as q,un as r,qo as s,Ht as t,Va as u,ki as v,Tp as w,s4 as x};

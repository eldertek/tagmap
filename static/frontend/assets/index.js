var yD=Object.defineProperty;var vD=(e,t,n)=>t in e?yD(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var un=(e,t,n)=>vD(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(i){if(i.ep)return;i.ep=!0;const l=n(i);fetch(i.href,l)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function h2(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return n=>n in t}const no={},M0=[],Od=()=>{},_D=()=>!1,D_=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),U3=e=>e.startsWith("onUpdate:"),wa=Object.assign,V3=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},bD=Object.prototype.hasOwnProperty,xo=(e,t)=>bD.call(e,t),bi=Array.isArray,T0=e=>Q0(e)==="[object Map]",Pg=e=>Q0(e)==="[object Set]",vS=e=>Q0(e)==="[object Date]",xD=e=>Q0(e)==="[object RegExp]",Ki=e=>typeof e=="function",Fa=e=>typeof e=="string",of=e=>typeof e=="symbol",la=e=>e!==null&&typeof e=="object",$3=e=>(la(e)||Ki(e))&&Ki(e.then)&&Ki(e.catch),bM=Object.prototype.toString,Q0=e=>bM.call(e),wD=e=>Q0(e).slice(8,-1),d2=e=>Q0(e)==="[object Object]",G3=e=>Fa(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,A0=h2(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),f2=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},CD=/-(\w)/g,Nc=f2(e=>e.replace(CD,(t,n)=>n?n.toUpperCase():"")),SD=/\B([A-Z])/g,Gh=f2(e=>e.replace(SD,"-$1").toLowerCase()),O_=f2(e=>e.charAt(0).toUpperCase()+e.slice(1)),Nv=f2(e=>e?`on${O_(e)}`:""),wh=(e,t)=>!Object.is(e,t),k0=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},xM=(e,t,n,r=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:r,value:n})},Sx=e=>{const t=parseFloat(e);return isNaN(t)?e:t},Lx=e=>{const t=Fa(e)?Number(e):NaN;return isNaN(t)?e:t};let _S;const p2=()=>_S||(_S=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),LD="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console,Error,Symbol",PD=h2(LD);function Zh(e){if(bi(e)){const t={};for(let n=0;n<e.length;n++){const r=e[n],i=Fa(r)?AD(r):Zh(r);if(i)for(const l in i)t[l]=i[l]}return t}else if(Fa(e)||la(e))return e}const ED=/;(?![^(]*\))/g,MD=/:([^]+)/,TD=/\/\*[^]*?\*\//g;function AD(e){const t={};return e.replace(TD,"").split(ED).forEach(n=>{if(n){const r=n.split(MD);r.length>1&&(t[r[0].trim()]=r[1].trim())}}),t}function $s(e){let t="";if(Fa(e))t=e;else if(bi(e))for(let n=0;n<e.length;n++){const r=$s(e[n]);r&&(t+=r+" ")}else if(la(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}function kD(e){if(!e)return null;let{class:t,style:n}=e;return t&&!Fa(t)&&(e.class=$s(t)),n&&(e.style=Zh(n)),e}const ID="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",DD=h2(ID);function wM(e){return!!e||e===""}function OD(e,t){if(e.length!==t.length)return!1;let n=!0;for(let r=0;n&&r<e.length;r++)n=fm(e[r],t[r]);return n}function fm(e,t){if(e===t)return!0;let n=vS(e),r=vS(t);if(n||r)return n&&r?e.getTime()===t.getTime():!1;if(n=of(e),r=of(t),n||r)return e===t;if(n=bi(e),r=bi(t),n||r)return n&&r?OD(e,t):!1;if(n=la(e),r=la(t),n||r){if(!n||!r)return!1;const i=Object.keys(e).length,l=Object.keys(t).length;if(i!==l)return!1;for(const a in e){const o=e.hasOwnProperty(a),f=t.hasOwnProperty(a);if(o&&!f||!o&&f||!fm(e[a],t[a]))return!1}}return String(e)===String(t)}function m2(e,t){return e.findIndex(n=>fm(n,t))}const CM=e=>!!(e&&e.__v_isRef===!0),er=e=>Fa(e)?e:e==null?"":bi(e)||la(e)&&(e.toString===bM||!Ki(e.toString))?CM(e)?er(e.value):JSON.stringify(e,SM,2):String(e),SM=(e,t)=>CM(t)?SM(e,t.value):T0(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[r,i],l)=>(n[f5(r,l)+" =>"]=i,n),{})}:Pg(t)?{[`Set(${t.size})`]:[...t.values()].map(n=>f5(n))}:of(t)?f5(t):la(t)&&!bi(t)&&!d2(t)?String(t):t,f5=(e,t="")=>{var n;return of(e)?`Symbol(${(n=e.description)!=null?n:t})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let xh;class H3{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=xh,!t&&xh&&(this.index=(xh.scopes||(xh.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].pause();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].resume();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].resume()}}run(t){if(this._active){const n=xh;try{return xh=this,t()}finally{xh=n}}}on(){xh=this}off(){xh=this.parent}stop(t){if(this._active){this._active=!1;let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(this.effects.length=0,n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function q3(e){return new H3(e)}function W3(){return xh}function LM(e,t=!1){xh&&xh.cleanups.push(e)}let Ra;const p5=new WeakSet;class a_{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,xh&&xh.active&&xh.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,p5.has(this)&&(p5.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||EM(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,bS(this),MM(this);const t=Ra,n=rf;Ra=this,rf=!0;try{return this.fn()}finally{TM(this),Ra=t,rf=n,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Y3(t);this.deps=this.depsTail=void 0,bS(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?p5.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){_4(this)&&this.run()}get dirty(){return _4(this)}}let PM=0,Fv,zv;function EM(e,t=!1){if(e.flags|=8,t){e.next=zv,zv=e;return}e.next=Fv,Fv=e}function Z3(){PM++}function K3(){if(--PM>0)return;if(zv){let t=zv;for(zv=void 0;t;){const n=t.next;t.next=void 0,t.flags&=-9,t=n}}let e;for(;Fv;){let t=Fv;for(Fv=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(r){e||(e=r)}t=n}}if(e)throw e}function MM(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function TM(e){let t,n=e.depsTail,r=n;for(;r;){const i=r.prevDep;r.version===-1?(r===n&&(n=i),Y3(r),RD(r)):t=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=i}e.deps=t,e.depsTail=n}function _4(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(AM(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function AM(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===l_))return;e.globalVersion=l_;const t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!_4(e)){e.flags&=-3;return}const n=Ra,r=rf;Ra=e,rf=!0;try{MM(e);const i=e.fn(e._value);(t.version===0||wh(i,e._value))&&(e._value=i,t.version++)}catch(i){throw t.version++,i}finally{Ra=n,rf=r,TM(e),e.flags&=-3}}function Y3(e,t=!1){const{dep:n,prevSub:r,nextSub:i}=e;if(r&&(r.nextSub=i,e.prevSub=void 0),i&&(i.prevSub=r,e.nextSub=void 0),n.subs===e&&(n.subs=r,!r&&n.computed)){n.computed.flags&=-5;for(let l=n.computed.deps;l;l=l.nextDep)Y3(l,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function RD(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}function BD(e,t){e.effect instanceof a_&&(e=e.effect.fn);const n=new a_(e);t&&wa(n,t);try{n.run()}catch(i){throw n.stop(),i}const r=n.run.bind(n);return r.effect=n,r}function ND(e){e.effect.stop()}let rf=!0;const kM=[];function bm(){kM.push(rf),rf=!1}function xm(){const e=kM.pop();rf=e===void 0?!0:e}function bS(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const n=Ra;Ra=void 0;try{t()}finally{Ra=n}}}let l_=0;class FD{constructor(t,n){this.sub=t,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class g2{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!Ra||!rf||Ra===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==Ra)n=this.activeLink=new FD(Ra,this),Ra.deps?(n.prevDep=Ra.depsTail,Ra.depsTail.nextDep=n,Ra.depsTail=n):Ra.deps=Ra.depsTail=n,IM(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const r=n.nextDep;r.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=r),n.prevDep=Ra.depsTail,n.nextDep=void 0,Ra.depsTail.nextDep=n,Ra.depsTail=n,Ra.deps===n&&(Ra.deps=r)}return n}trigger(t){this.version++,l_++,this.notify(t)}notify(t){Z3();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{K3()}}}function IM(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let r=t.deps;r;r=r.nextDep)IM(r)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const Px=new WeakMap,dg=Symbol(""),b4=Symbol(""),u_=Symbol("");function Jc(e,t,n){if(rf&&Ra){let r=Px.get(e);r||Px.set(e,r=new Map);let i=r.get(n);i||(r.set(n,i=new g2),i.map=r,i.key=n),i.track()}}function hp(e,t,n,r,i,l){const a=Px.get(e);if(!a){l_++;return}const o=f=>{f&&f.trigger()};if(Z3(),t==="clear")a.forEach(o);else{const f=bi(e),m=f&&G3(n);if(f&&n==="length"){const _=Number(r);a.forEach((w,M)=>{(M==="length"||M===u_||!of(M)&&M>=_)&&o(w)})}else switch((n!==void 0||a.has(void 0))&&o(a.get(n)),m&&o(a.get(u_)),t){case"add":f?m&&o(a.get("length")):(o(a.get(dg)),T0(e)&&o(a.get(b4)));break;case"delete":f||(o(a.get(dg)),T0(e)&&o(a.get(b4)));break;case"set":T0(e)&&o(a.get(dg));break}}K3()}function zD(e,t){const n=Px.get(e);return n&&n.get(t)}function o0(e){const t=eo(e);return t===e?t:(Jc(t,"iterate",u_),md(e)?t:t.map(Qc))}function y2(e){return Jc(e=eo(e),"iterate",u_),e}const jD={__proto__:null,[Symbol.iterator](){return m5(this,Symbol.iterator,Qc)},concat(...e){return o0(this).concat(...e.map(t=>bi(t)?o0(t):t))},entries(){return m5(this,"entries",e=>(e[1]=Qc(e[1]),e))},every(e,t){return np(this,"every",e,t,void 0,arguments)},filter(e,t){return np(this,"filter",e,t,n=>n.map(Qc),arguments)},find(e,t){return np(this,"find",e,t,Qc,arguments)},findIndex(e,t){return np(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return np(this,"findLast",e,t,Qc,arguments)},findLastIndex(e,t){return np(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return np(this,"forEach",e,t,void 0,arguments)},includes(...e){return g5(this,"includes",e)},indexOf(...e){return g5(this,"indexOf",e)},join(e){return o0(this).join(e)},lastIndexOf(...e){return g5(this,"lastIndexOf",e)},map(e,t){return np(this,"map",e,t,void 0,arguments)},pop(){return tv(this,"pop")},push(...e){return tv(this,"push",e)},reduce(e,...t){return xS(this,"reduce",e,t)},reduceRight(e,...t){return xS(this,"reduceRight",e,t)},shift(){return tv(this,"shift")},some(e,t){return np(this,"some",e,t,void 0,arguments)},splice(...e){return tv(this,"splice",e)},toReversed(){return o0(this).toReversed()},toSorted(e){return o0(this).toSorted(e)},toSpliced(...e){return o0(this).toSpliced(...e)},unshift(...e){return tv(this,"unshift",e)},values(){return m5(this,"values",Qc)}};function m5(e,t,n){const r=y2(e),i=r[t]();return r!==e&&!md(e)&&(i._next=i.next,i.next=()=>{const l=i._next();return l.value&&(l.value=n(l.value)),l}),i}const UD=Array.prototype;function np(e,t,n,r,i,l){const a=y2(e),o=a!==e&&!md(e),f=a[t];if(f!==UD[t]){const w=f.apply(e,l);return o?Qc(w):w}let m=n;a!==e&&(o?m=function(w,M){return n.call(this,Qc(w),M,e)}:n.length>2&&(m=function(w,M){return n.call(this,w,M,e)}));const _=f.call(a,m,r);return o&&i?i(_):_}function xS(e,t,n,r){const i=y2(e);let l=n;return i!==e&&(md(e)?n.length>3&&(l=function(a,o,f){return n.call(this,a,o,f,e)}):l=function(a,o,f){return n.call(this,a,Qc(o),f,e)}),i[t](l,...r)}function g5(e,t,n){const r=eo(e);Jc(r,"iterate",u_);const i=r[t](...n);return(i===-1||i===!1)&&b2(n[0])?(n[0]=eo(n[0]),r[t](...n)):i}function tv(e,t,n=[]){bm(),Z3();const r=eo(e)[t].apply(e,n);return K3(),xm(),r}const VD=h2("__proto__,__v_isRef,__isVue"),DM=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(of));function $D(e){of(e)||(e=String(e));const t=eo(this);return Jc(t,"has",e),t.hasOwnProperty(e)}class OM{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,r){if(n==="__v_skip")return t.__v_skip;const i=this._isReadonly,l=this._isShallow;if(n==="__v_isReactive")return!i;if(n==="__v_isReadonly")return i;if(n==="__v_isShallow")return l;if(n==="__v_raw")return r===(i?l?jM:zM:l?FM:NM).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(r)?t:void 0;const a=bi(t);if(!i){let f;if(a&&(f=jD[n]))return f;if(n==="hasOwnProperty")return $D}const o=Reflect.get(t,n,Ol(t)?t:r);return(of(n)?DM.has(n):VD(n))||(i||Jc(t,"get",n),l)?o:Ol(o)?a&&G3(n)?o:o.value:la(o)?i?J3(o):bd(o):o}}class RM extends OM{constructor(t=!1){super(!1,t)}set(t,n,r,i){let l=t[n];if(!this._isShallow){const f=pm(l);if(!md(r)&&!pm(r)&&(l=eo(l),r=eo(r)),!bi(t)&&Ol(l)&&!Ol(r))return f?!1:(l.value=r,!0)}const a=bi(t)&&G3(n)?Number(n)<t.length:xo(t,n),o=Reflect.set(t,n,r,Ol(t)?t:i);return t===eo(i)&&(a?wh(r,l)&&hp(t,"set",n,r):hp(t,"add",n,r)),o}deleteProperty(t,n){const r=xo(t,n);t[n];const i=Reflect.deleteProperty(t,n);return i&&r&&hp(t,"delete",n,void 0),i}has(t,n){const r=Reflect.has(t,n);return(!of(n)||!DM.has(n))&&Jc(t,"has",n),r}ownKeys(t){return Jc(t,"iterate",bi(t)?"length":dg),Reflect.ownKeys(t)}}class BM extends OM{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const GD=new RM,HD=new BM,qD=new RM(!0),WD=new BM(!0),x4=e=>e,lb=e=>Reflect.getPrototypeOf(e);function ZD(e,t,n){return function(...r){const i=this.__v_raw,l=eo(i),a=T0(l),o=e==="entries"||e===Symbol.iterator&&a,f=e==="keys"&&a,m=i[e](...r),_=n?x4:t?w4:Qc;return!t&&Jc(l,"iterate",f?b4:dg),{next(){const{value:w,done:M}=m.next();return M?{value:w,done:M}:{value:o?[_(w[0]),_(w[1])]:_(w),done:M}},[Symbol.iterator](){return this}}}}function ub(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function KD(e,t){const n={get(i){const l=this.__v_raw,a=eo(l),o=eo(i);e||(wh(i,o)&&Jc(a,"get",i),Jc(a,"get",o));const{has:f}=lb(a),m=t?x4:e?w4:Qc;if(f.call(a,i))return m(l.get(i));if(f.call(a,o))return m(l.get(o));l!==a&&l.get(i)},get size(){const i=this.__v_raw;return!e&&Jc(eo(i),"iterate",dg),Reflect.get(i,"size",i)},has(i){const l=this.__v_raw,a=eo(l),o=eo(i);return e||(wh(i,o)&&Jc(a,"has",i),Jc(a,"has",o)),i===o?l.has(i):l.has(i)||l.has(o)},forEach(i,l){const a=this,o=a.__v_raw,f=eo(o),m=t?x4:e?w4:Qc;return!e&&Jc(f,"iterate",dg),o.forEach((_,w)=>i.call(l,m(_),m(w),a))}};return wa(n,e?{add:ub("add"),set:ub("set"),delete:ub("delete"),clear:ub("clear")}:{add(i){!t&&!md(i)&&!pm(i)&&(i=eo(i));const l=eo(this);return lb(l).has.call(l,i)||(l.add(i),hp(l,"add",i,i)),this},set(i,l){!t&&!md(l)&&!pm(l)&&(l=eo(l));const a=eo(this),{has:o,get:f}=lb(a);let m=o.call(a,i);m||(i=eo(i),m=o.call(a,i));const _=f.call(a,i);return a.set(i,l),m?wh(l,_)&&hp(a,"set",i,l):hp(a,"add",i,l),this},delete(i){const l=eo(this),{has:a,get:o}=lb(l);let f=a.call(l,i);f||(i=eo(i),f=a.call(l,i)),o&&o.call(l,i);const m=l.delete(i);return f&&hp(l,"delete",i,void 0),m},clear(){const i=eo(this),l=i.size!==0,a=i.clear();return l&&hp(i,"clear",void 0,void 0),a}}),["keys","values","entries",Symbol.iterator].forEach(i=>{n[i]=ZD(i,e,t)}),n}function v2(e,t){const n=KD(e,t);return(r,i,l)=>i==="__v_isReactive"?!e:i==="__v_isReadonly"?e:i==="__v_raw"?r:Reflect.get(xo(n,i)&&i in r?n:r,i,l)}const YD={get:v2(!1,!1)},XD={get:v2(!1,!0)},JD={get:v2(!0,!1)},QD={get:v2(!0,!0)},NM=new WeakMap,FM=new WeakMap,zM=new WeakMap,jM=new WeakMap;function eO(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function tO(e){return e.__v_skip||!Object.isExtensible(e)?0:eO(wD(e))}function bd(e){return pm(e)?e:_2(e,!1,GD,YD,NM)}function X3(e){return _2(e,!1,qD,XD,FM)}function J3(e){return _2(e,!0,HD,JD,zM)}function nO(e){return _2(e,!0,WD,QD,jM)}function _2(e,t,n,r,i){if(!la(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const l=i.get(e);if(l)return l;const a=tO(e);if(a===0)return e;const o=new Proxy(e,a===2?r:n);return i.set(e,o),o}function Of(e){return pm(e)?Of(e.__v_raw):!!(e&&e.__v_isReactive)}function pm(e){return!!(e&&e.__v_isReadonly)}function md(e){return!!(e&&e.__v_isShallow)}function b2(e){return e?!!e.__v_raw:!1}function eo(e){const t=e&&e.__v_raw;return t?eo(t):e}function x2(e){return!xo(e,"__v_skip")&&Object.isExtensible(e)&&xM(e,"__v_skip",!0),e}const Qc=e=>la(e)?bd(e):e,w4=e=>la(e)?J3(e):e;function Ol(e){return e?e.__v_isRef===!0:!1}function Rn(e){return UM(e,!1)}function Q3(e){return UM(e,!0)}function UM(e,t){return Ol(e)?e:new rO(e,t)}class rO{constructor(t,n){this.dep=new g2,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?t:eo(t),this._value=n?t:Qc(t),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(t){const n=this._rawValue,r=this.__v_isShallow||md(t)||pm(t);t=r?t:eo(t),wh(t,n)&&(this._rawValue=t,this._value=r?t:Qc(t),this.dep.trigger())}}function iO(e){e.dep&&e.dep.trigger()}function Tr(e){return Ol(e)?e.value:e}function sO(e){return Ki(e)?e():Tr(e)}const oO={get:(e,t,n)=>t==="__v_raw"?e:Tr(Reflect.get(e,t,n)),set:(e,t,n,r)=>{const i=e[t];return Ol(i)&&!Ol(n)?(i.value=n,!0):Reflect.set(e,t,n,r)}};function eC(e){return Of(e)?e:new Proxy(e,oO)}class aO{constructor(t){this.__v_isRef=!0,this._value=void 0;const n=this.dep=new g2,{get:r,set:i}=t(n.track.bind(n),n.trigger.bind(n));this._get=r,this._set=i}get value(){return this._value=this._get()}set value(t){this._set(t)}}function VM(e){return new aO(e)}function tC(e){const t=bi(e)?new Array(e.length):{};for(const n in e)t[n]=$M(e,n);return t}class lO{constructor(t,n,r){this._object=t,this._key=n,this._defaultValue=r,this.__v_isRef=!0,this._value=void 0}get value(){const t=this._object[this._key];return this._value=t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return zD(eo(this._object),this._key)}}class uO{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function cO(e,t,n){return Ol(e)?e:Ki(e)?new uO(e):la(e)&&arguments.length>1?$M(e,t,n):Rn(e)}function $M(e,t,n){const r=e[t];return Ol(r)?r:new lO(e,t,n)}class hO{constructor(t,n,r){this.fn=t,this.setter=n,this._value=void 0,this.dep=new g2(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=l_-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&Ra!==this)return EM(this,!0),!0}get value(){const t=this.dep.track();return AM(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function dO(e,t,n=!1){let r,i;return Ki(e)?r=e:(r=e.get,i=e.set),new hO(r,i,n)}const fO={GET:"get",HAS:"has",ITERATE:"iterate"},pO={SET:"set",ADD:"add",DELETE:"delete",CLEAR:"clear"},cb={},Ex=new WeakMap;let Kp;function mO(){return Kp}function GM(e,t=!1,n=Kp){if(n){let r=Ex.get(n);r||Ex.set(n,r=[]),r.push(e)}}function gO(e,t,n=no){const{immediate:r,deep:i,once:l,scheduler:a,augmentJob:o,call:f}=n,m=oe=>i?oe:md(oe)||i===!1||i===0?dp(oe,1):dp(oe);let _,w,M,C,R=!1,z=!1;if(Ol(e)?(w=()=>e.value,R=md(e)):Of(e)?(w=()=>m(e),R=!0):bi(e)?(z=!0,R=e.some(oe=>Of(oe)||md(oe)),w=()=>e.map(oe=>{if(Ol(oe))return oe.value;if(Of(oe))return m(oe);if(Ki(oe))return f?f(oe,2):oe()})):Ki(e)?t?w=f?()=>f(e,2):e:w=()=>{if(M){bm();try{M()}finally{xm()}}const oe=Kp;Kp=_;try{return f?f(e,3,[C]):e(C)}finally{Kp=oe}}:w=Od,t&&i){const oe=w,le=i===!0?1/0:i;w=()=>dp(oe(),le)}const W=W3(),X=()=>{_.stop(),W&&W.active&&V3(W.effects,_)};if(l&&t){const oe=t;t=(...le)=>{oe(...le),X()}}let Y=z?new Array(e.length).fill(cb):cb;const Q=oe=>{if(!(!(_.flags&1)||!_.dirty&&!oe))if(t){const le=_.run();if(i||R||(z?le.some((me,we)=>wh(me,Y[we])):wh(le,Y))){M&&M();const me=Kp;Kp=_;try{const we=[le,Y===cb?void 0:z&&Y[0]===cb?[]:Y,C];f?f(t,3,we):t(...we),Y=le}finally{Kp=me}}}else _.run()};return o&&o(Q),_=new a_(w),_.scheduler=a?()=>a(Q,!1):Q,C=oe=>GM(oe,!1,_),M=_.onStop=()=>{const oe=Ex.get(_);if(oe){if(f)f(oe,4);else for(const le of oe)le();Ex.delete(_)}},t?r?Q(!0):Y=_.run():a?a(Q.bind(null,!0),!0):_.run(),X.pause=_.pause.bind(_),X.resume=_.resume.bind(_),X.stop=X,X}function dp(e,t=1/0,n){if(t<=0||!la(e)||e.__v_skip||(n=n||new Set,n.has(e)))return e;if(n.add(e),t--,Ol(e))dp(e.value,t,n);else if(bi(e))for(let r=0;r<e.length;r++)dp(e[r],t,n);else if(Pg(e)||T0(e))e.forEach(r=>{dp(r,t,n)});else if(d2(e)){for(const r in e)dp(e[r],t,n);for(const r of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,r)&&dp(e[r],t,n)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const HM=[];function yO(e){HM.push(e)}function vO(){HM.pop()}function _O(e,t){}const bO={SETUP_FUNCTION:0,0:"SETUP_FUNCTION",RENDER_FUNCTION:1,1:"RENDER_FUNCTION",NATIVE_EVENT_HANDLER:5,5:"NATIVE_EVENT_HANDLER",COMPONENT_EVENT_HANDLER:6,6:"COMPONENT_EVENT_HANDLER",VNODE_HOOK:7,7:"VNODE_HOOK",DIRECTIVE_HOOK:8,8:"DIRECTIVE_HOOK",TRANSITION_HOOK:9,9:"TRANSITION_HOOK",APP_ERROR_HANDLER:10,10:"APP_ERROR_HANDLER",APP_WARN_HANDLER:11,11:"APP_WARN_HANDLER",FUNCTION_REF:12,12:"FUNCTION_REF",ASYNC_COMPONENT_LOADER:13,13:"ASYNC_COMPONENT_LOADER",SCHEDULER:14,14:"SCHEDULER",COMPONENT_UPDATE:15,15:"COMPONENT_UPDATE",APP_UNMOUNT_CLEANUP:16,16:"APP_UNMOUNT_CLEANUP"},xO={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",0:"setup function",1:"render function",2:"watcher getter",3:"watcher callback",4:"watcher cleanup function",5:"native event handler",6:"component event handler",7:"vnode hook",8:"directive hook",9:"transition hook",10:"app errorHandler",11:"app warnHandler",12:"ref function",13:"async component loader",14:"scheduler flush",15:"component update",16:"app unmount cleanup function"};function ey(e,t,n,r){try{return r?e(...r):e()}catch(i){Eg(i,t,n)}}function Nd(e,t,n,r){if(Ki(e)){const i=ey(e,t,n,r);return i&&$3(i)&&i.catch(l=>{Eg(l,t,n)}),i}if(bi(e)){const i=[];for(let l=0;l<e.length;l++)i.push(Nd(e[l],t,n,r));return i}}function Eg(e,t,n,r=!0){const i=t?t.vnode:null,{errorHandler:l,throwUnhandledErrorInProduction:a}=t&&t.appContext.config||no;if(t){let o=t.parent;const f=t.proxy,m=`https://vuejs.org/error-reference/#runtime-${n}`;for(;o;){const _=o.ec;if(_){for(let w=0;w<_.length;w++)if(_[w](e,f,m)===!1)return}o=o.parent}if(l){bm(),ey(l,null,10,[e,f,m]),xm();return}}wO(e,n,i,r,a)}function wO(e,t,n,r=!0,i=!1){if(i)throw e;console.error(e)}const Ch=[];let Ef=-1;const I0=[];let Yp=null,v0=0;const qM=Promise.resolve();let Mx=null;function Sh(e){const t=Mx||qM;return e?t.then(this?e.bind(this):e):t}function CO(e){let t=Ef+1,n=Ch.length;for(;t<n;){const r=t+n>>>1,i=Ch[r],l=h_(i);l<e||l===e&&i.flags&2?t=r+1:n=r}return t}function nC(e){if(!(e.flags&1)){const t=h_(e),n=Ch[Ch.length-1];!n||!(e.flags&2)&&t>=h_(n)?Ch.push(e):Ch.splice(CO(t),0,e),e.flags|=1,WM()}}function WM(){Mx||(Mx=qM.then(ZM))}function c_(e){bi(e)?I0.push(...e):Yp&&e.id===-1?Yp.splice(v0+1,0,e):e.flags&1||(I0.push(e),e.flags|=1),WM()}function wS(e,t,n=Ef+1){for(;n<Ch.length;n++){const r=Ch[n];if(r&&r.flags&2){if(e&&r.id!==e.uid)continue;Ch.splice(n,1),n--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function Tx(e){if(I0.length){const t=[...new Set(I0)].sort((n,r)=>h_(n)-h_(r));if(I0.length=0,Yp){Yp.push(...t);return}for(Yp=t,v0=0;v0<Yp.length;v0++){const n=Yp[v0];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}Yp=null,v0=0}}const h_=e=>e.id==null?e.flags&2?-1:1/0:e.id;function ZM(e){try{for(Ef=0;Ef<Ch.length;Ef++){const t=Ch[Ef];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),ey(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Ef<Ch.length;Ef++){const t=Ch[Ef];t&&(t.flags&=-2)}Ef=-1,Ch.length=0,Tx(),Mx=null,(Ch.length||I0.length)&&ZM()}}let _0,hb=[];function KM(e,t){var n,r;_0=e,_0?(_0.enabled=!0,hb.forEach(({event:i,args:l})=>_0.emit(i,...l)),hb=[]):typeof window<"u"&&window.HTMLElement&&!((r=(n=window.navigator)==null?void 0:n.userAgent)!=null&&r.includes("jsdom"))?((t.__VUE_DEVTOOLS_HOOK_REPLAY__=t.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(l=>{KM(l,t)}),setTimeout(()=>{_0||(t.__VUE_DEVTOOLS_HOOK_REPLAY__=null,hb=[])},3e3)):hb=[]}let uc=null,w2=null;function d_(e){const t=uc;return uc=e,w2=e&&e.type.__scopeId||null,t}function SO(e){w2=e}function LO(){w2=null}const PO=e=>Hh;function Hh(e,t=uc,n){if(!t||e._n)return e;const r=(...i)=>{r._d&&A4(-1);const l=d_(t);let a;try{a=e(...i)}finally{d_(l),r._d&&A4(1)}return a};return r._n=!0,r._c=!0,r._d=!0,r}function li(e,t){if(uc===null)return e;const n=N_(uc),r=e.dirs||(e.dirs=[]);for(let i=0;i<t.length;i++){let[l,a,o,f=no]=t[i];l&&(Ki(l)&&(l={mounted:l,updated:l}),l.deep&&dp(a),r.push({dir:l,instance:n,value:a,oldValue:void 0,arg:o,modifiers:f}))}return e}function Tf(e,t,n,r){const i=e.dirs,l=t&&t.dirs;for(let a=0;a<i.length;a++){const o=i[a];l&&(o.oldValue=l[a].value);let f=o.dir[r];f&&(bm(),Nd(f,n,8,[e.el,o,e,t]),xm())}}const YM=Symbol("_vte"),XM=e=>e.__isTeleport,jv=e=>e&&(e.disabled||e.disabled===""),CS=e=>e&&(e.defer||e.defer===""),SS=e=>typeof SVGElement<"u"&&e instanceof SVGElement,LS=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,C4=(e,t)=>{const n=e&&e.to;return Fa(n)?t?t(n):null:n},JM={name:"Teleport",__isTeleport:!0,process(e,t,n,r,i,l,a,o,f,m){const{mc:_,pc:w,pbc:M,o:{insert:C,querySelector:R,createText:z,createComment:W}}=m,X=jv(t.props);let{shapeFlag:Y,children:Q,dynamicChildren:oe}=t;if(e==null){const le=t.el=z(""),me=t.anchor=z("");C(le,n,r),C(me,n,r);const we=(_e,We)=>{Y&16&&(i&&i.isCE&&(i.ce._teleportTarget=_e),_(Q,_e,We,i,l,a,o,f))},ue=()=>{const _e=t.target=C4(t.props,R),We=QM(_e,t,z,C);_e&&(a!=="svg"&&SS(_e)?a="svg":a!=="mathml"&&LS(_e)&&(a="mathml"),X||(we(_e,We),Yb(t,!1)))};X&&(we(n,me),Yb(t,!0)),CS(t.props)?oc(()=>{ue(),t.el.__isMounted=!0},l):ue()}else{if(CS(t.props)&&!e.el.__isMounted){oc(()=>{JM.process(e,t,n,r,i,l,a,o,f,m),delete e.el.__isMounted},l);return}t.el=e.el,t.targetStart=e.targetStart;const le=t.anchor=e.anchor,me=t.target=e.target,we=t.targetAnchor=e.targetAnchor,ue=jv(e.props),_e=ue?n:me,We=ue?le:we;if(a==="svg"||SS(me)?a="svg":(a==="mathml"||LS(me))&&(a="mathml"),oe?(M(e.dynamicChildren,oe,_e,i,l,a,o),fC(e,t,!0)):f||w(e,t,_e,We,i,l,a,o,!1),X)ue?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):db(t,n,le,m,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const he=t.target=C4(t.props,R);he&&db(t,he,null,m,0)}else ue&&db(t,me,we,m,1);Yb(t,X)}},remove(e,t,n,{um:r,o:{remove:i}},l){const{shapeFlag:a,children:o,anchor:f,targetStart:m,targetAnchor:_,target:w,props:M}=e;if(w&&(i(m),i(_)),l&&i(f),a&16){const C=l||!jv(M);for(let R=0;R<o.length;R++){const z=o[R];r(z,t,n,C,!!z.dynamicChildren)}}},move:db,hydrate:EO};function db(e,t,n,{o:{insert:r},m:i},l=2){l===0&&r(e.targetAnchor,t,n);const{el:a,anchor:o,shapeFlag:f,children:m,props:_}=e,w=l===2;if(w&&r(a,t,n),(!w||jv(_))&&f&16)for(let M=0;M<m.length;M++)i(m[M],t,n,2);w&&r(o,t,n)}function EO(e,t,n,r,i,l,{o:{nextSibling:a,parentNode:o,querySelector:f,insert:m,createText:_}},w){const M=t.target=C4(t.props,f);if(M){const C=jv(t.props),R=M._lpa||M.firstChild;if(t.shapeFlag&16)if(C)t.anchor=w(a(e),t,o(e),n,r,i,l),t.targetStart=R,t.targetAnchor=R&&a(R);else{t.anchor=a(e);let z=R;for(;z;){if(z&&z.nodeType===8){if(z.data==="teleport start anchor")t.targetStart=z;else if(z.data==="teleport anchor"){t.targetAnchor=z,M._lpa=t.targetAnchor&&a(t.targetAnchor);break}}z=a(z)}t.targetAnchor||QM(M,t,_,m),w(R&&a(R),t,M,n,r,i,l)}Yb(t,C)}return t.anchor&&a(t.anchor)}const b0=JM;function Yb(e,t){const n=e.ctx;if(n&&n.ut){let r,i;for(t?(r=e.el,i=e.anchor):(r=e.targetStart,i=e.targetAnchor);r&&r!==i;)r.nodeType===1&&r.setAttribute("data-v-owner",n.uid),r=r.nextSibling;n.ut()}}function QM(e,t,n,r){const i=t.targetStart=n(""),l=t.targetAnchor=n("");return i[YM]=l,e&&(r(i,e),r(l,e)),l}const Xp=Symbol("_leaveCb"),fb=Symbol("_enterCb");function rC(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Rl(()=>{e.isMounted=!0}),wm(()=>{e.isUnmounting=!0}),e}const Td=[Function,Array],iC={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Td,onEnter:Td,onAfterEnter:Td,onEnterCancelled:Td,onBeforeLeave:Td,onLeave:Td,onAfterLeave:Td,onLeaveCancelled:Td,onBeforeAppear:Td,onAppear:Td,onAfterAppear:Td,onAppearCancelled:Td},eT=e=>{const t=e.subTree;return t.component?eT(t.component):t},MO={name:"BaseTransition",props:iC,setup(e,{slots:t}){const n=zd(),r=rC();return()=>{const i=t.default&&C2(t.default(),!0);if(!i||!i.length)return;const l=tT(i),a=eo(e),{mode:o}=a;if(r.isLeaving)return y5(l);const f=PS(l);if(!f)return y5(l);let m=j0(f,a,r,n,w=>m=w);f.type!==qu&&_p(f,m);let _=n.subTree&&PS(n.subTree);if(_&&_.type!==qu&&!ef(f,_)&&eT(n).type!==qu){let w=j0(_,a,r,n);if(_p(_,w),o==="out-in"&&f.type!==qu)return r.isLeaving=!0,w.afterLeave=()=>{r.isLeaving=!1,n.job.flags&8||n.update(),delete w.afterLeave,_=void 0},y5(l);o==="in-out"&&f.type!==qu?w.delayLeave=(M,C,R)=>{const z=rT(r,_);z[String(_.key)]=_,M[Xp]=()=>{C(),M[Xp]=void 0,delete m.delayedLeave,_=void 0},m.delayedLeave=()=>{R(),delete m.delayedLeave,_=void 0}}:_=void 0}else _&&(_=void 0);return l}}};function tT(e){let t=e[0];if(e.length>1){for(const n of e)if(n.type!==qu){t=n;break}}return t}const nT=MO;function rT(e,t){const{leavingVNodes:n}=e;let r=n.get(t.type);return r||(r=Object.create(null),n.set(t.type,r)),r}function j0(e,t,n,r,i){const{appear:l,mode:a,persisted:o=!1,onBeforeEnter:f,onEnter:m,onAfterEnter:_,onEnterCancelled:w,onBeforeLeave:M,onLeave:C,onAfterLeave:R,onLeaveCancelled:z,onBeforeAppear:W,onAppear:X,onAfterAppear:Y,onAppearCancelled:Q}=t,oe=String(e.key),le=rT(n,e),me=(_e,We)=>{_e&&Nd(_e,r,9,We)},we=(_e,We)=>{const he=We[1];me(_e,We),bi(_e)?_e.every(de=>de.length<=1)&&he():_e.length<=1&&he()},ue={mode:a,persisted:o,beforeEnter(_e){let We=f;if(!n.isMounted)if(l)We=W||f;else return;_e[Xp]&&_e[Xp](!0);const he=le[oe];he&&ef(e,he)&&he.el[Xp]&&he.el[Xp](),me(We,[_e])},enter(_e){let We=m,he=_,de=w;if(!n.isMounted)if(l)We=X||m,he=Y||_,de=Q||w;else return;let Te=!1;const be=_e[fb]=ae=>{Te||(Te=!0,ae?me(de,[_e]):me(he,[_e]),ue.delayedLeave&&ue.delayedLeave(),_e[fb]=void 0)};We?we(We,[_e,be]):be()},leave(_e,We){const he=String(e.key);if(_e[fb]&&_e[fb](!0),n.isUnmounting)return We();me(M,[_e]);let de=!1;const Te=_e[Xp]=be=>{de||(de=!0,We(),be?me(z,[_e]):me(R,[_e]),_e[Xp]=void 0,le[he]===e&&delete le[he])};le[he]=e,C?we(C,[_e,Te]):Te()},clone(_e){const We=j0(_e,t,n,r,i);return i&&i(We),We}};return ue}function y5(e){if(R_(e))return e=Ff(e),e.children=null,e}function PS(e){if(!R_(e))return XM(e.type)&&e.children?tT(e.children):e;const{shapeFlag:t,children:n}=e;if(n){if(t&16)return n[0];if(t&32&&Ki(n.default))return n.default()}}function _p(e,t){e.shapeFlag&6&&e.component?(e.transition=t,_p(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function C2(e,t=!1,n){let r=[],i=0;for(let l=0;l<e.length;l++){let a=e[l];const o=n==null?a.key:String(n)+String(a.key!=null?a.key:l);a.type===$r?(a.patchFlag&128&&i++,r=r.concat(C2(a.children,t,o))):(t||a.type!==qu)&&r.push(o!=null?Ff(a,{key:o}):a)}if(i>1)for(let l=0;l<r.length;l++)r[l].patchFlag=-2;return r}/*! #__NO_SIDE_EFFECTS__ */function Ja(e,t){return Ki(e)?wa({name:e.name},t,{setup:e}):e}function TO(){const e=zd();return e?(e.appContext.config.idPrefix||"v")+"-"+e.ids[0]+e.ids[1]++:""}function sC(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function AO(e){const t=zd(),n=Q3(null);if(t){const i=t.refs===no?t.refs={}:t.refs;Object.defineProperty(i,e,{enumerable:!0,get:()=>n.value,set:l=>n.value=l})}return n}function f_(e,t,n,r,i=!1){if(bi(e)){e.forEach((R,z)=>f_(R,t&&(bi(t)?t[z]:t),n,r,i));return}if(cm(r)&&!i){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&f_(e,t,n,r.component.subTree);return}const l=r.shapeFlag&4?N_(r.component):r.el,a=i?null:l,{i:o,r:f}=e,m=t&&t.r,_=o.refs===no?o.refs={}:o.refs,w=o.setupState,M=eo(w),C=w===no?()=>!1:R=>xo(M,R);if(m!=null&&m!==f&&(Fa(m)?(_[m]=null,C(m)&&(w[m]=null)):Ol(m)&&(m.value=null)),Ki(f))ey(f,o,12,[a,_]);else{const R=Fa(f),z=Ol(f);if(R||z){const W=()=>{if(e.f){const X=R?C(f)?w[f]:_[f]:f.value;i?bi(X)&&V3(X,l):bi(X)?X.includes(l)||X.push(l):R?(_[f]=[l],C(f)&&(w[f]=_[f])):(f.value=[l],e.k&&(_[e.k]=f.value))}else R?(_[f]=a,C(f)&&(w[f]=a)):z&&(f.value=a,e.k&&(_[e.k]=a))};a?(W.id=-1,oc(W,n)):W()}}}let ES=!1;const a0=()=>{ES||(console.error("Hydration completed but contains mismatches."),ES=!0)},kO=e=>e.namespaceURI.includes("svg")&&e.tagName!=="foreignObject",IO=e=>e.namespaceURI.includes("MathML"),pb=e=>{if(e.nodeType===1){if(kO(e))return"svg";if(IO(e))return"mathml"}},L0=e=>e.nodeType===8;function DO(e){const{mt:t,p:n,o:{patchProp:r,createText:i,nextSibling:l,parentNode:a,remove:o,insert:f,createComment:m}}=e,_=(Q,oe)=>{if(!oe.hasChildNodes()){n(null,Q,oe),Tx(),oe._vnode=Q;return}w(oe.firstChild,Q,null,null,null),Tx(),oe._vnode=Q},w=(Q,oe,le,me,we,ue=!1)=>{ue=ue||!!oe.dynamicChildren;const _e=L0(Q)&&Q.data==="[",We=()=>z(Q,oe,le,me,we,_e),{type:he,ref:de,shapeFlag:Te,patchFlag:be}=oe;let ae=Q.nodeType;oe.el=Q,be===-2&&(ue=!1,oe.dynamicChildren=null);let ne=null;switch(he){case hm:ae!==3?oe.children===""?(f(oe.el=i(""),a(Q),Q),ne=Q):ne=We():(Q.data!==oe.children&&(a0(),Q.data=oe.children),ne=l(Q));break;case qu:Y(Q)?(ne=l(Q),X(oe.el=Q.content.firstChild,Q,le)):ae!==8||_e?ne=We():ne=l(Q);break;case pg:if(_e&&(Q=l(Q),ae=Q.nodeType),ae===1||ae===3){ne=Q;const Se=!oe.children.length;for(let Le=0;Le<oe.staticCount;Le++)Se&&(oe.children+=ne.nodeType===1?ne.outerHTML:ne.data),Le===oe.staticCount-1&&(oe.anchor=ne),ne=l(ne);return _e?l(ne):ne}else We();break;case $r:_e?ne=R(Q,oe,le,me,we,ue):ne=We();break;default:if(Te&1)(ae!==1||oe.type.toLowerCase()!==Q.tagName.toLowerCase())&&!Y(Q)?ne=We():ne=M(Q,oe,le,me,we,ue);else if(Te&6){oe.slotScopeIds=we;const Se=a(Q);if(_e?ne=W(Q):L0(Q)&&Q.data==="teleport start"?ne=W(Q,Q.data,"teleport end"):ne=l(Q),t(oe,Se,null,le,me,pb(Se),ue),cm(oe)&&!oe.type.__asyncResolved){let Le;_e?(Le=Ns($r),Le.anchor=ne?ne.previousSibling:Se.lastChild):Le=Q.nodeType===3?rs(""):Ns("div"),Le.el=Q,oe.component.subTree=Le}}else Te&64?ae!==8?ne=We():ne=oe.type.hydrate(Q,oe,le,me,we,ue,e,C):Te&128&&(ne=oe.type.hydrate(Q,oe,le,me,pb(a(Q)),we,ue,e,w))}return de!=null&&f_(de,null,me,oe),ne},M=(Q,oe,le,me,we,ue)=>{ue=ue||!!oe.dynamicChildren;const{type:_e,props:We,patchFlag:he,shapeFlag:de,dirs:Te,transition:be}=oe,ae=_e==="input"||_e==="option";if(ae||he!==-1){Te&&Tf(oe,null,le,"created");let ne=!1;if(Y(Q)){ne=AT(null,be)&&le&&le.vnode.props&&le.vnode.props.appear;const Le=Q.content.firstChild;ne&&be.beforeEnter(Le),X(Le,Q,le),oe.el=Q=Le}if(de&16&&!(We&&(We.innerHTML||We.textContent))){let Le=C(Q.firstChild,oe,Q,le,me,we,ue);for(;Le;){mb(Q,1)||a0();const ze=Le;Le=Le.nextSibling,o(ze)}}else if(de&8){let Le=oe.children;Le[0]===`
`&&(Q.tagName==="PRE"||Q.tagName==="TEXTAREA")&&(Le=Le.slice(1)),Q.textContent!==Le&&(mb(Q,0)||a0(),Q.textContent=oe.children)}if(We){if(ae||!ue||he&48){const Le=Q.tagName.includes("-");for(const ze in We)(ae&&(ze.endsWith("value")||ze==="indeterminate")||D_(ze)&&!A0(ze)||ze[0]==="."||Le)&&r(Q,ze,null,We[ze],void 0,le)}else if(We.onClick)r(Q,"onClick",null,We.onClick,void 0,le);else if(he&4&&Of(We.style))for(const Le in We.style)We.style[Le]}let Se;(Se=We&&We.onVnodeBeforeMount)&&zh(Se,le,oe),Te&&Tf(oe,null,le,"beforeMount"),((Se=We&&We.onVnodeMounted)||Te||ne)&&zT(()=>{Se&&zh(Se,le,oe),ne&&be.enter(Q),Te&&Tf(oe,null,le,"mounted")},me)}return Q.nextSibling},C=(Q,oe,le,me,we,ue,_e)=>{_e=_e||!!oe.dynamicChildren;const We=oe.children,he=We.length;for(let de=0;de<he;de++){const Te=_e?We[de]:We[de]=$h(We[de]),be=Te.type===hm;Q?(be&&!_e&&de+1<he&&$h(We[de+1]).type===hm&&(f(i(Q.data.slice(Te.children.length)),le,l(Q)),Q.data=Te.children),Q=w(Q,Te,me,we,ue,_e)):be&&!Te.children?f(Te.el=i(""),le):(mb(le,1)||a0(),n(null,Te,le,null,me,we,pb(le),ue))}return Q},R=(Q,oe,le,me,we,ue)=>{const{slotScopeIds:_e}=oe;_e&&(we=we?we.concat(_e):_e);const We=a(Q),he=C(l(Q),oe,We,le,me,we,ue);return he&&L0(he)&&he.data==="]"?l(oe.anchor=he):(a0(),f(oe.anchor=m("]"),We,he),he)},z=(Q,oe,le,me,we,ue)=>{if(mb(Q.parentElement,1)||a0(),oe.el=null,ue){const he=W(Q);for(;;){const de=l(Q);if(de&&de!==he)o(de);else break}}const _e=l(Q),We=a(Q);return o(Q),n(null,oe,We,_e,le,me,pb(We),we),le&&(le.vnode.el=oe.el,E2(le,oe.el)),_e},W=(Q,oe="[",le="]")=>{let me=0;for(;Q;)if(Q=l(Q),Q&&L0(Q)&&(Q.data===oe&&me++,Q.data===le)){if(me===0)return l(Q);me--}return Q},X=(Q,oe,le)=>{const me=oe.parentNode;me&&me.replaceChild(Q,oe);let we=le;for(;we;)we.vnode.el===oe&&(we.vnode.el=we.subTree.el=Q),we=we.parent},Y=Q=>Q.nodeType===1&&Q.tagName==="TEMPLATE";return[_,w]}const MS="data-allow-mismatch",OO={0:"text",1:"children",2:"class",3:"style",4:"attribute"};function mb(e,t){if(t===0||t===1)for(;e&&!e.hasAttribute(MS);)e=e.parentElement;const n=e&&e.getAttribute(MS);if(n==null)return!1;if(n==="")return!0;{const r=n.split(",");return t===0&&r.includes("children")?!0:n.split(",").includes(OO[t])}}const RO=p2().requestIdleCallback||(e=>setTimeout(e,1)),BO=p2().cancelIdleCallback||(e=>clearTimeout(e)),NO=(e=1e4)=>t=>{const n=RO(t,{timeout:e});return()=>BO(n)};function FO(e){const{top:t,left:n,bottom:r,right:i}=e.getBoundingClientRect(),{innerHeight:l,innerWidth:a}=window;return(t>0&&t<l||r>0&&r<l)&&(n>0&&n<a||i>0&&i<a)}const zO=e=>(t,n)=>{const r=new IntersectionObserver(i=>{for(const l of i)if(l.isIntersecting){r.disconnect(),t();break}},e);return n(i=>{if(i instanceof Element){if(FO(i))return t(),r.disconnect(),!1;r.observe(i)}}),()=>r.disconnect()},jO=e=>t=>{if(e){const n=matchMedia(e);if(n.matches)t();else return n.addEventListener("change",t,{once:!0}),()=>n.removeEventListener("change",t)}},UO=(e=[])=>(t,n)=>{Fa(e)&&(e=[e]);let r=!1;const i=a=>{r||(r=!0,l(),t(),a.target.dispatchEvent(new a.constructor(a.type,a)))},l=()=>{n(a=>{for(const o of e)a.removeEventListener(o,i)})};return n(a=>{for(const o of e)a.addEventListener(o,i,{once:!0})}),l};function VO(e,t){if(L0(e)&&e.data==="["){let n=1,r=e.nextSibling;for(;r;){if(r.nodeType===1){if(t(r)===!1)break}else if(L0(r))if(r.data==="]"){if(--n===0)break}else r.data==="["&&n++;r=r.nextSibling}}else t(e)}const cm=e=>!!e.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function $O(e){Ki(e)&&(e={loader:e});const{loader:t,loadingComponent:n,errorComponent:r,delay:i=200,hydrate:l,timeout:a,suspensible:o=!0,onError:f}=e;let m=null,_,w=0;const M=()=>(w++,m=null,C()),C=()=>{let R;return m||(R=m=t().catch(z=>{if(z=z instanceof Error?z:new Error(String(z)),f)return new Promise((W,X)=>{f(z,()=>W(M()),()=>X(z),w+1)});throw z}).then(z=>R!==m&&m?m:(z&&(z.__esModule||z[Symbol.toStringTag]==="Module")&&(z=z.default),_=z,z)))};return Ja({name:"AsyncComponentWrapper",__asyncLoader:C,__asyncHydrate(R,z,W){const X=l?()=>{const Y=l(W,Q=>VO(R,Q));Y&&(z.bum||(z.bum=[])).push(Y)}:W;_?X():C().then(()=>!z.isUnmounted&&X())},get __asyncResolved(){return _},setup(){const R=ac;if(sC(R),_)return()=>v5(_,R);const z=Q=>{m=null,Eg(Q,R,13,!r)};if(o&&R.suspense||U0)return C().then(Q=>()=>v5(Q,R)).catch(Q=>(z(Q),()=>r?Ns(r,{error:Q}):null));const W=Rn(!1),X=Rn(),Y=Rn(!!i);return i&&setTimeout(()=>{Y.value=!1},i),a!=null&&setTimeout(()=>{if(!W.value&&!X.value){const Q=new Error(`Async component timed out after ${a}ms.`);z(Q),X.value=Q}},a),C().then(()=>{W.value=!0,R.parent&&R_(R.parent.vnode)&&R.parent.update()}).catch(Q=>{z(Q),X.value=Q}),()=>{if(W.value&&_)return v5(_,R);if(X.value&&r)return Ns(r,{error:X.value});if(n&&!Y.value)return Ns(n)}}})}function v5(e,t){const{ref:n,props:r,children:i,ce:l}=t.vnode,a=Ns(e,r,i);return a.ref=n,a.ce=l,delete t.vnode.ce,a}const R_=e=>e.type.__isKeepAlive,GO={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(e,{slots:t}){const n=zd(),r=n.ctx;if(!r.renderer)return()=>{const Y=t.default&&t.default();return Y&&Y.length===1?Y[0]:Y};const i=new Map,l=new Set;let a=null;const o=n.suspense,{renderer:{p:f,m,um:_,o:{createElement:w}}}=r,M=w("div");r.activate=(Y,Q,oe,le,me)=>{const we=Y.component;m(Y,Q,oe,0,o),f(we.vnode,Y,Q,oe,we,o,le,Y.slotScopeIds,me),oc(()=>{we.isDeactivated=!1,we.a&&k0(we.a);const ue=Y.props&&Y.props.onVnodeMounted;ue&&zh(ue,we.parent,Y)},o)},r.deactivate=Y=>{const Q=Y.component;kx(Q.m),kx(Q.a),m(Y,M,null,1,o),oc(()=>{Q.da&&k0(Q.da);const oe=Y.props&&Y.props.onVnodeUnmounted;oe&&zh(oe,Q.parent,Y),Q.isDeactivated=!0},o)};function C(Y){_5(Y),_(Y,n,o,!0)}function R(Y){i.forEach((Q,oe)=>{const le=R4(Q.type);le&&!Y(le)&&z(oe)})}function z(Y){const Q=i.get(Y);Q&&(!a||!ef(Q,a))?C(Q):a&&_5(a),i.delete(Y),l.delete(Y)}mo(()=>[e.include,e.exclude],([Y,Q])=>{Y&&R(oe=>wv(Y,oe)),Q&&R(oe=>!wv(Q,oe))},{flush:"post",deep:!0});let W=null;const X=()=>{W!=null&&(Ix(n.subTree.type)?oc(()=>{i.set(W,gb(n.subTree))},n.subTree.suspense):i.set(W,gb(n.subTree)))};return Rl(X),L2(X),wm(()=>{i.forEach(Y=>{const{subTree:Q,suspense:oe}=n,le=gb(Q);if(Y.type===le.type&&Y.key===le.key){_5(le);const me=le.component.da;me&&oc(me,oe);return}C(Y)})}),()=>{if(W=null,!t.default)return a=null;const Y=t.default(),Q=Y[0];if(Y.length>1)return a=null,Y;if(!bp(Q)||!(Q.shapeFlag&4)&&!(Q.shapeFlag&128))return a=null,Q;let oe=gb(Q);if(oe.type===qu)return a=null,oe;const le=oe.type,me=R4(cm(oe)?oe.type.__asyncResolved||{}:le),{include:we,exclude:ue,max:_e}=e;if(we&&(!me||!wv(we,me))||ue&&me&&wv(ue,me))return oe.shapeFlag&=-257,a=oe,Q;const We=oe.key==null?le:oe.key,he=i.get(We);return oe.el&&(oe=Ff(oe),Q.shapeFlag&128&&(Q.ssContent=oe)),W=We,he?(oe.el=he.el,oe.component=he.component,oe.transition&&_p(oe,oe.transition),oe.shapeFlag|=512,l.delete(We),l.add(We)):(l.add(We),_e&&l.size>parseInt(_e,10)&&z(l.values().next().value)),oe.shapeFlag|=256,a=oe,Ix(Q.type)?Q:oe}}},HO=GO;function wv(e,t){return bi(e)?e.some(n=>wv(n,t)):Fa(e)?e.split(",").includes(t):xD(e)?(e.lastIndex=0,e.test(t)):!1}function iT(e,t){oT(e,"a",t)}function sT(e,t){oT(e,"da",t)}function oT(e,t,n=ac){const r=e.__wdc||(e.__wdc=()=>{let i=n;for(;i;){if(i.isDeactivated)return;i=i.parent}return e()});if(S2(t,r,n),n){let i=n.parent;for(;i&&i.parent;)R_(i.parent.vnode)&&qO(r,t,n,i),i=i.parent}}function qO(e,t,n,r){const i=S2(t,e,r,!0);gd(()=>{V3(r[t],i)},n)}function _5(e){e.shapeFlag&=-257,e.shapeFlag&=-513}function gb(e){return e.shapeFlag&128?e.ssContent:e}function S2(e,t,n=ac,r=!1){if(n){const i=n[e]||(n[e]=[]),l=t.__weh||(t.__weh=(...a)=>{bm();const o=wg(n),f=Nd(t,n,e,a);return o(),xm(),f});return r?i.unshift(l):i.push(l),l}}const xp=e=>(t,n=ac)=>{(!U0||e==="sp")&&S2(e,(...r)=>t(...r),n)},aT=xp("bm"),Rl=xp("m"),oC=xp("bu"),L2=xp("u"),wm=xp("bum"),gd=xp("um"),lT=xp("sp"),uT=xp("rtg"),cT=xp("rtc");function hT(e,t=ac){S2("ec",e,t)}const aC="components",WO="directives";function lC(e,t){return uC(aC,e,!0,t)||e}const dT=Symbol.for("v-ndc");function fT(e){return Fa(e)?uC(aC,e,!1)||e:e||dT}function ZO(e){return uC(WO,e)}function uC(e,t,n=!0,r=!1){const i=uc||ac;if(i){const l=i.type;if(e===aC){const o=R4(l,!1);if(o&&(o===t||o===Nc(t)||o===O_(Nc(t))))return l}const a=TS(i[e]||l[e],t)||TS(i.appContext[e],t);return!a&&r?l:a}}function TS(e,t){return e&&(e[t]||e[Nc(t)]||e[O_(Nc(t))])}function Ti(e,t,n,r){let i;const l=n&&n[r],a=bi(e);if(a||Fa(e)){const o=a&&Of(e);let f=!1;o&&(f=!md(e),e=y2(e)),i=new Array(e.length);for(let m=0,_=e.length;m<_;m++)i[m]=t(f?Qc(e[m]):e[m],m,void 0,l&&l[m])}else if(typeof e=="number"){i=new Array(e);for(let o=0;o<e;o++)i[o]=t(o+1,o,void 0,l&&l[o])}else if(la(e))if(e[Symbol.iterator])i=Array.from(e,(o,f)=>t(o,f,void 0,l&&l[f]));else{const o=Object.keys(e);i=new Array(o.length);for(let f=0,m=o.length;f<m;f++){const _=o[f];i[f]=t(e[_],_,f,l&&l[f])}}else i=[];return n&&(n[r]=i),i}function KO(e,t){for(let n=0;n<t.length;n++){const r=t[n];if(bi(r))for(let i=0;i<r.length;i++)e[r[i].name]=r[i].fn;else r&&(e[r.name]=r.key?(...i)=>{const l=r.fn(...i);return l&&(l.key=r.key),l}:r.fn)}return e}function YO(e,t,n={},r,i){if(uc.ce||uc.parent&&cm(uc.parent)&&uc.parent.ce)return t!=="default"&&(n.name=t),yt(),Hu($r,null,[Ns("slot",n,r&&r())],64);let l=e[t];l&&l._c&&(l._d=!1),yt();const a=l&&cC(l(n)),o=n.key||a&&a.key,f=Hu($r,{key:(o&&!of(o)?o:`_${t}`)+(!a&&r?"_fb":"")},a||(r?r():[]),a&&e._===1?64:-2);return!i&&f.scopeId&&(f.slotScopeIds=[f.scopeId+"-s"]),l&&l._c&&(l._d=!0),f}function cC(e){return e.some(t=>bp(t)?!(t.type===qu||t.type===$r&&!cC(t.children)):!0)?e:null}function XO(e,t){const n={};for(const r in e)n[t&&/[A-Z]/.test(r)?`on:${r}`:Nv(r)]=e[r];return n}const S4=e=>e?qT(e)?N_(e):S4(e.parent):null,Uv=wa(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>S4(e.parent),$root:e=>S4(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>hC(e),$forceUpdate:e=>e.f||(e.f=()=>{nC(e.update)}),$nextTick:e=>e.n||(e.n=Sh.bind(e.proxy)),$watch:e=>ER.bind(e)}),b5=(e,t)=>e!==no&&!e.__isScriptSetup&&xo(e,t),L4={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:n,setupState:r,data:i,props:l,accessCache:a,type:o,appContext:f}=e;let m;if(t[0]!=="$"){const C=a[t];if(C!==void 0)switch(C){case 1:return r[t];case 2:return i[t];case 4:return n[t];case 3:return l[t]}else{if(b5(r,t))return a[t]=1,r[t];if(i!==no&&xo(i,t))return a[t]=2,i[t];if((m=e.propsOptions[0])&&xo(m,t))return a[t]=3,l[t];if(n!==no&&xo(n,t))return a[t]=4,n[t];P4&&(a[t]=0)}}const _=Uv[t];let w,M;if(_)return t==="$attrs"&&Jc(e.attrs,"get",""),_(e);if((w=o.__cssModules)&&(w=w[t]))return w;if(n!==no&&xo(n,t))return a[t]=4,n[t];if(M=f.config.globalProperties,xo(M,t))return M[t]},set({_:e},t,n){const{data:r,setupState:i,ctx:l}=e;return b5(i,t)?(i[t]=n,!0):r!==no&&xo(r,t)?(r[t]=n,!0):xo(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(l[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:r,appContext:i,propsOptions:l}},a){let o;return!!n[a]||e!==no&&xo(e,a)||b5(t,a)||(o=l[0])&&xo(o,a)||xo(r,a)||xo(Uv,a)||xo(i.config.globalProperties,a)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:xo(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}},JO=wa({},L4,{get(e,t){if(t!==Symbol.unscopables)return L4.get(e,t,e)},has(e,t){return t[0]!=="_"&&!PD(t)}});function QO(){return null}function eR(){return null}function tR(e){}function nR(e){}function rR(){return null}function iR(){}function sR(e,t){return null}function oR(){return pT().slots}function aR(){return pT().attrs}function pT(){const e=zd();return e.setupContext||(e.setupContext=KT(e))}function p_(e){return bi(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}function lR(e,t){const n=p_(e);for(const r in t){if(r.startsWith("__skip"))continue;let i=n[r];i?bi(i)||Ki(i)?i=n[r]={type:i,default:t[r]}:i.default=t[r]:i===null&&(i=n[r]={default:t[r]}),i&&t[`__skip_${r}`]&&(i.skipFactory=!0)}return n}function uR(e,t){return!e||!t?e||t:bi(e)&&bi(t)?e.concat(t):wa({},p_(e),p_(t))}function cR(e,t){const n={};for(const r in e)t.includes(r)||Object.defineProperty(n,r,{enumerable:!0,get:()=>e[r]});return n}function hR(e){const t=zd();let n=e();return I4(),$3(n)&&(n=n.catch(r=>{throw wg(t),r})),[n,()=>wg(t)]}let P4=!0;function dR(e){const t=hC(e),n=e.proxy,r=e.ctx;P4=!1,t.beforeCreate&&AS(t.beforeCreate,e,"bc");const{data:i,computed:l,methods:a,watch:o,provide:f,inject:m,created:_,beforeMount:w,mounted:M,beforeUpdate:C,updated:R,activated:z,deactivated:W,beforeDestroy:X,beforeUnmount:Y,destroyed:Q,unmounted:oe,render:le,renderTracked:me,renderTriggered:we,errorCaptured:ue,serverPrefetch:_e,expose:We,inheritAttrs:he,components:de,directives:Te,filters:be}=t;if(m&&fR(m,r,null),a)for(const Se in a){const Le=a[Se];Ki(Le)&&(r[Se]=Le.bind(n))}if(i){const Se=i.call(n,n);la(Se)&&(e.data=bd(Se))}if(P4=!0,l)for(const Se in l){const Le=l[Se],ze=Ki(Le)?Le.bind(n,n):Ki(Le.get)?Le.get.bind(n,n):Od,He=!Ki(Le)&&Ki(Le.set)?Le.set.bind(n):Od,pt=Ai({get:ze,set:He});Object.defineProperty(r,Se,{enumerable:!0,configurable:!0,get:()=>pt.value,set:ge=>pt.value=ge})}if(o)for(const Se in o)mT(o[Se],r,n,Se);if(f){const Se=Ki(f)?f.call(n):f;Reflect.ownKeys(Se).forEach(Le=>{Vv(Le,Se[Le])})}_&&AS(_,e,"c");function ne(Se,Le){bi(Le)?Le.forEach(ze=>Se(ze.bind(n))):Le&&Se(Le.bind(n))}if(ne(aT,w),ne(Rl,M),ne(oC,C),ne(L2,R),ne(iT,z),ne(sT,W),ne(hT,ue),ne(cT,me),ne(uT,we),ne(wm,Y),ne(gd,oe),ne(lT,_e),bi(We))if(We.length){const Se=e.exposed||(e.exposed={});We.forEach(Le=>{Object.defineProperty(Se,Le,{get:()=>n[Le],set:ze=>n[Le]=ze})})}else e.exposed||(e.exposed={});le&&e.render===Od&&(e.render=le),he!=null&&(e.inheritAttrs=he),de&&(e.components=de),Te&&(e.directives=Te),_e&&sC(e)}function fR(e,t,n=Od){bi(e)&&(e=E4(e));for(const r in e){const i=e[r];let l;la(i)?"default"in i?l=yd(i.from||r,i.default,!0):l=yd(i.from||r):l=yd(i),Ol(l)?Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:()=>l.value,set:a=>l.value=a}):t[r]=l}}function AS(e,t,n){Nd(bi(e)?e.map(r=>r.bind(t.proxy)):e.bind(t.proxy),t,n)}function mT(e,t,n,r){let i=r.includes(".")?RT(n,r):()=>n[r];if(Fa(e)){const l=t[e];Ki(l)&&mo(i,l)}else if(Ki(e))mo(i,e.bind(n));else if(la(e))if(bi(e))e.forEach(l=>mT(l,t,n,r));else{const l=Ki(e.handler)?e.handler.bind(n):t[e.handler];Ki(l)&&mo(i,l,e)}}function hC(e){const t=e.type,{mixins:n,extends:r}=t,{mixins:i,optionsCache:l,config:{optionMergeStrategies:a}}=e.appContext,o=l.get(t);let f;return o?f=o:!i.length&&!n&&!r?f=t:(f={},i.length&&i.forEach(m=>Ax(f,m,a,!0)),Ax(f,t,a)),la(t)&&l.set(t,f),f}function Ax(e,t,n,r=!1){const{mixins:i,extends:l}=t;l&&Ax(e,l,n,!0),i&&i.forEach(a=>Ax(e,a,n,!0));for(const a in t)if(!(r&&a==="expose")){const o=pR[a]||n&&n[a];e[a]=o?o(e[a],t[a]):t[a]}return e}const pR={data:kS,props:IS,emits:IS,methods:Cv,computed:Cv,beforeCreate:yh,created:yh,beforeMount:yh,mounted:yh,beforeUpdate:yh,updated:yh,beforeDestroy:yh,beforeUnmount:yh,destroyed:yh,unmounted:yh,activated:yh,deactivated:yh,errorCaptured:yh,serverPrefetch:yh,components:Cv,directives:Cv,watch:gR,provide:kS,inject:mR};function kS(e,t){return t?e?function(){return wa(Ki(e)?e.call(this,this):e,Ki(t)?t.call(this,this):t)}:t:e}function mR(e,t){return Cv(E4(e),E4(t))}function E4(e){if(bi(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function yh(e,t){return e?[...new Set([].concat(e,t))]:t}function Cv(e,t){return e?wa(Object.create(null),e,t):t}function IS(e,t){return e?bi(e)&&bi(t)?[...new Set([...e,...t])]:wa(Object.create(null),p_(e),p_(t??{})):t}function gR(e,t){if(!e)return t;if(!t)return e;const n=wa(Object.create(null),e);for(const r in t)n[r]=yh(e[r],t[r]);return n}function gT(){return{app:null,config:{isNativeTag:_D,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let yR=0;function vR(e,t){return function(r,i=null){Ki(r)||(r=wa({},r)),i!=null&&!la(i)&&(i=null);const l=gT(),a=new WeakSet,o=[];let f=!1;const m=l.app={_uid:yR++,_component:r,_props:i,_container:null,_context:l,_instance:null,version:XT,get config(){return l.config},set config(_){},use(_,...w){return a.has(_)||(_&&Ki(_.install)?(a.add(_),_.install(m,...w)):Ki(_)&&(a.add(_),_(m,...w))),m},mixin(_){return l.mixins.includes(_)||l.mixins.push(_),m},component(_,w){return w?(l.components[_]=w,m):l.components[_]},directive(_,w){return w?(l.directives[_]=w,m):l.directives[_]},mount(_,w,M){if(!f){const C=m._ceVNode||Ns(r,i);return C.appContext=l,M===!0?M="svg":M===!1&&(M=void 0),w&&t?t(C,_):e(C,_,M),f=!0,m._container=_,_.__vue_app__=m,N_(C.component)}},onUnmount(_){o.push(_)},unmount(){f&&(Nd(o,m._instance,16),e(null,m._container),delete m._container.__vue_app__)},provide(_,w){return l.provides[_]=w,m},runWithContext(_){const w=fg;fg=m;try{return _()}finally{fg=w}}};return m}}let fg=null;function Vv(e,t){if(ac){let n=ac.provides;const r=ac.parent&&ac.parent.provides;r===n&&(n=ac.provides=Object.create(r)),n[e]=t}}function yd(e,t,n=!1){const r=ac||uc;if(r||fg){const i=fg?fg._context.provides:r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(i&&e in i)return i[e];if(arguments.length>1)return n&&Ki(t)?t.call(r&&r.proxy):t}}function yT(){return!!(ac||uc||fg)}const vT={},_T=()=>Object.create(vT),bT=e=>Object.getPrototypeOf(e)===vT;function _R(e,t,n,r=!1){const i={},l=_T();e.propsDefaults=Object.create(null),xT(e,t,i,l);for(const a in e.propsOptions[0])a in i||(i[a]=void 0);n?e.props=r?i:X3(i):e.type.props?e.props=i:e.props=l,e.attrs=l}function bR(e,t,n,r){const{props:i,attrs:l,vnode:{patchFlag:a}}=e,o=eo(i),[f]=e.propsOptions;let m=!1;if((r||a>0)&&!(a&16)){if(a&8){const _=e.vnode.dynamicProps;for(let w=0;w<_.length;w++){let M=_[w];if(P2(e.emitsOptions,M))continue;const C=t[M];if(f)if(xo(l,M))C!==l[M]&&(l[M]=C,m=!0);else{const R=Nc(M);i[R]=M4(f,o,R,C,e,!1)}else C!==l[M]&&(l[M]=C,m=!0)}}}else{xT(e,t,i,l)&&(m=!0);let _;for(const w in o)(!t||!xo(t,w)&&((_=Gh(w))===w||!xo(t,_)))&&(f?n&&(n[w]!==void 0||n[_]!==void 0)&&(i[w]=M4(f,o,w,void 0,e,!0)):delete i[w]);if(l!==o)for(const w in l)(!t||!xo(t,w))&&(delete l[w],m=!0)}m&&hp(e.attrs,"set","")}function xT(e,t,n,r){const[i,l]=e.propsOptions;let a=!1,o;if(t)for(let f in t){if(A0(f))continue;const m=t[f];let _;i&&xo(i,_=Nc(f))?!l||!l.includes(_)?n[_]=m:(o||(o={}))[_]=m:P2(e.emitsOptions,f)||(!(f in r)||m!==r[f])&&(r[f]=m,a=!0)}if(l){const f=eo(n),m=o||no;for(let _=0;_<l.length;_++){const w=l[_];n[w]=M4(i,f,w,m[w],e,!xo(m,w))}}return a}function M4(e,t,n,r,i,l){const a=e[n];if(a!=null){const o=xo(a,"default");if(o&&r===void 0){const f=a.default;if(a.type!==Function&&!a.skipFactory&&Ki(f)){const{propsDefaults:m}=i;if(n in m)r=m[n];else{const _=wg(i);r=m[n]=f.call(null,t),_()}}else r=f;i.ce&&i.ce._setProp(n,r)}a[0]&&(l&&!o?r=!1:a[1]&&(r===""||r===Gh(n))&&(r=!0))}return r}const xR=new WeakMap;function wT(e,t,n=!1){const r=n?xR:t.propsCache,i=r.get(e);if(i)return i;const l=e.props,a={},o=[];let f=!1;if(!Ki(e)){const _=w=>{f=!0;const[M,C]=wT(w,t,!0);wa(a,M),C&&o.push(...C)};!n&&t.mixins.length&&t.mixins.forEach(_),e.extends&&_(e.extends),e.mixins&&e.mixins.forEach(_)}if(!l&&!f)return la(e)&&r.set(e,M0),M0;if(bi(l))for(let _=0;_<l.length;_++){const w=Nc(l[_]);DS(w)&&(a[w]=no)}else if(l)for(const _ in l){const w=Nc(_);if(DS(w)){const M=l[_],C=a[w]=bi(M)||Ki(M)?{type:M}:wa({},M),R=C.type;let z=!1,W=!0;if(bi(R))for(let X=0;X<R.length;++X){const Y=R[X],Q=Ki(Y)&&Y.name;if(Q==="Boolean"){z=!0;break}else Q==="String"&&(W=!1)}else z=Ki(R)&&R.name==="Boolean";C[0]=z,C[1]=W,(z||xo(C,"default"))&&o.push(w)}}const m=[a,o];return la(e)&&r.set(e,m),m}function DS(e){return e[0]!=="$"&&!A0(e)}const CT=e=>e[0]==="_"||e==="$stable",dC=e=>bi(e)?e.map($h):[$h(e)],wR=(e,t,n)=>{if(t._n)return t;const r=Hh((...i)=>dC(t(...i)),n);return r._c=!1,r},ST=(e,t,n)=>{const r=e._ctx;for(const i in e){if(CT(i))continue;const l=e[i];if(Ki(l))t[i]=wR(i,l,r);else if(l!=null){const a=dC(l);t[i]=()=>a}}},LT=(e,t)=>{const n=dC(t);e.slots.default=()=>n},PT=(e,t,n)=>{for(const r in t)(n||r!=="_")&&(e[r]=t[r])},CR=(e,t,n)=>{const r=e.slots=_T();if(e.vnode.shapeFlag&32){const i=t._;i?(PT(r,t,n),n&&xM(r,"_",i,!0)):ST(t,r)}else t&&LT(e,t)},SR=(e,t,n)=>{const{vnode:r,slots:i}=e;let l=!0,a=no;if(r.shapeFlag&32){const o=t._;o?n&&o===1?l=!1:PT(i,t,n):(l=!t.$stable,ST(t,i)),a=t}else t&&(LT(e,t),a={default:1});if(l)for(const o in i)!CT(o)&&a[o]==null&&delete i[o]},oc=zT;function ET(e){return TT(e)}function MT(e){return TT(e,DO)}function TT(e,t){const n=p2();n.__VUE__=!0;const{insert:r,remove:i,patchProp:l,createElement:a,createText:o,createComment:f,setText:m,setElementText:_,parentNode:w,nextSibling:M,setScopeId:C=Od,insertStaticContent:R}=e,z=(De,Ae,Be,Ce=null,ot=null,Dt=null,Zt=void 0,an=null,ln=!!Ae.dynamicChildren)=>{if(De===Ae)return;De&&!ef(De,Ae)&&(Ce=lt(De),ge(De,ot,Dt,!0),De=null),Ae.patchFlag===-2&&(ln=!1,Ae.dynamicChildren=null);const{type:vn,ref:qn,shapeFlag:Kn}=Ae;switch(vn){case hm:W(De,Ae,Be,Ce);break;case qu:X(De,Ae,Be,Ce);break;case pg:De==null&&Y(Ae,Be,Ce,Zt);break;case $r:de(De,Ae,Be,Ce,ot,Dt,Zt,an,ln);break;default:Kn&1?le(De,Ae,Be,Ce,ot,Dt,Zt,an,ln):Kn&6?Te(De,Ae,Be,Ce,ot,Dt,Zt,an,ln):(Kn&64||Kn&128)&&vn.process(De,Ae,Be,Ce,ot,Dt,Zt,an,ln,rn)}qn!=null&&ot&&f_(qn,De&&De.ref,Dt,Ae||De,!Ae)},W=(De,Ae,Be,Ce)=>{if(De==null)r(Ae.el=o(Ae.children),Be,Ce);else{const ot=Ae.el=De.el;Ae.children!==De.children&&m(ot,Ae.children)}},X=(De,Ae,Be,Ce)=>{De==null?r(Ae.el=f(Ae.children||""),Be,Ce):Ae.el=De.el},Y=(De,Ae,Be,Ce)=>{[De.el,De.anchor]=R(De.children,Ae,Be,Ce,De.el,De.anchor)},Q=({el:De,anchor:Ae},Be,Ce)=>{let ot;for(;De&&De!==Ae;)ot=M(De),r(De,Be,Ce),De=ot;r(Ae,Be,Ce)},oe=({el:De,anchor:Ae})=>{let Be;for(;De&&De!==Ae;)Be=M(De),i(De),De=Be;i(Ae)},le=(De,Ae,Be,Ce,ot,Dt,Zt,an,ln)=>{Ae.type==="svg"?Zt="svg":Ae.type==="math"&&(Zt="mathml"),De==null?me(Ae,Be,Ce,ot,Dt,Zt,an,ln):_e(De,Ae,ot,Dt,Zt,an,ln)},me=(De,Ae,Be,Ce,ot,Dt,Zt,an)=>{let ln,vn;const{props:qn,shapeFlag:Kn,transition:cr,dirs:pr}=De;if(ln=De.el=a(De.type,Dt,qn&&qn.is,qn),Kn&8?_(ln,De.children):Kn&16&&ue(De.children,ln,null,Ce,ot,x5(De,Dt),Zt,an),pr&&Tf(De,null,Ce,"created"),we(ln,De,De.scopeId,Zt,Ce),qn){for(const zr in qn)zr!=="value"&&!A0(zr)&&l(ln,zr,null,qn[zr],Dt,Ce);"value"in qn&&l(ln,"value",null,qn.value,Dt),(vn=qn.onVnodeBeforeMount)&&zh(vn,Ce,De)}pr&&Tf(De,null,Ce,"beforeMount");const Dr=AT(ot,cr);Dr&&cr.beforeEnter(ln),r(ln,Ae,Be),((vn=qn&&qn.onVnodeMounted)||Dr||pr)&&oc(()=>{vn&&zh(vn,Ce,De),Dr&&cr.enter(ln),pr&&Tf(De,null,Ce,"mounted")},ot)},we=(De,Ae,Be,Ce,ot)=>{if(Be&&C(De,Be),Ce)for(let Dt=0;Dt<Ce.length;Dt++)C(De,Ce[Dt]);if(ot){let Dt=ot.subTree;if(Ae===Dt||Ix(Dt.type)&&(Dt.ssContent===Ae||Dt.ssFallback===Ae)){const Zt=ot.vnode;we(De,Zt,Zt.scopeId,Zt.slotScopeIds,ot.parent)}}},ue=(De,Ae,Be,Ce,ot,Dt,Zt,an,ln=0)=>{for(let vn=ln;vn<De.length;vn++){const qn=De[vn]=an?Jp(De[vn]):$h(De[vn]);z(null,qn,Ae,Be,Ce,ot,Dt,Zt,an)}},_e=(De,Ae,Be,Ce,ot,Dt,Zt)=>{const an=Ae.el=De.el;let{patchFlag:ln,dynamicChildren:vn,dirs:qn}=Ae;ln|=De.patchFlag&16;const Kn=De.props||no,cr=Ae.props||no;let pr;if(Be&&Zm(Be,!1),(pr=cr.onVnodeBeforeUpdate)&&zh(pr,Be,Ae,De),qn&&Tf(Ae,De,Be,"beforeUpdate"),Be&&Zm(Be,!0),(Kn.innerHTML&&cr.innerHTML==null||Kn.textContent&&cr.textContent==null)&&_(an,""),vn?We(De.dynamicChildren,vn,an,Be,Ce,x5(Ae,ot),Dt):Zt||Le(De,Ae,an,null,Be,Ce,x5(Ae,ot),Dt,!1),ln>0){if(ln&16)he(an,Kn,cr,Be,ot);else if(ln&2&&Kn.class!==cr.class&&l(an,"class",null,cr.class,ot),ln&4&&l(an,"style",Kn.style,cr.style,ot),ln&8){const Dr=Ae.dynamicProps;for(let zr=0;zr<Dr.length;zr++){const Ht=Dr[zr],tn=Kn[Ht],Kt=cr[Ht];(Kt!==tn||Ht==="value")&&l(an,Ht,tn,Kt,ot,Be)}}ln&1&&De.children!==Ae.children&&_(an,Ae.children)}else!Zt&&vn==null&&he(an,Kn,cr,Be,ot);((pr=cr.onVnodeUpdated)||qn)&&oc(()=>{pr&&zh(pr,Be,Ae,De),qn&&Tf(Ae,De,Be,"updated")},Ce)},We=(De,Ae,Be,Ce,ot,Dt,Zt)=>{for(let an=0;an<Ae.length;an++){const ln=De[an],vn=Ae[an],qn=ln.el&&(ln.type===$r||!ef(ln,vn)||ln.shapeFlag&70)?w(ln.el):Be;z(ln,vn,qn,null,Ce,ot,Dt,Zt,!0)}},he=(De,Ae,Be,Ce,ot)=>{if(Ae!==Be){if(Ae!==no)for(const Dt in Ae)!A0(Dt)&&!(Dt in Be)&&l(De,Dt,Ae[Dt],null,ot,Ce);for(const Dt in Be){if(A0(Dt))continue;const Zt=Be[Dt],an=Ae[Dt];Zt!==an&&Dt!=="value"&&l(De,Dt,an,Zt,ot,Ce)}"value"in Be&&l(De,"value",Ae.value,Be.value,ot)}},de=(De,Ae,Be,Ce,ot,Dt,Zt,an,ln)=>{const vn=Ae.el=De?De.el:o(""),qn=Ae.anchor=De?De.anchor:o("");let{patchFlag:Kn,dynamicChildren:cr,slotScopeIds:pr}=Ae;pr&&(an=an?an.concat(pr):pr),De==null?(r(vn,Be,Ce),r(qn,Be,Ce),ue(Ae.children||[],Be,qn,ot,Dt,Zt,an,ln)):Kn>0&&Kn&64&&cr&&De.dynamicChildren?(We(De.dynamicChildren,cr,Be,ot,Dt,Zt,an),(Ae.key!=null||ot&&Ae===ot.subTree)&&fC(De,Ae,!0)):Le(De,Ae,Be,qn,ot,Dt,Zt,an,ln)},Te=(De,Ae,Be,Ce,ot,Dt,Zt,an,ln)=>{Ae.slotScopeIds=an,De==null?Ae.shapeFlag&512?ot.ctx.activate(Ae,Be,Ce,Zt,ln):be(Ae,Be,Ce,ot,Dt,Zt,ln):ae(De,Ae,ln)},be=(De,Ae,Be,Ce,ot,Dt,Zt)=>{const an=De.component=HT(De,Ce,ot);if(R_(De)&&(an.ctx.renderer=rn),WT(an,!1,Zt),an.asyncDep){if(ot&&ot.registerDep(an,ne,Zt),!De.el){const ln=an.subTree=Ns(qu);X(null,ln,Ae,Be)}}else ne(an,De,Ae,Be,ot,Dt,Zt)},ae=(De,Ae,Be)=>{const Ce=Ae.component=De.component;if(DR(De,Ae,Be))if(Ce.asyncDep&&!Ce.asyncResolved){Se(Ce,Ae,Be);return}else Ce.next=Ae,Ce.update();else Ae.el=De.el,Ce.vnode=Ae},ne=(De,Ae,Be,Ce,ot,Dt,Zt)=>{const an=()=>{if(De.isMounted){let{next:Kn,bu:cr,u:pr,parent:Dr,vnode:zr}=De;{const ir=kT(De);if(ir){Kn&&(Kn.el=zr.el,Se(De,Kn,Zt)),ir.asyncDep.then(()=>{De.isUnmounted||an()});return}}let Ht=Kn,tn;Zm(De,!1),Kn?(Kn.el=zr.el,Se(De,Kn,Zt)):Kn=zr,cr&&k0(cr),(tn=Kn.props&&Kn.props.onVnodeBeforeUpdate)&&zh(tn,Dr,Kn,zr),Zm(De,!0);const Kt=Xb(De),Yn=De.subTree;De.subTree=Kt,z(Yn,Kt,w(Yn.el),lt(Yn),De,ot,Dt),Kn.el=Kt.el,Ht===null&&E2(De,Kt.el),pr&&oc(pr,ot),(tn=Kn.props&&Kn.props.onVnodeUpdated)&&oc(()=>zh(tn,Dr,Kn,zr),ot)}else{let Kn;const{el:cr,props:pr}=Ae,{bm:Dr,m:zr,parent:Ht,root:tn,type:Kt}=De,Yn=cm(Ae);if(Zm(De,!1),Dr&&k0(Dr),!Yn&&(Kn=pr&&pr.onVnodeBeforeMount)&&zh(Kn,Ht,Ae),Zm(De,!0),cr&&Pn){const ir=()=>{De.subTree=Xb(De),Pn(cr,De.subTree,De,ot,null)};Yn&&Kt.__asyncHydrate?Kt.__asyncHydrate(cr,De,ir):ir()}else{tn.ce&&tn.ce._injectChildStyle(Kt);const ir=De.subTree=Xb(De);z(null,ir,Be,Ce,De,ot,Dt),Ae.el=ir.el}if(zr&&oc(zr,ot),!Yn&&(Kn=pr&&pr.onVnodeMounted)){const ir=Ae;oc(()=>zh(Kn,Ht,ir),ot)}(Ae.shapeFlag&256||Ht&&cm(Ht.vnode)&&Ht.vnode.shapeFlag&256)&&De.a&&oc(De.a,ot),De.isMounted=!0,Ae=Be=Ce=null}};De.scope.on();const ln=De.effect=new a_(an);De.scope.off();const vn=De.update=ln.run.bind(ln),qn=De.job=ln.runIfDirty.bind(ln);qn.i=De,qn.id=De.uid,ln.scheduler=()=>nC(qn),Zm(De,!0),vn()},Se=(De,Ae,Be)=>{Ae.component=De;const Ce=De.vnode.props;De.vnode=Ae,De.next=null,bR(De,Ae.props,Ce,Be),SR(De,Ae.children,Be),bm(),wS(De),xm()},Le=(De,Ae,Be,Ce,ot,Dt,Zt,an,ln=!1)=>{const vn=De&&De.children,qn=De?De.shapeFlag:0,Kn=Ae.children,{patchFlag:cr,shapeFlag:pr}=Ae;if(cr>0){if(cr&128){He(vn,Kn,Be,Ce,ot,Dt,Zt,an,ln);return}else if(cr&256){ze(vn,Kn,Be,Ce,ot,Dt,Zt,an,ln);return}}pr&8?(qn&16&&it(vn,ot,Dt),Kn!==vn&&_(Be,Kn)):qn&16?pr&16?He(vn,Kn,Be,Ce,ot,Dt,Zt,an,ln):it(vn,ot,Dt,!0):(qn&8&&_(Be,""),pr&16&&ue(Kn,Be,Ce,ot,Dt,Zt,an,ln))},ze=(De,Ae,Be,Ce,ot,Dt,Zt,an,ln)=>{De=De||M0,Ae=Ae||M0;const vn=De.length,qn=Ae.length,Kn=Math.min(vn,qn);let cr;for(cr=0;cr<Kn;cr++){const pr=Ae[cr]=ln?Jp(Ae[cr]):$h(Ae[cr]);z(De[cr],pr,Be,null,ot,Dt,Zt,an,ln)}vn>qn?it(De,ot,Dt,!0,!1,Kn):ue(Ae,Be,Ce,ot,Dt,Zt,an,ln,Kn)},He=(De,Ae,Be,Ce,ot,Dt,Zt,an,ln)=>{let vn=0;const qn=Ae.length;let Kn=De.length-1,cr=qn-1;for(;vn<=Kn&&vn<=cr;){const pr=De[vn],Dr=Ae[vn]=ln?Jp(Ae[vn]):$h(Ae[vn]);if(ef(pr,Dr))z(pr,Dr,Be,null,ot,Dt,Zt,an,ln);else break;vn++}for(;vn<=Kn&&vn<=cr;){const pr=De[Kn],Dr=Ae[cr]=ln?Jp(Ae[cr]):$h(Ae[cr]);if(ef(pr,Dr))z(pr,Dr,Be,null,ot,Dt,Zt,an,ln);else break;Kn--,cr--}if(vn>Kn){if(vn<=cr){const pr=cr+1,Dr=pr<qn?Ae[pr].el:Ce;for(;vn<=cr;)z(null,Ae[vn]=ln?Jp(Ae[vn]):$h(Ae[vn]),Be,Dr,ot,Dt,Zt,an,ln),vn++}}else if(vn>cr)for(;vn<=Kn;)ge(De[vn],ot,Dt,!0),vn++;else{const pr=vn,Dr=vn,zr=new Map;for(vn=Dr;vn<=cr;vn++){const je=Ae[vn]=ln?Jp(Ae[vn]):$h(Ae[vn]);je.key!=null&&zr.set(je.key,vn)}let Ht,tn=0;const Kt=cr-Dr+1;let Yn=!1,ir=0;const Fr=new Array(Kt);for(vn=0;vn<Kt;vn++)Fr[vn]=0;for(vn=pr;vn<=Kn;vn++){const je=De[vn];if(tn>=Kt){ge(je,ot,Dt,!0);continue}let Ze;if(je.key!=null)Ze=zr.get(je.key);else for(Ht=Dr;Ht<=cr;Ht++)if(Fr[Ht-Dr]===0&&ef(je,Ae[Ht])){Ze=Ht;break}Ze===void 0?ge(je,ot,Dt,!0):(Fr[Ze-Dr]=vn+1,Ze>=ir?ir=Ze:Yn=!0,z(je,Ae[Ze],Be,null,ot,Dt,Zt,an,ln),tn++)}const Ft=Yn?LR(Fr):M0;for(Ht=Ft.length-1,vn=Kt-1;vn>=0;vn--){const je=Dr+vn,Ze=Ae[je],et=je+1<qn?Ae[je+1].el:Ce;Fr[vn]===0?z(null,Ze,Be,et,ot,Dt,Zt,an,ln):Yn&&(Ht<0||vn!==Ft[Ht]?pt(Ze,Be,et,2):Ht--)}}},pt=(De,Ae,Be,Ce,ot=null)=>{const{el:Dt,type:Zt,transition:an,children:ln,shapeFlag:vn}=De;if(vn&6){pt(De.component.subTree,Ae,Be,Ce);return}if(vn&128){De.suspense.move(Ae,Be,Ce);return}if(vn&64){Zt.move(De,Ae,Be,rn);return}if(Zt===$r){r(Dt,Ae,Be);for(let Kn=0;Kn<ln.length;Kn++)pt(ln[Kn],Ae,Be,Ce);r(De.anchor,Ae,Be);return}if(Zt===pg){Q(De,Ae,Be);return}if(Ce!==2&&vn&1&&an)if(Ce===0)an.beforeEnter(Dt),r(Dt,Ae,Be),oc(()=>an.enter(Dt),ot);else{const{leave:Kn,delayLeave:cr,afterLeave:pr}=an,Dr=()=>r(Dt,Ae,Be),zr=()=>{Kn(Dt,()=>{Dr(),pr&&pr()})};cr?cr(Dt,Dr,zr):zr()}else r(Dt,Ae,Be)},ge=(De,Ae,Be,Ce=!1,ot=!1)=>{const{type:Dt,props:Zt,ref:an,children:ln,dynamicChildren:vn,shapeFlag:qn,patchFlag:Kn,dirs:cr,cacheIndex:pr}=De;if(Kn===-2&&(ot=!1),an!=null&&f_(an,null,Be,De,!0),pr!=null&&(Ae.renderCache[pr]=void 0),qn&256){Ae.ctx.deactivate(De);return}const Dr=qn&1&&cr,zr=!cm(De);let Ht;if(zr&&(Ht=Zt&&Zt.onVnodeBeforeUnmount)&&zh(Ht,Ae,De),qn&6)Ve(De.component,Be,Ce);else{if(qn&128){De.suspense.unmount(Be,Ce);return}Dr&&Tf(De,null,Ae,"beforeUnmount"),qn&64?De.type.remove(De,Ae,Be,rn,Ce):vn&&!vn.hasOnce&&(Dt!==$r||Kn>0&&Kn&64)?it(vn,Ae,Be,!1,!0):(Dt===$r&&Kn&384||!ot&&qn&16)&&it(ln,Ae,Be),Ce&&Ie(De)}(zr&&(Ht=Zt&&Zt.onVnodeUnmounted)||Dr)&&oc(()=>{Ht&&zh(Ht,Ae,De),Dr&&Tf(De,null,Ae,"unmounted")},Be)},Ie=De=>{const{type:Ae,el:Be,anchor:Ce,transition:ot}=De;if(Ae===$r){Ne(Be,Ce);return}if(Ae===pg){oe(De);return}const Dt=()=>{i(Be),ot&&!ot.persisted&&ot.afterLeave&&ot.afterLeave()};if(De.shapeFlag&1&&ot&&!ot.persisted){const{leave:Zt,delayLeave:an}=ot,ln=()=>Zt(Be,Dt);an?an(De.el,Dt,ln):ln()}else Dt()},Ne=(De,Ae)=>{let Be;for(;De!==Ae;)Be=M(De),i(De),De=Be;i(Ae)},Ve=(De,Ae,Be)=>{const{bum:Ce,scope:ot,job:Dt,subTree:Zt,um:an,m:ln,a:vn}=De;kx(ln),kx(vn),Ce&&k0(Ce),ot.stop(),Dt&&(Dt.flags|=8,ge(Zt,De,Ae,Be)),an&&oc(an,Ae),oc(()=>{De.isUnmounted=!0},Ae),Ae&&Ae.pendingBranch&&!Ae.isUnmounted&&De.asyncDep&&!De.asyncResolved&&De.suspenseId===Ae.pendingId&&(Ae.deps--,Ae.deps===0&&Ae.resolve())},it=(De,Ae,Be,Ce=!1,ot=!1,Dt=0)=>{for(let Zt=Dt;Zt<De.length;Zt++)ge(De[Zt],Ae,Be,Ce,ot)},lt=De=>{if(De.shapeFlag&6)return lt(De.component.subTree);if(De.shapeFlag&128)return De.suspense.next();const Ae=M(De.anchor||De.el),Be=Ae&&Ae[YM];return Be?M(Be):Ae};let Mt=!1;const wt=(De,Ae,Be)=>{De==null?Ae._vnode&&ge(Ae._vnode,null,null,!0):z(Ae._vnode||null,De,Ae,null,null,null,Be),Ae._vnode=De,Mt||(Mt=!0,wS(),Tx(),Mt=!1)},rn={p:z,um:ge,m:pt,r:Ie,mt:be,mc:ue,pc:Le,pbc:We,n:lt,o:e};let yn,Pn;return t&&([yn,Pn]=t(rn)),{render:wt,hydrate:yn,createApp:vR(wt,yn)}}function x5({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function Zm({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function AT(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function fC(e,t,n=!1){const r=e.children,i=t.children;if(bi(r)&&bi(i))for(let l=0;l<r.length;l++){const a=r[l];let o=i[l];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=i[l]=Jp(i[l]),o.el=a.el),!n&&o.patchFlag!==-2&&fC(a,o)),o.type===hm&&(o.el=a.el)}}function LR(e){const t=e.slice(),n=[0];let r,i,l,a,o;const f=e.length;for(r=0;r<f;r++){const m=e[r];if(m!==0){if(i=n[n.length-1],e[i]<m){t[r]=i,n.push(r);continue}for(l=0,a=n.length-1;l<a;)o=l+a>>1,e[n[o]]<m?l=o+1:a=o;m<e[n[l]]&&(l>0&&(t[r]=n[l-1]),n[l]=r)}}for(l=n.length,a=n[l-1];l-- >0;)n[l]=a,a=t[a];return n}function kT(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:kT(t)}function kx(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const IT=Symbol.for("v-scx"),DT=()=>yd(IT);function m_(e,t){return B_(e,null,t)}function PR(e,t){return B_(e,null,{flush:"post"})}function OT(e,t){return B_(e,null,{flush:"sync"})}function mo(e,t,n){return B_(e,t,n)}function B_(e,t,n=no){const{immediate:r,deep:i,flush:l,once:a}=n,o=wa({},n),f=t&&r||!t&&l!=="post";let m;if(U0){if(l==="sync"){const C=DT();m=C.__watcherHandles||(C.__watcherHandles=[])}else if(!f){const C=()=>{};return C.stop=Od,C.resume=Od,C.pause=Od,C}}const _=ac;o.call=(C,R,z)=>Nd(C,_,R,z);let w=!1;l==="post"?o.scheduler=C=>{oc(C,_&&_.suspense)}:l!=="sync"&&(w=!0,o.scheduler=(C,R)=>{R?C():nC(C)}),o.augmentJob=C=>{t&&(C.flags|=4),w&&(C.flags|=2,_&&(C.id=_.uid,C.i=_))};const M=gO(e,t,o);return U0&&(m?m.push(M):f&&M()),M}function ER(e,t,n){const r=this.proxy,i=Fa(e)?e.includes(".")?RT(r,e):()=>r[e]:e.bind(r,r);let l;Ki(t)?l=t:(l=t.handler,n=t);const a=wg(this),o=B_(i,l.bind(r),n);return a(),o}function RT(e,t){const n=t.split(".");return()=>{let r=e;for(let i=0;i<n.length&&r;i++)r=r[n[i]];return r}}function MR(e,t,n=no){const r=zd(),i=Nc(t),l=Gh(t),a=BT(e,i),o=VM((f,m)=>{let _,w=no,M;return OT(()=>{const C=e[i];wh(_,C)&&(_=C,m())}),{get(){return f(),n.get?n.get(_):_},set(C){const R=n.set?n.set(C):C;if(!wh(R,_)&&!(w!==no&&wh(C,w)))return;const z=r.vnode.props;z&&(t in z||i in z||l in z)&&(`onUpdate:${t}`in z||`onUpdate:${i}`in z||`onUpdate:${l}`in z)||(_=C,m()),r.emit(`update:${t}`,R),wh(C,R)&&wh(C,w)&&!wh(R,M)&&m(),w=C,M=R}}});return o[Symbol.iterator]=()=>{let f=0;return{next(){return f<2?{value:f++?a||no:o,done:!1}:{done:!0}}}},o}const BT=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Nc(t)}Modifiers`]||e[`${Gh(t)}Modifiers`];function TR(e,t,...n){if(e.isUnmounted)return;const r=e.vnode.props||no;let i=n;const l=t.startsWith("update:"),a=l&&BT(r,t.slice(7));a&&(a.trim&&(i=n.map(_=>Fa(_)?_.trim():_)),a.number&&(i=n.map(Sx)));let o,f=r[o=Nv(t)]||r[o=Nv(Nc(t))];!f&&l&&(f=r[o=Nv(Gh(t))]),f&&Nd(f,e,6,i);const m=r[o+"Once"];if(m){if(!e.emitted)e.emitted={};else if(e.emitted[o])return;e.emitted[o]=!0,Nd(m,e,6,i)}}function NT(e,t,n=!1){const r=t.emitsCache,i=r.get(e);if(i!==void 0)return i;const l=e.emits;let a={},o=!1;if(!Ki(e)){const f=m=>{const _=NT(m,t,!0);_&&(o=!0,wa(a,_))};!n&&t.mixins.length&&t.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}return!l&&!o?(la(e)&&r.set(e,null),null):(bi(l)?l.forEach(f=>a[f]=null):wa(a,l),la(e)&&r.set(e,a),a)}function P2(e,t){return!e||!D_(t)?!1:(t=t.slice(2).replace(/Once$/,""),xo(e,t[0].toLowerCase()+t.slice(1))||xo(e,Gh(t))||xo(e,t))}function Xb(e){const{type:t,vnode:n,proxy:r,withProxy:i,propsOptions:[l],slots:a,attrs:o,emit:f,render:m,renderCache:_,props:w,data:M,setupState:C,ctx:R,inheritAttrs:z}=e,W=d_(e);let X,Y;try{if(n.shapeFlag&4){const oe=i||r,le=oe;X=$h(m.call(le,oe,_,w,C,M,R)),Y=o}else{const oe=t;X=$h(oe.length>1?oe(w,{attrs:o,slots:a,emit:f}):oe(w,null)),Y=t.props?o:kR(o)}}catch(oe){$v.length=0,Eg(oe,e,1),X=Ns(qu)}let Q=X;if(Y&&z!==!1){const oe=Object.keys(Y),{shapeFlag:le}=Q;oe.length&&le&7&&(l&&oe.some(U3)&&(Y=IR(Y,l)),Q=Ff(Q,Y,!1,!0))}return n.dirs&&(Q=Ff(Q,null,!1,!0),Q.dirs=Q.dirs?Q.dirs.concat(n.dirs):n.dirs),n.transition&&_p(Q,n.transition),X=Q,d_(W),X}function AR(e,t=!0){let n;for(let r=0;r<e.length;r++){const i=e[r];if(bp(i)){if(i.type!==qu||i.children==="v-if"){if(n)return;n=i}}else return}return n}const kR=e=>{let t;for(const n in e)(n==="class"||n==="style"||D_(n))&&((t||(t={}))[n]=e[n]);return t},IR=(e,t)=>{const n={};for(const r in e)(!U3(r)||!(r.slice(9)in t))&&(n[r]=e[r]);return n};function DR(e,t,n){const{props:r,children:i,component:l}=e,{props:a,children:o,patchFlag:f}=t,m=l.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&f>=0){if(f&1024)return!0;if(f&16)return r?OS(r,a,m):!!a;if(f&8){const _=t.dynamicProps;for(let w=0;w<_.length;w++){const M=_[w];if(a[M]!==r[M]&&!P2(m,M))return!0}}}else return(i||o)&&(!o||!o.$stable)?!0:r===a?!1:r?a?OS(r,a,m):!0:!!a;return!1}function OS(e,t,n){const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!0;for(let i=0;i<r.length;i++){const l=r[i];if(t[l]!==e[l]&&!P2(n,l))return!0}return!1}function E2({vnode:e,parent:t},n){for(;t;){const r=t.subTree;if(r.suspense&&r.suspense.activeBranch===e&&(r.el=e.el),r===e)(e=t.vnode).el=n,t=t.parent;else break}}const Ix=e=>e.__isSuspense;let T4=0;const OR={name:"Suspense",__isSuspense:!0,process(e,t,n,r,i,l,a,o,f,m){if(e==null)BR(t,n,r,i,l,a,o,f,m);else{if(l&&l.deps>0&&!e.suspense.isInFallback){t.suspense=e.suspense,t.suspense.vnode=t,t.el=e.el;return}NR(e,t,n,r,i,a,o,f,m)}},hydrate:FR,normalize:zR},RR=OR;function g_(e,t){const n=e.props&&e.props[t];Ki(n)&&n()}function BR(e,t,n,r,i,l,a,o,f){const{p:m,o:{createElement:_}}=f,w=_("div"),M=e.suspense=FT(e,i,r,t,w,n,l,a,o,f);m(null,M.pendingBranch=e.ssContent,w,null,r,M,l,a),M.deps>0?(g_(e,"onPending"),g_(e,"onFallback"),m(null,e.ssFallback,t,n,r,null,l,a),D0(M,e.ssFallback)):M.resolve(!1,!0)}function NR(e,t,n,r,i,l,a,o,{p:f,um:m,o:{createElement:_}}){const w=t.suspense=e.suspense;w.vnode=t,t.el=e.el;const M=t.ssContent,C=t.ssFallback,{activeBranch:R,pendingBranch:z,isInFallback:W,isHydrating:X}=w;if(z)w.pendingBranch=M,ef(M,z)?(f(z,M,w.hiddenContainer,null,i,w,l,a,o),w.deps<=0?w.resolve():W&&(X||(f(R,C,n,r,i,null,l,a,o),D0(w,C)))):(w.pendingId=T4++,X?(w.isHydrating=!1,w.activeBranch=z):m(z,i,w),w.deps=0,w.effects.length=0,w.hiddenContainer=_("div"),W?(f(null,M,w.hiddenContainer,null,i,w,l,a,o),w.deps<=0?w.resolve():(f(R,C,n,r,i,null,l,a,o),D0(w,C))):R&&ef(M,R)?(f(R,M,n,r,i,w,l,a,o),w.resolve(!0)):(f(null,M,w.hiddenContainer,null,i,w,l,a,o),w.deps<=0&&w.resolve()));else if(R&&ef(M,R))f(R,M,n,r,i,w,l,a,o),D0(w,M);else if(g_(t,"onPending"),w.pendingBranch=M,M.shapeFlag&512?w.pendingId=M.component.suspenseId:w.pendingId=T4++,f(null,M,w.hiddenContainer,null,i,w,l,a,o),w.deps<=0)w.resolve();else{const{timeout:Y,pendingId:Q}=w;Y>0?setTimeout(()=>{w.pendingId===Q&&w.fallback(C)},Y):Y===0&&w.fallback(C)}}function FT(e,t,n,r,i,l,a,o,f,m,_=!1){const{p:w,m:M,um:C,n:R,o:{parentNode:z,remove:W}}=m;let X;const Y=jR(e);Y&&t&&t.pendingBranch&&(X=t.pendingId,t.deps++);const Q=e.props?Lx(e.props.timeout):void 0,oe=l,le={vnode:e,parent:t,parentComponent:n,namespace:a,container:r,hiddenContainer:i,deps:0,pendingId:T4++,timeout:typeof Q=="number"?Q:-1,activeBranch:null,pendingBranch:null,isInFallback:!_,isHydrating:_,isUnmounted:!1,effects:[],resolve(me=!1,we=!1){const{vnode:ue,activeBranch:_e,pendingBranch:We,pendingId:he,effects:de,parentComponent:Te,container:be}=le;let ae=!1;le.isHydrating?le.isHydrating=!1:me||(ae=_e&&We.transition&&We.transition.mode==="out-in",ae&&(_e.transition.afterLeave=()=>{he===le.pendingId&&(M(We,be,l===oe?R(_e):l,0),c_(de))}),_e&&(z(_e.el)===be&&(l=R(_e)),C(_e,Te,le,!0)),ae||M(We,be,l,0)),D0(le,We),le.pendingBranch=null,le.isInFallback=!1;let ne=le.parent,Se=!1;for(;ne;){if(ne.pendingBranch){ne.effects.push(...de),Se=!0;break}ne=ne.parent}!Se&&!ae&&c_(de),le.effects=[],Y&&t&&t.pendingBranch&&X===t.pendingId&&(t.deps--,t.deps===0&&!we&&t.resolve()),g_(ue,"onResolve")},fallback(me){if(!le.pendingBranch)return;const{vnode:we,activeBranch:ue,parentComponent:_e,container:We,namespace:he}=le;g_(we,"onFallback");const de=R(ue),Te=()=>{le.isInFallback&&(w(null,me,We,de,_e,null,he,o,f),D0(le,me))},be=me.transition&&me.transition.mode==="out-in";be&&(ue.transition.afterLeave=Te),le.isInFallback=!0,C(ue,_e,null,!0),be||Te()},move(me,we,ue){le.activeBranch&&M(le.activeBranch,me,we,ue),le.container=me},next(){return le.activeBranch&&R(le.activeBranch)},registerDep(me,we,ue){const _e=!!le.pendingBranch;_e&&le.deps++;const We=me.vnode.el;me.asyncDep.catch(he=>{Eg(he,me,0)}).then(he=>{if(me.isUnmounted||le.isUnmounted||le.pendingId!==me.suspenseId)return;me.asyncResolved=!0;const{vnode:de}=me;D4(me,he,!1),We&&(de.el=We);const Te=!We&&me.subTree.el;we(me,de,z(We||me.subTree.el),We?null:R(me.subTree),le,a,ue),Te&&W(Te),E2(me,de.el),_e&&--le.deps===0&&le.resolve()})},unmount(me,we){le.isUnmounted=!0,le.activeBranch&&C(le.activeBranch,n,me,we),le.pendingBranch&&C(le.pendingBranch,n,me,we)}};return le}function FR(e,t,n,r,i,l,a,o,f){const m=t.suspense=FT(t,r,n,e.parentNode,document.createElement("div"),null,i,l,a,o,!0),_=f(e,m.pendingBranch=t.ssContent,n,m,l,a);return m.deps===0&&m.resolve(!1,!0),_}function zR(e){const{shapeFlag:t,children:n}=e,r=t&32;e.ssContent=RS(r?n.default:n),e.ssFallback=r?RS(n.fallback):Ns(qu)}function RS(e){let t;if(Ki(e)){const n=xg&&e._c;n&&(e._d=!1,yt()),e=e(),n&&(e._d=!0,t=rh,jT())}return bi(e)&&(e=AR(e)),e=$h(e),t&&!e.dynamicChildren&&(e.dynamicChildren=t.filter(n=>n!==e)),e}function zT(e,t){t&&t.pendingBranch?bi(e)?t.effects.push(...e):t.effects.push(e):c_(e)}function D0(e,t){e.activeBranch=t;const{vnode:n,parentComponent:r}=e;let i=t.el;for(;!i&&t.component;)t=t.component.subTree,i=t.el;n.el=i,r&&r.subTree===n&&(r.vnode.el=i,E2(r,i))}function jR(e){const t=e.props&&e.props.suspensible;return t!=null&&t!==!1}const $r=Symbol.for("v-fgt"),hm=Symbol.for("v-txt"),qu=Symbol.for("v-cmt"),pg=Symbol.for("v-stc"),$v=[];let rh=null;function yt(e=!1){$v.push(rh=e?null:[])}function jT(){$v.pop(),rh=$v[$v.length-1]||null}let xg=1;function A4(e,t=!1){xg+=e,e<0&&rh&&t&&(rh.hasOnce=!0)}function UT(e){return e.dynamicChildren=xg>0?rh||M0:null,jT(),xg>0&&rh&&rh.push(e),e}function Et(e,t,n,r,i,l){return UT(V(e,t,n,r,i,l,!0))}function Hu(e,t,n,r,i){return UT(Ns(e,t,n,r,i,!0))}function bp(e){return e?e.__v_isVNode===!0:!1}function ef(e,t){return e.type===t.type&&e.key===t.key}function UR(e){}const VT=({key:e})=>e??null,Jb=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?Fa(e)||Ol(e)||Ki(e)?{i:uc,r:e,k:t,f:!!n}:e:null);function V(e,t=null,n=null,r=0,i=null,l=e===$r?0:1,a=!1,o=!1){const f={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&VT(t),ref:t&&Jb(t),scopeId:w2,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:l,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:uc};return o?(pC(f,n),l&128&&e.normalize(f)):n&&(f.shapeFlag|=Fa(n)?8:16),xg>0&&!a&&rh&&(f.patchFlag>0||l&6)&&f.patchFlag!==32&&rh.push(f),f}const Ns=VR;function VR(e,t=null,n=null,r=0,i=null,l=!1){if((!e||e===dT)&&(e=qu),bp(e)){const o=Ff(e,t,!0);return n&&pC(o,n),xg>0&&!l&&rh&&(o.shapeFlag&6?rh[rh.indexOf(e)]=o:rh.push(o)),o.patchFlag=-2,o}if(KR(e)&&(e=e.__vccOpts),t){t=$T(t);let{class:o,style:f}=t;o&&!Fa(o)&&(t.class=$s(o)),la(f)&&(b2(f)&&!bi(f)&&(f=wa({},f)),t.style=Zh(f))}const a=Fa(e)?1:Ix(e)?128:XM(e)?64:la(e)?4:Ki(e)?2:0;return V(e,t,n,r,i,a,l,!0)}function $T(e){return e?b2(e)||bT(e)?wa({},e):e:null}function Ff(e,t,n=!1,r=!1){const{props:i,ref:l,patchFlag:a,children:o,transition:f}=e,m=t?GT(i||{},t):i,_={__v_isVNode:!0,__v_skip:!0,type:e.type,props:m,key:m&&VT(m),ref:t&&t.ref?n&&l?bi(l)?l.concat(Jb(t)):[l,Jb(t)]:Jb(t):l,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==$r?a===-1?16:a|16:a,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:f,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Ff(e.ssContent),ssFallback:e.ssFallback&&Ff(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return f&&r&&_p(_,f.clone(_)),_}function rs(e=" ",t=0){return Ns(hm,null,e,t)}function vd(e,t){const n=Ns(pg,null,e);return n.staticCount=t,n}function yr(e="",t=!1){return t?(yt(),Hu(qu,null,e)):Ns(qu,null,e)}function $h(e){return e==null||typeof e=="boolean"?Ns(qu):bi(e)?Ns($r,null,e.slice()):bp(e)?Jp(e):Ns(hm,null,String(e))}function Jp(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Ff(e)}function pC(e,t){let n=0;const{shapeFlag:r}=e;if(t==null)t=null;else if(bi(t))n=16;else if(typeof t=="object")if(r&65){const i=t.default;i&&(i._c&&(i._d=!1),pC(e,i()),i._c&&(i._d=!0));return}else{n=32;const i=t._;!i&&!bT(t)?t._ctx=uc:i===3&&uc&&(uc.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else Ki(t)?(t={default:t,_ctx:uc},n=32):(t=String(t),r&64?(n=16,t=[rs(t)]):n=8);e.children=t,e.shapeFlag|=n}function GT(...e){const t={};for(let n=0;n<e.length;n++){const r=e[n];for(const i in r)if(i==="class")t.class!==r.class&&(t.class=$s([t.class,r.class]));else if(i==="style")t.style=Zh([t.style,r.style]);else if(D_(i)){const l=t[i],a=r[i];a&&l!==a&&!(bi(l)&&l.includes(a))&&(t[i]=l?[].concat(l,a):a)}else i!==""&&(t[i]=r[i])}return t}function zh(e,t,n,r=null){Nd(e,t,7,[n,r])}const $R=gT();let GR=0;function HT(e,t,n){const r=e.type,i=(t?t.appContext:e.appContext)||$R,l={uid:GR++,vnode:e,type:r,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new H3(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:wT(r,i),emitsOptions:NT(r,i),emit:null,emitted:null,propsDefaults:no,inheritAttrs:r.inheritAttrs,ctx:no,data:no,props:no,attrs:no,slots:no,refs:no,setupState:no,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return l.ctx={_:l},l.root=t?t.root:l,l.emit=TR.bind(null,l),e.ce&&e.ce(l),l}let ac=null;const zd=()=>ac||uc;let Dx,k4;{const e=p2(),t=(n,r)=>{let i;return(i=e[n])||(i=e[n]=[]),i.push(r),l=>{i.length>1?i.forEach(a=>a(l)):i[0](l)}};Dx=t("__VUE_INSTANCE_SETTERS__",n=>ac=n),k4=t("__VUE_SSR_SETTERS__",n=>U0=n)}const wg=e=>{const t=ac;return Dx(e),e.scope.on(),()=>{e.scope.off(),Dx(t)}},I4=()=>{ac&&ac.scope.off(),Dx(null)};function qT(e){return e.vnode.shapeFlag&4}let U0=!1;function WT(e,t=!1,n=!1){t&&k4(t);const{props:r,children:i}=e.vnode,l=qT(e);_R(e,r,l,t),CR(e,i,n);const a=l?HR(e,t):void 0;return t&&k4(!1),a}function HR(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,L4);const{setup:r}=n;if(r){bm();const i=e.setupContext=r.length>1?KT(e):null,l=wg(e),a=ey(r,e,0,[e.props,i]),o=$3(a);if(xm(),l(),(o||e.sp)&&!cm(e)&&sC(e),o){if(a.then(I4,I4),t)return a.then(f=>{D4(e,f,t)}).catch(f=>{Eg(f,e,0)});e.asyncDep=a}else D4(e,a,t)}else ZT(e,t)}function D4(e,t,n){Ki(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:la(t)&&(e.setupState=eC(t)),ZT(e,n)}let Ox,O4;function qR(e){Ox=e,O4=t=>{t.render._rc&&(t.withProxy=new Proxy(t.ctx,JO))}}const WR=()=>!Ox;function ZT(e,t,n){const r=e.type;if(!e.render){if(!t&&Ox&&!r.render){const i=r.template||hC(e).template;if(i){const{isCustomElement:l,compilerOptions:a}=e.appContext.config,{delimiters:o,compilerOptions:f}=r,m=wa(wa({isCustomElement:l,delimiters:o},a),f);r.render=Ox(i,m)}}e.render=r.render||Od,O4&&O4(e)}{const i=wg(e);bm();try{dR(e)}finally{xm(),i()}}}const ZR={get(e,t){return Jc(e,"get",""),e[t]}};function KT(e){const t=n=>{e.exposed=n||{}};return{attrs:new Proxy(e.attrs,ZR),slots:e.slots,emit:e.emit,expose:t}}function N_(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(eC(x2(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in Uv)return Uv[n](e)},has(t,n){return n in t||n in Uv}})):e.proxy}function R4(e,t=!0){return Ki(e)?e.displayName||e.name:e.name||t&&e.__name}function KR(e){return Ki(e)&&"__vccOpts"in e}const Ai=(e,t)=>dO(e,t,U0);function M2(e,t,n){const r=arguments.length;return r===2?la(t)&&!bi(t)?bp(t)?Ns(e,null,[t]):Ns(e,t):Ns(e,null,t):(r>3?n=Array.prototype.slice.call(arguments,2):r===3&&bp(n)&&(n=[n]),Ns(e,t,n))}function YR(){}function XR(e,t,n,r){const i=n[r];if(i&&YT(i,e))return i;const l=t();return l.memo=e.slice(),l.cacheIndex=r,n[r]=l}function YT(e,t){const n=e.memo;if(n.length!=t.length)return!1;for(let r=0;r<n.length;r++)if(wh(n[r],t[r]))return!1;return xg>0&&rh&&rh.push(e),!0}const XT="3.5.13",JR=Od,QR=xO,eB=_0,tB=KM,nB={createComponentInstance:HT,setupComponent:WT,renderComponentRoot:Xb,setCurrentRenderingInstance:d_,isVNode:bp,normalizeVNode:$h,getComponentPublicInstance:N_,ensureValidVNode:cC,pushWarningContext:yO,popWarningContext:vO},rB=nB,iB=null,sB=null,oB=null;/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let B4;const BS=typeof window<"u"&&window.trustedTypes;if(BS)try{B4=BS.createPolicy("vue",{createHTML:e=>e})}catch{}const JT=B4?e=>B4.createHTML(e):e=>e,aB="http://www.w3.org/2000/svg",lB="http://www.w3.org/1998/Math/MathML",up=typeof document<"u"?document:null,NS=up&&up.createElement("template"),uB={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,r)=>{const i=t==="svg"?up.createElementNS(aB,e):t==="mathml"?up.createElementNS(lB,e):n?up.createElement(e,{is:n}):up.createElement(e);return e==="select"&&r&&r.multiple!=null&&i.setAttribute("multiple",r.multiple),i},createText:e=>up.createTextNode(e),createComment:e=>up.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>up.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,r,i,l){const a=n?n.previousSibling:t.lastChild;if(i&&(i===l||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),n),!(i===l||!(i=i.nextSibling)););else{NS.innerHTML=JT(r==="svg"?`<svg>${e}</svg>`:r==="mathml"?`<math>${e}</math>`:e);const o=NS.content;if(r==="svg"||r==="mathml"){const f=o.firstChild;for(;f.firstChild;)o.appendChild(f.firstChild);o.removeChild(f)}t.insertBefore(o,n)}return[a?a.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},Vp="transition",nv="animation",V0=Symbol("_vtc"),QT={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},eA=wa({},iC,QT),cB=e=>(e.displayName="Transition",e.props=eA,e),N4=cB((e,{slots:t})=>M2(nT,tA(e),t)),Km=(e,t=[])=>{bi(e)?e.forEach(n=>n(...t)):e&&e(...t)},FS=e=>e?bi(e)?e.some(t=>t.length>1):e.length>1:!1;function tA(e){const t={};for(const de in e)de in QT||(t[de]=e[de]);if(e.css===!1)return t;const{name:n="v",type:r,duration:i,enterFromClass:l=`${n}-enter-from`,enterActiveClass:a=`${n}-enter-active`,enterToClass:o=`${n}-enter-to`,appearFromClass:f=l,appearActiveClass:m=a,appearToClass:_=o,leaveFromClass:w=`${n}-leave-from`,leaveActiveClass:M=`${n}-leave-active`,leaveToClass:C=`${n}-leave-to`}=e,R=hB(i),z=R&&R[0],W=R&&R[1],{onBeforeEnter:X,onEnter:Y,onEnterCancelled:Q,onLeave:oe,onLeaveCancelled:le,onBeforeAppear:me=X,onAppear:we=Y,onAppearCancelled:ue=Q}=t,_e=(de,Te,be,ae)=>{de._enterCancelled=ae,Wp(de,Te?_:o),Wp(de,Te?m:a),be&&be()},We=(de,Te)=>{de._isLeaving=!1,Wp(de,w),Wp(de,C),Wp(de,M),Te&&Te()},he=de=>(Te,be)=>{const ae=de?we:Y,ne=()=>_e(Te,de,be);Km(ae,[Te,ne]),zS(()=>{Wp(Te,de?f:l),Sf(Te,de?_:o),FS(ae)||jS(Te,r,z,ne)})};return wa(t,{onBeforeEnter(de){Km(X,[de]),Sf(de,l),Sf(de,a)},onBeforeAppear(de){Km(me,[de]),Sf(de,f),Sf(de,m)},onEnter:he(!1),onAppear:he(!0),onLeave(de,Te){de._isLeaving=!0;const be=()=>We(de,Te);Sf(de,w),de._enterCancelled?(Sf(de,M),F4()):(F4(),Sf(de,M)),zS(()=>{de._isLeaving&&(Wp(de,w),Sf(de,C),FS(oe)||jS(de,r,W,be))}),Km(oe,[de,be])},onEnterCancelled(de){_e(de,!1,void 0,!0),Km(Q,[de])},onAppearCancelled(de){_e(de,!0,void 0,!0),Km(ue,[de])},onLeaveCancelled(de){We(de),Km(le,[de])}})}function hB(e){if(e==null)return null;if(la(e))return[w5(e.enter),w5(e.leave)];{const t=w5(e);return[t,t]}}function w5(e){return Lx(e)}function Sf(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.add(n)),(e[V0]||(e[V0]=new Set)).add(t)}function Wp(e,t){t.split(/\s+/).forEach(r=>r&&e.classList.remove(r));const n=e[V0];n&&(n.delete(t),n.size||(e[V0]=void 0))}function zS(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let dB=0;function jS(e,t,n,r){const i=e._endId=++dB,l=()=>{i===e._endId&&r()};if(n!=null)return setTimeout(l,n);const{type:a,timeout:o,propCount:f}=nA(e,t);if(!a)return r();const m=a+"end";let _=0;const w=()=>{e.removeEventListener(m,M),l()},M=C=>{C.target===e&&++_>=f&&w()};setTimeout(()=>{_<f&&w()},o+1),e.addEventListener(m,M)}function nA(e,t){const n=window.getComputedStyle(e),r=R=>(n[R]||"").split(", "),i=r(`${Vp}Delay`),l=r(`${Vp}Duration`),a=US(i,l),o=r(`${nv}Delay`),f=r(`${nv}Duration`),m=US(o,f);let _=null,w=0,M=0;t===Vp?a>0&&(_=Vp,w=a,M=l.length):t===nv?m>0&&(_=nv,w=m,M=f.length):(w=Math.max(a,m),_=w>0?a>m?Vp:nv:null,M=_?_===Vp?l.length:f.length:0);const C=_===Vp&&/\b(transform|all)(,|$)/.test(r(`${Vp}Property`).toString());return{type:_,timeout:w,propCount:M,hasTransform:C}}function US(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((n,r)=>VS(n)+VS(e[r])))}function VS(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function F4(){return document.body.offsetHeight}function fB(e,t,n){const r=e[V0];r&&(t=(t?[t,...r]:[...r]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const Rx=Symbol("_vod"),rA=Symbol("_vsh"),mC={beforeMount(e,{value:t},{transition:n}){e[Rx]=e.style.display==="none"?"":e.style.display,n&&t?n.beforeEnter(e):rv(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:r}){!t!=!n&&(r?t?(r.beforeEnter(e),rv(e,!0),r.enter(e)):r.leave(e,()=>{rv(e,!1)}):rv(e,t))},beforeUnmount(e,{value:t}){rv(e,t)}};function rv(e,t){e.style.display=t?e[Rx]:"none",e[rA]=!t}function pB(){mC.getSSRProps=({value:e})=>{if(!e)return{style:{display:"none"}}}}const iA=Symbol("");function mB(e){const t=zd();if(!t)return;const n=t.ut=(i=e(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach(l=>Bx(l,i))},r=()=>{const i=e(t.proxy);t.ce?Bx(t.ce,i):z4(t.subTree,i),n(i)};oC(()=>{c_(r)}),Rl(()=>{mo(r,Od,{flush:"post"});const i=new MutationObserver(r);i.observe(t.subTree.el.parentNode,{childList:!0}),gd(()=>i.disconnect())})}function z4(e,t){if(e.shapeFlag&128){const n=e.suspense;e=n.activeBranch,n.pendingBranch&&!n.isHydrating&&n.effects.push(()=>{z4(n.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)Bx(e.el,t);else if(e.type===$r)e.children.forEach(n=>z4(n,t));else if(e.type===pg){let{el:n,anchor:r}=e;for(;n&&(Bx(n,t),n!==r);)n=n.nextSibling}}function Bx(e,t){if(e.nodeType===1){const n=e.style;let r="";for(const i in t)n.setProperty(`--${i}`,t[i]),r+=`--${i}: ${t[i]};`;n[iA]=r}}const gB=/(^|;)\s*display\s*:/;function yB(e,t,n){const r=e.style,i=Fa(n);let l=!1;if(n&&!i){if(t)if(Fa(t))for(const a of t.split(";")){const o=a.slice(0,a.indexOf(":")).trim();n[o]==null&&Qb(r,o,"")}else for(const a in t)n[a]==null&&Qb(r,a,"");for(const a in n)a==="display"&&(l=!0),Qb(r,a,n[a])}else if(i){if(t!==n){const a=r[iA];a&&(n+=";"+a),r.cssText=n,l=gB.test(n)}}else t&&e.removeAttribute("style");Rx in e&&(e[Rx]=l?r.display:"",e[rA]&&(r.display="none"))}const $S=/\s*!important$/;function Qb(e,t,n){if(bi(n))n.forEach(r=>Qb(e,t,r));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const r=vB(e,t);$S.test(n)?e.setProperty(Gh(r),n.replace($S,""),"important"):e[r]=n}}const GS=["Webkit","Moz","ms"],C5={};function vB(e,t){const n=C5[t];if(n)return n;let r=Nc(t);if(r!=="filter"&&r in e)return C5[t]=r;r=O_(r);for(let i=0;i<GS.length;i++){const l=GS[i]+r;if(l in e)return C5[t]=l}return t}const HS="http://www.w3.org/1999/xlink";function qS(e,t,n,r,i,l=DD(t)){r&&t.startsWith("xlink:")?n==null?e.removeAttributeNS(HS,t.slice(6,t.length)):e.setAttributeNS(HS,t,n):n==null||l&&!wM(n)?e.removeAttribute(t):e.setAttribute(t,l?"":of(n)?String(n):n)}function WS(e,t,n,r,i){if(t==="innerHTML"||t==="textContent"){n!=null&&(e[t]=t==="innerHTML"?JT(n):n);return}const l=e.tagName;if(t==="value"&&l!=="PROGRESS"&&!l.includes("-")){const o=l==="OPTION"?e.getAttribute("value")||"":e.value,f=n==null?e.type==="checkbox"?"on":"":String(n);(o!==f||!("_value"in e))&&(e.value=f),n==null&&e.removeAttribute(t),e._value=n;return}let a=!1;if(n===""||n==null){const o=typeof e[t];o==="boolean"?n=wM(n):n==null&&o==="string"?(n="",a=!0):o==="number"&&(n=0,a=!0)}try{e[t]=n}catch{}a&&e.removeAttribute(i||t)}function fp(e,t,n,r){e.addEventListener(t,n,r)}function _B(e,t,n,r){e.removeEventListener(t,n,r)}const ZS=Symbol("_vei");function bB(e,t,n,r,i=null){const l=e[ZS]||(e[ZS]={}),a=l[t];if(r&&a)a.value=r;else{const[o,f]=xB(t);if(r){const m=l[t]=SB(r,i);fp(e,o,m,f)}else a&&(_B(e,o,a,f),l[t]=void 0)}}const KS=/(?:Once|Passive|Capture)$/;function xB(e){let t;if(KS.test(e)){t={};let r;for(;r=e.match(KS);)e=e.slice(0,e.length-r[0].length),t[r[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Gh(e.slice(2)),t]}let S5=0;const wB=Promise.resolve(),CB=()=>S5||(wB.then(()=>S5=0),S5=Date.now());function SB(e,t){const n=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=n.attached)return;Nd(LB(r,n.value),t,5,[r])};return n.value=e,n.attached=CB(),n}function LB(e,t){if(bi(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(r=>i=>!i._stopped&&r&&r(i))}else return t}const YS=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,PB=(e,t,n,r,i,l)=>{const a=i==="svg";t==="class"?fB(e,r,a):t==="style"?yB(e,n,r):D_(t)?U3(t)||bB(e,t,n,r,l):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):EB(e,t,r,a))?(WS(e,t,r),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&qS(e,t,r,a,l,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Fa(r))?WS(e,Nc(t),r,l,t):(t==="true-value"?e._trueValue=r:t==="false-value"&&(e._falseValue=r),qS(e,t,r,a))};function EB(e,t,n,r){if(r)return!!(t==="innerHTML"||t==="textContent"||t in e&&YS(t)&&Ki(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const i=e.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return YS(t)&&Fa(n)?!1:t in e}const XS={};/*! #__NO_SIDE_EFFECTS__ */function sA(e,t,n){const r=Ja(e,t);d2(r)&&wa(r,t);class i extends T2{constructor(a){super(r,a,n)}}return i.def=r,i}/*! #__NO_SIDE_EFFECTS__ */const MB=(e,t)=>sA(e,t,mA),TB=typeof HTMLElement<"u"?HTMLElement:class{};class T2 extends TB{constructor(t,n={},r=Fx){super(),this._def=t,this._props=n,this._createApp=r,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&r!==Fx?this._root=this.shadowRoot:t.shadowRoot!==!1?(this.attachShadow({mode:"open"}),this._root=this.shadowRoot):this._root=this,this._def.__asyncLoader||this._resolveProps(this._def)}connectedCallback(){if(!this.isConnected)return;this.shadowRoot||this._parseSlots(),this._connected=!0;let t=this;for(;t=t&&(t.parentNode||t.host);)if(t instanceof T2){this._parent=t;break}this._instance||(this._resolved?(this._setParent(),this._update()):t&&t._pendingResolve?this._pendingResolve=t._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(t=this._parent){t&&(this._instance.parent=t._instance,this._instance.provides=t._instance.provides)}disconnectedCallback(){this._connected=!1,Sh(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null)})}_resolveDef(){if(this._pendingResolve)return;for(let r=0;r<this.attributes.length;r++)this._setAttr(this.attributes[r].name);this._ob=new MutationObserver(r=>{for(const i of r)this._setAttr(i.attributeName)}),this._ob.observe(this,{attributes:!0});const t=(r,i=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:l,styles:a}=r;let o;if(l&&!bi(l))for(const f in l){const m=l[f];(m===Number||m&&m.type===Number)&&(f in this._props&&(this._props[f]=Lx(this._props[f])),(o||(o=Object.create(null)))[Nc(f)]=!0)}this._numberProps=o,i&&this._resolveProps(r),this.shadowRoot&&this._applyStyles(a),this._mount(r)},n=this._def.__asyncLoader;n?this._pendingResolve=n().then(r=>t(this._def=r,!0)):t(this._def)}_mount(t){this._app=this._createApp(t),t.configureApp&&t.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const n=this._instance&&this._instance.exposed;if(n)for(const r in n)xo(this,r)||Object.defineProperty(this,r,{get:()=>Tr(n[r])})}_resolveProps(t){const{props:n}=t,r=bi(n)?n:Object.keys(n||{});for(const i of Object.keys(this))i[0]!=="_"&&r.includes(i)&&this._setProp(i,this[i]);for(const i of r.map(Nc))Object.defineProperty(this,i,{get(){return this._getProp(i)},set(l){this._setProp(i,l,!0,!0)}})}_setAttr(t){if(t.startsWith("data-v-"))return;const n=this.hasAttribute(t);let r=n?this.getAttribute(t):XS;const i=Nc(t);n&&this._numberProps&&this._numberProps[i]&&(r=Lx(r)),this._setProp(i,r,!1,!0)}_getProp(t){return this._props[t]}_setProp(t,n,r=!0,i=!1){if(n!==this._props[t]&&(n===XS?delete this._props[t]:(this._props[t]=n,t==="key"&&this._app&&(this._app._ceVNode.key=n)),i&&this._instance&&this._update(),r)){const l=this._ob;l&&l.disconnect(),n===!0?this.setAttribute(Gh(t),""):typeof n=="string"||typeof n=="number"?this.setAttribute(Gh(t),n+""):n||this.removeAttribute(Gh(t)),l&&l.observe(this,{attributes:!0})}}_update(){pA(this._createVNode(),this._root)}_createVNode(){const t={};this.shadowRoot||(t.onVnodeMounted=t.onVnodeUpdated=this._renderSlots.bind(this));const n=Ns(this._def,wa(t,this._props));return this._instance||(n.ce=r=>{this._instance=r,r.ce=this,r.isCE=!0;const i=(l,a)=>{this.dispatchEvent(new CustomEvent(l,d2(a[0])?wa({detail:a},a[0]):{detail:a}))};r.emit=(l,...a)=>{i(l,a),Gh(l)!==l&&i(Gh(l),a)},this._setParent()}),n}_applyStyles(t,n){if(!t)return;if(n){if(n===this._def||this._styleChildren.has(n))return;this._styleChildren.add(n)}const r=this._nonce;for(let i=t.length-1;i>=0;i--){const l=document.createElement("style");r&&l.setAttribute("nonce",r),l.textContent=t[i],this.shadowRoot.prepend(l)}}_parseSlots(){const t=this._slots={};let n;for(;n=this.firstChild;){const r=n.nodeType===1&&n.getAttribute("slot")||"default";(t[r]||(t[r]=[])).push(n),this.removeChild(n)}}_renderSlots(){const t=(this._teleportTarget||this).querySelectorAll("slot"),n=this._instance.type.__scopeId;for(let r=0;r<t.length;r++){const i=t[r],l=i.getAttribute("name")||"default",a=this._slots[l],o=i.parentNode;if(a)for(const f of a){if(n&&f.nodeType===1){const m=n+"-s",_=document.createTreeWalker(f,1);f.setAttribute(m,"");let w;for(;w=_.nextNode();)w.setAttribute(m,"")}o.insertBefore(f,i)}else for(;i.firstChild;)o.insertBefore(i.firstChild,i);o.removeChild(i)}}_injectChildStyle(t){this._applyStyles(t.styles,t)}_removeChildStyle(t){}}function oA(e){const t=zd(),n=t&&t.ce;return n||null}function AB(){const e=oA();return e&&e.shadowRoot}function kB(e="$style"){{const t=zd();if(!t)return no;const n=t.type.__cssModules;if(!n)return no;const r=n[e];return r||no}}const aA=new WeakMap,lA=new WeakMap,Nx=Symbol("_moveCb"),JS=Symbol("_enterCb"),IB=e=>(delete e.props.mode,e),DB=IB({name:"TransitionGroup",props:wa({},eA,{tag:String,moveClass:String}),setup(e,{slots:t}){const n=zd(),r=rC();let i,l;return L2(()=>{if(!i.length)return;const a=e.moveClass||`${e.name||"v"}-move`;if(!FB(i[0].el,n.vnode.el,a))return;i.forEach(RB),i.forEach(BB);const o=i.filter(NB);F4(),o.forEach(f=>{const m=f.el,_=m.style;Sf(m,a),_.transform=_.webkitTransform=_.transitionDuration="";const w=m[Nx]=M=>{M&&M.target!==m||(!M||/transform$/.test(M.propertyName))&&(m.removeEventListener("transitionend",w),m[Nx]=null,Wp(m,a))};m.addEventListener("transitionend",w)})}),()=>{const a=eo(e),o=tA(a);let f=a.tag||$r;if(i=[],l)for(let m=0;m<l.length;m++){const _=l[m];_.el&&_.el instanceof Element&&(i.push(_),_p(_,j0(_,o,r,n)),aA.set(_,_.el.getBoundingClientRect()))}l=t.default?C2(t.default()):[];for(let m=0;m<l.length;m++){const _=l[m];_.key!=null&&_p(_,j0(_,o,r,n))}return Ns(f,null,l)}}}),OB=DB;function RB(e){const t=e.el;t[Nx]&&t[Nx](),t[JS]&&t[JS]()}function BB(e){lA.set(e,e.el.getBoundingClientRect())}function NB(e){const t=aA.get(e),n=lA.get(e),r=t.left-n.left,i=t.top-n.top;if(r||i){const l=e.el.style;return l.transform=l.webkitTransform=`translate(${r}px,${i}px)`,l.transitionDuration="0s",e}}function FB(e,t,n){const r=e.cloneNode(),i=e[V0];i&&i.forEach(o=>{o.split(/\s+/).forEach(f=>f&&r.classList.remove(f))}),n.split(/\s+/).forEach(o=>o&&r.classList.add(o)),r.style.display="none";const l=t.nodeType===1?t:t.parentNode;l.appendChild(r);const{hasTransform:a}=nA(r);return l.removeChild(r),a}const mm=e=>{const t=e.props["onUpdate:modelValue"]||!1;return bi(t)?n=>k0(t,n):t};function zB(e){e.target.composing=!0}function QS(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Rd=Symbol("_assign"),to={created(e,{modifiers:{lazy:t,trim:n,number:r}},i){e[Rd]=mm(i);const l=r||i.props&&i.props.type==="number";fp(e,t?"change":"input",a=>{if(a.target.composing)return;let o=e.value;n&&(o=o.trim()),l&&(o=Sx(o)),e[Rd](o)}),n&&fp(e,"change",()=>{e.value=e.value.trim()}),t||(fp(e,"compositionstart",zB),fp(e,"compositionend",QS),fp(e,"change",QS))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:r,trim:i,number:l}},a){if(e[Rd]=mm(a),e.composing)return;const o=(l||e.type==="number")&&!/^0\d/.test(e.value)?Sx(e.value):e.value,f=t??"";o!==f&&(document.activeElement===e&&e.type!=="range"&&(r&&t===n||i&&e.value.trim()===f)||(e.value=f))}},jh={deep:!0,created(e,t,n){e[Rd]=mm(n),fp(e,"change",()=>{const r=e._modelValue,i=$0(e),l=e.checked,a=e[Rd];if(bi(r)){const o=m2(r,i),f=o!==-1;if(l&&!f)a(r.concat(i));else if(!l&&f){const m=[...r];m.splice(o,1),a(m)}}else if(Pg(r)){const o=new Set(r);l?o.add(i):o.delete(i),a(o)}else a(uA(e,l))})},mounted:eL,beforeUpdate(e,t,n){e[Rd]=mm(n),eL(e,t,n)}};function eL(e,{value:t,oldValue:n},r){e._modelValue=t;let i;if(bi(t))i=m2(t,r.props.value)>-1;else if(Pg(t))i=t.has(r.props.value);else{if(t===n)return;i=fm(t,uA(e,!0))}e.checked!==i&&(e.checked=i)}const O0={created(e,{value:t},n){e.checked=fm(t,n.props.value),e[Rd]=mm(n),fp(e,"change",()=>{e[Rd]($0(e))})},beforeUpdate(e,{value:t,oldValue:n},r){e[Rd]=mm(r),t!==n&&(e.checked=fm(t,r.props.value))}},Ka={deep:!0,created(e,{value:t,modifiers:{number:n}},r){const i=Pg(t);fp(e,"change",()=>{const l=Array.prototype.filter.call(e.options,a=>a.selected).map(a=>n?Sx($0(a)):$0(a));e[Rd](e.multiple?i?new Set(l):l:l[0]),e._assigning=!0,Sh(()=>{e._assigning=!1})}),e[Rd]=mm(r)},mounted(e,{value:t}){tL(e,t)},beforeUpdate(e,t,n){e[Rd]=mm(n)},updated(e,{value:t}){e._assigning||tL(e,t)}};function tL(e,t){const n=e.multiple,r=bi(t);if(!(n&&!r&&!Pg(t))){for(let i=0,l=e.options.length;i<l;i++){const a=e.options[i],o=$0(a);if(n)if(r){const f=typeof o;f==="string"||f==="number"?a.selected=t.some(m=>String(m)===String(o)):a.selected=m2(t,o)>-1}else a.selected=t.has(o);else if(fm($0(a),t)){e.selectedIndex!==i&&(e.selectedIndex=i);return}}!n&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function $0(e){return"_value"in e?e._value:e.value}function uA(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const gC={created(e,t,n){yb(e,t,n,null,"created")},mounted(e,t,n){yb(e,t,n,null,"mounted")},beforeUpdate(e,t,n,r){yb(e,t,n,r,"beforeUpdate")},updated(e,t,n,r){yb(e,t,n,r,"updated")}};function cA(e,t){switch(e){case"SELECT":return Ka;case"TEXTAREA":return to;default:switch(t){case"checkbox":return jh;case"radio":return O0;default:return to}}}function yb(e,t,n,r,i){const a=cA(e.tagName,n.props&&n.props.type)[i];a&&a(e,t,n,r)}function jB(){to.getSSRProps=({value:e})=>({value:e}),O0.getSSRProps=({value:e},t)=>{if(t.props&&fm(t.props.value,e))return{checked:!0}},jh.getSSRProps=({value:e},t)=>{if(bi(e)){if(t.props&&m2(e,t.props.value)>-1)return{checked:!0}}else if(Pg(e)){if(t.props&&e.has(t.props.value))return{checked:!0}}else if(e)return{checked:!0}},gC.getSSRProps=(e,t)=>{if(typeof t.type!="string")return;const n=cA(t.type.toUpperCase(),t.props&&t.props.type);if(n.getSSRProps)return n.getSSRProps(e,t)}}const UB=["ctrl","shift","alt","meta"],VB={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>UB.some(n=>e[`${n}Key`]&&!t.includes(n))},Wh=(e,t)=>{const n=e._withMods||(e._withMods={}),r=t.join(".");return n[r]||(n[r]=(i,...l)=>{for(let a=0;a<t.length;a++){const o=VB[t[a]];if(o&&o(i,t))return}return e(i,...l)})},$B={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},GB=(e,t)=>{const n=e._withKeys||(e._withKeys={}),r=t.join(".");return n[r]||(n[r]=i=>{if(!("key"in i))return;const l=Gh(i.key);if(t.some(a=>a===l||$B[a]===l))return e(i)})},hA=wa({patchProp:PB},uB);let Gv,nL=!1;function dA(){return Gv||(Gv=ET(hA))}function fA(){return Gv=nL?Gv:MT(hA),nL=!0,Gv}const pA=(...e)=>{dA().render(...e)},HB=(...e)=>{fA().hydrate(...e)},Fx=(...e)=>{const t=dA().createApp(...e),{mount:n}=t;return t.mount=r=>{const i=yA(r);if(!i)return;const l=t._component;!Ki(l)&&!l.render&&!l.template&&(l.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const a=n(i,!1,gA(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),a},t},mA=(...e)=>{const t=fA().createApp(...e),{mount:n}=t;return t.mount=r=>{const i=yA(r);if(i)return n(i,!0,gA(i))},t};function gA(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function yA(e){return Fa(e)?document.querySelector(e):e}let rL=!1;const qB=()=>{rL||(rL=!0,jB(),pB())};/**
* vue v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const WB=()=>{},ZB=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:nT,BaseTransitionPropsValidators:iC,Comment:qu,DeprecationTypes:oB,EffectScope:H3,ErrorCodes:bO,ErrorTypeStrings:QR,Fragment:$r,KeepAlive:HO,ReactiveEffect:a_,Static:pg,Suspense:RR,Teleport:b0,Text:hm,TrackOpTypes:fO,Transition:N4,TransitionGroup:OB,TriggerOpTypes:pO,VueElement:T2,assertNumber:_O,callWithAsyncErrorHandling:Nd,callWithErrorHandling:ey,camelize:Nc,capitalize:O_,cloneVNode:Ff,compatUtils:sB,compile:WB,computed:Ai,createApp:Fx,createBlock:Hu,createCommentVNode:yr,createElementBlock:Et,createElementVNode:V,createHydrationRenderer:MT,createPropsRestProxy:cR,createRenderer:ET,createSSRApp:mA,createSlots:KO,createStaticVNode:vd,createTextVNode:rs,createVNode:Ns,customRef:VM,defineAsyncComponent:$O,defineComponent:Ja,defineCustomElement:sA,defineEmits:eR,defineExpose:tR,defineModel:iR,defineOptions:nR,defineProps:QO,defineSSRCustomElement:MB,defineSlots:rR,devtools:eB,effect:BD,effectScope:q3,getCurrentInstance:zd,getCurrentScope:W3,getCurrentWatcher:mO,getTransitionRawChildren:C2,guardReactiveProps:$T,h:M2,handleError:Eg,hasInjectionContext:yT,hydrate:HB,hydrateOnIdle:NO,hydrateOnInteraction:UO,hydrateOnMediaQuery:jO,hydrateOnVisible:zO,initCustomFormatter:YR,initDirectivesForSSR:qB,inject:yd,isMemoSame:YT,isProxy:b2,isReactive:Of,isReadonly:pm,isRef:Ol,isRuntimeOnly:WR,isShallow:md,isVNode:bp,markRaw:x2,mergeDefaults:lR,mergeModels:uR,mergeProps:GT,nextTick:Sh,normalizeClass:$s,normalizeProps:kD,normalizeStyle:Zh,onActivated:iT,onBeforeMount:aT,onBeforeUnmount:wm,onBeforeUpdate:oC,onDeactivated:sT,onErrorCaptured:hT,onMounted:Rl,onRenderTracked:cT,onRenderTriggered:uT,onScopeDispose:LM,onServerPrefetch:lT,onUnmounted:gd,onUpdated:L2,onWatcherCleanup:GM,openBlock:yt,popScopeId:LO,provide:Vv,proxyRefs:eC,pushScopeId:SO,queuePostFlushCb:c_,reactive:bd,readonly:J3,ref:Rn,registerRuntimeCompiler:qR,render:pA,renderList:Ti,renderSlot:YO,resolveComponent:lC,resolveDirective:ZO,resolveDynamicComponent:fT,resolveFilter:iB,resolveTransitionHooks:j0,setBlockTracking:A4,setDevtoolsHook:tB,setTransitionHooks:_p,shallowReactive:X3,shallowReadonly:nO,shallowRef:Q3,ssrContextKey:IT,ssrUtils:rB,stop:ND,toDisplayString:er,toHandlerKey:Nv,toHandlers:XO,toRaw:eo,toRef:cO,toRefs:tC,toValue:sO,transformVNodeArgs:UR,triggerRef:iO,unref:Tr,useAttrs:aR,useCssModule:kB,useCssVars:mB,useHost:oA,useId:TO,useModel:MR,useSSRContext:DT,useShadowRoot:AB,useSlots:oR,useTemplateRef:AO,useTransitionState:rC,vModelCheckbox:jh,vModelDynamic:gC,vModelRadio:O0,vModelSelect:Ka,vModelText:to,vShow:mC,version:XT,warn:JR,watch:mo,watchEffect:m_,watchPostEffect:PR,watchSyncEffect:OT,withAsyncContext:hR,withCtx:Hh,withDefaults:sR,withDirectives:li,withKeys:GB,withMemo:XR,withModifiers:Wh,withScopeId:PO},Symbol.toStringTag,{value:"Module"}));/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let vA;const A2=e=>vA=e,_A=Symbol();function j4(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var Hv;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Hv||(Hv={}));function KB(){const e=q3(!0),t=e.run(()=>Rn({}));let n=[],r=[];const i=x2({install(l){A2(i),i._a=l,l.provide(_A,i),l.config.globalProperties.$pinia=i,r.forEach(a=>n.push(a)),r=[]},use(l){return this._a?n.push(l):r.push(l),this},_p:n,_a:null,_e:e,_s:new Map,state:t});return i}const bA=()=>{};function iL(e,t,n,r=bA){e.push(t);const i=()=>{const l=e.indexOf(t);l>-1&&(e.splice(l,1),r())};return!n&&W3()&&LM(i),i}function l0(e,...t){e.slice().forEach(n=>{n(...t)})}const YB=e=>e(),sL=Symbol(),L5=Symbol();function U4(e,t){e instanceof Map&&t instanceof Map?t.forEach((n,r)=>e.set(r,n)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const n in t){if(!t.hasOwnProperty(n))continue;const r=t[n],i=e[n];j4(i)&&j4(r)&&e.hasOwnProperty(n)&&!Ol(r)&&!Of(r)?e[n]=U4(i,r):e[n]=r}return e}const XB=Symbol();function JB(e){return!j4(e)||!e.hasOwnProperty(XB)}const{assign:Zp}=Object;function QB(e){return!!(Ol(e)&&e.effect)}function e8(e,t,n,r){const{state:i,actions:l,getters:a}=t,o=n.state.value[e];let f;function m(){o||(n.state.value[e]=i?i():{});const _=tC(n.state.value[e]);return Zp(_,l,Object.keys(a||{}).reduce((w,M)=>(w[M]=x2(Ai(()=>{A2(n);const C=n._s.get(e);return a[M].call(C,C)})),w),{}))}return f=xA(e,m,t,n,r,!0),f}function xA(e,t,n={},r,i,l){let a;const o=Zp({actions:{}},n),f={deep:!0};let m,_,w=[],M=[],C;const R=r.state.value[e];!l&&!R&&(r.state.value[e]={}),Rn({});let z;function W(ue){let _e;m=_=!1,typeof ue=="function"?(ue(r.state.value[e]),_e={type:Hv.patchFunction,storeId:e,events:C}):(U4(r.state.value[e],ue),_e={type:Hv.patchObject,payload:ue,storeId:e,events:C});const We=z=Symbol();Sh().then(()=>{z===We&&(m=!0)}),_=!0,l0(w,_e,r.state.value[e])}const X=l?function(){const{state:_e}=n,We=_e?_e():{};this.$patch(he=>{Zp(he,We)})}:bA;function Y(){a.stop(),w=[],M=[],r._s.delete(e)}const Q=(ue,_e="")=>{if(sL in ue)return ue[L5]=_e,ue;const We=function(){A2(r);const he=Array.from(arguments),de=[],Te=[];function be(Se){de.push(Se)}function ae(Se){Te.push(Se)}l0(M,{args:he,name:We[L5],store:le,after:be,onError:ae});let ne;try{ne=ue.apply(this&&this.$id===e?this:le,he)}catch(Se){throw l0(Te,Se),Se}return ne instanceof Promise?ne.then(Se=>(l0(de,Se),Se)).catch(Se=>(l0(Te,Se),Promise.reject(Se))):(l0(de,ne),ne)};return We[sL]=!0,We[L5]=_e,We},oe={_p:r,$id:e,$onAction:iL.bind(null,M),$patch:W,$reset:X,$subscribe(ue,_e={}){const We=iL(w,ue,_e.detached,()=>he()),he=a.run(()=>mo(()=>r.state.value[e],de=>{(_e.flush==="sync"?_:m)&&ue({storeId:e,type:Hv.direct,events:C},de)},Zp({},f,_e)));return We},$dispose:Y},le=bd(oe);r._s.set(e,le);const we=(r._a&&r._a.runWithContext||YB)(()=>r._e.run(()=>(a=q3()).run(()=>t({action:Q}))));for(const ue in we){const _e=we[ue];if(Ol(_e)&&!QB(_e)||Of(_e))l||(R&&JB(_e)&&(Ol(_e)?_e.value=R[ue]:U4(_e,R[ue])),r.state.value[e][ue]=_e);else if(typeof _e=="function"){const We=Q(_e,ue);we[ue]=We,o.actions[ue]=_e}}return Zp(le,we),Zp(eo(le),we),Object.defineProperty(le,"$state",{get:()=>r.state.value[e],set:ue=>{W(_e=>{Zp(_e,ue)})}}),r._p.forEach(ue=>{Zp(le,a.run(()=>ue({store:le,app:r._a,pinia:r,options:o})))}),R&&l&&n.hydrate&&n.hydrate(le.$state,R),m=!0,_=!0,le}/*! #__NO_SIDE_EFFECTS__ */function ty(e,t,n){let r,i;const l=typeof t=="function";typeof e=="string"?(r=e,i=l?n:t):(i=e,r=e.id);function a(o,f){const m=yT();return o=o||(m?yd(_A,null):null),o&&A2(o),o=vA,o._s.has(r)||(l?xA(r,t,i,o):e8(r,i,o)),o._s.get(r)}return a.$id=r,a}function wA(e,t){return function(){return e.apply(t,arguments)}}const{toString:t8}=Object.prototype,{getPrototypeOf:yC}=Object,k2=(e=>t=>{const n=t8.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),hf=e=>(e=e.toLowerCase(),t=>k2(t)===e),I2=e=>t=>typeof t===e,{isArray:ny}=Array,y_=I2("undefined");function n8(e){return e!==null&&!y_(e)&&e.constructor!==null&&!y_(e.constructor)&&_d(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const CA=hf("ArrayBuffer");function r8(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&CA(e.buffer),t}const i8=I2("string"),_d=I2("function"),SA=I2("number"),D2=e=>e!==null&&typeof e=="object",s8=e=>e===!0||e===!1,ex=e=>{if(k2(e)!=="object")return!1;const t=yC(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},o8=hf("Date"),a8=hf("File"),l8=hf("Blob"),u8=hf("FileList"),c8=e=>D2(e)&&_d(e.pipe),h8=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||_d(e.append)&&((t=k2(e))==="formdata"||t==="object"&&_d(e.toString)&&e.toString()==="[object FormData]"))},d8=hf("URLSearchParams"),[f8,p8,m8,g8]=["ReadableStream","Request","Response","Headers"].map(hf),y8=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function F_(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,i;if(typeof e!="object"&&(e=[e]),ny(e))for(r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else{const l=n?Object.getOwnPropertyNames(e):Object.keys(e),a=l.length;let o;for(r=0;r<a;r++)o=l[r],t.call(null,e[o],o,e)}}function LA(e,t){t=t.toLowerCase();const n=Object.keys(e);let r=n.length,i;for(;r-- >0;)if(i=n[r],t===i.toLowerCase())return i;return null}const ug=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,PA=e=>!y_(e)&&e!==ug;function V4(){const{caseless:e}=PA(this)&&this||{},t={},n=(r,i)=>{const l=e&&LA(t,i)||i;ex(t[l])&&ex(r)?t[l]=V4(t[l],r):ex(r)?t[l]=V4({},r):ny(r)?t[l]=r.slice():t[l]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&F_(arguments[r],n);return t}const v8=(e,t,n,{allOwnKeys:r}={})=>(F_(t,(i,l)=>{n&&_d(i)?e[l]=wA(i,n):e[l]=i},{allOwnKeys:r}),e),_8=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),b8=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},x8=(e,t,n,r)=>{let i,l,a;const o={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),l=i.length;l-- >0;)a=i[l],(!r||r(a,e,t))&&!o[a]&&(t[a]=e[a],o[a]=!0);e=n!==!1&&yC(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},w8=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},C8=e=>{if(!e)return null;if(ny(e))return e;let t=e.length;if(!SA(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},S8=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&yC(Uint8Array)),L8=(e,t)=>{const r=(e&&e[Symbol.iterator]).call(e);let i;for(;(i=r.next())&&!i.done;){const l=i.value;t.call(e,l[0],l[1])}},P8=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},E8=hf("HTMLFormElement"),M8=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),oL=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),T8=hf("RegExp"),EA=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};F_(n,(i,l)=>{let a;(a=t(i,l,e))!==!1&&(r[l]=a||i)}),Object.defineProperties(e,r)},A8=e=>{EA(e,(t,n)=>{if(_d(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(_d(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},k8=(e,t)=>{const n={},r=i=>{i.forEach(l=>{n[l]=!0})};return ny(e)?r(e):r(String(e).split(t)),n},I8=()=>{},D8=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function O8(e){return!!(e&&_d(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const R8=e=>{const t=new Array(10),n=(r,i)=>{if(D2(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[i]=r;const l=ny(r)?[]:{};return F_(r,(a,o)=>{const f=n(a,i+1);!y_(f)&&(l[o]=f)}),t[i]=void 0,l}}return r};return n(e,0)},B8=hf("AsyncFunction"),N8=e=>e&&(D2(e)||_d(e))&&_d(e.then)&&_d(e.catch),MA=((e,t)=>e?setImmediate:t?((n,r)=>(ug.addEventListener("message",({source:i,data:l})=>{i===ug&&l===n&&r.length&&r.shift()()},!1),i=>{r.push(i),ug.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",_d(ug.postMessage)),F8=typeof queueMicrotask<"u"?queueMicrotask.bind(ug):typeof process<"u"&&process.nextTick||MA,dr={isArray:ny,isArrayBuffer:CA,isBuffer:n8,isFormData:h8,isArrayBufferView:r8,isString:i8,isNumber:SA,isBoolean:s8,isObject:D2,isPlainObject:ex,isReadableStream:f8,isRequest:p8,isResponse:m8,isHeaders:g8,isUndefined:y_,isDate:o8,isFile:a8,isBlob:l8,isRegExp:T8,isFunction:_d,isStream:c8,isURLSearchParams:d8,isTypedArray:S8,isFileList:u8,forEach:F_,merge:V4,extend:v8,trim:y8,stripBOM:_8,inherits:b8,toFlatObject:x8,kindOf:k2,kindOfTest:hf,endsWith:w8,toArray:C8,forEachEntry:L8,matchAll:P8,isHTMLForm:E8,hasOwnProperty:oL,hasOwnProp:oL,reduceDescriptors:EA,freezeMethods:A8,toObjectSet:k8,toCamelCase:M8,noop:I8,toFiniteNumber:D8,findKey:LA,global:ug,isContextDefined:PA,isSpecCompliantForm:O8,toJSONObject:R8,isAsyncFn:B8,isThenable:N8,setImmediate:MA,asap:F8};function Ps(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}dr.inherits(Ps,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:dr.toJSONObject(this.config),code:this.code,status:this.status}}});const TA=Ps.prototype,AA={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{AA[e]={value:e}});Object.defineProperties(Ps,AA);Object.defineProperty(TA,"isAxiosError",{value:!0});Ps.from=(e,t,n,r,i,l)=>{const a=Object.create(TA);return dr.toFlatObject(e,a,function(f){return f!==Error.prototype},o=>o!=="isAxiosError"),Ps.call(a,e.message,t,n,r,i),a.cause=e,a.name=e.name,l&&Object.assign(a,l),a};const z8=null;function $4(e){return dr.isPlainObject(e)||dr.isArray(e)}function kA(e){return dr.endsWith(e,"[]")?e.slice(0,-2):e}function aL(e,t,n){return e?e.concat(t).map(function(i,l){return i=kA(i),!n&&l?"["+i+"]":i}).join(n?".":""):t}function j8(e){return dr.isArray(e)&&!e.some($4)}const U8=dr.toFlatObject(dr,{},null,function(t){return/^is[A-Z]/.test(t)});function O2(e,t,n){if(!dr.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=dr.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(z,W){return!dr.isUndefined(W[z])});const r=n.metaTokens,i=n.visitor||_,l=n.dots,a=n.indexes,f=(n.Blob||typeof Blob<"u"&&Blob)&&dr.isSpecCompliantForm(t);if(!dr.isFunction(i))throw new TypeError("visitor must be a function");function m(R){if(R===null)return"";if(dr.isDate(R))return R.toISOString();if(!f&&dr.isBlob(R))throw new Ps("Blob is not supported. Use a Buffer instead.");return dr.isArrayBuffer(R)||dr.isTypedArray(R)?f&&typeof Blob=="function"?new Blob([R]):Buffer.from(R):R}function _(R,z,W){let X=R;if(R&&!W&&typeof R=="object"){if(dr.endsWith(z,"{}"))z=r?z:z.slice(0,-2),R=JSON.stringify(R);else if(dr.isArray(R)&&j8(R)||(dr.isFileList(R)||dr.endsWith(z,"[]"))&&(X=dr.toArray(R)))return z=kA(z),X.forEach(function(Q,oe){!(dr.isUndefined(Q)||Q===null)&&t.append(a===!0?aL([z],oe,l):a===null?z:z+"[]",m(Q))}),!1}return $4(R)?!0:(t.append(aL(W,z,l),m(R)),!1)}const w=[],M=Object.assign(U8,{defaultVisitor:_,convertValue:m,isVisitable:$4});function C(R,z){if(!dr.isUndefined(R)){if(w.indexOf(R)!==-1)throw Error("Circular reference detected in "+z.join("."));w.push(R),dr.forEach(R,function(X,Y){(!(dr.isUndefined(X)||X===null)&&i.call(t,X,dr.isString(Y)?Y.trim():Y,z,M))===!0&&C(X,z?z.concat(Y):[Y])}),w.pop()}}if(!dr.isObject(e))throw new TypeError("data must be an object");return C(e),t}function lL(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function vC(e,t){this._pairs=[],e&&O2(e,this,t)}const IA=vC.prototype;IA.append=function(t,n){this._pairs.push([t,n])};IA.toString=function(t){const n=t?function(r){return t.call(this,r,lL)}:lL;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function V8(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function DA(e,t,n){if(!t)return e;const r=n&&n.encode||V8;dr.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let l;if(i?l=i(t,n):l=dr.isURLSearchParams(t)?t.toString():new vC(t,n).toString(r),l){const a=e.indexOf("#");a!==-1&&(e=e.slice(0,a)),e+=(e.indexOf("?")===-1?"?":"&")+l}return e}class uL{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){dr.forEach(this.handlers,function(r){r!==null&&t(r)})}}const OA={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},$8=typeof URLSearchParams<"u"?URLSearchParams:vC,G8=typeof FormData<"u"?FormData:null,H8=typeof Blob<"u"?Blob:null,q8={isBrowser:!0,classes:{URLSearchParams:$8,FormData:G8,Blob:H8},protocols:["http","https","file","blob","url","data"]},_C=typeof window<"u"&&typeof document<"u",G4=typeof navigator=="object"&&navigator||void 0,W8=_C&&(!G4||["ReactNative","NativeScript","NS"].indexOf(G4.product)<0),Z8=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",K8=_C&&window.location.href||"http://localhost",Y8=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:_C,hasStandardBrowserEnv:W8,hasStandardBrowserWebWorkerEnv:Z8,navigator:G4,origin:K8},Symbol.toStringTag,{value:"Module"})),eh={...Y8,...q8};function X8(e,t){return O2(e,new eh.classes.URLSearchParams,Object.assign({visitor:function(n,r,i,l){return eh.isNode&&dr.isBuffer(n)?(this.append(r,n.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)}},t))}function J8(e){return dr.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Q8(e){const t={},n=Object.keys(e);let r;const i=n.length;let l;for(r=0;r<i;r++)l=n[r],t[l]=e[l];return t}function RA(e){function t(n,r,i,l){let a=n[l++];if(a==="__proto__")return!0;const o=Number.isFinite(+a),f=l>=n.length;return a=!a&&dr.isArray(i)?i.length:a,f?(dr.hasOwnProp(i,a)?i[a]=[i[a],r]:i[a]=r,!o):((!i[a]||!dr.isObject(i[a]))&&(i[a]=[]),t(n,r,i[a],l)&&dr.isArray(i[a])&&(i[a]=Q8(i[a])),!o)}if(dr.isFormData(e)&&dr.isFunction(e.entries)){const n={};return dr.forEachEntry(e,(r,i)=>{t(J8(r),i,n,0)}),n}return null}function eN(e,t,n){if(dr.isString(e))try{return(t||JSON.parse)(e),dr.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const z_={transitional:OA,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,l=dr.isObject(t);if(l&&dr.isHTMLForm(t)&&(t=new FormData(t)),dr.isFormData(t))return i?JSON.stringify(RA(t)):t;if(dr.isArrayBuffer(t)||dr.isBuffer(t)||dr.isStream(t)||dr.isFile(t)||dr.isBlob(t)||dr.isReadableStream(t))return t;if(dr.isArrayBufferView(t))return t.buffer;if(dr.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(l){if(r.indexOf("application/x-www-form-urlencoded")>-1)return X8(t,this.formSerializer).toString();if((o=dr.isFileList(t))||r.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return O2(o?{"files[]":t}:t,f&&new f,this.formSerializer)}}return l||i?(n.setContentType("application/json",!1),eN(t)):t}],transformResponse:[function(t){const n=this.transitional||z_.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(dr.isResponse(t)||dr.isReadableStream(t))return t;if(t&&dr.isString(t)&&(r&&!this.responseType||i)){const a=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(o){if(a)throw o.name==="SyntaxError"?Ps.from(o,Ps.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:eh.classes.FormData,Blob:eh.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};dr.forEach(["delete","get","head","post","put","patch"],e=>{z_.headers[e]={}});const tN=dr.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),nN=e=>{const t={};let n,r,i;return e&&e.split(`
`).forEach(function(a){i=a.indexOf(":"),n=a.substring(0,i).trim().toLowerCase(),r=a.substring(i+1).trim(),!(!n||t[n]&&tN[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},cL=Symbol("internals");function iv(e){return e&&String(e).trim().toLowerCase()}function tx(e){return e===!1||e==null?e:dr.isArray(e)?e.map(tx):String(e)}function rN(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const iN=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function P5(e,t,n,r,i){if(dr.isFunction(r))return r.call(this,t,n);if(i&&(t=n),!!dr.isString(t)){if(dr.isString(r))return t.indexOf(r)!==-1;if(dr.isRegExp(r))return r.test(t)}}function sN(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function oN(e,t){const n=dr.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(i,l,a){return this[r].call(this,t,i,l,a)},configurable:!0})})}let Kh=class{constructor(t){t&&this.set(t)}set(t,n,r){const i=this;function l(o,f,m){const _=iv(f);if(!_)throw new Error("header name must be a non-empty string");const w=dr.findKey(i,_);(!w||i[w]===void 0||m===!0||m===void 0&&i[w]!==!1)&&(i[w||f]=tx(o))}const a=(o,f)=>dr.forEach(o,(m,_)=>l(m,_,f));if(dr.isPlainObject(t)||t instanceof this.constructor)a(t,n);else if(dr.isString(t)&&(t=t.trim())&&!iN(t))a(nN(t),n);else if(dr.isHeaders(t))for(const[o,f]of t.entries())l(f,o,r);else t!=null&&l(n,t,r);return this}get(t,n){if(t=iv(t),t){const r=dr.findKey(this,t);if(r){const i=this[r];if(!n)return i;if(n===!0)return rN(i);if(dr.isFunction(n))return n.call(this,i,r);if(dr.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=iv(t),t){const r=dr.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||P5(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let i=!1;function l(a){if(a=iv(a),a){const o=dr.findKey(r,a);o&&(!n||P5(r,r[o],o,n))&&(delete r[o],i=!0)}}return dr.isArray(t)?t.forEach(l):l(t),i}clear(t){const n=Object.keys(this);let r=n.length,i=!1;for(;r--;){const l=n[r];(!t||P5(this,this[l],l,t,!0))&&(delete this[l],i=!0)}return i}normalize(t){const n=this,r={};return dr.forEach(this,(i,l)=>{const a=dr.findKey(r,l);if(a){n[a]=tx(i),delete n[l];return}const o=t?sN(l):String(l).trim();o!==l&&delete n[l],n[o]=tx(i),r[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return dr.forEach(this,(r,i)=>{r!=null&&r!==!1&&(n[i]=t&&dr.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(i=>r.set(i)),r}static accessor(t){const r=(this[cL]=this[cL]={accessors:{}}).accessors,i=this.prototype;function l(a){const o=iv(a);r[o]||(oN(i,a),r[o]=!0)}return dr.isArray(t)?t.forEach(l):l(t),this}};Kh.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);dr.reduceDescriptors(Kh.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});dr.freezeMethods(Kh);function E5(e,t){const n=this||z_,r=t||n,i=Kh.from(r.headers);let l=r.data;return dr.forEach(e,function(o){l=o.call(n,l,i.normalize(),t?t.status:void 0)}),i.normalize(),l}function BA(e){return!!(e&&e.__CANCEL__)}function ry(e,t,n){Ps.call(this,e??"canceled",Ps.ERR_CANCELED,t,n),this.name="CanceledError"}dr.inherits(ry,Ps,{__CANCEL__:!0});function NA(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new Ps("Request failed with status code "+n.status,[Ps.ERR_BAD_REQUEST,Ps.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function aN(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function lN(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i=0,l=0,a;return t=t!==void 0?t:1e3,function(f){const m=Date.now(),_=r[l];a||(a=m),n[i]=f,r[i]=m;let w=l,M=0;for(;w!==i;)M+=n[w++],w=w%e;if(i=(i+1)%e,i===l&&(l=(l+1)%e),m-a<t)return;const C=_&&m-_;return C?Math.round(M*1e3/C):void 0}}function uN(e,t){let n=0,r=1e3/t,i,l;const a=(m,_=Date.now())=>{n=_,i=null,l&&(clearTimeout(l),l=null),e.apply(null,m)};return[(...m)=>{const _=Date.now(),w=_-n;w>=r?a(m,_):(i=m,l||(l=setTimeout(()=>{l=null,a(i)},r-w)))},()=>i&&a(i)]}const zx=(e,t,n=3)=>{let r=0;const i=lN(50,250);return uN(l=>{const a=l.loaded,o=l.lengthComputable?l.total:void 0,f=a-r,m=i(f),_=a<=o;r=a;const w={loaded:a,total:o,progress:o?a/o:void 0,bytes:f,rate:m||void 0,estimated:m&&o&&_?(o-a)/m:void 0,event:l,lengthComputable:o!=null,[t?"download":"upload"]:!0};e(w)},n)},hL=(e,t)=>{const n=e!=null;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},dL=e=>(...t)=>dr.asap(()=>e(...t)),cN=eh.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,eh.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(eh.origin),eh.navigator&&/(msie|trident)/i.test(eh.navigator.userAgent)):()=>!0,hN=eh.hasStandardBrowserEnv?{write(e,t,n,r,i,l){const a=[e+"="+encodeURIComponent(t)];dr.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),dr.isString(r)&&a.push("path="+r),dr.isString(i)&&a.push("domain="+i),l===!0&&a.push("secure"),document.cookie=a.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function dN(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function fN(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function FA(e,t,n){let r=!dN(t);return e&&(r||n==!1)?fN(e,t):t}const fL=e=>e instanceof Kh?{...e}:e;function Cg(e,t){t=t||{};const n={};function r(m,_,w,M){return dr.isPlainObject(m)&&dr.isPlainObject(_)?dr.merge.call({caseless:M},m,_):dr.isPlainObject(_)?dr.merge({},_):dr.isArray(_)?_.slice():_}function i(m,_,w,M){if(dr.isUndefined(_)){if(!dr.isUndefined(m))return r(void 0,m,w,M)}else return r(m,_,w,M)}function l(m,_){if(!dr.isUndefined(_))return r(void 0,_)}function a(m,_){if(dr.isUndefined(_)){if(!dr.isUndefined(m))return r(void 0,m)}else return r(void 0,_)}function o(m,_,w){if(w in t)return r(m,_);if(w in e)return r(void 0,m)}const f={url:l,method:l,data:l,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(m,_,w)=>i(fL(m),fL(_),w,!0)};return dr.forEach(Object.keys(Object.assign({},e,t)),function(_){const w=f[_]||i,M=w(e[_],t[_],_);dr.isUndefined(M)&&w!==o||(n[_]=M)}),n}const zA=e=>{const t=Cg({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:l,headers:a,auth:o}=t;t.headers=a=Kh.from(a),t.url=DA(FA(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&a.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):"")));let f;if(dr.isFormData(n)){if(eh.hasStandardBrowserEnv||eh.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if((f=a.getContentType())!==!1){const[m,..._]=f?f.split(";").map(w=>w.trim()).filter(Boolean):[];a.setContentType([m||"multipart/form-data",..._].join("; "))}}if(eh.hasStandardBrowserEnv&&(r&&dr.isFunction(r)&&(r=r(t)),r||r!==!1&&cN(t.url))){const m=i&&l&&hN.read(l);m&&a.set(i,m)}return t},pN=typeof XMLHttpRequest<"u",mN=pN&&function(e){return new Promise(function(n,r){const i=zA(e);let l=i.data;const a=Kh.from(i.headers).normalize();let{responseType:o,onUploadProgress:f,onDownloadProgress:m}=i,_,w,M,C,R;function z(){C&&C(),R&&R(),i.cancelToken&&i.cancelToken.unsubscribe(_),i.signal&&i.signal.removeEventListener("abort",_)}let W=new XMLHttpRequest;W.open(i.method.toUpperCase(),i.url,!0),W.timeout=i.timeout;function X(){if(!W)return;const Q=Kh.from("getAllResponseHeaders"in W&&W.getAllResponseHeaders()),le={data:!o||o==="text"||o==="json"?W.responseText:W.response,status:W.status,statusText:W.statusText,headers:Q,config:e,request:W};NA(function(we){n(we),z()},function(we){r(we),z()},le),W=null}"onloadend"in W?W.onloadend=X:W.onreadystatechange=function(){!W||W.readyState!==4||W.status===0&&!(W.responseURL&&W.responseURL.indexOf("file:")===0)||setTimeout(X)},W.onabort=function(){W&&(r(new Ps("Request aborted",Ps.ECONNABORTED,e,W)),W=null)},W.onerror=function(){r(new Ps("Network Error",Ps.ERR_NETWORK,e,W)),W=null},W.ontimeout=function(){let oe=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const le=i.transitional||OA;i.timeoutErrorMessage&&(oe=i.timeoutErrorMessage),r(new Ps(oe,le.clarifyTimeoutError?Ps.ETIMEDOUT:Ps.ECONNABORTED,e,W)),W=null},l===void 0&&a.setContentType(null),"setRequestHeader"in W&&dr.forEach(a.toJSON(),function(oe,le){W.setRequestHeader(le,oe)}),dr.isUndefined(i.withCredentials)||(W.withCredentials=!!i.withCredentials),o&&o!=="json"&&(W.responseType=i.responseType),m&&([M,R]=zx(m,!0),W.addEventListener("progress",M)),f&&W.upload&&([w,C]=zx(f),W.upload.addEventListener("progress",w),W.upload.addEventListener("loadend",C)),(i.cancelToken||i.signal)&&(_=Q=>{W&&(r(!Q||Q.type?new ry(null,e,W):Q),W.abort(),W=null)},i.cancelToken&&i.cancelToken.subscribe(_),i.signal&&(i.signal.aborted?_():i.signal.addEventListener("abort",_)));const Y=aN(i.url);if(Y&&eh.protocols.indexOf(Y)===-1){r(new Ps("Unsupported protocol "+Y+":",Ps.ERR_BAD_REQUEST,e));return}W.send(l||null)})},gN=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let r=new AbortController,i;const l=function(m){if(!i){i=!0,o();const _=m instanceof Error?m:this.reason;r.abort(_ instanceof Ps?_:new ry(_ instanceof Error?_.message:_))}};let a=t&&setTimeout(()=>{a=null,l(new Ps(`timeout ${t} of ms exceeded`,Ps.ETIMEDOUT))},t);const o=()=>{e&&(a&&clearTimeout(a),a=null,e.forEach(m=>{m.unsubscribe?m.unsubscribe(l):m.removeEventListener("abort",l)}),e=null)};e.forEach(m=>m.addEventListener("abort",l));const{signal:f}=r;return f.unsubscribe=()=>dr.asap(o),f}},yN=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let r=0,i;for(;r<n;)i=r+t,yield e.slice(r,i),r=i},vN=async function*(e,t){for await(const n of _N(e))yield*yN(n,t)},_N=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:r}=await t.read();if(n)break;yield r}}finally{await t.cancel()}},pL=(e,t,n,r)=>{const i=vN(e,t);let l=0,a,o=f=>{a||(a=!0,r&&r(f))};return new ReadableStream({async pull(f){try{const{done:m,value:_}=await i.next();if(m){o(),f.close();return}let w=_.byteLength;if(n){let M=l+=w;n(M)}f.enqueue(new Uint8Array(_))}catch(m){throw o(m),m}},cancel(f){return o(f),i.return()}},{highWaterMark:2})},R2=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",jA=R2&&typeof ReadableStream=="function",bN=R2&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),UA=(e,...t)=>{try{return!!e(...t)}catch{return!1}},xN=jA&&UA(()=>{let e=!1;const t=new Request(eh.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),mL=64*1024,H4=jA&&UA(()=>dr.isReadableStream(new Response("").body)),jx={stream:H4&&(e=>e.body)};R2&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!jx[t]&&(jx[t]=dr.isFunction(e[t])?n=>n[t]():(n,r)=>{throw new Ps(`Response type '${t}' is not supported`,Ps.ERR_NOT_SUPPORT,r)})})})(new Response);const wN=async e=>{if(e==null)return 0;if(dr.isBlob(e))return e.size;if(dr.isSpecCompliantForm(e))return(await new Request(eh.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(dr.isArrayBufferView(e)||dr.isArrayBuffer(e))return e.byteLength;if(dr.isURLSearchParams(e)&&(e=e+""),dr.isString(e))return(await bN(e)).byteLength},CN=async(e,t)=>{const n=dr.toFiniteNumber(e.getContentLength());return n??wN(t)},SN=R2&&(async e=>{let{url:t,method:n,data:r,signal:i,cancelToken:l,timeout:a,onDownloadProgress:o,onUploadProgress:f,responseType:m,headers:_,withCredentials:w="same-origin",fetchOptions:M}=zA(e);m=m?(m+"").toLowerCase():"text";let C=gN([i,l&&l.toAbortSignal()],a),R;const z=C&&C.unsubscribe&&(()=>{C.unsubscribe()});let W;try{if(f&&xN&&n!=="get"&&n!=="head"&&(W=await CN(_,r))!==0){let le=new Request(t,{method:"POST",body:r,duplex:"half"}),me;if(dr.isFormData(r)&&(me=le.headers.get("content-type"))&&_.setContentType(me),le.body){const[we,ue]=hL(W,zx(dL(f)));r=pL(le.body,mL,we,ue)}}dr.isString(w)||(w=w?"include":"omit");const X="credentials"in Request.prototype;R=new Request(t,{...M,signal:C,method:n.toUpperCase(),headers:_.normalize().toJSON(),body:r,duplex:"half",credentials:X?w:void 0});let Y=await fetch(R);const Q=H4&&(m==="stream"||m==="response");if(H4&&(o||Q&&z)){const le={};["status","statusText","headers"].forEach(_e=>{le[_e]=Y[_e]});const me=dr.toFiniteNumber(Y.headers.get("content-length")),[we,ue]=o&&hL(me,zx(dL(o),!0))||[];Y=new Response(pL(Y.body,mL,we,()=>{ue&&ue(),z&&z()}),le)}m=m||"text";let oe=await jx[dr.findKey(jx,m)||"text"](Y,e);return!Q&&z&&z(),await new Promise((le,me)=>{NA(le,me,{data:oe,headers:Kh.from(Y.headers),status:Y.status,statusText:Y.statusText,config:e,request:R})})}catch(X){throw z&&z(),X&&X.name==="TypeError"&&/fetch/i.test(X.message)?Object.assign(new Ps("Network Error",Ps.ERR_NETWORK,e,R),{cause:X.cause||X}):Ps.from(X,X&&X.code,e,R)}}),q4={http:z8,xhr:mN,fetch:SN};dr.forEach(q4,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const gL=e=>`- ${e}`,LN=e=>dr.isFunction(e)||e===null||e===!1,VA={getAdapter:e=>{e=dr.isArray(e)?e:[e];const{length:t}=e;let n,r;const i={};for(let l=0;l<t;l++){n=e[l];let a;if(r=n,!LN(n)&&(r=q4[(a=String(n)).toLowerCase()],r===void 0))throw new Ps(`Unknown adapter '${a}'`);if(r)break;i[a||"#"+l]=r}if(!r){const l=Object.entries(i).map(([o,f])=>`adapter ${o} `+(f===!1?"is not supported by the environment":"is not available in the build"));let a=t?l.length>1?`since :
`+l.map(gL).join(`
`):" "+gL(l[0]):"as no adapter specified";throw new Ps("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return r},adapters:q4};function M5(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ry(null,e)}function yL(e){return M5(e),e.headers=Kh.from(e.headers),e.data=E5.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),VA.getAdapter(e.adapter||z_.adapter)(e).then(function(r){return M5(e),r.data=E5.call(e,e.transformResponse,r),r.headers=Kh.from(r.headers),r},function(r){return BA(r)||(M5(e),r&&r.response&&(r.response.data=E5.call(e,e.transformResponse,r.response),r.response.headers=Kh.from(r.response.headers))),Promise.reject(r)})}const $A="1.8.4",B2={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{B2[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const vL={};B2.transitional=function(t,n,r){function i(l,a){return"[Axios v"+$A+"] Transitional option '"+l+"'"+a+(r?". "+r:"")}return(l,a,o)=>{if(t===!1)throw new Ps(i(a," has been removed"+(n?" in "+n:"")),Ps.ERR_DEPRECATED);return n&&!vL[a]&&(vL[a]=!0,console.warn(i(a," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(l,a,o):!0}};B2.spelling=function(t){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function PN(e,t,n){if(typeof e!="object")throw new Ps("options must be an object",Ps.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const l=r[i],a=t[l];if(a){const o=e[l],f=o===void 0||a(o,l,e);if(f!==!0)throw new Ps("option "+l+" must be "+f,Ps.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Ps("Unknown option "+l,Ps.ERR_BAD_OPTION)}}const nx={assertOptions:PN,validators:B2},wf=nx.validators;let mg=class{constructor(t){this.defaults=t,this.interceptors={request:new uL,response:new uL}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const l=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?l&&!String(r.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+l):r.stack=l}catch{}}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=Cg(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:l}=n;r!==void 0&&nx.assertOptions(r,{silentJSONParsing:wf.transitional(wf.boolean),forcedJSONParsing:wf.transitional(wf.boolean),clarifyTimeoutError:wf.transitional(wf.boolean)},!1),i!=null&&(dr.isFunction(i)?n.paramsSerializer={serialize:i}:nx.assertOptions(i,{encode:wf.function,serialize:wf.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),nx.assertOptions(n,{baseUrl:wf.spelling("baseURL"),withXsrfToken:wf.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let a=l&&dr.merge(l.common,l[n.method]);l&&dr.forEach(["delete","get","head","post","put","patch","common"],R=>{delete l[R]}),n.headers=Kh.concat(a,l);const o=[];let f=!0;this.interceptors.request.forEach(function(z){typeof z.runWhen=="function"&&z.runWhen(n)===!1||(f=f&&z.synchronous,o.unshift(z.fulfilled,z.rejected))});const m=[];this.interceptors.response.forEach(function(z){m.push(z.fulfilled,z.rejected)});let _,w=0,M;if(!f){const R=[yL.bind(this),void 0];for(R.unshift.apply(R,o),R.push.apply(R,m),M=R.length,_=Promise.resolve(n);w<M;)_=_.then(R[w++],R[w++]);return _}M=o.length;let C=n;for(w=0;w<M;){const R=o[w++],z=o[w++];try{C=R(C)}catch(W){z.call(this,W);break}}try{_=yL.call(this,C)}catch(R){return Promise.reject(R)}for(w=0,M=m.length;w<M;)_=_.then(m[w++],m[w++]);return _}getUri(t){t=Cg(this.defaults,t);const n=FA(t.baseURL,t.url,t.allowAbsoluteUrls);return DA(n,t.params,t.paramsSerializer)}};dr.forEach(["delete","get","head","options"],function(t){mg.prototype[t]=function(n,r){return this.request(Cg(r||{},{method:t,url:n,data:(r||{}).data}))}});dr.forEach(["post","put","patch"],function(t){function n(r){return function(l,a,o){return this.request(Cg(o||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:l,data:a}))}}mg.prototype[t]=n(),mg.prototype[t+"Form"]=n(!0)});let EN=class GA{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(l){n=l});const r=this;this.promise.then(i=>{if(!r._listeners)return;let l=r._listeners.length;for(;l-- >0;)r._listeners[l](i);r._listeners=null}),this.promise.then=i=>{let l;const a=new Promise(o=>{r.subscribe(o),l=o}).then(i);return a.cancel=function(){r.unsubscribe(l)},a},t(function(l,a,o){r.reason||(r.reason=new ry(l,a,o),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=r=>{t.abort(r)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new GA(function(i){t=i}),cancel:t}}};function MN(e){return function(n){return e.apply(null,n)}}function TN(e){return dr.isObject(e)&&e.isAxiosError===!0}const W4={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(W4).forEach(([e,t])=>{W4[t]=e});function HA(e){const t=new mg(e),n=wA(mg.prototype.request,t);return dr.extend(n,mg.prototype,t,{allOwnKeys:!0}),dr.extend(n,t,null,{allOwnKeys:!0}),n.create=function(i){return HA(Cg(e,i))},n}const Tu=HA(z_);Tu.Axios=mg;Tu.CanceledError=ry;Tu.CancelToken=EN;Tu.isCancel=BA;Tu.VERSION=$A;Tu.toFormData=O2;Tu.AxiosError=Ps;Tu.Cancel=Tu.CanceledError;Tu.all=function(t){return Promise.all(t)};Tu.spread=MN;Tu.isAxiosError=TN;Tu.mergeConfig=Cg;Tu.AxiosHeaders=Kh;Tu.formToJSON=e=>RA(dr.isHTMLForm(e)?new FormData(e):e);Tu.getAdapter=VA.getAdapter;Tu.HttpStatusCode=W4;Tu.default=Tu;const{Axios:coe,AxiosError:hoe,CanceledError:doe,isCancel:foe,CancelToken:poe,VERSION:moe,all:goe,Cancel:yoe,isAxiosError:voe,spread:_oe,toFormData:boe,AxiosHeaders:xoe,HttpStatusCode:woe,formToJSON:Coe,getAdapter:Soe,mergeConfig:Loe}=Tu,Kr=Tu.create({baseURL:"/api",headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0});function qA(e){var r;const n=`; ${document.cookie}`.split(`; ${e}=`);return n.length===2&&((r=n.pop())==null?void 0:r.split(";").shift())||null}Kr.interceptors.request.use(async e=>{try{const t=qA("access_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e}catch{return e}},e=>Promise.reject(e));Kr.interceptors.response.use(e=>e,async e=>{var n,r;const t=e.config;try{if(((n=e.response)==null?void 0:n.status)===401&&!t._retry&&!((r=t.url)!=null&&r.includes("/token/refresh/"))){t._retry=!0;const i=Mu();try{await i.refreshToken();const l=qA("access_token");if(l)return t.headers.Authorization=`Bearer ${l}`,Kr(t)}catch(l){return await i.logout(),window.location.pathname!=="/login"&&(window.location.href="/login"),Promise.reject(l)}}return Promise.reject(e)}catch(i){return Promise.reject(i)}});function AN(e){var n;const t=[];if((n=e.response)!=null&&n.data){const r=e.response.data;typeof r=="object"&&!Array.isArray(r)?Object.entries(r).forEach(([i,l])=>{Array.isArray(l)?l.forEach(a=>{t.push({field:i,message:a})}):typeof l=="string"&&t.push({field:i,message:l})}):typeof r=="string"?t.push({field:"non_field_error",message:r}):r.detail&&t.push({field:"non_field_error",message:r.detail})}else e.message&&t.push({field:"non_field_error",message:`Erreur de connexion: ${e.message}`});return t.length===0&&t.push({field:"non_field_error",message:"Une erreur inconnue s'est produite"}),t}async function T5(e){const t={role:e.role};e.entrepriseId&&(t.entreprise=e.entrepriseId),e.salarieId&&(t.salarie=e.salarieId),e.includeDetails&&(t.include_plans=!0),e.search&&(t.search=e.search);try{return(await Bc.getUsers(t)).data}catch(n){throw n}}const Bc={async getUsers(e={}){try{return await Kr.get("/users/",{params:e})}catch(t){throw t}},async getUser(e){return await Kr.get(`/users/${e}/`)},async createUser(e){return await Kr.post("/users/",e)},async updateUser(e,t){return await Kr.patch(`/users/${e}/`,t)},async deleteUser(e){return await Kr.delete(`/users/${e}/`)},async getEntreprises(){return await Kr.get("/users/",{params:{role:"ENTREPRISE"}})},async getSalaries(e){const t={role:"SALARIE"};return e&&(t.entreprise=e),await Kr.get("/users/",{params:t})},async getSalarieVisiteurs(e){return await Kr.get("/users/",{params:{role:"VISITEUR",salarie:e}})},async getEntrepriseVisiteurs(e){return await Kr.get("/users/",{params:{role:"VISITEUR",entreprise:e}})},async getUsersByHierarchy(e){const t={role:e.role};return e.entrepriseId&&(t.entreprise=e.entrepriseId),e.salarieId&&(t.salarie=e.salarieId),e.includeDetails&&(t.include_plans=!0),e.search&&(t.search=e.search),await Kr.get("/users/",{params:t})},async getEntrepriseSalaries(e){return await Kr.get("/users/",{params:{role:"SALARIE",entreprise:e}})},async getVisiteurs(e,t){const n={role:"VISITEUR"};return e&&(n.salarie=e),t&&(n.entreprise=t),await Kr.get("/users/",{params:n})},async assignEntrepriseToSalarie(e,t){return await Kr.patch(`/users/${e}/`,{entreprise:t})},async assignSalarieToVisiteur(e,t){return await Kr.patch(`/users/${e}/`,{salarie:t})},formatLogoFileName(e){var i;const t=new Date().getTime(),n=((i=e.name.split(".").pop())==null?void 0:i.toLowerCase())||"";return`${e.name.split(".")[0].toLowerCase().replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}-${t}.${n}`},async uploadLogo(e){try{const t=new FormData,n=this.formatLogoFileName(e),r=new File([e],n,{type:e.type});return t.append("logo",r),await Kr.post("/users/upload_logo/",t,{headers:{"Content-Type":"multipart/form-data"}})}catch(t){throw t}}};async function A5(e,t=3,n=1e3,r=1e4){let i=0;for(;;)try{return await e()}catch(l){if(i++,i>=t)throw l;const a=Math.min(n*Math.pow(2,i-1),r),o=Math.random()*200;await new Promise(f=>setTimeout(f,a+o))}}const vb={async getPlans(){try{return await Kr.get("/plans/")}catch(e){throw e}},async createPlan(e){try{const t={...e,entreprise:e.entreprise?typeof e.entreprise=="object"&&"id"in e.entreprise?e.entreprise.id:Number(e.entreprise):null,salarie:e.salarie?typeof e.salarie=="object"&&"id"in e.salarie?e.salarie.id:Number(e.salarie):null,visiteur:e.visiteur?typeof e.visiteur=="object"&&"id"in e.visiteur?e.visiteur.id:Number(e.visiteur):null};return await Kr.post("/plans/",t)}catch(t){throw t}},async updatePlan(e,t){try{return await Kr.put(`/plans/${e}/`,t)}catch(n){throw n}},async deletePlan(e){try{return await Kr.delete(`/plans/${e}/`)}catch(t){throw t}},async getVisiteurPlans(e){return await Kr.get("/plans/",{params:{visiteur:e}})},async createPlanForVisiteur(e){return await Kr.post("/plans/",e)},async getEntreprisePlans(e){return await Kr.get("/plans/",{params:{entreprise:e}})},async getSalariePlans(e){return await Kr.get("/plans/",{params:{salarie:e}})},async createPlanForSalarie(e,t){const n={...e,salarie:t};return await Kr.post("/plans/",n)},async createPlanForEntreprise(e,t){const n={...e,entreprise:t};return await Kr.post("/plans/",n)}},_c={async getNotes(e={}){try{return await Kr.get("/notes/",{params:e})}catch(t){throw console.error("Error getting notes:",t),t}},async getNotesByPlan(e){try{return await Kr.get("/notes/",{params:{plan:e}})}catch(t){throw console.error("Error getting notes for plan:",t),t}},async getNote(e){try{return await Kr.get(`/notes/${e}/`)}catch(t){throw console.error("Error getting note:",t),t}},async createNote(e){try{const t={...e};return t.location&&Object.keys(t.location).length===0&&delete t.location,await Kr.post("/notes/",t)}catch(t){throw console.error("Error creating note:",t),t}},async updateNote(e,t){try{const n=t.backendId||e,r={...t};r.location&&Object.keys(r.location).length===0&&delete r.location,t.column!==void 0?r.column=t.column:t.columnId!==void 0&&(r.column=t.columnId),delete r.columnId,delete r.column_id,delete r.column_details,delete r.backendId,delete r.leafletId;const i=r.enterprise_id;delete r.enterprise_name;const l=await Kr.patch(`/notes/${n}/`,r);return i!==void 0&&(l.data.enterprise_id=i),l}catch(n){throw console.error("[noteService][updateNote] Erreur lors de la mise à jour:",n),n}},async deleteNote(e){try{return await Kr.delete(`/notes/${e}/`)}catch(t){throw console.error("Error deleting note:",t),t}},async getComments(e){return await Kr.get(`/notes/${e}/comments/`)},async addComment(e,t){const n=typeof t=="string"?{text:t}:t;return await Kr.post(`/notes/${e}/comments/`,n)},async updateComment(e,t,n){return await Kr.patch(`/notes/${e}/comments/${t}/`,n)},async deleteComment(e,t){return await Kr.delete(`/notes/${e}/comments/${t}/`)},async getPhotos(e){return await Kr.get(`/notes/${e}/photos/`)},async addPhoto(e,t){return await Kr.post(`/notes/${e}/photos/`,t,{headers:{"Content-Type":"multipart/form-data"}})},async updatePhoto(e,t,n){return await Kr.patch(`/notes/${e}/photos/${t}/`,n)},async deletePhoto(e,t){return await Kr.delete(`/notes/${e}/photos/${t}/`)}},k5={async getDevices(e={}){try{return await A5(()=>Kr.get("/weather/devices/",{params:e}),3,1e3,1e4)}catch(t){throw console.error("Error getting weather devices:",t),t}},async getRealTimeData(e){try{const t=typeof e=="string"?{mac:e}:e;return await A5(()=>Kr.get("/weather/",{params:t}),3,1e3,1e4)}catch(t){throw console.error("Error getting real-time weather data:",t),t}},async getHistoryData(e){try{return await A5(()=>Kr.get("/weather/history/",{params:e}),3,1e3,1e4)}catch(t){throw console.error("Error getting weather history data:",t),t}}},_b={async getFilters(){try{return await Kr.get("/map-filters/")}catch(e){throw console.error("Error getting map filters:",e),e}},async getFilter(e){try{return await Kr.get(`/map-filters/${e}/`)}catch(t){throw console.error("Error getting map filter:",t),t}},async createFilter(e){try{return await Kr.post("/map-filters/",e)}catch(t){throw console.error("Error creating map filter:",t),t}},async updateFilter(e,t){try{return await Kr.patch(`/map-filters/${e}/`,t)}catch(n){throw console.error("Error updating map filter:",n),n}},async deleteFilter(e){try{return await Kr.delete(`/map-filters/${e}/`)}catch(t){throw console.error("Error deleting map filter:",t),t}}},Ux={async getGoogleMapsApiKey(){try{return await Kr.get("/settings/get_google_maps_api_key/")}catch(e){throw console.error("Error getting Google Maps API key:",e),e}},async setGoogleMapsApiKey(e){try{return await Kr.post("/settings/set_google_maps_api_key/",{key:e})}catch(t){throw console.error("Error setting Google Maps API key:",t),t}}};Kr.defaults.baseURL="/api";Kr.defaults.headers.common["Content-Type"]="application/json";Kr.defaults.withCredentials=!0;function v_(e){var r;const n=`; ${document.cookie}`.split(`; ${e}=`);return n.length===2&&((r=n.pop())==null?void 0:r.split(";").shift())||null}Kr.interceptors.request.use(e=>{const t=v_("access_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>(console.error("Request interceptor error:",e),Promise.reject(e)));Kr.interceptors.response.use(e=>e,async e=>{var r,i;const t=Mu(),n=e.config;if(((r=e.response)==null?void 0:r.status)===401&&!n._retry&&!((i=n.url)!=null&&i.includes("/token/refresh/"))){n._retry=!0;try{if(!v_("access_token"))throw new Error("No token available");await t.refreshToken();const a=v_("access_token");if(a)return n.headers.Authorization=`Bearer ${a}`,Kr(n)}catch(l){console.error("Token refresh failed:",l),await t.logout(),window.location.pathname!=="/login"&&(window.location.href="/login")}}return Promise.reject(e)});function kN(e,t,n=1){const r=new Date;r.setTime(r.getTime()+n*24*60*60*1e3);const i=`expires=${r.toUTCString()}`;document.cookie=`${e}=${t};${i};path=/;secure;samesite=Strict`}function kl(e){if(!e)return"-";const t=e.first_name||"",n=e.last_name?e.last_name.toUpperCase():"",r=`${t} ${n}`.trim(),i=e.company_name||e.role||"";return!r&&!i?"-":r?i?`${r} (${i})`:r:`(${i})`}function IN(e="",t=""){return`${(e==null?void 0:e.charAt(0))||""}${(t==null?void 0:t.charAt(0))||""}`.toUpperCase()}const DN={ADMIN:"Administrateur",ENTREPRISE:"Entreprise",SALARIE:"Salarie",VISITEUR:"Visiteur"};function ON(e){return DN[e]||e}function RN(){return"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800"}function BN(e){return e?"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800":"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800"}async function NN({role:e,entrepriseId:t,salarieId:n,includeDetails:r=!1}){const i={role:e};return t&&(i.entreprise=t),n&&(i.salarie=n),r&&(i.include_plans=!0),(await Bc.getUsers(i)).data}const Mu=ty("auth",{state:()=>({user:null,isAuthenticated:!1,mustChangePassword:!1,initialized:!1,loading:!1,error:null,enterprises:[],employees:[],visitors:[]}),getters:{isAdmin:e=>{var t;return((t=e.user)==null?void 0:t.user_type)==="admin"},isEntreprise:e=>{var t;return((t=e.user)==null?void 0:t.user_type)==="entreprise"},isSalarie:e=>{var t;return((t=e.user)==null?void 0:t.user_type)==="salarie"},isVisiteur:e=>{var t;return((t=e.user)==null?void 0:t.user_type)==="visiteur"},currentUser:e=>e.user,hasEnterprise:e=>{var t;return!!((t=e.user)!=null&&t.enterprise_id)},hasEmployee:e=>{var t;return!!((t=e.user)!=null&&t.employee_id)}},actions:{async initialize(e){if(!e){const n=await this.restoreSession();return this.initialized=!0,n}if(e.isAuthenticated&&e.user)return this.user=e.user,this.isAuthenticated=!0,this.mustChangePassword=e.user.must_change_password||!1,this.initialized=!0,!0;const t=await this.restoreSession();return this.initialized=!0,t},async restoreSession(){try{if(!v_("access_token"))return this.isAuthenticated=!1,this.user=null,!1;const t=await Kr.post("/token/refresh/");return t.data.user?(this.user=t.data.user,this.isAuthenticated=!0,this.mustChangePassword=t.data.user.must_change_password||!1,!0):(await this.fetchUserProfile(),!0)}catch(e){return console.error("Failed to restore session:",e),this.isAuthenticated=!1,this.user=null,!1}},async login(e,t){var n,r,i;try{const l=await Kr.post("/token/",{username:e,password:t});if(!l.data.access)throw new Error("Token d'accès non reçu");document.cookie=`access_token=${l.data.access}; path=/; secure; samesite=Strict`;const a=await this.fetchUserProfile();return this.user=a,this.isAuthenticated=!0,!0}catch(l){throw this.isAuthenticated=!1,this.user=null,((n=l.response)==null?void 0:n.status)===401?new Error("Identifiants incorrects"):(i=(r=l.response)==null?void 0:r.data)!=null&&i.detail?new Error(l.response.data.detail):l}},async logout(){this.user=null,this.isAuthenticated=!1,this.mustChangePassword=!1,document.cookie="access_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="refresh_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT"},async checkAuth(){try{return await this.fetchUserProfile(),!0}catch{return this.isAuthenticated=!1,this.user=null,!1}},async fetchUserProfile(){try{const e=await Kr.get("/users/me/");return this.user=e.data,this.isAuthenticated=!0,this.mustChangePassword=e.data.must_change_password||!1,e.data}catch(e){throw this.isAuthenticated=!1,this.user=null,e}},async changePassword(e,t){try{const n=await Kr.post("/users/change_password/",{old_password:e,password:t});return this.user={...this.user,must_change_password:!1},n.data}catch(n){throw console.error("Password change error:",n),n}},async refreshToken(){var e,t;try{if(!v_("refresh_token"))throw new Error("No refresh token available");const r=await Kr.post("/token/refresh/",{},{withCredentials:!0,_retry:!0}),{access:i}=r.data;if(!i)throw new Error("No access token received");return kN("access_token",i,1),this.isAuthenticated=!0,i}catch(n){throw console.error("Error refreshing token:",{status:(e=n.response)==null?void 0:e.status,data:(t=n.response)==null?void 0:t.data}),this.isAuthenticated=!1,document.cookie="access_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="refresh_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",n}},async fetchUsers(e={}){this.loading=!0;try{return(await Bc.getUsers(e)).data}catch(t){throw this.error="Erreur lors de la récupération des utilisateurs",t}finally{this.loading=!1}},async fetchEnterprises(){this.loading=!0;try{const e=await Bc.getUsers({role:"ENTREPRISE"});return this.enterprises=e.data,this.enterprises}catch(e){throw this.error="Erreur lors de la récupération des entreprises",e}finally{this.loading=!1}},async fetchEnterpriseEmployees(e){this.loading=!0;try{const t=await Bc.getUsers({role:"SALARIE",entreprise:e});return this.employees=t.data,this.employees}catch(t){throw this.error="Erreur lors de la récupération des salaries",t}finally{this.loading=!1}},async fetchEnterpriseVisitors(e){this.loading=!0;try{const t=await Bc.getUsers({role:"VISITEUR",entreprise:e});return this.visitors=t.data,this.visitors}catch(t){throw this.error="Erreur lors de la récupération des visiteurs",t}finally{this.loading=!1}},async createUser(e){this.loading=!0;try{return(await Bc.createUser(e)).data}catch(t){throw this.error="Erreur lors de la création de l'utilisateur",t}finally{this.loading=!1}},async updateUser(e,t){this.loading=!0;try{return(await Bc.updateUser(e,t)).data}catch(n){throw this.error="Erreur lors de la mise à jour de l'utilisateur",n}finally{this.loading=!1}},async deleteUser(e){this.loading=!0;try{return await Bc.deleteUser(e),!0}catch(t){throw this.error="Erreur lors de la suppression de l'utilisateur",t}finally{this.loading=!1}},async fetchEnterprisesLegacy(){this.loading=!0;try{const e=await Kr.get("/users/",{params:{role:"entreprise"}});this.enterprises=e.data}catch(e){throw this.error="Erreur lors de la récupération des entreprises",e}finally{this.loading=!1}},async setEnterprise(e,t){this.loading=!0;try{await Kr.patch(`/users/${e}/`,{enterprise:t}),this.user&&this.user.id===e&&(this.user.enterprise_id=t)}catch(n){throw this.error="Erreur lors de la mise à jour de l'entreprise",n}finally{this.loading=!1}},async updateUserRole(e,t){this.loading=!0;try{const n=await Kr.patch(`/users/${e}/`,{role:t});return this.user&&this.user.id===e&&(this.user.user_type=t),n.data}catch(n){throw this.error="Erreur lors de la mise à jour du rôle",n}finally{this.loading=!1}},async updateUserEmail(e){var t;this.loading=!0;try{const n=await Kr.patch(`/users/${(t=this.user)==null?void 0:t.id}/`,{email:e});return this.user&&(this.user.email=e),n.data}catch(n){throw this.error="Erreur lors de la mise à jour de l'email",n}finally{this.loading=!1}},async uploadLogo(e){this.loading=!0;try{const t=await Bc.uploadLogo(e);return this.user&&t.data.logo&&(this.user.logo=t.data.logo),t.data}catch(t){throw this.error="Erreur lors du téléversement du logo",t}finally{this.loading=!1}},checkAccess(e){return this.user?e.includes(this.user.user_type):!1},async fetchUsersByRole(e){this.loading=!0;try{return await NN(e)}catch(t){throw console.error(`Error fetching ${e.role}:`,t),t}finally{this.loading=!1}},async fetchEntrepriseSalaries(e){this.loading=!0;try{return(await Bc.getUsers({role:"SALARIE",entreprise:e})).data}catch(t){throw this.error="Erreur lors de la récupération des salaries",t}finally{this.loading=!1}},async fetchSalarieVisiteurs(e){this.loading=!0;try{return(await Bc.getUsers({role:"VISITEUR",salarie:e})).data}catch(t){throw this.error="Erreur lors de la récupération des visiteurs",t}finally{this.loading=!1}}}});/*!
  * vue-router v4.5.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const x0=typeof document<"u";function WA(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function FN(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&WA(e.default)}const Ro=Object.assign;function I5(e,t){const n={};for(const r in t){const i=t[r];n[r]=af(i)?i.map(e):e(i)}return n}const qv=()=>{},af=Array.isArray,ZA=/#/g,zN=/&/g,jN=/\//g,UN=/=/g,VN=/\?/g,KA=/\+/g,$N=/%5B/g,GN=/%5D/g,YA=/%5E/g,HN=/%60/g,XA=/%7B/g,qN=/%7C/g,JA=/%7D/g,WN=/%20/g;function bC(e){return encodeURI(""+e).replace(qN,"|").replace($N,"[").replace(GN,"]")}function ZN(e){return bC(e).replace(XA,"{").replace(JA,"}").replace(YA,"^")}function Z4(e){return bC(e).replace(KA,"%2B").replace(WN,"+").replace(ZA,"%23").replace(zN,"%26").replace(HN,"`").replace(XA,"{").replace(JA,"}").replace(YA,"^")}function KN(e){return Z4(e).replace(UN,"%3D")}function YN(e){return bC(e).replace(ZA,"%23").replace(VN,"%3F")}function XN(e){return e==null?"":YN(e).replace(jN,"%2F")}function __(e){try{return decodeURIComponent(""+e)}catch{}return""+e}const JN=/\/$/,QN=e=>e.replace(JN,"");function D5(e,t,n="/"){let r,i={},l="",a="";const o=t.indexOf("#");let f=t.indexOf("?");return o<f&&o>=0&&(f=-1),f>-1&&(r=t.slice(0,f),l=t.slice(f+1,o>-1?o:t.length),i=e(l)),o>-1&&(r=r||t.slice(0,o),a=t.slice(o,t.length)),r=rF(r??t,n),{fullPath:r+(l&&"?")+l+a,path:r,query:i,hash:__(a)}}function eF(e,t){const n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}function _L(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function tF(e,t,n){const r=t.matched.length-1,i=n.matched.length-1;return r>-1&&r===i&&G0(t.matched[r],n.matched[i])&&QA(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}function G0(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function QA(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(!nF(e[n],t[n]))return!1;return!0}function nF(e,t){return af(e)?bL(e,t):af(t)?bL(t,e):e===t}function bL(e,t){return af(t)?e.length===t.length&&e.every((n,r)=>n===t[r]):e.length===1&&e[0]===t}function rF(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),r=e.split("/"),i=r[r.length-1];(i===".."||i===".")&&r.push("");let l=n.length-1,a,o;for(a=0;a<r.length;a++)if(o=r[a],o!==".")if(o==="..")l>1&&l--;else break;return n.slice(0,l).join("/")+"/"+r.slice(a).join("/")}const $p={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var b_;(function(e){e.pop="pop",e.push="push"})(b_||(b_={}));var Wv;(function(e){e.back="back",e.forward="forward",e.unknown=""})(Wv||(Wv={}));function iF(e){if(!e)if(x0){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),QN(e)}const sF=/^[^#]+#/;function oF(e,t){return e.replace(sF,"#")+t}function aF(e,t){const n=document.documentElement.getBoundingClientRect(),r=e.getBoundingClientRect();return{behavior:t.behavior,left:r.left-n.left-(t.left||0),top:r.top-n.top-(t.top||0)}}const N2=()=>({left:window.scrollX,top:window.scrollY});function lF(e){let t;if("el"in e){const n=e.el,r=typeof n=="string"&&n.startsWith("#"),i=typeof n=="string"?r?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!i)return;t=aF(i,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function xL(e,t){return(history.state?history.state.position-t:-1)+e}const K4=new Map;function uF(e,t){K4.set(e,t)}function cF(e){const t=K4.get(e);return K4.delete(e),t}let hF=()=>location.protocol+"//"+location.host;function ek(e,t){const{pathname:n,search:r,hash:i}=t,l=e.indexOf("#");if(l>-1){let o=i.includes(e.slice(l))?e.slice(l).length:1,f=i.slice(o);return f[0]!=="/"&&(f="/"+f),_L(f,"")}return _L(n,e)+r+i}function dF(e,t,n,r){let i=[],l=[],a=null;const o=({state:M})=>{const C=ek(e,location),R=n.value,z=t.value;let W=0;if(M){if(n.value=C,t.value=M,a&&a===R){a=null;return}W=z?M.position-z.position:0}else r(C);i.forEach(X=>{X(n.value,R,{delta:W,type:b_.pop,direction:W?W>0?Wv.forward:Wv.back:Wv.unknown})})};function f(){a=n.value}function m(M){i.push(M);const C=()=>{const R=i.indexOf(M);R>-1&&i.splice(R,1)};return l.push(C),C}function _(){const{history:M}=window;M.state&&M.replaceState(Ro({},M.state,{scroll:N2()}),"")}function w(){for(const M of l)M();l=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",_)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",_,{passive:!0}),{pauseListeners:f,listen:m,destroy:w}}function wL(e,t,n,r=!1,i=!1){return{back:e,current:t,forward:n,replaced:r,position:window.history.length,scroll:i?N2():null}}function fF(e){const{history:t,location:n}=window,r={value:ek(e,n)},i={value:t.state};i.value||l(r.value,{back:null,current:r.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function l(f,m,_){const w=e.indexOf("#"),M=w>-1?(n.host&&document.querySelector("base")?e:e.slice(w))+f:hF()+e+f;try{t[_?"replaceState":"pushState"](m,"",M),i.value=m}catch(C){console.error(C),n[_?"replace":"assign"](M)}}function a(f,m){const _=Ro({},t.state,wL(i.value.back,f,i.value.forward,!0),m,{position:i.value.position});l(f,_,!0),r.value=f}function o(f,m){const _=Ro({},i.value,t.state,{forward:f,scroll:N2()});l(_.current,_,!0);const w=Ro({},wL(r.value,f,null),{position:_.position+1},m);l(f,w,!1),r.value=f}return{location:r,state:i,push:o,replace:a}}function pF(e){e=iF(e);const t=fF(e),n=dF(e,t.state,t.location,t.replace);function r(l,a=!0){a||n.pauseListeners(),history.go(l)}const i=Ro({location:"",base:e,go:r,createHref:oF.bind(null,e)},t,n);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>t.state.value}),i}function mF(e){return typeof e=="string"||e&&typeof e=="object"}function tk(e){return typeof e=="string"||typeof e=="symbol"}const nk=Symbol("");var CL;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(CL||(CL={}));function H0(e,t){return Ro(new Error,{type:e,[nk]:!0},t)}function rp(e,t){return e instanceof Error&&nk in e&&(t==null||!!(e.type&t))}const SL="[^/]+?",gF={sensitive:!1,strict:!1,start:!0,end:!0},yF=/[.+*?^${}()[\]/\\]/g;function vF(e,t){const n=Ro({},gF,t),r=[];let i=n.start?"^":"";const l=[];for(const m of e){const _=m.length?[]:[90];n.strict&&!m.length&&(i+="/");for(let w=0;w<m.length;w++){const M=m[w];let C=40+(n.sensitive?.25:0);if(M.type===0)w||(i+="/"),i+=M.value.replace(yF,"\\$&"),C+=40;else if(M.type===1){const{value:R,repeatable:z,optional:W,regexp:X}=M;l.push({name:R,repeatable:z,optional:W});const Y=X||SL;if(Y!==SL){C+=10;try{new RegExp(`(${Y})`)}catch(oe){throw new Error(`Invalid custom RegExp for param "${R}" (${Y}): `+oe.message)}}let Q=z?`((?:${Y})(?:/(?:${Y}))*)`:`(${Y})`;w||(Q=W&&m.length<2?`(?:/${Q})`:"/"+Q),W&&(Q+="?"),i+=Q,C+=20,W&&(C+=-8),z&&(C+=-20),Y===".*"&&(C+=-50)}_.push(C)}r.push(_)}if(n.strict&&n.end){const m=r.length-1;r[m][r[m].length-1]+=.7000000000000001}n.strict||(i+="/?"),n.end?i+="$":n.strict&&!i.endsWith("/")&&(i+="(?:/|$)");const a=new RegExp(i,n.sensitive?"":"i");function o(m){const _=m.match(a),w={};if(!_)return null;for(let M=1;M<_.length;M++){const C=_[M]||"",R=l[M-1];w[R.name]=C&&R.repeatable?C.split("/"):C}return w}function f(m){let _="",w=!1;for(const M of e){(!w||!_.endsWith("/"))&&(_+="/"),w=!1;for(const C of M)if(C.type===0)_+=C.value;else if(C.type===1){const{value:R,repeatable:z,optional:W}=C,X=R in m?m[R]:"";if(af(X)&&!z)throw new Error(`Provided param "${R}" is an array but it is not repeatable (* or + modifiers)`);const Y=af(X)?X.join("/"):X;if(!Y)if(W)M.length<2&&(_.endsWith("/")?_=_.slice(0,-1):w=!0);else throw new Error(`Missing required param "${R}"`);_+=Y}}return _||"/"}return{re:a,score:r,keys:l,parse:o,stringify:f}}function _F(e,t){let n=0;for(;n<e.length&&n<t.length;){const r=t[n]-e[n];if(r)return r;n++}return e.length<t.length?e.length===1&&e[0]===80?-1:1:e.length>t.length?t.length===1&&t[0]===80?1:-1:0}function rk(e,t){let n=0;const r=e.score,i=t.score;for(;n<r.length&&n<i.length;){const l=_F(r[n],i[n]);if(l)return l;n++}if(Math.abs(i.length-r.length)===1){if(LL(r))return 1;if(LL(i))return-1}return i.length-r.length}function LL(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const bF={type:0,value:""},xF=/[a-zA-Z0-9_]/;function wF(e){if(!e)return[[]];if(e==="/")return[[bF]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(C){throw new Error(`ERR (${n})/"${m}": ${C}`)}let n=0,r=n;const i=[];let l;function a(){l&&i.push(l),l=[]}let o=0,f,m="",_="";function w(){m&&(n===0?l.push({type:0,value:m}):n===1||n===2||n===3?(l.length>1&&(f==="*"||f==="+")&&t(`A repeatable param (${m}) must be alone in its segment. eg: '/:ids+.`),l.push({type:1,value:m,regexp:_,repeatable:f==="*"||f==="+",optional:f==="*"||f==="?"})):t("Invalid state to consume buffer"),m="")}function M(){m+=f}for(;o<e.length;){if(f=e[o++],f==="\\"&&n!==2){r=n,n=4;continue}switch(n){case 0:f==="/"?(m&&w(),a()):f===":"?(w(),n=1):M();break;case 4:M(),n=r;break;case 1:f==="("?n=2:xF.test(f)?M():(w(),n=0,f!=="*"&&f!=="?"&&f!=="+"&&o--);break;case 2:f===")"?_[_.length-1]=="\\"?_=_.slice(0,-1)+f:n=3:_+=f;break;case 3:w(),n=0,f!=="*"&&f!=="?"&&f!=="+"&&o--,_="";break;default:t("Unknown state");break}}return n===2&&t(`Unfinished custom RegExp for param "${m}"`),w(),a(),i}function CF(e,t,n){const r=vF(wF(e.path),n),i=Ro(r,{record:e,parent:t,children:[],alias:[]});return t&&!i.record.aliasOf==!t.record.aliasOf&&t.children.push(i),i}function SF(e,t){const n=[],r=new Map;t=TL({strict:!1,end:!0,sensitive:!1},t);function i(w){return r.get(w)}function l(w,M,C){const R=!C,z=EL(w);z.aliasOf=C&&C.record;const W=TL(t,w),X=[z];if("alias"in w){const oe=typeof w.alias=="string"?[w.alias]:w.alias;for(const le of oe)X.push(EL(Ro({},z,{components:C?C.record.components:z.components,path:le,aliasOf:C?C.record:z})))}let Y,Q;for(const oe of X){const{path:le}=oe;if(M&&le[0]!=="/"){const me=M.record.path,we=me[me.length-1]==="/"?"":"/";oe.path=M.record.path+(le&&we+le)}if(Y=CF(oe,M,W),C?C.alias.push(Y):(Q=Q||Y,Q!==Y&&Q.alias.push(Y),R&&w.name&&!ML(Y)&&a(w.name)),ik(Y)&&f(Y),z.children){const me=z.children;for(let we=0;we<me.length;we++)l(me[we],Y,C&&C.children[we])}C=C||Y}return Q?()=>{a(Q)}:qv}function a(w){if(tk(w)){const M=r.get(w);M&&(r.delete(w),n.splice(n.indexOf(M),1),M.children.forEach(a),M.alias.forEach(a))}else{const M=n.indexOf(w);M>-1&&(n.splice(M,1),w.record.name&&r.delete(w.record.name),w.children.forEach(a),w.alias.forEach(a))}}function o(){return n}function f(w){const M=EF(w,n);n.splice(M,0,w),w.record.name&&!ML(w)&&r.set(w.record.name,w)}function m(w,M){let C,R={},z,W;if("name"in w&&w.name){if(C=r.get(w.name),!C)throw H0(1,{location:w});W=C.record.name,R=Ro(PL(M.params,C.keys.filter(Q=>!Q.optional).concat(C.parent?C.parent.keys.filter(Q=>Q.optional):[]).map(Q=>Q.name)),w.params&&PL(w.params,C.keys.map(Q=>Q.name))),z=C.stringify(R)}else if(w.path!=null)z=w.path,C=n.find(Q=>Q.re.test(z)),C&&(R=C.parse(z),W=C.record.name);else{if(C=M.name?r.get(M.name):n.find(Q=>Q.re.test(M.path)),!C)throw H0(1,{location:w,currentLocation:M});W=C.record.name,R=Ro({},M.params,w.params),z=C.stringify(R)}const X=[];let Y=C;for(;Y;)X.unshift(Y.record),Y=Y.parent;return{name:W,path:z,params:R,matched:X,meta:PF(X)}}e.forEach(w=>l(w));function _(){n.length=0,r.clear()}return{addRoute:l,resolve:m,removeRoute:a,clearRoutes:_,getRoutes:o,getRecordMatcher:i}}function PL(e,t){const n={};for(const r of t)r in e&&(n[r]=e[r]);return n}function EL(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:LF(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function LF(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(const r in e.components)t[r]=typeof n=="object"?n[r]:n;return t}function ML(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function PF(e){return e.reduce((t,n)=>Ro(t,n.meta),{})}function TL(e,t){const n={};for(const r in e)n[r]=r in t?t[r]:e[r];return n}function EF(e,t){let n=0,r=t.length;for(;n!==r;){const l=n+r>>1;rk(e,t[l])<0?r=l:n=l+1}const i=MF(e);return i&&(r=t.lastIndexOf(i,r-1)),r}function MF(e){let t=e;for(;t=t.parent;)if(ik(t)&&rk(e,t)===0)return t}function ik({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function TF(e){const t={};if(e===""||e==="?")return t;const r=(e[0]==="?"?e.slice(1):e).split("&");for(let i=0;i<r.length;++i){const l=r[i].replace(KA," "),a=l.indexOf("="),o=__(a<0?l:l.slice(0,a)),f=a<0?null:__(l.slice(a+1));if(o in t){let m=t[o];af(m)||(m=t[o]=[m]),m.push(f)}else t[o]=f}return t}function AL(e){let t="";for(let n in e){const r=e[n];if(n=KN(n),r==null){r!==void 0&&(t+=(t.length?"&":"")+n);continue}(af(r)?r.map(l=>l&&Z4(l)):[r&&Z4(r)]).forEach(l=>{l!==void 0&&(t+=(t.length?"&":"")+n,l!=null&&(t+="="+l))})}return t}function AF(e){const t={};for(const n in e){const r=e[n];r!==void 0&&(t[n]=af(r)?r.map(i=>i==null?null:""+i):r==null?r:""+r)}return t}const kF=Symbol(""),kL=Symbol(""),F2=Symbol(""),xC=Symbol(""),Y4=Symbol("");function sv(){let e=[];function t(r){return e.push(r),()=>{const i=e.indexOf(r);i>-1&&e.splice(i,1)}}function n(){e=[]}return{add:t,list:()=>e.slice(),reset:n}}function Qp(e,t,n,r,i,l=a=>a()){const a=r&&(r.enterCallbacks[i]=r.enterCallbacks[i]||[]);return()=>new Promise((o,f)=>{const m=M=>{M===!1?f(H0(4,{from:n,to:t})):M instanceof Error?f(M):mF(M)?f(H0(2,{from:t,to:M})):(a&&r.enterCallbacks[i]===a&&typeof M=="function"&&a.push(M),o())},_=l(()=>e.call(r&&r.instances[i],t,n,m));let w=Promise.resolve(_);e.length<3&&(w=w.then(m)),w.catch(M=>f(M))})}function O5(e,t,n,r,i=l=>l()){const l=[];for(const a of e)for(const o in a.components){let f=a.components[o];if(!(t!=="beforeRouteEnter"&&!a.instances[o]))if(WA(f)){const _=(f.__vccOpts||f)[t];_&&l.push(Qp(_,n,r,a,o,i))}else{let m=f();l.push(()=>m.then(_=>{if(!_)throw new Error(`Couldn't resolve component "${o}" at "${a.path}"`);const w=FN(_)?_.default:_;a.mods[o]=_,a.components[o]=w;const C=(w.__vccOpts||w)[t];return C&&Qp(C,n,r,a,o,i)()}))}}return l}function IL(e){const t=yd(F2),n=yd(xC),r=Ai(()=>{const f=Tr(e.to);return t.resolve(f)}),i=Ai(()=>{const{matched:f}=r.value,{length:m}=f,_=f[m-1],w=n.matched;if(!_||!w.length)return-1;const M=w.findIndex(G0.bind(null,_));if(M>-1)return M;const C=DL(f[m-2]);return m>1&&DL(_)===C&&w[w.length-1].path!==C?w.findIndex(G0.bind(null,f[m-2])):M}),l=Ai(()=>i.value>-1&&RF(n.params,r.value.params)),a=Ai(()=>i.value>-1&&i.value===n.matched.length-1&&QA(n.params,r.value.params));function o(f={}){if(OF(f)){const m=t[Tr(e.replace)?"replace":"push"](Tr(e.to)).catch(qv);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>m),m}return Promise.resolve()}return{route:r,href:Ai(()=>r.value.href),isActive:l,isExactActive:a,navigate:o}}function IF(e){return e.length===1?e[0]:e}const DF=Ja({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:IL,setup(e,{slots:t}){const n=bd(IL(e)),{options:r}=yd(F2),i=Ai(()=>({[OL(e.activeClass,r.linkActiveClass,"router-link-active")]:n.isActive,[OL(e.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const l=t.default&&IF(t.default(n));return e.custom?l:M2("a",{"aria-current":n.isExactActive?e.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:i.value},l)}}}),Sv=DF;function OF(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function RF(e,t){for(const n in t){const r=t[n],i=e[n];if(typeof r=="string"){if(r!==i)return!1}else if(!af(i)||i.length!==r.length||r.some((l,a)=>l!==i[a]))return!1}return!0}function DL(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const OL=(e,t,n)=>e??t??n,BF=Ja({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:n}){const r=yd(Y4),i=Ai(()=>e.route||r.value),l=yd(kL,0),a=Ai(()=>{let m=Tr(l);const{matched:_}=i.value;let w;for(;(w=_[m])&&!w.components;)m++;return m}),o=Ai(()=>i.value.matched[a.value]);Vv(kL,Ai(()=>a.value+1)),Vv(kF,o),Vv(Y4,i);const f=Rn();return mo(()=>[f.value,o.value,e.name],([m,_,w],[M,C,R])=>{_&&(_.instances[w]=m,C&&C!==_&&m&&m===M&&(_.leaveGuards.size||(_.leaveGuards=C.leaveGuards),_.updateGuards.size||(_.updateGuards=C.updateGuards))),m&&_&&(!C||!G0(_,C)||!M)&&(_.enterCallbacks[w]||[]).forEach(z=>z(m))},{flush:"post"}),()=>{const m=i.value,_=e.name,w=o.value,M=w&&w.components[_];if(!M)return RL(n.default,{Component:M,route:m});const C=w.props[_],R=C?C===!0?m.params:typeof C=="function"?C(m):C:null,W=M2(M,Ro({},R,t,{onVnodeUnmounted:X=>{X.component.isUnmounted&&(w.instances[_]=null)},ref:f}));return RL(n.default,{Component:W,route:m})||W}}});function RL(e,t){if(!e)return null;const n=e(t);return n.length===1?n[0]:n}const sk=BF;function NF(e){const t=SF(e.routes,e),n=e.parseQuery||TF,r=e.stringifyQuery||AL,i=e.history,l=sv(),a=sv(),o=sv(),f=Q3($p);let m=$p;x0&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const _=I5.bind(null,lt=>""+lt),w=I5.bind(null,XN),M=I5.bind(null,__);function C(lt,Mt){let wt,rn;return tk(lt)?(wt=t.getRecordMatcher(lt),rn=Mt):rn=lt,t.addRoute(rn,wt)}function R(lt){const Mt=t.getRecordMatcher(lt);Mt&&t.removeRoute(Mt)}function z(){return t.getRoutes().map(lt=>lt.record)}function W(lt){return!!t.getRecordMatcher(lt)}function X(lt,Mt){if(Mt=Ro({},Mt||f.value),typeof lt=="string"){const Ae=D5(n,lt,Mt.path),Be=t.resolve({path:Ae.path},Mt),Ce=i.createHref(Ae.fullPath);return Ro(Ae,Be,{params:M(Be.params),hash:__(Ae.hash),redirectedFrom:void 0,href:Ce})}let wt;if(lt.path!=null)wt=Ro({},lt,{path:D5(n,lt.path,Mt.path).path});else{const Ae=Ro({},lt.params);for(const Be in Ae)Ae[Be]==null&&delete Ae[Be];wt=Ro({},lt,{params:w(Ae)}),Mt.params=w(Mt.params)}const rn=t.resolve(wt,Mt),yn=lt.hash||"";rn.params=_(M(rn.params));const Pn=eF(r,Ro({},lt,{hash:ZN(yn),path:rn.path})),De=i.createHref(Pn);return Ro({fullPath:Pn,hash:yn,query:r===AL?AF(lt.query):lt.query||{}},rn,{redirectedFrom:void 0,href:De})}function Y(lt){return typeof lt=="string"?D5(n,lt,f.value.path):Ro({},lt)}function Q(lt,Mt){if(m!==lt)return H0(8,{from:Mt,to:lt})}function oe(lt){return we(lt)}function le(lt){return oe(Ro(Y(lt),{replace:!0}))}function me(lt){const Mt=lt.matched[lt.matched.length-1];if(Mt&&Mt.redirect){const{redirect:wt}=Mt;let rn=typeof wt=="function"?wt(lt):wt;return typeof rn=="string"&&(rn=rn.includes("?")||rn.includes("#")?rn=Y(rn):{path:rn},rn.params={}),Ro({query:lt.query,hash:lt.hash,params:rn.path!=null?{}:lt.params},rn)}}function we(lt,Mt){const wt=m=X(lt),rn=f.value,yn=lt.state,Pn=lt.force,De=lt.replace===!0,Ae=me(wt);if(Ae)return we(Ro(Y(Ae),{state:typeof Ae=="object"?Ro({},yn,Ae.state):yn,force:Pn,replace:De}),Mt||wt);const Be=wt;Be.redirectedFrom=Mt;let Ce;return!Pn&&tF(r,rn,wt)&&(Ce=H0(16,{to:Be,from:rn}),pt(rn,rn,!0,!1)),(Ce?Promise.resolve(Ce):We(Be,rn)).catch(ot=>rp(ot)?rp(ot,2)?ot:He(ot):Le(ot,Be,rn)).then(ot=>{if(ot){if(rp(ot,2))return we(Ro({replace:De},Y(ot.to),{state:typeof ot.to=="object"?Ro({},yn,ot.to.state):yn,force:Pn}),Mt||Be)}else ot=de(Be,rn,!0,De,yn);return he(Be,rn,ot),ot})}function ue(lt,Mt){const wt=Q(lt,Mt);return wt?Promise.reject(wt):Promise.resolve()}function _e(lt){const Mt=Ne.values().next().value;return Mt&&typeof Mt.runWithContext=="function"?Mt.runWithContext(lt):lt()}function We(lt,Mt){let wt;const[rn,yn,Pn]=FF(lt,Mt);wt=O5(rn.reverse(),"beforeRouteLeave",lt,Mt);for(const Ae of rn)Ae.leaveGuards.forEach(Be=>{wt.push(Qp(Be,lt,Mt))});const De=ue.bind(null,lt,Mt);return wt.push(De),it(wt).then(()=>{wt=[];for(const Ae of l.list())wt.push(Qp(Ae,lt,Mt));return wt.push(De),it(wt)}).then(()=>{wt=O5(yn,"beforeRouteUpdate",lt,Mt);for(const Ae of yn)Ae.updateGuards.forEach(Be=>{wt.push(Qp(Be,lt,Mt))});return wt.push(De),it(wt)}).then(()=>{wt=[];for(const Ae of Pn)if(Ae.beforeEnter)if(af(Ae.beforeEnter))for(const Be of Ae.beforeEnter)wt.push(Qp(Be,lt,Mt));else wt.push(Qp(Ae.beforeEnter,lt,Mt));return wt.push(De),it(wt)}).then(()=>(lt.matched.forEach(Ae=>Ae.enterCallbacks={}),wt=O5(Pn,"beforeRouteEnter",lt,Mt,_e),wt.push(De),it(wt))).then(()=>{wt=[];for(const Ae of a.list())wt.push(Qp(Ae,lt,Mt));return wt.push(De),it(wt)}).catch(Ae=>rp(Ae,8)?Ae:Promise.reject(Ae))}function he(lt,Mt,wt){o.list().forEach(rn=>_e(()=>rn(lt,Mt,wt)))}function de(lt,Mt,wt,rn,yn){const Pn=Q(lt,Mt);if(Pn)return Pn;const De=Mt===$p,Ae=x0?history.state:{};wt&&(rn||De?i.replace(lt.fullPath,Ro({scroll:De&&Ae&&Ae.scroll},yn)):i.push(lt.fullPath,yn)),f.value=lt,pt(lt,Mt,wt,De),He()}let Te;function be(){Te||(Te=i.listen((lt,Mt,wt)=>{if(!Ve.listening)return;const rn=X(lt),yn=me(rn);if(yn){we(Ro(yn,{replace:!0,force:!0}),rn).catch(qv);return}m=rn;const Pn=f.value;x0&&uF(xL(Pn.fullPath,wt.delta),N2()),We(rn,Pn).catch(De=>rp(De,12)?De:rp(De,2)?(we(Ro(Y(De.to),{force:!0}),rn).then(Ae=>{rp(Ae,20)&&!wt.delta&&wt.type===b_.pop&&i.go(-1,!1)}).catch(qv),Promise.reject()):(wt.delta&&i.go(-wt.delta,!1),Le(De,rn,Pn))).then(De=>{De=De||de(rn,Pn,!1),De&&(wt.delta&&!rp(De,8)?i.go(-wt.delta,!1):wt.type===b_.pop&&rp(De,20)&&i.go(-1,!1)),he(rn,Pn,De)}).catch(qv)}))}let ae=sv(),ne=sv(),Se;function Le(lt,Mt,wt){He(lt);const rn=ne.list();return rn.length?rn.forEach(yn=>yn(lt,Mt,wt)):console.error(lt),Promise.reject(lt)}function ze(){return Se&&f.value!==$p?Promise.resolve():new Promise((lt,Mt)=>{ae.add([lt,Mt])})}function He(lt){return Se||(Se=!lt,be(),ae.list().forEach(([Mt,wt])=>lt?wt(lt):Mt()),ae.reset()),lt}function pt(lt,Mt,wt,rn){const{scrollBehavior:yn}=e;if(!x0||!yn)return Promise.resolve();const Pn=!wt&&cF(xL(lt.fullPath,0))||(rn||!wt)&&history.state&&history.state.scroll||null;return Sh().then(()=>yn(lt,Mt,Pn)).then(De=>De&&lF(De)).catch(De=>Le(De,lt,Mt))}const ge=lt=>i.go(lt);let Ie;const Ne=new Set,Ve={currentRoute:f,listening:!0,addRoute:C,removeRoute:R,clearRoutes:t.clearRoutes,hasRoute:W,getRoutes:z,resolve:X,options:e,push:oe,replace:le,go:ge,back:()=>ge(-1),forward:()=>ge(1),beforeEach:l.add,beforeResolve:a.add,afterEach:o.add,onError:ne.add,isReady:ze,install(lt){const Mt=this;lt.component("RouterLink",Sv),lt.component("RouterView",sk),lt.config.globalProperties.$router=Mt,Object.defineProperty(lt.config.globalProperties,"$route",{enumerable:!0,get:()=>Tr(f)}),x0&&!Ie&&f.value===$p&&(Ie=!0,oe(i.location).catch(yn=>{}));const wt={};for(const yn in $p)Object.defineProperty(wt,yn,{get:()=>f.value[yn],enumerable:!0});lt.provide(F2,Mt),lt.provide(xC,X3(wt)),lt.provide(Y4,f);const rn=lt.unmount;Ne.add(lt),lt.unmount=function(){Ne.delete(lt),Ne.size<1&&(m=$p,Te&&Te(),Te=null,f.value=$p,Ie=!1,Se=!1),rn()}}};function it(lt){return lt.reduce((Mt,wt)=>Mt.then(()=>_e(wt)),Promise.resolve())}return Ve}function FF(e,t){const n=[],r=[],i=[],l=Math.max(t.matched.length,e.matched.length);for(let a=0;a<l;a++){const o=t.matched[a];o&&(e.matched.find(m=>G0(m,o))?r.push(o):n.push(o));const f=e.matched[a];f&&(t.matched.find(m=>G0(m,f))||i.push(f))}return[n,r,i]}function z2(){return yd(F2)}function zF(e){return yd(xC)}const Lh=ty("notification",()=>{const e=Rn([]),t=Rn(0),n=Rn(null),r=Ai(()=>[...e.value].sort((w,M)=>M.timestamp-w.timestamp));function i({type:w,message:M,duration:C=5e3}){const R=++t.value,z=Date.now(),W={id:R,type:w,message:M,duration:C,timestamp:z};return e.value.push(W),n.value=R,C>0&&setTimeout(()=>{m(R)},C),R}const l=(w,M=5e3)=>i({type:"success",message:w,duration:M}),a=(w,M=5e3)=>i({type:"error",message:w,duration:M}),o=(w,M=5e3)=>i({type:"info",message:w,duration:M}),f=(w,M=5e3)=>i({type:"warning",message:w,duration:M});function m(w){const M=e.value.findIndex(C=>C.id===w);M!==-1&&e.value.splice(M,1),n.value===w&&(n.value=null)}function _(){e.value=[],n.value=null}return{notifications:r,lastAddedId:n,addNotification:i,removeNotification:m,clearAll:_,success:l,error:a,info:o,warning:f}}),jF=Object.freeze(Object.defineProperty({__proto__:null,useNotificationStore:Lh},Symbol.toStringTag,{value:"Module"}));var lc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Mg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function ok(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}),n}function UF(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var wC=UF,VF=typeof lc=="object"&&lc&&lc.Object===Object&&lc,$F=VF,GF=$F,HF=typeof self=="object"&&self&&self.Object===Object&&self,qF=GF||HF||Function("return this")(),ak=qF,WF=ak,ZF=function(){return WF.Date.now()},KF=ZF,YF=/\s/;function XF(e){for(var t=e.length;t--&&YF.test(e.charAt(t)););return t}var JF=XF,QF=JF,e7=/^\s+/;function t7(e){return e&&e.slice(0,QF(e)+1).replace(e7,"")}var n7=t7,r7=ak,i7=r7.Symbol,lk=i7,BL=lk,uk=Object.prototype,s7=uk.hasOwnProperty,o7=uk.toString,ov=BL?BL.toStringTag:void 0;function a7(e){var t=s7.call(e,ov),n=e[ov];try{e[ov]=void 0;var r=!0}catch{}var i=o7.call(e);return r&&(t?e[ov]=n:delete e[ov]),i}var l7=a7,u7=Object.prototype,c7=u7.toString;function h7(e){return c7.call(e)}var d7=h7,NL=lk,f7=l7,p7=d7,m7="[object Null]",g7="[object Undefined]",FL=NL?NL.toStringTag:void 0;function y7(e){return e==null?e===void 0?g7:m7:FL&&FL in Object(e)?f7(e):p7(e)}var v7=y7;function _7(e){return e!=null&&typeof e=="object"}var b7=_7,x7=v7,w7=b7,C7="[object Symbol]";function S7(e){return typeof e=="symbol"||w7(e)&&x7(e)==C7}var L7=S7,P7=n7,zL=wC,E7=L7,jL=NaN,M7=/^[-+]0x[0-9a-f]+$/i,T7=/^0b[01]+$/i,A7=/^0o[0-7]+$/i,k7=parseInt;function I7(e){if(typeof e=="number")return e;if(E7(e))return jL;if(zL(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=zL(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=P7(e);var n=T7.test(e);return n||A7.test(e)?k7(e.slice(2),n?2:8):M7.test(e)?jL:+e}var D7=I7,O7=wC,R5=KF,UL=D7,R7="Expected a function",B7=Math.max,N7=Math.min;function F7(e,t,n){var r,i,l,a,o,f,m=0,_=!1,w=!1,M=!0;if(typeof e!="function")throw new TypeError(R7);t=UL(t)||0,O7(n)&&(_=!!n.leading,w="maxWait"in n,l=w?B7(UL(n.maxWait)||0,t):l,M="trailing"in n?!!n.trailing:M);function C(me){var we=r,ue=i;return r=i=void 0,m=me,a=e.apply(ue,we),a}function R(me){return m=me,o=setTimeout(X,t),_?C(me):a}function z(me){var we=me-f,ue=me-m,_e=t-we;return w?N7(_e,l-ue):_e}function W(me){var we=me-f,ue=me-m;return f===void 0||we>=t||we<0||w&&ue>=l}function X(){var me=R5();if(W(me))return Y(me);o=setTimeout(X,z(me))}function Y(me){return o=void 0,M&&r?C(me):(r=i=void 0,a)}function Q(){o!==void 0&&clearTimeout(o),m=0,r=f=i=o=void 0}function oe(){return o===void 0?a:Y(R5())}function le(){var me=R5(),we=W(me);if(r=arguments,i=this,f=me,we){if(o===void 0)return R(f);if(w)return clearTimeout(o),o=setTimeout(X,t),C(f)}return o===void 0&&(o=setTimeout(X,t)),a}return le.cancel=Q,le.flush=oe,le}var ck=F7;const hk=Mg(ck),z7={class:"relative w-full"},j7={key:0,class:"search-results w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto"},U7=["onClick"],VL=Ja({__name:"SearchBar",emits:["select-location"],setup(e,{emit:t}){const n=Rn(""),r=Rn([]),i=t,l=hk(async f=>{if(f.length<3){r.value=[];return}try{const _=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(f)}`)).json();r.value=_}catch(m){console.error("Erreur lors de la recherche d'adresse:",m),r.value=[]}},300);function a(){l(n.value)}function o(f){n.value=f.display_name,r.value=[],i("select-location",{lat:parseFloat(f.lat),lng:parseFloat(f.lon)})}return(f,m)=>(yt(),Et("div",z7,[li(V("input",{"onUpdate:modelValue":m[0]||(m[0]=_=>n.value=_),onInput:a,type:"text",placeholder:"Rechercher une adresse...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"},null,544),[[to,n.value]]),r.value.length>0?(yt(),Et("div",j7,[(yt(!0),Et($r,null,Ti(r.value,_=>(yt(),Et("div",{key:_.place_id,onClick:w=>o(_),class:"px-4 py-2 hover:bg-gray-100 cursor-pointer"},er(_.display_name),9,U7))),128))])):yr("",!0)]))}}),V7={key:0,class:"pwa-update-notification"},$7=Ja({__name:"PWAUpdateNotification",setup(e,{expose:t}){const n=Rn(!1),r=async()=>{window.location.reload(),n.value=!1},i=()=>{n.value=!1};return t({showUpdateNotification:n,refreshApp:r,closeNotification:i}),(l,a)=>n.value?(yt(),Et("div",V7,[V("div",{class:"pwa-update-content"},[a[0]||(a[0]=V("p",null,"Une nouvelle version est disponible",-1)),V("div",{class:"pwa-update-actions"},[V("button",{onClick:r,class:"pwa-update-button"},"Mettre à jour"),V("button",{onClick:i,class:"pwa-close-button"},"Plus tard")])])])):yr("",!0)}}),Vf=(e,t)=>{const n=e.__vccOpts||e;for(const[r,i]of t)n[r]=i;return n},G7=Vf($7,[["__scopeId","data-v-aa687693"]]),H7="/static/frontend/img/icons/android-chrome-192x192.png",q7={class:"prompt-content"},W7={class:"prompt-body"},Z7={key:0,class:"install-instructions ios"},K7={key:1,class:"install-instructions android"},Y7={key:2,class:"install-instructions desktop"},X7={key:3,class:"install-instructions desktop"},J7=Ja({__name:"PWAInstallPrompt",setup(e){const t=Rn(!1),n=Rn(!1),r=Rn(null);Rn(null);const i=Rn(!1),l=Rn(!1),a=Rn(!1),o=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0,f=()=>{const C=localStorage.getItem("pwaPromptLastClosed");if(!C)return!1;const R=3*24*60*60*1e3;return Date.now()-parseInt(C)<R},m=()=>{i.value=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,l.value=/Android/.test(navigator.userAgent),a.value=!i.value&&!l.value,window.addEventListener("beforeinstallprompt",C=>{C.preventDefault(),r.value=C,t.value=!0,n.value=!0}),window.addEventListener("appinstalled",C=>{t.value=!1}),!o()&&(f()||setTimeout(()=>{t.value=!0,n.value=!0},3e3))},_=()=>{window.removeEventListener("beforeinstallprompt",()=>{}),window.removeEventListener("appinstalled",()=>{})};Rl(()=>{m()}),wm(()=>{_()});const w=async()=>{if(r.value)try{r.value.prompt();const C=await r.value.userChoice;r.value=null,C.outcome==="accepted"&&(t.value=!1)}catch(C){console.error("Erreur lors de l'installation:",C)}},M=()=>{t.value=!1,localStorage.setItem("pwaPromptLastClosed",Date.now().toString())};return(C,R)=>t.value?(yt(),Et("div",{key:0,class:$s(["pwa-install-prompt",{fullscreen:n.value}])},[V("div",q7,[V("div",{class:"prompt-header"},[R[1]||(R[1]=V("div",{class:"app-info"},[V("img",{src:H7,alt:"TagMap Logo",class:"app-logo"}),V("div",{class:"app-details"},[V("h2",null,"Installer TagMap"),V("p",null,"Solution innovante de cartographie et gestion de projets")])],-1)),V("button",{onClick:M,class:"close-button","aria-label":"Fermer"},R[0]||(R[0]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[V("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),V("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)]))]),V("div",W7,[i.value?(yt(),Et("div",Z7,R[2]||(R[2]=[vd('<h3 data-v-3779ba3f>Pour installer l&#39;application sur votre iPhone :</h3><div class="instruction-step" data-v-3779ba3f><div class="step-number" data-v-3779ba3f>1</div><div class="step-content" data-v-3779ba3f><p data-v-3779ba3f>Appuyez sur <strong data-v-3779ba3f>Partager</strong> <span class="ios-share-icon" data-v-3779ba3f><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-3779ba3f><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8" data-v-3779ba3f></path><polyline points="16 6 12 2 8 6" data-v-3779ba3f></polyline><line x1="12" y1="2" x2="12" y2="15" data-v-3779ba3f></line></svg></span></p></div></div><div class="instruction-step" data-v-3779ba3f><div class="step-number" data-v-3779ba3f>2</div><div class="step-content" data-v-3779ba3f><p data-v-3779ba3f>Faites défiler et appuyez sur <strong data-v-3779ba3f>Sur l&#39;écran d&#39;accueil</strong></p></div></div><div class="instruction-step" data-v-3779ba3f><div class="step-number" data-v-3779ba3f>3</div><div class="step-content" data-v-3779ba3f><p data-v-3779ba3f>Appuyez sur <strong data-v-3779ba3f>Ajouter</strong> en haut à droite</p></div></div>',4)]))):l.value?(yt(),Et("div",K7,[R[3]||(R[3]=V("h3",null,"Pour installer l'application sur votre appareil :",-1)),R[4]||(R[4]=V("div",{class:"instruction-step"},[V("div",{class:"step-number"},"1"),V("div",{class:"step-content"},[V("p",null,"Appuyez sur le bouton ci-dessous")])],-1)),V("button",{onClick:w,class:"install-button"}," Installer l'application ")])):a.value?(yt(),Et("div",Y7,[R[5]||(R[5]=V("h3",null,"Pour installer l'application sur votre ordinateur :",-1)),R[6]||(R[6]=V("div",{class:"instruction-step"},[V("div",{class:"step-number"},"1"),V("div",{class:"step-content"},[V("p",null,"Cliquez sur le bouton ci-dessous pour installer l'application")])],-1)),V("button",{onClick:w,class:"install-button"}," Installer l'application ")])):(yt(),Et("div",X7,R[7]||(R[7]=[vd('<h3 data-v-3779ba3f>Pour installer l&#39;application sur votre ordinateur :</h3><div class="instruction-step" data-v-3779ba3f><div class="step-number" data-v-3779ba3f>1</div><div class="step-content" data-v-3779ba3f><p data-v-3779ba3f>Cliquez sur l&#39;icône d&#39;installation dans la barre d&#39;adresse</p></div></div><div class="instruction-step" data-v-3779ba3f><div class="step-number" data-v-3779ba3f>2</div><div class="step-content" data-v-3779ba3f><p data-v-3779ba3f>Cliquez sur &quot;Installer&quot;</p></div></div>',3)])))]),V("div",{class:"prompt-footer"},[R[8]||(R[8]=vd('<div class="benefits" data-v-3779ba3f><div class="benefit-item" data-v-3779ba3f><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-3779ba3f><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" data-v-3779ba3f></path></svg><span data-v-3779ba3f>Sécurisé</span></div><div class="benefit-item" data-v-3779ba3f><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-3779ba3f><circle cx="12" cy="12" r="10" data-v-3779ba3f></circle><polyline points="12 6 12 12 16 14" data-v-3779ba3f></polyline></svg><span data-v-3779ba3f>Rapide</span></div><div class="benefit-item" data-v-3779ba3f><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-3779ba3f><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" data-v-3779ba3f></path></svg><span data-v-3779ba3f>Hors ligne</span></div></div>',1)),V("button",{onClick:M,class:"remind-later"},"Me le rappeler plus tard")])])],2)):yr("",!0)}}),Q7=Vf(J7,[["__scopeId","data-v-3779ba3f"]]),ez={class:"app-container"},tz={key:0,class:"app-header bg-white shadow-sm z-[2500] flex-shrink-0"},nz={class:"mx-auto px-4 sm:px-6 lg:px-8"},rz={class:"flex h-16 items-center justify-between"},iz={class:"flex items-center"},sz={class:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},oz={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"},az={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},lz={class:"hidden md:flex md:ml-6 space-x-8"},uz={key:0,class:"flex-1 mx-2"},cz={class:"hidden md:block"},hz={class:"md:hidden"},dz={key:1,class:"flex-1"},fz={class:"flex items-center space-x-2 md:space-x-4"},pz={class:"relative"},mz={class:"px-4 py-2 border-b border-gray-100 flex justify-between items-center"},gz={class:"flex items-center justify-between w-full"},yz={class:"flex items-center space-x-3"},vz={class:"max-h-72 overflow-y-auto"},_z={key:0,class:"px-4 py-3 text-sm text-gray-500 text-center"},bz={class:"flex items-start"},xz={class:"flex-shrink-0 mr-3"},wz={key:0,class:"h-6 w-6 md:h-5 md:w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor"},Cz={key:1,class:"h-6 w-6 md:h-5 md:w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},Sz={key:2,class:"h-6 w-6 md:h-5 md:w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},Lz={key:3,class:"h-6 w-6 md:h-5 md:w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor"},Pz={class:"flex-1"},Ez={class:"text-sm md:text-sm text-gray-800"},Mz=["onClick"],Tz={class:"relative"},Az={class:"hidden md:flex flex-col items-end"},kz={class:"text-sm font-medium text-gray-700"},Iz={key:0,class:"text-xs text-gray-500"},Dz=["src","alt"],Oz={class:"md:hidden px-4 py-2 border-b border-gray-100 flex justify-between items-center"},Rz={class:"text-sm font-semibold text-gray-700"},Bz={class:"text-xs text-gray-500"},Nz={key:0,class:"md:hidden fixed inset-0 bg-white shadow-lg z-[3000] border-t border-gray-200",style:{top:"var(--header-height)"}},Fz={class:"space-y-1 px-2 pb-3 pt-2"},zz={class:"app-main"},jz=Ja({__name:"App",setup(e){const t=z2(),n=Mu(),r=Lh(),i=Rn(!1),l=Rn(!1),a=Rn(!1),o=Rn(!1),f=Rn(null),m=Rn(!1),_=Rn(!1),w=Rn(null),M=Rn("13px"),C=Rn("65px"),R=Rn(null),z=Rn(null),W=Rn(!1);function X(){_.value=window.innerWidth<768}Rl(()=>{X(),window.addEventListener("resize",X),window.addEventListener("resize",Y),window.addEventListener("pwa-update-available",()=>{W.value=!0})}),wm(()=>{window.removeEventListener("resize",X),window.removeEventListener("resize",Y),window.removeEventListener("pwa-update-available",()=>{})});function Y(){if(!w.value)return;const ae=w.value.getBoundingClientRect();M.value=`${ae.top+window.scrollY+5}px`;const ne=ae.left+ae.width/2;C.value=`${window.innerWidth-ne-22}px`}const Q=Ai(()=>{const ae=n.user;if(!ae)return"";const ne=`${ae.first_name} ${ae.last_name.toUpperCase()}`;return ae.company_name?`${ne} (${ae.company_name})`:ne}),oe=Ai(()=>{var ne;switch((ne=n.user)==null?void 0:ne.user_type){case"admin":return"Accès administrateur";case"entreprise":return"Accès entreprise";case"salarie":return"Accès salarie";case"visiteur":return"Accès visiteur";default:return""}}),le=Ai(()=>{var ae;return((ae=n.user)==null?void 0:ae.user_type)==="admin"}),me=Ai(()=>n.isAuthenticated),we=[{name:"Carte",to:"/"},{name:"Météo",to:"/meteo"},{name:"Notes",to:"/notes"}],ue=Ai(()=>{var ne,Se;if(!me.value)return[];const ae=[...we];return(le.value||((ne=n.user)==null?void 0:ne.user_type)==="entreprise"||((Se=n.user)==null?void 0:Se.user_type)==="salarie")&&ae.push({name:"Utilisateurs",to:"/users"}),le.value&&ae.push({name:"Paramètres",to:"/parametres"}),ae}),_e=Ai(()=>me.value?[{name:"Mon profil",to:"/profile"}]:[]);async function We(){try{await n.logout(),t.push("/login")}catch(ae){console.error("Erreur lors de la déconnexion:",ae)}}function he(ae){window.dispatchEvent(new CustomEvent("map-set-location",{detail:{lat:ae.lat,lng:ae.lng,zoom:16}}))}Rl(async()=>{try{if(localStorage.getItem("token")){await n.checkAuth(),await n.fetchUserProfile();const ne=localStorage.getItem("lastPlanId");ne&&window.dispatchEvent(new CustomEvent("load-last-plan",{detail:{planId:ne}}))}}catch(ae){console.error("Auth check error:",ae),t.push("/login")}});const de=Ai(()=>{const ae="TagMap";if(!me.value)return`${ae} - Connexion`;const ne=t.currentRoute.value,Le={home:"Carte",meteo:"Météo",notes:"Notes",users:"Utilisateurs",profile:"Mon profil",changePassword:"Changement de mot de passe",map:"Carte"}[ne.name]||"";return Le?`${ae} - ${Le}`:ae});mo(de,ae=>{document.title=ae},{immediate:!0});const Te=Ai(()=>r.notifications.length);function be(){r.clearAll(),a.value=!1}return m_(()=>{if(r.lastAddedId!==null){const ae=r.notifications.find(ne=>ne.id===r.lastAddedId);ae&&Sh(()=>{Y(),o.value=!0,f.value={id:ae.id,message:ae.message,type:ae.type},requestAnimationFrame(()=>{setTimeout(()=>{m.value=!0,setTimeout(()=>{m.value=!1,setTimeout(()=>{var ne;((ne=f.value)==null?void 0:ne.id)===ae.id&&(f.value=null,o.value=!1)},300)},4e3)},50)})})}}),(ae,ne)=>{var Se;return yt(),Et("div",ez,[me.value?(yt(),Et("header",tz,[V("nav",nz,[V("div",rz,[V("div",iz,[V("button",{onClick:ne[0]||(ne[0]=Le=>l.value=!l.value),class:"inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500 md:hidden"},[ne[7]||(ne[7]=V("span",{class:"sr-only"},"Ouvrir le menu",-1)),(yt(),Et("svg",sz,[l.value?(yt(),Et("path",az)):(yt(),Et("path",oz))]))]),Ns(Tr(Sv),{to:"/",class:"text-xl font-semibold text-primary-600 truncate ml-2 md:ml-0"},{default:Hh(()=>ne[8]||(ne[8]=[V("span",{class:"md:inline hidden"},"TagMap",-1),V("span",{class:"md:hidden inline"},"TM",-1)])),_:1}),V("div",lz,[(yt(!0),Et($r,null,Ti(ue.value,Le=>(yt(),Hu(Tr(Sv),{key:Le.name,to:Le.to,class:$s(["text-sm font-medium transition-colors duration-200",[ae.$route.path===Le.to?"text-primary-600 border-b-2 border-primary-500":"text-gray-500 hover:text-gray-900"]])},{default:Hh(()=>[rs(er(Le.name),1)]),_:2},1032,["to","class"]))),128))])]),ae.$route.path==="/"?(yt(),Et("div",uz,[V("div",cz,[Ns(VL,{onSelectLocation:he})]),V("div",hz,[Ns(VL,{onSelectLocation:he,class:"max-w-full"})])])):(yt(),Et("div",dz)),V("div",fz,[V("div",pz,[V("button",{ref_key:"bellButtonRef",ref:w,onClick:ne[1]||(ne[1]=Le=>a.value=!a.value),class:$s(["relative flex items-center justify-center p-2 text-gray-400 hover:text-gray-500 rounded-full hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",{"animate-bell":o.value}])},ne[9]||(ne[9]=[V("span",{class:"sr-only"},"Voir les notifications",-1),V("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})],-1)]),2),a.value?(yt(),Et("div",{key:0,class:"absolute right-0 mt-2 md:w-80 w-screen md:origin-top-right md:rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-[3500] md:right-0 right-0 left-0 md:left-auto",style:Zh(_.value?"position: fixed; top: 64px; left: 0; right: 0; margin: 0;":"")},[V("div",mz,[V("div",gz,[ne[11]||(ne[11]=V("h3",{class:"text-sm font-semibold text-gray-700"},"Notifications",-1)),V("div",yz,[Te.value>0?(yt(),Et("button",{key:0,onClick:be,class:"text-xs text-primary-600 hover:text-primary-800"}," Tout effacer ")):yr("",!0),V("button",{onClick:ne[2]||(ne[2]=Le=>a.value=!1),class:"md:hidden p-1 rounded-full hover:bg-gray-100"},ne[10]||(ne[10]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])])]),V("div",vz,[Te.value===0?(yt(),Et("div",_z," Aucune notification ")):yr("",!0),(yt(!0),Et($r,null,Ti(Tr(r).notifications,Le=>(yt(),Et("div",{key:Le.id,class:"px-4 py-3 md:py-3 py-4 border-b border-gray-100 last:border-0 hover:bg-gray-50"},[V("div",bz,[V("div",xz,[Le.type==="success"?(yt(),Et("svg",wz,ne[12]||(ne[12]=[V("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):Le.type==="error"?(yt(),Et("svg",Cz,ne[13]||(ne[13]=[V("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"},null,-1)]))):Le.type==="warning"?(yt(),Et("svg",Sz,ne[14]||(ne[14]=[V("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)]))):(yt(),Et("svg",Lz,ne[15]||(ne[15]=[V("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"},null,-1)])))]),V("div",Pz,[V("p",Ez,er(Le.message),1),V("button",{onClick:ze=>Tr(r).removeNotification(Le.id),class:"text-xs md:text-xs text-primary-600 hover:text-primary-800 mt-2 md:mt-1 py-1 md:py-0"}," Fermer ",8,Mz)])])]))),128))])],4)):yr("",!0)]),V("div",Tz,[V("button",{onClick:ne[3]||(ne[3]=Le=>i.value=!i.value),class:"flex items-center space-x-2 md:space-x-3 focus:outline-none"},[V("div",Az,[V("span",kz,er(Q.value),1),oe.value?(yt(),Et("span",Iz,er(oe.value),1)):yr("",!0)]),V("img",{class:"h-8 w-8 rounded-full ring-2 ring-white",src:((Se=Tr(n).user)==null?void 0:Se.logo)||"https://ui-avatars.com/api/?name="+encodeURIComponent(Q.value),alt:Q.value},null,8,Dz)]),i.value?(yt(),Et("div",{key:0,class:"absolute right-0 mt-2 md:w-48 w-screen md:origin-top-right md:rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-[3500] md:right-0 right-0 left-0 md:left-auto",style:Zh(_.value?"position: fixed; top: 64px; left: 0; right: 0; margin: 0;":"")},[V("div",Oz,[V("div",null,[V("div",Rz,er(Q.value),1),V("div",Bz,er(oe.value),1)]),V("button",{onClick:ne[4]||(ne[4]=Le=>i.value=!1),class:"p-1 rounded-full hover:bg-gray-100"},ne[16]||(ne[16]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),(yt(!0),Et($r,null,Ti(_e.value,Le=>(yt(),Hu(Tr(Sv),{key:Le.name,to:Le.to,class:"block px-4 md:py-2 py-3 text-sm text-gray-700 hover:bg-gray-50 border-b border-gray-100 last:border-b-0",onClick:ne[5]||(ne[5]=ze=>i.value=!1)},{default:Hh(()=>[rs(er(Le.name),1)]),_:2},1032,["to"]))),128)),V("button",{onClick:We,class:"block w-full px-4 md:py-2 py-3 text-left text-sm text-red-600 hover:bg-gray-50 font-medium"}," Déconnexion ")],4)):yr("",!0)])])]),l.value?(yt(),Et("div",Nz,[V("div",Fz,[(yt(!0),Et($r,null,Ti(ue.value,Le=>(yt(),Hu(Tr(Sv),{key:Le.name,to:Le.to,class:$s(["block px-3 py-2 rounded-md text-base font-medium",[ae.$route.path===Le.to?"bg-primary-50 text-primary-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"]]),onClick:ne[6]||(ne[6]=ze=>l.value=!1)},{default:Hh(()=>[rs(er(Le.name),1)]),_:2},1032,["to","class"]))),128))])])):yr("",!0)])])):yr("",!0),V("main",zz,[Ns(Tr(sk),null,{default:Hh(({Component:Le,route:ze})=>[V("div",{class:$s({"router-view-map":ze.meta.isMapRoute})},[(yt(),Hu(fT(Le)))],2)]),_:1})]),Ns(G7,{ref_key:"pwaUpdateNotification",ref:R},null,512),Ns(Q7,{ref_key:"pwaInstallPrompt",ref:z},null,512)])}}}),Uz="modulepreload",Vz=function(e){return"/static/frontend/"+e},$L={},Dd=function(t,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(n.map(f=>{if(f=Vz(f),f in $L)return;$L[f]=!0;const m=f.endsWith(".css"),_=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${_}`))return;const w=document.createElement("link");if(w.rel=m?"stylesheet":Uz,m||(w.as="script"),w.crossOrigin="",w.href=f,o&&w.setAttribute("nonce",o),document.head.appendChild(w),m)return new Promise((M,C)=>{w.addEventListener("load",M),w.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${f}`)))})}))}function l(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&l(o.reason);return t().catch(l)})},$z={class:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8"},Gz={class:"max-w-md w-full space-y-8"},Hz={class:"space-y-4"},qz={class:"mt-1"},Wz={class:"mt-1"},Zz={class:"mt-1"},Kz={key:0,class:"rounded-md bg-red-50 p-4"},Yz={class:"flex"},Xz={class:"ml-3"},Jz={class:"text-sm font-medium text-red-800"},Qz={key:1,class:"rounded-md bg-yellow-50 p-4"},e9={class:"flex"},t9={class:"ml-3"},n9={class:"mt-2 text-sm text-yellow-700"},r9={class:"list-disc pl-5 space-y-1"},i9=["disabled"],s9={class:"absolute left-0 inset-y-0 flex items-center pl-3"},o9={key:0,class:"h-5 w-5 text-primary-500 group-hover:text-primary-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},a9={key:1,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},l9=Ja({__name:"ChangePasswordForm",setup(e){const t=z2(),n=Mu(),r=bd({oldPassword:"",newPassword:"",confirmPassword:""}),i=Rn(!1),l=Rn(""),a=Ai(()=>{const m=[];return r.newPassword&&r.newPassword.length<8&&m.push("Le nouveau mot de passe doit contenir au moins 8 caractères"),r.newPassword&&r.confirmPassword&&r.newPassword!==r.confirmPassword&&m.push("Les mots de passe ne correspondent pas"),m}),o=Ai(()=>r.oldPassword.length>0&&r.newPassword.length>=8&&r.newPassword===r.confirmPassword);async function f(){var m,_,w,M,C,R,z,W;if(!o.value){l.value="Veuillez corriger les erreurs avant de continuer";return}if(!((m=n.user)!=null&&m.id)){l.value="Erreur : utilisateur non identifié";return}i.value=!0,l.value="";try{await n.changePassword(r.oldPassword,r.newPassword),t.push("/")}catch(X){console.error("Password change failed:",X),(w=(_=X.response)==null?void 0:_.data)!=null&&w.detail?l.value=X.response.data.detail:(C=(M=X.response)==null?void 0:M.data)!=null&&C.old_password?l.value=X.response.data.old_password[0]:(z=(R=X.response)==null?void 0:R.data)!=null&&z.password?l.value=X.response.data.password[0]:((W=X.response)==null?void 0:W.status)===401?(l.value="Session expirée, veuillez vous reconnecter",await n.logout(),t.push("/login")):l.value="Une erreur est survenue lors du changement de mot de passe"}finally{i.value=!1}}return(m,_)=>(yt(),Et("div",$z,[V("div",Gz,[_[12]||(_[12]=V("div",null,[V("h2",{class:"mt-6 text-center text-3xl font-extrabold text-gray-900"}," Changement de mot de passe "),V("p",{class:"mt-2 text-center text-sm text-gray-600"}," Pour des raisons de sécurité, vous devez changer votre mot de passe. ")],-1)),V("form",{class:"mt-8 space-y-6",onSubmit:Wh(f,["prevent"])},[V("div",Hz,[V("div",null,[_[3]||(_[3]=V("label",{for:"old-password",class:"block text-sm font-medium text-gray-700"},"Ancien mot de passe",-1)),V("div",qz,[li(V("input",{id:"old-password","onUpdate:modelValue":_[0]||(_[0]=w=>r.oldPassword=w),name:"old-password",type:"password",required:"",autocomplete:"current-password",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Entrez votre mot de passe actuel"},null,512),[[to,r.oldPassword]])])]),V("div",null,[_[4]||(_[4]=V("label",{for:"new-password",class:"block text-sm font-medium text-gray-700"},"Nouveau mot de passe",-1)),V("div",Wz,[li(V("input",{id:"new-password","onUpdate:modelValue":_[1]||(_[1]=w=>r.newPassword=w),name:"new-password",type:"password",required:"",autocomplete:"new-password",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Entrez votre nouveau mot de passe"},null,512),[[to,r.newPassword]])]),_[5]||(_[5]=V("p",{class:"mt-1 text-sm text-gray-500"}," Le mot de passe doit contenir au moins 8 caractères ",-1))]),V("div",null,[_[6]||(_[6]=V("label",{for:"confirm-password",class:"block text-sm font-medium text-gray-700"},"Confirmer le mot de passe",-1)),V("div",Zz,[li(V("input",{id:"confirm-password","onUpdate:modelValue":_[2]||(_[2]=w=>r.confirmPassword=w),name:"confirm-password",type:"password",required:"",autocomplete:"new-password",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Confirmez votre nouveau mot de passe"},null,512),[[to,r.confirmPassword]])])])]),l.value?(yt(),Et("div",Kz,[V("div",Yz,[_[7]||(_[7]=V("div",{class:"flex-shrink-0"},[V("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[V("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),V("div",Xz,[V("h3",Jz,er(l.value),1)])])])):yr("",!0),a.value.length>0?(yt(),Et("div",Qz,[V("div",e9,[_[9]||(_[9]=V("div",{class:"flex-shrink-0"},[V("svg",{class:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},[V("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])],-1)),V("div",t9,[_[8]||(_[8]=V("h3",{class:"text-sm font-medium text-yellow-800"},"Attention",-1)),V("div",n9,[V("ul",r9,[(yt(!0),Et($r,null,Ti(a.value,(w,M)=>(yt(),Et("li",{key:M},er(w),1))),128))])])])])])):yr("",!0),V("div",null,[V("button",{type:"submit",disabled:i.value||!o.value,class:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50"},[V("span",s9,[i.value?(yt(),Et("svg",a9,_[11]||(_[11]=[V("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),V("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(yt(),Et("svg",o9,_[10]||(_[10]=[V("path",{"fill-rule":"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule":"evenodd"},null,-1)])))]),rs(" "+er(i.value?"Modification en cours...":"Changer le mot de passe"),1)],8,i9)])],32)])]))}}),u9="/static/frontend/assets/background.svg",c9={class:"min-h-screen overflow-auto relative py-12 sm:px-6 lg:px-8"},h9={class:"container mx-auto relative z-10"},d9={class:"sm:mx-auto sm:w-full sm:max-w-md"},f9={class:"bg-white/95 backdrop-blur-sm py-8 px-6 shadow-xl rounded-xl sm:px-10 border border-white/20"},p9={key:0,class:"rounded-md bg-red-50 p-4"},m9={class:"flex"},g9={class:"ml-3"},y9={class:"text-sm font-medium text-red-800"},v9={class:"mt-1"},_9={class:"mt-1 relative"},b9=["type"],x9={key:0,class:"h-5 w-5 text-gray-400 hover:text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},w9={key:1,class:"h-5 w-5 text-gray-400 hover:text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},C9={class:"flex items-center justify-between"},S9={class:"flex items-center"},L9={class:"text-sm"},P9=["disabled"],E9={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},M9={class:"mt-16 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},T9={class:"mt-12"},A9={class:"flex flex-wrap justify-center gap-2 mb-8"},k9=["onClick"],I9={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},D9={class:"flex items-center mb-4"},O9={class:"text-2xl mr-2"},R9={class:"text-xl font-semibold text-gray-900"},B9={class:"text-gray-600 text-sm"},N9={key:0,class:"flex justify-center mt-8 gap-2"},F9=["onClick"],B5=6,z9=Ja({__name:"LoginView",setup(e){const t=z2(),n=Mu(),r=Rn(!1),i=Rn(null),l=Rn(!1),a=Rn("Tous"),o=Rn(1),f=bd({username:"",password:"",rememberMe:!1}),m=[{type:"Liniculteur",sector:"Agriculture",icon:"🌾",text:"En tant qu'entreprise, j'ai mis en place un sous-compte « agriculteur » permettant la géolocalisation des parcelles. Cela offre à nos salariés et prestataires une visibilité complète sur l'ensemble des parcelles et facilite leur accès. De plus, ils peuvent y ajouter des notes et des photos si nécessaire. Grâce aux trackers, nous renforçons également la sécurité de nos machines contre le vol."},{type:"Agro industriel",sector:"Industrie",icon:"🏭",text:"La gestion des comptes et sous-comptes est un atout majeur pour limiter, filtrer et contrôler l'accès de nos salariés aux différentes tâches."},{type:"Agence de voyage",sector:"Tourisme",icon:"✈️",text:"L'outil nous permet de créer gratuitement et sans limite des sous-comptes clients, d'établir des itinéraires personnalisés avec des points d'intérêt."},{type:"Industriel agroalimentaire",sector:"Industrie",icon:"🌱",text:"Nous disposons d'un compte entreprise avec des sous-comptes dédiés à chaque culture. Nos techniciens et agriculteurs partenaires peuvent ainsi ajouter des annotations et photo sur les parcelles. Grâce aux stations météo connectées, nous optimisons la gestion des tours d'irrigation par secteur géographique en fonction des précipitations."},{type:"Conseil municipal",sector:"Collectivité",icon:"🏛️",text:"Cette solution nous permet de gagner en efficacité dans la gestion des tâches à réaliser, en les géolocalisant et en offrant à nos employés communaux la possibilité d'ajouter des commentaires et des photos sur chaque tâche géoréférencée."},{type:"Location de matériel",sector:"Services",icon:"🚜",text:"Cette solution nous permet de géolocaliser notre flotte grâce à des trackers sans abonnement, avec uniquement un abonnement à la plateforme."},{type:"Agriculteur",sector:"Agriculture",icon:"👨‍🌾",text:"J'ai équipé tous mes canons d'enrouleurs de trackers et de caméras pour dissuader le vol de batteries."},{type:"Semencier",sector:"Agriculture",icon:"🌱",text:"Nous assurons la géolocalisation de l'ensemble de nos parcelles en France."},{type:"Concessionnaire irrigation",sector:"Services",icon:"💧",text:"Nous avons géolocalisé tous les forages de nos clients et ajouté en commentaire la procédure d'entrée, facilitant ainsi le travail de nos techniciens et agriculteurs lors des interventions."},{type:"Entreprise paysagiste",sector:"Services",icon:"🌳",text:"Nous géolocalisons tous nos chantiers et ajoutons une photo du chantier terminé en commentaire, servant de preuve en cas de litige."}],_=Ai(()=>["Tous",...new Set(m.map(z=>z.sector))]),w=Ai(()=>{let R=a.value==="Tous"?m:m.filter(X=>X.sector===a.value);const z=(o.value-1)*B5,W=z+B5;return R.slice(z,W)}),M=Ai(()=>{const R=a.value==="Tous"?m:m.filter(z=>z.sector===a.value);return Math.ceil(R.length/B5)});Rl(async()=>{var R;try{if((R=window.INITIAL_STATE)!=null&&R.isAuthenticated){t.push("/");return}await n.restoreSession()&&t.push("/")}catch(z){console.error("Error during initialization:",z),i.value=null}});async function C(){var R,z,W,X,Y,Q,oe,le,me;r.value=!0,i.value=null;try{if(!f.username||!f.password){i.value="Veuillez remplir tous les champs";return}await n.login(f.username,f.password),(R=n.user)!=null&&R.must_change_password?t.push("/change-password"):t.push("/")}catch(we){console.error("Login error:",we),((z=we==null?void 0:we.response)==null?void 0:z.status)===500?i.value="Le service est temporairement indisponible. Veuillez réessayer dans quelques instants.":((W=we==null?void 0:we.response)==null?void 0:W.status)===401||((X=we==null?void 0:we.response)==null?void 0:X.status)===403?i.value="Identifiants incorrects. Veuillez vérifier votre nom d'utilisateur et mot de passe.":(Q=(Y=we==null?void 0:we.response)==null?void 0:Y.data)!=null&&Q.detail?i.value=we.response.data.detail:(me=(le=(oe=we==null?void 0:we.response)==null?void 0:oe.data)==null?void 0:le.non_field_errors)!=null&&me[0]?i.value=we.response.data.non_field_errors[0]:(we==null?void 0:we.message)==="Network Error"?i.value="Impossible de se connecter au serveur. Veuillez vérifier votre connexion internet.":i.value="Une erreur est survenue lors de la connexion. Veuillez réessayer."}finally{r.value=!1}}return(R,z)=>{const W=lC("router-link");return yt(),Et("div",c9,[V("div",{class:"fixed inset-0 z-0",style:Zh({backgroundImage:`url(${Tr(u9)})`,backgroundSize:"400px",backgroundRepeat:"repeat",filter:"blur(1px) opacity(0.15)"})},null,4),z[16]||(z[16]=V("div",{class:"fixed inset-0 z-0 bg-gradient-to-br from-white/40 via-transparent to-primary-900/10"},null,-1)),V("div",h9,[V("div",d9,[V("div",f9,[z[12]||(z[12]=V("div",{class:"text-center mb-8"},[V("h2",{class:"text-3xl font-bold text-gray-900 mb-2"}," TagMap "),V("p",{class:"text-sm text-gray-600"}," Solution innovante de cartographie et gestion de projets ")],-1)),V("form",{class:"space-y-6",onSubmit:Wh(C,["prevent"])},[i.value?(yt(),Et("div",p9,[V("div",m9,[z[4]||(z[4]=V("div",{class:"flex-shrink-0"},[V("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[V("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),V("div",g9,[V("h3",y9,er(i.value),1)])])])):yr("",!0),V("div",null,[z[5]||(z[5]=V("label",{for:"username",class:"block text-sm font-medium text-gray-700"}," Nom d'utilisateur ",-1)),V("div",v9,[li(V("input",{id:"username","onUpdate:modelValue":z[0]||(z[0]=X=>f.username=X),name:"username",type:"text",required:"",autocomplete:"username",class:"appearance-none block w-full h-11 px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 sm:text-sm","aria-label":"Nom d'utilisateur"},null,512),[[to,f.username]])])]),V("div",null,[z[8]||(z[8]=V("label",{for:"password",class:"block text-sm font-medium text-gray-700"}," Mot de passe ",-1)),V("div",_9,[li(V("input",{id:"password","onUpdate:modelValue":z[1]||(z[1]=X=>f.password=X),type:l.value?"text":"password",name:"password",required:"",autocomplete:"current-password",class:"appearance-none block w-full h-11 px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 sm:text-sm pr-10","aria-label":"Mot de passe"},null,8,b9),[[gC,f.password]]),V("button",{type:"button",onClick:z[2]||(z[2]=X=>l.value=!l.value),class:"absolute inset-y-0 right-0 pr-3 flex items-center","aria-label":"Afficher/masquer le mot de passe"},[l.value?(yt(),Et("svg",x9,z[6]||(z[6]=[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)]))):(yt(),Et("svg",w9,z[7]||(z[7]=[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])))])])]),V("div",C9,[V("div",S9,[li(V("input",{id:"remember-me","onUpdate:modelValue":z[3]||(z[3]=X=>f.rememberMe=X),name:"remember-me",type:"checkbox",class:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded","aria-label":"Se souvenir de moi"},null,512),[[jh,f.rememberMe]]),z[9]||(z[9]=V("label",{for:"remember-me",class:"ml-2 block text-sm text-gray-900"}," Se souvenir de moi ",-1))]),V("div",L9,[Ns(W,{to:"/forgot-password",class:"font-medium text-primary-600 hover:text-primary-500 transition-colors duration-200"},{default:Hh(()=>z[10]||(z[10]=[rs(" Mot de passe oublié ? ")])),_:1})])]),V("div",null,[V("button",{type:"submit",disabled:r.value,class:"w-full h-11 flex justify-center items-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Se connecter"},[r.value?(yt(),Et("svg",E9,z[11]||(z[11]=[V("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),V("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):yr("",!0),rs(" "+er(r.value?"Connexion en cours...":"Se connecter"),1)],8,P9)])],32)])]),V("div",M9,[z[14]||(z[14]=vd('<div class="mb-12 bg-white/90 backdrop-blur-sm p-8 rounded-xl shadow-lg border border-white/20" data-v-cb538253><div class="flex items-center mb-6" data-v-cb538253><span class="text-2xl mr-2" data-v-cb538253>💡</span><h3 class="text-xl font-bold text-gray-900" data-v-cb538253>Équipements Connectés sans Abonnement</h3></div><div class="grid grid-cols-1 md:grid-cols-2 gap-6" data-v-cb538253><div class="flex items-center space-x-4" data-v-cb538253><div class="flex-shrink-0 text-2xl" data-v-cb538253>📍</div><div data-v-cb538253><h4 class="font-semibold" data-v-cb538253>Tracker GPS solaire</h4><p class="text-gray-600" data-v-cb538253>Géolocalisez et sécurisez votre matériel</p></div></div><div class="flex items-center space-x-4" data-v-cb538253><div class="flex-shrink-0 text-2xl" data-v-cb538253>🌤️</div><div data-v-cb538253><h4 class="font-semibold" data-v-cb538253>Station météo</h4><p class="text-gray-600" data-v-cb538253>Optimisez vos décisions avec des données en temps réel</p></div></div></div></div><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8" data-v-cb538253><div class="bg-white/90 backdrop-blur-sm p-6 rounded-xl shadow-lg border border-white/20" data-v-cb538253><div class="flex items-center mb-4" data-v-cb538253><span class="text-2xl mr-2" data-v-cb538253>👀📌</span><h3 class="text-lg font-semibold text-gray-900" data-v-cb538253>Carte Interactive</h3></div><p class="text-gray-600" data-v-cb538253>Imaginez... Une carte interactive où tout est sous contrôle ! Tout est centralisé, organisé et accessible en un clin d&#39;œil !</p></div><div class="bg-white/90 backdrop-blur-sm p-6 rounded-xl shadow-lg border border-white/20" data-v-cb538253><div class="flex items-center mb-4" data-v-cb538253><span class="text-2xl mr-2" data-v-cb538253>👥💻🔄</span><h3 class="text-lg font-semibold text-gray-900" data-v-cb538253>Collaboration en Temps Réel</h3></div><p class="text-gray-600" data-v-cb538253>Travail d&#39;équipe simplifié : Collaborez en temps réel sur une interface ultra-intuitive. Vos équipes restent synchronisées et efficaces !</p></div><div class="bg-white/90 backdrop-blur-sm p-6 rounded-xl shadow-lg border border-white/20" data-v-cb538253><div class="flex items-center mb-4" data-v-cb538253><span class="text-2xl mr-2" data-v-cb538253>🚜📸</span><h3 class="text-lg font-semibold text-gray-900" data-v-cb538253>Cerveau Cartographique</h3></div><p class="text-gray-600" data-v-cb538253>Un cerveau cartographique : Dessinez, annotez, planifiez, suivez !</p></div><div class="bg-white/90 backdrop-blur-sm p-6 rounded-xl shadow-lg border border-white/20" data-v-cb538253><div class="flex items-center mb-4" data-v-cb538253><span class="text-2xl mr-2" data-v-cb538253>🔐🔑</span><h3 class="text-lg font-semibold text-gray-900" data-v-cb538253>Accès Sécurisé</h3></div><p class="text-gray-600" data-v-cb538253>Accès sécurisé et intelligent : Gérez les droits d&#39;accès de vos salariés et prestataires en un clic.</p></div></div>',2)),V("div",T9,[z[13]||(z[13]=V("h3",{class:"text-2xl font-bold text-center text-gray-900 mb-8"},"Ils utilisent TagMap",-1)),V("div",A9,[(yt(!0),Et($r,null,Ti(_.value,X=>(yt(),Et("button",{key:X,onClick:Y=>a.value=X,class:$s(["px-4 py-2 rounded-full text-sm font-medium transition-all duration-200",a.value===X?"bg-primary-600 text-white":"bg-white/80 text-gray-700 hover:bg-primary-50"])},er(X),11,k9))),128))]),V("div",I9,[(yt(!0),Et($r,null,Ti(w.value,X=>(yt(),Et("div",{key:X.type,class:"bg-white/90 backdrop-blur-sm p-6 rounded-xl shadow-lg border border-white/20 transition-all duration-300 hover:shadow-xl"},[V("div",D9,[V("span",O9,er(X.icon),1),V("span",R9,er(X.type),1)]),V("p",B9,er(X.text),1)]))),128))]),M.value>1?(yt(),Et("div",N9,[(yt(!0),Et($r,null,Ti(M.value,X=>(yt(),Et("button",{key:X,onClick:Y=>o.value=X,class:$s(["w-8 h-8 rounded-full text-sm font-medium transition-all duration-200",o.value===X?"bg-primary-600 text-white":"bg-white/80 text-gray-700 hover:bg-primary-50"])},er(X),11,F9))),128))])):yr("",!0)])]),z[15]||(z[15]=V("div",{class:"h-16"},null,-1))])])}}}),j9=Vf(z9,[["__scopeId","data-v-cb538253"]]),U9="/static/frontend/assets/logo.svg";var X4={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(n,r){r(t)})(lc,function(n){var r="1.9.4";function i(p){var T,U,se,Pe;for(U=1,se=arguments.length;U<se;U++){Pe=arguments[U];for(T in Pe)p[T]=Pe[T]}return p}var l=Object.create||function(){function p(){}return function(T){return p.prototype=T,new p}}();function a(p,T){var U=Array.prototype.slice;if(p.bind)return p.bind.apply(p,U.call(arguments,1));var se=U.call(arguments,2);return function(){return p.apply(T,se.length?se.concat(U.call(arguments)):arguments)}}var o=0;function f(p){return"_leaflet_id"in p||(p._leaflet_id=++o),p._leaflet_id}function m(p,T,U){var se,Pe,nt,Jt;return Jt=function(){se=!1,Pe&&(nt.apply(U,Pe),Pe=!1)},nt=function(){se?Pe=arguments:(p.apply(U,arguments),setTimeout(Jt,T),se=!0)},nt}function _(p,T,U){var se=T[1],Pe=T[0],nt=se-Pe;return p===se&&U?p:((p-Pe)%nt+nt)%nt+Pe}function w(){return!1}function M(p,T){if(T===!1)return p;var U=Math.pow(10,T===void 0?6:T);return Math.round(p*U)/U}function C(p){return p.trim?p.trim():p.replace(/^\s+|\s+$/g,"")}function R(p){return C(p).split(/\s+/)}function z(p,T){Object.prototype.hasOwnProperty.call(p,"options")||(p.options=p.options?l(p.options):{});for(var U in T)p.options[U]=T[U];return p.options}function W(p,T,U){var se=[];for(var Pe in p)se.push(encodeURIComponent(U?Pe.toUpperCase():Pe)+"="+encodeURIComponent(p[Pe]));return(!T||T.indexOf("?")===-1?"?":"&")+se.join("&")}var X=/\{ *([\w_ -]+) *\}/g;function Y(p,T){return p.replace(X,function(U,se){var Pe=T[se];if(Pe===void 0)throw new Error("No value provided for variable "+U);return typeof Pe=="function"&&(Pe=Pe(T)),Pe})}var Q=Array.isArray||function(p){return Object.prototype.toString.call(p)==="[object Array]"};function oe(p,T){for(var U=0;U<p.length;U++)if(p[U]===T)return U;return-1}var le="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function me(p){return window["webkit"+p]||window["moz"+p]||window["ms"+p]}var we=0;function ue(p){var T=+new Date,U=Math.max(0,16-(T-we));return we=T+U,window.setTimeout(p,U)}var _e=window.requestAnimationFrame||me("RequestAnimationFrame")||ue,We=window.cancelAnimationFrame||me("CancelAnimationFrame")||me("CancelRequestAnimationFrame")||function(p){window.clearTimeout(p)};function he(p,T,U){if(U&&_e===ue)p.call(T);else return _e.call(window,a(p,T))}function de(p){p&&We.call(window,p)}var Te={__proto__:null,extend:i,create:l,bind:a,get lastId(){return o},stamp:f,throttle:m,wrapNum:_,falseFn:w,formatNum:M,trim:C,splitWords:R,setOptions:z,getParamString:W,template:Y,isArray:Q,indexOf:oe,emptyImageUrl:le,requestFn:_e,cancelFn:We,requestAnimFrame:he,cancelAnimFrame:de};function be(){}be.extend=function(p){var T=function(){z(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},U=T.__super__=this.prototype,se=l(U);se.constructor=T,T.prototype=se;for(var Pe in this)Object.prototype.hasOwnProperty.call(this,Pe)&&Pe!=="prototype"&&Pe!=="__super__"&&(T[Pe]=this[Pe]);return p.statics&&i(T,p.statics),p.includes&&(ae(p.includes),i.apply(null,[se].concat(p.includes))),i(se,p),delete se.statics,delete se.includes,se.options&&(se.options=U.options?l(U.options):{},i(se.options,p.options)),se._initHooks=[],se.callInitHooks=function(){if(!this._initHooksCalled){U.callInitHooks&&U.callInitHooks.call(this),this._initHooksCalled=!0;for(var nt=0,Jt=se._initHooks.length;nt<Jt;nt++)se._initHooks[nt].call(this)}},T},be.include=function(p){var T=this.prototype.options;return i(this.prototype,p),p.options&&(this.prototype.options=T,this.mergeOptions(p.options)),this},be.mergeOptions=function(p){return i(this.prototype.options,p),this},be.addInitHook=function(p){var T=Array.prototype.slice.call(arguments,1),U=typeof p=="function"?p:function(){this[p].apply(this,T)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(U),this};function ae(p){if(!(typeof L>"u"||!L||!L.Mixin)){p=Q(p)?p:[p];for(var T=0;T<p.length;T++)p[T]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ne={on:function(p,T,U){if(typeof p=="object")for(var se in p)this._on(se,p[se],T);else{p=R(p);for(var Pe=0,nt=p.length;Pe<nt;Pe++)this._on(p[Pe],T,U)}return this},off:function(p,T,U){if(!arguments.length)delete this._events;else if(typeof p=="object")for(var se in p)this._off(se,p[se],T);else{p=R(p);for(var Pe=arguments.length===1,nt=0,Jt=p.length;nt<Jt;nt++)Pe?this._off(p[nt]):this._off(p[nt],T,U)}return this},_on:function(p,T,U,se){if(typeof T!="function"){console.warn("wrong listener type: "+typeof T);return}if(this._listens(p,T,U)===!1){U===this&&(U=void 0);var Pe={fn:T,ctx:U};se&&(Pe.once=!0),this._events=this._events||{},this._events[p]=this._events[p]||[],this._events[p].push(Pe)}},_off:function(p,T,U){var se,Pe,nt;if(this._events&&(se=this._events[p],!!se)){if(arguments.length===1){if(this._firingCount)for(Pe=0,nt=se.length;Pe<nt;Pe++)se[Pe].fn=w;delete this._events[p];return}if(typeof T!="function"){console.warn("wrong listener type: "+typeof T);return}var Jt=this._listens(p,T,U);if(Jt!==!1){var Dn=se[Jt];this._firingCount&&(Dn.fn=w,this._events[p]=se=se.slice()),se.splice(Jt,1)}}},fire:function(p,T,U){if(!this.listens(p,U))return this;var se=i({},T,{type:p,target:this,sourceTarget:T&&T.sourceTarget||this});if(this._events){var Pe=this._events[p];if(Pe){this._firingCount=this._firingCount+1||1;for(var nt=0,Jt=Pe.length;nt<Jt;nt++){var Dn=Pe[nt],Jn=Dn.fn;Dn.once&&this.off(p,Jn,Dn.ctx),Jn.call(Dn.ctx||this,se)}this._firingCount--}}return U&&this._propagateEvent(se),this},listens:function(p,T,U,se){typeof p!="string"&&console.warn('"string" type argument expected');var Pe=T;typeof T!="function"&&(se=!!T,Pe=void 0,U=void 0);var nt=this._events&&this._events[p];if(nt&&nt.length&&this._listens(p,Pe,U)!==!1)return!0;if(se){for(var Jt in this._eventParents)if(this._eventParents[Jt].listens(p,T,U,se))return!0}return!1},_listens:function(p,T,U){if(!this._events)return!1;var se=this._events[p]||[];if(!T)return!!se.length;U===this&&(U=void 0);for(var Pe=0,nt=se.length;Pe<nt;Pe++)if(se[Pe].fn===T&&se[Pe].ctx===U)return Pe;return!1},once:function(p,T,U){if(typeof p=="object")for(var se in p)this._on(se,p[se],T,!0);else{p=R(p);for(var Pe=0,nt=p.length;Pe<nt;Pe++)this._on(p[Pe],T,U,!0)}return this},addEventParent:function(p){return this._eventParents=this._eventParents||{},this._eventParents[f(p)]=p,this},removeEventParent:function(p){return this._eventParents&&delete this._eventParents[f(p)],this},_propagateEvent:function(p){for(var T in this._eventParents)this._eventParents[T].fire(p.type,i({layer:p.target,propagatedFrom:p.target},p),!0)}};ne.addEventListener=ne.on,ne.removeEventListener=ne.clearAllEventListeners=ne.off,ne.addOneTimeEventListener=ne.once,ne.fireEvent=ne.fire,ne.hasEventListeners=ne.listens;var Se=be.extend(ne);function Le(p,T,U){this.x=U?Math.round(p):p,this.y=U?Math.round(T):T}var ze=Math.trunc||function(p){return p>0?Math.floor(p):Math.ceil(p)};Le.prototype={clone:function(){return new Le(this.x,this.y)},add:function(p){return this.clone()._add(He(p))},_add:function(p){return this.x+=p.x,this.y+=p.y,this},subtract:function(p){return this.clone()._subtract(He(p))},_subtract:function(p){return this.x-=p.x,this.y-=p.y,this},divideBy:function(p){return this.clone()._divideBy(p)},_divideBy:function(p){return this.x/=p,this.y/=p,this},multiplyBy:function(p){return this.clone()._multiplyBy(p)},_multiplyBy:function(p){return this.x*=p,this.y*=p,this},scaleBy:function(p){return new Le(this.x*p.x,this.y*p.y)},unscaleBy:function(p){return new Le(this.x/p.x,this.y/p.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ze(this.x),this.y=ze(this.y),this},distanceTo:function(p){p=He(p);var T=p.x-this.x,U=p.y-this.y;return Math.sqrt(T*T+U*U)},equals:function(p){return p=He(p),p.x===this.x&&p.y===this.y},contains:function(p){return p=He(p),Math.abs(p.x)<=Math.abs(this.x)&&Math.abs(p.y)<=Math.abs(this.y)},toString:function(){return"Point("+M(this.x)+", "+M(this.y)+")"}};function He(p,T,U){return p instanceof Le?p:Q(p)?new Le(p[0],p[1]):p==null?p:typeof p=="object"&&"x"in p&&"y"in p?new Le(p.x,p.y):new Le(p,T,U)}function pt(p,T){if(p)for(var U=T?[p,T]:p,se=0,Pe=U.length;se<Pe;se++)this.extend(U[se])}pt.prototype={extend:function(p){var T,U;if(!p)return this;if(p instanceof Le||typeof p[0]=="number"||"x"in p)T=U=He(p);else if(p=ge(p),T=p.min,U=p.max,!T||!U)return this;return!this.min&&!this.max?(this.min=T.clone(),this.max=U.clone()):(this.min.x=Math.min(T.x,this.min.x),this.max.x=Math.max(U.x,this.max.x),this.min.y=Math.min(T.y,this.min.y),this.max.y=Math.max(U.y,this.max.y)),this},getCenter:function(p){return He((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,p)},getBottomLeft:function(){return He(this.min.x,this.max.y)},getTopRight:function(){return He(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(p){var T,U;return typeof p[0]=="number"||p instanceof Le?p=He(p):p=ge(p),p instanceof pt?(T=p.min,U=p.max):T=U=p,T.x>=this.min.x&&U.x<=this.max.x&&T.y>=this.min.y&&U.y<=this.max.y},intersects:function(p){p=ge(p);var T=this.min,U=this.max,se=p.min,Pe=p.max,nt=Pe.x>=T.x&&se.x<=U.x,Jt=Pe.y>=T.y&&se.y<=U.y;return nt&&Jt},overlaps:function(p){p=ge(p);var T=this.min,U=this.max,se=p.min,Pe=p.max,nt=Pe.x>T.x&&se.x<U.x,Jt=Pe.y>T.y&&se.y<U.y;return nt&&Jt},isValid:function(){return!!(this.min&&this.max)},pad:function(p){var T=this.min,U=this.max,se=Math.abs(T.x-U.x)*p,Pe=Math.abs(T.y-U.y)*p;return ge(He(T.x-se,T.y-Pe),He(U.x+se,U.y+Pe))},equals:function(p){return p?(p=ge(p),this.min.equals(p.getTopLeft())&&this.max.equals(p.getBottomRight())):!1}};function ge(p,T){return!p||p instanceof pt?p:new pt(p,T)}function Ie(p,T){if(p)for(var U=T?[p,T]:p,se=0,Pe=U.length;se<Pe;se++)this.extend(U[se])}Ie.prototype={extend:function(p){var T=this._southWest,U=this._northEast,se,Pe;if(p instanceof Ve)se=p,Pe=p;else if(p instanceof Ie){if(se=p._southWest,Pe=p._northEast,!se||!Pe)return this}else return p?this.extend(it(p)||Ne(p)):this;return!T&&!U?(this._southWest=new Ve(se.lat,se.lng),this._northEast=new Ve(Pe.lat,Pe.lng)):(T.lat=Math.min(se.lat,T.lat),T.lng=Math.min(se.lng,T.lng),U.lat=Math.max(Pe.lat,U.lat),U.lng=Math.max(Pe.lng,U.lng)),this},pad:function(p){var T=this._southWest,U=this._northEast,se=Math.abs(T.lat-U.lat)*p,Pe=Math.abs(T.lng-U.lng)*p;return new Ie(new Ve(T.lat-se,T.lng-Pe),new Ve(U.lat+se,U.lng+Pe))},getCenter:function(){return new Ve((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Ve(this.getNorth(),this.getWest())},getSouthEast:function(){return new Ve(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(p){typeof p[0]=="number"||p instanceof Ve||"lat"in p?p=it(p):p=Ne(p);var T=this._southWest,U=this._northEast,se,Pe;return p instanceof Ie?(se=p.getSouthWest(),Pe=p.getNorthEast()):se=Pe=p,se.lat>=T.lat&&Pe.lat<=U.lat&&se.lng>=T.lng&&Pe.lng<=U.lng},intersects:function(p){p=Ne(p);var T=this._southWest,U=this._northEast,se=p.getSouthWest(),Pe=p.getNorthEast(),nt=Pe.lat>=T.lat&&se.lat<=U.lat,Jt=Pe.lng>=T.lng&&se.lng<=U.lng;return nt&&Jt},overlaps:function(p){p=Ne(p);var T=this._southWest,U=this._northEast,se=p.getSouthWest(),Pe=p.getNorthEast(),nt=Pe.lat>T.lat&&se.lat<U.lat,Jt=Pe.lng>T.lng&&se.lng<U.lng;return nt&&Jt},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(p,T){return p?(p=Ne(p),this._southWest.equals(p.getSouthWest(),T)&&this._northEast.equals(p.getNorthEast(),T)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Ne(p,T){return p instanceof Ie?p:new Ie(p,T)}function Ve(p,T,U){if(isNaN(p)||isNaN(T))throw new Error("Invalid LatLng object: ("+p+", "+T+")");this.lat=+p,this.lng=+T,U!==void 0&&(this.alt=+U)}Ve.prototype={equals:function(p,T){if(!p)return!1;p=it(p);var U=Math.max(Math.abs(this.lat-p.lat),Math.abs(this.lng-p.lng));return U<=(T===void 0?1e-9:T)},toString:function(p){return"LatLng("+M(this.lat,p)+", "+M(this.lng,p)+")"},distanceTo:function(p){return Mt.distance(this,it(p))},wrap:function(){return Mt.wrapLatLng(this)},toBounds:function(p){var T=180*p/40075017,U=T/Math.cos(Math.PI/180*this.lat);return Ne([this.lat-T,this.lng-U],[this.lat+T,this.lng+U])},clone:function(){return new Ve(this.lat,this.lng,this.alt)}};function it(p,T,U){return p instanceof Ve?p:Q(p)&&typeof p[0]!="object"?p.length===3?new Ve(p[0],p[1],p[2]):p.length===2?new Ve(p[0],p[1]):null:p==null?p:typeof p=="object"&&"lat"in p?new Ve(p.lat,"lng"in p?p.lng:p.lon,p.alt):T===void 0?null:new Ve(p,T,U)}var lt={latLngToPoint:function(p,T){var U=this.projection.project(p),se=this.scale(T);return this.transformation._transform(U,se)},pointToLatLng:function(p,T){var U=this.scale(T),se=this.transformation.untransform(p,U);return this.projection.unproject(se)},project:function(p){return this.projection.project(p)},unproject:function(p){return this.projection.unproject(p)},scale:function(p){return 256*Math.pow(2,p)},zoom:function(p){return Math.log(p/256)/Math.LN2},getProjectedBounds:function(p){if(this.infinite)return null;var T=this.projection.bounds,U=this.scale(p),se=this.transformation.transform(T.min,U),Pe=this.transformation.transform(T.max,U);return new pt(se,Pe)},infinite:!1,wrapLatLng:function(p){var T=this.wrapLng?_(p.lng,this.wrapLng,!0):p.lng,U=this.wrapLat?_(p.lat,this.wrapLat,!0):p.lat,se=p.alt;return new Ve(U,T,se)},wrapLatLngBounds:function(p){var T=p.getCenter(),U=this.wrapLatLng(T),se=T.lat-U.lat,Pe=T.lng-U.lng;if(se===0&&Pe===0)return p;var nt=p.getSouthWest(),Jt=p.getNorthEast(),Dn=new Ve(nt.lat-se,nt.lng-Pe),Jn=new Ve(Jt.lat-se,Jt.lng-Pe);return new Ie(Dn,Jn)}},Mt=i({},lt,{wrapLng:[-180,180],R:6371e3,distance:function(p,T){var U=Math.PI/180,se=p.lat*U,Pe=T.lat*U,nt=Math.sin((T.lat-p.lat)*U/2),Jt=Math.sin((T.lng-p.lng)*U/2),Dn=nt*nt+Math.cos(se)*Math.cos(Pe)*Jt*Jt,Jn=2*Math.atan2(Math.sqrt(Dn),Math.sqrt(1-Dn));return this.R*Jn}}),wt=6378137,rn={R:wt,MAX_LATITUDE:85.0511287798,project:function(p){var T=Math.PI/180,U=this.MAX_LATITUDE,se=Math.max(Math.min(U,p.lat),-U),Pe=Math.sin(se*T);return new Le(this.R*p.lng*T,this.R*Math.log((1+Pe)/(1-Pe))/2)},unproject:function(p){var T=180/Math.PI;return new Ve((2*Math.atan(Math.exp(p.y/this.R))-Math.PI/2)*T,p.x*T/this.R)},bounds:function(){var p=wt*Math.PI;return new pt([-p,-p],[p,p])}()};function yn(p,T,U,se){if(Q(p)){this._a=p[0],this._b=p[1],this._c=p[2],this._d=p[3];return}this._a=p,this._b=T,this._c=U,this._d=se}yn.prototype={transform:function(p,T){return this._transform(p.clone(),T)},_transform:function(p,T){return T=T||1,p.x=T*(this._a*p.x+this._b),p.y=T*(this._c*p.y+this._d),p},untransform:function(p,T){return T=T||1,new Le((p.x/T-this._b)/this._a,(p.y/T-this._d)/this._c)}};function Pn(p,T,U,se){return new yn(p,T,U,se)}var De=i({},Mt,{code:"EPSG:3857",projection:rn,transformation:function(){var p=.5/(Math.PI*rn.R);return Pn(p,.5,-p,.5)}()}),Ae=i({},De,{code:"EPSG:900913"});function Be(p){return document.createElementNS("http://www.w3.org/2000/svg",p)}function Ce(p,T){var U="",se,Pe,nt,Jt,Dn,Jn;for(se=0,nt=p.length;se<nt;se++){for(Dn=p[se],Pe=0,Jt=Dn.length;Pe<Jt;Pe++)Jn=Dn[Pe],U+=(Pe?"L":"M")+Jn.x+" "+Jn.y;U+=T?Cn.svg?"z":"x":""}return U||"M0 0"}var ot=document.documentElement.style,Dt="ActiveXObject"in window,Zt=Dt&&!document.addEventListener,an="msLaunchUri"in navigator&&!("documentMode"in document),ln=vr("webkit"),vn=vr("android"),qn=vr("android 2")||vr("android 3"),Kn=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),cr=vn&&vr("Google")&&Kn<537&&!("AudioNode"in window),pr=!!window.opera,Dr=!an&&vr("chrome"),zr=vr("gecko")&&!ln&&!pr&&!Dt,Ht=!Dr&&vr("safari"),tn=vr("phantom"),Kt="OTransition"in ot,Yn=navigator.platform.indexOf("Win")===0,ir=Dt&&"transition"in ot,Fr="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!qn,Ft="MozPerspective"in ot,je=!window.L_DISABLE_3D&&(ir||Fr||Ft)&&!Kt&&!tn,Ze=typeof orientation<"u"||vr("mobile"),et=Ze&&ln,ct=Ze&&Fr,$e=!window.PointerEvent&&window.MSPointerEvent,Gt=!!(window.PointerEvent||$e),hn="ontouchstart"in window||!!window.TouchEvent,Ot=!window.L_NO_TOUCH&&(hn||Gt),cn=Ze&&pr,En=Ze&&zr,wn=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Qn=function(){var p=!1;try{var T=Object.defineProperty({},"passive",{get:function(){p=!0}});window.addEventListener("testPassiveEventSupport",w,T),window.removeEventListener("testPassiveEventSupport",w,T)}catch{}return p}(),Lr=function(){return!!document.createElement("canvas").getContext}(),Yt=!!(document.createElementNS&&Be("svg").createSVGRect),vt=!!Yt&&function(){var p=document.createElement("div");return p.innerHTML="<svg/>",(p.firstChild&&p.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Tn=!Yt&&function(){try{var p=document.createElement("div");p.innerHTML='<v:shape adj="1"/>';var T=p.firstChild;return T.style.behavior="url(#default#VML)",T&&typeof T.adj=="object"}catch{return!1}}(),bn=navigator.platform.indexOf("Mac")===0,br=navigator.platform.indexOf("Linux")===0;function vr(p){return navigator.userAgent.toLowerCase().indexOf(p)>=0}var Cn={ie:Dt,ielt9:Zt,edge:an,webkit:ln,android:vn,android23:qn,androidStock:cr,opera:pr,chrome:Dr,gecko:zr,safari:Ht,phantom:tn,opera12:Kt,win:Yn,ie3d:ir,webkit3d:Fr,gecko3d:Ft,any3d:je,mobile:Ze,mobileWebkit:et,mobileWebkit3d:ct,msPointer:$e,pointer:Gt,touch:Ot,touchNative:hn,mobileOpera:cn,mobileGecko:En,retina:wn,passiveEvents:Qn,canvas:Lr,svg:Yt,vml:Tn,inlineSvg:vt,mac:bn,linux:br},pn=Cn.msPointer?"MSPointerDown":"pointerdown",Ut=Cn.msPointer?"MSPointerMove":"pointermove",Hn=Cn.msPointer?"MSPointerUp":"pointerup",or=Cn.msPointer?"MSPointerCancel":"pointercancel",Xr={touchstart:pn,touchmove:Ut,touchend:Hn,touchcancel:or},ri={touchstart:ao,touchmove:ns,touchend:ns,touchcancel:ns},ai={},Pr=!1;function As(p,T,U){return T==="touchstart"&&Yi(),ri[T]?(U=ri[T].bind(this,U),p.addEventListener(Xr[T],U,!1),U):(console.warn("wrong event specified:",T),w)}function $i(p,T,U){if(!Xr[T]){console.warn("wrong event specified:",T);return}p.removeEventListener(Xr[T],U,!1)}function Qa(p){ai[p.pointerId]=p}function pi(p){ai[p.pointerId]&&(ai[p.pointerId]=p)}function Li(p){delete ai[p.pointerId]}function Yi(){Pr||(document.addEventListener(pn,Qa,!0),document.addEventListener(Ut,pi,!0),document.addEventListener(Hn,Li,!0),document.addEventListener(or,Li,!0),Pr=!0)}function ns(p,T){if(T.pointerType!==(T.MSPOINTER_TYPE_MOUSE||"mouse")){T.touches=[];for(var U in ai)T.touches.push(ai[U]);T.changedTouches=[T],p(T)}}function ao(p,T){T.MSPOINTER_TYPE_TOUCH&&T.pointerType===T.MSPOINTER_TYPE_TOUCH&&Nr(T),ns(p,T)}function wc(p){var T={},U,se;for(se in p)U=p[se],T[se]=U&&U.bind?U.bind(p):U;return p=T,T.type="dblclick",T.detail=2,T.isTrusted=!1,T._simulated=!0,T}var Wu=200;function el(p,T){p.addEventListener("dblclick",T);var U=0,se;function Pe(nt){if(nt.detail!==1){se=nt.detail;return}if(!(nt.pointerType==="mouse"||nt.sourceCapabilities&&!nt.sourceCapabilities.firesTouchEvents)){var Jt=Oi(nt);if(!(Jt.some(function(Jn){return Jn instanceof HTMLLabelElement&&Jn.attributes.for})&&!Jt.some(function(Jn){return Jn instanceof HTMLInputElement||Jn instanceof HTMLSelectElement}))){var Dn=Date.now();Dn-U<=Wu?(se++,se===2&&T(wc(nt))):se=1,U=Dn}}}return p.addEventListener("click",Pe),{dblclick:T,simDblclick:Pe}}function Au(p,T){p.removeEventListener("dblclick",T.dblclick),p.removeEventListener("click",T.simDblclick)}var Zu=yl(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Ku=yl(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Cc=Ku==="webkitTransition"||Ku==="OTransition"?Ku+"End":"transitionend";function Yu(p){return typeof p=="string"?document.getElementById(p):p}function ja(p,T){var U=p.style[T]||p.currentStyle&&p.currentStyle[T];if((!U||U==="auto")&&document.defaultView){var se=document.defaultView.getComputedStyle(p,null);U=se?se[T]:null}return U==="auto"?null:U}function ds(p,T,U){var se=document.createElement(p);return se.className=T||"",U&&U.appendChild(se),se}function Di(p){var T=p.parentNode;T&&T.removeChild(p)}function Xu(p){for(;p.firstChild;)p.removeChild(p.firstChild)}function lu(p){var T=p.parentNode;T&&T.lastChild!==p&&T.appendChild(p)}function gl(p){var T=p.parentNode;T&&T.firstChild!==p&&T.insertBefore(p,T.firstChild)}function Ju(p,T){if(p.classList!==void 0)return p.classList.contains(T);var U=Bo(p);return U.length>0&&new RegExp("(^|\\s)"+T+"(\\s|$)").test(U)}function ki(p,T){if(p.classList!==void 0)for(var U=R(T),se=0,Pe=U.length;se<Pe;se++)p.classList.add(U[se]);else if(!Ju(p,T)){var nt=Bo(p);Ua(p,(nt?nt+" ":"")+T)}}function is(p,T){p.classList!==void 0?p.classList.remove(T):Ua(p,C((" "+Bo(p)+" ").replace(" "+T+" "," ")))}function Ua(p,T){p.className.baseVal===void 0?p.className=T:p.className.baseVal=T}function Bo(p){return p.correspondingElement&&(p=p.correspondingElement),p.className.baseVal===void 0?p.className:p.className.baseVal}function Co(p,T){"opacity"in p.style?p.style.opacity=T:"filter"in p.style&&ku(p,T)}function ku(p,T){var U=!1,se="DXImageTransform.Microsoft.Alpha";try{U=p.filters.item(se)}catch{if(T===1)return}T=Math.round(T*100),U?(U.Enabled=T!==100,U.Opacity=T):p.style.filter+=" progid:"+se+"(opacity="+T+")"}function yl(p){for(var T=document.documentElement.style,U=0;U<p.length;U++)if(p[U]in T)return p[U];return!1}function uu(p,T,U){var se=T||new Le(0,0);p.style[Zu]=(Cn.ie3d?"translate("+se.x+"px,"+se.y+"px)":"translate3d("+se.x+"px,"+se.y+"px,0)")+(U?" scale("+U+")":"")}function lo(p,T){p._leaflet_pos=T,Cn.any3d?uu(p,T):(p.style.left=T.x+"px",p.style.top=T.y+"px")}function So(p){return p._leaflet_pos||new Le(0,0)}var tl,ui,ji;if("onselectstart"in document)tl=function(){Mi(window,"selectstart",Nr)},ui=function(){Bi(window,"selectstart",Nr)};else{var nl=yl(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);tl=function(){if(nl){var p=document.documentElement.style;ji=p[nl],p[nl]="none"}},ui=function(){nl&&(document.documentElement.style[nl]=ji,ji=void 0)}}function rl(){Mi(window,"dragstart",Nr)}function Ws(){Bi(window,"dragstart",Nr)}var Zs,Ms;function cu(p){for(;p.tabIndex===-1;)p=p.parentNode;p.style&&(us(),Zs=p,Ms=p.style.outlineStyle,p.style.outlineStyle="none",Mi(window,"keydown",us))}function us(){Zs&&(Zs.style.outlineStyle=Ms,Zs=void 0,Ms=void 0,Bi(window,"keydown",us))}function La(p){do p=p.parentNode;while((!p.offsetWidth||!p.offsetHeight)&&p!==document.body);return p}function Lo(p){var T=p.getBoundingClientRect();return{x:T.width/p.offsetWidth||1,y:T.height/p.offsetHeight||1,boundingClientRect:T}}var yi={__proto__:null,TRANSFORM:Zu,TRANSITION:Ku,TRANSITION_END:Cc,get:Yu,getStyle:ja,create:ds,remove:Di,empty:Xu,toFront:lu,toBack:gl,hasClass:Ju,addClass:ki,removeClass:is,setClass:Ua,getClass:Bo,setOpacity:Co,testProp:yl,setTransform:uu,setPosition:lo,getPosition:So,get disableTextSelection(){return tl},get enableTextSelection(){return ui},disableImageDrag:rl,enableImageDrag:Ws,preventOutline:cu,restoreOutline:us,getSizedParentNode:La,getScale:Lo};function Mi(p,T,U,se){if(T&&typeof T=="object")for(var Pe in T)No(p,Pe,T[Pe],U);else{T=R(T);for(var nt=0,Jt=T.length;nt<Jt;nt++)No(p,T[nt],U,se)}return this}var fs="_leaflet_events";function Bi(p,T,U,se){if(arguments.length===1)Bl(p),delete p[fs];else if(T&&typeof T=="object")for(var Pe in T)Pa(p,Pe,T[Pe],U);else if(T=R(T),arguments.length===2)Bl(p,function(Dn){return oe(T,Dn)!==-1});else for(var nt=0,Jt=T.length;nt<Jt;nt++)Pa(p,T[nt],U,se);return this}function Bl(p,T){for(var U in p[fs]){var se=U.split(/\d/)[0];(!T||T(se))&&Pa(p,se,null,null,U)}}var Nl={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function No(p,T,U,se){var Pe=T+f(U)+(se?"_"+f(se):"");if(p[fs]&&p[fs][Pe])return this;var nt=function(Dn){return U.call(se||p,Dn||window.event)},Jt=nt;!Cn.touchNative&&Cn.pointer&&T.indexOf("touch")===0?nt=As(p,T,nt):Cn.touch&&T==="dblclick"?nt=el(p,nt):"addEventListener"in p?T==="touchstart"||T==="touchmove"||T==="wheel"||T==="mousewheel"?p.addEventListener(Nl[T]||T,nt,Cn.passiveEvents?{passive:!1}:!1):T==="mouseenter"||T==="mouseleave"?(nt=function(Dn){Dn=Dn||window.event,du(p,Dn)&&Jt(Dn)},p.addEventListener(Nl[T],nt,!1)):p.addEventListener(T,Jt,!1):p.attachEvent("on"+T,nt),p[fs]=p[fs]||{},p[fs][Pe]=nt}function Pa(p,T,U,se,Pe){Pe=Pe||T+f(U)+(se?"_"+f(se):"");var nt=p[fs]&&p[fs][Pe];if(!nt)return this;!Cn.touchNative&&Cn.pointer&&T.indexOf("touch")===0?$i(p,T,nt):Cn.touch&&T==="dblclick"?Au(p,nt):"removeEventListener"in p?p.removeEventListener(Nl[T]||T,nt,!1):p.detachEvent("on"+T,nt),p[fs][Pe]=null}function qi(p){return p.stopPropagation?p.stopPropagation():p.originalEvent?p.originalEvent._stopped=!0:p.cancelBubble=!0,this}function Sc(p){return No(p,"wheel",qi),this}function Gi(p){return Mi(p,"mousedown touchstart dblclick contextmenu",qi),p._leaflet_disable_click=!0,this}function Nr(p){return p.preventDefault?p.preventDefault():p.returnValue=!1,this}function Fi(p){return Nr(p),qi(p),this}function Oi(p){if(p.composedPath)return p.composedPath();for(var T=[],U=p.target;U;)T.push(U),U=U.parentNode;return T}function hc(p,T){if(!T)return new Le(p.clientX,p.clientY);var U=Lo(T),se=U.boundingClientRect;return new Le((p.clientX-se.left)/U.x-T.clientLeft,(p.clientY-se.top)/U.y-T.clientTop)}var ua=Cn.linux&&Cn.chrome?window.devicePixelRatio:Cn.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function hu(p){return Cn.edge?p.wheelDeltaY/2:p.deltaY&&p.deltaMode===0?-p.deltaY/ua:p.deltaY&&p.deltaMode===1?-p.deltaY*20:p.deltaY&&p.deltaMode===2?-p.deltaY*60:p.deltaX||p.deltaZ?0:p.wheelDelta?(p.wheelDeltaY||p.wheelDelta)/2:p.detail&&Math.abs(p.detail)<32765?-p.detail*20:p.detail?p.detail/-32765*60:0}function du(p,T){var U=T.relatedTarget;if(!U)return!0;try{for(;U&&U!==p;)U=U.parentNode}catch{return!1}return U!==p}var Iu={__proto__:null,on:Mi,off:Bi,stopPropagation:qi,disableScrollPropagation:Sc,disableClickPropagation:Gi,preventDefault:Nr,stop:Fi,getPropagationPath:Oi,getMousePosition:hc,getWheelDelta:hu,isExternalTarget:du,addListener:Mi,removeListener:Bi},fu=Se.extend({run:function(p,T,U,se){this.stop(),this._el=p,this._inProgress=!0,this._duration=U||.25,this._easeOutPower=1/Math.max(se||.5,.2),this._startPos=So(p),this._offset=T.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=he(this._animate,this),this._step()},_step:function(p){var T=+new Date-this._startTime,U=this._duration*1e3;T<U?this._runFrame(this._easeOut(T/U),p):(this._runFrame(1),this._complete())},_runFrame:function(p,T){var U=this._startPos.add(this._offset.multiplyBy(p));T&&U._round(),lo(this._el,U),this.fire("step")},_complete:function(){de(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(p){return 1-Math.pow(1-p,this._easeOutPower)}}),Hi=Se.extend({options:{crs:De,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(p,T){T=z(this,T),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(p),this._initLayout(),this._onResize=a(this._onResize,this),this._initEvents(),T.maxBounds&&this.setMaxBounds(T.maxBounds),T.zoom!==void 0&&(this._zoom=this._limitZoom(T.zoom)),T.center&&T.zoom!==void 0&&this.setView(it(T.center),T.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Ku&&Cn.any3d&&!Cn.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Mi(this._proxy,Cc,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(p,T,U){if(T=T===void 0?this._zoom:this._limitZoom(T),p=this._limitCenter(it(p),T,this.options.maxBounds),U=U||{},this._stop(),this._loaded&&!U.reset&&U!==!0){U.animate!==void 0&&(U.zoom=i({animate:U.animate},U.zoom),U.pan=i({animate:U.animate,duration:U.duration},U.pan));var se=this._zoom!==T?this._tryAnimatedZoom&&this._tryAnimatedZoom(p,T,U.zoom):this._tryAnimatedPan(p,U.pan);if(se)return clearTimeout(this._sizeTimer),this}return this._resetView(p,T,U.pan&&U.pan.noMoveStart),this},setZoom:function(p,T){return this._loaded?this.setView(this.getCenter(),p,{zoom:T}):(this._zoom=p,this)},zoomIn:function(p,T){return p=p||(Cn.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+p,T)},zoomOut:function(p,T){return p=p||(Cn.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-p,T)},setZoomAround:function(p,T,U){var se=this.getZoomScale(T),Pe=this.getSize().divideBy(2),nt=p instanceof Le?p:this.latLngToContainerPoint(p),Jt=nt.subtract(Pe).multiplyBy(1-1/se),Dn=this.containerPointToLatLng(Pe.add(Jt));return this.setView(Dn,T,{zoom:U})},_getBoundsCenterZoom:function(p,T){T=T||{},p=p.getBounds?p.getBounds():Ne(p);var U=He(T.paddingTopLeft||T.padding||[0,0]),se=He(T.paddingBottomRight||T.padding||[0,0]),Pe=this.getBoundsZoom(p,!1,U.add(se));if(Pe=typeof T.maxZoom=="number"?Math.min(T.maxZoom,Pe):Pe,Pe===1/0)return{center:p.getCenter(),zoom:Pe};var nt=se.subtract(U).divideBy(2),Jt=this.project(p.getSouthWest(),Pe),Dn=this.project(p.getNorthEast(),Pe),Jn=this.unproject(Jt.add(Dn).divideBy(2).add(nt),Pe);return{center:Jn,zoom:Pe}},fitBounds:function(p,T){if(p=Ne(p),!p.isValid())throw new Error("Bounds are not valid.");var U=this._getBoundsCenterZoom(p,T);return this.setView(U.center,U.zoom,T)},fitWorld:function(p){return this.fitBounds([[-90,-180],[90,180]],p)},panTo:function(p,T){return this.setView(p,this._zoom,{pan:T})},panBy:function(p,T){if(p=He(p).round(),T=T||{},!p.x&&!p.y)return this.fire("moveend");if(T.animate!==!0&&!this.getSize().contains(p))return this._resetView(this.unproject(this.project(this.getCenter()).add(p)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new fu,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),T.noMoveStart||this.fire("movestart"),T.animate!==!1){ki(this._mapPane,"leaflet-pan-anim");var U=this._getMapPanePos().subtract(p).round();this._panAnim.run(this._mapPane,U,T.duration||.25,T.easeLinearity)}else this._rawPanBy(p),this.fire("move").fire("moveend");return this},flyTo:function(p,T,U){if(U=U||{},U.animate===!1||!Cn.any3d)return this.setView(p,T,U);this._stop();var se=this.project(this.getCenter()),Pe=this.project(p),nt=this.getSize(),Jt=this._zoom;p=it(p),T=T===void 0?Jt:T;var Dn=Math.max(nt.x,nt.y),Jn=Dn*this.getZoomScale(Jt,T),ar=Pe.distanceTo(se)||1,Vr=1.42,Jr=Vr*Vr;function Vi(xs){var ia=xs?-1:1,dt=xs?Jn:Dn,ka=Jn*Jn-Dn*Dn+ia*Jr*Jr*ar*ar,Vc=2*dt*Jr*ar,qo=ka/Vc,Ni=Math.sqrt(qo*qo+1)-qo,ec=Ni<1e-9?-18:Math.log(Ni);return ec}function vo(xs){return(Math.exp(xs)-Math.exp(-xs))/2}function Js(xs){return(Math.exp(xs)+Math.exp(-xs))/2}function so(xs){return vo(xs)/Js(xs)}var Ss=Vi(0);function ma(xs){return Dn*(Js(Ss)/Js(Ss+Vr*xs))}function lh(xs){return Dn*(Js(Ss)*so(Ss+Vr*xs)-vo(Ss))/Jr}function Cl(xs){return 1-Math.pow(1-xs,1.5)}var Sl=Date.now(),qa=(Vi(1)-Ss)/Vr,Xh=U.duration?1e3*U.duration:1e3*qa*.8;function Aa(){var xs=(Date.now()-Sl)/Xh,ia=Cl(xs)*qa;xs<=1?(this._flyToFrame=he(Aa,this),this._move(this.unproject(se.add(Pe.subtract(se).multiplyBy(lh(ia)/ar)),Jt),this.getScaleZoom(Dn/ma(ia),Jt),{flyTo:!0})):this._move(p,T)._moveEnd(!0)}return this._moveStart(!0,U.noMoveStart),Aa.call(this),this},flyToBounds:function(p,T){var U=this._getBoundsCenterZoom(p,T);return this.flyTo(U.center,U.zoom,T)},setMaxBounds:function(p){return p=Ne(p),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),p.isValid()?(this.options.maxBounds=p,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(p){var T=this.options.minZoom;return this.options.minZoom=p,this._loaded&&T!==p&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(p):this},setMaxZoom:function(p){var T=this.options.maxZoom;return this.options.maxZoom=p,this._loaded&&T!==p&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(p):this},panInsideBounds:function(p,T){this._enforcingBounds=!0;var U=this.getCenter(),se=this._limitCenter(U,this._zoom,Ne(p));return U.equals(se)||this.panTo(se,T),this._enforcingBounds=!1,this},panInside:function(p,T){T=T||{};var U=He(T.paddingTopLeft||T.padding||[0,0]),se=He(T.paddingBottomRight||T.padding||[0,0]),Pe=this.project(this.getCenter()),nt=this.project(p),Jt=this.getPixelBounds(),Dn=ge([Jt.min.add(U),Jt.max.subtract(se)]),Jn=Dn.getSize();if(!Dn.contains(nt)){this._enforcingBounds=!0;var ar=nt.subtract(Dn.getCenter()),Vr=Dn.extend(nt).getSize().subtract(Jn);Pe.x+=ar.x<0?-Vr.x:Vr.x,Pe.y+=ar.y<0?-Vr.y:Vr.y,this.panTo(this.unproject(Pe),T),this._enforcingBounds=!1}return this},invalidateSize:function(p){if(!this._loaded)return this;p=i({animate:!1,pan:!0},p===!0?{animate:!0}:p);var T=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var U=this.getSize(),se=T.divideBy(2).round(),Pe=U.divideBy(2).round(),nt=se.subtract(Pe);return!nt.x&&!nt.y?this:(p.animate&&p.pan?this.panBy(nt):(p.pan&&this._rawPanBy(nt),this.fire("move"),p.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(a(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:T,newSize:U}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(p){if(p=this._locateOptions=i({timeout:1e4,watch:!1},p),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var T=a(this._handleGeolocationResponse,this),U=a(this._handleGeolocationError,this);return p.watch?this._locationWatchId=navigator.geolocation.watchPosition(T,U,p):navigator.geolocation.getCurrentPosition(T,U,p),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(p){if(this._container._leaflet_id){var T=p.code,U=p.message||(T===1?"permission denied":T===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:T,message:"Geolocation error: "+U+"."})}},_handleGeolocationResponse:function(p){if(this._container._leaflet_id){var T=p.coords.latitude,U=p.coords.longitude,se=new Ve(T,U),Pe=se.toBounds(p.coords.accuracy*2),nt=this._locateOptions;if(nt.setView){var Jt=this.getBoundsZoom(Pe);this.setView(se,nt.maxZoom?Math.min(Jt,nt.maxZoom):Jt)}var Dn={latlng:se,bounds:Pe,timestamp:p.timestamp};for(var Jn in p.coords)typeof p.coords[Jn]=="number"&&(Dn[Jn]=p.coords[Jn]);this.fire("locationfound",Dn)}},addHandler:function(p,T){if(!T)return this;var U=this[p]=new T(this);return this._handlers.push(U),this.options[p]&&U.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Di(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(de(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var p;for(p in this._layers)this._layers[p].remove();for(p in this._panes)Di(this._panes[p]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(p,T){var U="leaflet-pane"+(p?" leaflet-"+p.replace("Pane","")+"-pane":""),se=ds("div",U,T||this._mapPane);return p&&(this._panes[p]=se),se},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var p=this.getPixelBounds(),T=this.unproject(p.getBottomLeft()),U=this.unproject(p.getTopRight());return new Ie(T,U)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(p,T,U){p=Ne(p),U=He(U||[0,0]);var se=this.getZoom()||0,Pe=this.getMinZoom(),nt=this.getMaxZoom(),Jt=p.getNorthWest(),Dn=p.getSouthEast(),Jn=this.getSize().subtract(U),ar=ge(this.project(Dn,se),this.project(Jt,se)).getSize(),Vr=Cn.any3d?this.options.zoomSnap:1,Jr=Jn.x/ar.x,Vi=Jn.y/ar.y,vo=T?Math.max(Jr,Vi):Math.min(Jr,Vi);return se=this.getScaleZoom(vo,se),Vr&&(se=Math.round(se/(Vr/100))*(Vr/100),se=T?Math.ceil(se/Vr)*Vr:Math.floor(se/Vr)*Vr),Math.max(Pe,Math.min(nt,se))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Le(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(p,T){var U=this._getTopLeftPoint(p,T);return new pt(U,U.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(p){return this.options.crs.getProjectedBounds(p===void 0?this.getZoom():p)},getPane:function(p){return typeof p=="string"?this._panes[p]:p},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(p,T){var U=this.options.crs;return T=T===void 0?this._zoom:T,U.scale(p)/U.scale(T)},getScaleZoom:function(p,T){var U=this.options.crs;T=T===void 0?this._zoom:T;var se=U.zoom(p*U.scale(T));return isNaN(se)?1/0:se},project:function(p,T){return T=T===void 0?this._zoom:T,this.options.crs.latLngToPoint(it(p),T)},unproject:function(p,T){return T=T===void 0?this._zoom:T,this.options.crs.pointToLatLng(He(p),T)},layerPointToLatLng:function(p){var T=He(p).add(this.getPixelOrigin());return this.unproject(T)},latLngToLayerPoint:function(p){var T=this.project(it(p))._round();return T._subtract(this.getPixelOrigin())},wrapLatLng:function(p){return this.options.crs.wrapLatLng(it(p))},wrapLatLngBounds:function(p){return this.options.crs.wrapLatLngBounds(Ne(p))},distance:function(p,T){return this.options.crs.distance(it(p),it(T))},containerPointToLayerPoint:function(p){return He(p).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(p){return He(p).add(this._getMapPanePos())},containerPointToLatLng:function(p){var T=this.containerPointToLayerPoint(He(p));return this.layerPointToLatLng(T)},latLngToContainerPoint:function(p){return this.layerPointToContainerPoint(this.latLngToLayerPoint(it(p)))},mouseEventToContainerPoint:function(p){return hc(p,this._container)},mouseEventToLayerPoint:function(p){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(p))},mouseEventToLatLng:function(p){return this.layerPointToLatLng(this.mouseEventToLayerPoint(p))},_initContainer:function(p){var T=this._container=Yu(p);if(T){if(T._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Mi(T,"scroll",this._onScroll,this),this._containerId=f(T)},_initLayout:function(){var p=this._container;this._fadeAnimated=this.options.fadeAnimation&&Cn.any3d,ki(p,"leaflet-container"+(Cn.touch?" leaflet-touch":"")+(Cn.retina?" leaflet-retina":"")+(Cn.ielt9?" leaflet-oldie":"")+(Cn.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var T=ja(p,"position");T!=="absolute"&&T!=="relative"&&T!=="fixed"&&T!=="sticky"&&(p.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var p=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),lo(this._mapPane,new Le(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ki(p.markerPane,"leaflet-zoom-hide"),ki(p.shadowPane,"leaflet-zoom-hide"))},_resetView:function(p,T,U){lo(this._mapPane,new Le(0,0));var se=!this._loaded;this._loaded=!0,T=this._limitZoom(T),this.fire("viewprereset");var Pe=this._zoom!==T;this._moveStart(Pe,U)._move(p,T)._moveEnd(Pe),this.fire("viewreset"),se&&this.fire("load")},_moveStart:function(p,T){return p&&this.fire("zoomstart"),T||this.fire("movestart"),this},_move:function(p,T,U,se){T===void 0&&(T=this._zoom);var Pe=this._zoom!==T;return this._zoom=T,this._lastCenter=p,this._pixelOrigin=this._getNewPixelOrigin(p),se?U&&U.pinch&&this.fire("zoom",U):((Pe||U&&U.pinch)&&this.fire("zoom",U),this.fire("move",U)),this},_moveEnd:function(p){return p&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return de(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(p){lo(this._mapPane,this._getMapPanePos().subtract(p))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(p){this._targets={},this._targets[f(this._container)]=this;var T=p?Bi:Mi;T(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&T(window,"resize",this._onResize,this),Cn.any3d&&this.options.transform3DLimit&&(p?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){de(this._resizeRequest),this._resizeRequest=he(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var p=this._getMapPanePos();Math.max(Math.abs(p.x),Math.abs(p.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(p,T){for(var U=[],se,Pe=T==="mouseout"||T==="mouseover",nt=p.target||p.srcElement,Jt=!1;nt;){if(se=this._targets[f(nt)],se&&(T==="click"||T==="preclick")&&this._draggableMoved(se)){Jt=!0;break}if(se&&se.listens(T,!0)&&(Pe&&!du(nt,p)||(U.push(se),Pe))||nt===this._container)break;nt=nt.parentNode}return!U.length&&!Jt&&!Pe&&this.listens(T,!0)&&(U=[this]),U},_isClickDisabled:function(p){for(;p&&p!==this._container;){if(p._leaflet_disable_click)return!0;p=p.parentNode}},_handleDOMEvent:function(p){var T=p.target||p.srcElement;if(!(!this._loaded||T._leaflet_disable_events||p.type==="click"&&this._isClickDisabled(T))){var U=p.type;U==="mousedown"&&cu(T),this._fireDOMEvent(p,U)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(p,T,U){if(p.type==="click"){var se=i({},p);se.type="preclick",this._fireDOMEvent(se,se.type,U)}var Pe=this._findEventTargets(p,T);if(U){for(var nt=[],Jt=0;Jt<U.length;Jt++)U[Jt].listens(T,!0)&&nt.push(U[Jt]);Pe=nt.concat(Pe)}if(Pe.length){T==="contextmenu"&&Nr(p);var Dn=Pe[0],Jn={originalEvent:p};if(p.type!=="keypress"&&p.type!=="keydown"&&p.type!=="keyup"){var ar=Dn.getLatLng&&(!Dn._radius||Dn._radius<=10);Jn.containerPoint=ar?this.latLngToContainerPoint(Dn.getLatLng()):this.mouseEventToContainerPoint(p),Jn.layerPoint=this.containerPointToLayerPoint(Jn.containerPoint),Jn.latlng=ar?Dn.getLatLng():this.layerPointToLatLng(Jn.layerPoint)}for(Jt=0;Jt<Pe.length;Jt++)if(Pe[Jt].fire(T,Jn,!0),Jn.originalEvent._stopped||Pe[Jt].options.bubblingMouseEvents===!1&&oe(this._mouseEvents,T)!==-1)return}},_draggableMoved:function(p){return p=p.dragging&&p.dragging.enabled()?p:this,p.dragging&&p.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var p=0,T=this._handlers.length;p<T;p++)this._handlers[p].disable()},whenReady:function(p,T){return this._loaded?p.call(T||this,{target:this}):this.on("load",p,T),this},_getMapPanePos:function(){return So(this._mapPane)||new Le(0,0)},_moved:function(){var p=this._getMapPanePos();return p&&!p.equals([0,0])},_getTopLeftPoint:function(p,T){var U=p&&T!==void 0?this._getNewPixelOrigin(p,T):this.getPixelOrigin();return U.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(p,T){var U=this.getSize()._divideBy(2);return this.project(p,T)._subtract(U)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(p,T,U){var se=this._getNewPixelOrigin(U,T);return this.project(p,T)._subtract(se)},_latLngBoundsToNewLayerBounds:function(p,T,U){var se=this._getNewPixelOrigin(U,T);return ge([this.project(p.getSouthWest(),T)._subtract(se),this.project(p.getNorthWest(),T)._subtract(se),this.project(p.getSouthEast(),T)._subtract(se),this.project(p.getNorthEast(),T)._subtract(se)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(p){return this.latLngToLayerPoint(p).subtract(this._getCenterLayerPoint())},_limitCenter:function(p,T,U){if(!U)return p;var se=this.project(p,T),Pe=this.getSize().divideBy(2),nt=new pt(se.subtract(Pe),se.add(Pe)),Jt=this._getBoundsOffset(nt,U,T);return Math.abs(Jt.x)<=1&&Math.abs(Jt.y)<=1?p:this.unproject(se.add(Jt),T)},_limitOffset:function(p,T){if(!T)return p;var U=this.getPixelBounds(),se=new pt(U.min.add(p),U.max.add(p));return p.add(this._getBoundsOffset(se,T))},_getBoundsOffset:function(p,T,U){var se=ge(this.project(T.getNorthEast(),U),this.project(T.getSouthWest(),U)),Pe=se.min.subtract(p.min),nt=se.max.subtract(p.max),Jt=this._rebound(Pe.x,-nt.x),Dn=this._rebound(Pe.y,-nt.y);return new Le(Jt,Dn)},_rebound:function(p,T){return p+T>0?Math.round(p-T)/2:Math.max(0,Math.ceil(p))-Math.max(0,Math.floor(T))},_limitZoom:function(p){var T=this.getMinZoom(),U=this.getMaxZoom(),se=Cn.any3d?this.options.zoomSnap:1;return se&&(p=Math.round(p/se)*se),Math.max(T,Math.min(U,p))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){is(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(p,T){var U=this._getCenterOffset(p)._trunc();return(T&&T.animate)!==!0&&!this.getSize().contains(U)?!1:(this.panBy(U,T),!0)},_createAnimProxy:function(){var p=this._proxy=ds("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(p),this.on("zoomanim",function(T){var U=Zu,se=this._proxy.style[U];uu(this._proxy,this.project(T.center,T.zoom),this.getZoomScale(T.zoom,1)),se===this._proxy.style[U]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Di(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var p=this.getCenter(),T=this.getZoom();uu(this._proxy,this.project(p,T),this.getZoomScale(T,1))},_catchTransitionEnd:function(p){this._animatingZoom&&p.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(p,T,U){if(this._animatingZoom)return!0;if(U=U||{},!this._zoomAnimated||U.animate===!1||this._nothingToAnimate()||Math.abs(T-this._zoom)>this.options.zoomAnimationThreshold)return!1;var se=this.getZoomScale(T),Pe=this._getCenterOffset(p)._divideBy(1-1/se);return U.animate!==!0&&!this.getSize().contains(Pe)?!1:(he(function(){this._moveStart(!0,U.noMoveStart||!1)._animateZoom(p,T,!0)},this),!0)},_animateZoom:function(p,T,U,se){this._mapPane&&(U&&(this._animatingZoom=!0,this._animateToCenter=p,this._animateToZoom=T,ki(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:p,zoom:T,noUpdate:se}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(a(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&is(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Ks(p,T){return new Hi(p,T)}var di=be.extend({options:{position:"topright"},initialize:function(p){z(this,p)},getPosition:function(){return this.options.position},setPosition:function(p){var T=this._map;return T&&T.removeControl(this),this.options.position=p,T&&T.addControl(this),this},getContainer:function(){return this._container},addTo:function(p){this.remove(),this._map=p;var T=this._container=this.onAdd(p),U=this.getPosition(),se=p._controlCorners[U];return ki(T,"leaflet-control"),U.indexOf("bottom")!==-1?se.insertBefore(T,se.firstChild):se.appendChild(T),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Di(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(p){this._map&&p&&p.screenX>0&&p.screenY>0&&this._map.getContainer().focus()}}),ro=function(p){return new di(p)};Hi.include({addControl:function(p){return p.addTo(this),this},removeControl:function(p){return p.remove(),this},_initControlPos:function(){var p=this._controlCorners={},T="leaflet-",U=this._controlContainer=ds("div",T+"control-container",this._container);function se(Pe,nt){var Jt=T+Pe+" "+T+nt;p[Pe+nt]=ds("div",Jt,U)}se("top","left"),se("top","right"),se("bottom","left"),se("bottom","right")},_clearControlPos:function(){for(var p in this._controlCorners)Di(this._controlCorners[p]);Di(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var vl=di.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(p,T,U,se){return U<se?-1:se<U?1:0}},initialize:function(p,T,U){z(this,U),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var se in p)this._addLayer(p[se],se);for(se in T)this._addLayer(T[se],se,!0)},onAdd:function(p){this._initLayout(),this._update(),this._map=p,p.on("zoomend",this._checkDisabledLayers,this);for(var T=0;T<this._layers.length;T++)this._layers[T].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(p){return di.prototype.addTo.call(this,p),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var p=0;p<this._layers.length;p++)this._layers[p].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(p,T){return this._addLayer(p,T),this._map?this._update():this},addOverlay:function(p,T){return this._addLayer(p,T,!0),this._map?this._update():this},removeLayer:function(p){p.off("add remove",this._onLayerChange,this);var T=this._getLayer(f(p));return T&&this._layers.splice(this._layers.indexOf(T),1),this._map?this._update():this},expand:function(){ki(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var p=this._map.getSize().y-(this._container.offsetTop+50);return p<this._section.clientHeight?(ki(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=p+"px"):is(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return is(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var p="leaflet-control-layers",T=this._container=ds("div",p),U=this.options.collapsed;T.setAttribute("aria-haspopup",!0),Gi(T),Sc(T);var se=this._section=ds("section",p+"-list");U&&(this._map.on("click",this.collapse,this),Mi(T,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var Pe=this._layersLink=ds("a",p+"-toggle",T);Pe.href="#",Pe.title="Layers",Pe.setAttribute("role","button"),Mi(Pe,{keydown:function(nt){nt.keyCode===13&&this._expandSafely()},click:function(nt){Nr(nt),this._expandSafely()}},this),U||this.expand(),this._baseLayersList=ds("div",p+"-base",se),this._separator=ds("div",p+"-separator",se),this._overlaysList=ds("div",p+"-overlays",se),T.appendChild(se)},_getLayer:function(p){for(var T=0;T<this._layers.length;T++)if(this._layers[T]&&f(this._layers[T].layer)===p)return this._layers[T]},_addLayer:function(p,T,U){this._map&&p.on("add remove",this._onLayerChange,this),this._layers.push({layer:p,name:T,overlay:U}),this.options.sortLayers&&this._layers.sort(a(function(se,Pe){return this.options.sortFunction(se.layer,Pe.layer,se.name,Pe.name)},this)),this.options.autoZIndex&&p.setZIndex&&(this._lastZIndex++,p.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Xu(this._baseLayersList),Xu(this._overlaysList),this._layerControlInputs=[];var p,T,U,se,Pe=0;for(U=0;U<this._layers.length;U++)se=this._layers[U],this._addItem(se),T=T||se.overlay,p=p||!se.overlay,Pe+=se.overlay?0:1;return this.options.hideSingleBase&&(p=p&&Pe>1,this._baseLayersList.style.display=p?"":"none"),this._separator.style.display=T&&p?"":"none",this},_onLayerChange:function(p){this._handlingClick||this._update();var T=this._getLayer(f(p.target)),U=T.overlay?p.type==="add"?"overlayadd":"overlayremove":p.type==="add"?"baselayerchange":null;U&&this._map.fire(U,T)},_createRadioElement:function(p,T){var U='<input type="radio" class="leaflet-control-layers-selector" name="'+p+'"'+(T?' checked="checked"':"")+"/>",se=document.createElement("div");return se.innerHTML=U,se.firstChild},_addItem:function(p){var T=document.createElement("label"),U=this._map.hasLayer(p.layer),se;p.overlay?(se=document.createElement("input"),se.type="checkbox",se.className="leaflet-control-layers-selector",se.defaultChecked=U):se=this._createRadioElement("leaflet-base-layers_"+f(this),U),this._layerControlInputs.push(se),se.layerId=f(p.layer),Mi(se,"click",this._onInputClick,this);var Pe=document.createElement("span");Pe.innerHTML=" "+p.name;var nt=document.createElement("span");T.appendChild(nt),nt.appendChild(se),nt.appendChild(Pe);var Jt=p.overlay?this._overlaysList:this._baseLayersList;return Jt.appendChild(T),this._checkDisabledLayers(),T},_onInputClick:function(){if(!this._preventClick){var p=this._layerControlInputs,T,U,se=[],Pe=[];this._handlingClick=!0;for(var nt=p.length-1;nt>=0;nt--)T=p[nt],U=this._getLayer(T.layerId).layer,T.checked?se.push(U):T.checked||Pe.push(U);for(nt=0;nt<Pe.length;nt++)this._map.hasLayer(Pe[nt])&&this._map.removeLayer(Pe[nt]);for(nt=0;nt<se.length;nt++)this._map.hasLayer(se[nt])||this._map.addLayer(se[nt]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var p=this._layerControlInputs,T,U,se=this._map.getZoom(),Pe=p.length-1;Pe>=0;Pe--)T=p[Pe],U=this._getLayer(T.layerId).layer,T.disabled=U.options.minZoom!==void 0&&se<U.options.minZoom||U.options.maxZoom!==void 0&&se>U.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var p=this._section;this._preventClick=!0,Mi(p,"click",Nr),this.expand();var T=this;setTimeout(function(){Bi(p,"click",Nr),T._preventClick=!1})}}),Ys=function(p,T,U){return new vl(p,T,U)},Fs=di.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(p){var T="leaflet-control-zoom",U=ds("div",T+" leaflet-bar"),se=this.options;return this._zoomInButton=this._createButton(se.zoomInText,se.zoomInTitle,T+"-in",U,this._zoomIn),this._zoomOutButton=this._createButton(se.zoomOutText,se.zoomOutTitle,T+"-out",U,this._zoomOut),this._updateDisabled(),p.on("zoomend zoomlevelschange",this._updateDisabled,this),U},onRemove:function(p){p.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(p){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(p.shiftKey?3:1))},_zoomOut:function(p){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(p.shiftKey?3:1))},_createButton:function(p,T,U,se,Pe){var nt=ds("a",U,se);return nt.innerHTML=p,nt.href="#",nt.title=T,nt.setAttribute("role","button"),nt.setAttribute("aria-label",T),Gi(nt),Mi(nt,"click",Fi),Mi(nt,"click",Pe,this),Mi(nt,"click",this._refocusOnMap,this),nt},_updateDisabled:function(){var p=this._map,T="leaflet-disabled";is(this._zoomInButton,T),is(this._zoomOutButton,T),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||p._zoom===p.getMinZoom())&&(ki(this._zoomOutButton,T),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||p._zoom===p.getMaxZoom())&&(ki(this._zoomInButton,T),this._zoomInButton.setAttribute("aria-disabled","true"))}});Hi.mergeOptions({zoomControl:!0}),Hi.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Fs,this.addControl(this.zoomControl))});var Fo=function(p){return new Fs(p)},Ea=di.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(p){var T="leaflet-control-scale",U=ds("div",T),se=this.options;return this._addScales(se,T+"-line",U),p.on(se.updateWhenIdle?"moveend":"move",this._update,this),p.whenReady(this._update,this),U},onRemove:function(p){p.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(p,T,U){p.metric&&(this._mScale=ds("div",T,U)),p.imperial&&(this._iScale=ds("div",T,U))},_update:function(){var p=this._map,T=p.getSize().y/2,U=p.distance(p.containerPointToLatLng([0,T]),p.containerPointToLatLng([this.options.maxWidth,T]));this._updateScales(U)},_updateScales:function(p){this.options.metric&&p&&this._updateMetric(p),this.options.imperial&&p&&this._updateImperial(p)},_updateMetric:function(p){var T=this._getRoundNum(p),U=T<1e3?T+" m":T/1e3+" km";this._updateScale(this._mScale,U,T/p)},_updateImperial:function(p){var T=p*3.2808399,U,se,Pe;T>5280?(U=T/5280,se=this._getRoundNum(U),this._updateScale(this._iScale,se+" mi",se/U)):(Pe=this._getRoundNum(T),this._updateScale(this._iScale,Pe+" ft",Pe/T))},_updateScale:function(p,T,U){p.style.width=Math.round(this.options.maxWidth*U)+"px",p.innerHTML=T},_getRoundNum:function(p){var T=Math.pow(10,(Math.floor(p)+"").length-1),U=p/T;return U=U>=10?10:U>=5?5:U>=3?3:U>=2?2:1,T*U}}),vs=function(p){return new Ea(p)},pu='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Ma=di.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Cn.inlineSvg?pu+" ":"")+"Leaflet</a>"},initialize:function(p){z(this,p),this._attributions={}},onAdd:function(p){p.attributionControl=this,this._container=ds("div","leaflet-control-attribution"),Gi(this._container);for(var T in p._layers)p._layers[T].getAttribution&&this.addAttribution(p._layers[T].getAttribution());return this._update(),p.on("layeradd",this._addAttribution,this),this._container},onRemove:function(p){p.off("layeradd",this._addAttribution,this)},_addAttribution:function(p){p.layer.getAttribution&&(this.addAttribution(p.layer.getAttribution()),p.layer.once("remove",function(){this.removeAttribution(p.layer.getAttribution())},this))},setPrefix:function(p){return this.options.prefix=p,this._update(),this},addAttribution:function(p){return p?(this._attributions[p]||(this._attributions[p]=0),this._attributions[p]++,this._update(),this):this},removeAttribution:function(p){return p?(this._attributions[p]&&(this._attributions[p]--,this._update()),this):this},_update:function(){if(this._map){var p=[];for(var T in this._attributions)this._attributions[T]&&p.push(T);var U=[];this.options.prefix&&U.push(this.options.prefix),p.length&&U.push(p.join(", ")),this._container.innerHTML=U.join(' <span aria-hidden="true">|</span> ')}}});Hi.mergeOptions({attributionControl:!0}),Hi.addInitHook(function(){this.options.attributionControl&&new Ma().addTo(this)});var Qu=function(p){return new Ma(p)};di.Layers=vl,di.Zoom=Fs,di.Scale=Ea,di.Attribution=Ma,ro.layers=Ys,ro.zoom=Fo,ro.scale=vs,ro.attribution=Qu;var ss=be.extend({initialize:function(p){this._map=p},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ss.addTo=function(p,T){return p.addHandler(T,this),this};var Lc={Events:ne},Po=Cn.touch?"touchstart mousedown":"mousedown",Fl=Se.extend({options:{clickTolerance:3},initialize:function(p,T,U,se){z(this,se),this._element=p,this._dragStartTarget=T||p,this._preventOutline=U},enable:function(){this._enabled||(Mi(this._dragStartTarget,Po,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Fl._dragging===this&&this.finishDrag(!0),Bi(this._dragStartTarget,Po,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(p){if(this._enabled&&(this._moved=!1,!Ju(this._element,"leaflet-zoom-anim"))){if(p.touches&&p.touches.length!==1){Fl._dragging===this&&this.finishDrag();return}if(!(Fl._dragging||p.shiftKey||p.which!==1&&p.button!==1&&!p.touches)&&(Fl._dragging=this,this._preventOutline&&cu(this._element),rl(),tl(),!this._moving)){this.fire("down");var T=p.touches?p.touches[0]:p,U=La(this._element);this._startPoint=new Le(T.clientX,T.clientY),this._startPos=So(this._element),this._parentScale=Lo(U);var se=p.type==="mousedown";Mi(document,se?"mousemove":"touchmove",this._onMove,this),Mi(document,se?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(p){if(this._enabled){if(p.touches&&p.touches.length>1){this._moved=!0;return}var T=p.touches&&p.touches.length===1?p.touches[0]:p,U=new Le(T.clientX,T.clientY)._subtract(this._startPoint);!U.x&&!U.y||Math.abs(U.x)+Math.abs(U.y)<this.options.clickTolerance||(U.x/=this._parentScale.x,U.y/=this._parentScale.y,Nr(p),this._moved||(this.fire("dragstart"),this._moved=!0,ki(document.body,"leaflet-dragging"),this._lastTarget=p.target||p.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ki(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(U),this._moving=!0,this._lastEvent=p,this._updatePosition())}},_updatePosition:function(){var p={originalEvent:this._lastEvent};this.fire("predrag",p),lo(this._element,this._newPos),this.fire("drag",p)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(p){is(document.body,"leaflet-dragging"),this._lastTarget&&(is(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Bi(document,"mousemove touchmove",this._onMove,this),Bi(document,"mouseup touchend touchcancel",this._onUp,this),Ws(),ui();var T=this._moved&&this._moving;this._moving=!1,Fl._dragging=!1,T&&this.fire("dragend",{noInertia:p,distance:this._newPos.distanceTo(this._startPos)})}});function Du(p,T,U){var se,Pe=[1,4,2,8],nt,Jt,Dn,Jn,ar,Vr,Jr,Vi;for(nt=0,Vr=p.length;nt<Vr;nt++)p[nt]._code=Xn(p[nt],T);for(Dn=0;Dn<4;Dn++){for(Jr=Pe[Dn],se=[],nt=0,Vr=p.length,Jt=Vr-1;nt<Vr;Jt=nt++)Jn=p[nt],ar=p[Jt],Jn._code&Jr?ar._code&Jr||(Vi=An(ar,Jn,Jr,T,U),Vi._code=Xn(Vi,T),se.push(Vi)):(ar._code&Jr&&(Vi=An(ar,Jn,Jr,T,U),Vi._code=Xn(Vi,T),se.push(Vi)),se.push(Jn));p=se}return p}function Va(p,T){var U,se,Pe,nt,Jt,Dn,Jn,ar,Vr;if(!p||p.length===0)throw new Error("latlngs not passed");Zr(p)||(console.warn("latlngs are not flat! Only the first ring will be used"),p=p[0]);var Jr=it([0,0]),Vi=Ne(p),vo=Vi.getNorthWest().distanceTo(Vi.getSouthWest())*Vi.getNorthEast().distanceTo(Vi.getNorthWest());vo<1700&&(Jr=Jo(p));var Js=p.length,so=[];for(U=0;U<Js;U++){var Ss=it(p[U]);so.push(T.project(it([Ss.lat-Jr.lat,Ss.lng-Jr.lng])))}for(Dn=Jn=ar=0,U=0,se=Js-1;U<Js;se=U++)Pe=so[U],nt=so[se],Jt=Pe.y*nt.x-nt.y*Pe.x,Jn+=(Pe.x+nt.x)*Jt,ar+=(Pe.y+nt.y)*Jt,Dn+=Jt*3;Dn===0?Vr=so[0]:Vr=[Jn/Dn,ar/Dn];var ma=T.unproject(He(Vr));return it([ma.lat+Jr.lat,ma.lng+Jr.lng])}function Jo(p){for(var T=0,U=0,se=0,Pe=0;Pe<p.length;Pe++){var nt=it(p[Pe]);T+=nt.lat,U+=nt.lng,se++}return it([T/se,U/se])}var zl={__proto__:null,clipPolygon:Du,polygonCenter:Va,centroid:Jo};function os(p,T){if(!T||!p.length)return p.slice();var U=T*T;return p=Xe(p,U),p=uo(p,U),p}function ca(p,T,U){return Math.sqrt(Wr(p,T,U,!0))}function il(p,T,U){return Wr(p,T,U)}function uo(p,T){var U=p.length,se=typeof Uint8Array<"u"?Uint8Array:Array,Pe=new se(U);Pe[0]=Pe[U-1]=1,J(p,Pe,T,0,U-1);var nt,Jt=[];for(nt=0;nt<U;nt++)Pe[nt]&&Jt.push(p[nt]);return Jt}function J(p,T,U,se,Pe){var nt=0,Jt,Dn,Jn;for(Dn=se+1;Dn<=Pe-1;Dn++)Jn=Wr(p[Dn],p[se],p[Pe],!0),Jn>nt&&(Jt=Dn,nt=Jn);nt>U&&(T[Jt]=1,J(p,T,U,se,Jt),J(p,T,U,Jt,Pe))}function Xe(p,T){for(var U=[p[0]],se=1,Pe=0,nt=p.length;se<nt;se++)wr(p[se],p[Pe])>T&&(U.push(p[se]),Pe=se);return Pe<nt-1&&U.push(p[nt-1]),U}var Bt;function nn(p,T,U,se,Pe){var nt=se?Bt:Xn(p,U),Jt=Xn(T,U),Dn,Jn,ar;for(Bt=Jt;;){if(!(nt|Jt))return[p,T];if(nt&Jt)return!1;Dn=nt||Jt,Jn=An(p,T,Dn,U,Pe),ar=Xn(Jn,U),Dn===nt?(p=Jn,nt=ar):(T=Jn,Jt=ar)}}function An(p,T,U,se,Pe){var nt=T.x-p.x,Jt=T.y-p.y,Dn=se.min,Jn=se.max,ar,Vr;return U&8?(ar=p.x+nt*(Jn.y-p.y)/Jt,Vr=Jn.y):U&4?(ar=p.x+nt*(Dn.y-p.y)/Jt,Vr=Dn.y):U&2?(ar=Jn.x,Vr=p.y+Jt*(Jn.x-p.x)/nt):U&1&&(ar=Dn.x,Vr=p.y+Jt*(Dn.x-p.x)/nt),new Le(ar,Vr,Pe)}function Xn(p,T){var U=0;return p.x<T.min.x?U|=1:p.x>T.max.x&&(U|=2),p.y<T.min.y?U|=4:p.y>T.max.y&&(U|=8),U}function wr(p,T){var U=T.x-p.x,se=T.y-p.y;return U*U+se*se}function Wr(p,T,U,se){var Pe=T.x,nt=T.y,Jt=U.x-Pe,Dn=U.y-nt,Jn=Jt*Jt+Dn*Dn,ar;return Jn>0&&(ar=((p.x-Pe)*Jt+(p.y-nt)*Dn)/Jn,ar>1?(Pe=U.x,nt=U.y):ar>0&&(Pe+=Jt*ar,nt+=Dn*ar)),Jt=p.x-Pe,Dn=p.y-nt,se?Jt*Jt+Dn*Dn:new Le(Pe,nt)}function Zr(p){return!Q(p[0])||typeof p[0][0]!="object"&&typeof p[0][0]<"u"}function fi(p){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Zr(p)}function Pi(p,T){var U,se,Pe,nt,Jt,Dn,Jn,ar;if(!p||p.length===0)throw new Error("latlngs not passed");Zr(p)||(console.warn("latlngs are not flat! Only the first ring will be used"),p=p[0]);var Vr=it([0,0]),Jr=Ne(p),Vi=Jr.getNorthWest().distanceTo(Jr.getSouthWest())*Jr.getNorthEast().distanceTo(Jr.getNorthWest());Vi<1700&&(Vr=Jo(p));var vo=p.length,Js=[];for(U=0;U<vo;U++){var so=it(p[U]);Js.push(T.project(it([so.lat-Vr.lat,so.lng-Vr.lng])))}for(U=0,se=0;U<vo-1;U++)se+=Js[U].distanceTo(Js[U+1])/2;if(se===0)ar=Js[0];else for(U=0,nt=0;U<vo-1;U++)if(Jt=Js[U],Dn=Js[U+1],Pe=Jt.distanceTo(Dn),nt+=Pe,nt>se){Jn=(nt-se)/Pe,ar=[Dn.x-Jn*(Dn.x-Jt.x),Dn.y-Jn*(Dn.y-Jt.y)];break}var Ss=T.unproject(He(ar));return it([Ss.lat+Vr.lat,Ss.lng+Vr.lng])}var Xi={__proto__:null,simplify:os,pointToSegmentDistance:ca,closestPointOnSegment:il,clipSegment:nn,_getEdgeIntersection:An,_getBitCode:Xn,_sqClosestPointOnSegment:Wr,isFlat:Zr,_flat:fi,polylineCenter:Pi},js={project:function(p){return new Le(p.lng,p.lat)},unproject:function(p){return new Ve(p.y,p.x)},bounds:new pt([-180,-90],[180,90])},cs={R:6378137,R_MINOR:6356752314245179e-9,bounds:new pt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(p){var T=Math.PI/180,U=this.R,se=p.lat*T,Pe=this.R_MINOR/U,nt=Math.sqrt(1-Pe*Pe),Jt=nt*Math.sin(se),Dn=Math.tan(Math.PI/4-se/2)/Math.pow((1-Jt)/(1+Jt),nt/2);return se=-U*Math.log(Math.max(Dn,1e-10)),new Le(p.lng*T*U,se)},unproject:function(p){for(var T=180/Math.PI,U=this.R,se=this.R_MINOR/U,Pe=Math.sqrt(1-se*se),nt=Math.exp(-p.y/U),Jt=Math.PI/2-2*Math.atan(nt),Dn=0,Jn=.1,ar;Dn<15&&Math.abs(Jn)>1e-7;Dn++)ar=Pe*Math.sin(Jt),ar=Math.pow((1-ar)/(1+ar),Pe/2),Jn=Math.PI/2-2*Math.atan(nt*ar)-Jt,Jt+=Jn;return new Ve(Jt*T,p.x*T/U)}},_s={__proto__:null,LonLat:js,Mercator:cs,SphericalMercator:rn},co=i({},Mt,{code:"EPSG:3395",projection:cs,transformation:function(){var p=.5/(Math.PI*cs.R);return Pn(p,.5,-p,.5)}()}),yo=i({},Mt,{code:"EPSG:4326",projection:js,transformation:Pn(1/180,1,-1/180,.5)}),$a=i({},lt,{projection:js,transformation:Pn(1,0,-1,0),scale:function(p){return Math.pow(2,p)},zoom:function(p){return Math.log(p)/Math.LN2},distance:function(p,T){var U=T.lng-p.lng,se=T.lat-p.lat;return Math.sqrt(U*U+se*se)},infinite:!0});lt.Earth=Mt,lt.EPSG3395=co,lt.EPSG3857=De,lt.EPSG900913=Ae,lt.EPSG4326=yo,lt.Simple=$a;var Ri=Se.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(p){return p.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(p){return p&&p.removeLayer(this),this},getPane:function(p){return this._map.getPane(p?this.options[p]||p:this.options.pane)},addInteractiveTarget:function(p){return this._map._targets[f(p)]=this,this},removeInteractiveTarget:function(p){return delete this._map._targets[f(p)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(p){var T=p.target;if(T.hasLayer(this)){if(this._map=T,this._zoomAnimated=T._zoomAnimated,this.getEvents){var U=this.getEvents();T.on(U,this),this.once("remove",function(){T.off(U,this)},this)}this.onAdd(T),this.fire("add"),T.fire("layeradd",{layer:this})}}});Hi.include({addLayer:function(p){if(!p._layerAdd)throw new Error("The provided object is not a Layer.");var T=f(p);return this._layers[T]?this:(this._layers[T]=p,p._mapToAdd=this,p.beforeAdd&&p.beforeAdd(this),this.whenReady(p._layerAdd,p),this)},removeLayer:function(p){var T=f(p);return this._layers[T]?(this._loaded&&p.onRemove(this),delete this._layers[T],this._loaded&&(this.fire("layerremove",{layer:p}),p.fire("remove")),p._map=p._mapToAdd=null,this):this},hasLayer:function(p){return f(p)in this._layers},eachLayer:function(p,T){for(var U in this._layers)p.call(T,this._layers[U]);return this},_addLayers:function(p){p=p?Q(p)?p:[p]:[];for(var T=0,U=p.length;T<U;T++)this.addLayer(p[T])},_addZoomLimit:function(p){(!isNaN(p.options.maxZoom)||!isNaN(p.options.minZoom))&&(this._zoomBoundLayers[f(p)]=p,this._updateZoomLevels())},_removeZoomLimit:function(p){var T=f(p);this._zoomBoundLayers[T]&&(delete this._zoomBoundLayers[T],this._updateZoomLevels())},_updateZoomLevels:function(){var p=1/0,T=-1/0,U=this._getZoomSpan();for(var se in this._zoomBoundLayers){var Pe=this._zoomBoundLayers[se].options;p=Pe.minZoom===void 0?p:Math.min(p,Pe.minZoom),T=Pe.maxZoom===void 0?T:Math.max(T,Pe.maxZoom)}this._layersMaxZoom=T===-1/0?void 0:T,this._layersMinZoom=p===1/0?void 0:p,U!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Qo=Ri.extend({initialize:function(p,T){z(this,T),this._layers={};var U,se;if(p)for(U=0,se=p.length;U<se;U++)this.addLayer(p[U])},addLayer:function(p){var T=this.getLayerId(p);return this._layers[T]=p,this._map&&this._map.addLayer(p),this},removeLayer:function(p){var T=p in this._layers?p:this.getLayerId(p);return this._map&&this._layers[T]&&this._map.removeLayer(this._layers[T]),delete this._layers[T],this},hasLayer:function(p){var T=typeof p=="number"?p:this.getLayerId(p);return T in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(p){var T=Array.prototype.slice.call(arguments,1),U,se;for(U in this._layers)se=this._layers[U],se[p]&&se[p].apply(se,T);return this},onAdd:function(p){this.eachLayer(p.addLayer,p)},onRemove:function(p){this.eachLayer(p.removeLayer,p)},eachLayer:function(p,T){for(var U in this._layers)p.call(T,this._layers[U]);return this},getLayer:function(p){return this._layers[p]},getLayers:function(){var p=[];return this.eachLayer(p.push,p),p},setZIndex:function(p){return this.invoke("setZIndex",p)},getLayerId:function(p){return f(p)}}),mu=function(p,T){return new Qo(p,T)},Eo=Qo.extend({addLayer:function(p){return this.hasLayer(p)?this:(p.addEventParent(this),Qo.prototype.addLayer.call(this,p),this.fire("layeradd",{layer:p}))},removeLayer:function(p){return this.hasLayer(p)?(p in this._layers&&(p=this._layers[p]),p.removeEventParent(this),Qo.prototype.removeLayer.call(this,p),this.fire("layerremove",{layer:p})):this},setStyle:function(p){return this.invoke("setStyle",p)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var p=new Ie;for(var T in this._layers){var U=this._layers[T];p.extend(U.getBounds?U.getBounds():U.getLatLng())}return p}}),Fc=function(p,T){return new Eo(p,T)},sl=be.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(p){z(this,p)},createIcon:function(p){return this._createIcon("icon",p)},createShadow:function(p){return this._createIcon("shadow",p)},_createIcon:function(p,T){var U=this._getIconUrl(p);if(!U){if(p==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var se=this._createImg(U,T&&T.tagName==="IMG"?T:null);return this._setIconStyles(se,p),(this.options.crossOrigin||this.options.crossOrigin==="")&&(se.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),se},_setIconStyles:function(p,T){var U=this.options,se=U[T+"Size"];typeof se=="number"&&(se=[se,se]);var Pe=He(se),nt=He(T==="shadow"&&U.shadowAnchor||U.iconAnchor||Pe&&Pe.divideBy(2,!0));p.className="leaflet-marker-"+T+" "+(U.className||""),nt&&(p.style.marginLeft=-nt.x+"px",p.style.marginTop=-nt.y+"px"),Pe&&(p.style.width=Pe.x+"px",p.style.height=Pe.y+"px")},_createImg:function(p,T){return T=T||document.createElement("img"),T.src=p,T},_getIconUrl:function(p){return Cn.retina&&this.options[p+"RetinaUrl"]||this.options[p+"Url"]}});function zc(p){return new sl(p)}var Ou=sl.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(p){return typeof Ou.imagePath!="string"&&(Ou.imagePath=this._detectIconPath()),(this.options.imagePath||Ou.imagePath)+sl.prototype._getIconUrl.call(this,p)},_stripUrl:function(p){var T=function(U,se,Pe){var nt=se.exec(U);return nt&&nt[Pe]};return p=T(p,/^url\((['"])?(.+)\1\)$/,2),p&&T(p,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var p=ds("div","leaflet-default-icon-path",document.body),T=ja(p,"background-image")||ja(p,"backgroundImage");if(document.body.removeChild(p),T=this._stripUrl(T),T)return T;var U=document.querySelector('link[href$="leaflet.css"]');return U?U.href.substring(0,U.href.length-11-1):""}}),Ru=ss.extend({initialize:function(p){this._marker=p},addHooks:function(){var p=this._marker._icon;this._draggable||(this._draggable=new Fl(p,p,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ki(p,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&is(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(p){var T=this._marker,U=T._map,se=this._marker.options.autoPanSpeed,Pe=this._marker.options.autoPanPadding,nt=So(T._icon),Jt=U.getPixelBounds(),Dn=U.getPixelOrigin(),Jn=ge(Jt.min._subtract(Dn).add(Pe),Jt.max._subtract(Dn).subtract(Pe));if(!Jn.contains(nt)){var ar=He((Math.max(Jn.max.x,nt.x)-Jn.max.x)/(Jt.max.x-Jn.max.x)-(Math.min(Jn.min.x,nt.x)-Jn.min.x)/(Jt.min.x-Jn.min.x),(Math.max(Jn.max.y,nt.y)-Jn.max.y)/(Jt.max.y-Jn.max.y)-(Math.min(Jn.min.y,nt.y)-Jn.min.y)/(Jt.min.y-Jn.min.y)).multiplyBy(se);U.panBy(ar,{animate:!1}),this._draggable._newPos._add(ar),this._draggable._startPos._add(ar),lo(T._icon,this._draggable._newPos),this._onDrag(p),this._panRequest=he(this._adjustPan.bind(this,p))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(p){this._marker.options.autoPan&&(de(this._panRequest),this._panRequest=he(this._adjustPan.bind(this,p)))},_onDrag:function(p){var T=this._marker,U=T._shadow,se=So(T._icon),Pe=T._map.layerPointToLatLng(se);U&&lo(U,se),T._latlng=Pe,p.latlng=Pe,p.oldLatLng=this._oldLatLng,T.fire("move",p).fire("drag",p)},_onDragEnd:function(p){de(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",p)}}),_o=Ri.extend({options:{icon:new Ou,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(p,T){z(this,T),this._latlng=it(p)},onAdd:function(p){this._zoomAnimated=this._zoomAnimated&&p.options.markerZoomAnimation,this._zoomAnimated&&p.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(p){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&p.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(p){var T=this._latlng;return this._latlng=it(p),this.update(),this.fire("move",{oldLatLng:T,latlng:this._latlng})},setZIndexOffset:function(p){return this.options.zIndexOffset=p,this.update()},getIcon:function(){return this.options.icon},setIcon:function(p){return this.options.icon=p,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var p=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(p)}return this},_initIcon:function(){var p=this.options,T="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),U=p.icon.createIcon(this._icon),se=!1;U!==this._icon&&(this._icon&&this._removeIcon(),se=!0,p.title&&(U.title=p.title),U.tagName==="IMG"&&(U.alt=p.alt||"")),ki(U,T),p.keyboard&&(U.tabIndex="0",U.setAttribute("role","button")),this._icon=U,p.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Mi(U,"focus",this._panOnFocus,this);var Pe=p.icon.createShadow(this._shadow),nt=!1;Pe!==this._shadow&&(this._removeShadow(),nt=!0),Pe&&(ki(Pe,T),Pe.alt=""),this._shadow=Pe,p.opacity<1&&this._updateOpacity(),se&&this.getPane().appendChild(this._icon),this._initInteraction(),Pe&&nt&&this.getPane(p.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Bi(this._icon,"focus",this._panOnFocus,this),Di(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Di(this._shadow),this._shadow=null},_setPos:function(p){this._icon&&lo(this._icon,p),this._shadow&&lo(this._shadow,p),this._zIndex=p.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(p){this._icon&&(this._icon.style.zIndex=this._zIndex+p)},_animateZoom:function(p){var T=this._map._latLngToNewLayerPoint(this._latlng,p.zoom,p.center).round();this._setPos(T)},_initInteraction:function(){if(this.options.interactive&&(ki(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ru)){var p=this.options.draggable;this.dragging&&(p=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ru(this),p&&this.dragging.enable()}},setOpacity:function(p){return this.options.opacity=p,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var p=this.options.opacity;this._icon&&Co(this._icon,p),this._shadow&&Co(this._shadow,p)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var p=this._map;if(p){var T=this.options.icon.options,U=T.iconSize?He(T.iconSize):He(0,0),se=T.iconAnchor?He(T.iconAnchor):He(0,0);p.panInside(this._latlng,{paddingTopLeft:se,paddingBottomRight:U.subtract(se)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function _l(p,T){return new _o(p,T)}var ha=Ri.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(p){this._renderer=p.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(p){return z(this,p),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&p&&Object.prototype.hasOwnProperty.call(p,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Ta=ha.extend({options:{fill:!0,radius:10},initialize:function(p,T){z(this,T),this._latlng=it(p),this._radius=this.options.radius},setLatLng:function(p){var T=this._latlng;return this._latlng=it(p),this.redraw(),this.fire("move",{oldLatLng:T,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(p){return this.options.radius=this._radius=p,this.redraw()},getRadius:function(){return this._radius},setStyle:function(p){var T=p&&p.radius||this._radius;return ha.prototype.setStyle.call(this,p),this.setRadius(T),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var p=this._radius,T=this._radiusY||p,U=this._clickTolerance(),se=[p+U,T+U];this._pxBounds=new pt(this._point.subtract(se),this._point.add(se))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(p){return p.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function gu(p,T){return new Ta(p,T)}var Xs=Ta.extend({initialize:function(p,T,U){if(typeof T=="number"&&(T=i({},U,{radius:T})),z(this,T),this._latlng=it(p),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(p){return this._mRadius=p,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var p=[this._radius,this._radiusY||this._radius];return new Ie(this._map.layerPointToLatLng(this._point.subtract(p)),this._map.layerPointToLatLng(this._point.add(p)))},setStyle:ha.prototype.setStyle,_project:function(){var p=this._latlng.lng,T=this._latlng.lat,U=this._map,se=U.options.crs;if(se.distance===Mt.distance){var Pe=Math.PI/180,nt=this._mRadius/Mt.R/Pe,Jt=U.project([T+nt,p]),Dn=U.project([T-nt,p]),Jn=Jt.add(Dn).divideBy(2),ar=U.unproject(Jn).lat,Vr=Math.acos((Math.cos(nt*Pe)-Math.sin(T*Pe)*Math.sin(ar*Pe))/(Math.cos(T*Pe)*Math.cos(ar*Pe)))/Pe;(isNaN(Vr)||Vr===0)&&(Vr=nt/Math.cos(Math.PI/180*T)),this._point=Jn.subtract(U.getPixelOrigin()),this._radius=isNaN(Vr)?0:Jn.x-U.project([ar,p-Vr]).x,this._radiusY=Jn.y-Jt.y}else{var Jr=se.unproject(se.project(this._latlng).subtract([this._mRadius,0]));this._point=U.latLngToLayerPoint(this._latlng),this._radius=this._point.x-U.latLngToLayerPoint(Jr).x}this._updateBounds()}});function zo(p,T,U){return new Xs(p,T,U)}var ea=ha.extend({options:{smoothFactor:1,noClip:!1},initialize:function(p,T){z(this,T),this._setLatLngs(p)},getLatLngs:function(){return this._latlngs},setLatLngs:function(p){return this._setLatLngs(p),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(p){for(var T=1/0,U=null,se=Wr,Pe,nt,Jt=0,Dn=this._parts.length;Jt<Dn;Jt++)for(var Jn=this._parts[Jt],ar=1,Vr=Jn.length;ar<Vr;ar++){Pe=Jn[ar-1],nt=Jn[ar];var Jr=se(p,Pe,nt,!0);Jr<T&&(T=Jr,U=se(p,Pe,nt))}return U&&(U.distance=Math.sqrt(T)),U},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Pi(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(p,T){return T=T||this._defaultShape(),p=it(p),T.push(p),this._bounds.extend(p),this.redraw()},_setLatLngs:function(p){this._bounds=new Ie,this._latlngs=this._convertLatLngs(p)},_defaultShape:function(){return Zr(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(p){for(var T=[],U=Zr(p),se=0,Pe=p.length;se<Pe;se++)U?(T[se]=it(p[se]),this._bounds.extend(T[se])):T[se]=this._convertLatLngs(p[se]);return T},_project:function(){var p=new pt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,p),this._bounds.isValid()&&p.isValid()&&(this._rawPxBounds=p,this._updateBounds())},_updateBounds:function(){var p=this._clickTolerance(),T=new Le(p,p);this._rawPxBounds&&(this._pxBounds=new pt([this._rawPxBounds.min.subtract(T),this._rawPxBounds.max.add(T)]))},_projectLatlngs:function(p,T,U){var se=p[0]instanceof Ve,Pe=p.length,nt,Jt;if(se){for(Jt=[],nt=0;nt<Pe;nt++)Jt[nt]=this._map.latLngToLayerPoint(p[nt]),U.extend(Jt[nt]);T.push(Jt)}else for(nt=0;nt<Pe;nt++)this._projectLatlngs(p[nt],T,U)},_clipPoints:function(){var p=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(p))){if(this.options.noClip){this._parts=this._rings;return}var T=this._parts,U,se,Pe,nt,Jt,Dn,Jn;for(U=0,Pe=0,nt=this._rings.length;U<nt;U++)for(Jn=this._rings[U],se=0,Jt=Jn.length;se<Jt-1;se++)Dn=nn(Jn[se],Jn[se+1],p,se,!0),Dn&&(T[Pe]=T[Pe]||[],T[Pe].push(Dn[0]),(Dn[1]!==Jn[se+1]||se===Jt-2)&&(T[Pe].push(Dn[1]),Pe++))}},_simplifyPoints:function(){for(var p=this._parts,T=this.options.smoothFactor,U=0,se=p.length;U<se;U++)p[U]=os(p[U],T)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(p,T){var U,se,Pe,nt,Jt,Dn,Jn=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(p))return!1;for(U=0,nt=this._parts.length;U<nt;U++)for(Dn=this._parts[U],se=0,Jt=Dn.length,Pe=Jt-1;se<Jt;Pe=se++)if(!(!T&&se===0)&&ca(p,Dn[Pe],Dn[se])<=Jn)return!0;return!1}});function jc(p,T){return new ea(p,T)}ea._flat=fi;var Mo=ea.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Va(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(p){var T=ea.prototype._convertLatLngs.call(this,p),U=T.length;return U>=2&&T[0]instanceof Ve&&T[0].equals(T[U-1])&&T.pop(),T},_setLatLngs:function(p){ea.prototype._setLatLngs.call(this,p),Zr(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Zr(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var p=this._renderer._bounds,T=this.options.weight,U=new Le(T,T);if(p=new pt(p.min.subtract(U),p.max.add(U)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(p))){if(this.options.noClip){this._parts=this._rings;return}for(var se=0,Pe=this._rings.length,nt;se<Pe;se++)nt=Du(this._rings[se],p,!0),nt.length&&this._parts.push(nt)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(p){var T=!1,U,se,Pe,nt,Jt,Dn,Jn,ar;if(!this._pxBounds||!this._pxBounds.contains(p))return!1;for(nt=0,Jn=this._parts.length;nt<Jn;nt++)for(U=this._parts[nt],Jt=0,ar=U.length,Dn=ar-1;Jt<ar;Dn=Jt++)se=U[Jt],Pe=U[Dn],se.y>p.y!=Pe.y>p.y&&p.x<(Pe.x-se.x)*(p.y-se.y)/(Pe.y-se.y)+se.x&&(T=!T);return T||ea.prototype._containsPoint.call(this,p,!0)}});function jl(p,T){return new Mo(p,T)}var mi=Eo.extend({initialize:function(p,T){z(this,T),this._layers={},p&&this.addData(p)},addData:function(p){var T=Q(p)?p:p.features,U,se,Pe;if(T){for(U=0,se=T.length;U<se;U++)Pe=T[U],(Pe.geometries||Pe.geometry||Pe.features||Pe.coordinates)&&this.addData(Pe);return this}var nt=this.options;if(nt.filter&&!nt.filter(p))return this;var Jt=jo(p,nt);return Jt?(Jt.feature=na(p),Jt.defaultOptions=Jt.options,this.resetStyle(Jt),nt.onEachFeature&&nt.onEachFeature(p,Jt),this.addLayer(Jt)):this},resetStyle:function(p){return p===void 0?this.eachLayer(this.resetStyle,this):(p.options=i({},p.defaultOptions),this._setLayerStyle(p,this.options.style),this)},setStyle:function(p){return this.eachLayer(function(T){this._setLayerStyle(T,p)},this)},_setLayerStyle:function(p,T){p.setStyle&&(typeof T=="function"&&(T=T(p.feature)),p.setStyle(T))}});function jo(p,T){var U=p.type==="Feature"?p.geometry:p,se=U?U.coordinates:null,Pe=[],nt=T&&T.pointToLayer,Jt=T&&T.coordsToLatLng||Nu,Dn,Jn,ar,Vr;if(!se&&!U)return null;switch(U.type){case"Point":return Dn=Jt(se),Bu(nt,p,Dn,T);case"MultiPoint":for(ar=0,Vr=se.length;ar<Vr;ar++)Dn=Jt(se[ar]),Pe.push(Bu(nt,p,Dn,T));return new Eo(Pe);case"LineString":case"MultiLineString":return Jn=da(se,U.type==="LineString"?0:1,Jt),new ea(Jn,T);case"Polygon":case"MultiPolygon":return Jn=da(se,U.type==="Polygon"?1:2,Jt),new Mo(Jn,T);case"GeometryCollection":for(ar=0,Vr=U.geometries.length;ar<Vr;ar++){var Jr=jo({geometry:U.geometries[ar],type:"Feature",properties:p.properties},T);Jr&&Pe.push(Jr)}return new Eo(Pe);case"FeatureCollection":for(ar=0,Vr=U.features.length;ar<Vr;ar++){var Vi=jo(U.features[ar],T);Vi&&Pe.push(Vi)}return new Eo(Pe);default:throw new Error("Invalid GeoJSON object.")}}function Bu(p,T,U,se){return p?p(T,U):new _o(U,se&&se.markersInheritOptions&&se)}function Nu(p){return new Ve(p[1],p[0],p[2])}function da(p,T,U){for(var se=[],Pe=0,nt=p.length,Jt;Pe<nt;Pe++)Jt=T?da(p[Pe],T-1,U):(U||Nu)(p[Pe]),se.push(Jt);return se}function ta(p,T){return p=it(p),p.alt!==void 0?[M(p.lng,T),M(p.lat,T),M(p.alt,T)]:[M(p.lng,T),M(p.lat,T)]}function Ul(p,T,U,se){for(var Pe=[],nt=0,Jt=p.length;nt<Jt;nt++)Pe.push(T?Ul(p[nt],Zr(p[nt])?0:T-1,U,se):ta(p[nt],se));return!T&&U&&Pe.length>0&&Pe.push(Pe[0].slice()),Pe}function ol(p,T){return p.feature?i({},p.feature,{geometry:T}):na(T)}function na(p){return p.type==="Feature"||p.type==="FeatureCollection"?p:{type:"Feature",properties:{},geometry:p}}var Ln={toGeoJSON:function(p){return ol(this,{type:"Point",coordinates:ta(this.getLatLng(),p)})}};_o.include(Ln),Xs.include(Ln),Ta.include(Ln),ea.include({toGeoJSON:function(p){var T=!Zr(this._latlngs),U=Ul(this._latlngs,T?1:0,!1,p);return ol(this,{type:(T?"Multi":"")+"LineString",coordinates:U})}}),Mo.include({toGeoJSON:function(p){var T=!Zr(this._latlngs),U=T&&!Zr(this._latlngs[0]),se=Ul(this._latlngs,U?2:T?1:0,!0,p);return T||(se=[se]),ol(this,{type:(U?"Multi":"")+"Polygon",coordinates:se})}}),Qo.include({toMultiPoint:function(p){var T=[];return this.eachLayer(function(U){T.push(U.toGeoJSON(p).geometry.coordinates)}),ol(this,{type:"MultiPoint",coordinates:T})},toGeoJSON:function(p){var T=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(T==="MultiPoint")return this.toMultiPoint(p);var U=T==="GeometryCollection",se=[];return this.eachLayer(function(Pe){if(Pe.toGeoJSON){var nt=Pe.toGeoJSON(p);if(U)se.push(nt.geometry);else{var Jt=na(nt);Jt.type==="FeatureCollection"?se.push.apply(se,Jt.features):se.push(Jt)}}}),U?ol(this,{geometries:se,type:"GeometryCollection"}):{type:"FeatureCollection",features:se}}});function nr(p,T){return new mi(p,T)}var Fn=nr,Hr=Ri.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(p,T,U){this._url=p,this._bounds=Ne(T),z(this,U)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ki(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Di(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(p){return this.options.opacity=p,this._image&&this._updateOpacity(),this},setStyle:function(p){return p.opacity&&this.setOpacity(p.opacity),this},bringToFront:function(){return this._map&&lu(this._image),this},bringToBack:function(){return this._map&&gl(this._image),this},setUrl:function(p){return this._url=p,this._image&&(this._image.src=p),this},setBounds:function(p){return this._bounds=Ne(p),this._map&&this._reset(),this},getEvents:function(){var p={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(p.zoomanim=this._animateZoom),p},setZIndex:function(p){return this.options.zIndex=p,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var p=this._url.tagName==="IMG",T=this._image=p?this._url:ds("img");if(ki(T,"leaflet-image-layer"),this._zoomAnimated&&ki(T,"leaflet-zoom-animated"),this.options.className&&ki(T,this.options.className),T.onselectstart=w,T.onmousemove=w,T.onload=a(this.fire,this,"load"),T.onerror=a(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(T.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),p){this._url=T.src;return}T.src=this._url,T.alt=this.options.alt},_animateZoom:function(p){var T=this._map.getZoomScale(p.zoom),U=this._map._latLngBoundsToNewLayerBounds(this._bounds,p.zoom,p.center).min;uu(this._image,U,T)},_reset:function(){var p=this._image,T=new pt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),U=T.getSize();lo(p,T.min),p.style.width=U.x+"px",p.style.height=U.y+"px"},_updateOpacity:function(){Co(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var p=this.options.errorOverlayUrl;p&&this._url!==p&&(this._url=p,this._image.src=p)},getCenter:function(){return this._bounds.getCenter()}}),ii=function(p,T,U){return new Hr(p,T,U)},xi=Hr.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var p=this._url.tagName==="VIDEO",T=this._image=p?this._url:ds("video");if(ki(T,"leaflet-image-layer"),this._zoomAnimated&&ki(T,"leaflet-zoom-animated"),this.options.className&&ki(T,this.options.className),T.onselectstart=w,T.onmousemove=w,T.onloadeddata=a(this.fire,this,"load"),p){for(var U=T.getElementsByTagName("source"),se=[],Pe=0;Pe<U.length;Pe++)se.push(U[Pe].src);this._url=U.length>0?se:[T.src];return}Q(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(T.style,"objectFit")&&(T.style.objectFit="fill"),T.autoplay=!!this.options.autoplay,T.loop=!!this.options.loop,T.muted=!!this.options.muted,T.playsInline=!!this.options.playsInline;for(var nt=0;nt<this._url.length;nt++){var Jt=ds("source");Jt.src=this._url[nt],T.appendChild(Jt)}}});function as(p,T,U){return new xi(p,T,U)}var Cs=Hr.extend({_initImage:function(){var p=this._image=this._url;ki(p,"leaflet-image-layer"),this._zoomAnimated&&ki(p,"leaflet-zoom-animated"),this.options.className&&ki(p,this.options.className),p.onselectstart=w,p.onmousemove=w}});function dc(p,T,U){return new Cs(p,T,U)}var ra=Ri.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(p,T){p&&(p instanceof Ve||Q(p))?(this._latlng=it(p),z(this,T)):(z(this,p),this._source=T),this.options.content&&(this._content=this.options.content)},openOn:function(p){return p=arguments.length?p:this._source._map,p.hasLayer(this)||p.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(p){return this._map?this.close():(arguments.length?this._source=p:p=this._source,this._prepareOpen(),this.openOn(p._map)),this},onAdd:function(p){this._zoomAnimated=p._zoomAnimated,this._container||this._initLayout(),p._fadeAnimated&&Co(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),p._fadeAnimated&&Co(this._container,1),this.bringToFront(),this.options.interactive&&(ki(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(p){p._fadeAnimated?(Co(this._container,0),this._removeTimeout=setTimeout(a(Di,void 0,this._container),200)):Di(this._container),this.options.interactive&&(is(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(p){return this._latlng=it(p),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(p){return this._content=p,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var p={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(p.zoomanim=this._animateZoom),p},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&lu(this._container),this},bringToBack:function(){return this._map&&gl(this._container),this},_prepareOpen:function(p){var T=this._source;if(!T._map)return!1;if(T instanceof Eo){T=null;var U=this._source._layers;for(var se in U)if(U[se]._map){T=U[se];break}if(!T)return!1;this._source=T}if(!p)if(T.getCenter)p=T.getCenter();else if(T.getLatLng)p=T.getLatLng();else if(T.getBounds)p=T.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(p),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var p=this._contentNode,T=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof T=="string")p.innerHTML=T;else{for(;p.hasChildNodes();)p.removeChild(p.firstChild);p.appendChild(T)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var p=this._map.latLngToLayerPoint(this._latlng),T=He(this.options.offset),U=this._getAnchor();this._zoomAnimated?lo(this._container,p.add(U)):T=T.add(p).add(U);var se=this._containerBottom=-T.y,Pe=this._containerLeft=-Math.round(this._containerWidth/2)+T.x;this._container.style.bottom=se+"px",this._container.style.left=Pe+"px"}},_getAnchor:function(){return[0,0]}});Hi.include({_initOverlay:function(p,T,U,se){var Pe=T;return Pe instanceof p||(Pe=new p(se).setContent(T)),U&&Pe.setLatLng(U),Pe}}),Ri.include({_initOverlay:function(p,T,U,se){var Pe=U;return Pe instanceof p?(z(Pe,se),Pe._source=this):(Pe=T&&!se?T:new p(se,this),Pe.setContent(U)),Pe}});var Ts=ra.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(p){return p=arguments.length?p:this._source._map,!p.hasLayer(this)&&p._popup&&p._popup.options.autoClose&&p.removeLayer(p._popup),p._popup=this,ra.prototype.openOn.call(this,p)},onAdd:function(p){ra.prototype.onAdd.call(this,p),p.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ha||this._source.on("preclick",qi))},onRemove:function(p){ra.prototype.onRemove.call(this,p),p.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ha||this._source.off("preclick",qi))},getEvents:function(){var p=ra.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(p.preclick=this.close),this.options.keepInView&&(p.moveend=this._adjustPan),p},_initLayout:function(){var p="leaflet-popup",T=this._container=ds("div",p+" "+(this.options.className||"")+" leaflet-zoom-animated"),U=this._wrapper=ds("div",p+"-content-wrapper",T);if(this._contentNode=ds("div",p+"-content",U),Gi(T),Sc(this._contentNode),Mi(T,"contextmenu",qi),this._tipContainer=ds("div",p+"-tip-container",T),this._tip=ds("div",p+"-tip",this._tipContainer),this.options.closeButton){var se=this._closeButton=ds("a",p+"-close-button",T);se.setAttribute("role","button"),se.setAttribute("aria-label","Close popup"),se.href="#close",se.innerHTML='<span aria-hidden="true">&#215;</span>',Mi(se,"click",function(Pe){Nr(Pe),this.close()},this)}},_updateLayout:function(){var p=this._contentNode,T=p.style;T.width="",T.whiteSpace="nowrap";var U=p.offsetWidth;U=Math.min(U,this.options.maxWidth),U=Math.max(U,this.options.minWidth),T.width=U+1+"px",T.whiteSpace="",T.height="";var se=p.offsetHeight,Pe=this.options.maxHeight,nt="leaflet-popup-scrolled";Pe&&se>Pe?(T.height=Pe+"px",ki(p,nt)):is(p,nt),this._containerWidth=this._container.offsetWidth},_animateZoom:function(p){var T=this._map._latLngToNewLayerPoint(this._latlng,p.zoom,p.center),U=this._getAnchor();lo(this._container,T.add(U))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var p=this._map,T=parseInt(ja(this._container,"marginBottom"),10)||0,U=this._container.offsetHeight+T,se=this._containerWidth,Pe=new Le(this._containerLeft,-U-this._containerBottom);Pe._add(So(this._container));var nt=p.layerPointToContainerPoint(Pe),Jt=He(this.options.autoPanPadding),Dn=He(this.options.autoPanPaddingTopLeft||Jt),Jn=He(this.options.autoPanPaddingBottomRight||Jt),ar=p.getSize(),Vr=0,Jr=0;nt.x+se+Jn.x>ar.x&&(Vr=nt.x+se-ar.x+Jn.x),nt.x-Vr-Dn.x<0&&(Vr=nt.x-Dn.x),nt.y+U+Jn.y>ar.y&&(Jr=nt.y+U-ar.y+Jn.y),nt.y-Jr-Dn.y<0&&(Jr=nt.y-Dn.y),(Vr||Jr)&&(this.options.keepInView&&(this._autopanning=!0),p.fire("autopanstart").panBy([Vr,Jr]))}},_getAnchor:function(){return He(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),al=function(p,T){return new Ts(p,T)};Hi.mergeOptions({closePopupOnClick:!0}),Hi.include({openPopup:function(p,T,U){return this._initOverlay(Ts,p,T,U).openOn(this),this},closePopup:function(p){return p=arguments.length?p:this._popup,p&&p.close(),this}}),Ri.include({bindPopup:function(p,T){return this._popup=this._initOverlay(Ts,this._popup,p,T),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(p){return this._popup&&(this instanceof Eo||(this._popup._source=this),this._popup._prepareOpen(p||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(p){return this._popup&&this._popup.setContent(p),this},getPopup:function(){return this._popup},_openPopup:function(p){if(!(!this._popup||!this._map)){Fi(p);var T=p.layer||p.target;if(this._popup._source===T&&!(T instanceof ha)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(p.latlng);return}this._popup._source=T,this.openPopup(p.latlng)}},_movePopup:function(p){this._popup.setLatLng(p.latlng)},_onKeyPress:function(p){p.originalEvent.keyCode===13&&this._openPopup(p)}});var bl=ra.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(p){ra.prototype.onAdd.call(this,p),this.setOpacity(this.options.opacity),p.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(p){ra.prototype.onRemove.call(this,p),p.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var p=ra.prototype.getEvents.call(this);return this.options.permanent||(p.preclick=this.close),p},_initLayout:function(){var p="leaflet-tooltip",T=p+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ds("div",T),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+f(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(p){var T,U,se=this._map,Pe=this._container,nt=se.latLngToContainerPoint(se.getCenter()),Jt=se.layerPointToContainerPoint(p),Dn=this.options.direction,Jn=Pe.offsetWidth,ar=Pe.offsetHeight,Vr=He(this.options.offset),Jr=this._getAnchor();Dn==="top"?(T=Jn/2,U=ar):Dn==="bottom"?(T=Jn/2,U=0):Dn==="center"?(T=Jn/2,U=ar/2):Dn==="right"?(T=0,U=ar/2):Dn==="left"?(T=Jn,U=ar/2):Jt.x<nt.x?(Dn="right",T=0,U=ar/2):(Dn="left",T=Jn+(Vr.x+Jr.x)*2,U=ar/2),p=p.subtract(He(T,U,!0)).add(Vr).add(Jr),is(Pe,"leaflet-tooltip-right"),is(Pe,"leaflet-tooltip-left"),is(Pe,"leaflet-tooltip-top"),is(Pe,"leaflet-tooltip-bottom"),ki(Pe,"leaflet-tooltip-"+Dn),lo(Pe,p)},_updatePosition:function(){var p=this._map.latLngToLayerPoint(this._latlng);this._setPosition(p)},setOpacity:function(p){this.options.opacity=p,this._container&&Co(this._container,p)},_animateZoom:function(p){var T=this._map._latLngToNewLayerPoint(this._latlng,p.zoom,p.center);this._setPosition(T)},_getAnchor:function(){return He(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Ga=function(p,T){return new bl(p,T)};Hi.include({openTooltip:function(p,T,U){return this._initOverlay(bl,p,T,U).openOn(this),this},closeTooltip:function(p){return p.close(),this}}),Ri.include({bindTooltip:function(p,T){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(bl,this._tooltip,p,T),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(p){if(!(!p&&this._tooltipHandlersAdded)){var T=p?"off":"on",U={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?U.add=this._openTooltip:(U.mouseover=this._openTooltip,U.mouseout=this.closeTooltip,U.click=this._openTooltip,this._map?this._addFocusListeners():U.add=this._addFocusListeners),this._tooltip.options.sticky&&(U.mousemove=this._moveTooltip),this[T](U),this._tooltipHandlersAdded=!p}},openTooltip:function(p){return this._tooltip&&(this instanceof Eo||(this._tooltip._source=this),this._tooltip._prepareOpen(p)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(p){return this._tooltip&&this._tooltip.setContent(p),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(p){var T=typeof p.getElement=="function"&&p.getElement();T&&(Mi(T,"focus",function(){this._tooltip._source=p,this.openTooltip()},this),Mi(T,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(p){var T=typeof p.getElement=="function"&&p.getElement();T&&T.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(p){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var T=this;this._map.once("moveend",function(){T._openOnceFlag=!1,T._openTooltip(p)});return}this._tooltip._source=p.layer||p.target,this.openTooltip(this._tooltip.options.sticky?p.latlng:void 0)}},_moveTooltip:function(p){var T=p.latlng,U,se;this._tooltip.options.sticky&&p.originalEvent&&(U=this._map.mouseEventToContainerPoint(p.originalEvent),se=this._map.containerPointToLayerPoint(U),T=this._map.layerPointToLatLng(se)),this._tooltip.setLatLng(T)}});var ll=sl.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(p){var T=p&&p.tagName==="DIV"?p:document.createElement("div"),U=this.options;if(U.html instanceof Element?(Xu(T),T.appendChild(U.html)):T.innerHTML=U.html!==!1?U.html:"",U.bgPos){var se=He(U.bgPos);T.style.backgroundPosition=-se.x+"px "+-se.y+"px"}return this._setIconStyles(T,"icon"),T},createShadow:function(){return null}});function Vl(p){return new ll(p)}sl.Default=Ou;var Ui=Ri.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Cn.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(p){z(this,p)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(p){p._addZoomLimit(this)},onRemove:function(p){this._removeAllTiles(),Di(this._container),p._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(lu(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(gl(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(p){return this.options.opacity=p,this._updateOpacity(),this},setZIndex:function(p){return this.options.zIndex=p,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var p=this._clampZoom(this._map.getZoom());p!==this._tileZoom&&(this._tileZoom=p,this._updateLevels()),this._update()}return this},getEvents:function(){var p={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=m(this._onMoveEnd,this.options.updateInterval,this)),p.move=this._onMove),this._zoomAnimated&&(p.zoomanim=this._animateZoom),p},createTile:function(){return document.createElement("div")},getTileSize:function(){var p=this.options.tileSize;return p instanceof Le?p:new Le(p,p)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(p){for(var T=this.getPane().children,U=-p(-1/0,1/0),se=0,Pe=T.length,nt;se<Pe;se++)nt=T[se].style.zIndex,T[se]!==this._container&&nt&&(U=p(U,+nt));isFinite(U)&&(this.options.zIndex=U+p(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Cn.ielt9){Co(this._container,this.options.opacity);var p=+new Date,T=!1,U=!1;for(var se in this._tiles){var Pe=this._tiles[se];if(!(!Pe.current||!Pe.loaded)){var nt=Math.min(1,(p-Pe.loaded)/200);Co(Pe.el,nt),nt<1?T=!0:(Pe.active?U=!0:this._onOpaqueTile(Pe),Pe.active=!0)}}U&&!this._noPrune&&this._pruneTiles(),T&&(de(this._fadeFrame),this._fadeFrame=he(this._updateOpacity,this))}},_onOpaqueTile:w,_initContainer:function(){this._container||(this._container=ds("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var p=this._tileZoom,T=this.options.maxZoom;if(p!==void 0){for(var U in this._levels)U=Number(U),this._levels[U].el.children.length||U===p?(this._levels[U].el.style.zIndex=T-Math.abs(p-U),this._onUpdateLevel(U)):(Di(this._levels[U].el),this._removeTilesAtZoom(U),this._onRemoveLevel(U),delete this._levels[U]);var se=this._levels[p],Pe=this._map;return se||(se=this._levels[p]={},se.el=ds("div","leaflet-tile-container leaflet-zoom-animated",this._container),se.el.style.zIndex=T,se.origin=Pe.project(Pe.unproject(Pe.getPixelOrigin()),p).round(),se.zoom=p,this._setZoomTransform(se,Pe.getCenter(),Pe.getZoom()),w(se.el.offsetWidth),this._onCreateLevel(se)),this._level=se,se}},_onUpdateLevel:w,_onRemoveLevel:w,_onCreateLevel:w,_pruneTiles:function(){if(this._map){var p,T,U=this._map.getZoom();if(U>this.options.maxZoom||U<this.options.minZoom){this._removeAllTiles();return}for(p in this._tiles)T=this._tiles[p],T.retain=T.current;for(p in this._tiles)if(T=this._tiles[p],T.current&&!T.active){var se=T.coords;this._retainParent(se.x,se.y,se.z,se.z-5)||this._retainChildren(se.x,se.y,se.z,se.z+2)}for(p in this._tiles)this._tiles[p].retain||this._removeTile(p)}},_removeTilesAtZoom:function(p){for(var T in this._tiles)this._tiles[T].coords.z===p&&this._removeTile(T)},_removeAllTiles:function(){for(var p in this._tiles)this._removeTile(p)},_invalidateAll:function(){for(var p in this._levels)Di(this._levels[p].el),this._onRemoveLevel(Number(p)),delete this._levels[p];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(p,T,U,se){var Pe=Math.floor(p/2),nt=Math.floor(T/2),Jt=U-1,Dn=new Le(+Pe,+nt);Dn.z=+Jt;var Jn=this._tileCoordsToKey(Dn),ar=this._tiles[Jn];return ar&&ar.active?(ar.retain=!0,!0):(ar&&ar.loaded&&(ar.retain=!0),Jt>se?this._retainParent(Pe,nt,Jt,se):!1)},_retainChildren:function(p,T,U,se){for(var Pe=2*p;Pe<2*p+2;Pe++)for(var nt=2*T;nt<2*T+2;nt++){var Jt=new Le(Pe,nt);Jt.z=U+1;var Dn=this._tileCoordsToKey(Jt),Jn=this._tiles[Dn];if(Jn&&Jn.active){Jn.retain=!0;continue}else Jn&&Jn.loaded&&(Jn.retain=!0);U+1<se&&this._retainChildren(Pe,nt,U+1,se)}},_resetView:function(p){var T=p&&(p.pinch||p.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),T,T)},_animateZoom:function(p){this._setView(p.center,p.zoom,!0,p.noUpdate)},_clampZoom:function(p){var T=this.options;return T.minNativeZoom!==void 0&&p<T.minNativeZoom?T.minNativeZoom:T.maxNativeZoom!==void 0&&T.maxNativeZoom<p?T.maxNativeZoom:p},_setView:function(p,T,U,se){var Pe=Math.round(T);this.options.maxZoom!==void 0&&Pe>this.options.maxZoom||this.options.minZoom!==void 0&&Pe<this.options.minZoom?Pe=void 0:Pe=this._clampZoom(Pe);var nt=this.options.updateWhenZooming&&Pe!==this._tileZoom;(!se||nt)&&(this._tileZoom=Pe,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),Pe!==void 0&&this._update(p),U||this._pruneTiles(),this._noPrune=!!U),this._setZoomTransforms(p,T)},_setZoomTransforms:function(p,T){for(var U in this._levels)this._setZoomTransform(this._levels[U],p,T)},_setZoomTransform:function(p,T,U){var se=this._map.getZoomScale(U,p.zoom),Pe=p.origin.multiplyBy(se).subtract(this._map._getNewPixelOrigin(T,U)).round();Cn.any3d?uu(p.el,Pe,se):lo(p.el,Pe)},_resetGrid:function(){var p=this._map,T=p.options.crs,U=this._tileSize=this.getTileSize(),se=this._tileZoom,Pe=this._map.getPixelWorldBounds(this._tileZoom);Pe&&(this._globalTileRange=this._pxBoundsToTileRange(Pe)),this._wrapX=T.wrapLng&&!this.options.noWrap&&[Math.floor(p.project([0,T.wrapLng[0]],se).x/U.x),Math.ceil(p.project([0,T.wrapLng[1]],se).x/U.y)],this._wrapY=T.wrapLat&&!this.options.noWrap&&[Math.floor(p.project([T.wrapLat[0],0],se).y/U.x),Math.ceil(p.project([T.wrapLat[1],0],se).y/U.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(p){var T=this._map,U=T._animatingZoom?Math.max(T._animateToZoom,T.getZoom()):T.getZoom(),se=T.getZoomScale(U,this._tileZoom),Pe=T.project(p,this._tileZoom).floor(),nt=T.getSize().divideBy(se*2);return new pt(Pe.subtract(nt),Pe.add(nt))},_update:function(p){var T=this._map;if(T){var U=this._clampZoom(T.getZoom());if(p===void 0&&(p=T.getCenter()),this._tileZoom!==void 0){var se=this._getTiledPixelBounds(p),Pe=this._pxBoundsToTileRange(se),nt=Pe.getCenter(),Jt=[],Dn=this.options.keepBuffer,Jn=new pt(Pe.getBottomLeft().subtract([Dn,-Dn]),Pe.getTopRight().add([Dn,-Dn]));if(!(isFinite(Pe.min.x)&&isFinite(Pe.min.y)&&isFinite(Pe.max.x)&&isFinite(Pe.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ar in this._tiles){var Vr=this._tiles[ar].coords;(Vr.z!==this._tileZoom||!Jn.contains(new Le(Vr.x,Vr.y)))&&(this._tiles[ar].current=!1)}if(Math.abs(U-this._tileZoom)>1){this._setView(p,U);return}for(var Jr=Pe.min.y;Jr<=Pe.max.y;Jr++)for(var Vi=Pe.min.x;Vi<=Pe.max.x;Vi++){var vo=new Le(Vi,Jr);if(vo.z=this._tileZoom,!!this._isValidTile(vo)){var Js=this._tiles[this._tileCoordsToKey(vo)];Js?Js.current=!0:Jt.push(vo)}}if(Jt.sort(function(Ss,ma){return Ss.distanceTo(nt)-ma.distanceTo(nt)}),Jt.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var so=document.createDocumentFragment();for(Vi=0;Vi<Jt.length;Vi++)this._addTile(Jt[Vi],so);this._level.el.appendChild(so)}}}},_isValidTile:function(p){var T=this._map.options.crs;if(!T.infinite){var U=this._globalTileRange;if(!T.wrapLng&&(p.x<U.min.x||p.x>U.max.x)||!T.wrapLat&&(p.y<U.min.y||p.y>U.max.y))return!1}if(!this.options.bounds)return!0;var se=this._tileCoordsToBounds(p);return Ne(this.options.bounds).overlaps(se)},_keyToBounds:function(p){return this._tileCoordsToBounds(this._keyToTileCoords(p))},_tileCoordsToNwSe:function(p){var T=this._map,U=this.getTileSize(),se=p.scaleBy(U),Pe=se.add(U),nt=T.unproject(se,p.z),Jt=T.unproject(Pe,p.z);return[nt,Jt]},_tileCoordsToBounds:function(p){var T=this._tileCoordsToNwSe(p),U=new Ie(T[0],T[1]);return this.options.noWrap||(U=this._map.wrapLatLngBounds(U)),U},_tileCoordsToKey:function(p){return p.x+":"+p.y+":"+p.z},_keyToTileCoords:function(p){var T=p.split(":"),U=new Le(+T[0],+T[1]);return U.z=+T[2],U},_removeTile:function(p){var T=this._tiles[p];T&&(Di(T.el),delete this._tiles[p],this.fire("tileunload",{tile:T.el,coords:this._keyToTileCoords(p)}))},_initTile:function(p){ki(p,"leaflet-tile");var T=this.getTileSize();p.style.width=T.x+"px",p.style.height=T.y+"px",p.onselectstart=w,p.onmousemove=w,Cn.ielt9&&this.options.opacity<1&&Co(p,this.options.opacity)},_addTile:function(p,T){var U=this._getTilePos(p),se=this._tileCoordsToKey(p),Pe=this.createTile(this._wrapCoords(p),a(this._tileReady,this,p));this._initTile(Pe),this.createTile.length<2&&he(a(this._tileReady,this,p,null,Pe)),lo(Pe,U),this._tiles[se]={el:Pe,coords:p,current:!0},T.appendChild(Pe),this.fire("tileloadstart",{tile:Pe,coords:p})},_tileReady:function(p,T,U){T&&this.fire("tileerror",{error:T,tile:U,coords:p});var se=this._tileCoordsToKey(p);U=this._tiles[se],U&&(U.loaded=+new Date,this._map._fadeAnimated?(Co(U.el,0),de(this._fadeFrame),this._fadeFrame=he(this._updateOpacity,this)):(U.active=!0,this._pruneTiles()),T||(ki(U.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:U.el,coords:p})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Cn.ielt9||!this._map._fadeAnimated?he(this._pruneTiles,this):setTimeout(a(this._pruneTiles,this),250)))},_getTilePos:function(p){return p.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(p){var T=new Le(this._wrapX?_(p.x,this._wrapX):p.x,this._wrapY?_(p.y,this._wrapY):p.y);return T.z=p.z,T},_pxBoundsToTileRange:function(p){var T=this.getTileSize();return new pt(p.min.unscaleBy(T).floor(),p.max.unscaleBy(T).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var p in this._tiles)if(!this._tiles[p].loaded)return!1;return!0}});function fa(p){return new Ui(p)}var Uo=Ui.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(p,T){this._url=p,T=z(this,T),T.detectRetina&&Cn.retina&&T.maxZoom>0?(T.tileSize=Math.floor(T.tileSize/2),T.zoomReverse?(T.zoomOffset--,T.minZoom=Math.min(T.maxZoom,T.minZoom+1)):(T.zoomOffset++,T.maxZoom=Math.max(T.minZoom,T.maxZoom-1)),T.minZoom=Math.max(0,T.minZoom)):T.zoomReverse?T.minZoom=Math.min(T.maxZoom,T.minZoom):T.maxZoom=Math.max(T.minZoom,T.maxZoom),typeof T.subdomains=="string"&&(T.subdomains=T.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(p,T){return this._url===p&&T===void 0&&(T=!0),this._url=p,T||this.redraw(),this},createTile:function(p,T){var U=document.createElement("img");return Mi(U,"load",a(this._tileOnLoad,this,T,U)),Mi(U,"error",a(this._tileOnError,this,T,U)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(U.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(U.referrerPolicy=this.options.referrerPolicy),U.alt="",U.src=this.getTileUrl(p),U},getTileUrl:function(p){var T={r:Cn.retina?"@2x":"",s:this._getSubdomain(p),x:p.x,y:p.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var U=this._globalTileRange.max.y-p.y;this.options.tms&&(T.y=U),T["-y"]=U}return Y(this._url,i(T,this.options))},_tileOnLoad:function(p,T){Cn.ielt9?setTimeout(a(p,this,null,T),0):p(null,T)},_tileOnError:function(p,T,U){var se=this.options.errorTileUrl;se&&T.getAttribute("src")!==se&&(T.src=se),p(U,T)},_onTileRemove:function(p){p.tile.onload=null},_getZoomForUrl:function(){var p=this._tileZoom,T=this.options.maxZoom,U=this.options.zoomReverse,se=this.options.zoomOffset;return U&&(p=T-p),p+se},_getSubdomain:function(p){var T=Math.abs(p.x+p.y)%this.options.subdomains.length;return this.options.subdomains[T]},_abortLoading:function(){var p,T;for(p in this._tiles)if(this._tiles[p].coords.z!==this._tileZoom&&(T=this._tiles[p].el,T.onload=w,T.onerror=w,!T.complete)){T.src=le;var U=this._tiles[p].coords;Di(T),delete this._tiles[p],this.fire("tileabort",{tile:T,coords:U})}},_removeTile:function(p){var T=this._tiles[p];if(T)return T.el.setAttribute("src",le),Ui.prototype._removeTile.call(this,p)},_tileReady:function(p,T,U){if(!(!this._map||U&&U.getAttribute("src")===le))return Ui.prototype._tileReady.call(this,p,T,U)}});function bs(p,T){return new Uo(p,T)}var oi=Uo.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(p,T){this._url=p;var U=i({},this.defaultWmsParams);for(var se in T)se in this.options||(U[se]=T[se]);T=z(this,T);var Pe=T.detectRetina&&Cn.retina?2:1,nt=this.getTileSize();U.width=nt.x*Pe,U.height=nt.y*Pe,this.wmsParams=U},onAdd:function(p){this._crs=this.options.crs||p.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var T=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[T]=this._crs.code,Uo.prototype.onAdd.call(this,p)},getTileUrl:function(p){var T=this._tileCoordsToNwSe(p),U=this._crs,se=ge(U.project(T[0]),U.project(T[1])),Pe=se.min,nt=se.max,Jt=(this._wmsVersion>=1.3&&this._crs===yo?[Pe.y,Pe.x,nt.y,nt.x]:[Pe.x,Pe.y,nt.x,nt.y]).join(","),Dn=Uo.prototype.getTileUrl.call(this,p);return Dn+W(this.wmsParams,Dn,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+Jt},setParams:function(p,T){return i(this.wmsParams,p),T||this.redraw(),this}});function io(p,T){return new oi(p,T)}Uo.WMS=oi,bs.wms=io;var Us=Ri.extend({options:{padding:.1},initialize:function(p){z(this,p),f(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ki(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var p={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(p.zoomanim=this._onAnimZoom),p},_onAnimZoom:function(p){this._updateTransform(p.center,p.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(p,T){var U=this._map.getZoomScale(T,this._zoom),se=this._map.getSize().multiplyBy(.5+this.options.padding),Pe=this._map.project(this._center,T),nt=se.multiplyBy(-U).add(Pe).subtract(this._map._getNewPixelOrigin(p,T));Cn.any3d?uu(this._container,nt,U):lo(this._container,nt)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var p in this._layers)this._layers[p]._reset()},_onZoomEnd:function(){for(var p in this._layers)this._layers[p]._project()},_updatePaths:function(){for(var p in this._layers)this._layers[p]._update()},_update:function(){var p=this.options.padding,T=this._map.getSize(),U=this._map.containerPointToLayerPoint(T.multiplyBy(-p)).round();this._bounds=new pt(U,U.add(T.multiplyBy(1+p*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),pa=Us.extend({options:{tolerance:0},getEvents:function(){var p=Us.prototype.getEvents.call(this);return p.viewprereset=this._onViewPreReset,p},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Us.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var p=this._container=document.createElement("canvas");Mi(p,"mousemove",this._onMouseMove,this),Mi(p,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Mi(p,"mouseout",this._handleMouseOut,this),p._leaflet_disable_events=!0,this._ctx=p.getContext("2d")},_destroyContainer:function(){de(this._redrawRequest),delete this._ctx,Di(this._container),Bi(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var p;this._redrawBounds=null;for(var T in this._layers)p=this._layers[T],p._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Us.prototype._update.call(this);var p=this._bounds,T=this._container,U=p.getSize(),se=Cn.retina?2:1;lo(T,p.min),T.width=se*U.x,T.height=se*U.y,T.style.width=U.x+"px",T.style.height=U.y+"px",Cn.retina&&this._ctx.scale(2,2),this._ctx.translate(-p.min.x,-p.min.y),this.fire("update")}},_reset:function(){Us.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(p){this._updateDashArray(p),this._layers[f(p)]=p;var T=p._order={layer:p,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=T),this._drawLast=T,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(p){this._requestRedraw(p)},_removePath:function(p){var T=p._order,U=T.next,se=T.prev;U?U.prev=se:this._drawLast=se,se?se.next=U:this._drawFirst=U,delete p._order,delete this._layers[f(p)],this._requestRedraw(p)},_updatePath:function(p){this._extendRedrawBounds(p),p._project(),p._update(),this._requestRedraw(p)},_updateStyle:function(p){this._updateDashArray(p),this._requestRedraw(p)},_updateDashArray:function(p){if(typeof p.options.dashArray=="string"){var T=p.options.dashArray.split(/[, ]+/),U=[],se,Pe;for(Pe=0;Pe<T.length;Pe++){if(se=Number(T[Pe]),isNaN(se))return;U.push(se)}p.options._dashArray=U}else p.options._dashArray=p.options.dashArray},_requestRedraw:function(p){this._map&&(this._extendRedrawBounds(p),this._redrawRequest=this._redrawRequest||he(this._redraw,this))},_extendRedrawBounds:function(p){if(p._pxBounds){var T=(p.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new pt,this._redrawBounds.extend(p._pxBounds.min.subtract([T,T])),this._redrawBounds.extend(p._pxBounds.max.add([T,T]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var p=this._redrawBounds;if(p){var T=p.getSize();this._ctx.clearRect(p.min.x,p.min.y,T.x,T.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var p,T=this._redrawBounds;if(this._ctx.save(),T){var U=T.getSize();this._ctx.beginPath(),this._ctx.rect(T.min.x,T.min.y,U.x,U.y),this._ctx.clip()}this._drawing=!0;for(var se=this._drawFirst;se;se=se.next)p=se.layer,(!T||p._pxBounds&&p._pxBounds.intersects(T))&&p._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(p,T){if(this._drawing){var U,se,Pe,nt,Jt=p._parts,Dn=Jt.length,Jn=this._ctx;if(Dn){for(Jn.beginPath(),U=0;U<Dn;U++){for(se=0,Pe=Jt[U].length;se<Pe;se++)nt=Jt[U][se],Jn[se?"lineTo":"moveTo"](nt.x,nt.y);T&&Jn.closePath()}this._fillStroke(Jn,p)}}},_updateCircle:function(p){if(!(!this._drawing||p._empty())){var T=p._point,U=this._ctx,se=Math.max(Math.round(p._radius),1),Pe=(Math.max(Math.round(p._radiusY),1)||se)/se;Pe!==1&&(U.save(),U.scale(1,Pe)),U.beginPath(),U.arc(T.x,T.y/Pe,se,0,Math.PI*2,!1),Pe!==1&&U.restore(),this._fillStroke(U,p)}},_fillStroke:function(p,T){var U=T.options;U.fill&&(p.globalAlpha=U.fillOpacity,p.fillStyle=U.fillColor||U.color,p.fill(U.fillRule||"evenodd")),U.stroke&&U.weight!==0&&(p.setLineDash&&p.setLineDash(T.options&&T.options._dashArray||[]),p.globalAlpha=U.opacity,p.lineWidth=U.weight,p.strokeStyle=U.color,p.lineCap=U.lineCap,p.lineJoin=U.lineJoin,p.stroke())},_onClick:function(p){for(var T=this._map.mouseEventToLayerPoint(p),U,se,Pe=this._drawFirst;Pe;Pe=Pe.next)U=Pe.layer,U.options.interactive&&U._containsPoint(T)&&(!(p.type==="click"||p.type==="preclick")||!this._map._draggableMoved(U))&&(se=U);this._fireEvent(se?[se]:!1,p)},_onMouseMove:function(p){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var T=this._map.mouseEventToLayerPoint(p);this._handleMouseHover(p,T)}},_handleMouseOut:function(p){var T=this._hoveredLayer;T&&(is(this._container,"leaflet-interactive"),this._fireEvent([T],p,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(p,T){if(!this._mouseHoverThrottled){for(var U,se,Pe=this._drawFirst;Pe;Pe=Pe.next)U=Pe.layer,U.options.interactive&&U._containsPoint(T)&&(se=U);se!==this._hoveredLayer&&(this._handleMouseOut(p),se&&(ki(this._container,"leaflet-interactive"),this._fireEvent([se],p,"mouseover"),this._hoveredLayer=se)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,p),this._mouseHoverThrottled=!0,setTimeout(a(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(p,T,U){this._map._fireDOMEvent(T,U||T.type,p)},_bringToFront:function(p){var T=p._order;if(T){var U=T.next,se=T.prev;if(U)U.prev=se;else return;se?se.next=U:U&&(this._drawFirst=U),T.prev=this._drawLast,this._drawLast.next=T,T.next=null,this._drawLast=T,this._requestRedraw(p)}},_bringToBack:function(p){var T=p._order;if(T){var U=T.next,se=T.prev;if(se)se.next=U;else return;U?U.prev=se:se&&(this._drawLast=se),T.prev=null,T.next=this._drawFirst,this._drawFirst.prev=T,this._drawFirst=T,this._requestRedraw(p)}}});function Vo(p){return Cn.canvas?new pa(p):null}var xl=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(p){return document.createElement("<lvml:"+p+' class="lvml">')}}catch{}return function(p){return document.createElement("<"+p+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),ah={_initContainer:function(){this._container=ds("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Us.prototype._update.call(this),this.fire("update"))},_initPath:function(p){var T=p._container=xl("shape");ki(T,"leaflet-vml-shape "+(this.options.className||"")),T.coordsize="1 1",p._path=xl("path"),T.appendChild(p._path),this._updateStyle(p),this._layers[f(p)]=p},_addPath:function(p){var T=p._container;this._container.appendChild(T),p.options.interactive&&p.addInteractiveTarget(T)},_removePath:function(p){var T=p._container;Di(T),p.removeInteractiveTarget(T),delete this._layers[f(p)]},_updateStyle:function(p){var T=p._stroke,U=p._fill,se=p.options,Pe=p._container;Pe.stroked=!!se.stroke,Pe.filled=!!se.fill,se.stroke?(T||(T=p._stroke=xl("stroke")),Pe.appendChild(T),T.weight=se.weight+"px",T.color=se.color,T.opacity=se.opacity,se.dashArray?T.dashStyle=Q(se.dashArray)?se.dashArray.join(" "):se.dashArray.replace(/( *, *)/g," "):T.dashStyle="",T.endcap=se.lineCap.replace("butt","flat"),T.joinstyle=se.lineJoin):T&&(Pe.removeChild(T),p._stroke=null),se.fill?(U||(U=p._fill=xl("fill")),Pe.appendChild(U),U.color=se.fillColor||se.color,U.opacity=se.fillOpacity):U&&(Pe.removeChild(U),p._fill=null)},_updateCircle:function(p){var T=p._point.round(),U=Math.round(p._radius),se=Math.round(p._radiusY||U);this._setPath(p,p._empty()?"M0 0":"AL "+T.x+","+T.y+" "+U+","+se+" 0,"+65535*360)},_setPath:function(p,T){p._path.v=T},_bringToFront:function(p){lu(p._container)},_bringToBack:function(p){gl(p._container)}},wl=Cn.vml?xl:Be,To=Us.extend({_initContainer:function(){this._container=wl("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=wl("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Di(this._container),Bi(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Us.prototype._update.call(this);var p=this._bounds,T=p.getSize(),U=this._container;(!this._svgSize||!this._svgSize.equals(T))&&(this._svgSize=T,U.setAttribute("width",T.x),U.setAttribute("height",T.y)),lo(U,p.min),U.setAttribute("viewBox",[p.min.x,p.min.y,T.x,T.y].join(" ")),this.fire("update")}},_initPath:function(p){var T=p._path=wl("path");p.options.className&&ki(T,p.options.className),p.options.interactive&&ki(T,"leaflet-interactive"),this._updateStyle(p),this._layers[f(p)]=p},_addPath:function(p){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(p._path),p.addInteractiveTarget(p._path)},_removePath:function(p){Di(p._path),p.removeInteractiveTarget(p._path),delete this._layers[f(p)]},_updatePath:function(p){p._project(),p._update()},_updateStyle:function(p){var T=p._path,U=p.options;T&&(U.stroke?(T.setAttribute("stroke",U.color),T.setAttribute("stroke-opacity",U.opacity),T.setAttribute("stroke-width",U.weight),T.setAttribute("stroke-linecap",U.lineCap),T.setAttribute("stroke-linejoin",U.lineJoin),U.dashArray?T.setAttribute("stroke-dasharray",U.dashArray):T.removeAttribute("stroke-dasharray"),U.dashOffset?T.setAttribute("stroke-dashoffset",U.dashOffset):T.removeAttribute("stroke-dashoffset")):T.setAttribute("stroke","none"),U.fill?(T.setAttribute("fill",U.fillColor||U.color),T.setAttribute("fill-opacity",U.fillOpacity),T.setAttribute("fill-rule",U.fillRule||"evenodd")):T.setAttribute("fill","none"))},_updatePoly:function(p,T){this._setPath(p,Ce(p._parts,T))},_updateCircle:function(p){var T=p._point,U=Math.max(Math.round(p._radius),1),se=Math.max(Math.round(p._radiusY),1)||U,Pe="a"+U+","+se+" 0 1,0 ",nt=p._empty()?"M0 0":"M"+(T.x-U)+","+T.y+Pe+U*2+",0 "+Pe+-U*2+",0 ";this._setPath(p,nt)},_setPath:function(p,T){p._path.setAttribute("d",T)},_bringToFront:function(p){lu(p._path)},_bringToBack:function(p){gl(p._path)}});Cn.vml&&To.include(ah);function ks(p){return Cn.svg||Cn.vml?new To(p):null}Hi.include({getRenderer:function(p){var T=p.options.renderer||this._getPaneRenderer(p.options.pane)||this.options.renderer||this._renderer;return T||(T=this._renderer=this._createRenderer()),this.hasLayer(T)||this.addLayer(T),T},_getPaneRenderer:function(p){if(p==="overlayPane"||p===void 0)return!1;var T=this._paneRenderers[p];return T===void 0&&(T=this._createRenderer({pane:p}),this._paneRenderers[p]=T),T},_createRenderer:function(p){return this.options.preferCanvas&&Vo(p)||ks(p)}});var ho=Mo.extend({initialize:function(p,T){Mo.prototype.initialize.call(this,this._boundsToLatLngs(p),T)},setBounds:function(p){return this.setLatLngs(this._boundsToLatLngs(p))},_boundsToLatLngs:function(p){return p=Ne(p),[p.getSouthWest(),p.getNorthWest(),p.getNorthEast(),p.getSouthEast()]}});function $o(p,T){return new ho(p,T)}To.create=wl,To.pointsToPath=Ce,mi.geometryToLayer=jo,mi.coordsToLatLng=Nu,mi.coordsToLatLngs=da,mi.latLngToCoords=ta,mi.latLngsToCoords=Ul,mi.getFeature=ol,mi.asFeature=na,Hi.mergeOptions({boxZoom:!0});var vi=ss.extend({initialize:function(p){this._map=p,this._container=p._container,this._pane=p._panes.overlayPane,this._resetStateTimeout=0,p.on("unload",this._destroy,this)},addHooks:function(){Mi(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Bi(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Di(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(p){if(!p.shiftKey||p.which!==1&&p.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),tl(),rl(),this._startPoint=this._map.mouseEventToContainerPoint(p),Mi(document,{contextmenu:Fi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(p){this._moved||(this._moved=!0,this._box=ds("div","leaflet-zoom-box",this._container),ki(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(p);var T=new pt(this._point,this._startPoint),U=T.getSize();lo(this._box,T.min),this._box.style.width=U.x+"px",this._box.style.height=U.y+"px"},_finish:function(){this._moved&&(Di(this._box),is(this._container,"leaflet-crosshair")),ui(),Ws(),Bi(document,{contextmenu:Fi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(p){if(!(p.which!==1&&p.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(a(this._resetState,this),0);var T=new Ie(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(T).fire("boxzoomend",{boxZoomBounds:T})}},_onKeyDown:function(p){p.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Hi.addInitHook("addHandler","boxZoom",vi),Hi.mergeOptions({doubleClickZoom:!0});var $l=ss.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(p){var T=this._map,U=T.getZoom(),se=T.options.zoomDelta,Pe=p.originalEvent.shiftKey?U-se:U+se;T.options.doubleClickZoom==="center"?T.setZoom(Pe):T.setZoomAround(p.containerPoint,Pe)}});Hi.addInitHook("addHandler","doubleClickZoom",$l),Hi.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var yu=ss.extend({addHooks:function(){if(!this._draggable){var p=this._map;this._draggable=new Fl(p._mapPane,p._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),p.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),p.on("zoomend",this._onZoomEnd,this),p.whenReady(this._onZoomEnd,this))}ki(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){is(this._map._container,"leaflet-grab"),is(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var p=this._map;if(p._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var T=Ne(this._map.options.maxBounds);this._offsetLimit=ge(this._map.latLngToContainerPoint(T.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(T.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;p.fire("movestart").fire("dragstart"),p.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(p){if(this._map.options.inertia){var T=this._lastTime=+new Date,U=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(U),this._times.push(T),this._prunePositions(T)}this._map.fire("move",p).fire("drag",p)},_prunePositions:function(p){for(;this._positions.length>1&&p-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var p=this._map.getSize().divideBy(2),T=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=T.subtract(p).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(p,T){return p-(p-T)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var p=this._draggable._newPos.subtract(this._draggable._startPos),T=this._offsetLimit;p.x<T.min.x&&(p.x=this._viscousLimit(p.x,T.min.x)),p.y<T.min.y&&(p.y=this._viscousLimit(p.y,T.min.y)),p.x>T.max.x&&(p.x=this._viscousLimit(p.x,T.max.x)),p.y>T.max.y&&(p.y=this._viscousLimit(p.y,T.max.y)),this._draggable._newPos=this._draggable._startPos.add(p)}},_onPreDragWrap:function(){var p=this._worldWidth,T=Math.round(p/2),U=this._initialWorldOffset,se=this._draggable._newPos.x,Pe=(se-T+U)%p+T-U,nt=(se+T+U)%p-T-U,Jt=Math.abs(Pe+U)<Math.abs(nt+U)?Pe:nt;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=Jt},_onDragEnd:function(p){var T=this._map,U=T.options,se=!U.inertia||p.noInertia||this._times.length<2;if(T.fire("dragend",p),se)T.fire("moveend");else{this._prunePositions(+new Date);var Pe=this._lastPos.subtract(this._positions[0]),nt=(this._lastTime-this._times[0])/1e3,Jt=U.easeLinearity,Dn=Pe.multiplyBy(Jt/nt),Jn=Dn.distanceTo([0,0]),ar=Math.min(U.inertiaMaxSpeed,Jn),Vr=Dn.multiplyBy(ar/Jn),Jr=ar/(U.inertiaDeceleration*Jt),Vi=Vr.multiplyBy(-Jr/2).round();!Vi.x&&!Vi.y?T.fire("moveend"):(Vi=T._limitOffset(Vi,T.options.maxBounds),he(function(){T.panBy(Vi,{duration:Jr,easeLinearity:Jt,noMoveStart:!0,animate:!0})}))}}});Hi.addInitHook("addHandler","dragging",yu),Hi.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Ha=ss.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(p){this._map=p,this._setPanDelta(p.options.keyboardPanDelta),this._setZoomDelta(p.options.zoomDelta)},addHooks:function(){var p=this._map._container;p.tabIndex<=0&&(p.tabIndex="0"),Mi(p,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Bi(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var p=document.body,T=document.documentElement,U=p.scrollTop||T.scrollTop,se=p.scrollLeft||T.scrollLeft;this._map._container.focus(),window.scrollTo(se,U)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(p){var T=this._panKeys={},U=this.keyCodes,se,Pe;for(se=0,Pe=U.left.length;se<Pe;se++)T[U.left[se]]=[-1*p,0];for(se=0,Pe=U.right.length;se<Pe;se++)T[U.right[se]]=[p,0];for(se=0,Pe=U.down.length;se<Pe;se++)T[U.down[se]]=[0,p];for(se=0,Pe=U.up.length;se<Pe;se++)T[U.up[se]]=[0,-1*p]},_setZoomDelta:function(p){var T=this._zoomKeys={},U=this.keyCodes,se,Pe;for(se=0,Pe=U.zoomIn.length;se<Pe;se++)T[U.zoomIn[se]]=p;for(se=0,Pe=U.zoomOut.length;se<Pe;se++)T[U.zoomOut[se]]=-p},_addHooks:function(){Mi(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Bi(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(p){if(!(p.altKey||p.ctrlKey||p.metaKey)){var T=p.keyCode,U=this._map,se;if(T in this._panKeys){if(!U._panAnim||!U._panAnim._inProgress)if(se=this._panKeys[T],p.shiftKey&&(se=He(se).multiplyBy(3)),U.options.maxBounds&&(se=U._limitOffset(He(se),U.options.maxBounds)),U.options.worldCopyJump){var Pe=U.wrapLatLng(U.unproject(U.project(U.getCenter()).add(se)));U.panTo(Pe)}else U.panBy(se)}else if(T in this._zoomKeys)U.setZoom(U.getZoom()+(p.shiftKey?3:1)*this._zoomKeys[T]);else if(T===27&&U._popup&&U._popup.options.closeOnEscapeKey)U.closePopup();else return;Fi(p)}}});Hi.addInitHook("addHandler","keyboard",Ha),Hi.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Go=ss.extend({addHooks:function(){Mi(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Bi(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(p){var T=hu(p),U=this._map.options.wheelDebounceTime;this._delta+=T,this._lastMousePos=this._map.mouseEventToContainerPoint(p),this._startTime||(this._startTime=+new Date);var se=Math.max(U-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(a(this._performZoom,this),se),Fi(p)},_performZoom:function(){var p=this._map,T=p.getZoom(),U=this._map.options.zoomSnap||0;p._stop();var se=this._delta/(this._map.options.wheelPxPerZoomLevel*4),Pe=4*Math.log(2/(1+Math.exp(-Math.abs(se))))/Math.LN2,nt=U?Math.ceil(Pe/U)*U:Pe,Jt=p._limitZoom(T+(this._delta>0?nt:-nt))-T;this._delta=0,this._startTime=null,Jt&&(p.options.scrollWheelZoom==="center"?p.setZoom(T+Jt):p.setZoomAround(this._lastMousePos,T+Jt))}});Hi.addInitHook("addHandler","scrollWheelZoom",Go);var Uc=600;Hi.mergeOptions({tapHold:Cn.touchNative&&Cn.safari&&Cn.mobile,tapTolerance:15});var Ho=ss.extend({addHooks:function(){Mi(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Bi(this._map._container,"touchstart",this._onDown,this)},_onDown:function(p){if(clearTimeout(this._holdTimeout),p.touches.length===1){var T=p.touches[0];this._startPos=this._newPos=new Le(T.clientX,T.clientY),this._holdTimeout=setTimeout(a(function(){this._cancel(),this._isTapValid()&&(Mi(document,"touchend",Nr),Mi(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",T))},this),Uc),Mi(document,"touchend touchcancel contextmenu",this._cancel,this),Mi(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function p(){Bi(document,"touchend",Nr),Bi(document,"touchend touchcancel",p)},_cancel:function(){clearTimeout(this._holdTimeout),Bi(document,"touchend touchcancel contextmenu",this._cancel,this),Bi(document,"touchmove",this._onMove,this)},_onMove:function(p){var T=p.touches[0];this._newPos=new Le(T.clientX,T.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(p,T){var U=new MouseEvent(p,{bubbles:!0,cancelable:!0,view:window,screenX:T.screenX,screenY:T.screenY,clientX:T.clientX,clientY:T.clientY});U._simulated=!0,T.target.dispatchEvent(U)}});Hi.addInitHook("addHandler","tapHold",Ho),Hi.mergeOptions({touchZoom:Cn.touch,bounceAtZoomLimits:!0});var Ao=ss.extend({addHooks:function(){ki(this._map._container,"leaflet-touch-zoom"),Mi(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){is(this._map._container,"leaflet-touch-zoom"),Bi(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(p){var T=this._map;if(!(!p.touches||p.touches.length!==2||T._animatingZoom||this._zooming)){var U=T.mouseEventToContainerPoint(p.touches[0]),se=T.mouseEventToContainerPoint(p.touches[1]);this._centerPoint=T.getSize()._divideBy(2),this._startLatLng=T.containerPointToLatLng(this._centerPoint),T.options.touchZoom!=="center"&&(this._pinchStartLatLng=T.containerPointToLatLng(U.add(se)._divideBy(2))),this._startDist=U.distanceTo(se),this._startZoom=T.getZoom(),this._moved=!1,this._zooming=!0,T._stop(),Mi(document,"touchmove",this._onTouchMove,this),Mi(document,"touchend touchcancel",this._onTouchEnd,this),Nr(p)}},_onTouchMove:function(p){if(!(!p.touches||p.touches.length!==2||!this._zooming)){var T=this._map,U=T.mouseEventToContainerPoint(p.touches[0]),se=T.mouseEventToContainerPoint(p.touches[1]),Pe=U.distanceTo(se)/this._startDist;if(this._zoom=T.getScaleZoom(Pe,this._startZoom),!T.options.bounceAtZoomLimits&&(this._zoom<T.getMinZoom()&&Pe<1||this._zoom>T.getMaxZoom()&&Pe>1)&&(this._zoom=T._limitZoom(this._zoom)),T.options.touchZoom==="center"){if(this._center=this._startLatLng,Pe===1)return}else{var nt=U._add(se)._divideBy(2)._subtract(this._centerPoint);if(Pe===1&&nt.x===0&&nt.y===0)return;this._center=T.unproject(T.project(this._pinchStartLatLng,this._zoom).subtract(nt),this._zoom)}this._moved||(T._moveStart(!0,!1),this._moved=!0),de(this._animRequest);var Jt=a(T._move,T,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=he(Jt,this,!0),Nr(p)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,de(this._animRequest),Bi(document,"touchmove",this._onTouchMove,this),Bi(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Hi.addInitHook("addHandler","touchZoom",Ao),Hi.BoxZoom=vi,Hi.DoubleClickZoom=$l,Hi.Drag=yu,Hi.Keyboard=Ha,Hi.ScrollWheelZoom=Go,Hi.TapHold=Ho,Hi.TouchZoom=Ao,n.Bounds=pt,n.Browser=Cn,n.CRS=lt,n.Canvas=pa,n.Circle=Xs,n.CircleMarker=Ta,n.Class=be,n.Control=di,n.DivIcon=ll,n.DivOverlay=ra,n.DomEvent=Iu,n.DomUtil=yi,n.Draggable=Fl,n.Evented=Se,n.FeatureGroup=Eo,n.GeoJSON=mi,n.GridLayer=Ui,n.Handler=ss,n.Icon=sl,n.ImageOverlay=Hr,n.LatLng=Ve,n.LatLngBounds=Ie,n.Layer=Ri,n.LayerGroup=Qo,n.LineUtil=Xi,n.Map=Hi,n.Marker=_o,n.Mixin=Lc,n.Path=ha,n.Point=Le,n.PolyUtil=zl,n.Polygon=Mo,n.Polyline=ea,n.Popup=Ts,n.PosAnimation=fu,n.Projection=_s,n.Rectangle=ho,n.Renderer=Us,n.SVG=To,n.SVGOverlay=Cs,n.TileLayer=Uo,n.Tooltip=bl,n.Transformation=yn,n.Util=Te,n.VideoOverlay=xi,n.bind=a,n.bounds=ge,n.canvas=Vo,n.circle=zo,n.circleMarker=gu,n.control=ro,n.divIcon=Vl,n.extend=i,n.featureGroup=Fc,n.geoJSON=nr,n.geoJson=Fn,n.gridLayer=fa,n.icon=zc,n.imageOverlay=ii,n.latLng=it,n.latLngBounds=Ne,n.layerGroup=mu,n.map=Ks,n.marker=_l,n.point=He,n.polygon=jl,n.polyline=jc,n.popup=al,n.rectangle=$o,n.setOptions=z,n.stamp=f,n.svg=ks,n.svgOverlay=dc,n.tileLayer=bs,n.tooltip=Ga,n.transformation=Pn,n.version=r,n.videoOverlay=as;var Gl=window.L;n.noConflict=function(){return window.L=Gl,this},window.L=n})})(X4,X4.exports);var jr=X4.exports;const Ba=Mg(jr);var GL={exports:{}};(function(e,t){(function(n,r){r(t)})(lc,function(n){var r=typeof window<"u"?window:typeof lc<"u"?lc:typeof self<"u"?self:{};function i(m,_){return m(_={exports:{}},_.exports),_.exports}var l=i(function(m,_){(function(w){const M={escape:function(ae){return ae.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},parseExtension:C,mimeType:function(ae){return ae=C(ae).toLowerCase(),function(){var ne="application/font-woff",Se="image/jpeg";return{woff:ne,woff2:ne,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Se,jpeg:Se,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}()[ae]||""},dataAsUrl:function(ae,ne){return`data:${ne};base64,`+ae},isDataUrl:function(ae){return ae.search(/^(data:)/)!==-1},canvasToBlob:function(ae){return ae.toBlob?new Promise(function(Se){ae.toBlob(Se)}):(ne=ae,new Promise(function(Se){const Le=we(ne.toDataURL().split(",")[1]);var ze=Le.length;const He=new Uint8Array(ze);for(let pt=0;pt<ze;pt++)He[pt]=Le.charCodeAt(pt);Se(new Blob([He],{type:"image/png"}))}));var ne},resolveUrl:function(ae,ne){const Se=document.implementation.createHTMLDocument(),Le=Se.createElement("base"),ze=(Se.head.appendChild(Le),Se.createElement("a"));return Se.body.appendChild(ze),Le.href=ne,ze.href=ae,ze.href},getAndEncode:function(ae){let ne=le.impl.urlCache.find(function(Se){return Se.url===ae});return ne||(ne={url:ae,promise:null},le.impl.urlCache.push(ne)),ne.promise===null&&(le.impl.options.cacheBust&&(ae+=(/\?/.test(ae)?"&":"?")+new Date().getTime()),ne.promise=new Promise(function(Se){const Le=le.impl.options.httpTimeout,ze=new XMLHttpRequest;let He;var pt;function ge(Ie){console.error(Ie),Se("")}ze.onreadystatechange=function(){if(ze.readyState===4)if(ze.status!==200)He?Se(He):ge(`cannot fetch resource: ${ae}, status: `+ze.status);else{const Ie=new FileReader;Ie.onloadend=function(){var Ne=Ie.result.split(/,/)[1];Se(Ne)},Ie.readAsDataURL(ze.response)}},ze.ontimeout=function(){He?Se(He):ge(`timeout of ${Le}ms occured while fetching resource: `+ae)},ze.responseType="blob",ze.timeout=Le,le.impl.options.useCredentials&&(ze.withCredentials=!0),ze.open("GET",ae,!0),ze.send(),le.impl.options.imagePlaceholder&&(pt=le.impl.options.imagePlaceholder.split(/,/))&&pt[1]&&(He=pt[1])})),ne.promise},uid:function(){let ae=0;return function(){return"u"+("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+ae++}}(),delay:function(ae){return function(ne){return new Promise(function(Se){setTimeout(function(){Se(ne)},ae)})}},asArray:function(ae){const ne=[],Se=ae.length;for(let Le=0;Le<Se;Le++)ne.push(ae[Le]);return ne},escapeXhtml:function(ae){return ae.replace(/%/g,"%25").replace(/#/g,"%23").replace(/\n/g,"%0A")},makeImage:function(ae){return ae!=="data:,"?new Promise(function(ne,Se){const Le=new Image;le.impl.options.useCredentials&&(Le.crossOrigin="use-credentials"),Le.onload=function(){ne(Le)},Le.onerror=Se,Le.src=ae}):Promise.resolve()},width:function(ae){var ne=R(ae,"border-left-width"),Se=R(ae,"border-right-width");return ae.scrollWidth+ne+Se},height:function(ae){var ne=R(ae,"border-top-width"),Se=R(ae,"border-bottom-width");return ae.scrollHeight+ne+Se}};function C(ae){return(ae=/\.([^\.\/]*?)(\?|$)/g.exec(ae))?ae[1]:""}function R(ae,ne){const Se=me(ae).getPropertyValue(ne);return parseFloat(Se.replace("px",""))}const z=function(){const ae=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(ze,He,pt){return ne(ze)?Promise.resolve(ze).then(Se).then(function(ge){let Ie=Promise.resolve(ze);return ge.forEach(function(Ne){Ie=Ie.then(function(Ve){return Le(Ve,Ne,He,pt)})}),Ie}):Promise.resolve(ze)},shouldProcess:ne,impl:{readUrls:Se,inline:Le}};function ne(ze){return ze.search(ae)!==-1}function Se(ze){const He=[];for(var pt;(pt=ae.exec(ze))!==null;)He.push(pt[1]);return He.filter(function(ge){return!M.isDataUrl(ge)})}function Le(ze,He,pt,ge){return Promise.resolve(He).then(function(Ie){return pt?M.resolveUrl(Ie,pt):Ie}).then(ge||M.getAndEncode).then(function(Ie){return M.dataAsUrl(Ie,M.mimeType(He))}).then(function(Ie){return ze.replace((Ne=He,new RegExp(`(url\\(['"]?)(${M.escape(Ne)})(['"]?\\))`,"g")),`$1${Ie}$3`);var Ne})}}(),W={resolveAll:function(){return X().then(function(ae){return Promise.all(ae.map(function(ne){return ne.resolve()}))}).then(function(ae){return ae.join(`
`)})},impl:{readAll:X}};function X(){return Promise.resolve(M.asArray(document.styleSheets)).then(function(ne){const Se=[];return ne.forEach(function(Le){if(Object.getPrototypeOf(Le).hasOwnProperty("cssRules"))try{M.asArray(Le.cssRules||[]).forEach(Se.push.bind(Se))}catch(ze){console.log("Error while reading CSS rules from "+Le.href,ze.toString())}}),Se}).then(function(ne){return ne.filter(function(Se){return Se.type===CSSRule.FONT_FACE_RULE}).filter(function(Se){return z.shouldProcess(Se.style.getPropertyValue("src"))})}).then(function(ne){return ne.map(ae)});function ae(ne){return{resolve:function(){var Se=(ne.parentStyleSheet||{}).href;return z.inlineAll(ne.cssText,Se)},src:function(){return ne.style.getPropertyValue("src")}}}}const Y={inlineAll:function ae(ne){return ne instanceof Element?function(Se){const Le=Se.style.getPropertyValue("background");return Le?z.inlineAll(Le).then(function(ze){Se.style.setProperty("background",ze,Le)}).then(function(){return Se}):Promise.resolve(Se)}(ne).then(function(){return ne instanceof HTMLImageElement?Q(ne).inline():Promise.all(M.asArray(ne.childNodes).map(function(Se){return ae(Se)}))}):Promise.resolve(ne)},impl:{newImage:Q}};function Q(ae){return{inline:function(ne){return M.isDataUrl(ae.src)?Promise.resolve():Promise.resolve(ae.src).then(ne||M.getAndEncode).then(function(Se){return M.dataAsUrl(Se,M.mimeType(ae.src))}).then(function(Se){return new Promise(function(Le){ae.onload=Le,ae.onerror=Le,ae.src=Se})})}}}const oe={imagePlaceholder:void 0,cacheBust:!1,useCredentials:!1},le={toSvg:ue,toPng:function(ae,ne){return(ne=ne||{}).raster=!0,_e(ae,ne).then(function(Se){return Se.toDataURL()})},toJpeg:function(ae,ne){return(ne=ne||{}).raster=!0,_e(ae,ne).then(function(Se){return Se.toDataURL("image/jpeg",ne.quality||1)})},toBlob:function(ae,ne){return(ne=ne||{}).raster=!0,_e(ae,ne).then(M.canvasToBlob)},toPixelData:function(ae,ne){return(ne=ne||{}).raster=!0,_e(ae,ne).then(function(Se){return Se.getContext("2d").getImageData(0,0,M.width(ae),M.height(ae)).data})},toCanvas:function(ae,ne){return(ne=ne||{}).raster=!0,_e(ae,ne||{})},impl:{fontFaces:W,images:Y,util:M,inliner:z,urlCache:[],options:{}}},me=(m.exports=le,w.getComputedStyle||window.getComputedStyle),we=w.atob||window.atob;function ue(ae,ne){var Se=ne=ne||{};return Se.imagePlaceholder===void 0?le.impl.options.imagePlaceholder=oe.imagePlaceholder:le.impl.options.imagePlaceholder=Se.imagePlaceholder,Se.cacheBust===void 0?le.impl.options.cacheBust=oe.cacheBust:le.impl.options.cacheBust=Se.cacheBust,Se.useCredentials===void 0?le.impl.options.useCredentials=oe.useCredentials:le.impl.options.useCredentials=Se.useCredentials,Promise.resolve(ae).then(function(Le){return function ze(He,pt,ge,Ie,Ne=null){return ge||!pt||pt(He)?Promise.resolve(He).then(function(Ve){return Ve instanceof HTMLCanvasElement?M.makeImage(Ve.toDataURL()):Ve.nodeName==="IFRAME"?html2canvas(Ve.contentDocument.body).then(it=>it.toDataURL()).then(M.makeImage):Ve.cloneNode(!1)}).then(function(Ve){return function(it,lt){const Mt=it.childNodes;return Mt.length===0?Promise.resolve(lt):function(wt,rn){const yn=me(it);let Pn=Promise.resolve();return rn.forEach(function(De){Pn=Pn.then(function(){return ze(De,pt,!1,Ie,yn)}).then(function(Ae){Ae&&wt.appendChild(Ae)})}),Pn}(lt,M.asArray(Mt)).then(function(){return lt})}(He,Ve)}).then(function(Ve){return function(it,lt,Mt){return lt instanceof Element?Promise.resolve().then(function(){(function(wt,rn){const yn=me(wt);yn.cssText?(rn.style.cssText=yn.cssText,function(Pn,De){De.font=Pn.font,De.fontFamily=Pn.fontFamily,De.fontFeatureSettings=Pn.fontFeatureSettings,De.fontKerning=Pn.fontKerning,De.fontSize=Pn.fontSize,De.fontStretch=Pn.fontStretch,De.fontStyle=Pn.fontStyle,De.fontVariant=Pn.fontVariant,De.fontVariantCaps=Pn.fontVariantCaps,De.fontVariantEastAsian=Pn.fontVariantEastAsian,De.fontVariantLigatures=Pn.fontVariantLigatures,De.fontVariantNumeric=Pn.fontVariantNumeric,De.fontVariationSettings=Pn.fontVariationSettings,De.fontWeight=Pn.fontWeight}(yn,rn.style)):(Mt?function(Pn,De,Ae,Be){const Ce=Ae.style,ot=Pn.style;for(var Dt of De){var Zt=De.getPropertyValue(Dt),an=ot.getPropertyValue(Dt),ln=(ot.setProperty(Dt,Be?"initial":"unset"),De.getPropertyValue(Dt));ln!==Zt?Ce.setProperty(Dt,Zt):Ce.removeProperty(Dt),ot.setProperty(Dt,an)}}(wt,yn,rn,ge):function(Pn,De,Ae){const Be=function(ot){if(be[ot])return be[ot];Te||((Te=document.createElement("iframe")).style.visibility="hidden",Te.style.position="fixed",document.body.appendChild(Te),Te.contentWindow.document.write('<!DOCTYPE html><meta charset="UTF-8"><title>sandbox</title><body>'));const Dt=document.createElement(ot),Zt=(Te.contentWindow.document.body.appendChild(Dt),Dt.textContent=".",Te.contentWindow.getComputedStyle(Dt)),an={};return M.asArray(Zt).forEach(function(ln){an[ln]=ln==="width"||ln==="height"?"auto":Zt.getPropertyValue(ln)}),Te.contentWindow.document.body.removeChild(Dt),be[ot]=an}(Ae.tagName),Ce=Ae.style;M.asArray(Pn).forEach(function(ot){var Dt=Pn.getPropertyValue(ot);(Dt!==Be[ot]||De&&Dt!==De.getPropertyValue(ot))&&Ce.setProperty(ot,Dt,Pn.getPropertyPriority(ot))})}(yn,Ne,rn),ge&&(["inset-block","inset-block-start","inset-block-end"].forEach(Pn=>rn.style.removeProperty(Pn)),["left","right","top","bottom"].forEach(Pn=>{rn.style.getPropertyValue(Pn)&&rn.style.setProperty(Pn,"0px")})))})(it,lt)}).then(function(){[":before",":after"].forEach(function(wt){(function(rn){const yn=me(it,rn),Pn=yn.getPropertyValue("content");if(Pn!==""&&Pn!=="none"){const De=M.uid(),Ae=lt.getAttribute("class"),Be=(Ae&&lt.setAttribute("class",Ae+" "+De),document.createElement("style"));Be.appendChild(function(){const Ce=`.${De}:`+rn,ot=(yn.cssText?function(){return`${yn.cssText} content: ${yn.getPropertyValue("content")};`}:function(){return M.asArray(yn).map(function(Dt){return Dt+": "+yn.getPropertyValue(Dt)+(yn.getPropertyPriority(Dt)?" !important":"")}).join("; ")+";"})();return document.createTextNode(Ce+`{${ot}}`)}()),lt.appendChild(Be)}})(wt)})}).then(function(){it instanceof HTMLTextAreaElement&&(lt.innerHTML=it.value),it instanceof HTMLInputElement&&lt.setAttribute("value",it.value)}).then(function(){lt instanceof SVGElement&&(lt.setAttribute("xmlns","http://www.w3.org/2000/svg"),lt instanceof SVGRectElement&&["width","height"].forEach(function(wt){const rn=lt.getAttribute(wt);rn&&lt.style.setProperty(wt,rn)}))}).then(function(){return lt}):lt}(He,Ve,Ie)}):Promise.resolve()}(Le,ne.filter,!0,!ne.raster)}).then(We).then(he).then(function(Le){ne.bgcolor&&(Le.style.backgroundColor=ne.bgcolor),ne.width&&(Le.style.width=ne.width+"px"),ne.height&&(Le.style.height=ne.height+"px"),ne.style&&Object.keys(ne.style).forEach(function(He){Le.style[He]=ne.style[He]});let ze=null;return typeof ne.onclone=="function"&&(ze=ne.onclone(Le)),Promise.resolve(ze).then(function(){return Le})}).then(function(Le){return Le=Le,ze=ne.width||M.width(ae),He=ne.height||M.height(ae),Promise.resolve(Le).then(function(pt){return pt.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(pt)}).then(M.escapeXhtml).then(function(pt){return`<foreignObject x="0" y="0" width="100%" height="100%">${pt}</foreignObject>`}).then(function(pt){return`<svg xmlns="http://www.w3.org/2000/svg" width="${ze}" height="${He}">${pt}</svg>`}).then(function(pt){return"data:image/svg+xml;charset=utf-8,"+pt});var ze,He}).then(function(Le){return le.impl.urlCache=[],Le})}function _e(ae,ne){return ue(ae,ne).then(M.makeImage).then(M.delay(0)).then(function(Se){var Le=typeof ne.scale!="number"?1:ne.scale;const ze=function(pt,ge){const Ie=document.createElement("canvas");if(Ie.width=(ne.width||M.width(pt))*ge,Ie.height=(ne.height||M.height(pt))*ge,ne.bgcolor){const Ne=Ie.getContext("2d");Ne.fillStyle=ne.bgcolor,Ne.fillRect(0,0,Ie.width,Ie.height)}return Ie}(ae,Le),He=ze.getContext("2d");return He.mozImageSmoothingEnabled=!1,He.msImageSmoothingEnabled=!1,He.imageSmoothingEnabled=!1,Se&&(He.scale(Le,Le),He.drawImage(Se,0,0)),Te&&(document.body.removeChild(Te),Te=null,de&&clearTimeout(de),de=setTimeout(()=>{de=null,be={}},2e4)),ze})}function We(ae){return W.resolveAll().then(function(ne){const Se=document.createElement("style");return ae.appendChild(Se),Se.appendChild(document.createTextNode(ne)),ae})}function he(ae){return Y.inlineAll(ae).then(function(){return ae})}let de=null,Te=null,be={}})(r)}),a=i(function(m,_){(function(){function w(W,X,Y){var Q=new XMLHttpRequest;Q.open("GET",W),Q.responseType="blob",Q.onload=function(){z(Q.response,X,Y)},Q.onerror=function(){console.error("could not download file")},Q.send()}function M(W){var X=new XMLHttpRequest;X.open("HEAD",W,!1);try{X.send()}catch{}return 200<=X.status&&299>=X.status}function C(W){try{W.dispatchEvent(new MouseEvent("click"))}catch{var X=document.createEvent("MouseEvents");X.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),W.dispatchEvent(X)}}var R=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof r=="object"&&r.global===r?r:void 0,z=R.saveAs||(typeof window!="object"||window!==R?function(){}:"download"in HTMLAnchorElement.prototype?function(W,X,Y){var Q=R.URL||R.webkitURL,oe=document.createElement("a");X=X||W.name||"download",oe.download=X,oe.rel="noopener",typeof W=="string"?(oe.href=W,oe.origin===location.origin?C(oe):M(oe.href)?w(W,X,Y):C(oe,oe.target="_blank")):(oe.href=Q.createObjectURL(W),setTimeout(function(){Q.revokeObjectURL(oe.href)},4e4),setTimeout(function(){C(oe)},0))}:"msSaveOrOpenBlob"in navigator?function(W,X,Y){if(X=X||W.name||"download",typeof W!="string")navigator.msSaveOrOpenBlob(function(oe,le){return le===void 0?le={autoBom:!1}:typeof le!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),le={autoBom:!le}),le.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(oe.type)?new Blob(["\uFEFF",oe],{type:oe.type}):oe}(W,Y),X);else if(M(W))w(W,X,Y);else{var Q=document.createElement("a");Q.href=W,Q.target="_blank",setTimeout(function(){C(Q)})}}:function(W,X,Y,Q){if((Q=Q||open("","_blank"))&&(Q.document.title=Q.document.body.innerText="downloading..."),typeof W=="string")return w(W,X,Y);var oe=W.type==="application/octet-stream",le=/constructor/i.test(R.HTMLElement)||R.safari,me=/CriOS\/[\d]+/.test(navigator.userAgent);if((me||oe&&le)&&typeof FileReader=="object"){var we=new FileReader;we.onloadend=function(){var We=we.result;We=me?We:We.replace(/^data:[^;]*;/,"data:attachment/file;"),Q?Q.location.href=We:location=We,Q=null},we.readAsDataURL(W)}else{var ue=R.URL||R.webkitURL,_e=ue.createObjectURL(W);Q?Q.location=_e:location.href=_e,Q=null,setTimeout(function(){ue.revokeObjectURL(_e)},4e4)}});R.saveAs=z.saveAs=z,m.exports=z})()}),o=L.Control.extend({options:{cropImageByInnerWH:!0,hidden:!1,domtoimageOptions:{},position:"topleft",screenName:"screen",iconUrl:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/PjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDMyIDMyIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAzMiAzMjsiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxnPjxnIGlkPSJjYW1lcmEiPjxwYXRoIHN0eWxlPSJmaWxsOiMwMTAwMDI7IiBkPSJNMTYsOS41MDFjLTQuNDE5LDAtOCwzLjU4MS04LDhjMCw0LjQxOCwzLjU4MSw4LDgsOGM0LjQxOCwwLDgtMy41ODIsOC04UzIwLjQxOCw5LjUwMSwxNiw5LjUwMXogTTIwLjU1NSwyMS40MDZjLTIuMTU2LDIuNTE2LTUuOTQzLDIuODA3LTguNDU5LDAuNjVjLTIuNTE3LTIuMTU2LTIuODA3LTUuOTQ0LTAuNjUtOC40NTljMi4xNTUtMi41MTcsNS45NDMtMi44MDcsOC40NTktMC42NUMyMi40MiwxNS4xMDIsMjIuNzExLDE4Ljg5MSwyMC41NTUsMjEuNDA2eiIvPjxwYXRoIHN0eWxlPSJmaWxsOiMwMTAwMDI7IiBkPSJNMTYsMTMuNTAxYy0yLjIwOSwwLTMuOTk5LDEuNzkxLTQsMy45OTl2MC4wMDJjMCwwLjI3NSwwLjIyNCwwLjUsMC41LDAuNXMwLjUtMC4yMjUsMC41LTAuNVYxNy41YzAuMDAxLTEuNjU2LDEuMzQzLTIuOTk5LDMtMi45OTljMC4yNzYsMCwwLjUtMC4yMjQsMC41LTAuNVMxNi4yNzYsMTMuNTAxLDE2LDEzLjUwMXoiLz48cGF0aCBzdHlsZT0iZmlsbDojMDEwMDAyOyIgZD0iTTI5LjQ5Miw4LjU0MmwtNC4zMzQtMC43MjNsLTEuMzczLTMuNDM0QzIzLjMyNiwzLjI0LDIyLjIzMiwyLjUsMjEsMi41SDExYy0xLjIzMiwwLTIuMzI2LDAuNzQtMi43ODYsMS44ODZMNi44NDIsNy44MTlMMi41MDksOC41NDJDMS4wNTUsOC43ODMsMCwxMC4wMjcsMCwxMS41djE1YzAsMS42NTQsMS4zNDYsMywzLDNoMjZjMS42NTQsMCwzLTEuMzQ2LDMtM3YtMTVDMzIsMTAuMDI3LDMwLjk0NSw4Ljc4MywyOS40OTIsOC41NDJ6IE0zMCwyNi41YzAsMC41NTMtMC40NDcsMS0xLDFIM2MtMC41NTMsMC0xLTAuNDQ3LTEtMXYtMTVjMC0wLjQ4OSwwLjM1NC0wLjkwNiwwLjgzNi0wLjk4Nkw4LjI4LDkuNjA3bDEuNzkxLTQuNDc4QzEwLjIyNCw0Ljc1LDEwLjU5MSw0LjUsMTEsNC41aDEwYzAuNDA4LDAsMC43NzUsMC4yNDksMC45MjgsMC42MjlsMS43OTEsNC40NzhsNS40NDUsMC45MDdDMjkuNjQ2LDEwLjU5NCwzMCwxMS4wMTEsMzAsMTEuNVYyNi41eiIvPjwvZz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PC9zdmc+",hideElementsWithSelectors:[".leaflet-control-container"],onCropBorderSize:2,caption:null,captionFontSize:15,captionFont:"Arial",captionColor:"black",captionBgColor:"white",captionOffset:5,mimeType:"image/png",debugMode:!1,preventDownload:!1,onPixelDataFail:function(m){var _=m.node,w=m.error;return console.warn("Map node is very big "+_.scrollWidth+"x"+_.scrollHeight),console.warn(`Add function: SimpleMapScreenshoter({
              onPixelDataFail: function({ node, plugin, error, mapPane, domtoimageOptions }) {
                 // Solutions:
                 // decrease size of map
                 // or decrease zoom level
                 // or remove elements with big distanses
                 // and after that return image in Promise - plugin._getPixelDataOfNormalMap
                 return plugin._getPixelDataOfNormalMap(domtoimageOptions)
              }
            })`),Promise.reject(w)}},onAdd:function(){return this._container=L.DomUtil.create("div","leaflet-control-simpleMapScreenshoter"),this._link=null,this._screenState={status:1,promise:null},this.options.hidden===!1&&this._addScreenBtn(),this._onUserStartInteractWithMap=this._onUserStartInteractWithMap.bind(this),this._onUserEndInteractWithMap=this._onUserEndInteractWithMap.bind(this),this._map.on("zoomstart",this._onUserStartInteractWithMap),this._map.on("move",this._onUserStartInteractWithMap),this._map.on("zoomend",this._onUserEndInteractWithMap),this._map.on("moveend",this._onUserEndInteractWithMap),this._container},takeScreen:function(){var m=this,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"blob",w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},M={};for(var C in this.options)w.hasOwnProperty(C)?M[C]=w[C]:M[C]=this.options[C];return this._screenState.status===2?this._screenState.promise:(this._map.fire("simpleMapScreenshoter.takeScreen"),this._screenState.status=2,this._setElementsVisible(!1),this._screenState.promise=this._waitEndOfInteractions().then(function(){return m._getPixelData(M)}).then(function(R){return m._setElementsVisible(!0),m._toCanvas(R,M)}).then(function(R){return _==="image"?m._canvasToImage(R,M):_==="canvas"?R:m._canvasToBlob(R,M)}).then(function(R){return m._screenState.status=1,m._map.fire("simpleMapScreenshoter.done"),R}).catch(function(R){return m._setElementsVisible(!0),m._screenState.status=1,m._map.fire("simpleMapScreenshoter.error",{e:R}),Promise.reject(R)}),this._screenState.promise)},_setElementsVisible:function(){var m=this,_=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.options.hideElementsWithSelectors.forEach(function(w){var M=m._map._container.querySelectorAll(w),C=!0,R=!1,z=void 0;try{for(var W,X=M[Symbol.iterator]();!(C=(W=X.next()).done);C=!0)W.value.style.opacity=_===!1?0:1}catch(Y){R=!0,z=Y}finally{try{!C&&X.return&&X.return()}finally{if(R)throw z}}})},_canvasToImage:function(m,_){var w=_.mimeType,M=m.toDataURL(w);return M.indexOf("base64")===-1?Promise.reject(new Error("Base64 image generation error")):Promise.resolve(M)},_canvasToBlob:function(m,_){var w=_.mimeType;return new Promise(function(M,C){m.toBlob(function(R){M(R)},w)})},_toCanvas:function(m,_){var w=_.captionOffset,M=_.caption,C=_.captionFontSize,R=_.captionFont,z=_.captionColor,W=_.captionBgColor,X=this._node,Y=X.screenHeight,Q=X.screenWidth,oe=document.createElement("canvas");oe.width=Q,oe.height=Y;for(var le=oe.getContext("2d"),me=le.createImageData(Q,Y),we=0;we<m.length;++we)me.data[we]=m[we];le.putImageData(me,0,0),me=null;var ue=document.createElement("canvas"),_e=ue.getContext("2d"),We=0,he=0,de=Y,Te=Q;if(this.options.cropImageByInnerWH===!0){for(var be=[],ae=0,ne=0;ne<Y;++ne){ae=0;for(var Se=0;Se<Q;++Se)m[4*ne*Q+4*Se+4]===0&&ae++;ae===Q&&be.push(ne)}var Le=this._getMinAndMaxOnValuesBreak(be);We=Le.min;for(var ze=Q,He=Le.max,pt=[],ge=0,Ie=he;Ie<ze;++Ie){ge=0;for(var Ne=0;Ne<Y;++Ne)m[4*Ne*Q+4*Ie+4]===0&&ge++;ge===Y&&pt.push(Ie)}var Ve=this._getMinAndMaxOnValuesBreak(pt);he=Ve.min,ze=Ve.max,(he===0&&ze===0||ze===null)&&(ze=Q),(We===0&&He===0||He===null)&&(He=Y),this.options.debugMode===!0&&(console.log("emptyYLine",be),console.log("minMaxY",Le),console.log("emptyXLine",pt),console.log("minMaxX",Ve),console.log("debugX",{}),console.log("debugY",{})),We===0&&He===Y&&he===0&&ze===Q||(We+=this.options.onCropBorderSize,He-=this.options.onCropBorderSize,he+=this.options.onCropBorderSize,ze-=this.options.onCropBorderSize),de=He-We,Te=ze-he,ue.width=Te,ue.height=de}else ue.width=Te,ue.height=de;var it=null;return M&&(it=typeof M=="function"?M.call(this):M),it!==null&&(ue.height=ue.height+(w+C+w),_e.beginPath(),_e.rect(0,0,ue.width,ue.height),_e.fillStyle=W,_e.fill(),_e.save()),_e.drawImage(oe,he,We,Te,de,0,0,Te,de),it!==null&&(_e.font=C+"px "+R,_e.fillStyle=z,_e.fillText(it,w,de+w+C)),Promise.resolve(ue)},_getMinAndMaxOnValuesBreak:function(m){for(var _=0,w=0,M=!1,C=1;C<m.length;C++){if(m[C]-1!==m[C-1]){w=m[C],M=!0;break}_=m[C]}return M===!1&&m[0]>1?(_=0,w=m[0]):M===!1&&(_=m[m.length-1]||0,w=null),{min:_,max:w}},_getPixelData:function(m){var _=this,w=m.domtoimageOptions,M=w===void 0?{}:w;return this._getPixelDataOfNormalMap(M).catch(function(C){return console.warn("May be map size very big on that zoom level, we have error:",C.toString()),console.warn("You can manually hide map elements with large distances between them for fix that warn"),_._getPixelDataOfBigMap(M)})},_getPixelDataOfNormalMap:function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=this._map.getContainer();return this._node={node:_,screenHeight:_.scrollHeight,screenWidth:_.scrollWidth},l.toPixelData(_,m)},_getPixelDataOfBigMap:function(){var m=this,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},w=this._map.getContainer(),M=this._map.getPane("mapPane");M.style.width=2*w.clientWidth+"px",M.style.height=2*w.clientHeight+"px",M.style.overflow="hidden";var C=function(){M.style.width="initial",M.style.height="initial",M.style.overflow="initial"};return this._node={node:w,screenHeight:w.scrollHeight,screenWidth:w.scrollWidth},l.toPixelData(w,_).then(function(R){return C(),R}).catch(function(R){return C(),w.scrollHeight>=4e3||w.scrollWidth>=4e3?m.options.onPixelDataFail({plugin:m,node:w,mapPane:M,error:R,domtoimageOptions:_}):Promise.reject(R)})},_addScreenBtn:function(){this._link=L.DomUtil.create("a","leaflet-control-simpleMapScreenshoter-btn",this._container),this._addCss(),L.DomEvent.addListener(this._link,"click",this._onScreenBtn,this),L.DomEvent.disableClickPropagation(this._link)},_addCss:function(){var m=`
    .leaflet-control-simpleMapScreenshoter{
       border: 2px solid rgba(0,0,0,0.2);
       background-clip: padding-box;
    }
    .leaflet-control-simpleMapScreenshoter a{
       background-color: #fff;
       border-bottom: 1px solid #ccc;
       width: 30px;
       height: 30px;
       line-height: 30px;
       display: block;
       text-align: center;
       text-decoration: none;
       color: black;
       overflow: hidden;
       border-radius: 2px;
       background-image: url('`+this.options.iconUrl+`');
       background-position: 46% 41%;
       background-repeat: no-repeat;
       background-size: 63%;
    }
    .leaflet-control-simpleMapScreenshoter a:hover{
       cursor: pointer;
    }
    `,_=document.head||document.getElementsByTagName("head")[0],w=document.createElement("style");w.appendChild(document.createTextNode(m)),_.appendChild(w)},_onScreenBtn:function(){var m=this;this._map.fire("simpleMapScreenshoter.click"),this.options.preventDownload||this.takeScreen().then(function(_){var w=typeof m.options.screenName=="function"?m.options.screenName.call(m):m.options.screenName;a.saveAs(_,w+".png")}).catch(function(_){m._map.fire("simpleMapScreenshoter.error",{e:_})})},_onUserStartInteractWithMap:function(){this._interaction=!0},_onUserEndInteractWithMap:function(){this._interaction=!1},_waitEndOfInteractions:function(){var m=this;return new Promise(function(_){var w=setInterval(function(){m._interaction||(_(),clearInterval(w))},100)})}}),f=(L.Control.SimpleMapScreenshoter=o,L.simpleMapScreenshoter=function(m){return new L.Control.SimpleMapScreenshoter(m)},o);n.default=f,n.SimpleMapScreenshoter=o,Object.defineProperty(n,"__esModule",{value:!0})})})(GL,GL.exports);var _h=63710088e-1,dk={centimeters:_h*100,centimetres:_h*100,degrees:360/(2*Math.PI),feet:_h*3.28084,inches:_h*39.37,kilometers:_h/1e3,kilometres:_h/1e3,meters:_h,metres:_h,miles:_h/1609.344,millimeters:_h*1e3,millimetres:_h*1e3,nauticalmiles:_h/1852,radians:1,yards:_h*1.0936};function x_(e,t,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=e,r}function Vx(e,t,n={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!HL(e[0])||!HL(e[1]))throw new Error("coordinates must contain numbers");return x_({type:"Point",coordinates:e},t,n)}function em(e,t,n={}){for(const i of e){if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(i[i.length-1].length!==i[0].length)throw new Error("First and last Position are not equivalent.");for(let l=0;l<i[i.length-1].length;l++)if(i[i.length-1][l]!==i[0][l])throw new Error("First and last Position are not equivalent.")}return x_({type:"Polygon",coordinates:e},t,n)}function w_(e,t,n={}){if(e.length<2)throw new Error("coordinates must be an array of two or more positions");return x_({type:"LineString",coordinates:e},t,n)}function V9(e,t="kilometers"){const n=dk[t];if(!n)throw new Error(t+" units is invalid");return e*n}function $9(e,t="kilometers"){const n=dk[t];if(!n)throw new Error(t+" units is invalid");return e/n}function J4(e){return e%(2*Math.PI)*180/Math.PI}function tf(e){return e%360*Math.PI/180}function HL(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function qL(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function G9(e){return e.type==="Feature"?e.geometry:e}function fk(e,t,n={}){if(n.final===!0)return H9(e,t);const r=qL(e),i=qL(t),l=tf(r[0]),a=tf(i[0]),o=tf(r[1]),f=tf(i[1]),m=Math.sin(a-l)*Math.cos(f),_=Math.cos(o)*Math.sin(f)-Math.sin(o)*Math.cos(f)*Math.cos(a-l);return J4(Math.atan2(m,_))}function H9(e,t){let n=fk(t,e);return n=(n+180)%360,n}function q9(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function W9(e,t,n,r={}){const i=q9(e),l=tf(i[0]),a=tf(i[1]),o=tf(n),f=$9(t,r.units),m=Math.asin(Math.sin(a)*Math.cos(f)+Math.cos(a)*Math.sin(f)*Math.cos(o)),_=l+Math.atan2(Math.sin(o)*Math.sin(f)*Math.cos(a),Math.cos(f)-Math.sin(a)*Math.sin(m)),w=J4(_),M=J4(m);return Vx([w,M],r.properties)}function WL(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function pk(e,t,n={}){var r=WL(e),i=WL(t),l=tf(i[1]-r[1]),a=tf(i[0]-r[0]),o=tf(r[1]),f=tf(i[1]),m=Math.pow(Math.sin(l/2),2)+Math.pow(Math.sin(a/2),2)*Math.cos(o)*Math.cos(f);return V9(2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m)),n.units)}function Z9(e,t,n={}){const i=G9(e).coordinates;let l=0;for(let a=0;a<i.length&&!(t>=l&&a===i.length-1);a++)if(l>=t){const o=t-l;if(o){const f=fk(i[a],i[a-1])-180;return W9(i[a],o,f,n)}else return Vx(i[a])}else l+=pk(i[a],i[a+1],n);return Vx(i[i.length-1])}var ZL=Z9;function K9(e,t){var n,r,i,l,a,o,f,m,_,w,M=0,C=e.type==="FeatureCollection",R=e.type==="Feature",z=C?e.features.length:1;for(n=0;n<z;n++){for(o=C?e.features[n].geometry:R?e.geometry:e,m=C?e.features[n].properties:R?e.properties:{},_=C?e.features[n].bbox:R?e.bbox:void 0,w=C?e.features[n].id:R?e.id:void 0,f=o?o.type==="GeometryCollection":!1,a=f?o.geometries.length:1,i=0;i<a;i++){if(l=f?o.geometries[i]:o,l===null){if(t(null,M,m,_,w)===!1)return!1;continue}switch(l.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(l,M,m,_,w)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<l.geometries.length;r++)if(t(l.geometries[r],M,m,_,w)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}M++}}function Y9(e,t,n){var r=n;return K9(e,function(i,l,a,o,f){l===0&&n===void 0?r=i:r=t(r,i,l,a,o,f)}),r}function mk(e){return Y9(e,(t,n)=>t+X9(n),0)}function X9(e){let t=0,n;switch(e.type){case"Polygon":return KL(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)t+=KL(e.coordinates[n]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function KL(e){let t=0;if(e&&e.length>0){t+=Math.abs(YL(e[0]));for(let n=1;n<e.length;n++)t-=Math.abs(YL(e[n]))}return t}var J9=_h*_h/2,N5=Math.PI/180;function YL(e){const t=e.length-1;if(t<=2)return 0;let n=0,r=0;for(;r<t;){const i=e[r],l=e[r+1===t?0:r+1],a=e[r+2>=t?(r+2)%t:r+2],o=i[0]*N5,f=l[1]*N5,m=a[0]*N5;n+=(m-o)*Math.sin(f),r++}return n*J9}var av=mk,Q9=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,i,l;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(l=Object.keys(t),r=l.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,l[i]))return!1;for(i=r;i--!==0;){var a=l[i];if(!e(t[a],n[a]))return!1}return!0}return t!==t&&n!==n};const XL=Mg(Q9);function gk(e,t,n){if(e!==null)for(var r,i,l,a,o,f,m,_=0,w=0,M,C=e.type,R=C==="FeatureCollection",z=C==="Feature",W=R?e.features.length:1,X=0;X<W;X++){m=R?e.features[X].geometry:z?e.geometry:e,M=m?m.type==="GeometryCollection":!1,o=M?m.geometries.length:1;for(var Y=0;Y<o;Y++){var Q=0,oe=0;if(a=M?m.geometries[Y]:m,a!==null){f=a.coordinates;var le=a.type;switch(_=le==="Polygon"||le==="MultiPolygon"?1:0,le){case null:break;case"Point":if(t(f,w,X,Q,oe)===!1)return!1;w++,Q++;break;case"LineString":case"MultiPoint":for(r=0;r<f.length;r++){if(t(f[r],w,X,Q,oe)===!1)return!1;w++,le==="MultiPoint"&&Q++}le==="LineString"&&Q++;break;case"Polygon":case"MultiLineString":for(r=0;r<f.length;r++){for(i=0;i<f[r].length-_;i++){if(t(f[r][i],w,X,Q,oe)===!1)return!1;w++}le==="MultiLineString"&&Q++,le==="Polygon"&&oe++}le==="Polygon"&&Q++;break;case"MultiPolygon":for(r=0;r<f.length;r++){for(oe=0,i=0;i<f[r].length;i++){for(l=0;l<f[r][i].length-_;l++){if(t(f[r][i][l],w,X,Q,oe)===!1)return!1;w++}oe++}Q++}break;case"GeometryCollection":for(r=0;r<a.geometries.length;r++)if(gk(a.geometries[r],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function ej(e,t={}){let n=0,r=0,i=0;return gk(e,function(l){n+=l[0],r+=l[1],i++}),Vx([n/i,r/i],t.properties)}var Zv=ej;function yk(e,t,n){if(e!==null)for(var r,i,l,a,o,f,m,_=0,w=0,M,C=e.type,R=C==="FeatureCollection",z=C==="Feature",W=R?e.features.length:1,X=0;X<W;X++){m=R?e.features[X].geometry:z?e.geometry:e,M=m?m.type==="GeometryCollection":!1,o=M?m.geometries.length:1;for(var Y=0;Y<o;Y++){var Q=0,oe=0;if(a=M?m.geometries[Y]:m,a!==null){f=a.coordinates;var le=a.type;switch(_=0,le){case null:break;case"Point":if(t(f,w,X,Q,oe)===!1)return!1;w++,Q++;break;case"LineString":case"MultiPoint":for(r=0;r<f.length;r++){if(t(f[r],w,X,Q,oe)===!1)return!1;w++,le==="MultiPoint"&&Q++}le==="LineString"&&Q++;break;case"Polygon":case"MultiLineString":for(r=0;r<f.length;r++){for(i=0;i<f[r].length-_;i++){if(t(f[r][i],w,X,Q,oe)===!1)return!1;w++}le==="MultiLineString"&&Q++,le==="Polygon"&&oe++}le==="Polygon"&&Q++;break;case"MultiPolygon":for(r=0;r<f.length;r++){for(oe=0,i=0;i<f[r].length;i++){for(l=0;l<f[r][i].length-_;l++){if(t(f[r][i][l],w,X,Q,oe)===!1)return!1;w++}oe++}Q++}break;case"GeometryCollection":for(r=0;r<a.geometries.length;r++)if(yk(a.geometries[r],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function tj(e,t){var n,r,i,l,a,o,f,m,_,w,M=0,C=e.type==="FeatureCollection",R=e.type==="Feature",z=C?e.features.length:1;for(n=0;n<z;n++){for(o=C?e.features[n].geometry:R?e.geometry:e,m=C?e.features[n].properties:R?e.properties:{},_=C?e.features[n].bbox:R?e.bbox:void 0,w=C?e.features[n].id:R?e.id:void 0,f=o?o.type==="GeometryCollection":!1,a=f?o.geometries.length:1,i=0;i<a;i++){if(l=f?o.geometries[i]:o,l===null){if(t(null,M,m,_,w)===!1)return!1;continue}switch(l.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(l,M,m,_,w)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<l.geometries.length;r++)if(t(l.geometries[r],M,m,_,w)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}M++}}function nj(e,t){tj(e,function(n,r,i,l,a){var o=n===null?null:n.type;switch(o){case null:case"Point":case"LineString":case"Polygon":return t(x_(n,i,{bbox:l,id:a}),r,0)===!1?!1:void 0}var f;switch(o){case"MultiPoint":f="Point";break;case"MultiLineString":f="LineString";break;case"MultiPolygon":f="Polygon";break}for(var m=0;m<n.coordinates.length;m++){var _=n.coordinates[m],w={type:f,coordinates:_};if(t(x_(w,i),r,m)===!1)return!1}})}function rj(e,t){nj(e,function(n,r,i){var l=0;if(n.geometry){var a=n.geometry.type;if(!(a==="Point"||a==="MultiPoint")){var o,f=0,m=0,_=0;if(yk(n,function(w,M,C,R,z){if(o===void 0||r>f||R>m||z>_){o=w,f=r,m=R,_=z,l=0;return}var W=w_([o,w],n.properties);if(t(W,r,i,z,l)===!1)return!1;l++,o=w})===!1)return!1}}})}function ij(e,t,n){var r=n,i=!1;return rj(e,function(l,a,o,f,m){i===!1&&n===void 0?r=l:r=t(r,l,a,o,f,m),i=!0}),r}function $x(e,t={}){return ij(e,(n,r)=>{const i=r.geometry.coordinates;return n+pk(i[0],i[1],t)},0)}var sj=$x;let Uh=class extends Ba.Polygon{constructor(n,r={}){super(n,{...r,pmIgnore:!1,interactive:!0});un(this,"properties");un(this,"_originalStyle");un(this,"_path");this.properties={type:"Polygon",category:r.category||"forages",accessLevel:r.accessLevel||"visitor",style:{color:r.color||"#2b6451",weight:r.weight||3,opacity:r.opacity||1,fillColor:r.fillColor||"#2b6451",fillOpacity:r.fillOpacity||.2,dashArray:r.dashArray||"",name:r.name||""}},this.on("mouseover",this.highlight),this.on("mouseout",this.unhighlight),this.updateProperties(),this.on({add:()=>this.updateProperties(),edit:()=>this.updateProperties(),drag:()=>this.updateProperties()})}updateProperties(){var n,r,i,l,a;try{const o=this.getLatLngs()[0];if(!o||o.length<3){console.warn("Polygon has less than 3 points, cannot calculate properties");return}const f=o.map(X=>[X.lng,X.lat]);f.push(f[0]);const m=em([f]),_=mk(m),w=$x(w_([...f]),{units:"meters"}),M=Zv(m),C=Ba.latLng(M.geometry.coordinates[1],M.geometry.coordinates[0]),R=((r=(n=this.properties)==null?void 0:n.style)==null?void 0:r.name)||"",z=((i=this.properties)==null?void 0:i.category)||"forages",W=((l=this.properties)==null?void 0:l.accessLevel)||"visitor";this.properties={type:"Polygon",coordinates:o.map(X=>({lat:X.lat,lng:X.lng})),surface:_,perimeter:w,center:{lat:C.lat,lng:C.lng},vertices:o.length,category:z,accessLevel:W,style:{...this.options,color:this.options.color||"#2b6451",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#2b6451",fillOpacity:this.options.fillOpacity||.2,dashArray:((a=this.options)==null?void 0:a.dashArray)||"",name:R}},this.fire("properties:updated",{shape:this,properties:this.properties})}catch(o){console.error("Failed to calculate polygon properties",o)}}setName(n){this.properties.style||(this.properties.style={}),this.properties.style.name=n,this.fire("properties:updated",{shape:this,properties:this.properties})}getName(){var n,r;return((r=(n=this.properties)==null?void 0:n.style)==null?void 0:r.name)||""}setLatLngs(n){return super.setLatLngs(n),this.updateProperties(),this}getMidPoints(){const n=this.getLatLngs()[0],r=[];if(n.length<2)return r;for(let i=0;i<n.length;i++){const l=n[i],a=n[(i+1)%n.length];r.push(Ba.latLng((l.lat+a.lat)/2,(l.lng+a.lng)/2))}return r}moveVertex(n,r){const i=this.getLatLngs()[0];n>=0&&n<i.length&&(i[n]=r,Ba.Polygon.prototype.setLatLngs.call(this,[i]))}addVertex(n,r){const i=this.getLatLngs()[0];n>=0&&n<i.length&&(i.splice((n+1)%i.length,0,r),Ba.Polygon.prototype.setLatLngs.call(this,[i]))}move(n){const i=this.getLatLngs()[0].map(l=>Ba.latLng(l.lat+n.lat,l.lng+n.lng));return Ba.Polygon.prototype.setLatLngs.call(this,[i]),this}getCenter(){const n=this.getLatLngs()[0];if(!n||n.length===0)return new Ba.LatLng(0,0);try{const r=n.filter(m=>m&&typeof m.lat=="number"&&typeof m.lng=="number"&&!isNaN(m.lat)&&!isNaN(m.lng)&&Math.abs(m.lat)<=90&&Math.abs(m.lng)<=180);if(r.length===0)return console.warn("Aucun point valide dans le polygone pour calculer le centre"),new Ba.LatLng(0,0);const i=r.map(m=>[m.lng,m.lat]);i.push(i[0]);const l=em([i]),a=Zv(l),o=a.geometry.coordinates[1],f=a.geometry.coordinates[0];if(typeof o!="number"||typeof f!="number"||isNaN(o)||isNaN(f)||Math.abs(o)>90||Math.abs(f)>180)throw new Error("Centroid calculé invalide");return Ba.latLng(o,f)}catch(r){console.warn("Erreur lors du calcul du centroïde avec turf.js, utilisation de la méthode simple",r);let i=0,l=0,a=0;for(const o of n)o&&typeof o.lat=="number"&&typeof o.lng=="number"&&!isNaN(o.lat)&&!isNaN(o.lng)&&Math.abs(o.lat)<=90&&Math.abs(o.lng)<=180&&(i+=o.lat,l+=o.lng,a++);return a===0?(console.error("Impossible de calculer un centre valide pour le polygone"),new Ba.LatLng(0,0)):new Ba.LatLng(i/a,l/a)}}getSegmentLengths(){const n=this.getLatLngs()[0],r=[];if(n.length<2)return r;for(let i=0;i<n.length;i++){const l=n[i],a=n[(i+1)%n.length];r.push(l.distanceTo(a))}return r}highlight(){if(!this._originalStyle){this._originalStyle={...this.options};const n=(this._originalStyle.weight||3)*1.5;this.setStyle({weight:n,opacity:1,fillOpacity:Math.min((this._originalStyle.fillOpacity||.2)+.1,.4),className:"polygon-hover-effect"});try{this._path&&(this._path.style.filter="drop-shadow(0 0 3px rgba(43, 100, 81, 0.7))",this._path.style.transition="all 0.2s ease-in-out")}catch(r){console.warn("Impossible d'appliquer l'effet de lueur au polygone",r)}}}unhighlight(){if(this._originalStyle){this.setStyle(this._originalStyle),this._originalStyle=void 0;try{this._path&&(this._path.style.filter="",this._path.style.transition="")}catch(n){console.warn("Impossible de restaurer le style du polygone",n)}}}};class dl extends Ba.Polyline{constructor(n,r={}){super(n,{...r,pmIgnore:!1,interactive:!0});un(this,"properties");un(this,"cachedProperties",{});un(this,"needsUpdate",!0);un(this,"_originalStyle");un(this,"_path");un(this,"updateProperties",()=>{var i,l,a,o,f;const n=this.getLatLngs();if(!n||n.length<2){console.warn("Line has less than 2 points, cannot calculate properties");return}const r=n.map(m=>[m.lng,m.lat]);try{const m=w_(r),_=$x(m,{units:"meters"});let w;if(n.length===2)w=Ba.latLng((n[0].lat+n[1].lat)/2,(n[0].lng+n[1].lng)/2);else{const z=ZL(m,_/2,{units:"meters"});w=Ba.latLng(z.geometry.coordinates[1],z.geometry.coordinates[0])}const M=((l=(i=this.properties)==null?void 0:i.style)==null?void 0:l.name)||"",C=((a=this.properties)==null?void 0:a.category)||"forages",R=((o=this.properties)==null?void 0:o.accessLevel)||"visitor";this.properties={type:"Line",length:_,coordinates:n.map(z=>({lat:z.lat,lng:z.lng})),center:{lat:w.lat,lng:w.lng},vertices:n.length,category:C,accessLevel:R,style:{...this.options,color:this.options.color||"#2b6451",weight:this.options.weight||3,opacity:this.options.opacity||1,dashArray:((f=this.options)==null?void 0:f.dashArray)||"",name:M}},this.cachedProperties.length=_,this.cachedProperties.center=w,this.cachedProperties.midPoints=void 0,this.needsUpdate=!1,this.fire("properties:updated",{shape:this,properties:this.properties})}catch(m){console.error("Failed to calculate line properties",m)}});un(this,"setName",n=>{this.properties.style||(this.properties.style={}),this.properties.style.name=n,this.fire("properties:updated",{shape:this,properties:this.properties})});un(this,"getName",()=>{var n,r;return((r=(n=this.properties)==null?void 0:n.style)==null?void 0:r.name)||""});un(this,"getMidPoints",()=>{if(!this.needsUpdate&&this.cachedProperties.midPoints)return this.cachedProperties.midPoints;const n=this.getLatLngs(),r=[];if(n.length<2)return r;for(let i=0;i<n.length-1;i++){const l=n[i],a=n[i+1];if(!l||!a){console.warn("Points invalides détectés pour le segment",i);continue}r.push(Ba.latLng((l.lat+a.lat)/2,(l.lng+a.lng)/2))}return this.cachedProperties.midPoints=r,r});un(this,"getMidPointAt",n=>{const r=this.getLatLngs();if(n<0||n>=r.length-1||r.length<2)return null;const i=r[n],l=r[n+1];return!i||!l?(console.warn("Points invalides pour calcul du midpoint au segment",n),null):Ba.latLng((i.lat+l.lat)/2,(i.lng+l.lng)/2)});un(this,"moveVertex",(n,r,i=!1)=>{const l=this.getLatLngs();n>=0&&n<l.length&&(l[n]=r,this.setLatLngs(l),this.needsUpdate=!0,this.cachedProperties={},this.fire("vertex:moved",{index:n,latlng:r,allPoints:l}),i&&this.updateProperties())});un(this,"getSegmentLengths",()=>{const n=this.getLatLngs(),r=[];if(n.length<2)return r;for(let i=0;i<n.length-1;i++){const l=n[i],a=n[i+1];r.push(l.distanceTo(a))}return r});un(this,"getSegmentLengthAt",n=>{const r=this.getLatLngs();if(n<0||n>=r.length-1||r.length<2)return 0;const i=r[n],l=r[n+1];return i.distanceTo(l)});un(this,"getLength",()=>{if(!this.needsUpdate&&this.cachedProperties.length)return this.cachedProperties.length;const n=this.getLatLngs();let r=0;for(let i=0;i<n.length-1;i++)r+=n[i].distanceTo(n[i+1]);return this.cachedProperties.length=r,r});un(this,"getLengthToVertex",n=>{const r=this.getLatLngs();if(n<0||n>=r.length||r.length<2)return 0;let i=0;for(let l=0;l<n;l++)i+=r[l].distanceTo(r[l+1]);return i});this.properties={type:"Line",category:r.category||"forages",accessLevel:r.accessLevel||"visitor",style:{...r||{},name:r.name||""}},this.updateProperties(),this.on("add",()=>{this.updateProperties()}),this.on("mouseover",this.highlight),this.on("mouseout",this.unhighlight)}highlight(){var n,r;if(!this._originalStyle){this._originalStyle={...this.options};const i=(((n=this._originalStyle)==null?void 0:n.weight)||3)*1.75,l=((r=this._originalStyle)==null?void 0:r.color)||"#2b6451";this.setStyle({weight:i,opacity:1,className:"line-hover-effect"});try{this._path&&(this._path.style.filter=`drop-shadow(0 0 4px ${l})`,this._path.style.transition="all 0.2s ease-in-out")}catch{console.warn("Impossible d'appliquer l'effet de lueur à la ligne")}}}unhighlight(){if(this._originalStyle){this.setStyle(this._originalStyle),this._originalStyle=void 0;try{this._path&&(this._path.style.filter="",this._path.style.transition="")}catch{console.warn("Impossible de retirer l'effet de lueur de la ligne")}}}isPointNearLine(n,r=10){if(!this._map)return!1;const i=this.getLatLngs();if(i.length<2)return!1;for(let l=0;l<i.length-1;l++){const a=this._map.latLngToLayerPoint(i[l]),o=this._map.latLngToLayerPoint(i[l+1]),f=this._map.latLngToLayerPoint(n);if(Ba.LineUtil.pointToSegmentDistance(f,a,o)<=r)return!0}return!1}invalidateCache(){this.needsUpdate=!0,this.cachedProperties={}}setLatLngs(n){return super.setLatLngs(n),this.needsUpdate=!0,this.cachedProperties={},this.fire("latlngs:updated",{latlngs:this.getLatLngs()}),this}addVertex(n,r,i=!1){const l=this.getLatLngs();n>=0&&n<l.length-1&&(l.splice(n+1,0,r),Ba.Polyline.prototype.setLatLngs.call(this,l),this.needsUpdate=!0,this.cachedProperties={},i&&this.updateProperties())}move(n,r=!0){this.fire("move:start");const i=this.getLatLngs(),l=i.map(a=>Ba.latLng(a.lat+n.lat,a.lng+n.lng));return this.setLatLngs(l),this.needsUpdate=!0,this.cachedProperties={},this.fire("move",{delta:n,newPositions:l,oldPositions:i}),r&&(this.updateProperties(),this.fire("properties:updated",{shape:this,properties:this.properties}),this.fire("move:end")),this}getCenter(){if(!this.needsUpdate&&this.cachedProperties.center)return this.cachedProperties.center;const n=this.getLatLngs();if(n.length<2)return n[0]||new Ba.LatLng(0,0);try{const r=n.map(f=>[f.lng,f.lat]),i=w_(r),l=$x(i,{units:"meters"}),a=ZL(i,l/2,{units:"meters"}),o=Ba.latLng(a.geometry.coordinates[1],a.geometry.coordinates[0]);return this.cachedProperties.center=o,o}catch(r){console.warn("Error calculating line center with turf.js, using simple method",r);const i=n.reduce((o,f)=>o+f.lat,0)/n.length,l=n.reduce((o,f)=>o+f.lng,0)/n.length,a=new Ba.LatLng(i,l);return this.cachedProperties.center=a,a}}}var Bs=(e=>(e.PRIVATE="private",e.COMPANY="company",e.EMPLOYEE="employee",e.VISITOR="visitor",e))(Bs||{});function JL(e){if(!e)return Bs.PRIVATE;switch(e.toLowerCase()){case"private":return Bs.PRIVATE;case"company":return Bs.COMPANY;case"employee":return Bs.EMPLOYEE;case"visitor":return Bs.VISITOR;default:return console.warn(`Niveau d'accès inconnu: ${e}, utilisation de PRIVATE par défaut`),Bs.PRIVATE}}function oj(e){switch(e){case Bs.PRIVATE:return"Privé";case Bs.COMPANY:return"Entreprise";case Bs.EMPLOYEE:return"Salariés";case Bs.VISITOR:return"Visiteurs";default:return"Inconnu"}}function aj(e){var n,r,i;const t=Mu();return e!==void 0?e:t.isAdmin?null:t.isEntreprise&&t.user?t.user.id:t.isSalarie&&((n=t.user)!=null&&n.enterprise_id)||t.isVisiteur&&((r=t.user)!=null&&r.enterprise_id)||!t.isAdmin&&((i=t.user)!=null&&i.enterprise_id)?t.user.enterprise_id:null}function QL(e,t){const n=e.filter(r=>r.columnId===t);return n.length>0?Math.max(...n.map(r=>r.order))+1:0}function lj(e){return{id:e.id,text:e.text,createdAt:e.created_at,userId:e.user,userName:e.user_name,userRole:e.user_role}}function eP(e){return{id:e.id,url:e.image,caption:e.caption,createdAt:e.created_at}}function Cf(){return new Date().toISOString()}const Gx=[{id:Bs.PRIVATE,title:"Privé",description:"Visible uniquement par vous"},{id:Bs.COMPANY,title:"Entreprise",description:"Visible par l'entreprise"},{id:Bs.EMPLOYEE,title:"Salariés",description:"Visible par l'entreprise et ses salariés"},{id:Bs.VISITOR,title:"Visiteurs",description:"Visible par l'entreprise, ses salariés et ses visiteurs"}],yp=ty("notes",()=>{const e=Rn([]),t=Rn([]),n=Ai(()=>me=>e.value.find(we=>we.id===me)),r=Ai(()=>me=>{const we=e.value.find(ue=>ue.id===me);return we?we.color:"#6B7280"}),i=Ai(()=>e.value.find(me=>me.isDefault)||e.value[0]),l=Ai(()=>[...e.value].sort((me,we)=>me.order-we.order)),a=Ai(()=>me=>t.value.filter(we=>we.columnId===me).sort((we,ue)=>we.order-ue.order)),o=Ai(()=>t.value),f=Ai(()=>me=>o.value.filter(we=>we.columnId===me).sort((we,ue)=>we.order-ue.order));async function m(){try{const me=[{id:"1",title:"Idées",color:"#8B5CF6",order:0,isDefault:!1},{id:"2",title:"À faire",color:"#F59E0B",order:1,isDefault:!0},{id:"3",title:"En cours",color:"#3B82F6",order:2,isDefault:!1},{id:"4",title:"Terminées",color:"#10B981",order:3,isDefault:!1},{id:"5",title:"Autres",color:"#6B7280",order:4,isDefault:!1}];e.value=me}catch(me){throw console.error("[NotesStore][loadColumns] Erreur:",me),me}}async function _(me){}async function w(me,we){try{const ue=e.value.findIndex(_e=>_e.id===me);ue!==-1&&(e.value[ue]={...e.value[ue],...we})}catch(ue){throw console.error("[NotesStore][updateColumn] Erreur:",ue),ue}}function M(me){if(!me.id)throw console.error("[NotesStore][addNote] Erreur: ID du backend manquant"),new Error("L'ID du backend est requis pour ajouter une note");const we=Cf(),ue=QL(t.value,me.columnId||""),_e=JL(me.access_level),We=aj(me.enterprise_id),he={...me,id:me.id,order:ue,accessLevel:_e,createdAt:me.created_at||we,updatedAt:me.updated_at||we,comments:[],photos:[],enterprise_id:We};return t.value.push(he),me.id}function C(me,we){try{const ue=t.value.findIndex(_e=>_e.id===me);ue!==-1&&(we.color&&(we.style={...t.value[ue].style,color:we.color,fillColor:we.color}),we.access_level&&(we.accessLevel=JL(we.access_level),delete we.access_level),t.value[ue]={...t.value[ue],...we})}catch(ue){throw console.error("[NotesStore][updateNote] Erreur:",ue),ue}}function R(me){t.value.findIndex(ue=>ue.id===me)!==-1?t.value=t.value.filter(ue=>ue.id!==me):console.warn("[NotesStore][removeNote] Tentative de suppression d'une note inexistante avec ID:",me)}function z(me,we){const ue=t.value.findIndex(_e=>_e.id===me);if(ue!==-1){const _e=t.value[ue];if(_e.columnId!==we){const he=QL(t.value,we),de={..._e,columnId:we,order:he,updatedAt:Cf()};t.value[ue]=de}else t.value[ue]={...t.value[ue],updatedAt:Cf()}}}function W(me,we){we.forEach((ue,_e)=>{const We=t.value.findIndex(he=>he.id===ue&&he.columnId===me);We!==-1&&(t.value[We]={...t.value[We],order:_e,updatedAt:Cf()})})}async function X(me,we){try{const ue=Mu();if(!ue.user)throw new Error("Vous devez être connecté pour ajouter un commentaire");if(!ue.isEntreprise&&!ue.isAdmin)throw new Error("Seules les entreprises peuvent ajouter des commentaires");if(!t.value.some(ae=>ae.id===me))throw new Error(`La note avec l'ID ${me} n'existe pas`);const he=(await _c.addComment(me,we)).data,de=t.value.findIndex(ae=>ae.id===me);if(de===-1)return;const Te=t.value[de];Te.comments||(Te.comments=[]);const be=lj(he);return Te.comments.push(be),Te.updatedAt=Cf(),t.value[de]={...Te},be.id}catch(ue){throw console.error("Erreur lors de l'ajout du commentaire:",ue),ue}}async function Y(me,we){try{const ue=t.value.findIndex(he=>he.id===me);if(ue===-1)throw new Error(`La note avec l'ID ${me} n'existe pas`);const _e=t.value[ue];if(!_e.comments||_e.comments.length===0)throw new Error("Aucun commentaire trouvé pour cette note");if(!_e.comments.some(he=>he.id===we))throw new Error(`Le commentaire avec l'ID ${we} n'existe pas`);await _c.deleteComment(me,we),_e.comments=_e.comments.filter(he=>he.id!==we),_e.updatedAt=Cf(),t.value[ue]={..._e}}catch(ue){throw console.error("Erreur lors de la suppression du commentaire:",ue),ue}}async function Q(me,we){try{if(we.id&&we.image){const ue=t.value.findIndex(he=>he.id===me);if(ue===-1)return;const _e=t.value[ue];_e.photos||(_e.photos=[]);const We=eP(we);return _e.photos.push(We),_e.updatedAt=Cf(),t.value[ue]={..._e},We.id}else{const ue=new FormData;ue.append("image",we.url),we.caption&&ue.append("caption",we.caption);const We=(await _c.addPhoto(me,ue)).data,he=t.value.findIndex(be=>be.id===me);if(he===-1)return;const de=t.value[he];de.photos||(de.photos=[]);const Te=eP(We);return de.photos.push(Te),de.updatedAt=Cf(),t.value[he]={...de},Te.id}}catch(ue){throw console.error("Erreur lors de l'ajout de la photo:",ue),ue}}async function oe(me,we){try{await _c.deletePhoto(me,we);const ue=t.value.findIndex(he=>he.id===me);if(ue===-1){console.error("[NotesStore] Note non trouvée pour la suppression de la photo");return}t.value[ue].photos||(t.value[ue].photos=[]);const _e=t.value[ue],We=(_e.photos||[]).filter(he=>he.id!==we);t.value[ue]={..._e,photos:We,updatedAt:Cf()}}catch(ue){throw console.error("Erreur lors de la suppression de la photo:",ue),ue}}async function le(me,we,ue){try{await _c.updatePhoto(me,we,{caption:ue});const _e=t.value.findIndex(de=>de.id===me);if(_e===-1||!t.value[_e].photos)return;const We=t.value[_e],he=We.photos.findIndex(de=>de.id===we);if(he===-1)return;We.photos[he].caption=ue,We.updatedAt=Cf(),t.value[_e]={...We}}catch(_e){throw console.error("Erreur lors de la mise à jour de la légende:",_e),_e}}return{columns:e,notes:t,getColumnById:n,getColumnColor:r,getDefaultColumn:i,getSortedColumns:l,getNotesByColumn:a,getAccessibleNotes:o,getAccessibleNotesByColumn:f,getAccessLevelLabel:oj,loadColumns:m,addColumn:_,updateColumn:w,addNote:M,updateNote:C,removeNote:R,moveNote:z,reorderNotes:W,addComment:X,removeComment:Y,addPhoto:Q,removePhoto:oe,updatePhoto:le}});class bh extends jr.Marker{constructor(n,r={}){const l=`
      <div class="geo-note-marker">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
          <path d="M12 22s-8-4.5-8-11.8A8 8 0 0 1 12 2a8 8 0 0 1 8 8.2c0 7.3-8 11.8-8 11.8z" fill="${r.color||"#2b6451"}" />
        </svg>
      </div>
    `,a=jr.divIcon({html:l,className:"geo-note-icon",iconSize:[24,36],iconAnchor:[12,36]});if(!document.getElementById("geo-note-style")){const f=document.createElement("style");f.id="geo-note-style",f.textContent=`
        .geo-note-icon {
          background: none !important;
          border: none !important;
        }
        .geo-note-marker {
          display: flex;
          align-items: center;
          justify-content: center;
          width: 100%;
          height: 100%;
          position: relative;
          transition: filter 0.2s ease-in-out;
        }
        .geo-note-marker.hover {
          filter: brightness(1.2) drop-shadow(0 0 4px rgba(59, 130, 246, 0.7));
        }
      `,document.head.appendChild(f)}super(n,{icon:a,draggable:!1,autoPan:!0,riseOnHover:!0,bubblingMouseEvents:!1,interactive:!0,keyboard:!1});un(this,"properties");un(this,"_planSaved",!1);un(this,"_isMoving",!1);un(this,"_animateZoom",()=>{});this.properties={type:"Note",name:r.name||"Note géolocalisée",description:r.description||"",columnId:r.columnId||"1",accessLevel:r.accessLevel||Bs.PRIVATE,category:r.category||"forages",style:{color:r.color||"#2b6451",weight:r.weight||2,fillColor:r.fillColor||"#2b6451",fillOpacity:r.fillOpacity!==void 0?r.fillOpacity:.8,radius:r.radius||12},comments:[],photos:[],order:0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),enterprise_id:r.enterprise_id||null},this.on("dblclick",this.onDoubleClick),this.on("add",f=>{if(f.target&&f.target._map){const m=f.target._map;this._protectFromZoomAnimationErrors(m),m.on("zoomend",()=>{this.updatePosition(),this.refreshIconStyle(),this.forceVisible()}),m.on("moveend",()=>{this.updatePosition(),this.refreshIconStyle(),this.forceVisible()}),setTimeout(()=>this.forceVisible(),100)}}),window.addEventListener("geonote:updateStyle",f=>{const m=f.detail.noteId,_=this._dbId||this.properties.id;m===_&&(this.setNoteStyle(f.detail.style),this.properties&&this.properties.style&&(this.properties.style={...this.properties.style,...f.detail.style}))}),window.addEventListener("geonote:update",f=>{const m=f.detail.noteId,_=this._dbId||this.properties.id;if(m===_){if(this.properties={...this.properties,name:f.detail.properties.name,description:f.detail.properties.description,columnId:f.detail.properties.columnId,accessLevel:f.detail.properties.accessLevel,style:f.detail.properties.style,updatedAt:new Date().toISOString()},this.setNoteStyle(f.detail.properties.style),_)try{const M=yp().notes.find(C=>C.id===parseInt(String(_)));M&&(this.properties.comments=M.comments||[],this.properties.photos=M.photos||[],this.properties.createdAt=M.createdAt,this.properties.updatedAt=M.updatedAt)}catch(w){console.error("[GeoNote] Erreur lors de la récupération de la note depuis le store:",w)}this.getPopup()&&this.setPopupContent(this.createPopupContent())}}),this.on("mouseover",this.highlight),this.on("mouseout",this.unhighlight)}forceVisible(){try{const n=this.getElement();if(!n){console.warn("[GeoNote][forceVisible] Élément DOM introuvable, recréation de l'icône"),this.recreateIcon();return}n.style.display="block",n.style.visibility="visible",n.style.opacity="1";const r=n.querySelector(".geo-note-marker");r&&(r.style.display="flex",r.style.visibility="visible",r.style.opacity="1");const i=n.querySelector("svg");i&&(i.style.display="block",i.style.visibility="visible",i.style.opacity="1"),n.offsetHeight}catch(n){console.error("[GeoNote][forceVisible] Erreur:",n),this.recreateIcon()}}recreateIcon(){var n,r;try{const i=this.getLatLng(),a=`
        <div class="geo-note-marker" style="display: flex; visibility: visible; opacity: 1;">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" style="display: block; visibility: visible; opacity: 1;">
            <path d="M12 22s-8-4.5-8-11.8A8 8 0 0 1 12 2a8 8 0 0 1 8 8.2c0 7.3-8 11.8-8 11.8z" fill="${((n=this.properties.style)==null?void 0:n.fillColor)||((r=this.properties.style)==null?void 0:r.color)||"#2b6451"}" />
          </svg>
        </div>
      `,o=jr.divIcon({html:a,className:"geo-note-icon forced-visible",iconSize:[24,36],iconAnchor:[12,36]});if(this.setIcon(o),this._map){const f=this._map.latLngToLayerPoint(i),m=this.getElement();m&&jr.DomUtil.setPosition(m,f)}if(!document.getElementById("geo-note-forced-style")){const f=document.createElement("style");f.id="geo-note-forced-style",f.textContent=`
          .forced-visible {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            pointer-events: auto !important;
          }
          .forced-visible * {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
          }
          .geo-note-marker {
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
          }
        `,document.head.appendChild(f)}}catch(i){console.error("[GeoNote][recreateIcon] Erreur lors de la recréation de l'icône:",i)}}highlight(){const n=this.getElement();if(n){this.forceVisible(),n.style.visibility="visible",n.style.display="",n.style.opacity="1",n.style.zIndex="1000";const r=n.querySelector(".geo-note-marker");r&&r.classList.add("hover")}}unhighlight(){const n=this.getElement();if(n){this.forceVisible();const r=n.querySelector(".geo-note-marker");r&&r.classList.remove("hover"),n.style.zIndex="",n.style.visibility="visible",n.style.display="",n.style.opacity="1"}}getColumnColor(n){return{1:"#8B5CF6",2:"#F59E0B",3:"#3B82F6",4:"#10B981",5:"#6B7280"}[n]||"#6B7280"}getColumnLabel(n){return{1:"Idées",2:"À faire",3:"En cours",4:"Terminées",5:"Autres"}[n]||"Colonne "+n}getAccessLevelLabel(n){switch(n){case Bs.PRIVATE:return"Privé";case Bs.COMPANY:return"Entreprise";case Bs.EMPLOYEE:return"Salariés";case Bs.VISITOR:return"Visiteurs";default:return"Inconnu"}}getAccessLevelColor(n){switch(n){case Bs.PRIVATE:return"#9CA3AF";case Bs.COMPANY:return"#EF4444";case Bs.EMPLOYEE:return"#F59E0B";case Bs.VISITOR:return"#10B981";default:return"#6B7280"}}onDoubleClick(n){jr.DomEvent.stopPropagation(n),this.editNote()}editNote(){const n=this._dbId,r=this._leaflet_id;if(n)try{const o=yp().notes.find(f=>f.id===parseInt(String(n)));o&&(this.properties.name=o.title,this.properties.description=o.description,this.properties.columnId=o.columnId,this.properties.accessLevel=o.accessLevel,this.properties.style={...o.style},this.properties.comments=o.comments||[],this.properties.photos=o.photos||[],this.properties.createdAt=o.createdAt,this.properties.updatedAt=o.updatedAt)}catch(a){console.error("[GeoNote] Erreur lors de la récupération de la note depuis le store:",a)}const i={id:r,backendId:n,title:this.properties.name,description:this.properties.description,location:{type:"Point",coordinates:[this.getLatLng().lng,this.getLatLng().lat]},columnId:this.properties.columnId||"1",accessLevel:this.properties.accessLevel||"company",style:this.properties.style||{color:"#2b6451",weight:2,opacity:1,fillColor:"#2b6451",fillOpacity:.6,radius:8},comments:this.properties.comments||[],photos:this.properties.photos||[],createdAt:this.properties.createdAt||new Date().toISOString(),updatedAt:this.properties.updatedAt||new Date().toISOString()},l=new CustomEvent("geonote:edit",{detail:{note:i,source:this,backendId:n}});window.dispatchEvent(l),this.fire("note:edit",{note:i,source:this,backendId:n})}updateProperties(){var l;this.properties.type="Note",this.properties.category||(this.properties.category="forages"),this.properties.accessLevel||(this.properties.accessLevel=Bs.PRIVATE);const n=this.properties.style||{};let r=n.color||n.fillColor;if(!r){const a=(l=this.getElement())==null?void 0:l.querySelector(".geo-note-marker svg path");if(a){const o=a.getAttribute("fill");o&&(r=o)}}r||(r="#2b6451");const i=n.radius||12;this.properties.style={...n,color:r,weight:n.weight||2,fillColor:r,fillOpacity:n.fillOpacity||.8,radius:i,_accessLevel:this.properties.accessLevel,accessLevel:this.properties.accessLevel,category:this.properties.category}}setNoteStyle(n){const r=n.color||n.fillColor||"#2b6451",i=n.fillColor||n.color||"#2b6451",l=this.getElement();if(l)try{const f=l.querySelector("svg path");f?f.setAttribute("fill",i):this._updateIconWithNewColor(i)}catch(f){console.warn("[GeoNote][setNoteStyle] Erreur lors de la mise à jour directe du SVG:",f),this._updateIconWithNewColor(i)}else this._updateIconWithNewColor(i);const a=n._accessLevel||n.accessLevel||this.properties.accessLevel,o=n.category||this.properties.category;this.properties&&this.properties.style&&(this.properties.style={...this.properties.style,color:r,weight:n.weight||this.properties.style.weight||2,fillColor:i,fillOpacity:n.fillOpacity!==void 0?n.fillOpacity:this.properties.style.fillOpacity||.8,radius:n.radius||this.properties.style.radius||12,_accessLevel:a,accessLevel:a,category:o}),a&&this.properties.accessLevel!==a&&(this.properties.accessLevel=a),o&&this.properties.category!==o&&(this.properties.category=o),this.refreshIconStyle()}refreshIconStyle(){const n=this.getElement();if(n&&(n.style.display="none",n.offsetHeight,n.style.display="",jr.DomUtil.setTransform(n,new jr.Point(0,0),1),this._map))try{const r=this._map.latLngToLayerPoint(this.getLatLng());jr.DomUtil.setPosition(n,r),n.style.opacity="1",n.style.transition="opacity 0.2s"}catch(r){console.warn("[GeoNote][refreshIconStyle] Erreur lors de la mise à jour de la position:",r)}}_protectFromZoomAnimationErrors(n){try{const r=this._animateZoom;this._animateZoom=function(i){try{if(!this._map||!i.center||!i.zoom){console.warn("[GeoNote][_animateZoom] Animation de zoom ignorée: propriétés manquantes");return}typeof this.updatePositionDuringZoom=="function"?this.updatePositionDuringZoom(i):r.call(this,i)}catch(l){console.warn("[GeoNote][_animateZoom] Erreur lors de l'animation de zoom:",l);try{const a=this.getElement();if(a&&this._map){const o=this._map.latLngToLayerPoint(this.getLatLng());jr.DomUtil.setPosition(a,o)}}catch(a){console.error("[GeoNote][_animateZoom] Erreur lors de la récupération:",a)}}},n.on("zoomanim",i=>{this.updatePositionDuringZoom(i)})}catch(r){console.error("[GeoNote][_protectFromZoomAnimationErrors] Erreur lors de la mise en place de la protection:",r)}}_updateIconWithNewColor(n){try{const r=this._map;let i=!1;r&&(i=r.options.zoomAnimation||!1,r.options.zoomAnimation=!1);const l=`
        <div class="geo-note-marker">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
            <path d="M12 22s-8-4.5-8-11.8A8 8 0 0 1 12 2a8 8 0 0 1 8 8.2c0 7.3-8 11.8-8 11.8z" fill="${n}" />
          </svg>
        </div>
      `,a=jr.divIcon({html:l,className:"geo-note-icon",iconSize:[24,36],iconAnchor:[12,36]});this.setIcon(a),r&&i&&setTimeout(()=>{r.options.zoomAnimation=!0},100)}catch(r){console.error("[GeoNote][_updateIconWithNewColor] Erreur lors de la mise à jour de l'icône:",r)}}toBackendFormat(n){this.updateProperties();const r=this.getLatLng(),l={...{...this.properties.style,radius:this.properties.style.radius||12},_accessLevel:this.properties.accessLevel,accessLevel:this.properties.accessLevel},a=this.properties.columnId||"1";return{id:n,type_forme:"Note",data:{location:{type:"Point",coordinates:[r.lng,r.lat]},name:this.properties.name,description:this.properties.description,columnId:a,accessLevel:this.properties.accessLevel,category:this.properties.category||"forages",style:l,comments:this.properties.comments||[],photos:this.properties.photos||[],order:this.properties.order||0,createdAt:this.properties.createdAt||new Date().toISOString(),updatedAt:new Date().toISOString()}}}updateFromBackendData(n){var f,m,_;this.properties.type="Note";const r=n.style?{...n.style,radius:n.style.radius||12}:this.properties.style,i=((f=n.style)==null?void 0:f._accessLevel)||((m=n.style)==null?void 0:m.accessLevel)||n.accessLevel||this.properties.accessLevel||Bs.PRIVATE,l=((_=n.style)==null?void 0:_.category)||n.category||this.properties.category||"forages",a=n.columnId||this.properties.columnId||"1",o={...r,_accessLevel:i,accessLevel:i,category:l};this.properties={...this.properties,name:n.name||this.properties.name,description:n.description||this.properties.description,columnId:a,accessLevel:i,category:l,style:o,comments:n.comments||this.properties.comments||[],photos:n.photos||this.properties.photos||[],order:n.order||this.properties.order||0,createdAt:n.createdAt||this.properties.createdAt,updatedAt:n.updatedAt||new Date().toISOString()},this.setNoteStyle(o)}static fromBackendData(n){var f,m,_,w,M,C,R,z;let r;if(typeof n.location=="object"&&!Array.isArray(n.location)&&n.location.type==="Point"){const W=n.location.coordinates;r=[W[1],W[0]]}else if(Array.isArray(n.location)&&n.location.length===2)r=n.location;else throw new Error("Les données de la note ne contiennent pas de position valide");const i=((f=n.style)==null?void 0:f._accessLevel)||((m=n.style)==null?void 0:m.accessLevel)||n.accessLevel||Bs.PRIVATE,l=((_=n.style)==null?void 0:_.category)||n.category||"forages";n.accessLevel=i,n.category=l;const a=n.columnId||"1",o=new bh(r,{name:n.name,description:n.description,columnId:a,accessLevel:i,category:n.category||"forages",color:(w=n.style)==null?void 0:w.color,weight:(M=n.style)==null?void 0:M.weight,fillColor:(C=n.style)==null?void 0:C.fillColor,fillOpacity:(R=n.style)==null?void 0:R.fillOpacity,radius:(z=n.style)==null?void 0:z.radius});return o.properties.type="Note",o.properties.comments=n.comments||[],o.properties.photos=n.photos||[],o.properties.order=n.order||0,o.properties.createdAt=n.createdAt||new Date().toISOString(),o.properties.updatedAt=n.updatedAt||new Date().toISOString(),n.style&&o.setNoteStyle(n.style),o}async saveNote(n){var r,i,l;if(this._planSaved)return this._dbId||0;try{this.updateProperties();let a=((r=this.properties.style)==null?void 0:r.color)||"#2b6451";if(a.startsWith("rgb")){const _=(i=this.getElement())==null?void 0:i.querySelector(".geo-note-marker svg path");if(_){const w=_.getAttribute("fill");w&&(a=w)}}const o={...this.properties.style,color:a,fillColor:a,_accessLevel:this.properties.accessLevel,accessLevel:this.properties.accessLevel,category:this.properties.category},f={title:this.properties.name,description:this.properties.description,location:{type:"Point",coordinates:[this.getLatLng().lng,this.getLatLng().lat]},column:this.properties.columnId||"1",access_level:this.properties.accessLevel||"company",style:o,category:this.properties.category||"forages",comments:this.properties.comments||[],photos:this.properties.photos||[]};if(this.properties.enterprise_id)f.enterprise_id=this.properties.enterprise_id;else{const _=Mu();!_.isAdmin&&((l=_.user)!=null&&l.enterprise_id)&&(f.enterprise_id=_.user.enterprise_id)}n&&(f.plan=n);let m;return this._dbId?m=(await _c.updateNote(this._dbId,f)).data:(m=(await _c.createNote(f)).data,this._dbId=m.id,yp().addNote({...m,id:m.id,columnId:m.column,accessLevel:m.access_level})),this._planSaved=!0,m.id}catch(a){return console.error("[GeoNote][saveNote] Erreur lors de la sauvegarde de la note:",a),Lh().error("Erreur lors de la sauvegarde de la note"),0}}triggerPlanSave(){const n=localStorage.getItem("lastPlanId");n?this.saveNote(parseInt(n)):this.saveNote();const r=new CustomEvent("geonote:savePlan");window.dispatchEvent(r)}resetPlanSaveState(){this._planSaved=!1}moveTo(n){this.setLatLng(n),this.fire("note:moved",{latlng:n,note:this}),this.triggerPlanSave()}startMoving(){this._isMoving=!0,this.fire("note:movestart",{latlng:this.getLatLng(),note:this})}finishMoving(){this._isMoving=!1,this.fire("note:moveend",{latlng:this.getLatLng(),note:this}),this.triggerPlanSave()}isMoving(){return this._isMoving}updatePositionDuringZoom(n){try{if(!this._map||!n.center||n.zoom===void 0)return;const r=this.getElement();if(!r)return;r.style.opacity="0",r.style.transition="opacity 0.01s"}catch(r){console.warn("[GeoNote][updatePositionDuringZoom] Erreur lors de la gestion de l'animation de zoom:",r)}}updatePosition(){try{if(!this._map)return;const n=this.getElement();if(!n){console.warn("[GeoNote][updatePosition] Élément DOM introuvable, recréation de l'icône"),this.recreateIcon();return}const r=this._map.latLngToLayerPoint(this.getLatLng());jr.DomUtil.setPosition(n,r),n.style.opacity="1",n.style.transition="opacity 0.2s",n.style.visibility="visible",n.style.display="block";const i=n.getBoundingClientRect();i.width===0||i.height===0?(console.warn("[GeoNote][updatePosition] L'élément a une taille nulle, recréation de l'icône"),this.recreateIcon()):setTimeout(()=>this.forceVisible(),50)}catch(n){console.warn("[GeoNote][updatePosition] Erreur lors de la mise à jour de la position:",n),this.recreateIcon()}}openInGoogleMaps(){const n=Lh(),r=this.getLatLng();if(!r||isNaN(r.lat)||isNaN(r.lng)){n.warning("La position de la note est invalide ou manquante");return}Dd(()=>Promise.resolve().then(()=>Tk),void 0).then(i=>{i.openInGoogleMaps(r.lat,r.lng,"directions",this.properties.name)})}}function uj(e){return e&&Array.isArray(e.points)&&e.points.length>0&&Array.isArray(e.points[0])&&e.points[0].length===2}function cj(e){return e&&Array.isArray(e.points)&&e.points.length>0&&Array.isArray(e.points[0])&&e.points[0].length===2}function tP(e){var t,n,r,i,l,a,o,f,m,_,w,M,C,R,z,W,X,Y,Q;if(((t=e.properties)==null?void 0:t.type)==="Note"){const oe=e.getLatLng();return{type_forme:"Note",data:{points:[[oe.lng,oe.lat]],style:{color:((n=e.properties.style)==null?void 0:n.color)||"#2b6451",weight:((r=e.properties.style)==null?void 0:r.weight)||3,opacity:((i=e.properties.style)==null?void 0:i.opacity)||1,fillColor:((l=e.properties.style)==null?void 0:l.fillColor)||"#2b6451",fillOpacity:((a=e.properties.style)==null?void 0:a.fillOpacity)||.2,name:((o=e.properties.style)==null?void 0:o.name)||""}}}}if(e instanceof Uh||((f=e.properties)==null?void 0:f.type)==="Polygon")return{type_forme:"Polygon",data:{points:e.getLatLngs()[0].map(me=>[me.lng,me.lat]),style:{color:((m=e.properties.style)==null?void 0:m.color)||"#2b6451",weight:((_=e.properties.style)==null?void 0:_.weight)||3,opacity:((w=e.properties.style)==null?void 0:w.opacity)||1,fillColor:((M=e.properties.style)==null?void 0:M.fillColor)||"#2b6451",fillOpacity:((C=e.properties.style)==null?void 0:C.fillOpacity)||.2,name:((R=e.properties.style)==null?void 0:R.name)||""},category:e.properties.category||"forages",accessLevel:e.properties.accessLevel||"visitor"}};if(e instanceof dl||((z=e.properties)==null?void 0:z.type)==="Line")return{type_forme:"Line",data:{points:e.getLatLngs().map(me=>[me.lng,me.lat]),category:e.properties.category||"forages",accessLevel:e.properties.accessLevel||"visitor",style:{color:((W=e.properties.style)==null?void 0:W.color)||"#2b6451",weight:((X=e.properties.style)==null?void 0:X.weight)||3,opacity:((Y=e.properties.style)==null?void 0:Y.opacity)||1,name:((Q=e.properties.style)==null?void 0:Q.name)||""}}};throw new Error("Type de forme non reconnu")}function hj(e){var t,n,r,i,l,a,o,f,m,_,w,M,C,R,z,W,X;switch(e.type_forme){case"Polygon":{const Y=e.data;if(!uj(Y))return console.error("[DrawingStore] Données invalides pour Polygon"),null;const Q=Y.points.map(me=>Ba.latLng(me[1],me[0])),oe=((t=Y.style)==null?void 0:t._accessLevel)||((n=Y.style)==null?void 0:n.accessLevel)||Y.accessLevel||"visitor";Y.accessLevel=oe;const le=new Uh([Q],{color:((r=Y.style)==null?void 0:r.color)||"#2b6451",weight:((i=Y.style)==null?void 0:i.weight)||3,opacity:((l=Y.style)==null?void 0:l.opacity)||1,fillColor:((a=Y.style)==null?void 0:a.fillColor)||"#2b6451",fillOpacity:((o=Y.style)==null?void 0:o.fillOpacity)||.2,dashArray:((f=Y.style)==null?void 0:f.dashArray)||"",name:((m=Y.style)==null?void 0:m.name)||"",category:Y.category||"forages",accessLevel:oe});return le.updateProperties(),le}case"Line":{const Y=e.data;if(!cj(Y))return console.error("[DrawingStore] Données invalides pour Ligne"),null;const Q=Y.points.map(me=>Ba.latLng(me[1],me[0])),oe=((_=Y.style)==null?void 0:_._accessLevel)||((w=Y.style)==null?void 0:w.accessLevel)||Y.accessLevel||"visitor";Y.accessLevel=oe;const le=new dl(Q,{...Y.style||{},name:((M=Y.style)==null?void 0:M.name)||"",category:Y.category||"forages",accessLevel:oe});return le.updateProperties(),le}case"Note":{const Y=e.data;if(!Y.location)return console.error("[DrawingStore] Données invalides pour Note"),null;try{const Q={location:Y.location,name:Y.name||"Note géolocalisée",description:Y.description||"",columnId:Y.columnId||"en-cours",accessLevel:Y.accessLevel||"private",category:Y.category||"forages",style:{color:((C=Y.style)==null?void 0:C.color)||"#2b6451",weight:((R=Y.style)==null?void 0:R.weight)||2,fillColor:((z=Y.style)==null?void 0:z.fillColor)||"#2b6451",fillOpacity:((W=Y.style)==null?void 0:W.fillOpacity)||.8,radius:((X=Y.style)==null?void 0:X.radius)||12},comments:Y.comments||[],photos:Y.photos||[],order:Y.order||0,createdAt:Y.createdAt||new Date().toISOString(),updatedAt:Y.updatedAt||new Date().toISOString()},oe=bh.fromBackendData(Q);return oe._dbId=e.id,oe}catch(Q){return console.error("[DrawingStore] Erreur lors de la création de la Note:",Q),null}}default:return console.warn("[DrawingStore] Type non géré pour la restauration:",e.type_forme),null}}const C_=ty("drawing",{state:()=>({currentMapId:null,elements:[],selectedElement:null,unsavedChanges:!1,loading:!1,error:null,currentTool:"",filters:{accessLevels:{company:!0,employee:!0,visitor:!0},categories:{forages:!0,clients:!0,entrepots:!0,livraisons:!0,cultures:!0,parcelles:!0},shapeTypes:{Polygon:!0,Line:!0,Note:!0}},currentStyle:{strokeStyle:"solid",strokeWidth:2,strokeColor:"#2563EB",fillColor:"#3B82F6",fillOpacity:.2},lastUsedType:null}),getters:{hasUnsavedChanges:e=>e.unsavedChanges,getCurrentElements:e=>e.elements,getSelectedElement:e=>e.selectedElement,getCurrentTool:e=>e.currentTool,getCurrentStyle:e=>e.currentStyle,getLastUsedType:e=>e.lastUsedType,getFilters:e=>e.filters,getFilteredElements:e=>e.elements.length===0?[]:e.elements.filter(n=>{var f,m;if(!(n.type_forme in e.filters.shapeTypes?e.filters.shapeTypes[n.type_forme]:!0))return!1;const i=((f=n.data)==null?void 0:f.category)||"default";if(!(i in e.filters.categories?e.filters.categories[i]:!0))return!1;const a=((m=n.data)==null?void 0:m.accessLevel)||"visitor";let o=!0;return a==="company"?o=e.filters.accessLevels.company:a==="employee"?o=e.filters.accessLevels.employee:a==="visitor"&&(o=e.filters.accessLevels.visitor),!!o})},actions:{setCurrentPlan(e){window.dispatchEvent(new CustomEvent("clearControlPoints")),this.currentMapId=e,e===null&&this.clearElements(),this.selectedElement=null,this.unsavedChanges=!1,this.currentTool="",this.lastUsedType=null,this.currentStyle={strokeStyle:"solid",strokeWidth:2,strokeColor:"#2563EB",fillColor:"#3B82F6",fillOpacity:.2},this.filters={accessLevels:{company:!0,employee:!0,visitor:!0},categories:{forages:!0,clients:!0,entrepots:!0,livraisons:!0,cultures:!0,parcelles:!0},shapeTypes:{Polygon:!0,Line:!0,Note:!0}}},clearCurrentPlan(){(this.currentMapId!==null||this.elements.length>0)&&(this.currentMapId=null,this.elements=[],this.selectedElement=null,this.unsavedChanges=!1,this.loading=!1,this.error=null)},clearElements(){this.elements=[],this.selectedElement=null,this.unsavedChanges=!1,this.error=null},addElement(e){if(e instanceof Ba.Layer&&e.properties){const t=tP(e);this.elements.push(t)}else!e.type_forme&&this.lastUsedType&&(e.type_forme=this.lastUsedType),this.elements.push(e);this.unsavedChanges=!0},updateElement(e){const t=this.elements.findIndex(n=>n.id===e.id);if(t!==-1){const n=this.elements[t].type_forme;this.elements[t]={...e,type_forme:n},this.unsavedChanges=!0}},removeElement(e){const t=this.elements.findIndex(n=>n.id===e);t!==-1&&(this.elements.splice(t,1),this.unsavedChanges=!0)},selectElement(e){this.selectedElement=e},setCurrentTool(e){this.currentTool=e,["CERCLE","RECTANGLE","DEMI_CERCLE","LIGNE"].includes(e)&&(this.lastUsedType=e)},setCurrentStyle(e){if(!e||Object.keys(e).length===0){this.currentStyle={strokeStyle:"solid",strokeWidth:2,strokeColor:"#2563EB",fillColor:"#3B82F6",fillOpacity:.2};return}this.currentStyle={...this.currentStyle,...e}},updateFilters(e){if(e.accessLevels&&({...this.filters.accessLevels},this.filters.accessLevels={...this.filters.accessLevels,...e.accessLevels}),e.categories){const t={...this.filters.categories};this.filters.categories={...this.filters.categories,...e.categories};const n=Object.keys(e.categories).filter(r=>t[r]!==this.filters.categories[r]);if(n.length>0){const r=n.filter(i=>t[i]===!1&&this.filters.categories[i]===!0);r.length>0&&window.dispatchEvent(new CustomEvent("categoriesReactivated",{detail:{categories:r}}))}}if(e.shapeTypes){const t={...this.filters.shapeTypes};this.filters.shapeTypes={...this.filters.shapeTypes,...e.shapeTypes};const n=Object.keys(e.shapeTypes).filter(r=>t[r]!==this.filters.shapeTypes[r]);if(n.length>0){const r=n.filter(i=>t[i]===!1&&this.filters.shapeTypes[i]===!0);r.length>0&&window.dispatchEvent(new CustomEvent("shapeTypesReactivated",{detail:{shapeTypes:r}}))}}window.dispatchEvent(new CustomEvent("filtersChanged",{detail:{filters:this.filters}}))},async loadPlanElements(e){if(this.currentMapId===e&&this.elements.length>0)return this.elements;this.loading=!0;try{const n=(await Kr.get(`/plans/${e}/`)).data;return this.elements=n.formes.map(r=>{if(r.type_forme)return{id:r.id,type_forme:r.type_forme,data:r.data||{}};try{const i=hj(r);if(i)return tP(i)}catch(i){console.error("Erreur lors de la conversion de la forme",{error:i,id:r.id,type:r.type_forme})}return r}),this.currentMapId=e,this.unsavedChanges=!1,n.preferences&&(n.preferences.currentTool&&this.setCurrentTool(n.preferences.currentTool),n.preferences.currentStyle&&(this.currentStyle={...this.currentStyle,...n.preferences.currentStyle}),n.preferences.lastUsedType&&(this.lastUsedType=n.preferences.lastUsedType)),this.elements}catch(t){throw console.error("Erreur lors du chargement des éléments:",t),this.error="Erreur lors du chargement des éléments du plan",t}finally{this.loading=!1}},async saveToPlan(e,t){this.loading=!0;try{const n=e||this.currentMapId;if(!n)throw new Error("Aucun plan sélectionné pour la sauvegarde");const r=this.elements.map(f=>({...f,type_forme:f.type_forme||this.lastUsedType})),i=(t==null?void 0:t.elementsToDelete)||[],l=`/plans/${n}/save_with_elements/`,a=await Kr.post(l,{formes:r,connexions:[],annotations:[],elementsToDelete:i,preferences:{currentTool:this.currentTool,currentStyle:this.currentStyle,lastUsedType:this.lastUsedType}}),o=new Set(i);return this.elements=a.data.formes.filter(f=>!o.has(f.id)).map(f=>({...f,type_forme:f.type_forme})),this.unsavedChanges=!1,a.data}catch(n){throw console.error("Erreur lors de la sauvegarde du plan:",n),this.error="Erreur lors de la sauvegarde du plan",n}finally{this.loading=!1}}}}),vk=ty("mapFilters",{state:()=>({filters:[],loading:!1,error:null}),getters:{getFilterById:e=>t=>e.filters.find(n=>n.id===t),getFiltersByCategory:e=>t=>e.filters.filter(n=>n.category===t),getUniqueCategories:e=>{const t=new Set;return e.filters.forEach(n=>t.add(n.category)),Array.from(t)}},actions:{async initializeStore(){await this.fetchFilters()},async fetchFilters(){const e=Lh();this.loading=!0,this.error=null;try{const t=await _b.getFilters();return this.filters=t.data,this.filters}catch(t){throw this.error="Erreur lors du chargement des filtres",e.error("Impossible de charger les filtres de carte"),console.error("[MapFilterStore] Erreur lors du chargement des filtres:",t),t}finally{this.loading=!1}},async createFilter(e){this.loading=!0,this.error=null;try{const t=await _b.createFilter(e);return this.filters.push(t.data),t.data}catch(t){throw this.error="Erreur lors de la création du filtre",console.error("[MapFilterStore] Erreur lors de la création du filtre:",t),t}finally{this.loading=!1}},async updateFilter(e,t){this.loading=!0,this.error=null;try{const n=await _b.updateFilter(e,t),r=this.filters.findIndex(i=>i.id===e);return r!==-1&&(this.filters[r]=n.data),n.data}catch(n){throw this.error="Erreur lors de la mise à jour du filtre",console.error("[MapFilterStore] Erreur lors de la mise à jour du filtre:",n),n}finally{this.loading=!1}},async deleteFilter(e){this.loading=!0,this.error=null;try{return await _b.deleteFilter(e),this.filters=this.filters.filter(t=>t.id!==e),!0}catch(t){throw this.error="Erreur lors de la suppression du filtre",console.error("[MapFilterStore] Erreur lors de la suppression du filtre:",t),t}finally{this.loading=!1}}}}),CC=ty("irrigation",{state:()=>({plans:[],currentPlan:null,loading:!1,error:null,autoSaveInterval:null,unsavedChanges:!1,planHistory:[]}),getters:{getPlanById:e=>t=>e.plans.find(n=>n.id===t),hasUnsavedChanges:e=>e.unsavedChanges,getCurrentPlanHistory:e=>e.planHistory},actions:{async fetchPlans(){var t,n;const e=Mu();this.loading=!0;try{let r="/plans/";const i={};e.isSalarie?i.salarie=(t=e.user)==null?void 0:t.id:e.isVisiteur&&(i.visiteur=(n=e.user)==null?void 0:n.id);const l=await Kr.get(r,{params:i});this.plans=l.data}catch(r){throw this.error="Erreur lors du chargement des plans",r}finally{this.loading=!1}},async fetchPlansWithDetails(){var t,n;const e=Mu();this.loading=!0;try{let r="/plans/";const i={include_details:!0};e.isSalarie?i.salarie=(t=e.user)==null?void 0:t.id:e.isVisiteur&&(i.visiteur=(n=e.user)==null?void 0:n.id);const a=(await Kr.get(r,{params:i})).data.map(o=>({...o,entreprise:typeof o.entreprise=="object"?o.entreprise:null,salarie:typeof o.salarie=="object"?o.salarie:null,visiteur:typeof o.visiteur=="object"?o.visiteur:null}));return this.plans=a,{data:a}}catch(r){throw console.error("[IrrigationStore] Error fetching plans:",r),this.error="Erreur lors du chargement des plans",r}finally{this.loading=!1}},async fetchClientPlans(e){this.loading=!0;try{return(await vb.getVisiteurPlans(e)).data}catch(t){throw this.error="Erreur lors du chargement des plans du client",t}finally{this.loading=!1}},async createPlan(e){var n;this.clearCurrentPlan(),this.loading=!0;const t=Lh();try{const r=Mu();((n=r.user)==null?void 0:n.user_type)==="visiteur"&&(e={...e,visiteur:r.user.id,salarie_id:r.user.enterprise_id,entreprise_id:r.user.enterprise_id});const i={...e,entreprise:e.entreprise?typeof e.entreprise=="object"&&e.entreprise&&"id"in e.entreprise?e.entreprise.id:Number(e.entreprise):null,salarie:e.salarie?typeof e.salarie=="object"&&e.salarie&&"id"in e.salarie?e.salarie.id:Number(e.salarie):null,visiteur:e.visiteur?typeof e.visiteur=="object"&&e.visiteur&&"id"in e.visiteur?e.visiteur.id:Number(e.visiteur):null},l=await vb.createPlan(i);return this.plans.push(l.data),t.success(`Le plan "${l.data.nom}" a été créé avec succès`),l.data}catch(r){const i=r instanceof Error?r.message:String(r);throw console.error("Error creating plan:",i),this.error=i,t.error(`Erreur lors de la création du plan : ${i}`),r}finally{this.loading=!1}},async createPlanForClient(e,t){this.clearCurrentPlan(),this.loading=!0;try{const n={...e,visiteur:t},r=await vb.createPlanForVisiteur(n);return this.plans.push(r.data),r.data}catch(n){const r=n instanceof Error?n.message:String(n);throw console.error("Error creating plan for client:",r),this.error="Erreur lors de la création du plan pour le client",n}finally{this.loading=!1}},startAutoSave(){this.autoSaveInterval||(this.autoSaveInterval=setInterval(async()=>{this.unsavedChanges&&this.currentPlan&&await this.savePlan(this.currentPlan.id)},3e4))},stopAutoSave(){this.autoSaveInterval&&(clearInterval(this.autoSaveInterval),this.autoSaveInterval=null)},async savePlan(e){var t,n;if(this.unsavedChanges){this.loading=!0;try{const r=await Kr.patch(`/plans/${e}/`,{...this.currentPlan,version:((t=this.currentPlan)==null?void 0:t.version)||1}),i=this.plans.findIndex(l=>l.id===e);return i!==-1&&(this.plans[i]=r.data),((n=this.currentPlan)==null?void 0:n.id)===e&&(this.currentPlan=r.data),this.unsavedChanges=!1,r.data}catch(r){throw console.error("[IrrigationStore][savePlan] ERREUR:",r),this.error="Erreur lors de la sauvegarde du plan",r}finally{this.loading=!1}}},async updatePlanDetails(e,t){const n=Lh();try{const{visiteur_id:r,salarie_id:i,entreprise_id:l,...a}=t,o={...a};r!==void 0&&(o.visiteur_id=r),i!==void 0&&(o.salarie_id=i),l!==void 0&&(o.entreprise_id=l);const f=await Kr.patch(`/plans/${e}/`,o);this.currentPlan&&this.currentPlan.id===e&&(this.currentPlan={...this.currentPlan,...f.data});const m=this.plans.findIndex(_=>_.id===e);return m!==-1&&(this.plans[m]={...this.plans[m],...f.data}),f.data}catch(r){throw console.error("Erreur lors de la mise à jour du plan:",r),n.error(`Erreur lors de la mise à jour du plan : ${r instanceof Error?r.message:String(r)}`),r}},async fetchPlanHistory(e){this.loading=!0;try{const t=await Kr.get(`/plans/${e}/historique/`);return this.planHistory=t.data,t.data}catch(t){throw this.error="Erreur lors de la récupération de l'historique",t}finally{this.loading=!1}},async restorePlanVersion(e,t){var n;this.loading=!0;try{const r=await Kr.post(`/plans/${e}/restaurer/`,{version_id:t});((n=this.currentPlan)==null?void 0:n.id)===e&&(this.currentPlan=r.data);const i=this.plans.findIndex(l=>l.id===e);return i!==-1&&(this.plans[i]=r.data),r.data}catch(r){throw this.error="Erreur lors de la restauration de la version",r}finally{this.loading=!1}},setCurrentPlan(e){this.currentPlan=e,this.startAutoSave()},clearCurrentPlan(){this.currentPlan=null,this.unsavedChanges=!1,this.autoSaveInterval&&(clearInterval(this.autoSaveInterval),this.autoSaveInterval=null)},markUnsavedChanges(){this.unsavedChanges=!0},async deletePlan(e){var n;this.loading=!0;const t=Lh();try{const r=this.plans.find(i=>i.id===e);await vb.deletePlan(e),this.plans=this.plans.filter(i=>i.id!==e),((n=this.currentPlan)==null?void 0:n.id)===e&&this.clearCurrentPlan(),t.success(`Le plan "${(r==null?void 0:r.nom)||""}" a été supprimé avec succès`)}catch(r){throw this.error="Erreur lors de la suppression du plan",t.error(`Erreur lors de la suppression du plan : ${r instanceof Error?r.message:String(r)}`),r}finally{this.loading=!1}}}}),dj={class:"hidden md:hidden flex-mobile items-center justify-between p-4 border-b border-gray-200"},fj={class:"flex-1 flex flex-col overflow-hidden"},pj={class:"border-b border-gray-200"},mj={class:"flex -mb-px"},gj={class:"flex-1 overflow-hidden flex flex-col"},yj={key:0,class:"tab-content"},vj={class:"grid grid-cols-3 gap-1.5 mb-4"},_j=["onClick","title"],bj=["innerHTML"],xj={key:0,class:"grid grid-cols-2 gap-2 mt-2 mb-2"},wj={key:2,class:"my-4 border-t border-gray-200"},Cj={key:3,class:"mt-4"},Sj={key:0,class:"mb-4"},Lj={class:"mb-4"},Pj=["value"],Ej={class:"mb-4"},Mj=["value"],Tj={class:"grid grid-cols-1 gap-4"},Aj={key:0,class:"space-y-1"},kj={class:"flex justify-between items-center"},Ij={class:"text-sm font-medium text-gray-500"},Dj={class:"flex justify-between items-center"},Oj={class:"text-sm font-medium text-gray-500"},Rj={class:"text-sm font-medium text-gray-500"},Bj={key:1,class:"tab-content"},Nj={class:"grid grid-cols-6 gap-2 mb-4"},Fj=["onClick","title"],zj={class:"space-y-4"},jj={class:"flex items-center gap-4"},Uj={class:"flex items-center gap-2"},Vj={class:"flex items-center gap-4"},$j=["value"],Gj={key:0,class:"flex items-center gap-4"},Hj={class:"flex items-center gap-2"},qj={key:2,class:"tab-content filters-tab"},Wj={class:"filters-content"},Zj={class:"space-y-2"},Kj=["value"],Yj={class:"space-y-2 mt-4"},Xj={class:"space-y-1"},Jj={class:"flex items-center"},Qj={class:"flex items-center"},eU={class:"flex items-center"},tU={class:"flex items-center"},nU={class:"flex items-center"},rU={class:"flex items-center"},iU={key:0,class:"flex items-center"},sU=["onUpdate:modelValue"],oU={class:"ml-2 text-sm text-gray-700"},aU={key:0,class:"mt-2 pt-2 border-t border-gray-200"},lU={class:"flex space-x-2"},uU=["disabled"],cU={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},hU={key:1,class:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},dU={class:"space-y-2 mt-4"},fU={class:"space-y-1"},pU={class:"flex items-center"},mU={class:"flex items-center"},gU={class:"flex items-center"},yU=Ja({__name:"DrawingTools",props:{show:{type:Boolean,default:!1},selectedTool:{type:String,default:""},selectedShape:{type:Object,default:null},allLayers:{type:Array,default:()=>[]},isDrawing:{type:Boolean,default:!1}},emits:["update:show","tool-selected","style-update","properties-update","delete-shape","filter-change","close-drawer"],setup(e,{emit:t}){const n=e,r=C_(),i=Mu(),l=Ai(()=>i.isAdmin),a=Ai(()=>i.isEntreprise),o=vk(),f=CC(),m=bd({name:""}),_=Rn(!1),w=Rn(["forages","clients","entrepots","livraisons","cultures","parcelles"]),M=[{type:"Polygon",label:"Polygone"},{type:"Line",label:"Ligne"},{type:"Note",label:"Note géolocalisée"}],C=De=>{switch(De){case"Polygon":return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5l16 0l0 14l-16 0l0 -14z"/></svg>';case"Line":return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 20l16 -16"/></svg>';case"Note":return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 11c1.38 0 2.5-1.12 2.5-2.5S13.38 6 12 6s-2.5 1.12-2.5 2.5S10.62 11 12 11z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z"/><ellipse cx="12" cy="22" rx="4" ry="1.5" stroke-width="2.5" fill="currentColor" fill-opacity="0.2"/></svg>';default:return""}},R=Rn("tools");mo(R,(De,Ae)=>{De==="filters"&&Ae!=="filters"&&(n.selectedShape&&wt("tool-selected",""),setTimeout(()=>{ge()},0)),Ae==="filters"&&De!=="filters"&&ge()});const z=Rn("#2b6451"),W=Rn(2),X=Rn("solid"),Y=Rn("#2b6451"),Q=Rn(.2),oe=Rn(!0),le=Rn(""),me=Rn("default"),we=Rn("visitor"),ue=["#2b6451","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899"],_e=[{value:"solid",label:"Continu"},{value:"dashed",label:"Tirets"},{value:"dotted",label:"Pointillés"}],We=Rn("company"),he=bd({accessLevels:{company:!0,employee:!1,visitor:!1},categories:{forages:!0,clients:!0,entrepots:!0,livraisons:!0,cultures:!0,parcelles:!0},shapeTypes:{Polygon:!0,Line:!0,Note:!0}}),de=De=>{We.value=De,De==="company"?(he.accessLevels.company=!0,he.accessLevels.employee=!1,he.accessLevels.visitor=!1):De==="employee"?(he.accessLevels.company=!1,he.accessLevels.employee=!0,he.accessLevels.visitor=!1):De==="visitor"&&(he.accessLevels.company=!1,he.accessLevels.employee=!1,he.accessLevels.visitor=!0),ge()},Te=De=>{n.selectedShape&&wt("tool-selected",""),de(De)},be=Ai(()=>n.selectedShape&&n.selectedShape.properties||null),ae=De=>{z.value=De,Y.value=De,ne({strokeColor:De,fillColor:De})},ne=De=>{n.selectedShape&&wt("style-update",De)},Se=()=>{n.selectedShape&&wt("properties-update",{name:le.value})},Le=()=>{n.selectedShape&&wt("properties-update",{category:me.value})},ze=()=>{n.selectedShape&&wt("properties-update",{accessLevel:we.value})},He=()=>{const De={accessLevels:{company:!0,employee:!0,visitor:!0},categories:{forages:!0,clients:!0,entrepots:!0,livraisons:!0,cultures:!0,parcelles:!0},shapeTypes:{Polygon:!0,Line:!0,Note:!0}};he.accessLevels.company=!0,he.accessLevels.employee=!0,he.accessLevels.visitor=!0,he.categories.forages=!0,he.categories.clients=!0,he.categories.entrepots=!0,he.categories.livraisons=!0,he.categories.cultures=!0,he.categories.parcelles=!0,he.shapeTypes.Polygon=!0,he.shapeTypes.Line=!0,he.shapeTypes.Note=!0,r.updateFilters(De),wt("filter-change",De)},pt=()=>{it(),He()},ge=()=>{const De={...he.accessLevels},Ae={...he.categories},Be={...he.shapeTypes},Ce={accessLevels:De,categories:Ae,shapeTypes:Be};r.updateFilters(Ce),wt("filter-change",Ce),setTimeout(()=>{window.dispatchEvent(new CustomEvent("filtersChanged",{detail:{filters:Ce}}))},0)},Ie=De=>`${Math.round(De)} m`,Ne=De=>De>=1e4?`${(De/1e4).toFixed(2)} ha`:`${Math.round(De)} m²`,Ve=De=>w.value.includes(De)?De:De.split("_").map(Ae=>Ae.charAt(0).toUpperCase()+Ae.slice(1)).join(" "),it=()=>{n.selectedShape&&wt("tool-selected","")};async function lt(){var De,Ae;if(!(!m.name||_.value)){_.value=!0;try{const Be=m.name.toLowerCase().replace(/\s+/g,"_"),Ce=f.currentPlan;let ot=null;if(Ce!=null&&Ce.entreprise_id?ot=Ce.entreprise_id:Ce!=null&&Ce.entreprise&&typeof Ce.entreprise=="object"&&"id"in Ce.entreprise?ot=Ce.entreprise.id:(De=i.user)!=null&&De.enterprise_id?ot=i.user.enterprise_id:i.isEntreprise&&((Ae=i.user)!=null&&Ae.id)&&(ot=i.user.id),!ot)return;const Dt=await o.createFilter({name:m.name,category:Be,entreprise:ot});he.categories[Be]||(he.categories[Be]=!0);const Zt={...r.filters.categories};Zt[Be]=!0,r.updateFilters({categories:Zt}),wt("filter-change",he),m.name=""}catch{}finally{_.value=!1}}}const Mt=()=>{it(),R.value="filters"},wt=t;m_(()=>{var De,Ae,Be,Ce;if(n.selectedShape){const ot=n.selectedShape.options||{};z.value=ot.color||"#2b6451",W.value=ot.weight||3,X.value=ot.dashArray?"dashed":"solid",Y.value=ot.fillColor||"#2b6451",Q.value=ot.fillOpacity||.2;const Dt=n.selectedShape.type||((De=n.selectedShape.properties)==null?void 0:De.type)||"";oe.value=Dt!=="Line",le.value=((Ae=n.selectedShape.properties)==null?void 0:Ae.name)||"",me.value=((Be=n.selectedShape.properties)==null?void 0:Be.category)||"forages",we.value=((Ce=n.selectedShape.properties)==null?void 0:Ce.accessLevel)||"visitor"}}),Rl(async()=>{const De=r.filters;he.accessLevels.company=De.accessLevels.company,he.accessLevels.employee=De.accessLevels.employee,he.accessLevels.visitor=De.accessLevels.visitor,he.categories.forages=De.categories.forages,he.categories.clients=De.categories.clients,he.categories.entrepots=De.categories.entrepots,he.categories.livraisons=De.categories.livraisons,he.categories.cultures=De.categories.cultures,he.categories.parcelles=De.categories.parcelles,he.shapeTypes.Polygon=De.shapeTypes.Polygon,he.shapeTypes.Line=De.shapeTypes.Line,he.shapeTypes.Note=De.shapeTypes.Note;try{await o.fetchFilters();const Ae=o.getUniqueCategories,Be=[];Ae.forEach(Ce=>{!w.value.includes(Ce)&&!he.categories[Ce]&&(he.categories[Ce]=!0,Be.push(Ce))}),Be.length>0&&(r.updateFilters({categories:he.categories}),wt("filter-change",he))}catch{}}),mo(he,(De,Ae)=>{const Be=Object.keys(De.accessLevels).filter(Dt=>Ae.accessLevels[Dt]!==De.accessLevels[Dt]),Ce=Object.keys(De.categories).filter(Dt=>Ae.categories[Dt]!==De.categories[Dt]),ot=Object.keys(De.shapeTypes).filter(Dt=>Ae.shapeTypes[Dt]!==De.shapeTypes[Dt]);Be.length>0||Ce.length>0||ot.length>0,R.value==="filters"&&ge()},{deep:!0});const rn=De=>{wt("tool-selected",n.selectedTool===De?"":De),window.innerWidth<768&&wt("update:show",!1)},yn=()=>{var De;if(wt("update:show",!1),n.selectedShape&&((De=n.selectedShape.properties)==null?void 0:De.type)==="Note"){const Ae=n.selectedShape.layer;Ae&&typeof Ae.editNote=="function"&&Ae.editNote()}},Pn=()=>{var De;if(wt("update:show",!1),n.selectedShape&&((De=n.selectedShape.properties)==null?void 0:De.type)==="Note"){const Ae=n.selectedShape.layer;Ae&&typeof Ae.openInGoogleMaps=="function"&&Ae.openInGoogleMaps()}};return(De,Ae)=>{var Be,Ce;return yt(),Et("div",{class:$s(["drawing-tools-panel",{open:e.show}])},[V("div",dj,[Ae[30]||(Ae[30]=V("div",{class:"flex items-center"},[V("div",{class:"w-10 h-1.5 bg-gray-300 rounded-full mr-3"}),V("h3",{class:"text-sm font-semibold text-gray-700"},"Outils")],-1)),V("button",{onClick:Ae[0]||(Ae[0]=ot=>De.$emit("update:show",!1)),class:"p-1.5 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors"},Ae[29]||(Ae[29]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-700",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),V("div",fj,[V("div",pj,[V("nav",mj,[V("button",{onClick:Ae[1]||(Ae[1]=ot=>R.value="tools"),class:$s([R.value==="tools"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","flex-1 py-3 px-1 text-center border-b-2 font-medium text-sm"])},Ae[31]||(Ae[31]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mx-auto mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1),V("span",null,"Outils",-1)]),2),e.selectedShape&&((Be=e.selectedShape.properties)==null?void 0:Be.type)!=="Note"?(yt(),Et("button",{key:0,onClick:Ae[2]||(Ae[2]=ot=>R.value="style"),class:$s([R.value==="style"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","flex-1 py-3 px-1 text-center border-b-2 font-medium text-sm"])},Ae[32]||(Ae[32]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mx-auto mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})],-1),V("span",null,"Style",-1)]),2)):yr("",!0),V("button",{onClick:Mt,class:$s([R.value==="filters"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","flex-1 py-3 px-1 text-center border-b-2 font-medium text-sm"])},Ae[33]||(Ae[33]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mx-auto mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})],-1),V("span",null,"Filtres",-1)]),2)])]),V("div",gj,[R.value==="tools"?(yt(),Et("div",yj,[V("div",vj,[(yt(!0),Et($r,null,Ti(M.filter(ot=>ot.type!=="delete"),ot=>(yt(),Et("button",{key:ot.type,class:$s(["flex items-center justify-center p-2 rounded-md border transition-all duration-200",{"bg-primary-50 border-primary-500 text-primary-600":n.selectedTool===ot.type,"hover:bg-gray-50 border-gray-300 text-gray-700":n.selectedTool!==ot.type}]),onClick:Dt=>rn(ot.type),title:ot.label},[V("span",{class:"icon",innerHTML:C(ot.type)},null,8,bj)],10,_j))),128))]),e.selectedShape&&be.value&&be.value.type==="Note"?(yt(),Et("div",xj,[V("button",{class:"p-2 rounded-md border border-primary-200 bg-primary-50 text-primary-600 hover:bg-primary-100 flex items-center justify-center",onClick:yn,title:"Éditer la note"},Ae[34]||(Ae[34]=[V("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),V("span",{class:"text-sm"},"Éditer",-1)])),V("button",{class:"p-2 rounded-md border border-blue-200 bg-blue-50 text-blue-600 hover:bg-blue-100 flex items-center justify-center",onClick:Pn,title:"Obtenir l'itinéraire"},Ae[35]||(Ae[35]=[V("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})],-1),V("span",{class:"text-sm"},"Itinéraire",-1)]))])):yr("",!0),e.selectedShape?(yt(),Et("button",{key:1,class:$s(["w-full mt-2 p-2 rounded-md border border-red-200 bg-red-50 text-red-600 hover:bg-red-100 flex items-center justify-center",{"bg-red-100":n.selectedTool==="delete"}]),onClick:Ae[3]||(Ae[3]=ot=>De.$emit("delete-shape")),title:"Supprimer la forme"},Ae[36]||(Ae[36]=[V("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),V("span",{class:"text-sm"},"Supprimer",-1)]),2)):yr("",!0),e.selectedShape&&be.value?(yt(),Et("div",wj)):yr("",!0),e.selectedShape&&be.value?(yt(),Et("div",Cj,[be.value.type!=="Note"?(yt(),Et("div",Sj,[Ae[37]||(Ae[37]=V("label",{for:"shapeName",class:"block text-sm font-medium text-gray-700 mb-1"},"Nom de la forme",-1)),li(V("input",{type:"text",id:"shapeName","onUpdate:modelValue":Ae[4]||(Ae[4]=ot=>le.value=ot),onChange:Se,placeholder:"Donnez un nom à cette forme",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"},null,544),[[to,le.value]])])):yr("",!0),V("div",Lj,[Ae[40]||(Ae[40]=V("label",{for:"shapeCategory",class:"block text-sm font-medium text-gray-700 mb-1"},"Catégorie",-1)),li(V("select",{id:"shapeCategory","onUpdate:modelValue":Ae[5]||(Ae[5]=ot=>me.value=ot),onChange:Le,class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"},[Ae[38]||(Ae[38]=vd('<option value="forages" data-v-2052e3a2>Forages</option><option value="clients" data-v-2052e3a2>Clients</option><option value="entrepots" data-v-2052e3a2>Entrepôts</option><option value="livraisons" data-v-2052e3a2>Lieux de livraison</option><option value="cultures" data-v-2052e3a2>Cultures</option><option value="parcelles" data-v-2052e3a2>Noms des parcelles</option>',6)),(yt(!0),Et($r,null,Ti(he.categories,(ot,Dt)=>(yt(),Et($r,{key:Dt},[w.value.includes(String(Dt))?yr("",!0):(yt(),Et("option",{key:0,value:String(Dt)},er(Ve(String(Dt))),9,Pj))],64))),128)),Ae[39]||(Ae[39]=V("option",{value:"default"},"Autre",-1))],544),[[Ka,me.value]])]),V("div",Ej,[Ae[41]||(Ae[41]=V("label",{for:"accessLevel",class:"block text-sm font-medium text-gray-700 mb-1"},"Niveau d'accès",-1)),Ae[42]||(Ae[42]=V("div",{class:"p-2 bg-blue-50 rounded mb-2 text-xs text-blue-700"}," Définit qui peut voir cet élément sur la carte. ",-1)),li(V("select",{id:"accessLevel","onUpdate:modelValue":Ae[6]||(Ae[6]=ot=>we.value=ot),onChange:ze,class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"},[(yt(!0),Et($r,null,Ti(Tr(Gx),ot=>(yt(),Et("option",{key:ot.id,value:ot.id},er(ot.title)+" - "+er(ot.description),9,Mj))),128))],544),[[Ka,we.value]])]),V("div",Tj,[be.value.type==="Polygon"?(yt(),Et("div",Aj,[V("div",kj,[Ae[43]||(Ae[43]=V("span",{class:"text-sm font-semibold text-gray-700"},"Surface :",-1)),V("span",Ij,er(Ne(be.value.surface||0)),1)]),V("div",Dj,[Ae[44]||(Ae[44]=V("span",{class:"text-sm font-semibold text-gray-700"},"Périmètre :",-1)),V("span",Oj,er(Ie(be.value.perimeter||0)),1)])])):be.value.type==="Line"?(yt(),Et($r,{key:1},[Ae[45]||(Ae[45]=V("span",{class:"text-sm font-semibold text-gray-700"},"Longueur :",-1)),V("span",Rj,er(Ie(be.value.length||0)),1)],64)):yr("",!0)])])):yr("",!0)])):yr("",!0),R.value==="style"&&e.selectedShape&&((Ce=e.selectedShape.properties)==null?void 0:Ce.type)!=="Note"?(yt(),Et("div",Bj,[V("div",Nj,[(yt(),Et($r,null,Ti(ue,ot=>V("button",{key:ot,class:"w-8 h-8 rounded-full",style:Zh({backgroundColor:ot}),onClick:Dt=>ae(ot),title:ot},null,12,Fj)),64))]),V("div",zj,[V("div",jj,[Ae[46]||(Ae[46]=V("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Contour",-1)),V("div",Uj,[li(V("input",{type:"color","onUpdate:modelValue":Ae[7]||(Ae[7]=ot=>z.value=ot),class:"w-16 h-8 rounded border",onChange:Ae[8]||(Ae[8]=ot=>ne({strokeColor:z.value})),title:"Couleur du contour"},null,544),[[to,z.value]]),li(V("input",{type:"range","onUpdate:modelValue":Ae[9]||(Ae[9]=ot=>W.value=ot),min:"1",max:"10",class:"w-16 h-2 rounded-md",onChange:Ae[10]||(Ae[10]=ot=>ne({strokeWidth:W.value})),title:"Épaisseur du contour"},null,544),[[to,W.value]])])]),V("div",Vj,[Ae[47]||(Ae[47]=V("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Style",-1)),li(V("select",{"onUpdate:modelValue":Ae[11]||(Ae[11]=ot=>X.value=ot),class:"w-full rounded border",onChange:Ae[12]||(Ae[12]=ot=>ne({strokeStyle:X.value}))},[(yt(),Et($r,null,Ti(_e,ot=>V("option",{key:ot.value,value:ot.value},er(ot.label),9,$j)),64))],544),[[Ka,X.value]])]),oe.value?(yt(),Et("div",Gj,[Ae[48]||(Ae[48]=V("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Remplir",-1)),V("div",Hj,[li(V("input",{type:"color","onUpdate:modelValue":Ae[13]||(Ae[13]=ot=>Y.value=ot),class:"w-16 h-8 rounded border",onChange:Ae[14]||(Ae[14]=ot=>ne({fillColor:Y.value})),title:"Couleur de remplissage"},null,544),[[to,Y.value]]),li(V("input",{type:"range","onUpdate:modelValue":Ae[15]||(Ae[15]=ot=>Q.value=ot),min:"0",max:"1",step:"0.1",class:"w-16 h-2 rounded-md",onChange:Ae[16]||(Ae[16]=ot=>ne({fillOpacity:Q.value})),title:"Opacité du remplissage"},null,544),[[to,Q.value]])])])):yr("",!0)])])):yr("",!0),R.value==="filters"?(yt(),Et("div",qj,[V("div",Wj,[V("div",Zj,[Ae[50]||(Ae[50]=V("h4",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wider"},"Niveau d'accès",-1)),Ae[51]||(Ae[51]=V("div",{class:"p-2 bg-blue-50 rounded mb-2 text-xs text-blue-700"}," Sélectionnez votre niveau d'accès pour filtrer les éléments visibles sur la carte. ",-1)),V("div",null,[li(V("select",{"onUpdate:modelValue":Ae[17]||(Ae[17]=ot=>We.value=ot),onChange:Ae[18]||(Ae[18]=ot=>Te(We.value)),class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 text-sm"},[(yt(!0),Et($r,null,Ti(Tr(Gx).filter(ot=>ot.id!==Tr(Bs).PRIVATE),ot=>(yt(),Et("option",{key:ot.id,value:ot.id},er(ot.title)+" ("+er(ot.description)+") ",9,Kj))),128))],544),[[Ka,We.value]]),Ae[49]||(Ae[49]=V("div",{class:"mt-2 text-xs text-gray-500"},[V("p",null,[V("strong",null,"Entreprise"),rs(" : Vous verrez tous les éléments (entreprise, salariés, visiteurs)")]),V("p",null,[V("strong",null,"Salariés"),rs(" : Vous verrez les éléments pour salariés et visiteurs")]),V("p",null,[V("strong",null,"Visiteurs"),rs(" : Vous ne verrez que les éléments pour visiteurs")])],-1))])]),V("div",Yj,[Ae[60]||(Ae[60]=V("h4",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wider"},"Catégories",-1)),V("div",Xj,[V("label",Jj,[li(V("input",{type:"checkbox","onUpdate:modelValue":Ae[19]||(Ae[19]=ot=>he.categories.forages=ot),onChange:it,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[jh,he.categories.forages]]),Ae[52]||(Ae[52]=V("span",{class:"ml-2 text-sm text-gray-700"},"Forages",-1))]),V("label",Qj,[li(V("input",{type:"checkbox","onUpdate:modelValue":Ae[20]||(Ae[20]=ot=>he.categories.clients=ot),onChange:it,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[jh,he.categories.clients]]),Ae[53]||(Ae[53]=V("span",{class:"ml-2 text-sm text-gray-700"},"Clients",-1))]),V("label",eU,[li(V("input",{type:"checkbox","onUpdate:modelValue":Ae[21]||(Ae[21]=ot=>he.categories.entrepots=ot),onChange:it,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[jh,he.categories.entrepots]]),Ae[54]||(Ae[54]=V("span",{class:"ml-2 text-sm text-gray-700"},"Entrepôts",-1))]),V("label",tU,[li(V("input",{type:"checkbox","onUpdate:modelValue":Ae[22]||(Ae[22]=ot=>he.categories.livraisons=ot),onChange:it,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[jh,he.categories.livraisons]]),Ae[55]||(Ae[55]=V("span",{class:"ml-2 text-sm text-gray-700"},"Lieux de livraison",-1))]),V("label",nU,[li(V("input",{type:"checkbox","onUpdate:modelValue":Ae[23]||(Ae[23]=ot=>he.categories.cultures=ot),onChange:it,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[jh,he.categories.cultures]]),Ae[56]||(Ae[56]=V("span",{class:"ml-2 text-sm text-gray-700"},"Cultures",-1))]),V("label",rU,[li(V("input",{type:"checkbox","onUpdate:modelValue":Ae[24]||(Ae[24]=ot=>he.categories.parcelles=ot),onChange:it,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[jh,he.categories.parcelles]]),Ae[57]||(Ae[57]=V("span",{class:"ml-2 text-sm text-gray-700"},"Noms des parcelles",-1))]),(yt(!0),Et($r,null,Ti(he.categories,(ot,Dt)=>(yt(),Et($r,{key:Dt},[w.value.includes(String(Dt))?yr("",!0):(yt(),Et("label",iU,[li(V("input",{type:"checkbox","onUpdate:modelValue":Zt=>he.categories[Dt]=Zt,onChange:it,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,40,sU),[[jh,he.categories[Dt]]]),V("span",oU,er(Dt),1)]))],64))),128)),l.value||a.value?(yt(),Et("div",aU,[V("div",lU,[li(V("input",{type:"text","onUpdate:modelValue":Ae[25]||(Ae[25]=ot=>m.name=ot),placeholder:"Nouveau filtre...",class:"flex-1 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-primary-500 focus:border-primary-500"},null,512),[[to,m.name]]),V("button",{onClick:lt,disabled:!m.name||_.value,class:"px-2 py-1 bg-primary-600 text-white text-sm rounded hover:bg-primary-700 transition-colors flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed"},[_.value?(yt(),Et("svg",hU,Ae[59]||(Ae[59]=[V("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),V("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(yt(),Et("svg",cU,Ae[58]||(Ae[58]=[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"},null,-1)])))],8,uU)])])):yr("",!0)])]),V("div",dU,[Ae[64]||(Ae[64]=V("h4",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wider"},"Types de formes",-1)),V("div",fU,[V("label",pU,[li(V("input",{type:"checkbox","onUpdate:modelValue":Ae[26]||(Ae[26]=ot=>he.shapeTypes.Polygon=ot),onChange:it,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[jh,he.shapeTypes.Polygon]]),Ae[61]||(Ae[61]=V("span",{class:"ml-2 text-sm text-gray-700"},"Polygones",-1))]),V("label",mU,[li(V("input",{type:"checkbox","onUpdate:modelValue":Ae[27]||(Ae[27]=ot=>he.shapeTypes.Line=ot),onChange:it,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[jh,he.shapeTypes.Line]]),Ae[62]||(Ae[62]=V("span",{class:"ml-2 text-sm text-gray-700"},"Lignes",-1))]),V("label",gU,[li(V("input",{type:"checkbox","onUpdate:modelValue":Ae[28]||(Ae[28]=ot=>he.shapeTypes.Note=ot),onChange:it,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[jh,he.shapeTypes.Note]]),Ae[63]||(Ae[63]=V("span",{class:"ml-2 text-sm text-gray-700"},"Notes",-1))])])]),V("div",{class:"pt-4 mb-4"},[V("button",{onClick:pt,class:"w-full px-3 py-2 bg-gray-100 text-gray-700 text-sm rounded hover:bg-gray-200 transition-colors"}," Réinitialiser ")])])])):yr("",!0)])])],2)}}}),nP=Vf(yU,[["__scopeId","data-v-2052e3a2"]]),vU={class:"map-toolbar w-full"},_U={class:"hidden md:flex items-center space-x-2"},bU={class:"dropdown"},xU={class:"dropdown-menu"},wU=["onClick"],CU={key:0,class:"border-l pl-2 flex-1"},SU={class:"flex items-center"},LU={class:"plan-info"},PU={class:"plan-name"},EU={key:0,class:"plan-description"},MU={class:"border-l pl-2 ml-auto"},TU={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},AU={key:1,class:"h-4 w-4 mr-2 text-primary-600",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},kU={key:"saving"},IU={key:"success",class:"save-success-text"},DU={key:"default"},OU={class:"md:hidden"},RU={class:"flex justify-between items-center"},BU={key:0,class:"truncate mx-2 text-sm font-medium"},NU={key:0,class:"mobile-menu mt-0 bg-white shadow-lg p-4 z-[1900] fixed left-0 right-0 w-full"},FU={class:"flex justify-between items-center mb-3 border-b pb-2"},zU={class:"flex flex-col space-y-4"},jU={key:0,class:"flex flex-col pb-3 border-b"},UU={class:"text-sm font-semibold text-gray-800"},VU={key:0,class:"text-xs text-gray-600 mt-1"},$U={class:"flex flex-col"},GU={class:"grid grid-cols-3 gap-2"},HU=["onClick"],qU={class:"flex flex-col"},WU={class:"grid grid-cols-2 gap-2"},ZU={key:0,class:"animate-spin h-4 w-4 mr-2 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},KU={key:1,class:"h-4 w-4 mr-2 text-primary-600",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},YU={key:"saving"},XU={key:"success",class:"save-success-text"},JU={key:"default"},QU=Ja({__name:"MapToolbar",props:{lastSave:{},planName:{},planDescription:{},saveStatus:{}},emits:["change-map-type","create-new-plan","load-plan","save-plan","adjust-view","toggle-edit-mode"],setup(e,{emit:t}){const n=e,r=t,{lastSave:i,planName:l,planDescription:a,saveStatus:o}=tC(n),f=Rn("Hybride"),m=Rn(!1),_=Rn(!1),w=oe=>{const le=oe.currentTarget,me=le.nextElementSibling;if(me&&me.classList.contains("dropdown-menu")){const we=le.getBoundingClientRect();me.style.top=`${we.bottom}px`,me.style.left=`${we.left}px`}},M={Hybride:"Hybride",Cadastre:"Cadastre",IGN:"IGN"},C=Ai(()=>i.value?new Date(i.value).toLocaleString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Jamais"),R=oe=>{f.value=oe,r("change-map-type",oe),m.value=!1},z=()=>{r("create-new-plan"),m.value=!1},W=()=>{r("load-plan"),m.value=!1},X=()=>{r("save-plan"),m.value=!1},Y=()=>{r("adjust-view"),m.value=!1},Q=()=>{_.value=!_.value,r("toggle-edit-mode",_.value),m.value=!1};return Rl(()=>{const oe=setInterval(()=>{window.dispatchEvent(new CustomEvent("geonote:savePlan"))},6e4);gd(()=>{clearInterval(oe)})}),mo(o,oe=>{oe==="saving"&&window.dispatchEvent(new CustomEvent("geonote:savePlan"))}),(oe,le)=>(yt(),Et("div",vU,[V("div",_U,[V("div",bU,[V("button",{class:"btn-toolbar dropdown-toggle",onMouseover:w},[le[2]||(le[2]=V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[V("path",{"fill-rule":"evenodd",d:"M12 1.586l-4 4V17h8V5.586l-4-4zM2 17V9.276l4-3.638V17H2zM2 8.162V3h4.5L12 8.5V17H6V5.638L2 8.162z","clip-rule":"evenodd"})],-1)),V("span",null,er(M[f.value]),1)],32),V("div",xU,[(yt(),Et($r,null,Ti(M,(me,we)=>V("button",{key:we,class:$s(["dropdown-item",{active:we===f.value}]),onClick:ue=>R(we)},er(me),11,wU)),64))])]),Tr(l)?(yt(),Et("div",CU,[V("div",SU,[V("div",LU,[V("h2",PU,er(Tr(l)),1),Tr(a)?(yt(),Et("p",EU,er(Tr(a)),1)):yr("",!0)])])])):yr("",!0),V("div",{class:"border-l pl-2"},[V("div",{class:"flex items-center space-x-1"},[V("button",{onClick:z,class:"btn-toolbar",title:"Nouveau plan"},le[3]||(le[3]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[V("path",{"fill-rule":"evenodd",d:"M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V8z","clip-rule":"evenodd"})],-1),V("span",{class:"hidden lg:inline ml-1"},"Nouveau",-1)])),V("button",{onClick:W,class:"btn-toolbar",title:"Charger un plan"},le[4]||(le[4]=[vd('<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" data-v-b86356dc><path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" data-v-b86356dc></path><path d="M10 9a1 1 0 011-1h5a1 1 0 110 2h-5a1 1 0 01-1-1z" data-v-b86356dc></path><path fill-rule="evenodd" d="M13 5a1 1 0 011 1v4a1 1 0 11-2 0V6a1 1 0 011-1z" clip-rule="evenodd" data-v-b86356dc></path></svg><span class="hidden lg:inline ml-1" data-v-b86356dc>Charger</span>',2)])),V("button",{onClick:X,class:"btn-toolbar",title:"Enregistrer le plan"},le[5]||(le[5]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[V("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6h5a2 2 0 012 2v7a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2h5v5.586l-1.293-1.293zM9 4a1 1 0 012 0v2H9V4z"})],-1),V("span",{class:"hidden lg:inline ml-1"},"Enregistrer",-1)]))])]),V("div",{class:"border-l pl-2"},[V("div",{class:"flex items-center space-x-1"},[V("button",{onClick:Y,class:"btn-toolbar",title:"Ajuster la vue"},le[6]||(le[6]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[V("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1),V("span",{class:"hidden lg:inline ml-1"},"Ajuster",-1)]))])]),V("div",MU,[V("div",{class:$s(["text-xs hidden lg:flex items-center",{"text-gray-500":!Tr(o),"text-primary-600 font-medium":Tr(o)==="success","text-blue-600 font-medium":Tr(o)==="saving"}])},[Tr(o)==="saving"?(yt(),Et("svg",TU,le[7]||(le[7]=[V("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),V("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):yr("",!0),Tr(o)==="success"?(yt(),Et("svg",AU,le[8]||(le[8]=[V("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):yr("",!0),Ns(N4,{name:"fade-slide",mode:"out-in"},{default:Hh(()=>[Tr(o)==="saving"?(yt(),Et("span",kU," Sauvegarde en cours... ")):Tr(o)==="success"?(yt(),Et("span",IU," Sauvegarde réussie ! ")):(yt(),Et("span",DU," Dernière modification : "+er(C.value),1))]),_:1})],2)])]),V("div",OU,[V("div",RU,[V("button",{onClick:le[0]||(le[0]=me=>m.value=!m.value),class:"p-2 rounded-md border bg-white shadow-sm"},le[9]||(le[9]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-600",viewBox:"0 0 20 20",fill:"currentColor"},[V("path",{"fill-rule":"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z","clip-rule":"evenodd"})],-1)])),Tr(l)?(yt(),Et("div",BU,er(Tr(l)),1)):yr("",!0),V("div",{class:"flex space-x-2"},[V("button",{onClick:z,class:"p-2 rounded-md border bg-white shadow-sm flex items-center justify-center"},le[10]||(le[10]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-600",viewBox:"0 0 20 20",fill:"currentColor"},[V("path",{"fill-rule":"evenodd",d:"M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V8z","clip-rule":"evenodd"})],-1)])),V("button",{onClick:X,class:"p-2 rounded-md border bg-white shadow-sm flex items-center justify-center"},le[11]||(le[11]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-600",viewBox:"0 0 20 20",fill:"currentColor"},[V("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6h5a2 2 0 012 2v7a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2h5v5.586l-1.293-1.293zM9 4a1 1 0 012 0v2H9V4z"})],-1)])),V("button",{onClick:Y,class:"p-2 rounded-md border bg-white shadow-sm flex items-center justify-center"},le[12]||(le[12]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-600",viewBox:"0 0 20 20",fill:"currentColor"},[V("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1)]))])]),m.value?(yt(),Et("div",NU,[V("div",FU,[le[14]||(le[14]=V("h3",{class:"text-base font-semibold text-gray-800"},"Menu",-1)),V("button",{onClick:le[1]||(le[1]=me=>m.value=!1),class:"p-1 rounded-full hover:bg-gray-100"},le[13]||(le[13]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),V("div",zU,[Tr(l)?(yt(),Et("div",jU,[V("h3",UU,er(Tr(l)),1),Tr(a)?(yt(),Et("p",VU,er(Tr(a)),1)):yr("",!0)])):yr("",!0),V("div",$U,[le[15]||(le[15]=V("span",{class:"text-sm font-medium text-gray-700 mb-2"},"Type de carte",-1)),V("div",GU,[(yt(),Et($r,null,Ti(M,(me,we)=>V("button",{key:we,class:$s(["px-3 py-2 text-sm rounded-md border shadow-sm",{"bg-blue-50 border-blue-300 text-blue-700 font-medium":we===f.value}]),onClick:ue=>R(we)},er(me),11,HU)),64))])]),V("div",qU,[le[20]||(le[20]=V("span",{class:"text-sm font-medium text-gray-700 mb-2"},"Outils de plan",-1)),V("div",WU,[V("button",{onClick:z,class:"px-3 py-2 text-sm rounded-md border shadow-sm flex items-center justify-center bg-white"},le[16]||(le[16]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[V("path",{"fill-rule":"evenodd",d:"M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V8z","clip-rule":"evenodd"})],-1),rs(" Nouveau ")])),V("button",{onClick:W,class:"px-3 py-2 text-sm rounded-md border shadow-sm flex items-center justify-center bg-white"},le[17]||(le[17]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[V("path",{"fill-rule":"evenodd",d:"M2 6a2 2 0 012-2h4a2 2 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z","clip-rule":"evenodd"}),V("path",{d:"M10 9a1 1 0 011-1h5a1 1 0 110 2h-5a1 1 0 01-1-1z"}),V("path",{"fill-rule":"evenodd",d:"M13 5a1 1 0 011 1v4a1 1 0 11-2 0V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),rs(" Charger ")])),V("button",{onClick:Q,class:$s(["px-3 py-2 text-sm rounded-md border shadow-sm flex items-center justify-center",{"bg-blue-50 border-blue-300 text-blue-700":_.value,"bg-white":!_.value}])},[(yt(),Et("svg",{xmlns:"http://www.w3.org/2000/svg",class:$s(["h-4 w-4 mr-2",{"text-blue-600":_.value}]),viewBox:"0 0 20 20",fill:"currentColor"},le[18]||(le[18]=[V("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"},null,-1)]),2)),le[19]||(le[19]=rs(" Mode édition "))],2)])]),V("div",{class:$s(["text-sm text-center pt-3 border-t flex items-center justify-center space-x-1 mt-2",{"text-gray-500":!Tr(o),"text-primary-600 font-medium":Tr(o)==="success","text-blue-600 font-medium":Tr(o)==="saving"}])},[Tr(o)==="saving"?(yt(),Et("svg",ZU,le[21]||(le[21]=[V("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),V("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):yr("",!0),Tr(o)==="success"?(yt(),Et("svg",KU,le[22]||(le[22]=[V("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):yr("",!0),Ns(N4,{name:"fade-slide",mode:"out-in"},{default:Hh(()=>[Tr(o)==="saving"?(yt(),Et("span",YU," Sauvegarde en cours... ")):Tr(o)==="success"?(yt(),Et("span",XU," Sauvegarde réussie ! ")):(yt(),Et("span",JU," Dernière modification : "+er(C.value),1))]),_:1})],2)])])):yr("",!0)])]))}}),eV=Vf(QU,[["__scopeId","data-v-b86356dc"]]);function cg(e,t={day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"},n="Date non définie"){if(!e)return n;try{const r=new Date(e);return isNaN(r.getTime())?(console.warn("[formatDate] Date invalide:",e),"Date invalide"):new Intl.DateTimeFormat("fr-FR",t).format(r)}catch(r){return console.error("[formatDate] Erreur lors du formatage de la date:",r),"Date invalide"}}function tV(e){if(!e)return null;try{const t=new Date(e);return isNaN(t.getTime())?(console.warn("[parseDate] Date invalide:",e),null):t}catch(t){return console.error("[parseDate] Erreur lors de la création de la date:",t),null}}const nV={class:"comment-thread"},rV={key:0,class:"space-y-3 mb-4"},iV={class:"flex justify-between items-start"},sV={class:"flex items-center"},oV={class:"font-medium text-sm text-gray-900"},aV={class:"flex items-center"},lV={class:"text-xs text-gray-500"},uV=["onClick"],cV={class:"mt-1 text-sm text-gray-700 whitespace-pre-wrap"},hV={key:1,class:"text-center text-sm text-gray-500 italic my-4"},dV={key:2,class:"mt-3"},fV={class:"flex justify-end mt-2"},pV=["disabled"],mV={key:3,class:"text-center text-sm text-gray-500 italic mt-2"},gV=Ja({__name:"CommentThread",props:{noteId:{},comments:{}},emits:["update:comments","comment-added","comment-deleted"],setup(e,{emit:t}){const n=e;mo(()=>n.comments,R=>{},{deep:!0});const r=t,i=Mu(),l=yp(),a=Lh(),o=Rn(""),f=Ai(()=>i.isEntreprise||i.isAdmin);function m(R){return i.user&&R.userId===i.user.id||i.isAdmin}async function _(){var R;if(o.value.trim())try{await l.addComment(n.noteId,o.value.trim()),o.value="",a.success("Commentaire ajouté avec succès"),r("comment-added")}catch(z){if(console.error("Erreur lors de l'ajout du commentaire:",z),(R=z.response)!=null&&R.data){const W=z.response.data;W.note?a.error(`Erreur: ${W.note[0]}`):W.user?a.error(`Erreur: ${W.user[0]}`):W.text?a.error(`Erreur: ${W.text[0]}`):a.error("Erreur lors de l'ajout du commentaire")}else a.error("Erreur lors de l'ajout du commentaire")}}async function w(R){var z;if(confirm("Voulez-vous vraiment supprimer ce commentaire ?"))try{await l.removeComment(n.noteId,R),a.success("Commentaire supprimé"),r("comment-deleted")}catch(W){if(console.error("Erreur lors de la suppression du commentaire:",W),(z=W.response)!=null&&z.data){const X=W.response.data;X.detail?a.error(`Erreur: ${X.detail}`):a.error("Erreur lors de la suppression du commentaire")}else a.error("Erreur lors de la suppression du commentaire")}}function M(R){switch(R){case"admin":return"bg-purple-100 text-purple-800";case"entreprise":return"bg-blue-100 text-blue-800";case"salarie":return"bg-green-100 text-green-800";case"visiteur":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}}function C(R){switch(R){case"admin":return"Admin";case"entreprise":return"Entreprise";case"salarie":return"Salarié";case"visiteur":return"Visiteur";default:return R}}return(R,z)=>(yt(),Et("div",nV,[R.comments&&R.comments.length>0?(yt(),Et("div",rV,[(yt(!0),Et($r,null,Ti(R.comments,W=>(yt(),Et("div",{key:W.id,class:"bg-gray-50 rounded-lg p-3"},[V("div",iV,[V("div",sV,[V("div",oV,er(W.userName),1),V("span",{class:$s(["ml-2 text-xs px-2 py-0.5 rounded-full",M(W.userRole)])},er(C(W.userRole)),3)]),V("div",aV,[V("span",lV,er(Tr(cg)(W.createdAt)),1),m(W)?(yt(),Et("button",{key:0,onClick:Wh(X=>w(W.id),["prevent"]),class:"ml-2 text-gray-400 hover:text-red-500"},z[1]||(z[1]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,uV)):yr("",!0)])]),V("p",cV,er(W.text),1)]))),128))])):(yt(),Et("div",hV," Aucun commentaire pour le moment ")),f.value?(yt(),Et("div",dV,[li(V("textarea",{"onUpdate:modelValue":z[0]||(z[0]=W=>o.value=W),placeholder:"Ajouter un commentaire...",class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:"2"},null,512),[[to,o.value]]),V("div",fV,[V("button",{type:"button",onClick:Wh(_,["prevent"]),disabled:!o.value.trim(),class:"px-3 py-1 text-sm font-medium text-white bg-primary-600 rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed"}," Ajouter ",8,pV)])])):(yt(),Et("div",mV," Seuls les utilisateurs de l'entreprise peuvent ajouter des commentaires "))]))}}),yV={class:"photo-gallery"},vV={key:0,class:"grid grid-cols-2 gap-2 mb-4"},_V=["src","onClick"],bV={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-all duration-200 rounded-lg flex items-center justify-center"},xV={class:"opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex space-x-2"},wV=["onClick"],CV={key:1,class:"text-center text-sm text-gray-500 italic my-4"},SV={class:"flex space-x-2 mt-3"},LV={key:2,class:"mt-4 border border-gray-300 rounded-lg overflow-hidden bg-white"},PV={class:"relative bg-gray-900",style:{height:"300px"}},EV=["src"],MV={class:"p-3 bg-gray-50 border-t border-gray-300 flex justify-center"},TV={key:1,class:"flex space-x-3"},AV={key:3,class:"fixed inset-0 z-[3002] flex items-center justify-center p-4 bg-black bg-opacity-75"},kV={class:"relative max-w-3xl max-h-[90vh] bg-white rounded-lg overflow-hidden"},IV=["src"],DV=Ja({__name:"PhotoGallery",props:{noteId:{},photos:{}},emits:["update:photos","photo-added","photo-deleted"],setup(e,{emit:t}){const n=e,r=t,i=yp(),l=Lh(),a=Rn(null),o=Rn(null),f=Rn(null);let m=null;const _=Rn(!1),w=Rn(!1),M=Rn(null),C=Rn(null);function R(we){M.value=we,_.value=!0}async function z(we){var ue;if(confirm("Êtes-vous sûr de vouloir supprimer cette photo ?"))try{await i.removePhoto(n.noteId,we),l.success("Photo supprimée"),r("photo-deleted"),_.value&&((ue=M.value)==null?void 0:ue.id)===we&&(_.value=!1,M.value=null)}catch(_e){console.error("Erreur lors de la suppression de la photo:",_e),l.error("Erreur lors de la suppression de la photo")}}function W(){f.value&&f.value.click()}async function X(we){const ue=we.target;if(!ue.files||ue.files.length===0)return;const _e=ue.files[0];if(!_e.type.startsWith("image/")){l.error("Le fichier doit être une image");return}if(_e.size>5*1024*1024){l.error("L'image est trop volumineuse (max 5MB)");return}try{const We=await Y(_e);await i.addPhoto(n.noteId,{url:We}),ue.value="",l.success("Photo ajoutée"),r("photo-added")}catch(We){console.error("Erreur lors de l'ajout de la photo:",We),l.error("Erreur lors de l'ajout de la photo")}}function Y(we){return new Promise((ue,_e)=>{const We=new FileReader;We.onload=()=>ue(We.result),We.onerror=_e,We.readAsDataURL(we)})}mo(w,async we=>{if(we){C.value=null;try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("API de caméra non supportée sur ce navigateur");const ue={video:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}};m=await navigator.mediaDevices.getUserMedia(ue),a.value&&(a.value.srcObject=m,await new Promise(_e=>{a.value.onloadedmetadata=()=>{a.value.play().then(_e)}}))}catch(ue){console.error("Erreur lors de l'accès à la caméra:",ue);let _e="Impossible d'accéder à la caméra";ue.name==="NotAllowedError"?_e="L'accès à la caméra a été refusé. Veuillez vérifier vos permissions.":ue.name==="NotFoundError"?_e="Aucune caméra n'a été trouvée sur votre appareil.":ue.name==="NotSupportedError"&&(_e="Votre navigateur ne supporte pas l'accès à la caméra."),l.error(_e),w.value=!1}}else m&&(m.getTracks().forEach(ue=>ue.stop()),m=null)});function Q(){if(!a.value||!o.value)return;const we=a.value,ue=o.value;ue.width=we.videoWidth,ue.height=we.videoHeight;const _e=ue.getContext("2d");_e&&(_e.drawImage(we,0,0,ue.width,ue.height),C.value=ue.toDataURL("image/jpeg"))}function oe(){C.value=null}async function le(){if(C.value)try{await i.addPhoto(n.noteId,{url:C.value}),w.value=!1,l.success("Photo ajoutée"),r("photo-added")}catch(we){console.error("Erreur lors de l'ajout de la photo:",we),l.error("Erreur lors de l'ajout de la photo")}}function me(){w.value=!1}return gd(()=>{m&&(m.getTracks().forEach(we=>we.stop()),m=null)}),(we,ue)=>(yt(),Et("div",yV,[we.photos&&we.photos.length>0?(yt(),Et("div",vV,[(yt(!0),Et($r,null,Ti(we.photos,_e=>(yt(),Et("div",{key:_e.id,class:"relative group"},[V("img",{src:_e.url,alt:"Photo",class:"w-full h-32 object-cover rounded-lg cursor-pointer",onClick:We=>R(_e)},null,8,_V),V("div",bV,[V("div",xV,[V("button",{onClick:Wh(We=>z(_e.id),["stop","prevent"]),class:"p-1 bg-white rounded-full text-gray-700 hover:text-red-600",title:"Supprimer la photo"},ue[2]||(ue[2]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,wV)])])]))),128))])):(yt(),Et("div",CV," Aucune photo pour le moment ")),V("div",SV,[V("button",{type:"button",onClick:ue[0]||(ue[0]=_e=>w.value=!0),class:"flex-1 flex items-center justify-center px-3 py-2 text-sm font-medium text-white bg-primary-600 rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2"},ue[3]||(ue[3]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1),rs(" Prendre une photo ")])),V("button",{type:"button",onClick:W,class:"flex-1 flex items-center justify-center px-3 py-2 text-sm font-medium text-white bg-primary-600 rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 cursor-pointer"},ue[4]||(ue[4]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0l-4 4m4-4v12"})],-1),rs(" Téléverser ")])),V("input",{id:"photo-upload",ref_key:"fileInput",ref:f,type:"file",accept:"image/*",class:"hidden",onChange:X},null,544)]),w.value?(yt(),Et("div",LV,[V("div",{class:"p-3 bg-gray-50 border-b border-gray-300 flex justify-between items-center"},[ue[6]||(ue[6]=V("h3",{class:"text-sm font-medium text-gray-700"},"Mode caméra",-1)),V("button",{type:"button",onClick:me,class:"text-gray-400 hover:text-gray-500"},ue[5]||(ue[5]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),V("div",PV,[C.value?(yt(),Et("img",{key:1,src:C.value,class:"w-full h-full object-contain",alt:"Captured"},null,8,EV)):(yt(),Et("video",{key:0,ref_key:"videoElement",ref:a,autoplay:"",class:"w-full h-full object-contain"},null,512)),V("canvas",{ref_key:"canvasElement",ref:o,class:"hidden"},null,512)]),V("div",MV,[C.value?(yt(),Et("div",TV,[V("button",{type:"button",onClick:oe,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2"}," Reprendre "),V("button",{type:"button",onClick:le,class:"px-4 py-2 text-sm font-medium text-white bg-primary-600 rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2"}," Utiliser ")])):(yt(),Et("button",{key:0,type:"button",onClick:Q,class:"px-4 py-2 text-sm font-medium text-white bg-primary-600 rounded-full w-12 h-12 flex items-center justify-center hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2"},ue[7]||(ue[7]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"})],-1)])))])])):yr("",!0),_.value?(yt(),Et("div",AV,[V("div",kV,[V("button",{type:"button",onClick:ue[1]||(ue[1]=_e=>_.value=!1),class:"absolute top-2 right-2 z-10 p-1 bg-white rounded-full text-gray-700 hover:text-red-600 shadow-md"},ue[8]||(ue[8]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),M.value?(yt(),Et("img",{key:0,src:M.value.url,alt:"Photo",class:"max-h-[80vh] max-w-full object-contain"},null,8,IV)):yr("",!0)])])):yr("",!0)]))}}),OV=Vf(DV,[["__scopeId","data-v-f87156b4"]]);function j2(e){return[e[1],e[0]]}function SC(e){return[e[1],e[0]]}function _k(e){return{type:"Point",coordinates:j2(e)}}function bk(e){if(Array.isArray(e))return e;if(typeof e=="object"&&e.type==="Point")return SC(e.coordinates);throw new Error("Format de localisation non reconnu")}function xk(e){if(Array.isArray(e))return j2(e);if(typeof e=="object"&&e.type==="Point")return e.coordinates;throw new Error("Format de localisation non reconnu")}function gg(e){if(!e)return null;if(Array.isArray(e))return e.length>=2?{lat:e[0],lng:e[1]}:null;if("lat"in e&&"lng"in e){const{lat:t,lng:n}=e;return typeof t=="number"&&typeof n=="number"?{lat:t,lng:n}:null}if("type"in e&&"coordinates"in e){const{coordinates:t}=e;return Array.isArray(t)&&t.length>=2?{lat:t[1],lng:t[0]}:null}if("coordinates"in e){const{coordinates:t}=e;return Array.isArray(t)&&t.length>=2?{lat:t[1],lng:t[0]}:null}return null}function wk(e,t){try{if(e&&typeof e.getLatLng=="function"){const n=e.getLatLng();if(n&&!isNaN(n.lat)&&!isNaN(n.lng))return{lat:n.lat,lng:n.lng}}else if(e&&e.location)return gg(e.location);return t&&t.warning("La position est invalide ou manquante"),null}catch(n){return console.error("Error extracting coordinates:",n),t&&t.warning("Erreur lors de l'extraction des coordonnées"),null}}function Ck(e){const t=gg(e);return t?{type:"Point",coordinates:[t.lng,t.lat]}:null}function Sk(e,t){const r=bb(t.lat-e.lat),i=bb(t.lng-e.lng),l=Math.sin(r/2)*Math.sin(r/2)+Math.cos(bb(e.lat))*Math.cos(bb(t.lat))*Math.sin(i/2)*Math.sin(i/2);return 6371*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))}function bb(e){return e*Math.PI/180}const RV={leafletToGeoJSON:j2,geoJSONToLeaflet:SC,createGeoJSONPoint:_k,getLeafletCoordinates:bk,getGeoJSONCoordinates:xk,extractLatLng:gg,safeGetLatLng:wk,toGeoJSONPoint:Ck,calculateDistance:Sk},BV=Object.freeze(Object.defineProperty({__proto__:null,calculateDistance:Sk,createGeoJSONPoint:_k,default:RV,extractLatLng:gg,geoJSONToLeaflet:SC,getGeoJSONCoordinates:xk,getLeafletCoordinates:bk,leafletToGeoJSON:j2,safeGetLatLng:wk,toGeoJSONPoint:Ck},Symbol.toStringTag,{value:"Module"})),NV={class:"modal-header"},FV={class:"modal-title"},zV={class:"modal-tabs"},jV={key:0,class:"badge"},UV={key:0,class:"badge"},VV={class:"modal-content"},$V={key:0,class:"tab-content"},GV={class:"form-group"},HV={class:"form-group"},qV={key:0,class:"location-indicator"},WV={class:"form-group"},ZV=["value"],KV={key:1,class:"form-group"},YV=["value"],XV={class:"form-group"},JV=["value"],QV={class:"form-group"},e$={class:"color-picker"},t$=["onClick"],n$={key:1,class:"tab-content"},r$={key:2,class:"tab-content"},i$=Ja({__name:"NoteEditModal",props:{note:{},isNewNote:{type:Boolean},location:{}},emits:["close","save"],setup(e,{emit:t}){const n=e,r=t,i=yp(),l=Lh(),a=Mu(),o=Rn("info"),f=Rn([]),m=Rn(null),_=window.console;mo(o,async Te=>{Te==="comments"&&n.note&&n.note.id&&await C(n.note.id),Te==="photos"&&n.note&&n.note.id&&await R(n.note.id)});const w=Rn({title:"",description:"",columnId:"",accessLevel:Bs.PRIVATE,style:{color:"#3B82F6",weight:2,opacity:1,fillColor:"#3B82F6",fillOpacity:.6,radius:8},comments:[],photos:[],enterprise_id:null});function M(Te){if(!Te)return new Date().toISOString();try{const be=new Date(Te);return isNaN(be.getTime())?(_.warn("[NoteEditModal] Date invalide:",Te),new Date().toISOString()):be.toISOString()}catch(be){return _.error("[NoteEditModal] Erreur lors de la création de la date:",be),new Date().toISOString()}}async function C(Te){try{const ae=(await _c.getComments(Te)).data.map(ne=>({id:ne.id,text:ne.text,createdAt:ne.created_at,userId:ne.user,userName:ne.user_name,userRole:ne.user_role}));return n.note&&(i.updateNote(n.note.id,{comments:ae}),w.value.comments=ae),ae}catch(be){return _.error("[NoteEditModal] Erreur lors du chargement des commentaires:",be),l.error("Erreur lors du chargement des commentaires"),[]}}async function R(Te){try{const ae=(await _c.getPhotos(Te)).data.map(ne=>({id:ne.id,url:ne.image,createdAt:ne.created_at,caption:ne.caption}));return n.note&&(i.updateNote(n.note.id,{photos:ae}),w.value.photos=ae),ae}catch(be){return _.error("[NoteEditModal] Erreur lors du chargement des photos:",be),l.error("Erreur lors du chargement des photos"),[]}}async function z(){if(a.isAdmin)try{const Te=await Bc.getEntreprises();f.value=Te.data}catch(Te){_.error("[NoteEditModal] Erreur lors du chargement des entreprises:",Te),l.error("Erreur lors du chargement des entreprises")}}Rl(async()=>{var Te;if(await i.loadColumns(),await z(),n.note){const be=JSON.parse(JSON.stringify(n.note));be.createdAt=M(be.createdAt),be.updatedAt=M(be.updatedAt),w.value=be,a.isAdmin&&be.enterprise_id&&(m.value=be.enterprise_id),n.note.id&&await Promise.all([C(n.note.id),R(n.note.id)])}else if(n.isNewNote){if(w.value={title:"Nouvelle note",description:"",columnId:i.getDefaultColumn.id||"1",accessLevel:Bs.PRIVATE,style:{color:"#2b6451",weight:2,opacity:1,fillColor:"#2b6451",fillOpacity:.6,radius:8},comments:[],photos:[],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),enterprise_id:null},!a.isAdmin&&((Te=a.user)!=null&&Te.enterprise_id)&&(w.value.enterprise_id=a.user.enterprise_id),n.location){const be=gg(n.location);be?w.value.location=[be.lat,be.lng]:_.error("[NoteEditModal] Format de localisation non reconnu:",n.location)}}else _.error("[NoteEditModal] Erreur: Ni note existante ni nouvelle note")});const W=Ai(()=>i.getSortedColumns),X=Ai(()=>{var be;return((be=w.value.comments)==null?void 0:be.length)||0}),Y=Ai(()=>{var be;return((be=w.value.photos)==null?void 0:be.length)||0}),Q=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#6B7280"],oe=Te=>{var be;if(w.value.style?(w.value.style.color=Te,w.value.style.fillColor=Te):w.value.style={color:Te,weight:2,opacity:1,fillColor:Te,fillOpacity:.6,radius:8},w.value.color=Te,(be=n.note)!=null&&be.id){const ae=new CustomEvent("geonote:updateStyle",{detail:{noteId:n.note.id,style:{color:Te,fillColor:Te}}});window.dispatchEvent(ae);const ne=new CustomEvent("geonote:update",{detail:{noteId:n.note.id,properties:{name:w.value.title,description:w.value.description,columnId:w.value.columnId,accessLevel:w.value.accessLevel,style:w.value.style}}});window.dispatchEvent(ne)}},le=()=>{var Te,be,ae,ne,Se,Le,ze,He,pt,ge;w.value={title:((Te=n.note)==null?void 0:Te.title)||"",description:((be=n.note)==null?void 0:be.description)||"",columnId:((ae=n.note)==null?void 0:ae.columnId)||"",accessLevel:((ne=n.note)==null?void 0:ne.accessLevel)||"private",style:((Se=n.note)==null?void 0:Se.style)||{color:"#2b6451",weight:2,opacity:1,fillColor:"#2b6451",fillOpacity:.6,radius:8},location:(()=>{var Ne;const Ie=n.location||((Ne=n.note)==null?void 0:Ne.location);if(Ie){const Ve=gg(Ie);return Ve?[Ve.lat,Ve.lng]:null}return null})(),comments:((Le=n.note)==null?void 0:Le.comments)||[],photos:((ze=n.note)==null?void 0:ze.photos)||[],enterprise_id:((He=n.note)==null?void 0:He.enterprise_id)||null},a.isAdmin&&((pt=n.note)!=null&&pt.enterprise_id)&&(m.value=n.note.enterprise_id),!a.isAdmin&&!w.value.enterprise_id&&((ge=a.user)!=null&&ge.enterprise_id)&&(w.value.enterprise_id=a.user.enterprise_id)};Rl(()=>{le()}),mo(()=>n.note,()=>{le()},{deep:!0});function me(){r("close")}async function we(){n.note&&n.note.id&&await C(n.note.id)}async function ue(){n.note&&n.note.id&&await R(n.note.id)}async function _e(){n.note&&n.note.id&&await C(n.note.id)}async function We(){n.note&&n.note.id&&await R(n.note.id)}async function he(){var Te,be;try{const ae=w.value.style.color;w.value.style={...w.value.style,color:ae,fillColor:ae,weight:2,opacity:1,fillOpacity:.6,radius:8};const ne={title:w.value.title,description:w.value.description,columnId:w.value.columnId,style:w.value.style,access_level:w.value.accessLevel,comments:w.value.comments||[],photos:w.value.photos||[],color:ae,enterprise_id:a.isAdmin?m.value:w.value.enterprise_id};if(!a.isAdmin&&((Te=a.user)!=null&&Te.enterprise_id)&&(ne.enterprise_id=a.user.enterprise_id),w.value.location){const Le=gg(w.value.location);Le&&(ne.location={type:"Point",coordinates:[Le.lng,Le.lat]})}let Se;if((be=n.note)!=null&&be.id){const Le=n.note.backendId||n.note.id;ne.backendId=n.note.backendId,Se=(await _c.updateNote(Le,ne)).data,i.updateNote(Le,{...w.value,...Se,accessLevel:w.value.accessLevel,style:w.value.style,color:ae,updatedAt:new Date().toISOString(),enterprise_id:ne.enterprise_id,enterprise_name:w.value.enterprise_name});const He=n.note.leafletId||n.note.id,pt=new CustomEvent("geonote:update",{detail:{noteId:He,properties:{name:w.value.title,description:w.value.description,columnId:w.value.columnId,accessLevel:w.value.accessLevel,style:w.value.style,color:ae}}});window.dispatchEvent(pt),l.success("Note mise à jour avec succès")}else{if(Se=(await _c.createNote(ne)).data,!Se.id)throw new Error("Le backend n'a pas fourni d'ID pour la nouvelle note");const ze=i.getDefaultColumn,He={...ne,id:Se.id,columnId:ne.columnId||ze.id,accessLevel:w.value.accessLevel,style:ne.style,color:ae};i.addNote(He),l.success("Note créée avec succès")}Se&&(!Se.comments&&w.value.comments&&(Se.comments=w.value.comments),!Se.photos&&w.value.photos&&(Se.photos=w.value.photos),Se.color=ae,Se.style={...Se.style,color:ae,fillColor:ae}),r("save",Se),r("close")}catch(ae){_.error("[NoteEditModal] Erreur lors de la sauvegarde de la note:",ae),l.error("Erreur lors de la sauvegarde de la note")}}function de(Te){Te.stopPropagation()}return(Te,be)=>{var ae;return yt(),Et("div",{class:"modal-overlay",onClick:de},[V("div",{class:"modal-container",onClick:be[8]||(be[8]=Wh(()=>{},["stop"]))},[V("form",{onSubmit:Wh(he,["prevent"]),class:"modal-form"},[V("div",NV,[V("h3",FV,er((ae=Te.note)!=null&&ae.id?"Modifier la note":"Nouvelle note"),1),V("button",{type:"button",onClick:me,class:"close-button"},be[9]||(be[9]=[V("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),V("div",zV,[V("button",{type:"button",onClick:be[0]||(be[0]=ne=>o.value="info"),class:$s(["tab-button",{active:o.value==="info"}])}," Informations ",2),V("button",{type:"button",onClick:be[1]||(be[1]=ne=>o.value="comments"),class:$s(["tab-button",{active:o.value==="comments"}])},[be[10]||(be[10]=rs(" Commentaires ")),X.value>0?(yt(),Et("span",jV,er(X.value),1)):yr("",!0)],2),V("button",{type:"button",onClick:be[2]||(be[2]=ne=>o.value="photos"),class:$s(["tab-button",{active:o.value==="photos"}])},[be[11]||(be[11]=rs(" Photos ")),Y.value>0?(yt(),Et("span",UV,er(Y.value),1)):yr("",!0)],2)]),V("div",VV,[o.value==="info"?(yt(),Et("div",$V,[V("div",GV,[be[12]||(be[12]=V("label",{for:"title"},"Titre",-1)),li(V("input",{type:"text",id:"title","onUpdate:modelValue":be[3]||(be[3]=ne=>w.value.title=ne),required:""},null,512),[[to,w.value.title]])]),V("div",HV,[be[13]||(be[13]=V("label",{for:"description"},"Description",-1)),li(V("textarea",{id:"description","onUpdate:modelValue":be[4]||(be[4]=ne=>w.value.description=ne),rows:"3"},null,512),[[to,w.value.description]])]),w.value.location?(yt(),Et("div",qV,be[14]||(be[14]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"icon",viewBox:"0 0 20 20",fill:"currentColor"},[V("path",{"fill-rule":"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z","clip-rule":"evenodd"})],-1),V("span",null,"Note géolocalisée",-1)]))):yr("",!0),V("div",WV,[be[15]||(be[15]=V("label",{for:"column"},"État",-1)),li(V("select",{id:"column","onUpdate:modelValue":be[5]||(be[5]=ne=>w.value.columnId=ne)},[(yt(!0),Et($r,null,Ti(W.value,ne=>(yt(),Et("option",{key:ne.id,value:ne.id},er(ne.title),9,ZV))),128))],512),[[Ka,w.value.columnId]])]),Tr(a).isAdmin?(yt(),Et("div",KV,[be[17]||(be[17]=V("label",{for:"enterprise"},"Entreprise",-1)),li(V("select",{id:"enterprise","onUpdate:modelValue":be[6]||(be[6]=ne=>m.value=ne)},[be[16]||(be[16]=V("option",{value:null},"Sélectionner une entreprise",-1)),(yt(!0),Et($r,null,Ti(f.value,ne=>(yt(),Et("option",{key:ne.id,value:ne.id},er(ne.company_name||`${ne.first_name} ${ne.last_name}`),9,YV))),128))],512),[[Ka,m.value]])])):yr("",!0),V("div",XV,[be[18]||(be[18]=V("label",{for:"accessLevel"},"Niveau d'accès",-1)),li(V("select",{id:"accessLevel","onUpdate:modelValue":be[7]||(be[7]=ne=>w.value.accessLevel=ne)},[(yt(!0),Et($r,null,Ti(Tr(Gx),ne=>(yt(),Et("option",{key:ne.id,value:ne.id},er(ne.title)+" - "+er(ne.description),9,JV))),128))],512),[[Ka,w.value.accessLevel]])]),V("div",QV,[be[19]||(be[19]=V("label",null,"Couleur",-1)),V("div",e$,[(yt(),Et($r,null,Ti(Q,ne=>V("div",{key:ne,class:$s(["color-option",{selected:w.value.style.color===ne}]),style:Zh({backgroundColor:ne}),onClick:Se=>oe(ne)},null,14,t$)),64))])])])):o.value==="comments"?(yt(),Et("div",n$,[Te.note?(yt(),Hu(gV,{key:0,noteId:Te.note.id,comments:w.value.comments||[],onCommentAdded:we,onCommentDeleted:_e},null,8,["noteId","comments"])):yr("",!0)])):o.value==="photos"?(yt(),Et("div",r$,[Te.note?(yt(),Hu(OV,{key:0,noteId:Te.note.id,photos:w.value.photos||[],onPhotoAdded:ue,onPhotoDeleted:We},null,8,["noteId","photos"])):yr("",!0)])):yr("",!0)]),V("div",{class:"modal-footer"},[be[20]||(be[20]=V("button",{type:"submit",class:"primary-button"},"Enregistrer",-1)),V("button",{type:"button",onClick:me,class:"secondary-button"},"Annuler")])],32)])])}}}),Lk=Vf(i$,[["__scopeId","data-v-396bc0d5"]]);(()=>{var Ur,ei;var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,i=Object.getPrototypeOf,l=Object.prototype.hasOwnProperty,a=(y,S)=>()=>(S||y((S={exports:{}}).exports,S),S.exports),o=(y,S,I,F)=>{if(S&&typeof S=="object"||typeof S=="function")for(let G of r(S))!l.call(y,G)&&G!==I&&t(y,G,{get:()=>S[G],enumerable:!(F=n(S,G))||F.enumerable});return y},f=(y,S,I)=>(I=y!=null?e(i(y)):{},o(S||!y||!y.__esModule?t(I,"default",{value:y,enumerable:!0}):I,y)),m=a((y,S)=>{function I(){this.__data__=[],this.size=0}S.exports=I}),_=a((y,S)=>{function I(F,G){return F===G||F!==F&&G!==G}S.exports=I}),w=a((y,S)=>{var I=_();function F(G,te){for(var pe=G.length;pe--;)if(I(G[pe][0],te))return pe;return-1}S.exports=F}),M=a((y,S)=>{var I=w(),F=Array.prototype,G=F.splice;function te(pe){var xe=this.__data__,Fe=I(xe,pe);if(Fe<0)return!1;var tt=xe.length-1;return Fe==tt?xe.pop():G.call(xe,Fe,1),--this.size,!0}S.exports=te}),C=a((y,S)=>{var I=w();function F(G){var te=this.__data__,pe=I(te,G);return pe<0?void 0:te[pe][1]}S.exports=F}),R=a((y,S)=>{var I=w();function F(G){return I(this.__data__,G)>-1}S.exports=F}),z=a((y,S)=>{var I=w();function F(G,te){var pe=this.__data__,xe=I(pe,G);return xe<0?(++this.size,pe.push([G,te])):pe[xe][1]=te,this}S.exports=F}),W=a((y,S)=>{var I=m(),F=M(),G=C(),te=R(),pe=z();function xe(Fe){var tt=-1,zt=Fe==null?0:Fe.length;for(this.clear();++tt<zt;){var bt=Fe[tt];this.set(bt[0],bt[1])}}xe.prototype.clear=I,xe.prototype.delete=F,xe.prototype.get=G,xe.prototype.has=te,xe.prototype.set=pe,S.exports=xe}),X=a((y,S)=>{var I=W();function F(){this.__data__=new I,this.size=0}S.exports=F}),Y=a((y,S)=>{function I(F){var G=this.__data__,te=G.delete(F);return this.size=G.size,te}S.exports=I}),Q=a((y,S)=>{function I(F){return this.__data__.get(F)}S.exports=I}),oe=a((y,S)=>{function I(F){return this.__data__.has(F)}S.exports=I}),le=a((y,S)=>{var I=typeof lc=="object"&&lc&&lc.Object===Object&&lc;S.exports=I}),me=a((y,S)=>{var I=le(),F=typeof self=="object"&&self&&self.Object===Object&&self,G=I||F||Function("return this")();S.exports=G}),we=a((y,S)=>{var I=me(),F=I.Symbol;S.exports=F}),ue=a((y,S)=>{var I=we(),F=Object.prototype,G=F.hasOwnProperty,te=F.toString,pe=I?I.toStringTag:void 0;function xe(Fe){var tt=G.call(Fe,pe),zt=Fe[pe];try{Fe[pe]=void 0;var bt=!0}catch{}var dn=te.call(Fe);return bt&&(tt?Fe[pe]=zt:delete Fe[pe]),dn}S.exports=xe}),_e=a((y,S)=>{var I=Object.prototype,F=I.toString;function G(te){return F.call(te)}S.exports=G}),We=a((y,S)=>{var I=we(),F=ue(),G=_e(),te="[object Null]",pe="[object Undefined]",xe=I?I.toStringTag:void 0;function Fe(tt){return tt==null?tt===void 0?pe:te:xe&&xe in Object(tt)?F(tt):G(tt)}S.exports=Fe}),he=a((y,S)=>{function I(F){var G=typeof F;return F!=null&&(G=="object"||G=="function")}S.exports=I}),de=a((y,S)=>{var I=We(),F=he(),G="[object AsyncFunction]",te="[object Function]",pe="[object GeneratorFunction]",xe="[object Proxy]";function Fe(tt){if(!F(tt))return!1;var zt=I(tt);return zt==te||zt==pe||zt==G||zt==xe}S.exports=Fe}),Te=a((y,S)=>{var I=me(),F=I["__core-js_shared__"];S.exports=F}),be=a((y,S)=>{var I=Te(),F=function(){var te=/[^.]+$/.exec(I&&I.keys&&I.keys.IE_PROTO||"");return te?"Symbol(src)_1."+te:""}();function G(te){return!!F&&F in te}S.exports=G}),ae=a((y,S)=>{var I=Function.prototype,F=I.toString;function G(te){if(te!=null){try{return F.call(te)}catch{}try{return te+""}catch{}}return""}S.exports=G}),ne=a((y,S)=>{var I=de(),F=be(),G=he(),te=ae(),pe=/[\\^$.*+?()[\]{}|]/g,xe=/^\[object .+?Constructor\]$/,Fe=Function.prototype,tt=Object.prototype,zt=Fe.toString,bt=tt.hasOwnProperty,dn=RegExp("^"+zt.call(bt).replace(pe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function zn(hr){if(!G(hr)||F(hr))return!1;var Ir=I(hr)?dn:xe;return Ir.test(te(hr))}S.exports=zn}),Se=a((y,S)=>{function I(F,G){return F==null?void 0:F[G]}S.exports=I}),Le=a((y,S)=>{var I=ne(),F=Se();function G(te,pe){var xe=F(te,pe);return I(xe)?xe:void 0}S.exports=G}),ze=a((y,S)=>{var I=Le(),F=me(),G=I(F,"Map");S.exports=G}),He=a((y,S)=>{var I=Le(),F=I(Object,"create");S.exports=F}),pt=a((y,S)=>{var I=He();function F(){this.__data__=I?I(null):{},this.size=0}S.exports=F}),ge=a((y,S)=>{function I(F){var G=this.has(F)&&delete this.__data__[F];return this.size-=G?1:0,G}S.exports=I}),Ie=a((y,S)=>{var I=He(),F="__lodash_hash_undefined__",G=Object.prototype,te=G.hasOwnProperty;function pe(xe){var Fe=this.__data__;if(I){var tt=Fe[xe];return tt===F?void 0:tt}return te.call(Fe,xe)?Fe[xe]:void 0}S.exports=pe}),Ne=a((y,S)=>{var I=He(),F=Object.prototype,G=F.hasOwnProperty;function te(pe){var xe=this.__data__;return I?xe[pe]!==void 0:G.call(xe,pe)}S.exports=te}),Ve=a((y,S)=>{var I=He(),F="__lodash_hash_undefined__";function G(te,pe){var xe=this.__data__;return this.size+=this.has(te)?0:1,xe[te]=I&&pe===void 0?F:pe,this}S.exports=G}),it=a((y,S)=>{var I=pt(),F=ge(),G=Ie(),te=Ne(),pe=Ve();function xe(Fe){var tt=-1,zt=Fe==null?0:Fe.length;for(this.clear();++tt<zt;){var bt=Fe[tt];this.set(bt[0],bt[1])}}xe.prototype.clear=I,xe.prototype.delete=F,xe.prototype.get=G,xe.prototype.has=te,xe.prototype.set=pe,S.exports=xe}),lt=a((y,S)=>{var I=it(),F=W(),G=ze();function te(){this.size=0,this.__data__={hash:new I,map:new(G||F),string:new I}}S.exports=te}),Mt=a((y,S)=>{function I(F){var G=typeof F;return G=="string"||G=="number"||G=="symbol"||G=="boolean"?F!=="__proto__":F===null}S.exports=I}),wt=a((y,S)=>{var I=Mt();function F(G,te){var pe=G.__data__;return I(te)?pe[typeof te=="string"?"string":"hash"]:pe.map}S.exports=F}),rn=a((y,S)=>{var I=wt();function F(G){var te=I(this,G).delete(G);return this.size-=te?1:0,te}S.exports=F}),yn=a((y,S)=>{var I=wt();function F(G){return I(this,G).get(G)}S.exports=F}),Pn=a((y,S)=>{var I=wt();function F(G){return I(this,G).has(G)}S.exports=F}),De=a((y,S)=>{var I=wt();function F(G,te){var pe=I(this,G),xe=pe.size;return pe.set(G,te),this.size+=pe.size==xe?0:1,this}S.exports=F}),Ae=a((y,S)=>{var I=lt(),F=rn(),G=yn(),te=Pn(),pe=De();function xe(Fe){var tt=-1,zt=Fe==null?0:Fe.length;for(this.clear();++tt<zt;){var bt=Fe[tt];this.set(bt[0],bt[1])}}xe.prototype.clear=I,xe.prototype.delete=F,xe.prototype.get=G,xe.prototype.has=te,xe.prototype.set=pe,S.exports=xe}),Be=a((y,S)=>{var I=W(),F=ze(),G=Ae(),te=200;function pe(xe,Fe){var tt=this.__data__;if(tt instanceof I){var zt=tt.__data__;if(!F||zt.length<te-1)return zt.push([xe,Fe]),this.size=++tt.size,this;tt=this.__data__=new G(zt)}return tt.set(xe,Fe),this.size=tt.size,this}S.exports=pe}),Ce=a((y,S)=>{var I=W(),F=X(),G=Y(),te=Q(),pe=oe(),xe=Be();function Fe(tt){var zt=this.__data__=new I(tt);this.size=zt.size}Fe.prototype.clear=F,Fe.prototype.delete=G,Fe.prototype.get=te,Fe.prototype.has=pe,Fe.prototype.set=xe,S.exports=Fe}),ot=a((y,S)=>{var I=Le(),F=function(){try{var G=I(Object,"defineProperty");return G({},"",{}),G}catch{}}();S.exports=F}),Dt=a((y,S)=>{var I=ot();function F(G,te,pe){te=="__proto__"&&I?I(G,te,{configurable:!0,enumerable:!0,value:pe,writable:!0}):G[te]=pe}S.exports=F}),Zt=a((y,S)=>{var I=Dt(),F=_();function G(te,pe,xe){(xe!==void 0&&!F(te[pe],xe)||xe===void 0&&!(pe in te))&&I(te,pe,xe)}S.exports=G}),an=a((y,S)=>{function I(F){return function(G,te,pe){for(var xe=-1,Fe=Object(G),tt=pe(G),zt=tt.length;zt--;){var bt=tt[F?zt:++xe];if(te(Fe[bt],bt,Fe)===!1)break}return G}}S.exports=I}),ln=a((y,S)=>{var I=an(),F=I();S.exports=F}),vn=a((y,S)=>{var I=me(),F=typeof y=="object"&&y&&!y.nodeType&&y,G=F&&typeof S=="object"&&S&&!S.nodeType&&S,te=G&&G.exports===F,pe=te?I.Buffer:void 0,xe=pe?pe.allocUnsafe:void 0;function Fe(tt,zt){if(zt)return tt.slice();var bt=tt.length,dn=xe?xe(bt):new tt.constructor(bt);return tt.copy(dn),dn}S.exports=Fe}),qn=a((y,S)=>{var I=me(),F=I.Uint8Array;S.exports=F}),Kn=a((y,S)=>{var I=qn();function F(G){var te=new G.constructor(G.byteLength);return new I(te).set(new I(G)),te}S.exports=F}),cr=a((y,S)=>{var I=Kn();function F(G,te){var pe=te?I(G.buffer):G.buffer;return new G.constructor(pe,G.byteOffset,G.length)}S.exports=F}),pr=a((y,S)=>{function I(F,G){var te=-1,pe=F.length;for(G||(G=Array(pe));++te<pe;)G[te]=F[te];return G}S.exports=I}),Dr=a((y,S)=>{var I=he(),F=Object.create,G=function(){function te(){}return function(pe){if(!I(pe))return{};if(F)return F(pe);te.prototype=pe;var xe=new te;return te.prototype=void 0,xe}}();S.exports=G}),zr=a((y,S)=>{function I(F,G){return function(te){return F(G(te))}}S.exports=I}),Ht=a((y,S)=>{var I=zr(),F=I(Object.getPrototypeOf,Object);S.exports=F}),tn=a((y,S)=>{var I=Object.prototype;function F(G){var te=G&&G.constructor,pe=typeof te=="function"&&te.prototype||I;return G===pe}S.exports=F}),Kt=a((y,S)=>{var I=Dr(),F=Ht(),G=tn();function te(pe){return typeof pe.constructor=="function"&&!G(pe)?I(F(pe)):{}}S.exports=te}),Yn=a((y,S)=>{function I(F){return F!=null&&typeof F=="object"}S.exports=I}),ir=a((y,S)=>{var I=We(),F=Yn(),G="[object Arguments]";function te(pe){return F(pe)&&I(pe)==G}S.exports=te}),Fr=a((y,S)=>{var I=ir(),F=Yn(),G=Object.prototype,te=G.hasOwnProperty,pe=G.propertyIsEnumerable,xe=I(function(){return arguments}())?I:function(Fe){return F(Fe)&&te.call(Fe,"callee")&&!pe.call(Fe,"callee")};S.exports=xe}),Ft=a((y,S)=>{var I=Array.isArray;S.exports=I}),je=a((y,S)=>{var I=9007199254740991;function F(G){return typeof G=="number"&&G>-1&&G%1==0&&G<=I}S.exports=F}),Ze=a((y,S)=>{var I=de(),F=je();function G(te){return te!=null&&F(te.length)&&!I(te)}S.exports=G}),et=a((y,S)=>{var I=Ze(),F=Yn();function G(te){return F(te)&&I(te)}S.exports=G}),ct=a((y,S)=>{function I(){return!1}S.exports=I}),$e=a((y,S)=>{var I=me(),F=ct(),G=typeof y=="object"&&y&&!y.nodeType&&y,te=G&&typeof S=="object"&&S&&!S.nodeType&&S,pe=te&&te.exports===G,xe=pe?I.Buffer:void 0,Fe=xe?xe.isBuffer:void 0,tt=Fe||F;S.exports=tt}),Gt=a((y,S)=>{var I=We(),F=Ht(),G=Yn(),te="[object Object]",pe=Function.prototype,xe=Object.prototype,Fe=pe.toString,tt=xe.hasOwnProperty,zt=Fe.call(Object);function bt(dn){if(!G(dn)||I(dn)!=te)return!1;var zn=F(dn);if(zn===null)return!0;var hr=tt.call(zn,"constructor")&&zn.constructor;return typeof hr=="function"&&hr instanceof hr&&Fe.call(hr)==zt}S.exports=bt}),hn=a((y,S)=>{var I=We(),F=je(),G=Yn(),te="[object Arguments]",pe="[object Array]",xe="[object Boolean]",Fe="[object Date]",tt="[object Error]",zt="[object Function]",bt="[object Map]",dn="[object Number]",zn="[object Object]",hr="[object RegExp]",Ir="[object Set]",Br="[object String]",ci="[object WeakMap]",Nt="[object ArrayBuffer]",qt="[object DataView]",gn="[object Float32Array]",Gn="[object Float64Array]",Mn="[object Int8Array]",Bn="[object Int16Array]",Ge="[object Int32Array]",at="[object Uint8Array]",mt="[object Uint8ClampedArray]",_t="[object Uint16Array]",St="[object Uint32Array]",Lt={};Lt[gn]=Lt[Gn]=Lt[Mn]=Lt[Bn]=Lt[Ge]=Lt[at]=Lt[mt]=Lt[_t]=Lt[St]=!0,Lt[te]=Lt[pe]=Lt[Nt]=Lt[xe]=Lt[qt]=Lt[Fe]=Lt[tt]=Lt[zt]=Lt[bt]=Lt[dn]=Lt[zn]=Lt[hr]=Lt[Ir]=Lt[Br]=Lt[ci]=!1;function sn(E){return G(E)&&F(E.length)&&!!Lt[I(E)]}S.exports=sn}),Ot=a((y,S)=>{function I(F){return function(G){return F(G)}}S.exports=I}),cn=a((y,S)=>{var I=le(),F=typeof y=="object"&&y&&!y.nodeType&&y,G=F&&typeof S=="object"&&S&&!S.nodeType&&S,te=G&&G.exports===F,pe=te&&I.process,xe=function(){try{var Fe=G&&G.require&&G.require("util").types;return Fe||pe&&pe.binding&&pe.binding("util")}catch{}}();S.exports=xe}),En=a((y,S)=>{var I=hn(),F=Ot(),G=cn(),te=G&&G.isTypedArray,pe=te?F(te):I;S.exports=pe}),wn=a((y,S)=>{function I(F,G){if(!(G==="constructor"&&typeof F[G]=="function")&&G!="__proto__")return F[G]}S.exports=I}),Qn=a((y,S)=>{var I=Dt(),F=_(),G=Object.prototype,te=G.hasOwnProperty;function pe(xe,Fe,tt){var zt=xe[Fe];(!(te.call(xe,Fe)&&F(zt,tt))||tt===void 0&&!(Fe in xe))&&I(xe,Fe,tt)}S.exports=pe}),Lr=a((y,S)=>{var I=Qn(),F=Dt();function G(te,pe,xe,Fe){var tt=!xe;xe||(xe={});for(var zt=-1,bt=pe.length;++zt<bt;){var dn=pe[zt],zn=Fe?Fe(xe[dn],te[dn],dn,xe,te):void 0;zn===void 0&&(zn=te[dn]),tt?F(xe,dn,zn):I(xe,dn,zn)}return xe}S.exports=G}),Yt=a((y,S)=>{function I(F,G){for(var te=-1,pe=Array(F);++te<F;)pe[te]=G(te);return pe}S.exports=I}),vt=a((y,S)=>{var I=9007199254740991,F=/^(?:0|[1-9]\d*)$/;function G(te,pe){var xe=typeof te;return pe=pe??I,!!pe&&(xe=="number"||xe!="symbol"&&F.test(te))&&te>-1&&te%1==0&&te<pe}S.exports=G}),Tn=a((y,S)=>{var I=Yt(),F=Fr(),G=Ft(),te=$e(),pe=vt(),xe=En(),Fe=Object.prototype,tt=Fe.hasOwnProperty;function zt(bt,dn){var zn=G(bt),hr=!zn&&F(bt),Ir=!zn&&!hr&&te(bt),Br=!zn&&!hr&&!Ir&&xe(bt),ci=zn||hr||Ir||Br,Nt=ci?I(bt.length,String):[],qt=Nt.length;for(var gn in bt)(dn||tt.call(bt,gn))&&!(ci&&(gn=="length"||Ir&&(gn=="offset"||gn=="parent")||Br&&(gn=="buffer"||gn=="byteLength"||gn=="byteOffset")||pe(gn,qt)))&&Nt.push(gn);return Nt}S.exports=zt}),bn=a((y,S)=>{function I(F){var G=[];if(F!=null)for(var te in Object(F))G.push(te);return G}S.exports=I}),br=a((y,S)=>{var I=he(),F=tn(),G=bn(),te=Object.prototype,pe=te.hasOwnProperty;function xe(Fe){if(!I(Fe))return G(Fe);var tt=F(Fe),zt=[];for(var bt in Fe)bt=="constructor"&&(tt||!pe.call(Fe,bt))||zt.push(bt);return zt}S.exports=xe}),vr=a((y,S)=>{var I=Tn(),F=br(),G=Ze();function te(pe){return G(pe)?I(pe,!0):F(pe)}S.exports=te}),Cn=a((y,S)=>{var I=Lr(),F=vr();function G(te){return I(te,F(te))}S.exports=G}),pn=a((y,S)=>{var I=Zt(),F=vn(),G=cr(),te=pr(),pe=Kt(),xe=Fr(),Fe=Ft(),tt=et(),zt=$e(),bt=de(),dn=he(),zn=Gt(),hr=En(),Ir=wn(),Br=Cn();function ci(Nt,qt,gn,Gn,Mn,Bn,Ge){var at=Ir(Nt,gn),mt=Ir(qt,gn),_t=Ge.get(mt);if(_t){I(Nt,gn,_t);return}var St=Bn?Bn(at,mt,gn+"",Nt,qt,Ge):void 0,Lt=St===void 0;if(Lt){var sn=Fe(mt),E=!sn&&zt(mt),s=!sn&&!E&&hr(mt);St=mt,sn||E||s?Fe(at)?St=at:tt(at)?St=te(at):E?(Lt=!1,St=F(mt,!0)):s?(Lt=!1,St=G(mt,!0)):St=[]:zn(mt)||xe(mt)?(St=at,xe(at)?St=Br(at):(!dn(at)||bt(at))&&(St=pe(mt))):Lt=!1}Lt&&(Ge.set(mt,St),Mn(St,mt,Gn,Bn,Ge),Ge.delete(mt)),I(Nt,gn,St)}S.exports=ci}),Ut=a((y,S)=>{var I=Ce(),F=Zt(),G=ln(),te=pn(),pe=he(),xe=vr(),Fe=wn();function tt(zt,bt,dn,zn,hr){zt!==bt&&G(bt,function(Ir,Br){if(hr||(hr=new I),pe(Ir))te(zt,bt,Br,dn,tt,zn,hr);else{var ci=zn?zn(Fe(zt,Br),Ir,Br+"",zt,bt,hr):void 0;ci===void 0&&(ci=Ir),F(zt,Br,ci)}},xe)}S.exports=tt}),Hn=a((y,S)=>{function I(F){return F}S.exports=I}),or=a((y,S)=>{function I(F,G,te){switch(te.length){case 0:return F.call(G);case 1:return F.call(G,te[0]);case 2:return F.call(G,te[0],te[1]);case 3:return F.call(G,te[0],te[1],te[2])}return F.apply(G,te)}S.exports=I}),Xr=a((y,S)=>{var I=or(),F=Math.max;function G(te,pe,xe){return pe=F(pe===void 0?te.length-1:pe,0),function(){for(var Fe=arguments,tt=-1,zt=F(Fe.length-pe,0),bt=Array(zt);++tt<zt;)bt[tt]=Fe[pe+tt];tt=-1;for(var dn=Array(pe+1);++tt<pe;)dn[tt]=Fe[tt];return dn[pe]=xe(bt),I(te,this,dn)}}S.exports=G}),ri=a((y,S)=>{function I(F){return function(){return F}}S.exports=I}),ai=a((y,S)=>{var I=ri(),F=ot(),G=Hn(),te=F?function(pe,xe){return F(pe,"toString",{configurable:!0,enumerable:!1,value:I(xe),writable:!0})}:G;S.exports=te}),Pr=a((y,S)=>{var I=800,F=16,G=Date.now;function te(pe){var xe=0,Fe=0;return function(){var tt=G(),zt=F-(tt-Fe);if(Fe=tt,zt>0){if(++xe>=I)return arguments[0]}else xe=0;return pe.apply(void 0,arguments)}}S.exports=te}),As=a((y,S)=>{var I=ai(),F=Pr(),G=F(I);S.exports=G}),$i=a((y,S)=>{var I=Hn(),F=Xr(),G=As();function te(pe,xe){return G(F(pe,xe,I),pe+"")}S.exports=te}),Qa=a((y,S)=>{var I=_(),F=Ze(),G=vt(),te=he();function pe(xe,Fe,tt){if(!te(tt))return!1;var zt=typeof Fe;return(zt=="number"?F(tt)&&G(Fe,tt.length):zt=="string"&&Fe in tt)?I(tt[Fe],xe):!1}S.exports=pe}),pi=a((y,S)=>{var I=$i(),F=Qa();function G(te){return I(function(pe,xe){var Fe=-1,tt=xe.length,zt=tt>1?xe[tt-1]:void 0,bt=tt>2?xe[2]:void 0;for(zt=te.length>3&&typeof zt=="function"?(tt--,zt):void 0,bt&&F(xe[0],xe[1],bt)&&(zt=tt<3?void 0:zt,tt=1),pe=Object(pe);++Fe<tt;){var dn=xe[Fe];dn&&te(pe,dn,Fe,zt)}return pe})}S.exports=G}),Li=a((y,S)=>{var I=Ut(),F=pi(),G=F(function(te,pe,xe){I(te,pe,xe)});S.exports=G}),Yi=a((y,S)=>{var I=We(),F=Yn(),G="[object Symbol]";function te(pe){return typeof pe=="symbol"||F(pe)&&I(pe)==G}S.exports=te}),ns=a((y,S)=>{var I=Ft(),F=Yi(),G=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,te=/^\w*$/;function pe(xe,Fe){if(I(xe))return!1;var tt=typeof xe;return tt=="number"||tt=="symbol"||tt=="boolean"||xe==null||F(xe)?!0:te.test(xe)||!G.test(xe)||Fe!=null&&xe in Object(Fe)}S.exports=pe}),ao=a((y,S)=>{var I=Ae(),F="Expected a function";function G(te,pe){if(typeof te!="function"||pe!=null&&typeof pe!="function")throw new TypeError(F);var xe=function(){var Fe=arguments,tt=pe?pe.apply(this,Fe):Fe[0],zt=xe.cache;if(zt.has(tt))return zt.get(tt);var bt=te.apply(this,Fe);return xe.cache=zt.set(tt,bt)||zt,bt};return xe.cache=new(G.Cache||I),xe}G.Cache=I,S.exports=G}),wc=a((y,S)=>{var I=ao(),F=500;function G(te){var pe=I(te,function(Fe){return xe.size===F&&xe.clear(),Fe}),xe=pe.cache;return pe}S.exports=G}),Wu=a((y,S)=>{var I=wc(),F=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,G=/\\(\\)?/g,te=I(function(pe){var xe=[];return pe.charCodeAt(0)===46&&xe.push(""),pe.replace(F,function(Fe,tt,zt,bt){xe.push(zt?bt.replace(G,"$1"):tt||Fe)}),xe});S.exports=te}),el=a((y,S)=>{function I(F,G){for(var te=-1,pe=F==null?0:F.length,xe=Array(pe);++te<pe;)xe[te]=G(F[te],te,F);return xe}S.exports=I}),Au=a((y,S)=>{var I=we(),F=el(),G=Ft(),te=Yi(),pe=I?I.prototype:void 0,xe=pe?pe.toString:void 0;function Fe(tt){if(typeof tt=="string")return tt;if(G(tt))return F(tt,Fe)+"";if(te(tt))return xe?xe.call(tt):"";var zt=tt+"";return zt=="0"&&1/tt==-1/0?"-0":zt}S.exports=Fe}),Zu=a((y,S)=>{var I=Au();function F(G){return G==null?"":I(G)}S.exports=F}),Ku=a((y,S)=>{var I=Ft(),F=ns(),G=Wu(),te=Zu();function pe(xe,Fe){return I(xe)?xe:F(xe,Fe)?[xe]:G(te(xe))}S.exports=pe}),Cc=a((y,S)=>{var I=Yi();function F(G){if(typeof G=="string"||I(G))return G;var te=G+"";return te=="0"&&1/G==-1/0?"-0":te}S.exports=F}),Yu=a((y,S)=>{var I=Ku(),F=Cc();function G(te,pe){pe=I(pe,te);for(var xe=0,Fe=pe.length;te!=null&&xe<Fe;)te=te[F(pe[xe++])];return xe&&xe==Fe?te:void 0}S.exports=G}),ja=a((y,S)=>{var I=Yu();function F(G,te,pe){var xe=G==null?void 0:I(G,te);return xe===void 0?pe:xe}S.exports=F}),ds=a((y,S)=>{(function(I,F){typeof y=="object"&&typeof S<"u"?S.exports=F():(I=I||self).RBush=F()})(y,function(){function I(Nt,qt,gn,Gn,Mn){(function Bn(Ge,at,mt,_t,St){for(;_t>mt;){if(_t-mt>600){var Lt=_t-mt+1,sn=at-mt+1,E=Math.log(Lt),s=.5*Math.exp(2*E/3),c=.5*Math.sqrt(E*s*(Lt-s)/Lt)*(sn-Lt/2<0?-1:1),g=Math.max(mt,Math.floor(at-sn*s/Lt+c)),x=Math.min(_t,Math.floor(at+(Lt-sn)*s/Lt+c));Bn(Ge,at,g,x,St)}var A=Ge[at],N=mt,$=_t;for(F(Ge,mt,at),St(Ge[_t],A)>0&&F(Ge,mt,_t);N<$;){for(F(Ge,N,$),N++,$--;St(Ge[N],A)<0;)N++;for(;St(Ge[$],A)>0;)$--}St(Ge[mt],A)===0?F(Ge,mt,$):F(Ge,++$,_t),$<=at&&(mt=$+1),at<=$&&(_t=$-1)}})(Nt,qt,gn||0,Gn||Nt.length-1,Mn||G)}function F(Nt,qt,gn){var Gn=Nt[qt];Nt[qt]=Nt[gn],Nt[gn]=Gn}function G(Nt,qt){return Nt<qt?-1:Nt>qt?1:0}var te=function(Nt){Nt===void 0&&(Nt=9),this._maxEntries=Math.max(4,Nt),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function pe(Nt,qt,gn){if(!gn)return qt.indexOf(Nt);for(var Gn=0;Gn<qt.length;Gn++)if(gn(Nt,qt[Gn]))return Gn;return-1}function xe(Nt,qt){Fe(Nt,0,Nt.children.length,qt,Nt)}function Fe(Nt,qt,gn,Gn,Mn){Mn||(Mn=Br(null)),Mn.minX=1/0,Mn.minY=1/0,Mn.maxX=-1/0,Mn.maxY=-1/0;for(var Bn=qt;Bn<gn;Bn++){var Ge=Nt.children[Bn];tt(Mn,Nt.leaf?Gn(Ge):Ge)}return Mn}function tt(Nt,qt){return Nt.minX=Math.min(Nt.minX,qt.minX),Nt.minY=Math.min(Nt.minY,qt.minY),Nt.maxX=Math.max(Nt.maxX,qt.maxX),Nt.maxY=Math.max(Nt.maxY,qt.maxY),Nt}function zt(Nt,qt){return Nt.minX-qt.minX}function bt(Nt,qt){return Nt.minY-qt.minY}function dn(Nt){return(Nt.maxX-Nt.minX)*(Nt.maxY-Nt.minY)}function zn(Nt){return Nt.maxX-Nt.minX+(Nt.maxY-Nt.minY)}function hr(Nt,qt){return Nt.minX<=qt.minX&&Nt.minY<=qt.minY&&qt.maxX<=Nt.maxX&&qt.maxY<=Nt.maxY}function Ir(Nt,qt){return qt.minX<=Nt.maxX&&qt.minY<=Nt.maxY&&qt.maxX>=Nt.minX&&qt.maxY>=Nt.minY}function Br(Nt){return{children:Nt,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ci(Nt,qt,gn,Gn,Mn){for(var Bn=[qt,gn];Bn.length;)if(!((gn=Bn.pop())-(qt=Bn.pop())<=Gn)){var Ge=qt+Math.ceil((gn-qt)/Gn/2)*Gn;I(Nt,Ge,qt,gn,Mn),Bn.push(qt,Ge,Ge,gn)}}return te.prototype.all=function(){return this._all(this.data,[])},te.prototype.search=function(Nt){var qt=this.data,gn=[];if(!Ir(Nt,qt))return gn;for(var Gn=this.toBBox,Mn=[];qt;){for(var Bn=0;Bn<qt.children.length;Bn++){var Ge=qt.children[Bn],at=qt.leaf?Gn(Ge):Ge;Ir(Nt,at)&&(qt.leaf?gn.push(Ge):hr(Nt,at)?this._all(Ge,gn):Mn.push(Ge))}qt=Mn.pop()}return gn},te.prototype.collides=function(Nt){var qt=this.data;if(!Ir(Nt,qt))return!1;for(var gn=[];qt;){for(var Gn=0;Gn<qt.children.length;Gn++){var Mn=qt.children[Gn],Bn=qt.leaf?this.toBBox(Mn):Mn;if(Ir(Nt,Bn)){if(qt.leaf||hr(Nt,Bn))return!0;gn.push(Mn)}}qt=gn.pop()}return!1},te.prototype.load=function(Nt){if(!Nt||!Nt.length)return this;if(Nt.length<this._minEntries){for(var qt=0;qt<Nt.length;qt++)this.insert(Nt[qt]);return this}var gn=this._build(Nt.slice(),0,Nt.length-1,0);if(this.data.children.length)if(this.data.height===gn.height)this._splitRoot(this.data,gn);else{if(this.data.height<gn.height){var Gn=this.data;this.data=gn,gn=Gn}this._insert(gn,this.data.height-gn.height-1,!0)}else this.data=gn;return this},te.prototype.insert=function(Nt){return Nt&&this._insert(Nt,this.data.height-1),this},te.prototype.clear=function(){return this.data=Br([]),this},te.prototype.remove=function(Nt,qt){if(!Nt)return this;for(var gn,Gn,Mn,Bn=this.data,Ge=this.toBBox(Nt),at=[],mt=[];Bn||at.length;){if(Bn||(Bn=at.pop(),Gn=at[at.length-1],gn=mt.pop(),Mn=!0),Bn.leaf){var _t=pe(Nt,Bn.children,qt);if(_t!==-1)return Bn.children.splice(_t,1),at.push(Bn),this._condense(at),this}Mn||Bn.leaf||!hr(Bn,Ge)?Gn?(gn++,Bn=Gn.children[gn],Mn=!1):Bn=null:(at.push(Bn),mt.push(gn),gn=0,Gn=Bn,Bn=Bn.children[0])}return this},te.prototype.toBBox=function(Nt){return Nt},te.prototype.compareMinX=function(Nt,qt){return Nt.minX-qt.minX},te.prototype.compareMinY=function(Nt,qt){return Nt.minY-qt.minY},te.prototype.toJSON=function(){return this.data},te.prototype.fromJSON=function(Nt){return this.data=Nt,this},te.prototype._all=function(Nt,qt){for(var gn=[];Nt;)Nt.leaf?qt.push.apply(qt,Nt.children):gn.push.apply(gn,Nt.children),Nt=gn.pop();return qt},te.prototype._build=function(Nt,qt,gn,Gn){var Mn,Bn=gn-qt+1,Ge=this._maxEntries;if(Bn<=Ge)return xe(Mn=Br(Nt.slice(qt,gn+1)),this.toBBox),Mn;Gn||(Gn=Math.ceil(Math.log(Bn)/Math.log(Ge)),Ge=Math.ceil(Bn/Math.pow(Ge,Gn-1))),(Mn=Br([])).leaf=!1,Mn.height=Gn;var at=Math.ceil(Bn/Ge),mt=at*Math.ceil(Math.sqrt(Ge));ci(Nt,qt,gn,mt,this.compareMinX);for(var _t=qt;_t<=gn;_t+=mt){var St=Math.min(_t+mt-1,gn);ci(Nt,_t,St,at,this.compareMinY);for(var Lt=_t;Lt<=St;Lt+=at){var sn=Math.min(Lt+at-1,St);Mn.children.push(this._build(Nt,Lt,sn,Gn-1))}}return xe(Mn,this.toBBox),Mn},te.prototype._chooseSubtree=function(Nt,qt,gn,Gn){for(;Gn.push(qt),!qt.leaf&&Gn.length-1!==gn;){for(var Mn=1/0,Bn=1/0,Ge=void 0,at=0;at<qt.children.length;at++){var mt=qt.children[at],_t=dn(mt),St=(Lt=Nt,sn=mt,(Math.max(sn.maxX,Lt.maxX)-Math.min(sn.minX,Lt.minX))*(Math.max(sn.maxY,Lt.maxY)-Math.min(sn.minY,Lt.minY))-_t);St<Bn?(Bn=St,Mn=_t<Mn?_t:Mn,Ge=mt):St===Bn&&_t<Mn&&(Mn=_t,Ge=mt)}qt=Ge||qt.children[0]}var Lt,sn;return qt},te.prototype._insert=function(Nt,qt,gn){var Gn=gn?Nt:this.toBBox(Nt),Mn=[],Bn=this._chooseSubtree(Gn,this.data,qt,Mn);for(Bn.children.push(Nt),tt(Bn,Gn);qt>=0&&Mn[qt].children.length>this._maxEntries;)this._split(Mn,qt),qt--;this._adjustParentBBoxes(Gn,Mn,qt)},te.prototype._split=function(Nt,qt){var gn=Nt[qt],Gn=gn.children.length,Mn=this._minEntries;this._chooseSplitAxis(gn,Mn,Gn);var Bn=this._chooseSplitIndex(gn,Mn,Gn),Ge=Br(gn.children.splice(Bn,gn.children.length-Bn));Ge.height=gn.height,Ge.leaf=gn.leaf,xe(gn,this.toBBox),xe(Ge,this.toBBox),qt?Nt[qt-1].children.push(Ge):this._splitRoot(gn,Ge)},te.prototype._splitRoot=function(Nt,qt){this.data=Br([Nt,qt]),this.data.height=Nt.height+1,this.data.leaf=!1,xe(this.data,this.toBBox)},te.prototype._chooseSplitIndex=function(Nt,qt,gn){for(var Gn,Mn,Bn,Ge,at,mt,_t,St=1/0,Lt=1/0,sn=qt;sn<=gn-qt;sn++){var E=Fe(Nt,0,sn,this.toBBox),s=Fe(Nt,sn,gn,this.toBBox),c=(Mn=E,Bn=s,Ge=void 0,at=void 0,mt=void 0,_t=void 0,Ge=Math.max(Mn.minX,Bn.minX),at=Math.max(Mn.minY,Bn.minY),mt=Math.min(Mn.maxX,Bn.maxX),_t=Math.min(Mn.maxY,Bn.maxY),Math.max(0,mt-Ge)*Math.max(0,_t-at)),g=dn(E)+dn(s);c<St?(St=c,Gn=sn,Lt=g<Lt?g:Lt):c===St&&g<Lt&&(Lt=g,Gn=sn)}return Gn||gn-qt},te.prototype._chooseSplitAxis=function(Nt,qt,gn){var Gn=Nt.leaf?this.compareMinX:zt,Mn=Nt.leaf?this.compareMinY:bt;this._allDistMargin(Nt,qt,gn,Gn)<this._allDistMargin(Nt,qt,gn,Mn)&&Nt.children.sort(Gn)},te.prototype._allDistMargin=function(Nt,qt,gn,Gn){Nt.children.sort(Gn);for(var Mn=this.toBBox,Bn=Fe(Nt,0,qt,Mn),Ge=Fe(Nt,gn-qt,gn,Mn),at=zn(Bn)+zn(Ge),mt=qt;mt<gn-qt;mt++){var _t=Nt.children[mt];tt(Bn,Nt.leaf?Mn(_t):_t),at+=zn(Bn)}for(var St=gn-qt-1;St>=qt;St--){var Lt=Nt.children[St];tt(Ge,Nt.leaf?Mn(Lt):Lt),at+=zn(Ge)}return at},te.prototype._adjustParentBBoxes=function(Nt,qt,gn){for(var Gn=gn;Gn>=0;Gn--)tt(qt[Gn],Nt)},te.prototype._condense=function(Nt){for(var qt=Nt.length-1,gn=void 0;qt>=0;qt--)Nt[qt].children.length===0?qt>0?(gn=Nt[qt-1].children).splice(gn.indexOf(Nt[qt]),1):this.clear():xe(Nt[qt],this.toBBox)},te})}),Di=a(y=>{Object.defineProperty(y,"__esModule",{value:!0}),y.earthRadius=63710088e-1,y.factors={centimeters:y.earthRadius*100,centimetres:y.earthRadius*100,degrees:y.earthRadius/111325,feet:y.earthRadius*3.28084,inches:y.earthRadius*39.37,kilometers:y.earthRadius/1e3,kilometres:y.earthRadius/1e3,meters:y.earthRadius,metres:y.earthRadius,miles:y.earthRadius/1609.344,millimeters:y.earthRadius*1e3,millimetres:y.earthRadius*1e3,nauticalmiles:y.earthRadius/1852,radians:1,yards:y.earthRadius*1.0936},y.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/y.earthRadius,yards:1.0936133},y.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function S(_t,St,Lt){Lt===void 0&&(Lt={});var sn={type:"Feature"};return(Lt.id===0||Lt.id)&&(sn.id=Lt.id),Lt.bbox&&(sn.bbox=Lt.bbox),sn.properties=St||{},sn.geometry=_t,sn}y.feature=S;function I(_t,St,Lt){switch(_t){case"Point":return F(St).geometry;case"LineString":return xe(St).geometry;case"Polygon":return te(St).geometry;case"MultiPoint":return bt(St).geometry;case"MultiLineString":return zt(St).geometry;case"MultiPolygon":return dn(St).geometry;default:throw new Error(_t+" is invalid")}}y.geometry=I;function F(_t,St,Lt){if(Lt===void 0&&(Lt={}),!_t)throw new Error("coordinates is required");if(!Array.isArray(_t))throw new Error("coordinates must be an Array");if(_t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Bn(_t[0])||!Bn(_t[1]))throw new Error("coordinates must contain numbers");var sn={type:"Point",coordinates:_t};return S(sn,St,Lt)}y.point=F;function G(_t,St,Lt){return Lt===void 0&&(Lt={}),tt(_t.map(function(sn){return F(sn,St)}),Lt)}y.points=G;function te(_t,St,Lt){Lt===void 0&&(Lt={});for(var sn=0,E=_t;sn<E.length;sn++){var s=E[sn];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var c=0;c<s[s.length-1].length;c++)if(s[s.length-1][c]!==s[0][c])throw new Error("First and last Position are not equivalent.")}var g={type:"Polygon",coordinates:_t};return S(g,St,Lt)}y.polygon=te;function pe(_t,St,Lt){return Lt===void 0&&(Lt={}),tt(_t.map(function(sn){return te(sn,St)}),Lt)}y.polygons=pe;function xe(_t,St,Lt){if(Lt===void 0&&(Lt={}),_t.length<2)throw new Error("coordinates must be an array of two or more positions");var sn={type:"LineString",coordinates:_t};return S(sn,St,Lt)}y.lineString=xe;function Fe(_t,St,Lt){return Lt===void 0&&(Lt={}),tt(_t.map(function(sn){return xe(sn,St)}),Lt)}y.lineStrings=Fe;function tt(_t,St){St===void 0&&(St={});var Lt={type:"FeatureCollection"};return St.id&&(Lt.id=St.id),St.bbox&&(Lt.bbox=St.bbox),Lt.features=_t,Lt}y.featureCollection=tt;function zt(_t,St,Lt){Lt===void 0&&(Lt={});var sn={type:"MultiLineString",coordinates:_t};return S(sn,St,Lt)}y.multiLineString=zt;function bt(_t,St,Lt){Lt===void 0&&(Lt={});var sn={type:"MultiPoint",coordinates:_t};return S(sn,St,Lt)}y.multiPoint=bt;function dn(_t,St,Lt){Lt===void 0&&(Lt={});var sn={type:"MultiPolygon",coordinates:_t};return S(sn,St,Lt)}y.multiPolygon=dn;function zn(_t,St,Lt){Lt===void 0&&(Lt={});var sn={type:"GeometryCollection",geometries:_t};return S(sn,St,Lt)}y.geometryCollection=zn;function hr(_t,St){if(St===void 0&&(St=0),St&&!(St>=0))throw new Error("precision must be a positive number");var Lt=Math.pow(10,St||0);return Math.round(_t*Lt)/Lt}y.round=hr;function Ir(_t,St){St===void 0&&(St="kilometers");var Lt=y.factors[St];if(!Lt)throw new Error(St+" units is invalid");return _t*Lt}y.radiansToLength=Ir;function Br(_t,St){St===void 0&&(St="kilometers");var Lt=y.factors[St];if(!Lt)throw new Error(St+" units is invalid");return _t/Lt}y.lengthToRadians=Br;function ci(_t,St){return qt(Br(_t,St))}y.lengthToDegrees=ci;function Nt(_t){var St=_t%360;return St<0&&(St+=360),St}y.bearingToAzimuth=Nt;function qt(_t){var St=_t%(2*Math.PI);return St*180/Math.PI}y.radiansToDegrees=qt;function gn(_t){var St=_t%360;return St*Math.PI/180}y.degreesToRadians=gn;function Gn(_t,St,Lt){if(St===void 0&&(St="kilometers"),Lt===void 0&&(Lt="kilometers"),!(_t>=0))throw new Error("length must be a positive number");return Ir(Br(_t,St),Lt)}y.convertLength=Gn;function Mn(_t,St,Lt){if(St===void 0&&(St="meters"),Lt===void 0&&(Lt="kilometers"),!(_t>=0))throw new Error("area must be a positive number");var sn=y.areaFactors[St];if(!sn)throw new Error("invalid original units");var E=y.areaFactors[Lt];if(!E)throw new Error("invalid final units");return _t/sn*E}y.convertArea=Mn;function Bn(_t){return!isNaN(_t)&&_t!==null&&!Array.isArray(_t)}y.isNumber=Bn;function Ge(_t){return!!_t&&_t.constructor===Object}y.isObject=Ge;function at(_t){if(!_t)throw new Error("bbox is required");if(!Array.isArray(_t))throw new Error("bbox must be an Array");if(_t.length!==4&&_t.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");_t.forEach(function(St){if(!Bn(St))throw new Error("bbox must only contain numbers")})}y.validateBBox=at;function mt(_t){if(!_t)throw new Error("id is required");if(["string","number"].indexOf(typeof _t)===-1)throw new Error("id must be a number or a string")}y.validateId=mt}),Xu=a(y=>{Object.defineProperty(y,"__esModule",{value:!0});var S=Di();function I(qt,gn,Gn){if(qt!==null)for(var Mn,Bn,Ge,at,mt,_t,St,Lt=0,sn=0,E,s=qt.type,c=s==="FeatureCollection",g=s==="Feature",x=c?qt.features.length:1,A=0;A<x;A++){St=c?qt.features[A].geometry:g?qt.geometry:qt,E=St?St.type==="GeometryCollection":!1,mt=E?St.geometries.length:1;for(var N=0;N<mt;N++){var $=0,Z=0;if(at=E?St.geometries[N]:St,at!==null){_t=at.coordinates;var re=at.type;switch(Lt=Gn&&(re==="Polygon"||re==="MultiPolygon")?1:0,re){case null:break;case"Point":if(gn(_t,sn,A,$,Z)===!1)return!1;sn++,$++;break;case"LineString":case"MultiPoint":for(Mn=0;Mn<_t.length;Mn++){if(gn(_t[Mn],sn,A,$,Z)===!1)return!1;sn++,re==="MultiPoint"&&$++}re==="LineString"&&$++;break;case"Polygon":case"MultiLineString":for(Mn=0;Mn<_t.length;Mn++){for(Bn=0;Bn<_t[Mn].length-Lt;Bn++){if(gn(_t[Mn][Bn],sn,A,$,Z)===!1)return!1;sn++}re==="MultiLineString"&&$++,re==="Polygon"&&Z++}re==="Polygon"&&$++;break;case"MultiPolygon":for(Mn=0;Mn<_t.length;Mn++){for(Z=0,Bn=0;Bn<_t[Mn].length;Bn++){for(Ge=0;Ge<_t[Mn][Bn].length-Lt;Ge++){if(gn(_t[Mn][Bn][Ge],sn,A,$,Z)===!1)return!1;sn++}Z++}$++}break;case"GeometryCollection":for(Mn=0;Mn<at.geometries.length;Mn++)if(I(at.geometries[Mn],gn,Gn)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function F(qt,gn,Gn,Mn){var Bn=Gn;return I(qt,function(Ge,at,mt,_t,St){at===0&&Gn===void 0?Bn=Ge:Bn=gn(Bn,Ge,at,mt,_t,St)},Mn),Bn}function G(qt,gn){var Gn;switch(qt.type){case"FeatureCollection":for(Gn=0;Gn<qt.features.length&&gn(qt.features[Gn].properties,Gn)!==!1;Gn++);break;case"Feature":gn(qt.properties,0);break}}function te(qt,gn,Gn){var Mn=Gn;return G(qt,function(Bn,Ge){Ge===0&&Gn===void 0?Mn=Bn:Mn=gn(Mn,Bn,Ge)}),Mn}function pe(qt,gn){if(qt.type==="Feature")gn(qt,0);else if(qt.type==="FeatureCollection")for(var Gn=0;Gn<qt.features.length&&gn(qt.features[Gn],Gn)!==!1;Gn++);}function xe(qt,gn,Gn){var Mn=Gn;return pe(qt,function(Bn,Ge){Ge===0&&Gn===void 0?Mn=Bn:Mn=gn(Mn,Bn,Ge)}),Mn}function Fe(qt){var gn=[];return I(qt,function(Gn){gn.push(Gn)}),gn}function tt(qt,gn){var Gn,Mn,Bn,Ge,at,mt,_t,St,Lt,sn,E=0,s=qt.type==="FeatureCollection",c=qt.type==="Feature",g=s?qt.features.length:1;for(Gn=0;Gn<g;Gn++){for(mt=s?qt.features[Gn].geometry:c?qt.geometry:qt,St=s?qt.features[Gn].properties:c?qt.properties:{},Lt=s?qt.features[Gn].bbox:c?qt.bbox:void 0,sn=s?qt.features[Gn].id:c?qt.id:void 0,_t=mt?mt.type==="GeometryCollection":!1,at=_t?mt.geometries.length:1,Bn=0;Bn<at;Bn++){if(Ge=_t?mt.geometries[Bn]:mt,Ge===null){if(gn(null,E,St,Lt,sn)===!1)return!1;continue}switch(Ge.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(gn(Ge,E,St,Lt,sn)===!1)return!1;break}case"GeometryCollection":{for(Mn=0;Mn<Ge.geometries.length;Mn++)if(gn(Ge.geometries[Mn],E,St,Lt,sn)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}E++}}function zt(qt,gn,Gn){var Mn=Gn;return tt(qt,function(Bn,Ge,at,mt,_t){Ge===0&&Gn===void 0?Mn=Bn:Mn=gn(Mn,Bn,Ge,at,mt,_t)}),Mn}function bt(qt,gn){tt(qt,function(Gn,Mn,Bn,Ge,at){var mt=Gn===null?null:Gn.type;switch(mt){case null:case"Point":case"LineString":case"Polygon":return gn(S.feature(Gn,Bn,{bbox:Ge,id:at}),Mn,0)===!1?!1:void 0}var _t;switch(mt){case"MultiPoint":_t="Point";break;case"MultiLineString":_t="LineString";break;case"MultiPolygon":_t="Polygon";break}for(var St=0;St<Gn.coordinates.length;St++){var Lt=Gn.coordinates[St],sn={type:_t,coordinates:Lt};if(gn(S.feature(sn,Bn),Mn,St)===!1)return!1}})}function dn(qt,gn,Gn){var Mn=Gn;return bt(qt,function(Bn,Ge,at){Ge===0&&at===0&&Gn===void 0?Mn=Bn:Mn=gn(Mn,Bn,Ge,at)}),Mn}function zn(qt,gn){bt(qt,function(Gn,Mn,Bn){var Ge=0;if(Gn.geometry){var at=Gn.geometry.type;if(!(at==="Point"||at==="MultiPoint")){var mt,_t=0,St=0,Lt=0;if(I(Gn,function(sn,E,s,c,g){if(mt===void 0||Mn>_t||c>St||g>Lt){mt=sn,_t=Mn,St=c,Lt=g,Ge=0;return}var x=S.lineString([mt,sn],Gn.properties);if(gn(x,Mn,Bn,g,Ge)===!1)return!1;Ge++,mt=sn})===!1)return!1}}})}function hr(qt,gn,Gn){var Mn=Gn,Bn=!1;return zn(qt,function(Ge,at,mt,_t,St){Bn===!1&&Gn===void 0?Mn=Ge:Mn=gn(Mn,Ge,at,mt,_t,St),Bn=!0}),Mn}function Ir(qt,gn){if(!qt)throw new Error("geojson is required");bt(qt,function(Gn,Mn,Bn){if(Gn.geometry!==null){var Ge=Gn.geometry.type,at=Gn.geometry.coordinates;switch(Ge){case"LineString":if(gn(Gn,Mn,Bn,0,0)===!1)return!1;break;case"Polygon":for(var mt=0;mt<at.length;mt++)if(gn(S.lineString(at[mt],Gn.properties),Mn,Bn,mt)===!1)return!1;break}}})}function Br(qt,gn,Gn){var Mn=Gn;return Ir(qt,function(Bn,Ge,at,mt){Ge===0&&Gn===void 0?Mn=Bn:Mn=gn(Mn,Bn,Ge,at,mt)}),Mn}function ci(qt,gn){if(gn=gn||{},!S.isObject(gn))throw new Error("options is invalid");var Gn=gn.featureIndex||0,Mn=gn.multiFeatureIndex||0,Bn=gn.geometryIndex||0,Ge=gn.segmentIndex||0,at=gn.properties,mt;switch(qt.type){case"FeatureCollection":Gn<0&&(Gn=qt.features.length+Gn),at=at||qt.features[Gn].properties,mt=qt.features[Gn].geometry;break;case"Feature":at=at||qt.properties,mt=qt.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":mt=qt;break;default:throw new Error("geojson is invalid")}if(mt===null)return null;var _t=mt.coordinates;switch(mt.type){case"Point":case"MultiPoint":return null;case"LineString":return Ge<0&&(Ge=_t.length+Ge-1),S.lineString([_t[Ge],_t[Ge+1]],at,gn);case"Polygon":return Bn<0&&(Bn=_t.length+Bn),Ge<0&&(Ge=_t[Bn].length+Ge-1),S.lineString([_t[Bn][Ge],_t[Bn][Ge+1]],at,gn);case"MultiLineString":return Mn<0&&(Mn=_t.length+Mn),Ge<0&&(Ge=_t[Mn].length+Ge-1),S.lineString([_t[Mn][Ge],_t[Mn][Ge+1]],at,gn);case"MultiPolygon":return Mn<0&&(Mn=_t.length+Mn),Bn<0&&(Bn=_t[Mn].length+Bn),Ge<0&&(Ge=_t[Mn][Bn].length-Ge-1),S.lineString([_t[Mn][Bn][Ge],_t[Mn][Bn][Ge+1]],at,gn)}throw new Error("geojson is invalid")}function Nt(qt,gn){if(gn=gn||{},!S.isObject(gn))throw new Error("options is invalid");var Gn=gn.featureIndex||0,Mn=gn.multiFeatureIndex||0,Bn=gn.geometryIndex||0,Ge=gn.coordIndex||0,at=gn.properties,mt;switch(qt.type){case"FeatureCollection":Gn<0&&(Gn=qt.features.length+Gn),at=at||qt.features[Gn].properties,mt=qt.features[Gn].geometry;break;case"Feature":at=at||qt.properties,mt=qt.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":mt=qt;break;default:throw new Error("geojson is invalid")}if(mt===null)return null;var _t=mt.coordinates;switch(mt.type){case"Point":return S.point(_t,at,gn);case"MultiPoint":return Mn<0&&(Mn=_t.length+Mn),S.point(_t[Mn],at,gn);case"LineString":return Ge<0&&(Ge=_t.length+Ge),S.point(_t[Ge],at,gn);case"Polygon":return Bn<0&&(Bn=_t.length+Bn),Ge<0&&(Ge=_t[Bn].length+Ge),S.point(_t[Bn][Ge],at,gn);case"MultiLineString":return Mn<0&&(Mn=_t.length+Mn),Ge<0&&(Ge=_t[Mn].length+Ge),S.point(_t[Mn][Ge],at,gn);case"MultiPolygon":return Mn<0&&(Mn=_t.length+Mn),Bn<0&&(Bn=_t[Mn].length+Bn),Ge<0&&(Ge=_t[Mn][Bn].length-Ge),S.point(_t[Mn][Bn][Ge],at,gn)}throw new Error("geojson is invalid")}y.coordAll=Fe,y.coordEach=I,y.coordReduce=F,y.featureEach=pe,y.featureReduce=xe,y.findPoint=Nt,y.findSegment=ci,y.flattenEach=bt,y.flattenReduce=dn,y.geomEach=tt,y.geomReduce=zt,y.lineEach=Ir,y.lineReduce=Br,y.propEach=G,y.propReduce=te,y.segmentEach=zn,y.segmentReduce=hr}),lu=a(y=>{Object.defineProperty(y,"__esModule",{value:!0});var S=Xu();function I(F){var G=[1/0,1/0,-1/0,-1/0];return S.coordEach(F,function(te){G[0]>te[0]&&(G[0]=te[0]),G[1]>te[1]&&(G[1]=te[1]),G[2]<te[0]&&(G[2]=te[0]),G[3]<te[1]&&(G[3]=te[1])}),G}I.default=I,y.default=I}),gl=a((y,S)=>{var I=ds(),F=Di(),G=Xu(),te=lu().default,pe=G.featureEach;G.coordEach,F.polygon;var xe=F.featureCollection;function Fe(tt){var zt=new I(tt);return zt.insert=function(bt){if(bt.type!=="Feature")throw new Error("invalid feature");return bt.bbox=bt.bbox?bt.bbox:te(bt),I.prototype.insert.call(this,bt)},zt.load=function(bt){var dn=[];return Array.isArray(bt)?bt.forEach(function(zn){if(zn.type!=="Feature")throw new Error("invalid features");zn.bbox=zn.bbox?zn.bbox:te(zn),dn.push(zn)}):pe(bt,function(zn){if(zn.type!=="Feature")throw new Error("invalid features");zn.bbox=zn.bbox?zn.bbox:te(zn),dn.push(zn)}),I.prototype.load.call(this,dn)},zt.remove=function(bt,dn){if(bt.type!=="Feature")throw new Error("invalid feature");return bt.bbox=bt.bbox?bt.bbox:te(bt),I.prototype.remove.call(this,bt,dn)},zt.clear=function(){return I.prototype.clear.call(this)},zt.search=function(bt){var dn=I.prototype.search.call(this,this.toBBox(bt));return xe(dn)},zt.collides=function(bt){return I.prototype.collides.call(this,this.toBBox(bt))},zt.all=function(){var bt=I.prototype.all.call(this);return xe(bt)},zt.toJSON=function(){return I.prototype.toJSON.call(this)},zt.fromJSON=function(bt){return I.prototype.fromJSON.call(this,bt)},zt.toBBox=function(bt){var dn;if(bt.bbox)dn=bt.bbox;else if(Array.isArray(bt)&&bt.length===4)dn=bt;else if(Array.isArray(bt)&&bt.length===6)dn=[bt[0],bt[1],bt[3],bt[4]];else if(bt.type==="Feature")dn=te(bt);else if(bt.type==="FeatureCollection")dn=te(bt);else throw new Error("invalid geojson");return{minX:dn[0],minY:dn[1],maxX:dn[2],maxY:dn[3]}},zt}S.exports=Fe,S.exports.default=Fe});Array.prototype.findIndex=Array.prototype.findIndex||function(y){if(this===null)throw new TypeError("Array.prototype.findIndex called on null or undefined");if(typeof y!="function")throw new TypeError("callback must be a function");for(var S=Object(this),I=S.length>>>0,F=arguments[1],G=0;G<I;G++)if(y.call(F,S[G],G,S))return G;return-1},Array.prototype.find=Array.prototype.find||function(y){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof y!="function")throw new TypeError("callback must be a function");for(var S=Object(this),I=S.length>>>0,F=arguments[1],G=0;G<I;G++){var te=S[G];if(y.call(F,te,G,S))return te}},typeof Object.assign!="function"&&(Object.assign=function(y){if(y==null)throw new TypeError("Cannot convert undefined or null to object");y=Object(y);for(var S=1;S<arguments.length;S++){var I=arguments[S];if(I!=null)for(var F in I)Object.prototype.hasOwnProperty.call(I,F)&&(y[F]=I[F])}return y}),function(y){y.forEach(function(S){S.hasOwnProperty("remove")||Object.defineProperty(S,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})}([Element.prototype,CharacterData.prototype,DocumentType.prototype]),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(y,S){if(this==null)throw new TypeError('"this" is null or not defined');var I=Object(this),F=I.length>>>0;if(F===0)return!1;var G=S|0,te=Math.max(G>=0?G:F-Math.abs(G),0);function pe(xe,Fe){return xe===Fe||typeof xe=="number"&&typeof Fe=="number"&&isNaN(xe)&&isNaN(Fe)}for(;te<F;){if(pe(I[te],y))return!0;te++}return!1}});var Ju={version:"2.18.3"},ki=f(Li()),is={tooltips:{placeMarker:"Click to place marker",firstVertex:"Click to place first vertex",continueLine:"Click to continue drawing",finishLine:"Click any existing marker to finish",finishPoly:"Click first marker to finish",finishRect:"Click to finish",startCircle:"Click to place circle center",finishCircle:"Click to finish circle",placeCircleMarker:"Click to place circle marker",placeText:"Click to place text",selectFirstLayerFor:"Select first layer for {action}",selectSecondLayerFor:"Select second layer for {action}"},actions:{finish:"Finish",cancel:"Cancel",removeLastVertex:"Remove Last Vertex"},buttonTitles:{drawMarkerButton:"Draw Marker",drawPolyButton:"Draw Polygons",drawLineButton:"Draw Polyline",drawCircleButton:"Draw Circle",drawRectButton:"Draw Rectangle",editButton:"Edit Layers",dragButton:"Drag Layers",cutButton:"Cut Layers",deleteButton:"Remove Layers",drawCircleMarkerButton:"Draw Circle Marker",snappingButton:"Snap dragged marker to other layers and vertices",pinningButton:"Pin shared vertices together",rotateButton:"Rotate Layers",drawTextButton:"Draw Text",scaleButton:"Scale Layers",autoTracingButton:"Auto trace Line",snapGuidesButton:"Show SnapGuides",unionButton:"Union layers",differenceButton:"Subtract layers"},measurements:{totalLength:"Length",segmentLength:"Segment length",area:"Area",radius:"Radius",perimeter:"Perimeter",height:"Height",width:"Width",coordinates:"Position",coordinatesMarker:"Position Marker"}},Ua={tooltips:{placeMarker:"Platziere den Marker mit Klick",firstVertex:"Platziere den ersten Marker mit Klick",continueLine:"Klicke, um weiter zu zeichnen",finishLine:"Beende mit Klick auf existierenden Marker",finishPoly:"Beende mit Klick auf ersten Marker",finishRect:"Beende mit Klick",startCircle:"Platziere das Kreiszentrum mit Klick",finishCircle:"Beende den Kreis mit Klick",placeCircleMarker:"Platziere den Kreismarker mit Klick",placeText:"Platziere den Text mit Klick"},actions:{finish:"Beenden",cancel:"Abbrechen",removeLastVertex:"Letzten Vertex löschen"},buttonTitles:{drawMarkerButton:"Marker zeichnen",drawPolyButton:"Polygon zeichnen",drawLineButton:"Polyline zeichnen",drawCircleButton:"Kreis zeichnen",drawRectButton:"Rechteck zeichnen",editButton:"Layer editieren",dragButton:"Layer bewegen",cutButton:"Layer schneiden",deleteButton:"Layer löschen",drawCircleMarkerButton:"Kreismarker zeichnen",snappingButton:"Bewegter Layer an andere Layer oder Vertexe einhacken",pinningButton:"Vertexe an der gleichen Position verknüpfen",rotateButton:"Layer drehen",drawTextButton:"Text zeichnen",scaleButton:"Layer skalieren",autoTracingButton:"Linie automatisch nachzeichen"},measurements:{totalLength:"Länge",segmentLength:"Segment Länge",area:"Fläche",radius:"Radius",perimeter:"Umfang",height:"Höhe",width:"Breite",coordinates:"Position",coordinatesMarker:"Position Marker"}},Bo={tooltips:{placeMarker:"Clicca per posizionare un Marker",firstVertex:"Clicca per posizionare il primo vertice",continueLine:"Clicca per continuare a disegnare",finishLine:"Clicca qualsiasi marker esistente per terminare",finishPoly:"Clicca il primo marker per terminare",finishRect:"Clicca per terminare",startCircle:"Clicca per posizionare il punto centrale del cerchio",finishCircle:"Clicca per terminare il cerchio",placeCircleMarker:"Clicca per posizionare un Marker del cherchio"},actions:{finish:"Termina",cancel:"Annulla",removeLastVertex:"Rimuovi l'ultimo vertice"},buttonTitles:{drawMarkerButton:"Disegna Marker",drawPolyButton:"Disegna Poligoni",drawLineButton:"Disegna Polilinea",drawCircleButton:"Disegna Cerchio",drawRectButton:"Disegna Rettangolo",editButton:"Modifica Livelli",dragButton:"Sposta Livelli",cutButton:"Ritaglia Livelli",deleteButton:"Elimina Livelli",drawCircleMarkerButton:"Disegna Marker del Cerchio",snappingButton:"Snap ha trascinato il pennarello su altri strati e vertici",pinningButton:"Pin condiviso vertici insieme",rotateButton:"Ruota livello"}},Co={tooltips:{placeMarker:"Klik untuk menempatkan marker",firstVertex:"Klik untuk menempatkan vertex pertama",continueLine:"Klik untuk meneruskan digitasi",finishLine:"Klik pada sembarang marker yang ada untuk mengakhiri",finishPoly:"Klik marker pertama untuk mengakhiri",finishRect:"Klik untuk mengakhiri",startCircle:"Klik untuk menempatkan titik pusat lingkaran",finishCircle:"Klik untuk mengakhiri lingkaran",placeCircleMarker:"Klik untuk menempatkan penanda lingkarann"},actions:{finish:"Selesai",cancel:"Batal",removeLastVertex:"Hilangkan Vertex Terakhir"},buttonTitles:{drawMarkerButton:"Digitasi Marker",drawPolyButton:"Digitasi Polygon",drawLineButton:"Digitasi Polyline",drawCircleButton:"Digitasi Lingkaran",drawRectButton:"Digitasi Segi Empat",editButton:"Edit Layer",dragButton:"Geser Layer",cutButton:"Potong Layer",deleteButton:"Hilangkan Layer",drawCircleMarkerButton:"Digitasi Penanda Lingkaran",snappingButton:"Jepretkan penanda yang ditarik ke lapisan dan simpul lain",pinningButton:"Sematkan simpul bersama bersama",rotateButton:"Putar lapisan"}},ku={tooltips:{placeMarker:"Adaugă un punct",firstVertex:"Apasă aici pentru a adăuga primul Vertex",continueLine:"Apasă aici pentru a continua desenul",finishLine:"Apasă pe orice obiect pentru a finisa desenul",finishPoly:"Apasă pe primul obiect pentru a finisa",finishRect:"Apasă pentru a finisa",startCircle:"Apasă pentru a desena un cerc",finishCircle:"Apasă pentru a finisa un cerc",placeCircleMarker:"Adaugă un punct"},actions:{finish:"Termină",cancel:"Anulează",removeLastVertex:"Șterge ultimul Vertex"},buttonTitles:{drawMarkerButton:"Adaugă o bulină",drawPolyButton:"Desenează un poligon",drawLineButton:"Desenează o linie",drawCircleButton:"Desenează un cerc",drawRectButton:"Desenează un dreptunghi",editButton:"Editează straturile",dragButton:"Mută straturile",cutButton:"Taie straturile",deleteButton:"Șterge straturile",drawCircleMarkerButton:"Desenează marcatorul cercului",snappingButton:"Fixați marcatorul glisat pe alte straturi și vârfuri",pinningButton:"Fixați vârfurile partajate împreună",rotateButton:"Rotiți stratul"}},yl={tooltips:{placeMarker:"Нажмите, чтобы нанести маркер",firstVertex:"Нажмите, чтобы нанести первый объект",continueLine:"Нажмите, чтобы продолжить рисование",finishLine:"Нажмите любой существующий маркер для завершения",finishPoly:"Выберите первую точку, чтобы закончить",finishRect:"Нажмите, чтобы закончить",startCircle:"Нажмите, чтобы добавить центр круга",finishCircle:"Нажмите, чтобы задать радиус",placeCircleMarker:"Нажмите, чтобы нанести круговой маркер"},actions:{finish:"Завершить",cancel:"Отменить",removeLastVertex:"Отменить последнее действие"},buttonTitles:{drawMarkerButton:"Добавить маркер",drawPolyButton:"Рисовать полигон",drawLineButton:"Рисовать кривую",drawCircleButton:"Рисовать круг",drawRectButton:"Рисовать прямоугольник",editButton:"Редактировать слой",dragButton:"Перенести слой",cutButton:"Вырезать слой",deleteButton:"Удалить слой",drawCircleMarkerButton:"Добавить круговой маркер",snappingButton:"Привязать перетаскиваемый маркер к другим слоям и вершинам",pinningButton:"Связать общие точки вместе",rotateButton:"Поворот слоя"}},uu={tooltips:{placeMarker:"Presiona para colocar un marcador",firstVertex:"Presiona para colocar el primer vértice",continueLine:"Presiona para continuar dibujando",finishLine:"Presiona cualquier marcador existente para finalizar",finishPoly:"Presiona el primer marcador para finalizar",finishRect:"Presiona para finalizar",startCircle:"Presiona para colocar el centro del círculo",finishCircle:"Presiona para finalizar el círculo",placeCircleMarker:"Presiona para colocar un marcador de círculo"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Eliminar último vértice"},buttonTitles:{drawMarkerButton:"Dibujar Marcador",drawPolyButton:"Dibujar Polígono",drawLineButton:"Dibujar Línea",drawCircleButton:"Dibujar Círculo",drawRectButton:"Dibujar Rectángulo",editButton:"Editar Capas",dragButton:"Arrastrar Capas",cutButton:"Cortar Capas",deleteButton:"Eliminar Capas",drawCircleMarkerButton:"Dibujar Marcador de Círculo",snappingButton:"El marcador de Snap arrastrado a otras capas y vértices",pinningButton:"Fijar juntos los vértices compartidos",rotateButton:"Rotar capa"}},lo={tooltips:{placeMarker:"Klik om een marker te plaatsen",firstVertex:"Klik om het eerste punt te plaatsen",continueLine:"Klik om te blijven tekenen",finishLine:"Klik op een bestaand punt om te beëindigen",finishPoly:"Klik op het eerst punt om te beëindigen",finishRect:"Klik om te beëindigen",startCircle:"Klik om het middelpunt te plaatsen",finishCircle:"Klik om de cirkel te beëindigen",placeCircleMarker:"Klik om een marker te plaatsen"},actions:{finish:"Bewaar",cancel:"Annuleer",removeLastVertex:"Verwijder laatste punt"},buttonTitles:{drawMarkerButton:"Plaats Marker",drawPolyButton:"Teken een vlak",drawLineButton:"Teken een lijn",drawCircleButton:"Teken een cirkel",drawRectButton:"Teken een vierkant",editButton:"Bewerk",dragButton:"Verplaats",cutButton:"Knip",deleteButton:"Verwijder",drawCircleMarkerButton:"Plaats Marker",snappingButton:"Snap gesleepte marker naar andere lagen en hoekpunten",pinningButton:"Speld gedeelde hoekpunten samen",rotateButton:"Laag roteren"}},So={tooltips:{placeMarker:"Cliquez pour placer un marqueur",firstVertex:"Cliquez pour placer le premier sommet",continueLine:"Cliquez pour continuer à dessiner",finishLine:"Cliquez sur n'importe quel marqueur pour terminer",finishPoly:"Cliquez sur le premier marqueur pour terminer",finishRect:"Cliquez pour terminer",startCircle:"Cliquez pour placer le centre du cercle",finishCircle:"Cliquez pour finir le cercle",placeCircleMarker:"Cliquez pour placer le marqueur circulaire"},actions:{finish:"Terminer",cancel:"Annuler",removeLastVertex:"Retirer le dernier sommet"},buttonTitles:{drawMarkerButton:"Placer des marqueurs",drawPolyButton:"Dessiner des polygones",drawLineButton:"Dessiner des polylignes",drawCircleButton:"Dessiner un cercle",drawRectButton:"Dessiner un rectangle",editButton:"Éditer des calques",dragButton:"Déplacer des calques",cutButton:"Couper des calques",deleteButton:"Supprimer des calques",drawCircleMarkerButton:"Dessiner un marqueur circulaire",snappingButton:"Glisser le marqueur vers d'autres couches et sommets",pinningButton:"Épingler ensemble les sommets partagés",rotateButton:"Tourner des calques"}},tl={tooltips:{placeMarker:"单击放置标记",firstVertex:"单击放置首个顶点",continueLine:"单击继续绘制",finishLine:"单击任何存在的标记以完成",finishPoly:"单击第一个标记以完成",finishRect:"单击完成",startCircle:"单击放置圆心",finishCircle:"单击完成圆形",placeCircleMarker:"点击放置圆形标记"},actions:{finish:"完成",cancel:"取消",removeLastVertex:"移除最后的顶点"},buttonTitles:{drawMarkerButton:"绘制标记",drawPolyButton:"绘制多边形",drawLineButton:"绘制线段",drawCircleButton:"绘制圆形",drawRectButton:"绘制长方形",editButton:"编辑图层",dragButton:"拖拽图层",cutButton:"剪切图层",deleteButton:"删除图层",drawCircleMarkerButton:"画圆圈标记",snappingButton:"将拖动的标记捕捉到其他图层和顶点",pinningButton:"将共享顶点固定在一起",rotateButton:"旋转图层"}},ui={tooltips:{placeMarker:"單擊放置標記",firstVertex:"單擊放置第一個頂點",continueLine:"單擊繼續繪製",finishLine:"單擊任何存在的標記以完成",finishPoly:"單擊第一個標記以完成",finishRect:"單擊完成",startCircle:"單擊放置圓心",finishCircle:"單擊完成圓形",placeCircleMarker:"點擊放置圓形標記"},actions:{finish:"完成",cancel:"取消",removeLastVertex:"移除最後一個頂點"},buttonTitles:{drawMarkerButton:"放置標記",drawPolyButton:"繪製多邊形",drawLineButton:"繪製線段",drawCircleButton:"繪製圓形",drawRectButton:"繪製方形",editButton:"編輯圖形",dragButton:"移動圖形",cutButton:"裁切圖形",deleteButton:"刪除圖形",drawCircleMarkerButton:"畫圓圈標記",snappingButton:"將拖動的標記對齊到其他圖層和頂點",pinningButton:"將共享頂點固定在一起",rotateButton:"旋轉圖形"}},ji={tooltips:{placeMarker:"Clique para posicionar o marcador",firstVertex:"Clique para posicionar o primeiro vértice",continueLine:"Clique para continuar desenhando",finishLine:"Clique em qualquer marcador existente para finalizar",finishPoly:"Clique no primeiro marcador para finalizar",finishRect:"Clique para finalizar",startCircle:"Clique para posicionar o centro do círculo",finishCircle:"Clique para finalizar o círculo",placeCircleMarker:"Clique para posicionar o marcador circular",placeText:"Clique para inserir texto"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Remover último vértice"},buttonTitles:{drawMarkerButton:"Desenhar Marcador",drawPolyButton:"Desenhar Polígonos",drawLineButton:"Desenhar Linha Poligonal",drawCircleButton:"Desenhar Círculo",drawRectButton:"Desenhar Retângulo",editButton:"Editar Camadas",dragButton:"Arrastar Camadas",cutButton:"Recortar Camadas",deleteButton:"Remover Camadas",drawCircleMarkerButton:"Desenhar Marcador de Círculo",snappingButton:"Ajustar marcador arrastado a outras camadas e vértices",pinningButton:"Unir vértices compartilhados",rotateButton:"Rotacionar Camadas",drawTextButton:"Desenhar Texto",scaleButton:"Redimensionar Camadas",autoTracingButton:"Traçado Automático de Linha"},measurements:{totalLength:"Comprimento",segmentLength:"Comprimento do Segmento",area:"Área",radius:"Raio",perimeter:"Perímetro",height:"Altura",width:"Largura",coordinates:"Posição",coordinatesMarker:"Marcador de Posição"}},nl={tooltips:{placeMarker:"Clique para colocar marcador",firstVertex:"Clique para colocar primeiro vértice",continueLine:"Clique para continuar a desenhar",finishLine:"Clique num marcador existente para terminar",finishPoly:"Clique no primeiro marcador para terminar",finishRect:"Clique para terminar",startCircle:"Clique para colocar o centro do círculo",finishCircle:"Clique para terminar o círculo",placeCircleMarker:"Clique para colocar marcador de círculo",placeText:"Clique para colocar texto"},actions:{finish:"Terminar",cancel:"Cancelar",removeLastVertex:"Remover Último Vértice"},buttonTitles:{drawMarkerButton:"Desenhar Marcador",drawPolyButton:"Desenhar Polígonos",drawLineButton:"Desenhar Polilinha",drawCircleButton:"Desenhar Círculo",drawRectButton:"Desenhar Retângulo",editButton:"Editar Camadas",dragButton:"Arrastar Camadas",cutButton:"Cortar Camadas",deleteButton:"Remover Camadas",drawCircleMarkerButton:"Desenhar Marcador de Círculo",snappingButton:"Ajustar marcador arrastado a outras camadas e vértices",pinningButton:"Unir vértices partilhados",rotateButton:"Rodar Camadas",drawTextButton:"Desenhar Texto",scaleButton:"Escalar Camadas",autoTracingButton:"Traçado Automático de Linha"},measurements:{totalLength:"Comprimento",segmentLength:"Comprimento do Segmento",area:"Área",radius:"Raio",perimeter:"Perímetro",height:"Altura",width:"Largura",coordinates:"Posição",coordinatesMarker:"Marcador de Posição"}},rl={tooltips:{placeMarker:"Kliknij, aby umieścić znacznik",firstVertex:"Kliknij, aby umieścić pierwszy wierzchołek",continueLine:"Kliknij, aby kontynuować rysowanie",finishLine:"Kliknij dowolny istniejący znacznik, aby zakończyć",finishPoly:"Kliknij pierwszy znacznik, aby zakończyć",finishRect:"Kliknij, aby zakończyć",startCircle:"Kliknij, aby umieścić środek okręgu",finishCircle:"Kliknij, aby zakończyć okrąg",placeCircleMarker:"Kliknij, aby umieścić znacznik okręgu",placeText:"Kliknij, aby umieścić tekst"},actions:{finish:"Zakończ",cancel:"Anuluj",removeLastVertex:"Usuń ostatni wierzchołek"},buttonTitles:{drawMarkerButton:"Rysuj znacznik",drawPolyButton:"Rysuj wielokąt",drawLineButton:"Rysuj linię",drawCircleButton:"Rysuj okrąg",drawRectButton:"Rysuj prostokąt",editButton:"Edytuj warstwy",dragButton:"Przeciągnij warstwy",cutButton:"Wytnij warstwy",deleteButton:"Usuń warstwy",drawCircleMarkerButton:"Rysuj znacznik okrągły",snappingButton:"Przyciągnij przenoszony znacznik do innych warstw i wierzchołków",pinningButton:"Przypnij wspólne wierzchołki razem",rotateButton:"Obróć warstwy",drawTextButton:"Rysuj tekst",scaleButton:"Skaluj warstwy",autoTracingButton:"Automatyczne śledzenie linii"},measurements:{totalLength:"Długość",segmentLength:"Długość odcinka",area:"Obszar",radius:"Promień",perimeter:"Obwód",height:"Wysokość",width:"Szerokość",coordinates:"Pozycja",coordinatesMarker:"Znacznik pozycji"}},Ws={tooltips:{placeMarker:"Klicka för att placera markör",firstVertex:"Klicka för att placera första hörnet",continueLine:"Klicka för att fortsätta rita",finishLine:"Klicka på en existerande punkt för att slutföra",finishPoly:"Klicka på den första punkten för att slutföra",finishRect:"Klicka för att slutföra",startCircle:"Klicka för att placera cirkelns centrum",finishCircle:"Klicka för att slutföra cirkeln",placeCircleMarker:"Klicka för att placera cirkelmarkör"},actions:{finish:"Slutför",cancel:"Avbryt",removeLastVertex:"Ta bort sista hörnet"},buttonTitles:{drawMarkerButton:"Rita Markör",drawPolyButton:"Rita Polygoner",drawLineButton:"Rita Linje",drawCircleButton:"Rita Cirkel",drawRectButton:"Rita Rektangel",editButton:"Redigera Lager",dragButton:"Dra Lager",cutButton:"Klipp i Lager",deleteButton:"Ta bort Lager",drawCircleMarkerButton:"Rita Cirkelmarkör",snappingButton:"Snäpp dra markören till andra lager och hörn",pinningButton:"Fäst delade hörn tillsammans",rotateButton:"Rotera lagret"}},Zs={tooltips:{placeMarker:"Κάντε κλικ για να τοποθετήσετε Δείκτη",firstVertex:"Κάντε κλικ για να τοποθετήσετε το πρώτο σημείο",continueLine:"Κάντε κλικ για να συνεχίσετε να σχεδιάζετε",finishLine:"Κάντε κλικ σε οποιονδήποτε υπάρχον σημείο για να ολοκληρωθεί",finishPoly:"Κάντε κλικ στο πρώτο σημείο για να τελειώσετε",finishRect:"Κάντε κλικ για να τελειώσετε",startCircle:"Κάντε κλικ για να τοποθετήσετε κέντρο Κύκλου",finishCircle:"Κάντε κλικ για να ολοκληρώσετε τον Κύκλο",placeCircleMarker:"Κάντε κλικ για να τοποθετήσετε Κυκλικό Δείκτη"},actions:{finish:"Τέλος",cancel:"Ακύρωση",removeLastVertex:"Κατάργηση τελευταίου σημείου"},buttonTitles:{drawMarkerButton:"Σχεδίαση Δείκτη",drawPolyButton:"Σχεδίαση Πολυγώνου",drawLineButton:"Σχεδίαση Γραμμής",drawCircleButton:"Σχεδίαση Κύκλου",drawRectButton:"Σχεδίαση Ορθογωνίου",editButton:"Επεξεργασία Επιπέδων",dragButton:"Μεταφορά Επιπέδων",cutButton:"Αποκοπή Επιπέδων",deleteButton:"Κατάργηση Επιπέδων",drawCircleMarkerButton:"Σχεδίαση Κυκλικού Δείκτη",snappingButton:"Προσκόλληση του Δείκτη μεταφοράς σε άλλα Επίπεδα και Κορυφές",pinningButton:"Περικοπή κοινών κορυφών μαζί",rotateButton:"Περιστρέψτε το στρώμα"}},Ms={tooltips:{placeMarker:"Kattintson a jelölő elhelyezéséhez",firstVertex:"Kattintson az első pont elhelyezéséhez",continueLine:"Kattintson a következő pont elhelyezéséhez",finishLine:"A befejezéshez kattintson egy meglévő pontra",finishPoly:"A befejezéshez kattintson az első pontra",finishRect:"Kattintson a befejezéshez",startCircle:"Kattintson a kör középpontjának elhelyezéséhez",finishCircle:"Kattintson a kör befejezéséhez",placeCircleMarker:"Kattintson a körjelölő elhelyezéséhez"},actions:{finish:"Befejezés",cancel:"Mégse",removeLastVertex:"Utolsó pont eltávolítása"},buttonTitles:{drawMarkerButton:"Jelölő rajzolása",drawPolyButton:"Poligon rajzolása",drawLineButton:"Vonal rajzolása",drawCircleButton:"Kör rajzolása",drawRectButton:"Négyzet rajzolása",editButton:"Elemek szerkesztése",dragButton:"Elemek mozgatása",cutButton:"Elemek vágása",deleteButton:"Elemek törlése",drawCircleMarkerButton:"Kör jelölő rajzolása",snappingButton:"Kapcsolja a jelöltőt másik elemhez vagy ponthoz",pinningButton:"Közös pontok összekötése",rotateButton:"Fólia elforgatása"}},cu={tooltips:{placeMarker:"Tryk for at placere en markør",firstVertex:"Tryk for at placere det første punkt",continueLine:"Tryk for at fortsætte linjen",finishLine:"Tryk på et eksisterende punkt for at afslutte",finishPoly:"Tryk på det første punkt for at afslutte",finishRect:"Tryk for at afslutte",startCircle:"Tryk for at placere cirklens center",finishCircle:"Tryk for at afslutte cirklen",placeCircleMarker:"Tryk for at placere en cirkelmarkør"},actions:{finish:"Afslut",cancel:"Afbryd",removeLastVertex:"Fjern sidste punkt"},buttonTitles:{drawMarkerButton:"Placer markør",drawPolyButton:"Tegn polygon",drawLineButton:"Tegn linje",drawCircleButton:"Tegn cirkel",drawRectButton:"Tegn firkant",editButton:"Rediger",dragButton:"Træk",cutButton:"Klip",deleteButton:"Fjern",drawCircleMarkerButton:"Tegn cirkelmarkør",snappingButton:"Fastgør trukket markør til andre elementer",pinningButton:"Sammenlæg delte elementer",rotateButton:"Roter laget"}},us={tooltips:{placeMarker:"Klikk for å plassere punkt",firstVertex:"Klikk for å plassere første punkt",continueLine:"Klikk for å tegne videre",finishLine:"Klikk på et eksisterende punkt for å fullføre",finishPoly:"Klikk første punkt for å fullføre",finishRect:"Klikk for å fullføre",startCircle:"Klikk for å sette sirkel midtpunkt",finishCircle:"Klikk for å fullføre sirkel",placeCircleMarker:"Klikk for å plassere sirkel",placeText:"Klikk for å plassere tekst"},actions:{finish:"Fullfør",cancel:"Kanseller",removeLastVertex:"Fjern forrige punkt"},buttonTitles:{drawMarkerButton:"Tegn punkt",drawPolyButton:"Tegn flate",drawLineButton:"Tegn linje",drawCircleButton:"Tegn sirkel",drawRectButton:"Tegn rektangel",editButton:"Rediger objekter",dragButton:"Dra objekter",cutButton:"Kutt objekter",deleteButton:"Fjern objekter",drawCircleMarkerButton:"Tegn sirkel-punkt",snappingButton:"Fest dratt punkt til andre objekter og punkt",pinningButton:"Pin delte punkter sammen",rotateButton:"Rotér objekter",drawTextButton:"Tegn tekst",scaleButton:"Skalér objekter",autoTracingButton:"Automatisk sporing av linje"},measurements:{totalLength:"Lengde",segmentLength:"Segmentlengde",area:"Område",radius:"Radius",perimeter:"Omriss",height:"Høyde",width:"Bredde",coordinates:"Posisjon",coordinatesMarker:"Posisjonsmarkør"}},La={tooltips:{placeMarker:"کلیک برای جانمایی نشان",firstVertex:"کلیک برای رسم اولین رأس",continueLine:"کلیک برای ادامه رسم",finishLine:"کلیک روی هر نشان موجود برای پایان",finishPoly:"کلیک روی اولین نشان برای پایان",finishRect:"کلیک برای پایان",startCircle:"کلیک برای رسم مرکز دایره",finishCircle:"کلیک برای پایان رسم دایره",placeCircleMarker:"کلیک برای رسم نشان دایره",placeText:"کلیک برای نوشتن متن"},actions:{finish:"پایان",cancel:"لفو",removeLastVertex:"حذف آخرین رأس"},buttonTitles:{drawMarkerButton:"درج نشان",drawPolyButton:"رسم چندضلعی",drawLineButton:"رسم خط",drawCircleButton:"رسم دایره",drawRectButton:"رسم چهارضلعی",editButton:"ویرایش لایه‌ها",dragButton:"جابجایی لایه‌ها",cutButton:"برش لایه‌ها",deleteButton:"حذف لایه‌ها",drawCircleMarkerButton:"رسم نشان دایره",snappingButton:"نشانگر را به لایه‌ها و رئوس دیگر بکشید",pinningButton:"رئوس مشترک را با هم پین کنید",rotateButton:"چرخش لایه",drawTextButton:"رسم متن",scaleButton:"مقیاس‌گذاری",autoTracingButton:"ردیاب خودکار"},measurements:{totalLength:"طول",segmentLength:"طول بخش",area:"ناحیه",radius:"شعاع",perimeter:"محیط",height:"ارتفاع",width:"عرض",coordinates:"موقعیت",coordinatesMarker:"موقعیت نشان"}},Lo={tooltips:{placeMarker:"Натисніть, щоб нанести маркер",firstVertex:"Натисніть, щоб нанести першу вершину",continueLine:"Натисніть, щоб продовжити малювати",finishLine:"Натисніть будь-який існуючий маркер для завершення",finishPoly:"Виберіть перший маркер, щоб завершити",finishRect:"Натисніть, щоб завершити",startCircle:"Натисніть, щоб додати центр кола",finishCircle:"Натисніть, щоб завершити коло",placeCircleMarker:"Натисніть, щоб нанести круговий маркер"},actions:{finish:"Завершити",cancel:"Відмінити",removeLastVertex:"Видалити попередню вершину"},buttonTitles:{drawMarkerButton:"Малювати маркер",drawPolyButton:"Малювати полігон",drawLineButton:"Малювати криву",drawCircleButton:"Малювати коло",drawRectButton:"Малювати прямокутник",editButton:"Редагувати шари",dragButton:"Перенести шари",cutButton:"Вирізати шари",deleteButton:"Видалити шари",drawCircleMarkerButton:"Малювати круговий маркер",snappingButton:"Прив’язати перетягнутий маркер до інших шарів та вершин",pinningButton:"Зв'язати спільні вершини разом",rotateButton:"Повернути шар"}},yi={tooltips:{placeMarker:"İşaretçi yerleştirmek için tıklayın",firstVertex:"İlk tepe noktasını yerleştirmek için tıklayın",continueLine:"Çizime devam etmek için tıklayın",finishLine:"Bitirmek için mevcut herhangi bir işaretçiyi tıklayın",finishPoly:"Bitirmek için ilk işaretçiyi tıklayın",finishRect:"Bitirmek için tıklayın",startCircle:"Daire merkezine yerleştirmek için tıklayın",finishCircle:"Daireyi bitirmek için tıklayın",placeCircleMarker:"Daire işaretçisi yerleştirmek için tıklayın"},actions:{finish:"Bitir",cancel:"İptal",removeLastVertex:"Son köşeyi kaldır"},buttonTitles:{drawMarkerButton:"Çizim İşaretçisi",drawPolyButton:"Çokgenler çiz",drawLineButton:"Çoklu çizgi çiz",drawCircleButton:"Çember çiz",drawRectButton:"Dikdörtgen çiz",editButton:"Katmanları düzenle",dragButton:"Katmanları sürükle",cutButton:"Katmanları kes",deleteButton:"Katmanları kaldır",drawCircleMarkerButton:"Daire işaretçisi çiz",snappingButton:"Sürüklenen işaretçiyi diğer katmanlara ve köşelere yapıştır",pinningButton:"Paylaşılan köşeleri birbirine sabitle",rotateButton:"Katmanı döndür"}},Mi={tooltips:{placeMarker:"Kliknutím vytvoříte značku",firstVertex:"Kliknutím vytvoříte první objekt",continueLine:"Kliknutím pokračujte v kreslení",finishLine:"Kliknutí na libovolnou existující značku pro dokončení",finishPoly:"Vyberte první bod pro dokončení",finishRect:"Klikněte pro dokončení",startCircle:"Kliknutím přidejte střed kruhu",finishCircle:"Нажмите, чтобы задать радиус",placeCircleMarker:"Kliknutím nastavte poloměr"},actions:{finish:"Dokončit",cancel:"Zrušit",removeLastVertex:"Zrušit poslední akci"},buttonTitles:{drawMarkerButton:"Přidat značku",drawPolyButton:"Nakreslit polygon",drawLineButton:"Nakreslit křivku",drawCircleButton:"Nakreslit kruh",drawRectButton:"Nakreslit obdélník",editButton:"Upravit vrstvu",dragButton:"Přeneste vrstvu",cutButton:"Vyjmout vrstvu",deleteButton:"Smazat vrstvu",drawCircleMarkerButton:"Přidat kruhovou značku",snappingButton:"Navázat tažnou značku k dalším vrstvám a vrcholům",pinningButton:"Spojit společné body dohromady",rotateButton:"Otočte vrstvu"}},fs={tooltips:{placeMarker:"クリックしてマーカーを配置",firstVertex:"クリックして最初の頂点を配置",continueLine:"クリックして描画を続ける",finishLine:"任意のマーカーをクリックして終了",finishPoly:"最初のマーカーをクリックして終了",finishRect:"クリックして終了",startCircle:"クリックして円の中心を配置",finishCircle:"クリックして円の描画を終了",placeCircleMarker:"クリックして円マーカーを配置",placeText:"クリックしてテキストを配置"},actions:{finish:"終了",cancel:"キャンセル",removeLastVertex:"最後の頂点を削除"},buttonTitles:{drawMarkerButton:"マーカーを描画",drawPolyButton:"ポリゴンを描画",drawLineButton:"折れ線を描画",drawCircleButton:"円を描画",drawRectButton:"矩形を描画",editButton:"レイヤーを編集",dragButton:"レイヤーをドラッグ",cutButton:"レイヤーを切り取り",deleteButton:"レイヤーを削除",drawCircleMarkerButton:"円マーカーを描画",snappingButton:"ドラッグしたマーカーを他のレイヤーや頂点にスナップする",pinningButton:"共有する頂点を同時に動かす",rotateButton:"レイヤーを回転",drawTextButton:"テキストを描画"}},Bi={tooltips:{placeMarker:"Klikkaa asettaaksesi merkin",firstVertex:"Klikkaa asettaakseni ensimmäisen osuuden",continueLine:"Klikkaa jatkaaksesi piirtämistä",finishLine:"Klikkaa olemassa olevaa merkkiä lopettaaksesi",finishPoly:"Klikkaa ensimmäistä merkkiä lopettaaksesi",finishRect:"Klikkaa lopettaaksesi",startCircle:"Klikkaa asettaaksesi ympyrän keskipisteen",finishCircle:"Klikkaa lopettaaksesi ympyrän",placeCircleMarker:"Klikkaa asettaaksesi ympyrämerkin",placeText:"Klikkaa asettaaksesi tekstin"},actions:{finish:"Valmis",cancel:"Peruuta",removeLastVertex:"Poista viimeinen osuus"},buttonTitles:{drawMarkerButton:"Piirrä merkkejä",drawPolyButton:"Piirrä monikulmioita",drawLineButton:"Piirrä viivoja",drawCircleButton:"Piirrä ympyrä",drawRectButton:"Piirrä neliskulmioita",editButton:"Muokkaa",dragButton:"Siirrä",cutButton:"Leikkaa",deleteButton:"Poista",drawCircleMarkerButton:"Piirrä ympyrämerkki",snappingButton:"Kiinnitä siirrettävä merkki toisiin muotoihin",pinningButton:"Kiinnitä jaetut muodot yhteen",rotateButton:"Käännä",drawTextButton:"Piirrä tekstiä"}},Bl={tooltips:{placeMarker:"마커 위치를 클릭하세요",firstVertex:"첫번째 꼭지점 위치을 클릭하세요",continueLine:"계속 그리려면 클릭하세요",finishLine:"끝내려면 기존 마커를 클릭하세요",finishPoly:"끝내려면 처음 마커를 클릭하세요",finishRect:"끝내려면 클릭하세요",startCircle:"원의 중심이 될 위치를 클릭하세요",finishCircle:"원을 끝내려면 클릭하세요",placeCircleMarker:"원 마커 위치를 클릭하세요",placeText:"텍스트 위치를 클릭하세요"},actions:{finish:"끝내기",cancel:"취소",removeLastVertex:"마지막 꼭지점 제거"},buttonTitles:{drawMarkerButton:"마커 그리기",drawPolyButton:"다각형 그리기",drawLineButton:"다각선 그리기",drawCircleButton:"원 그리기",drawRectButton:"직사각형 그리기",editButton:"레이어 편집하기",dragButton:"레이어 끌기",cutButton:"레이어 자르기",deleteButton:"레이어 제거하기",drawCircleMarkerButton:"원 마커 그리기",snappingButton:"잡아끈 마커를 다른 레이어 및 꼭지점에 들러붙게 하기",pinningButton:"공유 꼭지점을 함께 찍기",rotateButton:"레이어 회전하기",drawTextButton:"텍스트 그리기"}},Nl={tooltips:{placeMarker:"Маркерди жайгаштыруу үчүн басыңыз",firstVertex:"Биринчи чокуну жайгаштырууну үчүн басыңыз",continueLine:"Сүрөт тартууну улантуу үчүн басыңыз",finishLine:"Аяктоо үчүн учурдагы маркерди басыңыз",finishPoly:"Бүтүрүү үчүн биринчи маркерди басыңыз",finishRect:"Бүтүрүү үчүн басыңыз",startCircle:"Айлананын борборун жайгаштырууну үчүн басыңыз",finishCircle:"Айлананы бүтүрүү үчүн басыңыз",placeCircleMarker:"Тегерек маркерди жайгаштыруу үчүн басыңыз",placeText:"Текстти жайгаштыруу үчүн басыңыз"},actions:{finish:"Аягы",cancel:"Жок кылуу",removeLastVertex:"Акыркы чокуну өчүрүү"},buttonTitles:{drawMarkerButton:"Маркерди чизуу",drawPolyButton:"Полигон чизуу",drawLineButton:"Полилиния чизуу",drawCircleButton:"Дайынды чизуу",drawRectButton:"Прямоугольник чизуу",editButton:"Слоопту түзөтүү",dragButton:"Слоопту карап сүйлөү",cutButton:"Слооптун башын кесүү",deleteButton:"Слооптун өчүрүү",drawCircleMarkerButton:"Дайынды маркерди чизуу",snappingButton:"Башка слооптордун жана вертекстердин арасына чекилдөө",pinningButton:"Бөлүшкөн вертекстерди бирге тутуштуруу",rotateButton:"Слооптун өзгөртүү",drawTextButton:"Текст чизуу",scaleButton:"Слооптун өлчөмүн өзгөртүү",autoTracingButton:"Автоматтык тизмеги чизуу"},measurements:{totalLength:"Узундук",segmentLength:"Сегмент узундугу",area:"Аймак",radius:"Радиус",perimeter:"Периметр",height:"Диаметр",width:"Кенчилик",coordinates:"Координаттар",coordinatesMarker:"Маркердин координаттары"}},No=nl,Pa={en:is,de:Ua,it:Bo,id:Co,ro:ku,ru:yl,es:uu,nl:lo,fr:So,pt:No,pt_br:ji,pt_pt:nl,zh:tl,zh_tw:ui,pl:rl,sv:Ws,el:Zs,hu:Ms,da:cu,no:us,fa:La,ua:Lo,tr:yi,cz:Mi,ja:fs,fi:Bi,ko:Bl,ky:Nl},qi={_globalEditModeEnabled:!1,enableGlobalEditMode(y){let S={...y};this._globalEditModeEnabled=!0,this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),L.PM.Utils.findLayers(this.map).forEach(I=>{this._isRelevantForEdit(I)&&I.pm.enable(S)}),this.throttledReInitEdit||(this.throttledReInitEdit=L.Util.throttle(this.handleLayerAdditionInGlobalEditMode,100,this)),this._addedLayersEdit={},this.map.on("layeradd",this._layerAddedEdit,this),this.map.on("layeradd",this.throttledReInitEdit,this),this._fireGlobalEditModeToggled(!0)},disableGlobalEditMode(){this._globalEditModeEnabled=!1,L.PM.Utils.findLayers(this.map).forEach(y=>{y.pm.disable()}),this.map.off("layeradd",this._layerAddedEdit,this),this.map.off("layeradd",this.throttledReInitEdit,this),this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),this._fireGlobalEditModeToggled(!1)},globalEditEnabled(){return this.globalEditModeEnabled()},globalEditModeEnabled(){return this._globalEditModeEnabled},toggleGlobalEditMode(y=this.globalOptions){this.globalEditModeEnabled()?this.disableGlobalEditMode():this.enableGlobalEditMode(y)},handleLayerAdditionInGlobalEditMode(){let y=this._addedLayersEdit;if(this._addedLayersEdit={},this.globalEditModeEnabled())for(let S in y){let I=y[S];this._isRelevantForEdit(I)&&I.pm.enable({...this.globalOptions})}},_layerAddedEdit({layer:y}){this._addedLayersEdit[L.stamp(y)]=y},_isRelevantForEdit(y){return y.pm&&!(y instanceof L.LayerGroup)&&(!L.PM.optIn&&!y.options.pmIgnore||L.PM.optIn&&y.options.pmIgnore===!1)&&!y._pmTempLayer&&y.pm.options.allowEditing}},Sc=qi,Gi={_globalDragModeEnabled:!1,enableGlobalDragMode(){let y=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!0,this._addedLayersDrag={},y.forEach(S=>{this._isRelevantForDrag(S)&&S.pm.enableLayerDrag()}),this.throttledReInitDrag||(this.throttledReInitDrag=L.Util.throttle(this.reinitGlobalDragMode,100,this)),this.map.on("layeradd",this._layerAddedDrag,this),this.map.on("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!0)},disableGlobalDragMode(){let y=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!1,y.forEach(S=>{S.pm.disableLayerDrag()}),this.map.off("layeradd",this._layerAddedDrag,this),this.map.off("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!1)},globalDragModeEnabled(){return!!this._globalDragModeEnabled},toggleGlobalDragMode(){this.globalDragModeEnabled()?this.disableGlobalDragMode():this.enableGlobalDragMode()},reinitGlobalDragMode(){let y=this._addedLayersDrag;if(this._addedLayersDrag={},this.globalDragModeEnabled())for(let S in y){let I=y[S];this._isRelevantForDrag(I)&&I.pm.enableLayerDrag()}},_layerAddedDrag({layer:y}){this._addedLayersDrag[L.stamp(y)]=y},_isRelevantForDrag(y){return y.pm&&!(y instanceof L.LayerGroup)&&(!L.PM.optIn&&!y.options.pmIgnore||L.PM.optIn&&y.options.pmIgnore===!1)&&!y._pmTempLayer&&y.pm.options.draggable}},Nr=Gi,Fi={_globalRemovalModeEnabled:!1,enableGlobalRemovalMode(){this._globalRemovalModeEnabled=!0,this.map.eachLayer(y=>{this._isRelevantForRemoval(y)&&(y.pm.enabled()&&y.pm.disable(),y.on("click",this.removeLayer,this))}),this.throttledReInitRemoval||(this.throttledReInitRemoval=L.Util.throttle(this.handleLayerAdditionInGlobalRemovalMode,100,this)),this._addedLayersRemoval={},this.map.on("layeradd",this._layerAddedRemoval,this),this.map.on("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!0)},disableGlobalRemovalMode(){this._globalRemovalModeEnabled=!1,this.map.eachLayer(y=>{y.off("click",this.removeLayer,this)}),this.map.off("layeradd",this._layerAddedRemoval,this),this.map.off("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!1)},globalRemovalEnabled(){return this.globalRemovalModeEnabled()},globalRemovalModeEnabled(){return!!this._globalRemovalModeEnabled},toggleGlobalRemovalMode(){this.globalRemovalModeEnabled()?this.disableGlobalRemovalMode():this.enableGlobalRemovalMode()},removeLayer(y){let S=y.target;this._isRelevantForRemoval(S)&&!S.pm.dragging()&&(S.removeFrom(this.map.pm._getContainingLayer()),S.remove(),S instanceof L.LayerGroup?(this._fireRemoveLayerGroup(S),this._fireRemoveLayerGroup(this.map,S)):(S.pm._fireRemove(S),S.pm._fireRemove(this.map,S)))},_isRelevantForRemoval(y){return y.pm&&!(y instanceof L.LayerGroup)&&(!L.PM.optIn&&!y.options.pmIgnore||L.PM.optIn&&y.options.pmIgnore===!1)&&!y._pmTempLayer&&y.pm.options.allowRemoval},handleLayerAdditionInGlobalRemovalMode(){let y=this._addedLayersRemoval;if(this._addedLayersRemoval={},this.globalRemovalModeEnabled())for(let S in y){let I=y[S];this._isRelevantForRemoval(I)&&(I.pm.enabled()&&I.pm.disable(),I.on("click",this.removeLayer,this))}},_layerAddedRemoval({layer:y}){this._addedLayersRemoval[L.stamp(y)]=y}},Oi=Fi,hc={_globalRotateModeEnabled:!1,enableGlobalRotateMode(){this._globalRotateModeEnabled=!0,L.PM.Utils.findLayers(this.map).filter(y=>y instanceof L.Polyline).forEach(y=>{this._isRelevantForRotate(y)&&y.pm.enableRotate()}),this.throttledReInitRotate||(this.throttledReInitRotate=L.Util.throttle(this.handleLayerAdditionInGlobalRotateMode,100,this)),this._addedLayersRotate={},this.map.on("layeradd",this._layerAddedRotate,this),this.map.on("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},disableGlobalRotateMode(){this._globalRotateModeEnabled=!1,L.PM.Utils.findLayers(this.map).filter(y=>y instanceof L.Polyline).forEach(y=>{y.pm.disableRotate()}),this.map.off("layeradd",this._layerAddedRotate,this),this.map.off("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},globalRotateModeEnabled(){return!!this._globalRotateModeEnabled},toggleGlobalRotateMode(){this.globalRotateModeEnabled()?this.disableGlobalRotateMode():this.enableGlobalRotateMode()},_isRelevantForRotate(y){return y.pm&&y instanceof L.Polyline&&!(y instanceof L.LayerGroup)&&(!L.PM.optIn&&!y.options.pmIgnore||L.PM.optIn&&y.options.pmIgnore===!1)&&!y._pmTempLayer&&y.pm.options.allowRotation},handleLayerAdditionInGlobalRotateMode(){let y=this._addedLayersRotate;if(this._addedLayersRotate={},this.globalRotateModeEnabled())for(let S in y){let I=y[S];this._isRelevantForRemoval(I)&&I.pm.enableRotate()}},_layerAddedRotate({layer:y}){this._addedLayersRotate[L.stamp(y)]=y}},ua=hc,hu=f(Li()),du={_fireDrawStart(y="Draw",S={}){this.__fire(this._map,"pm:drawstart",{shape:this._shape,workingLayer:this._layer},y,S)},_fireDrawEnd(y="Draw",S={}){this.__fire(this._map,"pm:drawend",{shape:this._shape},y,S)},_fireCreate(y,S="Draw",I={}){this.__fire(this._map,"pm:create",{shape:this._shape,marker:y,layer:y},S,I)},_fireCenterPlaced(y="Draw",S={}){let I=y==="Draw"?this._layer:void 0,F=y!=="Draw"?this._layer:void 0;this.__fire(this._layer,"pm:centerplaced",{shape:this._shape,workingLayer:I,layer:F,latlng:this._layer.getLatLng()},y,S)},_fireCut(y,S,I,F="Draw",G={}){this.__fire(y,"pm:cut",{shape:this._shape,layer:S,originalLayer:I},F,G)},_fireEdit(y=this._layer,S="Edit",I={}){this.__fire(y,"pm:edit",{layer:this._layer,shape:this.getShape()},S,I)},_fireEnable(y="Edit",S={}){this.__fire(this._layer,"pm:enable",{layer:this._layer,shape:this.getShape()},y,S)},_fireDisable(y="Edit",S={}){this.__fire(this._layer,"pm:disable",{layer:this._layer,shape:this.getShape()},y,S)},_fireUpdate(y="Edit",S={}){this.__fire(this._layer,"pm:update",{layer:this._layer,shape:this.getShape()},y,S)},_fireMarkerDragStart(y,S=void 0,I="Edit",F={}){this.__fire(this._layer,"pm:markerdragstart",{layer:this._layer,markerEvent:y,shape:this.getShape(),indexPath:S},I,F)},_fireMarkerDrag(y,S=void 0,I="Edit",F={}){this.__fire(this._layer,"pm:markerdrag",{layer:this._layer,markerEvent:y,shape:this.getShape(),indexPath:S},I,F)},_fireMarkerDragEnd(y,S=void 0,I=void 0,F="Edit",G={}){this.__fire(this._layer,"pm:markerdragend",{layer:this._layer,markerEvent:y,shape:this.getShape(),indexPath:S,intersectionReset:I},F,G)},_fireDragStart(y="Edit",S={}){this.__fire(this._layer,"pm:dragstart",{layer:this._layer,shape:this.getShape()},y,S)},_fireDrag(y,S="Edit",I={}){this.__fire(this._layer,"pm:drag",{...y,shape:this.getShape()},S,I)},_fireDragEnd(y="Edit",S={}){this.__fire(this._layer,"pm:dragend",{layer:this._layer,shape:this.getShape()},y,S)},_fireDragEnable(y="Edit",S={}){this.__fire(this._layer,"pm:dragenable",{layer:this._layer,shape:this.getShape()},y,S)},_fireDragDisable(y="Edit",S={}){this.__fire(this._layer,"pm:dragdisable",{layer:this._layer,shape:this.getShape()},y,S)},_fireRemove(y,S=y,I="Edit",F={}){this.__fire(y,"pm:remove",{layer:S,shape:this.getShape()},I,F)},_fireVertexAdded(y,S,I,F="Edit",G={}){this.__fire(this._layer,"pm:vertexadded",{layer:this._layer,workingLayer:this._layer,marker:y,indexPath:S,latlng:I,shape:this.getShape()},F,G)},_fireVertexRemoved(y,S,I="Edit",F={}){this.__fire(this._layer,"pm:vertexremoved",{layer:this._layer,marker:y,indexPath:S,shape:this.getShape()},I,F)},_fireVertexClick(y,S,I="Edit",F={}){this.__fire(this._layer,"pm:vertexclick",{layer:this._layer,markerEvent:y,indexPath:S,shape:this.getShape()},I,F)},_fireIntersect(y,S=this._layer,I="Edit",F={}){this.__fire(S,"pm:intersect",{layer:this._layer,intersection:y,shape:this.getShape()},I,F)},_fireLayerReset(y,S,I="Edit",F={}){this.__fire(this._layer,"pm:layerreset",{layer:this._layer,markerEvent:y,indexPath:S,shape:this.getShape()},I,F)},_fireChange(y,S="Edit",I={}){this.__fire(this._layer,"pm:change",{layer:this._layer,latlngs:y,shape:this.getShape()},S,I)},_fireTextChange(y,S="Edit",I={}){this.__fire(this._layer,"pm:textchange",{layer:this._layer,text:y,shape:this.getShape()},S,I)},_fireTextFocus(y="Edit",S={}){this.__fire(this._layer,"pm:textfocus",{layer:this._layer,shape:this.getShape()},y,S)},_fireTextBlur(y="Edit",S={}){this.__fire(this._layer,"pm:textblur",{layer:this._layer,shape:this.getShape()},y,S)},_fireSnapDrag(y,S,I="Snapping",F={}){this.__fire(y,"pm:snapdrag",S,I,F)},_fireSnap(y,S,I="Snapping",F={}){this.__fire(y,"pm:snap",S,I,F)},_fireUnsnap(y,S,I="Snapping",F={}){this.__fire(y,"pm:unsnap",S,I,F)},_fireRotationEnable(y,S,I="Rotation",F={}){this.__fire(y,"pm:rotateenable",{layer:this._layer,helpLayer:this._rotatePoly,shape:this.getShape()},I,F)},_fireRotationDisable(y,S="Rotation",I={}){this.__fire(y,"pm:rotatedisable",{layer:this._layer,shape:this.getShape()},S,I)},_fireRotationStart(y,S,I="Rotation",F={}){this.__fire(y,"pm:rotatestart",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:this._startAngle,originLatLngs:S},I,F)},_fireRotation(y,S,I,F=this._rotationLayer,G="Rotation",te={}){this.__fire(y,"pm:rotate",{layer:F,helpLayer:this._layer,startAngle:this._startAngle,angle:F.pm.getAngle(),angleDiff:S,oldLatLngs:I,newLatLngs:F.getLatLngs()},G,te)},_fireRotationEnd(y,S,I,F="Rotation",G={}){this.__fire(y,"pm:rotateend",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:S,angle:this._rotationLayer.pm.getAngle(),originLatLngs:I,newLatLngs:this._rotationLayer.getLatLngs()},F,G)},_fireActionClick(y,S,I,F="Toolbar",G={}){this.__fire(this._map,"pm:actionclick",{text:y.text,action:y,btnName:S,button:I},F,G)},_fireButtonClick(y,S,I="Toolbar",F={}){this.__fire(this._map,"pm:buttonclick",{btnName:y,button:S},I,F)},_fireLangChange(y,S,I,F,G="Global",te={}){this.__fire(this.map,"pm:langchange",{oldLang:y,activeLang:S,fallback:I,translations:F},G,te)},_fireGlobalDragModeToggled(y,S="Global",I={}){this.__fire(this.map,"pm:globaldragmodetoggled",{enabled:y,map:this.map},S,I)},_fireGlobalEditModeToggled(y,S="Global",I={}){this.__fire(this.map,"pm:globaleditmodetoggled",{enabled:y,map:this.map},S,I)},_fireGlobalRemovalModeToggled(y,S="Global",I={}){this.__fire(this.map,"pm:globalremovalmodetoggled",{enabled:y,map:this.map},S,I)},_fireGlobalCutModeToggled(y="Global",S={}){this.__fire(this._map,"pm:globalcutmodetoggled",{enabled:!!this._enabled,map:this._map},y,S)},_fireGlobalDrawModeToggled(y="Global",S={}){this.__fire(this._map,"pm:globaldrawmodetoggled",{enabled:this._enabled,shape:this._shape,map:this._map},y,S)},_fireGlobalRotateModeToggled(y="Global",S={}){this.__fire(this.map,"pm:globalrotatemodetoggled",{enabled:this.globalRotateModeEnabled(),map:this.map},y,S)},_fireRemoveLayerGroup(y,S=y,I="Edit",F={}){this.__fire(y,"pm:remove",{layer:S,shape:void 0},I,F)},_fireKeyeventEvent(y,S,I,F="Global",G={}){this.__fire(this.map,"pm:keyevent",{event:y,eventType:S,focusOn:I},F,G)},__fire(y,S,I,F,G={}){I=(0,hu.default)(I,G,{source:F}),L.PM.Utils._fireEvent(y,S,I)}},Iu=du,fu=()=>({_lastEvents:{keydown:void 0,keyup:void 0,current:void 0},_initKeyListener(y){this.map=y,L.DomEvent.on(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.on(window,"blur",this._onBlur,this),y.once("unload",this._unbindKeyListenerEvents,this)},_unbindKeyListenerEvents(){L.DomEvent.off(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.off(window,"blur",this._onBlur,this)},_onKeyListener(y){let S="document";this.map.getContainer().contains(y.target)&&(S="map");let I={event:y,eventType:y.type,focusOn:S};this._lastEvents[y.type]=I,this._lastEvents.current=I,this.map.pm._fireKeyeventEvent(y,y.type,S)},_onBlur(y){y.altKey=!1;let S={event:y,eventType:y.type,focusOn:"document"};this._lastEvents[y.type]=S,this._lastEvents.current=S},getLastKeyEvent(y="current"){return this._lastEvents[y]},isShiftKeyPressed(){var y;return(y=this._lastEvents.current)==null?void 0:y.event.shiftKey},isAltKeyPressed(){var y;return(y=this._lastEvents.current)==null?void 0:y.event.altKey},isCtrlKeyPressed(){var y;return(y=this._lastEvents.current)==null?void 0:y.event.ctrlKey},isMetaKeyPressed(){var y;return(y=this._lastEvents.current)==null?void 0:y.event.metaKey},getPressedKey(){var y;return(y=this._lastEvents.current)==null?void 0:y.event.key}}),Hi=fu,Ks=f(ja());function di(y){let S=L.PM.activeLang;return(0,Ks.default)(Pa[S],y)||(0,Ks.default)(Pa.en,y)||y}function ro(y){for(let S=0;S<y.length;S+=1){let I=y[S];if(Array.isArray(I)){if(ro(I))return!0}else if(I!=null&&I!=="")return!0}return!1}function vl(y){return y.reduce((S,I)=>{if(I.length!==0){let F=Array.isArray(I)?vl(I):I;Array.isArray(F)?F.length!==0&&S.push(F):S.push(F)}return S},[])}function Ys(y,S,I){let F={a:L.CRS.Earth.R,b:63567523142e-4,f:.0033528106647474805},{a:G,b:te,f:pe}=F,xe=y.lng,Fe=y.lat,tt=I,zt=Math.PI,bt=S*zt/180,dn=Math.sin(bt),zn=Math.cos(bt),hr=(1-pe)*Math.tan(Fe*zt/180),Ir=1/Math.sqrt(1+hr*hr),Br=hr*Ir,ci=Math.atan2(hr,zn),Nt=Ir*dn,qt=1-Nt*Nt,gn=qt*(G*G-te*te)/(te*te),Gn=1+gn/16384*(4096+gn*(-768+gn*(320-175*gn))),Mn=gn/1024*(256+gn*(-128+gn*(74-47*gn))),Bn=tt/(te*Gn),Ge=2*Math.PI,at,mt,_t;for(;Math.abs(Bn-Ge)>1e-12;){at=Math.cos(2*ci+Bn),mt=Math.sin(Bn),_t=Math.cos(Bn);let x=Mn*mt*(at+Mn/4*(_t*(-1+2*at*at)-Mn/6*at*(-3+4*mt*mt)*(-3+4*at*at)));Ge=Bn,Bn=tt/(te*Gn)+x}let St=Br*mt-Ir*_t*zn,Lt=Math.atan2(Br*_t+Ir*mt*zn,(1-pe)*Math.sqrt(Nt*Nt+St*St)),sn=Math.atan2(mt*dn,Ir*_t-Br*mt*zn),E=pe/16*qt*(4+pe*(4-3*qt)),s=sn-(1-E)*pe*Nt*(Bn+E*mt*(at+E*_t*(-1+2*at*at))),c=xe+s*180/zt,g=Lt*180/zt;return L.latLng(c,g)}function Fs(y,S,I,F,G=!0){let te,pe,xe,Fe=[];for(let tt=0;tt<I;tt+=1){if(G)te=tt*360/I+F,pe=Ys(y,te,S),xe=L.latLng(pe.lng,pe.lat);else{let zt=y.lat+Math.cos(2*tt*Math.PI/I)*S,bt=y.lng+Math.sin(2*tt*Math.PI/I)*S;xe=L.latLng(zt,bt)}Fe.push(xe)}return Fe}function Fo(y,S,I){S=(S+360)%360;let F=Math.PI/180,G=180/Math.PI,{R:te}=L.CRS.Earth,pe=y.lng*F,xe=y.lat*F,Fe=S*F,tt=Math.sin(xe),zt=Math.cos(xe),bt=Math.cos(I/te),dn=Math.sin(I/te),zn=Math.asin(tt*bt+zt*dn*Math.cos(Fe)),hr=pe+Math.atan2(Math.sin(Fe)*dn*zt,bt-tt*Math.sin(zn));hr*=G;let Ir=hr-360,Br=hr<-180?hr+360:hr;return hr=hr>180?Ir:Br,L.latLng([zn*G,hr])}function Ea(y,S,I){let F=y.latLngToContainerPoint(S),G=y.latLngToContainerPoint(I),te=Math.atan2(G.y-F.y,G.x-F.x)*180/Math.PI+90;return te+=te<0?360:0,te}function vs(y,S,I,F){let G=Ea(y,S,I);return Fo(S,G,F)}function pu(y,S,I="asc"){if(!S||Object.keys(S).length===0)return(Fe,tt)=>Fe-tt;let F=Object.keys(S),G,te=F.length-1,pe={};for(;te>=0;)G=F[te],pe[G.toLowerCase()]=S[G],te-=1;function xe(Fe){if(Fe instanceof L.Marker)return"Marker";if(Fe instanceof L.Circle)return"Circle";if(Fe instanceof L.CircleMarker)return"CircleMarker";if(Fe instanceof L.Rectangle)return"Rectangle";if(Fe instanceof L.Polygon)return"Polygon";if(Fe instanceof L.Polyline)return"Line"}return(Fe,tt)=>{let zt,bt;if(zt=xe(Fe.layer).toLowerCase(),bt=xe(tt.layer).toLowerCase(),!zt||!bt)return 0;let dn=zt in pe?pe[zt]:Number.MAX_SAFE_INTEGER,zn=bt in pe?pe[bt]:Number.MAX_SAFE_INTEGER,hr=0;return dn<zn?hr=-1:dn>zn&&(hr=1),I==="desc"?hr*-1:hr}}function Ma(y,S=y.getLatLngs()){return y instanceof L.Polygon?L.polygon(S).getLatLngs():L.polyline(S).getLatLngs()}function Qu(y,S){var I,F,G,te;if((F=(I=S.options.crs)==null?void 0:I.projection)!=null&&F.MAX_LATITUDE){let pe=(te=(G=S.options.crs)==null?void 0:G.projection)==null?void 0:te.MAX_LATITUDE;y.lat=Math.max(Math.min(pe,y.lat),-pe)}return y}function ss(y){return y.options.renderer||y._map&&(y._map._getPaneRenderer(y.options.pane)||y._map.options.renderer||y._map._renderer)||y._renderer}var Lc=L.Class.extend({includes:[Sc,Nr,Oi,ua,Iu],initialize(y){this.map=y,this.Draw=new L.PM.Draw(y),this.Toolbar=new L.PM.Toolbar(y),this.Keyboard=Hi(),this.globalOptions={snappable:!0,layerGroup:void 0,snappingOrder:["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],panes:{vertexPane:"markerPane",layerPane:"overlayPane",markerPane:"markerPane"},draggable:!0},this.Keyboard._initKeyListener(y)},setLang(y="en",S,I="en"){if(y=y.trim().toLowerCase(),!/^[a-z]{2}$/.test(y)){let G=y.replace(/[-_\s]/g,"-").replace(/^(\w{2})$/,"$1-").match(/([a-z]{2})-?([a-z]{2})?/);if(G){let te=[`${G[1]}_${G[2]}`,`${G[1]}`];for(let pe of te)if(Pa[pe]){y=pe;break}}}let F=L.PM.activeLang;S&&(Pa[y]=(0,ki.default)(Pa[I],S)),L.PM.activeLang=y,this.map.pm.Toolbar.reinit(),this._fireLangChange(F,y,I,Pa[y])},addControls(y){this.Toolbar.addControls(y)},removeControls(){this.Toolbar.removeControls()},toggleControls(){this.Toolbar.toggleControls()},controlsVisible(){return this.Toolbar.isVisible},enableDraw(y="Polygon",S){y==="Poly"&&(y="Polygon"),this.Draw.enable(y,S)},disableDraw(y="Polygon"){y==="Poly"&&(y="Polygon"),this.Draw.disable(y)},setPathOptions(y,S={}){let I=S.ignoreShapes||[],F=S.merge||!1;this.map.pm.Draw.shapes.forEach(G=>{I.indexOf(G)===-1&&this.map.pm.Draw[G].setPathOptions(y,F)})},getGlobalOptions(){return this.globalOptions},setGlobalOptions(y){let S=(0,ki.default)(this.globalOptions,y);S.editable&&(S.resizeableCircleMarker=S.editable,delete S.editable);let I=!1;this.map.pm.Draw.CircleMarker.enabled()&&!!this.map.pm.Draw.CircleMarker.options.resizeableCircleMarker!=!!S.resizeableCircleMarker&&(this.map.pm.Draw.CircleMarker.disable(),I=!0);let F=!1;this.map.pm.Draw.Circle.enabled()&&!!this.map.pm.Draw.Circle.options.resizeableCircle!=!!S.resizeableCircle&&(this.map.pm.Draw.Circle.disable(),F=!0),this.map.pm.Draw.shapes.forEach(G=>{this.map.pm.Draw[G].setOptions(S)}),I&&this.map.pm.Draw.CircleMarker.enable(),F&&this.map.pm.Draw.Circle.enable(),L.PM.Utils.findLayers(this.map).forEach(G=>{G.pm.setOptions(S)}),this.map.fire("pm:globaloptionschanged"),this.globalOptions=S,this.applyGlobalOptions()},applyGlobalOptions(){L.PM.Utils.findLayers(this.map).forEach(y=>{y.pm.enabled()&&y.pm.applyOptions()})},globalDrawModeEnabled(){return!!this.Draw.getActiveShape()},globalCutModeEnabled(){return!!this.Draw.Cut.enabled()},enableGlobalCutMode(y){return this.Draw.Cut.enable(y)},toggleGlobalCutMode(y){return this.Draw.Cut.toggle(y)},disableGlobalCutMode(){return this.Draw.Cut.disable()},getGeomanLayers(y=!1){let S=L.PM.Utils.findLayers(this.map);if(!y)return S;let I=L.featureGroup();return I._pmTempLayer=!0,S.forEach(F=>{I.addLayer(F)}),I},getGeomanDrawLayers(y=!1){let S=L.PM.Utils.findLayers(this.map).filter(F=>F._drawnByGeoman===!0);if(!y)return S;let I=L.featureGroup();return I._pmTempLayer=!0,S.forEach(F=>{I.addLayer(F)}),I},_getContainingLayer(){return this.globalOptions.layerGroup&&this.globalOptions.layerGroup instanceof L.LayerGroup?this.globalOptions.layerGroup:this.map},_isCRSSimple(){return this.map.options.crs===L.CRS.Simple},_touchEventCounter:0,_addTouchEvents(y){this._touchEventCounter===0&&(L.DomEvent.on(y,"touchmove",this._canvasTouchMove,this),L.DomEvent.on(y,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter+=1},_removeTouchEvents(y){this._touchEventCounter===1&&(L.DomEvent.off(y,"touchmove",this._canvasTouchMove,this),L.DomEvent.off(y,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter=this._touchEventCounter<=1?0:this._touchEventCounter-1},_canvasTouchMove(y){ss(this.map)._onMouseMove(this._createMouseEvent("mousemove",y))},_canvasTouchClick(y){let S="";y.type==="touchstart"||y.type==="pointerdown"?S="mousedown":(y.type==="touchend"||y.type==="pointerup"||y.type==="touchcancel"||y.type==="pointercancel")&&(S="mouseup"),S&&ss(this.map)._onClick(this._createMouseEvent(S,y))},_createMouseEvent(y,S){let I,F=S.touches[0]||S.changedTouches[0];try{I=new MouseEvent(y,{bubbles:S.bubbles,cancelable:S.cancelable,view:S.view,detail:F.detail,screenX:F.screenX,screenY:F.screenY,clientX:F.clientX,clientY:F.clientY,ctrlKey:S.ctrlKey,altKey:S.altKey,shiftKey:S.shiftKey,metaKey:S.metaKey,button:S.button,relatedTarget:S.relatedTarget})}catch{I=document.createEvent("MouseEvents"),I.initMouseEvent(y,S.bubbles,S.cancelable,S.view,F.detail,F.screenX,F.screenY,F.clientX,F.clientY,S.ctrlKey,S.altKey,S.shiftKey,S.metaKey,S.button,S.relatedTarget)}return I}}),Po=Lc,Fl=L.Control.extend({includes:[Iu],options:{position:"topleft",disableByOtherButtons:!0},initialize(y){this._button=L.Util.extend({},this.options,y)},onAdd(y){return this._map=y,this._map.pm.Toolbar.options.oneBlock?this._container=this._map.pm.Toolbar._createContainer(this.options.position):this._button.tool==="edit"?this._container=this._map.pm.Toolbar.editContainer:this._button.tool==="options"?this._container=this._map.pm.Toolbar.optionsContainer:this._button.tool==="custom"?this._container=this._map.pm.Toolbar.customContainer:this._container=this._map.pm.Toolbar.drawContainer,this._renderButton(),this._container},_renderButton(){let y=this.buttonsDomNode;this.buttonsDomNode=this._makeButton(this._button),y?y.replaceWith(this.buttonsDomNode):this._container.appendChild(this.buttonsDomNode)},onRemove(){return this.buttonsDomNode.remove(),this._container},getText(){return this._button.text},getIconUrl(){return this._button.iconUrl},destroy(){this._button={},this._update()},toggle(y){return typeof y=="boolean"?this._button.toggleStatus=y:this._button.toggleStatus=!this._button.toggleStatus,this._applyStyleClasses(),this._updateActiveAction(this._button),this._button.toggleStatus},toggled(){return this._button.toggleStatus},onCreate(){this.toggle(!1)},disable(){this.toggle(!1),this._button.disabled=!0,this._updateDisabled()},enable(){this._button.disabled=!1,this._updateDisabled(),this._updateActiveAction(this._button)},_triggerClick(y){y&&y.preventDefault(),!this._button.disabled&&(this._button.onClick(y,{button:this,event:y}),this._clicked(y),this._button.afterClick(y,{button:this,event:y}))},_makeButton(y){let S=this.options.position.indexOf("right")>-1?"pos-right":"",I=L.DomUtil.create("div",`button-container  ${S}`,this._container);y.title&&I.setAttribute("title",y.title);let F=L.DomUtil.create("a","leaflet-buttons-control-button",I);F.setAttribute("role","button"),F.setAttribute("tabindex","0"),F.href="#";let G=L.DomUtil.create("div",`leaflet-pm-actions-container ${S}`,I),te=y.actions,pe={cancel:{text:di("actions.cancel"),title:di("actions.cancel"),onClick(){this._triggerClick()}},finishMode:{text:di("actions.finish"),title:di("actions.finish"),onClick(){this._triggerClick()}},removeLastVertex:{text:di("actions.removeLastVertex"),title:di("actions.removeLastVertex"),onClick(){this._map.pm.Draw[y.jsClass]._removeLastVertex()}},finish:{text:di("actions.finish"),title:di("actions.finish"),onClick(Fe){this._map.pm.Draw[y.jsClass]._finishShape(Fe)}}};y._preparedActions=te.map(Fe=>{let tt=typeof Fe=="string"?Fe:Fe.name,zt;if(pe[tt])zt=pe[tt];else if(Fe.text)zt=Fe;else return zt;let bt=L.DomUtil.create("a",`leaflet-pm-action ${S} action-${tt}`,G);if(bt.setAttribute("role","button"),bt.setAttribute("tabindex","0"),bt.href="#",zt.title&&(bt.title=zt.title),bt.innerHTML=zt.text,L.DomEvent.disableClickPropagation(bt),L.DomEvent.on(bt,"click",L.DomEvent.stop),zt._node=bt,!y.disabled&&zt.onClick){let dn=zn=>{zn.preventDefault();let hr="",{buttons:Ir}=this._map.pm.Toolbar;for(let Br in Ir)if(Ir[Br]._button===y){hr=Br;break}this._fireActionClick(zt,hr,y)};L.DomEvent.addListener(bt,"click",dn,this),L.DomEvent.addListener(bt,"click",zt.onClick,this),L.DomEvent.addListener(bt,"click",()=>this._updateActiveAction(y))}return zt}),this._updateActiveAction(y),y.toggleStatus&&L.DomUtil.addClass(I,"active");let xe=L.DomUtil.create("div","control-icon",F);return y.iconUrl&&xe.setAttribute("src",y.iconUrl),y.className&&L.DomUtil.addClass(xe,y.className),L.DomEvent.disableClickPropagation(F),L.DomEvent.on(F,"click",L.DomEvent.stop),y.disabled||(L.DomEvent.addListener(F,"click",this._onBtnClick,this),L.DomEvent.addListener(F,"click",this._triggerClick,this)),y.disabled&&(L.DomUtil.addClass(F,"pm-disabled"),F.setAttribute("aria-disabled","true")),I},_applyStyleClasses(){this._container&&(!this._button.toggleStatus||this._button.cssToggle===!1?(L.DomUtil.removeClass(this.buttonsDomNode,"active"),L.DomUtil.removeClass(this._container,"activeChild")):(L.DomUtil.addClass(this.buttonsDomNode,"active"),L.DomUtil.addClass(this._container,"activeChild")))},_onBtnClick(){if(this._button.disabled)return;this._button.disableOtherButtons&&this._map.pm.Toolbar.triggerClickOnToggledButtons(this);let y="",{buttons:S}=this._map.pm.Toolbar;for(let I in S)if(S[I]._button===this._button){y=I;break}this._fireButtonClick(y,this._button)},_clicked(){this._button.doToggle&&this.toggle()},_updateDisabled(){if(!this._container)return;let y="pm-disabled",S=this.buttonsDomNode.children[0];this._button.disabled?(L.DomUtil.addClass(S,y),S.setAttribute("aria-disabled","true")):(L.DomUtil.removeClass(S,y),S.setAttribute("aria-disabled","false"))},_updateActiveAction(y){var S;(S=y._preparedActions)==null||S.forEach(I=>{I!=null&&I._node&&(I.isActive&&I.isActive.call(this)?L.DomUtil.addClass(I._node,"active-action"):L.DomUtil.removeClass(I._node,"active-action"))})}}),Du=Fl;L.Control.PMButton=Du;var Va=L.Class.extend({options:{drawMarker:!0,drawRectangle:!0,drawPolyline:!0,drawPolygon:!0,drawCircle:!0,drawCircleMarker:!0,drawText:!0,editMode:!0,dragMode:!0,cutPolygon:!0,removalMode:!0,rotateMode:!0,snappingOption:!0,drawControls:!0,editControls:!0,optionsControls:!0,customControls:!0,oneBlock:!1,position:"topleft",positions:{draw:"",edit:"",options:"",custom:""}},customButtons:[],initialize(y){this.customButtons=[],this.options.positions={draw:"",edit:"",options:"",custom:""},this.init(y)},reinit(){let y=this.isVisible;this.removeControls(),this._defineButtons(),y&&this.addControls()},init(y){this.map=y,this.buttons={},this.isVisible=!1,this.drawContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-draw leaflet-bar leaflet-control"),this.editContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-edit leaflet-bar leaflet-control"),this.optionsContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-options leaflet-bar leaflet-control"),this.customContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-custom leaflet-bar leaflet-control"),this._defineButtons()},_createContainer(y){let S=`${y}Container`;return this[S]||(this[S]=L.DomUtil.create("div",`leaflet-pm-toolbar leaflet-pm-${y} leaflet-bar leaflet-control`)),this[S]},getButtons(){return this.buttons},addControls(y=this.options){typeof y.editPolygon<"u"&&(y.editMode=y.editPolygon),typeof y.deleteLayer<"u"&&(y.removalMode=y.deleteLayer),L.Util.setOptions(this,y),this.applyIconStyle(),this.isVisible=!0,this._showHideButtons()},applyIconStyle(){let y=this.getButtons(),S={geomanIcons:{drawMarker:"control-icon leaflet-pm-icon-marker",drawPolyline:"control-icon leaflet-pm-icon-polyline",drawRectangle:"control-icon leaflet-pm-icon-rectangle",drawPolygon:"control-icon leaflet-pm-icon-polygon",drawCircle:"control-icon leaflet-pm-icon-circle",drawCircleMarker:"control-icon leaflet-pm-icon-circle-marker",editMode:"control-icon leaflet-pm-icon-edit",dragMode:"control-icon leaflet-pm-icon-drag",cutPolygon:"control-icon leaflet-pm-icon-cut",removalMode:"control-icon leaflet-pm-icon-delete",drawText:"control-icon leaflet-pm-icon-text"}};for(let I in y){let F=y[I];L.Util.setOptions(F,{className:S.geomanIcons[I]})}},removeControls(){let y=this.getButtons();for(let S in y)y[S].remove();this.isVisible=!1},toggleControls(y=this.options){this.isVisible?this.removeControls():this.addControls(y)},_addButton(y,S){return this.buttons[y]=S,this.options[y]=!!this.options[y]||!1,this.buttons[y]},triggerClickOnToggledButtons(y){for(let S in this.buttons){let I=this.buttons[S];I._button.disableByOtherButtons&&I!==y&&I.toggled()&&I._triggerClick()}},toggleButton(y,S,I=!0){y==="editPolygon"&&(y="editMode"),y==="deleteLayer"&&(y="removalMode");let F=y;return I&&this.triggerClickOnToggledButtons(this.buttons[F]),this.buttons[F]?this.buttons[F].toggle(S):!1},_defineButtons(){let y={className:"control-icon leaflet-pm-icon-marker",title:di("buttonTitles.drawMarkerButton"),jsClass:"Marker",onClick:()=>{},afterClick:(dn,zn)=>{this.map.pm.Draw[zn.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},S={title:di("buttonTitles.drawPolyButton"),className:"control-icon leaflet-pm-icon-polygon",jsClass:"Polygon",onClick:()=>{},afterClick:(dn,zn)=>{this.map.pm.Draw[zn.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},I={className:"control-icon leaflet-pm-icon-polyline",title:di("buttonTitles.drawLineButton"),jsClass:"Line",onClick:()=>{},afterClick:(dn,zn)=>{this.map.pm.Draw[zn.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},F={title:di("buttonTitles.drawCircleButton"),className:"control-icon leaflet-pm-icon-circle",jsClass:"Circle",onClick:()=>{},afterClick:(dn,zn)=>{this.map.pm.Draw[zn.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},G={title:di("buttonTitles.drawCircleMarkerButton"),className:"control-icon leaflet-pm-icon-circle-marker",jsClass:"CircleMarker",onClick:()=>{},afterClick:(dn,zn)=>{this.map.pm.Draw[zn.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},te={title:di("buttonTitles.drawRectButton"),className:"control-icon leaflet-pm-icon-rectangle",jsClass:"Rectangle",onClick:()=>{},afterClick:(dn,zn)=>{this.map.pm.Draw[zn.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},pe={title:di("buttonTitles.editButton"),className:"control-icon leaflet-pm-icon-edit",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalEditMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},xe={title:di("buttonTitles.dragButton"),className:"control-icon leaflet-pm-icon-drag",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalDragMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},Fe={title:di("buttonTitles.cutButton"),className:"control-icon leaflet-pm-icon-cut",jsClass:"Cut",onClick:()=>{},afterClick:(dn,zn)=>{this.map.pm.Draw[zn.button._button.jsClass].toggle({snappable:!0,cursorMarker:!0,allowSelfIntersection:!1})},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finish","removeLastVertex","cancel"]},tt={title:di("buttonTitles.deleteButton"),className:"control-icon leaflet-pm-icon-delete",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRemovalMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},zt={title:di("buttonTitles.rotateButton"),className:"control-icon leaflet-pm-icon-rotate",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRotateMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},bt={className:"control-icon leaflet-pm-icon-text",title:di("buttonTitles.drawTextButton"),jsClass:"Text",onClick:()=>{},afterClick:(dn,zn)=>{this.map.pm.Draw[zn.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]};this._addButton("drawMarker",new L.Control.PMButton(y)),this._addButton("drawPolyline",new L.Control.PMButton(I)),this._addButton("drawRectangle",new L.Control.PMButton(te)),this._addButton("drawPolygon",new L.Control.PMButton(S)),this._addButton("drawCircle",new L.Control.PMButton(F)),this._addButton("drawCircleMarker",new L.Control.PMButton(G)),this._addButton("drawText",new L.Control.PMButton(bt)),this._addButton("editMode",new L.Control.PMButton(pe)),this._addButton("dragMode",new L.Control.PMButton(xe)),this._addButton("cutPolygon",new L.Control.PMButton(Fe)),this._addButton("removalMode",new L.Control.PMButton(tt)),this._addButton("rotateMode",new L.Control.PMButton(zt))},_showHideButtons(){if(!this.isVisible)return;this.removeControls(),this.isVisible=!0;let y=this.getButtons(),S=[];this.options.drawControls===!1&&(S=S.concat(Object.keys(y).filter(I=>!y[I]._button.tool))),this.options.editControls===!1&&(S=S.concat(Object.keys(y).filter(I=>y[I]._button.tool==="edit"))),this.options.optionsControls===!1&&(S=S.concat(Object.keys(y).filter(I=>y[I]._button.tool==="options"))),this.options.customControls===!1&&(S=S.concat(Object.keys(y).filter(I=>y[I]._button.tool==="custom")));for(let I in y)if(this.options[I]&&S.indexOf(I)===-1){let F=y[I]._button.tool;F||(F="draw"),y[I].setPosition(this._getBtnPosition(F)),y[I].addTo(this.map)}},_getBtnPosition(y){return this.options.positions&&this.options.positions[y]?this.options.positions[y]:this.options.position},setBlockPosition(y,S){this.options.positions[y]=S,this._showHideButtons(),this.changeControlOrder()},getBlockPositions(){return this.options.positions},copyDrawControl(y,S){if(S)typeof S!="object"&&(S={name:S});else throw new TypeError("Button has no name");let I=this._btnNameMapping(y);if(!S.name)throw new TypeError("Button has no name");if(this.buttons[S.name])throw new TypeError("Button with this name already exists");let F=this.map.pm.Draw.createNewDrawInstance(S.name,I);S={...this.buttons[I]._button,...S};let G=this.createCustomControl(S);return{drawInstance:F,control:G}},createCustomControl(y){if(!y.name)throw new TypeError("Button has no name");if(this.buttons[y.name])throw new TypeError("Button with this name already exists");y.onClick||(y.onClick=()=>{}),y.afterClick||(y.afterClick=()=>{}),y.toggle!==!1&&(y.toggle=!0),y.block&&(y.block=y.block.toLowerCase()),(!y.block||y.block==="draw")&&(y.block=""),y.className?y.className.indexOf("control-icon")===-1&&(y.className=`control-icon ${y.className}`):y.className="control-icon";let S={tool:y.block,className:y.className,title:y.title||"",jsClass:y.name,onClick:y.onClick,afterClick:y.afterClick,doToggle:y.toggle,toggleStatus:!1,disableOtherButtons:y.disableOtherButtons??!0,disableByOtherButtons:y.disableByOtherButtons??!0,cssToggle:y.toggle,position:this.options.position,actions:y.actions||[],disabled:!!y.disabled};this.options[y.name]!==!1&&(this.options[y.name]=!0);let I=this._addButton(y.name,new L.Control.PMButton(S));return this.changeControlOrder(),I},controlExists(y){return!!this.getButton(y)},getButton(y){return this.getButtons()[y]},getButtonsInBlock(y){let S={};if(y)for(let I in this.getButtons()){let F=this.getButtons()[I];(F._button.tool===y||y==="draw"&&!F._button.tool)&&(S[I]=F)}return S},changeControlOrder(y=[]){let S=this._shapeMapping(),I=[];y.forEach(te=>{S[te]?I.push(S[te]):I.push(te)});let F=this.getButtons(),G={};I.forEach(te=>{F[te]&&(G[te]=F[te])}),Object.keys(F).filter(te=>!F[te]._button.tool||F[te]._button.tool==="draw").forEach(te=>{I.indexOf(te)===-1&&(G[te]=F[te])}),Object.keys(F).filter(te=>F[te]._button.tool==="edit").forEach(te=>{I.indexOf(te)===-1&&(G[te]=F[te])}),Object.keys(F).filter(te=>F[te]._button.tool==="options").forEach(te=>{I.indexOf(te)===-1&&(G[te]=F[te])}),Object.keys(F).filter(te=>F[te]._button.tool==="custom").forEach(te=>{I.indexOf(te)===-1&&(G[te]=F[te])}),Object.keys(F).forEach(te=>{I.indexOf(te)===-1&&(G[te]=F[te])}),this.map.pm.Toolbar.buttons=G,this._showHideButtons()},getControlOrder(){let y=this.getButtons(),S=[];for(let I in y)S.push(I);return S},changeActionsOfControl(y,S){let I=this._btnNameMapping(y);if(!I)throw new TypeError("No name passed");if(!S)throw new TypeError("No actions passed");if(!this.buttons[I])throw new TypeError("Button with this name not exists");this.buttons[I]._button.actions=S,this.changeControlOrder()},setButtonDisabled(y,S){let I=this._btnNameMapping(y);S?this.buttons[I].disable():this.buttons[I].enable()},_shapeMapping(){return{Marker:"drawMarker",Circle:"drawCircle",Polygon:"drawPolygon",Rectangle:"drawRectangle",Polyline:"drawPolyline",Line:"drawPolyline",CircleMarker:"drawCircleMarker",Edit:"editMode",Drag:"dragMode",Cut:"cutPolygon",Removal:"removalMode",Rotate:"rotateMode",Text:"drawText"}},_btnNameMapping(y){let S=this._shapeMapping();return S[y]?S[y]:y}}),Jo=Va,zl=f(Li()),os={_initSnappableMarkers(){this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,this._assignEvents(this._markers),this._layer.off("pm:dragstart",this._unsnap,this),this._layer.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){this._layer.off("pm:dragstart",this._unsnap,this)},_assignEvents(y){y.forEach(S=>{if(Array.isArray(S)){this._assignEvents(S);return}S.off("drag",this._handleSnapping,this),S.on("drag",this._handleSnapping,this),S.off("dragend",this._cleanupSnapping,this),S.on("dragend",this._cleanupSnapping,this)})},_cleanupSnapping(y){if(y){let S=y.target;S._snapped=!1}delete this._snapList,this.throttledList&&(this._map.off("layeradd",this.throttledList,this),this.throttledList=void 0),this._map.off("layerremove",this._handleSnapLayerRemoval,this),this.debugIndicatorLines&&this.debugIndicatorLines.forEach(S=>{S.remove()})},_handleThrottleSnapping(){this.throttledList&&this._createSnapList()},_handleSnapping(y){var xe,Fe,tt;let S=y.target;if(S._snapped=!1,this.throttledList||(this.throttledList=L.Util.throttle(this._handleThrottleSnapping,100,this)),((xe=y==null?void 0:y.originalEvent)==null?void 0:xe.altKey)||((tt=(Fe=this._map)==null?void 0:Fe.pm)==null?void 0:tt.Keyboard.isAltKeyPressed())||(this._snapList===void 0&&(this._createSnapList(),this._map.off("layeradd",this.throttledList,this),this._map.on("layeradd",this.throttledList,this)),this._snapList.length<=0))return!1;let I=this._calcClosestLayer(S.getLatLng(),this._snapList);if(Object.keys(I).length===0)return!1;let F=I.layer instanceof L.Marker||I.layer instanceof L.CircleMarker||!this.options.snapSegment,G;F?G=I.latlng:G=this._checkPrioritiySnapping(I);let te=this.options.snapDistance,pe={marker:S,shape:this._shape,snapLatLng:G,segment:I.segment,layer:this._layer,workingLayer:this._layer,layerInteractedWith:I.layer,distance:I.distance};if(this._fireSnapDrag(pe.marker,pe),this._fireSnapDrag(this._layer,pe),I.distance<te){S._orgLatLng=S.getLatLng(),S.setLatLng(G),S._snapped=!0,S._snapInfo=pe;let zt=()=>{this._snapLatLng=G,this._fireSnap(S,pe),this._fireSnap(this._layer,pe)},bt=this._snapLatLng||{},dn=G||{};(bt.lat!==dn.lat||bt.lng!==dn.lng)&&zt()}else this._snapLatLng&&(this._unsnap(pe),S._snapped=!1,S._snapInfo=void 0,this._fireUnsnap(pe.marker,pe),this._fireUnsnap(this._layer,pe));return!0},_createSnapList(){let y=[],S=[],I=this._map;I.off("layerremove",this._handleSnapLayerRemoval,this),I.on("layerremove",this._handleSnapLayerRemoval,this),I.eachLayer(F=>{if((F instanceof L.Polyline||F instanceof L.Marker||F instanceof L.CircleMarker||F instanceof L.ImageOverlay)&&F.options.snapIgnore!==!0){if(F.options.snapIgnore===void 0&&(!L.PM.optIn&&F.options.pmIgnore===!0||L.PM.optIn&&F.options.pmIgnore!==!1))return;(F instanceof L.Circle||F instanceof L.CircleMarker)&&F.pm&&F.pm._hiddenPolyCircle?y.push(F.pm._hiddenPolyCircle):F instanceof L.ImageOverlay&&(F=L.rectangle(F.getBounds())),y.push(F);let G=L.polyline([],{color:"red",pmIgnore:!0});G._pmTempLayer=!0,S.push(G),(F instanceof L.Circle||F instanceof L.CircleMarker)&&S.push(G)}}),y=y.filter(F=>this._layer!==F),y=y.filter(F=>F._latlng||F._latlngs&&ro(F._latlngs)),y=y.filter(F=>!F._pmTempLayer),this._otherSnapLayers?(this._otherSnapLayers.forEach(()=>{let F=L.polyline([],{color:"red",pmIgnore:!0});F._pmTempLayer=!0,S.push(F)}),this._snapList=y.concat(this._otherSnapLayers)):this._snapList=y,this.debugIndicatorLines=S},_handleSnapLayerRemoval({layer:y}){if(!y._leaflet_id)return;let S=this._snapList.findIndex(I=>I._leaflet_id===y._leaflet_id);S>-1&&this._snapList.splice(S,1)},_calcClosestLayer(y,S){return this._calcClosestLayers(y,S,1)[0]},_calcClosestLayers(y,S,I=1){let F=[],G={};S.forEach((pe,xe)=>{var tt;if(pe._parentCopy&&pe._parentCopy===this._layer||((tt=pe.getLatLngs)==null?void 0:tt.call(pe).flat(5).length)<2)return;let Fe=this._calcLayerDistances(y,pe);if(Fe.distance=Math.floor(Fe.distance),this.debugIndicatorLines){if(!this.debugIndicatorLines[xe]){let zt=L.polyline([],{color:"red",pmIgnore:!0});zt._pmTempLayer=!0,this.debugIndicatorLines[xe]=zt}this.debugIndicatorLines[xe].setLatLngs([y,Fe.latlng])}I===1&&(G.distance===void 0||Fe.distance-5<=G.distance)?(Fe.distance+5<G.distance&&(F=[]),G=Fe,G.layer=pe,F.push(G)):I!==1&&(G={},G=Fe,G.layer=pe,F.push(G))}),I!==1&&(F=F.sort((pe,xe)=>pe.distance-xe.distance)),I===-1&&(I=F.length);let te=this._getClosestLayerByPriority(F,I);return L.Util.isArray(te)?te:[te]},_calcLayerDistances(y,S){let I=this._map,F=S instanceof L.Marker||S instanceof L.CircleMarker,G=S instanceof L.Polygon,te=y;if(F){let pe=S.getLatLng();return{latlng:{...pe},distance:this._getDistance(I,pe,te)}}return this._calcLatLngDistances(te,S.getLatLngs(),I,G)},_calcLatLngDistances(y,S,I,F=!1){let G,te,pe,xe=Fe=>{Fe.forEach((tt,zt)=>{if(Array.isArray(tt)){xe(tt);return}if(this.options.snapSegment){let bt=tt,dn;F?dn=zt+1===Fe.length?0:zt+1:dn=zt+1===Fe.length?void 0:zt+1;let zn=Fe[dn];if(zn){let hr=this._getDistanceToSegment(I,y,bt,zn);(te===void 0||hr<te)&&(te=hr,pe=[bt,zn])}}else{let bt=this._getDistance(I,y,tt);(te===void 0||bt<te)&&(te=bt,G=tt)}})};return xe(S),this.options.snapSegment?{latlng:{...this._getClosestPointOnSegment(I,y,pe[0],pe[1])},segment:pe,distance:te}:{latlng:G,distance:te}},_getClosestLayerByPriority(y,S=1){y=y.sort((pe,xe)=>pe._leaflet_id-xe._leaflet_id);let I=["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],F=this._map.pm.globalOptions.snappingOrder||[],G=0,te={};return F.concat(I).forEach(pe=>{te[pe]||(G+=1,te[pe]=G)}),y.sort(pu("instanceofShape",te)),S===1?y[0]||{}:y.slice(0,S)},_checkPrioritiySnapping(y){let S=this._map,I=y.segment[0],F=y.segment[1],G=y.latlng,te=G;if(this.options.snapVertex){let pe=this._getDistance(S,I,G),xe=this._getDistance(S,F,G),Fe=pe<xe?I:F,tt=pe<xe?pe:xe;if(this.options.snapMiddle){let bt=L.PM.Utils.calcMiddleLatLng(S,I,F),dn=this._getDistance(S,bt,G);dn<pe&&dn<xe&&(Fe=bt,tt=dn)}let zt=this.options.snapDistance;tt<zt&&(te=Fe)}return{...te}},_unsnap(){delete this._snapLatLng},_getClosestPointOnSegment(y,S,I,F){let G=y.getMaxZoom();G===1/0&&(G=y.getZoom());let te=y.project(S,G),pe=y.project(I,G),xe=y.project(F,G),Fe=L.LineUtil.closestPointOnSegment(te,pe,xe);return y.unproject(Fe,G)},_getDistanceToSegment(y,S,I,F){let G=y.latLngToContainerPoint(S),te=y.latLngToContainerPoint(I),pe=y.latLngToContainerPoint(F);return L.LineUtil.pointToSegmentDistance(G,te,pe)},_getDistance(y,S,I){return y.latLngToContainerPoint(S).distanceTo(y.latLngToContainerPoint(I))}},ca=os,il=L.Class.extend({includes:[ca,Iu],options:{snappable:!0,snapDistance:20,snapMiddle:!1,allowSelfIntersection:!0,tooltips:!0,templineStyle:{},hintlineStyle:{color:"#3388ff",dashArray:"5,5"},pathOptions:null,cursorMarker:!0,finishOn:null,markerStyle:{draggable:!0,icon:L.icon()},hideMiddleMarkers:!1,minRadiusCircle:null,maxRadiusCircle:null,minRadiusCircleMarker:null,maxRadiusCircleMarker:null,resizeableCircleMarker:!1,resizeableCircle:!0,markerEditable:!0,continueDrawing:!1,snapSegment:!0,requireSnapToFinish:!1,rectangleAngle:0,textOptions:{text:null,focusAfterDraw:null,removeIfEmpty:null,className:null},snapVertex:!0},setOptions(y){L.Util.setOptions(this,y),this.setStyle(this.options)},setStyle(){},getOptions(){return this.options},initialize(y){let S=new L.Icon.Default;S.options.tooltipAnchor=[0,0],this.options.markerStyle.icon=S,this._map=y,this.shapes=["Marker","CircleMarker","Line","Polygon","Rectangle","Circle","Cut","Text"],this.shapes.forEach(I=>{this[I]=new L.PM.Draw[I](this._map)}),this.Marker.setOptions({continueDrawing:!0}),this.CircleMarker.setOptions({continueDrawing:!0})},setPathOptions(y,S=!1){S?this.options.pathOptions=(0,zl.default)(this.options.pathOptions,y):this.options.pathOptions=y},getShapes(){return this.shapes},getShape(){return this._shape},enable(y,S){if(!y)throw new Error(`Error: Please pass a shape as a parameter. Possible shapes are: ${this.getShapes().join(",")}`);this.disable(),this[y].enable(S)},disable(){this.shapes.forEach(y=>{this[y].disable()})},addControls(){this.shapes.forEach(y=>{this[y].addButton()})},getActiveShape(){let y;return this.shapes.forEach(S=>{this[S]._enabled&&(y=S)}),y},_setGlobalDrawMode(){this._shape==="Cut"?this._fireGlobalCutModeToggled():this._fireGlobalDrawModeToggled();let y=[];this._map.eachLayer(S=>{(S instanceof L.Polyline||S instanceof L.Marker||S instanceof L.Circle||S instanceof L.CircleMarker||S instanceof L.ImageOverlay)&&(S._pmTempLayer||y.push(S))}),this._enabled?y.forEach(S=>{L.PM.Utils.disablePopup(S)}):y.forEach(S=>{L.PM.Utils.enablePopup(S)})},createNewDrawInstance(y,S){let I=this._getShapeFromBtnName(S);if(this[y])throw new TypeError("Draw Type already exists");if(!L.PM.Draw[I])throw new TypeError(`There is no class L.PM.Draw.${I}`);return this[y]=new L.PM.Draw[I](this._map),this[y].toolbarButtonName=y,this[y]._shape=y,this.shapes.push(y),this[S]&&this[y].setOptions(this[S].options),this[y].setOptions(this[y].options),this[y]},_getShapeFromBtnName(y){let S={drawMarker:"Marker",drawCircle:"Circle",drawPolygon:"Polygon",drawPolyline:"Line",drawRectangle:"Rectangle",drawCircleMarker:"CircleMarker",editMode:"Edit",dragMode:"Drag",cutPolygon:"Cut",removalMode:"Removal",rotateMode:"Rotate",drawText:"Text"};return S[y]?S[y]:this[y]?this[y]._shape:y},_finishLayer(y){y.pm&&(y.pm.setOptions(this.options),y.pm._shape=this._shape,y.pm._map=this._map),this._addDrawnLayerProp(y)},_addDrawnLayerProp(y){y._drawnByGeoman=!0},_setPane(y,S){S==="layerPane"?y.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":S==="vertexPane"?y.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":S==="markerPane"&&(y.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},_isFirstLayer(){return(this._map||this._layer._map).pm.getGeomanLayers().length===0}}),uo=il;uo.Marker=uo.extend({initialize(y){this._map=y,this._shape="Marker",this.toolbarButtonName="drawMarker"},enable(y){L.Util.setOptions(this,y),this._enabled=!0,this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),this.options.markerStyle),this._setPane(this._hintMarker,"markerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.tooltips&&this._hintMarker.bindTooltip(di("tooltips.placeMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this.options.markerEditable&&this._map.eachLayer(S=>{this.isRelevantMarker(S)&&S.pm.enable()}),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createMarker,this),this._hintMarker.remove(),this._map.off("mousemove",this._syncHintMarker,this),this._map.eachLayer(y=>{this.isRelevantMarker(y)&&y.pm.disable()}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(y){this.enabled()?this.disable():this.enable(y)},isRelevantMarker(y){return y instanceof L.Marker&&y.pm&&!y._pmTempLayer&&!y.pm._initTextMarker},_syncHintMarker(y){if(this._hintMarker.setLatLng(y.latlng),this.options.snappable){let S=y;S.target=this._hintMarker,this._handleSnapping(S)}this._fireChange(this._hintMarker.getLatLng(),"Draw")},_createMarker(y){if(!y.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(y.latlng);let S=this._hintMarker.getLatLng(),I=new L.Marker(S,this.options.markerStyle);this._setPane(I,"markerPane"),this._finishLayer(I),I.pm||(I.options.draggable=!1),I.addTo(this._map.pm._getContainingLayer()),I.pm&&this.options.markerEditable?I.pm.enable():I.dragging&&I.dragging.disable(),this._fireCreate(I),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},setStyle(){var y,S;(y=this.options.markerStyle)!=null&&y.icon&&((S=this._hintMarker)==null||S.setIcon(this.options.markerStyle.icon))}});var J=63710088e-1,Xe={centimeters:J*100,centimetres:J*100,degrees:J/111325,feet:J*3.28084,inches:J*39.37,kilometers:J/1e3,kilometres:J/1e3,meters:J,metres:J,miles:J/1609.344,millimeters:J*1e3,millimetres:J*1e3,nauticalmiles:J/1852,radians:1,yards:J*1.0936};function Bt(y,S,I){I===void 0&&(I={});var F={type:"Feature"};return(I.id===0||I.id)&&(F.id=I.id),I.bbox&&(F.bbox=I.bbox),F.properties=S||{},F.geometry=y,F}function nn(y,S,I){if(I===void 0&&(I={}),!y)throw new Error("coordinates is required");if(!Array.isArray(y))throw new Error("coordinates must be an Array");if(y.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Pi(y[0])||!Pi(y[1]))throw new Error("coordinates must contain numbers");var F={type:"Point",coordinates:y};return Bt(F,S,I)}function An(y,S,I){if(I===void 0&&(I={}),y.length<2)throw new Error("coordinates must be an array of two or more positions");var F={type:"LineString",coordinates:y};return Bt(F,S,I)}function Xn(y,S){S===void 0&&(S={});var I={type:"FeatureCollection"};return S.id&&(I.id=S.id),S.bbox&&(I.bbox=S.bbox),I.features=y,I}function wr(y,S){S===void 0&&(S="kilometers");var I=Xe[S];if(!I)throw new Error(S+" units is invalid");return y*I}function Wr(y,S){S===void 0&&(S="kilometers");var I=Xe[S];if(!I)throw new Error(S+" units is invalid");return y/I}function Zr(y){var S=y%(2*Math.PI);return S*180/Math.PI}function fi(y){var S=y%360;return S*Math.PI/180}function Pi(y){return!isNaN(y)&&y!==null&&!Array.isArray(y)}function Xi(y){var S,I,F={type:"FeatureCollection",features:[]};if(y.type==="Feature"?I=y.geometry:I=y,I.type==="LineString")S=[I.coordinates];else if(I.type==="MultiLineString")S=I.coordinates;else if(I.type==="MultiPolygon")S=[].concat.apply([],I.coordinates);else if(I.type==="Polygon")S=I.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return S.forEach(function(G){S.forEach(function(te){for(var pe=0;pe<G.length-1;pe++)for(var xe=pe;xe<te.length-1;xe++)if(!(G===te&&(Math.abs(pe-xe)===1||pe===0&&xe===G.length-2&&G[pe][0]===G[G.length-1][0]&&G[pe][1]===G[G.length-1][1]))){var Fe=js(G[pe][0],G[pe][1],G[pe+1][0],G[pe+1][1],te[xe][0],te[xe][1],te[xe+1][0],te[xe+1][1]);Fe&&F.features.push(nn([Fe[0],Fe[1]]))}})}),F}function js(y,S,I,F,G,te,pe,xe){var Fe,tt,zt,bt,dn,zn={x:null,y:null,onLine1:!1,onLine2:!1};return Fe=(xe-te)*(I-y)-(pe-G)*(F-S),Fe===0?zn.x!==null&&zn.y!==null?zn:!1:(tt=S-te,zt=y-G,bt=(pe-G)*tt-(xe-te)*zt,dn=(I-y)*tt-(F-S)*zt,tt=bt/Fe,zt=dn/Fe,zn.x=y+tt*(I-y),zn.y=S+tt*(F-S),tt>=0&&tt<=1&&(zn.onLine1=!0),zt>=0&&zt<=1&&(zn.onLine2=!0),zn.onLine1&&zn.onLine2?[zn.x,zn.y]:!1)}uo.Line=uo.extend({initialize(y){this._map=y,this._shape="Line",this.toolbarButtonName="drawPolyline",this._doesSelfIntersect=!1},enable(y){L.Util.setOptions(this,y),this._enabled=!0,this._markers=[],this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.polyline([],{...this.options.templineStyle,pmIgnore:!1}),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(di("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createVertex,this),this.options.finishOn&&this.options.finishOn!=="snap"&&this._map.on(this.options.finishOn,this._finishShape,this),this.options.finishOn==="dblclick"&&(this.tempMapDoubleClickZoomState=this._map.doubleClickZoom._enabled,this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.disable()),this._map.on("mousemove",this._syncHintMarker,this),this._hintMarker.on("move",this._syncHintLine,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this.isRed=!1,this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createVertex,this),this._map.off("mousemove",this._syncHintMarker,this),this.options.finishOn&&this.options.finishOn!=="snap"&&this._map.off(this.options.finishOn,this._finishShape,this),this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.enable(),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(y){this.enabled()?this.disable():this.enable(y)},_syncHintLine(){let y=this._layer.getLatLngs();if(y.length>0){let S=y[y.length-1];this._hintline.setLatLngs([S,this._hintMarker.getLatLng()])}},_syncHintMarker(y){if(this._hintMarker.setLatLng(y.latlng),this.options.snappable){let I=y;I.target=this._hintMarker,this._handleSnapping(I)}this.options.allowSelfIntersection||this._handleSelfIntersection(!0,this._hintMarker.getLatLng());let S=this._layer._defaultShape().slice();S.push(this._hintMarker.getLatLng()),this._change(S)},hasSelfIntersection(){return Xi(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersection(y,S){let I=L.polyline(this._layer.getLatLngs());y&&(S||(S=this._hintMarker.getLatLng()),I.addLatLng(S));let F=Xi(I.toGeoJSON(15));this._doesSelfIntersect=F.features.length>0,this._doesSelfIntersect?this.isRed||(this.isRed=!0,this._hintline.setStyle({color:"#f00000ff"}),this._fireIntersect(F,this._map,"Draw")):this._hintline.isEmpty()||(this.isRed=!1,this._hintline.setStyle(this.options.hintlineStyle))},_createVertex(y){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,y.latlng),this._doesSelfIntersect))return;this._hintMarker._snapped||this._hintMarker.setLatLng(y.latlng);let S=this._hintMarker.getLatLng(),I=this._layer.getLatLngs(),F=I[I.length-1];if(S.equals(I[0])||I.length>0&&S.equals(F)){this._finishShape();return}this._layer._latlngInfo=this._layer._latlngInfo||[],this._layer._latlngInfo.push({latlng:S,snapInfo:this._hintMarker._snapInfo}),this._layer.addLatLng(S);let G=this._createMarker(S);this._setTooltipText(),this._setHintLineAfterNewVertex(S),this._fireVertexAdded(G,void 0,S,"Draw"),this._change(this._layer.getLatLngs()),this.options.finishOn==="snap"&&this._hintMarker._snapped&&this._finishShape(y)},_setHintLineAfterNewVertex(y){this._hintline.setLatLngs([y,y])},_removeLastVertex(){let y=this._markers;if(y.length<=1){this.disable();return}let S=this._layer.getLatLngs(),I=y[y.length-1],{indexPath:F}=L.PM.Utils.findDeepMarkerIndex(y,I);y.pop(),this._layerGroup.removeLayer(I);let G=y[y.length-1],te=S.indexOf(G.getLatLng());S=S.slice(0,te+1),this._layer.setLatLngs(S),this._layer._latlngInfo.pop(),this._syncHintLine(),this._setTooltipText(),this._fireVertexRemoved(I,F,"Draw"),this._change(this._layer.getLatLngs())},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!1),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let y=this._layer.getLatLngs();if(y.length<=1)return;let S=L.polyline(y,this.options.pathOptions);this._setPane(S,"layerPane"),this._finishLayer(S),S.addTo(this._map.pm._getContainingLayer()),this._fireCreate(S),this.options.snappable&&this._cleanupSnapping();let I=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(I))},_createMarker(y){let S=new L.Marker(y,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(S,"vertexPane"),S._pmTempLayer=!0,this._layerGroup.addLayer(S),this._markers.push(S),S.on("click",this._finishShape,this),S},_setTooltipText(){let{length:y}=this._layer.getLatLngs().flat(),S="";y<=1?S=di("tooltips.continueLine"):S=di("tooltips.finishLine"),this._hintMarker.setTooltipContent(S)},_change(y){this._fireChange(y,"Draw")},setStyle(){var y,S;(y=this._layer)==null||y.setStyle(this.options.templineStyle),(S=this._hintline)==null||S.setStyle(this.options.hintlineStyle)}}),uo.Polygon=uo.Line.extend({initialize(y){this._map=y,this._shape="Polygon",this.toolbarButtonName="drawPolygon"},enable(y){L.PM.Draw.Line.prototype.enable.call(this,y),this._layer.pm._shape="Polygon"},_createMarker(y){let S=new L.Marker(y,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(S,"vertexPane"),S._pmTempLayer=!0,this._layerGroup.addLayer(S),this._markers.push(S),this._layer.getLatLngs().flat().length===1?(S.on("click",this._finishShape,this),this._tempSnapLayerIndex=this._otherSnapLayers.push(S)-1,this.options.snappable&&this._cleanupSnapping()):S.on("click",()=>1),S},_setTooltipText(){let{length:y}=this._layer.getLatLngs().flat(),S="";y<=2?S=di("tooltips.continueLine"):S=di("tooltips.finishPoly"),this._hintMarker.setTooltipContent(S)},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let y=this._layer.getLatLngs();if(y.length<=2)return;let S=L.polygon(y,this.options.pathOptions);this._setPane(S,"layerPane"),this._finishLayer(S),S.addTo(this._map.pm._getContainingLayer()),this._fireCreate(S),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex;let I=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(I))}}),uo.Rectangle=uo.extend({initialize(y){this._map=y,this._shape="Rectangle",this.toolbarButtonName="drawRectangle"},enable(y){if(L.Util.setOptions(this,y),this._enabled=!0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.rectangle([[0,0],[0,0]],this.options.pathOptions),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._startMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-start-marker"}),draggable:!1,zIndexOffset:-100,opacity:this.options.cursorMarker?1:0}),this._setPane(this._startMarker,"vertexPane"),this._startMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._startMarker),this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:150,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(di("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this.options.cursorMarker){this._styleMarkers=[];for(let S=0;S<2;S+=1){let I=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-style-marker"}),draggable:!1,zIndexOffset:100});this._setPane(I,"vertexPane"),I._pmTempLayer=!0,this._layerGroup.addLayer(I),this._styleMarkers.push(I)}}this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._placeStartingMarkers,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._finishShape,this),this._map.off("click",this._placeStartingMarkers,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(y){this.enabled()?this.disable():this.enable(y)},_placeStartingMarkers(y){this._hintMarker._snapped||this._hintMarker.setLatLng(y.latlng);let S=this._hintMarker.getLatLng();L.DomUtil.addClass(this._startMarker._icon,"visible"),this._startMarker.setLatLng(S),this.options.cursorMarker&&this._styleMarkers&&this._styleMarkers.forEach(I=>{L.DomUtil.addClass(I._icon,"visible"),I.setLatLng(S)}),this._map.off("click",this._placeStartingMarkers,this),this._map.on("click",this._finishShape,this),this._hintMarker.setTooltipContent(di("tooltips.finishRect")),this._setRectangleOrigin()},_setRectangleOrigin(){let y=this._startMarker.getLatLng();y&&(this._layerGroup.addLayer(this._layer),this._layer.setLatLngs([y,y]),this._hintMarker.on("move",this._syncRectangleSize,this))},_syncHintMarker(y){if(this._hintMarker.setLatLng(y.latlng),this.options.snappable){let I=y;I.target=this._hintMarker,this._handleSnapping(I)}let S=this._layerGroup&&this._layerGroup.hasLayer(this._layer)?this._layer.getLatLngs():[this._hintMarker.getLatLng()];this._fireChange(S,"Draw")},_syncRectangleSize(){let y=Qu(this._startMarker.getLatLng(),this._map),S=Qu(this._hintMarker.getLatLng(),this._map),I=L.PM.Utils._getRotatedRectangle(y,S,this.options.rectangleAngle||0,this._map);if(this._layer.setLatLngs(I),this.options.cursorMarker&&this._styleMarkers){let F=[];I.forEach(G=>{!G.equals(y,1e-8)&&!G.equals(S,1e-8)&&F.push(G)}),F.forEach((G,te)=>{try{this._styleMarkers[te].setLatLng(G)}catch{}})}},_findCorners(){let y=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(y[0],y[2],this.options.rectangleAngle||0,this._map)},_finishShape(y){this._hintMarker._snapped||this._hintMarker.setLatLng(y.latlng);let S=this._hintMarker.getLatLng(),I=this._startMarker.getLatLng();if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||I.equals(S))return;let F=L.rectangle([I,S],this.options.pathOptions);if(this.options.rectangleAngle){let te=L.PM.Utils._getRotatedRectangle(I,S,this.options.rectangleAngle||0,this._map);F.setLatLngs(te),F.pm&&F.pm._setAngle(this.options.rectangleAngle||0)}this._setPane(F,"layerPane"),this._finishLayer(F),F.addTo(this._map.pm._getContainingLayer()),this._fireCreate(F);let G=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(G))},setStyle(){var y;(y=this._layer)==null||y.setStyle(this.options.pathOptions)}}),uo.CircleMarker=uo.extend({initialize(y){this._map=y,this._shape="CircleMarker",this.toolbarButtonName="drawCircleMarker",this._layerIsDragging=!1,this._BaseCircleClass=L.CircleMarker,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._defaultRadius=10},enable(y){if(L.Util.setOptions(this,y),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),this._enabled=!0,this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._map.getContainer().classList.add("geoman-draw-cursor"),this.options[this._editableOption]){let S={};L.extend(S,this.options.templineStyle),S.radius=0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=new this._BaseCircleClass(this._map.getCenter(),S),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._centerMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon"}),draggable:!1,zIndexOffset:100}),this._setPane(this._centerMarker,"vertexPane"),this._centerMarker._pmTempLayer=!0,this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:110,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(di("tooltips.startCircle"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._map.on("click",this._placeCenterMarker,this)}else this._map.on("click",this._createMarker,this),this._hintMarker=new this._BaseCircleClass(this._map.getCenter(),{radius:this._defaultRadius,...this.options.templineStyle}),this._setPane(this._hintMarker,"layerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this._layer=this._hintMarker,this.options.tooltips&&this._hintMarker.bindTooltip(di("tooltips.placeCircleMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip();this._map.on("mousemove",this._syncHintMarker,this),this._extendingEnable(),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},_extendingEnable(){!this.options[this._editableOption]&&this.options.markerEditable&&this._map.eachLayer(y=>{this.isRelevantMarker(y)&&y.pm.enable()}),this._layer.bringToBack()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this.options[this._editableOption]?(this._map.off("click",this._finishShape,this),this._map.off("click",this._placeCenterMarker,this),this._map.removeLayer(this._layerGroup)):(this._map.off("click",this._createMarker,this),this._extendingDisable(),this._hintMarker.remove()),this._map.off("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},_extendingDisable(){this._map.eachLayer(y=>{this.isRelevantMarker(y)&&y.pm.disable()})},enabled(){return this._enabled},toggle(y){this.enabled()?this.disable():this.enable(y)},_placeCenterMarker(y){this._hintMarker._snapped||this._hintMarker.setLatLng(y.latlng),this._layerGroup.addLayer(this._layer),this._layerGroup.addLayer(this._centerMarker);let S=this._hintMarker.getLatLng();this._centerMarker.setLatLng(S),this._map.off("click",this._placeCenterMarker,this),this._map.on("click",this._finishShape,this),this._placeCircleCenter()},_placeCircleCenter(){let y=this._centerMarker.getLatLng();y&&(this._layer.setLatLng(y),this._hintMarker.on("move",this._syncHintLine,this),this._hintMarker.on("move",this._syncCircleRadius,this),this._hintMarker.setTooltipContent(di("tooltips.finishCircle")),this._fireCenterPlaced(),this._fireChange(this._layer.getLatLng(),"Draw"))},_syncHintLine(){let y=this._centerMarker.getLatLng(),S=this._getNewDestinationOfHintMarker();this._hintline.setLatLngs([y,S])},_syncCircleRadius(){let y=this._centerMarker.getLatLng(),S=this._hintMarker.getLatLng(),I=this._distanceCalculation(y,S);this.options[this._minRadiusOption]&&I<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&I>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(I)},_syncHintMarker(y){if(this._hintMarker.setLatLng(y.latlng),this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker()),this.options.snappable){let I=y;I.target=this._hintMarker,this._handleSnapping(I)}this._handleHintMarkerSnapping();let S=this._layerGroup&&this._layerGroup.hasLayer(this._centerMarker)?this._centerMarker.getLatLng():this._hintMarker.getLatLng();this._fireChange(S,"Draw")},isRelevantMarker(y){return y instanceof L.CircleMarker&&!(y instanceof L.Circle)&&y.pm&&!y._pmTempLayer},_createMarker(y){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||!y.latlng||this._layerIsDragging)return;this._hintMarker._snapped||this._hintMarker.setLatLng(y.latlng);let S=this._hintMarker.getLatLng(),I=new this._BaseCircleClass(S,{radius:this._defaultRadius,...this.options.pathOptions});this._setPane(I,"layerPane"),this._finishLayer(I),I.addTo(this._map.pm._getContainingLayer()),this._extendingCreateMarker(I),this._fireCreate(I),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},_extendingCreateMarker(y){y.pm&&this.options.markerEditable&&y.pm.enable()},_finishShape(y){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(y.latlng);let S=this._centerMarker.getLatLng(),I=this._defaultRadius;if(this.options[this._editableOption]){let pe=this._hintMarker.getLatLng();I=this._distanceCalculation(S,pe),this.options[this._minRadiusOption]&&I<this.options[this._minRadiusOption]?I=this.options[this._minRadiusOption]:this.options[this._maxRadiusOption]&&I>this.options[this._maxRadiusOption]&&(I=this.options[this._maxRadiusOption])}let F={...this.options.pathOptions,radius:I},G=new this._BaseCircleClass(S,F);this._setPane(G,"layerPane"),this._finishLayer(G),G.addTo(this._map.pm._getContainingLayer()),G.pm&&G.pm._updateHiddenPolyCircle(),this._fireCreate(G);let te=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(te))},_getNewDestinationOfHintMarker(){let y=this._hintMarker.getLatLng();if(this.options[this._editableOption]){if(!this._layerGroup.hasLayer(this._centerMarker))return y;let S=this._centerMarker.getLatLng(),I=this._distanceCalculation(S,y);this.options[this._minRadiusOption]&&I<this.options[this._minRadiusOption]?y=vs(this._map,S,y,this._getMinDistanceInMeter()):this.options[this._maxRadiusOption]&&I>this.options[this._maxRadiusOption]&&(y=vs(this._map,S,y,this._getMaxDistanceInMeter()))}return y},_getMinDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,this._centerMarker.getLatLng())},_getMaxDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,this._centerMarker.getLatLng())},_handleHintMarkerSnapping(){if(this.options[this._editableOption]){if(this._hintMarker._snapped){let y=this._centerMarker.getLatLng(),S=this._hintMarker.getLatLng(),I=this._distanceCalculation(y,S);this._layerGroup.hasLayer(this._centerMarker)&&(this.options[this._minRadiusOption]&&I<this.options[this._minRadiusOption]?this._hintMarker.setLatLng(this._hintMarker._orgLatLng):this.options[this._maxRadiusOption]&&I>this.options[this._maxRadiusOption]&&this._hintMarker.setLatLng(this._hintMarker._orgLatLng))}this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker())}},setStyle(){var S,I;let y={};L.extend(y,this.options.templineStyle),this.options[this._editableOption]&&(y.radius=0),(S=this._layer)==null||S.setStyle(y),(I=this._hintline)==null||I.setStyle(this.options.hintlineStyle)},_distanceCalculation(y,S){return this._map.project(y).distanceTo(this._map.project(S))}}),uo.Circle=uo.CircleMarker.extend({initialize(y){this._map=y,this._shape="Circle",this.toolbarButtonName="drawCircle",this._BaseCircleClass=L.Circle,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizeableCircle",this._defaultRadius=100},_extendingEnable(){},_extendingDisable(){},_extendingCreateMarker(){},isRelevantMarker(){},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_distanceCalculation(y,S){return this._map.distance(y,S)}});function cs(y){if(!y)throw new Error("coord is required");if(!Array.isArray(y)){if(y.type==="Feature"&&y.geometry!==null&&y.geometry.type==="Point")return y.geometry.coordinates;if(y.type==="Point")return y.coordinates}if(Array.isArray(y)&&y.length>=2&&!Array.isArray(y[0])&&!Array.isArray(y[1]))return y;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function _s(y){if(Array.isArray(y))return y;if(y.type==="Feature"){if(y.geometry!==null)return y.geometry.coordinates}else if(y.coordinates)return y.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function co(y){return y.type==="Feature"?y.geometry:y}function yo(y,S){return y.type==="FeatureCollection"?"FeatureCollection":y.type==="GeometryCollection"?"GeometryCollection":y.type==="Feature"&&y.geometry!==null?y.geometry.type:y.type}function $a(y,S,I){if(y!==null)for(var F,G,te,pe,xe,Fe,tt,zt=0,bt=0,dn,zn=y.type,hr=zn==="FeatureCollection",Ir=zn==="Feature",Br=hr?y.features.length:1,ci=0;ci<Br;ci++){tt=hr?y.features[ci].geometry:Ir?y.geometry:y,dn=tt?tt.type==="GeometryCollection":!1,xe=dn?tt.geometries.length:1;for(var Nt=0;Nt<xe;Nt++){var qt=0,gn=0;if(pe=dn?tt.geometries[Nt]:tt,pe!==null){Fe=pe.coordinates;var Gn=pe.type;switch(zt=0,Gn){case null:break;case"Point":if(S(Fe,bt,ci,qt,gn)===!1)return!1;bt++,qt++;break;case"LineString":case"MultiPoint":for(F=0;F<Fe.length;F++){if(S(Fe[F],bt,ci,qt,gn)===!1)return!1;bt++,Gn==="MultiPoint"&&qt++}Gn==="LineString"&&qt++;break;case"Polygon":case"MultiLineString":for(F=0;F<Fe.length;F++){for(G=0;G<Fe[F].length-zt;G++){if(S(Fe[F][G],bt,ci,qt,gn)===!1)return!1;bt++}Gn==="MultiLineString"&&qt++,Gn==="Polygon"&&gn++}Gn==="Polygon"&&qt++;break;case"MultiPolygon":for(F=0;F<Fe.length;F++){for(gn=0,G=0;G<Fe[F].length;G++){for(te=0;te<Fe[F][G].length-zt;te++){if(S(Fe[F][G][te],bt,ci,qt,gn)===!1)return!1;bt++}gn++}qt++}break;case"GeometryCollection":for(F=0;F<pe.geometries.length;F++)if($a(pe.geometries[F],S)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Ri(y,S){if(y.type==="Feature")S(y,0);else if(y.type==="FeatureCollection")for(var I=0;I<y.features.length&&S(y.features[I],I)!==!1;I++);}function Qo(y,S,I){var F=I;return Ri(y,function(G,te){te===0&&I===void 0?F=G:F=S(F,G,te)}),F}function mu(y,S){var I,F,G,te,pe,xe,Fe,tt,zt,bt,dn=0,zn=y.type==="FeatureCollection",hr=y.type==="Feature",Ir=zn?y.features.length:1;for(I=0;I<Ir;I++){for(xe=zn?y.features[I].geometry:hr?y.geometry:y,tt=zn?y.features[I].properties:hr?y.properties:{},zt=zn?y.features[I].bbox:hr?y.bbox:void 0,bt=zn?y.features[I].id:hr?y.id:void 0,Fe=xe?xe.type==="GeometryCollection":!1,pe=Fe?xe.geometries.length:1,G=0;G<pe;G++){if(te=Fe?xe.geometries[G]:xe,te===null){if(S(null,dn,tt,zt,bt)===!1)return!1;continue}switch(te.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(S(te,dn,tt,zt,bt)===!1)return!1;break}case"GeometryCollection":{for(F=0;F<te.geometries.length;F++)if(S(te.geometries[F],dn,tt,zt,bt)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}dn++}}function Eo(y,S){mu(y,function(I,F,G,te,pe){var xe=I===null?null:I.type;switch(xe){case null:case"Point":case"LineString":case"Polygon":return S(Bt(I,G,{bbox:te,id:pe}),F,0)===!1?!1:void 0}var Fe;switch(xe){case"MultiPoint":Fe="Point";break;case"MultiLineString":Fe="LineString";break;case"MultiPolygon":Fe="Polygon";break}for(var tt=0;tt<I.coordinates.length;tt++){var zt=I.coordinates[tt],bt={type:Fe,coordinates:zt};if(S(Bt(bt,G),F,tt)===!1)return!1}})}function Fc(y){if(!y)throw new Error("geojson is required");var S=[];return Eo(y,function(I){sl(I,S)}),Xn(S)}function sl(y,S){var I=[],F=y.geometry;if(F!==null){switch(F.type){case"Polygon":I=_s(F);break;case"LineString":I=[_s(F)]}I.forEach(function(G){var te=zc(G,y.properties);te.forEach(function(pe){pe.id=S.length,S.push(pe)})})}}function zc(y,S){var I=[];return y.reduce(function(F,G){var te=An([F,G],S);return te.bbox=Ou(F,G),I.push(te),G}),I}function Ou(y,S){var I=y[0],F=y[1],G=S[0],te=S[1],pe=I<G?I:G,xe=F<te?F:te,Fe=I>G?I:G,tt=F>te?F:te;return[pe,xe,Fe,tt]}var Ru=Fc,_o=f(gl(),1);function _l(y,S){var I={},F=[];if(y.type==="LineString"&&(y=Bt(y)),S.type==="LineString"&&(S=Bt(S)),y.type==="Feature"&&S.type==="Feature"&&y.geometry!==null&&S.geometry!==null&&y.geometry.type==="LineString"&&S.geometry.type==="LineString"&&y.geometry.coordinates.length===2&&S.geometry.coordinates.length===2){var G=ha(y,S);return G&&F.push(G),Xn(F)}var te=(0,_o.default)();return te.load(Ru(S)),Ri(Ru(y),function(pe){Ri(te.search(pe),function(xe){var Fe=ha(pe,xe);if(Fe){var tt=_s(Fe).join(",");I[tt]||(I[tt]=!0,F.push(Fe))}})}),Xn(F)}function ha(y,S){var I=_s(y),F=_s(S);if(I.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(F.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var G=I[0][0],te=I[0][1],pe=I[1][0],xe=I[1][1],Fe=F[0][0],tt=F[0][1],zt=F[1][0],bt=F[1][1],dn=(bt-tt)*(pe-G)-(zt-Fe)*(xe-te),zn=(zt-Fe)*(te-tt)-(bt-tt)*(G-Fe),hr=(pe-G)*(te-tt)-(xe-te)*(G-Fe);if(dn===0)return null;var Ir=zn/dn,Br=hr/dn;if(Ir>=0&&Ir<=1&&Br>=0&&Br<=1){var ci=G+Ir*(pe-G),Nt=te+Ir*(xe-te);return nn([ci,Nt])}return null}var Ta=_l,gu=f(gl(),1);function Xs(y,S,I){I===void 0&&(I={});var F=cs(y),G=cs(S),te=fi(G[1]-F[1]),pe=fi(G[0]-F[0]),xe=fi(F[1]),Fe=fi(G[1]),tt=Math.pow(Math.sin(te/2),2)+Math.pow(Math.sin(pe/2),2)*Math.cos(xe)*Math.cos(Fe);return wr(2*Math.atan2(Math.sqrt(tt),Math.sqrt(1-tt)),I.units)}var zo=Xs;function ea(y){var S=y[0],I=y[1],F=y[2],G=y[3],te=zo(y.slice(0,2),[F,I]),pe=zo(y.slice(0,2),[S,G]);if(te>=pe){var xe=(I+G)/2;return[S,xe-(F-S)/2,F,xe+(F-S)/2]}else{var Fe=(S+F)/2;return[Fe-(G-I)/2,I,Fe+(G-I)/2,G]}}var jc=ea;function Mo(y){var S=[1/0,1/0,-1/0,-1/0];return $a(y,function(I){S[0]>I[0]&&(S[0]=I[0]),S[1]>I[1]&&(S[1]=I[1]),S[2]<I[0]&&(S[2]=I[0]),S[3]<I[1]&&(S[3]=I[1])}),S}Mo.default=Mo;var jl=Mo;function mi(y,S){S===void 0&&(S={});var I=S.precision,F=S.coordinates,G=S.mutate;if(I=I==null||isNaN(I)?6:I,F=F==null||isNaN(F)?3:F,!y)throw new Error("<geojson> is required");if(typeof I!="number")throw new Error("<precision> must be a number");if(typeof F!="number")throw new Error("<coordinates> must be a number");(G===!1||G===void 0)&&(y=JSON.parse(JSON.stringify(y)));var te=Math.pow(10,I);return $a(y,function(pe){jo(pe,te,F)}),y}function jo(y,S,I){y.length>I&&y.splice(I,y.length);for(var F=0;F<y.length;F++)y[F]=Math.round(y[F]*S)/S;return y}var Bu=mi;function Nu(y,S,I){if(I===void 0&&(I={}),I.final===!0)return da(y,S);var F=cs(y),G=cs(S),te=fi(F[0]),pe=fi(G[0]),xe=fi(F[1]),Fe=fi(G[1]),tt=Math.sin(pe-te)*Math.cos(Fe),zt=Math.cos(xe)*Math.sin(Fe)-Math.sin(xe)*Math.cos(Fe)*Math.cos(pe-te);return Zr(Math.atan2(tt,zt))}function da(y,S){var I=Nu(S,y);return I=(I+180)%360,I}function ta(y,S,I,F){F===void 0&&(F={});var G=cs(y),te=fi(G[0]),pe=fi(G[1]),xe=fi(I),Fe=Wr(S,F.units),tt=Math.asin(Math.sin(pe)*Math.cos(Fe)+Math.cos(pe)*Math.sin(Fe)*Math.cos(xe)),zt=te+Math.atan2(Math.sin(xe)*Math.sin(Fe)*Math.cos(pe),Math.cos(Fe)-Math.sin(pe)*Math.sin(tt)),bt=Zr(zt),dn=Zr(tt);return nn([bt,dn],F.properties)}function Ul(y,S,I){I===void 0&&(I={});var F=nn([1/0,1/0],{dist:1/0}),G=0;return Eo(y,function(te){for(var pe=_s(te),xe=0;xe<pe.length-1;xe++){var Fe=nn(pe[xe]);Fe.properties.dist=zo(S,Fe,I);var tt=nn(pe[xe+1]);tt.properties.dist=zo(S,tt,I);var zt=zo(Fe,tt,I),bt=Math.max(Fe.properties.dist,tt.properties.dist),dn=Nu(Fe,tt),zn=ta(S,bt,dn+90,I),hr=ta(S,bt,dn-90,I),Ir=Ta(An([zn.geometry.coordinates,hr.geometry.coordinates]),An([Fe.geometry.coordinates,tt.geometry.coordinates])),Br=null;Ir.features.length>0&&(Br=Ir.features[0],Br.properties.dist=zo(S,Br,I),Br.properties.location=G+zo(Fe,Br,I)),Fe.properties.dist<F.properties.dist&&(F=Fe,F.properties.index=xe,F.properties.location=G),tt.properties.dist<F.properties.dist&&(F=tt,F.properties.index=xe+1,F.properties.location=G+zt),Br&&Br.properties.dist<F.properties.dist&&(F=Br,F.properties.index=xe),G+=zt}}),F}var ol=Ul;function na(y,S){if(!y)throw new Error("line is required");if(!S)throw new Error("splitter is required");var I=yo(y),F=yo(S);if(I!=="LineString")throw new Error("line must be LineString");if(F==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(F==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var G=Bu(S,{precision:7});switch(F){case"Point":return nr(y,G);case"MultiPoint":return Ln(y,G);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return Ln(y,Ta(y,G))}}function Ln(y,S){var I=[],F=(0,gu.default)();return Eo(S,function(G){if(I.forEach(function(xe,Fe){xe.id=Fe}),!I.length)I=nr(y,G).features,I.forEach(function(xe){xe.bbox||(xe.bbox=jc(jl(xe)))}),F.load(Xn(I));else{var te=F.search(G);if(te.features.length){var pe=Fn(G,te);I=I.filter(function(xe){return xe.id!==pe.id}),F.remove(pe),Ri(nr(pe,G),function(xe){I.push(xe),F.insert(xe)})}}}),Xn(I)}function nr(y,S){var I=[],F=_s(y)[0],G=_s(y)[y.geometry.coordinates.length-1];if(Hr(F,cs(S))||Hr(G,cs(S)))return Xn([y]);var te=(0,gu.default)(),pe=Ru(y);te.load(pe);var xe=te.search(S);if(!xe.features.length)return Xn([y]);var Fe=Fn(S,xe),tt=[F],zt=Qo(pe,function(bt,dn,zn){var hr=_s(dn)[1],Ir=cs(S);return zn===Fe.id?(bt.push(Ir),I.push(An(bt)),Hr(Ir,hr)?[Ir]:[Ir,hr]):(bt.push(hr),bt)},tt);return zt.length>1&&I.push(An(zt)),Xn(I)}function Fn(y,S){if(!S.features.length)throw new Error("lines must contain features");if(S.features.length===1)return S.features[0];var I,F=1/0;return Ri(S,function(G){var te=ol(G,y),pe=te.properties.dist;pe<F&&(I=G,F=pe)}),I}function Hr(y,S){return y[0]===S[0]&&y[1]===S[1]}var ii=na;function xi(y,S,I){if(I===void 0&&(I={}),!y)throw new Error("point is required");if(!S)throw new Error("polygon is required");var F=cs(y),G=co(S),te=G.type,pe=S.bbox,xe=G.coordinates;if(pe&&Cs(F,pe)===!1)return!1;te==="Polygon"&&(xe=[xe]);for(var Fe=!1,tt=0;tt<xe.length&&!Fe;tt++)if(as(F,xe[tt][0],I.ignoreBoundary)){for(var zt=!1,bt=1;bt<xe[tt].length&&!zt;)as(F,xe[tt][bt],!I.ignoreBoundary)&&(zt=!0),bt++;zt||(Fe=!0)}return Fe}function as(y,S,I){var F=!1;S[0][0]===S[S.length-1][0]&&S[0][1]===S[S.length-1][1]&&(S=S.slice(0,S.length-1));for(var G=0,te=S.length-1;G<S.length;te=G++){var pe=S[G][0],xe=S[G][1],Fe=S[te][0],tt=S[te][1],zt=y[1]*(pe-Fe)+xe*(Fe-y[0])+tt*(y[0]-pe)===0&&(pe-y[0])*(Fe-y[0])<=0&&(xe-y[1])*(tt-y[1])<=0;if(zt)return!I;var bt=xe>y[1]!=tt>y[1]&&y[0]<(Fe-pe)*(y[1]-xe)/(tt-xe)+pe;bt&&(F=!F)}return F}function Cs(y,S){return S[0]<=y[0]&&S[1]<=y[1]&&S[2]>=y[0]&&S[3]>=y[1]}function dc(y,S,I){I===void 0&&(I={});for(var F=cs(y),G=_s(S),te=0;te<G.length-1;te++){var pe=!1;if(I.ignoreEndVertices&&(te===0&&(pe="start"),te===G.length-2&&(pe="end"),te===0&&te+1===G.length-1&&(pe="both")),ra(G[te],G[te+1],F,pe,typeof I.epsilon>"u"?null:I.epsilon))return!0}return!1}function ra(y,S,I,F,G){var te=I[0],pe=I[1],xe=y[0],Fe=y[1],tt=S[0],zt=S[1],bt=I[0]-xe,dn=I[1]-Fe,zn=tt-xe,hr=zt-Fe,Ir=bt*hr-dn*zn;if(G!==null){if(Math.abs(Ir)>G)return!1}else if(Ir!==0)return!1;if(F){if(F==="start")return Math.abs(zn)>=Math.abs(hr)?zn>0?xe<te&&te<=tt:tt<=te&&te<xe:hr>0?Fe<pe&&pe<=zt:zt<=pe&&pe<Fe;if(F==="end")return Math.abs(zn)>=Math.abs(hr)?zn>0?xe<=te&&te<tt:tt<te&&te<=xe:hr>0?Fe<=pe&&pe<zt:zt<pe&&pe<=Fe;if(F==="both")return Math.abs(zn)>=Math.abs(hr)?zn>0?xe<te&&te<tt:tt<te&&te<xe:hr>0?Fe<pe&&pe<zt:zt<pe&&pe<Fe}else return Math.abs(zn)>=Math.abs(hr)?zn>0?xe<=te&&te<=tt:tt<=te&&te<=xe:hr>0?Fe<=pe&&pe<=zt:zt<=pe&&pe<=Fe;return!1}var Ts=dc;function al(y,S){var I=co(y),F=co(S),G=I.type,te=F.type,pe=I.coordinates,xe=F.coordinates;switch(G){case"Point":switch(te){case"Point":return oi(pe,xe);default:throw new Error("feature2 "+te+" geometry not supported")}case"MultiPoint":switch(te){case"Point":return bl(I,F);case"MultiPoint":return Ga(I,F);default:throw new Error("feature2 "+te+" geometry not supported")}case"LineString":switch(te){case"Point":return Ts(F,I,{ignoreEndVertices:!0});case"LineString":return Ui(I,F);case"MultiPoint":return ll(I,F);default:throw new Error("feature2 "+te+" geometry not supported")}case"Polygon":switch(te){case"Point":return xi(F,I,{ignoreBoundary:!0});case"LineString":return fa(I,F);case"Polygon":return Uo(I,F);case"MultiPoint":return Vl(I,F);default:throw new Error("feature2 "+te+" geometry not supported")}default:throw new Error("feature1 "+G+" geometry not supported")}}function bl(y,S){var I,F=!1;for(I=0;I<y.coordinates.length;I++)if(oi(y.coordinates[I],S.coordinates)){F=!0;break}return F}function Ga(y,S){for(var I=0,F=S.coordinates;I<F.length;I++){for(var G=F[I],te=!1,pe=0,xe=y.coordinates;pe<xe.length;pe++){var Fe=xe[pe];if(oi(G,Fe)){te=!0;break}}if(!te)return!1}return!0}function ll(y,S){for(var I=!1,F=0,G=S.coordinates;F<G.length;F++){var te=G[F];if(Ts(te,y,{ignoreEndVertices:!0})&&(I=!0),!Ts(te,y))return!1}return!!I}function Vl(y,S){for(var I=0,F=S.coordinates;I<F.length;I++){var G=F[I];if(!xi(G,y,{ignoreBoundary:!0}))return!1}return!0}function Ui(y,S){for(var I=!1,F=0,G=S.coordinates;F<G.length;F++){var te=G[F];if(Ts({type:"Point",coordinates:te},y,{ignoreEndVertices:!0})&&(I=!0),!Ts({type:"Point",coordinates:te},y,{ignoreEndVertices:!1}))return!1}return I}function fa(y,S){var I=!1,F=0,G=jl(y),te=jl(S);if(!bs(G,te))return!1;for(F;F<S.coordinates.length-1;F++){var pe=io(S.coordinates[F],S.coordinates[F+1]);if(xi({type:"Point",coordinates:pe},y,{ignoreBoundary:!0})){I=!0;break}}return I}function Uo(y,S){if(y.type==="Feature"&&y.geometry===null||S.type==="Feature"&&S.geometry===null)return!1;var I=jl(y),F=jl(S);if(!bs(I,F))return!1;for(var G=co(S).coordinates,te=0,pe=G;te<pe.length;te++)for(var xe=pe[te],Fe=0,tt=xe;Fe<tt.length;Fe++){var zt=tt[Fe];if(!xi(zt,y))return!1}return!0}function bs(y,S){return!(y[0]>S[0]||y[2]<S[2]||y[1]>S[1]||y[3]<S[3])}function oi(y,S){return y[0]===S[0]&&y[1]===S[1]}function io(y,S){return[(y[0]+S[0])/2,(y[1]+S[1])/2]}var Us=f(ja()),pa=y=>()=>y,Vo=y=>{let S=y?(I,F)=>F.minus(I).abs().isLessThanOrEqualTo(y):pa(!1);return(I,F)=>S(I,F)?0:I.comparedTo(F)};function xl(y){let S=y?(I,F,G,te,pe)=>I.exponentiatedBy(2).isLessThanOrEqualTo(te.minus(F).exponentiatedBy(2).plus(pe.minus(G).exponentiatedBy(2)).times(y)):pa(!1);return(I,F,G)=>{let te=I.x,pe=I.y,xe=G.x,Fe=G.y,tt=pe.minus(Fe).times(F.x.minus(xe)).minus(te.minus(xe).times(F.y.minus(Fe)));return S(tt,te,pe,xe,Fe)?0:tt.comparedTo(0)}}var ah=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,wl=Math.ceil,To=Math.floor,ks="[BigNumber Error] ",ho=ks+"Number primitive has more than 15 significant digits: ",$o=1e14,vi=14,$l=9007199254740991,yu=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],Ha=1e7,Go=1e9;function Uc(y){var S,I,F,G=Nt.prototype={constructor:Nt,toString:null,valueOf:null},te=new Nt(1),pe=20,xe=4,Fe=-7,tt=21,zt=-1e7,bt=1e7,dn=!1,zn=1,hr=0,Ir={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},Br="0123456789abcdefghijklmnopqrstuvwxyz",ci=!0;function Nt(Ge,at){var mt,_t,St,Lt,sn,E,s,c,g=this;if(!(g instanceof Nt))return new Nt(Ge,at);if(at==null){if(Ge&&Ge._isBigNumber===!0){g.s=Ge.s,!Ge.c||Ge.e>bt?g.c=g.e=null:Ge.e<zt?g.c=[g.e=0]:(g.e=Ge.e,g.c=Ge.c.slice());return}if((E=typeof Ge=="number")&&Ge*0==0){if(g.s=1/Ge<0?(Ge=-Ge,-1):1,Ge===~~Ge){for(Lt=0,sn=Ge;sn>=10;sn/=10,Lt++);Lt>bt?g.c=g.e=null:(g.e=Lt,g.c=[Ge]);return}c=String(Ge)}else{if(!ah.test(c=String(Ge)))return F(g,c,E);g.s=c.charCodeAt(0)==45?(c=c.slice(1),-1):1}(Lt=c.indexOf("."))>-1&&(c=c.replace(".","")),(sn=c.search(/e/i))>0?(Lt<0&&(Lt=sn),Lt+=+c.slice(sn+1),c=c.substring(0,sn)):Lt<0&&(Lt=c.length)}else{if(p(at,2,Br.length,"Base"),at==10&&ci)return g=new Nt(Ge),Mn(g,pe+g.e+1,xe);if(c=String(Ge),E=typeof Ge=="number"){if(Ge*0!=0)return F(g,c,E,at);if(g.s=1/Ge<0?(c=c.slice(1),-1):1,Nt.DEBUG&&c.replace(/^0\.0*|\./,"").length>15)throw Error(ho+Ge)}else g.s=c.charCodeAt(0)===45?(c=c.slice(1),-1):1;for(mt=Br.slice(0,at),Lt=sn=0,s=c.length;sn<s;sn++)if(mt.indexOf(_t=c.charAt(sn))<0){if(_t=="."){if(sn>Lt){Lt=s;continue}}else if(!St&&(c==c.toUpperCase()&&(c=c.toLowerCase())||c==c.toLowerCase()&&(c=c.toUpperCase()))){St=!0,sn=-1,Lt=0;continue}return F(g,String(Ge),E,at)}E=!1,c=I(c,at,10,g.s),(Lt=c.indexOf("."))>-1?c=c.replace(".",""):Lt=c.length}for(sn=0;c.charCodeAt(sn)===48;sn++);for(s=c.length;c.charCodeAt(--s)===48;);if(c=c.slice(sn,++s)){if(s-=sn,E&&Nt.DEBUG&&s>15&&(Ge>$l||Ge!==To(Ge)))throw Error(ho+g.s*Ge);if((Lt=Lt-sn-1)>bt)g.c=g.e=null;else if(Lt<zt)g.c=[g.e=0];else{if(g.e=Lt,g.c=[],sn=(Lt+1)%vi,Lt<0&&(sn+=vi),sn<s){for(sn&&g.c.push(+c.slice(0,sn)),s-=vi;sn<s;)g.c.push(+c.slice(sn,sn+=vi));sn=vi-(c=c.slice(sn)).length}else sn-=s;for(;sn--;c+="0");g.c.push(+c)}}else g.c=[g.e=0]}Nt.clone=Uc,Nt.ROUND_UP=0,Nt.ROUND_DOWN=1,Nt.ROUND_CEIL=2,Nt.ROUND_FLOOR=3,Nt.ROUND_HALF_UP=4,Nt.ROUND_HALF_DOWN=5,Nt.ROUND_HALF_EVEN=6,Nt.ROUND_HALF_CEIL=7,Nt.ROUND_HALF_FLOOR=8,Nt.EUCLID=9,Nt.config=Nt.set=function(Ge){var at,mt;if(Ge!=null)if(typeof Ge=="object"){if(Ge.hasOwnProperty(at="DECIMAL_PLACES")&&(mt=Ge[at],p(mt,0,Go,at),pe=mt),Ge.hasOwnProperty(at="ROUNDING_MODE")&&(mt=Ge[at],p(mt,0,8,at),xe=mt),Ge.hasOwnProperty(at="EXPONENTIAL_AT")&&(mt=Ge[at],mt&&mt.pop?(p(mt[0],-1e9,0,at),p(mt[1],0,Go,at),Fe=mt[0],tt=mt[1]):(p(mt,-1e9,Go,at),Fe=-(tt=mt<0?-mt:mt))),Ge.hasOwnProperty(at="RANGE"))if(mt=Ge[at],mt&&mt.pop)p(mt[0],-1e9,-1,at),p(mt[1],1,Go,at),zt=mt[0],bt=mt[1];else if(p(mt,-1e9,Go,at),mt)zt=-(bt=mt<0?-mt:mt);else throw Error(ks+at+" cannot be zero: "+mt);if(Ge.hasOwnProperty(at="CRYPTO"))if(mt=Ge[at],mt===!!mt)if(mt)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))dn=mt;else throw dn=!mt,Error(ks+"crypto unavailable");else dn=mt;else throw Error(ks+at+" not true or false: "+mt);if(Ge.hasOwnProperty(at="MODULO_MODE")&&(mt=Ge[at],p(mt,0,9,at),zn=mt),Ge.hasOwnProperty(at="POW_PRECISION")&&(mt=Ge[at],p(mt,0,Go,at),hr=mt),Ge.hasOwnProperty(at="FORMAT"))if(mt=Ge[at],typeof mt=="object")Ir=mt;else throw Error(ks+at+" not an object: "+mt);if(Ge.hasOwnProperty(at="ALPHABET"))if(mt=Ge[at],typeof mt=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(mt))ci=mt.slice(0,10)=="0123456789",Br=mt;else throw Error(ks+at+" invalid: "+mt)}else throw Error(ks+"Object expected: "+Ge);return{DECIMAL_PLACES:pe,ROUNDING_MODE:xe,EXPONENTIAL_AT:[Fe,tt],RANGE:[zt,bt],CRYPTO:dn,MODULO_MODE:zn,POW_PRECISION:hr,FORMAT:Ir,ALPHABET:Br}},Nt.isBigNumber=function(Ge){if(!Ge||Ge._isBigNumber!==!0)return!1;if(!Nt.DEBUG)return!0;var at,mt,_t=Ge.c,St=Ge.e,Lt=Ge.s;e:if({}.toString.call(_t)=="[object Array]"){if((Lt===1||Lt===-1)&&St>=-1e9&&St<=Go&&St===To(St)){if(_t[0]===0){if(St===0&&_t.length===1)return!0;break e}if(at=(St+1)%vi,at<1&&(at+=vi),String(_t[0]).length==at){for(at=0;at<_t.length;at++)if(mt=_t[at],mt<0||mt>=$o||mt!==To(mt))break e;if(mt!==0)return!0}}}else if(_t===null&&St===null&&(Lt===null||Lt===1||Lt===-1))return!0;throw Error(ks+"Invalid BigNumber: "+Ge)},Nt.maximum=Nt.max=function(){return gn(arguments,-1)},Nt.minimum=Nt.min=function(){return gn(arguments,1)},Nt.random=function(){var Ge=9007199254740992,at=Math.random()*Ge&2097151?function(){return To(Math.random()*Ge)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(mt){var _t,St,Lt,sn,E,s=0,c=[],g=new Nt(te);if(mt==null?mt=pe:p(mt,0,Go),sn=wl(mt/vi),dn)if(crypto.getRandomValues){for(_t=crypto.getRandomValues(new Uint32Array(sn*=2));s<sn;)E=_t[s]*131072+(_t[s+1]>>>11),E>=9e15?(St=crypto.getRandomValues(new Uint32Array(2)),_t[s]=St[0],_t[s+1]=St[1]):(c.push(E%1e14),s+=2);s=sn/2}else if(crypto.randomBytes){for(_t=crypto.randomBytes(sn*=7);s<sn;)E=(_t[s]&31)*281474976710656+_t[s+1]*1099511627776+_t[s+2]*4294967296+_t[s+3]*16777216+(_t[s+4]<<16)+(_t[s+5]<<8)+_t[s+6],E>=9e15?crypto.randomBytes(7).copy(_t,s):(c.push(E%1e14),s+=7);s=sn/7}else throw dn=!1,Error(ks+"crypto unavailable");if(!dn)for(;s<sn;)E=at(),E<9e15&&(c[s++]=E%1e14);for(sn=c[--s],mt%=vi,sn&&mt&&(E=yu[vi-mt],c[s]=To(sn/E)*E);c[s]===0;c.pop(),s--);if(s<0)c=[Lt=0];else{for(Lt=-1;c[0]===0;c.splice(0,1),Lt-=vi);for(s=1,E=c[0];E>=10;E/=10,s++);s<vi&&(Lt-=vi-s)}return g.e=Lt,g.c=c,g}}(),Nt.sum=function(){for(var Ge=1,at=arguments,mt=new Nt(at[0]);Ge<at.length;)mt=mt.plus(at[Ge++]);return mt},I=function(){var Ge="0123456789";function at(mt,_t,St,Lt){for(var sn,E=[0],s,c=0,g=mt.length;c<g;){for(s=E.length;s--;E[s]*=_t);for(E[0]+=Lt.indexOf(mt.charAt(c++)),sn=0;sn<E.length;sn++)E[sn]>St-1&&(E[sn+1]==null&&(E[sn+1]=0),E[sn+1]+=E[sn]/St|0,E[sn]%=St)}return E.reverse()}return function(mt,_t,St,Lt,sn){var E,s,c,g,x,A,N,$,Z=mt.indexOf("."),re=pe,fe=xe;for(Z>=0&&(g=hr,hr=0,mt=mt.replace(".",""),$=new Nt(_t),A=$.pow(mt.length-Z),hr=g,$.c=at(se(Ao(A.c),A.e,"0"),10,St,Ge),$.e=$.c.length),N=at(mt,_t,St,sn?(E=Br,Ge):(E=Ge,Br)),c=g=N.length;N[--g]==0;N.pop());if(!N[0])return E.charAt(0);if(Z<0?--c:(A.c=N,A.e=c,A.s=Lt,A=S(A,$,re,fe,St),N=A.c,x=A.r,c=A.e),s=c+re+1,Z=N[s],g=St/2,x=x||s<0||N[s+1]!=null,x=fe<4?(Z!=null||x)&&(fe==0||fe==(A.s<0?3:2)):Z>g||Z==g&&(fe==4||x||fe==6&&N[s-1]&1||fe==(A.s<0?8:7)),s<1||!N[0])mt=x?se(E.charAt(1),-re,E.charAt(0)):E.charAt(0);else{if(N.length=s,x)for(--St;++N[--s]>St;)N[s]=0,s||(++c,N=[1].concat(N));for(g=N.length;!N[--g];);for(Z=0,mt="";Z<=g;mt+=E.charAt(N[Z++]));mt=se(mt,c,E.charAt(0))}return mt}}(),S=function(){function Ge(_t,St,Lt){var sn,E,s,c,g=0,x=_t.length,A=St%Ha,N=St/Ha|0;for(_t=_t.slice();x--;)s=_t[x]%Ha,c=_t[x]/Ha|0,sn=N*s+c*A,E=A*s+sn%Ha*Ha+g,g=(E/Lt|0)+(sn/Ha|0)+N*c,_t[x]=E%Lt;return g&&(_t=[g].concat(_t)),_t}function at(_t,St,Lt,sn){var E,s;if(Lt!=sn)s=Lt>sn?1:-1;else for(E=s=0;E<Lt;E++)if(_t[E]!=St[E]){s=_t[E]>St[E]?1:-1;break}return s}function mt(_t,St,Lt,sn){for(var E=0;Lt--;)_t[Lt]-=E,E=_t[Lt]<St[Lt]?1:0,_t[Lt]=E*sn+_t[Lt]-St[Lt];for(;!_t[0]&&_t.length>1;_t.splice(0,1));}return function(_t,St,Lt,sn,E){var s,c,g,x,A,N,$,Z,re,fe,Me,ke,Ke,Qe,Tt,Ct,At,Rt=_t.s==St.s?1:-1,jt=_t.c,Vt=St.c;if(!jt||!jt[0]||!Vt||!Vt[0])return new Nt(!_t.s||!St.s||(jt?Vt&&jt[0]==Vt[0]:!Vt)?NaN:jt&&jt[0]==0||!Vt?Rt*0:Rt/0);for(Z=new Nt(Rt),re=Z.c=[],c=_t.e-St.e,Rt=Lt+c+1,E||(E=$o,c=Ho(_t.e/vi)-Ho(St.e/vi),Rt=Rt/vi|0),g=0;Vt[g]==(jt[g]||0);g++);if(Vt[g]>(jt[g]||0)&&c--,Rt<0)re.push(1),x=!0;else{for(Qe=jt.length,Ct=Vt.length,g=0,Rt+=2,A=To(E/(Vt[0]+1)),A>1&&(Vt=Ge(Vt,A,E),jt=Ge(jt,A,E),Ct=Vt.length,Qe=jt.length),Ke=Ct,fe=jt.slice(0,Ct),Me=fe.length;Me<Ct;fe[Me++]=0);At=Vt.slice(),At=[0].concat(At),Tt=Vt[0],Vt[1]>=E/2&&Tt++;do{if(A=0,s=at(Vt,fe,Ct,Me),s<0){if(ke=fe[0],Ct!=Me&&(ke=ke*E+(fe[1]||0)),A=To(ke/Tt),A>1)for(A>=E&&(A=E-1),N=Ge(Vt,A,E),$=N.length,Me=fe.length;at(N,fe,$,Me)==1;)A--,mt(N,Ct<$?At:Vt,$,E),$=N.length,s=1;else A==0&&(s=A=1),N=Vt.slice(),$=N.length;if($<Me&&(N=[0].concat(N)),mt(fe,N,Me,E),Me=fe.length,s==-1)for(;at(Vt,fe,Ct,Me)<1;)A++,mt(fe,Ct<Me?At:Vt,Me,E),Me=fe.length}else s===0&&(A++,fe=[0]);re[g++]=A,fe[0]?fe[Me++]=jt[Ke]||0:(fe=[jt[Ke]],Me=1)}while((Ke++<Qe||fe[0]!=null)&&Rt--);x=fe[0]!=null,re[0]||re.splice(0,1)}if(E==$o){for(g=1,Rt=re[0];Rt>=10;Rt/=10,g++);Mn(Z,Lt+(Z.e=g+c*vi-1)+1,sn,x)}else Z.e=c,Z.r=+x;return Z}}();function qt(Ge,at,mt,_t){var St,Lt,sn,E,s;if(mt==null?mt=xe:p(mt,0,8),!Ge.c)return Ge.toString();if(St=Ge.c[0],sn=Ge.e,at==null)s=Ao(Ge.c),s=_t==1||_t==2&&(sn<=Fe||sn>=tt)?U(s,sn):se(s,sn,"0");else if(Ge=Mn(new Nt(Ge),at,mt),Lt=Ge.e,s=Ao(Ge.c),E=s.length,_t==1||_t==2&&(at<=Lt||Lt<=Fe)){for(;E<at;s+="0",E++);s=U(s,Lt)}else if(at-=sn,s=se(s,Lt,"0"),Lt+1>E){if(--at>0)for(s+=".";at--;s+="0");}else if(at+=Lt-E,at>0)for(Lt+1==E&&(s+=".");at--;s+="0");return Ge.s<0&&St?"-"+s:s}function gn(Ge,at){for(var mt,_t,St=1,Lt=new Nt(Ge[0]);St<Ge.length;St++)_t=new Nt(Ge[St]),(!_t.s||(mt=Gl(Lt,_t))===at||mt===0&&Lt.s===at)&&(Lt=_t);return Lt}function Gn(Ge,at,mt){for(var _t=1,St=at.length;!at[--St];at.pop());for(St=at[0];St>=10;St/=10,_t++);return(mt=_t+mt*vi-1)>bt?Ge.c=Ge.e=null:mt<zt?Ge.c=[Ge.e=0]:(Ge.e=mt,Ge.c=at),Ge}F=function(){var Ge=/^(-?)0([xbo])(?=\w[\w.]*$)/i,at=/^([^.]+)\.$/,mt=/^\.([^.]+)$/,_t=/^-?(Infinity|NaN)$/,St=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(Lt,sn,E,s){var c,g=E?sn:sn.replace(St,"");if(_t.test(g))Lt.s=isNaN(g)?null:g<0?-1:1;else{if(!E&&(g=g.replace(Ge,function(x,A,N){return c=(N=N.toLowerCase())=="x"?16:N=="b"?2:8,!s||s==c?A:x}),s&&(c=s,g=g.replace(at,"$1").replace(mt,"0.$1")),sn!=g))return new Nt(g,c);if(Nt.DEBUG)throw Error(ks+"Not a"+(s?" base "+s:"")+" number: "+sn);Lt.s=null}Lt.c=Lt.e=null}}();function Mn(Ge,at,mt,_t){var St,Lt,sn,E,s,c,g,x=Ge.c,A=yu;if(x){e:{for(St=1,E=x[0];E>=10;E/=10,St++);if(Lt=at-St,Lt<0)Lt+=vi,sn=at,s=x[c=0],g=To(s/A[St-sn-1]%10);else if(c=wl((Lt+1)/vi),c>=x.length)if(_t){for(;x.length<=c;x.push(0));s=g=0,St=1,Lt%=vi,sn=Lt-vi+1}else break e;else{for(s=E=x[c],St=1;E>=10;E/=10,St++);Lt%=vi,sn=Lt-vi+St,g=sn<0?0:To(s/A[St-sn-1]%10)}if(_t=_t||at<0||x[c+1]!=null||(sn<0?s:s%A[St-sn-1]),_t=mt<4?(g||_t)&&(mt==0||mt==(Ge.s<0?3:2)):g>5||g==5&&(mt==4||_t||mt==6&&(Lt>0?sn>0?s/A[St-sn]:0:x[c-1])%10&1||mt==(Ge.s<0?8:7)),at<1||!x[0])return x.length=0,_t?(at-=Ge.e+1,x[0]=A[(vi-at%vi)%vi],Ge.e=-at||0):x[0]=Ge.e=0,Ge;if(Lt==0?(x.length=c,E=1,c--):(x.length=c+1,E=A[vi-Lt],x[c]=sn>0?To(s/A[St-sn]%A[sn])*E:0),_t)for(;;)if(c==0){for(Lt=1,sn=x[0];sn>=10;sn/=10,Lt++);for(sn=x[0]+=E,E=1;sn>=10;sn/=10,E++);Lt!=E&&(Ge.e++,x[0]==$o&&(x[0]=1));break}else{if(x[c]+=E,x[c]!=$o)break;x[c--]=0,E=1}for(Lt=x.length;x[--Lt]===0;x.pop());}Ge.e>bt?Ge.c=Ge.e=null:Ge.e<zt&&(Ge.c=[Ge.e=0])}return Ge}function Bn(Ge){var at,mt=Ge.e;return mt===null?Ge.toString():(at=Ao(Ge.c),at=mt<=Fe||mt>=tt?U(at,mt):se(at,mt,"0"),Ge.s<0?"-"+at:at)}return G.absoluteValue=G.abs=function(){var Ge=new Nt(this);return Ge.s<0&&(Ge.s=1),Ge},G.comparedTo=function(Ge,at){return Gl(this,new Nt(Ge,at))},G.decimalPlaces=G.dp=function(Ge,at){var mt,_t,St,Lt=this;if(Ge!=null)return p(Ge,0,Go),at==null?at=xe:p(at,0,8),Mn(new Nt(Lt),Ge+Lt.e+1,at);if(!(mt=Lt.c))return null;if(_t=((St=mt.length-1)-Ho(this.e/vi))*vi,St=mt[St])for(;St%10==0;St/=10,_t--);return _t<0&&(_t=0),_t},G.dividedBy=G.div=function(Ge,at){return S(this,new Nt(Ge,at),pe,xe)},G.dividedToIntegerBy=G.idiv=function(Ge,at){return S(this,new Nt(Ge,at),0,1)},G.exponentiatedBy=G.pow=function(Ge,at){var mt,_t,St,Lt,sn,E,s,c,g,x=this;if(Ge=new Nt(Ge),Ge.c&&!Ge.isInteger())throw Error(ks+"Exponent not an integer: "+Bn(Ge));if(at!=null&&(at=new Nt(at)),E=Ge.e>14,!x.c||!x.c[0]||x.c[0]==1&&!x.e&&x.c.length==1||!Ge.c||!Ge.c[0])return g=new Nt(Math.pow(+Bn(x),E?Ge.s*(2-T(Ge)):+Bn(Ge))),at?g.mod(at):g;if(s=Ge.s<0,at){if(at.c?!at.c[0]:!at.s)return new Nt(NaN);_t=!s&&x.isInteger()&&at.isInteger(),_t&&(x=x.mod(at))}else{if(Ge.e>9&&(x.e>0||x.e<-1||(x.e==0?x.c[0]>1||E&&x.c[1]>=24e7:x.c[0]<8e13||E&&x.c[0]<=9999975e7)))return Lt=x.s<0&&T(Ge)?-0:0,x.e>-1&&(Lt=1/Lt),new Nt(s?1/Lt:Lt);hr&&(Lt=wl(hr/vi+2))}for(E?(mt=new Nt(.5),s&&(Ge.s=1),c=T(Ge)):(St=Math.abs(+Bn(Ge)),c=St%2),g=new Nt(te);;){if(c){if(g=g.times(x),!g.c)break;Lt?g.c.length>Lt&&(g.c.length=Lt):_t&&(g=g.mod(at))}if(St){if(St=To(St/2),St===0)break;c=St%2}else if(Ge=Ge.times(mt),Mn(Ge,Ge.e+1,1),Ge.e>14)c=T(Ge);else{if(St=+Bn(Ge),St===0)break;c=St%2}x=x.times(x),Lt?x.c&&x.c.length>Lt&&(x.c.length=Lt):_t&&(x=x.mod(at))}return _t?g:(s&&(g=te.div(g)),at?g.mod(at):Lt?Mn(g,hr,xe,sn):g)},G.integerValue=function(Ge){var at=new Nt(this);return Ge==null?Ge=xe:p(Ge,0,8),Mn(at,at.e+1,Ge)},G.isEqualTo=G.eq=function(Ge,at){return Gl(this,new Nt(Ge,at))===0},G.isFinite=function(){return!!this.c},G.isGreaterThan=G.gt=function(Ge,at){return Gl(this,new Nt(Ge,at))>0},G.isGreaterThanOrEqualTo=G.gte=function(Ge,at){return(at=Gl(this,new Nt(Ge,at)))===1||at===0},G.isInteger=function(){return!!this.c&&Ho(this.e/vi)>this.c.length-2},G.isLessThan=G.lt=function(Ge,at){return Gl(this,new Nt(Ge,at))<0},G.isLessThanOrEqualTo=G.lte=function(Ge,at){return(at=Gl(this,new Nt(Ge,at)))===-1||at===0},G.isNaN=function(){return!this.s},G.isNegative=function(){return this.s<0},G.isPositive=function(){return this.s>0},G.isZero=function(){return!!this.c&&this.c[0]==0},G.minus=function(Ge,at){var mt,_t,St,Lt,sn=this,E=sn.s;if(Ge=new Nt(Ge,at),at=Ge.s,!E||!at)return new Nt(NaN);if(E!=at)return Ge.s=-at,sn.plus(Ge);var s=sn.e/vi,c=Ge.e/vi,g=sn.c,x=Ge.c;if(!s||!c){if(!g||!x)return g?(Ge.s=-at,Ge):new Nt(x?sn:NaN);if(!g[0]||!x[0])return x[0]?(Ge.s=-at,Ge):new Nt(g[0]?sn:xe==3?-0:0)}if(s=Ho(s),c=Ho(c),g=g.slice(),E=s-c){for((Lt=E<0)?(E=-E,St=g):(c=s,St=x),St.reverse(),at=E;at--;St.push(0));St.reverse()}else for(_t=(Lt=(E=g.length)<(at=x.length))?E:at,E=at=0;at<_t;at++)if(g[at]!=x[at]){Lt=g[at]<x[at];break}if(Lt&&(St=g,g=x,x=St,Ge.s=-Ge.s),at=(_t=x.length)-(mt=g.length),at>0)for(;at--;g[mt++]=0);for(at=$o-1;_t>E;){if(g[--_t]<x[_t]){for(mt=_t;mt&&!g[--mt];g[mt]=at);--g[mt],g[_t]+=$o}g[_t]-=x[_t]}for(;g[0]==0;g.splice(0,1),--c);return g[0]?Gn(Ge,g,c):(Ge.s=xe==3?-1:1,Ge.c=[Ge.e=0],Ge)},G.modulo=G.mod=function(Ge,at){var mt,_t,St=this;return Ge=new Nt(Ge,at),!St.c||!Ge.s||Ge.c&&!Ge.c[0]?new Nt(NaN):!Ge.c||St.c&&!St.c[0]?new Nt(St):(zn==9?(_t=Ge.s,Ge.s=1,mt=S(St,Ge,0,3),Ge.s=_t,mt.s*=_t):mt=S(St,Ge,0,zn),Ge=St.minus(mt.times(Ge)),!Ge.c[0]&&zn==1&&(Ge.s=St.s),Ge)},G.multipliedBy=G.times=function(Ge,at){var mt,_t,St,Lt,sn,E,s,c,g,x,A,N,$,Z,re,fe=this,Me=fe.c,ke=(Ge=new Nt(Ge,at)).c;if(!Me||!ke||!Me[0]||!ke[0])return!fe.s||!Ge.s||Me&&!Me[0]&&!ke||ke&&!ke[0]&&!Me?Ge.c=Ge.e=Ge.s=null:(Ge.s*=fe.s,!Me||!ke?Ge.c=Ge.e=null:(Ge.c=[0],Ge.e=0)),Ge;for(_t=Ho(fe.e/vi)+Ho(Ge.e/vi),Ge.s*=fe.s,s=Me.length,x=ke.length,s<x&&($=Me,Me=ke,ke=$,St=s,s=x,x=St),St=s+x,$=[];St--;$.push(0));for(Z=$o,re=Ha,St=x;--St>=0;){for(mt=0,A=ke[St]%re,N=ke[St]/re|0,sn=s,Lt=St+sn;Lt>St;)c=Me[--sn]%re,g=Me[sn]/re|0,E=N*c+g*A,c=A*c+E%re*re+$[Lt]+mt,mt=(c/Z|0)+(E/re|0)+N*g,$[Lt--]=c%Z;$[Lt]=mt}return mt?++_t:$.splice(0,1),Gn(Ge,$,_t)},G.negated=function(){var Ge=new Nt(this);return Ge.s=-Ge.s||null,Ge},G.plus=function(Ge,at){var mt,_t=this,St=_t.s;if(Ge=new Nt(Ge,at),at=Ge.s,!St||!at)return new Nt(NaN);if(St!=at)return Ge.s=-at,_t.minus(Ge);var Lt=_t.e/vi,sn=Ge.e/vi,E=_t.c,s=Ge.c;if(!Lt||!sn){if(!E||!s)return new Nt(St/0);if(!E[0]||!s[0])return s[0]?Ge:new Nt(E[0]?_t:St*0)}if(Lt=Ho(Lt),sn=Ho(sn),E=E.slice(),St=Lt-sn){for(St>0?(sn=Lt,mt=s):(St=-St,mt=E),mt.reverse();St--;mt.push(0));mt.reverse()}for(St=E.length,at=s.length,St-at<0&&(mt=s,s=E,E=mt,at=St),St=0;at;)St=(E[--at]=E[at]+s[at]+St)/$o|0,E[at]=$o===E[at]?0:E[at]%$o;return St&&(E=[St].concat(E),++sn),Gn(Ge,E,sn)},G.precision=G.sd=function(Ge,at){var mt,_t,St,Lt=this;if(Ge!=null&&Ge!==!!Ge)return p(Ge,1,Go),at==null?at=xe:p(at,0,8),Mn(new Nt(Lt),Ge,at);if(!(mt=Lt.c))return null;if(St=mt.length-1,_t=St*vi+1,St=mt[St]){for(;St%10==0;St/=10,_t--);for(St=mt[0];St>=10;St/=10,_t++);}return Ge&&Lt.e+1>_t&&(_t=Lt.e+1),_t},G.shiftedBy=function(Ge){return p(Ge,-9007199254740991,$l),this.times("1e"+Ge)},G.squareRoot=G.sqrt=function(){var Ge,at,mt,_t,St,Lt=this,sn=Lt.c,E=Lt.s,s=Lt.e,c=pe+4,g=new Nt("0.5");if(E!==1||!sn||!sn[0])return new Nt(!E||E<0&&(!sn||sn[0])?NaN:sn?Lt:1/0);if(E=Math.sqrt(+Bn(Lt)),E==0||E==1/0?(at=Ao(sn),(at.length+s)%2==0&&(at+="0"),E=Math.sqrt(+at),s=Ho((s+1)/2)-(s<0||s%2),E==1/0?at="5e"+s:(at=E.toExponential(),at=at.slice(0,at.indexOf("e")+1)+s),mt=new Nt(at)):mt=new Nt(E+""),mt.c[0]){for(s=mt.e,E=s+c,E<3&&(E=0);;)if(St=mt,mt=g.times(St.plus(S(Lt,St,c,1))),Ao(St.c).slice(0,E)===(at=Ao(mt.c)).slice(0,E))if(mt.e<s&&--E,at=at.slice(E-3,E+1),at=="9999"||!_t&&at=="4999"){if(!_t&&(Mn(St,St.e+pe+2,0),St.times(St).eq(Lt))){mt=St;break}c+=4,E+=4,_t=1}else{(!+at||!+at.slice(1)&&at.charAt(0)=="5")&&(Mn(mt,mt.e+pe+2,1),Ge=!mt.times(mt).eq(Lt));break}}return Mn(mt,mt.e+pe+1,xe,Ge)},G.toExponential=function(Ge,at){return Ge!=null&&(p(Ge,0,Go),Ge++),qt(this,Ge,at,1)},G.toFixed=function(Ge,at){return Ge!=null&&(p(Ge,0,Go),Ge=Ge+this.e+1),qt(this,Ge,at)},G.toFormat=function(Ge,at,mt){var _t,St=this;if(mt==null)Ge!=null&&at&&typeof at=="object"?(mt=at,at=null):Ge&&typeof Ge=="object"?(mt=Ge,Ge=at=null):mt=Ir;else if(typeof mt!="object")throw Error(ks+"Argument not an object: "+mt);if(_t=St.toFixed(Ge,at),St.c){var Lt,sn=_t.split("."),E=+mt.groupSize,s=+mt.secondaryGroupSize,c=mt.groupSeparator||"",g=sn[0],x=sn[1],A=St.s<0,N=A?g.slice(1):g,$=N.length;if(s&&(Lt=E,E=s,s=Lt,$-=Lt),E>0&&$>0){for(Lt=$%E||E,g=N.substr(0,Lt);Lt<$;Lt+=E)g+=c+N.substr(Lt,E);s>0&&(g+=c+N.slice(Lt)),A&&(g="-"+g)}_t=x?g+(mt.decimalSeparator||"")+((s=+mt.fractionGroupSize)?x.replace(new RegExp("\\d{"+s+"}\\B","g"),"$&"+(mt.fractionGroupSeparator||"")):x):g}return(mt.prefix||"")+_t+(mt.suffix||"")},G.toFraction=function(Ge){var at,mt,_t,St,Lt,sn,E,s,c,g,x,A,N=this,$=N.c;if(Ge!=null&&(E=new Nt(Ge),!E.isInteger()&&(E.c||E.s!==1)||E.lt(te)))throw Error(ks+"Argument "+(E.isInteger()?"out of range: ":"not an integer: ")+Bn(E));if(!$)return new Nt(N);for(at=new Nt(te),c=mt=new Nt(te),_t=s=new Nt(te),A=Ao($),Lt=at.e=A.length-N.e-1,at.c[0]=yu[(sn=Lt%vi)<0?vi+sn:sn],Ge=!Ge||E.comparedTo(at)>0?Lt>0?at:c:E,sn=bt,bt=1/0,E=new Nt(A),s.c[0]=0;g=S(E,at,0,1),St=mt.plus(g.times(_t)),St.comparedTo(Ge)!=1;)mt=_t,_t=St,c=s.plus(g.times(St=c)),s=St,at=E.minus(g.times(St=at)),E=St;return St=S(Ge.minus(mt),_t,0,1),s=s.plus(St.times(c)),mt=mt.plus(St.times(_t)),s.s=c.s=N.s,Lt=Lt*2,x=S(c,_t,Lt,xe).minus(N).abs().comparedTo(S(s,mt,Lt,xe).minus(N).abs())<1?[c,_t]:[s,mt],bt=sn,x},G.toNumber=function(){return+Bn(this)},G.toPrecision=function(Ge,at){return Ge!=null&&p(Ge,1,Go),qt(this,Ge,at,2)},G.toString=function(Ge){var at,mt=this,_t=mt.s,St=mt.e;return St===null?_t?(at="Infinity",_t<0&&(at="-"+at)):at="NaN":(Ge==null?at=St<=Fe||St>=tt?U(Ao(mt.c),St):se(Ao(mt.c),St,"0"):Ge===10&&ci?(mt=Mn(new Nt(mt),pe+St+1,xe),at=se(Ao(mt.c),mt.e,"0")):(p(Ge,2,Br.length,"Base"),at=I(se(Ao(mt.c),St,"0"),10,Ge,_t,!0)),_t<0&&mt.c[0]&&(at="-"+at)),at},G.valueOf=G.toJSON=function(){return Bn(this)},G._isBigNumber=!0,G[Symbol.toStringTag]="BigNumber",G[Symbol.for("nodejs.util.inspect.custom")]=G.valueOf,y!=null&&Nt.set(y),Nt}function Ho(y){var S=y|0;return y>0||y===S?S:S-1}function Ao(y){for(var S,I,F=1,G=y.length,te=y[0]+"";F<G;){for(S=y[F++]+"",I=vi-S.length;I--;S="0"+S);te+=S}for(G=te.length;te.charCodeAt(--G)===48;);return te.slice(0,G+1||1)}function Gl(y,S){var I,F,G=y.c,te=S.c,pe=y.s,xe=S.s,Fe=y.e,tt=S.e;if(!pe||!xe)return null;if(I=G&&!G[0],F=te&&!te[0],I||F)return I?F?0:-xe:pe;if(pe!=xe)return pe;if(I=pe<0,F=Fe==tt,!G||!te)return F?0:!G^I?1:-1;if(!F)return Fe>tt^I?1:-1;for(xe=(Fe=G.length)<(tt=te.length)?Fe:tt,pe=0;pe<xe;pe++)if(G[pe]!=te[pe])return G[pe]>te[pe]^I?1:-1;return Fe==tt?0:Fe>tt^I?1:-1}function p(y,S,I,F){if(y<S||y>I||y!==To(y))throw Error(ks+(F||"Argument")+(typeof y=="number"?y<S||y>I?" out of range: ":" not an integer: ":" not a primitive number: ")+String(y))}function T(y){var S=y.c.length-1;return Ho(y.e/vi)==S&&y.c[S]%2!=0}function U(y,S){return(y.length>1?y.charAt(0)+"."+y.slice(1):y)+(S<0?"e":"e+")+S}function se(y,S,I){var F,G;if(S<0){for(G=I+".";++S;G+=I);y=G+y}else if(F=y.length,++S>F){for(G=I,S-=F;--S;G+=I);y+=G}else S<F&&(y=y.slice(0,S)+"."+y.slice(S));return y}var Pe=Uc(),nt=Pe,Jt=class{constructor(y){un(this,"key");un(this,"left",null);un(this,"right",null);this.key=y}},Dn=class extends Jt{constructor(y){super(y)}},Jn=class{constructor(){un(this,"size",0);un(this,"modificationCount",0);un(this,"splayCount",0)}splay(y){let S=this.root;if(S==null)return this.compare(y,y),-1;let I=null,F=null,G=null,te=null,pe=S,xe=this.compare,Fe;for(;;)if(Fe=xe(pe.key,y),Fe>0){let tt=pe.left;if(tt==null||(Fe=xe(tt.key,y),Fe>0&&(pe.left=tt.right,tt.right=pe,pe=tt,tt=pe.left,tt==null)))break;I==null?F=pe:I.left=pe,I=pe,pe=tt}else if(Fe<0){let tt=pe.right;if(tt==null||(Fe=xe(tt.key,y),Fe<0&&(pe.right=tt.left,tt.left=pe,pe=tt,tt=pe.right,tt==null)))break;G==null?te=pe:G.right=pe,G=pe,pe=tt}else break;return G!=null&&(G.right=pe.left,pe.left=te),I!=null&&(I.left=pe.right,pe.right=F),this.root!==pe&&(this.root=pe,this.splayCount++),Fe}splayMin(y){let S=y,I=S.left;for(;I!=null;){let F=I;S.left=F.right,F.right=S,S=F,I=S.left}return S}splayMax(y){let S=y,I=S.right;for(;I!=null;){let F=I;S.right=F.left,F.left=S,S=F,I=S.right}return S}_delete(y){if(this.root==null||this.splay(y)!=0)return null;let S=this.root,I=S,F=S.left;if(this.size--,F==null)this.root=S.right;else{let G=S.right;S=this.splayMax(F),S.right=G,this.root=S}return this.modificationCount++,I}addNewRoot(y,S){this.size++,this.modificationCount++;let I=this.root;if(I==null){this.root=y;return}S<0?(y.left=I,y.right=I.right,I.right=null):(y.right=I,y.left=I.left,I.left=null),this.root=y}_first(){let y=this.root;return y==null?null:(this.root=this.splayMin(y),this.root)}_last(){let y=this.root;return y==null?null:(this.root=this.splayMax(y),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(y){return this.validKey(y)&&this.splay(y)==0}defaultCompare(){return(y,S)=>y<S?-1:y>S?1:0}wrap(){return{getRoot:()=>this.root,setRoot:y=>{this.root=y},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:y=>{this.splayCount=y},splay:y=>this.splay(y),has:y=>this.has(y)}}},ar=class Lv extends Jn{constructor(I,F){super();un(this,"root",null);un(this,"compare");un(this,"validKey");un(this,Ur,"[object Set]");this.compare=I??this.defaultCompare(),this.validKey=F??(G=>G!=null&&G!=null)}delete(I){return this.validKey(I)?this._delete(I)!=null:!1}deleteAll(I){for(let F of I)this.delete(F)}forEach(I){let F=this[Symbol.iterator](),G;for(;G=F.next(),!G.done;)I(G.value,G.value,this)}add(I){let F=this.splay(I);return F!=0&&this.addNewRoot(new Dn(I),F),this}addAndReturn(I){let F=this.splay(I);return F!=0&&this.addNewRoot(new Dn(I),F),this.root.key}addAll(I){for(let F of I)this.add(F)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(I){if(I==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(I)<0)return this.root.key;let F=this.root.left;if(F==null)return null;let G=F.right;for(;G!=null;)F=G,G=F.right;return F.key}firstAfter(I){if(I==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(I)>0)return this.root.key;let F=this.root.right;if(F==null)return null;let G=F.left;for(;G!=null;)F=G,G=F.left;return F.key}retainAll(I){let F=new Lv(this.compare,this.validKey),G=this.modificationCount;for(let te of I){if(G!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(te)&&this.splay(te)==0&&F.add(this.root.key)}F.size!=this.size&&(this.root=F.root,this.size=F.size,this.modificationCount++)}lookup(I){return!this.validKey(I)||this.splay(I)!=0?null:this.root.key}intersection(I){let F=new Lv(this.compare,this.validKey);for(let G of this)I.has(G)&&F.add(G);return F}difference(I){let F=new Lv(this.compare,this.validKey);for(let G of this)I.has(G)||F.add(G);return F}union(I){let F=this.clone();return F.addAll(I),F}clone(){let I=new Lv(this.compare,this.validKey);return I.size=this.size,I.root=this.copyNode(this.root),I}copyNode(I){if(I==null)return null;function F(te,pe){let xe,Fe;do{if(xe=te.left,Fe=te.right,xe!=null){let tt=new Dn(xe.key);pe.left=tt,F(xe,tt)}if(Fe!=null){let tt=new Dn(Fe.key);pe.right=tt,te=Fe,pe=tt}}while(Fe!=null)}let G=new Dn(I.key);return F(I,G),G}toSet(){return this.clone()}entries(){return new Vi(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[(ei=Symbol.iterator,Ur=Symbol.toStringTag,ei)](){return new Jr(this.wrap())}},Vr=class{constructor(y){un(this,"tree");un(this,"path",new Array);un(this,"modificationCount",null);un(this,"splayCount");this.tree=y,this.splayCount=y.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;let y=this.path[this.path.length-1];return this.getValue(y)}rebuildPath(y){this.path.splice(0,this.path.length),this.tree.splay(y),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(y){for(;y!=null;)this.path.push(y),y=y.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let I=this.tree.getRoot();for(;I!=null;)this.path.push(I),I=I.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let y=this.path[this.path.length-1],S=y.right;if(S!=null){for(;S!=null;)this.path.push(S),S=S.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===y;)y=this.path.pop();return this.path.length>0}},Jr=class extends Vr{getValue(y){return y.key}},Vi=class extends Vr{getValue(y){return[y.key,y.key]}},vo=y=>y,Js=y=>{if(y){let S=new ar(Vo(y)),I=new ar(Vo(y)),F=(te,pe)=>pe.addAndReturn(te),G=te=>({x:F(te.x,S),y:F(te.y,I)});return G({x:new nt(0),y:new nt(0)}),G}return vo},so=y=>({set:S=>{Ss=so(S)},reset:()=>so(y),compare:Vo(y),snap:Js(y),orient:xl(y)}),Ss=so(),ma=(y,S)=>y.ll.x.isLessThanOrEqualTo(S.x)&&S.x.isLessThanOrEqualTo(y.ur.x)&&y.ll.y.isLessThanOrEqualTo(S.y)&&S.y.isLessThanOrEqualTo(y.ur.y),lh=(y,S)=>{if(S.ur.x.isLessThan(y.ll.x)||y.ur.x.isLessThan(S.ll.x)||S.ur.y.isLessThan(y.ll.y)||y.ur.y.isLessThan(S.ll.y))return null;let I=y.ll.x.isLessThan(S.ll.x)?S.ll.x:y.ll.x,F=y.ur.x.isLessThan(S.ur.x)?y.ur.x:S.ur.x,G=y.ll.y.isLessThan(S.ll.y)?S.ll.y:y.ll.y,te=y.ur.y.isLessThan(S.ur.y)?y.ur.y:S.ur.y;return{ll:{x:I,y:G},ur:{x:F,y:te}}},Cl=(y,S)=>y.x.times(S.y).minus(y.y.times(S.x)),Sl=(y,S)=>y.x.times(S.x).plus(y.y.times(S.y)),qa=y=>Sl(y,y).sqrt(),Xh=(y,S,I)=>{let F={x:S.x.minus(y.x),y:S.y.minus(y.y)},G={x:I.x.minus(y.x),y:I.y.minus(y.y)};return Cl(G,F).div(qa(G)).div(qa(F))},Aa=(y,S,I)=>{let F={x:S.x.minus(y.x),y:S.y.minus(y.y)},G={x:I.x.minus(y.x),y:I.y.minus(y.y)};return Sl(G,F).div(qa(G)).div(qa(F))},xs=(y,S,I)=>S.y.isZero()?null:{x:y.x.plus(S.x.div(S.y).times(I.minus(y.y))),y:I},ia=(y,S,I)=>S.x.isZero()?null:{x:I,y:y.y.plus(S.y.div(S.x).times(I.minus(y.x)))},dt=(y,S,I,F)=>{if(S.x.isZero())return ia(I,F,y.x);if(F.x.isZero())return ia(y,S,I.x);if(S.y.isZero())return xs(I,F,y.y);if(F.y.isZero())return xs(y,S,I.y);let G=Cl(S,F);if(G.isZero())return null;let te={x:I.x.minus(y.x),y:I.y.minus(y.y)},pe=Cl(te,S).div(G),xe=Cl(te,F).div(G),Fe=y.x.plus(xe.times(S.x)),tt=I.x.plus(pe.times(F.x)),zt=y.y.plus(xe.times(S.y)),bt=I.y.plus(pe.times(F.y)),dn=Fe.plus(tt).div(2),zn=zt.plus(bt).div(2);return{x:dn,y:zn}},ka=class Pk{constructor(S,I){un(this,"point");un(this,"isLeft");un(this,"segment");un(this,"otherSE");un(this,"consumedBy");S.events===void 0?S.events=[this]:S.events.push(this),this.point=S,this.isLeft=I}static compare(S,I){let F=Pk.comparePoints(S.point,I.point);return F!==0?F:(S.point!==I.point&&S.link(I),S.isLeft!==I.isLeft?S.isLeft?1:-1:qo.compare(S.segment,I.segment))}static comparePoints(S,I){return S.x.isLessThan(I.x)?-1:S.x.isGreaterThan(I.x)?1:S.y.isLessThan(I.y)?-1:S.y.isGreaterThan(I.y)?1:0}link(S){if(S.point===this.point)throw new Error("Tried to link already linked events");let I=S.point.events;for(let F=0,G=I.length;F<G;F++){let te=I[F];this.point.events.push(te),te.point=this.point}this.checkForConsuming()}checkForConsuming(){let S=this.point.events.length;for(let I=0;I<S;I++){let F=this.point.events[I];if(F.segment.consumedBy===void 0)for(let G=I+1;G<S;G++){let te=this.point.events[G];te.consumedBy===void 0&&F.otherSE.point.events===te.otherSE.point.events&&F.segment.consume(te.segment)}}}getAvailableLinkedEvents(){let S=[];for(let I=0,F=this.point.events.length;I<F;I++){let G=this.point.events[I];G!==this&&!G.segment.ringOut&&G.segment.isInResult()&&S.push(G)}return S}getLeftmostComparator(S){let I=new Map,F=G=>{let te=G.otherSE;I.set(G,{sine:Xh(this.point,S.point,te.point),cosine:Aa(this.point,S.point,te.point)})};return(G,te)=>{I.has(G)||F(G),I.has(te)||F(te);let{sine:pe,cosine:xe}=I.get(G),{sine:Fe,cosine:tt}=I.get(te);return pe.isGreaterThanOrEqualTo(0)&&Fe.isGreaterThanOrEqualTo(0)?xe.isLessThan(tt)?1:xe.isGreaterThan(tt)?-1:0:pe.isLessThan(0)&&Fe.isLessThan(0)?xe.isLessThan(tt)?-1:xe.isGreaterThan(tt)?1:0:Fe.isLessThan(pe)?-1:Fe.isGreaterThan(pe)?1:0}}},Vc=0,qo=class rx{constructor(S,I,F,G){un(this,"id");un(this,"leftSE");un(this,"rightSE");un(this,"rings");un(this,"windings");un(this,"ringOut");un(this,"consumedBy");un(this,"prev");un(this,"_prevInResult");un(this,"_beforeState");un(this,"_afterState");un(this,"_isInResult");this.id=++Vc,this.leftSE=S,S.segment=this,S.otherSE=I,this.rightSE=I,I.segment=this,I.otherSE=S,this.rings=F,this.windings=G}static compare(S,I){let F=S.leftSE.point.x,G=I.leftSE.point.x,te=S.rightSE.point.x,pe=I.rightSE.point.x;if(pe.isLessThan(F))return 1;if(te.isLessThan(G))return-1;let xe=S.leftSE.point.y,Fe=I.leftSE.point.y,tt=S.rightSE.point.y,zt=I.rightSE.point.y;if(F.isLessThan(G)){if(Fe.isLessThan(xe)&&Fe.isLessThan(tt))return 1;if(Fe.isGreaterThan(xe)&&Fe.isGreaterThan(tt))return-1;let bt=S.comparePoint(I.leftSE.point);if(bt<0)return 1;if(bt>0)return-1;let dn=I.comparePoint(S.rightSE.point);return dn!==0?dn:-1}if(F.isGreaterThan(G)){if(xe.isLessThan(Fe)&&xe.isLessThan(zt))return-1;if(xe.isGreaterThan(Fe)&&xe.isGreaterThan(zt))return 1;let bt=I.comparePoint(S.leftSE.point);if(bt!==0)return bt;let dn=S.comparePoint(I.rightSE.point);return dn<0?1:dn>0?-1:1}if(xe.isLessThan(Fe))return-1;if(xe.isGreaterThan(Fe))return 1;if(te.isLessThan(pe)){let bt=I.comparePoint(S.rightSE.point);if(bt!==0)return bt}if(te.isGreaterThan(pe)){let bt=S.comparePoint(I.rightSE.point);if(bt<0)return 1;if(bt>0)return-1}if(!te.eq(pe)){let bt=tt.minus(xe),dn=te.minus(F),zn=zt.minus(Fe),hr=pe.minus(G);if(bt.isGreaterThan(dn)&&zn.isLessThan(hr))return 1;if(bt.isLessThan(dn)&&zn.isGreaterThan(hr))return-1}return te.isGreaterThan(pe)?1:te.isLessThan(pe)||tt.isLessThan(zt)?-1:tt.isGreaterThan(zt)?1:S.id<I.id?-1:S.id>I.id?1:0}static fromRing(S,I,F){let G,te,pe,xe=ka.comparePoints(S,I);if(xe<0)G=S,te=I,pe=1;else if(xe>0)G=I,te=S,pe=-1;else throw new Error(`Tried to create degenerate segment at [${S.x}, ${S.y}]`);let Fe=new ka(G,!0),tt=new ka(te,!1);return new rx(Fe,tt,[F],[pe])}replaceRightSE(S){this.rightSE=S,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){let S=this.leftSE.point.y,I=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:S.isLessThan(I)?S:I},ur:{x:this.rightSE.point.x,y:S.isGreaterThan(I)?S:I}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(S){return S.x.eq(this.leftSE.point.x)&&S.y.eq(this.leftSE.point.y)||S.x.eq(this.rightSE.point.x)&&S.y.eq(this.rightSE.point.y)}comparePoint(S){return Ss.orient(this.leftSE.point,S,this.rightSE.point)}getIntersection(S){let I=this.bbox(),F=S.bbox(),G=lh(I,F);if(G===null)return null;let te=this.leftSE.point,pe=this.rightSE.point,xe=S.leftSE.point,Fe=S.rightSE.point,tt=ma(I,xe)&&this.comparePoint(xe)===0,zt=ma(F,te)&&S.comparePoint(te)===0,bt=ma(I,Fe)&&this.comparePoint(Fe)===0,dn=ma(F,pe)&&S.comparePoint(pe)===0;if(zt&&tt)return dn&&!bt?pe:!dn&&bt?Fe:null;if(zt)return bt&&te.x.eq(Fe.x)&&te.y.eq(Fe.y)?null:te;if(tt)return dn&&pe.x.eq(xe.x)&&pe.y.eq(xe.y)?null:xe;if(dn&&bt)return null;if(dn)return pe;if(bt)return Fe;let zn=dt(te,this.vector(),xe,S.vector());return zn===null||!ma(G,zn)?null:Ss.snap(zn)}split(S){let I=[],F=S.events!==void 0,G=new ka(S,!0),te=new ka(S,!1),pe=this.rightSE;this.replaceRightSE(te),I.push(te),I.push(G);let xe=new rx(G,pe,this.rings.slice(),this.windings.slice());return ka.comparePoints(xe.leftSE.point,xe.rightSE.point)>0&&xe.swapEvents(),ka.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),F&&(G.checkForConsuming(),te.checkForConsuming()),I}swapEvents(){let S=this.rightSE;this.rightSE=this.leftSE,this.leftSE=S,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let I=0,F=this.windings.length;I<F;I++)this.windings[I]*=-1}consume(S){let I=this,F=S;for(;I.consumedBy;)I=I.consumedBy;for(;F.consumedBy;)F=F.consumedBy;let G=rx.compare(I,F);if(G!==0){if(G>0){let te=I;I=F,F=te}if(I.prev===F){let te=I;I=F,F=te}for(let te=0,pe=F.rings.length;te<pe;te++){let xe=F.rings[te],Fe=F.windings[te],tt=I.rings.indexOf(xe);tt===-1?(I.rings.push(xe),I.windings.push(Fe)):I.windings[tt]+=Fe}F.rings=null,F.windings=null,F.consumedBy=I,F.leftSE.consumedBy=I.leftSE,F.rightSE.consumedBy=I.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{let S=this.prev.consumedBy||this.prev;this._beforeState=S.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;let S=this.beforeState();this._afterState={rings:S.rings.slice(0),windings:S.windings.slice(0),multiPolys:[]};let I=this._afterState.rings,F=this._afterState.windings,G=this._afterState.multiPolys;for(let xe=0,Fe=this.rings.length;xe<Fe;xe++){let tt=this.rings[xe],zt=this.windings[xe],bt=I.indexOf(tt);bt===-1?(I.push(tt),F.push(zt)):F[bt]+=zt}let te=[],pe=[];for(let xe=0,Fe=I.length;xe<Fe;xe++){if(F[xe]===0)continue;let tt=I[xe],zt=tt.poly;if(pe.indexOf(zt)===-1)if(tt.isExterior)te.push(zt);else{pe.indexOf(zt)===-1&&pe.push(zt);let bt=te.indexOf(tt.poly);bt!==-1&&te.splice(bt,1)}}for(let xe=0,Fe=te.length;xe<Fe;xe++){let tt=te[xe].multiPoly;G.indexOf(tt)===-1&&G.push(tt)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;let S=this.beforeState().multiPolys,I=this.afterState().multiPolys;switch(Ah.type){case"union":{let F=S.length===0,G=I.length===0;this._isInResult=F!==G;break}case"intersection":{let F,G;S.length<I.length?(F=S.length,G=I.length):(F=I.length,G=S.length),this._isInResult=G===Ah.numMultiPolys&&F<G;break}case"xor":{let F=Math.abs(S.length-I.length);this._isInResult=F%2===1;break}case"difference":{let F=G=>G.length===1&&G[0].isSubject;this._isInResult=F(S)!==F(I);break}}return this._isInResult}},Ni=class{constructor(y,S,I){un(this,"poly");un(this,"isExterior");un(this,"segments");un(this,"bbox");if(!Array.isArray(y)||y.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=S,this.isExterior=I,this.segments=[],typeof y[0][0]!="number"||typeof y[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let F=Ss.snap({x:new nt(y[0][0]),y:new nt(y[0][1])});this.bbox={ll:{x:F.x,y:F.y},ur:{x:F.x,y:F.y}};let G=F;for(let te=1,pe=y.length;te<pe;te++){if(typeof y[te][0]!="number"||typeof y[te][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let xe=Ss.snap({x:new nt(y[te][0]),y:new nt(y[te][1])});xe.x.eq(G.x)&&xe.y.eq(G.y)||(this.segments.push(qo.fromRing(G,xe,this)),xe.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=xe.x),xe.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=xe.y),xe.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=xe.x),xe.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=xe.y),G=xe)}(!F.x.eq(G.x)||!F.y.eq(G.y))&&this.segments.push(qo.fromRing(G,F,this))}getSweepEvents(){let y=[];for(let S=0,I=this.segments.length;S<I;S++){let F=this.segments[S];y.push(F.leftSE),y.push(F.rightSE)}return y}},ec=class{constructor(y,S){un(this,"multiPoly");un(this,"exteriorRing");un(this,"interiorRings");un(this,"bbox");if(!Array.isArray(y))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Ni(y[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let I=1,F=y.length;I<F;I++){let G=new Ni(y[I],this,!1);G.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=G.bbox.ll.x),G.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=G.bbox.ll.y),G.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=G.bbox.ur.x),G.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=G.bbox.ur.y),this.interiorRings.push(G)}this.multiPoly=S}getSweepEvents(){let y=this.exteriorRing.getSweepEvents();for(let S=0,I=this.interiorRings.length;S<I;S++){let F=this.interiorRings[S].getSweepEvents();for(let G=0,te=F.length;G<te;G++)y.push(F[G])}return y}},Ll=class{constructor(y,S){un(this,"isSubject");un(this,"polys");un(this,"bbox");if(!Array.isArray(y))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof y[0][0][0]=="number"&&(y=[y])}catch{}this.polys=[],this.bbox={ll:{x:new nt(Number.POSITIVE_INFINITY),y:new nt(Number.POSITIVE_INFINITY)},ur:{x:new nt(Number.NEGATIVE_INFINITY),y:new nt(Number.NEGATIVE_INFINITY)}};for(let I=0,F=y.length;I<F;I++){let G=new ec(y[I],this);G.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=G.bbox.ll.x),G.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=G.bbox.ll.y),G.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=G.bbox.ur.x),G.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=G.bbox.ur.y),this.polys.push(G)}this.isSubject=S}getSweepEvents(){let y=[];for(let S=0,I=this.polys.length;S<I;S++){let F=this.polys[S].getSweepEvents();for(let G=0,te=F.length;G<te;G++)y.push(F[G])}return y}},Ia=class Q4{constructor(S){un(this,"events");un(this,"poly");un(this,"_isExteriorRing");un(this,"_enclosingRing");this.events=S;for(let I=0,F=S.length;I<F;I++)S[I].segment.ringOut=this;this.poly=null}static factory(S){let I=[];for(let F=0,G=S.length;F<G;F++){let te=S[F];if(!te.isInResult()||te.ringOut)continue;let pe=null,xe=te.leftSE,Fe=te.rightSE,tt=[xe],zt=xe.point,bt=[];for(;pe=xe,xe=Fe,tt.push(xe),xe.point!==zt;)for(;;){let dn=xe.getAvailableLinkedEvents();if(dn.length===0){let Ir=tt[0].point,Br=tt[tt.length-1].point;throw new Error(`Unable to complete output ring starting at [${Ir.x}, ${Ir.y}]. Last matching segment found ends at [${Br.x}, ${Br.y}].`)}if(dn.length===1){Fe=dn[0].otherSE;break}let zn=null;for(let Ir=0,Br=bt.length;Ir<Br;Ir++)if(bt[Ir].point===xe.point){zn=Ir;break}if(zn!==null){let Ir=bt.splice(zn)[0],Br=tt.splice(Ir.index);Br.unshift(Br[0].otherSE),I.push(new Q4(Br.reverse()));continue}bt.push({index:tt.length,point:xe.point});let hr=xe.getLeftmostComparator(pe);Fe=dn.sort(hr)[0].otherSE;break}I.push(new Q4(tt))}return I}getGeom(){let S=this.events[0].point,I=[S];for(let tt=1,zt=this.events.length-1;tt<zt;tt++){let bt=this.events[tt].point,dn=this.events[tt+1].point;Ss.orient(bt,S,dn)!==0&&(I.push(bt),S=bt)}if(I.length===1)return null;let F=I[0],G=I[1];Ss.orient(F,S,G)===0&&I.shift(),I.push(I[0]);let te=this.isExteriorRing()?1:-1,pe=this.isExteriorRing()?0:I.length-1,xe=this.isExteriorRing()?I.length:-1,Fe=[];for(let tt=pe;tt!=xe;tt+=te)Fe.push([I[tt].x.toNumber(),I[tt].y.toNumber()]);return Fe}isExteriorRing(){if(this._isExteriorRing===void 0){let S=this.enclosingRing();this._isExteriorRing=S?!S.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var G,te;let S=this.events[0];for(let pe=1,xe=this.events.length;pe<xe;pe++){let Fe=this.events[pe];ka.compare(S,Fe)>0&&(S=Fe)}let I=S.segment.prevInResult(),F=I?I.prevInResult():null;for(;;){if(!I)return null;if(!F)return I.ringOut;if(F.ringOut!==I.ringOut)return((G=F.ringOut)==null?void 0:G.enclosingRing())!==I.ringOut?I.ringOut:(te=I.ringOut)==null?void 0:te.enclosingRing();I=F.prevInResult(),F=I?I.prevInResult():null}}},Wo=class{constructor(y){un(this,"exteriorRing");un(this,"interiorRings");this.exteriorRing=y,y.poly=this,this.interiorRings=[]}addInterior(y){this.interiorRings.push(y),y.poly=this}getGeom(){let y=this.exteriorRing.getGeom();if(y===null)return null;let S=[y];for(let I=0,F=this.interiorRings.length;I<F;I++){let G=this.interiorRings[I].getGeom();G!==null&&S.push(G)}return S}},Th=class{constructor(y){un(this,"rings");un(this,"polys");this.rings=y,this.polys=this._composePolys(y)}getGeom(){let y=[];for(let S=0,I=this.polys.length;S<I;S++){let F=this.polys[S].getGeom();F!==null&&y.push(F)}return y}_composePolys(y){var I;let S=[];for(let F=0,G=y.length;F<G;F++){let te=y[F];if(!te.poly)if(te.isExteriorRing())S.push(new Wo(te));else{let pe=te.enclosingRing();pe!=null&&pe.poly||S.push(new Wo(pe)),(I=pe==null?void 0:pe.poly)==null||I.addInterior(te)}}return S}},Fu=class{constructor(y,S=qo.compare){un(this,"queue");un(this,"tree");un(this,"segments");this.queue=y,this.tree=new ar(S),this.segments=[]}process(y){let S=y.segment,I=[];if(y.consumedBy)return y.isLeft?this.queue.delete(y.otherSE):this.tree.delete(S),I;y.isLeft&&this.tree.add(S);let F=S,G=S;do F=this.tree.lastBefore(F);while(F!=null&&F.consumedBy!=null);do G=this.tree.firstAfter(G);while(G!=null&&G.consumedBy!=null);if(y.isLeft){let te=null;if(F){let xe=F.getIntersection(S);if(xe!==null&&(S.isAnEndpoint(xe)||(te=xe),!F.isAnEndpoint(xe))){let Fe=this._splitSafely(F,xe);for(let tt=0,zt=Fe.length;tt<zt;tt++)I.push(Fe[tt])}}let pe=null;if(G){let xe=G.getIntersection(S);if(xe!==null&&(S.isAnEndpoint(xe)||(pe=xe),!G.isAnEndpoint(xe))){let Fe=this._splitSafely(G,xe);for(let tt=0,zt=Fe.length;tt<zt;tt++)I.push(Fe[tt])}}if(te!==null||pe!==null){let xe=null;te===null?xe=pe:pe===null?xe=te:xe=ka.comparePoints(te,pe)<=0?te:pe,this.queue.delete(S.rightSE),I.push(S.rightSE);let Fe=S.split(xe);for(let tt=0,zt=Fe.length;tt<zt;tt++)I.push(Fe[tt])}I.length>0?(this.tree.delete(S),I.push(y)):(this.segments.push(S),S.prev=F)}else{if(F&&G){let te=F.getIntersection(G);if(te!==null){if(!F.isAnEndpoint(te)){let pe=this._splitSafely(F,te);for(let xe=0,Fe=pe.length;xe<Fe;xe++)I.push(pe[xe])}if(!G.isAnEndpoint(te)){let pe=this._splitSafely(G,te);for(let xe=0,Fe=pe.length;xe<Fe;xe++)I.push(pe[xe])}}}this.tree.delete(S)}return I}_splitSafely(y,S){this.tree.delete(y);let I=y.rightSE;this.queue.delete(I);let F=y.split(S);return F.push(I),y.consumedBy===void 0&&this.tree.add(y),F}},fc=class{constructor(){un(this,"type");un(this,"numMultiPolys")}run(y,S,I){uh.type=y;let F=[new Ll(S,!0)];for(let Fe=0,tt=I.length;Fe<tt;Fe++)F.push(new Ll(I[Fe],!1));if(uh.numMultiPolys=F.length,uh.type==="difference"){let Fe=F[0],tt=1;for(;tt<F.length;)lh(F[tt].bbox,Fe.bbox)!==null?tt++:F.splice(tt,1)}if(uh.type==="intersection")for(let Fe=0,tt=F.length;Fe<tt;Fe++){let zt=F[Fe];for(let bt=Fe+1,dn=F.length;bt<dn;bt++)if(lh(zt.bbox,F[bt].bbox)===null)return[]}let G=new ar(ka.compare);for(let Fe=0,tt=F.length;Fe<tt;Fe++){let zt=F[Fe].getSweepEvents();for(let bt=0,dn=zt.length;bt<dn;bt++)G.add(zt[bt])}let te=new Fu(G),pe=null;for(G.size!=0&&(pe=G.first(),G.delete(pe));pe;){let Fe=te.process(pe);for(let tt=0,zt=Fe.length;tt<zt;tt++){let bt=Fe[tt];bt.consumedBy===void 0&&G.add(bt)}G.size!=0?(pe=G.first(),G.delete(pe)):pe=null}Ss.reset();let xe=Ia.factory(te.segments);return new Th(xe).getGeom()}},uh=new fc,Ah=uh,Pc=(y,...S)=>Ah.run("intersection",y,S),jd=(y,...S)=>Ah.run("difference",y,S);Ss.set;function Jh(y){let S={type:"Feature"};return S.geometry=y,S}function zu(y){return y.type==="Feature"?y.geometry:y}function pc(y){return y&&y.geometry&&y.geometry.coordinates?y.geometry.coordinates:y}function Gr(y){return Jh({type:"LineString",coordinates:y})}function vu(y){return Jh({type:"MultiLineString",coordinates:y})}function wd(y){return Jh({type:"Polygon",coordinates:y})}function kh(y){return Jh({type:"MultiPolygon",coordinates:y})}function Ih(y,S){let I=zu(y),F=zu(S),G=Pc(I.coordinates,F.coordinates);return G.length===0?null:G.length===1?wd(G[0]):kh(G)}function B(y,S){let I=zu(y),F=zu(S),G=jd(I.coordinates,F.coordinates);return G.length===0?null:G.length===1?wd(G[0]):kh(G)}function H(y){return Array.isArray(y)?1+H(y[0]):-1}function ie(y){y instanceof L.Polyline&&(y=y.toGeoJSON(15));let S=pc(y),I=H(S),F=[];return I>1?S.forEach(G=>{F.push(Gr(G))}):F.push(y),F}function Ee(y){let S=[];return y.eachLayer(I=>{S.push(pc(I.toGeoJSON(15)))}),vu(S)}uo.Cut=uo.Polygon.extend({initialize(y){this._map=y,this._shape="Cut",this.toolbarButtonName="cutPolygon"},_finishShape(){if(this._editedLayers=[],!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let y=this._layer.getLatLngs();if(y.length<=2)return;let S=L.polygon(y,this.options.pathOptions);S._latlngInfos=this._layer._latlngInfo,this.cut(S),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex,this._editedLayers.forEach(({layer:F,originalLayer:G})=>{this._fireCut(G,F,G),this._fireCut(this._map,F,G),G.pm._fireEdit()}),this._editedLayers=[];let I=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(I))},cut(y){let S=this._map._layers,I=y._latlngInfos||[];Object.keys(S).map(F=>S[F]).filter(F=>F.pm).filter(F=>!F._pmTempLayer).filter(F=>!L.PM.optIn&&!F.options.pmIgnore||L.PM.optIn&&F.options.pmIgnore===!1).filter(F=>F instanceof L.Polyline).filter(F=>F!==y).filter(F=>F.pm.options.allowCutting).filter(F=>this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0?this.options.layersToCut.indexOf(F)>-1:!0).filter(F=>!this._layerGroup.hasLayer(F)).filter(F=>{try{let G=!!Ta(y.toGeoJSON(15),F.toGeoJSON(15)).features.length>0;return G||F instanceof L.Polyline&&!(F instanceof L.Polygon)?G:!!Ih(y.toGeoJSON(15),F.toGeoJSON(15))}catch{return F instanceof L.Polygon&&console.error("You can't cut polygons with self-intersections"),!1}}).forEach(F=>{let G;if(F instanceof L.Polygon){G=L.polygon(F.getLatLngs());let Fe=G.getLatLngs();I.forEach(tt=>{if(tt&&tt.snapInfo){let{latlng:zt}=tt,bt=this._calcClosestLayer(zt,[G]);if(bt&&bt.segment&&bt.distance<this.options.snapDistance){let{segment:dn}=bt;if(dn&&dn.length===2){let{indexPath:zn,parentPath:hr,newIndex:Ir}=L.PM.Utils._getIndexFromSegment(Fe,dn);(zn.length>1?(0,Us.default)(Fe,hr):Fe).splice(Ir,0,zt)}}}})}else G=F;let te=this._cutLayer(y,G),pe=L.geoJSON(te,F.options);pe.getLayers().length===1&&([pe]=pe.getLayers()),this._setPane(pe,"layerPane");let xe=pe.addTo(this._map.pm._getContainingLayer());if(xe.pm.enable(F.pm.options),xe.pm.disable(),F._pmTempLayer=!0,y._pmTempLayer=!0,F.remove(),F.removeFrom(this._map.pm._getContainingLayer()),y.remove(),y.removeFrom(this._map.pm._getContainingLayer()),xe.getLayers&&xe.getLayers().length===0&&this._map.pm.removeLayer({target:xe}),xe instanceof L.LayerGroup?(xe.eachLayer(Fe=>{this._addDrawnLayerProp(Fe)}),this._addDrawnLayerProp(xe)):this._addDrawnLayerProp(xe),this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0){let Fe=this.options.layersToCut.indexOf(F);Fe>-1&&this.options.layersToCut.splice(Fe,1)}this._editedLayers.push({layer:xe,originalLayer:F})})},_cutLayer(y,S){let I=L.geoJSON(),F;if(S instanceof L.Polygon)F=B(S.toGeoJSON(15),y.toGeoJSON(15));else{let G=ie(S);G.forEach(te=>{let pe=ii(te,y.toGeoJSON(15)),xe;pe&&pe.features.length>0?xe=L.geoJSON(pe):xe=L.geoJSON(te),xe.getLayers().forEach(Fe=>{al(y.toGeoJSON(15),Fe.toGeoJSON(15))||Fe.addTo(I)})}),G.length>1?F=Ee(I):F=I.toGeoJSON(15)}return F},_change:L.Util.falseFn}),uo.Text=uo.extend({initialize(y){this._map=y,this._shape="Text",this.toolbarButtonName="drawText"},enable(y){L.Util.setOptions(this,y),this._enabled=!0,this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(di("tooltips.placeText"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this._map.getContainer().classList.add("geoman-draw-cursor"),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){var y;this._enabled&&(this._enabled=!1,this._map.off("click",this._createMarker,this),(y=this._hintMarker)==null||y.remove(),this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("mousemove",this._syncHintMarker,this),this._map.off("mousemove",this._showHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(y){this.enabled()?this.disable():this.enable(y)},_syncHintMarker(y){if(this._hintMarker.setLatLng(y.latlng),this.options.snappable){let S=y;S.target=this._hintMarker,this._handleSnapping(S)}},_createMarker(y){var G,te,pe,xe;if(!y.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(y.latlng);let S=this._hintMarker.getLatLng();if(this.textArea=this._createTextArea(),(G=this.options.textOptions)==null?void 0:G.className){let Fe=this.options.textOptions.className.split(" ");this.textArea.classList.add(...Fe)}let I=this._createTextIcon(this.textArea),F=new L.Marker(S,{textMarker:!0,_textMarkerOverPM:!0,icon:I});if(this._setPane(F,"markerPane"),this._finishLayer(F),F.pm||(F.options.draggable=!1),F.addTo(this._map.pm._getContainingLayer()),F.pm){F.pm.textArea=this.textArea,L.setOptions(F.pm,{removeIfEmpty:((te=this.options.textOptions)==null?void 0:te.removeIfEmpty)??!0});let Fe=((pe=this.options.textOptions)==null?void 0:pe.focusAfterDraw)??!0;F.pm._createTextMarker(Fe),(xe=this.options.textOptions)!=null&&xe.text&&F.pm.setText(this.options.textOptions.text)}this._fireCreate(F),this._cleanupSnapping(),this.disable(),this.options.continueDrawing&&this._map.once("mousemove",this._showHintMarkerAfterMoving,this)},_showHintMarkerAfterMoving(y){this.enable(),this._hintMarker.setLatLng(y.latlng)},_createTextArea(){let y=document.createElement("textarea");return y.readOnly=!0,y.classList.add("pm-textarea","pm-disabled"),y},_createTextIcon(y){return L.divIcon({className:"pm-text-marker",html:y})}});var Ye={enableLayerDrag(){if(!this.options.draggable||!this._layer._map)return;this.disable(),this._layerDragEnabled=!0,this._map||(this._map=this._layer._map),(this._layer instanceof L.Marker||this._layer instanceof L.ImageOverlay)&&L.DomEvent.on(this._getDOMElem(),"dragstart",this._stopDOMImageDrag),this._layer.dragging&&this._layer.dragging.disable(),this._tempDragCoord=null,ss(this._layer)instanceof L.Canvas?(this._layer.on("mouseout",this.removeDraggingClass,this),this._layer.on("mouseover",this.addDraggingClass,this)):this.addDraggingClass(),this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!0;let y=this._getDOMElem();y&&(ss(this._layer)instanceof L.Canvas?(this._layer.on("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._addTouchEvents(y)):L.DomEvent.on(y,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._fireDragEnable()},disableLayerDrag(){this._layerDragEnabled=!1,ss(this._layer)instanceof L.Canvas?(this._layer.off("mouseout",this.removeDraggingClass,this),this._layer.off("mouseover",this.addDraggingClass,this)):this.removeDraggingClass(),this._originalMapDragState&&this._dragging&&this._map.dragging.enable(),this._safeToCacheDragState=!1,this._layer.dragging&&this._layer.dragging.disable();let y=this._getDOMElem();y&&(ss(this._layer)instanceof L.Canvas?(this._layer.off("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._removeTouchEvents(y)):L.DomEvent.off(y,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._layerDragged&&this._fireUpdate(),this._layerDragged=!1,this._fireDragDisable()},dragging(){return this._dragging},layerDragEnabled(){return!!this._layerDragEnabled},_simulateMouseDownEvent(y){let S=y.touches?y.touches[0]:y,I={originalEvent:S,target:this._layer};return I.containerPoint=this._map.mouseEventToContainerPoint(S),I.latlng=this._map.containerPointToLatLng(I.containerPoint),this._dragMixinOnMouseDown(I),!1},_simulateMouseMoveEvent(y){let S=y.touches?y.touches[0]:y,I={originalEvent:S,target:this._layer};return I.containerPoint=this._map.mouseEventToContainerPoint(S),I.latlng=this._map.containerPointToLatLng(I.containerPoint),this._dragMixinOnMouseMove(I),!1},_simulateMouseUpEvent(y){let S={originalEvent:y.touches?y.touches[0]:y,target:this._layer};return y.type.indexOf("touch")===-1&&(S.containerPoint=this._map.mouseEventToContainerPoint(y),S.latlng=this._map.containerPointToLatLng(S.containerPoint)),this._dragMixinOnMouseUp(S),!1},_dragMixinOnMouseDown(y){if(y.originalEvent.button>0)return;this._overwriteEventIfItComesFromMarker(y);let S=y._fromLayerSync,I=this._syncLayers("_dragMixinOnMouseDown",y);if(this._layer instanceof L.Marker&&(this.options.snappable&&!S&&!I?this._initSnappableMarkers():this._disableSnapping()),this._layer instanceof L.CircleMarker){let F="resizeableCircleMarker";this._layer instanceof L.Circle&&(F="resizeableCircle"),this.options.snappable&&!S&&!I?this._layer.pm.options[F]||this._initSnappableMarkersDrag():this._layer.pm.options[F]?this._layer.pm._disableSnapping():this._layer.pm._disableSnappingDrag()}this._safeToCacheDragState&&(this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!1),this._tempDragCoord=y.latlng,L.DomEvent.on(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),L.DomEvent.on(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this)},_dragMixinOnMouseMove(y){this._overwriteEventIfItComesFromMarker(y);let S=this._getDOMElem();this._syncLayers("_dragMixinOnMouseMove",y),this._dragging||(this._dragging=!0,L.DomUtil.addClass(S,"leaflet-pm-dragging"),this._layer instanceof L.Marker||this._layer.bringToFront(),this._originalMapDragState&&this._map.dragging.disable(),this._fireDragStart()),this._tempDragCoord||(this._tempDragCoord=y.latlng),this._onLayerDrag(y),this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle()},_dragMixinOnMouseUp(y){let S=this._getDOMElem();return this._syncLayers("_dragMixinOnMouseUp",y),this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0,L.DomEvent.off(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this),L.DomEvent.off(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),this._dragging?(this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle(),this._layerDragged=!0,window.setTimeout(()=>{this._dragging=!1,S&&L.DomUtil.removeClass(S,"leaflet-pm-dragging"),this._fireDragEnd(),this._fireEdit(),this._layerEdited=!0},10),!0):!1},_onLayerDrag(y){let{latlng:S}=y,I={lat:S.lat-this._tempDragCoord.lat,lng:S.lng-this._tempDragCoord.lng},F=G=>G.map(te=>{if(Array.isArray(te))return F(te);let pe={lat:te.lat+I.lat,lng:te.lng+I.lng};return(te.alt||te.alt===0)&&(pe.alt=te.alt),pe});if(this._layer instanceof L.Circle&&this._layer.options.resizeableCircle||this._layer instanceof L.CircleMarker&&this._layer.options.resizeableCircleMarker){let G=F([this._layer.getLatLng()]);this._layer.setLatLng(G[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.CircleMarker||this._layer instanceof L.Marker){let G=this._layer.getLatLng();this._layer._snapped&&(G=this._layer._orgLatLng);let te=F([G]);this._layer.setLatLng(te[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.ImageOverlay){let G=F([this._layer.getBounds().getNorthWest(),this._layer.getBounds().getSouthEast()]);this._layer.setBounds(G),this._fireChange(this._layer.getBounds(),"Edit")}else{let G=F(this._layer.getLatLngs());this._layer.setLatLngs(G),this._fireChange(this._layer.getLatLngs(),"Edit")}this._tempDragCoord=S,y.layer=this._layer,this._fireDrag(y)},addDraggingClass(){let y=this._getDOMElem();y&&L.DomUtil.addClass(y,"leaflet-pm-draggable")},removeDraggingClass(){let y=this._getDOMElem();y&&L.DomUtil.removeClass(y,"leaflet-pm-draggable")},_getDOMElem(){let y=null;return this._layer._path?y=this._layer._path:this._layer._renderer&&this._layer._renderer._container?y=this._layer._renderer._container:this._layer._image?y=this._layer._image:this._layer._icon&&(y=this._layer._icon),y},_overwriteEventIfItComesFromMarker(y){y.target.getLatLng&&(!y.target._radius||y.target._radius<=10)&&(y.containerPoint=this._map.mouseEventToContainerPoint(y.originalEvent),y.latlng=this._map.containerPointToLatLng(y.containerPoint))},_syncLayers(y,S){if(this.enabled())return!1;if(!S._fromLayerSync&&this._layer===S.target&&this.options.syncLayersOnDrag){S._fromLayerSync=!0;let I=[];if(L.Util.isArray(this.options.syncLayersOnDrag))I=this.options.syncLayersOnDrag,this.options.syncLayersOnDrag.forEach(F=>{F instanceof L.LayerGroup&&(I=I.concat(F.pm.getLayers(!0)))});else if(this.options.syncLayersOnDrag===!0&&this._parentLayerGroup)for(let F in this._parentLayerGroup){let G=this._parentLayerGroup[F];G.pm&&(I=G.pm.getLayers(!0))}return L.Util.isArray(I)&&I.length>0&&(I=I.filter(F=>!!F.pm).filter(F=>!!F.pm.options.draggable),I.forEach(F=>{F!==this._layer&&F.pm[y]&&(F._snapped=!1,F.pm[y](S))})),I.length>0}return!1},_stopDOMImageDrag(y){return y.preventDefault(),!1}},rt=Ye,ut=f(ja());function ht(y,S,I,F){return I.unproject(S.transform(I.project(y,F)),F)}function gt(y,S,I){let F=I.getMaxZoom();if(F===1/0&&(F=I.getZoom()),L.Util.isArray(y)){let G=[];return y.forEach(te=>{G.push(gt(te,S,I))}),G}return y instanceof L.LatLng?ht(y,S,I,F):null}function kt(y,S){S instanceof L.Layer&&(S=S.getLatLng());let I=y.getMaxZoom();return I===1/0&&(I=y.getZoom()),y.project(S,I)}function _n(y,S){let I=y.getMaxZoom();return I===1/0&&(I=y.getZoom()),y.unproject(S,I)}var Vn={_onRotateStart(y){this._preventRenderingMarkers(!0),this._rotationOriginLatLng=this._getRotationCenter().clone(),this._rotationOriginPoint=kt(this._map,this._rotationOriginLatLng),this._rotationStartPoint=kt(this._map,y.target.getLatLng()),this._initialRotateLatLng=Ma(this._layer),this._startAngle=this.getAngle();let S=Ma(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._fireRotationStart(this._rotationLayer,S),this._fireRotationStart(this._map,S)},_onRotate(y){let S=kt(this._map,y.target.getLatLng()),I=this._rotationStartPoint,F=this._rotationOriginPoint,G=Math.atan2(S.y-F.y,S.x-F.x)-Math.atan2(I.y-F.y,I.x-F.x);this._layer.setLatLngs(this._rotateLayer(G,this._initialRotateLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let te=this;function pe(zt,bt=[],dn=-1){if(dn>-1&&bt.push(dn),L.Util.isArray(zt[0]))zt.forEach((zn,hr)=>pe(zn,bt.slice(),hr));else{let zn=bt.length>0?(0,ut.default)(te._markers,bt):te._markers[0];zt.forEach((hr,Ir)=>{zn[Ir].setLatLng(hr)})}}pe(this._layer.getLatLngs());let xe=Ma(this._rotationLayer);this._rotationLayer.setLatLngs(this._rotateLayer(G,this._rotationLayer.pm._rotateOrgLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let Fe=G*180/Math.PI;Fe=Fe<0?Fe+360:Fe;let tt=Fe+this._startAngle;this._setAngle(tt),this._rotationLayer.pm._setAngle(tt),this._fireRotation(this._rotationLayer,Fe,xe),this._fireRotation(this._map,Fe,xe),this._rotationLayer.pm._fireChange(this._rotationLayer.getLatLngs(),"Rotation")},_onRotateEnd(){let y=this._startAngle;delete this._rotationOriginLatLng,delete this._rotationOriginPoint,delete this._rotationStartPoint,delete this._initialRotateLatLng,delete this._startAngle;let S=Ma(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._rotationLayer.pm._rotateOrgLatLng=Ma(this._rotationLayer),this._fireRotationEnd(this._rotationLayer,y,S),this._fireRotationEnd(this._map,y,S),this._rotationLayer.pm._fireEdit(this._rotationLayer,"Rotation"),this._preventRenderingMarkers(!1),this._layerRotated=!0},_rotateLayer(y,S,I,F,G){let te=kt(G,I);return this._matrix=F.clone().rotate(y,te).flip(),gt(S,this._matrix,G)},_setAngle(y){y=y<0?y+360:y,this._angle=y%360},_getRotationCenter(){if(this._rotationCenter)return this._rotationCenter;let y=L.polygon(this._layer.getLatLngs(),{stroke:!1,fill:!1,pmIgnore:!0}).addTo(this._layer._map),S=y.getCenter();return y.removeFrom(this._layer._map),S},enableRotate(){if(!this.options.allowRotation){this.disableRotate();return}this.rotateEnabled()&&this.disableRotate(),this._layer instanceof L.Rectangle&&this._angle===void 0&&this.setInitAngle(Ea(this._layer._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);let y={fill:!1,stroke:!1,pmIgnore:!1,snapIgnore:!0};this._rotatePoly=L.polygon(this._layer.getLatLngs(),y),this._rotatePoly._pmTempLayer=!0,this._rotatePoly.addTo(this._layer._map),this._rotatePoly.pm._setAngle(this.getAngle()),this._rotatePoly.pm.setRotationCenter(this.getRotationCenter()),this._rotatePoly.pm.setOptions(this._layer._map.pm.getGlobalOptions()),this._rotatePoly.pm.setOptions({rotate:!0,snappable:!1,hideMiddleMarkers:!0}),this._rotatePoly.pm._rotationLayer=this._layer,this._rotatePoly.pm.enable(),this._rotateOrgLatLng=Ma(this._layer),this._rotateEnabled=!0,this._layer.on("remove",this.disableRotate,this),this._fireRotationEnable(this._layer),this._fireRotationEnable(this._layer._map)},disableRotate(){this.rotateEnabled()&&(this._rotatePoly.pm._layerRotated&&this._fireUpdate(),this._rotatePoly.pm._layerRotated=!1,this._rotatePoly.pm.disable(),this._rotatePoly.remove(),this._rotatePoly.pm.setOptions({rotate:!1}),this._rotatePoly=void 0,this._rotateOrgLatLng=void 0,this._layer.off("remove",this.disableRotate,this),this._rotateEnabled=!1,this._fireRotationDisable(this._layer),this._fireRotationDisable(this._layer._map))},rotateEnabled(){return!!this._rotateEnabled},rotateLayer(y){let S=this.getAngle(),I=this._layer.getLatLngs(),F=y*(Math.PI/180);this._layer.setLatLngs(this._rotateLayer(F,this._layer.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._layer._map)),this._rotateOrgLatLng=L.polygon(this._layer.getLatLngs()).getLatLngs(),this._setAngle(this.getAngle()+y),this.rotateEnabled()&&this._rotatePoly&&this._rotatePoly.pm.enabled()&&(this._rotatePoly.setLatLngs(this._rotateLayer(F,this._rotatePoly.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._rotatePoly._map)),this._rotatePoly.pm._initMarkers());let G=this.getAngle()-S;G=G<0?G+360:G,this._startAngle=S,this._fireRotation(this._layer,G,I,this._layer),this._fireRotation(this._map||this._layer._map,G,I,this._layer),delete this._startAngle,this._fireChange(this._layer.getLatLngs(),"Rotation")},rotateLayerToAngle(y){let S=y-this.getAngle();this.rotateLayer(S)},getAngle(){return this._angle||0},setInitAngle(y){this._setAngle(y)},getRotationCenter(){return this._getRotationCenter()},setRotationCenter(y){this._rotationCenter=y,this._rotatePoly&&this._rotatePoly.pm.setRotationCenter(y)}},Un=Vn,kn=L.Class.extend({includes:[rt,ca,Un,Iu],options:{snappable:!0,snapDistance:20,allowSelfIntersection:!0,allowSelfIntersectionEdit:!1,preventMarkerRemoval:!1,removeLayerBelowMinVertexCount:!0,limitMarkersToCount:-1,hideMiddleMarkers:!1,snapSegment:!0,syncLayersOnDrag:!1,draggable:!0,allowEditing:!0,allowRemoval:!0,allowCutting:!0,allowRotation:!0,addVertexOn:"click",removeVertexOn:"contextmenu",removeVertexValidation:void 0,addVertexValidation:void 0,moveVertexValidation:void 0,resizeableCircleMarker:!1,resizeableCircle:!0,snapMiddle:!1,snapVertex:!0},setOptions(y){L.Util.setOptions(this,y)},getOptions(){return this.options},applyOptions(){},isPolygon(){return this._layer instanceof L.Polygon},getShape(){return this._shape},_setPane(y,S){S==="layerPane"?y.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":S==="vertexPane"?y.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":S==="markerPane"&&(y.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},remove(){(this._map||this._layer._map).pm.removeLayer({target:this._layer})},_vertexValidation(y,S){let I=S.target,F={layer:this._layer,marker:I,event:S},G="";return y==="move"?G="moveVertexValidation":y==="add"?G="addVertexValidation":y==="remove"&&(G="removeVertexValidation"),this.options[G]&&typeof this.options[G]=="function"&&!this.options[G](F)?(y==="move"&&(I._cancelDragEventChain=I.getLatLng()),!1):(I._cancelDragEventChain=null,!0)},_vertexValidationDrag(y){return y._cancelDragEventChain?(y._latlng=y._cancelDragEventChain,y.update(),!1):!0},_vertexValidationDragEnd(y){return y._cancelDragEventChain?(y._cancelDragEventChain=null,!1):!0}}),ur=kn;ur.LayerGroup=L.Class.extend({initialize(y){this._layerGroup=y,this._layers=this.getLayers(),this._getMap(),this._layers.forEach(F=>this._initLayer(F));let S=F=>{if(F.layer._pmTempLayer)return;this._layers=this.getLayers();let G=this._layers.filter(te=>!te.pm._parentLayerGroup||!(this._layerGroup._leaflet_id in te.pm._parentLayerGroup));G.forEach(te=>{this._initLayer(te)}),G.length>0&&this._getMap()&&this._getMap().pm.globalEditModeEnabled()&&this.enabled()&&this.enable(this.getOptions())};this._layerGroup.on("layeradd",L.Util.throttle(S,100,this),this),this._layerGroup.on("layerremove",F=>{this._removeLayerFromGroup(F.target)},this);let I=F=>{F.target._pmTempLayer||(this._layers=this.getLayers())};this._layerGroup.on("layerremove",L.Util.throttle(I,100,this),this)},enable(y,S=[]){S.length===0&&(this._layers=this.getLayers()),this._options=y,this._layers.forEach(I=>{I instanceof L.LayerGroup?S.indexOf(I._leaflet_id)===-1&&(S.push(I._leaflet_id),I.pm.enable(y,S)):I.pm.enable(y)})},disable(y=[]){y.length===0&&(this._layers=this.getLayers()),this._layers.forEach(S=>{S instanceof L.LayerGroup?y.indexOf(S._leaflet_id)===-1&&(y.push(S._leaflet_id),S.pm.disable(y)):S.pm.disable()})},enabled(y=[]){return y.length===0&&(this._layers=this.getLayers()),!!this._layers.find(S=>S instanceof L.LayerGroup?y.indexOf(S._leaflet_id)===-1?(y.push(S._leaflet_id),S.pm.enabled(y)):!1:S.pm.enabled())},toggleEdit(y,S=[]){S.length===0&&(this._layers=this.getLayers()),this._options=y,this._layers.forEach(I=>{I instanceof L.LayerGroup?S.indexOf(I._leaflet_id)===-1&&(S.push(I._leaflet_id),I.pm.toggleEdit(y,S)):I.pm.toggleEdit(y)})},_initLayer(y){let S=L.Util.stamp(this._layerGroup);y.pm._parentLayerGroup||(y.pm._parentLayerGroup={}),y.pm._parentLayerGroup[S]=this._layerGroup},_removeLayerFromGroup(y){if(y.pm&&y.pm._layerGroup){let S=L.Util.stamp(this._layerGroup);delete y.pm._layerGroup[S]}},dragging(){return this._layers=this.getLayers(),this._layers?!!this._layers.find(y=>y.pm.dragging()):!1},getOptions(){return this.options},_getMap(){var y;return this._map||((y=this._layers.find(S=>!!S._map))==null?void 0:y._map)||null},getLayers(y=!1,S=!0,I=!0,F=[]){let G=[];return y?this._layerGroup.getLayers().forEach(te=>{G.push(te),te instanceof L.LayerGroup&&F.indexOf(te._leaflet_id)===-1&&(F.push(te._leaflet_id),G=G.concat(te.pm.getLayers(!0,!0,!0,F)))}):G=this._layerGroup.getLayers(),I&&(G=G.filter(te=>!(te instanceof L.LayerGroup))),S&&(G=G.filter(te=>!!te.pm),G=G.filter(te=>!te._pmTempLayer),G=G.filter(te=>!L.PM.optIn&&!te.options.pmIgnore||L.PM.optIn&&te.options.pmIgnore===!1)),G},setOptions(y,S=[]){S.length===0&&(this._layers=this.getLayers()),this.options=y,this._layers.forEach(I=>{I.pm&&(I instanceof L.LayerGroup?S.indexOf(I._leaflet_id)===-1&&(S.push(I._leaflet_id),I.pm.setOptions(y,S)):I.pm.setOptions(y))})}}),ur.Marker=ur.extend({_shape:"Marker",initialize(y){this._layer=y,this._enabled=!1,this._layer.on("dragend",this._onDragEnd,this)},enable(y={draggable:!0}){if(L.Util.setOptions(this,y),!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._fireEnable()},disable(){this.enabled()&&(this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this._layer.off("contextmenu",this._removeMarker,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1)},enabled(){return this._enabled},toggleEdit(y){this.enabled()?this.disable():this.enable(y)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this.options.draggable?this.enableLayerDrag():this.disableLayerDrag(),this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_removeMarker(y){let S=y.target;S.remove(),this._fireRemove(S),this._fireRemove(this._map,S)},_onDragEnd(){this._fireEdit(),this._layerEdited=!0},_initSnappableMarkers(){let y=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,y.off("pm:drag",this._handleSnapping,this),y.on("pm:drag",this._handleSnapping,this),y.off("pm:dragend",this._cleanupSnapping,this),y.on("pm:dragend",this._cleanupSnapping,this),y.off("pm:dragstart",this._unsnap,this),y.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let y=this._layer;y.off("pm:drag",this._handleSnapping,this),y.off("pm:dragend",this._cleanupSnapping,this),y.off("pm:dragstart",this._unsnap,this)}});var Zn=f(ja()),Qt={filterMarkerGroup(){this.markerCache=[],this.createCache(),this._layer.on("pm:edit",this.createCache,this),this.applyLimitFilters({}),this.throttledApplyLimitFilters||(this.throttledApplyLimitFilters=L.Util.throttle(this.applyLimitFilters,100,this)),this._layer.on("pm:disable",this._removeMarkerLimitEvents,this),this._layer.on("remove",this._removeMarkerLimitEvents,this),this.options.limitMarkersToCount>-1&&(this._layer.on("pm:vertexremoved",this._initMarkers,this),this._map.on("mousemove",this.throttledApplyLimitFilters,this))},_removeMarkerLimitEvents(){this._map.off("mousemove",this.throttledApplyLimitFilters,this),this._layer.off("pm:edit",this.createCache,this),this._layer.off("pm:disable",this._removeMarkerLimitEvents,this),this._layer.off("pm:vertexremoved",this._initMarkers,this)},createCache(){let y=[...this._markerGroup.getLayers(),...this.markerCache];this.markerCache=y.filter((S,I,F)=>F.indexOf(S)===I)},_removeFromCache(y){let S=this.markerCache.indexOf(y);S>-1&&this.markerCache.splice(S,1)},renderLimits(y){this.markerCache.forEach(S=>{y.includes(S)?this._markerGroup.addLayer(S):this._markerGroup.removeLayer(S)})},applyLimitFilters({latlng:y={lat:0,lng:0}}){if(this._preventRenderMarkers)return;let S=[...this._filterClosestMarkers(y)];this.renderLimits(S)},_filterClosestMarkers(y){let S=[...this.markerCache],I=this.options.limitMarkersToCount;return I===-1?S:(S.sort((F,G)=>{let te=F._latlng.distanceTo(y),pe=G._latlng.distanceTo(y);return te-pe}),S.filter((F,G)=>I>-1?G<I:!0))},_preventRenderMarkers:!1,_preventRenderingMarkers(y){this._preventRenderMarkers=!!y}},Sn=Qt;ur.Line=ur.extend({includes:[Sn],_shape:"Line",initialize(y){this._layer=y,this._enabled=!1},enable(y){if(L.Util.setOptions(this,y),this._map=this._layer._map,!!this._map){if(!this.options.allowEditing){this.disable();return}this.enabled()&&this.disable(),this._enabled=!0,this._initMarkers(),this.applyOptions(),this._layer.on("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.on("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this),this.options.allowSelfIntersection?this.cachedColor=void 0:(this._layer.options.color!=="#f00000ff"?(this.cachedColor=this._layer.options.color,this.isRed=!1):this.isRed=!0,this._handleLayerStyle()),this._fireEnable()}},disable(){if(!this.enabled()||this._dragging)return;this._enabled=!1,this._markerGroup.clearLayers(),this._markerGroup.removeFrom(this._map),this._layer.off("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.off("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this);let y=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(y,"leaflet-pm-draggable"),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()},enabled(){return this._enabled},toggleEdit(y){return this.enabled()?this.disable():this.enable(y),this.enabled()},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initMarkers(){let y=this._map,S=this._layer.getLatLngs();this._markerGroup&&(this._markerGroup.removeFrom(y),this._markerGroup.clearLayers()),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0;let I=F=>{if(Array.isArray(F[0]))return F.map(I,this);let G=F.map(this._createMarker,this);return this.options.hideMiddleMarkers!==!0&&F.map((te,pe)=>{let xe=this.isPolygon()?(pe+1)%F.length:pe+1;return this._createMiddleMarker(G[pe],G[xe])}),G};this._markers=I(S),this.filterMarkerGroup(),y.addLayer(this._markerGroup)},_createMarker(y){let S=new L.Marker(y,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(S,"vertexPane"),S._pmTempLayer=!0,this.options.rotate?(S.on("dragstart",this._onRotateStart,this),S.on("drag",this._onRotate,this),S.on("dragend",this._onRotateEnd,this)):(S.on("click",this._onVertexClick,this),S.on("dragstart",this._onMarkerDragStart,this),S.on("move",this._onMarkerDrag,this),S.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||S.on(this.options.removeVertexOn,this._removeMarker,this)),this._markerGroup.addLayer(S),S},_createMiddleMarker(y,S){if(!y||!S)return!1;let I=L.PM.Utils.calcMiddleLatLng(this._map,y.getLatLng(),S.getLatLng()),F=this._createMarker(I),G=L.divIcon({className:"marker-icon marker-icon-middle"});return F.setIcon(G),F.leftM=y,F.rightM=S,y._middleMarkerNext=F,S._middleMarkerPrev=F,F.on(this.options.addVertexOn,this._onMiddleMarkerClick,this),F.on("movestart",this._onMiddleMarkerMoveStart,this),F},_onMiddleMarkerClick(y){let S=y.target;if(!this._vertexValidation("add",y))return;let I=L.divIcon({className:"marker-icon"});S.setIcon(I),this._addMarker(S,S.leftM,S.rightM)},_onMiddleMarkerMoveStart(y){let S=y.target;if(S.on("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidation("add",y)){S.on("move",this._onMiddleMarkerMovePrevent,this);return}S._dragging=!0,this._addMarker(S,S.leftM,S.rightM)},_onMiddleMarkerMovePrevent(y){let S=y.target;this._vertexValidationDrag(S)},_onMiddleMarkerMoveEnd(y){let S=y.target;if(S.off("move",this._onMiddleMarkerMovePrevent,this),S.off("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidationDragEnd(S))return;let I=L.divIcon({className:"marker-icon"});S.setIcon(I),setTimeout(()=>{delete S._dragging},100)},_addMarker(y,S,I){y.off("movestart",this._onMiddleMarkerMoveStart,this),y.off(this.options.addVertexOn,this._onMiddleMarkerClick,this);let F=y.getLatLng(),G=this._layer._latlngs;delete y.leftM,delete y.rightM;let{indexPath:te,index:pe,parentPath:xe}=L.PM.Utils.findDeepMarkerIndex(this._markers,S),Fe=te.length>1?(0,Zn.default)(G,xe):G,tt=te.length>1?(0,Zn.default)(this._markers,xe):this._markers;Fe.splice(pe+1,0,F),tt.splice(pe+1,0,y),this._layer.setLatLngs(G),this.options.hideMiddleMarkers!==!0&&(this._createMiddleMarker(S,y),this._createMiddleMarker(y,I)),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit"),this._fireVertexAdded(y,L.PM.Utils.findDeepMarkerIndex(this._markers,y).indexPath,F),this.options.snappable&&this._initSnappableMarkers()},hasSelfIntersection(){return Xi(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersectionOnVertexRemoval(){this._handleLayerStyle(!0)&&(this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers())},_handleLayerStyle(y){let S=this._layer,I,F;if(this.options.allowSelfIntersection?I=!1:(F=Xi(this._layer.toGeoJSON(15)),I=F.features.length>0),I){if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!0),this.isRed)return I;y?this._flashLayer():(S.setStyle({color:"#f00000ff"}),this.isRed=!0),this._fireIntersect(F)}else S.setStyle({color:this.cachedColor}),this.isRed=!1,!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!1);return I},_flashLayer(){this.cachedColor||(this.cachedColor=this._layer.options.color),this._layer.setStyle({color:"#f00000ff"}),this.isRed=!0,window.setTimeout(()=>{this._layer.setStyle({color:this.cachedColor}),this.isRed=!1},200)},_updateDisabledMarkerStyle(y,S){y.forEach(I=>{Array.isArray(I)?this._updateDisabledMarkerStyle(I,S):I._icon&&(S&&!this._checkMarkerAllowedToDrag(I)?L.DomUtil.addClass(I._icon,"vertexmarker-disabled"):L.DomUtil.removeClass(I._icon,"vertexmarker-disabled"))})},_removeMarker(y){let S=y.target;if(!this._vertexValidation("remove",y))return;this.options.allowSelfIntersection||(this._coordsBeforeEdit=Ma(this._layer,this._layer.getLatLngs()));let I=this._layer.getLatLngs(),{indexPath:F,index:G,parentPath:te}=L.PM.Utils.findDeepMarkerIndex(this._markers,S);if(!F)return;let pe=F.length>1?(0,Zn.default)(I,te):I,xe=F.length>1?(0,Zn.default)(this._markers,te):this._markers,Fe=te[te.length-1]>0&&this._layer instanceof L.Polygon;if(!this.options.removeLayerBelowMinVertexCount&&!Fe&&(pe.length<=2||this.isPolygon()&&pe.length<=3)){this._flashLayer();return}pe.splice(G,1),this._layer.setLatLngs(I),this.isPolygon()&&pe.length<=2&&pe.splice(0,pe.length);let tt=!1;if(pe.length<=1&&(pe.splice(0,pe.length),te.length>1&&F.length>1&&(I=vl(I)),this._layer.setLatLngs(I),this._initMarkers(),tt=!0),ro(I)||this._layer.remove(),I=vl(I),this._layer.setLatLngs(I),this._markers=vl(this._markers),!tt&&(xe=F.length>1?(0,Zn.default)(this._markers,te):this._markers,S._middleMarkerPrev&&(this._markerGroup.removeLayer(S._middleMarkerPrev),this._removeFromCache(S._middleMarkerPrev)),S._middleMarkerNext&&(this._markerGroup.removeLayer(S._middleMarkerNext),this._removeFromCache(S._middleMarkerNext)),this._markerGroup.removeLayer(S),this._removeFromCache(S),xe)){let zt,bt;if(this.isPolygon()?(zt=(G+1)%xe.length,bt=(G+(xe.length-1))%xe.length):(bt=G-1<0?void 0:G-1,zt=G+1>=xe.length?void 0:G+1),zt!==bt){let dn=xe[bt],zn=xe[zt];this.options.hideMiddleMarkers!==!0&&this._createMiddleMarker(dn,zn)}xe.splice(G,1)}this._fireEdit(),this._layerEdited=!0,this._fireVertexRemoved(S,F),this._fireChange(this._layer.getLatLngs(),"Edit")},updatePolygonCoordsFromMarkerDrag(y){let S=this._layer.getLatLngs(),I=y.getLatLng(),{indexPath:F,index:G,parentPath:te}=L.PM.Utils.findDeepMarkerIndex(this._markers,y);(F.length>1?(0,Zn.default)(S,te):S).splice(G,1,I),this._layer.setLatLngs(S)},_getNeighborMarkers(y){let{indexPath:S,index:I,parentPath:F}=L.PM.Utils.findDeepMarkerIndex(this._markers,y),G=S.length>1?(0,Zn.default)(this._markers,F):this._markers,te=(I+1)%G.length,pe=(I+(G.length-1))%G.length,xe=G[pe],Fe=G[te];return{prevMarker:xe,nextMarker:Fe}},_checkMarkerAllowedToDrag(y){let{prevMarker:S,nextMarker:I}=this._getNeighborMarkers(y),F=L.polyline([S.getLatLng(),y.getLatLng()]),G=L.polyline([y.getLatLng(),I.getLatLng()]),te=Ta(this._layer.toGeoJSON(15),F.toGeoJSON(15)).features.length,pe=Ta(this._layer.toGeoJSON(15),G.toGeoJSON(15)).features.length;return y.getLatLng()===this._markers[0][0].getLatLng()?pe+=1:y.getLatLng()===this._markers[0][this._markers[0].length-1].getLatLng()&&(te+=1),!(te<=2&&pe<=2)},_onMarkerDragStart(y){let S=y.target;if(this.cachedColor||(this.cachedColor=this._layer.options.color),!this._vertexValidation("move",y))return;let{indexPath:I}=L.PM.Utils.findDeepMarkerIndex(this._markers,S);this._fireMarkerDragStart(y,I),this.options.allowSelfIntersection||(this._coordsBeforeEdit=Ma(this._layer,this._layer.getLatLngs())),!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()?this._markerAllowedToDrag=this._checkMarkerAllowedToDrag(S):this._markerAllowedToDrag=null},_onMarkerDrag(y){let S=y.target;if(!this._vertexValidationDrag(S))return;let{indexPath:I,index:F,parentPath:G}=L.PM.Utils.findDeepMarkerIndex(this._markers,S);if(!I)return;if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()&&this._markerAllowedToDrag===!1){this._layer.setLatLngs(this._coordsBeforeEdit),this._initMarkers(),this._handleLayerStyle();return}this.updatePolygonCoordsFromMarkerDrag(S);let te=I.length>1?(0,Zn.default)(this._markers,G):this._markers,pe=(F+1)%te.length,xe=(F+(te.length-1))%te.length,Fe=S.getLatLng(),tt=te[xe].getLatLng(),zt=te[pe].getLatLng();if(S._middleMarkerNext){let bt=L.PM.Utils.calcMiddleLatLng(this._map,Fe,zt);S._middleMarkerNext.setLatLng(bt)}if(S._middleMarkerPrev){let bt=L.PM.Utils.calcMiddleLatLng(this._map,Fe,tt);S._middleMarkerPrev.setLatLng(bt)}this.options.allowSelfIntersection||this._handleLayerStyle(),this._fireMarkerDrag(y,I),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(y){let S=y.target;if(!this._vertexValidationDragEnd(S))return;let{indexPath:I}=L.PM.Utils.findDeepMarkerIndex(this._markers,S),F=!this.options.allowSelfIntersection&&this.hasSelfIntersection();F&&this.options.allowSelfIntersectionEdit&&this._markerAllowedToDrag&&(F=!1);let G=!this.options.allowSelfIntersection&&F;if(this._fireMarkerDragEnd(y,I,G),G){this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers(),this.options.snappable&&this._initSnappableMarkers(),this._handleLayerStyle(),this._fireLayerReset(y,I);return}!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._handleLayerStyle(),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_onVertexClick(y){let S=y.target;if(S._dragging)return;let{indexPath:I}=L.PM.Utils.findDeepMarkerIndex(this._markers,S);this._fireVertexClick(y,I)}}),ur.Polygon=ur.Line.extend({_shape:"Polygon",_checkMarkerAllowedToDrag(y){let{prevMarker:S,nextMarker:I}=this._getNeighborMarkers(y),F=L.polyline([S.getLatLng(),y.getLatLng()]),G=L.polyline([y.getLatLng(),I.getLatLng()]),te=Ta(this._layer.toGeoJSON(15),F.toGeoJSON(15)).features.length,pe=Ta(this._layer.toGeoJSON(15),G.toGeoJSON(15)).features.length;return!(te<=2&&pe<=2)}}),ur.Rectangle=ur.Polygon.extend({_shape:"Rectangle",_initMarkers(){let y=this._map,S=this._findCorners();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0,y.addLayer(this._markerGroup),this._markers=[],this._markers[0]=S.map(this._createMarker,this),[this._cornerMarkers]=this._markers,this._layer.getLatLngs()[0].forEach((I,F)=>{let G=this._cornerMarkers.find(te=>te._index===F);G&&G.setLatLng(I)})},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this._addMarkerEvents()},_createMarker(y,S){let I=new L.Marker(y,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(I,"vertexPane"),I._origLatLng=y,I._index=S,I._pmTempLayer=!0,I.on("click",this._onVertexClick,this),this._markerGroup.addLayer(I),I},_addMarkerEvents(){this._markers[0].forEach(y=>{y.on("dragstart",this._onMarkerDragStart,this),y.on("drag",this._onMarkerDrag,this),y.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||y.on("contextmenu",this._removeMarker,this)})},_removeMarker(){return null},_onMarkerDragStart(y){if(!this._vertexValidation("move",y))return;let S=y.target,I=this._cornerMarkers;S._oppositeCornerLatLng=I.find(G=>G._index===(S._index+2)%4).getLatLng(),S._snapped=!1;let{indexPath:F}=L.PM.Utils.findDeepMarkerIndex(this._markers,S);this._fireMarkerDragStart(y,F)},_onMarkerDrag(y){let S=y.target;if(!this._vertexValidationDrag(S)||S._index===void 0)return;this._adjustRectangleForMarkerMove(S);let{indexPath:I}=L.PM.Utils.findDeepMarkerIndex(this._markers,S);this._fireMarkerDrag(y,I),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(y){let S=y.target;if(!this._vertexValidationDragEnd(S))return;this._cornerMarkers.forEach(F=>{delete F._oppositeCornerLatLng});let{indexPath:I}=L.PM.Utils.findDeepMarkerIndex(this._markers,S);this._fireMarkerDragEnd(y,I),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_adjustRectangleForMarkerMove(y){L.extend(y._origLatLng,y._latlng);let S=L.PM.Utils._getRotatedRectangle(y.getLatLng(),y._oppositeCornerLatLng,this.getAngle(),this._map);this._layer.setLatLngs(S),this._adjustAllMarkers(y),this._layer.redraw()},_adjustAllMarkers(y){let S=this._layer.getLatLngs()[0];if(S&&S.length!==4&&S.length>0)S.forEach((I,F)=>{this._cornerMarkers[F].setLatLng(I)}),this._cornerMarkers.slice(S.length).forEach(I=>{I.setLatLng(S[0])});else if(!S||!S.length)console.error("The layer has no LatLngs");else{let I=S.findIndex(F=>y.getLatLng().equals(F));I>-1?(this._cornerMarkers[(y._index+1)%4].setLatLng(S[(I+1)%4]),this._cornerMarkers[(y._index+2)%4].setLatLng(S[(I+2)%4]),this._cornerMarkers[(y._index+3)%4].setLatLng(S[(I+3)%4])):this._cornerMarkers.forEach(F=>{F.setLatLng(S[F._index])})}},_findCorners(){this._angle===void 0&&this.setInitAngle(Ea(this._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);let y=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(y[0],y[2],this.getAngle(),this._map||this)}}),ur.CircleMarker=ur.extend({_shape:"CircleMarker",initialize(y){this._layer=y,this._enabled=!1,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._updateHiddenPolyCircle()},enable(y={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,y),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._extendingEnable(),this._updateHiddenPolyCircle(),this._fireEnable()},_extendingEnable(){this._layer.on("pm:dragstart",this._onDragStart,this),this._layer.on("pm:drag",this._onMarkerDrag,this),this._layer.on("pm:dragend",this._onMarkerDragEnd,this)},disable(){this.dragging()||(this._map||(this._map=this._layer._map),this._map&&this.enabled()&&(this.layerDragEnabled()&&this.disableLayerDrag(),this._helperLayers&&(this._helperLayers.clearLayers(),this._helperLayers.removeFrom(this._map)),this.options[this._editableOption]?(this._map.off("move",this._syncMarkers,this),this._outerMarker.off("drag",this._handleOuterMarkerSnapping,this)):this._map.off("move",this._updateHiddenPolyCircle,this),this._extendingDisable(),this._layer.off("remove",this.disable,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1))},_extendingDisable(){this._layer.off("contextmenu",this._removeMarker,this)},enabled(){return this._enabled},toggleEdit(y){this.enabled()?this.disable():this.enable(y)},applyOptions(){this.options[this._editableOption]?(this._initMarkers(),this._map.on("move",this._syncMarkers,this),this.options.snappable?(this._initSnappableMarkers(),this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this),this._outerMarker.on("move",this._syncHintLine,this),this._outerMarker.on("move",this._syncCircleRadius,this)):this._disableSnapping()):(this.options.draggable&&this.enableLayerDrag(),this._map.on("move",this._updateHiddenPolyCircle,this),this.options.snappable?this._initSnappableMarkersDrag():this._disableSnappingDrag()),this._extendingApplyOptions()},_extendingApplyOptions(){this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_initMarkers(){let y=this._map;this._helperLayers&&(this._helperLayers.removeFrom(y),this._helperLayers.clearLayers()),this._helperLayers=new L.FeatureGroup,this._helperLayers._pmTempLayer=!0,this._helperLayers.addTo(y);let S=this._layer.getLatLng(),I=this._layer._radius,F=this._getLatLngOnCircle(S,I);this._centerMarker=this._createCenterMarker(S),this._outerMarker=this._createOuterMarker(F),this._markers=[this._centerMarker,this._outerMarker],this._createHintLine(this._centerMarker,this._outerMarker)},_getLatLngOnCircle(y,S){let I=this._map.project(y),F=L.point(I.x+S,I.y);return this._map.unproject(F)},_createHintLine(y,S){let I=y.getLatLng(),F=S.getLatLng();this._hintline=L.polyline([I,F],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._helperLayers.addLayer(this._hintline)},_createCenterMarker(y){let S=this._createMarker(y);return this.options.draggable?(L.DomUtil.addClass(S._icon,"leaflet-pm-draggable"),S.on("move",this._moveCircle,this)):S.dragging.disable(),S},_createOuterMarker(y){let S=this._createMarker(y);return S.on("drag",this._resizeCircle,this),S},_createMarker(y){let S=new L.Marker(y,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(S,"vertexPane"),S._origLatLng=y,S._pmTempLayer=!0,S.on("dragstart",this._onMarkerDragStart,this),S.on("drag",this._onMarkerDrag,this),S.on("dragend",this._onMarkerDragEnd,this),S.on("click",this._onVertexClick,this),this._helperLayers.addLayer(S),S},_moveCircle(y){if(y.target._cancelDragEventChain)return;let S=this._centerMarker.getLatLng();this._layer.setLatLng(S);let I=this._layer._radius,F=this._getLatLngOnCircle(S,I);this._outerMarker._latlng=F,this._outerMarker.update(),this._syncHintLine(),this._updateHiddenPolyCircle(),this._fireCenterPlaced("Edit"),this._fireChange(this._layer.getLatLng(),"Edit")},_syncMarkers(){let y=this._layer.getLatLng(),S=this._layer._radius,I=this._getLatLngOnCircle(y,S);this._outerMarker.setLatLng(I),this._centerMarker.setLatLng(y),this._syncHintLine(),this._updateHiddenPolyCircle()},_resizeCircle(){this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker()),this._syncHintLine(),this._syncCircleRadius()},_syncCircleRadius(){let y=this._centerMarker.getLatLng(),S=this._outerMarker.getLatLng(),I=this._distanceCalculation(y,S);this.options[this._minRadiusOption]&&I<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&I>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(I),this._updateHiddenPolyCircle(),this._fireChange(this._layer.getLatLng(),"Edit")},_syncHintLine(){let y=this._centerMarker.getLatLng(),S=this._outerMarker.getLatLng();this._hintline.setLatLngs([y,S])},_removeMarker(){this.options[this._editableOption]&&this.disable(),this._layer.remove(),this._fireRemove(this._layer),this._fireRemove(this._map,this._layer)},_onDragStart(){this._map.pm.Draw.CircleMarker._layerIsDragging=!0},_onMarkerDragStart(y){this._vertexValidation("move",y)&&this._fireMarkerDragStart(y)},_onMarkerDrag(y){let S=y.target;S instanceof L.Marker&&!this._vertexValidationDrag(S)||this._fireMarkerDrag(y)},_onMarkerDragEnd(y){this._extedingMarkerDragEnd();let S=y.target;this._vertexValidationDragEnd(S)&&(this.options[this._editableOption]&&(this._fireEdit(),this._layerEdited=!0),this._fireMarkerDragEnd(y))},_extedingMarkerDragEnd(){this._map.pm.Draw.CircleMarker._layerIsDragging=!1},_initSnappableMarkersDrag(){let y=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,y.off("pm:drag",this._handleSnapping,this),y.on("pm:drag",this._handleSnapping,this),y.off("pm:dragend",this._cleanupSnapping,this),y.on("pm:dragend",this._cleanupSnapping,this),y.off("pm:dragstart",this._unsnap,this),y.on("pm:dragstart",this._unsnap,this)},_disableSnappingDrag(){let y=this._layer;y.off("pm:drag",this._handleSnapping,this),y.off("pm:dragend",this._cleanupSnapping,this),y.off("pm:dragstart",this._unsnap,this)},_updateHiddenPolyCircle(){let y=this._layer._map||this._map;if(y){let S=L.PM.Utils.pxRadiusToMeterRadius(this._layer.getRadius(),y,this._layer.getLatLng()),I=L.circle(this._layer.getLatLng(),this._layer.options);I.setRadius(S);let F=y&&y.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(I,200,!F).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(I,200,!F),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)}},_getNewDestinationOfOuterMarker(){let y=this._centerMarker.getLatLng(),S=this._outerMarker.getLatLng(),I=this._distanceCalculation(y,S);return this.options[this._minRadiusOption]&&I<this.options[this._minRadiusOption]?S=vs(this._map,y,S,this._getMinDistanceInMeter(y)):this.options[this._maxRadiusOption]&&I>this.options[this._maxRadiusOption]&&(S=vs(this._map,y,S,this._getMaxDistanceInMeter(y))),S},_handleOuterMarkerSnapping(){if(this._outerMarker._snapped){let y=this._centerMarker.getLatLng(),S=this._outerMarker.getLatLng(),I=this._distanceCalculation(y,S);this.options[this._minRadiusOption]&&I<this.options[this._minRadiusOption]?this._outerMarker.setLatLng(this._outerMarker._orgLatLng):this.options[this._maxRadiusOption]&&I>this.options[this._maxRadiusOption]&&this._outerMarker.setLatLng(this._outerMarker._orgLatLng)}this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker())},_distanceCalculation(y,S){return this._map.project(y).distanceTo(this._map.project(S))},_getMinDistanceInMeter(y){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,y)},_getMaxDistanceInMeter(y){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,y)},_onVertexClick(y){y.target._dragging||this._fireVertexClick(y,void 0)}}),ur.Circle=ur.CircleMarker.extend({_shape:"Circle",initialize(y){this._layer=y,this._enabled=!1,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizeableCircle",this._updateHiddenPolyCircle()},enable(y){L.PM.Edit.CircleMarker.prototype.enable.call(this,y||{})},_extendingEnable(){},_extendingDisable(){this._layer.off("remove",this.disable,this);let y=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(y,"leaflet-pm-draggable")},_extendingApplyOptions(){},_syncMarkers(){},_removeMarker(){},_onDragStart(){},_extedingMarkerDragEnd(){},_updateHiddenPolyCircle(){let y=this._map&&this._map.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(this._layer,200,!y).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(this._layer,200,!y),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)},_distanceCalculation(y,S){return this._map.distance(y,S)},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_onVertexClick(y){y.target._dragging||this._fireVertexClick(y,void 0)}}),ur.ImageOverlay=ur.extend({_shape:"ImageOverlay",initialize(y){this._layer=y,this._enabled=!1},toggleEdit(y){this.enabled()?this.disable():this.enable(y)},enabled(){return this._enabled},enable(y={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,y),this._map=this._layer._map,!!this._map){if(!this.options.allowEditing){this.disable();return}this.enabled()||this.disable(),this.enableLayerDrag(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._otherSnapLayers=this._findCorners(),this._fireEnable()}},disable(){this._dragging||(this._map||(this._map=this._layer._map),this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this.enabled()||(this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()),this._enabled=!1)},_findCorners(){let y=this._layer.getBounds(),S=y.getNorthWest(),I=y.getNorthEast(),F=y.getSouthEast(),G=y.getSouthWest();return[S,I,F,G]}}),ur.Text=ur.extend({_shape:"Text",initialize(y){this._layer=y,this._enabled=!1},enable(y){if(L.Util.setOptions(this,y),!!this.textArea){if(!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._safeToCacheDragState=!0,this._focusChange(),this.textArea.readOnly=!1,this.textArea.classList.remove("pm-disabled"),this._layer.on("remove",this.disable,this),L.DomEvent.on(this.textArea,"input",this._autoResize,this),L.DomEvent.on(this.textArea,"focus",this._focusChange,this),L.DomEvent.on(this.textArea,"blur",this._focusChange,this),this._layer.on("dblclick",L.DomEvent.stop),L.DomEvent.off(this.textArea,"mousedown",this._preventTextSelection),this._enabled=!0,this._fireEnable()}},disable(){if(!this.enabled())return;this._layer.off("remove",this.disable,this),L.DomEvent.off(this.textArea,"input",this._autoResize,this),L.DomEvent.off(this.textArea,"focus",this._focusChange,this),L.DomEvent.off(this.textArea,"blur",this._focusChange,this),L.DomEvent.off(document,"click",this._documentClick,this),this._focusChange(),this.textArea.readOnly=!0,this.textArea.classList.add("pm-disabled");let y=document.activeElement;this.textArea.focus(),this.textArea.selectionStart=0,this.textArea.selectionEnd=0,L.DomEvent.on(this.textArea,"mousedown",this._preventTextSelection),y.focus(),this._disableOnBlurActive=!1,this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1},enabled(){return this._enabled},toggleEdit(y){this.enabled()?this.disable():this.enable(y)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initSnappableMarkers(){let y=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,y.off("pm:drag",this._handleSnapping,this),y.on("pm:drag",this._handleSnapping,this),y.off("pm:dragend",this._cleanupSnapping,this),y.on("pm:dragend",this._cleanupSnapping,this),y.off("pm:dragstart",this._unsnap,this),y.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let y=this._layer;y.off("pm:drag",this._handleSnapping,this),y.off("pm:dragend",this._cleanupSnapping,this),y.off("pm:dragstart",this._unsnap,this)},_autoResize(){this.textArea.style.height="1px",this.textArea.style.width="1px";let y=this.textArea.scrollHeight>21?this.textArea.scrollHeight:21,S=this.textArea.scrollWidth>16?this.textArea.scrollWidth:16;this.textArea.style.height=`${y}px`,this.textArea.style.width=`${S}px`,this._layer.options.text=this.getText(),this._fireTextChange(this.getText())},_disableOnBlur(){this._disableOnBlurActive=!0,setTimeout(()=>{this.enabled()&&L.DomEvent.on(document,"click",this._documentClick,this)},100)},_documentClick(y){y.target!==this.textArea&&(this.disable(),!this.getText()&&this.options.removeIfEmpty&&this.remove())},_focusChange(y={}){let S=this._hasFocus;this._hasFocus=y.type==="focus",!S!=!this._hasFocus&&(this._hasFocus?(this._applyFocus(),this._focusText=this.getText(),this._fireTextFocus()):(this._removeFocus(),this._fireTextBlur(),this._focusText!==this.getText()&&(this._fireEdit(),this._layerEdited=!0)))},_applyFocus(){this.textArea.classList.add("pm-hasfocus"),this._map.dragging&&(this._safeToCacheDragState&&(this._originalMapDragState=this._map.dragging._enabled,this._safeToCacheDragState=!1),this._map.dragging.disable())},_removeFocus(){this._map.dragging&&(this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0),this.textArea.classList.remove("pm-hasfocus")},focus(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.focus()},blur(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.blur(),this._disableOnBlurActive&&this.disable()},hasFocus(){return this._hasFocus},getElement(){return this.textArea},setText(y){y&&(this.textArea.value=y),this._autoResize()},getText(){return this.textArea.value},_initTextMarker(){if(this.textArea=L.PM.Draw.Text.prototype._createTextArea.call(this),this.options.className){let S=this.options.className.split(" ");this.textArea.classList.add(...S)}let y=L.PM.Draw.Text.prototype._createTextIcon.call(this,this.textArea);this._layer.setIcon(y),this._layer.once("add",this._createTextMarker,this)},_createTextMarker(y=!1){this._layer.off("add",this._createTextMarker,this),this._layer.getElement().tabIndex=-1,this.textArea.wrap="off",this.textArea.style.overflow="hidden",this.textArea.style.height=L.DomUtil.getStyle(this.textArea,"font-size"),this.textArea.style.width="1px",this._layer.options.text&&this.setText(this._layer.options.text),this._autoResize(),y===!0&&(this.enable(),this.focus(),this._disableOnBlur())},_preventTextSelection(y){y.preventDefault()}});var fr=function(y,S,I,F,G,te){this._matrix=[y,S,I,F,G,te]};fr.init=()=>new L.PM.Matrix(1,0,0,1,0,0),fr.prototype={transform(y){return this._transform(y.clone())},_transform(y){let S=this._matrix,{x:I,y:F}=y;return y.x=S[0]*I+S[1]*F+S[4],y.y=S[2]*I+S[3]*F+S[5],y},untransform(y){let S=this._matrix;return new L.Point((y.x/S[0]-S[4])/S[0],(y.y/S[2]-S[5])/S[2])},clone(){let y=this._matrix;return new L.PM.Matrix(y[0],y[1],y[2],y[3],y[4],y[5])},translate(y){if(y===void 0)return new L.Point(this._matrix[4],this._matrix[5]);let S,I;return typeof y=="number"?(S=y,I=y):(S=y.x,I=y.y),this._add(1,0,0,1,S,I)},scale(y,S){if(y===void 0)return new L.Point(this._matrix[0],this._matrix[3]);let I,F;return S=S||L.point(0,0),typeof y=="number"?(I=y,F=y):(I=y.x,F=y.y),this._add(I,0,0,F,S.x,S.y)._add(1,0,0,1,-S.x,-S.y)},rotate(y,S){let I=Math.cos(y),F=Math.sin(y);return S=S||new L.Point(0,0),this._add(I,F,-F,I,S.x,S.y)._add(1,0,0,1,-S.x,-S.y)},flip(){return this._matrix[1]*=-1,this._matrix[2]*=-1,this},_add(y,S,I,F,G,te){let pe=[[],[],[]],xe=this._matrix,Fe=[[xe[0],xe[2],xe[4]],[xe[1],xe[3],xe[5]],[0,0,1]],tt=[[y,I,G],[S,F,te],[0,0,1]],zt;y&&y instanceof L.PM.Matrix&&(xe=y._matrix,tt=[[xe[0],xe[2],xe[4]],[xe[1],xe[3],xe[5]],[0,0,1]]);for(let bt=0;bt<3;bt+=1)for(let dn=0;dn<3;dn+=1){zt=0;for(let zn=0;zn<3;zn+=1)zt+=Fe[bt][zn]*tt[zn][dn];pe[bt][dn]=zt}return this._matrix=[pe[0][0],pe[1][0],pe[0][1],pe[1][1],pe[0][2],pe[1][2]],this}};var Cr=fr,gr={calcMiddleLatLng(y,S,I){let F=y.project(S),G=y.project(I);return y.unproject(F._add(G)._divideBy(2))},findLayers(y){let S=[];return y.eachLayer(I=>{(I instanceof L.Polyline||I instanceof L.Marker||I instanceof L.Circle||I instanceof L.CircleMarker||I instanceof L.ImageOverlay)&&S.push(I)}),S=S.filter(I=>!!I.pm),S=S.filter(I=>!I._pmTempLayer),S=S.filter(I=>!L.PM.optIn&&!I.options.pmIgnore||L.PM.optIn&&I.options.pmIgnore===!1),S},circleToPolygon(y,S=60,I=!0){let F=y.getLatLng(),G=y.getRadius(),te=Fs(F,G,S,0,I),pe=[];for(let xe=0;xe<te.length;xe+=1){let Fe=[te[xe].lat,te[xe].lng];pe.push(Fe)}return L.polygon(pe,y.options)},disablePopup(y){y.getPopup()&&(y._tempPopupCopy=y.getPopup(),y.unbindPopup())},enablePopup(y){y._tempPopupCopy&&(y.bindPopup(y._tempPopupCopy),delete y._tempPopupCopy)},_fireEvent(y,S,I,F=!1){y.fire(S,I,F);let{groups:G}=this.getAllParentGroups(y);G.forEach(te=>{te.fire(S,I,F)})},getAllParentGroups(y){let S=[],I=[],F=G=>{for(let te in G._eventParents)if(S.indexOf(te)===-1){S.push(te);let pe=G._eventParents[te];I.push(pe),F(pe)}};return!y._pmLastGroupFetch||!y._pmLastGroupFetch.time||new Date().getTime()-y._pmLastGroupFetch.time>1e3?(F(y),y._pmLastGroupFetch={time:new Date().getTime(),groups:I,groupIds:S},{groupIds:S,groups:I}):{groups:y._pmLastGroupFetch.groups,groupIds:y._pmLastGroupFetch.groupIds}},createGeodesicPolygon:Fs,getTranslation:di,findDeepCoordIndex(y,S,I=!0){let F,G=pe=>(xe,Fe)=>{let tt=pe.concat(Fe);if(I){if(xe.lat&&xe.lat===S.lat&&xe.lng===S.lng)return F=tt,!0}else if(xe.lat&&L.latLng(xe).equals(S))return F=tt,!0;return Array.isArray(xe)&&xe.some(G(tt))};y.some(G([]));let te={};return F&&(te={indexPath:F,index:F[F.length-1],parentPath:F.slice(0,F.length-1)}),te},findDeepMarkerIndex(y,S){let I,F=te=>(pe,xe)=>{let Fe=te.concat(xe);return pe._leaflet_id===S._leaflet_id?(I=Fe,!0):Array.isArray(pe)&&pe.some(F(Fe))};y.some(F([]));let G={};return I&&(G={indexPath:I,index:I[I.length-1],parentPath:I.slice(0,I.length-1)}),G},_getIndexFromSegment(y,S){if(S&&S.length===2){let I=this.findDeepCoordIndex(y,S[0]),F=this.findDeepCoordIndex(y,S[1]),G=Math.max(I.index,F.index);return(I.index===0||F.index===0)&&G!==1&&(G+=1),{indexA:I,indexB:F,newIndex:G,indexPath:I.indexPath,parentPath:I.parentPath}}return null},_getRotatedRectangle(y,S,I,F){let G=kt(F,y),te=kt(F,S),pe=I*Math.PI/180,xe=Math.cos(pe),Fe=Math.sin(pe),tt=(te.x-G.x)*xe+(te.y-G.y)*Fe,zt=(te.y-G.y)*xe-(te.x-G.x)*Fe,bt=tt*xe+G.x,dn=tt*Fe+G.y,zn=-zt*Fe+G.x,hr=zt*xe+G.y,Ir=_n(F,G),Br=_n(F,{x:bt,y:dn}),ci=_n(F,te),Nt=_n(F,{x:zn,y:hr});return[Ir,Br,ci,Nt]},pxRadiusToMeterRadius(y,S,I){let F=S.project(I),G=L.point(F.x+y,F.y);return S.distance(S.unproject(G),I)}},qr=gr;L.PM=L.PM||{version:Ju.version,Map:Po,Toolbar:Jo,Draw:uo,Edit:ur,Utils:qr,Matrix:Cr,activeLang:"en",optIn:!1,initialize(y){this.addInitHooks(y)},setOptIn(y){this.optIn=!!y},addInitHooks(){function y(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Map(this)):this.options.pmIgnore||(this.pm=new L.PM.Map(this)),this.pm&&this.pm.setGlobalOptions({})}L.Map.addInitHook(y);function S(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.LayerGroup(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.LayerGroup(this))}L.LayerGroup.addInitHook(S);function I(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this)):this.options.pmIgnore||(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this))}L.Marker.addInitHook(I);function F(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.CircleMarker(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.CircleMarker(this))}L.CircleMarker.addInitHook(F);function G(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Line(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Line(this))}L.Polyline.addInitHook(G);function te(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Polygon(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Polygon(this))}L.Polygon.addInitHook(te);function pe(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Rectangle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Rectangle(this))}L.Rectangle.addInitHook(pe);function xe(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Circle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Circle(this))}L.Circle.addInitHook(xe);function Fe(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.ImageOverlay(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.ImageOverlay(this))}L.ImageOverlay.addInitHook(Fe)},reInitLayer(y){y instanceof L.LayerGroup&&y.eachLayer(S=>{this.reInitLayer(S)}),y.pm||L.PM.optIn&&y.options.pmIgnore!==!1||y.options.pmIgnore||(y instanceof L.Map?y.pm=new L.PM.Map(y):y instanceof L.Marker?y.options.textMarker?(y.pm=new L.PM.Edit.Text(y),y.pm._initTextMarker(),y.pm._createTextMarker(!1)):y.pm=new L.PM.Edit.Marker(y):y instanceof L.Circle?y.pm=new L.PM.Edit.Circle(y):y instanceof L.CircleMarker?y.pm=new L.PM.Edit.CircleMarker(y):y instanceof L.Rectangle?y.pm=new L.PM.Edit.Rectangle(y):y instanceof L.Polygon?y.pm=new L.PM.Edit.Polygon(y):y instanceof L.Polyline?y.pm=new L.PM.Edit.Line(y):y instanceof L.LayerGroup?y.pm=new L.PM.Edit.LayerGroup(y):y instanceof L.ImageOverlay&&(y.pm=new L.PM.Edit.ImageOverlay(y)))}},L.version==="1.7.1"&&L.Canvas.include({_onClick(y){let S=this._map.mouseEventToLayerPoint(y),I,F;for(let G=this._drawFirst;G;G=G.next)I=G.layer,I.options.interactive&&I._containsPoint(S)&&(!(y.type==="click"||y.type==="preclick")||!this._map._draggableMoved(I))&&(F=I);F&&(L.DomEvent.fakeStop(y),this._fireEvent([F],y))}}),L.PM.initialize()})();var s$={exports:{}};(function(e){(function(t){var n;n=jr,e.exports=t(n)})(function(t){return t.Polyline._flat=t.LineUtil.isFlat||t.Polyline._flat||function(n){return!t.Util.isArray(n[0])||typeof n[0][0]!="object"&&typeof n[0][0]<"u"},t.GeometryUtil=t.extend(t.GeometryUtil||{},{distance:function(n,r,i){return n.latLngToLayerPoint(r).distanceTo(n.latLngToLayerPoint(i))},distanceSegment:function(n,r,i,l){var a=n.latLngToLayerPoint(r),o=n.latLngToLayerPoint(i),f=n.latLngToLayerPoint(l);return t.LineUtil.pointToSegmentDistance(a,o,f)},readableDistance:function(n,r){var i=r!=="imperial",l;return i?n>1e3?l=(n/1e3).toFixed(2)+" km":l=n.toFixed(1)+" m":(n*=1.09361,n>1760?l=(n/1760).toFixed(2)+" miles":l=n.toFixed(1)+" yd"),l},belongsSegment:function(n,r,i,l){l=l===void 0?.2:l;var a=r.distanceTo(i),o=r.distanceTo(n)+n.distanceTo(i)-a;return o/a<l},length:function(n){var r=t.GeometryUtil.accumulatedLengths(n);return r.length>0?r[r.length-1]:0},accumulatedLengths:function(n){if(typeof n.getLatLngs=="function"&&(n=n.getLatLngs()),n.length===0)return[];for(var r=0,i=[0],l=0,a=n.length-1;l<a;l++)r+=n[l].distanceTo(n[l+1]),i.push(r);return i},closestOnSegment:function(n,r,i,l){var a=n.getMaxZoom();a===1/0&&(a=n.getZoom());var o=n.project(r,a),f=n.project(i,a),m=n.project(l,a),_=t.LineUtil.closestPointOnSegment(o,f,m);return n.unproject(_,a)},closestOnCircle:function(n,r){const i=n.getLatLng(),l=n.getRadius(),a=typeof l=="number"?l:l.radius,o=r.lng,f=r.lat,m=i.lng,_=i.lat,w=o-m,M=f-_,C=Math.sqrt(w*w+M*M),R=m+w/C*a,z=_+M/C*a;return new t.LatLng(z,R)},closest:function(n,r,i,l){var a,o=1/0,f=null,m,_,w,M;if(r instanceof Array)if(r[0]instanceof Array&&typeof r[0][0]!="number"){for(m=0;m<r.length;m++)M=t.GeometryUtil.closest(n,r[m],i,l),M&&M.distance<o&&(o=M.distance,f=M);return f}else if(r[0]instanceof t.LatLng||typeof r[0][0]=="number"||typeof r[0].lat=="number")r=t.polyline(r);else return f;if(!(r instanceof t.Polyline))return f;if(a=JSON.parse(JSON.stringify(r.getLatLngs().slice(0))),r instanceof t.Polygon){var C=function(X){if(t.Polyline._flat(X))X.push(X[0]);else for(var Y=0;Y<X.length;Y++)C(X[Y])};C(a)}if(t.Polyline._flat(a)){if(l){for(m=0,_=a.length;m<_;m++){var R=a[m];w=t.GeometryUtil.distance(n,i,R),w<o&&(o=w,f=R,f.distance=w)}return f}for(m=0,_=a.length;m<_-1;m++){var z=a[m],W=a[m+1];w=t.GeometryUtil.distanceSegment(n,i,z,W),w<=o&&(o=w,f=t.GeometryUtil.closestOnSegment(n,i,z,W),f.distance=w)}return f}else{for(m=0;m<a.length;m++)M=t.GeometryUtil.closest(n,a[m],i,l),M.distance<o&&(o=M.distance,f=M);return f}},closestLayer:function(n,r,i){for(var l=1/0,a=null,o=null,f=1/0,m=0,_=r.length;m<_;m++){var w=r[m];if(w instanceof t.LayerGroup){var M=t.GeometryUtil.closestLayer(n,w.getLayers(),i);M.distance<l&&(l=M.distance,a=M)}else w instanceof t.Circle?(o=this.closestOnCircle(w,i),f=t.GeometryUtil.distance(n,i,o)):typeof w.getLatLng=="function"?(o=w.getLatLng(),f=t.GeometryUtil.distance(n,i,o)):(o=t.GeometryUtil.closest(n,w,i),o&&(f=o.distance)),f<l&&(l=f,a={layer:w,latlng:o,distance:f})}return a},nClosestLayers:function(n,r,i,l){if(l=typeof l=="number"?l:r.length,l<1||r.length<1)return null;for(var a=[],o,f,m=0,_=r.length;m<_;m++){var w=r[m];if(w instanceof t.LayerGroup){var M=t.GeometryUtil.closestLayer(n,w.getLayers(),i);a.push(M)}else w instanceof t.Circle?(f=this.closestOnCircle(w,i),o=t.GeometryUtil.distance(n,i,f)):typeof w.getLatLng=="function"?(f=w.getLatLng(),o=t.GeometryUtil.distance(n,i,f)):(f=t.GeometryUtil.closest(n,w,i),f&&(o=f.distance)),a.push({layer:w,latlng:f,distance:o})}return a.sort(function(C,R){return C.distance-R.distance}),a.length>l?a.slice(0,l):a},layersWithin:function(n,r,i,l){l=typeof l=="number"?l:1/0;for(var a=[],o=null,f=0,m=0,_=r.length;m<_;m++){var w=r[m];typeof w.getLatLng=="function"?(o=w.getLatLng(),f=t.GeometryUtil.distance(n,i,o)):(o=t.GeometryUtil.closest(n,w,i),o&&(f=o.distance)),o&&f<l&&a.push({layer:w,latlng:o,distance:f})}var M=a.sort(function(C,R){return C.distance-R.distance});return M},closestLayerSnap:function(n,r,i,l,a){l=typeof l=="number"?l:1/0,a=typeof a=="boolean"?a:!0;var o=t.GeometryUtil.closestLayer(n,r,i);if(!o||o.distance>l)return null;if(a&&typeof o.layer.getLatLngs=="function"){var f=t.GeometryUtil.closest(n,o.layer,o.latlng,!0);f.distance<l&&(o.latlng=f,o.distance=t.GeometryUtil.distance(n,f,i))}return o},interpolateOnPointSegment:function(n,r,i){return t.point(n.x*(1-i)+i*r.x,n.y*(1-i)+i*r.y)},interpolateOnLine:function(n,r,i){r=r instanceof t.Polyline?r.getLatLngs():r;var l=r.length;if(l<2)return null;if(i=Math.max(Math.min(i,1),0),i===0)return{latLng:r[0]instanceof t.LatLng?r[0]:t.latLng(r[0]),predecessor:-1};if(i==1)return{latLng:r[r.length-1]instanceof t.LatLng?r[r.length-1]:t.latLng(r[r.length-1]),predecessor:r.length-2};var a=n.getMaxZoom();a===1/0&&(a=n.getZoom());for(var o=[],f=0,m=0;m<l;m++)o[m]=n.project(r[m],a),m>0&&(f+=o[m-1].distanceTo(o[m]));for(var _=f*i,w=0,M=0,m=0;M<_;m++){var C=o[m],R=o[m+1];w=M,M+=C.distanceTo(R)}if(C==null&&R==null)var C=o[0],R=o[1],m=1;var z=M-w!==0?(_-w)/(M-w):0,W=t.GeometryUtil.interpolateOnPointSegment(C,R,z);return{latLng:n.unproject(W,a),predecessor:m-1}},locateOnLine:function(n,r,i){var l=r.getLatLngs();if(i.equals(l[0]))return 0;if(i.equals(l[l.length-1]))return 1;for(var a=t.GeometryUtil.closest(n,r,i,!1),o=t.GeometryUtil.accumulatedLengths(l),f=o[o.length-1],m=0,_=!1,w=0,M=l.length-1;w<M;w++){var C=l[w],R=l[w+1];if(m=o[w],t.GeometryUtil.belongsSegment(a,C,R,.001)){m+=C.distanceTo(a),_=!0;break}}if(!_)throw"Could not interpolate "+i.toString()+" within "+r.toString();return m/f},reverse:function(n){return t.polyline(n.getLatLngs().slice(0).reverse())},extract:function(n,r,i,l){if(i>l)return t.GeometryUtil.extract(n,t.GeometryUtil.reverse(r),1-i,1-l);i=Math.max(Math.min(i,1),0),l=Math.max(Math.min(l,1),0);var a=r.getLatLngs(),o=t.GeometryUtil.interpolateOnLine(n,r,i),f=t.GeometryUtil.interpolateOnLine(n,r,l);if(i==l){var m=t.GeometryUtil.interpolateOnLine(n,r,l);return[m.latLng]}o.predecessor==-1&&(o.predecessor=0),f.predecessor==-1&&(f.predecessor=0);var _=a.slice(o.predecessor+1,f.predecessor+1);return _.unshift(o.latLng),_.push(f.latLng),_},isBefore:function(n,r){if(!r)return!1;var i=n.getLatLngs(),l=r.getLatLngs();return i[i.length-1].equals(l[0])},isAfter:function(n,r){if(!r)return!1;var i=n.getLatLngs(),l=r.getLatLngs();return i[0].equals(l[l.length-1])},startsAtExtremity:function(n,r){if(!r)return!1;var i=n.getLatLngs(),l=r.getLatLngs(),a=i[0];return a.equals(l[0])||a.equals(l[l.length-1])},computeAngle:function(n,r){return Math.atan2(r.y-n.y,r.x-n.x)*180/Math.PI},computeSlope:function(n,r){var i=(r.y-n.y)/(r.x-n.x),l=n.y-i*n.x;return{a:i,b:l}},rotatePoint:function(n,r,i,l){var a=n.getMaxZoom();a===1/0&&(a=n.getZoom());var o=i*Math.PI/180,f=n.project(r,a),m=n.project(l,a),_=Math.cos(o)*(f.x-m.x)-Math.sin(o)*(f.y-m.y)+m.x,w=Math.sin(o)*(f.x-m.x)+Math.cos(o)*(f.y-m.y)+m.y;return n.unproject(new t.Point(_,w),a)},bearing:function(n,r){var i=Math.PI/180,l=n.lat*i,a=r.lat*i,o=n.lng*i,f=r.lng*i,m=Math.sin(f-o)*Math.cos(a),_=Math.cos(l)*Math.sin(a)-Math.sin(l)*Math.cos(a)*Math.cos(f-o),w=(Math.atan2(m,_)*180/Math.PI+360)%360;return w>=180?w-360:w},destination:function(n,r,i){r=(r+360)%360;var l=Math.PI/180,a=180/Math.PI,o=t.CRS.Earth.R,f=n.lng*l,m=n.lat*l,_=r*l,w=Math.sin(m),M=Math.cos(m),C=Math.cos(i/o),R=Math.sin(i/o),z=Math.asin(w*C+M*R*Math.cos(_)),W=f+Math.atan2(Math.sin(_)*R*M,C-w*Math.sin(z));return W=W*a,W=W>180?W-360:W<-180?W+360:W,t.latLng([z*a,W])},angle:function(n,r,i){var l=n.latLngToContainerPoint(r),a=n.latLngToContainerPoint(i),o=Math.atan2(a.y-l.y,a.x-l.x)*180/Math.PI+90;return o+=o<0?360:0,o},destinationOnSegment:function(n,r,i,l){var a=t.GeometryUtil.angle(n,r,i),o=t.GeometryUtil.destination(r,a,l);return t.GeometryUtil.closestOnSegment(n,o,r,i)}}),t.GeometryUtil})})(s$);L.Map.mergeOptions({almostOver:!0,almostDistance:25,almostSamplingPeriod:50,almostOnMouseMove:!0});L.Handler.AlmostOver=L.Handler.extend({includes:L.Evented||L.Mixin.Events,initialize:function(e){this._map=e,this._layers=[],this._previous=null,this._marker=null,this._buffer=0,this.__mouseMoveSampling=function(){var t=new Date;return function(n){var r=new Date,i=r-t<this._map.options.almostSamplingPeriod;i||this._layers.length===0||(t=r,this._map.fire("mousemovesample",{latlng:n.latlng}))}}()},addHooks:function(){this._map.options.almostOnMouseMove&&(this._map.on("mousemove",this.__mouseMoveSampling,this),this._map.on("mousemovesample",this._onMouseMove,this)),this._map.on("click dblclick",this._onMouseClick,this),this._map;function e(){this._buffer=this._map.layerPointToLatLng([0,0]).lat-this._map.layerPointToLatLng([this._map.options.almostDistance,this._map.options.almostDistance]).lat}this._map.on("viewreset zoomend",e,this),this._map.whenReady(e,this)},removeHooks:function(){this._map.off("mousemovesample"),this._map.off("mousemove",this.__mouseMoveSampling,this),this._map.off("click dblclick",this._onMouseClick,this)},addLayer:function(e){typeof e.eachLayer=="function"?e.eachLayer(function(t){this.addLayer(t)},this):(typeof this.indexLayer=="function"&&this.indexLayer(e),this._layers.push(e))},removeLayer:function(e){if(typeof e.eachLayer=="function")e.eachLayer(function(n){this.removeLayer(n)},this);else{typeof this.unindexLayer=="function"&&this.unindexLayer(e);var t=this._layers.indexOf(e);0<=t&&this._layers.splice(t,1)}this._previous=null},getClosest:function(e){var t=L.GeometryUtil.closestLayerSnap,n=this._map.options.almostDistance,r=[];return typeof this.searchBuffer=="function"?r=this.searchBuffer(e,this._buffer):r=this._layers,t(this._map,r,e,n,!1)},_onMouseMove:function(e){var t=this.getClosest(e.latlng);t?(this._previous?L.stamp(this._previous.layer)!=L.stamp(t.layer)&&(this._map.fire("almost:out",{layer:this._previous.layer}),this._map.fire("almost:over",{layer:t.layer,latlng:t.latlng})):this._map.fire("almost:over",{layer:t.layer,latlng:t.latlng}),this._map.fire("almost:move",{layer:t.layer,latlng:t.latlng})):this._previous&&this._map.fire("almost:out",{layer:this._previous.layer}),this._previous=t},_onMouseClick:function(e){var t=this.getClosest(e.latlng);t&&this._map.fire("almost:"+e.type,{layer:t.layer,latlng:t.latlng})}});L.LayerIndexMixin!==void 0&&L.Handler.AlmostOver.include(L.LayerIndexMixin);L.Map.addInitHook("addHandler","almostOver",L.Handler.AlmostOver);var o$=ck,a$=wC,l$="Expected a function";function u$(e,t,n){var r=!0,i=!0;if(typeof e!="function")throw new TypeError(l$);return a$(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),o$(e,t,{leading:r,maxWait:t,trailing:i})}var c$=u$;const u0=Mg(c$),Oh=e=>{document.querySelectorAll(".drawing-help-message").forEach(r=>r.remove());const n=jr.DomUtil.create("div","drawing-help-message");return n.innerHTML=e,n.style.cssText=`
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 8px 16px;
    border-radius: 4px;
    font-size: 14px;
    z-index: 2000;
    pointer-events: none;
    text-align: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  `,document.body.appendChild(n),n},Hc=(e,t="m",n="")=>{let r,i;return t==="m²"?e>=1e4?(r=(e/1e4).toFixed(2),i="ha"):(r=e.toFixed(2),i="m²"):t==="m"?e>=1e3?(r=(e/1e3).toFixed(2),i="km"):(r=e.toFixed(2),i="m"):(r=e.toFixed(2),i=t),n?`${n}: ${r} ${i}`:`${r} ${i}`};function h$(){const e=Rn(null),t=Rn(null),n=Rn(null),r=Rn(null),i=Rn(""),l=Rn(null),a=Rn(!1);Rn(null);const o=()=>{l.value=null,n.value&&n.value.clearLayers(),r.value&&r.value.clearLayers(),document.querySelectorAll(".measure-tooltip").forEach(ae=>ae.remove()),document.querySelectorAll(".drawing-help-message").forEach(ae=>ae.remove())};window.addEventListener("clearControlPoints",o),gd(()=>{window.removeEventListener("clearControlPoints",o),e.value&&(e.value.remove(),e.value=null)});const f=(ae,ne)=>{const Se=jr.DomUtil.create("div","measure-tooltip");if(Se.innerHTML=ne,Se.style.cssText=`
      position: fixed;
      background-color: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      z-index: 2000;
      pointer-events: none;
      white-space: pre-line;
    `,document.body.appendChild(Se),e.value){const Le=e.value.latLngToContainerPoint(ae);Se.style.left=`${Le.x+10}px`,Se.style.top=`${Le.y-25}px`}return Se},m=u0((ae,ne,Se)=>{if(ae&&(ae.innerHTML=Se,e.value)){const Le=e.value.latLngToContainerPoint(ne);ae.style.left=`${Le.x+10}px`,ae.style.top=`${Le.y-25}px`}},100),_=(ae,ne,Se)=>{ae.on("mouseover",()=>{const Le=f(ae.getLatLng(),Se());ae.measureDiv=Le}),ae.on("mousemove",Le=>{ae.measureDiv&&e.value&&m(ae.measureDiv,Le.latlng,Se())}),ae.on("mouseout",()=>{ae.measureDiv&&(ae.measureDiv.remove(),ae.measureDiv=void 0)})};let w=[];const M=()=>{var ae;w.cleanup&&w.cleanup(),n.value&&n.value.clearLayers(),w=[],(ae=r.value)==null||ae.clearLayers(),document.querySelectorAll(".measure-tooltip").forEach(ne=>ne.remove())},C=(ae,ne="#2563EB")=>{const Se=typeof window<"u"&&window.innerWidth<768,Le=jr.circleMarker(ae,{radius:Se?14:6,color:ne,fillColor:ne,fillOpacity:1,weight:2,className:"control-point",pmIgnore:!0});return n.value&&n.value.addLayer(Le),Le},R=(ae,ne)=>{var Le,ze,He,pt,ge,Ie;const Se={type:ne,style:ae.options||{}};try{if(ae instanceof jr.Polygon)try{const Ve=ae.getLatLngs()[0].map(lt=>[lt.lng,lt.lat]);Ve.push(Ve[0]);const it=em([Ve]);Se.surface=av(it),Se.perimeter=sj(w_(Ve),{units:"meters"})}catch(Ne){console.warn("Erreur lors du calcul des propriétés du polygone:",Ne),Se.surface=0,Se.perimeter=0}else if(ae instanceof jr.Polyline&&!(ae instanceof jr.Polygon))try{const Ne=ae.getLatLngs();let Ve=0;for(let it=1;it<Ne.length;it++)Ve+=Ne[it].distanceTo(Ne[it-1]);Se.length=Ve}catch(Ne){console.warn("Erreur lors du calcul de la longueur de la ligne:",Ne),Se.length=0}Se.style={...Se.style,color:((Le=ae.options)==null?void 0:Le.color)||"#3388ff",weight:((ze=ae.options)==null?void 0:ze.weight)||3,opacity:((He=ae.options)==null?void 0:He.opacity)||1,fillColor:((pt=ae.options)==null?void 0:pt.fillColor)||"#3388ff",fillOpacity:((ge=ae.options)==null?void 0:ge.fillOpacity)||.2,dashArray:((Ie=ae.options)==null?void 0:Ie.dashArray)||""}}catch(Ne){console.error("Erreur lors du calcul des propriétés de la forme:",Ne),Se.style=Se.style||{color:"#3388ff",weight:3,opacity:1,fillColor:"#3388ff",fillOpacity:.2,dashArray:""}}return Se},z=()=>{if(!e.value||!e.value.almostOver||!t.value)return;t.value.getLayers().filter(ne=>ne instanceof dl||ne instanceof jr.Polyline&&!(ne instanceof jr.Polygon)||ne instanceof Uh||ne instanceof bh).forEach(ne=>{var Se;(Se=e.value)==null||Se.almostOver.addLayer(ne)})},W=(ae,ne,Se)=>{const Le={almostOnMouseMove:!0,zoomAnimation:!0,fadeAnimation:!0,markerZoomAnimation:!0},ze=jr.map(ae,Le).setView(ne,Se);e.value=ze,jr.tileLayer("/osm_tiles/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:5}).addTo(ze);const He=new jr.FeatureGroup;return He.addTo(ze),t.value=He,ze.almostOver?ze.almostOver.options.tolerance=25:console.warn("Leaflet.AlmostOver plugin not loaded properly"),n.value=jr.featureGroup().addTo(ze),r.value=jr.featureGroup().addTo(ze),ze.pm.setGlobalOptions({snappable:!0,snapDistance:20,allowSelfIntersection:!1,preventMarkerRemoval:!0,syncLayersOnDrag:!0,layerGroup:He,snapLayers:[He,r.value],templineStyle:{color:"#3388ff",weight:2,opacity:.7,dashArray:"6,6",radius:6},hintlineStyle:{color:"#3388ff",weight:2,opacity:.7,dashArray:"6,6",radius:6}}),ze.whenReady(()=>{e.value&&e.value.almostOver&&t.value&&setTimeout(z,100)}),ze.on("pm:drawstart",pt=>{a.value=!0,pt.shape==="Circle"&&i.value==="Semicircle"&&(ze.getContainer().style.cursor="crosshair")}),ze.on("pm:drawend",()=>{a.value=!1,ze.getContainer().style.cursor="",l.value&&Oh("Cliquez sur la forme pour afficher les points de contrôle")}),ze.on("pm:create",de),He.on("click",pt=>{var Ie,Ne,Ve;jr.DomEvent.stopPropagation(pt);const ge=pt.layer;ge.name&&!((Ie=ge.properties)!=null&&Ie.name)?(ge.properties||(ge.properties={}),ge.properties.name=ge.name):(Ne=ge.properties)!=null&&Ne.name&&!ge.name&&(ge.name=ge.properties.name),(Ve=r.value)==null||Ve.clearLayers(),M(),l.value=ge,ge instanceof jr.Polygon?_e(ge):ge instanceof dl||ge instanceof jr.Polyline?ue(ge):ge instanceof bh&&We(ge)}),ze.on("pm:edit",pt=>{var Ie;const ge=pt.layer;if(ge){const Ne=((Ie=ge.properties)==null?void 0:Ie.type)||"unknown";me(ge,Ne),ge instanceof jr.Polygon?_e(ge):ge instanceof dl?(ge.updateProperties(),me(ge,"Line"),ue(ge)):ge instanceof jr.Polyline?ue(ge):ge instanceof bh&&(ge.updateProperties(),We(ge))}}),ze.on("pm:dragstart",()=>{document.querySelectorAll(".drawing-help-message").forEach(pt=>pt.remove()),Oh("Déplacez la forme à l'endroit souhaité")}),ze.on("pm:dragend",pt=>{var Ie;const ge=pt.layer;if(ge){const Ne=((Ie=ge.properties)==null?void 0:Ie.type)||"unknown";ge instanceof dl?(ge.updateProperties(),me(ge,"Line"),ue(ge)):me(ge,Ne)}setTimeout(()=>{Oh("Cliquez sur la forme pour afficher les points de contrôle")},100)}),ze.on("pm:remove",()=>{var pt;(pt=document.querySelector(".drawing-help-message"))==null||pt.remove()}),ze.on("pm:select",()=>{document.querySelectorAll(".drawing-help-message").forEach(pt=>pt.remove()),Oh("Utilisez les points de contrôle pour modifier la forme")}),ze.on("pm:unselect",()=>{document.querySelectorAll(".drawing-help-message").forEach(pt=>pt.remove())}),ze.on("zoomstart",()=>{l.value&&(M(),l.value=null,document.querySelectorAll(".drawing-help-message").forEach(pt=>pt.remove()))}),ze.on("almost:over",function(pt){const Ie=pt.layer;if(Ie){if(l.value===Ie)return;if(Ie instanceof dl){const Ne={...Ie.options};Ie._originalStyle=Ne;const Ve=Ne;Ie.setStyle({weight:(Ve.weight||3)+2,opacity:Math.min((Ve.opacity||1)+.2,1)}),document.querySelectorAll(".drawing-help-message").forEach(it=>it.remove()),Oh("Cliquez pour sélectionner cette ligne"),ze.getContainer()&&(ze.getContainer().style.cursor="pointer")}else if(Ie instanceof Uh){const Ne={...Ie.options};Ie._originalStyle=Ne,Ie.setStyle({weight:(Ne.weight||3)+2,opacity:Math.min((Ne.opacity||1)+.2,1),fillOpacity:Math.min((Ne.fillOpacity||.2)+.1,.4)}),document.querySelectorAll(".drawing-help-message").forEach(Ve=>Ve.remove()),Oh("Cliquez pour sélectionner ce polygone"),ze.getContainer()&&(ze.getContainer().style.cursor="pointer")}else if(Ie instanceof bh){const Ne=Ie.getElement();Ne&&(Ne.classList.add("geo-note-pulse"),Ne.style.zIndex="1000",Ne.style.visibility="visible",Ne.style.display="flex",Ne.style.opacity="1",Ne.style.filter="drop-shadow(0 0 5px rgba(59, 130, 246, 0.7))"),document.querySelectorAll(".drawing-help-message").forEach(Ve=>Ve.remove()),Oh("Cliquez pour sélectionner cette note"),ze.getContainer()&&(ze.getContainer().style.cursor="pointer")}}}),ze.on("almost:out",function(pt){const Ie=pt.layer;if(Ie){if(l.value===Ie)return;if(Ie instanceof dl&&Ie._originalStyle)Ie.setStyle(Ie._originalStyle),Ie._originalStyle=void 0;else if(Ie instanceof Uh)Ie._originalStyle&&(Ie.setStyle(Ie._originalStyle),Ie._originalStyle=void 0);else if(Ie instanceof bh){const Ne=Ie.getElement();Ne?(Ne.classList.remove("geo-note-pulse"),Ne.style.zIndex="",Ne.style.filter="none",Ne.style.opacity="1",Ne.style.display="block",Ne.style.visibility="visible",Array.from(Ne.querySelectorAll("*")).forEach(Ve=>{Ve.style.visibility="visible",Ve.style.display="block",Ve.style.opacity="1"}),setTimeout(()=>{try{const Ve=Ne.getBoundingClientRect();(Ve.width===0||Ve.height===0)&&(console.warn("[almost:out] L'élément a une taille nulle après sortie, recréation de l'icône"),Ie.recreateIcon())}catch(Ve){console.error("[almost:out] Erreur lors de la vérification de la taille:",Ve),Ie.recreateIcon()}},100)):(console.warn("[almost:out] Élément DOM introuvable, recréation de l'icône"),Ie.recreateIcon())}(!l.value||l.value&&l.value!==Ie)&&document.querySelectorAll(".drawing-help-message").forEach(Ne=>Ne.remove()),ze.getContainer()&&!document.querySelectorAll(".geo-note-pulse").length&&!document.querySelectorAll(".line-hover-effect").length&&(ze.getContainer().style.cursor="")}}),ze.on("almost:click",function(pt){var Ne,Ve;const Ie=pt.layer;Ie&&l.value===Ie||(l.value&&M(),Ie&&Ie instanceof dl?(l.value=Ie,(Ne=r.value)==null||Ne.clearLayers(),M(),ue(Ie),Oh("Utilisez les points de contrôle pour modifier la ligne")):Ie&&Ie instanceof Uh?(l.value=Ie,(Ve=r.value)==null||Ve.clearLayers(),M(),_e(Ie),Oh("Utilisez les points de contrôle pour modifier le polygone")):Ie&&Ie instanceof bh&&(l.value=Ie,Ie.editNote()))}),He.on("layeradd",function(pt){ze.almostOver&&(pt.layer instanceof dl||pt.layer instanceof jr.Polyline&&!(pt.layer instanceof jr.Polygon)||pt.layer instanceof Uh||pt.layer instanceof bh)&&ze.almostOver.addLayer(pt.layer)}),He.on("layerremove",function(pt){ze.almostOver&&(pt.layer instanceof dl||pt.layer instanceof jr.Polyline&&!(pt.layer instanceof jr.Polygon)||pt.layer instanceof Uh||pt.layer instanceof bh)&&ze.almostOver.removeLayer(pt.layer)}),ze},X=()=>{if(!(!e.value||!t.value||!t.value.getLayers().length))try{const ae=t.value.getBounds();if(ae.isValid()){const ne={zoomAnimation:e.value.options.zoomAnimation,fadeAnimation:e.value.options.fadeAnimation,markerZoomAnimation:e.value.options.markerZoomAnimation};e.value.options.zoomAnimation=!1,e.value.options.fadeAnimation=!1,e.value.options.markerZoomAnimation=!1,e.value.fitBounds(ae,{padding:[50,50],maxZoom:18,animate:!1,duration:0,noMoveStart:!0}),e.value.invalidateSize({animate:!1,pan:!1}),setTimeout(()=>{try{e.value&&(e.value.options.fadeAnimation=ne.fadeAnimation),setTimeout(()=>{try{e.value&&(e.value.options.zoomAnimation=ne.zoomAnimation,e.value.options.markerZoomAnimation=ne.markerZoomAnimation)}catch(Se){console.warn("[useMapDrawing] Erreur lors de la restauration des animations:",Se)}},500)}catch(Se){console.warn("[useMapDrawing] Erreur lors de la restauration des animations:",Se)}},500)}}catch(ae){if(console.warn("[useMapDrawing] Error adjusting view:",ae),e.value)try{e.value.options.zoomAnimation=!0,e.value.options.fadeAnimation=!0,e.value.options.markerZoomAnimation=!0,e.value.invalidateSize({animate:!1,pan:!1})}catch(ne){console.error("[useMapDrawing] Erreur lors de la restauration après échec:",ne)}}},Y=ae=>{var Se;if(!e.value)return;document.querySelectorAll(".drawing-help-message").forEach(Le=>Le.remove());try{const Le=e.value.pm;Le.globalEditModeEnabled()&&Le.disableGlobalEditMode(),Le.globalRemovalModeEnabled()&&Le.disableGlobalRemovalMode(),Le.disableDraw(),M(),(Se=r.value)==null||Se.clearLayers()}catch(Le){console.error("Error disabling modes:",Le)}if(window.dispatchEvent(new CustomEvent("tool:changed",{detail:{previousTool:i.value,newTool:ae}})),i.value=ae,!ae){M(),z();return}let ne=ae;switch(ae){case"Note":ne="GeoNote";break;case"Polygon":ne="Polygon";break;case"Line":ne="Line";break;default:ne=ae}ae=ne,Te(),setTimeout(()=>{var Le,ze,He,pt,ge,Ie,Ne;try{switch(ae){case"Polygon":Oh("Cliquez pour ajouter des points, double-cliquez pour terminer le polygone"),(Le=e.value)==null||Le.pm.enableDraw("Polygon",{finishOn:"dblclick",continueDrawing:!1,snapMiddle:!0,snapDistance:20}),(ze=e.value)==null||ze.off("pm:create"),(He=e.value)==null||He.on("pm:create",Ve=>{var it,lt,Mt;if(Ve.shape==="Polygon"&&Ve.layer){const wt=Ve.layer.getLatLngs()[0];(it=e.value)==null||it.removeLayer(Ve.layer),(lt=t.value)!=null&&lt.hasLayer(Ve.layer)&&t.value.removeLayer(Ve.layer);const rn=new Uh(wt,{color:"#3B82F6",weight:3,fillColor:"#3B82F6",fillOpacity:.2});t.value&&(t.value.addLayer(rn),l.value=rn,rn.updateProperties()),(Mt=e.value)==null||Mt.pm.disableDraw(),Te()}});break;case"Line":Oh("Cliquez pour ajouter des points, double-cliquez pour terminer la ligne"),(pt=e.value)==null||pt.pm.enableDraw("Line",{finishOn:"dblclick",continueDrawing:!1,snapMiddle:!0,snapDistance:20}),(ge=e.value)==null||ge.off("pm:create"),(Ie=e.value)==null||Ie.on("pm:create",Ve=>{var it,lt,Mt;if(Ve.shape==="Line"&&Ve.layer){const wt=Ve.layer.getLatLngs();(it=e.value)==null||it.removeLayer(Ve.layer),(lt=t.value)!=null&&lt.hasLayer(Ve.layer)&&t.value.removeLayer(Ve.layer);const rn=new dl(wt,{color:"#3B82F6",weight:3,opacity:.8});t.value&&(t.value.addLayer(rn),l.value=rn,rn.updateProperties()),(Mt=e.value)==null||Mt.pm.disableDraw(),Te()}});break;case"GeoNote":if(Oh("Cliquez pour ajouter une note géolocalisée, double-cliquez pour éditer"),e.value){const Ve=async lt=>{if(!e.value||!t.value)return null;try{const Mt=C_(),wt=new bh(lt,{color:"#3B82F6",name:"Note géolocalisée",description:"",columnId:"1"});t.value.addLayer(wt),l.value=wt,wt.updateProperties();try{const rn=Mt.currentMapId||void 0,yn=await wt.saveNote(rn),Pn=wt._leaflet_id;return window.dispatchEvent(new CustomEvent("note:created",{detail:{geoNote:wt,leafletId:Pn,backendId:yn}})),wt.openPopup(),wt}catch(rn){return console.error("[useMapDrawing] Erreur lors de la sauvegarde de la note:",rn),Dd(async()=>{const{useNotificationStore:yn}=await Promise.resolve().then(()=>jF);return{useNotificationStore:yn}},void 0).then(({useNotificationStore:yn})=>{yn().error("Erreur lors de la création de la note")}),null}}catch(Mt){return console.error("[useMapDrawing] Erreur lors de la création de la note:",Mt),null}},it=async lt=>{jr.DomEvent.stopPropagation(lt),jr.DomEvent.preventDefault(lt);const Mt=await Ve(lt.latlng);Mt&&e.value&&(e.value.off("click",it),t.value&&t.value.getLayers().forEach(wt=>{if(wt.off&&typeof wt.off=="function")try{wt.off("click")}catch(rn){console.warn("[useMapDrawing] Erreur lors du nettoyage des gestionnaires:",rn)}}),Y(""),window.dispatchEvent(new CustomEvent("geonote:select",{detail:{geoNote:Mt,leafletId:Mt._leaflet_id}})))};if(e.value.on("click",it),t.value){const lt=async wt=>{jr.DomEvent.stopPropagation(wt),jr.DomEvent.preventDefault(wt);const rn=await Ve(wt.latlng);return rn&&e.value&&(e.value.off("click",it),t.value&&t.value.getLayers().forEach(yn=>{if(yn.off&&typeof yn.off=="function")try{yn.off("click")}catch(Pn){console.warn("[useMapDrawing] Erreur lors du nettoyage des gestionnaires:",Pn)}}),Y(""),window.dispatchEvent(new CustomEvent("geonote:select",{detail:{geoNote:rn,leafletId:rn._leaflet_id}}))),!1};t.value.getLayers().forEach(wt=>{wt.on("click",lt)});const Mt=()=>{t.value&&t.value.getLayers().forEach(wt=>{if(wt.off&&typeof wt.off=="function")try{wt.off("click")}catch(rn){console.warn("[useMapDrawing] Erreur lors du nettoyage des gestionnaires:",rn)}}),window.removeEventListener("tool:changed",Mt)};window.addEventListener("tool:changed",Mt)}}break;case"delete":Oh("Cliquez sur une forme pour la supprimer"),(Ne=e.value)==null||Ne.pm.enableGlobalRemovalMode();break}}catch(Ve){console.error("[setDrawingTool] Erreur lors de la configuration de l'outil:",Ve)}},100)},Q=ae=>{if(!l.value)return;const ne=l.value;ne.properties=ne.properties||{},ne.properties.style=ne.properties.style||{},ne.properties.style={...ne.properties.style,...ae};{const Se={};ae.fillColor&&(Se.fillColor=ae.fillColor),ae.fillOpacity!==void 0&&(Se.fillOpacity=ae.fillOpacity),ae.strokeColor&&(Se.color=ae.strokeColor),ae.strokeOpacity!==void 0&&(Se.opacity=ae.strokeOpacity),ae.strokeWidth!==void 0&&(Se.weight=ae.strokeWidth),ae.dashArray&&(Se.dashArray=ae.dashArray),"setStyle"in ne&&ne.setStyle(Se)}},oe=ae=>{if(!l.value){console.warn("[useMapDrawing] Cannot update properties: no shape selected");return}l.value.properties||(l.value.properties={}),l.value.properties.type,l.value.properties.category||(l.value.properties.category="forages"),l.value.properties.accessLevel||(l.value.properties.accessLevel="visitor"),l.value._dbId||(l.value._dbId=Date.now()+Math.floor(Math.random()*1e3));const ne=l.value.properties.type,Se=l.value.properties.category,Le="category"in ae&&ae.category!==Se;if(Object.keys(ae).forEach(He=>{He==="type"&&ne||l.value&&(l.value.properties[He]=ae[He]),He==="name"&&(l.value.name=ae[He])}),ne&&(l.value.properties.type=ne),Se&&!Le&&(l.value.properties.category=Se),l.value&&l.value._dbId&&Le){const He=C_(),pt=He.elements.find(ge=>{var Ie;return ge.id===((Ie=l.value)==null?void 0:Ie._dbId)});if(pt){const ge=pt;ge.data||(ge.data={}),ge.data.category=l.value.properties.category,He.$patch({unsavedChanges:!0})}}const ze=new CustomEvent("shape:propertiesUpdated",{detail:{shape:l.value,properties:l.value.properties,categoryUpdated:Le}});window.dispatchEvent(ze)},le=ae=>{l.value=null,Sh(()=>{l.value=ae})},me=(ae,ne)=>{hk((Le,ze)=>{const He=R(Le,ze);Le.properties={...He},le(Le),Le.fire("properties:updated",{shape:Le,properties:Le.properties})},100)(ae,ne)},we=(ae,ne)=>jr.latLng((ae.lat+ne.lat)/2,(ae.lng+ne.lng)/2),ue=ae=>{if(!e.value||!t.value)return;M();const ne=ae.getLatLngs();if(!ne||ne.length===0){console.warn("Pas de points pour la ligne");return}let Se=null;if(ae instanceof dl){const Le=ae.getCenter();Se=C(Le,"#059669"),w.push(Se),_(Se,ae,()=>{const ze=ae.getLength()||0;return Hc(ze,"m","Longueur totale")}),Se.on("mousedown",ze=>{if(!e.value)return;jr.DomEvent.stopPropagation(ze),e.value.dragging.disable();let He=!0;const pt=ae.getLatLngs().map(it=>jr.latLng(it.lat,it.lng)),ge=ze.latlng;ae instanceof dl&&(ae.off("move:end"),ae.off("vertex:moved"),ae.off("latlngs:updated"),ae.off("properties:updated")),w.forEach((it,lt)=>{lt>0&&(it.setStyle({opacity:0,fillOpacity:0}),it.measureDiv&&(it.measureDiv.style.display="none"))});const Ne=u0(it=>{if(!He)return;const lt=it.latlng.lng-ge.lng,Mt=it.latlng.lat-ge.lat,wt=pt.map(rn=>jr.latLng(rn.lat+Mt,rn.lng+lt));jr.Polyline.prototype.setLatLngs.call(ae,wt),Se==null||Se.setLatLng(it.latlng)},16),Ve=()=>{if(He=!1,!!e.value){if(e.value.off("mousemove",Ne),document.removeEventListener("mouseup",Ve),e.value.dragging.enable(),ae instanceof dl){const it=()=>{M(),ue(ae)};ae.on("move:end",it),ae.on("vertex:moved",it),ae.on("latlngs:updated",it),ae.on("properties:updated",it),ae.updateProperties(),me(ae,"Line")}M(),ue(ae)}};e.value.on("mousemove",Ne),document.addEventListener("mouseup",Ve)})}if(ne.forEach((Le,ze)=>{const He=C(Le,"#DC2626");w.push(He),_(He,ae,()=>{if(ae instanceof dl){const pt=ae.getLength()||0,ge=ae.getLengthToVertex?ae.getLengthToVertex(ze):0;return[Hc(ge,"m","Distance depuis le début"),Hc(pt,"m","Longueur totale")].join("<br>")}return""}),He.on("mousedown",pt=>{if(!e.value)return;jr.DomEvent.stopPropagation(pt),e.value.dragging.disable();let ge=!0;ae instanceof dl&&(ae.off("move:end"),ae.off("vertex:moved"),ae.off("latlngs:updated"),ae.off("properties:updated")),w.forEach((Ve,it)=>{it!==ze+1&&(Ve.setStyle({opacity:0,fillOpacity:0}),Ve.measureDiv&&(Ve.measureDiv.style.display="none"))});const Ie=u0(Ve=>{if(!ge)return;const it=ae.getLatLngs();it[ze]=Ve.latlng,jr.Polyline.prototype.setLatLngs.call(ae,it),He.setLatLng(Ve.latlng)},16),Ne=()=>{if(ge=!1,!!e.value){if(e.value.off("mousemove",Ie),document.removeEventListener("mouseup",Ne),e.value.dragging.enable(),ae instanceof dl){const Ve=()=>{M(),ue(ae)};ae.on("move:end",Ve),ae.on("vertex:moved",Ve),ae.on("latlngs:updated",Ve),ae.on("properties:updated",Ve),ae.updateProperties(),me(ae,"Line")}M(),ue(ae)}};e.value.on("mousemove",Ie),document.addEventListener("mouseup",Ne)})}),ne.length>=2)for(let Le=0;Le<ne.length-1;Le++){const ze=ne[Le],He=ne[Le+1],pt=jr.latLng((ze.lat+He.lat)/2,(ze.lng+He.lng)/2),ge=C(pt,"#2b6451");w.push(ge),_(ge,ae,()=>{if(ae instanceof dl){const Ie=ae.getSegmentLengthAt(Le),Ne=ae.getLength()||0,Ve=(ae.getLengthToVertex?ae.getLengthToVertex(Le):0)+Ie/2;return[Hc(Ie,"m","Longueur du segment"),Hc(Ie/2,"m","Demi-segment"),Hc(Ve,"m","Distance depuis le début"),Hc(Ne,"m","Longueur totale")].join("<br>")}return""})}if(ae instanceof dl){const Le=()=>{M(),ue(ae)},ze=()=>{w.forEach((He,pt)=>{pt>0&&(He.setStyle({opacity:0,fillOpacity:0}),He.measureDiv&&(He.measureDiv.style.display="none"))})};ae.on("move:start",ze),ae.on("move:end",Le),ae.on("vertex:moved",Le),ae.on("latlngs:updated",Le),ae.on("properties:updated",Le),w.cleanup=()=>{ae.off("move:start",ze),ae.off("move:end",Le),ae.off("vertex:moved",Le),ae.off("latlngs:updated",Le),ae.off("properties:updated",Le)}}},_e=ae=>{if(!e.value||!t.value)return;M();const ne=ae.getLatLngs()[0],Se=ne.map(Ne=>[Ne.lng,Ne.lat]);Se.push(Se[0]);const Le=em([Se]),ze=av(Le),He=ne.reduce((Ne,Ve,it)=>{const lt=ne[(it+1)%ne.length];return Ne+Ve.distanceTo(lt)},0);let pt;if(typeof ae.getCenter=="function")try{pt=ae.getCenter()}catch(Ne){console.warn("Erreur lors de la récupération du centre du polygone via getCenter(), utilisation de la méthode alternative",Ne);const Ve=Zv(Le);pt=jr.latLng(Ve.geometry.coordinates[1],Ve.geometry.coordinates[0])}else{const Ne=Zv(Le);pt=jr.latLng(Ne.geometry.coordinates[1],Ne.geometry.coordinates[0])}const ge=C(pt,"#059669");w.push(ge),_(ge,ae,()=>[Hc(He,"m","Périmètre"),Hc(ze,"m²","Surface")].join("<br>")),ge.on("mousedown",Ne=>{if(!e.value)return;jr.DomEvent.stopPropagation(Ne),e.value.dragging.disable();let Ve=!0;const it=Ne.latlng,lt=[...ne];w.forEach((yn,Pn)=>{Pn>0&&yn.setStyle({opacity:0,fillOpacity:0})});const Mt=u0(yn=>{if(!Ve)return;const Pn=yn.latlng.lng-it.lng,De=yn.latlng.lat-it.lat,Ae=lt.map(Be=>jr.latLng(Be.lat+De,Be.lng+Pn));jr.Polygon.prototype.setLatLngs.call(ae,[Ae]),ge.setLatLng(yn.latlng)},16),wt=yn=>{Ve&&Mt(yn)},rn=()=>{if(Ve=!1,!!e.value){if(e.value.off("mousemove",wt),document.removeEventListener("mouseup",rn),e.value.dragging.enable(),ae.properties){const yn=ae.getLatLngs()[0],Pn=yn.map(Ae=>[Ae.lng,Ae.lat]);Pn.push(Pn[0]);const De=em([Pn]);ae.properties.area=av(De),ae.properties.perimeter=yn.reduce((Ae,Be,Ce)=>{const ot=yn[(Ce+1)%yn.length];return Ae+Be.distanceTo(ot)},0),ae.properties.surface=ae.properties.area}M(),_e(ae),l.value=null,Sh(()=>{l.value=ae})}};e.value.on("mousemove",wt),document.addEventListener("mouseup",rn)}),ne.forEach((Ne,Ve)=>{const it=C(Ne,"#DC2626");w.push(it),_(it,ae,()=>{const lt=ne[(Ve-1+ne.length)%ne.length],Mt=ne[(Ve+1)%ne.length],wt=Ne.distanceTo(lt),rn=Ne.distanceTo(Mt);return[Hc(wt,"m","Distance au point précédent"),Hc(rn,"m","Distance au point suivant"),Hc(He,"m","Périmètre total"),Hc(ze,"m²","Surface")].join("<br>")}),it.on("mousedown",lt=>{if(jr.DomEvent.stopPropagation(lt),!e.value)return;e.value.dragging.disable();let Mt=!0;ge&&(ge.setStyle({opacity:0,fillOpacity:0}),ge.measureDiv&&(ge.measureDiv.style.display="none"));const wt=u0(Pn=>{if(!Mt)return;ne[Ve]=Pn.latlng,jr.Polygon.prototype.setLatLngs.call(ae,[ne]),it.setLatLng(Pn.latlng);const De=w.slice(ne.length+1),Ae=(Ve-1+ne.length)%ne.length,Be=De[Ae];if(Be){const ot=ne[Ae],Dt=ne[Ve],Zt=jr.latLng((ot.lat+Dt.lat)/2,(ot.lng+Dt.lng)/2);Be.setLatLng(Zt)}const Ce=De[Ve];if(Ce){const ot=ne[Ve],Dt=ne[(Ve+1)%ne.length],Zt=jr.latLng((ot.lat+Dt.lat)/2,(ot.lng+Dt.lng)/2);Ce.setLatLng(Zt)}},16),rn=Pn=>{Mt&&wt(Pn)},yn=()=>{if(Mt=!1,!!e.value){if(e.value.off("mousemove",rn),document.removeEventListener("mouseup",yn),e.value.dragging.enable(),ae.properties){const Pn=ae.getLatLngs()[0].map(Ae=>[Ae.lng,Ae.lat]);Pn.push(Pn[0]);const De=em([Pn]);ae.properties.area=av(De),ae.properties.perimeter=ne.reduce((Ae,Be,Ce)=>{const ot=ne[(Ce+1)%ne.length];return Ae+Be.distanceTo(ot)},0),ae.properties.surface=ae.properties.area}M(),_e(ae),l.value=null,Sh(()=>{l.value=ae})}};e.value.on("mousemove",rn),document.addEventListener("mouseup",yn)})}),(()=>{const Ne=ae.getLatLngs()[0];w.slice(Ne.length+1).forEach(it=>{n.value&&n.value.removeLayer(it)}),w=w.slice(0,Ne.length+1);const Ve=new Array(Ne.length);for(let it=0;it<Ne.length;it++){const lt=Ne[it],Mt=Ne[(it+1)%Ne.length];Ve[it]=we(lt,Mt)}Ve.forEach((it,lt)=>{const Mt=C(it,"#2b6451");w.push(Mt),_(Mt,ae,()=>{const wt=Ne[lt],rn=Ne[(lt+1)%Ne.length],yn=wt.distanceTo(rn);return[Hc(yn,"m","Longueur du segment"),Hc(He,"m","Périmètre total"),Hc(ze,"m²","Surface")].join("<br>")}),Mt.on("mousedown",wt=>{if(!e.value)return;jr.DomEvent.stopPropagation(wt),e.value.dragging.disable();let rn=!0;const yn=lt;ge&&(ge.setStyle({opacity:0,fillOpacity:0}),ge.measureDiv&&(ge.measureDiv.style.display="none"));const Pn=[...ae.getLatLngs()[0]];Pn.splice((yn+1)%Pn.length,0,it),ae.setLatLngs([Pn]),M(),_e(ae);const De=yn+1,Ae=1+De,Be=De<w.length-1?w[Ae]:null;if(Be){const Ce=Dt=>{if(!rn)return;const Zt=ae.getLatLngs()[0];Zt[De]=Dt.latlng,ae.setLatLngs([Zt]),Be.setLatLng(Dt.latlng);const an=w.slice(1+Zt.length),ln=(De-1+Zt.length)%Zt.length,vn=De;if(an[ln]){const qn=Zt[ln],Kn=Zt[De],cr=jr.latLng((qn.lat+Kn.lat)/2,(qn.lng+Kn.lng)/2);an[ln].setLatLng(cr)}if(an[vn]){const qn=Zt[De],Kn=Zt[(De+1)%Zt.length],cr=jr.latLng((qn.lat+Kn.lat)/2,(qn.lng+Kn.lng)/2);an[vn].setLatLng(cr)}},ot=()=>{if(rn=!1,!!e.value){if(e.value.off("mousemove",Ce),document.removeEventListener("mouseup",ot),e.value.dragging.enable(),ae.properties){const Dt=ae.getLatLngs()[0].map(an=>[an.lng,an.lat]);Dt.push(Dt[0]);const Zt=em([Dt]);ae.properties.area=av(Zt),ae.properties.perimeter=ae.getLatLngs()[0].reduce((an,ln,vn,qn)=>{const Kn=qn[(vn+1)%qn.length];return an+ln.distanceTo(Kn)},0)}M(),_e(ae),l.value=null,Sh(()=>{l.value=ae})}};e.value.on("mousemove",Ce),document.addEventListener("mouseup",ot)}else e.value.dragging.enable(),M(),_e(ae)})})})()},We=ae=>{if(!e.value||!t.value)return;M();const ne=ae.getLatLng(),Se=C(ne,"#059669");w.push(Se),_(Se,ae,()=>`Position: ${ne.lat.toFixed(6)}, ${ne.lng.toFixed(6)}`),Se.on("mousedown",Le=>{if(!e.value)return;jr.DomEvent.stopPropagation(Le),e.value.dragging.disable(),ae.startMoving();let ze=!0;const pt=u0(Ie=>{ze&&(Se.setLatLng(Ie.latlng),ae.setLatLng(Ie.latlng))},16),ge=()=>{e.value&&(e.value.off("mousemove",pt),document.removeEventListener("mouseup",ge),e.value.dragging.enable(),ze=!1,ae.finishMoving(),ae.updateProperties(),l.value=null,Sh(()=>{l.value=ae,M(),We(ae)}))};e.value.on("mousemove",pt),document.addEventListener("mouseup",ge)}),l.value=ae},he=ae=>{if(!(!e.value||!r.value)){r.value.clearLayers();try{if(ae instanceof bh){const ne=ae.getLatLng();if(ne){const Se=jr.circleMarker(ne,{radius:5,color:"#059669",fillColor:"#059669",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});r.value.addLayer(Se)}}else if(ae instanceof Uh||ae instanceof jr.Polygon){let ne=[];if("getLatLngs"in ae){const Le=ae.getLatLngs();if(Array.isArray(Le)&&Le.length>0){const ze=Le[0];Array.isArray(ze)?ne=ze:ze instanceof jr.LatLng&&(ne=Le)}}let Se=null;if(ae instanceof Uh&&typeof ae.getCenter=="function")Se=ae.getCenter();else if(ne.length>0){const Le=ne.map(pt=>[pt.lng,pt.lat]);Le.push(Le[0]);const ze=em([Le]),He=Zv(ze);Se=jr.latLng(He.geometry.coordinates[1],He.geometry.coordinates[0])}if(Se){const Le=jr.circleMarker(Se,{radius:5,color:"#059669",fillColor:"#059669",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});r.value&&r.value.addLayer(Le)}ne.forEach(Le=>{if(Le){const ze=jr.circleMarker(Le,{radius:5,color:"#DC2626",fillColor:"#DC2626",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});r.value&&r.value.addLayer(ze)}});for(let Le=0;Le<ne.length;Le++){const ze=ne[Le],He=ne[(Le+1)%ne.length];if(ze&&He){const pt=jr.latLng((ze.lat+He.lat)/2,(ze.lng+He.lng)/2),ge=jr.circleMarker(pt,{radius:5,color:"#2563EB",fillColor:"#2563EB",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});r.value.addLayer(ge)}}}}catch(ne){console.error("[generateTempControlPoints] Erreur lors de la génération des points temporaires:",ne)}}},de=ae=>{var Le,ze,He,pt,ge;const ne=ae.layer;(Le=t.value)==null||Le.addLayer(ne);let Se="unknown";if(ne instanceof jr.Polygon?Se="Polygon":ne instanceof jr.Polyline&&!(ne instanceof jr.Polygon)&&(Se="Line"),ne.properties=R(ne,Se),ne.properties||(ne.properties={}),ne.properties.category||(ne.properties.category="forages"),ne.properties.accessLevel||(ne.properties.accessLevel="visitor"),ne._dbId=Date.now()+Math.floor(Math.random()*1e3),l.value=ne,window.dispatchEvent(new CustomEvent("shape:created",{detail:{shape:ne,type:Se,properties:ne.properties}})),ne.on("mouseover",()=>{(!l.value||l.value!==ne)&&he(ne)}),ne.on("mouseout",()=>{var Ie;(!l.value||l.value!==ne)&&((Ie=r.value)==null||Ie.clearLayers())}),ne instanceof jr.Polygon){const Ie=ne.getLatLngs()[0],Ne=new Uh([Ie],{...ne.options});Ne.updateProperties(),(ze=t.value)==null||ze.removeLayer(ne),(He=t.value)==null||He.addLayer(Ne),l.value=Ne,_e(Ne)}else if(ne instanceof dl)ue(ne),e.value&&e.value.almostOver&&e.value.almostOver.addLayer(ne);else if(ne instanceof jr.Polyline&&!(ne instanceof jr.Polygon)){const Ie=ne.getLatLngs(),Ne=new dl(Ie,{...ne.options});Ne.updateProperties(),(pt=t.value)==null||pt.removeLayer(ne),(ge=t.value)==null||ge.addLayer(Ne),l.value=Ne,ue(Ne),e.value&&e.value.almostOver&&e.value.almostOver.addLayer(Ne)}Oh("Cliquez sur la forme pour afficher les points de contrôle")},Te=()=>{e.value&&(e.value.off("pm:create"),e.value.on("pm:create",de))},be=()=>{if(e.value&&e.value.almostOver){const ae=e.value.almostOver.options.tolerance;return e.value.almostOver.options.tolerance=0,()=>{e.value&&e.value.almostOver&&(e.value.almostOver.options.tolerance=ae)}}return()=>{}};return window.addEventListener("edit:start",()=>{const ae=be(),ne=()=>{ae(),window.removeEventListener("edit:end",ne)};window.addEventListener("edit:end",ne)}),{map:e,featureGroup:t,controlPointsGroup:n,tempControlPointsGroup:r,currentTool:i,selectedShape:l,isDrawing:a,initMap:W,setDrawingTool:Y,updateShapeStyle:Q,updateShapeProperties:oe,adjustView:X,clearActiveControlPoints:M,addLinesToAlmostOver:z}}const ba=Symbol("newer"),yc=Symbol("older");class d${constructor(t,n){typeof t!="number"&&(n=t,t=0),this.size=0,this.limit=t,this.oldest=this.newest=void 0,this._keymap=new Map,n&&(this.assign(n),t<1&&(this.limit=this.size))}_markEntryAsUsed(t){t!==this.newest&&(t[ba]&&(t===this.oldest&&(this.oldest=t[ba]),t[ba][yc]=t[yc]),t[yc]&&(t[yc][ba]=t[ba]),t[ba]=void 0,t[yc]=this.newest,this.newest&&(this.newest[ba]=t),this.newest=t)}assign(t){let n,r=this.limit||Number.MAX_VALUE;this._keymap.clear();let i=t[Symbol.iterator]();for(let l=i.next();!l.done;l=i.next()){let a=new rP(l.value[0],l.value[1]);if(this._keymap.set(a.key,a),n?(n[ba]=a,a[yc]=n):this.oldest=a,n=a,r--==0)throw new Error("overflow")}this.newest=n,this.size=this._keymap.size}get(t){var n=this._keymap.get(t);if(n)return this._markEntryAsUsed(n),n.value}set(t,n){var r=this._keymap.get(t);return r?(r.value=n,this._markEntryAsUsed(r),this):(this._keymap.set(t,r=new rP(t,n)),this.newest?(this.newest[ba]=r,r[yc]=this.newest):this.oldest=r,this.newest=r,++this.size,this.size>this.limit&&this.shift(),this)}shift(){var t=this.oldest;if(t)return this.oldest[ba]?(this.oldest=this.oldest[ba],this.oldest[yc]=void 0):(this.oldest=void 0,this.newest=void 0),t[ba]=t[yc]=void 0,this._keymap.delete(t.key),--this.size,[t.key,t.value]}find(t){let n=this._keymap.get(t);return n?n.value:void 0}has(t){return this._keymap.has(t)}delete(t){var n=this._keymap.get(t);if(n)return this._keymap.delete(n.key),n[ba]&&n[yc]?(n[yc][ba]=n[ba],n[ba][yc]=n[yc]):n[ba]?(n[ba][yc]=void 0,this.oldest=n[ba]):n[yc]?(n[yc][ba]=void 0,this.newest=n[yc]):this.oldest=this.newest=void 0,this.size--,n.value}clear(){this.oldest=this.newest=void 0,this.size=0,this._keymap.clear()}keys(){return new PC(this.oldest)}values(){return new EC(this.oldest)}entries(){return this}[Symbol.iterator](){return new LC(this.oldest)}forEach(t,n){typeof n!="object"&&(n=this);let r=this.oldest;for(;r;)t.call(n,r.value,r.key,this),r=r[ba]}toJSON(){for(var t=new Array(this.size),n=0,r=this.oldest;r;)t[n++]={key:r.key,value:r.value},r=r[ba];return t}toString(){for(var t="",n=this.oldest;n;)t+=String(n.key)+":"+n.value,n=n[ba],n&&(t+=" < ");return t}}function rP(e,t){this.key=e,this.value=t,this[ba]=void 0,this[yc]=void 0}function LC(e){this.entry=e}LC.prototype[Symbol.iterator]=function(){return this};LC.prototype.next=function(){let e=this.entry;return e?(this.entry=e[ba],{done:!1,value:[e.key,e.value]}):{done:!0,value:void 0}};function PC(e){this.entry=e}PC.prototype[Symbol.iterator]=function(){return this};PC.prototype.next=function(){let e=this.entry;return e?(this.entry=e[ba],{done:!1,value:e.key}):{done:!0,value:void 0}};function EC(e){this.entry=e}EC.prototype[Symbol.iterator]=function(){return this};EC.prototype.next=function(){let e=this.entry;return e?(this.entry=e[ba],{done:!1,value:e.value}):{done:!0,value:void 0}};function f$(e,t){let n=0,r=null;r=setInterval(function(){if(n>=20)throw clearInterval(r),new Error("window.google not found after 10 seconds");window.google&&window.google.maps&&window.google.maps.Map&&(clearInterval(r),e.call(t)),++n},500)}L.GridLayer.GoogleMutant=L.GridLayer.extend({options:{maxZoom:21,type:"roadmap",maxNativeZoom:21},initialize:function(e){L.GridLayer.prototype.initialize.call(this,e),this._tileCallbacks={},this._lru=new d$(100),this._imagesPerTile=1,this._boundOnMutatedImage=this._onMutatedImage.bind(this)},onAdd:function(e){L.GridLayer.prototype.onAdd.call(this,e),this._initMutantContainer(),this._logoContainer&&e._controlCorners.bottomleft.appendChild(this._logoContainer),this._attributionContainer&&e._controlCorners.bottomright.appendChild(this._attributionContainer),f$(()=>{this._map&&(this._initMutant(),google.maps.event.addListenerOnce(this._mutant,"idle",()=>{this._map&&(this._checkZoomLevels(),this._mutantIsReady=!0)}))})},onRemove:function(e){L.GridLayer.prototype.onRemove.call(this,e),this._observer.disconnect(),e._container.removeChild(this._mutantContainer),this._logoContainer&&L.DomUtil.remove(this._logoContainer),this._attributionContainer&&L.DomUtil.remove(this._attributionContainer),this._mutant&&google.maps.event.clearListeners(this._mutant,"idle")},addGoogleLayer:function(e,t){return this._subLayers||(this._subLayers={}),this.whenReady(()=>{var n=google.maps[e],r=new n(t);r.setMap(this._mutant),this._subLayers[e]=r}),this},removeGoogleLayer:function(e){return this.whenReady(()=>{var t=this._subLayers&&this._subLayers[e];t&&(t.setMap(null),delete this._subLayers[e])}),this},_initMutantContainer:function(){this._mutantContainer||(this._mutantContainer=L.DomUtil.create("div","leaflet-google-mutant leaflet-top leaflet-left"),this._mutantContainer.id="_MutantContainer_"+L.Util.stamp(this._mutantContainer),this._mutantContainer.style.pointerEvents="none",this._mutantContainer.style.visibility="hidden",L.DomEvent.off(this._mutantContainer)),this._map.getContainer().appendChild(this._mutantContainer),this.setOpacity(this.options.opacity);const e=this._mutantContainer.style;this._map.options.zoomSnap<1?(e.width="180%",e.height="180%"):(e.width="100%",e.height="100%"),e.zIndex=-1,this._attachObserver(this._mutantContainer)},_initMutant:function(){if(!this._mutant){var e={center:{lat:0,lng:0},zoom:0,tilt:0,mapTypeId:this.options.type,disableDefaultUI:!0,keyboardShortcuts:!1,draggable:!1,disableDoubleClickZoom:!0,scrollwheel:!1,styles:this.options.styles||[],backgroundColor:"transparent"};this.options.mapId!=null&&(e.mapId=this.options.mapId);var t=new google.maps.Map(this._mutantContainer,e);this._mutant=t,this._update(),this.fire("spawned",{mapObject:t}),this._waitControls(),this.once("controls_ready",this._setupAttribution)}},_attachObserver:function(t){this._observer||(this._observer=new MutationObserver(this._onMutations.bind(this))),this._observer.observe(t,{childList:!0,subtree:!0}),Array.prototype.forEach.call(t.querySelectorAll("img"),this._boundOnMutatedImage)},_waitControls:function(){const e=setInterval(()=>{const t=this._mutant.__gm.layoutManager;if(!t)return;clearInterval(e);let n;Object.keys(t).forEach(function(r){const i=t[r];i.get&&i.get(1)instanceof Node&&(n=i)}),this.fire("controls_ready",{positions:n})},50)},_setupAttribution:function(e){if(!this._map)return;const t=google.maps.ControlPosition,n=this._attributionContainer=e.positions.get(t.BOTTOM_RIGHT);L.DomUtil.addClass(n,"leaflet-control leaflet-control-attribution"),L.DomEvent.disableClickPropagation(n),n.style.height="14px",this._map._controlCorners.bottomright.appendChild(n),this._logoContainer=e.positions.get(t.BOTTOM_LEFT),this._logoContainer.style.pointerEvents="auto",this._map._controlCorners.bottomleft.appendChild(this._logoContainer)},_onMutations:function(t){for(var n=0;n<t.length;++n)for(var r=t[n],i=0;i<r.addedNodes.length;++i){var l=r.addedNodes[i];l instanceof HTMLImageElement?this._onMutatedImage(l):l instanceof HTMLElement&&Array.prototype.forEach.call(l.querySelectorAll("img"),this._boundOnMutatedImage)}},_roadRegexp:/!1i(\d+)!2i(\d+)!3i(\d+|VinaFnapurmBegrtn)!/,_satRegexp:/x=(\d+)&y=(\d+)&z=(\d+|VinaFnapurmBegrtn)/,_onMutatedImage:function(t){let n,r=t.src.match(this._roadRegexp),i=0;if(r?(n={z:r[1],x:r[2],y:r[3]},this._imagesPerTile>1&&(t.style.zIndex=1,i=1)):(r=t.src.match(this._satRegexp),r&&(n={x:r[1],y:r[2],z:r[3]}),i=0),n){var l=this._tileCoordsToKey(n);t.style.position="absolute";var a=l+"/"+i;this._lru.set(a,t),a in this._tileCallbacks&&this._tileCallbacks[a]&&(this._tileCallbacks[a].forEach(o=>o(t)),delete this._tileCallbacks[a])}},createTile:function(e,t){const n=this._tileCoordsToKey(e),r=L.DomUtil.create("div");r.style.textAlign="left",r.dataset.pending=this._imagesPerTile,t=t.bind(this,null,r);for(var i=0;i<this._imagesPerTile;++i){const l=n+"/"+i,a=this._lru.get(l);a?(r.appendChild(this._clone(a)),--r.dataset.pending):(this._tileCallbacks[l]=this._tileCallbacks[l]||[],this._tileCallbacks[l].push((function(o){return(function(f){o.appendChild(this._clone(f)),--o.dataset.pending,parseInt(o.dataset.pending)||t()}).bind(this)}).bind(this)(r)))}return parseInt(r.dataset.pending)||L.Util.requestAnimFrame(t),r},_clone:function(e){const t=e.cloneNode(!0);return t.style.visibility="visible",t},_checkZoomLevels:function(){const e=this._map.getZoom(),t=this._mutant.getZoom();!e||!t||(t!==e||t>this.options.maxNativeZoom)&&this._setMaxNativeZoom(t)},_setMaxNativeZoom:function(e){e!==this.options.maxNativeZoom&&(this.options.maxNativeZoom=e,this._resetView())},_update:function(e){if(this._mutant){e=e||this._map.getCenter();const t=new google.maps.LatLng(e.lat,e.lng),n=Math.round(this._map.getZoom()),r=this._mutant.getZoom();this._mutant.setCenter(t),n!==r&&(this._mutant.setZoom(n),this._mutantIsReady&&this._checkZoomLevels())}L.GridLayer.prototype._update.call(this,e)},whenReady:function(e,t){return this._mutant?e.call(t||this,{target:this}):this.on("spawned",e,t),this}});L.gridLayer.googleMutant=function(e){return new L.GridLayer.GoogleMutant(e)};let ix=!1,Ym=null;function MC(){return ix?Promise.resolve():Ym||(Ym=new Promise(async(e,t)=>{var n;try{if(window.google&&window.google.maps){ix=!0,e();return}try{const r=await Ux.getGoogleMapsApiKey(),i=((n=r==null?void 0:r.data)==null?void 0:n.url)||"https://maps.googleapis.com/maps/api/js?libraries=places",l=document.createElement("script");l.type="text/javascript";const a=new URL(i);a.searchParams.has("loading")||a.searchParams.append("loading","async"),l.src=a.toString(),l.async=!0,l.defer=!0,l.onload=()=>{ix=!0,e()},l.onerror=()=>{Ym=null,t(new Error("Failed to load Google Maps API"))},document.head.appendChild(l)}catch(r){console.warn("Error loading Google Maps API:",r),Ym=null,t(r)}}catch(r){Ym=null,t(r)}}),Ym)}function Ek(){return ix||window.google&&window.google.maps}function TC(e,t,n){if(isNaN(e)||isNaN(t))return"#";let r=`https://www.google.com/maps/dir/?api=1&destination=${e},${t}`;return n&&(r+=`&destination_place_id=${encodeURIComponent(n)}`),r}function AC(e,t,n){if(isNaN(e)||isNaN(t))return"#";let r=`https://www.google.com/maps/search/?api=1&query=${e},${t}`;return n&&(r+=`&query_place_id=${encodeURIComponent(n)}`),r}function Mk(e,t,n="directions",r){if(isNaN(e)||isNaN(t))return;const i=n==="directions"?TC(e,t,r):AC(e,t,r);window.open(i,"_blank")}const p$={loadGoogleMapsApi:MC,isGoogleMapsLoaded:Ek,getGoogleMapsDirectionsUrl:TC,getGoogleMapsSearchUrl:AC,openInGoogleMaps:Mk},Tk=Object.freeze(Object.defineProperty({__proto__:null,default:p$,getGoogleMapsDirectionsUrl:TC,getGoogleMapsSearchUrl:AC,isGoogleMapsLoaded:Ek,loadGoogleMapsApi:MC,openInGoogleMaps:Mk},Symbol.toStringTag,{value:"Module"}));function m$(){const e=Rn(null),t=Rn("Hybride"),n=Rn(null),r=Rn(!1),i={maxZoom:19,updateWhenZooming:!0,updateWhenIdle:!0,noWrap:!0,keepBuffer:2,maxNativeZoom:19,tileSize:256,zoomOffset:0,bounds:jr.latLngBounds(jr.latLng(41.333,-5.566),jr.latLng(51.089,9.555)),crossOrigin:!0,detectRetina:!0,useCache:!0,priorityLevels:3},l={Hybride:jr.layerGroup([jr.gridLayer.googleMutant({type:"hybrid",maxZoom:i.maxZoom})]),Cadastre:jr.tileLayer("https://data.geopf.fr/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=CADASTRALPARCELS.PARCELLAIRE_EXPRESS&STYLE=normal&FORMAT=image/png&TILEMATRIXSET=PM&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}",{...i,attribution:"Cadastre - Carte © IGN/Geoportail",maxNativeZoom:18}),IGN:jr.tileLayer("https://data.geopf.fr/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2&STYLE=normal&FORMAT=image/png&TILEMATRIXSET=PM&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}",{...i,attribution:"Carte IGN © IGN/Geoportail",maxNativeZoom:18})},a=async()=>{try{await MC(),r.value=!0}catch(_){console.error("Failed to load Google Maps API:",_),r.value=!1,t.value==="Hybride"&&(t.value="IGN")}};return{map:e,currentBaseMap:t,baseMaps:l,initMap:async _=>{r.value||await a(),e.value=_,_.options.zoomSnap=.5,_.options.zoomDelta=.5,_.options.wheelPxPerZoomLevel=120,_.options.zoomAnimation=!0,_.options.fadeAnimation=!0,_.options.markerZoomAnimation=!0,_.options.preferCanvas=!0,_.options.renderer=jr.canvas(),_.options.minZoom=2,_.options.maxZoom=19,_.options.scrollWheelZoom=!0,_.options.doubleClickZoom=!0;const w=jr.latLngBounds(jr.latLng(-90,-180),jr.latLng(90,180));_.setMaxBounds(w),_.options.maxBoundsViscosity=1,_.options.trackResize=!0;let M=null;_.getZoom(),_.on("zoomstart",()=>{_.getZoom(),_.options.zoomAnimation=!1,_.options.markerZoomAnimation=!1}),_.on("zoomend",()=>{M&&clearTimeout(M),M=setTimeout(()=>{setTimeout(()=>{_.options.zoomAnimation=!0,_.options.markerZoomAnimation=!0,_.invalidateSize({animate:!1,pan:!1});const R=_.getBounds(),z=_.options.maxBounds;z&&!R.intersects(z)&&_.panInsideBounds(z,{animate:!1}),_.eachLayer(W=>{W.properties&&W.properties.type==="Note"&&typeof W.updatePosition=="function"&&W.updatePosition()})},250)},250)});const C=_._zoomAnimation;C&&(_._zoomAnimation=function(R){try{this._animatingZoom||C.call(this,R)}catch{console.warn("Animation de zoom interrompue, restauration de la vue..."),this._resetView(this.getCenter(),this.getZoom())}}),_.on("zoomanim",R=>{_.eachLayer(z=>{z.properties&&z.properties.type==="Note"&&typeof z.updatePositionDuringZoom=="function"&&z.updatePositionDuringZoom(R)})}),_&&(_.whenReady(()=>{const R=t.value;if(l[R]){if(n.value&&_.hasLayer(n.value))try{_.removeLayer(n.value)}catch(z){console.warn("Erreur lors de la suppression de la couche active précédente:",z)}n.value=l[R];try{n.value.addTo(_)}catch(z){console.error(`Erreur lors de l'ajout de la couche ${R}:`,z)}}else console.warn(`Couche de base non disponible: ${R}`)}),_.on("baselayerchange",R=>{t.value=R.name,n.value=R.layer}))},changeBaseMap:async _=>{if(_==="Hybride"&&!r.value&&(await a(),!r.value)){console.warn("Cannot switch to Hybride: Google Maps API not loaded");return}if(!e.value||!l[_]){console.warn(`Impossible de changer la carte de base: ${e.value?"type de carte non disponible":"carte non initialisée"}`);return}try{if(t.value===_)return;const w=e.value,M=w.getCenter(),C=w.getZoom();w.options.zoomAnimation=!1,w.options.fadeAnimation=!1,w.options.markerZoomAnimation=!1;const R=l[_];if(n.value&&w.hasLayer(n.value))try{w.removeLayer(n.value)}catch(z){console.warn("Erreur lors de la suppression de la couche active:",z)}try{R instanceof jr.LayerGroup,R.addTo(w)}catch(z){console.error("Erreur lors de l'ajout de la nouvelle couche:",z);try{w.hasLayer(R)&&w.removeLayer(R),R.addTo(w)}catch(W){throw console.error("Échec de la récupération:",W),new Error("Impossible d'ajouter la nouvelle couche")}}n.value=R,t.value=_;try{w.setView(M,C,{animate:!1,duration:0,noMoveStart:!0})}catch(z){console.warn("Erreur lors de la réinitialisation de la vue:",z)}try{w.invalidateSize({animate:!1,pan:!1}),setTimeout(()=>{w.eachLayer(z=>{z.properties&&z.properties.type==="Note"&&typeof z.updatePosition=="function"&&z.updatePosition()})},100)}catch(z){console.warn("Erreur lors du rafraîchissement de la carte:",z)}setTimeout(()=>{w.options.zoomAnimation=!0,w.options.fadeAnimation=!0,w.options.markerZoomAnimation=!0},500)}catch(w){if(console.error("Erreur lors du changement de carte de base:",w),e.value)try{const M=e.value;M.eachLayer(R=>{(R instanceof jr.TileLayer||R instanceof jr.LayerGroup)&&M.removeLayer(R)});const C=l[_];C.addTo(M),n.value=C,t.value=_,M.options.zoomAnimation=!0,M.options.fadeAnimation=!0,M.options.markerZoomAnimation=!0,M.invalidateSize({animate:!1,pan:!1})}catch(M){console.error("Erreur lors de la récupération après échec:",M)}}},cleanup:()=>{e.value&&(e.value.remove(),e.value=null),n.value&&(n.value=null)},isGoogleMapsLoaded:r}}const g$={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[3001] overflow-y-auto"},y$={class:"bg-white w-full h-full md:rounded-lg md:max-w-4xl md:h-auto md:max-h-[90vh] md:my-8 relative overflow-y-auto"},v$={class:"p-4 md:p-6 pt-0 overflow-y-auto max-h-[calc(100vh-80px)] md:max-h-[calc(90vh-80px)]"},_$={key:0,class:"mb-4"},b$={key:0,class:"animate-pulse"},x$=["value"],w$={key:1,class:"mb-4"},C$={key:0,class:"animate-pulse"},S$=["disabled"],L$={value:null},P$=["value"],E$={key:2,class:"mb-4"},M$={key:0,class:"animate-pulse"},T$=["disabled"],A$={value:null},k$=["value"],I$={class:"mb-4"},D$={class:"mb-6"},O$={class:"flex justify-end space-x-3"},R$=["disabled"],B$={key:0},N$={key:1},F$=Ja({__name:"NewPlanModal",props:{modelValue:{type:Boolean}},emits:["update:modelValue","created","salarieSelected","visiteurSelected"],setup(e,{expose:t,emit:n}){function r(Te){return Te?typeof Te=="object"?Te.id:Te:null}function i(Te){if(Te===null)throw new Error("Invalid ID");return Te}const l=e,a=n,o=Mu(),f=CC(),m=C_(),_=Rn(!1),w=Rn(null),M=Rn([]),C=Rn([]),R=Rn([]),z=Rn(null),W=Rn(null),X=Rn(!1),Y=Rn(!1),Q=Rn(!1),oe=Rn({nom:"",description:"",entreprise:null,salarie:null,visiteur:null}),le=Ai(()=>{var Te,be,ae;return((Te=o.user)==null?void 0:Te.user_type)==="admin"?oe.value.nom.trim()&&oe.value.entreprise&&oe.value.salarie:((be=o.user)==null?void 0:be.user_type)==="entreprise"?oe.value.nom.trim()&&oe.value.salarie:(((ae=o.user)==null?void 0:ae.user_type)==="salarie",oe.value.nom.trim())});mo(()=>oe.value.entreprise,async Te=>{if(!l.modelValue)return;oe.value.salarie=null,oe.value.visiteur=null,C.value=[];const be=r(Te);be?await me(be):M.value=[]}),mo(()=>oe.value.salarie,async Te=>{if(!l.modelValue)return;oe.value.visiteur=null;const be=r(Te);be?await we(be):C.value=[]}),mo(()=>l.modelValue,Te=>{var be,ae,ne;Te?((be=o.user)==null?void 0:be.user_type)==="admin"?he():((ae=o.user)==null?void 0:ae.user_type)==="entreprise"?me(o.user.id):((ne=o.user)==null?void 0:ne.user_type)==="salarie"&&we(o.user.id):(oe.value={nom:"",description:"",entreprise:null,salarie:null,visiteur:null},z.value=null,W.value=null,C.value=[],M.value=[],R.value=[],w.value=null)});async function me(Te){X.value=!0;try{const be=await Bc.getUsers({role:"SALARIE",entreprise:Te});M.value=be.data}catch(be){console.error("[NewPlanModal] Error loading salaries:",be),M.value=[]}finally{X.value=!1}}async function we(Te){Y.value=!0;try{const be=await Bc.getUsers({role:"VISITEUR",salarie:Te});C.value=be.data}catch(be){console.error("[NewPlanModal] Error loading visiteurs:",be),C.value=[]}finally{Y.value=!1}}async function ue(Te){l.modelValue&&(z.value=Te,oe.value.salarie=Te.id,await we(Te.id),a("salarieSelected",Te))}function _e(Te){l.modelValue&&(W.value=Te,oe.value.visiteur=Te.id,a("visiteurSelected",Te))}function We(){a("update:modelValue",!1),oe.value={nom:"",description:"",entreprise:null,salarie:null,visiteur:null},z.value=null,W.value=null,C.value=[],w.value=null}async function he(){Q.value=!0;try{const Te=await o.fetchEnterprises();R.value=Te}catch(Te){console.error("[NewPlanModal] Error loading entreprises:",Te),R.value=[]}finally{Q.value=!1}}async function de(){var Te,be;w.value=null,_.value=!0;try{const ae={nom:oe.value.nom.trim(),description:oe.value.description.trim()},ne=o.user;if(!ne)throw new Error("User not found");if(ne.user_type==="admin"){if(!oe.value.entreprise||!oe.value.salarie)throw new Error("Missing required fields");ae.entreprise=i(r(oe.value.entreprise)),ae.salarie=i(r(oe.value.salarie)),oe.value.visiteur&&(ae.visiteur=oe.value.visiteur)}else if(ne.user_type==="entreprise"){if(!oe.value.salarie)throw new Error("Missing required fields");ae.entreprise=ne.id,ae.salarie=i(r(oe.value.salarie)),oe.value.visiteur&&(ae.visiteur=oe.value.visiteur)}else if(ne.user_type==="salarie"){if(!ne.entreprise)throw new Error("Missing required fields");ae.entreprise=ne.entreprise.id,ae.salarie=ne.id,oe.value.visiteur&&(ae.visiteur=oe.value.visiteur)}else if(ne.user_type==="visiteur"){if(!ne.entreprise||!ne.salarie)throw new Error("Missing required fields");ae.entreprise=ne.entreprise.id,ae.salarie=ne.salarie.id,ae.visiteur=ne.id}f.clearCurrentPlan(),m.setCurrentPlan(null);const Se=await f.createPlan(ae);a("created",Se.id),We()}catch(ae){console.error("[NewPlanModal] Error creating plan:",ae),console.error("Response data:",(Te=ae.response)==null?void 0:Te.data);let ne="Une erreur est survenue lors de la création du plan";(be=ae.response)!=null&&be.data&&(typeof ae.response.data=="object"?ne=Object.entries(ae.response.data).map(([Se,Le])=>Array.isArray(Le)?`${Se}: ${Le.join(", ")}`:`${Se}: ${Le}`).join(`
`):typeof ae.response.data=="string"&&(ne=ae.response.data)),w.value=ne}finally{_.value=!1}}return t({salaries:M,visiteurs:C,selectedSalarie:z,selectedVisiteur:W,loadSalaries:me,loadVisiteurs:we,selectSalarie:ue,selectVisiteur:_e}),(Te,be)=>{var ae,ne,Se,Le;return Te.modelValue?(yt(),Et("div",g$,[V("div",y$,[V("div",{class:"flex justify-between items-center mb-4 sticky top-0 bg-white p-4 md:p-6 pb-4 border-b z-10"},[be[6]||(be[6]=V("h2",{class:"text-xl font-semibold text-gray-900"},"Créer un nouveau plan",-1)),V("button",{onClick:We,class:"text-gray-400 hover:text-gray-500"},be[5]||(be[5]=[V("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),V("div",v$,[Tr(o).isAdmin?(yt(),Et("div",_$,[be[9]||(be[9]=V("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Entreprise",-1)),Q.value?(yt(),Et("div",b$,be[7]||(be[7]=[V("div",{class:"h-10 bg-gray-200 rounded"},null,-1)]))):li((yt(),Et("select",{key:1,"onUpdate:modelValue":be[0]||(be[0]=ze=>oe.value.entreprise=ze),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"},[be[8]||(be[8]=V("option",{value:null},"Sélectionnez une entreprise",-1)),(yt(!0),Et($r,null,Ti(R.value,ze=>(yt(),Et("option",{key:ze.id,value:ze.id},er(Tr(kl)(ze)),9,x$))),128))],512)),[[Ka,oe.value.entreprise]])])):yr("",!0),((ae=Tr(o).user)==null?void 0:ae.user_type)==="admin"||((ne=Tr(o).user)==null?void 0:ne.user_type)==="entreprise"?(yt(),Et("div",w$,[be[11]||(be[11]=V("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Salarie",-1)),X.value?(yt(),Et("div",C$,be[10]||(be[10]=[V("div",{class:"h-10 bg-gray-200 rounded"},null,-1)]))):li((yt(),Et("select",{key:1,id:"edit-salarie","onUpdate:modelValue":be[1]||(be[1]=ze=>oe.value.salarie=ze),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:Tr(o).isAdmin&&!oe.value.entreprise},[V("option",L$,er(M.value.length?"Sélectionnez un salarie":"Aucun salarie disponible"),1),(yt(!0),Et($r,null,Ti(M.value,ze=>(yt(),Et("option",{key:ze.id,value:ze.id},er(Tr(kl)(ze)),9,P$))),128))],8,S$)),[[Ka,oe.value.salarie]])])):yr("",!0),((Se=Tr(o).user)==null?void 0:Se.user_type)!=="visiteur"?(yt(),Et("div",E$,[be[13]||(be[13]=V("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Visiteur",-1)),Y.value?(yt(),Et("div",M$,be[12]||(be[12]=[V("div",{class:"h-10 bg-gray-200 rounded"},null,-1)]))):li((yt(),Et("select",{key:1,id:"edit-visiteur","onUpdate:modelValue":be[2]||(be[2]=ze=>oe.value.visiteur=ze),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:!C.value.length||((Le=Tr(o).user)==null?void 0:Le.user_type)!=="salarie"&&!oe.value.salarie},[V("option",A$,er(C.value.length?"Sélectionnez un visiteur":"Aucun visiteur disponible"),1),(yt(!0),Et($r,null,Ti(C.value,ze=>(yt(),Et("option",{key:ze.id,value:ze.id},er(Tr(kl)(ze)),9,k$))),128))],8,T$)),[[Ka,oe.value.visiteur]])])):yr("",!0),V("div",I$,[be[14]||(be[14]=V("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nom du plan",-1)),li(V("input",{id:"edit-nom","onUpdate:modelValue":be[3]||(be[3]=ze=>oe.value.nom=ze),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Entrez le nom du plan"},null,512),[[to,oe.value.nom]])]),V("div",D$,[be[15]||(be[15]=V("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description",-1)),li(V("textarea",{id:"edit-description","onUpdate:modelValue":be[4]||(be[4]=ze=>oe.value.description=ze),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",rows:"3",placeholder:"Entrez une description (optionnel)"},null,512),[[to,oe.value.description]])]),V("div",O$,[V("button",{onClick:We,class:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500"}," Annuler "),V("button",{onClick:de,class:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:!le.value||_.value},[_.value?(yt(),Et("span",B$,"Création en cours...")):(yt(),Et("span",N$,"Créer"))],8,R$)])])])])):yr("",!0)}}});function Xo(e){"@babel/helpers - typeof";return Xo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xo(e)}var th=Uint8Array,pd=Uint16Array,kC=Int32Array,U2=new th([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),V2=new th([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),e3=new th([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ak=function(e,t){for(var n=new pd(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];for(var i=new kC(n[30]),r=1;r<30;++r)for(var l=n[r];l<n[r+1];++l)i[l]=l-n[r]<<5|r;return{b:n,r:i}},kk=Ak(U2,2),Ik=kk.b,t3=kk.r;Ik[28]=258,t3[258]=28;var Dk=Ak(V2,0),z$=Dk.b,iP=Dk.r,n3=new pd(32768);for(var Za=0;Za<32768;++Za){var Gp=(Za&43690)>>1|(Za&21845)<<1;Gp=(Gp&52428)>>2|(Gp&13107)<<2,Gp=(Gp&61680)>>4|(Gp&3855)<<4,n3[Za]=((Gp&65280)>>8|(Gp&255)<<8)>>1}var Rf=function(e,t,n){for(var r=e.length,i=0,l=new pd(t);i<r;++i)e[i]&&++l[e[i]-1];var a=new pd(t);for(i=1;i<t;++i)a[i]=a[i-1]+l[i-1]<<1;var o;if(n){o=new pd(1<<t);var f=15-t;for(i=0;i<r;++i)if(e[i])for(var m=i<<4|e[i],_=t-e[i],w=a[e[i]-1]++<<_,M=w|(1<<_)-1;w<=M;++w)o[n3[w]>>f]=m}else for(o=new pd(r),i=0;i<r;++i)e[i]&&(o[i]=n3[a[e[i]-1]++]>>15-e[i]);return o},gm=new th(288);for(var Za=0;Za<144;++Za)gm[Za]=8;for(var Za=144;Za<256;++Za)gm[Za]=9;for(var Za=256;Za<280;++Za)gm[Za]=7;for(var Za=280;Za<288;++Za)gm[Za]=8;var S_=new th(32);for(var Za=0;Za<32;++Za)S_[Za]=5;var j$=Rf(gm,9,0),U$=Rf(gm,9,1),V$=Rf(S_,5,0),$$=Rf(S_,5,1),F5=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},Zd=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(t&7)&n},z5=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(t&7)},IC=function(e){return(e+7)/8|0},Ok=function(e,t,n){return(n==null||n>e.length)&&(n=e.length),new th(e.subarray(t,n))},G$=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Jd=function(e,t,n){var r=new Error(t||G$[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,Jd),!n)throw r;return r},H$=function(e,t,n,r){var i=e.length,l=0;if(!i||t.f&&!t.l)return n||new th(0);var a=!n,o=a||t.i!=2,f=t.i;a&&(n=new th(i*3));var m=function(yn){var Pn=n.length;if(yn>Pn){var De=new th(Math.max(Pn*2,yn));De.set(n),n=De}},_=t.f||0,w=t.p||0,M=t.b||0,C=t.l,R=t.d,z=t.m,W=t.n,X=i*8;do{if(!C){_=Zd(e,w,1);var Y=Zd(e,w+1,3);if(w+=3,Y)if(Y==1)C=U$,R=$$,z=9,W=5;else if(Y==2){var me=Zd(e,w,31)+257,we=Zd(e,w+10,15)+4,ue=me+Zd(e,w+5,31)+1;w+=14;for(var _e=new th(ue),We=new th(19),he=0;he<we;++he)We[e3[he]]=Zd(e,w+he*3,7);w+=we*3;for(var de=F5(We),Te=(1<<de)-1,be=Rf(We,de,1),he=0;he<ue;){var ae=be[Zd(e,w,Te)];w+=ae&15;var Q=ae>>4;if(Q<16)_e[he++]=Q;else{var ne=0,Se=0;for(Q==16?(Se=3+Zd(e,w,3),w+=2,ne=_e[he-1]):Q==17?(Se=3+Zd(e,w,7),w+=3):Q==18&&(Se=11+Zd(e,w,127),w+=7);Se--;)_e[he++]=ne}}var Le=_e.subarray(0,me),ze=_e.subarray(me);z=F5(Le),W=F5(ze),C=Rf(Le,z,1),R=Rf(ze,W,1)}else Jd(1);else{var Q=IC(w)+4,oe=e[Q-4]|e[Q-3]<<8,le=Q+oe;if(le>i){f&&Jd(0);break}o&&m(M+oe),n.set(e.subarray(Q,le),M),t.b=M+=oe,t.p=w=le*8,t.f=_;continue}if(w>X){f&&Jd(0);break}}o&&m(M+131072);for(var He=(1<<z)-1,pt=(1<<W)-1,ge=w;;ge=w){var ne=C[z5(e,w)&He],Ie=ne>>4;if(w+=ne&15,w>X){f&&Jd(0);break}if(ne||Jd(2),Ie<256)n[M++]=Ie;else if(Ie==256){ge=w,C=null;break}else{var Ne=Ie-254;if(Ie>264){var he=Ie-257,Ve=U2[he];Ne=Zd(e,w,(1<<Ve)-1)+Ik[he],w+=Ve}var it=R[z5(e,w)&pt],lt=it>>4;it||Jd(3),w+=it&15;var ze=z$[lt];if(lt>3){var Ve=V2[lt];ze+=z5(e,w)&(1<<Ve)-1,w+=Ve}if(w>X){f&&Jd(0);break}o&&m(M+131072);var Mt=M+Ne;if(M<ze){var wt=l-ze,rn=Math.min(ze,Mt);for(wt+M<0&&Jd(3);M<rn;++M)n[M]=r[wt+M]}for(;M<Mt;++M)n[M]=n[M-ze]}}t.l=C,t.p=ge,t.b=M,t.f=_,C&&(_=1,t.m=z,t.d=R,t.n=W)}while(!_);return M!=n.length&&a?Ok(n,0,M):n.subarray(0,M)},ip=function(e,t,n){n<<=t&7;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8},lv=function(e,t,n){n<<=t&7;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8,e[r+2]|=n>>16},j5=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var i=n.length,l=n.slice();if(!i)return{t:Bk,l:0};if(i==1){var a=new th(n[0].s+1);return a[n[0].s]=1,{t:a,l:1}}n.sort(function(le,me){return le.f-me.f}),n.push({s:-1,f:25001});var o=n[0],f=n[1],m=0,_=1,w=2;for(n[0]={s:-1,f:o.f+f.f,l:o,r:f};_!=i-1;)o=n[n[m].f<n[w].f?m++:w++],f=n[m!=_&&n[m].f<n[w].f?m++:w++],n[_++]={s:-1,f:o.f+f.f,l:o,r:f};for(var M=l[0].s,r=1;r<i;++r)l[r].s>M&&(M=l[r].s);var C=new pd(M+1),R=r3(n[_-1],C,0);if(R>t){var r=0,z=0,W=R-t,X=1<<W;for(l.sort(function(me,we){return C[we.s]-C[me.s]||me.f-we.f});r<i;++r){var Y=l[r].s;if(C[Y]>t)z+=X-(1<<R-C[Y]),C[Y]=t;else break}for(z>>=W;z>0;){var Q=l[r].s;C[Q]<t?z-=1<<t-C[Q]++-1:++r}for(;r>=0&&z;--r){var oe=l[r].s;C[oe]==t&&(--C[oe],++z)}R=t}return{t:new th(C),l:R}},r3=function(e,t,n){return e.s==-1?Math.max(r3(e.l,t,n+1),r3(e.r,t,n+1)):t[e.s]=n},sP=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new pd(++t),r=0,i=e[0],l=1,a=function(f){n[r++]=f},o=1;o<=t;++o)if(e[o]==i&&o!=t)++l;else{if(!i&&l>2){for(;l>138;l-=138)a(32754);l>2&&(a(l>10?l-11<<5|28690:l-3<<5|12305),l=0)}else if(l>3){for(a(i),--l;l>6;l-=6)a(8304);l>2&&(a(l-3<<5|8208),l=0)}for(;l--;)a(i);l=1,i=e[o]}return{c:n.subarray(0,r),n:t}},uv=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},Rk=function(e,t,n){var r=n.length,i=IC(t+2);e[i]=r&255,e[i+1]=r>>8,e[i+2]=e[i]^255,e[i+3]=e[i+1]^255;for(var l=0;l<r;++l)e[i+l+4]=n[l];return(i+4+r)*8},oP=function(e,t,n,r,i,l,a,o,f,m,_){ip(t,_++,n),++i[256];for(var w=j5(i,15),M=w.t,C=w.l,R=j5(l,15),z=R.t,W=R.l,X=sP(M),Y=X.c,Q=X.n,oe=sP(z),le=oe.c,me=oe.n,we=new pd(19),ue=0;ue<Y.length;++ue)++we[Y[ue]&31];for(var ue=0;ue<le.length;++ue)++we[le[ue]&31];for(var _e=j5(we,7),We=_e.t,he=_e.l,de=19;de>4&&!We[e3[de-1]];--de);var Te=m+5<<3,be=uv(i,gm)+uv(l,S_)+a,ae=uv(i,M)+uv(l,z)+a+14+3*de+uv(we,We)+2*we[16]+3*we[17]+7*we[18];if(f>=0&&Te<=be&&Te<=ae)return Rk(t,_,e.subarray(f,f+m));var ne,Se,Le,ze;if(ip(t,_,1+(ae<be)),_+=2,ae<be){ne=Rf(M,C,0),Se=M,Le=Rf(z,W,0),ze=z;var He=Rf(We,he,0);ip(t,_,Q-257),ip(t,_+5,me-1),ip(t,_+10,de-4),_+=14;for(var ue=0;ue<de;++ue)ip(t,_+3*ue,We[e3[ue]]);_+=3*de;for(var pt=[Y,le],ge=0;ge<2;++ge)for(var Ie=pt[ge],ue=0;ue<Ie.length;++ue){var Ne=Ie[ue]&31;ip(t,_,He[Ne]),_+=We[Ne],Ne>15&&(ip(t,_,Ie[ue]>>5&127),_+=Ie[ue]>>12)}}else ne=j$,Se=gm,Le=V$,ze=S_;for(var ue=0;ue<o;++ue){var Ve=r[ue];if(Ve>255){var Ne=Ve>>18&31;lv(t,_,ne[Ne+257]),_+=Se[Ne+257],Ne>7&&(ip(t,_,Ve>>23&31),_+=U2[Ne]);var it=Ve&31;lv(t,_,Le[it]),_+=ze[it],it>3&&(lv(t,_,Ve>>5&8191),_+=V2[it])}else lv(t,_,ne[Ve]),_+=Se[Ve]}return lv(t,_,ne[256]),_+Se[256]},q$=new kC([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Bk=new th(0),W$=function(e,t,n,r,i,l){var a=l.z||e.length,o=new th(r+a+5*(1+Math.ceil(a/7e3))+i),f=o.subarray(r,o.length-i),m=l.l,_=(l.r||0)&7;if(t){_&&(f[0]=l.r>>3);for(var w=q$[t-1],M=w>>13,C=w&8191,R=(1<<n)-1,z=l.p||new pd(32768),W=l.h||new pd(R+1),X=Math.ceil(n/3),Y=2*X,Q=function(Ae){return(e[Ae]^e[Ae+1]<<X^e[Ae+2]<<Y)&R},oe=new kC(25e3),le=new pd(288),me=new pd(32),we=0,ue=0,_e=l.i||0,We=0,he=l.w||0,de=0;_e+2<a;++_e){var Te=Q(_e),be=_e&32767,ae=W[Te];if(z[be]=ae,W[Te]=be,he<=_e){var ne=a-_e;if((we>7e3||We>24576)&&(ne>423||!m)){_=oP(e,f,0,oe,le,me,ue,We,de,_e-de,_),We=we=ue=0,de=_e;for(var Se=0;Se<286;++Se)le[Se]=0;for(var Se=0;Se<30;++Se)me[Se]=0}var Le=2,ze=0,He=C,pt=be-ae&32767;if(ne>2&&Te==Q(_e-pt))for(var ge=Math.min(M,ne)-1,Ie=Math.min(32767,_e),Ne=Math.min(258,ne);pt<=Ie&&--He&&be!=ae;){if(e[_e+Le]==e[_e+Le-pt]){for(var Ve=0;Ve<Ne&&e[_e+Ve]==e[_e+Ve-pt];++Ve);if(Ve>Le){if(Le=Ve,ze=pt,Ve>ge)break;for(var it=Math.min(pt,Ve-2),lt=0,Se=0;Se<it;++Se){var Mt=_e-pt+Se&32767,wt=z[Mt],rn=Mt-wt&32767;rn>lt&&(lt=rn,ae=Mt)}}}be=ae,ae=z[be],pt+=be-ae&32767}if(ze){oe[We++]=268435456|t3[Le]<<18|iP[ze];var yn=t3[Le]&31,Pn=iP[ze]&31;ue+=U2[yn]+V2[Pn],++le[257+yn],++me[Pn],he=_e+Le,++we}else oe[We++]=e[_e],++le[e[_e]]}}for(_e=Math.max(_e,he);_e<a;++_e)oe[We++]=e[_e],++le[e[_e]];_=oP(e,f,m,oe,le,me,ue,We,de,_e-de,_),m||(l.r=_&7|f[_/8|0]<<3,_-=7,l.h=W,l.p=z,l.i=_e,l.w=he)}else{for(var _e=l.w||0;_e<a+m;_e+=65535){var De=_e+65535;De>=a&&(f[_/8|0]=m,De=a),_=Rk(f,_+1,e.subarray(_e,De))}l.i=a}return Ok(o,0,r+IC(_)+i)},Nk=function(){var e=1,t=0;return{p:function(n){for(var r=e,i=t,l=n.length|0,a=0;a!=l;){for(var o=Math.min(a+2655,l);a<o;++a)i+=r+=n[a];r=(r&65535)+15*(r>>16),i=(i&65535)+15*(i>>16)}e=r,t=i},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},Z$=function(e,t,n,r,i){if(!i&&(i={l:1},t.dictionary)){var l=t.dictionary.subarray(-32768),a=new th(l.length+e.length);a.set(l),a.set(e,l.length),e=a,i.w=l.length}return W$(e,t.level==null?6:t.level,t.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,n,r,i)},Fk=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},K$=function(e,t){var n=t.level,r=n==0?0:n<6?1:n==9?3:2;if(e[0]=120,e[1]=r<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var i=Nk();i.p(t.dictionary),Fk(e,2,i.d())}},Y$=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&Jd(6,"invalid zlib data"),(e[1]>>5&1)==1&&Jd(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function i3(e,t){t||(t={});var n=Nk();n.p(e);var r=Z$(e,t,t.dictionary?6:2,4);return K$(r,t),Fk(r,r.length-4,n.d()),r}function X$(e,t){return H$(e.subarray(Y$(e),-4),{i:2},t,t)}var J$=typeof TextDecoder<"u"&&new TextDecoder,Q$=0;try{J$.decode(Bk,{stream:!0}),Q$=1}catch{}var ts=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function U5(){ts.console&&typeof ts.console.log=="function"&&ts.console.log.apply(ts.console,arguments)}var xa={log:U5,warn:function(e){ts.console&&(typeof ts.console.warn=="function"?ts.console.warn.apply(ts.console,arguments):U5.call(null,arguments))},error:function(e){ts.console&&(typeof ts.console.error=="function"?ts.console.error.apply(ts.console,arguments):U5(e))}};function V5(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){rg(r.response,t,n)},r.onerror=function(){xa.error("could not download file")},r.send()}function aP(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function xb(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var Kv,s3,rg=ts.saveAs||((typeof window>"u"?"undefined":Xo(window))!=="object"||window!==ts?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,n){var r=ts.URL||ts.webkitURL,i=document.createElement("a");t=t||e.name||"download",i.download=t,i.rel="noopener",typeof e=="string"?(i.href=e,i.origin!==location.origin?aP(i.href)?V5(e,t,n):xb(i,i.target="_blank"):xb(i)):(i.href=r.createObjectURL(e),setTimeout(function(){r.revokeObjectURL(i.href)},4e4),setTimeout(function(){xb(i)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,n){if(t=t||e.name||"download",typeof e=="string")if(aP(e))V5(e,t,n);else{var r=document.createElement("a");r.href=e,r.target="_blank",setTimeout(function(){xb(r)})}else navigator.msSaveOrOpenBlob(function(i,l){return l===void 0?l={autoBom:!1}:Xo(l)!=="object"&&(xa.warn("Deprecated: Expected third argument to be a object"),l={autoBom:!l}),l.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(e,n),t)}:function(e,t,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof e=="string")return V5(e,t,n);var i=e.type==="application/octet-stream",l=/constructor/i.test(ts.HTMLElement)||ts.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||i&&l)&&(typeof FileReader>"u"?"undefined":Xo(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var _=o.result;_=a?_:_.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=_:location=_,r=null},o.readAsDataURL(e)}else{var f=ts.URL||ts.webkitURL,m=f.createObjectURL(e);r?r.location=m:location.href=m,r=null,setTimeout(function(){f.revokeObjectURL(m)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function zk(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],r=0;r<n.length;r++){var i=n[r].re,l=n[r].process,a=i.exec(e);a&&(t=l(a),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),f=this.g.toString(16),m=this.b.toString(16);return o.length==1&&(o="0"+o),f.length==1&&(f="0"+f),m.length==1&&(m="0"+m),"#"+o+f+m}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function $5(e,t){var n=e[0],r=e[1],i=e[2],l=e[3];n=qc(n,r,i,l,t[0],7,-680876936),l=qc(l,n,r,i,t[1],12,-389564586),i=qc(i,l,n,r,t[2],17,606105819),r=qc(r,i,l,n,t[3],22,-1044525330),n=qc(n,r,i,l,t[4],7,-176418897),l=qc(l,n,r,i,t[5],12,1200080426),i=qc(i,l,n,r,t[6],17,-1473231341),r=qc(r,i,l,n,t[7],22,-45705983),n=qc(n,r,i,l,t[8],7,1770035416),l=qc(l,n,r,i,t[9],12,-1958414417),i=qc(i,l,n,r,t[10],17,-42063),r=qc(r,i,l,n,t[11],22,-1990404162),n=qc(n,r,i,l,t[12],7,1804603682),l=qc(l,n,r,i,t[13],12,-40341101),i=qc(i,l,n,r,t[14],17,-1502002290),n=Wc(n,r=qc(r,i,l,n,t[15],22,1236535329),i,l,t[1],5,-165796510),l=Wc(l,n,r,i,t[6],9,-1069501632),i=Wc(i,l,n,r,t[11],14,643717713),r=Wc(r,i,l,n,t[0],20,-373897302),n=Wc(n,r,i,l,t[5],5,-701558691),l=Wc(l,n,r,i,t[10],9,38016083),i=Wc(i,l,n,r,t[15],14,-660478335),r=Wc(r,i,l,n,t[4],20,-405537848),n=Wc(n,r,i,l,t[9],5,568446438),l=Wc(l,n,r,i,t[14],9,-1019803690),i=Wc(i,l,n,r,t[3],14,-187363961),r=Wc(r,i,l,n,t[8],20,1163531501),n=Wc(n,r,i,l,t[13],5,-1444681467),l=Wc(l,n,r,i,t[2],9,-51403784),i=Wc(i,l,n,r,t[7],14,1735328473),n=Zc(n,r=Wc(r,i,l,n,t[12],20,-1926607734),i,l,t[5],4,-378558),l=Zc(l,n,r,i,t[8],11,-2022574463),i=Zc(i,l,n,r,t[11],16,1839030562),r=Zc(r,i,l,n,t[14],23,-35309556),n=Zc(n,r,i,l,t[1],4,-1530992060),l=Zc(l,n,r,i,t[4],11,1272893353),i=Zc(i,l,n,r,t[7],16,-155497632),r=Zc(r,i,l,n,t[10],23,-1094730640),n=Zc(n,r,i,l,t[13],4,681279174),l=Zc(l,n,r,i,t[0],11,-358537222),i=Zc(i,l,n,r,t[3],16,-722521979),r=Zc(r,i,l,n,t[6],23,76029189),n=Zc(n,r,i,l,t[9],4,-640364487),l=Zc(l,n,r,i,t[12],11,-421815835),i=Zc(i,l,n,r,t[15],16,530742520),n=Kc(n,r=Zc(r,i,l,n,t[2],23,-995338651),i,l,t[0],6,-198630844),l=Kc(l,n,r,i,t[7],10,1126891415),i=Kc(i,l,n,r,t[14],15,-1416354905),r=Kc(r,i,l,n,t[5],21,-57434055),n=Kc(n,r,i,l,t[12],6,1700485571),l=Kc(l,n,r,i,t[3],10,-1894986606),i=Kc(i,l,n,r,t[10],15,-1051523),r=Kc(r,i,l,n,t[1],21,-2054922799),n=Kc(n,r,i,l,t[8],6,1873313359),l=Kc(l,n,r,i,t[15],10,-30611744),i=Kc(i,l,n,r,t[6],15,-1560198380),r=Kc(r,i,l,n,t[13],21,1309151649),n=Kc(n,r,i,l,t[4],6,-145523070),l=Kc(l,n,r,i,t[11],10,-1120210379),i=Kc(i,l,n,r,t[2],15,718787259),r=Kc(r,i,l,n,t[9],21,-343485551),e[0]=rm(n,e[0]),e[1]=rm(r,e[1]),e[2]=rm(i,e[2]),e[3]=rm(l,e[3])}function $2(e,t,n,r,i,l){return t=rm(rm(t,e),rm(r,l)),rm(t<<i|t>>>32-i,n)}function qc(e,t,n,r,i,l,a){return $2(t&n|~t&r,e,t,i,l,a)}function Wc(e,t,n,r,i,l,a){return $2(t&r|n&~r,e,t,i,l,a)}function Zc(e,t,n,r,i,l,a){return $2(t^n^r,e,t,i,l,a)}function Kc(e,t,n,r,i,l,a){return $2(n^(t|~r),e,t,i,l,a)}function jk(e){var t,n=e.length,r=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)$5(r,eG(e.substring(t-64,t)));e=e.substring(t-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)i[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for($5(r,i),t=0;t<16;t++)i[t]=0;return i[14]=8*n,$5(r,i),r}function eG(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}Kv=ts.atob.bind(ts),s3=ts.btoa.bind(ts);var lP="0123456789abcdef".split("");function tG(e){for(var t="",n=0;n<4;n++)t+=lP[e>>8*n+4&15]+lP[e>>8*n&15];return t}function nG(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function o3(e){return jk(e).map(nG).join("")}var rG=function(e){for(var t=0;t<e.length;t++)e[t]=tG(e[t]);return e.join("")}(jk("hello"))!="5d41402abc4b2a76b9719d911017c592";function rm(e,t){if(rG){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function a3(e,t){var n,r,i,l;if(e!==n){for(var a=(i=e,l=1+(256/e.length>>0),new Array(l+1).join(i)),o=[],f=0;f<256;f++)o[f]=f;var m=0;for(f=0;f<256;f++){var _=o[f];m=(m+_+a.charCodeAt(f))%256,o[f]=o[m],o[m]=_}n=e,r=o}else o=r;var w=t.length,M=0,C=0,R="";for(f=0;f<w;f++)C=(C+(_=o[M=(M+1)%256]))%256,o[M]=o[C],o[C]=_,a=o[(o[M]+o[C])%256],R+=String.fromCharCode(t.charCodeAt(f)^a);return R}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var uP={print:4,modify:8,copy:16,"annot-forms":32};function w0(e,t,n,r){this.v=1,this.r=2;var i=192;e.forEach(function(o){if(uP.perm!==void 0)throw new Error("Invalid permission: "+o);i+=uP[o]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var l=(t+this.padding).substr(0,32),a=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(l,a),this.P=-(1+(255^i)),this.encryptionKey=o3(l+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=a3(this.encryptionKey,this.padding)}function C0(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",n=e.length,r=0;r<n;r++){var i=e.charCodeAt(r);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?t+="#"+("0"+i.toString(16)).slice(-2):t+=e[r]}return t}function cP(e){if(Xo(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(n,r,i){if(i=i||!1,typeof n!="string"||typeof r!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(n)||(t[n]={});var l=Math.random().toString(35);return t[n][l]=[r,!!i],l},this.unsubscribe=function(n){for(var r in t)if(t[r][n])return delete t[r][n],Object.keys(t[r]).length===0&&delete t[r],!0;return!1},this.publish=function(n){if(t.hasOwnProperty(n)){var r=Array.prototype.slice.call(arguments,1),i=[];for(var l in t[n]){var a=t[n][l];try{a[0].apply(e,r)}catch(o){ts.console&&xa.error("jsPDF PubSub Error",o.message,o)}a[1]&&i.push(l)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Hx(e){if(!(this instanceof Hx))return new Hx(e);var t="opacity,stroke-opacity".split(",");for(var n in e)e.hasOwnProperty(n)&&t.indexOf(n)>=0&&(this[n]=e[n]);this.id="",this.objectNumber=-1}function Uk(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function lg(e,t,n,r,i){if(!(this instanceof lg))return new lg(e,t,n,r,i);this.type=e==="axial"?2:3,this.coords=t,this.colors=n,Uk.call(this,r,i)}function P0(e,t,n,r,i){if(!(this instanceof P0))return new P0(e,t,n,r,i);this.boundingBox=e,this.xStep=t,this.yStep=n,this.stream="",this.cloneIndex=0,Uk.call(this,r,i)}function es(e){var t,n=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],i=arguments[2],l=arguments[3],a=[],o=1,f=16,m="S",_=null;Xo(e=e||{})==="object"&&(n=e.orientation,r=e.unit||r,i=e.format||i,l=e.compress||e.compressPdf||l,(_=e.encryption||null)!==null&&(_.userPassword=_.userPassword||"",_.ownerPassword=_.ownerPassword||"",_.userPermissions=_.userPermissions||[]),o=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(f=e.floatPrecision),m=e.defaultPathOperation||"S"),a=e.filters||(l===!0?["FlateEncode"]:a),r=r||"mm",n=(""+(n||"P")).toLowerCase();var w=e.putOnlyUsedFonts||!1,M={},C={internal:{},__private__:{}};C.__private__.PubSub=cP;var R="1.3",z=C.__private__.getPdfVersion=function(){return R};C.__private__.setPdfVersion=function(J){R=J};var W={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};C.__private__.getPageFormats=function(){return W};var X=C.__private__.getPageFormat=function(J){return W[J]};i=i||"a4";var Y={COMPAT:"compat",ADVANCED:"advanced"},Q=Y.COMPAT;function oe(){this.saveGraphicsState(),Ce(new vt(Kt,0,0,-Kt,0,il()*Kt).toString()+" cm"),this.setFontSize(this.getFontSize()/Kt),m="n",Q=Y.ADVANCED}function le(){this.restoreGraphicsState(),m="S",Q=Y.COMPAT}var me=C.__private__.combineFontStyleAndFontWeight=function(J,Xe){if(J=="bold"&&Xe=="normal"||J=="bold"&&Xe==400||J=="normal"&&Xe=="italic"||J=="bold"&&Xe=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Xe&&(J=Xe==400||Xe==="normal"?J==="italic"?"italic":"normal":Xe!=700&&Xe!=="bold"||J!=="normal"?(Xe==700?"bold":Xe)+""+J:"bold"),J};C.advancedAPI=function(J){var Xe=Q===Y.COMPAT;return Xe&&oe.call(this),typeof J!="function"||(J(this),Xe&&le.call(this)),this},C.compatAPI=function(J){var Xe=Q===Y.ADVANCED;return Xe&&le.call(this),typeof J!="function"||(J(this),Xe&&oe.call(this)),this},C.isAdvancedAPI=function(){return Q===Y.ADVANCED};var we,ue=function(J){if(Q!==Y.ADVANCED)throw new Error(J+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},_e=C.roundToPrecision=C.__private__.roundToPrecision=function(J,Xe){var Bt=t||Xe;if(isNaN(J)||isNaN(Bt))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return J.toFixed(Bt).replace(/0+$/,"")};we=C.hpf=C.__private__.hpf=typeof f=="number"?function(J){if(isNaN(J))throw new Error("Invalid argument passed to jsPDF.hpf");return _e(J,f)}:f==="smart"?function(J){if(isNaN(J))throw new Error("Invalid argument passed to jsPDF.hpf");return _e(J,J>-1&&J<1?16:5)}:function(J){if(isNaN(J))throw new Error("Invalid argument passed to jsPDF.hpf");return _e(J,16)};var We=C.f2=C.__private__.f2=function(J){if(isNaN(J))throw new Error("Invalid argument passed to jsPDF.f2");return _e(J,2)},he=C.__private__.f3=function(J){if(isNaN(J))throw new Error("Invalid argument passed to jsPDF.f3");return _e(J,3)},de=C.scale=C.__private__.scale=function(J){if(isNaN(J))throw new Error("Invalid argument passed to jsPDF.scale");return Q===Y.COMPAT?J*Kt:Q===Y.ADVANCED?J:void 0},Te=function(J){return Q===Y.COMPAT?il()-J:Q===Y.ADVANCED?J:void 0},be=function(J){return de(Te(J))};C.__private__.setPrecision=C.setPrecision=function(J){typeof parseInt(J,10)=="number"&&(t=parseInt(J,10))};var ae,ne="00000000000000000000000000000000",Se=C.__private__.getFileId=function(){return ne},Le=C.__private__.setFileId=function(J){return ne=J!==void 0&&/^[a-fA-F0-9]{32}$/.test(J)?J.toUpperCase():ne.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),_!==null&&(us=new w0(_.userPermissions,_.userPassword,_.ownerPassword,ne)),ne};C.setFileId=function(J){return Le(J),this},C.getFileId=function(){return Se()};var ze=C.__private__.convertDateToPDFDate=function(J){var Xe=J.getTimezoneOffset(),Bt=Xe<0?"+":"-",nn=Math.floor(Math.abs(Xe/60)),An=Math.abs(Xe%60),Xn=[Bt,Ne(nn),"'",Ne(An),"'"].join("");return["D:",J.getFullYear(),Ne(J.getMonth()+1),Ne(J.getDate()),Ne(J.getHours()),Ne(J.getMinutes()),Ne(J.getSeconds()),Xn].join("")},He=C.__private__.convertPDFDateToDate=function(J){var Xe=parseInt(J.substr(2,4),10),Bt=parseInt(J.substr(6,2),10)-1,nn=parseInt(J.substr(8,2),10),An=parseInt(J.substr(10,2),10),Xn=parseInt(J.substr(12,2),10),wr=parseInt(J.substr(14,2),10);return new Date(Xe,Bt,nn,An,Xn,wr,0)},pt=C.__private__.setCreationDate=function(J){var Xe;if(J===void 0&&(J=new Date),J instanceof Date)Xe=ze(J);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(J))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Xe=J}return ae=Xe},ge=C.__private__.getCreationDate=function(J){var Xe=ae;return J==="jsDate"&&(Xe=He(ae)),Xe};C.setCreationDate=function(J){return pt(J),this},C.getCreationDate=function(J){return ge(J)};var Ie,Ne=C.__private__.padd2=function(J){return("0"+parseInt(J)).slice(-2)},Ve=C.__private__.padd2Hex=function(J){return("00"+(J=J.toString())).substr(J.length)},it=0,lt=[],Mt=[],wt=0,rn=[],yn=[],Pn=!1,De=Mt,Ae=function(){it=0,wt=0,Mt=[],lt=[],rn=[],Hn=Cn(),or=Cn()};C.__private__.setCustomOutputDestination=function(J){Pn=!0,De=J};var Be=function(J){Pn||(De=J)};C.__private__.resetCustomOutputDestination=function(){Pn=!1,De=Mt};var Ce=C.__private__.out=function(J){return J=J.toString(),wt+=J.length+1,De.push(J),De},ot=C.__private__.write=function(J){return Ce(arguments.length===1?J.toString():Array.prototype.join.call(arguments," "))},Dt=C.__private__.getArrayBuffer=function(J){for(var Xe=J.length,Bt=new ArrayBuffer(Xe),nn=new Uint8Array(Bt);Xe--;)nn[Xe]=J.charCodeAt(Xe);return Bt},Zt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];C.__private__.getStandardFonts=function(){return Zt};var an=e.fontSize||16;C.__private__.setFontSize=C.setFontSize=function(J){return an=Q===Y.ADVANCED?J/Kt:J,this};var ln,vn=C.__private__.getFontSize=C.getFontSize=function(){return Q===Y.COMPAT?an:an*Kt},qn=e.R2L||!1;C.__private__.setR2L=C.setR2L=function(J){return qn=J,this},C.__private__.getR2L=C.getR2L=function(){return qn};var Kn,cr=C.__private__.setZoomMode=function(J){var Xe=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(J))ln=J;else if(isNaN(J)){if(Xe.indexOf(J)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+J+'" is not recognized.');ln=J}else ln=parseInt(J,10)};C.__private__.getZoomMode=function(){return ln};var pr,Dr=C.__private__.setPageMode=function(J){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(J)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+J+'" is not recognized.');Kn=J};C.__private__.getPageMode=function(){return Kn};var zr=C.__private__.setLayoutMode=function(J){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(J)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+J+'" is not recognized.');pr=J};C.__private__.getLayoutMode=function(){return pr},C.__private__.setDisplayMode=C.setDisplayMode=function(J,Xe,Bt){return cr(J),zr(Xe),Dr(Bt),this};var Ht={title:"",subject:"",author:"",keywords:"",creator:""};C.__private__.getDocumentProperty=function(J){if(Object.keys(Ht).indexOf(J)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ht[J]},C.__private__.getDocumentProperties=function(){return Ht},C.__private__.setDocumentProperties=C.setProperties=C.setDocumentProperties=function(J){for(var Xe in Ht)Ht.hasOwnProperty(Xe)&&J[Xe]&&(Ht[Xe]=J[Xe]);return this},C.__private__.setDocumentProperty=function(J,Xe){if(Object.keys(Ht).indexOf(J)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ht[J]=Xe};var tn,Kt,Yn,ir,Fr,Ft={},je={},Ze=[],et={},ct={},$e={},Gt={},hn=null,Ot=0,cn=[],En=new cP(C),wn=e.hotfixes||[],Qn={},Lr={},Yt=[],vt=function J(Xe,Bt,nn,An,Xn,wr){if(!(this instanceof J))return new J(Xe,Bt,nn,An,Xn,wr);isNaN(Xe)&&(Xe=1),isNaN(Bt)&&(Bt=0),isNaN(nn)&&(nn=0),isNaN(An)&&(An=1),isNaN(Xn)&&(Xn=0),isNaN(wr)&&(wr=0),this._matrix=[Xe,Bt,nn,An,Xn,wr]};Object.defineProperty(vt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(J){this._matrix[0]=J}}),Object.defineProperty(vt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(J){this._matrix[1]=J}}),Object.defineProperty(vt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(J){this._matrix[2]=J}}),Object.defineProperty(vt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(J){this._matrix[3]=J}}),Object.defineProperty(vt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(J){this._matrix[4]=J}}),Object.defineProperty(vt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(J){this._matrix[5]=J}}),Object.defineProperty(vt.prototype,"a",{get:function(){return this._matrix[0]},set:function(J){this._matrix[0]=J}}),Object.defineProperty(vt.prototype,"b",{get:function(){return this._matrix[1]},set:function(J){this._matrix[1]=J}}),Object.defineProperty(vt.prototype,"c",{get:function(){return this._matrix[2]},set:function(J){this._matrix[2]=J}}),Object.defineProperty(vt.prototype,"d",{get:function(){return this._matrix[3]},set:function(J){this._matrix[3]=J}}),Object.defineProperty(vt.prototype,"e",{get:function(){return this._matrix[4]},set:function(J){this._matrix[4]=J}}),Object.defineProperty(vt.prototype,"f",{get:function(){return this._matrix[5]},set:function(J){this._matrix[5]=J}}),Object.defineProperty(vt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(vt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(vt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(vt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),vt.prototype.join=function(J){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(we).join(J)},vt.prototype.multiply=function(J){var Xe=J.sx*this.sx+J.shy*this.shx,Bt=J.sx*this.shy+J.shy*this.sy,nn=J.shx*this.sx+J.sy*this.shx,An=J.shx*this.shy+J.sy*this.sy,Xn=J.tx*this.sx+J.ty*this.shx+this.tx,wr=J.tx*this.shy+J.ty*this.sy+this.ty;return new vt(Xe,Bt,nn,An,Xn,wr)},vt.prototype.decompose=function(){var J=this.sx,Xe=this.shy,Bt=this.shx,nn=this.sy,An=this.tx,Xn=this.ty,wr=Math.sqrt(J*J+Xe*Xe),Wr=(J/=wr)*Bt+(Xe/=wr)*nn;Bt-=J*Wr,nn-=Xe*Wr;var Zr=Math.sqrt(Bt*Bt+nn*nn);return Wr/=Zr,J*(nn/=Zr)<Xe*(Bt/=Zr)&&(J=-J,Xe=-Xe,Wr=-Wr,wr=-wr),{scale:new vt(wr,0,0,Zr,0,0),translate:new vt(1,0,0,1,An,Xn),rotate:new vt(J,Xe,-Xe,J,0,0),skew:new vt(1,0,Wr,1,0,0)}},vt.prototype.toString=function(J){return this.join(" ")},vt.prototype.inversed=function(){var J=this.sx,Xe=this.shy,Bt=this.shx,nn=this.sy,An=this.tx,Xn=this.ty,wr=1/(J*nn-Xe*Bt),Wr=nn*wr,Zr=-Xe*wr,fi=-Bt*wr,Pi=J*wr;return new vt(Wr,Zr,fi,Pi,-Wr*An-fi*Xn,-Zr*An-Pi*Xn)},vt.prototype.applyToPoint=function(J){var Xe=J.x*this.sx+J.y*this.shx+this.tx,Bt=J.x*this.shy+J.y*this.sy+this.ty;return new Po(Xe,Bt)},vt.prototype.applyToRectangle=function(J){var Xe=this.applyToPoint(J),Bt=this.applyToPoint(new Po(J.x+J.w,J.y+J.h));return new Fl(Xe.x,Xe.y,Bt.x-Xe.x,Bt.y-Xe.y)},vt.prototype.clone=function(){var J=this.sx,Xe=this.shy,Bt=this.shx,nn=this.sy,An=this.tx,Xn=this.ty;return new vt(J,Xe,Bt,nn,An,Xn)},C.Matrix=vt;var Tn=C.matrixMult=function(J,Xe){return Xe.multiply(J)},bn=new vt(1,0,0,1,0,0);C.unitMatrix=C.identityMatrix=bn;var br=function(J,Xe){if(!ct[J]){var Bt=(Xe instanceof lg?"Sh":"P")+(Object.keys(et).length+1).toString(10);Xe.id=Bt,ct[J]=Bt,et[Bt]=Xe,En.publish("addPattern",Xe)}};C.ShadingPattern=lg,C.TilingPattern=P0,C.addShadingPattern=function(J,Xe){return ue("addShadingPattern()"),br(J,Xe),this},C.beginTilingPattern=function(J){ue("beginTilingPattern()"),Va(J.boundingBox[0],J.boundingBox[1],J.boundingBox[2]-J.boundingBox[0],J.boundingBox[3]-J.boundingBox[1],J.matrix)},C.endTilingPattern=function(J,Xe){ue("endTilingPattern()"),Xe.stream=yn[Ie].join(`
`),br(J,Xe),En.publish("endTilingPattern",Xe),Yt.pop().restore()};var vr=C.__private__.newObject=function(){var J=Cn();return pn(J,!0),J},Cn=C.__private__.newObjectDeferred=function(){return it++,lt[it]=function(){return wt},it},pn=function(J,Xe){return Xe=typeof Xe=="boolean"&&Xe,lt[J]=wt,Xe&&Ce(J+" 0 obj"),J},Ut=C.__private__.newAdditionalObject=function(){var J={objId:Cn(),content:""};return rn.push(J),J},Hn=Cn(),or=Cn(),Xr=C.__private__.decodeColorString=function(J){var Xe=J.split(" ");if(Xe.length!==2||Xe[1]!=="g"&&Xe[1]!=="G")Xe.length===5&&(Xe[4]==="k"||Xe[4]==="K")&&(Xe=[(1-Xe[0])*(1-Xe[3]),(1-Xe[1])*(1-Xe[3]),(1-Xe[2])*(1-Xe[3]),"r"]);else{var Bt=parseFloat(Xe[0]);Xe=[Bt,Bt,Bt,"r"]}for(var nn="#",An=0;An<3;An++)nn+=("0"+Math.floor(255*parseFloat(Xe[An])).toString(16)).slice(-2);return nn},ri=C.__private__.encodeColorString=function(J){var Xe;typeof J=="string"&&(J={ch1:J});var Bt=J.ch1,nn=J.ch2,An=J.ch3,Xn=J.ch4,wr=J.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Bt=="string"&&Bt.charAt(0)!=="#"){var Wr=new zk(Bt);if(Wr.ok)Bt=Wr.toHex();else if(!/^\d*\.?\d*$/.test(Bt))throw new Error('Invalid color "'+Bt+'" passed to jsPDF.encodeColorString.')}if(typeof Bt=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Bt)&&(Bt="#"+Bt[1]+Bt[1]+Bt[2]+Bt[2]+Bt[3]+Bt[3]),typeof Bt=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Bt)){var Zr=parseInt(Bt.substr(1),16);Bt=Zr>>16&255,nn=Zr>>8&255,An=255&Zr}if(nn===void 0||Xn===void 0&&Bt===nn&&nn===An)if(typeof Bt=="string")Xe=Bt+" "+wr[0];else switch(J.precision){case 2:Xe=We(Bt/255)+" "+wr[0];break;case 3:default:Xe=he(Bt/255)+" "+wr[0]}else if(Xn===void 0||Xo(Xn)==="object"){if(Xn&&!isNaN(Xn.a)&&Xn.a===0)return Xe=["1.","1.","1.",wr[1]].join(" ");if(typeof Bt=="string")Xe=[Bt,nn,An,wr[1]].join(" ");else switch(J.precision){case 2:Xe=[We(Bt/255),We(nn/255),We(An/255),wr[1]].join(" ");break;default:case 3:Xe=[he(Bt/255),he(nn/255),he(An/255),wr[1]].join(" ")}}else if(typeof Bt=="string")Xe=[Bt,nn,An,Xn,wr[2]].join(" ");else switch(J.precision){case 2:Xe=[We(Bt),We(nn),We(An),We(Xn),wr[2]].join(" ");break;case 3:default:Xe=[he(Bt),he(nn),he(An),he(Xn),wr[2]].join(" ")}return Xe},ai=C.__private__.getFilters=function(){return a},Pr=C.__private__.putStream=function(J){var Xe=(J=J||{}).data||"",Bt=J.filters||ai(),nn=J.alreadyAppliedFilters||[],An=J.addLength1||!1,Xn=Xe.length,wr=J.objectId,Wr=function(co){return co};if(_!==null&&wr===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");_!==null&&(Wr=us.encryptor(wr,0));var Zr={};Bt===!0&&(Bt=["FlateEncode"]);var fi=J.additionalKeyValues||[],Pi=(Zr=es.API.processDataByFilters!==void 0?es.API.processDataByFilters(Xe,Bt):{data:Xe,reverseChain:[]}).reverseChain+(Array.isArray(nn)?nn.join(" "):nn.toString());if(Zr.data.length!==0&&(fi.push({key:"Length",value:Zr.data.length}),An===!0&&fi.push({key:"Length1",value:Xn})),Pi.length!=0)if(Pi.split("/").length-1==1)fi.push({key:"Filter",value:Pi});else{fi.push({key:"Filter",value:"["+Pi+"]"});for(var Xi=0;Xi<fi.length;Xi+=1)if(fi[Xi].key==="DecodeParms"){for(var js=[],cs=0;cs<Zr.reverseChain.split("/").length-1;cs+=1)js.push("null");js.push(fi[Xi].value),fi[Xi].value="["+js.join(" ")+"]"}}Ce("<<");for(var _s=0;_s<fi.length;_s++)Ce("/"+fi[_s].key+" "+fi[_s].value);Ce(">>"),Zr.data.length!==0&&(Ce("stream"),Ce(Wr(Zr.data)),Ce("endstream"))},As=C.__private__.putPage=function(J){var Xe=J.number,Bt=J.data,nn=J.objId,An=J.contentsObjId;pn(nn,!0),Ce("<</Type /Page"),Ce("/Parent "+J.rootDictionaryObjId+" 0 R"),Ce("/Resources "+J.resourceDictionaryObjId+" 0 R"),Ce("/MediaBox ["+parseFloat(we(J.mediaBox.bottomLeftX))+" "+parseFloat(we(J.mediaBox.bottomLeftY))+" "+we(J.mediaBox.topRightX)+" "+we(J.mediaBox.topRightY)+"]"),J.cropBox!==null&&Ce("/CropBox ["+we(J.cropBox.bottomLeftX)+" "+we(J.cropBox.bottomLeftY)+" "+we(J.cropBox.topRightX)+" "+we(J.cropBox.topRightY)+"]"),J.bleedBox!==null&&Ce("/BleedBox ["+we(J.bleedBox.bottomLeftX)+" "+we(J.bleedBox.bottomLeftY)+" "+we(J.bleedBox.topRightX)+" "+we(J.bleedBox.topRightY)+"]"),J.trimBox!==null&&Ce("/TrimBox ["+we(J.trimBox.bottomLeftX)+" "+we(J.trimBox.bottomLeftY)+" "+we(J.trimBox.topRightX)+" "+we(J.trimBox.topRightY)+"]"),J.artBox!==null&&Ce("/ArtBox ["+we(J.artBox.bottomLeftX)+" "+we(J.artBox.bottomLeftY)+" "+we(J.artBox.topRightX)+" "+we(J.artBox.topRightY)+"]"),typeof J.userUnit=="number"&&J.userUnit!==1&&Ce("/UserUnit "+J.userUnit),En.publish("putPage",{objId:nn,pageContext:cn[Xe],pageNumber:Xe,page:Bt}),Ce("/Contents "+An+" 0 R"),Ce(">>"),Ce("endobj");var Xn=Bt.join(`
`);return Q===Y.ADVANCED&&(Xn+=`
Q`),pn(An,!0),Pr({data:Xn,filters:ai(),objectId:An}),Ce("endobj"),nn},$i=C.__private__.putPages=function(){var J,Xe,Bt=[];for(J=1;J<=Ot;J++)cn[J].objId=Cn(),cn[J].contentsObjId=Cn();for(J=1;J<=Ot;J++)Bt.push(As({number:J,data:yn[J],objId:cn[J].objId,contentsObjId:cn[J].contentsObjId,mediaBox:cn[J].mediaBox,cropBox:cn[J].cropBox,bleedBox:cn[J].bleedBox,trimBox:cn[J].trimBox,artBox:cn[J].artBox,userUnit:cn[J].userUnit,rootDictionaryObjId:Hn,resourceDictionaryObjId:or}));pn(Hn,!0),Ce("<</Type /Pages");var nn="/Kids [";for(Xe=0;Xe<Ot;Xe++)nn+=Bt[Xe]+" 0 R ";Ce(nn+"]"),Ce("/Count "+Ot),Ce(">>"),Ce("endobj"),En.publish("postPutPages")},Qa=function(J){En.publish("putFont",{font:J,out:Ce,newObject:vr,putStream:Pr}),J.isAlreadyPutted!==!0&&(J.objectNumber=vr(),Ce("<<"),Ce("/Type /Font"),Ce("/BaseFont /"+C0(J.postScriptName)),Ce("/Subtype /Type1"),typeof J.encoding=="string"&&Ce("/Encoding /"+J.encoding),Ce("/FirstChar 32"),Ce("/LastChar 255"),Ce(">>"),Ce("endobj"))},pi=function(){for(var J in Ft)Ft.hasOwnProperty(J)&&(w===!1||w===!0&&M.hasOwnProperty(J))&&Qa(Ft[J])},Li=function(J){J.objectNumber=vr();var Xe=[];Xe.push({key:"Type",value:"/XObject"}),Xe.push({key:"Subtype",value:"/Form"}),Xe.push({key:"BBox",value:"["+[we(J.x),we(J.y),we(J.x+J.width),we(J.y+J.height)].join(" ")+"]"}),Xe.push({key:"Matrix",value:"["+J.matrix.toString()+"]"});var Bt=J.pages[1].join(`
`);Pr({data:Bt,additionalKeyValues:Xe,objectId:J.objectNumber}),Ce("endobj")},Yi=function(){for(var J in Qn)Qn.hasOwnProperty(J)&&Li(Qn[J])},ns=function(J,Xe){var Bt,nn=[],An=1/(Xe-1);for(Bt=0;Bt<1;Bt+=An)nn.push(Bt);if(nn.push(1),J[0].offset!=0){var Xn={offset:0,color:J[0].color};J.unshift(Xn)}if(J[J.length-1].offset!=1){var wr={offset:1,color:J[J.length-1].color};J.push(wr)}for(var Wr="",Zr=0,fi=0;fi<nn.length;fi++){for(Bt=nn[fi];Bt>J[Zr+1].offset;)Zr++;var Pi=J[Zr].offset,Xi=(Bt-Pi)/(J[Zr+1].offset-Pi),js=J[Zr].color,cs=J[Zr+1].color;Wr+=Ve(Math.round((1-Xi)*js[0]+Xi*cs[0]).toString(16))+Ve(Math.round((1-Xi)*js[1]+Xi*cs[1]).toString(16))+Ve(Math.round((1-Xi)*js[2]+Xi*cs[2]).toString(16))}return Wr.trim()},ao=function(J,Xe){Xe||(Xe=21);var Bt=vr(),nn=ns(J.colors,Xe),An=[];An.push({key:"FunctionType",value:"0"}),An.push({key:"Domain",value:"[0.0 1.0]"}),An.push({key:"Size",value:"["+Xe+"]"}),An.push({key:"BitsPerSample",value:"8"}),An.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),An.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Pr({data:nn,additionalKeyValues:An,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Bt}),Ce("endobj"),J.objectNumber=vr(),Ce("<< /ShadingType "+J.type),Ce("/ColorSpace /DeviceRGB");var Xn="/Coords ["+we(parseFloat(J.coords[0]))+" "+we(parseFloat(J.coords[1]))+" ";J.type===2?Xn+=we(parseFloat(J.coords[2]))+" "+we(parseFloat(J.coords[3])):Xn+=we(parseFloat(J.coords[2]))+" "+we(parseFloat(J.coords[3]))+" "+we(parseFloat(J.coords[4]))+" "+we(parseFloat(J.coords[5])),Ce(Xn+="]"),J.matrix&&Ce("/Matrix ["+J.matrix.toString()+"]"),Ce("/Function "+Bt+" 0 R"),Ce("/Extend [true true]"),Ce(">>"),Ce("endobj")},wc=function(J,Xe){var Bt=Cn(),nn=vr();Xe.push({resourcesOid:Bt,objectOid:nn}),J.objectNumber=nn;var An=[];An.push({key:"Type",value:"/Pattern"}),An.push({key:"PatternType",value:"1"}),An.push({key:"PaintType",value:"1"}),An.push({key:"TilingType",value:"1"}),An.push({key:"BBox",value:"["+J.boundingBox.map(we).join(" ")+"]"}),An.push({key:"XStep",value:we(J.xStep)}),An.push({key:"YStep",value:we(J.yStep)}),An.push({key:"Resources",value:Bt+" 0 R"}),J.matrix&&An.push({key:"Matrix",value:"["+J.matrix.toString()+"]"}),Pr({data:J.stream,additionalKeyValues:An,objectId:J.objectNumber}),Ce("endobj")},Wu=function(J){var Xe;for(Xe in et)et.hasOwnProperty(Xe)&&(et[Xe]instanceof lg?ao(et[Xe]):et[Xe]instanceof P0&&wc(et[Xe],J))},el=function(J){for(var Xe in J.objectNumber=vr(),Ce("<<"),J)switch(Xe){case"opacity":Ce("/ca "+We(J[Xe]));break;case"stroke-opacity":Ce("/CA "+We(J[Xe]))}Ce(">>"),Ce("endobj")},Au=function(){var J;for(J in $e)$e.hasOwnProperty(J)&&el($e[J])},Zu=function(){for(var J in Ce("/XObject <<"),Qn)Qn.hasOwnProperty(J)&&Qn[J].objectNumber>=0&&Ce("/"+J+" "+Qn[J].objectNumber+" 0 R");En.publish("putXobjectDict"),Ce(">>")},Ku=function(){us.oid=vr(),Ce("<<"),Ce("/Filter /Standard"),Ce("/V "+us.v),Ce("/R "+us.r),Ce("/U <"+us.toHexString(us.U)+">"),Ce("/O <"+us.toHexString(us.O)+">"),Ce("/P "+us.P),Ce(">>"),Ce("endobj")},Cc=function(){for(var J in Ce("/Font <<"),Ft)Ft.hasOwnProperty(J)&&(w===!1||w===!0&&M.hasOwnProperty(J))&&Ce("/"+J+" "+Ft[J].objectNumber+" 0 R");Ce(">>")},Yu=function(){if(Object.keys(et).length>0){for(var J in Ce("/Shading <<"),et)et.hasOwnProperty(J)&&et[J]instanceof lg&&et[J].objectNumber>=0&&Ce("/"+J+" "+et[J].objectNumber+" 0 R");En.publish("putShadingPatternDict"),Ce(">>")}},ja=function(J){if(Object.keys(et).length>0){for(var Xe in Ce("/Pattern <<"),et)et.hasOwnProperty(Xe)&&et[Xe]instanceof C.TilingPattern&&et[Xe].objectNumber>=0&&et[Xe].objectNumber<J&&Ce("/"+Xe+" "+et[Xe].objectNumber+" 0 R");En.publish("putTilingPatternDict"),Ce(">>")}},ds=function(){if(Object.keys($e).length>0){var J;for(J in Ce("/ExtGState <<"),$e)$e.hasOwnProperty(J)&&$e[J].objectNumber>=0&&Ce("/"+J+" "+$e[J].objectNumber+" 0 R");En.publish("putGStateDict"),Ce(">>")}},Di=function(J){pn(J.resourcesOid,!0),Ce("<<"),Ce("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Cc(),Yu(),ja(J.objectOid),ds(),Zu(),Ce(">>"),Ce("endobj")},Xu=function(){var J=[];pi(),Au(),Yi(),Wu(J),En.publish("putResources"),J.forEach(Di),Di({resourcesOid:or,objectOid:Number.MAX_SAFE_INTEGER}),En.publish("postPutResources")},lu=function(){En.publish("putAdditionalObjects");for(var J=0;J<rn.length;J++){var Xe=rn[J];pn(Xe.objId,!0),Ce(Xe.content),Ce("endobj")}En.publish("postPutAdditionalObjects")},gl=function(J){je[J.fontName]=je[J.fontName]||{},je[J.fontName][J.fontStyle]=J.id},Ju=function(J,Xe,Bt,nn,An){var Xn={id:"F"+(Object.keys(Ft).length+1).toString(10),postScriptName:J,fontName:Xe,fontStyle:Bt,encoding:nn,isStandardFont:An||!1,metadata:{}};return En.publish("addFont",{font:Xn,instance:this}),Ft[Xn.id]=Xn,gl(Xn),Xn.id},ki=function(J){for(var Xe=0,Bt=Zt.length;Xe<Bt;Xe++){var nn=Ju.call(this,J[Xe][0],J[Xe][1],J[Xe][2],Zt[Xe][3],!0);w===!1&&(M[nn]=!0);var An=J[Xe][0].split("-");gl({id:nn,fontName:An[0],fontStyle:An[1]||""})}En.publish("addFonts",{fonts:Ft,dictionary:je})},is=function(J){return J.foo=function(){try{return J.apply(this,arguments)}catch(nn){var Xe=nn.stack||"";~Xe.indexOf(" at ")&&(Xe=Xe.split(" at ")[1]);var Bt="Error in function "+Xe.split(`
`)[0].split("<")[0]+": "+nn.message;if(!ts.console)throw new Error(Bt);ts.console.error(Bt,nn),ts.alert&&alert(Bt)}},J.foo.bar=J,J.foo},Ua=function(J,Xe){var Bt,nn,An,Xn,wr,Wr,Zr,fi,Pi;if(An=(Xe=Xe||{}).sourceEncoding||"Unicode",wr=Xe.outputEncoding,(Xe.autoencode||wr)&&Ft[tn].metadata&&Ft[tn].metadata[An]&&Ft[tn].metadata[An].encoding&&(Xn=Ft[tn].metadata[An].encoding,!wr&&Ft[tn].encoding&&(wr=Ft[tn].encoding),!wr&&Xn.codePages&&(wr=Xn.codePages[0]),typeof wr=="string"&&(wr=Xn[wr]),wr)){for(Zr=!1,Wr=[],Bt=0,nn=J.length;Bt<nn;Bt++)(fi=wr[J.charCodeAt(Bt)])?Wr.push(String.fromCharCode(fi)):Wr.push(J[Bt]),Wr[Bt].charCodeAt(0)>>8&&(Zr=!0);J=Wr.join("")}for(Bt=J.length;Zr===void 0&&Bt!==0;)J.charCodeAt(Bt-1)>>8&&(Zr=!0),Bt--;if(!Zr)return J;for(Wr=Xe.noBOM?[]:[254,255],Bt=0,nn=J.length;Bt<nn;Bt++){if((Pi=(fi=J.charCodeAt(Bt))>>8)>>8)throw new Error("Character at position "+Bt+" of string '"+J+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Wr.push(Pi),Wr.push(fi-(Pi<<8))}return String.fromCharCode.apply(void 0,Wr)},Bo=C.__private__.pdfEscape=C.pdfEscape=function(J,Xe){return Ua(J,Xe).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Co=C.__private__.beginPage=function(J){yn[++Ot]=[],cn[Ot]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(J[0]),topRightY:Number(J[1])}},uu(Ot),Be(yn[Ie])},ku=function(J,Xe){var Bt,nn,An;switch(n=Xe||n,typeof J=="string"&&(Bt=X(J.toLowerCase()),Array.isArray(Bt)&&(nn=Bt[0],An=Bt[1])),Array.isArray(J)&&(nn=J[0]*Kt,An=J[1]*Kt),isNaN(nn)&&(nn=i[0],An=i[1]),(nn>14400||An>14400)&&(xa.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),nn=Math.min(14400,nn),An=Math.min(14400,An)),i=[nn,An],n.substr(0,1)){case"l":An>nn&&(i=[An,nn]);break;case"p":nn>An&&(i=[An,nn])}Co(i),Iu(hu),Ce(Fs),Qu!==0&&Ce(Qu+" J"),ss!==0&&Ce(ss+" j"),En.publish("addPage",{pageNumber:Ot})},yl=function(J){J>0&&J<=Ot&&(yn.splice(J,1),cn.splice(J,1),Ot--,Ie>Ot&&(Ie=Ot),this.setPage(Ie))},uu=function(J){J>0&&J<=Ot&&(Ie=J)},lo=C.__private__.getNumberOfPages=C.getNumberOfPages=function(){return yn.length-1},So=function(J,Xe,Bt){var nn,An=void 0;return Bt=Bt||{},J=J!==void 0?J:Ft[tn].fontName,Xe=Xe!==void 0?Xe:Ft[tn].fontStyle,nn=J.toLowerCase(),je[nn]!==void 0&&je[nn][Xe]!==void 0?An=je[nn][Xe]:je[J]!==void 0&&je[J][Xe]!==void 0?An=je[J][Xe]:Bt.disableWarning===!1&&xa.warn("Unable to look up font label for font '"+J+"', '"+Xe+"'. Refer to getFontList() for available fonts."),An||Bt.noFallback||(An=je.times[Xe])==null&&(An=je.times.normal),An},tl=C.__private__.putInfo=function(){var J=vr(),Xe=function(nn){return nn};for(var Bt in _!==null&&(Xe=us.encryptor(J,0)),Ce("<<"),Ce("/Producer ("+Bo(Xe("jsPDF "+es.version))+")"),Ht)Ht.hasOwnProperty(Bt)&&Ht[Bt]&&Ce("/"+Bt.substr(0,1).toUpperCase()+Bt.substr(1)+" ("+Bo(Xe(Ht[Bt]))+")");Ce("/CreationDate ("+Bo(Xe(ae))+")"),Ce(">>"),Ce("endobj")},ui=C.__private__.putCatalog=function(J){var Xe=(J=J||{}).rootDictionaryObjId||Hn;switch(vr(),Ce("<<"),Ce("/Type /Catalog"),Ce("/Pages "+Xe+" 0 R"),ln||(ln="fullwidth"),ln){case"fullwidth":Ce("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Ce("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Ce("/OpenAction [3 0 R /Fit]");break;case"original":Ce("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Bt=""+ln;Bt.substr(Bt.length-1)==="%"&&(ln=parseInt(ln)/100),typeof ln=="number"&&Ce("/OpenAction [3 0 R /XYZ null null "+We(ln)+"]")}switch(pr||(pr="continuous"),pr){case"continuous":Ce("/PageLayout /OneColumn");break;case"single":Ce("/PageLayout /SinglePage");break;case"two":case"twoleft":Ce("/PageLayout /TwoColumnLeft");break;case"tworight":Ce("/PageLayout /TwoColumnRight")}Kn&&Ce("/PageMode /"+Kn),En.publish("putCatalog"),Ce(">>"),Ce("endobj")},ji=C.__private__.putTrailer=function(){Ce("trailer"),Ce("<<"),Ce("/Size "+(it+1)),Ce("/Root "+it+" 0 R"),Ce("/Info "+(it-1)+" 0 R"),_!==null&&Ce("/Encrypt "+us.oid+" 0 R"),Ce("/ID [ <"+ne+"> <"+ne+"> ]"),Ce(">>")},nl=C.__private__.putHeader=function(){Ce("%PDF-"+R),Ce("%ºß¬à")},rl=C.__private__.putXRef=function(){var J="0000000000";Ce("xref"),Ce("0 "+(it+1)),Ce("0000000000 65535 f ");for(var Xe=1;Xe<=it;Xe++)typeof lt[Xe]=="function"?Ce((J+lt[Xe]()).slice(-10)+" 00000 n "):lt[Xe]!==void 0?Ce((J+lt[Xe]).slice(-10)+" 00000 n "):Ce("0000000000 00000 n ")},Ws=C.__private__.buildDocument=function(){Ae(),Be(Mt),En.publish("buildDocument"),nl(),$i(),lu(),Xu(),_!==null&&Ku(),tl(),ui();var J=wt;return rl(),ji(),Ce("startxref"),Ce(""+J),Ce("%%EOF"),Be(yn[Ie]),Mt.join(`
`)},Zs=C.__private__.getBlob=function(J){return new Blob([Dt(J)],{type:"application/pdf"})},Ms=C.output=C.__private__.output=is(function(J,Xe){switch(typeof(Xe=Xe||{})=="string"?Xe={filename:Xe}:Xe.filename=Xe.filename||"generated.pdf",J){case void 0:return Ws();case"save":C.save(Xe.filename);break;case"arraybuffer":return Dt(Ws());case"blob":return Zs(Ws());case"bloburi":case"bloburl":if(ts.URL!==void 0&&typeof ts.URL.createObjectURL=="function")return ts.URL&&ts.URL.createObjectURL(Zs(Ws()))||void 0;xa.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Bt="",nn=Ws();try{Bt=s3(nn)}catch{Bt=s3(unescape(encodeURIComponent(nn)))}return"data:application/pdf;filename="+Xe.filename+";base64,"+Bt;case"pdfobjectnewwindow":if(Object.prototype.toString.call(ts)==="[object Window]"){var An="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Xn=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Xe.pdfObjectUrl&&(An=Xe.pdfObjectUrl,Xn="");var wr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+An+'"'+Xn+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Xe)+");<\/script></body></html>",Wr=ts.open();return Wr!==null&&Wr.document.write(wr),Wr}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(ts)==="[object Window]"){var Zr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Xe.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Xe.filename+'" width="500px" height="400px" /></body></html>',fi=ts.open();if(fi!==null){fi.document.write(Zr);var Pi=this;fi.document.documentElement.querySelector("#pdfViewer").onload=function(){fi.document.title=Xe.filename,fi.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Pi.output("bloburl"))}}return fi}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(ts)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Xi='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Xe)+'"></iframe></body></html>',js=ts.open();if(js!==null&&(js.document.write(Xi),js.document.title=Xe.filename),js||typeof safari>"u")return js;break;case"datauri":case"dataurl":return ts.document.location.href=this.output("datauristring",Xe);default:return null}}),cu=function(J){return Array.isArray(wn)===!0&&wn.indexOf(J)>-1};switch(r){case"pt":Kt=1;break;case"mm":Kt=72/25.4;break;case"cm":Kt=72/2.54;break;case"in":Kt=72;break;case"px":Kt=cu("px_scaling")==1?.75:96/72;break;case"pc":case"em":Kt=12;break;case"ex":Kt=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);Kt=r}var us=null;pt(),Le();var La=function(J){return _!==null?us.encryptor(J,0):function(Xe){return Xe}},Lo=C.__private__.getPageInfo=C.getPageInfo=function(J){if(isNaN(J)||J%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:cn[J].objId,pageNumber:J,pageContext:cn[J]}},yi=C.__private__.getPageInfoByObjId=function(J){if(isNaN(J)||J%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Xe in cn)if(cn[Xe].objId===J)break;return Lo(Xe)},Mi=C.__private__.getCurrentPageInfo=C.getCurrentPageInfo=function(){return{objId:cn[Ie].objId,pageNumber:Ie,pageContext:cn[Ie]}};C.addPage=function(){return ku.apply(this,arguments),this},C.setPage=function(){return uu.apply(this,arguments),Be.call(this,yn[Ie]),this},C.insertPage=function(J){return this.addPage(),this.movePage(Ie,J),this},C.movePage=function(J,Xe){var Bt,nn;if(J>Xe){Bt=yn[J],nn=cn[J];for(var An=J;An>Xe;An--)yn[An]=yn[An-1],cn[An]=cn[An-1];yn[Xe]=Bt,cn[Xe]=nn,this.setPage(Xe)}else if(J<Xe){Bt=yn[J],nn=cn[J];for(var Xn=J;Xn<Xe;Xn++)yn[Xn]=yn[Xn+1],cn[Xn]=cn[Xn+1];yn[Xe]=Bt,cn[Xe]=nn,this.setPage(Xe)}return this},C.deletePage=function(){return yl.apply(this,arguments),this},C.__private__.text=C.text=function(J,Xe,Bt,nn,An){var Xn,wr,Wr,Zr,fi,Pi,Xi,js,cs,_s=(nn=nn||{}).scope||this;if(typeof J=="number"&&typeof Xe=="number"&&(typeof Bt=="string"||Array.isArray(Bt))){var co=Bt;Bt=Xe,Xe=J,J=co}if(arguments[3]instanceof vt?(ue("The transform parameter of text() with a Matrix value"),cs=An):(Wr=arguments[4],Zr=arguments[5],Xo(Xi=arguments[3])==="object"&&Xi!==null||(typeof Wr=="string"&&(Zr=Wr,Wr=null),typeof Xi=="string"&&(Zr=Xi,Xi=null),typeof Xi=="number"&&(Wr=Xi,Xi=null),nn={flags:Xi,angle:Wr,align:Zr})),isNaN(Xe)||isNaN(Bt)||J==null)throw new Error("Invalid arguments passed to jsPDF.text");if(J.length===0)return _s;var yo="",$a=!1,Ri=typeof nn.lineHeightFactor=="number"?nn.lineHeightFactor:ua,Qo=_s.internal.scaleFactor;function mu(bs){return bs=bs.split("	").join(Array(nn.TabLen||9).join(" ")),Bo(bs,Xi)}function Eo(bs){for(var oi,io=bs.concat(),Us=[],pa=io.length;pa--;)typeof(oi=io.shift())=="string"?Us.push(oi):Array.isArray(bs)&&(oi.length===1||oi[1]===void 0&&oi[2]===void 0)?Us.push(oi[0]):Us.push([oi[0],oi[1],oi[2]]);return Us}function Fc(bs,oi){var io;if(typeof bs=="string")io=oi(bs)[0];else if(Array.isArray(bs)){for(var Us,pa,Vo=bs.concat(),xl=[],ah=Vo.length;ah--;)typeof(Us=Vo.shift())=="string"?xl.push(oi(Us)[0]):Array.isArray(Us)&&typeof Us[0]=="string"&&(pa=oi(Us[0],Us[1],Us[2]),xl.push([pa[0],pa[1],pa[2]]));io=xl}return io}var sl=!1,zc=!0;if(typeof J=="string")sl=!0;else if(Array.isArray(J)){var Ou=J.concat();wr=[];for(var Ru,_o=Ou.length;_o--;)(typeof(Ru=Ou.shift())!="string"||Array.isArray(Ru)&&typeof Ru[0]!="string")&&(zc=!1);sl=zc}if(sl===!1)throw new Error('Type of text must be string or Array. "'+J+'" is not recognized.');typeof J=="string"&&(J=J.match(/[\r?\n]/)?J.split(/\r\n|\r|\n/g):[J]);var _l=an/_s.internal.scaleFactor,ha=_l*(Ri-1);switch(nn.baseline){case"bottom":Bt-=ha;break;case"top":Bt+=_l-ha;break;case"hanging":Bt+=_l-2*ha;break;case"middle":Bt+=_l/2-ha}if((Pi=nn.maxWidth||0)>0&&(typeof J=="string"?J=_s.splitTextToSize(J,Pi):Object.prototype.toString.call(J)==="[object Array]"&&(J=J.reduce(function(bs,oi){return bs.concat(_s.splitTextToSize(oi,Pi))},[]))),Xn={text:J,x:Xe,y:Bt,options:nn,mutex:{pdfEscape:Bo,activeFontKey:tn,fonts:Ft,activeFontSize:an}},En.publish("preProcessText",Xn),J=Xn.text,Wr=(nn=Xn.options).angle,!(cs instanceof vt)&&Wr&&typeof Wr=="number"){Wr*=Math.PI/180,nn.rotationDirection===0&&(Wr=-Wr),Q===Y.ADVANCED&&(Wr=-Wr);var Ta=Math.cos(Wr),gu=Math.sin(Wr);cs=new vt(Ta,gu,-gu,Ta,0,0)}else Wr&&Wr instanceof vt&&(cs=Wr);Q!==Y.ADVANCED||cs||(cs=bn),(fi=nn.charSpace||pu)!==void 0&&(yo+=we(de(fi))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(js=nn.horizontalScale)!==void 0&&(yo+=we(100*js)+` Tz
`),nn.lang;var Xs=-1,zo=nn.renderingMode!==void 0?nn.renderingMode:nn.stroke,ea=_s.internal.getCurrentPageInfo().pageContext;switch(zo){case 0:case!1:case"fill":Xs=0;break;case 1:case!0:case"stroke":Xs=1;break;case 2:case"fillThenStroke":Xs=2;break;case 3:case"invisible":Xs=3;break;case 4:case"fillAndAddForClipping":Xs=4;break;case 5:case"strokeAndAddPathForClipping":Xs=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Xs=6;break;case 7:case"addToPathForClipping":Xs=7}var jc=ea.usedRenderingMode!==void 0?ea.usedRenderingMode:-1;Xs!==-1?yo+=Xs+` Tr
`:jc!==-1&&(yo+=`0 Tr
`),Xs!==-1&&(ea.usedRenderingMode=Xs),Zr=nn.align||"left";var Mo,jl=an*Ri,mi=_s.internal.pageSize.getWidth(),jo=Ft[tn];fi=nn.charSpace||pu,Pi=nn.maxWidth||0,Xi=Object.assign({autoencode:!0,noBOM:!0},nn.flags);var Bu=[],Nu=function(bs){return _s.getStringUnitWidth(bs,{font:jo,charSpace:fi,fontSize:an,doKerning:!1})*an/Qo};if(Object.prototype.toString.call(J)==="[object Array]"){var da;wr=Eo(J),Zr!=="left"&&(Mo=wr.map(Nu));var ta,Ul=0;if(Zr==="right"){Xe-=Mo[0],J=[],_o=wr.length;for(var ol=0;ol<_o;ol++)ol===0?(ta=di(Xe),da=ro(Bt)):(ta=de(Ul-Mo[ol]),da=-jl),J.push([wr[ol],ta,da]),Ul=Mo[ol]}else if(Zr==="center"){Xe-=Mo[0]/2,J=[],_o=wr.length;for(var na=0;na<_o;na++)na===0?(ta=di(Xe),da=ro(Bt)):(ta=de((Ul-Mo[na])/2),da=-jl),J.push([wr[na],ta,da]),Ul=Mo[na]}else if(Zr==="left"){J=[],_o=wr.length;for(var Ln=0;Ln<_o;Ln++)J.push(wr[Ln])}else if(Zr==="justify"&&jo.encoding==="Identity-H"){J=[],_o=wr.length,Pi=Pi!==0?Pi:mi;for(var nr=0,Fn=0;Fn<_o;Fn++)if(da=Fn===0?ro(Bt):-jl,ta=Fn===0?di(Xe):nr,Fn<_o-1){var Hr=de((Pi-Mo[Fn])/(wr[Fn].split(" ").length-1)),ii=wr[Fn].split(" ");J.push([ii[0]+" ",ta,da]),nr=0;for(var xi=1;xi<ii.length;xi++){var as=(Nu(ii[xi-1]+" "+ii[xi])-Nu(ii[xi]))*Qo+Hr;xi==ii.length-1?J.push([ii[xi],as,0]):J.push([ii[xi]+" ",as,0]),nr-=as}}else J.push([wr[Fn],ta,da]);J.push(["",nr,0])}else{if(Zr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(J=[],_o=wr.length,Pi=Pi!==0?Pi:mi,Fn=0;Fn<_o;Fn++)da=Fn===0?ro(Bt):-jl,ta=Fn===0?di(Xe):0,Fn<_o-1?Bu.push(we(de((Pi-Mo[Fn])/(wr[Fn].split(" ").length-1)))):Bu.push(0),J.push([wr[Fn],ta,da])}}var Cs=typeof nn.R2L=="boolean"?nn.R2L:qn;Cs===!0&&(J=Fc(J,function(bs,oi,io){return[bs.split("").reverse().join(""),oi,io]})),Xn={text:J,x:Xe,y:Bt,options:nn,mutex:{pdfEscape:Bo,activeFontKey:tn,fonts:Ft,activeFontSize:an}},En.publish("postProcessText",Xn),J=Xn.text,$a=Xn.mutex.isHex||!1;var dc=Ft[tn].encoding;dc!=="WinAnsiEncoding"&&dc!=="StandardEncoding"||(J=Fc(J,function(bs,oi,io){return[mu(bs),oi,io]})),wr=Eo(J),J=[];for(var ra,Ts,al,bl=0,Ga=1,ll=Array.isArray(wr[0])?Ga:bl,Vl="",Ui=function(bs,oi,io){var Us="";return io instanceof vt?(io=typeof nn.angle=="number"?Tn(io,new vt(1,0,0,1,bs,oi)):Tn(new vt(1,0,0,1,bs,oi),io),Q===Y.ADVANCED&&(io=Tn(new vt(1,0,0,-1,0,0),io)),Us=io.join(" ")+` Tm
`):Us=we(bs)+" "+we(oi)+` Td
`,Us},fa=0;fa<wr.length;fa++){switch(Vl="",ll){case Ga:al=($a?"<":"(")+wr[fa][0]+($a?">":")"),ra=parseFloat(wr[fa][1]),Ts=parseFloat(wr[fa][2]);break;case bl:al=($a?"<":"(")+wr[fa]+($a?">":")"),ra=di(Xe),Ts=ro(Bt)}Bu!==void 0&&Bu[fa]!==void 0&&(Vl=Bu[fa]+` Tw
`),fa===0?J.push(Vl+Ui(ra,Ts,cs)+al):ll===bl?J.push(Vl+al):ll===Ga&&J.push(Vl+Ui(ra,Ts,cs)+al)}J=ll===bl?J.join(` Tj
T* `):J.join(` Tj
`),J+=` Tj
`;var Uo=`BT
/`;return Uo+=tn+" "+an+` Tf
`,Uo+=we(an*Ri)+` TL
`,Uo+=Ea+`
`,Uo+=yo,Uo+=J,Ce(Uo+="ET"),M[tn]=!0,_s};var fs=C.__private__.clip=C.clip=function(J){return Ce(J==="evenodd"?"W*":"W"),this};C.clipEvenOdd=function(){return fs("evenodd")},C.__private__.discardPath=C.discardPath=function(){return Ce("n"),this};var Bi=C.__private__.isValidStyle=function(J){var Xe=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(J)!==-1&&(Xe=!0),Xe};C.__private__.setDefaultPathOperation=C.setDefaultPathOperation=function(J){return Bi(J)&&(m=J),this};var Bl=C.__private__.getStyle=C.getStyle=function(J){var Xe=m;switch(J){case"D":case"S":Xe="S";break;case"F":Xe="f";break;case"FD":case"DF":Xe="B";break;case"f":case"f*":case"B":case"B*":Xe=J}return Xe},Nl=C.close=function(){return Ce("h"),this};C.stroke=function(){return Ce("S"),this},C.fill=function(J){return No("f",J),this},C.fillEvenOdd=function(J){return No("f*",J),this},C.fillStroke=function(J){return No("B",J),this},C.fillStrokeEvenOdd=function(J){return No("B*",J),this};var No=function(J,Xe){Xo(Xe)==="object"?Sc(Xe,J):Ce(J)},Pa=function(J){J===null||Q===Y.ADVANCED&&J===void 0||(J=Bl(J),Ce(J))};function qi(J,Xe,Bt,nn,An){var Xn=new P0(Xe||this.boundingBox,Bt||this.xStep,nn||this.yStep,this.gState,An||this.matrix);Xn.stream=this.stream;var wr=J+"$$"+this.cloneIndex+++"$$";return br(wr,Xn),Xn}var Sc=function(J,Xe){var Bt=ct[J.key],nn=et[Bt];if(nn instanceof lg)Ce("q"),Ce(Gi(Xe)),nn.gState&&C.setGState(nn.gState),Ce(J.matrix.toString()+" cm"),Ce("/"+Bt+" sh"),Ce("Q");else if(nn instanceof P0){var An=new vt(1,0,0,-1,0,il());J.matrix&&(An=An.multiply(J.matrix||bn),Bt=qi.call(nn,J.key,J.boundingBox,J.xStep,J.yStep,An).id),Ce("q"),Ce("/Pattern cs"),Ce("/"+Bt+" scn"),nn.gState&&C.setGState(nn.gState),Ce(Xe),Ce("Q")}},Gi=function(J){switch(J){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Nr=C.moveTo=function(J,Xe){return Ce(we(de(J))+" "+we(be(Xe))+" m"),this},Fi=C.lineTo=function(J,Xe){return Ce(we(de(J))+" "+we(be(Xe))+" l"),this},Oi=C.curveTo=function(J,Xe,Bt,nn,An,Xn){return Ce([we(de(J)),we(be(Xe)),we(de(Bt)),we(be(nn)),we(de(An)),we(be(Xn)),"c"].join(" ")),this};C.__private__.line=C.line=function(J,Xe,Bt,nn,An){if(isNaN(J)||isNaN(Xe)||isNaN(Bt)||isNaN(nn)||!Bi(An))throw new Error("Invalid arguments passed to jsPDF.line");return Q===Y.COMPAT?this.lines([[Bt-J,nn-Xe]],J,Xe,[1,1],An||"S"):this.lines([[Bt-J,nn-Xe]],J,Xe,[1,1]).stroke()},C.__private__.lines=C.lines=function(J,Xe,Bt,nn,An,Xn){var wr,Wr,Zr,fi,Pi,Xi,js,cs,_s,co,yo,$a;if(typeof J=="number"&&($a=Bt,Bt=Xe,Xe=J,J=$a),nn=nn||[1,1],Xn=Xn||!1,isNaN(Xe)||isNaN(Bt)||!Array.isArray(J)||!Array.isArray(nn)||!Bi(An)||typeof Xn!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Nr(Xe,Bt),wr=nn[0],Wr=nn[1],fi=J.length,co=Xe,yo=Bt,Zr=0;Zr<fi;Zr++)(Pi=J[Zr]).length===2?(co=Pi[0]*wr+co,yo=Pi[1]*Wr+yo,Fi(co,yo)):(Xi=Pi[0]*wr+co,js=Pi[1]*Wr+yo,cs=Pi[2]*wr+co,_s=Pi[3]*Wr+yo,co=Pi[4]*wr+co,yo=Pi[5]*Wr+yo,Oi(Xi,js,cs,_s,co,yo));return Xn&&Nl(),Pa(An),this},C.path=function(J){for(var Xe=0;Xe<J.length;Xe++){var Bt=J[Xe],nn=Bt.c;switch(Bt.op){case"m":Nr(nn[0],nn[1]);break;case"l":Fi(nn[0],nn[1]);break;case"c":Oi.apply(this,nn);break;case"h":Nl()}}return this},C.__private__.rect=C.rect=function(J,Xe,Bt,nn,An){if(isNaN(J)||isNaN(Xe)||isNaN(Bt)||isNaN(nn)||!Bi(An))throw new Error("Invalid arguments passed to jsPDF.rect");return Q===Y.COMPAT&&(nn=-nn),Ce([we(de(J)),we(be(Xe)),we(de(Bt)),we(de(nn)),"re"].join(" ")),Pa(An),this},C.__private__.triangle=C.triangle=function(J,Xe,Bt,nn,An,Xn,wr){if(isNaN(J)||isNaN(Xe)||isNaN(Bt)||isNaN(nn)||isNaN(An)||isNaN(Xn)||!Bi(wr))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Bt-J,nn-Xe],[An-Bt,Xn-nn],[J-An,Xe-Xn]],J,Xe,[1,1],wr,!0),this},C.__private__.roundedRect=C.roundedRect=function(J,Xe,Bt,nn,An,Xn,wr){if(isNaN(J)||isNaN(Xe)||isNaN(Bt)||isNaN(nn)||isNaN(An)||isNaN(Xn)||!Bi(wr))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Wr=4/3*(Math.SQRT2-1);return An=Math.min(An,.5*Bt),Xn=Math.min(Xn,.5*nn),this.lines([[Bt-2*An,0],[An*Wr,0,An,Xn-Xn*Wr,An,Xn],[0,nn-2*Xn],[0,Xn*Wr,-An*Wr,Xn,-An,Xn],[2*An-Bt,0],[-An*Wr,0,-An,-Xn*Wr,-An,-Xn],[0,2*Xn-nn],[0,-Xn*Wr,An*Wr,-Xn,An,-Xn]],J+An,Xe,[1,1],wr,!0),this},C.__private__.ellipse=C.ellipse=function(J,Xe,Bt,nn,An){if(isNaN(J)||isNaN(Xe)||isNaN(Bt)||isNaN(nn)||!Bi(An))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Xn=4/3*(Math.SQRT2-1)*Bt,wr=4/3*(Math.SQRT2-1)*nn;return Nr(J+Bt,Xe),Oi(J+Bt,Xe-wr,J+Xn,Xe-nn,J,Xe-nn),Oi(J-Xn,Xe-nn,J-Bt,Xe-wr,J-Bt,Xe),Oi(J-Bt,Xe+wr,J-Xn,Xe+nn,J,Xe+nn),Oi(J+Xn,Xe+nn,J+Bt,Xe+wr,J+Bt,Xe),Pa(An),this},C.__private__.circle=C.circle=function(J,Xe,Bt,nn){if(isNaN(J)||isNaN(Xe)||isNaN(Bt)||!Bi(nn))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(J,Xe,Bt,Bt,nn)},C.setFont=function(J,Xe,Bt){return Bt&&(Xe=me(Xe,Bt)),tn=So(J,Xe,{disableWarning:!1}),this};var hc=C.__private__.getFont=C.getFont=function(){return Ft[So.apply(C,arguments)]};C.__private__.getFontList=C.getFontList=function(){var J,Xe,Bt={};for(J in je)if(je.hasOwnProperty(J))for(Xe in Bt[J]=[],je[J])je[J].hasOwnProperty(Xe)&&Bt[J].push(Xe);return Bt},C.addFont=function(J,Xe,Bt,nn,An){var Xn=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Xn.indexOf(arguments[3])!==-1?An=arguments[3]:arguments[3]&&Xn.indexOf(arguments[3])==-1&&(Bt=me(Bt,nn)),An=An||"Identity-H",Ju.call(this,J,Xe,Bt,An)};var ua,hu=e.lineWidth||.200025,du=C.__private__.getLineWidth=C.getLineWidth=function(){return hu},Iu=C.__private__.setLineWidth=C.setLineWidth=function(J){return hu=J,Ce(we(de(J))+" w"),this};C.__private__.setLineDash=es.API.setLineDash=es.API.setLineDashPattern=function(J,Xe){if(J=J||[],Xe=Xe||0,isNaN(Xe)||!Array.isArray(J))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return J=J.map(function(Bt){return we(de(Bt))}).join(" "),Xe=we(de(Xe)),Ce("["+J+"] "+Xe+" d"),this};var fu=C.__private__.getLineHeight=C.getLineHeight=function(){return an*ua};C.__private__.getLineHeight=C.getLineHeight=function(){return an*ua};var Hi=C.__private__.setLineHeightFactor=C.setLineHeightFactor=function(J){return typeof(J=J||1.15)=="number"&&(ua=J),this},Ks=C.__private__.getLineHeightFactor=C.getLineHeightFactor=function(){return ua};Hi(e.lineHeight);var di=C.__private__.getHorizontalCoordinate=function(J){return de(J)},ro=C.__private__.getVerticalCoordinate=function(J){return Q===Y.ADVANCED?J:cn[Ie].mediaBox.topRightY-cn[Ie].mediaBox.bottomLeftY-de(J)},vl=C.__private__.getHorizontalCoordinateString=C.getHorizontalCoordinateString=function(J){return we(di(J))},Ys=C.__private__.getVerticalCoordinateString=C.getVerticalCoordinateString=function(J){return we(ro(J))},Fs=e.strokeColor||"0 G";C.__private__.getStrokeColor=C.getDrawColor=function(){return Xr(Fs)},C.__private__.setStrokeColor=C.setDrawColor=function(J,Xe,Bt,nn){return Fs=ri({ch1:J,ch2:Xe,ch3:Bt,ch4:nn,pdfColorType:"draw",precision:2}),Ce(Fs),this};var Fo=e.fillColor||"0 g";C.__private__.getFillColor=C.getFillColor=function(){return Xr(Fo)},C.__private__.setFillColor=C.setFillColor=function(J,Xe,Bt,nn){return Fo=ri({ch1:J,ch2:Xe,ch3:Bt,ch4:nn,pdfColorType:"fill",precision:2}),Ce(Fo),this};var Ea=e.textColor||"0 g",vs=C.__private__.getTextColor=C.getTextColor=function(){return Xr(Ea)};C.__private__.setTextColor=C.setTextColor=function(J,Xe,Bt,nn){return Ea=ri({ch1:J,ch2:Xe,ch3:Bt,ch4:nn,pdfColorType:"text",precision:3}),this};var pu=e.charSpace,Ma=C.__private__.getCharSpace=C.getCharSpace=function(){return parseFloat(pu||0)};C.__private__.setCharSpace=C.setCharSpace=function(J){if(isNaN(J))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return pu=J,this};var Qu=0;C.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},C.__private__.setLineCap=C.setLineCap=function(J){var Xe=C.CapJoinStyles[J];if(Xe===void 0)throw new Error("Line cap style of '"+J+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Qu=Xe,Ce(Xe+" J"),this};var ss=0;C.__private__.setLineJoin=C.setLineJoin=function(J){var Xe=C.CapJoinStyles[J];if(Xe===void 0)throw new Error("Line join style of '"+J+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ss=Xe,Ce(Xe+" j"),this},C.__private__.setLineMiterLimit=C.__private__.setMiterLimit=C.setLineMiterLimit=C.setMiterLimit=function(J){if(J=J||0,isNaN(J))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Ce(we(de(J))+" M"),this},C.GState=Hx,C.setGState=function(J){(J=typeof J=="string"?$e[Gt[J]]:Lc(null,J)).equals(hn)||(Ce("/"+J.id+" gs"),hn=J)};var Lc=function(J,Xe){if(!J||!Gt[J]){var Bt=!1;for(var nn in $e)if($e.hasOwnProperty(nn)&&$e[nn].equals(Xe)){Bt=!0;break}if(Bt)Xe=$e[nn];else{var An="GS"+(Object.keys($e).length+1).toString(10);$e[An]=Xe,Xe.id=An}return J&&(Gt[J]=Xe.id),En.publish("addGState",Xe),Xe}};C.addGState=function(J,Xe){return Lc(J,Xe),this},C.saveGraphicsState=function(){return Ce("q"),Ze.push({key:tn,size:an,color:Ea}),this},C.restoreGraphicsState=function(){Ce("Q");var J=Ze.pop();return tn=J.key,an=J.size,Ea=J.color,hn=null,this},C.setCurrentTransformationMatrix=function(J){return Ce(J.toString()+" cm"),this},C.comment=function(J){return Ce("#"+J),this};var Po=function(J,Xe){var Bt=J||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Bt},set:function(Xn){isNaN(Xn)||(Bt=parseFloat(Xn))}});var nn=Xe||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return nn},set:function(Xn){isNaN(Xn)||(nn=parseFloat(Xn))}});var An="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return An},set:function(Xn){An=Xn.toString()}}),this},Fl=function(J,Xe,Bt,nn){Po.call(this,J,Xe),this.type="rect";var An=Bt||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return An},set:function(wr){isNaN(wr)||(An=parseFloat(wr))}});var Xn=nn||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Xn},set:function(wr){isNaN(wr)||(Xn=parseFloat(wr))}}),this},Du=function(){this.page=Ot,this.currentPage=Ie,this.pages=yn.slice(0),this.pagesContext=cn.slice(0),this.x=Yn,this.y=ir,this.matrix=Fr,this.width=os(Ie),this.height=il(Ie),this.outputDestination=De,this.id="",this.objectNumber=-1};Du.prototype.restore=function(){Ot=this.page,Ie=this.currentPage,cn=this.pagesContext,yn=this.pages,Yn=this.x,ir=this.y,Fr=this.matrix,ca(Ie,this.width),uo(Ie,this.height),De=this.outputDestination};var Va=function(J,Xe,Bt,nn,An){Yt.push(new Du),Ot=Ie=0,yn=[],Yn=J,ir=Xe,Fr=An,Co([Bt,nn])},Jo=function(J){if(Lr[J])Yt.pop().restore();else{var Xe=new Du,Bt="Xo"+(Object.keys(Qn).length+1).toString(10);Xe.id=Bt,Lr[J]=Bt,Qn[Bt]=Xe,En.publish("addFormObject",Xe),Yt.pop().restore()}};for(var zl in C.beginFormObject=function(J,Xe,Bt,nn,An){return Va(J,Xe,Bt,nn,An),this},C.endFormObject=function(J){return Jo(J),this},C.doFormObject=function(J,Xe){var Bt=Qn[Lr[J]];return Ce("q"),Ce(Xe.toString()+" cm"),Ce("/"+Bt.id+" Do"),Ce("Q"),this},C.getFormObject=function(J){var Xe=Qn[Lr[J]];return{x:Xe.x,y:Xe.y,width:Xe.width,height:Xe.height,matrix:Xe.matrix}},C.save=function(J,Xe){return J=J||"generated.pdf",(Xe=Xe||{}).returnPromise=Xe.returnPromise||!1,Xe.returnPromise===!1?(rg(Zs(Ws()),J),typeof rg.unload=="function"&&ts.setTimeout&&setTimeout(rg.unload,911),this):new Promise(function(Bt,nn){try{var An=rg(Zs(Ws()),J);typeof rg.unload=="function"&&ts.setTimeout&&setTimeout(rg.unload,911),Bt(An)}catch(Xn){nn(Xn.message)}})},es.API)es.API.hasOwnProperty(zl)&&(zl==="events"&&es.API.events.length?function(J,Xe){var Bt,nn,An;for(An=Xe.length-1;An!==-1;An--)Bt=Xe[An][0],nn=Xe[An][1],J.subscribe.apply(J,[Bt].concat(typeof nn=="function"?[nn]:nn))}(En,es.API.events):C[zl]=es.API[zl]);var os=C.getPageWidth=function(J){return(cn[J=J||Ie].mediaBox.topRightX-cn[J].mediaBox.bottomLeftX)/Kt},ca=C.setPageWidth=function(J,Xe){cn[J].mediaBox.topRightX=Xe*Kt+cn[J].mediaBox.bottomLeftX},il=C.getPageHeight=function(J){return(cn[J=J||Ie].mediaBox.topRightY-cn[J].mediaBox.bottomLeftY)/Kt},uo=C.setPageHeight=function(J,Xe){cn[J].mediaBox.topRightY=Xe*Kt+cn[J].mediaBox.bottomLeftY};return C.internal={pdfEscape:Bo,getStyle:Bl,getFont:hc,getFontSize:vn,getCharSpace:Ma,getTextColor:vs,getLineHeight:fu,getLineHeightFactor:Ks,getLineWidth:du,write:ot,getHorizontalCoordinate:di,getVerticalCoordinate:ro,getCoordinateString:vl,getVerticalCoordinateString:Ys,collections:{},newObject:vr,newAdditionalObject:Ut,newObjectDeferred:Cn,newObjectDeferredBegin:pn,getFilters:ai,putStream:Pr,events:En,scaleFactor:Kt,pageSize:{getWidth:function(){return os(Ie)},setWidth:function(J){ca(Ie,J)},getHeight:function(){return il(Ie)},setHeight:function(J){uo(Ie,J)}},encryptionOptions:_,encryption:us,getEncryptor:La,output:Ms,getNumberOfPages:lo,pages:yn,out:Ce,f2:We,f3:he,getPageInfo:Lo,getPageInfoByObjId:yi,getCurrentPageInfo:Mi,getPDFVersion:z,Point:Po,Rectangle:Fl,Matrix:vt,hasHotfix:cu},Object.defineProperty(C.internal.pageSize,"width",{get:function(){return os(Ie)},set:function(J){ca(Ie,J)},enumerable:!0,configurable:!0}),Object.defineProperty(C.internal.pageSize,"height",{get:function(){return il(Ie)},set:function(J){uo(Ie,J)},enumerable:!0,configurable:!0}),ki.call(C,Zt),tn="F1",ku(i,n),En.publish("initialized"),C}w0.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},w0.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},w0.prototype.hexToBytes=function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(String.fromCharCode(parseInt(e.substr(n,2),16)));return t.join("")},w0.prototype.processOwnerPassword=function(e,t){return a3(o3(t).substr(0,5),e)},w0.prototype.encryptor=function(e,t){var n=o3(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(r){return a3(n,r)}},Hx.prototype.equals=function(e){var t,n="id,objectNumber,equals";if(!e||Xo(e)!==Xo(this))return!1;var r=0;for(t in this)if(!(n.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;r++}for(t in e)e.hasOwnProperty(t)&&n.indexOf(t)<0&&r--;return r===0},es.API={events:[]},es.version="2.5.2";var nu=es.API,DC=1,Tg=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},c0=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},gs=function(e){return e.toFixed(2)},Hp=function(e){return e.toFixed(5)};nu.__acroform__={};var Yh=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},hP=function(e){return e*DC},Lf=function(e){var t=new $k,n=gi.internal.getHeight(e)||0,r=gi.internal.getWidth(e)||0;return t.BBox=[0,0,Number(gs(r)),Number(gs(n))],t},iG=nu.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},sG=nu.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},oG=nu.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},wu=nu.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return oG(e,t-1)},Cu=nu.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return iG(e,t-1)},Su=nu.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return sG(e,t-1)},aG=nu.__acroform__.calculateCoordinates=function(e,t){var n=t.internal.getHorizontalCoordinate,r=t.internal.getVerticalCoordinate,i=e[0],l=e[1],a=e[2],o=e[3],f={};return f.lowerLeft_X=n(i)||0,f.lowerLeft_Y=r(l+o)||0,f.upperRight_X=n(i+a)||0,f.upperRight_Y=r(l)||0,[Number(gs(f.lowerLeft_X)),Number(gs(f.lowerLeft_Y)),Number(gs(f.upperRight_X)),Number(gs(f.upperRight_Y))]},lG=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],n=e._V||e.DV,r=l3(e,n),i=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+i+" "+gs(r.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(r.text),t.push("ET"),t.push("Q"),t.push("EMC");var l=Lf(e);return l.scope=e.scope,l.stream=t.join(`
`),l}},l3=function(e,t){var n=e.fontSize===0?e.maxFontSize:e.fontSize,r={text:"",fontSize:""},i=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");i=e.multiline?i.map(function(he){return he.split(`
`)}):i.map(function(he){return[he]});var l=n,a=gi.internal.getHeight(e)||0;a=a<0?-a:a;var o=gi.internal.getWidth(e)||0;o=o<0?-o:o;var f=function(he,de,Te){if(he+1<i.length){var be=de+" "+i[he+1][0];return wb(be,e,Te).width<=o-4}return!1};l++;e:for(;l>0;){t="",l--;var m,_,w=wb("3",e,l).height,M=e.multiline?a-l:(a-w)/2,C=M+=2,R=0,z=0,W=0;if(l<=0){t=`(...) Tj
`,t+="% Width of Text: "+wb(t,e,l=12).width+", FieldWidth:"+o+`
`;break}for(var X="",Y=0,Q=0;Q<i.length;Q++)if(i.hasOwnProperty(Q)){var oe=!1;if(i[Q].length!==1&&W!==i[Q].length-1){if((w+2)*(Y+2)+2>a)continue e;X+=i[Q][W],oe=!0,z=Q,Q--}else{X=(X+=i[Q][W]+" ").substr(X.length-1)==" "?X.substr(0,X.length-1):X;var le=parseInt(Q),me=f(le,X,l),we=Q>=i.length-1;if(me&&!we){X+=" ",W=0;continue}if(me||we){if(we)z=le;else if(e.multiline&&(w+2)*(Y+2)+2>a)continue e}else{if(!e.multiline||(w+2)*(Y+2)+2>a)continue e;z=le}}for(var ue="",_e=R;_e<=z;_e++){var We=i[_e];if(e.multiline){if(_e===z){ue+=We[W]+" ",W=(W+1)%We.length;continue}if(_e===R){ue+=We[We.length-1]+" ";continue}}ue+=We[0]+" "}switch(ue=ue.substr(ue.length-1)==" "?ue.substr(0,ue.length-1):ue,_=wb(ue,e,l).width,e.textAlign){case"right":m=o-_-2;break;case"center":m=(o-_)/2;break;case"left":default:m=2}t+=gs(m)+" "+gs(C)+` Td
`,t+="("+Tg(ue)+`) Tj
`,t+=-gs(m)+` 0 Td
`,C=-(l+2),_=0,R=oe?z:z+1,Y++,X=""}break}return r.text=t,r.fontSize=l,r},wb=function(e,t,n){var r=t.scope.internal.getFont(t.fontName,t.fontStyle),i=t.scope.getStringUnitWidth(e,{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:t.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:i}},uG={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},cG=function(e,t){var n={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(r){return r.type===n.type&&r.object===n.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(n)},hG=function(e,t){for(var n in e)if(e.hasOwnProperty(n)){var r=n,i=e[n];t.internal.newObjectDeferredBegin(i.objId,!0),Xo(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete e[r]}},dG=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(df.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(uG)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");DC=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new Gk,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in r)if(r.hasOwnProperty(i)){var l=r[i];l.objId=void 0,l.hasAnnotation&&cG(l,n)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(n){(function(r,i){var l=!r;for(var a in r||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(a)){var o=r[a],f=[],m=o.Rect;if(o.Rect&&(o.Rect=aG(o.Rect,i)),i.internal.newObjectDeferredBegin(o.objId,!0),o.DA=gi.createDefaultAppearanceStream(o),Xo(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(f=o.getKeyValueListForStream()),o.Rect=m,o.hasAppearanceStream&&!o.appearanceStreamContent){var _=lG(o);f.push({key:"AP",value:"<</N "+_+">>"}),i.internal.acroformPlugin.xForms.push(_)}if(o.appearanceStreamContent){var w="";for(var M in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(M)){var C=o.appearanceStreamContent[M];if(w+="/"+M+" ",w+="<<",Object.keys(C).length>=1||Array.isArray(C)){for(var a in C)if(C.hasOwnProperty(a)){var R=C[a];typeof R=="function"&&(R=R.call(i,o)),w+="/"+a+" "+R+" ",i.internal.acroformPlugin.xForms.indexOf(R)>=0||i.internal.acroformPlugin.xForms.push(R)}}else typeof(R=C)=="function"&&(R=R.call(i,o)),w+="/"+a+" "+R,i.internal.acroformPlugin.xForms.indexOf(R)>=0||i.internal.acroformPlugin.xForms.push(R);w+=">>"}f.push({key:"AP",value:`<<
`+w+">>"})}i.internal.putStream({additionalKeyValues:f,objectId:o.objId}),i.internal.out("endobj")}l&&hG(i.internal.acroformPlugin.xForms,i)})(n,e)}),e.internal.acroformPlugin.isInitialized=!0}},Vk=nu.__acroform__.arrayToPdfArray=function(e,t,n){var r=function(a){return a};if(Array.isArray(e)){for(var i="[",l=0;l<e.length;l++)switch(l!==0&&(i+=" "),Xo(e[l])){case"boolean":case"number":case"object":i+=e[l].toString();break;case"string":e[l].substr(0,1)!=="/"?(t!==void 0&&n&&(r=n.internal.getEncryptor(t)),i+="("+Tg(r(e[l].toString()))+")"):i+=e[l].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},G5=function(e,t,n){var r=function(i){return i};return t!==void 0&&n&&(r=n.internal.getEncryptor(t)),(e=e||"").toString(),e="("+Tg(r(e))+")"},Df=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Df.prototype.toString=function(){return this.objId+" 0 R"},Df.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Df.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(l){return l!="content"&&l!="appearanceStreamContent"&&l!="scope"&&l!="objId"&&l.substring(0,1)!="_"});for(var n in t)if(Object.getOwnPropertyDescriptor(this,t[n]).configurable===!1){var r=t[n],i=this[r];i&&(Array.isArray(i)?e.push({key:r,value:Vk(i,this.objId,this.scope)}):i instanceof Df?(i.scope=this.scope,e.push({key:r,value:i.objId+" 0 R"})):typeof i!="function"&&e.push({key:r,value:i}))}return e};var $k=function(){Df.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){e=n.trim()},get:function(){return e||null}})};Yh($k,Df);var Gk=function(){Df.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var n=function(r){return r};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+Tg(n(e))+")"}},set:function(n){e=n}})};Yh(Gk,Df);var df=function e(){Df.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(X){if(isNaN(X))throw new Error('Invalid value "'+X+'" for attribute F supplied.');t=X}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!wu(t,3)},set:function(X){X?this.F=Cu(t,3):this.F=Su(t,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(X){if(isNaN(X))throw new Error('Invalid value "'+X+'" for attribute Ff supplied.');n=X}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(X){r=X!==void 0?X:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(X){r[0]=X}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(X){r[1]=X}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(X){r[2]=X}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(X){r[3]=X}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(X){switch(X){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=X;break;default:throw new Error('Invalid value "'+X+'" for attribute FT supplied.')}}});var l=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!l||l.length<1){if(this instanceof qx)return;l="FieldObject"+e.FieldNum++}var X=function(Y){return Y};return this.scope&&(X=this.scope.internal.getEncryptor(this.objId)),"("+Tg(X(l))+")"},set:function(X){l=X.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return l},set:function(X){l=X}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(X){a=X}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(X){o=X}});var f=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return f},set:function(X){f=X}});var m=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return m===void 0?50/DC:m},set:function(X){m=X}});var _="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return _},set:function(X){_=X}});var w="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!w||this instanceof qx||this instanceof yg))return G5(w,this.objId,this.scope)},set:function(X){X=X.toString(),w=X}});var M=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(M)return this instanceof vc?M:G5(M,this.objId,this.scope)},set:function(X){X=X.toString(),M=this instanceof vc?X:X.substr(0,1)==="("?c0(X.substr(1,X.length-2)):c0(X)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof vc?c0(M.substr(1,M.length-1)):M},set:function(X){X=X.toString(),M=this instanceof vc?"/"+X:X}});var C=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(C)return C},set:function(X){this.V=X}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(C)return this instanceof vc?C:G5(C,this.objId,this.scope)},set:function(X){X=X.toString(),C=this instanceof vc?X:X.substr(0,1)==="("?c0(X.substr(1,X.length-2)):c0(X)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof vc?c0(C.substr(1,C.length-1)):C},set:function(X){X=X.toString(),C=this instanceof vc?"/"+X:X}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var R,z=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return z},set:function(X){X=!!X,z=X}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(R)return R},set:function(X){R=X}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!wu(this.Ff,1)},set:function(X){X?this.Ff=Cu(this.Ff,1):this.Ff=Su(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!wu(this.Ff,2)},set:function(X){X?this.Ff=Cu(this.Ff,2):this.Ff=Su(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!wu(this.Ff,3)},set:function(X){X?this.Ff=Cu(this.Ff,3):this.Ff=Su(this.Ff,3)}});var W=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(W!==null)return W},set:function(X){if([0,1,2].indexOf(X)===-1)throw new Error('Invalid value "'+X+'" for attribute Q supplied.');W=X}}),Object.defineProperty(this,"textAlign",{get:function(){var X;switch(W){case 0:default:X="left";break;case 1:X="center";break;case 2:X="right"}return X},configurable:!0,enumerable:!0,set:function(X){switch(X){case"right":case 2:W=2;break;case"center":case 1:W=1;break;case"left":case 0:default:W=0}}})};Yh(df,Df);var R0=function(){df.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(n){e=n}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Vk(t,this.objId,this.scope)},set:function(n){var r,i;i=[],typeof(r=n)=="string"&&(i=function(l,a,o){o||(o=1);for(var f,m=[];f=a.exec(l);)m.push(f[o]);return m}(r,/\((.*?)\)/g)),t=i}}),this.getOptions=function(){return t},this.setOptions=function(n){t=n,this.sort&&t.sort()},this.addOption=function(n){n=(n=n||"").toString(),t.push(n),this.sort&&t.sort()},this.removeOption=function(n,r){for(r=r||!1,n=(n=n||"").toString();t.indexOf(n)!==-1&&(t.splice(t.indexOf(n),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!wu(this.Ff,18)},set:function(n){n?this.Ff=Cu(this.Ff,18):this.Ff=Su(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!wu(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=Cu(this.Ff,19):this.Ff=Su(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!wu(this.Ff,20)},set:function(n){n?(this.Ff=Cu(this.Ff,20),t.sort()):this.Ff=Su(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!wu(this.Ff,22)},set:function(n){n?this.Ff=Cu(this.Ff,22):this.Ff=Su(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!wu(this.Ff,23)},set:function(n){n?this.Ff=Cu(this.Ff,23):this.Ff=Su(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!wu(this.Ff,27)},set:function(n){n?this.Ff=Cu(this.Ff,27):this.Ff=Su(this.Ff,27)}}),this.hasAppearanceStream=!1};Yh(R0,df);var B0=function(){R0.call(this),this.fontName="helvetica",this.combo=!1};Yh(B0,R0);var N0=function(){B0.call(this),this.combo=!0};Yh(N0,B0);var sx=function(){N0.call(this),this.edit=!0};Yh(sx,N0);var vc=function(){df.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!wu(this.Ff,15)},set:function(n){n?this.Ff=Cu(this.Ff,15):this.Ff=Su(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!wu(this.Ff,16)},set:function(n){n?this.Ff=Cu(this.Ff,16):this.Ff=Su(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!wu(this.Ff,17)},set:function(n){n?this.Ff=Cu(this.Ff,17):this.Ff=Su(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!wu(this.Ff,26)},set:function(n){n?this.Ff=Cu(this.Ff,26):this.Ff=Su(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(l){return l};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var r,i=[];for(r in i.push("<<"),t)i.push("/"+r+" ("+Tg(n(t[r]))+")");return i.push(">>"),i.join(`
`)}},set:function(n){Xo(n)==="object"&&(t=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(n){typeof n=="string"&&(t.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(n){e="/"+n}})};Yh(vc,df);var ox=function(){vc.call(this),this.pushButton=!0};Yh(ox,vc);var F0=function(){vc.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Yh(F0,vc);var qx=function(){var e,t;df.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(i){e=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(i){t=i}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(o){return o};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var l,a=[];for(l in a.push("<<"),r)a.push("/"+l+" ("+Tg(i(r[l]))+")");return a.push(">>"),a.join(`
`)},set:function(i){Xo(i)==="object"&&(r=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(i){typeof i=="string"&&(r.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(i){n=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(i){n="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=gi.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Yh(qx,df),F0.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var n=this.Kids[t];n.appearanceStreamContent=e.createAppearanceStream(n.optionName),n.caption=e.getCA()}},F0.prototype.createOption=function(e){var t=new qx;return t.Parent=this,t.optionName=e,this.Kids.push(t),fG.call(this.scope,t),t};var ax=function(){vc.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=gi.CheckBox.createAppearanceStream()};Yh(ax,vc);var yg=function(){df.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!wu(this.Ff,13)},set:function(t){t?this.Ff=Cu(this.Ff,13):this.Ff=Su(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!wu(this.Ff,21)},set:function(t){t?this.Ff=Cu(this.Ff,21):this.Ff=Su(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!wu(this.Ff,23)},set:function(t){t?this.Ff=Cu(this.Ff,23):this.Ff=Su(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!wu(this.Ff,24)},set:function(t){t?this.Ff=Cu(this.Ff,24):this.Ff=Su(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!wu(this.Ff,25)},set:function(t){t?this.Ff=Cu(this.Ff,25):this.Ff=Su(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!wu(this.Ff,26)},set:function(t){t?this.Ff=Cu(this.Ff,26):this.Ff=Su(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Yh(yg,df);var lx=function(){yg.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!wu(this.Ff,14)},set:function(e){e?this.Ff=Cu(this.Ff,14):this.Ff=Su(this.Ff,14)}}),this.password=!0};Yh(lx,yg);var gi={CheckBox:{createAppearanceStream:function(){return{N:{On:gi.CheckBox.YesNormal},D:{On:gi.CheckBox.YesPushDown,Off:gi.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Lf(e);t.scope=e.scope;var n=[],r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),l=l3(e,e.caption);return n.push("0.749023 g"),n.push("0 0 "+gs(gi.internal.getWidth(e))+" "+gs(gi.internal.getHeight(e))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+r+" "+gs(l.fontSize)+" Tf "+i),n.push("BT"),n.push(l.text),n.push("ET"),n.push("Q"),n.push("EMC"),t.stream=n.join(`
`),t},YesNormal:function(e){var t=Lf(e);t.scope=e.scope;var n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color),i=[],l=gi.internal.getHeight(e),a=gi.internal.getWidth(e),o=l3(e,e.caption);return i.push("1 g"),i.push("0 0 "+gs(a)+" "+gs(l)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+gs(a-1)+" "+gs(l-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+n+" "+gs(o.fontSize)+" Tf "+r),i.push(o.text),i.push("ET"),i.push("Q"),t.stream=i.join(`
`),t},OffPushDown:function(e){var t=Lf(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+gs(gi.internal.getWidth(e))+" "+gs(gi.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:gi.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=gi.RadioButton.Circle.YesNormal,t.D[e]=gi.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Lf(e);t.scope=e.scope;var n=[],r=gi.internal.getWidth(e)<=gi.internal.getHeight(e)?gi.internal.getWidth(e)/4:gi.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var i=gi.internal.Bezier_C,l=Number((r*i).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+Hp(gi.internal.getWidth(e)/2)+" "+Hp(gi.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+l+" "+l+" "+r+" 0 "+r+" c"),n.push("-"+l+" "+r+" -"+r+" "+l+" -"+r+" 0 c"),n.push("-"+r+" -"+l+" -"+l+" -"+r+" 0 -"+r+" c"),n.push(l+" -"+r+" "+r+" -"+l+" "+r+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t},YesPushDown:function(e){var t=Lf(e);t.scope=e.scope;var n=[],r=gi.internal.getWidth(e)<=gi.internal.getHeight(e)?gi.internal.getWidth(e)/4:gi.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),l=Number((i*gi.internal.Bezier_C).toFixed(5)),a=Number((r*gi.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Hp(gi.internal.getWidth(e)/2)+" "+Hp(gi.internal.getHeight(e)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+l+" "+l+" "+i+" 0 "+i+" c"),n.push("-"+l+" "+i+" -"+i+" "+l+" -"+i+" 0 c"),n.push("-"+i+" -"+l+" -"+l+" -"+i+" 0 -"+i+" c"),n.push(l+" -"+i+" "+i+" -"+l+" "+i+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+Hp(gi.internal.getWidth(e)/2)+" "+Hp(gi.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+a+" "+a+" "+r+" 0 "+r+" c"),n.push("-"+a+" "+r+" -"+r+" "+a+" -"+r+" 0 c"),n.push("-"+r+" -"+a+" -"+a+" -"+r+" 0 -"+r+" c"),n.push(a+" -"+r+" "+r+" -"+a+" "+r+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=Lf(e);t.scope=e.scope;var n=[],r=gi.internal.getWidth(e)<=gi.internal.getHeight(e)?gi.internal.getWidth(e)/4:gi.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),l=Number((i*gi.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Hp(gi.internal.getWidth(e)/2)+" "+Hp(gi.internal.getHeight(e)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+l+" "+l+" "+i+" 0 "+i+" c"),n.push("-"+l+" "+i+" -"+i+" "+l+" -"+i+" 0 c"),n.push("-"+i+" -"+l+" -"+l+" -"+i+" 0 -"+i+" c"),n.push(l+" -"+i+" "+i+" -"+l+" "+i+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:gi.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=gi.RadioButton.Cross.YesNormal,t.D[e]=gi.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Lf(e);t.scope=e.scope;var n=[],r=gi.internal.calculateCross(e);return n.push("q"),n.push("1 1 "+gs(gi.internal.getWidth(e)-2)+" "+gs(gi.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(gs(r.x1.x)+" "+gs(r.x1.y)+" m"),n.push(gs(r.x2.x)+" "+gs(r.x2.y)+" l"),n.push(gs(r.x4.x)+" "+gs(r.x4.y)+" m"),n.push(gs(r.x3.x)+" "+gs(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},YesPushDown:function(e){var t=Lf(e);t.scope=e.scope;var n=gi.internal.calculateCross(e),r=[];return r.push("0.749023 g"),r.push("0 0 "+gs(gi.internal.getWidth(e))+" "+gs(gi.internal.getHeight(e))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+gs(gi.internal.getWidth(e)-2)+" "+gs(gi.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(gs(n.x1.x)+" "+gs(n.x1.y)+" m"),r.push(gs(n.x2.x)+" "+gs(n.x2.y)+" l"),r.push(gs(n.x4.x)+" "+gs(n.x4.y)+" m"),r.push(gs(n.x3.x)+" "+gs(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=Lf(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+gs(gi.internal.getWidth(e))+" "+gs(gi.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+n}};gi.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=gi.internal.getWidth(e),n=gi.internal.getHeight(e),r=Math.min(t,n);return{x1:{x:(t-r)/2,y:(n-r)/2+r},x2:{x:(t-r)/2+r,y:(n-r)/2},x3:{x:(t-r)/2,y:(n-r)/2},x4:{x:(t-r)/2+r,y:(n-r)/2+r}}}},gi.internal.getWidth=function(e){var t=0;return Xo(e)==="object"&&(t=hP(e.Rect[2])),t},gi.internal.getHeight=function(e){var t=0;return Xo(e)==="object"&&(t=hP(e.Rect[3])),t};var fG=nu.addField=function(e){if(dG(this,e),!(e instanceof df))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};nu.AcroFormChoiceField=R0,nu.AcroFormListBox=B0,nu.AcroFormComboBox=N0,nu.AcroFormEditBox=sx,nu.AcroFormButton=vc,nu.AcroFormPushButton=ox,nu.AcroFormRadioButton=F0,nu.AcroFormCheckBox=ax,nu.AcroFormTextField=yg,nu.AcroFormPasswordField=lx,nu.AcroFormAppearance=gi,nu.AcroForm={ChoiceField:R0,ListBox:B0,ComboBox:N0,EditBox:sx,Button:vc,PushButton:ox,RadioButton:F0,CheckBox:ax,TextField:yg,PasswordField:lx,Appearance:gi},es.AcroForm={ChoiceField:R0,ListBox:B0,ComboBox:N0,EditBox:sx,Button:vc,PushButton:ox,RadioButton:F0,CheckBox:ax,TextField:yg,PasswordField:lx,Appearance:gi};es.AcroForm;function Hk(e){return e.reduce(function(t,n,r){return t[n]=r,t},{})}(function(e){e.__addimage__={};var t="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=e.__addimage__.getImageFileTypeByImageData=function(he,de){var Te,be,ae,ne,Se,Le=t;if((de=de||t)==="RGBA"||he.data!==void 0&&he.data instanceof Uint8ClampedArray&&"height"in he&&"width"in he)return"RGBA";if(me(he))for(Se in n)for(ae=n[Se],Te=0;Te<ae.length;Te+=1){for(ne=!0,be=0;be<ae[Te].length;be+=1)if(ae[Te][be]!==void 0&&ae[Te][be]!==he[be]){ne=!1;break}if(ne===!0){Le=Se;break}}else for(Se in n)for(ae=n[Se],Te=0;Te<ae.length;Te+=1){for(ne=!0,be=0;be<ae[Te].length;be+=1)if(ae[Te][be]!==void 0&&ae[Te][be]!==he.charCodeAt(be)){ne=!1;break}if(ne===!0){Le=Se;break}}return Le===t&&de!==t&&(Le=de),Le},i=function he(de){for(var Te=this.internal.write,be=this.internal.putStream,ae=(0,this.internal.getFilters)();ae.indexOf("FlateEncode")!==-1;)ae.splice(ae.indexOf("FlateEncode"),1);de.objectId=this.internal.newObject();var ne=[];if(ne.push({key:"Type",value:"/XObject"}),ne.push({key:"Subtype",value:"/Image"}),ne.push({key:"Width",value:de.width}),ne.push({key:"Height",value:de.height}),de.colorSpace===W.INDEXED?ne.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(de.palette.length/3-1)+" "+("sMask"in de&&de.sMask!==void 0?de.objectId+2:de.objectId+1)+" 0 R]"}):(ne.push({key:"ColorSpace",value:"/"+de.colorSpace}),de.colorSpace===W.DEVICE_CMYK&&ne.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ne.push({key:"BitsPerComponent",value:de.bitsPerComponent}),"decodeParameters"in de&&de.decodeParameters!==void 0&&ne.push({key:"DecodeParms",value:"<<"+de.decodeParameters+">>"}),"transparency"in de&&Array.isArray(de.transparency)){for(var Se="",Le=0,ze=de.transparency.length;Le<ze;Le++)Se+=de.transparency[Le]+" "+de.transparency[Le]+" ";ne.push({key:"Mask",value:"["+Se+"]"})}de.sMask!==void 0&&ne.push({key:"SMask",value:de.objectId+1+" 0 R"});var He=de.filter!==void 0?["/"+de.filter]:void 0;if(be({data:de.data,additionalKeyValues:ne,alreadyAppliedFilters:He,objectId:de.objectId}),Te("endobj"),"sMask"in de&&de.sMask!==void 0){var pt="/Predictor "+de.predictor+" /Colors 1 /BitsPerComponent "+de.bitsPerComponent+" /Columns "+de.width,ge={width:de.width,height:de.height,colorSpace:"DeviceGray",bitsPerComponent:de.bitsPerComponent,decodeParameters:pt,data:de.sMask};"filter"in de&&(ge.filter=de.filter),he.call(this,ge)}if(de.colorSpace===W.INDEXED){var Ie=this.internal.newObject();be({data:ue(new Uint8Array(de.palette)),objectId:Ie}),Te("endobj")}},l=function(){var he=this.internal.collections.addImage_images;for(var de in he)i.call(this,he[de])},a=function(){var he,de=this.internal.collections.addImage_images,Te=this.internal.write;for(var be in de)Te("/I"+(he=de[be]).index,he.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",l),this.internal.events.subscribe("putXobjectDict",a))},f=function(){var he=this.internal.collections.addImage_images;return o.call(this),he},m=function(){return Object.keys(this.internal.collections.addImage_images).length},_=function(he){return typeof e["process"+he.toUpperCase()]=="function"},w=function(he){return Xo(he)==="object"&&he.nodeType===1},M=function(he,de){if(he.nodeName==="IMG"&&he.hasAttribute("src")){var Te=""+he.getAttribute("src");if(Te.indexOf("data:image/")===0)return Kv(unescape(Te).split("base64,").pop());var be=e.loadFile(Te,!0);if(be!==void 0)return be}if(he.nodeName==="CANVAS"){if(he.width===0||he.height===0)throw new Error("Given canvas must have data. Canvas width: "+he.width+", height: "+he.height);var ae;switch(de){case"PNG":ae="image/png";break;case"WEBP":ae="image/webp";break;case"JPEG":case"JPG":default:ae="image/jpeg"}return Kv(he.toDataURL(ae,1).split("base64,").pop())}},C=function(he){var de=this.internal.collections.addImage_images;if(de){for(var Te in de)if(he===de[Te].alias)return de[Te]}},R=function(he,de,Te){return he||de||(he=-96,de=-96),he<0&&(he=-1*Te.width*72/he/this.internal.scaleFactor),de<0&&(de=-1*Te.height*72/de/this.internal.scaleFactor),he===0&&(he=de*Te.width/Te.height),de===0&&(de=he*Te.height/Te.width),[he,de]},z=function(he,de,Te,be,ae,ne){var Se=R.call(this,Te,be,ae),Le=this.internal.getCoordinateString,ze=this.internal.getVerticalCoordinateString,He=f.call(this);if(Te=Se[0],be=Se[1],He[ae.index]=ae,ne){ne*=Math.PI/180;var pt=Math.cos(ne),ge=Math.sin(ne),Ie=function(Ve){return Ve.toFixed(4)},Ne=[Ie(pt),Ie(ge),Ie(-1*ge),Ie(pt),0,0,"cm"]}this.internal.write("q"),ne?(this.internal.write([1,"0","0",1,Le(he),ze(de+be),"cm"].join(" ")),this.internal.write(Ne.join(" ")),this.internal.write([Le(Te),"0","0",Le(be),"0","0","cm"].join(" "))):this.internal.write([Le(Te),"0","0",Le(be),Le(he),ze(de+be),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ae.index+" Do"),this.internal.write("Q")},W=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var X=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},Y=e.__addimage__.sHashCode=function(he){var de,Te,be=0;if(typeof he=="string")for(Te=he.length,de=0;de<Te;de++)be=(be<<5)-be+he.charCodeAt(de),be|=0;else if(me(he))for(Te=he.byteLength/2,de=0;de<Te;de++)be=(be<<5)-be+he[de],be|=0;return be},Q=e.__addimage__.validateStringAsBase64=function(he){(he=he||"").toString().trim();var de=!0;return he.length===0&&(de=!1),he.length%4!=0&&(de=!1),/^[A-Za-z0-9+/]+$/.test(he.substr(0,he.length-2))===!1&&(de=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(he.substr(-2))===!1&&(de=!1),de},oe=e.__addimage__.extractImageFromDataUrl=function(he){var de=(he=he||"").split("base64,"),Te=null;if(de.length===2){var be=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(de[0]);Array.isArray(be)&&(Te={mimeType:be[1],charset:be[2],data:de[1]})}return Te},le=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(he){return le()&&he instanceof ArrayBuffer};var me=e.__addimage__.isArrayBufferView=function(he){return le()&&typeof Uint32Array<"u"&&(he instanceof Int8Array||he instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&he instanceof Uint8ClampedArray||he instanceof Int16Array||he instanceof Uint16Array||he instanceof Int32Array||he instanceof Uint32Array||he instanceof Float32Array||he instanceof Float64Array)},we=e.__addimage__.binaryStringToUint8Array=function(he){for(var de=he.length,Te=new Uint8Array(de),be=0;be<de;be++)Te[be]=he.charCodeAt(be);return Te},ue=e.__addimage__.arrayBufferToBinaryString=function(he){for(var de="",Te=me(he)?he:new Uint8Array(he),be=0;be<Te.length;be+=8192)de+=String.fromCharCode.apply(null,Te.subarray(be,be+8192));return de};e.addImage=function(){var he,de,Te,be,ae,ne,Se,Le,ze;if(typeof arguments[1]=="number"?(de=t,Te=arguments[1],be=arguments[2],ae=arguments[3],ne=arguments[4],Se=arguments[5],Le=arguments[6],ze=arguments[7]):(de=arguments[1],Te=arguments[2],be=arguments[3],ae=arguments[4],ne=arguments[5],Se=arguments[6],Le=arguments[7],ze=arguments[8]),Xo(he=arguments[0])==="object"&&!w(he)&&"imageData"in he){var He=he;he=He.imageData,de=He.format||de||t,Te=He.x||Te||0,be=He.y||be||0,ae=He.w||He.width||ae,ne=He.h||He.height||ne,Se=He.alias||Se,Le=He.compression||Le,ze=He.rotation||He.angle||ze}var pt=this.internal.getFilters();if(Le===void 0&&pt.indexOf("FlateEncode")!==-1&&(Le="SLOW"),isNaN(Te)||isNaN(be))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var ge=_e.call(this,he,de,Se,Le);return z.call(this,Te,be,ae,ne,ge,ze),this};var _e=function(he,de,Te,be){var ae,ne,Se;if(typeof he=="string"&&r(he)===t){he=unescape(he);var Le=We(he,!1);(Le!==""||(Le=e.loadFile(he,!0))!==void 0)&&(he=Le)}if(w(he)&&(he=M(he,de)),de=r(he,de),!_(de))throw new Error("addImage does not support files of type '"+de+"', please ensure that a plugin for '"+de+"' support is added.");if(((Se=Te)==null||Se.length===0)&&(Te=function(ze){return typeof ze=="string"||me(ze)?Y(ze):me(ze.data)?Y(ze.data):null}(he)),(ae=C.call(this,Te))||(le()&&(he instanceof Uint8Array||de==="RGBA"||(ne=he,he=we(he))),ae=this["process"+de.toUpperCase()](he,m.call(this),Te,function(ze){return ze&&typeof ze=="string"&&(ze=ze.toUpperCase()),ze in e.image_compression?ze:X.NONE}(be),ne)),!ae)throw new Error("An unknown error occurred whilst processing the image.");return ae},We=e.__addimage__.convertBase64ToBinaryString=function(he,de){var Te;de=typeof de!="boolean"||de;var be,ae="";if(typeof he=="string"){be=(Te=oe(he))!==null?Te.data:he;try{ae=Kv(be)}catch(ne){if(de)throw Q(be)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ne.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return ae};e.getImageProperties=function(he){var de,Te,be="";if(w(he)&&(he=M(he)),typeof he=="string"&&r(he)===t&&((be=We(he,!1))===""&&(be=e.loadFile(he)||""),he=be),Te=r(he),!_(Te))throw new Error("addImage does not support files of type '"+Te+"', please ensure that a plugin for '"+Te+"' support is added.");if(!le()||he instanceof Uint8Array||(he=we(he)),!(de=this["process"+Te.toUpperCase()](he)))throw new Error("An unknown error occurred whilst processing the image");return de.fileType=Te,de}})(es.API),function(e){var t=function(n){if(n!==void 0&&n!="")return!0};es.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(n){for(var r,i,l,a=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,f=this.internal.getPageInfoByObjId(n.objId),m=n.pageContext.annotations,_=!1,w=0;w<m.length&&!_;w++)switch((r=m[w]).type){case"link":(t(r.options.url)||t(r.options.pageNumber))&&(_=!0);break;case"reference":case"text":case"freetext":_=!0}if(_!=0){this.internal.write("/Annots [");for(var M=0;M<m.length;M++){r=m[M];var C=this.internal.pdfEscape,R=this.internal.getEncryptor(n.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var z=this.internal.newAdditionalObject(),W=this.internal.newAdditionalObject(),X=this.internal.getEncryptor(z.objId),Y=r.title||"Note";l="<</Type /Annot /Subtype /Text "+(i="/Rect ["+a(r.bounds.x)+" "+o(r.bounds.y+r.bounds.h)+" "+a(r.bounds.x+r.bounds.w)+" "+o(r.bounds.y)+"] ")+"/Contents ("+C(X(r.contents))+")",l+=" /Popup "+W.objId+" 0 R",l+=" /P "+f.objId+" 0 R",l+=" /T ("+C(X(Y))+") >>",z.content=l;var Q=z.objId+" 0 R";l="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+a(r.bounds.x+30)+" "+o(r.bounds.y+r.bounds.h)+" "+a(r.bounds.x+r.bounds.w+30)+" "+o(r.bounds.y)+"] ")+" /Parent "+Q,r.open&&(l+=" /Open true"),l+=" >>",W.content=l,this.internal.write(z.objId,"0 R",W.objId,"0 R");break;case"freetext":i="/Rect ["+a(r.bounds.x)+" "+o(r.bounds.y)+" "+a(r.bounds.x+r.bounds.w)+" "+o(r.bounds.y+r.bounds.h)+"] ";var oe=r.color||"#000000";l="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+C(R(r.contents))+")",l+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+oe+")",l+=" /Border [0 0 0]",l+=" >>",this.internal.write(l);break;case"link":if(r.options.name){var le=this.annotations._nameMap[r.options.name];r.options.pageNumber=le.page,r.options.top=le.y}else r.options.top||(r.options.top=0);if(i="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",l="",r.options.url)l="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+C(R(r.options.url))+") >>";else if(r.options.pageNumber)switch(l="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":l+=" /Fit]";break;case"FitH":l+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,l+=" /FitV "+r.options.left+"]";break;case"XYZ":default:var me=o(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),l+=" /XYZ "+r.options.left+" "+me+" "+r.options.zoom+"]"}l!=""&&(l+=" >>",this.internal.write(l))}}this.internal.write("]")}}]),e.createAnnotation=function(n){var r=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":r.pageContext.annotations.push(n)}},e.link=function(n,r,i,l,a){var o=this.internal.getCurrentPageInfo(),f=this.internal.getCoordinateString,m=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:f(n),y:m(r),w:f(n+i),h:m(r+l)},options:a,type:"link"})},e.textWithLink=function(n,r,i,l){var a,o,f=this.getTextWidth(n),m=this.internal.getLineHeight()/this.internal.scaleFactor;if(l.maxWidth!==void 0){o=l.maxWidth;var _=this.splitTextToSize(n,o).length;a=Math.ceil(m*_)}else o=f,a=m;return this.text(n,r,i,l),i+=.2*m,l.align==="center"&&(r-=f/2),l.align==="right"&&(r-=f),this.link(r,i-m,o,a,l),f},e.getTextWidth=function(n){var r=this.internal.getFontSize();return this.getStringUnitWidth(n)*r/this.internal.scaleFactor}}(es.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];e.__arabicParser__={};var l=e.__arabicParser__.isInArabicSubstitutionA=function(z){return t[z.charCodeAt(0)]!==void 0},a=e.__arabicParser__.isArabicLetter=function(z){return typeof z=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(z)},o=e.__arabicParser__.isArabicEndLetter=function(z){return a(z)&&l(z)&&t[z.charCodeAt(0)].length<=2},f=e.__arabicParser__.isArabicAlfLetter=function(z){return a(z)&&i.indexOf(z.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(z){return a(z)&&l(z)&&t[z.charCodeAt(0)].length>=1};var m=e.__arabicParser__.arabicLetterHasFinalForm=function(z){return a(z)&&l(z)&&t[z.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(z){return a(z)&&l(z)&&t[z.charCodeAt(0)].length>=3};var _=e.__arabicParser__.arabicLetterHasMedialForm=function(z){return a(z)&&l(z)&&t[z.charCodeAt(0)].length==4},w=e.__arabicParser__.resolveLigatures=function(z){var W=0,X=n,Y="",Q=0;for(W=0;W<z.length;W+=1)X[z.charCodeAt(W)]!==void 0?(Q++,typeof(X=X[z.charCodeAt(W)])=="number"&&(Y+=String.fromCharCode(X),X=n,Q=0),W===z.length-1&&(X=n,Y+=z.charAt(W-(Q-1)),W-=Q-1,Q=0)):(X=n,Y+=z.charAt(W-Q),W-=Q,Q=0);return Y};e.__arabicParser__.isArabicDiacritic=function(z){return z!==void 0&&r[z.charCodeAt(0)]!==void 0};var M=e.__arabicParser__.getCorrectForm=function(z,W,X){return a(z)?l(z)===!1?-1:!m(z)||!a(W)&&!a(X)||!a(X)&&o(W)||o(z)&&!a(W)||o(z)&&f(W)||o(z)&&o(W)?0:_(z)&&a(W)&&!o(W)&&a(X)&&m(X)?3:o(z)||!a(X)?1:2:-1},C=function(z){var W=0,X=0,Y=0,Q="",oe="",le="",me=(z=z||"").split("\\s+"),we=[];for(W=0;W<me.length;W+=1){for(we.push(""),X=0;X<me[W].length;X+=1)Q=me[W][X],oe=me[W][X-1],le=me[W][X+1],a(Q)?(Y=M(Q,oe,le),we[W]+=Y!==-1?String.fromCharCode(t[Q.charCodeAt(0)][Y]):Q):we[W]+=Q;we[W]=w(we[W])}return we.join(" ")},R=e.__arabicParser__.processArabic=e.processArabic=function(){var z,W=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,X=[];if(Array.isArray(W)){var Y=0;for(X=[],Y=0;Y<W.length;Y+=1)Array.isArray(W[Y])?X.push([C(W[Y][0]),W[Y][1],W[Y][2]]):X.push([C(W[Y])]);z=X}else z=C(W);return typeof arguments[0]=="string"?z:(arguments[0].text=z,arguments[0])};e.events.push(["preProcessText",R])}(es.API),es.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(e){var t=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(o){n=o}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(o){r=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(o){i=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var l=[];Object.defineProperty(this,"childNodes",{get:function(){return l},set:function(o){l=o}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(o){a=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(n,r){var i;if((n=n||"2d")!=="2d")return null;for(i in r)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=r[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(es.API),function(e){var t={left:0,top:0,bottom:0,right:0},n=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new l,this.internal.__cell__.pages=1},l=function(){var f=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return f},set:function(z){f=z}});var m=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return m},set:function(z){m=z}});var _=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return _},set:function(z){_=z}});var w=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return w},set:function(z){w=z}});var M=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return M},set:function(z){M=z}});var C=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return C},set:function(z){C=z}});var R=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return R},set:function(z){R=z}}),this};l.prototype.clone=function(){return new l(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},l.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(f){return r.call(this),this.internal.__cell__.headerFunction=typeof f=="function"?f:void 0,this},e.getTextDimensions=function(f,m){r.call(this);var _=(m=m||{}).fontSize||this.getFontSize(),w=m.font||this.getFont(),M=m.scaleFactor||this.internal.scaleFactor,C=0,R=0,z=0,W=this;if(!Array.isArray(f)&&typeof f!="string"){if(typeof f!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");f=String(f)}var X=m.maxWidth;X>0?typeof f=="string"?f=this.splitTextToSize(f,X):Object.prototype.toString.call(f)==="[object Array]"&&(f=f.reduce(function(Q,oe){return Q.concat(W.splitTextToSize(oe,X))},[])):f=Array.isArray(f)?f:[f];for(var Y=0;Y<f.length;Y++)C<(z=this.getStringUnitWidth(f[Y],{font:w})*_)&&(C=z);return C!==0&&(R=f.length),{w:C/=M,h:Math.max((R*_*this.getLineHeightFactor()-_*(this.getLineHeightFactor()-1))/M,0)}},e.cellAddPage=function(){r.call(this),this.addPage();var f=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new l(f.left,f.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=e.cell=function(){var f;f=arguments[0]instanceof l?arguments[0]:new l(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var m=this.internal.__cell__.lastCell,_=this.internal.__cell__.padding,w=this.internal.__cell__.margins||t,M=this.internal.__cell__.tableHeaderRow,C=this.internal.__cell__.printHeaders;return m.lineNumber!==void 0&&(m.lineNumber===f.lineNumber?(f.x=(m.x||0)+(m.width||0),f.y=m.y||0):m.y+m.height+f.height+w.bottom>this.getPageHeight()?(this.cellAddPage(),f.y=w.top,C&&M&&(this.printHeaderRow(f.lineNumber,!0),f.y+=M[0].height)):f.y=m.y+m.height||f.y),f.text[0]!==void 0&&(this.rect(f.x,f.y,f.width,f.height,n===!0?"FD":void 0),f.align==="right"?this.text(f.text,f.x+f.width-_,f.y+_,{align:"right",baseline:"top"}):f.align==="center"?this.text(f.text,f.x+f.width/2,f.y+_,{align:"center",baseline:"top",maxWidth:f.width-_-_}):this.text(f.text,f.x+_,f.y+_,{align:"left",baseline:"top",maxWidth:f.width-_-_})),this.internal.__cell__.lastCell=f,this};e.table=function(f,m,_,w,M){if(r.call(this),!_)throw new Error("No data for PDF table.");var C,R,z,W,X=[],Y=[],Q=[],oe={},le={},me=[],we=[],ue=(M=M||{}).autoSize||!1,_e=M.printHeaders!==!1,We=M.css&&M.css["font-size"]!==void 0?16*M.css["font-size"]:M.fontSize||12,he=M.margins||Object.assign({width:this.getPageWidth()},t),de=typeof M.padding=="number"?M.padding:3,Te=M.headerBackgroundColor||"#c8c8c8",be=M.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=_e,this.internal.__cell__.margins=he,this.internal.__cell__.table_font_size=We,this.internal.__cell__.padding=de,this.internal.__cell__.headerBackgroundColor=Te,this.internal.__cell__.headerTextColor=be,this.setFontSize(We),w==null)Y=X=Object.keys(_[0]),Q=X.map(function(){return"left"});else if(Array.isArray(w)&&Xo(w[0])==="object")for(X=w.map(function(He){return He.name}),Y=w.map(function(He){return He.prompt||He.name||""}),Q=w.map(function(He){return He.align||"left"}),C=0;C<w.length;C+=1)le[w[C].name]=w[C].width*(19.049976/25.4);else Array.isArray(w)&&typeof w[0]=="string"&&(Y=X=w,Q=X.map(function(){return"left"}));if(ue||Array.isArray(w)&&typeof w[0]=="string")for(C=0;C<X.length;C+=1){for(oe[W=X[C]]=_.map(function(He){return He[W]}),this.setFont(void 0,"bold"),me.push(this.getTextDimensions(Y[C],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),R=oe[W],this.setFont(void 0,"normal"),z=0;z<R.length;z+=1)me.push(this.getTextDimensions(R[z],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);le[W]=Math.max.apply(null,me)+de+de,me=[]}if(_e){var ae={};for(C=0;C<X.length;C+=1)ae[X[C]]={},ae[X[C]].text=Y[C],ae[X[C]].align=Q[C];var ne=o.call(this,ae,le);we=X.map(function(He){return new l(f,m,le[He],ne,ae[He].text,void 0,ae[He].align)}),this.setTableHeaderRow(we),this.printHeaderRow(1,!1)}var Se=w.reduce(function(He,pt){return He[pt.name]=pt.align,He},{});for(C=0;C<_.length;C+=1){"rowStart"in M&&M.rowStart instanceof Function&&M.rowStart({row:C,data:_[C]},this);var Le=o.call(this,_[C],le);for(z=0;z<X.length;z+=1){var ze=_[C][X[z]];"cellStart"in M&&M.cellStart instanceof Function&&M.cellStart({row:C,col:z,data:ze},this),a.call(this,new l(f,m,le[X[z]],Le,ze,C+2,Se[X[z]]))}}return this.internal.__cell__.table_x=f,this.internal.__cell__.table_y=m,this};var o=function(f,m){var _=this.internal.__cell__.padding,w=this.internal.__cell__.table_font_size,M=this.internal.scaleFactor;return Object.keys(f).map(function(C){var R=f[C];return this.splitTextToSize(R.hasOwnProperty("text")?R.text:R,m[C]-_-_)},this).map(function(C){return this.getLineHeightFactor()*C.length*w/M+_+_},this).reduce(function(C,R){return Math.max(C,R)},0)};e.setTableHeaderRow=function(f){r.call(this),this.internal.__cell__.tableHeaderRow=f},e.printHeaderRow=function(f,m){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var _;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var w=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new l(w[0],w[1],w[2],w[3],void 0,-1)}this.setFont(void 0,"bold");for(var M=[],C=0;C<this.internal.__cell__.tableHeaderRow.length;C+=1){_=this.internal.__cell__.tableHeaderRow[C].clone(),m&&(_.y=this.internal.__cell__.margins.top||0,M.push(_)),_.lineNumber=f;var R=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,_),this.setTextColor(R)}M.length>0&&this.setTableHeaderRow(M),this.setFont(void 0,"normal"),n=!1}}(es.API);var qk={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Wk=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],u3=Hk(Wk),Zk=[100,200,300,400,500,600,700,800,900],pG=Hk(Zk);function c3(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),n=function(l){return qk[l=l||"normal"]?l:"normal"}(e.style),r=function(l){if(!l)return 400;if(typeof l=="number")return l>=100&&l<=900&&l%100==0?l:400;if(/^\d00$/.test(l))return parseInt(l);switch(l){case"bold":return 700;case"normal":default:return 400}}(e.weight),i=function(l){return typeof u3[l=l||"normal"]=="number"?l:"normal"}(e.stretch);return{family:t,style:n,weight:r,stretch:i,src:e.src||[],ref:e.ref||{name:t,style:[i,n,r].join(" ")}}}function dP(e,t,n,r){var i;for(i=n;i>=0&&i<t.length;i+=r)if(e[t[i]])return e[t[i]];for(i=n;i>=0&&i<t.length;i-=r)if(e[t[i]])return e[t[i]]}var mG={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},fP={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function pP(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function gG(e,t,n){for(var r=(n=n||{}).defaultFontFamily||"times",i=Object.assign({},mG,n.genericFontFamilies||{}),l=null,a=null,o=0;o<t.length;++o)if(i[(l=c3(t[o])).family]&&(l.family=i[l.family]),e.hasOwnProperty(l.family)){a=e[l.family];break}if(!(a=a||e[r]))throw new Error("Could not find a font-family for the rule '"+pP(l)+"' and default family '"+r+"'.");if(a=function(f,m){if(m[f])return m[f];var _=u3[f],w=_<=u3.normal?-1:1,M=dP(m,Wk,_,w);if(!M)throw new Error("Could not find a matching font-stretch value for "+f);return M}(l.stretch,a),a=function(f,m){if(m[f])return m[f];for(var _=qk[f],w=0;w<_.length;++w)if(m[_[w]])return m[_[w]];throw new Error("Could not find a matching font-style for "+f)}(l.style,a),!(a=function(f,m){if(m[f])return m[f];if(f===400&&m[500])return m[500];if(f===500&&m[400])return m[400];var _=pG[f],w=dP(m,Zk,_,f<400?-1:1);if(!w)throw new Error("Could not find a matching font-weight for value "+f);return w}(l.weight,a)))throw new Error("Failed to resolve a font for the rule '"+pP(l)+"'.");return a}function mP(e){return e.trimLeft()}function yG(e,t){for(var n=0;n<e.length;){if(e.charAt(n)===t)return[e.substring(0,n),e.substring(n+1)];n+=1}return null}function vG(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var Cb,gP,yP,H5=["times"];(function(e){var t,n,r,i,l,a,o,f,m,_=function(ge){return ge=ge||{},this.isStrokeTransparent=ge.isStrokeTransparent||!1,this.strokeOpacity=ge.strokeOpacity||1,this.strokeStyle=ge.strokeStyle||"#000000",this.fillStyle=ge.fillStyle||"#000000",this.isFillTransparent=ge.isFillTransparent||!1,this.fillOpacity=ge.fillOpacity||1,this.font=ge.font||"10px sans-serif",this.textBaseline=ge.textBaseline||"alphabetic",this.textAlign=ge.textAlign||"left",this.lineWidth=ge.lineWidth||1,this.lineJoin=ge.lineJoin||"miter",this.lineCap=ge.lineCap||"butt",this.path=ge.path||[],this.transform=ge.transform!==void 0?ge.transform.clone():new f,this.globalCompositeOperation=ge.globalCompositeOperation||"normal",this.globalAlpha=ge.globalAlpha||1,this.clip_path=ge.clip_path||[],this.currentPoint=ge.currentPoint||new a,this.miterLimit=ge.miterLimit||10,this.lastPoint=ge.lastPoint||new a,this.lineDashOffset=ge.lineDashOffset||0,this.lineDash=ge.lineDash||[],this.margin=ge.margin||[0,0,0,0],this.prevPageLastElemOffset=ge.prevPageLastElemOffset||0,this.ignoreClearRect=typeof ge.ignoreClearRect!="boolean"||ge.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new w(this),t=this.internal.f2,n=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,l=this.internal.getVerticalCoordinate,a=this.internal.Point,o=this.internal.Rectangle,f=this.internal.Matrix,m=new _}]);var w=function(ge){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var Ie=ge;Object.defineProperty(this,"pdf",{get:function(){return Ie}});var Ne=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return Ne},set:function(Be){Ne=!!Be}});var Ve=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Ve},set:function(Be){Ve=!!Be}});var it=0;Object.defineProperty(this,"posX",{get:function(){return it},set:function(Be){isNaN(Be)||(it=Be)}});var lt=0;Object.defineProperty(this,"posY",{get:function(){return lt},set:function(Be){isNaN(Be)||(lt=Be)}}),Object.defineProperty(this,"margin",{get:function(){return m.margin},set:function(Be){var Ce;typeof Be=="number"?Ce=[Be,Be,Be,Be]:((Ce=new Array(4))[0]=Be[0],Ce[1]=Be.length>=2?Be[1]:Ce[0],Ce[2]=Be.length>=3?Be[2]:Ce[0],Ce[3]=Be.length>=4?Be[3]:Ce[1]),m.margin=Ce}});var Mt=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Mt},set:function(Be){Mt=Be}});var wt=0;Object.defineProperty(this,"lastBreak",{get:function(){return wt},set:function(Be){wt=Be}});var rn=[];Object.defineProperty(this,"pageBreaks",{get:function(){return rn},set:function(Be){rn=Be}}),Object.defineProperty(this,"ctx",{get:function(){return m},set:function(Be){Be instanceof _&&(m=Be)}}),Object.defineProperty(this,"path",{get:function(){return m.path},set:function(Be){m.path=Be}});var yn=[];Object.defineProperty(this,"ctxStack",{get:function(){return yn},set:function(Be){yn=Be}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Be){var Ce;Ce=M(Be),this.ctx.fillStyle=Ce.style,this.ctx.isFillTransparent=Ce.a===0,this.ctx.fillOpacity=Ce.a,this.pdf.setFillColor(Ce.r,Ce.g,Ce.b,{a:Ce.a}),this.pdf.setTextColor(Ce.r,Ce.g,Ce.b,{a:Ce.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Be){var Ce=M(Be);this.ctx.strokeStyle=Ce.style,this.ctx.isStrokeTransparent=Ce.a===0,this.ctx.strokeOpacity=Ce.a,Ce.a===0?this.pdf.setDrawColor(255,255,255):(Ce.a,this.pdf.setDrawColor(Ce.r,Ce.g,Ce.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Be){["butt","round","square"].indexOf(Be)!==-1&&(this.ctx.lineCap=Be,this.pdf.setLineCap(Be))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Be){isNaN(Be)||(this.ctx.lineWidth=Be,this.pdf.setLineWidth(Be))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Be){["bevel","round","miter"].indexOf(Be)!==-1&&(this.ctx.lineJoin=Be,this.pdf.setLineJoin(Be))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Be){isNaN(Be)||(this.ctx.miterLimit=Be,this.pdf.setMiterLimit(Be))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Be){this.ctx.textBaseline=Be}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Be){["right","end","center","left","start"].indexOf(Be)!==-1&&(this.ctx.textAlign=Be)}});var Pn=null;function De(Be,Ce){if(Pn===null){var ot=function(Dt){var Zt=[];return Object.keys(Dt).forEach(function(an){Dt[an].forEach(function(ln){var vn=null;switch(ln){case"bold":vn={family:an,weight:"bold"};break;case"italic":vn={family:an,style:"italic"};break;case"bolditalic":vn={family:an,weight:"bold",style:"italic"};break;case"":case"normal":vn={family:an}}vn!==null&&(vn.ref={name:an,style:ln},Zt.push(vn))})}),Zt}(Be.getFontList());Pn=function(Dt){for(var Zt={},an=0;an<Dt.length;++an){var ln=c3(Dt[an]),vn=ln.family,qn=ln.stretch,Kn=ln.style,cr=ln.weight;Zt[vn]=Zt[vn]||{},Zt[vn][qn]=Zt[vn][qn]||{},Zt[vn][qn][Kn]=Zt[vn][qn][Kn]||{},Zt[vn][qn][Kn][cr]=ln}return Zt}(ot.concat(Ce))}return Pn}var Ae=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ae},set:function(Be){Pn=null,Ae=Be}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Be){var Ce;if(this.ctx.font=Be,(Ce=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Be))!==null){var ot=Ce[1],Dt=(Ce[2],Ce[3]),Zt=Ce[4],an=(Ce[5],Ce[6]),ln=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Zt)[2];Zt=Math.floor(ln==="px"?parseFloat(Zt)*this.pdf.internal.scaleFactor:ln==="em"?parseFloat(Zt)*this.pdf.getFontSize():parseFloat(Zt)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Zt);var vn=function(Ht){var tn,Kt,Yn=[],ir=Ht.trim();if(ir==="")return H5;if(ir in fP)return[fP[ir]];for(;ir!=="";){switch(Kt=null,tn=(ir=mP(ir)).charAt(0)){case'"':case"'":Kt=yG(ir.substring(1),tn);break;default:Kt=vG(ir)}if(Kt===null||(Yn.push(Kt[0]),(ir=mP(Kt[1]))!==""&&ir.charAt(0)!==","))return H5;ir=ir.replace(/^,/,"")}return Yn}(an);if(this.fontFaces){var qn=gG(De(this.pdf,this.fontFaces),vn.map(function(Ht){return{family:Ht,stretch:"normal",weight:Dt,style:ot}}));this.pdf.setFont(qn.ref.name,qn.ref.style)}else{var Kn="";(Dt==="bold"||parseInt(Dt,10)>=700||ot==="bold")&&(Kn="bold"),ot==="italic"&&(Kn+="italic"),Kn.length===0&&(Kn="normal");for(var cr="",pr={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Dr=0;Dr<vn.length;Dr++){if(this.pdf.internal.getFont(vn[Dr],Kn,{noFallback:!0,disableWarning:!0})!==void 0){cr=vn[Dr];break}if(Kn==="bolditalic"&&this.pdf.internal.getFont(vn[Dr],"bold",{noFallback:!0,disableWarning:!0})!==void 0)cr=vn[Dr],Kn="bold";else if(this.pdf.internal.getFont(vn[Dr],"normal",{noFallback:!0,disableWarning:!0})!==void 0){cr=vn[Dr],Kn="normal";break}}if(cr===""){for(var zr=0;zr<vn.length;zr++)if(pr[vn[zr]]){cr=pr[vn[zr]];break}}cr=cr===""?"Times":cr,this.pdf.setFont(cr,Kn)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Be){this.ctx.globalCompositeOperation=Be}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Be){this.ctx.globalAlpha=Be}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Be){this.ctx.lineDashOffset=Be,pt.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Be){this.ctx.lineDash=Be,pt.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Be){this.ctx.ignoreClearRect=!!Be}})};w.prototype.setLineDash=function(ge){this.lineDash=ge},w.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},w.prototype.fill=function(){oe.call(this,"fill",!1)},w.prototype.stroke=function(){oe.call(this,"stroke",!1)},w.prototype.beginPath=function(){this.path=[{type:"begin"}]},w.prototype.moveTo=function(ge,Ie){if(isNaN(ge)||isNaN(Ie))throw xa.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var Ne=this.ctx.transform.applyToPoint(new a(ge,Ie));this.path.push({type:"mt",x:Ne.x,y:Ne.y}),this.ctx.lastPoint=new a(ge,Ie)},w.prototype.closePath=function(){var ge=new a(0,0),Ie=0;for(Ie=this.path.length-1;Ie!==-1;Ie--)if(this.path[Ie].type==="begin"&&Xo(this.path[Ie+1])==="object"&&typeof this.path[Ie+1].x=="number"){ge=new a(this.path[Ie+1].x,this.path[Ie+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(ge.x,ge.y)},w.prototype.lineTo=function(ge,Ie){if(isNaN(ge)||isNaN(Ie))throw xa.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var Ne=this.ctx.transform.applyToPoint(new a(ge,Ie));this.path.push({type:"lt",x:Ne.x,y:Ne.y}),this.ctx.lastPoint=new a(Ne.x,Ne.y)},w.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),oe.call(this,null,!0)},w.prototype.quadraticCurveTo=function(ge,Ie,Ne,Ve){if(isNaN(Ne)||isNaN(Ve)||isNaN(ge)||isNaN(Ie))throw xa.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var it=this.ctx.transform.applyToPoint(new a(Ne,Ve)),lt=this.ctx.transform.applyToPoint(new a(ge,Ie));this.path.push({type:"qct",x1:lt.x,y1:lt.y,x:it.x,y:it.y}),this.ctx.lastPoint=new a(it.x,it.y)},w.prototype.bezierCurveTo=function(ge,Ie,Ne,Ve,it,lt){if(isNaN(it)||isNaN(lt)||isNaN(ge)||isNaN(Ie)||isNaN(Ne)||isNaN(Ve))throw xa.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Mt=this.ctx.transform.applyToPoint(new a(it,lt)),wt=this.ctx.transform.applyToPoint(new a(ge,Ie)),rn=this.ctx.transform.applyToPoint(new a(Ne,Ve));this.path.push({type:"bct",x1:wt.x,y1:wt.y,x2:rn.x,y2:rn.y,x:Mt.x,y:Mt.y}),this.ctx.lastPoint=new a(Mt.x,Mt.y)},w.prototype.arc=function(ge,Ie,Ne,Ve,it,lt){if(isNaN(ge)||isNaN(Ie)||isNaN(Ne)||isNaN(Ve)||isNaN(it))throw xa.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(lt=!!lt,!this.ctx.transform.isIdentity){var Mt=this.ctx.transform.applyToPoint(new a(ge,Ie));ge=Mt.x,Ie=Mt.y;var wt=this.ctx.transform.applyToPoint(new a(0,Ne)),rn=this.ctx.transform.applyToPoint(new a(0,0));Ne=Math.sqrt(Math.pow(wt.x-rn.x,2)+Math.pow(wt.y-rn.y,2))}Math.abs(it-Ve)>=2*Math.PI&&(Ve=0,it=2*Math.PI),this.path.push({type:"arc",x:ge,y:Ie,radius:Ne,startAngle:Ve,endAngle:it,counterclockwise:lt})},w.prototype.arcTo=function(ge,Ie,Ne,Ve,it){throw new Error("arcTo not implemented.")},w.prototype.rect=function(ge,Ie,Ne,Ve){if(isNaN(ge)||isNaN(Ie)||isNaN(Ne)||isNaN(Ve))throw xa.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(ge,Ie),this.lineTo(ge+Ne,Ie),this.lineTo(ge+Ne,Ie+Ve),this.lineTo(ge,Ie+Ve),this.lineTo(ge,Ie),this.lineTo(ge+Ne,Ie),this.lineTo(ge,Ie)},w.prototype.fillRect=function(ge,Ie,Ne,Ve){if(isNaN(ge)||isNaN(Ie)||isNaN(Ne)||isNaN(Ve))throw xa.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!C.call(this)){var it={};this.lineCap!=="butt"&&(it.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(it.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(ge,Ie,Ne,Ve),this.fill(),it.hasOwnProperty("lineCap")&&(this.lineCap=it.lineCap),it.hasOwnProperty("lineJoin")&&(this.lineJoin=it.lineJoin)}},w.prototype.strokeRect=function(ge,Ie,Ne,Ve){if(isNaN(ge)||isNaN(Ie)||isNaN(Ne)||isNaN(Ve))throw xa.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");R.call(this)||(this.beginPath(),this.rect(ge,Ie,Ne,Ve),this.stroke())},w.prototype.clearRect=function(ge,Ie,Ne,Ve){if(isNaN(ge)||isNaN(Ie)||isNaN(Ne)||isNaN(Ve))throw xa.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(ge,Ie,Ne,Ve))},w.prototype.save=function(ge){ge=typeof ge!="boolean"||ge;for(var Ie=this.pdf.internal.getCurrentPageInfo().pageNumber,Ne=0;Ne<this.pdf.internal.getNumberOfPages();Ne++)this.pdf.setPage(Ne+1),this.pdf.internal.out("q");if(this.pdf.setPage(Ie),ge){this.ctx.fontSize=this.pdf.internal.getFontSize();var Ve=new _(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Ve}},w.prototype.restore=function(ge){ge=typeof ge!="boolean"||ge;for(var Ie=this.pdf.internal.getCurrentPageInfo().pageNumber,Ne=0;Ne<this.pdf.internal.getNumberOfPages();Ne++)this.pdf.setPage(Ne+1),this.pdf.internal.out("Q");this.pdf.setPage(Ie),ge&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},w.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var M=function(ge){var Ie,Ne,Ve,it;if(ge.isCanvasGradient===!0&&(ge=ge.getColor()),!ge)return{r:0,g:0,b:0,a:0,style:ge};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(ge))Ie=0,Ne=0,Ve=0,it=0;else{var lt=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(ge);if(lt!==null)Ie=parseInt(lt[1]),Ne=parseInt(lt[2]),Ve=parseInt(lt[3]),it=1;else if((lt=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(ge))!==null)Ie=parseInt(lt[1]),Ne=parseInt(lt[2]),Ve=parseInt(lt[3]),it=parseFloat(lt[4]);else{if(it=1,typeof ge=="string"&&ge.charAt(0)!=="#"){var Mt=new zk(ge);ge=Mt.ok?Mt.toHex():"#000000"}ge.length===4?(Ie=ge.substring(1,2),Ie+=Ie,Ne=ge.substring(2,3),Ne+=Ne,Ve=ge.substring(3,4),Ve+=Ve):(Ie=ge.substring(1,3),Ne=ge.substring(3,5),Ve=ge.substring(5,7)),Ie=parseInt(Ie,16),Ne=parseInt(Ne,16),Ve=parseInt(Ve,16)}}return{r:Ie,g:Ne,b:Ve,a:it,style:ge}},C=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},R=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};w.prototype.fillText=function(ge,Ie,Ne,Ve){if(isNaN(Ie)||isNaN(Ne)||typeof ge!="string")throw xa.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Ve=isNaN(Ve)?void 0:Ve,!C.call(this)){var it=Le(this.ctx.transform.rotation),lt=this.ctx.transform.scaleX;de.call(this,{text:ge,x:Ie,y:Ne,scale:lt,angle:it,align:this.textAlign,maxWidth:Ve})}},w.prototype.strokeText=function(ge,Ie,Ne,Ve){if(isNaN(Ie)||isNaN(Ne)||typeof ge!="string")throw xa.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!R.call(this)){Ve=isNaN(Ve)?void 0:Ve;var it=Le(this.ctx.transform.rotation),lt=this.ctx.transform.scaleX;de.call(this,{text:ge,x:Ie,y:Ne,scale:lt,renderingMode:"stroke",angle:it,align:this.textAlign,maxWidth:Ve})}},w.prototype.measureText=function(ge){if(typeof ge!="string")throw xa.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var Ie=this.pdf,Ne=this.pdf.internal.scaleFactor,Ve=Ie.internal.getFontSize(),it=Ie.getStringUnitWidth(ge)*Ve/Ie.internal.scaleFactor,lt=function(Mt){var wt=(Mt=Mt||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return wt}}),this};return new lt({width:it*=Math.round(96*Ne/72*1e4)/1e4})},w.prototype.scale=function(ge,Ie){if(isNaN(ge)||isNaN(Ie))throw xa.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var Ne=new f(ge,0,0,Ie,0,0);this.ctx.transform=this.ctx.transform.multiply(Ne)},w.prototype.rotate=function(ge){if(isNaN(ge))throw xa.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var Ie=new f(Math.cos(ge),Math.sin(ge),-Math.sin(ge),Math.cos(ge),0,0);this.ctx.transform=this.ctx.transform.multiply(Ie)},w.prototype.translate=function(ge,Ie){if(isNaN(ge)||isNaN(Ie))throw xa.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var Ne=new f(1,0,0,1,ge,Ie);this.ctx.transform=this.ctx.transform.multiply(Ne)},w.prototype.transform=function(ge,Ie,Ne,Ve,it,lt){if(isNaN(ge)||isNaN(Ie)||isNaN(Ne)||isNaN(Ve)||isNaN(it)||isNaN(lt))throw xa.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Mt=new f(ge,Ie,Ne,Ve,it,lt);this.ctx.transform=this.ctx.transform.multiply(Mt)},w.prototype.setTransform=function(ge,Ie,Ne,Ve,it,lt){ge=isNaN(ge)?1:ge,Ie=isNaN(Ie)?0:Ie,Ne=isNaN(Ne)?0:Ne,Ve=isNaN(Ve)?1:Ve,it=isNaN(it)?0:it,lt=isNaN(lt)?0:lt,this.ctx.transform=new f(ge,Ie,Ne,Ve,it,lt)};var z=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};w.prototype.drawImage=function(ge,Ie,Ne,Ve,it,lt,Mt,wt,rn){var yn=this.pdf.getImageProperties(ge),Pn=1,De=1,Ae=1,Be=1;Ve!==void 0&&wt!==void 0&&(Ae=wt/Ve,Be=rn/it,Pn=yn.width/Ve*wt/Ve,De=yn.height/it*rn/it),lt===void 0&&(lt=Ie,Mt=Ne,Ie=0,Ne=0),Ve!==void 0&&wt===void 0&&(wt=Ve,rn=it),Ve===void 0&&wt===void 0&&(wt=yn.width,rn=yn.height);for(var Ce,ot=this.ctx.transform.decompose(),Dt=Le(ot.rotate.shx),Zt=new f,an=(Zt=(Zt=(Zt=Zt.multiply(ot.translate)).multiply(ot.skew)).multiply(ot.scale)).applyToRectangle(new o(lt-Ie*Ae,Mt-Ne*Be,Ve*Pn,it*De)),ln=W.call(this,an),vn=[],qn=0;qn<ln.length;qn+=1)vn.indexOf(ln[qn])===-1&&vn.push(ln[qn]);if(Q(vn),this.autoPaging)for(var Kn=vn[0],cr=vn[vn.length-1],pr=Kn;pr<cr+1;pr++){this.pdf.setPage(pr);var Dr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],zr=pr===1?this.posY+this.margin[0]:this.margin[0],Ht=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],tn=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Kt=pr===1?0:Ht+(pr-2)*tn;if(this.ctx.clip_path.length!==0){var Yn=this.path;Ce=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=Y(Ce,this.posX+this.margin[3],-Kt+zr+this.ctx.prevPageLastElemOffset),le.call(this,"fill",!0),this.path=Yn}var ir=JSON.parse(JSON.stringify(an));ir=Y([ir],this.posX+this.margin[3],-Kt+zr+this.ctx.prevPageLastElemOffset)[0];var Fr=(pr>Kn||pr<cr)&&z.call(this);Fr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Dr,tn,null).clip().discardPath()),this.pdf.addImage(ge,"JPEG",ir.x,ir.y,ir.w,ir.h,null,null,Dt),Fr&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(ge,"JPEG",an.x,an.y,an.w,an.h,null,null,Dt)};var W=function(ge,Ie,Ne){var Ve=[];Ie=Ie||this.pdf.internal.pageSize.width,Ne=Ne||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var it=this.posY+this.ctx.prevPageLastElemOffset;switch(ge.type){default:case"mt":case"lt":Ve.push(Math.floor((ge.y+it)/Ne)+1);break;case"arc":Ve.push(Math.floor((ge.y+it-ge.radius)/Ne)+1),Ve.push(Math.floor((ge.y+it+ge.radius)/Ne)+1);break;case"qct":var lt=ze(this.ctx.lastPoint.x,this.ctx.lastPoint.y,ge.x1,ge.y1,ge.x,ge.y);Ve.push(Math.floor((lt.y+it)/Ne)+1),Ve.push(Math.floor((lt.y+lt.h+it)/Ne)+1);break;case"bct":var Mt=He(this.ctx.lastPoint.x,this.ctx.lastPoint.y,ge.x1,ge.y1,ge.x2,ge.y2,ge.x,ge.y);Ve.push(Math.floor((Mt.y+it)/Ne)+1),Ve.push(Math.floor((Mt.y+Mt.h+it)/Ne)+1);break;case"rect":Ve.push(Math.floor((ge.y+it)/Ne)+1),Ve.push(Math.floor((ge.y+ge.h+it)/Ne)+1)}for(var wt=0;wt<Ve.length;wt+=1)for(;this.pdf.internal.getNumberOfPages()<Ve[wt];)X.call(this);return Ve},X=function(){var ge=this.fillStyle,Ie=this.strokeStyle,Ne=this.font,Ve=this.lineCap,it=this.lineWidth,lt=this.lineJoin;this.pdf.addPage(),this.fillStyle=ge,this.strokeStyle=Ie,this.font=Ne,this.lineCap=Ve,this.lineWidth=it,this.lineJoin=lt},Y=function(ge,Ie,Ne){for(var Ve=0;Ve<ge.length;Ve++)switch(ge[Ve].type){case"bct":ge[Ve].x2+=Ie,ge[Ve].y2+=Ne;case"qct":ge[Ve].x1+=Ie,ge[Ve].y1+=Ne;case"mt":case"lt":case"arc":default:ge[Ve].x+=Ie,ge[Ve].y+=Ne}return ge},Q=function(ge){return ge.sort(function(Ie,Ne){return Ie-Ne})},oe=function(ge,Ie){for(var Ne,Ve,it=this.fillStyle,lt=this.strokeStyle,Mt=this.lineCap,wt=this.lineWidth,rn=Math.abs(wt*this.ctx.transform.scaleX),yn=this.lineJoin,Pn=JSON.parse(JSON.stringify(this.path)),De=JSON.parse(JSON.stringify(this.path)),Ae=[],Be=0;Be<De.length;Be++)if(De[Be].x!==void 0)for(var Ce=W.call(this,De[Be]),ot=0;ot<Ce.length;ot+=1)Ae.indexOf(Ce[ot])===-1&&Ae.push(Ce[ot]);for(var Dt=0;Dt<Ae.length;Dt++)for(;this.pdf.internal.getNumberOfPages()<Ae[Dt];)X.call(this);if(Q(Ae),this.autoPaging)for(var Zt=Ae[0],an=Ae[Ae.length-1],ln=Zt;ln<an+1;ln++){this.pdf.setPage(ln),this.fillStyle=it,this.strokeStyle=lt,this.lineCap=Mt,this.lineWidth=rn,this.lineJoin=yn;var vn=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],qn=ln===1?this.posY+this.margin[0]:this.margin[0],Kn=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],cr=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],pr=ln===1?0:Kn+(ln-2)*cr;if(this.ctx.clip_path.length!==0){var Dr=this.path;Ne=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=Y(Ne,this.posX+this.margin[3],-pr+qn+this.ctx.prevPageLastElemOffset),le.call(this,ge,!0),this.path=Dr}if(Ve=JSON.parse(JSON.stringify(Pn)),this.path=Y(Ve,this.posX+this.margin[3],-pr+qn+this.ctx.prevPageLastElemOffset),Ie===!1||ln===0){var zr=(ln>Zt||ln<an)&&z.call(this);zr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],vn,cr,null).clip().discardPath()),le.call(this,ge,Ie),zr&&this.pdf.restoreGraphicsState()}this.lineWidth=wt}else this.lineWidth=rn,le.call(this,ge,Ie),this.lineWidth=wt;this.path=Pn},le=function(ge,Ie){if((ge!=="stroke"||Ie||!R.call(this))&&(ge==="stroke"||Ie||!C.call(this))){for(var Ne,Ve,it=[],lt=this.path,Mt=0;Mt<lt.length;Mt++){var wt=lt[Mt];switch(wt.type){case"begin":it.push({begin:!0});break;case"close":it.push({close:!0});break;case"mt":it.push({start:wt,deltas:[],abs:[]});break;case"lt":var rn=it.length;if(lt[Mt-1]&&!isNaN(lt[Mt-1].x)&&(Ne=[wt.x-lt[Mt-1].x,wt.y-lt[Mt-1].y],rn>0)){for(;rn>=0;rn--)if(it[rn-1].close!==!0&&it[rn-1].begin!==!0){it[rn-1].deltas.push(Ne),it[rn-1].abs.push(wt);break}}break;case"bct":Ne=[wt.x1-lt[Mt-1].x,wt.y1-lt[Mt-1].y,wt.x2-lt[Mt-1].x,wt.y2-lt[Mt-1].y,wt.x-lt[Mt-1].x,wt.y-lt[Mt-1].y],it[it.length-1].deltas.push(Ne);break;case"qct":var yn=lt[Mt-1].x+2/3*(wt.x1-lt[Mt-1].x),Pn=lt[Mt-1].y+2/3*(wt.y1-lt[Mt-1].y),De=wt.x+2/3*(wt.x1-wt.x),Ae=wt.y+2/3*(wt.y1-wt.y),Be=wt.x,Ce=wt.y;Ne=[yn-lt[Mt-1].x,Pn-lt[Mt-1].y,De-lt[Mt-1].x,Ae-lt[Mt-1].y,Be-lt[Mt-1].x,Ce-lt[Mt-1].y],it[it.length-1].deltas.push(Ne);break;case"arc":it.push({deltas:[],abs:[],arc:!0}),Array.isArray(it[it.length-1].abs)&&it[it.length-1].abs.push(wt)}}Ve=Ie?null:ge==="stroke"?"stroke":"fill";for(var ot=!1,Dt=0;Dt<it.length;Dt++)if(it[Dt].arc)for(var Zt=it[Dt].abs,an=0;an<Zt.length;an++){var ln=Zt[an];ln.type==="arc"?ue.call(this,ln.x,ln.y,ln.radius,ln.startAngle,ln.endAngle,ln.counterclockwise,void 0,Ie,!ot):Te.call(this,ln.x,ln.y),ot=!0}else if(it[Dt].close===!0)this.pdf.internal.out("h"),ot=!1;else if(it[Dt].begin!==!0){var vn=it[Dt].start.x,qn=it[Dt].start.y;be.call(this,it[Dt].deltas,vn,qn),ot=!0}Ve&&_e.call(this,Ve),Ie&&We.call(this)}},me=function(ge){var Ie=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,Ne=Ie*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return ge-Ne;case"top":return ge+Ie-Ne;case"hanging":return ge+Ie-2*Ne;case"middle":return ge+Ie/2-Ne;case"ideographic":return ge;case"alphabetic":default:return ge}},we=function(ge){return ge+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};w.prototype.createLinearGradient=function(){var ge=function(){};return ge.colorStops=[],ge.addColorStop=function(Ie,Ne){this.colorStops.push([Ie,Ne])},ge.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},ge.isCanvasGradient=!0,ge},w.prototype.createPattern=function(){return this.createLinearGradient()},w.prototype.createRadialGradient=function(){return this.createLinearGradient()};var ue=function(ge,Ie,Ne,Ve,it,lt,Mt,wt,rn){for(var yn=ne.call(this,Ne,Ve,it,lt),Pn=0;Pn<yn.length;Pn++){var De=yn[Pn];Pn===0&&(rn?he.call(this,De.x1+ge,De.y1+Ie):Te.call(this,De.x1+ge,De.y1+Ie)),ae.call(this,ge,Ie,De.x2,De.y2,De.x3,De.y3,De.x4,De.y4)}wt?We.call(this):_e.call(this,Mt)},_e=function(ge){switch(ge){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},We=function(){this.pdf.clip(),this.pdf.discardPath()},he=function(ge,Ie){this.pdf.internal.out(n(ge)+" "+r(Ie)+" m")},de=function(ge){var Ie;switch(ge.align){case"right":case"end":Ie="right";break;case"center":Ie="center";break;case"left":case"start":default:Ie="left"}var Ne=this.pdf.getTextDimensions(ge.text),Ve=me.call(this,ge.y),it=we.call(this,Ve)-Ne.h,lt=this.ctx.transform.applyToPoint(new a(ge.x,Ve)),Mt=this.ctx.transform.decompose(),wt=new f;wt=(wt=(wt=wt.multiply(Mt.translate)).multiply(Mt.skew)).multiply(Mt.scale);for(var rn,yn,Pn,De=this.ctx.transform.applyToRectangle(new o(ge.x,Ve,Ne.w,Ne.h)),Ae=wt.applyToRectangle(new o(ge.x,it,Ne.w,Ne.h)),Be=W.call(this,Ae),Ce=[],ot=0;ot<Be.length;ot+=1)Ce.indexOf(Be[ot])===-1&&Ce.push(Be[ot]);if(Q(Ce),this.autoPaging)for(var Dt=Ce[0],Zt=Ce[Ce.length-1],an=Dt;an<Zt+1;an++){this.pdf.setPage(an);var ln=an===1?this.posY+this.margin[0]:this.margin[0],vn=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],qn=this.pdf.internal.pageSize.height-this.margin[2],Kn=qn-this.margin[0],cr=this.pdf.internal.pageSize.width-this.margin[1],pr=cr-this.margin[3],Dr=an===1?0:vn+(an-2)*Kn;if(this.ctx.clip_path.length!==0){var zr=this.path;rn=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=Y(rn,this.posX+this.margin[3],-1*Dr+ln),le.call(this,"fill",!0),this.path=zr}var Ht=Y([JSON.parse(JSON.stringify(Ae))],this.posX+this.margin[3],-Dr+ln+this.ctx.prevPageLastElemOffset)[0];ge.scale>=.01&&(yn=this.pdf.internal.getFontSize(),this.pdf.setFontSize(yn*ge.scale),Pn=this.lineWidth,this.lineWidth=Pn*ge.scale);var tn=this.autoPaging!=="text";if(tn||Ht.y+Ht.h<=qn){if(tn||Ht.y>=ln&&Ht.x<=cr){var Kt=tn?ge.text:this.pdf.splitTextToSize(ge.text,ge.maxWidth||cr-Ht.x)[0],Yn=Y([JSON.parse(JSON.stringify(De))],this.posX+this.margin[3],-Dr+ln+this.ctx.prevPageLastElemOffset)[0],ir=tn&&(an>Dt||an<Zt)&&z.call(this);ir&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],pr,Kn,null).clip().discardPath()),this.pdf.text(Kt,Yn.x,Yn.y,{angle:ge.angle,align:Ie,renderingMode:ge.renderingMode}),ir&&this.pdf.restoreGraphicsState()}}else Ht.y<qn&&(this.ctx.prevPageLastElemOffset+=qn-Ht.y);ge.scale>=.01&&(this.pdf.setFontSize(yn),this.lineWidth=Pn)}else ge.scale>=.01&&(yn=this.pdf.internal.getFontSize(),this.pdf.setFontSize(yn*ge.scale),Pn=this.lineWidth,this.lineWidth=Pn*ge.scale),this.pdf.text(ge.text,lt.x+this.posX,lt.y+this.posY,{angle:ge.angle,align:Ie,renderingMode:ge.renderingMode,maxWidth:ge.maxWidth}),ge.scale>=.01&&(this.pdf.setFontSize(yn),this.lineWidth=Pn)},Te=function(ge,Ie,Ne,Ve){Ne=Ne||0,Ve=Ve||0,this.pdf.internal.out(n(ge+Ne)+" "+r(Ie+Ve)+" l")},be=function(ge,Ie,Ne){return this.pdf.lines(ge,Ie,Ne,null,null)},ae=function(ge,Ie,Ne,Ve,it,lt,Mt,wt){this.pdf.internal.out([t(i(Ne+ge)),t(l(Ve+Ie)),t(i(it+ge)),t(l(lt+Ie)),t(i(Mt+ge)),t(l(wt+Ie)),"c"].join(" "))},ne=function(ge,Ie,Ne,Ve){for(var it=2*Math.PI,lt=Math.PI/2;Ie>Ne;)Ie-=it;var Mt=Math.abs(Ne-Ie);Mt<it&&Ve&&(Mt=it-Mt);for(var wt=[],rn=Ve?-1:1,yn=Ie;Mt>1e-5;){var Pn=yn+rn*Math.min(Mt,lt);wt.push(Se.call(this,ge,yn,Pn)),Mt-=Math.abs(Pn-yn),yn=Pn}return wt},Se=function(ge,Ie,Ne){var Ve=(Ne-Ie)/2,it=ge*Math.cos(Ve),lt=ge*Math.sin(Ve),Mt=it,wt=-lt,rn=Mt*Mt+wt*wt,yn=rn+Mt*it+wt*lt,Pn=4/3*(Math.sqrt(2*rn*yn)-yn)/(Mt*lt-wt*it),De=Mt-Pn*wt,Ae=wt+Pn*Mt,Be=De,Ce=-Ae,ot=Ve+Ie,Dt=Math.cos(ot),Zt=Math.sin(ot);return{x1:ge*Math.cos(Ie),y1:ge*Math.sin(Ie),x2:De*Dt-Ae*Zt,y2:De*Zt+Ae*Dt,x3:Be*Dt-Ce*Zt,y3:Be*Zt+Ce*Dt,x4:ge*Math.cos(Ne),y4:ge*Math.sin(Ne)}},Le=function(ge){return 180*ge/Math.PI},ze=function(ge,Ie,Ne,Ve,it,lt){var Mt=ge+.5*(Ne-ge),wt=Ie+.5*(Ve-Ie),rn=it+.5*(Ne-it),yn=lt+.5*(Ve-lt),Pn=Math.min(ge,it,Mt,rn),De=Math.max(ge,it,Mt,rn),Ae=Math.min(Ie,lt,wt,yn),Be=Math.max(Ie,lt,wt,yn);return new o(Pn,Ae,De-Pn,Be-Ae)},He=function(ge,Ie,Ne,Ve,it,lt,Mt,wt){var rn,yn,Pn,De,Ae,Be,Ce,ot,Dt,Zt,an,ln,vn,qn,Kn=Ne-ge,cr=Ve-Ie,pr=it-Ne,Dr=lt-Ve,zr=Mt-it,Ht=wt-lt;for(yn=0;yn<41;yn++)Dt=(Ce=(Pn=ge+(rn=yn/40)*Kn)+rn*((Ae=Ne+rn*pr)-Pn))+rn*(Ae+rn*(it+rn*zr-Ae)-Ce),Zt=(ot=(De=Ie+rn*cr)+rn*((Be=Ve+rn*Dr)-De))+rn*(Be+rn*(lt+rn*Ht-Be)-ot),yn==0?(an=Dt,ln=Zt,vn=Dt,qn=Zt):(an=Math.min(an,Dt),ln=Math.min(ln,Zt),vn=Math.max(vn,Dt),qn=Math.max(qn,Zt));return new o(Math.round(an),Math.round(ln),Math.round(vn-an),Math.round(qn-ln))},pt=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var ge,Ie,Ne=(ge=this.ctx.lineDash,Ie=this.ctx.lineDashOffset,JSON.stringify({lineDash:ge,lineDashOffset:Ie}));this.prevLineDash!==Ne&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=Ne)}}})(es.API),function(e){var t=function(l){var a,o,f,m,_,w,M,C,R,z;for(o=[],f=0,m=(l+=a="\0\0\0\0".slice(l.length%4||4)).length;m>f;f+=4)(_=(l.charCodeAt(f)<<24)+(l.charCodeAt(f+1)<<16)+(l.charCodeAt(f+2)<<8)+l.charCodeAt(f+3))!==0?(w=(_=((_=((_=((_=(_-(z=_%85))/85)-(R=_%85))/85)-(C=_%85))/85)-(M=_%85))/85)%85,o.push(w+33,M+33,C+33,R+33,z+33)):o.push(122);return function(W,X){for(var Y=X;Y>0;Y--)W.pop()}(o,a.length),String.fromCharCode.apply(String,o)+"~>"},n=function(l){var a,o,f,m,_,w=String,M="length",C=255,R="charCodeAt",z="slice",W="replace";for(l[z](-2),l=l[z](0,-2)[W](/\s/g,"")[W]("z","!!!!!"),f=[],m=0,_=(l+=a="uuuuu"[z](l[M]%5||5))[M];_>m;m+=5)o=52200625*(l[R](m)-33)+614125*(l[R](m+1)-33)+7225*(l[R](m+2)-33)+85*(l[R](m+3)-33)+(l[R](m+4)-33),f.push(C&o>>24,C&o>>16,C&o>>8,C&o);return function(X,Y){for(var Q=Y;Q>0;Q--)X.pop()}(f,a[M]),w.fromCharCode.apply(w,f)},r=function(l){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((l=l.replace(/\s/g,"")).indexOf(">")!==-1&&(l=l.substr(0,l.indexOf(">"))),l.length%2&&(l+="0"),a.test(l)===!1)return"";for(var o="",f=0;f<l.length;f+=2)o+=String.fromCharCode("0x"+(l[f]+l[f+1]));return o},i=function(l){for(var a=new Uint8Array(l.length),o=l.length;o--;)a[o]=l.charCodeAt(o);return l=(a=i3(a)).reduce(function(f,m){return f+String.fromCharCode(m)},"")};e.processDataByFilters=function(l,a){var o=0,f=l||"",m=[];for(typeof(a=a||[])=="string"&&(a=[a]),o=0;o<a.length;o+=1)switch(a[o]){case"ASCII85Decode":case"/ASCII85Decode":f=n(f),m.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":f=t(f),m.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":f=r(f),m.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":f=f.split("").map(function(_){return("0"+_.charCodeAt().toString(16)).slice(-2)}).join("")+">",m.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":f=i(f),m.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[o]+'" is not implemented')}return{data:f,reverseChain:m.reverse().join(" ")}}}(es.API),function(e){e.loadFile=function(t,n,r){return function(i,l,a){l=l!==!1,a=typeof a=="function"?a:function(){};var o=void 0;try{o=function(f,m,_){var w=new XMLHttpRequest,M=0,C=function(R){var z=R.length,W=[],X=String.fromCharCode;for(M=0;M<z;M+=1)W.push(X(255&R.charCodeAt(M)));return W.join("")};if(w.open("GET",f,!m),w.overrideMimeType("text/plain; charset=x-user-defined"),m===!1&&(w.onload=function(){w.status===200?_(C(this.responseText)):_(void 0)}),w.send(null),m&&w.status===200)return C(w.responseText)}(i,l,a)}catch{}return o}(t,n,r)},e.loadImageFile=e.loadFile}(es.API),function(e){function t(){return(ts.html2canvas?Promise.resolve(ts.html2canvas):Dd(()=>import("./html2canvas.esm.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))}).then(function(a){return a.default?a.default:a})}function n(){return(ts.DOMPurify?Promise.resolve(ts.DOMPurify):Dd(()=>import("./purify.es.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load dompurify: "+a))}).then(function(a){return a.default?a.default:a})}var r=function(a){var o=Xo(a);return o==="undefined"?"undefined":o==="string"||a instanceof String?"string":o==="number"||a instanceof Number?"number":o==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":o==="object"?"object":"unknown"},i=function(a,o){var f=document.createElement(a);for(var m in o.className&&(f.className=o.className),o.innerHTML&&o.dompurify&&(f.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)f.style[m]=o.style[m];return f},l=function a(o){var f=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),m=a.convert(Promise.resolve(),f);return m=(m=m.setProgress(1,a,1,[a])).set(o)};(l.prototype=Object.create(Promise.prototype)).constructor=l,l.convert=function(a,o){return a.__proto__=o||l.prototype,a},l.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},l.prototype.from=function(a,o){return this.then(function(){switch(o=o||function(f){switch(r(f)){case"string":return"string";case"element":return f.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(a)){case"string":return this.then(n).then(function(f){return this.set({src:i("div",{innerHTML:a,dompurify:f})})});case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}})},l.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},l.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=function f(m,_){for(var w=m.nodeType===3?document.createTextNode(m.nodeValue):m.cloneNode(!1),M=m.firstChild;M;M=M.nextSibling)_!==!0&&M.nodeType===1&&M.nodeName==="SCRIPT"||w.appendChild(f(M,_));return m.nodeType===1&&(m.nodeName==="CANVAS"?(w.width=m.width,w.height=m.height,w.getContext("2d").drawImage(m,0,0)):m.nodeName!=="TEXTAREA"&&m.nodeName!=="SELECT"||(w.value=m.value),w.addEventListener("load",function(){w.scrollTop=m.scrollTop,w.scrollLeft=m.scrollLeft},!0)),w}(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},l.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(t).then(function(o){var f=Object.assign({},this.opt.html2canvas);return delete f.onrendered,o(this.prop.container,f)}).then(function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},l.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(t).then(function(o){var f=this.opt.jsPDF,m=this.opt.fontFaces,_=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,w=Object.assign({async:!0,allowTaint:!0,scale:_,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete w.onrendered,f.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,f.context2d.posX=this.opt.x,f.context2d.posY=this.opt.y,f.context2d.margin=this.opt.margin,f.context2d.fontFaces=m,m)for(var M=0;M<m.length;++M){var C=m[M],R=C.src.find(function(z){return z.format==="truetype"});R&&f.addFont(R.url,C.ref.name,C.ref.style)}return w.windowHeight=w.windowHeight||0,w.windowHeight=w.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):w.windowHeight,f.context2d.save(!0),o(this.prop.container,w)}).then(function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},l.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a})},l.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},l.prototype.output=function(a,o,f){return(f=f||"pdf").toLowerCase()==="img"||f.toLowerCase()==="image"?this.outputImg(a,o):this.outputPdf(a,o)},l.prototype.outputPdf=function(a,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(a,o)})},l.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}})},l.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},l.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},l.prototype.set=function(a){if(r(a)!=="object")return this;var o=Object.keys(a||{}).map(function(f){if(f in l.template.prop)return function(){this.prop[f]=a[f]};switch(f){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[f]=a[f]}}},this);return this.then(function(){return this.thenList(o)})},l.prototype.get=function(a,o){return this.then(function(){var f=a in l.template.prop?this.prop[a]:this.opt[a];return o?o(f):f})},l.prototype.setMargin=function(a){return this.then(function(){switch(r(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a}).then(this.setPageSize)},l.prototype.setPageSize=function(a){function o(f,m){return Math.floor(f*m/72*96)}return this.then(function(){(a=a||es.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:o(a.inner.width,a.k),height:o(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a})},l.prototype.setProgress=function(a,o,f,m){return a!=null&&(this.progress.val=a),o!=null&&(this.progress.state=o),f!=null&&(this.progress.n=f),m!=null&&(this.progress.stack=m),this.progress.ratio=this.progress.val/this.progress.state,this},l.prototype.updateProgress=function(a,o,f,m){return this.setProgress(a?this.progress.val+a:null,o||null,f?this.progress.n+f:null,m?this.progress.stack.concat(m):null)},l.prototype.then=function(a,o){var f=this;return this.thenCore(a,o,function(m,_){return f.updateProgress(null,null,1,[m]),Promise.prototype.then.call(this,function(w){return f.updateProgress(null,m),w}).then(m,_).then(function(w){return f.updateProgress(1),w})})},l.prototype.thenCore=function(a,o,f){f=f||Promise.prototype.then,a&&(a=a.bind(this)),o&&(o=o.bind(this));var m=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:l.convert(Object.assign({},this),Promise.prototype),_=f.call(m,a,o);return l.convert(_,this.__proto__)},l.prototype.thenExternal=function(a,o){return Promise.prototype.then.call(this,a,o)},l.prototype.thenList=function(a){var o=this;return a.forEach(function(f){o=o.thenCore(f)}),o},l.prototype.catch=function(a){a&&(a=a.bind(this));var o=Promise.prototype.catch.call(this,a);return l.convert(o,this)},l.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},l.prototype.error=function(a){return this.then(function(){throw new Error(a)})},l.prototype.using=l.prototype.set,l.prototype.saveAs=l.prototype.save,l.prototype.export=l.prototype.output,l.prototype.run=l.prototype.then,es.getPageSize=function(a,o,f){if(Xo(a)==="object"){var m=a;a=m.orientation,o=m.unit||o,f=m.format||f}o=o||"mm",f=f||"a4",a=(""+(a||"P")).toLowerCase();var _,w=(""+f).toLowerCase(),M={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":_=1;break;case"mm":_=72/25.4;break;case"cm":_=72/2.54;break;case"in":_=72;break;case"px":_=.75;break;case"pc":case"em":_=12;break;case"ex":_=6;break;default:throw"Invalid unit: "+o}var C,R=0,z=0;if(M.hasOwnProperty(w))R=M[w][1]/_,z=M[w][0]/_;else try{R=f[1],z=f[0]}catch{throw new Error("Invalid format: "+f)}if(a==="p"||a==="portrait")a="p",z>R&&(C=z,z=R,R=C);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",R>z&&(C=z,z=R,R=C)}return{width:z,height:R,unit:o,k:_,orientation:a}},e.html=function(a,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(c3):null;var f=new l(o);return o.worker?f:f.from(a).doCallback()}}(es.API),es.API.addJS=function(e){return yP=e,this.internal.events.subscribe("postPutResources",function(){Cb=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Cb+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),gP=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+yP+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Cb!==void 0&&gP!==void 0&&this.internal.out("/Names <</JavaScript "+Cb+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var n=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=n.outline.render().split(/\r\n/),l=0;l<i.length;l++){var a=i[l],o=r.exec(a);if(o!=null){var f=o[1];n.internal.newObjectDeferredBegin(f,!1)}n.internal.write(a)}if(this.outline.createNamedDestinations){var m=this.internal.pages.length,_=[];for(l=0;l<m;l++){var w=n.internal.newObject();_.push(w);var M=n.internal.getPageInfo(l+1);n.internal.write("<< /D["+M.objId+" 0 R /XYZ null null null]>> endobj")}var C=n.internal.newObject();for(n.internal.write("<< /Names [ "),l=0;l<_.length;l++)n.internal.write("(page_"+(l+1)+")"+_[l]+" 0 R");n.internal.write(" ] >>","endobj"),t=n.internal.newObject(),n.internal.write("<< /Dests "+C+" 0 R"),n.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(r,i,l){var a={title:i,options:l,children:[]};return r==null&&(r=this.root),r.children.push(a),a},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(r){r.id=n.internal.newObjectDeferred();for(var i=0;i<r.children.length;i++)this.genIds_r(r.children[i])},n.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},n.outline.renderItems=function(r){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,l=0;l<r.children.length;l++){var a=r.children[l];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(r)),l>0&&this.line("/Prev "+this.makeRef(r.children[l-1])),l<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[l+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var o=this.count=this.count_r({count:0},a);if(o>0&&this.line("/Count "+o),a.options&&a.options.pageNumber){var f=n.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+f.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var m=0;m<r.children.length;m++)this.renderItems(r.children[m])},n.outline.line=function(r){this.ctx.val+=r+`\r
`},n.outline.makeRef=function(r){return r.id+" 0 R"},n.outline.makeString=function(r){return"("+n.internal.pdfEscape(r)+")"},n.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(r,i){for(var l=0;l<i.children.length;l++)r.count++,this.count_r(r,i.children[l]);return r.count}}])}(es.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(n,r,i,l,a,o){var f,m=this.decode.DCT_DECODE,_=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=a||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,(f=function(w){for(var M,C=256*w.charCodeAt(4)+w.charCodeAt(5),R=w.length,z={width:0,height:0,numcomponents:1},W=4;W<R;W+=2){if(W+=C,t.indexOf(w.charCodeAt(W+1))!==-1){M=256*w.charCodeAt(W+5)+w.charCodeAt(W+6),z={width:256*w.charCodeAt(W+7)+w.charCodeAt(W+8),height:M,numcomponents:w.charCodeAt(W+9)};break}C=256*w.charCodeAt(W+2)+w.charCodeAt(W+3)}return z}(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}_={data:n,width:f.width,height:f.height,colorSpace:o,bitsPerComponent:8,filter:m,index:r,alias:i}}return _}}(es.API);var h0,Sb,vP,_P,bP,_G=function(){var e,t,n;function r(l){var a,o,f,m,_,w,M,C,R,z,W,X,Y,Q;for(this.data=l,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},w=null;;){switch(a=this.readUInt32(),R=(function(){var oe,le;for(le=[],oe=0;oe<4;++oe)le.push(String.fromCharCode(this.data[this.pos++]));return le}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(a);break;case"fcTL":w&&this.animation.frames.push(w),this.pos+=4,w={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},_=this.readUInt16(),m=this.readUInt16()||100,w.delay=1e3*_/m,w.disposeOp=this.data[this.pos++],w.blendOp=this.data[this.pos++],w.data=[];break;case"IDAT":case"fdAT":for(R==="fdAT"&&(this.pos+=4,a-=4),l=(w!=null?w.data:void 0)||this.imgData,X=0;0<=a?X<a:X>a;0<=a?++X:--X)l.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(f=this.palette.length/3,this.transparency.indexed=this.read(a),this.transparency.indexed.length>f)throw new Error("More transparent colors than palette size");if((z=f-this.transparency.indexed.length)>0)for(Y=0;0<=z?Y<z:Y>z;0<=z?++Y:--Y)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(a)[0];break;case 2:this.transparency.rgb=this.read(a)}break;case"tEXt":M=(W=this.read(a)).indexOf(0),C=String.fromCharCode.apply(String,W.slice(0,M)),this.text[C]=String.fromCharCode.apply(String,W.slice(M+1));break;case"IEND":return w&&this.animation.frames.push(w),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(Q=this.colorType)===4||Q===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=a}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}r.prototype.read=function(l){var a,o;for(o=[],a=0;0<=l?a<l:a>l;0<=l?++a:--a)o.push(this.data[this.pos++]);return o},r.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.decodePixels=function(l){var a=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*a),f=0,m=this;if(l==null&&(l=this.imgData),l.length===0)return new Uint8Array(0);function _(w,M,C,R){var z,W,X,Y,Q,oe,le,me,we,ue,_e,We,he,de,Te,be,ae,ne,Se,Le,ze,He=Math.ceil((m.width-w)/C),pt=Math.ceil((m.height-M)/R),ge=m.width==He&&m.height==pt;for(de=a*He,We=ge?o:new Uint8Array(de*pt),oe=l.length,he=0,W=0;he<pt&&f<oe;){switch(l[f++]){case 0:for(Y=ae=0;ae<de;Y=ae+=1)We[W++]=l[f++];break;case 1:for(Y=ne=0;ne<de;Y=ne+=1)z=l[f++],Q=Y<a?0:We[W-a],We[W++]=(z+Q)%256;break;case 2:for(Y=Se=0;Se<de;Y=Se+=1)z=l[f++],X=(Y-Y%a)/a,Te=he&&We[(he-1)*de+X*a+Y%a],We[W++]=(Te+z)%256;break;case 3:for(Y=Le=0;Le<de;Y=Le+=1)z=l[f++],X=(Y-Y%a)/a,Q=Y<a?0:We[W-a],Te=he&&We[(he-1)*de+X*a+Y%a],We[W++]=(z+Math.floor((Q+Te)/2))%256;break;case 4:for(Y=ze=0;ze<de;Y=ze+=1)z=l[f++],X=(Y-Y%a)/a,Q=Y<a?0:We[W-a],he===0?Te=be=0:(Te=We[(he-1)*de+X*a+Y%a],be=X&&We[(he-1)*de+(X-1)*a+Y%a]),le=Q+Te-be,me=Math.abs(le-Q),ue=Math.abs(le-Te),_e=Math.abs(le-be),we=me<=ue&&me<=_e?Q:ue<=_e?Te:be,We[W++]=(z+we)%256;break;default:throw new Error("Invalid filter algorithm: "+l[f-1])}if(!ge){var Ie=((M+he*R)*m.width+w)*a,Ne=he*de;for(Y=0;Y<He;Y+=1){for(var Ve=0;Ve<a;Ve+=1)o[Ie++]=We[Ne++];Ie+=(C-1)*a}}he++}}return l=X$(l),m.interlaceMethod==1?(_(0,0,8,8),_(4,0,8,8),_(0,4,4,8),_(2,0,4,4),_(0,2,2,4),_(1,0,2,2),_(0,1,1,2)):_(0,0,1,1),o},r.prototype.decodePalette=function(){var l,a,o,f,m,_,w,M,C;for(o=this.palette,_=this.transparency.indexed||[],m=new Uint8Array((_.length||0)+o.length),f=0,l=0,a=w=0,M=o.length;w<M;a=w+=3)m[f++]=o[a],m[f++]=o[a+1],m[f++]=o[a+2],m[f++]=(C=_[l++])!=null?C:255;return m},r.prototype.copyToImageData=function(l,a){var o,f,m,_,w,M,C,R,z,W,X;if(f=this.colors,z=null,o=this.hasAlphaChannel,this.palette.length&&(z=(X=this._decodedPalette)!=null?X:this._decodedPalette=this.decodePalette(),f=4,o=!0),R=(m=l.data||l).length,w=z||a,_=M=0,f===1)for(;_<R;)C=z?4*a[_/4]:M,W=w[C++],m[_++]=W,m[_++]=W,m[_++]=W,m[_++]=o?w[C++]:255,M=C;else for(;_<R;)C=z?4*a[_/4]:M,m[_++]=w[C++],m[_++]=w[C++],m[_++]=w[C++],m[_++]=o?w[C++]:255,M=C},r.prototype.decode=function(){var l;return l=new Uint8Array(this.width*this.height*4),this.copyToImageData(l,this.decodePixels()),l};var i=function(){if(Object.prototype.toString.call(ts)==="[object Window]"){try{t=ts.document.createElement("canvas"),n=t.getContext("2d")}catch{return!1}return!0}return!1};return i(),e=function(l){var a;if(i()===!0)return n.width=l.width,n.height=l.height,n.clearRect(0,0,l.width,l.height),n.putImageData(l,0,0),(a=new Image).src=t.toDataURL(),a;throw new Error("This method requires a Browser with Canvas-capability.")},r.prototype.decodeFrames=function(l){var a,o,f,m,_,w,M,C;if(this.animation){for(C=[],o=_=0,w=(M=this.animation.frames).length;_<w;o=++_)a=M[o],f=l.createImageData(a.width,a.height),m=this.decodePixels(new Uint8Array(a.data)),this.copyToImageData(f,m),a.imageData=f,C.push(a.image=e(f));return C}},r.prototype.renderFrame=function(l,a){var o,f,m;return o=(f=this.animation.frames)[a],m=f[a-1],a===0&&l.clearRect(0,0,this.width,this.height),(m!=null?m.disposeOp:void 0)===1?l.clearRect(m.xOffset,m.yOffset,m.width,m.height):(m!=null?m.disposeOp:void 0)===2&&l.putImageData(m.imageData,m.xOffset,m.yOffset),o.blendOp===0&&l.clearRect(o.xOffset,o.yOffset,o.width,o.height),l.drawImage(o.image,o.xOffset,o.yOffset)},r.prototype.animate=function(l){var a,o,f,m,_,w,M=this;return o=0,w=this.animation,m=w.numFrames,f=w.frames,_=w.numPlays,(a=function(){var C,R;if(C=o++%m,R=f[C],M.renderFrame(l,C),m>1&&o/m<_)return M.animation._timeout=setTimeout(a,R.delay)})()},r.prototype.stopAnimation=function(){var l;return clearTimeout((l=this.animation)!=null?l._timeout:void 0)},r.prototype.render=function(l){var a,o;return l._png&&l._png.stopAnimation(),l._png=this,l.width=this.width,l.height=this.height,a=l.getContext("2d"),this.animation?(this.decodeFrames(a),this.animate(a)):(o=a.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),a.putImageData(o,0,0))},r}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function bG(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=e[t++]|e[t++]<<8,r=e[t++]|e[t++]<<8,i=e[t++],l=i>>7,a=1<<(7&i)+1;e[t++],e[t++];var o=null,f=null;l&&(o=t,f=a,t+=3*a);var m=!0,_=[],w=0,M=null,C=0,R=null;for(this.width=n,this.height=r;m&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,R=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((he=e[t++])>=0))throw Error("Invalid block size");if(he===0)break;t+=he}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var z=e[t++];w=e[t++]|e[t++]<<8,M=e[t++],!(1&z)&&(M=null),C=z>>2&7,t++;break;case 254:for(;;){if(!((he=e[t++])>=0))throw Error("Invalid block size");if(he===0)break;t+=he}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var W=e[t++]|e[t++]<<8,X=e[t++]|e[t++]<<8,Y=e[t++]|e[t++]<<8,Q=e[t++]|e[t++]<<8,oe=e[t++],le=oe>>6&1,me=1<<(7&oe)+1,we=o,ue=f,_e=!1;oe>>7&&(_e=!0,we=t,ue=me,t+=3*me);var We=t;for(t++;;){var he;if(!((he=e[t++])>=0))throw Error("Invalid block size");if(he===0)break;t+=he}_.push({x:W,y:X,width:Y,height:Q,has_local_palette:_e,palette_offset:we,palette_size:ue,data_offset:We,data_length:t-We,transparent_index:M,interlaced:!!le,delay:w,disposal:C});break;case 59:m=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return _.length},this.loopCount=function(){return R},this.frameInfo=function(de){if(de<0||de>=_.length)throw new Error("Frame index out of range.");return _[de]},this.decodeAndBlitFrameBGRA=function(de,Te){var be=this.frameInfo(de),ae=be.width*be.height,ne=new Uint8Array(ae);xP(e,be.data_offset,ne,ae);var Se=be.palette_offset,Le=be.transparent_index;Le===null&&(Le=256);var ze=be.width,He=n-ze,pt=ze,ge=4*(be.y*n+be.x),Ie=4*((be.y+be.height)*n+be.x),Ne=ge,Ve=4*He;be.interlaced===!0&&(Ve+=4*n*7);for(var it=8,lt=0,Mt=ne.length;lt<Mt;++lt){var wt=ne[lt];if(pt===0&&(pt=ze,(Ne+=Ve)>=Ie&&(Ve=4*He+4*n*(it-1),Ne=ge+(ze+He)*(it<<1),it>>=1)),wt===Le)Ne+=4;else{var rn=e[Se+3*wt],yn=e[Se+3*wt+1],Pn=e[Se+3*wt+2];Te[Ne++]=Pn,Te[Ne++]=yn,Te[Ne++]=rn,Te[Ne++]=255}--pt}},this.decodeAndBlitFrameRGBA=function(de,Te){var be=this.frameInfo(de),ae=be.width*be.height,ne=new Uint8Array(ae);xP(e,be.data_offset,ne,ae);var Se=be.palette_offset,Le=be.transparent_index;Le===null&&(Le=256);var ze=be.width,He=n-ze,pt=ze,ge=4*(be.y*n+be.x),Ie=4*((be.y+be.height)*n+be.x),Ne=ge,Ve=4*He;be.interlaced===!0&&(Ve+=4*n*7);for(var it=8,lt=0,Mt=ne.length;lt<Mt;++lt){var wt=ne[lt];if(pt===0&&(pt=ze,(Ne+=Ve)>=Ie&&(Ve=4*He+4*n*(it-1),Ne=ge+(ze+He)*(it<<1),it>>=1)),wt===Le)Ne+=4;else{var rn=e[Se+3*wt],yn=e[Se+3*wt+1],Pn=e[Se+3*wt+2];Te[Ne++]=rn,Te[Ne++]=yn,Te[Ne++]=Pn,Te[Ne++]=255}--pt}}}function xP(e,t,n,r){for(var i=e[t++],l=1<<i,a=l+1,o=a+1,f=i+1,m=(1<<f)-1,_=0,w=0,M=0,C=e[t++],R=new Int32Array(4096),z=null;;){for(;_<16&&C!==0;)w|=e[t++]<<_,_+=8,C===1?C=e[t++]:--C;if(_<f)break;var W=w&m;if(w>>=f,_-=f,W!==l){if(W===a)break;for(var X=W<o?W:z,Y=0,Q=X;Q>l;)Q=R[Q]>>8,++Y;var oe=Q;if(M+Y+(X!==W?1:0)>r)return void xa.log("Warning, gif stream longer than expected.");n[M++]=oe;var le=M+=Y;for(X!==W&&(n[M++]=oe),Q=X;Y--;)Q=R[Q],n[--le]=255&Q,Q>>=8;z!==null&&o<4096&&(R[o++]=z<<8|oe,o>=m+1&&f<12&&(++f,m=m<<1|1)),z=W}else o=a+1,m=(1<<(f=i+1))-1,z=null}return M!==r&&xa.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function q5(e){var t,n,r,i,l,a=Math.floor,o=new Array(64),f=new Array(64),m=new Array(64),_=new Array(64),w=new Array(65535),M=new Array(65535),C=new Array(64),R=new Array(64),z=[],W=0,X=7,Y=new Array(64),Q=new Array(64),oe=new Array(64),le=new Array(256),me=new Array(2048),we=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],ue=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],_e=[0,1,2,3,4,5,6,7,8,9,10,11],We=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],he=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],de=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Te=[0,1,2,3,4,5,6,7,8,9,10,11],be=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ae=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ne(ge,Ie){for(var Ne=0,Ve=0,it=new Array,lt=1;lt<=16;lt++){for(var Mt=1;Mt<=ge[lt];Mt++)it[Ie[Ve]]=[],it[Ie[Ve]][0]=Ne,it[Ie[Ve]][1]=lt,Ve++,Ne++;Ne*=2}return it}function Se(ge){for(var Ie=ge[0],Ne=ge[1]-1;Ne>=0;)Ie&1<<Ne&&(W|=1<<X),Ne--,--X<0&&(W==255?(Le(255),Le(0)):Le(W),X=7,W=0)}function Le(ge){z.push(ge)}function ze(ge){Le(ge>>8&255),Le(255&ge)}function He(ge,Ie,Ne,Ve,it){for(var lt,Mt=it[0],wt=it[240],rn=function(Zt,an){var ln,vn,qn,Kn,cr,pr,Dr,zr,Ht,tn,Kt=0;for(Ht=0;Ht<8;++Ht){ln=Zt[Kt],vn=Zt[Kt+1],qn=Zt[Kt+2],Kn=Zt[Kt+3],cr=Zt[Kt+4],pr=Zt[Kt+5],Dr=Zt[Kt+6];var Yn=ln+(zr=Zt[Kt+7]),ir=ln-zr,Fr=vn+Dr,Ft=vn-Dr,je=qn+pr,Ze=qn-pr,et=Kn+cr,ct=Kn-cr,$e=Yn+et,Gt=Yn-et,hn=Fr+je,Ot=Fr-je;Zt[Kt]=$e+hn,Zt[Kt+4]=$e-hn;var cn=.707106781*(Ot+Gt);Zt[Kt+2]=Gt+cn,Zt[Kt+6]=Gt-cn;var En=.382683433*(($e=ct+Ze)-(Ot=Ft+ir)),wn=.5411961*$e+En,Qn=1.306562965*Ot+En,Lr=.707106781*(hn=Ze+Ft),Yt=ir+Lr,vt=ir-Lr;Zt[Kt+5]=vt+wn,Zt[Kt+3]=vt-wn,Zt[Kt+1]=Yt+Qn,Zt[Kt+7]=Yt-Qn,Kt+=8}for(Kt=0,Ht=0;Ht<8;++Ht){ln=Zt[Kt],vn=Zt[Kt+8],qn=Zt[Kt+16],Kn=Zt[Kt+24],cr=Zt[Kt+32],pr=Zt[Kt+40],Dr=Zt[Kt+48];var Tn=ln+(zr=Zt[Kt+56]),bn=ln-zr,br=vn+Dr,vr=vn-Dr,Cn=qn+pr,pn=qn-pr,Ut=Kn+cr,Hn=Kn-cr,or=Tn+Ut,Xr=Tn-Ut,ri=br+Cn,ai=br-Cn;Zt[Kt]=or+ri,Zt[Kt+32]=or-ri;var Pr=.707106781*(ai+Xr);Zt[Kt+16]=Xr+Pr,Zt[Kt+48]=Xr-Pr;var As=.382683433*((or=Hn+pn)-(ai=vr+bn)),$i=.5411961*or+As,Qa=1.306562965*ai+As,pi=.707106781*(ri=pn+vr),Li=bn+pi,Yi=bn-pi;Zt[Kt+40]=Yi+$i,Zt[Kt+24]=Yi-$i,Zt[Kt+8]=Li+Qa,Zt[Kt+56]=Li-Qa,Kt++}for(Ht=0;Ht<64;++Ht)tn=Zt[Ht]*an[Ht],C[Ht]=tn>0?tn+.5|0:tn-.5|0;return C}(ge,Ie),yn=0;yn<64;++yn)R[we[yn]]=rn[yn];var Pn=R[0]-Ne;Ne=R[0],Pn==0?Se(Ve[0]):(Se(Ve[M[lt=32767+Pn]]),Se(w[lt]));for(var De=63;De>0&&R[De]==0;)De--;if(De==0)return Se(Mt),Ne;for(var Ae,Be=1;Be<=De;){for(var Ce=Be;R[Be]==0&&Be<=De;)++Be;var ot=Be-Ce;if(ot>=16){Ae=ot>>4;for(var Dt=1;Dt<=Ae;++Dt)Se(wt);ot&=15}lt=32767+R[Be],Se(it[(ot<<4)+M[lt]]),Se(w[lt]),Be++}return De!=63&&Se(Mt),Ne}function pt(ge){ge=Math.min(Math.max(ge,1),100),l!=ge&&(function(Ie){for(var Ne=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Ve=0;Ve<64;Ve++){var it=a((Ne[Ve]*Ie+50)/100);it=Math.min(Math.max(it,1),255),o[we[Ve]]=it}for(var lt=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Mt=0;Mt<64;Mt++){var wt=a((lt[Mt]*Ie+50)/100);wt=Math.min(Math.max(wt,1),255),f[we[Mt]]=wt}for(var rn=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],yn=0,Pn=0;Pn<8;Pn++)for(var De=0;De<8;De++)m[yn]=1/(o[we[yn]]*rn[Pn]*rn[De]*8),_[yn]=1/(f[we[yn]]*rn[Pn]*rn[De]*8),yn++}(ge<50?Math.floor(5e3/ge):Math.floor(200-2*ge)),l=ge)}this.encode=function(ge,Ie){Ie&&pt(Ie),z=new Array,W=0,X=7,ze(65496),ze(65504),ze(16),Le(74),Le(70),Le(73),Le(70),Le(0),Le(1),Le(1),Le(0),ze(1),ze(1),Le(0),Le(0),function(){ze(65499),ze(132),Le(0);for(var vn=0;vn<64;vn++)Le(o[vn]);Le(1);for(var qn=0;qn<64;qn++)Le(f[qn])}(),function(vn,qn){ze(65472),ze(17),Le(8),ze(qn),ze(vn),Le(3),Le(1),Le(17),Le(0),Le(2),Le(17),Le(1),Le(3),Le(17),Le(1)}(ge.width,ge.height),function(){ze(65476),ze(418),Le(0);for(var vn=0;vn<16;vn++)Le(ue[vn+1]);for(var qn=0;qn<=11;qn++)Le(_e[qn]);Le(16);for(var Kn=0;Kn<16;Kn++)Le(We[Kn+1]);for(var cr=0;cr<=161;cr++)Le(he[cr]);Le(1);for(var pr=0;pr<16;pr++)Le(de[pr+1]);for(var Dr=0;Dr<=11;Dr++)Le(Te[Dr]);Le(17);for(var zr=0;zr<16;zr++)Le(be[zr+1]);for(var Ht=0;Ht<=161;Ht++)Le(ae[Ht])}(),ze(65498),ze(12),Le(3),Le(1),Le(0),Le(2),Le(17),Le(3),Le(17),Le(0),Le(63),Le(0);var Ne=0,Ve=0,it=0;W=0,X=7,this.encode.displayName="_encode_";for(var lt,Mt,wt,rn,yn,Pn,De,Ae,Be,Ce=ge.data,ot=ge.width,Dt=ge.height,Zt=4*ot,an=0;an<Dt;){for(lt=0;lt<Zt;){for(yn=Zt*an+lt,De=-1,Ae=0,Be=0;Be<64;Be++)Pn=yn+(Ae=Be>>3)*Zt+(De=4*(7&Be)),an+Ae>=Dt&&(Pn-=Zt*(an+1+Ae-Dt)),lt+De>=Zt&&(Pn-=lt+De-Zt+4),Mt=Ce[Pn++],wt=Ce[Pn++],rn=Ce[Pn++],Y[Be]=(me[Mt]+me[wt+256>>0]+me[rn+512>>0]>>16)-128,Q[Be]=(me[Mt+768>>0]+me[wt+1024>>0]+me[rn+1280>>0]>>16)-128,oe[Be]=(me[Mt+1280>>0]+me[wt+1536>>0]+me[rn+1792>>0]>>16)-128;Ne=He(Y,m,Ne,t,r),Ve=He(Q,_,Ve,n,i),it=He(oe,_,it,n,i),lt+=32}an+=8}if(X>=0){var ln=[];ln[1]=X+1,ln[0]=(1<<X+1)-1,Se(ln)}return ze(65497),new Uint8Array(z)},e=e||50,function(){for(var ge=String.fromCharCode,Ie=0;Ie<256;Ie++)le[Ie]=ge(Ie)}(),t=ne(ue,_e),n=ne(de,Te),r=ne(We,he),i=ne(be,ae),function(){for(var ge=1,Ie=2,Ne=1;Ne<=15;Ne++){for(var Ve=ge;Ve<Ie;Ve++)M[32767+Ve]=Ne,w[32767+Ve]=[],w[32767+Ve][1]=Ne,w[32767+Ve][0]=Ve;for(var it=-(Ie-1);it<=-ge;it++)M[32767+it]=Ne,w[32767+it]=[],w[32767+it][1]=Ne,w[32767+it][0]=Ie-1+it;ge<<=1,Ie<<=1}}(),function(){for(var ge=0;ge<256;ge++)me[ge]=19595*ge,me[ge+256>>0]=38470*ge,me[ge+512>>0]=7471*ge+32768,me[ge+768>>0]=-11059*ge,me[ge+1024>>0]=-21709*ge,me[ge+1280>>0]=32768*ge+8421375,me[ge+1536>>0]=-27439*ge,me[ge+1792>>0]=-5329*ge}(),pt(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Kd(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function wP(e){function t(ue){if(!ue)throw Error("assert :P")}function n(ue,_e,We){for(var he=0;4>he;he++)if(ue[_e+he]!=We.charCodeAt(he))return!0;return!1}function r(ue,_e,We,he,de){for(var Te=0;Te<de;Te++)ue[_e+Te]=We[he+Te]}function i(ue,_e,We,he){for(var de=0;de<he;de++)ue[_e+de]=We}function l(ue){return new Int32Array(ue)}function a(ue,_e){for(var We=[],he=0;he<ue;he++)We.push(new _e);return We}function o(ue,_e){var We=[];return function he(de,Te,be){for(var ae=be[Te],ne=0;ne<ae&&(de.push(be.length>Te+1?[]:new _e),!(be.length<Te+1));ne++)he(de[ne],Te+1,be)}(We,0,ue),We}var f=function(){var ue=this;function _e(B,H){for(var ie=1<<H-1>>>0;B&ie;)ie>>>=1;return ie?(B&ie-1)+ie:B}function We(B,H,ie,Ee,Ye){t(!(Ee%ie));do B[H+(Ee-=ie)]=Ye;while(0<Ee)}function he(B,H,ie,Ee,Ye){if(t(2328>=Ye),512>=Ye)var rt=l(512);else if((rt=l(Ye))==null)return 0;return function(ut,ht,gt,kt,_n,Vn){var Un,kn,ur=ht,Zn=1<<gt,Qt=l(16),Sn=l(16);for(t(_n!=0),t(kt!=null),t(ut!=null),t(0<gt),kn=0;kn<_n;++kn){if(15<kt[kn])return 0;++Qt[kt[kn]]}if(Qt[0]==_n)return 0;for(Sn[1]=0,Un=1;15>Un;++Un){if(Qt[Un]>1<<Un)return 0;Sn[Un+1]=Sn[Un]+Qt[Un]}for(kn=0;kn<_n;++kn)Un=kt[kn],0<kt[kn]&&(Vn[Sn[Un]++]=kn);if(Sn[15]==1)return(kt=new de).g=0,kt.value=Vn[0],We(ut,ur,1,Zn,kt),Zn;var fr,Cr=-1,gr=Zn-1,qr=0,Ur=1,ei=1,y=1<<gt;for(kn=0,Un=1,_n=2;Un<=gt;++Un,_n<<=1){if(Ur+=ei<<=1,0>(ei-=Qt[Un]))return 0;for(;0<Qt[Un];--Qt[Un])(kt=new de).g=Un,kt.value=Vn[kn++],We(ut,ur+qr,_n,y,kt),qr=_e(qr,Un)}for(Un=gt+1,_n=2;15>=Un;++Un,_n<<=1){if(Ur+=ei<<=1,0>(ei-=Qt[Un]))return 0;for(;0<Qt[Un];--Qt[Un]){if(kt=new de,(qr&gr)!=Cr){for(ur+=y,fr=1<<(Cr=Un)-gt;15>Cr&&!(0>=(fr-=Qt[Cr]));)++Cr,fr<<=1;Zn+=y=1<<(fr=Cr-gt),ut[ht+(Cr=qr&gr)].g=fr+gt,ut[ht+Cr].value=ur-ht-Cr}kt.g=Un-gt,kt.value=Vn[kn++],We(ut,ur+(qr>>gt),_n,y,kt),qr=_e(qr,Un)}}return Ur!=2*Sn[15]-1?0:Zn}(B,H,ie,Ee,Ye,rt)}function de(){this.value=this.g=0}function Te(){this.value=this.g=0}function be(){this.G=a(5,de),this.H=l(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(_o,Te)}function ae(B,H,ie,Ee){t(B!=null),t(H!=null),t(2147483648>Ee),B.Ca=254,B.I=0,B.b=-8,B.Ka=0,B.oa=H,B.pa=ie,B.Jd=H,B.Yc=ie+Ee,B.Zc=4<=Ee?ie+Ee-4+1:ie,lt(B)}function ne(B,H){for(var ie=0;0<H--;)ie|=wt(B,128)<<H;return ie}function Se(B,H){var ie=ne(B,H);return Mt(B)?-ie:ie}function Le(B,H,ie,Ee){var Ye,rt=0;for(t(B!=null),t(H!=null),t(4294967288>Ee),B.Sb=Ee,B.Ra=0,B.u=0,B.h=0,4<Ee&&(Ee=4),Ye=0;Ye<Ee;++Ye)rt+=H[ie+Ye]<<8*Ye;B.Ra=rt,B.bb=Ee,B.oa=H,B.pa=ie}function ze(B){for(;8<=B.u&&B.bb<B.Sb;)B.Ra>>>=8,B.Ra+=B.oa[B.pa+B.bb]<<Ta-8>>>0,++B.bb,B.u-=8;Ne(B)&&(B.h=1,B.u=0)}function He(B,H){if(t(0<=H),!B.h&&H<=ha){var ie=Ie(B)&_l[H];return B.u+=H,ze(B),ie}return B.h=1,B.u=0}function pt(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function ge(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function Ie(B){return B.Ra>>>(B.u&Ta-1)>>>0}function Ne(B){return t(B.bb<=B.Sb),B.h||B.bb==B.Sb&&B.u>Ta}function Ve(B,H){B.u=H,B.h=Ne(B)}function it(B){B.u>=gu&&(t(B.u>=gu),ze(B))}function lt(B){t(B!=null&&B.oa!=null),B.pa<B.Zc?(B.I=(B.oa[B.pa++]|B.I<<8)>>>0,B.b+=8):(t(B!=null&&B.oa!=null),B.pa<B.Yc?(B.b+=8,B.I=B.oa[B.pa++]|B.I<<8):B.Ka?B.b=0:(B.I<<=8,B.b+=8,B.Ka=1))}function Mt(B){return ne(B,1)}function wt(B,H){var ie=B.Ca;0>B.b&&lt(B);var Ee=B.b,Ye=ie*H>>>8,rt=(B.I>>>Ee>Ye)+0;for(rt?(ie-=Ye,B.I-=Ye+1<<Ee>>>0):ie=Ye+1,Ee=ie,Ye=0;256<=Ee;)Ye+=8,Ee>>=8;return Ee=7^Ye+Xs[Ee],B.b-=Ee,B.Ca=(ie<<Ee)-1,rt}function rn(B,H,ie){B[H+0]=ie>>24&255,B[H+1]=ie>>16&255,B[H+2]=ie>>8&255,B[H+3]=ie>>0&255}function yn(B,H){return B[H+0]<<0|B[H+1]<<8}function Pn(B,H){return yn(B,H)|B[H+2]<<16}function De(B,H){return yn(B,H)|yn(B,H+2)<<16}function Ae(B,H){var ie=1<<H;return t(B!=null),t(0<H),B.X=l(ie),B.X==null?0:(B.Mb=32-H,B.Xa=H,1)}function Be(B,H){t(B!=null),t(H!=null),t(B.Xa==H.Xa),r(H.X,0,B.X,0,1<<H.Xa)}function Ce(){this.X=[],this.Xa=this.Mb=0}function ot(B,H,ie,Ee){t(ie!=null),t(Ee!=null);var Ye=ie[0],rt=Ee[0];return Ye==0&&(Ye=(B*rt+H/2)/H),rt==0&&(rt=(H*Ye+B/2)/B),0>=Ye||0>=rt?0:(ie[0]=Ye,Ee[0]=rt,1)}function Dt(B,H){return B+(1<<H)-1>>>H}function Zt(B,H){return((4278255360&B)+(4278255360&H)>>>0&4278255360)+((16711935&B)+(16711935&H)>>>0&16711935)>>>0}function an(B,H){ue[H]=function(ie,Ee,Ye,rt,ut,ht,gt){var kt;for(kt=0;kt<ut;++kt){var _n=ue[B](ht[gt+kt-1],Ye,rt+kt);ht[gt+kt]=Zt(ie[Ee+kt],_n)}}}function ln(){this.ud=this.hd=this.jd=0}function vn(B,H){return((4278124286&(B^H))>>>1)+(B&H)>>>0}function qn(B){return 0<=B&&256>B?B:0>B?0:255<B?255:void 0}function Kn(B,H){return qn(B+(B-H+.5>>1))}function cr(B,H,ie){return Math.abs(H-ie)-Math.abs(B-ie)}function pr(B,H,ie,Ee,Ye,rt,ut){for(Ee=rt[ut-1],ie=0;ie<Ye;++ie)rt[ut+ie]=Ee=Zt(B[H+ie],Ee)}function Dr(B,H,ie,Ee,Ye){var rt;for(rt=0;rt<ie;++rt){var ut=B[H+rt],ht=ut>>8&255,gt=16711935&(gt=(gt=16711935&ut)+((ht<<16)+ht));Ee[Ye+rt]=(4278255360&ut)+gt>>>0}}function zr(B,H){H.jd=B>>0&255,H.hd=B>>8&255,H.ud=B>>16&255}function Ht(B,H,ie,Ee,Ye,rt){var ut;for(ut=0;ut<Ee;++ut){var ht=H[ie+ut],gt=ht>>>8,kt=ht,_n=255&(_n=(_n=ht>>>16)+((B.jd<<24>>24)*(gt<<24>>24)>>>5));kt=255&(kt=(kt=kt+((B.hd<<24>>24)*(gt<<24>>24)>>>5))+((B.ud<<24>>24)*(_n<<24>>24)>>>5)),Ye[rt+ut]=(4278255360&ht)+(_n<<16)+kt}}function tn(B,H,ie,Ee,Ye){ue[H]=function(rt,ut,ht,gt,kt,_n,Vn,Un,kn){for(gt=Vn;gt<Un;++gt)for(Vn=0;Vn<kn;++Vn)kt[_n++]=Ye(ht[Ee(rt[ut++])])},ue[B]=function(rt,ut,ht,gt,kt,_n,Vn){var Un=8>>rt.b,kn=rt.Ea,ur=rt.K[0],Zn=rt.w;if(8>Un)for(rt=(1<<rt.b)-1,Zn=(1<<Un)-1;ut<ht;++ut){var Qt,Sn=0;for(Qt=0;Qt<kn;++Qt)Qt&rt||(Sn=Ee(gt[kt++])),_n[Vn++]=Ye(ur[Sn&Zn]),Sn>>=Un}else ue["VP8LMapColor"+ie](gt,kt,ur,Zn,_n,Vn,ut,ht,kn)}}function Kt(B,H,ie,Ee,Ye){for(ie=H+ie;H<ie;){var rt=B[H++];Ee[Ye++]=rt>>16&255,Ee[Ye++]=rt>>8&255,Ee[Ye++]=rt>>0&255}}function Yn(B,H,ie,Ee,Ye){for(ie=H+ie;H<ie;){var rt=B[H++];Ee[Ye++]=rt>>16&255,Ee[Ye++]=rt>>8&255,Ee[Ye++]=rt>>0&255,Ee[Ye++]=rt>>24&255}}function ir(B,H,ie,Ee,Ye){for(ie=H+ie;H<ie;){var rt=(ut=B[H++])>>16&240|ut>>12&15,ut=ut>>0&240|ut>>28&15;Ee[Ye++]=rt,Ee[Ye++]=ut}}function Fr(B,H,ie,Ee,Ye){for(ie=H+ie;H<ie;){var rt=(ut=B[H++])>>16&248|ut>>13&7,ut=ut>>5&224|ut>>3&31;Ee[Ye++]=rt,Ee[Ye++]=ut}}function Ft(B,H,ie,Ee,Ye){for(ie=H+ie;H<ie;){var rt=B[H++];Ee[Ye++]=rt>>0&255,Ee[Ye++]=rt>>8&255,Ee[Ye++]=rt>>16&255}}function je(B,H,ie,Ee,Ye,rt){if(rt==0)for(ie=H+ie;H<ie;)rn(Ee,((rt=B[H++])[0]>>24|rt[1]>>8&65280|rt[2]<<8&16711680|rt[3]<<24)>>>0),Ye+=32;else r(Ee,Ye,B,H,ie)}function Ze(B,H){ue[H][0]=ue[B+"0"],ue[H][1]=ue[B+"1"],ue[H][2]=ue[B+"2"],ue[H][3]=ue[B+"3"],ue[H][4]=ue[B+"4"],ue[H][5]=ue[B+"5"],ue[H][6]=ue[B+"6"],ue[H][7]=ue[B+"7"],ue[H][8]=ue[B+"8"],ue[H][9]=ue[B+"9"],ue[H][10]=ue[B+"10"],ue[H][11]=ue[B+"11"],ue[H][12]=ue[B+"12"],ue[H][13]=ue[B+"13"],ue[H][14]=ue[B+"0"],ue[H][15]=ue[B+"0"]}function et(B){return B==Ho||B==Ao||B==Gl||B==p}function ct(){this.eb=[],this.size=this.A=this.fb=0}function $e(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Gt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ct,this.f.kb=new $e,this.sd=null}function hn(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ot(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function cn(B){return alert("todo:WebPSamplerProcessPlane"),B.T}function En(B,H){var ie=B.T,Ee=H.ba.f.RGBA,Ye=Ee.eb,rt=Ee.fb+B.ka*Ee.A,ut=ia[H.ba.S],ht=B.y,gt=B.O,kt=B.f,_n=B.N,Vn=B.ea,Un=B.W,kn=H.cc,ur=H.dc,Zn=H.Mc,Qt=H.Nc,Sn=B.ka,fr=B.ka+B.T,Cr=B.U,gr=Cr+1>>1;for(Sn==0?ut(ht,gt,null,null,kt,_n,Vn,Un,kt,_n,Vn,Un,Ye,rt,null,null,Cr):(ut(H.ec,H.fc,ht,gt,kn,ur,Zn,Qt,kt,_n,Vn,Un,Ye,rt-Ee.A,Ye,rt,Cr),++ie);Sn+2<fr;Sn+=2)kn=kt,ur=_n,Zn=Vn,Qt=Un,_n+=B.Rc,Un+=B.Rc,rt+=2*Ee.A,ut(ht,(gt+=2*B.fa)-B.fa,ht,gt,kn,ur,Zn,Qt,kt,_n,Vn,Un,Ye,rt-Ee.A,Ye,rt,Cr);return gt+=B.fa,B.j+fr<B.o?(r(H.ec,H.fc,ht,gt,Cr),r(H.cc,H.dc,kt,_n,gr),r(H.Mc,H.Nc,Vn,Un,gr),ie--):1&fr||ut(ht,gt,null,null,kt,_n,Vn,Un,kt,_n,Vn,Un,Ye,rt+Ee.A,null,null,Cr),ie}function wn(B,H,ie){var Ee=B.F,Ye=[B.J];if(Ee!=null){var rt=B.U,ut=H.ba.S,ht=ut==Ha||ut==Gl;H=H.ba.f.RGBA;var gt=[0],kt=B.ka;gt[0]=B.T,B.Kb&&(kt==0?--gt[0]:(--kt,Ye[0]-=B.width),B.j+B.ka+B.T==B.o&&(gt[0]=B.o-B.j-kt));var _n=H.eb;kt=H.fb+kt*H.A,B=oi(Ee,Ye[0],B.width,rt,gt,_n,kt+(ht?0:3),H.A),t(ie==gt),B&&et(ut)&&Uo(_n,kt,ht,rt,gt,H.A)}return 0}function Qn(B){var H=B.ma,ie=H.ba.S,Ee=11>ie,Ye=ie==vi||ie==yu||ie==Ha||ie==Go||ie==12||et(ie);if(H.memory=null,H.Ib=null,H.Jb=null,H.Nd=null,!zc(H.Oa,B,Ye?11:12))return 0;if(Ye&&et(ie)&&wr(),B.da)alert("todo:use_scaling");else{if(Ee){if(H.Ib=cn,B.Kb){if(ie=B.U+1>>1,H.memory=l(B.U+2*ie),H.memory==null)return 0;H.ec=H.memory,H.fc=0,H.cc=H.ec,H.dc=H.fc+B.U,H.Mc=H.cc,H.Nc=H.dc+ie,H.Ib=En,wr()}}else alert("todo:EmitYUV");Ye&&(H.Jb=wn,Ee&&An())}if(Ee&&!uh){for(B=0;256>B;++B)Ah[B]=89858*(B-128)+Wo>>Ia,Jh[B]=-22014*(B-128)+Wo,jd[B]=-45773*(B-128),Pc[B]=113618*(B-128)+Wo>>Ia;for(B=Th;B<Fu;++B)H=76283*(B-16)+Wo>>Ia,zu[B-Th]=Ri(H,255),pc[B-Th]=Ri(H+8>>4,15);uh=1}return 1}function Lr(B){var H=B.ma,ie=B.U,Ee=B.T;return t(!(1&B.ka)),0>=ie||0>=Ee?0:(ie=H.Ib(B,H),H.Jb!=null&&H.Jb(B,H,ie),H.Dc+=ie,1)}function Yt(B){B.ma.memory=null}function vt(B,H,ie,Ee){return He(B,8)!=47?0:(H[0]=He(B,14)+1,ie[0]=He(B,14)+1,Ee[0]=He(B,1),He(B,3)!=0?0:!B.h)}function Tn(B,H){if(4>B)return B+1;var ie=B-2>>1;return(2+(1&B)<<ie)+He(H,ie)+1}function bn(B,H){return 120<H?H-120:1<=(ie=((ie=Jt[H-1])>>4)*B+(8-(15&ie)))?ie:1;var ie}function br(B,H,ie){var Ee=Ie(ie),Ye=B[H+=255&Ee].g-8;return 0<Ye&&(Ve(ie,ie.u+8),Ee=Ie(ie),H+=B[H].value,H+=Ee&(1<<Ye)-1),Ve(ie,ie.u+B[H].g),B[H].value}function vr(B,H,ie){return ie.g+=B.g,ie.value+=B.value<<H>>>0,t(8>=ie.g),B.g}function Cn(B,H,ie){var Ee=B.xc;return t((H=Ee==0?0:B.vc[B.md*(ie>>Ee)+(H>>Ee)])<B.Wb),B.Ya[H]}function pn(B,H,ie,Ee){var Ye=B.ab,rt=B.c*H,ut=B.C;H=ut+H;var ht=ie,gt=Ee;for(Ee=B.Ta,ie=B.Ua;0<Ye--;){var kt=B.gc[Ye],_n=ut,Vn=H,Un=ht,kn=gt,ur=(gt=Ee,ht=ie,kt.Ea);switch(t(_n<Vn),t(Vn<=kt.nc),kt.hc){case 2:jc(Un,kn,(Vn-_n)*ur,gt,ht);break;case 0:var Zn=_n,Qt=Vn,Sn=gt,fr=ht,Cr=(y=kt).Ea;Zn==0&&(zo(Un,kn,null,null,1,Sn,fr),pr(Un,kn+1,0,0,Cr-1,Sn,fr+1),kn+=Cr,fr+=Cr,++Zn);for(var gr=1<<y.b,qr=gr-1,Ur=Dt(Cr,y.b),ei=y.K,y=y.w+(Zn>>y.b)*Ur;Zn<Qt;){var S=ei,I=y,F=1;for(ea(Un,kn,Sn,fr-Cr,1,Sn,fr);F<Cr;){var G=(F&~qr)+gr;G>Cr&&(G=Cr),(0,Bu[S[I++]>>8&15])(Un,kn+ +F,Sn,fr+F-Cr,G-F,Sn,fr+F),F=G}kn+=Cr,fr+=Cr,++Zn&qr||(y+=Ur)}Vn!=kt.nc&&r(gt,ht-ur,gt,ht+(Vn-_n-1)*ur,ur);break;case 1:for(ur=Un,Qt=kn,Cr=(Un=kt.Ea)-(fr=Un&~(Sn=(kn=1<<kt.b)-1)),Zn=Dt(Un,kt.b),gr=kt.K,kt=kt.w+(_n>>kt.b)*Zn;_n<Vn;){for(qr=gr,Ur=kt,ei=new ln,y=Qt+fr,S=Qt+Un;Qt<y;)zr(qr[Ur++],ei),Nu(ei,ur,Qt,kn,gt,ht),Qt+=kn,ht+=kn;Qt<S&&(zr(qr[Ur++],ei),Nu(ei,ur,Qt,Cr,gt,ht),Qt+=Cr,ht+=Cr),++_n&Sn||(kt+=Zn)}break;case 3:if(Un==gt&&kn==ht&&0<kt.b){for(Qt=gt,Un=ur=ht+(Vn-_n)*ur-(fr=(Vn-_n)*Dt(kt.Ea,kt.b)),kn=gt,Sn=ht,Zn=[],fr=(Cr=fr)-1;0<=fr;--fr)Zn[fr]=kn[Sn+fr];for(fr=Cr-1;0<=fr;--fr)Qt[Un+fr]=Zn[fr];Mo(kt,_n,Vn,gt,ur,gt,ht)}else Mo(kt,_n,Vn,Un,kn,gt,ht)}ht=Ee,gt=ie}gt!=ie&&r(Ee,ie,ht,gt,rt)}function Ut(B,H){var ie=B.V,Ee=B.Ba+B.c*B.C,Ye=H-B.C;if(t(H<=B.l.o),t(16>=Ye),0<Ye){var rt=B.l,ut=B.Ta,ht=B.Ua,gt=rt.width;if(pn(B,Ye,ie,Ee),Ye=ht=[ht],t((ie=B.C)<(Ee=H)),t(rt.v<rt.va),Ee>rt.o&&(Ee=rt.o),ie<rt.j){var kt=rt.j-ie;ie=rt.j,Ye[0]+=kt*gt}if(ie>=Ee?ie=0:(Ye[0]+=4*rt.v,rt.ka=ie-rt.j,rt.U=rt.va-rt.v,rt.T=Ee-ie,ie=1),ie){if(ht=ht[0],11>(ie=B.ca).S){var _n=ie.f.RGBA,Vn=(Ee=ie.S,Ye=rt.U,rt=rt.T,kt=_n.eb,_n.A),Un=rt;for(_n=_n.fb+B.Ma*_n.A;0<Un--;){var kn=ut,ur=ht,Zn=Ye,Qt=kt,Sn=_n;switch(Ee){case $o:da(kn,ur,Zn,Qt,Sn);break;case vi:ta(kn,ur,Zn,Qt,Sn);break;case Ho:ta(kn,ur,Zn,Qt,Sn),Uo(Qt,Sn,0,Zn,1,0);break;case $l:na(kn,ur,Zn,Qt,Sn);break;case yu:je(kn,ur,Zn,Qt,Sn,1);break;case Ao:je(kn,ur,Zn,Qt,Sn,1),Uo(Qt,Sn,0,Zn,1,0);break;case Ha:je(kn,ur,Zn,Qt,Sn,0);break;case Gl:je(kn,ur,Zn,Qt,Sn,0),Uo(Qt,Sn,1,Zn,1,0);break;case Go:Ul(kn,ur,Zn,Qt,Sn);break;case p:Ul(kn,ur,Zn,Qt,Sn),bs(Qt,Sn,Zn,1,0);break;case Uc:ol(kn,ur,Zn,Qt,Sn);break;default:t(0)}ht+=gt,_n+=Vn}B.Ma+=rt}else alert("todo:EmitRescaledRowsYUVA");t(B.Ma<=ie.height)}}B.C=H,t(B.C<=B.i)}function Hn(B){var H;if(0<B.ua)return 0;for(H=0;H<B.Wb;++H){var ie=B.Ya[H].G,Ee=B.Ya[H].H;if(0<ie[1][Ee[1]+0].g||0<ie[2][Ee[2]+0].g||0<ie[3][Ee[3]+0].g)return 0}return 1}function or(B,H,ie,Ee,Ye,rt){if(B.Z!=0){var ut=B.qd,ht=B.rd;for(t(xs[B.Z]!=null);H<ie;++H)xs[B.Z](ut,ht,Ee,Ye,Ee,Ye,rt),ut=Ee,ht=Ye,Ye+=rt;B.qd=ut,B.rd=ht}}function Xr(B,H){var ie=B.l.ma,Ee=ie.Z==0||ie.Z==1?B.l.j:B.C;if(Ee=B.C<Ee?Ee:B.C,t(H<=B.l.o),H>Ee){var Ye=B.l.width,rt=ie.ca,ut=ie.tb+Ye*Ee,ht=B.V,gt=B.Ba+B.c*Ee,kt=B.gc;t(B.ab==1),t(kt[0].hc==3),mi(kt[0],Ee,H,ht,gt,rt,ut),or(ie,Ee,H,rt,ut,Ye)}B.C=B.Ma=H}function ri(B,H,ie,Ee,Ye,rt,ut){var ht=B.$/Ee,gt=B.$%Ee,kt=B.m,_n=B.s,Vn=ie+B.$,Un=Vn;Ye=ie+Ee*Ye;var kn=ie+Ee*rt,ur=280+_n.ua,Zn=B.Pb?ht:16777216,Qt=0<_n.ua?_n.Wa:null,Sn=_n.wc,fr=Vn<kn?Cn(_n,gt,ht):null;t(B.C<rt),t(kn<=Ye);var Cr=!1;e:for(;;){for(;Cr||Vn<kn;){var gr=0;if(ht>=Zn){var qr=Vn-ie;t((Zn=B).Pb),Zn.wd=Zn.m,Zn.xd=qr,0<Zn.s.ua&&Be(Zn.s.Wa,Zn.s.vb),Zn=ht+Jn}if(gt&Sn||(fr=Cn(_n,gt,ht)),t(fr!=null),fr.Qb&&(H[Vn]=fr.qb,Cr=!0),!Cr)if(it(kt),fr.jc){gr=kt,qr=H;var Ur=Vn,ei=fr.pd[Ie(gr)&_o-1];t(fr.jc),256>ei.g?(Ve(gr,gr.u+ei.g),qr[Ur]=ei.value,gr=0):(Ve(gr,gr.u+ei.g-256),t(256<=ei.value),gr=ei.value),gr==0&&(Cr=!0)}else gr=br(fr.G[0],fr.H[0],kt);if(kt.h)break;if(Cr||256>gr){if(!Cr)if(fr.nd)H[Vn]=(fr.qb|gr<<8)>>>0;else{if(it(kt),Cr=br(fr.G[1],fr.H[1],kt),it(kt),qr=br(fr.G[2],fr.H[2],kt),Ur=br(fr.G[3],fr.H[3],kt),kt.h)break;H[Vn]=(Ur<<24|Cr<<16|gr<<8|qr)>>>0}if(Cr=!1,++Vn,++gt>=Ee&&(gt=0,++ht,ut!=null&&ht<=rt&&!(ht%16)&&ut(B,ht),Qt!=null))for(;Un<Vn;)gr=H[Un++],Qt.X[(506832829*gr&4294967295)>>>Qt.Mb]=gr}else if(280>gr){if(gr=Tn(gr-256,kt),qr=br(fr.G[4],fr.H[4],kt),it(kt),qr=bn(Ee,qr=Tn(qr,kt)),kt.h)break;if(Vn-ie<qr||Ye-Vn<gr)break e;for(Ur=0;Ur<gr;++Ur)H[Vn+Ur]=H[Vn+Ur-qr];for(Vn+=gr,gt+=gr;gt>=Ee;)gt-=Ee,++ht,ut!=null&&ht<=rt&&!(ht%16)&&ut(B,ht);if(t(Vn<=Ye),gt&Sn&&(fr=Cn(_n,gt,ht)),Qt!=null)for(;Un<Vn;)gr=H[Un++],Qt.X[(506832829*gr&4294967295)>>>Qt.Mb]=gr}else{if(!(gr<ur))break e;for(Cr=gr-280,t(Qt!=null);Un<Vn;)gr=H[Un++],Qt.X[(506832829*gr&4294967295)>>>Qt.Mb]=gr;gr=Vn,t(!(Cr>>>(qr=Qt).Xa)),H[gr]=qr.X[Cr],Cr=!0}Cr||t(kt.h==Ne(kt))}if(B.Pb&&kt.h&&Vn<Ye)t(B.m.h),B.a=5,B.m=B.wd,B.$=B.xd,0<B.s.ua&&Be(B.s.vb,B.s.Wa);else{if(kt.h)break e;ut!=null&&ut(B,ht>rt?rt:ht),B.a=0,B.$=Vn-ie}return 1}return B.a=3,0}function ai(B){t(B!=null),B.vc=null,B.yc=null,B.Ya=null;var H=B.Wa;H!=null&&(H.X=null),B.vb=null,t(B!=null)}function Pr(){var B=new Jo;return B==null?null:(B.a=0,B.xb=Aa,Ze("Predictor","VP8LPredictors"),Ze("Predictor","VP8LPredictors_C"),Ze("PredictorAdd","VP8LPredictorsAdd"),Ze("PredictorAdd","VP8LPredictorsAdd_C"),jc=Dr,Nu=Ht,da=Kt,ta=Yn,Ul=ir,ol=Fr,na=Ft,ue.VP8LMapColor32b=jl,ue.VP8LMapColor8b=jo,B)}function As(B,H,ie,Ee,Ye){var rt=1,ut=[B],ht=[H],gt=Ee.m,kt=Ee.s,_n=null,Vn=0;e:for(;;){if(ie)for(;rt&&He(gt,1);){var Un=ut,kn=ht,ur=Ee,Zn=1,Qt=ur.m,Sn=ur.gc[ur.ab],fr=He(Qt,2);if(ur.Oc&1<<fr)rt=0;else{switch(ur.Oc|=1<<fr,Sn.hc=fr,Sn.Ea=Un[0],Sn.nc=kn[0],Sn.K=[null],++ur.ab,t(4>=ur.ab),fr){case 0:case 1:Sn.b=He(Qt,3)+2,Zn=As(Dt(Sn.Ea,Sn.b),Dt(Sn.nc,Sn.b),0,ur,Sn.K),Sn.K=Sn.K[0];break;case 3:var Cr,gr=He(Qt,8)+1,qr=16<gr?0:4<gr?1:2<gr?2:3;if(Un[0]=Dt(Sn.Ea,qr),Sn.b=qr,Cr=Zn=As(gr,1,0,ur,Sn.K)){var Ur,ei=gr,y=Sn,S=1<<(8>>y.b),I=l(S);if(I==null)Cr=0;else{var F=y.K[0],G=y.w;for(I[0]=y.K[0][0],Ur=1;Ur<1*ei;++Ur)I[Ur]=Zt(F[G+Ur],I[Ur-1]);for(;Ur<4*S;++Ur)I[Ur]=0;y.K[0]=null,y.K[0]=I,Cr=1}}Zn=Cr;break;case 2:break;default:t(0)}rt=Zn}}if(ut=ut[0],ht=ht[0],rt&&He(gt,1)&&!(rt=1<=(Vn=He(gt,4))&&11>=Vn)){Ee.a=3;break e}var te;if(te=rt)t:{var pe,xe,Fe,tt=Ee,zt=ut,bt=ht,dn=Vn,zn=ie,hr=tt.m,Ir=tt.s,Br=[null],ci=1,Nt=0,qt=Dn[dn];n:for(;;){if(zn&&He(hr,1)){var gn=He(hr,3)+2,Gn=Dt(zt,gn),Mn=Dt(bt,gn),Bn=Gn*Mn;if(!As(Gn,Mn,0,tt,Br))break n;for(Br=Br[0],Ir.xc=gn,pe=0;pe<Bn;++pe){var Ge=Br[pe]>>8&65535;Br[pe]=Ge,Ge>=ci&&(ci=Ge+1)}}if(hr.h)break n;for(xe=0;5>xe;++xe){var at=se[xe];!xe&&0<dn&&(at+=1<<dn),Nt<at&&(Nt=at)}var mt=a(ci*qt,de),_t=ci,St=a(_t,be);if(St==null)var Lt=null;else t(65536>=_t),Lt=St;var sn=l(Nt);if(Lt==null||sn==null||mt==null){tt.a=1;break n}var E=mt;for(pe=Fe=0;pe<ci;++pe){var s=Lt[pe],c=s.G,g=s.H,x=0,A=1,N=0;for(xe=0;5>xe;++xe){at=se[xe],c[xe]=E,g[xe]=Fe,!xe&&0<dn&&(at+=1<<dn);i:{var $,Z=at,re=tt,fe=sn,Me=E,ke=Fe,Ke=0,Qe=re.m,Tt=He(Qe,1);if(i(fe,0,0,Z),Tt){var Ct=He(Qe,1)+1,At=He(Qe,1),Rt=He(Qe,At==0?1:8);fe[Rt]=1,Ct==2&&(fe[Rt=He(Qe,8)]=1);var jt=1}else{var Vt=l(19),en=He(Qe,4)+4;if(19<en){re.a=3;var mn=0;break i}for($=0;$<en;++$)Vt[nt[$]]=He(Qe,3);var on=void 0,On=void 0,jn=re,In=Vt,sr=Z,tr=fe,Or=0,Sr=jn.m,mr=8,ti=a(128,de);r:for(;he(ti,0,7,In,19);){if(He(Sr,1)){var wi=2+2*He(Sr,3);if((on=2+He(Sr,wi))>sr)break r}else on=sr;for(On=0;On<sr&&on--;){it(Sr);var Ei=ti[0+(127&Ie(Sr))];Ve(Sr,Sr.u+Ei.g);var Os=Ei.value;if(16>Os)tr[On++]=Os,Os!=0&&(mr=Os);else{var Rs=Os==16,fo=Os-16,po=U[fo],Ji=He(Sr,T[fo])+po;if(On+Ji>sr)break r;for(var hs=Rs?mr:0;0<Ji--;)tr[On++]=hs}}Or=1;break r}Or||(jn.a=3),jt=Or}(jt=jt&&!Qe.h)&&(Ke=he(Me,ke,8,fe,Z)),jt&&Ke!=0?mn=Ke:(re.a=3,mn=0)}if(mn==0)break n;if(A&&Pe[xe]==1&&(A=E[Fe].g==0),x+=E[Fe].g,Fe+=mn,3>=xe){var ko,sa=sn[0];for(ko=1;ko<at;++ko)sn[ko]>sa&&(sa=sn[ko]);N+=sa}}if(s.nd=A,s.Qb=0,A&&(s.qb=(c[3][g[3]+0].value<<24|c[1][g[1]+0].value<<16|c[2][g[2]+0].value)>>>0,x==0&&256>c[0][g[0]+0].value&&(s.Qb=1,s.qb+=c[0][g[0]+0].value<<8)),s.jc=!s.Qb&&6>N,s.jc){var Zo,bo=s;for(Zo=0;Zo<_o;++Zo){var Wa=Zo,Hl=bo.pd[Wa],ju=bo.G[0][bo.H[0]+Wa];256<=ju.value?(Hl.g=ju.g+256,Hl.value=ju.value):(Hl.g=0,Hl.value=0,Wa>>=vr(ju,8,Hl),Wa>>=vr(bo.G[1][bo.H[1]+Wa],16,Hl),Wa>>=vr(bo.G[2][bo.H[2]+Wa],0,Hl),vr(bo.G[3][bo.H[3]+Wa],24,Hl))}}}Ir.vc=Br,Ir.Wb=ci,Ir.Ya=Lt,Ir.yc=mt,te=1;break t}te=0}if(!(rt=te)){Ee.a=3;break e}if(0<Vn){if(kt.ua=1<<Vn,!Ae(kt.Wa,Vn)){Ee.a=1,rt=0;break e}}else kt.ua=0;var tc=Ee,ul=ut,Qh=ht,ql=tc.s,Wl=ql.xc;if(tc.c=ul,tc.i=Qh,ql.md=Dt(ul,Wl),ql.wc=Wl==0?-1:(1<<Wl)-1,ie){Ee.xb=Xh;break e}if((_n=l(ut*ht))==null){Ee.a=1,rt=0;break e}rt=(rt=ri(Ee,_n,0,ut,ht,ht,null))&&!gt.h;break e}return rt?(Ye!=null?Ye[0]=_n:(t(_n==null),t(ie)),Ee.$=0,ie||ai(kt)):ai(kt),rt}function $i(B,H){var ie=B.c*B.i,Ee=ie+H+16*H;return t(B.c<=H),B.V=l(Ee),B.V==null?(B.Ta=null,B.Ua=0,B.a=1,0):(B.Ta=B.V,B.Ua=B.Ba+ie+H,1)}function Qa(B,H){var ie=B.C,Ee=H-ie,Ye=B.V,rt=B.Ba+B.c*ie;for(t(H<=B.l.o);0<Ee;){var ut=16<Ee?16:Ee,ht=B.l.ma,gt=B.l.width,kt=gt*ut,_n=ht.ca,Vn=ht.tb+gt*ie,Un=B.Ta,kn=B.Ua;pn(B,ut,Ye,rt),io(Un,kn,_n,Vn,kt),or(ht,ie,ie+ut,_n,Vn,gt),Ee-=ut,Ye+=ut*B.c,ie+=ut}t(ie==H),B.C=B.Ma=H}function pi(){this.ub=this.yd=this.td=this.Rb=0}function Li(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Yi(){this.Fb=this.Bb=this.Cb=0,this.Zb=l(4),this.Lb=l(4)}function ns(){this.Yb=function(){var B=[];return function H(ie,Ee,Ye){for(var rt=Ye[Ee],ut=0;ut<rt&&(ie.push(Ye.length>Ee+1?[]:0),!(Ye.length<Ee+1));ut++)H(ie[ut],Ee+1,Ye)}(B,0,[3,11]),B}()}function ao(){this.jb=l(3),this.Wc=o([4,8],ns),this.Xc=o([4,17],ns)}function wc(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new l(4),this.od=new l(4)}function Wu(){this.ld=this.La=this.dd=this.tc=0}function el(){this.Na=this.la=0}function Au(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Zu(){this.ad=l(384),this.Za=0,this.Ob=l(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ku(){this.uc=this.M=this.Nb=0,this.wa=Array(new Wu),this.Y=0,this.ya=Array(new Zu),this.aa=0,this.l=new ja}function Cc(){this.y=l(16),this.f=l(8),this.ea=l(8)}function Yu(){this.cb=this.a=0,this.sc="",this.m=new pt,this.Od=new pi,this.Kc=new Li,this.ed=new wc,this.Qa=new Yi,this.Ic=this.$c=this.Aa=0,this.D=new Ku,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,pt),this.ia=0,this.pb=a(4,Au),this.Pa=new ao,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Cc),this.Hd=0,this.rb=Array(new el),this.sb=0,this.wa=Array(new Wu),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Zu),this.L=this.aa=0,this.gd=o([4,2],Wu),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ja(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function ds(){var B=new Yu;return B!=null&&(B.a=0,B.sc="OK",B.cb=0,B.Xb=0,Jr||(Jr=gl)),B}function Di(B,H,ie){return B.a==0&&(B.a=H,B.sc=ie,B.cb=0),0}function Xu(B,H,ie){return 3<=ie&&B[H+0]==157&&B[H+1]==1&&B[H+2]==42}function lu(B,H){if(B==null)return 0;if(B.a=0,B.sc="OK",H==null)return Di(B,2,"null VP8Io passed to VP8GetHeaders()");var ie=H.data,Ee=H.w,Ye=H.ha;if(4>Ye)return Di(B,7,"Truncated header.");var rt=ie[Ee+0]|ie[Ee+1]<<8|ie[Ee+2]<<16,ut=B.Od;if(ut.Rb=!(1&rt),ut.td=rt>>1&7,ut.yd=rt>>4&1,ut.ub=rt>>5,3<ut.td)return Di(B,3,"Incorrect keyframe parameters.");if(!ut.yd)return Di(B,4,"Frame not displayable.");Ee+=3,Ye-=3;var ht=B.Kc;if(ut.Rb){if(7>Ye)return Di(B,7,"cannot parse picture header");if(!Xu(ie,Ee,Ye))return Di(B,3,"Bad code word");ht.c=16383&(ie[Ee+4]<<8|ie[Ee+3]),ht.Td=ie[Ee+4]>>6,ht.i=16383&(ie[Ee+6]<<8|ie[Ee+5]),ht.Ud=ie[Ee+6]>>6,Ee+=7,Ye-=7,B.za=ht.c+15>>4,B.Ub=ht.i+15>>4,H.width=ht.c,H.height=ht.i,H.Da=0,H.j=0,H.v=0,H.va=H.width,H.o=H.height,H.da=0,H.ib=H.width,H.hb=H.height,H.U=H.width,H.T=H.height,i((rt=B.Pa).jb,0,255,rt.jb.length),t((rt=B.Qa)!=null),rt.Cb=0,rt.Bb=0,rt.Fb=1,i(rt.Zb,0,0,rt.Zb.length),i(rt.Lb,0,0,rt.Lb)}if(ut.ub>Ye)return Di(B,7,"bad partition length");ae(rt=B.m,ie,Ee,ut.ub),Ee+=ut.ub,Ye-=ut.ub,ut.Rb&&(ht.Ld=Mt(rt),ht.Kd=Mt(rt)),ht=B.Qa;var gt,kt=B.Pa;if(t(rt!=null),t(ht!=null),ht.Cb=Mt(rt),ht.Cb){if(ht.Bb=Mt(rt),Mt(rt)){for(ht.Fb=Mt(rt),gt=0;4>gt;++gt)ht.Zb[gt]=Mt(rt)?Se(rt,7):0;for(gt=0;4>gt;++gt)ht.Lb[gt]=Mt(rt)?Se(rt,6):0}if(ht.Bb)for(gt=0;3>gt;++gt)kt.jb[gt]=Mt(rt)?ne(rt,8):255}else ht.Bb=0;if(rt.Ka)return Di(B,3,"cannot parse segment header");if((ht=B.ed).zd=Mt(rt),ht.Tb=ne(rt,6),ht.wb=ne(rt,3),ht.Pc=Mt(rt),ht.Pc&&Mt(rt)){for(kt=0;4>kt;++kt)Mt(rt)&&(ht.vd[kt]=Se(rt,6));for(kt=0;4>kt;++kt)Mt(rt)&&(ht.od[kt]=Se(rt,6))}if(B.L=ht.Tb==0?0:ht.zd?1:2,rt.Ka)return Di(B,3,"cannot parse filter header");var _n=Ye;if(Ye=gt=Ee,Ee=gt+_n,ht=_n,B.Xb=(1<<ne(B.m,2))-1,_n<3*(kt=B.Xb))ie=7;else{for(gt+=3*kt,ht-=3*kt,_n=0;_n<kt;++_n){var Vn=ie[Ye+0]|ie[Ye+1]<<8|ie[Ye+2]<<16;Vn>ht&&(Vn=ht),ae(B.Jc[+_n],ie,gt,Vn),gt+=Vn,ht-=Vn,Ye+=3}ae(B.Jc[+kt],ie,gt,ht),ie=gt<Ee?0:5}if(ie!=0)return Di(B,ie,"cannot parse partitions");for(ie=ne(gt=B.m,7),Ye=Mt(gt)?Se(gt,4):0,Ee=Mt(gt)?Se(gt,4):0,ht=Mt(gt)?Se(gt,4):0,kt=Mt(gt)?Se(gt,4):0,gt=Mt(gt)?Se(gt,4):0,_n=B.Qa,Vn=0;4>Vn;++Vn){if(_n.Cb){var Un=_n.Zb[Vn];_n.Fb||(Un+=ie)}else{if(0<Vn){B.pb[Vn]=B.pb[0];continue}Un=ie}var kn=B.pb[Vn];kn.Sc[0]=ar[Ri(Un+Ye,127)],kn.Sc[1]=Vr[Ri(Un+0,127)],kn.Eb[0]=2*ar[Ri(Un+Ee,127)],kn.Eb[1]=101581*Vr[Ri(Un+ht,127)]>>16,8>kn.Eb[1]&&(kn.Eb[1]=8),kn.Qc[0]=ar[Ri(Un+kt,117)],kn.Qc[1]=Vr[Ri(Un+gt,127)],kn.lc=Un+gt}if(!ut.Rb)return Di(B,4,"Not a key frame.");for(Mt(rt),ut=B.Pa,ie=0;4>ie;++ie){for(Ye=0;8>Ye;++Ye)for(Ee=0;3>Ee;++Ee)for(ht=0;11>ht;++ht)kt=wt(rt,ma[ie][Ye][Ee][ht])?ne(rt,8):so[ie][Ye][Ee][ht],ut.Wc[ie][Ye].Yb[Ee][ht]=kt;for(Ye=0;17>Ye;++Ye)ut.Xc[ie][Ye]=ut.Wc[ie][lh[Ye]]}return B.kc=Mt(rt),B.kc&&(B.Bd=ne(rt,8)),B.cb=1}function gl(B,H,ie,Ee,Ye,rt,ut){var ht=H[Ye].Yb[ie];for(ie=0;16>Ye;++Ye){if(!wt(B,ht[ie+0]))return Ye;for(;!wt(B,ht[ie+1]);)if(ht=H[++Ye].Yb[0],ie=0,Ye==16)return 16;var gt=H[Ye+1].Yb;if(wt(B,ht[ie+2])){var kt=B,_n=0;if(wt(kt,(Un=ht)[(Vn=ie)+3]))if(wt(kt,Un[Vn+6])){for(ht=0,Vn=2*(_n=wt(kt,Un[Vn+8]))+(Un=wt(kt,Un[Vn+9+_n])),_n=0,Un=Vi[Vn];Un[ht];++ht)_n+=_n+wt(kt,Un[ht]);_n+=3+(8<<Vn)}else wt(kt,Un[Vn+7])?(_n=7+2*wt(kt,165),_n+=wt(kt,145)):_n=5+wt(kt,159);else _n=wt(kt,Un[Vn+4])?3+wt(kt,Un[Vn+5]):2;ht=gt[2]}else _n=1,ht=gt[1];gt=ut+vo[Ye],0>(kt=B).b&&lt(kt);var Vn,Un=kt.b,kn=(Vn=kt.Ca>>1)-(kt.I>>Un)>>31;--kt.b,kt.Ca+=kn,kt.Ca|=1,kt.I-=(Vn+1&kn)<<Un,rt[gt]=((_n^kn)-kn)*Ee[(0<Ye)+0]}return 16}function Ju(B){var H=B.rb[B.sb-1];H.la=0,H.Na=0,i(B.zc,0,0,B.zc.length),B.ja=0}function ki(B,H){if(B==null)return 0;if(H==null)return Di(B,2,"NULL VP8Io parameter in VP8Decode().");if(!B.cb&&!lu(B,H))return 0;if(t(B.cb),H.ac==null||H.ac(H)){H.ob&&(B.L=0);var ie=vu[B.L];if(B.L==2?(B.yb=0,B.zb=0):(B.yb=H.v-ie>>4,B.zb=H.j-ie>>4,0>B.yb&&(B.yb=0),0>B.zb&&(B.zb=0)),B.Va=H.o+15+ie>>4,B.Hb=H.va+15+ie>>4,B.Hb>B.za&&(B.Hb=B.za),B.Va>B.Ub&&(B.Va=B.Ub),0<B.L){var Ee=B.ed;for(ie=0;4>ie;++ie){var Ye;if(B.Qa.Cb){var rt=B.Qa.Lb[ie];B.Qa.Fb||(rt+=Ee.Tb)}else rt=Ee.Tb;for(Ye=0;1>=Ye;++Ye){var ut=B.gd[ie][Ye],ht=rt;if(Ee.Pc&&(ht+=Ee.vd[0],Ye&&(ht+=Ee.od[0])),0<(ht=0>ht?0:63<ht?63:ht)){var gt=ht;0<Ee.wb&&(gt=4<Ee.wb?gt>>2:gt>>1)>9-Ee.wb&&(gt=9-Ee.wb),1>gt&&(gt=1),ut.dd=gt,ut.tc=2*ht+gt,ut.ld=40<=ht?2:15<=ht?1:0}else ut.tc=0;ut.La=Ye}}}ie=0}else Di(B,6,"Frame setup failed"),ie=B.a;if(ie=ie==0){if(ie){B.$c=0,0<B.Aa||(B.Ic=kh);e:{ie=B.Ic,Ee=4*(gt=B.za);var kt=32*gt,_n=gt+1,Vn=0<B.L?gt*(0<B.Aa?2:1):0,Un=(B.Aa==2?2:1)*gt;if((ut=Ee+832+(Ye=3*(16*ie+vu[B.L])/2*kt)+(rt=B.Fa!=null&&0<B.Fa.length?B.Kc.c*B.Kc.i:0))!=ut)ie=0;else{if(ut>B.Vb){if(B.Vb=0,B.Ec=l(ut),B.Fc=0,B.Ec==null){ie=Di(B,1,"no memory during frame initialization.");break e}B.Vb=ut}ut=B.Ec,ht=B.Fc,B.Ac=ut,B.Bc=ht,ht+=Ee,B.Gd=a(kt,Cc),B.Hd=0,B.rb=a(_n+1,el),B.sb=1,B.wa=Vn?a(Vn,Wu):null,B.Y=0,B.D.Nb=0,B.D.wa=B.wa,B.D.Y=B.Y,0<B.Aa&&(B.D.Y+=gt),t(!0),B.oc=ut,B.pc=ht,ht+=832,B.ya=a(Un,Zu),B.aa=0,B.D.ya=B.ya,B.D.aa=B.aa,B.Aa==2&&(B.D.aa+=gt),B.R=16*gt,B.B=8*gt,gt=(kt=vu[B.L])*B.R,kt=kt/2*B.B,B.sa=ut,B.ta=ht+gt,B.qa=B.sa,B.ra=B.ta+16*ie*B.R+kt,B.Ha=B.qa,B.Ia=B.ra+8*ie*B.B+kt,B.$c=0,ht+=Ye,B.mb=rt?ut:null,B.nb=rt?ht:null,t(ht+rt<=B.Fc+B.Vb),Ju(B),i(B.Ac,B.Bc,0,Ee),ie=1}}if(ie){if(H.ka=0,H.y=B.sa,H.O=B.ta,H.f=B.qa,H.N=B.ra,H.ea=B.Ha,H.Vd=B.Ia,H.fa=B.R,H.Rc=B.B,H.F=null,H.J=0,!ah){for(ie=-255;255>=ie;++ie)Us[255+ie]=0>ie?-ie:ie;for(ie=-1020;1020>=ie;++ie)pa[1020+ie]=-128>ie?-128:127<ie?127:ie;for(ie=-112;112>=ie;++ie)Vo[112+ie]=-16>ie?-16:15<ie?15:ie;for(ie=-255;510>=ie;++ie)xl[255+ie]=0>ie?0:255<ie?255:ie;ah=1}Ln=tl,nr=yl,Hr=uu,ii=lo,xi=So,Fn=ku,as=Fo,Cs=Ea,dc=Ma,ra=Qu,Ts=vs,al=pu,bl=ss,Ga=Lc,ll=Ks,Vl=di,Ui=ro,fa=vl,Sl[0]=Bi,Sl[1]=ji,Sl[2]=Mi,Sl[3]=fs,Sl[4]=Bl,Sl[5]=No,Sl[6]=Nl,Sl[7]=Pa,Sl[8]=Sc,Sl[9]=qi,Cl[0]=cu,Cl[1]=rl,Cl[2]=Ws,Cl[3]=Zs,Cl[4]=us,Cl[5]=La,Cl[6]=Lo,qa[0]=Oi,qa[1]=nl,qa[2]=Gi,qa[3]=Nr,qa[4]=ua,qa[5]=hc,qa[6]=hu,ie=1}else ie=0}ie&&(ie=function(kn,ur){for(kn.M=0;kn.M<kn.Va;++kn.M){var Zn,Qt=kn.Jc[kn.M&kn.Xb],Sn=kn.m,fr=kn;for(Zn=0;Zn<fr.za;++Zn){var Cr=Sn,gr=fr,qr=gr.Ac,Ur=gr.Bc+4*Zn,ei=gr.zc,y=gr.ya[gr.aa+Zn];if(gr.Qa.Bb?y.$b=wt(Cr,gr.Pa.jb[0])?2+wt(Cr,gr.Pa.jb[2]):wt(Cr,gr.Pa.jb[1]):y.$b=0,gr.kc&&(y.Ad=wt(Cr,gr.Bd)),y.Za=!wt(Cr,145)+0,y.Za){var S=y.Ob,I=0;for(gr=0;4>gr;++gr){var F,G=ei[0+gr];for(F=0;4>F;++F){G=Ss[qr[Ur+F]][G];for(var te=Js[wt(Cr,G[0])];0<te;)te=Js[2*te+wt(Cr,G[te])];G=-te,qr[Ur+F]=G}r(S,I,qr,Ur,4),I+=4,ei[0+gr]=G}}else G=wt(Cr,156)?wt(Cr,128)?1:3:wt(Cr,163)?2:0,y.Ob[0]=G,i(qr,Ur,G,4),i(ei,0,G,4);y.Dd=wt(Cr,142)?wt(Cr,114)?wt(Cr,183)?1:3:2:0}if(fr.m.Ka)return Di(kn,7,"Premature end-of-partition0 encountered.");for(;kn.ja<kn.za;++kn.ja){if(fr=Qt,Cr=(Sn=kn).rb[Sn.sb-1],qr=Sn.rb[Sn.sb+Sn.ja],Zn=Sn.ya[Sn.aa+Sn.ja],Ur=Sn.kc?Zn.Ad:0)Cr.la=qr.la=0,Zn.Za||(Cr.Na=qr.Na=0),Zn.Hc=0,Zn.Gc=0,Zn.ia=0;else{var pe,xe;if(Cr=qr,qr=fr,Ur=Sn.Pa.Xc,ei=Sn.ya[Sn.aa+Sn.ja],y=Sn.pb[ei.$b],gr=ei.ad,S=0,I=Sn.rb[Sn.sb-1],G=F=0,i(gr,S,0,384),ei.Za)var Fe=0,tt=Ur[3];else{te=l(16);var zt=Cr.Na+I.Na;if(zt=Jr(qr,Ur[1],zt,y.Eb,0,te,0),Cr.Na=I.Na=(0<zt)+0,1<zt)Ln(te,0,gr,S);else{var bt=te[0]+3>>3;for(te=0;256>te;te+=16)gr[S+te]=bt}Fe=1,tt=Ur[0]}var dn=15&Cr.la,zn=15&I.la;for(te=0;4>te;++te){var hr=1&zn;for(bt=xe=0;4>bt;++bt)dn=dn>>1|(hr=(zt=Jr(qr,tt,zt=hr+(1&dn),y.Sc,Fe,gr,S))>Fe)<<7,xe=xe<<2|(3<zt?3:1<zt?2:gr[S+0]!=0),S+=16;dn>>=4,zn=zn>>1|hr<<7,F=(F<<8|xe)>>>0}for(tt=dn,Fe=zn>>4,pe=0;4>pe;pe+=2){for(xe=0,dn=Cr.la>>4+pe,zn=I.la>>4+pe,te=0;2>te;++te){for(hr=1&zn,bt=0;2>bt;++bt)zt=hr+(1&dn),dn=dn>>1|(hr=0<(zt=Jr(qr,Ur[2],zt,y.Qc,0,gr,S)))<<3,xe=xe<<2|(3<zt?3:1<zt?2:gr[S+0]!=0),S+=16;dn>>=2,zn=zn>>1|hr<<5}G|=xe<<4*pe,tt|=dn<<4<<pe,Fe|=(240&zn)<<pe}Cr.la=tt,I.la=Fe,ei.Hc=F,ei.Gc=G,ei.ia=43690&G?0:y.ia,Ur=!(F|G)}if(0<Sn.L&&(Sn.wa[Sn.Y+Sn.ja]=Sn.gd[Zn.$b][Zn.Za],Sn.wa[Sn.Y+Sn.ja].La|=!Ur),fr.Ka)return Di(kn,7,"Premature end-of-file encountered.")}if(Ju(kn),Sn=ur,fr=1,Zn=(Qt=kn).D,Cr=0<Qt.L&&Qt.M>=Qt.zb&&Qt.M<=Qt.Va,Qt.Aa==0)e:{if(Zn.M=Qt.M,Zn.uc=Cr,Fc(Qt,Zn),fr=1,Zn=(xe=Qt.D).Nb,Cr=(G=vu[Qt.L])*Qt.R,qr=G/2*Qt.B,te=16*Zn*Qt.R,bt=8*Zn*Qt.B,Ur=Qt.sa,ei=Qt.ta-Cr+te,y=Qt.qa,gr=Qt.ra-qr+bt,S=Qt.Ha,I=Qt.Ia-qr+bt,zn=(dn=xe.M)==0,F=dn>=Qt.Va-1,Qt.Aa==2&&Fc(Qt,xe),xe.uc)for(hr=(zt=Qt).D.M,t(zt.D.uc),xe=zt.yb;xe<zt.Hb;++xe){Fe=xe,tt=hr;var Ir=(Br=(at=zt).D).Nb;pe=at.R;var Br=Br.wa[Br.Y+Fe],ci=at.sa,Nt=at.ta+16*Ir*pe+16*Fe,qt=Br.dd,gn=Br.tc;if(gn!=0)if(t(3<=gn),at.L==1)0<Fe&&Vl(ci,Nt,pe,gn+4),Br.La&&fa(ci,Nt,pe,gn),0<tt&&ll(ci,Nt,pe,gn+4),Br.La&&Ui(ci,Nt,pe,gn);else{var Gn=at.B,Mn=at.qa,Bn=at.ra+8*Ir*Gn+8*Fe,Ge=at.Ha,at=at.Ia+8*Ir*Gn+8*Fe;Ir=Br.ld,0<Fe&&(Cs(ci,Nt,pe,gn+4,qt,Ir),ra(Mn,Bn,Ge,at,Gn,gn+4,qt,Ir)),Br.La&&(al(ci,Nt,pe,gn,qt,Ir),Ga(Mn,Bn,Ge,at,Gn,gn,qt,Ir)),0<tt&&(as(ci,Nt,pe,gn+4,qt,Ir),dc(Mn,Bn,Ge,at,Gn,gn+4,qt,Ir)),Br.La&&(Ts(ci,Nt,pe,gn,qt,Ir),bl(Mn,Bn,Ge,at,Gn,gn,qt,Ir))}}if(Qt.ia&&alert("todo:DitherRow"),Sn.put!=null){if(xe=16*dn,dn=16*(dn+1),zn?(Sn.y=Qt.sa,Sn.O=Qt.ta+te,Sn.f=Qt.qa,Sn.N=Qt.ra+bt,Sn.ea=Qt.Ha,Sn.W=Qt.Ia+bt):(xe-=G,Sn.y=Ur,Sn.O=ei,Sn.f=y,Sn.N=gr,Sn.ea=S,Sn.W=I),F||(dn-=G),dn>Sn.o&&(dn=Sn.o),Sn.F=null,Sn.J=null,Qt.Fa!=null&&0<Qt.Fa.length&&xe<dn&&(Sn.J=uo(Qt,Sn,xe,dn-xe),Sn.F=Qt.mb,Sn.F==null&&Sn.F.length==0)){fr=Di(Qt,3,"Could not decode alpha data.");break e}xe<Sn.j&&(G=Sn.j-xe,xe=Sn.j,t(!(1&G)),Sn.O+=Qt.R*G,Sn.N+=Qt.B*(G>>1),Sn.W+=Qt.B*(G>>1),Sn.F!=null&&(Sn.J+=Sn.width*G)),xe<dn&&(Sn.O+=Sn.v,Sn.N+=Sn.v>>1,Sn.W+=Sn.v>>1,Sn.F!=null&&(Sn.J+=Sn.v),Sn.ka=xe-Sn.j,Sn.U=Sn.va-Sn.v,Sn.T=dn-xe,fr=Sn.put(Sn))}Zn+1!=Qt.Ic||F||(r(Qt.sa,Qt.ta-Cr,Ur,ei+16*Qt.R,Cr),r(Qt.qa,Qt.ra-qr,y,gr+8*Qt.B,qr),r(Qt.Ha,Qt.Ia-qr,S,I+8*Qt.B,qr))}if(!fr)return Di(kn,6,"Output aborted.")}return 1}(B,H)),H.bc!=null&&H.bc(H),ie&=1}return ie?(B.cb=0,ie):0}function is(B,H,ie,Ee,Ye){Ye=B[H+ie+32*Ee]+(Ye>>3),B[H+ie+32*Ee]=-256&Ye?0>Ye?0:255:Ye}function Ua(B,H,ie,Ee,Ye,rt){is(B,H,0,ie,Ee+Ye),is(B,H,1,ie,Ee+rt),is(B,H,2,ie,Ee-rt),is(B,H,3,ie,Ee-Ye)}function Bo(B){return(20091*B>>16)+B}function Co(B,H,ie,Ee){var Ye,rt=0,ut=l(16);for(Ye=0;4>Ye;++Ye){var ht=B[H+0]+B[H+8],gt=B[H+0]-B[H+8],kt=(35468*B[H+4]>>16)-Bo(B[H+12]),_n=Bo(B[H+4])+(35468*B[H+12]>>16);ut[rt+0]=ht+_n,ut[rt+1]=gt+kt,ut[rt+2]=gt-kt,ut[rt+3]=ht-_n,rt+=4,H++}for(Ye=rt=0;4>Ye;++Ye)ht=(B=ut[rt+0]+4)+ut[rt+8],gt=B-ut[rt+8],kt=(35468*ut[rt+4]>>16)-Bo(ut[rt+12]),is(ie,Ee,0,0,ht+(_n=Bo(ut[rt+4])+(35468*ut[rt+12]>>16))),is(ie,Ee,1,0,gt+kt),is(ie,Ee,2,0,gt-kt),is(ie,Ee,3,0,ht-_n),rt++,Ee+=32}function ku(B,H,ie,Ee){var Ye=B[H+0]+4,rt=35468*B[H+4]>>16,ut=Bo(B[H+4]),ht=35468*B[H+1]>>16;Ua(ie,Ee,0,Ye+ut,B=Bo(B[H+1]),ht),Ua(ie,Ee,1,Ye+rt,B,ht),Ua(ie,Ee,2,Ye-rt,B,ht),Ua(ie,Ee,3,Ye-ut,B,ht)}function yl(B,H,ie,Ee,Ye){Co(B,H,ie,Ee),Ye&&Co(B,H+16,ie,Ee+4)}function uu(B,H,ie,Ee){nr(B,H+0,ie,Ee,1),nr(B,H+32,ie,Ee+128,1)}function lo(B,H,ie,Ee){var Ye;for(B=B[H+0]+4,Ye=0;4>Ye;++Ye)for(H=0;4>H;++H)is(ie,Ee,H,Ye,B)}function So(B,H,ie,Ee){B[H+0]&&ii(B,H+0,ie,Ee),B[H+16]&&ii(B,H+16,ie,Ee+4),B[H+32]&&ii(B,H+32,ie,Ee+128),B[H+48]&&ii(B,H+48,ie,Ee+128+4)}function tl(B,H,ie,Ee){var Ye,rt=l(16);for(Ye=0;4>Ye;++Ye){var ut=B[H+0+Ye]+B[H+12+Ye],ht=B[H+4+Ye]+B[H+8+Ye],gt=B[H+4+Ye]-B[H+8+Ye],kt=B[H+0+Ye]-B[H+12+Ye];rt[0+Ye]=ut+ht,rt[8+Ye]=ut-ht,rt[4+Ye]=kt+gt,rt[12+Ye]=kt-gt}for(Ye=0;4>Ye;++Ye)ut=(B=rt[0+4*Ye]+3)+rt[3+4*Ye],ht=rt[1+4*Ye]+rt[2+4*Ye],gt=rt[1+4*Ye]-rt[2+4*Ye],kt=B-rt[3+4*Ye],ie[Ee+0]=ut+ht>>3,ie[Ee+16]=kt+gt>>3,ie[Ee+32]=ut-ht>>3,ie[Ee+48]=kt-gt>>3,Ee+=64}function ui(B,H,ie){var Ee,Ye=H-32,rt=ks,ut=255-B[Ye-1];for(Ee=0;Ee<ie;++Ee){var ht,gt=rt,kt=ut+B[H-1];for(ht=0;ht<ie;++ht)B[H+ht]=gt[kt+B[Ye+ht]];H+=32}}function ji(B,H){ui(B,H,4)}function nl(B,H){ui(B,H,8)}function rl(B,H){ui(B,H,16)}function Ws(B,H){var ie;for(ie=0;16>ie;++ie)r(B,H+32*ie,B,H-32,16)}function Zs(B,H){var ie;for(ie=16;0<ie;--ie)i(B,H,B[H-1],16),H+=32}function Ms(B,H,ie){var Ee;for(Ee=0;16>Ee;++Ee)i(H,ie+32*Ee,B,16)}function cu(B,H){var ie,Ee=16;for(ie=0;16>ie;++ie)Ee+=B[H-1+32*ie]+B[H+ie-32];Ms(Ee>>5,B,H)}function us(B,H){var ie,Ee=8;for(ie=0;16>ie;++ie)Ee+=B[H-1+32*ie];Ms(Ee>>4,B,H)}function La(B,H){var ie,Ee=8;for(ie=0;16>ie;++ie)Ee+=B[H+ie-32];Ms(Ee>>4,B,H)}function Lo(B,H){Ms(128,B,H)}function yi(B,H,ie){return B+2*H+ie+2>>2}function Mi(B,H){var ie,Ee=H-32;for(Ee=new Uint8Array([yi(B[Ee-1],B[Ee+0],B[Ee+1]),yi(B[Ee+0],B[Ee+1],B[Ee+2]),yi(B[Ee+1],B[Ee+2],B[Ee+3]),yi(B[Ee+2],B[Ee+3],B[Ee+4])]),ie=0;4>ie;++ie)r(B,H+32*ie,Ee,0,Ee.length)}function fs(B,H){var ie=B[H-1],Ee=B[H-1+32],Ye=B[H-1+64],rt=B[H-1+96];rn(B,H+0,16843009*yi(B[H-1-32],ie,Ee)),rn(B,H+32,16843009*yi(ie,Ee,Ye)),rn(B,H+64,16843009*yi(Ee,Ye,rt)),rn(B,H+96,16843009*yi(Ye,rt,rt))}function Bi(B,H){var ie,Ee=4;for(ie=0;4>ie;++ie)Ee+=B[H+ie-32]+B[H-1+32*ie];for(Ee>>=3,ie=0;4>ie;++ie)i(B,H+32*ie,Ee,4)}function Bl(B,H){var ie=B[H-1+0],Ee=B[H-1+32],Ye=B[H-1+64],rt=B[H-1-32],ut=B[H+0-32],ht=B[H+1-32],gt=B[H+2-32],kt=B[H+3-32];B[H+0+96]=yi(Ee,Ye,B[H-1+96]),B[H+1+96]=B[H+0+64]=yi(ie,Ee,Ye),B[H+2+96]=B[H+1+64]=B[H+0+32]=yi(rt,ie,Ee),B[H+3+96]=B[H+2+64]=B[H+1+32]=B[H+0+0]=yi(ut,rt,ie),B[H+3+64]=B[H+2+32]=B[H+1+0]=yi(ht,ut,rt),B[H+3+32]=B[H+2+0]=yi(gt,ht,ut),B[H+3+0]=yi(kt,gt,ht)}function Nl(B,H){var ie=B[H+1-32],Ee=B[H+2-32],Ye=B[H+3-32],rt=B[H+4-32],ut=B[H+5-32],ht=B[H+6-32],gt=B[H+7-32];B[H+0+0]=yi(B[H+0-32],ie,Ee),B[H+1+0]=B[H+0+32]=yi(ie,Ee,Ye),B[H+2+0]=B[H+1+32]=B[H+0+64]=yi(Ee,Ye,rt),B[H+3+0]=B[H+2+32]=B[H+1+64]=B[H+0+96]=yi(Ye,rt,ut),B[H+3+32]=B[H+2+64]=B[H+1+96]=yi(rt,ut,ht),B[H+3+64]=B[H+2+96]=yi(ut,ht,gt),B[H+3+96]=yi(ht,gt,gt)}function No(B,H){var ie=B[H-1+0],Ee=B[H-1+32],Ye=B[H-1+64],rt=B[H-1-32],ut=B[H+0-32],ht=B[H+1-32],gt=B[H+2-32],kt=B[H+3-32];B[H+0+0]=B[H+1+64]=rt+ut+1>>1,B[H+1+0]=B[H+2+64]=ut+ht+1>>1,B[H+2+0]=B[H+3+64]=ht+gt+1>>1,B[H+3+0]=gt+kt+1>>1,B[H+0+96]=yi(Ye,Ee,ie),B[H+0+64]=yi(Ee,ie,rt),B[H+0+32]=B[H+1+96]=yi(ie,rt,ut),B[H+1+32]=B[H+2+96]=yi(rt,ut,ht),B[H+2+32]=B[H+3+96]=yi(ut,ht,gt),B[H+3+32]=yi(ht,gt,kt)}function Pa(B,H){var ie=B[H+0-32],Ee=B[H+1-32],Ye=B[H+2-32],rt=B[H+3-32],ut=B[H+4-32],ht=B[H+5-32],gt=B[H+6-32],kt=B[H+7-32];B[H+0+0]=ie+Ee+1>>1,B[H+1+0]=B[H+0+64]=Ee+Ye+1>>1,B[H+2+0]=B[H+1+64]=Ye+rt+1>>1,B[H+3+0]=B[H+2+64]=rt+ut+1>>1,B[H+0+32]=yi(ie,Ee,Ye),B[H+1+32]=B[H+0+96]=yi(Ee,Ye,rt),B[H+2+32]=B[H+1+96]=yi(Ye,rt,ut),B[H+3+32]=B[H+2+96]=yi(rt,ut,ht),B[H+3+64]=yi(ut,ht,gt),B[H+3+96]=yi(ht,gt,kt)}function qi(B,H){var ie=B[H-1+0],Ee=B[H-1+32],Ye=B[H-1+64],rt=B[H-1+96];B[H+0+0]=ie+Ee+1>>1,B[H+2+0]=B[H+0+32]=Ee+Ye+1>>1,B[H+2+32]=B[H+0+64]=Ye+rt+1>>1,B[H+1+0]=yi(ie,Ee,Ye),B[H+3+0]=B[H+1+32]=yi(Ee,Ye,rt),B[H+3+32]=B[H+1+64]=yi(Ye,rt,rt),B[H+3+64]=B[H+2+64]=B[H+0+96]=B[H+1+96]=B[H+2+96]=B[H+3+96]=rt}function Sc(B,H){var ie=B[H-1+0],Ee=B[H-1+32],Ye=B[H-1+64],rt=B[H-1+96],ut=B[H-1-32],ht=B[H+0-32],gt=B[H+1-32],kt=B[H+2-32];B[H+0+0]=B[H+2+32]=ie+ut+1>>1,B[H+0+32]=B[H+2+64]=Ee+ie+1>>1,B[H+0+64]=B[H+2+96]=Ye+Ee+1>>1,B[H+0+96]=rt+Ye+1>>1,B[H+3+0]=yi(ht,gt,kt),B[H+2+0]=yi(ut,ht,gt),B[H+1+0]=B[H+3+32]=yi(ie,ut,ht),B[H+1+32]=B[H+3+64]=yi(Ee,ie,ut),B[H+1+64]=B[H+3+96]=yi(Ye,Ee,ie),B[H+1+96]=yi(rt,Ye,Ee)}function Gi(B,H){var ie;for(ie=0;8>ie;++ie)r(B,H+32*ie,B,H-32,8)}function Nr(B,H){var ie;for(ie=0;8>ie;++ie)i(B,H,B[H-1],8),H+=32}function Fi(B,H,ie){var Ee;for(Ee=0;8>Ee;++Ee)i(H,ie+32*Ee,B,8)}function Oi(B,H){var ie,Ee=8;for(ie=0;8>ie;++ie)Ee+=B[H+ie-32]+B[H-1+32*ie];Fi(Ee>>4,B,H)}function hc(B,H){var ie,Ee=4;for(ie=0;8>ie;++ie)Ee+=B[H+ie-32];Fi(Ee>>3,B,H)}function ua(B,H){var ie,Ee=4;for(ie=0;8>ie;++ie)Ee+=B[H-1+32*ie];Fi(Ee>>3,B,H)}function hu(B,H){Fi(128,B,H)}function du(B,H,ie){var Ee=B[H-ie],Ye=B[H+0],rt=3*(Ye-Ee)+wl[1020+B[H-2*ie]-B[H+ie]],ut=To[112+(rt+4>>3)];B[H-ie]=ks[255+Ee+To[112+(rt+3>>3)]],B[H+0]=ks[255+Ye-ut]}function Iu(B,H,ie,Ee){var Ye=B[H+0],rt=B[H+ie];return ho[255+B[H-2*ie]-B[H-ie]]>Ee||ho[255+rt-Ye]>Ee}function fu(B,H,ie,Ee){return 4*ho[255+B[H-ie]-B[H+0]]+ho[255+B[H-2*ie]-B[H+ie]]<=Ee}function Hi(B,H,ie,Ee,Ye){var rt=B[H-3*ie],ut=B[H-2*ie],ht=B[H-ie],gt=B[H+0],kt=B[H+ie],_n=B[H+2*ie],Vn=B[H+3*ie];return 4*ho[255+ht-gt]+ho[255+ut-kt]>Ee?0:ho[255+B[H-4*ie]-rt]<=Ye&&ho[255+rt-ut]<=Ye&&ho[255+ut-ht]<=Ye&&ho[255+Vn-_n]<=Ye&&ho[255+_n-kt]<=Ye&&ho[255+kt-gt]<=Ye}function Ks(B,H,ie,Ee){var Ye=2*Ee+1;for(Ee=0;16>Ee;++Ee)fu(B,H+Ee,ie,Ye)&&du(B,H+Ee,ie)}function di(B,H,ie,Ee){var Ye=2*Ee+1;for(Ee=0;16>Ee;++Ee)fu(B,H+Ee*ie,1,Ye)&&du(B,H+Ee*ie,1)}function ro(B,H,ie,Ee){var Ye;for(Ye=3;0<Ye;--Ye)Ks(B,H+=4*ie,ie,Ee)}function vl(B,H,ie,Ee){var Ye;for(Ye=3;0<Ye;--Ye)di(B,H+=4,ie,Ee)}function Ys(B,H,ie,Ee,Ye,rt,ut,ht){for(rt=2*rt+1;0<Ye--;){if(Hi(B,H,ie,rt,ut))if(Iu(B,H,ie,ht))du(B,H,ie);else{var gt=B,kt=H,_n=ie,Vn=gt[kt-2*_n],Un=gt[kt-_n],kn=gt[kt+0],ur=gt[kt+_n],Zn=gt[kt+2*_n],Qt=27*(fr=wl[1020+3*(kn-Un)+wl[1020+Vn-ur]])+63>>7,Sn=18*fr+63>>7,fr=9*fr+63>>7;gt[kt-3*_n]=ks[255+gt[kt-3*_n]+fr],gt[kt-2*_n]=ks[255+Vn+Sn],gt[kt-_n]=ks[255+Un+Qt],gt[kt+0]=ks[255+kn-Qt],gt[kt+_n]=ks[255+ur-Sn],gt[kt+2*_n]=ks[255+Zn-fr]}H+=Ee}}function Fs(B,H,ie,Ee,Ye,rt,ut,ht){for(rt=2*rt+1;0<Ye--;){if(Hi(B,H,ie,rt,ut))if(Iu(B,H,ie,ht))du(B,H,ie);else{var gt=B,kt=H,_n=ie,Vn=gt[kt-_n],Un=gt[kt+0],kn=gt[kt+_n],ur=To[112+((Zn=3*(Un-Vn))+4>>3)],Zn=To[112+(Zn+3>>3)],Qt=ur+1>>1;gt[kt-2*_n]=ks[255+gt[kt-2*_n]+Qt],gt[kt-_n]=ks[255+Vn+Zn],gt[kt+0]=ks[255+Un-ur],gt[kt+_n]=ks[255+kn-Qt]}H+=Ee}}function Fo(B,H,ie,Ee,Ye,rt){Ys(B,H,ie,1,16,Ee,Ye,rt)}function Ea(B,H,ie,Ee,Ye,rt){Ys(B,H,1,ie,16,Ee,Ye,rt)}function vs(B,H,ie,Ee,Ye,rt){var ut;for(ut=3;0<ut;--ut)Fs(B,H+=4*ie,ie,1,16,Ee,Ye,rt)}function pu(B,H,ie,Ee,Ye,rt){var ut;for(ut=3;0<ut;--ut)Fs(B,H+=4,1,ie,16,Ee,Ye,rt)}function Ma(B,H,ie,Ee,Ye,rt,ut,ht){Ys(B,H,Ye,1,8,rt,ut,ht),Ys(ie,Ee,Ye,1,8,rt,ut,ht)}function Qu(B,H,ie,Ee,Ye,rt,ut,ht){Ys(B,H,1,Ye,8,rt,ut,ht),Ys(ie,Ee,1,Ye,8,rt,ut,ht)}function ss(B,H,ie,Ee,Ye,rt,ut,ht){Fs(B,H+4*Ye,Ye,1,8,rt,ut,ht),Fs(ie,Ee+4*Ye,Ye,1,8,rt,ut,ht)}function Lc(B,H,ie,Ee,Ye,rt,ut,ht){Fs(B,H+4,1,Ye,8,rt,ut,ht),Fs(ie,Ee+4,1,Ye,8,rt,ut,ht)}function Po(){this.ba=new Gt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ot,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Fl(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Du(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Va(){this.ua=0,this.Wa=new Ce,this.vb=new Ce,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new be,this.yc=new de}function Jo(){this.xb=this.a=0,this.l=new ja,this.ca=new Gt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new ge,this.Pb=0,this.wd=new ge,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Va,this.ab=0,this.gc=a(4,Du),this.Oc=0}function zl(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new ja,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function os(B,H,ie,Ee,Ye,rt,ut){for(B=B==null?0:B[H+0],H=0;H<ut;++H)Ye[rt+H]=B+ie[Ee+H]&255,B=Ye[rt+H]}function ca(B,H,ie,Ee,Ye,rt,ut){var ht;if(B==null)os(null,null,ie,Ee,Ye,rt,ut);else for(ht=0;ht<ut;++ht)Ye[rt+ht]=B[H+ht]+ie[Ee+ht]&255}function il(B,H,ie,Ee,Ye,rt,ut){if(B==null)os(null,null,ie,Ee,Ye,rt,ut);else{var ht,gt=B[H+0],kt=gt,_n=gt;for(ht=0;ht<ut;++ht)kt=_n+(gt=B[H+ht])-kt,_n=ie[Ee+ht]+(-256&kt?0>kt?0:255:kt)&255,kt=gt,Ye[rt+ht]=_n}}function uo(B,H,ie,Ee){var Ye=H.width,rt=H.o;if(t(B!=null&&H!=null),0>ie||0>=Ee||ie+Ee>rt)return null;if(!B.Cc){if(B.ga==null){var ut;if(B.ga=new zl,(ut=B.ga==null)||(ut=H.width*H.o,t(B.Gb.length==0),B.Gb=l(ut),B.Uc=0,B.Gb==null?ut=0:(B.mb=B.Gb,B.nb=B.Uc,B.rc=null,ut=1),ut=!ut),!ut){ut=B.ga;var ht=B.Fa,gt=B.P,kt=B.qc,_n=B.mb,Vn=B.nb,Un=gt+1,kn=kt-1,ur=ut.l;if(t(ht!=null&&_n!=null&&H!=null),xs[0]=null,xs[1]=os,xs[2]=ca,xs[3]=il,ut.ca=_n,ut.tb=Vn,ut.c=H.width,ut.i=H.height,t(0<ut.c&&0<ut.i),1>=kt)H=0;else if(ut.$a=ht[gt+0]>>0&3,ut.Z=ht[gt+0]>>2&3,ut.Lc=ht[gt+0]>>4&3,gt=ht[gt+0]>>6&3,0>ut.$a||1<ut.$a||4<=ut.Z||1<ut.Lc||gt)H=0;else if(ur.put=Lr,ur.ac=Qn,ur.bc=Yt,ur.ma=ut,ur.width=H.width,ur.height=H.height,ur.Da=H.Da,ur.v=H.v,ur.va=H.va,ur.j=H.j,ur.o=H.o,ut.$a)e:{t(ut.$a==1),H=Pr();t:for(;;){if(H==null){H=0;break e}if(t(ut!=null),ut.mc=H,H.c=ut.c,H.i=ut.i,H.l=ut.l,H.l.ma=ut,H.l.width=ut.c,H.l.height=ut.i,H.a=0,Le(H.m,ht,Un,kn),!As(ut.c,ut.i,1,H,null)||(H.ab==1&&H.gc[0].hc==3&&Hn(H.s)?(ut.ic=1,ht=H.c*H.i,H.Ta=null,H.Ua=0,H.V=l(ht),H.Ba=0,H.V==null?(H.a=1,H=0):H=1):(ut.ic=0,H=$i(H,ut.c)),!H))break t;H=1;break e}ut.mc=null,H=0}else H=kn>=ut.c*ut.i;ut=!H}if(ut)return null;B.ga.Lc!=1?B.Ga=0:Ee=rt-ie}t(B.ga!=null),t(ie+Ee<=rt);e:{if(H=(ht=B.ga).c,rt=ht.l.o,ht.$a==0){if(Un=B.rc,kn=B.Vc,ur=B.Fa,gt=B.P+1+ie*H,kt=B.mb,_n=B.nb+ie*H,t(gt<=B.P+B.qc),ht.Z!=0)for(t(xs[ht.Z]!=null),ut=0;ut<Ee;++ut)xs[ht.Z](Un,kn,ur,gt,kt,_n,H),Un=kt,kn=_n,_n+=H,gt+=H;else for(ut=0;ut<Ee;++ut)r(kt,_n,ur,gt,H),Un=kt,kn=_n,_n+=H,gt+=H;B.rc=Un,B.Vc=kn}else{if(t(ht.mc!=null),H=ie+Ee,t((ut=ht.mc)!=null),t(H<=ut.i),ut.C>=H)H=1;else if(ht.ic||An(),ht.ic){ht=ut.V,Un=ut.Ba,kn=ut.c;var Zn=ut.i,Qt=(ur=1,gt=ut.$/kn,kt=ut.$%kn,_n=ut.m,Vn=ut.s,ut.$),Sn=kn*Zn,fr=kn*H,Cr=Vn.wc,gr=Qt<fr?Cn(Vn,kt,gt):null;t(Qt<=Sn),t(H<=Zn),t(Hn(Vn));t:for(;;){for(;!_n.h&&Qt<fr;){if(kt&Cr||(gr=Cn(Vn,kt,gt)),t(gr!=null),it(_n),256>(Zn=br(gr.G[0],gr.H[0],_n)))ht[Un+Qt]=Zn,++Qt,++kt>=kn&&(kt=0,++gt<=H&&!(gt%16)&&Xr(ut,gt));else{if(!(280>Zn)){ur=0;break t}Zn=Tn(Zn-256,_n);var qr,Ur=br(gr.G[4],gr.H[4],_n);if(it(_n),!(Qt>=(Ur=bn(kn,Ur=Tn(Ur,_n)))&&Sn-Qt>=Zn)){ur=0;break t}for(qr=0;qr<Zn;++qr)ht[Un+Qt+qr]=ht[Un+Qt+qr-Ur];for(Qt+=Zn,kt+=Zn;kt>=kn;)kt-=kn,++gt<=H&&!(gt%16)&&Xr(ut,gt);Qt<fr&&kt&Cr&&(gr=Cn(Vn,kt,gt))}t(_n.h==Ne(_n))}Xr(ut,gt>H?H:gt);break t}!ur||_n.h&&Qt<Sn?(ur=0,ut.a=_n.h?5:3):ut.$=Qt,H=ur}else H=ri(ut,ut.V,ut.Ba,ut.c,ut.i,H,Qa);if(!H){Ee=0;break e}}ie+Ee>=rt&&(B.Cc=1),Ee=1}if(!Ee)return null;if(B.Cc&&((Ee=B.ga)!=null&&(Ee.mc=null),B.ga=null,0<B.Ga))return alert("todo:WebPDequantizeLevels"),null}return B.nb+ie*Ye}function J(B,H,ie,Ee,Ye,rt){for(;0<Ye--;){var ut,ht=B,gt=H+(ie?1:0),kt=B,_n=H+(ie?0:3);for(ut=0;ut<Ee;++ut){var Vn=kt[_n+4*ut];Vn!=255&&(Vn*=32897,ht[gt+4*ut+0]=ht[gt+4*ut+0]*Vn>>23,ht[gt+4*ut+1]=ht[gt+4*ut+1]*Vn>>23,ht[gt+4*ut+2]=ht[gt+4*ut+2]*Vn>>23)}H+=rt}}function Xe(B,H,ie,Ee,Ye){for(;0<Ee--;){var rt;for(rt=0;rt<ie;++rt){var ut=B[H+2*rt+0],ht=15&(kt=B[H+2*rt+1]),gt=4369*ht,kt=(240&kt|kt>>4)*gt>>16;B[H+2*rt+0]=(240&ut|ut>>4)*gt>>16&240|(15&ut|ut<<4)*gt>>16>>4&15,B[H+2*rt+1]=240&kt|ht}H+=Ye}}function Bt(B,H,ie,Ee,Ye,rt,ut,ht){var gt,kt,_n=255;for(kt=0;kt<Ye;++kt){for(gt=0;gt<Ee;++gt){var Vn=B[H+gt];rt[ut+4*gt]=Vn,_n&=Vn}H+=ie,ut+=ht}return _n!=255}function nn(B,H,ie,Ee,Ye){var rt;for(rt=0;rt<Ye;++rt)ie[Ee+rt]=B[H+rt]>>8}function An(){Uo=J,bs=Xe,oi=Bt,io=nn}function Xn(B,H,ie){ue[B]=function(Ee,Ye,rt,ut,ht,gt,kt,_n,Vn,Un,kn,ur,Zn,Qt,Sn,fr,Cr){var gr,qr=Cr-1>>1,Ur=ht[gt+0]|kt[_n+0]<<16,ei=Vn[Un+0]|kn[ur+0]<<16;t(Ee!=null);var y=3*Ur+ei+131074>>2;for(H(Ee[Ye+0],255&y,y>>16,Zn,Qt),rt!=null&&(y=3*ei+Ur+131074>>2,H(rt[ut+0],255&y,y>>16,Sn,fr)),gr=1;gr<=qr;++gr){var S=ht[gt+gr]|kt[_n+gr]<<16,I=Vn[Un+gr]|kn[ur+gr]<<16,F=Ur+S+ei+I+524296,G=F+2*(S+ei)>>3;y=G+Ur>>1,Ur=(F=F+2*(Ur+I)>>3)+S>>1,H(Ee[Ye+2*gr-1],255&y,y>>16,Zn,Qt+(2*gr-1)*ie),H(Ee[Ye+2*gr-0],255&Ur,Ur>>16,Zn,Qt+(2*gr-0)*ie),rt!=null&&(y=F+ei>>1,Ur=G+I>>1,H(rt[ut+2*gr-1],255&y,y>>16,Sn,fr+(2*gr-1)*ie),H(rt[ut+2*gr+0],255&Ur,Ur>>16,Sn,fr+(2*gr+0)*ie)),Ur=S,ei=I}1&Cr||(y=3*Ur+ei+131074>>2,H(Ee[Ye+Cr-1],255&y,y>>16,Zn,Qt+(Cr-1)*ie),rt!=null&&(y=3*ei+Ur+131074>>2,H(rt[ut+Cr-1],255&y,y>>16,Sn,fr+(Cr-1)*ie)))}}function wr(){ia[$o]=dt,ia[vi]=Vc,ia[$l]=ka,ia[yu]=qo,ia[Ha]=Ni,ia[Go]=ec,ia[Uc]=Ll,ia[Ho]=Vc,ia[Ao]=qo,ia[Gl]=Ni,ia[p]=ec}function Wr(B){return B&-16384?0>B?0:255:B>>fc}function Zr(B,H){return Wr((19077*B>>8)+(26149*H>>8)-14234)}function fi(B,H,ie){return Wr((19077*B>>8)-(6419*H>>8)-(13320*ie>>8)+8708)}function Pi(B,H){return Wr((19077*B>>8)+(33050*H>>8)-17685)}function Xi(B,H,ie,Ee,Ye){Ee[Ye+0]=Zr(B,ie),Ee[Ye+1]=fi(B,H,ie),Ee[Ye+2]=Pi(B,H)}function js(B,H,ie,Ee,Ye){Ee[Ye+0]=Pi(B,H),Ee[Ye+1]=fi(B,H,ie),Ee[Ye+2]=Zr(B,ie)}function cs(B,H,ie,Ee,Ye){var rt=fi(B,H,ie);H=rt<<3&224|Pi(B,H)>>3,Ee[Ye+0]=248&Zr(B,ie)|rt>>5,Ee[Ye+1]=H}function _s(B,H,ie,Ee,Ye){var rt=240&Pi(B,H)|15;Ee[Ye+0]=240&Zr(B,ie)|fi(B,H,ie)>>4,Ee[Ye+1]=rt}function co(B,H,ie,Ee,Ye){Ee[Ye+0]=255,Xi(B,H,ie,Ee,Ye+1)}function yo(B,H,ie,Ee,Ye){js(B,H,ie,Ee,Ye),Ee[Ye+3]=255}function $a(B,H,ie,Ee,Ye){Xi(B,H,ie,Ee,Ye),Ee[Ye+3]=255}function Ri(B,H){return 0>B?0:B>H?H:B}function Qo(B,H,ie){ue[B]=function(Ee,Ye,rt,ut,ht,gt,kt,_n,Vn){for(var Un=_n+(-2&Vn)*ie;_n!=Un;)H(Ee[Ye+0],rt[ut+0],ht[gt+0],kt,_n),H(Ee[Ye+1],rt[ut+0],ht[gt+0],kt,_n+ie),Ye+=2,++ut,++gt,_n+=2*ie;1&Vn&&H(Ee[Ye+0],rt[ut+0],ht[gt+0],kt,_n)}}function mu(B,H,ie){return ie==0?B==0?H==0?6:5:H==0?4:0:ie}function Eo(B,H,ie,Ee,Ye){switch(B>>>30){case 3:nr(H,ie,Ee,Ye,0);break;case 2:Fn(H,ie,Ee,Ye);break;case 1:ii(H,ie,Ee,Ye)}}function Fc(B,H){var ie,Ee,Ye=H.M,rt=H.Nb,ut=B.oc,ht=B.pc+40,gt=B.oc,kt=B.pc+584,_n=B.oc,Vn=B.pc+600;for(ie=0;16>ie;++ie)ut[ht+32*ie-1]=129;for(ie=0;8>ie;++ie)gt[kt+32*ie-1]=129,_n[Vn+32*ie-1]=129;for(0<Ye?ut[ht-1-32]=gt[kt-1-32]=_n[Vn-1-32]=129:(i(ut,ht-32-1,127,21),i(gt,kt-32-1,127,9),i(_n,Vn-32-1,127,9)),Ee=0;Ee<B.za;++Ee){var Un=H.ya[H.aa+Ee];if(0<Ee){for(ie=-1;16>ie;++ie)r(ut,ht+32*ie-4,ut,ht+32*ie+12,4);for(ie=-1;8>ie;++ie)r(gt,kt+32*ie-4,gt,kt+32*ie+4,4),r(_n,Vn+32*ie-4,_n,Vn+32*ie+4,4)}var kn=B.Gd,ur=B.Hd+Ee,Zn=Un.ad,Qt=Un.Hc;if(0<Ye&&(r(ut,ht-32,kn[ur].y,0,16),r(gt,kt-32,kn[ur].f,0,8),r(_n,Vn-32,kn[ur].ea,0,8)),Un.Za){var Sn=ut,fr=ht-32+16;for(0<Ye&&(Ee>=B.za-1?i(Sn,fr,kn[ur].y[15],4):r(Sn,fr,kn[ur+1].y,0,4)),ie=0;4>ie;ie++)Sn[fr+128+ie]=Sn[fr+256+ie]=Sn[fr+384+ie]=Sn[fr+0+ie];for(ie=0;16>ie;++ie,Qt<<=2)Sn=ut,fr=ht+Gr[ie],Sl[Un.Ob[ie]](Sn,fr),Eo(Qt,Zn,16*+ie,Sn,fr)}else if(Sn=mu(Ee,Ye,Un.Ob[0]),Cl[Sn](ut,ht),Qt!=0)for(ie=0;16>ie;++ie,Qt<<=2)Eo(Qt,Zn,16*+ie,ut,ht+Gr[ie]);for(ie=Un.Gc,Sn=mu(Ee,Ye,Un.Dd),qa[Sn](gt,kt),qa[Sn](_n,Vn),Qt=Zn,Sn=gt,fr=kt,255&(Un=ie>>0)&&(170&Un?Hr(Qt,256,Sn,fr):xi(Qt,256,Sn,fr)),Un=_n,Qt=Vn,255&(ie>>=8)&&(170&ie?Hr(Zn,320,Un,Qt):xi(Zn,320,Un,Qt)),Ye<B.Ub-1&&(r(kn[ur].y,0,ut,ht+480,16),r(kn[ur].f,0,gt,kt+224,8),r(kn[ur].ea,0,_n,Vn+224,8)),ie=8*rt*B.B,kn=B.sa,ur=B.ta+16*Ee+16*rt*B.R,Zn=B.qa,Un=B.ra+8*Ee+ie,Qt=B.Ha,Sn=B.Ia+8*Ee+ie,ie=0;16>ie;++ie)r(kn,ur+ie*B.R,ut,ht+32*ie,16);for(ie=0;8>ie;++ie)r(Zn,Un+ie*B.B,gt,kt+32*ie,8),r(Qt,Sn+ie*B.B,_n,Vn+32*ie,8)}}function sl(B,H,ie,Ee,Ye,rt,ut,ht,gt){var kt=[0],_n=[0],Vn=0,Un=gt!=null?gt.kd:0,kn=gt??new Fl;if(B==null||12>ie)return 7;kn.data=B,kn.w=H,kn.ha=ie,H=[H],ie=[ie],kn.gb=[kn.gb];e:{var ur=H,Zn=ie,Qt=kn.gb;if(t(B!=null),t(Zn!=null),t(Qt!=null),Qt[0]=0,12<=Zn[0]&&!n(B,ur[0],"RIFF")){if(n(B,ur[0]+8,"WEBP")){Qt=3;break e}var Sn=De(B,ur[0]+4);if(12>Sn||4294967286<Sn){Qt=3;break e}if(Un&&Sn>Zn[0]-8){Qt=7;break e}Qt[0]=Sn,ur[0]+=12,Zn[0]-=12}Qt=0}if(Qt!=0)return Qt;for(Sn=0<kn.gb[0],ie=ie[0];;){e:{var fr=B;Zn=H,Qt=ie;var Cr=kt,gr=_n,qr=ur=[0];if((y=Vn=[Vn])[0]=0,8>Qt[0])Qt=7;else{if(!n(fr,Zn[0],"VP8X")){if(De(fr,Zn[0]+4)!=10){Qt=3;break e}if(18>Qt[0]){Qt=7;break e}var Ur=De(fr,Zn[0]+8),ei=1+Pn(fr,Zn[0]+12);if(2147483648<=ei*(fr=1+Pn(fr,Zn[0]+15))){Qt=3;break e}qr!=null&&(qr[0]=Ur),Cr!=null&&(Cr[0]=ei),gr!=null&&(gr[0]=fr),Zn[0]+=18,Qt[0]-=18,y[0]=1}Qt=0}}if(Vn=Vn[0],ur=ur[0],Qt!=0)return Qt;if(Zn=!!(2&ur),!Sn&&Vn)return 3;if(rt!=null&&(rt[0]=!!(16&ur)),ut!=null&&(ut[0]=Zn),ht!=null&&(ht[0]=0),ut=kt[0],ur=_n[0],Vn&&Zn&&gt==null){Qt=0;break}if(4>ie){Qt=7;break}if(Sn&&Vn||!Sn&&!Vn&&!n(B,H[0],"ALPH")){ie=[ie],kn.na=[kn.na],kn.P=[kn.P],kn.Sa=[kn.Sa];e:{Ur=B,Qt=H,Sn=ie;var y=kn.gb;Cr=kn.na,gr=kn.P,qr=kn.Sa,ei=22,t(Ur!=null),t(Sn!=null),fr=Qt[0];var S=Sn[0];for(t(Cr!=null),t(qr!=null),Cr[0]=null,gr[0]=null,qr[0]=0;;){if(Qt[0]=fr,Sn[0]=S,8>S){Qt=7;break e}var I=De(Ur,fr+4);if(4294967286<I){Qt=3;break e}var F=8+I+1&-2;if(ei+=F,0<y&&ei>y){Qt=3;break e}if(!n(Ur,fr,"VP8 ")||!n(Ur,fr,"VP8L")){Qt=0;break e}if(S[0]<F){Qt=7;break e}n(Ur,fr,"ALPH")||(Cr[0]=Ur,gr[0]=fr+8,qr[0]=I),fr+=F,S-=F}}if(ie=ie[0],kn.na=kn.na[0],kn.P=kn.P[0],kn.Sa=kn.Sa[0],Qt!=0)break}ie=[ie],kn.Ja=[kn.Ja],kn.xa=[kn.xa];e:if(y=B,Qt=H,Sn=ie,Cr=kn.gb[0],gr=kn.Ja,qr=kn.xa,Ur=Qt[0],fr=!n(y,Ur,"VP8 "),ei=!n(y,Ur,"VP8L"),t(y!=null),t(Sn!=null),t(gr!=null),t(qr!=null),8>Sn[0])Qt=7;else{if(fr||ei){if(y=De(y,Ur+4),12<=Cr&&y>Cr-12){Qt=3;break e}if(Un&&y>Sn[0]-8){Qt=7;break e}gr[0]=y,Qt[0]+=8,Sn[0]-=8,qr[0]=ei}else qr[0]=5<=Sn[0]&&y[Ur+0]==47&&!(y[Ur+4]>>5),gr[0]=Sn[0];Qt=0}if(ie=ie[0],kn.Ja=kn.Ja[0],kn.xa=kn.xa[0],H=H[0],Qt!=0)break;if(4294967286<kn.Ja)return 3;if(ht==null||Zn||(ht[0]=kn.xa?2:1),ut=[ut],ur=[ur],kn.xa){if(5>ie){Qt=7;break}ht=ut,Un=ur,Zn=rt,B==null||5>ie?B=0:5<=ie&&B[H+0]==47&&!(B[H+4]>>5)?(Sn=[0],y=[0],Cr=[0],Le(gr=new ge,B,H,ie),vt(gr,Sn,y,Cr)?(ht!=null&&(ht[0]=Sn[0]),Un!=null&&(Un[0]=y[0]),Zn!=null&&(Zn[0]=Cr[0]),B=1):B=0):B=0}else{if(10>ie){Qt=7;break}ht=ur,B==null||10>ie||!Xu(B,H+3,ie-3)?B=0:(Un=B[H+0]|B[H+1]<<8|B[H+2]<<16,Zn=16383&(B[H+7]<<8|B[H+6]),B=16383&(B[H+9]<<8|B[H+8]),1&Un||3<(Un>>1&7)||!(Un>>4&1)||Un>>5>=kn.Ja||!Zn||!B?B=0:(ut&&(ut[0]=Zn),ht&&(ht[0]=B),B=1))}if(!B||(ut=ut[0],ur=ur[0],Vn&&(kt[0]!=ut||_n[0]!=ur)))return 3;gt!=null&&(gt[0]=kn,gt.offset=H-gt.w,t(4294967286>H-gt.w),t(gt.offset==gt.ha-ie));break}return Qt==0||Qt==7&&Vn&&gt==null?(rt!=null&&(rt[0]|=kn.na!=null&&0<kn.na.length),Ee!=null&&(Ee[0]=ut),Ye!=null&&(Ye[0]=ur),0):Qt}function zc(B,H,ie){var Ee=H.width,Ye=H.height,rt=0,ut=0,ht=Ee,gt=Ye;if(H.Da=B!=null&&0<B.Da,H.Da&&(ht=B.cd,gt=B.bd,rt=B.v,ut=B.j,11>ie||(rt&=-2,ut&=-2),0>rt||0>ut||0>=ht||0>=gt||rt+ht>Ee||ut+gt>Ye))return 0;if(H.v=rt,H.j=ut,H.va=rt+ht,H.o=ut+gt,H.U=ht,H.T=gt,H.da=B!=null&&0<B.da,H.da){if(!ot(ht,gt,ie=[B.ib],rt=[B.hb]))return 0;H.ib=ie[0],H.hb=rt[0]}return H.ob=B!=null&&B.ob,H.Kb=B==null||!B.Sd,H.da&&(H.ob=H.ib<3*Ee/4&&H.hb<3*Ye/4,H.Kb=0),1}function Ou(B){if(B==null)return 2;if(11>B.S){var H=B.f.RGBA;H.fb+=(B.height-1)*H.A,H.A=-H.A}else H=B.f.kb,B=B.height,H.O+=(B-1)*H.fa,H.fa=-H.fa,H.N+=(B-1>>1)*H.Ab,H.Ab=-H.Ab,H.W+=(B-1>>1)*H.Db,H.Db=-H.Db,H.F!=null&&(H.J+=(B-1)*H.lb,H.lb=-H.lb);return 0}function Ru(B,H,ie,Ee){if(Ee==null||0>=B||0>=H)return 2;if(ie!=null){if(ie.Da){var Ye=ie.cd,rt=ie.bd,ut=-2&ie.v,ht=-2&ie.j;if(0>ut||0>ht||0>=Ye||0>=rt||ut+Ye>B||ht+rt>H)return 2;B=Ye,H=rt}if(ie.da){if(!ot(B,H,Ye=[ie.ib],rt=[ie.hb]))return 2;B=Ye[0],H=rt[0]}}Ee.width=B,Ee.height=H;e:{var gt=Ee.width,kt=Ee.height;if(B=Ee.S,0>=gt||0>=kt||!(B>=$o&&13>B))B=2;else{if(0>=Ee.Rd&&Ee.sd==null){ut=rt=Ye=H=0;var _n=(ht=gt*Ih[B])*kt;if(11>B||(rt=(kt+1)/2*(H=(gt+1)/2),B==12&&(ut=(Ye=gt)*kt)),(kt=l(_n+2*rt+ut))==null){B=1;break e}Ee.sd=kt,11>B?((gt=Ee.f.RGBA).eb=kt,gt.fb=0,gt.A=ht,gt.size=_n):((gt=Ee.f.kb).y=kt,gt.O=0,gt.fa=ht,gt.Fd=_n,gt.f=kt,gt.N=0+_n,gt.Ab=H,gt.Cd=rt,gt.ea=kt,gt.W=0+_n+rt,gt.Db=H,gt.Ed=rt,B==12&&(gt.F=kt,gt.J=0+_n+2*rt),gt.Tc=ut,gt.lb=Ye)}if(H=1,Ye=Ee.S,rt=Ee.width,ut=Ee.height,Ye>=$o&&13>Ye)if(11>Ye)B=Ee.f.RGBA,H&=(ht=Math.abs(B.A))*(ut-1)+rt<=B.size,H&=ht>=rt*Ih[Ye],H&=B.eb!=null;else{B=Ee.f.kb,ht=(rt+1)/2,_n=(ut+1)/2,gt=Math.abs(B.fa),kt=Math.abs(B.Ab);var Vn=Math.abs(B.Db),Un=Math.abs(B.lb),kn=Un*(ut-1)+rt;H&=gt*(ut-1)+rt<=B.Fd,H&=kt*(_n-1)+ht<=B.Cd,H=(H&=Vn*(_n-1)+ht<=B.Ed)&gt>=rt&kt>=ht&Vn>=ht,H&=B.y!=null,H&=B.f!=null,H&=B.ea!=null,Ye==12&&(H&=Un>=rt,H&=kn<=B.Tc,H&=B.F!=null)}else H=0;B=H?0:2}}return B!=0||ie!=null&&ie.fd&&(B=Ou(Ee)),B}var _o=64,_l=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ha=24,Ta=32,gu=8,Xs=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];an("Predictor0","PredictorAdd0"),ue.Predictor0=function(){return 4278190080},ue.Predictor1=function(B){return B},ue.Predictor2=function(B,H,ie){return H[ie+0]},ue.Predictor3=function(B,H,ie){return H[ie+1]},ue.Predictor4=function(B,H,ie){return H[ie-1]},ue.Predictor5=function(B,H,ie){return vn(vn(B,H[ie+1]),H[ie+0])},ue.Predictor6=function(B,H,ie){return vn(B,H[ie-1])},ue.Predictor7=function(B,H,ie){return vn(B,H[ie+0])},ue.Predictor8=function(B,H,ie){return vn(H[ie-1],H[ie+0])},ue.Predictor9=function(B,H,ie){return vn(H[ie+0],H[ie+1])},ue.Predictor10=function(B,H,ie){return vn(vn(B,H[ie-1]),vn(H[ie+0],H[ie+1]))},ue.Predictor11=function(B,H,ie){var Ee=H[ie+0];return 0>=cr(Ee>>24&255,B>>24&255,(H=H[ie-1])>>24&255)+cr(Ee>>16&255,B>>16&255,H>>16&255)+cr(Ee>>8&255,B>>8&255,H>>8&255)+cr(255&Ee,255&B,255&H)?Ee:B},ue.Predictor12=function(B,H,ie){var Ee=H[ie+0];return(qn((B>>24&255)+(Ee>>24&255)-((H=H[ie-1])>>24&255))<<24|qn((B>>16&255)+(Ee>>16&255)-(H>>16&255))<<16|qn((B>>8&255)+(Ee>>8&255)-(H>>8&255))<<8|qn((255&B)+(255&Ee)-(255&H)))>>>0},ue.Predictor13=function(B,H,ie){var Ee=H[ie-1];return(Kn((B=vn(B,H[ie+0]))>>24&255,Ee>>24&255)<<24|Kn(B>>16&255,Ee>>16&255)<<16|Kn(B>>8&255,Ee>>8&255)<<8|Kn(B>>0&255,Ee>>0&255))>>>0};var zo=ue.PredictorAdd0;ue.PredictorAdd1=pr,an("Predictor2","PredictorAdd2"),an("Predictor3","PredictorAdd3"),an("Predictor4","PredictorAdd4"),an("Predictor5","PredictorAdd5"),an("Predictor6","PredictorAdd6"),an("Predictor7","PredictorAdd7"),an("Predictor8","PredictorAdd8"),an("Predictor9","PredictorAdd9"),an("Predictor10","PredictorAdd10"),an("Predictor11","PredictorAdd11"),an("Predictor12","PredictorAdd12"),an("Predictor13","PredictorAdd13");var ea=ue.PredictorAdd2;tn("ColorIndexInverseTransform","MapARGB","32b",function(B){return B>>8&255},function(B){return B}),tn("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(B){return B},function(B){return B>>8&255});var jc,Mo=ue.ColorIndexInverseTransform,jl=ue.MapARGB,mi=ue.VP8LColorIndexInverseTransformAlpha,jo=ue.MapAlpha,Bu=ue.VP8LPredictorsAdd=[];Bu.length=16,(ue.VP8LPredictors=[]).length=16,(ue.VP8LPredictorsAdd_C=[]).length=16,(ue.VP8LPredictors_C=[]).length=16;var Nu,da,ta,Ul,ol,na,Ln,nr,Fn,Hr,ii,xi,as,Cs,dc,ra,Ts,al,bl,Ga,ll,Vl,Ui,fa,Uo,bs,oi,io,Us=l(511),pa=l(2041),Vo=l(225),xl=l(767),ah=0,wl=pa,To=Vo,ks=xl,ho=Us,$o=0,vi=1,$l=2,yu=3,Ha=4,Go=5,Uc=6,Ho=7,Ao=8,Gl=9,p=10,T=[2,3,7],U=[3,3,11],se=[280,256,256,256,40],Pe=[0,1,1,1,0],nt=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Jt=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Dn=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Jn=8,ar=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Vr=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Jr=null,Vi=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],vo=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Js=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],so=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Ss=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],ma=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],lh=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Cl=[],Sl=[],qa=[],Xh=1,Aa=2,xs=[],ia=[];Xn("UpsampleRgbLinePair",Xi,3),Xn("UpsampleBgrLinePair",js,3),Xn("UpsampleRgbaLinePair",$a,4),Xn("UpsampleBgraLinePair",yo,4),Xn("UpsampleArgbLinePair",co,4),Xn("UpsampleRgba4444LinePair",_s,2),Xn("UpsampleRgb565LinePair",cs,2);var dt=ue.UpsampleRgbLinePair,ka=ue.UpsampleBgrLinePair,Vc=ue.UpsampleRgbaLinePair,qo=ue.UpsampleBgraLinePair,Ni=ue.UpsampleArgbLinePair,ec=ue.UpsampleRgba4444LinePair,Ll=ue.UpsampleRgb565LinePair,Ia=16,Wo=1<<Ia-1,Th=-227,Fu=482,fc=6,uh=0,Ah=l(256),Pc=l(256),jd=l(256),Jh=l(256),zu=l(Fu-Th),pc=l(Fu-Th);Qo("YuvToRgbRow",Xi,3),Qo("YuvToBgrRow",js,3),Qo("YuvToRgbaRow",$a,4),Qo("YuvToBgraRow",yo,4),Qo("YuvToArgbRow",co,4),Qo("YuvToRgba4444Row",_s,2),Qo("YuvToRgb565Row",cs,2);var Gr=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],vu=[0,2,8],wd=[8,7,6,4,4,2,2,2,1,1,1,1],kh=1;this.WebPDecodeRGBA=function(B,H,ie,Ee,Ye){var rt=vi,ut=new Po,ht=new Gt;ut.ba=ht,ht.S=rt,ht.width=[ht.width],ht.height=[ht.height];var gt=ht.width,kt=ht.height,_n=new hn;if(_n==null||B==null)var Vn=2;else t(_n!=null),Vn=sl(B,H,ie,_n.width,_n.height,_n.Pd,_n.Qd,_n.format,null);if(Vn!=0?gt=0:(gt!=null&&(gt[0]=_n.width[0]),kt!=null&&(kt[0]=_n.height[0]),gt=1),gt){ht.width=ht.width[0],ht.height=ht.height[0],Ee!=null&&(Ee[0]=ht.width),Ye!=null&&(Ye[0]=ht.height);e:{if(Ee=new ja,(Ye=new Fl).data=B,Ye.w=H,Ye.ha=ie,Ye.kd=1,H=[0],t(Ye!=null),((B=sl(Ye.data,Ye.w,Ye.ha,null,null,null,H,null,Ye))==0||B==7)&&H[0]&&(B=4),(H=B)==0){if(t(ut!=null),Ee.data=Ye.data,Ee.w=Ye.w+Ye.offset,Ee.ha=Ye.ha-Ye.offset,Ee.put=Lr,Ee.ac=Qn,Ee.bc=Yt,Ee.ma=ut,Ye.xa){if((B=Pr())==null){ut=1;break e}if(function(Un,kn){var ur=[0],Zn=[0],Qt=[0];t:for(;;){if(Un==null)return 0;if(kn==null)return Un.a=2,0;if(Un.l=kn,Un.a=0,Le(Un.m,kn.data,kn.w,kn.ha),!vt(Un.m,ur,Zn,Qt)){Un.a=3;break t}if(Un.xb=Aa,kn.width=ur[0],kn.height=Zn[0],!As(ur[0],Zn[0],1,Un,null))break t;return 1}return t(Un.a!=0),0}(B,Ee)){if(Ee=(H=Ru(Ee.width,Ee.height,ut.Oa,ut.ba))==0){t:{Ee=B;n:for(;;){if(Ee==null){Ee=0;break t}if(t(Ee.s.yc!=null),t(Ee.s.Ya!=null),t(0<Ee.s.Wb),t((ie=Ee.l)!=null),t((Ye=ie.ma)!=null),Ee.xb!=0){if(Ee.ca=Ye.ba,Ee.tb=Ye.tb,t(Ee.ca!=null),!zc(Ye.Oa,ie,yu)){Ee.a=2;break n}if(!$i(Ee,ie.width)||ie.da)break n;if((ie.da||et(Ee.ca.S))&&An(),11>Ee.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),Ee.ca.f.kb.F!=null&&An()),Ee.Pb&&0<Ee.s.ua&&Ee.s.vb.X==null&&!Ae(Ee.s.vb,Ee.s.Wa.Xa)){Ee.a=1;break n}Ee.xb=0}if(!ri(Ee,Ee.V,Ee.Ba,Ee.c,Ee.i,ie.o,Ut))break n;Ye.Dc=Ee.Ma,Ee=1;break t}t(Ee.a!=0),Ee=0}Ee=!Ee}Ee&&(H=B.a)}else H=B.a}else{if((B=new ds)==null){ut=1;break e}if(B.Fa=Ye.na,B.P=Ye.P,B.qc=Ye.Sa,lu(B,Ee)){if((H=Ru(Ee.width,Ee.height,ut.Oa,ut.ba))==0){if(B.Aa=0,ie=ut.Oa,t((Ye=B)!=null),ie!=null){if(0<(gt=0>(gt=ie.Md)?0:100<gt?255:255*gt/100)){for(kt=_n=0;4>kt;++kt)12>(Vn=Ye.pb[kt]).lc&&(Vn.ia=gt*wd[0>Vn.lc?0:Vn.lc]>>3),_n|=Vn.ia;_n&&(alert("todo:VP8InitRandom"),Ye.ia=1)}Ye.Ga=ie.Id,100<Ye.Ga?Ye.Ga=100:0>Ye.Ga&&(Ye.Ga=0)}ki(B,Ee)||(H=B.a)}}else H=B.a}H==0&&ut.Oa!=null&&ut.Oa.fd&&(H=Ou(ut.ba))}ut=H}rt=ut!=0?null:11>rt?ht.f.RGBA.eb:ht.f.kb.y}else rt=null;return rt};var Ih=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function m(ue,_e){for(var We="",he=0;he<4;he++)We+=String.fromCharCode(ue[_e++]);return We}function _(ue,_e){return(ue[_e+0]<<0|ue[_e+1]<<8|ue[_e+2]<<16)>>>0}function w(ue,_e){return(ue[_e+0]<<0|ue[_e+1]<<8|ue[_e+2]<<16|ue[_e+3]<<24)>>>0}new f;var M=[0],C=[0],R=[],z=new f,W=e,X=function(ue,_e){var We={},he=0,de=!1,Te=0,be=0;if(We.frames=[],!function(Ie,Ne,Ve,it){for(var lt=0;lt<it;lt++)if(Ie[Ne+lt]!=Ve.charCodeAt(lt))return!0;return!1}(ue,_e,"RIFF",4)){var ae,ne;for(w(ue,_e+=4),_e+=8;_e<ue.length;){var Se=m(ue,_e),Le=w(ue,_e+=4);_e+=4;var ze=Le+(1&Le);switch(Se){case"VP8 ":case"VP8L":We.frames[he]===void 0&&(We.frames[he]={}),(ge=We.frames[he]).src_off=de?be:_e-8,ge.src_size=Te+Le+8,he++,de&&(de=!1,Te=0,be=0);break;case"VP8X":(ge=We.header={}).feature_flags=ue[_e];var He=_e+4;ge.canvas_width=1+_(ue,He),He+=3,ge.canvas_height=1+_(ue,He),He+=3;break;case"ALPH":de=!0,Te=ze+8,be=_e-8;break;case"ANIM":(ge=We.header).bgcolor=w(ue,_e),He=_e+4,ge.loop_count=(ae=ue)[(ne=He)+0]<<0|ae[ne+1]<<8,He+=2;break;case"ANMF":var pt,ge;(ge=We.frames[he]={}).offset_x=2*_(ue,_e),_e+=3,ge.offset_y=2*_(ue,_e),_e+=3,ge.width=1+_(ue,_e),_e+=3,ge.height=1+_(ue,_e),_e+=3,ge.duration=_(ue,_e),_e+=3,pt=ue[_e++],ge.dispose=1&pt,ge.blend=pt>>1&1}Se!="ANMF"&&(_e+=ze)}return We}}(W,0);X.response=W,X.rgbaoutput=!0,X.dataurl=!1;var Y=X.header?X.header:null,Q=X.frames?X.frames:null;if(Y){Y.loop_counter=Y.loop_count,M=[Y.canvas_height],C=[Y.canvas_width];for(var oe=0;oe<Q.length&&Q[oe].blend!=0;oe++);}var le=Q[0],me=z.WebPDecodeRGBA(W,le.src_off,le.src_size,C,M);le.rgba=me,le.imgwidth=C[0],le.imgheight=M[0];for(var we=0;we<C[0]*M[0]*4;we++)R[we]=me[we];return this.width=C,this.height=M,this.data=R,this}(function(e){var t=function(){return typeof i3=="function"},n=function(M,C,R,z){var W=4,X=a;switch(z){case e.image_compression.FAST:W=1,X=l;break;case e.image_compression.MEDIUM:W=6,X=o;break;case e.image_compression.SLOW:W=9,X=f}M=r(M,C,R,X);var Y=i3(M,{level:W});return e.__addimage__.arrayBufferToBinaryString(Y)},r=function(M,C,R,z){for(var W,X,Y,Q=M.length/C,oe=new Uint8Array(M.length+Q),le=_(),me=0;me<Q;me+=1){if(Y=me*C,W=M.subarray(Y,Y+C),z)oe.set(z(W,R,X),Y+me);else{for(var we,ue=le.length,_e=[];we<ue;we+=1)_e[we]=le[we](W,R,X);var We=w(_e.concat());oe.set(_e[We],Y+me)}X=W}return oe},i=function(M){var C=Array.apply([],M);return C.unshift(0),C},l=function(M,C){var R,z=[],W=M.length;z[0]=1;for(var X=0;X<W;X+=1)R=M[X-C]||0,z[X+1]=M[X]-R+256&255;return z},a=function(M,C,R){var z,W=[],X=M.length;W[0]=2;for(var Y=0;Y<X;Y+=1)z=R&&R[Y]||0,W[Y+1]=M[Y]-z+256&255;return W},o=function(M,C,R){var z,W,X=[],Y=M.length;X[0]=3;for(var Q=0;Q<Y;Q+=1)z=M[Q-C]||0,W=R&&R[Q]||0,X[Q+1]=M[Q]+256-(z+W>>>1)&255;return X},f=function(M,C,R){var z,W,X,Y,Q=[],oe=M.length;Q[0]=4;for(var le=0;le<oe;le+=1)z=M[le-C]||0,W=R&&R[le]||0,X=R&&R[le-C]||0,Y=m(z,W,X),Q[le+1]=M[le]-Y+256&255;return Q},m=function(M,C,R){if(M===C&&C===R)return M;var z=Math.abs(C-R),W=Math.abs(M-R),X=Math.abs(M+C-R-R);return z<=W&&z<=X?M:W<=X?C:R},_=function(){return[i,l,a,o,f]},w=function(M){var C=M.map(function(R){return R.reduce(function(z,W){return z+Math.abs(W)},0)});return C.indexOf(Math.min.apply(null,C))};e.processPNG=function(M,C,R,z){var W,X,Y,Q,oe,le,me,we,ue,_e,We,he,de,Te,be,ae=this.decode.FLATE_DECODE,ne="";if(this.__addimage__.isArrayBuffer(M)&&(M=new Uint8Array(M)),this.__addimage__.isArrayBufferView(M)){if(M=(Y=new _G(M)).imgData,X=Y.bits,W=Y.colorSpace,oe=Y.colors,[4,6].indexOf(Y.colorType)!==-1){if(Y.bits===8){ue=(we=Y.pixelBitlength==32?new Uint32Array(Y.decodePixels().buffer):Y.pixelBitlength==16?new Uint16Array(Y.decodePixels().buffer):new Uint8Array(Y.decodePixels().buffer)).length,We=new Uint8Array(ue*Y.colors),_e=new Uint8Array(ue);var Se,Le=Y.pixelBitlength-Y.bits;for(Te=0,be=0;Te<ue;Te++){for(de=we[Te],Se=0;Se<Le;)We[be++]=de>>>Se&255,Se+=Y.bits;_e[Te]=de>>>Se&255}}if(Y.bits===16){ue=(we=new Uint32Array(Y.decodePixels().buffer)).length,We=new Uint8Array(ue*(32/Y.pixelBitlength)*Y.colors),_e=new Uint8Array(ue*(32/Y.pixelBitlength)),he=Y.colors>1,Te=0,be=0;for(var ze=0;Te<ue;)de=we[Te++],We[be++]=de>>>0&255,he&&(We[be++]=de>>>16&255,de=we[Te++],We[be++]=de>>>0&255),_e[ze++]=de>>>16&255;X=8}z!==e.image_compression.NONE&&t()?(M=n(We,Y.width*Y.colors,Y.colors,z),me=n(_e,Y.width,1,z)):(M=We,me=_e,ae=void 0)}if(Y.colorType===3&&(W=this.color_spaces.INDEXED,le=Y.palette,Y.transparency.indexed)){var He=Y.transparency.indexed,pt=0;for(Te=0,ue=He.length;Te<ue;++Te)pt+=He[Te];if((pt/=255)===ue-1&&He.indexOf(0)!==-1)Q=[He.indexOf(0)];else if(pt!==ue){for(we=Y.decodePixels(),_e=new Uint8Array(we.length),Te=0,ue=we.length;Te<ue;Te++)_e[Te]=He[we[Te]];me=n(_e,Y.width,1)}}var ge=function(Ie){var Ne;switch(Ie){case e.image_compression.FAST:Ne=11;break;case e.image_compression.MEDIUM:Ne=13;break;case e.image_compression.SLOW:Ne=14;break;default:Ne=12}return Ne}(z);return ae===this.decode.FLATE_DECODE&&(ne="/Predictor "+ge+" "),ne+="/Colors "+oe+" /BitsPerComponent "+X+" /Columns "+Y.width,(this.__addimage__.isArrayBuffer(M)||this.__addimage__.isArrayBufferView(M))&&(M=this.__addimage__.arrayBufferToBinaryString(M)),(me&&this.__addimage__.isArrayBuffer(me)||this.__addimage__.isArrayBufferView(me))&&(me=this.__addimage__.arrayBufferToBinaryString(me)),{alias:R,data:M,index:C,filter:ae,decodeParameters:ne,transparency:Q,palette:le,sMask:me,predictor:ge,width:Y.width,height:Y.height,bitsPerComponent:X,colorSpace:W}}}})(es.API),function(e){e.processGIF89A=function(t,n,r,i){var l=new bG(t),a=l.width,o=l.height,f=[];l.decodeAndBlitFrameRGBA(0,f);var m={data:f,width:a,height:o},_=new q5(100).encode(m,100);return e.processJPEG.call(this,_,n,r,i)},e.processGIF87A=e.processGIF89A}(es.API),Kd.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:i,green:r,blue:n,quad:l}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Kd.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(n){xa.log("bit decode error:"+n)}},Kd.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),n=t%4;for(e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,i=0;i<t;i++)for(var l=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+8*i*4,o=0;o<8&&8*i+o<this.width;o++){var f=this.palette[l>>7-o&1];this.data[a+4*o]=f.blue,this.data[a+4*o+1]=f.green,this.data[a+4*o+2]=f.red,this.data[a+4*o+3]=255}n!==0&&(this.pos+=4-n)}},Kd.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<e;i++){var l=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+2*i*4,o=l>>4,f=15&l,m=this.palette[o];if(this.data[a]=m.blue,this.data[a+1]=m.green,this.data[a+2]=m.red,this.data[a+3]=255,2*i+1>=this.width)break;m=this.palette[f],this.data[a+4]=m.blue,this.data[a+4+1]=m.green,this.data[a+4+2]=m.red,this.data[a+4+3]=255}t!==0&&(this.pos+=4-t)}},Kd.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var i=this.datav.getUint8(this.pos++,!0),l=n*this.width*4+4*r;if(i<this.palette.length){var a=this.palette[i];this.data[l]=a.red,this.data[l+1]=a.green,this.data[l+2]=a.blue,this.data[l+3]=255}else this.data[l]=255,this.data[l+1]=255,this.data[l+2]=255,this.data[l+3]=255}e!==0&&(this.pos+=4-e)}},Kd.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(l&t)/t*255|0,o=(l>>5&t)/t*255|0,f=(l>>10&t)/t*255|0,m=l>>15?255:0,_=r*this.width*4+4*i;this.data[_]=f,this.data[_+1]=o,this.data[_+2]=a,this.data[_+3]=m}this.pos+=e}},Kd.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),n=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,l=0;l<this.width;l++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&t)/t*255|0,f=(a>>5&n)/n*255|0,m=(a>>11)/t*255|0,_=i*this.width*4+4*l;this.data[_]=m,this.data[_+1]=f,this.data[_+2]=o,this.data[_+3]=255}this.pos+=e}},Kd.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),a=t*this.width*4+4*n;this.data[a]=l,this.data[a+1]=i,this.data[a+2]=r,this.data[a+3]=255}this.pos+=this.width%4}},Kd.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*n;this.data[o]=l,this.data[o+1]=i,this.data[o+2]=r,this.data[o+3]=a}},Kd.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,n,r,i){var l=new Kd(t,!1),a=l.width,o=l.height,f={data:l.getData(),width:a,height:o},m=new q5(100).encode(f,100);return e.processJPEG.call(this,m,n,r,i)}}(es.API),wP.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,n,r,i){var l=new wP(t),a=l.width,o=l.height,f={data:l.getData(),width:a,height:o},m=new q5(100).encode(f,100);return e.processJPEG.call(this,m,n,r,i)}}(es.API),es.API.processRGBA=function(e,t,n){for(var r=e.data,i=r.length,l=new Uint8Array(i/4*3),a=new Uint8Array(i/4),o=0,f=0,m=0;m<i;m+=4){var _=r[m],w=r[m+1],M=r[m+2],C=r[m+3];l[o++]=_,l[o++]=w,l[o++]=M,a[f++]=C}var R=this.__addimage__.arrayBufferToBinaryString(l);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:R,index:t,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},es.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},h0=es.API,Sb=h0.getCharWidthsArray=function(e,t){var n,r,i=(t=t||{}).font||this.internal.getFont(),l=t.fontSize||this.internal.getFontSize(),a=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:i.metadata.Unicode.widths,f=o.fof?o.fof:1,m=t.kerning?t.kerning:i.metadata.Unicode.kerning,_=m.fof?m.fof:1,w=t.doKerning!==!1,M=0,C=e.length,R=0,z=o[0]||f,W=[];for(n=0;n<C;n++)r=e.charCodeAt(n),typeof i.metadata.widthOfString=="function"?W.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(r))+a*(1e3/l)||0)/1e3):(M=w&&Xo(m[r])==="object"&&!isNaN(parseInt(m[r][R],10))?m[r][R]/_:0,W.push((o[r]||z)/f+M)),R=r;return W},vP=h0.getStringUnitWidth=function(e,t){var n=(t=t||{}).fontSize||this.internal.getFontSize(),r=t.font||this.internal.getFont(),i=t.charSpace||this.internal.getCharSpace();return h0.processArabic&&(e=h0.processArabic(e)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(e,n,i)/n:Sb.apply(this,arguments).reduce(function(l,a){return l+a},0)},_P=function(e,t,n,r){for(var i=[],l=0,a=e.length,o=0;l!==a&&o+t[l]<n;)o+=t[l],l++;i.push(e.slice(0,l));var f=l;for(o=0;l!==a;)o+t[l]>r&&(i.push(e.slice(f,l)),o=0,f=l),o+=t[l],l++;return f!==l&&i.push(e.slice(f,l)),i},bP=function(e,t,n){n||(n={});var r,i,l,a,o,f,m,_=[],w=[_],M=n.textIndent||0,C=0,R=0,z=e.split(" "),W=Sb.apply(this,[" ",n])[0];if(f=n.lineIndent===-1?z[0].length+2:n.lineIndent||0){var X=Array(f).join(" "),Y=[];z.map(function(oe){(oe=oe.split(/\s*\n/)).length>1?Y=Y.concat(oe.map(function(le,me){return(me&&le.length?`
`:"")+le})):Y.push(oe[0])}),z=Y,f=vP.apply(this,[X,n])}for(l=0,a=z.length;l<a;l++){var Q=0;if(r=z[l],f&&r[0]==`
`&&(r=r.substr(1),Q=1),M+C+(R=(i=Sb.apply(this,[r,n])).reduce(function(oe,le){return oe+le},0))>t||Q){if(R>t){for(o=_P.apply(this,[r,i,t-(M+C),t]),_.push(o.shift()),_=[o.pop()];o.length;)w.push([o.shift()]);R=i.slice(r.length-(_[0]?_[0].length:0)).reduce(function(oe,le){return oe+le},0)}else _=[r];w.push(_),M=R+f,C=W}else _.push(r),M+=C+R,C=W}return m=f?function(oe,le){return(le?X:"")+oe.join(" ")}:function(oe){return oe.join(" ")},w.map(m)},h0.splitTextToSize=function(e,t,n){var r,i=(n=n||{}).fontSize||this.internal.getFontSize(),l=(function(_){if(_.widths&&_.kerning)return{widths:_.widths,kerning:_.kerning};var w=this.internal.getFont(_.fontName,_.fontStyle);return w.metadata.Unicode?{widths:w.metadata.Unicode.widths||{0:1},kerning:w.metadata.Unicode.kerning||{}}:{font:w.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);r=Array.isArray(e)?e:String(e).split(/\r?\n/);var a=1*this.internal.scaleFactor*t/i;l.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/i:0,l.lineIndent=n.lineIndent;var o,f,m=[];for(o=0,f=r.length;o<f;o++)m=m.concat(bP.apply(this,[r[o],a,l]));return m},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",n={},r={},i=0;i<t.length;i++)n[t[i]]="0123456789abcdef"[i],r["0123456789abcdef"[i]]=t[i];var l=function(w){return"0x"+parseInt(w,10).toString(16)},a=e.__fontmetrics__.compress=function(w){var M,C,R,z,W=["{"];for(var X in w){if(M=w[X],isNaN(parseInt(X,10))?C="'"+X+"'":(X=parseInt(X,10),C=(C=l(X).slice(2)).slice(0,-1)+r[C.slice(-1)]),typeof M=="number")M<0?(R=l(M).slice(3),z="-"):(R=l(M).slice(2),z=""),R=z+R.slice(0,-1)+r[R.slice(-1)];else{if(Xo(M)!=="object")throw new Error("Don't know what to do with value type "+Xo(M)+".");R=a(M)}W.push(C+R)}return W.push("}"),W.join("")},o=e.__fontmetrics__.uncompress=function(w){if(typeof w!="string")throw new Error("Invalid argument passed to uncompress.");for(var M,C,R,z,W={},X=1,Y=W,Q=[],oe="",le="",me=w.length-1,we=1;we<me;we+=1)(z=w[we])=="'"?M?(R=M.join(""),M=void 0):M=[]:M?M.push(z):z=="{"?(Q.push([Y,R]),Y={},R=void 0):z=="}"?((C=Q.pop())[0][C[1]]=Y,R=void 0,Y=C[0]):z=="-"?X=-1:R===void 0?n.hasOwnProperty(z)?(oe+=n[z],R=parseInt(oe,16)*X,X=1,oe=""):oe+=z:n.hasOwnProperty(z)?(le+=n[z],Y[R]=parseInt(le,16)*X,X=1,R=void 0,le=""):le+=z;return W},f={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},m={Unicode:{Courier:f,"Courier-Bold":f,"Courier-BoldOblique":f,"Courier-Oblique":f,Helvetica:f,"Helvetica-Bold":f,"Helvetica-BoldOblique":f,"Helvetica-Oblique":f,"Times-Roman":f,"Times-Bold":f,"Times-BoldItalic":f,"Times-Italic":f}},_={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(w){var M=w.font,C=_.Unicode[M.postScriptName];C&&(M.metadata.Unicode={},M.metadata.Unicode.widths=C.widths,M.metadata.Unicode.kerning=C.kerning);var R=m.Unicode[M.postScriptName];R&&(M.metadata.Unicode.encoding=R,M.encoding=R.codePages[0])}])}(es.API),function(e){var t=function(n){for(var r=n.length,i=new Uint8Array(r),l=0;l<r;l++)i[l]=n.charCodeAt(l);return i};e.API.events.push(["addFont",function(n){var r=void 0,i=n.font,l=n.instance;if(!i.isStandardFont){if(l===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(r=l.existsFileInVFS(i.postScriptName)===!1?l.loadFile(i.postScriptName):l.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(a,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(Kv(o)),a.metadata=e.API.TTFFont.open(o),a.metadata.Unicode=a.metadata.Unicode||{encoding:{},kerning:{},widths:[]},a.metadata.glyIdsUsed=[0]})(i,r)}}])}(es),function(e){function t(){return(ts.canvg?Promise.resolve(ts.canvg):Dd(()=>import("./index.es.js"),[])).catch(function(n){return Promise.reject(new Error("Could not load canvg: "+n))}).then(function(n){return n.default?n.default:n})}es.API.addSvgAsImage=function(n,r,i,l,a,o,f,m){if(isNaN(r)||isNaN(i))throw xa.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(l)||isNaN(a))throw xa.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var _=document.createElement("canvas");_.width=l,_.height=a;var w=_.getContext("2d");w.fillStyle="#fff",w.fillRect(0,0,_.width,_.height);var M={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},C=this;return t().then(function(R){return R.fromString(w,n,M)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(R){return R.render(M)}).then(function(){C.addImage(_.toDataURL("image/jpeg",1),r,i,l,a,f,m)})}}(),es.API.putTotalPages=function(e){var t,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),n=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var i=0;i<this.internal.pages[r].length;i++)this.internal.pages[r][i]=this.internal.pages[r][i].replace(t,n);return this},es.API.viewerPreferences=function(e,t){var n;e=e||{},t=t||!1;var r,i,l,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(a),f=[],m=0,_=0,w=0;function M(R,z){var W,X=!1;for(W=0;W<R.length;W+=1)R[W]===z&&(X=!0);return X}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var C=o.length;for(w=0;w<C;w+=1)n[o[w]].value=n[o[w]].defaultValue,n[o[w]].explicitSet=!1}if(Xo(e)==="object"){for(i in e)if(l=e[i],M(o,i)&&l!==void 0){if(n[i].type==="boolean"&&typeof l=="boolean")n[i].value=l;else if(n[i].type==="name"&&M(n[i].valueSet,l))n[i].value=l;else if(n[i].type==="integer"&&Number.isInteger(l))n[i].value=l;else if(n[i].type==="array"){for(m=0;m<l.length;m+=1)if(r=!0,l[m].length===1&&typeof l[m][0]=="number")f.push(String(l[m]-1));else if(l[m].length>1){for(_=0;_<l[m].length;_+=1)typeof l[m][_]!="number"&&(r=!1);r===!0&&f.push([l[m][0]-1,l[m][1]-1].join(" "))}n[i].value="["+f.join(" ")+"]"}else n[i].value=n[i].defaultValue;n[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var R,z=[];for(R in n)n[R].explicitSet===!0&&(n[R].type==="name"?z.push("/"+R+" /"+n[R].value):z.push("/"+R+" "+n[R].value));z.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+z.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(e){var t=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),l=unescape(encodeURIComponent(r)),a=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),f=unescape(encodeURIComponent("</x:xmpmeta>")),m=l.length+a.length+o.length+i.length+f.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+m+" >>"),this.internal.write("stream"),this.internal.write(i+l+a+o+f),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(r,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",t)),this}}(es.API),function(e){var t=e.API,n=t.pdfEscape16=function(l,a){for(var o,f=a.metadata.Unicode.widths,m=["","0","00","000","0000"],_=[""],w=0,M=l.length;w<M;++w){if(o=a.metadata.characterToGlyph(l.charCodeAt(w)),a.metadata.glyIdsUsed.push(o),a.metadata.toUnicode[o]=l.charCodeAt(w),f.indexOf(o)==-1&&(f.push(o),f.push([parseInt(a.metadata.widthOfGlyph(o),10)])),o=="0")return _.join("");o=o.toString(16),_.push(m[4-o.length],o)}return _.join("")},r=function(l){var a,o,f,m,_,w,M;for(_=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,f=[],w=0,M=(o=Object.keys(l).sort(function(C,R){return C-R})).length;w<M;w++)a=o[w],f.length>=100&&(_+=`
`+f.length+` beginbfchar
`+f.join(`
`)+`
endbfchar`,f=[]),l[a]!==void 0&&l[a]!==null&&typeof l[a].toString=="function"&&(m=("0000"+l[a].toString(16)).slice(-4),a=("0000"+(+a).toString(16)).slice(-4),f.push("<"+a+"><"+m+">"));return f.length&&(_+=`
`+f.length+` beginbfchar
`+f.join(`
`)+`
endbfchar
`),_+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(l){(function(a){var o=a.font,f=a.out,m=a.newObject,_=a.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="Identity-H"){for(var w=o.metadata.Unicode.widths,M=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),C="",R=0;R<M.length;R++)C+=String.fromCharCode(M[R]);var z=m();_({data:C,addLength1:!0,objectId:z}),f("endobj");var W=m();_({data:r(o.metadata.toUnicode),addLength1:!0,objectId:W}),f("endobj");var X=m();f("<<"),f("/Type /FontDescriptor"),f("/FontName /"+C0(o.fontName)),f("/FontFile2 "+z+" 0 R"),f("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),f("/Flags "+o.metadata.flags),f("/StemV "+o.metadata.stemV),f("/ItalicAngle "+o.metadata.italicAngle),f("/Ascent "+o.metadata.ascender),f("/Descent "+o.metadata.decender),f("/CapHeight "+o.metadata.capHeight),f(">>"),f("endobj");var Y=m();f("<<"),f("/Type /Font"),f("/BaseFont /"+C0(o.fontName)),f("/FontDescriptor "+X+" 0 R"),f("/W "+e.API.PDFObject.convert(w)),f("/CIDToGIDMap /Identity"),f("/DW 1000"),f("/Subtype /CIDFontType2"),f("/CIDSystemInfo"),f("<<"),f("/Supplement 0"),f("/Registry (Adobe)"),f("/Ordering ("+o.encoding+")"),f(">>"),f(">>"),f("endobj"),o.objectNumber=m(),f("<<"),f("/Type /Font"),f("/Subtype /Type0"),f("/ToUnicode "+W+" 0 R"),f("/BaseFont /"+C0(o.fontName)),f("/Encoding /"+o.encoding),f("/DescendantFonts ["+Y+" 0 R]"),f(">>"),f("endobj"),o.isAlreadyPutted=!0}})(l)}]),t.events.push(["putFont",function(l){(function(a){var o=a.font,f=a.out,m=a.newObject,_=a.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var w=o.metadata.rawData,M="",C=0;C<w.length;C++)M+=String.fromCharCode(w[C]);var R=m();_({data:M,addLength1:!0,objectId:R}),f("endobj");var z=m();_({data:r(o.metadata.toUnicode),addLength1:!0,objectId:z}),f("endobj");var W=m();f("<<"),f("/Descent "+o.metadata.decender),f("/CapHeight "+o.metadata.capHeight),f("/StemV "+o.metadata.stemV),f("/Type /FontDescriptor"),f("/FontFile2 "+R+" 0 R"),f("/Flags 96"),f("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),f("/FontName /"+C0(o.fontName)),f("/ItalicAngle "+o.metadata.italicAngle),f("/Ascent "+o.metadata.ascender),f(">>"),f("endobj"),o.objectNumber=m();for(var X=0;X<o.metadata.hmtx.widths.length;X++)o.metadata.hmtx.widths[X]=parseInt(o.metadata.hmtx.widths[X]*(1e3/o.metadata.head.unitsPerEm));f("<</Subtype/TrueType/Type/Font/ToUnicode "+z+" 0 R/BaseFont/"+C0(o.fontName)+"/FontDescriptor "+W+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),f("endobj"),o.isAlreadyPutted=!0}})(l)}]);var i=function(l){var a,o=l.text||"",f=l.x,m=l.y,_=l.options||{},w=l.mutex||{},M=w.pdfEscape,C=w.activeFontKey,R=w.fonts,z=C,W="",X=0,Y="",Q=R[z].encoding;if(R[z].encoding!=="Identity-H")return{text:o,x:f,y:m,options:_,mutex:w};for(Y=o,z=C,Array.isArray(o)&&(Y=o[0]),X=0;X<Y.length;X+=1)R[z].metadata.hasOwnProperty("cmap")&&(a=R[z].metadata.cmap.unicode.codeMap[Y[X].charCodeAt(0)]),a||Y[X].charCodeAt(0)<256&&R[z].metadata.hasOwnProperty("Unicode")?W+=Y[X]:W+="";var oe="";return parseInt(z.slice(1))<14||Q==="WinAnsiEncoding"?oe=M(W,z).split("").map(function(le){return le.charCodeAt(0).toString(16)}).join(""):Q==="Identity-H"&&(oe=n(W,R[z])),w.isHex=!0,{text:oe,x:f,y:m,options:_,mutex:w}};t.events.push(["postProcessText",function(l){var a=l.text||"",o=[],f={text:a,x:l.x,y:l.y,options:l.options,mutex:l.mutex};if(Array.isArray(a)){var m=0;for(m=0;m<a.length;m+=1)Array.isArray(a[m])&&a[m].length===3?o.push([i(Object.assign({},f,{text:a[m][0]})).text,a[m][1],a[m][2]]):o.push(i(Object.assign({},f,{text:a[m]})).text);l.text=o}else l.text=i(Object.assign({},f,{text:a})).text}])}(es),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(n){return t.call(this),this.internal.vFS[n]!==void 0},e.addFileToVFS=function(n,r){return t.call(this),this.internal.vFS[n]=r,this},e.getFileFromVFS=function(n){return t.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}}(es.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(r){var i,l,a,o,f,m,_,w=t,M=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],C=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],R={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},z={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},W=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],X=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),Y=!1,Q=0;this.__bidiEngine__={};var oe=function(he){var de=he.charCodeAt(),Te=de>>8,be=z[Te];return be!==void 0?w[256*be+(255&de)]:Te===252||Te===253?"AL":X.test(Te)?"L":Te===8?"R":"N"},le=function(he){for(var de,Te=0;Te<he.length;Te++){if((de=oe(he.charAt(Te)))==="L")return!1;if(de==="R")return!0}return!1},me=function(he,de,Te,be){var ae,ne,Se,Le,ze=de[be];switch(ze){case"L":case"R":Y=!1;break;case"N":case"AN":break;case"EN":Y&&(ze="AN");break;case"AL":Y=!0,ze="R";break;case"WS":ze="N";break;case"CS":be<1||be+1>=de.length||(ae=Te[be-1])!=="EN"&&ae!=="AN"||(ne=de[be+1])!=="EN"&&ne!=="AN"?ze="N":Y&&(ne="AN"),ze=ne===ae?ne:"N";break;case"ES":ze=(ae=be>0?Te[be-1]:"B")==="EN"&&be+1<de.length&&de[be+1]==="EN"?"EN":"N";break;case"ET":if(be>0&&Te[be-1]==="EN"){ze="EN";break}if(Y){ze="N";break}for(Se=be+1,Le=de.length;Se<Le&&de[Se]==="ET";)Se++;ze=Se<Le&&de[Se]==="EN"?"EN":"N";break;case"NSM":if(a&&!o){for(Le=de.length,Se=be+1;Se<Le&&de[Se]==="NSM";)Se++;if(Se<Le){var He=he[be],pt=He>=1425&&He<=2303||He===64286;if(ae=de[Se],pt&&(ae==="R"||ae==="AL")){ze="R";break}}}ze=be<1||(ae=de[be-1])==="B"?"N":Te[be-1];break;case"B":Y=!1,i=!0,ze=Q;break;case"S":l=!0,ze="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":Y=!1;break;case"BN":ze="N"}return ze},we=function(he,de,Te){var be=he.split("");return Te&&ue(be,Te,{hiLevel:Q}),be.reverse(),de&&de.reverse(),be.join("")},ue=function(he,de,Te){var be,ae,ne,Se,Le,ze=-1,He=he.length,pt=0,ge=[],Ie=Q?C:M,Ne=[];for(Y=!1,i=!1,l=!1,ae=0;ae<He;ae++)Ne[ae]=oe(he[ae]);for(ne=0;ne<He;ne++){if(Le=pt,ge[ne]=me(he,Ne,ge,ne),be=240&(pt=Ie[Le][R[ge[ne]]]),pt&=15,de[ne]=Se=Ie[pt][5],be>0)if(be===16){for(ae=ze;ae<ne;ae++)de[ae]=1;ze=-1}else ze=-1;if(Ie[pt][6])ze===-1&&(ze=ne);else if(ze>-1){for(ae=ze;ae<ne;ae++)de[ae]=Se;ze=-1}Ne[ne]==="B"&&(de[ne]=0),Te.hiLevel|=Se}l&&function(Ve,it,lt){for(var Mt=0;Mt<lt;Mt++)if(Ve[Mt]==="S"){it[Mt]=Q;for(var wt=Mt-1;wt>=0&&Ve[wt]==="WS";wt--)it[wt]=Q}}(Ne,de,He)},_e=function(he,de,Te,be,ae){if(!(ae.hiLevel<he)){if(he===1&&Q===1&&!i)return de.reverse(),void(Te&&Te.reverse());for(var ne,Se,Le,ze,He=de.length,pt=0;pt<He;){if(be[pt]>=he){for(Le=pt+1;Le<He&&be[Le]>=he;)Le++;for(ze=pt,Se=Le-1;ze<Se;ze++,Se--)ne=de[ze],de[ze]=de[Se],de[Se]=ne,Te&&(ne=Te[ze],Te[ze]=Te[Se],Te[Se]=ne);pt=Le}pt++}}},We=function(he,de,Te){var be=he.split(""),ae={hiLevel:Q};return Te||(Te=[]),ue(be,Te,ae),function(ne,Se,Le){if(Le.hiLevel!==0&&_)for(var ze,He=0;He<ne.length;He++)Se[He]===1&&(ze=W.indexOf(ne[He]))>=0&&(ne[He]=W[ze+1])}(be,Te,ae),_e(2,be,de,Te,ae),_e(1,be,de,Te,ae),be.join("")};return this.__bidiEngine__.doBidiReorder=function(he,de,Te){if(function(ae,ne){if(ne)for(var Se=0;Se<ae.length;Se++)ne[Se]=Se;o===void 0&&(o=le(ae)),m===void 0&&(m=le(ae))}(he,de),a||!f||m)if(a&&f&&o^m)Q=o?1:0,he=we(he,de,Te);else if(!a&&f&&m)Q=o?1:0,he=We(he,de,Te),he=we(he,de);else if(!a||o||f||m){if(a&&!f&&o^m)he=we(he,de),o?(Q=0,he=We(he,de,Te)):(Q=1,he=We(he,de,Te),he=we(he,de));else if(a&&o&&!f&&m)Q=1,he=We(he,de,Te),he=we(he,de);else if(!a&&!f&&o^m){var be=_;o?(Q=1,he=We(he,de,Te),Q=0,_=!1,he=We(he,de,Te),_=be):(Q=0,he=We(he,de,Te),he=we(he,de),Q=1,_=!1,he=We(he,de,Te),_=be,he=we(he,de))}}else Q=0,he=We(he,de,Te);else Q=o?1:0,he=We(he,de,Te);return he},this.__bidiEngine__.setOptions=function(he){he&&(a=he.isInputVisual,f=he.isOutputVisual,o=he.isInputRtl,m=he.isOutputRtl,_=he.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(r){var i=r.text,l=(r.x,r.y,r.options||{}),a=(r.mutex,l.lang,[]);if(l.isInputVisual=typeof l.isInputVisual!="boolean"||l.isInputVisual,n.setOptions(l),Object.prototype.toString.call(i)==="[object Array]"){var o=0;for(a=[],o=0;o<i.length;o+=1)Object.prototype.toString.call(i[o])==="[object Array]"?a.push([n.doBidiReorder(i[o][0]),i[o][1],i[o][2]]):a.push([n.doBidiReorder(i[o])]);r.text=a}else r.text=n.doBidiReorder(i);n.setOptions({isInputVisual:!0})}])}(es),es.API.TTFFont=function(){function e(t){var n;if(this.rawData=t,n=this.contents=new ym(t),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new RG(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new xG(this.contents),this.head=new CG(this),this.name=new MG(this),this.cmap=new Kk(this),this.toUnicode={},this.hhea=new SG(this),this.maxp=new TG(this),this.hmtx=new AG(this),this.post=new PG(this),this.os2=new LG(this),this.loca=new OG(this),this.glyf=new kG(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,n,r,i,l;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var a,o,f,m;for(m=[],a=0,o=(f=this.bbox).length;a<o;a++)t=f[a],m.push(Math.round(t*this.scaleFactor));return m}).call(this),this.stemV=0,this.post.exists?(r=255&(i=this.post.italic_angle),32768&(n=i>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(l=this.familyClass)===1||l===2||l===3||l===4||l===5||l===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var n;return((n=this.cmap.unicode)!=null?n.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*n},e.prototype.widthOfString=function(t,n,r){var i,l,a,o;for(a=0,l=0,o=(t=""+t).length;0<=o?l<o:l>o;l=0<=o?++l:--l)i=t.charCodeAt(l),a+=this.widthOfGlyph(this.characterToGlyph(i))+r*(1e3/n)||0;return a*(n/1e3)},e.prototype.lineHeight=function(t,n){var r;return n==null&&(n=!1),r=n?this.lineGap:0,(this.ascender+r-this.decender)/1e3*t},e}();var ff,ym=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var n,r;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r[n]=String.fromCharCode(this.readByte());return r.join("")},e.prototype.writeString=function(t){var n,r,i;for(i=[],n=0,r=t.length;0<=r?n<r:n>r;n=0<=r?++n:--n)i.push(this.writeByte(t.charCodeAt(n)));return i},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,n,r,i,l,a,o,f;return t=this.readByte(),n=this.readByte(),r=this.readByte(),i=this.readByte(),l=this.readByte(),a=this.readByte(),o=this.readByte(),f=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^n)+1099511627776*(255^r)+4294967296*(255^i)+16777216*(255^l)+65536*(255^a)+256*(255^o)+(255^f)+1):72057594037927940*t+281474976710656*n+1099511627776*r+4294967296*i+16777216*l+65536*a+256*o+f},e.prototype.writeLongLong=function(t){var n,r;return n=Math.floor(t/4294967296),r=4294967295&t,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var n,r;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n.push(this.readByte());return n},e.prototype.write=function(t){var n,r,i,l;for(l=[],r=0,i=t.length;r<i;r++)n=t[r],l.push(this.writeByte(n));return l},e}(),xG=function(){var e;function t(n){var r,i,l;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},i=0,l=this.tableCount;0<=l?i<l:i>l;i=0<=l?++i:--i)r={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[r.tag]=r}return t.prototype.encode=function(n){var r,i,l,a,o,f,m,_,w,M,C,R,z;for(z in C=Object.keys(n).length,f=Math.log(2),w=16*Math.floor(Math.log(C)/f),a=Math.floor(w/f),_=16*C-w,(i=new ym).writeInt(this.scalarType),i.writeShort(C),i.writeShort(w),i.writeShort(a),i.writeShort(_),l=16*C,m=i.pos+l,o=null,R=[],n)for(M=n[z],i.writeString(z),i.writeInt(e(M)),i.writeInt(m),i.writeInt(M.length),R=R.concat(M),z==="head"&&(o=m),m+=M.length;m%4;)R.push(0),m++;return i.write(R),r=2981146554-e(i.data),i.pos=o+8,i.writeUInt32(r),i.data},e=function(n){var r,i,l,a;for(n=Yk.call(n);n.length%4;)n.push(0);for(l=new ym(n),i=0,r=0,a=n.length;r<a;r=r+=4)i+=l.readUInt32();return 4294967295&i},t}(),wG={}.hasOwnProperty,$f=function(e,t){for(var n in t)wG.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};ff=function(){function e(t){var n;this.file=t,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var CG=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return $f(t,ff),t.prototype.tag="head",t.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.revision=n.readInt(),this.checkSumAdjustment=n.readInt(),this.magicNumber=n.readInt(),this.flags=n.readShort(),this.unitsPerEm=n.readShort(),this.created=n.readLongLong(),this.modified=n.readLongLong(),this.xMin=n.readShort(),this.yMin=n.readShort(),this.xMax=n.readShort(),this.yMax=n.readShort(),this.macStyle=n.readShort(),this.lowestRecPPEM=n.readShort(),this.fontDirectionHint=n.readShort(),this.indexToLocFormat=n.readShort(),this.glyphDataFormat=n.readShort()},t.prototype.encode=function(n){var r;return(r=new ym).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(n),r.writeShort(this.glyphDataFormat),r.data},t}(),CP=function(){function e(t,n){var r,i,l,a,o,f,m,_,w,M,C,R,z,W,X,Y,Q;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=n+t.readInt(),w=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(f=0;f<256;++f)this.codeMap[f]=t.readByte();break;case 4:for(C=t.readUInt16(),M=C/2,t.pos+=6,l=function(){var oe,le;for(le=[],f=oe=0;0<=M?oe<M:oe>M;f=0<=M?++oe:--oe)le.push(t.readUInt16());return le}(),t.pos+=2,z=function(){var oe,le;for(le=[],f=oe=0;0<=M?oe<M:oe>M;f=0<=M?++oe:--oe)le.push(t.readUInt16());return le}(),m=function(){var oe,le;for(le=[],f=oe=0;0<=M?oe<M:oe>M;f=0<=M?++oe:--oe)le.push(t.readUInt16());return le}(),_=function(){var oe,le;for(le=[],f=oe=0;0<=M?oe<M:oe>M;f=0<=M?++oe:--oe)le.push(t.readUInt16());return le}(),i=(this.length-t.pos+this.offset)/2,o=function(){var oe,le;for(le=[],f=oe=0;0<=i?oe<i:oe>i;f=0<=i?++oe:--oe)le.push(t.readUInt16());return le}(),f=X=0,Q=l.length;X<Q;f=++X)for(W=l[f],r=Y=R=z[f];R<=W?Y<=W:Y>=W;r=R<=W?++Y:--Y)_[f]===0?a=r+m[f]:(a=o[_[f]/2+(r-R)-(M-f)]||0)!==0&&(a+=m[f]),this.codeMap[r]=65535&a}t.pos=w}return e.encode=function(t,n){var r,i,l,a,o,f,m,_,w,M,C,R,z,W,X,Y,Q,oe,le,me,we,ue,_e,We,he,de,Te,be,ae,ne,Se,Le,ze,He,pt,ge,Ie,Ne,Ve,it,lt,Mt,wt,rn,yn,Pn;switch(be=new ym,a=Object.keys(t).sort(function(De,Ae){return De-Ae}),n){case"macroman":for(z=0,W=function(){var De=[];for(R=0;R<256;++R)De.push(0);return De}(),Y={0:0},l={},ae=0,ze=a.length;ae<ze;ae++)Y[wt=t[i=a[ae]]]==null&&(Y[wt]=++z),l[i]={old:t[i],new:Y[t[i]]},W[i]=Y[t[i]];return be.writeUInt16(1),be.writeUInt16(0),be.writeUInt32(12),be.writeUInt16(0),be.writeUInt16(262),be.writeUInt16(0),be.write(W),{charMap:l,subtable:be.data,maxGlyphID:z+1};case"unicode":for(de=[],w=[],Q=0,Y={},r={},X=m=null,ne=0,He=a.length;ne<He;ne++)Y[le=t[i=a[ne]]]==null&&(Y[le]=++Q),r[i]={old:le,new:Y[le]},o=Y[le]-i,X!=null&&o===m||(X&&w.push(X),de.push(i),m=o),X=i;for(X&&w.push(X),w.push(65535),de.push(65535),We=2*(_e=de.length),ue=2*Math.pow(Math.log(_e)/Math.LN2,2),M=Math.log(ue/2)/Math.LN2,we=2*_e-ue,f=[],me=[],C=[],R=Se=0,pt=de.length;Se<pt;R=++Se){if(he=de[R],_=w[R],he===65535){f.push(0),me.push(0);break}if(he-(Te=r[he].new)>=32768)for(f.push(0),me.push(2*(C.length+_e-R)),i=Le=he;he<=_?Le<=_:Le>=_;i=he<=_?++Le:--Le)C.push(r[i].new);else f.push(Te-he),me.push(0)}for(be.writeUInt16(3),be.writeUInt16(1),be.writeUInt32(12),be.writeUInt16(4),be.writeUInt16(16+8*_e+2*C.length),be.writeUInt16(0),be.writeUInt16(We),be.writeUInt16(ue),be.writeUInt16(M),be.writeUInt16(we),lt=0,ge=w.length;lt<ge;lt++)i=w[lt],be.writeUInt16(i);for(be.writeUInt16(0),Mt=0,Ie=de.length;Mt<Ie;Mt++)i=de[Mt],be.writeUInt16(i);for(rn=0,Ne=f.length;rn<Ne;rn++)o=f[rn],be.writeUInt16(o);for(yn=0,Ve=me.length;yn<Ve;yn++)oe=me[yn],be.writeUInt16(oe);for(Pn=0,it=C.length;Pn<it;Pn++)z=C[Pn],be.writeUInt16(z);return{charMap:r,subtable:be.data,maxGlyphID:Q+1}}},e}(),Kk=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return $f(t,ff),t.prototype.tag="cmap",t.prototype.parse=function(n){var r,i,l;for(n.pos=this.offset,this.version=n.readUInt16(),l=n.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=l?i<l:i>l;i=0<=l?++i:--i)r=new CP(n,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(n,r){var i,l;return r==null&&(r="macroman"),i=CP.encode(n,r),(l=new ym).writeUInt16(0),l.writeUInt16(1),i.table=l.data.concat(i.subtable),i},t}(),SG=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return $f(t,ff),t.prototype.tag="hhea",t.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.ascender=n.readShort(),this.decender=n.readShort(),this.lineGap=n.readShort(),this.advanceWidthMax=n.readShort(),this.minLeftSideBearing=n.readShort(),this.minRightSideBearing=n.readShort(),this.xMaxExtent=n.readShort(),this.caretSlopeRise=n.readShort(),this.caretSlopeRun=n.readShort(),this.caretOffset=n.readShort(),n.pos+=8,this.metricDataFormat=n.readShort(),this.numberOfMetrics=n.readUInt16()},t}(),LG=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return $f(t,ff),t.prototype.tag="OS/2",t.prototype.parse=function(n){if(n.pos=this.offset,this.version=n.readUInt16(),this.averageCharWidth=n.readShort(),this.weightClass=n.readUInt16(),this.widthClass=n.readUInt16(),this.type=n.readShort(),this.ySubscriptXSize=n.readShort(),this.ySubscriptYSize=n.readShort(),this.ySubscriptXOffset=n.readShort(),this.ySubscriptYOffset=n.readShort(),this.ySuperscriptXSize=n.readShort(),this.ySuperscriptYSize=n.readShort(),this.ySuperscriptXOffset=n.readShort(),this.ySuperscriptYOffset=n.readShort(),this.yStrikeoutSize=n.readShort(),this.yStrikeoutPosition=n.readShort(),this.familyClass=n.readShort(),this.panose=function(){var r,i;for(i=[],r=0;r<10;++r)i.push(n.readByte());return i}(),this.charRange=function(){var r,i;for(i=[],r=0;r<4;++r)i.push(n.readInt());return i}(),this.vendorID=n.readString(4),this.selection=n.readShort(),this.firstCharIndex=n.readShort(),this.lastCharIndex=n.readShort(),this.version>0&&(this.ascent=n.readShort(),this.descent=n.readShort(),this.lineGap=n.readShort(),this.winAscent=n.readShort(),this.winDescent=n.readShort(),this.codePageRange=function(){var r,i;for(i=[],r=0;r<2;r=++r)i.push(n.readInt());return i}(),this.version>1))return this.xHeight=n.readShort(),this.capHeight=n.readShort(),this.defaultChar=n.readShort(),this.breakChar=n.readShort(),this.maxContext=n.readShort()},t}(),PG=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return $f(t,ff),t.prototype.tag="post",t.prototype.parse=function(n){var r,i,l;switch(n.pos=this.offset,this.format=n.readInt(),this.italicAngle=n.readInt(),this.underlinePosition=n.readShort(),this.underlineThickness=n.readShort(),this.isFixedPitch=n.readInt(),this.minMemType42=n.readInt(),this.maxMemType42=n.readInt(),this.minMemType1=n.readInt(),this.maxMemType1=n.readInt(),this.format){case 65536:break;case 131072:var a;for(i=n.readUInt16(),this.glyphNameIndex=[],a=0;0<=i?a<i:a>i;a=0<=i?++a:--a)this.glyphNameIndex.push(n.readUInt16());for(this.names=[],l=[];n.pos<this.offset+this.length;)r=n.readByte(),l.push(this.names.push(n.readString(r)));return l;case 151552:return i=n.readUInt16(),this.offsets=n.read(i);case 196608:break;case 262144:return this.map=(function(){var o,f,m;for(m=[],a=o=0,f=this.file.maxp.numGlyphs;0<=f?o<f:o>f;a=0<=f?++o:--o)m.push(n.readUInt32());return m}).call(this)}},t}(),EG=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},MG=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return $f(t,ff),t.prototype.tag="name",t.prototype.parse=function(n){var r,i,l,a,o,f,m,_,w,M,C;for(n.pos=this.offset,n.readShort(),r=n.readShort(),f=n.readShort(),i=[],a=0;0<=r?a<r:a>r;a=0<=r?++a:--a)i.push({platformID:n.readShort(),encodingID:n.readShort(),languageID:n.readShort(),nameID:n.readShort(),length:n.readShort(),offset:this.offset+f+n.readShort()});for(m={},a=w=0,M=i.length;w<M;a=++w)l=i[a],n.pos=l.offset,_=n.readString(l.length),o=new EG(_,l),m[C=l.nameID]==null&&(m[C]=[]),m[l.nameID].push(o);this.strings=m,this.copyright=m[0],this.fontFamily=m[1],this.fontSubfamily=m[2],this.uniqueSubfamily=m[3],this.fontName=m[4],this.version=m[5];try{this.postscriptName=m[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=m[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=m[7],this.manufacturer=m[8],this.designer=m[9],this.description=m[10],this.vendorUrl=m[11],this.designerUrl=m[12],this.license=m[13],this.licenseUrl=m[14],this.preferredFamily=m[15],this.preferredSubfamily=m[17],this.compatibleFull=m[18],this.sampleText=m[19]},t}(),TG=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return $f(t,ff),t.prototype.tag="maxp",t.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.numGlyphs=n.readUInt16(),this.maxPoints=n.readUInt16(),this.maxContours=n.readUInt16(),this.maxCompositePoints=n.readUInt16(),this.maxComponentContours=n.readUInt16(),this.maxZones=n.readUInt16(),this.maxTwilightPoints=n.readUInt16(),this.maxStorage=n.readUInt16(),this.maxFunctionDefs=n.readUInt16(),this.maxInstructionDefs=n.readUInt16(),this.maxStackElements=n.readUInt16(),this.maxSizeOfInstructions=n.readUInt16(),this.maxComponentElements=n.readUInt16(),this.maxComponentDepth=n.readUInt16()},t}(),AG=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return $f(t,ff),t.prototype.tag="hmtx",t.prototype.parse=function(n){var r,i,l,a,o,f,m;for(n.pos=this.offset,this.metrics=[],r=0,f=this.file.hhea.numberOfMetrics;0<=f?r<f:r>f;r=0<=f?++r:--r)this.metrics.push({advance:n.readUInt16(),lsb:n.readInt16()});for(l=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var _,w;for(w=[],r=_=0;0<=l?_<l:_>l;r=0<=l?++_:--_)w.push(n.readInt16());return w}(),this.widths=(function(){var _,w,M,C;for(C=[],_=0,w=(M=this.metrics).length;_<w;_++)a=M[_],C.push(a.advance);return C}).call(this),i=this.widths[this.widths.length-1],m=[],r=o=0;0<=l?o<l:o>l;r=0<=l?++o:--o)m.push(this.widths.push(i));return m},t.prototype.forGlyph=function(n){return n in this.metrics?this.metrics[n]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[n-this.metrics.length]}},t}(),Yk=[].slice,kG=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return $f(t,ff),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(n){var r,i,l,a,o,f,m,_,w,M;return n in this.cache?this.cache[n]:(a=this.file.loca,r=this.file.contents,i=a.indexOf(n),(l=a.lengthOf(n))===0?this.cache[n]=null:(r.pos=this.offset+i,o=(f=new ym(r.read(l))).readShort(),_=f.readShort(),M=f.readShort(),m=f.readShort(),w=f.readShort(),this.cache[n]=o===-1?new DG(f,_,M,m,w):new IG(f,o,_,M,m,w),this.cache[n]))},t.prototype.encode=function(n,r,i){var l,a,o,f,m;for(o=[],a=[],f=0,m=r.length;f<m;f++)l=n[r[f]],a.push(o.length),l&&(o=o.concat(l.encode(i)));return a.push(o.length),{table:o,offsets:a}},t}(),IG=function(){function e(t,n,r,i,l,a){this.raw=t,this.numberOfContours=n,this.xMin=r,this.yMin=i,this.xMax=l,this.yMax=a,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),DG=function(){function e(t,n,r,i,l){var a,o;for(this.raw=t,this.xMin=n,this.yMin=r,this.xMax=i,this.yMax=l,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],a=this.raw;o=a.readShort(),this.glyphOffsets.push(a.pos),this.glyphIDs.push(a.readUInt16()),32&o;)a.pos+=1&o?4:2,128&o?a.pos+=8:64&o?a.pos+=4:8&o&&(a.pos+=2)}return e.prototype.encode=function(){var t,n,r;for(n=new ym(Yk.call(this.raw.data)),t=0,r=this.glyphIDs.length;t<r;++t)n.pos=this.glyphOffsets[t];return n.data},e}(),OG=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return $f(t,ff),t.prototype.tag="loca",t.prototype.parse=function(n){var r,i;return n.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var l,a;for(a=[],i=0,l=this.length;i<l;i+=2)a.push(2*n.readUInt16());return a}).call(this):(function(){var l,a;for(a=[],i=0,l=this.length;i<l;i+=4)a.push(n.readUInt32());return a}).call(this)},t.prototype.indexOf=function(n){return this.offsets[n]},t.prototype.lengthOf=function(n){return this.offsets[n+1]-this.offsets[n]},t.prototype.encode=function(n,r){for(var i=new Uint32Array(this.offsets.length),l=0,a=0,o=0;o<i.length;++o)if(i[o]=l,a<r.length&&r[a]==o){++a,i[o]=l;var f=this.offsets[o],m=this.offsets[o+1]-f;m>0&&(l+=m)}for(var _=new Array(4*i.length),w=0;w<i.length;++w)_[4*w+3]=255&i[w],_[4*w+2]=(65280&i[w])>>8,_[4*w+1]=(16711680&i[w])>>16,_[4*w]=(4278190080&i[w])>>24;return _},t}(),RG=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,n,r,i,l;for(n in i=this.font.cmap.tables[0].codeMap,t={},l=this.subset)r=l[n],t[n]=i[r];return t},e.prototype.glyphsFor=function(t){var n,r,i,l,a,o,f;for(i={},a=0,o=t.length;a<o;a++)i[l=t[a]]=this.font.glyf.glyphFor(l);for(l in n=[],i)(r=i[l])!=null&&r.compound&&n.push.apply(n,r.glyphIDs);if(n.length>0)for(l in f=this.glyphsFor(n))r=f[l],i[l]=r;return i},e.prototype.encode=function(t,n){var r,i,l,a,o,f,m,_,w,M,C,R,z,W,X;for(i in r=Kk.encode(this.generateCmap(),"unicode"),a=this.glyphsFor(t),C={0:0},X=r.charMap)C[(f=X[i]).old]=f.new;for(R in M=r.maxGlyphID,a)R in C||(C[R]=M++);return _=function(Y){var Q,oe;for(Q in oe={},Y)oe[Y[Q]]=Q;return oe}(C),w=Object.keys(_).sort(function(Y,Q){return Y-Q}),z=function(){var Y,Q,oe;for(oe=[],Y=0,Q=w.length;Y<Q;Y++)o=w[Y],oe.push(_[o]);return oe}(),l=this.font.glyf.encode(a,z,C),m=this.font.loca.encode(l.offsets,z),W={cmap:this.font.cmap.raw(),glyf:l.table,loca:m,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(W["OS/2"]=this.font.os2.raw()),this.font.directory.encode(W)},e}();es.API.PDFObject=function(){var e;function t(){}return e=function(n,r){return(Array(r+1).join("0")+n).slice(-r)},t.convert=function(n){var r,i,l,a;if(Array.isArray(n))return"["+function(){var o,f,m;for(m=[],o=0,f=n.length;o<f;o++)r=n[o],m.push(t.convert(r));return m}().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+e(n.getUTCFullYear(),4)+e(n.getUTCMonth(),2)+e(n.getUTCDate(),2)+e(n.getUTCHours(),2)+e(n.getUTCMinutes(),2)+e(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(i in l=["<<"],n)a=n[i],l.push("/"+i+" "+t.convert(a));return l.push(">>"),l.join(`
`)}return""+n},t}();var Wx={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */Wx.exports;(function(e,t){(function(){var n,r="4.17.21",i=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",o="Invalid `variable` option passed into `_.template`",f="__lodash_hash_undefined__",m=500,_="__lodash_placeholder__",w=1,M=2,C=4,R=1,z=2,W=1,X=2,Y=4,Q=8,oe=16,le=32,me=64,we=128,ue=256,_e=512,We=30,he="...",de=800,Te=16,be=1,ae=2,ne=3,Se=1/0,Le=9007199254740991,ze=17976931348623157e292,He=NaN,pt=4294967295,ge=pt-1,Ie=pt>>>1,Ne=[["ary",we],["bind",W],["bindKey",X],["curry",Q],["curryRight",oe],["flip",_e],["partial",le],["partialRight",me],["rearg",ue]],Ve="[object Arguments]",it="[object Array]",lt="[object AsyncFunction]",Mt="[object Boolean]",wt="[object Date]",rn="[object DOMException]",yn="[object Error]",Pn="[object Function]",De="[object GeneratorFunction]",Ae="[object Map]",Be="[object Number]",Ce="[object Null]",ot="[object Object]",Dt="[object Promise]",Zt="[object Proxy]",an="[object RegExp]",ln="[object Set]",vn="[object String]",qn="[object Symbol]",Kn="[object Undefined]",cr="[object WeakMap]",pr="[object WeakSet]",Dr="[object ArrayBuffer]",zr="[object DataView]",Ht="[object Float32Array]",tn="[object Float64Array]",Kt="[object Int8Array]",Yn="[object Int16Array]",ir="[object Int32Array]",Fr="[object Uint8Array]",Ft="[object Uint8ClampedArray]",je="[object Uint16Array]",Ze="[object Uint32Array]",et=/\b__p \+= '';/g,ct=/\b(__p \+=) '' \+/g,$e=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Gt=/&(?:amp|lt|gt|quot|#39);/g,hn=/[&<>"']/g,Ot=RegExp(Gt.source),cn=RegExp(hn.source),En=/<%-([\s\S]+?)%>/g,wn=/<%([\s\S]+?)%>/g,Qn=/<%=([\s\S]+?)%>/g,Lr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Yt=/^\w*$/,vt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Tn=/[\\^$.*+?()[\]{}|]/g,bn=RegExp(Tn.source),br=/^\s+/,vr=/\s/,Cn=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,pn=/\{\n\/\* \[wrapped with (.+)\] \*/,Ut=/,? & /,Hn=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,or=/[()=,{}\[\]\/\s]/,Xr=/\\(\\)?/g,ri=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ai=/\w*$/,Pr=/^[-+]0x[0-9a-f]+$/i,As=/^0b[01]+$/i,$i=/^\[object .+?Constructor\]$/,Qa=/^0o[0-7]+$/i,pi=/^(?:0|[1-9]\d*)$/,Li=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Yi=/($^)/,ns=/['\n\r\u2028\u2029\\]/g,ao="\\ud800-\\udfff",wc="\\u0300-\\u036f",Wu="\\ufe20-\\ufe2f",el="\\u20d0-\\u20ff",Au=wc+Wu+el,Zu="\\u2700-\\u27bf",Ku="a-z\\xdf-\\xf6\\xf8-\\xff",Cc="\\xac\\xb1\\xd7\\xf7",Yu="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ja="\\u2000-\\u206f",ds=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Di="A-Z\\xc0-\\xd6\\xd8-\\xde",Xu="\\ufe0e\\ufe0f",lu=Cc+Yu+ja+ds,gl="['’]",Ju="["+ao+"]",ki="["+lu+"]",is="["+Au+"]",Ua="\\d+",Bo="["+Zu+"]",Co="["+Ku+"]",ku="[^"+ao+lu+Ua+Zu+Ku+Di+"]",yl="\\ud83c[\\udffb-\\udfff]",uu="(?:"+is+"|"+yl+")",lo="[^"+ao+"]",So="(?:\\ud83c[\\udde6-\\uddff]){2}",tl="[\\ud800-\\udbff][\\udc00-\\udfff]",ui="["+Di+"]",ji="\\u200d",nl="(?:"+Co+"|"+ku+")",rl="(?:"+ui+"|"+ku+")",Ws="(?:"+gl+"(?:d|ll|m|re|s|t|ve))?",Zs="(?:"+gl+"(?:D|LL|M|RE|S|T|VE))?",Ms=uu+"?",cu="["+Xu+"]?",us="(?:"+ji+"(?:"+[lo,So,tl].join("|")+")"+cu+Ms+")*",La="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Lo="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",yi=cu+Ms+us,Mi="(?:"+[Bo,So,tl].join("|")+")"+yi,fs="(?:"+[lo+is+"?",is,So,tl,Ju].join("|")+")",Bi=RegExp(gl,"g"),Bl=RegExp(is,"g"),Nl=RegExp(yl+"(?="+yl+")|"+fs+yi,"g"),No=RegExp([ui+"?"+Co+"+"+Ws+"(?="+[ki,ui,"$"].join("|")+")",rl+"+"+Zs+"(?="+[ki,ui+nl,"$"].join("|")+")",ui+"?"+nl+"+"+Ws,ui+"+"+Zs,Lo,La,Ua,Mi].join("|"),"g"),Pa=RegExp("["+ji+ao+Au+Xu+"]"),qi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Sc=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Gi=-1,Nr={};Nr[Ht]=Nr[tn]=Nr[Kt]=Nr[Yn]=Nr[ir]=Nr[Fr]=Nr[Ft]=Nr[je]=Nr[Ze]=!0,Nr[Ve]=Nr[it]=Nr[Dr]=Nr[Mt]=Nr[zr]=Nr[wt]=Nr[yn]=Nr[Pn]=Nr[Ae]=Nr[Be]=Nr[ot]=Nr[an]=Nr[ln]=Nr[vn]=Nr[cr]=!1;var Fi={};Fi[Ve]=Fi[it]=Fi[Dr]=Fi[zr]=Fi[Mt]=Fi[wt]=Fi[Ht]=Fi[tn]=Fi[Kt]=Fi[Yn]=Fi[ir]=Fi[Ae]=Fi[Be]=Fi[ot]=Fi[an]=Fi[ln]=Fi[vn]=Fi[qn]=Fi[Fr]=Fi[Ft]=Fi[je]=Fi[Ze]=!0,Fi[yn]=Fi[Pn]=Fi[cr]=!1;var Oi={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},hc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ua={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},hu={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},du=parseFloat,Iu=parseInt,fu=typeof lc=="object"&&lc&&lc.Object===Object&&lc,Hi=typeof self=="object"&&self&&self.Object===Object&&self,Ks=fu||Hi||Function("return this")(),di=t&&!t.nodeType&&t,ro=di&&!0&&e&&!e.nodeType&&e,vl=ro&&ro.exports===di,Ys=vl&&fu.process,Fs=function(){try{var Ln=ro&&ro.require&&ro.require("util").types;return Ln||Ys&&Ys.binding&&Ys.binding("util")}catch{}}(),Fo=Fs&&Fs.isArrayBuffer,Ea=Fs&&Fs.isDate,vs=Fs&&Fs.isMap,pu=Fs&&Fs.isRegExp,Ma=Fs&&Fs.isSet,Qu=Fs&&Fs.isTypedArray;function ss(Ln,nr,Fn){switch(Fn.length){case 0:return Ln.call(nr);case 1:return Ln.call(nr,Fn[0]);case 2:return Ln.call(nr,Fn[0],Fn[1]);case 3:return Ln.call(nr,Fn[0],Fn[1],Fn[2])}return Ln.apply(nr,Fn)}function Lc(Ln,nr,Fn,Hr){for(var ii=-1,xi=Ln==null?0:Ln.length;++ii<xi;){var as=Ln[ii];nr(Hr,as,Fn(as),Ln)}return Hr}function Po(Ln,nr){for(var Fn=-1,Hr=Ln==null?0:Ln.length;++Fn<Hr&&nr(Ln[Fn],Fn,Ln)!==!1;);return Ln}function Fl(Ln,nr){for(var Fn=Ln==null?0:Ln.length;Fn--&&nr(Ln[Fn],Fn,Ln)!==!1;);return Ln}function Du(Ln,nr){for(var Fn=-1,Hr=Ln==null?0:Ln.length;++Fn<Hr;)if(!nr(Ln[Fn],Fn,Ln))return!1;return!0}function Va(Ln,nr){for(var Fn=-1,Hr=Ln==null?0:Ln.length,ii=0,xi=[];++Fn<Hr;){var as=Ln[Fn];nr(as,Fn,Ln)&&(xi[ii++]=as)}return xi}function Jo(Ln,nr){var Fn=Ln==null?0:Ln.length;return!!Fn&&wr(Ln,nr,0)>-1}function zl(Ln,nr,Fn){for(var Hr=-1,ii=Ln==null?0:Ln.length;++Hr<ii;)if(Fn(nr,Ln[Hr]))return!0;return!1}function os(Ln,nr){for(var Fn=-1,Hr=Ln==null?0:Ln.length,ii=Array(Hr);++Fn<Hr;)ii[Fn]=nr(Ln[Fn],Fn,Ln);return ii}function ca(Ln,nr){for(var Fn=-1,Hr=nr.length,ii=Ln.length;++Fn<Hr;)Ln[ii+Fn]=nr[Fn];return Ln}function il(Ln,nr,Fn,Hr){var ii=-1,xi=Ln==null?0:Ln.length;for(Hr&&xi&&(Fn=Ln[++ii]);++ii<xi;)Fn=nr(Fn,Ln[ii],ii,Ln);return Fn}function uo(Ln,nr,Fn,Hr){var ii=Ln==null?0:Ln.length;for(Hr&&ii&&(Fn=Ln[--ii]);ii--;)Fn=nr(Fn,Ln[ii],ii,Ln);return Fn}function J(Ln,nr){for(var Fn=-1,Hr=Ln==null?0:Ln.length;++Fn<Hr;)if(nr(Ln[Fn],Fn,Ln))return!0;return!1}var Xe=Pi("length");function Bt(Ln){return Ln.split("")}function nn(Ln){return Ln.match(Hn)||[]}function An(Ln,nr,Fn){var Hr;return Fn(Ln,function(ii,xi,as){if(nr(ii,xi,as))return Hr=xi,!1}),Hr}function Xn(Ln,nr,Fn,Hr){for(var ii=Ln.length,xi=Fn+(Hr?1:-1);Hr?xi--:++xi<ii;)if(nr(Ln[xi],xi,Ln))return xi;return-1}function wr(Ln,nr,Fn){return nr===nr?Mo(Ln,nr,Fn):Xn(Ln,Zr,Fn)}function Wr(Ln,nr,Fn,Hr){for(var ii=Fn-1,xi=Ln.length;++ii<xi;)if(Hr(Ln[ii],nr))return ii;return-1}function Zr(Ln){return Ln!==Ln}function fi(Ln,nr){var Fn=Ln==null?0:Ln.length;return Fn?_s(Ln,nr)/Fn:He}function Pi(Ln){return function(nr){return nr==null?n:nr[Ln]}}function Xi(Ln){return function(nr){return Ln==null?n:Ln[nr]}}function js(Ln,nr,Fn,Hr,ii){return ii(Ln,function(xi,as,Cs){Fn=Hr?(Hr=!1,xi):nr(Fn,xi,as,Cs)}),Fn}function cs(Ln,nr){var Fn=Ln.length;for(Ln.sort(nr);Fn--;)Ln[Fn]=Ln[Fn].value;return Ln}function _s(Ln,nr){for(var Fn,Hr=-1,ii=Ln.length;++Hr<ii;){var xi=nr(Ln[Hr]);xi!==n&&(Fn=Fn===n?xi:Fn+xi)}return Fn}function co(Ln,nr){for(var Fn=-1,Hr=Array(Ln);++Fn<Ln;)Hr[Fn]=nr(Fn);return Hr}function yo(Ln,nr){return os(nr,function(Fn){return[Fn,Ln[Fn]]})}function $a(Ln){return Ln&&Ln.slice(0,Bu(Ln)+1).replace(br,"")}function Ri(Ln){return function(nr){return Ln(nr)}}function Qo(Ln,nr){return os(nr,function(Fn){return Ln[Fn]})}function mu(Ln,nr){return Ln.has(nr)}function Eo(Ln,nr){for(var Fn=-1,Hr=Ln.length;++Fn<Hr&&wr(nr,Ln[Fn],0)>-1;);return Fn}function Fc(Ln,nr){for(var Fn=Ln.length;Fn--&&wr(nr,Ln[Fn],0)>-1;);return Fn}function sl(Ln,nr){for(var Fn=Ln.length,Hr=0;Fn--;)Ln[Fn]===nr&&++Hr;return Hr}var zc=Xi(Oi),Ou=Xi(hc);function Ru(Ln){return"\\"+hu[Ln]}function _o(Ln,nr){return Ln==null?n:Ln[nr]}function _l(Ln){return Pa.test(Ln)}function ha(Ln){return qi.test(Ln)}function Ta(Ln){for(var nr,Fn=[];!(nr=Ln.next()).done;)Fn.push(nr.value);return Fn}function gu(Ln){var nr=-1,Fn=Array(Ln.size);return Ln.forEach(function(Hr,ii){Fn[++nr]=[ii,Hr]}),Fn}function Xs(Ln,nr){return function(Fn){return Ln(nr(Fn))}}function zo(Ln,nr){for(var Fn=-1,Hr=Ln.length,ii=0,xi=[];++Fn<Hr;){var as=Ln[Fn];(as===nr||as===_)&&(Ln[Fn]=_,xi[ii++]=Fn)}return xi}function ea(Ln){var nr=-1,Fn=Array(Ln.size);return Ln.forEach(function(Hr){Fn[++nr]=Hr}),Fn}function jc(Ln){var nr=-1,Fn=Array(Ln.size);return Ln.forEach(function(Hr){Fn[++nr]=[Hr,Hr]}),Fn}function Mo(Ln,nr,Fn){for(var Hr=Fn-1,ii=Ln.length;++Hr<ii;)if(Ln[Hr]===nr)return Hr;return-1}function jl(Ln,nr,Fn){for(var Hr=Fn+1;Hr--;)if(Ln[Hr]===nr)return Hr;return Hr}function mi(Ln){return _l(Ln)?da(Ln):Xe(Ln)}function jo(Ln){return _l(Ln)?ta(Ln):Bt(Ln)}function Bu(Ln){for(var nr=Ln.length;nr--&&vr.test(Ln.charAt(nr)););return nr}var Nu=Xi(ua);function da(Ln){for(var nr=Nl.lastIndex=0;Nl.test(Ln);)++nr;return nr}function ta(Ln){return Ln.match(Nl)||[]}function Ul(Ln){return Ln.match(No)||[]}var ol=function Ln(nr){nr=nr==null?Ks:na.defaults(Ks.Object(),nr,na.pick(Ks,Sc));var Fn=nr.Array,Hr=nr.Date,ii=nr.Error,xi=nr.Function,as=nr.Math,Cs=nr.Object,dc=nr.RegExp,ra=nr.String,Ts=nr.TypeError,al=Fn.prototype,bl=xi.prototype,Ga=Cs.prototype,ll=nr["__core-js_shared__"],Vl=bl.toString,Ui=Ga.hasOwnProperty,fa=0,Uo=function(){var b=/[^.]+$/.exec(ll&&ll.keys&&ll.keys.IE_PROTO||"");return b?"Symbol(src)_1."+b:""}(),bs=Ga.toString,oi=Vl.call(Cs),io=Ks._,Us=dc("^"+Vl.call(Ui).replace(Tn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),pa=vl?nr.Buffer:n,Vo=nr.Symbol,xl=nr.Uint8Array,ah=pa?pa.allocUnsafe:n,wl=Xs(Cs.getPrototypeOf,Cs),To=Cs.create,ks=Ga.propertyIsEnumerable,ho=al.splice,$o=Vo?Vo.isConcatSpreadable:n,vi=Vo?Vo.iterator:n,$l=Vo?Vo.toStringTag:n,yu=function(){try{var b=Ud(Cs,"defineProperty");return b({},"",{}),b}catch{}}(),Ha=nr.clearTimeout!==Ks.clearTimeout&&nr.clearTimeout,Go=Hr&&Hr.now!==Ks.Date.now&&Hr.now,Uc=nr.setTimeout!==Ks.setTimeout&&nr.setTimeout,Ho=as.ceil,Ao=as.floor,Gl=Cs.getOwnPropertySymbols,p=pa?pa.isBuffer:n,T=nr.isFinite,U=al.join,se=Xs(Cs.keys,Cs),Pe=as.max,nt=as.min,Jt=Hr.now,Dn=nr.parseInt,Jn=as.random,ar=al.reverse,Vr=Ud(nr,"DataView"),Jr=Ud(nr,"Map"),Vi=Ud(nr,"Promise"),vo=Ud(nr,"Set"),Js=Ud(nr,"WeakMap"),so=Ud(Cs,"create"),Ss=Js&&new Js,ma={},lh=_f(Vr),Cl=_f(Jr),Sl=_f(Vi),qa=_f(vo),Xh=_f(Js),Aa=Vo?Vo.prototype:n,xs=Aa?Aa.valueOf:n,ia=Aa?Aa.toString:n;function dt(b){if(va(b)&&!ls(b)&&!(b instanceof Ni)){if(b instanceof qo)return b;if(Ui.call(b,"__wrapped__"))return s1(b)}return new qo(b)}var ka=function(){function b(){}return function(k){if(!Da(k))return{};if(To)return To(k);b.prototype=k;var q=new b;return b.prototype=n,q}}();function Vc(){}function qo(b,k){this.__wrapped__=b,this.__actions__=[],this.__chain__=!!k,this.__index__=0,this.__values__=n}dt.templateSettings={escape:En,evaluate:wn,interpolate:Qn,variable:"",imports:{_:dt}},dt.prototype=Vc.prototype,dt.prototype.constructor=dt,qo.prototype=ka(Vc.prototype),qo.prototype.constructor=qo;function Ni(b){this.__wrapped__=b,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=pt,this.__views__=[]}function ec(){var b=new Ni(this.__wrapped__);return b.__actions__=nc(this.__actions__),b.__dir__=this.__dir__,b.__filtered__=this.__filtered__,b.__iteratees__=nc(this.__iteratees__),b.__takeCount__=this.__takeCount__,b.__views__=nc(this.__views__),b}function Ll(){if(this.__filtered__){var b=new Ni(this);b.__dir__=-1,b.__filtered__=!0}else b=this.clone(),b.__dir__*=-1;return b}function Ia(){var b=this.__wrapped__.value(),k=this.__dir__,q=ls(b),ye=k<0,Je=q?b.length:0,Pt=aw(0,Je,this.__views__),Xt=Pt.start,xn=Pt.end,Nn=xn-Xt,Er=ye?xn:Xt-1,Mr=this.__iteratees__,Rr=Mr.length,ni=0,Si=nt(Nn,this.__takeCount__);if(!q||!ye&&Je==Nn&&Si==Nn)return bo(b,this.__actions__);var Wi=[];e:for(;Nn--&&ni<Si;){Er+=k;for(var Is=-1,Zi=b[Er];++Is<Rr;){var Vs=Mr[Is],Qs=Vs.iteratee,ld=Vs.type,gh=Qs(Zi);if(ld==ae)Zi=gh;else if(!gh){if(ld==be)continue e;break e}}Wi[ni++]=Zi}return Wi}Ni.prototype=ka(Vc.prototype),Ni.prototype.constructor=Ni;function Wo(b){var k=-1,q=b==null?0:b.length;for(this.clear();++k<q;){var ye=b[k];this.set(ye[0],ye[1])}}function Th(){this.__data__=so?so(null):{},this.size=0}function Fu(b){var k=this.has(b)&&delete this.__data__[b];return this.size-=k?1:0,k}function fc(b){var k=this.__data__;if(so){var q=k[b];return q===f?n:q}return Ui.call(k,b)?k[b]:n}function uh(b){var k=this.__data__;return so?k[b]!==n:Ui.call(k,b)}function Ah(b,k){var q=this.__data__;return this.size+=this.has(b)?0:1,q[b]=so&&k===n?f:k,this}Wo.prototype.clear=Th,Wo.prototype.delete=Fu,Wo.prototype.get=fc,Wo.prototype.has=uh,Wo.prototype.set=Ah;function Pc(b){var k=-1,q=b==null?0:b.length;for(this.clear();++k<q;){var ye=b[k];this.set(ye[0],ye[1])}}function jd(){this.__data__=[],this.size=0}function Jh(b){var k=this.__data__,q=Sn(k,b);if(q<0)return!1;var ye=k.length-1;return q==ye?k.pop():ho.call(k,q,1),--this.size,!0}function zu(b){var k=this.__data__,q=Sn(k,b);return q<0?n:k[q][1]}function pc(b){return Sn(this.__data__,b)>-1}function Gr(b,k){var q=this.__data__,ye=Sn(q,b);return ye<0?(++this.size,q.push([b,k])):q[ye][1]=k,this}Pc.prototype.clear=jd,Pc.prototype.delete=Jh,Pc.prototype.get=zu,Pc.prototype.has=pc,Pc.prototype.set=Gr;function vu(b){var k=-1,q=b==null?0:b.length;for(this.clear();++k<q;){var ye=b[k];this.set(ye[0],ye[1])}}function wd(){this.size=0,this.__data__={hash:new Wo,map:new(Jr||Pc),string:new Wo}}function kh(b){var k=jg(this,b).delete(b);return this.size-=k?1:0,k}function Ih(b){return jg(this,b).get(b)}function B(b){return jg(this,b).has(b)}function H(b,k){var q=jg(this,b),ye=q.size;return q.set(b,k),this.size+=q.size==ye?0:1,this}vu.prototype.clear=wd,vu.prototype.delete=kh,vu.prototype.get=Ih,vu.prototype.has=B,vu.prototype.set=H;function ie(b){var k=-1,q=b==null?0:b.length;for(this.__data__=new vu;++k<q;)this.add(b[k])}function Ee(b){return this.__data__.set(b,f),this}function Ye(b){return this.__data__.has(b)}ie.prototype.add=ie.prototype.push=Ee,ie.prototype.has=Ye;function rt(b){var k=this.__data__=new Pc(b);this.size=k.size}function ut(){this.__data__=new Pc,this.size=0}function ht(b){var k=this.__data__,q=k.delete(b);return this.size=k.size,q}function gt(b){return this.__data__.get(b)}function kt(b){return this.__data__.has(b)}function _n(b,k){var q=this.__data__;if(q instanceof Pc){var ye=q.__data__;if(!Jr||ye.length<i-1)return ye.push([b,k]),this.size=++q.size,this;q=this.__data__=new vu(ye)}return q.set(b,k),this.size=q.size,this}rt.prototype.clear=ut,rt.prototype.delete=ht,rt.prototype.get=gt,rt.prototype.has=kt,rt.prototype.set=_n;function Vn(b,k){var q=ls(b),ye=!q&&xf(b),Je=!q&&!ye&&Ac(b),Pt=!q&&!ye&&!Je&&Xf(b),Xt=q||ye||Je||Pt,xn=Xt?co(b.length,ra):[],Nn=xn.length;for(var Er in b)(k||Ui.call(b,Er))&&!(Xt&&(Er=="length"||Je&&(Er=="offset"||Er=="parent")||Pt&&(Er=="buffer"||Er=="byteLength"||Er=="byteOffset")||Vd(Er,Nn)))&&xn.push(Er);return xn}function Un(b){var k=b.length;return k?b[on(0,k-1)]:n}function kn(b,k){return vf(nc(b),ei(k,0,b.length))}function ur(b){return vf(nc(b))}function Zn(b,k,q){(q!==n&&!gc(b[k],q)||q===n&&!(k in b))&&qr(b,k,q)}function Qt(b,k,q){var ye=b[k];(!(Ui.call(b,k)&&gc(ye,q))||q===n&&!(k in b))&&qr(b,k,q)}function Sn(b,k){for(var q=b.length;q--;)if(gc(b[q][0],k))return q;return-1}function fr(b,k,q,ye){return te(b,function(Je,Pt,Xt){k(ye,Je,q(Je),Xt)}),ye}function Cr(b,k){return b&&$c(k,Oe(k),b)}function gr(b,k){return b&&$c(k,ft(k),b)}function qr(b,k,q){k=="__proto__"&&yu?yu(b,k,{configurable:!0,enumerable:!0,value:q,writable:!0}):b[k]=q}function Ur(b,k){for(var q=-1,ye=k.length,Je=Fn(ye),Pt=b==null;++q<ye;)Je[q]=Pt?n:qe(b,k[q]);return Je}function ei(b,k,q){return b===b&&(q!==n&&(b=b<=q?b:q),k!==n&&(b=b>=k?b:k)),b}function y(b,k,q,ye,Je,Pt){var Xt,xn=k&w,Nn=k&M,Er=k&C;if(q&&(Xt=Je?q(b,ye,Je,Pt):q(b)),Xt!==n)return Xt;if(!Da(b))return b;var Mr=ls(b);if(Mr){if(Xt=uw(b),!xn)return nc(b,Xt)}else{var Rr=Zl(b),ni=Rr==Pn||Rr==De;if(Ac(b))return ed(b,xn);if(Rr==ot||Rr==Ve||ni&&!Je){if(Xt=Nn||ni?{}:Q_(b),!xn)return Nn?Ec(b,gr(Xt,b)):Bg(b,Cr(Xt,b))}else{if(!Fi[Rr])return Je?b:{};Xt=cw(b,Rr,xn)}}Pt||(Pt=new rt);var Si=Pt.get(b);if(Si)return Si;Pt.set(b,Xt),t0(b)?b.forEach(function(Zi){Xt.add(y(Zi,k,q,Zi,b,Pt))}):Wm(b)&&b.forEach(function(Zi,Vs){Xt.set(Vs,y(Zi,k,q,Vs,b,Pt))});var Wi=Er?Nn?Im:zg:Nn?ft:Oe,Is=Mr?n:Wi(b);return Po(Is||b,function(Zi,Vs){Is&&(Vs=Zi,Zi=b[Vs]),Qt(Xt,Vs,y(Zi,k,q,Vs,b,Pt))}),Xt}function S(b){var k=Oe(b);return function(q){return I(q,b,k)}}function I(b,k,q){var ye=q.length;if(b==null)return!ye;for(b=Cs(b);ye--;){var Je=q[ye],Pt=k[Je],Xt=b[Je];if(Xt===n&&!(Je in b)||!Pt(Xt))return!1}return!0}function F(b,k,q){if(typeof b!="function")throw new Ts(a);return Tp(function(){b.apply(n,q)},k)}function G(b,k,q,ye){var Je=-1,Pt=Jo,Xt=!0,xn=b.length,Nn=[],Er=k.length;if(!xn)return Nn;q&&(k=os(k,Ri(q))),ye?(Pt=zl,Xt=!1):k.length>=i&&(Pt=mu,Xt=!1,k=new ie(k));e:for(;++Je<xn;){var Mr=b[Je],Rr=q==null?Mr:q(Mr);if(Mr=ye||Mr!==0?Mr:0,Xt&&Rr===Rr){for(var ni=Er;ni--;)if(k[ni]===Rr)continue e;Nn.push(Mr)}else Pt(k,Rr,ye)||Nn.push(Mr)}return Nn}var te=Lm(hr),pe=Lm(Ir,!0);function xe(b,k){var q=!0;return te(b,function(ye,Je,Pt){return q=!!k(ye,Je,Pt),q}),q}function Fe(b,k,q){for(var ye=-1,Je=b.length;++ye<Je;){var Pt=b[ye],Xt=k(Pt);if(Xt!=null&&(xn===n?Xt===Xt&&!Gc(Xt):q(Xt,xn)))var xn=Xt,Nn=Pt}return Nn}function tt(b,k,q,ye){var Je=b.length;for(q=ps(q),q<0&&(q=-q>Je?0:Je+q),ye=ye===n||ye>Je?Je:ps(ye),ye<0&&(ye+=Je),ye=q>ye?0:r0(ye);q<ye;)b[q++]=k;return b}function zt(b,k){var q=[];return te(b,function(ye,Je,Pt){k(ye,Je,Pt)&&q.push(ye)}),q}function bt(b,k,q,ye,Je){var Pt=-1,Xt=b.length;for(q||(q=yy),Je||(Je=[]);++Pt<Xt;){var xn=b[Pt];k>0&&q(xn)?k>1?bt(xn,k-1,q,ye,Je):ca(Je,xn):ye||(Je[Je.length]=xn)}return Je}var dn=pf(),zn=pf(!0);function hr(b,k){return b&&dn(b,k,Oe)}function Ir(b,k){return b&&zn(b,k,Oe)}function Br(b,k){return Va(k,function(q){return fh(b[q])})}function ci(b,k){k=ul(k,b);for(var q=0,ye=k.length;b!=null&&q<ye;)b=b[nd(k[q++])];return q&&q==ye?b:n}function Nt(b,k,q){var ye=k(b);return ls(b)?ye:ca(ye,q(b))}function qt(b){return b==null?b===n?Kn:Ce:$l&&$l in Cs(b)?gy(b):vy(b)}function gn(b,k){return b>k}function Gn(b,k){return b!=null&&Ui.call(b,k)}function Mn(b,k){return b!=null&&k in Cs(b)}function Bn(b,k,q){return b>=nt(k,q)&&b<Pe(k,q)}function Ge(b,k,q){for(var ye=q?zl:Jo,Je=b[0].length,Pt=b.length,Xt=Pt,xn=Fn(Pt),Nn=1/0,Er=[];Xt--;){var Mr=b[Xt];Xt&&k&&(Mr=os(Mr,Ri(k))),Nn=nt(Mr.length,Nn),xn[Xt]=!q&&(k||Je>=120&&Mr.length>=120)?new ie(Xt&&Mr):n}Mr=b[0];var Rr=-1,ni=xn[0];e:for(;++Rr<Je&&Er.length<Nn;){var Si=Mr[Rr],Wi=k?k(Si):Si;if(Si=q||Si!==0?Si:0,!(ni?mu(ni,Wi):ye(Er,Wi,q))){for(Xt=Pt;--Xt;){var Is=xn[Xt];if(!(Is?mu(Is,Wi):ye(b[Xt],Wi,q)))continue e}ni&&ni.push(Wi),Er.push(Si)}}return Er}function at(b,k,q,ye){return hr(b,function(Je,Pt,Xt){k(ye,q(Je),Pt,Xt)}),ye}function mt(b,k,q){k=ul(k,b),b=Bm(b,k);var ye=b==null?b:b[nd(Dh(k))];return ye==null?n:ss(ye,b,q)}function _t(b){return va(b)&&qt(b)==Ve}function St(b){return va(b)&&qt(b)==Dr}function Lt(b){return va(b)&&qt(b)==wt}function sn(b,k,q,ye,Je){return b===k?!0:b==null||k==null||!va(b)&&!va(k)?b!==b&&k!==k:E(b,k,q,ye,sn,Je)}function E(b,k,q,ye,Je,Pt){var Xt=ls(b),xn=ls(k),Nn=Xt?it:Zl(b),Er=xn?it:Zl(k);Nn=Nn==Ve?ot:Nn,Er=Er==Ve?ot:Er;var Mr=Nn==ot,Rr=Er==ot,ni=Nn==Er;if(ni&&Ac(b)){if(!Ac(k))return!1;Xt=!0,Mr=!1}if(ni&&!Mr)return Pt||(Pt=new rt),Xt||Xf(b)?dy(b,k,q,ye,Je,Pt):fy(b,k,Nn,q,ye,Je,Pt);if(!(q&R)){var Si=Mr&&Ui.call(b,"__wrapped__"),Wi=Rr&&Ui.call(k,"__wrapped__");if(Si||Wi){var Is=Si?b.value():b,Zi=Wi?k.value():k;return Pt||(Pt=new rt),Je(Is,Zi,q,ye,Pt)}}return ni?(Pt||(Pt=new rt),km(b,k,q,ye,Je,Pt)):!1}function s(b){return va(b)&&Zl(b)==Ae}function c(b,k,q,ye){var Je=q.length,Pt=Je,Xt=!ye;if(b==null)return!Pt;for(b=Cs(b);Je--;){var xn=q[Je];if(Xt&&xn[2]?xn[1]!==b[xn[0]]:!(xn[0]in b))return!1}for(;++Je<Pt;){xn=q[Je];var Nn=xn[0],Er=b[Nn],Mr=xn[1];if(Xt&&xn[2]){if(Er===n&&!(Nn in b))return!1}else{var Rr=new rt;if(ye)var ni=ye(Er,Mr,Nn,b,k,Rr);if(!(ni===n?sn(Mr,Er,R|z,ye,Rr):ni))return!1}}return!0}function g(b){if(!Da(b)||Pp(b))return!1;var k=fh(b)?Us:$i;return k.test(_f(b))}function x(b){return va(b)&&qt(b)==an}function A(b){return va(b)&&Zl(b)==ln}function N(b){return va(b)&&Kf(b.length)&&!!Nr[qt(b)]}function $(b){return typeof b=="function"?b:b==null?ic:typeof b=="object"?ls(b)?Ke(b[0],b[1]):ke(b):gS(b)}function Z(b){if(!yf(b))return se(b);var k=[];for(var q in Cs(b))Ui.call(b,q)&&q!="constructor"&&k.push(q);return k}function re(b){if(!Da(b))return Rm(b);var k=yf(b),q=[];for(var ye in b)ye=="constructor"&&(k||!Ui.call(b,ye))||q.push(ye);return q}function fe(b,k){return b<k}function Me(b,k){var q=-1,ye=Tc(b)?Fn(b.length):[];return te(b,function(Je,Pt,Xt){ye[++q]=k(Je,Pt,Xt)}),ye}function ke(b){var k=my(b);return k.length==1&&k[0][2]?Ep(k[0][0],k[0][1]):function(q){return q===b||c(q,b,k)}}function Ke(b,k){return qf(b)&&Om(k)?Ep(nd(b),k):function(q){var ye=qe(q,b);return ye===n&&ye===k?xt(q,b):sn(k,ye,R|z)}}function Qe(b,k,q,ye,Je){b!==k&&dn(k,function(Pt,Xt){if(Je||(Je=new rt),Da(Pt))Tt(b,k,Xt,q,Qe,ye,Je);else{var xn=ye?ye(Zf(b,Xt),Pt,Xt+"",b,k,Je):n;xn===n&&(xn=Pt),Zn(b,Xt,xn)}},ft)}function Tt(b,k,q,ye,Je,Pt,Xt){var xn=Zf(b,q),Nn=Zf(k,q),Er=Xt.get(Nn);if(Er){Zn(b,q,Er);return}var Mr=Pt?Pt(xn,Nn,q+"",b,k,Xt):n,Rr=Mr===n;if(Rr){var ni=ls(Nn),Si=!ni&&Ac(Nn),Wi=!ni&&!Si&&Xf(Nn);Mr=Nn,ni||Si||Wi?ls(xn)?Mr=xn:Ml(xn)?Mr=nc(xn):Si?(Rr=!1,Mr=ed(Nn,!0)):Wi?(Rr=!1,Mr=ga(Nn,!0)):Mr=[]:Yf(Nn)||xf(Nn)?(Mr=xn,xf(xn)?Mr=Bp(xn):(!Da(xn)||fh(xn))&&(Mr=Q_(Nn))):Rr=!1}Rr&&(Xt.set(Nn,Mr),Je(Mr,Nn,ye,Pt,Xt),Xt.delete(Nn)),Zn(b,q,Mr)}function Ct(b,k){var q=b.length;if(q)return k+=k<0?q:0,Vd(k,q)?b[k]:n}function At(b,k,q){k.length?k=os(k,function(Pt){return ls(Pt)?function(Xt){return ci(Xt,Pt.length===1?Pt[0]:Pt)}:Pt}):k=[ic];var ye=-1;k=os(k,Ri(zi()));var Je=Me(b,function(Pt,Xt,xn){var Nn=os(k,function(Er){return Er(Pt)});return{criteria:Nn,index:++ye,value:Pt}});return cs(Je,function(Pt,Xt){return Og(Pt,Xt,q)})}function Rt(b,k){return jt(b,k,function(q,ye){return xt(b,ye)})}function jt(b,k,q){for(var ye=-1,Je=k.length,Pt={};++ye<Je;){var Xt=k[ye],xn=ci(b,Xt);q(xn,Xt)&&Or(Pt,ul(Xt,b),xn)}return Pt}function Vt(b){return function(k){return ci(k,b)}}function en(b,k,q,ye){var Je=ye?Wr:wr,Pt=-1,Xt=k.length,xn=b;for(b===k&&(k=nc(k)),q&&(xn=os(b,Ri(q)));++Pt<Xt;)for(var Nn=0,Er=k[Pt],Mr=q?q(Er):Er;(Nn=Je(xn,Mr,Nn,ye))>-1;)xn!==b&&ho.call(xn,Nn,1),ho.call(b,Nn,1);return b}function mn(b,k){for(var q=b?k.length:0,ye=q-1;q--;){var Je=k[q];if(q==ye||Je!==Pt){var Pt=Je;Vd(Je)?ho.call(b,Je,1):ko(b,Je)}}return b}function on(b,k){return b+Ao(Jn()*(k-b+1))}function On(b,k,q,ye){for(var Je=-1,Pt=Pe(Ho((k-b)/(q||1)),0),Xt=Fn(Pt);Pt--;)Xt[ye?Pt:++Je]=b,b+=q;return Xt}function jn(b,k){var q="";if(!b||k<1||k>Le)return q;do k%2&&(q+=b),k=Ao(k/2),k&&(b+=b);while(k);return q}function In(b,k){return $d(Wf(b,k,ic),b+"")}function sr(b){return Un($u(b))}function tr(b,k){var q=$u(b);return vf(q,ei(k,0,q.length))}function Or(b,k,q,ye){if(!Da(b))return b;k=ul(k,b);for(var Je=-1,Pt=k.length,Xt=Pt-1,xn=b;xn!=null&&++Je<Pt;){var Nn=nd(k[Je]),Er=q;if(Nn==="__proto__"||Nn==="constructor"||Nn==="prototype")return b;if(Je!=Xt){var Mr=xn[Nn];Er=ye?ye(Mr,Nn,xn):n,Er===n&&(Er=Da(Mr)?Mr:Vd(k[Je+1])?[]:{})}Qt(xn,Nn,Er),xn=xn[Nn]}return b}var Sr=Ss?function(b,k){return Ss.set(b,k),b}:ic,mr=yu?function(b,k){return yu(b,"toString",{configurable:!0,enumerable:!1,value:ev(k),writable:!0})}:ic;function ti(b){return vf($u(b))}function wi(b,k,q){var ye=-1,Je=b.length;k<0&&(k=-k>Je?0:Je+k),q=q>Je?Je:q,q<0&&(q+=Je),Je=k>q?0:q-k>>>0,k>>>=0;for(var Pt=Fn(Je);++ye<Je;)Pt[ye]=b[ye+k];return Pt}function Ei(b,k){var q;return te(b,function(ye,Je,Pt){return q=k(ye,Je,Pt),!q}),!!q}function Os(b,k,q){var ye=0,Je=b==null?ye:b.length;if(typeof k=="number"&&k===k&&Je<=Ie){for(;ye<Je;){var Pt=ye+Je>>>1,Xt=b[Pt];Xt!==null&&!Gc(Xt)&&(q?Xt<=k:Xt<k)?ye=Pt+1:Je=Pt}return Je}return Rs(b,k,ic,q)}function Rs(b,k,q,ye){var Je=0,Pt=b==null?0:b.length;if(Pt===0)return 0;k=q(k);for(var Xt=k!==k,xn=k===null,Nn=Gc(k),Er=k===n;Je<Pt;){var Mr=Ao((Je+Pt)/2),Rr=q(b[Mr]),ni=Rr!==n,Si=Rr===null,Wi=Rr===Rr,Is=Gc(Rr);if(Xt)var Zi=ye||Wi;else Er?Zi=Wi&&(ye||ni):xn?Zi=Wi&&ni&&(ye||!Si):Nn?Zi=Wi&&ni&&!Si&&(ye||!Is):Si||Is?Zi=!1:Zi=ye?Rr<=k:Rr<k;Zi?Je=Mr+1:Pt=Mr}return nt(Pt,ge)}function fo(b,k){for(var q=-1,ye=b.length,Je=0,Pt=[];++q<ye;){var Xt=b[q],xn=k?k(Xt):Xt;if(!q||!gc(xn,Nn)){var Nn=xn;Pt[Je++]=Xt===0?0:Xt}}return Pt}function po(b){return typeof b=="number"?b:Gc(b)?He:+b}function Ji(b){if(typeof b=="string")return b;if(ls(b))return os(b,Ji)+"";if(Gc(b))return ia?ia.call(b):"";var k=b+"";return k=="0"&&1/b==-1/0?"-0":k}function hs(b,k,q){var ye=-1,Je=Jo,Pt=b.length,Xt=!0,xn=[],Nn=xn;if(q)Xt=!1,Je=zl;else if(Pt>=i){var Er=k?null:ow(b);if(Er)return ea(Er);Xt=!1,Je=mu,Nn=new ie}else Nn=k?[]:xn;e:for(;++ye<Pt;){var Mr=b[ye],Rr=k?k(Mr):Mr;if(Mr=q||Mr!==0?Mr:0,Xt&&Rr===Rr){for(var ni=Nn.length;ni--;)if(Nn[ni]===Rr)continue e;k&&Nn.push(Rr),xn.push(Mr)}else Je(Nn,Rr,q)||(Nn!==xn&&Nn.push(Rr),xn.push(Mr))}return xn}function ko(b,k){return k=ul(k,b),b=Bm(b,k),b==null||delete b[nd(Dh(k))]}function sa(b,k,q,ye){return Or(b,k,q(ci(b,k)),ye)}function Zo(b,k,q,ye){for(var Je=b.length,Pt=ye?Je:-1;(ye?Pt--:++Pt<Je)&&k(b[Pt],Pt,b););return q?wi(b,ye?0:Pt,ye?Pt+1:Je):wi(b,ye?Pt+1:0,ye?Je:Pt)}function bo(b,k){var q=b;return q instanceof Ni&&(q=q.value()),il(k,function(ye,Je){return Je.func.apply(Je.thisArg,ca([ye],Je.args))},q)}function Wa(b,k,q){var ye=b.length;if(ye<2)return ye?hs(b[0]):[];for(var Je=-1,Pt=Fn(ye);++Je<ye;)for(var Xt=b[Je],xn=-1;++xn<ye;)xn!=Je&&(Pt[Je]=G(Pt[Je]||Xt,b[xn],k,q));return hs(bt(Pt,1),k,q)}function Hl(b,k,q){for(var ye=-1,Je=b.length,Pt=k.length,Xt={};++ye<Je;){var xn=ye<Pt?k[ye]:n;q(Xt,b[ye],xn)}return Xt}function ju(b){return Ml(b)?b:[]}function tc(b){return typeof b=="function"?b:ic}function ul(b,k){return ls(b)?b:qf(b,k)?[b]:Vg(oo(b))}var Qh=In;function ql(b,k,q){var ye=b.length;return q=q===n?ye:q,!k&&q>=ye?b:wi(b,k,q)}var Wl=Ha||function(b){return Ks.clearTimeout(b)};function ed(b,k){if(k)return b.slice();var q=b.length,ye=ah?ah(q):new b.constructor(q);return b.copy(ye),ye}function ch(b){var k=new b.constructor(b.byteLength);return new xl(k).set(new xl(b)),k}function td(b,k){var q=k?ch(b.buffer):b.buffer;return new b.constructor(q,b.byteOffset,b.byteLength)}function oa(b){var k=new b.constructor(b.source,ai.exec(b));return k.lastIndex=b.lastIndex,k}function Io(b){return xs?Cs(xs.call(b)):{}}function ga(b,k){var q=k?ch(b.buffer):b.buffer;return new b.constructor(q,b.byteOffset,b.length)}function Do(b,k){if(b!==k){var q=b!==n,ye=b===null,Je=b===b,Pt=Gc(b),Xt=k!==n,xn=k===null,Nn=k===k,Er=Gc(k);if(!xn&&!Er&&!Pt&&b>k||Pt&&Xt&&Nn&&!xn&&!Er||ye&&Xt&&Nn||!q&&Nn||!Je)return 1;if(!ye&&!Pt&&!Er&&b<k||Er&&q&&Je&&!ye&&!Pt||xn&&q&&Je||!Xt&&Je||!Nn)return-1}return 0}function Og(b,k,q){for(var ye=-1,Je=b.criteria,Pt=k.criteria,Xt=Je.length,xn=q.length;++ye<Xt;){var Nn=Do(Je[ye],Pt[ye]);if(Nn){if(ye>=xn)return Nn;var Er=q[ye];return Nn*(Er=="desc"?-1:1)}}return b.index-k.index}function Cd(b,k,q,ye){for(var Je=-1,Pt=b.length,Xt=q.length,xn=-1,Nn=k.length,Er=Pe(Pt-Xt,0),Mr=Fn(Nn+Er),Rr=!ye;++xn<Nn;)Mr[xn]=k[xn];for(;++Je<Xt;)(Rr||Je<Pt)&&(Mr[q[Je]]=b[Je]);for(;Er--;)Mr[xn++]=b[Je++];return Mr}function Rg(b,k,q,ye){for(var Je=-1,Pt=b.length,Xt=-1,xn=q.length,Nn=-1,Er=k.length,Mr=Pe(Pt-xn,0),Rr=Fn(Mr+Er),ni=!ye;++Je<Mr;)Rr[Je]=b[Je];for(var Si=Je;++Nn<Er;)Rr[Si+Nn]=k[Nn];for(;++Xt<xn;)(ni||Je<Pt)&&(Rr[Si+q[Xt]]=b[Je++]);return Rr}function nc(b,k){var q=-1,ye=b.length;for(k||(k=Fn(ye));++q<ye;)k[q]=b[q];return k}function $c(b,k,q,ye){var Je=!q;q||(q={});for(var Pt=-1,Xt=k.length;++Pt<Xt;){var xn=k[Pt],Nn=ye?ye(q[xn],b[xn],xn,q,b):n;Nn===n&&(Nn=b[xn]),Je?qr(q,xn,Nn):Qt(q,xn,Nn)}return q}function Bg(b,k){return $c(b,Ug(b),k)}function Ec(b,k){return $c(b,gf(b),k)}function hh(b,k){return function(q,ye){var Je=ls(q)?Lc:fr,Pt=k?k():{};return Je(q,b,zi(ye,2),Pt)}}function Sd(b){return In(function(k,q){var ye=-1,Je=q.length,Pt=Je>1?q[Je-1]:n,Xt=Je>2?q[2]:n;for(Pt=b.length>3&&typeof Pt=="function"?(Je--,Pt):n,Xt&&mc(q[0],q[1],Xt)&&(Pt=Je<3?n:Pt,Je=1),k=Cs(k);++ye<Je;){var xn=q[ye];xn&&b(k,xn,ye,Pt)}return k})}function Lm(b,k){return function(q,ye){if(q==null)return q;if(!Tc(q))return b(q,ye);for(var Je=q.length,Pt=k?Je:-1,Xt=Cs(q);(k?Pt--:++Pt<Je)&&ye(Xt[Pt],Pt,Xt)!==!1;);return q}}function pf(b){return function(k,q,ye){for(var Je=-1,Pt=Cs(k),Xt=ye(k),xn=Xt.length;xn--;){var Nn=Xt[b?xn:++Je];if(q(Pt[Nn],Nn,Pt)===!1)break}return k}}function Pm(b,k,q){var ye=k&W,Je=Em(b);function Pt(){var Xt=this&&this!==Ks&&this instanceof Pt?Je:b;return Xt.apply(ye?q:this,arguments)}return Pt}function Sp(b){return function(k){k=oo(k);var q=_l(k)?jo(k):n,ye=q?q[0]:k.charAt(0),Je=q?ql(q,1).join(""):k.slice(1);return ye[b]()+Je}}function Hf(b){return function(k){return il(ob(rc(k).replace(Bi,"")),b,"")}}function Em(b){return function(){var k=arguments;switch(k.length){case 0:return new b;case 1:return new b(k[0]);case 2:return new b(k[0],k[1]);case 3:return new b(k[0],k[1],k[2]);case 4:return new b(k[0],k[1],k[2],k[3]);case 5:return new b(k[0],k[1],k[2],k[3],k[4]);case 6:return new b(k[0],k[1],k[2],k[3],k[4],k[5]);case 7:return new b(k[0],k[1],k[2],k[3],k[4],k[5],k[6])}var q=ka(b.prototype),ye=b.apply(q,k);return Da(ye)?ye:q}}function iy(b,k,q){var ye=Em(b);function Je(){for(var Pt=arguments.length,Xt=Fn(Pt),xn=Pt,Nn=Lp(Je);xn--;)Xt[xn]=arguments[xn];var Er=Pt<3&&Xt[0]!==Nn&&Xt[Pt-1]!==Nn?[]:zo(Xt,Nn);if(Pt-=Er.length,Pt<q)return ay(b,k,Mm,Je.placeholder,n,Xt,Er,n,n,q-Pt);var Mr=this&&this!==Ks&&this instanceof Je?ye:b;return ss(Mr,this,Xt)}return Je}function Y_(b){return function(k,q,ye){var Je=Cs(k);if(!Tc(k)){var Pt=zi(q,3);k=Oe(k),q=function(xn){return Pt(Je[xn],xn,Je)}}var Xt=b(k,q,ye);return Xt>-1?Je[Pt?k[Xt]:Xt]:n}}function Ng(b){return Pl(function(k){var q=k.length,ye=q,Je=qo.prototype.thru;for(b&&k.reverse();ye--;){var Pt=k[ye];if(typeof Pt!="function")throw new Ts(a);if(Je&&!Xt&&Dm(Pt)=="wrapper")var Xt=new qo([],!0)}for(ye=Xt?ye:q;++ye<q;){Pt=k[ye];var xn=Dm(Pt),Nn=xn=="wrapper"?py(Pt):n;Nn&&ya(Nn[0])&&Nn[1]==(we|Q|le|ue)&&!Nn[4].length&&Nn[9]==1?Xt=Xt[Dm(Nn[0])].apply(Xt,Nn[3]):Xt=Pt.length==1&&ya(Pt)?Xt[xn]():Xt.thru(Pt)}return function(){var Er=arguments,Mr=Er[0];if(Xt&&Er.length==1&&ls(Mr))return Xt.plant(Mr).value();for(var Rr=0,ni=q?k[Rr].apply(this,Er):Mr;++Rr<q;)ni=k[Rr].call(this,ni);return ni}})}function Mm(b,k,q,ye,Je,Pt,Xt,xn,Nn,Er){var Mr=k&we,Rr=k&W,ni=k&X,Si=k&(Q|oe),Wi=k&_e,Is=ni?n:Em(b);function Zi(){for(var Vs=arguments.length,Qs=Fn(Vs),ld=Vs;ld--;)Qs[ld]=arguments[ld];if(Si)var gh=Lp(Zi),ud=sl(Qs,gh);if(ye&&(Qs=Cd(Qs,ye,Je,Si)),Pt&&(Qs=Rg(Qs,Pt,Xt,Si)),Vs-=ud,Si&&Vs<Er){var xu=zo(Qs,gh);return ay(b,k,Mm,Zi.placeholder,q,Qs,xu,xn,Nn,Er-Vs)}var Wd=Rr?q:this,tp=ni?Wd[b]:b;return Vs=Qs.length,xn?Qs=Mp(Qs,xn):Wi&&Vs>1&&Qs.reverse(),Mr&&Nn<Vs&&(Qs.length=Nn),this&&this!==Ks&&this instanceof Zi&&(tp=Is||Em(tp)),tp.apply(Wd,Qs)}return Zi}function sy(b,k){return function(q,ye){return at(q,b,k(ye),{})}}function Ld(b,k){return function(q,ye){var Je;if(q===n&&ye===n)return k;if(q!==n&&(Je=q),ye!==n){if(Je===n)return ye;typeof q=="string"||typeof ye=="string"?(q=Ji(q),ye=Ji(ye)):(q=po(q),ye=po(ye)),Je=b(q,ye)}return Je}}function oy(b){return Pl(function(k){return k=os(k,Ri(zi())),In(function(q){var ye=this;return b(k,function(Je){return ss(Je,ye,q)})})})}function mf(b,k){k=k===n?" ":Ji(k);var q=k.length;if(q<2)return q?jn(k,b):k;var ye=jn(k,Ho(b/mi(k)));return _l(k)?ql(jo(ye),0,b).join(""):ye.slice(0,b)}function Fg(b,k,q,ye){var Je=k&W,Pt=Em(b);function Xt(){for(var xn=-1,Nn=arguments.length,Er=-1,Mr=ye.length,Rr=Fn(Mr+Nn),ni=this&&this!==Ks&&this instanceof Xt?Pt:b;++Er<Mr;)Rr[Er]=ye[Er];for(;Nn--;)Rr[Er++]=arguments[++xn];return ss(ni,Je?q:this,Rr)}return Xt}function Tm(b){return function(k,q,ye){return ye&&typeof ye!="number"&&mc(k,q,ye)&&(q=ye=n),k=id(k),q===n?(q=k,k=0):q=id(q),ye=ye===n?k<q?1:-1:id(ye),On(k,q,ye,b)}}function Am(b){return function(k,q){return typeof k=="string"&&typeof q=="string"||(k=kc(k),q=kc(q)),b(k,q)}}function ay(b,k,q,ye,Je,Pt,Xt,xn,Nn,Er){var Mr=k&Q,Rr=Mr?Xt:n,ni=Mr?n:Xt,Si=Mr?Pt:n,Wi=Mr?n:Pt;k|=Mr?le:me,k&=~(Mr?me:le),k&Y||(k&=-4);var Is=[b,k,Je,Si,Rr,Wi,ni,xn,Nn,Er],Zi=q.apply(n,Is);return ya(b)&&r1(Zi,Is),Zi.placeholder=ye,i1(Zi,b,k)}function ly(b){var k=as[b];return function(q,ye){if(q=kc(q),ye=ye==null?0:nt(ps(ye),292),ye&&T(q)){var Je=(oo(q)+"e").split("e"),Pt=k(Je[0]+"e"+(+Je[1]+ye));return Je=(oo(Pt)+"e").split("e"),+(Je[0]+"e"+(+Je[1]-ye))}return k(q)}}var ow=vo&&1/ea(new vo([,-0]))[1]==Se?function(b){return new vo(b)}:mh;function uy(b){return function(k){var q=Zl(k);return q==Ae?gu(k):q==ln?jc(k):yo(k,b(k))}}function Pd(b,k,q,ye,Je,Pt,Xt,xn){var Nn=k&X;if(!Nn&&typeof b!="function")throw new Ts(a);var Er=ye?ye.length:0;if(Er||(k&=-97,ye=Je=n),Xt=Xt===n?Xt:Pe(ps(Xt),0),xn=xn===n?xn:ps(xn),Er-=Je?Je.length:0,k&me){var Mr=ye,Rr=Je;ye=Je=n}var ni=Nn?n:py(b),Si=[b,k,q,ye,Je,Mr,Rr,Pt,Xt,xn];if(ni&&n1(Si,ni),b=Si[0],k=Si[1],q=Si[2],ye=Si[3],Je=Si[4],xn=Si[9]=Si[9]===n?Nn?0:b.length:Pe(Si[9]-Er,0),!xn&&k&(Q|oe)&&(k&=-25),!k||k==W)var Wi=Pm(b,k,q);else k==Q||k==oe?Wi=iy(b,k,xn):(k==le||k==(W|le))&&!Je.length?Wi=Fg(b,k,q,ye):Wi=Mm.apply(n,Si);var Is=ni?Sr:r1;return i1(Is(Wi,Si),b,k)}function cy(b,k,q,ye){return b===n||gc(b,Ga[q])&&!Ui.call(ye,q)?k:b}function X_(b,k,q,ye,Je,Pt){return Da(b)&&Da(k)&&(Pt.set(k,b),Qe(b,k,n,X_,Pt),Pt.delete(k)),b}function hy(b){return Yf(b)?n:b}function dy(b,k,q,ye,Je,Pt){var Xt=q&R,xn=b.length,Nn=k.length;if(xn!=Nn&&!(Xt&&Nn>xn))return!1;var Er=Pt.get(b),Mr=Pt.get(k);if(Er&&Mr)return Er==k&&Mr==b;var Rr=-1,ni=!0,Si=q&z?new ie:n;for(Pt.set(b,k),Pt.set(k,b);++Rr<xn;){var Wi=b[Rr],Is=k[Rr];if(ye)var Zi=Xt?ye(Is,Wi,Rr,k,b,Pt):ye(Wi,Is,Rr,b,k,Pt);if(Zi!==n){if(Zi)continue;ni=!1;break}if(Si){if(!J(k,function(Vs,Qs){if(!mu(Si,Qs)&&(Wi===Vs||Je(Wi,Vs,q,ye,Pt)))return Si.push(Qs)})){ni=!1;break}}else if(!(Wi===Is||Je(Wi,Is,q,ye,Pt))){ni=!1;break}}return Pt.delete(b),Pt.delete(k),ni}function fy(b,k,q,ye,Je,Pt,Xt){switch(q){case zr:if(b.byteLength!=k.byteLength||b.byteOffset!=k.byteOffset)return!1;b=b.buffer,k=k.buffer;case Dr:return!(b.byteLength!=k.byteLength||!Pt(new xl(b),new xl(k)));case Mt:case wt:case Be:return gc(+b,+k);case yn:return b.name==k.name&&b.message==k.message;case an:case vn:return b==k+"";case Ae:var xn=gu;case ln:var Nn=ye&R;if(xn||(xn=ea),b.size!=k.size&&!Nn)return!1;var Er=Xt.get(b);if(Er)return Er==k;ye|=z,Xt.set(b,k);var Mr=dy(xn(b),xn(k),ye,Je,Pt,Xt);return Xt.delete(b),Mr;case qn:if(xs)return xs.call(b)==xs.call(k)}return!1}function km(b,k,q,ye,Je,Pt){var Xt=q&R,xn=zg(b),Nn=xn.length,Er=zg(k),Mr=Er.length;if(Nn!=Mr&&!Xt)return!1;for(var Rr=Nn;Rr--;){var ni=xn[Rr];if(!(Xt?ni in k:Ui.call(k,ni)))return!1}var Si=Pt.get(b),Wi=Pt.get(k);if(Si&&Wi)return Si==k&&Wi==b;var Is=!0;Pt.set(b,k),Pt.set(k,b);for(var Zi=Xt;++Rr<Nn;){ni=xn[Rr];var Vs=b[ni],Qs=k[ni];if(ye)var ld=Xt?ye(Qs,Vs,ni,k,b,Pt):ye(Vs,Qs,ni,b,k,Pt);if(!(ld===n?Vs===Qs||Je(Vs,Qs,q,ye,Pt):ld)){Is=!1;break}Zi||(Zi=ni=="constructor")}if(Is&&!Zi){var gh=b.constructor,ud=k.constructor;gh!=ud&&"constructor"in b&&"constructor"in k&&!(typeof gh=="function"&&gh instanceof gh&&typeof ud=="function"&&ud instanceof ud)&&(Is=!1)}return Pt.delete(b),Pt.delete(k),Is}function Pl(b){return $d(Wf(b,n,Ly),b+"")}function zg(b){return Nt(b,Oe,Ug)}function Im(b){return Nt(b,ft,gf)}var py=Ss?function(b){return Ss.get(b)}:mh;function Dm(b){for(var k=b.name+"",q=ma[k],ye=Ui.call(ma,k)?q.length:0;ye--;){var Je=q[ye],Pt=Je.func;if(Pt==null||Pt==b)return Je.name}return k}function Lp(b){var k=Ui.call(dt,"placeholder")?dt:b;return k.placeholder}function zi(){var b=dt.iteratee||s0;return b=b===s0?$:b,arguments.length?b(arguments[0],arguments[1]):b}function jg(b,k){var q=b.__data__;return dw(k)?q[typeof k=="string"?"string":"hash"]:q.map}function my(b){for(var k=Oe(b),q=k.length;q--;){var ye=k[q],Je=b[ye];k[q]=[ye,Je,Om(Je)]}return k}function Ud(b,k){var q=_o(b,k);return g(q)?q:n}function gy(b){var k=Ui.call(b,$l),q=b[$l];try{b[$l]=n;var ye=!0}catch{}var Je=bs.call(b);return ye&&(k?b[$l]=q:delete b[$l]),Je}var Ug=Gl?function(b){return b==null?[]:(b=Cs(b),Va(Gl(b),function(k){return ks.call(b,k)}))}:h5,gf=Gl?function(b){for(var k=[];b;)ca(k,Ug(b)),b=wl(b);return k}:h5,Zl=qt;(Vr&&Zl(new Vr(new ArrayBuffer(1)))!=zr||Jr&&Zl(new Jr)!=Ae||Vi&&Zl(Vi.resolve())!=Dt||vo&&Zl(new vo)!=ln||Js&&Zl(new Js)!=cr)&&(Zl=function(b){var k=qt(b),q=k==ot?b.constructor:n,ye=q?_f(q):"";if(ye)switch(ye){case lh:return zr;case Cl:return Ae;case Sl:return Dt;case qa:return ln;case Xh:return cr}return k});function aw(b,k,q){for(var ye=-1,Je=q.length;++ye<Je;){var Pt=q[ye],Xt=Pt.size;switch(Pt.type){case"drop":b+=Xt;break;case"dropRight":k-=Xt;break;case"take":k=nt(k,b+Xt);break;case"takeRight":b=Pe(b,k-Xt);break}}return{start:b,end:k}}function lw(b){var k=b.match(pn);return k?k[1].split(Ut):[]}function J_(b,k,q){k=ul(k,b);for(var ye=-1,Je=k.length,Pt=!1;++ye<Je;){var Xt=nd(k[ye]);if(!(Pt=b!=null&&q(b,Xt)))break;b=b[Xt]}return Pt||++ye!=Je?Pt:(Je=b==null?0:b.length,!!Je&&Kf(Je)&&Vd(Xt,Je)&&(ls(b)||xf(b)))}function uw(b){var k=b.length,q=new b.constructor(k);return k&&typeof b[0]=="string"&&Ui.call(b,"index")&&(q.index=b.index,q.input=b.input),q}function Q_(b){return typeof b.constructor=="function"&&!yf(b)?ka(wl(b)):{}}function cw(b,k,q){var ye=b.constructor;switch(k){case Dr:return ch(b);case Mt:case wt:return new ye(+b);case zr:return td(b,q);case Ht:case tn:case Kt:case Yn:case ir:case Fr:case Ft:case je:case Ze:return ga(b,q);case Ae:return new ye;case Be:case vn:return new ye(b);case an:return oa(b);case ln:return new ye;case qn:return Io(b)}}function hw(b,k){var q=k.length;if(!q)return b;var ye=q-1;return k[ye]=(q>1?"& ":"")+k[ye],k=k.join(q>2?", ":" "),b.replace(Cn,`{
/* [wrapped with `+k+`] */
`)}function yy(b){return ls(b)||xf(b)||!!($o&&b&&b[$o])}function Vd(b,k){var q=typeof b;return k=k??Le,!!k&&(q=="number"||q!="symbol"&&pi.test(b))&&b>-1&&b%1==0&&b<k}function mc(b,k,q){if(!Da(q))return!1;var ye=typeof k;return(ye=="number"?Tc(q)&&Vd(k,q.length):ye=="string"&&k in q)?gc(q[k],b):!1}function qf(b,k){if(ls(b))return!1;var q=typeof b;return q=="number"||q=="symbol"||q=="boolean"||b==null||Gc(b)?!0:Yt.test(b)||!Lr.test(b)||k!=null&&b in Cs(k)}function dw(b){var k=typeof b;return k=="string"||k=="number"||k=="symbol"||k=="boolean"?b!=="__proto__":b===null}function ya(b){var k=Dm(b),q=dt[k];if(typeof q!="function"||!(k in Ni.prototype))return!1;if(b===q)return!0;var ye=py(q);return!!ye&&b===ye[0]}function Pp(b){return!!Uo&&Uo in b}var e1=ll?fh:d5;function yf(b){var k=b&&b.constructor,q=typeof k=="function"&&k.prototype||Ga;return b===q}function Om(b){return b===b&&!Da(b)}function Ep(b,k){return function(q){return q==null?!1:q[b]===k&&(k!==n||b in Cs(q))}}function t1(b){var k=Xg(b,function(ye){return q.size===m&&q.clear(),ye}),q=k.cache;return k}function n1(b,k){var q=b[1],ye=k[1],Je=q|ye,Pt=Je<(W|X|we),Xt=ye==we&&q==Q||ye==we&&q==ue&&b[7].length<=k[8]||ye==(we|ue)&&k[7].length<=k[8]&&q==Q;if(!(Pt||Xt))return b;ye&W&&(b[2]=k[2],Je|=q&W?0:Y);var xn=k[3];if(xn){var Nn=b[3];b[3]=Nn?Cd(Nn,xn,k[4]):xn,b[4]=Nn?zo(b[3],_):k[4]}return xn=k[5],xn&&(Nn=b[5],b[5]=Nn?Rg(Nn,xn,k[6]):xn,b[6]=Nn?zo(b[5],_):k[6]),xn=k[7],xn&&(b[7]=xn),ye&we&&(b[8]=b[8]==null?k[8]:nt(b[8],k[8])),b[9]==null&&(b[9]=k[9]),b[0]=k[0],b[1]=Je,b}function Rm(b){var k=[];if(b!=null)for(var q in Cs(b))k.push(q);return k}function vy(b){return bs.call(b)}function Wf(b,k,q){return k=Pe(k===n?b.length-1:k,0),function(){for(var ye=arguments,Je=-1,Pt=Pe(ye.length-k,0),Xt=Fn(Pt);++Je<Pt;)Xt[Je]=ye[k+Je];Je=-1;for(var xn=Fn(k+1);++Je<k;)xn[Je]=ye[Je];return xn[k]=q(Xt),ss(b,this,xn)}}function Bm(b,k){return k.length<2?b:ci(b,wi(k,0,-1))}function Mp(b,k){for(var q=b.length,ye=nt(k.length,q),Je=nc(b);ye--;){var Pt=k[ye];b[ye]=Vd(Pt,q)?Je[Pt]:n}return b}function Zf(b,k){if(!(k==="constructor"&&typeof b[k]=="function")&&k!="__proto__")return b[k]}var r1=_y(Sr),Tp=Uc||function(b,k){return Ks.setTimeout(b,k)},$d=_y(mr);function i1(b,k,q){var ye=k+"";return $d(b,hw(ye,fw(lw(ye),q)))}function _y(b){var k=0,q=0;return function(){var ye=Jt(),Je=Te-(ye-q);if(q=ye,Je>0){if(++k>=de)return arguments[0]}else k=0;return b.apply(n,arguments)}}function vf(b,k){var q=-1,ye=b.length,Je=ye-1;for(k=k===n?ye:k;++q<k;){var Pt=on(q,Je),Xt=b[Pt];b[Pt]=b[q],b[q]=Xt}return b.length=k,b}var Vg=t1(function(b){var k=[];return b.charCodeAt(0)===46&&k.push(""),b.replace(vt,function(q,ye,Je,Pt){k.push(Je?Pt.replace(Xr,"$1"):ye||q)}),k});function nd(b){if(typeof b=="string"||Gc(b))return b;var k=b+"";return k=="0"&&1/b==-1/0?"-0":k}function _f(b){if(b!=null){try{return Vl.call(b)}catch{}try{return b+""}catch{}}return""}function fw(b,k){return Po(Ne,function(q){var ye="_."+q[0];k&q[1]&&!Jo(b,ye)&&b.push(ye)}),b.sort()}function s1(b){if(b instanceof Ni)return b.clone();var k=new qo(b.__wrapped__,b.__chain__);return k.__actions__=nc(b.__actions__),k.__index__=b.__index__,k.__values__=b.__values__,k}function pw(b,k,q){(q?mc(b,k,q):k===n)?k=1:k=Pe(ps(k),0);var ye=b==null?0:b.length;if(!ye||k<1)return[];for(var Je=0,Pt=0,Xt=Fn(Ho(ye/k));Je<ye;)Xt[Pt++]=wi(b,Je,Je+=k);return Xt}function mw(b){for(var k=-1,q=b==null?0:b.length,ye=0,Je=[];++k<q;){var Pt=b[k];Pt&&(Je[ye++]=Pt)}return Je}function gw(){var b=arguments.length;if(!b)return[];for(var k=Fn(b-1),q=arguments[0],ye=b;ye--;)k[ye-1]=arguments[ye];return ca(ls(q)?nc(q):[q],bt(k,1))}var by=In(function(b,k){return Ml(b)?G(b,bt(k,1,Ml,!0)):[]}),o1=In(function(b,k){var q=Dh(k);return Ml(q)&&(q=n),Ml(b)?G(b,bt(k,1,Ml,!0),zi(q,2)):[]}),xy=In(function(b,k){var q=Dh(k);return Ml(q)&&(q=n),Ml(b)?G(b,bt(k,1,Ml,!0),n,q):[]});function a1(b,k,q){var ye=b==null?0:b.length;return ye?(k=q||k===n?1:ps(k),wi(b,k<0?0:k,ye)):[]}function wy(b,k,q){var ye=b==null?0:b.length;return ye?(k=q||k===n?1:ps(k),k=ye-k,wi(b,0,k<0?0:k)):[]}function l1(b,k){return b&&b.length?Zo(b,zi(k,3),!0,!0):[]}function u1(b,k){return b&&b.length?Zo(b,zi(k,3),!0):[]}function $g(b,k,q,ye){var Je=b==null?0:b.length;return Je?(q&&typeof q!="number"&&mc(b,k,q)&&(q=0,ye=Je),tt(b,k,q,ye)):[]}function Cy(b,k,q){var ye=b==null?0:b.length;if(!ye)return-1;var Je=q==null?0:ps(q);return Je<0&&(Je=Pe(ye+Je,0)),Xn(b,zi(k,3),Je)}function Sy(b,k,q){var ye=b==null?0:b.length;if(!ye)return-1;var Je=ye-1;return q!==n&&(Je=ps(q),Je=q<0?Pe(ye+Je,0):nt(Je,ye-1)),Xn(b,zi(k,3),Je,!0)}function Ly(b){var k=b==null?0:b.length;return k?bt(b,1):[]}function Nm(b){var k=b==null?0:b.length;return k?bt(b,Se):[]}function yw(b,k){var q=b==null?0:b.length;return q?(k=k===n?1:ps(k),bt(b,k)):[]}function Py(b){for(var k=-1,q=b==null?0:b.length,ye={};++k<q;){var Je=b[k];ye[Je[0]]=Je[1]}return ye}function Ap(b){return b&&b.length?b[0]:n}function Ey(b,k,q){var ye=b==null?0:b.length;if(!ye)return-1;var Je=q==null?0:ps(q);return Je<0&&(Je=Pe(ye+Je,0)),wr(b,k,Je)}function vw(b){var k=b==null?0:b.length;return k?wi(b,0,-1):[]}var _w=In(function(b){var k=os(b,ju);return k.length&&k[0]===b[0]?Ge(k):[]}),c1=In(function(b){var k=Dh(b),q=os(b,ju);return k===Dh(q)?k=n:q.pop(),q.length&&q[0]===b[0]?Ge(q,zi(k,2)):[]}),h1=In(function(b){var k=Dh(b),q=os(b,ju);return k=typeof k=="function"?k:n,k&&q.pop(),q.length&&q[0]===b[0]?Ge(q,n,k):[]});function bw(b,k){return b==null?"":U.call(b,k)}function Dh(b){var k=b==null?0:b.length;return k?b[k-1]:n}function Fm(b,k,q){var ye=b==null?0:b.length;if(!ye)return-1;var Je=ye;return q!==n&&(Je=ps(q),Je=Je<0?Pe(ye+Je,0):nt(Je,ye-1)),k===k?jl(b,k,Je):Xn(b,Zr,Je,!0)}function d1(b,k){return b&&b.length?Ct(b,ps(k)):n}var xw=In(f1);function f1(b,k){return b&&b.length&&k&&k.length?en(b,k):b}function ww(b,k,q){return b&&b.length&&k&&k.length?en(b,k,zi(q,2)):b}function Cw(b,k,q){return b&&b.length&&k&&k.length?en(b,k,n,q):b}var Sw=Pl(function(b,k){var q=b==null?0:b.length,ye=Ur(b,k);return mn(b,os(k,function(Je){return Vd(Je,q)?+Je:Je}).sort(Do)),ye});function Lw(b,k){var q=[];if(!(b&&b.length))return q;var ye=-1,Je=[],Pt=b.length;for(k=zi(k,3);++ye<Pt;){var Xt=b[ye];k(Xt,ye,b)&&(q.push(Xt),Je.push(ye))}return mn(b,Je),q}function Gg(b){return b==null?b:ar.call(b)}function My(b,k,q){var ye=b==null?0:b.length;return ye?(q&&typeof q!="number"&&mc(b,k,q)?(k=0,q=ye):(k=k==null?0:ps(k),q=q===n?ye:ps(q)),wi(b,k,q)):[]}function p1(b,k){return Os(b,k)}function m1(b,k,q){return Rs(b,k,zi(q,2))}function g1(b,k){var q=b==null?0:b.length;if(q){var ye=Os(b,k);if(ye<q&&gc(b[ye],k))return ye}return-1}function Pw(b,k){return Os(b,k,!0)}function Hg(b,k,q){return Rs(b,k,zi(q,2),!0)}function Ew(b,k){var q=b==null?0:b.length;if(q){var ye=Os(b,k,!0)-1;if(gc(b[ye],k))return ye}return-1}function y1(b){return b&&b.length?fo(b):[]}function Mw(b,k){return b&&b.length?fo(b,zi(k,2)):[]}function Tw(b){var k=b==null?0:b.length;return k?wi(b,1,k):[]}function Aw(b,k,q){return b&&b.length?(k=q||k===n?1:ps(k),wi(b,0,k<0?0:k)):[]}function v1(b,k,q){var ye=b==null?0:b.length;return ye?(k=q||k===n?1:ps(k),k=ye-k,wi(b,k<0?0:k,ye)):[]}function kw(b,k){return b&&b.length?Zo(b,zi(k,3),!1,!0):[]}function Iw(b,k){return b&&b.length?Zo(b,zi(k,3)):[]}var zm=In(function(b){return hs(bt(b,1,Ml,!0))}),_1=In(function(b){var k=Dh(b);return Ml(k)&&(k=n),hs(bt(b,1,Ml,!0),zi(k,2))}),Ty=In(function(b){var k=Dh(b);return k=typeof k=="function"?k:n,hs(bt(b,1,Ml,!0),n,k)});function b1(b){return b&&b.length?hs(b):[]}function El(b,k){return b&&b.length?hs(b,zi(k,2)):[]}function Ay(b,k){return k=typeof k=="function"?k:n,b&&b.length?hs(b,n,k):[]}function ky(b){if(!(b&&b.length))return[];var k=0;return b=Va(b,function(q){if(Ml(q))return k=Pe(q.length,k),!0}),co(k,function(q){return os(b,Pi(q))})}function Iy(b,k){if(!(b&&b.length))return[];var q=ky(b);return k==null?q:os(q,function(ye){return ss(k,n,ye)})}var Dy=In(function(b,k){return Ml(b)?G(b,k):[]}),Oy=In(function(b){return Wa(Va(b,Ml))}),Dw=In(function(b){var k=Dh(b);return Ml(k)&&(k=n),Wa(Va(b,Ml),zi(k,2))}),Ow=In(function(b){var k=Dh(b);return k=typeof k=="function"?k:n,Wa(Va(b,Ml),n,k)}),Rw=In(ky);function Bw(b,k){return Hl(b||[],k||[],Qt)}function x1(b,k){return Hl(b||[],k||[],Or)}var Mc=In(function(b){var k=b.length,q=k>1?b[k-1]:n;return q=typeof q=="function"?(b.pop(),q):n,Iy(b,q)});function qg(b){var k=dt(b);return k.__chain__=!0,k}function w1(b,k){return k(b),b}function rd(b,k){return k(b)}var Wg=Pl(function(b){var k=b.length,q=k?b[0]:0,ye=this.__wrapped__,Je=function(Pt){return Ur(Pt,b)};return k>1||this.__actions__.length||!(ye instanceof Ni)||!Vd(q)?this.thru(Je):(ye=ye.slice(q,+q+(k?1:0)),ye.__actions__.push({func:rd,args:[Je],thisArg:n}),new qo(ye,this.__chain__).thru(function(Pt){return k&&!Pt.length&&Pt.push(n),Pt}))});function jm(){return qg(this)}function kp(){return new qo(this.value(),this.__chain__)}function Zg(){this.__values__===n&&(this.__values__=Rp(this.value()));var b=this.__index__>=this.__values__.length,k=b?n:this.__values__[this.__index__++];return{done:b,value:k}}function Kg(){return this}function Nw(b){for(var k,q=this;q instanceof Vc;){var ye=s1(q);ye.__index__=0,ye.__values__=n,k?Je.__wrapped__=ye:k=ye;var Je=ye;q=q.__wrapped__}return Je.__wrapped__=b,k}function Fw(){var b=this.__wrapped__;if(b instanceof Ni){var k=b;return this.__actions__.length&&(k=new Ni(this)),k=k.reverse(),k.__actions__.push({func:rd,args:[Gg],thisArg:n}),new qo(k,this.__chain__)}return this.thru(Gg)}function C1(){return bo(this.__wrapped__,this.__actions__)}var S1=hh(function(b,k,q){Ui.call(b,q)?++b[q]:qr(b,q,1)});function zw(b,k,q){var ye=ls(b)?Du:xe;return q&&mc(b,k,q)&&(k=n),ye(b,zi(k,3))}function L1(b,k){var q=ls(b)?Va:zt;return q(b,zi(k,3))}var P1=Y_(Cy),Ry=Y_(Sy);function By(b,k){return bt(Um(b,k),1)}function jw(b,k){return bt(Um(b,k),Se)}function E1(b,k,q){return q=q===n?1:ps(q),bt(Um(b,k),q)}function M1(b,k){var q=ls(b)?Po:te;return q(b,zi(k,3))}function T1(b,k){var q=ls(b)?Fl:pe;return q(b,zi(k,3))}var Uw=hh(function(b,k,q){Ui.call(b,q)?b[q].push(k):qr(b,q,[k])});function Vw(b,k,q,ye){b=Tc(b)?b:$u(b),q=q&&!ye?ps(q):0;var Je=b.length;return q<0&&(q=Pe(Je+q,0)),n0(b)?q<=Je&&b.indexOf(k,q)>-1:!!Je&&wr(b,k,q)>-1}var $w=In(function(b,k,q){var ye=-1,Je=typeof k=="function",Pt=Tc(b)?Fn(b.length):[];return te(b,function(Xt){Pt[++ye]=Je?ss(k,Xt,q):mt(Xt,k,q)}),Pt}),A1=hh(function(b,k,q){qr(b,q,k)});function Um(b,k){var q=ls(b)?os:Me;return q(b,zi(k,3))}function Vm(b,k,q,ye){return b==null?[]:(ls(k)||(k=k==null?[]:[k]),q=ye?n:q,ls(q)||(q=q==null?[]:[q]),At(b,k,q))}var Ed=hh(function(b,k,q){b[q?0:1].push(k)},function(){return[[],[]]});function bf(b,k,q){var ye=ls(b)?il:js,Je=arguments.length<3;return ye(b,zi(k,4),q,Je,te)}function k1(b,k,q){var ye=ls(b)?uo:js,Je=arguments.length<3;return ye(b,zi(k,4),q,Je,pe)}function Ny(b,k){var q=ls(b)?Va:zt;return q(b,Jg(zi(k,3)))}function Gw(b){var k=ls(b)?Un:sr;return k(b)}function Hw(b,k,q){(q?mc(b,k,q):k===n)?k=1:k=ps(k);var ye=ls(b)?kn:tr;return ye(b,k)}function Yg(b){var k=ls(b)?ur:ti;return k(b)}function Fy(b){if(b==null)return 0;if(Tc(b))return n0(b)?mi(b):b.length;var k=Zl(b);return k==Ae||k==ln?b.size:Z(b).length}function qw(b,k,q){var ye=ls(b)?J:Ei;return q&&mc(b,k,q)&&(k=n),ye(b,zi(k,3))}var zy=In(function(b,k){if(b==null)return[];var q=k.length;return q>1&&mc(b,k[0],k[1])?k=[]:q>2&&mc(k[0],k[1],k[2])&&(k=[k[0]]),At(b,bt(k,1),[])}),Ip=Go||function(){return Ks.Date.now()};function Dp(b,k){if(typeof k!="function")throw new Ts(a);return b=ps(b),function(){if(--b<1)return k.apply(this,arguments)}}function jy(b,k,q){return k=q?n:k,k=b&&k==null?b.length:k,Pd(b,we,n,n,n,n,k)}function Uy(b,k){var q;if(typeof k!="function")throw new Ts(a);return b=ps(b),function(){return--b>0&&(q=k.apply(this,arguments)),b<=1&&(k=n),q}}var $m=In(function(b,k,q){var ye=W;if(q.length){var Je=zo(q,Lp($m));ye|=le}return Pd(b,ye,k,q,Je)}),Vy=In(function(b,k,q){var ye=W|X;if(q.length){var Je=zo(q,Lp(Vy));ye|=le}return Pd(k,ye,b,q,Je)});function Gm(b,k,q){k=q?n:k;var ye=Pd(b,Q,n,n,n,n,n,k);return ye.placeholder=Gm.placeholder,ye}function $y(b,k,q){k=q?n:k;var ye=Pd(b,oe,n,n,n,n,n,k);return ye.placeholder=$y.placeholder,ye}function I1(b,k,q){var ye,Je,Pt,Xt,xn,Nn,Er=0,Mr=!1,Rr=!1,ni=!0;if(typeof b!="function")throw new Ts(a);k=kc(k)||0,Da(q)&&(Mr=!!q.leading,Rr="maxWait"in q,Pt=Rr?Pe(kc(q.maxWait)||0,k):Pt,ni="trailing"in q?!!q.trailing:ni);function Si(xu){var Wd=ye,tp=Je;return ye=Je=n,Er=xu,Xt=b.apply(tp,Wd),Xt}function Wi(xu){return Er=xu,xn=Tp(Vs,k),Mr?Si(xu):Xt}function Is(xu){var Wd=xu-Nn,tp=xu-Er,yS=k-Wd;return Rr?nt(yS,Pt-tp):yS}function Zi(xu){var Wd=xu-Nn,tp=xu-Er;return Nn===n||Wd>=k||Wd<0||Rr&&tp>=Pt}function Vs(){var xu=Ip();if(Zi(xu))return Qs(xu);xn=Tp(Vs,Is(xu))}function Qs(xu){return xn=n,ni&&ye?Si(xu):(ye=Je=n,Xt)}function ld(){xn!==n&&Wl(xn),Er=0,ye=Nn=Je=xn=n}function gh(){return xn===n?Xt:Qs(Ip())}function ud(){var xu=Ip(),Wd=Zi(xu);if(ye=arguments,Je=this,Nn=xu,Wd){if(xn===n)return Wi(Nn);if(Rr)return Wl(xn),xn=Tp(Vs,k),Si(Nn)}return xn===n&&(xn=Tp(Vs,k)),Xt}return ud.cancel=ld,ud.flush=gh,ud}var Ww=In(function(b,k){return F(b,1,k)}),D1=In(function(b,k,q){return F(b,kc(k)||0,q)});function Zw(b){return Pd(b,_e)}function Xg(b,k){if(typeof b!="function"||k!=null&&typeof k!="function")throw new Ts(a);var q=function(){var ye=arguments,Je=k?k.apply(this,ye):ye[0],Pt=q.cache;if(Pt.has(Je))return Pt.get(Je);var Xt=b.apply(this,ye);return q.cache=Pt.set(Je,Xt)||Pt,Xt};return q.cache=new(Xg.Cache||vu),q}Xg.Cache=vu;function Jg(b){if(typeof b!="function")throw new Ts(a);return function(){var k=arguments;switch(k.length){case 0:return!b.call(this);case 1:return!b.call(this,k[0]);case 2:return!b.call(this,k[0],k[1]);case 3:return!b.call(this,k[0],k[1],k[2])}return!b.apply(this,k)}}function Kw(b){return Uy(2,b)}var Yw=Qh(function(b,k){k=k.length==1&&ls(k[0])?os(k[0],Ri(zi())):os(bt(k,1),Ri(zi()));var q=k.length;return In(function(ye){for(var Je=-1,Pt=nt(ye.length,q);++Je<Pt;)ye[Je]=k[Je].call(this,ye[Je]);return ss(b,this,ye)})}),Hm=In(function(b,k){var q=zo(k,Lp(Hm));return Pd(b,le,n,k,q)}),Gd=In(function(b,k){var q=zo(k,Lp(Gd));return Pd(b,me,n,k,q)}),O1=Pl(function(b,k){return Pd(b,ue,n,n,n,k)});function R1(b,k){if(typeof b!="function")throw new Ts(a);return k=k===n?k:ps(k),In(b,k)}function B1(b,k){if(typeof b!="function")throw new Ts(a);return k=k==null?0:Pe(ps(k),0),In(function(q){var ye=q[k],Je=ql(q,0,k);return ye&&ca(Je,ye),ss(b,this,Je)})}function N1(b,k,q){var ye=!0,Je=!0;if(typeof b!="function")throw new Ts(a);return Da(q)&&(ye="leading"in q?!!q.leading:ye,Je="trailing"in q?!!q.trailing:Je),I1(b,k,{leading:ye,maxWait:k,trailing:Je})}function F1(b){return jy(b,1)}function Gy(b,k){return Hm(tc(k),b)}function z1(){if(!arguments.length)return[];var b=arguments[0];return ls(b)?b:[b]}function qm(b){return y(b,C)}function j1(b,k){return k=typeof k=="function"?k:n,y(b,C,k)}function Hy(b){return y(b,w|C)}function U1(b,k){return k=typeof k=="function"?k:n,y(b,w|C,k)}function dh(b,k){return k==null||I(b,k,Oe(k))}function gc(b,k){return b===k||b!==b&&k!==k}var V1=Am(gn),$1=Am(function(b,k){return b>=k}),xf=_t(function(){return arguments}())?_t:function(b){return va(b)&&Ui.call(b,"callee")&&!ks.call(b,"callee")},ls=Fn.isArray,G1=Fo?Ri(Fo):St;function Tc(b){return b!=null&&Kf(b.length)&&!fh(b)}function Ml(b){return va(b)&&Tc(b)}function H1(b){return b===!0||b===!1||va(b)&&qt(b)==Mt}var Ac=p||d5,q1=Ea?Ri(Ea):Lt;function W1(b){return va(b)&&b.nodeType===1&&!Yf(b)}function Z1(b){if(b==null)return!0;if(Tc(b)&&(ls(b)||typeof b=="string"||typeof b.splice=="function"||Ac(b)||Xf(b)||xf(b)))return!b.length;var k=Zl(b);if(k==Ae||k==ln)return!b.size;if(yf(b))return!Z(b).length;for(var q in b)if(Ui.call(b,q))return!1;return!0}function K1(b,k){return sn(b,k)}function Xw(b,k,q){q=typeof q=="function"?q:n;var ye=q?q(b,k):n;return ye===n?sn(b,k,n,q):!!ye}function qy(b){if(!va(b))return!1;var k=qt(b);return k==yn||k==rn||typeof b.message=="string"&&typeof b.name=="string"&&!Yf(b)}function Y1(b){return typeof b=="number"&&T(b)}function fh(b){if(!Da(b))return!1;var k=qt(b);return k==Pn||k==De||k==lt||k==Zt}function Wy(b){return typeof b=="number"&&b==ps(b)}function Kf(b){return typeof b=="number"&&b>-1&&b%1==0&&b<=Le}function Da(b){var k=typeof b;return b!=null&&(k=="object"||k=="function")}function va(b){return b!=null&&typeof b=="object"}var Wm=vs?Ri(vs):s;function Qg(b,k){return b===k||c(b,k,my(k))}function Jw(b,k,q){return q=typeof q=="function"?q:n,c(b,k,my(k),q)}function Qw(b){return Hd(b)&&b!=+b}function e5(b){if(e1(b))throw new ii(l);return g(b)}function Op(b){return b===null}function Uu(b){return b==null}function Hd(b){return typeof b=="number"||va(b)&&qt(b)==Be}function Yf(b){if(!va(b)||qt(b)!=ot)return!1;var k=wl(b);if(k===null)return!0;var q=Ui.call(k,"constructor")&&k.constructor;return typeof q=="function"&&q instanceof q&&Vl.call(q)==oi}var e0=pu?Ri(pu):x;function X1(b){return Wy(b)&&b>=-9007199254740991&&b<=Le}var t0=Ma?Ri(Ma):A;function n0(b){return typeof b=="string"||!ls(b)&&va(b)&&qt(b)==vn}function Gc(b){return typeof b=="symbol"||va(b)&&qt(b)==qn}var Xf=Qu?Ri(Qu):N;function t5(b){return b===n}function J1(b){return va(b)&&Zl(b)==cr}function Zy(b){return va(b)&&qt(b)==pr}var Ky=Am(fe),Q1=Am(function(b,k){return b<=k});function Rp(b){if(!b)return[];if(Tc(b))return n0(b)?jo(b):nc(b);if(vi&&b[vi])return Ta(b[vi]());var k=Zl(b),q=k==Ae?gu:k==ln?ea:$u;return q(b)}function id(b){if(!b)return b===0?b:0;if(b=kc(b),b===Se||b===-1/0){var k=b<0?-1:1;return k*ze}return b===b?b:0}function ps(b){var k=id(b),q=k%1;return k===k?q?k-q:k:0}function r0(b){return b?ei(ps(b),0,pt):0}function kc(b){if(typeof b=="number")return b;if(Gc(b))return He;if(Da(b)){var k=typeof b.valueOf=="function"?b.valueOf():b;b=Da(k)?k+"":k}if(typeof b!="string")return b===0?b:+b;b=$a(b);var q=As.test(b);return q||Qa.test(b)?Iu(b.slice(2),q?2:8):Pr.test(b)?He:+b}function Bp(b){return $c(b,ft(b))}function Yy(b){return b?ei(ps(b),-9007199254740991,Le):b===0?b:0}function oo(b){return b==null?"":Ji(b)}var Xy=Sd(function(b,k){if(yf(k)||Tc(k)){$c(k,Oe(k),b);return}for(var q in k)Ui.call(k,q)&&Qt(b,q,k[q])}),eb=Sd(function(b,k){$c(k,ft(k),b)}),h=Sd(function(b,k,q,ye){$c(k,ft(k),b,ye)}),u=Sd(function(b,k,q,ye){$c(k,Oe(k),b,ye)}),d=Pl(Ur);function v(b,k){var q=ka(b);return k==null?q:Cr(q,k)}var P=In(function(b,k){b=Cs(b);var q=-1,ye=k.length,Je=ye>2?k[2]:n;for(Je&&mc(k[0],k[1],Je)&&(ye=1);++q<ye;)for(var Pt=k[q],Xt=ft(Pt),xn=-1,Nn=Xt.length;++xn<Nn;){var Er=Xt[xn],Mr=b[Er];(Mr===n||gc(Mr,Ga[Er])&&!Ui.call(b,Er))&&(b[Er]=Pt[Er])}return b}),D=In(function(b){return b.push(n,X_),ss(Wn,n,b)});function O(b,k){return An(b,zi(k,3),hr)}function j(b,k){return An(b,zi(k,3),Ir)}function K(b,k){return b==null?b:dn(b,zi(k,3),ft)}function ee(b,k){return b==null?b:zn(b,zi(k,3),ft)}function ce(b,k){return b&&hr(b,zi(k,3))}function ve(b,k){return b&&Ir(b,zi(k,3))}function Re(b){return b==null?[]:Br(b,Oe(b))}function Ue(b){return b==null?[]:Br(b,ft(b))}function qe(b,k,q){var ye=b==null?n:ci(b,k);return ye===n?q:ye}function st(b,k){return b!=null&&J_(b,k,Gn)}function xt(b,k){return b!=null&&J_(b,k,Mn)}var It=sy(function(b,k,q){k!=null&&typeof k.toString!="function"&&(k=bs.call(k)),b[k]=q},ev(ic)),fn=sy(function(b,k,q){k!=null&&typeof k.toString!="function"&&(k=bs.call(k)),Ui.call(b,k)?b[k].push(q):b[k]=[q]},zi),$t=In(mt);function Oe(b){return Tc(b)?Vn(b):Z(b)}function ft(b){return Tc(b)?Vn(b,!0):re(b)}function Wt(b,k){var q={};return k=zi(k,3),hr(b,function(ye,Je,Pt){qr(q,k(ye,Je,Pt),ye)}),q}function $n(b,k){var q={};return k=zi(k,3),hr(b,function(ye,Je,Pt){qr(q,Je,k(ye,Je,Pt))}),q}var _r=Sd(function(b,k,q){Qe(b,k,q)}),Wn=Sd(function(b,k,q,ye){Qe(b,k,q,ye)}),rr=Pl(function(b,k){var q={};if(b==null)return q;var ye=!1;k=os(k,function(Pt){return Pt=ul(Pt,b),ye||(ye=Pt.length>1),Pt}),$c(b,Im(b),q),ye&&(q=y(q,w|M|C,hy));for(var Je=k.length;Je--;)ko(q,k[Je]);return q});function Ar(b,k){return kr(b,Jg(zi(k)))}var xr=Pl(function(b,k){return b==null?{}:Rt(b,k)});function kr(b,k){if(b==null)return{};var q=os(Im(b),function(ye){return[ye]});return k=zi(k),jt(b,q,function(ye,Je){return k(ye,Je[0])})}function lr(b,k,q){k=ul(k,b);var ye=-1,Je=k.length;for(Je||(Je=1,b=n);++ye<Je;){var Pt=b==null?n:b[nd(k[ye])];Pt===n&&(ye=Je,Pt=q),b=fh(Pt)?Pt.call(b):Pt}return b}function Qr(b,k,q){return b==null?b:Or(b,k,q)}function _i(b,k,q,ye){return ye=typeof ye=="function"?ye:n,b==null?b:Or(b,k,q,ye)}var hi=uy(Oe),si=uy(ft);function ws(b,k,q){var ye=ls(b),Je=ye||Ac(b)||Xf(b);if(k=zi(k,4),q==null){var Pt=b&&b.constructor;Je?q=ye?new Pt:[]:Da(b)?q=fh(Pt)?ka(wl(b)):{}:q={}}return(Je?Po:hr)(b,function(Xt,xn,Nn){return k(q,Xt,xn,Nn)}),q}function _a(b,k){return b==null?!0:ko(b,k)}function Tl(b,k,q){return b==null?b:sa(b,k,tc(q))}function Vu(b,k,q,ye){return ye=typeof ye=="function"?ye:n,b==null?b:sa(b,k,tc(q),ye)}function $u(b){return b==null?[]:Qo(b,Oe(b))}function Ic(b){return b==null?[]:Qo(b,ft(b))}function _u(b,k,q){return q===n&&(q=k,k=n),q!==n&&(q=kc(q),q=q===q?q:0),k!==n&&(k=kc(k),k=k===k?k:0),ei(kc(b),k,q)}function aa(b,k,q){return k=id(k),q===n?(q=k,k=0):q=id(q),b=kc(b),Bn(b,k,q)}function Kl(b,k,q){if(q&&typeof q!="boolean"&&mc(b,k,q)&&(k=q=n),q===n&&(typeof k=="boolean"?(q=k,k=n):typeof b=="boolean"&&(q=b,b=n)),b===n&&k===n?(b=0,k=1):(b=id(b),k===n?(k=b,b=0):k=id(k)),b>k){var ye=b;b=k,k=ye}if(q||b%1||k%1){var Je=Jn();return nt(b+Je*(k-b+du("1e-"+((Je+"").length-1))),k)}return on(b,k)}var bu=Hf(function(b,k,q){return k=k.toLowerCase(),b+(q?Yl(k):k)});function Yl(b){return i0(oo(b).toLowerCase())}function rc(b){return b=oo(b),b&&b.replace(Li,zc).replace(Bl,"")}function ph(b,k,q){b=oo(b),k=Ji(k);var ye=b.length;q=q===n?ye:ei(ps(q),0,ye);var Je=q;return q-=k.length,q>=0&&b.slice(q,Je)==k}function Xl(b){return b=oo(b),b&&cn.test(b)?b.replace(hn,Ou):b}function Dc(b){return b=oo(b),b&&bn.test(b)?b.replace(Tn,"\\$&"):b}var Al=Hf(function(b,k,q){return b+(q?"-":"")+k.toLowerCase()}),Jl=Hf(function(b,k,q){return b+(q?" ":"")+k.toLowerCase()}),Ql=Sp("toLowerCase");function cl(b,k,q){b=oo(b),k=ps(k);var ye=k?mi(b):0;if(!k||ye>=k)return b;var Je=(k-ye)/2;return mf(Ao(Je),q)+b+mf(Ho(Je),q)}function Oo(b,k,q){b=oo(b),k=ps(k);var ye=k?mi(b):0;return k&&ye<k?b+mf(k-ye,q):b}function sd(b,k,q){b=oo(b),k=ps(k);var ye=k?mi(b):0;return k&&ye<k?mf(k-ye,q)+b:b}function Np(b,k,q){return q||k==null?k=0:k&&(k=+k),Dn(oo(b).replace(br,""),k||0)}function od(b,k,q){return(q?mc(b,k,q):k===n)?k=1:k=ps(k),jn(oo(b),k)}function n5(){var b=arguments,k=oo(b[0]);return b.length<3?k:k.replace(b[1],b[2])}var Fp=Hf(function(b,k,q){return b+(q?"_":"")+k.toLowerCase()});function Jf(b,k,q){return q&&typeof q!="number"&&mc(b,k,q)&&(k=q=n),q=q===n?pt:q>>>0,q?(b=oo(b),b&&(typeof k=="string"||k!=null&&!e0(k))&&(k=Ji(k),!k&&_l(b))?ql(jo(b),0,q):b.split(k,q)):[]}var zp=Hf(function(b,k,q){return b+(q?" ":"")+i0(k)});function jp(b,k,q){return b=oo(b),q=q==null?0:ei(ps(q),0,b.length),k=Ji(k),b.slice(q,q+k.length)==k}function Up(b,k,q){var ye=dt.templateSettings;q&&mc(b,k,q)&&(k=n),b=oo(b),k=h({},k,ye,cy);var Je=h({},k.imports,ye.imports,cy),Pt=Oe(Je),Xt=Qo(Je,Pt),xn,Nn,Er=0,Mr=k.interpolate||Yi,Rr="__p += '",ni=dc((k.escape||Yi).source+"|"+Mr.source+"|"+(Mr===Qn?ri:Yi).source+"|"+(k.evaluate||Yi).source+"|$","g"),Si="//# sourceURL="+(Ui.call(k,"sourceURL")?(k.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Gi+"]")+`
`;b.replace(ni,function(Zi,Vs,Qs,ld,gh,ud){return Qs||(Qs=ld),Rr+=b.slice(Er,ud).replace(ns,Ru),Vs&&(xn=!0,Rr+=`' +
__e(`+Vs+`) +
'`),gh&&(Nn=!0,Rr+=`';
`+gh+`;
__p += '`),Qs&&(Rr+=`' +
((__t = (`+Qs+`)) == null ? '' : __t) +
'`),Er=ud+Zi.length,Zi}),Rr+=`';
`;var Wi=Ui.call(k,"variable")&&k.variable;if(!Wi)Rr=`with (obj) {
`+Rr+`
}
`;else if(or.test(Wi))throw new ii(o);Rr=(Nn?Rr.replace(et,""):Rr).replace(ct,"$1").replace($e,"$1;"),Rr="function("+(Wi||"obj")+`) {
`+(Wi?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(xn?", __e = _.escape":"")+(Nn?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Rr+`return __p
}`;var Is=ab(function(){return xi(Pt,Si+"return "+Rr).apply(n,Xt)});if(Is.source=Rr,qy(Is))throw Is;return Is}function tb(b){return oo(b).toLowerCase()}function nb(b){return oo(b).toUpperCase()}function rb(b,k,q){if(b=oo(b),b&&(q||k===n))return $a(b);if(!b||!(k=Ji(k)))return b;var ye=jo(b),Je=jo(k),Pt=Eo(ye,Je),Xt=Fc(ye,Je)+1;return ql(ye,Pt,Xt).join("")}function ib(b,k,q){if(b=oo(b),b&&(q||k===n))return b.slice(0,Bu(b)+1);if(!b||!(k=Ji(k)))return b;var ye=jo(b),Je=Fc(ye,jo(k))+1;return ql(ye,0,Je).join("")}function Jy(b,k,q){if(b=oo(b),b&&(q||k===n))return b.replace(br,"");if(!b||!(k=Ji(k)))return b;var ye=jo(b),Je=Eo(ye,jo(k));return ql(ye,Je).join("")}function Qy(b,k){var q=We,ye=he;if(Da(k)){var Je="separator"in k?k.separator:Je;q="length"in k?ps(k.length):q,ye="omission"in k?Ji(k.omission):ye}b=oo(b);var Pt=b.length;if(_l(b)){var Xt=jo(b);Pt=Xt.length}if(q>=Pt)return b;var xn=q-mi(ye);if(xn<1)return ye;var Nn=Xt?ql(Xt,0,xn).join(""):b.slice(0,xn);if(Je===n)return Nn+ye;if(Xt&&(xn+=Nn.length-xn),e0(Je)){if(b.slice(xn).search(Je)){var Er,Mr=Nn;for(Je.global||(Je=dc(Je.source,oo(ai.exec(Je))+"g")),Je.lastIndex=0;Er=Je.exec(Mr);)var Rr=Er.index;Nn=Nn.slice(0,Rr===n?xn:Rr)}}else if(b.indexOf(Ji(Je),xn)!=xn){var ni=Nn.lastIndexOf(Je);ni>-1&&(Nn=Nn.slice(0,ni))}return Nn+ye}function qd(b){return b=oo(b),b&&Ot.test(b)?b.replace(Gt,Nu):b}var sb=Hf(function(b,k,q){return b+(q?" ":"")+k.toUpperCase()}),i0=Sp("toUpperCase");function ob(b,k,q){return b=oo(b),k=q?n:k,k===n?ha(b)?Ul(b):nn(b):b.match(k)||[]}var ab=In(function(b,k){try{return ss(b,n,k)}catch(q){return qy(q)?q:new ii(q)}}),r5=Pl(function(b,k){return Po(k,function(q){q=nd(q),qr(b,q,$m(b[q],b))}),b});function i5(b){var k=b==null?0:b.length,q=zi();return b=k?os(b,function(ye){if(typeof ye[1]!="function")throw new Ts(a);return[q(ye[0]),ye[1]]}):[],In(function(ye){for(var Je=-1;++Je<k;){var Pt=b[Je];if(ss(Pt[0],this,ye))return ss(Pt[1],this,ye)}})}function s5(b){return S(y(b,w))}function ev(b){return function(){return b}}function o5(b,k){return b==null||b!==b?k:b}var a5=Ng(),ad=Ng(!0);function ic(b){return b}function s0(b){return $(typeof b=="function"?b:y(b,w))}function l5(b){return ke(y(b,w))}function u5(b,k){return Ke(b,y(k,w))}var c5=In(function(b,k){return function(q){return mt(q,b,k)}}),sc=In(function(b,k){return function(q){return mt(b,q,k)}});function Oc(b,k,q){var ye=Oe(k),Je=Br(k,ye);q==null&&!(Da(k)&&(Je.length||!ye.length))&&(q=k,k=b,b=this,Je=Br(k,Oe(k)));var Pt=!(Da(q)&&"chain"in q)||!!q.chain,Xt=fh(b);return Po(Je,function(xn){var Nn=k[xn];b[xn]=Nn,Xt&&(b.prototype[xn]=function(){var Er=this.__chain__;if(Pt||Er){var Mr=b(this.__wrapped__),Rr=Mr.__actions__=nc(this.__actions__);return Rr.push({func:Nn,args:arguments,thisArg:b}),Mr.__chain__=Er,Mr}return Nn.apply(b,ca([this.value()],arguments))})}),b}function Qf(){return Ks._===this&&(Ks._=io),this}function mh(){}function ep(b){return b=ps(b),In(function(k){return Ct(k,b)})}var Md=oy(os),H6=oy(Du),q6=oy(J);function gS(b){return qf(b)?Pi(nd(b)):Vt(b)}function W6(b){return function(k){return b==null?n:ci(b,k)}}var Z6=Tm(),K6=Tm(!0);function h5(){return[]}function d5(){return!1}function Y6(){return{}}function X6(){return""}function J6(){return!0}function Q6(b,k){if(b=ps(b),b<1||b>Le)return[];var q=pt,ye=nt(b,pt);k=zi(k),b-=pt;for(var Je=co(ye,k);++q<b;)k(q);return Je}function eD(b){return ls(b)?os(b,nd):Gc(b)?[b]:nc(Vg(oo(b)))}function tD(b){var k=++fa;return oo(b)+k}var nD=Ld(function(b,k){return b+k},0),rD=ly("ceil"),iD=Ld(function(b,k){return b/k},1),sD=ly("floor");function oD(b){return b&&b.length?Fe(b,ic,gn):n}function aD(b,k){return b&&b.length?Fe(b,zi(k,2),gn):n}function lD(b){return fi(b,ic)}function uD(b,k){return fi(b,zi(k,2))}function cD(b){return b&&b.length?Fe(b,ic,fe):n}function hD(b,k){return b&&b.length?Fe(b,zi(k,2),fe):n}var dD=Ld(function(b,k){return b*k},1),fD=ly("round"),pD=Ld(function(b,k){return b-k},0);function mD(b){return b&&b.length?_s(b,ic):0}function gD(b,k){return b&&b.length?_s(b,zi(k,2)):0}return dt.after=Dp,dt.ary=jy,dt.assign=Xy,dt.assignIn=eb,dt.assignInWith=h,dt.assignWith=u,dt.at=d,dt.before=Uy,dt.bind=$m,dt.bindAll=r5,dt.bindKey=Vy,dt.castArray=z1,dt.chain=qg,dt.chunk=pw,dt.compact=mw,dt.concat=gw,dt.cond=i5,dt.conforms=s5,dt.constant=ev,dt.countBy=S1,dt.create=v,dt.curry=Gm,dt.curryRight=$y,dt.debounce=I1,dt.defaults=P,dt.defaultsDeep=D,dt.defer=Ww,dt.delay=D1,dt.difference=by,dt.differenceBy=o1,dt.differenceWith=xy,dt.drop=a1,dt.dropRight=wy,dt.dropRightWhile=l1,dt.dropWhile=u1,dt.fill=$g,dt.filter=L1,dt.flatMap=By,dt.flatMapDeep=jw,dt.flatMapDepth=E1,dt.flatten=Ly,dt.flattenDeep=Nm,dt.flattenDepth=yw,dt.flip=Zw,dt.flow=a5,dt.flowRight=ad,dt.fromPairs=Py,dt.functions=Re,dt.functionsIn=Ue,dt.groupBy=Uw,dt.initial=vw,dt.intersection=_w,dt.intersectionBy=c1,dt.intersectionWith=h1,dt.invert=It,dt.invertBy=fn,dt.invokeMap=$w,dt.iteratee=s0,dt.keyBy=A1,dt.keys=Oe,dt.keysIn=ft,dt.map=Um,dt.mapKeys=Wt,dt.mapValues=$n,dt.matches=l5,dt.matchesProperty=u5,dt.memoize=Xg,dt.merge=_r,dt.mergeWith=Wn,dt.method=c5,dt.methodOf=sc,dt.mixin=Oc,dt.negate=Jg,dt.nthArg=ep,dt.omit=rr,dt.omitBy=Ar,dt.once=Kw,dt.orderBy=Vm,dt.over=Md,dt.overArgs=Yw,dt.overEvery=H6,dt.overSome=q6,dt.partial=Hm,dt.partialRight=Gd,dt.partition=Ed,dt.pick=xr,dt.pickBy=kr,dt.property=gS,dt.propertyOf=W6,dt.pull=xw,dt.pullAll=f1,dt.pullAllBy=ww,dt.pullAllWith=Cw,dt.pullAt=Sw,dt.range=Z6,dt.rangeRight=K6,dt.rearg=O1,dt.reject=Ny,dt.remove=Lw,dt.rest=R1,dt.reverse=Gg,dt.sampleSize=Hw,dt.set=Qr,dt.setWith=_i,dt.shuffle=Yg,dt.slice=My,dt.sortBy=zy,dt.sortedUniq=y1,dt.sortedUniqBy=Mw,dt.split=Jf,dt.spread=B1,dt.tail=Tw,dt.take=Aw,dt.takeRight=v1,dt.takeRightWhile=kw,dt.takeWhile=Iw,dt.tap=w1,dt.throttle=N1,dt.thru=rd,dt.toArray=Rp,dt.toPairs=hi,dt.toPairsIn=si,dt.toPath=eD,dt.toPlainObject=Bp,dt.transform=ws,dt.unary=F1,dt.union=zm,dt.unionBy=_1,dt.unionWith=Ty,dt.uniq=b1,dt.uniqBy=El,dt.uniqWith=Ay,dt.unset=_a,dt.unzip=ky,dt.unzipWith=Iy,dt.update=Tl,dt.updateWith=Vu,dt.values=$u,dt.valuesIn=Ic,dt.without=Dy,dt.words=ob,dt.wrap=Gy,dt.xor=Oy,dt.xorBy=Dw,dt.xorWith=Ow,dt.zip=Rw,dt.zipObject=Bw,dt.zipObjectDeep=x1,dt.zipWith=Mc,dt.entries=hi,dt.entriesIn=si,dt.extend=eb,dt.extendWith=h,Oc(dt,dt),dt.add=nD,dt.attempt=ab,dt.camelCase=bu,dt.capitalize=Yl,dt.ceil=rD,dt.clamp=_u,dt.clone=qm,dt.cloneDeep=Hy,dt.cloneDeepWith=U1,dt.cloneWith=j1,dt.conformsTo=dh,dt.deburr=rc,dt.defaultTo=o5,dt.divide=iD,dt.endsWith=ph,dt.eq=gc,dt.escape=Xl,dt.escapeRegExp=Dc,dt.every=zw,dt.find=P1,dt.findIndex=Cy,dt.findKey=O,dt.findLast=Ry,dt.findLastIndex=Sy,dt.findLastKey=j,dt.floor=sD,dt.forEach=M1,dt.forEachRight=T1,dt.forIn=K,dt.forInRight=ee,dt.forOwn=ce,dt.forOwnRight=ve,dt.get=qe,dt.gt=V1,dt.gte=$1,dt.has=st,dt.hasIn=xt,dt.head=Ap,dt.identity=ic,dt.includes=Vw,dt.indexOf=Ey,dt.inRange=aa,dt.invoke=$t,dt.isArguments=xf,dt.isArray=ls,dt.isArrayBuffer=G1,dt.isArrayLike=Tc,dt.isArrayLikeObject=Ml,dt.isBoolean=H1,dt.isBuffer=Ac,dt.isDate=q1,dt.isElement=W1,dt.isEmpty=Z1,dt.isEqual=K1,dt.isEqualWith=Xw,dt.isError=qy,dt.isFinite=Y1,dt.isFunction=fh,dt.isInteger=Wy,dt.isLength=Kf,dt.isMap=Wm,dt.isMatch=Qg,dt.isMatchWith=Jw,dt.isNaN=Qw,dt.isNative=e5,dt.isNil=Uu,dt.isNull=Op,dt.isNumber=Hd,dt.isObject=Da,dt.isObjectLike=va,dt.isPlainObject=Yf,dt.isRegExp=e0,dt.isSafeInteger=X1,dt.isSet=t0,dt.isString=n0,dt.isSymbol=Gc,dt.isTypedArray=Xf,dt.isUndefined=t5,dt.isWeakMap=J1,dt.isWeakSet=Zy,dt.join=bw,dt.kebabCase=Al,dt.last=Dh,dt.lastIndexOf=Fm,dt.lowerCase=Jl,dt.lowerFirst=Ql,dt.lt=Ky,dt.lte=Q1,dt.max=oD,dt.maxBy=aD,dt.mean=lD,dt.meanBy=uD,dt.min=cD,dt.minBy=hD,dt.stubArray=h5,dt.stubFalse=d5,dt.stubObject=Y6,dt.stubString=X6,dt.stubTrue=J6,dt.multiply=dD,dt.nth=d1,dt.noConflict=Qf,dt.noop=mh,dt.now=Ip,dt.pad=cl,dt.padEnd=Oo,dt.padStart=sd,dt.parseInt=Np,dt.random=Kl,dt.reduce=bf,dt.reduceRight=k1,dt.repeat=od,dt.replace=n5,dt.result=lr,dt.round=fD,dt.runInContext=Ln,dt.sample=Gw,dt.size=Fy,dt.snakeCase=Fp,dt.some=qw,dt.sortedIndex=p1,dt.sortedIndexBy=m1,dt.sortedIndexOf=g1,dt.sortedLastIndex=Pw,dt.sortedLastIndexBy=Hg,dt.sortedLastIndexOf=Ew,dt.startCase=zp,dt.startsWith=jp,dt.subtract=pD,dt.sum=mD,dt.sumBy=gD,dt.template=Up,dt.times=Q6,dt.toFinite=id,dt.toInteger=ps,dt.toLength=r0,dt.toLower=tb,dt.toNumber=kc,dt.toSafeInteger=Yy,dt.toString=oo,dt.toUpper=nb,dt.trim=rb,dt.trimEnd=ib,dt.trimStart=Jy,dt.truncate=Qy,dt.unescape=qd,dt.uniqueId=tD,dt.upperCase=sb,dt.upperFirst=i0,dt.each=M1,dt.eachRight=T1,dt.first=Ap,Oc(dt,function(){var b={};return hr(dt,function(k,q){Ui.call(dt.prototype,q)||(b[q]=k)}),b}(),{chain:!1}),dt.VERSION=r,Po(["bind","bindKey","curry","curryRight","partial","partialRight"],function(b){dt[b].placeholder=dt}),Po(["drop","take"],function(b,k){Ni.prototype[b]=function(q){q=q===n?1:Pe(ps(q),0);var ye=this.__filtered__&&!k?new Ni(this):this.clone();return ye.__filtered__?ye.__takeCount__=nt(q,ye.__takeCount__):ye.__views__.push({size:nt(q,pt),type:b+(ye.__dir__<0?"Right":"")}),ye},Ni.prototype[b+"Right"]=function(q){return this.reverse()[b](q).reverse()}}),Po(["filter","map","takeWhile"],function(b,k){var q=k+1,ye=q==be||q==ne;Ni.prototype[b]=function(Je){var Pt=this.clone();return Pt.__iteratees__.push({iteratee:zi(Je,3),type:q}),Pt.__filtered__=Pt.__filtered__||ye,Pt}}),Po(["head","last"],function(b,k){var q="take"+(k?"Right":"");Ni.prototype[b]=function(){return this[q](1).value()[0]}}),Po(["initial","tail"],function(b,k){var q="drop"+(k?"":"Right");Ni.prototype[b]=function(){return this.__filtered__?new Ni(this):this[q](1)}}),Ni.prototype.compact=function(){return this.filter(ic)},Ni.prototype.find=function(b){return this.filter(b).head()},Ni.prototype.findLast=function(b){return this.reverse().find(b)},Ni.prototype.invokeMap=In(function(b,k){return typeof b=="function"?new Ni(this):this.map(function(q){return mt(q,b,k)})}),Ni.prototype.reject=function(b){return this.filter(Jg(zi(b)))},Ni.prototype.slice=function(b,k){b=ps(b);var q=this;return q.__filtered__&&(b>0||k<0)?new Ni(q):(b<0?q=q.takeRight(-b):b&&(q=q.drop(b)),k!==n&&(k=ps(k),q=k<0?q.dropRight(-k):q.take(k-b)),q)},Ni.prototype.takeRightWhile=function(b){return this.reverse().takeWhile(b).reverse()},Ni.prototype.toArray=function(){return this.take(pt)},hr(Ni.prototype,function(b,k){var q=/^(?:filter|find|map|reject)|While$/.test(k),ye=/^(?:head|last)$/.test(k),Je=dt[ye?"take"+(k=="last"?"Right":""):k],Pt=ye||/^find/.test(k);Je&&(dt.prototype[k]=function(){var Xt=this.__wrapped__,xn=ye?[1]:arguments,Nn=Xt instanceof Ni,Er=xn[0],Mr=Nn||ls(Xt),Rr=function(Vs){var Qs=Je.apply(dt,ca([Vs],xn));return ye&&ni?Qs[0]:Qs};Mr&&q&&typeof Er=="function"&&Er.length!=1&&(Nn=Mr=!1);var ni=this.__chain__,Si=!!this.__actions__.length,Wi=Pt&&!ni,Is=Nn&&!Si;if(!Pt&&Mr){Xt=Is?Xt:new Ni(this);var Zi=b.apply(Xt,xn);return Zi.__actions__.push({func:rd,args:[Rr],thisArg:n}),new qo(Zi,ni)}return Wi&&Is?b.apply(this,xn):(Zi=this.thru(Rr),Wi?ye?Zi.value()[0]:Zi.value():Zi)})}),Po(["pop","push","shift","sort","splice","unshift"],function(b){var k=al[b],q=/^(?:push|sort|unshift)$/.test(b)?"tap":"thru",ye=/^(?:pop|shift)$/.test(b);dt.prototype[b]=function(){var Je=arguments;if(ye&&!this.__chain__){var Pt=this.value();return k.apply(ls(Pt)?Pt:[],Je)}return this[q](function(Xt){return k.apply(ls(Xt)?Xt:[],Je)})}}),hr(Ni.prototype,function(b,k){var q=dt[k];if(q){var ye=q.name+"";Ui.call(ma,ye)||(ma[ye]=[]),ma[ye].push({name:k,func:q})}}),ma[Mm(n,X).name]=[{name:"wrapper",func:n}],Ni.prototype.clone=ec,Ni.prototype.reverse=Ll,Ni.prototype.value=Ia,dt.prototype.at=Wg,dt.prototype.chain=jm,dt.prototype.commit=kp,dt.prototype.next=Zg,dt.prototype.plant=Nw,dt.prototype.reverse=Fw,dt.prototype.toJSON=dt.prototype.valueOf=dt.prototype.value=C1,dt.prototype.first=dt.prototype.head,vi&&(dt.prototype[vi]=Kg),dt},na=ol();ro?((ro.exports=na)._=na,di._=na):Ks._=na}).call(lc)})(Wx,Wx.exports);var BG=Wx.exports;const NG={class:"h-full flex"},FG={class:"flex-1 relative"},zG={key:0,class:"absolute inset-0 flex items-center justify-center bg-gray-50 z-[3000]"},jG={class:"text-center max-w-lg mx-auto p-8"},UG={class:"space-y-4"},VG={class:"map-parent"},$G={class:"map-content flex flex-col h-full"},GG={class:"flex-1 flex flex-col md:flex-row relative"},HG={class:"flex-1 relative"},qG={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center z-[9999] p-4 overflow-y-auto"},WG={class:"bg-white rounded-lg p-6 max-w-2xl w-full my-8 relative"},ZG={class:"flex justify-between items-center mb-4 sticky top-0 bg-white pb-4 border-b"},KG={class:"overflow-y-auto max-h-[calc(100vh-12rem)]"},YG={key:0,class:"space-y-4"},XG={key:0,class:"space-y-2"},JG={class:"grid grid-cols-1 gap-2"},QG=["onClick"],eH={class:"font-medium text-gray-900"},tH={key:1,class:"space-y-2"},nH={class:"flex items-center mb-4"},rH={class:"text-sm text-gray-600"},iH={class:"grid grid-cols-1 gap-2"},sH=["onClick"],oH={class:"font-medium text-gray-900"},aH={key:2,class:"space-y-2"},lH={class:"flex items-center mb-4"},uH={class:"text-sm text-gray-600"},cH={class:"grid grid-cols-1 gap-2"},hH={key:0,class:"text-center py-4"},dH=["onClick"],fH={class:"font-medium text-gray-900"},pH={key:3,class:"space-y-2"},mH={class:"flex items-center mb-4"},gH={class:"text-sm text-gray-600"},yH={class:"grid grid-cols-1 gap-2"},vH=["onClick"],_H={class:"font-medium text-gray-900"},bH={class:"text-sm text-gray-500"},xH={class:"text-xs text-gray-400 mt-1"},wH=["onClick"],CH={key:1,class:"space-y-4"},SH={key:0,class:"space-y-2"},LH={class:"grid grid-cols-1 gap-2"},PH={key:0,class:"text-center py-8"},EH=["onClick"],MH={class:"font-medium text-gray-900"},TH={key:1,class:"space-y-2"},AH={class:"flex items-center mb-4"},kH={class:"text-sm text-gray-600"},IH={class:"grid grid-cols-1 gap-2"},DH=["onClick"],OH={class:"font-medium text-gray-900"},RH={class:"text-sm text-gray-500"},BH={class:"text-xs text-gray-400 mt-1"},NH=["onClick"],FH={key:2,class:"space-y-4"},zH={key:0,class:"space-y-2"},jH={class:"grid grid-cols-1 gap-2"},UH=["onClick"],VH={class:"font-medium text-gray-900"},$H={key:1,class:"space-y-2"},GH={class:"flex items-center mb-4"},HH={class:"text-sm text-gray-600"},qH={class:"grid grid-cols-1 gap-2"},WH={key:0,class:"text-center py-4"},ZH=["onClick"],KH={class:"font-medium text-gray-900"},YH={key:2,class:"space-y-2"},XH={class:"flex items-center mb-4"},JH={class:"text-sm text-gray-600"},QH={class:"grid grid-cols-1 gap-2"},eq=["onClick"],tq={class:"font-medium text-gray-900"},nq={class:"text-sm text-gray-500"},rq={class:"text-xs text-gray-400 mt-1"},iq=["onClick"],sq={key:3,class:"space-y-4"},oq={key:0,class:"text-center py-8"},aq={key:1,class:"space-y-2"},lq=["onClick"],uq={class:"font-medium text-gray-900"},cq={class:"text-sm text-gray-500"},hq={class:"text-xs text-gray-400 mt-1"},dq=["onClick"],fq={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4"},pq={class:"bg-white rounded-lg p-6 max-w-md w-full shadow-xl"},mq={class:"text-center mb-4"},gq={class:"mt-2 text-gray-600"},SP=Ja({__name:"MapView",emits:["shape-selected"],setup(e,{emit:t}){const n=zF(),r=Rn(null),i=Rn(!1),l=CC(),a=C_(),o=yp(),f=Lh(),m=Rn([]),_=Rn({planId:n.query.planId?parseInt(n.query.planId):null,noteId:n.query.noteId?parseInt(n.query.noteId):null,lat:n.query.lat?parseFloat(n.query.lat):null,lng:n.query.lng?parseFloat(n.query.lng):null,tool:n.query.tool||null}),{currentTool:w,selectedShape:M,map:C,initMap:R,setDrawingTool:z,updateShapeStyle:W,updateShapeProperties:X,featureGroup:Y,adjustView:Q,clearActiveControlPoints:oe,isDrawing:le}=h$(),{initMap:me,changeBaseMap:we}=m$(),ue=Rn(!1),_e=Rn(!1),We=Rn(!1),he=Rn(!1),de=Rn(null),Te=Rn(null),be=Rn(null),ae=Rn(!1),ne=Rn(null),Se=Mu(),Le=Rn([]),ze=Rn([]),He=Rn([]),pt=Rn(null),ge=Rn(null),Ie=Rn(null),Ne=Rn(!1),Ve=Rn(!1),it=Rn(!1),lt=Rn(null),Mt=Ai(()=>Se.isSalarie||pt.value?ze.value:[]),wt=Ai(()=>{if(!M.value)return null;const Yt=M.value.properties||{};let vt="unknown";Yt.type?vt=Yt.type:M.value instanceof Uh||M.value instanceof jr.Polygon?vt="Polygon":(M.value instanceof dl||M.value instanceof jr.Polyline&&!(M.value instanceof jr.Polygon))&&(vt="Line"),Yt.type||(M.value.properties||(M.value.properties={}),M.value.properties.type=vt);let Tn;if(Yt.style&&Yt.style.name)Tn=Yt.style.name;else if(Yt.name)Tn=Yt.name;else if(M.value.name)Tn=M.value.name;else{const vr=Object.getOwnPropertyDescriptor(M.value,"name");vr&&vr.value&&(Tn=vr.value);const Cn=["_name","displayName","title"];for(const pn of Cn)if(M.value[pn]){Tn=M.value[pn];break}}Tn&&(M.value.properties||(M.value.properties={}),M.value.properties.name=Tn,M.value.properties.style||(M.value.properties.style={}),M.value.properties.style.name=Tn,M.value.name=Tn,typeof M.value.setName=="function"&&M.value.setName(Tn)),M.value.properties.category||(M.value.properties.category="forages"),M.value.properties.accessLevel||(M.value.properties.accessLevel="visitor");const bn={...Yt,type:vt,name:Tn||M.value.name||Yt.name||void 0,category:M.value.properties.category||"forages",accessLevel:M.value.properties.accessLevel||"visitor"};return{type:vt,properties:bn,layer:M.value,options:M.value.options||{}}});function rn(Yt){const vt=Yt.getCenter(),Tn=Yt.getZoom(),bn={lat:vt.lat,lng:vt.lng,zoom:Tn};document.cookie=`mapState=${JSON.stringify(bn)};max-age=2592000;path=/`}function yn(){const vt=document.cookie.split(";").find(Tn=>Tn.trim().startsWith("mapState="));if(vt)try{return JSON.parse(vt.split("=")[1])}catch(Tn){return console.error("Erreur lors de la lecture du cookie de position:",Tn),null}return null}Rl(async()=>{var Yt,vt;window.addEventListener("resize",Qn);try{if(await l.fetchPlans(),(Se.isAdmin||Se.isEntreprise)&&await tn(),Se.isEntreprise){Ne.value=!0;try{const Ut=await Kr.get("/users/",{params:{role:"SALARIE",entreprise:(Yt=Se.user)==null?void 0:Yt.id}});Le.value=Ut.data}catch(Ut){console.error("Error loading salaries:",Ut),Le.value=[]}finally{Ne.value=!1}}if(Se.isSalarie){Ve.value=!0;try{const Ut=await Se.fetchSalarieVisiteurs(((vt=Se.user)==null?void 0:vt.id)||0);ze.value=Array.isArray(Ut)?Ut:[Ut]}catch(Ut){console.error("Error loading clients:",Ut)}finally{Ve.value=!1}}const Tn=yn(),bn=Tn?[Tn.lat,Tn.lng]:[46.603354,1.888334],br=(Tn==null?void 0:Tn.zoom)??6;if(r.value&&!C.value){const Ut=R(r.value,bn,br);Ut.pm.setLang("fr"),Ut.pm.addControls({rotateMode:!1}),me(Ut),Ut.on("moveend",()=>{rn(Ut)}),window.addEventListener("map-set-location",Hn=>{if(Ut&&Hn.detail){const{lat:or,lng:Xr,zoom:ri}=Hn.detail;Ut.flyTo([or,Xr],ri,{duration:1.5,easeLinearity:.25})}}),Y.value&&(Y.value.on("layeradd",Hn=>{const or=Hn.layer;or&&or._leaflet_id&&m.value.findIndex(ri=>ri.layer&&ri.layer._leaflet_id===or._leaflet_id)===-1&&m.value.push({layer:or,id:or._dbId||or._leaflet_id})}),Y.value.on("layerremove",Hn=>{const or=Hn.layer;if(or&&or._leaflet_id&&!or._dbId&&(!or.properties||or.properties&&!or.properties.type)){const ri=m.value.findIndex(ai=>ai.layer&&ai.layer._leaflet_id===or._leaflet_id);ri!==-1&&m.value.splice(ri,1)}}))}if(_.value.planId)try{await ot(_.value.planId);const Ut=document.querySelector(".map-parent");Ut instanceof HTMLElement&&(Ut.style.display="block"),_.value.lat&&_.value.lng&&C.value&&C.value.flyTo([_.value.lat,_.value.lng],30),_.value.noteId&&Y.value&&setTimeout(()=>{var or;const Hn=((or=Y.value)==null?void 0:or.getLayers())||[];for(const Xr of Hn)if(Xr._dbId===_.value.noteId||Xr.id===_.value.noteId){if(typeof Xr.fire=="function"&&Xr.fire("click"),typeof Xr.bringToFront=="function"&&Xr.bringToFront(),C.value){const ri=typeof Xr.getLatLng=="function"?Xr.getLatLng():[_.value.lat,_.value.lng];C.value.flyTo(ri,18)}break}},1e3),_.value.tool&&z(_.value.tool)}catch(Ut){console.error("[MapView][onMounted] Erreur chargement plan depuis URL:",Ut),await vr()}else await vr();async function vr(){const Ut=localStorage.getItem("lastPlanId");if(Ut)try{await ot(parseInt(Ut));const Hn=document.querySelector(".map-parent");Hn instanceof HTMLElement&&(Hn.style.display="block")}catch(Hn){console.error("[MapView][loadLastPlan] Erreur chargement dernier plan:",Hn),de.value=null,l.clearCurrentPlan(),a.clearCurrentPlan(),Be(),localStorage.removeItem("lastPlanId")}else de.value=null,l.clearCurrentPlan(),a.clearCurrentPlan(),Be()}window.addEventListener("shape:created",Ut=>{const{shape:Hn,type:or,properties:Xr}=Ut.detail;a.addElement(Hn),z("")}),window.addEventListener("geonote:savePlan",()=>{Dt()}),window.addEventListener("geonote:select",Ut=>{if(Ut.detail&&Ut.detail.geoNote){const Hn=Ut.detail.geoNote;M.value=Hn,Sh(()=>{})}}),window.addEventListener("categoriesReactivated",Ut=>{Gt()}),window.addEventListener("shapeTypesReactivated",Ut=>{Gt()});const Cn=Ut=>{if(!Ut||!Ut.note){console.error("[MapView] Erreur: e.note est undefined ou null",Ut);return}const Hn=Ut.note;Te.value={id:Hn.id,title:Hn.title||Hn.name,description:Hn.description,location:Hn.location,columnId:Hn.columnId||o.getDefaultColumn.id,accessLevel:Hn.accessLevel,style:Hn.style||{color:"#3B82F6",weight:2,opacity:1,fillColor:"#3B82F6",fillOpacity:.6,radius:8},order:0,createdAt:Hn.createdAt||new Date().toISOString(),updatedAt:Hn.updatedAt||new Date().toISOString(),comments:Hn.comments||[],photos:Hn.photos||[]},We.value=!0},pn=Ut=>{if(!Ut.detail||!Ut.detail.note){console.error("[MapView] Erreur: event.detail.note est undefined ou null",Ut);return}const Hn=Ut.detail.note;let Xr=Ut.detail.backendId||Hn.backendId;if(!Xr){const ri=m.value.find(ai=>ai.layer===Ut.detail.source);Xr=ri?ri.id:Hn.id}Te.value={id:Xr,leafletId:Hn.id,title:Hn.title||Hn.name,description:Hn.description,location:Hn.location,columnId:Hn.columnId||o.getDefaultColumn.id,accessLevel:Hn.accessLevel,style:Hn.style||{color:"#3B82F6",weight:2,opacity:1,fillColor:"#3B82F6",fillOpacity:.6,radius:8},order:0,createdAt:Hn.createdAt||new Date().toISOString(),updatedAt:Hn.updatedAt||new Date().toISOString(),comments:Hn.comments||[],photos:Hn.photos||[]},We.value=!0};window.addEventListener("geonote:edit",pn),Y.value&&(Y.value.off("note:edit"),Y.value.on("note:edit",Cn))}catch(Tn){console.error("Error during component mount:",Tn),de.value=null,l.clearCurrentPlan(),a.clearCurrentPlan(),Be(),localStorage.removeItem("lastPlanId")}}),mo(()=>a.hasUnsavedChanges,Yt=>{Yt&&de.value&&(l.markUnsavedChanges(),Dt())});let Pn;Rl(()=>{Pn=setInterval(()=>{a.hasUnsavedChanges&&de.value&&Dt()},6e4)}),gd(()=>{clearInterval(Pn)}),mo(()=>l.plans,Yt=>{_e.value&&Ie.value},{deep:!0}),mo(()=>a.filters,(Yt,vt)=>{if(vt){const Tn=JSON.stringify(vt.accessLevels)!==JSON.stringify(Yt.accessLevels),bn=JSON.stringify(vt.categories)!==JSON.stringify(Yt.categories),br=JSON.stringify(vt.shapeTypes)!==JSON.stringify(Yt.shapeTypes);(Tn||bn||br)&&Gt()}else Gt()},{deep:!0});const De=Yt=>{Gt()};Rl(()=>{window.addEventListener("filtersChanged",De)}),gd(()=>{window.removeEventListener("filtersChanged",De)}),mo(()=>a.getFilteredElements,(Yt,vt)=>{Gt()},{deep:!0}),mo(C,async Yt=>{var vt;Yt&&l.currentPlan&&!((vt=Y.value)!=null&&vt.getLayers().length)&&(Be(),await a.loadPlanElements(l.currentPlan.id))}),mo(()=>l.currentPlan,async(Yt,vt)=>{if((Yt==null?void 0:Yt.id)!==(vt==null?void 0:vt.id))try{if(Yt){de.value=Yt;const Tn=document.querySelector(".map-parent");Tn instanceof HTMLElement&&(Tn.style.display="block")}else{de.value=null,Be();const Tn=document.querySelector(".map-parent");Tn instanceof HTMLElement&&(Tn.style.display="none")}}catch(Tn){console.error("[MapView][watch currentPlan] ERREUR:",Tn),de.value=null,Be()}},{immediate:!0}),wm(()=>{C.value&&C.value.off("moveend"),window.removeEventListener("resize",Qn),window.removeEventListener("shape:created",()=>{})});function Ae(){i.value=!i.value}function Be(){Y.value&&(Y.value.eachLayer(Yt=>{var vt;((vt=Yt.properties)==null?void 0:vt.type)==="Note"&&typeof Yt.resetPlanSaveState=="function"&&Yt.resetPlanSaveState()}),Y.value.clearLayers()),m.value=[],oe(),M.value=null,w.value=""}async function Ce(Yt){try{Be(),await a.loadPlanElements(Yt);const vt=l.getPlanById(Yt);if(vt){de.value=vt,l.setCurrentPlan(vt),a.setCurrentPlan(vt.id),localStorage.setItem("lastPlanId",vt.id.toString());try{const bn=(await _c.getNotesByPlan(Yt)).data,br=yp();C.value&&Y.value&&bn.forEach(vr=>{try{if(br.addNote({...vr,id:vr.id,columnId:vr.column,accessLevel:vr.access_level}),vr.location&&vr.location.type==="Point"&&Array.isArray(vr.location.coordinates)&&vr.location.coordinates.length===2){const Cn=bh.fromBackendData({name:vr.title,description:vr.description,location:vr.location,columnId:vr.column,accessLevel:vr.access_level,style:vr.style||{color:vr.color||"#3B82F6",weight:2,opacity:1,fillColor:vr.color||"#3B82F6",fillOpacity:.6,radius:8},category:vr.category||"forages",comments:vr.comments||[],photos:vr.photos||[]});Cn._dbId=vr.id,Y.value.addLayer(Cn),m.value.push({id:vr.id,type:"Note",layer:Cn,properties:Cn.properties})}}catch(Cn){console.error("[MapView][refreshMapWithPlan] Erreur lors de l'ajout de la note géolocalisée:",Cn)}})}catch(Tn){console.error("[MapView][refreshMapWithPlan] Erreur lors du chargement des notes géolocalisées:",Tn)}if(C.value&&Y.value){const Tn=a.getCurrentElements.reduce((Cn,pn)=>(Cn[pn.type_forme]||(Cn[pn.type_forme]=[]),Cn[pn.type_forme].push(pn),Cn),{}),bn=["Note","Polygon","Line"],br=Object.keys(Tn).sort((Cn,pn)=>{const Ut=bn.indexOf(Cn),Hn=bn.indexOf(pn);return(Ut===-1?999:Ut)-(Hn===-1?999:Hn)}),vr=Cn=>{switch(Cn){case"Note":return 20;case"Line":return 10;case"Polygon":return 5;default:return 10}};for(const Cn of br){const pn=Tn[Cn],Ut=vr(Cn);for(let Hn=0;Hn<pn.length;Hn+=Ut){const or=pn.slice(Hn,Hn+Ut);await Promise.all(or.map(async Xr=>{var ai;if(!Y.value||!Xr.data)return;let ri=null;switch(Xr.type_forme){case"Polygon":{const Pr=Xr.data;if(Pr.points&&Pr.points.length>0){const As=Pr.points.map($i=>jr.latLng($i[1],$i[0]));ri=new Uh(As,Pr.style),Pr.name&&(ri.properties={name:Pr.name},ri.name=Pr.name)}break}case"Line":{const Pr=Xr.data;if(Pr.points&&Pr.points.length>0){const As=Pr.points.map($i=>jr.latLng($i[1],$i[0]));ri=new dl(As,Pr.style),Pr.name&&(ri.properties={name:Pr.name},ri.name=Pr.name)}break}case"Note":{const Pr=Xr.data;if(Pr.location&&Array.isArray(Pr.location)&&Pr.location.length===2||Pr.location&&typeof Pr.location=="object"&&Pr.location.type==="Point"&&Array.isArray(Pr.location.coordinates)&&Pr.location.coordinates.length===2)try{Pr.category||(Pr.category="forages"),Pr.accessLevel||(Pr.accessLevel="private");const $i=bh.fromBackendData(Pr);$i._dbId=Xr.id,ri=$i}catch($i){console.error("[MapView][refreshMapWithPlan] Erreur lors de la création de la Note:",$i)}else console.error("[MapView][refreshMapWithPlan] Données invalides pour Note:",Pr);break}}ri&&(ri._dbId=Xr.id,(ai=Y.value)==null||ai.addLayer(ri),m.value.push({id:Xr.id,type:Xr.type_forme,layer:ri,properties:ri.properties}))})),await new Promise(Xr=>requestAnimationFrame(()=>setTimeout(Xr,0)))}}setTimeout(()=>{Q(),C.value&&C.value.invalidateSize({animate:!1,pan:!1})},100)}}else console.error(`Plan ${Yt} introuvable après chargement`);_e.value=!1}catch(vt){throw console.error("Erreur lors du rafraîchissement de la carte:",vt),vt}}async function ot(Yt){var vt;try{if(!l.getPlanById(Yt))try{await Kr.get(`/plans/${Yt}/`)}catch(bn){throw((vt=bn.response)==null?void 0:vt.status)===404&&(console.warn("[MapView][loadPlan] Plan non trouvé - conservation de lastPlanId pour fallback"),de.value=null,l.clearCurrentPlan(),a.clearCurrentPlan(),Be()),bn}await Ce(Yt),_e.value=!1,cr()}catch(Tn){throw console.error("Erreur lors du chargement du plan:",Tn),de.value=null,l.clearCurrentPlan(),a.clearCurrentPlan(),Be(),Tn}}async function Dt(){var Yt;if(!ae.value){if(!de.value||!Y.value){console.warn("Aucun plan actif ou groupe de formes à sauvegarder");return}ae.value=!0,ne.value="saving";try{const vt=[],Tn=new Set(a.getCurrentElements.filter(pn=>pn.id!==void 0).map(pn=>pn.id)),bn=new Set;Y.value.eachLayer(pn=>{var Xr,ri,ai,Pr,As,$i,Qa;let Ut,Hn;const or={color:pn.options.color||"#2b6451",weight:pn.options.weight||3,opacity:pn.options.opacity||1,fillColor:pn.options.fillColor||"#2b6451",fillOpacity:pn.options.fillOpacity||.2,dashArray:pn.options.dashArray||""};if(pn instanceof jr.Polyline&&!(pn instanceof jr.Polygon)){Ut="Line";const pi=pn.getLatLngs(),Li=((Xr=pn.properties)==null?void 0:Xr.category)||"forages",Yi=((ri=pn.properties)==null?void 0:ri.accessLevel)||"visitor";Hn={points:pi.map(ns=>[ns.lng,ns.lat]),name:((ai=pn.properties)==null?void 0:ai.name)||"",category:Li,accessLevel:Yi,style:{...or,_accessLevel:Yi,accessLevel:Yi}}}else if(pn instanceof jr.Polygon){Ut="Polygon";const pi=pn.getLatLngs()[0],Li=((Pr=pn.properties)==null?void 0:Pr.category)||"forages",Yi=((As=pn.properties)==null?void 0:As.accessLevel)||"visitor";Hn={points:pi.map(ns=>[ns.lng,ns.lat]),name:(($i=pn.properties)==null?void 0:$i.name)||"",category:Li,accessLevel:Yi,style:{...or,_accessLevel:Yi,accessLevel:Yi}}}else if(((Qa=pn.properties)==null?void 0:Qa.type)==="Note"){const pi=pn;if(pi._dbId&&typeof pi._dbId=="number"&&bn.add(pi._dbId),typeof pi.saveNote=="function")try{if(pi.properties&&(pi.properties.style||(pi.properties.style={}),pi.properties.accessLevel&&(pi.properties.style._accessLevel=pi.properties.accessLevel,pi.properties.style.accessLevel=pi.properties.accessLevel),pi.properties.style.color)){const Li=pi.properties.style.color;pi.properties.style.color=Li,pi.properties.style.fillColor=Li}de.value&&de.value.id?pi.saveNote(de.value.id):pi.saveNote()}catch(Li){console.error("[savePlan] Erreur lors de la sauvegarde de la note:",Li)}else console.warn("[savePlan] La note ne possède pas de méthode saveNote");Ut=void 0,Hn=void 0}if(Ut&&Hn){let pi=pn._elementId;pn._dbId&&(pi=pn._dbId,typeof pi=="number"&&bn.add(pi)),vt.push({id:pi,type_forme:Ut,data:Hn})}});const br=Array.from(Tn).filter(pn=>!bn.has(pn)),vr=vt.filter(pn=>!pn.id||!br.includes(pn.id));a.elements=vr;const Cn=await a.saveToPlan(de.value.id,{elementsToDelete:br});if(Cn&&((Yt=de.value)!=null&&Yt.id)){const pn=de.value.id;de.value={...de.value,...Cn},l.updatePlanDetails(pn,Cn)}ne.value="success",Y.value&&Y.value.eachLayer(pn=>{var Ut;((Ut=pn.properties)==null?void 0:Ut.type)==="Note"&&typeof pn.resetPlanSaveState=="function"&&pn.resetPlanSaveState()}),setTimeout(()=>{ne.value=null},3e3)}catch(vt){console.error("Erreur lors de la sauvegarde du plan:",vt),ne.value=null}finally{ae.value=!1}}}gd(()=>{Se.user||qn(),l.clearCurrentPlan(),a.clearCurrentPlan(),Y.value&&Y.value.off("note:edit"),window.removeEventListener("geonote:edit",()=>{}),window.removeEventListener("categoriesReactivated",()=>{}),window.removeEventListener("shapeTypesReactivated",()=>{}),window.removeEventListener("shape:created",()=>{}),window.removeEventListener("map-set-location",()=>{})});function Zt(Yt){var vt;if(X(Yt),M.value&&((vt=M.value.properties)==null?void 0:vt.type)==="Note")if(typeof M.value.saveNote=="function")try{if(Yt.category&&(M.value.properties.category=Yt.category),Yt.accessLevel&&(M.value.properties.accessLevel=Yt.accessLevel,M.value.properties.style||(M.value.properties.style={}),M.value.properties.style._accessLevel=Yt.accessLevel,M.value.properties.style.accessLevel=Yt.accessLevel),M.value.properties.style&&M.value.properties.style.color){const Tn=M.value.properties.style.color;M.value.properties.style.color=Tn,M.value.properties.style.fillColor=Tn}de.value&&de.value.id?M.value.saveNote(de.value.id):M.value.saveNote(),M.value.bindPopup&&M.value.createPopupContent&&M.value.bindPopup(M.value.createPopupContent())}catch(Tn){console.error("[MapView][updateShapeProperties] Erreur lors de la sauvegarde de la note:",Tn)}else console.warn("[MapView][updateShapeProperties] La note ne possède pas de méthode saveNote");else if(Yt.category&&M.value&&M.value._dbId){const Tn=M.value._dbId,bn=a.elements.find(br=>br.id===Tn);if(bn){const br=bn;br.data||(br.data={}),br.data.category=Yt.category,a.$patch({unsavedChanges:!0})}}}const an=()=>{Y.value&&Q()},ln=async()=>{var Yt;if(M.value&&Y.value){const vt=M.value._leaflet_id,Tn=M.value._dbId;if(((Yt=M.value.properties)==null?void 0:Yt.type)==="Note"&&Tn)try{await _c.deleteNote(Tn),o.removeNote(Tn),f.success("Note supprimée avec succès")}catch(br){console.error(`[MapView][deleteSelectedShape] Erreur lors de la suppression de la note ${Tn} du backend:`,br),f.error("Erreur lors de la suppression de la note")}z(""),Y.value.removeLayer(M.value),m.value=m.value.filter(br=>br.layer&&br.layer._leaflet_id!==vt),M.value=null}};async function vn(Yt){await l.fetchPlans();const vt=l.getPlanById(Yt);vt?(localStorage.setItem("lastPlanId",Yt.toString()),de.value=vt,l.setCurrentPlan(vt),a.setCurrentPlan(vt.id),ue.value=!1,cr()):console.error(`Plan ${Yt} introuvable après création! Vérifiez les permissions.`)}mo(pt,async Yt=>{var vt;if(Yt&&((vt=Se.user)==null?void 0:vt.user_type)==="admin"){Ve.value=!0;try{const Tn=await Se.fetchSalarieVisiteurs(Yt.id);ze.value=Array.isArray(Tn)?Tn:[Tn]}catch(Tn){console.error("[MapView][watch selectedSalarie] Error:",Tn),ze.value=[]}finally{Ve.value=!1}}});function qn(){localStorage.removeItem("lastPlanId")}const Kn=BG.debounce(()=>{C.value&&Sh(()=>{var Yt;try{if(C.value&&C.value.getContainer()&&document.body.contains(C.value.getContainer())){if(C.value.invalidateSize({animate:!1}),(Yt=Y.value)!=null&&Yt.getLayers().length)try{Q()}catch(vt){console.warn("[invalidateMapSize] Erreur lors de l'ajustement de la vue:",vt)}}else console.warn("[invalidateMapSize] Carte non valide pour l'invalidation")}catch(vt){console.warn("[invalidateMapSize] Erreur lors de l'invalidation de la taille de la carte:",vt)}})},250);function cr(){Kn()}mo(de,(Yt,vt)=>{Yt&&Yt.id!==(vt==null?void 0:vt.id)&&Sh(()=>{cr()})});const pr=Rn(null),Dr=Rn(!1),zr=Rn([]),Ht=Ai(()=>pr.value?Le.value.filter(vt=>{var br;const Tn=vt.entreprise;return(typeof Tn=="object"&&Tn!==null?Tn.id:Tn)===((br=pr.value)==null?void 0:br.id)}):[]);async function tn(){Dr.value=!0;try{const Yt=await Kr.get("/users/",{params:{role:"ENTREPRISE"}});zr.value=Yt.data}catch(Yt){console.error("[MapView] Error loading entreprises:",Yt),zr.value=[]}finally{Dr.value=!1}}async function Kt(Yt){pr.value=Yt,Ne.value=!0;try{const vt=await Kr.get("/users/",{params:{role:"SALARIE",entreprise:Yt.id}});Le.value=vt.data}catch(vt){console.error("[MapView] Error loading salaries for entreprise:",vt),Le.value=[]}finally{Ne.value=!1}}function Yn(){pr.value=null,pt.value=null,Ie.value=null,Le.value=[],ze.value=[],He.value=[]}function ir(){pt.value=null,Ie.value=null,ze.value=[],He.value=[]}function Fr(){Ie.value=null,He.value=[]}async function Ft(Yt){var vt;pt.value=Yt,Ve.value=!0;try{const Tn={role:"VISITEUR",salarie:Yt.id};Se.isEntreprise?Tn.entreprise=(vt=Se.user)==null?void 0:vt.id:pr.value&&(Tn.entreprise=pr.value.id);const bn=await Kr.get("/users/",{params:Tn});Array.isArray(bn.data)?(ze.value=bn.data,bn.data.forEach((br,vr)=>{})):(console.warn("Format de réponse inattendu:",bn.data),ze.value=[]),ze.value.length===0&&console.warn("Aucun visiteur trouvé pour ce salarie")}catch(Tn){if(console.error("ERREUR lors du chargement des visiteurs:",Tn),Tn&&typeof Tn=="object"&&"response"in Tn){const bn=Tn;console.error("Détails de l'erreur:",{status:bn.response.status,data:bn.response.data})}ze.value=[]}finally{Ve.value=!1}}function je(){We.value=!1,Te.value=null}function Ze(Yt){be.value=Yt,he.value=!0}async function et(){var Yt,vt,Tn;if((Yt=be.value)!=null&&Yt.id)try{const bn=be.value.id,br={selectedClient:Ie.value,selectedSalarie:pt.value,isNoVisiteurView:Ie.value&&Ie.value.id===-1};if(await l.deletePlan(bn),he.value=!1,be.value=null,await new Promise(vr=>setTimeout(vr,50)),br.isNoVisiteurView)await cn();else if(br.selectedClient){const vr={visiteur:br.selectedClient.id};br.selectedSalarie&&(vr.salarie=br.selectedSalarie.id),Se.isEntreprise?vr.entreprise=(vt=Se.user)==null?void 0:vt.id:pr.value&&(vr.entreprise=pr.value.id);const Cn=await Kr.get("/plans/",{params:vr});He.value=Cn.data}else await l.fetchPlans();((Tn=de.value)==null?void 0:Tn.id)===bn&&(de.value=null,l.clearCurrentPlan(),a.clearCurrentPlan(),Be(),localStorage.removeItem("lastPlanId"))}catch(bn){console.error("Erreur lors de la suppression du plan:",bn),alert("Une erreur est survenue lors de la suppression du plan"),he.value=!1,be.value=null}}function ct(){he.value=!1,be.value=null}function $e(Yt){a.updateFilters(Yt),Gt(),setTimeout(()=>{Gt()},100)}function Gt(){if(!Y.value)return;const Yt=[];m.value.forEach((Cn,pn)=>{Cn.layer&&!Cn.id&&(!Cn.layer.properties||Cn.layer.properties&&!Cn.layer.properties.type)&&Yt.push(pn)});for(let Cn=Yt.length-1;Cn>=0;Cn--)m.value.splice(Yt[Cn],1);({...a.filters.accessLevels},{...a.filters.categories}),{...a.filters.shapeTypes},a.elements.length,a.elements.map(Cn=>({id:Cn.id,type_forme:Cn.type_forme}));const vt=a.getFilteredElements,Tn=Y.value.getLayers();Tn.map(Cn=>({_leaflet_id:Cn._leaflet_id,_dbId:Cn._dbId,hasProperties:!!Cn.properties,propertyType:Cn.properties?Cn.properties.type:null,category:Cn.properties?Cn.properties.category:null}));const bn=new Map;m.value.forEach(Cn=>{Cn.layer&&Cn.id&&bn.set(Cn.id,Cn.layer)});const br=new Map;Tn.forEach(Cn=>{Cn._dbId&&br.set(Cn,Cn._dbId)});const vr=new Set(vt.map(Cn=>Cn.id));Array.from(vr),Tn.forEach(Cn=>{const pn=Cn._dbId;if(Cn._leaflet_id,!pn){if(!Cn.properties)return;Cn._dbId=Date.now()+Math.floor(Math.random()*1e3)}const Ut=Cn.properties||{},Hn=Ut.type||Cn.type_forme||"";let or=Ut.category;if(Cn._dbId){const pi=a.elements.find(Li=>Li.id===Cn._dbId);if(pi){const Li=pi.data;Li&&Li.category&&(or!==Li.category&&(or=Li.category),Cn.properties||(Cn.properties={}),Cn.properties.category=or)}}or||(or="default");const Xr=Ut.accessLevel||"visitor";let ri=!1;Hn?ri=Hn in a.filters.shapeTypes&&a.filters.shapeTypes[Hn]===!0:ri=a.filters.shapeTypes.Polygon===!0;let ai=!1;or&&or in a.filters.categories?ai=a.filters.categories[or]===!0:ai=a.filters.categories.forages===!0;let Pr=!1;const As={company:a.filters.accessLevels.company===!0,employee:a.filters.accessLevels.employee===!0,visitor:a.filters.accessLevels.visitor===!0};let $i="visitor";As.company?$i="company":As.employee?$i="employee":As.visitor&&($i="visitor"),$i==="company"?Pr=!0:$i==="employee"?Pr=Xr==="employee"||Xr==="visitor":$i==="visitor"&&(Pr=Xr==="visitor"),ri&&ai&&Pr?Y.value.hasLayer(Cn)||(or&&or!=="default"&&(!Cn.properties||!Cn.properties.category)&&(Cn.properties||(Cn.properties={}),Cn.properties.category=or),Y.value.addLayer(Cn)):Y.value.hasLayer(Cn)&&Y.value.removeLayer(Cn)}),m.value.forEach(Cn=>{if(!Cn.layer)return;const pn=Cn.layer;if(pn._leaflet_id,pn._dbId,Y.value.hasLayer(pn))return;const Ut=pn.properties||{},Hn=Ut.type||pn.type_forme||"";let or=null;if(pn._dbId){const pi=a.elements.find(Li=>Li.id===pn._dbId);if(pi){const Li=pi.data;Li&&Li.category&&(or=Li.category)}}!or&&Ut.category&&(or=Ut.category),or||(or="default");const Xr=Ut.accessLevel||"visitor";if(pn.properties||(pn.properties={}),or&&or!=="default"&&(pn.properties.category=or,pn._dbId)){const pi=a.elements.find(Li=>Li.id===pn._dbId);if(pi){const Li=pi;Li.data||(Li.data={}),Li.data.category!==or&&(Li.data.category=or,a.$patch({unsavedChanges:!0}))}}pn.properties.accessLevel||(pn.properties.accessLevel="visitor");let ri=!1;Hn?ri=Hn in a.filters.shapeTypes&&a.filters.shapeTypes[Hn]===!0:ri=a.filters.shapeTypes.Polygon===!0;let ai=!1;if(or)if(or in a.filters.categories)ai=a.filters.categories[or]===!0;else if(vk().getUniqueCategories.includes(or)){const Yi={...a.filters.categories};Yi[or]=!0,a.updateFilters({categories:Yi}),ai=!0}else ai=a.filters.categories.forages===!0;else ai=a.filters.categories.forages===!0;let Pr=!1;const As={company:a.filters.accessLevels.company===!0,employee:a.filters.accessLevels.employee===!0,visitor:a.filters.accessLevels.visitor===!0};let $i="visitor";if(As.company?$i="company":As.employee?$i="employee":As.visitor&&($i="visitor"),$i==="company"?Pr=!0:$i==="employee"?Pr=Xr==="employee"||Xr==="visitor":$i==="visitor"&&(Pr=Xr==="visitor"),ri&&ai&&Pr){if(or&&or!=="default"&&(pn.properties||(pn.properties={}),pn.properties.category=or,pn._dbId)){const pi=a.elements.find(Li=>Li.id===pn._dbId);if(pi){const Li=pi;Li.data||(Li.data={}),Li.data.category!==or&&(Li.data.category=or,a.$patch({unsavedChanges:!0}))}}Y.value.addLayer(pn)}})}function hn(Yt){if(Y.value){const Tn=Y.value.getLayers().find(bn=>bn._leaflet_id===Yt.id||bn._leaflet_id===Yt.leafletId);Tn&&(Tn.properties.name=Yt.title,Tn.properties.description=Yt.description,Tn.properties.columnId=Yt.columnId,Tn.properties.accessLevel=Yt.accessLevel,Tn.properties.comments=Yt.comments||[],Tn.properties.photos=Yt.photos||[],Tn.properties.updatedAt=new Date().toISOString(),Tn.properties.category||(Tn.properties.category="forages"),Tn.setNoteStyle({color:Yt.style.color,fillColor:Yt.style.fillColor,weight:Yt.style.weight,fillOpacity:Yt.style.fillOpacity,radius:Yt.style.radius}),Tn.closePopup(),Tn.unbindPopup(),Tn.bindPopup(Tn.createPopupContent()),window.dispatchEvent(new CustomEvent("geonote:update",{detail:{noteId:Yt.id,properties:{name:Yt.title,description:Yt.description,columnId:Yt.columnId,accessLevel:Yt.accessLevel,style:Yt.style,comments:Yt.comments,photos:Yt.photos,updatedAt:new Date().toISOString()}}})))}}async function Ot(Yt){var vt;Ie.value=Yt,it.value=!0;try{const Tn={visiteur:Yt.id};Se.isEntreprise?Tn.entreprise=(vt=Se.user)==null?void 0:vt.id:pr.value&&(Tn.entreprise=pr.value.id),pt.value&&(Tn.salarie=pt.value.id);const bn=await Kr.get("/plans/",{params:Tn});He.value=bn.data}catch(Tn){console.error("[MapView] Error loading client plans:",Tn),He.value=[]}finally{it.value=!1}}async function cn(){var vt;const Yt={id:-1,username:"sans_visiteur",first_name:"Sans",last_name:"Visiteur",company_name:"",role:"VISITEUR",display_name:"Plans sans visiteur"};Ie.value=Yt,it.value=!0;try{const Tn={visiteur_null:!0};Se.isEntreprise?Tn.entreprise=(vt=Se.user)==null?void 0:vt.id:pr.value&&(Tn.entreprise=pr.value.id),pt.value&&(Tn.salarie=pt.value.id);const bn=await Kr.get("/plans/",{params:Tn});He.value=bn.data}catch(Tn){console.error("[MapView] Error loading plans without visiteur:",Tn),He.value=[]}finally{it.value=!1}}async function En(){var Yt;if(pt.value=null,Ie.value=null,He.value=[],Se.isEntreprise){Ne.value=!0;try{const vt=await Kr.get("/users/",{params:{role:"SALARIE",entreprise:(Yt=Se.user)==null?void 0:Yt.id}});Le.value=vt.data}catch(vt){console.error("[MapView][openLoadPlanModal] Erreur lors du chargement des salariés:",vt),Le.value=[]}finally{Ne.value=!1}}_e.value=!0}const wn=Rn(window.innerWidth<768);function Qn(){wn.value=window.innerWidth<768}function Lr(Yt){C.value&&(window.innerWidth>=768||(Yt?(C.value.dragging.disable(),C.value.touchZoom.disable(),C.value.doubleClickZoom.disable(),C.value.scrollWheelZoom.disable(),C.value.boxZoom.disable(),C.value.keyboard.disable(),C.value.tap&&C.value.tap.disable(),C.value.getContainer().style.cursor="default"):(C.value.dragging.enable(),C.value.touchZoom.enable(),C.value.doubleClickZoom.enable(),C.value.scrollWheelZoom.enable(),C.value.boxZoom.enable(),C.value.keyboard.enable(),C.value.tap&&C.value.tap.enable(),C.value.getContainer().style.cursor="")))}return(Yt,vt)=>{var Tn,bn,br,vr,Cn;return yt(),Et($r,null,[V("div",NG,[V("div",FG,[de.value?yr("",!0):(yt(),Et("div",zG,[V("div",jG,[vt[10]||(vt[10]=vd('<div class="relative w-48 h-48 mx-auto mb-12 rounded-full bg-gradient-to-br from-primary-100 to-primary-50 p-8 shadow-lg ring-4 ring-white"><img src="'+U9+'" alt="TagMap Logo" class="w-full h-full object-contain filter drop-shadow-md"><div class="absolute inset-0 rounded-full bg-gradient-to-t from-transparent to-white/10 pointer-events-none"></div></div><h1 class="text-3xl font-bold text-gray-900 mb-4">Bienvenue sur TagMap</h1><p class="text-gray-600 mb-8">Pour commencer à dessiner, vous devez d&#39;abord créer un nouveau plan ou charger un plan existant.</p>',3)),V("div",UG,[V("button",{onClick:vt[0]||(vt[0]=pn=>ue.value=!0),class:"w-full flex items-center justify-center px-4 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors duration-200"},vt[8]||(vt[8]=[V("svg",{class:"w-6 h-6 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),rs(" Créer un nouveau plan ")])),V("button",{onClick:En,class:"w-full flex items-center justify-center px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors duration-200"},vt[9]||(vt[9]=[V("svg",{class:"w-6 h-6 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),rs(" Charger un plan existant ")]))])])])),li(V("div",VG,[V("div",$G,[de.value?(yt(),Hu(eV,{key:0,"last-save":(Tn=de.value)!=null&&Tn.date_modification?new Date(de.value.date_modification):void 0,"plan-name":(bn=de.value)==null?void 0:bn.nom,"plan-description":(br=de.value)==null?void 0:br.description,"save-status":ne.value,onChangeMapType:Tr(we),onCreateNewPlan:vt[1]||(vt[1]=pn=>ue.value=!0),onLoadPlan:En,onSavePlan:Dt,onAdjustView:an,onToggleEditMode:Lr,class:"flex-shrink-0"},null,8,["last-save","plan-name","plan-description","save-status","onChangeMapType"])):yr("",!0),V("div",GG,[i.value&&de.value?(yt(),Et("div",{key:0,onClick:Ae,class:"md:hidden fixed inset-0 bg-black/30 z-[1800] transition-opacity duration-300"})):yr("",!0),V("div",HG,[V("div",{ref_key:"mapContainer",ref:r,class:"absolute inset-0 z-[1000]"},null,512)]),de.value?(yt(),Et($r,{key:1},[wn.value?(yt(),Hu(b0,{key:0,to:"body"},[Ns(nP,{show:i.value,"onUpdate:show":vt[2]||(vt[2]=pn=>i.value=pn),"selected-tool":Tr(w),"selected-shape":wt.value,"is-drawing":Tr(le),onToolSelected:Tr(z),onFilterChange:$e,onDeleteShape:ln,onPropertiesUpdate:Zt,onStyleUpdate:Tr(W),class:"md:w-80 md:flex-shrink-0"},null,8,["show","selected-tool","selected-shape","is-drawing","onToolSelected","onStyleUpdate"])])):(yt(),Hu(nP,{key:1,show:i.value,"onUpdate:show":vt[3]||(vt[3]=pn=>i.value=pn),"selected-tool":Tr(w),"selected-shape":wt.value,"is-drawing":Tr(le),onToolSelected:Tr(z),onFilterChange:$e,onDeleteShape:ln,onPropertiesUpdate:Zt,onStyleUpdate:Tr(W),class:"md:w-80 md:flex-shrink-0"},null,8,["show","selected-tool","selected-shape","is-drawing","onToolSelected","onStyleUpdate"]))],64)):yr("",!0),de.value?(yt(),Et("div",{key:2,class:"md:hidden fixed left-0 right-0 z-[1900] bg-white py-3 px-3 shadow-lg border-t border-gray-200 flex items-center justify-between cursor-pointer",style:{height:"var(--mobile-bottom-toolbar-height)",bottom:"0"},onClick:Ae},vt[11]||(vt[11]=[vd('<div class="flex items-center w-full justify-center"><div class="flex items-center space-x-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"></path></svg><span class="text-sm text-gray-500 font-medium">Outils</span></div></div>',1)]))):yr("",!0)])])],512),[[mC,de.value]]),(yt(),Hu(b0,{to:"body"},[Ns(F$,{ref_key:"newPlanModalRef",ref:lt,modelValue:ue.value,"onUpdate:modelValue":vt[4]||(vt[4]=pn=>ue.value=pn),onCreated:vn,onSalarieSelected:vt[5]||(vt[5]=pn=>pt.value=pn),onVisiteurSelected:vt[6]||(vt[6]=pn=>ge.value=pn)},null,8,["modelValue"])])),(yt(),Hu(b0,{to:"body"},[_e.value?(yt(),Et("div",qG,[V("div",WG,[V("div",ZG,[vt[13]||(vt[13]=V("h2",{class:"text-xl font-semibold text-gray-900"},"Charger un plan existant",-1)),V("button",{onClick:vt[7]||(vt[7]=pn=>_e.value=!1),class:"text-gray-400 hover:text-gray-500 focus:outline-none"},vt[12]||(vt[12]=[V("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),V("div",KG,[Tr(Se).isAdmin?(yt(),Et("div",YG,[pr.value?pt.value?Ie.value?(yt(),Et("div",pH,[V("div",mH,[V("button",{onClick:Fr,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},vt[29]||(vt[29]=[V("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),rs(" Retour à la liste des clients ")])),vt[30]||(vt[30]=V("span",{class:"mx-2 text-gray-400"},"|",-1)),V("span",gH,er(Tr(kl)(Ie.value)),1)]),vt[32]||(vt[32]=V("h3",{class:"font-medium text-gray-700"},"Plans disponibles",-1)),V("div",yH,[it.value?(yt(),Et($r,{key:0},Ti(3,pn=>V("div",{key:pn,class:"animate-pulse"},vt[31]||(vt[31]=[V("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[V("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),V("div",{class:"h-4 bg-gray-100 rounded w-2/3 mb-2"}),V("div",{class:"h-3 bg-gray-50 rounded w-1/3"})],-1)]))),64)):(yt(!0),Et($r,{key:1},Ti(He.value,pn=>(yt(),Et("div",{key:pn.id,class:"relative w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200 group"},[V("button",{onClick:Ut=>ot(pn.id),class:"w-full text-left"},[V("div",_H,er(pn.nom),1),V("div",bH,er(pn.description),1),V("div",xH," Modifié le "+er(Tr(cg)(pn.date_modification)),1)],8,vH),Tr(Se).isAdmin||Tr(Se).isEntreprise?(yt(),Et("button",{key:0,onClick:Wh(Ut=>Ze(pn),["stop"]),class:"absolute top-1/2 right-3 transform -translate-y-1/2 px-3 py-1 text-sm text-red-600 hover:text-white hover:bg-red-600 border border-red-600 rounded transition-colors duration-200 h-8 flex items-center justify-center"}," Supprimer ",8,wH)):yr("",!0)]))),128))])])):(yt(),Et("div",aH,[V("div",lH,[V("button",{onClick:ir,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},vt[22]||(vt[22]=[V("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),rs(" Retour à la liste des salaries ")])),vt[23]||(vt[23]=V("span",{class:"mx-2 text-gray-400"},"|",-1)),V("span",uH,er(Tr(kl)(pt.value)),1)]),vt[28]||(vt[28]=V("h3",{class:"font-medium text-gray-700"},"Sélectionnez un visiteur",-1)),V("div",cH,[V("button",{onClick:cn,class:"flex items-center p-3 text-left bg-primary-50 hover:bg-primary-100 rounded-lg border border-primary-200 transition-colors duration-200"},vt[24]||(vt[24]=[V("div",null,[V("div",{class:"font-medium text-primary-700"},"Plans sans visiteur"),V("div",{class:"text-xs text-primary-600"},"Afficher les plans créés sans visiteur associé")],-1),V("svg",{class:"w-5 h-5 ml-auto text-primary-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])),Ve.value?(yt(),Et($r,{key:0},Ti(3,pn=>V("div",{key:pn,class:"animate-pulse"},vt[25]||(vt[25]=[V("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[V("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),V("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(yt(),Et($r,{key:1},[Mt.value.length===0?(yt(),Et("div",hH,vt[26]||(vt[26]=[V("div",{class:"text-gray-500 mb-2"},"Aucun visiteur trouvé pour ce salarie",-1),V("div",{class:"text-sm text-gray-400"},` Vous pouvez utiliser l'option "Plans sans visiteur" ci-dessus `,-1)]))):(yt(!0),Et($r,{key:1},Ti(Mt.value,pn=>(yt(),Et("button",{key:pn.id,onClick:Ut=>Ot(pn),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[V("div",null,[V("div",fH,er(Tr(kl)(pn)),1)]),vt[27]||(vt[27]=V("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,dH))),128))],64))])])):(yt(),Et("div",tH,[V("div",nH,[V("button",{onClick:Yn,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},vt[17]||(vt[17]=[V("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),rs(" Retour à la liste des entreprises ")])),vt[18]||(vt[18]=V("span",{class:"mx-2 text-gray-400"},"|",-1)),V("span",rH,er(Tr(kl)(pr.value)),1)]),vt[21]||(vt[21]=V("h3",{class:"font-medium text-gray-700"},"Sélectionnez un salarie",-1)),V("div",iH,[Ne.value?(yt(),Et($r,{key:0},Ti(3,pn=>V("div",{key:pn,class:"animate-pulse"},vt[19]||(vt[19]=[V("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[V("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),V("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(yt(!0),Et($r,{key:1},Ti(Ht.value,pn=>(yt(),Et("button",{key:pn.id,onClick:Ut=>Ft(pn),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[V("div",null,[V("div",oH,er(Tr(kl)(pn)),1)]),vt[20]||(vt[20]=V("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,sH))),128))])])):(yt(),Et("div",XG,[vt[16]||(vt[16]=V("h3",{class:"font-medium text-gray-700"},"Sélectionnez une entreprise",-1)),V("div",JG,[Dr.value?(yt(),Et($r,{key:0},Ti(3,pn=>V("div",{key:pn,class:"animate-pulse"},vt[14]||(vt[14]=[V("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[V("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),V("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(yt(!0),Et($r,{key:1},Ti(zr.value,pn=>(yt(),Et("button",{key:pn.id,onClick:Ut=>Kt(pn),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[V("div",null,[V("div",eH,er(Tr(kl)(pn)),1)]),vt[15]||(vt[15]=V("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,QG))),128))])]))])):Tr(Se).isSalarie?(yt(),Et("div",CH,[Ie.value?(yt(),Et("div",TH,[V("div",AH,[V("button",{onClick:Fr,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},vt[38]||(vt[38]=[V("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),rs(" Retour à la liste des clients ")])),vt[39]||(vt[39]=V("span",{class:"mx-2 text-gray-400"},"|",-1)),V("span",kH,er(Tr(kl)(Ie.value)),1)]),vt[41]||(vt[41]=V("h3",{class:"font-medium text-gray-700"},"Plans disponibles",-1)),V("div",IH,[it.value?(yt(),Et($r,{key:0},Ti(3,pn=>V("div",{key:pn,class:"animate-pulse"},vt[40]||(vt[40]=[V("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[V("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),V("div",{class:"h-4 bg-gray-100 rounded w-2/3 mb-2"}),V("div",{class:"h-3 bg-gray-50 rounded w-1/3"})],-1)]))),64)):(yt(!0),Et($r,{key:1},Ti(He.value,pn=>(yt(),Et("div",{key:pn.id,class:"relative w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200 group"},[V("button",{onClick:Ut=>ot(pn.id),class:"w-full text-left"},[V("div",OH,er(pn.nom),1),V("div",RH,er(pn.description),1),V("div",BH," Modifié le "+er(Tr(cg)(pn.date_modification)),1)],8,DH),Tr(Se).isAdmin||Tr(Se).isEntreprise?(yt(),Et("button",{key:0,onClick:Wh(Ut=>Ze(pn),["stop"]),class:"absolute top-1/2 right-3 transform -translate-y-1/2 px-3 py-1 text-sm text-red-600 hover:text-white hover:bg-red-600 border border-red-600 rounded transition-colors duration-200 h-8 flex items-center justify-center"}," Supprimer ",8,NH)):yr("",!0)]))),128))])])):(yt(),Et("div",SH,[vt[37]||(vt[37]=V("h3",{class:"font-medium text-gray-700"},"Sélectionnez un visiteur",-1)),V("div",LH,[V("button",{onClick:cn,class:"flex items-center p-3 text-left bg-primary-50 hover:bg-primary-100 rounded-lg border border-primary-200 transition-colors duration-200"},vt[33]||(vt[33]=[V("div",null,[V("div",{class:"font-medium text-primary-700"},"Plans sans visiteur"),V("div",{class:"text-xs text-primary-600"},"Afficher les plans créés sans visiteur associé")],-1),V("svg",{class:"w-5 h-5 ml-auto text-primary-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])),Ve.value?(yt(),Et($r,{key:0},Ti(3,pn=>V("div",{key:pn,class:"animate-pulse"},vt[34]||(vt[34]=[V("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[V("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),V("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(yt(),Et($r,{key:1},[Mt.value.length===0?(yt(),Et("div",PH,vt[35]||(vt[35]=[V("div",{class:"text-gray-500 mb-2"},"Aucun visiteur trouvé pour ce salarie",-1),V("div",{class:"text-sm text-gray-400"}," Veuillez vérifier que des visiteurs ont été assignés à ce salarie ",-1)]))):(yt(!0),Et($r,{key:1},Ti(Mt.value,pn=>(yt(),Et("button",{key:pn.id,onClick:Ut=>Ot(pn),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[V("div",null,[V("div",MH,er(Tr(kl)(pn)),1)]),vt[36]||(vt[36]=V("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,EH))),128))],64))])]))])):Tr(Se).isEntreprise?(yt(),Et("div",FH,[pt.value?Ie.value?(yt(),Et("div",YH,[V("div",XH,[V("button",{onClick:Fr,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},vt[52]||(vt[52]=[V("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),rs(" Retour à la liste des visiteurs ")])),vt[53]||(vt[53]=V("span",{class:"mx-2 text-gray-400"},"|",-1)),V("span",JH,er(Tr(kl)(Ie.value)),1)]),vt[55]||(vt[55]=V("h3",{class:"font-medium text-gray-700"},"Plans disponibles",-1)),V("div",QH,[it.value?(yt(),Et($r,{key:0},Ti(3,pn=>V("div",{key:pn,class:"animate-pulse"},vt[54]||(vt[54]=[V("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[V("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),V("div",{class:"h-4 bg-gray-100 rounded w-2/3 mb-2"}),V("div",{class:"h-3 bg-gray-50 rounded w-1/3"})],-1)]))),64)):(yt(!0),Et($r,{key:1},Ti(He.value,pn=>(yt(),Et("div",{key:pn.id,class:"relative w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200 group"},[V("button",{onClick:Ut=>ot(pn.id),class:"w-full text-left"},[V("div",tq,er(pn.nom),1),V("div",nq,er(pn.description),1),V("div",rq," Modifié le "+er(Tr(cg)(pn.date_modification)),1)],8,eq),Tr(Se).isAdmin||Tr(Se).isEntreprise?(yt(),Et("button",{key:0,onClick:Wh(Ut=>Ze(pn),["stop"]),class:"absolute top-1/2 right-3 transform -translate-y-1/2 px-3 py-1 text-sm text-red-600 hover:text-white hover:bg-red-600 border border-red-600 rounded transition-colors duration-200 h-8 flex items-center justify-center"}," Supprimer ",8,iq)):yr("",!0)]))),128))])])):(yt(),Et("div",$H,[V("div",GH,[V("button",{onClick:ir,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},vt[45]||(vt[45]=[V("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),rs(" Retour à la liste des salariés ")])),vt[46]||(vt[46]=V("span",{class:"mx-2 text-gray-400"},"|",-1)),V("span",HH,er(Tr(kl)(pt.value)),1)]),vt[51]||(vt[51]=V("h3",{class:"font-medium text-gray-700"},"Sélectionnez un visiteur",-1)),V("div",qH,[V("button",{onClick:cn,class:"flex items-center p-3 text-left bg-primary-50 hover:bg-primary-100 rounded-lg border border-primary-200 transition-colors duration-200"},vt[47]||(vt[47]=[V("div",null,[V("div",{class:"font-medium text-primary-700"},"Plans sans visiteur"),V("div",{class:"text-xs text-primary-600"},"Afficher les plans créés sans visiteur associé")],-1),V("svg",{class:"w-5 h-5 ml-auto text-primary-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])),Ve.value?(yt(),Et($r,{key:0},Ti(3,pn=>V("div",{key:pn,class:"animate-pulse"},vt[48]||(vt[48]=[V("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[V("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),V("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(yt(),Et($r,{key:1},[Mt.value.length===0?(yt(),Et("div",WH,vt[49]||(vt[49]=[V("div",{class:"text-gray-500 mb-2"},"Aucun visiteur trouvé pour ce salarié",-1),V("div",{class:"text-sm text-gray-400"},` Vous pouvez utiliser l'option "Plans sans visiteur" ci-dessus `,-1)]))):(yt(!0),Et($r,{key:1},Ti(Mt.value,pn=>(yt(),Et("button",{key:pn.id,onClick:Ut=>Ot(pn),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[V("div",null,[V("div",KH,er(Tr(kl)(pn)),1)]),vt[50]||(vt[50]=V("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,ZH))),128))],64))])])):(yt(),Et("div",zH,[vt[44]||(vt[44]=V("h3",{class:"font-medium text-gray-700"},"Sélectionnez un salarié",-1)),V("div",jH,[Ne.value?(yt(),Et($r,{key:0},Ti(3,pn=>V("div",{key:pn,class:"animate-pulse"},vt[42]||(vt[42]=[V("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[V("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),V("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(yt(!0),Et($r,{key:1},Ti(Le.value,pn=>(yt(),Et("button",{key:pn.id,onClick:Ut=>Ft(pn),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[V("div",null,[V("div",VH,er(Tr(kl)(pn)),1)]),vt[43]||(vt[43]=V("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,UH))),128))])]))])):(yt(),Et("div",sq,[Tr(l).plans.length===0?(yt(),Et("div",oq,vt[56]||(vt[56]=[V("p",{class:"text-gray-500"},"Aucun plan disponible",-1)]))):(yt(),Et("div",aq,[(yt(!0),Et($r,null,Ti(Tr(l).plans,pn=>(yt(),Et("div",{key:pn.id,class:"relative w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200 group"},[V("button",{onClick:Ut=>ot(pn.id),class:"w-full text-left"},[V("div",uq,er(pn.nom),1),V("div",cq,er(pn.description),1),V("div",hq," Modifié le "+er(Tr(cg)(pn.date_modification)),1)],8,lq),Tr(Se).isAdmin||Tr(Se).isEntreprise?(yt(),Et("button",{key:0,onClick:Wh(Ut=>Ze(pn),["stop"]),class:"absolute top-1/2 right-3 transform -translate-y-1/2 px-3 py-1 text-sm text-red-600 hover:text-white hover:bg-red-600 border border-red-600 rounded transition-colors duration-200 h-8 flex items-center justify-center"}," Supprimer ",8,dq)):yr("",!0)]))),128))]))]))])])])):yr("",!0)])),(yt(),Hu(b0,{to:"body"},[he.value?(yt(),Et("div",fq,[V("div",pq,[V("div",mq,[vt[57]||(vt[57]=V("svg",{class:"h-12 w-12 text-red-500 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)),vt[58]||(vt[58]=V("h3",{class:"text-xl font-semibold text-gray-900"},"Supprimer le plan",-1)),V("p",gq,' Êtes-vous sûr de vouloir supprimer le plan "'+er(be.value?be.value.nom:"")+'" ? Cette action est irréversible. ',1)]),V("div",{class:"flex justify-center space-x-4"},[V("button",{onClick:ct,class:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-300"}," Annuler "),V("button",{onClick:et,class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500"}," Supprimer ")])])])):yr("",!0)]))])]),(yt(),Hu(b0,{to:"body"},[We.value?(yt(),Hu(Lk,{key:0,note:Te.value,"is-new-note":!((vr=Te.value)!=null&&vr.id),location:(Cn=Te.value)==null?void 0:Cn.location,onClose:je,onSave:hn},null,8,["note","is-new-note","location"])):yr("",!0)]))],64)}}}),yq={class:"fixed inset-0 z-[3001] overflow-y-auto"},vq={class:"flex items-center justify-center min-h-screen w-full p-0"},_q={class:"relative bg-white w-full h-full max-h-full overflow-y-auto md:rounded-lg md:max-w-4xl md:h-auto md:max-h-[90vh] md:my-8 shadow-xl transform transition-all",role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"},bq={class:"p-4 md:p-6"},xq={class:"flex justify-between items-center mb-4 border-b pb-4"},wq={class:"text-xl font-semibold text-gray-900",id:"modal-headline"},Cq={class:"mt-4"},Sq={key:0,class:"mb-4 rounded-md bg-red-50 p-4"},Lq={class:"flex"},Pq={class:"ml-3"},Eq={class:"text-sm font-medium text-red-800"},Mq={key:0},Tq={key:1},Aq=["value"],kq={key:2},Iq={key:3},Dq=["value"],Oq={key:4,class:"bg-blue-50 p-3 rounded-md mb-4"},Rq={class:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-2"},Bq={key:0,class:"mt-2 text-sm text-red-600"},Nq={key:0,class:"mt-2 text-sm text-red-600"},Fq={key:5},zq={class:"flex items-center"},jq={key:6,class:"border-t pt-4 mt-4"},Uq={class:"mb-4"},Vq={class:"mb-4"},$q={key:7},Gq={key:8},Hq={key:0,class:"mt-2 text-sm text-red-600"},qq={class:"flex justify-end space-x-3"},Wq=["disabled"],Zq={key:0,class:"mr-2"},Kq=Ja({__name:"UserFormModal",props:{user:{type:Object,default:()=>({})},salaries:{type:Array,default:()=>[]},entreprises:{type:Array,default:()=>[]},isAdmin:{type:Boolean,default:!1},isEntreprise:{type:Boolean,default:!1},currentSalarie:{type:String,default:void 0},currentEntreprise:{type:String,default:void 0},apiErrors:{type:Array,default:()=>[]},refreshKey:{type:Number,default:0}},emits:["close","save","refresh"],setup(e,{emit:t}){const n=e,r=t,i=Rn(!1),l=Rn(""),a=Rn(""),o=Rn(""),f=Rn(""),m=Rn(""),_=bd({id:void 0,first_name:"",last_name:"",username:"",email:"",password:"",company_name:"",role:n.isEntreprise?"SALARIE":n.isAdmin?"ADMIN":"VISITEUR",salarie:null,entreprise:null,is_active:!0,storage_quota:50,storage_used:0,ecowitt_api_key:"",ecowitt_application_key:""});Rl(()=>{var M;(M=n.user)!=null&&M.id?(_.id=n.user.id,_.first_name=n.user.first_name||"",_.last_name=n.user.last_name||"",_.username=n.user.username||"",_.email=n.user.email||"",_.company_name=n.user.company_name||"",_.role=n.user.role||"VISITEUR",_.is_active=n.user.is_active??!0,_.ecowitt_api_key=n.user.ecowitt_api_key||"",_.ecowitt_application_key=n.user.ecowitt_application_key||"",_.storage_quota=n.user.storage_quota||50,_.storage_used=n.user.storage_used||0,n.user.salarie?typeof n.user.salarie=="object"?_.salarie=n.user.salarie.id:_.salarie=n.user.salarie:n.user.salarie_id?_.salarie=n.user.salarie_id:n.currentSalarie&&(_.salarie=parseInt(n.currentSalarie)),n.user.entreprise?typeof n.user.entreprise=="object"?_.entreprise=n.user.entreprise.id:_.entreprise=n.user.entreprise:n.user.entreprise_id?_.entreprise=n.user.entreprise_id:n.currentEntreprise&&(_.entreprise=parseInt(n.currentEntreprise))):(n.currentSalarie&&(_.salarie=parseInt(n.currentSalarie)),n.currentEntreprise&&(_.entreprise=parseInt(n.currentEntreprise)),n.isEntreprise?_.role="SALARIE":n.isAdmin||(_.role="VISITEUR"))}),m_(()=>{_.role==="ADMIN"||_.role==="ENTREPRISE"?(_.salarie=null,_.entreprise=null):_.role==="SALARIE"&&(_.salarie=null,n.isEntreprise&&n.currentEntreprise&&(_.entreprise=parseInt(n.currentEntreprise)))}),m_(()=>{l.value="",a.value="",o.value="",f.value="",n.apiErrors&&n.apiErrors.length>0&&n.apiErrors.forEach(M=>{switch(M.field){case"email":l.value=M.message;break;case"username":a.value=M.message;break;case"password":o.value=M.message;break;case"non_field_error":default:f.value=M.message;break}})});async function w(){l.value="",a.value="",o.value="",f.value="";let M=!0;if(_.id||(_.password!==m.value?(o.value="Les mots de passe ne correspondent pas",M=!1):_.password.length<8&&(o.value="Le mot de passe doit contenir au moins 8 caractères",M=!1)),!!M){i.value=!0;try{const C={..._};_.id&&delete C.password,n.isEntreprise&&["SALARIE","VISITEUR"].includes(_.role)&&(C.entreprise_id=n.currentEntreprise?parseInt(n.currentEntreprise):void 0),C.salarie&&(C.salarie_id=C.salarie,delete C.salarie),n.currentSalarie&&_.role==="VISITEUR"&&(C.salarie_id=parseInt(n.currentSalarie)),await r("save",C),r("refresh")}catch(C){console.error("Erreur locale:",C)}finally{i.value=!1}}}return(M,C)=>(yt(),Et("div",yq,[V("div",vq,[C[43]||(C[43]=V("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[V("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),V("div",_q,[V("div",null,[V("div",bq,[V("div",xq,[V("h3",wq,er(e.user?"Modifier l'utilisateur":"Nouvel utilisateur"),1),V("button",{type:"button",onClick:C[0]||(C[0]=R=>M.$emit("close")),class:"text-gray-400 hover:text-gray-500"},C[16]||(C[16]=[V("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),V("div",Cq,[f.value?(yt(),Et("div",Sq,[V("div",Lq,[C[17]||(C[17]=V("div",{class:"flex-shrink-0"},[V("svg",{class:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[V("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),V("div",Pq,[V("h3",Eq,er(f.value),1)])])])):yr("",!0),V("form",{onSubmit:Wh(w,["prevent"]),class:"space-y-6"},[e.isAdmin?(yt(),Et("div",Mq,[C[19]||(C[19]=V("label",{for:"role",class:"block text-sm font-medium text-gray-700"},"Type d'utilisateur",-1)),li(V("select",{id:"role","onUpdate:modelValue":C[1]||(C[1]=R=>_.role=R),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:""},C[18]||(C[18]=[V("option",{value:"ADMIN"},"Administrateur",-1),V("option",{value:"ENTREPRISE"},"Entreprise",-1),V("option",{value:"SALARIE"},"Salarie",-1),V("option",{value:"VISITEUR"},"Visiteur",-1)]),512),[[Ka,_.role]])])):yr("",!0),e.isAdmin&&_.role==="SALARIE"?(yt(),Et("div",Tq,[C[21]||(C[21]=V("label",{for:"entreprise",class:"block text-sm font-medium text-gray-700"},"Entreprise",-1)),li(V("select",{id:"entreprise","onUpdate:modelValue":C[2]||(C[2]=R=>_.entreprise=R),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},[C[20]||(C[20]=V("option",{value:null},"-- Sélectionner une entreprise --",-1)),(yt(!0),Et($r,null,Ti(e.entreprises,R=>(yt(),Et("option",{key:R.id,value:R.id},er(R.first_name)+" "+er(R.last_name)+" ("+er(R.company_name||"Entreprise")+") ",9,Aq))),128))],512),[[Ka,_.entreprise]])])):yr("",!0),e.isEntreprise&&!_.id?(yt(),Et("div",kq,[C[23]||(C[23]=V("label",{for:"role",class:"block text-sm font-medium text-gray-700"},"Type d'utilisateur",-1)),li(V("select",{id:"role","onUpdate:modelValue":C[3]||(C[3]=R=>_.role=R),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:""},C[22]||(C[22]=[V("option",{value:"SALARIE"},"Salarie",-1),V("option",{value:"VISITEUR"},"Visiteur",-1)]),512),[[Ka,_.role]])])):yr("",!0),(e.isAdmin||e.isEntreprise)&&_.role==="VISITEUR"&&!e.currentSalarie?(yt(),Et("div",Iq,[C[25]||(C[25]=V("label",{for:"salarie",class:"block text-sm font-medium text-gray-700"},"Salarie",-1)),li(V("select",{id:"salarie","onUpdate:modelValue":C[4]||(C[4]=R=>_.salarie=R),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:""},[C[24]||(C[24]=V("option",{value:null},"-- Sélectionner un salarie --",-1)),(yt(!0),Et($r,null,Ti(e.salaries,R=>(yt(),Et("option",{key:R.id,value:R.id},er(R.first_name)+" "+er(R.last_name)+" ("+er(R.company_name||"Salarie")+") ",9,Dq))),128))],512),[[Ka,_.salarie]])])):yr("",!0),e.currentSalarie&&!e.isAdmin&&!e.isEntreprise?(yt(),Et("div",Oq,C[26]||(C[26]=[vd('<div class="flex"><div class="flex-shrink-0"><svg class="h-5 w-5 text-blue-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg></div><div class="ml-3"><p class="text-sm text-blue-700"> Vous êtes en train de créer un visiteur qui sera automatiquement associé à votre compte. </p></div></div>',1)]))):yr("",!0),V("div",Rq,[V("div",null,[C[27]||(C[27]=V("label",{for:"first_name",class:"block text-sm font-medium text-gray-700"},"Prénom",-1)),li(V("input",{type:"text",id:"first_name","onUpdate:modelValue":C[5]||(C[5]=R=>_.first_name=R),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[to,_.first_name]])]),V("div",null,[C[28]||(C[28]=V("label",{for:"last_name",class:"block text-sm font-medium text-gray-700"},"Nom",-1)),li(V("input",{type:"text",id:"last_name","onUpdate:modelValue":C[6]||(C[6]=R=>_.last_name=R),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[to,_.last_name]])])]),V("div",null,[C[29]||(C[29]=V("label",{for:"email",class:"block text-sm font-medium text-gray-700"},"Email",-1)),li(V("input",{type:"email",id:"email","onUpdate:modelValue":C[7]||(C[7]=R=>_.email=R),required:"",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[to,_.email]]),l.value?(yt(),Et("div",Bq,er(l.value),1)):yr("",!0)]),V("div",null,[C[30]||(C[30]=V("label",{for:"username",class:"block text-sm font-medium text-gray-700"},"Nom d'utilisateur",-1)),li(V("input",{type:"text",id:"username","onUpdate:modelValue":C[8]||(C[8]=R=>_.username=R),required:"",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[to,_.username]]),a.value?(yt(),Et("div",Nq,er(a.value),1)):yr("",!0)]),V("div",null,[C[31]||(C[31]=V("label",{for:"company_name",class:"block text-sm font-medium text-gray-700"},"Entreprise",-1)),li(V("input",{type:"text",id:"company_name","onUpdate:modelValue":C[9]||(C[9]=R=>_.company_name=R),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[to,_.company_name]])]),_.role==="ENTREPRISE"||_.role==="SALARIE"?(yt(),Et("div",Fq,[C[33]||(C[33]=V("label",{for:"storage_quota",class:"block text-sm font-medium text-gray-700"},"Quota de stockage (MB)",-1)),V("div",zq,[li(V("input",{type:"number",id:"storage_quota","onUpdate:modelValue":C[10]||(C[10]=R=>_.storage_quota=R),min:"1",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[to,_.storage_quota]]),C[32]||(C[32]=V("span",{class:"ml-2 text-sm text-gray-500"},"MB",-1))]),C[34]||(C[34]=V("p",{class:"mt-1 text-sm text-gray-500"},"Espace de stockage maximum pour les photos des notes",-1))])):yr("",!0),_.role==="ENTREPRISE"?(yt(),Et("div",jq,[C[39]||(C[39]=V("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Configuration API",-1)),V("div",Uq,[C[35]||(C[35]=V("label",{for:"ecowitt_api_key",class:"block text-sm font-medium text-gray-700"},"Clé API Ecowitt",-1)),li(V("input",{type:"text",id:"ecowitt_api_key","onUpdate:modelValue":C[11]||(C[11]=R=>_.ecowitt_api_key=R),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",placeholder:"Entrez la clé API Ecowitt"},null,512),[[to,_.ecowitt_api_key]]),C[36]||(C[36]=V("p",{class:"mt-1 text-sm text-gray-500"},"Clé API pour accéder aux services météo Ecowitt",-1))]),V("div",Vq,[C[37]||(C[37]=V("label",{for:"ecowitt_application_key",class:"block text-sm font-medium text-gray-700"},"Clé d'application Ecowitt",-1)),li(V("input",{type:"text",id:"ecowitt_application_key","onUpdate:modelValue":C[12]||(C[12]=R=>_.ecowitt_application_key=R),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",placeholder:"Entrez la clé d'application Ecowitt"},null,512),[[to,_.ecowitt_application_key]]),C[38]||(C[38]=V("p",{class:"mt-1 text-sm text-gray-500"},"Clé d'application pour accéder aux services météo Ecowitt",-1))])])):yr("",!0),_.id?yr("",!0):(yt(),Et("div",$q,[C[40]||(C[40]=V("label",{for:"password",class:"block text-sm font-medium text-gray-700"},"Mot de passe",-1)),li(V("input",{type:"password",id:"password","onUpdate:modelValue":C[13]||(C[13]=R=>_.password=R),required:"",autocomplete:"new-password",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[to,_.password]])])),_.id?yr("",!0):(yt(),Et("div",Gq,[C[41]||(C[41]=V("label",{for:"password_confirm",class:"block text-sm font-medium text-gray-700"},"Confirmer le mot de passe",-1)),li(V("input",{type:"password",id:"password_confirm","onUpdate:modelValue":C[14]||(C[14]=R=>m.value=R),required:"",autocomplete:"new-password",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[to,m.value]]),o.value?(yt(),Et("div",Hq,er(o.value),1)):yr("",!0)])),V("div",qq,[V("button",{type:"button",onClick:C[15]||(C[15]=R=>M.$emit("close")),class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"}," Annuler "),V("button",{type:"submit",disabled:i.value,class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},[i.value?(yt(),Et("span",Zq,C[42]||(C[42]=[V("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[V("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),V("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):yr("",!0),rs(" "+er(_.id?"Enregistrer":"Créer"),1)],8,Wq)])],32)])])])])])]))}}),Yq={class:"fixed inset-0 z-[3001] overflow-y-auto"},Xq={class:"flex items-center justify-center min-h-screen w-full"},Jq={class:"relative bg-white w-full h-full md:rounded-lg md:max-w-lg md:h-auto md:max-h-[90vh] md:my-8 shadow-xl transform transition-all overflow-hidden",role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"},Qq={class:"p-4 md:p-6"},eW={class:"flex items-start"},tW={class:"ml-4 flex-1"},nW={class:"text-lg leading-6 font-medium text-gray-900",id:"modal-headline"},rW={class:"mt-2"},iW={class:"text-sm text-gray-500"},sW={class:"mt-6 flex flex-col-reverse sm:flex-row-reverse sm:justify-end gap-3"},oW=Ja({__name:"ConfirmationModal",props:{title:{type:String,required:!0},message:{type:String,required:!0}},emits:["confirm","cancel"],setup(e){return(t,n)=>(yt(),Et("div",Yq,[V("div",Xq,[n[3]||(n[3]=V("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[V("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),V("div",Jq,[V("div",Qq,[V("div",eW,[n[2]||(n[2]=V("div",{class:"flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100"},[V("svg",{class:"h-6 w-6 text-red-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),V("div",tW,[V("h3",nW,er(e.title),1),V("div",rW,[V("p",iW,er(e.message),1)])])]),V("div",sW,[V("button",{type:"button",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:w-auto sm:text-sm",onClick:n[0]||(n[0]=r=>t.$emit("confirm"))}," Confirmer "),V("button",{type:"button",class:"w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:w-auto sm:text-sm",onClick:n[1]||(n[1]=r=>t.$emit("cancel"))}," Annuler ")])])])])]))}}),aW={class:"min-h-full bg-gray-50"},lW={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},uW={class:"flex justify-between items-center mb-8"},cW={class:"text-3xl font-extrabold text-gray-900"},hW={key:0},dW={key:1},fW={key:2},pW={key:0},mW={key:1},gW={key:2},yW={class:"bg-white shadow rounded-lg mb-6 p-4"},vW={class:"space-y-4"},_W={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},bW={key:0},xW={key:0,value:"ADMIN"},wW={key:1,value:"ENTREPRISE"},CW={key:1},SW=["value"],LW={key:2},PW=["value"],EW={class:"w-full"},MW={class:"bg-white shadow rounded-lg"},TW={class:"overflow-x-auto"},AW={class:"min-w-full divide-y divide-gray-200"},kW={class:"bg-gray-50"},IW={key:0,scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},DW={key:1,scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},OW={class:"bg-white divide-y divide-gray-200"},RW={key:0,class:"animate-pulse"},BW={key:1},NW={class:"px-6 py-4 whitespace-nowrap"},FW={class:"flex items-center"},zW={class:"flex-shrink-0 h-10 w-10"},jW={class:"h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center"},UW={class:"text-primary-600 font-medium"},VW={class:"ml-4"},$W={class:"text-sm font-medium text-gray-900"},GW={class:"text-sm text-gray-500"},HW={class:"px-6 py-4 whitespace-nowrap"},qW={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},WW={key:0,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ZW={key:1,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},KW={class:"px-6 py-4 whitespace-nowrap"},YW={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},XW=["onClick"],JW=["onClick"],QW={key:0,class:"fixed inset-0 z-[3001] overflow-y-auto"},eZ=Ja({__name:"UserListView",setup(e){const t=Mu(),n=Lh(),r=Rn([]),i=Rn([]),l=Rn([]),a=Rn(!1),o=Rn(!1),f=Rn(null),m=Rn(null),_=Rn(!0),w=Rn([]),M=bd({role:"",search:"",salarie:"",entreprise:""}),C=Ai(()=>t.isAdmin),R=Ai(()=>t.isEntreprise),z=Ai(()=>t.isSalarie),W=Ai(()=>C.value?r.value.filter(he=>he.role==="SALARIE"):R.value?r.value.filter(he=>{var de,Te;return he.role==="SALARIE"&&((de=he.entreprise)==null?void 0:de.id)===((Te=t.user)==null?void 0:Te.id)}):[]),X=Ai(()=>{let he=r.value;if(R.value&&(he=he.filter(de=>{var Te,be,ae,ne,Se;return de.role==="SALARIE"?((Te=de.entreprise)==null?void 0:Te.id)===((be=t.user)==null?void 0:be.id):de.role==="VISITEUR"?((ne=(ae=de.salarie)==null?void 0:ae.entreprise)==null?void 0:ne.id)===((Se=t.user)==null?void 0:Se.id):!1})),z.value&&(he=he.filter(de=>{var Te,be;return de.role==="VISITEUR"&&(de.salarie_id===((Te=t.user)==null?void 0:Te.id)||de.salarie&&de.salarie.id===((be=t.user)==null?void 0:be.id))})),(C.value||R.value)&&(M.role&&(he=he.filter(de=>de.role===M.role)),M.salarie&&(he=he.filter(de=>{var be;const Te=((be=de.salarie)==null?void 0:be.id)||de.salarie_id;return(Te==null?void 0:Te.toString())===M.salarie.toString()})),M.entreprise&&C.value&&(he=he.filter(de=>{var Te,be,ae,ne,Se;return de.role==="SALARIE"?((be=(Te=de.entreprise)==null?void 0:Te.id)==null?void 0:be.toString())===M.entreprise.toString():de.role==="VISITEUR"?((Se=(ne=(ae=de.salarie)==null?void 0:ae.entreprise)==null?void 0:ne.id)==null?void 0:Se.toString())===M.entreprise.toString():!1}))),M.search){const de=M.search.toLowerCase();he=he.filter(Te=>{var be,ae,ne,Se;return((be=Te.username)==null?void 0:be.toLowerCase().includes(de))||((ae=Te.email)==null?void 0:ae.toLowerCase().includes(de))||((ne=Te.first_name)==null?void 0:ne.toLowerCase().includes(de))||((Se=Te.last_name)==null?void 0:Se.toLowerCase().includes(de))||Te.company_name&&Te.company_name.toLowerCase().includes(de)})}return he});Rl(async()=>{await Y(),await Q()});async function Y(){var he,de,Te;_.value=!0;try{if(C.value)r.value=await t.fetchUsers();else if(R.value){const[be,ae]=await Promise.all([T5({role:"SALARIE",entrepriseId:(he=t.user)==null?void 0:he.id}),T5({role:"VISITEUR",entrepriseId:(de=t.user)==null?void 0:de.id})]);r.value=[...be,...ae]}else z.value&&(r.value=await T5({role:"VISITEUR",salarieId:(Te=t.user)==null?void 0:Te.id,includeDetails:!0}))}catch(be){console.error("Error fetching users:",be),n.error("Erreur lors du chargement des utilisateurs")}finally{_.value=!1}}async function Q(){var he,de;C.value?(l.value=await t.fetchEnterprises(),i.value=await t.fetchEntrepriseSalaries(((he=t.user)==null?void 0:he.id)||0)):R.value&&(i.value=await t.fetchEntrepriseSalaries(((de=t.user)==null?void 0:de.id)||0))}function oe(){f.value=null,w.value=[],a.value=!0}function le(){a.value=!1,f.value=null,w.value=[]}function me(he){f.value=he,w.value=[],a.value=!0}function we(he){m.value=he,o.value=!0}function ue(he){return!!(C.value||R.value&&(he.role==="SALARIE"||he.role==="VISITEUR")||z.value&&he.role==="VISITEUR")}async function _e(he){var de;try{w.value=[],f.value?(await t.updateUser(f.value.id,he),n.success("Utilisateur mis à jour avec succès")):(await t.createUser(he),n.success("Utilisateur créé avec succès")),a.value=!1,await Y()}catch(Te){(de=Te.response)!=null&&de.data?w.value=AN(Te.response.data):n.error("Une erreur est survenue")}}async function We(){if(m.value)try{await t.deleteUser(m.value.id),n.success("Utilisateur supprimé avec succès"),o.value=!1,await Y()}catch{n.error("Erreur lors de la suppression de l'utilisateur")}}return(he,de)=>{var Te,be,ae,ne;return yt(),Et("div",aW,[V("div",lW,[V("div",uW,[V("h1",cW,[C.value?(yt(),Et("span",hW,"Gestion des utilisateurs")):R.value?(yt(),Et("span",dW,"Gestion des salaries et visiteurs")):z.value?(yt(),Et("span",fW,"Gestion des visiteurs")):yr("",!0)]),V("button",{onClick:oe,class:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},[de[5]||(de[5]=V("svg",{class:"-ml-1 mr-2 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[V("path",{"fill-rule":"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z","clip-rule":"evenodd"})],-1)),C.value?(yt(),Et("span",pW,"Nouvel utilisateur")):R.value?(yt(),Et("span",mW,"Nouveau salarie/visiteur")):z.value?(yt(),Et("span",gW,"Nouvel visiteur")):yr("",!0)])]),V("div",yW,[V("div",vW,[V("div",_W,[C.value||R.value?(yt(),Et("div",bW,[de[9]||(de[9]=V("label",{for:"role-filter",class:"block text-sm font-medium text-gray-700"},"Rôle",-1)),li(V("select",{id:"role-filter","onUpdate:modelValue":de[0]||(de[0]=Se=>M.role=Se),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[de[6]||(de[6]=V("option",{value:""},"Tous les rôles",-1)),C.value?(yt(),Et("option",xW,"Administrateur")):yr("",!0),C.value?(yt(),Et("option",wW,"Entreprise")):yr("",!0),de[7]||(de[7]=V("option",{value:"SALARIE"},"Salarie",-1)),de[8]||(de[8]=V("option",{value:"VISITEUR"},"Visiteur",-1))],512),[[Ka,M.role]])])):yr("",!0),C.value?(yt(),Et("div",CW,[de[11]||(de[11]=V("label",{for:"entreprise-filter",class:"block text-sm font-medium text-gray-700"},"Entreprise",-1)),li(V("select",{id:"entreprise-filter","onUpdate:modelValue":de[1]||(de[1]=Se=>M.entreprise=Se),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[de[10]||(de[10]=V("option",{value:""},"Toutes les entreprises",-1)),(yt(!0),Et($r,null,Ti(l.value,Se=>(yt(),Et("option",{key:Se.id,value:Se.id},er(Tr(kl)(Se)),9,SW))),128))],512),[[Ka,M.entreprise]])])):yr("",!0),C.value||R.value?(yt(),Et("div",LW,[de[13]||(de[13]=V("label",{for:"salarie-filter",class:"block text-sm font-medium text-gray-700"},"Salarie",-1)),li(V("select",{id:"salarie-filter","onUpdate:modelValue":de[2]||(de[2]=Se=>M.salarie=Se),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[de[12]||(de[12]=V("option",{value:""},"Tous les salaries",-1)),(yt(!0),Et($r,null,Ti(W.value,Se=>(yt(),Et("option",{key:Se.id,value:Se.id},er(Tr(kl)(Se)),9,PW))),128))],512),[[Ka,M.salarie]])])):yr("",!0)]),V("div",EW,[de[14]||(de[14]=V("label",{for:"search",class:"block text-sm font-medium text-gray-700"},"Recherche",-1)),li(V("input",{type:"text",id:"search","onUpdate:modelValue":de[3]||(de[3]=Se=>M.search=Se),placeholder:"Rechercher par nom, email, entreprise...",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},null,512),[[to,M.search]])])])]),V("div",MW,[V("div",TW,[V("table",AW,[V("thead",kW,[V("tr",null,[de[15]||(de[15]=V("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Utilisateur ",-1)),de[16]||(de[16]=V("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Rôle ",-1)),de[17]||(de[17]=V("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Email ",-1)),C.value||R.value?(yt(),Et("th",IW," Entreprise ")):yr("",!0),C.value||R.value?(yt(),Et("th",DW," Salarie ")):yr("",!0),de[18]||(de[18]=V("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Statut ",-1)),de[19]||(de[19]=V("th",{scope:"col",class:"relative px-6 py-3"},[V("span",{class:"sr-only"},"Actions")],-1))])]),V("tbody",OW,[_.value?(yt(),Et("tr",RW,de[20]||(de[20]=[V("td",{colspan:"7",class:"py-4 px-6"},[V("div",{class:"h-4 bg-gray-200 rounded w-3/4"})],-1)]))):X.value.length===0?(yt(),Et("tr",BW,de[21]||(de[21]=[V("td",{colspan:"7",class:"py-4 px-6 text-center text-gray-500"}," Aucun utilisateur trouvé ",-1)]))):yr("",!0),(yt(!0),Et($r,null,Ti(X.value,Se=>{var Le;return yt(),Et("tr",{key:Se.id},[V("td",NW,[V("div",FW,[V("div",zW,[V("div",jW,[V("span",UW,er(Tr(IN)(Se.first_name,Se.last_name)),1)])]),V("div",VW,[V("div",$W,er(Tr(kl)(Se)),1),V("div",GW,er(Se.username),1)])])]),V("td",HW,[V("span",{class:$s(Tr(RN)())},er(Tr(ON)(Se.role)),3)]),V("td",qW,er(Se.email),1),C.value||R.value?(yt(),Et("td",WW,[Se.role==="ENTREPRISE"?(yt(),Et($r,{key:0},[rs(" - ")],64)):Se.role==="SALARIE"?(yt(),Et($r,{key:1},[rs(er(Se.entreprise?Tr(kl)(Se.entreprise):"Non assigné"),1)],64)):Se.role==="VISITEUR"?(yt(),Et($r,{key:2},[rs(er((Le=Se.salarie)!=null&&Le.entreprise?Tr(kl)(Se.salarie.entreprise):"Non assigné"),1)],64)):(yt(),Et($r,{key:3},[rs(" - ")],64))])):yr("",!0),C.value||R.value?(yt(),Et("td",ZW,[Se.role==="ENTREPRISE"||Se.role==="ADMIN"?(yt(),Et($r,{key:0},[rs(" - ")],64)):Se.role==="SALARIE"?(yt(),Et($r,{key:1},[rs(" - ")],64)):(yt(),Et($r,{key:2},[rs(er(Se.salarie?Tr(kl)(Se.salarie):"Non assigné"),1)],64))])):yr("",!0),V("td",KW,[V("span",{class:$s(Tr(BN)(Se.is_active))},er(Se.is_active?"Actif":"Inactif"),3)]),V("td",YW,[V("button",{onClick:ze=>me(Se),class:"text-primary-600 hover:text-primary-900 mr-4"}," Modifier ",8,XW),ue(Se)?(yt(),Et("button",{key:0,onClick:ze=>we(Se),class:"text-red-600 hover:text-red-900"}," Supprimer ",8,JW)):yr("",!0)])])}),128))])])])])]),a.value?(yt(),Et("div",QW,[Ns(Kq,{user:f.value,salaries:i.value,entreprises:l.value,"is-admin":C.value,"is-entreprise":R.value,"current-salarie":z.value?(be=(Te=Tr(t).user)==null?void 0:Te.id)==null?void 0:be.toString():void 0,"current-entreprise":R.value?(ne=(ae=Tr(t).user)==null?void 0:ae.id)==null?void 0:ne.toString():void 0,"api-errors":w.value,onClose:le,onSave:_e},null,8,["user","salaries","entreprises","is-admin","is-entreprise","current-salarie","current-entreprise","api-errors"])])):yr("",!0),o.value?(yt(),Hu(oW,{key:1,title:"Supprimer l'utilisateur",message:"Êtes-vous sûr de vouloir supprimer cet utilisateur ? Cette action est irréversible.",onConfirm:We,onCancel:de[4]||(de[4]=Se=>o.value=!1)})):yr("",!0)])}}});var Xk={exports:{}};const tZ=ok(ZB);/**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function LP(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function zf(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?LP(Object(n),!0).forEach(function(r){nZ(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):LP(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ux(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ux=function(t){return typeof t}:ux=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ux(e)}function nZ(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fd(){return Fd=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Fd.apply(this,arguments)}function rZ(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,l;for(l=0;l<r.length;l++)i=r[l],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function iZ(e,t){if(e==null)return{};var n=rZ(e,t),r,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)r=l[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function sZ(e){return oZ(e)||aZ(e)||lZ(e)||uZ()}function oZ(e){if(Array.isArray(e))return h3(e)}function aZ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function lZ(e,t){if(e){if(typeof e=="string")return h3(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h3(e,t)}}function h3(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function uZ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var cZ="1.14.0";function vp(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var wp=vp(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),j_=vp(/Edge/i),PP=vp(/firefox/i),Yv=vp(/safari/i)&&!vp(/chrome/i)&&!vp(/android/i),Jk=vp(/iP(ad|od|hone)/i),hZ=vp(/chrome/i)&&vp(/android/i),Qk={capture:!1,passive:!1};function Gs(e,t,n){e.addEventListener(t,n,!wp&&Qk)}function zs(e,t,n){e.removeEventListener(t,n,!wp&&Qk)}function Zx(e,t){if(t){if(t[0]===">"&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch{return!1}return!1}}function dZ(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function Qd(e,t,n,r){if(e){n=n||document;do{if(t!=null&&(t[0]===">"?e.parentNode===n&&Zx(e,t):Zx(e,t))||r&&e===n)return e;if(e===n)break}while(e=dZ(e))}return null}var EP=/\s+/g;function Il(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var r=(" "+e.className+" ").replace(EP," ").replace(" "+t+" "," ");e.className=(r+(n?" "+t:"")).replace(EP," ")}}function Ci(e,t,n){var r=e&&e.style;if(r){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),t===void 0?n:n[t];!(t in r)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),r[t]=n+(typeof n=="string"?"":"px")}}function vg(e,t){var n="";if(typeof e=="string")n=e;else do{var r=Ci(e,"transform");r&&r!=="none"&&(n=r+" "+n)}while(!t&&(e=e.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(n)}function eI(e,t,n){if(e){var r=e.getElementsByTagName(t),i=0,l=r.length;if(n)for(;i<l;i++)n(r[i],i);return r}return[]}function Bf(){var e=document.scrollingElement;return e||document.documentElement}function fl(e,t,n,r,i){if(!(!e.getBoundingClientRect&&e!==window)){var l,a,o,f,m,_,w;if(e!==window&&e.parentNode&&e!==Bf()?(l=e.getBoundingClientRect(),a=l.top,o=l.left,f=l.bottom,m=l.right,_=l.height,w=l.width):(a=0,o=0,f=window.innerHeight,m=window.innerWidth,_=window.innerHeight,w=window.innerWidth),(t||n)&&e!==window&&(i=i||e.parentNode,!wp))do if(i&&i.getBoundingClientRect&&(Ci(i,"transform")!=="none"||n&&Ci(i,"position")!=="static")){var M=i.getBoundingClientRect();a-=M.top+parseInt(Ci(i,"border-top-width")),o-=M.left+parseInt(Ci(i,"border-left-width")),f=a+l.height,m=o+l.width;break}while(i=i.parentNode);if(r&&e!==window){var C=vg(i||e),R=C&&C.a,z=C&&C.d;C&&(a/=z,o/=R,w/=R,_/=z,f=a+_,m=o+w)}return{top:a,left:o,bottom:f,right:m,width:w,height:_}}}function MP(e,t,n){for(var r=im(e,!0),i=fl(e)[t];r;){var l=fl(r)[n],a=void 0;if(a=i>=l,!a)return r;if(r===Bf())break;r=im(r,!1)}return!1}function q0(e,t,n,r){for(var i=0,l=0,a=e.children;l<a.length;){if(a[l].style.display!=="none"&&a[l]!==Qi.ghost&&(r||a[l]!==Qi.dragged)&&Qd(a[l],n.draggable,e,!1)){if(i===t)return a[l];i++}l++}return null}function OC(e,t){for(var n=e.lastElementChild;n&&(n===Qi.ghost||Ci(n,"display")==="none"||t&&!Zx(n,t));)n=n.previousElementSibling;return n||null}function ru(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==Qi.clone&&(!t||Zx(e,t))&&n++;return n}function TP(e){var t=0,n=0,r=Bf();if(e)do{var i=vg(e),l=i.a,a=i.d;t+=e.scrollLeft*l,n+=e.scrollTop*a}while(e!==r&&(e=e.parentNode));return[t,n]}function fZ(e,t){for(var n in e)if(e.hasOwnProperty(n)){for(var r in t)if(t.hasOwnProperty(r)&&t[r]===e[n][r])return Number(n)}return-1}function im(e,t){if(!e||!e.getBoundingClientRect)return Bf();var n=e,r=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var i=Ci(n);if(n.clientWidth<n.scrollWidth&&(i.overflowX=="auto"||i.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(i.overflowY=="auto"||i.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return Bf();if(r||t)return n;r=!0}}while(n=n.parentNode);return Bf()}function pZ(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function W5(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}var Xv;function tI(e,t){return function(){if(!Xv){var n=arguments,r=this;n.length===1?e.call(r,n[0]):e.apply(r,n),Xv=setTimeout(function(){Xv=void 0},t)}}}function mZ(){clearTimeout(Xv),Xv=void 0}function nI(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function RC(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}function AP(e,t){Ci(e,"position","absolute"),Ci(e,"top",t.top),Ci(e,"left",t.left),Ci(e,"width",t.width),Ci(e,"height",t.height)}function Z5(e){Ci(e,"position",""),Ci(e,"top",""),Ci(e,"left",""),Ci(e,"width",""),Ci(e,"height","")}var nh="Sortable"+new Date().getTime();function gZ(){var e=[],t;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var r=[].slice.call(this.el.children);r.forEach(function(i){if(!(Ci(i,"display")==="none"||i===Qi.ghost)){e.push({target:i,rect:fl(i)});var l=zf({},e[e.length-1].rect);if(i.thisAnimationDuration){var a=vg(i,!0);a&&(l.top-=a.f,l.left-=a.e)}i.fromRect=l}})}},addAnimationState:function(r){e.push(r)},removeAnimationState:function(r){e.splice(fZ(e,{target:r}),1)},animateAll:function(r){var i=this;if(!this.options.animation){clearTimeout(t),typeof r=="function"&&r();return}var l=!1,a=0;e.forEach(function(o){var f=0,m=o.target,_=m.fromRect,w=fl(m),M=m.prevFromRect,C=m.prevToRect,R=o.rect,z=vg(m,!0);z&&(w.top-=z.f,w.left-=z.e),m.toRect=w,m.thisAnimationDuration&&W5(M,w)&&!W5(_,w)&&(R.top-w.top)/(R.left-w.left)===(_.top-w.top)/(_.left-w.left)&&(f=vZ(R,M,C,i.options)),W5(w,_)||(m.prevFromRect=_,m.prevToRect=w,f||(f=i.options.animation),i.animate(m,R,w,f)),f&&(l=!0,a=Math.max(a,f),clearTimeout(m.animationResetTimer),m.animationResetTimer=setTimeout(function(){m.animationTime=0,m.prevFromRect=null,m.fromRect=null,m.prevToRect=null,m.thisAnimationDuration=null},f),m.thisAnimationDuration=f)}),clearTimeout(t),l?t=setTimeout(function(){typeof r=="function"&&r()},a):typeof r=="function"&&r(),e=[]},animate:function(r,i,l,a){if(a){Ci(r,"transition",""),Ci(r,"transform","");var o=vg(this.el),f=o&&o.a,m=o&&o.d,_=(i.left-l.left)/(f||1),w=(i.top-l.top)/(m||1);r.animatingX=!!_,r.animatingY=!!w,Ci(r,"transform","translate3d("+_+"px,"+w+"px,0)"),this.forRepaintDummy=yZ(r),Ci(r,"transition","transform "+a+"ms"+(this.options.easing?" "+this.options.easing:"")),Ci(r,"transform","translate3d(0,0,0)"),typeof r.animated=="number"&&clearTimeout(r.animated),r.animated=setTimeout(function(){Ci(r,"transition",""),Ci(r,"transform",""),r.animated=!1,r.animatingX=!1,r.animatingY=!1},a)}}}}function yZ(e){return e.offsetWidth}function vZ(e,t,n,r){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*r.animation}var d0=[],K5={initializeByDefault:!0},U_={mount:function(t){for(var n in K5)K5.hasOwnProperty(n)&&!(n in t)&&(t[n]=K5[n]);d0.forEach(function(r){if(r.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),d0.push(t)},pluginEvent:function(t,n,r){var i=this;this.eventCanceled=!1,r.cancel=function(){i.eventCanceled=!0};var l=t+"Global";d0.forEach(function(a){n[a.pluginName]&&(n[a.pluginName][l]&&n[a.pluginName][l](zf({sortable:n},r)),n.options[a.pluginName]&&n[a.pluginName][t]&&n[a.pluginName][t](zf({sortable:n},r)))})},initializePlugins:function(t,n,r,i){d0.forEach(function(o){var f=o.pluginName;if(!(!t.options[f]&&!o.initializeByDefault)){var m=new o(t,n,t.options);m.sortable=t,m.options=t.options,t[f]=m,Fd(r,m.defaults)}});for(var l in t.options)if(t.options.hasOwnProperty(l)){var a=this.modifyOption(t,l,t.options[l]);typeof a<"u"&&(t.options[l]=a)}},getEventProperties:function(t,n){var r={};return d0.forEach(function(i){typeof i.eventProperties=="function"&&Fd(r,i.eventProperties.call(n[i.pluginName],t))}),r},modifyOption:function(t,n,r){var i;return d0.forEach(function(l){t[l.pluginName]&&l.optionListeners&&typeof l.optionListeners[n]=="function"&&(i=l.optionListeners[n].call(t[l.pluginName],r))}),i}};function Pv(e){var t=e.sortable,n=e.rootEl,r=e.name,i=e.targetEl,l=e.cloneEl,a=e.toEl,o=e.fromEl,f=e.oldIndex,m=e.newIndex,_=e.oldDraggableIndex,w=e.newDraggableIndex,M=e.originalEvent,C=e.putSortable,R=e.extraEventProperties;if(t=t||n&&n[nh],!!t){var z,W=t.options,X="on"+r.charAt(0).toUpperCase()+r.substr(1);window.CustomEvent&&!wp&&!j_?z=new CustomEvent(r,{bubbles:!0,cancelable:!0}):(z=document.createEvent("Event"),z.initEvent(r,!0,!0)),z.to=a||n,z.from=o||n,z.item=i||n,z.clone=l,z.oldIndex=f,z.newIndex=m,z.oldDraggableIndex=_,z.newDraggableIndex=w,z.originalEvent=M,z.pullMode=C?C.lastPutMode:void 0;var Y=zf(zf({},R),U_.getEventProperties(r,t));for(var Q in Y)z[Q]=Y[Q];n&&n.dispatchEvent(z),W[X]&&W[X].call(t,z)}}var _Z=["evt"],Rh=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=r.evt,l=iZ(r,_Z);U_.pluginEvent.bind(Qi)(t,n,zf({dragEl:Yr,parentEl:eu,ghostEl:Ls,rootEl:hl,nextEl:ig,lastDownEl:cx,cloneEl:tu,cloneHidden:nm,dragStarted:Ev,putSortable:Rc,activeSortable:Qi.active,originalEvent:i,oldIndex:E0,oldDraggableIndex:Jv,newIndex:hd,newDraggableIndex:tm,hideGhostForTarget:oI,unhideGhostForTarget:aI,cloneNowHidden:function(){nm=!0},cloneNowShown:function(){nm=!1},dispatchSortableEvent:function(o){vh({sortable:n,name:o,originalEvent:i})}},l))};function vh(e){Pv(zf({putSortable:Rc,cloneEl:tu,targetEl:Yr,rootEl:hl,oldIndex:E0,oldDraggableIndex:Jv,newIndex:hd,newDraggableIndex:tm},e))}var Yr,eu,Ls,hl,ig,cx,tu,nm,E0,hd,Jv,tm,Lb,Rc,S0=!1,Kx=!1,Yx=[],Xm,Yd,Y5,X5,kP,IP,Ev,f0,Qv,e_=!1,Pb=!1,hx,Yc,J5=[],d3=!1,Xx=[],G2=typeof document<"u",Eb=Jk,DP=j_||wp?"cssFloat":"float",bZ=G2&&!hZ&&!Jk&&"draggable"in document.createElement("div"),rI=function(){if(G2){if(wp)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}}(),iI=function(t,n){var r=Ci(t),i=parseInt(r.width)-parseInt(r.paddingLeft)-parseInt(r.paddingRight)-parseInt(r.borderLeftWidth)-parseInt(r.borderRightWidth),l=q0(t,0,n),a=q0(t,1,n),o=l&&Ci(l),f=a&&Ci(a),m=o&&parseInt(o.marginLeft)+parseInt(o.marginRight)+fl(l).width,_=f&&parseInt(f.marginLeft)+parseInt(f.marginRight)+fl(a).width;if(r.display==="flex")return r.flexDirection==="column"||r.flexDirection==="column-reverse"?"vertical":"horizontal";if(r.display==="grid")return r.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(l&&o.float&&o.float!=="none"){var w=o.float==="left"?"left":"right";return a&&(f.clear==="both"||f.clear===w)?"vertical":"horizontal"}return l&&(o.display==="block"||o.display==="flex"||o.display==="table"||o.display==="grid"||m>=i&&r[DP]==="none"||a&&r[DP]==="none"&&m+_>i)?"vertical":"horizontal"},xZ=function(t,n,r){var i=r?t.left:t.top,l=r?t.right:t.bottom,a=r?t.width:t.height,o=r?n.left:n.top,f=r?n.right:n.bottom,m=r?n.width:n.height;return i===o||l===f||i+a/2===o+m/2},wZ=function(t,n){var r;return Yx.some(function(i){var l=i[nh].options.emptyInsertThreshold;if(!(!l||OC(i))){var a=fl(i),o=t>=a.left-l&&t<=a.right+l,f=n>=a.top-l&&n<=a.bottom+l;if(o&&f)return r=i}}),r},sI=function(t){function n(l,a){return function(o,f,m,_){var w=o.options.group.name&&f.options.group.name&&o.options.group.name===f.options.group.name;if(l==null&&(a||w))return!0;if(l==null||l===!1)return!1;if(a&&l==="clone")return l;if(typeof l=="function")return n(l(o,f,m,_),a)(o,f,m,_);var M=(a?o:f).options.group.name;return l===!0||typeof l=="string"&&l===M||l.join&&l.indexOf(M)>-1}}var r={},i=t.group;(!i||ux(i)!="object")&&(i={name:i}),r.name=i.name,r.checkPull=n(i.pull,!0),r.checkPut=n(i.put),r.revertClone=i.revertClone,t.group=r},oI=function(){!rI&&Ls&&Ci(Ls,"display","none")},aI=function(){!rI&&Ls&&Ci(Ls,"display","")};G2&&document.addEventListener("click",function(e){if(Kx)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Kx=!1,!1},!0);var Jm=function(t){if(Yr){t=t.touches?t.touches[0]:t;var n=wZ(t.clientX,t.clientY);if(n){var r={};for(var i in t)t.hasOwnProperty(i)&&(r[i]=t[i]);r.target=r.rootEl=n,r.preventDefault=void 0,r.stopPropagation=void 0,n[nh]._onDragOver(r)}}},CZ=function(t){Yr&&Yr.parentNode[nh]._isOutsideThisEl(t.target)};function Qi(e,t){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=Fd({},t),e[nh]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return iI(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(a,o){a.setData("Text",o.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Qi.supportPointer!==!1&&"PointerEvent"in window&&!Yv,emptyInsertThreshold:5};U_.initializePlugins(this,e,n);for(var r in n)!(r in t)&&(t[r]=n[r]);sI(t);for(var i in this)i.charAt(0)==="_"&&typeof this[i]=="function"&&(this[i]=this[i].bind(this));this.nativeDraggable=t.forceFallback?!1:bZ,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?Gs(e,"pointerdown",this._onTapStart):(Gs(e,"mousedown",this._onTapStart),Gs(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(Gs(e,"dragover",this),Gs(e,"dragenter",this)),Yx.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),Fd(this,gZ())}Qi.prototype={constructor:Qi,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(f0=null)},_getDirection:function(t,n){return typeof this.options.direction=="function"?this.options.direction.call(this,t,n,Yr):this.options.direction},_onTapStart:function(t){if(t.cancelable){var n=this,r=this.el,i=this.options,l=i.preventOnFilter,a=t.type,o=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,f=(o||t).target,m=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||f,_=i.filter;if(kZ(r),!Yr&&!(/mousedown|pointerdown/.test(a)&&t.button!==0||i.disabled)&&!m.isContentEditable&&!(!this.nativeDraggable&&Yv&&f&&f.tagName.toUpperCase()==="SELECT")&&(f=Qd(f,i.draggable,r,!1),!(f&&f.animated)&&cx!==f)){if(E0=ru(f),Jv=ru(f,i.draggable),typeof _=="function"){if(_.call(this,t,f,this)){vh({sortable:n,rootEl:m,name:"filter",targetEl:f,toEl:r,fromEl:r}),Rh("filter",n,{evt:t}),l&&t.cancelable&&t.preventDefault();return}}else if(_&&(_=_.split(",").some(function(w){if(w=Qd(m,w.trim(),r,!1),w)return vh({sortable:n,rootEl:w,name:"filter",targetEl:f,fromEl:r,toEl:r}),Rh("filter",n,{evt:t}),!0}),_)){l&&t.cancelable&&t.preventDefault();return}i.handle&&!Qd(m,i.handle,r,!1)||this._prepareDragStart(t,o,f)}}},_prepareDragStart:function(t,n,r){var i=this,l=i.el,a=i.options,o=l.ownerDocument,f;if(r&&!Yr&&r.parentNode===l){var m=fl(r);if(hl=l,Yr=r,eu=Yr.parentNode,ig=Yr.nextSibling,cx=r,Lb=a.group,Qi.dragged=Yr,Xm={target:Yr,clientX:(n||t).clientX,clientY:(n||t).clientY},kP=Xm.clientX-m.left,IP=Xm.clientY-m.top,this._lastX=(n||t).clientX,this._lastY=(n||t).clientY,Yr.style["will-change"]="all",f=function(){if(Rh("delayEnded",i,{evt:t}),Qi.eventCanceled){i._onDrop();return}i._disableDelayedDragEvents(),!PP&&i.nativeDraggable&&(Yr.draggable=!0),i._triggerDragStart(t,n),vh({sortable:i,name:"choose",originalEvent:t}),Il(Yr,a.chosenClass,!0)},a.ignore.split(",").forEach(function(_){eI(Yr,_.trim(),Q5)}),Gs(o,"dragover",Jm),Gs(o,"mousemove",Jm),Gs(o,"touchmove",Jm),Gs(o,"mouseup",i._onDrop),Gs(o,"touchend",i._onDrop),Gs(o,"touchcancel",i._onDrop),PP&&this.nativeDraggable&&(this.options.touchStartThreshold=4,Yr.draggable=!0),Rh("delayStart",this,{evt:t}),a.delay&&(!a.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(j_||wp))){if(Qi.eventCanceled){this._onDrop();return}Gs(o,"mouseup",i._disableDelayedDrag),Gs(o,"touchend",i._disableDelayedDrag),Gs(o,"touchcancel",i._disableDelayedDrag),Gs(o,"mousemove",i._delayedDragTouchMoveHandler),Gs(o,"touchmove",i._delayedDragTouchMoveHandler),a.supportPointer&&Gs(o,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(f,a.delay)}else f()}},_delayedDragTouchMoveHandler:function(t){var n=t.touches?t.touches[0]:t;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){Yr&&Q5(Yr),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;zs(t,"mouseup",this._disableDelayedDrag),zs(t,"touchend",this._disableDelayedDrag),zs(t,"touchcancel",this._disableDelayedDrag),zs(t,"mousemove",this._delayedDragTouchMoveHandler),zs(t,"touchmove",this._delayedDragTouchMoveHandler),zs(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,n){n=n||t.pointerType=="touch"&&t,!this.nativeDraggable||n?this.options.supportPointer?Gs(document,"pointermove",this._onTouchMove):n?Gs(document,"touchmove",this._onTouchMove):Gs(document,"mousemove",this._onTouchMove):(Gs(Yr,"dragend",this),Gs(hl,"dragstart",this._onDragStart));try{document.selection?dx(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,n){if(S0=!1,hl&&Yr){Rh("dragStarted",this,{evt:n}),this.nativeDraggable&&Gs(document,"dragover",CZ);var r=this.options;!t&&Il(Yr,r.dragClass,!1),Il(Yr,r.ghostClass,!0),Qi.active=this,t&&this._appendGhost(),vh({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(Yd){this._lastX=Yd.clientX,this._lastY=Yd.clientY,oI();for(var t=document.elementFromPoint(Yd.clientX,Yd.clientY),n=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(Yd.clientX,Yd.clientY),t!==n);)n=t;if(Yr.parentNode[nh]._isOutsideThisEl(t),n)do{if(n[nh]){var r=void 0;if(r=n[nh]._onDragOver({clientX:Yd.clientX,clientY:Yd.clientY,target:t,rootEl:n}),r&&!this.options.dragoverBubble)break}t=n}while(n=n.parentNode);aI()}},_onTouchMove:function(t){if(Xm){var n=this.options,r=n.fallbackTolerance,i=n.fallbackOffset,l=t.touches?t.touches[0]:t,a=Ls&&vg(Ls,!0),o=Ls&&a&&a.a,f=Ls&&a&&a.d,m=Eb&&Yc&&TP(Yc),_=(l.clientX-Xm.clientX+i.x)/(o||1)+(m?m[0]-J5[0]:0)/(o||1),w=(l.clientY-Xm.clientY+i.y)/(f||1)+(m?m[1]-J5[1]:0)/(f||1);if(!Qi.active&&!S0){if(r&&Math.max(Math.abs(l.clientX-this._lastX),Math.abs(l.clientY-this._lastY))<r)return;this._onDragStart(t,!0)}if(Ls){a?(a.e+=_-(Y5||0),a.f+=w-(X5||0)):a={a:1,b:0,c:0,d:1,e:_,f:w};var M="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");Ci(Ls,"webkitTransform",M),Ci(Ls,"mozTransform",M),Ci(Ls,"msTransform",M),Ci(Ls,"transform",M),Y5=_,X5=w,Yd=l}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!Ls){var t=this.options.fallbackOnBody?document.body:hl,n=fl(Yr,!0,Eb,!0,t),r=this.options;if(Eb){for(Yc=t;Ci(Yc,"position")==="static"&&Ci(Yc,"transform")==="none"&&Yc!==document;)Yc=Yc.parentNode;Yc!==document.body&&Yc!==document.documentElement?(Yc===document&&(Yc=Bf()),n.top+=Yc.scrollTop,n.left+=Yc.scrollLeft):Yc=Bf(),J5=TP(Yc)}Ls=Yr.cloneNode(!0),Il(Ls,r.ghostClass,!1),Il(Ls,r.fallbackClass,!0),Il(Ls,r.dragClass,!0),Ci(Ls,"transition",""),Ci(Ls,"transform",""),Ci(Ls,"box-sizing","border-box"),Ci(Ls,"margin",0),Ci(Ls,"top",n.top),Ci(Ls,"left",n.left),Ci(Ls,"width",n.width),Ci(Ls,"height",n.height),Ci(Ls,"opacity","0.8"),Ci(Ls,"position",Eb?"absolute":"fixed"),Ci(Ls,"zIndex","100000"),Ci(Ls,"pointerEvents","none"),Qi.ghost=Ls,t.appendChild(Ls),Ci(Ls,"transform-origin",kP/parseInt(Ls.style.width)*100+"% "+IP/parseInt(Ls.style.height)*100+"%")}},_onDragStart:function(t,n){var r=this,i=t.dataTransfer,l=r.options;if(Rh("dragStart",this,{evt:t}),Qi.eventCanceled){this._onDrop();return}Rh("setupClone",this),Qi.eventCanceled||(tu=RC(Yr),tu.draggable=!1,tu.style["will-change"]="",this._hideClone(),Il(tu,this.options.chosenClass,!1),Qi.clone=tu),r.cloneId=dx(function(){Rh("clone",r),!Qi.eventCanceled&&(r.options.removeCloneOnHide||hl.insertBefore(tu,Yr),r._hideClone(),vh({sortable:r,name:"clone"}))}),!n&&Il(Yr,l.dragClass,!0),n?(Kx=!0,r._loopId=setInterval(r._emulateDragOver,50)):(zs(document,"mouseup",r._onDrop),zs(document,"touchend",r._onDrop),zs(document,"touchcancel",r._onDrop),i&&(i.effectAllowed="move",l.setData&&l.setData.call(r,i,Yr)),Gs(document,"drop",r),Ci(Yr,"transform","translateZ(0)")),S0=!0,r._dragStartId=dx(r._dragStarted.bind(r,n,t)),Gs(document,"selectstart",r),Ev=!0,Yv&&Ci(document.body,"user-select","none")},_onDragOver:function(t){var n=this.el,r=t.target,i,l,a,o=this.options,f=o.group,m=Qi.active,_=Lb===f,w=o.sort,M=Rc||m,C,R=this,z=!1;if(d3)return;function W(Le,ze){Rh(Le,R,zf({evt:t,isOwner:_,axis:C?"vertical":"horizontal",revert:a,dragRect:i,targetRect:l,canSort:w,fromSortable:M,target:r,completed:Y,onMove:function(pt,ge){return Mb(hl,n,Yr,i,pt,fl(pt),t,ge)},changed:Q},ze))}function X(){W("dragOverAnimationCapture"),R.captureAnimationState(),R!==M&&M.captureAnimationState()}function Y(Le){return W("dragOverCompleted",{insertion:Le}),Le&&(_?m._hideClone():m._showClone(R),R!==M&&(Il(Yr,Rc?Rc.options.ghostClass:m.options.ghostClass,!1),Il(Yr,o.ghostClass,!0)),Rc!==R&&R!==Qi.active?Rc=R:R===Qi.active&&Rc&&(Rc=null),M===R&&(R._ignoreWhileAnimating=r),R.animateAll(function(){W("dragOverAnimationComplete"),R._ignoreWhileAnimating=null}),R!==M&&(M.animateAll(),M._ignoreWhileAnimating=null)),(r===Yr&&!Yr.animated||r===n&&!r.animated)&&(f0=null),!o.dragoverBubble&&!t.rootEl&&r!==document&&(Yr.parentNode[nh]._isOutsideThisEl(t.target),!Le&&Jm(t)),!o.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),z=!0}function Q(){hd=ru(Yr),tm=ru(Yr,o.draggable),vh({sortable:R,name:"change",toEl:n,newIndex:hd,newDraggableIndex:tm,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),r=Qd(r,o.draggable,n,!0),W("dragOver"),Qi.eventCanceled)return z;if(Yr.contains(t.target)||r.animated&&r.animatingX&&r.animatingY||R._ignoreWhileAnimating===r)return Y(!1);if(Kx=!1,m&&!o.disabled&&(_?w||(a=eu!==hl):Rc===this||(this.lastPutMode=Lb.checkPull(this,m,Yr,t))&&f.checkPut(this,m,Yr,t))){if(C=this._getDirection(t,r)==="vertical",i=fl(Yr),W("dragOverValid"),Qi.eventCanceled)return z;if(a)return eu=hl,X(),this._hideClone(),W("revert"),Qi.eventCanceled||(ig?hl.insertBefore(Yr,ig):hl.appendChild(Yr)),Y(!0);var oe=OC(n,o.draggable);if(!oe||EZ(t,C,this)&&!oe.animated){if(oe===Yr)return Y(!1);if(oe&&n===t.target&&(r=oe),r&&(l=fl(r)),Mb(hl,n,Yr,i,r,l,t,!!r)!==!1)return X(),n.appendChild(Yr),eu=n,Q(),Y(!0)}else if(oe&&PZ(t,C,this)){var le=q0(n,0,o,!0);if(le===Yr)return Y(!1);if(r=le,l=fl(r),Mb(hl,n,Yr,i,r,l,t,!1)!==!1)return X(),n.insertBefore(Yr,le),eu=n,Q(),Y(!0)}else if(r.parentNode===n){l=fl(r);var me=0,we,ue=Yr.parentNode!==n,_e=!xZ(Yr.animated&&Yr.toRect||i,r.animated&&r.toRect||l,C),We=C?"top":"left",he=MP(r,"top","top")||MP(Yr,"top","top"),de=he?he.scrollTop:void 0;f0!==r&&(we=l[We],e_=!1,Pb=!_e&&o.invertSwap||ue),me=MZ(t,r,l,C,_e?1:o.swapThreshold,o.invertedSwapThreshold==null?o.swapThreshold:o.invertedSwapThreshold,Pb,f0===r);var Te;if(me!==0){var be=ru(Yr);do be-=me,Te=eu.children[be];while(Te&&(Ci(Te,"display")==="none"||Te===Ls))}if(me===0||Te===r)return Y(!1);f0=r,Qv=me;var ae=r.nextElementSibling,ne=!1;ne=me===1;var Se=Mb(hl,n,Yr,i,r,l,t,ne);if(Se!==!1)return(Se===1||Se===-1)&&(ne=Se===1),d3=!0,setTimeout(LZ,30),X(),ne&&!ae?n.appendChild(Yr):r.parentNode.insertBefore(Yr,ne?ae:r),he&&nI(he,0,de-he.scrollTop),eu=Yr.parentNode,we!==void 0&&!Pb&&(hx=Math.abs(we-fl(r)[We])),Q(),Y(!0)}if(n.contains(Yr))return Y(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){zs(document,"mousemove",this._onTouchMove),zs(document,"touchmove",this._onTouchMove),zs(document,"pointermove",this._onTouchMove),zs(document,"dragover",Jm),zs(document,"mousemove",Jm),zs(document,"touchmove",Jm)},_offUpEvents:function(){var t=this.el.ownerDocument;zs(t,"mouseup",this._onDrop),zs(t,"touchend",this._onDrop),zs(t,"pointerup",this._onDrop),zs(t,"touchcancel",this._onDrop),zs(document,"selectstart",this)},_onDrop:function(t){var n=this.el,r=this.options;if(hd=ru(Yr),tm=ru(Yr,r.draggable),Rh("drop",this,{evt:t}),eu=Yr&&Yr.parentNode,hd=ru(Yr),tm=ru(Yr,r.draggable),Qi.eventCanceled){this._nulling();return}S0=!1,Pb=!1,e_=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),f3(this.cloneId),f3(this._dragStartId),this.nativeDraggable&&(zs(document,"drop",this),zs(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Yv&&Ci(document.body,"user-select",""),Ci(Yr,"transform",""),t&&(Ev&&(t.cancelable&&t.preventDefault(),!r.dropBubble&&t.stopPropagation()),Ls&&Ls.parentNode&&Ls.parentNode.removeChild(Ls),(hl===eu||Rc&&Rc.lastPutMode!=="clone")&&tu&&tu.parentNode&&tu.parentNode.removeChild(tu),Yr&&(this.nativeDraggable&&zs(Yr,"dragend",this),Q5(Yr),Yr.style["will-change"]="",Ev&&!S0&&Il(Yr,Rc?Rc.options.ghostClass:this.options.ghostClass,!1),Il(Yr,this.options.chosenClass,!1),vh({sortable:this,name:"unchoose",toEl:eu,newIndex:null,newDraggableIndex:null,originalEvent:t}),hl!==eu?(hd>=0&&(vh({rootEl:eu,name:"add",toEl:eu,fromEl:hl,originalEvent:t}),vh({sortable:this,name:"remove",toEl:eu,originalEvent:t}),vh({rootEl:eu,name:"sort",toEl:eu,fromEl:hl,originalEvent:t}),vh({sortable:this,name:"sort",toEl:eu,originalEvent:t})),Rc&&Rc.save()):hd!==E0&&hd>=0&&(vh({sortable:this,name:"update",toEl:eu,originalEvent:t}),vh({sortable:this,name:"sort",toEl:eu,originalEvent:t})),Qi.active&&((hd==null||hd===-1)&&(hd=E0,tm=Jv),vh({sortable:this,name:"end",toEl:eu,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){Rh("nulling",this),hl=Yr=eu=Ls=ig=tu=cx=nm=Xm=Yd=Ev=hd=tm=E0=Jv=f0=Qv=Rc=Lb=Qi.dragged=Qi.ghost=Qi.clone=Qi.active=null,Xx.forEach(function(t){t.checked=!0}),Xx.length=Y5=X5=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":Yr&&(this._onDragOver(t),SZ(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],n,r=this.el.children,i=0,l=r.length,a=this.options;i<l;i++)n=r[i],Qd(n,a.draggable,this.el,!1)&&t.push(n.getAttribute(a.dataIdAttr)||AZ(n));return t},sort:function(t,n){var r={},i=this.el;this.toArray().forEach(function(l,a){var o=i.children[a];Qd(o,this.options.draggable,i,!1)&&(r[l]=o)},this),n&&this.captureAnimationState(),t.forEach(function(l){r[l]&&(i.removeChild(r[l]),i.appendChild(r[l]))}),n&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,n){return Qd(t,n||this.options.draggable,this.el,!1)},option:function(t,n){var r=this.options;if(n===void 0)return r[t];var i=U_.modifyOption(this,t,n);typeof i<"u"?r[t]=i:r[t]=n,t==="group"&&sI(r)},destroy:function(){Rh("destroy",this);var t=this.el;t[nh]=null,zs(t,"mousedown",this._onTapStart),zs(t,"touchstart",this._onTapStart),zs(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(zs(t,"dragover",this),zs(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Yx.splice(Yx.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!nm){if(Rh("hideClone",this),Qi.eventCanceled)return;Ci(tu,"display","none"),this.options.removeCloneOnHide&&tu.parentNode&&tu.parentNode.removeChild(tu),nm=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(nm){if(Rh("showClone",this),Qi.eventCanceled)return;Yr.parentNode==hl&&!this.options.group.revertClone?hl.insertBefore(tu,Yr):ig?hl.insertBefore(tu,ig):hl.appendChild(tu),this.options.group.revertClone&&this.animate(Yr,tu),Ci(tu,"display",""),nm=!1}}};function SZ(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function Mb(e,t,n,r,i,l,a,o){var f,m=e[nh],_=m.options.onMove,w;return window.CustomEvent&&!wp&&!j_?f=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(f=document.createEvent("Event"),f.initEvent("move",!0,!0)),f.to=t,f.from=e,f.dragged=n,f.draggedRect=r,f.related=i||t,f.relatedRect=l||fl(t),f.willInsertAfter=o,f.originalEvent=a,e.dispatchEvent(f),_&&(w=_.call(m,f,a)),w}function Q5(e){e.draggable=!1}function LZ(){d3=!1}function PZ(e,t,n){var r=fl(q0(n.el,0,n.options,!0)),i=10;return t?e.clientX<r.left-i||e.clientY<r.top&&e.clientX<r.right:e.clientY<r.top-i||e.clientY<r.bottom&&e.clientX<r.left}function EZ(e,t,n){var r=fl(OC(n.el,n.options.draggable)),i=10;return t?e.clientX>r.right+i||e.clientX<=r.right&&e.clientY>r.bottom&&e.clientX>=r.left:e.clientX>r.right&&e.clientY>r.top||e.clientX<=r.right&&e.clientY>r.bottom+i}function MZ(e,t,n,r,i,l,a,o){var f=r?e.clientY:e.clientX,m=r?n.height:n.width,_=r?n.top:n.left,w=r?n.bottom:n.right,M=!1;if(!a){if(o&&hx<m*i){if(!e_&&(Qv===1?f>_+m*l/2:f<w-m*l/2)&&(e_=!0),e_)M=!0;else if(Qv===1?f<_+hx:f>w-hx)return-Qv}else if(f>_+m*(1-i)/2&&f<w-m*(1-i)/2)return TZ(t)}return M=M||a,M&&(f<_+m*l/2||f>w-m*l/2)?f>_+m/2?1:-1:0}function TZ(e){return ru(Yr)<ru(e)?1:-1}function AZ(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,r=0;n--;)r+=t.charCodeAt(n);return r.toString(36)}function kZ(e){Xx.length=0;for(var t=e.getElementsByTagName("input"),n=t.length;n--;){var r=t[n];r.checked&&Xx.push(r)}}function dx(e){return setTimeout(e,0)}function f3(e){return clearTimeout(e)}G2&&Gs(document,"touchmove",function(e){(Qi.active||S0)&&e.cancelable&&e.preventDefault()});Qi.utils={on:Gs,off:zs,css:Ci,find:eI,is:function(t,n){return!!Qd(t,n,t,!1)},extend:pZ,throttle:tI,closest:Qd,toggleClass:Il,clone:RC,index:ru,nextTick:dx,cancelNextTick:f3,detectDirection:iI,getChild:q0};Qi.get=function(e){return e[nh]};Qi.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach(function(r){if(!r.prototype||!r.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(r));r.utils&&(Qi.utils=zf(zf({},Qi.utils),r.utils)),U_.mount(r)})};Qi.create=function(e,t){return new Qi(e,t)};Qi.version=cZ;var Gu=[],Mv,p3,m3=!1,e4,t4,Jx,Tv;function IZ(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return e.prototype={dragStarted:function(n){var r=n.originalEvent;this.sortable.nativeDraggable?Gs(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Gs(document,"pointermove",this._handleFallbackAutoScroll):r.touches?Gs(document,"touchmove",this._handleFallbackAutoScroll):Gs(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var r=n.originalEvent;!this.options.dragOverBubble&&!r.rootEl&&this._handleAutoScroll(r)},drop:function(){this.sortable.nativeDraggable?zs(document,"dragover",this._handleAutoScroll):(zs(document,"pointermove",this._handleFallbackAutoScroll),zs(document,"touchmove",this._handleFallbackAutoScroll),zs(document,"mousemove",this._handleFallbackAutoScroll)),OP(),fx(),mZ()},nulling:function(){Jx=p3=Mv=m3=Tv=e4=t4=null,Gu.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,r){var i=this,l=(n.touches?n.touches[0]:n).clientX,a=(n.touches?n.touches[0]:n).clientY,o=document.elementFromPoint(l,a);if(Jx=n,r||this.options.forceAutoScrollFallback||j_||wp||Yv){n4(n,this.options,o,r);var f=im(o,!0);m3&&(!Tv||l!==e4||a!==t4)&&(Tv&&OP(),Tv=setInterval(function(){var m=im(document.elementFromPoint(l,a),!0);m!==f&&(f=m,fx()),n4(n,i.options,m,r)},10),e4=l,t4=a)}else{if(!this.options.bubbleScroll||im(o,!0)===Bf()){fx();return}n4(n,this.options,im(o,!1),!1)}}},Fd(e,{pluginName:"scroll",initializeByDefault:!0})}function fx(){Gu.forEach(function(e){clearInterval(e.pid)}),Gu=[]}function OP(){clearInterval(Tv)}var n4=tI(function(e,t,n,r){if(t.scroll){var i=(e.touches?e.touches[0]:e).clientX,l=(e.touches?e.touches[0]:e).clientY,a=t.scrollSensitivity,o=t.scrollSpeed,f=Bf(),m=!1,_;p3!==n&&(p3=n,fx(),Mv=t.scroll,_=t.scrollFn,Mv===!0&&(Mv=im(n,!0)));var w=0,M=Mv;do{var C=M,R=fl(C),z=R.top,W=R.bottom,X=R.left,Y=R.right,Q=R.width,oe=R.height,le=void 0,me=void 0,we=C.scrollWidth,ue=C.scrollHeight,_e=Ci(C),We=C.scrollLeft,he=C.scrollTop;C===f?(le=Q<we&&(_e.overflowX==="auto"||_e.overflowX==="scroll"||_e.overflowX==="visible"),me=oe<ue&&(_e.overflowY==="auto"||_e.overflowY==="scroll"||_e.overflowY==="visible")):(le=Q<we&&(_e.overflowX==="auto"||_e.overflowX==="scroll"),me=oe<ue&&(_e.overflowY==="auto"||_e.overflowY==="scroll"));var de=le&&(Math.abs(Y-i)<=a&&We+Q<we)-(Math.abs(X-i)<=a&&!!We),Te=me&&(Math.abs(W-l)<=a&&he+oe<ue)-(Math.abs(z-l)<=a&&!!he);if(!Gu[w])for(var be=0;be<=w;be++)Gu[be]||(Gu[be]={});(Gu[w].vx!=de||Gu[w].vy!=Te||Gu[w].el!==C)&&(Gu[w].el=C,Gu[w].vx=de,Gu[w].vy=Te,clearInterval(Gu[w].pid),(de!=0||Te!=0)&&(m=!0,Gu[w].pid=setInterval((function(){r&&this.layer===0&&Qi.active._onTouchMove(Jx);var ae=Gu[this.layer].vy?Gu[this.layer].vy*o:0,ne=Gu[this.layer].vx?Gu[this.layer].vx*o:0;typeof _=="function"&&_.call(Qi.dragged.parentNode[nh],ne,ae,e,Jx,Gu[this.layer].el)!=="continue"||nI(Gu[this.layer].el,ne,ae)}).bind({layer:w}),24))),w++}while(t.bubbleScroll&&M!==f&&(M=im(M,!1)));m3=m}},30),lI=function(t){var n=t.originalEvent,r=t.putSortable,i=t.dragEl,l=t.activeSortable,a=t.dispatchSortableEvent,o=t.hideGhostForTarget,f=t.unhideGhostForTarget;if(n){var m=r||l;o();var _=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,w=document.elementFromPoint(_.clientX,_.clientY);f(),m&&!m.el.contains(w)&&(a("spill"),this.onSpill({dragEl:i,putSortable:r}))}};function BC(){}BC.prototype={startIndex:null,dragStart:function(t){var n=t.oldDraggableIndex;this.startIndex=n},onSpill:function(t){var n=t.dragEl,r=t.putSortable;this.sortable.captureAnimationState(),r&&r.captureAnimationState();var i=q0(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(n,i):this.sortable.el.appendChild(n),this.sortable.animateAll(),r&&r.animateAll()},drop:lI};Fd(BC,{pluginName:"revertOnSpill"});function NC(){}NC.prototype={onSpill:function(t){var n=t.dragEl,r=t.putSortable,i=r||this.sortable;i.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),i.animateAll()},drop:lI};Fd(NC,{pluginName:"removeOnSpill"});var Ad;function DZ(){function e(){this.defaults={swapClass:"sortable-swap-highlight"}}return e.prototype={dragStart:function(n){var r=n.dragEl;Ad=r},dragOverValid:function(n){var r=n.completed,i=n.target,l=n.onMove,a=n.activeSortable,o=n.changed,f=n.cancel;if(a.options.swap){var m=this.sortable.el,_=this.options;if(i&&i!==m){var w=Ad;l(i)!==!1?(Il(i,_.swapClass,!0),Ad=i):Ad=null,w&&w!==Ad&&Il(w,_.swapClass,!1)}o(),r(!0),f()}},drop:function(n){var r=n.activeSortable,i=n.putSortable,l=n.dragEl,a=i||this.sortable,o=this.options;Ad&&Il(Ad,o.swapClass,!1),Ad&&(o.swap||i&&i.options.swap)&&l!==Ad&&(a.captureAnimationState(),a!==r&&r.captureAnimationState(),OZ(l,Ad),a.animateAll(),a!==r&&r.animateAll())},nulling:function(){Ad=null}},Fd(e,{pluginName:"swap",eventProperties:function(){return{swapItem:Ad}}})}function OZ(e,t){var n=e.parentNode,r=t.parentNode,i,l;!n||!r||n.isEqualNode(t)||r.isEqualNode(e)||(i=ru(e),l=ru(t),n.isEqualNode(r)&&i<l&&l++,n.insertBefore(t,n.children[i]),r.insertBefore(e,r.children[l]))}var ms=[],cd=[],cv,Xd,hv=!1,Bh=!1,p0=!1,Oa,dv,Tb;function RZ(){function e(t){for(var n in this)n.charAt(0)==="_"&&typeof this[n]=="function"&&(this[n]=this[n].bind(this));t.options.supportPointer?Gs(document,"pointerup",this._deselectMultiDrag):(Gs(document,"mouseup",this._deselectMultiDrag),Gs(document,"touchend",this._deselectMultiDrag)),Gs(document,"keydown",this._checkKeyDown),Gs(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(i,l){var a="";ms.length&&Xd===t?ms.forEach(function(o,f){a+=(f?", ":"")+o.textContent}):a=l.textContent,i.setData("Text",a)}}}return e.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(n){var r=n.dragEl;Oa=r},delayEnded:function(){this.isMultiDrag=~ms.indexOf(Oa)},setupClone:function(n){var r=n.sortable,i=n.cancel;if(this.isMultiDrag){for(var l=0;l<ms.length;l++)cd.push(RC(ms[l])),cd[l].sortableIndex=ms[l].sortableIndex,cd[l].draggable=!1,cd[l].style["will-change"]="",Il(cd[l],this.options.selectedClass,!1),ms[l]===Oa&&Il(cd[l],this.options.chosenClass,!1);r._hideClone(),i()}},clone:function(n){var r=n.sortable,i=n.rootEl,l=n.dispatchSortableEvent,a=n.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||ms.length&&Xd===r&&(RP(!0,i),l("clone"),a()))},showClone:function(n){var r=n.cloneNowShown,i=n.rootEl,l=n.cancel;this.isMultiDrag&&(RP(!1,i),cd.forEach(function(a){Ci(a,"display","")}),r(),Tb=!1,l())},hideClone:function(n){var r=this;n.sortable;var i=n.cloneNowHidden,l=n.cancel;this.isMultiDrag&&(cd.forEach(function(a){Ci(a,"display","none"),r.options.removeCloneOnHide&&a.parentNode&&a.parentNode.removeChild(a)}),i(),Tb=!0,l())},dragStartGlobal:function(n){n.sortable,!this.isMultiDrag&&Xd&&Xd.multiDrag._deselectMultiDrag(),ms.forEach(function(r){r.sortableIndex=ru(r)}),ms=ms.sort(function(r,i){return r.sortableIndex-i.sortableIndex}),p0=!0},dragStarted:function(n){var r=this,i=n.sortable;if(this.isMultiDrag){if(this.options.sort&&(i.captureAnimationState(),this.options.animation)){ms.forEach(function(a){a!==Oa&&Ci(a,"position","absolute")});var l=fl(Oa,!1,!0,!0);ms.forEach(function(a){a!==Oa&&AP(a,l)}),Bh=!0,hv=!0}i.animateAll(function(){Bh=!1,hv=!1,r.options.animation&&ms.forEach(function(a){Z5(a)}),r.options.sort&&Ab()})}},dragOver:function(n){var r=n.target,i=n.completed,l=n.cancel;Bh&&~ms.indexOf(r)&&(i(!1),l())},revert:function(n){var r=n.fromSortable,i=n.rootEl,l=n.sortable,a=n.dragRect;ms.length>1&&(ms.forEach(function(o){l.addAnimationState({target:o,rect:Bh?fl(o):a}),Z5(o),o.fromRect=a,r.removeAnimationState(o)}),Bh=!1,BZ(!this.options.removeCloneOnHide,i))},dragOverCompleted:function(n){var r=n.sortable,i=n.isOwner,l=n.insertion,a=n.activeSortable,o=n.parentEl,f=n.putSortable,m=this.options;if(l){if(i&&a._hideClone(),hv=!1,m.animation&&ms.length>1&&(Bh||!i&&!a.options.sort&&!f)){var _=fl(Oa,!1,!0,!0);ms.forEach(function(M){M!==Oa&&(AP(M,_),o.appendChild(M))}),Bh=!0}if(!i)if(Bh||Ab(),ms.length>1){var w=Tb;a._showClone(r),a.options.animation&&!Tb&&w&&cd.forEach(function(M){a.addAnimationState({target:M,rect:dv}),M.fromRect=dv,M.thisAnimationDuration=null})}else a._showClone(r)}},dragOverAnimationCapture:function(n){var r=n.dragRect,i=n.isOwner,l=n.activeSortable;if(ms.forEach(function(o){o.thisAnimationDuration=null}),l.options.animation&&!i&&l.multiDrag.isMultiDrag){dv=Fd({},r);var a=vg(Oa,!0);dv.top-=a.f,dv.left-=a.e}},dragOverAnimationComplete:function(){Bh&&(Bh=!1,Ab())},drop:function(n){var r=n.originalEvent,i=n.rootEl,l=n.parentEl,a=n.sortable,o=n.dispatchSortableEvent,f=n.oldIndex,m=n.putSortable,_=m||this.sortable;if(r){var w=this.options,M=l.children;if(!p0)if(w.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),Il(Oa,w.selectedClass,!~ms.indexOf(Oa)),~ms.indexOf(Oa))ms.splice(ms.indexOf(Oa),1),cv=null,Pv({sortable:a,rootEl:i,name:"deselect",targetEl:Oa});else{if(ms.push(Oa),Pv({sortable:a,rootEl:i,name:"select",targetEl:Oa}),r.shiftKey&&cv&&a.el.contains(cv)){var C=ru(cv),R=ru(Oa);if(~C&&~R&&C!==R){var z,W;for(R>C?(W=C,z=R):(W=R,z=C+1);W<z;W++)~ms.indexOf(M[W])||(Il(M[W],w.selectedClass,!0),ms.push(M[W]),Pv({sortable:a,rootEl:i,name:"select",targetEl:M[W]}))}}else cv=Oa;Xd=_}if(p0&&this.isMultiDrag){if(Bh=!1,(l[nh].options.sort||l!==i)&&ms.length>1){var X=fl(Oa),Y=ru(Oa,":not(."+this.options.selectedClass+")");if(!hv&&w.animation&&(Oa.thisAnimationDuration=null),_.captureAnimationState(),!hv&&(w.animation&&(Oa.fromRect=X,ms.forEach(function(oe){if(oe.thisAnimationDuration=null,oe!==Oa){var le=Bh?fl(oe):X;oe.fromRect=le,_.addAnimationState({target:oe,rect:le})}})),Ab(),ms.forEach(function(oe){M[Y]?l.insertBefore(oe,M[Y]):l.appendChild(oe),Y++}),f===ru(Oa))){var Q=!1;ms.forEach(function(oe){if(oe.sortableIndex!==ru(oe)){Q=!0;return}}),Q&&o("update")}ms.forEach(function(oe){Z5(oe)}),_.animateAll()}Xd=_}(i===l||m&&m.lastPutMode!=="clone")&&cd.forEach(function(oe){oe.parentNode&&oe.parentNode.removeChild(oe)})}},nullingGlobal:function(){this.isMultiDrag=p0=!1,cd.length=0},destroyGlobal:function(){this._deselectMultiDrag(),zs(document,"pointerup",this._deselectMultiDrag),zs(document,"mouseup",this._deselectMultiDrag),zs(document,"touchend",this._deselectMultiDrag),zs(document,"keydown",this._checkKeyDown),zs(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(n){if(!(typeof p0<"u"&&p0)&&Xd===this.sortable&&!(n&&Qd(n.target,this.options.draggable,this.sortable.el,!1))&&!(n&&n.button!==0))for(;ms.length;){var r=ms[0];Il(r,this.options.selectedClass,!1),ms.shift(),Pv({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:r})}},_checkKeyDown:function(n){n.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(n){n.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},Fd(e,{pluginName:"multiDrag",utils:{select:function(n){var r=n.parentNode[nh];!r||!r.options.multiDrag||~ms.indexOf(n)||(Xd&&Xd!==r&&(Xd.multiDrag._deselectMultiDrag(),Xd=r),Il(n,r.options.selectedClass,!0),ms.push(n))},deselect:function(n){var r=n.parentNode[nh],i=ms.indexOf(n);!r||!r.options.multiDrag||!~i||(Il(n,r.options.selectedClass,!1),ms.splice(i,1))}},eventProperties:function(){var n=this,r=[],i=[];return ms.forEach(function(l){r.push({multiDragElement:l,index:l.sortableIndex});var a;Bh&&l!==Oa?a=-1:Bh?a=ru(l,":not(."+n.options.selectedClass+")"):a=ru(l),i.push({multiDragElement:l,index:a})}),{items:sZ(ms),clones:[].concat(cd),oldIndicies:r,newIndicies:i}},optionListeners:{multiDragKey:function(n){return n=n.toLowerCase(),n==="ctrl"?n="Control":n.length>1&&(n=n.charAt(0).toUpperCase()+n.substr(1)),n}}})}function BZ(e,t){ms.forEach(function(n,r){var i=t.children[n.sortableIndex+(e?Number(r):0)];i?t.insertBefore(n,i):t.appendChild(n)})}function RP(e,t){cd.forEach(function(n,r){var i=t.children[n.sortableIndex+(e?Number(r):0)];i?t.insertBefore(n,i):t.appendChild(n)})}function Ab(){ms.forEach(function(e){e!==Oa&&e.parentNode&&e.parentNode.removeChild(e)})}Qi.mount(new IZ);Qi.mount(NC,BC);const NZ=Object.freeze(Object.defineProperty({__proto__:null,MultiDrag:RZ,Sortable:Qi,Swap:DZ,default:Qi},Symbol.toStringTag,{value:"Module"})),FZ=ok(NZ);(function(e,t){(function(r,i){e.exports=i(tZ,FZ)})(typeof self<"u"?self:lc,function(n,r){return function(i){var l={};function a(o){if(l[o])return l[o].exports;var f=l[o]={i:o,l:!1,exports:{}};return i[o].call(f.exports,f,f.exports,a),f.l=!0,f.exports}return a.m=i,a.c=l,a.d=function(o,f,m){a.o(o,f)||Object.defineProperty(o,f,{enumerable:!0,get:m})},a.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},a.t=function(o,f){if(f&1&&(o=a(o)),f&8||f&4&&typeof o=="object"&&o&&o.__esModule)return o;var m=Object.create(null);if(a.r(m),Object.defineProperty(m,"default",{enumerable:!0,value:o}),f&2&&typeof o!="string")for(var _ in o)a.d(m,_,(function(w){return o[w]}).bind(null,_));return m},a.n=function(o){var f=o&&o.__esModule?function(){return o.default}:function(){return o};return a.d(f,"a",f),f},a.o=function(o,f){return Object.prototype.hasOwnProperty.call(o,f)},a.p="",a(a.s="fb15")}({"00ee":function(i,l,a){var o=a("b622"),f=o("toStringTag"),m={};m[f]="z",i.exports=String(m)==="[object z]"},"0366":function(i,l,a){var o=a("1c0b");i.exports=function(f,m,_){if(o(f),m===void 0)return f;switch(_){case 0:return function(){return f.call(m)};case 1:return function(w){return f.call(m,w)};case 2:return function(w,M){return f.call(m,w,M)};case 3:return function(w,M,C){return f.call(m,w,M,C)}}return function(){return f.apply(m,arguments)}}},"057f":function(i,l,a){var o=a("fc6a"),f=a("241c").f,m={}.toString,_=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],w=function(M){try{return f(M)}catch{return _.slice()}};i.exports.f=function(C){return _&&m.call(C)=="[object Window]"?w(C):f(o(C))}},"06cf":function(i,l,a){var o=a("83ab"),f=a("d1e7"),m=a("5c6c"),_=a("fc6a"),w=a("c04e"),M=a("5135"),C=a("0cfb"),R=Object.getOwnPropertyDescriptor;l.f=o?R:function(W,X){if(W=_(W),X=w(X,!0),C)try{return R(W,X)}catch{}if(M(W,X))return m(!f.f.call(W,X),W[X])}},"0cfb":function(i,l,a){var o=a("83ab"),f=a("d039"),m=a("cc12");i.exports=!o&&!f(function(){return Object.defineProperty(m("div"),"a",{get:function(){return 7}}).a!=7})},"13d5":function(i,l,a){var o=a("23e7"),f=a("d58f").left,m=a("a640"),_=a("ae40"),w=m("reduce"),M=_("reduce",{1:0});o({target:"Array",proto:!0,forced:!w||!M},{reduce:function(R){return f(this,R,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"14c3":function(i,l,a){var o=a("c6b6"),f=a("9263");i.exports=function(m,_){var w=m.exec;if(typeof w=="function"){var M=w.call(m,_);if(typeof M!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return M}if(o(m)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return f.call(m,_)}},"159b":function(i,l,a){var o=a("da84"),f=a("fdbc"),m=a("17c2"),_=a("9112");for(var w in f){var M=o[w],C=M&&M.prototype;if(C&&C.forEach!==m)try{_(C,"forEach",m)}catch{C.forEach=m}}},"17c2":function(i,l,a){var o=a("b727").forEach,f=a("a640"),m=a("ae40"),_=f("forEach"),w=m("forEach");i.exports=!_||!w?function(C){return o(this,C,arguments.length>1?arguments[1]:void 0)}:[].forEach},"1be4":function(i,l,a){var o=a("d066");i.exports=o("document","documentElement")},"1c0b":function(i,l){i.exports=function(a){if(typeof a!="function")throw TypeError(String(a)+" is not a function");return a}},"1c7e":function(i,l,a){var o=a("b622"),f=o("iterator"),m=!1;try{var _=0,w={next:function(){return{done:!!_++}},return:function(){m=!0}};w[f]=function(){return this},Array.from(w,function(){throw 2})}catch{}i.exports=function(M,C){if(!C&&!m)return!1;var R=!1;try{var z={};z[f]=function(){return{next:function(){return{done:R=!0}}}},M(z)}catch{}return R}},"1d80":function(i,l){i.exports=function(a){if(a==null)throw TypeError("Can't call method on "+a);return a}},"1dde":function(i,l,a){var o=a("d039"),f=a("b622"),m=a("2d00"),_=f("species");i.exports=function(w){return m>=51||!o(function(){var M=[],C=M.constructor={};return C[_]=function(){return{foo:1}},M[w](Boolean).foo!==1})}},"23cb":function(i,l,a){var o=a("a691"),f=Math.max,m=Math.min;i.exports=function(_,w){var M=o(_);return M<0?f(M+w,0):m(M,w)}},"23e7":function(i,l,a){var o=a("da84"),f=a("06cf").f,m=a("9112"),_=a("6eeb"),w=a("ce4e"),M=a("e893"),C=a("94ca");i.exports=function(R,z){var W=R.target,X=R.global,Y=R.stat,Q,oe,le,me,we,ue;if(X?oe=o:Y?oe=o[W]||w(W,{}):oe=(o[W]||{}).prototype,oe)for(le in z){if(we=z[le],R.noTargetGet?(ue=f(oe,le),me=ue&&ue.value):me=oe[le],Q=C(X?le:W+(Y?".":"#")+le,R.forced),!Q&&me!==void 0){if(typeof we==typeof me)continue;M(we,me)}(R.sham||me&&me.sham)&&m(we,"sham",!0),_(oe,le,we,R)}}},"241c":function(i,l,a){var o=a("ca84"),f=a("7839"),m=f.concat("length","prototype");l.f=Object.getOwnPropertyNames||function(w){return o(w,m)}},"25f0":function(i,l,a){var o=a("6eeb"),f=a("825a"),m=a("d039"),_=a("ad6d"),w="toString",M=RegExp.prototype,C=M[w],R=m(function(){return C.call({source:"a",flags:"b"})!="/a/b"}),z=C.name!=w;(R||z)&&o(RegExp.prototype,w,function(){var X=f(this),Y=String(X.source),Q=X.flags,oe=String(Q===void 0&&X instanceof RegExp&&!("flags"in M)?_.call(X):Q);return"/"+Y+"/"+oe},{unsafe:!0})},"2ca0":function(i,l,a){var o=a("23e7"),f=a("06cf").f,m=a("50c4"),_=a("5a34"),w=a("1d80"),M=a("ab13"),C=a("c430"),R="".startsWith,z=Math.min,W=M("startsWith"),X=!C&&!W&&!!function(){var Y=f(String.prototype,"startsWith");return Y&&!Y.writable}();o({target:"String",proto:!0,forced:!X&&!W},{startsWith:function(Q){var oe=String(w(this));_(Q);var le=m(z(arguments.length>1?arguments[1]:void 0,oe.length)),me=String(Q);return R?R.call(oe,me,le):oe.slice(le,le+me.length)===me}})},"2d00":function(i,l,a){var o=a("da84"),f=a("342f"),m=o.process,_=m&&m.versions,w=_&&_.v8,M,C;w?(M=w.split("."),C=M[0]+M[1]):f&&(M=f.match(/Edge\/(\d+)/),(!M||M[1]>=74)&&(M=f.match(/Chrome\/(\d+)/),M&&(C=M[1]))),i.exports=C&&+C},"342f":function(i,l,a){var o=a("d066");i.exports=o("navigator","userAgent")||""},"35a1":function(i,l,a){var o=a("f5df"),f=a("3f8c"),m=a("b622"),_=m("iterator");i.exports=function(w){if(w!=null)return w[_]||w["@@iterator"]||f[o(w)]}},"37e8":function(i,l,a){var o=a("83ab"),f=a("9bf2"),m=a("825a"),_=a("df75");i.exports=o?Object.defineProperties:function(M,C){m(M);for(var R=_(C),z=R.length,W=0,X;z>W;)f.f(M,X=R[W++],C[X]);return M}},"3bbe":function(i,l,a){var o=a("861d");i.exports=function(f){if(!o(f)&&f!==null)throw TypeError("Can't set "+String(f)+" as a prototype");return f}},"3ca3":function(i,l,a){var o=a("6547").charAt,f=a("69f3"),m=a("7dd0"),_="String Iterator",w=f.set,M=f.getterFor(_);m(String,"String",function(C){w(this,{type:_,string:String(C),index:0})},function(){var R=M(this),z=R.string,W=R.index,X;return W>=z.length?{value:void 0,done:!0}:(X=o(z,W),R.index+=X.length,{value:X,done:!1})})},"3f8c":function(i,l){i.exports={}},4160:function(i,l,a){var o=a("23e7"),f=a("17c2");o({target:"Array",proto:!0,forced:[].forEach!=f},{forEach:f})},"428f":function(i,l,a){var o=a("da84");i.exports=o},"44ad":function(i,l,a){var o=a("d039"),f=a("c6b6"),m="".split;i.exports=o(function(){return!Object("z").propertyIsEnumerable(0)})?function(_){return f(_)=="String"?m.call(_,""):Object(_)}:Object},"44d2":function(i,l,a){var o=a("b622"),f=a("7c73"),m=a("9bf2"),_=o("unscopables"),w=Array.prototype;w[_]==null&&m.f(w,_,{configurable:!0,value:f(null)}),i.exports=function(M){w[_][M]=!0}},"44e7":function(i,l,a){var o=a("861d"),f=a("c6b6"),m=a("b622"),_=m("match");i.exports=function(w){var M;return o(w)&&((M=w[_])!==void 0?!!M:f(w)=="RegExp")}},4930:function(i,l,a){var o=a("d039");i.exports=!!Object.getOwnPropertySymbols&&!o(function(){return!String(Symbol())})},"4d64":function(i,l,a){var o=a("fc6a"),f=a("50c4"),m=a("23cb"),_=function(w){return function(M,C,R){var z=o(M),W=f(z.length),X=m(R,W),Y;if(w&&C!=C){for(;W>X;)if(Y=z[X++],Y!=Y)return!0}else for(;W>X;X++)if((w||X in z)&&z[X]===C)return w||X||0;return!w&&-1}};i.exports={includes:_(!0),indexOf:_(!1)}},"4de4":function(i,l,a){var o=a("23e7"),f=a("b727").filter,m=a("1dde"),_=a("ae40"),w=m("filter"),M=_("filter");o({target:"Array",proto:!0,forced:!w||!M},{filter:function(R){return f(this,R,arguments.length>1?arguments[1]:void 0)}})},"4df4":function(i,l,a){var o=a("0366"),f=a("7b0b"),m=a("9bdd"),_=a("e95a"),w=a("50c4"),M=a("8418"),C=a("35a1");i.exports=function(z){var W=f(z),X=typeof this=="function"?this:Array,Y=arguments.length,Q=Y>1?arguments[1]:void 0,oe=Q!==void 0,le=C(W),me=0,we,ue,_e,We,he,de;if(oe&&(Q=o(Q,Y>2?arguments[2]:void 0,2)),le!=null&&!(X==Array&&_(le)))for(We=le.call(W),he=We.next,ue=new X;!(_e=he.call(We)).done;me++)de=oe?m(We,Q,[_e.value,me],!0):_e.value,M(ue,me,de);else for(we=w(W.length),ue=new X(we);we>me;me++)de=oe?Q(W[me],me):W[me],M(ue,me,de);return ue.length=me,ue}},"4fad":function(i,l,a){var o=a("23e7"),f=a("6f53").entries;o({target:"Object",stat:!0},{entries:function(_){return f(_)}})},"50c4":function(i,l,a){var o=a("a691"),f=Math.min;i.exports=function(m){return m>0?f(o(m),9007199254740991):0}},5135:function(i,l){var a={}.hasOwnProperty;i.exports=function(o,f){return a.call(o,f)}},5319:function(i,l,a){var o=a("d784"),f=a("825a"),m=a("7b0b"),_=a("50c4"),w=a("a691"),M=a("1d80"),C=a("8aa5"),R=a("14c3"),z=Math.max,W=Math.min,X=Math.floor,Y=/\$([$&'`]|\d\d?|<[^>]*>)/g,Q=/\$([$&'`]|\d\d?)/g,oe=function(le){return le===void 0?le:String(le)};o("replace",2,function(le,me,we,ue){var _e=ue.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,We=ue.REPLACE_KEEPS_$0,he=_e?"$":"$0";return[function(be,ae){var ne=M(this),Se=be==null?void 0:be[le];return Se!==void 0?Se.call(be,ne,ae):me.call(String(ne),be,ae)},function(Te,be){if(!_e&&We||typeof be=="string"&&be.indexOf(he)===-1){var ae=we(me,Te,this,be);if(ae.done)return ae.value}var ne=f(Te),Se=String(this),Le=typeof be=="function";Le||(be=String(be));var ze=ne.global;if(ze){var He=ne.unicode;ne.lastIndex=0}for(var pt=[];;){var ge=R(ne,Se);if(ge===null||(pt.push(ge),!ze))break;var Ie=String(ge[0]);Ie===""&&(ne.lastIndex=C(Se,_(ne.lastIndex),He))}for(var Ne="",Ve=0,it=0;it<pt.length;it++){ge=pt[it];for(var lt=String(ge[0]),Mt=z(W(w(ge.index),Se.length),0),wt=[],rn=1;rn<ge.length;rn++)wt.push(oe(ge[rn]));var yn=ge.groups;if(Le){var Pn=[lt].concat(wt,Mt,Se);yn!==void 0&&Pn.push(yn);var De=String(be.apply(void 0,Pn))}else De=de(lt,Se,Mt,wt,yn,be);Mt>=Ve&&(Ne+=Se.slice(Ve,Mt)+De,Ve=Mt+lt.length)}return Ne+Se.slice(Ve)}];function de(Te,be,ae,ne,Se,Le){var ze=ae+Te.length,He=ne.length,pt=Q;return Se!==void 0&&(Se=m(Se),pt=Y),me.call(Le,pt,function(ge,Ie){var Ne;switch(Ie.charAt(0)){case"$":return"$";case"&":return Te;case"`":return be.slice(0,ae);case"'":return be.slice(ze);case"<":Ne=Se[Ie.slice(1,-1)];break;default:var Ve=+Ie;if(Ve===0)return ge;if(Ve>He){var it=X(Ve/10);return it===0?ge:it<=He?ne[it-1]===void 0?Ie.charAt(1):ne[it-1]+Ie.charAt(1):ge}Ne=ne[Ve-1]}return Ne===void 0?"":Ne})}})},5692:function(i,l,a){var o=a("c430"),f=a("c6cd");(i.exports=function(m,_){return f[m]||(f[m]=_!==void 0?_:{})})("versions",[]).push({version:"3.6.5",mode:o?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},"56ef":function(i,l,a){var o=a("d066"),f=a("241c"),m=a("7418"),_=a("825a");i.exports=o("Reflect","ownKeys")||function(M){var C=f.f(_(M)),R=m.f;return R?C.concat(R(M)):C}},"5a34":function(i,l,a){var o=a("44e7");i.exports=function(f){if(o(f))throw TypeError("The method doesn't accept regular expressions");return f}},"5c6c":function(i,l){i.exports=function(a,o){return{enumerable:!(a&1),configurable:!(a&2),writable:!(a&4),value:o}}},"5db7":function(i,l,a){var o=a("23e7"),f=a("a2bf"),m=a("7b0b"),_=a("50c4"),w=a("1c0b"),M=a("65f0");o({target:"Array",proto:!0},{flatMap:function(R){var z=m(this),W=_(z.length),X;return w(R),X=M(z,0),X.length=f(X,z,z,W,0,1,R,arguments.length>1?arguments[1]:void 0),X}})},6547:function(i,l,a){var o=a("a691"),f=a("1d80"),m=function(_){return function(w,M){var C=String(f(w)),R=o(M),z=C.length,W,X;return R<0||R>=z?_?"":void 0:(W=C.charCodeAt(R),W<55296||W>56319||R+1===z||(X=C.charCodeAt(R+1))<56320||X>57343?_?C.charAt(R):W:_?C.slice(R,R+2):(W-55296<<10)+(X-56320)+65536)}};i.exports={codeAt:m(!1),charAt:m(!0)}},"65f0":function(i,l,a){var o=a("861d"),f=a("e8b5"),m=a("b622"),_=m("species");i.exports=function(w,M){var C;return f(w)&&(C=w.constructor,typeof C=="function"&&(C===Array||f(C.prototype))?C=void 0:o(C)&&(C=C[_],C===null&&(C=void 0))),new(C===void 0?Array:C)(M===0?0:M)}},"69f3":function(i,l,a){var o=a("7f9a"),f=a("da84"),m=a("861d"),_=a("9112"),w=a("5135"),M=a("f772"),C=a("d012"),R=f.WeakMap,z,W,X,Y=function(_e){return X(_e)?W(_e):z(_e,{})},Q=function(_e){return function(We){var he;if(!m(We)||(he=W(We)).type!==_e)throw TypeError("Incompatible receiver, "+_e+" required");return he}};if(o){var oe=new R,le=oe.get,me=oe.has,we=oe.set;z=function(_e,We){return we.call(oe,_e,We),We},W=function(_e){return le.call(oe,_e)||{}},X=function(_e){return me.call(oe,_e)}}else{var ue=M("state");C[ue]=!0,z=function(_e,We){return _(_e,ue,We),We},W=function(_e){return w(_e,ue)?_e[ue]:{}},X=function(_e){return w(_e,ue)}}i.exports={set:z,get:W,has:X,enforce:Y,getterFor:Q}},"6eeb":function(i,l,a){var o=a("da84"),f=a("9112"),m=a("5135"),_=a("ce4e"),w=a("8925"),M=a("69f3"),C=M.get,R=M.enforce,z=String(String).split("String");(i.exports=function(W,X,Y,Q){var oe=Q?!!Q.unsafe:!1,le=Q?!!Q.enumerable:!1,me=Q?!!Q.noTargetGet:!1;if(typeof Y=="function"&&(typeof X=="string"&&!m(Y,"name")&&f(Y,"name",X),R(Y).source=z.join(typeof X=="string"?X:"")),W===o){le?W[X]=Y:_(X,Y);return}else oe?!me&&W[X]&&(le=!0):delete W[X];le?W[X]=Y:f(W,X,Y)})(Function.prototype,"toString",function(){return typeof this=="function"&&C(this).source||w(this)})},"6f53":function(i,l,a){var o=a("83ab"),f=a("df75"),m=a("fc6a"),_=a("d1e7").f,w=function(M){return function(C){for(var R=m(C),z=f(R),W=z.length,X=0,Y=[],Q;W>X;)Q=z[X++],(!o||_.call(R,Q))&&Y.push(M?[Q,R[Q]]:R[Q]);return Y}};i.exports={entries:w(!0),values:w(!1)}},"73d9":function(i,l,a){var o=a("44d2");o("flatMap")},7418:function(i,l){l.f=Object.getOwnPropertySymbols},"746f":function(i,l,a){var o=a("428f"),f=a("5135"),m=a("e538"),_=a("9bf2").f;i.exports=function(w){var M=o.Symbol||(o.Symbol={});f(M,w)||_(M,w,{value:m.f(w)})}},7839:function(i,l){i.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"7b0b":function(i,l,a){var o=a("1d80");i.exports=function(f){return Object(o(f))}},"7c73":function(i,l,a){var o=a("825a"),f=a("37e8"),m=a("7839"),_=a("d012"),w=a("1be4"),M=a("cc12"),C=a("f772"),R=">",z="<",W="prototype",X="script",Y=C("IE_PROTO"),Q=function(){},oe=function(_e){return z+X+R+_e+z+"/"+X+R},le=function(_e){_e.write(oe("")),_e.close();var We=_e.parentWindow.Object;return _e=null,We},me=function(){var _e=M("iframe"),We="java"+X+":",he;return _e.style.display="none",w.appendChild(_e),_e.src=String(We),he=_e.contentWindow.document,he.open(),he.write(oe("document.F=Object")),he.close(),he.F},we,ue=function(){try{we=document.domain&&new ActiveXObject("htmlfile")}catch{}ue=we?le(we):me();for(var _e=m.length;_e--;)delete ue[W][m[_e]];return ue()};_[Y]=!0,i.exports=Object.create||function(We,he){var de;return We!==null?(Q[W]=o(We),de=new Q,Q[W]=null,de[Y]=We):de=ue(),he===void 0?de:f(de,he)}},"7dd0":function(i,l,a){var o=a("23e7"),f=a("9ed3"),m=a("e163"),_=a("d2bb"),w=a("d44e"),M=a("9112"),C=a("6eeb"),R=a("b622"),z=a("c430"),W=a("3f8c"),X=a("ae93"),Y=X.IteratorPrototype,Q=X.BUGGY_SAFARI_ITERATORS,oe=R("iterator"),le="keys",me="values",we="entries",ue=function(){return this};i.exports=function(_e,We,he,de,Te,be,ae){f(he,We,de);var ne=function(it){if(it===Te&&pt)return pt;if(!Q&&it in ze)return ze[it];switch(it){case le:return function(){return new he(this,it)};case me:return function(){return new he(this,it)};case we:return function(){return new he(this,it)}}return function(){return new he(this)}},Se=We+" Iterator",Le=!1,ze=_e.prototype,He=ze[oe]||ze["@@iterator"]||Te&&ze[Te],pt=!Q&&He||ne(Te),ge=We=="Array"&&ze.entries||He,Ie,Ne,Ve;if(ge&&(Ie=m(ge.call(new _e)),Y!==Object.prototype&&Ie.next&&(!z&&m(Ie)!==Y&&(_?_(Ie,Y):typeof Ie[oe]!="function"&&M(Ie,oe,ue)),w(Ie,Se,!0,!0),z&&(W[Se]=ue))),Te==me&&He&&He.name!==me&&(Le=!0,pt=function(){return He.call(this)}),(!z||ae)&&ze[oe]!==pt&&M(ze,oe,pt),W[We]=pt,Te)if(Ne={values:ne(me),keys:be?pt:ne(le),entries:ne(we)},ae)for(Ve in Ne)(Q||Le||!(Ve in ze))&&C(ze,Ve,Ne[Ve]);else o({target:We,proto:!0,forced:Q||Le},Ne);return Ne}},"7f9a":function(i,l,a){var o=a("da84"),f=a("8925"),m=o.WeakMap;i.exports=typeof m=="function"&&/native code/.test(f(m))},"825a":function(i,l,a){var o=a("861d");i.exports=function(f){if(!o(f))throw TypeError(String(f)+" is not an object");return f}},"83ab":function(i,l,a){var o=a("d039");i.exports=!o(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},8418:function(i,l,a){var o=a("c04e"),f=a("9bf2"),m=a("5c6c");i.exports=function(_,w,M){var C=o(w);C in _?f.f(_,C,m(0,M)):_[C]=M}},"861d":function(i,l){i.exports=function(a){return typeof a=="object"?a!==null:typeof a=="function"}},8875:function(i,l,a){var o,f,m;(function(_,w){f=[],o=w,m=typeof o=="function"?o.apply(l,f):o,m!==void 0&&(i.exports=m)})(typeof self<"u"?self:this,function(){function _(){var w=Object.getOwnPropertyDescriptor(document,"currentScript");if(!w&&"currentScript"in document&&document.currentScript||w&&w.get!==_&&document.currentScript)return document.currentScript;try{throw new Error}catch(we){var M=/.*at [^(]*\((.*):(.+):(.+)\)$/ig,C=/@([^@]*):(\d+):(\d+)\s*$/ig,R=M.exec(we.stack)||C.exec(we.stack),z=R&&R[1]||!1,W=R&&R[2]||!1,X=document.location.href.replace(document.location.hash,""),Y,Q,oe,le=document.getElementsByTagName("script");z===X&&(Y=document.documentElement.outerHTML,Q=new RegExp("(?:[^\\n]+?\\n){0,"+(W-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),oe=Y.replace(Q,"$1").trim());for(var me=0;me<le.length;me++)if(le[me].readyState==="interactive"||le[me].src===z||z===X&&le[me].innerHTML&&le[me].innerHTML.trim()===oe)return le[me];return null}}return _})},8925:function(i,l,a){var o=a("c6cd"),f=Function.toString;typeof o.inspectSource!="function"&&(o.inspectSource=function(m){return f.call(m)}),i.exports=o.inspectSource},"8aa5":function(i,l,a){var o=a("6547").charAt;i.exports=function(f,m,_){return m+(_?o(f,m).length:1)}},"8bbf":function(i,l){i.exports=n},"90e3":function(i,l){var a=0,o=Math.random();i.exports=function(f){return"Symbol("+String(f===void 0?"":f)+")_"+(++a+o).toString(36)}},9112:function(i,l,a){var o=a("83ab"),f=a("9bf2"),m=a("5c6c");i.exports=o?function(_,w,M){return f.f(_,w,m(1,M))}:function(_,w,M){return _[w]=M,_}},9263:function(i,l,a){var o=a("ad6d"),f=a("9f7f"),m=RegExp.prototype.exec,_=String.prototype.replace,w=m,M=function(){var W=/a/,X=/b*/g;return m.call(W,"a"),m.call(X,"a"),W.lastIndex!==0||X.lastIndex!==0}(),C=f.UNSUPPORTED_Y||f.BROKEN_CARET,R=/()??/.exec("")[1]!==void 0,z=M||R||C;z&&(w=function(X){var Y=this,Q,oe,le,me,we=C&&Y.sticky,ue=o.call(Y),_e=Y.source,We=0,he=X;return we&&(ue=ue.replace("y",""),ue.indexOf("g")===-1&&(ue+="g"),he=String(X).slice(Y.lastIndex),Y.lastIndex>0&&(!Y.multiline||Y.multiline&&X[Y.lastIndex-1]!==`
`)&&(_e="(?: "+_e+")",he=" "+he,We++),oe=new RegExp("^(?:"+_e+")",ue)),R&&(oe=new RegExp("^"+_e+"$(?!\\s)",ue)),M&&(Q=Y.lastIndex),le=m.call(we?oe:Y,he),we?le?(le.input=le.input.slice(We),le[0]=le[0].slice(We),le.index=Y.lastIndex,Y.lastIndex+=le[0].length):Y.lastIndex=0:M&&le&&(Y.lastIndex=Y.global?le.index+le[0].length:Q),R&&le&&le.length>1&&_.call(le[0],oe,function(){for(me=1;me<arguments.length-2;me++)arguments[me]===void 0&&(le[me]=void 0)}),le}),i.exports=w},"94ca":function(i,l,a){var o=a("d039"),f=/#|\.prototype\./,m=function(R,z){var W=w[_(R)];return W==C?!0:W==M?!1:typeof z=="function"?o(z):!!z},_=m.normalize=function(R){return String(R).replace(f,".").toLowerCase()},w=m.data={},M=m.NATIVE="N",C=m.POLYFILL="P";i.exports=m},"99af":function(i,l,a){var o=a("23e7"),f=a("d039"),m=a("e8b5"),_=a("861d"),w=a("7b0b"),M=a("50c4"),C=a("8418"),R=a("65f0"),z=a("1dde"),W=a("b622"),X=a("2d00"),Y=W("isConcatSpreadable"),Q=9007199254740991,oe="Maximum allowed index exceeded",le=X>=51||!f(function(){var _e=[];return _e[Y]=!1,_e.concat()[0]!==_e}),me=z("concat"),we=function(_e){if(!_(_e))return!1;var We=_e[Y];return We!==void 0?!!We:m(_e)},ue=!le||!me;o({target:"Array",proto:!0,forced:ue},{concat:function(We){var he=w(this),de=R(he,0),Te=0,be,ae,ne,Se,Le;for(be=-1,ne=arguments.length;be<ne;be++)if(Le=be===-1?he:arguments[be],we(Le)){if(Se=M(Le.length),Te+Se>Q)throw TypeError(oe);for(ae=0;ae<Se;ae++,Te++)ae in Le&&C(de,Te,Le[ae])}else{if(Te>=Q)throw TypeError(oe);C(de,Te++,Le)}return de.length=Te,de}})},"9bdd":function(i,l,a){var o=a("825a");i.exports=function(f,m,_,w){try{return w?m(o(_)[0],_[1]):m(_)}catch(C){var M=f.return;throw M!==void 0&&o(M.call(f)),C}}},"9bf2":function(i,l,a){var o=a("83ab"),f=a("0cfb"),m=a("825a"),_=a("c04e"),w=Object.defineProperty;l.f=o?w:function(C,R,z){if(m(C),R=_(R,!0),m(z),f)try{return w(C,R,z)}catch{}if("get"in z||"set"in z)throw TypeError("Accessors not supported");return"value"in z&&(C[R]=z.value),C}},"9ed3":function(i,l,a){var o=a("ae93").IteratorPrototype,f=a("7c73"),m=a("5c6c"),_=a("d44e"),w=a("3f8c"),M=function(){return this};i.exports=function(C,R,z){var W=R+" Iterator";return C.prototype=f(o,{next:m(1,z)}),_(C,W,!1,!0),w[W]=M,C}},"9f7f":function(i,l,a){var o=a("d039");function f(m,_){return RegExp(m,_)}l.UNSUPPORTED_Y=o(function(){var m=f("a","y");return m.lastIndex=2,m.exec("abcd")!=null}),l.BROKEN_CARET=o(function(){var m=f("^r","gy");return m.lastIndex=2,m.exec("str")!=null})},a2bf:function(i,l,a){var o=a("e8b5"),f=a("50c4"),m=a("0366"),_=function(w,M,C,R,z,W,X,Y){for(var Q=z,oe=0,le=X?m(X,Y,3):!1,me;oe<R;){if(oe in C){if(me=le?le(C[oe],oe,M):C[oe],W>0&&o(me))Q=_(w,M,me,f(me.length),Q,W-1)-1;else{if(Q>=9007199254740991)throw TypeError("Exceed the acceptable array length");w[Q]=me}Q++}oe++}return Q};i.exports=_},a352:function(i,l){i.exports=r},a434:function(i,l,a){var o=a("23e7"),f=a("23cb"),m=a("a691"),_=a("50c4"),w=a("7b0b"),M=a("65f0"),C=a("8418"),R=a("1dde"),z=a("ae40"),W=R("splice"),X=z("splice",{ACCESSORS:!0,0:0,1:2}),Y=Math.max,Q=Math.min,oe=9007199254740991,le="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!W||!X},{splice:function(we,ue){var _e=w(this),We=_(_e.length),he=f(we,We),de=arguments.length,Te,be,ae,ne,Se,Le;if(de===0?Te=be=0:de===1?(Te=0,be=We-he):(Te=de-2,be=Q(Y(m(ue),0),We-he)),We+Te-be>oe)throw TypeError(le);for(ae=M(_e,be),ne=0;ne<be;ne++)Se=he+ne,Se in _e&&C(ae,ne,_e[Se]);if(ae.length=be,Te<be){for(ne=he;ne<We-be;ne++)Se=ne+be,Le=ne+Te,Se in _e?_e[Le]=_e[Se]:delete _e[Le];for(ne=We;ne>We-be+Te;ne--)delete _e[ne-1]}else if(Te>be)for(ne=We-be;ne>he;ne--)Se=ne+be-1,Le=ne+Te-1,Se in _e?_e[Le]=_e[Se]:delete _e[Le];for(ne=0;ne<Te;ne++)_e[ne+he]=arguments[ne+2];return _e.length=We-be+Te,ae}})},a4d3:function(i,l,a){var o=a("23e7"),f=a("da84"),m=a("d066"),_=a("c430"),w=a("83ab"),M=a("4930"),C=a("fdbf"),R=a("d039"),z=a("5135"),W=a("e8b5"),X=a("861d"),Y=a("825a"),Q=a("7b0b"),oe=a("fc6a"),le=a("c04e"),me=a("5c6c"),we=a("7c73"),ue=a("df75"),_e=a("241c"),We=a("057f"),he=a("7418"),de=a("06cf"),Te=a("9bf2"),be=a("d1e7"),ae=a("9112"),ne=a("6eeb"),Se=a("5692"),Le=a("f772"),ze=a("d012"),He=a("90e3"),pt=a("b622"),ge=a("e538"),Ie=a("746f"),Ne=a("d44e"),Ve=a("69f3"),it=a("b727").forEach,lt=Le("hidden"),Mt="Symbol",wt="prototype",rn=pt("toPrimitive"),yn=Ve.set,Pn=Ve.getterFor(Mt),De=Object[wt],Ae=f.Symbol,Be=m("JSON","stringify"),Ce=de.f,ot=Te.f,Dt=We.f,Zt=be.f,an=Se("symbols"),ln=Se("op-symbols"),vn=Se("string-to-symbol-registry"),qn=Se("symbol-to-string-registry"),Kn=Se("wks"),cr=f.QObject,pr=!cr||!cr[wt]||!cr[wt].findChild,Dr=w&&R(function(){return we(ot({},"a",{get:function(){return ot(this,"a",{value:7}).a}})).a!=7})?function(et,ct,$e){var Gt=Ce(De,ct);Gt&&delete De[ct],ot(et,ct,$e),Gt&&et!==De&&ot(De,ct,Gt)}:ot,zr=function(et,ct){var $e=an[et]=we(Ae[wt]);return yn($e,{type:Mt,tag:et,description:ct}),w||($e.description=ct),$e},Ht=C?function(et){return typeof et=="symbol"}:function(et){return Object(et)instanceof Ae},tn=function(ct,$e,Gt){ct===De&&tn(ln,$e,Gt),Y(ct);var hn=le($e,!0);return Y(Gt),z(an,hn)?(Gt.enumerable?(z(ct,lt)&&ct[lt][hn]&&(ct[lt][hn]=!1),Gt=we(Gt,{enumerable:me(0,!1)})):(z(ct,lt)||ot(ct,lt,me(1,{})),ct[lt][hn]=!0),Dr(ct,hn,Gt)):ot(ct,hn,Gt)},Kt=function(ct,$e){Y(ct);var Gt=oe($e),hn=ue(Gt).concat(je(Gt));return it(hn,function(Ot){(!w||ir.call(Gt,Ot))&&tn(ct,Ot,Gt[Ot])}),ct},Yn=function(ct,$e){return $e===void 0?we(ct):Kt(we(ct),$e)},ir=function(ct){var $e=le(ct,!0),Gt=Zt.call(this,$e);return this===De&&z(an,$e)&&!z(ln,$e)?!1:Gt||!z(this,$e)||!z(an,$e)||z(this,lt)&&this[lt][$e]?Gt:!0},Fr=function(ct,$e){var Gt=oe(ct),hn=le($e,!0);if(!(Gt===De&&z(an,hn)&&!z(ln,hn))){var Ot=Ce(Gt,hn);return Ot&&z(an,hn)&&!(z(Gt,lt)&&Gt[lt][hn])&&(Ot.enumerable=!0),Ot}},Ft=function(ct){var $e=Dt(oe(ct)),Gt=[];return it($e,function(hn){!z(an,hn)&&!z(ze,hn)&&Gt.push(hn)}),Gt},je=function(ct){var $e=ct===De,Gt=Dt($e?ln:oe(ct)),hn=[];return it(Gt,function(Ot){z(an,Ot)&&(!$e||z(De,Ot))&&hn.push(an[Ot])}),hn};if(M||(Ae=function(){if(this instanceof Ae)throw TypeError("Symbol is not a constructor");var ct=!arguments.length||arguments[0]===void 0?void 0:String(arguments[0]),$e=He(ct),Gt=function(hn){this===De&&Gt.call(ln,hn),z(this,lt)&&z(this[lt],$e)&&(this[lt][$e]=!1),Dr(this,$e,me(1,hn))};return w&&pr&&Dr(De,$e,{configurable:!0,set:Gt}),zr($e,ct)},ne(Ae[wt],"toString",function(){return Pn(this).tag}),ne(Ae,"withoutSetter",function(et){return zr(He(et),et)}),be.f=ir,Te.f=tn,de.f=Fr,_e.f=We.f=Ft,he.f=je,ge.f=function(et){return zr(pt(et),et)},w&&(ot(Ae[wt],"description",{configurable:!0,get:function(){return Pn(this).description}}),_||ne(De,"propertyIsEnumerable",ir,{unsafe:!0}))),o({global:!0,wrap:!0,forced:!M,sham:!M},{Symbol:Ae}),it(ue(Kn),function(et){Ie(et)}),o({target:Mt,stat:!0,forced:!M},{for:function(et){var ct=String(et);if(z(vn,ct))return vn[ct];var $e=Ae(ct);return vn[ct]=$e,qn[$e]=ct,$e},keyFor:function(ct){if(!Ht(ct))throw TypeError(ct+" is not a symbol");if(z(qn,ct))return qn[ct]},useSetter:function(){pr=!0},useSimple:function(){pr=!1}}),o({target:"Object",stat:!0,forced:!M,sham:!w},{create:Yn,defineProperty:tn,defineProperties:Kt,getOwnPropertyDescriptor:Fr}),o({target:"Object",stat:!0,forced:!M},{getOwnPropertyNames:Ft,getOwnPropertySymbols:je}),o({target:"Object",stat:!0,forced:R(function(){he.f(1)})},{getOwnPropertySymbols:function(ct){return he.f(Q(ct))}}),Be){var Ze=!M||R(function(){var et=Ae();return Be([et])!="[null]"||Be({a:et})!="{}"||Be(Object(et))!="{}"});o({target:"JSON",stat:!0,forced:Ze},{stringify:function(ct,$e,Gt){for(var hn=[ct],Ot=1,cn;arguments.length>Ot;)hn.push(arguments[Ot++]);if(cn=$e,!(!X($e)&&ct===void 0||Ht(ct)))return W($e)||($e=function(En,wn){if(typeof cn=="function"&&(wn=cn.call(this,En,wn)),!Ht(wn))return wn}),hn[1]=$e,Be.apply(null,hn)}})}Ae[wt][rn]||ae(Ae[wt],rn,Ae[wt].valueOf),Ne(Ae,Mt),ze[lt]=!0},a630:function(i,l,a){var o=a("23e7"),f=a("4df4"),m=a("1c7e"),_=!m(function(w){Array.from(w)});o({target:"Array",stat:!0,forced:_},{from:f})},a640:function(i,l,a){var o=a("d039");i.exports=function(f,m){var _=[][f];return!!_&&o(function(){_.call(null,m||function(){throw 1},1)})}},a691:function(i,l){var a=Math.ceil,o=Math.floor;i.exports=function(f){return isNaN(f=+f)?0:(f>0?o:a)(f)}},ab13:function(i,l,a){var o=a("b622"),f=o("match");i.exports=function(m){var _=/./;try{"/./"[m](_)}catch{try{return _[f]=!1,"/./"[m](_)}catch{}}return!1}},ac1f:function(i,l,a){var o=a("23e7"),f=a("9263");o({target:"RegExp",proto:!0,forced:/./.exec!==f},{exec:f})},ad6d:function(i,l,a){var o=a("825a");i.exports=function(){var f=o(this),m="";return f.global&&(m+="g"),f.ignoreCase&&(m+="i"),f.multiline&&(m+="m"),f.dotAll&&(m+="s"),f.unicode&&(m+="u"),f.sticky&&(m+="y"),m}},ae40:function(i,l,a){var o=a("83ab"),f=a("d039"),m=a("5135"),_=Object.defineProperty,w={},M=function(C){throw C};i.exports=function(C,R){if(m(w,C))return w[C];R||(R={});var z=[][C],W=m(R,"ACCESSORS")?R.ACCESSORS:!1,X=m(R,0)?R[0]:M,Y=m(R,1)?R[1]:void 0;return w[C]=!!z&&!f(function(){if(W&&!o)return!0;var Q={length:-1};W?_(Q,1,{enumerable:!0,get:M}):Q[1]=1,z.call(Q,X,Y)})}},ae93:function(i,l,a){var o=a("e163"),f=a("9112"),m=a("5135"),_=a("b622"),w=a("c430"),M=_("iterator"),C=!1,R=function(){return this},z,W,X;[].keys&&(X=[].keys(),"next"in X?(W=o(o(X)),W!==Object.prototype&&(z=W)):C=!0),z==null&&(z={}),!w&&!m(z,M)&&f(z,M,R),i.exports={IteratorPrototype:z,BUGGY_SAFARI_ITERATORS:C}},b041:function(i,l,a){var o=a("00ee"),f=a("f5df");i.exports=o?{}.toString:function(){return"[object "+f(this)+"]"}},b0c0:function(i,l,a){var o=a("83ab"),f=a("9bf2").f,m=Function.prototype,_=m.toString,w=/^\s*function ([^ (]*)/,M="name";o&&!(M in m)&&f(m,M,{configurable:!0,get:function(){try{return _.call(this).match(w)[1]}catch{return""}}})},b622:function(i,l,a){var o=a("da84"),f=a("5692"),m=a("5135"),_=a("90e3"),w=a("4930"),M=a("fdbf"),C=f("wks"),R=o.Symbol,z=M?R:R&&R.withoutSetter||_;i.exports=function(W){return m(C,W)||(w&&m(R,W)?C[W]=R[W]:C[W]=z("Symbol."+W)),C[W]}},b64b:function(i,l,a){var o=a("23e7"),f=a("7b0b"),m=a("df75"),_=a("d039"),w=_(function(){m(1)});o({target:"Object",stat:!0,forced:w},{keys:function(C){return m(f(C))}})},b727:function(i,l,a){var o=a("0366"),f=a("44ad"),m=a("7b0b"),_=a("50c4"),w=a("65f0"),M=[].push,C=function(R){var z=R==1,W=R==2,X=R==3,Y=R==4,Q=R==6,oe=R==5||Q;return function(le,me,we,ue){for(var _e=m(le),We=f(_e),he=o(me,we,3),de=_(We.length),Te=0,be=ue||w,ae=z?be(le,de):W?be(le,0):void 0,ne,Se;de>Te;Te++)if((oe||Te in We)&&(ne=We[Te],Se=he(ne,Te,_e),R)){if(z)ae[Te]=Se;else if(Se)switch(R){case 3:return!0;case 5:return ne;case 6:return Te;case 2:M.call(ae,ne)}else if(Y)return!1}return Q?-1:X||Y?Y:ae}};i.exports={forEach:C(0),map:C(1),filter:C(2),some:C(3),every:C(4),find:C(5),findIndex:C(6)}},c04e:function(i,l,a){var o=a("861d");i.exports=function(f,m){if(!o(f))return f;var _,w;if(m&&typeof(_=f.toString)=="function"&&!o(w=_.call(f))||typeof(_=f.valueOf)=="function"&&!o(w=_.call(f))||!m&&typeof(_=f.toString)=="function"&&!o(w=_.call(f)))return w;throw TypeError("Can't convert object to primitive value")}},c430:function(i,l){i.exports=!1},c6b6:function(i,l){var a={}.toString;i.exports=function(o){return a.call(o).slice(8,-1)}},c6cd:function(i,l,a){var o=a("da84"),f=a("ce4e"),m="__core-js_shared__",_=o[m]||f(m,{});i.exports=_},c740:function(i,l,a){var o=a("23e7"),f=a("b727").findIndex,m=a("44d2"),_=a("ae40"),w="findIndex",M=!0,C=_(w);w in[]&&Array(1)[w](function(){M=!1}),o({target:"Array",proto:!0,forced:M||!C},{findIndex:function(z){return f(this,z,arguments.length>1?arguments[1]:void 0)}}),m(w)},c8ba:function(i,l){var a;a=function(){return this}();try{a=a||new Function("return this")()}catch{typeof window=="object"&&(a=window)}i.exports=a},c975:function(i,l,a){var o=a("23e7"),f=a("4d64").indexOf,m=a("a640"),_=a("ae40"),w=[].indexOf,M=!!w&&1/[1].indexOf(1,-0)<0,C=m("indexOf"),R=_("indexOf",{ACCESSORS:!0,1:0});o({target:"Array",proto:!0,forced:M||!C||!R},{indexOf:function(W){return M?w.apply(this,arguments)||0:f(this,W,arguments.length>1?arguments[1]:void 0)}})},ca84:function(i,l,a){var o=a("5135"),f=a("fc6a"),m=a("4d64").indexOf,_=a("d012");i.exports=function(w,M){var C=f(w),R=0,z=[],W;for(W in C)!o(_,W)&&o(C,W)&&z.push(W);for(;M.length>R;)o(C,W=M[R++])&&(~m(z,W)||z.push(W));return z}},caad:function(i,l,a){var o=a("23e7"),f=a("4d64").includes,m=a("44d2"),_=a("ae40"),w=_("indexOf",{ACCESSORS:!0,1:0});o({target:"Array",proto:!0,forced:!w},{includes:function(C){return f(this,C,arguments.length>1?arguments[1]:void 0)}}),m("includes")},cc12:function(i,l,a){var o=a("da84"),f=a("861d"),m=o.document,_=f(m)&&f(m.createElement);i.exports=function(w){return _?m.createElement(w):{}}},ce4e:function(i,l,a){var o=a("da84"),f=a("9112");i.exports=function(m,_){try{f(o,m,_)}catch{o[m]=_}return _}},d012:function(i,l){i.exports={}},d039:function(i,l){i.exports=function(a){try{return!!a()}catch{return!0}}},d066:function(i,l,a){var o=a("428f"),f=a("da84"),m=function(_){return typeof _=="function"?_:void 0};i.exports=function(_,w){return arguments.length<2?m(o[_])||m(f[_]):o[_]&&o[_][w]||f[_]&&f[_][w]}},d1e7:function(i,l,a){var o={}.propertyIsEnumerable,f=Object.getOwnPropertyDescriptor,m=f&&!o.call({1:2},1);l.f=m?function(w){var M=f(this,w);return!!M&&M.enumerable}:o},d28b:function(i,l,a){var o=a("746f");o("iterator")},d2bb:function(i,l,a){var o=a("825a"),f=a("3bbe");i.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var m=!1,_={},w;try{w=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,w.call(_,[]),m=_ instanceof Array}catch{}return function(C,R){return o(C),f(R),m?w.call(C,R):C.__proto__=R,C}}():void 0)},d3b7:function(i,l,a){var o=a("00ee"),f=a("6eeb"),m=a("b041");o||f(Object.prototype,"toString",m,{unsafe:!0})},d44e:function(i,l,a){var o=a("9bf2").f,f=a("5135"),m=a("b622"),_=m("toStringTag");i.exports=function(w,M,C){w&&!f(w=C?w:w.prototype,_)&&o(w,_,{configurable:!0,value:M})}},d58f:function(i,l,a){var o=a("1c0b"),f=a("7b0b"),m=a("44ad"),_=a("50c4"),w=function(M){return function(C,R,z,W){o(R);var X=f(C),Y=m(X),Q=_(X.length),oe=M?Q-1:0,le=M?-1:1;if(z<2)for(;;){if(oe in Y){W=Y[oe],oe+=le;break}if(oe+=le,M?oe<0:Q<=oe)throw TypeError("Reduce of empty array with no initial value")}for(;M?oe>=0:Q>oe;oe+=le)oe in Y&&(W=R(W,Y[oe],oe,X));return W}};i.exports={left:w(!1),right:w(!0)}},d784:function(i,l,a){a("ac1f");var o=a("6eeb"),f=a("d039"),m=a("b622"),_=a("9263"),w=a("9112"),M=m("species"),C=!f(function(){var Y=/./;return Y.exec=function(){var Q=[];return Q.groups={a:"7"},Q},"".replace(Y,"$<a>")!=="7"}),R=function(){return"a".replace(/./,"$0")==="$0"}(),z=m("replace"),W=function(){return/./[z]?/./[z]("a","$0")==="":!1}(),X=!f(function(){var Y=/(?:)/,Q=Y.exec;Y.exec=function(){return Q.apply(this,arguments)};var oe="ab".split(Y);return oe.length!==2||oe[0]!=="a"||oe[1]!=="b"});i.exports=function(Y,Q,oe,le){var me=m(Y),we=!f(function(){var Te={};return Te[me]=function(){return 7},""[Y](Te)!=7}),ue=we&&!f(function(){var Te=!1,be=/a/;return Y==="split"&&(be={},be.constructor={},be.constructor[M]=function(){return be},be.flags="",be[me]=/./[me]),be.exec=function(){return Te=!0,null},be[me](""),!Te});if(!we||!ue||Y==="replace"&&!(C&&R&&!W)||Y==="split"&&!X){var _e=/./[me],We=oe(me,""[Y],function(Te,be,ae,ne,Se){return be.exec===_?we&&!Se?{done:!0,value:_e.call(be,ae,ne)}:{done:!0,value:Te.call(ae,be,ne)}:{done:!1}},{REPLACE_KEEPS_$0:R,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:W}),he=We[0],de=We[1];o(String.prototype,Y,he),o(RegExp.prototype,me,Q==2?function(Te,be){return de.call(Te,this,be)}:function(Te){return de.call(Te,this)})}le&&w(RegExp.prototype[me],"sham",!0)}},d81d:function(i,l,a){var o=a("23e7"),f=a("b727").map,m=a("1dde"),_=a("ae40"),w=m("map"),M=_("map");o({target:"Array",proto:!0,forced:!w||!M},{map:function(R){return f(this,R,arguments.length>1?arguments[1]:void 0)}})},da84:function(i,l,a){(function(o){var f=function(m){return m&&m.Math==Math&&m};i.exports=f(typeof globalThis=="object"&&globalThis)||f(typeof window=="object"&&window)||f(typeof self=="object"&&self)||f(typeof o=="object"&&o)||Function("return this")()}).call(this,a("c8ba"))},dbb4:function(i,l,a){var o=a("23e7"),f=a("83ab"),m=a("56ef"),_=a("fc6a"),w=a("06cf"),M=a("8418");o({target:"Object",stat:!0,sham:!f},{getOwnPropertyDescriptors:function(R){for(var z=_(R),W=w.f,X=m(z),Y={},Q=0,oe,le;X.length>Q;)le=W(z,oe=X[Q++]),le!==void 0&&M(Y,oe,le);return Y}})},dbf1:function(i,l,a){(function(o){a.d(l,"a",function(){return m});function f(){return typeof window<"u"?window.console:o.console}var m=f()}).call(this,a("c8ba"))},ddb0:function(i,l,a){var o=a("da84"),f=a("fdbc"),m=a("e260"),_=a("9112"),w=a("b622"),M=w("iterator"),C=w("toStringTag"),R=m.values;for(var z in f){var W=o[z],X=W&&W.prototype;if(X){if(X[M]!==R)try{_(X,M,R)}catch{X[M]=R}if(X[C]||_(X,C,z),f[z]){for(var Y in m)if(X[Y]!==m[Y])try{_(X,Y,m[Y])}catch{X[Y]=m[Y]}}}}},df75:function(i,l,a){var o=a("ca84"),f=a("7839");i.exports=Object.keys||function(_){return o(_,f)}},e01a:function(i,l,a){var o=a("23e7"),f=a("83ab"),m=a("da84"),_=a("5135"),w=a("861d"),M=a("9bf2").f,C=a("e893"),R=m.Symbol;if(f&&typeof R=="function"&&(!("description"in R.prototype)||R().description!==void 0)){var z={},W=function(){var me=arguments.length<1||arguments[0]===void 0?void 0:String(arguments[0]),we=this instanceof W?new R(me):me===void 0?R():R(me);return me===""&&(z[we]=!0),we};C(W,R);var X=W.prototype=R.prototype;X.constructor=W;var Y=X.toString,Q=String(R("test"))=="Symbol(test)",oe=/^Symbol\((.*)\)[^)]+$/;M(X,"description",{configurable:!0,get:function(){var me=w(this)?this.valueOf():this,we=Y.call(me);if(_(z,me))return"";var ue=Q?we.slice(7,-1):we.replace(oe,"$1");return ue===""?void 0:ue}}),o({global:!0,forced:!0},{Symbol:W})}},e163:function(i,l,a){var o=a("5135"),f=a("7b0b"),m=a("f772"),_=a("e177"),w=m("IE_PROTO"),M=Object.prototype;i.exports=_?Object.getPrototypeOf:function(C){return C=f(C),o(C,w)?C[w]:typeof C.constructor=="function"&&C instanceof C.constructor?C.constructor.prototype:C instanceof Object?M:null}},e177:function(i,l,a){var o=a("d039");i.exports=!o(function(){function f(){}return f.prototype.constructor=null,Object.getPrototypeOf(new f)!==f.prototype})},e260:function(i,l,a){var o=a("fc6a"),f=a("44d2"),m=a("3f8c"),_=a("69f3"),w=a("7dd0"),M="Array Iterator",C=_.set,R=_.getterFor(M);i.exports=w(Array,"Array",function(z,W){C(this,{type:M,target:o(z),index:0,kind:W})},function(){var z=R(this),W=z.target,X=z.kind,Y=z.index++;return!W||Y>=W.length?(z.target=void 0,{value:void 0,done:!0}):X=="keys"?{value:Y,done:!1}:X=="values"?{value:W[Y],done:!1}:{value:[Y,W[Y]],done:!1}},"values"),m.Arguments=m.Array,f("keys"),f("values"),f("entries")},e439:function(i,l,a){var o=a("23e7"),f=a("d039"),m=a("fc6a"),_=a("06cf").f,w=a("83ab"),M=f(function(){_(1)}),C=!w||M;o({target:"Object",stat:!0,forced:C,sham:!w},{getOwnPropertyDescriptor:function(z,W){return _(m(z),W)}})},e538:function(i,l,a){var o=a("b622");l.f=o},e893:function(i,l,a){var o=a("5135"),f=a("56ef"),m=a("06cf"),_=a("9bf2");i.exports=function(w,M){for(var C=f(M),R=_.f,z=m.f,W=0;W<C.length;W++){var X=C[W];o(w,X)||R(w,X,z(M,X))}}},e8b5:function(i,l,a){var o=a("c6b6");i.exports=Array.isArray||function(m){return o(m)=="Array"}},e95a:function(i,l,a){var o=a("b622"),f=a("3f8c"),m=o("iterator"),_=Array.prototype;i.exports=function(w){return w!==void 0&&(f.Array===w||_[m]===w)}},f5df:function(i,l,a){var o=a("00ee"),f=a("c6b6"),m=a("b622"),_=m("toStringTag"),w=f(function(){return arguments}())=="Arguments",M=function(C,R){try{return C[R]}catch{}};i.exports=o?f:function(C){var R,z,W;return C===void 0?"Undefined":C===null?"Null":typeof(z=M(R=Object(C),_))=="string"?z:w?f(R):(W=f(R))=="Object"&&typeof R.callee=="function"?"Arguments":W}},f772:function(i,l,a){var o=a("5692"),f=a("90e3"),m=o("keys");i.exports=function(_){return m[_]||(m[_]=f(_))}},fb15:function(i,l,a){if(a.r(l),typeof window<"u"){var o=window.document.currentScript;{var f=a("8875");o=f(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:f})}var m=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);m&&(a.p=m[1])}a("99af"),a("4de4"),a("4160"),a("c975"),a("d81d"),a("a434"),a("159b"),a("a4d3"),a("e439"),a("dbb4"),a("b64b");function _(Ht,tn,Kt){return tn in Ht?Object.defineProperty(Ht,tn,{value:Kt,enumerable:!0,configurable:!0,writable:!0}):Ht[tn]=Kt,Ht}function w(Ht,tn){var Kt=Object.keys(Ht);if(Object.getOwnPropertySymbols){var Yn=Object.getOwnPropertySymbols(Ht);tn&&(Yn=Yn.filter(function(ir){return Object.getOwnPropertyDescriptor(Ht,ir).enumerable})),Kt.push.apply(Kt,Yn)}return Kt}function M(Ht){for(var tn=1;tn<arguments.length;tn++){var Kt=arguments[tn]!=null?arguments[tn]:{};tn%2?w(Object(Kt),!0).forEach(function(Yn){_(Ht,Yn,Kt[Yn])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ht,Object.getOwnPropertyDescriptors(Kt)):w(Object(Kt)).forEach(function(Yn){Object.defineProperty(Ht,Yn,Object.getOwnPropertyDescriptor(Kt,Yn))})}return Ht}function C(Ht){if(Array.isArray(Ht))return Ht}a("e01a"),a("d28b"),a("e260"),a("d3b7"),a("3ca3"),a("ddb0");function R(Ht,tn){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(Ht)))){var Kt=[],Yn=!0,ir=!1,Fr=void 0;try{for(var Ft=Ht[Symbol.iterator](),je;!(Yn=(je=Ft.next()).done)&&(Kt.push(je.value),!(tn&&Kt.length===tn));Yn=!0);}catch(Ze){ir=!0,Fr=Ze}finally{try{!Yn&&Ft.return!=null&&Ft.return()}finally{if(ir)throw Fr}}return Kt}}a("a630"),a("fb6a"),a("b0c0"),a("25f0");function z(Ht,tn){(tn==null||tn>Ht.length)&&(tn=Ht.length);for(var Kt=0,Yn=new Array(tn);Kt<tn;Kt++)Yn[Kt]=Ht[Kt];return Yn}function W(Ht,tn){if(Ht){if(typeof Ht=="string")return z(Ht,tn);var Kt=Object.prototype.toString.call(Ht).slice(8,-1);if(Kt==="Object"&&Ht.constructor&&(Kt=Ht.constructor.name),Kt==="Map"||Kt==="Set")return Array.from(Ht);if(Kt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Kt))return z(Ht,tn)}}function X(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Y(Ht,tn){return C(Ht)||R(Ht,tn)||W(Ht,tn)||X()}function Q(Ht){if(Array.isArray(Ht))return z(Ht)}function oe(Ht){if(typeof Symbol<"u"&&Symbol.iterator in Object(Ht))return Array.from(Ht)}function le(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function me(Ht){return Q(Ht)||oe(Ht)||W(Ht)||le()}var we=a("a352"),ue=a.n(we);function _e(Ht){Ht.parentElement!==null&&Ht.parentElement.removeChild(Ht)}function We(Ht,tn,Kt){var Yn=Kt===0?Ht.children[0]:Ht.children[Kt-1].nextSibling;Ht.insertBefore(tn,Yn)}var he=a("dbf1");a("13d5"),a("4fad"),a("ac1f"),a("5319");function de(Ht){var tn=Object.create(null);return function(Yn){var ir=tn[Yn];return ir||(tn[Yn]=Ht(Yn))}}var Te=/-(\w)/g,be=de(function(Ht){return Ht.replace(Te,function(tn,Kt){return Kt.toUpperCase()})});a("5db7"),a("73d9");var ae=["Start","Add","Remove","Update","End"],ne=["Choose","Unchoose","Sort","Filter","Clone"],Se=["Move"],Le=[Se,ae,ne].flatMap(function(Ht){return Ht}).map(function(Ht){return"on".concat(Ht)}),ze={manage:Se,manageAndEmit:ae,emit:ne};function He(Ht){return Le.indexOf(Ht)!==-1}a("caad"),a("2ca0");var pt=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"];function ge(Ht){return pt.includes(Ht)}function Ie(Ht){return["transition-group","TransitionGroup"].includes(Ht)}function Ne(Ht){return["id","class","role","style"].includes(Ht)||Ht.startsWith("data-")||Ht.startsWith("aria-")||Ht.startsWith("on")}function Ve(Ht){return Ht.reduce(function(tn,Kt){var Yn=Y(Kt,2),ir=Yn[0],Fr=Yn[1];return tn[ir]=Fr,tn},{})}function it(Ht){var tn=Ht.$attrs,Kt=Ht.componentData,Yn=Kt===void 0?{}:Kt,ir=Ve(Object.entries(tn).filter(function(Fr){var Ft=Y(Fr,2),je=Ft[0];return Ft[1],Ne(je)}));return M(M({},ir),Yn)}function lt(Ht){var tn=Ht.$attrs,Kt=Ht.callBackBuilder,Yn=Ve(Mt(tn));Object.entries(Kt).forEach(function(Fr){var Ft=Y(Fr,2),je=Ft[0],Ze=Ft[1];ze[je].forEach(function(et){Yn["on".concat(et)]=Ze(et)})});var ir="[data-draggable]".concat(Yn.draggable||"");return M(M({},Yn),{},{draggable:ir})}function Mt(Ht){return Object.entries(Ht).filter(function(tn){var Kt=Y(tn,2),Yn=Kt[0];return Kt[1],!Ne(Yn)}).map(function(tn){var Kt=Y(tn,2),Yn=Kt[0],ir=Kt[1];return[be(Yn),ir]}).filter(function(tn){var Kt=Y(tn,2),Yn=Kt[0];return Kt[1],!He(Yn)})}a("c740");function wt(Ht,tn){if(!(Ht instanceof tn))throw new TypeError("Cannot call a class as a function")}function rn(Ht,tn){for(var Kt=0;Kt<tn.length;Kt++){var Yn=tn[Kt];Yn.enumerable=Yn.enumerable||!1,Yn.configurable=!0,"value"in Yn&&(Yn.writable=!0),Object.defineProperty(Ht,Yn.key,Yn)}}function yn(Ht,tn,Kt){return tn&&rn(Ht.prototype,tn),Ht}var Pn=function(tn){var Kt=tn.el;return Kt},De=function(tn,Kt){return tn.__draggable_context=Kt},Ae=function(tn){return tn.__draggable_context},Be=function(){function Ht(tn){var Kt=tn.nodes,Yn=Kt.header,ir=Kt.default,Fr=Kt.footer,Ft=tn.root,je=tn.realList;wt(this,Ht),this.defaultNodes=ir,this.children=[].concat(me(Yn),me(ir),me(Fr)),this.externalComponent=Ft.externalComponent,this.rootTransition=Ft.transition,this.tag=Ft.tag,this.realList=je}return yn(Ht,[{key:"render",value:function(Kt,Yn){var ir=this.tag,Fr=this.children,Ft=this._isRootComponent,je=Ft?{default:function(){return Fr}}:Fr;return Kt(ir,Yn,je)}},{key:"updated",value:function(){var Kt=this.defaultNodes,Yn=this.realList;Kt.forEach(function(ir,Fr){De(Pn(ir),{element:Yn[Fr],index:Fr})})}},{key:"getUnderlyingVm",value:function(Kt){return Ae(Kt)}},{key:"getVmIndexFromDomIndex",value:function(Kt,Yn){var ir=this.defaultNodes,Fr=ir.length,Ft=Yn.children,je=Ft.item(Kt);if(je===null)return Fr;var Ze=Ae(je);if(Ze)return Ze.index;if(Fr===0)return 0;var et=Pn(ir[0]),ct=me(Ft).findIndex(function($e){return $e===et});return Kt<ct?0:Fr}},{key:"_isRootComponent",get:function(){return this.externalComponent||this.rootTransition}}]),Ht}(),Ce=a("8bbf");function ot(Ht,tn){var Kt=Ht[tn];return Kt?Kt():[]}function Dt(Ht){var tn=Ht.$slots,Kt=Ht.realList,Yn=Ht.getKey,ir=Kt||[],Fr=["header","footer"].map(function($e){return ot(tn,$e)}),Ft=Y(Fr,2),je=Ft[0],Ze=Ft[1],et=tn.item;if(!et)throw new Error("draggable element must have an item slot");var ct=ir.flatMap(function($e,Gt){return et({element:$e,index:Gt}).map(function(hn){return hn.key=Yn($e),hn.props=M(M({},hn.props||{}),{},{"data-draggable":!0}),hn})});if(ct.length!==ir.length)throw new Error("Item slot must have only one child");return{header:je,footer:Ze,default:ct}}function Zt(Ht){var tn=Ie(Ht),Kt=!ge(Ht)&&!tn;return{transition:tn,externalComponent:Kt,tag:Kt?Object(Ce.resolveComponent)(Ht):tn?Ce.TransitionGroup:Ht}}function an(Ht){var tn=Ht.$slots,Kt=Ht.tag,Yn=Ht.realList,ir=Ht.getKey,Fr=Dt({$slots:tn,realList:Yn,getKey:ir}),Ft=Zt(Kt);return new Be({nodes:Fr,root:Ft,realList:Yn})}function ln(Ht,tn){var Kt=this;Object(Ce.nextTick)(function(){return Kt.$emit(Ht.toLowerCase(),tn)})}function vn(Ht){var tn=this;return function(Kt,Yn){if(tn.realList!==null)return tn["onDrag".concat(Ht)](Kt,Yn)}}function qn(Ht){var tn=this,Kt=vn.call(this,Ht);return function(Yn,ir){Kt.call(tn,Yn,ir),ln.call(tn,Ht,Yn)}}var Kn=null,cr={list:{type:Array,required:!1,default:null},modelValue:{type:Array,required:!1,default:null},itemKey:{type:[String,Function],required:!0},clone:{type:Function,default:function(tn){return tn}},tag:{type:String,default:"div"},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},pr=["update:modelValue","change"].concat(me([].concat(me(ze.manageAndEmit),me(ze.emit)).map(function(Ht){return Ht.toLowerCase()}))),Dr=Object(Ce.defineComponent)({name:"draggable",inheritAttrs:!1,props:cr,emits:pr,data:function(){return{error:!1}},render:function(){try{this.error=!1;var tn=this.$slots,Kt=this.$attrs,Yn=this.tag,ir=this.componentData,Fr=this.realList,Ft=this.getKey,je=an({$slots:tn,tag:Yn,realList:Fr,getKey:Ft});this.componentStructure=je;var Ze=it({$attrs:Kt,componentData:ir});return je.render(Ce.h,Ze)}catch(et){return this.error=!0,Object(Ce.h)("pre",{style:{color:"red"}},et.stack)}},created:function(){this.list!==null&&this.modelValue!==null&&he.a.error("modelValue and list props are mutually exclusive! Please set one or another.")},mounted:function(){var tn=this;if(!this.error){var Kt=this.$attrs,Yn=this.$el,ir=this.componentStructure;ir.updated();var Fr=lt({$attrs:Kt,callBackBuilder:{manageAndEmit:function(Ze){return qn.call(tn,Ze)},emit:function(Ze){return ln.bind(tn,Ze)},manage:function(Ze){return vn.call(tn,Ze)}}}),Ft=Yn.nodeType===1?Yn:Yn.parentElement;this._sortable=new ue.a(Ft,Fr),this.targetDomElement=Ft,Ft.__draggable_component__=this}},updated:function(){this.componentStructure.updated()},beforeUnmount:function(){this._sortable!==void 0&&this._sortable.destroy()},computed:{realList:function(){var tn=this.list;return tn||this.modelValue},getKey:function(){var tn=this.itemKey;return typeof tn=="function"?tn:function(Kt){return Kt[tn]}}},watch:{$attrs:{handler:function(tn){var Kt=this._sortable;Kt&&Mt(tn).forEach(function(Yn){var ir=Y(Yn,2),Fr=ir[0],Ft=ir[1];Kt.option(Fr,Ft)})},deep:!0}},methods:{getUnderlyingVm:function(tn){return this.componentStructure.getUnderlyingVm(tn)||null},getUnderlyingPotencialDraggableComponent:function(tn){return tn.__draggable_component__},emitChanges:function(tn){var Kt=this;Object(Ce.nextTick)(function(){return Kt.$emit("change",tn)})},alterList:function(tn){if(this.list){tn(this.list);return}var Kt=me(this.modelValue);tn(Kt),this.$emit("update:modelValue",Kt)},spliceList:function(){var tn=arguments,Kt=function(ir){return ir.splice.apply(ir,me(tn))};this.alterList(Kt)},updatePosition:function(tn,Kt){var Yn=function(Fr){return Fr.splice(Kt,0,Fr.splice(tn,1)[0])};this.alterList(Yn)},getRelatedContextFromMoveEvent:function(tn){var Kt=tn.to,Yn=tn.related,ir=this.getUnderlyingPotencialDraggableComponent(Kt);if(!ir)return{component:ir};var Fr=ir.realList,Ft={list:Fr,component:ir};if(Kt!==Yn&&Fr){var je=ir.getUnderlyingVm(Yn)||{};return M(M({},je),Ft)}return Ft},getVmIndexFromDomIndex:function(tn){return this.componentStructure.getVmIndexFromDomIndex(tn,this.targetDomElement)},onDragStart:function(tn){this.context=this.getUnderlyingVm(tn.item),tn.item._underlying_vm_=this.clone(this.context.element),Kn=tn.item},onDragAdd:function(tn){var Kt=tn.item._underlying_vm_;if(Kt!==void 0){_e(tn.item);var Yn=this.getVmIndexFromDomIndex(tn.newIndex);this.spliceList(Yn,0,Kt);var ir={element:Kt,newIndex:Yn};this.emitChanges({added:ir})}},onDragRemove:function(tn){if(We(this.$el,tn.item,tn.oldIndex),tn.pullMode==="clone"){_e(tn.clone);return}var Kt=this.context,Yn=Kt.index,ir=Kt.element;this.spliceList(Yn,1);var Fr={element:ir,oldIndex:Yn};this.emitChanges({removed:Fr})},onDragUpdate:function(tn){_e(tn.item),We(tn.from,tn.item,tn.oldIndex);var Kt=this.context.index,Yn=this.getVmIndexFromDomIndex(tn.newIndex);this.updatePosition(Kt,Yn);var ir={element:this.context.element,oldIndex:Kt,newIndex:Yn};this.emitChanges({moved:ir})},computeFutureIndex:function(tn,Kt){if(!tn.element)return 0;var Yn=me(Kt.to.children).filter(function(je){return je.style.display!=="none"}),ir=Yn.indexOf(Kt.related),Fr=tn.component.getVmIndexFromDomIndex(ir),Ft=Yn.indexOf(Kn)!==-1;return Ft||!Kt.willInsertAfter?Fr:Fr+1},onDragMove:function(tn,Kt){var Yn=this.move,ir=this.realList;if(!Yn||!ir)return!0;var Fr=this.getRelatedContextFromMoveEvent(tn),Ft=this.computeFutureIndex(Fr,tn),je=M(M({},this.context),{},{futureIndex:Ft}),Ze=M(M({},tn),{},{relatedContext:Fr,draggedContext:je});return Yn(Ze,Kt)},onDragEnd:function(){Kn=null}}}),zr=Dr;l.default=zr},fb6a:function(i,l,a){var o=a("23e7"),f=a("861d"),m=a("e8b5"),_=a("23cb"),w=a("50c4"),M=a("fc6a"),C=a("8418"),R=a("b622"),z=a("1dde"),W=a("ae40"),X=z("slice"),Y=W("slice",{ACCESSORS:!0,0:0,1:2}),Q=R("species"),oe=[].slice,le=Math.max;o({target:"Array",proto:!0,forced:!X||!Y},{slice:function(we,ue){var _e=M(this),We=w(_e.length),he=_(we,We),de=_(ue===void 0?We:ue,We),Te,be,ae;if(m(_e)&&(Te=_e.constructor,typeof Te=="function"&&(Te===Array||m(Te.prototype))?Te=void 0:f(Te)&&(Te=Te[Q],Te===null&&(Te=void 0)),Te===Array||Te===void 0))return oe.call(_e,he,de);for(be=new(Te===void 0?Array:Te)(le(de-he,0)),ae=0;he<de;he++,ae++)he in _e&&C(be,ae,_e[he]);return be.length=ae,be}})},fc6a:function(i,l,a){var o=a("44ad"),f=a("1d80");i.exports=function(m){return o(f(m))}},fdbc:function(i,l){i.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},fdbf:function(i,l,a){var o=a("4930");i.exports=o&&!Symbol.sham&&typeof Symbol.iterator=="symbol"}}).default})})(Xk);var zZ=Xk.exports;const jZ=Mg(zZ),UZ={class:"min-h-full bg-gray-50"},VZ={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},$Z={class:"sm:flex sm:items-center"},GZ={class:"mt-4 sm:mt-0 sm:ml-16 sm:flex-none"},HZ={key:0,class:"origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none z-10"},qZ={class:"mt-6 bg-white shadow rounded-lg p-4"},WZ={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ZZ=["value"],KZ={key:0,class:"mt-6 p-6 text-center bg-white shadow rounded-lg"},YZ={key:1,class:"mt-6 pb-4"},XZ={key:0,class:"p-6 text-center bg-white shadow rounded-lg mb-4"},JZ={key:1,class:"md:flex md:space-x-4 md:overflow-x-auto gap-4 grid grid-cols-1"},QZ={class:"bg-white rounded-lg shadow overflow-hidden"},eK={class:"flex items-center"},tK={class:"flex items-center"},nK={class:"text-xs text-gray-500 bg-white px-2 py-1 rounded-full"},rK={class:"p-2"},iK={class:"min-h-[100px] draggable-container"},sK={class:"note-container"},oK={class:"bg-white rounded-md shadow-sm border border-gray-200 overflow-hidden"},aK={class:"flex items-center"},lK={key:0,class:"h-4 w-4 mr-2 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},uK={class:"text-sm font-medium text-gray-900 truncate"},cK={class:"px-3 py-2"},hK={class:"text-sm text-gray-500 line-clamp-2"},dK={class:"px-3 py-2 bg-gray-50 border-t border-gray-100 flex items-center space-x-2"},fK={class:"text-xs text-gray-500"},pK={key:0,class:"text-xs text-gray-700"},mK={class:"flex space-x-1 ml-auto"},gK={key:0,class:"text-xs text-primary-500 flex items-center mr-1",title:"Note géolocalisée"},yK={key:1,class:"text-xs text-gray-400 flex items-center mr-1",title:"Note simple"},vK=["onClick"],_K=["onClick"],bK=["onClick"],xK=["onClick"],wK={key:0,class:"fixed z-[3001] inset-0 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},CK={class:"flex items-center justify-center min-h-screen w-full"},SK={class:"relative bg-white w-full md:rounded-lg md:max-w-lg md:h-auto md:max-h-[90vh] md:my-8 shadow-xl transform transition-all overflow-hidden mx-auto my-auto"},LK={class:"mt-6 flex flex-col-reverse sm:flex-row-reverse sm:justify-end gap-3 p-4 md:px-6"},PK=Ja({__name:"NotesView",setup(e){const t=Rn([]),n=z2(),r=Lh(),i=yp(),l=Mu(),a=Rn(!0),o=Rn(!1),f=Rn(!1),m=Rn(null),_=Rn(null),w=Rn("info"),M=Rn(window.innerWidth<768),C=()=>{M.value=window.innerWidth<768},R=Ai(()=>i.getSortedColumns),z=bd({search:"",date:"",accessLevel:""}),W=Ai(()=>{let ze=i.getAccessibleNotes;if(z.search){const He=z.search.toLowerCase();ze=ze.filter(pt=>pt.title.toLowerCase().includes(He)||pt.description.toLowerCase().includes(He))}if(z.accessLevel&&(ze=ze.filter(He=>He.accessLevel===z.accessLevel)),z.date){const He=new Date;He.setHours(0,0,0,0);const pt=new Date(He);pt.setDate(He.getDate()-He.getDay());const ge=new Date(He.getFullYear(),He.getMonth(),1);ze=ze.filter(Ie=>{const Ne=tV(Ie.createdAt);return Ne?z.date==="today"?Ne>=He:z.date==="week"?Ne>=pt:z.date==="month"?Ne>=ge:!0:!1})}return ze}),X=Ai(()=>ze=>W.value.filter(He=>He.columnId===ze));function Y(ze){if(ze==null)return"Non défini";switch(ze){case Bs.PRIVATE:return"Privé";case Bs.COMPANY:return"Entreprise";case Bs.EMPLOYEE:return"Salariés";case Bs.VISITOR:return"Visiteurs";default:return"Non défini"}}function Q(ze){if(ze==null)return"#9CA3AF";switch(ze){case Bs.PRIVATE:return"#9CA3AF";case Bs.COMPANY:return"#EF4444";case Bs.EMPLOYEE:return"#F59E0B";case Bs.VISITOR:return"#10B981";default:return"#6B7280"}}Rl(()=>{oe().catch(ze=>{console.error("[NotesView] Erreur lors du chargement des données:",ze),r.error("Erreur lors du chargement des données")}),document.addEventListener("click",Le),window.addEventListener("resize",C)});async function oe(){var ze;try{if(a.value=!0,await i.loadColumns(),l.isAdmin)try{const Ve=await Bc.getEntreprises();t.value=Ve.data}catch(Ve){console.error("[NotesView][loadInitialData] Erreur chargement entreprises:",Ve)}const He={};!l.isAdmin&&((ze=l.user)!=null&&ze.enterprise_id)&&(He.enterprise_id=l.user.enterprise_id);const pt=await _c.getNotes(He);pt.data.length>0?pt.data.forEach((Ve,it)=>{}):console.warn("[NotesView][loadInitialData] Aucune note reçue du backend!");const ge=i.columns.map(Ve=>Ve.id),Ie=pt.data.filter(Ve=>{const it=(Ve.column||Ve.column_id||"").toString();return it===""||!ge.includes(it)});if(Ie.length>0){console.warn(`[NotesView][loadInitialData] ${Ie.length} notes avec des colonnes invalides:`,Ie);for(const Ve of Ie)try{await _c.updateNote(Ve.id,{column:"2"})}catch(it){console.error(`[NotesView][loadInitialData] Erreur lors de l'assignation de la note ${Ve.id} à la colonne À faire:`,it)}}const Ne=pt.data.map(Ve=>{let it;if(l.isAdmin&&Ve.enterprise_id!=null)if(Ve.enterprise_name)it=Ve.enterprise_name;else{const lt=t.value.find(Mt=>Mt.id===Ve.enterprise_id);it=lt?kl(lt):void 0}return{id:Ve.id,title:Ve.title,description:Ve.description,location:Ve.location,columnId:(Ve.column||Ve.column_id||"2").toString(),access_level:Ve.access_level,style:Ve.style||{},comments:Ve.comments||[],photos:Ve.photos||[],order:Ve.order||0,createdAt:Ve.created_at,updatedAt:Ve.updated_at,enterprise_id:Ve.enterprise_id,enterprise_name:it}});i.notes.length=0,Ne.forEach(Ve=>{i.addNote(Ve)});for(const Ve of i.columns){const it=i.getNotesByColumn(Ve.id);it.length>0&&it.forEach(lt=>{})}}catch(He){console.error("[NotesView][loadInitialData] Erreur:",He),r.error("Erreur lors du chargement des données")}finally{a.value=!1}}function le(){n.push({path:"/",query:{tool:"Note"}})}async function me(ze){if(!ze.location){r.warning("Cette note n'est pas géolocalisée");return}try{const ge=(await _c.getNote(ze.id)).data.plan;n.push({path:"/",query:{lat:Array.isArray(ze.location)?ze.location[0].toString():ze.location.coordinates[1].toString(),lng:Array.isArray(ze.location)?ze.location[1].toString():ze.location.coordinates[0].toString(),noteId:ze.id.toString(),planId:ge?ge.toString():void 0}})}catch(He){console.error("[NotesView][viewOnMap] Erreur lors de la récupération des détails de la note:",He),r.error("Erreur lors de l'ouverture de la note sur la carte")}}function we(ze){if(!ze.location){r.warning("Cette note n'est pas géolocalisée");return}Dd(()=>Promise.resolve().then(()=>BV),void 0).then(He=>{Dd(()=>Promise.resolve().then(()=>Tk),void 0).then(pt=>{const ge=He.extractLatLng(ze.location);if(!ge){r.warning("Coordonnées de la note invalides");return}pt.openInGoogleMaps(ge.lat,ge.lng,"directions",ze.title)})})}function ue(ze){_.value=JSON.parse(JSON.stringify(ze)),w.value="info",f.value=!0}async function _e(ze){var pt,ge;let He=ze.enterprise_id;if(He==null&&(l.isAdmin?He=null:l.isEntreprise&&l.user?He=l.user.id:l.isSalarie&&((pt=l.user)!=null&&pt.enterprise_id)?He=l.user.enterprise_id:l.isVisiteur&&l.user?He=l.user.enterprise_id??null:!l.isAdmin&&((ge=l.user)!=null&&ge.enterprise_id)&&(He=l.user.enterprise_id),He!==null&&ze.id&&i.updateNote(ze.id,{enterprise_id:He})),He!==null&&ze.id){const Ie=i.notes.findIndex(Ne=>Ne.id===ze.id);if(Ie!==-1&&!ze.enterprise_name){const Ne=t.value.find(Ve=>Ve.id===He);Ne&&(i.notes[Ie].enterprise_name=kl(Ne))}}}function We(ze){m.value=ze,o.value=!0}async function he(){if(m.value)try{try{await _c.deleteNote(m.value.id)}catch(ze){if(!(ze.response&&ze.response.status===404))throw ze}i.removeNote(m.value.id),r.success("Note supprimée avec succès")}catch(ze){console.error("Erreur lors de la suppression de la note:",ze),r.error("Erreur lors de la suppression de la note")}finally{o.value=!1,m.value=null}}async function de(ze,He){try{if(ze.added){const{element:pt}=ze.added,ge=typeof pt=="object"&&pt.id?pt.id:null;if(!ge)throw console.error("[NotesView][onDragChange] ID de note invalide:",pt),new Error("ID de note invalide");i.moveNote(ge,He);const Ne=X.value(He).map(it=>it.id);i.reorderNotes(He,Ne);const Ve=i.getColumnById(He);r.success(`Note déplacée vers ${(Ve==null?void 0:Ve.title)||"une autre colonne"}`),await Te(ge,{columnId:He})}if(ze.moved){const pt=X.value(He),ge=pt.map(Ie=>Ie.id);i.reorderNotes(He,ge),r.success("Ordre des notes mis à jour");for(const[Ie,Ne]of pt.entries())await Te(Ne.id,{order:Ie})}}catch(pt){console.error("[NotesView][onDragChange] Erreur:",pt),r.error("Une erreur est survenue lors du déplacement de la note")}}async function Te(ze,He){try{const pt=i.notes.find(Ne=>Ne.id===ze);if(!pt){console.error("[NotesView][updateNoteInBackend] Note non trouvée:",ze);return}const ge={...He};if(He.columnId){const Ne=i.getColumnById(He.columnId);Ne?(ge.column=Ne.id,delete ge.columnId,delete ge.column_id):console.warn(`[NotesView][updateNoteInBackend] Colonne non trouvée: ${He.columnId}`)}const Ie={...pt,...ge,updatedAt:new Date().toISOString()};await _c.updateNote(ze,Ie)}catch(pt){throw console.error("[NotesView][updateNoteInBackend] Erreur:",pt),pt}}function be(){var He;let ze=null;l.isAdmin?ze=null:l.isEntreprise&&l.user?ze=l.user.id:l.isSalarie&&((He=l.user)!=null&&He.enterprise_id)?ze=l.user.enterprise_id:l.isVisiteur&&l.user&&(ze=l.user.enterprise_id??null),_.value={id:"",title:"Nouvelle note",description:"",location:null,columnId:i.getDefaultColumn.id,accessLevel:Bs.PRIVATE,style:{color:"#3B82F6",weight:2,opacity:1,fillColor:"#3B82F6",fillOpacity:.6,radius:8},order:0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),comments:[],photos:[],enterprise_id:ze},f.value=!0,w.value="info"}const ae=Rn(null),ne=Rn(!1);function Se(){ne.value=!ne.value}function Le(ze){ae.value&&!ae.value.contains(ze.target)&&(ne.value=!1)}return Rl(()=>{document.addEventListener("click",Le),window.addEventListener("resize",C)}),wm(()=>{document.removeEventListener("click",Le),window.removeEventListener("resize",C)}),(ze,He)=>{var pt,ge;return yt(),Et("div",UZ,[V("div",VZ,[V("div",$Z,[He[6]||(He[6]=V("div",{class:"sm:flex-auto"},[V("h1",{class:"text-2xl font-semibold text-gray-900"},"Notes"),V("p",{class:"mt-2 text-sm text-gray-700"}," Liste de toutes vos notes. ")],-1)),V("div",GZ,[V("div",{class:"relative",ref_key:"dropdownRef",ref:ae},[V("button",{onClick:Se,class:"inline-flex items-center justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:w-auto"},He[5]||(He[5]=[rs(" Créer "),V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1)])),ne.value?(yt(),Et("div",HZ,[V("div",{class:"py-1"},[V("button",{onClick:be,class:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"}," Note simple "),V("button",{onClick:le,class:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"}," Note géolocalisée ")])])):yr("",!0)],512)])]),V("div",qZ,[V("div",WZ,[V("div",null,[He[7]||(He[7]=V("label",{for:"search",class:"block text-sm font-medium text-gray-700"},"Recherche",-1)),li(V("input",{type:"text",id:"search","onUpdate:modelValue":He[0]||(He[0]=Ie=>z.search=Ie),placeholder:"Rechercher par titre ou description...",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},null,512),[[to,z.search]])]),V("div",null,[He[9]||(He[9]=V("label",{for:"date",class:"block text-sm font-medium text-gray-700"},"Date",-1)),li(V("select",{id:"date","onUpdate:modelValue":He[1]||(He[1]=Ie=>z.date=Ie),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},He[8]||(He[8]=[V("option",{value:""},"Toutes les dates",-1),V("option",{value:"today"},"Aujourd'hui",-1),V("option",{value:"week"},"Cette semaine",-1),V("option",{value:"month"},"Ce mois",-1)]),512),[[Ka,z.date]])]),V("div",null,[He[11]||(He[11]=V("label",{for:"accessLevel",class:"block text-sm font-medium text-gray-700"},"Niveau d'accès",-1)),li(V("select",{id:"accessLevel","onUpdate:modelValue":He[2]||(He[2]=Ie=>z.accessLevel=Ie),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},[He[10]||(He[10]=V("option",{value:""},"Tous les niveaux",-1)),(yt(!0),Et($r,null,Ti(Tr(Gx),Ie=>(yt(),Et("option",{key:Ie.id,value:Ie.id},er(Ie.title),9,ZZ))),128))],512),[[Ka,z.accessLevel]])])])]),a.value?(yt(),Et("div",KZ,He[12]||(He[12]=[V("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"},null,-1),V("p",{class:"mt-2 text-sm text-gray-500"},"Chargement des notes...",-1)]))):(yt(),Et("div",YZ,[W.value.length===0?(yt(),Et("div",XZ,He[13]||(He[13]=[V("p",{class:"text-sm text-gray-500"},"Aucune note trouvée",-1)]))):yr("",!0),W.value.length>0?(yt(),Et("div",JZ,[(yt(!0),Et($r,null,Ti(R.value,Ie=>(yt(),Et("div",{key:Ie.id,class:"column-wrapper md:w-80 md:flex-shrink-0 mb-4 md:mb-0"},[V("div",QZ,[V("div",{class:"p-3 flex items-center justify-between no-select",style:Zh({backgroundColor:Ie.color+"20",borderBottom:"2px solid "+Ie.color})},[V("div",eK,[V("h3",{class:"text-sm font-semibold",style:Zh({color:Ie.color})},er(Ie.title),5)]),V("div",tK,[V("span",nK,er(X.value(Ie.id).length),1)])],4),V("div",rK,[V("div",iK,[Ns(Tr(jZ),{list:X.value(Ie.id),class:"space-y-2 empty-column-drop-zone",group:"notes","item-key":"id",handle:M.value?null:".note-drag-handle",onChange:Ne=>de(Ne,Ie.id),animation:150,"ghost-class":"ghost-card","chosen-class":"chosen","drag-class":"dragging",disabled:M.value},{item:Hh(({element:Ne})=>[V("div",sK,[V("div",oK,[V("div",{class:$s(["p-3 flex items-center justify-between",{"note-drag-handle cursor-move":!M.value,"no-select":!0}])},[V("div",aK,[M.value?yr("",!0):(yt(),Et("svg",lK,He[14]||(He[14]=[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8h16M4 16h16"},null,-1)]))),V("h4",uK,er(Ne.title),1)]),V("div",null,[V("span",{class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium",style:Zh({backgroundColor:Q(Ne.accessLevel)+"20",color:Q(Ne.accessLevel)})},er(Y(Ne.accessLevel)||"Non défini"),5)])],2),V("div",cK,[V("p",hK,er(Ne.description||"Aucune description"),1)]),V("div",dK,[V("span",fK,er(Ne.updatedAt?Tr(cg)(Ne.updatedAt):Ne.createdAt?Tr(cg)(Ne.createdAt):"Date non définie"),1),Tr(l).isAdmin?(yt(),Et("span",pK,er(Ne.enterprise_name||"Non assignée"),1)):yr("",!0),V("div",mK,[Ne.location?(yt(),Et("span",gK,He[15]||(He[15]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1)]))):(yt(),Et("span",yK,He[16]||(He[16]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)]))),Ne.location?(yt(),Et($r,{key:2},[V("button",{onClick:Ve=>we(Ne),class:"p-1 text-gray-400 hover:text-primary-500 focus:outline-none",title:"Ouvrir dans Google Maps"},He[17]||(He[17]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1)]),8,vK),V("button",{onClick:Ve=>me(Ne),class:"p-1 text-gray-400 hover:text-primary-500 focus:outline-none",title:"Voir sur la carte"},He[18]||(He[18]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})],-1)]),8,_K)],64)):yr("",!0),V("button",{onClick:Ve=>ue(Ne),class:"p-1 text-gray-400 hover:text-primary-500 focus:outline-none",title:"Éditer la note"},He[19]||(He[19]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,bK),V("button",{onClick:Ve=>We(Ne),class:"p-1 text-gray-400 hover:text-red-500 focus:outline-none",title:"Supprimer la note"},He[20]||(He[20]=[V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,xK)])])])])]),"empty-content":Hh(()=>He[21]||(He[21]=[V("div",{class:"p-4 text-center text-gray-400 text-sm italic"}," Aucune note dans cette colonne ",-1)])),_:2},1032,["list","handle","onChange","disabled"])])])])]))),128))])):yr("",!0)]))]),o.value?(yt(),Et("div",wK,[V("div",CK,[He[23]||(He[23]=V("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true"},null,-1)),V("div",SK,[He[22]||(He[22]=vd('<div class="p-4 md:p-6" data-v-0467168e><div class="flex items-start" data-v-0467168e><div class="flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100" data-v-0467168e><svg class="h-6 w-6 text-red-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true" data-v-0467168e><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" data-v-0467168e></path></svg></div><div class="ml-4 flex-1" data-v-0467168e><h3 class="text-lg leading-6 font-medium text-gray-900" id="modal-title" data-v-0467168e> Supprimer la note </h3><div class="mt-2" data-v-0467168e><p class="text-sm text-gray-500" data-v-0467168e> Êtes-vous sûr de vouloir supprimer cette note ? Cette action est irréversible. </p></div></div></div></div>',1)),V("div",LK,[V("button",{onClick:he,type:"button",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:w-auto sm:text-sm"}," Supprimer "),V("button",{onClick:He[3]||(He[3]=Ie=>o.value=!1),type:"button",class:"w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:w-auto sm:text-sm"}," Annuler ")])])])])):yr("",!0),f.value?(yt(),Hu(Lk,{key:1,note:_.value,"is-new-note":!((pt=_.value)!=null&&pt.id),location:(ge=_.value)==null?void 0:ge.location,onClose:He[4]||(He[4]=Ie=>f.value=!1),onSave:_e},null,8,["note","is-new-note","location"])):yr("",!0)])}}}),EK=Vf(PK,[["__scopeId","data-v-0467168e"]]);/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function V_(e){return e+.5|0}const sm=(e,t,n)=>Math.max(Math.min(e,n),t);function Av(e){return sm(V_(e*2.55),0,255)}function dm(e){return sm(V_(e*255),0,255)}function cp(e){return sm(V_(e/2.55)/100,0,1)}function BP(e){return sm(V_(e*100),0,100)}const kd={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},g3=[..."0123456789ABCDEF"],MK=e=>g3[e&15],TK=e=>g3[(e&240)>>4]+g3[e&15],kb=e=>(e&240)>>4===(e&15),AK=e=>kb(e.r)&&kb(e.g)&&kb(e.b)&&kb(e.a);function kK(e){var t=e.length,n;return e[0]==="#"&&(t===4||t===5?n={r:255&kd[e[1]]*17,g:255&kd[e[2]]*17,b:255&kd[e[3]]*17,a:t===5?kd[e[4]]*17:255}:(t===7||t===9)&&(n={r:kd[e[1]]<<4|kd[e[2]],g:kd[e[3]]<<4|kd[e[4]],b:kd[e[5]]<<4|kd[e[6]],a:t===9?kd[e[7]]<<4|kd[e[8]]:255})),n}const IK=(e,t)=>e<255?t(e):"";function DK(e){var t=AK(e)?MK:TK;return e?"#"+t(e.r)+t(e.g)+t(e.b)+IK(e.a,t):void 0}const OK=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function uI(e,t,n){const r=t*Math.min(n,1-n),i=(l,a=(l+e/30)%12)=>n-r*Math.max(Math.min(a-3,9-a,1),-1);return[i(0),i(8),i(4)]}function RK(e,t,n){const r=(i,l=(i+e/60)%6)=>n-n*t*Math.max(Math.min(l,4-l,1),0);return[r(5),r(3),r(1)]}function BK(e,t,n){const r=uI(e,1,.5);let i;for(t+n>1&&(i=1/(t+n),t*=i,n*=i),i=0;i<3;i++)r[i]*=1-t-n,r[i]+=t;return r}function NK(e,t,n,r,i){return e===i?(t-n)/r+(t<n?6:0):t===i?(n-e)/r+2:(e-t)/r+4}function FC(e){const n=e.r/255,r=e.g/255,i=e.b/255,l=Math.max(n,r,i),a=Math.min(n,r,i),o=(l+a)/2;let f,m,_;return l!==a&&(_=l-a,m=o>.5?_/(2-l-a):_/(l+a),f=NK(n,r,i,_,l),f=f*60+.5),[f|0,m||0,o]}function zC(e,t,n,r){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,r)).map(dm)}function jC(e,t,n){return zC(uI,e,t,n)}function FK(e,t,n){return zC(BK,e,t,n)}function zK(e,t,n){return zC(RK,e,t,n)}function cI(e){return(e%360+360)%360}function jK(e){const t=OK.exec(e);let n=255,r;if(!t)return;t[5]!==r&&(n=t[6]?Av(+t[5]):dm(+t[5]));const i=cI(+t[2]),l=+t[3]/100,a=+t[4]/100;return t[1]==="hwb"?r=FK(i,l,a):t[1]==="hsv"?r=zK(i,l,a):r=jC(i,l,a),{r:r[0],g:r[1],b:r[2],a:n}}function UK(e,t){var n=FC(e);n[0]=cI(n[0]+t),n=jC(n),e.r=n[0],e.g=n[1],e.b=n[2]}function VK(e){if(!e)return;const t=FC(e),n=t[0],r=BP(t[1]),i=BP(t[2]);return e.a<255?`hsla(${n}, ${r}%, ${i}%, ${cp(e.a)})`:`hsl(${n}, ${r}%, ${i}%)`}const NP={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},FP={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function $K(){const e={},t=Object.keys(FP),n=Object.keys(NP);let r,i,l,a,o;for(r=0;r<t.length;r++){for(a=o=t[r],i=0;i<n.length;i++)l=n[i],o=o.replace(l,NP[l]);l=parseInt(FP[a],16),e[o]=[l>>16&255,l>>8&255,l&255]}return e}let Ib;function GK(e){Ib||(Ib=$K(),Ib.transparent=[0,0,0,0]);const t=Ib[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const HK=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function qK(e){const t=HK.exec(e);let n=255,r,i,l;if(t){if(t[7]!==r){const a=+t[7];n=t[8]?Av(a):sm(a*255,0,255)}return r=+t[1],i=+t[3],l=+t[5],r=255&(t[2]?Av(r):sm(r,0,255)),i=255&(t[4]?Av(i):sm(i,0,255)),l=255&(t[6]?Av(l):sm(l,0,255)),{r,g:i,b:l,a:n}}}function WK(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${cp(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const r4=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,m0=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function ZK(e,t,n){const r=m0(cp(e.r)),i=m0(cp(e.g)),l=m0(cp(e.b));return{r:dm(r4(r+n*(m0(cp(t.r))-r))),g:dm(r4(i+n*(m0(cp(t.g))-i))),b:dm(r4(l+n*(m0(cp(t.b))-l))),a:e.a+n*(t.a-e.a)}}function Db(e,t,n){if(e){let r=FC(e);r[t]=Math.max(0,Math.min(r[t]+r[t]*n,t===0?360:1)),r=jC(r),e.r=r[0],e.g=r[1],e.b=r[2]}}function hI(e,t){return e&&Object.assign(t||{},e)}function zP(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=dm(e[3]))):(t=hI(e,{r:0,g:0,b:0,a:1}),t.a=dm(t.a)),t}function KK(e){return e.charAt(0)==="r"?qK(e):jK(e)}class L_{constructor(t){if(t instanceof L_)return t;const n=typeof t;let r;n==="object"?r=zP(t):n==="string"&&(r=kK(t)||GK(t)||KK(t)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var t=hI(this._rgb);return t&&(t.a=cp(t.a)),t}set rgb(t){this._rgb=zP(t)}rgbString(){return this._valid?WK(this._rgb):void 0}hexString(){return this._valid?DK(this._rgb):void 0}hslString(){return this._valid?VK(this._rgb):void 0}mix(t,n){if(t){const r=this.rgb,i=t.rgb;let l;const a=n===l?.5:n,o=2*a-1,f=r.a-i.a,m=((o*f===-1?o:(o+f)/(1+o*f))+1)/2;l=1-m,r.r=255&m*r.r+l*i.r+.5,r.g=255&m*r.g+l*i.g+.5,r.b=255&m*r.b+l*i.b+.5,r.a=a*r.a+(1-a)*i.a,this.rgb=r}return this}interpolate(t,n){return t&&(this._rgb=ZK(this._rgb,t._rgb,n)),this}clone(){return new L_(this.rgb)}alpha(t){return this._rgb.a=dm(t),this}clearer(t){const n=this._rgb;return n.a*=1-t,this}greyscale(){const t=this._rgb,n=V_(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=n,this}opaquer(t){const n=this._rgb;return n.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Db(this._rgb,2,t),this}darken(t){return Db(this._rgb,2,-t),this}saturate(t){return Db(this._rgb,1,t),this}desaturate(t){return Db(this._rgb,1,-t),this}rotate(t){return UK(this._rgb,t),this}}/*!
 * Chart.js v4.4.1
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */function sp(){}const YK=(()=>{let e=0;return()=>e++})();function go(e){return e===null||typeof e>"u"}function pl(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function qs(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function iu(e){return(typeof e=="number"||e instanceof Number)&&isFinite(+e)}function dd(e,t){return iu(e)?e:t}function Es(e,t){return typeof e>"u"?t:e}const XK=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100:+e/t,dI=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function Na(e,t,n){if(e&&typeof e.call=="function")return e.apply(n,t)}function Yo(e,t,n,r){let i,l,a;if(pl(e))for(l=e.length,i=0;i<l;i++)t.call(n,e[i],i);else if(qs(e))for(a=Object.keys(e),l=a.length,i=0;i<l;i++)t.call(n,e[a[i]],a[i])}function Qx(e,t){let n,r,i,l;if(!e||!t||e.length!==t.length)return!1;for(n=0,r=e.length;n<r;++n)if(i=e[n],l=t[n],i.datasetIndex!==l.datasetIndex||i.index!==l.index)return!1;return!0}function e2(e){if(pl(e))return e.map(e2);if(qs(e)){const t=Object.create(null),n=Object.keys(e),r=n.length;let i=0;for(;i<r;++i)t[n[i]]=e2(e[n[i]]);return t}return e}function fI(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function JK(e,t,n,r){if(!fI(e))return;const i=t[e],l=n[e];qs(i)&&qs(l)?P_(i,l,r):t[e]=e2(l)}function P_(e,t,n){const r=pl(t)?t:[t],i=r.length;if(!qs(e))return e;n=n||{};const l=n.merger||JK;let a;for(let o=0;o<i;++o){if(a=r[o],!qs(a))continue;const f=Object.keys(a);for(let m=0,_=f.length;m<_;++m)l(f[m],e,a,n)}return e}function t_(e,t){return P_(e,t,{merger:QK})}function QK(e,t,n){if(!fI(e))return;const r=t[e],i=n[e];qs(r)&&qs(i)?t_(r,i):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=e2(i))}const jP={"":e=>e,x:e=>e.x,y:e=>e.y};function eY(e){const t=e.split("."),n=[];let r="";for(const i of t)r+=i,r.endsWith("\\")?r=r.slice(0,-1)+".":(n.push(r),r="");return n}function tY(e){const t=eY(e);return n=>{for(const r of t){if(r==="")break;n=n&&n[r]}return n}}function vm(e,t){return(jP[t]||(jP[t]=tY(t)))(e)}function UC(e){return e.charAt(0).toUpperCase()+e.slice(1)}const E_=e=>typeof e<"u",_m=e=>typeof e=="function",UP=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0};function nY(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}const Xa=Math.PI,Ya=2*Xa,rY=Ya+Xa,t2=Number.POSITIVE_INFINITY,iY=Xa/180,Lu=Xa/2,Qm=Xa/4,VP=Xa*2/3,om=Math.log10,Nf=Math.sign;function n_(e,t,n){return Math.abs(e-t)<n}function $P(e){const t=Math.round(e);e=n_(e,t,e/1e3)?t:e;const n=Math.pow(10,Math.floor(om(e))),r=e/n;return(r<=1?1:r<=2?2:r<=5?5:10)*n}function sY(e){const t=[],n=Math.sqrt(e);let r;for(r=1;r<n;r++)e%r===0&&(t.push(r),t.push(e/r));return n===(n|0)&&t.push(n),t.sort((i,l)=>i-l).pop(),t}function W0(e){return!isNaN(parseFloat(e))&&isFinite(e)}function oY(e,t){const n=Math.round(e);return n-t<=e&&n+t>=e}function pI(e,t,n){let r,i,l;for(r=0,i=e.length;r<i;r++)l=e[r][n],isNaN(l)||(t.min=Math.min(t.min,l),t.max=Math.max(t.max,l))}function nf(e){return e*(Xa/180)}function VC(e){return e*(180/Xa)}function GP(e){if(!iu(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function mI(e,t){const n=t.x-e.x,r=t.y-e.y,i=Math.sqrt(n*n+r*r);let l=Math.atan2(r,n);return l<-.5*Xa&&(l+=Ya),{angle:l,distance:i}}function y3(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function aY(e,t){return(e-t+rY)%Ya-Xa}function fd(e){return(e%Ya+Ya)%Ya}function M_(e,t,n,r){const i=fd(e),l=fd(t),a=fd(n),o=fd(l-i),f=fd(a-i),m=fd(i-l),_=fd(i-a);return i===l||i===a||r&&l===a||o>f&&m<_}function bc(e,t,n){return Math.max(t,Math.min(n,e))}function lY(e){return bc(e,-32768,32767)}function pp(e,t,n,r=1e-6){return e>=Math.min(t,n)-r&&e<=Math.max(t,n)+r}function $C(e,t,n){n=n||(a=>e[a]<t);let r=e.length-1,i=0,l;for(;r-i>1;)l=i+r>>1,n(l)?i=l:r=l;return{lo:i,hi:r}}const mp=(e,t,n,r)=>$C(e,n,r?i=>{const l=e[i][t];return l<n||l===n&&e[i+1][t]===n}:i=>e[i][t]<n),uY=(e,t,n)=>$C(e,n,r=>e[r][t]>=n);function cY(e,t,n){let r=0,i=e.length;for(;r<i&&e[r]<t;)r++;for(;i>r&&e[i-1]>n;)i--;return r>0||i<e.length?e.slice(r,i):e}const gI=["push","pop","shift","splice","unshift"];function hY(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),gI.forEach(n=>{const r="_onData"+UC(n),i=e[n];Object.defineProperty(e,n,{configurable:!0,enumerable:!1,value(...l){const a=i.apply(this,l);return e._chartjs.listeners.forEach(o=>{typeof o[r]=="function"&&o[r](...l)}),a}})})}function HP(e,t){const n=e._chartjs;if(!n)return;const r=n.listeners,i=r.indexOf(t);i!==-1&&r.splice(i,1),!(r.length>0)&&(gI.forEach(l=>{delete e[l]}),delete e._chartjs)}function yI(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const vI=function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame}();function _I(e,t){let n=[],r=!1;return function(...i){n=i,r||(r=!0,vI.call(window,()=>{r=!1,e.apply(t,n)}))}}function dY(e,t){let n;return function(...r){return t?(clearTimeout(n),n=setTimeout(e,t,r)):e.apply(this,r),t}}const GC=e=>e==="start"?"left":e==="end"?"right":"center",Xc=(e,t,n)=>e==="start"?t:e==="end"?n:(t+n)/2,fY=(e,t,n,r)=>e===(r?"left":"right")?n:e==="center"?(t+n)/2:t;function bI(e,t,n){const r=t.length;let i=0,l=r;if(e._sorted){const{iScale:a,_parsed:o}=e,f=a.axis,{min:m,max:_,minDefined:w,maxDefined:M}=a.getUserBounds();w&&(i=bc(Math.min(mp(o,f,m).lo,n?r:mp(t,f,a.getPixelForValue(m)).lo),0,r-1)),M?l=bc(Math.max(mp(o,a.axis,_,!0).hi+1,n?0:mp(t,f,a.getPixelForValue(_),!0).hi+1),i,r)-i:l=r-i}return{start:i,count:l}}function xI(e){const{xScale:t,yScale:n,_scaleRanges:r}=e,i={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!r)return e._scaleRanges=i,!0;const l=r.xmin!==t.min||r.xmax!==t.max||r.ymin!==n.min||r.ymax!==n.max;return Object.assign(r,i),l}const Ob=e=>e===0||e===1,qP=(e,t,n)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*Ya/n)),WP=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*Ya/n)+1,r_={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*Lu)+1,easeOutSine:e=>Math.sin(e*Lu),easeInOutSine:e=>-.5*(Math.cos(Xa*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>Ob(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>Ob(e)?e:qP(e,.075,.3),easeOutElastic:e=>Ob(e)?e:WP(e,.075,.3),easeInOutElastic(e){return Ob(e)?e:e<.5?.5*qP(e*2,.1125,.45):.5+.5*WP(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-r_.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?r_.easeInBounce(e*2)*.5:r_.easeOutBounce(e*2-1)*.5+.5};function HC(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function ZP(e){return HC(e)?e:new L_(e)}function i4(e){return HC(e)?e:new L_(e).saturate(.5).darken(.1).hexString()}const pY=["x","y","borderWidth","radius","tension"],mY=["color","borderColor","backgroundColor"];function gY(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),e.set("animations",{colors:{type:"color",properties:mY},numbers:{type:"number",properties:pY}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function yY(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const KP=new Map;function vY(e,t){t=t||{};const n=e+JSON.stringify(t);let r=KP.get(n);return r||(r=new Intl.NumberFormat(e,t),KP.set(n,r)),r}function $_(e,t,n){return vY(t,n).format(e)}const wI={values(e){return pl(e)?e:""+e},numeric(e,t,n){if(e===0)return"0";const r=this.chart.options.locale;let i,l=e;if(n.length>1){const m=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(m<1e-4||m>1e15)&&(i="scientific"),l=_Y(e,n)}const a=om(Math.abs(l)),o=isNaN(a)?1:Math.max(Math.min(-1*Math.floor(a),20),0),f={notation:i,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(f,this.options.ticks.format),$_(e,r,f)},logarithmic(e,t,n){if(e===0)return"0";const r=n[t].significand||e/Math.pow(10,Math.floor(om(e)));return[1,2,3,5,10,15].includes(r)||t>.8*n.length?wI.numeric.call(this,e,t,n):""}};function _Y(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e)),n}var H2={formatters:wI};function bY(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,n)=>n.lineWidth,tickColor:(t,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:H2.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const Sg=Object.create(null),v3=Object.create(null);function i_(e,t){if(!t)return e;const n=t.split(".");for(let r=0,i=n.length;r<i;++r){const l=n[r];e=e[l]||(e[l]=Object.create(null))}return e}function s4(e,t,n){return typeof t=="string"?P_(i_(e,t),n):P_(i_(e,""),t)}class xY{constructor(t,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,i)=>i4(i.backgroundColor),this.hoverBorderColor=(r,i)=>i4(i.borderColor),this.hoverColor=(r,i)=>i4(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(n)}set(t,n){return s4(this,t,n)}get(t){return i_(this,t)}describe(t,n){return s4(v3,t,n)}override(t,n){return s4(Sg,t,n)}route(t,n,r,i){const l=i_(this,t),a=i_(this,r),o="_"+n;Object.defineProperties(l,{[o]:{value:l[n],writable:!0},[n]:{enumerable:!0,get(){const f=this[o],m=a[i];return qs(f)?Object.assign({},m,f):Es(f,m)},set(f){this[o]=f}}})}apply(t){t.forEach(n=>n(this))}}var su=new xY({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[gY,yY,bY]);function wY(e){return!e||go(e.size)||go(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function n2(e,t,n,r,i){let l=t[i];return l||(l=t[i]=e.measureText(i).width,n.push(i)),l>r&&(r=l),r}function CY(e,t,n,r){r=r||{};let i=r.data=r.data||{},l=r.garbageCollect=r.garbageCollect||[];r.font!==t&&(i=r.data={},l=r.garbageCollect=[],r.font=t),e.save(),e.font=t;let a=0;const o=n.length;let f,m,_,w,M;for(f=0;f<o;f++)if(w=n[f],w!=null&&!pl(w))a=n2(e,i,l,a,w);else if(pl(w))for(m=0,_=w.length;m<_;m++)M=w[m],M!=null&&!pl(M)&&(a=n2(e,i,l,a,M));e.restore();const C=l.length/2;if(C>n.length){for(f=0;f<C;f++)delete i[l[f]];l.splice(0,C)}return a}function eg(e,t,n){const r=e.currentDevicePixelRatio,i=n!==0?Math.max(n/2,.5):0;return Math.round((t-i)*r)/r+i}function YP(e,t){t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore()}function _3(e,t,n,r){CI(e,t,n,r,null)}function CI(e,t,n,r,i){let l,a,o,f,m,_,w,M;const C=t.pointStyle,R=t.rotation,z=t.radius;let W=(R||0)*iY;if(C&&typeof C=="object"&&(l=C.toString(),l==="[object HTMLImageElement]"||l==="[object HTMLCanvasElement]")){e.save(),e.translate(n,r),e.rotate(W),e.drawImage(C,-C.width/2,-C.height/2,C.width,C.height),e.restore();return}if(!(isNaN(z)||z<=0)){switch(e.beginPath(),C){default:i?e.ellipse(n,r,i/2,z,0,0,Ya):e.arc(n,r,z,0,Ya),e.closePath();break;case"triangle":_=i?i/2:z,e.moveTo(n+Math.sin(W)*_,r-Math.cos(W)*z),W+=VP,e.lineTo(n+Math.sin(W)*_,r-Math.cos(W)*z),W+=VP,e.lineTo(n+Math.sin(W)*_,r-Math.cos(W)*z),e.closePath();break;case"rectRounded":m=z*.516,f=z-m,a=Math.cos(W+Qm)*f,w=Math.cos(W+Qm)*(i?i/2-m:f),o=Math.sin(W+Qm)*f,M=Math.sin(W+Qm)*(i?i/2-m:f),e.arc(n-w,r-o,m,W-Xa,W-Lu),e.arc(n+M,r-a,m,W-Lu,W),e.arc(n+w,r+o,m,W,W+Lu),e.arc(n-M,r+a,m,W+Lu,W+Xa),e.closePath();break;case"rect":if(!R){f=Math.SQRT1_2*z,_=i?i/2:f,e.rect(n-_,r-f,2*_,2*f);break}W+=Qm;case"rectRot":w=Math.cos(W)*(i?i/2:z),a=Math.cos(W)*z,o=Math.sin(W)*z,M=Math.sin(W)*(i?i/2:z),e.moveTo(n-w,r-o),e.lineTo(n+M,r-a),e.lineTo(n+w,r+o),e.lineTo(n-M,r+a),e.closePath();break;case"crossRot":W+=Qm;case"cross":w=Math.cos(W)*(i?i/2:z),a=Math.cos(W)*z,o=Math.sin(W)*z,M=Math.sin(W)*(i?i/2:z),e.moveTo(n-w,r-o),e.lineTo(n+w,r+o),e.moveTo(n+M,r-a),e.lineTo(n-M,r+a);break;case"star":w=Math.cos(W)*(i?i/2:z),a=Math.cos(W)*z,o=Math.sin(W)*z,M=Math.sin(W)*(i?i/2:z),e.moveTo(n-w,r-o),e.lineTo(n+w,r+o),e.moveTo(n+M,r-a),e.lineTo(n-M,r+a),W+=Qm,w=Math.cos(W)*(i?i/2:z),a=Math.cos(W)*z,o=Math.sin(W)*z,M=Math.sin(W)*(i?i/2:z),e.moveTo(n-w,r-o),e.lineTo(n+w,r+o),e.moveTo(n+M,r-a),e.lineTo(n-M,r+a);break;case"line":a=i?i/2:Math.cos(W)*z,o=Math.sin(W)*z,e.moveTo(n-a,r-o),e.lineTo(n+a,r+o);break;case"dash":e.moveTo(n,r),e.lineTo(n+Math.cos(W)*(i?i/2:z),r+Math.sin(W)*z);break;case!1:e.closePath();break}e.fill(),t.borderWidth>0&&e.stroke()}}function gp(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function q2(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function W2(e){e.restore()}function SY(e,t,n,r,i){if(!t)return e.lineTo(n.x,n.y);if(i==="middle"){const l=(t.x+n.x)/2;e.lineTo(l,t.y),e.lineTo(l,n.y)}else i==="after"!=!!r?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function LY(e,t,n,r){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(r?t.cp1x:t.cp2x,r?t.cp1y:t.cp2y,r?n.cp2x:n.cp1x,r?n.cp2y:n.cp1y,n.x,n.y)}function PY(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),go(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function EY(e,t,n,r,i){if(i.strikethrough||i.underline){const l=e.measureText(r),a=t-l.actualBoundingBoxLeft,o=t+l.actualBoundingBoxRight,f=n-l.actualBoundingBoxAscent,m=n+l.actualBoundingBoxDescent,_=i.strikethrough?(f+m)/2:m;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=i.decorationWidth||2,e.moveTo(a,_),e.lineTo(o,_),e.stroke()}}function MY(e,t){const n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}function Lg(e,t,n,r,i,l={}){const a=pl(t)?t:[t],o=l.strokeWidth>0&&l.strokeColor!=="";let f,m;for(e.save(),e.font=i.string,PY(e,l),f=0;f<a.length;++f)m=a[f],l.backdrop&&MY(e,l.backdrop),o&&(l.strokeColor&&(e.strokeStyle=l.strokeColor),go(l.strokeWidth)||(e.lineWidth=l.strokeWidth),e.strokeText(m,n,r,l.maxWidth)),e.fillText(m,n,r,l.maxWidth),EY(e,n,r,m,l),r+=Number(i.lineHeight);e.restore()}function T_(e,t){const{x:n,y:r,w:i,h:l,radius:a}=t;e.arc(n+a.topLeft,r+a.topLeft,a.topLeft,1.5*Xa,Xa,!0),e.lineTo(n,r+l-a.bottomLeft),e.arc(n+a.bottomLeft,r+l-a.bottomLeft,a.bottomLeft,Xa,Lu,!0),e.lineTo(n+i-a.bottomRight,r+l),e.arc(n+i-a.bottomRight,r+l-a.bottomRight,a.bottomRight,Lu,0,!0),e.lineTo(n+i,r+a.topRight),e.arc(n+i-a.topRight,r+a.topRight,a.topRight,0,-Lu,!0),e.lineTo(n+a.topLeft,r)}const TY=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,AY=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function kY(e,t){const n=(""+e).match(TY);if(!n||n[1]==="normal")return t*1.2;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100;break}return t*e}const IY=e=>+e||0;function qC(e,t){const n={},r=qs(t),i=r?Object.keys(t):t,l=qs(e)?r?a=>Es(e[a],e[t[a]]):a=>e[a]:()=>e;for(const a of i)n[a]=IY(l(a));return n}function SI(e){return qC(e,{top:"y",right:"x",bottom:"y",left:"x"})}function _g(e){return qC(e,["topLeft","topRight","bottomLeft","bottomRight"])}function oh(e){const t=SI(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function cc(e,t){e=e||{},t=t||su.font;let n=Es(e.size,t.size);typeof n=="string"&&(n=parseInt(n,10));let r=Es(e.style,t.style);r&&!(""+r).match(AY)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const i={family:Es(e.family,t.family),lineHeight:kY(Es(e.lineHeight,t.lineHeight),n),size:n,style:r,weight:Es(e.weight,t.weight),string:""};return i.string=wY(i),i}function kv(e,t,n,r){let i,l,a;for(i=0,l=e.length;i<l;++i)if(a=e[i],a!==void 0&&a!==void 0)return a}function DY(e,t,n){const{min:r,max:i}=e,l=dI(t,(i-r)/2),a=(o,f)=>n&&o===0?0:o+f;return{min:a(r,-Math.abs(l)),max:a(i,l)}}function Cm(e,t){return Object.assign(Object.create(e),t)}function WC(e,t=[""],n,r,i=()=>e[0]){const l=n||e;typeof r>"u"&&(r=MI("_fallback",e));const a={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:l,_fallback:r,_getTarget:i,override:o=>WC([o,...e],t,l,r)};return new Proxy(a,{deleteProperty(o,f){return delete o[f],delete o._keys,delete e[0][f],!0},get(o,f){return PI(o,f,()=>UY(f,t,e,o))},getOwnPropertyDescriptor(o,f){return Reflect.getOwnPropertyDescriptor(o._scopes[0],f)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(o,f){return JP(o).includes(f)},ownKeys(o){return JP(o)},set(o,f,m){const _=o._storage||(o._storage=i());return o[f]=_[f]=m,delete o._keys,!0}})}function Z0(e,t,n,r){const i={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:LI(e,r),setContext:l=>Z0(e,l,n,r),override:l=>Z0(e.override(l),t,n,r)};return new Proxy(i,{deleteProperty(l,a){return delete l[a],delete e[a],!0},get(l,a,o){return PI(l,a,()=>RY(l,a,o))},getOwnPropertyDescriptor(l,a){return l._descriptors.allKeys?Reflect.has(e,a)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,a)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(l,a){return Reflect.has(e,a)},ownKeys(){return Reflect.ownKeys(e)},set(l,a,o){return e[a]=o,delete l[a],!0}})}function LI(e,t={scriptable:!0,indexable:!0}){const{_scriptable:n=t.scriptable,_indexable:r=t.indexable,_allKeys:i=t.allKeys}=e;return{allKeys:i,scriptable:n,indexable:r,isScriptable:_m(n)?n:()=>n,isIndexable:_m(r)?r:()=>r}}const OY=(e,t)=>e?e+UC(t):t,ZC=(e,t)=>qs(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function PI(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t))return e[t];const r=n();return e[t]=r,r}function RY(e,t,n){const{_proxy:r,_context:i,_subProxy:l,_descriptors:a}=e;let o=r[t];return _m(o)&&a.isScriptable(t)&&(o=BY(t,o,e,n)),pl(o)&&o.length&&(o=NY(t,o,e,a.isIndexable)),ZC(t,o)&&(o=Z0(o,i,l&&l[t],a)),o}function BY(e,t,n,r){const{_proxy:i,_context:l,_subProxy:a,_stack:o}=n;if(o.has(e))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+e);o.add(e);let f=t(l,a||r);return o.delete(e),ZC(e,f)&&(f=KC(i._scopes,i,e,f)),f}function NY(e,t,n,r){const{_proxy:i,_context:l,_subProxy:a,_descriptors:o}=n;if(typeof l.index<"u"&&r(e))return t[l.index%t.length];if(qs(t[0])){const f=t,m=i._scopes.filter(_=>_!==f);t=[];for(const _ of f){const w=KC(m,i,e,_);t.push(Z0(w,l,a&&a[e],o))}}return t}function EI(e,t,n){return _m(e)?e(t,n):e}const FY=(e,t)=>e===!0?t:typeof e=="string"?vm(t,e):void 0;function zY(e,t,n,r,i){for(const l of t){const a=FY(n,l);if(a){e.add(a);const o=EI(a._fallback,n,i);if(typeof o<"u"&&o!==n&&o!==r)return o}else if(a===!1&&typeof r<"u"&&n!==r)return null}return!1}function KC(e,t,n,r){const i=t._rootScopes,l=EI(t._fallback,n,r),a=[...e,...i],o=new Set;o.add(r);let f=XP(o,a,n,l||n,r);return f===null||typeof l<"u"&&l!==n&&(f=XP(o,a,l,f,r),f===null)?!1:WC(Array.from(o),[""],i,l,()=>jY(t,n,r))}function XP(e,t,n,r,i){for(;n;)n=zY(e,t,n,r,i);return n}function jY(e,t,n){const r=e._getTarget();t in r||(r[t]={});const i=r[t];return pl(i)&&qs(n)?n:i||{}}function UY(e,t,n,r){let i;for(const l of t)if(i=MI(OY(l,e),n),typeof i<"u")return ZC(e,i)?KC(n,r,e,i):i}function MI(e,t){for(const n of t){if(!n)continue;const r=n[e];if(typeof r<"u")return r}}function JP(e){let t=e._keys;return t||(t=e._keys=VY(e._scopes)),t}function VY(e){const t=new Set;for(const n of e)for(const r of Object.keys(n).filter(i=>!i.startsWith("_")))t.add(r);return Array.from(t)}function TI(e,t,n,r){const{iScale:i}=e,{key:l="r"}=this._parsing,a=new Array(r);let o,f,m,_;for(o=0,f=r;o<f;++o)m=o+n,_=t[m],a[o]={r:i.parse(vm(_,l),m)};return a}const $Y=Number.EPSILON||1e-14,K0=(e,t)=>t<e.length&&!e[t].skip&&e[t],AI=e=>e==="x"?"y":"x";function GY(e,t,n,r){const i=e.skip?t:e,l=t,a=n.skip?t:n,o=y3(l,i),f=y3(a,l);let m=o/(o+f),_=f/(o+f);m=isNaN(m)?0:m,_=isNaN(_)?0:_;const w=r*m,M=r*_;return{previous:{x:l.x-w*(a.x-i.x),y:l.y-w*(a.y-i.y)},next:{x:l.x+M*(a.x-i.x),y:l.y+M*(a.y-i.y)}}}function HY(e,t,n){const r=e.length;let i,l,a,o,f,m=K0(e,0);for(let _=0;_<r-1;++_)if(f=m,m=K0(e,_+1),!(!f||!m)){if(n_(t[_],0,$Y)){n[_]=n[_+1]=0;continue}i=n[_]/t[_],l=n[_+1]/t[_],o=Math.pow(i,2)+Math.pow(l,2),!(o<=9)&&(a=3/Math.sqrt(o),n[_]=i*a*t[_],n[_+1]=l*a*t[_])}}function qY(e,t,n="x"){const r=AI(n),i=e.length;let l,a,o,f=K0(e,0);for(let m=0;m<i;++m){if(a=o,o=f,f=K0(e,m+1),!o)continue;const _=o[n],w=o[r];a&&(l=(_-a[n])/3,o[`cp1${n}`]=_-l,o[`cp1${r}`]=w-l*t[m]),f&&(l=(f[n]-_)/3,o[`cp2${n}`]=_+l,o[`cp2${r}`]=w+l*t[m])}}function WY(e,t="x"){const n=AI(t),r=e.length,i=Array(r).fill(0),l=Array(r);let a,o,f,m=K0(e,0);for(a=0;a<r;++a)if(o=f,f=m,m=K0(e,a+1),!!f){if(m){const _=m[t]-f[t];i[a]=_!==0?(m[n]-f[n])/_:0}l[a]=o?m?Nf(i[a-1])!==Nf(i[a])?0:(i[a-1]+i[a])/2:i[a-1]:i[a]}HY(e,i,l),qY(e,l,t)}function Rb(e,t,n){return Math.max(Math.min(e,n),t)}function ZY(e,t){let n,r,i,l,a,o=gp(e[0],t);for(n=0,r=e.length;n<r;++n)a=l,l=o,o=n<r-1&&gp(e[n+1],t),l&&(i=e[n],a&&(i.cp1x=Rb(i.cp1x,t.left,t.right),i.cp1y=Rb(i.cp1y,t.top,t.bottom)),o&&(i.cp2x=Rb(i.cp2x,t.left,t.right),i.cp2y=Rb(i.cp2y,t.top,t.bottom)))}function KY(e,t,n,r,i){let l,a,o,f;if(t.spanGaps&&(e=e.filter(m=>!m.skip)),t.cubicInterpolationMode==="monotone")WY(e,i);else{let m=r?e[e.length-1]:e[0];for(l=0,a=e.length;l<a;++l)o=e[l],f=GY(m,o,e[Math.min(l+1,a-(r?0:1))%a],t.tension),o.cp1x=f.previous.x,o.cp1y=f.previous.y,o.cp2x=f.next.x,o.cp2y=f.next.y,m=o}t.capBezierPoints&&ZY(e,n)}function YC(){return typeof window<"u"&&typeof document<"u"}function XC(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function r2(e,t,n){let r;return typeof e=="string"?(r=parseInt(e,10),e.indexOf("%")!==-1&&(r=r/100*t.parentNode[n])):r=e,r}const Z2=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function YY(e,t){return Z2(e).getPropertyValue(t)}const XY=["top","right","bottom","left"];function bg(e,t,n){const r={};n=n?"-"+n:"";for(let i=0;i<4;i++){const l=XY[i];r[l]=parseFloat(e[t+"-"+l+n])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const JY=(e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot);function QY(e,t){const n=e.touches,r=n&&n.length?n[0]:e,{offsetX:i,offsetY:l}=r;let a=!1,o,f;if(JY(i,l,e.target))o=i,f=l;else{const m=t.getBoundingClientRect();o=r.clientX-m.left,f=r.clientY-m.top,a=!0}return{x:o,y:f,box:a}}function sg(e,t){if("native"in e)return e;const{canvas:n,currentDevicePixelRatio:r}=t,i=Z2(n),l=i.boxSizing==="border-box",a=bg(i,"padding"),o=bg(i,"border","width"),{x:f,y:m,box:_}=QY(e,n),w=a.left+(_&&o.left),M=a.top+(_&&o.top);let{width:C,height:R}=t;return l&&(C-=a.width+o.width,R-=a.height+o.height),{x:Math.round((f-w)/C*n.width/r),y:Math.round((m-M)/R*n.height/r)}}function eX(e,t,n){let r,i;if(t===void 0||n===void 0){const l=XC(e);if(!l)t=e.clientWidth,n=e.clientHeight;else{const a=l.getBoundingClientRect(),o=Z2(l),f=bg(o,"border","width"),m=bg(o,"padding");t=a.width-m.width-f.width,n=a.height-m.height-f.height,r=r2(o.maxWidth,l,"clientWidth"),i=r2(o.maxHeight,l,"clientHeight")}}return{width:t,height:n,maxWidth:r||t2,maxHeight:i||t2}}const Bb=e=>Math.round(e*10)/10;function tX(e,t,n,r){const i=Z2(e),l=bg(i,"margin"),a=r2(i.maxWidth,e,"clientWidth")||t2,o=r2(i.maxHeight,e,"clientHeight")||t2,f=eX(e,t,n);let{width:m,height:_}=f;if(i.boxSizing==="content-box"){const M=bg(i,"border","width"),C=bg(i,"padding");m-=C.width+M.width,_-=C.height+M.height}return m=Math.max(0,m-l.width),_=Math.max(0,r?m/r:_-l.height),m=Bb(Math.min(m,a,f.maxWidth)),_=Bb(Math.min(_,o,f.maxHeight)),m&&!_&&(_=Bb(m/2)),(t!==void 0||n!==void 0)&&r&&f.height&&_>f.height&&(_=f.height,m=Bb(Math.floor(_*r))),{width:m,height:_}}function QP(e,t,n){const r=t||1,i=Math.floor(e.height*r),l=Math.floor(e.width*r);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const a=e.canvas;return a.style&&(n||!a.style.height&&!a.style.width)&&(a.style.height=`${e.height}px`,a.style.width=`${e.width}px`),e.currentDevicePixelRatio!==r||a.height!==i||a.width!==l?(e.currentDevicePixelRatio=r,a.height=i,a.width=l,e.ctx.setTransform(r,0,0,r,0,0),!0):!1}const nX=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};YC()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return e}();function eE(e,t){const n=YY(e,t),r=n&&n.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function og(e,t,n,r){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function rX(e,t,n,r){return{x:e.x+n*(t.x-e.x),y:r==="middle"?n<.5?e.y:t.y:r==="after"?n<1?e.y:t.y:n>0?t.y:e.y}}function iX(e,t,n,r){const i={x:e.cp2x,y:e.cp2y},l={x:t.cp1x,y:t.cp1y},a=og(e,i,n),o=og(i,l,n),f=og(l,t,n),m=og(a,o,n),_=og(o,f,n);return og(m,_,n)}const sX=function(e,t){return{x(n){return e+e+t-n},setWidth(n){t=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,r){return n-r},leftForLtr(n,r){return n-r}}},oX=function(){return{x(e){return e},setWidth(e){},textAlign(e){return e},xPlus(e,t){return e+t},leftForLtr(e,t){return e}}};function z0(e,t,n){return e?sX(t,n):oX()}function kI(e,t){let n,r;(t==="ltr"||t==="rtl")&&(n=e.canvas.style,r=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=r)}function II(e,t){t!==void 0&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function DI(e){return e==="angle"?{between:M_,compare:aY,normalize:fd}:{between:pp,compare:(t,n)=>t-n,normalize:t=>t}}function tE({start:e,end:t,count:n,loop:r,style:i}){return{start:e%n,end:t%n,loop:r&&(t-e+1)%n===0,style:i}}function aX(e,t,n){const{property:r,start:i,end:l}=n,{between:a,normalize:o}=DI(r),f=t.length;let{start:m,end:_,loop:w}=e,M,C;if(w){for(m+=f,_+=f,M=0,C=f;M<C&&a(o(t[m%f][r]),i,l);++M)m--,_--;m%=f,_%=f}return _<m&&(_+=f),{start:m,end:_,loop:w,style:e.style}}function OI(e,t,n){if(!n)return[e];const{property:r,start:i,end:l}=n,a=t.length,{compare:o,between:f,normalize:m}=DI(r),{start:_,end:w,loop:M,style:C}=aX(e,t,n),R=[];let z=!1,W=null,X,Y,Q;const oe=()=>f(i,Q,X)&&o(i,Q)!==0,le=()=>o(l,X)===0||f(l,Q,X),me=()=>z||oe(),we=()=>!z||le();for(let ue=_,_e=_;ue<=w;++ue)Y=t[ue%a],!Y.skip&&(X=m(Y[r]),X!==Q&&(z=f(X,i,l),W===null&&me()&&(W=o(X,i)===0?ue:_e),W!==null&&we()&&(R.push(tE({start:W,end:ue,loop:M,count:a,style:C})),W=null),_e=ue,Q=X));return W!==null&&R.push(tE({start:W,end:w,loop:M,count:a,style:C})),R}function RI(e,t){const n=[],r=e.segments;for(let i=0;i<r.length;i++){const l=OI(r[i],e.points,t);l.length&&n.push(...l)}return n}function lX(e,t,n,r){let i=0,l=t-1;if(n&&!r)for(;i<t&&!e[i].skip;)i++;for(;i<t&&e[i].skip;)i++;for(i%=t,n&&(l+=i);l>i&&e[l%t].skip;)l--;return l%=t,{start:i,end:l}}function uX(e,t,n,r){const i=e.length,l=[];let a=t,o=e[t],f;for(f=t+1;f<=n;++f){const m=e[f%i];m.skip||m.stop?o.skip||(r=!1,l.push({start:t%i,end:(f-1)%i,loop:r}),t=a=m.stop?f:null):(a=f,o.skip&&(t=f)),o=m}return a!==null&&l.push({start:t%i,end:a%i,loop:r}),l}function cX(e,t){const n=e.points,r=e.options.spanGaps,i=n.length;if(!i)return[];const l=!!e._loop,{start:a,end:o}=lX(n,i,l,r);if(r===!0)return nE(e,[{start:a,end:o,loop:l}],n,t);const f=o<a?o+i:o,m=!!e._fullLoop&&a===0&&o===i-1;return nE(e,uX(n,a,f,m),n,t)}function nE(e,t,n,r){return!r||!r.setContext||!n?t:hX(e,t,n,r)}function hX(e,t,n,r){const i=e._chart.getContext(),l=rE(e.options),{_datasetIndex:a,options:{spanGaps:o}}=e,f=n.length,m=[];let _=l,w=t[0].start,M=w;function C(R,z,W,X){const Y=o?-1:1;if(R!==z){for(R+=f;n[R%f].skip;)R-=Y;for(;n[z%f].skip;)z+=Y;R%f!==z%f&&(m.push({start:R%f,end:z%f,loop:W,style:X}),_=X,w=z%f)}}for(const R of t){w=o?w:R.start;let z=n[w%f],W;for(M=w+1;M<=R.end;M++){const X=n[M%f];W=rE(r.setContext(Cm(i,{type:"segment",p0:z,p1:X,p0DataIndex:(M-1)%f,p1DataIndex:M%f,datasetIndex:a}))),dX(W,_)&&C(w,M-1,R.loop,_),z=X,_=W}w<M-1&&C(w,M-1,R.loop,_)}return m}function rE(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function dX(e,t){if(!t)return!1;const n=[],r=function(i,l){return HC(l)?(n.includes(l)||n.push(l),n.indexOf(l)):l};return JSON.stringify(e,r)!==JSON.stringify(t,r)}/*!
 * Chart.js v4.4.1
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */class fX{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,n,r,i){const l=n.listeners[i],a=n.duration;l.forEach(o=>o({chart:t,initial:n.initial,numSteps:a,currentStep:Math.min(r-n.start,a)}))}_refresh(){this._request||(this._running=!0,this._request=vI.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let n=0;this._charts.forEach((r,i)=>{if(!r.running||!r.items.length)return;const l=r.items;let a=l.length-1,o=!1,f;for(;a>=0;--a)f=l[a],f._active?(f._total>r.duration&&(r.duration=f._total),f.tick(t),o=!0):(l[a]=l[l.length-1],l.pop());o&&(i.draw(),this._notify(i,r,t,"progress")),l.length||(r.running=!1,this._notify(i,r,t,"complete"),r.initial=!1),n+=l.length}),this._lastDate=t,n===0&&(this._running=!1)}_getAnims(t){const n=this._charts;let r=n.get(t);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(t,r)),r}listen(t,n,r){this._getAnims(t).listeners[n].push(r)}add(t,n){!n||!n.length||this._getAnims(t).items.push(...n)}has(t){return this._getAnims(t).items.length>0}start(t){const n=this._charts.get(t);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((r,i)=>Math.max(r,i._duration),0),this._refresh())}running(t){if(!this._running)return!1;const n=this._charts.get(t);return!(!n||!n.running||!n.items.length)}stop(t){const n=this._charts.get(t);if(!n||!n.items.length)return;const r=n.items;let i=r.length-1;for(;i>=0;--i)r[i].cancel();n.items=[],this._notify(t,n,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var ap=new fX;const iE="transparent",pX={boolean(e,t,n){return n>.5?t:e},color(e,t,n){const r=ZP(e||iE),i=r.valid&&ZP(t||iE);return i&&i.valid?i.mix(r,n).hexString():t},number(e,t,n){return e+(t-e)*n}};class mX{constructor(t,n,r,i){const l=n[r];i=kv([t.to,i,l,t.from]);const a=kv([t.from,l,i]);this._active=!0,this._fn=t.fn||pX[t.type||typeof a],this._easing=r_[t.easing]||r_.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=n,this._prop=r,this._from=a,this._to=i,this._promises=void 0}active(){return this._active}update(t,n,r){if(this._active){this._notify(!1);const i=this._target[this._prop],l=r-this._start,a=this._duration-l;this._start=r,this._duration=Math.floor(Math.max(a,t.duration)),this._total+=l,this._loop=!!t.loop,this._to=kv([t.to,n,i,t.from]),this._from=kv([t.from,i,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const n=t-this._start,r=this._duration,i=this._prop,l=this._from,a=this._loop,o=this._to;let f;if(this._active=l!==o&&(a||n<r),!this._active){this._target[i]=o,this._notify(!0);return}if(n<0){this._target[i]=l;return}f=n/r%2,f=a&&f>1?2-f:f,f=this._easing(Math.min(1,Math.max(0,f))),this._target[i]=this._fn(l,o,f)}wait(){const t=this._promises||(this._promises=[]);return new Promise((n,r)=>{t.push({res:n,rej:r})})}_notify(t){const n=t?"res":"rej",r=this._promises||[];for(let i=0;i<r.length;i++)r[i][n]()}}class BI{constructor(t,n){this._chart=t,this._properties=new Map,this.configure(n)}configure(t){if(!qs(t))return;const n=Object.keys(su.animation),r=this._properties;Object.getOwnPropertyNames(t).forEach(i=>{const l=t[i];if(!qs(l))return;const a={};for(const o of n)a[o]=l[o];(pl(l.properties)&&l.properties||[i]).forEach(o=>{(o===i||!r.has(o))&&r.set(o,a)})})}_animateOptions(t,n){const r=n.options,i=yX(t,r);if(!i)return[];const l=this._createAnimations(i,r);return r.$shared&&gX(t.options.$animations,r).then(()=>{t.options=r},()=>{}),l}_createAnimations(t,n){const r=this._properties,i=[],l=t.$animations||(t.$animations={}),a=Object.keys(n),o=Date.now();let f;for(f=a.length-1;f>=0;--f){const m=a[f];if(m.charAt(0)==="$")continue;if(m==="options"){i.push(...this._animateOptions(t,n));continue}const _=n[m];let w=l[m];const M=r.get(m);if(w)if(M&&w.active()){w.update(M,_,o);continue}else w.cancel();if(!M||!M.duration){t[m]=_;continue}l[m]=w=new mX(M,t,m,_),i.push(w)}return i}update(t,n){if(this._properties.size===0){Object.assign(t,n);return}const r=this._createAnimations(t,n);if(r.length)return ap.add(this._chart,r),!0}}function gX(e,t){const n=[],r=Object.keys(t);for(let i=0;i<r.length;i++){const l=e[r[i]];l&&l.active()&&n.push(l.wait())}return Promise.all(n)}function yX(e,t){if(!t)return;let n=e.options;if(!n){e.options=t;return}return n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function sE(e,t){const n=e&&e.options||{},r=n.reverse,i=n.min===void 0?t:0,l=n.max===void 0?t:0;return{start:r?l:i,end:r?i:l}}function vX(e,t,n){if(n===!1)return!1;const r=sE(e,n),i=sE(t,n);return{top:i.end,right:r.end,bottom:i.start,left:r.start}}function _X(e){let t,n,r,i;return qs(e)?(t=e.top,n=e.right,r=e.bottom,i=e.left):t=n=r=i=e,{top:t,right:n,bottom:r,left:i,disabled:e===!1}}function NI(e,t){const n=[],r=e._getSortedDatasetMetas(t);let i,l;for(i=0,l=r.length;i<l;++i)n.push(r[i].index);return n}function oE(e,t,n,r={}){const i=e.keys,l=r.mode==="single";let a,o,f,m;if(t!==null){for(a=0,o=i.length;a<o;++a){if(f=+i[a],f===n){if(r.all)continue;break}m=e.values[f],iu(m)&&(l||t===0||Nf(t)===Nf(m))&&(t+=m)}return t}}function bX(e){const t=Object.keys(e),n=new Array(t.length);let r,i,l;for(r=0,i=t.length;r<i;++r)l=t[r],n[r]={x:l,y:e[l]};return n}function aE(e,t){const n=e&&e.options.stacked;return n||n===void 0&&t.stack!==void 0}function xX(e,t,n){return`${e.id}.${t.id}.${n.stack||n.type}`}function wX(e){const{min:t,max:n,minDefined:r,maxDefined:i}=e.getUserBounds();return{min:r?t:Number.NEGATIVE_INFINITY,max:i?n:Number.POSITIVE_INFINITY}}function CX(e,t,n){const r=e[t]||(e[t]={});return r[n]||(r[n]={})}function lE(e,t,n,r){for(const i of t.getMatchingVisibleMetas(r).reverse()){const l=e[i.index];if(n&&l>0||!n&&l<0)return i.index}return null}function uE(e,t){const{chart:n,_cachedMeta:r}=e,i=n._stacks||(n._stacks={}),{iScale:l,vScale:a,index:o}=r,f=l.axis,m=a.axis,_=xX(l,a,r),w=t.length;let M;for(let C=0;C<w;++C){const R=t[C],{[f]:z,[m]:W}=R,X=R._stacks||(R._stacks={});M=X[m]=CX(i,_,z),M[o]=W,M._top=lE(M,a,!0,r.type),M._bottom=lE(M,a,!1,r.type);const Y=M._visualValues||(M._visualValues={});Y[o]=W}}function o4(e,t){const n=e.scales;return Object.keys(n).filter(r=>n[r].axis===t).shift()}function SX(e,t){return Cm(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function LX(e,t,n){return Cm(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}function fv(e,t){const n=e.controller.index,r=e.vScale&&e.vScale.axis;if(r){t=t||e._parsed;for(const i of t){const l=i._stacks;if(!l||l[r]===void 0||l[r][n]===void 0)return;delete l[r][n],l[r]._visualValues!==void 0&&l[r]._visualValues[n]!==void 0&&delete l[r]._visualValues[n]}}}const a4=e=>e==="reset"||e==="none",cE=(e,t)=>t?e:Object.assign({},e),PX=(e,t,n)=>e&&!t.hidden&&t._stacked&&{keys:NI(n,!0),values:null};class sf{constructor(t,n){this.chart=t,this._ctx=t.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=aE(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&fv(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,n=this._cachedMeta,r=this.getDataset(),i=(w,M,C,R)=>w==="x"?M:w==="r"?R:C,l=n.xAxisID=Es(r.xAxisID,o4(t,"x")),a=n.yAxisID=Es(r.yAxisID,o4(t,"y")),o=n.rAxisID=Es(r.rAxisID,o4(t,"r")),f=n.indexAxis,m=n.iAxisID=i(f,l,a,o),_=n.vAxisID=i(f,a,l,o);n.xScale=this.getScaleForId(l),n.yScale=this.getScaleForId(a),n.rScale=this.getScaleForId(o),n.iScale=this.getScaleForId(m),n.vScale=this.getScaleForId(_)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const n=this._cachedMeta;return t===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&HP(this._data,this),t._stacked&&fv(t)}_dataCheck(){const t=this.getDataset(),n=t.data||(t.data=[]),r=this._data;if(qs(n))this._data=bX(n);else if(r!==n){if(r){HP(r,this);const i=this._cachedMeta;fv(i),i._parsed=[]}n&&Object.isExtensible(n)&&hY(n,this),this._syncList=[],this._data=n}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const n=this._cachedMeta,r=this.getDataset();let i=!1;this._dataCheck();const l=n._stacked;n._stacked=aE(n.vScale,n),n.stack!==r.stack&&(i=!0,fv(n),n.stack=r.stack),this._resyncElements(t),(i||l!==n._stacked)&&uE(this,n._parsed)}configure(){const t=this.chart.config,n=t.datasetScopeKeys(this._type),r=t.getOptionScopes(this.getDataset(),n,!0);this.options=t.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,n){const{_cachedMeta:r,_data:i}=this,{iScale:l,_stacked:a}=r,o=l.axis;let f=t===0&&n===i.length?!0:r._sorted,m=t>0&&r._parsed[t-1],_,w,M;if(this._parsing===!1)r._parsed=i,r._sorted=!0,M=i;else{pl(i[t])?M=this.parseArrayData(r,i,t,n):qs(i[t])?M=this.parseObjectData(r,i,t,n):M=this.parsePrimitiveData(r,i,t,n);const C=()=>w[o]===null||m&&w[o]<m[o];for(_=0;_<n;++_)r._parsed[_+t]=w=M[_],f&&(C()&&(f=!1),m=w);r._sorted=f}a&&uE(this,M)}parsePrimitiveData(t,n,r,i){const{iScale:l,vScale:a}=t,o=l.axis,f=a.axis,m=l.getLabels(),_=l===a,w=new Array(i);let M,C,R;for(M=0,C=i;M<C;++M)R=M+r,w[M]={[o]:_||l.parse(m[R],R),[f]:a.parse(n[R],R)};return w}parseArrayData(t,n,r,i){const{xScale:l,yScale:a}=t,o=new Array(i);let f,m,_,w;for(f=0,m=i;f<m;++f)_=f+r,w=n[_],o[f]={x:l.parse(w[0],_),y:a.parse(w[1],_)};return o}parseObjectData(t,n,r,i){const{xScale:l,yScale:a}=t,{xAxisKey:o="x",yAxisKey:f="y"}=this._parsing,m=new Array(i);let _,w,M,C;for(_=0,w=i;_<w;++_)M=_+r,C=n[M],m[_]={x:l.parse(vm(C,o),M),y:a.parse(vm(C,f),M)};return m}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,n,r){const i=this.chart,l=this._cachedMeta,a=n[t.axis],o={keys:NI(i,!0),values:n._stacks[t.axis]._visualValues};return oE(o,a,l.index,{mode:r})}updateRangeFromParsed(t,n,r,i){const l=r[n.axis];let a=l===null?NaN:l;const o=i&&r._stacks[n.axis];i&&o&&(i.values=o,a=oE(i,l,this._cachedMeta.index)),t.min=Math.min(t.min,a),t.max=Math.max(t.max,a)}getMinMax(t,n){const r=this._cachedMeta,i=r._parsed,l=r._sorted&&t===r.iScale,a=i.length,o=this._getOtherScale(t),f=PX(n,r,this.chart),m={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:_,max:w}=wX(o);let M,C;function R(){C=i[M];const z=C[o.axis];return!iu(C[t.axis])||_>z||w<z}for(M=0;M<a&&!(!R()&&(this.updateRangeFromParsed(m,t,C,f),l));++M);if(l){for(M=a-1;M>=0;--M)if(!R()){this.updateRangeFromParsed(m,t,C,f);break}}return m}getAllParsedValues(t){const n=this._cachedMeta._parsed,r=[];let i,l,a;for(i=0,l=n.length;i<l;++i)a=n[i][t.axis],iu(a)&&r.push(a);return r}getMaxOverflow(){return!1}getLabelAndValue(t){const n=this._cachedMeta,r=n.iScale,i=n.vScale,l=this.getParsed(t);return{label:r?""+r.getLabelForValue(l[r.axis]):"",value:i?""+i.getLabelForValue(l[i.axis]):""}}_update(t){const n=this._cachedMeta;this.update(t||"default"),n._clip=_X(Es(this.options.clip,vX(n.xScale,n.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,n=this.chart,r=this._cachedMeta,i=r.data||[],l=n.chartArea,a=[],o=this._drawStart||0,f=this._drawCount||i.length-o,m=this.options.drawActiveElementsOnTop;let _;for(r.dataset&&r.dataset.draw(t,l,o,f),_=o;_<o+f;++_){const w=i[_];w.hidden||(w.active&&m?a.push(w):w.draw(t,l))}for(_=0;_<a.length;++_)a[_].draw(t,l)}getStyle(t,n){const r=n?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(t||0,r)}getContext(t,n,r){const i=this.getDataset();let l;if(t>=0&&t<this._cachedMeta.data.length){const a=this._cachedMeta.data[t];l=a.$context||(a.$context=LX(this.getContext(),t,a)),l.parsed=this.getParsed(t),l.raw=i.data[t],l.index=l.dataIndex=t}else l=this.$context||(this.$context=SX(this.chart.getContext(),this.index)),l.dataset=i,l.index=l.datasetIndex=this.index;return l.active=!!n,l.mode=r,l}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,n){return this._resolveElementOptions(this.dataElementType.id,n,t)}_resolveElementOptions(t,n="default",r){const i=n==="active",l=this._cachedDataOpts,a=t+"-"+n,o=l[a],f=this.enableOptionSharing&&E_(r);if(o)return cE(o,f);const m=this.chart.config,_=m.datasetElementScopeKeys(this._type,t),w=i?[`${t}Hover`,"hover",t,""]:[t,""],M=m.getOptionScopes(this.getDataset(),_),C=Object.keys(su.elements[t]),R=()=>this.getContext(r,i,n),z=m.resolveNamedOptions(M,C,R,w);return z.$shared&&(z.$shared=f,l[a]=Object.freeze(cE(z,f))),z}_resolveAnimations(t,n,r){const i=this.chart,l=this._cachedDataOpts,a=`animation-${n}`,o=l[a];if(o)return o;let f;if(i.options.animation!==!1){const _=this.chart.config,w=_.datasetAnimationScopeKeys(this._type,n),M=_.getOptionScopes(this.getDataset(),w);f=_.createResolver(M,this.getContext(t,r,n))}const m=new BI(i,f&&f.animations);return f&&f._cacheable&&(l[a]=Object.freeze(m)),m}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,n){return!n||a4(t)||this.chart._animationsDisabled}_getSharedOptions(t,n){const r=this.resolveDataElementOptions(t,n),i=this._sharedOptions,l=this.getSharedOptions(r),a=this.includeOptions(n,l)||l!==i;return this.updateSharedOptions(l,n,r),{sharedOptions:l,includeOptions:a}}updateElement(t,n,r,i){a4(i)?Object.assign(t,r):this._resolveAnimations(n,i).update(t,r)}updateSharedOptions(t,n,r){t&&!a4(n)&&this._resolveAnimations(void 0,n).update(t,r)}_setStyle(t,n,r,i){t.active=i;const l=this.getStyle(n,i);this._resolveAnimations(n,r,i).update(t,{options:!i&&this.getSharedOptions(l)||l})}removeHoverStyle(t,n,r){this._setStyle(t,r,"active",!1)}setHoverStyle(t,n,r){this._setStyle(t,r,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const n=this._data,r=this._cachedMeta.data;for(const[o,f,m]of this._syncList)this[o](f,m);this._syncList=[];const i=r.length,l=n.length,a=Math.min(l,i);a&&this.parse(0,a),l>i?this._insertElements(i,l-i,t):l<i&&this._removeElements(l,i-l)}_insertElements(t,n,r=!0){const i=this._cachedMeta,l=i.data,a=t+n;let o;const f=m=>{for(m.length+=n,o=m.length-1;o>=a;o--)m[o]=m[o-n]};for(f(l),o=t;o<a;++o)l[o]=new this.dataElementType;this._parsing&&f(i._parsed),this.parse(t,n),r&&this.updateElements(l,t,n,"reset")}updateElements(t,n,r,i){}_removeElements(t,n){const r=this._cachedMeta;if(this._parsing){const i=r._parsed.splice(t,n);r._stacked&&fv(r,i)}r.data.splice(t,n)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[n,r,i]=t;this[n](r,i)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,n){n&&this._sync(["_removeElements",t,n]);const r=arguments.length-2;r&&this._sync(["_insertElements",t,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}un(sf,"defaults",{}),un(sf,"datasetElementType",null),un(sf,"dataElementType",null);function EX(e,t){if(!e._cache.$bar){const n=e.getMatchingVisibleMetas(t);let r=[];for(let i=0,l=n.length;i<l;i++)r=r.concat(n[i].controller.getAllParsedValues(e));e._cache.$bar=yI(r.sort((i,l)=>i-l))}return e._cache.$bar}function MX(e){const t=e.iScale,n=EX(t,e.type);let r=t._length,i,l,a,o;const f=()=>{a===32767||a===-32768||(E_(o)&&(r=Math.min(r,Math.abs(a-o)||r)),o=a)};for(i=0,l=n.length;i<l;++i)a=t.getPixelForValue(n[i]),f();for(o=void 0,i=0,l=t.ticks.length;i<l;++i)a=t.getPixelForTick(i),f();return r}function TX(e,t,n,r){const i=n.barThickness;let l,a;return go(i)?(l=t.min*n.categoryPercentage,a=n.barPercentage):(l=i*r,a=1),{chunk:l/r,ratio:a,start:t.pixels[e]-l/2}}function AX(e,t,n,r){const i=t.pixels,l=i[e];let a=e>0?i[e-1]:null,o=e<i.length-1?i[e+1]:null;const f=n.categoryPercentage;a===null&&(a=l-(o===null?t.end-t.start:o-l)),o===null&&(o=l+l-a);const m=l-(l-Math.min(a,o))/2*f;return{chunk:Math.abs(o-a)/2*f/r,ratio:n.barPercentage,start:m}}function kX(e,t,n,r){const i=n.parse(e[0],r),l=n.parse(e[1],r),a=Math.min(i,l),o=Math.max(i,l);let f=a,m=o;Math.abs(a)>Math.abs(o)&&(f=o,m=a),t[n.axis]=m,t._custom={barStart:f,barEnd:m,start:i,end:l,min:a,max:o}}function FI(e,t,n,r){return pl(e)?kX(e,t,n,r):t[n.axis]=n.parse(e,r),t}function hE(e,t,n,r){const i=e.iScale,l=e.vScale,a=i.getLabels(),o=i===l,f=[];let m,_,w,M;for(m=n,_=n+r;m<_;++m)M=t[m],w={},w[i.axis]=o||i.parse(a[m],m),f.push(FI(M,w,l,m));return f}function l4(e){return e&&e.barStart!==void 0&&e.barEnd!==void 0}function IX(e,t,n){return e!==0?Nf(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}function DX(e){let t,n,r,i,l;return e.horizontal?(t=e.base>e.x,n="left",r="right"):(t=e.base<e.y,n="bottom",r="top"),t?(i="end",l="start"):(i="start",l="end"),{start:n,end:r,reverse:t,top:i,bottom:l}}function OX(e,t,n,r){let i=t.borderSkipped;const l={};if(!i){e.borderSkipped=l;return}if(i===!0){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:a,end:o,reverse:f,top:m,bottom:_}=DX(e);i==="middle"&&n&&(e.enableBorderRadius=!0,(n._top||0)===r?i=m:(n._bottom||0)===r?i=_:(l[dE(_,a,o,f)]=!0,i=m)),l[dE(i,a,o,f)]=!0,e.borderSkipped=l}function dE(e,t,n,r){return r?(e=RX(e,t,n),e=fE(e,n,t)):e=fE(e,t,n),e}function RX(e,t,n){return e===t?n:e===n?t:e}function fE(e,t,n){return e==="start"?t:e==="end"?n:e}function BX(e,{inflateAmount:t},n){e.inflateAmount=t==="auto"?n===1?.33:0:t}class px extends sf{parsePrimitiveData(t,n,r,i){return hE(t,n,r,i)}parseArrayData(t,n,r,i){return hE(t,n,r,i)}parseObjectData(t,n,r,i){const{iScale:l,vScale:a}=t,{xAxisKey:o="x",yAxisKey:f="y"}=this._parsing,m=l.axis==="x"?o:f,_=a.axis==="x"?o:f,w=[];let M,C,R,z;for(M=r,C=r+i;M<C;++M)z=n[M],R={},R[l.axis]=l.parse(vm(z,m),M),w.push(FI(vm(z,_),R,a,M));return w}updateRangeFromParsed(t,n,r,i){super.updateRangeFromParsed(t,n,r,i);const l=r._custom;l&&n===this._cachedMeta.vScale&&(t.min=Math.min(t.min,l.min),t.max=Math.max(t.max,l.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const n=this._cachedMeta,{iScale:r,vScale:i}=n,l=this.getParsed(t),a=l._custom,o=l4(a)?"["+a.start+", "+a.end+"]":""+i.getLabelForValue(l[i.axis]);return{label:""+r.getLabelForValue(l[r.axis]),value:o}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,t)}updateElements(t,n,r,i){const l=i==="reset",{index:a,_cachedMeta:{vScale:o}}=this,f=o.getBasePixel(),m=o.isHorizontal(),_=this._getRuler(),{sharedOptions:w,includeOptions:M}=this._getSharedOptions(n,i);for(let C=n;C<n+r;C++){const R=this.getParsed(C),z=l||go(R[o.axis])?{base:f,head:f}:this._calculateBarValuePixels(C),W=this._calculateBarIndexPixels(C,_),X=(R._stacks||{})[o.axis],Y={horizontal:m,base:z.base,enableBorderRadius:!X||l4(R._custom)||a===X._top||a===X._bottom,x:m?z.head:W.center,y:m?W.center:z.head,height:m?W.size:Math.abs(z.size),width:m?Math.abs(z.size):W.size};M&&(Y.options=w||this.resolveDataElementOptions(C,t[C].active?"active":i));const Q=Y.options||t[C].options;OX(Y,Q,X,a),BX(Y,Q,_.ratio),this.updateElement(t[C],C,Y,i)}}_getStacks(t,n){const{iScale:r}=this._cachedMeta,i=r.getMatchingVisibleMetas(this._type).filter(f=>f.controller.options.grouped),l=r.options.stacked,a=[],o=f=>{const m=f.controller.getParsed(n),_=m&&m[f.vScale.axis];if(go(_)||isNaN(_))return!0};for(const f of i)if(!(n!==void 0&&o(f))&&((l===!1||a.indexOf(f.stack)===-1||l===void 0&&f.stack===void 0)&&a.push(f.stack),f.index===t))break;return a.length||a.push(void 0),a}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,n,r){const i=this._getStacks(t,r),l=n!==void 0?i.indexOf(n):-1;return l===-1?i.length-1:l}_getRuler(){const t=this.options,n=this._cachedMeta,r=n.iScale,i=[];let l,a;for(l=0,a=n.data.length;l<a;++l)i.push(r.getPixelForValue(this.getParsed(l)[r.axis],l));const o=t.barThickness;return{min:o||MX(n),pixels:i,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:t.grouped,ratio:o?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:n,_stacked:r,index:i},options:{base:l,minBarLength:a}}=this,o=l||0,f=this.getParsed(t),m=f._custom,_=l4(m);let w=f[n.axis],M=0,C=r?this.applyStack(n,f,r):w,R,z;C!==w&&(M=C-w,C=w),_&&(w=m.barStart,C=m.barEnd-m.barStart,w!==0&&Nf(w)!==Nf(m.barEnd)&&(M=0),M+=w);const W=!go(l)&&!_?l:M;let X=n.getPixelForValue(W);if(this.chart.getDataVisibility(t)?R=n.getPixelForValue(M+C):R=X,z=R-X,Math.abs(z)<a){z=IX(z,n,o)*a,w===o&&(X-=z/2);const Y=n.getPixelForDecimal(0),Q=n.getPixelForDecimal(1),oe=Math.min(Y,Q),le=Math.max(Y,Q);X=Math.max(Math.min(X,le),oe),R=X+z,r&&!_&&(f._stacks[n.axis]._visualValues[i]=n.getValueForPixel(R)-n.getValueForPixel(X))}if(X===n.getPixelForValue(o)){const Y=Nf(z)*n.getLineWidthForValue(o)/2;X+=Y,z-=Y}return{size:z,base:X,head:R,center:R+z/2}}_calculateBarIndexPixels(t,n){const r=n.scale,i=this.options,l=i.skipNull,a=Es(i.maxBarThickness,1/0);let o,f;if(n.grouped){const m=l?this._getStackCount(t):n.stackCount,_=i.barThickness==="flex"?AX(t,n,i,m):TX(t,n,i,m),w=this._getStackIndex(this.index,this._cachedMeta.stack,l?t:void 0);o=_.start+_.chunk*w+_.chunk/2,f=Math.min(a,_.chunk*_.ratio)}else o=r.getPixelForValue(this.getParsed(t)[r.axis],t),f=Math.min(a,n.min*n.ratio);return{base:o-f/2,head:o+f/2,center:o,size:f}}draw(){const t=this._cachedMeta,n=t.vScale,r=t.data,i=r.length;let l=0;for(;l<i;++l)this.getParsed(l)[n.axis]!==null&&r[l].draw(this._ctx)}}un(px,"id","bar"),un(px,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),un(px,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class mx extends sf{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,n,r,i){const l=super.parsePrimitiveData(t,n,r,i);for(let a=0;a<l.length;a++)l[a]._custom=this.resolveDataElementOptions(a+r).radius;return l}parseArrayData(t,n,r,i){const l=super.parseArrayData(t,n,r,i);for(let a=0;a<l.length;a++){const o=n[r+a];l[a]._custom=Es(o[2],this.resolveDataElementOptions(a+r).radius)}return l}parseObjectData(t,n,r,i){const l=super.parseObjectData(t,n,r,i);for(let a=0;a<l.length;a++){const o=n[r+a];l[a]._custom=Es(o&&o.r&&+o.r,this.resolveDataElementOptions(a+r).radius)}return l}getMaxOverflow(){const t=this._cachedMeta.data;let n=0;for(let r=t.length-1;r>=0;--r)n=Math.max(n,t[r].size(this.resolveDataElementOptions(r))/2);return n>0&&n}getLabelAndValue(t){const n=this._cachedMeta,r=this.chart.data.labels||[],{xScale:i,yScale:l}=n,a=this.getParsed(t),o=i.getLabelForValue(a.x),f=l.getLabelForValue(a.y),m=a._custom;return{label:r[t]||"",value:"("+o+", "+f+(m?", "+m:"")+")"}}update(t){const n=this._cachedMeta.data;this.updateElements(n,0,n.length,t)}updateElements(t,n,r,i){const l=i==="reset",{iScale:a,vScale:o}=this._cachedMeta,{sharedOptions:f,includeOptions:m}=this._getSharedOptions(n,i),_=a.axis,w=o.axis;for(let M=n;M<n+r;M++){const C=t[M],R=!l&&this.getParsed(M),z={},W=z[_]=l?a.getPixelForDecimal(.5):a.getPixelForValue(R[_]),X=z[w]=l?o.getBasePixel():o.getPixelForValue(R[w]);z.skip=isNaN(W)||isNaN(X),m&&(z.options=f||this.resolveDataElementOptions(M,C.active?"active":i),l&&(z.options.radius=0)),this.updateElement(C,M,z,i)}}resolveDataElementOptions(t,n){const r=this.getParsed(t);let i=super.resolveDataElementOptions(t,n);i.$shared&&(i=Object.assign({},i,{$shared:!1}));const l=i.radius;return n!=="active"&&(i.radius=0),i.radius+=Es(r&&r._custom,l),i}}un(mx,"id","bubble"),un(mx,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),un(mx,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function NX(e,t,n){let r=1,i=1,l=0,a=0;if(t<Ya){const o=e,f=o+t,m=Math.cos(o),_=Math.sin(o),w=Math.cos(f),M=Math.sin(f),C=(Q,oe,le)=>M_(Q,o,f,!0)?1:Math.max(oe,oe*n,le,le*n),R=(Q,oe,le)=>M_(Q,o,f,!0)?-1:Math.min(oe,oe*n,le,le*n),z=C(0,m,w),W=C(Lu,_,M),X=R(Xa,m,w),Y=R(Xa+Lu,_,M);r=(z-X)/2,i=(W-Y)/2,l=-(z+X)/2,a=-(W+Y)/2}return{ratioX:r,ratioY:i,offsetX:l,offsetY:a}}class hg extends sf{constructor(t,n){super(t,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,n){const r=this.getDataset().data,i=this._cachedMeta;if(this._parsing===!1)i._parsed=r;else{let l=f=>+r[f];if(qs(r[t])){const{key:f="value"}=this._parsing;l=m=>+vm(r[m],f)}let a,o;for(a=t,o=t+n;a<o;++a)i._parsed[a]=l(a)}}_getRotation(){return nf(this.options.rotation-90)}_getCircumference(){return nf(this.options.circumference)}_getRotationExtents(){let t=Ya,n=-Ya;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){const i=this.chart.getDatasetMeta(r).controller,l=i._getRotation(),a=i._getCircumference();t=Math.min(t,l),n=Math.max(n,l+a)}return{rotation:t,circumference:n-t}}update(t){const n=this.chart,{chartArea:r}=n,i=this._cachedMeta,l=i.data,a=this.getMaxBorderWidth()+this.getMaxOffset(l)+this.options.spacing,o=Math.max((Math.min(r.width,r.height)-a)/2,0),f=Math.min(XK(this.options.cutout,o),1),m=this._getRingWeight(this.index),{circumference:_,rotation:w}=this._getRotationExtents(),{ratioX:M,ratioY:C,offsetX:R,offsetY:z}=NX(w,_,f),W=(r.width-a)/M,X=(r.height-a)/C,Y=Math.max(Math.min(W,X)/2,0),Q=dI(this.options.radius,Y),oe=Math.max(Q*f,0),le=(Q-oe)/this._getVisibleDatasetWeightTotal();this.offsetX=R*Q,this.offsetY=z*Q,i.total=this.calculateTotal(),this.outerRadius=Q-le*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-le*m,0),this.updateElements(l,0,l.length,t)}_circumference(t,n){const r=this.options,i=this._cachedMeta,l=this._getCircumference();return n&&r.animation.animateRotate||!this.chart.getDataVisibility(t)||i._parsed[t]===null||i.data[t].hidden?0:this.calculateCircumference(i._parsed[t]*l/Ya)}updateElements(t,n,r,i){const l=i==="reset",a=this.chart,o=a.chartArea,m=a.options.animation,_=(o.left+o.right)/2,w=(o.top+o.bottom)/2,M=l&&m.animateScale,C=M?0:this.innerRadius,R=M?0:this.outerRadius,{sharedOptions:z,includeOptions:W}=this._getSharedOptions(n,i);let X=this._getRotation(),Y;for(Y=0;Y<n;++Y)X+=this._circumference(Y,l);for(Y=n;Y<n+r;++Y){const Q=this._circumference(Y,l),oe=t[Y],le={x:_+this.offsetX,y:w+this.offsetY,startAngle:X,endAngle:X+Q,circumference:Q,outerRadius:R,innerRadius:C};W&&(le.options=z||this.resolveDataElementOptions(Y,oe.active?"active":i)),X+=Q,this.updateElement(oe,Y,le,i)}}calculateTotal(){const t=this._cachedMeta,n=t.data;let r=0,i;for(i=0;i<n.length;i++){const l=t._parsed[i];l!==null&&!isNaN(l)&&this.chart.getDataVisibility(i)&&!n[i].hidden&&(r+=Math.abs(l))}return r}calculateCircumference(t){const n=this._cachedMeta.total;return n>0&&!isNaN(t)?Ya*(Math.abs(t)/n):0}getLabelAndValue(t){const n=this._cachedMeta,r=this.chart,i=r.data.labels||[],l=$_(n._parsed[t],r.options.locale);return{label:i[t]||"",value:l}}getMaxBorderWidth(t){let n=0;const r=this.chart;let i,l,a,o,f;if(!t){for(i=0,l=r.data.datasets.length;i<l;++i)if(r.isDatasetVisible(i)){a=r.getDatasetMeta(i),t=a.data,o=a.controller;break}}if(!t)return 0;for(i=0,l=t.length;i<l;++i)f=o.resolveDataElementOptions(i),f.borderAlign!=="inner"&&(n=Math.max(n,f.borderWidth||0,f.hoverBorderWidth||0));return n}getMaxOffset(t){let n=0;for(let r=0,i=t.length;r<i;++r){const l=this.resolveDataElementOptions(r);n=Math.max(n,l.offset||0,l.hoverOffset||0)}return n}_getRingWeightOffset(t){let n=0;for(let r=0;r<t;++r)this.chart.isDatasetVisible(r)&&(n+=this._getRingWeight(r));return n}_getRingWeight(t){return Math.max(Es(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}un(hg,"id","doughnut"),un(hg,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),un(hg,"descriptors",{_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")}),un(hg,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const n=t.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:r,color:i}}=t.legend.options;return n.labels.map((l,a)=>{const f=t.getDatasetMeta(0).controller.getStyle(a);return{text:l,fillStyle:f.backgroundColor,strokeStyle:f.borderColor,fontColor:i,lineWidth:f.borderWidth,pointStyle:r,hidden:!t.getDataVisibility(a),index:a}})}return[]}},onClick(t,n,r){r.chart.toggleDataVisibility(n.index),r.chart.update()}}}});class gx extends sf{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const n=this._cachedMeta,{dataset:r,data:i=[],_dataset:l}=n,a=this.chart._animationsDisabled;let{start:o,count:f}=bI(n,i,a);this._drawStart=o,this._drawCount=f,xI(n)&&(o=0,f=i.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!l._decimated,r.points=i;const m=this.resolveDatasetElementOptions(t);this.options.showLine||(m.borderWidth=0),m.segment=this.options.segment,this.updateElement(r,void 0,{animated:!a,options:m},t),this.updateElements(i,o,f,t)}updateElements(t,n,r,i){const l=i==="reset",{iScale:a,vScale:o,_stacked:f,_dataset:m}=this._cachedMeta,{sharedOptions:_,includeOptions:w}=this._getSharedOptions(n,i),M=a.axis,C=o.axis,{spanGaps:R,segment:z}=this.options,W=W0(R)?R:Number.POSITIVE_INFINITY,X=this.chart._animationsDisabled||l||i==="none",Y=n+r,Q=t.length;let oe=n>0&&this.getParsed(n-1);for(let le=0;le<Q;++le){const me=t[le],we=X?me:{};if(le<n||le>=Y){we.skip=!0;continue}const ue=this.getParsed(le),_e=go(ue[C]),We=we[M]=a.getPixelForValue(ue[M],le),he=we[C]=l||_e?o.getBasePixel():o.getPixelForValue(f?this.applyStack(o,ue,f):ue[C],le);we.skip=isNaN(We)||isNaN(he)||_e,we.stop=le>0&&Math.abs(ue[M]-oe[M])>W,z&&(we.parsed=ue,we.raw=m.data[le]),w&&(we.options=_||this.resolveDataElementOptions(le,me.active?"active":i)),X||this.updateElement(me,le,we,i),oe=ue}}getMaxOverflow(){const t=this._cachedMeta,n=t.dataset,r=n.options&&n.options.borderWidth||0,i=t.data||[];if(!i.length)return r;const l=i[0].size(this.resolveDataElementOptions(0)),a=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(r,l,a)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}un(gx,"id","line"),un(gx,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),un(gx,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class s_ extends sf{constructor(t,n){super(t,n),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const n=this._cachedMeta,r=this.chart,i=r.data.labels||[],l=$_(n._parsed[t].r,r.options.locale);return{label:i[t]||"",value:l}}parseObjectData(t,n,r,i){return TI.bind(this)(t,n,r,i)}update(t){const n=this._cachedMeta.data;this._updateRadius(),this.updateElements(n,0,n.length,t)}getMinMax(){const t=this._cachedMeta,n={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((r,i)=>{const l=this.getParsed(i).r;!isNaN(l)&&this.chart.getDataVisibility(i)&&(l<n.min&&(n.min=l),l>n.max&&(n.max=l))}),n}_updateRadius(){const t=this.chart,n=t.chartArea,r=t.options,i=Math.min(n.right-n.left,n.bottom-n.top),l=Math.max(i/2,0),a=Math.max(r.cutoutPercentage?l/100*r.cutoutPercentage:1,0),o=(l-a)/t.getVisibleDatasetCount();this.outerRadius=l-o*this.index,this.innerRadius=this.outerRadius-o}updateElements(t,n,r,i){const l=i==="reset",a=this.chart,f=a.options.animation,m=this._cachedMeta.rScale,_=m.xCenter,w=m.yCenter,M=m.getIndexAngle(0)-.5*Xa;let C=M,R;const z=360/this.countVisibleElements();for(R=0;R<n;++R)C+=this._computeAngle(R,i,z);for(R=n;R<n+r;R++){const W=t[R];let X=C,Y=C+this._computeAngle(R,i,z),Q=a.getDataVisibility(R)?m.getDistanceFromCenterForValue(this.getParsed(R).r):0;C=Y,l&&(f.animateScale&&(Q=0),f.animateRotate&&(X=Y=M));const oe={x:_,y:w,innerRadius:0,outerRadius:Q,startAngle:X,endAngle:Y,options:this.resolveDataElementOptions(R,W.active?"active":i)};this.updateElement(W,R,oe,i)}}countVisibleElements(){const t=this._cachedMeta;let n=0;return t.data.forEach((r,i)=>{!isNaN(this.getParsed(i).r)&&this.chart.getDataVisibility(i)&&n++}),n}_computeAngle(t,n,r){return this.chart.getDataVisibility(t)?nf(this.resolveDataElementOptions(t,n).angle||r):0}}un(s_,"id","polarArea"),un(s_,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),un(s_,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const n=t.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:r,color:i}}=t.legend.options;return n.labels.map((l,a)=>{const f=t.getDatasetMeta(0).controller.getStyle(a);return{text:l,fillStyle:f.backgroundColor,strokeStyle:f.borderColor,fontColor:i,lineWidth:f.borderWidth,pointStyle:r,hidden:!t.getDataVisibility(a),index:a}})}return[]}},onClick(t,n,r){r.chart.toggleDataVisibility(n.index),r.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class b3 extends hg{}un(b3,"id","pie"),un(b3,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class yx extends sf{getLabelAndValue(t){const n=this._cachedMeta.vScale,r=this.getParsed(t);return{label:n.getLabels()[t],value:""+n.getLabelForValue(r[n.axis])}}parseObjectData(t,n,r,i){return TI.bind(this)(t,n,r,i)}update(t){const n=this._cachedMeta,r=n.dataset,i=n.data||[],l=n.iScale.getLabels();if(r.points=i,t!=="resize"){const a=this.resolveDatasetElementOptions(t);this.options.showLine||(a.borderWidth=0);const o={_loop:!0,_fullLoop:l.length===i.length,options:a};this.updateElement(r,void 0,o,t)}this.updateElements(i,0,i.length,t)}updateElements(t,n,r,i){const l=this._cachedMeta.rScale,a=i==="reset";for(let o=n;o<n+r;o++){const f=t[o],m=this.resolveDataElementOptions(o,f.active?"active":i),_=l.getPointPositionForValue(o,this.getParsed(o).r),w=a?l.xCenter:_.x,M=a?l.yCenter:_.y,C={x:w,y:M,angle:_.angle,skip:isNaN(w)||isNaN(M),options:m};this.updateElement(f,o,C,i)}}}un(yx,"id","radar"),un(yx,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),un(yx,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class vx extends sf{getLabelAndValue(t){const n=this._cachedMeta,r=this.chart.data.labels||[],{xScale:i,yScale:l}=n,a=this.getParsed(t),o=i.getLabelForValue(a.x),f=l.getLabelForValue(a.y);return{label:r[t]||"",value:"("+o+", "+f+")"}}update(t){const n=this._cachedMeta,{data:r=[]}=n,i=this.chart._animationsDisabled;let{start:l,count:a}=bI(n,r,i);if(this._drawStart=l,this._drawCount=a,xI(n)&&(l=0,a=r.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:o,_dataset:f}=n;o._chart=this.chart,o._datasetIndex=this.index,o._decimated=!!f._decimated,o.points=r;const m=this.resolveDatasetElementOptions(t);m.segment=this.options.segment,this.updateElement(o,void 0,{animated:!i,options:m},t)}else this.datasetElementType&&(delete n.dataset,this.datasetElementType=!1);this.updateElements(r,l,a,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,n,r,i){const l=i==="reset",{iScale:a,vScale:o,_stacked:f,_dataset:m}=this._cachedMeta,_=this.resolveDataElementOptions(n,i),w=this.getSharedOptions(_),M=this.includeOptions(i,w),C=a.axis,R=o.axis,{spanGaps:z,segment:W}=this.options,X=W0(z)?z:Number.POSITIVE_INFINITY,Y=this.chart._animationsDisabled||l||i==="none";let Q=n>0&&this.getParsed(n-1);for(let oe=n;oe<n+r;++oe){const le=t[oe],me=this.getParsed(oe),we=Y?le:{},ue=go(me[R]),_e=we[C]=a.getPixelForValue(me[C],oe),We=we[R]=l||ue?o.getBasePixel():o.getPixelForValue(f?this.applyStack(o,me,f):me[R],oe);we.skip=isNaN(_e)||isNaN(We)||ue,we.stop=oe>0&&Math.abs(me[C]-Q[C])>X,W&&(we.parsed=me,we.raw=m.data[oe]),M&&(we.options=w||this.resolveDataElementOptions(oe,le.active?"active":i)),Y||this.updateElement(le,oe,we,i),Q=me}this.updateSharedOptions(w,i,_)}getMaxOverflow(){const t=this._cachedMeta,n=t.data||[];if(!this.options.showLine){let o=0;for(let f=n.length-1;f>=0;--f)o=Math.max(o,n[f].size(this.resolveDataElementOptions(f))/2);return o>0&&o}const r=t.dataset,i=r.options&&r.options.borderWidth||0;if(!n.length)return i;const l=n[0].size(this.resolveDataElementOptions(0)),a=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(i,l,a)/2}}un(vx,"id","scatter"),un(vx,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),un(vx,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var FX=Object.freeze({__proto__:null,BarController:px,BubbleController:mx,DoughnutController:hg,LineController:gx,PieController:b3,PolarAreaController:s_,RadarController:yx,ScatterController:vx});function tg(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class JC{constructor(t){un(this,"options");this.options=t||{}}static override(t){Object.assign(JC.prototype,t)}init(){}formats(){return tg()}parse(){return tg()}format(){return tg()}add(){return tg()}diff(){return tg()}startOf(){return tg()}endOf(){return tg()}}var zI={_date:JC};function zX(e,t,n,r){const{controller:i,data:l,_sorted:a}=e,o=i._cachedMeta.iScale;if(o&&t===o.axis&&t!=="r"&&a&&l.length){const f=o._reversePixels?uY:mp;if(r){if(i._sharedOptions){const m=l[0],_=typeof m.getRange=="function"&&m.getRange(t);if(_){const w=f(l,t,n-_),M=f(l,t,n+_);return{lo:w.lo,hi:M.hi}}}}else return f(l,t,n)}return{lo:0,hi:l.length-1}}function K2(e,t,n,r,i){const l=e.getSortedVisibleDatasetMetas(),a=n[t];for(let o=0,f=l.length;o<f;++o){const{index:m,data:_}=l[o],{lo:w,hi:M}=zX(l[o],t,a,i);for(let C=w;C<=M;++C){const R=_[C];R.skip||r(R,m,C)}}}function jX(e){const t=e.indexOf("x")!==-1,n=e.indexOf("y")!==-1;return function(r,i){const l=t?Math.abs(r.x-i.x):0,a=n?Math.abs(r.y-i.y):0;return Math.sqrt(Math.pow(l,2)+Math.pow(a,2))}}function u4(e,t,n,r,i){const l=[];return!i&&!e.isPointInArea(t)||K2(e,n,t,function(o,f,m){!i&&!gp(o,e.chartArea,0)||o.inRange(t.x,t.y,r)&&l.push({element:o,datasetIndex:f,index:m})},!0),l}function UX(e,t,n,r){let i=[];function l(a,o,f){const{startAngle:m,endAngle:_}=a.getProps(["startAngle","endAngle"],r),{angle:w}=mI(a,{x:t.x,y:t.y});M_(w,m,_)&&i.push({element:a,datasetIndex:o,index:f})}return K2(e,n,t,l),i}function VX(e,t,n,r,i,l){let a=[];const o=jX(n);let f=Number.POSITIVE_INFINITY;function m(_,w,M){const C=_.inRange(t.x,t.y,i);if(r&&!C)return;const R=_.getCenterPoint(i);if(!(!!l||e.isPointInArea(R))&&!C)return;const W=o(t,R);W<f?(a=[{element:_,datasetIndex:w,index:M}],f=W):W===f&&a.push({element:_,datasetIndex:w,index:M})}return K2(e,n,t,m),a}function c4(e,t,n,r,i,l){return!l&&!e.isPointInArea(t)?[]:n==="r"&&!r?UX(e,t,n,i):VX(e,t,n,r,i,l)}function pE(e,t,n,r,i){const l=[],a=n==="x"?"inXRange":"inYRange";let o=!1;return K2(e,n,t,(f,m,_)=>{f[a](t[n],i)&&(l.push({element:f,datasetIndex:m,index:_}),o=o||f.inRange(t.x,t.y,i))}),r&&!o?[]:l}var $X={modes:{index(e,t,n,r){const i=sg(t,e),l=n.axis||"x",a=n.includeInvisible||!1,o=n.intersect?u4(e,i,l,r,a):c4(e,i,l,!1,r,a),f=[];return o.length?(e.getSortedVisibleDatasetMetas().forEach(m=>{const _=o[0].index,w=m.data[_];w&&!w.skip&&f.push({element:w,datasetIndex:m.index,index:_})}),f):[]},dataset(e,t,n,r){const i=sg(t,e),l=n.axis||"xy",a=n.includeInvisible||!1;let o=n.intersect?u4(e,i,l,r,a):c4(e,i,l,!1,r,a);if(o.length>0){const f=o[0].datasetIndex,m=e.getDatasetMeta(f).data;o=[];for(let _=0;_<m.length;++_)o.push({element:m[_],datasetIndex:f,index:_})}return o},point(e,t,n,r){const i=sg(t,e),l=n.axis||"xy",a=n.includeInvisible||!1;return u4(e,i,l,r,a)},nearest(e,t,n,r){const i=sg(t,e),l=n.axis||"xy",a=n.includeInvisible||!1;return c4(e,i,l,n.intersect,r,a)},x(e,t,n,r){const i=sg(t,e);return pE(e,i,"x",n.intersect,r)},y(e,t,n,r){const i=sg(t,e);return pE(e,i,"y",n.intersect,r)}}};const jI=["left","top","right","bottom"];function pv(e,t){return e.filter(n=>n.pos===t)}function mE(e,t){return e.filter(n=>jI.indexOf(n.pos)===-1&&n.box.axis===t)}function mv(e,t){return e.sort((n,r)=>{const i=t?r:n,l=t?n:r;return i.weight===l.weight?i.index-l.index:i.weight-l.weight})}function GX(e){const t=[];let n,r,i,l,a,o;for(n=0,r=(e||[]).length;n<r;++n)i=e[n],{position:l,options:{stack:a,stackWeight:o=1}}=i,t.push({index:n,box:i,pos:l,horizontal:i.isHorizontal(),weight:i.weight,stack:a&&l+a,stackWeight:o});return t}function HX(e){const t={};for(const n of e){const{stack:r,pos:i,stackWeight:l}=n;if(!r||!jI.includes(i))continue;const a=t[r]||(t[r]={count:0,placed:0,weight:0,size:0});a.count++,a.weight+=l}return t}function qX(e,t){const n=HX(e),{vBoxMaxWidth:r,hBoxMaxHeight:i}=t;let l,a,o;for(l=0,a=e.length;l<a;++l){o=e[l];const{fullSize:f}=o.box,m=n[o.stack],_=m&&o.stackWeight/m.weight;o.horizontal?(o.width=_?_*r:f&&t.availableWidth,o.height=i):(o.width=r,o.height=_?_*i:f&&t.availableHeight)}return n}function WX(e){const t=GX(e),n=mv(t.filter(m=>m.box.fullSize),!0),r=mv(pv(t,"left"),!0),i=mv(pv(t,"right")),l=mv(pv(t,"top"),!0),a=mv(pv(t,"bottom")),o=mE(t,"x"),f=mE(t,"y");return{fullSize:n,leftAndTop:r.concat(l),rightAndBottom:i.concat(f).concat(a).concat(o),chartArea:pv(t,"chartArea"),vertical:r.concat(i).concat(f),horizontal:l.concat(a).concat(o)}}function gE(e,t,n,r){return Math.max(e[n],t[n])+Math.max(e[r],t[r])}function UI(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function ZX(e,t,n,r){const{pos:i,box:l}=n,a=e.maxPadding;if(!qs(i)){n.size&&(e[i]-=n.size);const w=r[n.stack]||{size:0,count:1};w.size=Math.max(w.size,n.horizontal?l.height:l.width),n.size=w.size/w.count,e[i]+=n.size}l.getPadding&&UI(a,l.getPadding());const o=Math.max(0,t.outerWidth-gE(a,e,"left","right")),f=Math.max(0,t.outerHeight-gE(a,e,"top","bottom")),m=o!==e.w,_=f!==e.h;return e.w=o,e.h=f,n.horizontal?{same:m,other:_}:{same:_,other:m}}function KX(e){const t=e.maxPadding;function n(r){const i=Math.max(t[r]-e[r],0);return e[r]+=i,i}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}function YX(e,t){const n=t.maxPadding;function r(i){const l={left:0,top:0,right:0,bottom:0};return i.forEach(a=>{l[a]=Math.max(t[a],n[a])}),l}return r(e?["left","right"]:["top","bottom"])}function Iv(e,t,n,r){const i=[];let l,a,o,f,m,_;for(l=0,a=e.length,m=0;l<a;++l){o=e[l],f=o.box,f.update(o.width||t.w,o.height||t.h,YX(o.horizontal,t));const{same:w,other:M}=ZX(t,n,o,r);m|=w&&i.length,_=_||M,f.fullSize||i.push(o)}return m&&Iv(i,t,n,r)||_}function Nb(e,t,n,r,i){e.top=n,e.left=t,e.right=t+r,e.bottom=n+i,e.width=r,e.height=i}function yE(e,t,n,r){const i=n.padding;let{x:l,y:a}=t;for(const o of e){const f=o.box,m=r[o.stack]||{placed:0,weight:1},_=o.stackWeight/m.weight||1;if(o.horizontal){const w=t.w*_,M=m.size||f.height;E_(m.start)&&(a=m.start),f.fullSize?Nb(f,i.left,a,n.outerWidth-i.right-i.left,M):Nb(f,t.left+m.placed,a,w,M),m.start=a,m.placed+=w,a=f.bottom}else{const w=t.h*_,M=m.size||f.width;E_(m.start)&&(l=m.start),f.fullSize?Nb(f,l,i.top,M,n.outerHeight-i.bottom-i.top):Nb(f,l,t.top+m.placed,M,w),m.start=l,m.placed+=w,l=f.right}}t.x=l,t.y=a}var ih={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(n){t.draw(n)}}]},e.boxes.push(t)},removeBox(e,t){const n=e.boxes?e.boxes.indexOf(t):-1;n!==-1&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,r){if(!e)return;const i=oh(e.options.layout.padding),l=Math.max(t-i.width,0),a=Math.max(n-i.height,0),o=WX(e.boxes),f=o.vertical,m=o.horizontal;Yo(e.boxes,z=>{typeof z.beforeLayout=="function"&&z.beforeLayout()});const _=f.reduce((z,W)=>W.box.options&&W.box.options.display===!1?z:z+1,0)||1,w=Object.freeze({outerWidth:t,outerHeight:n,padding:i,availableWidth:l,availableHeight:a,vBoxMaxWidth:l/2/_,hBoxMaxHeight:a/2}),M=Object.assign({},i);UI(M,oh(r));const C=Object.assign({maxPadding:M,w:l,h:a,x:i.left,y:i.top},i),R=qX(f.concat(m),w);Iv(o.fullSize,C,w,R),Iv(f,C,w,R),Iv(m,C,w,R)&&Iv(f,C,w,R),KX(C),yE(o.leftAndTop,C,w,R),C.x+=C.w,C.y+=C.h,yE(o.rightAndBottom,C,w,R),e.chartArea={left:C.left,top:C.top,right:C.left+C.w,bottom:C.top+C.h,height:C.h,width:C.w},Yo(o.chartArea,z=>{const W=z.box;Object.assign(W,e.chartArea),W.update(C.w,C.h,{left:0,top:0,right:0,bottom:0})})}};class VI{acquireContext(t,n){}releaseContext(t){return!1}addEventListener(t,n,r){}removeEventListener(t,n,r){}getDevicePixelRatio(){return 1}getMaximumSize(t,n,r,i){return n=Math.max(0,n||t.width),r=r||t.height,{width:n,height:Math.max(0,i?Math.floor(n/i):r)}}isAttached(t){return!0}updateConfig(t){}}class XX extends VI{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const _x="$chartjs",JX={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},vE=e=>e===null||e==="";function QX(e,t){const n=e.style,r=e.getAttribute("height"),i=e.getAttribute("width");if(e[_x]={initial:{height:r,width:i,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",vE(i)){const l=eE(e,"width");l!==void 0&&(e.width=l)}if(vE(r))if(e.style.height==="")e.height=e.width/(t||2);else{const l=eE(e,"height");l!==void 0&&(e.height=l)}return e}const $I=nX?{passive:!0}:!1;function eJ(e,t,n){e.addEventListener(t,n,$I)}function tJ(e,t,n){e.canvas.removeEventListener(t,n,$I)}function nJ(e,t){const n=JX[e.type]||e.type,{x:r,y:i}=sg(e,t);return{type:n,chart:t,native:e,x:r!==void 0?r:null,y:i!==void 0?i:null}}function i2(e,t){for(const n of e)if(n===t||n.contains(t))return!0}function rJ(e,t,n){const r=e.canvas,i=new MutationObserver(l=>{let a=!1;for(const o of l)a=a||i2(o.addedNodes,r),a=a&&!i2(o.removedNodes,r);a&&n()});return i.observe(document,{childList:!0,subtree:!0}),i}function iJ(e,t,n){const r=e.canvas,i=new MutationObserver(l=>{let a=!1;for(const o of l)a=a||i2(o.removedNodes,r),a=a&&!i2(o.addedNodes,r);a&&n()});return i.observe(document,{childList:!0,subtree:!0}),i}const A_=new Map;let _E=0;function GI(){const e=window.devicePixelRatio;e!==_E&&(_E=e,A_.forEach((t,n)=>{n.currentDevicePixelRatio!==e&&t()}))}function sJ(e,t){A_.size||window.addEventListener("resize",GI),A_.set(e,t)}function oJ(e){A_.delete(e),A_.size||window.removeEventListener("resize",GI)}function aJ(e,t,n){const r=e.canvas,i=r&&XC(r);if(!i)return;const l=_I((o,f)=>{const m=i.clientWidth;n(o,f),m<i.clientWidth&&n()},window),a=new ResizeObserver(o=>{const f=o[0],m=f.contentRect.width,_=f.contentRect.height;m===0&&_===0||l(m,_)});return a.observe(i),sJ(e,l),a}function h4(e,t,n){n&&n.disconnect(),t==="resize"&&oJ(e)}function lJ(e,t,n){const r=e.canvas,i=_I(l=>{e.ctx!==null&&n(nJ(l,e))},e);return eJ(r,t,i),i}class uJ extends VI{acquireContext(t,n){const r=t&&t.getContext&&t.getContext("2d");return r&&r.canvas===t?(QX(t,n),r):null}releaseContext(t){const n=t.canvas;if(!n[_x])return!1;const r=n[_x].initial;["height","width"].forEach(l=>{const a=r[l];go(a)?n.removeAttribute(l):n.setAttribute(l,a)});const i=r.style||{};return Object.keys(i).forEach(l=>{n.style[l]=i[l]}),n.width=n.width,delete n[_x],!0}addEventListener(t,n,r){this.removeEventListener(t,n);const i=t.$proxies||(t.$proxies={}),a={attach:rJ,detach:iJ,resize:aJ}[n]||lJ;i[n]=a(t,n,r)}removeEventListener(t,n){const r=t.$proxies||(t.$proxies={}),i=r[n];if(!i)return;({attach:h4,detach:h4,resize:h4}[n]||tJ)(t,n,i),r[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,n,r,i){return tX(t,n,r,i)}isAttached(t){const n=XC(t);return!!(n&&n.isConnected)}}function cJ(e){return!YC()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?XX:uJ}var Kb;let Cp=(Kb=class{constructor(){un(this,"x");un(this,"y");un(this,"active",!1);un(this,"options");un(this,"$animations")}tooltipPosition(t){const{x:n,y:r}=this.getProps(["x","y"],t);return{x:n,y:r}}hasValue(){return W0(this.x)&&W0(this.y)}getProps(t,n){const r=this.$animations;if(!n||!r)return this;const i={};return t.forEach(l=>{i[l]=r[l]&&r[l].active()?r[l]._to:this[l]}),i}},un(Kb,"defaults",{}),un(Kb,"defaultRoutes"),Kb);function hJ(e,t){const n=e.options.ticks,r=dJ(e),i=Math.min(n.maxTicksLimit||r,r),l=n.major.enabled?pJ(t):[],a=l.length,o=l[0],f=l[a-1],m=[];if(a>i)return mJ(t,m,l,a/i),m;const _=fJ(l,t,i);if(a>0){let w,M;const C=a>1?Math.round((f-o)/(a-1)):null;for(Fb(t,m,_,go(C)?0:o-C,o),w=0,M=a-1;w<M;w++)Fb(t,m,_,l[w],l[w+1]);return Fb(t,m,_,f,go(C)?t.length:f+C),m}return Fb(t,m,_),m}function dJ(e){const t=e.options.offset,n=e._tickSize(),r=e._length/n+(t?0:1),i=e._maxLength/n;return Math.floor(Math.min(r,i))}function fJ(e,t,n){const r=gJ(e),i=t.length/n;if(!r)return Math.max(i,1);const l=sY(r);for(let a=0,o=l.length-1;a<o;a++){const f=l[a];if(f>i)return f}return Math.max(i,1)}function pJ(e){const t=[];let n,r;for(n=0,r=e.length;n<r;n++)e[n].major&&t.push(n);return t}function mJ(e,t,n,r){let i=0,l=n[0],a;for(r=Math.ceil(r),a=0;a<e.length;a++)a===l&&(t.push(e[a]),i++,l=n[i*r])}function Fb(e,t,n,r,i){const l=Es(r,0),a=Math.min(Es(i,e.length),e.length);let o=0,f,m,_;for(n=Math.ceil(n),i&&(f=i-r,n=f/Math.floor(f/n)),_=l;_<0;)o++,_=Math.round(l+o*n);for(m=Math.max(l,0);m<a;m++)m===_&&(t.push(e[m]),o++,_=Math.round(l+o*n))}function gJ(e){const t=e.length;let n,r;if(t<2)return!1;for(r=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==r)return!1;return r}const yJ=e=>e==="left"?"right":e==="right"?"left":e,bE=(e,t,n)=>t==="top"||t==="left"?e[t]+n:e[t]-n,xE=(e,t)=>Math.min(t||e,e);function wE(e,t){const n=[],r=e.length/t,i=e.length;let l=0;for(;l<i;l+=r)n.push(e[Math.floor(l)]);return n}function vJ(e,t,n){const r=e.ticks.length,i=Math.min(t,r-1),l=e._startPixel,a=e._endPixel,o=1e-6;let f=e.getPixelForTick(i),m;if(!(n&&(r===1?m=Math.max(f-l,a-f):t===0?m=(e.getPixelForTick(1)-f)/2:m=(f-e.getPixelForTick(i-1))/2,f+=i<t?m:-m,f<l-o||f>a+o)))return f}function _J(e,t){Yo(e,n=>{const r=n.gc,i=r.length/2;let l;if(i>t){for(l=0;l<i;++l)delete n.data[r[l]];r.splice(0,i)}})}function gv(e){return e.drawTicks?e.tickLength:0}function CE(e,t){if(!e.display)return 0;const n=cc(e.font,t),r=oh(e.padding);return(pl(e.text)?e.text.length:1)*n.lineHeight+r.height}function bJ(e,t){return Cm(e,{scale:t,type:"scale"})}function xJ(e,t,n){return Cm(e,{tick:n,index:t,type:"tick"})}function wJ(e,t,n){let r=GC(e);return(n&&t!=="right"||!n&&t==="right")&&(r=yJ(r)),r}function CJ(e,t,n,r){const{top:i,left:l,bottom:a,right:o,chart:f}=e,{chartArea:m,scales:_}=f;let w=0,M,C,R;const z=a-i,W=o-l;if(e.isHorizontal()){if(C=Xc(r,l,o),qs(n)){const X=Object.keys(n)[0],Y=n[X];R=_[X].getPixelForValue(Y)+z-t}else n==="center"?R=(m.bottom+m.top)/2+z-t:R=bE(e,n,t);M=o-l}else{if(qs(n)){const X=Object.keys(n)[0],Y=n[X];C=_[X].getPixelForValue(Y)-W+t}else n==="center"?C=(m.left+m.right)/2-W+t:C=bE(e,n,t);R=Xc(r,a,i),w=n==="left"?-Lu:Lu}return{titleX:C,titleY:R,maxWidth:M,rotation:w}}class Ag extends Cp{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,n){return t}getUserBounds(){let{_userMin:t,_userMax:n,_suggestedMin:r,_suggestedMax:i}=this;return t=dd(t,Number.POSITIVE_INFINITY),n=dd(n,Number.NEGATIVE_INFINITY),r=dd(r,Number.POSITIVE_INFINITY),i=dd(i,Number.NEGATIVE_INFINITY),{min:dd(t,r),max:dd(n,i),minDefined:iu(t),maxDefined:iu(n)}}getMinMax(t){let{min:n,max:r,minDefined:i,maxDefined:l}=this.getUserBounds(),a;if(i&&l)return{min:n,max:r};const o=this.getMatchingVisibleMetas();for(let f=0,m=o.length;f<m;++f)a=o[f].controller.getMinMax(this,t),i||(n=Math.min(n,a.min)),l||(r=Math.max(r,a.max));return n=l&&n>r?r:n,r=i&&n>r?n:r,{min:dd(n,dd(r,n)),max:dd(r,dd(n,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Na(this.options.beforeUpdate,[this])}update(t,n,r){const{beginAtZero:i,grace:l,ticks:a}=this.options,o=a.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=n,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=DY(this,l,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const f=o<this.ticks.length;this._convertTicksToLabels(f?wE(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),a.display&&(a.autoSkip||a.source==="auto")&&(this.ticks=hJ(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),f&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,n,r;this.isHorizontal()?(n=this.left,r=this.right):(n=this.top,r=this.bottom,t=!t),this._startPixel=n,this._endPixel=r,this._reversePixels=t,this._length=r-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Na(this.options.afterUpdate,[this])}beforeSetDimensions(){Na(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Na(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),Na(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Na(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const n=this.options.ticks;let r,i,l;for(r=0,i=t.length;r<i;r++)l=t[r],l.label=Na(n.callback,[l.value,r,t],this)}afterTickToLabelConversion(){Na(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Na(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,n=t.ticks,r=xE(this.ticks.length,t.ticks.maxTicksLimit),i=n.minRotation||0,l=n.maxRotation;let a=i,o,f,m;if(!this._isVisible()||!n.display||i>=l||r<=1||!this.isHorizontal()){this.labelRotation=i;return}const _=this._getLabelSizes(),w=_.widest.width,M=_.highest.height,C=bc(this.chart.width-w,0,this.maxWidth);o=t.offset?this.maxWidth/r:C/(r-1),w+6>o&&(o=C/(r-(t.offset?.5:1)),f=this.maxHeight-gv(t.grid)-n.padding-CE(t.title,this.chart.options.font),m=Math.sqrt(w*w+M*M),a=VC(Math.min(Math.asin(bc((_.highest.height+6)/o,-1,1)),Math.asin(bc(f/m,-1,1))-Math.asin(bc(M/m,-1,1)))),a=Math.max(i,Math.min(l,a))),this.labelRotation=a}afterCalculateLabelRotation(){Na(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Na(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:n,options:{ticks:r,title:i,grid:l}}=this,a=this._isVisible(),o=this.isHorizontal();if(a){const f=CE(i,n.options.font);if(o?(t.width=this.maxWidth,t.height=gv(l)+f):(t.height=this.maxHeight,t.width=gv(l)+f),r.display&&this.ticks.length){const{first:m,last:_,widest:w,highest:M}=this._getLabelSizes(),C=r.padding*2,R=nf(this.labelRotation),z=Math.cos(R),W=Math.sin(R);if(o){const X=r.mirror?0:W*w.width+z*M.height;t.height=Math.min(this.maxHeight,t.height+X+C)}else{const X=r.mirror?0:z*w.width+W*M.height;t.width=Math.min(this.maxWidth,t.width+X+C)}this._calculatePadding(m,_,W,z)}}this._handleMargins(),o?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,n,r,i){const{ticks:{align:l,padding:a},position:o}=this.options,f=this.labelRotation!==0,m=o!=="top"&&this.axis==="x";if(this.isHorizontal()){const _=this.getPixelForTick(0)-this.left,w=this.right-this.getPixelForTick(this.ticks.length-1);let M=0,C=0;f?m?(M=i*t.width,C=r*n.height):(M=r*t.height,C=i*n.width):l==="start"?C=n.width:l==="end"?M=t.width:l!=="inner"&&(M=t.width/2,C=n.width/2),this.paddingLeft=Math.max((M-_+a)*this.width/(this.width-_),0),this.paddingRight=Math.max((C-w+a)*this.width/(this.width-w),0)}else{let _=n.height/2,w=t.height/2;l==="start"?(_=0,w=t.height):l==="end"&&(_=n.height,w=0),this.paddingTop=_+a,this.paddingBottom=w+a}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Na(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:n}=this.options;return n==="top"||n==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let n,r;for(n=0,r=t.length;n<r;n++)go(t[n].label)&&(t.splice(n,1),r--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const n=this.options.ticks.sampleSize;let r=this.ticks;n<r.length&&(r=wE(r,n)),this._labelSizes=t=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,n,r){const{ctx:i,_longestTextCache:l}=this,a=[],o=[],f=Math.floor(n/xE(n,r));let m=0,_=0,w,M,C,R,z,W,X,Y,Q,oe,le;for(w=0;w<n;w+=f){if(R=t[w].label,z=this._resolveTickFontOptions(w),i.font=W=z.string,X=l[W]=l[W]||{data:{},gc:[]},Y=z.lineHeight,Q=oe=0,!go(R)&&!pl(R))Q=n2(i,X.data,X.gc,Q,R),oe=Y;else if(pl(R))for(M=0,C=R.length;M<C;++M)le=R[M],!go(le)&&!pl(le)&&(Q=n2(i,X.data,X.gc,Q,le),oe+=Y);a.push(Q),o.push(oe),m=Math.max(Q,m),_=Math.max(oe,_)}_J(l,n);const me=a.indexOf(m),we=o.indexOf(_),ue=_e=>({width:a[_e]||0,height:o[_e]||0});return{first:ue(0),last:ue(n-1),widest:ue(me),highest:ue(we),widths:a,heights:o}}getLabelForValue(t){return t}getPixelForValue(t,n){return NaN}getValueForPixel(t){}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const n=this._startPixel+t*this._length;return lY(this._alignToPixels?eg(this.chart,n,0):n)}getDecimalForPixel(t){const n=(t-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:n}=this;return t<0&&n<0?n:t>0&&n>0?t:0}getContext(t){const n=this.ticks||[];if(t>=0&&t<n.length){const r=n[t];return r.$context||(r.$context=xJ(this.getContext(),t,r))}return this.$context||(this.$context=bJ(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,n=nf(this.labelRotation),r=Math.abs(Math.cos(n)),i=Math.abs(Math.sin(n)),l=this._getLabelSizes(),a=t.autoSkipPadding||0,o=l?l.widest.width+a:0,f=l?l.highest.height+a:0;return this.isHorizontal()?f*r>o*i?o/r:f/i:f*i<o*r?f/r:o/i}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const n=this.axis,r=this.chart,i=this.options,{grid:l,position:a,border:o}=i,f=l.offset,m=this.isHorizontal(),w=this.ticks.length+(f?1:0),M=gv(l),C=[],R=o.setContext(this.getContext()),z=R.display?R.width:0,W=z/2,X=function(ne){return eg(r,ne,z)};let Y,Q,oe,le,me,we,ue,_e,We,he,de,Te;if(a==="top")Y=X(this.bottom),we=this.bottom-M,_e=Y-W,he=X(t.top)+W,Te=t.bottom;else if(a==="bottom")Y=X(this.top),he=t.top,Te=X(t.bottom)-W,we=Y+W,_e=this.top+M;else if(a==="left")Y=X(this.right),me=this.right-M,ue=Y-W,We=X(t.left)+W,de=t.right;else if(a==="right")Y=X(this.left),We=t.left,de=X(t.right)-W,me=Y+W,ue=this.left+M;else if(n==="x"){if(a==="center")Y=X((t.top+t.bottom)/2+.5);else if(qs(a)){const ne=Object.keys(a)[0],Se=a[ne];Y=X(this.chart.scales[ne].getPixelForValue(Se))}he=t.top,Te=t.bottom,we=Y+W,_e=we+M}else if(n==="y"){if(a==="center")Y=X((t.left+t.right)/2);else if(qs(a)){const ne=Object.keys(a)[0],Se=a[ne];Y=X(this.chart.scales[ne].getPixelForValue(Se))}me=Y-W,ue=me-M,We=t.left,de=t.right}const be=Es(i.ticks.maxTicksLimit,w),ae=Math.max(1,Math.ceil(w/be));for(Q=0;Q<w;Q+=ae){const ne=this.getContext(Q),Se=l.setContext(ne),Le=o.setContext(ne),ze=Se.lineWidth,He=Se.color,pt=Le.dash||[],ge=Le.dashOffset,Ie=Se.tickWidth,Ne=Se.tickColor,Ve=Se.tickBorderDash||[],it=Se.tickBorderDashOffset;oe=vJ(this,Q,f),oe!==void 0&&(le=eg(r,oe,ze),m?me=ue=We=de=le:we=_e=he=Te=le,C.push({tx1:me,ty1:we,tx2:ue,ty2:_e,x1:We,y1:he,x2:de,y2:Te,width:ze,color:He,borderDash:pt,borderDashOffset:ge,tickWidth:Ie,tickColor:Ne,tickBorderDash:Ve,tickBorderDashOffset:it}))}return this._ticksLength=w,this._borderValue=Y,C}_computeLabelItems(t){const n=this.axis,r=this.options,{position:i,ticks:l}=r,a=this.isHorizontal(),o=this.ticks,{align:f,crossAlign:m,padding:_,mirror:w}=l,M=gv(r.grid),C=M+_,R=w?-_:C,z=-nf(this.labelRotation),W=[];let X,Y,Q,oe,le,me,we,ue,_e,We,he,de,Te="middle";if(i==="top")me=this.bottom-R,we=this._getXAxisLabelAlignment();else if(i==="bottom")me=this.top+R,we=this._getXAxisLabelAlignment();else if(i==="left"){const ae=this._getYAxisLabelAlignment(M);we=ae.textAlign,le=ae.x}else if(i==="right"){const ae=this._getYAxisLabelAlignment(M);we=ae.textAlign,le=ae.x}else if(n==="x"){if(i==="center")me=(t.top+t.bottom)/2+C;else if(qs(i)){const ae=Object.keys(i)[0],ne=i[ae];me=this.chart.scales[ae].getPixelForValue(ne)+C}we=this._getXAxisLabelAlignment()}else if(n==="y"){if(i==="center")le=(t.left+t.right)/2-C;else if(qs(i)){const ae=Object.keys(i)[0],ne=i[ae];le=this.chart.scales[ae].getPixelForValue(ne)}we=this._getYAxisLabelAlignment(M).textAlign}n==="y"&&(f==="start"?Te="top":f==="end"&&(Te="bottom"));const be=this._getLabelSizes();for(X=0,Y=o.length;X<Y;++X){Q=o[X],oe=Q.label;const ae=l.setContext(this.getContext(X));ue=this.getPixelForTick(X)+l.labelOffset,_e=this._resolveTickFontOptions(X),We=_e.lineHeight,he=pl(oe)?oe.length:1;const ne=he/2,Se=ae.color,Le=ae.textStrokeColor,ze=ae.textStrokeWidth;let He=we;a?(le=ue,we==="inner"&&(X===Y-1?He=this.options.reverse?"left":"right":X===0?He=this.options.reverse?"right":"left":He="center"),i==="top"?m==="near"||z!==0?de=-he*We+We/2:m==="center"?de=-be.highest.height/2-ne*We+We:de=-be.highest.height+We/2:m==="near"||z!==0?de=We/2:m==="center"?de=be.highest.height/2-ne*We:de=be.highest.height-he*We,w&&(de*=-1),z!==0&&!ae.showLabelBackdrop&&(le+=We/2*Math.sin(z))):(me=ue,de=(1-he)*We/2);let pt;if(ae.showLabelBackdrop){const ge=oh(ae.backdropPadding),Ie=be.heights[X],Ne=be.widths[X];let Ve=de-ge.top,it=0-ge.left;switch(Te){case"middle":Ve-=Ie/2;break;case"bottom":Ve-=Ie;break}switch(we){case"center":it-=Ne/2;break;case"right":it-=Ne;break;case"inner":X===Y-1?it-=Ne:X>0&&(it-=Ne/2);break}pt={left:it,top:Ve,width:Ne+ge.width,height:Ie+ge.height,color:ae.backdropColor}}W.push({label:oe,font:_e,textOffset:de,options:{rotation:z,color:Se,strokeColor:Le,strokeWidth:ze,textAlign:He,textBaseline:Te,translation:[le,me],backdrop:pt}})}return W}_getXAxisLabelAlignment(){const{position:t,ticks:n}=this.options;if(-nf(this.labelRotation))return t==="top"?"left":"right";let i="center";return n.align==="start"?i="left":n.align==="end"?i="right":n.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(t){const{position:n,ticks:{crossAlign:r,mirror:i,padding:l}}=this.options,a=this._getLabelSizes(),o=t+l,f=a.widest.width;let m,_;return n==="left"?i?(_=this.right+l,r==="near"?m="left":r==="center"?(m="center",_+=f/2):(m="right",_+=f)):(_=this.right-o,r==="near"?m="right":r==="center"?(m="center",_-=f/2):(m="left",_=this.left)):n==="right"?i?(_=this.left+l,r==="near"?m="right":r==="center"?(m="center",_-=f/2):(m="left",_-=f)):(_=this.left+o,r==="near"?m="left":r==="center"?(m="center",_+=f/2):(m="right",_=this.right)):m="right",{textAlign:m,x:_}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:n},left:r,top:i,width:l,height:a}=this;n&&(t.save(),t.fillStyle=n,t.fillRect(r,i,l,a),t.restore())}getLineWidthForValue(t){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const i=this.ticks.findIndex(l=>l.value===t);return i>=0?n.setContext(this.getContext(i)).lineWidth:0}drawGrid(t){const n=this.options.grid,r=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let l,a;const o=(f,m,_)=>{!_.width||!_.color||(r.save(),r.lineWidth=_.width,r.strokeStyle=_.color,r.setLineDash(_.borderDash||[]),r.lineDashOffset=_.borderDashOffset,r.beginPath(),r.moveTo(f.x,f.y),r.lineTo(m.x,m.y),r.stroke(),r.restore())};if(n.display)for(l=0,a=i.length;l<a;++l){const f=i[l];n.drawOnChartArea&&o({x:f.x1,y:f.y1},{x:f.x2,y:f.y2},f),n.drawTicks&&o({x:f.tx1,y:f.ty1},{x:f.tx2,y:f.ty2},{color:f.tickColor,width:f.tickWidth,borderDash:f.tickBorderDash,borderDashOffset:f.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:n,options:{border:r,grid:i}}=this,l=r.setContext(this.getContext()),a=r.display?l.width:0;if(!a)return;const o=i.setContext(this.getContext(0)).lineWidth,f=this._borderValue;let m,_,w,M;this.isHorizontal()?(m=eg(t,this.left,a)-a/2,_=eg(t,this.right,o)+o/2,w=M=f):(w=eg(t,this.top,a)-a/2,M=eg(t,this.bottom,o)+o/2,m=_=f),n.save(),n.lineWidth=l.width,n.strokeStyle=l.color,n.beginPath(),n.moveTo(m,w),n.lineTo(_,M),n.stroke(),n.restore()}drawLabels(t){if(!this.options.ticks.display)return;const r=this.ctx,i=this._computeLabelArea();i&&q2(r,i);const l=this.getLabelItems(t);for(const a of l){const o=a.options,f=a.font,m=a.label,_=a.textOffset;Lg(r,m,0,_,f,o)}i&&W2(r)}drawTitle(){const{ctx:t,options:{position:n,title:r,reverse:i}}=this;if(!r.display)return;const l=cc(r.font),a=oh(r.padding),o=r.align;let f=l.lineHeight/2;n==="bottom"||n==="center"||qs(n)?(f+=a.bottom,pl(r.text)&&(f+=l.lineHeight*(r.text.length-1))):f+=a.top;const{titleX:m,titleY:_,maxWidth:w,rotation:M}=CJ(this,f,n,o);Lg(t,r.text,0,0,l,{color:r.color,maxWidth:w,rotation:M,textAlign:wJ(o,n,i),textBaseline:"middle",translation:[m,_]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,n=t.ticks&&t.ticks.z||0,r=Es(t.grid&&t.grid.z,-1),i=Es(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==Ag.prototype.draw?[{z:n,draw:l=>{this.draw(l)}}]:[{z:r,draw:l=>{this.drawBackground(),this.drawGrid(l),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:n,draw:l=>{this.drawLabels(l)}}]}getMatchingVisibleMetas(t){const n=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",i=[];let l,a;for(l=0,a=n.length;l<a;++l){const o=n[l];o[r]===this.id&&(!t||o.type===t)&&i.push(o)}return i}_resolveTickFontOptions(t){const n=this.options.ticks.setContext(this.getContext(t));return cc(n.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class zb{constructor(t,n,r){this.type=t,this.scope=n,this.override=r,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const n=Object.getPrototypeOf(t);let r;PJ(n)&&(r=this.register(n));const i=this.items,l=t.id,a=this.scope+"."+l;if(!l)throw new Error("class does not have id: "+t);return l in i||(i[l]=t,SJ(t,a,r),this.override&&su.override(t.id,t.overrides)),a}get(t){return this.items[t]}unregister(t){const n=this.items,r=t.id,i=this.scope;r in n&&delete n[r],i&&r in su[i]&&(delete su[i][r],this.override&&delete Sg[r])}}function SJ(e,t,n){const r=P_(Object.create(null),[n?su.get(n):{},su.get(t),e.defaults]);su.set(t,r),e.defaultRoutes&&LJ(t,e.defaultRoutes),e.descriptors&&su.describe(t,e.descriptors)}function LJ(e,t){Object.keys(t).forEach(n=>{const r=n.split("."),i=r.pop(),l=[e].concat(r).join("."),a=t[n].split("."),o=a.pop(),f=a.join(".");su.route(l,i,f,o)})}function PJ(e){return"id"in e&&"defaults"in e}class EJ{constructor(){this.controllers=new zb(sf,"datasets",!0),this.elements=new zb(Cp,"elements"),this.plugins=new zb(Object,"plugins"),this.scales=new zb(Ag,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,n,r){[...n].forEach(i=>{const l=r||this._getRegistryForType(i);r||l.isForType(i)||l===this.plugins&&i.id?this._exec(t,l,i):Yo(i,a=>{const o=r||this._getRegistryForType(a);this._exec(t,o,a)})})}_exec(t,n,r){const i=UC(t);Na(r["before"+i],[],r),n[t](r),Na(r["after"+i],[],r)}_getRegistryForType(t){for(let n=0;n<this._typedRegistries.length;n++){const r=this._typedRegistries[n];if(r.isForType(t))return r}return this.plugins}_get(t,n,r){const i=n.get(t);if(i===void 0)throw new Error('"'+t+'" is not a registered '+r+".");return i}}var Mf=new EJ;class MJ{constructor(){this._init=[]}notify(t,n,r,i){n==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const l=i?this._descriptors(t).filter(i):this._descriptors(t),a=this._notify(l,t,n,r);return n==="afterDestroy"&&(this._notify(l,t,"stop"),this._notify(this._init,t,"uninstall")),a}_notify(t,n,r,i){i=i||{};for(const l of t){const a=l.plugin,o=a[r],f=[n,i,l.options];if(Na(o,f,a)===!1&&i.cancelable)return!1}return!0}invalidate(){go(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),n}_createDescriptors(t,n){const r=t&&t.config,i=Es(r.options&&r.options.plugins,{}),l=TJ(r);return i===!1&&!n?[]:kJ(t,l,i,n)}_notifyStateChanges(t){const n=this._oldCache||[],r=this._cache,i=(l,a)=>l.filter(o=>!a.some(f=>o.plugin.id===f.plugin.id));this._notify(i(n,r),t,"stop"),this._notify(i(r,n),t,"start")}}function TJ(e){const t={},n=[],r=Object.keys(Mf.plugins.items);for(let l=0;l<r.length;l++)n.push(Mf.getPlugin(r[l]));const i=e.plugins||[];for(let l=0;l<i.length;l++){const a=i[l];n.indexOf(a)===-1&&(n.push(a),t[a.id]=!0)}return{plugins:n,localIds:t}}function AJ(e,t){return!t&&e===!1?null:e===!0?{}:e}function kJ(e,{plugins:t,localIds:n},r,i){const l=[],a=e.getContext();for(const o of t){const f=o.id,m=AJ(r[f],i);m!==null&&l.push({plugin:o,options:IJ(e.config,{plugin:o,local:n[f]},m,a)})}return l}function IJ(e,{plugin:t,local:n},r,i){const l=e.pluginScopeKeys(t),a=e.getOptionScopes(r,l);return n&&t.defaults&&a.push(t.defaults),e.createResolver(a,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function x3(e,t){const n=su.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function DJ(e,t){let n=e;return e==="_index_"?n=t:e==="_value_"&&(n=t==="x"?"y":"x"),n}function OJ(e,t){return e===t?"_index_":"_value_"}function SE(e){if(e==="x"||e==="y"||e==="r")return e}function RJ(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function w3(e,...t){if(SE(e))return e;for(const n of t){const r=n.axis||RJ(n.position)||e.length>1&&SE(e[0].toLowerCase());if(r)return r}throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function LE(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function BJ(e,t){if(t.data&&t.data.datasets){const n=t.data.datasets.filter(r=>r.xAxisID===e||r.yAxisID===e);if(n.length)return LE(e,"x",n[0])||LE(e,"y",n[0])}return{}}function NJ(e,t){const n=Sg[e.type]||{scales:{}},r=t.scales||{},i=x3(e.type,t),l=Object.create(null);return Object.keys(r).forEach(a=>{const o=r[a];if(!qs(o))return console.error(`Invalid scale configuration for scale: ${a}`);if(o._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${a}`);const f=w3(a,o,BJ(a,e),su.scales[o.type]),m=OJ(f,i),_=n.scales||{};l[a]=t_(Object.create(null),[{axis:f},o,_[f],_[m]])}),e.data.datasets.forEach(a=>{const o=a.type||e.type,f=a.indexAxis||x3(o,t),_=(Sg[o]||{}).scales||{};Object.keys(_).forEach(w=>{const M=DJ(w,f),C=a[M+"AxisID"]||M;l[C]=l[C]||Object.create(null),t_(l[C],[{axis:M},r[C],_[w]])})}),Object.keys(l).forEach(a=>{const o=l[a];t_(o,[su.scales[o.type],su.scale])}),l}function HI(e){const t=e.options||(e.options={});t.plugins=Es(t.plugins,{}),t.scales=NJ(e,t)}function qI(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function FJ(e){return e=e||{},e.data=qI(e.data),HI(e),e}const PE=new Map,WI=new Set;function jb(e,t){let n=PE.get(e);return n||(n=t(),PE.set(e,n),WI.add(n)),n}const yv=(e,t,n)=>{const r=vm(t,n);r!==void 0&&e.add(r)};class zJ{constructor(t){this._config=FJ(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=qI(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),HI(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return jb(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,n){return jb(`${t}.transition.${n}`,()=>[[`datasets.${t}.transitions.${n}`,`transitions.${n}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,n){return jb(`${t}-${n}`,()=>[[`datasets.${t}.elements.${n}`,`datasets.${t}`,`elements.${n}`,""]])}pluginScopeKeys(t){const n=t.id,r=this.type;return jb(`${r}-plugin-${n}`,()=>[[`plugins.${n}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,n){const r=this._scopeCache;let i=r.get(t);return(!i||n)&&(i=new Map,r.set(t,i)),i}getOptionScopes(t,n,r){const{options:i,type:l}=this,a=this._cachedScopes(t,r),o=a.get(n);if(o)return o;const f=new Set;n.forEach(_=>{t&&(f.add(t),_.forEach(w=>yv(f,t,w))),_.forEach(w=>yv(f,i,w)),_.forEach(w=>yv(f,Sg[l]||{},w)),_.forEach(w=>yv(f,su,w)),_.forEach(w=>yv(f,v3,w))});const m=Array.from(f);return m.length===0&&m.push(Object.create(null)),WI.has(n)&&a.set(n,m),m}chartOptionScopes(){const{options:t,type:n}=this;return[t,Sg[n]||{},su.datasets[n]||{},{type:n},su,v3]}resolveNamedOptions(t,n,r,i=[""]){const l={$shared:!0},{resolver:a,subPrefixes:o}=EE(this._resolverCache,t,i);let f=a;if(UJ(a,n)){l.$shared=!1,r=_m(r)?r():r;const m=this.createResolver(t,r,o);f=Z0(a,r,m)}for(const m of n)l[m]=f[m];return l}createResolver(t,n,r=[""],i){const{resolver:l}=EE(this._resolverCache,t,r);return qs(n)?Z0(l,n,void 0,i):l}}function EE(e,t,n){let r=e.get(t);r||(r=new Map,e.set(t,r));const i=n.join();let l=r.get(i);return l||(l={resolver:WC(t,n),subPrefixes:n.filter(o=>!o.toLowerCase().includes("hover"))},r.set(i,l)),l}const jJ=e=>qs(e)&&Object.getOwnPropertyNames(e).some(t=>_m(e[t]));function UJ(e,t){const{isScriptable:n,isIndexable:r}=LI(e);for(const i of t){const l=n(i),a=r(i),o=(a||l)&&e[i];if(l&&(_m(o)||jJ(o))||a&&pl(o))return!0}return!1}var VJ="4.4.1";const $J=["top","bottom","left","right","chartArea"];function ME(e,t){return e==="top"||e==="bottom"||$J.indexOf(e)===-1&&t==="x"}function TE(e,t){return function(n,r){return n[e]===r[e]?n[t]-r[t]:n[e]-r[e]}}function AE(e){const t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),Na(n&&n.onComplete,[e],t)}function GJ(e){const t=e.chart,n=t.options.animation;Na(n&&n.onProgress,[e],t)}function ZI(e){return YC()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const bx={},kE=e=>{const t=ZI(e);return Object.values(bx).filter(n=>n.canvas===t).pop()};function HJ(e,t,n){const r=Object.keys(e);for(const i of r){const l=+i;if(l>=t){const a=e[i];delete e[i],(n>0||l>t)&&(e[l+n]=a)}}}function qJ(e,t,n,r){return!n||e.type==="mouseout"?null:r?t:e}function Ub(e,t,n){return e.options.clip?e[n]:t[n]}function WJ(e,t){const{xScale:n,yScale:r}=e;return n&&r?{left:Ub(n,t,"left"),right:Ub(n,t,"right"),top:Ub(r,t,"top"),bottom:Ub(r,t,"bottom")}:t}class Af{static register(...t){Mf.add(...t),IE()}static unregister(...t){Mf.remove(...t),IE()}constructor(t,n){const r=this.config=new zJ(n),i=ZI(t),l=kE(i);if(l)throw new Error("Canvas is already in use. Chart with ID '"+l.id+"' must be destroyed before the canvas with ID '"+l.canvas.id+"' can be reused.");const a=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||cJ(i)),this.platform.updateConfig(r);const o=this.platform.acquireContext(i,a.aspectRatio),f=o&&o.canvas,m=f&&f.height,_=f&&f.width;if(this.id=YK(),this.ctx=o,this.canvas=f,this.width=_,this.height=m,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new MJ,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=dY(w=>this.update(w),a.resizeDelay||0),this._dataChanges=[],bx[this.id]=this,!o||!f){console.error("Failed to create chart: can't acquire context from the given item");return}ap.listen(this,"complete",AE),ap.listen(this,"progress",GJ),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:n},width:r,height:i,_aspectRatio:l}=this;return go(t)?n&&l?l:i?r/i:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return Mf}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():QP(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return YP(this.canvas,this.ctx),this}stop(){return ap.stop(this),this}resize(t,n){ap.running(this)?this._resizeBeforeDraw={width:t,height:n}:this._resize(t,n)}_resize(t,n){const r=this.options,i=this.canvas,l=r.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(i,t,n,l),o=r.devicePixelRatio||this.platform.getDevicePixelRatio(),f=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,QP(this,o,!0)&&(this.notifyPlugins("resize",{size:a}),Na(r.onResize,[this,a],this),this.attached&&this._doResize(f)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};Yo(n,(r,i)=>{r.id=i})}buildOrUpdateScales(){const t=this.options,n=t.scales,r=this.scales,i=Object.keys(r).reduce((a,o)=>(a[o]=!1,a),{});let l=[];n&&(l=l.concat(Object.keys(n).map(a=>{const o=n[a],f=w3(a,o),m=f==="r",_=f==="x";return{options:o,dposition:m?"chartArea":_?"bottom":"left",dtype:m?"radialLinear":_?"category":"linear"}}))),Yo(l,a=>{const o=a.options,f=o.id,m=w3(f,o),_=Es(o.type,a.dtype);(o.position===void 0||ME(o.position,m)!==ME(a.dposition))&&(o.position=a.dposition),i[f]=!0;let w=null;if(f in r&&r[f].type===_)w=r[f];else{const M=Mf.getScale(_);w=new M({id:f,type:_,ctx:this.ctx,chart:this}),r[w.id]=w}w.init(o,t)}),Yo(i,(a,o)=>{a||delete r[o]}),Yo(r,a=>{ih.configure(this,a,a.options),ih.addBox(this,a)})}_updateMetasets(){const t=this._metasets,n=this.data.datasets.length,r=t.length;if(t.sort((i,l)=>i.index-l.index),r>n){for(let i=n;i<r;++i)this._destroyDatasetMeta(i);t.splice(n,r-n)}this._sortedMetasets=t.slice(0).sort(TE("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:n}}=this;t.length>n.length&&delete this._stacks,t.forEach((r,i)=>{n.filter(l=>l===r._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const t=[],n=this.data.datasets;let r,i;for(this._removeUnreferencedMetasets(),r=0,i=n.length;r<i;r++){const l=n[r];let a=this.getDatasetMeta(r);const o=l.type||this.config.type;if(a.type&&a.type!==o&&(this._destroyDatasetMeta(r),a=this.getDatasetMeta(r)),a.type=o,a.indexAxis=l.indexAxis||x3(o,this.options),a.order=l.order||0,a.index=r,a.label=""+l.label,a.visible=this.isDatasetVisible(r),a.controller)a.controller.updateIndex(r),a.controller.linkScales();else{const f=Mf.getController(o),{datasetElementType:m,dataElementType:_}=su.datasets[o];Object.assign(f,{dataElementType:Mf.getElement(_),datasetElementType:m&&Mf.getElement(m)}),a.controller=new f(this,r),t.push(a.controller)}}return this._updateMetasets(),t}_resetElements(){Yo(this.data.datasets,(t,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const n=this.config;n.update();const r=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const l=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let m=0,_=this.data.datasets.length;m<_;m++){const{controller:w}=this.getDatasetMeta(m),M=!i&&l.indexOf(w)===-1;w.buildOrUpdateElements(M),a=Math.max(+w.getMaxOverflow(),a)}a=this._minPadding=r.layout.autoPadding?a:0,this._updateLayout(a),i||Yo(l,m=>{m.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(TE("z","_idx"));const{_active:o,_lastEvent:f}=this;f?this._eventHandler(f,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){Yo(this.scales,t=>{ih.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,n=new Set(Object.keys(this._listeners)),r=new Set(t.events);(!UP(n,r)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,n=this._getUniformDataChanges()||[];for(const{method:r,start:i,count:l}of n){const a=r==="_removeElements"?-l:l;HJ(t,i,a)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const n=this.data.datasets.length,r=l=>new Set(t.filter(a=>a[0]===l).map((a,o)=>o+","+a.splice(1).join(","))),i=r(0);for(let l=1;l<n;l++)if(!UP(i,r(l)))return;return Array.from(i).map(l=>l.split(",")).map(l=>({method:l[1],start:+l[2],count:+l[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;ih.update(this,this.width,this.height,t);const n=this.chartArea,r=n.width<=0||n.height<=0;this._layers=[],Yo(this.boxes,i=>{r&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,l)=>{i._idx=l}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let n=0,r=this.data.datasets.length;n<r;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,r=this.data.datasets.length;n<r;++n)this._updateDataset(n,_m(t)?t({datasetIndex:n}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,n){const r=this.getDatasetMeta(t),i={meta:r,index:t,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(r.controller._update(n),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(ap.has(this)?this.attached&&!ap.running(this)&&ap.start(this):(this.draw(),AE({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:r,height:i}=this._resizeBeforeDraw;this._resize(r,i),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(t=0;t<n.length&&n[t].z<=0;++t)n[t].draw(this.chartArea);for(this._drawDatasets();t<n.length;++t)n[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const n=this._sortedMetasets,r=[];let i,l;for(i=0,l=n.length;i<l;++i){const a=n[i];(!t||a.visible)&&r.push(a)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let n=t.length-1;n>=0;--n)this._drawDataset(t[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const n=this.ctx,r=t._clip,i=!r.disabled,l=WJ(t,this.chartArea),a={meta:t,index:t.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",a)!==!1&&(i&&q2(n,{left:r.left===!1?0:l.left-r.left,right:r.right===!1?this.width:l.right+r.right,top:r.top===!1?0:l.top-r.top,bottom:r.bottom===!1?this.height:l.bottom+r.bottom}),t.controller.draw(),i&&W2(n),a.cancelable=!1,this.notifyPlugins("afterDatasetDraw",a))}isPointInArea(t){return gp(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,n,r,i){const l=$X.modes[n];return typeof l=="function"?l(this,t,r,i):[]}getDatasetMeta(t){const n=this.data.datasets[t],r=this._metasets;let i=r.filter(l=>l&&l._dataset===n).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:t,_dataset:n,_parsed:[],_sorted:!1},r.push(i)),i}getContext(){return this.$context||(this.$context=Cm(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const n=this.data.datasets[t];if(!n)return!1;const r=this.getDatasetMeta(t);return typeof r.hidden=="boolean"?!r.hidden:!n.hidden}setDatasetVisibility(t,n){const r=this.getDatasetMeta(t);r.hidden=!n}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,n,r){const i=r?"show":"hide",l=this.getDatasetMeta(t),a=l.controller._resolveAnimations(void 0,i);E_(n)?(l.data[n].hidden=!r,this.update()):(this.setDatasetVisibility(t,r),a.update(l,{visible:r}),this.update(o=>o.datasetIndex===t?i:void 0))}hide(t,n){this._updateVisibility(t,n,!1)}show(t,n){this._updateVisibility(t,n,!0)}_destroyDatasetMeta(t){const n=this._metasets[t];n&&n.controller&&n.controller._destroy(),delete this._metasets[t]}_stop(){let t,n;for(this.stop(),ap.remove(this),t=0,n=this.data.datasets.length;t<n;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:n}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),YP(t,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete bx[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,n=this.platform,r=(l,a)=>{n.addEventListener(this,l,a),t[l]=a},i=(l,a,o)=>{l.offsetX=a,l.offsetY=o,this._eventHandler(l)};Yo(this.options.events,l=>r(l,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,n=this.platform,r=(f,m)=>{n.addEventListener(this,f,m),t[f]=m},i=(f,m)=>{t[f]&&(n.removeEventListener(this,f,m),delete t[f])},l=(f,m)=>{this.canvas&&this.resize(f,m)};let a;const o=()=>{i("attach",o),this.attached=!0,this.resize(),r("resize",l),r("detach",a)};a=()=>{this.attached=!1,i("resize",l),this._stop(),this._resize(0,0),r("attach",o)},n.isAttached(this.canvas)?o():a()}unbindEvents(){Yo(this._listeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._listeners={},Yo(this._responsiveListeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,n,r){const i=r?"set":"remove";let l,a,o,f;for(n==="dataset"&&(l=this.getDatasetMeta(t[0].datasetIndex),l.controller["_"+i+"DatasetHoverStyle"]()),o=0,f=t.length;o<f;++o){a=t[o];const m=a&&this.getDatasetMeta(a.datasetIndex).controller;m&&m[i+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const n=this._active||[],r=t.map(({datasetIndex:l,index:a})=>{const o=this.getDatasetMeta(l);if(!o)throw new Error("No dataset found at index "+l);return{datasetIndex:l,element:o.data[a],index:a}});!Qx(r,n)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,n))}notifyPlugins(t,n,r){return this._plugins.notify(this,t,n,r)}isPluginEnabled(t){return this._plugins._cache.filter(n=>n.plugin.id===t).length===1}_updateHoverStyles(t,n,r){const i=this.options.hover,l=(f,m)=>f.filter(_=>!m.some(w=>_.datasetIndex===w.datasetIndex&&_.index===w.index)),a=l(n,t),o=r?t:l(t,n);a.length&&this.updateHoverStyle(a,i.mode,!1),o.length&&i.mode&&this.updateHoverStyle(o,i.mode,!0)}_eventHandler(t,n){const r={event:t,replay:n,cancelable:!0,inChartArea:this.isPointInArea(t)},i=a=>(a.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",r,i)===!1)return;const l=this._handleEvent(t,n,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,i),(l||r.changed)&&this.render(),this}_handleEvent(t,n,r){const{_active:i=[],options:l}=this,a=n,o=this._getActiveElements(t,i,r,a),f=nY(t),m=qJ(t,this._lastEvent,r,f);r&&(this._lastEvent=null,Na(l.onHover,[t,o,this],this),f&&Na(l.onClick,[t,o,this],this));const _=!Qx(o,i);return(_||n)&&(this._active=o,this._updateHoverStyles(o,i,n)),this._lastEvent=m,_}_getActiveElements(t,n,r,i){if(t.type==="mouseout")return[];if(!r)return n;const l=this.options.hover;return this.getElementsAtEventForMode(t,l.mode,l,i)}}un(Af,"defaults",su),un(Af,"instances",bx),un(Af,"overrides",Sg),un(Af,"registry",Mf),un(Af,"version",VJ),un(Af,"getChart",kE);function IE(){return Yo(Af.instances,e=>e._plugins.invalidate())}function ZJ(e,t,n){const{startAngle:r,pixelMargin:i,x:l,y:a,outerRadius:o,innerRadius:f}=t;let m=i/o;e.beginPath(),e.arc(l,a,o,r-m,n+m),f>i?(m=i/f,e.arc(l,a,f,n+m,r-m,!0)):e.arc(l,a,i,n+Lu,r-Lu),e.closePath(),e.clip()}function KJ(e){return qC(e,["outerStart","outerEnd","innerStart","innerEnd"])}function YJ(e,t,n,r){const i=KJ(e.options.borderRadius),l=(n-t)/2,a=Math.min(l,r*t/2),o=f=>{const m=(n-Math.min(l,f))*r/2;return bc(f,0,Math.min(l,m))};return{outerStart:o(i.outerStart),outerEnd:o(i.outerEnd),innerStart:bc(i.innerStart,0,a),innerEnd:bc(i.innerEnd,0,a)}}function g0(e,t,n,r){return{x:n+e*Math.cos(t),y:r+e*Math.sin(t)}}function s2(e,t,n,r,i,l){const{x:a,y:o,startAngle:f,pixelMargin:m,innerRadius:_}=t,w=Math.max(t.outerRadius+r+n-m,0),M=_>0?_+r+n+m:0;let C=0;const R=i-f;if(r){const ae=_>0?_-r:0,ne=w>0?w-r:0,Se=(ae+ne)/2,Le=Se!==0?R*Se/(Se+r):R;C=(R-Le)/2}const z=Math.max(.001,R*w-n/Xa)/w,W=(R-z)/2,X=f+W+C,Y=i-W-C,{outerStart:Q,outerEnd:oe,innerStart:le,innerEnd:me}=YJ(t,M,w,Y-X),we=w-Q,ue=w-oe,_e=X+Q/we,We=Y-oe/ue,he=M+le,de=M+me,Te=X+le/he,be=Y-me/de;if(e.beginPath(),l){const ae=(_e+We)/2;if(e.arc(a,o,w,_e,ae),e.arc(a,o,w,ae,We),oe>0){const ze=g0(ue,We,a,o);e.arc(ze.x,ze.y,oe,We,Y+Lu)}const ne=g0(de,Y,a,o);if(e.lineTo(ne.x,ne.y),me>0){const ze=g0(de,be,a,o);e.arc(ze.x,ze.y,me,Y+Lu,be+Math.PI)}const Se=(Y-me/M+(X+le/M))/2;if(e.arc(a,o,M,Y-me/M,Se,!0),e.arc(a,o,M,Se,X+le/M,!0),le>0){const ze=g0(he,Te,a,o);e.arc(ze.x,ze.y,le,Te+Math.PI,X-Lu)}const Le=g0(we,X,a,o);if(e.lineTo(Le.x,Le.y),Q>0){const ze=g0(we,_e,a,o);e.arc(ze.x,ze.y,Q,X-Lu,_e)}}else{e.moveTo(a,o);const ae=Math.cos(_e)*w+a,ne=Math.sin(_e)*w+o;e.lineTo(ae,ne);const Se=Math.cos(We)*w+a,Le=Math.sin(We)*w+o;e.lineTo(Se,Le)}e.closePath()}function XJ(e,t,n,r,i){const{fullCircles:l,startAngle:a,circumference:o}=t;let f=t.endAngle;if(l){s2(e,t,n,r,f,i);for(let m=0;m<l;++m)e.fill();isNaN(o)||(f=a+(o%Ya||Ya))}return s2(e,t,n,r,f,i),e.fill(),f}function JJ(e,t,n,r,i){const{fullCircles:l,startAngle:a,circumference:o,options:f}=t,{borderWidth:m,borderJoinStyle:_,borderDash:w,borderDashOffset:M}=f,C=f.borderAlign==="inner";if(!m)return;e.setLineDash(w||[]),e.lineDashOffset=M,C?(e.lineWidth=m*2,e.lineJoin=_||"round"):(e.lineWidth=m,e.lineJoin=_||"bevel");let R=t.endAngle;if(l){s2(e,t,n,r,R,i);for(let z=0;z<l;++z)e.stroke();isNaN(o)||(R=a+(o%Ya||Ya))}C&&ZJ(e,t,R),l||(s2(e,t,n,r,R,i),e.stroke())}class Dv extends Cp{constructor(n){super();un(this,"circumference");un(this,"endAngle");un(this,"fullCircles");un(this,"innerRadius");un(this,"outerRadius");un(this,"pixelMargin");un(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,r,i){const l=this.getProps(["x","y"],i),{angle:a,distance:o}=mI(l,{x:n,y:r}),{startAngle:f,endAngle:m,innerRadius:_,outerRadius:w,circumference:M}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),C=(this.options.spacing+this.options.borderWidth)/2,z=Es(M,m-f)>=Ya||M_(a,f,m),W=pp(o,_+C,w+C);return z&&W}getCenterPoint(n){const{x:r,y:i,startAngle:l,endAngle:a,innerRadius:o,outerRadius:f}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:m,spacing:_}=this.options,w=(l+a)/2,M=(o+f+_+m)/2;return{x:r+Math.cos(w)*M,y:i+Math.sin(w)*M}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:r,circumference:i}=this,l=(r.offset||0)/4,a=(r.spacing||0)/2,o=r.circular;if(this.pixelMargin=r.borderAlign==="inner"?.33:0,this.fullCircles=i>Ya?Math.floor(i/Ya):0,i===0||this.innerRadius<0||this.outerRadius<0)return;n.save();const f=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(f)*l,Math.sin(f)*l);const m=1-Math.sin(Math.min(Xa,i||0)),_=l*m;n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,XJ(n,this,_,a,o),JJ(n,this,_,a,o),n.restore()}}un(Dv,"id","arc"),un(Dv,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),un(Dv,"defaultRoutes",{backgroundColor:"backgroundColor"}),un(Dv,"descriptors",{_scriptable:!0,_indexable:n=>n!=="borderDash"});function KI(e,t,n=t){e.lineCap=Es(n.borderCapStyle,t.borderCapStyle),e.setLineDash(Es(n.borderDash,t.borderDash)),e.lineDashOffset=Es(n.borderDashOffset,t.borderDashOffset),e.lineJoin=Es(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=Es(n.borderWidth,t.borderWidth),e.strokeStyle=Es(n.borderColor,t.borderColor)}function QJ(e,t,n){e.lineTo(n.x,n.y)}function eQ(e){return e.stepped?SY:e.tension||e.cubicInterpolationMode==="monotone"?LY:QJ}function YI(e,t,n={}){const r=e.length,{start:i=0,end:l=r-1}=n,{start:a,end:o}=t,f=Math.max(i,a),m=Math.min(l,o),_=i<a&&l<a||i>o&&l>o;return{count:r,start:f,loop:t.loop,ilen:m<f&&!_?r+m-f:m-f}}function tQ(e,t,n,r){const{points:i,options:l}=t,{count:a,start:o,loop:f,ilen:m}=YI(i,n,r),_=eQ(l);let{move:w=!0,reverse:M}=r||{},C,R,z;for(C=0;C<=m;++C)R=i[(o+(M?m-C:C))%a],!R.skip&&(w?(e.moveTo(R.x,R.y),w=!1):_(e,z,R,M,l.stepped),z=R);return f&&(R=i[(o+(M?m:0))%a],_(e,z,R,M,l.stepped)),!!f}function nQ(e,t,n,r){const i=t.points,{count:l,start:a,ilen:o}=YI(i,n,r),{move:f=!0,reverse:m}=r||{};let _=0,w=0,M,C,R,z,W,X;const Y=oe=>(a+(m?o-oe:oe))%l,Q=()=>{z!==W&&(e.lineTo(_,W),e.lineTo(_,z),e.lineTo(_,X))};for(f&&(C=i[Y(0)],e.moveTo(C.x,C.y)),M=0;M<=o;++M){if(C=i[Y(M)],C.skip)continue;const oe=C.x,le=C.y,me=oe|0;me===R?(le<z?z=le:le>W&&(W=le),_=(w*_+oe)/++w):(Q(),e.lineTo(oe,le),R=me,w=0,z=W=le),X=le}Q()}function C3(e){const t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!n?nQ:tQ}function rQ(e){return e.stepped?rX:e.tension||e.cubicInterpolationMode==="monotone"?iX:og}function iQ(e,t,n,r){let i=t._path;i||(i=t._path=new Path2D,t.path(i,n,r)&&i.closePath()),KI(e,t.options),e.stroke(i)}function sQ(e,t,n,r){const{segments:i,options:l}=t,a=C3(t);for(const o of i)KI(e,l,o.style),e.beginPath(),a(e,t,o,{start:n,end:n+r-1})&&e.closePath(),e.stroke()}const oQ=typeof Path2D=="function";function aQ(e,t,n,r){oQ&&!t.options.segment?iQ(e,t,n,r):sQ(e,t,n,r)}class am extends Cp{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,n){const r=this.options;if((r.tension||r.cubicInterpolationMode==="monotone")&&!r.stepped&&!this._pointsUpdated){const i=r.spanGaps?this._loop:this._fullLoop;KY(this._points,r,t,i,n),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=cX(this,this.options.segment))}first(){const t=this.segments,n=this.points;return t.length&&n[t[0].start]}last(){const t=this.segments,n=this.points,r=t.length;return r&&n[t[r-1].end]}interpolate(t,n){const r=this.options,i=t[n],l=this.points,a=RI(this,{property:n,start:i,end:i});if(!a.length)return;const o=[],f=rQ(r);let m,_;for(m=0,_=a.length;m<_;++m){const{start:w,end:M}=a[m],C=l[w],R=l[M];if(C===R){o.push(C);continue}const z=Math.abs((i-C[n])/(R[n]-C[n])),W=f(C,R,z,r.stepped);W[n]=t[n],o.push(W)}return o.length===1?o[0]:o}pathSegment(t,n,r){return C3(this)(t,this,n,r)}path(t,n,r){const i=this.segments,l=C3(this);let a=this._loop;n=n||0,r=r||this.points.length-n;for(const o of i)a&=l(t,this,o,{start:n,end:n+r-1});return!!a}draw(t,n,r,i){const l=this.options||{};(this.points||[]).length&&l.borderWidth&&(t.save(),aQ(t,this,r,i),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}un(am,"id","line"),un(am,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),un(am,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),un(am,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"});function DE(e,t,n,r){const i=e.options,{[n]:l}=e.getProps([n],r);return Math.abs(t-l)<i.radius+i.hitRadius}class xx extends Cp{constructor(n){super();un(this,"parsed");un(this,"skip");un(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,n&&Object.assign(this,n)}inRange(n,r,i){const l=this.options,{x:a,y:o}=this.getProps(["x","y"],i);return Math.pow(n-a,2)+Math.pow(r-o,2)<Math.pow(l.hitRadius+l.radius,2)}inXRange(n,r){return DE(this,n,"x",r)}inYRange(n,r){return DE(this,n,"y",r)}getCenterPoint(n){const{x:r,y:i}=this.getProps(["x","y"],n);return{x:r,y:i}}size(n){n=n||this.options||{};let r=n.radius||0;r=Math.max(r,r&&n.hoverRadius||0);const i=r&&n.borderWidth||0;return(r+i)*2}draw(n,r){const i=this.options;this.skip||i.radius<.1||!gp(this,r,this.size(i)/2)||(n.strokeStyle=i.borderColor,n.lineWidth=i.borderWidth,n.fillStyle=i.backgroundColor,_3(n,i,this.x,this.y))}getRange(){const n=this.options||{};return n.radius+n.hitRadius}}un(xx,"id","point"),un(xx,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),un(xx,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function XI(e,t){const{x:n,y:r,base:i,width:l,height:a}=e.getProps(["x","y","base","width","height"],t);let o,f,m,_,w;return e.horizontal?(w=a/2,o=Math.min(n,i),f=Math.max(n,i),m=r-w,_=r+w):(w=l/2,o=n-w,f=n+w,m=Math.min(r,i),_=Math.max(r,i)),{left:o,top:m,right:f,bottom:_}}function lm(e,t,n,r){return e?0:bc(t,n,r)}function lQ(e,t,n){const r=e.options.borderWidth,i=e.borderSkipped,l=SI(r);return{t:lm(i.top,l.top,0,n),r:lm(i.right,l.right,0,t),b:lm(i.bottom,l.bottom,0,n),l:lm(i.left,l.left,0,t)}}function uQ(e,t,n){const{enableBorderRadius:r}=e.getProps(["enableBorderRadius"]),i=e.options.borderRadius,l=_g(i),a=Math.min(t,n),o=e.borderSkipped,f=r||qs(i);return{topLeft:lm(!f||o.top||o.left,l.topLeft,0,a),topRight:lm(!f||o.top||o.right,l.topRight,0,a),bottomLeft:lm(!f||o.bottom||o.left,l.bottomLeft,0,a),bottomRight:lm(!f||o.bottom||o.right,l.bottomRight,0,a)}}function cQ(e){const t=XI(e),n=t.right-t.left,r=t.bottom-t.top,i=lQ(e,n/2,r/2),l=uQ(e,n/2,r/2);return{outer:{x:t.left,y:t.top,w:n,h:r,radius:l},inner:{x:t.left+i.l,y:t.top+i.t,w:n-i.l-i.r,h:r-i.t-i.b,radius:{topLeft:Math.max(0,l.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,l.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,l.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,l.bottomRight-Math.max(i.b,i.r))}}}}function d4(e,t,n,r){const i=t===null,l=n===null,o=e&&!(i&&l)&&XI(e,r);return o&&(i||pp(t,o.left,o.right))&&(l||pp(n,o.top,o.bottom))}function hQ(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}function dQ(e,t){e.rect(t.x,t.y,t.w,t.h)}function f4(e,t,n={}){const r=e.x!==n.x?-t:0,i=e.y!==n.y?-t:0,l=(e.x+e.w!==n.x+n.w?t:0)-r,a=(e.y+e.h!==n.y+n.h?t:0)-i;return{x:e.x+r,y:e.y+i,w:e.w+l,h:e.h+a,radius:e.radius}}class wx extends Cp{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:n,options:{borderColor:r,backgroundColor:i}}=this,{inner:l,outer:a}=cQ(this),o=hQ(a.radius)?T_:dQ;t.save(),(a.w!==l.w||a.h!==l.h)&&(t.beginPath(),o(t,f4(a,n,l)),t.clip(),o(t,f4(l,-n,a)),t.fillStyle=r,t.fill("evenodd")),t.beginPath(),o(t,f4(l,n)),t.fillStyle=i,t.fill(),t.restore()}inRange(t,n,r){return d4(this,t,n,r)}inXRange(t,n){return d4(this,t,null,n)}inYRange(t,n){return d4(this,null,t,n)}getCenterPoint(t){const{x:n,y:r,base:i,horizontal:l}=this.getProps(["x","y","base","horizontal"],t);return{x:l?(n+i)/2:n,y:l?r:(r+i)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}un(wx,"id","bar"),un(wx,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),un(wx,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var fQ=Object.freeze({__proto__:null,ArcElement:Dv,BarElement:wx,LineElement:am,PointElement:xx});const S3=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],OE=S3.map(e=>e.replace("rgb(","rgba(").replace(")",", 0.5)"));function JI(e){return S3[e%S3.length]}function QI(e){return OE[e%OE.length]}function pQ(e,t){return e.borderColor=JI(t),e.backgroundColor=QI(t),++t}function mQ(e,t){return e.backgroundColor=e.data.map(()=>JI(t++)),t}function gQ(e,t){return e.backgroundColor=e.data.map(()=>QI(t++)),t}function yQ(e){let t=0;return(n,r)=>{const i=e.getDatasetMeta(r).controller;i instanceof hg?t=mQ(n,t):i instanceof s_?t=gQ(n,t):i&&(t=pQ(n,t))}}function RE(e){let t;for(t in e)if(e[t].borderColor||e[t].backgroundColor)return!0;return!1}function vQ(e){return e&&(e.borderColor||e.backgroundColor)}var _Q={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(e,t,n){if(!n.enabled)return;const{data:{datasets:r},options:i}=e.config,{elements:l}=i;if(!n.forceOverride&&(RE(r)||vQ(i)||l&&RE(l)))return;const a=yQ(e);r.forEach(a)}};function bQ(e,t,n,r,i){const l=i.samples||r;if(l>=n)return e.slice(t,t+n);const a=[],o=(n-2)/(l-2);let f=0;const m=t+n-1;let _=t,w,M,C,R,z;for(a[f++]=e[_],w=0;w<l-2;w++){let W=0,X=0,Y;const Q=Math.floor((w+1)*o)+1+t,oe=Math.min(Math.floor((w+2)*o)+1,n)+t,le=oe-Q;for(Y=Q;Y<oe;Y++)W+=e[Y].x,X+=e[Y].y;W/=le,X/=le;const me=Math.floor(w*o)+1+t,we=Math.min(Math.floor((w+1)*o)+1,n)+t,{x:ue,y:_e}=e[_];for(C=R=-1,Y=me;Y<we;Y++)R=.5*Math.abs((ue-W)*(e[Y].y-_e)-(ue-e[Y].x)*(X-_e)),R>C&&(C=R,M=e[Y],z=Y);a[f++]=M,_=z}return a[f++]=e[m],a}function xQ(e,t,n,r){let i=0,l=0,a,o,f,m,_,w,M,C,R,z;const W=[],X=t+n-1,Y=e[t].x,oe=e[X].x-Y;for(a=t;a<t+n;++a){o=e[a],f=(o.x-Y)/oe*r,m=o.y;const le=f|0;if(le===_)m<R?(R=m,w=a):m>z&&(z=m,M=a),i=(l*i+o.x)/++l;else{const me=a-1;if(!go(w)&&!go(M)){const we=Math.min(w,M),ue=Math.max(w,M);we!==C&&we!==me&&W.push({...e[we],x:i}),ue!==C&&ue!==me&&W.push({...e[ue],x:i})}a>0&&me!==C&&W.push(e[me]),W.push(o),_=le,l=0,R=z=m,w=M=C=a}}return W}function e6(e){if(e._decimated){const t=e._data;delete e._decimated,delete e._data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function BE(e){e.data.datasets.forEach(t=>{e6(t)})}function wQ(e,t){const n=t.length;let r=0,i;const{iScale:l}=e,{min:a,max:o,minDefined:f,maxDefined:m}=l.getUserBounds();return f&&(r=bc(mp(t,l.axis,a).lo,0,n-1)),m?i=bc(mp(t,l.axis,o).hi+1,r,n)-r:i=n-r,{start:r,count:i}}var CQ={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(e,t,n)=>{if(!n.enabled){BE(e);return}const r=e.width;e.data.datasets.forEach((i,l)=>{const{_data:a,indexAxis:o}=i,f=e.getDatasetMeta(l),m=a||i.data;if(kv([o,e.options.indexAxis])==="y"||!f.controller.supportsDecimation)return;const _=e.scales[f.xAxisID];if(_.type!=="linear"&&_.type!=="time"||e.options.parsing)return;let{start:w,count:M}=wQ(f,m);const C=n.threshold||4*r;if(M<=C){e6(i);return}go(a)&&(i._data=m,delete i.data,Object.defineProperty(i,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(z){this._data=z}}));let R;switch(n.algorithm){case"lttb":R=bQ(m,w,M,r,n);break;case"min-max":R=xQ(m,w,M,r);break;default:throw new Error(`Unsupported decimation algorithm '${n.algorithm}'`)}i._decimated=R})},destroy(e){BE(e)}};function SQ(e,t,n){const r=e.segments,i=e.points,l=t.points,a=[];for(const o of r){let{start:f,end:m}=o;m=QC(f,m,i);const _=L3(n,i[f],i[m],o.loop);if(!t.segments){a.push({source:o,target:_,start:i[f],end:i[m]});continue}const w=RI(t,_);for(const M of w){const C=L3(n,l[M.start],l[M.end],M.loop),R=OI(o,i,C);for(const z of R)a.push({source:z,target:M,start:{[n]:NE(_,C,"start",Math.max)},end:{[n]:NE(_,C,"end",Math.min)}})}}return a}function L3(e,t,n,r){if(r)return;let i=t[e],l=n[e];return e==="angle"&&(i=fd(i),l=fd(l)),{property:e,start:i,end:l}}function LQ(e,t){const{x:n=null,y:r=null}=e||{},i=t.points,l=[];return t.segments.forEach(({start:a,end:o})=>{o=QC(a,o,i);const f=i[a],m=i[o];r!==null?(l.push({x:f.x,y:r}),l.push({x:m.x,y:r})):n!==null&&(l.push({x:n,y:f.y}),l.push({x:n,y:m.y}))}),l}function QC(e,t,n){for(;t>e;t--){const r=n[t];if(!isNaN(r.x)&&!isNaN(r.y))break}return t}function NE(e,t,n,r){return e&&t?r(e[n],t[n]):e?e[n]:t?t[n]:0}function t6(e,t){let n=[],r=!1;return pl(e)?(r=!0,n=e):n=LQ(e,t),n.length?new am({points:n,options:{tension:0},_loop:r,_fullLoop:r}):null}function FE(e){return e&&e.fill!==!1}function PQ(e,t,n){let i=e[t].fill;const l=[t];let a;if(!n)return i;for(;i!==!1&&l.indexOf(i)===-1;){if(!iu(i))return i;if(a=e[i],!a)return!1;if(a.visible)return i;l.push(i),i=a.fill}return!1}function EQ(e,t,n){const r=kQ(e);if(qs(r))return isNaN(r.value)?!1:r;let i=parseFloat(r);return iu(i)&&Math.floor(i)===i?MQ(r[0],t,i,n):["origin","start","end","stack","shape"].indexOf(r)>=0&&r}function MQ(e,t,n,r){return(e==="-"||e==="+")&&(n=t+n),n===t||n<0||n>=r?!1:n}function TQ(e,t){let n=null;return e==="start"?n=t.bottom:e==="end"?n=t.top:qs(e)?n=t.getPixelForValue(e.value):t.getBasePixel&&(n=t.getBasePixel()),n}function AQ(e,t,n){let r;return e==="start"?r=n:e==="end"?r=t.options.reverse?t.min:t.max:qs(e)?r=e.value:r=t.getBaseValue(),r}function kQ(e){const t=e.options,n=t.fill;let r=Es(n&&n.target,n);return r===void 0&&(r=!!t.backgroundColor),r===!1||r===null?!1:r===!0?"origin":r}function IQ(e){const{scale:t,index:n,line:r}=e,i=[],l=r.segments,a=r.points,o=DQ(t,n);o.push(t6({x:null,y:t.bottom},r));for(let f=0;f<l.length;f++){const m=l[f];for(let _=m.start;_<=m.end;_++)OQ(i,a[_],o)}return new am({points:i,options:{}})}function DQ(e,t){const n=[],r=e.getMatchingVisibleMetas("line");for(let i=0;i<r.length;i++){const l=r[i];if(l.index===t)break;l.hidden||n.unshift(l.dataset)}return n}function OQ(e,t,n){const r=[];for(let i=0;i<n.length;i++){const l=n[i],{first:a,last:o,point:f}=RQ(l,t,"x");if(!(!f||a&&o)){if(a)r.unshift(f);else if(e.push(f),!o)break}}e.push(...r)}function RQ(e,t,n){const r=e.interpolate(t,n);if(!r)return{};const i=r[n],l=e.segments,a=e.points;let o=!1,f=!1;for(let m=0;m<l.length;m++){const _=l[m],w=a[_.start][n],M=a[_.end][n];if(pp(i,w,M)){o=i===w,f=i===M;break}}return{first:o,last:f,point:r}}class n6{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,n,r){const{x:i,y:l,radius:a}=this;return n=n||{start:0,end:Ya},t.arc(i,l,a,n.end,n.start,!0),!r.bounds}interpolate(t){const{x:n,y:r,radius:i}=this,l=t.angle;return{x:n+Math.cos(l)*i,y:r+Math.sin(l)*i,angle:l}}}function BQ(e){const{chart:t,fill:n,line:r}=e;if(iu(n))return NQ(t,n);if(n==="stack")return IQ(e);if(n==="shape")return!0;const i=FQ(e);return i instanceof n6?i:t6(i,r)}function NQ(e,t){const n=e.getDatasetMeta(t);return n&&e.isDatasetVisible(t)?n.dataset:null}function FQ(e){return(e.scale||{}).getPointPositionForValue?jQ(e):zQ(e)}function zQ(e){const{scale:t={},fill:n}=e,r=TQ(n,t);if(iu(r)){const i=t.isHorizontal();return{x:i?r:null,y:i?null:r}}return null}function jQ(e){const{scale:t,fill:n}=e,r=t.options,i=t.getLabels().length,l=r.reverse?t.max:t.min,a=AQ(n,t,l),o=[];if(r.grid.circular){const f=t.getPointPositionForValue(0,l);return new n6({x:f.x,y:f.y,radius:t.getDistanceFromCenterForValue(a)})}for(let f=0;f<i;++f)o.push(t.getPointPositionForValue(f,a));return o}function p4(e,t,n){const r=BQ(t),{line:i,scale:l,axis:a}=t,o=i.options,f=o.fill,m=o.backgroundColor,{above:_=m,below:w=m}=f||{};r&&i.points.length&&(q2(e,n),UQ(e,{line:i,target:r,above:_,below:w,area:n,scale:l,axis:a}),W2(e))}function UQ(e,t){const{line:n,target:r,above:i,below:l,area:a,scale:o}=t,f=n._loop?"angle":t.axis;e.save(),f==="x"&&l!==i&&(zE(e,r,a.top),jE(e,{line:n,target:r,color:i,scale:o,property:f}),e.restore(),e.save(),zE(e,r,a.bottom)),jE(e,{line:n,target:r,color:l,scale:o,property:f}),e.restore()}function zE(e,t,n){const{segments:r,points:i}=t;let l=!0,a=!1;e.beginPath();for(const o of r){const{start:f,end:m}=o,_=i[f],w=i[QC(f,m,i)];l?(e.moveTo(_.x,_.y),l=!1):(e.lineTo(_.x,n),e.lineTo(_.x,_.y)),a=!!t.pathSegment(e,o,{move:a}),a?e.closePath():e.lineTo(w.x,n)}e.lineTo(t.first().x,n),e.closePath(),e.clip()}function jE(e,t){const{line:n,target:r,property:i,color:l,scale:a}=t,o=SQ(n,r,i);for(const{source:f,target:m,start:_,end:w}of o){const{style:{backgroundColor:M=l}={}}=f,C=r!==!0;e.save(),e.fillStyle=M,VQ(e,a,C&&L3(i,_,w)),e.beginPath();const R=!!n.pathSegment(e,f);let z;if(C){R?e.closePath():UE(e,r,w,i);const W=!!r.pathSegment(e,m,{move:R,reverse:!0});z=R&&W,z||UE(e,r,_,i)}e.closePath(),e.fill(z?"evenodd":"nonzero"),e.restore()}}function VQ(e,t,n){const{top:r,bottom:i}=t.chart.chartArea,{property:l,start:a,end:o}=n||{};l==="x"&&(e.beginPath(),e.rect(a,r,o-a,i-r),e.clip())}function UE(e,t,n,r){const i=t.interpolate(n,r);i&&e.lineTo(i.x,i.y)}var $Q={id:"filler",afterDatasetsUpdate(e,t,n){const r=(e.data.datasets||[]).length,i=[];let l,a,o,f;for(a=0;a<r;++a)l=e.getDatasetMeta(a),o=l.dataset,f=null,o&&o.options&&o instanceof am&&(f={visible:e.isDatasetVisible(a),index:a,fill:EQ(o,a,r),chart:e,axis:l.controller.options.indexAxis,scale:l.vScale,line:o}),l.$filler=f,i.push(f);for(a=0;a<r;++a)f=i[a],!(!f||f.fill===!1)&&(f.fill=PQ(i,a,n.propagate))},beforeDraw(e,t,n){const r=n.drawTime==="beforeDraw",i=e.getSortedVisibleDatasetMetas(),l=e.chartArea;for(let a=i.length-1;a>=0;--a){const o=i[a].$filler;o&&(o.line.updateControlPoints(l,o.axis),r&&o.fill&&p4(e.ctx,o,l))}},beforeDatasetsDraw(e,t,n){if(n.drawTime!=="beforeDatasetsDraw")return;const r=e.getSortedVisibleDatasetMetas();for(let i=r.length-1;i>=0;--i){const l=r[i].$filler;FE(l)&&p4(e.ctx,l,e.chartArea)}},beforeDatasetDraw(e,t,n){const r=t.meta.$filler;!FE(r)||n.drawTime!=="beforeDatasetDraw"||p4(e.ctx,r,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const VE=(e,t)=>{let{boxHeight:n=t,boxWidth:r=t}=e;return e.usePointStyle&&(n=Math.min(n,t),r=e.pointStyleWidth||Math.min(r,t)),{boxWidth:r,boxHeight:n,itemHeight:Math.max(t,n)}},GQ=(e,t)=>e!==null&&t!==null&&e.datasetIndex===t.datasetIndex&&e.index===t.index;class $E extends Cp{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n,r){this.maxWidth=t,this.maxHeight=n,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let n=Na(t.generateLabels,[this.chart],this)||[];t.filter&&(n=n.filter(r=>t.filter(r,this.chart.data))),t.sort&&(n=n.sort((r,i)=>t.sort(r,i,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:t,ctx:n}=this;if(!t.display){this.width=this.height=0;return}const r=t.labels,i=cc(r.font),l=i.size,a=this._computeTitleHeight(),{boxWidth:o,itemHeight:f}=VE(r,l);let m,_;n.font=i.string,this.isHorizontal()?(m=this.maxWidth,_=this._fitRows(a,l,o,f)+10):(_=this.maxHeight,m=this._fitCols(a,i,o,f)+10),this.width=Math.min(m,t.maxWidth||this.maxWidth),this.height=Math.min(_,t.maxHeight||this.maxHeight)}_fitRows(t,n,r,i){const{ctx:l,maxWidth:a,options:{labels:{padding:o}}}=this,f=this.legendHitBoxes=[],m=this.lineWidths=[0],_=i+o;let w=t;l.textAlign="left",l.textBaseline="middle";let M=-1,C=-_;return this.legendItems.forEach((R,z)=>{const W=r+n/2+l.measureText(R.text).width;(z===0||m[m.length-1]+W+2*o>a)&&(w+=_,m[m.length-(z>0?0:1)]=0,C+=_,M++),f[z]={left:0,top:C,row:M,width:W,height:i},m[m.length-1]+=W+o}),w}_fitCols(t,n,r,i){const{ctx:l,maxHeight:a,options:{labels:{padding:o}}}=this,f=this.legendHitBoxes=[],m=this.columnSizes=[],_=a-t;let w=o,M=0,C=0,R=0,z=0;return this.legendItems.forEach((W,X)=>{const{itemWidth:Y,itemHeight:Q}=HQ(r,n,l,W,i);X>0&&C+Q+2*o>_&&(w+=M+o,m.push({width:M,height:C}),R+=M+o,z++,M=C=0),f[X]={left:R,top:C,col:z,width:Y,height:Q},M=Math.max(M,Y),C+=Q+o}),w+=M,m.push({width:M,height:C}),w}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:r,labels:{padding:i},rtl:l}}=this,a=z0(l,this.left,this.width);if(this.isHorizontal()){let o=0,f=Xc(r,this.left+i,this.right-this.lineWidths[o]);for(const m of n)o!==m.row&&(o=m.row,f=Xc(r,this.left+i,this.right-this.lineWidths[o])),m.top+=this.top+t+i,m.left=a.leftForLtr(a.x(f),m.width),f+=m.width+i}else{let o=0,f=Xc(r,this.top+t+i,this.bottom-this.columnSizes[o].height);for(const m of n)m.col!==o&&(o=m.col,f=Xc(r,this.top+t+i,this.bottom-this.columnSizes[o].height)),m.top=f,m.left+=this.left+i,m.left=a.leftForLtr(a.x(m.left),m.width),f+=m.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;q2(t,this),this._draw(),W2(t)}}_draw(){const{options:t,columnSizes:n,lineWidths:r,ctx:i}=this,{align:l,labels:a}=t,o=su.color,f=z0(t.rtl,this.left,this.width),m=cc(a.font),{padding:_}=a,w=m.size,M=w/2;let C;this.drawTitle(),i.textAlign=f.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=m.string;const{boxWidth:R,boxHeight:z,itemHeight:W}=VE(a,w),X=function(me,we,ue){if(isNaN(R)||R<=0||isNaN(z)||z<0)return;i.save();const _e=Es(ue.lineWidth,1);if(i.fillStyle=Es(ue.fillStyle,o),i.lineCap=Es(ue.lineCap,"butt"),i.lineDashOffset=Es(ue.lineDashOffset,0),i.lineJoin=Es(ue.lineJoin,"miter"),i.lineWidth=_e,i.strokeStyle=Es(ue.strokeStyle,o),i.setLineDash(Es(ue.lineDash,[])),a.usePointStyle){const We={radius:z*Math.SQRT2/2,pointStyle:ue.pointStyle,rotation:ue.rotation,borderWidth:_e},he=f.xPlus(me,R/2),de=we+M;CI(i,We,he,de,a.pointStyleWidth&&R)}else{const We=we+Math.max((w-z)/2,0),he=f.leftForLtr(me,R),de=_g(ue.borderRadius);i.beginPath(),Object.values(de).some(Te=>Te!==0)?T_(i,{x:he,y:We,w:R,h:z,radius:de}):i.rect(he,We,R,z),i.fill(),_e!==0&&i.stroke()}i.restore()},Y=function(me,we,ue){Lg(i,ue.text,me,we+W/2,m,{strikethrough:ue.hidden,textAlign:f.textAlign(ue.textAlign)})},Q=this.isHorizontal(),oe=this._computeTitleHeight();Q?C={x:Xc(l,this.left+_,this.right-r[0]),y:this.top+_+oe,line:0}:C={x:this.left+_,y:Xc(l,this.top+oe+_,this.bottom-n[0].height),line:0},kI(this.ctx,t.textDirection);const le=W+_;this.legendItems.forEach((me,we)=>{i.strokeStyle=me.fontColor,i.fillStyle=me.fontColor;const ue=i.measureText(me.text).width,_e=f.textAlign(me.textAlign||(me.textAlign=a.textAlign)),We=R+M+ue;let he=C.x,de=C.y;f.setWidth(this.width),Q?we>0&&he+We+_>this.right&&(de=C.y+=le,C.line++,he=C.x=Xc(l,this.left+_,this.right-r[C.line])):we>0&&de+le>this.bottom&&(he=C.x=he+n[C.line].width+_,C.line++,de=C.y=Xc(l,this.top+oe+_,this.bottom-n[C.line].height));const Te=f.x(he);if(X(Te,de,me),he=fY(_e,he+R+M,Q?he+We:this.right,t.rtl),Y(f.x(he),de,me),Q)C.x+=We+_;else if(typeof me.text!="string"){const be=m.lineHeight;C.y+=r6(me,be)+_}else C.y+=le}),II(this.ctx,t.textDirection)}drawTitle(){const t=this.options,n=t.title,r=cc(n.font),i=oh(n.padding);if(!n.display)return;const l=z0(t.rtl,this.left,this.width),a=this.ctx,o=n.position,f=r.size/2,m=i.top+f;let _,w=this.left,M=this.width;if(this.isHorizontal())M=Math.max(...this.lineWidths),_=this.top+m,w=Xc(t.align,w,this.right-M);else{const R=this.columnSizes.reduce((z,W)=>Math.max(z,W.height),0);_=m+Xc(t.align,this.top,this.bottom-R-t.labels.padding-this._computeTitleHeight())}const C=Xc(o,w,w+M);a.textAlign=l.textAlign(GC(o)),a.textBaseline="middle",a.strokeStyle=n.color,a.fillStyle=n.color,a.font=r.string,Lg(a,n.text,C,_,r)}_computeTitleHeight(){const t=this.options.title,n=cc(t.font),r=oh(t.padding);return t.display?n.lineHeight+r.height:0}_getLegendItemAt(t,n){let r,i,l;if(pp(t,this.left,this.right)&&pp(n,this.top,this.bottom)){for(l=this.legendHitBoxes,r=0;r<l.length;++r)if(i=l[r],pp(t,i.left,i.left+i.width)&&pp(n,i.top,i.top+i.height))return this.legendItems[r]}return null}handleEvent(t){const n=this.options;if(!ZQ(t.type,n))return;const r=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const i=this._hoveredItem,l=GQ(i,r);i&&!l&&Na(n.onLeave,[t,i,this],this),this._hoveredItem=r,r&&!l&&Na(n.onHover,[t,r,this],this)}else r&&Na(n.onClick,[t,r,this],this)}}function HQ(e,t,n,r,i){const l=qQ(r,e,t,n),a=WQ(i,r,t.lineHeight);return{itemWidth:l,itemHeight:a}}function qQ(e,t,n,r){let i=e.text;return i&&typeof i!="string"&&(i=i.reduce((l,a)=>l.length>a.length?l:a)),t+n.size/2+r.measureText(i).width}function WQ(e,t,n){let r=e;return typeof t.text!="string"&&(r=r6(t,n)),r}function r6(e,t){const n=e.text?e.text.length:0;return t*n}function ZQ(e,t){return!!((e==="mousemove"||e==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(e==="click"||e==="mouseup"))}var KQ={id:"legend",_element:$E,start(e,t,n){const r=e.legend=new $E({ctx:e.ctx,options:n,chart:e});ih.configure(e,r,n),ih.addBox(e,r)},stop(e){ih.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){const r=e.legend;ih.configure(e,r,n),r.options=n},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){const r=t.datasetIndex,i=n.chart;i.isDatasetVisible(r)?(i.hide(r),t.hidden=!0):(i.show(r),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:r,textAlign:i,color:l,useBorderRadius:a,borderRadius:o}}=e.legend.options;return e._getSortedDatasetMetas().map(f=>{const m=f.controller.getStyle(n?0:void 0),_=oh(m.borderWidth);return{text:t[f.index].label,fillStyle:m.backgroundColor,fontColor:l,hidden:!f.visible,lineCap:m.borderCapStyle,lineDash:m.borderDash,lineDashOffset:m.borderDashOffset,lineJoin:m.borderJoinStyle,lineWidth:(_.width+_.height)/4,strokeStyle:m.borderColor,pointStyle:r||m.pointStyle,rotation:m.rotation,textAlign:i||m.textAlign,borderRadius:a&&(o||m.borderRadius),datasetIndex:f.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class eS extends Cp{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n){const r=this.options;if(this.left=0,this.top=0,!r.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=n;const i=pl(r.text)?r.text.length:1;this._padding=oh(r.padding);const l=i*cc(r.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=l:this.width=l}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:n,left:r,bottom:i,right:l,options:a}=this,o=a.align;let f=0,m,_,w;return this.isHorizontal()?(_=Xc(o,r,l),w=n+t,m=l-r):(a.position==="left"?(_=r+t,w=Xc(o,i,n),f=Xa*-.5):(_=l-t,w=Xc(o,n,i),f=Xa*.5),m=i-n),{titleX:_,titleY:w,maxWidth:m,rotation:f}}draw(){const t=this.ctx,n=this.options;if(!n.display)return;const r=cc(n.font),l=r.lineHeight/2+this._padding.top,{titleX:a,titleY:o,maxWidth:f,rotation:m}=this._drawArgs(l);Lg(t,n.text,0,0,r,{color:n.color,maxWidth:f,rotation:m,textAlign:GC(n.align),textBaseline:"middle",translation:[a,o]})}}function YQ(e,t){const n=new eS({ctx:e.ctx,options:t,chart:e});ih.configure(e,n,t),ih.addBox(e,n),e.titleBlock=n}var XQ={id:"title",_element:eS,start(e,t,n){YQ(e,n)},stop(e){const t=e.titleBlock;ih.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,n){const r=e.titleBlock;ih.configure(e,r,n),r.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Vb=new WeakMap;var JQ={id:"subtitle",start(e,t,n){const r=new eS({ctx:e.ctx,options:n,chart:e});ih.configure(e,r,n),ih.addBox(e,r),Vb.set(e,r)},stop(e){ih.removeBox(e,Vb.get(e)),Vb.delete(e)},beforeUpdate(e,t,n){const r=Vb.get(e);ih.configure(e,r,n),r.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Ov={average(e){if(!e.length)return!1;let t,n,r=0,i=0,l=0;for(t=0,n=e.length;t<n;++t){const a=e[t].element;if(a&&a.hasValue()){const o=a.tooltipPosition();r+=o.x,i+=o.y,++l}}return{x:r/l,y:i/l}},nearest(e,t){if(!e.length)return!1;let n=t.x,r=t.y,i=Number.POSITIVE_INFINITY,l,a,o;for(l=0,a=e.length;l<a;++l){const f=e[l].element;if(f&&f.hasValue()){const m=f.getCenterPoint(),_=y3(t,m);_<i&&(i=_,o=f)}}if(o){const f=o.tooltipPosition();n=f.x,r=f.y}return{x:n,y:r}}};function Pf(e,t){return t&&(pl(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function lp(e){return(typeof e=="string"||e instanceof String)&&e.indexOf(`
`)>-1?e.split(`
`):e}function QQ(e,t){const{element:n,datasetIndex:r,index:i}=t,l=e.getDatasetMeta(r).controller,{label:a,value:o}=l.getLabelAndValue(i);return{chart:e,label:a,parsed:l.getParsed(i),raw:e.data.datasets[r].data[i],formattedValue:o,dataset:l.getDataset(),dataIndex:i,datasetIndex:r,element:n}}function GE(e,t){const n=e.chart.ctx,{body:r,footer:i,title:l}=e,{boxWidth:a,boxHeight:o}=t,f=cc(t.bodyFont),m=cc(t.titleFont),_=cc(t.footerFont),w=l.length,M=i.length,C=r.length,R=oh(t.padding);let z=R.height,W=0,X=r.reduce((oe,le)=>oe+le.before.length+le.lines.length+le.after.length,0);if(X+=e.beforeBody.length+e.afterBody.length,w&&(z+=w*m.lineHeight+(w-1)*t.titleSpacing+t.titleMarginBottom),X){const oe=t.displayColors?Math.max(o,f.lineHeight):f.lineHeight;z+=C*oe+(X-C)*f.lineHeight+(X-1)*t.bodySpacing}M&&(z+=t.footerMarginTop+M*_.lineHeight+(M-1)*t.footerSpacing);let Y=0;const Q=function(oe){W=Math.max(W,n.measureText(oe).width+Y)};return n.save(),n.font=m.string,Yo(e.title,Q),n.font=f.string,Yo(e.beforeBody.concat(e.afterBody),Q),Y=t.displayColors?a+2+t.boxPadding:0,Yo(r,oe=>{Yo(oe.before,Q),Yo(oe.lines,Q),Yo(oe.after,Q)}),Y=0,n.font=_.string,Yo(e.footer,Q),n.restore(),W+=R.width,{width:W,height:z}}function eee(e,t){const{y:n,height:r}=t;return n<r/2?"top":n>e.height-r/2?"bottom":"center"}function tee(e,t,n,r){const{x:i,width:l}=r,a=n.caretSize+n.caretPadding;if(e==="left"&&i+l+a>t.width||e==="right"&&i-l-a<0)return!0}function nee(e,t,n,r){const{x:i,width:l}=n,{width:a,chartArea:{left:o,right:f}}=e;let m="center";return r==="center"?m=i<=(o+f)/2?"left":"right":i<=l/2?m="left":i>=a-l/2&&(m="right"),tee(m,e,t,n)&&(m="center"),m}function HE(e,t,n){const r=n.yAlign||t.yAlign||eee(e,n);return{xAlign:n.xAlign||t.xAlign||nee(e,t,n,r),yAlign:r}}function ree(e,t){let{x:n,width:r}=e;return t==="right"?n-=r:t==="center"&&(n-=r/2),n}function iee(e,t,n){let{y:r,height:i}=e;return t==="top"?r+=n:t==="bottom"?r-=i+n:r-=i/2,r}function qE(e,t,n,r){const{caretSize:i,caretPadding:l,cornerRadius:a}=e,{xAlign:o,yAlign:f}=n,m=i+l,{topLeft:_,topRight:w,bottomLeft:M,bottomRight:C}=_g(a);let R=ree(t,o);const z=iee(t,f,m);return f==="center"?o==="left"?R+=m:o==="right"&&(R-=m):o==="left"?R-=Math.max(_,M)+i:o==="right"&&(R+=Math.max(w,C)+i),{x:bc(R,0,r.width-t.width),y:bc(z,0,r.height-t.height)}}function $b(e,t,n){const r=oh(n.padding);return t==="center"?e.x+e.width/2:t==="right"?e.x+e.width-r.right:e.x+r.left}function WE(e){return Pf([],lp(e))}function see(e,t,n){return Cm(e,{tooltip:t,tooltipItems:n,type:"tooltip"})}function ZE(e,t){const n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}const i6={beforeTitle:sp,title(e){if(e.length>0){const t=e[0],n=t.chart.data.labels,r=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(r>0&&t.dataIndex<r)return n[t.dataIndex]}return""},afterTitle:sp,beforeBody:sp,beforeLabel:sp,label(e){if(this&&this.options&&this.options.mode==="dataset")return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const n=e.formattedValue;return go(n)||(t+=n),t},labelColor(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:sp,afterBody:sp,beforeFooter:sp,footer:sp,afterFooter:sp};function Nh(e,t,n,r){const i=e[t].call(n,r);return typeof i>"u"?i6[t].call(n,r):i}class P3 extends Cp{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const n=this.chart,r=this.options.setContext(this.getContext()),i=r.enabled&&n.options.animation&&r.animations,l=new BI(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(l)),l}getContext(){return this.$context||(this.$context=see(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,n){const{callbacks:r}=n,i=Nh(r,"beforeTitle",this,t),l=Nh(r,"title",this,t),a=Nh(r,"afterTitle",this,t);let o=[];return o=Pf(o,lp(i)),o=Pf(o,lp(l)),o=Pf(o,lp(a)),o}getBeforeBody(t,n){return WE(Nh(n.callbacks,"beforeBody",this,t))}getBody(t,n){const{callbacks:r}=n,i=[];return Yo(t,l=>{const a={before:[],lines:[],after:[]},o=ZE(r,l);Pf(a.before,lp(Nh(o,"beforeLabel",this,l))),Pf(a.lines,Nh(o,"label",this,l)),Pf(a.after,lp(Nh(o,"afterLabel",this,l))),i.push(a)}),i}getAfterBody(t,n){return WE(Nh(n.callbacks,"afterBody",this,t))}getFooter(t,n){const{callbacks:r}=n,i=Nh(r,"beforeFooter",this,t),l=Nh(r,"footer",this,t),a=Nh(r,"afterFooter",this,t);let o=[];return o=Pf(o,lp(i)),o=Pf(o,lp(l)),o=Pf(o,lp(a)),o}_createItems(t){const n=this._active,r=this.chart.data,i=[],l=[],a=[];let o=[],f,m;for(f=0,m=n.length;f<m;++f)o.push(QQ(this.chart,n[f]));return t.filter&&(o=o.filter((_,w,M)=>t.filter(_,w,M,r))),t.itemSort&&(o=o.sort((_,w)=>t.itemSort(_,w,r))),Yo(o,_=>{const w=ZE(t.callbacks,_);i.push(Nh(w,"labelColor",this,_)),l.push(Nh(w,"labelPointStyle",this,_)),a.push(Nh(w,"labelTextColor",this,_))}),this.labelColors=i,this.labelPointStyles=l,this.labelTextColors=a,this.dataPoints=o,o}update(t,n){const r=this.options.setContext(this.getContext()),i=this._active;let l,a=[];if(!i.length)this.opacity!==0&&(l={opacity:0});else{const o=Ov[r.position].call(this,i,this._eventPosition);a=this._createItems(r),this.title=this.getTitle(a,r),this.beforeBody=this.getBeforeBody(a,r),this.body=this.getBody(a,r),this.afterBody=this.getAfterBody(a,r),this.footer=this.getFooter(a,r);const f=this._size=GE(this,r),m=Object.assign({},o,f),_=HE(this.chart,r,m),w=qE(r,m,_,this.chart);this.xAlign=_.xAlign,this.yAlign=_.yAlign,l={opacity:1,x:w.x,y:w.y,width:f.width,height:f.height,caretX:o.x,caretY:o.y}}this._tooltipItems=a,this.$context=void 0,l&&this._resolveAnimations().update(this,l),t&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(t,n,r,i){const l=this.getCaretPosition(t,r,i);n.lineTo(l.x1,l.y1),n.lineTo(l.x2,l.y2),n.lineTo(l.x3,l.y3)}getCaretPosition(t,n,r){const{xAlign:i,yAlign:l}=this,{caretSize:a,cornerRadius:o}=r,{topLeft:f,topRight:m,bottomLeft:_,bottomRight:w}=_g(o),{x:M,y:C}=t,{width:R,height:z}=n;let W,X,Y,Q,oe,le;return l==="center"?(oe=C+z/2,i==="left"?(W=M,X=W-a,Q=oe+a,le=oe-a):(W=M+R,X=W+a,Q=oe-a,le=oe+a),Y=W):(i==="left"?X=M+Math.max(f,_)+a:i==="right"?X=M+R-Math.max(m,w)-a:X=this.caretX,l==="top"?(Q=C,oe=Q-a,W=X-a,Y=X+a):(Q=C+z,oe=Q+a,W=X+a,Y=X-a),le=Q),{x1:W,x2:X,x3:Y,y1:Q,y2:oe,y3:le}}drawTitle(t,n,r){const i=this.title,l=i.length;let a,o,f;if(l){const m=z0(r.rtl,this.x,this.width);for(t.x=$b(this,r.titleAlign,r),n.textAlign=m.textAlign(r.titleAlign),n.textBaseline="middle",a=cc(r.titleFont),o=r.titleSpacing,n.fillStyle=r.titleColor,n.font=a.string,f=0;f<l;++f)n.fillText(i[f],m.x(t.x),t.y+a.lineHeight/2),t.y+=a.lineHeight+o,f+1===l&&(t.y+=r.titleMarginBottom-o)}}_drawColorBox(t,n,r,i,l){const a=this.labelColors[r],o=this.labelPointStyles[r],{boxHeight:f,boxWidth:m}=l,_=cc(l.bodyFont),w=$b(this,"left",l),M=i.x(w),C=f<_.lineHeight?(_.lineHeight-f)/2:0,R=n.y+C;if(l.usePointStyle){const z={radius:Math.min(m,f)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},W=i.leftForLtr(M,m)+m/2,X=R+f/2;t.strokeStyle=l.multiKeyBackground,t.fillStyle=l.multiKeyBackground,_3(t,z,W,X),t.strokeStyle=a.borderColor,t.fillStyle=a.backgroundColor,_3(t,z,W,X)}else{t.lineWidth=qs(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,t.strokeStyle=a.borderColor,t.setLineDash(a.borderDash||[]),t.lineDashOffset=a.borderDashOffset||0;const z=i.leftForLtr(M,m),W=i.leftForLtr(i.xPlus(M,1),m-2),X=_g(a.borderRadius);Object.values(X).some(Y=>Y!==0)?(t.beginPath(),t.fillStyle=l.multiKeyBackground,T_(t,{x:z,y:R,w:m,h:f,radius:X}),t.fill(),t.stroke(),t.fillStyle=a.backgroundColor,t.beginPath(),T_(t,{x:W,y:R+1,w:m-2,h:f-2,radius:X}),t.fill()):(t.fillStyle=l.multiKeyBackground,t.fillRect(z,R,m,f),t.strokeRect(z,R,m,f),t.fillStyle=a.backgroundColor,t.fillRect(W,R+1,m-2,f-2))}t.fillStyle=this.labelTextColors[r]}drawBody(t,n,r){const{body:i}=this,{bodySpacing:l,bodyAlign:a,displayColors:o,boxHeight:f,boxWidth:m,boxPadding:_}=r,w=cc(r.bodyFont);let M=w.lineHeight,C=0;const R=z0(r.rtl,this.x,this.width),z=function(ue){n.fillText(ue,R.x(t.x+C),t.y+M/2),t.y+=M+l},W=R.textAlign(a);let X,Y,Q,oe,le,me,we;for(n.textAlign=a,n.textBaseline="middle",n.font=w.string,t.x=$b(this,W,r),n.fillStyle=r.bodyColor,Yo(this.beforeBody,z),C=o&&W!=="right"?a==="center"?m/2+_:m+2+_:0,oe=0,me=i.length;oe<me;++oe){for(X=i[oe],Y=this.labelTextColors[oe],n.fillStyle=Y,Yo(X.before,z),Q=X.lines,o&&Q.length&&(this._drawColorBox(n,t,oe,R,r),M=Math.max(w.lineHeight,f)),le=0,we=Q.length;le<we;++le)z(Q[le]),M=w.lineHeight;Yo(X.after,z)}C=0,M=w.lineHeight,Yo(this.afterBody,z),t.y-=l}drawFooter(t,n,r){const i=this.footer,l=i.length;let a,o;if(l){const f=z0(r.rtl,this.x,this.width);for(t.x=$b(this,r.footerAlign,r),t.y+=r.footerMarginTop,n.textAlign=f.textAlign(r.footerAlign),n.textBaseline="middle",a=cc(r.footerFont),n.fillStyle=r.footerColor,n.font=a.string,o=0;o<l;++o)n.fillText(i[o],f.x(t.x),t.y+a.lineHeight/2),t.y+=a.lineHeight+r.footerSpacing}}drawBackground(t,n,r,i){const{xAlign:l,yAlign:a}=this,{x:o,y:f}=t,{width:m,height:_}=r,{topLeft:w,topRight:M,bottomLeft:C,bottomRight:R}=_g(i.cornerRadius);n.fillStyle=i.backgroundColor,n.strokeStyle=i.borderColor,n.lineWidth=i.borderWidth,n.beginPath(),n.moveTo(o+w,f),a==="top"&&this.drawCaret(t,n,r,i),n.lineTo(o+m-M,f),n.quadraticCurveTo(o+m,f,o+m,f+M),a==="center"&&l==="right"&&this.drawCaret(t,n,r,i),n.lineTo(o+m,f+_-R),n.quadraticCurveTo(o+m,f+_,o+m-R,f+_),a==="bottom"&&this.drawCaret(t,n,r,i),n.lineTo(o+C,f+_),n.quadraticCurveTo(o,f+_,o,f+_-C),a==="center"&&l==="left"&&this.drawCaret(t,n,r,i),n.lineTo(o,f+w),n.quadraticCurveTo(o,f,o+w,f),n.closePath(),n.fill(),i.borderWidth>0&&n.stroke()}_updateAnimationTarget(t){const n=this.chart,r=this.$animations,i=r&&r.x,l=r&&r.y;if(i||l){const a=Ov[t.position].call(this,this._active,this._eventPosition);if(!a)return;const o=this._size=GE(this,t),f=Object.assign({},a,this._size),m=HE(n,t,f),_=qE(t,f,m,n);(i._to!==_.x||l._to!==_.y)&&(this.xAlign=m.xAlign,this.yAlign=m.yAlign,this.width=o.width,this.height=o.height,this.caretX=a.x,this.caretY=a.y,this._resolveAnimations().update(this,_))}}_willRender(){return!!this.opacity}draw(t){const n=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(n);const i={width:this.width,height:this.height},l={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const a=oh(n.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&o&&(t.save(),t.globalAlpha=r,this.drawBackground(l,t,i,n),kI(t,n.textDirection),l.y+=a.top,this.drawTitle(l,t,n),this.drawBody(l,t,n),this.drawFooter(l,t,n),II(t,n.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,n){const r=this._active,i=t.map(({datasetIndex:o,index:f})=>{const m=this.chart.getDatasetMeta(o);if(!m)throw new Error("Cannot find a dataset at index "+o);return{datasetIndex:o,element:m.data[f],index:f}}),l=!Qx(r,i),a=this._positionChanged(i,n);(l||a)&&(this._active=i,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,n,r=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,l=this._active||[],a=this._getActiveElements(t,l,n,r),o=this._positionChanged(a,t),f=n||!Qx(a,l)||o;return f&&(this._active=a,(i.enabled||i.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,n))),f}_getActiveElements(t,n,r,i){const l=this.options;if(t.type==="mouseout")return[];if(!i)return n.filter(o=>this.chart.data.datasets[o.datasetIndex]&&this.chart.getDatasetMeta(o.datasetIndex).controller.getParsed(o.index)!==void 0);const a=this.chart.getElementsAtEventForMode(t,l.mode,l,r);return l.reverse&&a.reverse(),a}_positionChanged(t,n){const{caretX:r,caretY:i,options:l}=this,a=Ov[l.position].call(this,t,n);return a!==!1&&(r!==a.x||i!==a.y)}}un(P3,"positioners",Ov);var oee={id:"tooltip",_element:P3,positioners:Ov,afterInit(e,t,n){n&&(e.tooltip=new P3({chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const n={tooltip:t};if(e.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent(e,t){if(e.tooltip){const n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:i6},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>e!=="filter"&&e!=="itemSort"&&e!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},aee=Object.freeze({__proto__:null,Colors:_Q,Decimation:CQ,Filler:$Q,Legend:KQ,SubTitle:JQ,Title:XQ,Tooltip:oee});const lee=(e,t,n,r)=>(typeof t=="string"?(n=e.push(t)-1,r.unshift({index:n,label:t})):isNaN(t)&&(n=null),n);function uee(e,t,n,r){const i=e.indexOf(t);if(i===-1)return lee(e,t,n,r);const l=e.lastIndexOf(t);return i!==l?n:i}const cee=(e,t)=>e===null?null:bc(Math.round(e),0,t);function KE(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class E3 extends Ag{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const n=this._addedLabels;if(n.length){const r=this.getLabels();for(const{index:i,label:l}of n)r[i]===l&&r.splice(i,1);this._addedLabels=[]}super.init(t)}parse(t,n){if(go(t))return null;const r=this.getLabels();return n=isFinite(n)&&r[n]===t?n:uee(r,t,Es(n,t),this._addedLabels),cee(n,r.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:r,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(r=0),n||(i=this.getLabels().length-1)),this.min=r,this.max=i}buildTicks(){const t=this.min,n=this.max,r=this.options.offset,i=[];let l=this.getLabels();l=t===0&&n===l.length-1?l:l.slice(t,n+1),this._valueRange=Math.max(l.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let a=t;a<=n;a++)i.push({value:a});return i}getLabelForValue(t){return KE.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}un(E3,"id","category"),un(E3,"defaults",{ticks:{callback:KE}});function hee(e,t){const n=[],{bounds:i,step:l,min:a,max:o,precision:f,count:m,maxTicks:_,maxDigits:w,includeBounds:M}=e,C=l||1,R=_-1,{min:z,max:W}=t,X=!go(a),Y=!go(o),Q=!go(m),oe=(W-z)/(w+1);let le=$P((W-z)/R/C)*C,me,we,ue,_e;if(le<1e-14&&!X&&!Y)return[{value:z},{value:W}];_e=Math.ceil(W/le)-Math.floor(z/le),_e>R&&(le=$P(_e*le/R/C)*C),go(f)||(me=Math.pow(10,f),le=Math.ceil(le*me)/me),i==="ticks"?(we=Math.floor(z/le)*le,ue=Math.ceil(W/le)*le):(we=z,ue=W),X&&Y&&l&&oY((o-a)/l,le/1e3)?(_e=Math.round(Math.min((o-a)/le,_)),le=(o-a)/_e,we=a,ue=o):Q?(we=X?a:we,ue=Y?o:ue,_e=m-1,le=(ue-we)/_e):(_e=(ue-we)/le,n_(_e,Math.round(_e),le/1e3)?_e=Math.round(_e):_e=Math.ceil(_e));const We=Math.max(GP(le),GP(we));me=Math.pow(10,go(f)?We:f),we=Math.round(we*me)/me,ue=Math.round(ue*me)/me;let he=0;for(X&&(M&&we!==a?(n.push({value:a}),we<a&&he++,n_(Math.round((we+he*le)*me)/me,a,YE(a,oe,e))&&he++):we<a&&he++);he<_e;++he){const de=Math.round((we+he*le)*me)/me;if(Y&&de>o)break;n.push({value:de})}return Y&&M&&ue!==o?n.length&&n_(n[n.length-1].value,o,YE(o,oe,e))?n[n.length-1].value=o:n.push({value:o}):(!Y||ue===o)&&n.push({value:ue}),n}function YE(e,t,{horizontal:n,minRotation:r}){const i=nf(r),l=(n?Math.sin(i):Math.cos(i))||.001,a=.75*t*(""+e).length;return Math.min(t/l,a)}class o2 extends Ag{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,n){return go(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:n,maxDefined:r}=this.getUserBounds();let{min:i,max:l}=this;const a=f=>i=n?i:f,o=f=>l=r?l:f;if(t){const f=Nf(i),m=Nf(l);f<0&&m<0?o(0):f>0&&m>0&&a(0)}if(i===l){let f=l===0?1:Math.abs(l*.05);o(l+f),t||a(i-f)}this.min=i,this.max=l}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:n,stepSize:r}=t,i;return r?(i=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),n=n||11),n&&(i=Math.min(n,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,n=t.ticks;let r=this.getTickLimit();r=Math.max(2,r);const i={maxTicks:r,bounds:t.bounds,min:t.min,max:t.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},l=this._range||this,a=hee(i,l);return t.bounds==="ticks"&&pI(a,this,"value"),t.reverse?(a.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),a}configure(){const t=this.ticks;let n=this.min,r=this.max;if(super.configure(),this.options.offset&&t.length){const i=(r-n)/Math.max(t.length-1,1)/2;n-=i,r+=i}this._startValue=n,this._endValue=r,this._valueRange=r-n}getLabelForValue(t){return $_(t,this.chart.options.locale,this.options.ticks.format)}}class M3 extends o2{determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=iu(t)?t:0,this.max=iu(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),n=t?this.width:this.height,r=nf(this.options.ticks.minRotation),i=(t?Math.sin(r):Math.cos(r))||.001,l=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,l.lineHeight/i))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}un(M3,"id","linear"),un(M3,"defaults",{ticks:{callback:H2.formatters.numeric}});const k_=e=>Math.floor(om(e)),ng=(e,t)=>Math.pow(10,k_(e)+t);function XE(e){return e/Math.pow(10,k_(e))===1}function JE(e,t,n){const r=Math.pow(10,n),i=Math.floor(e/r);return Math.ceil(t/r)-i}function dee(e,t){const n=t-e;let r=k_(n);for(;JE(e,t,r)>10;)r++;for(;JE(e,t,r)<10;)r--;return Math.min(r,k_(e))}function fee(e,{min:t,max:n}){t=dd(e.min,t);const r=[],i=k_(t);let l=dee(t,n),a=l<0?Math.pow(10,Math.abs(l)):1;const o=Math.pow(10,l),f=i>l?Math.pow(10,i):0,m=Math.round((t-f)*a)/a,_=Math.floor((t-f)/o/10)*o*10;let w=Math.floor((m-_)/Math.pow(10,l)),M=dd(e.min,Math.round((f+_+w*Math.pow(10,l))*a)/a);for(;M<n;)r.push({value:M,major:XE(M),significand:w}),w>=10?w=w<15?15:20:w++,w>=20&&(l++,w=2,a=l>=0?1:a),M=Math.round((f+_+w*Math.pow(10,l))*a)/a;const C=dd(e.max,M);return r.push({value:C,major:XE(C),significand:w}),r}class T3 extends Ag{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,n){const r=o2.prototype.parse.apply(this,[t,n]);if(r===0){this._zero=!0;return}return iu(r)&&r>0?r:null}determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=iu(t)?Math.max(0,t):null,this.max=iu(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!iu(this._userMin)&&(this.min=t===ng(this.min,0)?ng(this.min,-1):ng(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let r=this.min,i=this.max;const l=o=>r=t?r:o,a=o=>i=n?i:o;r===i&&(r<=0?(l(1),a(10)):(l(ng(r,-1)),a(ng(i,1)))),r<=0&&l(ng(i,-1)),i<=0&&a(ng(r,1)),this.min=r,this.max=i}buildTicks(){const t=this.options,n={min:this._userMin,max:this._userMax},r=fee(n,this);return t.bounds==="ticks"&&pI(r,this,"value"),t.reverse?(r.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),r}getLabelForValue(t){return t===void 0?"0":$_(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=om(t),this._valueRange=om(this.max)-om(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(om(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const n=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+n*this._valueRange)}}un(T3,"id","logarithmic"),un(T3,"defaults",{ticks:{callback:H2.formatters.logarithmic,major:{enabled:!0}}});function A3(e){const t=e.ticks;if(t.display&&e.display){const n=oh(t.backdropPadding);return Es(t.font&&t.font.size,su.font.size)+n.height}return 0}function pee(e,t,n){return n=pl(n)?n:[n],{w:CY(e,t.string,n),h:n.length*t.lineHeight}}function QE(e,t,n,r,i){return e===r||e===i?{start:t-n/2,end:t+n/2}:e<r||e>i?{start:t-n,end:t}:{start:t,end:t+n}}function mee(e){const t={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},n=Object.assign({},t),r=[],i=[],l=e._pointLabels.length,a=e.options.pointLabels,o=a.centerPointLabels?Xa/l:0;for(let f=0;f<l;f++){const m=a.setContext(e.getPointLabelContext(f));i[f]=m.padding;const _=e.getPointPosition(f,e.drawingArea+i[f],o),w=cc(m.font),M=pee(e.ctx,w,e._pointLabels[f]);r[f]=M;const C=fd(e.getIndexAngle(f)+o),R=Math.round(VC(C)),z=QE(R,_.x,M.w,0,180),W=QE(R,_.y,M.h,90,270);gee(n,t,C,z,W)}e.setCenterPoint(t.l-n.l,n.r-t.r,t.t-n.t,n.b-t.b),e._pointLabelItems=_ee(e,r,i)}function gee(e,t,n,r,i){const l=Math.abs(Math.sin(n)),a=Math.abs(Math.cos(n));let o=0,f=0;r.start<t.l?(o=(t.l-r.start)/l,e.l=Math.min(e.l,t.l-o)):r.end>t.r&&(o=(r.end-t.r)/l,e.r=Math.max(e.r,t.r+o)),i.start<t.t?(f=(t.t-i.start)/a,e.t=Math.min(e.t,t.t-f)):i.end>t.b&&(f=(i.end-t.b)/a,e.b=Math.max(e.b,t.b+f))}function yee(e,t,n){const r=e.drawingArea,{extra:i,additionalAngle:l,padding:a,size:o}=n,f=e.getPointPosition(t,r+i+a,l),m=Math.round(VC(fd(f.angle+Lu))),_=wee(f.y,o.h,m),w=bee(m),M=xee(f.x,o.w,w);return{visible:!0,x:f.x,y:_,textAlign:w,left:M,top:_,right:M+o.w,bottom:_+o.h}}function vee(e,t){if(!t)return!0;const{left:n,top:r,right:i,bottom:l}=e;return!(gp({x:n,y:r},t)||gp({x:n,y:l},t)||gp({x:i,y:r},t)||gp({x:i,y:l},t))}function _ee(e,t,n){const r=[],i=e._pointLabels.length,l=e.options,{centerPointLabels:a,display:o}=l.pointLabels,f={extra:A3(l)/2,additionalAngle:a?Xa/i:0};let m;for(let _=0;_<i;_++){f.padding=n[_],f.size=t[_];const w=yee(e,_,f);r.push(w),o==="auto"&&(w.visible=vee(w,m),w.visible&&(m=w))}return r}function bee(e){return e===0||e===180?"center":e<180?"left":"right"}function xee(e,t,n){return n==="right"?e-=t:n==="center"&&(e-=t/2),e}function wee(e,t,n){return n===90||n===270?e-=t/2:(n>270||n<90)&&(e-=t),e}function Cee(e,t,n){const{left:r,top:i,right:l,bottom:a}=n,{backdropColor:o}=t;if(!go(o)){const f=_g(t.borderRadius),m=oh(t.backdropPadding);e.fillStyle=o;const _=r-m.left,w=i-m.top,M=l-r+m.width,C=a-i+m.height;Object.values(f).some(R=>R!==0)?(e.beginPath(),T_(e,{x:_,y:w,w:M,h:C,radius:f}),e.fill()):e.fillRect(_,w,M,C)}}function See(e,t){const{ctx:n,options:{pointLabels:r}}=e;for(let i=t-1;i>=0;i--){const l=e._pointLabelItems[i];if(!l.visible)continue;const a=r.setContext(e.getPointLabelContext(i));Cee(n,a,l);const o=cc(a.font),{x:f,y:m,textAlign:_}=l;Lg(n,e._pointLabels[i],f,m+o.lineHeight/2,o,{color:a.color,textAlign:_,textBaseline:"middle"})}}function s6(e,t,n,r){const{ctx:i}=e;if(n)i.arc(e.xCenter,e.yCenter,t,0,Ya);else{let l=e.getPointPosition(0,t);i.moveTo(l.x,l.y);for(let a=1;a<r;a++)l=e.getPointPosition(a,t),i.lineTo(l.x,l.y)}}function Lee(e,t,n,r,i){const l=e.ctx,a=t.circular,{color:o,lineWidth:f}=t;!a&&!r||!o||!f||n<0||(l.save(),l.strokeStyle=o,l.lineWidth=f,l.setLineDash(i.dash),l.lineDashOffset=i.dashOffset,l.beginPath(),s6(e,n,a,r),l.closePath(),l.stroke(),l.restore())}function Pee(e,t,n){return Cm(e,{label:n,index:t,type:"pointLabel"})}class Rv extends o2{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=oh(A3(this.options)/2),n=this.width=this.maxWidth-t.width,r=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+n/2+t.left),this.yCenter=Math.floor(this.top+r/2+t.top),this.drawingArea=Math.floor(Math.min(n,r)/2)}determineDataLimits(){const{min:t,max:n}=this.getMinMax(!1);this.min=iu(t)&&!isNaN(t)?t:0,this.max=iu(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/A3(this.options))}generateTickLabels(t){o2.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((n,r)=>{const i=Na(this.options.pointLabels.callback,[n,r],this);return i||i===0?i:""}).filter((n,r)=>this.chart.getDataVisibility(r))}fit(){const t=this.options;t.display&&t.pointLabels.display?mee(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,n,r,i){this.xCenter+=Math.floor((t-n)/2),this.yCenter+=Math.floor((r-i)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,n,r,i))}getIndexAngle(t){const n=Ya/(this._pointLabels.length||1),r=this.options.startAngle||0;return fd(t*n+nf(r))}getDistanceFromCenterForValue(t){if(go(t))return NaN;const n=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*n:(t-this.min)*n}getValueForDistanceFromCenter(t){if(go(t))return NaN;const n=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-n:this.min+n}getPointLabelContext(t){const n=this._pointLabels||[];if(t>=0&&t<n.length){const r=n[t];return Pee(this.getContext(),t,r)}}getPointPosition(t,n,r=0){const i=this.getIndexAngle(t)-Lu+r;return{x:Math.cos(i)*n+this.xCenter,y:Math.sin(i)*n+this.yCenter,angle:i}}getPointPositionForValue(t,n){return this.getPointPosition(t,this.getDistanceFromCenterForValue(n))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:n,top:r,right:i,bottom:l}=this._pointLabelItems[t];return{left:n,top:r,right:i,bottom:l}}drawBackground(){const{backgroundColor:t,grid:{circular:n}}=this.options;if(t){const r=this.ctx;r.save(),r.beginPath(),s6(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),r.closePath(),r.fillStyle=t,r.fill(),r.restore()}}drawGrid(){const t=this.ctx,n=this.options,{angleLines:r,grid:i,border:l}=n,a=this._pointLabels.length;let o,f,m;if(n.pointLabels.display&&See(this,a),i.display&&this.ticks.forEach((_,w)=>{if(w!==0){f=this.getDistanceFromCenterForValue(_.value);const M=this.getContext(w),C=i.setContext(M),R=l.setContext(M);Lee(this,C,f,a,R)}}),r.display){for(t.save(),o=a-1;o>=0;o--){const _=r.setContext(this.getPointLabelContext(o)),{color:w,lineWidth:M}=_;!M||!w||(t.lineWidth=M,t.strokeStyle=w,t.setLineDash(_.borderDash),t.lineDashOffset=_.borderDashOffset,f=this.getDistanceFromCenterForValue(n.ticks.reverse?this.min:this.max),m=this.getPointPosition(o,f),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(m.x,m.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,n=this.options,r=n.ticks;if(!r.display)return;const i=this.getIndexAngle(0);let l,a;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(i),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((o,f)=>{if(f===0&&!n.reverse)return;const m=r.setContext(this.getContext(f)),_=cc(m.font);if(l=this.getDistanceFromCenterForValue(this.ticks[f].value),m.showLabelBackdrop){t.font=_.string,a=t.measureText(o.label).width,t.fillStyle=m.backdropColor;const w=oh(m.backdropPadding);t.fillRect(-a/2-w.left,-l-_.size/2-w.top,a+w.width,_.size+w.height)}Lg(t,o.label,0,-l,_,{color:m.color,strokeColor:m.textStrokeColor,strokeWidth:m.textStrokeWidth})}),t.restore()}drawTitle(){}}un(Rv,"id","radialLinear"),un(Rv,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:H2.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}}),un(Rv,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),un(Rv,"descriptors",{angleLines:{_fallback:"grid"}});const Y2={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},qh=Object.keys(Y2);function eM(e,t){return e-t}function tM(e,t){if(go(t))return null;const n=e._adapter,{parser:r,round:i,isoWeekday:l}=e._parseOpts;let a=t;return typeof r=="function"&&(a=r(a)),iu(a)||(a=typeof r=="string"?n.parse(a,r):n.parse(a)),a===null?null:(i&&(a=i==="week"&&(W0(l)||l===!0)?n.startOf(a,"isoWeek",l):n.startOf(a,i)),+a)}function nM(e,t,n,r){const i=qh.length;for(let l=qh.indexOf(e);l<i-1;++l){const a=Y2[qh[l]],o=a.steps?a.steps:Number.MAX_SAFE_INTEGER;if(a.common&&Math.ceil((n-t)/(o*a.size))<=r)return qh[l]}return qh[i-1]}function Eee(e,t,n,r,i){for(let l=qh.length-1;l>=qh.indexOf(n);l--){const a=qh[l];if(Y2[a].common&&e._adapter.diff(i,r,a)>=t-1)return a}return qh[n?qh.indexOf(n):0]}function Mee(e){for(let t=qh.indexOf(e)+1,n=qh.length;t<n;++t)if(Y2[qh[t]].common)return qh[t]}function rM(e,t,n){if(!n)e[t]=!0;else if(n.length){const{lo:r,hi:i}=$C(n,t),l=n[r]>=t?n[r]:n[i];e[l]=!0}}function Tee(e,t,n,r){const i=e._adapter,l=+i.startOf(t[0].value,r),a=t[t.length-1].value;let o,f;for(o=l;o<=a;o=+i.add(o,1,r))f=n[o],f>=0&&(t[f].major=!0);return t}function iM(e,t,n){const r=[],i={},l=t.length;let a,o;for(a=0;a<l;++a)o=t[a],i[o]=a,r.push({value:o,major:!1});return l===0||!n?r:Tee(e,r,i,n)}class I_ extends Ag{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,n={}){const r=t.time||(t.time={}),i=this._adapter=new zI._date(t.adapters.date);i.init(n),t_(r.displayFormats,i.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(t),this._normalized=n.normalized}parse(t,n){return t===void 0?null:tM(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,n=this._adapter,r=t.time.unit||"day";let{min:i,max:l,minDefined:a,maxDefined:o}=this.getUserBounds();function f(m){!a&&!isNaN(m.min)&&(i=Math.min(i,m.min)),!o&&!isNaN(m.max)&&(l=Math.max(l,m.max))}(!a||!o)&&(f(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&f(this.getMinMax(!1))),i=iu(i)&&!isNaN(i)?i:+n.startOf(Date.now(),r),l=iu(l)&&!isNaN(l)?l:+n.endOf(Date.now(),r)+1,this.min=Math.min(i,l-1),this.max=Math.max(i+1,l)}_getLabelBounds(){const t=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return t.length&&(n=t[0],r=t[t.length-1]),{min:n,max:r}}buildTicks(){const t=this.options,n=t.time,r=t.ticks,i=r.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const l=this.min,a=this.max,o=cY(i,l,a);return this._unit=n.unit||(r.autoSkip?nM(n.minUnit,this.min,this.max,this._getLabelCapacity(l)):Eee(this,o.length,n.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:Mee(this._unit),this.initOffsets(i),t.reverse&&o.reverse(),iM(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let n=0,r=0,i,l;this.options.offset&&t.length&&(i=this.getDecimalForValue(t[0]),t.length===1?n=1-i:n=(this.getDecimalForValue(t[1])-i)/2,l=this.getDecimalForValue(t[t.length-1]),t.length===1?r=l:r=(l-this.getDecimalForValue(t[t.length-2]))/2);const a=t.length<3?.5:.25;n=bc(n,0,a),r=bc(r,0,a),this._offsets={start:n,end:r,factor:1/(n+1+r)}}_generate(){const t=this._adapter,n=this.min,r=this.max,i=this.options,l=i.time,a=l.unit||nM(l.minUnit,n,r,this._getLabelCapacity(n)),o=Es(i.ticks.stepSize,1),f=a==="week"?l.isoWeekday:!1,m=W0(f)||f===!0,_={};let w=n,M,C;if(m&&(w=+t.startOf(w,"isoWeek",f)),w=+t.startOf(w,m?"day":a),t.diff(r,n,a)>1e5*o)throw new Error(n+" and "+r+" are too far apart with stepSize of "+o+" "+a);const R=i.ticks.source==="data"&&this.getDataTimestamps();for(M=w,C=0;M<r;M=+t.add(M,o,a),C++)rM(_,M,R);return(M===r||i.bounds==="ticks"||C===1)&&rM(_,M,R),Object.keys(_).sort(eM).map(z=>+z)}getLabelForValue(t){const n=this._adapter,r=this.options.time;return r.tooltipFormat?n.format(t,r.tooltipFormat):n.format(t,r.displayFormats.datetime)}format(t,n){const i=this.options.time.displayFormats,l=this._unit,a=n||i[l];return this._adapter.format(t,a)}_tickFormatFunction(t,n,r,i){const l=this.options,a=l.ticks.callback;if(a)return Na(a,[t,n,r],this);const o=l.time.displayFormats,f=this._unit,m=this._majorUnit,_=f&&o[f],w=m&&o[m],M=r[n],C=m&&w&&M&&M.major;return this._adapter.format(t,i||(C?w:_))}generateTickLabels(t){let n,r,i;for(n=0,r=t.length;n<r;++n)i=t[n],i.label=this._tickFormatFunction(i.value,n,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const n=this._offsets,r=this.getDecimalForValue(t);return this.getPixelForDecimal((n.start+r)*n.factor)}getValueForPixel(t){const n=this._offsets,r=this.getDecimalForPixel(t)/n.factor-n.end;return this.min+r*(this.max-this.min)}_getLabelSize(t){const n=this.options.ticks,r=this.ctx.measureText(t).width,i=nf(this.isHorizontal()?n.maxRotation:n.minRotation),l=Math.cos(i),a=Math.sin(i),o=this._resolveTickFontOptions(0).size;return{w:r*l+o*a,h:r*a+o*l}}_getLabelCapacity(t){const n=this.options.time,r=n.displayFormats,i=r[n.unit]||r.millisecond,l=this._tickFormatFunction(t,0,iM(this,[t],this._majorUnit),i),a=this._getLabelSize(l),o=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return o>0?o:1}getDataTimestamps(){let t=this._cache.data||[],n,r;if(t.length)return t;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(n=0,r=i.length;n<r;++n)t=t.concat(i[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let n,r;if(t.length)return t;const i=this.getLabels();for(n=0,r=i.length;n<r;++n)t.push(tM(this,i[n]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return yI(t.sort(eM))}}un(I_,"id","time"),un(I_,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Gb(e,t,n){let r=0,i=e.length-1,l,a,o,f;n?(t>=e[r].pos&&t<=e[i].pos&&({lo:r,hi:i}=mp(e,"pos",t)),{pos:l,time:o}=e[r],{pos:a,time:f}=e[i]):(t>=e[r].time&&t<=e[i].time&&({lo:r,hi:i}=mp(e,"time",t)),{time:l,pos:o}=e[r],{time:a,pos:f}=e[i]);const m=a-l;return m?o+(f-o)*(t-l)/m:o}class k3 extends I_{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(t);this._minPos=Gb(n,this.min),this._tableRange=Gb(n,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:n,max:r}=this,i=[],l=[];let a,o,f,m,_;for(a=0,o=t.length;a<o;++a)m=t[a],m>=n&&m<=r&&i.push(m);if(i.length<2)return[{time:n,pos:0},{time:r,pos:1}];for(a=0,o=i.length;a<o;++a)_=i[a+1],f=i[a-1],m=i[a],Math.round((_+f)/2)!==m&&l.push({time:m,pos:a/(o-1)});return l}_generate(){const t=this.min,n=this.max;let r=super.getDataTimestamps();return(!r.includes(t)||!r.length)&&r.splice(0,0,t),(!r.includes(n)||r.length===1)&&r.push(n),r.sort((i,l)=>i-l)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const n=this.getDataTimestamps(),r=this.getLabelTimestamps();return n.length&&r.length?t=this.normalize(n.concat(r)):t=n.length?n:r,t=this._cache.all=t,t}getDecimalForValue(t){return(Gb(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const n=this._offsets,r=this.getDecimalForPixel(t)/n.factor-n.end;return Gb(this._table,r*this._tableRange+this._minPos,!0)}}un(k3,"id","timeseries"),un(k3,"defaults",I_.defaults);var Aee=Object.freeze({__proto__:null,CategoryScale:E3,LinearScale:M3,LogarithmicScale:T3,RadialLinearScale:Rv,TimeScale:I_,TimeSeriesScale:k3});const kee=[FX,fQ,aee,Aee];Af.register(...kee);const o6=6048e5,Iee=864e5,G_=6e4,H_=36e5,Dee=1e3,sM=Symbol.for("constructDateFrom");function ou(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&sM in e?e[sM](t):e instanceof Date?new e.constructor(t):new Date(t)}function ys(e,t){return ou(t||e,e)}function X2(e,t,n){const r=ys(e,n==null?void 0:n.in);return isNaN(t)?ou((n==null?void 0:n.in)||e,NaN):(t&&r.setDate(r.getDate()+t),r)}function tS(e,t,n){const r=ys(e,n==null?void 0:n.in);if(isNaN(t))return ou(e,NaN);if(!t)return r;const i=r.getDate(),l=ou(e,r.getTime());l.setMonth(r.getMonth()+t+1,0);const a=l.getDate();return i>=a?l:(r.setFullYear(l.getFullYear(),l.getMonth(),i),r)}function nS(e,t,n){return ou(e,+ys(e)+t)}function Oee(e,t,n){return nS(e,t*H_)}let Ree={};function kg(){return Ree}function jf(e,t){var o,f,m,_;const n=kg(),r=(t==null?void 0:t.weekStartsOn)??((f=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:f.weekStartsOn)??n.weekStartsOn??((_=(m=n.locale)==null?void 0:m.options)==null?void 0:_.weekStartsOn)??0,i=ys(e,t==null?void 0:t.in),l=i.getDay(),a=(l<r?7:0)+l-r;return i.setDate(i.getDate()-a),i.setHours(0,0,0,0),i}function Y0(e,t){return jf(e,{...t,weekStartsOn:1})}function a6(e,t){const n=ys(e,t==null?void 0:t.in),r=n.getFullYear(),i=ou(n,0);i.setFullYear(r+1,0,4),i.setHours(0,0,0,0);const l=Y0(i),a=ou(n,0);a.setFullYear(r,0,4),a.setHours(0,0,0,0);const o=Y0(a);return n.getTime()>=l.getTime()?r+1:n.getTime()>=o.getTime()?r:r-1}function a2(e){const t=ys(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function Ig(e,...t){const n=ou.bind(null,t.find(r=>typeof r=="object"));return t.map(n)}function I3(e,t){const n=ys(e,t==null?void 0:t.in);return n.setHours(0,0,0,0),n}function l6(e,t,n){const[r,i]=Ig(n==null?void 0:n.in,e,t),l=I3(r),a=I3(i),o=+l-a2(l),f=+a-a2(a);return Math.round((o-f)/Iee)}function Bee(e,t){const n=a6(e,t),r=ou(e,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),Y0(r)}function Nee(e,t,n){const r=ys(e,n==null?void 0:n.in);return r.setTime(r.getTime()+t*G_),r}function Fee(e,t,n){return tS(e,t*3,n)}function zee(e,t,n){return nS(e,t*1e3)}function jee(e,t,n){return X2(e,t*7,n)}function Uee(e,t,n){return tS(e,t*12,n)}function o_(e,t){const n=+ys(e)-+ys(t);return n<0?-1:n>0?1:n}function Vee(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function u6(e){return!(!Vee(e)&&typeof e!="number"||isNaN(+ys(e)))}function $ee(e,t,n){const[r,i]=Ig(n==null?void 0:n.in,e,t),l=r.getFullYear()-i.getFullYear(),a=r.getMonth()-i.getMonth();return l*12+a}function Gee(e,t,n){const[r,i]=Ig(n==null?void 0:n.in,e,t);return r.getFullYear()-i.getFullYear()}function c6(e,t,n){const[r,i]=Ig(n==null?void 0:n.in,e,t),l=oM(r,i),a=Math.abs(l6(r,i));r.setDate(r.getDate()-l*a);const o=+(oM(r,i)===-l),f=l*(a-o);return f===0?0:f}function oM(e,t){const n=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return n<0?-1:n>0?1:n}function q_(e){return t=>{const r=(e?Math[e]:Math.trunc)(t);return r===0?0:r}}function Hee(e,t,n){const[r,i]=Ig(n==null?void 0:n.in,e,t),l=(+r-+i)/H_;return q_(n==null?void 0:n.roundingMethod)(l)}function rS(e,t){return+ys(e)-+ys(t)}function qee(e,t,n){const r=rS(e,t)/G_;return q_(n==null?void 0:n.roundingMethod)(r)}function h6(e,t){const n=ys(e,t==null?void 0:t.in);return n.setHours(23,59,59,999),n}function d6(e,t){const n=ys(e,t==null?void 0:t.in),r=n.getMonth();return n.setFullYear(n.getFullYear(),r+1,0),n.setHours(23,59,59,999),n}function Wee(e,t){const n=ys(e,t==null?void 0:t.in);return+h6(n,t)==+d6(n,t)}function f6(e,t,n){const[r,i,l]=Ig(n==null?void 0:n.in,e,e,t),a=o_(i,l),o=Math.abs($ee(i,l));if(o<1)return 0;i.getMonth()===1&&i.getDate()>27&&i.setDate(30),i.setMonth(i.getMonth()-a*o);let f=o_(i,l)===-a;Wee(r)&&o===1&&o_(r,l)===1&&(f=!1);const m=a*(o-+f);return m===0?0:m}function Zee(e,t,n){const r=f6(e,t,n)/3;return q_(n==null?void 0:n.roundingMethod)(r)}function Kee(e,t,n){const r=rS(e,t)/1e3;return q_(n==null?void 0:n.roundingMethod)(r)}function Yee(e,t,n){const r=c6(e,t,n)/7;return q_(n==null?void 0:n.roundingMethod)(r)}function Xee(e,t,n){const[r,i]=Ig(n==null?void 0:n.in,e,t),l=o_(r,i),a=Math.abs(Gee(r,i));r.setFullYear(1584),i.setFullYear(1584);const o=o_(r,i)===-l,f=l*(a-+o);return f===0?0:f}function Jee(e,t){const n=ys(e,t==null?void 0:t.in),r=n.getMonth(),i=r-r%3;return n.setMonth(i,1),n.setHours(0,0,0,0),n}function Qee(e,t){const n=ys(e,t==null?void 0:t.in);return n.setDate(1),n.setHours(0,0,0,0),n}function ete(e,t){const n=ys(e,t==null?void 0:t.in),r=n.getFullYear();return n.setFullYear(r+1,0,0),n.setHours(23,59,59,999),n}function p6(e,t){const n=ys(e,t==null?void 0:t.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function tte(e,t){const n=ys(e,t==null?void 0:t.in);return n.setMinutes(59,59,999),n}function nte(e,t){var o,f;const n=kg(),r=n.weekStartsOn??((f=(o=n.locale)==null?void 0:o.options)==null?void 0:f.weekStartsOn)??0,i=ys(e,t==null?void 0:t.in),l=i.getDay(),a=(l<r?-7:0)+6-(l-r);return i.setDate(i.getDate()+a),i.setHours(23,59,59,999),i}function rte(e,t){const n=ys(e,t==null?void 0:t.in);return n.setSeconds(59,999),n}function ite(e,t){const n=ys(e,t==null?void 0:t.in),r=n.getMonth(),i=r-r%3+3;return n.setMonth(i,0),n.setHours(23,59,59,999),n}function ste(e,t){const n=ys(e,t==null?void 0:t.in);return n.setMilliseconds(999),n}const ote={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},ate=(e,t,n)=>{let r;const i=ote[e];return typeof i=="string"?r=i:t===1?r=i.one:r=i.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function m4(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const lte={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},ute={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},cte={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},hte={date:m4({formats:lte,defaultWidth:"full"}),time:m4({formats:ute,defaultWidth:"full"}),dateTime:m4({formats:cte,defaultWidth:"full"})},dte={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},fte=(e,t,n,r)=>dte[e];function vv(e){return(t,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let i;if(r==="formatting"&&e.formattingValues){const a=e.defaultFormattingWidth||e.defaultWidth,o=n!=null&&n.width?String(n.width):a;i=e.formattingValues[o]||e.formattingValues[a]}else{const a=e.defaultWidth,o=n!=null&&n.width?String(n.width):e.defaultWidth;i=e.values[o]||e.values[a]}const l=e.argumentCallback?e.argumentCallback(t):t;return i[l]}}const pte={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},mte={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},gte={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},yte={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},vte={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},_te={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},bte=(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},xte={ordinalNumber:bte,era:vv({values:pte,defaultWidth:"wide"}),quarter:vv({values:mte,defaultWidth:"wide",argumentCallback:e=>e-1}),month:vv({values:gte,defaultWidth:"wide"}),day:vv({values:yte,defaultWidth:"wide"}),dayPeriod:vv({values:vte,defaultWidth:"wide",formattingValues:_te,defaultFormattingWidth:"wide"})};function _v(e){return(t,n={})=>{const r=n.width,i=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],l=t.match(i);if(!l)return null;const a=l[0],o=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],f=Array.isArray(o)?Cte(o,w=>w.test(a)):wte(o,w=>w.test(a));let m;m=e.valueCallback?e.valueCallback(f):f,m=n.valueCallback?n.valueCallback(m):m;const _=t.slice(a.length);return{value:m,rest:_}}}function wte(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function Cte(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function Ste(e){return(t,n={})=>{const r=t.match(e.matchPattern);if(!r)return null;const i=r[0],l=t.match(e.parsePattern);if(!l)return null;let a=e.valueCallback?e.valueCallback(l[0]):l[0];a=n.valueCallback?n.valueCallback(a):a;const o=t.slice(i.length);return{value:a,rest:o}}}const Lte=/^(\d+)(th|st|nd|rd)?/i,Pte=/\d+/i,Ete={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Mte={any:[/^b/i,/^(a|c)/i]},Tte={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Ate={any:[/1/i,/2/i,/3/i,/4/i]},kte={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Ite={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Dte={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Ote={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Rte={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Bte={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Nte={ordinalNumber:Ste({matchPattern:Lte,parsePattern:Pte,valueCallback:e=>parseInt(e,10)}),era:_v({matchPatterns:Ete,defaultMatchWidth:"wide",parsePatterns:Mte,defaultParseWidth:"any"}),quarter:_v({matchPatterns:Tte,defaultMatchWidth:"wide",parsePatterns:Ate,defaultParseWidth:"any",valueCallback:e=>e+1}),month:_v({matchPatterns:kte,defaultMatchWidth:"wide",parsePatterns:Ite,defaultParseWidth:"any"}),day:_v({matchPatterns:Dte,defaultMatchWidth:"wide",parsePatterns:Ote,defaultParseWidth:"any"}),dayPeriod:_v({matchPatterns:Rte,defaultMatchWidth:"any",parsePatterns:Bte,defaultParseWidth:"any"})},m6={code:"en-US",formatDistance:ate,formatLong:hte,formatRelative:fte,localize:xte,match:Nte,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Fte(e,t){const n=ys(e,t==null?void 0:t.in);return l6(n,p6(n))+1}function g6(e,t){const n=ys(e,t==null?void 0:t.in),r=+Y0(n)-+Bee(n);return Math.round(r/o6)+1}function iS(e,t){var _,w,M,C;const n=ys(e,t==null?void 0:t.in),r=n.getFullYear(),i=kg(),l=(t==null?void 0:t.firstWeekContainsDate)??((w=(_=t==null?void 0:t.locale)==null?void 0:_.options)==null?void 0:w.firstWeekContainsDate)??i.firstWeekContainsDate??((C=(M=i.locale)==null?void 0:M.options)==null?void 0:C.firstWeekContainsDate)??1,a=ou((t==null?void 0:t.in)||e,0);a.setFullYear(r+1,0,l),a.setHours(0,0,0,0);const o=jf(a,t),f=ou((t==null?void 0:t.in)||e,0);f.setFullYear(r,0,l),f.setHours(0,0,0,0);const m=jf(f,t);return+n>=+o?r+1:+n>=+m?r:r-1}function zte(e,t){var o,f,m,_;const n=kg(),r=(t==null?void 0:t.firstWeekContainsDate)??((f=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:f.firstWeekContainsDate)??n.firstWeekContainsDate??((_=(m=n.locale)==null?void 0:m.options)==null?void 0:_.firstWeekContainsDate)??1,i=iS(e,t),l=ou((t==null?void 0:t.in)||e,0);return l.setFullYear(i,0,r),l.setHours(0,0,0,0),jf(l,t)}function y6(e,t){const n=ys(e,t==null?void 0:t.in),r=+jf(n,t)-+zte(n,t);return Math.round(r/o6)+1}function Ko(e,t){const n=e<0?"-":"",r=Math.abs(e).toString().padStart(t,"0");return n+r}const qp={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return Ko(t==="yy"?r%100:r,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):Ko(n+1,2)},d(e,t){return Ko(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return Ko(e.getHours()%12||12,t.length)},H(e,t){return Ko(e.getHours(),t.length)},m(e,t){return Ko(e.getMinutes(),t.length)},s(e,t){return Ko(e.getSeconds(),t.length)},S(e,t){const n=t.length,r=e.getMilliseconds(),i=Math.trunc(r*Math.pow(10,n-3));return Ko(i,t.length)}},y0={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},aM={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const r=e.getFullYear(),i=r>0?r:1-r;return n.ordinalNumber(i,{unit:"year"})}return qp.y(e,t)},Y:function(e,t,n,r){const i=iS(e,r),l=i>0?i:1-i;if(t==="YY"){const a=l%100;return Ko(a,2)}return t==="Yo"?n.ordinalNumber(l,{unit:"year"}):Ko(l,t.length)},R:function(e,t){const n=a6(e);return Ko(n,t.length)},u:function(e,t){const n=e.getFullYear();return Ko(n,t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return Ko(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return Ko(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return qp.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return Ko(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const i=y6(e,r);return t==="wo"?n.ordinalNumber(i,{unit:"week"}):Ko(i,t.length)},I:function(e,t,n){const r=g6(e);return t==="Io"?n.ordinalNumber(r,{unit:"week"}):Ko(r,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):qp.d(e,t)},D:function(e,t,n){const r=Fte(e);return t==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):Ko(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const i=e.getDay(),l=(i-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(l);case"ee":return Ko(l,2);case"eo":return n.ordinalNumber(l,{unit:"day"});case"eee":return n.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(i,{width:"short",context:"formatting"});case"eeee":default:return n.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const i=e.getDay(),l=(i-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(l);case"cc":return Ko(l,t.length);case"co":return n.ordinalNumber(l,{unit:"day"});case"ccc":return n.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(i,{width:"narrow",context:"standalone"});case"cccccc":return n.day(i,{width:"short",context:"standalone"});case"cccc":default:return n.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),i=r===0?7:r;switch(t){case"i":return String(i);case"ii":return Ko(i,t.length);case"io":return n.ordinalNumber(i,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const i=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let i;switch(r===12?i=y0.noon:r===0?i=y0.midnight:i=r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let i;switch(r>=17?i=y0.evening:r>=12?i=y0.afternoon:r>=4?i=y0.morning:i=y0.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let r=e.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return qp.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):qp.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return t==="Ko"?n.ordinalNumber(r,{unit:"hour"}):Ko(r,t.length)},k:function(e,t,n){let r=e.getHours();return r===0&&(r=24),t==="ko"?n.ordinalNumber(r,{unit:"hour"}):Ko(r,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):qp.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):qp.s(e,t)},S:function(e,t){return qp.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return uM(r);case"XXXX":case"XX":return ag(r);case"XXXXX":case"XXX":default:return ag(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return uM(r);case"xxxx":case"xx":return ag(r);case"xxxxx":case"xxx":default:return ag(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+lM(r,":");case"OOOO":default:return"GMT"+ag(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+lM(r,":");case"zzzz":default:return"GMT"+ag(r,":")}},t:function(e,t,n){const r=Math.trunc(+e/1e3);return Ko(r,t.length)},T:function(e,t,n){return Ko(+e,t.length)}};function lM(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),i=Math.trunc(r/60),l=r%60;return l===0?n+String(i):n+String(i)+t+Ko(l,2)}function uM(e,t){return e%60===0?(e>0?"-":"+")+Ko(Math.abs(e)/60,2):ag(e,t)}function ag(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),i=Ko(Math.trunc(r/60),2),l=Ko(r%60,2);return n+i+t+l}const cM=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},v6=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},jte=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],i=n[2];if(!i)return cM(e,t);let l;switch(r){case"P":l=t.dateTime({width:"short"});break;case"PP":l=t.dateTime({width:"medium"});break;case"PPP":l=t.dateTime({width:"long"});break;case"PPPP":default:l=t.dateTime({width:"full"});break}return l.replace("{{date}}",cM(r,t)).replace("{{time}}",v6(i,t))},D3={p:v6,P:jte},Ute=/^D+$/,Vte=/^Y+$/,$te=["D","DD","YY","YYYY"];function _6(e){return Ute.test(e)}function b6(e){return Vte.test(e)}function O3(e,t,n){const r=Gte(e,t,n);if(console.warn(r),$te.includes(e))throw new RangeError(r)}function Gte(e,t,n){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Hte=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,qte=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Wte=/^'([^]*?)'?$/,Zte=/''/g,Kte=/[a-zA-Z]/;function Yte(e,t,n){var _,w,M,C,R,z,W,X;const r=kg(),i=(n==null?void 0:n.locale)??r.locale??m6,l=(n==null?void 0:n.firstWeekContainsDate)??((w=(_=n==null?void 0:n.locale)==null?void 0:_.options)==null?void 0:w.firstWeekContainsDate)??r.firstWeekContainsDate??((C=(M=r.locale)==null?void 0:M.options)==null?void 0:C.firstWeekContainsDate)??1,a=(n==null?void 0:n.weekStartsOn)??((z=(R=n==null?void 0:n.locale)==null?void 0:R.options)==null?void 0:z.weekStartsOn)??r.weekStartsOn??((X=(W=r.locale)==null?void 0:W.options)==null?void 0:X.weekStartsOn)??0,o=ys(e,n==null?void 0:n.in);if(!u6(o))throw new RangeError("Invalid time value");let f=t.match(qte).map(Y=>{const Q=Y[0];if(Q==="p"||Q==="P"){const oe=D3[Q];return oe(Y,i.formatLong)}return Y}).join("").match(Hte).map(Y=>{if(Y==="''")return{isToken:!1,value:"'"};const Q=Y[0];if(Q==="'")return{isToken:!1,value:Xte(Y)};if(aM[Q])return{isToken:!0,value:Y};if(Q.match(Kte))throw new RangeError("Format string contains an unescaped latin alphabet character `"+Q+"`");return{isToken:!1,value:Y}});i.localize.preprocessor&&(f=i.localize.preprocessor(o,f));const m={firstWeekContainsDate:l,weekStartsOn:a,locale:i};return f.map(Y=>{if(!Y.isToken)return Y.value;const Q=Y.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&b6(Q)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&_6(Q))&&O3(Q,t,String(e));const oe=aM[Q[0]];return oe(o,Q,i.localize,m)}).join("")}function Xte(e){const t=e.match(Wte);return t?t[1].replace(Zte,"'"):e}function Jte(){return Object.assign({},kg())}function Qte(e,t){const n=ys(e,t==null?void 0:t.in).getDay();return n===0?7:n}function ene(e,t){const n=tne(t)?new t(0):ou(t,0);return n.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),n.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),n}function tne(e){var t;return typeof e=="function"&&((t=e.prototype)==null?void 0:t.constructor)===e}const nne=10;class x6{constructor(){un(this,"subPriority",0)}validate(t,n){return!0}}class rne extends x6{constructor(t,n,r,i,l){super(),this.value=t,this.validateValue=n,this.setValue=r,this.priority=i,l&&(this.subPriority=l)}validate(t,n){return this.validateValue(t,this.value,n)}set(t,n,r){return this.setValue(t,n,this.value,r)}}class ine extends x6{constructor(n,r){super();un(this,"priority",nne);un(this,"subPriority",-1);this.context=n||(i=>ou(r,i))}set(n,r){return r.timestampIsSet?n:ou(n,ene(n,this.context))}}class wo{run(t,n,r,i){const l=this.parse(t,n,r,i);return l?{setter:new rne(l.value,this.validate,this.set,this.priority,this.subPriority),rest:l.rest}:null}validate(t,n,r){return!0}}class sne extends wo{constructor(){super(...arguments);un(this,"priority",140);un(this,"incompatibleTokens",["R","u","t","T"])}parse(n,r,i){switch(r){case"G":case"GG":case"GGG":return i.era(n,{width:"abbreviated"})||i.era(n,{width:"narrow"});case"GGGGG":return i.era(n,{width:"narrow"});case"GGGG":default:return i.era(n,{width:"wide"})||i.era(n,{width:"abbreviated"})||i.era(n,{width:"narrow"})}}set(n,r,i){return r.era=i,n.setFullYear(i,0,1),n.setHours(0,0,0,0),n}}const Pu={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},kf={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function Eu(e,t){return e&&{value:t(e.value),rest:e.rest}}function Dl(e,t){const n=t.match(e);return n?{value:parseInt(n[0],10),rest:t.slice(n[0].length)}:null}function If(e,t){const n=t.match(e);if(!n)return null;if(n[0]==="Z")return{value:0,rest:t.slice(1)};const r=n[1]==="+"?1:-1,i=n[2]?parseInt(n[2],10):0,l=n[3]?parseInt(n[3],10):0,a=n[5]?parseInt(n[5],10):0;return{value:r*(i*H_+l*G_+a*Dee),rest:t.slice(n[0].length)}}function w6(e){return Dl(Pu.anyDigitsSigned,e)}function au(e,t){switch(e){case 1:return Dl(Pu.singleDigit,t);case 2:return Dl(Pu.twoDigits,t);case 3:return Dl(Pu.threeDigits,t);case 4:return Dl(Pu.fourDigits,t);default:return Dl(new RegExp("^\\d{1,"+e+"}"),t)}}function l2(e,t){switch(e){case 1:return Dl(Pu.singleDigitSigned,t);case 2:return Dl(Pu.twoDigitsSigned,t);case 3:return Dl(Pu.threeDigitsSigned,t);case 4:return Dl(Pu.fourDigitsSigned,t);default:return Dl(new RegExp("^-?\\d{1,"+e+"}"),t)}}function sS(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function C6(e,t){const n=t>0,r=n?t:1-t;let i;if(r<=50)i=e||100;else{const l=r+50,a=Math.trunc(l/100)*100,o=e>=l%100;i=e+a-(o?100:0)}return n?i:1-i}function S6(e){return e%400===0||e%4===0&&e%100!==0}class one extends wo{constructor(){super(...arguments);un(this,"priority",130);un(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(n,r,i){const l=a=>({year:a,isTwoDigitYear:r==="yy"});switch(r){case"y":return Eu(au(4,n),l);case"yo":return Eu(i.ordinalNumber(n,{unit:"year"}),l);default:return Eu(au(r.length,n),l)}}validate(n,r){return r.isTwoDigitYear||r.year>0}set(n,r,i){const l=n.getFullYear();if(i.isTwoDigitYear){const o=C6(i.year,l);return n.setFullYear(o,0,1),n.setHours(0,0,0,0),n}const a=!("era"in r)||r.era===1?i.year:1-i.year;return n.setFullYear(a,0,1),n.setHours(0,0,0,0),n}}class ane extends wo{constructor(){super(...arguments);un(this,"priority",130);un(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(n,r,i){const l=a=>({year:a,isTwoDigitYear:r==="YY"});switch(r){case"Y":return Eu(au(4,n),l);case"Yo":return Eu(i.ordinalNumber(n,{unit:"year"}),l);default:return Eu(au(r.length,n),l)}}validate(n,r){return r.isTwoDigitYear||r.year>0}set(n,r,i,l){const a=iS(n,l);if(i.isTwoDigitYear){const f=C6(i.year,a);return n.setFullYear(f,0,l.firstWeekContainsDate),n.setHours(0,0,0,0),jf(n,l)}const o=!("era"in r)||r.era===1?i.year:1-i.year;return n.setFullYear(o,0,l.firstWeekContainsDate),n.setHours(0,0,0,0),jf(n,l)}}class lne extends wo{constructor(){super(...arguments);un(this,"priority",130);un(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(n,r){return l2(r==="R"?4:r.length,n)}set(n,r,i){const l=ou(n,0);return l.setFullYear(i,0,4),l.setHours(0,0,0,0),Y0(l)}}class une extends wo{constructor(){super(...arguments);un(this,"priority",130);un(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(n,r){return l2(r==="u"?4:r.length,n)}set(n,r,i){return n.setFullYear(i,0,1),n.setHours(0,0,0,0),n}}class cne extends wo{constructor(){super(...arguments);un(this,"priority",120);un(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(n,r,i){switch(r){case"Q":case"QQ":return au(r.length,n);case"Qo":return i.ordinalNumber(n,{unit:"quarter"});case"QQQ":return i.quarter(n,{width:"abbreviated",context:"formatting"})||i.quarter(n,{width:"narrow",context:"formatting"});case"QQQQQ":return i.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return i.quarter(n,{width:"wide",context:"formatting"})||i.quarter(n,{width:"abbreviated",context:"formatting"})||i.quarter(n,{width:"narrow",context:"formatting"})}}validate(n,r){return r>=1&&r<=4}set(n,r,i){return n.setMonth((i-1)*3,1),n.setHours(0,0,0,0),n}}class hne extends wo{constructor(){super(...arguments);un(this,"priority",120);un(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(n,r,i){switch(r){case"q":case"qq":return au(r.length,n);case"qo":return i.ordinalNumber(n,{unit:"quarter"});case"qqq":return i.quarter(n,{width:"abbreviated",context:"standalone"})||i.quarter(n,{width:"narrow",context:"standalone"});case"qqqqq":return i.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return i.quarter(n,{width:"wide",context:"standalone"})||i.quarter(n,{width:"abbreviated",context:"standalone"})||i.quarter(n,{width:"narrow",context:"standalone"})}}validate(n,r){return r>=1&&r<=4}set(n,r,i){return n.setMonth((i-1)*3,1),n.setHours(0,0,0,0),n}}class dne extends wo{constructor(){super(...arguments);un(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);un(this,"priority",110)}parse(n,r,i){const l=a=>a-1;switch(r){case"M":return Eu(Dl(Pu.month,n),l);case"MM":return Eu(au(2,n),l);case"Mo":return Eu(i.ordinalNumber(n,{unit:"month"}),l);case"MMM":return i.month(n,{width:"abbreviated",context:"formatting"})||i.month(n,{width:"narrow",context:"formatting"});case"MMMMM":return i.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return i.month(n,{width:"wide",context:"formatting"})||i.month(n,{width:"abbreviated",context:"formatting"})||i.month(n,{width:"narrow",context:"formatting"})}}validate(n,r){return r>=0&&r<=11}set(n,r,i){return n.setMonth(i,1),n.setHours(0,0,0,0),n}}class fne extends wo{constructor(){super(...arguments);un(this,"priority",110);un(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(n,r,i){const l=a=>a-1;switch(r){case"L":return Eu(Dl(Pu.month,n),l);case"LL":return Eu(au(2,n),l);case"Lo":return Eu(i.ordinalNumber(n,{unit:"month"}),l);case"LLL":return i.month(n,{width:"abbreviated",context:"standalone"})||i.month(n,{width:"narrow",context:"standalone"});case"LLLLL":return i.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return i.month(n,{width:"wide",context:"standalone"})||i.month(n,{width:"abbreviated",context:"standalone"})||i.month(n,{width:"narrow",context:"standalone"})}}validate(n,r){return r>=0&&r<=11}set(n,r,i){return n.setMonth(i,1),n.setHours(0,0,0,0),n}}function pne(e,t,n){const r=ys(e,n==null?void 0:n.in),i=y6(r,n)-t;return r.setDate(r.getDate()-i*7),ys(r,n==null?void 0:n.in)}class mne extends wo{constructor(){super(...arguments);un(this,"priority",100);un(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(n,r,i){switch(r){case"w":return Dl(Pu.week,n);case"wo":return i.ordinalNumber(n,{unit:"week"});default:return au(r.length,n)}}validate(n,r){return r>=1&&r<=53}set(n,r,i,l){return jf(pne(n,i,l),l)}}function gne(e,t,n){const r=ys(e,n==null?void 0:n.in),i=g6(r,n)-t;return r.setDate(r.getDate()-i*7),r}class yne extends wo{constructor(){super(...arguments);un(this,"priority",100);un(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(n,r,i){switch(r){case"I":return Dl(Pu.week,n);case"Io":return i.ordinalNumber(n,{unit:"week"});default:return au(r.length,n)}}validate(n,r){return r>=1&&r<=53}set(n,r,i){return Y0(gne(n,i))}}const vne=[31,28,31,30,31,30,31,31,30,31,30,31],_ne=[31,29,31,30,31,30,31,31,30,31,30,31];class bne extends wo{constructor(){super(...arguments);un(this,"priority",90);un(this,"subPriority",1);un(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(n,r,i){switch(r){case"d":return Dl(Pu.date,n);case"do":return i.ordinalNumber(n,{unit:"date"});default:return au(r.length,n)}}validate(n,r){const i=n.getFullYear(),l=S6(i),a=n.getMonth();return l?r>=1&&r<=_ne[a]:r>=1&&r<=vne[a]}set(n,r,i){return n.setDate(i),n.setHours(0,0,0,0),n}}class xne extends wo{constructor(){super(...arguments);un(this,"priority",90);un(this,"subpriority",1);un(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(n,r,i){switch(r){case"D":case"DD":return Dl(Pu.dayOfYear,n);case"Do":return i.ordinalNumber(n,{unit:"date"});default:return au(r.length,n)}}validate(n,r){const i=n.getFullYear();return S6(i)?r>=1&&r<=366:r>=1&&r<=365}set(n,r,i){return n.setMonth(0,i),n.setHours(0,0,0,0),n}}function oS(e,t,n){var w,M,C,R;const r=kg(),i=(n==null?void 0:n.weekStartsOn)??((M=(w=n==null?void 0:n.locale)==null?void 0:w.options)==null?void 0:M.weekStartsOn)??r.weekStartsOn??((R=(C=r.locale)==null?void 0:C.options)==null?void 0:R.weekStartsOn)??0,l=ys(e,n==null?void 0:n.in),a=l.getDay(),f=(t%7+7)%7,m=7-i,_=t<0||t>6?t-(a+m)%7:(f+m)%7-(a+m)%7;return X2(l,_,n)}class wne extends wo{constructor(){super(...arguments);un(this,"priority",90);un(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(n,r,i){switch(r){case"E":case"EE":case"EEE":return i.day(n,{width:"abbreviated",context:"formatting"})||i.day(n,{width:"short",context:"formatting"})||i.day(n,{width:"narrow",context:"formatting"});case"EEEEE":return i.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(n,{width:"short",context:"formatting"})||i.day(n,{width:"narrow",context:"formatting"});case"EEEE":default:return i.day(n,{width:"wide",context:"formatting"})||i.day(n,{width:"abbreviated",context:"formatting"})||i.day(n,{width:"short",context:"formatting"})||i.day(n,{width:"narrow",context:"formatting"})}}validate(n,r){return r>=0&&r<=6}set(n,r,i,l){return n=oS(n,i,l),n.setHours(0,0,0,0),n}}class Cne extends wo{constructor(){super(...arguments);un(this,"priority",90);un(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(n,r,i,l){const a=o=>{const f=Math.floor((o-1)/7)*7;return(o+l.weekStartsOn+6)%7+f};switch(r){case"e":case"ee":return Eu(au(r.length,n),a);case"eo":return Eu(i.ordinalNumber(n,{unit:"day"}),a);case"eee":return i.day(n,{width:"abbreviated",context:"formatting"})||i.day(n,{width:"short",context:"formatting"})||i.day(n,{width:"narrow",context:"formatting"});case"eeeee":return i.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(n,{width:"short",context:"formatting"})||i.day(n,{width:"narrow",context:"formatting"});case"eeee":default:return i.day(n,{width:"wide",context:"formatting"})||i.day(n,{width:"abbreviated",context:"formatting"})||i.day(n,{width:"short",context:"formatting"})||i.day(n,{width:"narrow",context:"formatting"})}}validate(n,r){return r>=0&&r<=6}set(n,r,i,l){return n=oS(n,i,l),n.setHours(0,0,0,0),n}}class Sne extends wo{constructor(){super(...arguments);un(this,"priority",90);un(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(n,r,i,l){const a=o=>{const f=Math.floor((o-1)/7)*7;return(o+l.weekStartsOn+6)%7+f};switch(r){case"c":case"cc":return Eu(au(r.length,n),a);case"co":return Eu(i.ordinalNumber(n,{unit:"day"}),a);case"ccc":return i.day(n,{width:"abbreviated",context:"standalone"})||i.day(n,{width:"short",context:"standalone"})||i.day(n,{width:"narrow",context:"standalone"});case"ccccc":return i.day(n,{width:"narrow",context:"standalone"});case"cccccc":return i.day(n,{width:"short",context:"standalone"})||i.day(n,{width:"narrow",context:"standalone"});case"cccc":default:return i.day(n,{width:"wide",context:"standalone"})||i.day(n,{width:"abbreviated",context:"standalone"})||i.day(n,{width:"short",context:"standalone"})||i.day(n,{width:"narrow",context:"standalone"})}}validate(n,r){return r>=0&&r<=6}set(n,r,i,l){return n=oS(n,i,l),n.setHours(0,0,0,0),n}}function Lne(e,t,n){const r=ys(e,n==null?void 0:n.in),i=Qte(r,n),l=t-i;return X2(r,l,n)}class Pne extends wo{constructor(){super(...arguments);un(this,"priority",90);un(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(n,r,i){const l=a=>a===0?7:a;switch(r){case"i":case"ii":return au(r.length,n);case"io":return i.ordinalNumber(n,{unit:"day"});case"iii":return Eu(i.day(n,{width:"abbreviated",context:"formatting"})||i.day(n,{width:"short",context:"formatting"})||i.day(n,{width:"narrow",context:"formatting"}),l);case"iiiii":return Eu(i.day(n,{width:"narrow",context:"formatting"}),l);case"iiiiii":return Eu(i.day(n,{width:"short",context:"formatting"})||i.day(n,{width:"narrow",context:"formatting"}),l);case"iiii":default:return Eu(i.day(n,{width:"wide",context:"formatting"})||i.day(n,{width:"abbreviated",context:"formatting"})||i.day(n,{width:"short",context:"formatting"})||i.day(n,{width:"narrow",context:"formatting"}),l)}}validate(n,r){return r>=1&&r<=7}set(n,r,i){return n=Lne(n,i),n.setHours(0,0,0,0),n}}class Ene extends wo{constructor(){super(...arguments);un(this,"priority",80);un(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(n,r,i){switch(r){case"a":case"aa":case"aaa":return i.dayPeriod(n,{width:"abbreviated",context:"formatting"})||i.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaaa":return i.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return i.dayPeriod(n,{width:"wide",context:"formatting"})||i.dayPeriod(n,{width:"abbreviated",context:"formatting"})||i.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,r,i){return n.setHours(sS(i),0,0,0),n}}class Mne extends wo{constructor(){super(...arguments);un(this,"priority",80);un(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(n,r,i){switch(r){case"b":case"bb":case"bbb":return i.dayPeriod(n,{width:"abbreviated",context:"formatting"})||i.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbbb":return i.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return i.dayPeriod(n,{width:"wide",context:"formatting"})||i.dayPeriod(n,{width:"abbreviated",context:"formatting"})||i.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,r,i){return n.setHours(sS(i),0,0,0),n}}class Tne extends wo{constructor(){super(...arguments);un(this,"priority",80);un(this,"incompatibleTokens",["a","b","t","T"])}parse(n,r,i){switch(r){case"B":case"BB":case"BBB":return i.dayPeriod(n,{width:"abbreviated",context:"formatting"})||i.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBBB":return i.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return i.dayPeriod(n,{width:"wide",context:"formatting"})||i.dayPeriod(n,{width:"abbreviated",context:"formatting"})||i.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,r,i){return n.setHours(sS(i),0,0,0),n}}class Ane extends wo{constructor(){super(...arguments);un(this,"priority",70);un(this,"incompatibleTokens",["H","K","k","t","T"])}parse(n,r,i){switch(r){case"h":return Dl(Pu.hour12h,n);case"ho":return i.ordinalNumber(n,{unit:"hour"});default:return au(r.length,n)}}validate(n,r){return r>=1&&r<=12}set(n,r,i){const l=n.getHours()>=12;return l&&i<12?n.setHours(i+12,0,0,0):!l&&i===12?n.setHours(0,0,0,0):n.setHours(i,0,0,0),n}}class kne extends wo{constructor(){super(...arguments);un(this,"priority",70);un(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(n,r,i){switch(r){case"H":return Dl(Pu.hour23h,n);case"Ho":return i.ordinalNumber(n,{unit:"hour"});default:return au(r.length,n)}}validate(n,r){return r>=0&&r<=23}set(n,r,i){return n.setHours(i,0,0,0),n}}class Ine extends wo{constructor(){super(...arguments);un(this,"priority",70);un(this,"incompatibleTokens",["h","H","k","t","T"])}parse(n,r,i){switch(r){case"K":return Dl(Pu.hour11h,n);case"Ko":return i.ordinalNumber(n,{unit:"hour"});default:return au(r.length,n)}}validate(n,r){return r>=0&&r<=11}set(n,r,i){return n.getHours()>=12&&i<12?n.setHours(i+12,0,0,0):n.setHours(i,0,0,0),n}}class Dne extends wo{constructor(){super(...arguments);un(this,"priority",70);un(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(n,r,i){switch(r){case"k":return Dl(Pu.hour24h,n);case"ko":return i.ordinalNumber(n,{unit:"hour"});default:return au(r.length,n)}}validate(n,r){return r>=1&&r<=24}set(n,r,i){const l=i<=24?i%24:i;return n.setHours(l,0,0,0),n}}class One extends wo{constructor(){super(...arguments);un(this,"priority",60);un(this,"incompatibleTokens",["t","T"])}parse(n,r,i){switch(r){case"m":return Dl(Pu.minute,n);case"mo":return i.ordinalNumber(n,{unit:"minute"});default:return au(r.length,n)}}validate(n,r){return r>=0&&r<=59}set(n,r,i){return n.setMinutes(i,0,0),n}}class Rne extends wo{constructor(){super(...arguments);un(this,"priority",50);un(this,"incompatibleTokens",["t","T"])}parse(n,r,i){switch(r){case"s":return Dl(Pu.second,n);case"so":return i.ordinalNumber(n,{unit:"second"});default:return au(r.length,n)}}validate(n,r){return r>=0&&r<=59}set(n,r,i){return n.setSeconds(i,0),n}}class Bne extends wo{constructor(){super(...arguments);un(this,"priority",30);un(this,"incompatibleTokens",["t","T"])}parse(n,r){const i=l=>Math.trunc(l*Math.pow(10,-r.length+3));return Eu(au(r.length,n),i)}set(n,r,i){return n.setMilliseconds(i),n}}class Nne extends wo{constructor(){super(...arguments);un(this,"priority",10);un(this,"incompatibleTokens",["t","T","x"])}parse(n,r){switch(r){case"X":return If(kf.basicOptionalMinutes,n);case"XX":return If(kf.basic,n);case"XXXX":return If(kf.basicOptionalSeconds,n);case"XXXXX":return If(kf.extendedOptionalSeconds,n);case"XXX":default:return If(kf.extended,n)}}set(n,r,i){return r.timestampIsSet?n:ou(n,n.getTime()-a2(n)-i)}}class Fne extends wo{constructor(){super(...arguments);un(this,"priority",10);un(this,"incompatibleTokens",["t","T","X"])}parse(n,r){switch(r){case"x":return If(kf.basicOptionalMinutes,n);case"xx":return If(kf.basic,n);case"xxxx":return If(kf.basicOptionalSeconds,n);case"xxxxx":return If(kf.extendedOptionalSeconds,n);case"xxx":default:return If(kf.extended,n)}}set(n,r,i){return r.timestampIsSet?n:ou(n,n.getTime()-a2(n)-i)}}class zne extends wo{constructor(){super(...arguments);un(this,"priority",40);un(this,"incompatibleTokens","*")}parse(n){return w6(n)}set(n,r,i){return[ou(n,i*1e3),{timestampIsSet:!0}]}}class jne extends wo{constructor(){super(...arguments);un(this,"priority",20);un(this,"incompatibleTokens","*")}parse(n){return w6(n)}set(n,r,i){return[ou(n,i),{timestampIsSet:!0}]}}const Une={G:new sne,y:new one,Y:new ane,R:new lne,u:new une,Q:new cne,q:new hne,M:new dne,L:new fne,w:new mne,I:new yne,d:new bne,D:new xne,E:new wne,e:new Cne,c:new Sne,i:new Pne,a:new Ene,b:new Mne,B:new Tne,h:new Ane,H:new kne,K:new Ine,k:new Dne,m:new One,s:new Rne,S:new Bne,X:new Nne,x:new Fne,t:new zne,T:new jne},Vne=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,$ne=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Gne=/^'([^]*?)'?$/,Hne=/''/g,qne=/\S/,Wne=/[a-zA-Z]/;function Zne(e,t,n,r){var W,X,Y,Q,oe,le,me,we;const i=()=>ou((r==null?void 0:r.in)||n,NaN),l=Jte(),a=(r==null?void 0:r.locale)??l.locale??m6,o=(r==null?void 0:r.firstWeekContainsDate)??((X=(W=r==null?void 0:r.locale)==null?void 0:W.options)==null?void 0:X.firstWeekContainsDate)??l.firstWeekContainsDate??((Q=(Y=l.locale)==null?void 0:Y.options)==null?void 0:Q.firstWeekContainsDate)??1,f=(r==null?void 0:r.weekStartsOn)??((le=(oe=r==null?void 0:r.locale)==null?void 0:oe.options)==null?void 0:le.weekStartsOn)??l.weekStartsOn??((we=(me=l.locale)==null?void 0:me.options)==null?void 0:we.weekStartsOn)??0;if(!t)return e?i():ys(n,r==null?void 0:r.in);const m={firstWeekContainsDate:o,weekStartsOn:f,locale:a},_=[new ine(r==null?void 0:r.in,n)],w=t.match($ne).map(ue=>{const _e=ue[0];if(_e in D3){const We=D3[_e];return We(ue,a.formatLong)}return ue}).join("").match(Vne),M=[];for(let ue of w){!(r!=null&&r.useAdditionalWeekYearTokens)&&b6(ue)&&O3(ue,t,e),!(r!=null&&r.useAdditionalDayOfYearTokens)&&_6(ue)&&O3(ue,t,e);const _e=ue[0],We=Une[_e];if(We){const{incompatibleTokens:he}=We;if(Array.isArray(he)){const Te=M.find(be=>he.includes(be.token)||be.token===_e);if(Te)throw new RangeError(`The format string mustn't contain \`${Te.fullToken}\` and \`${ue}\` at the same time`)}else if(We.incompatibleTokens==="*"&&M.length>0)throw new RangeError(`The format string mustn't contain \`${ue}\` and any other token at the same time`);M.push({token:_e,fullToken:ue});const de=We.run(e,ue,a.match,m);if(!de)return i();_.push(de.setter),e=de.rest}else{if(_e.match(Wne))throw new RangeError("Format string contains an unescaped latin alphabet character `"+_e+"`");if(ue==="''"?ue="'":_e==="'"&&(ue=Kne(ue)),e.indexOf(ue)===0)e=e.slice(ue.length);else return i()}}if(e.length>0&&qne.test(e))return i();const C=_.map(ue=>ue.priority).sort((ue,_e)=>_e-ue).filter((ue,_e,We)=>We.indexOf(ue)===_e).map(ue=>_.filter(_e=>_e.priority===ue).sort((_e,We)=>We.subPriority-_e.subPriority)).map(ue=>ue[0]);let R=ys(n,r==null?void 0:r.in);if(isNaN(+R))return i();const z={};for(const ue of C){if(!ue.validate(R,m))return i();const _e=ue.set(R,z,m);Array.isArray(_e)?(R=_e[0],Object.assign(z,_e[1])):R=_e}return R}function Kne(e){return e.match(Gne)[1].replace(Hne,"'")}function Yne(e,t){const n=ys(e,t==null?void 0:t.in);return n.setMinutes(0,0,0),n}function Xne(e,t){const n=ys(e,t==null?void 0:t.in);return n.setSeconds(0,0),n}function Jne(e,t){const n=ys(e,t==null?void 0:t.in);return n.setMilliseconds(0),n}function Qne(e,t){const n=()=>ou(t==null?void 0:t.in,NaN),r=(t==null?void 0:t.additionalDigits)??2,i=rre(e);let l;if(i.date){const m=ire(i.date,r);l=sre(m.restDateString,m.year)}if(!l||isNaN(+l))return n();const a=+l;let o=0,f;if(i.time&&(o=ore(i.time),isNaN(o)))return n();if(i.timezone){if(f=are(i.timezone),isNaN(f))return n()}else{const m=new Date(a+o),_=ys(0,t==null?void 0:t.in);return _.setFullYear(m.getUTCFullYear(),m.getUTCMonth(),m.getUTCDate()),_.setHours(m.getUTCHours(),m.getUTCMinutes(),m.getUTCSeconds(),m.getUTCMilliseconds()),_}return ys(a+o+f,t==null?void 0:t.in)}const Hb={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},ere=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,tre=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,nre=/^([+-])(\d{2})(?::?(\d{2}))?$/;function rre(e){const t={},n=e.split(Hb.dateTimeDelimiter);let r;if(n.length>2)return t;if(/:/.test(n[0])?r=n[0]:(t.date=n[0],r=n[1],Hb.timeZoneDelimiter.test(t.date)&&(t.date=e.split(Hb.timeZoneDelimiter)[0],r=e.substr(t.date.length,e.length))),r){const i=Hb.timezone.exec(r);i?(t.time=r.replace(i[1],""),t.timezone=i[1]):t.time=r}return t}function ire(e,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=e.match(n);if(!r)return{year:NaN,restDateString:""};const i=r[1]?parseInt(r[1]):null,l=r[2]?parseInt(r[2]):null;return{year:l===null?i:l*100,restDateString:e.slice((r[1]||r[2]).length)}}function sre(e,t){if(t===null)return new Date(NaN);const n=e.match(ere);if(!n)return new Date(NaN);const r=!!n[4],i=bv(n[1]),l=bv(n[2])-1,a=bv(n[3]),o=bv(n[4]),f=bv(n[5])-1;if(r)return dre(t,o,f)?lre(t,o,f):new Date(NaN);{const m=new Date(0);return!cre(t,l,a)||!hre(t,i)?new Date(NaN):(m.setUTCFullYear(t,l,Math.max(i,a)),m)}}function bv(e){return e?parseInt(e):1}function ore(e){const t=e.match(tre);if(!t)return NaN;const n=g4(t[1]),r=g4(t[2]),i=g4(t[3]);return fre(n,r,i)?n*H_+r*G_+i*1e3:NaN}function g4(e){return e&&parseFloat(e.replace(",","."))||0}function are(e){if(e==="Z")return 0;const t=e.match(nre);if(!t)return 0;const n=t[1]==="+"?-1:1,r=parseInt(t[2]),i=t[3]&&parseInt(t[3])||0;return pre(r,i)?n*(r*H_+i*G_):NaN}function lre(e,t,n){const r=new Date(0);r.setUTCFullYear(e,0,4);const i=r.getUTCDay()||7,l=(t-1)*7+n+1-i;return r.setUTCDate(r.getUTCDate()+l),r}const ure=[31,null,31,30,31,30,31,31,30,31,30,31];function L6(e){return e%400===0||e%4===0&&e%100!==0}function cre(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(ure[t]||(L6(e)?29:28))}function hre(e,t){return t>=1&&t<=(L6(e)?366:365)}function dre(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}function fre(e,t,n){return e===24?t===0&&n===0:n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}function pre(e,t){return t>=0&&t<=59}/*!
 * chartjs-adapter-date-fns v3.0.0
 * https://www.chartjs.org
 * (c) 2022 chartjs-adapter-date-fns Contributors
 * Released under the MIT license
 */const mre={datetime:"MMM d, yyyy, h:mm:ss aaaa",millisecond:"h:mm:ss.SSS aaaa",second:"h:mm:ss aaaa",minute:"h:mm aaaa",hour:"ha",day:"MMM d",week:"PP",month:"MMM yyyy",quarter:"qqq - yyyy",year:"yyyy"};zI._date.override({_id:"date-fns",formats:function(){return mre},parse:function(e,t){if(e===null||typeof e>"u")return null;const n=typeof e;return n==="number"||e instanceof Date?e=ys(e):n==="string"&&(typeof t=="string"?e=Zne(e,t,new Date,this.options):e=Qne(e,this.options)),u6(e)?e.getTime():null},format:function(e,t){return Yte(e,t,this.options)},add:function(e,t,n){switch(n){case"millisecond":return nS(e,t);case"second":return zee(e,t);case"minute":return Nee(e,t);case"hour":return Oee(e,t);case"day":return X2(e,t);case"week":return jee(e,t);case"month":return tS(e,t);case"quarter":return Fee(e,t);case"year":return Uee(e,t);default:return e}},diff:function(e,t,n){switch(n){case"millisecond":return rS(e,t);case"second":return Kee(e,t);case"minute":return qee(e,t);case"hour":return Hee(e,t);case"day":return c6(e,t);case"week":return Yee(e,t);case"month":return f6(e,t);case"quarter":return Zee(e,t);case"year":return Xee(e,t);default:return 0}},startOf:function(e,t,n){switch(t){case"second":return Jne(e);case"minute":return Xne(e);case"hour":return Yne(e);case"day":return I3(e);case"week":return jf(e);case"isoWeek":return jf(e,{weekStartsOn:+n});case"month":return Qee(e);case"quarter":return Jee(e);case"year":return p6(e);default:return e}},endOf:function(e,t){switch(t){case"second":return ste(e);case"minute":return rte(e);case"hour":return tte(e);case"day":return h6(e);case"week":return nte(e);case"month":return d6(e);case"quarter":return ite(e);case"year":return ete(e);default:return e}}});const gre={class:"container mx-auto px-4 py-8 min-h-full"},yre={class:"mb-8"},vre={key:0,class:"mb-6"},_re={class:"flex gap-4"},bre=["disabled"],xre={key:0,value:""},wre=["value"],Cre={key:1,class:"mb-6 p-4 bg-red-50 border border-red-200 rounded-md"},Sre={class:"flex"},Lre={class:"ml-3"},Pre={class:"text-sm font-medium text-red-800"},Ere={key:2,class:"mb-6 p-6 bg-gray-100 border border-gray-300 rounded-md text-center"},Mre={class:"flex flex-col items-center"},Tre={class:"text-gray-600 mb-4"},Are={key:0,class:"mt-2"},kre={key:3,class:"mb-6"},Ire={class:"flex gap-4"},Dre=["disabled"],Ore={key:0,value:""},Rre={key:1,value:""},Bre=["value"],Nre=["disabled"],Fre={key:0,class:"mt-4 bg-white rounded-lg shadow-md p-4"},zre={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm"},jre={class:"font-medium"},Ure={class:"font-medium"},Vre={class:"font-medium"},$re={class:"text-gray-500"},Gre={class:"font-medium"},Hre={class:"font-medium"},qre={class:"font-medium"},Wre={class:"md:col-span-2 lg:col-span-3 flex items-center"},Zre=["href"],Kre={key:4,class:"mb-6"},Yre={class:"border-b border-gray-200"},Xre={class:"-mb-px flex space-x-8","aria-label":"Tabs"},Jre=["onClick"],Qre={key:5,class:"mb-8"},eie={class:"flex justify-between items-center mb-4"},tie={class:"text-sm text-gray-600"},nie={key:0,class:"flex items-center"},rie={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},iie={class:"bg-white rounded-lg shadow-md p-6"},sie={class:"text-4xl font-bold text-primary-600 mb-2"},oie={class:"text-sm text-gray-600"},aie={class:"bg-white rounded-lg shadow-md p-6"},lie={class:"text-4xl font-bold text-primary-600 mb-2"},uie={class:"mt-4"},cie={class:"w-full bg-gray-200 rounded-full h-2.5"},hie={class:"bg-white rounded-lg shadow-md p-6"},die={class:"text-4xl font-bold text-primary-600 mb-2"},fie={class:"text-sm text-gray-600"},pie={class:"bg-white rounded-lg shadow-md p-6"},mie={class:"text-4xl font-bold text-primary-600 mb-2"},gie={class:"text-sm text-gray-600"},yie={class:"bg-white rounded-lg shadow-md p-6"},vie={class:"text-4xl font-bold text-primary-600 mb-2"},_ie={class:"text-sm text-gray-600"},bie={class:"bg-white rounded-lg shadow-md p-6"},xie={class:"text-4xl font-bold text-primary-600 mb-2"},wie={class:"text-sm text-gray-600"},Cie={key:6,class:"mb-8"},Sie={class:"flex justify-between items-center mb-4"},Lie={class:"text-sm text-gray-600"},Pie={class:"flex items-center"},Eie={key:0,class:"flex items-center mr-3"},Mie=["disabled"],Tie={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},Aie={key:0,class:"md:col-span-2 grid grid-cols-2 gap-4"},kie=["value"],Iie={key:0,class:"mt-1 text-sm text-red-600"},Die={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Oie={class:"bg-white rounded-lg shadow-md p-6"},Rie={class:"chart-container"},Bie={class:"bg-white rounded-lg shadow-md p-6"},Nie={class:"chart-container"},Fie={class:"bg-white rounded-lg shadow-md p-6"},zie={class:"chart-container"},jie={class:"bg-white rounded-lg shadow-md p-6"},Uie={class:"chart-container"},Vie={class:"bg-white rounded-lg shadow-md p-6"},$ie={class:"chart-container"},Gie={class:"bg-white rounded-lg shadow-md p-6"},Hie={class:"chart-container"},qie=Ja({__name:"MeteoView",setup(e){const t=Lh(),n=Mu(),r=Rn({}),i=Rn(new Date),l=Rn(""),a=Rn([]),o=Rn(""),f=Rn([]),m=Rn(null),_=Rn(""),w=Rn(""),M=Rn(!1);Ai(()=>{var Be;return((Be=n.user)==null?void 0:Be.user_type)||""});const C=Ai(()=>n.isAdmin);let R=null;const z=Ai(()=>!o.value||!a.value.length?null:a.value.find(Be=>Be.mac===o.value));function W(Be){return Be?Be.latitude&&Be.longitude&&Be.latitude!==0&&Be.longitude!==0:!1}function X(Be){return W(Be)?`${Be.latitude.toFixed(6)}, ${Be.longitude.toFixed(6)}`:""}function Y(Be){if(!W(Be))return"#";const Ce=Be.latitude,ot=Be.longitude,Dt=Be.name||"Station météo";return require("@/utils/googleMapsLoader").getGoogleMapsSearchUrl(Ce,ot,Dt)}async function Q(){try{_.value="";const Be={};C.value&&m.value&&(Be.entreprise=m.value);const Ce=await k5.getDevices(Be);let ot=[];if(Ce.data&&Ce.data.devices&&Array.isArray(Ce.data.devices)&&Ce.data.devices.length>0&&typeof Ce.data.devices[1]=="string"){let Dt=Ce.data.devices[1];_.value=Dt,console.warn("[fetchDevices] Message d'erreur API reçu:",_.value);return}if(Ce.data&&Ce.data.devices&&Array.isArray(Ce.data.devices))ot=Ce.data.devices;else if(Array.isArray(Ce.data))ot=Ce.data;else if(typeof Ce.data=="object"&&Ce.data!==null){for(const Dt in Ce.data)if(Array.isArray(Ce.data[Dt])){ot=Ce.data[Dt];break}}a.value=ot.filter(Dt=>Dt!==null&&typeof Dt=="object").map(Dt=>{var an,ln;const Zt=Dt.mac||Dt.imei;return{id:Dt.id,name:Dt.name||`Station ${Zt}`,mac:Zt,model:((an=Dt.stationtype)==null?void 0:an.split("_")[0])||"Inconnu",firmware_version:(ln=Dt.stationtype)!=null&&ln.includes("_V")?Dt.stationtype.split("_V")[1]:"1.0",timezone:Dt.date_zone_id||"UTC",created_at:Dt.createtime?new Date(Dt.createtime*1e3).toISOString():new Date().toISOString(),latitude:Dt.latitude||0,longitude:Dt.longitude||0}}),a.value.length>0?o.value=a.value[0].mac:(console.warn("[fetchDevices] Aucun appareil disponible"),r.value={})}catch(Be){console.error("[fetchDevices] Erreur lors de la récupération des appareils:",Be),Be.response&&Be.response.data&&Be.response.data.error?_.value=Be.response.data.error:(_.value="Erreur lors de la récupération des stations météo",t.error("Erreur lors de la récupération des stations météo")),a.value=[],o.value="",r.value={}}}async function oe(){try{if(!o.value){console.warn("[fetchWeatherData] Aucun appareil sélectionné");return}_.value="",M.value=!0;const Be={mac:o.value};C.value&&m.value&&(Be.entreprise=m.value);const Ce=await k5.getRealTimeData(Be);let ot;Ce.data&&"data"in Ce.data?ot=Ce.data.data:Ce.data&&("outdoor"in Ce.data||"indoor"in Ce.data)?ot=Ce.data:(ot={},console.warn("[fetchWeatherData] Format de réponse non reconnu")),r.value=ot,i.value=new Date,l.value=new Date().toLocaleString(),_.value=""}catch(Be){console.error("[fetchWeatherData] Erreur lors de la récupération des données météo:",Be),Be.response&&Be.response.data&&Be.response.data.error?_.value=Be.response.data.error:(_.value="Erreur lors de la récupération des données météo",t.error("Erreur lors de la récupération des données météo")),r.value={}}finally{M.value=!1}}function le(Be){if(Be==null)return"0";const Ce=typeof Be=="string"?parseFloat(Be):Be;return isNaN(Ce)?"0":((Ce-32)*5/9).toFixed(1)}function me(Be){if(Be==null)return"0";const Ce=typeof Be=="string"?parseFloat(Be):Be;return isNaN(Ce)?"0":(Ce*1.60934).toFixed(1)}function we(Be){if(Be==null)return"0";const Ce=typeof Be=="string"?parseFloat(Be):Be;return isNaN(Ce)?"0":(Ce*25.4).toFixed(1)}function ue(Be){if(Be==null)return"0";const Ce=typeof Be=="string"?parseFloat(Be):Be;return isNaN(Ce)?"0":(Ce*33.8639).toFixed(1)}function _e(Be){if(!Be)return"N/A";const Ce=["N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSO","SO","OSO","O","ONO","NO","NNO"],ot=Math.round(Be/22.5)%16;return Ce[ot]}function We(Be){return Be?Be>0?"En hausse":"En baisse":"Stable"}async function he(){if(C.value)try{const Be=await Bc.getUsers({role:"ENTREPRISE"});f.value=Be.data,f.value.length>0&&!m.value&&(m.value=f.value[0].id)}catch(Be){console.error("Erreur lors de la récupération des entreprises:",Be),t.error("Erreur lors de la récupération des entreprises")}}async function de(){try{a.value=[],o.value="",r.value={},_.value="",Object.values(Mt).forEach(Be=>{try{Be.destroy()}catch(Ce){console.error("Erreur lors de la destruction d'un graphique:",Ce)}}),Mt={},await Q()}catch(Be){console.error("Erreur lors de la récupération des appareils avec l'entreprise:",Be),t.error("Erreur lors du changement d'entreprise")}}const Te=[{id:"realtime",name:"Temps réel"},{id:"history",name:"Historique"}],be=Rn("realtime"),ae=Rn("today"),ne=Rn("5min"),Se=Rn(""),Le=Rn(""),ze=()=>{const Be=new Date,Ce=new Date(Be);Ce.setDate(Be.getDate()-1),Se.value=Ce.toISOString().split("T")[0],Le.value=Ce.toISOString().split("T")[0]},He=[{value:"5min",label:"5 minutes",maxDays:1,maxPastDays:90},{value:"30min",label:"30 minutes",maxDays:7,maxPastDays:365},{value:"4hour",label:"4 heures",maxDays:31,maxPastDays:730},{value:"1day",label:"1 jour",maxDays:365,maxPastDays:1460}],pt=Ai(()=>{const Be=wt(),Ce=new Date(Be.start),ot=new Date(Be.end);ot.setHours(23,59,59,999);const Dt=Math.abs(ot.getTime()-Ce.getTime()),Zt=Math.ceil(Dt/(1e3*60*60*24)),ln=Math.abs(new Date().getTime()-Ce.getTime()),vn=Math.ceil(ln/(1e3*60*60*24));return He.filter(qn=>Zt<=qn.maxDays&&vn<=qn.maxPastDays)});mo(ae,Be=>{Be==="custom"&&ze(),!pt.value.some(ot=>ot.value===ne.value)&&pt.value.length>0&&(ne.value=pt.value[0].value)}),mo([Se,Le],()=>{ae.value==="custom"&&!pt.value.some(Ce=>Ce.value===ne.value)&&pt.value.length>0&&(ne.value=pt.value[0].value)});const ge=Rn(null),Ie=Rn(null),Ne=Rn(null),Ve=Rn(null),it=Rn(null),lt=Rn(null);let Mt={};const wt=()=>{let Be=new Date,Ce=new Date;switch(ae.value){case"today":Be.setHours(0,0,0,0);break;case"yesterday":Be.setDate(Be.getDate()-1),Be.setHours(0,0,0,0),Ce.setDate(Ce.getDate()-1),Ce.setHours(23,59,59,999);break;case"week":Be.setDate(Be.getDate()-7);break;case"month":Be.setDate(Be.getDate()-30);break;case"custom":Be=new Date(Se.value),Ce=new Date(Le.value);break}return{start:Be.toISOString().split("T")[0],end:Ce.toISOString().split("T")[0]}},rn=async()=>{try{if(yn.value)return;if(yn.value=!0,pt.value.length===0){t.warning("Aucun intervalle disponible pour cette période"),yn.value=!1;return}pt.value.some(Dt=>Dt.value===ne.value)||(ne.value=pt.value[0].value);const Ce=wt(),ot={mac:o.value,start_date:Ce.start,end_date:Ce.end,cycle_type:ne.value};C.value&&m.value&&(ot.entreprise=m.value);try{const Zt=(await k5.getHistoryData(ot)).data,an=[{type:"temp",ref:ge},{type:"humidity",ref:Ie},{type:"pressure",ref:Ne},{type:"wind",ref:Ve},{type:"rain",ref:it},{type:"solar",ref:lt}];for(const ln of an)if(ln.ref.value){const vn=Ae(Zt,ln.type);Pn(ln.type,ln.ref.value,vn)}l.value=new Date().toLocaleString()}catch(Dt){console.error("[updateAllCharts] Erreur lors de la récupération des données:",Dt),t.error("Erreur lors de la récupération des données historiques")}finally{yn.value=!1}}catch(Be){console.error("[updateAllCharts] Erreur lors de la mise à jour des graphiques:",Be),t.error("Erreur lors de la mise à jour des graphiques"),yn.value=!1}},yn=Rn(!1),Pn=(Be,Ce,ot)=>{try{if(Mt[Be]&&(Mt[Be].destroy(),delete Mt[Be]),!ot.datasets||!ot.datasets.length){console.warn(`[updateChart] Pas de datasets pour ${Be}`),Mt[Be]=new Af(Ce,{type:"line",data:{labels:[],datasets:[]},options:{plugins:{title:{display:!0,text:"Aucune donnée disponible"}}}});return}let Dt="hour";ne.value==="5min"||ne.value==="30min"?Dt="hour":(ne.value==="4hour"||ne.value==="1day")&&(Dt="day");const Zt=wt(),an=new Date(Zt.start),ln=new Date(Zt.end);ln.setHours(23,59,59,999);const vn={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},tooltip:{mode:"index",intersect:!1,callbacks:{title:function(qn){return qn.length>0?new Date(qn[0].parsed.x).toLocaleString():""}}}},scales:{x:{type:"time",time:{unit:Dt,displayFormats:{hour:"HH:mm",day:"dd/MM",week:"dd/MM",month:"MM/yyyy"}},min:an.getTime(),max:ln.getTime(),title:{display:!0,text:"Date/Heure"}},y:{beginAtZero:!0,title:{display:!0,text:De(Be)},ticks:{callback:function(qn){const Kn=typeof qn=="string"?parseFloat(qn):qn;switch(Be){case"temp":return Kn.toFixed(1)+"°C";case"humidity":return Kn.toFixed(0)+"%";case"pressure":return Kn.toFixed(0)+" hPa";case"wind":case"rain":return Kn.toFixed(1)+(Be==="wind"?" km/h":" mm");case"solar":return Kn.toFixed(0)+" W/m²";default:return Kn}}}}},interaction:{mode:"nearest",axis:"x",intersect:!1}};Mt[Be]=new Af(Ce,{type:"line",data:{datasets:ot.datasets||[]},options:vn})}catch(Dt){console.error(`[updateChart] Erreur lors de la mise à jour du graphique ${Be}:`,Dt)}},De=Be=>{switch(Be){case"temp":return"Température (°C)";case"humidity":return"Humidité (%)";case"pressure":return"Pression (hPa)";case"wind":return"Vitesse (km/h)";case"rain":return"Précipitations (mm)";case"solar":return"Rayonnement (W/m²)";default:return""}},Ae=(Be,Ce)=>{var an,ln,vn,qn,Kn,cr,pr,Dr,zr,Ht,tn,Kt,Yn,ir,Fr,Ft,je,Ze,et;if(!Be)return console.warn(`[formatHistoryDataForChart] Pas de données pour ${Ce}`),null;let ot;if("data"in Be)ot=Be.data;else if(Ce in Be)ot=Be;else return console.warn(`[formatHistoryDataForChart] Structure de données non reconnue pour ${Ce}`),null;const Dt=[],Zt=(ct,$e,Gt,hn)=>{if(!Array.isArray(ct)){console.warn(`[formatHistoryDataForChart] Les données pour ${$e} ne sont pas un tableau`);return}const Ot=ct.map(cn=>{const En=parseFloat(String(cn.value));return{x:cn.time,y:hn?hn(En):En}}).filter(cn=>!isNaN(cn.y));Ot.length>0&&Dt.push({label:$e,data:Ot,borderColor:Gt,fill:!1,tension:.4})};switch(Ce){case"temp":(ln=(an=ot.outdoor)==null?void 0:an.temperature)!=null&&ln.list?Zt(Object.entries(ot.outdoor.temperature.list).map(([ct,$e])=>({time:parseInt(ct)*1e3,value:$e})),"Température","#FF6384",ct=>(ct-32)*5/9):(vn=ot.outdoor)!=null&&vn.temperature&&Zt(ot.outdoor.temperature,"Température","#FF6384",ct=>(ct-32)*5/9);break;case"humidity":(Kn=(qn=ot.outdoor)==null?void 0:qn.humidity)!=null&&Kn.list?Zt(Object.entries(ot.outdoor.humidity.list).map(([ct,$e])=>({time:parseInt(ct)*1e3,value:$e})),"Humidité","#36A2EB"):(cr=ot.outdoor)!=null&&cr.humidity&&Zt(ot.outdoor.humidity,"Humidité","#36A2EB");break;case"pressure":(Dr=(pr=ot.pressure)==null?void 0:pr.absolute)!=null&&Dr.list?Zt(Object.entries(ot.pressure.absolute.list).map(([ct,$e])=>({time:parseInt(ct)*1e3,value:$e})),"Pression","#4BC0C0",ct=>ct*33.8639):(zr=ot.pressure)!=null&&zr.absolute&&Zt(ot.pressure.absolute,"Pression","#4BC0C0",ct=>ct*33.8639);break;case"wind":(tn=(Ht=ot.wind)==null?void 0:Ht.wind_speed)!=null&&tn.list?(Zt(Object.entries(ot.wind.wind_speed.list).map(([ct,$e])=>({time:parseInt(ct)*1e3,value:$e})),"Vitesse du vent","#FFCE56",ct=>ct*1.60934),(Kt=ot.wind.wind_gust)!=null&&Kt.list&&Zt(Object.entries(ot.wind.wind_gust.list).map(([ct,$e])=>({time:parseInt(ct)*1e3,value:$e})),"Rafales","#FF9F40",ct=>ct*1.60934)):(Yn=ot.wind)!=null&&Yn.wind_speed&&(Zt(ot.wind.wind_speed,"Vitesse du vent","#FFCE56",ct=>ct*1.60934),ot.wind.wind_gust&&Zt(ot.wind.wind_gust,"Rafales","#FF9F40",ct=>ct*1.60934));break;case"rain":(Fr=(ir=ot.rainfall)==null?void 0:ir.daily)!=null&&Fr.list?Zt(Object.entries(ot.rainfall.daily.list).map(([ct,$e])=>({time:parseInt(ct)*1e3,value:$e})),"Précipitations journalières","#9966FF",ct=>ct*25.4):(Ft=ot.rainfall)!=null&&Ft.daily&&Zt(ot.rainfall.daily,"Précipitations journalières","#9966FF",ct=>ct*25.4);break;case"solar":(Ze=(je=ot.solar_and_uvi)==null?void 0:je.solar)!=null&&Ze.list?Zt(Object.entries(ot.solar_and_uvi.solar.list).map(([ct,$e])=>({time:parseInt(ct)*1e3,value:$e})),"Rayonnement solaire","#FF9F40"):(et=ot.solar_and_uvi)!=null&&et.solar&&Zt(ot.solar_and_uvi.solar,"Rayonnement solaire","#FF9F40");break}return{datasets:Dt}};return gd(()=>{Object.values(Mt).forEach(Be=>Be.destroy())}),mo([ae,ne,Se,Le],()=>{be.value==="history"&&o.value&&rn()}),Rl(async()=>{const Be=[];C.value&&Be.push(he()),await Promise.all(Be),await Q(),R=window.setInterval(oe,5*60*1e3)}),mo(m,async Be=>{C.value&&await Q()}),mo(o,Be=>{Be?(oe(),be.value==="history"&&rn()):r.value={}}),mo(be,Be=>{Be==="history"&&o.value&&rn()}),gd(()=>{R&&clearInterval(R)}),(Be,Ce)=>{var Dt,Zt,an,ln,vn,qn,Kn,cr,pr,Dr,zr,Ht,tn,Kt,Yn,ir,Fr,Ft,je,Ze,et,ct,$e,Gt,hn,Ot,cn,En,wn,Qn,Lr,Yt,vt,Tn,bn,br,vr,Cn,pn;const ot=lC("router-link");return yt(),Et("div",gre,[V("div",yre,[Ce[41]||(Ce[41]=V("h1",{class:"text-3xl font-bold mb-4"},"Météo",-1)),C.value?(yt(),Et("div",vre,[Ce[6]||(Ce[6]=V("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Sélectionner une entreprise ",-1)),V("div",_re,[li(V("select",{"onUpdate:modelValue":Ce[0]||(Ce[0]=Ut=>m.value=Ut),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",disabled:!f.value.length,onChange:de},[f.value.length?yr("",!0):(yt(),Et("option",xre,"Chargement des entreprises...")),(yt(!0),Et($r,null,Ti(f.value,Ut=>(yt(),Et("option",{key:Ut.id,value:Ut.id},er(Ut.company_name||`${Ut.first_name} ${Ut.last_name}`),9,wre))),128))],40,bre),[[Ka,m.value]])])])):yr("",!0),_.value?(yt(),Et("div",Cre,[V("div",Sre,[Ce[7]||(Ce[7]=V("div",{class:"flex-shrink-0"},[V("svg",{class:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[V("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),V("div",Lre,[V("h3",Pre,er(_.value),1)])])])):yr("",!0),_.value&&(_.value.includes("clés API")||_.value.includes("Ecowitt"))?(yt(),Et("div",Ere,[V("div",Mre,[Ce[9]||(Ce[9]=V("svg",{class:"h-12 w-12 text-gray-400 mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[V("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})],-1)),Ce[10]||(Ce[10]=V("h2",{class:"text-xl font-bold text-gray-700 mb-2"},"Configuration requise",-1)),V("p",Tre,er(_.value),1),_.value.includes("ajouter dans la gestion")?(yt(),Et("div",Are,[Ns(ot,{to:"/users",class:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2"},{default:Hh(()=>Ce[8]||(Ce[8]=[rs(" Configurer les clés API ")])),_:1})])):yr("",!0)])])):yr("",!0),!_.value||!(_.value.includes("clés API")||_.value.includes("Ecowitt"))?(yt(),Et("div",kre,[Ce[19]||(Ce[19]=V("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Sélectionner une station ",-1)),V("div",Ire,[li(V("select",{"onUpdate:modelValue":Ce[1]||(Ce[1]=Ut=>o.value=Ut),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",disabled:!!(!a.value.length||_.value)},[!a.value.length&&!_.value?(yt(),Et("option",Ore,"Chargement des stations...")):yr("",!0),_.value?(yt(),Et("option",Rre,"Aucune station disponible")):yr("",!0),(yt(!0),Et($r,null,Ti(a.value,Ut=>(yt(),Et("option",{key:Ut.mac,value:Ut.mac},er(Ut.name)+" ("+er(Ut.model)+" - v"+er(Ut.firmware_version)+") ",9,Bre))),128))],8,Dre),[[Ka,o.value]]),V("button",{onClick:oe,class:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",disabled:!!(!o.value||_.value)}," Actualiser ",8,Nre)]),z.value?(yt(),Et("div",Fre,[Ce[18]||(Ce[18]=V("h3",{class:"text-lg font-semibold mb-2"},"Informations sur la station",-1)),V("div",zre,[V("div",null,[Ce[11]||(Ce[11]=V("span",{class:"text-gray-500"},"Modèle:",-1)),V("p",jre,er(z.value.model),1)]),V("div",null,[Ce[12]||(Ce[12]=V("span",{class:"text-gray-500"},"Version:",-1)),V("p",Ure,er(z.value.firmware_version),1)]),V("div",null,[Ce[13]||(Ce[13]=V("span",{class:"text-gray-500"},"ID:",-1)),V("p",Vre,er(z.value.id),1)]),V("div",null,[V("span",$re,er((Dt=z.value.mac)!=null&&Dt.includes(":")?"MAC:":"IMEI:"),1),V("p",Gre,er(z.value.mac),1)]),V("div",null,[Ce[14]||(Ce[14]=V("span",{class:"text-gray-500"},"Fuseau horaire:",-1)),V("p",Hre,er(z.value.timezone),1)]),V("div",null,[Ce[15]||(Ce[15]=V("span",{class:"text-gray-500"},"Installation:",-1)),V("p",qre,er(new Date(z.value.created_at).toLocaleDateString()),1)]),V("div",Wre,[Ce[17]||(Ce[17]=V("span",{class:"text-gray-500 mr-2"},"Position:",-1)),W(z.value)?(yt(),Et("a",{key:0,href:Y(z.value),target:"_blank",class:"text-primary-600 hover:text-primary-800 flex items-center",title:"Ouvrir dans Google Maps"},[Ce[16]||(Ce[16]=V("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[V("path",{"fill-rule":"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z","clip-rule":"evenodd"})],-1)),rs(" "+er(X(z.value)),1)],8,Zre)):yr("",!0)])])])):yr("",!0)])):yr("",!0),!_.value||!(_.value.includes("clés API")||_.value.includes("Ecowitt"))?(yt(),Et("div",Kre,[V("div",Yre,[V("nav",Xre,[(yt(),Et($r,null,Ti(Te,Ut=>V("button",{key:Ut.id,onClick:Hn=>be.value=Ut.id,class:$s([be.value===Ut.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])},er(Ut.name),11,Jre)),64))])])])):yr("",!0),(!_.value||!(_.value.includes("clés API")||_.value.includes("Ecowitt")))&&be.value==="realtime"?(yt(),Et("div",Qre,[V("div",eie,[V("p",tie," Dernière mise à jour : "+er(i.value?new Date(i.value).toLocaleString():"Jamais"),1),M.value?(yt(),Et("div",nie,Ce[20]||(Ce[20]=[V("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-primary-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[V("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),V("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),V("span",{class:"text-primary-600"},"Chargement des données...",-1)]))):yr("",!0)]),V("div",rie,[V("div",iie,[Ce[21]||(Ce[21]=V("h2",{class:"text-xl font-semibold mb-4"},"Température Extérieure",-1)),V("div",sie,er(le((an=(Zt=r.value.outdoor)==null?void 0:Zt.temperature)==null?void 0:an.value))+"°C ",1),V("div",oie," Min: "+er(le(((vn=(ln=r.value.outdoor)==null?void 0:ln.temperature)==null?void 0:vn.min)||"0"))+"°C Max: "+er(le(((Kn=(qn=r.value.outdoor)==null?void 0:qn.temperature)==null?void 0:Kn.max)||"0"))+"°C ",1)]),V("div",aie,[Ce[22]||(Ce[22]=V("h2",{class:"text-xl font-semibold mb-4"},"Humidité",-1)),V("div",lie,er(((pr=(cr=r.value.outdoor)==null?void 0:cr.humidity)==null?void 0:pr.value)||"0")+"% ",1),V("div",uie,[V("div",cie,[V("div",{class:"bg-primary-600 h-2.5 rounded-full",style:Zh({width:`${((zr=(Dr=r.value.outdoor)==null?void 0:Dr.humidity)==null?void 0:zr.value)||0}%`})},null,4)])])]),V("div",hie,[Ce[23]||(Ce[23]=V("h2",{class:"text-xl font-semibold mb-4"},"Pression Atmosphérique",-1)),V("div",die,er(ue((tn=(Ht=r.value.pressure)==null?void 0:Ht.absolute)==null?void 0:tn.value))+" hPa ",1),V("div",fie," Tendance: "+er(We((Yn=(Kt=r.value.pressure)==null?void 0:Kt.absolute)==null?void 0:Yn.trend)),1)]),V("div",pie,[Ce[25]||(Ce[25]=V("h2",{class:"text-xl font-semibold mb-4"},"Vent",-1)),V("div",mie,er(me(((Fr=(ir=r.value.wind)==null?void 0:ir.speed)==null?void 0:Fr.value)||((je=(Ft=r.value.wind)==null?void 0:Ft.wind_speed)==null?void 0:je.value)))+" km/h ",1),V("div",gie,[rs(" Direction: "+er(_e(((et=(Ze=r.value.wind)==null?void 0:Ze.direction)==null?void 0:et.value)||(($e=(ct=r.value.wind)==null?void 0:ct.wind_direction)==null?void 0:$e.value)))+" ",1),Ce[24]||(Ce[24]=V("br",null,null,-1)),rs(" Rafales: "+er(me(((hn=(Gt=r.value.wind)==null?void 0:Gt.gust)==null?void 0:hn.value)||((cn=(Ot=r.value.wind)==null?void 0:Ot.wind_gust)==null?void 0:cn.value)))+" km/h ",1)])]),V("div",yie,[Ce[27]||(Ce[27]=V("h2",{class:"text-xl font-semibold mb-4"},"Précipitations",-1)),V("div",vie,er(we((wn=(En=r.value.rainfall)==null?void 0:En.daily)==null?void 0:wn.value))+" mm ",1),V("div",_ie,[rs(" Taux: "+er(we(((Lr=(Qn=r.value.rainfall)==null?void 0:Qn.rate)==null?void 0:Lr.value)||((vt=(Yt=r.value.rainfall)==null?void 0:Yt.rain_rate)==null?void 0:vt.value)))+" mm/h ",1),Ce[26]||(Ce[26]=V("br",null,null,-1)),rs(" Mensuel: "+er(we((bn=(Tn=r.value.rainfall)==null?void 0:Tn.monthly)==null?void 0:bn.value))+" mm ",1)])]),V("div",bie,[Ce[28]||(Ce[28]=V("h2",{class:"text-xl font-semibold mb-4"},"Rayonnement",-1)),V("div",xie,er(((vr=(br=r.value.solar_and_uvi)==null?void 0:br.solar)==null?void 0:vr.value)||"0")+" W/m² ",1),V("div",wie," UV: "+er(((pn=(Cn=r.value.solar_and_uvi)==null?void 0:Cn.uvi)==null?void 0:pn.value)||"0"),1)])])])):(!_.value||!(_.value.includes("clés API")||_.value.includes("Ecowitt")))&&be.value==="history"?(yt(),Et("div",Cie,[V("div",Sie,[V("p",Lie," Dernière mise à jour : "+er(l.value?l.value:"Jamais"),1),V("div",Pie,[yn.value?(yt(),Et("div",Eie,Ce[29]||(Ce[29]=[V("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-primary-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[V("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),V("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),V("span",{class:"text-sm text-primary-600"},"Chargement des données...",-1)]))):yr("",!0),V("button",{onClick:rn,class:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",disabled:!o.value||yn.value}," Actualiser ",8,Mie)])]),V("div",Tie,[V("div",null,[Ce[31]||(Ce[31]=V("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Période ",-1)),li(V("select",{"onUpdate:modelValue":Ce[2]||(Ce[2]=Ut=>ae.value=Ut),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500"},Ce[30]||(Ce[30]=[vd('<option value="today" data-v-ad9826c9>Aujourd&#39;hui</option><option value="yesterday" data-v-ad9826c9>Hier</option><option value="week" data-v-ad9826c9>7 derniers jours</option><option value="month" data-v-ad9826c9>30 derniers jours</option><option value="custom" data-v-ad9826c9>Période personnalisée</option>',5)]),512),[[Ka,ae.value]])]),ae.value==="custom"?(yt(),Et("div",Aie,[V("div",null,[Ce[32]||(Ce[32]=V("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Date de début ",-1)),li(V("input",{type:"date","onUpdate:modelValue":Ce[3]||(Ce[3]=Ut=>Se.value=Ut),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500"},null,512),[[to,Se.value]])]),V("div",null,[Ce[33]||(Ce[33]=V("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Date de fin ",-1)),li(V("input",{type:"date","onUpdate:modelValue":Ce[4]||(Ce[4]=Ut=>Le.value=Ut),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500"},null,512),[[to,Le.value]])])])):yr("",!0),V("div",null,[Ce[34]||(Ce[34]=V("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Intervalle ",-1)),li(V("select",{"onUpdate:modelValue":Ce[5]||(Ce[5]=Ut=>ne.value=Ut),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500"},[(yt(!0),Et($r,null,Ti(pt.value,Ut=>(yt(),Et("option",{key:Ut.value,value:Ut.value},er(Ut.label),9,kie))),128))],512),[[Ka,ne.value]]),w.value?(yt(),Et("div",Iie,er(w.value),1)):yr("",!0)])]),V("div",Die,[V("div",Oie,[Ce[35]||(Ce[35]=V("h3",{class:"text-lg font-semibold mb-4"},"Température",-1)),V("div",Rie,[V("canvas",{ref_key:"tempChart",ref:ge},null,512)])]),V("div",Bie,[Ce[36]||(Ce[36]=V("h3",{class:"text-lg font-semibold mb-4"},"Humidité",-1)),V("div",Nie,[V("canvas",{ref_key:"humidityChart",ref:Ie},null,512)])]),V("div",Fie,[Ce[37]||(Ce[37]=V("h3",{class:"text-lg font-semibold mb-4"},"Pression",-1)),V("div",zie,[V("canvas",{ref_key:"pressureChart",ref:Ne},null,512)])]),V("div",jie,[Ce[38]||(Ce[38]=V("h3",{class:"text-lg font-semibold mb-4"},"Vent",-1)),V("div",Uie,[V("canvas",{ref_key:"windChart",ref:Ve},null,512)])]),V("div",Vie,[Ce[39]||(Ce[39]=V("h3",{class:"text-lg font-semibold mb-4"},"Précipitations",-1)),V("div",$ie,[V("canvas",{ref_key:"rainChart",ref:it},null,512)])]),V("div",Gie,[Ce[40]||(Ce[40]=V("h3",{class:"text-lg font-semibold mb-4"},"Rayonnement",-1)),V("div",Hie,[V("canvas",{ref_key:"solarChart",ref:lt},null,512)])])])])):yr("",!0)])])}}}),Wie=Vf(qie,[["__scopeId","data-v-ad9826c9"]]),Zie={class:"settings-page max-w-xl mx-auto py-10 px-4 min-h-full"},Kie={key:0,class:"mb-6"},Yie={key:1,class:"bg-red-50 border-l-4 border-red-500 p-4 mb-6"},Xie={class:"flex"},Jie={class:"ml-3"},Qie={class:"text-sm text-red-700"},ese={class:"bg-white shadow rounded-lg p-6"},tse=["disabled"],nse=["disabled"],rse={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},ise={key:0,class:"text-green-600 mt-2"},sse=Ja({__name:"ParametresView",setup(e){const t=Rn(""),n=Rn(""),r=Rn(!1),i=Rn("");Rl(async()=>{await l()});async function l(){r.value=!0,i.value="";try{const o=await Ux.getGoogleMapsApiKey();o.data&&o.data.key_status==="configured"?t.value="••••••••••••••••••••••••••":t.value=""}catch(o){console.error("Erreur lors de la récupération de la clé API:",o),i.value="Impossible de récupérer la clé API. Veuillez réessayer plus tard."}finally{r.value=!1}}async function a(){if(!t.value){i.value="La clé API est requise.";return}r.value=!0,i.value="",n.value="";try{await Ux.setGoogleMapsApiKey(t.value),n.value="Clé API sauvegardée avec succès.",setTimeout(()=>{n.value=""},3e3)}catch(o){console.error("Erreur lors de la sauvegarde de la clé API:",o),i.value="Impossible de sauvegarder la clé API. Veuillez réessayer plus tard."}finally{r.value=!1}}return(o,f)=>(yt(),Et("div",Zie,[f[6]||(f[6]=V("h1",{class:"text-2xl font-bold mb-6"},"Paramètres de l'application",-1)),r.value?(yt(),Et("div",Kie,f[1]||(f[1]=[vd('<div class="animate-pulse flex space-x-4" data-v-097ea248><div class="flex-1 space-y-4 py-1" data-v-097ea248><div class="h-4 bg-gray-200 rounded w-3/4" data-v-097ea248></div><div class="space-y-2" data-v-097ea248><div class="h-4 bg-gray-200 rounded" data-v-097ea248></div><div class="h-4 bg-gray-200 rounded w-5/6" data-v-097ea248></div></div></div></div>',1)]))):yr("",!0),i.value?(yt(),Et("div",Yie,[V("div",Xie,[f[2]||(f[2]=V("div",{class:"flex-shrink-0"},[V("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[V("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),V("div",Jie,[V("p",Qie,er(i.value),1)])])])):yr("",!0),V("div",ese,[V("form",{onSubmit:Wh(a,["prevent"]),class:"space-y-4"},[V("div",null,[f[3]||(f[3]=V("label",{for:"google-maps-api-key",class:"block text-sm font-medium text-gray-700"},"Clé API Google Maps",-1)),li(V("input",{id:"google-maps-api-key","onUpdate:modelValue":f[0]||(f[0]=m=>t.value=m),type:"password",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Entrez votre clé API Google Maps",autocomplete:"off",disabled:r.value},null,8,tse),[[to,t.value]])]),V("button",{type:"submit",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",disabled:r.value},[r.value?(yt(),Et("svg",rse,f[4]||(f[4]=[V("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),V("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):yr("",!0),f[5]||(f[5]=rs(" Sauvegarder "))],8,nse),n.value?(yt(),Et("p",ise,er(n.value),1)):yr("",!0)],32)])]))}}),ose=Vf(sse,[["__scopeId","data-v-097ea248"]]);var P6={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.4.0/LICENSE.txt
 */(function(e,t){(function(n,r){e.exports=r()})(lc,function(){var n={},r={};function i(a,o,f){if(r[a]=f,a==="index"){var m="var sharedModule = {}; ("+r.shared+")(sharedModule); ("+r.worker+")(sharedModule);",_={};return r.shared(_),r.index(n,_),typeof window<"u"&&n.setWorkerUrl(window.URL.createObjectURL(new Blob([m],{type:"text/javascript"}))),n}}i("shared",["exports"],function(a){function o(h,u,d,v){return new(d||(d=Promise))(function(P,D){function O(ee){try{K(v.next(ee))}catch(ce){D(ce)}}function j(ee){try{K(v.throw(ee))}catch(ce){D(ce)}}function K(ee){var ce;ee.done?P(ee.value):(ce=ee.value,ce instanceof d?ce:new d(function(ve){ve(ce)})).then(O,j)}K((v=v.apply(h,u||[])).next())})}function f(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var m,_;function w(){if(_)return m;function h(u,d){this.x=u,this.y=d}return _=1,m=h,h.prototype={clone:function(){return new h(this.x,this.y)},add:function(u){return this.clone()._add(u)},sub:function(u){return this.clone()._sub(u)},multByPoint:function(u){return this.clone()._multByPoint(u)},divByPoint:function(u){return this.clone()._divByPoint(u)},mult:function(u){return this.clone()._mult(u)},div:function(u){return this.clone()._div(u)},rotate:function(u){return this.clone()._rotate(u)},rotateAround:function(u,d){return this.clone()._rotateAround(u,d)},matMult:function(u){return this.clone()._matMult(u)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(u){return this.x===u.x&&this.y===u.y},dist:function(u){return Math.sqrt(this.distSqr(u))},distSqr:function(u){var d=u.x-this.x,v=u.y-this.y;return d*d+v*v},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(u){return Math.atan2(this.y-u.y,this.x-u.x)},angleWith:function(u){return this.angleWithSep(u.x,u.y)},angleWithSep:function(u,d){return Math.atan2(this.x*d-this.y*u,this.x*u+this.y*d)},_matMult:function(u){var d=u[2]*this.x+u[3]*this.y;return this.x=u[0]*this.x+u[1]*this.y,this.y=d,this},_add:function(u){return this.x+=u.x,this.y+=u.y,this},_sub:function(u){return this.x-=u.x,this.y-=u.y,this},_mult:function(u){return this.x*=u,this.y*=u,this},_div:function(u){return this.x/=u,this.y/=u,this},_multByPoint:function(u){return this.x*=u.x,this.y*=u.y,this},_divByPoint:function(u){return this.x/=u.x,this.y/=u.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var u=this.y;return this.y=this.x,this.x=-u,this},_rotate:function(u){var d=Math.cos(u),v=Math.sin(u),P=v*this.x+d*this.y;return this.x=d*this.x-v*this.y,this.y=P,this},_rotateAround:function(u,d){var v=Math.cos(u),P=Math.sin(u),D=d.y+P*(this.x-d.x)+v*(this.y-d.y);return this.x=d.x+v*(this.x-d.x)-P*(this.y-d.y),this.y=D,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},h.convert=function(u){return u instanceof h?u:Array.isArray(u)?new h(u[0],u[1]):u},m}typeof SuppressedError=="function"&&SuppressedError;var M,C,R=f(w()),z=function(){if(C)return M;function h(u,d,v,P){this.cx=3*u,this.bx=3*(v-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*d,this.by=3*(P-d)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=d,this.p2x=v,this.p2y=P}return C=1,M=h,h.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,d){if(d===void 0&&(d=1e-6),u<0)return 0;if(u>1)return 1;for(var v=u,P=0;P<8;P++){var D=this.sampleCurveX(v)-u;if(Math.abs(D)<d)return v;var O=this.sampleCurveDerivativeX(v);if(Math.abs(O)<1e-6)break;v-=D/O}var j=0,K=1;for(v=u,P=0;P<20&&(D=this.sampleCurveX(v),!(Math.abs(D-u)<d));P++)u>D?j=v:K=v,v=.5*(K-j)+j;return v},solve:function(u,d){return this.sampleCurveY(this.solveCurveX(u,d))}},M}(),W=f(z);let X,Y;function Q(){return X==null&&(X=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),X}function oe(){if(Y==null&&(Y=!1,Q())){const u=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(u){for(let v=0;v<5*5;v++){const P=4*v;u.fillStyle=`rgb(${P},${P+1},${P+2})`,u.fillRect(v%5,Math.floor(v/5),1,1)}const d=u.getImageData(0,0,5,5).data;for(let v=0;v<5*5*4;v++)if(v%4!=3&&d[v]!==v){Y=!0;break}}}return Y||!1}var le=1e-6,me=typeof Float32Array<"u"?Float32Array:Array;function we(){var h=new me(9);return me!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[5]=0,h[6]=0,h[7]=0),h[0]=1,h[4]=1,h[8]=1,h}function ue(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=1,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h}function _e(){var h=new me(3);return me!=Float32Array&&(h[0]=0,h[1]=0,h[2]=0),h}function We(h){return Math.hypot(h[0],h[1],h[2])}function he(h,u,d){var v=new me(3);return v[0]=h,v[1]=u,v[2]=d,v}Math.hypot||(Math.hypot=function(){for(var h=0,u=arguments.length;u--;)h+=arguments[u]*arguments[u];return Math.sqrt(h)});var de,Te=We;function be(h,u,d){var v=u[0],P=u[1],D=u[2],O=u[3];return h[0]=d[0]*v+d[4]*P+d[8]*D+d[12]*O,h[1]=d[1]*v+d[5]*P+d[9]*D+d[13]*O,h[2]=d[2]*v+d[6]*P+d[10]*D+d[14]*O,h[3]=d[3]*v+d[7]*P+d[11]*D+d[15]*O,h}function ae(){var h=new me(4);return me!=Float32Array&&(h[0]=0,h[1]=0,h[2]=0),h[3]=1,h}function ne(){var h=new me(2);return me!=Float32Array&&(h[0]=0,h[1]=0),h}function Se(h,u){var d=new me(2);return d[0]=h,d[1]=u,d}_e(),de=new me(4),me!=Float32Array&&(de[0]=0,de[1]=0,de[2]=0,de[3]=0),_e(),he(1,0,0),he(0,1,0),ae(),ae(),we(),ne();const Le=8192;function ze(h,u,d){return u*(Le/(h.tileSize*Math.pow(2,d-h.tileID.overscaledZ)))}function He(h,u){return(h%u+u)%u}function pt(h,u,d){return h*(1-d)+u*d}function ge(h){if(h<=0)return 0;if(h>=1)return 1;const u=h*h,d=u*h;return 4*(h<.5?d:3*(h-u)+d-.75)}function Ie(h,u,d,v){const P=new W(h,u,d,v);return D=>P.solve(D)}const Ne=Ie(.25,.1,.25,1);function Ve(h,u,d){return Math.min(d,Math.max(u,h))}function it(h,u,d){const v=d-u,P=((h-u)%v+v)%v+u;return P===u?d:P}function lt(h,...u){for(const d of u)for(const v in d)h[v]=d[v];return h}let Mt=1;function wt(h,u,d){const v={};for(const P in h)v[P]=u.call(this,h[P],P,h);return v}function rn(h,u,d){const v={};for(const P in h)u.call(this,h[P],P,h)&&(v[P]=h[P]);return v}function yn(h){return Array.isArray(h)?h.map(yn):typeof h=="object"&&h?wt(h,yn):h}const Pn={};function De(h){Pn[h]||(typeof console<"u"&&console.warn(h),Pn[h]=!0)}function Ae(h,u,d){return(d.y-h.y)*(u.x-h.x)>(u.y-h.y)*(d.x-h.x)}function Be(h){return typeof WorkerGlobalScope<"u"&&h!==void 0&&h instanceof WorkerGlobalScope}let Ce=null;function ot(h){return typeof ImageBitmap<"u"&&h instanceof ImageBitmap}const Dt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Zt(h,u,d,v,P){return o(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const D=new VideoFrame(h,{timestamp:0});try{const O=D==null?void 0:D.format;if(!O||!O.startsWith("BGR")&&!O.startsWith("RGB"))throw new Error(`Unrecognized format ${O}`);const j=O.startsWith("BGR"),K=new Uint8ClampedArray(v*P*4);if(yield D.copyTo(K,function(ee,ce,ve,Re,Ue){const qe=4*Math.max(1,0),st=(Math.max(0,ve)-ve)*Re*4+qe,xt=4*Re,It=Math.max(0,ce),fn=Math.max(0,ve);return{rect:{x:It,y:fn,width:Math.min(ee.width,ce+Re)-It,height:Math.min(ee.height,ve+Ue)-fn},layout:[{offset:st,stride:xt}]}}(h,u,d,v,P)),j)for(let ee=0;ee<K.length;ee+=4){const ce=K[ee];K[ee]=K[ee+2],K[ee+2]=ce}return K}finally{D.close()}})}let an,ln;function vn(h,u,d,v){return h.addEventListener(u,d,v),{unsubscribe:()=>{h.removeEventListener(u,d,v)}}}function qn(h){return h/Math.PI*180}const Kn={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},cr={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},pr="AbortError";function Dr(){return new Error(pr)}const zr={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Ht(h){return zr.REGISTERED_PROTOCOLS[h.substring(0,h.indexOf("://"))]}const tn="global-dispatcher";class Kt extends Error{constructor(u,d,v,P){super(`AJAXError: ${d} (${u}): ${v}`),this.status=u,this.statusText=d,this.url=v,this.body=P}}const Yn=()=>Be(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,ir=function(h,u){if(/:\/\//.test(h.url)&&!/^https?:|^file:/.test(h.url)){const v=Ht(h.url);if(v)return v(h,u);if(Be(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:h,targetMapId:tn},u)}if(!(/^file:/.test(d=h.url)||/^file:/.test(Yn())&&!/^\w+:/.test(d))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(v,P){return o(this,void 0,void 0,function*(){const D=new Request(v.url,{method:v.method||"GET",body:v.body,credentials:v.credentials,headers:v.headers,cache:v.cache,referrer:Yn(),signal:P.signal});let O,j;v.type!=="json"||D.headers.has("Accept")||D.headers.set("Accept","application/json");try{O=yield fetch(D)}catch(ee){throw new Kt(0,ee.message,v.url,new Blob)}if(!O.ok){const ee=yield O.blob();throw new Kt(O.status,O.statusText,v.url,ee)}j=v.type==="arrayBuffer"||v.type==="image"?O.arrayBuffer():v.type==="json"?O.json():O.text();const K=yield j;if(P.signal.aborted)throw Dr();return{data:K,cacheControl:O.headers.get("Cache-Control"),expires:O.headers.get("Expires")}})}(h,u);if(Be(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:h,mustQueue:!0,targetMapId:tn},u)}var d;return function(v,P){return new Promise((D,O)=>{var j;const K=new XMLHttpRequest;K.open(v.method||"GET",v.url,!0),v.type!=="arrayBuffer"&&v.type!=="image"||(K.responseType="arraybuffer");for(const ee in v.headers)K.setRequestHeader(ee,v.headers[ee]);v.type==="json"&&(K.responseType="text",!((j=v.headers)===null||j===void 0)&&j.Accept||K.setRequestHeader("Accept","application/json")),K.withCredentials=v.credentials==="include",K.onerror=()=>{O(new Error(K.statusText))},K.onload=()=>{if(!P.signal.aborted)if((K.status>=200&&K.status<300||K.status===0)&&K.response!==null){let ee=K.response;if(v.type==="json")try{ee=JSON.parse(K.response)}catch(ce){return void O(ce)}D({data:ee,cacheControl:K.getResponseHeader("Cache-Control"),expires:K.getResponseHeader("Expires")})}else{const ee=new Blob([K.response],{type:K.getResponseHeader("Content-Type")});O(new Kt(K.status,K.statusText,v.url,ee))}},P.signal.addEventListener("abort",()=>{K.abort(),O(Dr())}),K.send(v.body)})}(h,u)};function Fr(h){if(!h||h.indexOf("://")<=0||h.indexOf("data:image/")===0||h.indexOf("blob:")===0)return!0;const u=new URL(h),d=window.location;return u.protocol===d.protocol&&u.host===d.host}function Ft(h,u,d){d[h]&&d[h].indexOf(u)!==-1||(d[h]=d[h]||[],d[h].push(u))}function je(h,u,d){if(d&&d[h]){const v=d[h].indexOf(u);v!==-1&&d[h].splice(v,1)}}class Ze{constructor(u,d={}){lt(this,d),this.type=u}}class et extends Ze{constructor(u,d={}){super("error",lt({error:u},d))}}class ct{on(u,d){return this._listeners=this._listeners||{},Ft(u,d,this._listeners),{unsubscribe:()=>{this.off(u,d)}}}off(u,d){return je(u,d,this._listeners),je(u,d,this._oneTimeListeners),this}once(u,d){return d?(this._oneTimeListeners=this._oneTimeListeners||{},Ft(u,d,this._oneTimeListeners),this):new Promise(v=>this.once(u,v))}fire(u,d){typeof u=="string"&&(u=new Ze(u,d||{}));const v=u.type;if(this.listens(v)){u.target=this;const P=this._listeners&&this._listeners[v]?this._listeners[v].slice():[];for(const j of P)j.call(this,u);const D=this._oneTimeListeners&&this._oneTimeListeners[v]?this._oneTimeListeners[v].slice():[];for(const j of D)je(v,j,this._oneTimeListeners),j.call(this,u);const O=this._eventedParent;O&&(lt(u,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),O.fire(u))}else u instanceof et&&console.error(u.error);return this}listens(u){return this._listeners&&this._listeners[u]&&this._listeners[u].length>0||this._oneTimeListeners&&this._oneTimeListeners[u]&&this._oneTimeListeners[u].length>0||this._eventedParent&&this._eventedParent.listens(u)}setEventedParent(u,d){return this._eventedParent=u,this._eventedParentData=d,this}}var $e={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Gt=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function hn(h,u){const d={};for(const v in h)v!=="ref"&&(d[v]=h[v]);return Gt.forEach(v=>{v in u&&(d[v]=u[v])}),d}function Ot(h,u){if(Array.isArray(h)){if(!Array.isArray(u)||h.length!==u.length)return!1;for(let d=0;d<h.length;d++)if(!Ot(h[d],u[d]))return!1;return!0}if(typeof h=="object"&&h!==null&&u!==null){if(typeof u!="object"||Object.keys(h).length!==Object.keys(u).length)return!1;for(const d in h)if(!Ot(h[d],u[d]))return!1;return!0}return h===u}function cn(h,u){h.push(u)}function En(h,u,d){cn(d,{command:"addSource",args:[h,u[h]]})}function wn(h,u,d){cn(u,{command:"removeSource",args:[h]}),d[h]=!0}function Qn(h,u,d,v){wn(h,d,v),En(h,u,d)}function Lr(h,u,d){let v;for(v in h[d])if(Object.prototype.hasOwnProperty.call(h[d],v)&&v!=="data"&&!Ot(h[d][v],u[d][v]))return!1;for(v in u[d])if(Object.prototype.hasOwnProperty.call(u[d],v)&&v!=="data"&&!Ot(h[d][v],u[d][v]))return!1;return!0}function Yt(h,u,d,v,P,D){h=h||{},u=u||{};for(const O in h)Object.prototype.hasOwnProperty.call(h,O)&&(Ot(h[O],u[O])||d.push({command:D,args:[v,O,u[O],P]}));for(const O in u)Object.prototype.hasOwnProperty.call(u,O)&&!Object.prototype.hasOwnProperty.call(h,O)&&(Ot(h[O],u[O])||d.push({command:D,args:[v,O,u[O],P]}))}function vt(h){return h.id}function Tn(h,u){return h[u.id]=u,h}class bn{constructor(u,d,v,P){this.message=(u?`${u}: `:"")+v,P&&(this.identifier=P),d!=null&&d.__line__&&(this.line=d.__line__)}}function br(h,...u){for(const d of u)for(const v in d)h[v]=d[v];return h}class vr extends Error{constructor(u,d){super(d),this.message=d,this.key=u}}class Cn{constructor(u,d=[]){this.parent=u,this.bindings={};for(const[v,P]of d)this.bindings[v]=P}concat(u){return new Cn(this,u)}get(u){if(this.bindings[u])return this.bindings[u];if(this.parent)return this.parent.get(u);throw new Error(`${u} not found in scope.`)}has(u){return!!this.bindings[u]||!!this.parent&&this.parent.has(u)}}const pn={kind:"null"},Ut={kind:"number"},Hn={kind:"string"},or={kind:"boolean"},Xr={kind:"color"},ri={kind:"projectionDefinition"},ai={kind:"object"},Pr={kind:"value"},As={kind:"collator"},$i={kind:"formatted"},Qa={kind:"padding"},pi={kind:"resolvedImage"},Li={kind:"variableAnchorOffsetCollection"};function Yi(h,u){return{kind:"array",itemType:h,N:u}}function ns(h){if(h.kind==="array"){const u=ns(h.itemType);return typeof h.N=="number"?`array<${u}, ${h.N}>`:h.itemType.kind==="value"?"array":`array<${u}>`}return h.kind}const ao=[pn,Ut,Hn,or,Xr,ri,$i,ai,Yi(Pr),Qa,pi,Li];function wc(h,u){if(u.kind==="error")return null;if(h.kind==="array"){if(u.kind==="array"&&(u.N===0&&u.itemType.kind==="value"||!wc(h.itemType,u.itemType))&&(typeof h.N!="number"||h.N===u.N))return null}else{if(h.kind===u.kind)return null;if(h.kind==="value"){for(const d of ao)if(!wc(d,u))return null}}return`Expected ${ns(h)} but found ${ns(u)} instead.`}function Wu(h,u){return u.some(d=>d.kind===h.kind)}function el(h,u){return u.some(d=>d==="null"?h===null:d==="array"?Array.isArray(h):d==="object"?h&&!Array.isArray(h)&&typeof h=="object":d===typeof h)}function Au(h,u){return h.kind==="array"&&u.kind==="array"?h.itemType.kind===u.itemType.kind&&typeof h.N=="number":h.kind===u.kind}const Zu=.96422,Ku=.82521,Cc=4/29,Yu=6/29,ja=3*Yu*Yu,ds=Yu*Yu*Yu,Di=Math.PI/180,Xu=180/Math.PI;function lu(h){return(h%=360)<0&&(h+=360),h}function gl([h,u,d,v]){let P,D;const O=ki((.2225045*(h=Ju(h))+.7168786*(u=Ju(u))+.0606169*(d=Ju(d)))/1);h===u&&u===d?P=D=O:(P=ki((.4360747*h+.3850649*u+.1430804*d)/Zu),D=ki((.0139322*h+.0971045*u+.7141733*d)/Ku));const j=116*O-16;return[j<0?0:j,500*(P-O),200*(O-D),v]}function Ju(h){return h<=.04045?h/12.92:Math.pow((h+.055)/1.055,2.4)}function ki(h){return h>ds?Math.pow(h,1/3):h/ja+Cc}function is([h,u,d,v]){let P=(h+16)/116,D=isNaN(u)?P:P+u/500,O=isNaN(d)?P:P-d/200;return P=1*Bo(P),D=Zu*Bo(D),O=Ku*Bo(O),[Ua(3.1338561*D-1.6168667*P-.4906146*O),Ua(-.9787684*D+1.9161415*P+.033454*O),Ua(.0719453*D-.2289914*P+1.4052427*O),v]}function Ua(h){return(h=h<=.00304?12.92*h:1.055*Math.pow(h,1/2.4)-.055)<0?0:h>1?1:h}function Bo(h){return h>Yu?h*h*h:ja*(h-Cc)}function Co(h){return parseInt(h.padEnd(2,h),16)/255}function ku(h,u){return yl(u?h/100:h,0,1)}function yl(h,u,d){return Math.min(Math.max(u,h),d)}function uu(h){return!h.some(Number.isNaN)}const lo={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function So(h,u,d){return h+d*(u-h)}function tl(h,u,d){return h.map((v,P)=>So(v,u[P],d))}class ui{constructor(u,d,v,P=1,D=!0){this.r=u,this.g=d,this.b=v,this.a=P,D||(this.r*=P,this.g*=P,this.b*=P,P||this.overwriteGetter("rgb",[u,d,v,P]))}static parse(u){if(u instanceof ui)return u;if(typeof u!="string")return;const d=function(v){if((v=v.toLowerCase().trim())==="transparent")return[0,0,0,0];const P=lo[v];if(P){const[O,j,K]=P;return[O/255,j/255,K/255,1]}if(v.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(v)){const O=v.length<6?1:2;let j=1;return[Co(v.slice(j,j+=O)),Co(v.slice(j,j+=O)),Co(v.slice(j,j+=O)),Co(v.slice(j,j+O)||"ff")]}if(v.startsWith("rgb")){const O=v.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(O){const[j,K,ee,ce,ve,Re,Ue,qe,st,xt,It,fn]=O,$t=[ce||" ",Ue||" ",xt].join("");if($t==="  "||$t==="  /"||$t===",,"||$t===",,,"){const Oe=[ee,Re,st].join(""),ft=Oe==="%%%"?100:Oe===""?255:0;if(ft){const Wt=[yl(+K/ft,0,1),yl(+ve/ft,0,1),yl(+qe/ft,0,1),It?ku(+It,fn):1];if(uu(Wt))return Wt}}return}}const D=v.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(D){const[O,j,K,ee,ce,ve,Re,Ue,qe]=D,st=[K||" ",ce||" ",Re].join("");if(st==="  "||st==="  /"||st===",,"||st===",,,"){const xt=[+j,yl(+ee,0,100),yl(+ve,0,100),Ue?ku(+Ue,qe):1];if(uu(xt))return function([It,fn,$t,Oe]){function ft(Wt){const $n=(Wt+It/30)%12,_r=fn*Math.min($t,1-$t);return $t-_r*Math.max(-1,Math.min($n-3,9-$n,1))}return It=lu(It),fn/=100,$t/=100,[ft(0),ft(8),ft(4),Oe]}(xt)}}}(u);return d?new ui(...d,!1):void 0}get rgb(){const{r:u,g:d,b:v,a:P}=this,D=P||1/0;return this.overwriteGetter("rgb",[u/D,d/D,v/D,P])}get hcl(){return this.overwriteGetter("hcl",function(u){const[d,v,P,D]=gl(u),O=Math.sqrt(v*v+P*P);return[Math.round(1e4*O)?lu(Math.atan2(P,v)*Xu):NaN,O,d,D]}(this.rgb))}get lab(){return this.overwriteGetter("lab",gl(this.rgb))}overwriteGetter(u,d){return Object.defineProperty(this,u,{value:d}),d}toString(){const[u,d,v,P]=this.rgb;return`rgba(${[u,d,v].map(D=>Math.round(255*D)).join(",")},${P})`}static interpolate(u,d,v,P="rgb"){switch(P){case"rgb":{const[D,O,j,K]=tl(u.rgb,d.rgb,v);return new ui(D,O,j,K,!1)}case"hcl":{const[D,O,j,K]=u.hcl,[ee,ce,ve,Re]=d.hcl;let Ue,qe;if(isNaN(D)||isNaN(ee))isNaN(D)?isNaN(ee)?Ue=NaN:(Ue=ee,j!==1&&j!==0||(qe=ce)):(Ue=D,ve!==1&&ve!==0||(qe=O));else{let $t=ee-D;ee>D&&$t>180?$t-=360:ee<D&&D-ee>180&&($t+=360),Ue=D+v*$t}const[st,xt,It,fn]=function([$t,Oe,ft,Wt]){return $t=isNaN($t)?0:$t*Di,is([ft,Math.cos($t)*Oe,Math.sin($t)*Oe,Wt])}([Ue,qe??So(O,ce,v),So(j,ve,v),So(K,Re,v)]);return new ui(st,xt,It,fn,!1)}case"lab":{const[D,O,j,K]=is(tl(u.lab,d.lab,v));return new ui(D,O,j,K,!1)}}}}ui.black=new ui(0,0,0,1),ui.white=new ui(1,1,1,1),ui.transparent=new ui(0,0,0,0),ui.red=new ui(1,0,0,1);class ji{constructor(u,d,v){this.sensitivity=u?d?"variant":"case":d?"accent":"base",this.locale=v,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(u,d){return this.collator.compare(u,d)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const nl=["bottom","center","top"];class rl{constructor(u,d,v,P,D,O){this.text=u,this.image=d,this.scale=v,this.fontStack=P,this.textColor=D,this.verticalAlign=O}}class Ws{constructor(u){this.sections=u}static fromString(u){return new Ws([new rl(u,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(u=>u.text.length!==0||u.image&&u.image.name.length!==0)}static factory(u){return u instanceof Ws?u:Ws.fromString(u)}toString(){return this.sections.length===0?"":this.sections.map(u=>u.text).join("")}}class Zs{constructor(u){this.values=u.slice()}static parse(u){if(u instanceof Zs)return u;if(typeof u=="number")return new Zs([u,u,u,u]);if(Array.isArray(u)&&!(u.length<1||u.length>4)){for(const d of u)if(typeof d!="number")return;switch(u.length){case 1:u=[u[0],u[0],u[0],u[0]];break;case 2:u=[u[0],u[1],u[0],u[1]];break;case 3:u=[u[0],u[1],u[2],u[1]]}return new Zs(u)}}toString(){return JSON.stringify(this.values)}static interpolate(u,d,v){return new Zs(tl(u.values,d.values,v))}}class Ms{constructor(u){this.name="ExpressionEvaluationError",this.message=u}toJSON(){return this.message}}const cu=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class us{constructor(u){this.values=u.slice()}static parse(u){if(u instanceof us)return u;if(Array.isArray(u)&&!(u.length<1)&&u.length%2==0){for(let d=0;d<u.length;d+=2){const v=u[d],P=u[d+1];if(typeof v!="string"||!cu.has(v)||!Array.isArray(P)||P.length!==2||typeof P[0]!="number"||typeof P[1]!="number")return}return new us(u)}}toString(){return JSON.stringify(this.values)}static interpolate(u,d,v){const P=u.values,D=d.values;if(P.length!==D.length)throw new Ms(`Cannot interpolate values of different length. from: ${u.toString()}, to: ${d.toString()}`);const O=[];for(let j=0;j<P.length;j+=2){if(P[j]!==D[j])throw new Ms(`Cannot interpolate values containing mismatched anchors. from[${j}]: ${P[j]}, to[${j}]: ${D[j]}`);O.push(P[j]);const[K,ee]=P[j+1],[ce,ve]=D[j+1];O.push([So(K,ce,v),So(ee,ve,v)])}return new us(O)}}class La{constructor(u){this.name=u.name,this.available=u.available}toString(){return this.name}static fromString(u){return u?new La({name:u,available:!1}):null}}class Lo{constructor(u,d,v){this.from=u,this.to=d,this.transition=v}static interpolate(u,d,v){return new Lo(u,d,v)}static parse(u){return u instanceof Lo?u:Array.isArray(u)&&u.length===3&&typeof u[0]=="string"&&typeof u[1]=="string"&&typeof u[2]=="number"?new Lo(u[0],u[1],u[2]):typeof u=="object"&&typeof u.from=="string"&&typeof u.to=="string"&&typeof u.transition=="number"?new Lo(u.from,u.to,u.transition):typeof u=="string"?new Lo(u,u,1):void 0}}function yi(h,u,d,v){return typeof h=="number"&&h>=0&&h<=255&&typeof u=="number"&&u>=0&&u<=255&&typeof d=="number"&&d>=0&&d<=255?v===void 0||typeof v=="number"&&v>=0&&v<=1?null:`Invalid rgba value [${[h,u,d,v].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof v=="number"?[h,u,d,v]:[h,u,d]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Mi(h){if(h===null||typeof h=="string"||typeof h=="boolean"||typeof h=="number"||h instanceof Lo||h instanceof ui||h instanceof ji||h instanceof Ws||h instanceof Zs||h instanceof us||h instanceof La)return!0;if(Array.isArray(h)){for(const u of h)if(!Mi(u))return!1;return!0}if(typeof h=="object"){for(const u in h)if(!Mi(h[u]))return!1;return!0}return!1}function fs(h){if(h===null)return pn;if(typeof h=="string")return Hn;if(typeof h=="boolean")return or;if(typeof h=="number")return Ut;if(h instanceof ui)return Xr;if(h instanceof Lo)return ri;if(h instanceof ji)return As;if(h instanceof Ws)return $i;if(h instanceof Zs)return Qa;if(h instanceof us)return Li;if(h instanceof La)return pi;if(Array.isArray(h)){const u=h.length;let d;for(const v of h){const P=fs(v);if(d){if(d===P)continue;d=Pr;break}d=P}return Yi(d||Pr,u)}return ai}function Bi(h){const u=typeof h;return h===null?"":u==="string"||u==="number"||u==="boolean"?String(h):h instanceof ui||h instanceof Lo||h instanceof Ws||h instanceof Zs||h instanceof us||h instanceof La?h.toString():JSON.stringify(h)}class Bl{constructor(u,d){this.type=u,this.value=d}static parse(u,d){if(u.length!==2)return d.error(`'literal' expression requires exactly one argument, but found ${u.length-1} instead.`);if(!Mi(u[1]))return d.error("invalid value");const v=u[1];let P=fs(v);const D=d.expectedType;return P.kind!=="array"||P.N!==0||!D||D.kind!=="array"||typeof D.N=="number"&&D.N!==0||(P=D),new Bl(P,v)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Nl={string:Hn,number:Ut,boolean:or,object:ai};class No{constructor(u,d){this.type=u,this.args=d}static parse(u,d){if(u.length<2)return d.error("Expected at least one argument.");let v,P=1;const D=u[0];if(D==="array"){let j,K;if(u.length>2){const ee=u[1];if(typeof ee!="string"||!(ee in Nl)||ee==="object")return d.error('The item type argument of "array" must be one of string, number, boolean',1);j=Nl[ee],P++}else j=Pr;if(u.length>3){if(u[2]!==null&&(typeof u[2]!="number"||u[2]<0||u[2]!==Math.floor(u[2])))return d.error('The length argument to "array" must be a positive integer literal',2);K=u[2],P++}v=Yi(j,K)}else{if(!Nl[D])throw new Error(`Types doesn't contain name = ${D}`);v=Nl[D]}const O=[];for(;P<u.length;P++){const j=d.parse(u[P],P,Pr);if(!j)return null;O.push(j)}return new No(v,O)}evaluate(u){for(let d=0;d<this.args.length;d++){const v=this.args[d].evaluate(u);if(!wc(this.type,fs(v)))return v;if(d===this.args.length-1)throw new Ms(`Expected value to be of type ${ns(this.type)}, but found ${ns(fs(v))} instead.`)}throw new Error}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}const Pa={"to-boolean":or,"to-color":Xr,"to-number":Ut,"to-string":Hn};class qi{constructor(u,d){this.type=u,this.args=d}static parse(u,d){if(u.length<2)return d.error("Expected at least one argument.");const v=u[0];if(!Pa[v])throw new Error(`Can't parse ${v} as it is not part of the known types`);if((v==="to-boolean"||v==="to-string")&&u.length!==2)return d.error("Expected one argument.");const P=Pa[v],D=[];for(let O=1;O<u.length;O++){const j=d.parse(u[O],O,Pr);if(!j)return null;D.push(j)}return new qi(P,D)}evaluate(u){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(u);case"color":{let d,v;for(const P of this.args){if(d=P.evaluate(u),v=null,d instanceof ui)return d;if(typeof d=="string"){const D=u.parseColor(d);if(D)return D}else if(Array.isArray(d)&&(v=d.length<3||d.length>4?`Invalid rgba value ${JSON.stringify(d)}: expected an array containing either three or four numeric values.`:yi(d[0],d[1],d[2],d[3]),!v))return new ui(d[0]/255,d[1]/255,d[2]/255,d[3])}throw new Ms(v||`Could not parse color from value '${typeof d=="string"?d:JSON.stringify(d)}'`)}case"padding":{let d;for(const v of this.args){d=v.evaluate(u);const P=Zs.parse(d);if(P)return P}throw new Ms(`Could not parse padding from value '${typeof d=="string"?d:JSON.stringify(d)}'`)}case"variableAnchorOffsetCollection":{let d;for(const v of this.args){d=v.evaluate(u);const P=us.parse(d);if(P)return P}throw new Ms(`Could not parse variableAnchorOffsetCollection from value '${typeof d=="string"?d:JSON.stringify(d)}'`)}case"number":{let d=null;for(const v of this.args){if(d=v.evaluate(u),d===null)return 0;const P=Number(d);if(!isNaN(P))return P}throw new Ms(`Could not convert ${JSON.stringify(d)} to number.`)}case"formatted":return Ws.fromString(Bi(this.args[0].evaluate(u)));case"resolvedImage":return La.fromString(Bi(this.args[0].evaluate(u)));case"projectionDefinition":return this.args[0].evaluate(u);default:return Bi(this.args[0].evaluate(u))}}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}const Sc=["Unknown","Point","LineString","Polygon"];class Gi{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Sc[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(u){let d=this._parseColorCache[u];return d||(d=this._parseColorCache[u]=ui.parse(u)),d}}class Nr{constructor(u,d,v=[],P,D=new Cn,O=[]){this.registry=u,this.path=v,this.key=v.map(j=>`[${j}]`).join(""),this.scope=D,this.errors=O,this.expectedType=P,this._isConstant=d}parse(u,d,v,P,D={}){return d?this.concat(d,v,P)._parse(u,D):this._parse(u,D)}_parse(u,d){function v(P,D,O){return O==="assert"?new No(D,[P]):O==="coerce"?new qi(D,[P]):P}if(u!==null&&typeof u!="string"&&typeof u!="boolean"&&typeof u!="number"||(u=["literal",u]),Array.isArray(u)){if(u.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const P=u[0];if(typeof P!="string")return this.error(`Expression name must be a string, but found ${typeof P} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const D=this.registry[P];if(D){let O=D.parse(u,this);if(!O)return null;if(this.expectedType){const j=this.expectedType,K=O.type;if(j.kind!=="string"&&j.kind!=="number"&&j.kind!=="boolean"&&j.kind!=="object"&&j.kind!=="array"||K.kind!=="value")if(j.kind!=="projectionDefinition"||K.kind!=="string"&&K.kind!=="array")if(j.kind!=="color"&&j.kind!=="formatted"&&j.kind!=="resolvedImage"||K.kind!=="value"&&K.kind!=="string")if(j.kind!=="padding"||K.kind!=="value"&&K.kind!=="number"&&K.kind!=="array")if(j.kind!=="variableAnchorOffsetCollection"||K.kind!=="value"&&K.kind!=="array"){if(this.checkSubtype(j,K))return null}else O=v(O,j,d.typeAnnotation||"coerce");else O=v(O,j,d.typeAnnotation||"coerce");else O=v(O,j,d.typeAnnotation||"coerce");else O=v(O,j,d.typeAnnotation||"coerce");else O=v(O,j,d.typeAnnotation||"assert")}if(!(O instanceof Bl)&&O.type.kind!=="resolvedImage"&&this._isConstant(O)){const j=new Gi;try{O=new Bl(O.type,O.evaluate(j))}catch(K){return this.error(K.message),null}}return O}return this.error(`Unknown expression "${P}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(u===void 0?"'undefined' value invalid. Use null instead.":typeof u=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof u} instead.`)}concat(u,d,v){const P=typeof u=="number"?this.path.concat(u):this.path,D=v?this.scope.concat(v):this.scope;return new Nr(this.registry,this._isConstant,P,d||null,D,this.errors)}error(u,...d){const v=`${this.key}${d.map(P=>`[${P}]`).join("")}`;this.errors.push(new vr(v,u))}checkSubtype(u,d){const v=wc(u,d);return v&&this.error(v),v}}class Fi{constructor(u,d){this.type=d.type,this.bindings=[].concat(u),this.result=d}evaluate(u){return this.result.evaluate(u)}eachChild(u){for(const d of this.bindings)u(d[1]);u(this.result)}static parse(u,d){if(u.length<4)return d.error(`Expected at least 3 arguments, but found ${u.length-1} instead.`);const v=[];for(let D=1;D<u.length-1;D+=2){const O=u[D];if(typeof O!="string")return d.error(`Expected string, but found ${typeof O} instead.`,D);if(/[^a-zA-Z0-9_]/.test(O))return d.error("Variable names must contain only alphanumeric characters or '_'.",D);const j=d.parse(u[D+1],D+1);if(!j)return null;v.push([O,j])}const P=d.parse(u[u.length-1],u.length-1,d.expectedType,v);return P?new Fi(v,P):null}outputDefined(){return this.result.outputDefined()}}class Oi{constructor(u,d){this.type=d.type,this.name=u,this.boundExpression=d}static parse(u,d){if(u.length!==2||typeof u[1]!="string")return d.error("'var' expression requires exactly one string literal argument.");const v=u[1];return d.scope.has(v)?new Oi(v,d.scope.get(v)):d.error(`Unknown variable "${v}". Make sure "${v}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(u){return this.boundExpression.evaluate(u)}eachChild(){}outputDefined(){return!1}}class hc{constructor(u,d,v){this.type=u,this.index=d,this.input=v}static parse(u,d){if(u.length!==3)return d.error(`Expected 2 arguments, but found ${u.length-1} instead.`);const v=d.parse(u[1],1,Ut),P=d.parse(u[2],2,Yi(d.expectedType||Pr));return v&&P?new hc(P.type.itemType,v,P):null}evaluate(u){const d=this.index.evaluate(u),v=this.input.evaluate(u);if(d<0)throw new Ms(`Array index out of bounds: ${d} < 0.`);if(d>=v.length)throw new Ms(`Array index out of bounds: ${d} > ${v.length-1}.`);if(d!==Math.floor(d))throw new Ms(`Array index must be an integer, but found ${d} instead.`);return v[d]}eachChild(u){u(this.index),u(this.input)}outputDefined(){return!1}}class ua{constructor(u,d){this.type=or,this.needle=u,this.haystack=d}static parse(u,d){if(u.length!==3)return d.error(`Expected 2 arguments, but found ${u.length-1} instead.`);const v=d.parse(u[1],1,Pr),P=d.parse(u[2],2,Pr);return v&&P?Wu(v.type,[or,Hn,Ut,pn,Pr])?new ua(v,P):d.error(`Expected first argument to be of type boolean, string, number or null, but found ${ns(v.type)} instead`):null}evaluate(u){const d=this.needle.evaluate(u),v=this.haystack.evaluate(u);if(!v)return!1;if(!el(d,["boolean","string","number","null"]))throw new Ms(`Expected first argument to be of type boolean, string, number or null, but found ${ns(fs(d))} instead.`);if(!el(v,["string","array"]))throw new Ms(`Expected second argument to be of type array or string, but found ${ns(fs(v))} instead.`);return v.indexOf(d)>=0}eachChild(u){u(this.needle),u(this.haystack)}outputDefined(){return!0}}class hu{constructor(u,d,v){this.type=Ut,this.needle=u,this.haystack=d,this.fromIndex=v}static parse(u,d){if(u.length<=2||u.length>=5)return d.error(`Expected 3 or 4 arguments, but found ${u.length-1} instead.`);const v=d.parse(u[1],1,Pr),P=d.parse(u[2],2,Pr);if(!v||!P)return null;if(!Wu(v.type,[or,Hn,Ut,pn,Pr]))return d.error(`Expected first argument to be of type boolean, string, number or null, but found ${ns(v.type)} instead`);if(u.length===4){const D=d.parse(u[3],3,Ut);return D?new hu(v,P,D):null}return new hu(v,P)}evaluate(u){const d=this.needle.evaluate(u),v=this.haystack.evaluate(u);if(!el(d,["boolean","string","number","null"]))throw new Ms(`Expected first argument to be of type boolean, string, number or null, but found ${ns(fs(d))} instead.`);let P;if(this.fromIndex&&(P=this.fromIndex.evaluate(u)),el(v,["string"])){const D=v.indexOf(d,P);return D===-1?-1:[...v.slice(0,D)].length}if(el(v,["array"]))return v.indexOf(d,P);throw new Ms(`Expected second argument to be of type array or string, but found ${ns(fs(v))} instead.`)}eachChild(u){u(this.needle),u(this.haystack),this.fromIndex&&u(this.fromIndex)}outputDefined(){return!1}}class du{constructor(u,d,v,P,D,O){this.inputType=u,this.type=d,this.input=v,this.cases=P,this.outputs=D,this.otherwise=O}static parse(u,d){if(u.length<5)return d.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if(u.length%2!=1)return d.error("Expected an even number of arguments.");let v,P;d.expectedType&&d.expectedType.kind!=="value"&&(P=d.expectedType);const D={},O=[];for(let ee=2;ee<u.length-1;ee+=2){let ce=u[ee];const ve=u[ee+1];Array.isArray(ce)||(ce=[ce]);const Re=d.concat(ee);if(ce.length===0)return Re.error("Expected at least one branch label.");for(const qe of ce){if(typeof qe!="number"&&typeof qe!="string")return Re.error("Branch labels must be numbers or strings.");if(typeof qe=="number"&&Math.abs(qe)>Number.MAX_SAFE_INTEGER)return Re.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof qe=="number"&&Math.floor(qe)!==qe)return Re.error("Numeric branch labels must be integer values.");if(v){if(Re.checkSubtype(v,fs(qe)))return null}else v=fs(qe);if(D[String(qe)]!==void 0)return Re.error("Branch labels must be unique.");D[String(qe)]=O.length}const Ue=d.parse(ve,ee,P);if(!Ue)return null;P=P||Ue.type,O.push(Ue)}const j=d.parse(u[1],1,Pr);if(!j)return null;const K=d.parse(u[u.length-1],u.length-1,P);return K?j.type.kind!=="value"&&d.concat(1).checkSubtype(v,j.type)?null:new du(v,P,j,D,O,K):null}evaluate(u){const d=this.input.evaluate(u);return(fs(d)===this.inputType&&this.outputs[this.cases[d]]||this.otherwise).evaluate(u)}eachChild(u){u(this.input),this.outputs.forEach(u),u(this.otherwise)}outputDefined(){return this.outputs.every(u=>u.outputDefined())&&this.otherwise.outputDefined()}}class Iu{constructor(u,d,v){this.type=u,this.branches=d,this.otherwise=v}static parse(u,d){if(u.length<4)return d.error(`Expected at least 3 arguments, but found only ${u.length-1}.`);if(u.length%2!=0)return d.error("Expected an odd number of arguments.");let v;d.expectedType&&d.expectedType.kind!=="value"&&(v=d.expectedType);const P=[];for(let O=1;O<u.length-1;O+=2){const j=d.parse(u[O],O,or);if(!j)return null;const K=d.parse(u[O+1],O+1,v);if(!K)return null;P.push([j,K]),v=v||K.type}const D=d.parse(u[u.length-1],u.length-1,v);if(!D)return null;if(!v)throw new Error("Can't infer output type");return new Iu(v,P,D)}evaluate(u){for(const[d,v]of this.branches)if(d.evaluate(u))return v.evaluate(u);return this.otherwise.evaluate(u)}eachChild(u){for(const[d,v]of this.branches)u(d),u(v);u(this.otherwise)}outputDefined(){return this.branches.every(([u,d])=>d.outputDefined())&&this.otherwise.outputDefined()}}class fu{constructor(u,d,v,P){this.type=u,this.input=d,this.beginIndex=v,this.endIndex=P}static parse(u,d){if(u.length<=2||u.length>=5)return d.error(`Expected 3 or 4 arguments, but found ${u.length-1} instead.`);const v=d.parse(u[1],1,Pr),P=d.parse(u[2],2,Ut);if(!v||!P)return null;if(!Wu(v.type,[Yi(Pr),Hn,Pr]))return d.error(`Expected first argument to be of type array or string, but found ${ns(v.type)} instead`);if(u.length===4){const D=d.parse(u[3],3,Ut);return D?new fu(v.type,v,P,D):null}return new fu(v.type,v,P)}evaluate(u){const d=this.input.evaluate(u),v=this.beginIndex.evaluate(u);let P;if(this.endIndex&&(P=this.endIndex.evaluate(u)),el(d,["string"]))return[...d].slice(v,P).join("");if(el(d,["array"]))return d.slice(v,P);throw new Ms(`Expected first argument to be of type array or string, but found ${ns(fs(d))} instead.`)}eachChild(u){u(this.input),u(this.beginIndex),this.endIndex&&u(this.endIndex)}outputDefined(){return!1}}function Hi(h,u){const d=h.length-1;let v,P,D=0,O=d,j=0;for(;D<=O;)if(j=Math.floor((D+O)/2),v=h[j],P=h[j+1],v<=u){if(j===d||u<P)return j;D=j+1}else{if(!(v>u))throw new Ms("Input is not a number.");O=j-1}return 0}class Ks{constructor(u,d,v){this.type=u,this.input=d,this.labels=[],this.outputs=[];for(const[P,D]of v)this.labels.push(P),this.outputs.push(D)}static parse(u,d){if(u.length-1<4)return d.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if((u.length-1)%2!=0)return d.error("Expected an even number of arguments.");const v=d.parse(u[1],1,Ut);if(!v)return null;const P=[];let D=null;d.expectedType&&d.expectedType.kind!=="value"&&(D=d.expectedType);for(let O=1;O<u.length;O+=2){const j=O===1?-1/0:u[O],K=u[O+1],ee=O,ce=O+1;if(typeof j!="number")return d.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ee);if(P.length&&P[P.length-1][0]>=j)return d.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',ee);const ve=d.parse(K,ce,D);if(!ve)return null;D=D||ve.type,P.push([j,ve])}return new Ks(D,v,P)}evaluate(u){const d=this.labels,v=this.outputs;if(d.length===1)return v[0].evaluate(u);const P=this.input.evaluate(u);if(P<=d[0])return v[0].evaluate(u);const D=d.length;return P>=d[D-1]?v[D-1].evaluate(u):v[Hi(d,P)].evaluate(u)}eachChild(u){u(this.input);for(const d of this.outputs)u(d)}outputDefined(){return this.outputs.every(u=>u.outputDefined())}}function di(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var ro,vl,Ys=function(){if(vl)return ro;function h(u,d,v,P){this.cx=3*u,this.bx=3*(v-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*d,this.by=3*(P-d)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=d,this.p2x=v,this.p2y=P}return vl=1,ro=h,h.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,d){if(d===void 0&&(d=1e-6),u<0)return 0;if(u>1)return 1;for(var v=u,P=0;P<8;P++){var D=this.sampleCurveX(v)-u;if(Math.abs(D)<d)return v;var O=this.sampleCurveDerivativeX(v);if(Math.abs(O)<1e-6)break;v-=D/O}var j=0,K=1;for(v=u,P=0;P<20&&(D=this.sampleCurveX(v),!(Math.abs(D-u)<d));P++)u>D?j=v:K=v,v=.5*(K-j)+j;return v},solve:function(u,d){return this.sampleCurveY(this.solveCurveX(u,d))}},ro}(),Fs=di(Ys);class Fo{constructor(u,d,v,P,D){this.type=u,this.operator=d,this.interpolation=v,this.input=P,this.labels=[],this.outputs=[];for(const[O,j]of D)this.labels.push(O),this.outputs.push(j)}static interpolationFactor(u,d,v,P){let D=0;if(u.name==="exponential")D=Ea(d,u.base,v,P);else if(u.name==="linear")D=Ea(d,1,v,P);else if(u.name==="cubic-bezier"){const O=u.controlPoints;D=new Fs(O[0],O[1],O[2],O[3]).solve(Ea(d,1,v,P))}return D}static parse(u,d){let[v,P,D,...O]=u;if(!Array.isArray(P)||P.length===0)return d.error("Expected an interpolation type expression.",1);if(P[0]==="linear")P={name:"linear"};else if(P[0]==="exponential"){const ee=P[1];if(typeof ee!="number")return d.error("Exponential interpolation requires a numeric base.",1,1);P={name:"exponential",base:ee}}else{if(P[0]!=="cubic-bezier")return d.error(`Unknown interpolation type ${String(P[0])}`,1,0);{const ee=P.slice(1);if(ee.length!==4||ee.some(ce=>typeof ce!="number"||ce<0||ce>1))return d.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);P={name:"cubic-bezier",controlPoints:ee}}}if(u.length-1<4)return d.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if((u.length-1)%2!=0)return d.error("Expected an even number of arguments.");if(D=d.parse(D,2,Ut),!D)return null;const j=[];let K=null;v==="interpolate-hcl"||v==="interpolate-lab"?K=Xr:d.expectedType&&d.expectedType.kind!=="value"&&(K=d.expectedType);for(let ee=0;ee<O.length;ee+=2){const ce=O[ee],ve=O[ee+1],Re=ee+3,Ue=ee+4;if(typeof ce!="number")return d.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Re);if(j.length&&j[j.length-1][0]>=ce)return d.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Re);const qe=d.parse(ve,Ue,K);if(!qe)return null;K=K||qe.type,j.push([ce,qe])}return Au(K,Ut)||Au(K,ri)||Au(K,Xr)||Au(K,Qa)||Au(K,Li)||Au(K,Yi(Ut))?new Fo(K,v,P,D,j):d.error(`Type ${ns(K)} is not interpolatable.`)}evaluate(u){const d=this.labels,v=this.outputs;if(d.length===1)return v[0].evaluate(u);const P=this.input.evaluate(u);if(P<=d[0])return v[0].evaluate(u);const D=d.length;if(P>=d[D-1])return v[D-1].evaluate(u);const O=Hi(d,P),j=Fo.interpolationFactor(this.interpolation,P,d[O],d[O+1]),K=v[O].evaluate(u),ee=v[O+1].evaluate(u);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return So(K,ee,j);case"color":return ui.interpolate(K,ee,j);case"padding":return Zs.interpolate(K,ee,j);case"variableAnchorOffsetCollection":return us.interpolate(K,ee,j);case"array":return tl(K,ee,j);case"projectionDefinition":return Lo.interpolate(K,ee,j)}case"interpolate-hcl":return ui.interpolate(K,ee,j,"hcl");case"interpolate-lab":return ui.interpolate(K,ee,j,"lab")}}eachChild(u){u(this.input);for(const d of this.outputs)u(d)}outputDefined(){return this.outputs.every(u=>u.outputDefined())}}function Ea(h,u,d,v){const P=v-d,D=h-d;return P===0?0:u===1?D/P:(Math.pow(u,D)-1)/(Math.pow(u,P)-1)}const vs={color:ui.interpolate,number:So,padding:Zs.interpolate,variableAnchorOffsetCollection:us.interpolate,array:tl};class pu{constructor(u,d){this.type=u,this.args=d}static parse(u,d){if(u.length<2)return d.error("Expected at least one argument.");let v=null;const P=d.expectedType;P&&P.kind!=="value"&&(v=P);const D=[];for(const j of u.slice(1)){const K=d.parse(j,1+D.length,v,void 0,{typeAnnotation:"omit"});if(!K)return null;v=v||K.type,D.push(K)}if(!v)throw new Error("No output type");const O=P&&D.some(j=>wc(P,j.type));return new pu(O?Pr:v,D)}evaluate(u){let d,v=null,P=0;for(const D of this.args)if(P++,v=D.evaluate(u),v&&v instanceof La&&!v.available&&(d||(d=v.name),v=null,P===this.args.length&&(v=d)),v!==null)break;return v}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}function Ma(h,u){return h==="=="||h==="!="?u.kind==="boolean"||u.kind==="string"||u.kind==="number"||u.kind==="null"||u.kind==="value":u.kind==="string"||u.kind==="number"||u.kind==="value"}function Qu(h,u,d,v){return v.compare(u,d)===0}function ss(h,u,d){const v=h!=="=="&&h!=="!=";return class E6{constructor(D,O,j){this.type=or,this.lhs=D,this.rhs=O,this.collator=j,this.hasUntypedArgument=D.type.kind==="value"||O.type.kind==="value"}static parse(D,O){if(D.length!==3&&D.length!==4)return O.error("Expected two or three arguments.");const j=D[0];let K=O.parse(D[1],1,Pr);if(!K)return null;if(!Ma(j,K.type))return O.concat(1).error(`"${j}" comparisons are not supported for type '${ns(K.type)}'.`);let ee=O.parse(D[2],2,Pr);if(!ee)return null;if(!Ma(j,ee.type))return O.concat(2).error(`"${j}" comparisons are not supported for type '${ns(ee.type)}'.`);if(K.type.kind!==ee.type.kind&&K.type.kind!=="value"&&ee.type.kind!=="value")return O.error(`Cannot compare types '${ns(K.type)}' and '${ns(ee.type)}'.`);v&&(K.type.kind==="value"&&ee.type.kind!=="value"?K=new No(ee.type,[K]):K.type.kind!=="value"&&ee.type.kind==="value"&&(ee=new No(K.type,[ee])));let ce=null;if(D.length===4){if(K.type.kind!=="string"&&ee.type.kind!=="string"&&K.type.kind!=="value"&&ee.type.kind!=="value")return O.error("Cannot use collator to compare non-string types.");if(ce=O.parse(D[3],3,As),!ce)return null}return new E6(K,ee,ce)}evaluate(D){const O=this.lhs.evaluate(D),j=this.rhs.evaluate(D);if(v&&this.hasUntypedArgument){const K=fs(O),ee=fs(j);if(K.kind!==ee.kind||K.kind!=="string"&&K.kind!=="number")throw new Ms(`Expected arguments for "${h}" to be (string, string) or (number, number), but found (${K.kind}, ${ee.kind}) instead.`)}if(this.collator&&!v&&this.hasUntypedArgument){const K=fs(O),ee=fs(j);if(K.kind!=="string"||ee.kind!=="string")return u(D,O,j)}return this.collator?d(D,O,j,this.collator.evaluate(D)):u(D,O,j)}eachChild(D){D(this.lhs),D(this.rhs),this.collator&&D(this.collator)}outputDefined(){return!0}}}const Lc=ss("==",function(h,u,d){return u===d},Qu),Po=ss("!=",function(h,u,d){return u!==d},function(h,u,d,v){return!Qu(0,u,d,v)}),Fl=ss("<",function(h,u,d){return u<d},function(h,u,d,v){return v.compare(u,d)<0}),Du=ss(">",function(h,u,d){return u>d},function(h,u,d,v){return v.compare(u,d)>0}),Va=ss("<=",function(h,u,d){return u<=d},function(h,u,d,v){return v.compare(u,d)<=0}),Jo=ss(">=",function(h,u,d){return u>=d},function(h,u,d,v){return v.compare(u,d)>=0});class zl{constructor(u,d,v){this.type=As,this.locale=v,this.caseSensitive=u,this.diacriticSensitive=d}static parse(u,d){if(u.length!==2)return d.error("Expected one argument.");const v=u[1];if(typeof v!="object"||Array.isArray(v))return d.error("Collator options argument must be an object.");const P=d.parse(v["case-sensitive"]!==void 0&&v["case-sensitive"],1,or);if(!P)return null;const D=d.parse(v["diacritic-sensitive"]!==void 0&&v["diacritic-sensitive"],1,or);if(!D)return null;let O=null;return v.locale&&(O=d.parse(v.locale,1,Hn),!O)?null:new zl(P,D,O)}evaluate(u){return new ji(this.caseSensitive.evaluate(u),this.diacriticSensitive.evaluate(u),this.locale?this.locale.evaluate(u):null)}eachChild(u){u(this.caseSensitive),u(this.diacriticSensitive),this.locale&&u(this.locale)}outputDefined(){return!1}}class os{constructor(u,d,v,P,D){this.type=Hn,this.number=u,this.locale=d,this.currency=v,this.minFractionDigits=P,this.maxFractionDigits=D}static parse(u,d){if(u.length!==3)return d.error("Expected two arguments.");const v=d.parse(u[1],1,Ut);if(!v)return null;const P=u[2];if(typeof P!="object"||Array.isArray(P))return d.error("NumberFormat options argument must be an object.");let D=null;if(P.locale&&(D=d.parse(P.locale,1,Hn),!D))return null;let O=null;if(P.currency&&(O=d.parse(P.currency,1,Hn),!O))return null;let j=null;if(P["min-fraction-digits"]&&(j=d.parse(P["min-fraction-digits"],1,Ut),!j))return null;let K=null;return P["max-fraction-digits"]&&(K=d.parse(P["max-fraction-digits"],1,Ut),!K)?null:new os(v,D,O,j,K)}evaluate(u){return new Intl.NumberFormat(this.locale?this.locale.evaluate(u):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(u):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(u):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(u):void 0}).format(this.number.evaluate(u))}eachChild(u){u(this.number),this.locale&&u(this.locale),this.currency&&u(this.currency),this.minFractionDigits&&u(this.minFractionDigits),this.maxFractionDigits&&u(this.maxFractionDigits)}outputDefined(){return!1}}class ca{constructor(u){this.type=$i,this.sections=u}static parse(u,d){if(u.length<2)return d.error("Expected at least one argument.");const v=u[1];if(!Array.isArray(v)&&typeof v=="object")return d.error("First argument must be an image or text section.");const P=[];let D=!1;for(let O=1;O<=u.length-1;++O){const j=u[O];if(D&&typeof j=="object"&&!Array.isArray(j)){D=!1;let K=null;if(j["font-scale"]&&(K=d.parse(j["font-scale"],1,Ut),!K))return null;let ee=null;if(j["text-font"]&&(ee=d.parse(j["text-font"],1,Yi(Hn)),!ee))return null;let ce=null;if(j["text-color"]&&(ce=d.parse(j["text-color"],1,Xr),!ce))return null;let ve=null;if(j["vertical-align"]){if(typeof j["vertical-align"]=="string"&&!nl.includes(j["vertical-align"]))return d.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${j["vertical-align"]}' instead.`);if(ve=d.parse(j["vertical-align"],1,Hn),!ve)return null}const Re=P[P.length-1];Re.scale=K,Re.font=ee,Re.textColor=ce,Re.verticalAlign=ve}else{const K=d.parse(u[O],1,Pr);if(!K)return null;const ee=K.type.kind;if(ee!=="string"&&ee!=="value"&&ee!=="null"&&ee!=="resolvedImage")return d.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");D=!0,P.push({content:K,scale:null,font:null,textColor:null,verticalAlign:null})}}return new ca(P)}evaluate(u){return new Ws(this.sections.map(d=>{const v=d.content.evaluate(u);return fs(v)===pi?new rl("",v,null,null,null,d.verticalAlign?d.verticalAlign.evaluate(u):null):new rl(Bi(v),null,d.scale?d.scale.evaluate(u):null,d.font?d.font.evaluate(u).join(","):null,d.textColor?d.textColor.evaluate(u):null,d.verticalAlign?d.verticalAlign.evaluate(u):null)}))}eachChild(u){for(const d of this.sections)u(d.content),d.scale&&u(d.scale),d.font&&u(d.font),d.textColor&&u(d.textColor),d.verticalAlign&&u(d.verticalAlign)}outputDefined(){return!1}}class il{constructor(u){this.type=pi,this.input=u}static parse(u,d){if(u.length!==2)return d.error("Expected two arguments.");const v=d.parse(u[1],1,Hn);return v?new il(v):d.error("No image name provided.")}evaluate(u){const d=this.input.evaluate(u),v=La.fromString(d);return v&&u.availableImages&&(v.available=u.availableImages.indexOf(d)>-1),v}eachChild(u){u(this.input)}outputDefined(){return!1}}class uo{constructor(u){this.type=Ut,this.input=u}static parse(u,d){if(u.length!==2)return d.error(`Expected 1 argument, but found ${u.length-1} instead.`);const v=d.parse(u[1],1);return v?v.type.kind!=="array"&&v.type.kind!=="string"&&v.type.kind!=="value"?d.error(`Expected argument of type string or array, but found ${ns(v.type)} instead.`):new uo(v):null}evaluate(u){const d=this.input.evaluate(u);if(typeof d=="string")return[...d].length;if(Array.isArray(d))return d.length;throw new Ms(`Expected value to be of type string or array, but found ${ns(fs(d))} instead.`)}eachChild(u){u(this.input)}outputDefined(){return!1}}const J=8192;function Xe(h,u){const d=(180+h[0])/360,v=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h[1]*Math.PI/360)))/360,P=Math.pow(2,u.z);return[Math.round(d*P*J),Math.round(v*P*J)]}function Bt(h,u){const d=Math.pow(2,u.z);return[(P=(h[0]/J+u.x)/d,360*P-180),(v=(h[1]/J+u.y)/d,360/Math.PI*Math.atan(Math.exp((180-360*v)*Math.PI/180))-90)];var v,P}function nn(h,u){h[0]=Math.min(h[0],u[0]),h[1]=Math.min(h[1],u[1]),h[2]=Math.max(h[2],u[0]),h[3]=Math.max(h[3],u[1])}function An(h,u){return!(h[0]<=u[0]||h[2]>=u[2]||h[1]<=u[1]||h[3]>=u[3])}function Xn(h,u,d){const v=h[0]-u[0],P=h[1]-u[1],D=h[0]-d[0],O=h[1]-d[1];return v*O-D*P==0&&v*D<=0&&P*O<=0}function wr(h,u,d,v){return(P=[v[0]-d[0],v[1]-d[1]])[0]*(D=[u[0]-h[0],u[1]-h[1]])[1]-P[1]*D[0]!=0&&!(!js(h,u,d,v)||!js(d,v,h,u));var P,D}function Wr(h,u,d){for(const v of d)for(let P=0;P<v.length-1;++P)if(wr(h,u,v[P],v[P+1]))return!0;return!1}function Zr(h,u,d=!1){let v=!1;for(const j of u)for(let K=0;K<j.length-1;K++){if(Xn(h,j[K],j[K+1]))return d;(D=j[K])[1]>(P=h)[1]!=(O=j[K+1])[1]>P[1]&&P[0]<(O[0]-D[0])*(P[1]-D[1])/(O[1]-D[1])+D[0]&&(v=!v)}var P,D,O;return v}function fi(h,u){for(const d of u)if(Zr(h,d))return!0;return!1}function Pi(h,u){for(const d of h)if(!Zr(d,u))return!1;for(let d=0;d<h.length-1;++d)if(Wr(h[d],h[d+1],u))return!1;return!0}function Xi(h,u){for(const d of u)if(Pi(h,d))return!0;return!1}function js(h,u,d,v){const P=v[0]-d[0],D=v[1]-d[1],O=(h[0]-d[0])*D-P*(h[1]-d[1]),j=(u[0]-d[0])*D-P*(u[1]-d[1]);return O>0&&j<0||O<0&&j>0}function cs(h,u,d){const v=[];for(let P=0;P<h.length;P++){const D=[];for(let O=0;O<h[P].length;O++){const j=Xe(h[P][O],d);nn(u,j),D.push(j)}v.push(D)}return v}function _s(h,u,d){const v=[];for(let P=0;P<h.length;P++){const D=cs(h[P],u,d);v.push(D)}return v}function co(h,u,d,v){if(h[0]<d[0]||h[0]>d[2]){const P=.5*v;let D=h[0]-d[0]>P?-v:d[0]-h[0]>P?v:0;D===0&&(D=h[0]-d[2]>P?-v:d[2]-h[0]>P?v:0),h[0]+=D}nn(u,h)}function yo(h,u,d,v){const P=Math.pow(2,v.z)*J,D=[v.x*J,v.y*J],O=[];for(const j of h)for(const K of j){const ee=[K.x+D[0],K.y+D[1]];co(ee,u,d,P),O.push(ee)}return O}function $a(h,u,d,v){const P=Math.pow(2,v.z)*J,D=[v.x*J,v.y*J],O=[];for(const K of h){const ee=[];for(const ce of K){const ve=[ce.x+D[0],ce.y+D[1]];nn(u,ve),ee.push(ve)}O.push(ee)}if(u[2]-u[0]<=P/2){(j=u)[0]=j[1]=1/0,j[2]=j[3]=-1/0;for(const K of O)for(const ee of K)co(ee,u,d,P)}var j;return O}class Ri{constructor(u,d){this.type=or,this.geojson=u,this.geometries=d}static parse(u,d){if(u.length!==2)return d.error(`'within' expression requires exactly one argument, but found ${u.length-1} instead.`);if(Mi(u[1])){const v=u[1];if(v.type==="FeatureCollection"){const P=[];for(const D of v.features){const{type:O,coordinates:j}=D.geometry;O==="Polygon"&&P.push(j),O==="MultiPolygon"&&P.push(...j)}if(P.length)return new Ri(v,{type:"MultiPolygon",coordinates:P})}else if(v.type==="Feature"){const P=v.geometry.type;if(P==="Polygon"||P==="MultiPolygon")return new Ri(v,v.geometry)}else if(v.type==="Polygon"||v.type==="MultiPolygon")return new Ri(v,v)}return d.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(u){if(u.geometry()!=null&&u.canonicalID()!=null){if(u.geometryType()==="Point")return function(d,v){const P=[1/0,1/0,-1/0,-1/0],D=[1/0,1/0,-1/0,-1/0],O=d.canonicalID();if(v.type==="Polygon"){const j=cs(v.coordinates,D,O),K=yo(d.geometry(),P,D,O);if(!An(P,D))return!1;for(const ee of K)if(!Zr(ee,j))return!1}if(v.type==="MultiPolygon"){const j=_s(v.coordinates,D,O),K=yo(d.geometry(),P,D,O);if(!An(P,D))return!1;for(const ee of K)if(!fi(ee,j))return!1}return!0}(u,this.geometries);if(u.geometryType()==="LineString")return function(d,v){const P=[1/0,1/0,-1/0,-1/0],D=[1/0,1/0,-1/0,-1/0],O=d.canonicalID();if(v.type==="Polygon"){const j=cs(v.coordinates,D,O),K=$a(d.geometry(),P,D,O);if(!An(P,D))return!1;for(const ee of K)if(!Pi(ee,j))return!1}if(v.type==="MultiPolygon"){const j=_s(v.coordinates,D,O),K=$a(d.geometry(),P,D,O);if(!An(P,D))return!1;for(const ee of K)if(!Xi(ee,j))return!1}return!0}(u,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Qo=class{constructor(h=[],u=(d,v)=>d<v?-1:d>v?1:0){if(this.data=h,this.length=this.data.length,this.compare=u,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(h){this.data.push(h),this._up(this.length++)}pop(){if(this.length===0)return;const h=this.data[0],u=this.data.pop();return--this.length>0&&(this.data[0]=u,this._down(0)),h}peek(){return this.data[0]}_up(h){const{data:u,compare:d}=this,v=u[h];for(;h>0;){const P=h-1>>1,D=u[P];if(d(v,D)>=0)break;u[h]=D,h=P}u[h]=v}_down(h){const{data:u,compare:d}=this,v=this.length>>1,P=u[h];for(;h<v;){let D=1+(h<<1);const O=D+1;if(O<this.length&&d(u[O],u[D])<0&&(D=O),d(u[D],P)>=0)break;u[h]=u[D],h=D}u[h]=P}};function mu(h,u,d=0,v=h.length-1,P=Fc){for(;v>d;){if(v-d>600){const K=v-d+1,ee=u-d+1,ce=Math.log(K),ve=.5*Math.exp(2*ce/3),Re=.5*Math.sqrt(ce*ve*(K-ve)/K)*(ee-K/2<0?-1:1);mu(h,u,Math.max(d,Math.floor(u-ee*ve/K+Re)),Math.min(v,Math.floor(u+(K-ee)*ve/K+Re)),P)}const D=h[u];let O=d,j=v;for(Eo(h,d,u),P(h[v],D)>0&&Eo(h,d,v);O<j;){for(Eo(h,O,j),O++,j--;P(h[O],D)<0;)O++;for(;P(h[j],D)>0;)j--}P(h[d],D)===0?Eo(h,d,j):(j++,Eo(h,j,v)),j<=u&&(d=j+1),u<=j&&(v=j-1)}}function Eo(h,u,d){const v=h[u];h[u]=h[d],h[d]=v}function Fc(h,u){return h<u?-1:h>u?1:0}function sl(h,u){if(h.length<=1)return[h];const d=[];let v,P;for(const D of h){const O=Ou(D);O!==0&&(D.area=Math.abs(O),P===void 0&&(P=O<0),P===O<0?(v&&d.push(v),v=[D]):v.push(D))}if(v&&d.push(v),u>1)for(let D=0;D<d.length;D++)d[D].length<=u||(mu(d[D],u,1,d[D].length-1,zc),d[D]=d[D].slice(0,u));return d}function zc(h,u){return u.area-h.area}function Ou(h){let u=0;for(let d,v,P=0,D=h.length,O=D-1;P<D;O=P++)d=h[P],v=h[O],u+=(v.x-d.x)*(d.y+v.y);return u}const Ru=1/298.257223563,_o=Ru*(2-Ru),_l=Math.PI/180;class ha{constructor(u){const d=6378.137*_l*1e3,v=Math.cos(u*_l),P=1/(1-_o*(1-v*v)),D=Math.sqrt(P);this.kx=d*D*v,this.ky=d*D*P*(1-_o)}distance(u,d){const v=this.wrap(u[0]-d[0])*this.kx,P=(u[1]-d[1])*this.ky;return Math.sqrt(v*v+P*P)}pointOnLine(u,d){let v,P,D,O,j=1/0;for(let K=0;K<u.length-1;K++){let ee=u[K][0],ce=u[K][1],ve=this.wrap(u[K+1][0]-ee)*this.kx,Re=(u[K+1][1]-ce)*this.ky,Ue=0;ve===0&&Re===0||(Ue=(this.wrap(d[0]-ee)*this.kx*ve+(d[1]-ce)*this.ky*Re)/(ve*ve+Re*Re),Ue>1?(ee=u[K+1][0],ce=u[K+1][1]):Ue>0&&(ee+=ve/this.kx*Ue,ce+=Re/this.ky*Ue)),ve=this.wrap(d[0]-ee)*this.kx,Re=(d[1]-ce)*this.ky;const qe=ve*ve+Re*Re;qe<j&&(j=qe,v=ee,P=ce,D=K,O=Ue)}return{point:[v,P],index:D,t:Math.max(0,Math.min(1,O))}}wrap(u){for(;u<-180;)u+=360;for(;u>180;)u-=360;return u}}function Ta(h,u){return u[0]-h[0]}function gu(h){return h[1]-h[0]+1}function Xs(h,u){return h[1]>=h[0]&&h[1]<u}function zo(h,u){if(h[0]>h[1])return[null,null];const d=gu(h);if(u){if(d===2)return[h,null];const P=Math.floor(d/2);return[[h[0],h[0]+P],[h[0]+P,h[1]]]}if(d===1)return[h,null];const v=Math.floor(d/2)-1;return[[h[0],h[0]+v],[h[0]+v+1,h[1]]]}function ea(h,u){if(!Xs(u,h.length))return[1/0,1/0,-1/0,-1/0];const d=[1/0,1/0,-1/0,-1/0];for(let v=u[0];v<=u[1];++v)nn(d,h[v]);return d}function jc(h){const u=[1/0,1/0,-1/0,-1/0];for(const d of h)for(const v of d)nn(u,v);return u}function Mo(h){return h[0]!==-1/0&&h[1]!==-1/0&&h[2]!==1/0&&h[3]!==1/0}function jl(h,u,d){if(!Mo(h)||!Mo(u))return NaN;let v=0,P=0;return h[2]<u[0]&&(v=u[0]-h[2]),h[0]>u[2]&&(v=h[0]-u[2]),h[1]>u[3]&&(P=h[1]-u[3]),h[3]<u[1]&&(P=u[1]-h[3]),d.distance([0,0],[v,P])}function mi(h,u,d){const v=d.pointOnLine(u,h);return d.distance(h,v.point)}function jo(h,u,d,v,P){const D=Math.min(mi(h,[d,v],P),mi(u,[d,v],P)),O=Math.min(mi(d,[h,u],P),mi(v,[h,u],P));return Math.min(D,O)}function Bu(h,u,d,v,P){if(!Xs(u,h.length)||!Xs(v,d.length))return 1/0;let D=1/0;for(let O=u[0];O<u[1];++O){const j=h[O],K=h[O+1];for(let ee=v[0];ee<v[1];++ee){const ce=d[ee],ve=d[ee+1];if(wr(j,K,ce,ve))return 0;D=Math.min(D,jo(j,K,ce,ve,P))}}return D}function Nu(h,u,d,v,P){if(!Xs(u,h.length)||!Xs(v,d.length))return NaN;let D=1/0;for(let O=u[0];O<=u[1];++O)for(let j=v[0];j<=v[1];++j)if(D=Math.min(D,P.distance(h[O],d[j])),D===0)return D;return D}function da(h,u,d){if(Zr(h,u,!0))return 0;let v=1/0;for(const P of u){const D=P[0],O=P[P.length-1];if(D!==O&&(v=Math.min(v,mi(h,[O,D],d)),v===0))return v;const j=d.pointOnLine(P,h);if(v=Math.min(v,d.distance(h,j.point)),v===0)return v}return v}function ta(h,u,d,v){if(!Xs(u,h.length))return NaN;for(let D=u[0];D<=u[1];++D)if(Zr(h[D],d,!0))return 0;let P=1/0;for(let D=u[0];D<u[1];++D){const O=h[D],j=h[D+1];for(const K of d)for(let ee=0,ce=K.length,ve=ce-1;ee<ce;ve=ee++){const Re=K[ve],Ue=K[ee];if(wr(O,j,Re,Ue))return 0;P=Math.min(P,jo(O,j,Re,Ue,v))}}return P}function Ul(h,u){for(const d of h)for(const v of d)if(Zr(v,u,!0))return!0;return!1}function ol(h,u,d,v=1/0){const P=jc(h),D=jc(u);if(v!==1/0&&jl(P,D,d)>=v)return v;if(An(P,D)){if(Ul(h,u))return 0}else if(Ul(u,h))return 0;let O=1/0;for(const j of h)for(let K=0,ee=j.length,ce=ee-1;K<ee;ce=K++){const ve=j[ce],Re=j[K];for(const Ue of u)for(let qe=0,st=Ue.length,xt=st-1;qe<st;xt=qe++){const It=Ue[xt],fn=Ue[qe];if(wr(ve,Re,It,fn))return 0;O=Math.min(O,jo(ve,Re,It,fn,d))}}return O}function na(h,u,d,v,P,D){if(!D)return;const O=jl(ea(v,D),P,d);O<u&&h.push([O,D,[0,0]])}function Ln(h,u,d,v,P,D,O){if(!D||!O)return;const j=jl(ea(v,D),ea(P,O),d);j<u&&h.push([j,D,O])}function nr(h,u,d,v,P=1/0){let D=Math.min(v.distance(h[0],d[0][0]),P);if(D===0)return D;const O=new Qo([[0,[0,h.length-1],[0,0]]],Ta),j=jc(d);for(;O.length>0;){const K=O.pop();if(K[0]>=D)continue;const ee=K[1],ce=u?50:100;if(gu(ee)<=ce){if(!Xs(ee,h.length))return NaN;if(u){const ve=ta(h,ee,d,v);if(isNaN(ve)||ve===0)return ve;D=Math.min(D,ve)}else for(let ve=ee[0];ve<=ee[1];++ve){const Re=da(h[ve],d,v);if(D=Math.min(D,Re),D===0)return 0}}else{const ve=zo(ee,u);na(O,D,v,h,j,ve[0]),na(O,D,v,h,j,ve[1])}}return D}function Fn(h,u,d,v,P,D=1/0){let O=Math.min(D,P.distance(h[0],d[0]));if(O===0)return O;const j=new Qo([[0,[0,h.length-1],[0,d.length-1]]],Ta);for(;j.length>0;){const K=j.pop();if(K[0]>=O)continue;const ee=K[1],ce=K[2],ve=u?50:100,Re=v?50:100;if(gu(ee)<=ve&&gu(ce)<=Re){if(!Xs(ee,h.length)&&Xs(ce,d.length))return NaN;let Ue;if(u&&v)Ue=Bu(h,ee,d,ce,P),O=Math.min(O,Ue);else if(u&&!v){const qe=h.slice(ee[0],ee[1]+1);for(let st=ce[0];st<=ce[1];++st)if(Ue=mi(d[st],qe,P),O=Math.min(O,Ue),O===0)return O}else if(!u&&v){const qe=d.slice(ce[0],ce[1]+1);for(let st=ee[0];st<=ee[1];++st)if(Ue=mi(h[st],qe,P),O=Math.min(O,Ue),O===0)return O}else Ue=Nu(h,ee,d,ce,P),O=Math.min(O,Ue)}else{const Ue=zo(ee,u),qe=zo(ce,v);Ln(j,O,P,h,d,Ue[0],qe[0]),Ln(j,O,P,h,d,Ue[0],qe[1]),Ln(j,O,P,h,d,Ue[1],qe[0]),Ln(j,O,P,h,d,Ue[1],qe[1])}}return O}function Hr(h){return h.type==="MultiPolygon"?h.coordinates.map(u=>({type:"Polygon",coordinates:u})):h.type==="MultiLineString"?h.coordinates.map(u=>({type:"LineString",coordinates:u})):h.type==="MultiPoint"?h.coordinates.map(u=>({type:"Point",coordinates:u})):[h]}class ii{constructor(u,d){this.type=Ut,this.geojson=u,this.geometries=d}static parse(u,d){if(u.length!==2)return d.error(`'distance' expression requires exactly one argument, but found ${u.length-1} instead.`);if(Mi(u[1])){const v=u[1];if(v.type==="FeatureCollection")return new ii(v,v.features.map(P=>Hr(P.geometry)).flat());if(v.type==="Feature")return new ii(v,Hr(v.geometry));if("type"in v&&"coordinates"in v)return new ii(v,Hr(v))}return d.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(u){if(u.geometry()!=null&&u.canonicalID()!=null){if(u.geometryType()==="Point")return function(d,v){const P=d.geometry(),D=P.flat().map(K=>Bt([K.x,K.y],d.canonical));if(P.length===0)return NaN;const O=new ha(D[0][1]);let j=1/0;for(const K of v){switch(K.type){case"Point":j=Math.min(j,Fn(D,!1,[K.coordinates],!1,O,j));break;case"LineString":j=Math.min(j,Fn(D,!1,K.coordinates,!0,O,j));break;case"Polygon":j=Math.min(j,nr(D,!1,K.coordinates,O,j))}if(j===0)return j}return j}(u,this.geometries);if(u.geometryType()==="LineString")return function(d,v){const P=d.geometry(),D=P.flat().map(K=>Bt([K.x,K.y],d.canonical));if(P.length===0)return NaN;const O=new ha(D[0][1]);let j=1/0;for(const K of v){switch(K.type){case"Point":j=Math.min(j,Fn(D,!0,[K.coordinates],!1,O,j));break;case"LineString":j=Math.min(j,Fn(D,!0,K.coordinates,!0,O,j));break;case"Polygon":j=Math.min(j,nr(D,!0,K.coordinates,O,j))}if(j===0)return j}return j}(u,this.geometries);if(u.geometryType()==="Polygon")return function(d,v){const P=d.geometry();if(P.length===0||P[0].length===0)return NaN;const D=sl(P,0).map(K=>K.map(ee=>ee.map(ce=>Bt([ce.x,ce.y],d.canonical)))),O=new ha(D[0][0][0][1]);let j=1/0;for(const K of v)for(const ee of D){switch(K.type){case"Point":j=Math.min(j,nr([K.coordinates],!1,ee,O,j));break;case"LineString":j=Math.min(j,nr(K.coordinates,!0,ee,O,j));break;case"Polygon":j=Math.min(j,ol(ee,K.coordinates,O,j))}if(j===0)return j}return j}(u,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const xi={"==":Lc,"!=":Po,">":Du,"<":Fl,">=":Jo,"<=":Va,array:No,at:hc,boolean:No,case:Iu,coalesce:pu,collator:zl,format:ca,image:il,in:ua,"index-of":hu,interpolate:Fo,"interpolate-hcl":Fo,"interpolate-lab":Fo,length:uo,let:Fi,literal:Bl,match:du,number:No,"number-format":os,object:No,slice:fu,step:Ks,string:No,"to-boolean":qi,"to-color":qi,"to-number":qi,"to-string":qi,var:Oi,within:Ri,distance:ii};class as{constructor(u,d,v,P){this.name=u,this.type=d,this._evaluate=v,this.args=P}evaluate(u){return this._evaluate(u,this.args)}eachChild(u){this.args.forEach(u)}outputDefined(){return!1}static parse(u,d){const v=u[0],P=as.definitions[v];if(!P)return d.error(`Unknown expression "${v}". If you wanted a literal array, use ["literal", [...]].`,0);const D=Array.isArray(P)?P[0]:P.type,O=Array.isArray(P)?[[P[1],P[2]]]:P.overloads,j=O.filter(([ee])=>!Array.isArray(ee)||ee.length===u.length-1);let K=null;for(const[ee,ce]of j){K=new Nr(d.registry,al,d.path,null,d.scope);const ve=[];let Re=!1;for(let Ue=1;Ue<u.length;Ue++){const qe=u[Ue],st=Array.isArray(ee)?ee[Ue-1]:ee.type,xt=K.parse(qe,1+ve.length,st);if(!xt){Re=!0;break}ve.push(xt)}if(!Re)if(Array.isArray(ee)&&ee.length!==ve.length)K.error(`Expected ${ee.length} arguments, but found ${ve.length} instead.`);else{for(let Ue=0;Ue<ve.length;Ue++){const qe=Array.isArray(ee)?ee[Ue]:ee.type,st=ve[Ue];K.concat(Ue+1).checkSubtype(qe,st.type)}if(K.errors.length===0)return new as(v,D,ce,ve)}}if(j.length===1)d.errors.push(...K.errors);else{const ee=(j.length?j:O).map(([ve])=>{return Re=ve,Array.isArray(Re)?`(${Re.map(ns).join(", ")})`:`(${ns(Re.type)}...)`;var Re}).join(" | "),ce=[];for(let ve=1;ve<u.length;ve++){const Re=d.parse(u[ve],1+ce.length);if(!Re)return null;ce.push(ns(Re.type))}d.error(`Expected arguments of type ${ee}, but found (${ce.join(", ")}) instead.`)}return null}static register(u,d){as.definitions=d;for(const v in d)u[v]=as}}function Cs(h,[u,d,v,P]){u=u.evaluate(h),d=d.evaluate(h),v=v.evaluate(h);const D=P?P.evaluate(h):1,O=yi(u,d,v,D);if(O)throw new Ms(O);return new ui(u/255,d/255,v/255,D,!1)}function dc(h,u){return h in u}function ra(h,u){const d=u[h];return d===void 0?null:d}function Ts(h){return{type:h}}function al(h){if(h instanceof Oi)return al(h.boundExpression);if(h instanceof as&&h.name==="error"||h instanceof zl||h instanceof Ri||h instanceof ii)return!1;const u=h instanceof qi||h instanceof No;let d=!0;return h.eachChild(v=>{d=u?d&&al(v):d&&v instanceof Bl}),!!d&&bl(h)&&ll(h,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function bl(h){if(h instanceof as&&(h.name==="get"&&h.args.length===1||h.name==="feature-state"||h.name==="has"&&h.args.length===1||h.name==="properties"||h.name==="geometry-type"||h.name==="id"||/^filter-/.test(h.name))||h instanceof Ri||h instanceof ii)return!1;let u=!0;return h.eachChild(d=>{u&&!bl(d)&&(u=!1)}),u}function Ga(h){if(h instanceof as&&h.name==="feature-state")return!1;let u=!0;return h.eachChild(d=>{u&&!Ga(d)&&(u=!1)}),u}function ll(h,u){if(h instanceof as&&u.indexOf(h.name)>=0)return!1;let d=!0;return h.eachChild(v=>{d&&!ll(v,u)&&(d=!1)}),d}function Vl(h){return{result:"success",value:h}}function Ui(h){return{result:"error",value:h}}function fa(h){return h["property-type"]==="data-driven"||h["property-type"]==="cross-faded-data-driven"}function Uo(h){return!!h.expression&&h.expression.parameters.indexOf("zoom")>-1}function bs(h){return!!h.expression&&h.expression.interpolated}function oi(h){return h instanceof Number?"number":h instanceof String?"string":h instanceof Boolean?"boolean":Array.isArray(h)?"array":h===null?"null":typeof h}function io(h){return typeof h=="object"&&h!==null&&!Array.isArray(h)}function Us(h){return h}function pa(h,u){const d=u.type==="color",v=h.stops&&typeof h.stops[0][0]=="object",P=v||!(v||h.property!==void 0),D=h.type||(bs(u)?"exponential":"interval");if(d||u.type==="padding"){const ce=d?ui.parse:Zs.parse;(h=br({},h)).stops&&(h.stops=h.stops.map(ve=>[ve[0],ce(ve[1])])),h.default=ce(h.default?h.default:u.default)}if(h.colorSpace&&(O=h.colorSpace)!=="rgb"&&O!=="hcl"&&O!=="lab")throw new Error(`Unknown color space: "${h.colorSpace}"`);var O;let j,K,ee;if(D==="exponential")j=wl;else if(D==="interval")j=ah;else if(D==="categorical"){j=xl,K=Object.create(null);for(const ce of h.stops)K[ce[0]]=ce[1];ee=typeof h.stops[0][0]}else{if(D!=="identity")throw new Error(`Unknown function type "${D}"`);j=To}if(v){const ce={},ve=[];for(let qe=0;qe<h.stops.length;qe++){const st=h.stops[qe],xt=st[0].zoom;ce[xt]===void 0&&(ce[xt]={zoom:xt,type:h.type,property:h.property,default:h.default,stops:[]},ve.push(xt)),ce[xt].stops.push([st[0].value,st[1]])}const Re=[];for(const qe of ve)Re.push([ce[qe].zoom,pa(ce[qe],u)]);const Ue={name:"linear"};return{kind:"composite",interpolationType:Ue,interpolationFactor:Fo.interpolationFactor.bind(void 0,Ue),zoomStops:Re.map(qe=>qe[0]),evaluate:({zoom:qe},st)=>wl({stops:Re,base:h.base},u,qe).evaluate(qe,st)}}if(P){const ce=D==="exponential"?{name:"exponential",base:h.base!==void 0?h.base:1}:null;return{kind:"camera",interpolationType:ce,interpolationFactor:Fo.interpolationFactor.bind(void 0,ce),zoomStops:h.stops.map(ve=>ve[0]),evaluate:({zoom:ve})=>j(h,u,ve,K,ee)}}return{kind:"source",evaluate(ce,ve){const Re=ve&&ve.properties?ve.properties[h.property]:void 0;return Re===void 0?Vo(h.default,u.default):j(h,u,Re,K,ee)}}}function Vo(h,u,d){return h!==void 0?h:u!==void 0?u:d!==void 0?d:void 0}function xl(h,u,d,v,P){return Vo(typeof d===P?v[d]:void 0,h.default,u.default)}function ah(h,u,d){if(oi(d)!=="number")return Vo(h.default,u.default);const v=h.stops.length;if(v===1||d<=h.stops[0][0])return h.stops[0][1];if(d>=h.stops[v-1][0])return h.stops[v-1][1];const P=Hi(h.stops.map(D=>D[0]),d);return h.stops[P][1]}function wl(h,u,d){const v=h.base!==void 0?h.base:1;if(oi(d)!=="number")return Vo(h.default,u.default);const P=h.stops.length;if(P===1||d<=h.stops[0][0])return h.stops[0][1];if(d>=h.stops[P-1][0])return h.stops[P-1][1];const D=Hi(h.stops.map(ce=>ce[0]),d),O=function(ce,ve,Re,Ue){const qe=Ue-Re,st=ce-Re;return qe===0?0:ve===1?st/qe:(Math.pow(ve,st)-1)/(Math.pow(ve,qe)-1)}(d,v,h.stops[D][0],h.stops[D+1][0]),j=h.stops[D][1],K=h.stops[D+1][1],ee=vs[u.type]||Us;return typeof j.evaluate=="function"?{evaluate(...ce){const ve=j.evaluate.apply(void 0,ce),Re=K.evaluate.apply(void 0,ce);if(ve!==void 0&&Re!==void 0)return ee(ve,Re,O,h.colorSpace)}}:ee(j,K,O,h.colorSpace)}function To(h,u,d){switch(u.type){case"color":d=ui.parse(d);break;case"formatted":d=Ws.fromString(d.toString());break;case"resolvedImage":d=La.fromString(d.toString());break;case"padding":d=Zs.parse(d);break;default:oi(d)===u.type||u.type==="enum"&&u.values[d]||(d=void 0)}return Vo(d,h.default,u.default)}as.register(xi,{error:[{kind:"error"},[Hn],(h,[u])=>{throw new Ms(u.evaluate(h))}],typeof:[Hn,[Pr],(h,[u])=>ns(fs(u.evaluate(h)))],"to-rgba":[Yi(Ut,4),[Xr],(h,[u])=>{const[d,v,P,D]=u.evaluate(h).rgb;return[255*d,255*v,255*P,D]}],rgb:[Xr,[Ut,Ut,Ut],Cs],rgba:[Xr,[Ut,Ut,Ut,Ut],Cs],has:{type:or,overloads:[[[Hn],(h,[u])=>dc(u.evaluate(h),h.properties())],[[Hn,ai],(h,[u,d])=>dc(u.evaluate(h),d.evaluate(h))]]},get:{type:Pr,overloads:[[[Hn],(h,[u])=>ra(u.evaluate(h),h.properties())],[[Hn,ai],(h,[u,d])=>ra(u.evaluate(h),d.evaluate(h))]]},"feature-state":[Pr,[Hn],(h,[u])=>ra(u.evaluate(h),h.featureState||{})],properties:[ai,[],h=>h.properties()],"geometry-type":[Hn,[],h=>h.geometryType()],id:[Pr,[],h=>h.id()],zoom:[Ut,[],h=>h.globals.zoom],"heatmap-density":[Ut,[],h=>h.globals.heatmapDensity||0],"line-progress":[Ut,[],h=>h.globals.lineProgress||0],accumulated:[Pr,[],h=>h.globals.accumulated===void 0?null:h.globals.accumulated],"+":[Ut,Ts(Ut),(h,u)=>{let d=0;for(const v of u)d+=v.evaluate(h);return d}],"*":[Ut,Ts(Ut),(h,u)=>{let d=1;for(const v of u)d*=v.evaluate(h);return d}],"-":{type:Ut,overloads:[[[Ut,Ut],(h,[u,d])=>u.evaluate(h)-d.evaluate(h)],[[Ut],(h,[u])=>-u.evaluate(h)]]},"/":[Ut,[Ut,Ut],(h,[u,d])=>u.evaluate(h)/d.evaluate(h)],"%":[Ut,[Ut,Ut],(h,[u,d])=>u.evaluate(h)%d.evaluate(h)],ln2:[Ut,[],()=>Math.LN2],pi:[Ut,[],()=>Math.PI],e:[Ut,[],()=>Math.E],"^":[Ut,[Ut,Ut],(h,[u,d])=>Math.pow(u.evaluate(h),d.evaluate(h))],sqrt:[Ut,[Ut],(h,[u])=>Math.sqrt(u.evaluate(h))],log10:[Ut,[Ut],(h,[u])=>Math.log(u.evaluate(h))/Math.LN10],ln:[Ut,[Ut],(h,[u])=>Math.log(u.evaluate(h))],log2:[Ut,[Ut],(h,[u])=>Math.log(u.evaluate(h))/Math.LN2],sin:[Ut,[Ut],(h,[u])=>Math.sin(u.evaluate(h))],cos:[Ut,[Ut],(h,[u])=>Math.cos(u.evaluate(h))],tan:[Ut,[Ut],(h,[u])=>Math.tan(u.evaluate(h))],asin:[Ut,[Ut],(h,[u])=>Math.asin(u.evaluate(h))],acos:[Ut,[Ut],(h,[u])=>Math.acos(u.evaluate(h))],atan:[Ut,[Ut],(h,[u])=>Math.atan(u.evaluate(h))],min:[Ut,Ts(Ut),(h,u)=>Math.min(...u.map(d=>d.evaluate(h)))],max:[Ut,Ts(Ut),(h,u)=>Math.max(...u.map(d=>d.evaluate(h)))],abs:[Ut,[Ut],(h,[u])=>Math.abs(u.evaluate(h))],round:[Ut,[Ut],(h,[u])=>{const d=u.evaluate(h);return d<0?-Math.round(-d):Math.round(d)}],floor:[Ut,[Ut],(h,[u])=>Math.floor(u.evaluate(h))],ceil:[Ut,[Ut],(h,[u])=>Math.ceil(u.evaluate(h))],"filter-==":[or,[Hn,Pr],(h,[u,d])=>h.properties()[u.value]===d.value],"filter-id-==":[or,[Pr],(h,[u])=>h.id()===u.value],"filter-type-==":[or,[Hn],(h,[u])=>h.geometryType()===u.value],"filter-<":[or,[Hn,Pr],(h,[u,d])=>{const v=h.properties()[u.value],P=d.value;return typeof v==typeof P&&v<P}],"filter-id-<":[or,[Pr],(h,[u])=>{const d=h.id(),v=u.value;return typeof d==typeof v&&d<v}],"filter->":[or,[Hn,Pr],(h,[u,d])=>{const v=h.properties()[u.value],P=d.value;return typeof v==typeof P&&v>P}],"filter-id->":[or,[Pr],(h,[u])=>{const d=h.id(),v=u.value;return typeof d==typeof v&&d>v}],"filter-<=":[or,[Hn,Pr],(h,[u,d])=>{const v=h.properties()[u.value],P=d.value;return typeof v==typeof P&&v<=P}],"filter-id-<=":[or,[Pr],(h,[u])=>{const d=h.id(),v=u.value;return typeof d==typeof v&&d<=v}],"filter->=":[or,[Hn,Pr],(h,[u,d])=>{const v=h.properties()[u.value],P=d.value;return typeof v==typeof P&&v>=P}],"filter-id->=":[or,[Pr],(h,[u])=>{const d=h.id(),v=u.value;return typeof d==typeof v&&d>=v}],"filter-has":[or,[Pr],(h,[u])=>u.value in h.properties()],"filter-has-id":[or,[],h=>h.id()!==null&&h.id()!==void 0],"filter-type-in":[or,[Yi(Hn)],(h,[u])=>u.value.indexOf(h.geometryType())>=0],"filter-id-in":[or,[Yi(Pr)],(h,[u])=>u.value.indexOf(h.id())>=0],"filter-in-small":[or,[Hn,Yi(Pr)],(h,[u,d])=>d.value.indexOf(h.properties()[u.value])>=0],"filter-in-large":[or,[Hn,Yi(Pr)],(h,[u,d])=>function(v,P,D,O){for(;D<=O;){const j=D+O>>1;if(P[j]===v)return!0;P[j]>v?O=j-1:D=j+1}return!1}(h.properties()[u.value],d.value,0,d.value.length-1)],all:{type:or,overloads:[[[or,or],(h,[u,d])=>u.evaluate(h)&&d.evaluate(h)],[Ts(or),(h,u)=>{for(const d of u)if(!d.evaluate(h))return!1;return!0}]]},any:{type:or,overloads:[[[or,or],(h,[u,d])=>u.evaluate(h)||d.evaluate(h)],[Ts(or),(h,u)=>{for(const d of u)if(d.evaluate(h))return!0;return!1}]]},"!":[or,[or],(h,[u])=>!u.evaluate(h)],"is-supported-script":[or,[Hn],(h,[u])=>{const d=h.globals&&h.globals.isSupportedScript;return!d||d(u.evaluate(h))}],upcase:[Hn,[Hn],(h,[u])=>u.evaluate(h).toUpperCase()],downcase:[Hn,[Hn],(h,[u])=>u.evaluate(h).toLowerCase()],concat:[Hn,Ts(Pr),(h,u)=>u.map(d=>Bi(d.evaluate(h))).join("")],"resolved-locale":[Hn,[As],(h,[u])=>u.evaluate(h).resolvedLocale()]});class ks{constructor(u,d){var v;this.expression=u,this._warningHistory={},this._evaluator=new Gi,this._defaultValue=d?(v=d).type==="color"&&io(v.default)?new ui(0,0,0,0):v.type==="color"?ui.parse(v.default)||null:v.type==="padding"?Zs.parse(v.default)||null:v.type==="variableAnchorOffsetCollection"?us.parse(v.default)||null:v.type==="projectionDefinition"?Lo.parse(v.default)||null:v.default===void 0?null:v.default:null,this._enumValues=d&&d.type==="enum"?d.values:null}evaluateWithoutErrorHandling(u,d,v,P,D,O){return this._evaluator.globals=u,this._evaluator.feature=d,this._evaluator.featureState=v,this._evaluator.canonical=P,this._evaluator.availableImages=D||null,this._evaluator.formattedSection=O,this.expression.evaluate(this._evaluator)}evaluate(u,d,v,P,D,O){this._evaluator.globals=u,this._evaluator.feature=d||null,this._evaluator.featureState=v||null,this._evaluator.canonical=P,this._evaluator.availableImages=D||null,this._evaluator.formattedSection=O||null;try{const j=this.expression.evaluate(this._evaluator);if(j==null||typeof j=="number"&&j!=j)return this._defaultValue;if(this._enumValues&&!(j in this._enumValues))throw new Ms(`Expected value to be one of ${Object.keys(this._enumValues).map(K=>JSON.stringify(K)).join(", ")}, but found ${JSON.stringify(j)} instead.`);return j}catch(j){return this._warningHistory[j.message]||(this._warningHistory[j.message]=!0,typeof console<"u"&&console.warn(j.message)),this._defaultValue}}}function ho(h){return Array.isArray(h)&&h.length>0&&typeof h[0]=="string"&&h[0]in xi}function $o(h,u){const d=new Nr(xi,al,[],u?function(P){const D={color:Xr,string:Hn,number:Ut,enum:Hn,boolean:or,formatted:$i,padding:Qa,projectionDefinition:ri,resolvedImage:pi,variableAnchorOffsetCollection:Li};return P.type==="array"?Yi(D[P.value]||Pr,P.length):D[P.type]}(u):void 0),v=d.parse(h,void 0,void 0,void 0,u&&u.type==="string"?{typeAnnotation:"coerce"}:void 0);return v?Vl(new ks(v,u)):Ui(d.errors)}class vi{constructor(u,d){this.kind=u,this._styleExpression=d,this.isStateDependent=u!=="constant"&&!Ga(d.expression)}evaluateWithoutErrorHandling(u,d,v,P,D,O){return this._styleExpression.evaluateWithoutErrorHandling(u,d,v,P,D,O)}evaluate(u,d,v,P,D,O){return this._styleExpression.evaluate(u,d,v,P,D,O)}}class $l{constructor(u,d,v,P){this.kind=u,this.zoomStops=v,this._styleExpression=d,this.isStateDependent=u!=="camera"&&!Ga(d.expression),this.interpolationType=P}evaluateWithoutErrorHandling(u,d,v,P,D,O){return this._styleExpression.evaluateWithoutErrorHandling(u,d,v,P,D,O)}evaluate(u,d,v,P,D,O){return this._styleExpression.evaluate(u,d,v,P,D,O)}interpolationFactor(u,d,v){return this.interpolationType?Fo.interpolationFactor(this.interpolationType,u,d,v):0}}function yu(h,u){const d=$o(h,u);if(d.result==="error")return d;const v=d.value.expression,P=bl(v);if(!P&&!fa(u))return Ui([new vr("","data expressions not supported")]);const D=ll(v,["zoom"]);if(!D&&!Uo(u))return Ui([new vr("","zoom expressions not supported")]);const O=Go(v);return O||D?O instanceof vr?Ui([O]):O instanceof Fo&&!bs(u)?Ui([new vr("",'"interpolate" expressions cannot be used with this property')]):Vl(O?new $l(P?"camera":"composite",d.value,O.labels,O instanceof Fo?O.interpolation:void 0):new vi(P?"constant":"source",d.value)):Ui([new vr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ha{constructor(u,d){this._parameters=u,this._specification=d,br(this,pa(this._parameters,this._specification))}static deserialize(u){return new Ha(u._parameters,u._specification)}static serialize(u){return{_parameters:u._parameters,_specification:u._specification}}}function Go(h){let u=null;if(h instanceof Fi)u=Go(h.result);else if(h instanceof pu){for(const d of h.args)if(u=Go(d),u)break}else(h instanceof Ks||h instanceof Fo)&&h.input instanceof as&&h.input.name==="zoom"&&(u=h);return u instanceof vr||h.eachChild(d=>{const v=Go(d);v instanceof vr?u=v:!u&&v?u=new vr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):u&&v&&u!==v&&(u=new vr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),u}function Uc(h){if(h===!0||h===!1)return!0;if(!Array.isArray(h)||h.length===0)return!1;switch(h[0]){case"has":return h.length>=2&&h[1]!=="$id"&&h[1]!=="$type";case"in":return h.length>=3&&(typeof h[1]!="string"||Array.isArray(h[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return h.length!==3||Array.isArray(h[1])||Array.isArray(h[2]);case"any":case"all":for(const u of h.slice(1))if(!Uc(u)&&typeof u!="boolean")return!1;return!0;default:return!0}}const Ho={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ao(h){if(h==null)return{filter:()=>!0,needGeometry:!1};Uc(h)||(h=T(h));const u=$o(h,Ho);if(u.result==="error")throw new Error(u.value.map(d=>`${d.key}: ${d.message}`).join(", "));return{filter:(d,v,P)=>u.value.evaluate(d,v,{},P),needGeometry:p(h)}}function Gl(h,u){return h<u?-1:h>u?1:0}function p(h){if(!Array.isArray(h))return!1;if(h[0]==="within"||h[0]==="distance")return!0;for(let u=1;u<h.length;u++)if(p(h[u]))return!0;return!1}function T(h){if(!h)return!0;const u=h[0];return h.length<=1?u!=="any":u==="=="?U(h[1],h[2],"=="):u==="!="?nt(U(h[1],h[2],"==")):u==="<"||u===">"||u==="<="||u===">="?U(h[1],h[2],u):u==="any"?(d=h.slice(1),["any"].concat(d.map(T))):u==="all"?["all"].concat(h.slice(1).map(T)):u==="none"?["all"].concat(h.slice(1).map(T).map(nt)):u==="in"?se(h[1],h.slice(2)):u==="!in"?nt(se(h[1],h.slice(2))):u==="has"?Pe(h[1]):u!=="!has"||nt(Pe(h[1]));var d}function U(h,u,d){switch(h){case"$type":return[`filter-type-${d}`,u];case"$id":return[`filter-id-${d}`,u];default:return[`filter-${d}`,h,u]}}function se(h,u){if(u.length===0)return!1;switch(h){case"$type":return["filter-type-in",["literal",u]];case"$id":return["filter-id-in",["literal",u]];default:return u.length>200&&!u.some(d=>typeof d!=typeof u[0])?["filter-in-large",h,["literal",u.sort(Gl)]]:["filter-in-small",h,["literal",u]]}}function Pe(h){switch(h){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",h]}}function nt(h){return["!",h]}function Jt(h){const u=typeof h;if(u==="number"||u==="boolean"||u==="string"||h==null)return JSON.stringify(h);if(Array.isArray(h)){let P="[";for(const D of h)P+=`${Jt(D)},`;return`${P}]`}const d=Object.keys(h).sort();let v="{";for(let P=0;P<d.length;P++)v+=`${JSON.stringify(d[P])}:${Jt(h[d[P]])},`;return`${v}}`}function Dn(h){let u="";for(const d of Gt)u+=`/${Jt(h[d])}`;return u}function Jn(h){const u=h.value;return u?[new bn(h.key,u,"constants have been deprecated as of v8")]:[]}function ar(h){return h instanceof Number||h instanceof String||h instanceof Boolean?h.valueOf():h}function Vr(h){if(Array.isArray(h))return h.map(Vr);if(h instanceof Object&&!(h instanceof Number||h instanceof String||h instanceof Boolean)){const u={};for(const d in h)u[d]=Vr(h[d]);return u}return ar(h)}function Jr(h){const u=h.key,d=h.value,v=h.valueSpec||{},P=h.objectElementValidators||{},D=h.style,O=h.styleSpec,j=h.validateSpec;let K=[];const ee=oi(d);if(ee!=="object")return[new bn(u,d,`object expected, ${ee} found`)];for(const ce in d){const ve=ce.split(".")[0],Re=v[ve]||v["*"];let Ue;if(P[ve])Ue=P[ve];else if(v[ve])Ue=j;else if(P["*"])Ue=P["*"];else{if(!v["*"]){K.push(new bn(u,d[ce],`unknown property "${ce}"`));continue}Ue=j}K=K.concat(Ue({key:(u&&`${u}.`)+ce,value:d[ce],valueSpec:Re,style:D,styleSpec:O,object:d,objectKey:ce,validateSpec:j},d))}for(const ce in v)P[ce]||v[ce].required&&v[ce].default===void 0&&d[ce]===void 0&&K.push(new bn(u,d,`missing required property "${ce}"`));return K}function Vi(h){const u=h.value,d=h.valueSpec,v=h.style,P=h.styleSpec,D=h.key,O=h.arrayElementValidator||h.validateSpec;if(oi(u)!=="array")return[new bn(D,u,`array expected, ${oi(u)} found`)];if(d.length&&u.length!==d.length)return[new bn(D,u,`array length ${d.length} expected, length ${u.length} found`)];if(d["min-length"]&&u.length<d["min-length"])return[new bn(D,u,`array length at least ${d["min-length"]} expected, length ${u.length} found`)];let j={type:d.value,values:d.values};P.$version<7&&(j.function=d.function),oi(d.value)==="object"&&(j=d.value);let K=[];for(let ee=0;ee<u.length;ee++)K=K.concat(O({array:u,arrayIndex:ee,value:u[ee],valueSpec:j,validateSpec:h.validateSpec,style:v,styleSpec:P,key:`${D}[${ee}]`}));return K}function vo(h){const u=h.key,d=h.value,v=h.valueSpec;let P=oi(d);return P==="number"&&d!=d&&(P="NaN"),P!=="number"?[new bn(u,d,`number expected, ${P} found`)]:"minimum"in v&&d<v.minimum?[new bn(u,d,`${d} is less than the minimum value ${v.minimum}`)]:"maximum"in v&&d>v.maximum?[new bn(u,d,`${d} is greater than the maximum value ${v.maximum}`)]:[]}function Js(h){const u=h.valueSpec,d=ar(h.value.type);let v,P,D,O={};const j=d!=="categorical"&&h.value.property===void 0,K=!j,ee=oi(h.value.stops)==="array"&&oi(h.value.stops[0])==="array"&&oi(h.value.stops[0][0])==="object",ce=Jr({key:h.key,value:h.value,valueSpec:h.styleSpec.function,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{stops:function(Ue){if(d==="identity")return[new bn(Ue.key,Ue.value,'identity function may not have a "stops" property')];let qe=[];const st=Ue.value;return qe=qe.concat(Vi({key:Ue.key,value:st,valueSpec:Ue.valueSpec,validateSpec:Ue.validateSpec,style:Ue.style,styleSpec:Ue.styleSpec,arrayElementValidator:ve})),oi(st)==="array"&&st.length===0&&qe.push(new bn(Ue.key,st,"array must have at least one stop")),qe},default:function(Ue){return Ue.validateSpec({key:Ue.key,value:Ue.value,valueSpec:u,validateSpec:Ue.validateSpec,style:Ue.style,styleSpec:Ue.styleSpec})}}});return d==="identity"&&j&&ce.push(new bn(h.key,h.value,'missing required property "property"')),d==="identity"||h.value.stops||ce.push(new bn(h.key,h.value,'missing required property "stops"')),d==="exponential"&&h.valueSpec.expression&&!bs(h.valueSpec)&&ce.push(new bn(h.key,h.value,"exponential functions not supported")),h.styleSpec.$version>=8&&(K&&!fa(h.valueSpec)?ce.push(new bn(h.key,h.value,"property functions not supported")):j&&!Uo(h.valueSpec)&&ce.push(new bn(h.key,h.value,"zoom functions not supported"))),d!=="categorical"&&!ee||h.value.property!==void 0||ce.push(new bn(h.key,h.value,'"property" property is required')),ce;function ve(Ue){let qe=[];const st=Ue.value,xt=Ue.key;if(oi(st)!=="array")return[new bn(xt,st,`array expected, ${oi(st)} found`)];if(st.length!==2)return[new bn(xt,st,`array length 2 expected, length ${st.length} found`)];if(ee){if(oi(st[0])!=="object")return[new bn(xt,st,`object expected, ${oi(st[0])} found`)];if(st[0].zoom===void 0)return[new bn(xt,st,"object stop key must have zoom")];if(st[0].value===void 0)return[new bn(xt,st,"object stop key must have value")];if(D&&D>ar(st[0].zoom))return[new bn(xt,st[0].zoom,"stop zoom values must appear in ascending order")];ar(st[0].zoom)!==D&&(D=ar(st[0].zoom),P=void 0,O={}),qe=qe.concat(Jr({key:`${xt}[0]`,value:st[0],valueSpec:{zoom:{}},validateSpec:Ue.validateSpec,style:Ue.style,styleSpec:Ue.styleSpec,objectElementValidators:{zoom:vo,value:Re}}))}else qe=qe.concat(Re({key:`${xt}[0]`,value:st[0],validateSpec:Ue.validateSpec,style:Ue.style,styleSpec:Ue.styleSpec},st));return ho(Vr(st[1]))?qe.concat([new bn(`${xt}[1]`,st[1],"expressions are not allowed in function stops.")]):qe.concat(Ue.validateSpec({key:`${xt}[1]`,value:st[1],valueSpec:u,validateSpec:Ue.validateSpec,style:Ue.style,styleSpec:Ue.styleSpec}))}function Re(Ue,qe){const st=oi(Ue.value),xt=ar(Ue.value),It=Ue.value!==null?Ue.value:qe;if(v){if(st!==v)return[new bn(Ue.key,It,`${st} stop domain type must match previous stop domain type ${v}`)]}else v=st;if(st!=="number"&&st!=="string"&&st!=="boolean")return[new bn(Ue.key,It,"stop domain value must be a number, string, or boolean")];if(st!=="number"&&d!=="categorical"){let fn=`number expected, ${st} found`;return fa(u)&&d===void 0&&(fn+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new bn(Ue.key,It,fn)]}return d!=="categorical"||st!=="number"||isFinite(xt)&&Math.floor(xt)===xt?d!=="categorical"&&st==="number"&&P!==void 0&&xt<P?[new bn(Ue.key,It,"stop domain values must appear in ascending order")]:(P=xt,d==="categorical"&&xt in O?[new bn(Ue.key,It,"stop domain values must be unique")]:(O[xt]=!0,[])):[new bn(Ue.key,It,`integer expected, found ${xt}`)]}}function so(h){const u=(h.expressionContext==="property"?yu:$o)(Vr(h.value),h.valueSpec);if(u.result==="error")return u.value.map(v=>new bn(`${h.key}${v.key}`,h.value,v.message));const d=u.value.expression||u.value._styleExpression.expression;if(h.expressionContext==="property"&&h.propertyKey==="text-font"&&!d.outputDefined())return[new bn(h.key,h.value,`Invalid data expression for "${h.propertyKey}". Output values must be contained as literals within the expression.`)];if(h.expressionContext==="property"&&h.propertyType==="layout"&&!Ga(d))return[new bn(h.key,h.value,'"feature-state" data expressions are not supported with layout properties.')];if(h.expressionContext==="filter"&&!Ga(d))return[new bn(h.key,h.value,'"feature-state" data expressions are not supported with filters.')];if(h.expressionContext&&h.expressionContext.indexOf("cluster")===0){if(!ll(d,["zoom","feature-state"]))return[new bn(h.key,h.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(h.expressionContext==="cluster-initial"&&!bl(d))return[new bn(h.key,h.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ss(h){const u=h.key,d=h.value,v=h.valueSpec,P=[];return Array.isArray(v.values)?v.values.indexOf(ar(d))===-1&&P.push(new bn(u,d,`expected one of [${v.values.join(", ")}], ${JSON.stringify(d)} found`)):Object.keys(v.values).indexOf(ar(d))===-1&&P.push(new bn(u,d,`expected one of [${Object.keys(v.values).join(", ")}], ${JSON.stringify(d)} found`)),P}function ma(h){return Uc(Vr(h.value))?so(br({},h,{expressionContext:"filter",valueSpec:{value:"boolean"}})):lh(h)}function lh(h){const u=h.value,d=h.key;if(oi(u)!=="array")return[new bn(d,u,`array expected, ${oi(u)} found`)];const v=h.styleSpec;let P,D=[];if(u.length<1)return[new bn(d,u,"filter array must have at least 1 element")];switch(D=D.concat(Ss({key:`${d}[0]`,value:u[0],valueSpec:v.filter_operator,style:h.style,styleSpec:h.styleSpec})),ar(u[0])){case"<":case"<=":case">":case">=":u.length>=2&&ar(u[1])==="$type"&&D.push(new bn(d,u,`"$type" cannot be use with operator "${u[0]}"`));case"==":case"!=":u.length!==3&&D.push(new bn(d,u,`filter array for operator "${u[0]}" must have 3 elements`));case"in":case"!in":u.length>=2&&(P=oi(u[1]),P!=="string"&&D.push(new bn(`${d}[1]`,u[1],`string expected, ${P} found`)));for(let O=2;O<u.length;O++)P=oi(u[O]),ar(u[1])==="$type"?D=D.concat(Ss({key:`${d}[${O}]`,value:u[O],valueSpec:v.geometry_type,style:h.style,styleSpec:h.styleSpec})):P!=="string"&&P!=="number"&&P!=="boolean"&&D.push(new bn(`${d}[${O}]`,u[O],`string, number, or boolean expected, ${P} found`));break;case"any":case"all":case"none":for(let O=1;O<u.length;O++)D=D.concat(lh({key:`${d}[${O}]`,value:u[O],style:h.style,styleSpec:h.styleSpec}));break;case"has":case"!has":P=oi(u[1]),u.length!==2?D.push(new bn(d,u,`filter array for "${u[0]}" operator must have 2 elements`)):P!=="string"&&D.push(new bn(`${d}[1]`,u[1],`string expected, ${P} found`))}return D}function Cl(h,u){const d=h.key,v=h.validateSpec,P=h.style,D=h.styleSpec,O=h.value,j=h.objectKey,K=D[`${u}_${h.layerType}`];if(!K)return[];const ee=j.match(/^(.*)-transition$/);if(u==="paint"&&ee&&K[ee[1]]&&K[ee[1]].transition)return v({key:d,value:O,valueSpec:D.transition,style:P,styleSpec:D});const ce=h.valueSpec||K[j];if(!ce)return[new bn(d,O,`unknown property "${j}"`)];let ve;if(oi(O)==="string"&&fa(ce)&&!ce.tokens&&(ve=/^{([^}]+)}$/.exec(O)))return[new bn(d,O,`"${j}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(ve[1])} }\`.`)];const Re=[];return h.layerType==="symbol"&&(j==="text-field"&&P&&!P.glyphs&&Re.push(new bn(d,O,'use of "text-field" requires a style "glyphs" property')),j==="text-font"&&io(Vr(O))&&ar(O.type)==="identity"&&Re.push(new bn(d,O,'"text-font" does not support identity functions'))),Re.concat(v({key:h.key,value:O,valueSpec:ce,style:P,styleSpec:D,expressionContext:"property",propertyType:u,propertyKey:j}))}function Sl(h){return Cl(h,"paint")}function qa(h){return Cl(h,"layout")}function Xh(h){let u=[];const d=h.value,v=h.key,P=h.style,D=h.styleSpec;d.type||d.ref||u.push(new bn(v,d,'either "type" or "ref" is required'));let O=ar(d.type);const j=ar(d.ref);if(d.id){const K=ar(d.id);for(let ee=0;ee<h.arrayIndex;ee++){const ce=P.layers[ee];ar(ce.id)===K&&u.push(new bn(v,d.id,`duplicate layer id "${d.id}", previously used at line ${ce.id.__line__}`))}}if("ref"in d){let K;["type","source","source-layer","filter","layout"].forEach(ee=>{ee in d&&u.push(new bn(v,d[ee],`"${ee}" is prohibited for ref layers`))}),P.layers.forEach(ee=>{ar(ee.id)===j&&(K=ee)}),K?K.ref?u.push(new bn(v,d.ref,"ref cannot reference another ref layer")):O=ar(K.type):u.push(new bn(v,d.ref,`ref layer "${j}" not found`))}else if(O!=="background")if(d.source){const K=P.sources&&P.sources[d.source],ee=K&&ar(K.type);K?ee==="vector"&&O==="raster"?u.push(new bn(v,d.source,`layer "${d.id}" requires a raster source`)):ee!=="raster-dem"&&O==="hillshade"?u.push(new bn(v,d.source,`layer "${d.id}" requires a raster-dem source`)):ee==="raster"&&O!=="raster"?u.push(new bn(v,d.source,`layer "${d.id}" requires a vector source`)):ee!=="vector"||d["source-layer"]?ee==="raster-dem"&&O!=="hillshade"?u.push(new bn(v,d.source,"raster-dem source can only be used with layer type 'hillshade'.")):O!=="line"||!d.paint||!d.paint["line-gradient"]||ee==="geojson"&&K.lineMetrics||u.push(new bn(v,d,`layer "${d.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):u.push(new bn(v,d,`layer "${d.id}" must specify a "source-layer"`)):u.push(new bn(v,d.source,`source "${d.source}" not found`))}else u.push(new bn(v,d,'missing required property "source"'));return u=u.concat(Jr({key:v,value:d,valueSpec:D.layer,style:h.style,styleSpec:h.styleSpec,validateSpec:h.validateSpec,objectElementValidators:{"*":()=>[],type:()=>h.validateSpec({key:`${v}.type`,value:d.type,valueSpec:D.layer.type,style:h.style,styleSpec:h.styleSpec,validateSpec:h.validateSpec,object:d,objectKey:"type"}),filter:ma,layout:K=>Jr({layer:d,key:K.key,value:K.value,style:K.style,styleSpec:K.styleSpec,validateSpec:K.validateSpec,objectElementValidators:{"*":ee=>qa(br({layerType:O},ee))}}),paint:K=>Jr({layer:d,key:K.key,value:K.value,style:K.style,styleSpec:K.styleSpec,validateSpec:K.validateSpec,objectElementValidators:{"*":ee=>Sl(br({layerType:O},ee))}})}})),u}function Aa(h){const u=h.value,d=h.key,v=oi(u);return v!=="string"?[new bn(d,u,`string expected, ${v} found`)]:[]}const xs={promoteId:function({key:h,value:u}){if(oi(u)==="string")return Aa({key:h,value:u});{const d=[];for(const v in u)d.push(...Aa({key:`${h}.${v}`,value:u[v]}));return d}}};function ia(h){const u=h.value,d=h.key,v=h.styleSpec,P=h.style,D=h.validateSpec;if(!u.type)return[new bn(d,u,'"type" is required')];const O=ar(u.type);let j;switch(O){case"vector":case"raster":return j=Jr({key:d,value:u,valueSpec:v[`source_${O.replace("-","_")}`],style:h.style,styleSpec:v,objectElementValidators:xs,validateSpec:D}),j;case"raster-dem":return j=function(K){var ee;const ce=(ee=K.sourceName)!==null&&ee!==void 0?ee:"",ve=K.value,Re=K.styleSpec,Ue=Re.source_raster_dem,qe=K.style;let st=[];const xt=oi(ve);if(ve===void 0)return st;if(xt!=="object")return st.push(new bn("source_raster_dem",ve,`object expected, ${xt} found`)),st;const It=ar(ve.encoding)==="custom",fn=["redFactor","greenFactor","blueFactor","baseShift"],$t=K.value.encoding?`"${K.value.encoding}"`:"Default";for(const Oe in ve)!It&&fn.includes(Oe)?st.push(new bn(Oe,ve[Oe],`In "${ce}": "${Oe}" is only valid when "encoding" is set to "custom". ${$t} encoding found`)):Ue[Oe]?st=st.concat(K.validateSpec({key:Oe,value:ve[Oe],valueSpec:Ue[Oe],validateSpec:K.validateSpec,style:qe,styleSpec:Re})):st.push(new bn(Oe,ve[Oe],`unknown property "${Oe}"`));return st}({sourceName:d,value:u,style:h.style,styleSpec:v,validateSpec:D}),j;case"geojson":if(j=Jr({key:d,value:u,valueSpec:v.source_geojson,style:P,styleSpec:v,validateSpec:D,objectElementValidators:xs}),u.cluster)for(const K in u.clusterProperties){const[ee,ce]=u.clusterProperties[K],ve=typeof ee=="string"?[ee,["accumulated"],["get",K]]:ee;j.push(...so({key:`${d}.${K}.map`,value:ce,expressionContext:"cluster-map"})),j.push(...so({key:`${d}.${K}.reduce`,value:ve,expressionContext:"cluster-reduce"}))}return j;case"video":return Jr({key:d,value:u,valueSpec:v.source_video,style:P,validateSpec:D,styleSpec:v});case"image":return Jr({key:d,value:u,valueSpec:v.source_image,style:P,validateSpec:D,styleSpec:v});case"canvas":return[new bn(d,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ss({key:`${d}.type`,value:u.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function dt(h){const u=h.value,d=h.styleSpec,v=d.light,P=h.style;let D=[];const O=oi(u);if(u===void 0)return D;if(O!=="object")return D=D.concat([new bn("light",u,`object expected, ${O} found`)]),D;for(const j in u){const K=j.match(/^(.*)-transition$/);D=D.concat(K&&v[K[1]]&&v[K[1]].transition?h.validateSpec({key:j,value:u[j],valueSpec:d.transition,validateSpec:h.validateSpec,style:P,styleSpec:d}):v[j]?h.validateSpec({key:j,value:u[j],valueSpec:v[j],validateSpec:h.validateSpec,style:P,styleSpec:d}):[new bn(j,u[j],`unknown property "${j}"`)])}return D}function ka(h){const u=h.value,d=h.styleSpec,v=d.sky,P=h.style,D=oi(u);if(u===void 0)return[];if(D!=="object")return[new bn("sky",u,`object expected, ${D} found`)];let O=[];for(const j in u)O=O.concat(v[j]?h.validateSpec({key:j,value:u[j],valueSpec:v[j],style:P,styleSpec:d}):[new bn(j,u[j],`unknown property "${j}"`)]);return O}function Vc(h){const u=h.value,d=h.styleSpec,v=d.terrain,P=h.style;let D=[];const O=oi(u);if(u===void 0)return D;if(O!=="object")return D=D.concat([new bn("terrain",u,`object expected, ${O} found`)]),D;for(const j in u)D=D.concat(v[j]?h.validateSpec({key:j,value:u[j],valueSpec:v[j],validateSpec:h.validateSpec,style:P,styleSpec:d}):[new bn(j,u[j],`unknown property "${j}"`)]);return D}function qo(h){let u=[];const d=h.value,v=h.key;if(Array.isArray(d)){const P=[],D=[];for(const O in d)d[O].id&&P.includes(d[O].id)&&u.push(new bn(v,d,`all the sprites' ids must be unique, but ${d[O].id} is duplicated`)),P.push(d[O].id),d[O].url&&D.includes(d[O].url)&&u.push(new bn(v,d,`all the sprites' URLs must be unique, but ${d[O].url} is duplicated`)),D.push(d[O].url),u=u.concat(Jr({key:`${v}[${O}]`,value:d[O],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:h.validateSpec}));return u}return Aa({key:v,value:d})}const Ni={"*":()=>[],array:Vi,boolean:function(h){const u=h.value,d=h.key,v=oi(u);return v!=="boolean"?[new bn(d,u,`boolean expected, ${v} found`)]:[]},number:vo,color:function(h){const u=h.key,d=h.value,v=oi(d);return v!=="string"?[new bn(u,d,`color expected, ${v} found`)]:ui.parse(String(d))?[]:[new bn(u,d,`color expected, "${d}" found`)]},constants:Jn,enum:Ss,filter:ma,function:Js,layer:Xh,object:Jr,source:ia,light:dt,sky:ka,terrain:Vc,projection:function(h){const u=h.value,d=h.styleSpec,v=d.projection,P=h.style,D=oi(u);if(u===void 0)return[];if(D!=="object")return[new bn("projection",u,`object expected, ${D} found`)];let O=[];for(const j in u)O=O.concat(v[j]?h.validateSpec({key:j,value:u[j],valueSpec:v[j],style:P,styleSpec:d}):[new bn(j,u[j],`unknown property "${j}"`)]);return O},projectionDefinition:function(h){const u=h.key;let d=h.value;d=d instanceof String?d.valueOf():d;const v=oi(d);return v!=="array"||function(P){return Array.isArray(P)&&P.length===3&&typeof P[0]=="string"&&typeof P[1]=="string"&&typeof P[2]=="number"}(d)||function(P){return!!["interpolate","step","literal"].includes(P[0])}(d)?["array","string"].includes(v)?[]:[new bn(u,d,`projection expected, invalid type "${v}" found`)]:[new bn(u,d,`projection expected, invalid array ${JSON.stringify(d)} found`)]},string:Aa,formatted:function(h){return Aa(h).length===0?[]:so(h)},resolvedImage:function(h){return Aa(h).length===0?[]:so(h)},padding:function(h){const u=h.key,d=h.value;if(oi(d)==="array"){if(d.length<1||d.length>4)return[new bn(u,d,`padding requires 1 to 4 values; ${d.length} values found`)];const v={type:"number"};let P=[];for(let D=0;D<d.length;D++)P=P.concat(h.validateSpec({key:`${u}[${D}]`,value:d[D],validateSpec:h.validateSpec,valueSpec:v}));return P}return vo({key:u,value:d,valueSpec:{}})},variableAnchorOffsetCollection:function(h){const u=h.key,d=h.value,v=oi(d),P=h.styleSpec;if(v!=="array"||d.length<1||d.length%2!=0)return[new bn(u,d,"variableAnchorOffsetCollection requires a non-empty array of even length")];let D=[];for(let O=0;O<d.length;O+=2)D=D.concat(Ss({key:`${u}[${O}]`,value:d[O],valueSpec:P.layout_symbol["text-anchor"]})),D=D.concat(Vi({key:`${u}[${O+1}]`,value:d[O+1],valueSpec:{length:2,value:"number"},validateSpec:h.validateSpec,style:h.style,styleSpec:P}));return D},sprite:qo};function ec(h){const u=h.value,d=h.valueSpec,v=h.styleSpec;return h.validateSpec=ec,d.expression&&io(ar(u))?Js(h):d.expression&&ho(Vr(u))?so(h):d.type&&Ni[d.type]?Ni[d.type](h):Jr(br({},h,{valueSpec:d.type?v[d.type]:d}))}function Ll(h){const u=h.value,d=h.key,v=Aa(h);return v.length||(u.indexOf("{fontstack}")===-1&&v.push(new bn(d,u,'"glyphs" url must include a "{fontstack}" token')),u.indexOf("{range}")===-1&&v.push(new bn(d,u,'"glyphs" url must include a "{range}" token'))),v}function Ia(h,u=$e){let d=[];return d=d.concat(ec({key:"",value:h,valueSpec:u.$root,styleSpec:u,style:h,validateSpec:ec,objectElementValidators:{glyphs:Ll,"*":()=>[]}})),h.constants&&(d=d.concat(Jn({key:"constants",value:h.constants}))),Th(d)}function Wo(h){return function(u){return h({...u,validateSpec:ec})}}function Th(h){return[].concat(h).sort((u,d)=>u.line-d.line)}function Fu(h){return function(...u){return Th(h.apply(this,u))}}Ia.source=Fu(Wo(ia)),Ia.sprite=Fu(Wo(qo)),Ia.glyphs=Fu(Wo(Ll)),Ia.light=Fu(Wo(dt)),Ia.sky=Fu(Wo(ka)),Ia.terrain=Fu(Wo(Vc)),Ia.layer=Fu(Wo(Xh)),Ia.filter=Fu(Wo(ma)),Ia.paintProperty=Fu(Wo(Sl)),Ia.layoutProperty=Fu(Wo(qa));const fc=Ia,uh=fc.light,Ah=fc.sky,Pc=fc.paintProperty,jd=fc.layoutProperty;function Jh(h,u){let d=!1;if(u&&u.length)for(const v of u)h.fire(new et(new Error(v.message))),d=!0;return d}class zu{constructor(u,d,v){const P=this.cells=[];if(u instanceof ArrayBuffer){this.arrayBuffer=u;const O=new Int32Array(this.arrayBuffer);u=O[0],this.d=(d=O[1])+2*(v=O[2]);for(let K=0;K<this.d*this.d;K++){const ee=O[3+K],ce=O[3+K+1];P.push(ee===ce?null:O.subarray(ee,ce))}const j=O[3+P.length+1];this.keys=O.subarray(O[3+P.length],j),this.bboxes=O.subarray(j),this.insert=this._insertReadonly}else{this.d=d+2*v;for(let O=0;O<this.d*this.d;O++)P.push([]);this.keys=[],this.bboxes=[]}this.n=d,this.extent=u,this.padding=v,this.scale=d/u,this.uid=0;const D=v/d*u;this.min=-D,this.max=u+D}insert(u,d,v,P,D){this._forEachCell(d,v,P,D,this._insertCell,this.uid++,void 0,void 0),this.keys.push(u),this.bboxes.push(d),this.bboxes.push(v),this.bboxes.push(P),this.bboxes.push(D)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(u,d,v,P,D,O){this.cells[D].push(O)}query(u,d,v,P,D){const O=this.min,j=this.max;if(u<=O&&d<=O&&j<=v&&j<=P&&!D)return Array.prototype.slice.call(this.keys);{const K=[];return this._forEachCell(u,d,v,P,this._queryCell,K,{},D),K}}_queryCell(u,d,v,P,D,O,j,K){const ee=this.cells[D];if(ee!==null){const ce=this.keys,ve=this.bboxes;for(let Re=0;Re<ee.length;Re++){const Ue=ee[Re];if(j[Ue]===void 0){const qe=4*Ue;(K?K(ve[qe+0],ve[qe+1],ve[qe+2],ve[qe+3]):u<=ve[qe+2]&&d<=ve[qe+3]&&v>=ve[qe+0]&&P>=ve[qe+1])?(j[Ue]=!0,O.push(ce[Ue])):j[Ue]=!1}}}}_forEachCell(u,d,v,P,D,O,j,K){const ee=this._convertToCellCoord(u),ce=this._convertToCellCoord(d),ve=this._convertToCellCoord(v),Re=this._convertToCellCoord(P);for(let Ue=ee;Ue<=ve;Ue++)for(let qe=ce;qe<=Re;qe++){const st=this.d*qe+Ue;if((!K||K(this._convertFromCellCoord(Ue),this._convertFromCellCoord(qe),this._convertFromCellCoord(Ue+1),this._convertFromCellCoord(qe+1)))&&D.call(this,u,d,v,P,st,O,j,K))return}}_convertFromCellCoord(u){return(u-this.padding)/this.scale}_convertToCellCoord(u){return Math.max(0,Math.min(this.d-1,Math.floor(u*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const u=this.cells,d=3+this.cells.length+1+1;let v=0;for(let O=0;O<this.cells.length;O++)v+=this.cells[O].length;const P=new Int32Array(d+v+this.keys.length+this.bboxes.length);P[0]=this.extent,P[1]=this.n,P[2]=this.padding;let D=d;for(let O=0;O<u.length;O++){const j=u[O];P[3+O]=D,P.set(j,D),D+=j.length}return P[3+u.length]=D,P.set(this.keys,D),D+=this.keys.length,P[3+u.length+1]=D,P.set(this.bboxes,D),D+=this.bboxes.length,P.buffer}static serialize(u,d){const v=u.toArrayBuffer();return d&&d.push(v),{buffer:v}}static deserialize(u){return new zu(u.buffer)}}const pc={};function Gr(h,u,d={}){if(pc[h])throw new Error(`${h} is already registered.`);Object.defineProperty(u,"_classRegistryKey",{value:h,writeable:!1}),pc[h]={klass:u,omit:d.omit||[],shallow:d.shallow||[]}}Gr("Object",Object),Gr("TransferableGridIndex",zu),Gr("Color",ui),Gr("Error",Error),Gr("AJAXError",Kt),Gr("ResolvedImage",La),Gr("StylePropertyFunction",Ha),Gr("StyleExpression",ks,{omit:["_evaluator"]}),Gr("ZoomDependentExpression",$l),Gr("ZoomConstantExpression",vi),Gr("CompoundExpression",as,{omit:["_evaluate"]});for(const h in xi)xi[h]._classRegistryKey||Gr(`Expression_${h}`,xi[h]);function vu(h){return h&&typeof ArrayBuffer<"u"&&(h instanceof ArrayBuffer||h.constructor&&h.constructor.name==="ArrayBuffer")}function wd(h){return h.$name||h.constructor._classRegistryKey}function kh(h){return!function(u){if(u===null||typeof u!="object")return!1;const d=wd(u);return!(!d||d==="Object")}(h)&&(h==null||typeof h=="boolean"||typeof h=="number"||typeof h=="string"||h instanceof Boolean||h instanceof Number||h instanceof String||h instanceof Date||h instanceof RegExp||h instanceof Blob||h instanceof Error||vu(h)||ot(h)||ArrayBuffer.isView(h)||h instanceof ImageData)}function Ih(h,u){if(kh(h))return(vu(h)||ot(h))&&u&&u.push(h),ArrayBuffer.isView(h)&&u&&u.push(h.buffer),h instanceof ImageData&&u&&u.push(h.data.buffer),h;if(Array.isArray(h)){const D=[];for(const O of h)D.push(Ih(O,u));return D}if(typeof h!="object")throw new Error("can't serialize object of type "+typeof h);const d=wd(h);if(!d)throw new Error(`can't serialize object of unregistered class ${h.constructor.name}`);if(!pc[d])throw new Error(`${d} is not registered.`);const{klass:v}=pc[d],P=v.serialize?v.serialize(h,u):{};if(v.serialize){if(u&&P===u[u.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const D in h){if(!h.hasOwnProperty(D)||pc[d].omit.indexOf(D)>=0)continue;const O=h[D];P[D]=pc[d].shallow.indexOf(D)>=0?O:Ih(O,u)}h instanceof Error&&(P.message=h.message)}if(P.$name)throw new Error("$name property is reserved for worker serialization logic.");return d!=="Object"&&(P.$name=d),P}function B(h){if(kh(h))return h;if(Array.isArray(h))return h.map(B);if(typeof h!="object")throw new Error("can't deserialize object of type "+typeof h);const u=wd(h)||"Object";if(!pc[u])throw new Error(`can't deserialize unregistered class ${u}`);const{klass:d}=pc[u];if(!d)throw new Error(`can't deserialize unregistered class ${u}`);if(d.deserialize)return d.deserialize(h);const v=Object.create(d.prototype);for(const P of Object.keys(h)){if(P==="$name")continue;const D=h[P];v[P]=pc[u].shallow.indexOf(P)>=0?D:B(D)}return v}class H{constructor(){this.first=!0}update(u,d){const v=Math.floor(u);return this.first?(this.first=!1,this.lastIntegerZoom=v,this.lastIntegerZoomTime=0,this.lastZoom=u,this.lastFloorZoom=v,!0):(this.lastFloorZoom>v?(this.lastIntegerZoom=v+1,this.lastIntegerZoomTime=d):this.lastFloorZoom<v&&(this.lastIntegerZoom=v,this.lastIntegerZoomTime=d),u!==this.lastZoom&&(this.lastZoom=u,this.lastFloorZoom=v,!0))}}const ie={"Latin-1 Supplement":h=>h>=128&&h<=255,"Hangul Jamo":h=>h>=4352&&h<=4607,Khmer:h=>h>=6016&&h<=6143,"General Punctuation":h=>h>=8192&&h<=8303,"Letterlike Symbols":h=>h>=8448&&h<=8527,"Number Forms":h=>h>=8528&&h<=8591,"Miscellaneous Technical":h=>h>=8960&&h<=9215,"Control Pictures":h=>h>=9216&&h<=9279,"Optical Character Recognition":h=>h>=9280&&h<=9311,"Enclosed Alphanumerics":h=>h>=9312&&h<=9471,"Geometric Shapes":h=>h>=9632&&h<=9727,"Miscellaneous Symbols":h=>h>=9728&&h<=9983,"Miscellaneous Symbols and Arrows":h=>h>=11008&&h<=11263,"Ideographic Description Characters":h=>h>=12272&&h<=12287,"CJK Symbols and Punctuation":h=>h>=12288&&h<=12351,Hiragana:h=>h>=12352&&h<=12447,Katakana:h=>h>=12448&&h<=12543,Kanbun:h=>h>=12688&&h<=12703,"CJK Strokes":h=>h>=12736&&h<=12783,"Enclosed CJK Letters and Months":h=>h>=12800&&h<=13055,"CJK Compatibility":h=>h>=13056&&h<=13311,"Yijing Hexagram Symbols":h=>h>=19904&&h<=19967,"CJK Unified Ideographs":h=>h>=19968&&h<=40959,"Hangul Syllables":h=>h>=44032&&h<=55215,"Private Use Area":h=>h>=57344&&h<=63743,"Vertical Forms":h=>h>=65040&&h<=65055,"CJK Compatibility Forms":h=>h>=65072&&h<=65103,"Small Form Variants":h=>h>=65104&&h<=65135,"Halfwidth and Fullwidth Forms":h=>h>=65280&&h<=65519};function Ee(h){for(const u of h)if(kt(u.charCodeAt(0)))return!0;return!1}function Ye(h){for(const u of h)if(!ht(u.charCodeAt(0)))return!1;return!0}function rt(h){const u=h.map(d=>{try{return new RegExp(`\\p{sc=${d}}`,"u").source}catch{return null}}).filter(d=>d);return new RegExp(u.join("|"),"u")}const ut=rt(["Arab","Dupl","Mong","Ougr","Syrc"]);function ht(h){return!ut.test(String.fromCodePoint(h))}const gt=rt(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function kt(h){return!(h!==746&&h!==747&&(h<4352||!(ie["CJK Compatibility Forms"](h)&&!(h>=65097&&h<=65103)||ie["CJK Compatibility"](h)||ie["CJK Strokes"](h)||!(!ie["CJK Symbols and Punctuation"](h)||h>=12296&&h<=12305||h>=12308&&h<=12319||h===12336)||ie["Enclosed CJK Letters and Months"](h)||ie["Ideographic Description Characters"](h)||ie.Kanbun(h)||ie.Katakana(h)&&h!==12540||!(!ie["Halfwidth and Fullwidth Forms"](h)||h===65288||h===65289||h===65293||h>=65306&&h<=65310||h===65339||h===65341||h===65343||h>=65371&&h<=65503||h===65507||h>=65512&&h<=65519)||!(!ie["Small Form Variants"](h)||h>=65112&&h<=65118||h>=65123&&h<=65126)||ie["Vertical Forms"](h)||ie["Yijing Hexagram Symbols"](h)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(h))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(h))||gt.test(String.fromCodePoint(h)))))}function _n(h){return!(kt(h)||function(u){return!!(ie["Latin-1 Supplement"](u)&&(u===167||u===169||u===174||u===177||u===188||u===189||u===190||u===215||u===247)||ie["General Punctuation"](u)&&(u===8214||u===8224||u===8225||u===8240||u===8241||u===8251||u===8252||u===8258||u===8263||u===8264||u===8265||u===8273)||ie["Letterlike Symbols"](u)||ie["Number Forms"](u)||ie["Miscellaneous Technical"](u)&&(u>=8960&&u<=8967||u>=8972&&u<=8991||u>=8996&&u<=9e3||u===9003||u>=9085&&u<=9114||u>=9150&&u<=9165||u===9167||u>=9169&&u<=9179||u>=9186&&u<=9215)||ie["Control Pictures"](u)&&u!==9251||ie["Optical Character Recognition"](u)||ie["Enclosed Alphanumerics"](u)||ie["Geometric Shapes"](u)||ie["Miscellaneous Symbols"](u)&&!(u>=9754&&u<=9759)||ie["Miscellaneous Symbols and Arrows"](u)&&(u>=11026&&u<=11055||u>=11088&&u<=11097||u>=11192&&u<=11243)||ie["CJK Symbols and Punctuation"](u)||ie.Katakana(u)||ie["Private Use Area"](u)||ie["CJK Compatibility Forms"](u)||ie["Small Form Variants"](u)||ie["Halfwidth and Fullwidth Forms"](u)||u===8734||u===8756||u===8757||u>=9984&&u<=10087||u>=10102&&u<=10131||u===65532||u===65533)}(h))}const Vn=rt(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Un(h){return Vn.test(String.fromCodePoint(h))}function kn(h,u){return!(!u&&Un(h)||h>=2304&&h<=3583||h>=3840&&h<=4255||ie.Khmer(h))}function ur(h){for(const u of h)if(Un(u.charCodeAt(0)))return!0;return!1}const Zn=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(h){this.pluginStatus=h.pluginStatus,this.pluginURL=h.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(h){if(Zn.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=h.applyArabicShaping,this.processBidirectionalText=h.processBidirectionalText,this.processStyledBidirectionalText=h.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(h,u){return o(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(h.pluginStatus!=="loading")return this.setState(h),h;const d=h.pluginURL,v=new Promise(D=>{this.loadScriptResolve=D});u(d);const P=new Promise(D=>setTimeout(()=>D(),this.TIMEOUT));if(yield Promise.race([v,P]),this.isParsed()){const D={pluginStatus:"loaded",pluginURL:d};return this.setState(D),D}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${d}`)})}};class Qt{constructor(u,d){this.zoom=u,d?(this.now=d.now,this.fadeDuration=d.fadeDuration,this.zoomHistory=d.zoomHistory,this.transition=d.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new H,this.transition={})}isSupportedScript(u){return function(d,v){for(const P of d)if(!kn(P.charCodeAt(0),v))return!1;return!0}(u,Zn.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const u=this.zoom,d=u-Math.floor(u),v=this.crossFadingFactor();return u>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:d+(1-d)*v}:{fromScale:.5,toScale:1,t:1-(1-v)*d}}}class Sn{constructor(u,d){this.property=u,this.value=d,this.expression=function(v,P){if(io(v))return new Ha(v,P);if(ho(v)){const D=yu(v,P);if(D.result==="error")throw new Error(D.value.map(O=>`${O.key}: ${O.message}`).join(", "));return D.value}{let D=v;return P.type==="color"&&typeof v=="string"?D=ui.parse(v):P.type!=="padding"||typeof v!="number"&&!Array.isArray(v)?P.type==="variableAnchorOffsetCollection"&&Array.isArray(v)?D=us.parse(v):P.type==="projectionDefinition"&&typeof v=="string"&&(D=Lo.parse(v)):D=Zs.parse(v),{kind:"constant",evaluate:()=>D}}}(d===void 0?u.specification.default:d,u.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(u,d,v){return this.property.possiblyEvaluate(this,u,d,v)}}class fr{constructor(u){this.property=u,this.value=new Sn(u,void 0)}transitioned(u,d){return new gr(this.property,this.value,d,lt({},u.transition,this.transition),u.now)}untransitioned(){return new gr(this.property,this.value,null,{},0)}}class Cr{constructor(u){this._properties=u,this._values=Object.create(u.defaultTransitionablePropertyValues)}getValue(u){return yn(this._values[u].value.value)}setValue(u,d){Object.prototype.hasOwnProperty.call(this._values,u)||(this._values[u]=new fr(this._values[u].property)),this._values[u].value=new Sn(this._values[u].property,d===null?void 0:yn(d))}getTransition(u){return yn(this._values[u].transition)}setTransition(u,d){Object.prototype.hasOwnProperty.call(this._values,u)||(this._values[u]=new fr(this._values[u].property)),this._values[u].transition=yn(d)||void 0}serialize(){const u={};for(const d of Object.keys(this._values)){const v=this.getValue(d);v!==void 0&&(u[d]=v);const P=this.getTransition(d);P!==void 0&&(u[`${d}-transition`]=P)}return u}transitioned(u,d){const v=new qr(this._properties);for(const P of Object.keys(this._values))v._values[P]=this._values[P].transitioned(u,d._values[P]);return v}untransitioned(){const u=new qr(this._properties);for(const d of Object.keys(this._values))u._values[d]=this._values[d].untransitioned();return u}}class gr{constructor(u,d,v,P,D){this.property=u,this.value=d,this.begin=D+P.delay||0,this.end=this.begin+P.duration||0,u.specification.transition&&(P.delay||P.duration)&&(this.prior=v)}possiblyEvaluate(u,d,v){const P=u.now||0,D=this.value.possiblyEvaluate(u,d,v),O=this.prior;if(O){if(P>this.end)return this.prior=null,D;if(this.value.isDataDriven())return this.prior=null,D;if(P<this.begin)return O.possiblyEvaluate(u,d,v);{const j=(P-this.begin)/(this.end-this.begin);return this.property.interpolate(O.possiblyEvaluate(u,d,v),D,ge(j))}}return D}}class qr{constructor(u){this._properties=u,this._values=Object.create(u.defaultTransitioningPropertyValues)}possiblyEvaluate(u,d,v){const P=new y(this._properties);for(const D of Object.keys(this._values))P._values[D]=this._values[D].possiblyEvaluate(u,d,v);return P}hasTransition(){for(const u of Object.keys(this._values))if(this._values[u].prior)return!0;return!1}}class Ur{constructor(u){this._properties=u,this._values=Object.create(u.defaultPropertyValues)}hasValue(u){return this._values[u].value!==void 0}getValue(u){return yn(this._values[u].value)}setValue(u,d){this._values[u]=new Sn(this._values[u].property,d===null?void 0:yn(d))}serialize(){const u={};for(const d of Object.keys(this._values)){const v=this.getValue(d);v!==void 0&&(u[d]=v)}return u}possiblyEvaluate(u,d,v){const P=new y(this._properties);for(const D of Object.keys(this._values))P._values[D]=this._values[D].possiblyEvaluate(u,d,v);return P}}class ei{constructor(u,d,v){this.property=u,this.value=d,this.parameters=v}isConstant(){return this.value.kind==="constant"}constantOr(u){return this.value.kind==="constant"?this.value.value:u}evaluate(u,d,v,P){return this.property.evaluate(this.value,this.parameters,u,d,v,P)}}class y{constructor(u){this._properties=u,this._values=Object.create(u.defaultPossiblyEvaluatedValues)}get(u){return this._values[u]}}class S{constructor(u){this.specification=u}possiblyEvaluate(u,d){if(u.isDataDriven())throw new Error("Value should not be data driven");return u.expression.evaluate(d)}interpolate(u,d,v){const P=vs[this.specification.type];return P?P(u,d,v):u}}class I{constructor(u,d){this.specification=u,this.overrides=d}possiblyEvaluate(u,d,v,P){return new ei(this,u.expression.kind==="constant"||u.expression.kind==="camera"?{kind:"constant",value:u.expression.evaluate(d,null,{},v,P)}:u.expression,d)}interpolate(u,d,v){if(u.value.kind!=="constant"||d.value.kind!=="constant")return u;if(u.value.value===void 0||d.value.value===void 0)return new ei(this,{kind:"constant",value:void 0},u.parameters);const P=vs[this.specification.type];if(P){const D=P(u.value.value,d.value.value,v);return new ei(this,{kind:"constant",value:D},u.parameters)}return u}evaluate(u,d,v,P,D,O){return u.kind==="constant"?u.value:u.evaluate(d,v,P,D,O)}}class F extends I{possiblyEvaluate(u,d,v,P){if(u.value===void 0)return new ei(this,{kind:"constant",value:void 0},d);if(u.expression.kind==="constant"){const D=u.expression.evaluate(d,null,{},v,P),O=u.property.specification.type==="resolvedImage"&&typeof D!="string"?D.name:D,j=this._calculate(O,O,O,d);return new ei(this,{kind:"constant",value:j},d)}if(u.expression.kind==="camera"){const D=this._calculate(u.expression.evaluate({zoom:d.zoom-1}),u.expression.evaluate({zoom:d.zoom}),u.expression.evaluate({zoom:d.zoom+1}),d);return new ei(this,{kind:"constant",value:D},d)}return new ei(this,u.expression,d)}evaluate(u,d,v,P,D,O){if(u.kind==="source"){const j=u.evaluate(d,v,P,D,O);return this._calculate(j,j,j,d)}return u.kind==="composite"?this._calculate(u.evaluate({zoom:Math.floor(d.zoom)-1},v,P),u.evaluate({zoom:Math.floor(d.zoom)},v,P),u.evaluate({zoom:Math.floor(d.zoom)+1},v,P),d):u.value}_calculate(u,d,v,P){return P.zoom>P.zoomHistory.lastIntegerZoom?{from:u,to:d}:{from:v,to:d}}interpolate(u){return u}}class G{constructor(u){this.specification=u}possiblyEvaluate(u,d,v,P){if(u.value!==void 0){if(u.expression.kind==="constant"){const D=u.expression.evaluate(d,null,{},v,P);return this._calculate(D,D,D,d)}return this._calculate(u.expression.evaluate(new Qt(Math.floor(d.zoom-1),d)),u.expression.evaluate(new Qt(Math.floor(d.zoom),d)),u.expression.evaluate(new Qt(Math.floor(d.zoom+1),d)),d)}}_calculate(u,d,v,P){return P.zoom>P.zoomHistory.lastIntegerZoom?{from:u,to:d}:{from:v,to:d}}interpolate(u){return u}}class te{constructor(u){this.specification=u}possiblyEvaluate(u,d,v,P){return!!u.expression.evaluate(d,null,{},v,P)}interpolate(){return!1}}class pe{constructor(u){this.properties=u,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const d in u){const v=u[d];v.specification.overridable&&this.overridableProperties.push(d);const P=this.defaultPropertyValues[d]=new Sn(v,void 0),D=this.defaultTransitionablePropertyValues[d]=new fr(v);this.defaultTransitioningPropertyValues[d]=D.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=P.possiblyEvaluate({})}}}Gr("DataDrivenProperty",I),Gr("DataConstantProperty",S),Gr("CrossFadedDataDrivenProperty",F),Gr("CrossFadedProperty",G),Gr("ColorRampProperty",te);const xe="-transition";class Fe extends ct{constructor(u,d){if(super(),this.id=u.id,this.type=u.type,this._featureFilter={filter:()=>!0,needGeometry:!1},u.type!=="custom"&&(this.metadata=u.metadata,this.minzoom=u.minzoom,this.maxzoom=u.maxzoom,u.type!=="background"&&(this.source=u.source,this.sourceLayer=u["source-layer"],this.filter=u.filter),d.layout&&(this._unevaluatedLayout=new Ur(d.layout)),d.paint)){this._transitionablePaint=new Cr(d.paint);for(const v in u.paint)this.setPaintProperty(v,u.paint[v],{validate:!1});for(const v in u.layout)this.setLayoutProperty(v,u.layout[v],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new y(d.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(u){return u==="visibility"?this.visibility:this._unevaluatedLayout.getValue(u)}setLayoutProperty(u,d,v={}){d!=null&&this._validate(jd,`layers.${this.id}.layout.${u}`,u,d,v)||(u!=="visibility"?this._unevaluatedLayout.setValue(u,d):this.visibility=d)}getPaintProperty(u){return u.endsWith(xe)?this._transitionablePaint.getTransition(u.slice(0,-11)):this._transitionablePaint.getValue(u)}setPaintProperty(u,d,v={}){if(d!=null&&this._validate(Pc,`layers.${this.id}.paint.${u}`,u,d,v))return!1;if(u.endsWith(xe))return this._transitionablePaint.setTransition(u.slice(0,-11),d||void 0),!1;{const P=this._transitionablePaint._values[u],D=P.property.specification["property-type"]==="cross-faded-data-driven",O=P.value.isDataDriven(),j=P.value;this._transitionablePaint.setValue(u,d),this._handleSpecialPaintPropertyUpdate(u);const K=this._transitionablePaint._values[u].value;return K.isDataDriven()||O||D||this._handleOverridablePaintPropertyUpdate(u,j,K)}}_handleSpecialPaintPropertyUpdate(u){}_handleOverridablePaintPropertyUpdate(u,d,v){return!1}isHidden(u){return!!(this.minzoom&&u<this.minzoom)||!!(this.maxzoom&&u>=this.maxzoom)||this.visibility==="none"}updateTransitions(u){this._transitioningPaint=this._transitionablePaint.transitioned(u,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(u,d){u.getCrossfadeParameters&&(this._crossfadeParameters=u.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(u,void 0,d)),this.paint=this._transitioningPaint.possiblyEvaluate(u,void 0,d)}serialize(){const u={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(u.layout=u.layout||{},u.layout.visibility=this.visibility),rn(u,(d,v)=>!(d===void 0||v==="layout"&&!Object.keys(d).length||v==="paint"&&!Object.keys(d).length))}_validate(u,d,v,P,D={}){return(!D||D.validate!==!1)&&Jh(this,u.call(fc,{key:d,layerType:this.type,objectKey:v,value:P,styleSpec:$e,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const u in this.paint._values){const d=this.paint.get(u);if(d instanceof ei&&fa(d.property.specification)&&(d.value.kind==="source"||d.value.kind==="composite")&&d.value.isStateDependent)return!0}return!1}}const tt={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class zt{constructor(u,d){this._structArray=u,this._pos1=d*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class bt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(u,d){return u._trim(),d&&(u.isTransferred=!0,d.push(u.arrayBuffer)),{length:u.length,arrayBuffer:u.arrayBuffer}}static deserialize(u){const d=Object.create(this.prototype);return d.arrayBuffer=u.arrayBuffer,d.length=u.length,d.capacity=u.arrayBuffer.byteLength/d.bytesPerElement,d._refreshViews(),d}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(u){this.reserve(u),this.length=u}reserve(u){if(u>this.capacity){this.capacity=Math.max(u,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const d=this.uint8;this._refreshViews(),d&&this.uint8.set(d)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function dn(h,u=1){let d=0,v=0;return{members:h.map(P=>{const D=tt[P.type].BYTES_PER_ELEMENT,O=d=zn(d,Math.max(u,D)),j=P.components||1;return v=Math.max(v,D),d+=D*j,{name:P.name,type:P.type,components:j,offset:O}}),size:zn(d,Math.max(v,u)),alignment:u}}function zn(h,u){return Math.ceil(h/u)*u}class hr extends bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,d){const v=this.length;return this.resize(v+1),this.emplace(v,u,d)}emplace(u,d,v){const P=2*u;return this.int16[P+0]=d,this.int16[P+1]=v,u}}hr.prototype.bytesPerElement=4,Gr("StructArrayLayout2i4",hr);class Ir extends bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,d,v){const P=this.length;return this.resize(P+1),this.emplace(P,u,d,v)}emplace(u,d,v,P){const D=3*u;return this.int16[D+0]=d,this.int16[D+1]=v,this.int16[D+2]=P,u}}Ir.prototype.bytesPerElement=6,Gr("StructArrayLayout3i6",Ir);class Br extends bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,d,v,P){const D=this.length;return this.resize(D+1),this.emplace(D,u,d,v,P)}emplace(u,d,v,P,D){const O=4*u;return this.int16[O+0]=d,this.int16[O+1]=v,this.int16[O+2]=P,this.int16[O+3]=D,u}}Br.prototype.bytesPerElement=8,Gr("StructArrayLayout4i8",Br);class ci extends bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,d,v,P,D,O){const j=this.length;return this.resize(j+1),this.emplace(j,u,d,v,P,D,O)}emplace(u,d,v,P,D,O,j){const K=6*u;return this.int16[K+0]=d,this.int16[K+1]=v,this.int16[K+2]=P,this.int16[K+3]=D,this.int16[K+4]=O,this.int16[K+5]=j,u}}ci.prototype.bytesPerElement=12,Gr("StructArrayLayout2i4i12",ci);class Nt extends bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,d,v,P,D,O){const j=this.length;return this.resize(j+1),this.emplace(j,u,d,v,P,D,O)}emplace(u,d,v,P,D,O,j){const K=4*u,ee=8*u;return this.int16[K+0]=d,this.int16[K+1]=v,this.uint8[ee+4]=P,this.uint8[ee+5]=D,this.uint8[ee+6]=O,this.uint8[ee+7]=j,u}}Nt.prototype.bytesPerElement=8,Gr("StructArrayLayout2i4ub8",Nt);class qt extends bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,d){const v=this.length;return this.resize(v+1),this.emplace(v,u,d)}emplace(u,d,v){const P=2*u;return this.float32[P+0]=d,this.float32[P+1]=v,u}}qt.prototype.bytesPerElement=8,Gr("StructArrayLayout2f8",qt);class gn extends bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,d,v,P,D,O,j,K,ee,ce){const ve=this.length;return this.resize(ve+1),this.emplace(ve,u,d,v,P,D,O,j,K,ee,ce)}emplace(u,d,v,P,D,O,j,K,ee,ce,ve){const Re=10*u;return this.uint16[Re+0]=d,this.uint16[Re+1]=v,this.uint16[Re+2]=P,this.uint16[Re+3]=D,this.uint16[Re+4]=O,this.uint16[Re+5]=j,this.uint16[Re+6]=K,this.uint16[Re+7]=ee,this.uint16[Re+8]=ce,this.uint16[Re+9]=ve,u}}gn.prototype.bytesPerElement=20,Gr("StructArrayLayout10ui20",gn);class Gn extends bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,d,v,P,D,O,j,K,ee,ce,ve,Re){const Ue=this.length;return this.resize(Ue+1),this.emplace(Ue,u,d,v,P,D,O,j,K,ee,ce,ve,Re)}emplace(u,d,v,P,D,O,j,K,ee,ce,ve,Re,Ue){const qe=12*u;return this.int16[qe+0]=d,this.int16[qe+1]=v,this.int16[qe+2]=P,this.int16[qe+3]=D,this.uint16[qe+4]=O,this.uint16[qe+5]=j,this.uint16[qe+6]=K,this.uint16[qe+7]=ee,this.int16[qe+8]=ce,this.int16[qe+9]=ve,this.int16[qe+10]=Re,this.int16[qe+11]=Ue,u}}Gn.prototype.bytesPerElement=24,Gr("StructArrayLayout4i4ui4i24",Gn);class Mn extends bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,d,v){const P=this.length;return this.resize(P+1),this.emplace(P,u,d,v)}emplace(u,d,v,P){const D=3*u;return this.float32[D+0]=d,this.float32[D+1]=v,this.float32[D+2]=P,u}}Mn.prototype.bytesPerElement=12,Gr("StructArrayLayout3f12",Mn);class Bn extends bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(u){const d=this.length;return this.resize(d+1),this.emplace(d,u)}emplace(u,d){return this.uint32[1*u+0]=d,u}}Bn.prototype.bytesPerElement=4,Gr("StructArrayLayout1ul4",Bn);class Ge extends bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,d,v,P,D,O,j,K,ee){const ce=this.length;return this.resize(ce+1),this.emplace(ce,u,d,v,P,D,O,j,K,ee)}emplace(u,d,v,P,D,O,j,K,ee,ce){const ve=10*u,Re=5*u;return this.int16[ve+0]=d,this.int16[ve+1]=v,this.int16[ve+2]=P,this.int16[ve+3]=D,this.int16[ve+4]=O,this.int16[ve+5]=j,this.uint32[Re+3]=K,this.uint16[ve+8]=ee,this.uint16[ve+9]=ce,u}}Ge.prototype.bytesPerElement=20,Gr("StructArrayLayout6i1ul2ui20",Ge);class at extends bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,d,v,P,D,O){const j=this.length;return this.resize(j+1),this.emplace(j,u,d,v,P,D,O)}emplace(u,d,v,P,D,O,j){const K=6*u;return this.int16[K+0]=d,this.int16[K+1]=v,this.int16[K+2]=P,this.int16[K+3]=D,this.int16[K+4]=O,this.int16[K+5]=j,u}}at.prototype.bytesPerElement=12,Gr("StructArrayLayout2i2i2i12",at);class mt extends bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,d,v,P,D){const O=this.length;return this.resize(O+1),this.emplace(O,u,d,v,P,D)}emplace(u,d,v,P,D,O){const j=4*u,K=8*u;return this.float32[j+0]=d,this.float32[j+1]=v,this.float32[j+2]=P,this.int16[K+6]=D,this.int16[K+7]=O,u}}mt.prototype.bytesPerElement=16,Gr("StructArrayLayout2f1f2i16",mt);class _t extends bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,d,v,P,D,O){const j=this.length;return this.resize(j+1),this.emplace(j,u,d,v,P,D,O)}emplace(u,d,v,P,D,O,j){const K=16*u,ee=4*u,ce=8*u;return this.uint8[K+0]=d,this.uint8[K+1]=v,this.float32[ee+1]=P,this.float32[ee+2]=D,this.int16[ce+6]=O,this.int16[ce+7]=j,u}}_t.prototype.bytesPerElement=16,Gr("StructArrayLayout2ub2f2i16",_t);class St extends bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,d,v){const P=this.length;return this.resize(P+1),this.emplace(P,u,d,v)}emplace(u,d,v,P){const D=3*u;return this.uint16[D+0]=d,this.uint16[D+1]=v,this.uint16[D+2]=P,u}}St.prototype.bytesPerElement=6,Gr("StructArrayLayout3ui6",St);class Lt extends bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,d,v,P,D,O,j,K,ee,ce,ve,Re,Ue,qe,st,xt,It){const fn=this.length;return this.resize(fn+1),this.emplace(fn,u,d,v,P,D,O,j,K,ee,ce,ve,Re,Ue,qe,st,xt,It)}emplace(u,d,v,P,D,O,j,K,ee,ce,ve,Re,Ue,qe,st,xt,It,fn){const $t=24*u,Oe=12*u,ft=48*u;return this.int16[$t+0]=d,this.int16[$t+1]=v,this.uint16[$t+2]=P,this.uint16[$t+3]=D,this.uint32[Oe+2]=O,this.uint32[Oe+3]=j,this.uint32[Oe+4]=K,this.uint16[$t+10]=ee,this.uint16[$t+11]=ce,this.uint16[$t+12]=ve,this.float32[Oe+7]=Re,this.float32[Oe+8]=Ue,this.uint8[ft+36]=qe,this.uint8[ft+37]=st,this.uint8[ft+38]=xt,this.uint32[Oe+10]=It,this.int16[$t+22]=fn,u}}Lt.prototype.bytesPerElement=48,Gr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Lt);class sn extends bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,d,v,P,D,O,j,K,ee,ce,ve,Re,Ue,qe,st,xt,It,fn,$t,Oe,ft,Wt,$n,_r,Wn,rr,Ar,xr){const kr=this.length;return this.resize(kr+1),this.emplace(kr,u,d,v,P,D,O,j,K,ee,ce,ve,Re,Ue,qe,st,xt,It,fn,$t,Oe,ft,Wt,$n,_r,Wn,rr,Ar,xr)}emplace(u,d,v,P,D,O,j,K,ee,ce,ve,Re,Ue,qe,st,xt,It,fn,$t,Oe,ft,Wt,$n,_r,Wn,rr,Ar,xr,kr){const lr=32*u,Qr=16*u;return this.int16[lr+0]=d,this.int16[lr+1]=v,this.int16[lr+2]=P,this.int16[lr+3]=D,this.int16[lr+4]=O,this.int16[lr+5]=j,this.int16[lr+6]=K,this.int16[lr+7]=ee,this.uint16[lr+8]=ce,this.uint16[lr+9]=ve,this.uint16[lr+10]=Re,this.uint16[lr+11]=Ue,this.uint16[lr+12]=qe,this.uint16[lr+13]=st,this.uint16[lr+14]=xt,this.uint16[lr+15]=It,this.uint16[lr+16]=fn,this.uint16[lr+17]=$t,this.uint16[lr+18]=Oe,this.uint16[lr+19]=ft,this.uint16[lr+20]=Wt,this.uint16[lr+21]=$n,this.uint16[lr+22]=_r,this.uint32[Qr+12]=Wn,this.float32[Qr+13]=rr,this.float32[Qr+14]=Ar,this.uint16[lr+30]=xr,this.uint16[lr+31]=kr,u}}sn.prototype.bytesPerElement=64,Gr("StructArrayLayout8i15ui1ul2f2ui64",sn);class E extends bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u){const d=this.length;return this.resize(d+1),this.emplace(d,u)}emplace(u,d){return this.float32[1*u+0]=d,u}}E.prototype.bytesPerElement=4,Gr("StructArrayLayout1f4",E);class s extends bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,d,v){const P=this.length;return this.resize(P+1),this.emplace(P,u,d,v)}emplace(u,d,v,P){const D=3*u;return this.uint16[6*u+0]=d,this.float32[D+1]=v,this.float32[D+2]=P,u}}s.prototype.bytesPerElement=12,Gr("StructArrayLayout1ui2f12",s);class c extends bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,d,v){const P=this.length;return this.resize(P+1),this.emplace(P,u,d,v)}emplace(u,d,v,P){const D=4*u;return this.uint32[2*u+0]=d,this.uint16[D+2]=v,this.uint16[D+3]=P,u}}c.prototype.bytesPerElement=8,Gr("StructArrayLayout1ul2ui8",c);class g extends bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,d){const v=this.length;return this.resize(v+1),this.emplace(v,u,d)}emplace(u,d,v){const P=2*u;return this.uint16[P+0]=d,this.uint16[P+1]=v,u}}g.prototype.bytesPerElement=4,Gr("StructArrayLayout2ui4",g);class x extends bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u){const d=this.length;return this.resize(d+1),this.emplace(d,u)}emplace(u,d){return this.uint16[1*u+0]=d,u}}x.prototype.bytesPerElement=2,Gr("StructArrayLayout1ui2",x);class A extends bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,d,v,P){const D=this.length;return this.resize(D+1),this.emplace(D,u,d,v,P)}emplace(u,d,v,P,D){const O=4*u;return this.float32[O+0]=d,this.float32[O+1]=v,this.float32[O+2]=P,this.float32[O+3]=D,u}}A.prototype.bytesPerElement=16,Gr("StructArrayLayout4f16",A);class N extends zt{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new R(this.anchorPointX,this.anchorPointY)}}N.prototype.size=20;class $ extends Ge{get(u){return new N(this,u)}}Gr("CollisionBoxArray",$);class Z extends zt{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(u){this._structArray.uint8[this._pos1+37]=u}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(u){this._structArray.uint8[this._pos1+38]=u}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(u){this._structArray.uint32[this._pos4+10]=u}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Z.prototype.size=48;class re extends Lt{get(u){return new Z(this,u)}}Gr("PlacedSymbolArray",re);class fe extends zt{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(u){this._structArray.uint32[this._pos4+12]=u}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}fe.prototype.size=64;class Me extends sn{get(u){return new fe(this,u)}}Gr("SymbolInstanceArray",Me);class ke extends E{getoffsetX(u){return this.float32[1*u+0]}}Gr("GlyphOffsetArray",ke);class Ke extends Ir{getx(u){return this.int16[3*u+0]}gety(u){return this.int16[3*u+1]}gettileUnitDistanceFromAnchor(u){return this.int16[3*u+2]}}Gr("SymbolLineVertexArray",Ke);class Qe extends zt{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Qe.prototype.size=12;class Tt extends s{get(u){return new Qe(this,u)}}Gr("TextAnchorOffsetArray",Tt);class Ct extends zt{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ct.prototype.size=8;class At extends c{get(u){return new Ct(this,u)}}Gr("FeatureIndexArray",At);class Rt extends hr{}class jt extends hr{}class Vt extends hr{}class en extends ci{}class mn extends Nt{}class on extends qt{}class On extends gn{}class jn extends Gn{}class In extends Mn{}class sr extends Bn{}class tr extends at{}class Or extends _t{}class Sr extends St{}class mr extends g{}const ti=dn([{name:"a_pos",components:2,type:"Int16"}],4),{members:wi}=ti;class Ei{constructor(u=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=u}prepareSegment(u,d,v,P){const D=this.segments[this.segments.length-1];return u>Ei.MAX_VERTEX_ARRAY_LENGTH&&De(`Max vertices per segment is ${Ei.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${u}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Ei.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!D||D.vertexLength+u>Ei.MAX_VERTEX_ARRAY_LENGTH||D.sortKey!==P?this.createNewSegment(d,v,P):D}createNewSegment(u,d,v){const P={vertexOffset:u.length,primitiveOffset:d.length,vertexLength:0,primitiveLength:0,vaos:{}};return v!==void 0&&(P.sortKey=v),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(P),P}getOrCreateLatestSegment(u,d,v){return this.prepareSegment(0,u,d,v)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const u of this.segments)for(const d in u.vaos)u.vaos[d].destroy()}static simpleSegment(u,d,v,P){return new Ei([{vertexOffset:u,primitiveOffset:d,vertexLength:v,primitiveLength:P,vaos:{},sortKey:0}])}}function Os(h,u){return 256*(h=Ve(Math.floor(h),0,255))+Ve(Math.floor(u),0,255)}Ei.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Gr("SegmentVector",Ei);const Rs=dn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var fo,po,Ji,hs={exports:{}},ko={exports:{}},sa={exports:{}},Zo=function(){if(Ji)return hs.exports;Ji=1;var h=(fo||(fo=1,ko.exports=function(d,v){var P,D,O,j,K,ee,ce,ve;for(D=d.length-(P=3&d.length),O=v,K=3432918353,ee=461845907,ve=0;ve<D;)ce=255&d.charCodeAt(ve)|(255&d.charCodeAt(++ve))<<8|(255&d.charCodeAt(++ve))<<16|(255&d.charCodeAt(++ve))<<24,++ve,O=27492+(65535&(j=5*(65535&(O=(O^=ce=(65535&(ce=(ce=(65535&ce)*K+(((ce>>>16)*K&65535)<<16)&4294967295)<<15|ce>>>17))*ee+(((ce>>>16)*ee&65535)<<16)&4294967295)<<13|O>>>19))+((5*(O>>>16)&65535)<<16)&4294967295))+((58964+(j>>>16)&65535)<<16);switch(ce=0,P){case 3:ce^=(255&d.charCodeAt(ve+2))<<16;case 2:ce^=(255&d.charCodeAt(ve+1))<<8;case 1:O^=ce=(65535&(ce=(ce=(65535&(ce^=255&d.charCodeAt(ve)))*K+(((ce>>>16)*K&65535)<<16)&4294967295)<<15|ce>>>17))*ee+(((ce>>>16)*ee&65535)<<16)&4294967295}return O^=d.length,O=2246822507*(65535&(O^=O>>>16))+((2246822507*(O>>>16)&65535)<<16)&4294967295,O=3266489909*(65535&(O^=O>>>13))+((3266489909*(O>>>16)&65535)<<16)&4294967295,(O^=O>>>16)>>>0}),ko.exports),u=(po||(po=1,sa.exports=function(d,v){for(var P,D=d.length,O=v^D,j=0;D>=4;)P=1540483477*(65535&(P=255&d.charCodeAt(j)|(255&d.charCodeAt(++j))<<8|(255&d.charCodeAt(++j))<<16|(255&d.charCodeAt(++j))<<24))+((1540483477*(P>>>16)&65535)<<16),O=1540483477*(65535&O)+((1540483477*(O>>>16)&65535)<<16)^(P=1540483477*(65535&(P^=P>>>24))+((1540483477*(P>>>16)&65535)<<16)),D-=4,++j;switch(D){case 3:O^=(255&d.charCodeAt(j+2))<<16;case 2:O^=(255&d.charCodeAt(j+1))<<8;case 1:O=1540483477*(65535&(O^=255&d.charCodeAt(j)))+((1540483477*(O>>>16)&65535)<<16)}return O=1540483477*(65535&(O^=O>>>13))+((1540483477*(O>>>16)&65535)<<16),(O^=O>>>15)>>>0}),sa.exports);return hs.exports=h,hs.exports.murmur3=h,hs.exports.murmur2=u,hs.exports}(),bo=f(Zo);class Wa{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(u,d,v,P){this.ids.push(Hl(u)),this.positions.push(d,v,P)}getPositions(u){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const d=Hl(u);let v=0,P=this.ids.length-1;for(;v<P;){const O=v+P>>1;this.ids[O]>=d?P=O:v=O+1}const D=[];for(;this.ids[v]===d;)D.push({index:this.positions[3*v],start:this.positions[3*v+1],end:this.positions[3*v+2]}),v++;return D}static serialize(u,d){const v=new Float64Array(u.ids),P=new Uint32Array(u.positions);return ju(v,P,0,v.length-1),d&&d.push(v.buffer,P.buffer),{ids:v,positions:P}}static deserialize(u){const d=new Wa;return d.ids=u.ids,d.positions=u.positions,d.indexed=!0,d}}function Hl(h){const u=+h;return!isNaN(u)&&u<=Number.MAX_SAFE_INTEGER?u:bo(String(h))}function ju(h,u,d,v){for(;d<v;){const P=h[d+v>>1];let D=d-1,O=v+1;for(;;){do D++;while(h[D]<P);do O--;while(h[O]>P);if(D>=O)break;tc(h,D,O),tc(u,3*D,3*O),tc(u,3*D+1,3*O+1),tc(u,3*D+2,3*O+2)}O-d<v-O?(ju(h,u,d,O),d=O+1):(ju(h,u,O+1,v),v=O)}}function tc(h,u,d){const v=h[u];h[u]=h[d],h[d]=v}Gr("FeaturePositionMap",Wa);class ul{constructor(u,d){this.gl=u.gl,this.location=d}}class Qh extends ul{constructor(u,d){super(u,d),this.current=0}set(u){this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class ql extends ul{constructor(u,d){super(u,d),this.current=[0,0,0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3]))}}class Wl extends ul{constructor(u,d){super(u,d),this.current=ui.transparent}set(u){u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a))}}const ed=new Float32Array(16);function ch(h){return[Os(255*h.r,255*h.g),Os(255*h.b,255*h.a)]}class td{constructor(u,d,v){this.value=u,this.uniformNames=d.map(P=>`u_${P}`),this.type=v}setUniform(u,d,v){u.set(v.constantOr(this.value))}getBinding(u,d,v){return this.type==="color"?new Wl(u,d):new Qh(u,d)}}class oa{constructor(u,d){this.uniformNames=d.map(v=>`u_${v}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(u,d){this.pixelRatioFrom=d.pixelRatio,this.pixelRatioTo=u.pixelRatio,this.patternFrom=d.tlbr,this.patternTo=u.tlbr}setUniform(u,d,v,P){const D=P==="u_pattern_to"?this.patternTo:P==="u_pattern_from"?this.patternFrom:P==="u_pixel_ratio_to"?this.pixelRatioTo:P==="u_pixel_ratio_from"?this.pixelRatioFrom:null;D&&u.set(D)}getBinding(u,d,v){return v.substr(0,9)==="u_pattern"?new ql(u,d):new Qh(u,d)}}class Io{constructor(u,d,v,P){this.expression=u,this.type=v,this.maxValue=0,this.paintVertexAttributes=d.map(D=>({name:`a_${D}`,type:"Float32",components:v==="color"?2:1,offset:0})),this.paintVertexArray=new P}populatePaintArray(u,d,v,P,D){const O=this.paintVertexArray.length,j=this.expression.evaluate(new Qt(0),d,{},P,[],D);this.paintVertexArray.resize(u),this._setPaintValue(O,u,j)}updatePaintArray(u,d,v,P){const D=this.expression.evaluate({zoom:0},v,P);this._setPaintValue(u,d,D)}_setPaintValue(u,d,v){if(this.type==="color"){const P=ch(v);for(let D=u;D<d;D++)this.paintVertexArray.emplace(D,P[0],P[1])}else{for(let P=u;P<d;P++)this.paintVertexArray.emplace(P,v);this.maxValue=Math.max(this.maxValue,Math.abs(v))}}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ga{constructor(u,d,v,P,D,O){this.expression=u,this.uniformNames=d.map(j=>`u_${j}_t`),this.type=v,this.useIntegerZoom=P,this.zoom=D,this.maxValue=0,this.paintVertexAttributes=d.map(j=>({name:`a_${j}`,type:"Float32",components:v==="color"?4:2,offset:0})),this.paintVertexArray=new O}populatePaintArray(u,d,v,P,D){const O=this.expression.evaluate(new Qt(this.zoom),d,{},P,[],D),j=this.expression.evaluate(new Qt(this.zoom+1),d,{},P,[],D),K=this.paintVertexArray.length;this.paintVertexArray.resize(u),this._setPaintValue(K,u,O,j)}updatePaintArray(u,d,v,P){const D=this.expression.evaluate({zoom:this.zoom},v,P),O=this.expression.evaluate({zoom:this.zoom+1},v,P);this._setPaintValue(u,d,D,O)}_setPaintValue(u,d,v,P){if(this.type==="color"){const D=ch(v),O=ch(P);for(let j=u;j<d;j++)this.paintVertexArray.emplace(j,D[0],D[1],O[0],O[1])}else{for(let D=u;D<d;D++)this.paintVertexArray.emplace(D,v,P);this.maxValue=Math.max(this.maxValue,Math.abs(v),Math.abs(P))}}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(u,d){const v=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,P=Ve(this.expression.interpolationFactor(v,this.zoom,this.zoom+1),0,1);u.set(P)}getBinding(u,d,v){return new Qh(u,d)}}class Do{constructor(u,d,v,P,D,O){this.expression=u,this.type=d,this.useIntegerZoom=v,this.zoom=P,this.layerId=O,this.zoomInPaintVertexArray=new D,this.zoomOutPaintVertexArray=new D}populatePaintArray(u,d,v){const P=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(u),this.zoomOutPaintVertexArray.resize(u),this._setPaintValues(P,u,d.patterns&&d.patterns[this.layerId],v)}updatePaintArray(u,d,v,P,D){this._setPaintValues(u,d,v.patterns&&v.patterns[this.layerId],D)}_setPaintValues(u,d,v,P){if(!P||!v)return;const{min:D,mid:O,max:j}=v,K=P[D],ee=P[O],ce=P[j];if(K&&ee&&ce)for(let ve=u;ve<d;ve++)this.zoomInPaintVertexArray.emplace(ve,ee.tl[0],ee.tl[1],ee.br[0],ee.br[1],K.tl[0],K.tl[1],K.br[0],K.br[1],ee.pixelRatio,K.pixelRatio),this.zoomOutPaintVertexArray.emplace(ve,ee.tl[0],ee.tl[1],ee.br[0],ee.br[1],ce.tl[0],ce.tl[1],ce.br[0],ce.br[1],ee.pixelRatio,ce.pixelRatio)}upload(u){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=u.createVertexBuffer(this.zoomInPaintVertexArray,Rs.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=u.createVertexBuffer(this.zoomOutPaintVertexArray,Rs.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Og{constructor(u,d,v){this.binders={},this._buffers=[];const P=[];for(const D in u.paint._values){if(!v(D))continue;const O=u.paint.get(D);if(!(O instanceof ei&&fa(O.property.specification)))continue;const j=Rg(D,u.type),K=O.value,ee=O.property.specification.type,ce=O.property.useIntegerZoom,ve=O.property.specification["property-type"],Re=ve==="cross-faded"||ve==="cross-faded-data-driven";if(K.kind==="constant")this.binders[D]=Re?new oa(K.value,j):new td(K.value,j,ee),P.push(`/u_${D}`);else if(K.kind==="source"||Re){const Ue=nc(D,ee,"source");this.binders[D]=Re?new Do(K,ee,ce,d,Ue,u.id):new Io(K,j,ee,Ue),P.push(`/a_${D}`)}else{const Ue=nc(D,ee,"composite");this.binders[D]=new ga(K,j,ee,ce,d,Ue),P.push(`/z_${D}`)}}this.cacheKey=P.sort().join("")}getMaxValue(u){const d=this.binders[u];return d instanceof Io||d instanceof ga?d.maxValue:0}populatePaintArrays(u,d,v,P,D){for(const O in this.binders){const j=this.binders[O];(j instanceof Io||j instanceof ga||j instanceof Do)&&j.populatePaintArray(u,d,v,P,D)}}setConstantPatternPositions(u,d){for(const v in this.binders){const P=this.binders[v];P instanceof oa&&P.setConstantPatternPositions(u,d)}}updatePaintArrays(u,d,v,P,D){let O=!1;for(const j in u){const K=d.getPositions(j);for(const ee of K){const ce=v.feature(ee.index);for(const ve in this.binders){const Re=this.binders[ve];if((Re instanceof Io||Re instanceof ga||Re instanceof Do)&&Re.expression.isStateDependent===!0){const Ue=P.paint.get(ve);Re.expression=Ue.value,Re.updatePaintArray(ee.start,ee.end,ce,u[j],D),O=!0}}}}return O}defines(){const u=[];for(const d in this.binders){const v=this.binders[d];(v instanceof td||v instanceof oa)&&u.push(...v.uniformNames.map(P=>`#define HAS_UNIFORM_${P}`))}return u}getBinderAttributes(){const u=[];for(const d in this.binders){const v=this.binders[d];if(v instanceof Io||v instanceof ga)for(let P=0;P<v.paintVertexAttributes.length;P++)u.push(v.paintVertexAttributes[P].name);else if(v instanceof Do)for(let P=0;P<Rs.members.length;P++)u.push(Rs.members[P].name)}return u}getBinderUniforms(){const u=[];for(const d in this.binders){const v=this.binders[d];if(v instanceof td||v instanceof oa||v instanceof ga)for(const P of v.uniformNames)u.push(P)}return u}getPaintVertexBuffers(){return this._buffers}getUniforms(u,d){const v=[];for(const P in this.binders){const D=this.binders[P];if(D instanceof td||D instanceof oa||D instanceof ga){for(const O of D.uniformNames)if(d[O]){const j=D.getBinding(u,d[O],O);v.push({name:O,property:P,binding:j})}}}return v}setUniforms(u,d,v,P){for(const{name:D,property:O,binding:j}of d)this.binders[O].setUniform(j,P,v.get(O),D)}updatePaintBuffers(u){this._buffers=[];for(const d in this.binders){const v=this.binders[d];if(u&&v instanceof Do){const P=u.fromScale===2?v.zoomInPaintVertexBuffer:v.zoomOutPaintVertexBuffer;P&&this._buffers.push(P)}else(v instanceof Io||v instanceof ga)&&v.paintVertexBuffer&&this._buffers.push(v.paintVertexBuffer)}}upload(u){for(const d in this.binders){const v=this.binders[d];(v instanceof Io||v instanceof ga||v instanceof Do)&&v.upload(u)}this.updatePaintBuffers()}destroy(){for(const u in this.binders){const d=this.binders[u];(d instanceof Io||d instanceof ga||d instanceof Do)&&d.destroy()}}}class Cd{constructor(u,d,v=()=>!0){this.programConfigurations={};for(const P of u)this.programConfigurations[P.id]=new Og(P,d,v);this.needsUpload=!1,this._featureMap=new Wa,this._bufferOffset=0}populatePaintArrays(u,d,v,P,D,O){for(const j in this.programConfigurations)this.programConfigurations[j].populatePaintArrays(u,d,P,D,O);d.id!==void 0&&this._featureMap.add(d.id,v,this._bufferOffset,u),this._bufferOffset=u,this.needsUpload=!0}updatePaintArrays(u,d,v,P){for(const D of v)this.needsUpload=this.programConfigurations[D.id].updatePaintArrays(u,this._featureMap,d,D,P)||this.needsUpload}get(u){return this.programConfigurations[u]}upload(u){if(this.needsUpload){for(const d in this.programConfigurations)this.programConfigurations[d].upload(u);this.needsUpload=!1}}destroy(){for(const u in this.programConfigurations)this.programConfigurations[u].destroy()}}function Rg(h,u){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[h]||[h.replace(`${u}-`,"").replace(/-/g,"_")]}function nc(h,u,d){const v={color:{source:qt,composite:A},number:{source:E,composite:qt}},P=function(D){return{"line-pattern":{source:On,composite:On},"fill-pattern":{source:On,composite:On},"fill-extrusion-pattern":{source:On,composite:On}}[D]}(h);return P&&P[d]||v[u][d]}Gr("ConstantBinder",td),Gr("CrossFadedConstantBinder",oa),Gr("SourceExpressionBinder",Io),Gr("CrossFadedCompositeBinder",Do),Gr("CompositeExpressionBinder",ga),Gr("ProgramConfiguration",Og,{omit:["_buffers"]}),Gr("ProgramConfigurationSet",Cd);const $c=Math.pow(2,14)-1,Bg=-$c-1;function Ec(h){const u=Le/h.extent,d=h.loadGeometry();for(let v=0;v<d.length;v++){const P=d[v];for(let D=0;D<P.length;D++){const O=P[D],j=Math.round(O.x*u),K=Math.round(O.y*u);O.x=Ve(j,Bg,$c),O.y=Ve(K,Bg,$c),(j<O.x||j>O.x+1||K<O.y||K>O.y+1)&&De("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return d}function hh(h,u){return{type:h.type,id:h.id,properties:h.properties,geometry:u?Ec(h):[]}}const Sd=-32768;function Lm(h,u,d,v,P){h.emplaceBack(Sd+8*u+v,Sd+8*d+P)}class pf{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(d=>d.id),this.index=u.index,this.hasPattern=!1,this.layoutVertexArray=new jt,this.indexArray=new Sr,this.segments=new Ei,this.programConfigurations=new Cd(u.layers,u.zoom),this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(u,d,v){const P=this.layers[0],D=[];let O=null,j=!1,K=P.type==="heatmap";if(P.type==="circle"){const ce=P;O=ce.layout.get("circle-sort-key"),j=!O.isConstant(),K=K||ce.paint.get("circle-pitch-alignment")==="map"}const ee=K?d.subdivisionGranularity.circle:1;for(const{feature:ce,id:ve,index:Re,sourceLayerIndex:Ue}of u){const qe=this.layers[0]._featureFilter.needGeometry,st=hh(ce,qe);if(!this.layers[0]._featureFilter.filter(new Qt(this.zoom),st,v))continue;const xt=j?O.evaluate(st,{},v):void 0,It={id:ve,properties:ce.properties,type:ce.type,sourceLayerIndex:Ue,index:Re,geometry:qe?st.geometry:Ec(ce),patterns:{},sortKey:xt};D.push(It)}j&&D.sort((ce,ve)=>ce.sortKey-ve.sortKey);for(const ce of D){const{geometry:ve,index:Re,sourceLayerIndex:Ue}=ce,qe=u[Re].feature;this.addFeature(ce,ve,Re,v,ee),d.featureIndex.insert(qe,ve,Re,Ue,this.index)}}update(u,d,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,d,this.stateDependentLayers,v)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,wi),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(u,d,v,P,D=1){let O;switch(D){case 1:O=[0,7];break;case 3:O=[0,2,5,7];break;case 5:O=[0,1,3,4,6,7];break;case 7:O=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${D}; valid values are 1, 3, 5, 7.`)}const j=O.length;for(const K of d)for(const ee of K){const ce=ee.x,ve=ee.y;if(ce<0||ce>=Le||ve<0||ve>=Le)continue;const Re=this.segments.prepareSegment(j*j,this.layoutVertexArray,this.indexArray,u.sortKey),Ue=Re.vertexLength;for(let qe=0;qe<j;qe++)for(let st=0;st<j;st++)Lm(this.layoutVertexArray,ce,ve,O[st],O[qe]);for(let qe=0;qe<j-1;qe++)for(let st=0;st<j-1;st++){const xt=Ue+qe*j+st,It=Ue+(qe+1)*j+st;this.indexArray.emplaceBack(xt,It+1,xt+1),this.indexArray.emplaceBack(xt,It,It+1)}Re.vertexLength+=j*j,Re.primitiveLength+=(j-1)*(j-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,v,{},P)}}function Pm(h,u){for(let d=0;d<h.length;d++)if(Ld(u,h[d]))return!0;for(let d=0;d<u.length;d++)if(Ld(h,u[d]))return!0;return!!iy(h,u)}function Sp(h,u,d){return!!Ld(h,u)||!!Ng(u,h,d)}function Hf(h,u){if(h.length===1)return sy(u,h[0]);for(let d=0;d<u.length;d++){const v=u[d];for(let P=0;P<v.length;P++)if(Ld(h,v[P]))return!0}for(let d=0;d<h.length;d++)if(sy(u,h[d]))return!0;for(let d=0;d<u.length;d++)if(iy(h,u[d]))return!0;return!1}function Em(h,u,d){if(h.length>1){if(iy(h,u))return!0;for(let v=0;v<u.length;v++)if(Ng(u[v],h,d))return!0}for(let v=0;v<h.length;v++)if(Ng(h[v],u,d))return!0;return!1}function iy(h,u){if(h.length===0||u.length===0)return!1;for(let d=0;d<h.length-1;d++){const v=h[d],P=h[d+1];for(let D=0;D<u.length-1;D++)if(Y_(v,P,u[D],u[D+1]))return!0}return!1}function Y_(h,u,d,v){return Ae(h,d,v)!==Ae(u,d,v)&&Ae(h,u,d)!==Ae(h,u,v)}function Ng(h,u,d){const v=d*d;if(u.length===1)return h.distSqr(u[0])<v;for(let P=1;P<u.length;P++)if(Mm(h,u[P-1],u[P])<v)return!0;return!1}function Mm(h,u,d){const v=u.distSqr(d);if(v===0)return h.distSqr(u);const P=((h.x-u.x)*(d.x-u.x)+(h.y-u.y)*(d.y-u.y))/v;return h.distSqr(P<0?u:P>1?d:d.sub(u)._mult(P)._add(u))}function sy(h,u){for(let d=0;d<h.length;d++)if(Ld(h[d],u))return!0;return!1}function Ld(h,u){let d=!1;for(let v=0,P=h.length-1;v<h.length;P=v++){const D=h[v],O=h[P];D.y>u.y!=O.y>u.y&&u.x<(O.x-D.x)*(u.y-D.y)/(O.y-D.y)+D.x&&(d=!d)}return d}function oy(h,u,d){const v=d[0],P=d[2];if(h.x<v.x&&u.x<v.x||h.x>P.x&&u.x>P.x||h.y<v.y&&u.y<v.y||h.y>P.y&&u.y>P.y)return!1;const D=Ae(h,u,d[0]);return D!==Ae(h,u,d[1])||D!==Ae(h,u,d[2])||D!==Ae(h,u,d[3])}function mf(h,u,d){const v=u.paint.get(h).value;return v.kind==="constant"?v.value:d.programConfigurations.get(u.id).getMaxValue(h)}function Fg(h){return Math.sqrt(h[0]*h[0]+h[1]*h[1])}function Tm(h,u,d,v,P){if(!u[0]&&!u[1])return h;const D=R.convert(u)._mult(P);d==="viewport"&&D._rotate(-v);const O=[];for(let j=0;j<h.length;j++)O.push(h[j].sub(D));return O}let Am,ay;Gr("CircleBucket",pf,{omit:["layers"]});var ly={get paint(){return ay=ay||new pe({"circle-radius":new I($e.paint_circle["circle-radius"]),"circle-color":new I($e.paint_circle["circle-color"]),"circle-blur":new I($e.paint_circle["circle-blur"]),"circle-opacity":new I($e.paint_circle["circle-opacity"]),"circle-translate":new S($e.paint_circle["circle-translate"]),"circle-translate-anchor":new S($e.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new S($e.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new S($e.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new I($e.paint_circle["circle-stroke-width"]),"circle-stroke-color":new I($e.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new I($e.paint_circle["circle-stroke-opacity"])})},get layout(){return Am=Am||new pe({"circle-sort-key":new I($e.layout_circle["circle-sort-key"])})}};class ow extends Fe{constructor(u){super(u,ly)}createBucket(u){return new pf(u)}queryRadius(u){const d=u;return mf("circle-radius",this,d)+mf("circle-stroke-width",this,d)+Fg(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:u,feature:d,featureState:v,geometry:P,transform:D,pixelsToTileUnits:O,unwrappedTileID:j,getElevation:K}){const ee=Tm(u,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-D.bearingInRadians,O),ce=this.paint.get("circle-radius").evaluate(d,v)+this.paint.get("circle-stroke-width").evaluate(d,v),ve=this.paint.get("circle-pitch-alignment")==="map",Re=ve?ee:function(qe,st,xt,It){return qe.map(fn=>uy(fn,st,xt,It))}(ee,D,j,K),Ue=ve?ce*O:ce;for(const qe of P)for(const st of qe){const xt=ve?st:uy(st,D,j,K);let It=Ue;const fn=D.projectTileCoordinates(st.x,st.y,j,K).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?It*=fn/D.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(It*=D.cameraToCenterDistance/fn),Sp(Re,xt,It))return!0}return!1}}function uy(h,u,d,v){const P=u.projectTileCoordinates(h.x,h.y,d,v).point;return new R((.5*P.x+.5)*u.width,(.5*-P.y+.5)*u.height)}class Pd extends pf{}let cy;Gr("HeatmapBucket",Pd,{omit:["layers"]});var X_={get paint(){return cy=cy||new pe({"heatmap-radius":new I($e.paint_heatmap["heatmap-radius"]),"heatmap-weight":new I($e.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new S($e.paint_heatmap["heatmap-intensity"]),"heatmap-color":new te($e.paint_heatmap["heatmap-color"]),"heatmap-opacity":new S($e.paint_heatmap["heatmap-opacity"])})}};function hy(h,{width:u,height:d},v,P){if(P){if(P instanceof Uint8ClampedArray)P=new Uint8Array(P.buffer);else if(P.length!==u*d*v)throw new RangeError(`mismatched image size. expected: ${P.length} but got: ${u*d*v}`)}else P=new Uint8Array(u*d*v);return h.width=u,h.height=d,h.data=P,h}function dy(h,{width:u,height:d},v){if(u===h.width&&d===h.height)return;const P=hy({},{width:u,height:d},v);fy(h,P,{x:0,y:0},{x:0,y:0},{width:Math.min(h.width,u),height:Math.min(h.height,d)},v),h.width=u,h.height=d,h.data=P.data}function fy(h,u,d,v,P,D){if(P.width===0||P.height===0)return u;if(P.width>h.width||P.height>h.height||d.x>h.width-P.width||d.y>h.height-P.height)throw new RangeError("out of range source coordinates for image copy");if(P.width>u.width||P.height>u.height||v.x>u.width-P.width||v.y>u.height-P.height)throw new RangeError("out of range destination coordinates for image copy");const O=h.data,j=u.data;if(O===j)throw new Error("srcData equals dstData, so image is already copied");for(let K=0;K<P.height;K++){const ee=((d.y+K)*h.width+d.x)*D,ce=((v.y+K)*u.width+v.x)*D;for(let ve=0;ve<P.width*D;ve++)j[ce+ve]=O[ee+ve]}return u}class km{constructor(u,d){hy(this,u,1,d)}resize(u){dy(this,u,1)}clone(){return new km({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(u,d,v,P,D){fy(u,d,v,P,D,1)}}class Pl{constructor(u,d){hy(this,u,4,d)}resize(u){dy(this,u,4)}replace(u,d){d?this.data.set(u):this.data=u instanceof Uint8ClampedArray?new Uint8Array(u.buffer):u}clone(){return new Pl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(u,d,v,P,D){fy(u,d,v,P,D,4)}}function zg(h){const u={},d=h.resolution||256,v=h.clips?h.clips.length:1,P=h.image||new Pl({width:d,height:v});if(Math.log(d)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${d}`);const D=(O,j,K)=>{u[h.evaluationKey]=K;const ee=h.expression.evaluate(u);P.data[O+j+0]=Math.floor(255*ee.r/ee.a),P.data[O+j+1]=Math.floor(255*ee.g/ee.a),P.data[O+j+2]=Math.floor(255*ee.b/ee.a),P.data[O+j+3]=Math.floor(255*ee.a)};if(h.clips)for(let O=0,j=0;O<v;++O,j+=4*d)for(let K=0,ee=0;K<d;K++,ee+=4){const ce=K/(d-1),{start:ve,end:Re}=h.clips[O];D(j,ee,ve*(1-ce)+Re*ce)}else for(let O=0,j=0;O<d;O++,j+=4)D(0,j,O/(d-1));return P}Gr("AlphaImage",km),Gr("RGBAImage",Pl);const Im="big-fb";class py extends Fe{createBucket(u){return new Pd(u)}constructor(u){super(u,X_),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=zg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Im)&&this.heatmapFbos.delete(Im)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Dm;var Lp={get paint(){return Dm=Dm||new pe({"hillshade-illumination-direction":new S($e.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new S($e.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new S($e.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new S($e.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new S($e.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new S($e.paint_hillshade["hillshade-accent-color"])})}};class zi extends Fe{constructor(u){super(u,Lp)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const jg=dn([{name:"a_pos",components:2,type:"Int16"}],4),{members:my}=jg;function Ud(h,u,d){const v=d.patternDependencies;let P=!1;for(const D of u){const O=D.paint.get(`${h}-pattern`);O.isConstant()||(P=!0);const j=O.constantOr(null);j&&(P=!0,v[j.to]=!0,v[j.from]=!0)}return P}function gy(h,u,d,v,P){const D=P.patternDependencies;for(const O of u){const j=O.paint.get(`${h}-pattern`).value;if(j.kind!=="constant"){let K=j.evaluate({zoom:v-1},d,{},P.availableImages),ee=j.evaluate({zoom:v},d,{},P.availableImages),ce=j.evaluate({zoom:v+1},d,{},P.availableImages);K=K&&K.name?K.name:K,ee=ee&&ee.name?ee.name:ee,ce=ce&&ce.name?ce.name:ce,D[K]=!0,D[ee]=!0,D[ce]=!0,d.patterns[O.id]={min:K,mid:ee,max:ce}}}return d}function Ug(h,u,d,v,P){let D;if(P===function(O,j,K,ee){let ce=0;for(let ve=j,Re=K-ee;ve<K;ve+=ee)ce+=(O[Re]-O[ve])*(O[ve+1]+O[Re+1]),Re=ve;return ce}(h,u,d,v)>0)for(let O=u;O<d;O+=v)D=n1(O/v|0,h[O],h[O+1],D);else for(let O=d-v;O>=u;O-=v)D=n1(O/v|0,h[O],h[O+1],D);return D&&Pp(D,D.next)&&(Rm(D),D=D.next),D}function gf(h,u){if(!h)return h;u||(u=h);let d,v=h;do if(d=!1,v.steiner||!Pp(v,v.next)&&ya(v.prev,v,v.next)!==0)v=v.next;else{if(Rm(v),v=u=v.prev,v===v.next)break;d=!0}while(d||v!==u);return u}function Zl(h,u,d,v,P,D,O){if(!h)return;!O&&D&&function(K,ee,ce,ve){let Re=K;do Re.z===0&&(Re.z=yy(Re.x,Re.y,ee,ce,ve)),Re.prevZ=Re.prev,Re.nextZ=Re.next,Re=Re.next;while(Re!==K);Re.prevZ.nextZ=null,Re.prevZ=null,function(Ue){let qe,st=1;do{let xt,It=Ue;Ue=null;let fn=null;for(qe=0;It;){qe++;let $t=It,Oe=0;for(let Wt=0;Wt<st&&(Oe++,$t=$t.nextZ,$t);Wt++);let ft=st;for(;Oe>0||ft>0&&$t;)Oe!==0&&(ft===0||!$t||It.z<=$t.z)?(xt=It,It=It.nextZ,Oe--):(xt=$t,$t=$t.nextZ,ft--),fn?fn.nextZ=xt:Ue=xt,xt.prevZ=fn,fn=xt;It=$t}fn.nextZ=null,st*=2}while(qe>1)}(Re)}(h,v,P,D);let j=h;for(;h.prev!==h.next;){const K=h.prev,ee=h.next;if(D?lw(h,v,P,D):aw(h))u.push(K.i,h.i,ee.i),Rm(h),h=ee.next,j=ee.next;else if((h=ee)===j){O?O===1?Zl(h=J_(gf(h),u),u,d,v,P,D,2):O===2&&uw(h,u,d,v,P,D):Zl(gf(h),u,d,v,P,D,1);break}}}function aw(h){const u=h.prev,d=h,v=h.next;if(ya(u,d,v)>=0)return!1;const P=u.x,D=d.x,O=v.x,j=u.y,K=d.y,ee=v.y,ce=Math.min(P,D,O),ve=Math.min(j,K,ee),Re=Math.max(P,D,O),Ue=Math.max(j,K,ee);let qe=v.next;for(;qe!==u;){if(qe.x>=ce&&qe.x<=Re&&qe.y>=ve&&qe.y<=Ue&&qf(P,j,D,K,O,ee,qe.x,qe.y)&&ya(qe.prev,qe,qe.next)>=0)return!1;qe=qe.next}return!0}function lw(h,u,d,v){const P=h.prev,D=h,O=h.next;if(ya(P,D,O)>=0)return!1;const j=P.x,K=D.x,ee=O.x,ce=P.y,ve=D.y,Re=O.y,Ue=Math.min(j,K,ee),qe=Math.min(ce,ve,Re),st=Math.max(j,K,ee),xt=Math.max(ce,ve,Re),It=yy(Ue,qe,u,d,v),fn=yy(st,xt,u,d,v);let $t=h.prevZ,Oe=h.nextZ;for(;$t&&$t.z>=It&&Oe&&Oe.z<=fn;){if($t.x>=Ue&&$t.x<=st&&$t.y>=qe&&$t.y<=xt&&$t!==P&&$t!==O&&qf(j,ce,K,ve,ee,Re,$t.x,$t.y)&&ya($t.prev,$t,$t.next)>=0||($t=$t.prevZ,Oe.x>=Ue&&Oe.x<=st&&Oe.y>=qe&&Oe.y<=xt&&Oe!==P&&Oe!==O&&qf(j,ce,K,ve,ee,Re,Oe.x,Oe.y)&&ya(Oe.prev,Oe,Oe.next)>=0))return!1;Oe=Oe.nextZ}for(;$t&&$t.z>=It;){if($t.x>=Ue&&$t.x<=st&&$t.y>=qe&&$t.y<=xt&&$t!==P&&$t!==O&&qf(j,ce,K,ve,ee,Re,$t.x,$t.y)&&ya($t.prev,$t,$t.next)>=0)return!1;$t=$t.prevZ}for(;Oe&&Oe.z<=fn;){if(Oe.x>=Ue&&Oe.x<=st&&Oe.y>=qe&&Oe.y<=xt&&Oe!==P&&Oe!==O&&qf(j,ce,K,ve,ee,Re,Oe.x,Oe.y)&&ya(Oe.prev,Oe,Oe.next)>=0)return!1;Oe=Oe.nextZ}return!0}function J_(h,u){let d=h;do{const v=d.prev,P=d.next.next;!Pp(v,P)&&e1(v,d,d.next,P)&&Ep(v,P)&&Ep(P,v)&&(u.push(v.i,d.i,P.i),Rm(d),Rm(d.next),d=h=P),d=d.next}while(d!==h);return gf(d)}function uw(h,u,d,v,P,D){let O=h;do{let j=O.next.next;for(;j!==O.prev;){if(O.i!==j.i&&dw(O,j)){let K=t1(O,j);return O=gf(O,O.next),K=gf(K,K.next),Zl(O,u,d,v,P,D,0),void Zl(K,u,d,v,P,D,0)}j=j.next}O=O.next}while(O!==h)}function Q_(h,u){let d=h.x-u.x;return d===0&&(d=h.y-u.y,d===0)&&(d=(h.next.y-h.y)/(h.next.x-h.x)-(u.next.y-u.y)/(u.next.x-u.x)),d}function cw(h,u){const d=function(P,D){let O=D;const j=P.x,K=P.y;let ee,ce=-1/0;if(Pp(P,O))return O;do{if(Pp(P,O.next))return O.next;if(K<=O.y&&K>=O.next.y&&O.next.y!==O.y){const st=O.x+(K-O.y)*(O.next.x-O.x)/(O.next.y-O.y);if(st<=j&&st>ce&&(ce=st,ee=O.x<O.next.x?O:O.next,st===j))return ee}O=O.next}while(O!==D);if(!ee)return null;const ve=ee,Re=ee.x,Ue=ee.y;let qe=1/0;O=ee;do{if(j>=O.x&&O.x>=Re&&j!==O.x&&mc(K<Ue?j:ce,K,Re,Ue,K<Ue?ce:j,K,O.x,O.y)){const st=Math.abs(K-O.y)/(j-O.x);Ep(O,P)&&(st<qe||st===qe&&(O.x>ee.x||O.x===ee.x&&hw(ee,O)))&&(ee=O,qe=st)}O=O.next}while(O!==ve);return ee}(h,u);if(!d)return u;const v=t1(d,h);return gf(v,v.next),gf(d,d.next)}function hw(h,u){return ya(h.prev,h,u.prev)<0&&ya(u.next,h,h.next)<0}function yy(h,u,d,v,P){return(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=(h-d)*P|0)|h<<8))|h<<4))|h<<2))|h<<1))|(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-v)*P|0)|u<<8))|u<<4))|u<<2))|u<<1))<<1}function Vd(h){let u=h,d=h;do(u.x<d.x||u.x===d.x&&u.y<d.y)&&(d=u),u=u.next;while(u!==h);return d}function mc(h,u,d,v,P,D,O,j){return(P-O)*(u-j)>=(h-O)*(D-j)&&(h-O)*(v-j)>=(d-O)*(u-j)&&(d-O)*(D-j)>=(P-O)*(v-j)}function qf(h,u,d,v,P,D,O,j){return!(h===O&&u===j)&&mc(h,u,d,v,P,D,O,j)}function dw(h,u){return h.next.i!==u.i&&h.prev.i!==u.i&&!function(d,v){let P=d;do{if(P.i!==d.i&&P.next.i!==d.i&&P.i!==v.i&&P.next.i!==v.i&&e1(P,P.next,d,v))return!0;P=P.next}while(P!==d);return!1}(h,u)&&(Ep(h,u)&&Ep(u,h)&&function(d,v){let P=d,D=!1;const O=(d.x+v.x)/2,j=(d.y+v.y)/2;do P.y>j!=P.next.y>j&&P.next.y!==P.y&&O<(P.next.x-P.x)*(j-P.y)/(P.next.y-P.y)+P.x&&(D=!D),P=P.next;while(P!==d);return D}(h,u)&&(ya(h.prev,h,u.prev)||ya(h,u.prev,u))||Pp(h,u)&&ya(h.prev,h,h.next)>0&&ya(u.prev,u,u.next)>0)}function ya(h,u,d){return(u.y-h.y)*(d.x-u.x)-(u.x-h.x)*(d.y-u.y)}function Pp(h,u){return h.x===u.x&&h.y===u.y}function e1(h,u,d,v){const P=Om(ya(h,u,d)),D=Om(ya(h,u,v)),O=Om(ya(d,v,h)),j=Om(ya(d,v,u));return P!==D&&O!==j||!(P!==0||!yf(h,d,u))||!(D!==0||!yf(h,v,u))||!(O!==0||!yf(d,h,v))||!(j!==0||!yf(d,u,v))}function yf(h,u,d){return u.x<=Math.max(h.x,d.x)&&u.x>=Math.min(h.x,d.x)&&u.y<=Math.max(h.y,d.y)&&u.y>=Math.min(h.y,d.y)}function Om(h){return h>0?1:h<0?-1:0}function Ep(h,u){return ya(h.prev,h,h.next)<0?ya(h,u,h.next)>=0&&ya(h,h.prev,u)>=0:ya(h,u,h.prev)<0||ya(h,h.next,u)<0}function t1(h,u){const d=vy(h.i,h.x,h.y),v=vy(u.i,u.x,u.y),P=h.next,D=u.prev;return h.next=u,u.prev=h,d.next=P,P.prev=d,v.next=d,d.prev=v,D.next=v,v.prev=D,v}function n1(h,u,d,v){const P=vy(h,u,d);return v?(P.next=v.next,P.prev=v,v.next.prev=P,v.next=P):(P.prev=P,P.next=P),P}function Rm(h){h.next.prev=h.prev,h.prev.next=h.next,h.prevZ&&(h.prevZ.nextZ=h.nextZ),h.nextZ&&(h.nextZ.prevZ=h.prevZ)}function vy(h,u,d){return{i:h,x:u,y:d,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Wf{constructor(u,d){if(d>u)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=u,this._minGranularity=d}getGranularityForZoomLevel(u){return Math.max(Math.floor(this._baseZoomGranularity/(1<<u)),this._minGranularity,1)}}class Bm{constructor(u){this.fill=u.fill,this.line=u.line,this.tile=u.tile,this.stencil=u.stencil,this.circle=u.circle}}Bm.noSubdivision=new Bm({fill:new Wf(0,0),line:new Wf(0,0),tile:new Wf(0,0),stencil:new Wf(0,0),circle:1}),Gr("SubdivisionGranularityExpression",Wf),Gr("SubdivisionGranularitySetting",Bm);const Mp=-32768,Zf=32767;class r1{constructor(u,d){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=u,this._granularityCellSize=Le/u,this._canonical=d}_getKey(u,d){return(u+=32768)<<16|(d+=32768)<<0}_vertexToIndex(u,d){if(u<-32768||d<-32768||u>32767||d>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const v=0|Math.round(u),P=0|Math.round(d),D=this._getKey(v,P);if(this._vertexDictionary.has(D))return this._vertexDictionary.get(D);const O=this._vertexBuffer.length/2;return this._vertexDictionary.set(D,O),this._vertexBuffer.push(v,P),O}_subdivideTrianglesScanline(u){if(this._granularity<2)return function(P,D){const O=[];for(let j=0;j<D.length;j+=3){const K=D[j],ee=D[j+1],ce=D[j+2],ve=P[2*K],Re=P[2*K+1];(P[2*ee]-ve)*(P[2*ce+1]-Re)-(P[2*ee+1]-Re)*(P[2*ce]-ve)>0?(O.push(K),O.push(ce),O.push(ee)):(O.push(K),O.push(ee),O.push(ce))}return O}(this._vertexBuffer,u);const d=[],v=u.length;for(let P=0;P<v;P+=3){const D=[u[P+0],u[P+1],u[P+2]],O=[this._vertexBuffer[2*u[P+0]+0],this._vertexBuffer[2*u[P+0]+1],this._vertexBuffer[2*u[P+1]+0],this._vertexBuffer[2*u[P+1]+1],this._vertexBuffer[2*u[P+2]+0],this._vertexBuffer[2*u[P+2]+1]];let j=1/0,K=1/0,ee=-1/0,ce=-1/0;for(let st=0;st<3;st++){const xt=O[2*st],It=O[2*st+1];j=Math.min(j,xt),ee=Math.max(ee,xt),K=Math.min(K,It),ce=Math.max(ce,It)}if(j===ee||K===ce)continue;const ve=Math.floor(j/this._granularityCellSize),Re=Math.ceil(ee/this._granularityCellSize),Ue=Math.floor(K/this._granularityCellSize),qe=Math.ceil(ce/this._granularityCellSize);if(ve!==Re||Ue!==qe)for(let st=Ue;st<qe;st++){const xt=this._scanlineGenerateVertexRingForCellRow(st,O,D);i1(this._vertexBuffer,xt,d)}else d.push(...D)}return d}_scanlineGenerateVertexRingForCellRow(u,d,v){const P=u*this._granularityCellSize,D=P+this._granularityCellSize,O=[];for(let j=0;j<3;j++){const K=d[2*j],ee=d[2*j+1],ce=d[2*(j+1)%6],ve=d[(2*(j+1)+1)%6],Re=d[2*(j+2)%6],Ue=d[(2*(j+2)+1)%6],qe=ce-K,st=ve-ee,xt=qe===0,It=st===0,fn=(P-ee)/st,$t=(D-ee)/st,Oe=Math.min(fn,$t),ft=Math.max(fn,$t);if(!It&&(Oe>=1||ft<=0)||It&&(ee<P||ee>D)){ve>=P&&ve<=D&&O.push(v[(j+1)%3]);continue}!It&&Oe>0&&O.push(this._vertexToIndex(K+qe*Oe,ee+st*Oe));const Wt=K+qe*Math.max(Oe,0),$n=K+qe*Math.min(ft,1);xt||this._generateIntraEdgeVertices(O,K,ee,ce,ve,Wt,$n),!It&&ft<1&&O.push(this._vertexToIndex(K+qe*ft,ee+st*ft)),(It||ve>=P&&ve<=D)&&O.push(v[(j+1)%3]),!It&&(ve<=P||ve>=D)&&this._generateInterEdgeVertices(O,K,ee,ce,ve,Re,Ue,$n,P,D)}return O}_generateIntraEdgeVertices(u,d,v,P,D,O,j){const K=P-d,ee=D-v,ce=ee===0,ve=ce?Math.min(d,P):Math.min(O,j),Re=ce?Math.max(d,P):Math.max(O,j),Ue=Math.floor(ve/this._granularityCellSize)+1,qe=Math.ceil(Re/this._granularityCellSize)-1;if(ce?d<P:O<j)for(let st=Ue;st<=qe;st++){const xt=st*this._granularityCellSize;u.push(this._vertexToIndex(xt,v+ee*(xt-d)/K))}else for(let st=qe;st>=Ue;st--){const xt=st*this._granularityCellSize;u.push(this._vertexToIndex(xt,v+ee*(xt-d)/K))}}_generateInterEdgeVertices(u,d,v,P,D,O,j,K,ee,ce){const ve=D-v,Re=O-P,Ue=j-D,qe=(ee-D)/Ue,st=(ce-D)/Ue,xt=Math.min(qe,st),It=Math.max(qe,st),fn=P+Re*xt;let $t=Math.floor(Math.min(fn,K)/this._granularityCellSize)+1,Oe=Math.ceil(Math.max(fn,K)/this._granularityCellSize)-1,ft=K<fn;const Wt=Ue===0;if(Wt&&(j===ee||j===ce))return;if(Wt||xt>=1||It<=0){const _r=v-j,Wn=O+(d-O)*Math.min((ee-j)/_r,(ce-j)/_r);$t=Math.floor(Math.min(Wn,K)/this._granularityCellSize)+1,Oe=Math.ceil(Math.max(Wn,K)/this._granularityCellSize)-1,ft=K<Wn}const $n=ve>0?ce:ee;if(ft)for(let _r=$t;_r<=Oe;_r++)u.push(this._vertexToIndex(_r*this._granularityCellSize,$n));else for(let _r=Oe;_r>=$t;_r--)u.push(this._vertexToIndex(_r*this._granularityCellSize,$n))}_generateOutline(u){const d=[];for(const v of u){const P=$d(v,this._granularity,!0),D=this._pointArrayToIndices(P),O=[];for(let j=1;j<D.length;j++)O.push(D[j-1]),O.push(D[j]);d.push(O)}return d}_handlePoles(u){let d=!1,v=!1;this._canonical&&(this._canonical.y===0&&(d=!0),this._canonical.y===(1<<this._canonical.z)-1&&(v=!0)),(d||v)&&this._fillPoles(u,d,v)}_ensureNoPoleVertices(){const u=this._vertexBuffer;for(let d=0;d<u.length;d+=2){const v=u[d+1];v===Mp&&(u[d+1]=-32767),v===Zf&&(u[d+1]=32766)}}_generatePoleQuad(u,d,v,P,D,O){P>D!=(O===Mp)?(u.push(d),u.push(v),u.push(this._vertexToIndex(P,O)),u.push(v),u.push(this._vertexToIndex(D,O)),u.push(this._vertexToIndex(P,O))):(u.push(v),u.push(d),u.push(this._vertexToIndex(P,O)),u.push(this._vertexToIndex(D,O)),u.push(v),u.push(this._vertexToIndex(P,O)))}_fillPoles(u,d,v){const P=this._vertexBuffer,D=Le,O=u.length;for(let j=2;j<O;j+=3){const K=u[j-2],ee=u[j-1],ce=u[j],ve=P[2*K],Re=P[2*K+1],Ue=P[2*ee],qe=P[2*ee+1],st=P[2*ce],xt=P[2*ce+1];d&&(Re===0&&qe===0&&this._generatePoleQuad(u,K,ee,ve,Ue,Mp),qe===0&&xt===0&&this._generatePoleQuad(u,ee,ce,Ue,st,Mp),xt===0&&Re===0&&this._generatePoleQuad(u,ce,K,st,ve,Mp)),v&&(Re===D&&qe===D&&this._generatePoleQuad(u,K,ee,ve,Ue,Zf),qe===D&&xt===D&&this._generatePoleQuad(u,ee,ce,Ue,st,Zf),xt===D&&Re===D&&this._generatePoleQuad(u,ce,K,st,ve,Zf))}}_initializeVertices(u){for(let d=0;d<u.length;d+=2)this._vertexToIndex(u[d],u[d+1])}subdividePolygonInternal(u,d){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:v,holeIndices:P}=function(j){const K=[],ee=[];for(const ce of j)if(ce.length!==0){ce!==j[0]&&K.push(ee.length/2);for(let ve=0;ve<ce.length;ve++)ee.push(ce[ve].x),ee.push(ce[ve].y)}return{flattened:ee,holeIndices:K}}(u);let D;this._initializeVertices(v);try{const j=function(ee,ce,ve=2){const Re=ce&&ce.length,Ue=Re?ce[0]*ve:ee.length;let qe=Ug(ee,0,Ue,ve,!0);const st=[];if(!qe||qe.next===qe.prev)return st;let xt,It,fn;if(Re&&(qe=function($t,Oe,ft,Wt){const $n=[];for(let _r=0,Wn=Oe.length;_r<Wn;_r++){const rr=Ug($t,Oe[_r]*Wt,_r<Wn-1?Oe[_r+1]*Wt:$t.length,Wt,!1);rr===rr.next&&(rr.steiner=!0),$n.push(Vd(rr))}$n.sort(Q_);for(let _r=0;_r<$n.length;_r++)ft=cw($n[_r],ft);return ft}(ee,ce,qe,ve)),ee.length>80*ve){xt=1/0,It=1/0;let $t=-1/0,Oe=-1/0;for(let ft=ve;ft<Ue;ft+=ve){const Wt=ee[ft],$n=ee[ft+1];Wt<xt&&(xt=Wt),$n<It&&(It=$n),Wt>$t&&($t=Wt),$n>Oe&&(Oe=$n)}fn=Math.max($t-xt,Oe-It),fn=fn!==0?32767/fn:0}return Zl(qe,st,ve,xt,It,fn,0),st}(v,P),K=this._convertIndices(v,j);D=this._subdivideTrianglesScanline(K)}catch(j){console.error(j)}let O=[];return d&&(O=this._generateOutline(u)),this._ensureNoPoleVertices(),this._handlePoles(D),{verticesFlattened:this._vertexBuffer,indicesTriangles:D,indicesLineList:O}}_convertIndices(u,d){const v=[];for(let P=0;P<d.length;P++)v.push(this._vertexToIndex(u[2*d[P]],u[2*d[P]+1]));return v}_pointArrayToIndices(u){const d=[];for(let v=0;v<u.length;v++){const P=u[v];d.push(this._vertexToIndex(P.x,P.y))}return d}}function Tp(h,u,d,v=!0){return new r1(d,u).subdividePolygonInternal(h,v)}function $d(h,u,d=!1){if(!h||h.length<1)return[];if(h.length<2)return[];const v=h[0],P=h[h.length-1],D=d&&(v.x!==P.x||v.y!==P.y);if(u<2)return D?[...h,h[0]]:[...h];const O=Math.floor(Le/u),j=[];j.push(new R(h[0].x,h[0].y));const K=h.length,ee=D?K:K-1;for(let ce=0;ce<ee;ce++){const ve=h[ce],Re=ce<K-1?h[ce+1]:h[0],Ue=ve.x,qe=ve.y,st=Re.x,xt=Re.y,It=Ue!==st,fn=qe!==xt;if(!It&&!fn)continue;const $t=st-Ue,Oe=xt-qe,ft=Math.abs($t),Wt=Math.abs(Oe);let $n=Ue,_r=qe;for(;;){const rr=$t>0?(Math.floor($n/O)+1)*O:(Math.ceil($n/O)-1)*O,Ar=Oe>0?(Math.floor(_r/O)+1)*O:(Math.ceil(_r/O)-1)*O,xr=Math.abs($n-rr),kr=Math.abs(_r-Ar),lr=Math.abs($n-st),Qr=Math.abs(_r-xt),_i=It?xr/ft:Number.POSITIVE_INFINITY,hi=fn?kr/Wt:Number.POSITIVE_INFINITY;if((lr<=xr||!It)&&(Qr<=kr||!fn))break;if(_i<hi&&It||!fn){$n=rr,_r+=Oe*_i;const si=new R($n,Math.round(_r));j[j.length-1].x===si.x&&j[j.length-1].y===si.y||j.push(si)}else{$n+=$t*hi,_r=Ar;const si=new R(Math.round($n),_r);j[j.length-1].x===si.x&&j[j.length-1].y===si.y||j.push(si)}}const Wn=new R(st,xt);j[j.length-1].x===Wn.x&&j[j.length-1].y===Wn.y||j.push(Wn)}return j}function i1(h,u,d){if(u.length===0)throw new Error("Subdivision vertex ring is empty.");let v=0,P=h[2*u[0]];for(let K=1;K<u.length;K++){const ee=h[2*u[K]];ee<P&&(P=ee,v=K)}const D=u.length;let O=v,j=(O+1)%D;for(;;){const K=O-1>=0?O-1:D-1,ee=(j+1)%D,ce=h[2*u[K]],ve=h[2*u[ee]],Re=h[2*u[O]],Ue=h[2*u[O]+1],qe=h[2*u[j]+1];let st=!1;if(ce<ve)st=!0;else if(ce>ve)st=!1;else{const xt=qe-Ue,It=-(h[2*u[j]]-Re),fn=Ue<qe?1:-1;((ce-Re)*xt+(h[2*u[K]+1]-Ue)*It)*fn>((ve-Re)*xt+(h[2*u[ee]+1]-Ue)*It)*fn&&(st=!0)}if(st){const xt=u[K],It=u[O],fn=u[j];xt!==It&&xt!==fn&&It!==fn&&d.push(fn,It,xt),O--,O<0&&(O=D-1)}else{const xt=u[ee],It=u[O],fn=u[j];xt!==It&&xt!==fn&&It!==fn&&d.push(fn,It,xt),j++,j>=D&&(j=0)}if(K===ee)break}}function _y(h,u,d,v,P,D,O,j,K){const ee=P.length/2,ce=O&&j&&K;if(ee<Ei.MAX_VERTEX_ARRAY_LENGTH){const ve=u.prepareSegment(ee,d,v),Re=ve.vertexLength;for(let st=0;st<D.length;st+=3)v.emplaceBack(Re+D[st],Re+D[st+1],Re+D[st+2]);let Ue,qe;ve.vertexLength+=ee,ve.primitiveLength+=D.length/3,ce&&(qe=O.prepareSegment(ee,d,j),Ue=qe.vertexLength,qe.vertexLength+=ee);for(let st=0;st<P.length;st+=2)h(P[st],P[st+1]);if(ce)for(let st=0;st<K.length;st++){const xt=K[st];for(let It=1;It<xt.length;It+=2)j.emplaceBack(Ue+xt[It-1],Ue+xt[It]);qe.primitiveLength+=xt.length/2}}else(function(ve,Re,Ue,qe,st,xt){const It=[];for(let Wt=0;Wt<qe.length/2;Wt++)It.push(-1);const fn={count:0};let $t=0,Oe=ve.getOrCreateLatestSegment(Re,Ue),ft=Oe.vertexLength;for(let Wt=2;Wt<st.length;Wt+=3){const $n=st[Wt-2],_r=st[Wt-1],Wn=st[Wt];let rr=It[$n]<$t,Ar=It[_r]<$t,xr=It[Wn]<$t;Oe.vertexLength+((rr?1:0)+(Ar?1:0)+(xr?1:0))>Ei.MAX_VERTEX_ARRAY_LENGTH&&(Oe=ve.createNewSegment(Re,Ue),$t=fn.count,rr=!0,Ar=!0,xr=!0,ft=0);const kr=vf(It,qe,xt,fn,$n,rr,Oe),lr=vf(It,qe,xt,fn,_r,Ar,Oe),Qr=vf(It,qe,xt,fn,Wn,xr,Oe);Ue.emplaceBack(ft+kr-$t,ft+lr-$t,ft+Qr-$t),Oe.primitiveLength++}})(u,d,v,P,D,h),ce&&function(ve,Re,Ue,qe,st,xt){const It=[];for(let Wt=0;Wt<qe.length/2;Wt++)It.push(-1);const fn={count:0};let $t=0,Oe=ve.getOrCreateLatestSegment(Re,Ue),ft=Oe.vertexLength;for(let Wt=0;Wt<st.length;Wt++){const $n=st[Wt];for(let _r=1;_r<st[Wt].length;_r+=2){const Wn=$n[_r-1],rr=$n[_r];let Ar=It[Wn]<$t,xr=It[rr]<$t;Oe.vertexLength+((Ar?1:0)+(xr?1:0))>Ei.MAX_VERTEX_ARRAY_LENGTH&&(Oe=ve.createNewSegment(Re,Ue),$t=fn.count,Ar=!0,xr=!0,ft=0);const kr=vf(It,qe,xt,fn,Wn,Ar,Oe),lr=vf(It,qe,xt,fn,rr,xr,Oe);Ue.emplaceBack(ft+kr-$t,ft+lr-$t),Oe.primitiveLength++}}}(O,d,j,P,K,h),u.forceNewSegmentOnNextPrepare(),O==null||O.forceNewSegmentOnNextPrepare()}function vf(h,u,d,v,P,D,O){if(D){const j=v.count;return d(u[2*P],u[2*P+1]),h[P]=v.count,v.count++,O.vertexLength++,j}return h[P]}class Vg{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(d=>d.id),this.index=u.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Vt,this.indexArray=new Sr,this.indexArray2=new mr,this.programConfigurations=new Cd(u.layers,u.zoom),this.segments=new Ei,this.segments2=new Ei,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(u,d,v){this.hasPattern=Ud("fill",this.layers,d);const P=this.layers[0].layout.get("fill-sort-key"),D=!P.isConstant(),O=[];for(const{feature:j,id:K,index:ee,sourceLayerIndex:ce}of u){const ve=this.layers[0]._featureFilter.needGeometry,Re=hh(j,ve);if(!this.layers[0]._featureFilter.filter(new Qt(this.zoom),Re,v))continue;const Ue=D?P.evaluate(Re,{},v,d.availableImages):void 0,qe={id:K,properties:j.properties,type:j.type,sourceLayerIndex:ce,index:ee,geometry:ve?Re.geometry:Ec(j),patterns:{},sortKey:Ue};O.push(qe)}D&&O.sort((j,K)=>j.sortKey-K.sortKey);for(const j of O){const{geometry:K,index:ee,sourceLayerIndex:ce}=j;if(this.hasPattern){const ve=gy("fill",this.layers,j,this.zoom,d);this.patternFeatures.push(ve)}else this.addFeature(j,K,ee,v,{},d.subdivisionGranularity);d.featureIndex.insert(u[ee].feature,K,ee,ce,this.index)}}update(u,d,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,d,this.stateDependentLayers,v)}addFeatures(u,d,v){for(const P of this.patternFeatures)this.addFeature(P,P.geometry,P.index,d,v,u.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,my),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.indexBuffer2=u.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(u,d,v,P,D,O){for(const j of sl(d,500)){const K=Tp(j,P,O.fill.getGranularityForZoomLevel(P.z)),ee=this.layoutVertexArray;_y((ce,ve)=>{ee.emplaceBack(ce,ve)},this.segments,this.layoutVertexArray,this.indexArray,K.verticesFlattened,K.indicesTriangles,this.segments2,this.indexArray2,K.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,v,D,P)}}let nd,_f;Gr("FillBucket",Vg,{omit:["layers","patternFeatures"]});var fw={get paint(){return _f=_f||new pe({"fill-antialias":new S($e.paint_fill["fill-antialias"]),"fill-opacity":new I($e.paint_fill["fill-opacity"]),"fill-color":new I($e.paint_fill["fill-color"]),"fill-outline-color":new I($e.paint_fill["fill-outline-color"]),"fill-translate":new S($e.paint_fill["fill-translate"]),"fill-translate-anchor":new S($e.paint_fill["fill-translate-anchor"]),"fill-pattern":new F($e.paint_fill["fill-pattern"])})},get layout(){return nd=nd||new pe({"fill-sort-key":new I($e.layout_fill["fill-sort-key"])})}};class s1 extends Fe{constructor(u){super(u,fw)}recalculate(u,d){super.recalculate(u,d);const v=this.paint._values["fill-outline-color"];v.value.kind==="constant"&&v.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(u){return new Vg(u)}queryRadius(){return Fg(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:u,geometry:d,transform:v,pixelsToTileUnits:P}){return Hf(Tm(u,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-v.bearingInRadians,P),d)}isTileClipped(){return!0}}const pw=dn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),mw=dn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:gw}=pw;var by,o1,xy,a1,wy,l1,u1,$g={};function Cy(){if(o1)return by;o1=1;var h=w();function u(P,D,O,j,K){this.properties={},this.extent=O,this.type=0,this._pbf=P,this._geometry=-1,this._keys=j,this._values=K,P.readFields(d,this,D)}function d(P,D,O){P==1?D.id=O.readVarint():P==2?function(j,K){for(var ee=j.readVarint()+j.pos;j.pos<ee;){var ce=K._keys[j.readVarint()],ve=K._values[j.readVarint()];K.properties[ce]=ve}}(O,D):P==3?D.type=O.readVarint():P==4&&(D._geometry=O.pos)}function v(P){for(var D,O,j=0,K=0,ee=P.length,ce=ee-1;K<ee;ce=K++)j+=((O=P[ce]).x-(D=P[K]).x)*(D.y+O.y);return j}return by=u,u.types=["Unknown","Point","LineString","Polygon"],u.prototype.loadGeometry=function(){var P=this._pbf;P.pos=this._geometry;for(var D,O=P.readVarint()+P.pos,j=1,K=0,ee=0,ce=0,ve=[];P.pos<O;){if(K<=0){var Re=P.readVarint();j=7&Re,K=Re>>3}if(K--,j===1||j===2)ee+=P.readSVarint(),ce+=P.readSVarint(),j===1&&(D&&ve.push(D),D=[]),D.push(new h(ee,ce));else{if(j!==7)throw new Error("unknown command "+j);D&&D.push(D[0].clone())}}return D&&ve.push(D),ve},u.prototype.bbox=function(){var P=this._pbf;P.pos=this._geometry;for(var D=P.readVarint()+P.pos,O=1,j=0,K=0,ee=0,ce=1/0,ve=-1/0,Re=1/0,Ue=-1/0;P.pos<D;){if(j<=0){var qe=P.readVarint();O=7&qe,j=qe>>3}if(j--,O===1||O===2)(K+=P.readSVarint())<ce&&(ce=K),K>ve&&(ve=K),(ee+=P.readSVarint())<Re&&(Re=ee),ee>Ue&&(Ue=ee);else if(O!==7)throw new Error("unknown command "+O)}return[ce,Re,ve,Ue]},u.prototype.toGeoJSON=function(P,D,O){var j,K,ee=this.extent*Math.pow(2,O),ce=this.extent*P,ve=this.extent*D,Re=this.loadGeometry(),Ue=u.types[this.type];function qe(It){for(var fn=0;fn<It.length;fn++){var $t=It[fn];It[fn]=[360*($t.x+ce)/ee-180,360/Math.PI*Math.atan(Math.exp((180-360*($t.y+ve)/ee)*Math.PI/180))-90]}}switch(this.type){case 1:var st=[];for(j=0;j<Re.length;j++)st[j]=Re[j][0];qe(Re=st);break;case 2:for(j=0;j<Re.length;j++)qe(Re[j]);break;case 3:for(Re=function(It){var fn=It.length;if(fn<=1)return[It];for(var $t,Oe,ft=[],Wt=0;Wt<fn;Wt++){var $n=v(It[Wt]);$n!==0&&(Oe===void 0&&(Oe=$n<0),Oe===$n<0?($t&&ft.push($t),$t=[It[Wt]]):$t.push(It[Wt]))}return $t&&ft.push($t),ft}(Re),j=0;j<Re.length;j++)for(K=0;K<Re[j].length;K++)qe(Re[j][K])}Re.length===1?Re=Re[0]:Ue="Multi"+Ue;var xt={type:"Feature",geometry:{type:Ue,coordinates:Re},properties:this.properties};return"id"in this&&(xt.id=this.id),xt},by}function Sy(){if(a1)return xy;a1=1;var h=Cy();function u(v,P){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=v,this._keys=[],this._values=[],this._features=[],v.readFields(d,this,P),this.length=this._features.length}function d(v,P,D){v===15?P.version=D.readVarint():v===1?P.name=D.readString():v===5?P.extent=D.readVarint():v===2?P._features.push(D.pos):v===3?P._keys.push(D.readString()):v===4&&P._values.push(function(O){for(var j=null,K=O.readVarint()+O.pos;O.pos<K;){var ee=O.readVarint()>>3;j=ee===1?O.readString():ee===2?O.readFloat():ee===3?O.readDouble():ee===4?O.readVarint64():ee===5?O.readVarint():ee===6?O.readSVarint():ee===7?O.readBoolean():null}return j}(D))}return xy=u,u.prototype.feature=function(v){if(v<0||v>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[v];var P=this._pbf.readVarint()+this._pbf.pos;return new h(this._pbf,P,this.extent,this._keys,this._values)},xy}function Ly(){return u1||(u1=1,$g.VectorTile=function(){if(l1)return wy;l1=1;var h=Sy();function u(d,v,P){if(d===3){var D=new h(P,P.readVarint()+P.pos);D.length&&(v[D.name]=D)}}return wy=function(d,v){this.layers=d.readFields(u,{},v)},wy}(),$g.VectorTileFeature=Cy(),$g.VectorTileLayer=Sy()),$g}var Nm=f(Ly());const yw=Nm.VectorTileFeature.types,Py=Math.pow(2,13);function Ap(h,u,d,v,P,D,O,j){h.emplaceBack(u,d,2*Math.floor(v*Py)+O,P*Py*2,D*Py*2,Math.round(j))}class Ey{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(d=>d.id),this.index=u.index,this.hasPattern=!1,this.layoutVertexArray=new en,this.centroidVertexArray=new Rt,this.indexArray=new Sr,this.programConfigurations=new Cd(u.layers,u.zoom),this.segments=new Ei,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(u,d,v){this.features=[],this.hasPattern=Ud("fill-extrusion",this.layers,d);for(const{feature:P,id:D,index:O,sourceLayerIndex:j}of u){const K=this.layers[0]._featureFilter.needGeometry,ee=hh(P,K);if(!this.layers[0]._featureFilter.filter(new Qt(this.zoom),ee,v))continue;const ce={id:D,sourceLayerIndex:j,index:O,geometry:K?ee.geometry:Ec(P),properties:P.properties,type:P.type,patterns:{}};this.hasPattern?this.features.push(gy("fill-extrusion",this.layers,ce,this.zoom,d)):this.addFeature(ce,ce.geometry,O,v,{},d.subdivisionGranularity),d.featureIndex.insert(P,ce.geometry,O,j,this.index,!0)}}addFeatures(u,d,v){for(const P of this.features){const{geometry:D}=P;this.addFeature(P,D,P.index,d,v,u.subdivisionGranularity)}}update(u,d,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,d,this.stateDependentLayers,v)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,gw),this.centroidVertexBuffer=u.createVertexBuffer(this.centroidVertexArray,mw.members,!0),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(u,d,v,P,D,O){for(const j of sl(d,500)){const K={x:0,y:0,sampleCount:0},ee=this.layoutVertexArray.length;this.processPolygon(K,P,u,j,O);const ce=this.layoutVertexArray.length-ee,ve=Math.floor(K.x/K.sampleCount),Re=Math.floor(K.y/K.sampleCount);for(let Ue=0;Ue<ce;Ue++)this.centroidVertexArray.emplaceBack(ve,Re)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,v,D,P)}processPolygon(u,d,v,P,D){if(P.length<1||c1(P[0]))return;for(const ve of P)ve.length!==0&&vw(u,ve);const O={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},j=D.fill.getGranularityForZoomLevel(d.z),K=yw[v.type]==="Polygon";for(const ve of P){if(ve.length===0||c1(ve))continue;const Re=$d(ve,j,K);this._generateSideFaces(Re,O)}if(!K)return;const ee=Tp(P,d,j,!1),ce=this.layoutVertexArray;_y((ve,Re)=>{Ap(ce,ve,Re,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,ee.verticesFlattened,ee.indicesTriangles)}_generateSideFaces(u,d){let v=0;for(let P=1;P<u.length;P++){const D=u[P],O=u[P-1];if(_w(D,O))continue;d.segment.vertexLength+4>Ei.MAX_VERTEX_ARRAY_LENGTH&&(d.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const j=D.sub(O)._perp()._unit(),K=O.dist(D);v+K>32768&&(v=0),Ap(this.layoutVertexArray,D.x,D.y,j.x,j.y,0,0,v),Ap(this.layoutVertexArray,D.x,D.y,j.x,j.y,0,1,v),v+=K,Ap(this.layoutVertexArray,O.x,O.y,j.x,j.y,0,0,v),Ap(this.layoutVertexArray,O.x,O.y,j.x,j.y,0,1,v);const ee=d.segment.vertexLength;this.indexArray.emplaceBack(ee,ee+2,ee+1),this.indexArray.emplaceBack(ee+1,ee+2,ee+3),d.segment.vertexLength+=4,d.segment.primitiveLength+=2}}}function vw(h,u){for(let d=0;d<u.length;d++){const v=u[d];d===u.length-1&&u[0].x===v.x&&u[0].y===v.y||(h.x+=v.x,h.y+=v.y,h.sampleCount++)}}function _w(h,u){return h.x===u.x&&(h.x<0||h.x>Le)||h.y===u.y&&(h.y<0||h.y>Le)}function c1(h){return h.every(u=>u.x<0)||h.every(u=>u.x>Le)||h.every(u=>u.y<0)||h.every(u=>u.y>Le)}let h1;Gr("FillExtrusionBucket",Ey,{omit:["layers","features"]});var bw={get paint(){return h1=h1||new pe({"fill-extrusion-opacity":new S($e["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new I($e["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new S($e["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new S($e["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new F($e["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new I($e["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new I($e["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new S($e["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Dh extends Fe{constructor(u){super(u,bw)}createBucket(u){return new Ey(u)}queryRadius(){return Fg(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:u,feature:d,featureState:v,geometry:P,transform:D,pixelsToTileUnits:O,pixelPosMatrix:j}){const K=Tm(u,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-D.bearingInRadians,O),ee=this.paint.get("fill-extrusion-height").evaluate(d,v),ce=this.paint.get("fill-extrusion-base").evaluate(d,v),ve=function(Ue,qe,st){const xt=[];for(const It of Ue){const fn=[It.x,It.y,0,1];be(fn,fn,qe),xt.push(new R(fn[0]/fn[3],fn[1]/fn[3]))}return xt}(K,j),Re=function(Ue,qe,st,xt){const It=[],fn=[],$t=xt[8]*qe,Oe=xt[9]*qe,ft=xt[10]*qe,Wt=xt[11]*qe,$n=xt[8]*st,_r=xt[9]*st,Wn=xt[10]*st,rr=xt[11]*st;for(const Ar of Ue){const xr=[],kr=[];for(const lr of Ar){const Qr=lr.x,_i=lr.y,hi=xt[0]*Qr+xt[4]*_i+xt[12],si=xt[1]*Qr+xt[5]*_i+xt[13],ws=xt[2]*Qr+xt[6]*_i+xt[14],_a=xt[3]*Qr+xt[7]*_i+xt[15],Tl=ws+ft,Vu=_a+Wt,$u=hi+$n,Ic=si+_r,_u=ws+Wn,aa=_a+rr,Kl=new R((hi+$t)/Vu,(si+Oe)/Vu);Kl.z=Tl/Vu,xr.push(Kl);const bu=new R($u/aa,Ic/aa);bu.z=_u/aa,kr.push(bu)}It.push(xr),fn.push(kr)}return[It,fn]}(P,ce,ee,j);return function(Ue,qe,st){let xt=1/0;Hf(st,qe)&&(xt=d1(st,qe[0]));for(let It=0;It<qe.length;It++){const fn=qe[It],$t=Ue[It];for(let Oe=0;Oe<fn.length-1;Oe++){const ft=fn[Oe],Wt=[ft,fn[Oe+1],$t[Oe+1],$t[Oe],ft];Pm(st,Wt)&&(xt=Math.min(xt,d1(st,Wt)))}}return xt!==1/0&&xt}(Re[0],Re[1],ve)}}function Fm(h,u){return h.x*u.x+h.y*u.y}function d1(h,u){if(h.length===1){let d=0;const v=u[d++];let P;for(;!P||v.equals(P);)if(P=u[d++],!P)return 1/0;for(;d<u.length;d++){const D=u[d],O=h[0],j=P.sub(v),K=D.sub(v),ee=O.sub(v),ce=Fm(j,j),ve=Fm(j,K),Re=Fm(K,K),Ue=Fm(ee,j),qe=Fm(ee,K),st=ce*Re-ve*ve,xt=(Re*Ue-ve*qe)/st,It=(ce*qe-ve*Ue)/st,fn=v.z*(1-xt-It)+P.z*xt+D.z*It;if(isFinite(fn))return fn}return 1/0}{let d=1/0;for(const v of u)d=Math.min(d,v.z);return d}}const xw=dn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:f1}=xw,ww=dn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Cw}=ww,Sw=Nm.VectorTileFeature.types,Lw=Math.cos(Math.PI/180*37.5),Gg=Math.pow(2,14)/.5;class My{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(d=>d.id),this.index=u.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(d=>{this.gradients[d.id]={}}),this.layoutVertexArray=new mn,this.layoutVertexArray2=new on,this.indexArray=new Sr,this.programConfigurations=new Cd(u.layers,u.zoom),this.segments=new Ei,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(u,d,v){this.hasPattern=Ud("line",this.layers,d);const P=this.layers[0].layout.get("line-sort-key"),D=!P.isConstant(),O=[];for(const{feature:j,id:K,index:ee,sourceLayerIndex:ce}of u){const ve=this.layers[0]._featureFilter.needGeometry,Re=hh(j,ve);if(!this.layers[0]._featureFilter.filter(new Qt(this.zoom),Re,v))continue;const Ue=D?P.evaluate(Re,{},v):void 0,qe={id:K,properties:j.properties,type:j.type,sourceLayerIndex:ce,index:ee,geometry:ve?Re.geometry:Ec(j),patterns:{},sortKey:Ue};O.push(qe)}D&&O.sort((j,K)=>j.sortKey-K.sortKey);for(const j of O){const{geometry:K,index:ee,sourceLayerIndex:ce}=j;if(this.hasPattern){const ve=gy("line",this.layers,j,this.zoom,d);this.patternFeatures.push(ve)}else this.addFeature(j,K,ee,v,{},d.subdivisionGranularity);d.featureIndex.insert(u[ee].feature,K,ee,ce,this.index)}}update(u,d,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,d,this.stateDependentLayers,v)}addFeatures(u,d,v){for(const P of this.patternFeatures)this.addFeature(P,P.geometry,P.index,d,v,u.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=u.createVertexBuffer(this.layoutVertexArray2,Cw)),this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,f1),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(u){if(u.properties&&Object.prototype.hasOwnProperty.call(u.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(u.properties,"mapbox_clip_end"))return{start:+u.properties.mapbox_clip_start,end:+u.properties.mapbox_clip_end}}addFeature(u,d,v,P,D,O){const j=this.layers[0].layout,K=j.get("line-join").evaluate(u,{}),ee=j.get("line-cap"),ce=j.get("line-miter-limit"),ve=j.get("line-round-limit");this.lineClips=this.lineFeatureClips(u);for(const Re of d)this.addLine(Re,u,K,ee,ce,ve,P,O);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,v,D,P)}addLine(u,d,v,P,D,O,j,K){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,u=$d(u,j?K.line.getGranularityForZoomLevel(j.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let $t=0;$t<u.length-1;$t++)this.totalDistance+=u[$t].dist(u[$t+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const ee=Sw[d.type]==="Polygon";let ce=u.length;for(;ce>=2&&u[ce-1].equals(u[ce-2]);)ce--;let ve=0;for(;ve<ce-1&&u[ve].equals(u[ve+1]);)ve++;if(ce<(ee?3:2))return;v==="bevel"&&(D=1.05);const Re=this.overscaling<=16?15*Le/(512*this.overscaling):0,Ue=this.segments.prepareSegment(10*ce,this.layoutVertexArray,this.indexArray);let qe,st,xt,It,fn;this.e1=this.e2=-1,ee&&(qe=u[ce-2],fn=u[ve].sub(qe)._unit()._perp());for(let $t=ve;$t<ce;$t++){if(xt=$t===ce-1?ee?u[ve+1]:void 0:u[$t+1],xt&&u[$t].equals(xt))continue;fn&&(It=fn),qe&&(st=qe),qe=u[$t],fn=xt?xt.sub(qe)._unit()._perp():It,It=It||fn;let Oe=It.add(fn);Oe.x===0&&Oe.y===0||Oe._unit();const ft=It.x*fn.x+It.y*fn.y,Wt=Oe.x*fn.x+Oe.y*fn.y,$n=Wt!==0?1/Wt:1/0,_r=2*Math.sqrt(2-2*Wt),Wn=Wt<Lw&&st&&xt,rr=It.x*fn.y-It.y*fn.x>0;if(Wn&&$t>ve){const kr=qe.dist(st);if(kr>2*Re){const lr=qe.sub(qe.sub(st)._mult(Re/kr)._round());this.updateDistance(st,lr),this.addCurrentVertex(lr,It,0,0,Ue),st=lr}}const Ar=st&&xt;let xr=Ar?v:ee?"butt":P;if(Ar&&xr==="round"&&($n<O?xr="miter":$n<=2&&(xr="fakeround")),xr==="miter"&&$n>D&&(xr="bevel"),xr==="bevel"&&($n>2&&(xr="flipbevel"),$n<D&&(xr="miter")),st&&this.updateDistance(st,qe),xr==="miter")Oe._mult($n),this.addCurrentVertex(qe,Oe,0,0,Ue);else if(xr==="flipbevel"){if($n>100)Oe=fn.mult(-1);else{const kr=$n*It.add(fn).mag()/It.sub(fn).mag();Oe._perp()._mult(kr*(rr?-1:1))}this.addCurrentVertex(qe,Oe,0,0,Ue),this.addCurrentVertex(qe,Oe.mult(-1),0,0,Ue)}else if(xr==="bevel"||xr==="fakeround"){const kr=-Math.sqrt($n*$n-1),lr=rr?kr:0,Qr=rr?0:kr;if(st&&this.addCurrentVertex(qe,It,lr,Qr,Ue),xr==="fakeround"){const _i=Math.round(180*_r/Math.PI/20);for(let hi=1;hi<_i;hi++){let si=hi/_i;if(si!==.5){const _a=si-.5;si+=si*_a*(si-1)*((1.0904+ft*(ft*(3.55645-1.43519*ft)-3.2452))*_a*_a+(.848013+ft*(.215638*ft-1.06021)))}const ws=fn.sub(It)._mult(si)._add(It)._unit()._mult(rr?-1:1);this.addHalfVertex(qe,ws.x,ws.y,!1,rr,0,Ue)}}xt&&this.addCurrentVertex(qe,fn,-lr,-Qr,Ue)}else if(xr==="butt")this.addCurrentVertex(qe,Oe,0,0,Ue);else if(xr==="square"){const kr=st?1:-1;this.addCurrentVertex(qe,Oe,kr,kr,Ue)}else xr==="round"&&(st&&(this.addCurrentVertex(qe,It,0,0,Ue),this.addCurrentVertex(qe,It,1,1,Ue,!0)),xt&&(this.addCurrentVertex(qe,fn,-1,-1,Ue,!0),this.addCurrentVertex(qe,fn,0,0,Ue)));if(Wn&&$t<ce-1){const kr=qe.dist(xt);if(kr>2*Re){const lr=qe.add(xt.sub(qe)._mult(Re/kr)._round());this.updateDistance(qe,lr),this.addCurrentVertex(lr,fn,0,0,Ue),qe=lr}}}}addCurrentVertex(u,d,v,P,D,O=!1){const j=d.y*P-d.x,K=-d.y-d.x*P;this.addHalfVertex(u,d.x+d.y*v,d.y-d.x*v,O,!1,v,D),this.addHalfVertex(u,j,K,O,!0,-P,D),this.distance>Gg/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(u,d,v,P,D,O))}addHalfVertex({x:u,y:d},v,P,D,O,j,K){const ee=.5*(this.lineClips?this.scaledDistance*(Gg-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((u<<1)+(D?1:0),(d<<1)+(O?1:0),Math.round(63*v)+128,Math.round(63*P)+128,1+(j===0?0:j<0?-1:1)|(63&ee)<<2,ee>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const ce=K.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,ce,this.e2),K.primitiveLength++),O?this.e2=ce:this.e1=ce}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(u,d){this.distance+=u.dist(d),this.updateScaledDistance()}}let p1,m1;Gr("LineBucket",My,{omit:["layers","patternFeatures"]});var g1={get paint(){return m1=m1||new pe({"line-opacity":new I($e.paint_line["line-opacity"]),"line-color":new I($e.paint_line["line-color"]),"line-translate":new S($e.paint_line["line-translate"]),"line-translate-anchor":new S($e.paint_line["line-translate-anchor"]),"line-width":new I($e.paint_line["line-width"]),"line-gap-width":new I($e.paint_line["line-gap-width"]),"line-offset":new I($e.paint_line["line-offset"]),"line-blur":new I($e.paint_line["line-blur"]),"line-dasharray":new G($e.paint_line["line-dasharray"]),"line-pattern":new F($e.paint_line["line-pattern"]),"line-gradient":new te($e.paint_line["line-gradient"])})},get layout(){return p1=p1||new pe({"line-cap":new S($e.layout_line["line-cap"]),"line-join":new I($e.layout_line["line-join"]),"line-miter-limit":new S($e.layout_line["line-miter-limit"]),"line-round-limit":new S($e.layout_line["line-round-limit"]),"line-sort-key":new I($e.layout_line["line-sort-key"])})}};class Pw extends I{possiblyEvaluate(u,d){return d=new Qt(Math.floor(d.zoom),{now:d.now,fadeDuration:d.fadeDuration,zoomHistory:d.zoomHistory,transition:d.transition}),super.possiblyEvaluate(u,d)}evaluate(u,d,v,P){return d=lt({},d,{zoom:Math.floor(d.zoom)}),super.evaluate(u,d,v,P)}}let Hg;class Ew extends Fe{constructor(u){super(u,g1),this.gradientVersion=0,Hg||(Hg=new Pw(g1.paint.properties["line-width"].specification),Hg.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(u){if(u==="line-gradient"){const d=this.gradientExpression();this.stepInterpolant=!!function(v){return v._styleExpression!==void 0}(d)&&d._styleExpression.expression instanceof Ks,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(u,d){super.recalculate(u,d),this.paint._values["line-floorwidth"]=Hg.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)}createBucket(u){return new My(u)}queryRadius(u){const d=u,v=y1(mf("line-width",this,d),mf("line-gap-width",this,d)),P=mf("line-offset",this,d);return v/2+Math.abs(P)+Fg(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:u,feature:d,featureState:v,geometry:P,transform:D,pixelsToTileUnits:O}){const j=Tm(u,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-D.bearingInRadians,O),K=O/2*y1(this.paint.get("line-width").evaluate(d,v),this.paint.get("line-gap-width").evaluate(d,v)),ee=this.paint.get("line-offset").evaluate(d,v);return ee&&(P=function(ce,ve){const Re=[];for(let Ue=0;Ue<ce.length;Ue++){const qe=ce[Ue],st=[];for(let xt=0;xt<qe.length;xt++){const It=qe[xt-1],fn=qe[xt],$t=qe[xt+1],Oe=xt===0?new R(0,0):fn.sub(It)._unit()._perp(),ft=xt===qe.length-1?new R(0,0):$t.sub(fn)._unit()._perp(),Wt=Oe._add(ft)._unit(),$n=Wt.x*ft.x+Wt.y*ft.y;$n!==0&&Wt._mult(1/$n),st.push(Wt._mult(ve)._add(fn))}Re.push(st)}return Re}(P,ee*O)),function(ce,ve,Re){for(let Ue=0;Ue<ve.length;Ue++){const qe=ve[Ue];if(ce.length>=3){for(let st=0;st<qe.length;st++)if(Ld(ce,qe[st]))return!0}if(Em(ce,qe,Re))return!0}return!1}(j,P,K)}isTileClipped(){return!0}}function y1(h,u){return u>0?u+2*h:h}const Mw=dn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Tw=dn([{name:"a_projected_pos",components:3,type:"Float32"}],4);dn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Aw=dn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);dn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const v1=dn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),kw=dn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Iw(h,u,d){return h.sections.forEach(v=>{v.text=function(P,D,O){const j=D.layout.get("text-transform").evaluate(O,{});return j==="uppercase"?P=P.toLocaleUpperCase():j==="lowercase"&&(P=P.toLocaleLowerCase()),Zn.applyArabicShaping&&(P=Zn.applyArabicShaping(P)),P}(v.text,u,d)}),h}dn([{name:"triangle",components:3,type:"Uint16"}]),dn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),dn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),dn([{type:"Float32",name:"offsetX"}]),dn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),dn([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const zm={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var _1,Ty,b1,El=24,Ay={};function ky(){return _1||(_1=1,Ay.read=function(h,u,d,v,P){var D,O,j=8*P-v-1,K=(1<<j)-1,ee=K>>1,ce=-7,ve=d?P-1:0,Re=d?-1:1,Ue=h[u+ve];for(ve+=Re,D=Ue&(1<<-ce)-1,Ue>>=-ce,ce+=j;ce>0;D=256*D+h[u+ve],ve+=Re,ce-=8);for(O=D&(1<<-ce)-1,D>>=-ce,ce+=v;ce>0;O=256*O+h[u+ve],ve+=Re,ce-=8);if(D===0)D=1-ee;else{if(D===K)return O?NaN:1/0*(Ue?-1:1);O+=Math.pow(2,v),D-=ee}return(Ue?-1:1)*O*Math.pow(2,D-v)},Ay.write=function(h,u,d,v,P,D){var O,j,K,ee=8*D-P-1,ce=(1<<ee)-1,ve=ce>>1,Re=P===23?Math.pow(2,-24)-Math.pow(2,-77):0,Ue=v?0:D-1,qe=v?1:-1,st=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?(j=isNaN(u)?1:0,O=ce):(O=Math.floor(Math.log(u)/Math.LN2),u*(K=Math.pow(2,-O))<1&&(O--,K*=2),(u+=O+ve>=1?Re/K:Re*Math.pow(2,1-ve))*K>=2&&(O++,K/=2),O+ve>=ce?(j=0,O=ce):O+ve>=1?(j=(u*K-1)*Math.pow(2,P),O+=ve):(j=u*Math.pow(2,ve-1)*Math.pow(2,P),O=0));P>=8;h[d+Ue]=255&j,Ue+=qe,j/=256,P-=8);for(O=O<<P|j,ee+=P;ee>0;h[d+Ue]=255&O,Ue+=qe,O/=256,ee-=8);h[d+Ue-qe]|=128*st}),Ay}function Iy(){if(b1)return Ty;b1=1,Ty=u;var h=ky();function u(Oe){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(Oe)?Oe:new Uint8Array(Oe||0),this.pos=0,this.type=0,this.length=this.buf.length}u.Varint=0,u.Fixed64=1,u.Bytes=2,u.Fixed32=5;var d=4294967296,v=1/d,P=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function D(Oe){return Oe.type===u.Bytes?Oe.readVarint()+Oe.pos:Oe.pos+1}function O(Oe,ft,Wt){return Wt?4294967296*ft+(Oe>>>0):4294967296*(ft>>>0)+(Oe>>>0)}function j(Oe,ft,Wt){var $n=ft<=16383?1:ft<=2097151?2:ft<=268435455?3:Math.floor(Math.log(ft)/(7*Math.LN2));Wt.realloc($n);for(var _r=Wt.pos-1;_r>=Oe;_r--)Wt.buf[_r+$n]=Wt.buf[_r]}function K(Oe,ft){for(var Wt=0;Wt<Oe.length;Wt++)ft.writeVarint(Oe[Wt])}function ee(Oe,ft){for(var Wt=0;Wt<Oe.length;Wt++)ft.writeSVarint(Oe[Wt])}function ce(Oe,ft){for(var Wt=0;Wt<Oe.length;Wt++)ft.writeFloat(Oe[Wt])}function ve(Oe,ft){for(var Wt=0;Wt<Oe.length;Wt++)ft.writeDouble(Oe[Wt])}function Re(Oe,ft){for(var Wt=0;Wt<Oe.length;Wt++)ft.writeBoolean(Oe[Wt])}function Ue(Oe,ft){for(var Wt=0;Wt<Oe.length;Wt++)ft.writeFixed32(Oe[Wt])}function qe(Oe,ft){for(var Wt=0;Wt<Oe.length;Wt++)ft.writeSFixed32(Oe[Wt])}function st(Oe,ft){for(var Wt=0;Wt<Oe.length;Wt++)ft.writeFixed64(Oe[Wt])}function xt(Oe,ft){for(var Wt=0;Wt<Oe.length;Wt++)ft.writeSFixed64(Oe[Wt])}function It(Oe,ft){return(Oe[ft]|Oe[ft+1]<<8|Oe[ft+2]<<16)+16777216*Oe[ft+3]}function fn(Oe,ft,Wt){Oe[Wt]=ft,Oe[Wt+1]=ft>>>8,Oe[Wt+2]=ft>>>16,Oe[Wt+3]=ft>>>24}function $t(Oe,ft){return(Oe[ft]|Oe[ft+1]<<8|Oe[ft+2]<<16)+(Oe[ft+3]<<24)}return u.prototype={destroy:function(){this.buf=null},readFields:function(Oe,ft,Wt){for(Wt=Wt||this.length;this.pos<Wt;){var $n=this.readVarint(),_r=$n>>3,Wn=this.pos;this.type=7&$n,Oe(_r,ft,this),this.pos===Wn&&this.skip($n)}return ft},readMessage:function(Oe,ft){return this.readFields(Oe,ft,this.readVarint()+this.pos)},readFixed32:function(){var Oe=It(this.buf,this.pos);return this.pos+=4,Oe},readSFixed32:function(){var Oe=$t(this.buf,this.pos);return this.pos+=4,Oe},readFixed64:function(){var Oe=It(this.buf,this.pos)+It(this.buf,this.pos+4)*d;return this.pos+=8,Oe},readSFixed64:function(){var Oe=It(this.buf,this.pos)+$t(this.buf,this.pos+4)*d;return this.pos+=8,Oe},readFloat:function(){var Oe=h.read(this.buf,this.pos,!0,23,4);return this.pos+=4,Oe},readDouble:function(){var Oe=h.read(this.buf,this.pos,!0,52,8);return this.pos+=8,Oe},readVarint:function(Oe){var ft,Wt,$n=this.buf;return ft=127&(Wt=$n[this.pos++]),Wt<128?ft:(ft|=(127&(Wt=$n[this.pos++]))<<7,Wt<128?ft:(ft|=(127&(Wt=$n[this.pos++]))<<14,Wt<128?ft:(ft|=(127&(Wt=$n[this.pos++]))<<21,Wt<128?ft:function(_r,Wn,rr){var Ar,xr,kr=rr.buf;if(Ar=(112&(xr=kr[rr.pos++]))>>4,xr<128||(Ar|=(127&(xr=kr[rr.pos++]))<<3,xr<128)||(Ar|=(127&(xr=kr[rr.pos++]))<<10,xr<128)||(Ar|=(127&(xr=kr[rr.pos++]))<<17,xr<128)||(Ar|=(127&(xr=kr[rr.pos++]))<<24,xr<128)||(Ar|=(1&(xr=kr[rr.pos++]))<<31,xr<128))return O(_r,Ar,Wn);throw new Error("Expected varint not more than 10 bytes")}(ft|=(15&(Wt=$n[this.pos]))<<28,Oe,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var Oe=this.readVarint();return Oe%2==1?(Oe+1)/-2:Oe/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var Oe=this.readVarint()+this.pos,ft=this.pos;return this.pos=Oe,Oe-ft>=12&&P?function(Wt,$n,_r){return P.decode(Wt.subarray($n,_r))}(this.buf,ft,Oe):function(Wt,$n,_r){for(var Wn="",rr=$n;rr<_r;){var Ar,xr,kr,lr=Wt[rr],Qr=null,_i=lr>239?4:lr>223?3:lr>191?2:1;if(rr+_i>_r)break;_i===1?lr<128&&(Qr=lr):_i===2?(192&(Ar=Wt[rr+1]))==128&&(Qr=(31&lr)<<6|63&Ar)<=127&&(Qr=null):_i===3?(xr=Wt[rr+2],(192&(Ar=Wt[rr+1]))==128&&(192&xr)==128&&((Qr=(15&lr)<<12|(63&Ar)<<6|63&xr)<=2047||Qr>=55296&&Qr<=57343)&&(Qr=null)):_i===4&&(xr=Wt[rr+2],kr=Wt[rr+3],(192&(Ar=Wt[rr+1]))==128&&(192&xr)==128&&(192&kr)==128&&((Qr=(15&lr)<<18|(63&Ar)<<12|(63&xr)<<6|63&kr)<=65535||Qr>=1114112)&&(Qr=null)),Qr===null?(Qr=65533,_i=1):Qr>65535&&(Qr-=65536,Wn+=String.fromCharCode(Qr>>>10&1023|55296),Qr=56320|1023&Qr),Wn+=String.fromCharCode(Qr),rr+=_i}return Wn}(this.buf,ft,Oe)},readBytes:function(){var Oe=this.readVarint()+this.pos,ft=this.buf.subarray(this.pos,Oe);return this.pos=Oe,ft},readPackedVarint:function(Oe,ft){if(this.type!==u.Bytes)return Oe.push(this.readVarint(ft));var Wt=D(this);for(Oe=Oe||[];this.pos<Wt;)Oe.push(this.readVarint(ft));return Oe},readPackedSVarint:function(Oe){if(this.type!==u.Bytes)return Oe.push(this.readSVarint());var ft=D(this);for(Oe=Oe||[];this.pos<ft;)Oe.push(this.readSVarint());return Oe},readPackedBoolean:function(Oe){if(this.type!==u.Bytes)return Oe.push(this.readBoolean());var ft=D(this);for(Oe=Oe||[];this.pos<ft;)Oe.push(this.readBoolean());return Oe},readPackedFloat:function(Oe){if(this.type!==u.Bytes)return Oe.push(this.readFloat());var ft=D(this);for(Oe=Oe||[];this.pos<ft;)Oe.push(this.readFloat());return Oe},readPackedDouble:function(Oe){if(this.type!==u.Bytes)return Oe.push(this.readDouble());var ft=D(this);for(Oe=Oe||[];this.pos<ft;)Oe.push(this.readDouble());return Oe},readPackedFixed32:function(Oe){if(this.type!==u.Bytes)return Oe.push(this.readFixed32());var ft=D(this);for(Oe=Oe||[];this.pos<ft;)Oe.push(this.readFixed32());return Oe},readPackedSFixed32:function(Oe){if(this.type!==u.Bytes)return Oe.push(this.readSFixed32());var ft=D(this);for(Oe=Oe||[];this.pos<ft;)Oe.push(this.readSFixed32());return Oe},readPackedFixed64:function(Oe){if(this.type!==u.Bytes)return Oe.push(this.readFixed64());var ft=D(this);for(Oe=Oe||[];this.pos<ft;)Oe.push(this.readFixed64());return Oe},readPackedSFixed64:function(Oe){if(this.type!==u.Bytes)return Oe.push(this.readSFixed64());var ft=D(this);for(Oe=Oe||[];this.pos<ft;)Oe.push(this.readSFixed64());return Oe},skip:function(Oe){var ft=7&Oe;if(ft===u.Varint)for(;this.buf[this.pos++]>127;);else if(ft===u.Bytes)this.pos=this.readVarint()+this.pos;else if(ft===u.Fixed32)this.pos+=4;else{if(ft!==u.Fixed64)throw new Error("Unimplemented type: "+ft);this.pos+=8}},writeTag:function(Oe,ft){this.writeVarint(Oe<<3|ft)},realloc:function(Oe){for(var ft=this.length||16;ft<this.pos+Oe;)ft*=2;if(ft!==this.length){var Wt=new Uint8Array(ft);Wt.set(this.buf),this.buf=Wt,this.length=ft}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(Oe){this.realloc(4),fn(this.buf,Oe,this.pos),this.pos+=4},writeSFixed32:function(Oe){this.realloc(4),fn(this.buf,Oe,this.pos),this.pos+=4},writeFixed64:function(Oe){this.realloc(8),fn(this.buf,-1&Oe,this.pos),fn(this.buf,Math.floor(Oe*v),this.pos+4),this.pos+=8},writeSFixed64:function(Oe){this.realloc(8),fn(this.buf,-1&Oe,this.pos),fn(this.buf,Math.floor(Oe*v),this.pos+4),this.pos+=8},writeVarint:function(Oe){(Oe=+Oe||0)>268435455||Oe<0?function(ft,Wt){var $n,_r;if(ft>=0?($n=ft%4294967296|0,_r=ft/4294967296|0):(_r=~(-ft/4294967296),4294967295^($n=~(-ft%4294967296))?$n=$n+1|0:($n=0,_r=_r+1|0)),ft>=18446744073709552e3||ft<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Wt.realloc(10),function(Wn,rr,Ar){Ar.buf[Ar.pos++]=127&Wn|128,Wn>>>=7,Ar.buf[Ar.pos++]=127&Wn|128,Wn>>>=7,Ar.buf[Ar.pos++]=127&Wn|128,Wn>>>=7,Ar.buf[Ar.pos++]=127&Wn|128,Ar.buf[Ar.pos]=127&(Wn>>>=7)}($n,0,Wt),function(Wn,rr){var Ar=(7&Wn)<<4;rr.buf[rr.pos++]|=Ar|((Wn>>>=3)?128:0),Wn&&(rr.buf[rr.pos++]=127&Wn|((Wn>>>=7)?128:0),Wn&&(rr.buf[rr.pos++]=127&Wn|((Wn>>>=7)?128:0),Wn&&(rr.buf[rr.pos++]=127&Wn|((Wn>>>=7)?128:0),Wn&&(rr.buf[rr.pos++]=127&Wn|((Wn>>>=7)?128:0),Wn&&(rr.buf[rr.pos++]=127&Wn)))))}(_r,Wt)}(Oe,this):(this.realloc(4),this.buf[this.pos++]=127&Oe|(Oe>127?128:0),Oe<=127||(this.buf[this.pos++]=127&(Oe>>>=7)|(Oe>127?128:0),Oe<=127||(this.buf[this.pos++]=127&(Oe>>>=7)|(Oe>127?128:0),Oe<=127||(this.buf[this.pos++]=Oe>>>7&127))))},writeSVarint:function(Oe){this.writeVarint(Oe<0?2*-Oe-1:2*Oe)},writeBoolean:function(Oe){this.writeVarint(!!Oe)},writeString:function(Oe){Oe=String(Oe),this.realloc(4*Oe.length),this.pos++;var ft=this.pos;this.pos=function($n,_r,Wn){for(var rr,Ar,xr=0;xr<_r.length;xr++){if((rr=_r.charCodeAt(xr))>55295&&rr<57344){if(!Ar){rr>56319||xr+1===_r.length?($n[Wn++]=239,$n[Wn++]=191,$n[Wn++]=189):Ar=rr;continue}if(rr<56320){$n[Wn++]=239,$n[Wn++]=191,$n[Wn++]=189,Ar=rr;continue}rr=Ar-55296<<10|rr-56320|65536,Ar=null}else Ar&&($n[Wn++]=239,$n[Wn++]=191,$n[Wn++]=189,Ar=null);rr<128?$n[Wn++]=rr:(rr<2048?$n[Wn++]=rr>>6|192:(rr<65536?$n[Wn++]=rr>>12|224:($n[Wn++]=rr>>18|240,$n[Wn++]=rr>>12&63|128),$n[Wn++]=rr>>6&63|128),$n[Wn++]=63&rr|128)}return Wn}(this.buf,Oe,this.pos);var Wt=this.pos-ft;Wt>=128&&j(ft,Wt,this),this.pos=ft-1,this.writeVarint(Wt),this.pos+=Wt},writeFloat:function(Oe){this.realloc(4),h.write(this.buf,Oe,this.pos,!0,23,4),this.pos+=4},writeDouble:function(Oe){this.realloc(8),h.write(this.buf,Oe,this.pos,!0,52,8),this.pos+=8},writeBytes:function(Oe){var ft=Oe.length;this.writeVarint(ft),this.realloc(ft);for(var Wt=0;Wt<ft;Wt++)this.buf[this.pos++]=Oe[Wt]},writeRawMessage:function(Oe,ft){this.pos++;var Wt=this.pos;Oe(ft,this);var $n=this.pos-Wt;$n>=128&&j(Wt,$n,this),this.pos=Wt-1,this.writeVarint($n),this.pos+=$n},writeMessage:function(Oe,ft,Wt){this.writeTag(Oe,u.Bytes),this.writeRawMessage(ft,Wt)},writePackedVarint:function(Oe,ft){ft.length&&this.writeMessage(Oe,K,ft)},writePackedSVarint:function(Oe,ft){ft.length&&this.writeMessage(Oe,ee,ft)},writePackedBoolean:function(Oe,ft){ft.length&&this.writeMessage(Oe,Re,ft)},writePackedFloat:function(Oe,ft){ft.length&&this.writeMessage(Oe,ce,ft)},writePackedDouble:function(Oe,ft){ft.length&&this.writeMessage(Oe,ve,ft)},writePackedFixed32:function(Oe,ft){ft.length&&this.writeMessage(Oe,Ue,ft)},writePackedSFixed32:function(Oe,ft){ft.length&&this.writeMessage(Oe,qe,ft)},writePackedFixed64:function(Oe,ft){ft.length&&this.writeMessage(Oe,st,ft)},writePackedSFixed64:function(Oe,ft){ft.length&&this.writeMessage(Oe,xt,ft)},writeBytesField:function(Oe,ft){this.writeTag(Oe,u.Bytes),this.writeBytes(ft)},writeFixed32Field:function(Oe,ft){this.writeTag(Oe,u.Fixed32),this.writeFixed32(ft)},writeSFixed32Field:function(Oe,ft){this.writeTag(Oe,u.Fixed32),this.writeSFixed32(ft)},writeFixed64Field:function(Oe,ft){this.writeTag(Oe,u.Fixed64),this.writeFixed64(ft)},writeSFixed64Field:function(Oe,ft){this.writeTag(Oe,u.Fixed64),this.writeSFixed64(ft)},writeVarintField:function(Oe,ft){this.writeTag(Oe,u.Varint),this.writeVarint(ft)},writeSVarintField:function(Oe,ft){this.writeTag(Oe,u.Varint),this.writeSVarint(ft)},writeStringField:function(Oe,ft){this.writeTag(Oe,u.Bytes),this.writeString(ft)},writeFloatField:function(Oe,ft){this.writeTag(Oe,u.Fixed32),this.writeFloat(ft)},writeDoubleField:function(Oe,ft){this.writeTag(Oe,u.Fixed64),this.writeDouble(ft)},writeBooleanField:function(Oe,ft){this.writeVarintField(Oe,!!ft)}},Ty}var Dy=f(Iy());const Oy=3;function Dw(h,u,d){h===1&&d.readMessage(Ow,u)}function Ow(h,u,d){if(h===3){const{id:v,bitmap:P,width:D,height:O,left:j,top:K,advance:ee}=d.readMessage(Rw,{});u.push({id:v,bitmap:new km({width:D+2*Oy,height:O+2*Oy},P),metrics:{width:D,height:O,left:j,top:K,advance:ee}})}}function Rw(h,u,d){h===1?u.id=d.readVarint():h===2?u.bitmap=d.readBytes():h===3?u.width=d.readVarint():h===4?u.height=d.readVarint():h===5?u.left=d.readSVarint():h===6?u.top=d.readSVarint():h===7&&(u.advance=d.readVarint())}const Bw=Oy;function x1(h){let u=0,d=0;for(const O of h)u+=O.w*O.h,d=Math.max(d,O.w);h.sort((O,j)=>j.h-O.h);const v=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(u/.95)),d),h:1/0}];let P=0,D=0;for(const O of h)for(let j=v.length-1;j>=0;j--){const K=v[j];if(!(O.w>K.w||O.h>K.h)){if(O.x=K.x,O.y=K.y,D=Math.max(D,O.y+O.h),P=Math.max(P,O.x+O.w),O.w===K.w&&O.h===K.h){const ee=v.pop();j<v.length&&(v[j]=ee)}else O.h===K.h?(K.x+=O.w,K.w-=O.w):O.w===K.w?(K.y+=O.h,K.h-=O.h):(v.push({x:K.x+O.w,y:K.y,w:K.w-O.w,h:O.h}),K.y+=O.h,K.h-=O.h);break}}return{w:P,h:D,fill:u/(P*D)||0}}const Mc=1;class qg{constructor(u,{pixelRatio:d,version:v,stretchX:P,stretchY:D,content:O,textFitWidth:j,textFitHeight:K}){this.paddedRect=u,this.pixelRatio=d,this.stretchX=P,this.stretchY=D,this.content=O,this.version=v,this.textFitWidth=j,this.textFitHeight=K}get tl(){return[this.paddedRect.x+Mc,this.paddedRect.y+Mc]}get br(){return[this.paddedRect.x+this.paddedRect.w-Mc,this.paddedRect.y+this.paddedRect.h-Mc]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Mc)/this.pixelRatio,(this.paddedRect.h-2*Mc)/this.pixelRatio]}}class w1{constructor(u,d){const v={},P={};this.haveRenderCallbacks=[];const D=[];this.addImages(u,v,D),this.addImages(d,P,D);const{w:O,h:j}=x1(D),K=new Pl({width:O||1,height:j||1});for(const ee in u){const ce=u[ee],ve=v[ee].paddedRect;Pl.copy(ce.data,K,{x:0,y:0},{x:ve.x+Mc,y:ve.y+Mc},ce.data)}for(const ee in d){const ce=d[ee],ve=P[ee].paddedRect,Re=ve.x+Mc,Ue=ve.y+Mc,qe=ce.data.width,st=ce.data.height;Pl.copy(ce.data,K,{x:0,y:0},{x:Re,y:Ue},ce.data),Pl.copy(ce.data,K,{x:0,y:st-1},{x:Re,y:Ue-1},{width:qe,height:1}),Pl.copy(ce.data,K,{x:0,y:0},{x:Re,y:Ue+st},{width:qe,height:1}),Pl.copy(ce.data,K,{x:qe-1,y:0},{x:Re-1,y:Ue},{width:1,height:st}),Pl.copy(ce.data,K,{x:0,y:0},{x:Re+qe,y:Ue},{width:1,height:st})}this.image=K,this.iconPositions=v,this.patternPositions=P}addImages(u,d,v){for(const P in u){const D=u[P],O={x:0,y:0,w:D.data.width+2*Mc,h:D.data.height+2*Mc};v.push(O),d[P]=new qg(O,D),D.hasRenderCallback&&this.haveRenderCallbacks.push(P)}}patchUpdatedImages(u,d){u.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const v in u.updatedImages)this.patchUpdatedImage(this.iconPositions[v],u.getImage(v),d),this.patchUpdatedImage(this.patternPositions[v],u.getImage(v),d)}patchUpdatedImage(u,d,v){if(!u||!d||u.version===d.version)return;u.version=d.version;const[P,D]=u.tl;v.update(d.data,void 0,{x:P,y:D})}}var rd;Gr("ImagePosition",qg),Gr("ImageAtlas",w1),a.al=void 0,(rd=a.al||(a.al={}))[rd.none=0]="none",rd[rd.horizontal=1]="horizontal",rd[rd.vertical=2]="vertical",rd[rd.horizontalOnly=3]="horizontalOnly";const Wg=-17;class jm{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(u,d,v){const P=new jm;return P.scale=u||1,P.fontStack=d,P.verticalAlign=v||"bottom",P}static forImage(u,d){const v=new jm;return v.imageName=u,v.verticalAlign=d||"bottom",v}}class kp{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(u,d){const v=new kp;for(let P=0;P<u.sections.length;P++){const D=u.sections[P];D.image?v.addImageSection(D):v.addTextSection(D,d)}return v}length(){return this.text.length}getSection(u){return this.sections[this.sectionIndex[u]]}getSectionIndex(u){return this.sectionIndex[u]}getCharCode(u){return this.text.charCodeAt(u)}verticalizePunctuation(){this.text=function(u){let d="";for(let v=0;v<u.length;v++){const P=u.charCodeAt(v+1)||null,D=u.charCodeAt(v-1)||null;d+=P&&_n(P)&&!zm[u[v+1]]||D&&_n(D)&&!zm[u[v-1]]||!zm[u[v]]?u[v]:zm[u[v]]}return d}(this.text)}trim(){let u=0;for(let v=0;v<this.text.length&&Kg[this.text.charCodeAt(v)];v++)u++;let d=this.text.length;for(let v=this.text.length-1;v>=0&&v>=u&&Kg[this.text.charCodeAt(v)];v--)d--;this.text=this.text.substring(u,d),this.sectionIndex=this.sectionIndex.slice(u,d)}substring(u,d){const v=new kp;return v.text=this.text.substring(u,d),v.sectionIndex=this.sectionIndex.slice(u,d),v.sections=this.sections,v}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((u,d)=>Math.max(u,this.sections[d].scale),0)}getMaxImageSize(u){let d=0,v=0;for(let P=0;P<this.length();P++){const D=this.getSection(P);if(D.imageName){const O=u[D.imageName];if(!O)continue;const j=O.displaySize;d=Math.max(d,j[0]),v=Math.max(v,j[1])}}return{maxImageWidth:d,maxImageHeight:v}}addTextSection(u,d){this.text+=u.text,this.sections.push(jm.forText(u.scale,u.fontStack||d,u.verticalAlign));const v=this.sections.length-1;for(let P=0;P<u.text.length;++P)this.sectionIndex.push(v)}addImageSection(u){const d=u.image?u.image.name:"";if(d.length===0)return void De("Can't add FormattedSection with an empty image.");const v=this.getNextImageSectionCharCode();v?(this.text+=String.fromCharCode(v),this.sections.push(jm.forImage(d,u.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):De("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Zg(h,u,d,v,P,D,O,j,K,ee,ce,ve,Re,Ue,qe){const st=kp.fromFeature(h,P);let xt;ve===a.al.vertical&&st.verticalizePunctuation();const{processBidirectionalText:It,processStyledBidirectionalText:fn}=Zn;if(It&&st.sections.length===1){xt=[];const ft=It(st.toString(),Ry(st,ee,D,u,v,Ue));for(const Wt of ft){const $n=new kp;$n.text=Wt,$n.sections=st.sections;for(let _r=0;_r<Wt.length;_r++)$n.sectionIndex.push(0);xt.push($n)}}else if(fn){xt=[];const ft=fn(st.text,st.sectionIndex,Ry(st,ee,D,u,v,Ue));for(const Wt of ft){const $n=new kp;$n.text=Wt[0],$n.sectionIndex=Wt[1],$n.sections=st.sections,xt.push($n)}}else xt=function(ft,Wt){const $n=[],_r=ft.text;let Wn=0;for(const rr of Wt)$n.push(ft.substring(Wn,rr)),Wn=rr;return Wn<_r.length&&$n.push(ft.substring(Wn,_r.length)),$n}(st,Ry(st,ee,D,u,v,Ue));const $t=[],Oe={positionedLines:$t,text:st.toString(),top:ce[1],bottom:ce[1],left:ce[0],right:ce[0],writingMode:ve,iconsInText:!1,verticalizable:!1};return function(ft,Wt,$n,_r,Wn,rr,Ar,xr,kr,lr,Qr,_i){let hi=0,si=0,ws=0,_a=0;const Tl=xr==="right"?1:xr==="left"?0:.5,Vu=El/_i;let $u=0;for(const aa of Wn){aa.trim();const Kl=aa.getMaxScale(),bu={positionedGlyphs:[],lineOffset:0};ft.positionedLines[$u]=bu;const Yl=bu.positionedGlyphs;let rc=0;if(!aa.length()){si+=rr,++$u;continue}const ph=jw(_r,aa,Vu);for(let Dc=0;Dc<aa.length();Dc++){const Al=aa.getSection(Dc),Jl=aa.getSectionIndex(Dc),Ql=aa.getCharCode(Dc),cl=M1(kr,Qr,Ql);let Oo;if(Al.imageName){if(ft.iconsInText=!0,Al.scale=Al.scale*Vu,Oo=Uw(Al,cl,Kl,ph,_r),!Oo)continue;rc=Math.max(rc,Oo.imageOffset)}else if(Oo=T1(Al,Ql,cl,ph,Wt,$n),!Oo)continue;const{rect:sd,metrics:Np,baselineOffset:od}=Oo;Yl.push({glyph:Ql,imageName:Al.imageName,x:hi,y:si+od+Wg,vertical:cl,scale:Al.scale,fontStack:Al.fontStack,sectionIndex:Jl,metrics:Np,rect:sd}),cl?(ft.verticalizable=!0,hi+=(Al.imageName?Np.advance:El)*Al.scale+lr):hi+=Np.advance*Al.scale+lr}Yl.length!==0&&(ws=Math.max(hi-lr,ws),Vw(Yl,0,Yl.length-1,Tl)),hi=0,bu.lineOffset=Math.max(rc,(Kl-1)*El);const Xl=rr*Kl+rc;si+=Xl,_a=Math.max(Xl,_a),++$u}const{horizontalAlign:Ic,verticalAlign:_u}=By(Ar);(function(aa,Kl,bu,Yl,rc,ph,Xl,Dc,Al){const Jl=(Kl-bu)*rc;let Ql=0;Ql=ph!==Xl?-Dc*Yl-Wg:-Yl*Al*Xl+.5*Xl;for(const cl of aa)for(const Oo of cl.positionedGlyphs)Oo.x+=Jl,Oo.y+=Ql})(ft.positionedLines,Tl,Ic,_u,ws,_a,rr,si,Wn.length),ft.top+=-_u*si,ft.bottom=ft.top+si,ft.left+=-Ic*ws,ft.right=ft.left+ws}(Oe,u,d,v,xt,O,j,K,ve,ee,Re,qe),!function(ft){for(const Wt of ft)if(Wt.positionedGlyphs.length!==0)return!1;return!0}($t)&&Oe}const Kg={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Nw={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Fw={40:!0};function C1(h,u,d,v,P,D){if(u.imageName){const O=v[u.imageName];return O?O.displaySize[0]*u.scale*El/D+P:0}{const O=d[u.fontStack],j=O&&O[h];return j?j.metrics.advance*u.scale+P:0}}function S1(h,u,d,v){const P=Math.pow(h-u,2);return v?h<u?P/2:2*P:P+Math.abs(d)*d}function zw(h,u,d){let v=0;return h===10&&(v-=1e4),d&&(v+=150),h!==40&&h!==65288||(v+=50),u!==41&&u!==65289||(v+=50),v}function L1(h,u,d,v,P,D){let O=null,j=S1(u,d,P,D);for(const K of v){const ee=S1(u-K.x,d,P,D)+K.badness;ee<=j&&(O=K,j=ee)}return{index:h,x:u,priorBreak:O,badness:j}}function P1(h){return h?P1(h.priorBreak).concat(h.index):[]}function Ry(h,u,d,v,P,D){if(!h)return[];const O=[],j=function(ve,Re,Ue,qe,st,xt){let It=0;for(let fn=0;fn<ve.length();fn++){const $t=ve.getSection(fn);It+=C1(ve.getCharCode(fn),$t,qe,st,Re,xt)}return It/Math.max(1,Math.ceil(It/Ue))}(h,u,d,v,P,D),K=h.text.indexOf("​")>=0;let ee=0;for(let ve=0;ve<h.length();ve++){const Re=h.getSection(ve),Ue=h.getCharCode(ve);if(Kg[Ue]||(ee+=C1(Ue,Re,v,P,u,D)),ve<h.length()-1){const qe=!((ce=Ue)<11904)&&(!!ie["CJK Compatibility Forms"](ce)||!!ie["CJK Compatibility"](ce)||!!ie["CJK Strokes"](ce)||!!ie["CJK Symbols and Punctuation"](ce)||!!ie["Enclosed CJK Letters and Months"](ce)||!!ie["Halfwidth and Fullwidth Forms"](ce)||!!ie["Ideographic Description Characters"](ce)||!!ie["Vertical Forms"](ce)||gt.test(String.fromCodePoint(ce)));(Nw[Ue]||qe||Re.imageName||ve!==h.length()-2&&Fw[h.getCharCode(ve+1)])&&O.push(L1(ve+1,ee,j,O,zw(Ue,h.getCharCode(ve+1),qe&&K),!1))}}var ce;return P1(L1(h.length(),ee,j,O,0,!0))}function By(h){let u=.5,d=.5;switch(h){case"right":case"top-right":case"bottom-right":u=1;break;case"left":case"top-left":case"bottom-left":u=0}switch(h){case"bottom":case"bottom-right":case"bottom-left":d=1;break;case"top":case"top-right":case"top-left":d=0}return{horizontalAlign:u,verticalAlign:d}}function jw(h,u,d){const v=u.getMaxScale()*El,{maxImageWidth:P,maxImageHeight:D}=u.getMaxImageSize(h),O=Math.max(v,D*d);return{verticalLineContentWidth:Math.max(v,P*d),horizontalLineContentHeight:O}}function E1(h){switch(h){case"top":return 0;case"center":return .5;default:return 1}}function M1(h,u,d){return!(h===a.al.horizontal||!u&&!kt(d)||u&&(Kg[d]||(v=d,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(v)))));var v}function T1(h,u,d,v,P,D){const O=D[h.fontStack],j=function(ee,ce,ve,Re){if(ee&&ee.rect)return ee;const Ue=ce[ve.fontStack],qe=Ue&&Ue[Re];return qe?{rect:null,metrics:qe.metrics}:null}(O&&O[u],P,h,u);if(j===null)return null;let K;if(d)K=v.verticalLineContentWidth-h.scale*El;else{const ee=E1(h.verticalAlign);K=(v.horizontalLineContentHeight-h.scale*El)*ee}return{rect:j.rect,metrics:j.metrics,baselineOffset:K}}function Uw(h,u,d,v,P){const D=P[h.imageName];if(!D)return null;const O=D.paddedRect,j=D.displaySize,K={width:j[0],height:j[1],left:Mc,top:-3,advance:u?j[1]:j[0]};let ee;if(u)ee=v.verticalLineContentWidth-j[1]*h.scale;else{const ce=E1(h.verticalAlign);ee=(v.horizontalLineContentHeight-j[1]*h.scale)*ce}return{rect:O,metrics:K,baselineOffset:ee,imageOffset:(u?j[0]:j[1])*h.scale-El*d}}function Vw(h,u,d,v){if(v===0)return;const P=h[d],D=(h[d].x+P.metrics.advance*P.scale)*v;for(let O=u;O<=d;O++)h[O].x-=D}function $w(h,u,d){const{horizontalAlign:v,verticalAlign:P}=By(d),D=u[0]-h.displaySize[0]*v,O=u[1]-h.displaySize[1]*P;return{image:h,top:O,bottom:O+h.displaySize[1],left:D,right:D+h.displaySize[0]}}function A1(h){var u,d;let v=h.left,P=h.top,D=h.right-v,O=h.bottom-P;const j=(u=h.image.textFitWidth)!==null&&u!==void 0?u:"stretchOrShrink",K=(d=h.image.textFitHeight)!==null&&d!==void 0?d:"stretchOrShrink",ee=(h.image.content[2]-h.image.content[0])/(h.image.content[3]-h.image.content[1]);if(K==="proportional"){if(j==="stretchOnly"&&D/O<ee||j==="proportional"){const ce=Math.ceil(O*ee);v*=ce/D,D=ce}}else if(j==="proportional"&&K==="stretchOnly"&&ee!==0&&D/O>ee){const ce=Math.ceil(D/ee);P*=ce/O,O=ce}return{x1:v,y1:P,x2:v+D,y2:P+O}}function Um(h,u,d,v,P,D){const O=h.image;let j;if(O.content){const xt=O.content,It=O.pixelRatio||1;j=[xt[0]/It,xt[1]/It,O.displaySize[0]-xt[2]/It,O.displaySize[1]-xt[3]/It]}const K=u.left*D,ee=u.right*D;let ce,ve,Re,Ue;d==="width"||d==="both"?(Ue=P[0]+K-v[3],ve=P[0]+ee+v[1]):(Ue=P[0]+(K+ee-O.displaySize[0])/2,ve=Ue+O.displaySize[0]);const qe=u.top*D,st=u.bottom*D;return d==="height"||d==="both"?(ce=P[1]+qe-v[0],Re=P[1]+st+v[2]):(ce=P[1]+(qe+st-O.displaySize[1])/2,Re=ce+O.displaySize[1]),{image:O,top:ce,right:ve,bottom:Re,left:Ue,collisionPadding:j}}const Vm=255,Ed=128,bf=Vm*Ed;function k1(h,u){const{expression:d}=u;if(d.kind==="constant")return{kind:"constant",layoutSize:d.evaluate(new Qt(h+1))};if(d.kind==="source")return{kind:"source"};{const{zoomStops:v,interpolationType:P}=d;let D=0;for(;D<v.length&&v[D]<=h;)D++;D=Math.max(0,D-1);let O=D;for(;O<v.length&&v[O]<h+1;)O++;O=Math.min(v.length-1,O);const j=v[D],K=v[O];return d.kind==="composite"?{kind:"composite",minZoom:j,maxZoom:K,interpolationType:P}:{kind:"camera",minZoom:j,maxZoom:K,minSize:d.evaluate(new Qt(j)),maxSize:d.evaluate(new Qt(K)),interpolationType:P}}}function Ny(h,u,d){let v="never";const P=h.get(u);return P?v=P:h.get(d)&&(v="always"),v}const Gw=Nm.VectorTileFeature.types,Hw=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Yg(h,u,d,v,P,D,O,j,K,ee,ce,ve,Re){const Ue=j?Math.min(bf,Math.round(j[0])):0,qe=j?Math.min(bf,Math.round(j[1])):0;h.emplaceBack(u,d,Math.round(32*v),Math.round(32*P),D,O,(Ue<<1)+(K?1:0),qe,16*ee,16*ce,256*ve,256*Re)}function Fy(h,u,d){h.emplaceBack(u.x,u.y,d),h.emplaceBack(u.x,u.y,d),h.emplaceBack(u.x,u.y,d),h.emplaceBack(u.x,u.y,d)}function qw(h){for(const u of h.sections)if(ur(u.text))return!0;return!1}class zy{constructor(u){this.layoutVertexArray=new jn,this.indexArray=new Sr,this.programConfigurations=u,this.segments=new Ei,this.dynamicLayoutVertexArray=new In,this.opacityVertexArray=new sr,this.hasVisibleVertices=!1,this.placedSymbolArray=new re}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(u,d,v,P){this.isEmpty()||(v&&(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,Mw.members),this.indexBuffer=u.createIndexBuffer(this.indexArray,d),this.dynamicLayoutVertexBuffer=u.createVertexBuffer(this.dynamicLayoutVertexArray,Tw.members,!0),this.opacityVertexBuffer=u.createVertexBuffer(this.opacityVertexArray,Hw,!0),this.opacityVertexBuffer.itemSize=1),(v||P)&&this.programConfigurations.upload(u))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Gr("SymbolBuffers",zy);class Ip{constructor(u,d,v){this.layoutVertexArray=new u,this.layoutAttributes=d,this.indexArray=new v,this.segments=new Ei,this.collisionVertexArray=new Or}upload(u){this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=u.createVertexBuffer(this.collisionVertexArray,Aw.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Gr("CollisionBuffers",Ip);class Dp{constructor(u){this.collisionBoxArray=u.collisionBoxArray,this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(O=>O.id),this.index=u.index,this.pixelRatio=u.pixelRatio,this.sourceLayerIndex=u.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const d=this.layers[0]._unevaluatedLayout._values;this.textSizeData=k1(this.zoom,d["text-size"]),this.iconSizeData=k1(this.zoom,d["icon-size"]);const v=this.layers[0].layout,P=v.get("symbol-sort-key"),D=v.get("symbol-z-order");this.canOverlap=Ny(v,"text-overlap","text-allow-overlap")!=="never"||Ny(v,"icon-overlap","icon-allow-overlap")!=="never"||v.get("text-ignore-placement")||v.get("icon-ignore-placement"),this.sortFeaturesByKey=D!=="viewport-y"&&!P.isConstant(),this.sortFeaturesByY=(D==="viewport-y"||D==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,v.get("symbol-placement")==="point"&&(this.writingModes=v.get("text-writing-mode").map(O=>a.al[O])),this.stateDependentLayerIds=this.layers.filter(O=>O.isStateDependent()).map(O=>O.id),this.sourceID=u.sourceID}createArrays(){this.text=new zy(new Cd(this.layers,this.zoom,u=>/^text/.test(u))),this.icon=new zy(new Cd(this.layers,this.zoom,u=>/^icon/.test(u))),this.glyphOffsetArray=new ke,this.lineVertexArray=new Ke,this.symbolInstances=new Me,this.textAnchorOffsets=new Tt}calculateGlyphDependencies(u,d,v,P,D){for(let O=0;O<u.length;O++)if(d[u.charCodeAt(O)]=!0,(v||P)&&D){const j=zm[u.charAt(O)];j&&(d[j.charCodeAt(0)]=!0)}}populate(u,d,v){const P=this.layers[0],D=P.layout,O=D.get("text-font"),j=D.get("text-field"),K=D.get("icon-image"),ee=(j.value.kind!=="constant"||j.value.value instanceof Ws&&!j.value.value.isEmpty()||j.value.value.toString().length>0)&&(O.value.kind!=="constant"||O.value.value.length>0),ce=K.value.kind!=="constant"||!!K.value.value||Object.keys(K.parameters).length>0,ve=D.get("symbol-sort-key");if(this.features=[],!ee&&!ce)return;const Re=d.iconDependencies,Ue=d.glyphDependencies,qe=d.availableImages,st=new Qt(this.zoom);for(const{feature:xt,id:It,index:fn,sourceLayerIndex:$t}of u){const Oe=P._featureFilter.needGeometry,ft=hh(xt,Oe);if(!P._featureFilter.filter(st,ft,v))continue;let Wt,$n;if(Oe||(ft.geometry=Ec(xt)),ee){const Wn=P.getValueAndResolveTokens("text-field",ft,v,qe),rr=Ws.factory(Wn),Ar=this.hasRTLText=this.hasRTLText||qw(rr);(!Ar||Zn.getRTLTextPluginStatus()==="unavailable"||Ar&&Zn.isParsed())&&(Wt=Iw(rr,P,ft))}if(ce){const Wn=P.getValueAndResolveTokens("icon-image",ft,v,qe);$n=Wn instanceof La?Wn:La.fromString(Wn)}if(!Wt&&!$n)continue;const _r=this.sortFeaturesByKey?ve.evaluate(ft,{},v):void 0;if(this.features.push({id:It,text:Wt,icon:$n,index:fn,sourceLayerIndex:$t,geometry:ft.geometry,properties:xt.properties,type:Gw[xt.type],sortKey:_r}),$n&&(Re[$n.name]=!0),Wt){const Wn=O.evaluate(ft,{},v).join(","),rr=D.get("text-rotation-alignment")!=="viewport"&&D.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(a.al.vertical)>=0;for(const Ar of Wt.sections)if(Ar.image)Re[Ar.image.name]=!0;else{const xr=Ee(Wt.toString()),kr=Ar.fontStack||Wn,lr=Ue[kr]=Ue[kr]||{};this.calculateGlyphDependencies(Ar.text,lr,rr,this.allowVerticalPlacement,xr)}}}D.get("symbol-placement")==="line"&&(this.features=function(xt){const It={},fn={},$t=[];let Oe=0;function ft(Wn){$t.push(xt[Wn]),Oe++}function Wt(Wn,rr,Ar){const xr=fn[Wn];return delete fn[Wn],fn[rr]=xr,$t[xr].geometry[0].pop(),$t[xr].geometry[0]=$t[xr].geometry[0].concat(Ar[0]),xr}function $n(Wn,rr,Ar){const xr=It[rr];return delete It[rr],It[Wn]=xr,$t[xr].geometry[0].shift(),$t[xr].geometry[0]=Ar[0].concat($t[xr].geometry[0]),xr}function _r(Wn,rr,Ar){const xr=Ar?rr[0][rr[0].length-1]:rr[0][0];return`${Wn}:${xr.x}:${xr.y}`}for(let Wn=0;Wn<xt.length;Wn++){const rr=xt[Wn],Ar=rr.geometry,xr=rr.text?rr.text.toString():null;if(!xr){ft(Wn);continue}const kr=_r(xr,Ar),lr=_r(xr,Ar,!0);if(kr in fn&&lr in It&&fn[kr]!==It[lr]){const Qr=$n(kr,lr,Ar),_i=Wt(kr,lr,$t[Qr].geometry);delete It[kr],delete fn[lr],fn[_r(xr,$t[_i].geometry,!0)]=_i,$t[Qr].geometry=null}else kr in fn?Wt(kr,lr,Ar):lr in It?$n(kr,lr,Ar):(ft(Wn),It[kr]=Oe-1,fn[lr]=Oe-1)}return $t.filter(Wn=>Wn.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((xt,It)=>xt.sortKey-It.sortKey)}update(u,d,v){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(u,d,this.layers,v),this.icon.programConfigurations.updatePaintArrays(u,d,this.layers,v))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(u){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(u),this.iconCollisionBox.upload(u)),this.text.upload(u,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(u,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(u,d){const v=this.lineVertexArray.length;if(u.segment!==void 0){let P=u.dist(d[u.segment+1]),D=u.dist(d[u.segment]);const O={};for(let j=u.segment+1;j<d.length;j++)O[j]={x:d[j].x,y:d[j].y,tileUnitDistanceFromAnchor:P},j<d.length-1&&(P+=d[j+1].dist(d[j]));for(let j=u.segment||0;j>=0;j--)O[j]={x:d[j].x,y:d[j].y,tileUnitDistanceFromAnchor:D},j>0&&(D+=d[j-1].dist(d[j]));for(let j=0;j<d.length;j++){const K=O[j];this.lineVertexArray.emplaceBack(K.x,K.y,K.tileUnitDistanceFromAnchor)}}return{lineStartIndex:v,lineLength:this.lineVertexArray.length-v}}addSymbols(u,d,v,P,D,O,j,K,ee,ce,ve,Re){const Ue=u.indexArray,qe=u.layoutVertexArray,st=u.segments.prepareSegment(4*d.length,qe,Ue,this.canOverlap?O.sortKey:void 0),xt=this.glyphOffsetArray.length,It=st.vertexLength,fn=this.allowVerticalPlacement&&j===a.al.vertical?Math.PI/2:0,$t=O.text&&O.text.sections;for(let Oe=0;Oe<d.length;Oe++){const{tl:ft,tr:Wt,bl:$n,br:_r,tex:Wn,pixelOffsetTL:rr,pixelOffsetBR:Ar,minFontScaleX:xr,minFontScaleY:kr,glyphOffset:lr,isSDF:Qr,sectionIndex:_i}=d[Oe],hi=st.vertexLength,si=lr[1];Yg(qe,K.x,K.y,ft.x,si+ft.y,Wn.x,Wn.y,v,Qr,rr.x,rr.y,xr,kr),Yg(qe,K.x,K.y,Wt.x,si+Wt.y,Wn.x+Wn.w,Wn.y,v,Qr,Ar.x,rr.y,xr,kr),Yg(qe,K.x,K.y,$n.x,si+$n.y,Wn.x,Wn.y+Wn.h,v,Qr,rr.x,Ar.y,xr,kr),Yg(qe,K.x,K.y,_r.x,si+_r.y,Wn.x+Wn.w,Wn.y+Wn.h,v,Qr,Ar.x,Ar.y,xr,kr),Fy(u.dynamicLayoutVertexArray,K,fn),Ue.emplaceBack(hi,hi+2,hi+1),Ue.emplaceBack(hi+1,hi+2,hi+3),st.vertexLength+=4,st.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(lr[0]),Oe!==d.length-1&&_i===d[Oe+1].sectionIndex||u.programConfigurations.populatePaintArrays(qe.length,O,O.index,{},Re,$t&&$t[_i])}u.placedSymbolArray.emplaceBack(K.x,K.y,xt,this.glyphOffsetArray.length-xt,It,ee,ce,K.segment,v?v[0]:0,v?v[1]:0,P[0],P[1],j,0,!1,0,ve)}_addCollisionDebugVertex(u,d,v,P,D,O){return d.emplaceBack(0,0),u.emplaceBack(v.x,v.y,P,D,Math.round(O.x),Math.round(O.y))}addCollisionDebugVertices(u,d,v,P,D,O,j){const K=D.segments.prepareSegment(4,D.layoutVertexArray,D.indexArray),ee=K.vertexLength,ce=D.layoutVertexArray,ve=D.collisionVertexArray,Re=j.anchorX,Ue=j.anchorY;this._addCollisionDebugVertex(ce,ve,O,Re,Ue,new R(u,d)),this._addCollisionDebugVertex(ce,ve,O,Re,Ue,new R(v,d)),this._addCollisionDebugVertex(ce,ve,O,Re,Ue,new R(v,P)),this._addCollisionDebugVertex(ce,ve,O,Re,Ue,new R(u,P)),K.vertexLength+=4;const qe=D.indexArray;qe.emplaceBack(ee,ee+1),qe.emplaceBack(ee+1,ee+2),qe.emplaceBack(ee+2,ee+3),qe.emplaceBack(ee+3,ee),K.primitiveLength+=4}addDebugCollisionBoxes(u,d,v,P){for(let D=u;D<d;D++){const O=this.collisionBoxArray.get(D);this.addCollisionDebugVertices(O.x1,O.y1,O.x2,O.y2,P?this.textCollisionBox:this.iconCollisionBox,O.anchorPoint,v)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Ip(tr,v1.members,mr),this.iconCollisionBox=new Ip(tr,v1.members,mr);for(let u=0;u<this.symbolInstances.length;u++){const d=this.symbolInstances.get(u);this.addDebugCollisionBoxes(d.textBoxStartIndex,d.textBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.iconBoxStartIndex,d.iconBoxEndIndex,d,!1),this.addDebugCollisionBoxes(d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex,d,!1)}}_deserializeCollisionBoxesForSymbol(u,d,v,P,D,O,j,K,ee){const ce={};for(let ve=d;ve<v;ve++){const Re=u.get(ve);ce.textBox={x1:Re.x1,y1:Re.y1,x2:Re.x2,y2:Re.y2,anchorPointX:Re.anchorPointX,anchorPointY:Re.anchorPointY},ce.textFeatureIndex=Re.featureIndex;break}for(let ve=P;ve<D;ve++){const Re=u.get(ve);ce.verticalTextBox={x1:Re.x1,y1:Re.y1,x2:Re.x2,y2:Re.y2,anchorPointX:Re.anchorPointX,anchorPointY:Re.anchorPointY},ce.verticalTextFeatureIndex=Re.featureIndex;break}for(let ve=O;ve<j;ve++){const Re=u.get(ve);ce.iconBox={x1:Re.x1,y1:Re.y1,x2:Re.x2,y2:Re.y2,anchorPointX:Re.anchorPointX,anchorPointY:Re.anchorPointY},ce.iconFeatureIndex=Re.featureIndex;break}for(let ve=K;ve<ee;ve++){const Re=u.get(ve);ce.verticalIconBox={x1:Re.x1,y1:Re.y1,x2:Re.x2,y2:Re.y2,anchorPointX:Re.anchorPointX,anchorPointY:Re.anchorPointY},ce.verticalIconFeatureIndex=Re.featureIndex;break}return ce}deserializeCollisionBoxes(u){this.collisionArrays=[];for(let d=0;d<this.symbolInstances.length;d++){const v=this.symbolInstances.get(d);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(u,v.textBoxStartIndex,v.textBoxEndIndex,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v.iconBoxStartIndex,v.iconBoxEndIndex,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(u,d){const v=u.placedSymbolArray.get(d),P=v.vertexStartIndex+4*v.numGlyphs;for(let D=v.vertexStartIndex;D<P;D+=4)u.indexArray.emplaceBack(D,D+2,D+1),u.indexArray.emplaceBack(D+1,D+2,D+3)}getSortedSymbolIndexes(u){if(this.sortedAngle===u&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const d=Math.sin(u),v=Math.cos(u),P=[],D=[],O=[];for(let j=0;j<this.symbolInstances.length;++j){O.push(j);const K=this.symbolInstances.get(j);P.push(0|Math.round(d*K.anchorX+v*K.anchorY)),D.push(K.featureIndex)}return O.sort((j,K)=>P[j]-P[K]||D[K]-D[j]),O}addToSortKeyRanges(u,d){const v=this.sortKeyRanges[this.sortKeyRanges.length-1];v&&v.sortKey===d?v.symbolInstanceEnd=u+1:this.sortKeyRanges.push({sortKey:d,symbolInstanceStart:u,symbolInstanceEnd:u+1})}sortFeatures(u){if(this.sortFeaturesByY&&this.sortedAngle!==u&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(u),this.sortedAngle=u,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const d of this.symbolInstanceIndexes){const v=this.symbolInstances.get(d);this.featureSortOrder.push(v.featureIndex),[v.rightJustifiedTextSymbolIndex,v.centerJustifiedTextSymbolIndex,v.leftJustifiedTextSymbolIndex].forEach((P,D,O)=>{P>=0&&O.indexOf(P)===D&&this.addIndicesForPlacedSymbol(this.text,P)}),v.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,v.verticalPlacedTextSymbolIndex),v.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,v.placedIconSymbolIndex),v.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,v.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let jy,Uy;Gr("SymbolBucket",Dp,{omit:["layers","collisionBoxArray","features","compareText"]}),Dp.MAX_GLYPHS=65535,Dp.addDynamicAttributes=Fy;var $m={get paint(){return Uy=Uy||new pe({"icon-opacity":new I($e.paint_symbol["icon-opacity"]),"icon-color":new I($e.paint_symbol["icon-color"]),"icon-halo-color":new I($e.paint_symbol["icon-halo-color"]),"icon-halo-width":new I($e.paint_symbol["icon-halo-width"]),"icon-halo-blur":new I($e.paint_symbol["icon-halo-blur"]),"icon-translate":new S($e.paint_symbol["icon-translate"]),"icon-translate-anchor":new S($e.paint_symbol["icon-translate-anchor"]),"text-opacity":new I($e.paint_symbol["text-opacity"]),"text-color":new I($e.paint_symbol["text-color"],{runtimeType:Xr,getOverride:h=>h.textColor,hasOverride:h=>!!h.textColor}),"text-halo-color":new I($e.paint_symbol["text-halo-color"]),"text-halo-width":new I($e.paint_symbol["text-halo-width"]),"text-halo-blur":new I($e.paint_symbol["text-halo-blur"]),"text-translate":new S($e.paint_symbol["text-translate"]),"text-translate-anchor":new S($e.paint_symbol["text-translate-anchor"])})},get layout(){return jy=jy||new pe({"symbol-placement":new S($e.layout_symbol["symbol-placement"]),"symbol-spacing":new S($e.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new S($e.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new I($e.layout_symbol["symbol-sort-key"]),"symbol-z-order":new S($e.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new S($e.layout_symbol["icon-allow-overlap"]),"icon-overlap":new S($e.layout_symbol["icon-overlap"]),"icon-ignore-placement":new S($e.layout_symbol["icon-ignore-placement"]),"icon-optional":new S($e.layout_symbol["icon-optional"]),"icon-rotation-alignment":new S($e.layout_symbol["icon-rotation-alignment"]),"icon-size":new I($e.layout_symbol["icon-size"]),"icon-text-fit":new S($e.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new S($e.layout_symbol["icon-text-fit-padding"]),"icon-image":new I($e.layout_symbol["icon-image"]),"icon-rotate":new I($e.layout_symbol["icon-rotate"]),"icon-padding":new I($e.layout_symbol["icon-padding"]),"icon-keep-upright":new S($e.layout_symbol["icon-keep-upright"]),"icon-offset":new I($e.layout_symbol["icon-offset"]),"icon-anchor":new I($e.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new S($e.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new S($e.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new S($e.layout_symbol["text-rotation-alignment"]),"text-field":new I($e.layout_symbol["text-field"]),"text-font":new I($e.layout_symbol["text-font"]),"text-size":new I($e.layout_symbol["text-size"]),"text-max-width":new I($e.layout_symbol["text-max-width"]),"text-line-height":new S($e.layout_symbol["text-line-height"]),"text-letter-spacing":new I($e.layout_symbol["text-letter-spacing"]),"text-justify":new I($e.layout_symbol["text-justify"]),"text-radial-offset":new I($e.layout_symbol["text-radial-offset"]),"text-variable-anchor":new S($e.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new I($e.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new I($e.layout_symbol["text-anchor"]),"text-max-angle":new S($e.layout_symbol["text-max-angle"]),"text-writing-mode":new S($e.layout_symbol["text-writing-mode"]),"text-rotate":new I($e.layout_symbol["text-rotate"]),"text-padding":new S($e.layout_symbol["text-padding"]),"text-keep-upright":new S($e.layout_symbol["text-keep-upright"]),"text-transform":new I($e.layout_symbol["text-transform"]),"text-offset":new I($e.layout_symbol["text-offset"]),"text-allow-overlap":new S($e.layout_symbol["text-allow-overlap"]),"text-overlap":new S($e.layout_symbol["text-overlap"]),"text-ignore-placement":new S($e.layout_symbol["text-ignore-placement"]),"text-optional":new S($e.layout_symbol["text-optional"])})}};class Vy{constructor(u){if(u.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=u.property.overrides?u.property.overrides.runtimeType:pn,this.defaultValue=u}evaluate(u){if(u.formattedSection){const d=this.defaultValue.property.overrides;if(d&&d.hasOverride(u.formattedSection))return d.getOverride(u.formattedSection)}return u.feature&&u.featureState?this.defaultValue.evaluate(u.feature,u.featureState):this.defaultValue.property.specification.default}eachChild(u){this.defaultValue.isConstant()||u(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Gr("FormatSectionOverride",Vy,{omit:["defaultValue"]});class Gm extends Fe{constructor(u){super(u,$m)}recalculate(u,d){if(super.recalculate(u,d),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const v=this.layout.get("text-writing-mode");if(v){const P=[];for(const D of v)P.indexOf(D)<0&&P.push(D);this.layout._values["text-writing-mode"]=P}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(u,d,v,P){const D=this.layout.get(u).evaluate(d,{},v,P),O=this._unevaluatedLayout._values[u];return O.isDataDriven()||ho(O.value)||!D?D:function(j,K){return K.replace(/{([^{}]+)}/g,(ee,ce)=>j&&ce in j?String(j[ce]):"")}(d.properties,D)}createBucket(u){return new Dp(u)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const u of $m.paint.overridableProperties){if(!Gm.hasPaintOverride(this.layout,u))continue;const d=this.paint.get(u),v=new Vy(d),P=new ks(v,d.property.specification);let D=null;D=d.value.kind==="constant"||d.value.kind==="source"?new vi("source",P):new $l("composite",P,d.value.zoomStops),this.paint._values[u]=new ei(d.property,D,d.parameters)}}_handleOverridablePaintPropertyUpdate(u,d,v){return!(!this.layout||d.isDataDriven()||v.isDataDriven())&&Gm.hasPaintOverride(this.layout,u)}static hasPaintOverride(u,d){const v=u.get("text-field"),P=$m.paint.properties[d];let D=!1;const O=j=>{for(const K of j)if(P.overrides&&P.overrides.hasOverride(K))return void(D=!0)};if(v.value.kind==="constant"&&v.value.value instanceof Ws)O(v.value.value.sections);else if(v.value.kind==="source"){const j=ee=>{D||(ee instanceof Bl&&fs(ee.value)===$i?O(ee.value.sections):ee instanceof ca?O(ee.sections):ee.eachChild(j))},K=v.value;K._styleExpression&&j(K._styleExpression.expression)}return D}}let $y;var I1={get paint(){return $y=$y||new pe({"background-color":new S($e.paint_background["background-color"]),"background-pattern":new G($e.paint_background["background-pattern"]),"background-opacity":new S($e.paint_background["background-opacity"])})}};class Ww extends Fe{constructor(u){super(u,I1)}}let D1;var Zw={get paint(){return D1=D1||new pe({"raster-opacity":new S($e.paint_raster["raster-opacity"]),"raster-hue-rotate":new S($e.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new S($e.paint_raster["raster-brightness-min"]),"raster-brightness-max":new S($e.paint_raster["raster-brightness-max"]),"raster-saturation":new S($e.paint_raster["raster-saturation"]),"raster-contrast":new S($e.paint_raster["raster-contrast"]),"raster-resampling":new S($e.paint_raster["raster-resampling"]),"raster-fade-duration":new S($e.paint_raster["raster-fade-duration"])})}};class Xg extends Fe{constructor(u){super(u,Zw)}}class Jg extends Fe{constructor(u){super(u,{}),this.onAdd=d=>{this.implementation.onAdd&&this.implementation.onAdd(d,d.painter.context.gl)},this.onRemove=d=>{this.implementation.onRemove&&this.implementation.onRemove(d,d.painter.context.gl)},this.implementation=u}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Kw{constructor(u){this._methodToThrottle=u,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Yw={once:!0},Hm=63710088e-1;class Gd{constructor(u,d){if(isNaN(u)||isNaN(d))throw new Error(`Invalid LngLat object: (${u}, ${d})`);if(this.lng=+u,this.lat=+d,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Gd(it(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(u){const d=Math.PI/180,v=this.lat*d,P=u.lat*d,D=Math.sin(v)*Math.sin(P)+Math.cos(v)*Math.cos(P)*Math.cos((u.lng-this.lng)*d);return Hm*Math.acos(Math.min(D,1))}static convert(u){if(u instanceof Gd)return u;if(Array.isArray(u)&&(u.length===2||u.length===3))return new Gd(Number(u[0]),Number(u[1]));if(!Array.isArray(u)&&typeof u=="object"&&u!==null)return new Gd(Number("lng"in u?u.lng:u.lon),Number(u.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const O1=2*Math.PI*Hm;function R1(h){return O1*Math.cos(h*Math.PI/180)}function B1(h){return(180+h)/360}function N1(h){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h*Math.PI/360)))/360}function F1(h,u){return h/R1(u)}function Gy(h){return 360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90}function z1(h,u){return h*R1(Gy(u))}class qm{constructor(u,d,v=0){this.x=+u,this.y=+d,this.z=+v}static fromLngLat(u,d=0){const v=Gd.convert(u);return new qm(B1(v.lng),N1(v.lat),F1(d,v.lat))}toLngLat(){return new Gd(360*this.x-180,Gy(this.y))}toAltitude(){return z1(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/O1*(u=Gy(this.y),1/Math.cos(u*Math.PI/180));var u}}function j1(h,u,d){var v=2*Math.PI*6378137/256/Math.pow(2,d);return[h*v-2*Math.PI*6378137/2,u*v-2*Math.PI*6378137/2]}class Hy{constructor(u,d,v){if(!function(P,D,O){return!(P<0||P>25||O<0||O>=Math.pow(2,P)||D<0||D>=Math.pow(2,P))}(u,d,v))throw new Error(`x=${d}, y=${v}, z=${u} outside of bounds. 0<=x<${Math.pow(2,u)}, 0<=y<${Math.pow(2,u)} 0<=z<=25 `);this.z=u,this.x=d,this.y=v,this.key=gc(0,u,u,d,v)}equals(u){return this.z===u.z&&this.x===u.x&&this.y===u.y}url(u,d,v){const P=(O=this.y,j=this.z,K=j1(256*(D=this.x),256*(O=Math.pow(2,j)-O-1),j),ee=j1(256*(D+1),256*(O+1),j),K[0]+","+K[1]+","+ee[0]+","+ee[1]);var D,O,j,K,ee;const ce=function(ve,Re,Ue){let qe,st="";for(let xt=ve;xt>0;xt--)qe=1<<xt-1,st+=(Re&qe?1:0)+(Ue&qe?2:0);return st}(this.z,this.x,this.y);return u[(this.x+this.y)%u.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(v==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,d>1?"@2x":"").replace(/{quadkey}/g,ce).replace(/{bbox-epsg-3857}/g,P)}isChildOf(u){const d=this.z-u.z;return d>0&&u.x===this.x>>d&&u.y===this.y>>d}getTilePoint(u){const d=Math.pow(2,this.z);return new R((u.x*d-this.x)*Le,(u.y*d-this.y)*Le)}toString(){return`${this.z}/${this.x}/${this.y}`}}class U1{constructor(u,d){this.wrap=u,this.canonical=d,this.key=gc(u,d.z,d.z,d.x,d.y)}}class dh{constructor(u,d,v,P,D){if(this.terrainRttPosMatrix32f=null,u<v)throw new Error(`overscaledZ should be >= z; overscaledZ = ${u}; z = ${v}`);this.overscaledZ=u,this.wrap=d,this.canonical=new Hy(v,+P,+D),this.key=gc(d,u,v,P,D)}clone(){return new dh(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(u){return this.overscaledZ===u.overscaledZ&&this.wrap===u.wrap&&this.canonical.equals(u.canonical)}scaledTo(u){if(u>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${u}; overscaledZ = ${this.overscaledZ}`);const d=this.canonical.z-u;return u>this.canonical.z?new dh(u,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new dh(u,this.wrap,u,this.canonical.x>>d,this.canonical.y>>d)}calculateScaledKey(u,d){if(u>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${u}; overscaledZ = ${this.overscaledZ}`);const v=this.canonical.z-u;return u>this.canonical.z?gc(this.wrap*+d,u,this.canonical.z,this.canonical.x,this.canonical.y):gc(this.wrap*+d,u,u,this.canonical.x>>v,this.canonical.y>>v)}isChildOf(u){if(u.wrap!==this.wrap)return!1;const d=this.canonical.z-u.canonical.z;return u.overscaledZ===0||u.overscaledZ<this.overscaledZ&&u.canonical.x===this.canonical.x>>d&&u.canonical.y===this.canonical.y>>d}children(u){if(this.overscaledZ>=u)return[new dh(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const d=this.canonical.z+1,v=2*this.canonical.x,P=2*this.canonical.y;return[new dh(d,this.wrap,d,v,P),new dh(d,this.wrap,d,v+1,P),new dh(d,this.wrap,d,v,P+1),new dh(d,this.wrap,d,v+1,P+1)]}isLessThan(u){return this.wrap<u.wrap||!(this.wrap>u.wrap)&&(this.overscaledZ<u.overscaledZ||!(this.overscaledZ>u.overscaledZ)&&(this.canonical.x<u.canonical.x||!(this.canonical.x>u.canonical.x)&&this.canonical.y<u.canonical.y))}wrapped(){return new dh(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(u){return new dh(this.overscaledZ,u,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new U1(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(u){return this.canonical.getTilePoint(new qm(u.x-this.wrap,u.y))}}function gc(h,u,d,v,P){(h*=2)<0&&(h=-1*h-1);const D=1<<d;return(D*D*h+D*P+v).toString(36)+d.toString(36)+u.toString(36)}Gr("CanonicalTileID",Hy),Gr("OverscaledTileID",dh,{omit:["terrainRttPosMatrix32f"]});class V1{constructor(u,d,v,P=1,D=1,O=1,j=0){if(this.uid=u,d.height!==d.width)throw new RangeError("DEM tiles must be square");if(v&&!["mapbox","terrarium","custom"].includes(v))return void De(`"${v}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=d.height;const K=this.dim=d.height-2;switch(this.data=new Uint32Array(d.data.buffer),v){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=P,this.greenFactor=D,this.blueFactor=O,this.baseShift=j;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let ee=0;ee<K;ee++)this.data[this._idx(-1,ee)]=this.data[this._idx(0,ee)],this.data[this._idx(K,ee)]=this.data[this._idx(K-1,ee)],this.data[this._idx(ee,-1)]=this.data[this._idx(ee,0)],this.data[this._idx(ee,K)]=this.data[this._idx(ee,K-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(K,-1)]=this.data[this._idx(K-1,0)],this.data[this._idx(-1,K)]=this.data[this._idx(0,K-1)],this.data[this._idx(K,K)]=this.data[this._idx(K-1,K-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let ee=0;ee<K;ee++)for(let ce=0;ce<K;ce++){const ve=this.get(ee,ce);ve>this.max&&(this.max=ve),ve<this.min&&(this.min=ve)}}get(u,d){const v=new Uint8Array(this.data.buffer),P=4*this._idx(u,d);return this.unpack(v[P],v[P+1],v[P+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(u,d){if(u<-1||u>=this.dim+1||d<-1||d>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(d+1)*this.stride+(u+1)}unpack(u,d,v){return u*this.redFactor+d*this.greenFactor+v*this.blueFactor-this.baseShift}getPixels(){return new Pl({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(u,d,v){if(this.dim!==u.dim)throw new Error("dem dimension mismatch");let P=d*this.dim,D=d*this.dim+this.dim,O=v*this.dim,j=v*this.dim+this.dim;switch(d){case-1:P=D-1;break;case 1:D=P+1}switch(v){case-1:O=j-1;break;case 1:j=O+1}const K=-d*this.dim,ee=-v*this.dim;for(let ce=O;ce<j;ce++)for(let ve=P;ve<D;ve++)this.data[this._idx(ve,ce)]=u.data[this._idx(ve+K,ce+ee)]}}Gr("DEMData",V1);class $1{constructor(u){this._stringToNumber={},this._numberToString=[];for(let d=0;d<u.length;d++){const v=u[d];this._stringToNumber[v]=d,this._numberToString[d]=v}}encode(u){return this._stringToNumber[u]}decode(u){if(u>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${u} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[u]}}class xf{constructor(u,d,v,P,D){this.type="Feature",this._vectorTileFeature=u,u._z=d,u._x=v,u._y=P,this.properties=u.properties,this.id=D}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(u){this._geometry=u}toJSON(){const u={geometry:this.geometry};for(const d in this)d!=="_geometry"&&d!=="_vectorTileFeature"&&(u[d]=this[d]);return u}}class ls{constructor(u,d){this.tileID=u,this.x=u.canonical.x,this.y=u.canonical.y,this.z=u.canonical.z,this.grid=new zu(Le,16,0),this.grid3D=new zu(Le,16,0),this.featureIndexArray=new At,this.promoteId=d}insert(u,d,v,P,D,O){const j=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(v,P,D);const K=O?this.grid3D:this.grid;for(let ee=0;ee<d.length;ee++){const ce=d[ee],ve=[1/0,1/0,-1/0,-1/0];for(let Re=0;Re<ce.length;Re++){const Ue=ce[Re];ve[0]=Math.min(ve[0],Ue.x),ve[1]=Math.min(ve[1],Ue.y),ve[2]=Math.max(ve[2],Ue.x),ve[3]=Math.max(ve[3],Ue.y)}ve[0]<Le&&ve[1]<Le&&ve[2]>=0&&ve[3]>=0&&K.insert(j,ve[0],ve[1],ve[2],ve[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Nm.VectorTile(new Dy(this.rawTileData)).layers,this.sourceLayerCoder=new $1(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(u,d,v,P){this.loadVTLayers();const D=u.params,O=Le/u.tileSize/u.scale,j=Ao(D.filter),K=u.queryGeometry,ee=u.queryPadding*O,ce=Tc(K),ve=this.grid.query(ce.minX-ee,ce.minY-ee,ce.maxX+ee,ce.maxY+ee),Re=Tc(u.cameraQueryGeometry),Ue=this.grid3D.query(Re.minX-ee,Re.minY-ee,Re.maxX+ee,Re.maxY+ee,(xt,It,fn,$t)=>function(Oe,ft,Wt,$n,_r){for(const rr of Oe)if(ft<=rr.x&&Wt<=rr.y&&$n>=rr.x&&_r>=rr.y)return!0;const Wn=[new R(ft,Wt),new R(ft,_r),new R($n,_r),new R($n,Wt)];if(Oe.length>2){for(const rr of Wn)if(Ld(Oe,rr))return!0}for(let rr=0;rr<Oe.length-1;rr++)if(oy(Oe[rr],Oe[rr+1],Wn))return!0;return!1}(u.cameraQueryGeometry,xt-ee,It-ee,fn+ee,$t+ee));for(const xt of Ue)ve.push(xt);ve.sort(Ml);const qe={};let st;for(let xt=0;xt<ve.length;xt++){const It=ve[xt];if(It===st)continue;st=It;const fn=this.featureIndexArray.get(It);let $t=null;this.loadMatchingFeature(qe,fn.bucketIndex,fn.sourceLayerIndex,fn.featureIndex,j,D.layers,D.availableImages,d,v,P,(Oe,ft,Wt)=>($t||($t=Ec(Oe)),ft.queryIntersectsFeature({queryGeometry:K,feature:Oe,featureState:Wt,geometry:$t,zoom:this.z,transform:u.transform,pixelsToTileUnits:O,pixelPosMatrix:u.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:u.getElevation})))}return qe}loadMatchingFeature(u,d,v,P,D,O,j,K,ee,ce,ve){const Re=this.bucketLayerIDs[d];if(O&&!Re.some(xt=>O.has(xt)))return;const Ue=this.sourceLayerCoder.decode(v),qe=this.vtLayers[Ue].feature(P);if(D.needGeometry){const xt=hh(qe,!0);if(!D.filter(new Qt(this.tileID.overscaledZ),xt,this.tileID.canonical))return}else if(!D.filter(new Qt(this.tileID.overscaledZ),qe))return;const st=this.getId(qe,Ue);for(let xt=0;xt<Re.length;xt++){const It=Re[xt];if(O&&!O.has(It))continue;const fn=K[It];if(!fn)continue;let $t={};st&&ce&&($t=ce.getState(fn.sourceLayer||"_geojsonTileLayer",st));const Oe=lt({},ee[It]);Oe.paint=G1(Oe.paint,fn.paint,qe,$t,j),Oe.layout=G1(Oe.layout,fn.layout,qe,$t,j);const ft=!ve||ve(qe,fn,$t);if(!ft)continue;const Wt=new xf(qe,this.z,this.x,this.y,st);Wt.layer=Oe;let $n=u[It];$n===void 0&&($n=u[It]=[]),$n.push({featureIndex:P,feature:Wt,intersectionZ:ft})}}lookupSymbolFeatures(u,d,v,P,D,O,j,K){const ee={};this.loadVTLayers();const ce=Ao(D);for(const ve of u)this.loadMatchingFeature(ee,v,P,ve,ce,O,j,K,d);return ee}hasLayer(u){for(const d of this.bucketLayerIDs)for(const v of d)if(u===v)return!0;return!1}getId(u,d){var v;let P=u.id;return this.promoteId&&(P=u.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[d]],typeof P=="boolean"&&(P=Number(P)),P===void 0&&(!((v=u.properties)===null||v===void 0)&&v.cluster)&&this.promoteId&&(P=Number(u.properties.cluster_id))),P}}function G1(h,u,d,v,P){return wt(h,(D,O)=>{const j=u instanceof y?u.get(O):null;return j&&j.evaluate?j.evaluate(d,v,P):j})}function Tc(h){let u=1/0,d=1/0,v=-1/0,P=-1/0;for(const D of h)u=Math.min(u,D.x),d=Math.min(d,D.y),v=Math.max(v,D.x),P=Math.max(P,D.y);return{minX:u,minY:d,maxX:v,maxY:P}}function Ml(h,u){return u-h}function H1(h,u,d,v,P){const D=[];for(let O=0;O<h.length;O++){const j=h[O];let K;for(let ee=0;ee<j.length-1;ee++){let ce=j[ee],ve=j[ee+1];ce.x<u&&ve.x<u||(ce.x<u?ce=new R(u,ce.y+(u-ce.x)/(ve.x-ce.x)*(ve.y-ce.y))._round():ve.x<u&&(ve=new R(u,ce.y+(u-ce.x)/(ve.x-ce.x)*(ve.y-ce.y))._round()),ce.y<d&&ve.y<d||(ce.y<d?ce=new R(ce.x+(d-ce.y)/(ve.y-ce.y)*(ve.x-ce.x),d)._round():ve.y<d&&(ve=new R(ce.x+(d-ce.y)/(ve.y-ce.y)*(ve.x-ce.x),d)._round()),ce.x>=v&&ve.x>=v||(ce.x>=v?ce=new R(v,ce.y+(v-ce.x)/(ve.x-ce.x)*(ve.y-ce.y))._round():ve.x>=v&&(ve=new R(v,ce.y+(v-ce.x)/(ve.x-ce.x)*(ve.y-ce.y))._round()),ce.y>=P&&ve.y>=P||(ce.y>=P?ce=new R(ce.x+(P-ce.y)/(ve.y-ce.y)*(ve.x-ce.x),P)._round():ve.y>=P&&(ve=new R(ce.x+(P-ce.y)/(ve.y-ce.y)*(ve.x-ce.x),P)._round()),K&&ce.equals(K[K.length-1])||(K=[ce],D.push(K)),K.push(ve)))))}}return D}Gr("FeatureIndex",ls,{omit:["rawTileData","sourceLayerCoder"]});class Ac extends R{constructor(u,d,v,P){super(u,d),this.angle=v,P!==void 0&&(this.segment=P)}clone(){return new Ac(this.x,this.y,this.angle,this.segment)}}function q1(h,u,d,v,P){if(u.segment===void 0||d===0)return!0;let D=u,O=u.segment+1,j=0;for(;j>-d/2;){if(O--,O<0)return!1;j-=h[O].dist(D),D=h[O]}j+=h[O].dist(h[O+1]),O++;const K=[];let ee=0;for(;j<d/2;){const ce=h[O],ve=h[O+1];if(!ve)return!1;let Re=h[O-1].angleTo(ce)-ce.angleTo(ve);for(Re=Math.abs((Re+3*Math.PI)%(2*Math.PI)-Math.PI),K.push({distance:j,angleDelta:Re}),ee+=Re;j-K[0].distance>v;)ee-=K.shift().angleDelta;if(ee>P)return!1;O++,j+=ce.dist(ve)}return!0}function W1(h){let u=0;for(let d=0;d<h.length-1;d++)u+=h[d].dist(h[d+1]);return u}function Z1(h,u,d){return h?.6*u*d:0}function K1(h,u){return Math.max(h?h.right-h.left:0,u?u.right-u.left:0)}function Xw(h,u,d,v,P,D){const O=Z1(d,P,D),j=K1(d,v)*D;let K=0;const ee=W1(h)/2;for(let ce=0;ce<h.length-1;ce++){const ve=h[ce],Re=h[ce+1],Ue=ve.dist(Re);if(K+Ue>ee){const qe=(ee-K)/Ue,st=vs.number(ve.x,Re.x,qe),xt=vs.number(ve.y,Re.y,qe),It=new Ac(st,xt,Re.angleTo(ve),ce);return It._round(),!O||q1(h,It,j,O,u)?It:void 0}K+=Ue}}function qy(h,u,d,v,P,D,O,j,K){const ee=Z1(v,D,O),ce=K1(v,P),ve=ce*O,Re=h[0].x===0||h[0].x===K||h[0].y===0||h[0].y===K;return u-ve<u/4&&(u=ve+u/4),Y1(h,Re?u/2*j%u:(ce/2+2*D)*O*j%u,u,ee,d,ve,Re,!1,K)}function Y1(h,u,d,v,P,D,O,j,K){const ee=D/2,ce=W1(h);let ve=0,Re=u-d,Ue=[];for(let qe=0;qe<h.length-1;qe++){const st=h[qe],xt=h[qe+1],It=st.dist(xt),fn=xt.angleTo(st);for(;Re+d<ve+It;){Re+=d;const $t=(Re-ve)/It,Oe=vs.number(st.x,xt.x,$t),ft=vs.number(st.y,xt.y,$t);if(Oe>=0&&Oe<K&&ft>=0&&ft<K&&Re-ee>=0&&Re+ee<=ce){const Wt=new Ac(Oe,ft,fn,qe);Wt._round(),v&&!q1(h,Wt,D,v,P)||Ue.push(Wt)}}ve+=It}return j||Ue.length||O||(Ue=Y1(h,ve/2,d,v,P,D,O,!0,K)),Ue}Gr("Anchor",Ac);const fh=Mc;function Wy(h,u,d,v){const P=[],D=h.image,O=D.pixelRatio,j=D.paddedRect.w-2*fh,K=D.paddedRect.h-2*fh;let ee={x1:h.left,y1:h.top,x2:h.right,y2:h.bottom};const ce=D.stretchX||[[0,j]],ve=D.stretchY||[[0,K]],Re=(lr,Qr)=>lr+Qr[1]-Qr[0],Ue=ce.reduce(Re,0),qe=ve.reduce(Re,0),st=j-Ue,xt=K-qe;let It=0,fn=Ue,$t=0,Oe=qe,ft=0,Wt=st,$n=0,_r=xt;if(D.content&&v){const lr=D.content,Qr=lr[2]-lr[0],_i=lr[3]-lr[1];(D.textFitWidth||D.textFitHeight)&&(ee=A1(h)),It=Kf(ce,0,lr[0]),$t=Kf(ve,0,lr[1]),fn=Kf(ce,lr[0],lr[2]),Oe=Kf(ve,lr[1],lr[3]),ft=lr[0]-It,$n=lr[1]-$t,Wt=Qr-fn,_r=_i-Oe}const Wn=ee.x1,rr=ee.y1,Ar=ee.x2-Wn,xr=ee.y2-rr,kr=(lr,Qr,_i,hi)=>{const si=va(lr.stretch-It,fn,Ar,Wn),ws=Wm(lr.fixed-ft,Wt,lr.stretch,Ue),_a=va(Qr.stretch-$t,Oe,xr,rr),Tl=Wm(Qr.fixed-$n,_r,Qr.stretch,qe),Vu=va(_i.stretch-It,fn,Ar,Wn),$u=Wm(_i.fixed-ft,Wt,_i.stretch,Ue),Ic=va(hi.stretch-$t,Oe,xr,rr),_u=Wm(hi.fixed-$n,_r,hi.stretch,qe),aa=new R(si,_a),Kl=new R(Vu,_a),bu=new R(Vu,Ic),Yl=new R(si,Ic),rc=new R(ws/O,Tl/O),ph=new R($u/O,_u/O),Xl=u*Math.PI/180;if(Xl){const Jl=Math.sin(Xl),Ql=Math.cos(Xl),cl=[Ql,-Jl,Jl,Ql];aa._matMult(cl),Kl._matMult(cl),Yl._matMult(cl),bu._matMult(cl)}const Dc=lr.stretch+lr.fixed,Al=Qr.stretch+Qr.fixed;return{tl:aa,tr:Kl,bl:Yl,br:bu,tex:{x:D.paddedRect.x+fh+Dc,y:D.paddedRect.y+fh+Al,w:_i.stretch+_i.fixed-Dc,h:hi.stretch+hi.fixed-Al},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:rc,pixelOffsetBR:ph,minFontScaleX:Wt/O/Ar,minFontScaleY:_r/O/xr,isSDF:d}};if(v&&(D.stretchX||D.stretchY)){const lr=Da(ce,st,Ue),Qr=Da(ve,xt,qe);for(let _i=0;_i<lr.length-1;_i++){const hi=lr[_i],si=lr[_i+1];for(let ws=0;ws<Qr.length-1;ws++)P.push(kr(hi,Qr[ws],si,Qr[ws+1]))}}else P.push(kr({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:j+1},{fixed:0,stretch:K+1}));return P}function Kf(h,u,d){let v=0;for(const P of h)v+=Math.max(u,Math.min(d,P[1]))-Math.max(u,Math.min(d,P[0]));return v}function Da(h,u,d){const v=[{fixed:-1,stretch:0}];for(const[P,D]of h){const O=v[v.length-1];v.push({fixed:P-O.stretch,stretch:O.stretch}),v.push({fixed:P-O.stretch,stretch:O.stretch+(D-P)})}return v.push({fixed:u+fh,stretch:d}),v}function va(h,u,d,v){return h/u*d+v}function Wm(h,u,d,v){return h-u*d/v}class Qg{constructor(u,d,v,P,D,O,j,K,ee,ce){var ve;if(this.boxStartIndex=u.length,ee){let Re=O.top,Ue=O.bottom;const qe=O.collisionPadding;qe&&(Re-=qe[1],Ue+=qe[3]);let st=Ue-Re;st>0&&(st=Math.max(10,st),this.circleDiameter=st)}else{const Re=!((ve=O.image)===null||ve===void 0)&&ve.content&&(O.image.textFitWidth||O.image.textFitHeight)?A1(O):{x1:O.left,y1:O.top,x2:O.right,y2:O.bottom};Re.y1=Re.y1*j-K[0],Re.y2=Re.y2*j+K[2],Re.x1=Re.x1*j-K[3],Re.x2=Re.x2*j+K[1];const Ue=O.collisionPadding;if(Ue&&(Re.x1-=Ue[0]*j,Re.y1-=Ue[1]*j,Re.x2+=Ue[2]*j,Re.y2+=Ue[3]*j),ce){const qe=new R(Re.x1,Re.y1),st=new R(Re.x2,Re.y1),xt=new R(Re.x1,Re.y2),It=new R(Re.x2,Re.y2),fn=ce*Math.PI/180;qe._rotate(fn),st._rotate(fn),xt._rotate(fn),It._rotate(fn),Re.x1=Math.min(qe.x,st.x,xt.x,It.x),Re.x2=Math.max(qe.x,st.x,xt.x,It.x),Re.y1=Math.min(qe.y,st.y,xt.y,It.y),Re.y2=Math.max(qe.y,st.y,xt.y,It.y)}u.emplaceBack(d.x,d.y,Re.x1,Re.y1,Re.x2,Re.y2,v,P,D)}this.boxEndIndex=u.length}}class Jw{constructor(u=[],d=(v,P)=>v<P?-1:v>P?1:0){if(this.data=u,this.length=this.data.length,this.compare=d,this.length>0)for(let v=(this.length>>1)-1;v>=0;v--)this._down(v)}push(u){this.data.push(u),this._up(this.length++)}pop(){if(this.length===0)return;const u=this.data[0],d=this.data.pop();return--this.length>0&&(this.data[0]=d,this._down(0)),u}peek(){return this.data[0]}_up(u){const{data:d,compare:v}=this,P=d[u];for(;u>0;){const D=u-1>>1,O=d[D];if(v(P,O)>=0)break;d[u]=O,u=D}d[u]=P}_down(u){const{data:d,compare:v}=this,P=this.length>>1,D=d[u];for(;u<P;){let O=1+(u<<1);const j=O+1;if(j<this.length&&v(d[j],d[O])<0&&(O=j),v(d[O],D)>=0)break;d[u]=d[O],u=O}d[u]=D}}function Qw(h,u=1,d=!1){let v=1/0,P=1/0,D=-1/0,O=-1/0;const j=h[0];for(let Ue=0;Ue<j.length;Ue++){const qe=j[Ue];(!Ue||qe.x<v)&&(v=qe.x),(!Ue||qe.y<P)&&(P=qe.y),(!Ue||qe.x>D)&&(D=qe.x),(!Ue||qe.y>O)&&(O=qe.y)}const K=Math.min(D-v,O-P);let ee=K/2;const ce=new Jw([],e5);if(K===0)return new R(v,P);for(let Ue=v;Ue<D;Ue+=K)for(let qe=P;qe<O;qe+=K)ce.push(new Op(Ue+ee,qe+ee,ee,h));let ve=function(Ue){let qe=0,st=0,xt=0;const It=Ue[0];for(let fn=0,$t=It.length,Oe=$t-1;fn<$t;Oe=fn++){const ft=It[fn],Wt=It[Oe],$n=ft.x*Wt.y-Wt.x*ft.y;st+=(ft.x+Wt.x)*$n,xt+=(ft.y+Wt.y)*$n,qe+=3*$n}return new Op(st/qe,xt/qe,0,Ue)}(h),Re=ce.length;for(;ce.length;){const Ue=ce.pop();(Ue.d>ve.d||!ve.d)&&(ve=Ue,d&&console.log("found best %d after %d probes",Math.round(1e4*Ue.d)/1e4,Re)),Ue.max-ve.d<=u||(ee=Ue.h/2,ce.push(new Op(Ue.p.x-ee,Ue.p.y-ee,ee,h)),ce.push(new Op(Ue.p.x+ee,Ue.p.y-ee,ee,h)),ce.push(new Op(Ue.p.x-ee,Ue.p.y+ee,ee,h)),ce.push(new Op(Ue.p.x+ee,Ue.p.y+ee,ee,h)),Re+=4)}return d&&(console.log(`num probes: ${Re}`),console.log(`best distance: ${ve.d}`)),ve.p}function e5(h,u){return u.max-h.max}function Op(h,u,d,v){this.p=new R(h,u),this.h=d,this.d=function(P,D){let O=!1,j=1/0;for(let K=0;K<D.length;K++){const ee=D[K];for(let ce=0,ve=ee.length,Re=ve-1;ce<ve;Re=ce++){const Ue=ee[ce],qe=ee[Re];Ue.y>P.y!=qe.y>P.y&&P.x<(qe.x-Ue.x)*(P.y-Ue.y)/(qe.y-Ue.y)+Ue.x&&(O=!O),j=Math.min(j,Mm(P,Ue,qe))}}return(O?1:-1)*Math.sqrt(j)}(this.p,v),this.max=this.d+this.h*Math.SQRT2}var Uu;a.aB=void 0,(Uu=a.aB||(a.aB={}))[Uu.center=1]="center",Uu[Uu.left=2]="left",Uu[Uu.right=3]="right",Uu[Uu.top=4]="top",Uu[Uu.bottom=5]="bottom",Uu[Uu["top-left"]=6]="top-left",Uu[Uu["top-right"]=7]="top-right",Uu[Uu["bottom-left"]=8]="bottom-left",Uu[Uu["bottom-right"]=9]="bottom-right";const Hd=7,Yf=Number.POSITIVE_INFINITY;function e0(h,u){return u[1]!==Yf?function(d,v,P){let D=0,O=0;switch(v=Math.abs(v),P=Math.abs(P),d){case"top-right":case"top-left":case"top":O=P-Hd;break;case"bottom-right":case"bottom-left":case"bottom":O=-P+Hd}switch(d){case"top-right":case"bottom-right":case"right":D=-v;break;case"top-left":case"bottom-left":case"left":D=v}return[D,O]}(h,u[0],u[1]):function(d,v){let P=0,D=0;v<0&&(v=0);const O=v/Math.SQRT2;switch(d){case"top-right":case"top-left":D=O-Hd;break;case"bottom-right":case"bottom-left":D=-O+Hd;break;case"bottom":D=-v+Hd;break;case"top":D=v-Hd}switch(d){case"top-right":case"bottom-right":P=-O;break;case"top-left":case"bottom-left":P=O;break;case"left":P=v;break;case"right":P=-v}return[P,D]}(h,u[0])}function X1(h,u,d){var v;const P=h.layout,D=(v=P.get("text-variable-anchor-offset"))===null||v===void 0?void 0:v.evaluate(u,{},d);if(D){const j=D.values,K=[];for(let ee=0;ee<j.length;ee+=2){const ce=K[ee]=j[ee],ve=j[ee+1].map(Re=>Re*El);ce.startsWith("top")?ve[1]-=Hd:ce.startsWith("bottom")&&(ve[1]+=Hd),K[ee+1]=ve}return new us(K)}const O=P.get("text-variable-anchor");if(O){let j;j=h._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[P.get("text-radial-offset").evaluate(u,{},d)*El,Yf]:P.get("text-offset").evaluate(u,{},d).map(ee=>ee*El);const K=[];for(const ee of O)K.push(ee,e0(ee,j));return new us(K)}return null}function t0(h){switch(h){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function n0(h,u,d,v,P,D,O,j,K,ee,ce,ve){let Re=D.textMaxSize.evaluate(u,{});Re===void 0&&(Re=O);const Ue=h.layers[0].layout,qe=Ue.get("icon-offset").evaluate(u,{},ce),st=Xf(d.horizontal),xt=O/24,It=h.tilePixelRatio*xt,fn=h.tilePixelRatio*Re/24,$t=h.tilePixelRatio*j,Oe=h.tilePixelRatio*Ue.get("symbol-spacing"),ft=Ue.get("text-padding")*h.tilePixelRatio,Wt=function(_i,hi,si,ws=1){const _a=_i.get("icon-padding").evaluate(hi,{},si),Tl=_a&&_a.values;return[Tl[0]*ws,Tl[1]*ws,Tl[2]*ws,Tl[3]*ws]}(Ue,u,ce,h.tilePixelRatio),$n=Ue.get("text-max-angle")/180*Math.PI,_r=Ue.get("text-rotation-alignment")!=="viewport"&&Ue.get("symbol-placement")!=="point",Wn=Ue.get("icon-rotation-alignment")==="map"&&Ue.get("symbol-placement")!=="point",rr=Ue.get("symbol-placement"),Ar=Oe/2,xr=Ue.get("icon-text-fit");let kr;v&&xr!=="none"&&(h.allowVerticalPlacement&&d.vertical&&(kr=Um(v,d.vertical,xr,Ue.get("icon-text-fit-padding"),qe,xt)),st&&(v=Um(v,st,xr,Ue.get("icon-text-fit-padding"),qe,xt)));const lr=ce?ve.line.getGranularityForZoomLevel(ce.z):1,Qr=(_i,hi)=>{hi.x<0||hi.x>=Le||hi.y<0||hi.y>=Le||function(si,ws,_a,Tl,Vu,$u,Ic,_u,aa,Kl,bu,Yl,rc,ph,Xl,Dc,Al,Jl,Ql,cl,Oo,sd,Np,od,n5){const Fp=si.addToLineVertexArray(ws,_a);let Jf,zp,jp,Up,tb=0,nb=0,rb=0,ib=0,Jy=-1,Qy=-1;const qd={};let sb=bo("");if(si.allowVerticalPlacement&&Tl.vertical){const sc=_u.layout.get("text-rotate").evaluate(Oo,{},od)+90;jp=new Qg(aa,ws,Kl,bu,Yl,Tl.vertical,rc,ph,Xl,sc),Ic&&(Up=new Qg(aa,ws,Kl,bu,Yl,Ic,Al,Jl,Xl,sc))}if(Vu){const sc=_u.layout.get("icon-rotate").evaluate(Oo,{}),Oc=_u.layout.get("icon-text-fit")!=="none",Qf=Wy(Vu,sc,Np,Oc),mh=Ic?Wy(Ic,sc,Np,Oc):void 0;zp=new Qg(aa,ws,Kl,bu,Yl,Vu,Al,Jl,!1,sc),tb=4*Qf.length;const ep=si.iconSizeData;let Md=null;ep.kind==="source"?(Md=[Ed*_u.layout.get("icon-size").evaluate(Oo,{})],Md[0]>bf&&De(`${si.layerIds[0]}: Value for "icon-size" is >= ${Vm}. Reduce your "icon-size".`)):ep.kind==="composite"&&(Md=[Ed*sd.compositeIconSizes[0].evaluate(Oo,{},od),Ed*sd.compositeIconSizes[1].evaluate(Oo,{},od)],(Md[0]>bf||Md[1]>bf)&&De(`${si.layerIds[0]}: Value for "icon-size" is >= ${Vm}. Reduce your "icon-size".`)),si.addSymbols(si.icon,Qf,Md,cl,Ql,Oo,a.al.none,ws,Fp.lineStartIndex,Fp.lineLength,-1,od),Jy=si.icon.placedSymbolArray.length-1,mh&&(nb=4*mh.length,si.addSymbols(si.icon,mh,Md,cl,Ql,Oo,a.al.vertical,ws,Fp.lineStartIndex,Fp.lineLength,-1,od),Qy=si.icon.placedSymbolArray.length-1)}const i0=Object.keys(Tl.horizontal);for(const sc of i0){const Oc=Tl.horizontal[sc];if(!Jf){sb=bo(Oc.text);const mh=_u.layout.get("text-rotate").evaluate(Oo,{},od);Jf=new Qg(aa,ws,Kl,bu,Yl,Oc,rc,ph,Xl,mh)}const Qf=Oc.positionedLines.length===1;if(rb+=Gc(si,ws,Oc,$u,_u,Xl,Oo,Dc,Fp,Tl.vertical?a.al.horizontal:a.al.horizontalOnly,Qf?i0:[sc],qd,Jy,sd,od),Qf)break}Tl.vertical&&(ib+=Gc(si,ws,Tl.vertical,$u,_u,Xl,Oo,Dc,Fp,a.al.vertical,["vertical"],qd,Qy,sd,od));const ob=Jf?Jf.boxStartIndex:si.collisionBoxArray.length,ab=Jf?Jf.boxEndIndex:si.collisionBoxArray.length,r5=jp?jp.boxStartIndex:si.collisionBoxArray.length,i5=jp?jp.boxEndIndex:si.collisionBoxArray.length,s5=zp?zp.boxStartIndex:si.collisionBoxArray.length,ev=zp?zp.boxEndIndex:si.collisionBoxArray.length,o5=Up?Up.boxStartIndex:si.collisionBoxArray.length,a5=Up?Up.boxEndIndex:si.collisionBoxArray.length;let ad=-1;const ic=(sc,Oc)=>sc&&sc.circleDiameter?Math.max(sc.circleDiameter,Oc):Oc;ad=ic(Jf,ad),ad=ic(jp,ad),ad=ic(zp,ad),ad=ic(Up,ad);const s0=ad>-1?1:0;s0&&(ad*=n5/El),si.glyphOffsetArray.length>=Dp.MAX_GLYPHS&&De("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Oo.sortKey!==void 0&&si.addToSortKeyRanges(si.symbolInstances.length,Oo.sortKey);const l5=X1(_u,Oo,od),[u5,c5]=function(sc,Oc){const Qf=sc.length,mh=Oc==null?void 0:Oc.values;if((mh==null?void 0:mh.length)>0)for(let ep=0;ep<mh.length;ep+=2){const Md=mh[ep+1];sc.emplaceBack(a.aB[mh[ep]],Md[0],Md[1])}return[Qf,sc.length]}(si.textAnchorOffsets,l5);si.symbolInstances.emplaceBack(ws.x,ws.y,qd.right>=0?qd.right:-1,qd.center>=0?qd.center:-1,qd.left>=0?qd.left:-1,qd.vertical||-1,Jy,Qy,sb,ob,ab,r5,i5,s5,ev,o5,a5,Kl,rb,ib,tb,nb,s0,0,rc,ad,u5,c5)}(h,hi,_i,d,v,P,kr,h.layers[0],h.collisionBoxArray,u.index,u.sourceLayerIndex,h.index,It,[ft,ft,ft,ft],_r,K,$t,Wt,Wn,qe,u,D,ee,ce,O)};if(rr==="line")for(const _i of H1(u.geometry,0,0,Le,Le)){const hi=$d(_i,lr),si=qy(hi,Oe,$n,d.vertical||st,v,24,fn,h.overscaling,Le);for(const ws of si)st&&t5(h,st.text,Ar,ws)||Qr(hi,ws)}else if(rr==="line-center"){for(const _i of u.geometry)if(_i.length>1){const hi=$d(_i,lr),si=Xw(hi,$n,d.vertical||st,v,24,fn);si&&Qr(hi,si)}}else if(u.type==="Polygon")for(const _i of sl(u.geometry,0)){const hi=Qw(_i,16);Qr($d(_i[0],lr,!0),new Ac(hi.x,hi.y,0))}else if(u.type==="LineString")for(const _i of u.geometry){const hi=$d(_i,lr);Qr(hi,new Ac(hi[0].x,hi[0].y,0))}else if(u.type==="Point")for(const _i of u.geometry)for(const hi of _i)Qr([hi],new Ac(hi.x,hi.y,0))}function Gc(h,u,d,v,P,D,O,j,K,ee,ce,ve,Re,Ue,qe){const st=function(fn,$t,Oe,ft,Wt,$n,_r,Wn){const rr=ft.layout.get("text-rotate").evaluate($n,{})*Math.PI/180,Ar=[];for(const xr of $t.positionedLines)for(const kr of xr.positionedGlyphs){if(!kr.rect)continue;const lr=kr.rect||{};let Qr=Bw+1,_i=!0,hi=1,si=0;const ws=(Wt||Wn)&&kr.vertical,_a=kr.metrics.advance*kr.scale/2;if(Wn&&$t.verticalizable&&(si=xr.lineOffset/2-(kr.imageName?-(El-kr.metrics.width*kr.scale)/2:(kr.scale-1)*El)),kr.imageName){const Jl=_r[kr.imageName];_i=Jl.sdf,hi=Jl.pixelRatio,Qr=Mc/hi}const Tl=Wt?[kr.x+_a,kr.y]:[0,0];let Vu=Wt?[0,0]:[kr.x+_a+Oe[0],kr.y+Oe[1]-si],$u=[0,0];ws&&($u=Vu,Vu=[0,0]);const Ic=kr.metrics.isDoubleResolution?2:1,_u=(kr.metrics.left-Qr)*kr.scale-_a+Vu[0],aa=(-kr.metrics.top-Qr)*kr.scale+Vu[1],Kl=_u+lr.w/Ic*kr.scale/hi,bu=aa+lr.h/Ic*kr.scale/hi,Yl=new R(_u,aa),rc=new R(Kl,aa),ph=new R(_u,bu),Xl=new R(Kl,bu);if(ws){const Jl=new R(-_a,_a-Wg),Ql=-Math.PI/2,cl=El/2-_a,Oo=new R(5-Wg-cl,-(kr.imageName?cl:0)),sd=new R(...$u);Yl._rotateAround(Ql,Jl)._add(Oo)._add(sd),rc._rotateAround(Ql,Jl)._add(Oo)._add(sd),ph._rotateAround(Ql,Jl)._add(Oo)._add(sd),Xl._rotateAround(Ql,Jl)._add(Oo)._add(sd)}if(rr){const Jl=Math.sin(rr),Ql=Math.cos(rr),cl=[Ql,-Jl,Jl,Ql];Yl._matMult(cl),rc._matMult(cl),ph._matMult(cl),Xl._matMult(cl)}const Dc=new R(0,0),Al=new R(0,0);Ar.push({tl:Yl,tr:rc,bl:ph,br:Xl,tex:lr,writingMode:$t.writingMode,glyphOffset:Tl,sectionIndex:kr.sectionIndex,isSDF:_i,pixelOffsetTL:Dc,pixelOffsetBR:Al,minFontScaleX:0,minFontScaleY:0})}return Ar}(0,d,j,P,D,O,v,h.allowVerticalPlacement),xt=h.textSizeData;let It=null;xt.kind==="source"?(It=[Ed*P.layout.get("text-size").evaluate(O,{})],It[0]>bf&&De(`${h.layerIds[0]}: Value for "text-size" is >= ${Vm}. Reduce your "text-size".`)):xt.kind==="composite"&&(It=[Ed*Ue.compositeTextSizes[0].evaluate(O,{},qe),Ed*Ue.compositeTextSizes[1].evaluate(O,{},qe)],(It[0]>bf||It[1]>bf)&&De(`${h.layerIds[0]}: Value for "text-size" is >= ${Vm}. Reduce your "text-size".`)),h.addSymbols(h.text,st,It,j,D,O,ee,u,K.lineStartIndex,K.lineLength,Re,qe);for(const fn of ce)ve[fn]=h.text.placedSymbolArray.length-1;return 4*st.length}function Xf(h){for(const u in h)return h[u];return null}function t5(h,u,d,v){const P=h.compareText;if(u in P){const D=P[u];for(let O=D.length-1;O>=0;O--)if(v.dist(D[O])<d)return!0}else P[u]=[];return P[u].push(v),!1}const J1=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Zy{static from(u){if(!(u instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[d,v]=new Uint8Array(u,0,2);if(d!==219)throw new Error("Data does not appear to be in a KDBush format.");const P=v>>4;if(P!==1)throw new Error(`Got v${P} data when expected v1.`);const D=J1[15&v];if(!D)throw new Error("Unrecognized array type.");const[O]=new Uint16Array(u,2,1),[j]=new Uint32Array(u,4,1);return new Zy(j,O,D,u)}constructor(u,d=64,v=Float64Array,P){if(isNaN(u)||u<0)throw new Error(`Unpexpected numItems value: ${u}.`);this.numItems=+u,this.nodeSize=Math.min(Math.max(+d,2),65535),this.ArrayType=v,this.IndexArrayType=u<65536?Uint16Array:Uint32Array;const D=J1.indexOf(this.ArrayType),O=2*u*this.ArrayType.BYTES_PER_ELEMENT,j=u*this.IndexArrayType.BYTES_PER_ELEMENT,K=(8-j%8)%8;if(D<0)throw new Error(`Unexpected typed array class: ${v}.`);P&&P instanceof ArrayBuffer?(this.data=P,this.ids=new this.IndexArrayType(this.data,8,u),this.coords=new this.ArrayType(this.data,8+j+K,2*u),this._pos=2*u,this._finished=!0):(this.data=new ArrayBuffer(8+O+j+K),this.ids=new this.IndexArrayType(this.data,8,u),this.coords=new this.ArrayType(this.data,8+j+K,2*u),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+D]),new Uint16Array(this.data,2,1)[0]=d,new Uint32Array(this.data,4,1)[0]=u)}add(u,d){const v=this._pos>>1;return this.ids[v]=v,this.coords[this._pos++]=u,this.coords[this._pos++]=d,v}finish(){const u=this._pos>>1;if(u!==this.numItems)throw new Error(`Added ${u} items when expected ${this.numItems}.`);return Ky(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(u,d,v,P){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:D,coords:O,nodeSize:j}=this,K=[0,D.length-1,0],ee=[];for(;K.length;){const ce=K.pop()||0,ve=K.pop()||0,Re=K.pop()||0;if(ve-Re<=j){for(let xt=Re;xt<=ve;xt++){const It=O[2*xt],fn=O[2*xt+1];It>=u&&It<=v&&fn>=d&&fn<=P&&ee.push(D[xt])}continue}const Ue=Re+ve>>1,qe=O[2*Ue],st=O[2*Ue+1];qe>=u&&qe<=v&&st>=d&&st<=P&&ee.push(D[Ue]),(ce===0?u<=qe:d<=st)&&(K.push(Re),K.push(Ue-1),K.push(1-ce)),(ce===0?v>=qe:P>=st)&&(K.push(Ue+1),K.push(ve),K.push(1-ce))}return ee}within(u,d,v){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:P,coords:D,nodeSize:O}=this,j=[0,P.length-1,0],K=[],ee=v*v;for(;j.length;){const ce=j.pop()||0,ve=j.pop()||0,Re=j.pop()||0;if(ve-Re<=O){for(let xt=Re;xt<=ve;xt++)ps(D[2*xt],D[2*xt+1],u,d)<=ee&&K.push(P[xt]);continue}const Ue=Re+ve>>1,qe=D[2*Ue],st=D[2*Ue+1];ps(qe,st,u,d)<=ee&&K.push(P[Ue]),(ce===0?u-v<=qe:d-v<=st)&&(j.push(Re),j.push(Ue-1),j.push(1-ce)),(ce===0?u+v>=qe:d+v>=st)&&(j.push(Ue+1),j.push(ve),j.push(1-ce))}return K}}function Ky(h,u,d,v,P,D){if(P-v<=d)return;const O=v+P>>1;Q1(h,u,O,v,P,D),Ky(h,u,d,v,O-1,1-D),Ky(h,u,d,O+1,P,1-D)}function Q1(h,u,d,v,P,D){for(;P>v;){if(P-v>600){const ee=P-v+1,ce=d-v+1,ve=Math.log(ee),Re=.5*Math.exp(2*ve/3),Ue=.5*Math.sqrt(ve*Re*(ee-Re)/ee)*(ce-ee/2<0?-1:1);Q1(h,u,d,Math.max(v,Math.floor(d-ce*Re/ee+Ue)),Math.min(P,Math.floor(d+(ee-ce)*Re/ee+Ue)),D)}const O=u[2*d+D];let j=v,K=P;for(Rp(h,u,v,d),u[2*P+D]>O&&Rp(h,u,v,P);j<K;){for(Rp(h,u,j,K),j++,K--;u[2*j+D]<O;)j++;for(;u[2*K+D]>O;)K--}u[2*v+D]===O?Rp(h,u,v,K):(K++,Rp(h,u,K,P)),K<=d&&(v=K+1),d<=K&&(P=K-1)}}function Rp(h,u,d,v){id(h,d,v),id(u,2*d,2*v),id(u,2*d+1,2*v+1)}function id(h,u,d){const v=h[u];h[u]=h[d],h[d]=v}function ps(h,u,d,v){const P=h-d,D=u-v;return P*P+D*D}var r0;a.cm=void 0,(r0=a.cm||(a.cm={})).create="create",r0.load="load",r0.fullLoad="fullLoad";let kc=null,Bp=[];const Yy=1e3/60,oo="loadTime",Xy="fullLoadTime",eb={mark(h){performance.mark(h)},frame(h){const u=h;kc!=null&&Bp.push(u-kc),kc=u},clearMetrics(){kc=null,Bp=[],performance.clearMeasures(oo),performance.clearMeasures(Xy);for(const h in a.cm)performance.clearMarks(a.cm[h])},getPerformanceMetrics(){performance.measure(oo,a.cm.create,a.cm.load),performance.measure(Xy,a.cm.create,a.cm.fullLoad);const h=performance.getEntriesByName(oo)[0].duration,u=performance.getEntriesByName(Xy)[0].duration,d=Bp.length,v=1/(Bp.reduce((D,O)=>D+O,0)/d/1e3),P=Bp.filter(D=>D>Yy).reduce((D,O)=>D+(O-Yy)/Yy,0);return{loadTime:h,fullLoadTime:u,fps:v,percentDroppedFrames:P/(d+P)*100,totalFrames:d}}};a.$=qm,a.A=me,a.B=vs,a.C=Qt,a.D=S,a.E=ct,a.F=Ah,a.G=function(h){if(Ce==null){const u=h.navigator?h.navigator.userAgent:null;Ce=!!h.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return Ce},a.H=class{constructor(h,u){this.target=h,this.mapId=u,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Kw(()=>this.process()),this.subscription=vn(this.target,"message",d=>this.receive(d),!1),this.globalScope=Be(self)?h:window}registerMessageHandler(h,u){this.messageHandlers[h]=u}sendAsync(h,u){return new Promise((d,v)=>{const P=Math.round(1e18*Math.random()).toString(36).substring(0,10),D=u?vn(u.signal,"abort",()=>{D==null||D.unsubscribe(),delete this.resolveRejects[P];const K={id:P,type:"<cancel>",origin:location.origin,targetMapId:h.targetMapId,sourceMapId:this.mapId};this.target.postMessage(K)},Yw):null;this.resolveRejects[P]={resolve:K=>{D==null||D.unsubscribe(),d(K)},reject:K=>{D==null||D.unsubscribe(),v(K)}};const O=[],j=Object.assign(Object.assign({},h),{id:P,sourceMapId:this.mapId,origin:location.origin,data:Ih(h.data,O)});this.target.postMessage(j,{transfer:O})})}receive(h){const u=h.data,d=u.id;if(!(u.origin!=="file://"&&location.origin!=="file://"&&u.origin!=="resource://android"&&location.origin!=="resource://android"&&u.origin!==location.origin||u.targetMapId&&this.mapId!==u.targetMapId)){if(u.type==="<cancel>"){delete this.tasks[d];const v=this.abortControllers[d];return delete this.abortControllers[d],void(v&&v.abort())}if(Be(self)||u.mustQueue)return this.tasks[d]=u,this.taskQueue.push(d),void this.invoker.trigger();this.processTask(d,u)}}process(){if(this.taskQueue.length===0)return;const h=this.taskQueue.shift(),u=this.tasks[h];delete this.tasks[h],this.taskQueue.length>0&&this.invoker.trigger(),u&&this.processTask(h,u)}processTask(h,u){return o(this,void 0,void 0,function*(){if(u.type==="<response>"){const P=this.resolveRejects[h];return delete this.resolveRejects[h],P?void(u.error?P.reject(B(u.error)):P.resolve(B(u.data))):void 0}if(!this.messageHandlers[u.type])return void this.completeTask(h,new Error(`Could not find a registered handler for ${u.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const d=B(u.data),v=new AbortController;this.abortControllers[h]=v;try{const P=yield this.messageHandlers[u.type](u.sourceMapId,d,v);this.completeTask(h,null,P)}catch(P){this.completeTask(h,P)}})}completeTask(h,u,d){const v=[];delete this.abortControllers[h];const P={id:h,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:u?Ih(u):null,data:Ih(d,v)};this.target.postMessage(P,{transfer:v})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},a.I=qg,a.J=tn,a.K=function(){var h=new me(16);return me!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=0,h[12]=0,h[13]=0,h[14]=0),h[0]=1,h[5]=1,h[10]=1,h[15]=1,h},a.L=function(h,u,d){var v,P,D,O,j,K,ee,ce,ve,Re,Ue,qe,st=d[0],xt=d[1],It=d[2];return u===h?(h[12]=u[0]*st+u[4]*xt+u[8]*It+u[12],h[13]=u[1]*st+u[5]*xt+u[9]*It+u[13],h[14]=u[2]*st+u[6]*xt+u[10]*It+u[14],h[15]=u[3]*st+u[7]*xt+u[11]*It+u[15]):(P=u[1],D=u[2],O=u[3],j=u[4],K=u[5],ee=u[6],ce=u[7],ve=u[8],Re=u[9],Ue=u[10],qe=u[11],h[0]=v=u[0],h[1]=P,h[2]=D,h[3]=O,h[4]=j,h[5]=K,h[6]=ee,h[7]=ce,h[8]=ve,h[9]=Re,h[10]=Ue,h[11]=qe,h[12]=v*st+j*xt+ve*It+u[12],h[13]=P*st+K*xt+Re*It+u[13],h[14]=D*st+ee*xt+Ue*It+u[14],h[15]=O*st+ce*xt+qe*It+u[15]),h},a.M=function(h,u,d){var v=d[0],P=d[1],D=d[2];return h[0]=u[0]*v,h[1]=u[1]*v,h[2]=u[2]*v,h[3]=u[3]*v,h[4]=u[4]*P,h[5]=u[5]*P,h[6]=u[6]*P,h[7]=u[7]*P,h[8]=u[8]*D,h[9]=u[9]*D,h[10]=u[10]*D,h[11]=u[11]*D,h[12]=u[12],h[13]=u[13],h[14]=u[14],h[15]=u[15],h},a.N=function(h,u,d){var v=u[0],P=u[1],D=u[2],O=u[3],j=u[4],K=u[5],ee=u[6],ce=u[7],ve=u[8],Re=u[9],Ue=u[10],qe=u[11],st=u[12],xt=u[13],It=u[14],fn=u[15],$t=d[0],Oe=d[1],ft=d[2],Wt=d[3];return h[0]=$t*v+Oe*j+ft*ve+Wt*st,h[1]=$t*P+Oe*K+ft*Re+Wt*xt,h[2]=$t*D+Oe*ee+ft*Ue+Wt*It,h[3]=$t*O+Oe*ce+ft*qe+Wt*fn,h[4]=($t=d[4])*v+(Oe=d[5])*j+(ft=d[6])*ve+(Wt=d[7])*st,h[5]=$t*P+Oe*K+ft*Re+Wt*xt,h[6]=$t*D+Oe*ee+ft*Ue+Wt*It,h[7]=$t*O+Oe*ce+ft*qe+Wt*fn,h[8]=($t=d[8])*v+(Oe=d[9])*j+(ft=d[10])*ve+(Wt=d[11])*st,h[9]=$t*P+Oe*K+ft*Re+Wt*xt,h[10]=$t*D+Oe*ee+ft*Ue+Wt*It,h[11]=$t*O+Oe*ce+ft*qe+Wt*fn,h[12]=($t=d[12])*v+(Oe=d[13])*j+(ft=d[14])*ve+(Wt=d[15])*st,h[13]=$t*P+Oe*K+ft*Re+Wt*xt,h[14]=$t*D+Oe*ee+ft*Ue+Wt*It,h[15]=$t*O+Oe*ce+ft*qe+Wt*fn,h},a.O=function(h,u){const d={};for(let v=0;v<u.length;v++){const P=u[v];P in h&&(d[P]=h[P])}return d},a.P=R,a.Q=Gd,a.R=Pl,a.S=N1,a.T=Cr,a.U=B1,a.V=Q,a.W=oe,a.X=Zt,a.Y=dh,a.Z=Le,a._=o,a.a=zr,a.a$=function(h,u,d){var v=Math.sin(d),P=Math.cos(d),D=u[4],O=u[5],j=u[6],K=u[7],ee=u[8],ce=u[9],ve=u[10],Re=u[11];return u!==h&&(h[0]=u[0],h[1]=u[1],h[2]=u[2],h[3]=u[3],h[12]=u[12],h[13]=u[13],h[14]=u[14],h[15]=u[15]),h[4]=D*P+ee*v,h[5]=O*P+ce*v,h[6]=j*P+ve*v,h[7]=K*P+Re*v,h[8]=ee*P-D*v,h[9]=ce*P-O*v,h[10]=ve*P-j*v,h[11]=Re*P-K*v,h},a.a0=25,a.a1=Hy,a.a2=h=>{const u=window.document.createElement("video");return u.muted=!0,new Promise(d=>{u.onloadstart=()=>{d(u)};for(const v of h){const P=window.document.createElement("source");Fr(v)||(u.crossOrigin="Anonymous"),P.src=v,u.appendChild(P)}})},a.a3=bn,a.a4=function(){return Mt++},a.a5=$,a.a6=Dp,a.a7=Ao,a.a8=hh,a.a9=xf,a.aA=function(h,u,d,v,P=!1){if(!d[0]&&!d[1])return[0,0];const D=P?v==="map"?-h.bearingInRadians:0:v==="viewport"?h.bearingInRadians:0;if(D){const O=Math.sin(D),j=Math.cos(D);d=[d[0]*j-d[1]*O,d[0]*O+d[1]*j]}return[P?d[0]:ze(u,d[0],h.zoom),P?d[1]:ze(u,d[1],h.zoom)]},a.aC=Ny,a.aD=t0,a.aE=By,a.aF=Zy,a.aG=dn,a.aH=Bm,a.aI=Rt,a.aJ=Ei,a.aK=Sr,a.aL=it,a.aM=qn,a.aN=z1,a.aO=function(h,u,d){return h[0]=u[0]*d,h[1]=u[1]*d,h[2]=u[2]*d,h},a.aP=function(h,u,d){return h[0]=u[0]+d[0],h[1]=u[1]+d[1],h[2]=u[2]+d[2],h},a.aQ=function(h){var u=new me(3);return u[0]=h[0],u[1]=h[1],u[2]=h[2],u},a.aR=function(h,u,d){return h[0]=u[0]*d[0],h[1]=u[1]*d[1],h[2]=u[2]*d[2],h[3]=u[3]*d[3],h},a.aS=function(h,u,d){return h[0]=u[0]-d[0],h[1]=u[1]-d[1],h[2]=u[2]-d[2],h},a.aT=function(h,u){var d=u[0],v=u[1],P=u[2],D=d*d+v*v+P*P;return D>0&&(D=1/Math.sqrt(D)),h[0]=u[0]*D,h[1]=u[1]*D,h[2]=u[2]*D,h},a.aU=function(h,u,d){var v=u[0],P=u[1],D=u[2],O=d[0],j=d[1],K=d[2];return h[0]=P*K-D*j,h[1]=D*O-v*K,h[2]=v*j-P*O,h},a.aV=function(h,u){return h[0]*u[0]+h[1]*u[1]+h[2]*u[2]},a.aW=U1,a.aX=gc,a.aY=function(h,u,d,v,P){var D,O=1/Math.tan(u/2);return h[0]=O/d,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=O,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=-1,h[12]=0,h[13]=0,h[15]=0,P!=null&&P!==1/0?(h[10]=(P+v)*(D=1/(v-P)),h[14]=2*P*v*D):(h[10]=-1,h[14]=-2*v),h},a.aZ=function(h){var u=new me(16);return u[0]=h[0],u[1]=h[1],u[2]=h[2],u[3]=h[3],u[4]=h[4],u[5]=h[5],u[6]=h[6],u[7]=h[7],u[8]=h[8],u[9]=h[9],u[10]=h[10],u[11]=h[11],u[12]=h[12],u[13]=h[13],u[14]=h[14],u[15]=h[15],u},a.a_=function(h,u,d){var v=Math.sin(d),P=Math.cos(d),D=u[0],O=u[1],j=u[2],K=u[3],ee=u[4],ce=u[5],ve=u[6],Re=u[7];return u!==h&&(h[8]=u[8],h[9]=u[9],h[10]=u[10],h[11]=u[11],h[12]=u[12],h[13]=u[13],h[14]=u[14],h[15]=u[15]),h[0]=D*P+ee*v,h[1]=O*P+ce*v,h[2]=j*P+ve*v,h[3]=K*P+Re*v,h[4]=ee*P-D*v,h[5]=ce*P-O*v,h[6]=ve*P-j*v,h[7]=Re*P-K*v,h},a.aa=function(h){const u={};if(h.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(d,v,P,D)=>{const O=P||D;return u[v]=!O||O.toLowerCase(),""}),u["max-age"]){const d=parseInt(u["max-age"],10);isNaN(d)?delete u["max-age"]:u["max-age"]=d}return u},a.ab=function(h){return h*Math.PI/180},a.ac=function(h){return Math.pow(2,h)},a.ad=ue,a.ae=Ve,a.af=85.051129,a.ag=F1,a.ah=function(h){return Math.log(h)/Math.LN2},a.ai=function(h){var u=h[0],d=h[1];return u*u+d*d},a.aj=function(h,u){const d=[];for(const v in h)v in u||d.push(v);return d},a.ak=function(h,u){let d=0,v=0;if(h.kind==="constant")v=h.layoutSize;else if(h.kind!=="source"){const{interpolationType:P,minZoom:D,maxZoom:O}=h,j=P?Ve(Fo.interpolationFactor(P,u,D,O),0,1):0;h.kind==="camera"?v=vs.number(h.minSize,h.maxSize,j):d=j}return{uSizeT:d,uSize:v}},a.am=function(h,{uSize:u,uSizeT:d},{lowerSize:v,upperSize:P}){return h.kind==="source"?v/Ed:h.kind==="composite"?vs.number(v/Ed,P/Ed,d):u},a.an=function(h,u){var d=u[0],v=u[1],P=u[2],D=u[3],O=u[4],j=u[5],K=u[6],ee=u[7],ce=u[8],ve=u[9],Re=u[10],Ue=u[11],qe=u[12],st=u[13],xt=u[14],It=u[15],fn=d*j-v*O,$t=d*K-P*O,Oe=d*ee-D*O,ft=v*K-P*j,Wt=v*ee-D*j,$n=P*ee-D*K,_r=ce*st-ve*qe,Wn=ce*xt-Re*qe,rr=ce*It-Ue*qe,Ar=ve*xt-Re*st,xr=ve*It-Ue*st,kr=Re*It-Ue*xt,lr=fn*kr-$t*xr+Oe*Ar+ft*rr-Wt*Wn+$n*_r;return lr?(h[0]=(j*kr-K*xr+ee*Ar)*(lr=1/lr),h[1]=(P*xr-v*kr-D*Ar)*lr,h[2]=(st*$n-xt*Wt+It*ft)*lr,h[3]=(Re*Wt-ve*$n-Ue*ft)*lr,h[4]=(K*rr-O*kr-ee*Wn)*lr,h[5]=(d*kr-P*rr+D*Wn)*lr,h[6]=(xt*Oe-qe*$n-It*$t)*lr,h[7]=(ce*$n-Re*Oe+Ue*$t)*lr,h[8]=(O*xr-j*rr+ee*_r)*lr,h[9]=(v*rr-d*xr-D*_r)*lr,h[10]=(qe*Wt-st*Oe+It*fn)*lr,h[11]=(ve*Oe-ce*Wt-Ue*fn)*lr,h[12]=(j*Wn-O*Ar-K*_r)*lr,h[13]=(d*Ar-v*Wn+P*_r)*lr,h[14]=(st*$t-qe*ft-xt*fn)*lr,h[15]=(ce*ft-ve*$t+Re*fn)*lr,h):null},a.ao=ne,a.ap=function(h){return Math.hypot(h[0],h[1])},a.aq=function(h){return h[0]=0,h[1]=0,h},a.ar=function(h,u,d){return h[0]=u[0]*d,h[1]=u[1]*d,h},a.as=Fy,a.at=be,a.au=function(h,u,d,v){const P=u.y-h.y,D=u.x-h.x,O=v.y-d.y,j=v.x-d.x,K=O*D-j*P;if(K===0)return null;const ee=(j*(h.y-d.y)-O*(h.x-d.x))/K;return new R(h.x+ee*D,h.y+ee*P)},a.av=H1,a.aw=Pm,a.ax=function(h){let u=1/0,d=1/0,v=-1/0,P=-1/0;for(const D of h)u=Math.min(u,D.x),d=Math.min(d,D.y),v=Math.max(v,D.x),P=Math.max(P,D.y);return[u,d,v,P]},a.ay=El,a.az=ze,a.b=ot,a.b$=function(h,u){var d=h[0],v=h[1],P=h[2],D=h[3],O=h[4],j=h[5],K=h[6],ee=h[7],ce=h[8],ve=h[9],Re=h[10],Ue=h[11],qe=h[12],st=h[13],xt=h[14],It=h[15],fn=u[0],$t=u[1],Oe=u[2],ft=u[3],Wt=u[4],$n=u[5],_r=u[6],Wn=u[7],rr=u[8],Ar=u[9],xr=u[10],kr=u[11],lr=u[12],Qr=u[13],_i=u[14],hi=u[15];return Math.abs(d-fn)<=le*Math.max(1,Math.abs(d),Math.abs(fn))&&Math.abs(v-$t)<=le*Math.max(1,Math.abs(v),Math.abs($t))&&Math.abs(P-Oe)<=le*Math.max(1,Math.abs(P),Math.abs(Oe))&&Math.abs(D-ft)<=le*Math.max(1,Math.abs(D),Math.abs(ft))&&Math.abs(O-Wt)<=le*Math.max(1,Math.abs(O),Math.abs(Wt))&&Math.abs(j-$n)<=le*Math.max(1,Math.abs(j),Math.abs($n))&&Math.abs(K-_r)<=le*Math.max(1,Math.abs(K),Math.abs(_r))&&Math.abs(ee-Wn)<=le*Math.max(1,Math.abs(ee),Math.abs(Wn))&&Math.abs(ce-rr)<=le*Math.max(1,Math.abs(ce),Math.abs(rr))&&Math.abs(ve-Ar)<=le*Math.max(1,Math.abs(ve),Math.abs(Ar))&&Math.abs(Re-xr)<=le*Math.max(1,Math.abs(Re),Math.abs(xr))&&Math.abs(Ue-kr)<=le*Math.max(1,Math.abs(Ue),Math.abs(kr))&&Math.abs(qe-lr)<=le*Math.max(1,Math.abs(qe),Math.abs(lr))&&Math.abs(st-Qr)<=le*Math.max(1,Math.abs(st),Math.abs(Qr))&&Math.abs(xt-_i)<=le*Math.max(1,Math.abs(xt),Math.abs(_i))&&Math.abs(It-hi)<=le*Math.max(1,Math.abs(It),Math.abs(hi))},a.b0=function(){const h=new Float32Array(16);return ue(h),h},a.b1=function(){const h=new Float64Array(16);return ue(h),h},a.b2=function(){return new Float64Array(16)},a.b3=function(h,u,d){const v=new Float64Array(4);return function(P,D,O,j){var K=.5*Math.PI/180;D*=K,O*=K,j*=K;var ee=Math.sin(D),ce=Math.cos(D),ve=Math.sin(O),Re=Math.cos(O),Ue=Math.sin(j),qe=Math.cos(j);P[0]=ee*Re*qe-ce*ve*Ue,P[1]=ce*ve*qe+ee*Re*Ue,P[2]=ce*Re*Ue-ee*ve*qe,P[3]=ce*Re*qe+ee*ve*Ue}(v,h,u-90,d),v},a.b4=function(h,u,d,v){var P,D,O,j,K,ee=u[0],ce=u[1],ve=u[2],Re=u[3],Ue=d[0],qe=d[1],st=d[2],xt=d[3];return(D=ee*Ue+ce*qe+ve*st+Re*xt)<0&&(D=-D,Ue=-Ue,qe=-qe,st=-st,xt=-xt),1-D>le?(P=Math.acos(D),O=Math.sin(P),j=Math.sin((1-v)*P)/O,K=Math.sin(v*P)/O):(j=1-v,K=v),h[0]=j*ee+K*Ue,h[1]=j*ce+K*qe,h[2]=j*ve+K*st,h[3]=j*Re+K*xt,h},a.b5=function(h){const u=new Float64Array(9);var d,v,P,D,O,j,K,ee,ce,ve,Re,Ue,qe,st,xt,It,fn,$t;ve=(P=(v=h)[0])*(K=P+P),Re=(D=v[1])*K,qe=(O=v[2])*K,st=O*(ee=D+D),It=(j=v[3])*K,fn=j*ee,$t=j*(ce=O+O),(d=u)[0]=1-(Ue=D*ee)-(xt=O*ce),d[3]=Re-$t,d[6]=qe+fn,d[1]=Re+$t,d[4]=1-ve-xt,d[7]=st-It,d[2]=qe-fn,d[5]=st+It,d[8]=1-ve-Ue;const Oe=qn(-Math.asin(Ve(u[2],-1,1)));let ft,Wt;return Math.hypot(u[5],u[8])<.001?(ft=0,Wt=-qn(Math.atan2(u[3],u[4]))):(ft=qn(u[5]===0&&u[8]===0?0:Math.atan2(u[5],u[8])),Wt=qn(u[1]===0&&u[0]===0?0:Math.atan2(u[1],u[0]))),{roll:ft,pitch:Oe+90,bearing:Wt}},a.b6=function(h,u){return h.roll==u.roll&&h.pitch==u.pitch&&h.bearing==u.bearing},a.b7=ui,a.b8=Qh,a.b9=Mp,a.bA=function(h){if(h.type==="custom")return new Jg(h);switch(h.type){case"background":return new Ww(h);case"circle":return new ow(h);case"fill":return new s1(h);case"fill-extrusion":return new Dh(h);case"heatmap":return new py(h);case"hillshade":return new zi(h);case"line":return new Ew(h);case"raster":return new Xg(h);case"symbol":return new Gm(h)}},a.bB=yn,a.bC=function(h,u){if(!h)return[{command:"setStyle",args:[u]}];let d=[];try{if(!Ot(h.version,u.version))return[{command:"setStyle",args:[u]}];Ot(h.center,u.center)||d.push({command:"setCenter",args:[u.center]}),Ot(h.centerAltitude,u.centerAltitude)||d.push({command:"setCenterAltitude",args:[u.centerAltitude]}),Ot(h.zoom,u.zoom)||d.push({command:"setZoom",args:[u.zoom]}),Ot(h.bearing,u.bearing)||d.push({command:"setBearing",args:[u.bearing]}),Ot(h.pitch,u.pitch)||d.push({command:"setPitch",args:[u.pitch]}),Ot(h.roll,u.roll)||d.push({command:"setRoll",args:[u.roll]}),Ot(h.sprite,u.sprite)||d.push({command:"setSprite",args:[u.sprite]}),Ot(h.glyphs,u.glyphs)||d.push({command:"setGlyphs",args:[u.glyphs]}),Ot(h.transition,u.transition)||d.push({command:"setTransition",args:[u.transition]}),Ot(h.light,u.light)||d.push({command:"setLight",args:[u.light]}),Ot(h.terrain,u.terrain)||d.push({command:"setTerrain",args:[u.terrain]}),Ot(h.sky,u.sky)||d.push({command:"setSky",args:[u.sky]}),Ot(h.projection,u.projection)||d.push({command:"setProjection",args:[u.projection]});const v={},P=[];(function(O,j,K,ee){let ce;for(ce in j=j||{},O=O||{})Object.prototype.hasOwnProperty.call(O,ce)&&(Object.prototype.hasOwnProperty.call(j,ce)||wn(ce,K,ee));for(ce in j)Object.prototype.hasOwnProperty.call(j,ce)&&(Object.prototype.hasOwnProperty.call(O,ce)?Ot(O[ce],j[ce])||(O[ce].type==="geojson"&&j[ce].type==="geojson"&&Lr(O,j,ce)?cn(K,{command:"setGeoJSONSourceData",args:[ce,j[ce].data]}):Qn(ce,j,K,ee)):En(ce,j,K))})(h.sources,u.sources,P,v);const D=[];h.layers&&h.layers.forEach(O=>{"source"in O&&v[O.source]?d.push({command:"removeLayer",args:[O.id]}):D.push(O)}),d=d.concat(P),function(O,j,K){j=j||[];const ee=(O=O||[]).map(vt),ce=j.map(vt),ve=O.reduce(Tn,{}),Re=j.reduce(Tn,{}),Ue=ee.slice(),qe=Object.create(null);let st,xt,It,fn,$t;for(let Oe=0,ft=0;Oe<ee.length;Oe++)st=ee[Oe],Object.prototype.hasOwnProperty.call(Re,st)?ft++:(cn(K,{command:"removeLayer",args:[st]}),Ue.splice(Ue.indexOf(st,ft),1));for(let Oe=0,ft=0;Oe<ce.length;Oe++)st=ce[ce.length-1-Oe],Ue[Ue.length-1-Oe]!==st&&(Object.prototype.hasOwnProperty.call(ve,st)?(cn(K,{command:"removeLayer",args:[st]}),Ue.splice(Ue.lastIndexOf(st,Ue.length-ft),1)):ft++,fn=Ue[Ue.length-Oe],cn(K,{command:"addLayer",args:[Re[st],fn]}),Ue.splice(Ue.length-Oe,0,st),qe[st]=!0);for(let Oe=0;Oe<ce.length;Oe++)if(st=ce[Oe],xt=ve[st],It=Re[st],!qe[st]&&!Ot(xt,It))if(Ot(xt.source,It.source)&&Ot(xt["source-layer"],It["source-layer"])&&Ot(xt.type,It.type)){for($t in Yt(xt.layout,It.layout,K,st,null,"setLayoutProperty"),Yt(xt.paint,It.paint,K,st,null,"setPaintProperty"),Ot(xt.filter,It.filter)||cn(K,{command:"setFilter",args:[st,It.filter]}),Ot(xt.minzoom,It.minzoom)&&Ot(xt.maxzoom,It.maxzoom)||cn(K,{command:"setLayerZoomRange",args:[st,It.minzoom,It.maxzoom]}),xt)Object.prototype.hasOwnProperty.call(xt,$t)&&$t!=="layout"&&$t!=="paint"&&$t!=="filter"&&$t!=="metadata"&&$t!=="minzoom"&&$t!=="maxzoom"&&($t.indexOf("paint.")===0?Yt(xt[$t],It[$t],K,st,$t.slice(6),"setPaintProperty"):Ot(xt[$t],It[$t])||cn(K,{command:"setLayerProperty",args:[st,$t,It[$t]]}));for($t in It)Object.prototype.hasOwnProperty.call(It,$t)&&!Object.prototype.hasOwnProperty.call(xt,$t)&&$t!=="layout"&&$t!=="paint"&&$t!=="filter"&&$t!=="metadata"&&$t!=="minzoom"&&$t!=="maxzoom"&&($t.indexOf("paint.")===0?Yt(xt[$t],It[$t],K,st,$t.slice(6),"setPaintProperty"):Ot(xt[$t],It[$t])||cn(K,{command:"setLayerProperty",args:[st,$t,It[$t]]}))}else cn(K,{command:"removeLayer",args:[st]}),fn=Ue[Ue.lastIndexOf(st)+1],cn(K,{command:"addLayer",args:[It,fn]})}(D,u.layers,d)}catch(v){console.warn("Unable to compute style diff:",v),d=[{command:"setStyle",args:[u]}]}return d},a.bD=function(h){const u=[],d=h.id;return d===void 0&&u.push({message:`layers.${d}: missing required property "id"`}),h.render===void 0&&u.push({message:`layers.${d}: missing required method "render"`}),h.renderingMode&&h.renderingMode!=="2d"&&h.renderingMode!=="3d"&&u.push({message:`layers.${d}: property "renderingMode" must be either "2d" or "3d"`}),u},a.bE=function h(u,d){if(Array.isArray(u)){if(!Array.isArray(d)||u.length!==d.length)return!1;for(let v=0;v<u.length;v++)if(!h(u[v],d[v]))return!1;return!0}if(typeof u=="object"&&u!==null&&d!==null){if(typeof d!="object"||Object.keys(u).length!==Object.keys(d).length)return!1;for(const v in u)if(!h(u[v],d[v]))return!1;return!0}return u===d},a.bF=wt,a.bG=rn,a.bH=class extends ul{constructor(h,u){super(h,u),this.current=0}set(h){this.current!==h&&(this.current=h,this.gl.uniform1i(this.location,h))}},a.bI=Wl,a.bJ=class extends ul{constructor(h,u){super(h,u),this.current=ed}set(h){if(h[12]!==this.current[12]||h[0]!==this.current[0])return this.current=h,void this.gl.uniformMatrix4fv(this.location,!1,h);for(let u=1;u<16;u++)if(h[u]!==this.current[u]){this.current=h,this.gl.uniformMatrix4fv(this.location,!1,h);break}}},a.bK=ql,a.bL=class extends ul{constructor(h,u){super(h,u),this.current=[0,0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]||(this.current=h,this.gl.uniform3f(this.location,h[0],h[1],h[2]))}},a.bM=class extends ul{constructor(h,u){super(h,u),this.current=[0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]||(this.current=h,this.gl.uniform2f(this.location,h[0],h[1]))}},a.bN=we,a.bO=function(h,u){var d=Math.sin(u),v=Math.cos(u);return h[0]=v,h[1]=d,h[2]=0,h[3]=-d,h[4]=v,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},a.bP=function(h,u,d){var v=u[0],P=u[1],D=u[2];return h[0]=v*d[0]+P*d[3]+D*d[6],h[1]=v*d[1]+P*d[4]+D*d[7],h[2]=v*d[2]+P*d[5]+D*d[8],h},a.bQ=function(h,u,d,v,P,D,O){var j=1/(u-d),K=1/(v-P),ee=1/(D-O);return h[0]=-2*j,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=-2*K,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=2*ee,h[11]=0,h[12]=(u+d)*j,h[13]=(P+v)*K,h[14]=(O+D)*ee,h[15]=1,h},a.bR=class extends mt{},a.bS=kw,a.bT=class extends St{},a.bU=Im,a.bV=function(h){return h<=1?1:Math.pow(2,Math.ceil(Math.log(h)/Math.LN2))},a.bW=zg,a.bX=function(h,u,d){var v=u[0],P=u[1],D=u[2],O=d[3]*v+d[7]*P+d[11]*D+d[15];return h[0]=(d[0]*v+d[4]*P+d[8]*D+d[12])/(O=O||1),h[1]=(d[1]*v+d[5]*P+d[9]*D+d[13])/O,h[2]=(d[2]*v+d[6]*P+d[10]*D+d[14])/O,h},a.bY=class extends Br{},a.bZ=class extends x{},a.b_=function(h,u){return h[0]===u[0]&&h[1]===u[1]&&h[2]===u[2]&&h[3]===u[3]&&h[4]===u[4]&&h[5]===u[5]&&h[6]===u[6]&&h[7]===u[7]&&h[8]===u[8]&&h[9]===u[9]&&h[10]===u[10]&&h[11]===u[11]&&h[12]===u[12]&&h[13]===u[13]&&h[14]===u[14]&&h[15]===u[15]},a.ba=Zf,a.bb=Wf,a.bc=pt,a.bd=ge,a.be=Lo,a.bf=function(h,u,d,v,P){return pt(v,P,Ve((h-u)/(d-u),0,1))},a.bg=He,a.bh=function(){return new Float64Array(3)},a.bi=function(h,u,d,v){return h[0]=u[0]+d[0]*v,h[1]=u[1]+d[1]*v,h[2]=u[2]+d[2]*v,h},a.bj=Te,a.bk=function(){return new Float64Array(4)},a.bl=function(h,u,d,v){var P=[],D=[];return P[0]=u[0]-d[0],P[1]=u[1]-d[1],P[2]=u[2]-d[2],D[0]=P[0]*Math.cos(v)-P[1]*Math.sin(v),D[1]=P[0]*Math.sin(v)+P[1]*Math.cos(v),D[2]=P[2],h[0]=D[0]+d[0],h[1]=D[1]+d[1],h[2]=D[2]+d[2],h},a.bm=function(h,u,d,v){var P=[],D=[];return P[0]=u[0]-d[0],P[1]=u[1]-d[1],P[2]=u[2]-d[2],D[0]=P[0],D[1]=P[1]*Math.cos(v)-P[2]*Math.sin(v),D[2]=P[1]*Math.sin(v)+P[2]*Math.cos(v),h[0]=D[0]+d[0],h[1]=D[1]+d[1],h[2]=D[2]+d[2],h},a.bn=function(h,u,d,v){var P=[],D=[];return P[0]=u[0]-d[0],P[1]=u[1]-d[1],P[2]=u[2]-d[2],D[0]=P[2]*Math.sin(v)+P[0]*Math.cos(v),D[1]=P[1],D[2]=P[2]*Math.cos(v)-P[0]*Math.sin(v),h[0]=D[0]+d[0],h[1]=D[1]+d[1],h[2]=D[2]+d[2],h},a.bo=We,a.bp=function(h,u,d){var v=Math.sin(d),P=Math.cos(d),D=u[0],O=u[1],j=u[2],K=u[3],ee=u[8],ce=u[9],ve=u[10],Re=u[11];return u!==h&&(h[4]=u[4],h[5]=u[5],h[6]=u[6],h[7]=u[7],h[12]=u[12],h[13]=u[13],h[14]=u[14],h[15]=u[15]),h[0]=D*P-ee*v,h[1]=O*P-ce*v,h[2]=j*P-ve*v,h[3]=K*P-Re*v,h[8]=D*v+ee*P,h[9]=O*v+ce*P,h[10]=j*v+ve*P,h[11]=K*v+Re*P,h},a.bq=function(h,u){const d=He(h,360),v=He(u,360),P=v-d,D=v>d?P-360:P+360;return Math.abs(P)<Math.abs(D)?P:D},a.br=function(h){return h[0]=0,h[1]=0,h[2]=0,h},a.bs=function(h,u,d,v){const P=Math.sqrt(h*h+u*u),D=Math.sqrt(d*d+v*v);h/=P,u/=P,d/=D,v/=D;const O=Math.acos(h*d+u*v);return-u*d+h*v>0?O:-O},a.bt=function(h,u){return h[0]*u[0]+h[1]*u[1]+h[2]*u[2]+h[3]},a.bu=Hm,a.bv=function(h,u){const d=He(h,2*Math.PI),v=He(u,2*Math.PI);return Math.min(Math.abs(d-v),Math.abs(d-v+2*Math.PI),Math.abs(d-v-2*Math.PI))},a.bw=function(){const h={},u=$e.$version;for(const d in $e.$root){const v=$e.$root[d];if(v.required){let P=null;P=d==="version"?u:v.type==="array"?[]:{},P!=null&&(h[d]=P)}}return h},a.bx=H,a.by=Yn,a.bz=function(h){h=h.slice();const u=Object.create(null);for(let d=0;d<h.length;d++)u[h[d].id]=h[d];for(let d=0;d<h.length;d++)"ref"in h[d]&&(h[d]=hn(h[d],u[h[d].ref]));return h},a.c=Dr,a.c0=function(h,u){return h[0]=u[0],h[1]=u[1],h[2]=u[2],h[3]=u[3],h[4]=u[4],h[5]=u[5],h[6]=u[6],h[7]=u[7],h[8]=u[8],h[9]=u[9],h[10]=u[10],h[11]=u[11],h[12]=u[12],h[13]=u[13],h[14]=u[14],h[15]=u[15],h},a.c1=h=>h.type==="symbol",a.c2=h=>h.type==="circle",a.c3=h=>h.type==="heatmap",a.c4=h=>h.type==="line",a.c5=h=>h.type==="fill",a.c6=h=>h.type==="fill-extrusion",a.c7=h=>h.type==="hillshade",a.c8=h=>h.type==="raster",a.c9=h=>h.type==="background",a.cA=Nm,a.cB=Dy,a.cC=class{constructor(h){this._marks={start:[h.url,"start"].join("#"),end:[h.url,"end"].join("#"),measure:h.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let h=performance.getEntriesByName(this._marks.measure);return h.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),h=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),h}},a.cD=function(h,u,d,v,P){return o(this,void 0,void 0,function*(){if(oe())try{return yield Zt(h,u,d,v,P)}catch{}return function(D,O,j,K,ee){const ce=D.width,ve=D.height;an&&ln||(an=new OffscreenCanvas(ce,ve),ln=an.getContext("2d",{willReadFrequently:!0})),an.width=ce,an.height=ve,ln.drawImage(D,0,0,ce,ve);const Re=ln.getImageData(O,j,K,ee);return ln.clearRect(0,0,ce,ve),Re.data}(h,u,d,v,P)})},a.cE=V1,a.cF=f,a.cG=w,a.cH=Ly,a.cI=Iy,a.cJ=$o,a.cK=Zn,a.ca=h=>h.type==="custom",a.cb=Ie,a.cc=function(h,u,d){const v=Se(u.x-d.x,u.y-d.y),P=Se(h.x-d.x,h.y-d.y);var D,O;return qn(Math.atan2(v[0]*P[1]-v[1]*P[0],(D=v)[0]*(O=P)[0]+D[1]*O[1]))},a.cd=Ne,a.ce=function(h,u){return cr[u]&&(h instanceof MouseEvent||h instanceof WheelEvent)},a.cf=function(h,u){return Kn[u]&&"touches"in h},a.cg=function(h){return Kn[h]||cr[h]},a.ch=function(h,u,d){var v=u[0],P=u[1];return h[0]=d[0]*v+d[4]*P+d[12],h[1]=d[1]*v+d[5]*P+d[13],h},a.ci=function(h,u){const{x:d,y:v}=qm.fromLngLat(u);return!(h<0||h>25||v<0||v>=1||d<0||d>=1)},a.cj=function(h,u){return h[0]=u[0],h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=u[1],h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=u[2],h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h},a.ck=class extends Ir{},a.cl=eb,a.cn=function(h){return h.message===pr},a.co=Kt,a.cp=function(h,u){zr.REGISTERED_PROTOCOLS[h]=u},a.cq=function(h){delete zr.REGISTERED_PROTOCOLS[h]},a.cr=function(h,u){const d={};for(let P=0;P<h.length;P++){const D=u&&u[h[P].id]||Dn(h[P]);u&&(u[h[P].id]=D);let O=d[D];O||(O=d[D]=[]),O.push(h[P])}const v=[];for(const P in d)v.push(d[P]);return v},a.cs=Gr,a.ct=$1,a.cu=ls,a.cv=w1,a.cw=function(h){h.bucket.createArrays(),h.bucket.tilePixelRatio=Le/(512*h.bucket.overscaling),h.bucket.compareText={},h.bucket.iconsNeedLinear=!1;const u=h.bucket.layers[0],d=u.layout,v=u._unevaluatedLayout._values,P={layoutIconSize:v["icon-size"].possiblyEvaluate(new Qt(h.bucket.zoom+1),h.canonical),layoutTextSize:v["text-size"].possiblyEvaluate(new Qt(h.bucket.zoom+1),h.canonical),textMaxSize:v["text-size"].possiblyEvaluate(new Qt(18))};if(h.bucket.textSizeData.kind==="composite"){const{minZoom:ee,maxZoom:ce}=h.bucket.textSizeData;P.compositeTextSizes=[v["text-size"].possiblyEvaluate(new Qt(ee),h.canonical),v["text-size"].possiblyEvaluate(new Qt(ce),h.canonical)]}if(h.bucket.iconSizeData.kind==="composite"){const{minZoom:ee,maxZoom:ce}=h.bucket.iconSizeData;P.compositeIconSizes=[v["icon-size"].possiblyEvaluate(new Qt(ee),h.canonical),v["icon-size"].possiblyEvaluate(new Qt(ce),h.canonical)]}const D=d.get("text-line-height")*El,O=d.get("text-rotation-alignment")!=="viewport"&&d.get("symbol-placement")!=="point",j=d.get("text-keep-upright"),K=d.get("text-size");for(const ee of h.bucket.features){const ce=d.get("text-font").evaluate(ee,{},h.canonical).join(","),ve=K.evaluate(ee,{},h.canonical),Re=P.layoutTextSize.evaluate(ee,{},h.canonical),Ue=P.layoutIconSize.evaluate(ee,{},h.canonical),qe={horizontal:{},vertical:void 0},st=ee.text;let xt,It=[0,0];if(st){const Oe=st.toString(),ft=d.get("text-letter-spacing").evaluate(ee,{},h.canonical)*El,Wt=Ye(Oe)?ft:0,$n=d.get("text-anchor").evaluate(ee,{},h.canonical),_r=X1(u,ee,h.canonical);if(!_r){const xr=d.get("text-radial-offset").evaluate(ee,{},h.canonical);It=xr?e0($n,[xr*El,Yf]):d.get("text-offset").evaluate(ee,{},h.canonical).map(kr=>kr*El)}let Wn=O?"center":d.get("text-justify").evaluate(ee,{},h.canonical);const rr=d.get("symbol-placement")==="point"?d.get("text-max-width").evaluate(ee,{},h.canonical)*El:1/0,Ar=()=>{h.bucket.allowVerticalPlacement&&Ee(Oe)&&(qe.vertical=Zg(st,h.glyphMap,h.glyphPositions,h.imagePositions,ce,rr,D,$n,"left",Wt,It,a.al.vertical,!0,Re,ve))};if(!O&&_r){const xr=new Set;if(Wn==="auto")for(let lr=0;lr<_r.values.length;lr+=2)xr.add(t0(_r.values[lr]));else xr.add(Wn);let kr=!1;for(const lr of xr)if(!qe.horizontal[lr])if(kr)qe.horizontal[lr]=qe.horizontal[0];else{const Qr=Zg(st,h.glyphMap,h.glyphPositions,h.imagePositions,ce,rr,D,"center",lr,Wt,It,a.al.horizontal,!1,Re,ve);Qr&&(qe.horizontal[lr]=Qr,kr=Qr.positionedLines.length===1)}Ar()}else{Wn==="auto"&&(Wn=t0($n));const xr=Zg(st,h.glyphMap,h.glyphPositions,h.imagePositions,ce,rr,D,$n,Wn,Wt,It,a.al.horizontal,!1,Re,ve);xr&&(qe.horizontal[Wn]=xr),Ar(),Ee(Oe)&&O&&j&&(qe.vertical=Zg(st,h.glyphMap,h.glyphPositions,h.imagePositions,ce,rr,D,$n,Wn,Wt,It,a.al.vertical,!1,Re,ve))}}let fn=!1;if(ee.icon&&ee.icon.name){const Oe=h.imageMap[ee.icon.name];Oe&&(xt=$w(h.imagePositions[ee.icon.name],d.get("icon-offset").evaluate(ee,{},h.canonical),d.get("icon-anchor").evaluate(ee,{},h.canonical)),fn=!!Oe.sdf,h.bucket.sdfIcons===void 0?h.bucket.sdfIcons=fn:h.bucket.sdfIcons!==fn&&De("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Oe.pixelRatio!==h.bucket.pixelRatio||d.get("icon-rotate").constantOr(1)!==0)&&(h.bucket.iconsNeedLinear=!0))}const $t=Xf(qe.horizontal)||qe.vertical;h.bucket.iconsInText=!!$t&&$t.iconsInText,($t||xt)&&n0(h.bucket,ee,qe,xt,h.imageMap,P,Re,Ue,It,fn,h.canonical,h.subdivisionGranularity)}h.showCollisionBoxes&&h.bucket.generateCollisionDebugBuffers()},a.cx=My,a.cy=Vg,a.cz=Ey,a.d=Fr,a.e=lt,a.f=h=>o(void 0,void 0,void 0,function*(){if(h.byteLength===0)return createImageBitmap(new ImageData(1,1));const u=new Blob([new Uint8Array(h)],{type:"image/png"});try{return createImageBitmap(u)}catch(d){throw new Error(`Could not load image because of ${d.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),a.g=Ht,a.h=h=>new Promise((u,d)=>{const v=new Image;v.onload=()=>{u(v),URL.revokeObjectURL(v.src),v.onload=null,window.requestAnimationFrame(()=>{v.src=Dt})},v.onerror=()=>d(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const P=new Blob([new Uint8Array(h)],{type:"image/png"});v.src=h.byteLength?URL.createObjectURL(P):Dt}),a.i=Be,a.j=(h,u)=>ir(lt(h,{type:"json"}),u),a.k=et,a.l=Ze,a.m=ir,a.n=(h,u)=>ir(lt(h,{type:"arrayBuffer"}),u),a.o=function(h){return new Dy(h).readFields(Dw,[])},a.p=x1,a.q=km,a.r=pe,a.s=vn,a.t=uh,a.u=ie,a.v=$e,a.w=De,a.x=Jh,a.y=fc,a.z=function([h,u,d]){return u+=90,u*=Math.PI/180,d*=Math.PI/180,{x:h*Math.cos(u)*Math.sin(d),y:h*Math.sin(u)*Math.sin(d),z:h*Math.cos(d)}}}),i("worker",["./shared"],function(a){class o{constructor(je){this.keyCache={},je&&this.replace(je)}replace(je){this._layerConfigs={},this._layers={},this.update(je,[])}update(je,Ze){for(const ct of je){this._layerConfigs[ct.id]=ct;const $e=this._layers[ct.id]=a.bA(ct);$e._featureFilter=a.a7($e.filter),this.keyCache[ct.id]&&delete this.keyCache[ct.id]}for(const ct of Ze)delete this.keyCache[ct],delete this._layerConfigs[ct],delete this._layers[ct];this.familiesBySource={};const et=a.cr(Object.values(this._layerConfigs),this.keyCache);for(const ct of et){const $e=ct.map(wn=>this._layers[wn.id]),Gt=$e[0];if(Gt.visibility==="none")continue;const hn=Gt.source||"";let Ot=this.familiesBySource[hn];Ot||(Ot=this.familiesBySource[hn]={});const cn=Gt.sourceLayer||"_geojsonTileLayer";let En=Ot[cn];En||(En=Ot[cn]=[]),En.push($e)}}}class f{constructor(je){const Ze={},et=[];for(const hn in je){const Ot=je[hn],cn=Ze[hn]={};for(const En in Ot){const wn=Ot[+En];if(!wn||wn.bitmap.width===0||wn.bitmap.height===0)continue;const Qn={x:0,y:0,w:wn.bitmap.width+2,h:wn.bitmap.height+2};et.push(Qn),cn[En]={rect:Qn,metrics:wn.metrics}}}const{w:ct,h:$e}=a.p(et),Gt=new a.q({width:ct||1,height:$e||1});for(const hn in je){const Ot=je[hn];for(const cn in Ot){const En=Ot[+cn];if(!En||En.bitmap.width===0||En.bitmap.height===0)continue;const wn=Ze[hn][cn].rect;a.q.copy(En.bitmap,Gt,{x:0,y:0},{x:wn.x+1,y:wn.y+1},En.bitmap)}}this.image=Gt,this.positions=Ze}}a.cs("GlyphAtlas",f);class m{constructor(je){this.tileID=new a.Y(je.tileID.overscaledZ,je.tileID.wrap,je.tileID.canonical.z,je.tileID.canonical.x,je.tileID.canonical.y),this.uid=je.uid,this.zoom=je.zoom,this.pixelRatio=je.pixelRatio,this.tileSize=je.tileSize,this.source=je.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=je.showCollisionBoxes,this.collectResourceTiming=!!je.collectResourceTiming,this.returnDependencies=!!je.returnDependencies,this.promoteId=je.promoteId,this.inFlightDependencies=[]}parse(je,Ze,et,ct,$e){return a._(this,void 0,void 0,function*(){this.status="parsing",this.data=je,this.collisionBoxArray=new a.a5;const Gt=new a.ct(Object.keys(je.layers).sort()),hn=new a.cu(this.tileID,this.promoteId);hn.bucketLayerIDs=[];const Ot={},cn={featureIndex:hn,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:et,subdivisionGranularity:$e},En=Ze.familiesBySource[this.source];for(const Ut in En){const Hn=je.layers[Ut];if(!Hn)continue;Hn.version===1&&a.w(`Vector tile source "${this.source}" layer "${Ut}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const or=Gt.encode(Ut),Xr=[];for(let ri=0;ri<Hn.length;ri++){const ai=Hn.feature(ri),Pr=hn.getId(ai,Ut);Xr.push({feature:ai,id:Pr,index:ri,sourceLayerIndex:or})}for(const ri of En[Ut]){const ai=ri[0];ai.source!==this.source&&a.w(`layer.source = ${ai.source} does not equal this.source = ${this.source}`),ai.minzoom&&this.zoom<Math.floor(ai.minzoom)||ai.maxzoom&&this.zoom>=ai.maxzoom||ai.visibility!=="none"&&(_(ri,this.zoom,et),(Ot[ai.id]=ai.createBucket({index:hn.bucketLayerIDs.length,layers:ri,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:or,sourceID:this.source})).populate(Xr,cn,this.tileID.canonical),hn.bucketLayerIDs.push(ri.map(Pr=>Pr.id)))}}const wn=a.bF(cn.glyphDependencies,Ut=>Object.keys(Ut).map(Number));this.inFlightDependencies.forEach(Ut=>Ut==null?void 0:Ut.abort()),this.inFlightDependencies=[];let Qn=Promise.resolve({});if(Object.keys(wn).length){const Ut=new AbortController;this.inFlightDependencies.push(Ut),Qn=ct.sendAsync({type:"GG",data:{stacks:wn,source:this.source,tileID:this.tileID,type:"glyphs"}},Ut)}const Lr=Object.keys(cn.iconDependencies);let Yt=Promise.resolve({});if(Lr.length){const Ut=new AbortController;this.inFlightDependencies.push(Ut),Yt=ct.sendAsync({type:"GI",data:{icons:Lr,source:this.source,tileID:this.tileID,type:"icons"}},Ut)}const vt=Object.keys(cn.patternDependencies);let Tn=Promise.resolve({});if(vt.length){const Ut=new AbortController;this.inFlightDependencies.push(Ut),Tn=ct.sendAsync({type:"GI",data:{icons:vt,source:this.source,tileID:this.tileID,type:"patterns"}},Ut)}const[bn,br,vr]=yield Promise.all([Qn,Yt,Tn]),Cn=new f(bn),pn=new a.cv(br,vr);for(const Ut in Ot){const Hn=Ot[Ut];Hn instanceof a.a6?(_(Hn.layers,this.zoom,et),a.cw({bucket:Hn,glyphMap:bn,glyphPositions:Cn.positions,imageMap:br,imagePositions:pn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:cn.subdivisionGranularity})):Hn.hasPattern&&(Hn instanceof a.cx||Hn instanceof a.cy||Hn instanceof a.cz)&&(_(Hn.layers,this.zoom,et),Hn.addFeatures(cn,this.tileID.canonical,pn.patternPositions))}return this.status="done",{buckets:Object.values(Ot).filter(Ut=>!Ut.isEmpty()),featureIndex:hn,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Cn.image,imageAtlas:pn,glyphMap:this.returnDependencies?bn:null,iconMap:this.returnDependencies?br:null,glyphPositions:this.returnDependencies?Cn.positions:null}})}}function _(Ft,je,Ze){const et=new a.C(je);for(const ct of Ft)ct.recalculate(et,Ze)}class w{constructor(je,Ze,et){this.actor=je,this.layerIndex=Ze,this.availableImages=et,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(je,Ze){return a._(this,void 0,void 0,function*(){const et=yield a.n(je.request,Ze);try{return{vectorTile:new a.cA.VectorTile(new a.cB(et.data)),rawData:et.data,cacheControl:et.cacheControl,expires:et.expires}}catch(ct){const $e=new Uint8Array(et.data);let Gt=`Unable to parse the tile at ${je.request.url}, `;throw Gt+=$e[0]===31&&$e[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ct.message}`,new Error(Gt)}})}loadTile(je){return a._(this,void 0,void 0,function*(){const Ze=je.uid,et=!!(je&&je.request&&je.request.collectResourceTiming)&&new a.cC(je.request),ct=new m(je);this.loading[Ze]=ct;const $e=new AbortController;ct.abort=$e;try{const Gt=yield this.loadVectorTile(je,$e);if(delete this.loading[Ze],!Gt)return null;const hn=Gt.rawData,Ot={};Gt.expires&&(Ot.expires=Gt.expires),Gt.cacheControl&&(Ot.cacheControl=Gt.cacheControl);const cn={};if(et){const wn=et.finish();wn&&(cn.resourceTiming=JSON.parse(JSON.stringify(wn)))}ct.vectorTile=Gt.vectorTile;const En=ct.parse(Gt.vectorTile,this.layerIndex,this.availableImages,this.actor,je.subdivisionGranularity);this.loaded[Ze]=ct,this.fetching[Ze]={rawTileData:hn,cacheControl:Ot,resourceTiming:cn};try{const wn=yield En;return a.e({rawTileData:hn.slice(0)},wn,Ot,cn)}finally{delete this.fetching[Ze]}}catch(Gt){throw delete this.loading[Ze],ct.status="done",this.loaded[Ze]=ct,Gt}})}reloadTile(je){return a._(this,void 0,void 0,function*(){const Ze=je.uid;if(!this.loaded||!this.loaded[Ze])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const et=this.loaded[Ze];if(et.showCollisionBoxes=je.showCollisionBoxes,et.status==="parsing"){const ct=yield et.parse(et.vectorTile,this.layerIndex,this.availableImages,this.actor,je.subdivisionGranularity);let $e;if(this.fetching[Ze]){const{rawTileData:Gt,cacheControl:hn,resourceTiming:Ot}=this.fetching[Ze];delete this.fetching[Ze],$e=a.e({rawTileData:Gt.slice(0)},ct,hn,Ot)}else $e=ct;return $e}if(et.status==="done"&&et.vectorTile)return et.parse(et.vectorTile,this.layerIndex,this.availableImages,this.actor,je.subdivisionGranularity)})}abortTile(je){return a._(this,void 0,void 0,function*(){const Ze=this.loading,et=je.uid;Ze&&Ze[et]&&Ze[et].abort&&(Ze[et].abort.abort(),delete Ze[et])})}removeTile(je){return a._(this,void 0,void 0,function*(){this.loaded&&this.loaded[je.uid]&&delete this.loaded[je.uid]})}}class M{constructor(){this.loaded={}}loadTile(je){return a._(this,void 0,void 0,function*(){const{uid:Ze,encoding:et,rawImageData:ct,redFactor:$e,greenFactor:Gt,blueFactor:hn,baseShift:Ot}=je,cn=ct.width+2,En=ct.height+2,wn=a.b(ct)?new a.R({width:cn,height:En},yield a.cD(ct,-1,-1,cn,En)):ct,Qn=new a.cE(Ze,wn,et,$e,Gt,hn,Ot);return this.loaded=this.loaded||{},this.loaded[Ze]=Qn,Qn})}removeTile(je){const Ze=this.loaded,et=je.uid;Ze&&Ze[et]&&delete Ze[et]}}var C,R,z=function(){if(R)return C;function Ft(Ze,et){if(Ze.length!==0){je(Ze[0],et);for(var ct=1;ct<Ze.length;ct++)je(Ze[ct],!et)}}function je(Ze,et){for(var ct=0,$e=0,Gt=0,hn=Ze.length,Ot=hn-1;Gt<hn;Ot=Gt++){var cn=(Ze[Gt][0]-Ze[Ot][0])*(Ze[Ot][1]+Ze[Gt][1]),En=ct+cn;$e+=Math.abs(ct)>=Math.abs(cn)?ct-En+cn:cn-En+ct,ct=En}ct+$e>=0!=!!et&&Ze.reverse()}return R=1,C=function Ze(et,ct){var $e,Gt=et&&et.type;if(Gt==="FeatureCollection")for($e=0;$e<et.features.length;$e++)Ze(et.features[$e],ct);else if(Gt==="GeometryCollection")for($e=0;$e<et.geometries.length;$e++)Ze(et.geometries[$e],ct);else if(Gt==="Feature")Ze(et.geometry,ct);else if(Gt==="Polygon")Ft(et.coordinates,ct);else if(Gt==="MultiPolygon")for($e=0;$e<et.coordinates.length;$e++)Ft(et.coordinates[$e],ct);return et}}(),W=a.cF(z);const X=a.cA.VectorTileFeature.prototype.toGeoJSON;class Y{constructor(je){this._feature=je,this.extent=a.Z,this.type=je.type,this.properties=je.tags,"id"in je&&!isNaN(je.id)&&(this.id=parseInt(je.id,10))}loadGeometry(){if(this._feature.type===1){const je=[];for(const Ze of this._feature.geometry)je.push([new a.P(Ze[0],Ze[1])]);return je}{const je=[];for(const Ze of this._feature.geometry){const et=[];for(const ct of Ze)et.push(new a.P(ct[0],ct[1]));je.push(et)}return je}}toGeoJSON(je,Ze,et){return X.call(this,je,Ze,et)}}class Q{constructor(je){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.Z,this.length=je.length,this._features=je}feature(je){return new Y(this._features[je])}}var oe,le,me,we={exports:{}},ue=function(){if(me)return we.exports;me=1;var Ft=a.cI(),je=function(){if(le)return oe;le=1;var En=a.cG(),wn=a.cH().VectorTileFeature;function Qn(Yt,vt){this.options=vt||{},this.features=Yt,this.length=Yt.length}function Lr(Yt,vt){this.id=typeof Yt.id=="number"?Yt.id:void 0,this.type=Yt.type,this.rawGeometry=Yt.type===1?[Yt.geometry]:Yt.geometry,this.properties=Yt.tags,this.extent=vt||4096}return oe=Qn,Qn.prototype.feature=function(Yt){return new Lr(this.features[Yt],this.options.extent)},Lr.prototype.loadGeometry=function(){var Yt=this.rawGeometry;this.geometry=[];for(var vt=0;vt<Yt.length;vt++){for(var Tn=Yt[vt],bn=[],br=0;br<Tn.length;br++)bn.push(new En(Tn[br][0],Tn[br][1]));this.geometry.push(bn)}return this.geometry},Lr.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Yt=this.geometry,vt=1/0,Tn=-1/0,bn=1/0,br=-1/0,vr=0;vr<Yt.length;vr++)for(var Cn=Yt[vr],pn=0;pn<Cn.length;pn++){var Ut=Cn[pn];vt=Math.min(vt,Ut.x),Tn=Math.max(Tn,Ut.x),bn=Math.min(bn,Ut.y),br=Math.max(br,Ut.y)}return[vt,bn,Tn,br]},Lr.prototype.toGeoJSON=wn.prototype.toGeoJSON,oe}();function Ze(En){var wn=new Ft;return function(Qn,Lr){for(var Yt in Qn.layers)Lr.writeMessage(3,et,Qn.layers[Yt])}(En,wn),wn.finish()}function et(En,wn){var Qn;wn.writeVarintField(15,En.version||1),wn.writeStringField(1,En.name||""),wn.writeVarintField(5,En.extent||4096);var Lr={keys:[],values:[],keycache:{},valuecache:{}};for(Qn=0;Qn<En.length;Qn++)Lr.feature=En.feature(Qn),wn.writeMessage(2,ct,Lr);var Yt=Lr.keys;for(Qn=0;Qn<Yt.length;Qn++)wn.writeStringField(3,Yt[Qn]);var vt=Lr.values;for(Qn=0;Qn<vt.length;Qn++)wn.writeMessage(4,cn,vt[Qn])}function ct(En,wn){var Qn=En.feature;Qn.id!==void 0&&wn.writeVarintField(1,Qn.id),wn.writeMessage(2,$e,En),wn.writeVarintField(3,Qn.type),wn.writeMessage(4,Ot,Qn)}function $e(En,wn){var Qn=En.feature,Lr=En.keys,Yt=En.values,vt=En.keycache,Tn=En.valuecache;for(var bn in Qn.properties){var br=Qn.properties[bn],vr=vt[bn];if(br!==null){vr===void 0&&(Lr.push(bn),vt[bn]=vr=Lr.length-1),wn.writeVarint(vr);var Cn=typeof br;Cn!=="string"&&Cn!=="boolean"&&Cn!=="number"&&(br=JSON.stringify(br));var pn=Cn+":"+br,Ut=Tn[pn];Ut===void 0&&(Yt.push(br),Tn[pn]=Ut=Yt.length-1),wn.writeVarint(Ut)}}}function Gt(En,wn){return(wn<<3)+(7&En)}function hn(En){return En<<1^En>>31}function Ot(En,wn){for(var Qn=En.loadGeometry(),Lr=En.type,Yt=0,vt=0,Tn=Qn.length,bn=0;bn<Tn;bn++){var br=Qn[bn],vr=1;Lr===1&&(vr=br.length),wn.writeVarint(Gt(1,vr));for(var Cn=Lr===3?br.length-1:br.length,pn=0;pn<Cn;pn++){pn===1&&Lr!==1&&wn.writeVarint(Gt(2,Cn-1));var Ut=br[pn].x-Yt,Hn=br[pn].y-vt;wn.writeVarint(hn(Ut)),wn.writeVarint(hn(Hn)),Yt+=Ut,vt+=Hn}Lr===3&&wn.writeVarint(Gt(7,1))}}function cn(En,wn){var Qn=typeof En;Qn==="string"?wn.writeStringField(1,En):Qn==="boolean"?wn.writeBooleanField(7,En):Qn==="number"&&(En%1!=0?wn.writeDoubleField(3,En):En<0?wn.writeSVarintField(6,En):wn.writeVarintField(5,En))}return we.exports=Ze,we.exports.fromVectorTileJs=Ze,we.exports.fromGeojsonVt=function(En,wn){wn=wn||{};var Qn={};for(var Lr in En)Qn[Lr]=new je(En[Lr].features,wn),Qn[Lr].name=Lr,Qn[Lr].version=wn.version,Qn[Lr].extent=wn.extent;return Ze({layers:Qn})},we.exports.GeoJSONWrapper=je,we.exports}(),_e=a.cF(ue);const We={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ft=>Ft},he=Math.fround||(de=new Float32Array(1),Ft=>(de[0]=+Ft,de[0]));var de;const Te=3,be=5,ae=6;class ne{constructor(je){this.options=Object.assign(Object.create(We),je),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(je){const{log:Ze,minZoom:et,maxZoom:ct}=this.options;Ze&&console.time("total time");const $e=`prepare ${je.length} points`;Ze&&console.time($e),this.points=je;const Gt=[];for(let Ot=0;Ot<je.length;Ot++){const cn=je[Ot];if(!cn.geometry)continue;const[En,wn]=cn.geometry.coordinates,Qn=he(ze(En)),Lr=he(He(wn));Gt.push(Qn,Lr,1/0,Ot,-1,1),this.options.reduce&&Gt.push(0)}let hn=this.trees[ct+1]=this._createTree(Gt);Ze&&console.timeEnd($e);for(let Ot=ct;Ot>=et;Ot--){const cn=+Date.now();hn=this.trees[Ot]=this._createTree(this._cluster(hn,Ot)),Ze&&console.log("z%d: %d clusters in %dms",Ot,hn.numItems,+Date.now()-cn)}return Ze&&console.timeEnd("total time"),this}getClusters(je,Ze){let et=((je[0]+180)%360+360)%360-180;const ct=Math.max(-90,Math.min(90,je[1]));let $e=je[2]===180?180:((je[2]+180)%360+360)%360-180;const Gt=Math.max(-90,Math.min(90,je[3]));if(je[2]-je[0]>=360)et=-180,$e=180;else if(et>$e){const wn=this.getClusters([et,ct,180,Gt],Ze),Qn=this.getClusters([-180,ct,$e,Gt],Ze);return wn.concat(Qn)}const hn=this.trees[this._limitZoom(Ze)],Ot=hn.range(ze(et),He(Gt),ze($e),He(ct)),cn=hn.data,En=[];for(const wn of Ot){const Qn=this.stride*wn;En.push(cn[Qn+be]>1?Se(cn,Qn,this.clusterProps):this.points[cn[Qn+Te]])}return En}getChildren(je){const Ze=this._getOriginId(je),et=this._getOriginZoom(je),ct="No cluster with the specified id.",$e=this.trees[et];if(!$e)throw new Error(ct);const Gt=$e.data;if(Ze*this.stride>=Gt.length)throw new Error(ct);const hn=this.options.radius/(this.options.extent*Math.pow(2,et-1)),Ot=$e.within(Gt[Ze*this.stride],Gt[Ze*this.stride+1],hn),cn=[];for(const En of Ot){const wn=En*this.stride;Gt[wn+4]===je&&cn.push(Gt[wn+be]>1?Se(Gt,wn,this.clusterProps):this.points[Gt[wn+Te]])}if(cn.length===0)throw new Error(ct);return cn}getLeaves(je,Ze,et){const ct=[];return this._appendLeaves(ct,je,Ze=Ze||10,et=et||0,0),ct}getTile(je,Ze,et){const ct=this.trees[this._limitZoom(je)],$e=Math.pow(2,je),{extent:Gt,radius:hn}=this.options,Ot=hn/Gt,cn=(et-Ot)/$e,En=(et+1+Ot)/$e,wn={features:[]};return this._addTileFeatures(ct.range((Ze-Ot)/$e,cn,(Ze+1+Ot)/$e,En),ct.data,Ze,et,$e,wn),Ze===0&&this._addTileFeatures(ct.range(1-Ot/$e,cn,1,En),ct.data,$e,et,$e,wn),Ze===$e-1&&this._addTileFeatures(ct.range(0,cn,Ot/$e,En),ct.data,-1,et,$e,wn),wn.features.length?wn:null}getClusterExpansionZoom(je){let Ze=this._getOriginZoom(je)-1;for(;Ze<=this.options.maxZoom;){const et=this.getChildren(je);if(Ze++,et.length!==1)break;je=et[0].properties.cluster_id}return Ze}_appendLeaves(je,Ze,et,ct,$e){const Gt=this.getChildren(Ze);for(const hn of Gt){const Ot=hn.properties;if(Ot&&Ot.cluster?$e+Ot.point_count<=ct?$e+=Ot.point_count:$e=this._appendLeaves(je,Ot.cluster_id,et,ct,$e):$e<ct?$e++:je.push(hn),je.length===et)break}return $e}_createTree(je){const Ze=new a.aF(je.length/this.stride|0,this.options.nodeSize,Float32Array);for(let et=0;et<je.length;et+=this.stride)Ze.add(je[et],je[et+1]);return Ze.finish(),Ze.data=je,Ze}_addTileFeatures(je,Ze,et,ct,$e,Gt){for(const hn of je){const Ot=hn*this.stride,cn=Ze[Ot+be]>1;let En,wn,Qn;if(cn)En=Le(Ze,Ot,this.clusterProps),wn=Ze[Ot],Qn=Ze[Ot+1];else{const vt=this.points[Ze[Ot+Te]];En=vt.properties;const[Tn,bn]=vt.geometry.coordinates;wn=ze(Tn),Qn=He(bn)}const Lr={type:1,geometry:[[Math.round(this.options.extent*(wn*$e-et)),Math.round(this.options.extent*(Qn*$e-ct))]],tags:En};let Yt;Yt=cn||this.options.generateId?Ze[Ot+Te]:this.points[Ze[Ot+Te]].id,Yt!==void 0&&(Lr.id=Yt),Gt.features.push(Lr)}}_limitZoom(je){return Math.max(this.options.minZoom,Math.min(Math.floor(+je),this.options.maxZoom+1))}_cluster(je,Ze){const{radius:et,extent:ct,reduce:$e,minPoints:Gt}=this.options,hn=et/(ct*Math.pow(2,Ze)),Ot=je.data,cn=[],En=this.stride;for(let wn=0;wn<Ot.length;wn+=En){if(Ot[wn+2]<=Ze)continue;Ot[wn+2]=Ze;const Qn=Ot[wn],Lr=Ot[wn+1],Yt=je.within(Ot[wn],Ot[wn+1],hn),vt=Ot[wn+be];let Tn=vt;for(const bn of Yt){const br=bn*En;Ot[br+2]>Ze&&(Tn+=Ot[br+be])}if(Tn>vt&&Tn>=Gt){let bn,br=Qn*vt,vr=Lr*vt,Cn=-1;const pn=((wn/En|0)<<5)+(Ze+1)+this.points.length;for(const Ut of Yt){const Hn=Ut*En;if(Ot[Hn+2]<=Ze)continue;Ot[Hn+2]=Ze;const or=Ot[Hn+be];br+=Ot[Hn]*or,vr+=Ot[Hn+1]*or,Ot[Hn+4]=pn,$e&&(bn||(bn=this._map(Ot,wn,!0),Cn=this.clusterProps.length,this.clusterProps.push(bn)),$e(bn,this._map(Ot,Hn)))}Ot[wn+4]=pn,cn.push(br/Tn,vr/Tn,1/0,pn,-1,Tn),$e&&cn.push(Cn)}else{for(let bn=0;bn<En;bn++)cn.push(Ot[wn+bn]);if(Tn>1)for(const bn of Yt){const br=bn*En;if(!(Ot[br+2]<=Ze)){Ot[br+2]=Ze;for(let vr=0;vr<En;vr++)cn.push(Ot[br+vr])}}}}return cn}_getOriginId(je){return je-this.points.length>>5}_getOriginZoom(je){return(je-this.points.length)%32}_map(je,Ze,et){if(je[Ze+be]>1){const Gt=this.clusterProps[je[Ze+ae]];return et?Object.assign({},Gt):Gt}const ct=this.points[je[Ze+Te]].properties,$e=this.options.map(ct);return et&&$e===ct?Object.assign({},$e):$e}}function Se(Ft,je,Ze){return{type:"Feature",id:Ft[je+Te],properties:Le(Ft,je,Ze),geometry:{type:"Point",coordinates:[(et=Ft[je],360*(et-.5)),pt(Ft[je+1])]}};var et}function Le(Ft,je,Ze){const et=Ft[je+be],ct=et>=1e4?`${Math.round(et/1e3)}k`:et>=1e3?Math.round(et/100)/10+"k":et,$e=Ft[je+ae],Gt=$e===-1?{}:Object.assign({},Ze[$e]);return Object.assign(Gt,{cluster:!0,cluster_id:Ft[je+Te],point_count:et,point_count_abbreviated:ct})}function ze(Ft){return Ft/360+.5}function He(Ft){const je=Math.sin(Ft*Math.PI/180),Ze=.5-.25*Math.log((1+je)/(1-je))/Math.PI;return Ze<0?0:Ze>1?1:Ze}function pt(Ft){const je=(180-360*Ft)*Math.PI/180;return 360*Math.atan(Math.exp(je))/Math.PI-90}function ge(Ft,je,Ze,et){let ct=et;const $e=je+(Ze-je>>1);let Gt,hn=Ze-je;const Ot=Ft[je],cn=Ft[je+1],En=Ft[Ze],wn=Ft[Ze+1];for(let Qn=je+3;Qn<Ze;Qn+=3){const Lr=Ie(Ft[Qn],Ft[Qn+1],Ot,cn,En,wn);if(Lr>ct)Gt=Qn,ct=Lr;else if(Lr===ct){const Yt=Math.abs(Qn-$e);Yt<hn&&(Gt=Qn,hn=Yt)}}ct>et&&(Gt-je>3&&ge(Ft,je,Gt,et),Ft[Gt+2]=ct,Ze-Gt>3&&ge(Ft,Gt,Ze,et))}function Ie(Ft,je,Ze,et,ct,$e){let Gt=ct-Ze,hn=$e-et;if(Gt!==0||hn!==0){const Ot=((Ft-Ze)*Gt+(je-et)*hn)/(Gt*Gt+hn*hn);Ot>1?(Ze=ct,et=$e):Ot>0&&(Ze+=Gt*Ot,et+=hn*Ot)}return Gt=Ft-Ze,hn=je-et,Gt*Gt+hn*hn}function Ne(Ft,je,Ze,et){const ct={id:Ft??null,type:je,geometry:Ze,tags:et,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(je==="Point"||je==="MultiPoint"||je==="LineString")Ve(ct,Ze);else if(je==="Polygon")Ve(ct,Ze[0]);else if(je==="MultiLineString")for(const $e of Ze)Ve(ct,$e);else if(je==="MultiPolygon")for(const $e of Ze)Ve(ct,$e[0]);return ct}function Ve(Ft,je){for(let Ze=0;Ze<je.length;Ze+=3)Ft.minX=Math.min(Ft.minX,je[Ze]),Ft.minY=Math.min(Ft.minY,je[Ze+1]),Ft.maxX=Math.max(Ft.maxX,je[Ze]),Ft.maxY=Math.max(Ft.maxY,je[Ze+1])}function it(Ft,je,Ze,et){if(!je.geometry)return;const ct=je.geometry.coordinates;if(ct&&ct.length===0)return;const $e=je.geometry.type,Gt=Math.pow(Ze.tolerance/((1<<Ze.maxZoom)*Ze.extent),2);let hn=[],Ot=je.id;if(Ze.promoteId?Ot=je.properties[Ze.promoteId]:Ze.generateId&&(Ot=et||0),$e==="Point")lt(ct,hn);else if($e==="MultiPoint")for(const cn of ct)lt(cn,hn);else if($e==="LineString")Mt(ct,hn,Gt,!1);else if($e==="MultiLineString"){if(Ze.lineMetrics){for(const cn of ct)hn=[],Mt(cn,hn,Gt,!1),Ft.push(Ne(Ot,"LineString",hn,je.properties));return}wt(ct,hn,Gt,!1)}else if($e==="Polygon")wt(ct,hn,Gt,!0);else{if($e!=="MultiPolygon"){if($e==="GeometryCollection"){for(const cn of je.geometry.geometries)it(Ft,{id:Ot,geometry:cn,properties:je.properties},Ze,et);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const cn of ct){const En=[];wt(cn,En,Gt,!0),hn.push(En)}}Ft.push(Ne(Ot,$e,hn,je.properties))}function lt(Ft,je){je.push(rn(Ft[0]),yn(Ft[1]),0)}function Mt(Ft,je,Ze,et){let ct,$e,Gt=0;for(let Ot=0;Ot<Ft.length;Ot++){const cn=rn(Ft[Ot][0]),En=yn(Ft[Ot][1]);je.push(cn,En,0),Ot>0&&(Gt+=et?(ct*En-cn*$e)/2:Math.sqrt(Math.pow(cn-ct,2)+Math.pow(En-$e,2))),ct=cn,$e=En}const hn=je.length-3;je[2]=1,ge(je,0,hn,Ze),je[hn+2]=1,je.size=Math.abs(Gt),je.start=0,je.end=je.size}function wt(Ft,je,Ze,et){for(let ct=0;ct<Ft.length;ct++){const $e=[];Mt(Ft[ct],$e,Ze,et),je.push($e)}}function rn(Ft){return Ft/360+.5}function yn(Ft){const je=Math.sin(Ft*Math.PI/180),Ze=.5-.25*Math.log((1+je)/(1-je))/Math.PI;return Ze<0?0:Ze>1?1:Ze}function Pn(Ft,je,Ze,et,ct,$e,Gt,hn){if(et/=je,$e>=(Ze/=je)&&Gt<et)return Ft;if(Gt<Ze||$e>=et)return null;const Ot=[];for(const cn of Ft){const En=cn.geometry;let wn=cn.type;const Qn=ct===0?cn.minX:cn.minY,Lr=ct===0?cn.maxX:cn.maxY;if(Qn>=Ze&&Lr<et){Ot.push(cn);continue}if(Lr<Ze||Qn>=et)continue;let Yt=[];if(wn==="Point"||wn==="MultiPoint")De(En,Yt,Ze,et,ct);else if(wn==="LineString")Ae(En,Yt,Ze,et,ct,!1,hn.lineMetrics);else if(wn==="MultiLineString")Ce(En,Yt,Ze,et,ct,!1);else if(wn==="Polygon")Ce(En,Yt,Ze,et,ct,!0);else if(wn==="MultiPolygon")for(const vt of En){const Tn=[];Ce(vt,Tn,Ze,et,ct,!0),Tn.length&&Yt.push(Tn)}if(Yt.length){if(hn.lineMetrics&&wn==="LineString"){for(const vt of Yt)Ot.push(Ne(cn.id,wn,vt,cn.tags));continue}wn!=="LineString"&&wn!=="MultiLineString"||(Yt.length===1?(wn="LineString",Yt=Yt[0]):wn="MultiLineString"),wn!=="Point"&&wn!=="MultiPoint"||(wn=Yt.length===3?"Point":"MultiPoint"),Ot.push(Ne(cn.id,wn,Yt,cn.tags))}}return Ot.length?Ot:null}function De(Ft,je,Ze,et,ct){for(let $e=0;$e<Ft.length;$e+=3){const Gt=Ft[$e+ct];Gt>=Ze&&Gt<=et&&ot(je,Ft[$e],Ft[$e+1],Ft[$e+2])}}function Ae(Ft,je,Ze,et,ct,$e,Gt){let hn=Be(Ft);const Ot=ct===0?Dt:Zt;let cn,En,wn=Ft.start;for(let Tn=0;Tn<Ft.length-3;Tn+=3){const bn=Ft[Tn],br=Ft[Tn+1],vr=Ft[Tn+2],Cn=Ft[Tn+3],pn=Ft[Tn+4],Ut=ct===0?bn:br,Hn=ct===0?Cn:pn;let or=!1;Gt&&(cn=Math.sqrt(Math.pow(bn-Cn,2)+Math.pow(br-pn,2))),Ut<Ze?Hn>Ze&&(En=Ot(hn,bn,br,Cn,pn,Ze),Gt&&(hn.start=wn+cn*En)):Ut>et?Hn<et&&(En=Ot(hn,bn,br,Cn,pn,et),Gt&&(hn.start=wn+cn*En)):ot(hn,bn,br,vr),Hn<Ze&&Ut>=Ze&&(En=Ot(hn,bn,br,Cn,pn,Ze),or=!0),Hn>et&&Ut<=et&&(En=Ot(hn,bn,br,Cn,pn,et),or=!0),!$e&&or&&(Gt&&(hn.end=wn+cn*En),je.push(hn),hn=Be(Ft)),Gt&&(wn+=cn)}let Qn=Ft.length-3;const Lr=Ft[Qn],Yt=Ft[Qn+1],vt=ct===0?Lr:Yt;vt>=Ze&&vt<=et&&ot(hn,Lr,Yt,Ft[Qn+2]),Qn=hn.length-3,$e&&Qn>=3&&(hn[Qn]!==hn[0]||hn[Qn+1]!==hn[1])&&ot(hn,hn[0],hn[1],hn[2]),hn.length&&je.push(hn)}function Be(Ft){const je=[];return je.size=Ft.size,je.start=Ft.start,je.end=Ft.end,je}function Ce(Ft,je,Ze,et,ct,$e){for(const Gt of Ft)Ae(Gt,je,Ze,et,ct,$e,!1)}function ot(Ft,je,Ze,et){Ft.push(je,Ze,et)}function Dt(Ft,je,Ze,et,ct,$e){const Gt=($e-je)/(et-je);return ot(Ft,$e,Ze+(ct-Ze)*Gt,1),Gt}function Zt(Ft,je,Ze,et,ct,$e){const Gt=($e-Ze)/(ct-Ze);return ot(Ft,je+(et-je)*Gt,$e,1),Gt}function an(Ft,je){const Ze=[];for(let et=0;et<Ft.length;et++){const ct=Ft[et],$e=ct.type;let Gt;if($e==="Point"||$e==="MultiPoint"||$e==="LineString")Gt=ln(ct.geometry,je);else if($e==="MultiLineString"||$e==="Polygon"){Gt=[];for(const hn of ct.geometry)Gt.push(ln(hn,je))}else if($e==="MultiPolygon"){Gt=[];for(const hn of ct.geometry){const Ot=[];for(const cn of hn)Ot.push(ln(cn,je));Gt.push(Ot)}}Ze.push(Ne(ct.id,$e,Gt,ct.tags))}return Ze}function ln(Ft,je){const Ze=[];Ze.size=Ft.size,Ft.start!==void 0&&(Ze.start=Ft.start,Ze.end=Ft.end);for(let et=0;et<Ft.length;et+=3)Ze.push(Ft[et]+je,Ft[et+1],Ft[et+2]);return Ze}function vn(Ft,je){if(Ft.transformed)return Ft;const Ze=1<<Ft.z,et=Ft.x,ct=Ft.y;for(const $e of Ft.features){const Gt=$e.geometry,hn=$e.type;if($e.geometry=[],hn===1)for(let Ot=0;Ot<Gt.length;Ot+=2)$e.geometry.push(qn(Gt[Ot],Gt[Ot+1],je,Ze,et,ct));else for(let Ot=0;Ot<Gt.length;Ot++){const cn=[];for(let En=0;En<Gt[Ot].length;En+=2)cn.push(qn(Gt[Ot][En],Gt[Ot][En+1],je,Ze,et,ct));$e.geometry.push(cn)}}return Ft.transformed=!0,Ft}function qn(Ft,je,Ze,et,ct,$e){return[Math.round(Ze*(Ft*et-ct)),Math.round(Ze*(je*et-$e))]}function Kn(Ft,je,Ze,et,ct){const $e=je===ct.maxZoom?0:ct.tolerance/((1<<je)*ct.extent),Gt={features:[],numPoints:0,numSimplified:0,numFeatures:Ft.length,source:null,x:Ze,y:et,z:je,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const hn of Ft)cr(Gt,hn,$e,ct);return Gt}function cr(Ft,je,Ze,et){const ct=je.geometry,$e=je.type,Gt=[];if(Ft.minX=Math.min(Ft.minX,je.minX),Ft.minY=Math.min(Ft.minY,je.minY),Ft.maxX=Math.max(Ft.maxX,je.maxX),Ft.maxY=Math.max(Ft.maxY,je.maxY),$e==="Point"||$e==="MultiPoint")for(let hn=0;hn<ct.length;hn+=3)Gt.push(ct[hn],ct[hn+1]),Ft.numPoints++,Ft.numSimplified++;else if($e==="LineString")pr(Gt,ct,Ft,Ze,!1,!1);else if($e==="MultiLineString"||$e==="Polygon")for(let hn=0;hn<ct.length;hn++)pr(Gt,ct[hn],Ft,Ze,$e==="Polygon",hn===0);else if($e==="MultiPolygon")for(let hn=0;hn<ct.length;hn++){const Ot=ct[hn];for(let cn=0;cn<Ot.length;cn++)pr(Gt,Ot[cn],Ft,Ze,!0,cn===0)}if(Gt.length){let hn=je.tags||null;if($e==="LineString"&&et.lineMetrics){hn={};for(const cn in je.tags)hn[cn]=je.tags[cn];hn.mapbox_clip_start=ct.start/ct.size,hn.mapbox_clip_end=ct.end/ct.size}const Ot={geometry:Gt,type:$e==="Polygon"||$e==="MultiPolygon"?3:$e==="LineString"||$e==="MultiLineString"?2:1,tags:hn};je.id!==null&&(Ot.id=je.id),Ft.features.push(Ot)}}function pr(Ft,je,Ze,et,ct,$e){const Gt=et*et;if(et>0&&je.size<(ct?Gt:et))return void(Ze.numPoints+=je.length/3);const hn=[];for(let Ot=0;Ot<je.length;Ot+=3)(et===0||je[Ot+2]>Gt)&&(Ze.numSimplified++,hn.push(je[Ot],je[Ot+1])),Ze.numPoints++;ct&&function(Ot,cn){let En=0;for(let wn=0,Qn=Ot.length,Lr=Qn-2;wn<Qn;Lr=wn,wn+=2)En+=(Ot[wn]-Ot[Lr])*(Ot[wn+1]+Ot[Lr+1]);if(En>0===cn)for(let wn=0,Qn=Ot.length;wn<Qn/2;wn+=2){const Lr=Ot[wn],Yt=Ot[wn+1];Ot[wn]=Ot[Qn-2-wn],Ot[wn+1]=Ot[Qn-1-wn],Ot[Qn-2-wn]=Lr,Ot[Qn-1-wn]=Yt}}(hn,$e),Ft.push(hn)}const Dr={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class zr{constructor(je,Ze){const et=(Ze=this.options=function($e,Gt){for(const hn in Gt)$e[hn]=Gt[hn];return $e}(Object.create(Dr),Ze)).debug;if(et&&console.time("preprocess data"),Ze.maxZoom<0||Ze.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Ze.promoteId&&Ze.generateId)throw new Error("promoteId and generateId cannot be used together.");let ct=function($e,Gt){const hn=[];if($e.type==="FeatureCollection")for(let Ot=0;Ot<$e.features.length;Ot++)it(hn,$e.features[Ot],Gt,Ot);else it(hn,$e.type==="Feature"?$e:{geometry:$e},Gt);return hn}(je,Ze);this.tiles={},this.tileCoords=[],et&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Ze.indexMaxZoom,Ze.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ct=function($e,Gt){const hn=Gt.buffer/Gt.extent;let Ot=$e;const cn=Pn($e,1,-1-hn,hn,0,-1,2,Gt),En=Pn($e,1,1-hn,2+hn,0,-1,2,Gt);return(cn||En)&&(Ot=Pn($e,1,-hn,1+hn,0,-1,2,Gt)||[],cn&&(Ot=an(cn,1).concat(Ot)),En&&(Ot=Ot.concat(an(En,-1)))),Ot}(ct,Ze),ct.length&&this.splitTile(ct,0,0,0),et&&(ct.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(je,Ze,et,ct,$e,Gt,hn){const Ot=[je,Ze,et,ct],cn=this.options,En=cn.debug;for(;Ot.length;){ct=Ot.pop(),et=Ot.pop(),Ze=Ot.pop(),je=Ot.pop();const wn=1<<Ze,Qn=Ht(Ze,et,ct);let Lr=this.tiles[Qn];if(!Lr&&(En>1&&console.time("creation"),Lr=this.tiles[Qn]=Kn(je,Ze,et,ct,cn),this.tileCoords.push({z:Ze,x:et,y:ct}),En)){En>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ze,et,ct,Lr.numFeatures,Lr.numPoints,Lr.numSimplified),console.timeEnd("creation"));const or=`z${Ze}`;this.stats[or]=(this.stats[or]||0)+1,this.total++}if(Lr.source=je,$e==null){if(Ze===cn.indexMaxZoom||Lr.numPoints<=cn.indexMaxPoints)continue}else{if(Ze===cn.maxZoom||Ze===$e)continue;if($e!=null){const or=$e-Ze;if(et!==Gt>>or||ct!==hn>>or)continue}}if(Lr.source=null,je.length===0)continue;En>1&&console.time("clipping");const Yt=.5*cn.buffer/cn.extent,vt=.5-Yt,Tn=.5+Yt,bn=1+Yt;let br=null,vr=null,Cn=null,pn=null,Ut=Pn(je,wn,et-Yt,et+Tn,0,Lr.minX,Lr.maxX,cn),Hn=Pn(je,wn,et+vt,et+bn,0,Lr.minX,Lr.maxX,cn);je=null,Ut&&(br=Pn(Ut,wn,ct-Yt,ct+Tn,1,Lr.minY,Lr.maxY,cn),vr=Pn(Ut,wn,ct+vt,ct+bn,1,Lr.minY,Lr.maxY,cn),Ut=null),Hn&&(Cn=Pn(Hn,wn,ct-Yt,ct+Tn,1,Lr.minY,Lr.maxY,cn),pn=Pn(Hn,wn,ct+vt,ct+bn,1,Lr.minY,Lr.maxY,cn),Hn=null),En>1&&console.timeEnd("clipping"),Ot.push(br||[],Ze+1,2*et,2*ct),Ot.push(vr||[],Ze+1,2*et,2*ct+1),Ot.push(Cn||[],Ze+1,2*et+1,2*ct),Ot.push(pn||[],Ze+1,2*et+1,2*ct+1)}}getTile(je,Ze,et){je=+je,Ze=+Ze,et=+et;const ct=this.options,{extent:$e,debug:Gt}=ct;if(je<0||je>24)return null;const hn=1<<je,Ot=Ht(je,Ze=Ze+hn&hn-1,et);if(this.tiles[Ot])return vn(this.tiles[Ot],$e);Gt>1&&console.log("drilling down to z%d-%d-%d",je,Ze,et);let cn,En=je,wn=Ze,Qn=et;for(;!cn&&En>0;)En--,wn>>=1,Qn>>=1,cn=this.tiles[Ht(En,wn,Qn)];return cn&&cn.source?(Gt>1&&(console.log("found parent tile z%d-%d-%d",En,wn,Qn),console.time("drilling down")),this.splitTile(cn.source,En,wn,Qn,je,Ze,et),Gt>1&&console.timeEnd("drilling down"),this.tiles[Ot]?vn(this.tiles[Ot],$e):null):null}}function Ht(Ft,je,Ze){return 32*((1<<Ft)*Ze+je)+Ft}function tn(Ft,je){return je?Ft.properties[je]:Ft.id}function Kt(Ft,je){if(Ft==null)return!0;if(Ft.type==="Feature")return tn(Ft,je)!=null;if(Ft.type==="FeatureCollection"){const Ze=new Set;for(const et of Ft.features){const ct=tn(et,je);if(ct==null||Ze.has(ct))return!1;Ze.add(ct)}return!0}return!1}function Yn(Ft,je){const Ze=new Map;if(Ft!=null)if(Ft.type==="Feature")Ze.set(tn(Ft,je),Ft);else for(const et of Ft.features)Ze.set(tn(et,je),et);return Ze}class ir extends w{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(je,Ze){return a._(this,void 0,void 0,function*(){const et=je.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ct=this._geoJSONIndex.getTile(et.z,et.x,et.y);if(!ct)return null;const $e=new Q(ct.features);let Gt=_e($e);return Gt.byteOffset===0&&Gt.byteLength===Gt.buffer.byteLength||(Gt=new Uint8Array(Gt)),{vectorTile:$e,rawData:Gt.buffer}})}loadData(je){return a._(this,void 0,void 0,function*(){var Ze;(Ze=this._pendingRequest)===null||Ze===void 0||Ze.abort();const et=!!(je&&je.request&&je.request.collectResourceTiming)&&new a.cC(je.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(je,this._pendingRequest),this._geoJSONIndex=je.cluster?new ne(function({superclusterOptions:Gt,clusterProperties:hn}){if(!hn||!Gt)return Gt;const Ot={},cn={},En={accumulated:null,zoom:0},wn={properties:null},Qn=Object.keys(hn);for(const Lr of Qn){const[Yt,vt]=hn[Lr],Tn=a.cJ(vt),bn=a.cJ(typeof Yt=="string"?[Yt,["accumulated"],["get",Lr]]:Yt);Ot[Lr]=Tn.value,cn[Lr]=bn.value}return Gt.map=Lr=>{wn.properties=Lr;const Yt={};for(const vt of Qn)Yt[vt]=Ot[vt].evaluate(En,wn);return Yt},Gt.reduce=(Lr,Yt)=>{wn.properties=Yt;for(const vt of Qn)En.accumulated=Lr[vt],Lr[vt]=cn[vt].evaluate(En,wn)},Gt}(je)).load((yield this._pendingData).features):(ct=yield this._pendingData,new zr(ct,je.geojsonVtOptions)),this.loaded={};const $e={};if(et){const Gt=et.finish();Gt&&($e.resourceTiming={},$e.resourceTiming[je.source]=JSON.parse(JSON.stringify(Gt)))}return $e}catch($e){if(delete this._pendingRequest,a.cn($e))return{abandoned:!0};throw $e}var ct})}getData(){return a._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(je){const Ze=this.loaded;return Ze&&Ze[je.uid]?super.reloadTile(je):this.loadTile(je)}loadAndProcessGeoJSON(je,Ze){return a._(this,void 0,void 0,function*(){let et=yield this.loadGeoJSON(je,Ze);if(delete this._pendingRequest,typeof et!="object")throw new Error(`Input data given to '${je.source}' is not a valid GeoJSON object.`);if(W(et,!0),je.filter){const ct=a.cJ(je.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ct.result==="error")throw new Error(ct.value.map(Gt=>`${Gt.key}: ${Gt.message}`).join(", "));et={type:"FeatureCollection",features:et.features.filter(Gt=>ct.value.evaluate({zoom:0},Gt))}}return et})}loadGeoJSON(je,Ze){return a._(this,void 0,void 0,function*(){const{promoteId:et}=je;if(je.request){const ct=yield a.j(je.request,Ze);return this._dataUpdateable=Kt(ct.data,et)?Yn(ct.data,et):void 0,ct.data}if(typeof je.data=="string")try{const ct=JSON.parse(je.data);return this._dataUpdateable=Kt(ct,et)?Yn(ct,et):void 0,ct}catch{throw new Error(`Input data given to '${je.source}' is not a valid GeoJSON object.`)}if(!je.dataDiff)throw new Error(`Input data given to '${je.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${je.source}`);return function(ct,$e,Gt){var hn,Ot,cn,En;if($e.removeAll&&ct.clear(),$e.remove)for(const wn of $e.remove)ct.delete(wn);if($e.add)for(const wn of $e.add){const Qn=tn(wn,Gt);Qn!=null&&ct.set(Qn,wn)}if($e.update)for(const wn of $e.update){let Qn=ct.get(wn.id);if(Qn==null)continue;const Lr=!wn.removeAllProperties&&(((hn=wn.removeProperties)===null||hn===void 0?void 0:hn.length)>0||((Ot=wn.addOrUpdateProperties)===null||Ot===void 0?void 0:Ot.length)>0);if((wn.newGeometry||wn.removeAllProperties||Lr)&&(Qn=Object.assign({},Qn),ct.set(wn.id,Qn),Lr&&(Qn.properties=Object.assign({},Qn.properties))),wn.newGeometry&&(Qn.geometry=wn.newGeometry),wn.removeAllProperties)Qn.properties={};else if(((cn=wn.removeProperties)===null||cn===void 0?void 0:cn.length)>0)for(const Yt of wn.removeProperties)Object.prototype.hasOwnProperty.call(Qn.properties,Yt)&&delete Qn.properties[Yt];if(((En=wn.addOrUpdateProperties)===null||En===void 0?void 0:En.length)>0)for(const{key:Yt,value:vt}of wn.addOrUpdateProperties)Qn.properties[Yt]=vt}}(this._dataUpdateable,je.dataDiff,et),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(je){return a._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(je){return this._geoJSONIndex.getClusterExpansionZoom(je.clusterId)}getClusterChildren(je){return this._geoJSONIndex.getChildren(je.clusterId)}getClusterLeaves(je){return this._geoJSONIndex.getLeaves(je.clusterId,je.limit,je.offset)}}class Fr{constructor(je){this.self=je,this.actor=new a.H(je),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(Ze,et)=>{if(this.externalWorkerSourceTypes[Ze])throw new Error(`Worker source with name "${Ze}" already registered.`);this.externalWorkerSourceTypes[Ze]=et},this.self.addProtocol=a.cp,this.self.removeProtocol=a.cq,this.self.registerRTLTextPlugin=Ze=>{a.cK.setMethods(Ze)},this.actor.registerMessageHandler("LDT",(Ze,et)=>this._getDEMWorkerSource(Ze,et.source).loadTile(et)),this.actor.registerMessageHandler("RDT",(Ze,et)=>a._(this,void 0,void 0,function*(){this._getDEMWorkerSource(Ze,et.source).removeTile(et)})),this.actor.registerMessageHandler("GCEZ",(Ze,et)=>a._(this,void 0,void 0,function*(){return this._getWorkerSource(Ze,et.type,et.source).getClusterExpansionZoom(et)})),this.actor.registerMessageHandler("GCC",(Ze,et)=>a._(this,void 0,void 0,function*(){return this._getWorkerSource(Ze,et.type,et.source).getClusterChildren(et)})),this.actor.registerMessageHandler("GCL",(Ze,et)=>a._(this,void 0,void 0,function*(){return this._getWorkerSource(Ze,et.type,et.source).getClusterLeaves(et)})),this.actor.registerMessageHandler("LD",(Ze,et)=>this._getWorkerSource(Ze,et.type,et.source).loadData(et)),this.actor.registerMessageHandler("GD",(Ze,et)=>this._getWorkerSource(Ze,et.type,et.source).getData()),this.actor.registerMessageHandler("LT",(Ze,et)=>this._getWorkerSource(Ze,et.type,et.source).loadTile(et)),this.actor.registerMessageHandler("RT",(Ze,et)=>this._getWorkerSource(Ze,et.type,et.source).reloadTile(et)),this.actor.registerMessageHandler("AT",(Ze,et)=>this._getWorkerSource(Ze,et.type,et.source).abortTile(et)),this.actor.registerMessageHandler("RMT",(Ze,et)=>this._getWorkerSource(Ze,et.type,et.source).removeTile(et)),this.actor.registerMessageHandler("RS",(Ze,et)=>a._(this,void 0,void 0,function*(){if(!this.workerSources[Ze]||!this.workerSources[Ze][et.type]||!this.workerSources[Ze][et.type][et.source])return;const ct=this.workerSources[Ze][et.type][et.source];delete this.workerSources[Ze][et.type][et.source],ct.removeSource!==void 0&&ct.removeSource(et)})),this.actor.registerMessageHandler("RM",Ze=>a._(this,void 0,void 0,function*(){delete this.layerIndexes[Ze],delete this.availableImages[Ze],delete this.workerSources[Ze],delete this.demWorkerSources[Ze]})),this.actor.registerMessageHandler("SR",(Ze,et)=>a._(this,void 0,void 0,function*(){this.referrer=et})),this.actor.registerMessageHandler("SRPS",(Ze,et)=>this._syncRTLPluginState(Ze,et)),this.actor.registerMessageHandler("IS",(Ze,et)=>a._(this,void 0,void 0,function*(){this.self.importScripts(et)})),this.actor.registerMessageHandler("SI",(Ze,et)=>this._setImages(Ze,et)),this.actor.registerMessageHandler("UL",(Ze,et)=>a._(this,void 0,void 0,function*(){this._getLayerIndex(Ze).update(et.layers,et.removedIds)})),this.actor.registerMessageHandler("SL",(Ze,et)=>a._(this,void 0,void 0,function*(){this._getLayerIndex(Ze).replace(et)}))}_setImages(je,Ze){return a._(this,void 0,void 0,function*(){this.availableImages[je]=Ze;for(const et in this.workerSources[je]){const ct=this.workerSources[je][et];for(const $e in ct)ct[$e].availableImages=Ze}})}_syncRTLPluginState(je,Ze){return a._(this,void 0,void 0,function*(){return yield a.cK.syncState(Ze,this.self.importScripts)})}_getAvailableImages(je){let Ze=this.availableImages[je];return Ze||(Ze=[]),Ze}_getLayerIndex(je){let Ze=this.layerIndexes[je];return Ze||(Ze=this.layerIndexes[je]=new o),Ze}_getWorkerSource(je,Ze,et){if(this.workerSources[je]||(this.workerSources[je]={}),this.workerSources[je][Ze]||(this.workerSources[je][Ze]={}),!this.workerSources[je][Ze][et]){const ct={sendAsync:($e,Gt)=>($e.targetMapId=je,this.actor.sendAsync($e,Gt))};switch(Ze){case"vector":this.workerSources[je][Ze][et]=new w(ct,this._getLayerIndex(je),this._getAvailableImages(je));break;case"geojson":this.workerSources[je][Ze][et]=new ir(ct,this._getLayerIndex(je),this._getAvailableImages(je));break;default:this.workerSources[je][Ze][et]=new this.externalWorkerSourceTypes[Ze](ct,this._getLayerIndex(je),this._getAvailableImages(je))}}return this.workerSources[je][Ze][et]}_getDEMWorkerSource(je,Ze){return this.demWorkerSources[je]||(this.demWorkerSources[je]={}),this.demWorkerSources[je][Ze]||(this.demWorkerSources[je][Ze]=new M),this.demWorkerSources[je][Ze]}}return a.i(self)&&(self.worker=new Fr(self)),Fr}),i("index",["exports","./shared"],function(a,o){var f="5.4.0";function m(){var E=new o.A(4);return o.A!=Float32Array&&(E[1]=0,E[2]=0),E[0]=1,E[3]=1,E}let _,w;const M={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(E,s,c){const g=requestAnimationFrame(A=>{x(),s(A)}),{unsubscribe:x}=o.s(E.signal,"abort",()=>{x(),cancelAnimationFrame(g),c(o.c())},!1)},frameAsync(E){return new Promise((s,c)=>{this.frame(E,s,c)})},getImageData(E,s=0){return this.getImageCanvasContext(E).getImageData(-s,-s,E.width+2*s,E.height+2*s)},getImageCanvasContext(E){const s=window.document.createElement("canvas"),c=s.getContext("2d",{willReadFrequently:!0});if(!c)throw new Error("failed to create canvas 2d context");return s.width=E.width,s.height=E.height,c.drawImage(E,0,0,E.width,E.height),c},resolveURL:E=>(_||(_=document.createElement("a")),_.href=E,_.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(w==null&&(w=matchMedia("(prefers-reduced-motion: reduce)")),w.matches)}};class C{static testProp(s){if(!C.docStyle)return s[0];for(let c=0;c<s.length;c++)if(s[c]in C.docStyle)return s[c];return s[0]}static create(s,c,g){const x=window.document.createElement(s);return c!==void 0&&(x.className=c),g&&g.appendChild(x),x}static createNS(s,c){return window.document.createElementNS(s,c)}static disableDrag(){C.docStyle&&C.selectProp&&(C.userSelect=C.docStyle[C.selectProp],C.docStyle[C.selectProp]="none")}static enableDrag(){C.docStyle&&C.selectProp&&(C.docStyle[C.selectProp]=C.userSelect)}static setTransform(s,c){s.style[C.transformProp]=c}static addEventListener(s,c,g,x={}){s.addEventListener(c,g,"passive"in x?x:x.capture)}static removeEventListener(s,c,g,x={}){s.removeEventListener(c,g,"passive"in x?x:x.capture)}static suppressClickInternal(s){s.preventDefault(),s.stopPropagation(),window.removeEventListener("click",C.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",C.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",C.suppressClickInternal,!0)},0)}static getScale(s){const c=s.getBoundingClientRect();return{x:c.width/s.offsetWidth||1,y:c.height/s.offsetHeight||1,boundingClientRect:c}}static getPoint(s,c,g){const x=c.boundingClientRect;return new o.P((g.clientX-x.left)/c.x-s.clientLeft,(g.clientY-x.top)/c.y-s.clientTop)}static mousePos(s,c){const g=C.getScale(s);return C.getPoint(s,g,c)}static touchPos(s,c){const g=[],x=C.getScale(s);for(let A=0;A<c.length;A++)g.push(C.getPoint(s,x,c[A]));return g}static mouseButton(s){return s.button}static remove(s){s.parentNode&&s.parentNode.removeChild(s)}static sanitize(s){const c=new DOMParser().parseFromString(s,"text/html").body||document.createElement("body"),g=c.querySelectorAll("script");for(const x of g)x.remove();return C.clean(c),c.innerHTML}static isPossiblyDangerous(s,c){const g=c.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(s)||!g.includes("javascript:")&&!g.includes("data:"))||!!s.startsWith("on")||void 0}static clean(s){const c=s.children;for(const g of c)C.removeAttributes(g),C.clean(g)}static removeAttributes(s){for(const{name:c,value:g}of s.attributes)C.isPossiblyDangerous(c,g)&&s.removeAttribute(c)}}C.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,C.selectProp=C.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),C.transformProp=C.testProp(["transform","WebkitTransform"]);const R={supported:!1,testSupport:function(E){!X&&W&&(Y?Q(E):z=E)}};let z,W,X=!1,Y=!1;function Q(E){const s=E.createTexture();E.bindTexture(E.TEXTURE_2D,s);try{if(E.texImage2D(E.TEXTURE_2D,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,W),E.isContextLost())return;R.supported=!0}catch{}E.deleteTexture(s),X=!0}var oe;typeof document<"u"&&(W=document.createElement("img"),W.onload=()=>{z&&Q(z),z=null,Y=!0},W.onerror=()=>{X=!0,z=null},W.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(E){let s,c,g,x;E.resetRequestQueue=()=>{s=[],c=0,g=0,x={}},E.addThrottleControl=Z=>{const re=g++;return x[re]=Z,re},E.removeThrottleControl=Z=>{delete x[Z],N()},E.getImage=(Z,re,fe=!0)=>new Promise((Me,ke)=>{R.supported&&(Z.headers||(Z.headers={}),Z.headers.accept="image/webp,*/*"),o.e(Z,{type:"image"}),s.push({abortController:re,requestParameters:Z,supportImageRefresh:fe,state:"queued",onError:Ke=>{ke(Ke)},onSuccess:Ke=>{Me(Ke)}}),N()});const A=Z=>o._(this,void 0,void 0,function*(){Z.state="running";const{requestParameters:re,supportImageRefresh:fe,onError:Me,onSuccess:ke,abortController:Ke}=Z,Qe=fe===!1&&!o.i(self)&&!o.g(re.url)&&(!re.headers||Object.keys(re.headers).reduce((At,Rt)=>At&&Rt==="accept",!0));c++;const Tt=Qe?$(re,Ke):o.m(re,Ke);try{const At=yield Tt;delete Z.abortController,Z.state="completed",At.data instanceof HTMLImageElement||o.b(At.data)?ke(At):At.data&&ke({data:yield(Ct=At.data,typeof createImageBitmap=="function"?o.f(Ct):o.h(Ct)),cacheControl:At.cacheControl,expires:At.expires})}catch(At){delete Z.abortController,Me(At)}finally{c--,N()}var Ct}),N=()=>{const Z=(()=>{for(const re of Object.keys(x))if(x[re]())return!0;return!1})()?o.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:o.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let re=c;re<Z&&s.length>0;re++){const fe=s.shift();fe.abortController.signal.aborted?re--:A(fe)}},$=(Z,re)=>new Promise((fe,Me)=>{const ke=new Image,Ke=Z.url,Qe=Z.credentials;Qe&&Qe==="include"?ke.crossOrigin="use-credentials":(Qe&&Qe==="same-origin"||!o.d(Ke))&&(ke.crossOrigin="anonymous"),re.signal.addEventListener("abort",()=>{ke.src="",Me(o.c())}),ke.fetchPriority="high",ke.onload=()=>{ke.onerror=ke.onload=null,fe({data:ke})},ke.onerror=()=>{ke.onerror=ke.onload=null,re.signal.aborted||Me(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},ke.src=Ke})}(oe||(oe={})),oe.resetRequestQueue();class le{constructor(s){this._transformRequestFn=s}transformRequest(s,c){return this._transformRequestFn&&this._transformRequestFn(s,c)||{url:s}}setTransformRequest(s){this._transformRequestFn=s}}function me(E){const s=[];if(typeof E=="string")s.push({id:"default",url:E});else if(E&&E.length>0){const c=[];for(const{id:g,url:x}of E){const A=`${g}${x}`;c.indexOf(A)===-1&&(c.push(A),s.push({id:g,url:x}))}}return s}function we(E,s,c){try{const g=new URL(E);return g.pathname+=`${s}${c}`,g.toString()}catch{throw new Error(`Invalid sprite URL "${E}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class ue{constructor(s,c,g,x){this.context=s,this.format=g,this.texture=s.gl.createTexture(),this.update(c,x)}update(s,c,g){const{width:x,height:A}=s,N=!(this.size&&this.size[0]===x&&this.size[1]===A||g),{context:$}=this,{gl:Z}=$;if(this.useMipmap=!!(c&&c.useMipmap),Z.bindTexture(Z.TEXTURE_2D,this.texture),$.pixelStoreUnpackFlipY.set(!1),$.pixelStoreUnpack.set(1),$.pixelStoreUnpackPremultiplyAlpha.set(this.format===Z.RGBA&&(!c||c.premultiply!==!1)),N)this.size=[x,A],s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||o.b(s)?Z.texImage2D(Z.TEXTURE_2D,0,this.format,this.format,Z.UNSIGNED_BYTE,s):Z.texImage2D(Z.TEXTURE_2D,0,this.format,x,A,0,this.format,Z.UNSIGNED_BYTE,s.data);else{const{x:re,y:fe}=g||{x:0,y:0};s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||o.b(s)?Z.texSubImage2D(Z.TEXTURE_2D,0,re,fe,Z.RGBA,Z.UNSIGNED_BYTE,s):Z.texSubImage2D(Z.TEXTURE_2D,0,re,fe,x,A,Z.RGBA,Z.UNSIGNED_BYTE,s.data)}this.useMipmap&&this.isSizePowerOfTwo()&&Z.generateMipmap(Z.TEXTURE_2D),$.pixelStoreUnpackFlipY.setDefault(),$.pixelStoreUnpack.setDefault(),$.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(s,c,g){const{context:x}=this,{gl:A}=x;A.bindTexture(A.TEXTURE_2D,this.texture),g!==A.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(g=A.LINEAR),s!==this.filter&&(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,s),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,g||s),this.filter=s),c!==this.wrap&&(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_S,c),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_T,c),this.wrap=c)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}function _e(E){const{userImage:s}=E;return!!(s&&s.render&&s.render())&&(E.data.replace(new Uint8Array(s.data.buffer)),!0)}class We extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(s){if(this.loaded!==s&&(this.loaded=s,s)){for(const{ids:c,promiseResolve:g}of this.requestors)g(this._getImagesForIds(c));this.requestors=[]}}getImage(s){const c=this.images[s];if(c&&!c.data&&c.spriteData){const g=c.spriteData;c.data=new o.R({width:g.width,height:g.height},g.context.getImageData(g.x,g.y,g.width,g.height).data),c.spriteData=null}return c}addImage(s,c){if(this.images[s])throw new Error(`Image id ${s} already exist, use updateImage instead`);this._validate(s,c)&&(this.images[s]=c)}_validate(s,c){let g=!0;const x=c.data||c.spriteData;return this._validateStretch(c.stretchX,x&&x.width)||(this.fire(new o.k(new Error(`Image "${s}" has invalid "stretchX" value`))),g=!1),this._validateStretch(c.stretchY,x&&x.height)||(this.fire(new o.k(new Error(`Image "${s}" has invalid "stretchY" value`))),g=!1),this._validateContent(c.content,c)||(this.fire(new o.k(new Error(`Image "${s}" has invalid "content" value`))),g=!1),g}_validateStretch(s,c){if(!s)return!0;let g=0;for(const x of s){if(x[0]<g||x[1]<x[0]||c<x[1])return!1;g=x[1]}return!0}_validateContent(s,c){if(!s)return!0;if(s.length!==4)return!1;const g=c.spriteData,x=g&&g.width||c.data.width,A=g&&g.height||c.data.height;return!(s[0]<0||x<s[0]||s[1]<0||A<s[1]||s[2]<0||x<s[2]||s[3]<0||A<s[3]||s[2]<s[0]||s[3]<s[1])}updateImage(s,c,g=!0){const x=this.getImage(s);if(g&&(x.data.width!==c.data.width||x.data.height!==c.data.height))throw new Error(`size mismatch between old image (${x.data.width}x${x.data.height}) and new image (${c.data.width}x${c.data.height}).`);c.version=x.version+1,this.images[s]=c,this.updatedImages[s]=!0}removeImage(s){const c=this.images[s];delete this.images[s],delete this.patterns[s],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(s){return new Promise((c,g)=>{let x=!0;if(!this.isLoaded())for(const A of s)this.images[A]||(x=!1);this.isLoaded()||x?c(this._getImagesForIds(s)):this.requestors.push({ids:s,promiseResolve:c})})}_getImagesForIds(s){const c={};for(const g of s){let x=this.getImage(g);x||(this.fire(new o.l("styleimagemissing",{id:g})),x=this.getImage(g)),x?c[g]={data:x.data.clone(),pixelRatio:x.pixelRatio,sdf:x.sdf,version:x.version,stretchX:x.stretchX,stretchY:x.stretchY,content:x.content,textFitWidth:x.textFitWidth,textFitHeight:x.textFitHeight,hasRenderCallback:!!(x.userImage&&x.userImage.render)}:o.w(`Image "${g}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return c}getPixelSize(){const{width:s,height:c}=this.atlasImage;return{width:s,height:c}}getPattern(s){const c=this.patterns[s],g=this.getImage(s);if(!g)return null;if(c&&c.position.version===g.version)return c.position;if(c)c.position.version=g.version;else{const x={w:g.data.width+2,h:g.data.height+2,x:0,y:0},A=new o.I(x,g);this.patterns[s]={bin:x,position:A}}return this._updatePatternAtlas(),this.patterns[s].position}bind(s){const c=s.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ue(s,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){const s=[];for(const A in this.patterns)s.push(this.patterns[A].bin);const{w:c,h:g}=o.p(s),x=this.atlasImage;x.resize({width:c||1,height:g||1});for(const A in this.patterns){const{bin:N}=this.patterns[A],$=N.x+1,Z=N.y+1,re=this.getImage(A).data,fe=re.width,Me=re.height;o.R.copy(re,x,{x:0,y:0},{x:$,y:Z},{width:fe,height:Me}),o.R.copy(re,x,{x:0,y:Me-1},{x:$,y:Z-1},{width:fe,height:1}),o.R.copy(re,x,{x:0,y:0},{x:$,y:Z+Me},{width:fe,height:1}),o.R.copy(re,x,{x:fe-1,y:0},{x:$-1,y:Z},{width:1,height:Me}),o.R.copy(re,x,{x:0,y:0},{x:$+fe,y:Z},{width:1,height:Me})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(s){for(const c of s){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;const g=this.getImage(c);g||o.w(`Image with ID: "${c}" was not found`),_e(g)&&this.updateImage(c,g)}}}const he=1e20;function de(E,s,c,g,x,A,N,$,Z){for(let re=s;re<s+g;re++)Te(E,c*A+re,A,x,N,$,Z);for(let re=c;re<c+x;re++)Te(E,re*A+s,1,g,N,$,Z)}function Te(E,s,c,g,x,A,N){A[0]=0,N[0]=-1e20,N[1]=he,x[0]=E[s];for(let $=1,Z=0,re=0;$<g;$++){x[$]=E[s+$*c];const fe=$*$;do{const Me=A[Z];re=(x[$]-x[Me]+fe-Me*Me)/($-Me)/2}while(re<=N[Z]&&--Z>-1);Z++,A[Z]=$,N[Z]=re,N[Z+1]=he}for(let $=0,Z=0;$<g;$++){for(;N[Z+1]<$;)Z++;const re=A[Z],fe=$-re;E[s+$*c]=x[re]+fe*fe}}class be{constructor(s,c){this.requestManager=s,this.localIdeographFontFamily=c,this.entries={}}setURL(s){this.url=s}getGlyphs(s){return o._(this,void 0,void 0,function*(){const c=[];for(const A in s)for(const N of s[A])c.push(this._getAndCacheGlyphsPromise(A,N));const g=yield Promise.all(c),x={};for(const{stack:A,id:N,glyph:$}of g)x[A]||(x[A]={}),x[A][N]=$&&{id:$.id,bitmap:$.bitmap.clone(),metrics:$.metrics};return x})}_getAndCacheGlyphsPromise(s,c){return o._(this,void 0,void 0,function*(){let g=this.entries[s];g||(g=this.entries[s]={glyphs:{},requests:{},ranges:{}});let x=g.glyphs[c];if(x!==void 0)return{stack:s,id:c,glyph:x};if(x=this._tinySDF(g,s,c),x)return g.glyphs[c]=x,{stack:s,id:c,glyph:x};const A=Math.floor(c/256);if(256*A>65535)throw new Error("glyphs > 65535 not supported");if(g.ranges[A])return{stack:s,id:c,glyph:x};if(!this.url)throw new Error("glyphsUrl is not set");if(!g.requests[A]){const $=be.loadGlyphRange(s,A,this.url,this.requestManager);g.requests[A]=$}const N=yield g.requests[A];for(const $ in N)this._doesCharSupportLocalGlyph(+$)||(g.glyphs[+$]=N[+$]);return g.ranges[A]=!0,{stack:s,id:c,glyph:N[c]||null}})}_doesCharSupportLocalGlyph(s){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(s))||o.u["CJK Unified Ideographs"](s)||o.u["Hangul Syllables"](s)||o.u.Hiragana(s)||o.u.Katakana(s)||o.u["CJK Symbols and Punctuation"](s)||o.u["Halfwidth and Fullwidth Forms"](s))}_tinySDF(s,c,g){const x=this.localIdeographFontFamily;if(!x||!this._doesCharSupportLocalGlyph(g))return;let A=s.tinySDF;if(!A){let $="400";/bold/i.test(c)?$="900":/medium/i.test(c)?$="500":/light/i.test(c)&&($="200"),A=s.tinySDF=new be.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:x,fontWeight:$})}const N=A.draw(String.fromCharCode(g));return{id:g,bitmap:new o.q({width:N.width||60,height:N.height||60},N.data),metrics:{width:N.glyphWidth/2||24,height:N.glyphHeight/2||24,left:N.glyphLeft/2+.5||0,top:N.glyphTop/2-27.5||-8,advance:N.glyphAdvance/2||24,isDoubleResolution:!0}}}}be.loadGlyphRange=function(E,s,c,g){return o._(this,void 0,void 0,function*(){const x=256*s,A=x+255,N=g.transformRequest(c.replace("{fontstack}",E).replace("{range}",`${x}-${A}`),"Glyphs"),$=yield o.n(N,new AbortController);if(!$||!$.data)throw new Error(`Could not load glyph range. range: ${s}, ${x}-${A}`);const Z={};for(const re of o.o($.data))Z[re.id]=re;return Z})},be.TinySDF=class{constructor({fontSize:E=24,buffer:s=3,radius:c=8,cutoff:g=.25,fontFamily:x="sans-serif",fontWeight:A="normal",fontStyle:N="normal"}={}){this.buffer=s,this.cutoff=g,this.radius=c;const $=this.size=E+4*s,Z=this._createCanvas($),re=this.ctx=Z.getContext("2d",{willReadFrequently:!0});re.font=`${N} ${A} ${E}px ${x}`,re.textBaseline="alphabetic",re.textAlign="left",re.fillStyle="black",this.gridOuter=new Float64Array($*$),this.gridInner=new Float64Array($*$),this.f=new Float64Array($),this.z=new Float64Array($+1),this.v=new Uint16Array($)}_createCanvas(E){const s=document.createElement("canvas");return s.width=s.height=E,s}draw(E){const{width:s,actualBoundingBoxAscent:c,actualBoundingBoxDescent:g,actualBoundingBoxLeft:x,actualBoundingBoxRight:A}=this.ctx.measureText(E),N=Math.ceil(c),$=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(A-x))),Z=Math.min(this.size-this.buffer,N+Math.ceil(g)),re=$+2*this.buffer,fe=Z+2*this.buffer,Me=Math.max(re*fe,0),ke=new Uint8ClampedArray(Me),Ke={data:ke,width:re,height:fe,glyphWidth:$,glyphHeight:Z,glyphTop:N,glyphLeft:0,glyphAdvance:s};if($===0||Z===0)return Ke;const{ctx:Qe,buffer:Tt,gridInner:Ct,gridOuter:At}=this;Qe.clearRect(Tt,Tt,$,Z),Qe.fillText(E,Tt,Tt+N);const Rt=Qe.getImageData(Tt,Tt,$,Z);At.fill(he,0,Me),Ct.fill(0,0,Me);for(let jt=0;jt<Z;jt++)for(let Vt=0;Vt<$;Vt++){const en=Rt.data[4*(jt*$+Vt)+3]/255;if(en===0)continue;const mn=(jt+Tt)*re+Vt+Tt;if(en===1)At[mn]=0,Ct[mn]=he;else{const on=.5-en;At[mn]=on>0?on*on:0,Ct[mn]=on<0?on*on:0}}de(At,0,0,re,fe,re,this.f,this.v,this.z),de(Ct,Tt,Tt,$,Z,re,this.f,this.v,this.z);for(let jt=0;jt<Me;jt++){const Vt=Math.sqrt(At[jt])-Math.sqrt(Ct[jt]);ke[jt]=Math.round(255-255*(Vt/this.radius+this.cutoff))}return Ke}};class ae{constructor(){this.specification=o.v.light.position}possiblyEvaluate(s,c){return o.z(s.expression.evaluate(c))}interpolate(s,c,g){return{x:o.B.number(s.x,c.x,g),y:o.B.number(s.y,c.y,g),z:o.B.number(s.z,c.z,g)}}}let ne;class Se extends o.E{constructor(s){super(),ne=ne||new o.r({anchor:new o.D(o.v.light.anchor),position:new ae,color:new o.D(o.v.light.color),intensity:new o.D(o.v.light.intensity)}),this._transitionable=new o.T(ne),this.setLight(s),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,c={}){if(!this._validate(o.t,s,c))for(const g in s){const x=s[g];g.endsWith("-transition")?this._transitionable.setTransition(g.slice(0,-11),x):this._transitionable.setValue(g,x)}}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,c,g){return(!g||g.validate!==!1)&&o.x(this,s.call(o.y,{value:c,style:{glyphs:!0,sprite:!0},styleSpec:o.v}))}}const Le=new o.r({"sky-color":new o.D(o.v.sky["sky-color"]),"horizon-color":new o.D(o.v.sky["horizon-color"]),"fog-color":new o.D(o.v.sky["fog-color"]),"fog-ground-blend":new o.D(o.v.sky["fog-ground-blend"]),"horizon-fog-blend":new o.D(o.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new o.D(o.v.sky["sky-horizon-blend"]),"atmosphere-blend":new o.D(o.v.sky["atmosphere-blend"])});class ze extends o.E{constructor(s){super(),this._transitionable=new o.T(Le),this.setSky(s),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.C(0))}setSky(s,c={}){if(!this._validate(o.F,s,c)){s||(s={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const g in s){const x=s[g];g.endsWith("-transition")?this._transitionable.setTransition(g.slice(0,-11),x):this._transitionable.setValue(g,x)}}}getSky(){return this._transitionable.serialize()}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,c,g={}){return(g==null?void 0:g.validate)!==!1&&o.x(this,s.call(o.y,o.e({value:c,style:{glyphs:!0,sprite:!0},styleSpec:o.v})))}calculateFogBlendOpacity(s){return s<60?0:s<70?(s-60)/10:1}}class He{constructor(s,c){this.width=s,this.height=c,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(s,c){const g=s.join(",")+String(c);return this.dashEntry[g]||(this.dashEntry[g]=this.addDash(s,c)),this.dashEntry[g]}getDashRanges(s,c,g){const x=[];let A=s.length%2==1?-s[s.length-1]*g:0,N=s[0]*g,$=!0;x.push({left:A,right:N,isDash:$,zeroLength:s[0]===0});let Z=s[0];for(let re=1;re<s.length;re++){$=!$;const fe=s[re];A=Z*g,Z+=fe,N=Z*g,x.push({left:A,right:N,isDash:$,zeroLength:fe===0})}return x}addRoundDash(s,c,g){const x=c/2;for(let A=-g;A<=g;A++){const N=this.width*(this.nextRow+g+A);let $=0,Z=s[$];for(let re=0;re<this.width;re++){re/Z.right>1&&(Z=s[++$]);const fe=Math.abs(re-Z.left),Me=Math.abs(re-Z.right),ke=Math.min(fe,Me);let Ke;const Qe=A/g*(x+1);if(Z.isDash){const Tt=x-Math.abs(Qe);Ke=Math.sqrt(ke*ke+Tt*Tt)}else Ke=x-Math.sqrt(ke*ke+Qe*Qe);this.data[N+re]=Math.max(0,Math.min(255,Ke+128))}}}addRegularDash(s){for(let $=s.length-1;$>=0;--$){const Z=s[$],re=s[$+1];Z.zeroLength?s.splice($,1):re&&re.isDash===Z.isDash&&(re.left=Z.left,s.splice($,1))}const c=s[0],g=s[s.length-1];c.isDash===g.isDash&&(c.left=g.left-this.width,g.right=c.right+this.width);const x=this.width*this.nextRow;let A=0,N=s[A];for(let $=0;$<this.width;$++){$/N.right>1&&(N=s[++A]);const Z=Math.abs($-N.left),re=Math.abs($-N.right),fe=Math.min(Z,re);this.data[x+$]=Math.max(0,Math.min(255,(N.isDash?fe:-fe)+128))}}addDash(s,c){const g=c?7:0,x=2*g+1;if(this.nextRow+x>this.height)return o.w("LineAtlas out of space"),null;let A=0;for(let $=0;$<s.length;$++)A+=s[$];if(A!==0){const $=this.width/A,Z=this.getDashRanges(s,this.width,$);c?this.addRoundDash(Z,$,g):this.addRegularDash(Z)}const N={y:(this.nextRow+g+.5)/this.height,height:2*g/this.height,width:A};return this.nextRow+=x,this.dirty=!0,N}bind(s){const c=s.gl;this.texture?(c.bindTexture(c.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,c.texSubImage2D(c.TEXTURE_2D,0,0,0,this.width,this.height,c.ALPHA,c.UNSIGNED_BYTE,this.data))):(this.texture=c.createTexture(),c.bindTexture(c.TEXTURE_2D,this.texture),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.REPEAT),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.REPEAT),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR),c.texImage2D(c.TEXTURE_2D,0,c.ALPHA,this.width,this.height,0,c.ALPHA,c.UNSIGNED_BYTE,this.data))}}const pt="maplibre_preloaded_worker_pool";class ge{constructor(){this.active={}}acquire(s){if(!this.workers)for(this.workers=[];this.workers.length<ge.workerCount;)this.workers.push(new Worker(o.a.WORKER_URL));return this.active[s]=!0,this.workers.slice()}release(s){delete this.active[s],this.numActive()===0&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[pt]}numActive(){return Object.keys(this.active).length}}const Ie=Math.floor(M.hardwareConcurrency/2);let Ne,Ve;function it(){return Ne||(Ne=new ge),Ne}ge.workerCount=o.G(globalThis)?Math.max(Math.min(Ie,3),1):1;class lt{constructor(s,c){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=c;const g=this.workerPool.acquire(c);for(let x=0;x<g.length;x++){const A=new o.H(g[x],c);A.name=`Worker ${x}`,this.actors.push(A)}if(!this.actors.length)throw new Error("No actors found")}broadcast(s,c){const g=[];for(const x of this.actors)g.push(x.sendAsync({type:s,data:c}));return Promise.all(g)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(s=!0){this.actors.forEach(c=>{c.remove()}),this.actors=[],s&&this.workerPool.release(this.id)}registerMessageHandler(s,c){for(const g of this.actors)g.registerMessageHandler(s,c)}}function Mt(){return Ve||(Ve=new lt(it(),o.J),Ve.registerMessageHandler("GR",(E,s,c)=>o.m(s,c))),Ve}function wt(E,s){const c=o.K();return o.L(c,c,[1,1,0]),o.M(c,c,[.5*E.width,.5*E.height,1]),E.calculatePosMatrix?o.N(c,c,E.calculatePosMatrix(s.toUnwrapped())):c}function rn(E,s,c,g,x,A,N){var $;const Z=function(ke,Ke,Qe){if(ke)for(const Tt of ke){const Ct=Ke[Tt];if(Ct&&Ct.source===Qe&&Ct.type==="fill-extrusion")return!0}else for(const Tt in Ke){const Ct=Ke[Tt];if(Ct.source===Qe&&Ct.type==="fill-extrusion")return!0}return!1}(($=x==null?void 0:x.layers)!==null&&$!==void 0?$:null,s,E.id),re=A.maxPitchScaleFactor(),fe=E.tilesIn(g,re,Z);fe.sort(yn);const Me=[];for(const ke of fe)Me.push({wrappedTileID:ke.tileID.wrapped().key,queryResults:ke.tile.queryRenderedFeatures(s,c,E._state,ke.queryGeometry,ke.cameraQueryGeometry,ke.scale,x,A,re,wt(E.transform,ke.tileID),N?(Ke,Qe)=>N(ke.tileID,Ke,Qe):void 0)});return function(ke,Ke){for(const Qe in ke)for(const Tt of ke[Qe])Pn(Tt,Ke);return ke}(function(ke){const Ke={},Qe={};for(const Tt of ke){const Ct=Tt.queryResults,At=Tt.wrappedTileID,Rt=Qe[At]=Qe[At]||{};for(const jt in Ct){const Vt=Ct[jt],en=Rt[jt]=Rt[jt]||{},mn=Ke[jt]=Ke[jt]||[];for(const on of Vt)en[on.featureIndex]||(en[on.featureIndex]=!0,mn.push(on))}}return Ke}(Me),E)}function yn(E,s){const c=E.tileID,g=s.tileID;return c.overscaledZ-g.overscaledZ||c.canonical.y-g.canonical.y||c.wrap-g.wrap||c.canonical.x-g.canonical.x}function Pn(E,s){const c=E.feature,g=s.getFeatureState(c.layer["source-layer"],c.id);c.source=c.layer.source,c.layer["source-layer"]&&(c.sourceLayer=c.layer["source-layer"]),c.state=g}function De(E,s,c){return o._(this,void 0,void 0,function*(){let g=E;if(E.url?g=(yield o.j(s.transformRequest(E.url,"Source"),c)).data:yield M.frameAsync(c),!g)return null;const x=o.O(o.e(g,E),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in g&&g.vector_layers&&(x.vectorLayerIds=g.vector_layers.map(A=>A.id)),x})}class Ae{constructor(s,c){s&&(c?this.setSouthWest(s).setNorthEast(c):Array.isArray(s)&&(s.length===4?this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]]):this.setSouthWest(s[0]).setNorthEast(s[1])))}setNorthEast(s){return this._ne=s instanceof o.Q?new o.Q(s.lng,s.lat):o.Q.convert(s),this}setSouthWest(s){return this._sw=s instanceof o.Q?new o.Q(s.lng,s.lat):o.Q.convert(s),this}extend(s){const c=this._sw,g=this._ne;let x,A;if(s instanceof o.Q)x=s,A=s;else{if(!(s instanceof Ae))return Array.isArray(s)?s.length===4||s.every(Array.isArray)?this.extend(Ae.convert(s)):this.extend(o.Q.convert(s)):s&&("lng"in s||"lon"in s)&&"lat"in s?this.extend(o.Q.convert(s)):this;if(x=s._sw,A=s._ne,!x||!A)return this}return c||g?(c.lng=Math.min(x.lng,c.lng),c.lat=Math.min(x.lat,c.lat),g.lng=Math.max(A.lng,g.lng),g.lat=Math.max(A.lat,g.lat)):(this._sw=new o.Q(x.lng,x.lat),this._ne=new o.Q(A.lng,A.lat)),this}getCenter(){return new o.Q((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new o.Q(this.getWest(),this.getNorth())}getSouthEast(){return new o.Q(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){const{lng:c,lat:g}=o.Q.convert(s);let x=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(x=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=g&&g<=this._ne.lat&&x}static convert(s){return s instanceof Ae?s:s&&new Ae(s)}static fromLngLat(s,c=0){const g=360*c/40075017,x=g/Math.cos(Math.PI/180*s.lat);return new Ae(new o.Q(s.lng-x,s.lat-g),new o.Q(s.lng+x,s.lat+g))}adjustAntiMeridian(){const s=new o.Q(this._sw.lng,this._sw.lat),c=new o.Q(this._ne.lng,this._ne.lat);return new Ae(s,s.lng>c.lng?new o.Q(c.lng+360,c.lat):c)}}class Be{constructor(s,c,g){this.bounds=Ae.convert(this.validateBounds(s)),this.minzoom=c||0,this.maxzoom=g||24}validateBounds(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}contains(s){const c=Math.pow(2,s.z),g=Math.floor(o.U(this.bounds.getWest())*c),x=Math.floor(o.S(this.bounds.getNorth())*c),A=Math.ceil(o.U(this.bounds.getEast())*c),N=Math.ceil(o.S(this.bounds.getSouth())*c);return s.x>=g&&s.x<A&&s.y>=x&&s.y<N}}class Ce extends o.E{constructor(s,c,g,x){if(super(),this.id=s,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.O(c,["url","scheme","tileSize","promoteId"])),this._options=o.e({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x)}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const s=yield De(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),s&&(o.e(this,s),s.bounds&&(this.tileBounds=new Be(s.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})))}catch(s){this._tileJSONRequest=null,this.fire(new o.k(s))}})}loaded(){return this._loaded}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}onAdd(s){this.map=s,this.load()}setSourceProperty(s){this._tileJSONRequest&&this._tileJSONRequest.abort(),s(),this.load()}setTiles(s){return this.setSourceProperty(()=>{this._options.tiles=s}),this}setUrl(s){return this.setSourceProperty(()=>{this.url=s,this._options.url=s}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return o.e({},this._options)}loadTile(s){return o._(this,void 0,void 0,function*(){const c=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),g={request:this.map._requestManager.transformRequest(c,"Tile"),uid:s.uid,tileID:s.tileID,zoom:s.tileID.overscaledZ,tileSize:this.tileSize*s.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};g.request.collectResourceTiming=this._collectResourceTiming;let x="RT";if(s.actor&&s.state!=="expired"){if(s.state==="loading")return new Promise((A,N)=>{s.reloadPromise={resolve:A,reject:N}})}else s.actor=this.dispatcher.getActor(),x="LT";s.abortController=new AbortController;try{const A=yield s.actor.sendAsync({type:x,data:g},s.abortController);if(delete s.abortController,s.aborted)return;this._afterTileLoadWorkerResponse(s,A)}catch(A){if(delete s.abortController,s.aborted)return;if(A&&A.status!==404)throw A;this._afterTileLoadWorkerResponse(s,null)}})}_afterTileLoadWorkerResponse(s,c){if(c&&c.resourceTiming&&(s.resourceTiming=c.resourceTiming),c&&this.map._refreshExpiredTiles&&s.setExpiryData(c),s.loadVectorData(c,this.map.painter),s.reloadPromise){const g=s.reloadPromise;s.reloadPromise=null,this.loadTile(s).then(g.resolve).catch(g.reject)}}abortTile(s){return o._(this,void 0,void 0,function*(){s.abortController&&(s.abortController.abort(),delete s.abortController),s.actor&&(yield s.actor.sendAsync({type:"AT",data:{uid:s.uid,type:this.type,source:this.id}}))})}unloadTile(s){return o._(this,void 0,void 0,function*(){s.unloadVectorData(),s.actor&&(yield s.actor.sendAsync({type:"RMT",data:{uid:s.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class ot extends o.E{constructor(s,c,g,x){super(),this.id=s,this.dispatcher=g,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.e({type:"raster"},c),o.e(this,o.O(c,["url","scheme","tileSize"]))}load(){return o._(this,arguments,void 0,function*(s=!1){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const c=yield De(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,c&&(o.e(this,c),c.bounds&&(this.tileBounds=new Be(c.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:s})))}catch(c){this._tileJSONRequest=null,this.fire(new o.k(c))}})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(s){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),s(),this.load(!0)}setTiles(s){return this.setSourceProperty(()=>{this._options.tiles=s}),this}setUrl(s){return this.setSourceProperty(()=>{this.url=s,this._options.url=s}),this}serialize(){return o.e({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s){return o._(this,void 0,void 0,function*(){const c=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);s.abortController=new AbortController;try{const g=yield oe.getImage(this.map._requestManager.transformRequest(c,"Tile"),s.abortController,this.map._refreshExpiredTiles);if(delete s.abortController,s.aborted)return void(s.state="unloaded");if(g&&g.data){this.map._refreshExpiredTiles&&g.cacheControl&&g.expires&&s.setExpiryData({cacheControl:g.cacheControl,expires:g.expires});const x=this.map.painter.context,A=x.gl,N=g.data;s.texture=this.map.painter.getTileTexture(N.width),s.texture?s.texture.update(N,{useMipmap:!0}):(s.texture=new ue(x,N,A.RGBA,{useMipmap:!0}),s.texture.bind(A.LINEAR,A.CLAMP_TO_EDGE,A.LINEAR_MIPMAP_NEAREST)),s.state="loaded"}}catch(g){if(delete s.abortController,s.aborted)s.state="unloaded";else if(g)throw s.state="errored",g}})}abortTile(s){return o._(this,void 0,void 0,function*(){s.abortController&&(s.abortController.abort(),delete s.abortController)})}unloadTile(s){return o._(this,void 0,void 0,function*(){s.texture&&this.map.painter.saveTileTexture(s.texture)})}hasTransition(){return!1}}class Dt extends ot{constructor(s,c,g,x){super(s,c,g,x),this.type="raster-dem",this.maxzoom=22,this._options=o.e({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox",this.redFactor=c.redFactor,this.greenFactor=c.greenFactor,this.blueFactor=c.blueFactor,this.baseShift=c.baseShift}loadTile(s){return o._(this,void 0,void 0,function*(){const c=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),g=this.map._requestManager.transformRequest(c,"Tile");s.neighboringTiles=this._getNeighboringTiles(s.tileID),s.abortController=new AbortController;try{const x=yield oe.getImage(g,s.abortController,this.map._refreshExpiredTiles);if(delete s.abortController,s.aborted)return void(s.state="unloaded");if(x&&x.data){const A=x.data;this.map._refreshExpiredTiles&&x.cacheControl&&x.expires&&s.setExpiryData({cacheControl:x.cacheControl,expires:x.expires});const N=o.b(A)&&o.V()?A:yield this.readImageNow(A),$={type:this.type,uid:s.uid,source:this.id,rawImageData:N,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!s.actor||s.state==="expired"){s.actor=this.dispatcher.getActor();const Z=yield s.actor.sendAsync({type:"LDT",data:$});s.dem=Z,s.needsHillshadePrepare=!0,s.needsTerrainPrepare=!0,s.state="loaded"}}}catch(x){if(delete s.abortController,s.aborted)s.state="unloaded";else if(x)throw s.state="errored",x}})}readImageNow(s){return o._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&o.W()){const c=s.width+2,g=s.height+2;try{return new o.R({width:c,height:g},yield o.X(s,-1,-1,c,g))}catch{}}return M.getImageData(s,1)})}_getNeighboringTiles(s){const c=s.canonical,g=Math.pow(2,c.z),x=(c.x-1+g)%g,A=c.x===0?s.wrap-1:s.wrap,N=(c.x+1+g)%g,$=c.x+1===g?s.wrap+1:s.wrap,Z={};return Z[new o.Y(s.overscaledZ,A,c.z,x,c.y).key]={backfilled:!1},Z[new o.Y(s.overscaledZ,$,c.z,N,c.y).key]={backfilled:!1},c.y>0&&(Z[new o.Y(s.overscaledZ,A,c.z,x,c.y-1).key]={backfilled:!1},Z[new o.Y(s.overscaledZ,s.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},Z[new o.Y(s.overscaledZ,$,c.z,N,c.y-1).key]={backfilled:!1}),c.y+1<g&&(Z[new o.Y(s.overscaledZ,A,c.z,x,c.y+1).key]={backfilled:!1},Z[new o.Y(s.overscaledZ,s.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},Z[new o.Y(s.overscaledZ,$,c.z,N,c.y+1).key]={backfilled:!1}),Z}unloadTile(s){return o._(this,void 0,void 0,function*(){s.demTexture&&this.map.painter.saveTileTexture(s.demTexture),s.fbo&&(s.fbo.destroy(),delete s.fbo),s.dem&&delete s.dem,delete s.neighboringTiles,s.state="unloaded",s.actor&&(yield s.actor.sendAsync({type:"RDT",data:{type:this.type,uid:s.uid,source:this.id}}))})}}class Zt extends o.E{constructor(s,c,g,x){super(),this.id=s,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=g.getActor(),this.setEventedParent(x),this._data=c.data,this._options=o.e({},c),this._collectResourceTiming=c.collectResourceTiming,c.maxzoom!==void 0&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId,c.clusterMaxZoom!==void 0&&this.maxzoom<=c.clusterMaxZoom&&o.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${c.clusterMaxZoom}".`),this.workerOptions=o.e({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(c.buffer!==void 0?c.buffer:128),tolerance:this._pixelsToTileUnits(c.tolerance!==void 0?c.tolerance:.375),extent:o.Z,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:c.clusterMaxZoom!==void 0?c.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:o.Z,radius:this._pixelsToTileUnits(c.clusterRadius||50),log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(s){return s*(o.Z/this.tileSize)}load(){return o._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(s){this.map=s,this.load()}setData(s){return this._data=s,this._updateWorkerData(),this}updateData(s){return this._updateWorkerData(s),this}getData(){return o._(this,void 0,void 0,function*(){const s=o.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:s})})}getCoordinatesFromGeometry(s){return s.type==="GeometryCollection"?s.geometries.map(c=>c.coordinates).flat(1/0):s.coordinates.flat(1/0)}getBounds(){return o._(this,void 0,void 0,function*(){const s=new Ae,c=yield this.getData();let g;switch(c.type){case"FeatureCollection":g=c.features.map(x=>this.getCoordinatesFromGeometry(x.geometry)).flat(1/0);break;case"Feature":g=this.getCoordinatesFromGeometry(c.geometry);break;default:g=this.getCoordinatesFromGeometry(c)}if(g.length==0)return s;for(let x=0;x<g.length-1;x+=2)s.extend([g[x],g[x+1]]);return s})}setClusterOptions(s){return this.workerOptions.cluster=s.cluster,s&&(s.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(s.clusterRadius)),s.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=s.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(s){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:s,source:this.id}})}getClusterChildren(s){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:s,source:this.id}})}getClusterLeaves(s,c,g){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:s,limit:c,offset:g}})}_updateWorkerData(s){return o._(this,void 0,void 0,function*(){const c=o.e({type:this.type},this.workerOptions);s?c.dataDiff=s:typeof this._data=="string"?(c.request=this.map._requestManager.transformRequest(M.resolveURL(this._data),"Source"),c.request.collectResourceTiming=this._collectResourceTiming):c.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new o.l("dataloading",{dataType:"source"}));try{const g=yield this.actor.sendAsync({type:"LD",data:c});if(this._pendingLoads--,this._removed||g.abandoned)return void this.fire(new o.l("dataabort",{dataType:"source"}));let x=null;g.resourceTiming&&g.resourceTiming[this.id]&&(x=g.resourceTiming[this.id].slice(0));const A={dataType:"source"};this._collectResourceTiming&&x&&x.length>0&&o.e(A,{resourceTiming:x}),this.fire(new o.l("data",Object.assign(Object.assign({},A),{sourceDataType:"metadata"}))),this.fire(new o.l("data",Object.assign(Object.assign({},A),{sourceDataType:"content"})))}catch(g){if(this._pendingLoads--,this._removed)return void this.fire(new o.l("dataabort",{dataType:"source"}));this.fire(new o.k(g))}})}loaded(){return this._pendingLoads===0}loadTile(s){return o._(this,void 0,void 0,function*(){const c=s.actor?"RT":"LT";s.actor=this.actor;const g={type:this.type,uid:s.uid,tileID:s.tileID,zoom:s.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};s.abortController=new AbortController;const x=yield this.actor.sendAsync({type:c,data:g},s.abortController);delete s.abortController,s.unloadVectorData(),s.aborted||s.loadVectorData(x,this.map.painter,c==="RT")})}abortTile(s){return o._(this,void 0,void 0,function*(){s.abortController&&(s.abortController.abort(),delete s.abortController),s.aborted=!0})}unloadTile(s){return o._(this,void 0,void 0,function*(){s.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:s.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return o.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class an extends o.E{constructor(s,c,g,x){super(),this.flippedWindingOrder=!1,this.id=s,this.dispatcher=g,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(x),this.options=c}load(s){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const c=yield oe.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,c&&c.data&&(this.image=c.data,s&&(this.coordinates=s),this._finishLoading())}catch(c){this._request=null,this._loaded=!0,this.fire(new o.k(c))}})}loaded(){return this._loaded}updateImage(s){return s.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=s.url,this.load(s.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(s){this.map=s,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(s){this.coordinates=s;const c=s.map(o.$.fromLngLat);var g;return this.tileID=function(x){let A=1/0,N=1/0,$=-1/0,Z=-1/0;for(const ke of x)A=Math.min(A,ke.x),N=Math.min(N,ke.y),$=Math.max($,ke.x),Z=Math.max(Z,ke.y);const re=Math.max($-A,Z-N),fe=Math.max(0,Math.floor(-Math.log(re)/Math.LN2)),Me=Math.pow(2,fe);return new o.a1(fe,Math.floor((A+$)/2*Me),Math.floor((N+Z)/2*Me))}(c),this.terrainTileRanges=this._getOverlappingTileRanges(c),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=c.map(x=>this.tileID.getTilePoint(x)._round()),this.flippedWindingOrder=((g=this.tileCoords)[1].x-g[0].x)*(g[2].y-g[0].y)-(g[1].y-g[0].y)*(g[2].x-g[0].x)<0,this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const s=this.map.painter.context,c=s.gl;this.texture||(this.texture=new ue(s,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE));let g=!1;for(const x in this.tiles){const A=this.tiles[x];A.state!=="loaded"&&(A.state="loaded",A.texture=this.texture,g=!0)}g&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(s){return o._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(s.tileID.canonical)?(this.tiles[String(s.tileID.wrap)]=s,s.buckets={}):s.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(s){let c=1/0,g=1/0,x=-1/0,A=-1/0;for(const $ of s)c=Math.min(c,$.x),g=Math.min(g,$.y),x=Math.max(x,$.x),A=Math.max(A,$.y);const N={};for(let $=0;$<=o.a0;$++){const Z=Math.pow(2,$),re=Math.floor(c*Z),fe=Math.floor(g*Z),Me=Math.floor(x*Z),ke=Math.floor(A*Z);N[$]={minTileX:re,minTileY:fe,maxTileX:Me,maxTileY:ke}}return N}}class ln extends an{constructor(s,c,g,x){super(s,c,g,x),this.roundZoom=!0,this.type="video",this.options=c}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1;const s=this.options;this.urls=[];for(const c of s.urls)this.urls.push(this.map._requestManager.transformRequest(c,"Source").url);try{const c=yield o.a2(this.urls);if(this._loaded=!0,!c)return;this.video=c,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(c){this.fire(new o.k(c))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(s){if(this.video){const c=this.video.seekable;s<c.start(0)||s>c.end(0)?this.fire(new o.k(new o.a3(`sources.${this.id}`,null,`Playback for this video can be set only between the ${c.start(0)} and ${c.end(0)}-second mark.`))):this.video.currentTime=s}}getVideo(){return this.video}onAdd(s){this.map||(this.map=s,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const s=this.map.painter.context,c=s.gl;this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new ue(s,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE));let g=!1;for(const x in this.tiles){const A=this.tiles[x];A.state!=="loaded"&&(A.state="loaded",A.texture=this.texture,g=!0)}g&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class vn extends an{constructor(s,c,g,x){super(s,c,g,x),c.coordinates?Array.isArray(c.coordinates)&&c.coordinates.length===4&&!c.coordinates.some(A=>!Array.isArray(A)||A.length!==2||A.some(N=>typeof N!="number"))||this.fire(new o.k(new o.a3(`sources.${s}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.k(new o.a3(`sources.${s}`,null,'missing required property "coordinates"'))),c.animate&&typeof c.animate!="boolean"&&this.fire(new o.k(new o.a3(`sources.${s}`,null,'optional "animate" property must be a boolean value'))),c.canvas?typeof c.canvas=="string"||c.canvas instanceof HTMLCanvasElement||this.fire(new o.k(new o.a3(`sources.${s}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.k(new o.a3(`sources.${s}`,null,'missing required property "canvas"'))),this.options=c,this.animate=c.animate===void 0||c.animate}load(){return o._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(s){this.map=s,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let s=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,s=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,s=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const c=this.map.painter.context,g=c.gl;this.texture?(s||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ue(c,this.canvas,g.RGBA,{premultiply:!0});let x=!1;for(const A in this.tiles){const N=this.tiles[A];N.state!=="loaded"&&(N.state="loaded",N.texture=this.texture,x=!0)}x&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const s of[this.canvas.width,this.canvas.height])if(isNaN(s)||s<=0)return!0;return!1}}const qn={},Kn=E=>{switch(E){case"geojson":return Zt;case"image":return an;case"raster":return ot;case"raster-dem":return Dt;case"vector":return Ce;case"video":return ln;case"canvas":return vn}return qn[E]},cr="RTLPluginLoaded";class pr extends o.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Mt()}_syncState(s){return this.status=s,this.dispatcher.broadcast("SRPS",{pluginStatus:s,pluginURL:this.url}).catch(c=>{throw this.status="error",c})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(s){return o._(this,arguments,void 0,function*(c,g=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=M.resolveURL(c),!this.url)throw new Error(`requested url ${c} is invalid`);if(this.status==="unavailable"){if(!g)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return o._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new o.l(cr))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Dr=null;function zr(){return Dr||(Dr=new pr),Dr}class Ht{constructor(s,c){this.timeAdded=0,this.fadeEndTime=0,this.tileID=s,this.uid=o.a4(),this.uses=0,this.tileSize=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(s){const c=s+this.timeAdded;c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(s){this.demTexture&&s.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(s,c,g){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=function(x,A){const N={};if(!A)return N;for(const $ of x){const Z=$.layerIds.map(re=>A.getLayer(re)).filter(Boolean);if(Z.length!==0){$.layers=Z,$.stateDependentLayerIds&&($.stateDependentLayers=$.stateDependentLayerIds.map(re=>Z.filter(fe=>fe.id===re)[0]));for(const re of Z)N[re.id]=$}}return N}(s.buckets,c==null?void 0:c.style),this.hasSymbolBuckets=!1;for(const x in this.buckets){const A=this.buckets[x];if(A instanceof o.a6){if(this.hasSymbolBuckets=!0,!g)break;A.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const x in this.buckets){const A=this.buckets[x];if(A instanceof o.a6&&A.hasRTLText){this.hasRTLText=!0,zr().lazyLoad();break}}this.queryPadding=0;for(const x in this.buckets){const A=this.buckets[x];this.queryPadding=Math.max(this.queryPadding,c.style.getLayer(x).queryRadius(A))}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage)}else this.collisionBoxArray=new o.a5}unloadVectorData(){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(s){return this.buckets[s.id]}upload(s){for(const g in this.buckets){const x=this.buckets[g];x.uploadPending()&&x.upload(s)}const c=s.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ue(s,this.imageAtlas.image,c.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ue(s,this.glyphAtlasImage,c.ALPHA),this.glyphAtlasImage=null)}prepare(s){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture)}queryRenderedFeatures(s,c,g,x,A,N,$,Z,re,fe,Me){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:x,cameraQueryGeometry:A,scale:N,tileSize:this.tileSize,pixelPosMatrix:fe,transform:Z,params:$,queryPadding:this.queryPadding*re,getElevation:Me},s,c,g):{}}querySourceFeatures(s,c){const g=this.latestFeatureIndex;if(!g||!g.rawTileData)return;const x=g.loadVTLayers(),A=c&&c.sourceLayer?c.sourceLayer:"",N=x._geojsonTileLayer||x[A];if(!N)return;const $=o.a7(c&&c.filter),{z:Z,x:re,y:fe}=this.tileID.canonical,Me={z:Z,x:re,y:fe};for(let ke=0;ke<N.length;ke++){const Ke=N.feature(ke);if($.needGeometry){const Ct=o.a8(Ke,!0);if(!$.filter(new o.C(this.tileID.overscaledZ),Ct,this.tileID.canonical))continue}else if(!$.filter(new o.C(this.tileID.overscaledZ),Ke))continue;const Qe=g.getId(Ke,A),Tt=new o.a9(Ke,Z,re,fe,Qe);Tt.tile=Me,s.push(Tt)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(s){const c=this.expirationTime;if(s.cacheControl){const g=o.aa(s.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const g=Date.now();let x=!1;if(this.expirationTime>g)x=!1;else if(c)if(this.expirationTime<c)x=!0;else{const A=this.expirationTime-c;A?this.expirationTime=g+Math.max(A,3e4):x=!0}else x=!0;x?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(s,c){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(s).length===0)return;const g=this.latestFeatureIndex.loadVTLayers();for(const x in this.buckets){if(!c.style.hasLayer(x))continue;const A=this.buckets[x],N=A.layers[0].sourceLayer||"_geojsonTileLayer",$=g[N],Z=s[N];if(!$||!Z||Object.keys(Z).length===0)continue;A.update(Z,$,this.imageAtlas&&this.imageAtlas.patternPositions||{});const re=c&&c.style&&c.style.getLayer(x);re&&(this.queryPadding=Math.max(this.queryPadding,re.queryRadius(A)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<M.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=M.now()+s}setDependencies(s,c){const g={};for(const x of c)g[x]=!0;this.dependencies[s]=g}hasDependency(s,c){for(const g of s){const x=this.dependencies[g];if(x){for(const A of c)if(x[A])return!0}}return!1}}class tn{constructor(s,c){this.max=s,this.onRemove=c,this.reset()}reset(){for(const s in this.data)for(const c of this.data[s])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(s,c,g){const x=s.wrapped().key;this.data[x]===void 0&&(this.data[x]=[]);const A={value:c,timeout:void 0};if(g!==void 0&&(A.timeout=setTimeout(()=>{this.remove(s,A)},g)),this.data[x].push(A),this.order.push(x),this.order.length>this.max){const N=this._getAndRemoveByKey(this.order[0]);N&&this.onRemove(N)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const c=this.data[s].shift();return c.timeout&&clearTimeout(c.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),c.value}getByKey(s){const c=this.data[s];return c?c[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,c){if(!this.has(s))return this;const g=s.wrapped().key,x=c===void 0?0:this.data[g].indexOf(c),A=this.data[g][x];return this.data[g].splice(x,1),A.timeout&&clearTimeout(A.timeout),this.data[g].length===0&&delete this.data[g],this.onRemove(A.value),this.order.splice(this.order.indexOf(g),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(s){const c=[];for(const g in this.data)for(const x of this.data[g])s(x.value)||c.push(x);for(const g of c)this.remove(g.value.tileID,g)}}class Kt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,c,g){const x=String(c);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][x]=this.stateChanges[s][x]||{},o.e(this.stateChanges[s][x],g),this.deletedStates[s]===null){this.deletedStates[s]={};for(const A in this.state[s])A!==x&&(this.deletedStates[s][A]=null)}else if(this.deletedStates[s]&&this.deletedStates[s][x]===null){this.deletedStates[s][x]={};for(const A in this.state[s][x])g[A]||(this.deletedStates[s][x][A]=null)}else for(const A in g)this.deletedStates[s]&&this.deletedStates[s][x]&&this.deletedStates[s][x][A]===null&&delete this.deletedStates[s][x][A]}removeFeatureState(s,c,g){if(this.deletedStates[s]===null)return;const x=String(c);if(this.deletedStates[s]=this.deletedStates[s]||{},g&&c!==void 0)this.deletedStates[s][x]!==null&&(this.deletedStates[s][x]=this.deletedStates[s][x]||{},this.deletedStates[s][x][g]=null);else if(c!==void 0)if(this.stateChanges[s]&&this.stateChanges[s][x])for(g in this.deletedStates[s][x]={},this.stateChanges[s][x])this.deletedStates[s][x][g]=null;else this.deletedStates[s][x]=null;else this.deletedStates[s]=null}getState(s,c){const g=String(c),x=o.e({},(this.state[s]||{})[g],(this.stateChanges[s]||{})[g]);if(this.deletedStates[s]===null)return{};if(this.deletedStates[s]){const A=this.deletedStates[s][c];if(A===null)return{};for(const N in A)delete x[N]}return x}initializeTileState(s,c){s.setFeatureState(this.state,c)}coalesceChanges(s,c){const g={};for(const x in this.stateChanges){this.state[x]=this.state[x]||{};const A={};for(const N in this.stateChanges[x])this.state[x][N]||(this.state[x][N]={}),o.e(this.state[x][N],this.stateChanges[x][N]),A[N]=this.state[x][N];g[x]=A}for(const x in this.deletedStates){this.state[x]=this.state[x]||{};const A={};if(this.deletedStates[x]===null)for(const N in this.state[x])A[N]={},this.state[x][N]={};else for(const N in this.deletedStates[x]){if(this.deletedStates[x][N]===null)this.state[x][N]={};else for(const $ of Object.keys(this.deletedStates[x][N]))delete this.state[x][N][$];A[N]=this.state[x][N]}g[x]=g[x]||{},o.e(g[x],A)}if(this.stateChanges={},this.deletedStates={},Object.keys(g).length!==0)for(const x in s)s[x].setFeatureState(g,c)}}const Yn=89.25;function ir(E,s){const c=o.ae(s.lat,-85.051129,o.af);return new o.P(o.U(s.lng)*E,o.S(c)*E)}function Fr(E,s){return new o.$(s.x/E,s.y/E).toLngLat()}function Ft(E){return E.cameraToCenterDistance*Math.min(.85*Math.tan(o.ab(90-E.pitch)),Math.tan(o.ab(Yn-E.pitch)))}function je(E,s){const c=E.canonical,g=s/o.ac(c.z),x=c.x+Math.pow(2,c.z)*E.wrap,A=o.ad(new Float64Array(16));return o.L(A,A,[x*g,c.y*g,0]),o.M(A,A,[g/o.Z,g/o.Z,1]),A}function Ze(E,s,c,g,x){const A=o.$.fromLngLat(E,s),N=x*o.ag(1,E.lat),$=N*Math.cos(o.ab(c)),Z=Math.sqrt(N*N-$*$),re=Z*Math.sin(o.ab(-g)),fe=Z*Math.cos(o.ab(-g));return new o.$(A.x+re,A.y+fe,A.z+$)}function et(E,s,c){const g=s.intersectsFrustum(E);if(!c)return g;const x=s.intersectsPlane(c);return g===0||x===0?0:g===2&&x===2?2:1}function ct(E,s,c){let g=0;const x=(c-s)/10;for(let A=0;A<10;A++)g+=x*Math.pow(Math.cos(s+(A+.5)/10*(c-s)),E);return g}function $e(E,s){return function(c,g,x,A,N){const $=2*((E-1)/o.ah(Math.cos(o.ab(Yn-N))/Math.cos(o.ab(Yn)))-1),Z=Math.acos(x/A),re=2*ct($-1,0,o.ab(N/2)),fe=Math.min(o.ab(Yn),Z+o.ab(N/2)),Me=ct($-1,Math.min(fe,Z-o.ab(N/2)),fe),ke=Math.atan(g/x),Ke=Math.hypot(g,x);let Qe=c;return Qe+=o.ah(A/Ke/Math.max(.5,Math.cos(o.ab(N/2)))),Qe+=$*o.ah(Math.cos(ke))/2,Qe-=o.ah(Math.max(1,Me/re/s))/2,Qe}}const Gt=$e(9.314,3);function hn(E,s){const c=(s.roundZoom?Math.round:Math.floor)(E.zoom+o.ah(E.tileSize/s.tileSize));return Math.max(0,c)}function Ot(E,s){const c=E.getCameraFrustum(),g=E.getClippingPlane(),x=E.screenPointToMercatorCoordinate(E.getCameraPoint()),A=o.$.fromLngLat(E.center,E.elevation);x.z=A.z+Math.cos(E.pitchInRadians)*E.cameraToCenterDistance/E.worldSize;const N=E.getCoveringTilesDetailsProvider(),$=N.allowVariableZoom(E,s),Z=hn(E,s),re=s.minzoom||0,fe=s.maxzoom!==void 0?s.maxzoom:E.maxZoom,Me=Math.min(Math.max(0,Z),fe),ke=Math.pow(2,Me),Ke=[ke*x.x,ke*x.y,0],Qe=[ke*A.x,ke*A.y,0],Tt=Math.hypot(A.x-x.x,A.y-x.y),Ct=Math.abs(A.z-x.z),At=Math.hypot(Tt,Ct),Rt=en=>({zoom:0,x:0,y:0,wrap:en,fullyVisible:!1}),jt=[],Vt=[];if(E.renderWorldCopies&&N.allowWorldCopies())for(let en=1;en<=3;en++)jt.push(Rt(-en)),jt.push(Rt(en));for(jt.push(Rt(0));jt.length>0;){const en=jt.pop(),mn=en.x,on=en.y;let On=en.fullyVisible;const jn={x:mn,y:on,z:en.zoom},In=N.getTileAABB(jn,en.wrap,E.elevation,s);if(!On){const Sr=et(c,In,g);if(Sr===0)continue;On=Sr===2}const sr=N.distanceToTile2d(x.x,x.y,jn,In);let tr=Z;$&&(tr=(s.calculateTileZoom||Gt)(E.zoom+o.ah(E.tileSize/s.tileSize),sr,Ct,At,E.fov)),tr=(s.roundZoom?Math.round:Math.floor)(tr),tr=Math.max(0,tr);const Or=Math.min(tr,fe);if(en.wrap=N.getWrap(A,jn,en.wrap),en.zoom>=Or){if(en.zoom<re)continue;const Sr=Me-en.zoom,mr=Ke[0]-.5-(mn<<Sr),ti=Ke[1]-.5-(on<<Sr),wi=s.reparseOverscaled?Math.max(en.zoom,tr):en.zoom;Vt.push({tileID:new o.Y(en.zoom===fe?wi:en.zoom,en.wrap,en.zoom,mn,on),distanceSq:o.ai([Qe[0]-.5-mn,Qe[1]-.5-on]),tileDistanceToCamera:Math.sqrt(mr*mr+ti*ti)})}else for(let Sr=0;Sr<4;Sr++)jt.push({zoom:en.zoom+1,x:(mn<<1)+Sr%2,y:(on<<1)+(Sr>>1),wrap:en.wrap,fullyVisible:On})}return Vt.sort((en,mn)=>en.distanceSq-mn.distanceSq).map(en=>en.tileID)}class cn extends o.E{constructor(s,c,g){super(),this.id=s,this.dispatcher=g,this.on("data",x=>this._dataHandler(x)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((x,A,N,$)=>{const Z=new(Kn(A.type))(x,A,N,$);if(Z.id!==x)throw new Error(`Expected Source id to be ${x} instead of ${Z.id}`);return Z})(s,c,g,this),this._tiles={},this._cache=new tn(0,x=>this._unloadTile(x)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Kt,this._didEmitContent=!1,this._updated=!1}onAdd(s){this.map=s,this._maxTileCacheSize=s?s._maxTileCacheSize:null,this._maxTileCacheZoomLevels=s?s._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(s)}onRemove(s){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(s)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const s in this._tiles){const c=this._tiles[s];if(c.state!=="loaded"&&c.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(s,c,g){return o._(this,void 0,void 0,function*(){try{yield this._source.loadTile(s),this._tileLoaded(s,c,g)}catch(x){s.state="errored",x.status!==404?this._source.fire(new o.k(x,{tile:s})):this.update(this.transform,this.terrain)}})}_unloadTile(s){this._source.unloadTile&&this._source.unloadTile(s)}_abortTile(s){this._source.abortTile&&this._source.abortTile(s),this._source.fire(new o.l("dataabort",{tile:s,coord:s.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const c in this._tiles){const g=this._tiles[c];g.upload(s),g.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(s=>s.tileID).sort(En).map(s=>s.key)}getRenderableIds(s){const c=[];for(const g in this._tiles)this._isIdRenderable(g,s)&&c.push(this._tiles[g]);return s?c.sort((g,x)=>{const A=g.tileID,N=x.tileID,$=new o.P(A.canonical.x,A.canonical.y)._rotate(-this.transform.bearingInRadians),Z=new o.P(N.canonical.x,N.canonical.y)._rotate(-this.transform.bearingInRadians);return A.overscaledZ-N.overscaledZ||Z.y-$.y||Z.x-$.x}).map(g=>g.tileID.key):c.map(g=>g.tileID).sort(En).map(g=>g.key)}hasRenderableParent(s){const c=this.findLoadedParent(s,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(s,c){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(c||!this._tiles[s].holdingForFade())}reload(s){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const c in this._tiles)(s||this._tiles[c].state!=="errored")&&this._reloadTile(c,"reloading")}}_reloadTile(s,c){return o._(this,void 0,void 0,function*(){const g=this._tiles[s];g&&(g.state!=="loading"&&(g.state=c),yield this._loadTile(g,s,c))})}_tileLoaded(s,c,g){s.timeAdded=M.now(),g==="expired"&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(c,s),this.getSource().type==="raster-dem"&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),s.aborted||this._source.fire(new o.l("data",{dataType:"source",tile:s,coord:s.tileID}))}_backfillDEM(s){const c=this.getRenderableIds();for(let x=0;x<c.length;x++){const A=c[x];if(s.neighboringTiles&&s.neighboringTiles[A]){const N=this.getTileByID(A);g(s,N),g(N,s)}}function g(x,A){x.needsHillshadePrepare=!0,x.needsTerrainPrepare=!0;let N=A.tileID.canonical.x-x.tileID.canonical.x;const $=A.tileID.canonical.y-x.tileID.canonical.y,Z=Math.pow(2,x.tileID.canonical.z),re=A.tileID.key;N===0&&$===0||Math.abs($)>1||(Math.abs(N)>1&&(Math.abs(N+Z)===1?N+=Z:Math.abs(N-Z)===1&&(N-=Z)),A.dem&&x.dem&&(x.dem.backfillBorder(A.dem,N,$),x.neighboringTiles&&x.neighboringTiles[re]&&(x.neighboringTiles[re].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,c,g,x){for(const A in this._tiles){let N=this._tiles[A];if(x[A]||!N.hasData()||N.tileID.overscaledZ<=c||N.tileID.overscaledZ>g)continue;let $=N.tileID;for(;N&&N.tileID.overscaledZ>c+1;){const re=N.tileID.scaledTo(N.tileID.overscaledZ-1);N=this._tiles[re.key],N&&N.hasData()&&($=re)}let Z=$;for(;Z.overscaledZ>c;)if(Z=Z.scaledTo(Z.overscaledZ-1),s[Z.key]||s[Z.canonical.key]){x[$.key]=$;break}}}findLoadedParent(s,c){if(s.key in this._loadedParentTiles){const g=this._loadedParentTiles[s.key];return g&&g.tileID.overscaledZ>=c?g:null}for(let g=s.overscaledZ-1;g>=c;g--){const x=s.scaledTo(g),A=this._getLoadedTile(x);if(A)return A}}findLoadedSibling(s){return this._getLoadedTile(s)}_getLoadedTile(s){const c=this._tiles[s.key];return c&&c.hasData()?c:this._cache.getByKey(s.wrapped().key)}updateCacheSize(s){const c=Math.ceil(s.width/this._source.tileSize)+1,g=Math.ceil(s.height/this._source.tileSize)+1,x=Math.floor(c*g*(this._maxTileCacheZoomLevels===null?o.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),A=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,x):x;this._cache.setMaxSize(A)}handleWrapJump(s){const c=Math.round((s-(this._prevLng===void 0?s:this._prevLng))/360);if(this._prevLng=s,c){const g={};for(const x in this._tiles){const A=this._tiles[x];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+c),g[A.tileID.key]=A}this._tiles=g;for(const x in this._timers)clearTimeout(this._timers[x]),delete this._timers[x];for(const x in this._tiles)this._setTileReloadTimer(x,this._tiles[x])}}_updateCoveredAndRetainedTiles(s,c,g,x,A,N){const $={},Z={},re=Object.keys(s),fe=M.now();for(const Me of re){const ke=s[Me],Ke=this._tiles[Me];if(!Ke||Ke.fadeEndTime!==0&&Ke.fadeEndTime<=fe)continue;const Qe=this.findLoadedParent(ke,c),Tt=this.findLoadedSibling(ke),Ct=Qe||Tt||null;Ct&&(this._addTile(Ct.tileID),$[Ct.tileID.key]=Ct.tileID),Z[Me]=ke}this._retainLoadedChildren(Z,x,g,s);for(const Me in $)s[Me]||(this._coveredTiles[Me]=!0,s[Me]=$[Me]);if(N){const Me={},ke={};for(const Ke of A)this._tiles[Ke.key].hasData()?Me[Ke.key]=Ke:ke[Ke.key]=Ke;for(const Ke in ke){const Qe=ke[Ke].children(this._source.maxzoom);this._tiles[Qe[0].key]&&this._tiles[Qe[1].key]&&this._tiles[Qe[2].key]&&this._tiles[Qe[3].key]&&(Me[Qe[0].key]=s[Qe[0].key]=Qe[0],Me[Qe[1].key]=s[Qe[1].key]=Qe[1],Me[Qe[2].key]=s[Qe[2].key]=Qe[2],Me[Qe[3].key]=s[Qe[3].key]=Qe[3],delete ke[Ke])}for(const Ke in ke){const Qe=ke[Ke],Tt=this.findLoadedParent(Qe,this._source.minzoom),Ct=this.findLoadedSibling(Qe),At=Tt||Ct||null;if(At){Me[At.tileID.key]=s[At.tileID.key]=At.tileID;for(const Rt in Me)Me[Rt].isChildOf(At.tileID)&&delete Me[Rt]}}for(const Ke in this._tiles)Me[Ke]||(this._coveredTiles[Ke]=!0)}}update(s,c){if(!this._sourceLoaded||this._paused)return;let g;this.transform=s,this.terrain=c,this.updateCacheSize(s),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?g=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(fe=>new o.Y(fe.canonical.z,fe.wrap,fe.canonical.z,fe.canonical.x,fe.canonical.y)):(g=Ot(s,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:c,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(g=g.filter(fe=>this._source.hasTile(fe)))):g=[];const x=hn(s,this._source),A=Math.max(x-cn.maxOverzooming,this._source.minzoom),N=Math.max(x+cn.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const fe={};for(const Me of g)if(Me.canonical.z>this._source.minzoom){const ke=Me.scaledTo(Me.canonical.z-1);fe[ke.key]=ke;const Ke=Me.scaledTo(Math.max(this._source.minzoom,Math.min(Me.canonical.z,5)));fe[Ke.key]=Ke}g=g.concat(Object.values(fe))}const $=g.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,$&&this.fire(new o.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const Z=this._updateRetainedTiles(g,x);wn(this._source.type)&&this._updateCoveredAndRetainedTiles(Z,A,N,x,g,c);for(const fe in Z)this._tiles[fe].clearFadeHold();const re=o.aj(this._tiles,Z);for(const fe of re){const Me=this._tiles[fe];Me.hasSymbolBuckets&&!Me.holdingForFade()?Me.setHoldDuration(this.map._fadeDuration):Me.hasSymbolBuckets&&!Me.symbolFadeFinished()||this._removeTile(fe)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(s)}_updateRetainedTiles(s,c){var g;const x={},A={},N=Math.max(c-cn.maxOverzooming,this._source.minzoom),$=Math.max(c+cn.maxUnderzooming,this._source.minzoom),Z={};for(const re of s){const fe=this._addTile(re);x[re.key]=re,fe.hasData()||c<this._source.maxzoom&&(Z[re.key]=re)}this._retainLoadedChildren(Z,c,$,x);for(const re of s){let fe=this._tiles[re.key];if(fe.hasData())continue;if(c+1>this._source.maxzoom){const ke=re.children(this._source.maxzoom)[0],Ke=this.getTile(ke);if(Ke&&Ke.hasData()){x[ke.key]=ke;continue}}else{const ke=re.children(this._source.maxzoom);if(x[ke[0].key]&&x[ke[1].key]&&x[ke[2].key]&&x[ke[3].key])continue}let Me=fe.wasRequested();for(let ke=re.overscaledZ-1;ke>=N;--ke){const Ke=re.scaledTo(ke);if(A[Ke.key])break;if(A[Ke.key]=!0,fe=this.getTile(Ke),!fe&&Me&&(fe=this._addTile(Ke)),fe){const Qe=fe.hasData();if((Qe||!(!((g=this.map)===null||g===void 0)&&g.cancelPendingTileRequestsWhileZooming)||Me)&&(x[Ke.key]=Ke),Me=fe.wasRequested(),Qe)break}}}return x}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const c=[];let g,x=this._tiles[s].tileID;for(;x.overscaledZ>0;){if(x.key in this._loadedParentTiles){g=this._loadedParentTiles[x.key];break}c.push(x.key);const A=x.scaledTo(x.overscaledZ-1);if(g=this._getLoadedTile(A),g)break;x=A}for(const A of c)this._loadedParentTiles[A]=g}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const s in this._tiles){const c=this._tiles[s].tileID,g=this._getLoadedTile(c);this._loadedSiblingTiles[c.key]=g}}_addTile(s){let c=this._tiles[s.key];if(c)return c;c=this._cache.getAndRemove(s),c&&(this._setTileReloadTimer(s.key,c),c.tileID=s,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,c)));const g=c;return c||(c=new Ht(s,this._source.tileSize*s.overscaleFactor()),this._loadTile(c,s.key,c.state)),c.uses++,this._tiles[s.key]=c,g||this._source.fire(new o.l("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c}_setTileReloadTimer(s,c){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const g=c.getExpiryTimeout();g&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},g))}_removeTile(s){const c=this._tiles[s];c&&(c.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),c.uses>0||(c.hasData()&&c.state!=="reloading"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}_dataHandler(s){const c=s.sourceDataType;s.dataType==="source"&&c==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&s.dataType==="source"&&c==="content"&&(this.reload(s.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(s);this._cache.reset()}tilesIn(s,c,g){const x=[],A=this.transform;if(!A)return x;const N=g?A.getCameraQueryGeometry(s):s,$=s.map(Qe=>A.screenPointToMercatorCoordinate(Qe,this.terrain)),Z=N.map(Qe=>A.screenPointToMercatorCoordinate(Qe,this.terrain)),re=this.getIds();let fe=1/0,Me=1/0,ke=-1/0,Ke=-1/0;for(const Qe of Z)fe=Math.min(fe,Qe.x),Me=Math.min(Me,Qe.y),ke=Math.max(ke,Qe.x),Ke=Math.max(Ke,Qe.y);for(let Qe=0;Qe<re.length;Qe++){const Tt=this._tiles[re[Qe]];if(Tt.holdingForFade())continue;const Ct=A.getCoveringTilesDetailsProvider().allowWorldCopies()?Tt.tileID:Tt.tileID.unwrapTo(0),At=Math.pow(2,A.zoom-Tt.tileID.overscaledZ),Rt=c*Tt.queryPadding*o.Z/Tt.tileSize/At,jt=[Ct.getTilePoint(new o.$(fe,Me)),Ct.getTilePoint(new o.$(ke,Ke))];if(jt[0].x-Rt<o.Z&&jt[0].y-Rt<o.Z&&jt[1].x+Rt>=0&&jt[1].y+Rt>=0){const Vt=$.map(mn=>Ct.getTilePoint(mn)),en=Z.map(mn=>Ct.getTilePoint(mn));x.push({tile:Tt,tileID:Ct,queryGeometry:Vt,cameraQueryGeometry:en,scale:At})}}return x}getVisibleCoordinates(s){const c=this.getRenderableIds(s).map(g=>this._tiles[g].tileID);return this.transform&&this.transform.populateCache(c),c}hasTransition(){if(this._source.hasTransition())return!0;if(wn(this._source.type)){const s=M.now();for(const c in this._tiles)if(this._tiles[c].fadeEndTime>=s)return!0}return!1}setFeatureState(s,c,g){this._state.updateState(s=s||"_geojsonTileLayer",c,g)}removeFeatureState(s,c,g){this._state.removeFeatureState(s=s||"_geojsonTileLayer",c,g)}getFeatureState(s,c){return this._state.getState(s=s||"_geojsonTileLayer",c)}setDependencies(s,c,g){const x=this._tiles[s];x&&x.setDependencies(c,g)}reloadTilesForDependencies(s,c){for(const g in this._tiles)this._tiles[g].hasDependency(s,c)&&this._reloadTile(g,"reloading");this._cache.filter(g=>!g.hasDependency(s,c))}}function En(E,s){const c=Math.abs(2*E.wrap)-+(E.wrap<0),g=Math.abs(2*s.wrap)-+(s.wrap<0);return E.overscaledZ-s.overscaledZ||g-c||s.canonical.y-E.canonical.y||s.canonical.x-E.canonical.x}function wn(E){return E==="raster"||E==="image"||E==="video"}cn.maxOverzooming=10,cn.maxUnderzooming=3;class Qn{constructor(s,c){this.reset(s,c)}reset(s,c){this.points=s||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(this.points.length===1)return this.points[0];s=o.ae(s,0,1);let c=1,g=this._distances[c];const x=s*this.paddedLength+this.padding;for(;g<x&&c<this._distances.length;)g=this._distances[++c];const A=c-1,N=this._distances[A],$=g-N,Z=$>0?(x-N)/$:0;return this.points[A].mult(1-Z).add(this.points[c].mult(Z))}}function Lr(E,s){let c=!0;return E==="always"||E!=="never"&&s!=="never"||(c=!1),c}class Yt{constructor(s,c,g){const x=this.boxCells=[],A=this.circleCells=[];this.xCellCount=Math.ceil(s/g),this.yCellCount=Math.ceil(c/g);for(let N=0;N<this.xCellCount*this.yCellCount;N++)x.push([]),A.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=c,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,c,g,x,A){this._forEachCell(c,g,x,A,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(c),this.bboxes.push(g),this.bboxes.push(x),this.bboxes.push(A)}insertCircle(s,c,g,x){this._forEachCell(c-x,g-x,c+x,g+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(c),this.circles.push(g),this.circles.push(x)}_insertBoxCell(s,c,g,x,A,N){this.boxCells[A].push(N)}_insertCircleCell(s,c,g,x,A,N){this.circleCells[A].push(N)}_query(s,c,g,x,A,N,$){if(g<0||s>this.width||x<0||c>this.height)return[];const Z=[];if(s<=0&&c<=0&&this.width<=g&&this.height<=x){if(A)return[{key:null,x1:s,y1:c,x2:g,y2:x}];for(let re=0;re<this.boxKeys.length;re++)Z.push({key:this.boxKeys[re],x1:this.bboxes[4*re],y1:this.bboxes[4*re+1],x2:this.bboxes[4*re+2],y2:this.bboxes[4*re+3]});for(let re=0;re<this.circleKeys.length;re++){const fe=this.circles[3*re],Me=this.circles[3*re+1],ke=this.circles[3*re+2];Z.push({key:this.circleKeys[re],x1:fe-ke,y1:Me-ke,x2:fe+ke,y2:Me+ke})}}else this._forEachCell(s,c,g,x,this._queryCell,Z,{hitTest:A,overlapMode:N,seenUids:{box:{},circle:{}}},$);return Z}query(s,c,g,x){return this._query(s,c,g,x,!1,null)}hitTest(s,c,g,x,A,N){return this._query(s,c,g,x,!0,A,N).length>0}hitTestCircle(s,c,g,x,A){const N=s-g,$=s+g,Z=c-g,re=c+g;if($<0||N>this.width||re<0||Z>this.height)return!1;const fe=[];return this._forEachCell(N,Z,$,re,this._queryCellCircle,fe,{hitTest:!0,overlapMode:x,circle:{x:s,y:c,radius:g},seenUids:{box:{},circle:{}}},A),fe.length>0}_queryCell(s,c,g,x,A,N,$,Z){const{seenUids:re,hitTest:fe,overlapMode:Me}=$,ke=this.boxCells[A];if(ke!==null){const Qe=this.bboxes;for(const Tt of ke)if(!re.box[Tt]){re.box[Tt]=!0;const Ct=4*Tt,At=this.boxKeys[Tt];if(s<=Qe[Ct+2]&&c<=Qe[Ct+3]&&g>=Qe[Ct+0]&&x>=Qe[Ct+1]&&(!Z||Z(At))&&(!fe||!Lr(Me,At.overlapMode))&&(N.push({key:At,x1:Qe[Ct],y1:Qe[Ct+1],x2:Qe[Ct+2],y2:Qe[Ct+3]}),fe))return!0}}const Ke=this.circleCells[A];if(Ke!==null){const Qe=this.circles;for(const Tt of Ke)if(!re.circle[Tt]){re.circle[Tt]=!0;const Ct=3*Tt,At=this.circleKeys[Tt];if(this._circleAndRectCollide(Qe[Ct],Qe[Ct+1],Qe[Ct+2],s,c,g,x)&&(!Z||Z(At))&&(!fe||!Lr(Me,At.overlapMode))){const Rt=Qe[Ct],jt=Qe[Ct+1],Vt=Qe[Ct+2];if(N.push({key:At,x1:Rt-Vt,y1:jt-Vt,x2:Rt+Vt,y2:jt+Vt}),fe)return!0}}}return!1}_queryCellCircle(s,c,g,x,A,N,$,Z){const{circle:re,seenUids:fe,overlapMode:Me}=$,ke=this.boxCells[A];if(ke!==null){const Qe=this.bboxes;for(const Tt of ke)if(!fe.box[Tt]){fe.box[Tt]=!0;const Ct=4*Tt,At=this.boxKeys[Tt];if(this._circleAndRectCollide(re.x,re.y,re.radius,Qe[Ct+0],Qe[Ct+1],Qe[Ct+2],Qe[Ct+3])&&(!Z||Z(At))&&!Lr(Me,At.overlapMode))return N.push(!0),!0}}const Ke=this.circleCells[A];if(Ke!==null){const Qe=this.circles;for(const Tt of Ke)if(!fe.circle[Tt]){fe.circle[Tt]=!0;const Ct=3*Tt,At=this.circleKeys[Tt];if(this._circlesCollide(Qe[Ct],Qe[Ct+1],Qe[Ct+2],re.x,re.y,re.radius)&&(!Z||Z(At))&&!Lr(Me,At.overlapMode))return N.push(!0),!0}}}_forEachCell(s,c,g,x,A,N,$,Z){const re=this._convertToXCellCoord(s),fe=this._convertToYCellCoord(c),Me=this._convertToXCellCoord(g),ke=this._convertToYCellCoord(x);for(let Ke=re;Ke<=Me;Ke++)for(let Qe=fe;Qe<=ke;Qe++)if(A.call(this,s,c,g,x,this.xCellCount*Qe+Ke,N,$,Z))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,c,g,x,A,N){const $=x-s,Z=A-c,re=g+N;return re*re>$*$+Z*Z}_circleAndRectCollide(s,c,g,x,A,N,$){const Z=(N-x)/2,re=Math.abs(s-(x+Z));if(re>Z+g)return!1;const fe=($-A)/2,Me=Math.abs(c-(A+fe));if(Me>fe+g)return!1;if(re<=Z||Me<=fe)return!0;const ke=re-Z,Ke=Me-fe;return ke*ke+Ke*Ke<=g*g}}function vt(E,s,c){const g=o.K();if(!E){const{vecSouth:Me,vecEast:ke}=bn(s),Ke=m();Ke[0]=ke[0],Ke[1]=ke[1],Ke[2]=Me[0],Ke[3]=Me[1],x=Ke,(fe=(N=(A=Ke)[0])*(re=A[3])-(Z=A[2])*($=A[1]))&&(x[0]=re*(fe=1/fe),x[1]=-$*fe,x[2]=-Z*fe,x[3]=N*fe),g[0]=Ke[0],g[1]=Ke[1],g[4]=Ke[2],g[5]=Ke[3]}var x,A,N,$,Z,re,fe;return o.M(g,g,[1/c,1/c,1]),g}function Tn(E,s,c,g){if(E){const x=o.K();if(!s){const{vecSouth:A,vecEast:N}=bn(c);x[0]=N[0],x[1]=N[1],x[4]=A[0],x[5]=A[1]}return o.M(x,x,[g,g,1]),x}return c.pixelsToClipSpaceMatrix}function bn(E){const s=Math.cos(E.rollInRadians),c=Math.sin(E.rollInRadians),g=Math.cos(E.pitchInRadians),x=Math.cos(E.bearingInRadians),A=Math.sin(E.bearingInRadians),N=o.ao();N[0]=-x*g*c-A*s,N[1]=-A*g*c+x*s;const $=o.ap(N);$<1e-9?o.aq(N):o.ar(N,N,1/$);const Z=o.ao();Z[0]=x*g*s-A*c,Z[1]=A*g*s+x*c;const re=o.ap(Z);return re<1e-9?o.aq(Z):o.ar(Z,Z,1/re),{vecEast:Z,vecSouth:N}}function br(E,s,c,g){let x;g?(x=[E,s,g(E,s),1],o.at(x,x,c)):(x=[E,s,0,1],ns(x,x,c));const A=x[3];return{point:new o.P(x[0]/A,x[1]/A),signedDistanceFromCamera:A,isOccluded:!1}}function vr(E,s){return .5+E/s*.5}function Cn(E,s){return E.x>=-s[0]&&E.x<=s[0]&&E.y>=-s[1]&&E.y<=s[1]}function pn(E,s,c,g,x,A,N,$,Z,re,fe,Me,ke){const Ke=c?E.textSizeData:E.iconSizeData,Qe=o.ak(Ke,s.transform.zoom),Tt=[256/s.width*2+1,256/s.height*2+1],Ct=c?E.text.dynamicLayoutVertexArray:E.icon.dynamicLayoutVertexArray;Ct.clear();const At=E.lineVertexArray,Rt=c?E.text.placedSymbolArray:E.icon.placedSymbolArray,jt=s.transform.width/s.transform.height;let Vt=!1;for(let en=0;en<Rt.length;en++){const mn=Rt.get(en);if(mn.hidden||mn.writingMode===o.al.vertical&&!Vt){Yi(mn.numGlyphs,Ct);continue}Vt=!1;const on=new o.P(mn.anchorX,mn.anchorY),On={getElevation:ke,pitchedLabelPlaneMatrix:g,lineVertexArray:At,pitchWithMap:A,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:s.transform,tileAnchorPoint:on,unwrappedTileID:Z,width:re,height:fe,translation:Me},jn=As(mn.anchorX,mn.anchorY,On);if(!Cn(jn.point,Tt)){Yi(mn.numGlyphs,Ct);continue}const In=vr(s.transform.cameraToCenterDistance,jn.signedDistanceFromCamera),sr=o.am(Ke,Qe,mn),tr=A?sr*s.transform.getPitchedTextCorrection(mn.anchorX,mn.anchorY,Z)/In:sr*In,Or=or({projectionContext:On,pitchedLabelPlaneMatrixInverse:x,symbol:mn,fontSize:tr,flip:!1,keepUpright:N,glyphOffsetArray:E.glyphOffsetArray,dynamicLayoutVertexArray:Ct,aspectRatio:jt,rotateToLine:$});Vt=Or.useVertical,(Or.notEnoughRoom||Vt||Or.needsFlipping&&or({projectionContext:On,pitchedLabelPlaneMatrixInverse:x,symbol:mn,fontSize:tr,flip:!0,keepUpright:N,glyphOffsetArray:E.glyphOffsetArray,dynamicLayoutVertexArray:Ct,aspectRatio:jt,rotateToLine:$}).notEnoughRoom)&&Yi(mn.numGlyphs,Ct)}c?E.text.dynamicLayoutVertexBuffer.updateData(Ct):E.icon.dynamicLayoutVertexBuffer.updateData(Ct)}function Ut(E,s,c,g,x,A,N,$){const Z=A.glyphStartIndex+A.numGlyphs,re=A.lineStartIndex,fe=A.lineStartIndex+A.lineLength,Me=s.getoffsetX(A.glyphStartIndex),ke=s.getoffsetX(Z-1),Ke=pi(E*Me,c,g,x,A.segment,re,fe,$,N);if(!Ke)return null;const Qe=pi(E*ke,c,g,x,A.segment,re,fe,$,N);return Qe?$.projectionCache.anyProjectionOccluded?null:{first:Ke,last:Qe}:null}function Hn(E,s,c,g){return E===o.al.horizontal&&Math.abs(c.y-s.y)>Math.abs(c.x-s.x)*g?{useVertical:!0}:(E===o.al.vertical?s.y<c.y:s.x>c.x)?{needsFlipping:!0}:null}function or(E){const{projectionContext:s,pitchedLabelPlaneMatrixInverse:c,symbol:g,fontSize:x,flip:A,keepUpright:N,glyphOffsetArray:$,dynamicLayoutVertexArray:Z,aspectRatio:re,rotateToLine:fe}=E,Me=x/24,ke=g.lineOffsetX*Me,Ke=g.lineOffsetY*Me;let Qe;if(g.numGlyphs>1){const Tt=g.glyphStartIndex+g.numGlyphs,Ct=g.lineStartIndex,At=g.lineStartIndex+g.lineLength,Rt=Ut(Me,$,ke,Ke,A,g,fe,s);if(!Rt)return{notEnoughRoom:!0};const jt=Pr(Rt.first.point.x,Rt.first.point.y,s,c),Vt=Pr(Rt.last.point.x,Rt.last.point.y,s,c);if(N&&!A){const en=Hn(g.writingMode,jt,Vt,re);if(en)return en}Qe=[Rt.first];for(let en=g.glyphStartIndex+1;en<Tt-1;en++)Qe.push(pi(Me*$.getoffsetX(en),ke,Ke,A,g.segment,Ct,At,s,fe));Qe.push(Rt.last)}else{if(N&&!A){const Ct=ai(s.tileAnchorPoint.x,s.tileAnchorPoint.y,s).point,At=g.lineStartIndex+g.segment+1,Rt=new o.P(s.lineVertexArray.getx(At),s.lineVertexArray.gety(At)),jt=ai(Rt.x,Rt.y,s),Vt=jt.signedDistanceFromCamera>0?jt.point:Xr(s.tileAnchorPoint,Rt,Ct,1,s),en=Pr(Ct.x,Ct.y,s,c),mn=Pr(Vt.x,Vt.y,s,c),on=Hn(g.writingMode,en,mn,re);if(on)return on}const Tt=pi(Me*$.getoffsetX(g.glyphStartIndex),ke,Ke,A,g.segment,g.lineStartIndex,g.lineStartIndex+g.lineLength,s,fe);if(!Tt||s.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Qe=[Tt]}for(const Tt of Qe)o.as(Z,Tt.point,Tt.angle);return{}}function Xr(E,s,c,g,x){const A=E.add(E.sub(s)._unit()),N=ai(A.x,A.y,x).point,$=c.sub(N);return c.add($._mult(g/$.mag()))}function ri(E,s,c){const g=s.projectionCache;if(g.projections[E])return g.projections[E];const x=new o.P(s.lineVertexArray.getx(E),s.lineVertexArray.gety(E)),A=ai(x.x,x.y,s);if(A.signedDistanceFromCamera>0)return g.projections[E]=A.point,g.anyProjectionOccluded=g.anyProjectionOccluded||A.isOccluded,A.point;const N=E-c.direction;return Xr(c.distanceFromAnchor===0?s.tileAnchorPoint:new o.P(s.lineVertexArray.getx(N),s.lineVertexArray.gety(N)),x,c.previousVertex,c.absOffsetX-c.distanceFromAnchor+1,s)}function ai(E,s,c){const g=E+c.translation[0],x=s+c.translation[1];let A;return c.pitchWithMap?(A=br(g,x,c.pitchedLabelPlaneMatrix,c.getElevation),A.isOccluded=!1):(A=c.transform.projectTileCoordinates(g,x,c.unwrappedTileID,c.getElevation),A.point.x=(.5*A.point.x+.5)*c.width,A.point.y=(.5*-A.point.y+.5)*c.height),A}function Pr(E,s,c,g){if(c.pitchWithMap){const x=[E,s,0,1];return o.at(x,x,g),c.transform.projectTileCoordinates(x[0]/x[3],x[1]/x[3],c.unwrappedTileID,c.getElevation).point}return{x:E/c.width*2-1,y:s/c.height*2-1}}function As(E,s,c){return c.transform.projectTileCoordinates(E,s,c.unwrappedTileID,c.getElevation)}function $i(E,s,c){return E._unit()._perp()._mult(s*c)}function Qa(E,s,c,g,x,A,N,$,Z){if($.projectionCache.offsets[E])return $.projectionCache.offsets[E];const re=c.add(s);if(E+Z.direction<g||E+Z.direction>=x)return $.projectionCache.offsets[E]=re,re;const fe=ri(E+Z.direction,$,Z),Me=$i(fe.sub(c),N,Z.direction),ke=c.add(Me),Ke=fe.add(Me);return $.projectionCache.offsets[E]=o.au(A,re,ke,Ke)||re,$.projectionCache.offsets[E]}function pi(E,s,c,g,x,A,N,$,Z){const re=g?E-s:E+s;let fe=re>0?1:-1,Me=0;g&&(fe*=-1,Me=Math.PI),fe<0&&(Me+=Math.PI);let ke,Ke=fe>0?A+x:A+x+1;$.projectionCache.cachedAnchorPoint?ke=$.projectionCache.cachedAnchorPoint:(ke=ai($.tileAnchorPoint.x,$.tileAnchorPoint.y,$).point,$.projectionCache.cachedAnchorPoint=ke);let Qe,Tt,Ct=ke,At=ke,Rt=0,jt=0;const Vt=Math.abs(re),en=[];let mn;for(;Rt+jt<=Vt;){if(Ke+=fe,Ke<A||Ke>=N)return null;Rt+=jt,At=Ct,Tt=Qe;const jn={absOffsetX:Vt,direction:fe,distanceFromAnchor:Rt,previousVertex:At};if(Ct=ri(Ke,$,jn),c===0)en.push(At),mn=Ct.sub(At);else{let In;const sr=Ct.sub(At);In=sr.mag()===0?$i(ri(Ke+fe,$,jn).sub(Ct),c,fe):$i(sr,c,fe),Tt||(Tt=At.add(In)),Qe=Qa(Ke,In,Ct,A,N,Tt,c,$,jn),en.push(Tt),mn=Qe.sub(Tt)}jt=mn.mag()}const on=mn._mult((Vt-Rt)/jt)._add(Tt||At),On=Me+Math.atan2(Ct.y-At.y,Ct.x-At.x);return en.push(on),{point:on,angle:Z?On:0,path:en}}const Li=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Yi(E,s){for(let c=0;c<E;c++){const g=s.length;s.resize(g+4),s.float32.set(Li,3*g)}}function ns(E,s,c){const g=s[0],x=s[1];return E[0]=c[0]*g+c[4]*x+c[12],E[1]=c[1]*g+c[5]*x+c[13],E[3]=c[3]*g+c[7]*x+c[15],E}const ao=100;class wc{constructor(s,c=new Yt(s.width+200,s.height+200,25),g=new Yt(s.width+200,s.height+200,25)){this.transform=s,this.grid=c,this.ignoredGrid=g,this.pitchFactor=Math.cos(s.pitch*Math.PI/180)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+ao,this.screenBottomBoundary=s.height+ao,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(s,c,g,x,A,N,$,Z,re,fe,Me,ke){const Ke=this.projectAndGetPerspectiveRatio(s.anchorPointX+Z[0],s.anchorPointY+Z[1],A,fe,ke),Qe=g*Ke.perspectiveRatio;let Tt;if(N||$)Tt=this._projectCollisionBox(s,Qe,x,A,N,$,Z,Ke,fe,Me,ke);else{const mn=Ke.x+(Me?Me.x*Qe:0),on=Ke.y+(Me?Me.y*Qe:0);Tt={allPointsOccluded:!1,box:[mn+s.x1*Qe,on+s.y1*Qe,mn+s.x2*Qe,on+s.y2*Qe]}}const[Ct,At,Rt,jt]=Tt.box,Vt=N?Tt.allPointsOccluded:Ke.isOccluded;let en=Vt;return en||(en=Ke.perspectiveRatio<this.perspectiveRatioCutoff),en||(en=!this.isInsideGrid(Ct,At,Rt,jt)),en||c!=="always"&&this.grid.hitTest(Ct,At,Rt,jt,c,re)?{box:[Ct,At,Rt,jt],placeable:!1,offscreen:!1,occluded:Vt}:{box:[Ct,At,Rt,jt],placeable:!0,offscreen:this.isOffscreen(Ct,At,Rt,jt),occluded:Vt}}placeCollisionCircles(s,c,g,x,A,N,$,Z,re,fe,Me,ke,Ke,Qe){const Tt=[],Ct=new o.P(c.anchorX,c.anchorY),At=this.getPerspectiveRatio(Ct.x,Ct.y,N,Qe),Rt=(re?A*this.transform.getPitchedTextCorrection(c.anchorX,c.anchorY,N)/At:A*At)/o.ay,jt={getElevation:Qe,pitchedLabelPlaneMatrix:$,lineVertexArray:g,pitchWithMap:re,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:Ct,unwrappedTileID:N,width:this.transform.width,height:this.transform.height,translation:Ke},Vt=Ut(Rt,x,c.lineOffsetX*Rt,c.lineOffsetY*Rt,!1,c,!1,jt);let en=!1,mn=!1,on=!0;if(Vt){const On=.5*Me*At+ke,jn=new o.P(-100,-100),In=new o.P(this.screenRightBoundary,this.screenBottomBoundary),sr=new Qn,tr=Vt.first,Or=Vt.last;let Sr=[];for(let wi=tr.path.length-1;wi>=1;wi--)Sr.push(tr.path[wi]);for(let wi=1;wi<Or.path.length;wi++)Sr.push(Or.path[wi]);const mr=2.5*On;if(re){const wi=this.projectPathToScreenSpace(Sr,jt);Sr=wi.some(Ei=>Ei.signedDistanceFromCamera<=0)?[]:wi.map(Ei=>Ei.point)}let ti=[];if(Sr.length>0){const wi=Sr[0].clone(),Ei=Sr[0].clone();for(let Os=1;Os<Sr.length;Os++)wi.x=Math.min(wi.x,Sr[Os].x),wi.y=Math.min(wi.y,Sr[Os].y),Ei.x=Math.max(Ei.x,Sr[Os].x),Ei.y=Math.max(Ei.y,Sr[Os].y);ti=wi.x>=jn.x&&Ei.x<=In.x&&wi.y>=jn.y&&Ei.y<=In.y?[Sr]:Ei.x<jn.x||wi.x>In.x||Ei.y<jn.y||wi.y>In.y?[]:o.av([Sr],jn.x,jn.y,In.x,In.y)}for(const wi of ti){sr.reset(wi,.25*On);let Ei=0;Ei=sr.length<=.5*On?1:Math.ceil(sr.paddedLength/mr)+1;for(let Os=0;Os<Ei;Os++){const Rs=Os/Math.max(Ei-1,1),fo=sr.lerp(Rs),po=fo.x+ao,Ji=fo.y+ao;Tt.push(po,Ji,On,0);const hs=po-On,ko=Ji-On,sa=po+On,Zo=Ji+On;if(on=on&&this.isOffscreen(hs,ko,sa,Zo),mn=mn||this.isInsideGrid(hs,ko,sa,Zo),s!=="always"&&this.grid.hitTestCircle(po,Ji,On,s,fe)&&(en=!0,!Z))return{circles:[],offscreen:!1,collisionDetected:en}}}}return{circles:!Z&&en||!mn||At<this.perspectiveRatioCutoff?[]:Tt,offscreen:on,collisionDetected:en}}projectPathToScreenSpace(s,c){const g=function(x,A){const N=o.K();return o.an(N,A.pitchedLabelPlaneMatrix),x.map($=>{const Z=br($.x,$.y,N,A.getElevation),re=A.transform.projectTileCoordinates(Z.point.x,Z.point.y,A.unwrappedTileID,A.getElevation);return re.point.x=(.5*re.point.x+.5)*A.width,re.point.y=(.5*-re.point.y+.5)*A.height,re})}(s,c);return function(x){let A=0,N=0,$=0,Z=0;for(let re=0;re<x.length;re++)x[re].isOccluded?($=re+1,Z=0):(Z++,Z>N&&(N=Z,A=$));return x.slice(A,A+N)}(g)}queryRenderedSymbols(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const c=[];let g=1/0,x=1/0,A=-1/0,N=-1/0;for(const fe of s){const Me=new o.P(fe.x+ao,fe.y+ao);g=Math.min(g,Me.x),x=Math.min(x,Me.y),A=Math.max(A,Me.x),N=Math.max(N,Me.y),c.push(Me)}const $=this.grid.query(g,x,A,N).concat(this.ignoredGrid.query(g,x,A,N)),Z={},re={};for(const fe of $){const Me=fe.key;if(Z[Me.bucketInstanceId]===void 0&&(Z[Me.bucketInstanceId]={}),Z[Me.bucketInstanceId][Me.featureIndex])continue;const ke=[new o.P(fe.x1,fe.y1),new o.P(fe.x2,fe.y1),new o.P(fe.x2,fe.y2),new o.P(fe.x1,fe.y2)];o.aw(c,ke)&&(Z[Me.bucketInstanceId][Me.featureIndex]=!0,re[Me.bucketInstanceId]===void 0&&(re[Me.bucketInstanceId]=[]),re[Me.bucketInstanceId].push(Me.featureIndex))}return re}insertCollisionBox(s,c,g,x,A,N){(g?this.ignoredGrid:this.grid).insert({bucketInstanceId:x,featureIndex:A,collisionGroupID:N,overlapMode:c},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,c,g,x,A,N){const $=g?this.ignoredGrid:this.grid,Z={bucketInstanceId:x,featureIndex:A,collisionGroupID:N,overlapMode:c};for(let re=0;re<s.length;re+=4)$.insertCircle(Z,s[re],s[re+1],s[re+2])}projectAndGetPerspectiveRatio(s,c,g,x,A){if(A){let N;x?(N=[s,c,x(s,c),1],o.at(N,N,A)):(N=[s,c,0,1],ns(N,N,A));const $=N[3];return{x:(N[0]/$+1)/2*this.transform.width+ao,y:(-N[1]/$+1)/2*this.transform.height+ao,perspectiveRatio:.5+this.transform.cameraToCenterDistance/$*.5,isOccluded:!1,signedDistanceFromCamera:$}}{const N=this.transform.projectTileCoordinates(s,c,g,x);return{x:(N.point.x+1)/2*this.transform.width+ao,y:(1-N.point.y)/2*this.transform.height+ao,perspectiveRatio:.5+this.transform.cameraToCenterDistance/N.signedDistanceFromCamera*.5,isOccluded:N.isOccluded,signedDistanceFromCamera:N.signedDistanceFromCamera}}}getPerspectiveRatio(s,c,g,x){const A=this.transform.projectTileCoordinates(s,c,g,x);return .5+this.transform.cameraToCenterDistance/A.signedDistanceFromCamera*.5}isOffscreen(s,c,g,x){return g<ao||s>=this.screenRightBoundary||x<ao||c>this.screenBottomBoundary}isInsideGrid(s,c,g,x){return g>=0&&s<this.gridRightBoundary&&x>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const s=o.ad([]);return o.L(s,s,[-100,-100,0]),s}_projectCollisionBox(s,c,g,x,A,N,$,Z,re,fe,Me){let ke=1,Ke=0,Qe=0,Tt=1;const Ct=s.anchorPointX+$[0],At=s.anchorPointY+$[1];if(N&&!A){const Sr=this.projectAndGetPerspectiveRatio(Ct+1,At,x,re,Me),mr=Sr.x-Z.x,ti=Math.atan((Sr.y-Z.y)/mr)+(mr<0?Math.PI:0),wi=Math.sin(ti),Ei=Math.cos(ti);ke=Ei,Ke=wi,Qe=-wi,Tt=Ei}else if(!N&&A){const Sr=bn(this.transform);ke=Sr.vecEast[0],Ke=Sr.vecEast[1],Qe=Sr.vecSouth[0],Tt=Sr.vecSouth[1]}let Rt=Z.x,jt=Z.y,Vt=c;A&&(Rt=Ct,jt=At,Vt=Math.pow(2,-(this.transform.zoom-g.overscaledZ)),Vt*=this.transform.getPitchedTextCorrection(Ct,At,x),fe||(Vt*=o.ae(.5+Z.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),fe&&(Rt+=ke*fe.x*Vt+Qe*fe.y*Vt,jt+=Ke*fe.x*Vt+Tt*fe.y*Vt);const en=s.x1*Vt,mn=s.x2*Vt,on=(en+mn)/2,On=s.y1*Vt,jn=s.y2*Vt,In=(On+jn)/2,sr=[{offsetX:en,offsetY:On},{offsetX:on,offsetY:On},{offsetX:mn,offsetY:On},{offsetX:mn,offsetY:In},{offsetX:mn,offsetY:jn},{offsetX:on,offsetY:jn},{offsetX:en,offsetY:jn},{offsetX:en,offsetY:In}];let tr=[];for(const{offsetX:Sr,offsetY:mr}of sr)tr.push(new o.P(Rt+ke*Sr+Qe*mr,jt+Ke*Sr+Tt*mr));let Or=!1;if(A){const Sr=tr.map(mr=>this.projectAndGetPerspectiveRatio(mr.x,mr.y,x,re,Me));Or=Sr.some(mr=>!mr.isOccluded),tr=Sr.map(mr=>new o.P(mr.x,mr.y))}else Or=!0;return{box:o.ax(tr),allPointsOccluded:!Or}}}class Wu{constructor(s,c,g,x){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?c:-c))):x&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class el{constructor(s,c,g,x,A){this.text=new Wu(s?s.text:null,c,g,A),this.icon=new Wu(s?s.icon:null,c,x,A)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Au{constructor(s,c,g){this.text=s,this.icon=c,this.skipFade=g}}class Zu{constructor(s,c,g,x,A){this.bucketInstanceId=s,this.featureIndex=c,this.sourceLayerIndex=g,this.bucketIndex=x,this.tileID=A}}class Ku{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){const c=++this.maxGroupID;this.collisionGroups[s]={ID:c,predicate:g=>g.collisionGroupID===c}}return this.collisionGroups[s]}}function Cc(E,s,c,g,x){const{horizontalAlign:A,verticalAlign:N}=o.aE(E);return new o.P(-(A-.5)*s+g[0]*x,-(N-.5)*c+g[1]*x)}class Yu{constructor(s,c,g,x,A){this.transform=s.clone(),this.terrain=c,this.collisionIndex=new wc(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=g,this.retainedQueryData={},this.collisionGroups=new Ku(x),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=A,A&&(A.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(s){const c=this.terrain;return c?(g,x)=>c.getElevation(s,g,x):null}getBucketParts(s,c,g,x){const A=g.getBucket(c),N=g.latestFeatureIndex;if(!A||!N||c.id!==A.layerIds[0])return;const $=g.collisionBoxArray,Z=A.layers[0].layout,re=A.layers[0].paint,fe=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),Me=g.tileSize/o.Z,ke=g.tileID.toUnwrapped(),Ke=Z.get("text-rotation-alignment")==="map",Qe=o.az(g,1,this.transform.zoom),Tt=o.aA(this.collisionIndex.transform,g,re.get("text-translate"),re.get("text-translate-anchor")),Ct=o.aA(this.collisionIndex.transform,g,re.get("icon-translate"),re.get("icon-translate-anchor")),At=vt(Ke,this.transform,Qe);this.retainedQueryData[A.bucketInstanceId]=new Zu(A.bucketInstanceId,N,A.sourceLayerIndex,A.index,g.tileID);const Rt={bucket:A,layout:Z,translationText:Tt,translationIcon:Ct,unwrappedTileID:ke,pitchedLabelPlaneMatrix:At,scale:fe,textPixelRatio:Me,holdingForFade:g.holdingForFade(),collisionBoxArray:$,partiallyEvaluatedTextSize:o.ak(A.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(A.sourceID)};if(x)for(const jt of A.sortKeyRanges){const{sortKey:Vt,symbolInstanceStart:en,symbolInstanceEnd:mn}=jt;s.push({sortKey:Vt,symbolInstanceStart:en,symbolInstanceEnd:mn,parameters:Rt})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:A.symbolInstances.length,parameters:Rt})}attemptAnchorPlacement(s,c,g,x,A,N,$,Z,re,fe,Me,ke,Ke,Qe,Tt,Ct,At,Rt,jt,Vt){const en=o.aB[s.textAnchor],mn=[s.textOffset0,s.textOffset1],on=Cc(en,g,x,mn,A),On=this.collisionIndex.placeCollisionBox(c,ke,Z,re,fe,$,N,Ct,Me.predicate,jt,on,Vt);if((!Rt||this.collisionIndex.placeCollisionBox(Rt,ke,Z,re,fe,$,N,At,Me.predicate,jt,on,Vt).placeable)&&On.placeable){let jn;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ke.crossTileID]&&this.prevPlacement.placements[Ke.crossTileID]&&this.prevPlacement.placements[Ke.crossTileID].text&&(jn=this.prevPlacement.variableOffsets[Ke.crossTileID].anchor),Ke.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Ke.crossTileID]={textOffset:mn,width:g,height:x,anchor:en,textBoxScale:A,prevAnchor:jn},this.markUsedJustification(Qe,en,Ke,Tt),Qe.allowVerticalPlacement&&(this.markUsedOrientation(Qe,Tt,Ke),this.placedOrientations[Ke.crossTileID]=Tt),{shift:on,placedGlyphBoxes:On}}}placeLayerBucketPart(s,c,g){const{bucket:x,layout:A,translationText:N,translationIcon:$,unwrappedTileID:Z,pitchedLabelPlaneMatrix:re,textPixelRatio:fe,holdingForFade:Me,collisionBoxArray:ke,partiallyEvaluatedTextSize:Ke,collisionGroup:Qe}=s.parameters,Tt=A.get("text-optional"),Ct=A.get("icon-optional"),At=o.aC(A,"text-overlap","text-allow-overlap"),Rt=At==="always",jt=o.aC(A,"icon-overlap","icon-allow-overlap"),Vt=jt==="always",en=A.get("text-rotation-alignment")==="map",mn=A.get("text-pitch-alignment")==="map",on=A.get("icon-text-fit")!=="none",On=A.get("symbol-z-order")==="viewport-y",jn=Rt&&(Vt||!x.hasIconData()||Ct),In=Vt&&(Rt||!x.hasTextData()||Tt);!x.collisionArrays&&ke&&x.deserializeCollisionBoxes(ke);const sr=this.retainedQueryData[x.bucketInstanceId].tileID,tr=this._getTerrainElevationFunc(sr),Or=this.transform.getFastPathSimpleProjectionMatrix(sr),Sr=(mr,ti,wi)=>{var Ei,Os;if(c[mr.crossTileID])return;if(Me)return void(this.placements[mr.crossTileID]=new Au(!1,!1,!1));let Rs=!1,fo=!1,po=!0,Ji=null,hs={box:null,placeable:!1,offscreen:null,occluded:!1},ko={placeable:!1},sa=null,Zo=null,bo=null,Wa=0,Hl=0,ju=0;ti.textFeatureIndex?Wa=ti.textFeatureIndex:mr.useRuntimeCollisionCircles&&(Wa=mr.featureIndex),ti.verticalTextFeatureIndex&&(Hl=ti.verticalTextFeatureIndex);const tc=ti.textBox;if(tc){const Wl=oa=>{let Io=o.al.horizontal;if(x.allowVerticalPlacement&&!oa&&this.prevPlacement){const ga=this.prevPlacement.placedOrientations[mr.crossTileID];ga&&(this.placedOrientations[mr.crossTileID]=ga,Io=ga,this.markUsedOrientation(x,Io,mr))}return Io},ed=(oa,Io)=>{if(x.allowVerticalPlacement&&mr.numVerticalGlyphVertices>0&&ti.verticalTextBox){for(const ga of x.writingModes)if(ga===o.al.vertical?(hs=Io(),ko=hs):hs=oa(),hs&&hs.placeable)break}else hs=oa()},ch=mr.textAnchorOffsetStartIndex,td=mr.textAnchorOffsetEndIndex;if(td===ch){const oa=(Io,ga)=>{const Do=this.collisionIndex.placeCollisionBox(Io,At,fe,sr,Z,mn,en,N,Qe.predicate,tr,void 0,Or);return Do&&Do.placeable&&(this.markUsedOrientation(x,ga,mr),this.placedOrientations[mr.crossTileID]=ga),Do};ed(()=>oa(tc,o.al.horizontal),()=>{const Io=ti.verticalTextBox;return x.allowVerticalPlacement&&mr.numVerticalGlyphVertices>0&&Io?oa(Io,o.al.vertical):{box:null,offscreen:null}}),Wl(hs&&hs.placeable)}else{let oa=o.aB[(Os=(Ei=this.prevPlacement)===null||Ei===void 0?void 0:Ei.variableOffsets[mr.crossTileID])===null||Os===void 0?void 0:Os.anchor];const Io=(Do,Og,Cd)=>{const Rg=Do.x2-Do.x1,nc=Do.y2-Do.y1,$c=mr.textBoxScale,Bg=on&&jt==="never"?Og:null;let Ec=null,hh=At==="never"?1:2,Sd="never";oa&&hh++;for(let Lm=0;Lm<hh;Lm++){for(let pf=ch;pf<td;pf++){const Pm=x.textAnchorOffsets.get(pf);if(oa&&Pm.textAnchor!==oa)continue;const Sp=this.attemptAnchorPlacement(Pm,Do,Rg,nc,$c,en,mn,fe,sr,Z,Qe,Sd,mr,x,Cd,N,$,Bg,tr);if(Sp&&(Ec=Sp.placedGlyphBoxes,Ec&&Ec.placeable))return Rs=!0,Ji=Sp.shift,Ec}oa?oa=null:Sd=At}return g&&!Ec&&(Ec={box:this.collisionIndex.placeCollisionBox(tc,"always",fe,sr,Z,mn,en,N,Qe.predicate,tr,void 0,Or).box,offscreen:!1,placeable:!1,occluded:!1}),Ec};ed(()=>Io(tc,ti.iconBox,o.al.horizontal),()=>{const Do=ti.verticalTextBox;return x.allowVerticalPlacement&&(!hs||!hs.placeable)&&mr.numVerticalGlyphVertices>0&&Do?Io(Do,ti.verticalIconBox,o.al.vertical):{box:null,occluded:!0,offscreen:null}}),hs&&(Rs=hs.placeable,po=hs.offscreen);const ga=Wl(hs&&hs.placeable);if(!Rs&&this.prevPlacement){const Do=this.prevPlacement.variableOffsets[mr.crossTileID];Do&&(this.variableOffsets[mr.crossTileID]=Do,this.markUsedJustification(x,Do.anchor,mr,ga))}}}if(sa=hs,Rs=sa&&sa.placeable,po=sa&&sa.offscreen,mr.useRuntimeCollisionCircles){const Wl=x.text.placedSymbolArray.get(mr.centerJustifiedTextSymbolIndex),ed=o.am(x.textSizeData,Ke,Wl),ch=A.get("text-padding");Zo=this.collisionIndex.placeCollisionCircles(At,Wl,x.lineVertexArray,x.glyphOffsetArray,ed,Z,re,g,mn,Qe.predicate,mr.collisionCircleDiameter,ch,N,tr),Zo.circles.length&&Zo.collisionDetected&&!g&&o.w("Collisions detected, but collision boxes are not shown"),Rs=Rt||Zo.circles.length>0&&!Zo.collisionDetected,po=po&&Zo.offscreen}if(ti.iconFeatureIndex&&(ju=ti.iconFeatureIndex),ti.iconBox){const Wl=ed=>this.collisionIndex.placeCollisionBox(ed,jt,fe,sr,Z,mn,en,$,Qe.predicate,tr,on&&Ji?Ji:void 0,Or);ko&&ko.placeable&&ti.verticalIconBox?(bo=Wl(ti.verticalIconBox),fo=bo.placeable):(bo=Wl(ti.iconBox),fo=bo.placeable),po=po&&bo.offscreen}const ul=Tt||mr.numHorizontalGlyphVertices===0&&mr.numVerticalGlyphVertices===0,Qh=Ct||mr.numIconVertices===0;ul||Qh?Qh?ul||(fo=fo&&Rs):Rs=fo&&Rs:fo=Rs=fo&&Rs;const ql=fo&&bo.placeable;if(Rs&&sa.placeable&&this.collisionIndex.insertCollisionBox(sa.box,At,A.get("text-ignore-placement"),x.bucketInstanceId,ko&&ko.placeable&&Hl?Hl:Wa,Qe.ID),ql&&this.collisionIndex.insertCollisionBox(bo.box,jt,A.get("icon-ignore-placement"),x.bucketInstanceId,ju,Qe.ID),Zo&&Rs&&this.collisionIndex.insertCollisionCircles(Zo.circles,At,A.get("text-ignore-placement"),x.bucketInstanceId,Wa,Qe.ID),g&&this.storeCollisionData(x.bucketInstanceId,wi,ti,sa,bo,Zo),mr.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(x.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[mr.crossTileID]=new Au((Rs||jn)&&!(sa!=null&&sa.occluded),(fo||In)&&!(bo!=null&&bo.occluded),po||x.justReloaded),c[mr.crossTileID]=!0};if(On){if(s.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const mr=x.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let ti=mr.length-1;ti>=0;--ti){const wi=mr[ti];Sr(x.symbolInstances.get(wi),x.collisionArrays[wi],wi)}}else for(let mr=s.symbolInstanceStart;mr<s.symbolInstanceEnd;mr++)Sr(x.symbolInstances.get(mr),x.collisionArrays[mr],mr);x.justReloaded=!1}storeCollisionData(s,c,g,x,A,N){if(g.textBox||g.iconBox){let $,Z;this.collisionBoxArrays.has(s)?$=this.collisionBoxArrays.get(s):($=new Map,this.collisionBoxArrays.set(s,$)),$.has(c)?Z=$.get(c):(Z={text:null,icon:null},$.set(c,Z)),g.textBox&&(Z.text=x.box),g.iconBox&&(Z.icon=A.box)}if(N){let $=this.collisionCircleArrays[s];$===void 0&&($=this.collisionCircleArrays[s]=[]);for(let Z=0;Z<N.circles.length;Z+=4)$.push(N.circles[Z+0]-ao),$.push(N.circles[Z+1]-ao),$.push(N.circles[Z+2]),$.push(N.collisionDetected?1:0)}}markUsedJustification(s,c,g,x){let A;A=x===o.al.vertical?g.verticalPlacedTextSymbolIndex:{left:g.leftJustifiedTextSymbolIndex,center:g.centerJustifiedTextSymbolIndex,right:g.rightJustifiedTextSymbolIndex}[o.aD(c)];const N=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex,g.verticalPlacedTextSymbolIndex];for(const $ of N)$>=0&&(s.text.placedSymbolArray.get($).crossTileID=A>=0&&$!==A?0:g.crossTileID)}markUsedOrientation(s,c,g){const x=c===o.al.horizontal||c===o.al.horizontalOnly?c:0,A=c===o.al.vertical?c:0,N=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex];for(const $ of N)s.text.placedSymbolArray.get($).placedOrientation=x;g.verticalPlacedTextSymbolIndex&&(s.text.placedSymbolArray.get(g.verticalPlacedTextSymbolIndex).placedOrientation=A)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let g=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const x=c?c.symbolFadeChange(s):1,A=c?c.opacities:{},N=c?c.variableOffsets:{},$=c?c.placedOrientations:{};for(const Z in this.placements){const re=this.placements[Z],fe=A[Z];fe?(this.opacities[Z]=new el(fe,x,re.text,re.icon),g=g||re.text!==fe.text.placed||re.icon!==fe.icon.placed):(this.opacities[Z]=new el(null,x,re.text,re.icon,re.skipFade),g=g||re.text||re.icon)}for(const Z in A){const re=A[Z];if(!this.opacities[Z]){const fe=new el(re,x,!1,!1);fe.isHidden()||(this.opacities[Z]=fe,g=g||re.text.placed||re.icon.placed)}}for(const Z in N)this.variableOffsets[Z]||!this.opacities[Z]||this.opacities[Z].isHidden()||(this.variableOffsets[Z]=N[Z]);for(const Z in $)this.placedOrientations[Z]||!this.opacities[Z]||this.opacities[Z].isHidden()||(this.placedOrientations[Z]=$[Z]);if(c&&c.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");g?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:s)}updateLayerOpacities(s,c){const g={};for(const x of c){const A=x.getBucket(s);A&&x.latestFeatureIndex&&s.id===A.layerIds[0]&&this.updateBucketOpacities(A,x.tileID,g,x.collisionBoxArray)}}updateBucketOpacities(s,c,g,x){s.hasTextData()&&(s.text.opacityVertexArray.clear(),s.text.hasVisibleVertices=!1),s.hasIconData()&&(s.icon.opacityVertexArray.clear(),s.icon.hasVisibleVertices=!1),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();const A=s.layers[0],N=A.layout,$=new el(null,0,!1,!1,!0),Z=N.get("text-allow-overlap"),re=N.get("icon-allow-overlap"),fe=A._unevaluatedLayout.hasValue("text-variable-anchor")||A._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Me=N.get("text-rotation-alignment")==="map",ke=N.get("text-pitch-alignment")==="map",Ke=N.get("icon-text-fit")!=="none",Qe=new el(null,0,Z&&(re||!s.hasIconData()||N.get("icon-optional")),re&&(Z||!s.hasTextData()||N.get("text-optional")),!0);!s.collisionArrays&&x&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(x);const Tt=(At,Rt,jt)=>{for(let Vt=0;Vt<Rt/4;Vt++)At.opacityVertexArray.emplaceBack(jt);At.hasVisibleVertices=At.hasVisibleVertices||jt!==Ua},Ct=this.collisionBoxArrays.get(s.bucketInstanceId);for(let At=0;At<s.symbolInstances.length;At++){const Rt=s.symbolInstances.get(At),{numHorizontalGlyphVertices:jt,numVerticalGlyphVertices:Vt,crossTileID:en}=Rt;let mn=this.opacities[en];g[en]?mn=$:mn||(mn=Qe,this.opacities[en]=mn),g[en]=!0;const on=Rt.numIconVertices>0,On=this.placedOrientations[Rt.crossTileID],jn=On===o.al.vertical,In=On===o.al.horizontal||On===o.al.horizontalOnly;if(jt>0||Vt>0){const tr=is(mn.text);Tt(s.text,jt,jn?Ua:tr),Tt(s.text,Vt,In?Ua:tr);const Or=mn.text.isHidden();[Rt.rightJustifiedTextSymbolIndex,Rt.centerJustifiedTextSymbolIndex,Rt.leftJustifiedTextSymbolIndex].forEach(ti=>{ti>=0&&(s.text.placedSymbolArray.get(ti).hidden=Or||jn?1:0)}),Rt.verticalPlacedTextSymbolIndex>=0&&(s.text.placedSymbolArray.get(Rt.verticalPlacedTextSymbolIndex).hidden=Or||In?1:0);const Sr=this.variableOffsets[Rt.crossTileID];Sr&&this.markUsedJustification(s,Sr.anchor,Rt,On);const mr=this.placedOrientations[Rt.crossTileID];mr&&(this.markUsedJustification(s,"left",Rt,mr),this.markUsedOrientation(s,mr,Rt))}if(on){const tr=is(mn.icon),Or=!(Ke&&Rt.verticalPlacedIconSymbolIndex&&jn);Rt.placedIconSymbolIndex>=0&&(Tt(s.icon,Rt.numIconVertices,Or?tr:Ua),s.icon.placedSymbolArray.get(Rt.placedIconSymbolIndex).hidden=mn.icon.isHidden()),Rt.verticalPlacedIconSymbolIndex>=0&&(Tt(s.icon,Rt.numVerticalIconVertices,Or?Ua:tr),s.icon.placedSymbolArray.get(Rt.verticalPlacedIconSymbolIndex).hidden=mn.icon.isHidden())}const sr=Ct&&Ct.has(At)?Ct.get(At):{text:null,icon:null};if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){const tr=s.collisionArrays[At];if(tr){let Or=new o.P(0,0);if(tr.textBox||tr.verticalTextBox){let Sr=!0;if(fe){const mr=this.variableOffsets[en];mr?(Or=Cc(mr.anchor,mr.width,mr.height,mr.textOffset,mr.textBoxScale),Me&&Or._rotate(ke?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Sr=!1}if(tr.textBox||tr.verticalTextBox){let mr;tr.textBox&&(mr=jn),tr.verticalTextBox&&(mr=In),ja(s.textCollisionBox.collisionVertexArray,mn.text.placed,!Sr||mr,sr.text,Or.x,Or.y)}}if(tr.iconBox||tr.verticalIconBox){const Sr=!!(!In&&tr.verticalIconBox);let mr;tr.iconBox&&(mr=Sr),tr.verticalIconBox&&(mr=!Sr),ja(s.iconCollisionBox.collisionVertexArray,mn.icon.placed,mr,sr.icon,Ke?Or.x:0,Ke?Or.y:0)}}}}if(s.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.text.opacityVertexArray.length!==s.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${s.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${s.text.layoutVertexArray.length}) / 4`);if(s.icon.opacityVertexArray.length!==s.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${s.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${s.icon.layoutVertexArray.length}) / 4`);s.bucketInstanceId in this.collisionCircleArrays&&(s.collisionCircleArray=this.collisionCircleArrays[s.bucketInstanceId],delete this.collisionCircleArrays[s.bucketInstanceId])}symbolFadeChange(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,c){const g=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*g>s}setStale(){this.stale=!0}}function ja(E,s,c,g,x,A){g&&g.length!==0||(g=[0,0,0,0]);const N=g[0]-ao,$=g[1]-ao,Z=g[2]-ao,re=g[3]-ao;E.emplaceBack(s?1:0,c?1:0,x||0,A||0,N,$),E.emplaceBack(s?1:0,c?1:0,x||0,A||0,Z,$),E.emplaceBack(s?1:0,c?1:0,x||0,A||0,Z,re),E.emplaceBack(s?1:0,c?1:0,x||0,A||0,N,re)}const ds=Math.pow(2,25),Di=Math.pow(2,24),Xu=Math.pow(2,17),lu=Math.pow(2,16),gl=Math.pow(2,9),Ju=Math.pow(2,8),ki=Math.pow(2,1);function is(E){if(E.opacity===0&&!E.placed)return 0;if(E.opacity===1&&E.placed)return 4294967295;const s=E.placed?1:0,c=Math.floor(127*E.opacity);return c*ds+s*Di+c*Xu+s*lu+c*gl+s*Ju+c*ki+s}const Ua=0;class Bo{constructor(s){this._sortAcrossTiles=s.layout.get("symbol-z-order")!=="viewport-y"&&!s.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(s,c,g,x,A){const N=this._bucketParts;for(;this._currentTileIndex<s.length;)if(c.getBucketParts(N,x,s[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,A())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,N.sort(($,Z)=>$.sortKey-Z.sortKey));this._currentPartIndex<N.length;)if(c.placeLayerBucketPart(N[this._currentPartIndex],this._seenCrossTileIDs,g),this._currentPartIndex++,A())return!0;return!1}}class Co{constructor(s,c,g,x,A,N,$,Z){this.placement=new Yu(s,c,N,$,Z),this._currentPlacementIndex=g.length-1,this._forceFullPlacement=x,this._showCollisionBoxes=A,this._done=!1}isDone(){return this._done}continuePlacement(s,c,g){const x=M.now(),A=()=>!this._forceFullPlacement&&M.now()-x>2;for(;this._currentPlacementIndex>=0;){const N=c[s[this._currentPlacementIndex]],$=this.placement.collisionIndex.transform.zoom;if(N.type==="symbol"&&(!N.minzoom||N.minzoom<=$)&&(!N.maxzoom||N.maxzoom>$)){if(this._inProgressLayer||(this._inProgressLayer=new Bo(N)),this._inProgressLayer.continuePlacement(g[N.source],this.placement,this._showCollisionBoxes,N,A))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}const ku=512/o.Z/2;class yl{constructor(s,c,g){this.tileID=s,this.bucketInstanceId=g,this._symbolsByKey={};const x=new Map;for(let A=0;A<c.length;A++){const N=c.get(A),$=N.key,Z=x.get($);Z?Z.push(N):x.set($,[N])}for(const[A,N]of x){const $={positions:N.map(Z=>({x:Math.floor(Z.anchorX*ku),y:Math.floor(Z.anchorY*ku)})),crossTileIDs:N.map(Z=>Z.crossTileID)};if($.positions.length>128){const Z=new o.aF($.positions.length,16,Uint16Array);for(const{x:re,y:fe}of $.positions)Z.add(re,fe);Z.finish(),delete $.positions,$.index=Z}this._symbolsByKey[A]=$}}getScaledCoordinates(s,c){const{x:g,y:x,z:A}=this.tileID.canonical,{x:N,y:$,z:Z}=c.canonical,re=ku/Math.pow(2,Z-A),fe=($*o.Z+s.anchorY)*re,Me=x*o.Z*ku;return{x:Math.floor((N*o.Z+s.anchorX)*re-g*o.Z*ku),y:Math.floor(fe-Me)}}findMatches(s,c,g){const x=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z);for(let A=0;A<s.length;A++){const N=s.get(A);if(N.crossTileID)continue;const $=this._symbolsByKey[N.key];if(!$)continue;const Z=this.getScaledCoordinates(N,c);if($.index){const re=$.index.range(Z.x-x,Z.y-x,Z.x+x,Z.y+x).sort();for(const fe of re){const Me=$.crossTileIDs[fe];if(!g[Me]){g[Me]=!0,N.crossTileID=Me;break}}}else if($.positions)for(let re=0;re<$.positions.length;re++){const fe=$.positions[re],Me=$.crossTileIDs[re];if(Math.abs(fe.x-Z.x)<=x&&Math.abs(fe.y-Z.y)<=x&&!g[Me]){g[Me]=!0,N.crossTileID=Me;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:s})=>s)}}class uu{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class lo{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){const c=Math.round((s-this.lng)/360);if(c!==0)for(const g in this.indexes){const x=this.indexes[g],A={};for(const N in x){const $=x[N];$.tileID=$.tileID.unwrapTo($.tileID.wrap+c),A[$.tileID.key]=$}this.indexes[g]=A}this.lng=s}addBucket(s,c,g){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let A=0;A<c.symbolInstances.length;A++)c.symbolInstances.get(A).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]={});const x=this.usedCrossTileIDs[s.overscaledZ];for(const A in this.indexes){const N=this.indexes[A];if(Number(A)>s.overscaledZ)for(const $ in N){const Z=N[$];Z.tileID.isChildOf(s)&&Z.findMatches(c.symbolInstances,s,x)}else{const $=N[s.scaledTo(Number(A)).key];$&&$.findMatches(c.symbolInstances,s,x)}}for(let A=0;A<c.symbolInstances.length;A++){const N=c.symbolInstances.get(A);N.crossTileID||(N.crossTileID=g.generate(),x[N.crossTileID]=!0)}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new yl(s,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(s,c){for(const g of c.getCrossTileIDsLists())for(const x of g)delete this.usedCrossTileIDs[s][x]}removeStaleBuckets(s){let c=!1;for(const g in this.indexes){const x=this.indexes[g];for(const A in x)s[x[A].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,x[A]),delete x[A],c=!0)}return c}}class So{constructor(){this.layerIndexes={},this.crossTileIDs=new uu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,c,g){let x=this.layerIndexes[s.id];x===void 0&&(x=this.layerIndexes[s.id]=new lo);let A=!1;const N={};x.handleWrapJump(g);for(const $ of c){const Z=$.getBucket(s);Z&&s.id===Z.layerIds[0]&&(Z.bucketInstanceId||(Z.bucketInstanceId=++this.maxBucketInstanceId),x.addBucket($.tileID,Z,this.crossTileIDs)&&(A=!0),N[Z.bucketInstanceId]=!0)}return x.removeStaleBuckets(N)&&(A=!0),A}pruneUnusedLayers(s){const c={};s.forEach(g=>{c[g]=!0});for(const g in this.layerIndexes)c[g]||delete this.layerIndexes[g]}}var tl="void main() {fragColor=vec4(1.0);}";const ui={prelude:ji(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:ji("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:ji("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:ji(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:ji(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:ji(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:ji(tl,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:ji(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:ji(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:ji("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ji("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:ji("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:ji(tl,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:ji(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:ji(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:ji(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:ji(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:ji(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:ji(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:ji(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));fragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ji(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:ji(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:ji(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:ji(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:ji(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:ji(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:ji(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:ji(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:ji(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:ji("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:ji("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:ji("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:ji("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:ji(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:ji("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function ji(E,s){const c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=s.match(/in ([\w]+) ([\w]+)/g),x=E.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),A=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),N=A?A.concat(x):x,$={};return{fragmentSource:E=E.replace(c,(Z,re,fe,Me,ke)=>($[ke]=!0,re==="define"?`
#ifndef HAS_UNIFORM_u_${ke}
in ${fe} ${Me} ${ke};
#else
uniform ${fe} ${Me} u_${ke};
#endif
`:`
#ifdef HAS_UNIFORM_u_${ke}
    ${fe} ${Me} ${ke} = u_${ke};
#endif
`)),vertexSource:s=s.replace(c,(Z,re,fe,Me,ke)=>{const Ke=Me==="float"?"vec2":"vec4",Qe=ke.match(/color/)?"color":Ke;return $[ke]?re==="define"?`
#ifndef HAS_UNIFORM_u_${ke}
uniform lowp float u_${ke}_t;
in ${fe} ${Ke} a_${ke};
out ${fe} ${Me} ${ke};
#else
uniform ${fe} ${Me} u_${ke};
#endif
`:Qe==="vec4"?`
#ifndef HAS_UNIFORM_u_${ke}
    ${ke} = a_${ke};
#else
    ${fe} ${Me} ${ke} = u_${ke};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ke}
    ${ke} = unpack_mix_${Qe}(a_${ke}, u_${ke}_t);
#else
    ${fe} ${Me} ${ke} = u_${ke};
#endif
`:re==="define"?`
#ifndef HAS_UNIFORM_u_${ke}
uniform lowp float u_${ke}_t;
in ${fe} ${Ke} a_${ke};
#else
uniform ${fe} ${Me} u_${ke};
#endif
`:Qe==="vec4"?`
#ifndef HAS_UNIFORM_u_${ke}
    ${fe} ${Me} ${ke} = a_${ke};
#else
    ${fe} ${Me} ${ke} = u_${ke};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ke}
    ${fe} ${Me} ${ke} = unpack_mix_${Qe}(a_${ke}, u_${ke}_t);
#else
    ${fe} ${Me} ${ke} = u_${ke};
#endif
`}),staticAttributes:g,staticUniforms:N}}class nl{constructor(s,c,g){this.vertexBuffer=s,this.indexBuffer=c,this.segments=g}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var rl=o.aG([{name:"a_pos",type:"Int16",components:2}]);const Ws="#define PROJECTION_MERCATOR",Zs="mercator";class Ms{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Zs}get shaderDefine(){return Ws}get shaderPreludeCode(){return ui.projectionMercator}get vertexShaderPreludeCode(){return ui.projectionMercator.vertexSource}get subdivisionGranularity(){return o.aH.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(s){}getMeshFromTileID(s,c,g,x,A){if(this._cachedMesh)return this._cachedMesh;const N=new o.aI;N.emplaceBack(0,0),N.emplaceBack(o.Z,0),N.emplaceBack(0,o.Z),N.emplaceBack(o.Z,o.Z);const $=s.createVertexBuffer(N,rl.members),Z=o.aJ.simpleSegment(0,0,4,2),re=new o.aK;re.emplaceBack(1,0,2),re.emplaceBack(1,2,3);const fe=s.createIndexBuffer(re);return this._cachedMesh=new nl($,fe,Z),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(s){}}class cu{constructor(s=0,c=0,g=0,x=0){if(isNaN(s)||s<0||isNaN(c)||c<0||isNaN(g)||g<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=c,this.left=g,this.right=x}interpolate(s,c,g){return c.top!=null&&s.top!=null&&(this.top=o.B.number(s.top,c.top,g)),c.bottom!=null&&s.bottom!=null&&(this.bottom=o.B.number(s.bottom,c.bottom,g)),c.left!=null&&s.left!=null&&(this.left=o.B.number(s.left,c.left,g)),c.right!=null&&s.right!=null&&(this.right=o.B.number(s.right,c.right,g)),this}getCenter(s,c){const g=o.ae((this.left+s-this.right)/2,0,s),x=o.ae((this.top+c-this.bottom)/2,0,c);return new o.P(g,x)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new cu(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function us(E,s){if(!E.renderWorldCopies||E.lngRange)return;const c=s.lng-E.center.lng;s.lng+=c>180?-360:c<-180?360:0}function La(E){return Math.max(0,Math.floor(E))}class Lo{constructor(s,c,g,x,A,N){this._callbacks=s,this._tileSize=512,this._renderWorldCopies=N===void 0||!!N,this._minZoom=c||0,this._maxZoom=g||22,this._minPitch=x??0,this._maxPitch=A??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new o.Q(0,0),this._elevation=0,this._zoom=0,this._tileZoom=La(this._zoom),this._scale=o.ac(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new cu,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(s,c,g){this._latRange=s.latRange,this._lngRange=s.lngRange,this._width=s.width,this._height=s.height,this._center=s.center,this._elevation=s.elevation,this._minElevationForCurrentTile=s.minElevationForCurrentTile,this._zoom=s.zoom,this._tileZoom=La(this._zoom),this._scale=o.ac(this._zoom),this._bearingInRadians=s.bearingInRadians,this._fovInRadians=s.fovInRadians,this._pitchInRadians=s.pitchInRadians,this._rollInRadians=s.rollInRadians,this._unmodified=s.unmodified,this._edgeInsets=new cu(s.padding.top,s.padding.bottom,s.padding.left,s.padding.right),this._minZoom=s.minZoom,this._maxZoom=s.maxZoom,this._minPitch=s.minPitch,this._maxPitch=s.maxPitch,this._renderWorldCopies=s.renderWorldCopies,this._cameraToCenterDistance=s.cameraToCenterDistance,this._nearZ=s.nearZ,this._farZ=s.farZ,this._autoCalculateNearFarZ=!g&&s.autoCalculateNearFarZ,c&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(s){this._minElevationForCurrentTile=s}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(s){this._minZoom!==s&&(this._minZoom=s,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(s){this._minPitch!==s&&(this._minPitch=s,this.setPitch(Math.max(this.pitch,s)))}get maxPitch(){return this._maxPitch}setMaxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.setPitch(Math.min(this.pitch,s)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(s){const c=o.aL(s,-180,180)*Math.PI/180;var g,x,A,N,$,Z,re,fe,Me;this._bearingInRadians!==c&&(this._unmodified=!1,this._bearingInRadians=c,this._calcMatrices(),this._rotationMatrix=m(),g=this._rotationMatrix,A=-this._bearingInRadians,N=(x=this._rotationMatrix)[0],$=x[1],Z=x[2],re=x[3],fe=Math.sin(A),Me=Math.cos(A),g[0]=N*Me+Z*fe,g[1]=$*Me+re*fe,g[2]=N*-fe+Z*Me,g[3]=$*-fe+re*Me)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(s){const c=o.ae(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==c&&(this._unmodified=!1,this._pitchInRadians=c,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(s){const c=s/180*Math.PI;this._rollInRadians!==c&&(this._unmodified=!1,this._rollInRadians=c,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return o.aM(this._fovInRadians)}setFov(s){s=o.ae(s,.1,150),this.fov!==s&&(this._unmodified=!1,this._fovInRadians=o.ab(s),this._calcMatrices())}get zoom(){return this._zoom}setZoom(s){const c=this.getConstrained(this._center,s).zoom;this._zoom!==c&&(this._unmodified=!1,this._zoom=c,this._tileZoom=Math.max(0,Math.floor(c)),this._scale=o.ac(c),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(s){s!==this._elevation&&(this._elevation=s,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(s,c){this._autoCalculateNearFarZ=!1,this._nearZ=s,this._farZ=c,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,c,g){this._unmodified=!1,this._edgeInsets.interpolate(s,c,g),this._constrain(),this._calcMatrices()}resize(s,c,g=!0){this._width=s,this._height=c,g&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Ae([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(s){s?(this._lngRange=[s.getWest(),s.getEast()],this._latRange=[s.getSouth(),s.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,o.af])}getConstrained(s,c){return this._callbacks.getConstrained(s,c)}getCameraQueryGeometry(s,c){if(c.length===1)return[c[0],s];{let g=s.x,x=s.y,A=s.x,N=s.y;for(const $ of c)g=Math.min(g,$.x),x=Math.min(x,$.y),A=Math.max(A,$.x),N=Math.max(N,$.y);return[new o.P(g,x),new o.P(A,x),new o.P(A,N),new o.P(g,N),new o.P(g,x)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const s=this._unmodified,{center:c,zoom:g}=this.getConstrained(this.center,this.zoom);this.setCenter(c),this.setZoom(g),this._unmodified=s,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let s=o.ad(new Float64Array(16));o.M(s,s,[this._width/2,-this._height/2,1]),o.L(s,s,[1,-1,0]),this._clipSpaceToPixelsMatrix=s,s=o.ad(new Float64Array(16)),o.M(s,s,[1,-1,1]),o.L(s,s,[-1,-1,0]),o.M(s,s,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=s,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(s,c,g,x){const A=g!==void 0?g:this.bearing,N=x=x!==void 0?x:this.pitch,$=o.$.fromLngLat(s,c),Z=-Math.cos(o.ab(N)),re=Math.sin(o.ab(N)),fe=re*Math.sin(o.ab(A)),Me=-re*Math.cos(o.ab(A));let ke=this.elevation;const Ke=c-ke;let Qe;Z*Ke>=0||Math.abs(Z)<.1?(Qe=1e4,ke=c+Qe*Z):Qe=-Ke/Z;let Tt,Ct,At=o.aN(1,$.y),Rt=0;do{if(Rt+=1,Rt>10)break;Ct=Qe/At,Tt=new o.$($.x+fe*Ct,$.y+Me*Ct),At=1/Tt.meterInMercatorCoordinateUnits()}while(Math.abs(Qe-Ct*At)>1e-12);return{center:Tt.toLngLat(),elevation:ke,zoom:o.ah(this.height/2/Math.tan(this.fovInRadians/2)/Ct/this.tileSize)}}recalculateZoomAndCenter(s){if(this.elevation-s==0)return;const c=o.ag(1,this.center.lat)*this.worldSize,g=this.cameraToCenterDistance/c,x=o.$.fromLngLat(this.center,this.elevation),A=Ze(this.center,this.elevation,this.pitch,this.bearing,g);this._elevation=s;const N=this.calculateCenterFromCameraLngLatAlt(A.toLngLat(),o.aN(A.z,x.y),this.bearing,this.pitch);this._elevation=N.elevation,this._center=N.center,this.setZoom(N.zoom)}getCameraPoint(){const s=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(s*Math.sin(this.rollInRadians),s*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const s=o.ag(1,this.center.lat)*this.worldSize;return Ze(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/s).toLngLat()}getMercatorTileCoordinates(s){if(!s)return[0,0,1,1];const c=s.canonical.z>=0?1<<s.canonical.z:Math.pow(2,s.canonical.z);return[s.canonical.x/c,s.canonical.y/c,1/c/o.Z,1/c/o.Z]}}class yi{constructor(s,c){this.min=s,this.max=c,this.center=o.aO([],o.aP([],this.min,this.max),.5)}quadrant(s){const c=[s%2==0,s<2],g=o.aQ(this.min),x=o.aQ(this.max);for(let A=0;A<c.length;A++)g[A]=c[A]?this.min[A]:this.center[A],x[A]=c[A]?this.center[A]:this.max[A];return x[2]=this.max[2],new yi(g,x)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}intersectsFrustum(s){let c=!0;for(let g=0;g<s.planes.length;g++){const x=this.intersectsPlane(s.planes[g]);if(x===0)return 0;x===1&&(c=!1)}return c?2:s.aabb.min[0]>this.max[0]||s.aabb.min[1]>this.max[1]||s.aabb.min[2]>this.max[2]||s.aabb.max[0]<this.min[0]||s.aabb.max[1]<this.min[1]||s.aabb.max[2]<this.min[2]?0:1}intersectsPlane(s){let c=s[3],g=s[3];for(let x=0;x<3;x++)s[x]>0?(c+=s[x]*this.min[x],g+=s[x]*this.max[x]):(g+=s[x]*this.min[x],c+=s[x]*this.max[x]);return c>=0?2:g<0?0:1}}class Mi{distanceToTile2d(s,c,g,x){const A=x.distanceX([s,c]),N=x.distanceY([s,c]);return Math.hypot(A,N)}getWrap(s,c,g){return g}getTileAABB(s,c,g,x){var A,N;let $=g,Z=g;if(x.terrain){const fe=new o.Y(s.z,c,s.z,s.x,s.y),Me=x.terrain.getMinMaxElevation(fe);$=(A=Me.minElevation)!==null&&A!==void 0?A:g,Z=(N=Me.maxElevation)!==null&&N!==void 0?N:g}const re=1<<s.z;return new yi([c+s.x/re,s.y/re,$],[c+(s.x+1)/re,(s.y+1)/re,Z])}allowVariableZoom(s,c){const g=s.fov*(Math.abs(Math.cos(s.rollInRadians))*s.height+Math.abs(Math.sin(s.rollInRadians))*s.width)/s.height,x=o.ae(78.5-g/2,0,60);return!!c.terrain||s.pitch>x}allowWorldCopies(){return!0}recalculateCache(){}}class fs{constructor(s,c,g){this.points=s,this.planes=c,this.aabb=g}static fromInvProjectionMatrix(s,c=1,g=0){const x=Math.pow(2,g),A=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(re=>{const fe=1/(re=o.at([],re,s))[3]/c*x;return o.aR(re,re,[fe,fe,1/re[3],fe])}),N=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(re=>{const fe=o.aS([],A[re[0]],A[re[1]]),Me=o.aS([],A[re[2]],A[re[1]]),ke=o.aT([],o.aU([],fe,Me)),Ke=-o.aV(ke,A[re[1]]);return ke.concat(Ke)}),$=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],Z=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const re of A)for(let fe=0;fe<3;fe++)$[fe]=Math.min($[fe],re[fe]),Z[fe]=Math.max(Z[fe],re[fe]);return new fs(A,N,new yi($,Z))}}class Bi{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(s){this._helper.setMinZoom(s)}setMaxZoom(s){this._helper.setMaxZoom(s)}setMinPitch(s){this._helper.setMinPitch(s)}setMaxPitch(s){this._helper.setMaxPitch(s)}setRenderWorldCopies(s){this._helper.setRenderWorldCopies(s)}setBearing(s){this._helper.setBearing(s)}setPitch(s){this._helper.setPitch(s)}setRoll(s){this._helper.setRoll(s)}setFov(s){this._helper.setFov(s)}setZoom(s){this._helper.setZoom(s)}setCenter(s){this._helper.setCenter(s)}setElevation(s){this._helper.setElevation(s)}setMinElevationForCurrentTile(s){this._helper.setMinElevationForCurrentTile(s)}setPadding(s){this._helper.setPadding(s)}interpolatePadding(s,c,g){return this._helper.interpolatePadding(s,c,g)}isPaddingEqual(s){return this._helper.isPaddingEqual(s)}resize(s,c,g=!0){this._helper.resize(s,c,g)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(s){this._helper.setMaxBounds(s)}overrideNearFarZ(s,c){this._helper.overrideNearFarZ(s,c)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(s){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),s)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(s,c){}constructor(s,c,g,x,A){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Lo({calcMatrices:()=>{this._calcMatrices()},getConstrained:(N,$)=>this.getConstrained(N,$)},s,c,g,x,A),this._coveringTilesDetailsProvider=new Mi}clone(){const s=new Bi;return s.apply(this),s}apply(s,c,g){this._helper.apply(s,c,g)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(s){const c=[new o.aW(0,s)];if(this._helper._renderWorldCopies){const g=this.screenPointToMercatorCoordinate(new o.P(0,0)),x=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,0)),A=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,this._helper._height)),N=this.screenPointToMercatorCoordinate(new o.P(0,this._helper._height)),$=Math.floor(Math.min(g.x,x.x,A.x,N.x)),Z=Math.floor(Math.max(g.x,x.x,A.x,N.x)),re=1;for(let fe=$-re;fe<=Z+re;fe++)fe!==0&&c.push(new o.aW(fe,s))}return c}getCameraFrustum(){return fs.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(s){const c=this.screenPointToLocation(this.centerPoint,s),g=s?s.getElevationForLngLatZoom(c,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(g)}setLocationAtPoint(s,c){const g=o.ag(this.elevation,this.center.lat),x=this.screenPointToMercatorCoordinateAtZ(c,g),A=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,g),N=o.$.fromLngLat(s),$=new o.$(N.x-(x.x-A.x),N.y-(x.y-A.y));this.setCenter($==null?void 0:$.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(s,c){return c?this.coordinatePoint(o.$.fromLngLat(s),c.getElevationForLngLatZoom(s,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(o.$.fromLngLat(s))}screenPointToLocation(s,c){var g;return(g=this.screenPointToMercatorCoordinate(s,c))===null||g===void 0?void 0:g.toLngLat()}screenPointToMercatorCoordinate(s,c){if(c){const g=c.pointCoordinate(s);if(g!=null)return g}return this.screenPointToMercatorCoordinateAtZ(s)}screenPointToMercatorCoordinateAtZ(s,c){const g=c||0,x=[s.x,s.y,0,1],A=[s.x,s.y,1,1];o.at(x,x,this._pixelMatrixInverse),o.at(A,A,this._pixelMatrixInverse);const N=x[3],$=A[3],Z=x[1]/N,re=A[1]/$,fe=x[2]/N,Me=A[2]/$,ke=fe===Me?0:(g-fe)/(Me-fe);return new o.$(o.B.number(x[0]/N,A[0]/$,ke)/this.worldSize,o.B.number(Z,re,ke)/this.worldSize,g)}coordinatePoint(s,c=0,g=this._pixelMatrix){const x=[s.x*this.worldSize,s.y*this.worldSize,c,1];return o.at(x,x,g),new o.P(x[0]/x[3],x[1]/x[3])}getBounds(){const s=Math.max(0,this._helper._height/2-Ft(this));return new Ae().extend(this.screenPointToLocation(new o.P(0,s))).extend(this.screenPointToLocation(new o.P(this._helper._width,s))).extend(this.screenPointToLocation(new o.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new o.P(0,this._helper._height)))}isPointOnMapSurface(s,c){return c?c.pointCoordinate(s)!=null:s.y>this.height/2-Ft(this)}calculatePosMatrix(s,c=!1,g){var x;const A=(x=s.key)!==null&&x!==void 0?x:o.aX(s.wrap,s.canonical.z,s.canonical.z,s.canonical.x,s.canonical.y),N=c?this._alignedPosMatrixCache:this._posMatrixCache;if(N.has(A)){const re=N.get(A);return g?re.f32:re.f64}const $=je(s,this.worldSize);o.N($,c?this._alignedProjMatrix:this._viewProjMatrix,$);const Z={f64:$,f32:new Float32Array($)};return N.set(A,Z),g?Z.f32:Z.f64}calculateFogMatrix(s){const c=s.key,g=this._fogMatrixCacheF32;if(g.has(c))return g.get(c);const x=je(s,this.worldSize);return o.N(x,this._fogMatrix,x),g.set(c,new Float32Array(x)),g.get(c)}getConstrained(s,c){c=o.ae(+c,this.minZoom,this.maxZoom);const g={center:new o.Q(s.lng,s.lat),zoom:c};let x=this._helper._lngRange;this._helper._renderWorldCopies||x!==null||(x=[-179.9999999999,180-1e-10]);const A=this.tileSize*o.ac(g.zoom);let N=0,$=A,Z=0,re=A,fe=0,Me=0;const{x:ke,y:Ke}=this.size;if(this._helper._latRange){const jt=this._helper._latRange;N=o.S(jt[1])*A,$=o.S(jt[0])*A,$-N<Ke&&(fe=Ke/($-N))}x&&(Z=o.aL(o.U(x[0])*A,0,A),re=o.aL(o.U(x[1])*A,0,A),re<Z&&(re+=A),re-Z<ke&&(Me=ke/(re-Z)));const{x:Qe,y:Tt}=ir(A,s);let Ct,At;const Rt=Math.max(Me||0,fe||0);if(Rt){const jt=new o.P(Me?(re+Z)/2:Qe,fe?($+N)/2:Tt);return g.center=Fr(A,jt).wrap(),g.zoom+=o.ah(Rt),g}if(this._helper._latRange){const jt=Ke/2;Tt-jt<N&&(At=N+jt),Tt+jt>$&&(At=$-jt)}if(x){const jt=(Z+re)/2;let Vt=Qe;this._helper._renderWorldCopies&&(Vt=o.aL(Qe,jt-A/2,jt+A/2));const en=ke/2;Vt-en<Z&&(Ct=Z+en),Vt+en>re&&(Ct=re-en)}if(Ct!==void 0||At!==void 0){const jt=new o.P(Ct??Qe,At??Tt);g.center=Fr(A,jt).wrap()}return g}calculateCenterFromCameraLngLatAlt(s,c,g,x){return this._helper.calculateCenterFromCameraLngLatAlt(s,c,g,x)}_calculateNearFarZIfNeeded(s,c,g){if(!this._helper.autoCalculateNearFarZ)return;const x=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),A=s-x*this._helper._pixelPerMeter/Math.cos(c),N=x<0?A:s,$=Math.PI/2+this.pitchInRadians,Z=o.ab(this.fov)*(Math.abs(Math.cos(o.ab(this.roll)))*this.height+Math.abs(Math.sin(o.ab(this.roll)))*this.width)/this.height*(.5+g.y/this.height),re=Math.sin(Z)*N/Math.sin(o.ae(Math.PI-$-Z,.01,Math.PI-.01)),fe=Ft(this),Me=Math.atan(fe/this._helper.cameraToCenterDistance),ke=o.ab(.75),Ke=Me>ke?2*Me*(.5+g.y/(2*fe)):ke,Qe=Math.sin(Ke)*N/Math.sin(o.ae(Math.PI-$-Ke,.01,Math.PI-.01)),Tt=Math.min(re,Qe);this._helper._farZ=1.01*(Math.cos(Math.PI/2-c)*Tt+N),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const s=this.centerOffset,c=ir(this.worldSize,this.center),g=c.x,x=c.y;this._helper._pixelPerMeter=o.ag(1,this.center.lat)*this.worldSize;const A=o.ab(Math.min(this.pitch,Yn)),N=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(A));let $;this._calculateNearFarZIfNeeded(N,A,s),$=new Float64Array(16),o.aY($,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),o.an(this._invProjMatrix,$),$[8]=2*-s.x/this._helper._width,$[9]=2*s.y/this._helper._height,this._projectionMatrix=o.aZ($),o.M($,$,[1,-1,1]),o.L($,$,[0,0,-this._helper.cameraToCenterDistance]),o.a_($,$,-this.rollInRadians),o.a$($,$,this.pitchInRadians),o.a_($,$,-this.bearingInRadians),o.L($,$,[-g,-x,0]),this._mercatorMatrix=o.M([],$,[this.worldSize,this.worldSize,this.worldSize]),o.M($,$,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=o.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,$),o.L($,$,[0,0,-this.elevation]),this._viewProjMatrix=$,this._invViewProjMatrix=o.an([],$);const Z=[0,0,-1,1];o.at(Z,Z,this._invViewProjMatrix),this._cameraPosition=[Z[0]/Z[3],Z[1]/Z[3],Z[2]/Z[3]],this._fogMatrix=new Float64Array(16),o.aY(this._fogMatrix,this.fovInRadians,this.width/this.height,N,this._helper._farZ),this._fogMatrix[8]=2*-s.x/this.width,this._fogMatrix[9]=2*s.y/this.height,o.M(this._fogMatrix,this._fogMatrix,[1,-1,1]),o.L(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),o.a_(this._fogMatrix,this._fogMatrix,-this.rollInRadians),o.a$(this._fogMatrix,this._fogMatrix,this.pitchInRadians),o.a_(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),o.L(this._fogMatrix,this._fogMatrix,[-g,-x,0]),o.M(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),o.L(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=o.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,$);const re=this._helper._width%2/2,fe=this._helper._height%2/2,Me=Math.cos(this.bearingInRadians),ke=Math.sin(-this.bearingInRadians),Ke=g-Math.round(g)+Me*re+ke*fe,Qe=x-Math.round(x)+Me*fe+ke*re,Tt=new Float64Array($);if(o.L(Tt,Tt,[Ke>.5?Ke-1:Ke,Qe>.5?Qe-1:Qe,0]),this._alignedProjMatrix=Tt,$=o.an(new Float64Array(16),this._pixelMatrix),!$)throw new Error("failed to invert matrix");this._pixelMatrixInverse=$,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const s=this.screenPointToMercatorCoordinate(new o.P(0,0)),c=[s.x*this.worldSize,s.y*this.worldSize,0,1];return o.at(c,c,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const s=o.ag(1,this.center.lat)*this.worldSize;return Ze(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/s).toLngLat()}lngLatToCameraDepth(s,c){const g=o.$.fromLngLat(s),x=[g.x*this.worldSize,g.y*this.worldSize,c,1];return o.at(x,x,this._viewProjMatrix),x[2]/x[3]}getProjectionData(s){const{overscaledTileID:c,aligned:g,applyTerrainMatrix:x}=s,A=this._helper.getMercatorTileCoordinates(c),N=c?this.calculatePosMatrix(c,g,!0):null;let $;return $=c&&c.terrainRttPosMatrix32f&&x?c.terrainRttPosMatrix32f:N||o.b0(),{mainMatrix:$,tileMercatorCoords:A,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:$}}isLocationOccluded(s){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(s,c,g){return 1}transformLightDirection(s){return o.aQ(s)}getRayDirectionFromPixel(s){throw new Error("Not implemented.")}projectTileCoordinates(s,c,g,x){const A=this.calculatePosMatrix(g);let N;x?(N=[s,c,x(s,c),1],o.at(N,N,A)):(N=[s,c,0,1],ns(N,N,A));const $=N[3];return{point:new o.P(N[0]/$,N[1]/$),signedDistanceFromCamera:$,isOccluded:!1}}populateCache(s){for(const c of s)this.calculatePosMatrix(c)}getMatrixForModel(s,c){const g=o.$.fromLngLat(s,c),x=g.meterInMercatorCoordinateUnits(),A=o.b1();return o.L(A,A,[g.x,g.y,g.z]),o.a_(A,A,Math.PI),o.a$(A,A,Math.PI/2),o.M(A,A,[-x,x,x]),A}getProjectionDataForCustomLayer(s=!0){const c=new o.Y(0,0,0,0,0),g=this.getProjectionData({overscaledTileID:c,applyGlobeMatrix:s}),x=je(c,this.worldSize);o.N(x,this._viewProjMatrix,x),g.tileMercatorCoords=[0,0,1,1];const A=[o.Z,o.Z,this.worldSize/this._helper.pixelsPerMeter],N=o.b2();return o.M(N,x,A),g.fallbackMatrix=N,g.mainMatrix=N,g}getFastPathSimpleProjectionMatrix(s){return this.calculatePosMatrix(s)}}function Bl(){o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Nl(E){if(E.useSlerp)if(E.k<1){const s=o.b3(E.startEulerAngles.roll,E.startEulerAngles.pitch,E.startEulerAngles.bearing),c=o.b3(E.endEulerAngles.roll,E.endEulerAngles.pitch,E.endEulerAngles.bearing),g=new Float64Array(4);o.b4(g,s,c,E.k);const x=o.b5(g);E.tr.setRoll(x.roll),E.tr.setPitch(x.pitch),E.tr.setBearing(x.bearing)}else E.tr.setRoll(E.endEulerAngles.roll),E.tr.setPitch(E.endEulerAngles.pitch),E.tr.setBearing(E.endEulerAngles.bearing);else E.tr.setRoll(o.B.number(E.startEulerAngles.roll,E.endEulerAngles.roll,E.k)),E.tr.setPitch(o.B.number(E.startEulerAngles.pitch,E.endEulerAngles.pitch,E.k)),E.tr.setBearing(o.B.number(E.startEulerAngles.bearing,E.endEulerAngles.bearing,E.k))}function No(E,s,c,g,x){const A=x.padding,N=ir(x.worldSize,c.getNorthWest()),$=ir(x.worldSize,c.getNorthEast()),Z=ir(x.worldSize,c.getSouthEast()),re=ir(x.worldSize,c.getSouthWest()),fe=o.ab(-g),Me=N.rotate(fe),ke=$.rotate(fe),Ke=Z.rotate(fe),Qe=re.rotate(fe),Tt=new o.P(Math.max(Me.x,ke.x,Qe.x,Ke.x),Math.max(Me.y,ke.y,Qe.y,Ke.y)),Ct=new o.P(Math.min(Me.x,ke.x,Qe.x,Ke.x),Math.min(Me.y,ke.y,Qe.y,Ke.y)),At=Tt.sub(Ct),Rt=(x.width-(A.left+A.right+s.left+s.right))/At.x,jt=(x.height-(A.top+A.bottom+s.top+s.bottom))/At.y;if(jt<0||Rt<0)return void Bl();const Vt=Math.min(o.ah(x.scale*Math.min(Rt,jt)),E.maxZoom),en=o.P.convert(E.offset),mn=new o.P((s.left-s.right)/2,(s.top-s.bottom)/2).rotate(o.ab(g)),on=en.add(mn).mult(x.scale/o.ac(Vt));return{center:Fr(x.worldSize,N.add(Z).div(2).sub(on)),zoom:Vt,bearing:g}}class Pa{get useGlobeControls(){return!1}handlePanInertia(s,c){return{easingOffset:s,easingCenter:c.center}}handleMapControlsRollPitchBearingZoom(s,c){s.bearingDelta&&c.setBearing(c.bearing+s.bearingDelta),s.pitchDelta&&c.setPitch(c.pitch+s.pitchDelta),s.rollDelta&&c.setRoll(c.roll+s.rollDelta),s.zoomDelta&&c.setZoom(c.zoom+s.zoomDelta)}handleMapControlsPan(s,c,g){s.around.distSqr(c.centerPoint)<.01||c.setLocationAtPoint(g,s.around)}cameraForBoxAndBearing(s,c,g,x,A){return No(s,c,g,x,A)}handleJumpToCenterZoom(s,c){s.zoom!==(c.zoom!==void 0?+c.zoom:s.zoom)&&s.setZoom(+c.zoom),c.center!==void 0&&s.setCenter(o.Q.convert(c.center))}handleEaseTo(s,c){const g=s.zoom,x=s.padding,A={roll:s.roll,pitch:s.pitch,bearing:s.bearing},N={roll:c.roll===void 0?s.roll:c.roll,pitch:c.pitch===void 0?s.pitch:c.pitch,bearing:c.bearing===void 0?s.bearing:c.bearing},$=c.zoom!==void 0,Z=!s.isPaddingEqual(c.padding);let re=!1;const fe=$?+c.zoom:s.zoom;let Me=s.centerPoint.add(c.offsetAsPoint);const ke=s.screenPointToLocation(Me),{center:Ke,zoom:Qe}=s.getConstrained(o.Q.convert(c.center||ke),fe??g);us(s,Ke);const Tt=ir(s.worldSize,ke),Ct=ir(s.worldSize,Ke).sub(Tt),At=o.ac(Qe-g);return re=Qe!==g,{easeFunc:Rt=>{if(re&&s.setZoom(o.B.number(g,Qe,Rt)),o.b6(A,N)||Nl({startEulerAngles:A,endEulerAngles:N,tr:s,k:Rt,useSlerp:A.roll!=N.roll}),Z&&(s.interpolatePadding(x,c.padding,Rt),Me=s.centerPoint.add(c.offsetAsPoint)),c.around)s.setLocationAtPoint(c.around,c.aroundPoint);else{const jt=o.ac(s.zoom-g),Vt=Qe>g?Math.min(2,At):Math.max(.5,At),en=Math.pow(Vt,1-Rt),mn=Fr(s.worldSize,Tt.add(Ct.mult(Rt*en)).mult(jt));s.setLocationAtPoint(s.renderWorldCopies?mn.wrap():mn,Me)}},isZooming:re,elevationCenter:Ke}}handleFlyTo(s,c){const g=c.zoom!==void 0,x=s.zoom,A=s.getConstrained(o.Q.convert(c.center||c.locationAtOffset),g?+c.zoom:x),N=A.center,$=A.zoom;us(s,N);const Z=ir(s.worldSize,c.locationAtOffset),re=ir(s.worldSize,N).sub(Z),fe=re.mag(),Me=o.ac($-x);let ke;if(c.minZoom!==void 0){const Ke=Math.min(+c.minZoom,x,$),Qe=s.getConstrained(N,Ke).zoom;ke=o.ac(Qe-x)}return{easeFunc:(Ke,Qe,Tt,Ct)=>{s.setZoom(Ke===1?$:x+o.ah(Qe));const At=Ke===1?N:Fr(s.worldSize,Z.add(re.mult(Tt)).mult(Qe));s.setLocationAtPoint(s.renderWorldCopies?At.wrap():At,Ct)},scaleOfZoom:Me,targetCenter:N,scaleOfMinZoom:ke,pixelPathLength:fe}}}class qi{constructor(s,c,g){this.blendFunction=s,this.blendColor=c,this.mask=g}}qi.Replace=[1,0],qi.disabled=new qi(qi.Replace,o.b7.transparent,[!1,!1,!1,!1]),qi.unblended=new qi(qi.Replace,o.b7.transparent,[!0,!0,!0,!0]),qi.alphaBlended=new qi([1,771],o.b7.transparent,[!0,!0,!0,!0]);const Sc=2305;class Gi{constructor(s,c,g){this.enable=s,this.mode=c,this.frontFace=g}}Gi.disabled=new Gi(!1,1029,Sc),Gi.backCCW=new Gi(!0,1029,Sc),Gi.frontCCW=new Gi(!0,1028,Sc);class Nr{constructor(s,c,g){this.func=s,this.mask=c,this.range=g}}Nr.ReadOnly=!1,Nr.ReadWrite=!0,Nr.disabled=new Nr(519,Nr.ReadOnly,[0,1]);const Fi=7680;class Oi{constructor(s,c,g,x,A,N){this.test=s,this.ref=c,this.mask=g,this.fail=x,this.depthFail=A,this.pass=N}}Oi.disabled=new Oi({func:519,mask:0},0,0,Fi,Fi,Fi);const hc=new WeakMap;function ua(E){var s;if(hc.has(E))return hc.get(E);{const c=(s=E.getParameter(E.VERSION))===null||s===void 0?void 0:s.startsWith("WebGL 2.0");return hc.set(E,c),c}}class hu{get awaitingQuery(){return!!this._readbackQueue}constructor(s){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=s;const c=s.context,g=c.gl;this._texFormat=g.RGBA,this._texType=g.UNSIGNED_BYTE;const x=new o.aI;x.emplaceBack(-1,-1),x.emplaceBack(2,-1),x.emplaceBack(-1,2);const A=new o.aK;A.emplaceBack(0,1,2),this._fullscreenTriangle=new nl(c.createVertexBuffer(x,rl.members),c.createIndexBuffer(A),o.aJ.simpleSegment(0,0,x.length,A.length)),this._resultBuffer=new Uint8Array(4),c.activeTexture.set(g.TEXTURE1);const N=g.createTexture();g.bindTexture(g.TEXTURE_2D,N),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.NEAREST),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.NEAREST),g.texImage2D(g.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=c.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(N),ua(g)&&(this._pbo=g.createBuffer(),g.bindBuffer(g.PIXEL_PACK_BUFFER,this._pbo),g.bufferData(g.PIXEL_PACK_BUFFER,4,g.STREAM_READ),g.bindBuffer(g.PIXEL_PACK_BUFFER,null))}destroy(){const s=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),s.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(s,c){const g=this._updateCount;return this._readbackQueue?g>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():g>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(s,c),this._updateCount++,this._measuredError}_bindFramebuffer(){const s=this._cachedRenderContext.context,c=s.gl;s.activeTexture.set(c.TEXTURE1),c.bindTexture(c.TEXTURE_2D,this._fbo.colorAttachment.get()),s.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(s,c){const g=this._cachedRenderContext.context,x=g.gl;if(this._bindFramebuffer(),g.viewport.set([0,0,this._texWidth,this._texHeight]),g.clear({color:o.b7.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(g,x.TRIANGLES,Nr.disabled,Oi.disabled,qi.unblended,Gi.disabled,((A,N)=>({u_input:A,u_output_expected:N}))(s,c),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&ua(x)){x.bindBuffer(x.PIXEL_PACK_BUFFER,this._pbo),x.readBuffer(x.COLOR_ATTACHMENT0),x.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),x.bindBuffer(x.PIXEL_PACK_BUFFER,null);const A=x.fenceSync(x.SYNC_GPU_COMMANDS_COMPLETE,0);x.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:A}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const s=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&ua(s)){const c=s.clientWaitSync(this._readbackQueue.sync,0,0);if(c===s.WAIT_FAILED)return o.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(c===s.TIMEOUT_EXPIRED)return;s.bindBuffer(s.PIXEL_PACK_BUFFER,this._pbo),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),s.bindBuffer(s.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),s.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=hu._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(s){let c=0;return c+=s[0]/256,c+=s[1]/65536,c+=s[2]/16777216,s[3]<127&&(c=-c),c/128}}const du=o.Z/128;function Iu(E,s){const c=E.granularity!==void 0?Math.max(E.granularity,1):1,g=c+(E.generateBorders?2:0),x=c+(E.extendToNorthPole||E.generateBorders?1:0)+(E.extendToSouthPole||E.generateBorders?1:0),A=g+1,N=x+1,$=E.generateBorders?-1:0,Z=E.generateBorders||E.extendToNorthPole?-1:0,re=c+(E.generateBorders?1:0),fe=c+(E.generateBorders||E.extendToSouthPole?1:0),Me=A*N,ke=g*x*6,Ke=A*N>65536;if(Ke&&s==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const Qe=Ke||s==="32bit",Tt=new Int16Array(2*Me);let Ct=0;for(let jt=Z;jt<=fe;jt++)for(let Vt=$;Vt<=re;Vt++){let en=Vt/c*o.Z;Vt===-1&&(en=-64),Vt===c+1&&(en=o.Z+du);let mn=jt/c*o.Z;jt===-1&&(mn=E.extendToNorthPole?o.b9:-64),jt===c+1&&(mn=E.extendToSouthPole?o.ba:o.Z+du),Tt[Ct++]=en,Tt[Ct++]=mn}const At=Qe?new Uint32Array(ke):new Uint16Array(ke);let Rt=0;for(let jt=0;jt<x;jt++)for(let Vt=0;Vt<g;Vt++){const en=Vt+1+jt*A,mn=Vt+(jt+1)*A,on=Vt+1+(jt+1)*A;At[Rt++]=Vt+jt*A,At[Rt++]=mn,At[Rt++]=en,At[Rt++]=en,At[Rt++]=mn,At[Rt++]=on}return{vertices:Tt.buffer.slice(0),indices:At.buffer.slice(0),uses32bitIndices:Qe}}const fu=new o.aH({fill:new o.bb(128,2),line:new o.bb(512,0),tile:new o.bb(128,32),stencil:new o.bb(128,1),circle:3});class Hi{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return ui.projectionGlobe}get vertexShaderPreludeCode(){return ui.projectionMercator.vertexSource}get subdivisionGranularity(){return fu}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(s){this._errorMeasurement||(this._errorMeasurement=new hu(s));const c=o.S(this._errorQueryLatitudeDegrees),g=2*Math.atan(Math.exp(Math.PI-c*Math.PI*2))-.5*Math.PI,x=this._errorMeasurement.updateErrorLoop(c,g),A=M.now();x!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=x,this._errorMeasurementLastChangeTime=A);const N=Math.min(Math.max((A-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=o.bc(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,o.bd(N))}_getMeshKey(s){return`${s.granularity.toString(36)}_${s.generateBorders?"b":""}${s.extendToNorthPole?"n":""}${s.extendToSouthPole?"s":""}`}getMeshFromTileID(s,c,g,x,A){const N=(A==="stencil"?fu.stencil:fu.tile).getGranularityForZoomLevel(c.z);return this._getMesh(s,{granularity:N,generateBorders:g,extendToNorthPole:c.y===0&&x,extendToSouthPole:c.y===(1<<c.z)-1&&x})}_getMesh(s,c){const g=this._getMeshKey(c);if(g in this._tileMeshCache)return this._tileMeshCache[g];const x=function(A,N){const $=Iu(N,"16bit"),Z=o.aI.deserialize({arrayBuffer:$.vertices,length:$.vertices.byteLength/2/2}),re=o.aK.deserialize({arrayBuffer:$.indices,length:$.indices.byteLength/2/3});return new nl(A.createVertexBuffer(Z,rl.members),A.createIndexBuffer(re),o.aJ.simpleSegment(0,0,Z.length,re.length))}(s,c);return this._tileMeshCache[g]=x,x}recalculate(s){}hasTransition(){const s=M.now();let c=!1;return c=c||(s-this._errorMeasurementLastChangeTime)/1e3<.7,c=c||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,c}setErrorQueryLatitudeDegrees(s){this._errorQueryLatitudeDegrees=s}}const Ks=new o.r({type:new o.D(o.v.projection.type)});class di extends o.E{constructor(s){super(),this._transitionable=new o.T(Ks),this.setProjection(s),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.C(0)),this._mercatorProjection=new Ms,this._verticalPerspectiveProjection=new Hi}get transitionState(){const s=this.properties.get("type");if(typeof s=="string"&&s==="mercator")return 0;if(typeof s=="string"&&s==="vertical-perspective")return 1;if(s instanceof o.be){if(s.from==="vertical-perspective"&&s.to==="mercator")return 1-s.transition;if(s.from==="mercator"&&s.to==="vertical-perspective")return s.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(s){this._mercatorProjection.updateGPUdependent(s),this._verticalPerspectiveProjection.updateGPUdependent(s)}getMeshFromTileID(s,c,g,x,A){return this.currentProjection.getMeshFromTileID(s,c,g,x,A)}setProjection(s){this._transitionable.setValue("type",(s==null?void 0:s.type)||"mercator")}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}setErrorQueryLatitudeDegrees(s){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(s),this._mercatorProjection.setErrorQueryLatitudeDegrees(s)}}function ro(E){const s=Fs(E.worldSize,E.center.lat);return 2*Math.PI*s}function vl(E,s,c,g,x){const A=1/(1<<x),N=s/o.Z*A+g*A,$=o.bg((E/o.Z*A+c*A)*Math.PI*2+Math.PI,2*Math.PI),Z=2*Math.atan(Math.exp(Math.PI-N*Math.PI*2))-.5*Math.PI,re=Math.cos(Z),fe=new Float64Array(3);return fe[0]=Math.sin($)*re,fe[1]=Math.sin(Z),fe[2]=Math.cos($)*re,fe}function Ys(E){return function(s,c){const g=Math.cos(c),x=new Float64Array(3);return x[0]=Math.sin(s)*g,x[1]=Math.sin(c),x[2]=Math.cos(s)*g,x}(E.lng*Math.PI/180,E.lat*Math.PI/180)}function Fs(E,s){return E/(2*Math.PI)/Math.cos(s*Math.PI/180)}function Fo(E){const s=Math.asin(E[1])/Math.PI*180,c=Math.sqrt(E[0]*E[0]+E[2]*E[2]);if(c>1e-6){const g=E[0]/c,x=Math.acos(E[2]/c),A=(g>0?x:-x)/Math.PI*180;return new o.Q(o.aL(A,-180,180),s)}return new o.Q(0,s)}function Ea(E){return Math.cos(E*Math.PI/180)}function vs(E,s){const c=Ea(E),g=Ea(s);return o.ah(g/c)}function pu(E,s){const c=E.rotate(s.bearingInRadians),g=s.zoom+vs(s.center.lat,0),x=o.bc(1/Ea(s.center.lat),1/Ea(Math.min(Math.abs(s.center.lat),60)),o.bf(g,7,3,0,1)),A=360/ro({worldSize:s.worldSize,center:{lat:s.center.lat}});return new o.Q(s.center.lng-c.x*A*x,o.ae(s.center.lat+c.y*A,-85.051129,o.af))}function Ma(E){const s=.5*E,c=Math.sin(s),g=Math.cos(s);return Math.log(c+g)-Math.log(g-c)}function Qu(E,s,c,g){const x=E.lat+c*g;if(Math.abs(c)>1){const A=(Math.sign(E.lat+c)!==Math.sign(E.lat)?-Math.abs(E.lat):Math.abs(E.lat))*Math.PI/180,N=Math.abs(E.lat+c)*Math.PI/180,$=Ma(A+g*(N-A)),Z=Ma(A),re=Ma(N);return new o.Q(E.lng+s*(($-Z)/(re-Z)),x)}return new o.Q(E.lng+s*g,x)}class ss{constructor(s){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=s}recalculateCache(){if(!this._hadAnyChanges)return;const s=this._cachePrevious;this._cachePrevious=this._cache,this._cache=s,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(s,c,g,x){const A=`${s.z}_${s.x}_${s.y}`,N=this._cache.get(A);if(N)return N;const $=this._cachePrevious.get(A);if($)return this._cache.set(A,$),$;const Z=this._aabbFactory(s,c,g,x);return this._cache.set(A,Z),this._hadAnyChanges=!0,Z}}function Lc(E,s,c){const g=E-s;return g<0?-g:Math.max(0,g-c)}function Po(E,s,c,g,x){const A=E-c;let N;return N=A<0?Math.min(-A,1+A-x):A>1?Math.min(Math.max(A-x,0),1-A):0,Math.max(N,Lc(s,g,x))}class Fl{constructor(){this._aabbCache=new ss(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(s,c,g,x){const A=1<<g.z,N=1/A,$=g.x/A,Z=g.y/A;let re=2;return re=Math.min(re,Po(s,c,$,Z,N)),re=Math.min(re,Po(s,c,$+.5,-Z-N,N)),re=Math.min(re,Po(s,c,$+.5,2-Z-N,N)),re}getWrap(s,c,g){const x=1<<c.z,A=1/x,N=c.x/x,$=Lc(s.x,N,A),Z=Lc(s.x,N-1,A),re=Lc(s.x,N+1,A),fe=Math.min($,Z,re);return fe===re?1:fe===Z?-1:0}allowVariableZoom(s,c){return hn(s,c)>4}allowWorldCopies(){return!1}getTileAABB(s,c,g,x){return this._aabbCache.getTileAABB(s,c,g,x)}_computeTileAABB(s,c,g,x){if(s.z<=0)return new yi([-1,-1,-1],[1,1,1]);if(s.z===1)return new yi([s.x===0?-1:0,s.y===0?0:-1,-1],[s.x===0?0:1,s.y===0?1:0,1]);{const A=[vl(0,0,s.x,s.y,s.z),vl(o.Z,0,s.x,s.y,s.z),vl(o.Z,o.Z,s.x,s.y,s.z),vl(0,o.Z,s.x,s.y,s.z)],N=[1,1,1],$=[-1,-1,-1];for(const Z of A)for(let re=0;re<3;re++)N[re]=Math.min(N[re],Z[re]),$[re]=Math.max($[re],Z[re]);if(s.y===0||s.y===(1<<s.z)-1){const Z=[0,s.y===0?1:-1,0];for(let re=0;re<3;re++)N[re]=Math.min(N[re],Z[re]),$[re]=Math.max($[re],Z[re])}return new yi(N,$)}}}class Du{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(s){this._helper.setMinZoom(s)}setMaxZoom(s){this._helper.setMaxZoom(s)}setMinPitch(s){this._helper.setMinPitch(s)}setMaxPitch(s){this._helper.setMaxPitch(s)}setRenderWorldCopies(s){this._helper.setRenderWorldCopies(s)}setBearing(s){this._helper.setBearing(s)}setPitch(s){this._helper.setPitch(s)}setRoll(s){this._helper.setRoll(s)}setFov(s){this._helper.setFov(s)}setZoom(s){this._helper.setZoom(s)}setCenter(s){this._helper.setCenter(s)}setElevation(s){this._helper.setElevation(s)}setMinElevationForCurrentTile(s){this._helper.setMinElevationForCurrentTile(s)}setPadding(s){this._helper.setPadding(s)}interpolatePadding(s,c,g){return this._helper.interpolatePadding(s,c,g)}isPaddingEqual(s){return this._helper.isPaddingEqual(s)}resize(s,c){this._helper.resize(s,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(s){this._helper.setMaxBounds(s)}overrideNearFarZ(s,c){this._helper.overrideNearFarZ(s,c)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(s){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),s)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(s){}constructor(){this._cachedClippingPlane=o.bk(),this._projectionMatrix=o.b1(),this._globeViewProjMatrix32f=o.b0(),this._globeViewProjMatrixNoCorrection=o.b1(),this._globeViewProjMatrixNoCorrectionInverted=o.b1(),this._globeProjMatrixInverted=o.b1(),this._cameraPosition=o.bh(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Lo({calcMatrices:()=>{this._calcMatrices()},getConstrained:(s,c)=>this.getConstrained(s,c)}),this._coveringTilesDetailsProvider=new Fl}clone(){const s=new Du;return s.apply(this),s}apply(s,c){this._globeLatitudeErrorCorrectionRadians=c||0,this._helper.apply(s)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const s=o.bh();return s[0]=this._cameraPosition[0],s[1]=this._cameraPosition[1],s[2]=this._cameraPosition[2],s}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(s){const{overscaledTileID:c,applyGlobeMatrix:g}=s,x=this._helper.getMercatorTileCoordinates(c);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:x,clippingPlane:this._cachedClippingPlane,projectionTransition:g?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(s){const c=this.pitchInRadians,g=this.cameraToCenterDistance/s,x=Math.sin(c)*g,A=Math.cos(c)*g+1,N=1/Math.sqrt(x*x+A*A)*1;let $=-x,Z=A;const re=Math.sqrt($*$+Z*Z);$/=re,Z/=re;const fe=[0,$,Z];o.bl(fe,fe,[0,0,0],-this.bearingInRadians),o.bm(fe,fe,[0,0,0],-1*this.center.lat*Math.PI/180),o.bn(fe,fe,[0,0,0],this.center.lng*Math.PI/180);const Me=1/o.bo(fe);return o.aO(fe,fe,Me),[...fe,-N*Me]}isLocationOccluded(s){return!this.isSurfacePointVisible(Ys(s))}transformLightDirection(s){const c=this._helper._center.lng*Math.PI/180,g=this._helper._center.lat*Math.PI/180,x=Math.cos(g),A=[Math.sin(c)*x,Math.sin(g),Math.cos(c)*x],N=[A[2],0,-A[0]],$=[0,0,0];o.aU($,N,A),o.aT(N,N),o.aT($,$);const Z=[0,0,0];return o.aT(Z,[N[0]*s[0]+$[0]*s[1]+A[0]*s[2],N[1]*s[0]+$[1]*s[1]+A[1]*s[2],N[2]*s[0]+$[2]*s[1]+A[2]*s[2]]),Z}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(s,c,g){const x=function($,Z,re){const fe=1/(1<<re.z);return new o.$($/o.Z*fe+re.x*fe,Z/o.Z*fe+re.y*fe)}(s,c,g.canonical),A=(N=x.y,[o.bg(x.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-N*Math.PI*2))-.5*Math.PI]);var N;return this.getCircleRadiusCorrection()/Math.cos(A[1])}projectTileCoordinates(s,c,g,x){const A=g.canonical,N=vl(s,c,A.x,A.y,A.z),$=1+(x?x(s,c):0)/o.bu,Z=[N[0]*$,N[1]*$,N[2]*$,1];o.at(Z,Z,this._globeViewProjMatrixNoCorrection);const re=this._cachedClippingPlane,fe=re[0]*N[0]+re[1]*N[1]+re[2]*N[2]+re[3]<0;return{point:new o.P(Z[0]/Z[3],Z[1]/Z[3]),signedDistanceFromCamera:Z[3],isOccluded:fe}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const s=Fs(this.worldSize,this.center.lat),c=o.b2(),g=o.b2();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*s),o.aY(c,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const x=this.centerOffset;c[8]=2*-x.x/this._helper._width,c[9]=2*x.y/this._helper._height,this._projectionMatrix=o.aZ(c),this._globeProjMatrixInverted=o.b2(),o.an(this._globeProjMatrixInverted,c),o.L(c,c,[0,0,-this.cameraToCenterDistance]),o.a_(c,c,this.rollInRadians),o.a$(c,c,-this.pitchInRadians),o.a_(c,c,this.bearingInRadians),o.L(c,c,[0,0,-s]);const A=o.bh();A[0]=s,A[1]=s,A[2]=s,o.a$(g,c,this.center.lat*Math.PI/180),o.bp(g,g,-this.center.lng*Math.PI/180),o.M(g,g,A),this._globeViewProjMatrixNoCorrection=g,o.a$(c,c,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),o.bp(c,c,-this.center.lng*Math.PI/180),o.M(c,c,A),this._globeViewProjMatrix32f=new Float32Array(c),this._globeViewProjMatrixNoCorrectionInverted=o.b2(),o.an(this._globeViewProjMatrixNoCorrectionInverted,g);const N=o.bh();this._cameraPosition=o.bh(),this._cameraPosition[2]=this.cameraToCenterDistance/s,o.bl(this._cameraPosition,this._cameraPosition,N,-this.rollInRadians),o.bm(this._cameraPosition,this._cameraPosition,N,this.pitchInRadians),o.bl(this._cameraPosition,this._cameraPosition,N,-this.bearingInRadians),o.aP(this._cameraPosition,this._cameraPosition,[0,0,1]),o.bm(this._cameraPosition,this._cameraPosition,N,-this.center.lat*Math.PI/180),o.bn(this._cameraPosition,this._cameraPosition,N,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(s);const $=o.aZ(this._globeViewProjMatrixNoCorrectionInverted);o.M($,$,[1,1,-1]),this._cachedFrustum=fs.fromInvProjectionMatrix($)}calculateFogMatrix(s){o.w("calculateFogMatrix is not supported on globe projection.");const c=o.b2();return o.ad(c),c}getVisibleUnwrappedCoordinates(s){return[new o.aW(0,s)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(s){s&&o.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(s,c){if(!this._globeViewProjMatrixNoCorrection)return 1;const g=Ys(s);o.aO(g,g,1+c/o.bu);const x=o.bk();return o.at(x,[g[0],g[1],g[2],1],this._globeViewProjMatrixNoCorrection),x[2]/x[3]}populateCache(s){}getBounds(){const s=.5*this.width,c=.5*this.height,g=[new o.P(0,0),new o.P(s,0),new o.P(this.width,0),new o.P(this.width,c),new o.P(this.width,this.height),new o.P(s,this.height),new o.P(0,this.height),new o.P(0,c)],x=[];for(const Me of g)x.push(this.unprojectScreenPoint(Me));let A=0,N=0,$=0,Z=0;const re=this.center;for(const Me of x){const ke=o.bq(re.lng,Me.lng),Ke=o.bq(re.lat,Me.lat);ke<N&&(N=ke),ke>A&&(A=ke),Ke<Z&&(Z=Ke),Ke>$&&($=Ke)}const fe=[re.lng+N,re.lat+Z,re.lng+A,re.lat+$];return this.isSurfacePointOnScreen([0,1,0])&&(fe[3]=90,fe[0]=-180,fe[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(fe[1]=-90,fe[0]=-180,fe[2]=180),new Ae(fe)}getConstrained(s,c){const g=o.ae(s.lat,-85.051129,o.af),x=o.ae(+c,this.minZoom+vs(0,g),this.maxZoom);return{center:new o.Q(s.lng,g),zoom:x}}calculateCenterFromCameraLngLatAlt(s,c,g,x){return this._helper.calculateCenterFromCameraLngLatAlt(s,c,g,x)}setLocationAtPoint(s,c){const g=Ys(this.unprojectScreenPoint(c)),x=Ys(s),A=o.bh();o.br(A);const N=o.bh();o.bn(N,g,A,-this.center.lng*Math.PI/180),o.bm(N,N,A,this.center.lat*Math.PI/180);const $=x[0]*x[0]+x[2]*x[2],Z=N[0]*N[0];if($<Z)return;const re=Math.sqrt($-Z),fe=-re,Me=o.bs(x[0],x[2],N[0],re),ke=o.bs(x[0],x[2],N[0],fe),Ke=o.bh();o.bn(Ke,x,A,-Me);const Qe=o.bs(Ke[1],Ke[2],N[1],N[2]),Tt=o.bh();o.bn(Tt,x,A,-ke);const Ct=o.bs(Tt[1],Tt[2],N[1],N[2]),At=.5*Math.PI,Rt=Qe>=-At&&Qe<=At,jt=Ct>=-At&&Ct<=At;let Vt,en;if(Rt&&jt){const jn=this.center.lng*Math.PI/180,In=this.center.lat*Math.PI/180;o.bv(Me,jn)+o.bv(Qe,In)<o.bv(ke,jn)+o.bv(Ct,In)?(Vt=Me,en=Qe):(Vt=ke,en=Ct)}else if(Rt)Vt=Me,en=Qe;else{if(!jt)return;Vt=ke,en=Ct}const mn=Vt/Math.PI*180,on=en/Math.PI*180,On=this.center.lat;this.setCenter(new o.Q(mn,o.ae(on,-90,90))),this.setZoom(this.zoom+vs(On,this.center.lat))}locationToScreenPoint(s,c){const g=Ys(s);if(c){const x=c.getElevationForLngLatZoom(s,this._helper._tileZoom);o.aO(g,g,1+x/o.bu)}return this._projectSurfacePointToScreen(g)}_projectSurfacePointToScreen(s){const c=o.bk();return o.at(c,[...s,1],this._globeViewProjMatrixNoCorrection),c[0]/=c[3],c[1]/=c[3],new o.P((.5*c[0]+.5)*this.width,(.5*-c[1]+.5)*this.height)}screenPointToMercatorCoordinate(s,c){if(c){const g=c.pointCoordinate(s);if(g)return g}return o.$.fromLngLat(this.unprojectScreenPoint(s))}screenPointToLocation(s,c){var g;return(g=this.screenPointToMercatorCoordinate(s,c))===null||g===void 0?void 0:g.toLngLat()}isPointOnMapSurface(s,c){const g=this._cameraPosition,x=this.getRayDirectionFromPixel(s);return!!this.rayPlanetIntersection(g,x)}getRayDirectionFromPixel(s){const c=o.bk();c[0]=s.x/this.width*2-1,c[1]=-1*(s.y/this.height*2-1),c[2]=1,c[3]=1,o.at(c,c,this._globeViewProjMatrixNoCorrectionInverted),c[0]/=c[3],c[1]/=c[3],c[2]/=c[3];const g=o.bh();g[0]=c[0]-this._cameraPosition[0],g[1]=c[1]-this._cameraPosition[1],g[2]=c[2]-this._cameraPosition[2];const x=o.bh();return o.aT(x,g),x}isSurfacePointVisible(s){const c=this._cachedClippingPlane;return c[0]*s[0]+c[1]*s[1]+c[2]*s[2]+c[3]>=0}isSurfacePointOnScreen(s){if(!this.isSurfacePointVisible(s))return!1;const c=o.bk();return o.at(c,[...s,1],this._globeViewProjMatrixNoCorrection),c[0]/=c[3],c[1]/=c[3],c[2]/=c[3],c[0]>-1&&c[0]<1&&c[1]>-1&&c[1]<1&&c[2]>-1&&c[2]<1}rayPlanetIntersection(s,c){const g=o.aV(s,c),x=o.bh(),A=o.bh();o.aO(A,c,g),o.aS(x,s,A);const N=1-o.aV(x,x);if(N<0)return null;const $=o.aV(s,s)-1,Z=-g+(g<0?1:-1)*Math.sqrt(N),re=$/Z,fe=Z;return{tMin:Math.min(re,fe),tMax:Math.max(re,fe)}}unprojectScreenPoint(s){const c=this._cameraPosition,g=this.getRayDirectionFromPixel(s),x=this.rayPlanetIntersection(c,g);if(x){const fe=o.bh();o.aP(fe,c,[g[0]*x.tMin,g[1]*x.tMin,g[2]*x.tMin]);const Me=o.bh();return o.aT(Me,fe),Fo(Me)}const A=this._cachedClippingPlane,N=A[0]*g[0]+A[1]*g[1]+A[2]*g[2],$=-o.bt(A,c)/N,Z=o.bh();if($>0)o.aP(Z,c,[g[0]*$,g[1]*$,g[2]*$]);else{const fe=o.bh();o.aP(fe,c,[2*g[0],2*g[1],2*g[2]]);const Me=o.bt(this._cachedClippingPlane,fe);o.aS(Z,fe,[this._cachedClippingPlane[0]*Me,this._cachedClippingPlane[1]*Me,this._cachedClippingPlane[2]*Me])}const re=function(fe){const Me=o.bh();return Me[0]=fe[0]*-fe[3],Me[1]=fe[1]*-fe[3],Me[2]=fe[2]*-fe[3],{center:Me,radius:Math.sqrt(1-fe[3]*fe[3])}}(A);return Fo(function(fe,Me,ke){const Ke=o.bh();o.aS(Ke,ke,fe);const Qe=o.bh();return o.bi(Qe,fe,Ke,Me/o.bj(Ke)),Qe}(re.center,re.radius,Z))}getMatrixForModel(s,c){const g=o.Q.convert(s),x=1/o.bu,A=o.b1();return o.bp(A,A,g.lng/180*Math.PI),o.a$(A,A,-g.lat/180*Math.PI),o.L(A,A,[0,0,1+c/o.bu]),o.a$(A,A,.5*Math.PI),o.M(A,A,[x,x,x]),A}getProjectionDataForCustomLayer(s=!0){const c=this.getProjectionData({overscaledTileID:new o.Y(0,0,0,0,0),applyGlobeMatrix:s});return c.tileMercatorCoords=[0,0,1,1],c}getFastPathSimpleProjectionMatrix(s){}}class Va{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(s){this._helper.setMinZoom(s)}setMaxZoom(s){this._helper.setMaxZoom(s)}setMinPitch(s){this._helper.setMinPitch(s)}setMaxPitch(s){this._helper.setMaxPitch(s)}setRenderWorldCopies(s){this._helper.setRenderWorldCopies(s)}setBearing(s){this._helper.setBearing(s)}setPitch(s){this._helper.setPitch(s)}setRoll(s){this._helper.setRoll(s)}setFov(s){this._helper.setFov(s)}setZoom(s){this._helper.setZoom(s)}setCenter(s){this._helper.setCenter(s)}setElevation(s){this._helper.setElevation(s)}setMinElevationForCurrentTile(s){this._helper.setMinElevationForCurrentTile(s)}setPadding(s){this._helper.setPadding(s)}interpolatePadding(s,c,g){return this._helper.interpolatePadding(s,c,g)}isPaddingEqual(s){return this._helper.isPaddingEqual(s)}resize(s,c,g=!0){this._helper.resize(s,c,g)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(s){this._helper.setMaxBounds(s)}overrideNearFarZ(s,c){this._helper.overrideNearFarZ(s,c)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(s){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),s)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(s,c){this._globeness=s,this._globeLatitudeErrorCorrectionRadians=c,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Lo({calcMatrices:()=>{this._calcMatrices()},getConstrained:(s,c)=>this.getConstrained(s,c)}),this._globeness=1,this._mercatorTransform=new Bi,this._verticalPerspectiveTransform=new Du}clone(){const s=new Va;return s._globeness=this._globeness,s._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,s.apply(this),s}apply(s){this._helper.apply(s),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(s){const c=this._mercatorTransform.getProjectionData(s),g=this._verticalPerspectiveTransform.getProjectionData(s);return{mainMatrix:this.isGlobeRendering?g.mainMatrix:c.mainMatrix,clippingPlane:g.clippingPlane,tileMercatorCoords:g.tileMercatorCoords,projectionTransition:s.applyGlobeMatrix?this._globeness:0,fallbackMatrix:c.fallbackMatrix}}isLocationOccluded(s){return this.currentTransform.isLocationOccluded(s)}transformLightDirection(s){return this.currentTransform.transformLightDirection(s)}getPixelScale(){return o.bc(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return o.bc(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(s,c,g){const x=this._mercatorTransform.getPitchedTextCorrection(s,c,g),A=this._verticalPerspectiveTransform.getPitchedTextCorrection(s,c,g);return o.bc(x,A,this._globeness)}projectTileCoordinates(s,c,g,x){return this.currentTransform.projectTileCoordinates(s,c,g,x)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(s){return this.currentTransform.calculateFogMatrix(s)}getVisibleUnwrappedCoordinates(s){return this.currentTransform.getVisibleUnwrappedCoordinates(s)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(s){this._mercatorTransform.recalculateZoomAndCenter(s),this._verticalPerspectiveTransform.recalculateZoomAndCenter(s)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(s,c){return this.currentTransform.lngLatToCameraDepth(s,c)}populateCache(s){this._mercatorTransform.populateCache(s),this._verticalPerspectiveTransform.populateCache(s)}getBounds(){return this.currentTransform.getBounds()}getConstrained(s,c){return this.currentTransform.getConstrained(s,c)}calculateCenterFromCameraLngLatAlt(s,c,g,x){return this._helper.calculateCenterFromCameraLngLatAlt(s,c,g,x)}setLocationAtPoint(s,c){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(s,c),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(s,c),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(s,c){return this.currentTransform.locationToScreenPoint(s,c)}screenPointToMercatorCoordinate(s,c){return this.currentTransform.screenPointToMercatorCoordinate(s,c)}screenPointToLocation(s,c){return this.currentTransform.screenPointToLocation(s,c)}isPointOnMapSurface(s,c){return this.currentTransform.isPointOnMapSurface(s,c)}getRayDirectionFromPixel(s){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(s)}getMatrixForModel(s,c){return this.currentTransform.getMatrixForModel(s,c)}getProjectionDataForCustomLayer(s=!0){const c=this._mercatorTransform.getProjectionDataForCustomLayer(s);if(!this.isGlobeRendering)return c;const g=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(s);return g.fallbackMatrix=c.mainMatrix,g}getFastPathSimpleProjectionMatrix(s){return this.currentTransform.getFastPathSimpleProjectionMatrix(s)}}class Jo{get useGlobeControls(){return!0}handlePanInertia(s,c){const g=pu(s,c);return Math.abs(g.lng-c.center.lng)>180&&(g.lng=c.center.lng+179.5*Math.sign(g.lng-c.center.lng)),{easingCenter:g,easingOffset:new o.P(0,0)}}handleMapControlsRollPitchBearingZoom(s,c){const g=s.around,x=c.screenPointToLocation(g);s.bearingDelta&&c.setBearing(c.bearing+s.bearingDelta),s.pitchDelta&&c.setPitch(c.pitch+s.pitchDelta),s.rollDelta&&c.setRoll(c.roll+s.rollDelta);const A=c.zoom;s.zoomDelta&&c.setZoom(c.zoom+s.zoomDelta);const N=c.zoom-A;if(N===0)return;const $=o.bq(c.center.lng,x.lng),Z=$/(Math.abs($/180)+1),re=o.bq(c.center.lat,x.lat),fe=c.getRayDirectionFromPixel(g),Me=c.cameraPosition,ke=-1*o.aV(Me,fe),Ke=o.bh();o.aP(Ke,Me,[fe[0]*ke,fe[1]*ke,fe[2]*ke]);const Qe=o.bo(Ke)-1,Tt=Math.exp(.5*-Math.max(Qe-.3,0)),Ct=Fs(c.worldSize,c.center.lat)/Math.min(c.width,c.height),At=o.bf(Ct,.9,.5,1,.25),Rt=(1-o.ac(-N))*Math.min(Tt,At),jt=c.center.lat,Vt=c.zoom,en=new o.Q(c.center.lng+Z*Rt,o.ae(c.center.lat+re*Rt,-85.051129,o.af));c.setLocationAtPoint(x,g);const mn=c.center,on=o.bf(Math.abs($),45,85,0,1),On=o.bf(Ct,.75,.35,0,1),jn=Math.pow(Math.max(on,On),.25),In=o.bq(mn.lng,en.lng),sr=o.bq(mn.lat,en.lat);c.setCenter(new o.Q(mn.lng+In*jn,mn.lat+sr*jn).wrap()),c.setZoom(Vt+vs(jt,c.center.lat))}handleMapControlsPan(s,c,g){if(!s.panDelta)return;const x=c.center.lat,A=c.zoom;c.setCenter(pu(s.panDelta,c).wrap()),c.setZoom(A+vs(x,c.center.lat))}cameraForBoxAndBearing(s,c,g,x,A){const N=No(s,c,g,x,A),$=c.left/A.width*2-1,Z=(A.width-c.right)/A.width*2-1,re=c.top/A.height*-2+1,fe=(A.height-c.bottom)/A.height*-2+1,Me=o.bq(g.getWest(),g.getEast())<0,ke=Me?g.getEast():g.getWest(),Ke=Me?g.getWest():g.getEast(),Qe=Math.max(g.getNorth(),g.getSouth()),Tt=Math.min(g.getNorth(),g.getSouth()),Ct=ke+.5*o.bq(ke,Ke),At=Qe+.5*o.bq(Qe,Tt),Rt=A.clone();Rt.setCenter(N.center),Rt.setBearing(N.bearing),Rt.setPitch(0),Rt.setRoll(0),Rt.setZoom(N.zoom);const jt=Rt.modelViewProjectionMatrix,Vt=[Ys(g.getNorthWest()),Ys(g.getNorthEast()),Ys(g.getSouthWest()),Ys(g.getSouthEast()),Ys(new o.Q(Ke,At)),Ys(new o.Q(ke,At)),Ys(new o.Q(Ct,Qe)),Ys(new o.Q(Ct,Tt))],en=Ys(N.center);let mn=Number.POSITIVE_INFINITY;for(const on of Vt)$<0&&(mn=Jo.getLesserNonNegativeNonNull(mn,Jo.solveVectorScale(on,en,jt,"x",$))),Z>0&&(mn=Jo.getLesserNonNegativeNonNull(mn,Jo.solveVectorScale(on,en,jt,"x",Z))),re>0&&(mn=Jo.getLesserNonNegativeNonNull(mn,Jo.solveVectorScale(on,en,jt,"y",re))),fe<0&&(mn=Jo.getLesserNonNegativeNonNull(mn,Jo.solveVectorScale(on,en,jt,"y",fe)));if(Number.isFinite(mn)&&mn!==0)return N.zoom=Rt.zoom+o.ah(mn),N;Bl()}handleJumpToCenterZoom(s,c){const g=s.center.lat,x=s.getConstrained(c.center?o.Q.convert(c.center):s.center,s.zoom).center;s.setCenter(x.wrap());const A=c.zoom!==void 0?+c.zoom:s.zoom+vs(g,x.lat);s.zoom!==A&&s.setZoom(A)}handleEaseTo(s,c){const g=s.zoom,x=s.center,A=s.padding,N={roll:s.roll,pitch:s.pitch,bearing:s.bearing},$={roll:c.roll===void 0?s.roll:c.roll,pitch:c.pitch===void 0?s.pitch:c.pitch,bearing:c.bearing===void 0?s.bearing:c.bearing},Z=c.zoom!==void 0,re=!s.isPaddingEqual(c.padding);let fe=!1;const Me=c.center?o.Q.convert(c.center):x,ke=s.getConstrained(Me,g).center;us(s,ke);const Ke=s.clone();Ke.setCenter(ke),Ke.setZoom(Z?+c.zoom:g+vs(x.lat,Me.lat)),Ke.setBearing(c.bearing);const Qe=new o.P(o.ae(s.centerPoint.x+c.offsetAsPoint.x,0,s.width),o.ae(s.centerPoint.y+c.offsetAsPoint.y,0,s.height));Ke.setLocationAtPoint(ke,Qe);const Tt=(c.offset&&c.offsetAsPoint.mag())>0?Ke.center:ke,Ct=Z?+c.zoom:g+vs(x.lat,Tt.lat),At=g+vs(x.lat,0),Rt=Ct+vs(Tt.lat,0),jt=o.bq(x.lng,Tt.lng),Vt=o.bq(x.lat,Tt.lat),en=o.ac(Rt-At);return fe=Ct!==g,{easeFunc:mn=>{if(o.b6(N,$)||Nl({startEulerAngles:N,endEulerAngles:$,tr:s,k:mn,useSlerp:N.roll!=$.roll}),re&&s.interpolatePadding(A,c.padding,mn),c.around)o.w("Easing around a point is not supported under globe projection."),s.setLocationAtPoint(c.around,c.aroundPoint);else{const on=Rt>At?Math.min(2,en):Math.max(.5,en),On=Math.pow(on,1-mn),jn=Qu(x,jt,Vt,mn*On);s.setCenter(jn.wrap())}if(fe){const on=o.B.number(At,Rt,mn)+vs(0,s.center.lat);s.setZoom(on)}},isZooming:fe,elevationCenter:Tt}}handleFlyTo(s,c){const g=c.zoom!==void 0,x=s.center,A=s.zoom,N=s.padding,$=!s.isPaddingEqual(c.padding),Z=s.getConstrained(o.Q.convert(c.center||c.locationAtOffset),A).center,re=g?+c.zoom:s.zoom+vs(s.center.lat,Z.lat),fe=s.clone();fe.setCenter(Z),fe.setZoom(re),fe.setBearing(c.bearing);const Me=new o.P(o.ae(s.centerPoint.x+c.offsetAsPoint.x,0,s.width),o.ae(s.centerPoint.y+c.offsetAsPoint.y,0,s.height));fe.setLocationAtPoint(Z,Me);const ke=fe.center;us(s,ke);const Ke=function(Vt,en,mn){const on=Ys(en),On=Ys(mn),jn=o.aV(on,On),In=Math.acos(jn),sr=ro(Vt);return In/(2*Math.PI)*sr}(s,x,ke),Qe=A+vs(x.lat,0),Tt=re+vs(ke.lat,0),Ct=o.ac(Tt-Qe);let At;if(typeof c.minZoom=="number"){const Vt=+c.minZoom+vs(ke.lat,0),en=Math.min(Vt,Qe,Tt)+vs(0,ke.lat),mn=s.getConstrained(ke,en).zoom+vs(ke.lat,0);At=o.ac(mn-Qe)}const Rt=o.bq(x.lng,ke.lng),jt=o.bq(x.lat,ke.lat);return{easeFunc:(Vt,en,mn,on)=>{const On=Qu(x,Rt,jt,mn);$&&s.interpolatePadding(N,c.padding,Vt);const jn=Vt===1?ke:On;s.setCenter(jn.wrap());const In=Qe+o.ah(en);s.setZoom(Vt===1?re:In+vs(0,jn.lat))},scaleOfZoom:Ct,targetCenter:ke,scaleOfMinZoom:At,pixelPathLength:Ke}}static solveVectorScale(s,c,g,x,A){const N=x==="x"?[g[0],g[4],g[8],g[12]]:[g[1],g[5],g[9],g[13]],$=[g[3],g[7],g[11],g[15]],Z=s[0]*N[0]+s[1]*N[1]+s[2]*N[2],re=s[0]*$[0]+s[1]*$[1]+s[2]*$[2],fe=c[0]*N[0]+c[1]*N[1]+c[2]*N[2],Me=c[0]*$[0]+c[1]*$[1]+c[2]*$[2];return fe+A*re===Z+A*Me||$[3]*(Z-fe)+N[3]*(Me-re)+Z*Me==fe*re?null:(fe+N[3]-A*Me-A*$[3])/(fe-Z-A*Me+A*re)}static getLesserNonNegativeNonNull(s,c){return c!==null&&c>=0&&c<s?c:s}}class zl{constructor(s){this._globe=s,this._mercatorCameraHelper=new Pa,this._verticalPerspectiveCameraHelper=new Jo}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(s,c){return this.currentHelper.handlePanInertia(s,c)}handleMapControlsRollPitchBearingZoom(s,c){return this.currentHelper.handleMapControlsRollPitchBearingZoom(s,c)}handleMapControlsPan(s,c,g){this.currentHelper.handleMapControlsPan(s,c,g)}cameraForBoxAndBearing(s,c,g,x,A){return this.currentHelper.cameraForBoxAndBearing(s,c,g,x,A)}handleJumpToCenterZoom(s,c){this.currentHelper.handleJumpToCenterZoom(s,c)}handleEaseTo(s,c){return this.currentHelper.handleEaseTo(s,c)}handleFlyTo(s,c){return this.currentHelper.handleFlyTo(s,c)}}const os=(E,s)=>o.x(E,s&&s.filter(c=>c.identifier!=="source.canvas")),ca=o.bw();class il extends o.E{constructor(s,c={}){super(),this._rtlPluginLoaded=()=>{for(const g in this.sourceCaches){const x=this.sourceCaches[g].getSource().type;x!=="vector"&&x!=="geojson"||this.sourceCaches[g].reload()}},this.map=s,this.dispatcher=new lt(it(),s._getMapId()),this.dispatcher.registerMessageHandler("GG",(g,x)=>this.getGlyphs(g,x)),this.dispatcher.registerMessageHandler("GI",(g,x)=>this.getImages(g,x)),this.imageManager=new We,this.imageManager.setEventedParent(this),this.glyphManager=new be(s._requestManager,c.localIdeographFontFamily),this.lineAtlas=new He(256,512),this.crossTileSymbolIndex=new So,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.bx,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",o.by()),zr().on(cr,this._rtlPluginLoaded),this.on("data",g=>{if(g.dataType!=="source"||g.sourceDataType!=="metadata")return;const x=this.sourceCaches[g.sourceId];if(!x)return;const A=x.getSource();if(A&&A.vectorLayerIds)for(const N in this._layers){const $=this._layers[N];$.source===A.id&&this._validateLayer($)}})}loadURL(s,c={},g){this.fire(new o.l("dataloading",{dataType:"style"})),c.validate=typeof c.validate!="boolean"||c.validate;const x=this.map._requestManager.transformRequest(s,"Style");this._loadStyleRequest=new AbortController;const A=this._loadStyleRequest;o.j(x,this._loadStyleRequest).then(N=>{this._loadStyleRequest=null,this._load(N.data,c,g)}).catch(N=>{this._loadStyleRequest=null,N&&!A.signal.aborted&&this.fire(new o.k(N))})}loadJSON(s,c={},g){this.fire(new o.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,M.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,c.validate=c.validate!==!1,this._load(s,c,g)}).catch(()=>{})}loadEmpty(){this.fire(new o.l("dataloading",{dataType:"style"})),this._load(ca,{validate:!1})}_load(s,c,g){var x,A;const N=c.transformStyle?c.transformStyle(g,s):s;if(!c.validate||!os(this,o.y(N))){this._loaded=!0,this.stylesheet=N;for(const $ in N.sources)this.addSource($,N.sources[$],{validate:!1});N.sprite?this._loadSprite(N.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(N.glyphs),this._createLayers(),this.light=new Se(this.stylesheet.light),this._setProjectionInternal(((x=this.stylesheet.projection)===null||x===void 0?void 0:x.type)||"mercator"),this.sky=new ze(this.stylesheet.sky),this.map.setTerrain((A=this.stylesheet.terrain)!==null&&A!==void 0?A:null),this.fire(new o.l("data",{dataType:"style"})),this.fire(new o.l("style.load"))}}_createLayers(){const s=o.bz(this.stylesheet.layers);this.dispatcher.broadcast("SL",s),this._order=s.map(c=>c.id),this._layers={},this._serializedLayers=null;for(const c of s){const g=o.bA(c);g.setEventedParent(this,{layer:{id:c.id}}),this._layers[c.id]=g}}_loadSprite(s,c=!1,g=void 0){let x;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(A,N,$,Z){return o._(this,void 0,void 0,function*(){const re=me(A),fe=$>1?"@2x":"",Me={},ke={};for(const{id:Ke,url:Qe}of re){const Tt=N.transformRequest(we(Qe,fe,".json"),"SpriteJSON");Me[Ke]=o.j(Tt,Z);const Ct=N.transformRequest(we(Qe,fe,".png"),"SpriteImage");ke[Ke]=oe.getImage(Ct,Z)}return yield Promise.all([...Object.values(Me),...Object.values(ke)]),function(Ke,Qe){return o._(this,void 0,void 0,function*(){const Tt={};for(const Ct in Ke){Tt[Ct]={};const At=M.getImageCanvasContext((yield Qe[Ct]).data),Rt=(yield Ke[Ct]).data;for(const jt in Rt){const{width:Vt,height:en,x:mn,y:on,sdf:On,pixelRatio:jn,stretchX:In,stretchY:sr,content:tr,textFitWidth:Or,textFitHeight:Sr}=Rt[jt];Tt[Ct][jt]={data:null,pixelRatio:jn,sdf:On,stretchX:In,stretchY:sr,content:tr,textFitWidth:Or,textFitHeight:Sr,spriteData:{width:Vt,height:en,x:mn,y:on,context:At}}}}return Tt})}(Me,ke)})}(s,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(A=>{if(this._spriteRequest=null,A)for(const N in A){this._spritesImagesIds[N]=[];const $=this._spritesImagesIds[N]?this._spritesImagesIds[N].filter(Z=>!(Z in A)):[];for(const Z of $)this.imageManager.removeImage(Z),this._changedImages[Z]=!0;for(const Z in A[N]){const re=N==="default"?Z:`${N}:${Z}`;this._spritesImagesIds[N].push(re),re in this.imageManager.images?this.imageManager.updateImage(re,A[N][Z],!1):this.imageManager.addImage(re,A[N][Z]),c&&(this._changedImages[re]=!0)}}}).catch(A=>{this._spriteRequest=null,x=A,this.fire(new o.k(x))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),c&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"})),g&&g(x)})}_unloadSprite(){for(const s of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(s),this._changedImages[s]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}_validateLayer(s){const c=this.sourceCaches[s.source];if(!c)return;const g=s.sourceLayer;if(!g)return;const x=c.getSource();(x.type==="geojson"||x.vectorLayerIds&&x.vectorLayerIds.indexOf(g)===-1)&&this.fire(new o.k(new Error(`Source layer "${g}" does not exist on source "${x.id}" as specified by style layer "${s.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const s in this.sourceCaches)if(!this.sourceCaches[s].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(s,c=!1){const g=this._serializedAllLayers();if(!s||s.length===0)return Object.values(c?o.bB(g):g);const x=[];for(const A of s)if(g[A]){const N=c?o.bB(g[A]):g[A];x.push(N)}return x}_serializedAllLayers(){let s=this._serializedLayers;if(s)return s;s=this._serializedLayers={};const c=Object.keys(this._layers);for(const g of c){const x=this._layers[g];x.type!=="custom"&&(s[g]=x.serialize())}return s}hasTransitions(){var s,c,g;if(!((s=this.light)===null||s===void 0)&&s.hasTransition()||!((c=this.sky)===null||c===void 0)&&c.hasTransition()||!((g=this.projection)===null||g===void 0)&&g.hasTransition())return!0;for(const x in this.sourceCaches)if(this.sourceCaches[x].hasTransition())return!0;for(const x in this._layers)if(this._layers[x].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(s){if(!this._loaded)return;const c=this._changed;if(c){const x=Object.keys(this._updatedLayers),A=Object.keys(this._removedLayers);(x.length||A.length)&&this._updateWorkerLayers(x,A);for(const N in this._updatedSources){const $=this._updatedSources[N];if($==="reload")this._reloadSource(N);else{if($!=="clear")throw new Error(`Invalid action ${$}`);this._clearSource(N)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const N in this._updatedPaintProps)this._layers[N].updateTransitions(s);this.light.updateTransitions(s),this.sky.updateTransitions(s),this._resetUpdates()}const g={};for(const x in this.sourceCaches){const A=this.sourceCaches[x];g[x]=A.used,A.used=!1}for(const x of this._order){const A=this._layers[x];A.recalculate(s,this._availableImages),!A.isHidden(s.zoom)&&A.source&&(this.sourceCaches[A.source].used=!0)}for(const x in g){const A=this.sourceCaches[x];!!g[x]!=!!A.used&&A.fire(new o.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:x}))}this.light.recalculate(s),this.sky.recalculate(s),this.projection.recalculate(s),this.z=s.zoom,c&&this.fire(new o.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const s=Object.keys(this._changedImages);if(s.length){for(const c in this.sourceCaches)this.sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],s);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(s,c){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(s,!1),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(s,c={}){var g;this._checkLoaded();const x=this.serialize();if(s=c.transformStyle?c.transformStyle(x,s):s,((g=c.validate)===null||g===void 0||g)&&os(this,o.y(s)))return!1;(s=o.bB(s)).layers=o.bz(s.layers);const A=o.bC(x,s),N=this._getOperationsToPerform(A);if(N.unimplemented.length>0)throw new Error(`Unimplemented: ${N.unimplemented.join(", ")}.`);if(N.operations.length===0)return!1;for(const $ of N.operations)$();return this.stylesheet=s,this._serializedLayers=null,!0}_getOperationsToPerform(s){const c=[],g=[];for(const x of s)switch(x.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":c.push(()=>this.addLayer.apply(this,x.args));break;case"removeLayer":c.push(()=>this.removeLayer.apply(this,x.args));break;case"setPaintProperty":c.push(()=>this.setPaintProperty.apply(this,x.args));break;case"setLayoutProperty":c.push(()=>this.setLayoutProperty.apply(this,x.args));break;case"setFilter":c.push(()=>this.setFilter.apply(this,x.args));break;case"addSource":c.push(()=>this.addSource.apply(this,x.args));break;case"removeSource":c.push(()=>this.removeSource.apply(this,x.args));break;case"setLayerZoomRange":c.push(()=>this.setLayerZoomRange.apply(this,x.args));break;case"setLight":c.push(()=>this.setLight.apply(this,x.args));break;case"setGeoJSONSourceData":c.push(()=>this.setGeoJSONSourceData.apply(this,x.args));break;case"setGlyphs":c.push(()=>this.setGlyphs.apply(this,x.args));break;case"setSprite":c.push(()=>this.setSprite.apply(this,x.args));break;case"setTerrain":c.push(()=>this.map.setTerrain.apply(this,x.args));break;case"setSky":c.push(()=>this.setSky.apply(this,x.args));break;case"setProjection":this.setProjection.apply(this,x.args);break;case"setTransition":c.push(()=>{});break;default:g.push(x.command)}return{operations:c,unimplemented:g}}addImage(s,c){if(this.getImage(s))return this.fire(new o.k(new Error(`An image named "${s}" already exists.`)));this.imageManager.addImage(s,c),this._afterImageUpdated(s)}updateImage(s,c){this.imageManager.updateImage(s,c)}getImage(s){return this.imageManager.getImage(s)}removeImage(s){if(!this.getImage(s))return this.fire(new o.k(new Error(`An image named "${s}" does not exist.`)));this.imageManager.removeImage(s),this._afterImageUpdated(s)}_afterImageUpdated(s){this._availableImages=this.imageManager.listImages(),this._changedImages[s]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(s,c,g={}){if(this._checkLoaded(),this.sourceCaches[s]!==void 0)throw new Error(`Source "${s}" already exists.`);if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(o.y.source,`sources.${s}`,c,null,g))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const x=this.sourceCaches[s]=new cn(s,c,this.dispatcher);x.style=this,x.setEventedParent(this,()=>({isSourceLoaded:x.loaded(),source:x.serialize(),sourceId:s})),x.onAdd(this.map),this._changed=!0}removeSource(s){if(this._checkLoaded(),this.sourceCaches[s]===void 0)throw new Error("There is no source with this ID");for(const g in this._layers)if(this._layers[g].source===s)return this.fire(new o.k(new Error(`Source "${s}" cannot be removed while layer "${g}" is using it.`)));const c=this.sourceCaches[s];delete this.sourceCaches[s],delete this._updatedSources[s],c.fire(new o.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:s})),c.setEventedParent(null),c.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(s,c){if(this._checkLoaded(),this.sourceCaches[s]===void 0)throw new Error(`There is no source with this ID=${s}`);const g=this.sourceCaches[s].getSource();if(g.type!=="geojson")throw new Error(`geojsonSource.type is ${g.type}, which is !== 'geojson`);g.setData(c),this._changed=!0}getSource(s){return this.sourceCaches[s]&&this.sourceCaches[s].getSource()}addLayer(s,c,g={}){this._checkLoaded();const x=s.id;if(this.getLayer(x))return void this.fire(new o.k(new Error(`Layer "${x}" already exists on this map.`)));let A;if(s.type==="custom"){if(os(this,o.bD(s)))return;A=o.bA(s)}else{if("source"in s&&typeof s.source=="object"&&(this.addSource(x,s.source),s=o.bB(s),s=o.e(s,{source:x})),this._validate(o.y.layer,`layers.${x}`,s,{arrayIndex:-1},g))return;A=o.bA(s),this._validateLayer(A),A.setEventedParent(this,{layer:{id:x}})}const N=c?this._order.indexOf(c):this._order.length;if(c&&N===-1)this.fire(new o.k(new Error(`Cannot add layer "${x}" before non-existing layer "${c}".`)));else{if(this._order.splice(N,0,x),this._layerOrderChanged=!0,this._layers[x]=A,this._removedLayers[x]&&A.source&&A.type!=="custom"){const $=this._removedLayers[x];delete this._removedLayers[x],$.type!==A.type?this._updatedSources[A.source]="clear":(this._updatedSources[A.source]="reload",this.sourceCaches[A.source].pause())}this._updateLayer(A),A.onAdd&&A.onAdd(this.map)}}moveLayer(s,c){if(this._checkLoaded(),this._changed=!0,!this._layers[s])return void this.fire(new o.k(new Error(`The layer '${s}' does not exist in the map's style and cannot be moved.`)));if(s===c)return;const g=this._order.indexOf(s);this._order.splice(g,1);const x=c?this._order.indexOf(c):this._order.length;c&&x===-1?this.fire(new o.k(new Error(`Cannot move layer "${s}" before non-existing layer "${c}".`))):(this._order.splice(x,0,s),this._layerOrderChanged=!0)}removeLayer(s){this._checkLoaded();const c=this._layers[s];if(!c)return void this.fire(new o.k(new Error(`Cannot remove non-existing layer "${s}".`)));c.setEventedParent(null);const g=this._order.indexOf(s);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[s]=c,delete this._layers[s],this._serializedLayers&&delete this._serializedLayers[s],delete this._updatedLayers[s],delete this._updatedPaintProps[s],c.onRemove&&c.onRemove(this.map)}getLayer(s){return this._layers[s]}getLayersOrder(){return[...this._order]}hasLayer(s){return s in this._layers}setLayerZoomRange(s,c,g){this._checkLoaded();const x=this.getLayer(s);x?x.minzoom===c&&x.maxzoom===g||(c!=null&&(x.minzoom=c),g!=null&&(x.maxzoom=g),this._updateLayer(x)):this.fire(new o.k(new Error(`Cannot set the zoom range of non-existing layer "${s}".`)))}setFilter(s,c,g={}){this._checkLoaded();const x=this.getLayer(s);if(x){if(!o.bE(x.filter,c))return c==null?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(o.y.filter,`layers.${x.id}.filter`,c,null,g)||(x.filter=o.bB(c),this._updateLayer(x)))}else this.fire(new o.k(new Error(`Cannot filter non-existing layer "${s}".`)))}getFilter(s){return o.bB(this.getLayer(s).filter)}setLayoutProperty(s,c,g,x={}){this._checkLoaded();const A=this.getLayer(s);A?o.bE(A.getLayoutProperty(c),g)||(A.setLayoutProperty(c,g,x),this._updateLayer(A)):this.fire(new o.k(new Error(`Cannot style non-existing layer "${s}".`)))}getLayoutProperty(s,c){const g=this.getLayer(s);if(g)return g.getLayoutProperty(c);this.fire(new o.k(new Error(`Cannot get style of non-existing layer "${s}".`)))}setPaintProperty(s,c,g,x={}){this._checkLoaded();const A=this.getLayer(s);A?o.bE(A.getPaintProperty(c),g)||(A.setPaintProperty(c,g,x)&&this._updateLayer(A),this._changed=!0,this._updatedPaintProps[s]=!0,this._serializedLayers=null):this.fire(new o.k(new Error(`Cannot style non-existing layer "${s}".`)))}getPaintProperty(s,c){return this.getLayer(s).getPaintProperty(c)}setFeatureState(s,c){this._checkLoaded();const g=s.source,x=s.sourceLayer,A=this.sourceCaches[g];if(A===void 0)return void this.fire(new o.k(new Error(`The source '${g}' does not exist in the map's style.`)));const N=A.getSource().type;N==="geojson"&&x?this.fire(new o.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):N!=="vector"||x?(s.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),A.setFeatureState(x,s.id,c)):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(s,c){this._checkLoaded();const g=s.source,x=this.sourceCaches[g];if(x===void 0)return void this.fire(new o.k(new Error(`The source '${g}' does not exist in the map's style.`)));const A=x.getSource().type,N=A==="vector"?s.sourceLayer:void 0;A!=="vector"||N?c&&typeof s.id!="string"&&typeof s.id!="number"?this.fire(new o.k(new Error("A feature id is required to remove its specific state property."))):x.removeFeatureState(N,s.id,c):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(s){this._checkLoaded();const c=s.source,g=s.sourceLayer,x=this.sourceCaches[c];if(x!==void 0)return x.getSource().type!=="vector"||g?(s.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),x.getFeatureState(g,s.id)):void this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.k(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return o.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const s=o.bF(this.sourceCaches,A=>A.serialize()),c=this._serializeByIds(this._order,!0),g=this.map.getTerrain()||void 0,x=this.stylesheet;return o.bG({version:x.version,name:x.name,metadata:x.metadata,light:x.light,sky:x.sky,center:x.center,zoom:x.zoom,bearing:x.bearing,pitch:x.pitch,sprite:x.sprite,glyphs:x.glyphs,transition:x.transition,projection:x.projection,sources:s,layers:c,terrain:g},A=>A!==void 0)}_updateLayer(s){this._updatedLayers[s.id]=!0,s.source&&!this._updatedSources[s.source]&&this.sourceCaches[s.source].getSource().type!=="raster"&&(this._updatedSources[s.source]="reload",this.sourceCaches[s.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(s){const c=N=>this._layers[N].type==="fill-extrusion",g={},x=[];for(let N=this._order.length-1;N>=0;N--){const $=this._order[N];if(c($)){g[$]=N;for(const Z of s){const re=Z[$];if(re)for(const fe of re)x.push(fe)}}}x.sort((N,$)=>$.intersectionZ-N.intersectionZ);const A=[];for(let N=this._order.length-1;N>=0;N--){const $=this._order[N];if(c($))for(let Z=x.length-1;Z>=0;Z--){const re=x[Z].feature;if(g[re.layer.id]<N)break;A.push(re),x.pop()}else for(const Z of s){const re=Z[$];if(re)for(const fe of re)A.push(fe.feature)}}return A}queryRenderedFeatures(s,c,g){c&&c.filter&&this._validate(o.y.filter,"queryRenderedFeatures.filter",c.filter,null,c);const x={};if(c&&c.layers){if(!(Array.isArray(c.layers)||c.layers instanceof Set))return this.fire(new o.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const re of c.layers){const fe=this._layers[re];if(!fe)return this.fire(new o.k(new Error(`The layer '${re}' does not exist in the map's style and cannot be queried for features.`))),[];x[fe.source]=!0}}const A=[];c.availableImages=this._availableImages;const N=this._serializedAllLayers(),$=c.layers instanceof Set?c.layers:Array.isArray(c.layers)?new Set(c.layers):null,Z=Object.assign(Object.assign({},c),{layers:$});for(const re in this.sourceCaches)c.layers&&!x[re]||A.push(rn(this.sourceCaches[re],this._layers,N,s,Z,g,this.map.terrain?(fe,Me,ke)=>this.map.terrain.getElevation(fe,Me,ke):void 0));return this.placement&&A.push(function(re,fe,Me,ke,Ke,Qe,Tt){const Ct={},At=Qe.queryRenderedSymbols(ke),Rt=[];for(const jt of Object.keys(At).map(Number))Rt.push(Tt[jt]);Rt.sort(yn);for(const jt of Rt){const Vt=jt.featureIndex.lookupSymbolFeatures(At[jt.bucketInstanceId],fe,jt.bucketIndex,jt.sourceLayerIndex,Ke.filter,Ke.layers,Ke.availableImages,re);for(const en in Vt){const mn=Ct[en]=Ct[en]||[],on=Vt[en];on.sort((On,jn)=>{const In=jt.featureSortOrder;if(In){const sr=In.indexOf(On.featureIndex);return In.indexOf(jn.featureIndex)-sr}return jn.featureIndex-On.featureIndex});for(const On of on)mn.push(On)}}return function(jt,Vt,en){for(const mn in jt)for(const on of jt[mn])Pn(on,en[Vt[mn].source]);return jt}(Ct,re,Me)}(this._layers,N,this.sourceCaches,s,Z,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(A)}querySourceFeatures(s,c){c&&c.filter&&this._validate(o.y.filter,"querySourceFeatures.filter",c.filter,null,c);const g=this.sourceCaches[s];return g?function(x,A){const N=x.getRenderableIds().map(re=>x.getTileByID(re)),$=[],Z={};for(let re=0;re<N.length;re++){const fe=N[re],Me=fe.tileID.canonical.key;Z[Me]||(Z[Me]=!0,fe.querySourceFeatures($,A))}return $}(g,c):[]}getLight(){return this.light.getLight()}setLight(s,c={}){this._checkLoaded();const g=this.light.getLight();let x=!1;for(const N in s)if(!o.bE(s[N],g[N])){x=!0;break}if(!x)return;const A={now:M.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(s,c),this.light.updateTransitions(A)}getProjection(){var s;return(s=this.stylesheet)===null||s===void 0?void 0:s.projection}setProjection(s){if(this._checkLoaded(),this.projection){if(this.projection.name===s.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=s,this._setProjectionInternal(s.type)}getSky(){var s;return(s=this.stylesheet)===null||s===void 0?void 0:s.sky}setSky(s,c={}){this._checkLoaded();const g=this.getSky();let x=!1;if(!s&&!g)return;if(s&&!g)x=!0;else if(!s&&g)x=!0;else for(const N in s)if(!o.bE(s[N],g[N])){x=!0;break}if(!x)return;const A={now:M.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=s,this.sky.setSky(s,c),this.sky.updateTransitions(A)}_setProjectionInternal(s){const c=function(g){if(Array.isArray(g)){const x=new di({type:g});return{projection:x,transform:new Va,cameraHelper:new zl(x)}}switch(g){case"mercator":return{projection:new Ms,transform:new Bi,cameraHelper:new Pa};case"globe":{const x=new di({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:x,transform:new Va,cameraHelper:new zl(x)}}case"vertical-perspective":return{projection:new Hi,transform:new Du,cameraHelper:new Jo};default:return o.w(`Unknown projection name: ${g}. Falling back to mercator projection.`),{projection:new Ms,transform:new Bi,cameraHelper:new Pa}}}(s);this.projection=c.projection,this.map.migrateProjection(c.transform,c.cameraHelper);for(const g in this.sourceCaches)this.sourceCaches[g].reload()}_validate(s,c,g,x,A={}){return(!A||A.validate!==!1)&&os(this,s.call(o.y,o.e({key:c,style:this.serialize(),value:g,styleSpec:o.v},x)))}_remove(s=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),zr().off(cr,this._rtlPluginLoaded);for(const c in this._layers)this._layers[c].setEventedParent(null);for(const c in this.sourceCaches){const g=this.sourceCaches[c];g.setEventedParent(null),g.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),s&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(s)}_clearSource(s){this.sourceCaches[s].clearTiles()}_reloadSource(s){this.sourceCaches[s].resume(),this.sourceCaches[s].reload()}_updateSources(s){for(const c in this.sourceCaches)this.sourceCaches[c].update(s,this.map.terrain)}_generateCollisionBoxes(){for(const s in this.sourceCaches)this._reloadSource(s)}_updatePlacement(s,c,g,x,A=!1){let N=!1,$=!1;const Z={};for(const re of this._order){const fe=this._layers[re];if(fe.type!=="symbol")continue;if(!Z[fe.source]){const ke=this.sourceCaches[fe.source];Z[fe.source]=ke.getRenderableIds(!0).map(Ke=>ke.getTileByID(Ke)).sort((Ke,Qe)=>Qe.tileID.overscaledZ-Ke.tileID.overscaledZ||(Ke.tileID.isLessThan(Qe.tileID)?-1:1))}const Me=this.crossTileSymbolIndex.addLayer(fe,Z[fe.source],s.center.lng);N=N||Me}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((A=A||this._layerOrderChanged||g===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(M.now(),s.zoom))&&(this.pauseablePlacement=new Co(s,this.map.terrain,this._order,A,c,g,x,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Z),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(M.now()),$=!0),N&&this.pauseablePlacement.placement.setStale()),$||N)for(const re of this._order){const fe=this._layers[re];fe.type==="symbol"&&this.placement.updateLayerOpacities(fe,Z[fe.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(M.now())}_releaseSymbolFadeTiles(){for(const s in this.sourceCaches)this.sourceCaches[s].releaseSymbolFadeTiles()}getImages(s,c){return o._(this,void 0,void 0,function*(){const g=yield this.imageManager.getImages(c.icons);this._updateTilesForChangedImages();const x=this.sourceCaches[c.source];return x&&x.setDependencies(c.tileID.key,c.type,c.icons),g})}getGlyphs(s,c){return o._(this,void 0,void 0,function*(){const g=yield this.glyphManager.getGlyphs(c.stacks),x=this.sourceCaches[c.source];return x&&x.setDependencies(c.tileID.key,c.type,[""]),g})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(s,c={}){this._checkLoaded(),s&&this._validate(o.y.glyphs,"glyphs",s,null,c)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=s,this.glyphManager.entries={},this.glyphManager.setURL(s))}addSprite(s,c,g={},x){this._checkLoaded();const A=[{id:s,url:c}],N=[...me(this.stylesheet.sprite),...A];this._validate(o.y.sprite,"sprite",N,null,g)||(this.stylesheet.sprite=N,this._loadSprite(A,!0,x))}removeSprite(s){this._checkLoaded();const c=me(this.stylesheet.sprite);if(c.find(g=>g.id===s)){if(this._spritesImagesIds[s])for(const g of this._spritesImagesIds[s])this.imageManager.removeImage(g),this._changedImages[g]=!0;c.splice(c.findIndex(g=>g.id===s),1),this.stylesheet.sprite=c.length>0?c:void 0,delete this._spritesImagesIds[s],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}else this.fire(new o.k(new Error(`Sprite "${s}" doesn't exists on this map.`)))}getSprite(){return me(this.stylesheet.sprite)}setSprite(s,c={},g){this._checkLoaded(),s&&this._validate(o.y.sprite,"sprite",s,null,c)||(this.stylesheet.sprite=s,s?this._loadSprite(s,!0,g):(this._unloadSprite(),g&&g(null)))}}var uo=o.aG([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class J{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(s,c,g,x,A,N,$,Z,re){this.context=s;let fe=this.boundPaintVertexBuffers.length!==x.length;for(let Me=0;!fe&&Me<x.length;Me++)this.boundPaintVertexBuffers[Me]!==x[Me]&&(fe=!0);!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==g||fe||this.boundIndexBuffer!==A||this.boundVertexOffset!==N||this.boundDynamicVertexBuffer!==$||this.boundDynamicVertexBuffer2!==Z||this.boundDynamicVertexBuffer3!==re?this.freshBind(c,g,x,A,N,$,Z,re):(s.bindVertexArray.set(this.vao),$&&$.bind(),A&&A.dynamicDraw&&A.bind(),Z&&Z.bind(),re&&re.bind())}freshBind(s,c,g,x,A,N,$,Z){const re=s.numAttributes,fe=this.context,Me=fe.gl;this.vao&&this.destroy(),this.vao=fe.createVertexArray(),fe.bindVertexArray.set(this.vao),this.boundProgram=s,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=x,this.boundVertexOffset=A,this.boundDynamicVertexBuffer=N,this.boundDynamicVertexBuffer2=$,this.boundDynamicVertexBuffer3=Z,c.enableAttributes(Me,s);for(const ke of g)ke.enableAttributes(Me,s);N&&N.enableAttributes(Me,s),$&&$.enableAttributes(Me,s),Z&&Z.enableAttributes(Me,s),c.bind(),c.setVertexAttribPointers(Me,s,A);for(const ke of g)ke.bind(),ke.setVertexAttribPointers(Me,s,A);N&&(N.bind(),N.setVertexAttribPointers(Me,s,A)),x&&x.bind(),$&&($.bind(),$.setVertexAttribPointers(Me,s,A)),Z&&(Z.bind(),Z.setVertexAttribPointers(Me,s,A)),fe.currentNumAttributes=re}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Xe=(E,s,c,g,x)=>({u_texture:0,u_ele_delta:E,u_fog_matrix:s,u_fog_color:c?c.properties.get("fog-color"):o.b7.white,u_fog_ground_blend:c?c.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:x?0:c?c.calculateFogBlendOpacity(g):0,u_horizon_color:c?c.properties.get("horizon-color"):o.b7.white,u_horizon_fog_blend:c?c.properties.get("horizon-fog-blend"):1,u_is_globe_mode:x?1:0}),Bt={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function nn(E){const s=[];for(let c=0;c<E.length;c++){if(E[c]===null)continue;const g=E[c].split(" ");s.push(g.pop())}return s}class An{constructor(s,c,g,x,A,N,$,Z){const re=s.gl;this.program=re.createProgram();const fe=nn(c.staticAttributes),Me=g?g.getBinderAttributes():[],ke=fe.concat(Me),Ke=ui.prelude.staticUniforms?nn(ui.prelude.staticUniforms):[],Qe=$.staticUniforms?nn($.staticUniforms):[],Tt=c.staticUniforms?nn(c.staticUniforms):[],Ct=g?g.getBinderUniforms():[],At=Ke.concat(Qe).concat(Tt).concat(Ct),Rt=[];for(const jn of At)Rt.indexOf(jn)<0&&Rt.push(jn);const jt=g?g.defines():[];ua(re)&&jt.unshift("#version 300 es"),A&&jt.push("#define OVERDRAW_INSPECTOR;"),N&&jt.push("#define TERRAIN3D;"),Z&&jt.push(Z);let Vt=jt.concat(ui.prelude.fragmentSource,$.fragmentSource,c.fragmentSource).join(`
`),en=jt.concat(ui.prelude.vertexSource,$.vertexSource,c.vertexSource).join(`
`);ua(re)||(Vt=function(jn){return jn.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(Vt),en=function(jn){return jn.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(en));const mn=re.createShader(re.FRAGMENT_SHADER);if(re.isContextLost())return void(this.failedToCreate=!0);if(re.shaderSource(mn,Vt),re.compileShader(mn),!re.getShaderParameter(mn,re.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${re.getShaderInfoLog(mn)}`);re.attachShader(this.program,mn);const on=re.createShader(re.VERTEX_SHADER);if(re.isContextLost())return void(this.failedToCreate=!0);if(re.shaderSource(on,en),re.compileShader(on),!re.getShaderParameter(on,re.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${re.getShaderInfoLog(on)}`);re.attachShader(this.program,on),this.attributes={};const On={};this.numAttributes=ke.length;for(let jn=0;jn<this.numAttributes;jn++)ke[jn]&&(re.bindAttribLocation(this.program,jn,ke[jn]),this.attributes[ke[jn]]=jn);if(re.linkProgram(this.program),!re.getProgramParameter(this.program,re.LINK_STATUS))throw new Error(`Program failed to link: ${re.getProgramInfoLog(this.program)}`);re.deleteShader(on),re.deleteShader(mn);for(let jn=0;jn<Rt.length;jn++){const In=Rt[jn];if(In&&!On[In]){const sr=re.getUniformLocation(this.program,In);sr&&(On[In]=sr)}}this.fixedUniforms=x(s,On),this.terrainUniforms=((jn,In)=>({u_depth:new o.bH(jn,In.u_depth),u_terrain:new o.bH(jn,In.u_terrain),u_terrain_dim:new o.b8(jn,In.u_terrain_dim),u_terrain_matrix:new o.bJ(jn,In.u_terrain_matrix),u_terrain_unpack:new o.bK(jn,In.u_terrain_unpack),u_terrain_exaggeration:new o.b8(jn,In.u_terrain_exaggeration)}))(s,On),this.projectionUniforms=((jn,In)=>({u_projection_matrix:new o.bJ(jn,In.u_projection_matrix),u_projection_tile_mercator_coords:new o.bK(jn,In.u_projection_tile_mercator_coords),u_projection_clipping_plane:new o.bK(jn,In.u_projection_clipping_plane),u_projection_transition:new o.b8(jn,In.u_projection_transition),u_projection_fallback_matrix:new o.bJ(jn,In.u_projection_fallback_matrix)}))(s,On),this.binderUniforms=g?g.getUniforms(s,On):[]}draw(s,c,g,x,A,N,$,Z,re,fe,Me,ke,Ke,Qe,Tt,Ct,At,Rt,jt){const Vt=s.gl;if(this.failedToCreate)return;if(s.program.set(this.program),s.setDepthMode(g),s.setStencilMode(x),s.setColorMode(A),s.setCullFace(N),Z){s.activeTexture.set(Vt.TEXTURE2),Vt.bindTexture(Vt.TEXTURE_2D,Z.depthTexture),s.activeTexture.set(Vt.TEXTURE3),Vt.bindTexture(Vt.TEXTURE_2D,Z.texture);for(const mn in this.terrainUniforms)this.terrainUniforms[mn].set(Z[mn])}if(re)for(const mn in re)this.projectionUniforms[Bt[mn]].set(re[mn]);if($)for(const mn in this.fixedUniforms)this.fixedUniforms[mn].set($[mn]);Ct&&Ct.setUniforms(s,this.binderUniforms,Qe,{zoom:Tt});let en=0;switch(c){case Vt.LINES:en=2;break;case Vt.TRIANGLES:en=3;break;case Vt.LINE_STRIP:en=1}for(const mn of Ke.get()){const on=mn.vaos||(mn.vaos={});(on[fe]||(on[fe]=new J)).bind(s,this,Me,Ct?Ct.getPaintVertexBuffers():[],ke,mn.vertexOffset,At,Rt,jt),Vt.drawElements(c,mn.primitiveLength*en,Vt.UNSIGNED_SHORT,mn.primitiveOffset*en*2)}}}function Xn(E,s,c){const g=1/o.az(c,1,s.transform.tileZoom),x=Math.pow(2,c.tileID.overscaledZ),A=c.tileSize*Math.pow(2,s.transform.tileZoom)/x,N=A*(c.tileID.canonical.x+c.tileID.wrap*x),$=A*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture.size,u_scale:[g,E.fromScale,E.toScale],u_fade:E.t,u_pixel_coord_upper:[N>>16,$>>16],u_pixel_coord_lower:[65535&N,65535&$]}}const wr=(E,s,c,g)=>{const x=E.style.light,A=x.properties.get("position"),N=[A.x,A.y,A.z],$=o.bN();x.properties.get("anchor")==="viewport"&&o.bO($,E.transform.bearingInRadians),o.bP(N,N,$);const Z=E.transform.transformLightDirection(N),re=x.properties.get("color");return{u_lightpos:N,u_lightpos_globe:Z,u_lightintensity:x.properties.get("intensity"),u_lightcolor:[re.r,re.g,re.b],u_vertical_gradient:+s,u_opacity:c,u_fill_translate:g}},Wr=(E,s,c,g,x,A,N)=>o.e(wr(E,s,c,g),Xn(A,E,N),{u_height_factor:-Math.pow(2,x.overscaledZ)/N.tileSize/8}),Zr=(E,s,c,g)=>o.e(Xn(s,E,c),{u_fill_translate:g}),fi=(E,s)=>({u_world:E,u_fill_translate:s}),Pi=(E,s,c,g,x)=>o.e(Zr(E,s,c,x),{u_world:g}),Xi=(E,s,c,g,x)=>{const A=E.transform;let N,$,Z=0;if(c.paint.get("circle-pitch-alignment")==="map"){const re=o.az(s,1,A.zoom);N=!0,$=[re,re],Z=re/(o.Z*Math.pow(2,s.tileID.overscaledZ))*2*Math.PI*x}else N=!1,$=A.pixelsToGLUnits;return{u_camera_to_center_distance:A.cameraToCenterDistance,u_scale_with_map:+(c.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+N,u_device_pixel_ratio:E.pixelRatio,u_extrude_scale:$,u_globe_extrude_scale:Z,u_translate:g}},js=E=>({u_pixel_extrude_scale:[1/E.width,1/E.height]}),cs=E=>({u_viewport_size:[E.width,E.height]}),_s=(E,s=1)=>({u_color:E,u_overlay:0,u_overlay_scale:s}),co=(E,s,c,g)=>{const x=o.az(E,1,s)/(o.Z*Math.pow(2,E.tileID.overscaledZ))*2*Math.PI*g;return{u_extrude_scale:o.az(E,1,s),u_intensity:c,u_globe_extrude_scale:x}},yo=(E,s,c,g)=>{const x=o.K();o.bQ(x,0,E.width,E.height,0,0,1);const A=E.context.gl;return{u_matrix:x,u_world:[A.drawingBufferWidth,A.drawingBufferHeight],u_image:c,u_color_ramp:g,u_opacity:s.paint.get("heatmap-opacity")}},$a=(E,s,c)=>{const g=c.paint.get("hillshade-shadow-color"),x=c.paint.get("hillshade-highlight-color"),A=c.paint.get("hillshade-accent-color");let N=c.paint.get("hillshade-illumination-direction")*(Math.PI/180);return c.paint.get("hillshade-illumination-anchor")==="viewport"&&(N+=E.transform.bearingInRadians),{u_image:0,u_latrange:Qo(0,s.tileID),u_light:[c.paint.get("hillshade-exaggeration"),N],u_shadow:g,u_highlight:x,u_accent:A}},Ri=(E,s)=>{const c=s.stride,g=o.K();return o.bQ(g,0,o.Z,-8192,0,0,1),o.L(g,g,[0,-8192,0]),{u_matrix:g,u_image:1,u_dimension:[c,c],u_zoom:E.overscaledZ,u_unpack:s.getUnpackVector()}};function Qo(E,s){const c=Math.pow(2,s.canonical.z),g=s.canonical.y;return[new o.$(0,g/c).toLngLat().lat,new o.$(0,(g+1)/c).toLngLat().lat]}const mu=(E,s,c,g)=>{const x=E.transform;return{u_translation:Ou(E,s,c),u_ratio:g/o.az(s,1,x.zoom),u_device_pixel_ratio:E.pixelRatio,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},Eo=(E,s,c,g,x)=>o.e(mu(E,s,c,g),{u_image:0,u_image_height:x}),Fc=(E,s,c,g,x)=>{const A=E.transform,N=zc(s,A);return{u_translation:Ou(E,s,c),u_texsize:s.imageAtlasTexture.size,u_ratio:g/o.az(s,1,A.zoom),u_device_pixel_ratio:E.pixelRatio,u_image:0,u_scale:[N,x.fromScale,x.toScale],u_fade:x.t,u_units_to_pixels:[1/A.pixelsToGLUnits[0],1/A.pixelsToGLUnits[1]]}},sl=(E,s,c,g,x,A)=>{const N=E.lineAtlas,$=zc(s,E.transform),Z=c.layout.get("line-cap")==="round",re=N.getDash(x.from,Z),fe=N.getDash(x.to,Z),Me=re.width*A.fromScale,ke=fe.width*A.toScale;return o.e(mu(E,s,c,g),{u_patternscale_a:[$/Me,-re.height/2],u_patternscale_b:[$/ke,-fe.height/2],u_sdfgamma:N.width/(256*Math.min(Me,ke)*E.pixelRatio)/2,u_image:0,u_tex_y_a:re.y,u_tex_y_b:fe.y,u_mix:A.t})};function zc(E,s){return 1/o.az(E,1,s.tileZoom)}function Ou(E,s,c){return o.aA(E.transform,s,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}const Ru=(E,s,c,g,x)=>{return{u_tl_parent:E,u_scale_parent:s,u_buffer_scale:1,u_fade_t:c.mix,u_opacity:c.opacity*g.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:g.paint.get("raster-brightness-min"),u_brightness_high:g.paint.get("raster-brightness-max"),u_saturation_factor:(N=g.paint.get("raster-saturation"),N>0?1-1/(1.001-N):-N),u_contrast_factor:(A=g.paint.get("raster-contrast"),A>0?1/(1-A):1+A),u_spin_weights:_o(g.paint.get("raster-hue-rotate")),u_coords_top:[x[0].x,x[0].y,x[1].x,x[1].y],u_coords_bottom:[x[3].x,x[3].y,x[2].x,x[2].y]};var A,N};function _o(E){E*=Math.PI/180;const s=Math.sin(E),c=Math.cos(E);return[(2*c+1)/3,(-Math.sqrt(3)*s-c+1)/3,(Math.sqrt(3)*s-c+1)/3]}const _l=(E,s,c,g,x,A,N,$,Z,re,fe,Me,ke)=>{const Ke=N.transform;return{u_is_size_zoom_constant:+(E==="constant"||E==="source"),u_is_size_feature_constant:+(E==="constant"||E==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:Ke.cameraToCenterDistance,u_pitch:Ke.pitch/360*2*Math.PI,u_rotate_symbol:+c,u_aspect_ratio:Ke.width/Ke.height,u_fade_change:N.options.fadeDuration?N.symbolFadeChange:1,u_label_plane_matrix:$,u_coord_matrix:Z,u_is_text:+fe,u_pitch_with_map:+g,u_is_along_line:x,u_is_variable_anchor:A,u_texsize:Me,u_texture:0,u_translation:re,u_pitched_scale:ke}},ha=(E,s,c,g,x,A,N,$,Z,re,fe,Me,ke,Ke)=>{const Qe=N.transform;return o.e(_l(E,s,c,g,x,A,N,$,Z,re,fe,Me,Ke),{u_gamma_scale:g?Math.cos(Qe.pitch*Math.PI/180)*Qe.cameraToCenterDistance:1,u_device_pixel_ratio:N.pixelRatio,u_is_halo:1})},Ta=(E,s,c,g,x,A,N,$,Z,re,fe,Me,ke)=>o.e(ha(E,s,c,g,x,A,N,$,Z,re,!0,fe,0,ke),{u_texsize_icon:Me,u_texture_icon:1}),gu=(E,s)=>({u_opacity:E,u_color:s}),Xs=(E,s,c,g,x)=>o.e(function(A,N,$,Z){const re=$.imageManager.getPattern(A.from.toString()),fe=$.imageManager.getPattern(A.to.toString()),{width:Me,height:ke}=$.imageManager.getPixelSize(),Ke=Math.pow(2,Z.tileID.overscaledZ),Qe=Z.tileSize*Math.pow(2,$.transform.tileZoom)/Ke,Tt=Qe*(Z.tileID.canonical.x+Z.tileID.wrap*Ke),Ct=Qe*Z.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:re.tl,u_pattern_br_a:re.br,u_pattern_tl_b:fe.tl,u_pattern_br_b:fe.br,u_texsize:[Me,ke],u_mix:N.t,u_pattern_size_a:re.displaySize,u_pattern_size_b:fe.displaySize,u_scale_a:N.fromScale,u_scale_b:N.toScale,u_tile_units_to_pixels:1/o.az(Z,1,$.transform.tileZoom),u_pixel_coord_upper:[Tt>>16,Ct>>16],u_pixel_coord_lower:[65535&Tt,65535&Ct]}}(c,x,s,g),{u_opacity:E}),zo=(E,s)=>{},ea={fillExtrusion:(E,s)=>({u_lightpos:new o.bL(E,s.u_lightpos),u_lightpos_globe:new o.bL(E,s.u_lightpos_globe),u_lightintensity:new o.b8(E,s.u_lightintensity),u_lightcolor:new o.bL(E,s.u_lightcolor),u_vertical_gradient:new o.b8(E,s.u_vertical_gradient),u_opacity:new o.b8(E,s.u_opacity),u_fill_translate:new o.bM(E,s.u_fill_translate)}),fillExtrusionPattern:(E,s)=>({u_lightpos:new o.bL(E,s.u_lightpos),u_lightpos_globe:new o.bL(E,s.u_lightpos_globe),u_lightintensity:new o.b8(E,s.u_lightintensity),u_lightcolor:new o.bL(E,s.u_lightcolor),u_vertical_gradient:new o.b8(E,s.u_vertical_gradient),u_height_factor:new o.b8(E,s.u_height_factor),u_opacity:new o.b8(E,s.u_opacity),u_fill_translate:new o.bM(E,s.u_fill_translate),u_image:new o.bH(E,s.u_image),u_texsize:new o.bM(E,s.u_texsize),u_pixel_coord_upper:new o.bM(E,s.u_pixel_coord_upper),u_pixel_coord_lower:new o.bM(E,s.u_pixel_coord_lower),u_scale:new o.bL(E,s.u_scale),u_fade:new o.b8(E,s.u_fade)}),fill:(E,s)=>({u_fill_translate:new o.bM(E,s.u_fill_translate)}),fillPattern:(E,s)=>({u_image:new o.bH(E,s.u_image),u_texsize:new o.bM(E,s.u_texsize),u_pixel_coord_upper:new o.bM(E,s.u_pixel_coord_upper),u_pixel_coord_lower:new o.bM(E,s.u_pixel_coord_lower),u_scale:new o.bL(E,s.u_scale),u_fade:new o.b8(E,s.u_fade),u_fill_translate:new o.bM(E,s.u_fill_translate)}),fillOutline:(E,s)=>({u_world:new o.bM(E,s.u_world),u_fill_translate:new o.bM(E,s.u_fill_translate)}),fillOutlinePattern:(E,s)=>({u_world:new o.bM(E,s.u_world),u_image:new o.bH(E,s.u_image),u_texsize:new o.bM(E,s.u_texsize),u_pixel_coord_upper:new o.bM(E,s.u_pixel_coord_upper),u_pixel_coord_lower:new o.bM(E,s.u_pixel_coord_lower),u_scale:new o.bL(E,s.u_scale),u_fade:new o.b8(E,s.u_fade),u_fill_translate:new o.bM(E,s.u_fill_translate)}),circle:(E,s)=>({u_camera_to_center_distance:new o.b8(E,s.u_camera_to_center_distance),u_scale_with_map:new o.bH(E,s.u_scale_with_map),u_pitch_with_map:new o.bH(E,s.u_pitch_with_map),u_extrude_scale:new o.bM(E,s.u_extrude_scale),u_device_pixel_ratio:new o.b8(E,s.u_device_pixel_ratio),u_globe_extrude_scale:new o.b8(E,s.u_globe_extrude_scale),u_translate:new o.bM(E,s.u_translate)}),collisionBox:(E,s)=>({u_pixel_extrude_scale:new o.bM(E,s.u_pixel_extrude_scale)}),collisionCircle:(E,s)=>({u_viewport_size:new o.bM(E,s.u_viewport_size)}),debug:(E,s)=>({u_color:new o.bI(E,s.u_color),u_overlay:new o.bH(E,s.u_overlay),u_overlay_scale:new o.b8(E,s.u_overlay_scale)}),depth:zo,clippingMask:zo,heatmap:(E,s)=>({u_extrude_scale:new o.b8(E,s.u_extrude_scale),u_intensity:new o.b8(E,s.u_intensity),u_globe_extrude_scale:new o.b8(E,s.u_globe_extrude_scale)}),heatmapTexture:(E,s)=>({u_matrix:new o.bJ(E,s.u_matrix),u_world:new o.bM(E,s.u_world),u_image:new o.bH(E,s.u_image),u_color_ramp:new o.bH(E,s.u_color_ramp),u_opacity:new o.b8(E,s.u_opacity)}),hillshade:(E,s)=>({u_image:new o.bH(E,s.u_image),u_latrange:new o.bM(E,s.u_latrange),u_light:new o.bM(E,s.u_light),u_shadow:new o.bI(E,s.u_shadow),u_highlight:new o.bI(E,s.u_highlight),u_accent:new o.bI(E,s.u_accent)}),hillshadePrepare:(E,s)=>({u_matrix:new o.bJ(E,s.u_matrix),u_image:new o.bH(E,s.u_image),u_dimension:new o.bM(E,s.u_dimension),u_zoom:new o.b8(E,s.u_zoom),u_unpack:new o.bK(E,s.u_unpack)}),line:(E,s)=>({u_translation:new o.bM(E,s.u_translation),u_ratio:new o.b8(E,s.u_ratio),u_device_pixel_ratio:new o.b8(E,s.u_device_pixel_ratio),u_units_to_pixels:new o.bM(E,s.u_units_to_pixels)}),lineGradient:(E,s)=>({u_translation:new o.bM(E,s.u_translation),u_ratio:new o.b8(E,s.u_ratio),u_device_pixel_ratio:new o.b8(E,s.u_device_pixel_ratio),u_units_to_pixels:new o.bM(E,s.u_units_to_pixels),u_image:new o.bH(E,s.u_image),u_image_height:new o.b8(E,s.u_image_height)}),linePattern:(E,s)=>({u_translation:new o.bM(E,s.u_translation),u_texsize:new o.bM(E,s.u_texsize),u_ratio:new o.b8(E,s.u_ratio),u_device_pixel_ratio:new o.b8(E,s.u_device_pixel_ratio),u_image:new o.bH(E,s.u_image),u_units_to_pixels:new o.bM(E,s.u_units_to_pixels),u_scale:new o.bL(E,s.u_scale),u_fade:new o.b8(E,s.u_fade)}),lineSDF:(E,s)=>({u_translation:new o.bM(E,s.u_translation),u_ratio:new o.b8(E,s.u_ratio),u_device_pixel_ratio:new o.b8(E,s.u_device_pixel_ratio),u_units_to_pixels:new o.bM(E,s.u_units_to_pixels),u_patternscale_a:new o.bM(E,s.u_patternscale_a),u_patternscale_b:new o.bM(E,s.u_patternscale_b),u_sdfgamma:new o.b8(E,s.u_sdfgamma),u_image:new o.bH(E,s.u_image),u_tex_y_a:new o.b8(E,s.u_tex_y_a),u_tex_y_b:new o.b8(E,s.u_tex_y_b),u_mix:new o.b8(E,s.u_mix)}),raster:(E,s)=>({u_tl_parent:new o.bM(E,s.u_tl_parent),u_scale_parent:new o.b8(E,s.u_scale_parent),u_buffer_scale:new o.b8(E,s.u_buffer_scale),u_fade_t:new o.b8(E,s.u_fade_t),u_opacity:new o.b8(E,s.u_opacity),u_image0:new o.bH(E,s.u_image0),u_image1:new o.bH(E,s.u_image1),u_brightness_low:new o.b8(E,s.u_brightness_low),u_brightness_high:new o.b8(E,s.u_brightness_high),u_saturation_factor:new o.b8(E,s.u_saturation_factor),u_contrast_factor:new o.b8(E,s.u_contrast_factor),u_spin_weights:new o.bL(E,s.u_spin_weights),u_coords_top:new o.bK(E,s.u_coords_top),u_coords_bottom:new o.bK(E,s.u_coords_bottom)}),symbolIcon:(E,s)=>({u_is_size_zoom_constant:new o.bH(E,s.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bH(E,s.u_is_size_feature_constant),u_size_t:new o.b8(E,s.u_size_t),u_size:new o.b8(E,s.u_size),u_camera_to_center_distance:new o.b8(E,s.u_camera_to_center_distance),u_pitch:new o.b8(E,s.u_pitch),u_rotate_symbol:new o.bH(E,s.u_rotate_symbol),u_aspect_ratio:new o.b8(E,s.u_aspect_ratio),u_fade_change:new o.b8(E,s.u_fade_change),u_label_plane_matrix:new o.bJ(E,s.u_label_plane_matrix),u_coord_matrix:new o.bJ(E,s.u_coord_matrix),u_is_text:new o.bH(E,s.u_is_text),u_pitch_with_map:new o.bH(E,s.u_pitch_with_map),u_is_along_line:new o.bH(E,s.u_is_along_line),u_is_variable_anchor:new o.bH(E,s.u_is_variable_anchor),u_texsize:new o.bM(E,s.u_texsize),u_texture:new o.bH(E,s.u_texture),u_translation:new o.bM(E,s.u_translation),u_pitched_scale:new o.b8(E,s.u_pitched_scale)}),symbolSDF:(E,s)=>({u_is_size_zoom_constant:new o.bH(E,s.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bH(E,s.u_is_size_feature_constant),u_size_t:new o.b8(E,s.u_size_t),u_size:new o.b8(E,s.u_size),u_camera_to_center_distance:new o.b8(E,s.u_camera_to_center_distance),u_pitch:new o.b8(E,s.u_pitch),u_rotate_symbol:new o.bH(E,s.u_rotate_symbol),u_aspect_ratio:new o.b8(E,s.u_aspect_ratio),u_fade_change:new o.b8(E,s.u_fade_change),u_label_plane_matrix:new o.bJ(E,s.u_label_plane_matrix),u_coord_matrix:new o.bJ(E,s.u_coord_matrix),u_is_text:new o.bH(E,s.u_is_text),u_pitch_with_map:new o.bH(E,s.u_pitch_with_map),u_is_along_line:new o.bH(E,s.u_is_along_line),u_is_variable_anchor:new o.bH(E,s.u_is_variable_anchor),u_texsize:new o.bM(E,s.u_texsize),u_texture:new o.bH(E,s.u_texture),u_gamma_scale:new o.b8(E,s.u_gamma_scale),u_device_pixel_ratio:new o.b8(E,s.u_device_pixel_ratio),u_is_halo:new o.bH(E,s.u_is_halo),u_translation:new o.bM(E,s.u_translation),u_pitched_scale:new o.b8(E,s.u_pitched_scale)}),symbolTextAndIcon:(E,s)=>({u_is_size_zoom_constant:new o.bH(E,s.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bH(E,s.u_is_size_feature_constant),u_size_t:new o.b8(E,s.u_size_t),u_size:new o.b8(E,s.u_size),u_camera_to_center_distance:new o.b8(E,s.u_camera_to_center_distance),u_pitch:new o.b8(E,s.u_pitch),u_rotate_symbol:new o.bH(E,s.u_rotate_symbol),u_aspect_ratio:new o.b8(E,s.u_aspect_ratio),u_fade_change:new o.b8(E,s.u_fade_change),u_label_plane_matrix:new o.bJ(E,s.u_label_plane_matrix),u_coord_matrix:new o.bJ(E,s.u_coord_matrix),u_is_text:new o.bH(E,s.u_is_text),u_pitch_with_map:new o.bH(E,s.u_pitch_with_map),u_is_along_line:new o.bH(E,s.u_is_along_line),u_is_variable_anchor:new o.bH(E,s.u_is_variable_anchor),u_texsize:new o.bM(E,s.u_texsize),u_texsize_icon:new o.bM(E,s.u_texsize_icon),u_texture:new o.bH(E,s.u_texture),u_texture_icon:new o.bH(E,s.u_texture_icon),u_gamma_scale:new o.b8(E,s.u_gamma_scale),u_device_pixel_ratio:new o.b8(E,s.u_device_pixel_ratio),u_is_halo:new o.bH(E,s.u_is_halo),u_translation:new o.bM(E,s.u_translation),u_pitched_scale:new o.b8(E,s.u_pitched_scale)}),background:(E,s)=>({u_opacity:new o.b8(E,s.u_opacity),u_color:new o.bI(E,s.u_color)}),backgroundPattern:(E,s)=>({u_opacity:new o.b8(E,s.u_opacity),u_image:new o.bH(E,s.u_image),u_pattern_tl_a:new o.bM(E,s.u_pattern_tl_a),u_pattern_br_a:new o.bM(E,s.u_pattern_br_a),u_pattern_tl_b:new o.bM(E,s.u_pattern_tl_b),u_pattern_br_b:new o.bM(E,s.u_pattern_br_b),u_texsize:new o.bM(E,s.u_texsize),u_mix:new o.b8(E,s.u_mix),u_pattern_size_a:new o.bM(E,s.u_pattern_size_a),u_pattern_size_b:new o.bM(E,s.u_pattern_size_b),u_scale_a:new o.b8(E,s.u_scale_a),u_scale_b:new o.b8(E,s.u_scale_b),u_pixel_coord_upper:new o.bM(E,s.u_pixel_coord_upper),u_pixel_coord_lower:new o.bM(E,s.u_pixel_coord_lower),u_tile_units_to_pixels:new o.b8(E,s.u_tile_units_to_pixels)}),terrain:(E,s)=>({u_texture:new o.bH(E,s.u_texture),u_ele_delta:new o.b8(E,s.u_ele_delta),u_fog_matrix:new o.bJ(E,s.u_fog_matrix),u_fog_color:new o.bI(E,s.u_fog_color),u_fog_ground_blend:new o.b8(E,s.u_fog_ground_blend),u_fog_ground_blend_opacity:new o.b8(E,s.u_fog_ground_blend_opacity),u_horizon_color:new o.bI(E,s.u_horizon_color),u_horizon_fog_blend:new o.b8(E,s.u_horizon_fog_blend),u_is_globe_mode:new o.b8(E,s.u_is_globe_mode)}),terrainDepth:(E,s)=>({u_ele_delta:new o.b8(E,s.u_ele_delta)}),terrainCoords:(E,s)=>({u_texture:new o.bH(E,s.u_texture),u_terrain_coords_id:new o.b8(E,s.u_terrain_coords_id),u_ele_delta:new o.b8(E,s.u_ele_delta)}),projectionErrorMeasurement:(E,s)=>({u_input:new o.b8(E,s.u_input),u_output_expected:new o.b8(E,s.u_output_expected)}),atmosphere:(E,s)=>({u_sun_pos:new o.bL(E,s.u_sun_pos),u_atmosphere_blend:new o.b8(E,s.u_atmosphere_blend),u_globe_position:new o.bL(E,s.u_globe_position),u_globe_radius:new o.b8(E,s.u_globe_radius),u_inv_proj_matrix:new o.bJ(E,s.u_inv_proj_matrix)}),sky:(E,s)=>({u_sky_color:new o.bI(E,s.u_sky_color),u_horizon_color:new o.bI(E,s.u_horizon_color),u_horizon:new o.bM(E,s.u_horizon),u_horizon_normal:new o.bM(E,s.u_horizon_normal),u_sky_horizon_blend:new o.b8(E,s.u_sky_horizon_blend),u_sky_blend:new o.b8(E,s.u_sky_blend)})};class jc{constructor(s,c,g){this.context=s;const x=s.gl;this.buffer=x.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),s.bindElementBuffer.set(this.buffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(s){const c=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Mo={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class jl{constructor(s,c,g,x){this.length=c.length,this.attributes=g,this.itemSize=c.bytesPerElement,this.dynamicDraw=x,this.context=s;const A=s.gl;this.buffer=A.createBuffer(),s.bindVertexBuffer.set(this.buffer),A.bufferData(A.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?A.DYNAMIC_DRAW:A.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){if(s.length!==this.length)throw new Error(`Length of new data is ${s.length}, which doesn't match current length of ${this.length}`);const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,c){for(let g=0;g<this.attributes.length;g++){const x=c.attributes[this.attributes[g].name];x!==void 0&&s.enableVertexAttribArray(x)}}setVertexAttribPointers(s,c,g){for(let x=0;x<this.attributes.length;x++){const A=this.attributes[x],N=c.attributes[A.name];N!==void 0&&s.vertexAttribPointer(N,A.components,s[Mo[A.type]],!1,this.itemSize,A.offset+this.itemSize*(g||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class mi{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class jo extends mi{getDefault(){return o.b7.transparent}set(s){const c=this.current;(s.r!==c.r||s.g!==c.g||s.b!==c.b||s.a!==c.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class Bu extends mi{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class Nu extends mi{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class da extends mi{getDefault(){return[!0,!0,!0,!0]}set(s){const c=this.current;(s[0]!==c[0]||s[1]!==c[1]||s[2]!==c[2]||s[3]!==c[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class ta extends mi{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class Ul extends mi{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class ol extends mi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){const c=this.current;(s.func!==c.func||s.ref!==c.ref||s.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class na extends mi{getDefault(){const s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){const c=this.current;(s[0]!==c[0]||s[1]!==c[1]||s[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class Ln extends mi{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const c=this.gl;s?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=s,this.dirty=!1}}class nr extends mi{getDefault(){return[0,1]}set(s){const c=this.current;(s[0]!==c[0]||s[1]!==c[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class Fn extends mi{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const c=this.gl;s?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=s,this.dirty=!1}}class Hr extends mi{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class ii extends mi{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const c=this.gl;s?c.enable(c.BLEND):c.disable(c.BLEND),this.current=s,this.dirty=!1}}class xi extends mi{getDefault(){const s=this.gl;return[s.ONE,s.ZERO]}set(s){const c=this.current;(s[0]!==c[0]||s[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(s[0],s[1]),this.current=s,this.dirty=!1)}}class as extends mi{getDefault(){return o.b7.transparent}set(s){const c=this.current;(s.r!==c.r||s.g!==c.g||s.b!==c.b||s.a!==c.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class Cs extends mi{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquation(s),this.current=s,this.dirty=!1)}}class dc extends mi{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const c=this.gl;s?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=s,this.dirty=!1}}class ra extends mi{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class Ts extends mi{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}class al extends mi{getDefault(){return null}set(s){(s!==this.current||this.dirty)&&(this.gl.useProgram(s),this.current=s,this.dirty=!1)}}class bl extends mi{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class Ga extends mi{getDefault(){const s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){const c=this.current;(s[0]!==c[0]||s[1]!==c[1]||s[2]!==c[2]||s[3]!==c[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class ll extends mi{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class Vl extends mi{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Ui extends mi{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class fa extends mi{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class Uo extends mi{getDefault(){return null}set(s){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class bs extends mi{getDefault(){return null}set(s){var c;if(s===this.current&&!this.dirty)return;const g=this.gl;ua(g)?g.bindVertexArray(s):(c=g.getExtension("OES_vertex_array_object"))===null||c===void 0||c.bindVertexArrayOES(s),this.current=s,this.dirty=!1}}class oi extends mi{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class io extends mi{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class Us extends mi{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class pa extends mi{constructor(s,c){super(s),this.context=s,this.parent=c}getDefault(){return null}}class Vo extends pa{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class xl extends pa{set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class ah extends pa{set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.RENDERBUFFER,s),this.current=s,this.dirty=!1}}const wl="Framebuffer is not complete";class To{constructor(s,c,g,x,A){this.context=s,this.width=c,this.height=g;const N=s.gl,$=this.framebuffer=N.createFramebuffer();if(this.colorAttachment=new Vo(s,$),x)this.depthAttachment=A?new ah(s,$):new xl(s,$);else if(A)throw new Error("Stencil cannot be set without depth");if(N.checkFramebufferStatus(N.FRAMEBUFFER)!==N.FRAMEBUFFER_COMPLETE)throw new Error(wl)}destroy(){const s=this.context.gl,c=this.colorAttachment.get();if(c&&s.deleteTexture(c),this.depthAttachment){const g=this.depthAttachment.get();g&&s.deleteRenderbuffer(g)}s.deleteFramebuffer(this.framebuffer)}}class ks{constructor(s){var c,g;if(this.gl=s,this.clearColor=new jo(this),this.clearDepth=new Bu(this),this.clearStencil=new Nu(this),this.colorMask=new da(this),this.depthMask=new ta(this),this.stencilMask=new Ul(this),this.stencilFunc=new ol(this),this.stencilOp=new na(this),this.stencilTest=new Ln(this),this.depthRange=new nr(this),this.depthTest=new Fn(this),this.depthFunc=new Hr(this),this.blend=new ii(this),this.blendFunc=new xi(this),this.blendColor=new as(this),this.blendEquation=new Cs(this),this.cullFace=new dc(this),this.cullFaceSide=new ra(this),this.frontFace=new Ts(this),this.program=new al(this),this.activeTexture=new bl(this),this.viewport=new Ga(this),this.bindFramebuffer=new ll(this),this.bindRenderbuffer=new Vl(this),this.bindTexture=new Ui(this),this.bindVertexBuffer=new fa(this),this.bindElementBuffer=new Uo(this),this.bindVertexArray=new bs(this),this.pixelStoreUnpack=new oi(this),this.pixelStoreUnpackPremultiplyAlpha=new io(this),this.pixelStoreUnpackFlipY=new Us(this),this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),ua(s)){this.HALF_FLOAT=s.HALF_FLOAT;const x=s.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(c=s.RGBA16F)!==null&&c!==void 0?c:x==null?void 0:x.RGBA16F_EXT,this.RGB16F=(g=s.RGB16F)!==null&&g!==void 0?g:x==null?void 0:x.RGB16F_EXT,s.getExtension("EXT_color_buffer_float")}else{s.getExtension("EXT_color_buffer_half_float"),s.getExtension("OES_texture_half_float_linear");const x=s.getExtension("OES_texture_half_float");this.HALF_FLOAT=x==null?void 0:x.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,c){return new jc(this,s,c)}createVertexBuffer(s,c,g){return new jl(this,s,c,g)}createRenderbuffer(s,c,g){const x=this.gl,A=x.createRenderbuffer();return this.bindRenderbuffer.set(A),x.renderbufferStorage(x.RENDERBUFFER,s,c,g),this.bindRenderbuffer.set(null),A}createFramebuffer(s,c,g,x){return new To(this,s,c,g,x)}clear({color:s,depth:c,stencil:g}){const x=this.gl;let A=0;s&&(A|=x.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),c!==void 0&&(A|=x.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),g!==void 0&&(A|=x.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),x.clear(A)}setCullFace(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){o.bE(s.blendFunction,qi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor)),this.colorMask.set(s.mask)}createVertexArray(){var s;return ua(this.gl)?this.gl.createVertexArray():(s=this.gl.getExtension("OES_vertex_array_object"))===null||s===void 0?void 0:s.createVertexArrayOES()}deleteVertexArray(s){var c;return ua(this.gl)?this.gl.deleteVertexArray(s):(c=this.gl.getExtension("OES_vertex_array_object"))===null||c===void 0?void 0:c.deleteVertexArrayOES(s)}unbindVAO(){this.bindVertexArray.set(null)}}let ho;function $o(E,s,c,g,x){const A=E.context,N=E.transform,$=A.gl,Z=E.useProgram("collisionBox"),re=[];let fe=0,Me=0;for(let At=0;At<g.length;At++){const Rt=g[At],jt=s.getTile(Rt).getBucket(c);if(!jt)continue;const Vt=x?jt.textCollisionBox:jt.iconCollisionBox,en=jt.collisionCircleArray;en.length>0&&(re.push({circleArray:en,circleOffset:Me,coord:Rt}),fe+=en.length/4,Me=fe),Vt&&Z.draw(A,$.LINES,Nr.disabled,Oi.disabled,E.colorModeForRenderPass(),Gi.disabled,js(E.transform),E.style.map.terrain&&E.style.map.terrain.getTerrainData(Rt),N.getProjectionData({overscaledTileID:Rt,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),c.id,Vt.layoutVertexBuffer,Vt.indexBuffer,Vt.segments,null,E.transform.zoom,null,null,Vt.collisionVertexBuffer)}if(!x||!re.length)return;const ke=E.useProgram("collisionCircle"),Ke=new o.bR;Ke.resize(4*fe),Ke._trim();let Qe=0;for(const At of re)for(let Rt=0;Rt<At.circleArray.length/4;Rt++){const jt=4*Rt,Vt=At.circleArray[jt+0],en=At.circleArray[jt+1],mn=At.circleArray[jt+2],on=At.circleArray[jt+3];Ke.emplace(Qe++,Vt,en,mn,on,0),Ke.emplace(Qe++,Vt,en,mn,on,1),Ke.emplace(Qe++,Vt,en,mn,on,2),Ke.emplace(Qe++,Vt,en,mn,on,3)}(!ho||ho.length<2*fe)&&(ho=function(At){const Rt=2*At,jt=new o.bT;jt.resize(Rt),jt._trim();for(let Vt=0;Vt<Rt;Vt++){const en=6*Vt;jt.uint16[en+0]=4*Vt+0,jt.uint16[en+1]=4*Vt+1,jt.uint16[en+2]=4*Vt+2,jt.uint16[en+3]=4*Vt+2,jt.uint16[en+4]=4*Vt+3,jt.uint16[en+5]=4*Vt+0}return jt}(fe));const Tt=A.createIndexBuffer(ho,!0),Ct=A.createVertexBuffer(Ke,o.bS.members,!0);for(const At of re){const Rt=cs(E.transform);ke.draw(A,$.TRIANGLES,Nr.disabled,Oi.disabled,E.colorModeForRenderPass(),Gi.disabled,Rt,E.style.map.terrain&&E.style.map.terrain.getTerrainData(At.coord),null,c.id,Ct,Tt,o.aJ.simpleSegment(0,2*At.circleOffset,At.circleArray.length,At.circleArray.length/2),null,E.transform.zoom,null,null,null)}Ct.destroy(),Tt.destroy()}const vi=o.ad(new Float32Array(16));function $l(E,s,c,g,x,A){const{horizontalAlign:N,verticalAlign:$}=o.aE(E);return new o.P((-(N-.5)*s/x+g[0])*A,(-($-.5)*c/x+g[1])*A)}function yu(E,s,c,g,x,A){const N=s.tileAnchorPoint.add(new o.P(s.translation[0],s.translation[1]));if(s.pitchWithMap){let $=g.mult(A);c||($=$.rotate(-x));const Z=N.add($);return br(Z.x,Z.y,s.pitchedLabelPlaneMatrix,s.getElevation).point}if(c){const $=ai(s.tileAnchorPoint.x+1,s.tileAnchorPoint.y,s).point.sub(E),Z=Math.atan($.y/$.x)+($.x<0?Math.PI:0);return E.add(g.rotate(Z))}return E.add(g)}function Ha(E,s,c,g,x,A,N,$,Z,re,fe,Me){const ke=E.text.placedSymbolArray,Ke=E.text.dynamicLayoutVertexArray,Qe=E.icon.dynamicLayoutVertexArray,Tt={};Ke.clear();for(let Ct=0;Ct<ke.length;Ct++){const At=ke.get(Ct),Rt=At.hidden||!At.crossTileID||E.allowVerticalPlacement&&!At.placedOrientation?null:g[At.crossTileID];if(Rt){const jt=new o.P(At.anchorX,At.anchorY),Vt={getElevation:Me,width:x.width,height:x.height,pitchedLabelPlaneMatrix:A,pitchWithMap:c,transform:x,tileAnchorPoint:jt,translation:re,unwrappedTileID:fe},en=c?As(jt.x,jt.y,Vt):ai(jt.x,jt.y,Vt),mn=vr(x.cameraToCenterDistance,en.signedDistanceFromCamera);let on=o.am(E.textSizeData,$,At)*mn/o.ay;c&&(on*=E.tilePixelRatio/N);const{width:On,height:jn,anchor:In,textOffset:sr,textBoxScale:tr}=Rt,Or=$l(In,On,jn,sr,tr,on),Sr=x.getPitchedTextCorrection(jt.x+re[0],jt.y+re[1],fe),mr=yu(en.point,Vt,s,Or,-x.bearingInRadians,Sr),ti=E.allowVerticalPlacement&&At.placedOrientation===o.al.vertical?Math.PI/2:0;for(let wi=0;wi<At.numGlyphs;wi++)o.as(Ke,mr,ti);Z&&At.associatedIconIndex>=0&&(Tt[At.associatedIconIndex]={shiftedAnchor:mr,angle:ti})}else Yi(At.numGlyphs,Ke)}if(Z){Qe.clear();const Ct=E.icon.placedSymbolArray;for(let At=0;At<Ct.length;At++){const Rt=Ct.get(At);if(Rt.hidden)Yi(Rt.numGlyphs,Qe);else{const jt=Tt[At];if(jt)for(let Vt=0;Vt<Rt.numGlyphs;Vt++)o.as(Qe,jt.shiftedAnchor,jt.angle);else Yi(Rt.numGlyphs,Qe)}}E.icon.dynamicLayoutVertexBuffer.updateData(Qe)}E.text.dynamicLayoutVertexBuffer.updateData(Ke)}function Go(E,s,c){return c.iconsInText&&s?"symbolTextAndIcon":E?"symbolSDF":"symbolIcon"}function Uc(E,s,c,g,x,A,N,$,Z,re,fe,Me,ke){const Ke=E.context,Qe=Ke.gl,Tt=E.transform,Ct=$==="map",At=Z==="map",Rt=$!=="viewport"&&c.layout.get("symbol-placement")!=="point",jt=Ct&&!At&&!Rt,Vt=!c.layout.get("symbol-sort-key").isConstant();let en=!1;const mn=E.getDepthModeForSublayer(0,Nr.ReadOnly),on=c._unevaluatedLayout.hasValue("text-variable-anchor")||c._unevaluatedLayout.hasValue("text-variable-anchor-offset"),On=[],jn=Tt.getCircleRadiusCorrection();for(const In of g){const sr=s.getTile(In),tr=sr.getBucket(c);if(!tr)continue;const Or=x?tr.text:tr.icon;if(!Or||!Or.segments.get().length||!Or.hasVisibleVertices)continue;const Sr=Or.programConfigurations.get(c.id),mr=x||tr.sdfIcons,ti=x?tr.textSizeData:tr.iconSizeData,wi=At||Tt.pitch!==0,Ei=E.useProgram(Go(mr,x,tr),Sr),Os=o.ak(ti,Tt.zoom),Rs=E.style.map.terrain&&E.style.map.terrain.getTerrainData(In);let fo,po,Ji,hs,ko=[0,0],sa=null;if(x)po=sr.glyphAtlasTexture,Ji=Qe.LINEAR,fo=sr.glyphAtlasTexture.size,tr.iconsInText&&(ko=sr.imageAtlasTexture.size,sa=sr.imageAtlasTexture,hs=wi||E.options.rotating||E.options.zooming||ti.kind==="composite"||ti.kind==="camera"?Qe.LINEAR:Qe.NEAREST);else{const oa=c.layout.get("icon-size").constantOr(0)!==1||tr.iconsNeedLinear;po=sr.imageAtlasTexture,Ji=mr||E.options.rotating||E.options.zooming||oa||wi?Qe.LINEAR:Qe.NEAREST,fo=sr.imageAtlasTexture.size}const Zo=o.az(sr,1,E.transform.zoom),bo=vt(Ct,E.transform,Zo),Wa=o.K();o.an(Wa,bo);const Hl=Tn(At,Ct,E.transform,Zo),ju=o.aA(Tt,sr,A,N),tc=Tt.getProjectionData({overscaledTileID:In,applyGlobeMatrix:!ke,applyTerrainMatrix:!0}),ul=on&&tr.hasTextData(),Qh=c.layout.get("icon-text-fit")!=="none"&&ul&&tr.hasIconData();if(Rt){const oa=E.style.map.terrain?(ga,Do)=>E.style.map.terrain.getElevation(In,ga,Do):null,Io=c.layout.get("text-rotation-alignment")==="map";pn(tr,E,x,bo,Wa,At,re,Io,In.toUnwrapped(),Tt.width,Tt.height,ju,oa)}const ql=x&&on||Qh,Wl=Rt||ql?vi:At?bo:E.transform.clipSpaceToPixelsMatrix,ed=mr&&c.paint.get(x?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ch;ch=mr?tr.iconsInText?Ta(ti.kind,Os,jt,At,Rt,ql,E,Wl,Hl,ju,fo,ko,jn):ha(ti.kind,Os,jt,At,Rt,ql,E,Wl,Hl,ju,x,fo,0,jn):_l(ti.kind,Os,jt,At,Rt,ql,E,Wl,Hl,ju,x,fo,jn);const td={program:Ei,buffers:Or,uniformValues:ch,projectionData:tc,atlasTexture:po,atlasTextureIcon:sa,atlasInterpolation:Ji,atlasInterpolationIcon:hs,isSDF:mr,hasHalo:ed};if(Vt&&tr.canOverlap){en=!0;const oa=Or.segments.get();for(const Io of oa)On.push({segments:new o.aJ([Io]),sortKey:Io.sortKey,state:td,terrainData:Rs})}else On.push({segments:Or.segments,sortKey:0,state:td,terrainData:Rs})}en&&On.sort((In,sr)=>In.sortKey-sr.sortKey);for(const In of On){const sr=In.state;if(Ke.activeTexture.set(Qe.TEXTURE0),sr.atlasTexture.bind(sr.atlasInterpolation,Qe.CLAMP_TO_EDGE),sr.atlasTextureIcon&&(Ke.activeTexture.set(Qe.TEXTURE1),sr.atlasTextureIcon&&sr.atlasTextureIcon.bind(sr.atlasInterpolationIcon,Qe.CLAMP_TO_EDGE)),sr.isSDF){const tr=sr.uniformValues;sr.hasHalo&&(tr.u_is_halo=1,Ho(sr.buffers,In.segments,c,E,sr.program,mn,fe,Me,tr,sr.projectionData,In.terrainData)),tr.u_is_halo=0}Ho(sr.buffers,In.segments,c,E,sr.program,mn,fe,Me,sr.uniformValues,sr.projectionData,In.terrainData)}}function Ho(E,s,c,g,x,A,N,$,Z,re,fe){const Me=g.context;x.draw(Me,Me.gl.TRIANGLES,A,N,$,Gi.backCCW,Z,fe,re,c.id,E.layoutVertexBuffer,E.indexBuffer,s,c.paint,g.transform.zoom,E.programConfigurations.get(c.id),E.dynamicLayoutVertexBuffer,E.opacityVertexBuffer)}function Ao(E,s,c,g,x){const A=E.context,N=A.gl,$=Oi.disabled,Z=new qi([N.ONE,N.ONE],o.b7.transparent,[!0,!0,!0,!0]),re=s.getBucket(c);if(!re)return;const fe=g.key;let Me=c.heatmapFbos.get(fe);Me||(Me=p(A,s.tileSize,s.tileSize),c.heatmapFbos.set(fe,Me)),A.bindFramebuffer.set(Me.framebuffer),A.viewport.set([0,0,s.tileSize,s.tileSize]),A.clear({color:o.b7.transparent});const ke=re.programConfigurations.get(c.id),Ke=E.useProgram("heatmap",ke,!x),Qe=E.transform.getProjectionData({overscaledTileID:s.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Tt=E.style.map.terrain.getTerrainData(g);Ke.draw(A,N.TRIANGLES,Nr.disabled,$,Z,Gi.disabled,co(s,E.transform.zoom,c.paint.get("heatmap-intensity"),1),Tt,Qe,c.id,re.layoutVertexBuffer,re.indexBuffer,re.segments,c.paint,E.transform.zoom,ke)}function Gl(E,s,c,g,x){const A=E.context,N=A.gl,$=E.transform;A.setColorMode(E.colorModeForRenderPass());const Z=T(A,s),re=c.key,fe=s.heatmapFbos.get(re);if(!fe)return;A.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,fe.colorAttachment.get()),A.activeTexture.set(N.TEXTURE1),Z.bind(N.LINEAR,N.CLAMP_TO_EDGE);const Me=$.getProjectionData({overscaledTileID:c,applyTerrainMatrix:x,applyGlobeMatrix:!g});E.useProgram("heatmapTexture").draw(A,N.TRIANGLES,Nr.disabled,Oi.disabled,E.colorModeForRenderPass(),Gi.disabled,yo(E,s,0,1),null,Me,s.id,E.rasterBoundsBuffer,E.quadTriangleIndexBuffer,E.rasterBoundsSegments,s.paint,$.zoom),fe.destroy(),s.heatmapFbos.delete(re)}function p(E,s,c){var g,x;const A=E.gl,N=A.createTexture();A.bindTexture(A.TEXTURE_2D,N),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_S,A.CLAMP_TO_EDGE),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_T,A.CLAMP_TO_EDGE),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,A.LINEAR),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,A.LINEAR);const $=(g=E.HALF_FLOAT)!==null&&g!==void 0?g:A.UNSIGNED_BYTE,Z=(x=E.RGBA16F)!==null&&x!==void 0?x:A.RGBA;A.texImage2D(A.TEXTURE_2D,0,Z,s,c,0,A.RGBA,$,null);const re=E.createFramebuffer(s,c,!1,!1);return re.colorAttachment.set(N),re}function T(E,s){return s.colorRampTexture||(s.colorRampTexture=new ue(E,s.colorRamp,E.gl.RGBA)),s.colorRampTexture}function U(E,s,c,g,x){if(!c||!g||!g.imageAtlas)return;const A=g.imageAtlas.patternPositions;let N=A[c.to.toString()],$=A[c.from.toString()];if(!N&&$&&(N=$),!$&&N&&($=N),!N||!$){const Z=x.getPaintProperty(s);N=A[Z],$=A[Z]}N&&$&&E.setConstantPatternPositions(N,$)}function se(E,s,c,g,x,A,N,$){const Z=E.context.gl,re="fill-pattern",fe=c.paint.get(re),Me=fe&&fe.constantOr(1),ke=c.getCrossfadeParameters();let Ke,Qe,Tt,Ct,At;const Rt=E.transform,jt=c.paint.get("fill-translate"),Vt=c.paint.get("fill-translate-anchor");N?(Qe=Me&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Ke=Z.LINES):(Qe=Me?"fillPattern":"fill",Ke=Z.TRIANGLES);const en=fe.constantOr(null);for(const mn of g){const on=s.getTile(mn);if(Me&&!on.patternsLoaded())continue;const On=on.getBucket(c);if(!On)continue;const jn=On.programConfigurations.get(c.id),In=E.useProgram(Qe,jn),sr=E.style.map.terrain&&E.style.map.terrain.getTerrainData(mn);Me&&(E.context.activeTexture.set(Z.TEXTURE0),on.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),jn.updatePaintBuffers(ke)),U(jn,re,en,on,c);const tr=Rt.getProjectionData({overscaledTileID:mn,applyGlobeMatrix:!$,applyTerrainMatrix:!0}),Or=o.aA(Rt,on,jt,Vt);if(N){Ct=On.indexBuffer2,At=On.segments2;const mr=[Z.drawingBufferWidth,Z.drawingBufferHeight];Tt=Qe==="fillOutlinePattern"&&Me?Pi(E,ke,on,mr,Or):fi(mr,Or)}else Ct=On.indexBuffer,At=On.segments,Tt=Me?Zr(E,ke,on,Or):{u_fill_translate:Or};let Sr;if(E.renderPass==="translucent"&&$){const[mr]=E.getStencilConfigForOverlapAndUpdateStencilID(g);Sr=mr[mn.overscaledZ]}else Sr=E.stencilModeForClipping(mn);In.draw(E.context,Ke,x,Sr,A,Gi.backCCW,Tt,sr,tr,c.id,On.layoutVertexBuffer,Ct,At,c.paint,E.transform.zoom,jn)}}function Pe(E,s,c,g,x,A,N,$){const Z=E.context,re=Z.gl,fe="fill-extrusion-pattern",Me=c.paint.get(fe),ke=Me.constantOr(1),Ke=c.getCrossfadeParameters(),Qe=c.paint.get("fill-extrusion-opacity"),Tt=Me.constantOr(null),Ct=E.transform;for(const At of g){const Rt=s.getTile(At),jt=Rt.getBucket(c);if(!jt)continue;const Vt=E.style.map.terrain&&E.style.map.terrain.getTerrainData(At),en=jt.programConfigurations.get(c.id),mn=E.useProgram(ke?"fillExtrusionPattern":"fillExtrusion",en);ke&&(E.context.activeTexture.set(re.TEXTURE0),Rt.imageAtlasTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE),en.updatePaintBuffers(Ke));const on=Ct.getProjectionData({overscaledTileID:At,applyGlobeMatrix:!$,applyTerrainMatrix:!0});U(en,fe,Tt,Rt,c);const On=o.aA(Ct,Rt,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),jn=c.paint.get("fill-extrusion-vertical-gradient"),In=ke?Wr(E,jn,Qe,On,At,Ke,Rt):wr(E,jn,Qe,On);mn.draw(Z,Z.gl.TRIANGLES,x,A,N,Gi.backCCW,In,Vt,on,c.id,jt.layoutVertexBuffer,jt.indexBuffer,jt.segments,c.paint,E.transform.zoom,en,E.style.map.terrain&&jt.centroidVertexBuffer)}}function nt(E,s,c,g,x,A,N,$,Z){var re;const fe=E.style.projection,Me=E.context,ke=E.transform,Ke=Me.gl,Qe=E.useProgram("hillshade"),Tt=!E.options.moving;for(const Ct of g){const At=s.getTile(Ct),Rt=At.fbo;if(!Rt)continue;const jt=fe.getMeshFromTileID(Me,Ct.canonical,$,!0,"raster"),Vt=(re=E.style.map.terrain)===null||re===void 0?void 0:re.getTerrainData(Ct);Me.activeTexture.set(Ke.TEXTURE0),Ke.bindTexture(Ke.TEXTURE_2D,Rt.colorAttachment.get());const en=ke.getProjectionData({overscaledTileID:Ct,aligned:Tt,applyGlobeMatrix:!Z,applyTerrainMatrix:!0});Qe.draw(Me,Ke.TRIANGLES,A,x[Ct.overscaledZ],N,Gi.backCCW,$a(E,At,c),Vt,en,c.id,jt.vertexBuffer,jt.indexBuffer,jt.segments)}}const Jt=[new o.P(0,0),new o.P(o.Z,0),new o.P(o.Z,o.Z),new o.P(0,o.Z)];function Dn(E,s,c,g,x,A,N,$,Z=!1,re=!1){const fe=g[g.length-1].overscaledZ,Me=E.context,ke=Me.gl,Ke=E.useProgram("raster"),Qe=E.transform,Tt=E.style.projection,Ct=E.colorModeForRenderPass(),At=!E.options.moving;for(const Rt of g){const jt=E.getDepthModeForSublayer(Rt.overscaledZ-fe,c.paint.get("raster-opacity")===1?Nr.ReadWrite:Nr.ReadOnly,ke.LESS),Vt=s.getTile(Rt);Vt.registerFadeDuration(c.paint.get("raster-fade-duration"));const en=s.findLoadedParent(Rt,0),mn=s.findLoadedSibling(Rt),on=Jn(Vt,en||mn||null,s,c,E.transform,E.style.map.terrain);let On,jn;const In=c.paint.get("raster-resampling")==="nearest"?ke.NEAREST:ke.LINEAR;Me.activeTexture.set(ke.TEXTURE0),Vt.texture.bind(In,ke.CLAMP_TO_EDGE,ke.LINEAR_MIPMAP_NEAREST),Me.activeTexture.set(ke.TEXTURE1),en?(en.texture.bind(In,ke.CLAMP_TO_EDGE,ke.LINEAR_MIPMAP_NEAREST),On=Math.pow(2,en.tileID.overscaledZ-Vt.tileID.overscaledZ),jn=[Vt.tileID.canonical.x*On%1,Vt.tileID.canonical.y*On%1]):Vt.texture.bind(In,ke.CLAMP_TO_EDGE,ke.LINEAR_MIPMAP_NEAREST),Vt.texture.useMipmap&&Me.extTextureFilterAnisotropic&&E.transform.pitch>20&&ke.texParameterf(ke.TEXTURE_2D,Me.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Me.extTextureFilterAnisotropicMax);const sr=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Rt),tr=Qe.getProjectionData({overscaledTileID:Rt,aligned:At,applyGlobeMatrix:!re,applyTerrainMatrix:!0}),Or=Ru(jn||[0,0],On||1,on,c,$),Sr=Tt.getMeshFromTileID(Me,Rt.canonical,A,N,"raster");Ke.draw(Me,ke.TRIANGLES,jt,x?x[Rt.overscaledZ]:Oi.disabled,Ct,Z?Gi.frontCCW:Gi.backCCW,Or,sr,tr,c.id,Sr.vertexBuffer,Sr.indexBuffer,Sr.segments)}}function Jn(E,s,c,g,x,A){const N=g.paint.get("raster-fade-duration");if(!A&&N>0){const $=M.now(),Z=($-E.timeAdded)/N,re=s?($-s.timeAdded)/N:-1,fe=c.getSource(),Me=hn(x,{tileSize:fe.tileSize,roundZoom:fe.roundZoom}),ke=!s||Math.abs(s.tileID.overscaledZ-Me)>Math.abs(E.tileID.overscaledZ-Me),Ke=ke&&E.refreshedUponExpiration?1:o.ae(ke?Z:1-re,0,1);return E.refreshedUponExpiration&&Z>=1&&(E.refreshedUponExpiration=!1),s?{opacity:1,mix:1-Ke}:{opacity:Ke,mix:0}}return{opacity:1,mix:0}}const ar=new o.b7(1,0,0,1),Vr=new o.b7(0,1,0,1),Jr=new o.b7(0,0,1,1),Vi=new o.b7(1,0,1,1),vo=new o.b7(0,1,1,1);function Js(E,s,c,g){Ss(E,0,s+c/2,E.transform.width,c,g)}function so(E,s,c,g){Ss(E,s-c/2,0,c,E.transform.height,g)}function Ss(E,s,c,g,x,A){const N=E.context,$=N.gl;$.enable($.SCISSOR_TEST),$.scissor(s*E.pixelRatio,c*E.pixelRatio,g*E.pixelRatio,x*E.pixelRatio),N.clear({color:A}),$.disable($.SCISSOR_TEST)}function ma(E,s,c){const g=E.context,x=g.gl,A=E.useProgram("debug"),N=Nr.disabled,$=Oi.disabled,Z=E.colorModeForRenderPass(),re="$debug",fe=E.style.map.terrain&&E.style.map.terrain.getTerrainData(c);g.activeTexture.set(x.TEXTURE0);const Me=s.getTileByID(c.key).latestRawTileData,ke=Math.floor((Me&&Me.byteLength||0)/1024),Ke=s.getTile(c).tileSize,Qe=512/Math.min(Ke,512)*(c.overscaledZ/E.transform.zoom)*.5;let Tt=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(Tt+=` => ${c.overscaledZ}`),function(At,Rt){At.initDebugOverlayCanvas();const jt=At.debugOverlayCanvas,Vt=At.context.gl,en=At.debugOverlayCanvas.getContext("2d");en.clearRect(0,0,jt.width,jt.height),en.shadowColor="white",en.shadowBlur=2,en.lineWidth=1.5,en.strokeStyle="white",en.textBaseline="top",en.font="bold 36px Open Sans, sans-serif",en.fillText(Rt,5,5),en.strokeText(Rt,5,5),At.debugOverlayTexture.update(jt),At.debugOverlayTexture.bind(Vt.LINEAR,Vt.CLAMP_TO_EDGE)}(E,`${Tt} ${ke}kB`);const Ct=E.transform.getProjectionData({overscaledTileID:c,applyGlobeMatrix:!0,applyTerrainMatrix:!0});A.draw(g,x.TRIANGLES,N,$,qi.alphaBlended,Gi.disabled,_s(o.b7.transparent,Qe),null,Ct,re,E.debugBuffer,E.quadTriangleIndexBuffer,E.debugSegments),A.draw(g,x.LINE_STRIP,N,$,Z,Gi.disabled,_s(o.b7.red),fe,Ct,re,E.debugBuffer,E.tileBorderIndexBuffer,E.debugSegments)}function lh(E,s,c,g){const{isRenderingGlobe:x}=g,A=E.context,N=A.gl,$=E.transform,Z=E.colorModeForRenderPass(),re=E.getDepthModeFor3D(),fe=E.useProgram("terrain");A.bindFramebuffer.set(null),A.viewport.set([0,0,E.width,E.height]);for(const Me of c){const ke=s.getTerrainMesh(Me.tileID),Ke=E.renderToTexture.getTexture(Me),Qe=s.getTerrainData(Me.tileID);A.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,Ke.texture);const Tt=s.getMeshFrameDelta($.zoom),Ct=$.calculateFogMatrix(Me.tileID.toUnwrapped()),At=Xe(Tt,Ct,E.style.sky,$.pitch,x),Rt=$.getProjectionData({overscaledTileID:Me.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});fe.draw(A,N.TRIANGLES,re,Oi.disabled,Z,Gi.backCCW,At,Qe,Rt,"terrain",ke.vertexBuffer,ke.indexBuffer,ke.segments)}}function Cl(E,s){if(!s.mesh){const c=new o.aI;c.emplaceBack(-1,-1),c.emplaceBack(1,-1),c.emplaceBack(1,1),c.emplaceBack(-1,1);const g=new o.aK;g.emplaceBack(0,1,2),g.emplaceBack(0,2,3),s.mesh=new nl(E.createVertexBuffer(c,rl.members),E.createIndexBuffer(g),o.aJ.simpleSegment(0,0,c.length,g.length))}return s.mesh}class Sl{constructor(s,c){this.context=new ks(s),this.transform=c,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.ad(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=cn.maxUnderzooming+cn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new So}resize(s,c,g){if(this.width=Math.floor(s*g),this.height=Math.floor(c*g),this.pixelRatio=g,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const x of this.style._order)this.style._layers[x].resize()}setup(){const s=this.context,c=new o.aI;c.emplaceBack(0,0),c.emplaceBack(o.Z,0),c.emplaceBack(0,o.Z),c.emplaceBack(o.Z,o.Z),this.tileExtentBuffer=s.createVertexBuffer(c,rl.members),this.tileExtentSegments=o.aJ.simpleSegment(0,0,4,2);const g=new o.aI;g.emplaceBack(0,0),g.emplaceBack(o.Z,0),g.emplaceBack(0,o.Z),g.emplaceBack(o.Z,o.Z),this.debugBuffer=s.createVertexBuffer(g,rl.members),this.debugSegments=o.aJ.simpleSegment(0,0,4,5);const x=new o.bY;x.emplaceBack(0,0,0,0),x.emplaceBack(o.Z,0,o.Z,0),x.emplaceBack(0,o.Z,0,o.Z),x.emplaceBack(o.Z,o.Z,o.Z,o.Z),this.rasterBoundsBuffer=s.createVertexBuffer(x,uo.members),this.rasterBoundsSegments=o.aJ.simpleSegment(0,0,4,2);const A=new o.aI;A.emplaceBack(0,0),A.emplaceBack(o.Z,0),A.emplaceBack(0,o.Z),A.emplaceBack(o.Z,o.Z),this.rasterBoundsBufferPosOnly=s.createVertexBuffer(A,rl.members),this.rasterBoundsSegmentsPosOnly=o.aJ.simpleSegment(0,0,4,5);const N=new o.aI;N.emplaceBack(0,0),N.emplaceBack(1,0),N.emplaceBack(0,1),N.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(N,rl.members),this.viewportSegments=o.aJ.simpleSegment(0,0,4,2);const $=new o.bZ;$.emplaceBack(0),$.emplaceBack(1),$.emplaceBack(3),$.emplaceBack(2),$.emplaceBack(0),this.tileBorderIndexBuffer=s.createIndexBuffer($);const Z=new o.aK;Z.emplaceBack(1,0,2),Z.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(Z);const re=this.context.gl;this.stencilClearMode=new Oi({func:re.ALWAYS,mask:0},0,255,re.ZERO,re.ZERO,re.ZERO),this.tileExtentMesh=new nl(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const s=this.context,c=s.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const g=o.K();o.bQ(g,0,this.width,this.height,0,0,1),o.M(g,g,[c.drawingBufferWidth,c.drawingBufferHeight,0]);const x={mainMatrix:g,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:g};this.useProgram("clippingMask",null,!0).draw(s,c.TRIANGLES,Nr.disabled,this.stencilClearMode,qi.disabled,Gi.disabled,null,null,x,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(s,c,g){if(this.currentStencilSource===s.source||!s.isTileClipped()||!c||!c.length)return;this.currentStencilSource=s.source,this.nextStencilID+c.length>256&&this.clearStencil();const x=this.context;x.setColorMode(qi.disabled),x.setDepthMode(Nr.disabled);const A={};for(const N of c)A[N.key]=this.nextStencilID++;this._renderTileMasks(A,c,g,!0),this._renderTileMasks(A,c,g,!1),this._tileClippingMaskIDs=A}_renderTileMasks(s,c,g,x){const A=this.context,N=A.gl,$=this.style.projection,Z=this.transform,re=this.useProgram("clippingMask");for(const fe of c){const Me=s[fe.key],ke=this.style.map.terrain&&this.style.map.terrain.getTerrainData(fe),Ke=$.getMeshFromTileID(this.context,fe.canonical,x,!0,"stencil"),Qe=Z.getProjectionData({overscaledTileID:fe,applyGlobeMatrix:!0,applyTerrainMatrix:!0});re.draw(A,N.TRIANGLES,Nr.disabled,new Oi({func:N.ALWAYS,mask:0},Me,255,N.KEEP,N.KEEP,N.REPLACE),qi.disabled,g?Gi.disabled:Gi.backCCW,null,ke,Qe,"$clipping",Ke.vertexBuffer,Ke.indexBuffer,Ke.segments)}}_renderTilesDepthBuffer(){const s=this.context,c=s.gl,g=this.style.projection,x=this.transform,A=this.useProgram("depth"),N=this.getDepthModeFor3D(),$=Ot(x,{tileSize:x.tileSize});for(const Z of $){const re=this.style.map.terrain&&this.style.map.terrain.getTerrainData(Z),fe=g.getMeshFromTileID(this.context,Z.canonical,!0,!0,"raster"),Me=x.getProjectionData({overscaledTileID:Z,applyGlobeMatrix:!0,applyTerrainMatrix:!0});A.draw(s,c.TRIANGLES,N,Oi.disabled,qi.disabled,Gi.backCCW,null,re,Me,"$clipping",fe.vertexBuffer,fe.indexBuffer,fe.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const s=this.nextStencilID++,c=this.context.gl;return new Oi({func:c.NOTEQUAL,mask:255},s,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(s){const c=this.context.gl;return new Oi({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,c.KEEP,c.KEEP,c.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(s){const c=this.context.gl,g=s.sort((N,$)=>$.overscaledZ-N.overscaledZ),x=g[g.length-1].overscaledZ,A=g[0].overscaledZ-x+1;if(A>1){this.currentStencilSource=void 0,this.nextStencilID+A>256&&this.clearStencil();const N={};for(let $=0;$<A;$++)N[$+x]=new Oi({func:c.GEQUAL,mask:255},$+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=A,[N,g]}return[{[x]:Oi.disabled},g]}stencilConfigForOverlapTwoPass(s){const c=this.context.gl,g=s.sort((N,$)=>$.overscaledZ-N.overscaledZ),x=g[g.length-1].overscaledZ,A=g[0].overscaledZ-x+1;if(this.clearStencil(),A>1){const N={},$={};for(let Z=0;Z<A;Z++)N[Z+x]=new Oi({func:c.GREATER,mask:255},A+1+Z,255,c.KEEP,c.KEEP,c.REPLACE),$[Z+x]=new Oi({func:c.GREATER,mask:255},1+Z,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID=2*A+1,[N,$,g]}return this.nextStencilID=3,[{[x]:new Oi({func:c.GREATER,mask:255},2,255,c.KEEP,c.KEEP,c.REPLACE)},{[x]:new Oi({func:c.GREATER,mask:255},1,255,c.KEEP,c.KEEP,c.REPLACE)},g]}colorModeForRenderPass(){const s=this.context.gl;return this._showOverdrawInspector?new qi([s.CONSTANT_COLOR,s.ONE],new o.b7(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?qi.unblended:qi.alphaBlended}getDepthModeForSublayer(s,c,g){if(!this.opaquePassEnabledForLayer())return Nr.disabled;const x=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new Nr(g||this.context.gl.LEQUAL,c,[x,x])}getDepthModeFor3D(){return new Nr(this.context.gl.LEQUAL,Nr.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(s,c){var g,x;this.style=s,this.options=c,this.lineAtlas=s.lineAtlas,this.imageManager=s.imageManager,this.glyphManager=s.glyphManager,this.symbolFadeChange=s.placement.symbolFadeChange(M.now()),this.imageManager.beginFrame();const A=this.style._order,N=this.style.sourceCaches,$={},Z={},re={},fe={isRenderingToTexture:!1,isRenderingGlobe:((g=s.projection)===null||g===void 0?void 0:g.transitionState)>0};for(const ke in N){const Ke=N[ke];Ke.used&&Ke.prepare(this.context),$[ke]=Ke.getVisibleCoordinates(!1),Z[ke]=$[ke].slice().reverse(),re[ke]=Ke.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let ke=0;ke<A.length;ke++)if(this.style._layers[A[ke]].is3D()){this.opaquePassCutoff=ke;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const ke of A){const Ke=this.style._layers[ke];if(!Ke.hasOffscreenPass()||Ke.isHidden(this.transform.zoom))continue;const Qe=Z[Ke.source];(Ke.type==="custom"||Qe.length)&&this.renderLayer(this,N[Ke.source],Ke,Qe,fe)}if((x=this.style.projection)===null||x===void 0||x.updateGPUdependent({context:this.context,useProgram:ke=>this.useProgram(ke)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:c.showOverdrawInspector?o.b7.black:o.b7.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(ke,Ke){const Qe=ke.context,Tt=Qe.gl,Ct=((mn,on,On)=>{const jn=Math.cos(on.rollInRadians),In=Math.sin(on.rollInRadians),sr=Ft(on),tr=on.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:mn.properties.get("sky-color"),u_horizon_color:mn.properties.get("horizon-color"),u_horizon:[(on.width/2-sr*In)*On,(on.height/2+sr*jn)*On],u_horizon_normal:[-In,jn],u_sky_horizon_blend:mn.properties.get("sky-horizon-blend")*on.height/2*On,u_sky_blend:tr}})(Ke,ke.style.map.transform,ke.pixelRatio),At=new Nr(Tt.LEQUAL,Nr.ReadWrite,[0,1]),Rt=Oi.disabled,jt=ke.colorModeForRenderPass(),Vt=ke.useProgram("sky"),en=Cl(Qe,Ke);Vt.draw(Qe,Tt.TRIANGLES,At,Rt,jt,Gi.disabled,Ct,null,void 0,"sky",en.vertexBuffer,en.indexBuffer,en.segments)}(this,this.style.sky),this._showOverdrawInspector=c.showOverdrawInspector,this.depthRangeFor3D=[0,1-(s._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=A.length-1;this.currentLayer>=0;this.currentLayer--){const ke=this.style._layers[A[this.currentLayer]],Ke=N[ke.source],Qe=$[ke.source];this._renderTileClippingMasks(ke,Qe,!1),this.renderLayer(this,Ke,ke,Qe,fe)}this.renderPass="translucent";let Me=!1;for(this.currentLayer=0;this.currentLayer<A.length;this.currentLayer++){const ke=this.style._layers[A[this.currentLayer]],Ke=N[ke.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(ke,fe))continue;this.opaquePassEnabledForLayer()||Me||(Me=!0,fe.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const Qe=(ke.type==="symbol"?re:Z)[ke.source];this._renderTileClippingMasks(ke,$[ke.source],!1),this.renderLayer(this,Ke,ke,Qe,fe)}if(fe.isRenderingGlobe&&function(ke,Ke,Qe){const Tt=ke.context,Ct=Tt.gl,At=ke.useProgram("atmosphere"),Rt=new Nr(Ct.LEQUAL,Nr.ReadOnly,[0,1]),jt=ke.transform,Vt=function(tr,Or){const Sr=tr.properties.get("position"),mr=[-Sr.x,-Sr.y,-Sr.z],ti=o.ad(new Float64Array(16));return tr.properties.get("anchor")==="map"&&(o.a_(ti,ti,Or.rollInRadians),o.a$(ti,ti,-Or.pitchInRadians),o.a_(ti,ti,Or.bearingInRadians),o.a$(ti,ti,Or.center.lat*Math.PI/180),o.bp(ti,ti,-Or.center.lng*Math.PI/180)),o.bX(mr,mr,ti),mr}(Qe,ke.transform),en=jt.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),mn=Ke.properties.get("atmosphere-blend")*en.projectionTransition;if(mn===0)return;const on=Fs(jt.worldSize,jt.center.lat),On=jt.inverseProjectionMatrix,jn=new Float64Array(4);jn[3]=1,o.at(jn,jn,jt.modelViewProjectionMatrix),jn[0]/=jn[3],jn[1]/=jn[3],jn[2]/=jn[3],jn[3]=1,o.at(jn,jn,On),jn[0]/=jn[3],jn[1]/=jn[3],jn[2]/=jn[3],jn[3]=1;const In=((tr,Or,Sr,mr,ti)=>({u_sun_pos:tr,u_atmosphere_blend:Or,u_globe_position:Sr,u_globe_radius:mr,u_inv_proj_matrix:ti}))(Vt,mn,[jn[0],jn[1],jn[2]],on,On),sr=Cl(Tt,Ke);At.draw(Tt,Ct.TRIANGLES,Rt,Oi.disabled,qi.alphaBlended,Gi.disabled,In,null,null,"atmosphere",sr.vertexBuffer,sr.indexBuffer,sr.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const ke=function(Ke,Qe){let Tt=null;const Ct=Object.values(Ke._layers).flatMap(Vt=>Vt.source&&!Vt.isHidden(Qe)?[Ke.sourceCaches[Vt.source]]:[]),At=Ct.filter(Vt=>Vt.getSource().type==="vector"),Rt=Ct.filter(Vt=>Vt.getSource().type!=="vector"),jt=Vt=>{(!Tt||Tt.getSource().maxzoom<Vt.getSource().maxzoom)&&(Tt=Vt)};return At.forEach(Vt=>jt(Vt)),Tt||Rt.forEach(Vt=>jt(Vt)),Tt}(this.style,this.transform.zoom);ke&&function(Ke,Qe,Tt){for(let Ct=0;Ct<Tt.length;Ct++)ma(Ke,Qe,Tt[Ct])}(this,ke,ke.getVisibleCoordinates())}this.options.showPadding&&function(ke){const Ke=ke.transform.padding;Js(ke,ke.transform.height-(Ke.top||0),3,ar),Js(ke,Ke.bottom||0,3,Vr),so(ke,Ke.left||0,3,Jr),so(ke,ke.transform.width-(Ke.right||0),3,Vi);const Qe=ke.transform.centerPoint;(function(Tt,Ct,At,Rt){Ss(Tt,Ct-1,At-10,2,20,Rt),Ss(Tt,Ct-10,At-1,20,2,Rt)})(ke,Qe.x,ke.transform.height-Qe.y,vo)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(s){if(!this.style||!this.style.map||!this.style.map.terrain)return;const c=this.terrainFacilitator.matrix,g=this.transform.modelViewProjectionMatrix;let x=this.terrainFacilitator.dirty;x||(x=s?!o.b_(c,g):!o.b$(c,g)),x||(x=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),x&&(o.c0(c,g),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(A,N){const $=A.context,Z=$.gl,re=A.transform,fe=qi.unblended,Me=new Nr(Z.LEQUAL,Nr.ReadWrite,[0,1]),ke=N.sourceCache.getRenderableTiles(),Ke=A.useProgram("terrainDepth");$.bindFramebuffer.set(N.getFramebuffer("depth").framebuffer),$.viewport.set([0,0,A.width/devicePixelRatio,A.height/devicePixelRatio]),$.clear({color:o.b7.transparent,depth:1});for(const Qe of ke){const Tt=N.getTerrainMesh(Qe.tileID),Ct=N.getTerrainData(Qe.tileID),At=re.getProjectionData({overscaledTileID:Qe.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),Rt={u_ele_delta:N.getMeshFrameDelta(re.zoom)};Ke.draw($,Z.TRIANGLES,Me,Oi.disabled,fe,Gi.backCCW,Rt,Ct,At,"terrain",Tt.vertexBuffer,Tt.indexBuffer,Tt.segments)}$.bindFramebuffer.set(null),$.viewport.set([0,0,A.width,A.height])}(this,this.style.map.terrain),function(A,N){const $=A.context,Z=$.gl,re=A.transform,fe=qi.unblended,Me=new Nr(Z.LEQUAL,Nr.ReadWrite,[0,1]),ke=N.getCoordsTexture(),Ke=N.sourceCache.getRenderableTiles(),Qe=A.useProgram("terrainCoords");$.bindFramebuffer.set(N.getFramebuffer("coords").framebuffer),$.viewport.set([0,0,A.width/devicePixelRatio,A.height/devicePixelRatio]),$.clear({color:o.b7.transparent,depth:1}),N.coordsIndex=[];for(const Tt of Ke){const Ct=N.getTerrainMesh(Tt.tileID),At=N.getTerrainData(Tt.tileID);$.activeTexture.set(Z.TEXTURE0),Z.bindTexture(Z.TEXTURE_2D,ke.texture);const Rt={u_terrain_coords_id:(255-N.coordsIndex.length)/255,u_texture:0,u_ele_delta:N.getMeshFrameDelta(re.zoom)},jt=re.getProjectionData({overscaledTileID:Tt.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Qe.draw($,Z.TRIANGLES,Me,Oi.disabled,fe,Gi.backCCW,Rt,At,jt,"terrain",Ct.vertexBuffer,Ct.indexBuffer,Ct.segments),N.coordsIndex.push(Tt.tileID.key)}$.bindFramebuffer.set(null),$.viewport.set([0,0,A.width,A.height])}(this,this.style.map.terrain))}renderLayer(s,c,g,x,A){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="custom"||(x||[]).length)&&(this.id=g.id,o.c1(g)?function(N,$,Z,re,fe,Me){if(N.renderPass!=="translucent")return;const{isRenderingToTexture:ke}=Me,Ke=Oi.disabled,Qe=N.colorModeForRenderPass();(Z._unevaluatedLayout.hasValue("text-variable-anchor")||Z._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(Tt,Ct,At,Rt,jt,Vt,en,mn,on){const On=Ct.transform,jn=Ct.style.map.terrain,In=jt==="map",sr=Vt==="map";for(const tr of Tt){const Or=Rt.getTile(tr),Sr=Or.getBucket(At);if(!Sr||!Sr.text||!Sr.text.segments.get().length)continue;const mr=o.ak(Sr.textSizeData,On.zoom),ti=o.az(Or,1,Ct.transform.zoom),wi=vt(In,Ct.transform,ti),Ei=At.layout.get("icon-text-fit")!=="none"&&Sr.hasIconData();if(mr){const Os=Math.pow(2,On.zoom-Or.tileID.overscaledZ),Rs=jn?(fo,po)=>jn.getElevation(tr,fo,po):null;Ha(Sr,In,sr,on,On,wi,Os,mr,Ei,o.aA(On,Or,en,mn),tr.toUnwrapped(),Rs)}}}(re,N,Z,$,Z.layout.get("text-rotation-alignment"),Z.layout.get("text-pitch-alignment"),Z.paint.get("text-translate"),Z.paint.get("text-translate-anchor"),fe),Z.paint.get("icon-opacity").constantOr(1)!==0&&Uc(N,$,Z,re,!1,Z.paint.get("icon-translate"),Z.paint.get("icon-translate-anchor"),Z.layout.get("icon-rotation-alignment"),Z.layout.get("icon-pitch-alignment"),Z.layout.get("icon-keep-upright"),Ke,Qe,ke),Z.paint.get("text-opacity").constantOr(1)!==0&&Uc(N,$,Z,re,!0,Z.paint.get("text-translate"),Z.paint.get("text-translate-anchor"),Z.layout.get("text-rotation-alignment"),Z.layout.get("text-pitch-alignment"),Z.layout.get("text-keep-upright"),Ke,Qe,ke),$.map.showCollisionBoxes&&($o(N,$,Z,re,!0),$o(N,$,Z,re,!1))}(s,c,g,x,this.style.placement.variableOffsets,A):o.c2(g)?function(N,$,Z,re,fe){if(N.renderPass!=="translucent")return;const{isRenderingToTexture:Me}=fe,ke=Z.paint.get("circle-opacity"),Ke=Z.paint.get("circle-stroke-width"),Qe=Z.paint.get("circle-stroke-opacity"),Tt=!Z.layout.get("circle-sort-key").isConstant();if(ke.constantOr(1)===0&&(Ke.constantOr(1)===0||Qe.constantOr(1)===0))return;const Ct=N.context,At=Ct.gl,Rt=N.transform,jt=N.getDepthModeForSublayer(0,Nr.ReadOnly),Vt=Oi.disabled,en=N.colorModeForRenderPass(),mn=[],on=Rt.getCircleRadiusCorrection();for(let On=0;On<re.length;On++){const jn=re[On],In=$.getTile(jn),sr=In.getBucket(Z);if(!sr)continue;const tr=Z.paint.get("circle-translate"),Or=Z.paint.get("circle-translate-anchor"),Sr=o.aA(Rt,In,tr,Or),mr=sr.programConfigurations.get(Z.id),ti=N.useProgram("circle",mr),wi=sr.layoutVertexBuffer,Ei=sr.indexBuffer,Os=N.style.map.terrain&&N.style.map.terrain.getTerrainData(jn),Rs={programConfiguration:mr,program:ti,layoutVertexBuffer:wi,indexBuffer:Ei,uniformValues:Xi(N,In,Z,Sr,on),terrainData:Os,projectionData:Rt.getProjectionData({overscaledTileID:jn,applyGlobeMatrix:!Me,applyTerrainMatrix:!0})};if(Tt){const fo=sr.segments.get();for(const po of fo)mn.push({segments:new o.aJ([po]),sortKey:po.sortKey,state:Rs})}else mn.push({segments:sr.segments,sortKey:0,state:Rs})}Tt&&mn.sort((On,jn)=>On.sortKey-jn.sortKey);for(const On of mn){const{programConfiguration:jn,program:In,layoutVertexBuffer:sr,indexBuffer:tr,uniformValues:Or,terrainData:Sr,projectionData:mr}=On.state;In.draw(Ct,At.TRIANGLES,jt,Vt,en,Gi.backCCW,Or,Sr,mr,Z.id,sr,tr,On.segments,Z.paint,N.transform.zoom,jn)}}(s,c,g,x,A):o.c3(g)?function(N,$,Z,re,fe){if(Z.paint.get("heatmap-opacity")===0)return;const Me=N.context,{isRenderingToTexture:ke,isRenderingGlobe:Ke}=fe;if(N.style.map.terrain){for(const Qe of re){const Tt=$.getTile(Qe);$.hasRenderableParent(Qe)||(N.renderPass==="offscreen"?Ao(N,Tt,Z,Qe,Ke):N.renderPass==="translucent"&&Gl(N,Z,Qe,ke,Ke))}Me.viewport.set([0,0,N.width,N.height])}else N.renderPass==="offscreen"?function(Qe,Tt,Ct,At){const Rt=Qe.context,jt=Rt.gl,Vt=Qe.transform,en=Oi.disabled,mn=new qi([jt.ONE,jt.ONE],o.b7.transparent,[!0,!0,!0,!0]);(function(on,On,jn){const In=on.gl;on.activeTexture.set(In.TEXTURE1),on.viewport.set([0,0,On.width/4,On.height/4]);let sr=jn.heatmapFbos.get(o.bU);sr?(In.bindTexture(In.TEXTURE_2D,sr.colorAttachment.get()),on.bindFramebuffer.set(sr.framebuffer)):(sr=p(on,On.width/4,On.height/4),jn.heatmapFbos.set(o.bU,sr))})(Rt,Qe,Ct),Rt.clear({color:o.b7.transparent});for(let on=0;on<At.length;on++){const On=At[on];if(Tt.hasRenderableParent(On))continue;const jn=Tt.getTile(On),In=jn.getBucket(Ct);if(!In)continue;const sr=In.programConfigurations.get(Ct.id),tr=Qe.useProgram("heatmap",sr),Or=Vt.getProjectionData({overscaledTileID:On,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Sr=Vt.getCircleRadiusCorrection();tr.draw(Rt,jt.TRIANGLES,Nr.disabled,en,mn,Gi.backCCW,co(jn,Vt.zoom,Ct.paint.get("heatmap-intensity"),Sr),null,Or,Ct.id,In.layoutVertexBuffer,In.indexBuffer,In.segments,Ct.paint,Vt.zoom,sr)}Rt.viewport.set([0,0,Qe.width,Qe.height])}(N,$,Z,re):N.renderPass==="translucent"&&function(Qe,Tt){const Ct=Qe.context,At=Ct.gl;Ct.setColorMode(Qe.colorModeForRenderPass());const Rt=Tt.heatmapFbos.get(o.bU);Rt&&(Ct.activeTexture.set(At.TEXTURE0),At.bindTexture(At.TEXTURE_2D,Rt.colorAttachment.get()),Ct.activeTexture.set(At.TEXTURE1),T(Ct,Tt).bind(At.LINEAR,At.CLAMP_TO_EDGE),Qe.useProgram("heatmapTexture").draw(Ct,At.TRIANGLES,Nr.disabled,Oi.disabled,Qe.colorModeForRenderPass(),Gi.disabled,yo(Qe,Tt,0,1),null,null,Tt.id,Qe.viewportBuffer,Qe.quadTriangleIndexBuffer,Qe.viewportSegments,Tt.paint,Qe.transform.zoom))}(N,Z)}(s,c,g,x,A):o.c4(g)?function(N,$,Z,re,fe){if(N.renderPass!=="translucent")return;const{isRenderingToTexture:Me}=fe,ke=Z.paint.get("line-opacity"),Ke=Z.paint.get("line-width");if(ke.constantOr(1)===0||Ke.constantOr(1)===0)return;const Qe=N.getDepthModeForSublayer(0,Nr.ReadOnly),Tt=N.colorModeForRenderPass(),Ct=Z.paint.get("line-dasharray"),At=Z.paint.get("line-pattern"),Rt=At.constantOr(1),jt=Z.paint.get("line-gradient"),Vt=Z.getCrossfadeParameters(),en=Rt?"linePattern":Ct?"lineSDF":jt?"lineGradient":"line",mn=N.context,on=mn.gl,On=N.transform;let jn=!0;for(const In of re){const sr=$.getTile(In);if(Rt&&!sr.patternsLoaded())continue;const tr=sr.getBucket(Z);if(!tr)continue;const Or=tr.programConfigurations.get(Z.id),Sr=N.context.program.get(),mr=N.useProgram(en,Or),ti=jn||mr.program!==Sr,wi=N.style.map.terrain&&N.style.map.terrain.getTerrainData(In),Ei=At.constantOr(null);if(Ei&&sr.imageAtlas){const Ji=sr.imageAtlas,hs=Ji.patternPositions[Ei.to.toString()],ko=Ji.patternPositions[Ei.from.toString()];hs&&ko&&Or.setConstantPatternPositions(hs,ko)}const Os=On.getProjectionData({overscaledTileID:In,applyGlobeMatrix:!Me,applyTerrainMatrix:!0}),Rs=On.getPixelScale(),fo=Rt?Fc(N,sr,Z,Rs,Vt):Ct?sl(N,sr,Z,Rs,Ct,Vt):jt?Eo(N,sr,Z,Rs,tr.lineClipsArray.length):mu(N,sr,Z,Rs);if(Rt)mn.activeTexture.set(on.TEXTURE0),sr.imageAtlasTexture.bind(on.LINEAR,on.CLAMP_TO_EDGE),Or.updatePaintBuffers(Vt);else if(Ct&&(ti||N.lineAtlas.dirty))mn.activeTexture.set(on.TEXTURE0),N.lineAtlas.bind(mn);else if(jt){const Ji=tr.gradients[Z.id];let hs=Ji.texture;if(Z.gradientVersion!==Ji.version){let ko=256;if(Z.stepInterpolant){const sa=$.getSource().maxzoom,Zo=In.canonical.z===sa?Math.ceil(1<<N.transform.maxZoom-In.canonical.z):1;ko=o.ae(o.bV(tr.maxLineLength/o.Z*1024*Zo),256,mn.maxTextureSize)}Ji.gradient=o.bW({expression:Z.gradientExpression(),evaluationKey:"lineProgress",resolution:ko,image:Ji.gradient||void 0,clips:tr.lineClipsArray}),Ji.texture?Ji.texture.update(Ji.gradient):Ji.texture=new ue(mn,Ji.gradient,on.RGBA),Ji.version=Z.gradientVersion,hs=Ji.texture}mn.activeTexture.set(on.TEXTURE0),hs.bind(Z.stepInterpolant?on.NEAREST:on.LINEAR,on.CLAMP_TO_EDGE)}let po;if(Me){const[Ji]=N.getStencilConfigForOverlapAndUpdateStencilID(re);po=Ji[In.overscaledZ]}else po=N.stencilModeForClipping(In);mr.draw(mn,on.TRIANGLES,Qe,po,Tt,Gi.disabled,fo,wi,Os,Z.id,tr.layoutVertexBuffer,tr.indexBuffer,tr.segments,Z.paint,N.transform.zoom,Or,tr.layoutVertexBuffer2),jn=!1}}(s,c,g,x,A):o.c5(g)?function(N,$,Z,re,fe){const Me=Z.paint.get("fill-color"),ke=Z.paint.get("fill-opacity");if(ke.constantOr(1)===0)return;const{isRenderingToTexture:Ke}=fe,Qe=N.colorModeForRenderPass(),Tt=Z.paint.get("fill-pattern"),Ct=N.opaquePassEnabledForLayer()&&!Tt.constantOr(1)&&Me.constantOr(o.b7.transparent).a===1&&ke.constantOr(0)===1?"opaque":"translucent";if(N.renderPass===Ct){const At=N.getDepthModeForSublayer(1,N.renderPass==="opaque"?Nr.ReadWrite:Nr.ReadOnly);se(N,$,Z,re,At,Qe,!1,Ke)}if(N.renderPass==="translucent"&&Z.paint.get("fill-antialias")){const At=N.getDepthModeForSublayer(Z.getPaintProperty("fill-outline-color")?2:0,Nr.ReadOnly);se(N,$,Z,re,At,Qe,!0,Ke)}}(s,c,g,x,A):o.c6(g)?function(N,$,Z,re,fe){const Me=Z.paint.get("fill-extrusion-opacity");if(Me===0)return;const{isRenderingToTexture:ke}=fe;if(N.renderPass==="translucent"){const Ke=new Nr(N.context.gl.LEQUAL,Nr.ReadWrite,N.depthRangeFor3D);if(Me!==1||Z.paint.get("fill-extrusion-pattern").constantOr(1))Pe(N,$,Z,re,Ke,Oi.disabled,qi.disabled,ke),Pe(N,$,Z,re,Ke,N.stencilModeFor3D(),N.colorModeForRenderPass(),ke);else{const Qe=N.colorModeForRenderPass();Pe(N,$,Z,re,Ke,Oi.disabled,Qe,ke)}}}(s,c,g,x,A):o.c7(g)?function(N,$,Z,re,fe){if(N.renderPass!=="offscreen"&&N.renderPass!=="translucent")return;const{isRenderingToTexture:Me}=fe,ke=N.context,Ke=N.style.projection.useSubdivision,Qe=N.getDepthModeForSublayer(0,Nr.ReadOnly),Tt=N.colorModeForRenderPass();if(N.renderPass==="offscreen")(function(Ct,At,Rt,jt,Vt,en,mn){const on=Ct.context,On=on.gl;for(const jn of Rt){const In=At.getTile(jn),sr=In.dem;if(!sr||!sr.data||!In.needsHillshadePrepare)continue;const tr=sr.dim,Or=sr.stride,Sr=sr.getPixels();if(on.activeTexture.set(On.TEXTURE1),on.pixelStoreUnpackPremultiplyAlpha.set(!1),In.demTexture=In.demTexture||Ct.getTileTexture(Or),In.demTexture){const ti=In.demTexture;ti.update(Sr,{premultiply:!1}),ti.bind(On.NEAREST,On.CLAMP_TO_EDGE)}else In.demTexture=new ue(on,Sr,On.RGBA,{premultiply:!1}),In.demTexture.bind(On.NEAREST,On.CLAMP_TO_EDGE);on.activeTexture.set(On.TEXTURE0);let mr=In.fbo;if(!mr){const ti=new ue(on,{width:tr,height:tr,data:null},On.RGBA);ti.bind(On.LINEAR,On.CLAMP_TO_EDGE),mr=In.fbo=on.createFramebuffer(tr,tr,!0,!1),mr.colorAttachment.set(ti.texture)}on.bindFramebuffer.set(mr.framebuffer),on.viewport.set([0,0,tr,tr]),Ct.useProgram("hillshadePrepare").draw(on,On.TRIANGLES,Vt,en,mn,Gi.disabled,Ri(In.tileID,sr),null,null,jt.id,Ct.rasterBoundsBuffer,Ct.quadTriangleIndexBuffer,Ct.rasterBoundsSegments),In.needsHillshadePrepare=!1}})(N,$,re,Z,Qe,Oi.disabled,Tt),ke.viewport.set([0,0,N.width,N.height]);else if(N.renderPass==="translucent")if(Ke){const[Ct,At,Rt]=N.stencilConfigForOverlapTwoPass(re);nt(N,$,Z,Rt,Ct,Qe,Tt,!1,Me),nt(N,$,Z,Rt,At,Qe,Tt,!0,Me)}else{const[Ct,At]=N.getStencilConfigForOverlapAndUpdateStencilID(re);nt(N,$,Z,At,Ct,Qe,Tt,!1,Me)}}(s,c,g,x,A):o.c8(g)?function(N,$,Z,re,fe){if(N.renderPass!=="translucent"||Z.paint.get("raster-opacity")===0||!re.length)return;const{isRenderingToTexture:Me}=fe,ke=$.getSource(),Ke=N.style.projection.useSubdivision;if(ke instanceof an)Dn(N,$,Z,re,null,!1,!1,ke.tileCoords,ke.flippedWindingOrder,Me);else if(Ke){const[Qe,Tt,Ct]=N.stencilConfigForOverlapTwoPass(re);Dn(N,$,Z,Ct,Qe,!1,!0,Jt,!1,Me),Dn(N,$,Z,Ct,Tt,!0,!0,Jt,!1,Me)}else{const[Qe,Tt]=N.getStencilConfigForOverlapAndUpdateStencilID(re);Dn(N,$,Z,Tt,Qe,!1,!0,Jt,!1,Me)}}(s,c,g,x,A):o.c9(g)?function(N,$,Z,re,fe){const Me=Z.paint.get("background-color"),ke=Z.paint.get("background-opacity");if(ke===0)return;const{isRenderingToTexture:Ke}=fe,Qe=N.context,Tt=Qe.gl,Ct=N.style.projection,At=N.transform,Rt=At.tileSize,jt=Z.paint.get("background-pattern");if(N.isPatternMissing(jt))return;const Vt=!jt&&Me.a===1&&ke===1&&N.opaquePassEnabledForLayer()?"opaque":"translucent";if(N.renderPass!==Vt)return;const en=Oi.disabled,mn=N.getDepthModeForSublayer(0,Vt==="opaque"?Nr.ReadWrite:Nr.ReadOnly),on=N.colorModeForRenderPass(),On=N.useProgram(jt?"backgroundPattern":"background"),jn=re||Ot(At,{tileSize:Rt,terrain:N.style.map.terrain});jt&&(Qe.activeTexture.set(Tt.TEXTURE0),N.imageManager.bind(N.context));const In=Z.getCrossfadeParameters();for(const sr of jn){const tr=At.getProjectionData({overscaledTileID:sr,applyGlobeMatrix:!Ke,applyTerrainMatrix:!0}),Or=jt?Xs(ke,N,jt,{tileID:sr,tileSize:Rt},In):gu(ke,Me),Sr=N.style.map.terrain&&N.style.map.terrain.getTerrainData(sr),mr=Ct.getMeshFromTileID(Qe,sr.canonical,!1,!0,"raster");On.draw(Qe,Tt.TRIANGLES,mn,en,on,Gi.backCCW,Or,Sr,tr,Z.id,mr.vertexBuffer,mr.indexBuffer,mr.segments)}}(s,0,g,x,A):o.ca(g)&&function(N,$,Z,re){const{isRenderingGlobe:fe}=re,Me=N.context,ke=Z.implementation,Ke=N.style.projection,Qe=N.transform,Tt=Qe.getProjectionDataForCustomLayer(fe),Ct={farZ:Qe.farZ,nearZ:Qe.nearZ,fov:Qe.fov*Math.PI/180,modelViewProjectionMatrix:Qe.modelViewProjectionMatrix,projectionMatrix:Qe.projectionMatrix,shaderData:{variantName:Ke.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${Ke.shaderPreludeCode.vertexSource}`,define:Ke.shaderDefine},defaultProjectionData:Tt},At=ke.renderingMode?ke.renderingMode:"2d";if(N.renderPass==="offscreen"){const Rt=ke.prerender;Rt&&(N.setCustomLayerDefaults(),Me.setColorMode(N.colorModeForRenderPass()),Rt.call(ke,Me.gl,Ct),Me.setDirty(),N.setBaseState())}else if(N.renderPass==="translucent"){N.setCustomLayerDefaults(),Me.setColorMode(N.colorModeForRenderPass()),Me.setStencilMode(Oi.disabled);const Rt=At==="3d"?N.getDepthModeFor3D():N.getDepthModeForSublayer(0,Nr.ReadOnly);Me.setDepthMode(Rt),ke.render(Me.gl,Ct),Me.setDirty(),N.setBaseState(),Me.bindFramebuffer.set(null)}}(s,0,g,A))}saveTileTexture(s){const c=this._tileTextures[s.size[0]];c?c.push(s):this._tileTextures[s.size[0]]=[s]}getTileTexture(s){const c=this._tileTextures[s];return c&&c.length>0?c.pop():null}isPatternMissing(s){if(!s)return!1;if(!s.from||!s.to)return!0;const c=this.imageManager.getPattern(s.from.toString()),g=this.imageManager.getPattern(s.to.toString());return!c||!g}useProgram(s,c,g=!1){this.cache=this.cache||{};const x=!!this.style.map.terrain,A=this.style.projection,N=s+(c?c.cacheKey:"")+`/${g?Zs:A.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(x?"/terrain":"");return this.cache[N]||(this.cache[N]=new An(this.context,ui[s],c,ea[s],this._showOverdrawInspector,x,g?ui.projectionMercator:A.shaderPreludeCode,g?Ws:A.shaderDefine)),this.cache[N]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new ue(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:s,drawingBufferHeight:c}=this.context.gl;return this.width!==s||this.height!==c}}function qa(E,s){let c,g=!1,x=null,A=null;const N=()=>{x=null,g&&(E.apply(A,c),x=setTimeout(N,s),g=!1)};return(...$)=>(g=!0,A=this,c=$,x||N(),x)}class Xh{constructor(s){this._getCurrentHash=()=>{const c=window.location.hash.replace("#","");if(this._hashName){let g;return c.split("&").map(x=>x.split("=")).forEach(x=>{x[0]===this._hashName&&(g=x)}),(g&&g[1]||"").split("/")}return c.split("/")},this._onHashChange=()=>{const c=this._getCurrentHash();if(!this._isValidHash(c))return!1;const g=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(c[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:g,pitch:+(c[4]||0)}),!0},this._updateHashUnthrottled=()=>{const c=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,c)},this._removeHash=()=>{const c=this._getCurrentHash();if(c.length===0)return;const g=c.join("/");let x=g;x.split("&").length>0&&(x=x.split("&")[0]),this._hashName&&(x=`${this._hashName}=${g}`);let A=window.location.hash.replace(x,"");A.startsWith("#&")?A=A.slice(0,1)+A.slice(2):A==="#"&&(A="");let N=window.location.href.replace(/(#.+)?$/,A);N=N.replace("&&","&"),window.history.replaceState(window.history.state,null,N)},this._updateHash=qa(this._updateHashUnthrottled,300),this._hashName=s&&encodeURIComponent(s)}addTo(s){return this._map=s,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(s){const c=this._map.getCenter(),g=Math.round(100*this._map.getZoom())/100,x=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),A=Math.pow(10,x),N=Math.round(c.lng*A)/A,$=Math.round(c.lat*A)/A,Z=this._map.getBearing(),re=this._map.getPitch();let fe="";if(fe+=s?`/${N}/${$}/${g}`:`${g}/${$}/${N}`,(Z||re)&&(fe+="/"+Math.round(10*Z)/10),re&&(fe+=`/${Math.round(re)}`),this._hashName){const Me=this._hashName;let ke=!1;const Ke=window.location.hash.slice(1).split("&").map(Qe=>{const Tt=Qe.split("=")[0];return Tt===Me?(ke=!0,`${Tt}=${fe}`):Qe}).filter(Qe=>Qe);return ke||Ke.push(`${Me}=${fe}`),`#${Ke.join("&")}`}return`#${fe}`}_isValidHash(s){if(s.length<3||s.some(isNaN))return!1;try{new o.Q(+s[2],+s[1])}catch{return!1}const c=+s[0],g=+(s[3]||0),x=+(s[4]||0);return c>=this._map.getMinZoom()&&c<=this._map.getMaxZoom()&&g>=-180&&g<=180&&x>=this._map.getMinPitch()&&x<=this._map.getMaxPitch()}}const Aa={linearity:.3,easing:o.cb(0,0,.3,1)},xs=o.e({deceleration:2500,maxSpeed:1400},Aa),ia=o.e({deceleration:20,maxSpeed:1400},Aa),dt=o.e({deceleration:1e3,maxSpeed:360},Aa),ka=o.e({deceleration:1e3,maxSpeed:90},Aa),Vc=o.e({deceleration:1e3,maxSpeed:360},Aa);class qo{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:M.now(),settings:s})}_drainInertiaBuffer(){const s=this._inertiaBuffer,c=M.now();for(;s.length>0&&c-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const c={zoom:0,bearing:0,pitch:0,roll:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:A}of this._inertiaBuffer)c.zoom+=A.zoomDelta||0,c.bearing+=A.bearingDelta||0,c.pitch+=A.pitchDelta||0,c.roll+=A.rollDelta||0,A.panDelta&&c.pan._add(A.panDelta),A.around&&(c.around=A.around),A.pinchAround&&(c.pinchAround=A.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(c.pan.mag()){const A=ec(c.pan.mag(),g,o.e({},xs,s||{})),N=c.pan.mult(A.amount/c.pan.mag()),$=this._map.cameraHelper.handlePanInertia(N,this._map.transform);x.center=$.easingCenter,x.offset=$.easingOffset,Ni(x,A)}if(c.zoom){const A=ec(c.zoom,g,ia);x.zoom=this._map.transform.zoom+A.amount,Ni(x,A)}if(c.bearing){const A=ec(c.bearing,g,dt);x.bearing=this._map.transform.bearing+o.ae(A.amount,-179,179),Ni(x,A)}if(c.pitch){const A=ec(c.pitch,g,ka);x.pitch=this._map.transform.pitch+A.amount,Ni(x,A)}if(c.roll){const A=ec(c.roll,g,Vc);x.roll=this._map.transform.roll+o.ae(A.amount,-179,179),Ni(x,A)}if(x.zoom||x.bearing){const A=c.pinchAround===void 0?c.around:c.pinchAround;x.around=A?this._map.unproject(A):this._map.getCenter()}return this.clear(),o.e(x,{noMoveStart:!0})}}function Ni(E,s){(!E.duration||E.duration<s.duration)&&(E.duration=s.duration,E.easing=s.easing)}function ec(E,s,c){const{maxSpeed:g,linearity:x,deceleration:A}=c,N=o.ae(E*x/(s/1e3),-g,g),$=Math.abs(N)/(A*x);return{easing:c.easing,duration:1e3*$,amount:N*($/2)}}class Ll extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,c,g,x={}){g=g instanceof MouseEvent?g:new MouseEvent(s,g);const A=C.mousePos(c.getCanvas(),g),N=c.unproject(A);super(s,o.e({point:A,lngLat:N,originalEvent:g},x)),this._defaultPrevented=!1,this.target=c}}class Ia extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,c,g){const x=s==="touchend"?g.changedTouches:g.touches,A=C.touchPos(c.getCanvasContainer(),x),N=A.map(Z=>c.unproject(Z)),$=A.reduce((Z,re,fe,Me)=>Z.add(re.div(Me.length)),new o.P(0,0));super(s,{points:A,point:$,lngLats:N,lngLat:c.unproject($),originalEvent:g}),this._defaultPrevented=!1}}class Wo extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,c,g){super(s,{originalEvent:g}),this._defaultPrevented=!1}}class Th{constructor(s,c){this._map=s,this._clickTolerance=c.clickTolerance}reset(){delete this._mousedownPos}wheel(s){return this._firePreventable(new Wo(s.type,this._map,s))}mousedown(s,c){return this._mousedownPos=c,this._firePreventable(new Ll(s.type,this._map,s))}mouseup(s){this._map.fire(new Ll(s.type,this._map,s))}click(s,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||this._map.fire(new Ll(s.type,this._map,s))}dblclick(s){return this._firePreventable(new Ll(s.type,this._map,s))}mouseover(s){this._map.fire(new Ll(s.type,this._map,s))}mouseout(s){this._map.fire(new Ll(s.type,this._map,s))}touchstart(s){return this._firePreventable(new Ia(s.type,this._map,s))}touchmove(s){this._map.fire(new Ia(s.type,this._map,s))}touchend(s){this._map.fire(new Ia(s.type,this._map,s))}touchcancel(s){this._map.fire(new Ia(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Fu{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(s){this._map.fire(new Ll(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ll("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._ignoreContextMenu||this._map.fire(new Ll(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class fc{constructor(s){this._map=s}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(s){return this.transform.screenPointToLocation(o.P.convert(s),this._map.terrain)}}class uh{constructor(s,c){this._map=s,this._tr=new fc(s),this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,c){this.isEnabled()&&s.shiftKey&&s.button===0&&(C.disableDrag(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(s,c){if(!this._active)return;const g=c;if(this._lastPos.equals(g)||!this._box&&g.dist(this._startPos)<this._clickTolerance)return;const x=this._startPos;this._lastPos=g,this._box||(this._box=C.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",s));const A=Math.min(x.x,g.x),N=Math.max(x.x,g.x),$=Math.min(x.y,g.y),Z=Math.max(x.y,g.y);C.setTransform(this._box,`translate(${A}px,${$}px)`),this._box.style.width=N-A+"px",this._box.style.height=Z-$+"px"}mouseupWindow(s,c){if(!this._active||s.button!==0)return;const g=this._startPos,x=c;if(this.reset(),C.suppressClick(),g.x!==x.x||g.y!==x.y)return this._map.fire(new o.l("boxzoomend",{originalEvent:s})),{cameraAnimation:A=>A.fitScreenCoordinates(g,x,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",s)}keydown(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(C.remove(this._box),this._box=null),C.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(s,c){return this._map.fire(new o.l(s,{originalEvent:c}))}}function Ah(E,s){if(E.length!==s.length)throw new Error(`The number of touches and points are not equal - touches ${E.length}, points ${s.length}`);const c={};for(let g=0;g<E.length;g++)c[E[g].identifier]=s[g];return c}class Pc{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(s,c,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=s.timeStamp),g.length===this.numTouches&&(this.centroid=function(x){const A=new o.P(0,0);for(const N of x)A._add(N);return A.div(x.length)}(c),this.touches=Ah(g,c)))}touchmove(s,c,g){if(this.aborted||!this.centroid)return;const x=Ah(g,c);for(const A in this.touches){const N=x[A];(!N||N.dist(this.touches[A])>30)&&(this.aborted=!0)}}touchend(s,c,g){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class jd{constructor(s){this.singleTap=new Pc(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(s,c,g){this.singleTap.touchstart(s,c,g)}touchmove(s,c,g){this.singleTap.touchmove(s,c,g)}touchend(s,c,g){const x=this.singleTap.touchend(s,c,g);if(x){const A=s.timeStamp-this.lastTime<500,N=!this.lastTap||this.lastTap.dist(x)<30;if(A&&N||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class Jh{constructor(s){this._tr=new fc(s),this._zoomIn=new jd({numTouches:1,numTaps:2}),this._zoomOut=new jd({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,c,g){this._zoomIn.touchstart(s,c,g),this._zoomOut.touchstart(s,c,g)}touchmove(s,c,g){this._zoomIn.touchmove(s,c,g),this._zoomOut.touchmove(s,c,g)}touchend(s,c,g){const x=this._zoomIn.touchend(s,c,g),A=this._zoomOut.touchend(s,c,g),N=this._tr;return x?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:$=>$.easeTo({duration:300,zoom:N.zoom+1,around:N.unproject(x)},{originalEvent:s})}):A?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:$=>$.easeTo({duration:300,zoom:N.zoom-1,around:N.unproject(A)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zu{constructor(s){this._enabled=!!s.enable,this._moveStateManager=s.moveStateManager,this._clickTolerance=s.clickTolerance||1,this._moveFunction=s.move,this._activateOnStart=!!s.activateOnStart,s.assignEvents(this),this.reset()}reset(s){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(s)}_move(...s){const c=this._moveFunction(...s);if(c.bearingDelta||c.pitchDelta||c.rollDelta||c.around||c.panDelta)return this._active=!0,c}dragStart(s,c){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(s)&&(this._moveStateManager.startMove(s),this._lastPoint=Array.isArray(c)?c[0]:c,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(s,c){if(!this.isEnabled())return;const g=this._lastPoint;if(!g)return;if(s.preventDefault(),!this._moveStateManager.isValidMoveEvent(s))return void this.reset(s);const x=Array.isArray(c)?c[0]:c;return!this._moved&&x.dist(g)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=x,this._move(g,x))}dragEnd(s){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(s)&&(this._moved&&C.suppressClick(),this.reset(s))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const pc={0:1,2:2};class Gr{constructor(s){this._correctEvent=s.checkCorrectEvent}startMove(s){const c=C.mouseButton(s);this._eventButton=c}endMove(s){delete this._eventButton}isValidStartEvent(s){return this._correctEvent(s)}isValidMoveEvent(s){return!function(c,g){const x=pc[g];return c.buttons===void 0||(c.buttons&x)!==x}(s,this._eventButton)}isValidEndEvent(s){return C.mouseButton(s)===this._eventButton}}class vu{constructor(){this._firstTouch=void 0}_isOneFingerTouch(s){return s.targetTouches.length===1}_isSameTouchEvent(s){return s.targetTouches[0].identifier===this._firstTouch}startMove(s){this._firstTouch=s.targetTouches[0].identifier}endMove(s){delete this._firstTouch}isValidStartEvent(s){return this._isOneFingerTouch(s)}isValidMoveEvent(s){return this._isOneFingerTouch(s)&&this._isSameTouchEvent(s)}isValidEndEvent(s){return this._isOneFingerTouch(s)&&this._isSameTouchEvent(s)}}class wd{constructor(s=new Gr({checkCorrectEvent:()=>!0}),c=new vu){this.mouseMoveStateManager=s,this.oneFingerTouchMoveStateManager=c}_executeRelevantHandler(s,c,g){return s instanceof MouseEvent?c(s):typeof TouchEvent<"u"&&s instanceof TouchEvent?g(s):void 0}startMove(s){this._executeRelevantHandler(s,c=>this.mouseMoveStateManager.startMove(c),c=>this.oneFingerTouchMoveStateManager.startMove(c))}endMove(s){this._executeRelevantHandler(s,c=>this.mouseMoveStateManager.endMove(c),c=>this.oneFingerTouchMoveStateManager.endMove(c))}isValidStartEvent(s){return this._executeRelevantHandler(s,c=>this.mouseMoveStateManager.isValidStartEvent(c),c=>this.oneFingerTouchMoveStateManager.isValidStartEvent(c))}isValidMoveEvent(s){return this._executeRelevantHandler(s,c=>this.mouseMoveStateManager.isValidMoveEvent(c),c=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(c))}isValidEndEvent(s){return this._executeRelevantHandler(s,c=>this.mouseMoveStateManager.isValidEndEvent(c),c=>this.oneFingerTouchMoveStateManager.isValidEndEvent(c))}}const kh=E=>{E.mousedown=E.dragStart,E.mousemoveWindow=E.dragMove,E.mouseup=E.dragEnd,E.contextmenu=s=>{s.preventDefault()}};class Ih{constructor(s,c){this._clickTolerance=s.clickTolerance||1,this._map=c,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}_shouldBePrevented(s){return s<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(s,c,g){return this._calculateTransform(s,c,g)}touchmove(s,c,g){if(this._active){if(!this._shouldBePrevented(g.length))return s.preventDefault(),this._calculateTransform(s,c,g);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",s)}}touchend(s,c,g){this._calculateTransform(s,c,g),this._active&&this._shouldBePrevented(g.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,c,g){g.length>0&&(this._active=!0);const x=Ah(g,c),A=new o.P(0,0),N=new o.P(0,0);let $=0;for(const re in x){const fe=x[re],Me=this._touches[re];Me&&(A._add(fe),N._add(fe.sub(Me)),$++,x[re]=fe)}if(this._touches=x,this._shouldBePrevented($)||!N.mag())return;const Z=N.div($);return this._sum._add(Z),this._sum.mag()<this._clickTolerance?void 0:{around:A.div($),panDelta:Z}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class B{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(s,c,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([c[0],c[1]]))}touchmove(s,c,g){if(!this._firstTwoTouches)return;s.preventDefault();const[x,A]=this._firstTwoTouches,N=H(g,c,x),$=H(g,c,A);if(!N||!$)return;const Z=this._aroundCenter?null:N.add($).div(2);return this._move([N,$],Z,s)}touchend(s,c,g){if(!this._firstTwoTouches)return;const[x,A]=this._firstTwoTouches,N=H(g,c,x),$=H(g,c,A);N&&$||(this._active&&C.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function H(E,s,c){for(let g=0;g<E.length;g++)if(E[g].identifier===c)return s[g]}function ie(E,s){return Math.log(E/s)/Math.LN2}class Ee extends B{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,c){const g=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(ie(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ie(this._distance,g),pinchAround:c}}}function Ye(E,s){return 180*E.angleWith(s)/Math.PI}class rt extends B{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,c,g){const x=this._vector;if(this._vector=s[0].sub(s[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ye(this._vector,x),pinchAround:c}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());const c=25/(Math.PI*this._minDiameter)*360,g=Ye(s,this._startVector);return Math.abs(g)<c}}function ut(E){return Math.abs(E.y)>Math.abs(E.x)}class ht extends B{constructor(s){super(),this._currentTouchCount=0,this._map=s}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(s,c,g){super.touchstart(s,c,g),this._currentTouchCount=g.length}_start(s){this._lastPoints=s,ut(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,c,g){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const x=s[0].sub(this._lastPoints[0]),A=s[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(x,A,g.timeStamp),this._valid?(this._lastPoints=s,this._active=!0,{pitchDelta:(x.y+A.y)/2*-.5}):void 0}gestureBeginsVertically(s,c,g){if(this._valid!==void 0)return this._valid;const x=s.mag()>=2,A=c.mag()>=2;if(!x&&!A)return;if(!x||!A)return this._firstMove===void 0&&(this._firstMove=g),g-this._firstMove<100&&void 0;const N=s.y>0==c.y>0;return ut(s)&&ut(c)&&N}}const gt={panStep:100,bearingStep:15,pitchStep:10};class kt{constructor(s){this._tr=new fc(s);const c=gt;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let c=0,g=0,x=0,A=0,N=0;switch(s.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:s.shiftKey?g=-1:(s.preventDefault(),A=-1);break;case 39:s.shiftKey?g=1:(s.preventDefault(),A=1);break;case 38:s.shiftKey?x=1:(s.preventDefault(),N=-1);break;case 40:s.shiftKey?x=-1:(s.preventDefault(),N=1);break;default:return}return this._rotationDisabled&&(g=0,x=0),{cameraAnimation:$=>{const Z=this._tr;$.easeTo({duration:300,easeId:"keyboardHandler",easing:_n,zoom:c?Math.round(Z.zoom)+c*(s.shiftKey?2:1):Z.zoom,bearing:Z.bearing+g*this._bearingStep,pitch:Z.pitch+x*this._pitchStep,offset:[-A*this._panStep,-N*this._panStep],center:Z.center},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function _n(E){return E*(2-E)}const Vn=4.000244140625;class Un{constructor(s,c){this._onTimeout=g=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(g)},this._map=s,this._tr=new fc(s),this._triggerRenderFrame=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!s&&s.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(s){return!!this._map.cooperativeGestures.isEnabled()&&!(s.ctrlKey||this._map.cooperativeGestures.isBypassed(s))}wheel(s){if(!this.isEnabled())return;if(this._shouldBePrevented(s))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",s);let c=s.deltaMode===WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY;const g=M.now(),x=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,c!==0&&c%Vn==0?this._type="wheel":c!==0&&Math.abs(c)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(x*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),s.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=s,this._delta-=c,this._active||this._start(s)),s.preventDefault()}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=C.mousePos(this._map.getCanvas(),s),g=this._tr;this._aroundPoint=this._aroundCenter?g.transform.locationToScreenPoint(o.Q.convert(g.center)):c,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const s=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const $=s.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=$),typeof this._targetZoom=="number"&&(this._targetZoom+=$)}if(this._delta!==0){const $=this._type==="wheel"&&Math.abs(this._delta)>Vn?this._wheelZoomRate:this._defaultZoomRate;let Z=2/(1+Math.exp(-Math.abs(this._delta*$)));this._delta<0&&Z!==0&&(Z=1/Z);const re=typeof this._targetZoom!="number"?s.scale:o.ac(this._targetZoom);this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,o.ah(re*Z))),this._type==="wheel"&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const c=typeof this._targetZoom!="number"?s.zoom:this._targetZoom,g=this._startZoom,x=this._easing;let A,N=!1;if(this._type==="wheel"&&g&&x){const $=M.now()-this._lastWheelEventTime,Z=Math.min(($+5)/200,1),re=x(Z);A=o.B.number(g,c,re),Z<1?this._frameId||(this._frameId=!0):N=!0}else A=c,N=!0;return this._active=!0,N&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=A,{noInertia:!0,needsRenderFrame:!N,zoomDelta:A-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let c=o.cd;if(this._prevEase){const g=this._prevEase,x=(M.now()-g.start)/g.duration,A=g.easing(x+.01)-g.easing(x),N=.27/Math.sqrt(A*A+1e-4)*.01,$=Math.sqrt(.0729-N*N);c=o.cb(N,$,.25,1)}return this._prevEase={start:M.now(),duration:s,easing:c},c}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class kn{constructor(s,c){this._clickZoom=s,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ur{constructor(s){this._tr=new fc(s),this.reset()}reset(){this._active=!1}dblclick(s,c){return s.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:this._tr.zoom+(s.shiftKey?-1:1),around:this._tr.unproject(c)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Zn{constructor(){this._tap=new jd({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(s,c,g){if(!this._swipePoint)if(this._tapTime){const x=c[0],A=s.timeStamp-this._tapTime<500,N=this._tapPoint.dist(x)<30;A&&N?g.length>0&&(this._swipePoint=x,this._swipeTouch=g[0].identifier):this.reset()}else this._tap.touchstart(s,c,g)}touchmove(s,c,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const x=c[0],A=x.y-this._swipePoint.y;return this._swipePoint=x,s.preventDefault(),this._active=!0,{zoomDelta:A/128}}}else this._tap.touchmove(s,c,g)}touchend(s,c,g){if(this._tapTime)this._swipePoint&&g.length===0&&this.reset();else{const x=this._tap.touchend(s,c,g);x&&(this._tapTime=s.timeStamp,this._tapPoint=x)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Qt{constructor(s,c,g){this._el=s,this._mousePan=c,this._touchPan=g}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Sn{constructor(s,c,g,x){this._pitchWithRotate=s.pitchWithRotate,this._rollEnabled=s.rollEnabled,this._mouseRotate=c,this._mousePitch=g,this._mouseRoll=x}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class fr{constructor(s,c,g,x){this._el=s,this._touchZoom=c,this._touchRotate=g,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Cr{constructor(s,c){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=s,this._options=c,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const s=this._map.getCanvasContainer();s.classList.add("maplibregl-cooperative-gestures"),this._container=C.create("div","maplibregl-cooperative-gesture-screen",s);let c=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(c=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const g=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),x=document.createElement("div");x.className="maplibregl-desktop-message",x.textContent=c,this._container.appendChild(x);const A=document.createElement("div");A.className="maplibregl-mobile-message",A.textContent=g,this._container.appendChild(A),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(C.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(s){return s[this._bypassKey]}notifyGestureBlocked(s,c){this._enabled&&(this._map.fire(new o.l("cooperativegestureprevented",{gestureType:s,originalEvent:c})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const gr=E=>E.zoom||E.drag||E.roll||E.pitch||E.rotate;class qr extends o.l{}function Ur(E){return E.panDelta&&E.panDelta.mag()||E.zoomDelta||E.bearingDelta||E.pitchDelta||E.rollDelta}class ei{constructor(s,c){this.handleWindowEvent=x=>{this.handleEvent(x,`${x.type}Window`)},this.handleEvent=(x,A)=>{if(x.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const N=x.type==="renderFrame"?void 0:x,$={needsRenderFrame:!1},Z={},re={};for(const{handlerName:ke,handler:Ke,allowed:Qe}of this._handlers){if(!Ke.isEnabled())continue;let Tt;if(this._blockedByActive(re,Qe,ke))Ke.reset();else if(Ke[A||x.type]){if(o.ce(x,A||x.type)){const Ct=C.mousePos(this._map.getCanvas(),x);Tt=Ke[A||x.type](x,Ct)}else if(o.cf(x,A||x.type)){const Ct=this._getMapTouches(x.touches),At=C.touchPos(this._map.getCanvas(),Ct);Tt=Ke[A||x.type](x,At,Ct)}else o.cg(A||x.type)||(Tt=Ke[A||x.type](x));this.mergeHandlerResult($,Z,Tt,ke,N),Tt&&Tt.needsRenderFrame&&this._triggerRenderFrame()}(Tt||Ke.isActive())&&(re[ke]=Ke)}const fe={};for(const ke in this._previousActiveHandlers)re[ke]||(fe[ke]=N);this._previousActiveHandlers=re,(Object.keys(fe).length||Ur($))&&(this._changes.push([$,Z,fe]),this._triggerRenderFrame()),(Object.keys(re).length||Ur($))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Me}=$;Me&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Me(this._map))},this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new qo(s),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(c);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];for(const[x,A,N]of this._listeners)C.addEventListener(x,A,x===document?this.handleWindowEvent:this.handleEvent,N)}destroy(){for(const[s,c,g]of this._listeners)C.removeEventListener(s,c,s===document?this.handleWindowEvent:this.handleEvent,g)}_addDefaultHandlers(s){const c=this._map,g=c.getCanvasContainer();this._add("mapEvent",new Th(c,s));const x=c.boxZoom=new uh(c,s);this._add("boxZoom",x),s.interactive&&s.boxZoom&&x.enable();const A=c.cooperativeGestures=new Cr(c,s.cooperativeGestures);this._add("cooperativeGestures",A),s.cooperativeGestures&&A.enable();const N=new Jh(c),$=new ur(c);c.doubleClickZoom=new kn($,N),this._add("tapZoom",N),this._add("clickZoom",$),s.interactive&&s.doubleClickZoom&&c.doubleClickZoom.enable();const Z=new Zn;this._add("tapDragZoom",Z);const re=c.touchPitch=new ht(c);this._add("touchPitch",re),s.interactive&&s.touchPitch&&c.touchPitch.enable(s.touchPitch);const fe=()=>c.project(c.getCenter()),Me=function({enable:Vt,clickTolerance:en,aroundCenter:mn=!0,minPixelCenterThreshold:on=100,rotateDegreesPerPixelMoved:On=.8},jn){const In=new Gr({checkCorrectEvent:sr=>C.mouseButton(sr)===0&&sr.ctrlKey||C.mouseButton(sr)===2&&!sr.ctrlKey});return new zu({clickTolerance:en,move:(sr,tr)=>{const Or=jn();if(mn&&Math.abs(Or.y-sr.y)>on)return{bearingDelta:o.cc(new o.P(sr.x,tr.y),tr,Or)};let Sr=(tr.x-sr.x)*On;return mn&&tr.y<Or.y&&(Sr=-Sr),{bearingDelta:Sr}},moveStateManager:In,enable:Vt,assignEvents:kh})}(s,fe),ke=function({enable:Vt,clickTolerance:en,pitchDegreesPerPixelMoved:mn=-.5}){const on=new Gr({checkCorrectEvent:On=>C.mouseButton(On)===0&&On.ctrlKey||C.mouseButton(On)===2});return new zu({clickTolerance:en,move:(On,jn)=>({pitchDelta:(jn.y-On.y)*mn}),moveStateManager:on,enable:Vt,assignEvents:kh})}(s),Ke=function({enable:Vt,clickTolerance:en,rollDegreesPerPixelMoved:mn=.3},on){const On=new Gr({checkCorrectEvent:jn=>C.mouseButton(jn)===2&&jn.ctrlKey});return new zu({clickTolerance:en,move:(jn,In)=>{const sr=on();let tr=(In.x-jn.x)*mn;return In.y<sr.y&&(tr=-tr),{rollDelta:tr}},moveStateManager:On,enable:Vt,assignEvents:kh})}(s,fe);c.dragRotate=new Sn(s,Me,ke,Ke),this._add("mouseRotate",Me,["mousePitch"]),this._add("mousePitch",ke,["mouseRotate","mouseRoll"]),this._add("mouseRoll",Ke,["mousePitch"]),s.interactive&&s.dragRotate&&c.dragRotate.enable();const Qe=function({enable:Vt,clickTolerance:en}){const mn=new Gr({checkCorrectEvent:on=>C.mouseButton(on)===0&&!on.ctrlKey});return new zu({clickTolerance:en,move:(on,On)=>({around:On,panDelta:On.sub(on)}),activateOnStart:!0,moveStateManager:mn,enable:Vt,assignEvents:kh})}(s),Tt=new Ih(s,c);c.dragPan=new Qt(g,Qe,Tt),this._add("mousePan",Qe),this._add("touchPan",Tt,["touchZoom","touchRotate"]),s.interactive&&s.dragPan&&c.dragPan.enable(s.dragPan);const Ct=new rt,At=new Ee;c.touchZoomRotate=new fr(g,At,Ct,Z),this._add("touchRotate",Ct,["touchPan","touchZoom"]),this._add("touchZoom",At,["touchPan","touchRotate"]),s.interactive&&s.touchZoomRotate&&c.touchZoomRotate.enable(s.touchZoomRotate);const Rt=c.scrollZoom=new Un(c,()=>this._triggerRenderFrame());this._add("scrollZoom",Rt,["mousePan"]),s.interactive&&s.scrollZoom&&c.scrollZoom.enable(s.scrollZoom);const jt=c.keyboard=new kt(c);this._add("keyboard",jt),s.interactive&&s.keyboard&&c.keyboard.enable(),this._add("blockableMapEvent",new Fu(c))}_add(s,c,g){this._handlers.push({handlerName:s,handler:c,allowed:g}),this._handlersById[s]=c}stop(s){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[]}}isActive(){for(const{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!gr(this._eventsInProgress)||this.isZooming()}_blockedByActive(s,c,g){for(const x in s)if(x!==g&&(!c||c.indexOf(x)<0))return!0;return!1}_getMapTouches(s){const c=[];for(const g of s)this._el.contains(g.target)&&c.push(g);return c}mergeHandlerResult(s,c,g,x,A){if(!g)return;o.e(s,g);const N={handlerName:x,originalEvent:g.originalEvent||A};g.zoomDelta!==void 0&&(c.zoom=N),g.panDelta!==void 0&&(c.drag=N),g.rollDelta!==void 0&&(c.roll=N),g.pitchDelta!==void 0&&(c.pitch=N),g.bearingDelta!==void 0&&(c.rotate=N)}_applyChanges(){const s={},c={},g={};for(const[x,A,N]of this._changes)x.panDelta&&(s.panDelta=(s.panDelta||new o.P(0,0))._add(x.panDelta)),x.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+x.pitchDelta),x.rollDelta&&(s.rollDelta=(s.rollDelta||0)+x.rollDelta),x.around!==void 0&&(s.around=x.around),x.pinchAround!==void 0&&(s.pinchAround=x.pinchAround),x.noInertia&&(s.noInertia=x.noInertia),o.e(c,A),o.e(g,N);this._updateMapTransform(s,c,g),this._changes=[]}_updateMapTransform(s,c,g){const x=this._map,A=x._getTransformForUpdate(),N=x.terrain;if(!(Ur(s)||N&&this._terrainMovement))return this._fireEvents(c,g,!0);x._stop(!0);let{panDelta:$,zoomDelta:Z,bearingDelta:re,pitchDelta:fe,rollDelta:Me,around:ke,pinchAround:Ke}=s;Ke!==void 0&&(ke=Ke),ke=ke||x.transform.centerPoint,N&&!A.isPointOnMapSurface(ke)&&(ke=A.centerPoint);const Qe={panDelta:$,zoomDelta:Z,rollDelta:Me,pitchDelta:fe,bearingDelta:re,around:ke};this._map.cameraHelper.useGlobeControls&&!A.isPointOnMapSurface(ke)&&(ke=A.centerPoint);const Tt=ke.distSqr(A.centerPoint)<.01?A.center:A.screenPointToLocation($?ke.sub($):ke);N?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Qe,A),this._terrainMovement||!c.drag&&!c.zoom?c.drag&&this._terrainMovement?A.setCenter(A.screenPointToLocation(A.centerPoint.sub($))):this._map.cameraHelper.handleMapControlsPan(Qe,A,Tt):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(Qe,A,Tt))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Qe,A),this._map.cameraHelper.handleMapControlsPan(Qe,A,Tt)),x._applyUpdatedTransform(A),this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(c,g,!0)}_fireEvents(s,c,g){const x=gr(this._eventsInProgress),A=gr(s),N={};for(const Me in s){const{originalEvent:ke}=s[Me];this._eventsInProgress[Me]||(N[`${Me}start`]=ke),this._eventsInProgress[Me]=s[Me]}!x&&A&&this._fireEvent("movestart",A.originalEvent);for(const Me in N)this._fireEvent(Me,N[Me]);A&&this._fireEvent("move",A.originalEvent);for(const Me in s){const{originalEvent:ke}=s[Me];this._fireEvent(Me,ke)}const $={};let Z;for(const Me in this._eventsInProgress){const{handlerName:ke,originalEvent:Ke}=this._eventsInProgress[Me];this._handlersById[ke].isActive()||(delete this._eventsInProgress[Me],Z=c[ke]||Ke,$[`${Me}end`]=Z)}for(const Me in $)this._fireEvent(Me,$[Me]);const re=gr(this._eventsInProgress),fe=(x||A)&&!re;if(fe&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const Me=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&Me.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(Me)}if(g&&fe){this._updatingCamera=!0;const Me=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ke=Ke=>Ke!==0&&-this._bearingSnap<Ke&&Ke<this._bearingSnap;!Me||!Me.essential&&M.prefersReducedMotion?(this._map.fire(new o.l("moveend",{originalEvent:Z})),ke(this._map.getBearing())&&this._map.resetNorth()):(ke(Me.bearing||this._map.getBearing())&&(Me.bearing=0),Me.freezeElevation=!0,this._map.easeTo(Me,{originalEvent:Z})),this._updatingCamera=!1}}_fireEvent(s,c){this._map.fire(new o.l(s,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{delete this._frameId,this.handleEvent(new qr("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class y extends o.E{constructor(s,c,g){super(),this._renderFrameCallback=()=>{const x=Math.min((M.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(x)),x<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=g.bearingSnap,this.cameraHelper=c,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(s,c){s.apply(this.transform),this.transform=s,this.cameraHelper=c}getCenter(){return new o.Q(this.transform.center.lng,this.transform.center.lat)}setCenter(s,c){return this.jumpTo({center:s},c)}getCenterElevation(){return this.transform.elevation}setCenterElevation(s,c){return this.jumpTo({elevation:s},c),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(s){this._centerClampedToGround=s}panBy(s,c,g){return s=o.P.convert(s).mult(-1),this.panTo(this.transform.center,o.e({offset:s},c),g)}panTo(s,c,g){return this.easeTo(o.e({center:s},c),g)}getZoom(){return this.transform.zoom}setZoom(s,c){return this.jumpTo({zoom:s},c),this}zoomTo(s,c,g){return this.easeTo(o.e({zoom:s},c),g)}zoomIn(s,c){return this.zoomTo(this.getZoom()+1,s,c),this}zoomOut(s,c){return this.zoomTo(this.getZoom()-1,s,c),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(s,c){return s!=this.transform.fov&&(this.transform.setFov(s),this.fire(new o.l("movestart",c)).fire(new o.l("move",c)).fire(new o.l("moveend",c))),this}getBearing(){return this.transform.bearing}setBearing(s,c){return this.jumpTo({bearing:s},c),this}getPadding(){return this.transform.padding}setPadding(s,c){return this.jumpTo({padding:s},c),this}rotateTo(s,c,g){return this.easeTo(o.e({bearing:s},c),g)}resetNorth(s,c){return this.rotateTo(0,o.e({duration:1e3},s),c),this}resetNorthPitch(s,c){return this.easeTo(o.e({bearing:0,pitch:0,roll:0,duration:1e3},s),c),this}snapToNorth(s,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,c):this}getPitch(){return this.transform.pitch}setPitch(s,c){return this.jumpTo({pitch:s},c),this}getRoll(){return this.transform.roll}setRoll(s,c){return this.jumpTo({roll:s},c),this}cameraForBounds(s,c){s=Ae.convert(s).adjustAntiMeridian();const g=c&&c.bearing||0;return this._cameraForBoxAndBearing(s.getNorthWest(),s.getSouthEast(),g,c)}_cameraForBoxAndBearing(s,c,g,x){const A={top:0,bottom:0,right:0,left:0};if(typeof(x=o.e({padding:A,offset:[0,0],maxZoom:this.transform.maxZoom},x)).padding=="number"){const re=x.padding;x.padding={top:re,bottom:re,right:re,left:re}}const N=o.e(A,x.padding);x.padding=N;const $=this.transform,Z=new Ae(s,c);return this.cameraHelper.cameraForBoxAndBearing(x,N,Z,g,$)}fitBounds(s,c,g){return this._fitInternal(this.cameraForBounds(s,c),c,g)}fitScreenCoordinates(s,c,g,x,A){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(o.P.convert(s)),this.transform.screenPointToLocation(o.P.convert(c)),g,x),x,A)}_fitInternal(s,c,g){return s?(delete(c=o.e(s,c)).padding,c.linear?this.easeTo(c,g):this.flyTo(c,g)):this}jumpTo(s,c){this.stop();const g=this._getTransformForUpdate();let x=!1,A=!1,N=!1;const $=g.zoom;this.cameraHelper.handleJumpToCenterZoom(g,s);const Z=g.zoom!==$;return"elevation"in s&&g.elevation!==+s.elevation&&g.setElevation(+s.elevation),"bearing"in s&&g.bearing!==+s.bearing&&(x=!0,g.setBearing(+s.bearing)),"pitch"in s&&g.pitch!==+s.pitch&&(A=!0,g.setPitch(+s.pitch)),"roll"in s&&g.roll!==+s.roll&&(N=!0,g.setRoll(+s.roll)),s.padding==null||g.isPaddingEqual(s.padding)||g.setPadding(s.padding),this._applyUpdatedTransform(g),this.fire(new o.l("movestart",c)).fire(new o.l("move",c)),Z&&this.fire(new o.l("zoomstart",c)).fire(new o.l("zoom",c)).fire(new o.l("zoomend",c)),x&&this.fire(new o.l("rotatestart",c)).fire(new o.l("rotate",c)).fire(new o.l("rotateend",c)),A&&this.fire(new o.l("pitchstart",c)).fire(new o.l("pitch",c)).fire(new o.l("pitchend",c)),N&&this.fire(new o.l("rollstart",c)).fire(new o.l("roll",c)).fire(new o.l("rollend",c)),this.fire(new o.l("moveend",c))}calculateCameraOptionsFromTo(s,c,g,x=0){const A=o.$.fromLngLat(s,c),N=o.$.fromLngLat(g,x),$=N.x-A.x,Z=N.y-A.y,re=N.z-A.z,fe=Math.hypot($,Z,re);if(fe===0)throw new Error("Can't calculate camera options with same From and To");const Me=Math.hypot($,Z),ke=o.ah(this.transform.cameraToCenterDistance/fe/this.transform.tileSize),Ke=180*Math.atan2($,-Z)/Math.PI;let Qe=180*Math.acos(Me/fe)/Math.PI;return Qe=re<0?90-Qe:90+Qe,{center:N.toLngLat(),elevation:x,zoom:ke,pitch:Qe,bearing:Ke}}calculateCameraOptionsFromCameraLngLatAltRotation(s,c,g,x,A){const N=this.transform.calculateCenterFromCameraLngLatAlt(s,c,g,x);return{center:N.center,elevation:N.elevation,zoom:N.zoom,bearing:g,pitch:x,roll:A}}easeTo(s,c){this._stop(!1,s.easeId),((s=o.e({offset:[0,0],duration:500,easing:o.cd},s)).animate===!1||!s.essential&&M.prefersReducedMotion)&&(s.duration=0);const g=this._getTransformForUpdate(),x=this.getBearing(),A=g.pitch,N=g.roll,$="bearing"in s?this._normalizeBearing(s.bearing,x):x,Z="pitch"in s?+s.pitch:A,re="roll"in s?this._normalizeBearing(s.roll,N):N,fe="padding"in s?s.padding:g.padding,Me=o.P.convert(s.offset);let ke,Ke;s.around&&(ke=o.Q.convert(s.around),Ke=g.locationToScreenPoint(ke));const Qe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},Tt=this.cameraHelper.handleEaseTo(g,{bearing:$,pitch:Z,roll:re,padding:fe,around:ke,aroundPoint:Ke,offsetAsPoint:Me,offset:s.offset,zoom:s.zoom,center:s.center});return this._rotating=this._rotating||x!==$,this._pitching=this._pitching||Z!==A,this._rolling=this._rolling||re!==N,this._padding=!g.isPaddingEqual(fe),this._zooming=this._zooming||Tt.isZooming,this._easeId=s.easeId,this._prepareEase(c,s.noMoveStart,Qe),this.terrain&&this._prepareElevation(Tt.elevationCenter),this._ease(Ct=>{Tt.easeFunc(Ct),this.terrain&&!s.freezeElevation&&this._updateElevation(Ct),this._applyUpdatedTransform(g),this._fireMoveEvents(c)},Ct=>{this.terrain&&s.freezeElevation&&this._finalizeElevation(),this._afterEase(c,Ct)},s),this}_prepareEase(s,c,g={}){this._moving=!0,c||g.moving||this.fire(new o.l("movestart",s)),this._zooming&&!g.zooming&&this.fire(new o.l("zoomstart",s)),this._rotating&&!g.rotating&&this.fire(new o.l("rotatestart",s)),this._pitching&&!g.pitching&&this.fire(new o.l("pitchstart",s)),this._rolling&&!g.rolling&&this.fire(new o.l("rollstart",s))}_prepareElevation(s){this._elevationCenter=s,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(s,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(s){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const c=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(s<1&&c!==this._elevationTarget){const g=this._elevationTarget-this._elevationStart;this._elevationStart+=s*(g-(c-(g*s+this._elevationStart))/(1-s)),this._elevationTarget=c}this.transform.setElevation(o.B.number(this._elevationStart,this._elevationTarget,s))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(s){if(!this.terrain&&s.elevation>=0&&s.pitch<=90)return{};const c=s.getCameraLngLat(),g=s.getCameraAltitude(),x=this.terrain?this.terrain.getElevationForLngLatZoom(c,s.zoom):0;if(g<x){const A=this.calculateCameraOptionsFromTo(c,x,s.center,s.elevation);return{pitch:A.pitch,zoom:A.zoom}}return{}}_applyUpdatedTransform(s){const c=[];if(c.push(x=>this._elevateCameraIfInsideTerrain(x)),this.transformCameraUpdate&&c.push(x=>this.transformCameraUpdate(x)),!c.length)return;const g=s.clone();for(const x of c){const A=g.clone(),{center:N,zoom:$,roll:Z,pitch:re,bearing:fe,elevation:Me}=x(A);N&&A.setCenter(N),Me!==void 0&&A.setElevation(Me),$!==void 0&&A.setZoom($),Z!==void 0&&A.setRoll(Z),re!==void 0&&A.setPitch(re),fe!==void 0&&A.setBearing(fe),g.apply(A)}this.transform.apply(g)}_fireMoveEvents(s){this.fire(new o.l("move",s)),this._zooming&&this.fire(new o.l("zoom",s)),this._rotating&&this.fire(new o.l("rotate",s)),this._pitching&&this.fire(new o.l("pitch",s)),this._rolling&&this.fire(new o.l("roll",s))}_afterEase(s,c){if(this._easeId&&c&&this._easeId===c)return;delete this._easeId;const g=this._zooming,x=this._rotating,A=this._pitching,N=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,g&&this.fire(new o.l("zoomend",s)),x&&this.fire(new o.l("rotateend",s)),A&&this.fire(new o.l("pitchend",s)),N&&this.fire(new o.l("rollend",s)),this.fire(new o.l("moveend",s))}flyTo(s,c){if(!s.essential&&M.prefersReducedMotion){const tr=o.O(s,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(tr,c)}this.stop(),s=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.cd},s);const g=this._getTransformForUpdate(),x=g.bearing,A=g.pitch,N=g.roll,$=g.padding,Z="bearing"in s?this._normalizeBearing(s.bearing,x):x,re="pitch"in s?+s.pitch:A,fe="roll"in s?this._normalizeBearing(s.roll,N):N,Me="padding"in s?s.padding:g.padding,ke=o.P.convert(s.offset);let Ke=g.centerPoint.add(ke);const Qe=g.screenPointToLocation(Ke),Tt=this.cameraHelper.handleFlyTo(g,{bearing:Z,pitch:re,roll:fe,padding:Me,locationAtOffset:Qe,offsetAsPoint:ke,center:s.center,minZoom:s.minZoom,zoom:s.zoom});let Ct=s.curve;const At=Math.max(g.width,g.height),Rt=At/Tt.scaleOfZoom,jt=Tt.pixelPathLength;typeof Tt.scaleOfMinZoom=="number"&&(Ct=Math.sqrt(At/Tt.scaleOfMinZoom/jt*2));const Vt=Ct*Ct;function en(tr){const Or=(Rt*Rt-At*At+(tr?-1:1)*Vt*Vt*jt*jt)/(2*(tr?Rt:At)*Vt*jt);return Math.log(Math.sqrt(Or*Or+1)-Or)}function mn(tr){return(Math.exp(tr)-Math.exp(-tr))/2}function on(tr){return(Math.exp(tr)+Math.exp(-tr))/2}const On=en(!1);let jn=function(tr){return on(On)/on(On+Ct*tr)},In=function(tr){return At*((on(On)*(mn(Or=On+Ct*tr)/on(Or))-mn(On))/Vt)/jt;var Or},sr=(en(!0)-On)/Ct;if(Math.abs(jt)<2e-6||!isFinite(sr)){if(Math.abs(At-Rt)<1e-6)return this.easeTo(s,c);const tr=Rt<At?-1:1;sr=Math.abs(Math.log(Rt/At))/Ct,In=()=>0,jn=Or=>Math.exp(tr*Ct*Or)}return s.duration="duration"in s?+s.duration:1e3*sr/("screenSpeed"in s?+s.screenSpeed/Ct:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0),this._zooming=!0,this._rotating=x!==Z,this._pitching=re!==A,this._rolling=fe!==N,this._padding=!g.isPaddingEqual(Me),this._prepareEase(c,!1),this.terrain&&this._prepareElevation(Tt.targetCenter),this._ease(tr=>{const Or=tr*sr,Sr=1/jn(Or),mr=In(Or);this._rotating&&g.setBearing(o.B.number(x,Z,tr)),this._pitching&&g.setPitch(o.B.number(A,re,tr)),this._rolling&&g.setRoll(o.B.number(N,fe,tr)),this._padding&&(g.interpolatePadding($,Me,tr),Ke=g.centerPoint.add(ke)),Tt.easeFunc(tr,Sr,mr,Ke),this.terrain&&!s.freezeElevation&&this._updateElevation(tr),this._applyUpdatedTransform(g),this._fireMoveEvents(c)},()=>{this.terrain&&s.freezeElevation&&this._finalizeElevation(),this._afterEase(c)},s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(s,c){var g;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const x=this._onEaseEnd;delete this._onEaseEnd,x.call(this,c)}return s||(g=this.handlers)===null||g===void 0||g.stop(!1),this}_ease(s,c,g){g.animate===!1||g.duration===0?(s(1),c()):(this._easeStart=M.now(),this._easeOptions=g,this._onEaseFrame=s,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(s,c){s=o.aL(s,-180,180);const g=Math.abs(s-c);return Math.abs(s-360-c)<g&&(s-=360),Math.abs(s+360-c)<g&&(s+=360),s}queryTerrainElevation(s){return this.terrain?this.terrain.getElevationForLngLatZoom(o.Q.convert(s),this.transform.tileZoom):null}}const S={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class I{constructor(s=S){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=c=>{!c||c.sourceDataType!=="metadata"&&c.sourceDataType!=="visibility"&&c.dataType!=="style"&&c.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=s}getDefaultPosition(){return"bottom-right"}onAdd(s){return this._map=s,this._compact=this.options.compact,this._container=C.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=C.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=C.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){C.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(s,c){const g=this._map._getUIString(`AttributionControl.${c}`);s.title=g,s.setAttribute("aria-label",g)}_updateAttributions(){if(!this._map.style)return;let s=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=s.concat(this.options.customAttribution.map(x=>typeof x!="string"?"":x)):typeof this.options.customAttribution=="string"&&s.push(this.options.customAttribution)),this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const c=this._map.style.sourceCaches;for(const x in c){const A=c[x];if(A.used||A.usedForTerrain){const N=A.getSource();N.attribution&&s.indexOf(N.attribution)<0&&s.push(N.attribution)}}s=s.filter(x=>String(x).trim()),s.sort((x,A)=>x.length-A.length),s=s.filter((x,A)=>{for(let N=A+1;N<s.length;N++)if(s[N].indexOf(x)>=0)return!1;return!0});const g=s.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,s.length?(this._innerContainer.innerHTML=C.sanitize(g),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class F{constructor(s={}){this._updateCompact=()=>{const c=this._container.children;if(c.length){const g=c[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&g.classList.add("maplibregl-compact"):g.classList.remove("maplibregl-compact")}},this.options=s}getDefaultPosition(){return"bottom-left"}onAdd(s){this._map=s,this._compact=this.options&&this.options.compact,this._container=C.create("div","maplibregl-ctrl");const c=C.create("a","maplibregl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://maplibre.org/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){C.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class G{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){const c=++this._id;return this._queue.push({callback:s,id:c,cancelled:!1}),c}remove(s){const c=this._currentlyRunning,g=c?this._queue.concat(c):this._queue;for(const x of g)if(x.id===s)return void(x.cancelled=!0)}run(s=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const c=this._currentlyRunning=this._queue;this._queue=[];for(const g of c)if(!g.cancelled&&(g.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var te=o.aG([{name:"a_pos3d",type:"Int16",components:3}]);class pe extends o.E{constructor(s){super(),this._lastTilesetChange=M.now(),this.sourceCache=s,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=s._source.tileSize*2**this.deltaZoom,s.usedForTerrain=!0,s.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(s,c){this.sourceCache.update(s,c),this._renderableTilesKeys=[];const g={};for(const x of Ot(s,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:c,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))g[x.key]=!0,this._renderableTilesKeys.push(x.key),this._tiles[x.key]||(x.terrainRttPosMatrix32f=new Float64Array(16),o.bQ(x.terrainRttPosMatrix32f,0,o.Z,o.Z,0,0,1),this._tiles[x.key]=new Ht(x,this.tileSize),this._lastTilesetChange=M.now());for(const x in this._tiles)g[x]||delete this._tiles[x]}freeRtt(s){for(const c in this._tiles){const g=this._tiles[c];(!s||g.tileID.equals(s)||g.tileID.isChildOf(s)||s.isChildOf(g.tileID))&&(g.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(s=>this.getTileByID(s))}getTileByID(s){return this._tiles[s]}getTerrainCoords(s,c){return c?this._getTerrainCoordsForTileRanges(s,c):this._getTerrainCoordsForRegularTile(s)}_getTerrainCoordsForRegularTile(s){const c={};for(const g of this._renderableTilesKeys){const x=this._tiles[g].tileID,A=s.clone(),N=o.b2();if(x.canonical.equals(s.canonical))o.bQ(N,0,o.Z,o.Z,0,0,1);else if(x.canonical.isChildOf(s.canonical)){const $=x.canonical.z-s.canonical.z,Z=x.canonical.x-(x.canonical.x>>$<<$),re=x.canonical.y-(x.canonical.y>>$<<$),fe=o.Z>>$;o.bQ(N,0,fe,fe,0,0,1),o.L(N,N,[-Z*fe,-re*fe,0])}else{if(!s.canonical.isChildOf(x.canonical))continue;{const $=s.canonical.z-x.canonical.z,Z=s.canonical.x-(s.canonical.x>>$<<$),re=s.canonical.y-(s.canonical.y>>$<<$),fe=o.Z>>$;o.bQ(N,0,o.Z,o.Z,0,0,1),o.L(N,N,[Z*fe,re*fe,0]),o.M(N,N,[1/2**$,1/2**$,0])}}A.terrainRttPosMatrix32f=new Float32Array(N),c[g]=A}return c}_getTerrainCoordsForTileRanges(s,c){const g={};for(const x of this._renderableTilesKeys){const A=this._tiles[x].tileID;if(!this._isWithinTileRanges(A,c))continue;const N=s.clone(),$=o.b2();if(A.canonical.z===s.canonical.z){const Z=s.canonical.x-A.canonical.x,re=s.canonical.y-A.canonical.y;o.bQ($,0,o.Z,o.Z,0,0,1),o.L($,$,[Z*o.Z,re*o.Z,0])}else if(A.canonical.z>s.canonical.z){const Z=A.canonical.z-s.canonical.z,re=A.canonical.x-(A.canonical.x>>Z<<Z),fe=A.canonical.y-(A.canonical.y>>Z<<Z),Me=s.canonical.x-(A.canonical.x>>Z),ke=s.canonical.y-(A.canonical.y>>Z),Ke=o.Z>>Z;o.bQ($,0,Ke,Ke,0,0,1),o.L($,$,[-re*Ke+Me*o.Z,-fe*Ke+ke*o.Z,0])}else{const Z=s.canonical.z-A.canonical.z,re=s.canonical.x-(s.canonical.x>>Z<<Z),fe=s.canonical.y-(s.canonical.y>>Z<<Z),Me=(s.canonical.x>>Z)-A.canonical.x,ke=(s.canonical.y>>Z)-A.canonical.y,Ke=o.Z<<Z;o.bQ($,0,Ke,Ke,0,0,1),o.L($,$,[re*o.Z+Me*Ke,fe*o.Z+ke*Ke,0])}N.terrainRttPosMatrix32f=new Float32Array($),g[x]=N}return g}getSourceTile(s,c){const g=this.sourceCache._source;let x=s.overscaledZ-this.deltaZoom;if(x>g.maxzoom&&(x=g.maxzoom),x<g.minzoom)return null;this._sourceTileCache[s.key]||(this._sourceTileCache[s.key]=s.scaledTo(x).key);let A=this.sourceCache.getTileByID(this._sourceTileCache[s.key]);if((!A||!A.dem)&&c)for(;x>=g.minzoom&&(!A||!A.dem);)A=this.sourceCache.getTileByID(s.scaledTo(x--).key);return A}anyTilesAfterTime(s=Date.now()){return this._lastTilesetChange>=s}_isWithinTileRanges(s,c){return c[s.canonical.z]&&s.canonical.x>=c[s.canonical.z].minTileX&&s.canonical.x<=c[s.canonical.z].maxTileX&&s.canonical.y>=c[s.canonical.z].minTileY&&s.canonical.y<=c[s.canonical.z].maxTileY}}class xe{constructor(s,c,g){this._meshCache={},this.painter=s,this.sourceCache=new pe(c),this.options=g,this.exaggeration=typeof g.exaggeration=="number"?g.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(s,c,g,x=o.Z){var A;if(!(c>=0&&c<x&&g>=0&&g<x))return 0;const N=this.getTerrainData(s),$=(A=N.tile)===null||A===void 0?void 0:A.dem;if(!$)return 0;const Z=o.ch([],[c/x*o.Z,g/x*o.Z],N.u_terrain_matrix),re=[Z[0]*$.dim,Z[1]*$.dim],fe=Math.floor(re[0]),Me=Math.floor(re[1]),ke=re[0]-fe,Ke=re[1]-Me;return $.get(fe,Me)*(1-ke)*(1-Ke)+$.get(fe+1,Me)*ke*(1-Ke)+$.get(fe,Me+1)*(1-ke)*Ke+$.get(fe+1,Me+1)*ke*Ke}getElevationForLngLatZoom(s,c){if(!o.ci(c,s.wrap()))return 0;const{tileID:g,mercatorX:x,mercatorY:A}=this._getOverscaledTileIDFromLngLatZoom(s,c);return this.getElevation(g,x%o.Z,A%o.Z,o.Z)}getElevation(s,c,g,x=o.Z){return this.getDEMElevation(s,c,g,x)*this.exaggeration}getTerrainData(s){if(!this._emptyDemTexture){const x=this.painter.context,A=new o.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new ue(x,A,x.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new ue(x,new o.R({width:1,height:1}),x.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(x.gl.NEAREST,x.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.ad([])}const c=this.sourceCache.getSourceTile(s,!0);if(c&&c.dem&&(!c.demTexture||c.needsTerrainPrepare)){const x=this.painter.context;c.demTexture=this.painter.getTileTexture(c.dem.stride),c.demTexture?c.demTexture.update(c.dem.getPixels(),{premultiply:!1}):c.demTexture=new ue(x,c.dem.getPixels(),x.gl.RGBA,{premultiply:!1}),c.demTexture.bind(x.gl.NEAREST,x.gl.CLAMP_TO_EDGE),c.needsTerrainPrepare=!1}const g=c&&c+c.tileID.key+s.key;if(g&&!this._demMatrixCache[g]){const x=this.sourceCache.sourceCache._source.maxzoom;let A=s.canonical.z-c.tileID.canonical.z;s.overscaledZ>s.canonical.z&&(s.canonical.z>=x?A=s.canonical.z-x:o.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const N=s.canonical.x-(s.canonical.x>>A<<A),$=s.canonical.y-(s.canonical.y>>A<<A),Z=o.cj(new Float64Array(16),[1/(o.Z<<A),1/(o.Z<<A),0]);o.L(Z,Z,[N*o.Z,$*o.Z,0]),this._demMatrixCache[s.key]={matrix:Z,coord:s}}return{u_depth:2,u_terrain:3,u_terrain_dim:c&&c.dem&&c.dem.dim||1,u_terrain_matrix:g?this._demMatrixCache[s.key].matrix:this._emptyDemMatrix,u_terrain_unpack:c&&c.dem&&c.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(c&&c.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:c}}getFramebuffer(s){const c=this.painter,g=c.width/devicePixelRatio,x=c.height/devicePixelRatio;return!this._fbo||this._fbo.width===g&&this._fbo.height===x||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new ue(c.context,{width:g,height:x,data:null},c.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(c.context.gl.NEAREST,c.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new ue(c.context,{width:g,height:x,data:null},c.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(c.context.gl.NEAREST,c.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=c.context.createFramebuffer(g,x,!0,!1),this._fbo.depthAttachment.set(c.context.createRenderbuffer(c.context.gl.DEPTH_COMPONENT16,g,x))),this._fbo.colorAttachment.set(s==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const s=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const c=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let A=0,N=0;A<this._coordsTextureSize;A++)for(let $=0;$<this._coordsTextureSize;$++,N+=4)c[N+0]=255&$,c[N+1]=255&A,c[N+2]=$>>8<<4|A>>8,c[N+3]=0;const g=new o.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(c.buffer)),x=new ue(s,g,s.gl.RGBA,{premultiply:!1});return x.bind(s.gl.NEAREST,s.gl.CLAMP_TO_EDGE),this._coordsTexture=x,x}pointCoordinate(s){this.painter.maybeDrawDepthAndCoords(!0);const c=new Uint8Array(4),g=this.painter.context,x=g.gl,A=Math.round(s.x*this.painter.pixelRatio/devicePixelRatio),N=Math.round(s.y*this.painter.pixelRatio/devicePixelRatio),$=Math.round(this.painter.height/devicePixelRatio);g.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),x.readPixels(A,$-N-1,1,1,x.RGBA,x.UNSIGNED_BYTE,c),g.bindFramebuffer.set(null);const Z=c[0]+(c[2]>>4<<8),re=c[1]+((15&c[2])<<8),fe=this.coordsIndex[255-c[3]],Me=fe&&this.sourceCache.getTileByID(fe);if(!Me)return null;const ke=this._coordsTextureSize,Ke=(1<<Me.tileID.canonical.z)*ke;return new o.$((Me.tileID.canonical.x*ke+Z)/Ke+Me.tileID.wrap,(Me.tileID.canonical.y*ke+re)/Ke,this.getElevation(Me.tileID,Z,re,ke))}depthAtPoint(s){const c=new Uint8Array(4),g=this.painter.context,x=g.gl;return g.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),x.readPixels(s.x,this.painter.height/devicePixelRatio-s.y-1,1,1,x.RGBA,x.UNSIGNED_BYTE,c),g.bindFramebuffer.set(null),(c[0]/16777216+c[1]/65536+c[2]/256+c[3])/256}getTerrainMesh(s){var c;const g=((c=this.painter.style.projection)===null||c===void 0?void 0:c.transitionState)>0,x=g&&s.canonical.y===0,A=g&&s.canonical.y===(1<<s.canonical.z)-1,N=`m_${x?"n":""}_${A?"s":""}`;if(this._meshCache[N])return this._meshCache[N];const $=this.painter.context,Z=new o.ck,re=new o.aK,fe=this.meshSize,Me=o.Z/fe,ke=fe*fe;for(let on=0;on<=fe;on++)for(let On=0;On<=fe;On++)Z.emplaceBack(On*Me,on*Me,0);for(let on=0;on<ke;on+=fe+1)for(let On=0;On<fe;On++)re.emplaceBack(On+on,fe+On+on+1,fe+On+on+2),re.emplaceBack(On+on,fe+On+on+2,On+on+1);const Ke=Z.length,Qe=Ke+(fe+1),Tt=(fe+1)*fe,Ct=x?o.b9:0,At=x?0:1,Rt=A?o.ba:o.Z,jt=A?0:1;for(let on=0;on<=fe;on++)Z.emplaceBack(on*Me,Ct,At);for(let on=0;on<=fe;on++)Z.emplaceBack(on*Me,Rt,jt);for(let on=0;on<fe;on++)re.emplaceBack(Tt+on,Qe+on,Qe+on+1),re.emplaceBack(Tt+on,Qe+on+1,Tt+on+1),re.emplaceBack(0+on,Ke+on+1,Ke+on),re.emplaceBack(0+on,0+on+1,Ke+on+1);const Vt=Z.length,en=Vt+2*(fe+1);for(const on of[0,1])for(let On=0;On<=fe;On++)for(const jn of[0,1])Z.emplaceBack(on*o.Z,On*Me,jn);for(let on=0;on<2*fe;on+=2)re.emplaceBack(Vt+on,Vt+on+1,Vt+on+3),re.emplaceBack(Vt+on,Vt+on+3,Vt+on+2),re.emplaceBack(en+on,en+on+3,en+on+1),re.emplaceBack(en+on,en+on+2,en+on+3);const mn=new nl($.createVertexBuffer(Z,te.members),$.createIndexBuffer(re),o.aJ.simpleSegment(0,0,Z.length,re.length));return this._meshCache[N]=mn,mn}getMeshFrameDelta(s){return 2*Math.PI*o.bu/Math.pow(2,Math.max(s,0))/5}getMinTileElevationForLngLatZoom(s,c){var g;const{tileID:x}=this._getOverscaledTileIDFromLngLatZoom(s,c);return(g=this.getMinMaxElevation(x).minElevation)!==null&&g!==void 0?g:0}getMinMaxElevation(s){const c=this.getTerrainData(s).tile,g={minElevation:null,maxElevation:null};return c&&c.dem&&(g.minElevation=c.dem.min*this.exaggeration,g.maxElevation=c.dem.max*this.exaggeration),g}_getOverscaledTileIDFromLngLatZoom(s,c){const g=o.$.fromLngLat(s.wrap()),x=(1<<c)*o.Z,A=g.x*x,N=g.y*x,$=Math.floor(A/o.Z),Z=Math.floor(N/o.Z);return{tileID:new o.Y(c,0,c,$,Z),mercatorX:A,mercatorY:N}}}class Fe{constructor(s,c,g){this._context=s,this._size=c,this._tileSize=g,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const s of this._objects)s.texture.destroy(),s.fbo.destroy()}_createObject(s){const c=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),g=new ue(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return g.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),c.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),c.colorAttachment.set(g.texture),{id:s,fbo:c,texture:g,stamp:-1,inUse:!1}}getObjectForId(s){return this._objects[s]}useObject(s){s.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(c=>s.id!==c),this._recentlyUsed.push(s.id)}stampObject(s){s.stamp=++this._stamp}getOrCreateFreeObject(){for(const c of this._recentlyUsed)if(!this._objects[c].inUse)return this._objects[c];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const s=this._createObject(this._objects.length);return this._objects.push(s),s}freeObject(s){s.inUse=!1}freeAllObjects(){for(const s of this._objects)this.freeObject(s)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(s=>!s.inUse)===!1}}const tt={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class zt{constructor(s,c){this.painter=s,this.terrain=c,this.pool=new Fe(s.context,30,c.sourceCache.tileSize*c.qualityFactor)}destruct(){this.pool.destruct()}getTexture(s){return this.pool.getObjectForId(s.rtt[this._stacks.length-1].id).texture}prepareForRender(s,c){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=s._order.filter(g=>!s._layers[g].isHidden(c)),this._coordsAscending={};for(const g in s.sourceCaches){this._coordsAscending[g]={};const x=s.sourceCaches[g].getVisibleCoordinates(),A=s.sourceCaches[g].getSource(),N=A instanceof an?A.terrainTileRanges:null;for(const $ of x){const Z=this.terrain.sourceCache.getTerrainCoords($,N);for(const re in Z)this._coordsAscending[g][re]||(this._coordsAscending[g][re]=[]),this._coordsAscending[g][re].push(Z[re])}}this._coordsAscendingStr={};for(const g of s._order){const x=s._layers[g],A=x.source;if(tt[x.type]&&!this._coordsAscendingStr[A]){this._coordsAscendingStr[A]={};for(const N in this._coordsAscending[A])this._coordsAscendingStr[A][N]=this._coordsAscending[A][N].map($=>$.key).sort().join()}}for(const g of this._renderableTiles)for(const x in this._coordsAscendingStr){const A=this._coordsAscendingStr[x][g.tileID.key];A&&A!==g.rttCoords[x]&&(g.rtt=[])}}renderLayer(s,c){if(s.isHidden(this.painter.transform.zoom))return!1;const g=Object.assign(Object.assign({},c),{isRenderingToTexture:!0}),x=s.type,A=this.painter,N=this._renderableLayerIds[this._renderableLayerIds.length-1]===s.id;if(tt[x]&&(this._prevType&&tt[this._prevType]||this._stacks.push([]),this._prevType=x,this._stacks[this._stacks.length-1].push(s.id),!N))return!0;if(tt[this._prevType]||tt[x]&&N){this._prevType=x;const $=this._stacks.length-1,Z=this._stacks[$]||[];for(const re of this._renderableTiles){if(this.pool.isFull()&&(lh(this.painter,this.terrain,this._rttTiles,g),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(re),re.rtt[$]){const Me=this.pool.getObjectForId(re.rtt[$].id);if(Me.stamp===re.rtt[$].stamp){this.pool.useObject(Me);continue}}const fe=this.pool.getOrCreateFreeObject();this.pool.useObject(fe),this.pool.stampObject(fe),re.rtt[$]={id:fe.id,stamp:fe.stamp},A.context.bindFramebuffer.set(fe.fbo.framebuffer),A.context.clear({color:o.b7.transparent,stencil:0}),A.currentStencilSource=void 0;for(let Me=0;Me<Z.length;Me++){const ke=A.style._layers[Z[Me]],Ke=ke.source?this._coordsAscending[ke.source][re.tileID.key]:[re.tileID];A.context.viewport.set([0,0,fe.fbo.width,fe.fbo.height]),A._renderTileClippingMasks(ke,Ke,!0),A.renderLayer(A,A.style.sourceCaches[ke.source],ke,Ke,g),ke.source&&(re.rttCoords[ke.source]=this._coordsAscendingStr[ke.source][re.tileID.key])}}return lh(this.painter,this.terrain,this._rttTiles,g),this._rttTiles=[],this.pool.freeAllObjects(),tt[x]}return!1}}const bt={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},dn=f,zn={hash:!1,interactive:!0,bearingSnap:7,attributionControl:S,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:o.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},hr={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Ir{constructor(s,c,g=!1){this.mousedown=A=>{this.startMove(A,C.mousePos(this.element,A)),C.addEventListener(window,"mousemove",this.mousemove),C.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=A=>{this.move(A,C.mousePos(this.element,A))},this.mouseup=A=>{this._rotatePitchHanlder.dragEnd(A),this.offTemp()},this.touchstart=A=>{A.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=C.touchPos(this.element,A.targetTouches)[0],this.startMove(A,this._startPos),C.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),C.addEventListener(window,"touchend",this.touchend))},this.touchmove=A=>{A.targetTouches.length!==1?this.reset():(this._lastPos=C.touchPos(this.element,A.targetTouches)[0],this.move(A,this._lastPos))},this.touchend=A=>{A.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=c;const x=new wd;this._rotatePitchHanlder=new zu({clickTolerance:3,move:(A,N)=>{const $=c.getBoundingClientRect(),Z=new o.P(($.bottom-$.top)/2,($.right-$.left)/2);return{bearingDelta:o.cc(new o.P(A.x,N.y),N,Z),pitchDelta:g?-.5*(N.y-A.y):void 0}},moveStateManager:x,enable:!0,assignEvents:()=>{}}),this.map=s,C.addEventListener(c,"mousedown",this.mousedown),C.addEventListener(c,"touchstart",this.touchstart,{passive:!1}),C.addEventListener(c,"touchcancel",this.reset)}startMove(s,c){this._rotatePitchHanlder.dragStart(s,c),C.disableDrag()}move(s,c){const g=this.map,{bearingDelta:x,pitchDelta:A}=this._rotatePitchHanlder.dragMove(s,c)||{};x&&g.setBearing(g.getBearing()+x),A&&g.setPitch(g.getPitch()+A)}off(){const s=this.element;C.removeEventListener(s,"mousedown",this.mousedown),C.removeEventListener(s,"touchstart",this.touchstart,{passive:!1}),C.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),C.removeEventListener(window,"touchend",this.touchend),C.removeEventListener(s,"touchcancel",this.reset),this.offTemp()}offTemp(){C.enableDrag(),C.removeEventListener(window,"mousemove",this.mousemove),C.removeEventListener(window,"mouseup",this.mouseup),C.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),C.removeEventListener(window,"touchend",this.touchend)}}let Br;function ci(E,s,c,g=!1){if(g||!c.getCoveringTilesDetailsProvider().allowWorldCopies())return E==null?void 0:E.wrap();const x=new o.Q(E.lng,E.lat);if(E=new o.Q(E.lng,E.lat),s){const A=new o.Q(E.lng-360,E.lat),N=new o.Q(E.lng+360,E.lat),$=c.locationToScreenPoint(E).distSqr(s);c.locationToScreenPoint(A).distSqr(s)<$?E=A:c.locationToScreenPoint(N).distSqr(s)<$&&(E=N)}for(;Math.abs(E.lng-c.center.lng)>180;){const A=c.locationToScreenPoint(E);if(A.x>=0&&A.y>=0&&A.x<=c.width&&A.y<=c.height)break;E.lng>c.center.lng?E.lng-=360:E.lng+=360}return E.lng!==x.lng&&c.isPointOnMapSurface(c.locationToScreenPoint(E))?E:x}const Nt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function qt(E,s,c){const g=E.classList;for(const x in Nt)g.remove(`maplibregl-${c}-anchor-${x}`);g.add(`maplibregl-${c}-anchor-${s}`)}class gn extends o.E{constructor(s){if(super(),this._onKeyPress=c=>{const g=c.code,x=c.charCode||c.keyCode;g!=="Space"&&g!=="Enter"&&x!==32&&x!==13||this.togglePopup()},this._onMapClick=c=>{const g=c.originalEvent.target,x=this._element;this._popup&&(g===x||x.contains(g))&&this.togglePopup()},this._update=c=>{if(!this._map)return;const g=this._map.loaded()&&!this._map.isMoving();((c==null?void 0:c.type)==="terrain"||(c==null?void 0:c.type)==="render"&&!g)&&this._map.once("render",this._update),this._lngLat=ci(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let x="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?x=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(x=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let A="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?A="rotateX(0deg)":this._pitchAlignment==="map"&&(A=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||c&&c.type!=="moveend"||(this._pos=this._pos.round()),C.setTransform(this._element,`${Nt[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${A} ${x}`),M.frameAsync(new AbortController).then(()=>{this._updateOpacity(c&&c.type==="moveend")}).catch(()=>{})},this._onMove=c=>{if(!this._isDragging){const g=this._clickTolerance||this._map._clickTolerance;this._isDragging=c.point.dist(this._pointerdownPos)>=g}this._isDragging&&(this._pos=c.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.l("dragstart"))),this.fire(new o.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.l("dragend")),this._state="inactive"},this._addDragHandler=c=>{this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(this._pos).add(this._offset),this._pointerdownPos=c.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=s&&s.anchor||"center",this._color=s&&s.color||"#3FB1CE",this._scale=s&&s.scale||1,this._draggable=s&&s.draggable||!1,this._clickTolerance=s&&s.clickTolerance||0,this._subpixelPositioning=s&&s.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=s&&s.rotation||0,this._rotationAlignment=s&&s.rotationAlignment||"auto",this._pitchAlignment=s&&s.pitchAlignment&&s.pitchAlignment!=="auto"?s.pitchAlignment:this._rotationAlignment,this.setOpacity(s==null?void 0:s.opacity,s==null?void 0:s.opacityWhenCovered),s&&s.element)this._element=s.element,this._offset=o.P.convert(s&&s.offset||[0,0]);else{this._defaultMarker=!0,this._element=C.create("div");const c=C.createNS("http://www.w3.org/2000/svg","svg"),g=41,x=27;c.setAttributeNS(null,"display","block"),c.setAttributeNS(null,"height",`${g}px`),c.setAttributeNS(null,"width",`${x}px`),c.setAttributeNS(null,"viewBox",`0 0 ${x} ${g}`);const A=C.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"stroke","none"),A.setAttributeNS(null,"stroke-width","1"),A.setAttributeNS(null,"fill","none"),A.setAttributeNS(null,"fill-rule","evenodd");const N=C.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"fill-rule","nonzero");const $=C.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(3.0, 29.0)"),$.setAttributeNS(null,"fill","#000000");const Z=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const At of Z){const Rt=C.createNS("http://www.w3.org/2000/svg","ellipse");Rt.setAttributeNS(null,"opacity","0.04"),Rt.setAttributeNS(null,"cx","10.5"),Rt.setAttributeNS(null,"cy","5.80029008"),Rt.setAttributeNS(null,"rx",At.rx),Rt.setAttributeNS(null,"ry",At.ry),$.appendChild(Rt)}const re=C.createNS("http://www.w3.org/2000/svg","g");re.setAttributeNS(null,"fill",this._color);const fe=C.createNS("http://www.w3.org/2000/svg","path");fe.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),re.appendChild(fe);const Me=C.createNS("http://www.w3.org/2000/svg","g");Me.setAttributeNS(null,"opacity","0.25"),Me.setAttributeNS(null,"fill","#000000");const ke=C.createNS("http://www.w3.org/2000/svg","path");ke.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Me.appendChild(ke);const Ke=C.createNS("http://www.w3.org/2000/svg","g");Ke.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Ke.setAttributeNS(null,"fill","#FFFFFF");const Qe=C.createNS("http://www.w3.org/2000/svg","g");Qe.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Tt=C.createNS("http://www.w3.org/2000/svg","circle");Tt.setAttributeNS(null,"fill","#000000"),Tt.setAttributeNS(null,"opacity","0.25"),Tt.setAttributeNS(null,"cx","5.5"),Tt.setAttributeNS(null,"cy","5.5"),Tt.setAttributeNS(null,"r","5.4999962");const Ct=C.createNS("http://www.w3.org/2000/svg","circle");Ct.setAttributeNS(null,"fill","#FFFFFF"),Ct.setAttributeNS(null,"cx","5.5"),Ct.setAttributeNS(null,"cy","5.5"),Ct.setAttributeNS(null,"r","5.4999962"),Qe.appendChild(Tt),Qe.appendChild(Ct),N.appendChild($),N.appendChild(re),N.appendChild(Me),N.appendChild(Ke),N.appendChild(Qe),c.appendChild(N),c.setAttributeNS(null,"height",g*this._scale+"px"),c.setAttributeNS(null,"width",x*this._scale+"px"),this._element.appendChild(c),this._offset=o.P.convert(s&&s.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",c=>{c.preventDefault()}),this._element.addEventListener("mousedown",c=>{c.preventDefault()}),qt(this._element,this._anchor,"marker"),s&&s.className)for(const c of s.className.split(" "))this._element.classList.add(c);this._popup=null}addTo(s){return this.remove(),this._map=s,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",s._getUIString("Marker.Title")),s.getCanvasContainer().appendChild(this._element),s.on("move",this._update),s.on("moveend",this._update),s.on("terrain",this._update),s.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),C.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=o.Q.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){const x=Math.abs(13.5)/Math.SQRT2;s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(38.1-13.5+x)],"bottom-right":[-x,-1*(38.1-13.5+x)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=s,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(s){return this._subpixelPositioning=s,this}getPopup(){return this._popup}togglePopup(){const s=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:s?(s.isOpen()?s.remove():(s.setLngLat(this._lngLat),s.addTo(this._map)),this):this}_updateOpacity(s=!1){var c,g;if(!(!((c=this._map)===null||c===void 0)&&c.terrain)){const Me=this._map.transform.isLocationOccluded(this._lngLat)?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==Me&&(this._element.style.opacity=Me))}if(s)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const x=this._map,A=x.terrain.depthAtPoint(this._pos),N=x.terrain.getElevationForLngLatZoom(this._lngLat,x.transform.tileZoom);if(x.transform.lngLatToCameraDepth(this._lngLat,N)-A<.006)return void(this._element.style.opacity=this._opacity);const $=-this._offset.y/x.transform.pixelsPerMeter,Z=Math.sin(x.getPitch()*Math.PI/180)*$,re=x.terrain.depthAtPoint(new o.P(this._pos.x,this._pos.y-this._offset.y)),fe=x.transform.lngLatToCameraDepth(this._lngLat,N+Z)-re>.006;!((g=this._popup)===null||g===void 0)&&g.isOpen()&&fe&&this._popup.remove(),this._element.style.opacity=fe?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(s){return this._offset=o.P.convert(s),this._update(),this}addClassName(s){this._element.classList.add(s)}removeClassName(s){this._element.classList.remove(s)}toggleClassName(s){return this._element.classList.toggle(s)}setDraggable(s){return this._draggable=!!s,this._map&&(s?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s&&s!=="auto"?s:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(s,c){return(this._opacity===void 0||s===void 0&&c===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),s!==void 0&&(this._opacity=s),c!==void 0&&(this._opacityWhenCovered=c),this._map&&this._updateOpacity(!0),this}}const Gn={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Mn=0,Bn=!1;const Ge={maxWidth:100,unit:"metric"};function at(E,s,c){const g=c&&c.maxWidth||100,x=E._container.clientHeight/2,A=E._container.clientWidth/2,N=E.unproject([A-g/2,x]),$=E.unproject([A+g/2,x]),Z=Math.round(E.project($).x-E.project(N).x),re=Math.min(g,Z,E._container.clientWidth),fe=N.distanceTo($);if(c&&c.unit==="imperial"){const Me=3.2808*fe;Me>5280?mt(s,re,Me/5280,E._getUIString("ScaleControl.Miles")):mt(s,re,Me,E._getUIString("ScaleControl.Feet"))}else c&&c.unit==="nautical"?mt(s,re,fe/1852,E._getUIString("ScaleControl.NauticalMiles")):fe>=1e3?mt(s,re,fe/1e3,E._getUIString("ScaleControl.Kilometers")):mt(s,re,fe,E._getUIString("ScaleControl.Meters"))}function mt(E,s,c,g){const x=function(A){const N=Math.pow(10,`${Math.floor(A)}`.length-1);let $=A/N;return $=$>=10?10:$>=5?5:$>=3?3:$>=2?2:$>=1?1:function(Z){const re=Math.pow(10,Math.ceil(-Math.log(Z)/Math.LN10));return Math.round(Z*re)/re}($),N*$}(c);E.style.width=s*(x/c)+"px",E.innerHTML=`${x}&nbsp;${g}`}const _t={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},St=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Lt(E){if(E){if(typeof E=="number"){const s=Math.round(Math.abs(E)/Math.SQRT2);return{center:new o.P(0,0),top:new o.P(0,E),"top-left":new o.P(s,s),"top-right":new o.P(-s,s),bottom:new o.P(0,-E),"bottom-left":new o.P(s,-s),"bottom-right":new o.P(-s,-s),left:new o.P(E,0),right:new o.P(-E,0)}}if(E instanceof o.P||Array.isArray(E)){const s=o.P.convert(E);return{center:s,top:s,"top-left":s,"top-right":s,bottom:s,"bottom-left":s,"bottom-right":s,left:s,right:s}}return{center:o.P.convert(E.center||[0,0]),top:o.P.convert(E.top||[0,0]),"top-left":o.P.convert(E["top-left"]||[0,0]),"top-right":o.P.convert(E["top-right"]||[0,0]),bottom:o.P.convert(E.bottom||[0,0]),"bottom-left":o.P.convert(E["bottom-left"]||[0,0]),"bottom-right":o.P.convert(E["bottom-right"]||[0,0]),left:o.P.convert(E.left||[0,0]),right:o.P.convert(E.right||[0,0])}}return Lt(new o.P(0,0))}const sn=f;a.AJAXError=o.co,a.Event=o.l,a.Evented=o.E,a.LngLat=o.Q,a.MercatorCoordinate=o.$,a.Point=o.P,a.addProtocol=o.cp,a.config=o.a,a.removeProtocol=o.cq,a.AttributionControl=I,a.BoxZoomHandler=uh,a.CanvasSource=vn,a.CooperativeGesturesHandler=Cr,a.DoubleClickZoomHandler=kn,a.DragPanHandler=Qt,a.DragRotateHandler=Sn,a.EdgeInsets=cu,a.FullscreenControl=class extends o.E{constructor(E={}){super(),this._onFullscreenChange=()=>{var s;let c=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((s=c==null?void 0:c.shadowRoot)===null||s===void 0)&&s.fullscreenElement;)c=c.shadowRoot.fullscreenElement;c===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,E&&E.container&&(E.container instanceof HTMLElement?this._container=E.container:o.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(E){return this._map=E,this._container||(this._container=this._map.getContainer()),this._controlContainer=C.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){C.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const E=this._fullscreenButton=C.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);C.create("span","maplibregl-ctrl-icon",E).setAttribute("aria-hidden","true"),E.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const E=this._getTitle();this._fullscreenButton.setAttribute("aria-label",E),this._fullscreenButton.title=E}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new o.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new o.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},a.GeoJSONSource=Zt,a.GeolocateControl=class extends o.E{constructor(E){super(),this._onSuccess=s=>{if(this._map){if(this._isOutOfMapMaxBounds(s))return this._setErrorState(),this.fire(new o.l("outofmaxbounds",s)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=s,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(s),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(s),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new o.l("geolocate",s)),this._finish()}},this._updateCamera=s=>{const c=new o.Q(s.coords.longitude,s.coords.latitude),g=s.coords.accuracy,x=this._map.getBearing(),A=o.e({bearing:x},this.options.fitBoundsOptions),N=Ae.fromLngLat(c,g);this._map.fitBounds(N,A,{geolocateSource:!0})},this._updateMarker=s=>{if(s){const c=new o.Q(s.coords.longitude,s.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=s.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=s=>{if(this._map){if(this.options.trackUserLocation)if(s.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(s.code===3&&Bn)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new o.l("error",s)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",s=>s.preventDefault()),this._geolocateButton=C.create("button","maplibregl-ctrl-geolocate",this._container),C.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=s=>{if(this._map){if(s===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}else{const c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=C.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new gn({element:this._dotElement}),this._circleElement=C.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new gn({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{c.geolocateSource||this._watchState!=="ACTIVE_LOCK"||c.originalEvent&&c.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new o.l("trackuserlocationend")),this.fire(new o.l("userlocationlostfocus")))})}},this.options=o.e({},Gn,E)}onAdd(E){return this._map=E,this._container=C.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return o._(this,arguments,void 0,function*(s=!1){if(Br!==void 0&&!s)return Br;if(window.navigator.permissions===void 0)return Br=!!window.navigator.geolocation,Br;try{Br=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Br=!!window.navigator.geolocation}return Br})}().then(s=>this._finishSetupUI(s)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),C.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Mn=0,Bn=!1}_isOutOfMapMaxBounds(E){const s=this._map.getMaxBounds(),c=E.coords;return s&&(c.longitude<s.getWest()||c.longitude>s.getEast()||c.latitude<s.getSouth()||c.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const E=this._map.getBounds(),s=E.getSouthEast(),c=E.getNorthEast(),g=s.distanceTo(c),x=Math.ceil(this._accuracy/(g/this._map._container.clientHeight)*2);this._circleElement.style.width=`${x}px`,this._circleElement.style.height=`${x}px`}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Mn--,Bn=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new o.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.l("trackuserlocationstart")),this.fire(new o.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let E;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Mn++,Mn>1?(E={maximumAge:6e5,timeout:0},Bn=!0):(E=this.options.positionOptions,Bn=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,E)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},a.GlobeControl=class{constructor(){this._toggleProjection=()=>{var E;const s=(E=this._map.getProjection())===null||E===void 0?void 0:E.type;this._map.setProjection(s!=="mercator"&&s?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var E;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((E=this._map.getProjection())===null||E===void 0?void 0:E.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(E){return this._map=E,this._container=C.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=C.create("button","maplibregl-ctrl-globe",this._container),C.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){C.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},a.Hash=Xh,a.ImageSource=an,a.KeyboardHandler=kt,a.LngLatBounds=Ae,a.LogoControl=F,a.Map=class extends y{constructor(E){var s,c;o.cl.mark(o.cm.create);const g=Object.assign(Object.assign(Object.assign({},zn),E),{canvasContextAttributes:Object.assign(Object.assign({},zn.canvasContextAttributes),E.canvasContextAttributes)});if(g.minZoom!=null&&g.maxZoom!=null&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(g.minPitch!=null&&g.maxPitch!=null&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(g.minPitch!=null&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(g.maxPitch!=null&&g.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const x=new Bi,A=new Pa;if(g.minZoom!==void 0&&x.setMinZoom(g.minZoom),g.maxZoom!==void 0&&x.setMaxZoom(g.maxZoom),g.minPitch!==void 0&&x.setMinPitch(g.minPitch),g.maxPitch!==void 0&&x.setMaxPitch(g.maxPitch),g.renderWorldCopies!==void 0&&x.setRenderWorldCopies(g.renderWorldCopies),super(x,A,{bearingSnap:g.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new G,this._controls=[],this._mapId=o.a4(),this._contextLost=$=>{$.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new o.l("webglcontextlost",{originalEvent:$}))},this._contextRestored=$=>{this._setupPainter(),this.resize(),this._update(),this.fire(new o.l("webglcontextrestored",{originalEvent:$}))},this._onMapScroll=$=>{if($.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=g.interactive,this._maxTileCacheSize=g.maxTileCacheSize,this._maxTileCacheZoomLevels=g.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},g.canvasContextAttributes),this._trackResize=g.trackResize===!0,this._bearingSnap=g.bearingSnap,this._centerClampedToGround=g.centerClampedToGround,this._refreshExpiredTiles=g.refreshExpiredTiles===!0,this._fadeDuration=g.fadeDuration,this._crossSourceCollisions=g.crossSourceCollisions===!0,this._collectResourceTiming=g.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},bt),g.locale),this._clickTolerance=g.clickTolerance,this._overridePixelRatio=g.pixelRatio,this._maxCanvasSize=g.maxCanvasSize,this.transformCameraUpdate=g.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=g.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=oe.addThrottleControl(()=>this.isMoving()),this._requestManager=new le(g.transformRequest),typeof g.container=="string"){if(this._container=document.getElementById(g.container),!this._container)throw new Error(`Container '${g.container}' not found.`)}else{if(!(g.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(g.maxBounds&&this.setMaxBounds(g.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let $=!1;const Z=qa(re=>{this._trackResize&&!this._removed&&(this.resize(re),this.redraw())},50);this._resizeObserver=new ResizeObserver(re=>{$?Z(re):$=!0}),this._resizeObserver.observe(this._container)}this.handlers=new ei(this,g),this._hash=g.hash&&new Xh(typeof g.hash=="string"&&g.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:g.center,elevation:g.elevation,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch,roll:g.roll}),g.bounds&&(this.resize(),this.fitBounds(g.bounds,o.e({},g.fitBoundsOptions,{duration:0}))));const N=typeof g.style=="string"||((c=(s=g.style)===null||s===void 0?void 0:s.projection)===null||c===void 0?void 0:c.type)!=="globe";this.resize(null,N),this._localIdeographFontFamily=g.localIdeographFontFamily,this._validateStyle=g.validateStyle,g.style&&this.setStyle(g.style,{localIdeographFontFamily:g.localIdeographFontFamily}),g.attributionControl&&this.addControl(new I(typeof g.attributionControl=="boolean"?void 0:g.attributionControl)),g.maplibreLogo&&this.addControl(new F,g.logoPosition),this.on("style.load",()=>{if(N||this._resizeTransform(),this.transform.unmodified){const $=o.O(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo($)}}),this.on("data",$=>{this._update($.dataType==="style"),this.fire(new o.l(`${$.dataType}data`,$))}),this.on("dataloading",$=>{this.fire(new o.l(`${$.dataType}dataloading`,$))}),this.on("dataabort",$=>{this.fire(new o.l("sourcedataabort",$))})}_getMapId(){return this._mapId}addControl(E,s){if(s===void 0&&(s=E.getDefaultPosition?E.getDefaultPosition():"top-right"),!E||!E.onAdd)return this.fire(new o.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=E.onAdd(this);this._controls.push(E);const g=this._controlPositions[s];return s.indexOf("bottom")!==-1?g.insertBefore(c,g.firstChild):g.appendChild(c),this}removeControl(E){if(!E||!E.onRemove)return this.fire(new o.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const s=this._controls.indexOf(E);return s>-1&&this._controls.splice(s,1),E.onRemove(this),this}hasControl(E){return this._controls.indexOf(E)>-1}calculateCameraOptionsFromTo(E,s,c,g){return g==null&&this.terrain&&(g=this.terrain.getElevationForLngLatZoom(c,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(E,s,c,g)}resize(E,s=!0){const[c,g]=this._containerDimensions(),x=this._getClampedPixelRatio(c,g);if(this._resizeCanvas(c,g,x),this.painter.resize(c,g,x),this.painter.overLimit()){const N=this.painter.context.gl;this._maxCanvasSize=[N.drawingBufferWidth,N.drawingBufferHeight];const $=this._getClampedPixelRatio(c,g);this._resizeCanvas(c,g,$),this.painter.resize(c,g,$)}this._resizeTransform(s);const A=!this._moving;return A&&(this.stop(),this.fire(new o.l("movestart",E)).fire(new o.l("move",E))),this.fire(new o.l("resize",E)),A&&this.fire(new o.l("moveend",E)),this}_resizeTransform(E=!0){var s;const[c,g]=this._containerDimensions();this.transform.resize(c,g,E),(s=this._requestedCameraState)===null||s===void 0||s.resize(c,g,E)}_getClampedPixelRatio(E,s){const{0:c,1:g}=this._maxCanvasSize,x=this.getPixelRatio(),A=E*x,N=s*x;return Math.min(A>c?c/A:1,N>g?g/N:1)*x}getPixelRatio(){var E;return(E=this._overridePixelRatio)!==null&&E!==void 0?E:devicePixelRatio}setPixelRatio(E){this._overridePixelRatio=E,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(E){return this.transform.setMaxBounds(Ae.convert(E)),this._update()}setMinZoom(E){if((E=E??-2)>=-2&&E<=this.transform.maxZoom)return this.transform.setMinZoom(E),this._update(),this.getZoom()<E&&this.setZoom(E),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(E){if((E=E??22)>=this.transform.minZoom)return this.transform.setMaxZoom(E),this._update(),this.getZoom()>E&&this.setZoom(E),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(E){if((E=E??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(E>=0&&E<=this.transform.maxPitch)return this.transform.setMinPitch(E),this._update(),this.getPitch()<E&&this.setPitch(E),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(E){if((E=E??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(E>=this.transform.minPitch)return this.transform.setMaxPitch(E),this._update(),this.getPitch()>E&&this.setPitch(E),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(E){return this.transform.setRenderWorldCopies(E),this._update()}project(E){return this.transform.locationToScreenPoint(o.Q.convert(E),this.style&&this.terrain)}unproject(E){return this.transform.screenPointToLocation(o.P.convert(E),this.terrain)}isMoving(){var E;return this._moving||((E=this.handlers)===null||E===void 0?void 0:E.isMoving())}isZooming(){var E;return this._zooming||((E=this.handlers)===null||E===void 0?void 0:E.isZooming())}isRotating(){var E;return this._rotating||((E=this.handlers)===null||E===void 0?void 0:E.isRotating())}_createDelegatedListener(E,s,c){if(E==="mouseenter"||E==="mouseover"){let g=!1;return{layers:s,listener:c,delegates:{mousemove:A=>{const N=s.filter(Z=>this.getLayer(Z)),$=N.length!==0?this.queryRenderedFeatures(A.point,{layers:N}):[];$.length?g||(g=!0,c.call(this,new Ll(E,this,A.originalEvent,{features:$}))):g=!1},mouseout:()=>{g=!1}}}}if(E==="mouseleave"||E==="mouseout"){let g=!1;return{layers:s,listener:c,delegates:{mousemove:N=>{const $=s.filter(Z=>this.getLayer(Z));($.length!==0?this.queryRenderedFeatures(N.point,{layers:$}):[]).length?g=!0:g&&(g=!1,c.call(this,new Ll(E,this,N.originalEvent)))},mouseout:N=>{g&&(g=!1,c.call(this,new Ll(E,this,N.originalEvent)))}}}}{const g=x=>{const A=s.filter($=>this.getLayer($)),N=A.length!==0?this.queryRenderedFeatures(x.point,{layers:A}):[];N.length&&(x.features=N,c.call(this,x),delete x.features)};return{layers:s,listener:c,delegates:{[E]:g}}}}_saveDelegatedListener(E,s){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[E]=this._delegatedListeners[E]||[],this._delegatedListeners[E].push(s)}_removeDelegatedListener(E,s,c){if(!this._delegatedListeners||!this._delegatedListeners[E])return;const g=this._delegatedListeners[E];for(let x=0;x<g.length;x++){const A=g[x];if(A.listener===c&&A.layers.length===s.length&&A.layers.every(N=>s.includes(N))){for(const N in A.delegates)this.off(N,A.delegates[N]);return void g.splice(x,1)}}}on(E,s,c){if(c===void 0)return super.on(E,s);const g=typeof s=="string"?[s]:s,x=this._createDelegatedListener(E,g,c);this._saveDelegatedListener(E,x);for(const A in x.delegates)this.on(A,x.delegates[A]);return{unsubscribe:()=>{this._removeDelegatedListener(E,g,c)}}}once(E,s,c){if(c===void 0)return super.once(E,s);const g=typeof s=="string"?[s]:s,x=this._createDelegatedListener(E,g,c);for(const A in x.delegates){const N=x.delegates[A];x.delegates[A]=(...$)=>{this._removeDelegatedListener(E,g,c),N(...$)}}this._saveDelegatedListener(E,x);for(const A in x.delegates)this.once(A,x.delegates[A]);return this}off(E,s,c){return c===void 0?super.off(E,s):(this._removeDelegatedListener(E,typeof s=="string"?[s]:s,c),this)}queryRenderedFeatures(E,s){if(!this.style)return[];let c;const g=E instanceof o.P||Array.isArray(E),x=g?E:[[0,0],[this.transform.width,this.transform.height]];if(s=s||(g?{}:E)||{},x instanceof o.P||typeof x[0]=="number")c=[o.P.convert(x)];else{const A=o.P.convert(x[0]),N=o.P.convert(x[1]);c=[A,new o.P(N.x,A.y),N,new o.P(A.x,N.y),A]}return this.style.queryRenderedFeatures(c,s,this.transform)}querySourceFeatures(E,s){return this.style.querySourceFeatures(E,s)}setStyle(E,s){return(s=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},s)).diff!==!1&&s.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&E?(this._diffStyle(E,s),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._updateStyle(E,s))}setTransformRequest(E){return this._requestManager.setTransformRequest(E),this}_getUIString(E){const s=this._locale[E];if(s==null)throw new Error(`Missing UI string '${E}'`);return s}_updateStyle(E,s){var c,g;if(s.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(E,s));const x=this.style&&s.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!E)),E?(this.style=new il(this,s||{}),this.style.setEventedParent(this,{style:this.style}),typeof E=="string"?this.style.loadURL(E,s,x):this.style.loadJSON(E,s,x),this):((g=(c=this.style)===null||c===void 0?void 0:c.projection)===null||g===void 0||g.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new il(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(E,s){if(typeof E=="string"){const c=this._requestManager.transformRequest(E,"Style");o.j(c,new AbortController).then(g=>{this._updateDiff(g.data,s)}).catch(g=>{g&&this.fire(new o.k(g))})}else typeof E=="object"&&this._updateDiff(E,s)}_updateDiff(E,s){try{this.style.setState(E,s)&&this._update(!0)}catch(c){o.w(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(E,s)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():o.w("There is no style added to the map.")}addSource(E,s){return this._lazyInitEmptyStyle(),this.style.addSource(E,s),this._update(!0)}isSourceLoaded(E){const s=this.style&&this.style.sourceCaches[E];if(s!==void 0)return s.loaded();this.fire(new o.k(new Error(`There is no source with ID '${E}'`)))}setTerrain(E){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),E){const s=this.style.sourceCaches[E.source];if(!s)throw new Error(`cannot load terrain, because there exists no source with ID: ${E.source}`);this.terrain===null&&s.reload();for(const c in this.style._layers){const g=this.style._layers[c];g.type==="hillshade"&&g.source===E.source&&o.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new xe(this.painter,s,E),this.painter.renderToTexture=new zt(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=c=>{var g;c.dataType==="style"?this.terrain.sourceCache.freeRtt():c.dataType==="source"&&c.tile&&(c.sourceId!==E.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((g=c.source)===null||g===void 0?void 0:g.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(c.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new o.l("terrain",{terrain:E})),this}getTerrain(){var E,s;return(s=(E=this.terrain)===null||E===void 0?void 0:E.options)!==null&&s!==void 0?s:null}areTilesLoaded(){const E=this.style&&this.style.sourceCaches;for(const s in E){const c=E[s]._tiles;for(const g in c){const x=c[g];if(x.state!=="loaded"&&x.state!=="errored")return!1}}return!0}removeSource(E){return this.style.removeSource(E),this._update(!0)}getSource(E){return this.style.getSource(E)}setSourceTileLodParams(E,s,c){if(c){const g=this.getSource(c);if(!g)throw new Error(`There is no source with ID "${c}", cannot set LOD parameters`);g.calculateTileZoom=$e(Math.max(1,E),Math.max(1,s))}else for(const g in this.style.sourceCaches)this.style.sourceCaches[g].getSource().calculateTileZoom=$e(Math.max(1,E),Math.max(1,s));return this._update(!0),this}addImage(E,s,c={}){const{pixelRatio:g=1,sdf:x=!1,stretchX:A,stretchY:N,content:$,textFitWidth:Z,textFitHeight:re}=c;if(this._lazyInitEmptyStyle(),!(s instanceof HTMLImageElement||o.b(s))){if(s.width===void 0||s.height===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:fe,height:Me,data:ke}=s,Ke=s;return this.style.addImage(E,{data:new o.R({width:fe,height:Me},new Uint8Array(ke)),pixelRatio:g,stretchX:A,stretchY:N,content:$,textFitWidth:Z,textFitHeight:re,sdf:x,version:0,userImage:Ke}),Ke.onAdd&&Ke.onAdd(this,E),this}}{const{width:fe,height:Me,data:ke}=M.getImageData(s);this.style.addImage(E,{data:new o.R({width:fe,height:Me},ke),pixelRatio:g,stretchX:A,stretchY:N,content:$,textFitWidth:Z,textFitHeight:re,sdf:x,version:0})}}updateImage(E,s){const c=this.style.getImage(E);if(!c)return this.fire(new o.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const g=s instanceof HTMLImageElement||o.b(s)?M.getImageData(s):s,{width:x,height:A,data:N}=g;if(x===void 0||A===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(x!==c.data.width||A!==c.data.height)return this.fire(new o.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const $=!(s instanceof HTMLImageElement||o.b(s));return c.data.replace(N,$),this.style.updateImage(E,c),this}getImage(E){return this.style.getImage(E)}hasImage(E){return E?!!this.style.getImage(E):(this.fire(new o.k(new Error("Missing required image id"))),!1)}removeImage(E){this.style.removeImage(E)}loadImage(E){return oe.getImage(this._requestManager.transformRequest(E,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(E,s){return this._lazyInitEmptyStyle(),this.style.addLayer(E,s),this._update(!0)}moveLayer(E,s){return this.style.moveLayer(E,s),this._update(!0)}removeLayer(E){return this.style.removeLayer(E),this._update(!0)}getLayer(E){return this.style.getLayer(E)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(E,s,c){return this.style.setLayerZoomRange(E,s,c),this._update(!0)}setFilter(E,s,c={}){return this.style.setFilter(E,s,c),this._update(!0)}getFilter(E){return this.style.getFilter(E)}setPaintProperty(E,s,c,g={}){return this.style.setPaintProperty(E,s,c,g),this._update(!0)}getPaintProperty(E,s){return this.style.getPaintProperty(E,s)}setLayoutProperty(E,s,c,g={}){return this.style.setLayoutProperty(E,s,c,g),this._update(!0)}getLayoutProperty(E,s){return this.style.getLayoutProperty(E,s)}setGlyphs(E,s={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(E,s),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(E,s,c={}){return this._lazyInitEmptyStyle(),this.style.addSprite(E,s,c,g=>{g||this._update(!0)}),this}removeSprite(E){return this._lazyInitEmptyStyle(),this.style.removeSprite(E),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(E,s={}){return this._lazyInitEmptyStyle(),this.style.setSprite(E,s,c=>{c||this._update(!0)}),this}setLight(E,s={}){return this._lazyInitEmptyStyle(),this.style.setLight(E,s),this._update(!0)}getLight(){return this.style.getLight()}setSky(E,s={}){return this._lazyInitEmptyStyle(),this.style.setSky(E,s),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(E,s){return this.style.setFeatureState(E,s),this._update()}removeFeatureState(E,s){return this.style.removeFeatureState(E,s),this._update()}getFeatureState(E){return this.style.getFeatureState(E)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let E=0,s=0;return this._container&&(E=this._container.clientWidth||400,s=this._container.clientHeight||300),[E,s]}_setupContainer(){const E=this._container;E.classList.add("maplibregl-map");const s=this._canvasContainer=C.create("div","maplibregl-canvas-container",E);this._interactive&&s.classList.add("maplibregl-interactive"),this._canvas=C.create("canvas","maplibregl-canvas",s),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const c=this._containerDimensions(),g=this._getClampedPixelRatio(c[0],c[1]);this._resizeCanvas(c[0],c[1],g);const x=this._controlContainer=C.create("div","maplibregl-control-container",E),A=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(N=>{A[N]=C.create("div",`maplibregl-ctrl-${N} `,x)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(E,s,c){this._canvas.width=Math.floor(c*E),this._canvas.height=Math.floor(c*s),this._canvas.style.width=`${E}px`,this._canvas.style.height=`${s}px`}_setupPainter(){const E=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let s=null;this._canvas.addEventListener("webglcontextcreationerror",g=>{s={requestedAttributes:E},g&&(s.statusMessage=g.statusMessage,s.type=g.type)},{once:!0});let c=null;if(c=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,E):this._canvas.getContext("webgl2",E)||this._canvas.getContext("webgl",E),!c){const g="Failed to initialize WebGL";throw s?(s.message=g,new Error(JSON.stringify(s))):new Error(g)}this.painter=new Sl(c,this.transform),R.testSupport(c)}migrateProjection(E,s){super.migrateProjection(E,s),this.painter.transform=E,this.fire(new o.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(E){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||E,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(E){return this._update(),this._renderTaskQueue.add(E)}_cancelRenderFrame(E){this._renderTaskQueue.remove(E)}_render(E){var s,c,g,x,A;const N=this._idleTriggered?this._fadeDuration:0,$=((s=this.style.projection)===null||s===void 0?void 0:s.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(E),this._removed)return;let Z=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const Me=this.transform.zoom,ke=M.now();this.style.zoomHistory.update(Me,ke);const Ke=new o.C(Me,{now:ke,fadeDuration:N,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Qe=Ke.crossFadingFactor();Qe===1&&Qe===this._crossFadingFactor||(Z=!0,this._crossFadingFactor=Qe),this.style.update(Ke)}const re=((c=this.style.projection)===null||c===void 0?void 0:c.transitionState)>0!==$;(g=this.style.projection)===null||g===void 0||g.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((x=this.style.projection)===null||x===void 0?void 0:x.transitionState,(A=this.style.projection)===null||A===void 0?void 0:A.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||re)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,N,this._crossSourceCollisions,re),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:N,showPadding:this.showPadding}),this.fire(new o.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.cl.mark(o.cm.load),this.fire(new o.l("load"))),this.style&&(this.style.hasTransitions()||Z)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const fe=this._sourcesDirty||this._styleDirty||this._placementDirty;return fe||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.l("idle")),!this._loaded||this._fullyLoaded||fe||(this._fullyLoaded=!0,o.cl.mark(o.cm.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var E;this._hash&&this._hash.remove();for(const c of this._controls)c.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),oe.removeThrottleControl(this._imageQueueHandle),(E=this._resizeObserver)===null||E===void 0||E.disconnect();const s=this.painter.context.gl.getExtension("WEBGL_lose_context");s!=null&&s.loseContext&&s.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),C.remove(this._canvasContainer),C.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),o.cl.clearMetrics(),this._removed=!0,this.fire(new o.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,M.frame(this._frameRequest,E=>{o.cl.frame(E),this._frameRequest=null;try{this._render(E)}catch(s){if(!o.cn(s)&&!function(c){return c.message===wl}(s))throw s}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(E){this._showTileBoundaries!==E&&(this._showTileBoundaries=E,this._update())}get showPadding(){return!!this._showPadding}set showPadding(E){this._showPadding!==E&&(this._showPadding=E,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(E){this._showCollisionBoxes!==E&&(this._showCollisionBoxes=E,E?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(E){this._showOverdrawInspector!==E&&(this._showOverdrawInspector=E,this._update())}get repaint(){return!!this._repaint}set repaint(E){this._repaint!==E&&(this._repaint=E,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(E){this._vertices=E,this._update()}get version(){return dn}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(E){return this._lazyInitEmptyStyle(),this.style.setProjection(E),this._update(!0)}},a.MapMouseEvent=Ll,a.MapTouchEvent=Ia,a.MapWheelEvent=Wo,a.Marker=gn,a.NavigationControl=class{constructor(E){this._updateZoomButtons=()=>{const s=this._map.getZoom(),c=s===this._map.getMaxZoom(),g=s===this._map.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(s,c)=>{const g=this._map._getUIString(`NavigationControl.${c}`);s.title=g,s.setAttribute("aria-label",g)},this.options=o.e({},hr,E),this._container=C.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",s=>this._map.zoomIn({},{originalEvent:s})),C.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",s=>this._map.zoomOut({},{originalEvent:s})),C.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",s=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:s}):this._map.resetNorth({},{originalEvent:s})}),this._compassIcon=C.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(E){return this._map=E,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ir(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){C.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(E,s){const c=C.create("button",E,this._container);return c.type="button",c.addEventListener("click",s),c}},a.Popup=class extends o.E{constructor(E){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&C.remove(this._content),this._container&&(C.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new o.l("close"))),this),this._onMouseUp=s=>{this._update(s.point)},this._onMouseMove=s=>{this._update(s.point)},this._onDrag=s=>{this._update(s.point)},this._update=s=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=C.create("div","maplibregl-popup",this._map.getContainer()),this._tip=C.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const N of this.options.className.split(" "))this._container.classList.add(N);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=ci(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!s)return;const c=this._flatPos=this._pos=this._trackPointer&&s?s:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&s?s:this._map.transform.locationToScreenPoint(this._lngLat));let g=this.options.anchor;const x=Lt(this.options.offset);if(!g){const N=this._container.offsetWidth,$=this._container.offsetHeight;let Z;Z=c.y+x.bottom.y<$?["top"]:c.y>this._map.transform.height-$?["bottom"]:[],c.x<N/2?Z.push("left"):c.x>this._map.transform.width-N/2&&Z.push("right"),g=Z.length===0?"bottom":Z.join("-")}let A=c.add(x[g]);this.options.subpixelPositioning||(A=A.round()),C.setTransform(this._container,`${Nt[g]} translate(${A.x}px,${A.y}px)`),qt(this._container,g,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=o.e(Object.create(_t),E)}addTo(E){return this._map&&this.remove(),this._map=E,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new o.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(E){return this._lngLat=o.Q.convert(E),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(E){return this.setDOMContent(document.createTextNode(E))}setHTML(E){const s=document.createDocumentFragment(),c=document.createElement("body");let g;for(c.innerHTML=E;g=c.firstChild,g;)s.appendChild(g);return this.setDOMContent(s)}getMaxWidth(){var E;return(E=this._container)===null||E===void 0?void 0:E.style.maxWidth}setMaxWidth(E){return this.options.maxWidth=E,this._update(),this}setDOMContent(E){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=C.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(E),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(E){return this._container&&this._container.classList.add(E),this}removeClassName(E){return this._container&&this._container.classList.remove(E),this}setOffset(E){return this.options.offset=E,this._update(),this}toggleClassName(E){if(this._container)return this._container.classList.toggle(E)}setSubpixelPositioning(E){this.options.subpixelPositioning=E}_createCloseButton(){this.options.closeButton&&(this._closeButton=C.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const E=this._container.querySelector(St);E&&E.focus()}},a.RasterDEMTileSource=Dt,a.RasterTileSource=ot,a.ScaleControl=class{constructor(E){this._onMove=()=>{at(this._map,this._container,this.options)},this.setUnit=s=>{this.options.unit=s,at(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Ge),E)}getDefaultPosition(){return"bottom-left"}onAdd(E){return this._map=E,this._container=C.create("div","maplibregl-ctrl maplibregl-ctrl-scale",E.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){C.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},a.ScrollZoomHandler=Un,a.Style=il,a.TerrainControl=class{constructor(E){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=E}onAdd(E){return this._map=E,this._container=C.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=C.create("button","maplibregl-ctrl-terrain",this._container),C.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){C.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},a.TwoFingersTouchPitchHandler=ht,a.TwoFingersTouchRotateHandler=rt,a.TwoFingersTouchZoomHandler=Ee,a.TwoFingersTouchZoomRotateHandler=fr,a.VectorTileSource=Ce,a.VideoSource=ln,a.addSourceType=(E,s)=>o._(void 0,void 0,void 0,function*(){if(Kn(E))throw new Error(`A source type called "${E}" already exists.`);((c,g)=>{qn[c]=g})(E,s)}),a.clearPrewarmedResources=function(){const E=Ne;E&&(E.isPreloaded()&&E.numActive()===1?(E.release(pt),Ne=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},a.createTileMesh=Iu,a.getMaxParallelImageRequests=function(){return o.a.MAX_PARALLEL_IMAGE_REQUESTS},a.getRTLTextPluginStatus=function(){return zr().getRTLTextPluginStatus()},a.getVersion=function(){return sn},a.getWorkerCount=function(){return ge.workerCount},a.getWorkerUrl=function(){return o.a.WORKER_URL},a.importScriptInWorkers=function(E){return Mt().broadcast("IS",E)},a.prewarm=function(){it().acquire(pt)},a.setMaxParallelImageRequests=function(E){o.a.MAX_PARALLEL_IMAGE_REQUESTS=E},a.setRTLTextPlugin=function(E,s){return zr().setRTLTextPlugin(E,s)},a.setWorkerCount=function(E){ge.workerCount=E},a.setWorkerUrl=function(E){o.a.WORKER_URL=E}});var l=n;return l})})(P6);var ase=P6.exports;const Bv=Mg(ase),R3=function(e,t){const n={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},r={on(l,a,o){if(n[l]===void 0)throw new Error(`Invalid event type: ${l}`);n[l].push({selector:a,fn:o})},render(l){t.store.featureChanged(l)}},i=function(l,a){const o=n[l];let f=o.length;for(;f--;){const m=o[f];if(m.selector(a)){m.fn.call(r,a)||t.store.render(),t.ui.updateMapClasses();break}}};return e.start.call(r),{render:e.render,stop(){e.stop&&e.stop()},trash(){e.trash&&(e.trash(),t.store.render())},combineFeatures(){e.combineFeatures&&e.combineFeatures()},uncombineFeatures(){e.uncombineFeatures&&e.uncombineFeatures()},drag(l){i("drag",l)},click(l){i("click",l)},mousemove(l){i("mousemove",l)},mousedown(l){i("mousedown",l)},mouseup(l){i("mouseup",l)},mouseout(l){i("mouseout",l)},keydown(l){i("keydown",l)},keyup(l){i("keyup",l)},touchstart(l){i("touchstart",l)},touchmove(l){i("touchmove",l)},touchend(l){i("touchend",l)},tap(l){i("tap",l)}}};var aS={},J2={};J2.RADIUS=6378137;J2.FLATTENING=1/298.257223563;J2.POLAR_RADIUS=63567523142e-4;var hM=J2;aS.geometry=M6;aS.ring=B3;function M6(e){var t=0,n;switch(e.type){case"Polygon":return dM(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)t+=dM(e.coordinates[n]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)t+=M6(e.geometries[n]);return t}}function dM(e){var t=0;if(e&&e.length>0){t+=Math.abs(B3(e[0]));for(var n=1;n<e.length;n++)t-=Math.abs(B3(e[n]))}return t}function B3(e){var t,n,r,i,l,a,o,f=0,m=e.length;if(m>2){for(o=0;o<m;o++)o===m-2?(i=m-2,l=m-1,a=0):o===m-1?(i=m-1,l=0,a=1):(i=o,l=o+1,a=o+2),t=e[i],n=e[l],r=e[a],f+=(y4(r[0])-y4(t[0]))*Math.sin(y4(n[1]));f=f*hM.RADIUS*hM.RADIUS/2}return f}function y4(e){return e*Math.PI/180}const Fh={CANVAS:"mapboxgl-canvas",CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},Id={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},ml={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},Vh={POLYGON:"polygon",LINE:"line_string",POINT:"point"},Ii={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},Hs={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select"},Eh={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},W_={MOVE:"move",CHANGE_PROPERTIES:"change_properties",CHANGE_COORDINATES:"change_coordinates"},sh={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},xc={ACTIVE:"true",INACTIVE:"false"},T6=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],lse=-90,N3=-85,use=90,F3=85,cse=-270,hse=270,A6=Object.freeze(Object.defineProperty({__proto__:null,LAT_MAX:use,LAT_MIN:lse,LAT_RENDERED_MAX:F3,LAT_RENDERED_MIN:N3,LNG_MAX:hse,LNG_MIN:cse,activeStates:xc,classes:Fh,cursors:ml,events:Eh,geojsonTypes:Ii,interactions:T6,meta:sh,modes:Hs,sources:Id,types:Vh,updateActions:W_},Symbol.toStringTag,{value:"Module"})),fM={Point:0,LineString:1,MultiLineString:1,Polygon:2};function dse(e,t){const n=fM[e.geometry.type]-fM[t.geometry.type];return n===0&&e.geometry.type===Ii.POLYGON?e.area-t.area:n}function k6(e){return e.map(t=>(t.geometry.type===Ii.POLYGON&&(t.area=aS.geometry({type:Ii.FEATURE,property:{},geometry:t.geometry})),t)).sort(dse).map(t=>(delete t.area,t))}function I6(e,t=0){return[[e.point.x-t,e.point.y-t],[e.point.x+t,e.point.y+t]]}function Bd(e){if(this._items={},this._nums={},this._length=e?e.length:0,!!e)for(let t=0,n=e.length;t<n;t++)this.add(e[t]),e[t]!==void 0&&(typeof e[t]=="string"?this._items[e[t]]=t:this._nums[e[t]]=t)}Bd.prototype.add=function(e){return this.has(e)?this:(this._length++,typeof e=="string"?this._items[e]=this._length:this._nums[e]=this._length,this)};Bd.prototype.delete=function(e){return this.has(e)===!1?this:(this._length--,delete this._items[e],delete this._nums[e],this)};Bd.prototype.has=function(e){return typeof e!="string"&&typeof e!="number"?!1:this._items[e]!==void 0||this._nums[e]!==void 0};Bd.prototype.values=function(){const e=[];return Object.keys(this._items).forEach(t=>{e.push({k:t,v:this._items[t]})}),Object.keys(this._nums).forEach(t=>{e.push({k:JSON.parse(t),v:this._nums[t]})}),e.sort((t,n)=>t.v-n.v).map(t=>t.k)};Bd.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};const fse=[sh.FEATURE,sh.MIDPOINT,sh.VERTEX],X0={click:pse,touch:mse};function pse(e,t,n){return D6(e,t,n,n.options.clickBuffer)}function mse(e,t,n){return D6(e,t,n,n.options.touchBuffer)}function D6(e,t,n,r){if(n.map===null)return[];const i=e?I6(e,r):t,l={};n.options.styles&&(l.layers=n.options.styles.map(m=>m.id).filter(m=>n.map.getLayer(m)!=null));const a=n.map.queryRenderedFeatures(i,l).filter(m=>fse.indexOf(m.properties.meta)!==-1),o=new Bd,f=[];return a.forEach(m=>{const _=m.properties.id;o.has(_)||(o.add(_),f.push(m))}),k6(f)}function Cx(e,t){const n=X0.click(e,null,t),r={mouse:ml.NONE};return n[0]&&(r.mouse=n[0].properties.active===xc.ACTIVE?ml.MOVE:ml.POINTER,r.feature=n[0].properties.meta),t.events.currentModeName().indexOf("draw")!==-1&&(r.mouse=ml.ADD),t.ui.queueMapClasses(r),t.ui.updateMapClasses(),n[0]}function lS(e,t){const n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}const gse=4,yse=12,vse=500;function z3(e,t,n={}){const r=n.fineTolerance!=null?n.fineTolerance:gse,i=n.grossTolerance!=null?n.grossTolerance:yse,l=n.interval!=null?n.interval:vse;e.point=e.point||t.point,e.time=e.time||t.time;const a=lS(e.point,t.point);return a<r||a<i&&t.time-e.time<l}const _se=25,bse=250;function j3(e,t,n={}){const r=n.tolerance!=null?n.tolerance:_se,i=n.interval!=null?n.interval:bse;return e.point=e.point||t.point,e.time=e.time||t.time,lS(e.point,t.point)<r&&t.time-e.time<i}let xse=(e,t=21)=>(n=t)=>{let r="",i=n|0;for(;i--;)r+=e[Math.random()*e.length|0];return r};const wse=xse("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",32);function uS(){return wse()}const Mh=function(e,t){this.ctx=e,this.properties=t.properties||{},this.coordinates=t.geometry.coordinates,this.id=t.id||uS(),this.type=t.geometry.type};Mh.prototype.changed=function(){this.ctx.store.featureChanged(this.id)};Mh.prototype.incomingCoords=function(e){this.setCoordinates(e)};Mh.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()};Mh.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))};Mh.prototype.setProperty=function(e,t){this.properties[e]=t};Mh.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:Ii.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))};Mh.prototype.internal=function(e){const t={id:this.id,meta:sh.FEATURE,"meta:type":this.type,active:xc.INACTIVE,mode:e};if(this.ctx.options.userProperties)for(const n in this.properties)t[`user_${n}`]=this.properties[n];return{type:Ii.FEATURE,properties:t,geometry:{coordinates:this.getCoordinates(),type:this.type}}};const Sm=function(e,t){Mh.call(this,e,t)};Sm.prototype=Object.create(Mh.prototype);Sm.prototype.isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"};Sm.prototype.updateCoordinate=function(e,t,n){arguments.length===3?this.coordinates=[t,n]:this.coordinates=[e,t],this.changed()};Sm.prototype.getCoordinate=function(){return this.getCoordinates()};const Gf=function(e,t){Mh.call(this,e,t)};Gf.prototype=Object.create(Mh.prototype);Gf.prototype.isValid=function(){return this.coordinates.length>1};Gf.prototype.addCoordinate=function(e,t,n){this.changed();const r=parseInt(e,10);this.coordinates.splice(r,0,[t,n])};Gf.prototype.getCoordinate=function(e){const t=parseInt(e,10);return JSON.parse(JSON.stringify(this.coordinates[t]))};Gf.prototype.removeCoordinate=function(e){this.changed(),this.coordinates.splice(parseInt(e,10),1)};Gf.prototype.updateCoordinate=function(e,t,n){const r=parseInt(e,10);this.coordinates[r]=[t,n],this.changed()};const xd=function(e,t){Mh.call(this,e,t),this.coordinates=this.coordinates.map(n=>n.slice(0,-1))};xd.prototype=Object.create(Mh.prototype);xd.prototype.isValid=function(){return this.coordinates.length===0?!1:this.coordinates.every(e=>e.length>2)};xd.prototype.incomingCoords=function(e){this.coordinates=e.map(t=>t.slice(0,-1)),this.changed()};xd.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()};xd.prototype.addCoordinate=function(e,t,n){this.changed();const r=e.split(".").map(l=>parseInt(l,10));this.coordinates[r[0]].splice(r[1],0,[t,n])};xd.prototype.removeCoordinate=function(e){this.changed();const t=e.split(".").map(r=>parseInt(r,10)),n=this.coordinates[t[0]];n&&(n.splice(t[1],1),n.length<3&&this.coordinates.splice(t[0],1))};xd.prototype.getCoordinate=function(e){const t=e.split(".").map(r=>parseInt(r,10)),n=this.coordinates[t[0]];return JSON.parse(JSON.stringify(n[t[1]]))};xd.prototype.getCoordinates=function(){return this.coordinates.map(e=>e.concat([e[0]]))};xd.prototype.updateCoordinate=function(e,t,n){this.changed();const r=e.split("."),i=parseInt(r[0],10),l=parseInt(r[1],10);this.coordinates[i]===void 0&&(this.coordinates[i]=[]),this.coordinates[i][l]=[t,n]};const Cse={MultiPoint:Sm,MultiLineString:Gf,MultiPolygon:xd},Q2=(e,t,n,r,i)=>{const l=n.split("."),a=parseInt(l[0],10),o=l[1]?l.slice(1).join("."):null;return e[a][t](o,r,i)},Ph=function(e,t){if(Mh.call(this,e,t),delete this.coordinates,this.model=Cse[t.geometry.type],this.model===void 0)throw new TypeError(`${t.geometry.type} is not a valid type`);this.features=this._coordinatesToFeatures(t.geometry.coordinates)};Ph.prototype=Object.create(Mh.prototype);Ph.prototype._coordinatesToFeatures=function(e){const t=this.model.bind(this);return e.map(n=>new t(this.ctx,{id:uS(),type:Ii.FEATURE,properties:{},geometry:{coordinates:n,type:this.type.replace("Multi","")}}))};Ph.prototype.isValid=function(){return this.features.every(e=>e.isValid())};Ph.prototype.setCoordinates=function(e){this.features=this._coordinatesToFeatures(e),this.changed()};Ph.prototype.getCoordinate=function(e){return Q2(this.features,"getCoordinate",e)};Ph.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(e=>e.type===Ii.POLYGON?e.getCoordinates():e.coordinates)))};Ph.prototype.updateCoordinate=function(e,t,n){Q2(this.features,"updateCoordinate",e,t,n),this.changed()};Ph.prototype.addCoordinate=function(e,t,n){Q2(this.features,"addCoordinate",e,t,n),this.changed()};Ph.prototype.removeCoordinate=function(e){Q2(this.features,"removeCoordinate",e),this.changed()};Ph.prototype.getFeatures=function(){return this.features};function Ds(e){this.map=e.map,this.drawConfig=JSON.parse(JSON.stringify(e.options||{})),this._ctx=e}Ds.prototype.setSelected=function(e){return this._ctx.store.setSelected(e)};Ds.prototype.setSelectedCoordinates=function(e){this._ctx.store.setSelectedCoordinates(e),e.reduce((t,n)=>(t[n.feature_id]===void 0&&(t[n.feature_id]=!0,this._ctx.store.get(n.feature_id).changed()),t),{})};Ds.prototype.getSelected=function(){return this._ctx.store.getSelected()};Ds.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()};Ds.prototype.isSelected=function(e){return this._ctx.store.isSelected(e)};Ds.prototype.getFeature=function(e){return this._ctx.store.get(e)};Ds.prototype.select=function(e){return this._ctx.store.select(e)};Ds.prototype.deselect=function(e){return this._ctx.store.deselect(e)};Ds.prototype.deleteFeature=function(e,t={}){return this._ctx.store.delete(e,t)};Ds.prototype.addFeature=function(e,t={}){return this._ctx.store.add(e,t)};Ds.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()};Ds.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()};Ds.prototype.setActionableState=function(e={}){const t={trash:e.trash||!1,combineFeatures:e.combineFeatures||!1,uncombineFeatures:e.uncombineFeatures||!1};return this._ctx.events.actionable(t)};Ds.prototype.changeMode=function(e,t={},n={}){return this._ctx.events.changeMode(e,t,n)};Ds.prototype.fire=function(e,t){return this._ctx.events.fire(e,t)};Ds.prototype.updateUIClasses=function(e){return this._ctx.ui.queueMapClasses(e)};Ds.prototype.activateUIButton=function(e){return this._ctx.ui.setActiveButton(e)};Ds.prototype.featuresAt=function(e,t,n="click"){if(n!=="click"&&n!=="touch")throw new Error("invalid buffer type");return X0[n](e,t,this._ctx)};Ds.prototype.newFeature=function(e){const t=e.geometry.type;return t===Ii.POINT?new Sm(this._ctx,e):t===Ii.LINE_STRING?new Gf(this._ctx,e):t===Ii.POLYGON?new xd(this._ctx,e):new Ph(this._ctx,e)};Ds.prototype.isInstanceOf=function(e,t){if(e===Ii.POINT)return t instanceof Sm;if(e===Ii.LINE_STRING)return t instanceof Gf;if(e===Ii.POLYGON)return t instanceof xd;if(e==="MultiFeature")return t instanceof Ph;throw new Error(`Unknown feature class: ${e}`)};Ds.prototype.doRender=function(e){return this._ctx.store.featureChanged(e)};Ds.prototype.onSetup=function(){};Ds.prototype.onDrag=function(){};Ds.prototype.onClick=function(){};Ds.prototype.onMouseMove=function(){};Ds.prototype.onMouseDown=function(){};Ds.prototype.onMouseUp=function(){};Ds.prototype.onMouseOut=function(){};Ds.prototype.onKeyUp=function(){};Ds.prototype.onKeyDown=function(){};Ds.prototype.onTouchStart=function(){};Ds.prototype.onTouchMove=function(){};Ds.prototype.onTouchEnd=function(){};Ds.prototype.onTap=function(){};Ds.prototype.onStop=function(){};Ds.prototype.onTrash=function(){};Ds.prototype.onCombineFeature=function(){};Ds.prototype.onUncombineFeature=function(){};Ds.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};const O6={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},Sse=Object.keys(O6);function Lse(e){const t=Object.keys(e);return function(n,r={}){let i={};const l=t.reduce((o,f)=>(o[f]=e[f],o),new Ds(n));function a(o){return f=>l[o](i,f)}return{start(){i=l.onSetup(r),Sse.forEach(o=>{const f=O6[o];let m=()=>!1;e[f]&&(m=()=>!0),this.on(o,m,a(f))})},stop(){l.onStop(i)},trash(){l.onTrash(i)},combineFeatures(){l.onCombineFeatures(i)},uncombineFeatures(){l.onUncombineFeatures(i)},render(o,f){l.toDisplayFeatures(i,o,f)}}}}function Pse(e){const t=Object.keys(e.options.modes).reduce((M,C)=>(M[C]=Lse(e.options.modes[C]),M),{});let n={},r={};const i={};let l=null,a=null;i.drag=function(M,C){C({point:M.point,time:new Date().getTime()})?(e.ui.queueMapClasses({mouse:ml.DRAG}),a.drag(M)):M.originalEvent.stopPropagation()},i.mousedrag=function(M){i.drag(M,C=>!z3(n,C))},i.touchdrag=function(M){i.drag(M,C=>!j3(r,C))},i.mousemove=function(M){if((M.originalEvent.buttons!==void 0?M.originalEvent.buttons:M.originalEvent.which)===1)return i.mousedrag(M);const R=Cx(M,e);M.featureTarget=R,a.mousemove(M)},i.mousedown=function(M){n={time:new Date().getTime(),point:M.point};const C=Cx(M,e);M.featureTarget=C,a.mousedown(M)},i.mouseup=function(M){const C=Cx(M,e);M.featureTarget=C,z3(n,{point:M.point,time:new Date().getTime()})?a.click(M):a.mouseup(M)},i.mouseout=function(M){a.mouseout(M)},i.touchstart=function(M){if(!e.options.touchEnabled)return;r={time:new Date().getTime(),point:M.point};const C=X0.touch(M,null,e)[0];M.featureTarget=C,a.touchstart(M)},i.touchmove=function(M){if(e.options.touchEnabled)return a.touchmove(M),i.touchdrag(M)},i.touchend=function(M){if(M.originalEvent.preventDefault(),!e.options.touchEnabled)return;const C=X0.touch(M,null,e)[0];M.featureTarget=C,j3(r,{time:new Date().getTime(),point:M.point})?a.tap(M):a.touchend(M)};const o=M=>!(M===8||M===46||M>=48&&M<=57);i.keydown=function(M){(M.srcElement||M.target).classList.contains(Fh.CANVAS)&&((M.keyCode===8||M.keyCode===46)&&e.options.controls.trash?(M.preventDefault(),a.trash()):o(M.keyCode)?a.keydown(M):M.keyCode===49&&e.options.controls.point?f(Hs.DRAW_POINT):M.keyCode===50&&e.options.controls.line_string?f(Hs.DRAW_LINE_STRING):M.keyCode===51&&e.options.controls.polygon&&f(Hs.DRAW_POLYGON))},i.keyup=function(M){o(M.keyCode)&&a.keyup(M)},i.zoomend=function(){e.store.changeZoom()},i.data=function(M){if(M.dataType==="style"){const{setup:C,map:R,options:z,store:W}=e;z.styles.some(Y=>R.getLayer(Y.id))||(C.addLayers(),W.setDirty(),W.render())}};function f(M,C,R={}){a.stop();const z=t[M];if(z===void 0)throw new Error(`${M} is not valid`);l=M;const W=z(e,C);a=R3(W,e),R.silent||e.map.fire(Eh.MODE_CHANGE,{mode:M}),e.store.setDirty(),e.store.render()}const m={trash:!1,combineFeatures:!1,uncombineFeatures:!1};function _(M){let C=!1;Object.keys(M).forEach(R=>{if(m[R]===void 0)throw new Error("Invalid action type");m[R]!==M[R]&&(C=!0),m[R]=M[R]}),C&&e.map.fire(Eh.ACTIONABLE,{actions:m})}return{start(){l=e.options.defaultMode,a=R3(t[l](e),e)},changeMode:f,actionable:_,currentModeName(){return l},currentModeRender(M,C){return a.render(M,C)},fire(M,C){e.map&&e.map.fire(M,C)},addEventListeners(){e.map.on("mousemove",i.mousemove),e.map.on("mousedown",i.mousedown),e.map.on("mouseup",i.mouseup),e.map.on("data",i.data),e.map.on("touchmove",i.touchmove),e.map.on("touchstart",i.touchstart),e.map.on("touchend",i.touchend),e.container.addEventListener("mouseout",i.mouseout),e.options.keybindings&&(e.container.addEventListener("keydown",i.keydown),e.container.addEventListener("keyup",i.keyup))},removeEventListeners(){e.map.off("mousemove",i.mousemove),e.map.off("mousedown",i.mousedown),e.map.off("mouseup",i.mouseup),e.map.off("data",i.data),e.map.off("touchmove",i.touchmove),e.map.off("touchstart",i.touchstart),e.map.off("touchend",i.touchend),e.container.removeEventListener("mouseout",i.mouseout),e.options.keybindings&&(e.container.removeEventListener("keydown",i.keydown),e.container.removeEventListener("keyup",i.keyup))},trash(M){a.trash(M)},combineFeatures(){a.combineFeatures()},uncombineFeatures(){a.uncombineFeatures()},getMode(){return l}}}function Z_(e){return[].concat(e).filter(t=>t!==void 0)}function Ese(){const e=this;if(!(e.ctx.map&&e.ctx.map.getSource(Id.HOT)!==void 0))return f();const n=e.ctx.events.currentModeName();e.ctx.ui.queueMapClasses({mode:n});let r=[],i=[];e.isDirty?i=e.getAllIds():(r=e.getChangedIds().filter(m=>e.get(m)!==void 0),i=e.sources.hot.filter(m=>m.properties.id&&r.indexOf(m.properties.id)===-1&&e.get(m.properties.id)!==void 0).map(m=>m.properties.id)),e.sources.hot=[];const l=e.sources.cold.length;e.sources.cold=e.isDirty?[]:e.sources.cold.filter(m=>{const _=m.properties.id||m.properties.parent;return r.indexOf(_)===-1});const a=l!==e.sources.cold.length||i.length>0;r.forEach(m=>o(m,"hot")),i.forEach(m=>o(m,"cold"));function o(m,_){const M=e.get(m).internal(n);e.ctx.events.currentModeRender(M,C=>{C.properties.mode=n,e.sources[_].push(C)})}a&&e.ctx.map.getSource(Id.COLD).setData({type:Ii.FEATURE_COLLECTION,features:e.sources.cold}),e.ctx.map.getSource(Id.HOT).setData({type:Ii.FEATURE_COLLECTION,features:e.sources.hot}),f();function f(){e.isDirty=!1,e.clearChangedIds()}}function za(e){this._features={},this._featureIds=new Bd,this._selectedFeatureIds=new Bd,this._selectedCoordinates=[],this._changedFeatureIds=new Bd,this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=e,this.sources={hot:[],cold:[]};let t;this.render=()=>{t||(t=requestAnimationFrame(()=>{t=null,Ese.call(this),this._emitSelectionChange&&(this.ctx.events.fire(Eh.SELECTION_CHANGE,{features:this.getSelected().map(n=>n.toGeoJSON()),points:this.getSelectedCoordinates().map(n=>({type:Ii.FEATURE,properties:{},geometry:{type:Ii.POINT,coordinates:n.coordinates}}))}),this._emitSelectionChange=!1),this.ctx.events.fire(Eh.RENDER,{})}))},this.isDirty=!1}za.prototype.createRenderBatch=function(){const e=this.render;let t=0;return this.render=function(){t++},()=>{this.render=e,t>0&&this.render()}};za.prototype.setDirty=function(){return this.isDirty=!0,this};za.prototype.featureCreated=function(e,t={}){if(this._changedFeatureIds.add(e),(t.silent!=null?t.silent:this.ctx.options.suppressAPIEvents)!==!0){const r=this.get(e);this.ctx.events.fire(Eh.CREATE,{features:[r.toGeoJSON()]})}return this};za.prototype.featureChanged=function(e,t={}){return this._changedFeatureIds.add(e),(t.silent!=null?t.silent:this.ctx.options.suppressAPIEvents)!==!0&&this.ctx.events.fire(Eh.UPDATE,{action:t.action?t.action:W_.CHANGE_COORDINATES,features:[this.get(e).toGeoJSON()]}),this};za.prototype.getChangedIds=function(){return this._changedFeatureIds.values()};za.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this};za.prototype.getAllIds=function(){return this._featureIds.values()};za.prototype.add=function(e,t={}){return this._features[e.id]=e,this._featureIds.add(e.id),this.featureCreated(e.id,{silent:t.silent}),this};za.prototype.delete=function(e,t={}){const n=[];return Z_(e).forEach(r=>{this._featureIds.has(r)&&(this._featureIds.delete(r),this._selectedFeatureIds.delete(r),t.silent||n.indexOf(this._features[r])===-1&&n.push(this._features[r].toGeoJSON()),delete this._features[r],this.isDirty=!0)}),n.length&&this.ctx.events.fire(Eh.DELETE,{features:n}),R6(this,t),this};za.prototype.get=function(e){return this._features[e]};za.prototype.getAll=function(){return Object.keys(this._features).map(e=>this._features[e])};za.prototype.select=function(e,t={}){return Z_(e).forEach(n=>{this._selectedFeatureIds.has(n)||(this._selectedFeatureIds.add(n),this._changedFeatureIds.add(n),t.silent||(this._emitSelectionChange=!0))}),this};za.prototype.deselect=function(e,t={}){return Z_(e).forEach(n=>{this._selectedFeatureIds.has(n)&&(this._selectedFeatureIds.delete(n),this._changedFeatureIds.add(n),t.silent||(this._emitSelectionChange=!0))}),R6(this,t),this};za.prototype.clearSelected=function(e={}){return this.deselect(this._selectedFeatureIds.values(),{silent:e.silent}),this};za.prototype.setSelected=function(e,t={}){return e=Z_(e),this.deselect(this._selectedFeatureIds.values().filter(n=>e.indexOf(n)===-1),{silent:t.silent}),this.select(e.filter(n=>!this._selectedFeatureIds.has(n)),{silent:t.silent}),this};za.prototype.setSelectedCoordinates=function(e){return this._selectedCoordinates=e,this._emitSelectionChange=!0,this};za.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this};za.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()};za.prototype.getSelected=function(){return this.getSelectedIds().map(e=>this.get(e))};za.prototype.getSelectedCoordinates=function(){return this._selectedCoordinates.map(t=>({coordinates:this.get(t.feature_id).getCoordinate(t.coord_path)}))};za.prototype.isSelected=function(e){return this._selectedFeatureIds.has(e)};za.prototype.setFeatureProperty=function(e,t,n,r={}){this.get(e).setProperty(t,n),this.featureChanged(e,{silent:r.silent,action:W_.CHANGE_PROPERTIES})};function R6(e,t={}){const n=e._selectedCoordinates.filter(r=>e._selectedFeatureIds.has(r.feature_id));e._selectedCoordinates.length!==n.length&&!t.silent&&(e._emitSelectionChange=!0),e._selectedCoordinates=n}za.prototype.storeMapConfig=function(){T6.forEach(e=>{this.ctx.map[e]&&(this._mapInitialConfig[e]=this.ctx.map[e].isEnabled())})};za.prototype.restoreMapConfig=function(){Object.keys(this._mapInitialConfig).forEach(e=>{this._mapInitialConfig[e]?this.ctx.map[e].enable():this.ctx.map[e].disable()})};za.prototype.getInitialConfigValue=function(e){return this._mapInitialConfig[e]!==void 0?this._mapInitialConfig[e]:!0};const Mse=["mode","feature","mouse"];function Tse(e){const t={};let n=null,r={mode:null,feature:null,mouse:null},i={mode:null,feature:null,mouse:null};function l(){a({mode:null,feature:null,mouse:null}),o()}function a(C){i=Object.assign(i,C)}function o(){if(!e.container)return;const C=[],R=[];Mse.forEach(z=>{i[z]!==r[z]&&(C.push(`${z}-${r[z]}`),i[z]!==null&&R.push(`${z}-${i[z]}`))}),C.length>0&&e.container.classList.remove(...C),R.length>0&&e.container.classList.add(...R),r=Object.assign(r,i)}function f(C,R={}){const z=document.createElement("button");return z.className=`${Fh.CONTROL_BUTTON} ${R.className}`,z.setAttribute("title",R.title),R.container.appendChild(z),z.addEventListener("click",W=>{if(W.preventDefault(),W.stopPropagation(),W.target===n){m(),R.onDeactivate();return}_(C),R.onActivate()},!0),z}function m(){n&&(n.classList.remove(Fh.ACTIVE_BUTTON),n=null)}function _(C){m();const R=t[C];R&&R&&C!=="trash"&&(R.classList.add(Fh.ACTIVE_BUTTON),n=R)}function w(){const C=e.options.controls,R=document.createElement("div");return R.className=`${Fh.CONTROL_GROUP} ${Fh.CONTROL_BASE}`,C&&(C[Vh.LINE]&&(t[Vh.LINE]=f(Vh.LINE,{container:R,className:Fh.CONTROL_BUTTON_LINE,title:`LineString tool ${e.options.keybindings?"(l)":""}`,onActivate:()=>e.events.changeMode(Hs.DRAW_LINE_STRING),onDeactivate:()=>e.events.trash()})),C[Vh.POLYGON]&&(t[Vh.POLYGON]=f(Vh.POLYGON,{container:R,className:Fh.CONTROL_BUTTON_POLYGON,title:`Polygon tool ${e.options.keybindings?"(p)":""}`,onActivate:()=>e.events.changeMode(Hs.DRAW_POLYGON),onDeactivate:()=>e.events.trash()})),C[Vh.POINT]&&(t[Vh.POINT]=f(Vh.POINT,{container:R,className:Fh.CONTROL_BUTTON_POINT,title:`Marker tool ${e.options.keybindings?"(m)":""}`,onActivate:()=>e.events.changeMode(Hs.DRAW_POINT),onDeactivate:()=>e.events.trash()})),C.trash&&(t.trash=f("trash",{container:R,className:Fh.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:()=>{e.events.trash()}})),C.combine_features&&(t.combine_features=f("combineFeatures",{container:R,className:Fh.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:()=>{e.events.combineFeatures()}})),C.uncombine_features&&(t.uncombine_features=f("uncombineFeatures",{container:R,className:Fh.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:()=>{e.events.uncombineFeatures()}}))),R}function M(){Object.keys(t).forEach(C=>{const R=t[C];R.parentNode&&R.parentNode.removeChild(R),delete t[C]})}return{setActiveButton:_,queueMapClasses:a,updateMapClasses:o,clearMapClasses:l,addButtons:w,removeButtons:M}}function Ase(e){let t=null,n=null;const r={onRemove(){return e.map.off("load",r.connect),clearInterval(n),r.removeLayers(),e.store.restoreMapConfig(),e.ui.removeButtons(),e.events.removeEventListeners(),e.ui.clearMapClasses(),e.boxZoomInitial&&e.map.boxZoom.enable(),e.map=null,e.container=null,e.store=null,t&&t.parentNode&&t.parentNode.removeChild(t),t=null,this},connect(){e.map.off("load",r.connect),clearInterval(n),r.addLayers(),e.store.storeMapConfig(),e.events.addEventListeners()},onAdd(i){if(e.map=i,e.events=Pse(e),e.ui=Tse(e),e.container=i.getContainer(),e.store=new za(e),t=e.ui.addButtons(),e.options.boxSelect){e.boxZoomInitial=i.boxZoom.isEnabled(),i.boxZoom.disable();const l=i.dragPan.isEnabled();i.dragPan.disable(),i.dragPan.enable(),l||i.dragPan.disable()}return i.loaded()?r.connect():(i.on("load",r.connect),n=setInterval(()=>{i.loaded()&&r.connect()},16)),e.events.start(),t},addLayers(){e.map.addSource(Id.COLD,{data:{type:Ii.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.map.addSource(Id.HOT,{data:{type:Ii.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.options.styles.forEach(i=>{e.map.addLayer(i)}),e.store.setDirty(!0),e.store.render()},removeLayers(){e.options.styles.forEach(i=>{e.map.getLayer(i.id)&&e.map.removeLayer(i.id)}),e.map.getSource(Id.COLD)&&e.map.removeSource(Id.COLD),e.map.getSource(Id.HOT)&&e.map.removeSource(Id.HOT)}};return e.setup=r,r}const v4="#3bb2d0",xv="#fbb03b",pM="#fff",B6=[{id:"gl-draw-polygon-fill",type:"fill",filter:["all",["==","$type","Polygon"]],paint:{"fill-color":["case",["==",["get","active"],"true"],xv,v4],"fill-opacity":.1}},{id:"gl-draw-lines",type:"line",filter:["any",["==","$type","LineString"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":["case",["==",["get","active"],"true"],xv,v4],"line-dasharray":["case",["==",["get","active"],"true"],[.2,2],[2,0]],"line-width":2}},{id:"gl-draw-point-outer",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],7,5],"circle-color":pM}},{id:"gl-draw-point-inner",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],5,3],"circle-color":["case",["==",["get","active"],"true"],xv,v4]}},{id:"gl-draw-vertex-outer",type:"circle",filter:["all",["==","$type","Point"],["==","meta","vertex"],["!=","mode","simple_select"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],7,5],"circle-color":pM}},{id:"gl-draw-vertex-inner",type:"circle",filter:["all",["==","$type","Point"],["==","meta","vertex"],["!=","mode","simple_select"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],5,3],"circle-color":xv}},{id:"gl-draw-midpoint",type:"circle",filter:["all",["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":xv}}];function ew(e){return function(t){const n=t.featureTarget;return!n||!n.properties?!1:n.properties.meta===e}}function N6(e){return!e.originalEvent||!e.originalEvent.shiftKey?!1:e.originalEvent.button===0}function Dg(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.active===xc.ACTIVE&&e.featureTarget.properties.meta===sh.FEATURE}function cS(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.active===xc.INACTIVE&&e.featureTarget.properties.meta===sh.FEATURE}function tw(e){return e.featureTarget===void 0}function hS(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.meta===sh.FEATURE}function K_(e){const t=e.featureTarget;return!t||!t.properties?!1:t.properties.meta===sh.VERTEX}function u2(e){return e.originalEvent?e.originalEvent.shiftKey===!0:!1}function nw(e){return e.keyCode===27}function rw(e){return e.keyCode===13}function kse(){return!0}const Ise=Object.freeze(Object.defineProperty({__proto__:null,isActiveFeature:Dg,isEnterKey:rw,isEscapeKey:nw,isFeature:hS,isInactiveFeature:cS,isOfMetaType:ew,isShiftDown:u2,isShiftMousedown:N6,isTrue:kse,isVertex:K_,noTarget:tw},Symbol.toStringTag,{value:"Module"}));function um(e,t){this.x=e,this.y=t}um.prototype={clone(){return new um(this.x,this.y)},add(e){return this.clone()._add(e)},sub(e){return this.clone()._sub(e)},multByPoint(e){return this.clone()._multByPoint(e)},divByPoint(e){return this.clone()._divByPoint(e)},mult(e){return this.clone()._mult(e)},div(e){return this.clone()._div(e)},rotate(e){return this.clone()._rotate(e)},rotateAround(e,t){return this.clone()._rotateAround(e,t)},matMult(e){return this.clone()._matMult(e)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(e){return this.x===e.x&&this.y===e.y},dist(e){return Math.sqrt(this.distSqr(e))},distSqr(e){const t=e.x-this.x,n=e.y-this.y;return t*t+n*n},angle(){return Math.atan2(this.y,this.x)},angleTo(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith(e){return this.angleWithSep(e.x,e.y)},angleWithSep(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult(e){const t=e[0]*this.x+e[1]*this.y,n=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=n,this},_add(e){return this.x+=e.x,this.y+=e.y,this},_sub(e){return this.x-=e.x,this.y-=e.y,this},_mult(e){return this.x*=e,this.y*=e,this},_div(e){return this.x/=e,this.y/=e,this},_multByPoint(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint(e){return this.x/=e.x,this.y/=e.y,this},_unit(){return this._div(this.mag()),this},_perp(){const e=this.y;return this.y=this.x,this.x=-e,this},_rotate(e){const t=Math.cos(e),n=Math.sin(e),r=t*this.x-n*this.y,i=n*this.x+t*this.y;return this.x=r,this.y=i,this},_rotateAround(e,t){const n=Math.cos(e),r=Math.sin(e),i=t.x+n*(this.x-t.x)-r*(this.y-t.y),l=t.y+r*(this.x-t.x)+n*(this.y-t.y);return this.x=i,this.y=l,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:um};um.convert=function(e){if(e instanceof um)return e;if(Array.isArray(e))return new um(+e[0],+e[1]);if(e.x!==void 0&&e.y!==void 0)return new um(+e.x,+e.y);throw new Error("Expected [x, y] or {x, y} point format")};function dS(e,t){const n=t.getBoundingClientRect();return new um(e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0))}function J0(e,t,n,r){return{type:Ii.FEATURE,properties:{meta:sh.VERTEX,parent:e,coord_path:n,active:r?xc.ACTIVE:xc.INACTIVE},geometry:{type:Ii.POINT,coordinates:t}}}function F6(e,t,n){const r=t.geometry.coordinates,i=n.geometry.coordinates;if(r[1]>F3||r[1]<N3||i[1]>F3||i[1]<N3)return null;const l={lng:(r[0]+i[0])/2,lat:(r[1]+i[1])/2};return{type:Ii.FEATURE,properties:{meta:sh.MIDPOINT,parent:e,lng:l.lng,lat:l.lat,coord_path:n.properties.coord_path},geometry:{type:Ii.POINT,coordinates:[l.lng,l.lat]}}}function iw(e,t={},n=null){const{type:r,coordinates:i}=e.geometry,l=e.properties&&e.properties.id;let a=[];r===Ii.POINT?a.push(J0(l,i,n,f(n))):r===Ii.POLYGON?i.forEach((_,w)=>{o(_,n!==null?`${n}.${w}`:String(w))}):r===Ii.LINE_STRING?o(i,n):r.indexOf(Ii.MULTI_PREFIX)===0&&m();function o(_,w){let M="",C=null;_.forEach((R,z)=>{const W=w!=null?`${w}.${z}`:String(z),X=J0(l,R,W,f(W));if(t.midpoints&&C){const Q=F6(l,C,X);Q&&a.push(Q)}C=X;const Y=JSON.stringify(R);M!==Y&&a.push(X),z===0&&(M=Y)})}function f(_){return t.selectedPaths?t.selectedPaths.indexOf(_)!==-1:!1}function m(){const _=r.replace(Ii.MULTI_PREFIX,"");i.forEach((w,M)=>{const C={type:Ii.FEATURE,properties:e.properties,geometry:{type:_,coordinates:w}};a=a.concat(iw(C,t,M))})}return a}const lf={enable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||!e._ctx||!e._ctx.store||!e._ctx.store.getInitialConfigValue||e._ctx.store.getInitialConfigValue("doubleClickZoom")&&e.map.doubleClickZoom.enable()},0)},disable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||e.map.doubleClickZoom.disable()},0)}},{LAT_MIN:qb,LAT_MAX:Wb,LAT_RENDERED_MIN:mM,LAT_RENDERED_MAX:gM,LNG_MIN:yM,LNG_MAX:vM}=A6;function Dse(e){const t={Point:0,LineString:1,Polygon:2,MultiPoint:1,MultiLineString:2,MultiPolygon:3}[e.geometry.type],n=[e.geometry.coordinates].flat(t),r=n.map(o=>o[0]),i=n.map(o=>o[1]),l=o=>Math.min.apply(null,o),a=o=>Math.max.apply(null,o);return[l(r),l(i),a(r),a(i)]}function fS(e,t){let n=qb,r=Wb,i=qb,l=Wb,a=vM,o=yM;e.forEach(m=>{const _=Dse(m),w=_[1],M=_[3],C=_[0],R=_[2];w>n&&(n=w),M<r&&(r=M),M>i&&(i=M),w<l&&(l=w),C<a&&(a=C),R>o&&(o=R)});const f=t;return n+f.lat>gM&&(f.lat=gM-n),i+f.lat>Wb&&(f.lat=Wb-i),r+f.lat<mM&&(f.lat=mM-r),l+f.lat<qb&&(f.lat=qb-l),a+f.lng<=yM&&(f.lng+=Math.ceil(Math.abs(f.lng)/360)*360),o+f.lng>=vM&&(f.lng-=Math.ceil(Math.abs(f.lng)/360)*360),f}function pS(e,t){const n=fS(e.map(r=>r.toGeoJSON()),t);e.forEach(r=>{const i=r.getCoordinates(),l=m=>{const _={lng:m[0]+n.lng,lat:m[1]+n.lat};return[_.lng,_.lat]},a=m=>m.map(_=>l(_)),o=m=>m.map(_=>a(_));let f;r.type===Ii.POINT?f=l(i):r.type===Ii.LINE_STRING||r.type===Ii.MULTI_POINT?f=i.map(l):r.type===Ii.POLYGON||r.type===Ii.MULTI_LINE_STRING?f=i.map(a):r.type===Ii.MULTI_POLYGON&&(f=i.map(o)),r.incomingCoords(f)})}const Ca={};Ca.onSetup=function(e){const t={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initialDragPanState:this.map.dragPan.isEnabled(),initiallySelectedFeatureIds:e.featureIds||[]};return this.setSelected(t.initiallySelectedFeatureIds.filter(n=>this.getFeature(n)!==void 0)),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),t};Ca.fireUpdate=function(){this.fire(Eh.UPDATE,{action:W_.MOVE,features:this.getSelected().map(e=>e.toGeoJSON())})};Ca.fireActionable=function(){const e=this.getSelected(),t=e.filter(l=>this.isInstanceOf("MultiFeature",l));let n=!1;if(e.length>1){n=!0;const l=e[0].type.replace("Multi","");e.forEach(a=>{a.type.replace("Multi","")!==l&&(n=!1)})}const r=t.length>0,i=e.length>0;this.setActionableState({combineFeatures:n,uncombineFeatures:r,trash:i})};Ca.getUniqueIds=function(e){return e.length?e.map(n=>n.properties.id).filter(n=>n!==void 0).reduce((n,r)=>(n.add(r),n),new Bd).values():[]};Ca.stopExtendedInteractions=function(e){e.boxSelectElement&&(e.boxSelectElement.parentNode&&e.boxSelectElement.parentNode.removeChild(e.boxSelectElement),e.boxSelectElement=null),(e.canDragMove||e.canBoxSelect)&&e.initialDragPanState===!0&&this.map.dragPan.enable(),e.boxSelecting=!1,e.canBoxSelect=!1,e.dragMoving=!1,e.canDragMove=!1};Ca.onStop=function(){lf.enable(this)};Ca.onMouseMove=function(e,t){return hS(t)&&e.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(e),!0};Ca.onMouseOut=function(e){return e.dragMoving?this.fireUpdate():!0};Ca.onTap=Ca.onClick=function(e,t){if(tw(t))return this.clickAnywhere(e,t);if(ew(sh.VERTEX)(t))return this.clickOnVertex(e,t);if(hS(t))return this.clickOnFeature(e,t)};Ca.clickAnywhere=function(e){const t=this.getSelectedIds();t.length&&(this.clearSelectedFeatures(),t.forEach(n=>this.doRender(n))),lf.enable(this),this.stopExtendedInteractions(e)};Ca.clickOnVertex=function(e,t){this.changeMode(Hs.DIRECT_SELECT,{featureId:t.featureTarget.properties.parent,coordPath:t.featureTarget.properties.coord_path,startPos:t.lngLat}),this.updateUIClasses({mouse:ml.MOVE})};Ca.startOnActiveFeature=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),this.doRender(t.featureTarget.properties.id),e.canDragMove=!0,e.dragMoveLocation=t.lngLat};Ca.clickOnFeature=function(e,t){lf.disable(this),this.stopExtendedInteractions(e);const n=u2(t),r=this.getSelectedIds(),i=t.featureTarget.properties.id,l=this.isSelected(i);if(!n&&l&&this.getFeature(i).type!==Ii.POINT)return this.changeMode(Hs.DIRECT_SELECT,{featureId:i});l&&n?(this.deselect(i),this.updateUIClasses({mouse:ml.POINTER}),r.length===1&&lf.enable(this)):!l&&n?(this.select(i),this.updateUIClasses({mouse:ml.MOVE})):!l&&!n&&(r.forEach(a=>this.doRender(a)),this.setSelected(i),this.updateUIClasses({mouse:ml.MOVE})),this.doRender(i)};Ca.onMouseDown=function(e,t){if(e.initialDragPanState=this.map.dragPan.isEnabled(),Dg(t))return this.startOnActiveFeature(e,t);if(this.drawConfig.boxSelect&&N6(t))return this.startBoxSelect(e,t)};Ca.startBoxSelect=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),e.boxSelectStartLocation=dS(t.originalEvent,this.map.getContainer()),e.canBoxSelect=!0};Ca.onTouchStart=function(e,t){if(Dg(t))return this.startOnActiveFeature(e,t)};Ca.onDrag=function(e,t){if(e.canDragMove)return this.dragMove(e,t);if(this.drawConfig.boxSelect&&e.canBoxSelect)return this.whileBoxSelect(e,t)};Ca.whileBoxSelect=function(e,t){e.boxSelecting=!0,this.updateUIClasses({mouse:ml.ADD}),e.boxSelectElement||(e.boxSelectElement=document.createElement("div"),e.boxSelectElement.classList.add(Fh.BOX_SELECT),this.map.getContainer().appendChild(e.boxSelectElement));const n=dS(t.originalEvent,this.map.getContainer()),r=Math.min(e.boxSelectStartLocation.x,n.x),i=Math.max(e.boxSelectStartLocation.x,n.x),l=Math.min(e.boxSelectStartLocation.y,n.y),a=Math.max(e.boxSelectStartLocation.y,n.y),o=`translate(${r}px, ${l}px)`;e.boxSelectElement.style.transform=o,e.boxSelectElement.style.WebkitTransform=o,e.boxSelectElement.style.width=`${i-r}px`,e.boxSelectElement.style.height=`${a-l}px`};Ca.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();const n={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};pS(this.getSelected(),n),e.dragMoveLocation=t.lngLat};Ca.onTouchEnd=Ca.onMouseUp=function(e,t){if(e.dragMoving)this.fireUpdate();else if(e.boxSelecting){const n=[e.boxSelectStartLocation,dS(t.originalEvent,this.map.getContainer())],r=this.featuresAt(null,n,"click"),i=this.getUniqueIds(r).filter(l=>!this.isSelected(l));i.length&&(this.select(i),i.forEach(l=>this.doRender(l)),this.updateUIClasses({mouse:ml.MOVE}))}this.stopExtendedInteractions(e)};Ca.toDisplayFeatures=function(e,t,n){t.properties.active=this.isSelected(t.properties.id)?xc.ACTIVE:xc.INACTIVE,n(t),this.fireActionable(),!(t.properties.active!==xc.ACTIVE||t.geometry.type===Ii.POINT)&&iw(t).forEach(n)};Ca.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()};Ca.onCombineFeatures=function(){const e=this.getSelected();if(e.length===0||e.length<2)return;const t=[],n=[],r=e[0].type.replace("Multi","");for(let i=0;i<e.length;i++){const l=e[i];if(l.type.replace("Multi","")!==r)return;l.type.includes("Multi")?l.getCoordinates().forEach(a=>{t.push(a)}):t.push(l.getCoordinates()),n.push(l.toGeoJSON())}if(n.length>1){const i=this.newFeature({type:Ii.FEATURE,properties:n[0].properties,geometry:{type:`Multi${r}`,coordinates:t}});this.addFeature(i),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([i.id]),this.fire(Eh.COMBINE_FEATURES,{createdFeatures:[i.toGeoJSON()],deletedFeatures:n})}this.fireActionable()};Ca.onUncombineFeatures=function(){const e=this.getSelected();if(e.length===0)return;const t=[],n=[];for(let r=0;r<e.length;r++){const i=e[r];this.isInstanceOf("MultiFeature",i)&&(i.getFeatures().forEach(l=>{this.addFeature(l),l.properties=i.properties,t.push(l.toGeoJSON()),this.select([l.id])}),this.deleteFeature(i.id,{silent:!0}),n.push(i.toGeoJSON()))}t.length>1&&this.fire(Eh.UNCOMBINE_FEATURES,{createdFeatures:t,deletedFeatures:n}),this.fireActionable()};const z6=ew(sh.VERTEX),j6=ew(sh.MIDPOINT),Sa={};Sa.fireUpdate=function(){this.fire(Eh.UPDATE,{action:W_.CHANGE_COORDINATES,features:this.getSelected().map(e=>e.toGeoJSON())})};Sa.fireActionable=function(e){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:e.selectedCoordPaths.length>0})};Sa.startDragging=function(e,t){e.initialDragPanState=this.map.dragPan.isEnabled(),this.map.dragPan.disable(),e.canDragMove=!0,e.dragMoveLocation=t.lngLat};Sa.stopDragging=function(e){e.canDragMove&&e.initialDragPanState===!0&&this.map.dragPan.enable(),e.dragMoving=!1,e.canDragMove=!1,e.dragMoveLocation=null};Sa.onVertex=function(e,t){this.startDragging(e,t);const n=t.featureTarget.properties,r=e.selectedCoordPaths.indexOf(n.coord_path);!u2(t)&&r===-1?e.selectedCoordPaths=[n.coord_path]:u2(t)&&r===-1&&e.selectedCoordPaths.push(n.coord_path);const i=this.pathsToCoordinates(e.featureId,e.selectedCoordPaths);this.setSelectedCoordinates(i)};Sa.onMidpoint=function(e,t){this.startDragging(e,t);const n=t.featureTarget.properties;e.feature.addCoordinate(n.coord_path,n.lng,n.lat),this.fireUpdate(),e.selectedCoordPaths=[n.coord_path]};Sa.pathsToCoordinates=function(e,t){return t.map(n=>({feature_id:e,coord_path:n}))};Sa.onFeature=function(e,t){e.selectedCoordPaths.length===0?this.startDragging(e,t):this.stopDragging(e)};Sa.dragFeature=function(e,t,n){pS(this.getSelected(),n),e.dragMoveLocation=t.lngLat};Sa.dragVertex=function(e,t,n){const r=e.selectedCoordPaths.map(a=>e.feature.getCoordinate(a)),i=r.map(a=>({type:Ii.FEATURE,properties:{},geometry:{type:Ii.POINT,coordinates:a}})),l=fS(i,n);for(let a=0;a<r.length;a++){const o=r[a];e.feature.updateCoordinate(e.selectedCoordPaths[a],o[0]+l.lng,o[1]+l.lat)}};Sa.clickNoTarget=function(){this.changeMode(Hs.SIMPLE_SELECT)};Sa.clickInactive=function(){this.changeMode(Hs.SIMPLE_SELECT)};Sa.clickActiveFeature=function(e){e.selectedCoordPaths=[],this.clearSelectedCoordinates(),e.feature.changed()};Sa.onSetup=function(e){const t=e.featureId,n=this.getFeature(t);if(!n)throw new Error("You must provide a featureId to enter direct_select mode");if(n.type===Ii.POINT)throw new TypeError("direct_select mode doesn't handle point features");const r={featureId:t,feature:n,dragMoveLocation:e.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:e.coordPath?[e.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(t,r.selectedCoordPaths)),this.setSelected(t),lf.disable(this),this.setActionableState({trash:!0}),r};Sa.onStop=function(){lf.enable(this),this.clearSelectedCoordinates()};Sa.toDisplayFeatures=function(e,t,n){e.featureId===t.properties.id?(t.properties.active=xc.ACTIVE,n(t),iw(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths}).forEach(n)):(t.properties.active=xc.INACTIVE,n(t)),this.fireActionable(e)};Sa.onTrash=function(e){e.selectedCoordPaths.sort((t,n)=>n.localeCompare(t,"en",{numeric:!0})).forEach(t=>e.feature.removeCoordinate(t)),this.fireUpdate(),e.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(e),e.feature.isValid()===!1&&(this.deleteFeature([e.featureId]),this.changeMode(Hs.SIMPLE_SELECT,{}))};Sa.onMouseMove=function(e,t){const n=Dg(t),r=z6(t),i=j6(t),l=e.selectedCoordPaths.length===0;return n&&l?this.updateUIClasses({mouse:ml.MOVE}):r&&!l?this.updateUIClasses({mouse:ml.MOVE}):this.updateUIClasses({mouse:ml.NONE}),(r||n||i)&&e.dragMoving&&this.fireUpdate(),this.stopDragging(e),!0};Sa.onMouseOut=function(e){return e.dragMoving&&this.fireUpdate(),!0};Sa.onTouchStart=Sa.onMouseDown=function(e,t){if(z6(t))return this.onVertex(e,t);if(Dg(t))return this.onFeature(e,t);if(j6(t))return this.onMidpoint(e,t)};Sa.onDrag=function(e,t){if(e.canDragMove!==!0)return;e.dragMoving=!0,t.originalEvent.stopPropagation();const n={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};e.selectedCoordPaths.length>0?this.dragVertex(e,t,n):this.dragFeature(e,t,n),e.dragMoveLocation=t.lngLat};Sa.onClick=function(e,t){if(tw(t))return this.clickNoTarget(e,t);if(Dg(t))return this.clickActiveFeature(e,t);if(cS(t))return this.clickInactive(e,t);this.stopDragging(e)};Sa.onTap=function(e,t){if(tw(t))return this.clickNoTarget(e,t);if(Dg(t))return this.clickActiveFeature(e,t);if(cS(t))return this.clickInactive(e,t)};Sa.onTouchEnd=Sa.onMouseUp=function(e){e.dragMoving&&this.fireUpdate(),this.stopDragging(e)};const Uf={};Uf.onSetup=function(){const e=this.newFeature({type:Ii.FEATURE,properties:{},geometry:{type:Ii.POINT,coordinates:[]}});return this.addFeature(e),this.clearSelectedFeatures(),this.updateUIClasses({mouse:ml.ADD}),this.activateUIButton(Vh.POINT),this.setActionableState({trash:!0}),{point:e}};Uf.stopDrawingAndRemove=function(e){this.deleteFeature([e.point.id],{silent:!0}),this.changeMode(Hs.SIMPLE_SELECT)};Uf.onTap=Uf.onClick=function(e,t){this.updateUIClasses({mouse:ml.MOVE}),e.point.updateCoordinate("",t.lngLat.lng,t.lngLat.lat),this.fire(Eh.CREATE,{features:[e.point.toGeoJSON()]}),this.changeMode(Hs.SIMPLE_SELECT,{featureIds:[e.point.id]})};Uf.onStop=function(e){this.activateUIButton(),e.point.getCoordinate().length||this.deleteFeature([e.point.id],{silent:!0})};Uf.toDisplayFeatures=function(e,t,n){const r=t.properties.id===e.point.id;if(t.properties.active=r?xc.ACTIVE:xc.INACTIVE,!r)return n(t)};Uf.onTrash=Uf.stopDrawingAndRemove;Uf.onKeyUp=function(e,t){if(nw(t)||rw(t))return this.stopDrawingAndRemove(e,t)};function c2(e,t){return e.lngLat?e.lngLat.lng===t[0]&&e.lngLat.lat===t[1]:!1}const uf={};uf.onSetup=function(){const e=this.newFeature({type:Ii.FEATURE,properties:{},geometry:{type:Ii.POLYGON,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),lf.disable(this),this.updateUIClasses({mouse:ml.ADD}),this.activateUIButton(Vh.POLYGON),this.setActionableState({trash:!0}),{polygon:e,currentVertexPosition:0}};uf.clickAnywhere=function(e,t){if(e.currentVertexPosition>0&&c2(t,e.polygon.coordinates[0][e.currentVertexPosition-1]))return this.changeMode(Hs.SIMPLE_SELECT,{featureIds:[e.polygon.id]});this.updateUIClasses({mouse:ml.ADD}),e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),e.currentVertexPosition++,e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat)};uf.clickOnVertex=function(e){return this.changeMode(Hs.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};uf.onMouseMove=function(e,t){e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),K_(t)&&this.updateUIClasses({mouse:ml.POINTER})};uf.onTap=uf.onClick=function(e,t){return K_(t)?this.clickOnVertex(e,t):this.clickAnywhere(e,t)};uf.onKeyUp=function(e,t){nw(t)?(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(Hs.SIMPLE_SELECT)):rw(t)&&this.changeMode(Hs.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};uf.onStop=function(e){this.updateUIClasses({mouse:ml.NONE}),lf.enable(this),this.activateUIButton(),this.getFeature(e.polygon.id)!==void 0&&(e.polygon.removeCoordinate(`0.${e.currentVertexPosition}`),e.polygon.isValid()?this.fire(Eh.CREATE,{features:[e.polygon.toGeoJSON()]}):(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(Hs.SIMPLE_SELECT,{},{silent:!0})))};uf.toDisplayFeatures=function(e,t,n){const r=t.properties.id===e.polygon.id;if(t.properties.active=r?xc.ACTIVE:xc.INACTIVE,!r)return n(t);if(t.geometry.coordinates.length===0)return;const i=t.geometry.coordinates[0].length;if(!(i<3)){if(t.properties.meta=sh.FEATURE,n(J0(e.polygon.id,t.geometry.coordinates[0][0],"0.0",!1)),i>3){const l=t.geometry.coordinates[0].length-3;n(J0(e.polygon.id,t.geometry.coordinates[0][l],`0.${l}`,!1))}if(i<=4){const l=[[t.geometry.coordinates[0][0][0],t.geometry.coordinates[0][0][1]],[t.geometry.coordinates[0][1][0],t.geometry.coordinates[0][1][1]]];if(n({type:Ii.FEATURE,properties:t.properties,geometry:{coordinates:l,type:Ii.LINE_STRING}}),i===3)return}return n(t)}};uf.onTrash=function(e){this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(Hs.SIMPLE_SELECT)};const cf={};cf.onSetup=function(e){e=e||{};const t=e.featureId;let n,r,i="forward";if(t){if(n=this.getFeature(t),!n)throw new Error("Could not find a feature with the provided featureId");let l=e.from;if(l&&l.type==="Feature"&&l.geometry&&l.geometry.type==="Point"&&(l=l.geometry),l&&l.type==="Point"&&l.coordinates&&l.coordinates.length===2&&(l=l.coordinates),!l||!Array.isArray(l))throw new Error("Please use the `from` property to indicate which point to continue the line from");const a=n.coordinates.length-1;if(n.coordinates[a][0]===l[0]&&n.coordinates[a][1]===l[1])r=a+1,n.addCoordinate(r,...n.coordinates[a]);else if(n.coordinates[0][0]===l[0]&&n.coordinates[0][1]===l[1])i="backwards",r=0,n.addCoordinate(r,...n.coordinates[0]);else throw new Error("`from` should match the point at either the start or the end of the provided LineString")}else n=this.newFeature({type:Ii.FEATURE,properties:{},geometry:{type:Ii.LINE_STRING,coordinates:[]}}),r=0,this.addFeature(n);return this.clearSelectedFeatures(),lf.disable(this),this.updateUIClasses({mouse:ml.ADD}),this.activateUIButton(Vh.LINE),this.setActionableState({trash:!0}),{line:n,currentVertexPosition:r,direction:i}};cf.clickAnywhere=function(e,t){if(e.currentVertexPosition>0&&c2(t,e.line.coordinates[e.currentVertexPosition-1])||e.direction==="backwards"&&c2(t,e.line.coordinates[e.currentVertexPosition+1]))return this.changeMode(Hs.SIMPLE_SELECT,{featureIds:[e.line.id]});this.updateUIClasses({mouse:ml.ADD}),e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),e.direction==="forward"?(e.currentVertexPosition++,e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat)):e.line.addCoordinate(0,t.lngLat.lng,t.lngLat.lat)};cf.clickOnVertex=function(e){return this.changeMode(Hs.SIMPLE_SELECT,{featureIds:[e.line.id]})};cf.onMouseMove=function(e,t){e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),K_(t)&&this.updateUIClasses({mouse:ml.POINTER})};cf.onTap=cf.onClick=function(e,t){if(K_(t))return this.clickOnVertex(e,t);this.clickAnywhere(e,t)};cf.onKeyUp=function(e,t){rw(t)?this.changeMode(Hs.SIMPLE_SELECT,{featureIds:[e.line.id]}):nw(t)&&(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(Hs.SIMPLE_SELECT))};cf.onStop=function(e){lf.enable(this),this.activateUIButton(),this.getFeature(e.line.id)!==void 0&&(e.line.removeCoordinate(`${e.currentVertexPosition}`),e.line.isValid()?this.fire(Eh.CREATE,{features:[e.line.toGeoJSON()]}):(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(Hs.SIMPLE_SELECT,{},{silent:!0})))};cf.onTrash=function(e){this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(Hs.SIMPLE_SELECT)};cf.toDisplayFeatures=function(e,t,n){const r=t.properties.id===e.line.id;if(t.properties.active=r?xc.ACTIVE:xc.INACTIVE,!r)return n(t);t.geometry.coordinates.length<2||(t.properties.meta=sh.FEATURE,n(J0(e.line.id,t.geometry.coordinates[e.direction==="forward"?t.geometry.coordinates.length-2:1],`${e.direction==="forward"?t.geometry.coordinates.length-2:1}`,!1)),n(t))};const U6={simple_select:Ca,direct_select:Sa,draw_point:Uf,draw_polygon:uf,draw_line_string:cf},Ose={defaultMode:Hs.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:B6,modes:U6,controls:{},userProperties:!1,suppressAPIEvents:!0},Rse={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},Bse={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function _M(e,t){return e.map(n=>n.source?n:Object.assign({},n,{id:`${n.id}.${t}`,source:t==="hot"?Id.HOT:Id.COLD}))}function Nse(e={}){let t=Object.assign({},e);return e.controls||(t.controls={}),e.displayControlsDefault===!1?t.controls=Object.assign({},Bse,e.controls):t.controls=Object.assign({},Rse,e.controls),t=Object.assign({},Ose,t),t.styles=_M(t.styles,"cold").concat(_M(t.styles,"hot")),t}var Fse=jse,zse={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"};function jse(e){if(!e||!e.type)return null;var t=zse[e.type];if(!t)return null;if(t==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:e}]};if(t==="feature")return{type:"FeatureCollection",features:[e]};if(t==="featurecollection")return e}const Use=Mg(Fse);function V6(e,t){return e.length!==t.length?!1:JSON.stringify(e.map(n=>n).sort())===JSON.stringify(t.map(n=>n).sort())}const Vse={Polygon:xd,LineString:Gf,Point:Sm,MultiPolygon:Ph,MultiLineString:Ph,MultiPoint:Ph};function $se(e,t){t.modes=Hs;const n=e.options.suppressAPIEvents!==void 0?!!e.options.suppressAPIEvents:!0;return t.getFeatureIdsAt=function(r){return X0.click({point:r},null,e).map(l=>l.properties.id)},t.getSelectedIds=function(){return e.store.getSelectedIds()},t.getSelected=function(){return{type:Ii.FEATURE_COLLECTION,features:e.store.getSelectedIds().map(r=>e.store.get(r)).map(r=>r.toGeoJSON())}},t.getSelectedPoints=function(){return{type:Ii.FEATURE_COLLECTION,features:e.store.getSelectedCoordinates().map(r=>({type:Ii.FEATURE,properties:{},geometry:{type:Ii.POINT,coordinates:r.coordinates}}))}},t.set=function(r){if(r.type===void 0||r.type!==Ii.FEATURE_COLLECTION||!Array.isArray(r.features))throw new Error("Invalid FeatureCollection");const i=e.store.createRenderBatch();let l=e.store.getAllIds().slice();const a=t.add(r),o=new Bd(a);return l=l.filter(f=>!o.has(f)),l.length&&t.delete(l),i(),a},t.add=function(r){const l=JSON.parse(JSON.stringify(Use(r))).features.map(a=>{if(a.id=a.id||uS(),a.geometry===null)throw new Error("Invalid geometry: null");if(e.store.get(a.id)===void 0||e.store.get(a.id).type!==a.geometry.type){const o=Vse[a.geometry.type];if(o===void 0)throw new Error(`Invalid geometry type: ${a.geometry.type}.`);const f=new o(e,a);e.store.add(f,{silent:n})}else{const o=e.store.get(a.id),f=o.properties;o.properties=a.properties,XL(f,a.properties)||e.store.featureChanged(o.id,{silent:n}),XL(o.getCoordinates(),a.geometry.coordinates)||o.incomingCoords(a.geometry.coordinates)}return a.id});return e.store.render(),l},t.get=function(r){const i=e.store.get(r);if(i)return i.toGeoJSON()},t.getAll=function(){return{type:Ii.FEATURE_COLLECTION,features:e.store.getAll().map(r=>r.toGeoJSON())}},t.delete=function(r){return e.store.delete(r,{silent:n}),t.getMode()===Hs.DIRECT_SELECT&&!e.store.getSelectedIds().length?e.events.changeMode(Hs.SIMPLE_SELECT,void 0,{silent:n}):e.store.render(),t},t.deleteAll=function(){return e.store.delete(e.store.getAllIds(),{silent:n}),t.getMode()===Hs.DIRECT_SELECT?e.events.changeMode(Hs.SIMPLE_SELECT,void 0,{silent:n}):e.store.render(),t},t.changeMode=function(r,i={}){return r===Hs.SIMPLE_SELECT&&t.getMode()===Hs.SIMPLE_SELECT?(V6(i.featureIds||[],e.store.getSelectedIds())||(e.store.setSelected(i.featureIds,{silent:n}),e.store.render()),t):(r===Hs.DIRECT_SELECT&&t.getMode()===Hs.DIRECT_SELECT&&i.featureId===e.store.getSelectedIds()[0]||e.events.changeMode(r,i,{silent:n}),t)},t.getMode=function(){return e.events.getMode()},t.trash=function(){return e.events.trash({silent:n}),t},t.combineFeatures=function(){return e.events.combineFeatures({silent:n}),t},t.uncombineFeatures=function(){return e.events.uncombineFeatures({silent:n}),t},t.setFeatureProperty=function(r,i,l){return e.store.setFeatureProperty(r,i,l,{silent:n}),t},t}const Gse=Object.freeze(Object.defineProperty({__proto__:null,CommonSelectors:Ise,ModeHandler:R3,StringSet:Bd,constrainFeatureMovement:fS,createMidPoint:F6,createSupplementaryPoints:iw,createVertex:J0,doubleClickZoom:lf,euclideanDistance:lS,featuresAt:X0,getFeatureAtAndSetCursors:Cx,isClick:z3,isEventAtCoordinates:c2,isTap:j3,mapEventToBoundingBox:I6,moveFeatures:pS,sortFeatures:k6,stringSetsAreEqual:V6,theme:B6,toDenseArray:Z_},Symbol.toStringTag,{value:"Module"})),Hse=function(e,t){e=Nse(e);const n={options:e};t=$se(n,t),n.api=t;const r=Ase(n);return t.onAdd=r.onAdd,t.onRemove=r.onRemove,t.types=Vh,t.options=e,t};function sw(e){Hse(e,this)}sw.modes=U6;sw.constants=A6;sw.lib=Gse;const Zb={};async function qse(e,t){const n=new URL(e.url.replace("google://","https://")),r=`${n.hostname}?${n.searchParams}`,i=n.searchParams.get("key");if(!i)throw console.error("Clé API Google Maps manquante dans l'URL"),new Error("Clé API Google Maps manquante");let l=Zb[r];if(l){if(l instanceof Promise)try{await l}catch(o){throw console.error("Échec lors de l'attente de la session:",o),o}}else{l=new Promise(async(o,f)=>{try{const m=n.hostname,_={mapType:"satellite",language:"fr-FR",region:"FR",scale:"scaleFactor2x",highDpi:!0,layerTypes:["layerRoadmap"]},w=n.searchParams.get("layerType");w&&(_.layerTypes=[w]);const M=n.searchParams.get("overlay");M&&(_.overlay=M==="true"),console.log("Requête de session Google Maps:",JSON.stringify(_,null,2));const C=await fetch(`https://tile.googleapis.com/v1/createSession?key=${i}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_)});if(!C.ok){const z=await C.json().catch(()=>null),W=z?JSON.stringify(z,null,2):await C.text();console.error("Erreur lors de la création de session Google Maps:",W),f(new Error(`Échec de la création de session: ${C.status} ${C.statusText}`));return}const R=await C.json();if(!R.session){console.error("Réponse de session invalide:",R),f(new Error("Session invalide retournée par l'API Google Maps"));return}Zb[r]=R.session,o(R.session)}catch(m){console.error("Erreur lors de la création de session:",m),f(m)}}),Zb[r]=l;try{await l}catch(o){throw console.error("Échec de la création de session Google Maps:",o),o}}const a=Zb[r];try{const o=`https://tile.googleapis.com/v1/2dtiles${n.pathname}?session=${a}&key=${i}`,f=await fetch(o);if(!f.ok)throw new Error(`Échec de récupération de tuile: ${f.status} ${f.statusText}`);return{data:await f.arrayBuffer()}}catch(o){throw console.error("Erreur lors de la récupération de la tuile:",o),o}}function Wse(e,t,n){const r=t==="hybrid"?"satellite":t,i=t==="hybrid"?"&layerType=layerRoadmap":"";return{version:8,sources:{[e]:{type:"raster",tiles:[`google://${r}/{z}/{x}/{y}?key=${n}${i}`],tileSize:256,attribution:"&copy; Google Maps",maxzoom:19}},layers:[{id:e,type:"raster",source:e}]}}class Zse{constructor(){un(this,"_googleApiKey",null);un(this,"_googleProtocolRegistered",!1)}async getGoogleMapsApiKey(){if(this._googleApiKey)return this._googleApiKey;try{const t=await Ux.getGoogleMapsApiKey();if(t.data&&t.data.key_status==="configured"){const n=new URL(t.data.url);return this._googleApiKey=n.searchParams.get("key"),this._googleApiKey}}catch(t){console.error("Erreur lors de la récupération de la clé Google Maps:",t)}return null}registerGoogleProtocol(){if(!this._googleProtocolRegistered)try{Bv.addProtocol("google",qse),this._googleProtocolRegistered=!0}catch(t){console.error("Erreur lors de l'enregistrement du protocole Google Maps:",t)}}async createGoogleMapStyle(t="google",n="hybrid",r=!1){const i=await this.getGoogleMapsApiKey();if(!i)throw new Error("Clé API Google Maps non configurée");this.registerGoogleProtocol();const l=Wse(t,n,i);return r&&n==="roadmap"&&(l.sources["cadastre-overlay"]=this.standardTileSources.cadastre,l.layers.push({id:"cadastre-overlay",type:"raster",source:"cadastre-overlay",minzoom:0,maxZoom:17})),l}get standardTileSources(){return{ign:{type:"raster",tiles:["https://data.geopf.fr/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2&STYLE=normal&FORMAT=image/png&TILEMATRIXSET=PM&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}"],tileSize:256,attribution:"Carte IGN © IGN/Geoportail",maxZoom:17},cadastre:{type:"raster",tiles:["https://data.geopf.fr/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=CADASTRALPARCELS.PARCELLAIRE_EXPRESS&STYLE=normal&FORMAT=image/png&TILEMATRIXSET=PM&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}"],tileSize:256,attribution:"Cadastre - Carte © IGN/Geoportail",maxZoom:17}}}getTransformRequest(){return(t,n)=>({url:t})}createStandardMapStyle(t){return{version:8,sources:{"base-tiles":this.standardTileSources[t]},layers:[{id:"base-tiles",type:"raster",source:"base-tiles",minzoom:0,maxZoom:17}]}}}const op=new Zse,Kse={class:"maplibre-test-container"},Yse={class:"controls"},Xse={class:"layer-control"},Jse={class:"layer-options"},Qse={key:0,class:"draw-control"},eoe={class:"draw-options"},toe=["disabled"],noe={key:0,class:"feature-info"},roe={class:"info-panel"},ioe=Ja({__name:"MapLibreTest",setup(e){const t=Rn(null),n=Rn(null),r=Rn(null),i=Rn(null),l=Rn(null),a=Rn("hybrid"),o=Rn(null),f=async()=>{if(!t.value)return;let Y;try{a.value==="hybrid"?Y=await op.createGoogleMapStyle("google","hybrid",!1):a.value==="cadastre"?Y=await op.createGoogleMapStyle("google","roadmap",!0):Y=op.createStandardMapStyle("ign")}catch(Q){console.error("Erreur lors de la création du style de carte:",Q),Y=op.createStandardMapStyle("ign")}t.value&&(n.value=new Bv.Map({container:t.value,style:Y,center:[2.35,48.85],zoom:10,maxZoom:17,transformRequest:op.getTransformRequest()}),r.value=new sw({displayControlsDefault:!1,controls:{point:!0,line_string:!0,polygon:!0,trash:!0},styles:[{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"],["==","active","true"]],paint:{"circle-radius":12,"circle-color":"#2b6451","circle-stroke-width":3,"circle-stroke-color":"#FFFFFF"}},{id:"gl-draw-point",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"],["==","active","false"]],paint:{"circle-radius":10,"circle-color":"#3388ff","circle-stroke-width":2,"circle-stroke-color":"#FFFFFF"}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#2b6451","line-width":4}},{id:"gl-draw-line",type:"line",filter:["all",["==","$type","LineString"],["==","active","false"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3388ff","line-width":3}},{id:"gl-draw-polygon-active",type:"fill",filter:["all",["==","$type","Polygon"],["==","active","true"]],paint:{"fill-color":"#2b6451","fill-opacity":.4}},{id:"gl-draw-polygon",type:"fill",filter:["all",["==","$type","Polygon"],["==","active","false"]],paint:{"fill-color":"#3388ff","fill-opacity":.2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","$type","Polygon"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#2b6451","line-width":4}},{id:"gl-draw-polygon-stroke",type:"line",filter:["all",["==","$type","Polygon"],["==","active","false"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3388ff","line-width":3}},{id:"gl-draw-point-vertex",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"]],paint:{"circle-radius":10,"circle-color":"#FFFFFF","circle-stroke-width":3,"circle-stroke-color":"#D20C0C"}},{id:"gl-draw-point-mid-point",type:"circle",filter:["all",["==","meta","midpoint"],["==","$type","Point"]],paint:{"circle-radius":8,"circle-color":"#FFFFFF","circle-stroke-width":2,"circle-stroke-color":"#D20C0C"}}]}),n.value.addControl(new Bv.NavigationControl),n.value.addControl(new Bv.ScaleControl),n.value.addControl(new Bv.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0})),n.value.addControl(r.value),n.value.on("style.load",()=>{var oe;(((oe=n.value)==null?void 0:oe.getStyle().layers.filter(le=>le.id.indexOf("gl-draw")===0))||[]).forEach(le=>{var me,we;(me=n.value)!=null&&me.getLayer(le.id)&&((we=n.value)==null||we.moveLayer(le.id))})}),n.value.on("zoom",()=>{n.value&&(l.value=n.value.getZoom())}),n.value.on("draw.create",m),n.value.on("draw.update",_),n.value.on("draw.selectionchange",w),n.value.on("draw.delete",M),window.addEventListener("resize",R))},m=Y=>{console.log("Feature created:",Y.features)},_=Y=>{console.log("Feature updated:",Y.features)},w=Y=>{o.value=Y.features.length>0?Y.features[0]:null,console.log("Selection changed:",Y.features)},M=Y=>{console.log("Feature deleted:",Y.features)},C=async()=>{if(!n.value)return;let Y;try{a.value==="hybrid"?Y=await op.createGoogleMapStyle("google","hybrid",!1):a.value==="cadastre"?Y=await op.createGoogleMapStyle("google","roadmap",!0):Y=op.createStandardMapStyle("ign")}catch(Q){console.error("Erreur lors de la création du style de carte:",Q),Y=op.createStandardMapStyle("ign")}n.value.setStyle(Y)},R=()=>{n.value&&n.value.resize()},z=Y=>{if(r.value)switch(i.value=Y,Y){case"point":r.value.changeMode("draw_point");break;case"line":r.value.changeMode("draw_line_string");break;case"polygon":r.value.changeMode("draw_polygon");break}},W=()=>{r.value&&(i.value=null,r.value.changeMode("simple_select"))},X=()=>{if(!r.value||!o.value)return;const Y=o.value.id;r.value.delete(Y),o.value=null};return Rl(()=>{f()}),gd(()=>{n.value&&(n.value.off("draw.create",m),n.value.off("draw.update",_),n.value.off("draw.selectionchange",w),n.value.off("draw.delete",M),n.value.remove()),window.removeEventListener("resize",R)}),(Y,Q)=>(yt(),Et("div",Kse,[V("div",{class:"map-container",ref_key:"mapContainer",ref:t},null,512),V("div",Yse,[V("div",Xse,[Q[9]||(Q[9]=V("h3",null,"Fonds de carte",-1)),V("div",Jse,[V("label",null,[li(V("input",{type:"radio",name:"baseMap",value:"hybrid","onUpdate:modelValue":Q[0]||(Q[0]=oe=>a.value=oe),onChange:C},null,544),[[O0,a.value]]),Q[6]||(Q[6]=rs(" Hybride "))]),V("label",null,[li(V("input",{type:"radio",name:"baseMap",value:"cadastre","onUpdate:modelValue":Q[1]||(Q[1]=oe=>a.value=oe),onChange:C},null,544),[[O0,a.value]]),Q[7]||(Q[7]=rs(" Cadastre "))]),V("label",null,[li(V("input",{type:"radio",name:"baseMap",value:"ign","onUpdate:modelValue":Q[2]||(Q[2]=oe=>a.value=oe),onChange:C},null,544),[[O0,a.value]]),Q[8]||(Q[8]=rs(" IGN "))])])]),n.value?(yt(),Et("div",Qse,[Q[12]||(Q[12]=V("h3",null,"Outils de dessin",-1)),V("div",eoe,[V("button",{onClick:Q[3]||(Q[3]=oe=>z("point")),class:$s({active:i.value==="point"})}," Point ",2),V("button",{onClick:Q[4]||(Q[4]=oe=>z("line")),class:$s({active:i.value==="line"})}," Ligne ",2),V("button",{onClick:Q[5]||(Q[5]=oe=>z("polygon")),class:$s({active:i.value==="polygon"})}," Polygone ",2),V("button",{onClick:W,class:$s({active:i.value===null})}," Sélection ",2),V("button",{onClick:X,disabled:!o.value,class:"delete-button"}," Supprimer ",8,toe)]),o.value?(yt(),Et("div",noe,[V("p",null,[Q[10]||(Q[10]=V("strong",null,"Forme sélectionnée:",-1)),rs(" "+er(o.value.geometry.type),1)]),Q[11]||(Q[11]=V("p",{class:"hint"},"Essayez de déplacer les points de contrôle",-1))])):yr("",!0)])):yr("",!0),V("div",roe,[Q[13]||(Q[13]=V("h3",null,"Test sur mobile",-1)),Q[14]||(Q[14]=V("p",null," Ce composant démontre les capacités tactiles de MapLibre GL JS pour l'édition de formes géométriques sur mobile. ",-1)),V("p",null,[V("small",null,"Zoom: "+er(l.value?l.value.toFixed(2):"-"),1)])])])]))}}),$6=NF({history:pF("/"),routes:[{path:"/",name:"home",component:SP,meta:{requiresAuth:!0,allowedRoles:["admin","entreprise","salarie","visiteur"],isMapRoute:!0}},{path:"/meteo",name:"meteo",component:Wie,meta:{requiresAuth:!0,allowedRoles:["admin","entreprise","salarie","visiteur"]}},{path:"/users",name:"users",component:eZ,meta:{requiresAuth:!0,allowedRoles:["admin","entreprise","salarie"]}},{path:"/profile",name:"profile",component:()=>Dd(()=>import("./ProfileView.js"),[]),meta:{requiresAuth:!0,allowedRoles:["admin","entreprise","salarie","visiteur"]}},{path:"/login",name:"login",component:j9,meta:{requiresGuest:!0}},{path:"/forgot-password",name:"forgot-password",component:()=>Dd(()=>import("./ForgotPasswordView.js"),[]),meta:{requiresGuest:!0}},{path:"/reset-password/:token",name:"reset-password",component:()=>Dd(()=>import("./ResetPasswordView.js"),[]),meta:{requiresGuest:!0}},{path:"/change-password",name:"changePassword",component:l9,meta:{requiresAuth:!0,allowedRoles:["admin","entreprise","salarie","visiteur"]}},{path:"/notes",name:"notes",component:EK,meta:{requiresAuth:!0,allowedRoles:["admin","entreprise","salarie","visiteur"]}},{path:"/map",name:"map",component:SP,meta:{requiresAuth:!0,isMapRoute:!0}},{path:"/parametres",name:"parametres",component:ose,meta:{requiresAuth:!0,allowedRoles:["admin"]}},{path:"/maplibre-test",name:"maplibre-test",component:ioe,meta:{requiresAuth:!0,allowedRoles:["admin"]}},{path:"/:pathMatch(.*)*",name:"not-found",component:()=>Dd(()=>import("./NotFoundView.js"),[])}]});$6.beforeEach(async(e,t,n)=>{var o,f;const r=Mu();if(!r.initialized)try{await r.initialize(window.INITIAL_STATE)}catch(m){console.error("Error initializing auth store:",m)}const i=r.isAuthenticated,l=(o=r.user)==null?void 0:o.must_change_password,a=(f=r.user)==null?void 0:f.user_type;if(e.meta.requiresAuth&&!i){n("/login");return}if(i&&l&&e.name!=="changePassword"){n({name:"changePassword"});return}if(e.name==="changePassword"&&!l){n({name:"home"});return}if(e.meta.allowedRoles&&a&&!e.meta.allowedRoles.includes(a)){n({name:"home"});return}if(e.meta.requiresGuest&&i){n({name:"home"});return}n()});function soe(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:i,onRegisteredSW:l,onRegisterError:a}=e;let o,f;const m=async(w=!0)=>{await f};async function _(){if("serviceWorker"in navigator){if(o=await Dd(async()=>{const{Workbox:w}=await import("./workbox-window.prod.es5.js");return{Workbox:w}},[]).then(({Workbox:w})=>new w("/static/frontend/sw.js",{scope:"/static/frontend/",type:"classic"})).catch(w=>{a==null||a(w)}),!o)return;o.addEventListener("activated",w=>{(w.isUpdate||w.isExternal)&&window.location.reload()}),o.addEventListener("installed",w=>{w.isUpdate||r==null||r()}),o.register({immediate:t}).then(w=>{l?l("/static/frontend/sw.js",w):i==null||i(w)}).catch(w=>{a==null||a(w)})}}return f=_(),m}const mS=Fx(jz),G6=KB();mS.use(G6);mS.use($6);const ooe=Mu(G6);window.INITIAL_STATE&&ooe.initialize(window.INITIAL_STATE);mS.mount("#app");soe({immediate:!0,onRegistered(e){},onRegisterError(e){console.error("Erreur d'enregistrement du SW:",e)},onOfflineReady(){}});export{Xo as _,bd as a,V as b,Et as c,Ja as d,yr as e,Tr as f,rs as g,li as h,yt as i,vd as j,Ns as k,Hh as l,lC as m,$s as n,Rl as o,zF as p,z2 as q,Rn as r,lc as s,er as t,Mu as u,to as v,Wh as w,Mg as x};

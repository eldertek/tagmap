var RC=Object.defineProperty;var FC=(e,n,t)=>n in e?RC(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var qt=(e,n,t)=>FC(e,typeof n!="symbol"?n+"":n,t);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Pm(e){const n=Object.create(null);for(const t of e.split(","))n[t]=1;return t=>t in n}const Ii={},Wh=[],gu=()=>{},jC=()=>!1,Mp=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),N1=e=>e.startsWith("onUpdate:"),yo=Object.assign,D1=(e,n)=>{const t=e.indexOf(n);t>-1&&e.splice(t,1)},zC=Object.prototype.hasOwnProperty,Ji=(e,n)=>zC.call(e,n),rr=Array.isArray,Zh=e=>hd(e)==="[object Map]",uh=e=>hd(e)==="[object Set]",N2=e=>hd(e)==="[object Date]",$C=e=>hd(e)==="[object RegExp]",Tr=e=>typeof e=="function",Co=e=>typeof e=="string",Gu=e=>typeof e=="symbol",ao=e=>e!==null&&typeof e=="object",I1=e=>(ao(e)||Tr(e))&&Tr(e.then)&&Tr(e.catch),nw=Object.prototype.toString,hd=e=>nw.call(e),UC=e=>hd(e).slice(8,-1),Mm=e=>hd(e)==="[object Object]",O1=e=>Co(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Kh=Pm(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Am=e=>{const n=Object.create(null);return t=>n[t]||(n[t]=e(t))},VC=/-(\w)/g,ga=Am(e=>e.replace(VC,(n,t)=>t?t.toUpperCase():"")),GC=/\B([A-Z])/g,Sl=Am(e=>e.replace(GC,"-$1").toLowerCase()),Ap=Am(e=>e.charAt(0).toUpperCase()+e.slice(1)),Kd=Am(e=>e?`on${Ap(e)}`:""),tl=(e,n)=>!Object.is(e,n),Yh=(e,...n)=>{for(let t=0;t<e.length;t++)e[t](...n)},rw=(e,n,t,r=!1)=>{Object.defineProperty(e,n,{configurable:!0,enumerable:!1,writable:r,value:t})},Kg=e=>{const n=parseFloat(e);return isNaN(n)?e:n},Yg=e=>{const n=Co(e)?Number(e):NaN;return isNaN(n)?e:n};let D2;const km=()=>D2||(D2=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),HC="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console,Error,Symbol",qC=Pm(HC);function ql(e){if(rr(e)){const n={};for(let t=0;t<e.length;t++){const r=e[t],i=Co(r)?YC(r):ql(r);if(i)for(const s in i)n[s]=i[s]}return n}else if(Co(e)||ao(e))return e}const WC=/;(?![^(]*\))/g,ZC=/:([^]+)/,KC=/\/\*[^]*?\*\//g;function YC(e){const n={};return e.replace(KC,"").split(WC).forEach(t=>{if(t){const r=t.split(ZC);r.length>1&&(n[r[0].trim()]=r[1].trim())}}),n}function Vi(e){let n="";if(Co(e))n=e;else if(rr(e))for(let t=0;t<e.length;t++){const r=Vi(e[t]);r&&(n+=r+" ")}else if(ao(e))for(const t in e)e[t]&&(n+=t+" ");return n.trim()}function JC(e){if(!e)return null;let{class:n,style:t}=e;return n&&!Co(n)&&(e.class=Vi(n)),t&&(e.style=ql(t)),e}const XC="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",QC=Pm(XC);function iw(e){return!!e||e===""}function eP(e,n){if(e.length!==n.length)return!1;let t=!0;for(let r=0;t&&r<e.length;r++)t=Lf(e[r],n[r]);return t}function Lf(e,n){if(e===n)return!0;let t=N2(e),r=N2(n);if(t||r)return t&&r?e.getTime()===n.getTime():!1;if(t=Gu(e),r=Gu(n),t||r)return e===n;if(t=rr(e),r=rr(n),t||r)return t&&r?eP(e,n):!1;if(t=ao(e),r=ao(n),t||r){if(!t||!r)return!1;const i=Object.keys(e).length,s=Object.keys(n).length;if(i!==s)return!1;for(const o in e){const u=e.hasOwnProperty(o),f=n.hasOwnProperty(o);if(u&&!f||!u&&f||!Lf(e[o],n[o]))return!1}}return String(e)===String(n)}function Tm(e,n){return e.findIndex(t=>Lf(t,n))}const ow=e=>!!(e&&e.__v_isRef===!0),Zt=e=>Co(e)?e:e==null?"":rr(e)||ao(e)&&(e.toString===nw||!Tr(e.toString))?ow(e)?Zt(e.value):JSON.stringify(e,sw,2):String(e),sw=(e,n)=>ow(n)?sw(e,n.value):Zh(n)?{[`Map(${n.size})`]:[...n.entries()].reduce((t,[r,i],s)=>(t[O0(r,s)+" =>"]=i,t),{})}:uh(n)?{[`Set(${n.size})`]:[...n.values()].map(t=>O0(t))}:Gu(n)?O0(n):ao(n)&&!rr(n)&&!Mm(n)?String(n):n,O0=(e,n="")=>{var t;return Gu(e)?`Symbol(${(t=e.description)!=null?t:n})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let el;class B1{constructor(n=!1){this.detached=n,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=el,!n&&el&&(this.index=(el.scopes||(el.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let n,t;if(this.scopes)for(n=0,t=this.scopes.length;n<t;n++)this.scopes[n].pause();for(n=0,t=this.effects.length;n<t;n++)this.effects[n].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let n,t;if(this.scopes)for(n=0,t=this.scopes.length;n<t;n++)this.scopes[n].resume();for(n=0,t=this.effects.length;n<t;n++)this.effects[n].resume()}}run(n){if(this._active){const t=el;try{return el=this,n()}finally{el=t}}}on(){el=this}off(){el=this.parent}stop(n){if(this._active){this._active=!1;let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(this.effects.length=0,t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!n){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function R1(e){return new B1(e)}function F1(){return el}function aw(e,n=!1){el&&el.cleanups.push(e)}let Eo;const B0=new WeakSet;class dp{constructor(n){this.fn=n,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,el&&el.active&&el.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,B0.has(this)&&(B0.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||uw(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,I2(this),cw(this);const n=Eo,t=Vu;Eo=this,Vu=!0;try{return this.fn()}finally{fw(this),Eo=n,Vu=t,this.flags&=-3}}stop(){if(this.flags&1){for(let n=this.deps;n;n=n.nextDep)$1(n);this.deps=this.depsTail=void 0,I2(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?B0.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Ev(this)&&this.run()}get dirty(){return Ev(this)}}let lw=0,Yd,Jd;function uw(e,n=!1){if(e.flags|=8,n){e.next=Jd,Jd=e;return}e.next=Yd,Yd=e}function j1(){lw++}function z1(){if(--lw>0)return;if(Jd){let n=Jd;for(Jd=void 0;n;){const t=n.next;n.next=void 0,n.flags&=-9,n=t}}let e;for(;Yd;){let n=Yd;for(Yd=void 0;n;){const t=n.next;if(n.next=void 0,n.flags&=-9,n.flags&1)try{n.trigger()}catch(r){e||(e=r)}n=t}}if(e)throw e}function cw(e){for(let n=e.deps;n;n=n.nextDep)n.version=-1,n.prevActiveLink=n.dep.activeLink,n.dep.activeLink=n}function fw(e){let n,t=e.depsTail,r=t;for(;r;){const i=r.prevDep;r.version===-1?(r===t&&(t=i),$1(r),tP(r)):n=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=i}e.deps=n,e.depsTail=t}function Ev(e){for(let n=e.deps;n;n=n.nextDep)if(n.dep.version!==n.version||n.dep.computed&&(hw(n.dep.computed)||n.dep.version!==n.version))return!0;return!!e._dirty}function hw(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===pp))return;e.globalVersion=pp;const n=e.dep;if(e.flags|=2,n.version>0&&!e.isSSR&&e.deps&&!Ev(e)){e.flags&=-3;return}const t=Eo,r=Vu;Eo=e,Vu=!0;try{cw(e);const i=e.fn(e._value);(n.version===0||tl(i,e._value))&&(e._value=i,n.version++)}catch(i){throw n.version++,i}finally{Eo=t,Vu=r,fw(e),e.flags&=-3}}function $1(e,n=!1){const{dep:t,prevSub:r,nextSub:i}=e;if(r&&(r.nextSub=i,e.prevSub=void 0),i&&(i.prevSub=r,e.nextSub=void 0),t.subs===e&&(t.subs=r,!r&&t.computed)){t.computed.flags&=-5;for(let s=t.computed.deps;s;s=s.nextDep)$1(s,!0)}!n&&!--t.sc&&t.map&&t.map.delete(t.key)}function tP(e){const{prevDep:n,nextDep:t}=e;n&&(n.nextDep=t,e.prevDep=void 0),t&&(t.prevDep=n,e.nextDep=void 0)}function nP(e,n){e.effect instanceof dp&&(e=e.effect.fn);const t=new dp(e);n&&yo(t,n);try{t.run()}catch(i){throw t.stop(),i}const r=t.run.bind(t);return r.effect=t,r}function rP(e){e.effect.stop()}let Vu=!0;const dw=[];function Af(){dw.push(Vu),Vu=!1}function kf(){const e=dw.pop();Vu=e===void 0?!0:e}function I2(e){const{cleanup:n}=e;if(e.cleanup=void 0,n){const t=Eo;Eo=void 0;try{n()}finally{Eo=t}}}let pp=0;class iP{constructor(n,t){this.sub=n,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Nm{constructor(n){this.computed=n,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(n){if(!Eo||!Vu||Eo===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==Eo)t=this.activeLink=new iP(Eo,this),Eo.deps?(t.prevDep=Eo.depsTail,Eo.depsTail.nextDep=t,Eo.depsTail=t):Eo.deps=Eo.depsTail=t,pw(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const r=t.nextDep;r.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=r),t.prevDep=Eo.depsTail,t.nextDep=void 0,Eo.depsTail.nextDep=t,Eo.depsTail=t,Eo.deps===t&&(Eo.deps=r)}return t}trigger(n){this.version++,pp++,this.notify(n)}notify(n){j1();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{z1()}}}function pw(e){if(e.dep.sc++,e.sub.flags&4){const n=e.dep.computed;if(n&&!e.dep.subs){n.flags|=20;for(let r=n.deps;r;r=r.nextDep)pw(r)}const t=e.dep.subs;t!==e&&(e.prevSub=t,t&&(t.nextSub=e)),e.dep.subs=e}}const Jg=new WeakMap,Qf=Symbol(""),Cv=Symbol(""),gp=Symbol("");function Ia(e,n,t){if(Vu&&Eo){let r=Jg.get(e);r||Jg.set(e,r=new Map);let i=r.get(t);i||(r.set(t,i=new Nm),i.map=r,i.key=t),i.track()}}function Rc(e,n,t,r,i,s){const o=Jg.get(e);if(!o){pp++;return}const u=f=>{f&&f.trigger()};if(j1(),n==="clear")o.forEach(u);else{const f=rr(e),d=f&&O1(t);if(f&&t==="length"){const m=Number(r);o.forEach((_,w)=>{(w==="length"||w===gp||!Gu(w)&&w>=m)&&u(_)})}else switch((t!==void 0||o.has(void 0))&&u(o.get(t)),d&&u(o.get(gp)),n){case"add":f?d&&u(o.get("length")):(u(o.get(Qf)),Zh(e)&&u(o.get(Cv)));break;case"delete":f||(u(o.get(Qf)),Zh(e)&&u(o.get(Cv)));break;case"set":Zh(e)&&u(o.get(Qf));break}}z1()}function oP(e,n){const t=Jg.get(e);return t&&t.get(n)}function Ah(e){const n=Di(e);return n===e?n:(Ia(n,"iterate",gp),Wl(e)?n:n.map(Oa))}function Dm(e){return Ia(e=Di(e),"iterate",gp),e}const sP={__proto__:null,[Symbol.iterator](){return R0(this,Symbol.iterator,Oa)},concat(...e){return Ah(this).concat(...e.map(n=>rr(n)?Ah(n):n))},entries(){return R0(this,"entries",e=>(e[1]=Oa(e[1]),e))},every(e,n){return Nc(this,"every",e,n,void 0,arguments)},filter(e,n){return Nc(this,"filter",e,n,t=>t.map(Oa),arguments)},find(e,n){return Nc(this,"find",e,n,Oa,arguments)},findIndex(e,n){return Nc(this,"findIndex",e,n,void 0,arguments)},findLast(e,n){return Nc(this,"findLast",e,n,Oa,arguments)},findLastIndex(e,n){return Nc(this,"findLastIndex",e,n,void 0,arguments)},forEach(e,n){return Nc(this,"forEach",e,n,void 0,arguments)},includes(...e){return F0(this,"includes",e)},indexOf(...e){return F0(this,"indexOf",e)},join(e){return Ah(this).join(e)},lastIndexOf(...e){return F0(this,"lastIndexOf",e)},map(e,n){return Nc(this,"map",e,n,void 0,arguments)},pop(){return Cd(this,"pop")},push(...e){return Cd(this,"push",e)},reduce(e,...n){return O2(this,"reduce",e,n)},reduceRight(e,...n){return O2(this,"reduceRight",e,n)},shift(){return Cd(this,"shift")},some(e,n){return Nc(this,"some",e,n,void 0,arguments)},splice(...e){return Cd(this,"splice",e)},toReversed(){return Ah(this).toReversed()},toSorted(e){return Ah(this).toSorted(e)},toSpliced(...e){return Ah(this).toSpliced(...e)},unshift(...e){return Cd(this,"unshift",e)},values(){return R0(this,"values",Oa)}};function R0(e,n,t){const r=Dm(e),i=r[n]();return r!==e&&!Wl(e)&&(i._next=i.next,i.next=()=>{const s=i._next();return s.value&&(s.value=t(s.value)),s}),i}const aP=Array.prototype;function Nc(e,n,t,r,i,s){const o=Dm(e),u=o!==e&&!Wl(e),f=o[n];if(f!==aP[n]){const _=f.apply(e,s);return u?Oa(_):_}let d=t;o!==e&&(u?d=function(_,w){return t.call(this,Oa(_),w,e)}:t.length>2&&(d=function(_,w){return t.call(this,_,w,e)}));const m=f.call(o,d,r);return u&&i?i(m):m}function O2(e,n,t,r){const i=Dm(e);let s=t;return i!==e&&(Wl(e)?t.length>3&&(s=function(o,u,f){return t.call(this,o,u,f,e)}):s=function(o,u,f){return t.call(this,o,Oa(u),f,e)}),i[n](s,...r)}function F0(e,n,t){const r=Di(e);Ia(r,"iterate",gp);const i=r[n](...t);return(i===-1||i===!1)&&Bm(t[0])?(t[0]=Di(t[0]),r[n](...t)):i}function Cd(e,n,t=[]){Af(),j1();const r=Di(e)[n].apply(e,t);return z1(),kf(),r}const lP=Pm("__proto__,__v_isRef,__isVue"),gw=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Gu));function uP(e){Gu(e)||(e=String(e));const n=Di(this);return Ia(n,"has",e),n.hasOwnProperty(e)}class mw{constructor(n=!1,t=!1){this._isReadonly=n,this._isShallow=t}get(n,t,r){if(t==="__v_skip")return n.__v_skip;const i=this._isReadonly,s=this._isShallow;if(t==="__v_isReactive")return!i;if(t==="__v_isReadonly")return i;if(t==="__v_isShallow")return s;if(t==="__v_raw")return r===(i?s?xw:ww:s?bw:_w).get(n)||Object.getPrototypeOf(n)===Object.getPrototypeOf(r)?n:void 0;const o=rr(n);if(!i){let f;if(o&&(f=sP[t]))return f;if(t==="hasOwnProperty")return uP}const u=Reflect.get(n,t,Xo(n)?n:r);return(Gu(t)?gw.has(t):lP(t))||(i||Ia(n,"get",t),s)?u:Xo(u)?o&&O1(t)?u:u.value:ao(u)?i?Ru(u):Yl(u):u}}class vw extends mw{constructor(n=!1){super(!1,n)}set(n,t,r,i){let s=n[t];if(!this._isShallow){const f=Sf(s);if(!Wl(r)&&!Sf(r)&&(s=Di(s),r=Di(r)),!rr(n)&&Xo(s)&&!Xo(r))return f?!1:(s.value=r,!0)}const o=rr(n)&&O1(t)?Number(t)<n.length:Ji(n,t),u=Reflect.set(n,t,r,Xo(n)?n:i);return n===Di(i)&&(o?tl(r,s)&&Rc(n,"set",t,r):Rc(n,"add",t,r)),u}deleteProperty(n,t){const r=Ji(n,t);n[t];const i=Reflect.deleteProperty(n,t);return i&&r&&Rc(n,"delete",t,void 0),i}has(n,t){const r=Reflect.has(n,t);return(!Gu(t)||!gw.has(t))&&Ia(n,"has",t),r}ownKeys(n){return Ia(n,"iterate",rr(n)?"length":Qf),Reflect.ownKeys(n)}}class yw extends mw{constructor(n=!1){super(!0,n)}set(n,t){return!0}deleteProperty(n,t){return!0}}const cP=new vw,fP=new yw,hP=new vw(!0),dP=new yw(!0),Pv=e=>e,sg=e=>Reflect.getPrototypeOf(e);function pP(e,n,t){return function(...r){const i=this.__v_raw,s=Di(i),o=Zh(s),u=e==="entries"||e===Symbol.iterator&&o,f=e==="keys"&&o,d=i[e](...r),m=t?Pv:n?Mv:Oa;return!n&&Ia(s,"iterate",f?Cv:Qf),{next(){const{value:_,done:w}=d.next();return w?{value:_,done:w}:{value:u?[m(_[0]),m(_[1])]:m(_),done:w}},[Symbol.iterator](){return this}}}}function ag(e){return function(...n){return e==="delete"?!1:e==="clear"?void 0:this}}function gP(e,n){const t={get(i){const s=this.__v_raw,o=Di(s),u=Di(i);e||(tl(i,u)&&Ia(o,"get",i),Ia(o,"get",u));const{has:f}=sg(o),d=n?Pv:e?Mv:Oa;if(f.call(o,i))return d(s.get(i));if(f.call(o,u))return d(s.get(u));s!==o&&s.get(i)},get size(){const i=this.__v_raw;return!e&&Ia(Di(i),"iterate",Qf),Reflect.get(i,"size",i)},has(i){const s=this.__v_raw,o=Di(s),u=Di(i);return e||(tl(i,u)&&Ia(o,"has",i),Ia(o,"has",u)),i===u?s.has(i):s.has(i)||s.has(u)},forEach(i,s){const o=this,u=o.__v_raw,f=Di(u),d=n?Pv:e?Mv:Oa;return!e&&Ia(f,"iterate",Qf),u.forEach((m,_)=>i.call(s,d(m),d(_),o))}};return yo(t,e?{add:ag("add"),set:ag("set"),delete:ag("delete"),clear:ag("clear")}:{add(i){!n&&!Wl(i)&&!Sf(i)&&(i=Di(i));const s=Di(this);return sg(s).has.call(s,i)||(s.add(i),Rc(s,"add",i,i)),this},set(i,s){!n&&!Wl(s)&&!Sf(s)&&(s=Di(s));const o=Di(this),{has:u,get:f}=sg(o);let d=u.call(o,i);d||(i=Di(i),d=u.call(o,i));const m=f.call(o,i);return o.set(i,s),d?tl(s,m)&&Rc(o,"set",i,s):Rc(o,"add",i,s),this},delete(i){const s=Di(this),{has:o,get:u}=sg(s);let f=o.call(s,i);f||(i=Di(i),f=o.call(s,i)),u&&u.call(s,i);const d=s.delete(i);return f&&Rc(s,"delete",i,void 0),d},clear(){const i=Di(this),s=i.size!==0,o=i.clear();return s&&Rc(i,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=pP(i,e,n)}),t}function Im(e,n){const t=gP(e,n);return(r,i,s)=>i==="__v_isReactive"?!e:i==="__v_isReadonly"?e:i==="__v_raw"?r:Reflect.get(Ji(t,i)&&i in r?t:r,i,s)}const mP={get:Im(!1,!1)},vP={get:Im(!1,!0)},yP={get:Im(!0,!1)},_P={get:Im(!0,!0)},_w=new WeakMap,bw=new WeakMap,ww=new WeakMap,xw=new WeakMap;function bP(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function wP(e){return e.__v_skip||!Object.isExtensible(e)?0:bP(UC(e))}function Yl(e){return Sf(e)?e:Om(e,!1,cP,mP,_w)}function U1(e){return Om(e,!1,hP,vP,bw)}function Ru(e){return Om(e,!0,fP,yP,ww)}function xP(e){return Om(e,!0,dP,_P,xw)}function Om(e,n,t,r,i){if(!ao(e)||e.__v_raw&&!(n&&e.__v_isReactive))return e;const s=i.get(e);if(s)return s;const o=wP(e);if(o===0)return e;const u=new Proxy(e,o===2?r:t);return i.set(e,u),u}function dc(e){return Sf(e)?dc(e.__v_raw):!!(e&&e.__v_isReactive)}function Sf(e){return!!(e&&e.__v_isReadonly)}function Wl(e){return!!(e&&e.__v_isShallow)}function Bm(e){return e?!!e.__v_raw:!1}function Di(e){const n=e&&e.__v_raw;return n?Di(n):e}function Rm(e){return!Ji(e,"__v_skip")&&Object.isExtensible(e)&&rw(e,"__v_skip",!0),e}const Oa=e=>ao(e)?Yl(e):e,Mv=e=>ao(e)?Ru(e):e;function Xo(e){return e?e.__v_isRef===!0:!1}function zt(e){return Lw(e,!1)}function V1(e){return Lw(e,!0)}function Lw(e,n){return Xo(e)?e:new LP(e,n)}class LP{constructor(n,t){this.dep=new Nm,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?n:Di(n),this._value=t?n:Oa(n),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(n){const t=this._rawValue,r=this.__v_isShallow||Wl(n)||Sf(n);n=r?n:Di(n),tl(n,t)&&(this._rawValue=n,this._value=r?n:Oa(n),this.dep.trigger())}}function SP(e){e.dep&&e.dep.trigger()}function Kn(e){return Xo(e)?e.value:e}function EP(e){return Tr(e)?e():Kn(e)}const CP={get:(e,n,t)=>n==="__v_raw"?e:Kn(Reflect.get(e,n,t)),set:(e,n,t,r)=>{const i=e[n];return Xo(i)&&!Xo(t)?(i.value=t,!0):Reflect.set(e,n,t,r)}};function G1(e){return dc(e)?e:new Proxy(e,CP)}class PP{constructor(n){this.__v_isRef=!0,this._value=void 0;const t=this.dep=new Nm,{get:r,set:i}=n(t.track.bind(t),t.trigger.bind(t));this._get=r,this._set=i}get value(){return this._value=this._get()}set value(n){this._set(n)}}function Sw(e){return new PP(e)}function Ew(e){const n=rr(e)?new Array(e.length):{};for(const t in e)n[t]=Cw(e,t);return n}class MP{constructor(n,t,r){this._object=n,this._key=t,this._defaultValue=r,this.__v_isRef=!0,this._value=void 0}get value(){const n=this._object[this._key];return this._value=n===void 0?this._defaultValue:n}set value(n){this._object[this._key]=n}get dep(){return oP(Di(this._object),this._key)}}class AP{constructor(n){this._getter=n,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function kP(e,n,t){return Xo(e)?e:Tr(e)?new AP(e):ao(e)&&arguments.length>1?Cw(e,n,t):zt(e)}function Cw(e,n,t){const r=e[n];return Xo(r)?r:new MP(e,n,t)}class TP{constructor(n,t,r){this.fn=n,this.setter=t,this._value=void 0,this.dep=new Nm(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=pp-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&Eo!==this)return uw(this,!0),!0}get value(){const n=this.dep.track();return hw(this),n&&(n.version=this.dep.version),this._value}set value(n){this.setter&&this.setter(n)}}function NP(e,n,t=!1){let r,i;return Tr(e)?r=e:(r=e.get,i=e.set),new TP(r,i,t)}const DP={GET:"get",HAS:"has",ITERATE:"iterate"},IP={SET:"set",ADD:"add",DELETE:"delete",CLEAR:"clear"},lg={},Xg=new WeakMap;let uf;function OP(){return uf}function Pw(e,n=!1,t=uf){if(t){let r=Xg.get(t);r||Xg.set(t,r=[]),r.push(e)}}function BP(e,n,t=Ii){const{immediate:r,deep:i,once:s,scheduler:o,augmentJob:u,call:f}=t,d=ee=>i?ee:Wl(ee)||i===!1||i===0?Fc(ee,1):Fc(ee);let m,_,w,y,M=!1,k=!1;if(Xo(e)?(_=()=>e.value,M=Wl(e)):dc(e)?(_=()=>d(e),M=!0):rr(e)?(k=!0,M=e.some(ee=>dc(ee)||Wl(ee)),_=()=>e.map(ee=>{if(Xo(ee))return ee.value;if(dc(ee))return d(ee);if(Tr(ee))return f?f(ee,2):ee()})):Tr(e)?n?_=f?()=>f(e,2):e:_=()=>{if(w){Af();try{w()}finally{kf()}}const ee=uf;uf=m;try{return f?f(e,3,[y]):e(y)}finally{uf=ee}}:_=gu,n&&i){const ee=_,he=i===!0?1/0:i;_=()=>Fc(ee(),he)}const F=F1(),I=()=>{m.stop(),F&&F.active&&D1(F.effects,m)};if(s&&n){const ee=n;n=(...he)=>{ee(...he),I()}}let R=k?new Array(e.length).fill(lg):lg;const K=ee=>{if(!(!(m.flags&1)||!m.dirty&&!ee))if(n){const he=m.run();if(i||M||(k?he.some((fe,ve)=>tl(fe,R[ve])):tl(he,R))){w&&w();const fe=uf;uf=m;try{const ve=[he,R===lg?void 0:k&&R[0]===lg?[]:R,y];f?f(n,3,ve):n(...ve),R=he}finally{uf=fe}}}else m.run()};return u&&u(K),m=new dp(_),m.scheduler=o?()=>o(K,!1):K,y=ee=>Pw(ee,!1,m),w=m.onStop=()=>{const ee=Xg.get(m);if(ee){if(f)f(ee,4);else for(const he of ee)he();Xg.delete(m)}},n?r?K(!0):R=m.run():o?o(K.bind(null,!0),!0):m.run(),I.pause=m.pause.bind(m),I.resume=m.resume.bind(m),I.stop=I,I}function Fc(e,n=1/0,t){if(n<=0||!ao(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),n--,Xo(e))Fc(e.value,n,t);else if(rr(e))for(let r=0;r<e.length;r++)Fc(e[r],n,t);else if(uh(e)||Zh(e))e.forEach(r=>{Fc(r,n,t)});else if(Mm(e)){for(const r in e)Fc(e[r],n,t);for(const r of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,r)&&Fc(e[r],n,t)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const Mw=[];function RP(e){Mw.push(e)}function FP(){Mw.pop()}function jP(e,n){}const zP={SETUP_FUNCTION:0,0:"SETUP_FUNCTION",RENDER_FUNCTION:1,1:"RENDER_FUNCTION",NATIVE_EVENT_HANDLER:5,5:"NATIVE_EVENT_HANDLER",COMPONENT_EVENT_HANDLER:6,6:"COMPONENT_EVENT_HANDLER",VNODE_HOOK:7,7:"VNODE_HOOK",DIRECTIVE_HOOK:8,8:"DIRECTIVE_HOOK",TRANSITION_HOOK:9,9:"TRANSITION_HOOK",APP_ERROR_HANDLER:10,10:"APP_ERROR_HANDLER",APP_WARN_HANDLER:11,11:"APP_WARN_HANDLER",FUNCTION_REF:12,12:"FUNCTION_REF",ASYNC_COMPONENT_LOADER:13,13:"ASYNC_COMPONENT_LOADER",SCHEDULER:14,14:"SCHEDULER",COMPONENT_UPDATE:15,15:"COMPONENT_UPDATE",APP_UNMOUNT_CLEANUP:16,16:"APP_UNMOUNT_CLEANUP"},$P={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",0:"setup function",1:"render function",2:"watcher getter",3:"watcher callback",4:"watcher cleanup function",5:"native event handler",6:"component event handler",7:"vnode hook",8:"directive hook",9:"transition hook",10:"app errorHandler",11:"app warnHandler",12:"ref function",13:"async component loader",14:"scheduler flush",15:"component update",16:"app unmount cleanup function"};function dd(e,n,t,r){try{return r?e(...r):e()}catch(i){ch(i,n,t)}}function yu(e,n,t,r){if(Tr(e)){const i=dd(e,n,t,r);return i&&I1(i)&&i.catch(s=>{ch(s,n,t)}),i}if(rr(e)){const i=[];for(let s=0;s<e.length;s++)i.push(yu(e[s],n,t,r));return i}}function ch(e,n,t,r=!0){const i=n?n.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:o}=n&&n.appContext.config||Ii;if(n){let u=n.parent;const f=n.proxy,d=`https://vuejs.org/error-reference/#runtime-${t}`;for(;u;){const m=u.ec;if(m){for(let _=0;_<m.length;_++)if(m[_](e,f,d)===!1)return}u=u.parent}if(s){Af(),dd(s,null,10,[e,f,d]),kf();return}}UP(e,t,i,r,o)}function UP(e,n,t,r=!0,i=!1){if(i)throw e;console.error(e)}const nl=[];let lc=-1;const Jh=[];let cf=null,Rh=0;const Aw=Promise.resolve();let Qg=null;function Us(e){const n=Qg||Aw;return e?n.then(this?e.bind(this):e):n}function VP(e){let n=lc+1,t=nl.length;for(;n<t;){const r=n+t>>>1,i=nl[r],s=vp(i);s<e||s===e&&i.flags&2?n=r+1:t=r}return n}function H1(e){if(!(e.flags&1)){const n=vp(e),t=nl[nl.length-1];!t||!(e.flags&2)&&n>=vp(t)?nl.push(e):nl.splice(VP(n),0,e),e.flags|=1,kw()}}function kw(){Qg||(Qg=Aw.then(Tw))}function mp(e){rr(e)?Jh.push(...e):cf&&e.id===-1?cf.splice(Rh+1,0,e):e.flags&1||(Jh.push(e),e.flags|=1),kw()}function B2(e,n,t=lc+1){for(;t<nl.length;t++){const r=nl[t];if(r&&r.flags&2){if(e&&r.id!==e.uid)continue;nl.splice(t,1),t--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function em(e){if(Jh.length){const n=[...new Set(Jh)].sort((t,r)=>vp(t)-vp(r));if(Jh.length=0,cf){cf.push(...n);return}for(cf=n,Rh=0;Rh<cf.length;Rh++){const t=cf[Rh];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}cf=null,Rh=0}}const vp=e=>e.id==null?e.flags&2?-1:1/0:e.id;function Tw(e){try{for(lc=0;lc<nl.length;lc++){const n=nl[lc];n&&!(n.flags&8)&&(n.flags&4&&(n.flags&=-2),dd(n,n.i,n.i?15:14),n.flags&4||(n.flags&=-2))}}finally{for(;lc<nl.length;lc++){const n=nl[lc];n&&(n.flags&=-2)}lc=-1,nl.length=0,em(),Qg=null,(nl.length||Jh.length)&&Tw()}}let Fh,ug=[];function Nw(e,n){var t,r;Fh=e,Fh?(Fh.enabled=!0,ug.forEach(({event:i,args:s})=>Fh.emit(i,...s)),ug=[]):typeof window<"u"&&window.HTMLElement&&!((r=(t=window.navigator)==null?void 0:t.userAgent)!=null&&r.includes("jsdom"))?((n.__VUE_DEVTOOLS_HOOK_REPLAY__=n.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(s=>{Nw(s,n)}),setTimeout(()=>{Fh||(n.__VUE_DEVTOOLS_HOOK_REPLAY__=null,ug=[])},3e3)):ug=[]}let Gs=null,Fm=null;function yp(e){const n=Gs;return Gs=e,Fm=e&&e.type.__scopeId||null,n}function GP(e){Fm=e}function HP(){Fm=null}const qP=e=>pu;function pu(e,n=Gs,t){if(!n||e._n)return e;const r=(...i)=>{r._d&&Rv(-1);const s=yp(n);let o;try{o=e(...i)}finally{yp(s),r._d&&Rv(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function Fn(e,n){if(Gs===null)return e;const t=Np(Gs),r=e.dirs||(e.dirs=[]);for(let i=0;i<n.length;i++){let[s,o,u,f=Ii]=n[i];s&&(Tr(s)&&(s={mounted:s,updated:s}),s.deep&&Fc(o),r.push({dir:s,instance:t,value:o,oldValue:void 0,arg:u,modifiers:f}))}return e}function uc(e,n,t,r){const i=e.dirs,s=n&&n.dirs;for(let o=0;o<i.length;o++){const u=i[o];s&&(u.oldValue=s[o].value);let f=u.dir[r];f&&(Af(),yu(f,t,8,[e.el,u,e,n]),kf())}}const Dw=Symbol("_vte"),Iw=e=>e.__isTeleport,Xd=e=>e&&(e.disabled||e.disabled===""),R2=e=>e&&(e.defer||e.defer===""),F2=e=>typeof SVGElement<"u"&&e instanceof SVGElement,j2=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,Av=(e,n)=>{const t=e&&e.to;return Co(t)?n?n(t):null:t},Ow={name:"Teleport",__isTeleport:!0,process(e,n,t,r,i,s,o,u,f,d){const{mc:m,pc:_,pbc:w,o:{insert:y,querySelector:M,createText:k,createComment:F}}=d,I=Xd(n.props);let{shapeFlag:R,children:K,dynamicChildren:ee}=n;if(e==null){const he=n.el=k(""),fe=n.anchor=k("");y(he,t,r),y(fe,t,r);const ve=(U,J)=>{R&16&&(i&&i.isCE&&(i.ce._teleportTarget=U),m(K,U,J,i,s,o,u,f))},z=()=>{const U=n.target=Av(n.props,M),J=Bw(U,n,k,y);U&&(o!=="svg"&&F2(U)?o="svg":o!=="mathml"&&j2(U)&&(o="mathml"),I||(ve(U,J),Ag(n,!1)))};I&&(ve(t,fe),Ag(n,!0)),R2(n.props)?$s(()=>{z(),n.el.__isMounted=!0},s):z()}else{if(R2(n.props)&&!e.el.__isMounted){$s(()=>{Ow.process(e,n,t,r,i,s,o,u,f,d),delete e.el.__isMounted},s);return}n.el=e.el,n.targetStart=e.targetStart;const he=n.anchor=e.anchor,fe=n.target=e.target,ve=n.targetAnchor=e.targetAnchor,z=Xd(e.props),U=z?t:fe,J=z?he:ve;if(o==="svg"||F2(fe)?o="svg":(o==="mathml"||j2(fe))&&(o="mathml"),ee?(w(e.dynamicChildren,ee,U,i,s,o,u),ty(e,n,!0)):f||_(e,n,U,J,i,s,o,u,!1),I)z?n.props&&e.props&&n.props.to!==e.props.to&&(n.props.to=e.props.to):cg(n,t,he,d,1);else if((n.props&&n.props.to)!==(e.props&&e.props.to)){const T=n.target=Av(n.props,M);T&&cg(n,T,null,d,0)}else z&&cg(n,fe,ve,d,1);Ag(n,I)}},remove(e,n,t,{um:r,o:{remove:i}},s){const{shapeFlag:o,children:u,anchor:f,targetStart:d,targetAnchor:m,target:_,props:w}=e;if(_&&(i(d),i(m)),s&&i(f),o&16){const y=s||!Xd(w);for(let M=0;M<u.length;M++){const k=u[M];r(k,n,t,y,!!k.dynamicChildren)}}},move:cg,hydrate:WP};function cg(e,n,t,{o:{insert:r},m:i},s=2){s===0&&r(e.targetAnchor,n,t);const{el:o,anchor:u,shapeFlag:f,children:d,props:m}=e,_=s===2;if(_&&r(o,n,t),(!_||Xd(m))&&f&16)for(let w=0;w<d.length;w++)i(d[w],n,t,2);_&&r(u,n,t)}function WP(e,n,t,r,i,s,{o:{nextSibling:o,parentNode:u,querySelector:f,insert:d,createText:m}},_){const w=n.target=Av(n.props,f);if(w){const y=Xd(n.props),M=w._lpa||w.firstChild;if(n.shapeFlag&16)if(y)n.anchor=_(o(e),n,u(e),t,r,i,s),n.targetStart=M,n.targetAnchor=M&&o(M);else{n.anchor=o(e);let k=M;for(;k;){if(k&&k.nodeType===8){if(k.data==="teleport start anchor")n.targetStart=k;else if(k.data==="teleport anchor"){n.targetAnchor=k,w._lpa=n.targetAnchor&&o(n.targetAnchor);break}}k=o(k)}n.targetAnchor||Bw(w,n,m,d),_(M&&o(M),n,w,t,r,i,s)}Ag(n,y)}return n.anchor&&o(n.anchor)}const kv=Ow;function Ag(e,n){const t=e.ctx;if(t&&t.ut){let r,i;for(n?(r=e.el,i=e.anchor):(r=e.targetStart,i=e.targetAnchor);r&&r!==i;)r.nodeType===1&&r.setAttribute("data-v-owner",t.uid),r=r.nextSibling;t.ut()}}function Bw(e,n,t,r){const i=n.targetStart=t(""),s=n.targetAnchor=t("");return i[Dw]=s,e&&(r(i,e),r(s,e)),s}const ff=Symbol("_leaveCb"),fg=Symbol("_enterCb");function q1(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Cs(()=>{e.isMounted=!0}),fh(()=>{e.isUnmounting=!0}),e}const au=[Function,Array],W1={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:au,onEnter:au,onAfterEnter:au,onEnterCancelled:au,onBeforeLeave:au,onLeave:au,onAfterLeave:au,onLeaveCancelled:au,onBeforeAppear:au,onAppear:au,onAfterAppear:au,onAppearCancelled:au},Rw=e=>{const n=e.subTree;return n.component?Rw(n.component):n},ZP={name:"BaseTransition",props:W1,setup(e,{slots:n}){const t=bu(),r=q1();return()=>{const i=n.default&&jm(n.default(),!0);if(!i||!i.length)return;const s=Fw(i),o=Di(e),{mode:u}=o;if(r.isLeaving)return j0(s);const f=z2(s);if(!f)return j0(s);let d=rd(f,o,r,t,_=>d=_);f.type!==Rs&&Uc(f,d);let m=t.subTree&&z2(t.subTree);if(m&&m.type!==Rs&&!zu(f,m)&&Rw(t).type!==Rs){let _=rd(m,o,r,t);if(Uc(m,_),u==="out-in"&&f.type!==Rs)return r.isLeaving=!0,_.afterLeave=()=>{r.isLeaving=!1,t.job.flags&8||t.update(),delete _.afterLeave,m=void 0},j0(s);u==="in-out"&&f.type!==Rs?_.delayLeave=(w,y,M)=>{const k=zw(r,m);k[String(m.key)]=m,w[ff]=()=>{y(),w[ff]=void 0,delete d.delayedLeave,m=void 0},d.delayedLeave=()=>{M(),delete d.delayedLeave,m=void 0}}:m=void 0}else m&&(m=void 0);return s}}};function Fw(e){let n=e[0];if(e.length>1){for(const t of e)if(t.type!==Rs){n=t;break}}return n}const jw=ZP;function zw(e,n){const{leavingVNodes:t}=e;let r=t.get(n.type);return r||(r=Object.create(null),t.set(n.type,r)),r}function rd(e,n,t,r,i){const{appear:s,mode:o,persisted:u=!1,onBeforeEnter:f,onEnter:d,onAfterEnter:m,onEnterCancelled:_,onBeforeLeave:w,onLeave:y,onAfterLeave:M,onLeaveCancelled:k,onBeforeAppear:F,onAppear:I,onAfterAppear:R,onAppearCancelled:K}=n,ee=String(e.key),he=zw(t,e),fe=(U,J)=>{U&&yu(U,r,9,J)},ve=(U,J)=>{const T=J[1];fe(U,J),rr(U)?U.every(D=>D.length<=1)&&T():U.length<=1&&T()},z={mode:o,persisted:u,beforeEnter(U){let J=f;if(!t.isMounted)if(s)J=F||f;else return;U[ff]&&U[ff](!0);const T=he[ee];T&&zu(e,T)&&T.el[ff]&&T.el[ff](),fe(J,[U])},enter(U){let J=d,T=m,D=_;if(!t.isMounted)if(s)J=I||d,T=R||m,D=K||_;else return;let B=!1;const $=U[fg]=W=>{B||(B=!0,W?fe(D,[U]):fe(T,[U]),z.delayedLeave&&z.delayedLeave(),U[fg]=void 0)};J?ve(J,[U,$]):$()},leave(U,J){const T=String(e.key);if(U[fg]&&U[fg](!0),t.isUnmounting)return J();fe(w,[U]);let D=!1;const B=U[ff]=$=>{D||(D=!0,J(),$?fe(k,[U]):fe(M,[U]),U[ff]=void 0,he[T]===e&&delete he[T])};he[T]=e,y?ve(y,[U,B]):B()},clone(U){const J=rd(U,n,t,r,i);return i&&i(J),J}};return z}function j0(e){if(kp(e))return e=vc(e),e.children=null,e}function z2(e){if(!kp(e))return Iw(e.type)&&e.children?Fw(e.children):e;const{shapeFlag:n,children:t}=e;if(t){if(n&16)return t[0];if(n&32&&Tr(t.default))return t.default()}}function Uc(e,n){e.shapeFlag&6&&e.component?(e.transition=n,Uc(e.component.subTree,n)):e.shapeFlag&128?(e.ssContent.transition=n.clone(e.ssContent),e.ssFallback.transition=n.clone(e.ssFallback)):e.transition=n}function jm(e,n=!1,t){let r=[],i=0;for(let s=0;s<e.length;s++){let o=e[s];const u=t==null?o.key:String(t)+String(o.key!=null?o.key:s);o.type===Tn?(o.patchFlag&128&&i++,r=r.concat(jm(o.children,n,u))):(n||o.type!==Rs)&&r.push(u!=null?vc(o,{key:u}):o)}if(i>1)for(let s=0;s<r.length;s++)r[s].patchFlag=-2;return r}/*! #__NO_SIDE_EFFECTS__ */function ds(e,n){return Tr(e)?yo({name:e.name},n,{setup:e}):e}function KP(){const e=bu();return e?(e.appContext.config.idPrefix||"v")+"-"+e.ids[0]+e.ids[1]++:""}function Z1(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function YP(e){const n=bu(),t=V1(null);if(n){const i=n.refs===Ii?n.refs={}:n.refs;Object.defineProperty(i,e,{enumerable:!0,get:()=>t.value,set:s=>t.value=s})}return t}function _p(e,n,t,r,i=!1){if(rr(e)){e.forEach((M,k)=>_p(M,n&&(rr(n)?n[k]:n),t,r,i));return}if(bf(r)&&!i){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&_p(e,n,t,r.component.subTree);return}const s=r.shapeFlag&4?Np(r.component):r.el,o=i?null:s,{i:u,r:f}=e,d=n&&n.r,m=u.refs===Ii?u.refs={}:u.refs,_=u.setupState,w=Di(_),y=_===Ii?()=>!1:M=>Ji(w,M);if(d!=null&&d!==f&&(Co(d)?(m[d]=null,y(d)&&(_[d]=null)):Xo(d)&&(d.value=null)),Tr(f))dd(f,u,12,[o,m]);else{const M=Co(f),k=Xo(f);if(M||k){const F=()=>{if(e.f){const I=M?y(f)?_[f]:m[f]:f.value;i?rr(I)&&D1(I,s):rr(I)?I.includes(s)||I.push(s):M?(m[f]=[s],y(f)&&(_[f]=m[f])):(f.value=[s],e.k&&(m[e.k]=f.value))}else M?(m[f]=o,y(f)&&(_[f]=o)):k&&(f.value=o,e.k&&(m[e.k]=o))};o?(F.id=-1,$s(F,t)):F()}}}let $2=!1;const kh=()=>{$2||(console.error("Hydration completed but contains mismatches."),$2=!0)},JP=e=>e.namespaceURI.includes("svg")&&e.tagName!=="foreignObject",XP=e=>e.namespaceURI.includes("MathML"),hg=e=>{if(e.nodeType===1){if(JP(e))return"svg";if(XP(e))return"mathml"}},Gh=e=>e.nodeType===8;function QP(e){const{mt:n,p:t,o:{patchProp:r,createText:i,nextSibling:s,parentNode:o,remove:u,insert:f,createComment:d}}=e,m=(K,ee)=>{if(!ee.hasChildNodes()){t(null,K,ee),em(),ee._vnode=K;return}_(ee.firstChild,K,null,null,null),em(),ee._vnode=K},_=(K,ee,he,fe,ve,z=!1)=>{z=z||!!ee.dynamicChildren;const U=Gh(K)&&K.data==="[",J=()=>k(K,ee,he,fe,ve,U),{type:T,ref:D,shapeFlag:B,patchFlag:$}=ee;let W=K.nodeType;ee.el=K,$===-2&&(z=!1,ee.dynamicChildren=null);let G=null;switch(T){case wf:W!==3?ee.children===""?(f(ee.el=i(""),o(K),K),G=K):G=J():(K.data!==ee.children&&(kh(),K.data=ee.children),G=s(K));break;case Rs:R(K)?(G=s(K),I(ee.el=K.content.firstChild,K,he)):W!==8||U?G=J():G=s(K);break;case th:if(U&&(K=s(K),W=K.nodeType),W===1||W===3){G=K;const oe=!ee.children.length;for(let ie=0;ie<ee.staticCount;ie++)oe&&(ee.children+=G.nodeType===1?G.outerHTML:G.data),ie===ee.staticCount-1&&(ee.anchor=G),G=s(G);return U?s(G):G}else J();break;case Tn:U?G=M(K,ee,he,fe,ve,z):G=J();break;default:if(B&1)(W!==1||ee.type.toLowerCase()!==K.tagName.toLowerCase())&&!R(K)?G=J():G=w(K,ee,he,fe,ve,z);else if(B&6){ee.slotScopeIds=ve;const oe=o(K);if(U?G=F(K):Gh(K)&&K.data==="teleport start"?G=F(K,K.data,"teleport end"):G=s(K),n(ee,oe,null,he,fe,hg(oe),z),bf(ee)&&!ee.type.__asyncResolved){let ie;U?(ie=di(Tn),ie.anchor=G?G.previousSibling:oe.lastChild):ie=K.nodeType===3?Li(""):di("div"),ie.el=K,ee.component.subTree=ie}}else B&64?W!==8?G=J():G=ee.type.hydrate(K,ee,he,fe,ve,z,e,y):B&128&&(G=ee.type.hydrate(K,ee,he,fe,hg(o(K)),ve,z,e,_))}return D!=null&&_p(D,null,fe,ee),G},w=(K,ee,he,fe,ve,z)=>{z=z||!!ee.dynamicChildren;const{type:U,props:J,patchFlag:T,shapeFlag:D,dirs:B,transition:$}=ee,W=U==="input"||U==="option";if(W||T!==-1){B&&uc(ee,null,he,"created");let G=!1;if(R(K)){G=d4(null,$)&&he&&he.vnode.props&&he.vnode.props.appear;const ie=K.content.firstChild;G&&$.beforeEnter(ie),I(ie,K,he),ee.el=K=ie}if(D&16&&!(J&&(J.innerHTML||J.textContent))){let ie=y(K.firstChild,ee,K,he,fe,ve,z);for(;ie;){dg(K,1)||kh();const we=ie;ie=ie.nextSibling,u(we)}}else if(D&8){let ie=ee.children;ie[0]===`
`&&(K.tagName==="PRE"||K.tagName==="TEXTAREA")&&(ie=ie.slice(1)),K.textContent!==ie&&(dg(K,0)||kh(),K.textContent=ee.children)}if(J){if(W||!z||T&48){const ie=K.tagName.includes("-");for(const we in J)(W&&(we.endsWith("value")||we==="indeterminate")||Mp(we)&&!Kh(we)||we[0]==="."||ie)&&r(K,we,null,J[we],void 0,he)}else if(J.onClick)r(K,"onClick",null,J.onClick,void 0,he);else if(T&4&&dc(J.style))for(const ie in J.style)J.style[ie]}let oe;(oe=J&&J.onVnodeBeforeMount)&&bl(oe,he,ee),B&&uc(ee,null,he,"beforeMount"),((oe=J&&J.onVnodeMounted)||B||G)&&x4(()=>{oe&&bl(oe,he,ee),G&&$.enter(K),B&&uc(ee,null,he,"mounted")},fe)}return K.nextSibling},y=(K,ee,he,fe,ve,z,U)=>{U=U||!!ee.dynamicChildren;const J=ee.children,T=J.length;for(let D=0;D<T;D++){const B=U?J[D]:J[D]=Ll(J[D]),$=B.type===wf;K?($&&!U&&D+1<T&&Ll(J[D+1]).type===wf&&(f(i(K.data.slice(B.children.length)),he,s(K)),K.data=B.children),K=_(K,B,fe,ve,z,U)):$&&!B.children?f(B.el=i(""),he):(dg(he,1)||kh(),t(null,B,he,null,fe,ve,hg(he),z))}return K},M=(K,ee,he,fe,ve,z)=>{const{slotScopeIds:U}=ee;U&&(ve=ve?ve.concat(U):U);const J=o(K),T=y(s(K),ee,J,he,fe,ve,z);return T&&Gh(T)&&T.data==="]"?s(ee.anchor=T):(kh(),f(ee.anchor=d("]"),J,T),T)},k=(K,ee,he,fe,ve,z)=>{if(dg(K.parentElement,1)||kh(),ee.el=null,z){const T=F(K);for(;;){const D=s(K);if(D&&D!==T)u(D);else break}}const U=s(K),J=o(K);return u(K),t(null,ee,J,U,he,fe,hg(J),ve),he&&(he.vnode.el=ee.el,Vm(he,ee.el)),U},F=(K,ee="[",he="]")=>{let fe=0;for(;K;)if(K=s(K),K&&Gh(K)&&(K.data===ee&&fe++,K.data===he)){if(fe===0)return s(K);fe--}return K},I=(K,ee,he)=>{const fe=ee.parentNode;fe&&fe.replaceChild(K,ee);let ve=he;for(;ve;)ve.vnode.el===ee&&(ve.vnode.el=ve.subTree.el=K),ve=ve.parent},R=K=>K.nodeType===1&&K.tagName==="TEMPLATE";return[m,_]}const U2="data-allow-mismatch",eM={0:"text",1:"children",2:"class",3:"style",4:"attribute"};function dg(e,n){if(n===0||n===1)for(;e&&!e.hasAttribute(U2);)e=e.parentElement;const t=e&&e.getAttribute(U2);if(t==null)return!1;if(t==="")return!0;{const r=t.split(",");return n===0&&r.includes("children")?!0:t.split(",").includes(eM[n])}}const tM=km().requestIdleCallback||(e=>setTimeout(e,1)),nM=km().cancelIdleCallback||(e=>clearTimeout(e)),rM=(e=1e4)=>n=>{const t=tM(n,{timeout:e});return()=>nM(t)};function iM(e){const{top:n,left:t,bottom:r,right:i}=e.getBoundingClientRect(),{innerHeight:s,innerWidth:o}=window;return(n>0&&n<s||r>0&&r<s)&&(t>0&&t<o||i>0&&i<o)}const oM=e=>(n,t)=>{const r=new IntersectionObserver(i=>{for(const s of i)if(s.isIntersecting){r.disconnect(),n();break}},e);return t(i=>{if(i instanceof Element){if(iM(i))return n(),r.disconnect(),!1;r.observe(i)}}),()=>r.disconnect()},sM=e=>n=>{if(e){const t=matchMedia(e);if(t.matches)n();else return t.addEventListener("change",n,{once:!0}),()=>t.removeEventListener("change",n)}},aM=(e=[])=>(n,t)=>{Co(e)&&(e=[e]);let r=!1;const i=o=>{r||(r=!0,s(),n(),o.target.dispatchEvent(new o.constructor(o.type,o)))},s=()=>{t(o=>{for(const u of e)o.removeEventListener(u,i)})};return t(o=>{for(const u of e)o.addEventListener(u,i,{once:!0})}),s};function lM(e,n){if(Gh(e)&&e.data==="["){let t=1,r=e.nextSibling;for(;r;){if(r.nodeType===1){if(n(r)===!1)break}else if(Gh(r))if(r.data==="]"){if(--t===0)break}else r.data==="["&&t++;r=r.nextSibling}}else n(e)}const bf=e=>!!e.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function uM(e){Tr(e)&&(e={loader:e});const{loader:n,loadingComponent:t,errorComponent:r,delay:i=200,hydrate:s,timeout:o,suspensible:u=!0,onError:f}=e;let d=null,m,_=0;const w=()=>(_++,d=null,y()),y=()=>{let M;return d||(M=d=n().catch(k=>{if(k=k instanceof Error?k:new Error(String(k)),f)return new Promise((F,I)=>{f(k,()=>F(w()),()=>I(k),_+1)});throw k}).then(k=>M!==d&&d?d:(k&&(k.__esModule||k[Symbol.toStringTag]==="Module")&&(k=k.default),m=k,k)))};return ds({name:"AsyncComponentWrapper",__asyncLoader:y,__asyncHydrate(M,k,F){const I=s?()=>{const R=s(F,K=>lM(M,K));R&&(k.bum||(k.bum=[])).push(R)}:F;m?I():y().then(()=>!k.isUnmounted&&I())},get __asyncResolved(){return m},setup(){const M=Vs;if(Z1(M),m)return()=>z0(m,M);const k=K=>{d=null,ch(K,M,13,!r)};if(u&&M.suspense||id)return y().then(K=>()=>z0(K,M)).catch(K=>(k(K),()=>r?di(r,{error:K}):null));const F=zt(!1),I=zt(),R=zt(!!i);return i&&setTimeout(()=>{R.value=!1},i),o!=null&&setTimeout(()=>{if(!F.value&&!I.value){const K=new Error(`Async component timed out after ${o}ms.`);k(K),I.value=K}},o),y().then(()=>{F.value=!0,M.parent&&kp(M.parent.vnode)&&M.parent.update()}).catch(K=>{k(K),I.value=K}),()=>{if(F.value&&m)return z0(m,M);if(I.value&&r)return di(r,{error:I.value});if(t&&!R.value)return di(t)}}})}function z0(e,n){const{ref:t,props:r,children:i,ce:s}=n.vnode,o=di(e,r,i);return o.ref=t,o.ce=s,delete n.vnode.ce,o}const kp=e=>e.type.__isKeepAlive,cM={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(e,{slots:n}){const t=bu(),r=t.ctx;if(!r.renderer)return()=>{const R=n.default&&n.default();return R&&R.length===1?R[0]:R};const i=new Map,s=new Set;let o=null;const u=t.suspense,{renderer:{p:f,m:d,um:m,o:{createElement:_}}}=r,w=_("div");r.activate=(R,K,ee,he,fe)=>{const ve=R.component;d(R,K,ee,0,u),f(ve.vnode,R,K,ee,ve,u,he,R.slotScopeIds,fe),$s(()=>{ve.isDeactivated=!1,ve.a&&Yh(ve.a);const z=R.props&&R.props.onVnodeMounted;z&&bl(z,ve.parent,R)},u)},r.deactivate=R=>{const K=R.component;nm(K.m),nm(K.a),d(R,w,null,1,u),$s(()=>{K.da&&Yh(K.da);const ee=R.props&&R.props.onVnodeUnmounted;ee&&bl(ee,K.parent,R),K.isDeactivated=!0},u)};function y(R){$0(R),m(R,t,u,!0)}function M(R){i.forEach((K,ee)=>{const he=Uv(K.type);he&&!R(he)&&k(ee)})}function k(R){const K=i.get(R);K&&(!o||!zu(K,o))?y(K):o&&$0(o),i.delete(R),s.delete(R)}oo(()=>[e.include,e.exclude],([R,K])=>{R&&M(ee=>jd(R,ee)),K&&M(ee=>!jd(K,ee))},{flush:"post",deep:!0});let F=null;const I=()=>{F!=null&&(rm(t.subTree.type)?$s(()=>{i.set(F,pg(t.subTree))},t.subTree.suspense):i.set(F,pg(t.subTree)))};return Cs(I),$m(I),fh(()=>{i.forEach(R=>{const{subTree:K,suspense:ee}=t,he=pg(K);if(R.type===he.type&&R.key===he.key){$0(he);const fe=he.component.da;fe&&$s(fe,ee);return}y(R)})}),()=>{if(F=null,!n.default)return o=null;const R=n.default(),K=R[0];if(R.length>1)return o=null,R;if(!Vc(K)||!(K.shapeFlag&4)&&!(K.shapeFlag&128))return o=null,K;let ee=pg(K);if(ee.type===Rs)return o=null,ee;const he=ee.type,fe=Uv(bf(ee)?ee.type.__asyncResolved||{}:he),{include:ve,exclude:z,max:U}=e;if(ve&&(!fe||!jd(ve,fe))||z&&fe&&jd(z,fe))return ee.shapeFlag&=-257,o=ee,K;const J=ee.key==null?he:ee.key,T=i.get(J);return ee.el&&(ee=vc(ee),K.shapeFlag&128&&(K.ssContent=ee)),F=J,T?(ee.el=T.el,ee.component=T.component,ee.transition&&Uc(ee,ee.transition),ee.shapeFlag|=512,s.delete(J),s.add(J)):(s.add(J),U&&s.size>parseInt(U,10)&&k(s.values().next().value)),ee.shapeFlag|=256,o=ee,rm(K.type)?K:ee}}},fM=cM;function jd(e,n){return rr(e)?e.some(t=>jd(t,n)):Co(e)?e.split(",").includes(n):$C(e)?(e.lastIndex=0,e.test(n)):!1}function $w(e,n){Vw(e,"a",n)}function Uw(e,n){Vw(e,"da",n)}function Vw(e,n,t=Vs){const r=e.__wdc||(e.__wdc=()=>{let i=t;for(;i;){if(i.isDeactivated)return;i=i.parent}return e()});if(zm(n,r,t),t){let i=t.parent;for(;i&&i.parent;)kp(i.parent.vnode)&&hM(r,n,t,i),i=i.parent}}function hM(e,n,t,r){const i=zm(n,e,r,!0);mc(()=>{D1(r[n],i)},t)}function $0(e){e.shapeFlag&=-257,e.shapeFlag&=-513}function pg(e){return e.shapeFlag&128?e.ssContent:e}function zm(e,n,t=Vs,r=!1){if(t){const i=t[e]||(t[e]=[]),s=n.__weh||(n.__weh=(...o)=>{Af();const u=sh(t),f=yu(n,t,e,o);return u(),kf(),f});return r?i.unshift(s):i.push(s),s}}const qc=e=>(n,t=Vs)=>{(!id||e==="sp")&&zm(e,(...r)=>n(...r),t)},Gw=qc("bm"),Cs=qc("m"),K1=qc("bu"),$m=qc("u"),fh=qc("bum"),mc=qc("um"),Hw=qc("sp"),qw=qc("rtg"),Ww=qc("rtc");function Zw(e,n=Vs){zm("ec",e,n)}const Y1="components",dM="directives";function Kw(e,n){return J1(Y1,e,!0,n)||e}const Yw=Symbol.for("v-ndc");function pM(e){return Co(e)?J1(Y1,e,!1)||e:e||Yw}function gM(e){return J1(dM,e)}function J1(e,n,t=!0,r=!1){const i=Gs||Vs;if(i){const s=i.type;if(e===Y1){const u=Uv(s,!1);if(u&&(u===n||u===ga(n)||u===Ap(ga(n))))return s}const o=V2(i[e]||s[e],n)||V2(i.appContext[e],n);return!o&&r?s:o}}function V2(e,n){return e&&(e[n]||e[ga(n)]||e[Ap(ga(n))])}function Lr(e,n,t,r){let i;const s=t&&t[r],o=rr(e);if(o||Co(e)){const u=o&&dc(e);let f=!1;u&&(f=!Wl(e),e=Dm(e)),i=new Array(e.length);for(let d=0,m=e.length;d<m;d++)i[d]=n(f?Oa(e[d]):e[d],d,void 0,s&&s[d])}else if(typeof e=="number"){i=new Array(e);for(let u=0;u<e;u++)i[u]=n(u+1,u,void 0,s&&s[u])}else if(ao(e))if(e[Symbol.iterator])i=Array.from(e,(u,f)=>n(u,f,void 0,s&&s[f]));else{const u=Object.keys(e);i=new Array(u.length);for(let f=0,d=u.length;f<d;f++){const m=u[f];i[f]=n(e[m],m,f,s&&s[f])}}else i=[];return t&&(t[r]=i),i}function mM(e,n){for(let t=0;t<n.length;t++){const r=n[t];if(rr(r))for(let i=0;i<r.length;i++)e[r[i].name]=r[i].fn;else r&&(e[r.name]=r.key?(...i)=>{const s=r.fn(...i);return s&&(s.key=r.key),s}:r.fn)}return e}function vM(e,n,t={},r,i){if(Gs.ce||Gs.parent&&bf(Gs.parent)&&Gs.parent.ce)return n!=="default"&&(t.name=n),$e(),rl(Tn,null,[di("slot",t,r&&r())],64);let s=e[n];s&&s._c&&(s._d=!1),$e();const o=s&&X1(s(t)),u=t.key||o&&o.key,f=rl(Tn,{key:(u&&!Gu(u)?u:`_${n}`)+(!o&&r?"_fb":"")},o||(r?r():[]),o&&e._===1?64:-2);return!i&&f.scopeId&&(f.slotScopeIds=[f.scopeId+"-s"]),s&&s._c&&(s._d=!0),f}function X1(e){return e.some(n=>Vc(n)?!(n.type===Rs||n.type===Tn&&!X1(n.children)):!0)?e:null}function yM(e,n){const t={};for(const r in e)t[n&&/[A-Z]/.test(r)?`on:${r}`:Kd(r)]=e[r];return t}const Tv=e=>e?A4(e)?Np(e):Tv(e.parent):null,Qd=yo(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Tv(e.parent),$root:e=>Tv(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>Q1(e),$forceUpdate:e=>e.f||(e.f=()=>{H1(e.update)}),$nextTick:e=>e.n||(e.n=Us.bind(e.proxy)),$watch:e=>ZM.bind(e)}),U0=(e,n)=>e!==Ii&&!e.__isScriptSetup&&Ji(e,n),Nv={get({_:e},n){if(n==="__v_skip")return!0;const{ctx:t,setupState:r,data:i,props:s,accessCache:o,type:u,appContext:f}=e;let d;if(n[0]!=="$"){const y=o[n];if(y!==void 0)switch(y){case 1:return r[n];case 2:return i[n];case 4:return t[n];case 3:return s[n]}else{if(U0(r,n))return o[n]=1,r[n];if(i!==Ii&&Ji(i,n))return o[n]=2,i[n];if((d=e.propsOptions[0])&&Ji(d,n))return o[n]=3,s[n];if(t!==Ii&&Ji(t,n))return o[n]=4,t[n];Dv&&(o[n]=0)}}const m=Qd[n];let _,w;if(m)return n==="$attrs"&&Ia(e.attrs,"get",""),m(e);if((_=u.__cssModules)&&(_=_[n]))return _;if(t!==Ii&&Ji(t,n))return o[n]=4,t[n];if(w=f.config.globalProperties,Ji(w,n))return w[n]},set({_:e},n,t){const{data:r,setupState:i,ctx:s}=e;return U0(i,n)?(i[n]=t,!0):r!==Ii&&Ji(r,n)?(r[n]=t,!0):Ji(e.props,n)||n[0]==="$"&&n.slice(1)in e?!1:(s[n]=t,!0)},has({_:{data:e,setupState:n,accessCache:t,ctx:r,appContext:i,propsOptions:s}},o){let u;return!!t[o]||e!==Ii&&Ji(e,o)||U0(n,o)||(u=s[0])&&Ji(u,o)||Ji(r,o)||Ji(Qd,o)||Ji(i.config.globalProperties,o)},defineProperty(e,n,t){return t.get!=null?e._.accessCache[n]=0:Ji(t,"value")&&this.set(e,n,t.value,null),Reflect.defineProperty(e,n,t)}},_M=yo({},Nv,{get(e,n){if(n!==Symbol.unscopables)return Nv.get(e,n,e)},has(e,n){return n[0]!=="_"&&!qC(n)}});function bM(){return null}function wM(){return null}function xM(e){}function LM(e){}function SM(){return null}function EM(){}function CM(e,n){return null}function PM(){return Jw().slots}function MM(){return Jw().attrs}function Jw(){const e=bu();return e.setupContext||(e.setupContext=N4(e))}function bp(e){return rr(e)?e.reduce((n,t)=>(n[t]=null,n),{}):e}function AM(e,n){const t=bp(e);for(const r in n){if(r.startsWith("__skip"))continue;let i=t[r];i?rr(i)||Tr(i)?i=t[r]={type:i,default:n[r]}:i.default=n[r]:i===null&&(i=t[r]={default:n[r]}),i&&n[`__skip_${r}`]&&(i.skipFactory=!0)}return t}function kM(e,n){return!e||!n?e||n:rr(e)&&rr(n)?e.concat(n):yo({},bp(e),bp(n))}function TM(e,n){const t={};for(const r in e)n.includes(r)||Object.defineProperty(t,r,{enumerable:!0,get:()=>e[r]});return t}function NM(e){const n=bu();let t=e();return jv(),I1(t)&&(t=t.catch(r=>{throw sh(n),r})),[t,()=>sh(n)]}let Dv=!0;function DM(e){const n=Q1(e),t=e.proxy,r=e.ctx;Dv=!1,n.beforeCreate&&G2(n.beforeCreate,e,"bc");const{data:i,computed:s,methods:o,watch:u,provide:f,inject:d,created:m,beforeMount:_,mounted:w,beforeUpdate:y,updated:M,activated:k,deactivated:F,beforeDestroy:I,beforeUnmount:R,destroyed:K,unmounted:ee,render:he,renderTracked:fe,renderTriggered:ve,errorCaptured:z,serverPrefetch:U,expose:J,inheritAttrs:T,components:D,directives:B,filters:$}=n;if(d&&IM(d,r,null),o)for(const oe in o){const ie=o[oe];Tr(ie)&&(r[oe]=ie.bind(t))}if(i){const oe=i.call(t,t);ao(oe)&&(e.data=Yl(oe))}if(Dv=!0,s)for(const oe in s){const ie=s[oe],we=Tr(ie)?ie.bind(t,t):Tr(ie.get)?ie.get.bind(t,t):gu,Ce=!Tr(ie)&&Tr(ie.set)?ie.set.bind(t):gu,Te=sr({get:we,set:Ce});Object.defineProperty(r,oe,{enumerable:!0,configurable:!0,get:()=>Te.value,set:Y=>Te.value=Y})}if(u)for(const oe in u)Xw(u[oe],r,t,oe);if(f){const oe=Tr(f)?f.call(t):f;Reflect.ownKeys(oe).forEach(ie=>{ep(ie,oe[ie])})}m&&G2(m,e,"c");function G(oe,ie){rr(ie)?ie.forEach(we=>oe(we.bind(t))):ie&&oe(ie.bind(t))}if(G(Gw,_),G(Cs,w),G(K1,y),G($m,M),G($w,k),G(Uw,F),G(Zw,z),G(Ww,fe),G(qw,ve),G(fh,R),G(mc,ee),G(Hw,U),rr(J))if(J.length){const oe=e.exposed||(e.exposed={});J.forEach(ie=>{Object.defineProperty(oe,ie,{get:()=>t[ie],set:we=>t[ie]=we})})}else e.exposed||(e.exposed={});he&&e.render===gu&&(e.render=he),T!=null&&(e.inheritAttrs=T),D&&(e.components=D),B&&(e.directives=B),U&&Z1(e)}function IM(e,n,t=gu){rr(e)&&(e=Iv(e));for(const r in e){const i=e[r];let s;ao(i)?"default"in i?s=Zl(i.from||r,i.default,!0):s=Zl(i.from||r):s=Zl(i),Xo(s)?Object.defineProperty(n,r,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):n[r]=s}}function G2(e,n,t){yu(rr(e)?e.map(r=>r.bind(n.proxy)):e.bind(n.proxy),n,t)}function Xw(e,n,t,r){let i=r.includes(".")?y4(t,r):()=>t[r];if(Co(e)){const s=n[e];Tr(s)&&oo(i,s)}else if(Tr(e))oo(i,e.bind(t));else if(ao(e))if(rr(e))e.forEach(s=>Xw(s,n,t,r));else{const s=Tr(e.handler)?e.handler.bind(t):n[e.handler];Tr(s)&&oo(i,s,e)}}function Q1(e){const n=e.type,{mixins:t,extends:r}=n,{mixins:i,optionsCache:s,config:{optionMergeStrategies:o}}=e.appContext,u=s.get(n);let f;return u?f=u:!i.length&&!t&&!r?f=n:(f={},i.length&&i.forEach(d=>tm(f,d,o,!0)),tm(f,n,o)),ao(n)&&s.set(n,f),f}function tm(e,n,t,r=!1){const{mixins:i,extends:s}=n;s&&tm(e,s,t,!0),i&&i.forEach(o=>tm(e,o,t,!0));for(const o in n)if(!(r&&o==="expose")){const u=OM[o]||t&&t[o];e[o]=u?u(e[o],n[o]):n[o]}return e}const OM={data:H2,props:q2,emits:q2,methods:zd,computed:zd,beforeCreate:Ya,created:Ya,beforeMount:Ya,mounted:Ya,beforeUpdate:Ya,updated:Ya,beforeDestroy:Ya,beforeUnmount:Ya,destroyed:Ya,unmounted:Ya,activated:Ya,deactivated:Ya,errorCaptured:Ya,serverPrefetch:Ya,components:zd,directives:zd,watch:RM,provide:H2,inject:BM};function H2(e,n){return n?e?function(){return yo(Tr(e)?e.call(this,this):e,Tr(n)?n.call(this,this):n)}:n:e}function BM(e,n){return zd(Iv(e),Iv(n))}function Iv(e){if(rr(e)){const n={};for(let t=0;t<e.length;t++)n[e[t]]=e[t];return n}return e}function Ya(e,n){return e?[...new Set([].concat(e,n))]:n}function zd(e,n){return e?yo(Object.create(null),e,n):n}function q2(e,n){return e?rr(e)&&rr(n)?[...new Set([...e,...n])]:yo(Object.create(null),bp(e),bp(n??{})):n}function RM(e,n){if(!e)return n;if(!n)return e;const t=yo(Object.create(null),e);for(const r in n)t[r]=Ya(e[r],n[r]);return t}function Qw(){return{app:null,config:{isNativeTag:jC,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let FM=0;function jM(e,n){return function(r,i=null){Tr(r)||(r=yo({},r)),i!=null&&!ao(i)&&(i=null);const s=Qw(),o=new WeakSet,u=[];let f=!1;const d=s.app={_uid:FM++,_component:r,_props:i,_container:null,_context:s,_instance:null,version:I4,get config(){return s.config},set config(m){},use(m,..._){return o.has(m)||(m&&Tr(m.install)?(o.add(m),m.install(d,..._)):Tr(m)&&(o.add(m),m(d,..._))),d},mixin(m){return s.mixins.includes(m)||s.mixins.push(m),d},component(m,_){return _?(s.components[m]=_,d):s.components[m]},directive(m,_){return _?(s.directives[m]=_,d):s.directives[m]},mount(m,_,w){if(!f){const y=d._ceVNode||di(r,i);return y.appContext=s,w===!0?w="svg":w===!1&&(w=void 0),_&&n?n(y,m):e(y,m,w),f=!0,d._container=m,m.__vue_app__=d,Np(y.component)}},onUnmount(m){u.push(m)},unmount(){f&&(yu(u,d._instance,16),e(null,d._container),delete d._container.__vue_app__)},provide(m,_){return s.provides[m]=_,d},runWithContext(m){const _=eh;eh=d;try{return m()}finally{eh=_}}};return d}}let eh=null;function ep(e,n){if(Vs){let t=Vs.provides;const r=Vs.parent&&Vs.parent.provides;r===t&&(t=Vs.provides=Object.create(r)),t[e]=n}}function Zl(e,n,t=!1){const r=Vs||Gs;if(r||eh){const i=eh?eh._context.provides:r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(i&&e in i)return i[e];if(arguments.length>1)return t&&Tr(n)?n.call(r&&r.proxy):n}}function e4(){return!!(Vs||Gs||eh)}const t4={},n4=()=>Object.create(t4),r4=e=>Object.getPrototypeOf(e)===t4;function zM(e,n,t,r=!1){const i={},s=n4();e.propsDefaults=Object.create(null),i4(e,n,i,s);for(const o in e.propsOptions[0])o in i||(i[o]=void 0);t?e.props=r?i:U1(i):e.type.props?e.props=i:e.props=s,e.attrs=s}function $M(e,n,t,r){const{props:i,attrs:s,vnode:{patchFlag:o}}=e,u=Di(i),[f]=e.propsOptions;let d=!1;if((r||o>0)&&!(o&16)){if(o&8){const m=e.vnode.dynamicProps;for(let _=0;_<m.length;_++){let w=m[_];if(Um(e.emitsOptions,w))continue;const y=n[w];if(f)if(Ji(s,w))y!==s[w]&&(s[w]=y,d=!0);else{const M=ga(w);i[M]=Ov(f,u,M,y,e,!1)}else y!==s[w]&&(s[w]=y,d=!0)}}}else{i4(e,n,i,s)&&(d=!0);let m;for(const _ in u)(!n||!Ji(n,_)&&((m=Sl(_))===_||!Ji(n,m)))&&(f?t&&(t[_]!==void 0||t[m]!==void 0)&&(i[_]=Ov(f,u,_,void 0,e,!0)):delete i[_]);if(s!==u)for(const _ in s)(!n||!Ji(n,_))&&(delete s[_],d=!0)}d&&Rc(e.attrs,"set","")}function i4(e,n,t,r){const[i,s]=e.propsOptions;let o=!1,u;if(n)for(let f in n){if(Kh(f))continue;const d=n[f];let m;i&&Ji(i,m=ga(f))?!s||!s.includes(m)?t[m]=d:(u||(u={}))[m]=d:Um(e.emitsOptions,f)||(!(f in r)||d!==r[f])&&(r[f]=d,o=!0)}if(s){const f=Di(t),d=u||Ii;for(let m=0;m<s.length;m++){const _=s[m];t[_]=Ov(i,f,_,d[_],e,!Ji(d,_))}}return o}function Ov(e,n,t,r,i,s){const o=e[t];if(o!=null){const u=Ji(o,"default");if(u&&r===void 0){const f=o.default;if(o.type!==Function&&!o.skipFactory&&Tr(f)){const{propsDefaults:d}=i;if(t in d)r=d[t];else{const m=sh(i);r=d[t]=f.call(null,n),m()}}else r=f;i.ce&&i.ce._setProp(t,r)}o[0]&&(s&&!u?r=!1:o[1]&&(r===""||r===Sl(t))&&(r=!0))}return r}const UM=new WeakMap;function o4(e,n,t=!1){const r=t?UM:n.propsCache,i=r.get(e);if(i)return i;const s=e.props,o={},u=[];let f=!1;if(!Tr(e)){const m=_=>{f=!0;const[w,y]=o4(_,n,!0);yo(o,w),y&&u.push(...y)};!t&&n.mixins.length&&n.mixins.forEach(m),e.extends&&m(e.extends),e.mixins&&e.mixins.forEach(m)}if(!s&&!f)return ao(e)&&r.set(e,Wh),Wh;if(rr(s))for(let m=0;m<s.length;m++){const _=ga(s[m]);W2(_)&&(o[_]=Ii)}else if(s)for(const m in s){const _=ga(m);if(W2(_)){const w=s[m],y=o[_]=rr(w)||Tr(w)?{type:w}:yo({},w),M=y.type;let k=!1,F=!0;if(rr(M))for(let I=0;I<M.length;++I){const R=M[I],K=Tr(R)&&R.name;if(K==="Boolean"){k=!0;break}else K==="String"&&(F=!1)}else k=Tr(M)&&M.name==="Boolean";y[0]=k,y[1]=F,(k||Ji(y,"default"))&&u.push(_)}}const d=[o,u];return ao(e)&&r.set(e,d),d}function W2(e){return e[0]!=="$"&&!Kh(e)}const s4=e=>e[0]==="_"||e==="$stable",ey=e=>rr(e)?e.map(Ll):[Ll(e)],VM=(e,n,t)=>{if(n._n)return n;const r=pu((...i)=>ey(n(...i)),t);return r._c=!1,r},a4=(e,n,t)=>{const r=e._ctx;for(const i in e){if(s4(i))continue;const s=e[i];if(Tr(s))n[i]=VM(i,s,r);else if(s!=null){const o=ey(s);n[i]=()=>o}}},l4=(e,n)=>{const t=ey(n);e.slots.default=()=>t},u4=(e,n,t)=>{for(const r in n)(t||r!=="_")&&(e[r]=n[r])},GM=(e,n,t)=>{const r=e.slots=n4();if(e.vnode.shapeFlag&32){const i=n._;i?(u4(r,n,t),t&&rw(r,"_",i,!0)):a4(n,r)}else n&&l4(e,n)},HM=(e,n,t)=>{const{vnode:r,slots:i}=e;let s=!0,o=Ii;if(r.shapeFlag&32){const u=n._;u?t&&u===1?s=!1:u4(i,n,t):(s=!n.$stable,a4(n,i)),o=n}else n&&(l4(e,n),o={default:1});if(s)for(const u in i)!s4(u)&&o[u]==null&&delete i[u]},$s=x4;function c4(e){return h4(e)}function f4(e){return h4(e,QP)}function h4(e,n){const t=km();t.__VUE__=!0;const{insert:r,remove:i,patchProp:s,createElement:o,createText:u,createComment:f,setText:d,setElementText:m,parentNode:_,nextSibling:w,setScopeId:y=gu,insertStaticContent:M}=e,k=(ce,ne,ye,de=null,We=null,Ge=null,tt=void 0,Ze=null,et=!!ne.dynamicChildren)=>{if(ce===ne)return;ce&&!zu(ce,ne)&&(de=pe(ce),Y(ce,We,Ge,!0),ce=null),ne.patchFlag===-2&&(et=!1,ne.dynamicChildren=null);const{type:He,ref:wt,shapeFlag:Pt}=ne;switch(He){case wf:F(ce,ne,ye,de);break;case Rs:I(ce,ne,ye,de);break;case th:ce==null&&R(ne,ye,de,tt);break;case Tn:D(ce,ne,ye,de,We,Ge,tt,Ze,et);break;default:Pt&1?he(ce,ne,ye,de,We,Ge,tt,Ze,et):Pt&6?B(ce,ne,ye,de,We,Ge,tt,Ze,et):(Pt&64||Pt&128)&&He.process(ce,ne,ye,de,We,Ge,tt,Ze,et,ke)}wt!=null&&We&&_p(wt,ce&&ce.ref,Ge,ne||ce,!ne)},F=(ce,ne,ye,de)=>{if(ce==null)r(ne.el=u(ne.children),ye,de);else{const We=ne.el=ce.el;ne.children!==ce.children&&d(We,ne.children)}},I=(ce,ne,ye,de)=>{ce==null?r(ne.el=f(ne.children||""),ye,de):ne.el=ce.el},R=(ce,ne,ye,de)=>{[ce.el,ce.anchor]=M(ce.children,ne,ye,de,ce.el,ce.anchor)},K=({el:ce,anchor:ne},ye,de)=>{let We;for(;ce&&ce!==ne;)We=w(ce),r(ce,ye,de),ce=We;r(ne,ye,de)},ee=({el:ce,anchor:ne})=>{let ye;for(;ce&&ce!==ne;)ye=w(ce),i(ce),ce=ye;i(ne)},he=(ce,ne,ye,de,We,Ge,tt,Ze,et)=>{ne.type==="svg"?tt="svg":ne.type==="math"&&(tt="mathml"),ce==null?fe(ne,ye,de,We,Ge,tt,Ze,et):U(ce,ne,We,Ge,tt,Ze,et)},fe=(ce,ne,ye,de,We,Ge,tt,Ze)=>{let et,He;const{props:wt,shapeFlag:Pt,transition:kt,dirs:Jt}=ce;if(et=ce.el=o(ce.type,Ge,wt&&wt.is,wt),Pt&8?m(et,ce.children):Pt&16&&z(ce.children,et,null,de,We,V0(ce,Ge),tt,Ze),Jt&&uc(ce,null,de,"created"),ve(et,ce,ce.scopeId,tt,de),wt){for(const un in wt)un!=="value"&&!Kh(un)&&s(et,un,null,wt[un],Ge,de);"value"in wt&&s(et,"value",null,wt.value,Ge),(He=wt.onVnodeBeforeMount)&&bl(He,de,ce)}Jt&&uc(ce,null,de,"beforeMount");const rn=d4(We,kt);rn&&kt.beforeEnter(et),r(et,ne,ye),((He=wt&&wt.onVnodeMounted)||rn||Jt)&&$s(()=>{He&&bl(He,de,ce),rn&&kt.enter(et),Jt&&uc(ce,null,de,"mounted")},We)},ve=(ce,ne,ye,de,We)=>{if(ye&&y(ce,ye),de)for(let Ge=0;Ge<de.length;Ge++)y(ce,de[Ge]);if(We){let Ge=We.subTree;if(ne===Ge||rm(Ge.type)&&(Ge.ssContent===ne||Ge.ssFallback===ne)){const tt=We.vnode;ve(ce,tt,tt.scopeId,tt.slotScopeIds,We.parent)}}},z=(ce,ne,ye,de,We,Ge,tt,Ze,et=0)=>{for(let He=et;He<ce.length;He++){const wt=ce[He]=Ze?hf(ce[He]):Ll(ce[He]);k(null,wt,ne,ye,de,We,Ge,tt,Ze)}},U=(ce,ne,ye,de,We,Ge,tt)=>{const Ze=ne.el=ce.el;let{patchFlag:et,dynamicChildren:He,dirs:wt}=ne;et|=ce.patchFlag&16;const Pt=ce.props||Ii,kt=ne.props||Ii;let Jt;if(ye&&$f(ye,!1),(Jt=kt.onVnodeBeforeUpdate)&&bl(Jt,ye,ne,ce),wt&&uc(ne,ce,ye,"beforeUpdate"),ye&&$f(ye,!0),(Pt.innerHTML&&kt.innerHTML==null||Pt.textContent&&kt.textContent==null)&&m(Ze,""),He?J(ce.dynamicChildren,He,Ze,ye,de,V0(ne,We),Ge):tt||ie(ce,ne,Ze,null,ye,de,V0(ne,We),Ge,!1),et>0){if(et&16)T(Ze,Pt,kt,ye,We);else if(et&2&&Pt.class!==kt.class&&s(Ze,"class",null,kt.class,We),et&4&&s(Ze,"style",Pt.style,kt.style,We),et&8){const rn=ne.dynamicProps;for(let un=0;un<rn.length;un++){const Ke=rn[un],ot=Pt[Ke],rt=kt[Ke];(rt!==ot||Ke==="value")&&s(Ze,Ke,ot,rt,We,ye)}}et&1&&ce.children!==ne.children&&m(Ze,ne.children)}else!tt&&He==null&&T(Ze,Pt,kt,ye,We);((Jt=kt.onVnodeUpdated)||wt)&&$s(()=>{Jt&&bl(Jt,ye,ne,ce),wt&&uc(ne,ce,ye,"updated")},de)},J=(ce,ne,ye,de,We,Ge,tt)=>{for(let Ze=0;Ze<ne.length;Ze++){const et=ce[Ze],He=ne[Ze],wt=et.el&&(et.type===Tn||!zu(et,He)||et.shapeFlag&70)?_(et.el):ye;k(et,He,wt,null,de,We,Ge,tt,!0)}},T=(ce,ne,ye,de,We)=>{if(ne!==ye){if(ne!==Ii)for(const Ge in ne)!Kh(Ge)&&!(Ge in ye)&&s(ce,Ge,ne[Ge],null,We,de);for(const Ge in ye){if(Kh(Ge))continue;const tt=ye[Ge],Ze=ne[Ge];tt!==Ze&&Ge!=="value"&&s(ce,Ge,Ze,tt,We,de)}"value"in ye&&s(ce,"value",ne.value,ye.value,We)}},D=(ce,ne,ye,de,We,Ge,tt,Ze,et)=>{const He=ne.el=ce?ce.el:u(""),wt=ne.anchor=ce?ce.anchor:u("");let{patchFlag:Pt,dynamicChildren:kt,slotScopeIds:Jt}=ne;Jt&&(Ze=Ze?Ze.concat(Jt):Jt),ce==null?(r(He,ye,de),r(wt,ye,de),z(ne.children||[],ye,wt,We,Ge,tt,Ze,et)):Pt>0&&Pt&64&&kt&&ce.dynamicChildren?(J(ce.dynamicChildren,kt,ye,We,Ge,tt,Ze),(ne.key!=null||We&&ne===We.subTree)&&ty(ce,ne,!0)):ie(ce,ne,ye,wt,We,Ge,tt,Ze,et)},B=(ce,ne,ye,de,We,Ge,tt,Ze,et)=>{ne.slotScopeIds=Ze,ce==null?ne.shapeFlag&512?We.ctx.activate(ne,ye,de,tt,et):$(ne,ye,de,We,Ge,tt,et):W(ce,ne,et)},$=(ce,ne,ye,de,We,Ge,tt)=>{const Ze=ce.component=M4(ce,de,We);if(kp(ce)&&(Ze.ctx.renderer=ke),k4(Ze,!1,tt),Ze.asyncDep){if(We&&We.registerDep(Ze,G,tt),!ce.el){const et=Ze.subTree=di(Rs);I(null,et,ne,ye)}}else G(Ze,ce,ne,ye,We,Ge,tt)},W=(ce,ne,ye)=>{const de=ne.component=ce.component;if(eA(ce,ne,ye))if(de.asyncDep&&!de.asyncResolved){oe(de,ne,ye);return}else de.next=ne,de.update();else ne.el=ce.el,de.vnode=ne},G=(ce,ne,ye,de,We,Ge,tt)=>{const Ze=()=>{if(ce.isMounted){let{next:Pt,bu:kt,u:Jt,parent:rn,vnode:un}=ce;{const Qt=p4(ce);if(Qt){Pt&&(Pt.el=un.el,oe(ce,Pt,tt)),Qt.asyncDep.then(()=>{ce.isUnmounted||Ze()});return}}let Ke=Pt,ot;$f(ce,!1),Pt?(Pt.el=un.el,oe(ce,Pt,tt)):Pt=un,kt&&Yh(kt),(ot=Pt.props&&Pt.props.onVnodeBeforeUpdate)&&bl(ot,rn,Pt,un),$f(ce,!0);const rt=kg(ce),Ft=ce.subTree;ce.subTree=rt,k(Ft,rt,_(Ft.el),pe(Ft),ce,We,Ge),Pt.el=rt.el,Ke===null&&Vm(ce,rt.el),Jt&&$s(Jt,We),(ot=Pt.props&&Pt.props.onVnodeUpdated)&&$s(()=>bl(ot,rn,Pt,un),We)}else{let Pt;const{el:kt,props:Jt}=ne,{bm:rn,m:un,parent:Ke,root:ot,type:rt}=ce,Ft=bf(ne);if($f(ce,!1),rn&&Yh(rn),!Ft&&(Pt=Jt&&Jt.onVnodeBeforeMount)&&bl(Pt,Ke,ne),$f(ce,!0),kt&&Ue){const Qt=()=>{ce.subTree=kg(ce),Ue(kt,ce.subTree,ce,We,null)};Ft&&rt.__asyncHydrate?rt.__asyncHydrate(kt,ce,Qt):Qt()}else{ot.ce&&ot.ce._injectChildStyle(rt);const Qt=ce.subTree=kg(ce);k(null,Qt,ye,de,ce,We,Ge),ne.el=Qt.el}if(un&&$s(un,We),!Ft&&(Pt=Jt&&Jt.onVnodeMounted)){const Qt=ne;$s(()=>bl(Pt,Ke,Qt),We)}(ne.shapeFlag&256||Ke&&bf(Ke.vnode)&&Ke.vnode.shapeFlag&256)&&ce.a&&$s(ce.a,We),ce.isMounted=!0,ne=ye=de=null}};ce.scope.on();const et=ce.effect=new dp(Ze);ce.scope.off();const He=ce.update=et.run.bind(et),wt=ce.job=et.runIfDirty.bind(et);wt.i=ce,wt.id=ce.uid,et.scheduler=()=>H1(wt),$f(ce,!0),He()},oe=(ce,ne,ye)=>{ne.component=ce;const de=ce.vnode.props;ce.vnode=ne,ce.next=null,$M(ce,ne.props,de,ye),HM(ce,ne.children,ye),Af(),B2(ce),kf()},ie=(ce,ne,ye,de,We,Ge,tt,Ze,et=!1)=>{const He=ce&&ce.children,wt=ce?ce.shapeFlag:0,Pt=ne.children,{patchFlag:kt,shapeFlag:Jt}=ne;if(kt>0){if(kt&128){Ce(He,Pt,ye,de,We,Ge,tt,Ze,et);return}else if(kt&256){we(He,Pt,ye,de,We,Ge,tt,Ze,et);return}}Jt&8?(wt&16&&le(He,We,Ge),Pt!==He&&m(ye,Pt)):wt&16?Jt&16?Ce(He,Pt,ye,de,We,Ge,tt,Ze,et):le(He,We,Ge,!0):(wt&8&&m(ye,""),Jt&16&&z(Pt,ye,de,We,Ge,tt,Ze,et))},we=(ce,ne,ye,de,We,Ge,tt,Ze,et)=>{ce=ce||Wh,ne=ne||Wh;const He=ce.length,wt=ne.length,Pt=Math.min(He,wt);let kt;for(kt=0;kt<Pt;kt++){const Jt=ne[kt]=et?hf(ne[kt]):Ll(ne[kt]);k(ce[kt],Jt,ye,null,We,Ge,tt,Ze,et)}He>wt?le(ce,We,Ge,!0,!1,Pt):z(ne,ye,de,We,Ge,tt,Ze,et,Pt)},Ce=(ce,ne,ye,de,We,Ge,tt,Ze,et)=>{let He=0;const wt=ne.length;let Pt=ce.length-1,kt=wt-1;for(;He<=Pt&&He<=kt;){const Jt=ce[He],rn=ne[He]=et?hf(ne[He]):Ll(ne[He]);if(zu(Jt,rn))k(Jt,rn,ye,null,We,Ge,tt,Ze,et);else break;He++}for(;He<=Pt&&He<=kt;){const Jt=ce[Pt],rn=ne[kt]=et?hf(ne[kt]):Ll(ne[kt]);if(zu(Jt,rn))k(Jt,rn,ye,null,We,Ge,tt,Ze,et);else break;Pt--,kt--}if(He>Pt){if(He<=kt){const Jt=kt+1,rn=Jt<wt?ne[Jt].el:de;for(;He<=kt;)k(null,ne[He]=et?hf(ne[He]):Ll(ne[He]),ye,rn,We,Ge,tt,Ze,et),He++}}else if(He>kt)for(;He<=Pt;)Y(ce[He],We,Ge,!0),He++;else{const Jt=He,rn=He,un=new Map;for(He=rn;He<=kt;He++){const Nn=ne[He]=et?hf(ne[He]):Ll(ne[He]);Nn.key!=null&&un.set(Nn.key,He)}let Ke,ot=0;const rt=kt-rn+1;let Ft=!1,Qt=0;const Bn=new Array(rt);for(He=0;He<rt;He++)Bn[He]=0;for(He=Jt;He<=Pt;He++){const Nn=ce[He];if(ot>=rt){Y(Nn,We,Ge,!0);continue}let ar;if(Nn.key!=null)ar=un.get(Nn.key);else for(Ke=rn;Ke<=kt;Ke++)if(Bn[Ke-rn]===0&&zu(Nn,ne[Ke])){ar=Ke;break}ar===void 0?Y(Nn,We,Ge,!0):(Bn[ar-rn]=He+1,ar>=Qt?Qt=ar:Ft=!0,k(Nn,ne[ar],ye,null,We,Ge,tt,Ze,et),ot++)}const Ln=Ft?qM(Bn):Wh;for(Ke=Ln.length-1,He=rt-1;He>=0;He--){const Nn=rn+He,ar=ne[Nn],En=Nn+1<wt?ne[Nn+1].el:de;Bn[He]===0?k(null,ar,ye,En,We,Ge,tt,Ze,et):Ft&&(Ke<0||He!==Ln[Ke]?Te(ar,ye,En,2):Ke--)}}},Te=(ce,ne,ye,de,We=null)=>{const{el:Ge,type:tt,transition:Ze,children:et,shapeFlag:He}=ce;if(He&6){Te(ce.component.subTree,ne,ye,de);return}if(He&128){ce.suspense.move(ne,ye,de);return}if(He&64){tt.move(ce,ne,ye,ke);return}if(tt===Tn){r(Ge,ne,ye);for(let Pt=0;Pt<et.length;Pt++)Te(et[Pt],ne,ye,de);r(ce.anchor,ne,ye);return}if(tt===th){K(ce,ne,ye);return}if(de!==2&&He&1&&Ze)if(de===0)Ze.beforeEnter(Ge),r(Ge,ne,ye),$s(()=>Ze.enter(Ge),We);else{const{leave:Pt,delayLeave:kt,afterLeave:Jt}=Ze,rn=()=>r(Ge,ne,ye),un=()=>{Pt(Ge,()=>{rn(),Jt&&Jt()})};kt?kt(Ge,rn,un):un()}else r(Ge,ne,ye)},Y=(ce,ne,ye,de=!1,We=!1)=>{const{type:Ge,props:tt,ref:Ze,children:et,dynamicChildren:He,shapeFlag:wt,patchFlag:Pt,dirs:kt,cacheIndex:Jt}=ce;if(Pt===-2&&(We=!1),Ze!=null&&_p(Ze,null,ye,ce,!0),Jt!=null&&(ne.renderCache[Jt]=void 0),wt&256){ne.ctx.deactivate(ce);return}const rn=wt&1&&kt,un=!bf(ce);let Ke;if(un&&(Ke=tt&&tt.onVnodeBeforeUnmount)&&bl(Ke,ne,ce),wt&6)ue(ce.component,ye,de);else{if(wt&128){ce.suspense.unmount(ye,de);return}rn&&uc(ce,null,ne,"beforeUnmount"),wt&64?ce.type.remove(ce,ne,ye,ke,de):He&&!He.hasOnce&&(Ge!==Tn||Pt>0&&Pt&64)?le(He,ne,ye,!1,!0):(Ge===Tn&&Pt&384||!We&&wt&16)&&le(et,ne,ye),de&&H(ce)}(un&&(Ke=tt&&tt.onVnodeUnmounted)||rn)&&$s(()=>{Ke&&bl(Ke,ne,ce),rn&&uc(ce,null,ne,"unmounted")},ye)},H=ce=>{const{type:ne,el:ye,anchor:de,transition:We}=ce;if(ne===Tn){Q(ye,de);return}if(ne===th){ee(ce);return}const Ge=()=>{i(ye),We&&!We.persisted&&We.afterLeave&&We.afterLeave()};if(ce.shapeFlag&1&&We&&!We.persisted){const{leave:tt,delayLeave:Ze}=We,et=()=>tt(ye,Ge);Ze?Ze(ce.el,Ge,et):et()}else Ge()},Q=(ce,ne)=>{let ye;for(;ce!==ne;)ye=w(ce),i(ce),ce=ye;i(ne)},ue=(ce,ne,ye)=>{const{bum:de,scope:We,job:Ge,subTree:tt,um:Ze,m:et,a:He}=ce;nm(et),nm(He),de&&Yh(de),We.stop(),Ge&&(Ge.flags|=8,Y(tt,ce,ne,ye)),Ze&&$s(Ze,ne),$s(()=>{ce.isUnmounted=!0},ne),ne&&ne.pendingBranch&&!ne.isUnmounted&&ce.asyncDep&&!ce.asyncResolved&&ce.suspenseId===ne.pendingId&&(ne.deps--,ne.deps===0&&ne.resolve())},le=(ce,ne,ye,de=!1,We=!1,Ge=0)=>{for(let tt=Ge;tt<ce.length;tt++)Y(ce[tt],ne,ye,de,We)},pe=ce=>{if(ce.shapeFlag&6)return pe(ce.component.subTree);if(ce.shapeFlag&128)return ce.suspense.next();const ne=w(ce.anchor||ce.el),ye=ne&&ne[Dw];return ye?w(ye):ne};let Z=!1;const N=(ce,ne,ye)=>{ce==null?ne._vnode&&Y(ne._vnode,null,null,!0):k(ne._vnode||null,ce,ne,null,null,null,ye),ne._vnode=ce,Z||(Z=!0,B2(),em(),Z=!1)},ke={p:k,um:Y,m:Te,r:H,mt:$,mc:z,pc:ie,pbc:J,n:pe,o:e};let Me,Ue;return n&&([Me,Ue]=n(ke)),{render:N,hydrate:Me,createApp:jM(N,Me)}}function V0({type:e,props:n},t){return t==="svg"&&e==="foreignObject"||t==="mathml"&&e==="annotation-xml"&&n&&n.encoding&&n.encoding.includes("html")?void 0:t}function $f({effect:e,job:n},t){t?(e.flags|=32,n.flags|=4):(e.flags&=-33,n.flags&=-5)}function d4(e,n){return(!e||e&&!e.pendingBranch)&&n&&!n.persisted}function ty(e,n,t=!1){const r=e.children,i=n.children;if(rr(r)&&rr(i))for(let s=0;s<r.length;s++){const o=r[s];let u=i[s];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=i[s]=hf(i[s]),u.el=o.el),!t&&u.patchFlag!==-2&&ty(o,u)),u.type===wf&&(u.el=o.el)}}function qM(e){const n=e.slice(),t=[0];let r,i,s,o,u;const f=e.length;for(r=0;r<f;r++){const d=e[r];if(d!==0){if(i=t[t.length-1],e[i]<d){n[r]=i,t.push(r);continue}for(s=0,o=t.length-1;s<o;)u=s+o>>1,e[t[u]]<d?s=u+1:o=u;d<e[t[s]]&&(s>0&&(n[r]=t[s-1]),t[s]=r)}}for(s=t.length,o=t[s-1];s-- >0;)t[s]=o,o=n[o];return t}function p4(e){const n=e.subTree.component;if(n)return n.asyncDep&&!n.asyncResolved?n:p4(n)}function nm(e){if(e)for(let n=0;n<e.length;n++)e[n].flags|=8}const g4=Symbol.for("v-scx"),m4=()=>Zl(g4);function wp(e,n){return Tp(e,null,n)}function WM(e,n){return Tp(e,null,{flush:"post"})}function v4(e,n){return Tp(e,null,{flush:"sync"})}function oo(e,n,t){return Tp(e,n,t)}function Tp(e,n,t=Ii){const{immediate:r,deep:i,flush:s,once:o}=t,u=yo({},t),f=n&&r||!n&&s!=="post";let d;if(id){if(s==="sync"){const y=m4();d=y.__watcherHandles||(y.__watcherHandles=[])}else if(!f){const y=()=>{};return y.stop=gu,y.resume=gu,y.pause=gu,y}}const m=Vs;u.call=(y,M,k)=>yu(y,m,M,k);let _=!1;s==="post"?u.scheduler=y=>{$s(y,m&&m.suspense)}:s!=="sync"&&(_=!0,u.scheduler=(y,M)=>{M?y():H1(y)}),u.augmentJob=y=>{n&&(y.flags|=4),_&&(y.flags|=2,m&&(y.id=m.uid,y.i=m))};const w=BP(e,n,u);return id&&(d?d.push(w):f&&w()),w}function ZM(e,n,t){const r=this.proxy,i=Co(e)?e.includes(".")?y4(r,e):()=>r[e]:e.bind(r,r);let s;Tr(n)?s=n:(s=n.handler,t=n);const o=sh(this),u=Tp(i,s.bind(r),t);return o(),u}function y4(e,n){const t=n.split(".");return()=>{let r=e;for(let i=0;i<t.length&&r;i++)r=r[t[i]];return r}}function KM(e,n,t=Ii){const r=bu(),i=ga(n),s=Sl(n),o=_4(e,i),u=Sw((f,d)=>{let m,_=Ii,w;return v4(()=>{const y=e[i];tl(m,y)&&(m=y,d())}),{get(){return f(),t.get?t.get(m):m},set(y){const M=t.set?t.set(y):y;if(!tl(M,m)&&!(_!==Ii&&tl(y,_)))return;const k=r.vnode.props;k&&(n in k||i in k||s in k)&&(`onUpdate:${n}`in k||`onUpdate:${i}`in k||`onUpdate:${s}`in k)||(m=y,d()),r.emit(`update:${n}`,M),tl(y,M)&&tl(y,_)&&!tl(M,w)&&d(),_=y,w=M}}});return u[Symbol.iterator]=()=>{let f=0;return{next(){return f<2?{value:f++?o||Ii:u,done:!1}:{done:!0}}}},u}const _4=(e,n)=>n==="modelValue"||n==="model-value"?e.modelModifiers:e[`${n}Modifiers`]||e[`${ga(n)}Modifiers`]||e[`${Sl(n)}Modifiers`];function YM(e,n,...t){if(e.isUnmounted)return;const r=e.vnode.props||Ii;let i=t;const s=n.startsWith("update:"),o=s&&_4(r,n.slice(7));o&&(o.trim&&(i=t.map(m=>Co(m)?m.trim():m)),o.number&&(i=t.map(Kg)));let u,f=r[u=Kd(n)]||r[u=Kd(ga(n))];!f&&s&&(f=r[u=Kd(Sl(n))]),f&&yu(f,e,6,i);const d=r[u+"Once"];if(d){if(!e.emitted)e.emitted={};else if(e.emitted[u])return;e.emitted[u]=!0,yu(d,e,6,i)}}function b4(e,n,t=!1){const r=n.emitsCache,i=r.get(e);if(i!==void 0)return i;const s=e.emits;let o={},u=!1;if(!Tr(e)){const f=d=>{const m=b4(d,n,!0);m&&(u=!0,yo(o,m))};!t&&n.mixins.length&&n.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}return!s&&!u?(ao(e)&&r.set(e,null),null):(rr(s)?s.forEach(f=>o[f]=null):yo(o,s),ao(e)&&r.set(e,o),o)}function Um(e,n){return!e||!Mp(n)?!1:(n=n.slice(2).replace(/Once$/,""),Ji(e,n[0].toLowerCase()+n.slice(1))||Ji(e,Sl(n))||Ji(e,n))}function kg(e){const{type:n,vnode:t,proxy:r,withProxy:i,propsOptions:[s],slots:o,attrs:u,emit:f,render:d,renderCache:m,props:_,data:w,setupState:y,ctx:M,inheritAttrs:k}=e,F=yp(e);let I,R;try{if(t.shapeFlag&4){const ee=i||r,he=ee;I=Ll(d.call(he,ee,m,_,y,w,M)),R=u}else{const ee=n;I=Ll(ee.length>1?ee(_,{attrs:u,slots:o,emit:f}):ee(_,null)),R=n.props?u:XM(u)}}catch(ee){tp.length=0,ch(ee,e,1),I=di(Rs)}let K=I;if(R&&k!==!1){const ee=Object.keys(R),{shapeFlag:he}=K;ee.length&&he&7&&(s&&ee.some(N1)&&(R=QM(R,s)),K=vc(K,R,!1,!0))}return t.dirs&&(K=vc(K,null,!1,!0),K.dirs=K.dirs?K.dirs.concat(t.dirs):t.dirs),t.transition&&Uc(K,t.transition),I=K,yp(F),I}function JM(e,n=!0){let t;for(let r=0;r<e.length;r++){const i=e[r];if(Vc(i)){if(i.type!==Rs||i.children==="v-if"){if(t)return;t=i}}else return}return t}const XM=e=>{let n;for(const t in e)(t==="class"||t==="style"||Mp(t))&&((n||(n={}))[t]=e[t]);return n},QM=(e,n)=>{const t={};for(const r in e)(!N1(r)||!(r.slice(9)in n))&&(t[r]=e[r]);return t};function eA(e,n,t){const{props:r,children:i,component:s}=e,{props:o,children:u,patchFlag:f}=n,d=s.emitsOptions;if(n.dirs||n.transition)return!0;if(t&&f>=0){if(f&1024)return!0;if(f&16)return r?Z2(r,o,d):!!o;if(f&8){const m=n.dynamicProps;for(let _=0;_<m.length;_++){const w=m[_];if(o[w]!==r[w]&&!Um(d,w))return!0}}}else return(i||u)&&(!u||!u.$stable)?!0:r===o?!1:r?o?Z2(r,o,d):!0:!!o;return!1}function Z2(e,n,t){const r=Object.keys(n);if(r.length!==Object.keys(e).length)return!0;for(let i=0;i<r.length;i++){const s=r[i];if(n[s]!==e[s]&&!Um(t,s))return!0}return!1}function Vm({vnode:e,parent:n},t){for(;n;){const r=n.subTree;if(r.suspense&&r.suspense.activeBranch===e&&(r.el=e.el),r===e)(e=n.vnode).el=t,n=n.parent;else break}}const rm=e=>e.__isSuspense;let Bv=0;const tA={name:"Suspense",__isSuspense:!0,process(e,n,t,r,i,s,o,u,f,d){if(e==null)rA(n,t,r,i,s,o,u,f,d);else{if(s&&s.deps>0&&!e.suspense.isInFallback){n.suspense=e.suspense,n.suspense.vnode=n,n.el=e.el;return}iA(e,n,t,r,i,o,u,f,d)}},hydrate:oA,normalize:sA},nA=tA;function xp(e,n){const t=e.props&&e.props[n];Tr(t)&&t()}function rA(e,n,t,r,i,s,o,u,f){const{p:d,o:{createElement:m}}=f,_=m("div"),w=e.suspense=w4(e,i,r,n,_,t,s,o,u,f);d(null,w.pendingBranch=e.ssContent,_,null,r,w,s,o),w.deps>0?(xp(e,"onPending"),xp(e,"onFallback"),d(null,e.ssFallback,n,t,r,null,s,o),Xh(w,e.ssFallback)):w.resolve(!1,!0)}function iA(e,n,t,r,i,s,o,u,{p:f,um:d,o:{createElement:m}}){const _=n.suspense=e.suspense;_.vnode=n,n.el=e.el;const w=n.ssContent,y=n.ssFallback,{activeBranch:M,pendingBranch:k,isInFallback:F,isHydrating:I}=_;if(k)_.pendingBranch=w,zu(w,k)?(f(k,w,_.hiddenContainer,null,i,_,s,o,u),_.deps<=0?_.resolve():F&&(I||(f(M,y,t,r,i,null,s,o,u),Xh(_,y)))):(_.pendingId=Bv++,I?(_.isHydrating=!1,_.activeBranch=k):d(k,i,_),_.deps=0,_.effects.length=0,_.hiddenContainer=m("div"),F?(f(null,w,_.hiddenContainer,null,i,_,s,o,u),_.deps<=0?_.resolve():(f(M,y,t,r,i,null,s,o,u),Xh(_,y))):M&&zu(w,M)?(f(M,w,t,r,i,_,s,o,u),_.resolve(!0)):(f(null,w,_.hiddenContainer,null,i,_,s,o,u),_.deps<=0&&_.resolve()));else if(M&&zu(w,M))f(M,w,t,r,i,_,s,o,u),Xh(_,w);else if(xp(n,"onPending"),_.pendingBranch=w,w.shapeFlag&512?_.pendingId=w.component.suspenseId:_.pendingId=Bv++,f(null,w,_.hiddenContainer,null,i,_,s,o,u),_.deps<=0)_.resolve();else{const{timeout:R,pendingId:K}=_;R>0?setTimeout(()=>{_.pendingId===K&&_.fallback(y)},R):R===0&&_.fallback(y)}}function w4(e,n,t,r,i,s,o,u,f,d,m=!1){const{p:_,m:w,um:y,n:M,o:{parentNode:k,remove:F}}=d;let I;const R=aA(e);R&&n&&n.pendingBranch&&(I=n.pendingId,n.deps++);const K=e.props?Yg(e.props.timeout):void 0,ee=s,he={vnode:e,parent:n,parentComponent:t,namespace:o,container:r,hiddenContainer:i,deps:0,pendingId:Bv++,timeout:typeof K=="number"?K:-1,activeBranch:null,pendingBranch:null,isInFallback:!m,isHydrating:m,isUnmounted:!1,effects:[],resolve(fe=!1,ve=!1){const{vnode:z,activeBranch:U,pendingBranch:J,pendingId:T,effects:D,parentComponent:B,container:$}=he;let W=!1;he.isHydrating?he.isHydrating=!1:fe||(W=U&&J.transition&&J.transition.mode==="out-in",W&&(U.transition.afterLeave=()=>{T===he.pendingId&&(w(J,$,s===ee?M(U):s,0),mp(D))}),U&&(k(U.el)===$&&(s=M(U)),y(U,B,he,!0)),W||w(J,$,s,0)),Xh(he,J),he.pendingBranch=null,he.isInFallback=!1;let G=he.parent,oe=!1;for(;G;){if(G.pendingBranch){G.effects.push(...D),oe=!0;break}G=G.parent}!oe&&!W&&mp(D),he.effects=[],R&&n&&n.pendingBranch&&I===n.pendingId&&(n.deps--,n.deps===0&&!ve&&n.resolve()),xp(z,"onResolve")},fallback(fe){if(!he.pendingBranch)return;const{vnode:ve,activeBranch:z,parentComponent:U,container:J,namespace:T}=he;xp(ve,"onFallback");const D=M(z),B=()=>{he.isInFallback&&(_(null,fe,J,D,U,null,T,u,f),Xh(he,fe))},$=fe.transition&&fe.transition.mode==="out-in";$&&(z.transition.afterLeave=B),he.isInFallback=!0,y(z,U,null,!0),$||B()},move(fe,ve,z){he.activeBranch&&w(he.activeBranch,fe,ve,z),he.container=fe},next(){return he.activeBranch&&M(he.activeBranch)},registerDep(fe,ve,z){const U=!!he.pendingBranch;U&&he.deps++;const J=fe.vnode.el;fe.asyncDep.catch(T=>{ch(T,fe,0)}).then(T=>{if(fe.isUnmounted||he.isUnmounted||he.pendingId!==fe.suspenseId)return;fe.asyncResolved=!0;const{vnode:D}=fe;zv(fe,T,!1),J&&(D.el=J);const B=!J&&fe.subTree.el;ve(fe,D,k(J||fe.subTree.el),J?null:M(fe.subTree),he,o,z),B&&F(B),Vm(fe,D.el),U&&--he.deps===0&&he.resolve()})},unmount(fe,ve){he.isUnmounted=!0,he.activeBranch&&y(he.activeBranch,t,fe,ve),he.pendingBranch&&y(he.pendingBranch,t,fe,ve)}};return he}function oA(e,n,t,r,i,s,o,u,f){const d=n.suspense=w4(n,r,t,e.parentNode,document.createElement("div"),null,i,s,o,u,!0),m=f(e,d.pendingBranch=n.ssContent,t,d,s,o);return d.deps===0&&d.resolve(!1,!0),m}function sA(e){const{shapeFlag:n,children:t}=e,r=n&32;e.ssContent=K2(r?t.default:t),e.ssFallback=r?K2(t.fallback):di(Rs)}function K2(e){let n;if(Tr(e)){const t=oh&&e._c;t&&(e._d=!1,$e()),e=e(),t&&(e._d=!0,n=ja,L4())}return rr(e)&&(e=JM(e)),e=Ll(e),n&&!e.dynamicChildren&&(e.dynamicChildren=n.filter(t=>t!==e)),e}function x4(e,n){n&&n.pendingBranch?rr(e)?n.effects.push(...e):n.effects.push(e):mp(e)}function Xh(e,n){e.activeBranch=n;const{vnode:t,parentComponent:r}=e;let i=n.el;for(;!i&&n.component;)n=n.component.subTree,i=n.el;t.el=i,r&&r.subTree===t&&(r.vnode.el=i,Vm(r,i))}function aA(e){const n=e.props&&e.props.suspensible;return n!=null&&n!==!1}const Tn=Symbol.for("v-fgt"),wf=Symbol.for("v-txt"),Rs=Symbol.for("v-cmt"),th=Symbol.for("v-stc"),tp=[];let ja=null;function $e(e=!1){tp.push(ja=e?null:[])}function L4(){tp.pop(),ja=tp[tp.length-1]||null}let oh=1;function Rv(e,n=!1){oh+=e,e<0&&ja&&n&&(ja.hasOnce=!0)}function S4(e){return e.dynamicChildren=oh>0?ja||Wh:null,L4(),oh>0&&ja&&ja.push(e),e}function qe(e,n,t,r,i,s){return S4(C(e,n,t,r,i,s,!0))}function rl(e,n,t,r,i){return S4(di(e,n,t,r,i,!0))}function Vc(e){return e?e.__v_isVNode===!0:!1}function zu(e,n){return e.type===n.type&&e.key===n.key}function lA(e){}const E4=({key:e})=>e??null,Tg=({ref:e,ref_key:n,ref_for:t})=>(typeof e=="number"&&(e=""+e),e!=null?Co(e)||Xo(e)||Tr(e)?{i:Gs,r:e,k:n,f:!!t}:e:null);function C(e,n=null,t=null,r=0,i=null,s=e===Tn?0:1,o=!1,u=!1){const f={__v_isVNode:!0,__v_skip:!0,type:e,props:n,key:n&&E4(n),ref:n&&Tg(n),scopeId:Fm,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:Gs};return u?(ny(f,t),s&128&&e.normalize(f)):t&&(f.shapeFlag|=Co(t)?8:16),oh>0&&!o&&ja&&(f.patchFlag>0||s&6)&&f.patchFlag!==32&&ja.push(f),f}const di=uA;function uA(e,n=null,t=null,r=0,i=null,s=!1){if((!e||e===Yw)&&(e=Rs),Vc(e)){const u=vc(e,n,!0);return t&&ny(u,t),oh>0&&!s&&ja&&(u.shapeFlag&6?ja[ja.indexOf(e)]=u:ja.push(u)),u.patchFlag=-2,u}if(mA(e)&&(e=e.__vccOpts),n){n=C4(n);let{class:u,style:f}=n;u&&!Co(u)&&(n.class=Vi(u)),ao(f)&&(Bm(f)&&!rr(f)&&(f=yo({},f)),n.style=ql(f))}const o=Co(e)?1:rm(e)?128:Iw(e)?64:ao(e)?4:Tr(e)?2:0;return C(e,n,t,r,i,o,s,!0)}function C4(e){return e?Bm(e)||r4(e)?yo({},e):e:null}function vc(e,n,t=!1,r=!1){const{props:i,ref:s,patchFlag:o,children:u,transition:f}=e,d=n?P4(i||{},n):i,m={__v_isVNode:!0,__v_skip:!0,type:e.type,props:d,key:d&&E4(d),ref:n&&n.ref?t&&s?rr(s)?s.concat(Tg(n)):[s,Tg(n)]:Tg(n):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:u,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:n&&e.type!==Tn?o===-1?16:o|16:o,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:f,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&vc(e.ssContent),ssFallback:e.ssFallback&&vc(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return f&&r&&Uc(m,f.clone(m)),m}function Li(e=" ",n=0){return di(wf,null,e,n)}function $u(e,n){const t=di(th,null,e);return t.staticCount=n,t}function pn(e="",n=!1){return n?($e(),rl(Rs,null,e)):di(Rs,null,e)}function Ll(e){return e==null||typeof e=="boolean"?di(Rs):rr(e)?di(Tn,null,e.slice()):Vc(e)?hf(e):di(wf,null,String(e))}function hf(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:vc(e)}function ny(e,n){let t=0;const{shapeFlag:r}=e;if(n==null)n=null;else if(rr(n))t=16;else if(typeof n=="object")if(r&65){const i=n.default;i&&(i._c&&(i._d=!1),ny(e,i()),i._c&&(i._d=!0));return}else{t=32;const i=n._;!i&&!r4(n)?n._ctx=Gs:i===3&&Gs&&(Gs.slots._===1?n._=1:(n._=2,e.patchFlag|=1024))}else Tr(n)?(n={default:n,_ctx:Gs},t=32):(n=String(n),r&64?(t=16,n=[Li(n)]):t=8);e.children=n,e.shapeFlag|=t}function P4(...e){const n={};for(let t=0;t<e.length;t++){const r=e[t];for(const i in r)if(i==="class")n.class!==r.class&&(n.class=Vi([n.class,r.class]));else if(i==="style")n.style=ql([n.style,r.style]);else if(Mp(i)){const s=n[i],o=r[i];o&&s!==o&&!(rr(s)&&s.includes(o))&&(n[i]=s?[].concat(s,o):o)}else i!==""&&(n[i]=r[i])}return n}function bl(e,n,t,r=null){yu(e,n,7,[t,r])}const cA=Qw();let fA=0;function M4(e,n,t){const r=e.type,i=(n?n.appContext:e.appContext)||cA,s={uid:fA++,vnode:e,type:r,parent:n,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new B1(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:n?n.provides:Object.create(i.provides),ids:n?n.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:o4(r,i),emitsOptions:b4(r,i),emit:null,emitted:null,propsDefaults:Ii,inheritAttrs:r.inheritAttrs,ctx:Ii,data:Ii,props:Ii,attrs:Ii,slots:Ii,refs:Ii,setupState:Ii,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=n?n.root:s,s.emit=YM.bind(null,s),e.ce&&e.ce(s),s}let Vs=null;const bu=()=>Vs||Gs;let im,Fv;{const e=km(),n=(t,r)=>{let i;return(i=e[t])||(i=e[t]=[]),i.push(r),s=>{i.length>1?i.forEach(o=>o(s)):i[0](s)}};im=n("__VUE_INSTANCE_SETTERS__",t=>Vs=t),Fv=n("__VUE_SSR_SETTERS__",t=>id=t)}const sh=e=>{const n=Vs;return im(e),e.scope.on(),()=>{e.scope.off(),im(n)}},jv=()=>{Vs&&Vs.scope.off(),im(null)};function A4(e){return e.vnode.shapeFlag&4}let id=!1;function k4(e,n=!1,t=!1){n&&Fv(n);const{props:r,children:i}=e.vnode,s=A4(e);zM(e,r,s,n),GM(e,i,t);const o=s?hA(e,n):void 0;return n&&Fv(!1),o}function hA(e,n){const t=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Nv);const{setup:r}=t;if(r){Af();const i=e.setupContext=r.length>1?N4(e):null,s=sh(e),o=dd(r,e,0,[e.props,i]),u=I1(o);if(kf(),s(),(u||e.sp)&&!bf(e)&&Z1(e),u){if(o.then(jv,jv),n)return o.then(f=>{zv(e,f,n)}).catch(f=>{ch(f,e,0)});e.asyncDep=o}else zv(e,o,n)}else T4(e,n)}function zv(e,n,t){Tr(n)?e.type.__ssrInlineRender?e.ssrRender=n:e.render=n:ao(n)&&(e.setupState=G1(n)),T4(e,t)}let om,$v;function dA(e){om=e,$v=n=>{n.render._rc&&(n.withProxy=new Proxy(n.ctx,_M))}}const pA=()=>!om;function T4(e,n,t){const r=e.type;if(!e.render){if(!n&&om&&!r.render){const i=r.template||Q1(e).template;if(i){const{isCustomElement:s,compilerOptions:o}=e.appContext.config,{delimiters:u,compilerOptions:f}=r,d=yo(yo({isCustomElement:s,delimiters:u},o),f);r.render=om(i,d)}}e.render=r.render||gu,$v&&$v(e)}{const i=sh(e);Af();try{DM(e)}finally{kf(),i()}}}const gA={get(e,n){return Ia(e,"get",""),e[n]}};function N4(e){const n=t=>{e.exposed=t||{}};return{attrs:new Proxy(e.attrs,gA),slots:e.slots,emit:e.emit,expose:n}}function Np(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(G1(Rm(e.exposed)),{get(n,t){if(t in n)return n[t];if(t in Qd)return Qd[t](e)},has(n,t){return t in n||t in Qd}})):e.proxy}function Uv(e,n=!0){return Tr(e)?e.displayName||e.name:e.name||n&&e.__name}function mA(e){return Tr(e)&&"__vccOpts"in e}const sr=(e,n)=>NP(e,n,id);function Gm(e,n,t){const r=arguments.length;return r===2?ao(n)&&!rr(n)?Vc(n)?di(e,null,[n]):di(e,n):di(e,null,n):(r>3?t=Array.prototype.slice.call(arguments,2):r===3&&Vc(t)&&(t=[t]),di(e,n,t))}function vA(){}function yA(e,n,t,r){const i=t[r];if(i&&D4(i,e))return i;const s=n();return s.memo=e.slice(),s.cacheIndex=r,t[r]=s}function D4(e,n){const t=e.memo;if(t.length!=n.length)return!1;for(let r=0;r<t.length;r++)if(tl(t[r],n[r]))return!1;return oh>0&&ja&&ja.push(e),!0}const I4="3.5.13",_A=gu,bA=$P,wA=Fh,xA=Nw,LA={createComponentInstance:M4,setupComponent:k4,renderComponentRoot:kg,setCurrentRenderingInstance:yp,isVNode:Vc,normalizeVNode:Ll,getComponentPublicInstance:Np,ensureValidVNode:X1,pushWarningContext:RP,popWarningContext:FP},SA=LA,EA=null,CA=null,PA=null;/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Vv;const Y2=typeof window<"u"&&window.trustedTypes;if(Y2)try{Vv=Y2.createPolicy("vue",{createHTML:e=>e})}catch{}const O4=Vv?e=>Vv.createHTML(e):e=>e,MA="http://www.w3.org/2000/svg",AA="http://www.w3.org/1998/Math/MathML",Bc=typeof document<"u"?document:null,J2=Bc&&Bc.createElement("template"),kA={insert:(e,n,t)=>{n.insertBefore(e,t||null)},remove:e=>{const n=e.parentNode;n&&n.removeChild(e)},createElement:(e,n,t,r)=>{const i=n==="svg"?Bc.createElementNS(MA,e):n==="mathml"?Bc.createElementNS(AA,e):t?Bc.createElement(e,{is:t}):Bc.createElement(e);return e==="select"&&r&&r.multiple!=null&&i.setAttribute("multiple",r.multiple),i},createText:e=>Bc.createTextNode(e),createComment:e=>Bc.createComment(e),setText:(e,n)=>{e.nodeValue=n},setElementText:(e,n)=>{e.textContent=n},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Bc.querySelector(e),setScopeId(e,n){e.setAttribute(n,"")},insertStaticContent(e,n,t,r,i,s){const o=t?t.previousSibling:n.lastChild;if(i&&(i===s||i.nextSibling))for(;n.insertBefore(i.cloneNode(!0),t),!(i===s||!(i=i.nextSibling)););else{J2.innerHTML=O4(r==="svg"?`<svg>${e}</svg>`:r==="mathml"?`<math>${e}</math>`:e);const u=J2.content;if(r==="svg"||r==="mathml"){const f=u.firstChild;for(;f.firstChild;)u.appendChild(f.firstChild);u.removeChild(f)}n.insertBefore(u,t)}return[o?o.nextSibling:n.firstChild,t?t.previousSibling:n.lastChild]}},tf="transition",Pd="animation",od=Symbol("_vtc"),B4={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},R4=yo({},W1,B4),TA=e=>(e.displayName="Transition",e.props=R4,e),Gv=TA((e,{slots:n})=>Gm(jw,F4(e),n)),Uf=(e,n=[])=>{rr(e)?e.forEach(t=>t(...n)):e&&e(...n)},X2=e=>e?rr(e)?e.some(n=>n.length>1):e.length>1:!1;function F4(e){const n={};for(const D in e)D in B4||(n[D]=e[D]);if(e.css===!1)return n;const{name:t="v",type:r,duration:i,enterFromClass:s=`${t}-enter-from`,enterActiveClass:o=`${t}-enter-active`,enterToClass:u=`${t}-enter-to`,appearFromClass:f=s,appearActiveClass:d=o,appearToClass:m=u,leaveFromClass:_=`${t}-leave-from`,leaveActiveClass:w=`${t}-leave-active`,leaveToClass:y=`${t}-leave-to`}=e,M=NA(i),k=M&&M[0],F=M&&M[1],{onBeforeEnter:I,onEnter:R,onEnterCancelled:K,onLeave:ee,onLeaveCancelled:he,onBeforeAppear:fe=I,onAppear:ve=R,onAppearCancelled:z=K}=n,U=(D,B,$,W)=>{D._enterCancelled=W,af(D,B?m:u),af(D,B?d:o),$&&$()},J=(D,B)=>{D._isLeaving=!1,af(D,_),af(D,y),af(D,w),B&&B()},T=D=>(B,$)=>{const W=D?ve:R,G=()=>U(B,D,$);Uf(W,[B,G]),Q2(()=>{af(B,D?f:s),sc(B,D?m:u),X2(W)||e_(B,r,k,G)})};return yo(n,{onBeforeEnter(D){Uf(I,[D]),sc(D,s),sc(D,o)},onBeforeAppear(D){Uf(fe,[D]),sc(D,f),sc(D,d)},onEnter:T(!1),onAppear:T(!0),onLeave(D,B){D._isLeaving=!0;const $=()=>J(D,B);sc(D,_),D._enterCancelled?(sc(D,w),Hv()):(Hv(),sc(D,w)),Q2(()=>{D._isLeaving&&(af(D,_),sc(D,y),X2(ee)||e_(D,r,F,$))}),Uf(ee,[D,$])},onEnterCancelled(D){U(D,!1,void 0,!0),Uf(K,[D])},onAppearCancelled(D){U(D,!0,void 0,!0),Uf(z,[D])},onLeaveCancelled(D){J(D),Uf(he,[D])}})}function NA(e){if(e==null)return null;if(ao(e))return[G0(e.enter),G0(e.leave)];{const n=G0(e);return[n,n]}}function G0(e){return Yg(e)}function sc(e,n){n.split(/\s+/).forEach(t=>t&&e.classList.add(t)),(e[od]||(e[od]=new Set)).add(n)}function af(e,n){n.split(/\s+/).forEach(r=>r&&e.classList.remove(r));const t=e[od];t&&(t.delete(n),t.size||(e[od]=void 0))}function Q2(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let DA=0;function e_(e,n,t,r){const i=e._endId=++DA,s=()=>{i===e._endId&&r()};if(t!=null)return setTimeout(s,t);const{type:o,timeout:u,propCount:f}=j4(e,n);if(!o)return r();const d=o+"end";let m=0;const _=()=>{e.removeEventListener(d,w),s()},w=y=>{y.target===e&&++m>=f&&_()};setTimeout(()=>{m<f&&_()},u+1),e.addEventListener(d,w)}function j4(e,n){const t=window.getComputedStyle(e),r=M=>(t[M]||"").split(", "),i=r(`${tf}Delay`),s=r(`${tf}Duration`),o=t_(i,s),u=r(`${Pd}Delay`),f=r(`${Pd}Duration`),d=t_(u,f);let m=null,_=0,w=0;n===tf?o>0&&(m=tf,_=o,w=s.length):n===Pd?d>0&&(m=Pd,_=d,w=f.length):(_=Math.max(o,d),m=_>0?o>d?tf:Pd:null,w=m?m===tf?s.length:f.length:0);const y=m===tf&&/\b(transform|all)(,|$)/.test(r(`${tf}Property`).toString());return{type:m,timeout:_,propCount:w,hasTransform:y}}function t_(e,n){for(;e.length<n.length;)e=e.concat(e);return Math.max(...n.map((t,r)=>n_(t)+n_(e[r])))}function n_(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function Hv(){return document.body.offsetHeight}function IA(e,n,t){const r=e[od];r&&(n=(n?[n,...r]:[...r]).join(" ")),n==null?e.removeAttribute("class"):t?e.setAttribute("class",n):e.className=n}const sm=Symbol("_vod"),z4=Symbol("_vsh"),Hm={beforeMount(e,{value:n},{transition:t}){e[sm]=e.style.display==="none"?"":e.style.display,t&&n?t.beforeEnter(e):Md(e,n)},mounted(e,{value:n},{transition:t}){t&&n&&t.enter(e)},updated(e,{value:n,oldValue:t},{transition:r}){!n!=!t&&(r?n?(r.beforeEnter(e),Md(e,!0),r.enter(e)):r.leave(e,()=>{Md(e,!1)}):Md(e,n))},beforeUnmount(e,{value:n}){Md(e,n)}};function Md(e,n){e.style.display=n?e[sm]:"none",e[z4]=!n}function OA(){Hm.getSSRProps=({value:e})=>{if(!e)return{style:{display:"none"}}}}const $4=Symbol("");function BA(e){const n=bu();if(!n)return;const t=n.ut=(i=e(n.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${n.uid}"]`)).forEach(s=>am(s,i))},r=()=>{const i=e(n.proxy);n.ce?am(n.ce,i):qv(n.subTree,i),t(i)};K1(()=>{mp(r)}),Cs(()=>{oo(r,gu,{flush:"post"});const i=new MutationObserver(r);i.observe(n.subTree.el.parentNode,{childList:!0}),mc(()=>i.disconnect())})}function qv(e,n){if(e.shapeFlag&128){const t=e.suspense;e=t.activeBranch,t.pendingBranch&&!t.isHydrating&&t.effects.push(()=>{qv(t.activeBranch,n)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)am(e.el,n);else if(e.type===Tn)e.children.forEach(t=>qv(t,n));else if(e.type===th){let{el:t,anchor:r}=e;for(;t&&(am(t,n),t!==r);)t=t.nextSibling}}function am(e,n){if(e.nodeType===1){const t=e.style;let r="";for(const i in n)t.setProperty(`--${i}`,n[i]),r+=`--${i}: ${n[i]};`;t[$4]=r}}const RA=/(^|;)\s*display\s*:/;function FA(e,n,t){const r=e.style,i=Co(t);let s=!1;if(t&&!i){if(n)if(Co(n))for(const o of n.split(";")){const u=o.slice(0,o.indexOf(":")).trim();t[u]==null&&Ng(r,u,"")}else for(const o in n)t[o]==null&&Ng(r,o,"");for(const o in t)o==="display"&&(s=!0),Ng(r,o,t[o])}else if(i){if(n!==t){const o=r[$4];o&&(t+=";"+o),r.cssText=t,s=RA.test(t)}}else n&&e.removeAttribute("style");sm in e&&(e[sm]=s?r.display:"",e[z4]&&(r.display="none"))}const r_=/\s*!important$/;function Ng(e,n,t){if(rr(t))t.forEach(r=>Ng(e,n,r));else if(t==null&&(t=""),n.startsWith("--"))e.setProperty(n,t);else{const r=jA(e,n);r_.test(t)?e.setProperty(Sl(r),t.replace(r_,""),"important"):e[r]=t}}const i_=["Webkit","Moz","ms"],H0={};function jA(e,n){const t=H0[n];if(t)return t;let r=ga(n);if(r!=="filter"&&r in e)return H0[n]=r;r=Ap(r);for(let i=0;i<i_.length;i++){const s=i_[i]+r;if(s in e)return H0[n]=s}return n}const o_="http://www.w3.org/1999/xlink";function s_(e,n,t,r,i,s=QC(n)){r&&n.startsWith("xlink:")?t==null?e.removeAttributeNS(o_,n.slice(6,n.length)):e.setAttributeNS(o_,n,t):t==null||s&&!iw(t)?e.removeAttribute(n):e.setAttribute(n,s?"":Gu(t)?String(t):t)}function a_(e,n,t,r,i){if(n==="innerHTML"||n==="textContent"){t!=null&&(e[n]=n==="innerHTML"?O4(t):t);return}const s=e.tagName;if(n==="value"&&s!=="PROGRESS"&&!s.includes("-")){const u=s==="OPTION"?e.getAttribute("value")||"":e.value,f=t==null?e.type==="checkbox"?"on":"":String(t);(u!==f||!("_value"in e))&&(e.value=f),t==null&&e.removeAttribute(n),e._value=t;return}let o=!1;if(t===""||t==null){const u=typeof e[n];u==="boolean"?t=iw(t):t==null&&u==="string"?(t="",o=!0):u==="number"&&(t=0,o=!0)}try{e[n]=t}catch{}o&&e.removeAttribute(i||n)}function jc(e,n,t,r){e.addEventListener(n,t,r)}function zA(e,n,t,r){e.removeEventListener(n,t,r)}const l_=Symbol("_vei");function $A(e,n,t,r,i=null){const s=e[l_]||(e[l_]={}),o=s[n];if(r&&o)o.value=r;else{const[u,f]=UA(n);if(r){const d=s[n]=HA(r,i);jc(e,u,d,f)}else o&&(zA(e,u,o,f),s[n]=void 0)}}const u_=/(?:Once|Passive|Capture)$/;function UA(e){let n;if(u_.test(e)){n={};let r;for(;r=e.match(u_);)e=e.slice(0,e.length-r[0].length),n[r[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Sl(e.slice(2)),n]}let q0=0;const VA=Promise.resolve(),GA=()=>q0||(VA.then(()=>q0=0),q0=Date.now());function HA(e,n){const t=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=t.attached)return;yu(qA(r,t.value),n,5,[r])};return t.value=e,t.attached=GA(),t}function qA(e,n){if(rr(n)){const t=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{t.call(e),e._stopped=!0},n.map(r=>i=>!i._stopped&&r&&r(i))}else return n}const c_=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,WA=(e,n,t,r,i,s)=>{const o=i==="svg";n==="class"?IA(e,r,o):n==="style"?FA(e,t,r):Mp(n)?N1(n)||$A(e,n,t,r,s):(n[0]==="."?(n=n.slice(1),!0):n[0]==="^"?(n=n.slice(1),!1):ZA(e,n,r,o))?(a_(e,n,r),!e.tagName.includes("-")&&(n==="value"||n==="checked"||n==="selected")&&s_(e,n,r,o,s,n!=="value")):e._isVueCE&&(/[A-Z]/.test(n)||!Co(r))?a_(e,ga(n),r,s,n):(n==="true-value"?e._trueValue=r:n==="false-value"&&(e._falseValue=r),s_(e,n,r,o))};function ZA(e,n,t,r){if(r)return!!(n==="innerHTML"||n==="textContent"||n in e&&c_(n)&&Tr(t));if(n==="spellcheck"||n==="draggable"||n==="translate"||n==="form"||n==="list"&&e.tagName==="INPUT"||n==="type"&&e.tagName==="TEXTAREA")return!1;if(n==="width"||n==="height"){const i=e.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return c_(n)&&Co(t)?!1:n in e}const f_={};/*! #__NO_SIDE_EFFECTS__ */function U4(e,n,t){const r=ds(e,n);Mm(r)&&yo(r,n);class i extends qm{constructor(o){super(r,o,t)}}return i.def=r,i}/*! #__NO_SIDE_EFFECTS__ */const KA=(e,n)=>U4(e,n,X4),YA=typeof HTMLElement<"u"?HTMLElement:class{};class qm extends YA{constructor(n,t={},r=um){super(),this._def=n,this._props=t,this._createApp=r,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&r!==um?this._root=this.shadowRoot:n.shadowRoot!==!1?(this.attachShadow({mode:"open"}),this._root=this.shadowRoot):this._root=this,this._def.__asyncLoader||this._resolveProps(this._def)}connectedCallback(){if(!this.isConnected)return;this.shadowRoot||this._parseSlots(),this._connected=!0;let n=this;for(;n=n&&(n.parentNode||n.host);)if(n instanceof qm){this._parent=n;break}this._instance||(this._resolved?(this._setParent(),this._update()):n&&n._pendingResolve?this._pendingResolve=n._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(n=this._parent){n&&(this._instance.parent=n._instance,this._instance.provides=n._instance.provides)}disconnectedCallback(){this._connected=!1,Us(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null)})}_resolveDef(){if(this._pendingResolve)return;for(let r=0;r<this.attributes.length;r++)this._setAttr(this.attributes[r].name);this._ob=new MutationObserver(r=>{for(const i of r)this._setAttr(i.attributeName)}),this._ob.observe(this,{attributes:!0});const n=(r,i=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:s,styles:o}=r;let u;if(s&&!rr(s))for(const f in s){const d=s[f];(d===Number||d&&d.type===Number)&&(f in this._props&&(this._props[f]=Yg(this._props[f])),(u||(u=Object.create(null)))[ga(f)]=!0)}this._numberProps=u,i&&this._resolveProps(r),this.shadowRoot&&this._applyStyles(o),this._mount(r)},t=this._def.__asyncLoader;t?this._pendingResolve=t().then(r=>n(this._def=r,!0)):n(this._def)}_mount(n){this._app=this._createApp(n),n.configureApp&&n.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const t=this._instance&&this._instance.exposed;if(t)for(const r in t)Ji(this,r)||Object.defineProperty(this,r,{get:()=>Kn(t[r])})}_resolveProps(n){const{props:t}=n,r=rr(t)?t:Object.keys(t||{});for(const i of Object.keys(this))i[0]!=="_"&&r.includes(i)&&this._setProp(i,this[i]);for(const i of r.map(ga))Object.defineProperty(this,i,{get(){return this._getProp(i)},set(s){this._setProp(i,s,!0,!0)}})}_setAttr(n){if(n.startsWith("data-v-"))return;const t=this.hasAttribute(n);let r=t?this.getAttribute(n):f_;const i=ga(n);t&&this._numberProps&&this._numberProps[i]&&(r=Yg(r)),this._setProp(i,r,!1,!0)}_getProp(n){return this._props[n]}_setProp(n,t,r=!0,i=!1){if(t!==this._props[n]&&(t===f_?delete this._props[n]:(this._props[n]=t,n==="key"&&this._app&&(this._app._ceVNode.key=t)),i&&this._instance&&this._update(),r)){const s=this._ob;s&&s.disconnect(),t===!0?this.setAttribute(Sl(n),""):typeof t=="string"||typeof t=="number"?this.setAttribute(Sl(n),t+""):t||this.removeAttribute(Sl(n)),s&&s.observe(this,{attributes:!0})}}_update(){J4(this._createVNode(),this._root)}_createVNode(){const n={};this.shadowRoot||(n.onVnodeMounted=n.onVnodeUpdated=this._renderSlots.bind(this));const t=di(this._def,yo(n,this._props));return this._instance||(t.ce=r=>{this._instance=r,r.ce=this,r.isCE=!0;const i=(s,o)=>{this.dispatchEvent(new CustomEvent(s,Mm(o[0])?yo({detail:o},o[0]):{detail:o}))};r.emit=(s,...o)=>{i(s,o),Sl(s)!==s&&i(Sl(s),o)},this._setParent()}),t}_applyStyles(n,t){if(!n)return;if(t){if(t===this._def||this._styleChildren.has(t))return;this._styleChildren.add(t)}const r=this._nonce;for(let i=n.length-1;i>=0;i--){const s=document.createElement("style");r&&s.setAttribute("nonce",r),s.textContent=n[i],this.shadowRoot.prepend(s)}}_parseSlots(){const n=this._slots={};let t;for(;t=this.firstChild;){const r=t.nodeType===1&&t.getAttribute("slot")||"default";(n[r]||(n[r]=[])).push(t),this.removeChild(t)}}_renderSlots(){const n=(this._teleportTarget||this).querySelectorAll("slot"),t=this._instance.type.__scopeId;for(let r=0;r<n.length;r++){const i=n[r],s=i.getAttribute("name")||"default",o=this._slots[s],u=i.parentNode;if(o)for(const f of o){if(t&&f.nodeType===1){const d=t+"-s",m=document.createTreeWalker(f,1);f.setAttribute(d,"");let _;for(;_=m.nextNode();)_.setAttribute(d,"")}u.insertBefore(f,i)}else for(;i.firstChild;)u.insertBefore(i.firstChild,i);u.removeChild(i)}}_injectChildStyle(n){this._applyStyles(n.styles,n)}_removeChildStyle(n){}}function V4(e){const n=bu(),t=n&&n.ce;return t||null}function JA(){const e=V4();return e&&e.shadowRoot}function XA(e="$style"){{const n=bu();if(!n)return Ii;const t=n.type.__cssModules;if(!t)return Ii;const r=t[e];return r||Ii}}const G4=new WeakMap,H4=new WeakMap,lm=Symbol("_moveCb"),h_=Symbol("_enterCb"),QA=e=>(delete e.props.mode,e),e6=QA({name:"TransitionGroup",props:yo({},R4,{tag:String,moveClass:String}),setup(e,{slots:n}){const t=bu(),r=q1();let i,s;return $m(()=>{if(!i.length)return;const o=e.moveClass||`${e.name||"v"}-move`;if(!o6(i[0].el,t.vnode.el,o))return;i.forEach(n6),i.forEach(r6);const u=i.filter(i6);Hv(),u.forEach(f=>{const d=f.el,m=d.style;sc(d,o),m.transform=m.webkitTransform=m.transitionDuration="";const _=d[lm]=w=>{w&&w.target!==d||(!w||/transform$/.test(w.propertyName))&&(d.removeEventListener("transitionend",_),d[lm]=null,af(d,o))};d.addEventListener("transitionend",_)})}),()=>{const o=Di(e),u=F4(o);let f=o.tag||Tn;if(i=[],s)for(let d=0;d<s.length;d++){const m=s[d];m.el&&m.el instanceof Element&&(i.push(m),Uc(m,rd(m,u,r,t)),G4.set(m,m.el.getBoundingClientRect()))}s=n.default?jm(n.default()):[];for(let d=0;d<s.length;d++){const m=s[d];m.key!=null&&Uc(m,rd(m,u,r,t))}return di(f,null,s)}}}),t6=e6;function n6(e){const n=e.el;n[lm]&&n[lm](),n[h_]&&n[h_]()}function r6(e){H4.set(e,e.el.getBoundingClientRect())}function i6(e){const n=G4.get(e),t=H4.get(e),r=n.left-t.left,i=n.top-t.top;if(r||i){const s=e.el.style;return s.transform=s.webkitTransform=`translate(${r}px,${i}px)`,s.transitionDuration="0s",e}}function o6(e,n,t){const r=e.cloneNode(),i=e[od];i&&i.forEach(u=>{u.split(/\s+/).forEach(f=>f&&r.classList.remove(f))}),t.split(/\s+/).forEach(u=>u&&r.classList.add(u)),r.style.display="none";const s=n.nodeType===1?n:n.parentNode;s.appendChild(r);const{hasTransform:o}=j4(r);return s.removeChild(r),o}const Ef=e=>{const n=e.props["onUpdate:modelValue"]||!1;return rr(n)?t=>Yh(n,t):n};function s6(e){e.target.composing=!0}function d_(e){const n=e.target;n.composing&&(n.composing=!1,n.dispatchEvent(new Event("input")))}const mu=Symbol("_assign"),ni={created(e,{modifiers:{lazy:n,trim:t,number:r}},i){e[mu]=Ef(i);const s=r||i.props&&i.props.type==="number";jc(e,n?"change":"input",o=>{if(o.target.composing)return;let u=e.value;t&&(u=u.trim()),s&&(u=Kg(u)),e[mu](u)}),t&&jc(e,"change",()=>{e.value=e.value.trim()}),n||(jc(e,"compositionstart",s6),jc(e,"compositionend",d_),jc(e,"change",d_))},mounted(e,{value:n}){e.value=n??""},beforeUpdate(e,{value:n,oldValue:t,modifiers:{lazy:r,trim:i,number:s}},o){if(e[mu]=Ef(o),e.composing)return;const u=(s||e.type==="number")&&!/^0\d/.test(e.value)?Kg(e.value):e.value,f=n??"";u!==f&&(document.activeElement===e&&e.type!=="range"&&(r&&n===t||i&&e.value.trim()===f)||(e.value=f))}},wl={deep:!0,created(e,n,t){e[mu]=Ef(t),jc(e,"change",()=>{const r=e._modelValue,i=sd(e),s=e.checked,o=e[mu];if(rr(r)){const u=Tm(r,i),f=u!==-1;if(s&&!f)o(r.concat(i));else if(!s&&f){const d=[...r];d.splice(u,1),o(d)}}else if(uh(r)){const u=new Set(r);s?u.add(i):u.delete(i),o(u)}else o(q4(e,s))})},mounted:p_,beforeUpdate(e,n,t){e[mu]=Ef(t),p_(e,n,t)}};function p_(e,{value:n,oldValue:t},r){e._modelValue=n;let i;if(rr(n))i=Tm(n,r.props.value)>-1;else if(uh(n))i=n.has(r.props.value);else{if(n===t)return;i=Lf(n,q4(e,!0))}e.checked!==i&&(e.checked=i)}const ry={created(e,{value:n},t){e.checked=Lf(n,t.props.value),e[mu]=Ef(t),jc(e,"change",()=>{e[mu](sd(e))})},beforeUpdate(e,{value:n,oldValue:t},r){e[mu]=Ef(r),n!==t&&(e.checked=Lf(n,r.props.value))}},vo={deep:!0,created(e,{value:n,modifiers:{number:t}},r){const i=uh(n);jc(e,"change",()=>{const s=Array.prototype.filter.call(e.options,o=>o.selected).map(o=>t?Kg(sd(o)):sd(o));e[mu](e.multiple?i?new Set(s):s:s[0]),e._assigning=!0,Us(()=>{e._assigning=!1})}),e[mu]=Ef(r)},mounted(e,{value:n}){g_(e,n)},beforeUpdate(e,n,t){e[mu]=Ef(t)},updated(e,{value:n}){e._assigning||g_(e,n)}};function g_(e,n){const t=e.multiple,r=rr(n);if(!(t&&!r&&!uh(n))){for(let i=0,s=e.options.length;i<s;i++){const o=e.options[i],u=sd(o);if(t)if(r){const f=typeof u;f==="string"||f==="number"?o.selected=n.some(d=>String(d)===String(u)):o.selected=Tm(n,u)>-1}else o.selected=n.has(u);else if(Lf(sd(o),n)){e.selectedIndex!==i&&(e.selectedIndex=i);return}}!t&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function sd(e){return"_value"in e?e._value:e.value}function q4(e,n){const t=n?"_trueValue":"_falseValue";return t in e?e[t]:n}const iy={created(e,n,t){gg(e,n,t,null,"created")},mounted(e,n,t){gg(e,n,t,null,"mounted")},beforeUpdate(e,n,t,r){gg(e,n,t,r,"beforeUpdate")},updated(e,n,t,r){gg(e,n,t,r,"updated")}};function W4(e,n){switch(e){case"SELECT":return vo;case"TEXTAREA":return ni;default:switch(n){case"checkbox":return wl;case"radio":return ry;default:return ni}}}function gg(e,n,t,r,i){const o=W4(e.tagName,t.props&&t.props.type)[i];o&&o(e,n,t,r)}function a6(){ni.getSSRProps=({value:e})=>({value:e}),ry.getSSRProps=({value:e},n)=>{if(n.props&&Lf(n.props.value,e))return{checked:!0}},wl.getSSRProps=({value:e},n)=>{if(rr(e)){if(n.props&&Tm(e,n.props.value)>-1)return{checked:!0}}else if(uh(e)){if(n.props&&e.has(n.props.value))return{checked:!0}}else if(e)return{checked:!0}},iy.getSSRProps=(e,n)=>{if(typeof n.type!="string")return;const t=W4(n.type.toUpperCase(),n.props&&n.props.type);if(t.getSSRProps)return t.getSSRProps(e,n)}}const l6=["ctrl","shift","alt","meta"],u6={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,n)=>l6.some(t=>e[`${t}Key`]&&!n.includes(t))},Gc=(e,n)=>{const t=e._withMods||(e._withMods={}),r=n.join(".");return t[r]||(t[r]=(i,...s)=>{for(let o=0;o<n.length;o++){const u=u6[n[o]];if(u&&u(i,n))return}return e(i,...s)})},c6={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},f6=(e,n)=>{const t=e._withKeys||(e._withKeys={}),r=n.join(".");return t[r]||(t[r]=i=>{if(!("key"in i))return;const s=Sl(i.key);if(n.some(o=>o===s||c6[o]===s))return e(i)})},Z4=yo({patchProp:WA},kA);let np,m_=!1;function K4(){return np||(np=c4(Z4))}function Y4(){return np=m_?np:f4(Z4),m_=!0,np}const J4=(...e)=>{K4().render(...e)},h6=(...e)=>{Y4().hydrate(...e)},um=(...e)=>{const n=K4().createApp(...e),{mount:t}=n;return n.mount=r=>{const i=e5(r);if(!i)return;const s=n._component;!Tr(s)&&!s.render&&!s.template&&(s.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const o=t(i,!1,Q4(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},n},X4=(...e)=>{const n=Y4().createApp(...e),{mount:t}=n;return n.mount=r=>{const i=e5(r);if(i)return t(i,!0,Q4(i))},n};function Q4(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function e5(e){return Co(e)?document.querySelector(e):e}let v_=!1;const d6=()=>{v_||(v_=!0,a6(),OA())};/**
* vue v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const p6=()=>{},g6=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:jw,BaseTransitionPropsValidators:W1,Comment:Rs,DeprecationTypes:PA,EffectScope:B1,ErrorCodes:zP,ErrorTypeStrings:bA,Fragment:Tn,KeepAlive:fM,ReactiveEffect:dp,Static:th,Suspense:nA,Teleport:kv,Text:wf,TrackOpTypes:DP,Transition:Gv,TransitionGroup:t6,TriggerOpTypes:IP,VueElement:qm,assertNumber:jP,callWithAsyncErrorHandling:yu,callWithErrorHandling:dd,camelize:ga,capitalize:Ap,cloneVNode:vc,compatUtils:CA,compile:p6,computed:sr,createApp:um,createBlock:rl,createCommentVNode:pn,createElementBlock:qe,createElementVNode:C,createHydrationRenderer:f4,createPropsRestProxy:TM,createRenderer:c4,createSSRApp:X4,createSlots:mM,createStaticVNode:$u,createTextVNode:Li,createVNode:di,customRef:Sw,defineAsyncComponent:uM,defineComponent:ds,defineCustomElement:U4,defineEmits:wM,defineExpose:xM,defineModel:EM,defineOptions:LM,defineProps:bM,defineSSRCustomElement:KA,defineSlots:SM,devtools:wA,effect:nP,effectScope:R1,getCurrentInstance:bu,getCurrentScope:F1,getCurrentWatcher:OP,getTransitionRawChildren:jm,guardReactiveProps:C4,h:Gm,handleError:ch,hasInjectionContext:e4,hydrate:h6,hydrateOnIdle:rM,hydrateOnInteraction:aM,hydrateOnMediaQuery:sM,hydrateOnVisible:oM,initCustomFormatter:vA,initDirectivesForSSR:d6,inject:Zl,isMemoSame:D4,isProxy:Bm,isReactive:dc,isReadonly:Sf,isRef:Xo,isRuntimeOnly:pA,isShallow:Wl,isVNode:Vc,markRaw:Rm,mergeDefaults:AM,mergeModels:kM,mergeProps:P4,nextTick:Us,normalizeClass:Vi,normalizeProps:JC,normalizeStyle:ql,onActivated:$w,onBeforeMount:Gw,onBeforeUnmount:fh,onBeforeUpdate:K1,onDeactivated:Uw,onErrorCaptured:Zw,onMounted:Cs,onRenderTracked:Ww,onRenderTriggered:qw,onScopeDispose:aw,onServerPrefetch:Hw,onUnmounted:mc,onUpdated:$m,onWatcherCleanup:Pw,openBlock:$e,popScopeId:HP,provide:ep,proxyRefs:G1,pushScopeId:GP,queuePostFlushCb:mp,reactive:Yl,readonly:Ru,ref:zt,registerRuntimeCompiler:dA,render:J4,renderList:Lr,renderSlot:vM,resolveComponent:Kw,resolveDirective:gM,resolveDynamicComponent:pM,resolveFilter:EA,resolveTransitionHooks:rd,setBlockTracking:Rv,setDevtoolsHook:xA,setTransitionHooks:Uc,shallowReactive:U1,shallowReadonly:xP,shallowRef:V1,ssrContextKey:g4,ssrUtils:SA,stop:rP,toDisplayString:Zt,toHandlerKey:Kd,toHandlers:yM,toRaw:Di,toRef:kP,toRefs:Ew,toValue:EP,transformVNodeArgs:lA,triggerRef:SP,unref:Kn,useAttrs:MM,useCssModule:XA,useCssVars:BA,useHost:V4,useId:KP,useModel:KM,useSSRContext:m4,useShadowRoot:JA,useSlots:PM,useTemplateRef:YP,useTransitionState:q1,vModelCheckbox:wl,vModelDynamic:iy,vModelRadio:ry,vModelSelect:vo,vModelText:ni,vShow:Hm,version:I4,warn:_A,watch:oo,watchEffect:wp,watchPostEffect:WM,watchSyncEffect:v4,withAsyncContext:NM,withCtx:pu,withDefaults:CM,withDirectives:Fn,withKeys:f6,withMemo:yA,withModifiers:Gc,withScopeId:qP},Symbol.toStringTag,{value:"Module"}));/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let t5;const Wm=e=>t5=e,n5=Symbol();function Wv(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var rp;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(rp||(rp={}));function m6(){const e=R1(!0),n=e.run(()=>zt({}));let t=[],r=[];const i=Rm({install(s){Wm(i),i._a=s,s.provide(n5,i),s.config.globalProperties.$pinia=i,r.forEach(o=>t.push(o)),r=[]},use(s){return this._a?t.push(s):r.push(s),this},_p:t,_a:null,_e:e,_s:new Map,state:n});return i}const r5=()=>{};function y_(e,n,t,r=r5){e.push(n);const i=()=>{const s=e.indexOf(n);s>-1&&(e.splice(s,1),r())};return!t&&F1()&&aw(i),i}function Th(e,...n){e.slice().forEach(t=>{t(...n)})}const v6=e=>e(),__=Symbol(),W0=Symbol();function Zv(e,n){e instanceof Map&&n instanceof Map?n.forEach((t,r)=>e.set(r,t)):e instanceof Set&&n instanceof Set&&n.forEach(e.add,e);for(const t in n){if(!n.hasOwnProperty(t))continue;const r=n[t],i=e[t];Wv(i)&&Wv(r)&&e.hasOwnProperty(t)&&!Xo(r)&&!dc(r)?e[t]=Zv(i,r):e[t]=r}return e}const y6=Symbol();function _6(e){return!Wv(e)||!e.hasOwnProperty(y6)}const{assign:lf}=Object;function b6(e){return!!(Xo(e)&&e.effect)}function w6(e,n,t,r){const{state:i,actions:s,getters:o}=n,u=t.state.value[e];let f;function d(){u||(t.state.value[e]=i?i():{});const m=Ew(t.state.value[e]);return lf(m,s,Object.keys(o||{}).reduce((_,w)=>(_[w]=Rm(sr(()=>{Wm(t);const y=t._s.get(e);return o[w].call(y,y)})),_),{}))}return f=i5(e,d,n,t,r,!0),f}function i5(e,n,t={},r,i,s){let o;const u=lf({actions:{}},t),f={deep:!0};let d,m,_=[],w=[],y;const M=r.state.value[e];!s&&!M&&(r.state.value[e]={}),zt({});let k;function F(z){let U;d=m=!1,typeof z=="function"?(z(r.state.value[e]),U={type:rp.patchFunction,storeId:e,events:y}):(Zv(r.state.value[e],z),U={type:rp.patchObject,payload:z,storeId:e,events:y});const J=k=Symbol();Us().then(()=>{k===J&&(d=!0)}),m=!0,Th(_,U,r.state.value[e])}const I=s?function(){const{state:U}=t,J=U?U():{};this.$patch(T=>{lf(T,J)})}:r5;function R(){o.stop(),_=[],w=[],r._s.delete(e)}const K=(z,U="")=>{if(__ in z)return z[W0]=U,z;const J=function(){Wm(r);const T=Array.from(arguments),D=[],B=[];function $(oe){D.push(oe)}function W(oe){B.push(oe)}Th(w,{args:T,name:J[W0],store:he,after:$,onError:W});let G;try{G=z.apply(this&&this.$id===e?this:he,T)}catch(oe){throw Th(B,oe),oe}return G instanceof Promise?G.then(oe=>(Th(D,oe),oe)).catch(oe=>(Th(B,oe),Promise.reject(oe))):(Th(D,G),G)};return J[__]=!0,J[W0]=U,J},ee={_p:r,$id:e,$onAction:y_.bind(null,w),$patch:F,$reset:I,$subscribe(z,U={}){const J=y_(_,z,U.detached,()=>T()),T=o.run(()=>oo(()=>r.state.value[e],D=>{(U.flush==="sync"?m:d)&&z({storeId:e,type:rp.direct,events:y},D)},lf({},f,U)));return J},$dispose:R},he=Yl(ee);r._s.set(e,he);const ve=(r._a&&r._a.runWithContext||v6)(()=>r._e.run(()=>(o=R1()).run(()=>n({action:K}))));for(const z in ve){const U=ve[z];if(Xo(U)&&!b6(U)||dc(U))s||(M&&_6(U)&&(Xo(U)?U.value=M[z]:Zv(U,M[z])),r.state.value[e][z]=U);else if(typeof U=="function"){const J=K(U,z);ve[z]=J,u.actions[z]=U}}return lf(he,ve),lf(Di(he),ve),Object.defineProperty(he,"$state",{get:()=>r.state.value[e],set:z=>{F(U=>{lf(U,z)})}}),r._p.forEach(z=>{lf(he,o.run(()=>z({store:he,app:r._a,pinia:r,options:u})))}),M&&s&&t.hydrate&&t.hydrate(he.$state,M),d=!0,m=!0,he}/*! #__NO_SIDE_EFFECTS__ */function Dp(e,n,t){let r,i;const s=typeof n=="function";typeof e=="string"?(r=e,i=s?t:n):(i=e,r=e.id);function o(u,f){const d=e4();return u=u||(d?Zl(n5,null):null),u&&Wm(u),u=t5,u._s.has(r)||(s?i5(r,n,i,u):w6(r,i,u)),u._s.get(r)}return o.$id=r,o}function o5(e,n){return function(){return e.apply(n,arguments)}}const{toString:x6}=Object.prototype,{getPrototypeOf:oy}=Object,Zm=(e=>n=>{const t=x6.call(n);return e[t]||(e[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Wu=e=>(e=e.toLowerCase(),n=>Zm(n)===e),Km=e=>n=>typeof n===e,{isArray:pd}=Array,Lp=Km("undefined");function L6(e){return e!==null&&!Lp(e)&&e.constructor!==null&&!Lp(e.constructor)&&Kl(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const s5=Wu("ArrayBuffer");function S6(e){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(e):n=e&&e.buffer&&s5(e.buffer),n}const E6=Km("string"),Kl=Km("function"),a5=Km("number"),Ym=e=>e!==null&&typeof e=="object",C6=e=>e===!0||e===!1,Dg=e=>{if(Zm(e)!=="object")return!1;const n=oy(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},P6=Wu("Date"),M6=Wu("File"),A6=Wu("Blob"),k6=Wu("FileList"),T6=e=>Ym(e)&&Kl(e.pipe),N6=e=>{let n;return e&&(typeof FormData=="function"&&e instanceof FormData||Kl(e.append)&&((n=Zm(e))==="formdata"||n==="object"&&Kl(e.toString)&&e.toString()==="[object FormData]"))},D6=Wu("URLSearchParams"),[I6,O6,B6,R6]=["ReadableStream","Request","Response","Headers"].map(Wu),F6=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ip(e,n,{allOwnKeys:t=!1}={}){if(e===null||typeof e>"u")return;let r,i;if(typeof e!="object"&&(e=[e]),pd(e))for(r=0,i=e.length;r<i;r++)n.call(null,e[r],r,e);else{const s=t?Object.getOwnPropertyNames(e):Object.keys(e),o=s.length;let u;for(r=0;r<o;r++)u=s[r],n.call(null,e[u],u,e)}}function l5(e,n){n=n.toLowerCase();const t=Object.keys(e);let r=t.length,i;for(;r-- >0;)if(i=t[r],n===i.toLowerCase())return i;return null}const Jf=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,u5=e=>!Lp(e)&&e!==Jf;function Kv(){const{caseless:e}=u5(this)&&this||{},n={},t=(r,i)=>{const s=e&&l5(n,i)||i;Dg(n[s])&&Dg(r)?n[s]=Kv(n[s],r):Dg(r)?n[s]=Kv({},r):pd(r)?n[s]=r.slice():n[s]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&Ip(arguments[r],t);return n}const j6=(e,n,t,{allOwnKeys:r}={})=>(Ip(n,(i,s)=>{t&&Kl(i)?e[s]=o5(i,t):e[s]=i},{allOwnKeys:r}),e),z6=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),$6=(e,n,t,r)=>{e.prototype=Object.create(n.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:n.prototype}),t&&Object.assign(e.prototype,t)},U6=(e,n,t,r)=>{let i,s,o;const u={};if(n=n||{},e==null)return n;do{for(i=Object.getOwnPropertyNames(e),s=i.length;s-- >0;)o=i[s],(!r||r(o,e,n))&&!u[o]&&(n[o]=e[o],u[o]=!0);e=t!==!1&&oy(e)}while(e&&(!t||t(e,n))&&e!==Object.prototype);return n},V6=(e,n,t)=>{e=String(e),(t===void 0||t>e.length)&&(t=e.length),t-=n.length;const r=e.indexOf(n,t);return r!==-1&&r===t},G6=e=>{if(!e)return null;if(pd(e))return e;let n=e.length;if(!a5(n))return null;const t=new Array(n);for(;n-- >0;)t[n]=e[n];return t},H6=(e=>n=>e&&n instanceof e)(typeof Uint8Array<"u"&&oy(Uint8Array)),q6=(e,n)=>{const r=(e&&e[Symbol.iterator]).call(e);let i;for(;(i=r.next())&&!i.done;){const s=i.value;n.call(e,s[0],s[1])}},W6=(e,n)=>{let t;const r=[];for(;(t=e.exec(n))!==null;)r.push(t);return r},Z6=Wu("HTMLFormElement"),K6=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,i){return r.toUpperCase()+i}),b_=(({hasOwnProperty:e})=>(n,t)=>e.call(n,t))(Object.prototype),Y6=Wu("RegExp"),c5=(e,n)=>{const t=Object.getOwnPropertyDescriptors(e),r={};Ip(t,(i,s)=>{let o;(o=n(i,s,e))!==!1&&(r[s]=o||i)}),Object.defineProperties(e,r)},J6=e=>{c5(e,(n,t)=>{if(Kl(e)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=e[t];if(Kl(r)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},X6=(e,n)=>{const t={},r=i=>{i.forEach(s=>{t[s]=!0})};return pd(e)?r(e):r(String(e).split(n)),t},Q6=()=>{},ek=(e,n)=>e!=null&&Number.isFinite(e=+e)?e:n;function tk(e){return!!(e&&Kl(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const nk=e=>{const n=new Array(10),t=(r,i)=>{if(Ym(r)){if(n.indexOf(r)>=0)return;if(!("toJSON"in r)){n[i]=r;const s=pd(r)?[]:{};return Ip(r,(o,u)=>{const f=t(o,i+1);!Lp(f)&&(s[u]=f)}),n[i]=void 0,s}}return r};return t(e,0)},rk=Wu("AsyncFunction"),ik=e=>e&&(Ym(e)||Kl(e))&&Kl(e.then)&&Kl(e.catch),f5=((e,n)=>e?setImmediate:n?((t,r)=>(Jf.addEventListener("message",({source:i,data:s})=>{i===Jf&&s===t&&r.length&&r.shift()()},!1),i=>{r.push(i),Jf.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Kl(Jf.postMessage)),ok=typeof queueMicrotask<"u"?queueMicrotask.bind(Jf):typeof process<"u"&&process.nextTick||f5,Yt={isArray:pd,isArrayBuffer:s5,isBuffer:L6,isFormData:N6,isArrayBufferView:S6,isString:E6,isNumber:a5,isBoolean:C6,isObject:Ym,isPlainObject:Dg,isReadableStream:I6,isRequest:O6,isResponse:B6,isHeaders:R6,isUndefined:Lp,isDate:P6,isFile:M6,isBlob:A6,isRegExp:Y6,isFunction:Kl,isStream:T6,isURLSearchParams:D6,isTypedArray:H6,isFileList:k6,forEach:Ip,merge:Kv,extend:j6,trim:F6,stripBOM:z6,inherits:$6,toFlatObject:U6,kindOf:Zm,kindOfTest:Wu,endsWith:V6,toArray:G6,forEachEntry:q6,matchAll:W6,isHTMLForm:Z6,hasOwnProperty:b_,hasOwnProp:b_,reduceDescriptors:c5,freezeMethods:J6,toObjectSet:X6,toCamelCase:K6,noop:Q6,toFiniteNumber:ek,findKey:l5,global:Jf,isContextDefined:u5,isSpecCompliantForm:tk,toJSONObject:nk,isAsyncFn:rk,isThenable:ik,setImmediate:f5,asap:ok};function ri(e,n,t,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",n&&(this.code=n),t&&(this.config=t),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}Yt.inherits(ri,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Yt.toJSONObject(this.config),code:this.code,status:this.status}}});const h5=ri.prototype,d5={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{d5[e]={value:e}});Object.defineProperties(ri,d5);Object.defineProperty(h5,"isAxiosError",{value:!0});ri.from=(e,n,t,r,i,s)=>{const o=Object.create(h5);return Yt.toFlatObject(e,o,function(f){return f!==Error.prototype},u=>u!=="isAxiosError"),ri.call(o,e.message,n,t,r,i),o.cause=e,o.name=e.name,s&&Object.assign(o,s),o};const sk=null;function Yv(e){return Yt.isPlainObject(e)||Yt.isArray(e)}function p5(e){return Yt.endsWith(e,"[]")?e.slice(0,-2):e}function w_(e,n,t){return e?e.concat(n).map(function(i,s){return i=p5(i),!t&&s?"["+i+"]":i}).join(t?".":""):n}function ak(e){return Yt.isArray(e)&&!e.some(Yv)}const lk=Yt.toFlatObject(Yt,{},null,function(n){return/^is[A-Z]/.test(n)});function Jm(e,n,t){if(!Yt.isObject(e))throw new TypeError("target must be an object");n=n||new FormData,t=Yt.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(k,F){return!Yt.isUndefined(F[k])});const r=t.metaTokens,i=t.visitor||m,s=t.dots,o=t.indexes,f=(t.Blob||typeof Blob<"u"&&Blob)&&Yt.isSpecCompliantForm(n);if(!Yt.isFunction(i))throw new TypeError("visitor must be a function");function d(M){if(M===null)return"";if(Yt.isDate(M))return M.toISOString();if(!f&&Yt.isBlob(M))throw new ri("Blob is not supported. Use a Buffer instead.");return Yt.isArrayBuffer(M)||Yt.isTypedArray(M)?f&&typeof Blob=="function"?new Blob([M]):Buffer.from(M):M}function m(M,k,F){let I=M;if(M&&!F&&typeof M=="object"){if(Yt.endsWith(k,"{}"))k=r?k:k.slice(0,-2),M=JSON.stringify(M);else if(Yt.isArray(M)&&ak(M)||(Yt.isFileList(M)||Yt.endsWith(k,"[]"))&&(I=Yt.toArray(M)))return k=p5(k),I.forEach(function(K,ee){!(Yt.isUndefined(K)||K===null)&&n.append(o===!0?w_([k],ee,s):o===null?k:k+"[]",d(K))}),!1}return Yv(M)?!0:(n.append(w_(F,k,s),d(M)),!1)}const _=[],w=Object.assign(lk,{defaultVisitor:m,convertValue:d,isVisitable:Yv});function y(M,k){if(!Yt.isUndefined(M)){if(_.indexOf(M)!==-1)throw Error("Circular reference detected in "+k.join("."));_.push(M),Yt.forEach(M,function(I,R){(!(Yt.isUndefined(I)||I===null)&&i.call(n,I,Yt.isString(R)?R.trim():R,k,w))===!0&&y(I,k?k.concat(R):[R])}),_.pop()}}if(!Yt.isObject(e))throw new TypeError("data must be an object");return y(e),n}function x_(e){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return n[r]})}function sy(e,n){this._pairs=[],e&&Jm(e,this,n)}const g5=sy.prototype;g5.append=function(n,t){this._pairs.push([n,t])};g5.toString=function(n){const t=n?function(r){return n.call(this,r,x_)}:x_;return this._pairs.map(function(i){return t(i[0])+"="+t(i[1])},"").join("&")};function uk(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function m5(e,n,t){if(!n)return e;const r=t&&t.encode||uk;Yt.isFunction(t)&&(t={serialize:t});const i=t&&t.serialize;let s;if(i?s=i(n,t):s=Yt.isURLSearchParams(n)?n.toString():new sy(n,t).toString(r),s){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class L_{constructor(){this.handlers=[]}use(n,t,r){return this.handlers.push({fulfilled:n,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){Yt.forEach(this.handlers,function(r){r!==null&&n(r)})}}const v5={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ck=typeof URLSearchParams<"u"?URLSearchParams:sy,fk=typeof FormData<"u"?FormData:null,hk=typeof Blob<"u"?Blob:null,dk={isBrowser:!0,classes:{URLSearchParams:ck,FormData:fk,Blob:hk},protocols:["http","https","file","blob","url","data"]},ay=typeof window<"u"&&typeof document<"u",Jv=typeof navigator=="object"&&navigator||void 0,pk=ay&&(!Jv||["ReactNative","NativeScript","NS"].indexOf(Jv.product)<0),gk=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",mk=ay&&window.location.href||"http://localhost",vk=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ay,hasStandardBrowserEnv:pk,hasStandardBrowserWebWorkerEnv:gk,navigator:Jv,origin:mk},Symbol.toStringTag,{value:"Module"})),Ba={...vk,...dk};function yk(e,n){return Jm(e,new Ba.classes.URLSearchParams,Object.assign({visitor:function(t,r,i,s){return Ba.isNode&&Yt.isBuffer(t)?(this.append(r,t.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},n))}function _k(e){return Yt.matchAll(/\w+|\[(\w*)]/g,e).map(n=>n[0]==="[]"?"":n[1]||n[0])}function bk(e){const n={},t=Object.keys(e);let r;const i=t.length;let s;for(r=0;r<i;r++)s=t[r],n[s]=e[s];return n}function y5(e){function n(t,r,i,s){let o=t[s++];if(o==="__proto__")return!0;const u=Number.isFinite(+o),f=s>=t.length;return o=!o&&Yt.isArray(i)?i.length:o,f?(Yt.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!u):((!i[o]||!Yt.isObject(i[o]))&&(i[o]=[]),n(t,r,i[o],s)&&Yt.isArray(i[o])&&(i[o]=bk(i[o])),!u)}if(Yt.isFormData(e)&&Yt.isFunction(e.entries)){const t={};return Yt.forEachEntry(e,(r,i)=>{n(_k(r),i,t,0)}),t}return null}function wk(e,n,t){if(Yt.isString(e))try{return(n||JSON.parse)(e),Yt.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(e)}const Op={transitional:v5,adapter:["xhr","http","fetch"],transformRequest:[function(n,t){const r=t.getContentType()||"",i=r.indexOf("application/json")>-1,s=Yt.isObject(n);if(s&&Yt.isHTMLForm(n)&&(n=new FormData(n)),Yt.isFormData(n))return i?JSON.stringify(y5(n)):n;if(Yt.isArrayBuffer(n)||Yt.isBuffer(n)||Yt.isStream(n)||Yt.isFile(n)||Yt.isBlob(n)||Yt.isReadableStream(n))return n;if(Yt.isArrayBufferView(n))return n.buffer;if(Yt.isURLSearchParams(n))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let u;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return yk(n,this.formSerializer).toString();if((u=Yt.isFileList(n))||r.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return Jm(u?{"files[]":n}:n,f&&new f,this.formSerializer)}}return s||i?(t.setContentType("application/json",!1),wk(n)):n}],transformResponse:[function(n){const t=this.transitional||Op.transitional,r=t&&t.forcedJSONParsing,i=this.responseType==="json";if(Yt.isResponse(n)||Yt.isReadableStream(n))return n;if(n&&Yt.isString(n)&&(r&&!this.responseType||i)){const o=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(n)}catch(u){if(o)throw u.name==="SyntaxError"?ri.from(u,ri.ERR_BAD_RESPONSE,this,null,this.response):u}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ba.classes.FormData,Blob:Ba.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Yt.forEach(["delete","get","head","post","put","patch"],e=>{Op.headers[e]={}});const xk=Yt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Lk=e=>{const n={};let t,r,i;return e&&e.split(`
`).forEach(function(o){i=o.indexOf(":"),t=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!t||n[t]&&xk[t])&&(t==="set-cookie"?n[t]?n[t].push(r):n[t]=[r]:n[t]=n[t]?n[t]+", "+r:r)}),n},S_=Symbol("internals");function Ad(e){return e&&String(e).trim().toLowerCase()}function Ig(e){return e===!1||e==null?e:Yt.isArray(e)?e.map(Ig):String(e)}function Sk(e){const n=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(e);)n[r[1]]=r[2];return n}const Ek=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Z0(e,n,t,r,i){if(Yt.isFunction(r))return r.call(this,n,t);if(i&&(n=t),!!Yt.isString(n)){if(Yt.isString(r))return n.indexOf(r)!==-1;if(Yt.isRegExp(r))return r.test(n)}}function Ck(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,t,r)=>t.toUpperCase()+r)}function Pk(e,n){const t=Yt.toCamelCase(" "+n);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+t,{value:function(i,s,o){return this[r].call(this,n,i,s,o)},configurable:!0})})}let El=class{constructor(n){n&&this.set(n)}set(n,t,r){const i=this;function s(u,f,d){const m=Ad(f);if(!m)throw new Error("header name must be a non-empty string");const _=Yt.findKey(i,m);(!_||i[_]===void 0||d===!0||d===void 0&&i[_]!==!1)&&(i[_||f]=Ig(u))}const o=(u,f)=>Yt.forEach(u,(d,m)=>s(d,m,f));if(Yt.isPlainObject(n)||n instanceof this.constructor)o(n,t);else if(Yt.isString(n)&&(n=n.trim())&&!Ek(n))o(Lk(n),t);else if(Yt.isHeaders(n))for(const[u,f]of n.entries())s(f,u,r);else n!=null&&s(t,n,r);return this}get(n,t){if(n=Ad(n),n){const r=Yt.findKey(this,n);if(r){const i=this[r];if(!t)return i;if(t===!0)return Sk(i);if(Yt.isFunction(t))return t.call(this,i,r);if(Yt.isRegExp(t))return t.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,t){if(n=Ad(n),n){const r=Yt.findKey(this,n);return!!(r&&this[r]!==void 0&&(!t||Z0(this,this[r],r,t)))}return!1}delete(n,t){const r=this;let i=!1;function s(o){if(o=Ad(o),o){const u=Yt.findKey(r,o);u&&(!t||Z0(r,r[u],u,t))&&(delete r[u],i=!0)}}return Yt.isArray(n)?n.forEach(s):s(n),i}clear(n){const t=Object.keys(this);let r=t.length,i=!1;for(;r--;){const s=t[r];(!n||Z0(this,this[s],s,n,!0))&&(delete this[s],i=!0)}return i}normalize(n){const t=this,r={};return Yt.forEach(this,(i,s)=>{const o=Yt.findKey(r,s);if(o){t[o]=Ig(i),delete t[s];return}const u=n?Ck(s):String(s).trim();u!==s&&delete t[s],t[u]=Ig(i),r[u]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const t=Object.create(null);return Yt.forEach(this,(r,i)=>{r!=null&&r!==!1&&(t[i]=n&&Yt.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,t])=>n+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...t){const r=new this(n);return t.forEach(i=>r.set(i)),r}static accessor(n){const r=(this[S_]=this[S_]={accessors:{}}).accessors,i=this.prototype;function s(o){const u=Ad(o);r[u]||(Pk(i,o),r[u]=!0)}return Yt.isArray(n)?n.forEach(s):s(n),this}};El.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Yt.reduceDescriptors(El.prototype,({value:e},n)=>{let t=n[0].toUpperCase()+n.slice(1);return{get:()=>e,set(r){this[t]=r}}});Yt.freezeMethods(El);function K0(e,n){const t=this||Op,r=n||t,i=El.from(r.headers);let s=r.data;return Yt.forEach(e,function(u){s=u.call(t,s,i.normalize(),n?n.status:void 0)}),i.normalize(),s}function _5(e){return!!(e&&e.__CANCEL__)}function gd(e,n,t){ri.call(this,e??"canceled",ri.ERR_CANCELED,n,t),this.name="CanceledError"}Yt.inherits(gd,ri,{__CANCEL__:!0});function b5(e,n,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?e(t):n(new ri("Request failed with status code "+t.status,[ri.ERR_BAD_REQUEST,ri.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function Mk(e){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}function Ak(e,n){e=e||10;const t=new Array(e),r=new Array(e);let i=0,s=0,o;return n=n!==void 0?n:1e3,function(f){const d=Date.now(),m=r[s];o||(o=d),t[i]=f,r[i]=d;let _=s,w=0;for(;_!==i;)w+=t[_++],_=_%e;if(i=(i+1)%e,i===s&&(s=(s+1)%e),d-o<n)return;const y=m&&d-m;return y?Math.round(w*1e3/y):void 0}}function kk(e,n){let t=0,r=1e3/n,i,s;const o=(d,m=Date.now())=>{t=m,i=null,s&&(clearTimeout(s),s=null),e.apply(null,d)};return[(...d)=>{const m=Date.now(),_=m-t;_>=r?o(d,m):(i=d,s||(s=setTimeout(()=>{s=null,o(i)},r-_)))},()=>i&&o(i)]}const cm=(e,n,t=3)=>{let r=0;const i=Ak(50,250);return kk(s=>{const o=s.loaded,u=s.lengthComputable?s.total:void 0,f=o-r,d=i(f),m=o<=u;r=o;const _={loaded:o,total:u,progress:u?o/u:void 0,bytes:f,rate:d||void 0,estimated:d&&u&&m?(u-o)/d:void 0,event:s,lengthComputable:u!=null,[n?"download":"upload"]:!0};e(_)},t)},E_=(e,n)=>{const t=e!=null;return[r=>n[0]({lengthComputable:t,total:e,loaded:r}),n[1]]},C_=e=>(...n)=>Yt.asap(()=>e(...n)),Tk=Ba.hasStandardBrowserEnv?((e,n)=>t=>(t=new URL(t,Ba.origin),e.protocol===t.protocol&&e.host===t.host&&(n||e.port===t.port)))(new URL(Ba.origin),Ba.navigator&&/(msie|trident)/i.test(Ba.navigator.userAgent)):()=>!0,Nk=Ba.hasStandardBrowserEnv?{write(e,n,t,r,i,s){const o=[e+"="+encodeURIComponent(n)];Yt.isNumber(t)&&o.push("expires="+new Date(t).toGMTString()),Yt.isString(r)&&o.push("path="+r),Yt.isString(i)&&o.push("domain="+i),s===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const n=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Dk(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Ik(e,n){return n?e.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):e}function w5(e,n,t){let r=!Dk(n);return e&&(r||t==!1)?Ik(e,n):n}const P_=e=>e instanceof El?{...e}:e;function ah(e,n){n=n||{};const t={};function r(d,m,_,w){return Yt.isPlainObject(d)&&Yt.isPlainObject(m)?Yt.merge.call({caseless:w},d,m):Yt.isPlainObject(m)?Yt.merge({},m):Yt.isArray(m)?m.slice():m}function i(d,m,_,w){if(Yt.isUndefined(m)){if(!Yt.isUndefined(d))return r(void 0,d,_,w)}else return r(d,m,_,w)}function s(d,m){if(!Yt.isUndefined(m))return r(void 0,m)}function o(d,m){if(Yt.isUndefined(m)){if(!Yt.isUndefined(d))return r(void 0,d)}else return r(void 0,m)}function u(d,m,_){if(_ in n)return r(d,m);if(_ in e)return r(void 0,d)}const f={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:u,headers:(d,m,_)=>i(P_(d),P_(m),_,!0)};return Yt.forEach(Object.keys(Object.assign({},e,n)),function(m){const _=f[m]||i,w=_(e[m],n[m],m);Yt.isUndefined(w)&&_!==u||(t[m]=w)}),t}const x5=e=>{const n=ah({},e);let{data:t,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:s,headers:o,auth:u}=n;n.headers=o=El.from(o),n.url=m5(w5(n.baseURL,n.url,n.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&o.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):"")));let f;if(Yt.isFormData(t)){if(Ba.hasStandardBrowserEnv||Ba.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((f=o.getContentType())!==!1){const[d,...m]=f?f.split(";").map(_=>_.trim()).filter(Boolean):[];o.setContentType([d||"multipart/form-data",...m].join("; "))}}if(Ba.hasStandardBrowserEnv&&(r&&Yt.isFunction(r)&&(r=r(n)),r||r!==!1&&Tk(n.url))){const d=i&&s&&Nk.read(s);d&&o.set(i,d)}return n},Ok=typeof XMLHttpRequest<"u",Bk=Ok&&function(e){return new Promise(function(t,r){const i=x5(e);let s=i.data;const o=El.from(i.headers).normalize();let{responseType:u,onUploadProgress:f,onDownloadProgress:d}=i,m,_,w,y,M;function k(){y&&y(),M&&M(),i.cancelToken&&i.cancelToken.unsubscribe(m),i.signal&&i.signal.removeEventListener("abort",m)}let F=new XMLHttpRequest;F.open(i.method.toUpperCase(),i.url,!0),F.timeout=i.timeout;function I(){if(!F)return;const K=El.from("getAllResponseHeaders"in F&&F.getAllResponseHeaders()),he={data:!u||u==="text"||u==="json"?F.responseText:F.response,status:F.status,statusText:F.statusText,headers:K,config:e,request:F};b5(function(ve){t(ve),k()},function(ve){r(ve),k()},he),F=null}"onloadend"in F?F.onloadend=I:F.onreadystatechange=function(){!F||F.readyState!==4||F.status===0&&!(F.responseURL&&F.responseURL.indexOf("file:")===0)||setTimeout(I)},F.onabort=function(){F&&(r(new ri("Request aborted",ri.ECONNABORTED,e,F)),F=null)},F.onerror=function(){r(new ri("Network Error",ri.ERR_NETWORK,e,F)),F=null},F.ontimeout=function(){let ee=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const he=i.transitional||v5;i.timeoutErrorMessage&&(ee=i.timeoutErrorMessage),r(new ri(ee,he.clarifyTimeoutError?ri.ETIMEDOUT:ri.ECONNABORTED,e,F)),F=null},s===void 0&&o.setContentType(null),"setRequestHeader"in F&&Yt.forEach(o.toJSON(),function(ee,he){F.setRequestHeader(he,ee)}),Yt.isUndefined(i.withCredentials)||(F.withCredentials=!!i.withCredentials),u&&u!=="json"&&(F.responseType=i.responseType),d&&([w,M]=cm(d,!0),F.addEventListener("progress",w)),f&&F.upload&&([_,y]=cm(f),F.upload.addEventListener("progress",_),F.upload.addEventListener("loadend",y)),(i.cancelToken||i.signal)&&(m=K=>{F&&(r(!K||K.type?new gd(null,e,F):K),F.abort(),F=null)},i.cancelToken&&i.cancelToken.subscribe(m),i.signal&&(i.signal.aborted?m():i.signal.addEventListener("abort",m)));const R=Mk(i.url);if(R&&Ba.protocols.indexOf(R)===-1){r(new ri("Unsupported protocol "+R+":",ri.ERR_BAD_REQUEST,e));return}F.send(s||null)})},Rk=(e,n)=>{const{length:t}=e=e?e.filter(Boolean):[];if(n||t){let r=new AbortController,i;const s=function(d){if(!i){i=!0,u();const m=d instanceof Error?d:this.reason;r.abort(m instanceof ri?m:new gd(m instanceof Error?m.message:m))}};let o=n&&setTimeout(()=>{o=null,s(new ri(`timeout ${n} of ms exceeded`,ri.ETIMEDOUT))},n);const u=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(s):d.removeEventListener("abort",s)}),e=null)};e.forEach(d=>d.addEventListener("abort",s));const{signal:f}=r;return f.unsubscribe=()=>Yt.asap(u),f}},Fk=function*(e,n){let t=e.byteLength;if(t<n){yield e;return}let r=0,i;for(;r<t;)i=r+n,yield e.slice(r,i),r=i},jk=async function*(e,n){for await(const t of zk(e))yield*Fk(t,n)},zk=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const n=e.getReader();try{for(;;){const{done:t,value:r}=await n.read();if(t)break;yield r}}finally{await n.cancel()}},M_=(e,n,t,r)=>{const i=jk(e,n);let s=0,o,u=f=>{o||(o=!0,r&&r(f))};return new ReadableStream({async pull(f){try{const{done:d,value:m}=await i.next();if(d){u(),f.close();return}let _=m.byteLength;if(t){let w=s+=_;t(w)}f.enqueue(new Uint8Array(m))}catch(d){throw u(d),d}},cancel(f){return u(f),i.return()}},{highWaterMark:2})},Xm=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",L5=Xm&&typeof ReadableStream=="function",$k=Xm&&(typeof TextEncoder=="function"?(e=>n=>e.encode(n))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),S5=(e,...n)=>{try{return!!e(...n)}catch{return!1}},Uk=L5&&S5(()=>{let e=!1;const n=new Request(Ba.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!n}),A_=64*1024,Xv=L5&&S5(()=>Yt.isReadableStream(new Response("").body)),fm={stream:Xv&&(e=>e.body)};Xm&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(n=>{!fm[n]&&(fm[n]=Yt.isFunction(e[n])?t=>t[n]():(t,r)=>{throw new ri(`Response type '${n}' is not supported`,ri.ERR_NOT_SUPPORT,r)})})})(new Response);const Vk=async e=>{if(e==null)return 0;if(Yt.isBlob(e))return e.size;if(Yt.isSpecCompliantForm(e))return(await new Request(Ba.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(Yt.isArrayBufferView(e)||Yt.isArrayBuffer(e))return e.byteLength;if(Yt.isURLSearchParams(e)&&(e=e+""),Yt.isString(e))return(await $k(e)).byteLength},Gk=async(e,n)=>{const t=Yt.toFiniteNumber(e.getContentLength());return t??Vk(n)},Hk=Xm&&(async e=>{let{url:n,method:t,data:r,signal:i,cancelToken:s,timeout:o,onDownloadProgress:u,onUploadProgress:f,responseType:d,headers:m,withCredentials:_="same-origin",fetchOptions:w}=x5(e);d=d?(d+"").toLowerCase():"text";let y=Rk([i,s&&s.toAbortSignal()],o),M;const k=y&&y.unsubscribe&&(()=>{y.unsubscribe()});let F;try{if(f&&Uk&&t!=="get"&&t!=="head"&&(F=await Gk(m,r))!==0){let he=new Request(n,{method:"POST",body:r,duplex:"half"}),fe;if(Yt.isFormData(r)&&(fe=he.headers.get("content-type"))&&m.setContentType(fe),he.body){const[ve,z]=E_(F,cm(C_(f)));r=M_(he.body,A_,ve,z)}}Yt.isString(_)||(_=_?"include":"omit");const I="credentials"in Request.prototype;M=new Request(n,{...w,signal:y,method:t.toUpperCase(),headers:m.normalize().toJSON(),body:r,duplex:"half",credentials:I?_:void 0});let R=await fetch(M);const K=Xv&&(d==="stream"||d==="response");if(Xv&&(u||K&&k)){const he={};["status","statusText","headers"].forEach(U=>{he[U]=R[U]});const fe=Yt.toFiniteNumber(R.headers.get("content-length")),[ve,z]=u&&E_(fe,cm(C_(u),!0))||[];R=new Response(M_(R.body,A_,ve,()=>{z&&z(),k&&k()}),he)}d=d||"text";let ee=await fm[Yt.findKey(fm,d)||"text"](R,e);return!K&&k&&k(),await new Promise((he,fe)=>{b5(he,fe,{data:ee,headers:El.from(R.headers),status:R.status,statusText:R.statusText,config:e,request:M})})}catch(I){throw k&&k(),I&&I.name==="TypeError"&&/fetch/i.test(I.message)?Object.assign(new ri("Network Error",ri.ERR_NETWORK,e,M),{cause:I.cause||I}):ri.from(I,I&&I.code,e,M)}}),Qv={http:sk,xhr:Bk,fetch:Hk};Yt.forEach(Qv,(e,n)=>{if(e){try{Object.defineProperty(e,"name",{value:n})}catch{}Object.defineProperty(e,"adapterName",{value:n})}});const k_=e=>`- ${e}`,qk=e=>Yt.isFunction(e)||e===null||e===!1,E5={getAdapter:e=>{e=Yt.isArray(e)?e:[e];const{length:n}=e;let t,r;const i={};for(let s=0;s<n;s++){t=e[s];let o;if(r=t,!qk(t)&&(r=Qv[(o=String(t)).toLowerCase()],r===void 0))throw new ri(`Unknown adapter '${o}'`);if(r)break;i[o||"#"+s]=r}if(!r){const s=Object.entries(i).map(([u,f])=>`adapter ${u} `+(f===!1?"is not supported by the environment":"is not available in the build"));let o=n?s.length>1?`since :
`+s.map(k_).join(`
`):" "+k_(s[0]):"as no adapter specified";throw new ri("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:Qv};function Y0(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new gd(null,e)}function T_(e){return Y0(e),e.headers=El.from(e.headers),e.data=K0.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),E5.getAdapter(e.adapter||Op.adapter)(e).then(function(r){return Y0(e),r.data=K0.call(e,e.transformResponse,r),r.headers=El.from(r.headers),r},function(r){return _5(r)||(Y0(e),r&&r.response&&(r.response.data=K0.call(e,e.transformResponse,r.response),r.response.headers=El.from(r.response.headers))),Promise.reject(r)})}const C5="1.8.4",Qm={};["object","boolean","number","function","string","symbol"].forEach((e,n)=>{Qm[e]=function(r){return typeof r===e||"a"+(n<1?"n ":" ")+e}});const N_={};Qm.transitional=function(n,t,r){function i(s,o){return"[Axios v"+C5+"] Transitional option '"+s+"'"+o+(r?". "+r:"")}return(s,o,u)=>{if(n===!1)throw new ri(i(o," has been removed"+(t?" in "+t:"")),ri.ERR_DEPRECATED);return t&&!N_[o]&&(N_[o]=!0,console.warn(i(o," has been deprecated since v"+t+" and will be removed in the near future"))),n?n(s,o,u):!0}};Qm.spelling=function(n){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${n}`),!0)};function Wk(e,n,t){if(typeof e!="object")throw new ri("options must be an object",ri.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const s=r[i],o=n[s];if(o){const u=e[s],f=u===void 0||o(u,s,e);if(f!==!0)throw new ri("option "+s+" must be "+f,ri.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new ri("Unknown option "+s,ri.ERR_BAD_OPTION)}}const Og={assertOptions:Wk,validators:Qm},ic=Og.validators;let nh=class{constructor(n){this.defaults=n,this.interceptors={request:new L_,response:new L_}}async request(n,t){try{return await this._request(n,t)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?s&&!String(r.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+s):r.stack=s}catch{}}throw r}}_request(n,t){typeof n=="string"?(t=t||{},t.url=n):t=n||{},t=ah(this.defaults,t);const{transitional:r,paramsSerializer:i,headers:s}=t;r!==void 0&&Og.assertOptions(r,{silentJSONParsing:ic.transitional(ic.boolean),forcedJSONParsing:ic.transitional(ic.boolean),clarifyTimeoutError:ic.transitional(ic.boolean)},!1),i!=null&&(Yt.isFunction(i)?t.paramsSerializer={serialize:i}:Og.assertOptions(i,{encode:ic.function,serialize:ic.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Og.assertOptions(t,{baseUrl:ic.spelling("baseURL"),withXsrfToken:ic.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=s&&Yt.merge(s.common,s[t.method]);s&&Yt.forEach(["delete","get","head","post","put","patch","common"],M=>{delete s[M]}),t.headers=El.concat(o,s);const u=[];let f=!0;this.interceptors.request.forEach(function(k){typeof k.runWhen=="function"&&k.runWhen(t)===!1||(f=f&&k.synchronous,u.unshift(k.fulfilled,k.rejected))});const d=[];this.interceptors.response.forEach(function(k){d.push(k.fulfilled,k.rejected)});let m,_=0,w;if(!f){const M=[T_.bind(this),void 0];for(M.unshift.apply(M,u),M.push.apply(M,d),w=M.length,m=Promise.resolve(t);_<w;)m=m.then(M[_++],M[_++]);return m}w=u.length;let y=t;for(_=0;_<w;){const M=u[_++],k=u[_++];try{y=M(y)}catch(F){k.call(this,F);break}}try{m=T_.call(this,y)}catch(M){return Promise.reject(M)}for(_=0,w=d.length;_<w;)m=m.then(d[_++],d[_++]);return m}getUri(n){n=ah(this.defaults,n);const t=w5(n.baseURL,n.url,n.allowAbsoluteUrls);return m5(t,n.params,n.paramsSerializer)}};Yt.forEach(["delete","get","head","options"],function(n){nh.prototype[n]=function(t,r){return this.request(ah(r||{},{method:n,url:t,data:(r||{}).data}))}});Yt.forEach(["post","put","patch"],function(n){function t(r){return function(s,o,u){return this.request(ah(u||{},{method:n,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}nh.prototype[n]=t(),nh.prototype[n+"Form"]=t(!0)});let Zk=class P5{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(s){t=s});const r=this;this.promise.then(i=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](i);r._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(u=>{r.subscribe(u),s=u}).then(i);return o.cancel=function(){r.unsubscribe(s)},o},n(function(s,o,u){r.reason||(r.reason=new gd(s,o,u),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const t=this._listeners.indexOf(n);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const n=new AbortController,t=r=>{n.abort(r)};return this.subscribe(t),n.signal.unsubscribe=()=>this.unsubscribe(t),n.signal}static source(){let n;return{token:new P5(function(i){n=i}),cancel:n}}};function Kk(e){return function(t){return e.apply(null,t)}}function Yk(e){return Yt.isObject(e)&&e.isAxiosError===!0}const e1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(e1).forEach(([e,n])=>{e1[n]=e});function M5(e){const n=new nh(e),t=o5(nh.prototype.request,n);return Yt.extend(t,nh.prototype,n,{allOwnKeys:!0}),Yt.extend(t,n,null,{allOwnKeys:!0}),t.create=function(i){return M5(ah(e,i))},t}const Ps=M5(Op);Ps.Axios=nh;Ps.CanceledError=gd;Ps.CancelToken=Zk;Ps.isCancel=_5;Ps.VERSION=C5;Ps.toFormData=Jm;Ps.AxiosError=ri;Ps.Cancel=Ps.CanceledError;Ps.all=function(n){return Promise.all(n)};Ps.spread=Kk;Ps.isAxiosError=Yk;Ps.mergeConfig=ah;Ps.AxiosHeaders=El;Ps.formToJSON=e=>y5(Yt.isHTMLForm(e)?new FormData(e):e);Ps.getAdapter=E5.getAdapter;Ps.HttpStatusCode=e1;Ps.default=Ps;const{Axios:VV,AxiosError:GV,CanceledError:HV,isCancel:qV,CancelToken:WV,VERSION:ZV,all:KV,Cancel:YV,isAxiosError:JV,spread:XV,toFormData:QV,AxiosHeaders:eG,HttpStatusCode:tG,formToJSON:nG,getAdapter:rG,mergeConfig:iG}=Ps,gn=Yl({measures:[],longTasks:[],memorySnapshots:[],framesPerSecond:0,lastFpsUpdate:0,frameCount:0,isRecording:!1,isEnabled:!1,startTime:0,currentOperation:null,operationStack:[],operationHistory:[]});let xf=null,Xf=null;const Jk=1e3;function e0(){if(gn.isEnabled){gn.isRecording=!0,gn.startTime=performance.now(),gn.frameCount=0,gn.lastFpsUpdate=performance.now();try{window.PerformanceObserver&&PerformanceObserver.supportedEntryTypes.includes("longtask")&&(xf=new PerformanceObserver(e=>{e.getEntries().forEach(t=>{gn.longTasks.push({duration:t.duration,startTime:t.startTime,name:t.name,component:Hu()})})}),xf.observe({entryTypes:["longtask"]}))}catch(e){console.warn("PerformanceObserver pour longues tâches non supporté",e)}Xk(),ly()}}function hm(){gn.isRecording=!1,xf&&(xf.disconnect(),xf=null),N5()}function t1(){xf&&(xf.disconnect(),xf=null),N5(),gn.measures=[],gn.longTasks=[],gn.memorySnapshots=[],gn.operationHistory=[],gn.frameCount=0,gn.framesPerSecond=0,gn.lastFpsUpdate=0,gn.isEnabled&&e0()}function A5(e,n,t){if(!gn.isEnabled||!gn.isRecording)return()=>{};const r=performance.now(),i=gn.currentOperation;return gn.currentOperation=e,gn.operationStack.push(e),()=>{const s=performance.now()-r;gn.operationStack.pop(),gn.currentOperation=gn.operationStack[gn.operationStack.length-1]||null,gn.measures.push({name:e,startTime:r,duration:s,component:n||Hu(),info:t,parentOperation:i||void 0}),s>10&&gn.operationHistory.push({operation:e,component:n||Hu()||"unknown",durationMs:s,timestamp:Date.now()})}}async function k5(e,n,t,r){if(!gn.isEnabled||!gn.isRecording)return n();const i=performance.now(),s=gn.currentOperation;gn.currentOperation=e,gn.operationStack.push(e);try{return await n()}finally{const o=performance.now()-i;gn.operationStack.pop(),gn.currentOperation=gn.operationStack[gn.operationStack.length-1]||null,gn.measures.push({name:e,startTime:i,duration:o,component:t||Hu(),info:r,parentOperation:s||void 0}),o>10&&gn.operationHistory.push({operation:e,component:t||Hu()||"unknown",durationMs:o,timestamp:Date.now()})}}function T5(e,n,t,r){if(!gn.isEnabled||!gn.isRecording)return n();const i=performance.now(),s=gn.currentOperation;gn.currentOperation=e,gn.operationStack.push(e);try{return n()}finally{const o=performance.now()-i;gn.operationStack.pop(),gn.currentOperation=gn.operationStack[gn.operationStack.length-1]||null,gn.measures.push({name:e,startTime:i,duration:o,component:t||Hu(),info:r,parentOperation:s||void 0}),o>10&&gn.operationHistory.push({operation:e,component:t||Hu()||"unknown",durationMs:o,timestamp:Date.now()})}}function ly(){!gn.isEnabled||!gn.isRecording||(performance.memory?gn.memorySnapshots.push({jsHeapSizeLimit:performance.memory.jsHeapSizeLimit,totalJSHeapSize:performance.memory.totalJSHeapSize,usedJSHeapSize:performance.memory.usedJSHeapSize,timestamp:performance.now()}):gn.memorySnapshots.push({timestamp:performance.now()}))}function Xk(){Xf!==null&&cancelAnimationFrame(Xf),gn.frameCount=0,gn.lastFpsUpdate=performance.now();function e(){gn.frameCount++;const n=performance.now();n-gn.lastFpsUpdate>=Jk&&(gn.framesPerSecond=Math.round(gn.frameCount*1e3/(n-gn.lastFpsUpdate)),gn.frameCount=0,gn.lastFpsUpdate=n),gn.isRecording&&(Xf=requestAnimationFrame(e))}Xf=requestAnimationFrame(e)}function N5(){Xf!==null&&(cancelAnimationFrame(Xf),Xf=null)}function Hu(){return""}function n1(e){gn.isEnabled=e,e&&!gn.isRecording?e0():!e&&gn.isRecording&&hm()}function D5(e,n,t){return(...r)=>{if(!gn.isEnabled||!gn.isRecording)return e(...r);const i=performance.now();try{return e(...r)}finally{const s=performance.now()-i;gn.measures.push({name:n,startTime:i,duration:s,component:t||Hu(),info:{args:r}}),s>10&&gn.operationHistory.push({operation:n,component:t||Hu()||"unknown",durationMs:s,timestamp:Date.now()})}}}function I5(e,n,t){return async(...r)=>{if(!gn.isEnabled||!gn.isRecording)return await e(...r);const i=performance.now();try{return await e(...r)}finally{const s=performance.now()-i;gn.measures.push({name:n,startTime:i,duration:s,component:t||Hu(),info:{args:r}}),s>10&&gn.operationHistory.push({operation:n,component:t||Hu()||"unknown",durationMs:s,timestamp:Date.now()})}}}function Qk(e,n){const t=gn.measures.filter(o=>o.startTime>=e&&o.startTime+o.duration<=n),r=new Map,i=[];t.forEach(o=>{o.parentOperation?(r.has(o.parentOperation)||r.set(o.parentOperation,[]),r.get(o.parentOperation).push(o)):i.push(o)});function s(o){const u=r.get(o.name)||[];return{operation:o.name,duration:o.duration,component:o.component,children:u.sort((f,d)=>d.duration-f.duration).map(f=>s(f))}}return i.sort((o,u)=>u.duration-o.duration).map(o=>s(o))}function r1(e,n){const t=e||gn.startTime,r=n||performance.now(),i=Qk(t,r),s=r-t,o=new Map;function u(d){const m=o.get(d.operation)||{duration:0,component:d.component};m.duration+=d.duration,o.set(d.operation,m),d.children.forEach(_=>u(_))}i.forEach(d=>u(d));const f=Array.from(o.entries()).map(([d,{duration:m,component:_}])=>({operation:d,duration:m,component:_,impact:m/s*100})).sort((d,m)=>m.impact-d.impact).slice(0,10);return{criticalPaths:i,totalTime:s,bottlenecks:f}}function md(){const e=zt(!1);Cs(()=>{try{const r=new URL(window.location.href).searchParams.get("perf")==="true";e.value=r,n1(r),t1()}catch(t){console.warn("Erreur lors de la vérification du paramètre perf:",t),e.value=!1,n1(!1)}}),mc(()=>{gn.isRecording&&hm()});const n=(t,r)=>{if(!gn.isEnabled||!gn.isRecording)return null;const i=gn.measures.find(d=>d.name===t&&d.startTime===r);if(!i)return null;const s=i.startTime+i.duration,o=gn.measures.filter(d=>d.startTime>=i.startTime&&d.startTime<=s&&d!==i),u=gn.longTasks.filter(d=>d.startTime>=i.startTime&&d.startTime<=s),f=gn.memorySnapshots.filter(d=>d.timestamp>=i.startTime&&d.timestamp<=s);return{operation:{name:i.name,component:i.component,startTime:i.startTime,duration:i.duration,info:i.info},context:{relatedOperations:o.map(d=>({name:d.name,component:d.component,startTime:d.startTime-i.startTime,duration:d.duration,info:d.info})),longTasks:u.map(d=>({duration:d.duration,startTime:d.startTime-i.startTime,name:d.name,component:d.component})),memorySnapshots:f.map(d=>({...d,timestamp:d.timestamp-i.startTime}))},summary:{totalRelatedOperations:o.length,totalLongTasks:u.length,maxLongTaskDuration:Math.max(...u.map(d=>d.duration),0),memoryDelta:f.length>1?(f[f.length-1].usedJSHeapSize||0)-(f[0].usedJSHeapSize||0):0}}};return{isEnabled:Ru(zt(gn.isEnabled)),isQueryParamEnabled:Ru(e),isRecording:Ru(zt(gn.isRecording)),measures:Ru(zt(gn.measures)),longTasks:Ru(zt(gn.longTasks)),memorySnapshots:Ru(zt(gn.memorySnapshots)),framesPerSecond:Ru(zt(gn.framesPerSecond)),operationHistory:Ru(zt(gn.operationHistory)),startRecording:e0,stopRecording:hm,clearRecording:t1,startMeasure:A5,measure:T5,measureAsync:k5,captureMemorySnapshot:ly,createPerformanceTracker:D5,createAsyncPerformanceTracker:I5,getOperationDetails:n,getSlowOperations:()=>!gn.isEnabled||!gn.isRecording?[]:[...gn.measures].sort((t,r)=>r.duration-t.duration).slice(0,10),getLongTasks:()=>!gn.isEnabled||!gn.isRecording?[]:[...gn.longTasks].sort((t,r)=>r.duration-t.duration),getPerformanceReport:()=>{if(!gn.isEnabled||!gn.isRecording)return null;const t=r1();return{totalMeasures:gn.measures.length,totalLongTasks:gn.longTasks.length,slowestOperations:[...gn.measures].sort((r,i)=>i.duration-r.duration).slice(0,10),averageFps:gn.framesPerSecond,memoryUsage:gn.memorySnapshots.length>0?gn.memorySnapshots[gn.memorySnapshots.length-1]:null,operationsByComponent:eT(gn.measures),criticalPaths:t.criticalPaths,bottlenecks:t.bottlenecks,recordingDuration:gn.isRecording?performance.now()-gn.startTime:null}},analyzeCriticalPaths:r1}}function eT(e){if(!gn.isEnabled||!gn.isRecording)return{};const n={};return e.forEach(t=>{const r=t.component||"unknown";n[r]||(n[r]={totalTime:0,callCount:0,operations:{}}),n[r].totalTime+=t.duration,n[r].callCount++,n[r].operations[t.name]||(n[r].operations[t.name]={totalTime:0,callCount:0}),n[r].operations[t.name].totalTime+=t.duration,n[r].operations[t.name].callCount++}),n}const hn={startRecording:e0,stopRecording:hm,clearRecording:t1,startMeasure:A5,measure:T5,measureAsync:k5,captureMemorySnapshot:ly,createPerformanceTracker:D5,createAsyncPerformanceTracker:I5,setEnabled:n1,analyzeCriticalPaths:r1},Gn=Ps.create({baseURL:"/api",headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0}),Hi=md();function O5(e){var r;const t=`; ${document.cookie}`.split(`; ${e}=`);return t.length===2&&((r=t.pop())==null?void 0:r.split(";").shift())||null}Gn.interceptors.request.use(async e=>{const n=Hi.startMeasure("api_request_interceptor","ApiService");try{const t=O5("access_token");return t&&(e.headers.Authorization=`Bearer ${t}`),console.log("Request config:",{url:e.url,method:e.method,headers:e.headers,withCredentials:e.withCredentials}),e}finally{n()}},e=>(console.error("Request interceptor error:",e),Promise.reject(e)));Gn.interceptors.response.use(e=>e,async e=>{var r,i;const n=Hi.startMeasure("api_response_interceptor","ApiService"),t=e.config;try{if(((r=e.response)==null?void 0:r.status)===401&&!t._retry&&!((i=t.url)!=null&&i.includes("/token/refresh/"))){t._retry=!0;const s=ma();try{await Hi.measureAsync("token_refresh",()=>s.refreshToken(),"ApiService");const o=O5("access_token");if(o)return t.headers.Authorization=`Bearer ${o}`,Gn(t)}catch(o){return await s.logout(),window.location.pathname!=="/login"&&(window.location.href="/login"),Promise.reject(o)}}return Promise.reject(e)}finally{n()}});function tT(e){var t;const n=[];if((t=e.response)!=null&&t.data){const r=e.response.data;typeof r=="object"&&!Array.isArray(r)?Object.entries(r).forEach(([i,s])=>{Array.isArray(s)?s.forEach(o=>{n.push({field:i,message:o})}):typeof s=="string"&&n.push({field:i,message:s})}):typeof r=="string"?n.push({field:"non_field_error",message:r}):r.detail&&n.push({field:"non_field_error",message:r.detail})}else e.message&&n.push({field:"non_field_error",message:`Erreur de connexion: ${e.message}`});return n.length===0&&n.push({field:"non_field_error",message:"Une erreur inconnue s'est produite"}),n}async function Bg(e){console.log("[fetchUsersByHierarchy] Récupération des utilisateurs:",e);const n={role:e.role};e.entrepriseId&&(n.entreprise=e.entrepriseId),e.salarieId&&(n.salarie=e.salarieId),e.includeDetails&&(n.include_plans=!0),e.search&&(n.search=e.search),console.log("[fetchUsersByHierarchy] Filtres appliqués:",n);try{const t=await xl.getUsers(n);return console.log(`[fetchUsersByHierarchy] Résultat (${t.data.length} utilisateurs):`,t.data),t.data}catch(t){throw console.error("[fetchUsersByHierarchy] Erreur lors de la récupération des utilisateurs:",t),t}}const xl={async getUsers(e={}){const n=Hi.startMeasure("get_users","UserService");try{return await Hi.measureAsync("get_users_request",()=>Gn.get("/users/",{params:e}),"UserService")}finally{n()}},async getUser(e){return await Gn.get(`/users/${e}/`)},async createUser(e){return await Gn.post("/users/",e)},async updateUser(e,n){return await Gn.patch(`/users/${e}/`,n)},async deleteUser(e){return await Gn.delete(`/users/${e}/`)},async getEntreprises(){return await Gn.get("/users/",{params:{role:"ENTREPRISE"}})},async getSalaries(e){const n={role:"SALARIE"};return e&&(n.entreprise=e),await Gn.get("/users/",{params:n})},async getSalarieVisiteurs(e){return await Gn.get("/users/",{params:{role:"VISITEUR",salarie:e}})},async getEntrepriseVisiteurs(e){return await Gn.get("/users/",{params:{role:"VISITEUR",entreprise:e}})},async getUsersByHierarchy(e){const n=Hi.startMeasure("get_users_hierarchy","UserService");try{const t=Hi.measure("prepare_hierarchy_filters",()=>{const r={role:e.role};return e.entrepriseId&&(r.entreprise=e.entrepriseId),e.salarieId&&(r.salarie=e.salarieId),e.includeDetails&&(r.include_plans=!0),e.search&&(r.search=e.search),r},"UserService");return await Hi.measureAsync("get_users_hierarchy_request",()=>Gn.get("/users/",{params:t}),"UserService")}finally{n()}},async getEntrepriseSalaries(e){return await Gn.get("/users/",{params:{role:"SALARIE",entreprise:e}})},async getVisiteurs(e,n){const t={role:"VISITEUR"};return e&&(t.salarie=e),n&&(t.entreprise=n),await Gn.get("/users/",{params:t})},async assignEntrepriseToSalarie(e,n){return await Gn.patch(`/users/${e}/`,{entreprise:n})},async assignSalarieToVisiteur(e,n){return await Gn.patch(`/users/${e}/`,{salarie:n})},formatLogoFileName(e){return Hi.measure("format_logo_filename",()=>{var i;const n=new Date().getTime(),t=((i=e.name.split(".").pop())==null?void 0:i.toLowerCase())||"";return`${e.name.split(".")[0].toLowerCase().replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}-${n}.${t}`},"UserService")},async uploadLogo(e){const n=Hi.startMeasure("upload_logo","UserService");try{const t=new FormData,r=this.formatLogoFileName(e),i=new File([e],r,{type:e.type});return t.append("logo",i),await Hi.measureAsync("upload_logo_request",()=>Gn.post("/users/upload_logo/",t,{headers:{"Content-Type":"multipart/form-data"}}),"UserService")}finally{n()}}},mg={async getPlans(){const e=Hi.startMeasure("get_plans","IrrigationService");try{return await Hi.measureAsync("get_plans_request",()=>Gn.get("/plans/"),"IrrigationService")}finally{e()}},async createPlan(e){const n=Hi.startMeasure("create_plan","IrrigationService");try{const t=Hi.measure("format_plan_data",()=>({...e,entreprise:e.entreprise?typeof e.entreprise=="object"&&"id"in e.entreprise?e.entreprise.id:Number(e.entreprise):null,salarie:e.salarie?typeof e.salarie=="object"&&"id"in e.salarie?e.salarie.id:Number(e.salarie):null,visiteur:e.visiteur?typeof e.visiteur=="object"&&"id"in e.visiteur?e.visiteur.id:Number(e.visiteur):null}),"IrrigationService");return await Hi.measureAsync("create_plan_request",()=>Gn.post("/plans/",t),"IrrigationService")}finally{n()}},async updatePlan(e,n){const t=Hi.startMeasure("update_plan","IrrigationService");try{return await Hi.measureAsync("update_plan_request",()=>Gn.put(`/plans/${e}/`,n),"IrrigationService")}finally{t()}},async deletePlan(e){const n=Hi.startMeasure("delete_plan","IrrigationService");try{return await Hi.measureAsync("delete_plan_request",()=>Gn.delete(`/plans/${e}/`),"IrrigationService")}finally{n()}},async getVisiteurPlans(e){return await Gn.get("/plans/",{params:{visiteur:e}})},async createPlanForVisiteur(e){return await Gn.post("/plans/",e)},async getEntreprisePlans(e){return await Gn.get("/plans/",{params:{entreprise:e}})},async getSalariePlans(e){return await Gn.get("/plans/",{params:{salarie:e}})},async createPlanForSalarie(e,n){const t={...e,salarie:n};return await Gn.post("/plans/",t)},async createPlanForEntreprise(e,n){const t={...e,entreprise:n};return await Gn.post("/plans/",t)}},Qs={async getNotes(e={}){const n=Hi.startMeasure("get_notes","NoteService");try{return await Hi.measureAsync("get_notes_request",()=>Gn.get("/notes/",{params:e}),"NoteService")}finally{n()}},async getNotesByPlan(e){const n=Hi.startMeasure("get_notes_by_plan","NoteService");try{return await Hi.measureAsync("get_notes_by_plan_request",()=>Gn.get("/notes/",{params:{plan:e}}),"NoteService")}finally{n()}},async getNote(e){const n=Hi.startMeasure("get_note","NoteService");try{return await Hi.measureAsync("get_note_request",()=>Gn.get(`/notes/${e}/`),"NoteService")}finally{n()}},async createNote(e){const n=Hi.startMeasure("create_note","NoteService");try{const t={...e};return t.location&&Object.keys(t.location).length===0&&delete t.location,await Hi.measureAsync("create_note_request",()=>Gn.post("/notes/",t),"NoteService")}finally{n()}},async updateNote(e,n){console.log("[noteService][updateNote] Mise à jour de la note:",{noteId:e,noteData:n});const t=Hi.startMeasure("update_note","NoteService");try{const r={...n};r.location&&Object.keys(r.location).length===0&&delete r.location,n.column!==void 0?r.column=n.column:n.columnId!==void 0&&(r.column=n.columnId),delete r.columnId,delete r.column_id,delete r.column_details,console.log("[noteService][updateNote] Données formatées:",r);const i=await Hi.measureAsync("update_note_request",()=>Gn.patch(`/notes/${e}/`,r),"NoteService");return console.log("[noteService][updateNote] Réponse du serveur:",i.data),i}catch(r){throw console.error("[noteService][updateNote] Erreur lors de la mise à jour:",r),r}finally{t()}},async deleteNote(e){const n=Hi.startMeasure("delete_note","NoteService");try{return await Hi.measureAsync("delete_note_request",()=>Gn.delete(`/notes/${e}/`),"NoteService")}finally{n()}},async getComments(e){return await Gn.get(`/notes/${e}/comments/`)},async addComment(e,n){const t=typeof n=="string"?{text:n}:n;return console.log(`[noteService][addComment] Envoi du commentaire pour la note ${e}:`,t),await Gn.post(`/notes/${e}/comments/`,t)},async updateComment(e,n,t){return await Gn.patch(`/notes/${e}/comments/${n}/`,t)},async deleteComment(e,n){return await Gn.delete(`/notes/${e}/comments/${n}/`)},async getPhotos(e){return await Gn.get(`/notes/${e}/photos/`)},async addPhoto(e,n){return await Gn.post(`/notes/${e}/photos/`,n,{headers:{"Content-Type":"multipart/form-data"}})},async updatePhoto(e,n,t){return await Gn.patch(`/notes/${e}/photos/${n}/`,t)},async deletePhoto(e,n){return await Gn.delete(`/notes/${e}/photos/${n}/`)}};Gn.defaults.baseURL="/api";Gn.defaults.headers.common["Content-Type"]="application/json";Gn.defaults.withCredentials=!0;function Sp(e){var r;const t=`; ${document.cookie}`.split(`; ${e}=`);return t.length===2&&((r=t.pop())==null?void 0:r.split(";").shift())||null}Gn.interceptors.request.use(e=>{const n=Sp("access_token");return n&&(e.headers.Authorization=`Bearer ${n}`),e},e=>(console.error("Request interceptor error:",e),Promise.reject(e)));Gn.interceptors.response.use(e=>e,async e=>{var r,i;const n=ma(),t=e.config;if(((r=e.response)==null?void 0:r.status)===401&&!t._retry&&!((i=t.url)!=null&&i.includes("/token/refresh/"))){t._retry=!0;try{if(!Sp("access_token"))throw new Error("No token available");await n.refreshToken();const o=Sp("access_token");if(o)return t.headers.Authorization=`Bearer ${o}`,Gn(t)}catch(s){console.error("Token refresh failed:",s),await n.logout(),window.location.pathname!=="/login"&&(window.location.href="/login")}}return Promise.reject(e)});function nT(e,n,t=1){const r=new Date;r.setTime(r.getTime()+t*24*60*60*1e3);const i=`expires=${r.toUTCString()}`;document.cookie=`${e}=${n};${i};path=/;secure;samesite=Strict`}function Gl(e){if(!e)return"-";const n=e.first_name||"",t=e.last_name?e.last_name.toUpperCase():"",r=`${n} ${t}`.trim(),i=e.company_name||e.role||"";return!r&&!i?"-":r?i?`${r} (${i})`:r:`(${i})`}function rT(e="",n=""){return`${(e==null?void 0:e.charAt(0))||""}${(n==null?void 0:n.charAt(0))||""}`.toUpperCase()}const iT={ADMIN:"Administrateur",ENTREPRISE:"Entreprise",SALARIE:"Salarie",VISITEUR:"Visiteur"};function oT(e){return iT[e]||e}function sT(){return"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800"}function aT(e){return e?"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800":"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800"}async function lT({role:e,entrepriseId:n,salarieId:t,includeDetails:r=!1}){const i={role:e};return n&&(i.entreprise=n),t&&(i.salarie=t),r&&(i.include_plans=!0),(await xl.getUsers(i)).data}const ma=Dp("auth",{state:()=>({user:null,isAuthenticated:!1,mustChangePassword:!1,initialized:!1,loading:!1,error:null,enterprises:[],employees:[],visitors:[]}),getters:{isAdmin:e=>{var n;return((n=e.user)==null?void 0:n.user_type)==="admin"},isEntreprise:e=>{var n;return((n=e.user)==null?void 0:n.user_type)==="entreprise"},isSalarie:e=>{var n;return((n=e.user)==null?void 0:n.user_type)==="salarie"},isVisiteur:e=>{var n;return((n=e.user)==null?void 0:n.user_type)==="visiteur"},currentUser:e=>e.user,hasEnterprise:e=>{var n;return!!((n=e.user)!=null&&n.enterprise_id)},hasEmployee:e=>{var n;return!!((n=e.user)!=null&&n.employee_id)}},actions:{async initialize(e){if(!e){const t=await this.restoreSession();return this.initialized=!0,t}if(e.isAuthenticated&&e.user)return this.user=e.user,this.isAuthenticated=!0,this.mustChangePassword=e.user.must_change_password||!1,this.initialized=!0,!0;const n=await this.restoreSession();return this.initialized=!0,n},async restoreSession(){try{if(!Sp("access_token"))return this.isAuthenticated=!1,this.user=null,!1;const n=await Gn.post("/token/refresh/");return n.data.user?(this.user=n.data.user,this.isAuthenticated=!0,this.mustChangePassword=n.data.user.must_change_password||!1,!0):(await this.fetchUserProfile(),!0)}catch(e){return console.error("Failed to restore session:",e),this.isAuthenticated=!1,this.user=null,!1}},async login(e,n){var t,r,i;try{const s=await Gn.post("/token/",{username:e,password:n});if(!s.data.access)throw new Error("Token d'accès non reçu");document.cookie=`access_token=${s.data.access}; path=/; secure; samesite=Strict`;const o=await this.fetchUserProfile();return this.user=o,this.isAuthenticated=!0,!0}catch(s){throw this.isAuthenticated=!1,this.user=null,((t=s.response)==null?void 0:t.status)===401?new Error("Identifiants incorrects"):(i=(r=s.response)==null?void 0:r.data)!=null&&i.detail?new Error(s.response.data.detail):s}},async logout(){this.user=null,this.isAuthenticated=!1,this.mustChangePassword=!1,document.cookie="access_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="refresh_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT"},async checkAuth(){try{return await this.fetchUserProfile(),!0}catch{return this.isAuthenticated=!1,this.user=null,!1}},async fetchUserProfile(){try{const e=await Gn.get("/users/me/");return this.user=e.data,this.isAuthenticated=!0,this.mustChangePassword=e.data.must_change_password||!1,e.data}catch(e){throw this.isAuthenticated=!1,this.user=null,e}},async changePassword(e,n){try{const t=await Gn.post("/users/change_password/",{old_password:e,password:n});return this.user={...this.user,must_change_password:!1},t.data}catch(t){throw console.error("Password change error:",t),t}},async refreshToken(){var e,n;try{if(!Sp("refresh_token"))throw new Error("No refresh token available");const r=await Gn.post("/token/refresh/",{},{withCredentials:!0,_retry:!0}),{access:i}=r.data;if(!i)throw new Error("No access token received");return nT("access_token",i,1),this.isAuthenticated=!0,i}catch(t){throw console.error("Error refreshing token:",{status:(e=t.response)==null?void 0:e.status,data:(n=t.response)==null?void 0:n.data}),this.isAuthenticated=!1,document.cookie="access_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="refresh_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",t}},async fetchUsers(e={}){this.loading=!0;try{return(await xl.getUsers(e)).data}catch(n){throw this.error="Erreur lors de la récupération des utilisateurs",n}finally{this.loading=!1}},async fetchEnterprises(){this.loading=!0;try{const e=await xl.getUsers({role:"ENTREPRISE"});return this.enterprises=e.data,this.enterprises}catch(e){throw this.error="Erreur lors de la récupération des entreprises",e}finally{this.loading=!1}},async fetchEnterpriseEmployees(e){this.loading=!0;try{const n=await xl.getUsers({role:"SALARIE",entreprise:e});return this.employees=n.data,this.employees}catch(n){throw this.error="Erreur lors de la récupération des salaries",n}finally{this.loading=!1}},async fetchEnterpriseVisitors(e){this.loading=!0;try{const n=await xl.getUsers({role:"VISITEUR",entreprise:e});return this.visitors=n.data,this.visitors}catch(n){throw this.error="Erreur lors de la récupération des visiteurs",n}finally{this.loading=!1}},async createUser(e){this.loading=!0;try{return(await xl.createUser(e)).data}catch(n){throw this.error="Erreur lors de la création de l'utilisateur",n}finally{this.loading=!1}},async updateUser(e,n){this.loading=!0;try{return(await xl.updateUser(e,n)).data}catch(t){throw this.error="Erreur lors de la mise à jour de l'utilisateur",t}finally{this.loading=!1}},async deleteUser(e){this.loading=!0;try{return await xl.deleteUser(e),!0}catch(n){throw this.error="Erreur lors de la suppression de l'utilisateur",n}finally{this.loading=!1}},async fetchEnterprisesLegacy(){this.loading=!0;try{const e=await Gn.get("/users/",{params:{role:"entreprise"}});this.enterprises=e.data}catch(e){throw this.error="Erreur lors de la récupération des entreprises",e}finally{this.loading=!1}},async setEnterprise(e,n){this.loading=!0;try{await Gn.patch(`/users/${e}/`,{enterprise:n}),this.user&&this.user.id===e&&(this.user.enterprise_id=n)}catch(t){throw this.error="Erreur lors de la mise à jour de l'entreprise",t}finally{this.loading=!1}},async updateUserRole(e,n){this.loading=!0;try{const t=await Gn.patch(`/users/${e}/`,{role:n});return this.user&&this.user.id===e&&(this.user.user_type=n),t.data}catch(t){throw this.error="Erreur lors de la mise à jour du rôle",t}finally{this.loading=!1}},async updateUserEmail(e){var n;this.loading=!0;try{const t=await Gn.patch(`/users/${(n=this.user)==null?void 0:n.id}/`,{email:e});return this.user&&(this.user.email=e),t.data}catch(t){throw this.error="Erreur lors de la mise à jour de l'email",t}finally{this.loading=!1}},async uploadLogo(e){this.loading=!0;try{const n=await xl.uploadLogo(e);return this.user&&n.data.logo&&(this.user.logo=n.data.logo),n.data}catch(n){throw this.error="Erreur lors du téléversement du logo",n}finally{this.loading=!1}},checkAccess(e){return this.user?e.includes(this.user.user_type):!1},async fetchUsersByRole(e){this.loading=!0;try{return await lT(e)}catch(n){throw console.error(`Error fetching ${e.role}:`,n),n}finally{this.loading=!1}},async fetchEntrepriseSalaries(e){this.loading=!0;try{return(await xl.getUsers({role:"SALARIE",entreprise:e})).data}catch(n){throw this.error="Erreur lors de la récupération des salaries",n}finally{this.loading=!1}},async fetchSalarieVisiteurs(e){this.loading=!0;try{return(await xl.getUsers({role:"VISITEUR",salarie:e})).data}catch(n){throw this.error="Erreur lors de la récupération des visiteurs",n}finally{this.loading=!1}}}});/*!
  * vue-router v4.5.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const jh=typeof document<"u";function B5(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function uT(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&B5(e.default)}const ro=Object.assign;function J0(e,n){const t={};for(const r in n){const i=n[r];t[r]=qu(i)?i.map(e):e(i)}return t}const ip=()=>{},qu=Array.isArray,R5=/#/g,cT=/&/g,fT=/\//g,hT=/=/g,dT=/\?/g,F5=/\+/g,pT=/%5B/g,gT=/%5D/g,j5=/%5E/g,mT=/%60/g,z5=/%7B/g,vT=/%7C/g,$5=/%7D/g,yT=/%20/g;function uy(e){return encodeURI(""+e).replace(vT,"|").replace(pT,"[").replace(gT,"]")}function _T(e){return uy(e).replace(z5,"{").replace($5,"}").replace(j5,"^")}function i1(e){return uy(e).replace(F5,"%2B").replace(yT,"+").replace(R5,"%23").replace(cT,"%26").replace(mT,"`").replace(z5,"{").replace($5,"}").replace(j5,"^")}function bT(e){return i1(e).replace(hT,"%3D")}function wT(e){return uy(e).replace(R5,"%23").replace(dT,"%3F")}function xT(e){return e==null?"":wT(e).replace(fT,"%2F")}function Ep(e){try{return decodeURIComponent(""+e)}catch{}return""+e}const LT=/\/$/,ST=e=>e.replace(LT,"");function X0(e,n,t="/"){let r,i={},s="",o="";const u=n.indexOf("#");let f=n.indexOf("?");return u<f&&u>=0&&(f=-1),f>-1&&(r=n.slice(0,f),s=n.slice(f+1,u>-1?u:n.length),i=e(s)),u>-1&&(r=r||n.slice(0,u),o=n.slice(u,n.length)),r=MT(r??n,t),{fullPath:r+(s&&"?")+s+o,path:r,query:i,hash:Ep(o)}}function ET(e,n){const t=n.query?e(n.query):"";return n.path+(t&&"?")+t+(n.hash||"")}function D_(e,n){return!n||!e.toLowerCase().startsWith(n.toLowerCase())?e:e.slice(n.length)||"/"}function CT(e,n,t){const r=n.matched.length-1,i=t.matched.length-1;return r>-1&&r===i&&ad(n.matched[r],t.matched[i])&&U5(n.params,t.params)&&e(n.query)===e(t.query)&&n.hash===t.hash}function ad(e,n){return(e.aliasOf||e)===(n.aliasOf||n)}function U5(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const t in e)if(!PT(e[t],n[t]))return!1;return!0}function PT(e,n){return qu(e)?I_(e,n):qu(n)?I_(n,e):e===n}function I_(e,n){return qu(n)?e.length===n.length&&e.every((t,r)=>t===n[r]):e.length===1&&e[0]===n}function MT(e,n){if(e.startsWith("/"))return e;if(!e)return n;const t=n.split("/"),r=e.split("/"),i=r[r.length-1];(i===".."||i===".")&&r.push("");let s=t.length-1,o,u;for(o=0;o<r.length;o++)if(u=r[o],u!==".")if(u==="..")s>1&&s--;else break;return t.slice(0,s).join("/")+"/"+r.slice(o).join("/")}const nf={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Cp;(function(e){e.pop="pop",e.push="push"})(Cp||(Cp={}));var op;(function(e){e.back="back",e.forward="forward",e.unknown=""})(op||(op={}));function AT(e){if(!e)if(jh){const n=document.querySelector("base");e=n&&n.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),ST(e)}const kT=/^[^#]+#/;function TT(e,n){return e.replace(kT,"#")+n}function NT(e,n){const t=document.documentElement.getBoundingClientRect(),r=e.getBoundingClientRect();return{behavior:n.behavior,left:r.left-t.left-(n.left||0),top:r.top-t.top-(n.top||0)}}const t0=()=>({left:window.scrollX,top:window.scrollY});function DT(e){let n;if("el"in e){const t=e.el,r=typeof t=="string"&&t.startsWith("#"),i=typeof t=="string"?r?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!i)return;n=NT(i,e)}else n=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(n):window.scrollTo(n.left!=null?n.left:window.scrollX,n.top!=null?n.top:window.scrollY)}function O_(e,n){return(history.state?history.state.position-n:-1)+e}const o1=new Map;function IT(e,n){o1.set(e,n)}function OT(e){const n=o1.get(e);return o1.delete(e),n}let BT=()=>location.protocol+"//"+location.host;function V5(e,n){const{pathname:t,search:r,hash:i}=n,s=e.indexOf("#");if(s>-1){let u=i.includes(e.slice(s))?e.slice(s).length:1,f=i.slice(u);return f[0]!=="/"&&(f="/"+f),D_(f,"")}return D_(t,e)+r+i}function RT(e,n,t,r){let i=[],s=[],o=null;const u=({state:w})=>{const y=V5(e,location),M=t.value,k=n.value;let F=0;if(w){if(t.value=y,n.value=w,o&&o===M){o=null;return}F=k?w.position-k.position:0}else r(y);i.forEach(I=>{I(t.value,M,{delta:F,type:Cp.pop,direction:F?F>0?op.forward:op.back:op.unknown})})};function f(){o=t.value}function d(w){i.push(w);const y=()=>{const M=i.indexOf(w);M>-1&&i.splice(M,1)};return s.push(y),y}function m(){const{history:w}=window;w.state&&w.replaceState(ro({},w.state,{scroll:t0()}),"")}function _(){for(const w of s)w();s=[],window.removeEventListener("popstate",u),window.removeEventListener("beforeunload",m)}return window.addEventListener("popstate",u),window.addEventListener("beforeunload",m,{passive:!0}),{pauseListeners:f,listen:d,destroy:_}}function B_(e,n,t,r=!1,i=!1){return{back:e,current:n,forward:t,replaced:r,position:window.history.length,scroll:i?t0():null}}function FT(e){const{history:n,location:t}=window,r={value:V5(e,t)},i={value:n.state};i.value||s(r.value,{back:null,current:r.value,forward:null,position:n.length-1,replaced:!0,scroll:null},!0);function s(f,d,m){const _=e.indexOf("#"),w=_>-1?(t.host&&document.querySelector("base")?e:e.slice(_))+f:BT()+e+f;try{n[m?"replaceState":"pushState"](d,"",w),i.value=d}catch(y){console.error(y),t[m?"replace":"assign"](w)}}function o(f,d){const m=ro({},n.state,B_(i.value.back,f,i.value.forward,!0),d,{position:i.value.position});s(f,m,!0),r.value=f}function u(f,d){const m=ro({},i.value,n.state,{forward:f,scroll:t0()});s(m.current,m,!0);const _=ro({},B_(r.value,f,null),{position:m.position+1},d);s(f,_,!1),r.value=f}return{location:r,state:i,push:u,replace:o}}function jT(e){e=AT(e);const n=FT(e),t=RT(e,n.state,n.location,n.replace);function r(s,o=!0){o||t.pauseListeners(),history.go(s)}const i=ro({location:"",base:e,go:r,createHref:TT.bind(null,e)},n,t);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>n.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>n.state.value}),i}function zT(e){return typeof e=="string"||e&&typeof e=="object"}function G5(e){return typeof e=="string"||typeof e=="symbol"}const H5=Symbol("");var R_;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(R_||(R_={}));function ld(e,n){return ro(new Error,{type:e,[H5]:!0},n)}function Dc(e,n){return e instanceof Error&&H5 in e&&(n==null||!!(e.type&n))}const F_="[^/]+?",$T={sensitive:!1,strict:!1,start:!0,end:!0},UT=/[.+*?^${}()[\]/\\]/g;function VT(e,n){const t=ro({},$T,n),r=[];let i=t.start?"^":"";const s=[];for(const d of e){const m=d.length?[]:[90];t.strict&&!d.length&&(i+="/");for(let _=0;_<d.length;_++){const w=d[_];let y=40+(t.sensitive?.25:0);if(w.type===0)_||(i+="/"),i+=w.value.replace(UT,"\\$&"),y+=40;else if(w.type===1){const{value:M,repeatable:k,optional:F,regexp:I}=w;s.push({name:M,repeatable:k,optional:F});const R=I||F_;if(R!==F_){y+=10;try{new RegExp(`(${R})`)}catch(ee){throw new Error(`Invalid custom RegExp for param "${M}" (${R}): `+ee.message)}}let K=k?`((?:${R})(?:/(?:${R}))*)`:`(${R})`;_||(K=F&&d.length<2?`(?:/${K})`:"/"+K),F&&(K+="?"),i+=K,y+=20,F&&(y+=-8),k&&(y+=-20),R===".*"&&(y+=-50)}m.push(y)}r.push(m)}if(t.strict&&t.end){const d=r.length-1;r[d][r[d].length-1]+=.7000000000000001}t.strict||(i+="/?"),t.end?i+="$":t.strict&&!i.endsWith("/")&&(i+="(?:/|$)");const o=new RegExp(i,t.sensitive?"":"i");function u(d){const m=d.match(o),_={};if(!m)return null;for(let w=1;w<m.length;w++){const y=m[w]||"",M=s[w-1];_[M.name]=y&&M.repeatable?y.split("/"):y}return _}function f(d){let m="",_=!1;for(const w of e){(!_||!m.endsWith("/"))&&(m+="/"),_=!1;for(const y of w)if(y.type===0)m+=y.value;else if(y.type===1){const{value:M,repeatable:k,optional:F}=y,I=M in d?d[M]:"";if(qu(I)&&!k)throw new Error(`Provided param "${M}" is an array but it is not repeatable (* or + modifiers)`);const R=qu(I)?I.join("/"):I;if(!R)if(F)w.length<2&&(m.endsWith("/")?m=m.slice(0,-1):_=!0);else throw new Error(`Missing required param "${M}"`);m+=R}}return m||"/"}return{re:o,score:r,keys:s,parse:u,stringify:f}}function GT(e,n){let t=0;for(;t<e.length&&t<n.length;){const r=n[t]-e[t];if(r)return r;t++}return e.length<n.length?e.length===1&&e[0]===80?-1:1:e.length>n.length?n.length===1&&n[0]===80?1:-1:0}function q5(e,n){let t=0;const r=e.score,i=n.score;for(;t<r.length&&t<i.length;){const s=GT(r[t],i[t]);if(s)return s;t++}if(Math.abs(i.length-r.length)===1){if(j_(r))return 1;if(j_(i))return-1}return i.length-r.length}function j_(e){const n=e[e.length-1];return e.length>0&&n[n.length-1]<0}const HT={type:0,value:""},qT=/[a-zA-Z0-9_]/;function WT(e){if(!e)return[[]];if(e==="/")return[[HT]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function n(y){throw new Error(`ERR (${t})/"${d}": ${y}`)}let t=0,r=t;const i=[];let s;function o(){s&&i.push(s),s=[]}let u=0,f,d="",m="";function _(){d&&(t===0?s.push({type:0,value:d}):t===1||t===2||t===3?(s.length>1&&(f==="*"||f==="+")&&n(`A repeatable param (${d}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:d,regexp:m,repeatable:f==="*"||f==="+",optional:f==="*"||f==="?"})):n("Invalid state to consume buffer"),d="")}function w(){d+=f}for(;u<e.length;){if(f=e[u++],f==="\\"&&t!==2){r=t,t=4;continue}switch(t){case 0:f==="/"?(d&&_(),o()):f===":"?(_(),t=1):w();break;case 4:w(),t=r;break;case 1:f==="("?t=2:qT.test(f)?w():(_(),t=0,f!=="*"&&f!=="?"&&f!=="+"&&u--);break;case 2:f===")"?m[m.length-1]=="\\"?m=m.slice(0,-1)+f:t=3:m+=f;break;case 3:_(),t=0,f!=="*"&&f!=="?"&&f!=="+"&&u--,m="";break;default:n("Unknown state");break}}return t===2&&n(`Unfinished custom RegExp for param "${d}"`),_(),o(),i}function ZT(e,n,t){const r=VT(WT(e.path),t),i=ro(r,{record:e,parent:n,children:[],alias:[]});return n&&!i.record.aliasOf==!n.record.aliasOf&&n.children.push(i),i}function KT(e,n){const t=[],r=new Map;n=V_({strict:!1,end:!0,sensitive:!1},n);function i(_){return r.get(_)}function s(_,w,y){const M=!y,k=$_(_);k.aliasOf=y&&y.record;const F=V_(n,_),I=[k];if("alias"in _){const ee=typeof _.alias=="string"?[_.alias]:_.alias;for(const he of ee)I.push($_(ro({},k,{components:y?y.record.components:k.components,path:he,aliasOf:y?y.record:k})))}let R,K;for(const ee of I){const{path:he}=ee;if(w&&he[0]!=="/"){const fe=w.record.path,ve=fe[fe.length-1]==="/"?"":"/";ee.path=w.record.path+(he&&ve+he)}if(R=ZT(ee,w,F),y?y.alias.push(R):(K=K||R,K!==R&&K.alias.push(R),M&&_.name&&!U_(R)&&o(_.name)),W5(R)&&f(R),k.children){const fe=k.children;for(let ve=0;ve<fe.length;ve++)s(fe[ve],R,y&&y.children[ve])}y=y||R}return K?()=>{o(K)}:ip}function o(_){if(G5(_)){const w=r.get(_);w&&(r.delete(_),t.splice(t.indexOf(w),1),w.children.forEach(o),w.alias.forEach(o))}else{const w=t.indexOf(_);w>-1&&(t.splice(w,1),_.record.name&&r.delete(_.record.name),_.children.forEach(o),_.alias.forEach(o))}}function u(){return t}function f(_){const w=XT(_,t);t.splice(w,0,_),_.record.name&&!U_(_)&&r.set(_.record.name,_)}function d(_,w){let y,M={},k,F;if("name"in _&&_.name){if(y=r.get(_.name),!y)throw ld(1,{location:_});F=y.record.name,M=ro(z_(w.params,y.keys.filter(K=>!K.optional).concat(y.parent?y.parent.keys.filter(K=>K.optional):[]).map(K=>K.name)),_.params&&z_(_.params,y.keys.map(K=>K.name))),k=y.stringify(M)}else if(_.path!=null)k=_.path,y=t.find(K=>K.re.test(k)),y&&(M=y.parse(k),F=y.record.name);else{if(y=w.name?r.get(w.name):t.find(K=>K.re.test(w.path)),!y)throw ld(1,{location:_,currentLocation:w});F=y.record.name,M=ro({},w.params,_.params),k=y.stringify(M)}const I=[];let R=y;for(;R;)I.unshift(R.record),R=R.parent;return{name:F,path:k,params:M,matched:I,meta:JT(I)}}e.forEach(_=>s(_));function m(){t.length=0,r.clear()}return{addRoute:s,resolve:d,removeRoute:o,clearRoutes:m,getRoutes:u,getRecordMatcher:i}}function z_(e,n){const t={};for(const r of n)r in e&&(t[r]=e[r]);return t}function $_(e){const n={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:YT(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(n,"mods",{value:{}}),n}function YT(e){const n={},t=e.props||!1;if("component"in e)n.default=t;else for(const r in e.components)n[r]=typeof t=="object"?t[r]:t;return n}function U_(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function JT(e){return e.reduce((n,t)=>ro(n,t.meta),{})}function V_(e,n){const t={};for(const r in e)t[r]=r in n?n[r]:e[r];return t}function XT(e,n){let t=0,r=n.length;for(;t!==r;){const s=t+r>>1;q5(e,n[s])<0?r=s:t=s+1}const i=QT(e);return i&&(r=n.lastIndexOf(i,r-1)),r}function QT(e){let n=e;for(;n=n.parent;)if(W5(n)&&q5(e,n)===0)return n}function W5({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function e8(e){const n={};if(e===""||e==="?")return n;const r=(e[0]==="?"?e.slice(1):e).split("&");for(let i=0;i<r.length;++i){const s=r[i].replace(F5," "),o=s.indexOf("="),u=Ep(o<0?s:s.slice(0,o)),f=o<0?null:Ep(s.slice(o+1));if(u in n){let d=n[u];qu(d)||(d=n[u]=[d]),d.push(f)}else n[u]=f}return n}function G_(e){let n="";for(let t in e){const r=e[t];if(t=bT(t),r==null){r!==void 0&&(n+=(n.length?"&":"")+t);continue}(qu(r)?r.map(s=>s&&i1(s)):[r&&i1(r)]).forEach(s=>{s!==void 0&&(n+=(n.length?"&":"")+t,s!=null&&(n+="="+s))})}return n}function t8(e){const n={};for(const t in e){const r=e[t];r!==void 0&&(n[t]=qu(r)?r.map(i=>i==null?null:""+i):r==null?r:""+r)}return n}const n8=Symbol(""),H_=Symbol(""),n0=Symbol(""),cy=Symbol(""),s1=Symbol("");function kd(){let e=[];function n(r){return e.push(r),()=>{const i=e.indexOf(r);i>-1&&e.splice(i,1)}}function t(){e=[]}return{add:n,list:()=>e.slice(),reset:t}}function df(e,n,t,r,i,s=o=>o()){const o=r&&(r.enterCallbacks[i]=r.enterCallbacks[i]||[]);return()=>new Promise((u,f)=>{const d=w=>{w===!1?f(ld(4,{from:t,to:n})):w instanceof Error?f(w):zT(w)?f(ld(2,{from:n,to:w})):(o&&r.enterCallbacks[i]===o&&typeof w=="function"&&o.push(w),u())},m=s(()=>e.call(r&&r.instances[i],n,t,d));let _=Promise.resolve(m);e.length<3&&(_=_.then(d)),_.catch(w=>f(w))})}function Q0(e,n,t,r,i=s=>s()){const s=[];for(const o of e)for(const u in o.components){let f=o.components[u];if(!(n!=="beforeRouteEnter"&&!o.instances[u]))if(B5(f)){const m=(f.__vccOpts||f)[n];m&&s.push(df(m,t,r,o,u,i))}else{let d=f();s.push(()=>d.then(m=>{if(!m)throw new Error(`Couldn't resolve component "${u}" at "${o.path}"`);const _=uT(m)?m.default:m;o.mods[u]=m,o.components[u]=_;const y=(_.__vccOpts||_)[n];return y&&df(y,t,r,o,u,i)()}))}}return s}function q_(e){const n=Zl(n0),t=Zl(cy),r=sr(()=>{const f=Kn(e.to);return n.resolve(f)}),i=sr(()=>{const{matched:f}=r.value,{length:d}=f,m=f[d-1],_=t.matched;if(!m||!_.length)return-1;const w=_.findIndex(ad.bind(null,m));if(w>-1)return w;const y=W_(f[d-2]);return d>1&&W_(m)===y&&_[_.length-1].path!==y?_.findIndex(ad.bind(null,f[d-2])):w}),s=sr(()=>i.value>-1&&s8(t.params,r.value.params)),o=sr(()=>i.value>-1&&i.value===t.matched.length-1&&U5(t.params,r.value.params));function u(f={}){if(o8(f)){const d=n[Kn(e.replace)?"replace":"push"](Kn(e.to)).catch(ip);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>d),d}return Promise.resolve()}return{route:r,href:sr(()=>r.value.href),isActive:s,isExactActive:o,navigate:u}}function r8(e){return e.length===1?e[0]:e}const i8=ds({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:q_,setup(e,{slots:n}){const t=Yl(q_(e)),{options:r}=Zl(n0),i=sr(()=>({[Z_(e.activeClass,r.linkActiveClass,"router-link-active")]:t.isActive,[Z_(e.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const s=n.default&&r8(n.default(t));return e.custom?s:Gm("a",{"aria-current":t.isExactActive?e.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:i.value},s)}}}),$d=i8;function o8(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const n=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(n))return}return e.preventDefault&&e.preventDefault(),!0}}function s8(e,n){for(const t in n){const r=n[t],i=e[t];if(typeof r=="string"){if(r!==i)return!1}else if(!qu(i)||i.length!==r.length||r.some((s,o)=>s!==i[o]))return!1}return!0}function W_(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Z_=(e,n,t)=>e??n??t,a8=ds({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:n,slots:t}){const r=Zl(s1),i=sr(()=>e.route||r.value),s=Zl(H_,0),o=sr(()=>{let d=Kn(s);const{matched:m}=i.value;let _;for(;(_=m[d])&&!_.components;)d++;return d}),u=sr(()=>i.value.matched[o.value]);ep(H_,sr(()=>o.value+1)),ep(n8,u),ep(s1,i);const f=zt();return oo(()=>[f.value,u.value,e.name],([d,m,_],[w,y,M])=>{m&&(m.instances[_]=d,y&&y!==m&&d&&d===w&&(m.leaveGuards.size||(m.leaveGuards=y.leaveGuards),m.updateGuards.size||(m.updateGuards=y.updateGuards))),d&&m&&(!y||!ad(m,y)||!w)&&(m.enterCallbacks[_]||[]).forEach(k=>k(d))},{flush:"post"}),()=>{const d=i.value,m=e.name,_=u.value,w=_&&_.components[m];if(!w)return K_(t.default,{Component:w,route:d});const y=_.props[m],M=y?y===!0?d.params:typeof y=="function"?y(d):y:null,F=Gm(w,ro({},M,n,{onVnodeUnmounted:I=>{I.component.isUnmounted&&(_.instances[m]=null)},ref:f}));return K_(t.default,{Component:F,route:d})||F}}});function K_(e,n){if(!e)return null;const t=e(n);return t.length===1?t[0]:t}const Z5=a8;function l8(e){const n=KT(e.routes,e),t=e.parseQuery||e8,r=e.stringifyQuery||G_,i=e.history,s=kd(),o=kd(),u=kd(),f=V1(nf);let d=nf;jh&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const m=J0.bind(null,pe=>""+pe),_=J0.bind(null,xT),w=J0.bind(null,Ep);function y(pe,Z){let N,ke;return G5(pe)?(N=n.getRecordMatcher(pe),ke=Z):ke=pe,n.addRoute(ke,N)}function M(pe){const Z=n.getRecordMatcher(pe);Z&&n.removeRoute(Z)}function k(){return n.getRoutes().map(pe=>pe.record)}function F(pe){return!!n.getRecordMatcher(pe)}function I(pe,Z){if(Z=ro({},Z||f.value),typeof pe=="string"){const ne=X0(t,pe,Z.path),ye=n.resolve({path:ne.path},Z),de=i.createHref(ne.fullPath);return ro(ne,ye,{params:w(ye.params),hash:Ep(ne.hash),redirectedFrom:void 0,href:de})}let N;if(pe.path!=null)N=ro({},pe,{path:X0(t,pe.path,Z.path).path});else{const ne=ro({},pe.params);for(const ye in ne)ne[ye]==null&&delete ne[ye];N=ro({},pe,{params:_(ne)}),Z.params=_(Z.params)}const ke=n.resolve(N,Z),Me=pe.hash||"";ke.params=m(w(ke.params));const Ue=ET(r,ro({},pe,{hash:_T(Me),path:ke.path})),ce=i.createHref(Ue);return ro({fullPath:Ue,hash:Me,query:r===G_?t8(pe.query):pe.query||{}},ke,{redirectedFrom:void 0,href:ce})}function R(pe){return typeof pe=="string"?X0(t,pe,f.value.path):ro({},pe)}function K(pe,Z){if(d!==pe)return ld(8,{from:Z,to:pe})}function ee(pe){return ve(pe)}function he(pe){return ee(ro(R(pe),{replace:!0}))}function fe(pe){const Z=pe.matched[pe.matched.length-1];if(Z&&Z.redirect){const{redirect:N}=Z;let ke=typeof N=="function"?N(pe):N;return typeof ke=="string"&&(ke=ke.includes("?")||ke.includes("#")?ke=R(ke):{path:ke},ke.params={}),ro({query:pe.query,hash:pe.hash,params:ke.path!=null?{}:pe.params},ke)}}function ve(pe,Z){const N=d=I(pe),ke=f.value,Me=pe.state,Ue=pe.force,ce=pe.replace===!0,ne=fe(N);if(ne)return ve(ro(R(ne),{state:typeof ne=="object"?ro({},Me,ne.state):Me,force:Ue,replace:ce}),Z||N);const ye=N;ye.redirectedFrom=Z;let de;return!Ue&&CT(r,ke,N)&&(de=ld(16,{to:ye,from:ke}),Te(ke,ke,!0,!1)),(de?Promise.resolve(de):J(ye,ke)).catch(We=>Dc(We)?Dc(We,2)?We:Ce(We):ie(We,ye,ke)).then(We=>{if(We){if(Dc(We,2))return ve(ro({replace:ce},R(We.to),{state:typeof We.to=="object"?ro({},Me,We.to.state):Me,force:Ue}),Z||ye)}else We=D(ye,ke,!0,ce,Me);return T(ye,ke,We),We})}function z(pe,Z){const N=K(pe,Z);return N?Promise.reject(N):Promise.resolve()}function U(pe){const Z=Q.values().next().value;return Z&&typeof Z.runWithContext=="function"?Z.runWithContext(pe):pe()}function J(pe,Z){let N;const[ke,Me,Ue]=u8(pe,Z);N=Q0(ke.reverse(),"beforeRouteLeave",pe,Z);for(const ne of ke)ne.leaveGuards.forEach(ye=>{N.push(df(ye,pe,Z))});const ce=z.bind(null,pe,Z);return N.push(ce),le(N).then(()=>{N=[];for(const ne of s.list())N.push(df(ne,pe,Z));return N.push(ce),le(N)}).then(()=>{N=Q0(Me,"beforeRouteUpdate",pe,Z);for(const ne of Me)ne.updateGuards.forEach(ye=>{N.push(df(ye,pe,Z))});return N.push(ce),le(N)}).then(()=>{N=[];for(const ne of Ue)if(ne.beforeEnter)if(qu(ne.beforeEnter))for(const ye of ne.beforeEnter)N.push(df(ye,pe,Z));else N.push(df(ne.beforeEnter,pe,Z));return N.push(ce),le(N)}).then(()=>(pe.matched.forEach(ne=>ne.enterCallbacks={}),N=Q0(Ue,"beforeRouteEnter",pe,Z,U),N.push(ce),le(N))).then(()=>{N=[];for(const ne of o.list())N.push(df(ne,pe,Z));return N.push(ce),le(N)}).catch(ne=>Dc(ne,8)?ne:Promise.reject(ne))}function T(pe,Z,N){u.list().forEach(ke=>U(()=>ke(pe,Z,N)))}function D(pe,Z,N,ke,Me){const Ue=K(pe,Z);if(Ue)return Ue;const ce=Z===nf,ne=jh?history.state:{};N&&(ke||ce?i.replace(pe.fullPath,ro({scroll:ce&&ne&&ne.scroll},Me)):i.push(pe.fullPath,Me)),f.value=pe,Te(pe,Z,N,ce),Ce()}let B;function $(){B||(B=i.listen((pe,Z,N)=>{if(!ue.listening)return;const ke=I(pe),Me=fe(ke);if(Me){ve(ro(Me,{replace:!0,force:!0}),ke).catch(ip);return}d=ke;const Ue=f.value;jh&&IT(O_(Ue.fullPath,N.delta),t0()),J(ke,Ue).catch(ce=>Dc(ce,12)?ce:Dc(ce,2)?(ve(ro(R(ce.to),{force:!0}),ke).then(ne=>{Dc(ne,20)&&!N.delta&&N.type===Cp.pop&&i.go(-1,!1)}).catch(ip),Promise.reject()):(N.delta&&i.go(-N.delta,!1),ie(ce,ke,Ue))).then(ce=>{ce=ce||D(ke,Ue,!1),ce&&(N.delta&&!Dc(ce,8)?i.go(-N.delta,!1):N.type===Cp.pop&&Dc(ce,20)&&i.go(-1,!1)),T(ke,Ue,ce)}).catch(ip)}))}let W=kd(),G=kd(),oe;function ie(pe,Z,N){Ce(pe);const ke=G.list();return ke.length?ke.forEach(Me=>Me(pe,Z,N)):console.error(pe),Promise.reject(pe)}function we(){return oe&&f.value!==nf?Promise.resolve():new Promise((pe,Z)=>{W.add([pe,Z])})}function Ce(pe){return oe||(oe=!pe,$(),W.list().forEach(([Z,N])=>pe?N(pe):Z()),W.reset()),pe}function Te(pe,Z,N,ke){const{scrollBehavior:Me}=e;if(!jh||!Me)return Promise.resolve();const Ue=!N&&OT(O_(pe.fullPath,0))||(ke||!N)&&history.state&&history.state.scroll||null;return Us().then(()=>Me(pe,Z,Ue)).then(ce=>ce&&DT(ce)).catch(ce=>ie(ce,pe,Z))}const Y=pe=>i.go(pe);let H;const Q=new Set,ue={currentRoute:f,listening:!0,addRoute:y,removeRoute:M,clearRoutes:n.clearRoutes,hasRoute:F,getRoutes:k,resolve:I,options:e,push:ee,replace:he,go:Y,back:()=>Y(-1),forward:()=>Y(1),beforeEach:s.add,beforeResolve:o.add,afterEach:u.add,onError:G.add,isReady:we,install(pe){const Z=this;pe.component("RouterLink",$d),pe.component("RouterView",Z5),pe.config.globalProperties.$router=Z,Object.defineProperty(pe.config.globalProperties,"$route",{enumerable:!0,get:()=>Kn(f)}),jh&&!H&&f.value===nf&&(H=!0,ee(i.location).catch(Me=>{}));const N={};for(const Me in nf)Object.defineProperty(N,Me,{get:()=>f.value[Me],enumerable:!0});pe.provide(n0,Z),pe.provide(cy,U1(N)),pe.provide(s1,f);const ke=pe.unmount;Q.add(pe),pe.unmount=function(){Q.delete(pe),Q.size<1&&(d=nf,B&&B(),B=null,f.value=nf,H=!1,oe=!1),ke()}}};function le(pe){return pe.reduce((Z,N)=>Z.then(()=>U(N)),Promise.resolve())}return ue}function u8(e,n){const t=[],r=[],i=[],s=Math.max(n.matched.length,e.matched.length);for(let o=0;o<s;o++){const u=n.matched[o];u&&(e.matched.find(d=>ad(d,u))?r.push(u):t.push(u));const f=e.matched[o];f&&(n.matched.find(d=>ad(d,f))||i.push(f))}return[t,r,i]}function Bp(){return Zl(n0)}function c8(e){return Zl(cy)}const vu=Dp("notification",()=>{const e=zt([]),n=zt(0),t=zt(null),r=sr(()=>[...e.value].sort((_,w)=>w.timestamp-_.timestamp));function i({type:_,message:w,duration:y=5e3}){const M=++n.value,k=Date.now(),F={id:M,type:_,message:w,duration:y,timestamp:k};return e.value.push(F),t.value=M,y>0&&setTimeout(()=>{d(M)},y),M}const s=(_,w=5e3)=>i({type:"success",message:_,duration:w}),o=(_,w=5e3)=>i({type:"error",message:_,duration:w}),u=(_,w=5e3)=>i({type:"info",message:_,duration:w}),f=(_,w=5e3)=>i({type:"warning",message:_,duration:w});function d(_){const w=e.value.findIndex(y=>y.id===_);w!==-1&&e.value.splice(w,1),t.value===_&&(t.value=null)}function m(){e.value=[],t.value=null}return{notifications:r,lastAddedId:t,addNotification:i,removeNotification:d,clearAll:m,success:s,error:o,info:u,warning:f}}),f8=Object.freeze(Object.defineProperty({__proto__:null,useNotificationStore:vu},Symbol.toStringTag,{value:"Module"}));var ea=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function fy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function K5(e){if(e.__esModule)return e;var n=e.default;if(typeof n=="function"){var t=function r(){return this instanceof r?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};t.prototype=n.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}),t}function h8(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}var Y5=h8,d8=typeof ea=="object"&&ea&&ea.Object===Object&&ea,p8=d8,g8=p8,m8=typeof self=="object"&&self&&self.Object===Object&&self,v8=g8||m8||Function("return this")(),J5=v8,y8=J5,_8=function(){return y8.Date.now()},b8=_8,w8=/\s/;function x8(e){for(var n=e.length;n--&&w8.test(e.charAt(n)););return n}var L8=x8,S8=L8,E8=/^\s+/;function C8(e){return e&&e.slice(0,S8(e)+1).replace(E8,"")}var P8=C8,M8=J5,A8=M8.Symbol,X5=A8,Y_=X5,Q5=Object.prototype,k8=Q5.hasOwnProperty,T8=Q5.toString,Td=Y_?Y_.toStringTag:void 0;function N8(e){var n=k8.call(e,Td),t=e[Td];try{e[Td]=void 0;var r=!0}catch{}var i=T8.call(e);return r&&(n?e[Td]=t:delete e[Td]),i}var D8=N8,I8=Object.prototype,O8=I8.toString;function B8(e){return O8.call(e)}var R8=B8,J_=X5,F8=D8,j8=R8,z8="[object Null]",$8="[object Undefined]",X_=J_?J_.toStringTag:void 0;function U8(e){return e==null?e===void 0?$8:z8:X_&&X_ in Object(e)?F8(e):j8(e)}var V8=U8;function G8(e){return e!=null&&typeof e=="object"}var H8=G8,q8=V8,W8=H8,Z8="[object Symbol]";function K8(e){return typeof e=="symbol"||W8(e)&&q8(e)==Z8}var Y8=K8,J8=P8,Q_=Y5,X8=Y8,eb=NaN,Q8=/^[-+]0x[0-9a-f]+$/i,eN=/^0b[01]+$/i,tN=/^0o[0-7]+$/i,nN=parseInt;function rN(e){if(typeof e=="number")return e;if(X8(e))return eb;if(Q_(e)){var n=typeof e.valueOf=="function"?e.valueOf():e;e=Q_(n)?n+"":n}if(typeof e!="string")return e===0?e:+e;e=J8(e);var t=eN.test(e);return t||tN.test(e)?nN(e.slice(2),t?2:8):Q8.test(e)?eb:+e}var iN=rN,oN=Y5,ev=b8,tb=iN,sN="Expected a function",aN=Math.max,lN=Math.min;function uN(e,n,t){var r,i,s,o,u,f,d=0,m=!1,_=!1,w=!0;if(typeof e!="function")throw new TypeError(sN);n=tb(n)||0,oN(t)&&(m=!!t.leading,_="maxWait"in t,s=_?aN(tb(t.maxWait)||0,n):s,w="trailing"in t?!!t.trailing:w);function y(fe){var ve=r,z=i;return r=i=void 0,d=fe,o=e.apply(z,ve),o}function M(fe){return d=fe,u=setTimeout(I,n),m?y(fe):o}function k(fe){var ve=fe-f,z=fe-d,U=n-ve;return _?lN(U,s-z):U}function F(fe){var ve=fe-f,z=fe-d;return f===void 0||ve>=n||ve<0||_&&z>=s}function I(){var fe=ev();if(F(fe))return R(fe);u=setTimeout(I,k(fe))}function R(fe){return u=void 0,w&&r?y(fe):(r=i=void 0,o)}function K(){u!==void 0&&clearTimeout(u),d=0,r=f=i=u=void 0}function ee(){return u===void 0?o:R(ev())}function he(){var fe=ev(),ve=F(fe);if(r=arguments,i=this,f=fe,ve){if(u===void 0)return M(f);if(_)return clearTimeout(u),u=setTimeout(I,n),y(f)}return u===void 0&&(u=setTimeout(I,n)),o}return he.cancel=K,he.flush=ee,he}var cN=uN;const fN=fy(cN),hN={class:"relative w-full"},dN={key:0,class:"search-results w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto"},pN=["onClick"],nb=ds({__name:"SearchBar",emits:["select-location"],setup(e,{emit:n}){const t=zt(""),r=zt([]),i=n,s=fN(async f=>{if(f.length<3){r.value=[];return}try{const m=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(f)}`)).json();r.value=m}catch(d){console.error("Erreur lors de la recherche d'adresse:",d),r.value=[]}},300);function o(){s(t.value)}function u(f){t.value=f.display_name,r.value=[],i("select-location",{lat:parseFloat(f.lat),lng:parseFloat(f.lon)})}return(f,d)=>($e(),qe("div",hN,[Fn(C("input",{"onUpdate:modelValue":d[0]||(d[0]=m=>t.value=m),onInput:o,type:"text",placeholder:"Rechercher une adresse...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"},null,544),[[ni,t.value]]),r.value.length>0?($e(),qe("div",dN,[($e(!0),qe(Tn,null,Lr(r.value,m=>($e(),qe("div",{key:m.place_id,onClick:_=>u(m),class:"px-4 py-2 hover:bg-gray-100 cursor-pointer"},Zt(m.display_name),9,pN))),128))])):pn("",!0)]))}}),gN={class:"perf-title"},mN={class:"perf-basic-stats"},vN={class:"perf-stat"},yN={class:"perf-stat"},_N={class:"perf-expand-btn"},bN={key:0,class:"perf-content"},wN={class:"perf-section"},xN={class:"perf-metrics"},LN={class:"perf-metric"},SN={class:"perf-metric-value"},EN={class:"perf-metric"},CN={class:"perf-metric-value"},PN={class:"perf-metric"},MN={class:"perf-metric-value"},AN={class:"perf-metric"},kN={class:"perf-metric-value"},TN={class:"perf-section"},NN={class:"perf-metrics"},DN={key:0,class:"perf-metric"},IN={class:"perf-metric-value"},ON={key:1,class:"perf-metric"},BN={class:"perf-metric-value"},RN={key:2,class:"perf-metric"},FN={class:"perf-metric-value"},jN={class:"perf-section"},zN={class:"perf-table"},$N={class:"perf-table-cell"},UN={class:"perf-table-cell"},VN={class:"perf-table-cell"},GN={class:"perf-table-cell"},HN=["onClick"],qN={key:0,class:"perf-empty"},WN=ds({__name:"PerformancePanel",props:{position:{}},setup(e){const t=e.position||"bottom-left",r=zt(!1),{isQueryParamEnabled:i,isRecording:s,measures:o,longTasks:u,memorySnapshots:f,framesPerSecond:d,operationHistory:m,startRecording:_,stopRecording:w,clearRecording:y,captureMemorySnapshot:M,getSlowOperations:k,getPerformanceReport:F,getOperationDetails:I}=md(),R=sr(()=>{const D=F()??{totalMeasures:0,totalLongTasks:0,slowestOperations:[],averageFps:0,memoryUsage:null};return{totalMeasures:D.totalMeasures,totalLongTasks:D.totalLongTasks,averageDuration:D.slowestOperations.length>0?D.slowestOperations.reduce((B,$)=>B+$.duration,0)/D.slowestOperations.length:0,fps:D.averageFps,slowestOperations:D.slowestOperations,memoryUsage:D.memoryUsage}}),K=sr(()=>(F()??{slowestOperations:[]}).slowestOperations.slice(0,5).map(B=>({operation:B.name,component:B.component||"unknown",durationMs:B.duration,timestamp:B.startTime}))),ee=zt(null);Cs(()=>{i.value&&(ee.value=window.setInterval(()=>{M()},1e3))}),mc(()=>{ee.value!==null&&clearInterval(ee.value)});function he(D){return D===void 0?"N/A":D<1024?D+" B":D<1024*1024?(D/1024).toFixed(2)+" KB":D<1024*1024*1024?(D/(1024*1024)).toFixed(2)+" MB":(D/(1024*1024*1024)).toFixed(2)+" GB"}function fe(D){return D.toFixed(2)}const ve=()=>{M()};function z(){const D=F(),B="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(D,null,2)),$=document.createElement("a");$.setAttribute("href",B),$.setAttribute("download","performance_report.json"),document.body.appendChild($),$.click(),$.remove()}function U(){y(),ve()}function J(){const D=F();navigator.clipboard.writeText(JSON.stringify(D,null,2)).then(()=>{alert("Données de performance copiées dans le presse-papiers")}).catch(B=>{console.error("Erreur lors de la copie des données",B),alert("Erreur lors de la copie des données")})}async function T(D){const B=I(D.operation,D.timestamp);if(!B){alert("Impossible de trouver les détails de cette opération");return}const $={operation:{...B.operation,startTimeRelative:"0ms",startTimeAbsolute:new Date(B.operation.startTime).toISOString()},context:{...B.context,relatedOperations:B.context.relatedOperations.map(W=>({...W,startTime:`+${W.startTime.toFixed(2)}ms`})),longTasks:B.context.longTasks.map(W=>({...W,startTime:`+${W.startTime.toFixed(2)}ms`})),memorySnapshots:B.context.memorySnapshots.map(W=>({...W,timestamp:`+${W.timestamp.toFixed(2)}ms`,usedJSHeapSize:W.usedJSHeapSize?he(W.usedJSHeapSize):"N/A",totalJSHeapSize:W.totalJSHeapSize?he(W.totalJSHeapSize):"N/A"}))},summary:{...B.summary,memoryDelta:he(B.summary.memoryDelta),maxLongTaskDuration:`${B.summary.maxLongTaskDuration.toFixed(2)}ms`}};try{await navigator.clipboard.writeText(JSON.stringify($,null,2)),alert("Détails de l'opération copiés dans le presse-papiers")}catch(W){console.error("Erreur lors de la copie des détails",W),alert("Erreur lors de la copie des détails")}}return(D,B)=>{var $,W,G,oe,ie,we;return Kn(i)?($e(),qe("div",{key:0,class:Vi(["performance-panel",`position-${Kn(t)}`,{expanded:r.value}])},[C("div",{class:"perf-header",onClick:B[0]||(B[0]=Ce=>r.value=!r.value)},[C("div",gN,[C("div",{class:Vi(["perf-indicator",{active:Kn(s)}])},null,2),B[1]||(B[1]=C("span",null,"Performance",-1))]),C("div",mN,[C("span",vN,Zt(R.value.fps)+" FPS",1),C("span",yN,Zt(fe(R.value.averageDuration))+"ms",1)]),C("button",_N,Zt(r.value?"▼":"▲"),1)]),r.value?($e(),qe("div",bN,[C("div",wN,[B[6]||(B[6]=C("h3",null,"Métriques générales",-1)),C("div",xN,[C("div",LN,[B[2]||(B[2]=C("span",{class:"perf-metric-label"},"Mesures",-1)),C("span",SN,Zt(R.value.totalMeasures),1)]),C("div",EN,[B[3]||(B[3]=C("span",{class:"perf-metric-label"},"Tâches longues",-1)),C("span",CN,Zt(R.value.totalLongTasks),1)]),C("div",PN,[B[4]||(B[4]=C("span",{class:"perf-metric-label"},"Durée moyenne",-1)),C("span",MN,Zt(fe(R.value.averageDuration))+"ms",1)]),C("div",AN,[B[5]||(B[5]=C("span",{class:"perf-metric-label"},"FPS",-1)),C("span",kN,Zt(R.value.fps),1)])])]),C("div",TN,[B[10]||(B[10]=C("h3",null,"Mémoire",-1)),C("div",NN,[(($=R.value.memoryUsage)==null?void 0:$.usedJSHeapSize)!==void 0?($e(),qe("div",DN,[B[7]||(B[7]=C("span",{class:"perf-metric-label"},"Utilisée",-1)),C("span",IN,Zt(he((W=R.value.memoryUsage)==null?void 0:W.usedJSHeapSize)),1)])):pn("",!0),((G=R.value.memoryUsage)==null?void 0:G.totalJSHeapSize)!==void 0?($e(),qe("div",ON,[B[8]||(B[8]=C("span",{class:"perf-metric-label"},"Totale",-1)),C("span",BN,Zt(he((oe=R.value.memoryUsage)==null?void 0:oe.totalJSHeapSize)),1)])):pn("",!0),((ie=R.value.memoryUsage)==null?void 0:ie.jsHeapSizeLimit)!==void 0?($e(),qe("div",RN,[B[9]||(B[9]=C("span",{class:"perf-metric-label"},"Limite",-1)),C("span",FN,Zt(he((we=R.value.memoryUsage)==null?void 0:we.jsHeapSizeLimit)),1)])):pn("",!0)])]),C("div",jN,[B[13]||(B[13]=C("h3",null,"Opérations les plus lentes",-1)),C("div",zN,[B[12]||(B[12]=$u('<div class="perf-table-header" data-v-fefe39b0><div class="perf-table-cell" data-v-fefe39b0>Opération</div><div class="perf-table-cell" data-v-fefe39b0>Composant</div><div class="perf-table-cell" data-v-fefe39b0>Durée</div><div class="perf-table-cell" data-v-fefe39b0>Actions</div></div>',1)),($e(!0),qe(Tn,null,Lr(K.value,Ce=>($e(),qe("div",{class:"perf-table-row",key:Ce.timestamp},[C("div",$N,Zt(Ce.operation),1),C("div",UN,Zt(Ce.component),1),C("div",VN,Zt(fe(Ce.durationMs))+"ms",1),C("div",GN,[C("button",{onClick:Te=>T(Ce),class:"perf-action-button",title:"Copier les détails"},B[11]||(B[11]=[C("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)]),8,HN)])]))),128)),K.value.length===0?($e(),qe("div",qN," Aucune opération enregistrée ")):pn("",!0)])]),C("div",{class:"perf-actions"},[C("button",{onClick:U,class:"perf-button"}," Réinitialiser "),C("button",{onClick:z,class:"perf-button"}," Télécharger "),C("button",{onClick:J,class:"perf-button"}," Copier ")])])):pn("",!0)],2)):pn("",!0)}}}),vd=(e,n)=>{const t=e.__vccOpts||e;for(const[r,i]of n)t[r]=i;return t},ZN=vd(WN,[["__scopeId","data-v-fefe39b0"]]),KN={class:"h-screen flex flex-col"},YN={key:0,class:"bg-white shadow-sm z-[2500] flex-shrink-0"},JN={class:"mx-auto px-4 sm:px-6 lg:px-8"},XN={class:"flex h-16 items-center justify-between"},QN={class:"flex items-center"},eD={class:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},tD={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"},nD={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},rD={class:"hidden md:flex md:ml-6 space-x-8"},iD={key:0,class:"flex-1 mx-2"},oD={class:"hidden md:block"},sD={class:"md:hidden"},aD={key:1,class:"flex-1"},lD={class:"flex items-center space-x-2 md:space-x-4"},uD={key:0,class:"hidden md:flex items-center justify-center p-2 text-amber-500 hover:text-amber-600 rounded-full hover:bg-amber-50 focus:outline-none focus:ring-2 focus:ring-amber-400",title:"Performance activée"},cD={class:"relative"},fD={class:"px-4 py-2 border-b border-gray-100 flex justify-between items-center"},hD={class:"flex items-center justify-between w-full"},dD={class:"flex items-center space-x-3"},pD={class:"max-h-72 overflow-y-auto"},gD={key:0,class:"px-4 py-3 text-sm text-gray-500 text-center"},mD={class:"flex items-start"},vD={class:"flex-shrink-0 mr-3"},yD={key:0,class:"h-6 w-6 md:h-5 md:w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor"},_D={key:1,class:"h-6 w-6 md:h-5 md:w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},bD={key:2,class:"h-6 w-6 md:h-5 md:w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},wD={key:3,class:"h-6 w-6 md:h-5 md:w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor"},xD={class:"flex-1"},LD={class:"text-sm md:text-sm text-gray-800"},SD=["onClick"],ED={class:"relative"},CD={class:"hidden md:flex flex-col items-end"},PD={class:"text-sm font-medium text-gray-700"},MD={key:0,class:"text-xs text-gray-500"},AD=["src","alt"],kD={class:"md:hidden px-4 py-2 border-b border-gray-100 flex justify-between items-center"},TD={class:"text-sm font-semibold text-gray-700"},ND={class:"text-xs text-gray-500"},DD={key:0,class:"md:hidden fixed inset-0 bg-white shadow-lg z-[3000] border-t border-gray-200",style:{top:"var(--header-height)"}},ID={class:"space-y-1 px-2 pb-3 pt-2"},OD=ds({__name:"App",setup(e){const n=Bp(),t=ma(),r=vu(),{isQueryParamEnabled:i}=md(),s=zt(!1),o=zt(!1),u=zt(!1),f=zt(!1),d=zt(null),m=zt(!1),_=zt(!1),w=zt(null),y=zt("13px"),M=zt("65px");function k(){_.value=window.innerWidth<768}Cs(()=>{k(),window.addEventListener("resize",k),window.addEventListener("resize",F)}),fh(()=>{window.removeEventListener("resize",k),window.removeEventListener("resize",F)});function F(){if(!w.value)return;const B=w.value.getBoundingClientRect();y.value=`${B.top+window.scrollY+5}px`;const $=B.left+B.width/2;M.value=`${window.innerWidth-$-22}px`}const I=sr(()=>{const B=t.user;if(!B)return"";const $=`${B.first_name} ${B.last_name.toUpperCase()}`;return B.company_name?`${$} (${B.company_name})`:$}),R=sr(()=>{var $;switch(($=t.user)==null?void 0:$.user_type){case"admin":return"Accès administrateur";case"entreprise":return"Accès entreprise";case"salarie":return"Accès salarie";case"visiteur":return"Accès visiteur";default:return""}}),K=sr(()=>{var B;return((B=t.user)==null?void 0:B.user_type)==="admin"}),ee=sr(()=>t.isAuthenticated),he=[{name:"Carte",to:"/"},{name:"Notes",to:"/notes"}],fe=sr(()=>{var $;if(!ee.value)return[];const B=[...he];return(K.value||(($=t.user)==null?void 0:$.user_type)==="entreprise")&&B.push({name:"Utilisateurs",to:"/users"}),B}),ve=sr(()=>ee.value?[{name:"Mon profil",to:"/profile"}]:[]);async function z(){try{await t.logout(),n.push("/login")}catch(B){console.error("Erreur lors de la déconnexion:",B)}}function U(B){window.dispatchEvent(new CustomEvent("map-set-location",{detail:{lat:B.lat,lng:B.lng,zoom:16}}))}Cs(async()=>{console.log("App mounted, checking auth...");try{if(localStorage.getItem("token")){console.log("Token found, checking auth..."),await t.checkAuth(),await t.fetchUserProfile();const $=localStorage.getItem("lastPlanId");$&&window.dispatchEvent(new CustomEvent("load-last-plan",{detail:{planId:$}}))}else console.log("No token found")}catch(B){console.error("Auth check error:",B),n.push("/login")}});const J=sr(()=>{const B="TagMap";if(!ee.value)return`${B} - Connexion`;const $=n.currentRoute.value,G={home:"Carte",notes:"Notes",users:"Utilisateurs",profile:"Mon profil",changePassword:"Changement de mot de passe",map:"Carte"}[$.name]||"";return G?`${B} - ${G}`:B});oo(J,B=>{document.title=B},{immediate:!0});const T=sr(()=>r.notifications.length);function D(){r.clearAll(),u.value=!1}return wp(()=>{if(r.lastAddedId!==null){const B=r.notifications.find($=>$.id===r.lastAddedId);B&&Us(()=>{F(),f.value=!0,d.value={id:B.id,message:B.message,type:B.type},requestAnimationFrame(()=>{setTimeout(()=>{m.value=!0,setTimeout(()=>{m.value=!1,setTimeout(()=>{var $;(($=d.value)==null?void 0:$.id)===B.id&&(d.value=null,f.value=!1)},300)},4e3)},50)})})}}),(B,$)=>{var W;return $e(),qe("div",KN,[ee.value?($e(),qe("header",YN,[C("nav",JN,[C("div",XN,[C("div",QN,[C("button",{onClick:$[0]||($[0]=G=>o.value=!o.value),class:"inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500 md:hidden"},[$[7]||($[7]=C("span",{class:"sr-only"},"Ouvrir le menu",-1)),($e(),qe("svg",eD,[o.value?($e(),qe("path",nD)):($e(),qe("path",tD))]))]),di(Kn($d),{to:"/",class:"text-xl font-semibold text-primary-600 truncate ml-2 md:ml-0"},{default:pu(()=>$[8]||($[8]=[C("span",{class:"md:inline hidden"},"TagMap",-1),C("span",{class:"md:hidden inline"},"TM",-1)])),_:1}),C("div",rD,[($e(!0),qe(Tn,null,Lr(fe.value,G=>($e(),rl(Kn($d),{key:G.name,to:G.to,class:Vi(["text-sm font-medium transition-colors duration-200",[B.$route.path===G.to?"text-primary-600 border-b-2 border-primary-500":"text-gray-500 hover:text-gray-900"]])},{default:pu(()=>[Li(Zt(G.name),1)]),_:2},1032,["to","class"]))),128))])]),B.$route.path==="/"?($e(),qe("div",iD,[C("div",oD,[di(nb,{onSelectLocation:U})]),C("div",sD,[di(nb,{onSelectLocation:U,class:"max-w-full"})])])):($e(),qe("div",aD)),C("div",lD,[Kn(i)?($e(),qe("button",uD,$[9]||($[9]=[C("span",{class:"sr-only"},"Performance",-1),C("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)]))):pn("",!0),C("div",cD,[C("button",{ref_key:"bellButtonRef",ref:w,onClick:$[1]||($[1]=G=>u.value=!u.value),class:Vi(["relative flex items-center justify-center p-2 text-gray-400 hover:text-gray-500 rounded-full hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",{"animate-bell":f.value}])},$[10]||($[10]=[C("span",{class:"sr-only"},"Voir les notifications",-1),C("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})],-1)]),2),u.value?($e(),qe("div",{key:0,class:"absolute right-0 mt-2 md:w-80 w-screen md:origin-top-right md:rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-[3500] md:right-0 right-0 left-0 md:left-auto",style:ql(_.value?"position: fixed; top: 64px; left: 0; right: 0; margin: 0;":"")},[C("div",fD,[C("div",hD,[$[12]||($[12]=C("h3",{class:"text-sm font-semibold text-gray-700"},"Notifications",-1)),C("div",dD,[T.value>0?($e(),qe("button",{key:0,onClick:D,class:"text-xs text-primary-600 hover:text-primary-800"}," Tout effacer ")):pn("",!0),C("button",{onClick:$[2]||($[2]=G=>u.value=!1),class:"md:hidden p-1 rounded-full hover:bg-gray-100"},$[11]||($[11]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])])]),C("div",pD,[T.value===0?($e(),qe("div",gD," Aucune notification ")):pn("",!0),($e(!0),qe(Tn,null,Lr(Kn(r).notifications,G=>($e(),qe("div",{key:G.id,class:"px-4 py-3 md:py-3 py-4 border-b border-gray-100 last:border-0 hover:bg-gray-50"},[C("div",mD,[C("div",vD,[G.type==="success"?($e(),qe("svg",yD,$[13]||($[13]=[C("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):G.type==="error"?($e(),qe("svg",_D,$[14]||($[14]=[C("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"},null,-1)]))):G.type==="warning"?($e(),qe("svg",bD,$[15]||($[15]=[C("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)]))):($e(),qe("svg",wD,$[16]||($[16]=[C("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"},null,-1)])))]),C("div",xD,[C("p",LD,Zt(G.message),1),C("button",{onClick:oe=>Kn(r).removeNotification(G.id),class:"text-xs md:text-xs text-primary-600 hover:text-primary-800 mt-2 md:mt-1 py-1 md:py-0"}," Fermer ",8,SD)])])]))),128))])],4)):pn("",!0)]),C("div",ED,[C("button",{onClick:$[3]||($[3]=G=>s.value=!s.value),class:"flex items-center space-x-2 md:space-x-3 focus:outline-none"},[C("div",CD,[C("span",PD,Zt(I.value),1),R.value?($e(),qe("span",MD,Zt(R.value),1)):pn("",!0)]),C("img",{class:"h-8 w-8 rounded-full ring-2 ring-white",src:((W=Kn(t).user)==null?void 0:W.logo)||"https://ui-avatars.com/api/?name="+encodeURIComponent(I.value),alt:I.value},null,8,AD)]),s.value?($e(),qe("div",{key:0,class:"absolute right-0 mt-2 md:w-48 w-screen md:origin-top-right md:rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-[3500] md:right-0 right-0 left-0 md:left-auto",style:ql(_.value?"position: fixed; top: 64px; left: 0; right: 0; margin: 0;":"")},[C("div",kD,[C("div",null,[C("div",TD,Zt(I.value),1),C("div",ND,Zt(R.value),1)]),C("button",{onClick:$[4]||($[4]=G=>s.value=!1),class:"p-1 rounded-full hover:bg-gray-100"},$[17]||($[17]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),($e(!0),qe(Tn,null,Lr(ve.value,G=>($e(),rl(Kn($d),{key:G.name,to:G.to,class:"block px-4 md:py-2 py-3 text-sm text-gray-700 hover:bg-gray-50 border-b border-gray-100 last:border-b-0",onClick:$[5]||($[5]=oe=>s.value=!1)},{default:pu(()=>[Li(Zt(G.name),1)]),_:2},1032,["to"]))),128)),C("button",{onClick:z,class:"block w-full px-4 md:py-2 py-3 text-left text-sm text-red-600 hover:bg-gray-50 font-medium"}," Déconnexion ")],4)):pn("",!0)])])]),o.value?($e(),qe("div",DD,[C("div",ID,[($e(!0),qe(Tn,null,Lr(fe.value,G=>($e(),rl(Kn($d),{key:G.name,to:G.to,class:Vi(["block px-3 py-2 rounded-md text-base font-medium",[B.$route.path===G.to?"bg-primary-50 text-primary-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"]]),onClick:$[6]||($[6]=oe=>o.value=!1)},{default:pu(()=>[Li(Zt(G.name),1)]),_:2},1032,["to","class"]))),128))])])):pn("",!0)])])):pn("",!0),C("main",{class:Vi([B.$route.path==="/"&&!_.value?"overflow-hidden":"overflow-auto","flex-1 flex flex-col","md:h-[calc(100vh-64px)]"])},[di(Kn(Z5))],2),di(ZN,{position:"bottom-left"})])}}}),BD="modulepreload",RD=function(e){return"/static/frontend/"+e},rb={},mf=function(n,t,r){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),u=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(t.map(f=>{if(f=RD(f),f in rb)return;rb[f]=!0;const d=f.endsWith(".css"),m=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${m}`))return;const _=document.createElement("link");if(_.rel=d?"stylesheet":BD,d||(_.as="script"),_.crossOrigin="",_.href=f,u&&_.setAttribute("nonce",u),document.head.appendChild(_),d)return new Promise((w,y)=>{_.addEventListener("load",w),_.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${f}`)))})}))}function s(o){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=o,window.dispatchEvent(u),!u.defaultPrevented)throw o}return i.then(o=>{for(const u of o||[])u.status==="rejected"&&s(u.reason);return n().catch(s)})},FD={class:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8"},jD={class:"max-w-md w-full space-y-8"},zD={class:"space-y-4"},$D={class:"mt-1"},UD={class:"mt-1"},VD={class:"mt-1"},GD={key:0,class:"rounded-md bg-red-50 p-4"},HD={class:"flex"},qD={class:"ml-3"},WD={class:"text-sm font-medium text-red-800"},ZD={key:1,class:"rounded-md bg-yellow-50 p-4"},KD={class:"flex"},YD={class:"ml-3"},JD={class:"mt-2 text-sm text-yellow-700"},XD={class:"list-disc pl-5 space-y-1"},QD=["disabled"],e7={class:"absolute left-0 inset-y-0 flex items-center pl-3"},t7={key:0,class:"h-5 w-5 text-primary-500 group-hover:text-primary-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},n7={key:1,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},r7=ds({__name:"ChangePasswordForm",setup(e){const n=Bp(),t=ma(),r=Yl({oldPassword:"",newPassword:"",confirmPassword:""}),i=zt(!1),s=zt("");Cs(()=>{var d,m;console.log("ChangePasswordForm mounted, auth state:",{isAuthenticated:t.isAuthenticated,userId:(d=t.user)==null?void 0:d.id,mustChangePassword:(m=t.user)==null?void 0:m.must_change_password})});const o=sr(()=>{const d=[];return r.newPassword&&r.newPassword.length<8&&d.push("Le nouveau mot de passe doit contenir au moins 8 caractères"),r.newPassword&&r.confirmPassword&&r.newPassword!==r.confirmPassword&&d.push("Les mots de passe ne correspondent pas"),d}),u=sr(()=>r.oldPassword.length>0&&r.newPassword.length>=8&&r.newPassword===r.confirmPassword);async function f(){var d,m,_,w,y,M,k,F;if(!u.value){s.value="Veuillez corriger les erreurs avant de continuer";return}if(!((d=t.user)!=null&&d.id)){s.value="Erreur : utilisateur non identifié";return}i.value=!0,s.value="";try{console.log("Submitting password change..."),await t.changePassword(r.oldPassword,r.newPassword),console.log("Password changed successfully"),n.push("/")}catch(I){console.error("Password change failed:",I),(_=(m=I.response)==null?void 0:m.data)!=null&&_.detail?s.value=I.response.data.detail:(y=(w=I.response)==null?void 0:w.data)!=null&&y.old_password?s.value=I.response.data.old_password[0]:(k=(M=I.response)==null?void 0:M.data)!=null&&k.password?s.value=I.response.data.password[0]:((F=I.response)==null?void 0:F.status)===401?(s.value="Session expirée, veuillez vous reconnecter",await t.logout(),n.push("/login")):s.value="Une erreur est survenue lors du changement de mot de passe"}finally{i.value=!1}}return(d,m)=>($e(),qe("div",FD,[C("div",jD,[m[12]||(m[12]=C("div",null,[C("h2",{class:"mt-6 text-center text-3xl font-extrabold text-gray-900"}," Changement de mot de passe "),C("p",{class:"mt-2 text-center text-sm text-gray-600"}," Pour des raisons de sécurité, vous devez changer votre mot de passe. ")],-1)),C("form",{class:"mt-8 space-y-6",onSubmit:Gc(f,["prevent"])},[C("div",zD,[C("div",null,[m[3]||(m[3]=C("label",{for:"old-password",class:"block text-sm font-medium text-gray-700"},"Ancien mot de passe",-1)),C("div",$D,[Fn(C("input",{id:"old-password","onUpdate:modelValue":m[0]||(m[0]=_=>r.oldPassword=_),name:"old-password",type:"password",required:"",autocomplete:"current-password",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Entrez votre mot de passe actuel"},null,512),[[ni,r.oldPassword]])])]),C("div",null,[m[4]||(m[4]=C("label",{for:"new-password",class:"block text-sm font-medium text-gray-700"},"Nouveau mot de passe",-1)),C("div",UD,[Fn(C("input",{id:"new-password","onUpdate:modelValue":m[1]||(m[1]=_=>r.newPassword=_),name:"new-password",type:"password",required:"",autocomplete:"new-password",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Entrez votre nouveau mot de passe"},null,512),[[ni,r.newPassword]])]),m[5]||(m[5]=C("p",{class:"mt-1 text-sm text-gray-500"}," Le mot de passe doit contenir au moins 8 caractères ",-1))]),C("div",null,[m[6]||(m[6]=C("label",{for:"confirm-password",class:"block text-sm font-medium text-gray-700"},"Confirmer le mot de passe",-1)),C("div",VD,[Fn(C("input",{id:"confirm-password","onUpdate:modelValue":m[2]||(m[2]=_=>r.confirmPassword=_),name:"confirm-password",type:"password",required:"",autocomplete:"new-password",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Confirmez votre nouveau mot de passe"},null,512),[[ni,r.confirmPassword]])])])]),s.value?($e(),qe("div",GD,[C("div",HD,[m[7]||(m[7]=C("div",{class:"flex-shrink-0"},[C("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[C("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),C("div",qD,[C("h3",WD,Zt(s.value),1)])])])):pn("",!0),o.value.length>0?($e(),qe("div",ZD,[C("div",KD,[m[9]||(m[9]=C("div",{class:"flex-shrink-0"},[C("svg",{class:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},[C("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])],-1)),C("div",YD,[m[8]||(m[8]=C("h3",{class:"text-sm font-medium text-yellow-800"},"Attention",-1)),C("div",JD,[C("ul",XD,[($e(!0),qe(Tn,null,Lr(o.value,(_,w)=>($e(),qe("li",{key:w},Zt(_),1))),128))])])])])])):pn("",!0),C("div",null,[C("button",{type:"submit",disabled:i.value||!u.value,class:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50"},[C("span",e7,[i.value?($e(),qe("svg",n7,m[11]||(m[11]=[C("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),C("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):($e(),qe("svg",t7,m[10]||(m[10]=[C("path",{"fill-rule":"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule":"evenodd"},null,-1)])))]),Li(" "+Zt(i.value?"Modification en cours...":"Changer le mot de passe"),1)],8,QD)])],32)])]))}}),i7="/static/frontend/assets/background.svg",o7={class:"min-h-screen overflow-auto relative py-12 sm:px-6 lg:px-8"},s7={class:"container mx-auto relative z-10"},a7={class:"sm:mx-auto sm:w-full sm:max-w-md"},l7={class:"bg-white/95 backdrop-blur-sm py-8 px-6 shadow-xl rounded-xl sm:px-10 border border-white/20"},u7={key:0,class:"rounded-md bg-red-50 p-4"},c7={class:"flex"},f7={class:"ml-3"},h7={class:"text-sm font-medium text-red-800"},d7={class:"mt-1"},p7={class:"mt-1 relative"},g7=["type"],m7={key:0,class:"h-5 w-5 text-gray-400 hover:text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},v7={key:1,class:"h-5 w-5 text-gray-400 hover:text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},y7={class:"flex items-center justify-between"},_7={class:"flex items-center"},b7={class:"text-sm"},w7=["disabled"],x7={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},L7={class:"mt-16 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},S7={class:"mt-12"},E7={class:"flex flex-wrap justify-center gap-2 mb-8"},C7=["onClick"],P7={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},M7={class:"flex items-center mb-4"},A7={class:"text-2xl mr-2"},k7={class:"text-xl font-semibold text-gray-900"},T7={class:"text-gray-600 text-sm"},N7={key:0,class:"flex justify-center mt-8 gap-2"},D7=["onClick"],tv=6,I7=ds({__name:"LoginView",setup(e){const n=Bp(),t=ma(),r=zt(!1),i=zt(null),s=zt(!1),o=zt("Tous"),u=zt(1),f=Yl({username:"",password:"",rememberMe:!1}),d=[{type:"Liniculteur",sector:"Agriculture",icon:"🌾",text:"En tant qu'entreprise, j'ai mis en place un sous-compte « agriculteur » permettant la géolocalisation des parcelles. Cela offre à nos salariés et prestataires une visibilité complète sur l'ensemble des parcelles et facilite leur accès. De plus, ils peuvent y ajouter des notes et des photos si nécessaire. Grâce aux trackers, nous renforçons également la sécurité de nos machines contre le vol."},{type:"Agro industriel",sector:"Industrie",icon:"🏭",text:"La gestion des comptes et sous-comptes est un atout majeur pour limiter, filtrer et contrôler l'accès de nos salariés aux différentes tâches."},{type:"Agence de voyage",sector:"Tourisme",icon:"✈️",text:"L'outil nous permet de créer gratuitement et sans limite des sous-comptes clients, d'établir des itinéraires personnalisés avec des points d'intérêt."},{type:"Industriel agroalimentaire",sector:"Industrie",icon:"🌱",text:"Nous disposons d'un compte entreprise avec des sous-comptes dédiés à chaque culture. Nos techniciens et agriculteurs partenaires peuvent ainsi ajouter des annotations et photo sur les parcelles. Grâce aux stations météo connectées, nous optimisons la gestion des tours d'irrigation par secteur géographique en fonction des précipitations."},{type:"Conseil municipal",sector:"Collectivité",icon:"🏛️",text:"Cette solution nous permet de gagner en efficacité dans la gestion des tâches à réaliser, en les géolocalisant et en offrant à nos employés communaux la possibilité d'ajouter des commentaires et des photos sur chaque tâche géoréférencée."},{type:"Location de matériel",sector:"Services",icon:"🚜",text:"Cette solution nous permet de géolocaliser notre flotte grâce à des trackers sans abonnement, avec uniquement un abonnement à la plateforme."},{type:"Agriculteur",sector:"Agriculture",icon:"👨‍🌾",text:"J'ai équipé tous mes canons d'enrouleurs de trackers et de caméras pour dissuader le vol de batteries."},{type:"Semencier",sector:"Agriculture",icon:"🌱",text:"Nous assurons la géolocalisation de l'ensemble de nos parcelles en France."},{type:"Concessionnaire irrigation",sector:"Services",icon:"💧",text:"Nous avons géolocalisé tous les forages de nos clients et ajouté en commentaire la procédure d'entrée, facilitant ainsi le travail de nos techniciens et agriculteurs lors des interventions."},{type:"Entreprise paysagiste",sector:"Services",icon:"🌳",text:"Nous géolocalisons tous nos chantiers et ajoutons une photo du chantier terminé en commentaire, servant de preuve en cas de litige."}],m=sr(()=>["Tous",...new Set(d.map(k=>k.sector))]),_=sr(()=>{let M=o.value==="Tous"?d:d.filter(I=>I.sector===o.value);const k=(u.value-1)*tv,F=k+tv;return M.slice(k,F)}),w=sr(()=>{const M=o.value==="Tous"?d:d.filter(k=>k.sector===o.value);return Math.ceil(M.length/tv)});Cs(async()=>{var M;console.log("LoginView mounted"),console.log("INITIAL_STATE:",window.INITIAL_STATE);try{if((M=window.INITIAL_STATE)!=null&&M.isAuthenticated){console.log("User is authenticated, redirecting to home"),n.push("/");return}await t.restoreSession()&&(console.log("Session restored, redirecting to home"),n.push("/"))}catch(k){console.error("Error during initialization:",k),i.value=null}});async function y(){var M,k,F,I,R,K,ee,he,fe;r.value=!0,i.value=null;try{if(!f.username||!f.password){i.value="Veuillez remplir tous les champs";return}await t.login(f.username,f.password),(M=t.user)!=null&&M.must_change_password?n.push("/change-password"):n.push("/")}catch(ve){console.error("Login error:",ve),((k=ve==null?void 0:ve.response)==null?void 0:k.status)===500?i.value="Le service est temporairement indisponible. Veuillez réessayer dans quelques instants.":((F=ve==null?void 0:ve.response)==null?void 0:F.status)===401||((I=ve==null?void 0:ve.response)==null?void 0:I.status)===403?i.value="Identifiants incorrects. Veuillez vérifier votre nom d'utilisateur et mot de passe.":(K=(R=ve==null?void 0:ve.response)==null?void 0:R.data)!=null&&K.detail?i.value=ve.response.data.detail:(fe=(he=(ee=ve==null?void 0:ve.response)==null?void 0:ee.data)==null?void 0:he.non_field_errors)!=null&&fe[0]?i.value=ve.response.data.non_field_errors[0]:(ve==null?void 0:ve.message)==="Network Error"?i.value="Impossible de se connecter au serveur. Veuillez vérifier votre connexion internet.":i.value="Une erreur est survenue lors de la connexion. Veuillez réessayer."}finally{r.value=!1}}return(M,k)=>{const F=Kw("router-link");return $e(),qe("div",o7,[C("div",{class:"fixed inset-0 z-0",style:ql({backgroundImage:`url(${Kn(i7)})`,backgroundSize:"400px",backgroundRepeat:"repeat",filter:"blur(1px) opacity(0.15)"})},null,4),k[16]||(k[16]=C("div",{class:"fixed inset-0 z-0 bg-gradient-to-br from-white/40 via-transparent to-primary-900/10"},null,-1)),C("div",s7,[C("div",a7,[C("div",l7,[k[12]||(k[12]=C("div",{class:"text-center mb-8"},[C("h2",{class:"text-3xl font-bold text-gray-900 mb-2"}," TagMap "),C("p",{class:"text-sm text-gray-600"}," Solution innovante de cartographie et gestion de projets ")],-1)),C("form",{class:"space-y-6",onSubmit:Gc(y,["prevent"])},[i.value?($e(),qe("div",u7,[C("div",c7,[k[4]||(k[4]=C("div",{class:"flex-shrink-0"},[C("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[C("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),C("div",f7,[C("h3",h7,Zt(i.value),1)])])])):pn("",!0),C("div",null,[k[5]||(k[5]=C("label",{for:"username",class:"block text-sm font-medium text-gray-700"}," Nom d'utilisateur ",-1)),C("div",d7,[Fn(C("input",{id:"username","onUpdate:modelValue":k[0]||(k[0]=I=>f.username=I),name:"username",type:"text",required:"",autocomplete:"username",class:"appearance-none block w-full h-11 px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 sm:text-sm","aria-label":"Nom d'utilisateur"},null,512),[[ni,f.username]])])]),C("div",null,[k[8]||(k[8]=C("label",{for:"password",class:"block text-sm font-medium text-gray-700"}," Mot de passe ",-1)),C("div",p7,[Fn(C("input",{id:"password","onUpdate:modelValue":k[1]||(k[1]=I=>f.password=I),type:s.value?"text":"password",name:"password",required:"",autocomplete:"current-password",class:"appearance-none block w-full h-11 px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 sm:text-sm pr-10","aria-label":"Mot de passe"},null,8,g7),[[iy,f.password]]),C("button",{type:"button",onClick:k[2]||(k[2]=I=>s.value=!s.value),class:"absolute inset-y-0 right-0 pr-3 flex items-center","aria-label":"Afficher/masquer le mot de passe"},[s.value?($e(),qe("svg",m7,k[6]||(k[6]=[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)]))):($e(),qe("svg",v7,k[7]||(k[7]=[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])))])])]),C("div",y7,[C("div",_7,[Fn(C("input",{id:"remember-me","onUpdate:modelValue":k[3]||(k[3]=I=>f.rememberMe=I),name:"remember-me",type:"checkbox",class:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded","aria-label":"Se souvenir de moi"},null,512),[[wl,f.rememberMe]]),k[9]||(k[9]=C("label",{for:"remember-me",class:"ml-2 block text-sm text-gray-900"}," Se souvenir de moi ",-1))]),C("div",b7,[di(F,{to:"/forgot-password",class:"font-medium text-primary-600 hover:text-primary-500 transition-colors duration-200"},{default:pu(()=>k[10]||(k[10]=[Li(" Mot de passe oublié ? ")])),_:1})])]),C("div",null,[C("button",{type:"submit",disabled:r.value,class:"w-full h-11 flex justify-center items-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Se connecter"},[r.value?($e(),qe("svg",x7,k[11]||(k[11]=[C("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),C("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):pn("",!0),Li(" "+Zt(r.value?"Connexion en cours...":"Se connecter"),1)],8,w7)])],32)])]),C("div",L7,[k[14]||(k[14]=$u('<div class="mb-12 bg-white/90 backdrop-blur-sm p-8 rounded-xl shadow-lg border border-white/20" data-v-9ff7ee32><div class="flex items-center mb-6" data-v-9ff7ee32><span class="text-2xl mr-2" data-v-9ff7ee32>💡</span><h3 class="text-xl font-bold text-gray-900" data-v-9ff7ee32>Équipements Connectés sans Abonnement</h3></div><div class="grid grid-cols-1 md:grid-cols-2 gap-6" data-v-9ff7ee32><div class="flex items-center space-x-4" data-v-9ff7ee32><div class="flex-shrink-0 text-2xl" data-v-9ff7ee32>📍</div><div data-v-9ff7ee32><h4 class="font-semibold" data-v-9ff7ee32>Tracker GPS solaire</h4><p class="text-gray-600" data-v-9ff7ee32>Géolocalisez et sécurisez votre matériel</p></div></div><div class="flex items-center space-x-4" data-v-9ff7ee32><div class="flex-shrink-0 text-2xl" data-v-9ff7ee32>🌤️</div><div data-v-9ff7ee32><h4 class="font-semibold" data-v-9ff7ee32>Station météo</h4><p class="text-gray-600" data-v-9ff7ee32>Optimisez vos décisions avec des données en temps réel</p></div></div></div></div><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8" data-v-9ff7ee32><div class="bg-white/90 backdrop-blur-sm p-6 rounded-xl shadow-lg border border-white/20" data-v-9ff7ee32><div class="flex items-center mb-4" data-v-9ff7ee32><span class="text-2xl mr-2" data-v-9ff7ee32>👀📌</span><h3 class="text-lg font-semibold text-gray-900" data-v-9ff7ee32>Carte Interactive</h3></div><p class="text-gray-600" data-v-9ff7ee32>Imaginez... Une carte interactive où tout est sous contrôle ! Tout est centralisé, organisé et accessible en un clin d&#39;œil !</p></div><div class="bg-white/90 backdrop-blur-sm p-6 rounded-xl shadow-lg border border-white/20" data-v-9ff7ee32><div class="flex items-center mb-4" data-v-9ff7ee32><span class="text-2xl mr-2" data-v-9ff7ee32>👥💻🔄</span><h3 class="text-lg font-semibold text-gray-900" data-v-9ff7ee32>Collaboration en Temps Réel</h3></div><p class="text-gray-600" data-v-9ff7ee32>Travail d&#39;équipe simplifié : Collaborez en temps réel sur une interface ultra-intuitive. Vos équipes restent synchronisées et efficaces !</p></div><div class="bg-white/90 backdrop-blur-sm p-6 rounded-xl shadow-lg border border-white/20" data-v-9ff7ee32><div class="flex items-center mb-4" data-v-9ff7ee32><span class="text-2xl mr-2" data-v-9ff7ee32>🚜📸</span><h3 class="text-lg font-semibold text-gray-900" data-v-9ff7ee32>Cerveau Cartographique</h3></div><p class="text-gray-600" data-v-9ff7ee32>Un cerveau cartographique : Dessinez, annotez, planifiez, suivez !</p></div><div class="bg-white/90 backdrop-blur-sm p-6 rounded-xl shadow-lg border border-white/20" data-v-9ff7ee32><div class="flex items-center mb-4" data-v-9ff7ee32><span class="text-2xl mr-2" data-v-9ff7ee32>🔐🔑</span><h3 class="text-lg font-semibold text-gray-900" data-v-9ff7ee32>Accès Sécurisé</h3></div><p class="text-gray-600" data-v-9ff7ee32>Accès sécurisé et intelligent : Gérez les droits d&#39;accès de vos salariés et prestataires en un clic.</p></div></div>',2)),C("div",S7,[k[13]||(k[13]=C("h3",{class:"text-2xl font-bold text-center text-gray-900 mb-8"},"Ils utilisent TagMap",-1)),C("div",E7,[($e(!0),qe(Tn,null,Lr(m.value,I=>($e(),qe("button",{key:I,onClick:R=>o.value=I,class:Vi(["px-4 py-2 rounded-full text-sm font-medium transition-all duration-200",o.value===I?"bg-primary-600 text-white":"bg-white/80 text-gray-700 hover:bg-primary-50"])},Zt(I),11,C7))),128))]),C("div",P7,[($e(!0),qe(Tn,null,Lr(_.value,I=>($e(),qe("div",{key:I.type,class:"bg-white/90 backdrop-blur-sm p-6 rounded-xl shadow-lg border border-white/20 transition-all duration-300 hover:shadow-xl"},[C("div",M7,[C("span",A7,Zt(I.icon),1),C("span",k7,Zt(I.type),1)]),C("p",T7,Zt(I.text),1)]))),128))]),w.value>1?($e(),qe("div",N7,[($e(!0),qe(Tn,null,Lr(w.value,I=>($e(),qe("button",{key:I,onClick:R=>u.value=I,class:Vi(["w-8 h-8 rounded-full text-sm font-medium transition-all duration-200",u.value===I?"bg-primary-600 text-white":"bg-white/80 text-gray-700 hover:bg-primary-50"])},Zt(I),11,D7))),128))])):pn("",!0)])]),k[15]||(k[15]=C("div",{class:"h-16"},null,-1))])])}}}),O7=vd(I7,[["__scopeId","data-v-9ff7ee32"]]),ib="/static/frontend/assets/logo.svg";var a1={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,n){(function(t,r){r(n)})(ea,function(t){var r="1.9.4";function i(a){var p,S,V,se;for(S=1,V=arguments.length;S<V;S++){se=arguments[S];for(p in se)a[p]=se[p]}return a}var s=Object.create||function(){function a(){}return function(p){return a.prototype=p,new a}}();function o(a,p){var S=Array.prototype.slice;if(a.bind)return a.bind.apply(a,S.call(arguments,1));var V=S.call(arguments,2);return function(){return a.apply(p,V.length?V.concat(S.call(arguments)):arguments)}}var u=0;function f(a){return"_leaflet_id"in a||(a._leaflet_id=++u),a._leaflet_id}function d(a,p,S){var V,se,Se,st;return st=function(){V=!1,se&&(Se.apply(S,se),se=!1)},Se=function(){V?se=arguments:(a.apply(S,arguments),setTimeout(st,p),V=!0)},Se}function m(a,p,S){var V=p[1],se=p[0],Se=V-se;return a===V&&S?a:((a-se)%Se+Se)%Se+se}function _(){return!1}function w(a,p){if(p===!1)return a;var S=Math.pow(10,p===void 0?6:p);return Math.round(a*S)/S}function y(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function M(a){return y(a).split(/\s+/)}function k(a,p){Object.prototype.hasOwnProperty.call(a,"options")||(a.options=a.options?s(a.options):{});for(var S in p)a.options[S]=p[S];return a.options}function F(a,p,S){var V=[];for(var se in a)V.push(encodeURIComponent(S?se.toUpperCase():se)+"="+encodeURIComponent(a[se]));return(!p||p.indexOf("?")===-1?"?":"&")+V.join("&")}var I=/\{ *([\w_ -]+) *\}/g;function R(a,p){return a.replace(I,function(S,V){var se=p[V];if(se===void 0)throw new Error("No value provided for variable "+S);return typeof se=="function"&&(se=se(p)),se})}var K=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"};function ee(a,p){for(var S=0;S<a.length;S++)if(a[S]===p)return S;return-1}var he="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function fe(a){return window["webkit"+a]||window["moz"+a]||window["ms"+a]}var ve=0;function z(a){var p=+new Date,S=Math.max(0,16-(p-ve));return ve=p+S,window.setTimeout(a,S)}var U=window.requestAnimationFrame||fe("RequestAnimationFrame")||z,J=window.cancelAnimationFrame||fe("CancelAnimationFrame")||fe("CancelRequestAnimationFrame")||function(a){window.clearTimeout(a)};function T(a,p,S){if(S&&U===z)a.call(p);else return U.call(window,o(a,p))}function D(a){a&&J.call(window,a)}var B={__proto__:null,extend:i,create:s,bind:o,get lastId(){return u},stamp:f,throttle:d,wrapNum:m,falseFn:_,formatNum:w,trim:y,splitWords:M,setOptions:k,getParamString:F,template:R,isArray:K,indexOf:ee,emptyImageUrl:he,requestFn:U,cancelFn:J,requestAnimFrame:T,cancelAnimFrame:D};function $(){}$.extend=function(a){var p=function(){k(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},S=p.__super__=this.prototype,V=s(S);V.constructor=p,p.prototype=V;for(var se in this)Object.prototype.hasOwnProperty.call(this,se)&&se!=="prototype"&&se!=="__super__"&&(p[se]=this[se]);return a.statics&&i(p,a.statics),a.includes&&(W(a.includes),i.apply(null,[V].concat(a.includes))),i(V,a),delete V.statics,delete V.includes,V.options&&(V.options=S.options?s(S.options):{},i(V.options,a.options)),V._initHooks=[],V.callInitHooks=function(){if(!this._initHooksCalled){S.callInitHooks&&S.callInitHooks.call(this),this._initHooksCalled=!0;for(var Se=0,st=V._initHooks.length;Se<st;Se++)V._initHooks[Se].call(this)}},p},$.include=function(a){var p=this.prototype.options;return i(this.prototype,a),a.options&&(this.prototype.options=p,this.mergeOptions(a.options)),this},$.mergeOptions=function(a){return i(this.prototype.options,a),this},$.addInitHook=function(a){var p=Array.prototype.slice.call(arguments,1),S=typeof a=="function"?a:function(){this[a].apply(this,p)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(S),this};function W(a){if(!(typeof L>"u"||!L||!L.Mixin)){a=K(a)?a:[a];for(var p=0;p<a.length;p++)a[p]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var G={on:function(a,p,S){if(typeof a=="object")for(var V in a)this._on(V,a[V],p);else{a=M(a);for(var se=0,Se=a.length;se<Se;se++)this._on(a[se],p,S)}return this},off:function(a,p,S){if(!arguments.length)delete this._events;else if(typeof a=="object")for(var V in a)this._off(V,a[V],p);else{a=M(a);for(var se=arguments.length===1,Se=0,st=a.length;Se<st;Se++)se?this._off(a[Se]):this._off(a[Se],p,S)}return this},_on:function(a,p,S,V){if(typeof p!="function"){console.warn("wrong listener type: "+typeof p);return}if(this._listens(a,p,S)===!1){S===this&&(S=void 0);var se={fn:p,ctx:S};V&&(se.once=!0),this._events=this._events||{},this._events[a]=this._events[a]||[],this._events[a].push(se)}},_off:function(a,p,S){var V,se,Se;if(this._events&&(V=this._events[a],!!V)){if(arguments.length===1){if(this._firingCount)for(se=0,Se=V.length;se<Se;se++)V[se].fn=_;delete this._events[a];return}if(typeof p!="function"){console.warn("wrong listener type: "+typeof p);return}var st=this._listens(a,p,S);if(st!==!1){var At=V[st];this._firingCount&&(At.fn=_,this._events[a]=V=V.slice()),V.splice(st,1)}}},fire:function(a,p,S){if(!this.listens(a,S))return this;var V=i({},p,{type:a,target:this,sourceTarget:p&&p.sourceTarget||this});if(this._events){var se=this._events[a];if(se){this._firingCount=this._firingCount+1||1;for(var Se=0,st=se.length;Se<st;Se++){var At=se[Se],Vt=At.fn;At.once&&this.off(a,Vt,At.ctx),Vt.call(At.ctx||this,V)}this._firingCount--}}return S&&this._propagateEvent(V),this},listens:function(a,p,S,V){typeof a!="string"&&console.warn('"string" type argument expected');var se=p;typeof p!="function"&&(V=!!p,se=void 0,S=void 0);var Se=this._events&&this._events[a];if(Se&&Se.length&&this._listens(a,se,S)!==!1)return!0;if(V){for(var st in this._eventParents)if(this._eventParents[st].listens(a,p,S,V))return!0}return!1},_listens:function(a,p,S){if(!this._events)return!1;var V=this._events[a]||[];if(!p)return!!V.length;S===this&&(S=void 0);for(var se=0,Se=V.length;se<Se;se++)if(V[se].fn===p&&V[se].ctx===S)return se;return!1},once:function(a,p,S){if(typeof a=="object")for(var V in a)this._on(V,a[V],p,!0);else{a=M(a);for(var se=0,Se=a.length;se<Se;se++)this._on(a[se],p,S,!0)}return this},addEventParent:function(a){return this._eventParents=this._eventParents||{},this._eventParents[f(a)]=a,this},removeEventParent:function(a){return this._eventParents&&delete this._eventParents[f(a)],this},_propagateEvent:function(a){for(var p in this._eventParents)this._eventParents[p].fire(a.type,i({layer:a.target,propagatedFrom:a.target},a),!0)}};G.addEventListener=G.on,G.removeEventListener=G.clearAllEventListeners=G.off,G.addOneTimeEventListener=G.once,G.fireEvent=G.fire,G.hasEventListeners=G.listens;var oe=$.extend(G);function ie(a,p,S){this.x=S?Math.round(a):a,this.y=S?Math.round(p):p}var we=Math.trunc||function(a){return a>0?Math.floor(a):Math.ceil(a)};ie.prototype={clone:function(){return new ie(this.x,this.y)},add:function(a){return this.clone()._add(Ce(a))},_add:function(a){return this.x+=a.x,this.y+=a.y,this},subtract:function(a){return this.clone()._subtract(Ce(a))},_subtract:function(a){return this.x-=a.x,this.y-=a.y,this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){return this.x/=a,this.y/=a,this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){return this.x*=a,this.y*=a,this},scaleBy:function(a){return new ie(this.x*a.x,this.y*a.y)},unscaleBy:function(a){return new ie(this.x/a.x,this.y/a.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=we(this.x),this.y=we(this.y),this},distanceTo:function(a){a=Ce(a);var p=a.x-this.x,S=a.y-this.y;return Math.sqrt(p*p+S*S)},equals:function(a){return a=Ce(a),a.x===this.x&&a.y===this.y},contains:function(a){return a=Ce(a),Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+w(this.x)+", "+w(this.y)+")"}};function Ce(a,p,S){return a instanceof ie?a:K(a)?new ie(a[0],a[1]):a==null?a:typeof a=="object"&&"x"in a&&"y"in a?new ie(a.x,a.y):new ie(a,p,S)}function Te(a,p){if(a)for(var S=p?[a,p]:a,V=0,se=S.length;V<se;V++)this.extend(S[V])}Te.prototype={extend:function(a){var p,S;if(!a)return this;if(a instanceof ie||typeof a[0]=="number"||"x"in a)p=S=Ce(a);else if(a=Y(a),p=a.min,S=a.max,!p||!S)return this;return!this.min&&!this.max?(this.min=p.clone(),this.max=S.clone()):(this.min.x=Math.min(p.x,this.min.x),this.max.x=Math.max(S.x,this.max.x),this.min.y=Math.min(p.y,this.min.y),this.max.y=Math.max(S.y,this.max.y)),this},getCenter:function(a){return Ce((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return Ce(this.min.x,this.max.y)},getTopRight:function(){return Ce(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var p,S;return typeof a[0]=="number"||a instanceof ie?a=Ce(a):a=Y(a),a instanceof Te?(p=a.min,S=a.max):p=S=a,p.x>=this.min.x&&S.x<=this.max.x&&p.y>=this.min.y&&S.y<=this.max.y},intersects:function(a){a=Y(a);var p=this.min,S=this.max,V=a.min,se=a.max,Se=se.x>=p.x&&V.x<=S.x,st=se.y>=p.y&&V.y<=S.y;return Se&&st},overlaps:function(a){a=Y(a);var p=this.min,S=this.max,V=a.min,se=a.max,Se=se.x>p.x&&V.x<S.x,st=se.y>p.y&&V.y<S.y;return Se&&st},isValid:function(){return!!(this.min&&this.max)},pad:function(a){var p=this.min,S=this.max,V=Math.abs(p.x-S.x)*a,se=Math.abs(p.y-S.y)*a;return Y(Ce(p.x-V,p.y-se),Ce(S.x+V,S.y+se))},equals:function(a){return a?(a=Y(a),this.min.equals(a.getTopLeft())&&this.max.equals(a.getBottomRight())):!1}};function Y(a,p){return!a||a instanceof Te?a:new Te(a,p)}function H(a,p){if(a)for(var S=p?[a,p]:a,V=0,se=S.length;V<se;V++)this.extend(S[V])}H.prototype={extend:function(a){var p=this._southWest,S=this._northEast,V,se;if(a instanceof ue)V=a,se=a;else if(a instanceof H){if(V=a._southWest,se=a._northEast,!V||!se)return this}else return a?this.extend(le(a)||Q(a)):this;return!p&&!S?(this._southWest=new ue(V.lat,V.lng),this._northEast=new ue(se.lat,se.lng)):(p.lat=Math.min(V.lat,p.lat),p.lng=Math.min(V.lng,p.lng),S.lat=Math.max(se.lat,S.lat),S.lng=Math.max(se.lng,S.lng)),this},pad:function(a){var p=this._southWest,S=this._northEast,V=Math.abs(p.lat-S.lat)*a,se=Math.abs(p.lng-S.lng)*a;return new H(new ue(p.lat-V,p.lng-se),new ue(S.lat+V,S.lng+se))},getCenter:function(){return new ue((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ue(this.getNorth(),this.getWest())},getSouthEast:function(){return new ue(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){typeof a[0]=="number"||a instanceof ue||"lat"in a?a=le(a):a=Q(a);var p=this._southWest,S=this._northEast,V,se;return a instanceof H?(V=a.getSouthWest(),se=a.getNorthEast()):V=se=a,V.lat>=p.lat&&se.lat<=S.lat&&V.lng>=p.lng&&se.lng<=S.lng},intersects:function(a){a=Q(a);var p=this._southWest,S=this._northEast,V=a.getSouthWest(),se=a.getNorthEast(),Se=se.lat>=p.lat&&V.lat<=S.lat,st=se.lng>=p.lng&&V.lng<=S.lng;return Se&&st},overlaps:function(a){a=Q(a);var p=this._southWest,S=this._northEast,V=a.getSouthWest(),se=a.getNorthEast(),Se=se.lat>p.lat&&V.lat<S.lat,st=se.lng>p.lng&&V.lng<S.lng;return Se&&st},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(a,p){return a?(a=Q(a),this._southWest.equals(a.getSouthWest(),p)&&this._northEast.equals(a.getNorthEast(),p)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Q(a,p){return a instanceof H?a:new H(a,p)}function ue(a,p,S){if(isNaN(a)||isNaN(p))throw new Error("Invalid LatLng object: ("+a+", "+p+")");this.lat=+a,this.lng=+p,S!==void 0&&(this.alt=+S)}ue.prototype={equals:function(a,p){if(!a)return!1;a=le(a);var S=Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng));return S<=(p===void 0?1e-9:p)},toString:function(a){return"LatLng("+w(this.lat,a)+", "+w(this.lng,a)+")"},distanceTo:function(a){return Z.distance(this,le(a))},wrap:function(){return Z.wrapLatLng(this)},toBounds:function(a){var p=180*a/40075017,S=p/Math.cos(Math.PI/180*this.lat);return Q([this.lat-p,this.lng-S],[this.lat+p,this.lng+S])},clone:function(){return new ue(this.lat,this.lng,this.alt)}};function le(a,p,S){return a instanceof ue?a:K(a)&&typeof a[0]!="object"?a.length===3?new ue(a[0],a[1],a[2]):a.length===2?new ue(a[0],a[1]):null:a==null?a:typeof a=="object"&&"lat"in a?new ue(a.lat,"lng"in a?a.lng:a.lon,a.alt):p===void 0?null:new ue(a,p,S)}var pe={latLngToPoint:function(a,p){var S=this.projection.project(a),V=this.scale(p);return this.transformation._transform(S,V)},pointToLatLng:function(a,p){var S=this.scale(p),V=this.transformation.untransform(a,S);return this.projection.unproject(V)},project:function(a){return this.projection.project(a)},unproject:function(a){return this.projection.unproject(a)},scale:function(a){return 256*Math.pow(2,a)},zoom:function(a){return Math.log(a/256)/Math.LN2},getProjectedBounds:function(a){if(this.infinite)return null;var p=this.projection.bounds,S=this.scale(a),V=this.transformation.transform(p.min,S),se=this.transformation.transform(p.max,S);return new Te(V,se)},infinite:!1,wrapLatLng:function(a){var p=this.wrapLng?m(a.lng,this.wrapLng,!0):a.lng,S=this.wrapLat?m(a.lat,this.wrapLat,!0):a.lat,V=a.alt;return new ue(S,p,V)},wrapLatLngBounds:function(a){var p=a.getCenter(),S=this.wrapLatLng(p),V=p.lat-S.lat,se=p.lng-S.lng;if(V===0&&se===0)return a;var Se=a.getSouthWest(),st=a.getNorthEast(),At=new ue(Se.lat-V,Se.lng-se),Vt=new ue(st.lat-V,st.lng-se);return new H(At,Vt)}},Z=i({},pe,{wrapLng:[-180,180],R:6371e3,distance:function(a,p){var S=Math.PI/180,V=a.lat*S,se=p.lat*S,Se=Math.sin((p.lat-a.lat)*S/2),st=Math.sin((p.lng-a.lng)*S/2),At=Se*Se+Math.cos(V)*Math.cos(se)*st*st,Vt=2*Math.atan2(Math.sqrt(At),Math.sqrt(1-At));return this.R*Vt}}),N=6378137,ke={R:N,MAX_LATITUDE:85.0511287798,project:function(a){var p=Math.PI/180,S=this.MAX_LATITUDE,V=Math.max(Math.min(S,a.lat),-S),se=Math.sin(V*p);return new ie(this.R*a.lng*p,this.R*Math.log((1+se)/(1-se))/2)},unproject:function(a){var p=180/Math.PI;return new ue((2*Math.atan(Math.exp(a.y/this.R))-Math.PI/2)*p,a.x*p/this.R)},bounds:function(){var a=N*Math.PI;return new Te([-a,-a],[a,a])}()};function Me(a,p,S,V){if(K(a)){this._a=a[0],this._b=a[1],this._c=a[2],this._d=a[3];return}this._a=a,this._b=p,this._c=S,this._d=V}Me.prototype={transform:function(a,p){return this._transform(a.clone(),p)},_transform:function(a,p){return p=p||1,a.x=p*(this._a*a.x+this._b),a.y=p*(this._c*a.y+this._d),a},untransform:function(a,p){return p=p||1,new ie((a.x/p-this._b)/this._a,(a.y/p-this._d)/this._c)}};function Ue(a,p,S,V){return new Me(a,p,S,V)}var ce=i({},Z,{code:"EPSG:3857",projection:ke,transformation:function(){var a=.5/(Math.PI*ke.R);return Ue(a,.5,-a,.5)}()}),ne=i({},ce,{code:"EPSG:900913"});function ye(a){return document.createElementNS("http://www.w3.org/2000/svg",a)}function de(a,p){var S="",V,se,Se,st,At,Vt;for(V=0,Se=a.length;V<Se;V++){for(At=a[V],se=0,st=At.length;se<st;se++)Vt=At[se],S+=(se?"L":"M")+Vt.x+" "+Vt.y;S+=p?mt.svg?"z":"x":""}return S||"M0 0"}var We=document.documentElement.style,Ge="ActiveXObject"in window,tt=Ge&&!document.addEventListener,Ze="msLaunchUri"in navigator&&!("documentMode"in document),et=St("webkit"),He=St("android"),wt=St("android 2")||St("android 3"),Pt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),kt=He&&St("Google")&&Pt<537&&!("AudioNode"in window),Jt=!!window.opera,rn=!Ze&&St("chrome"),un=St("gecko")&&!et&&!Jt&&!Ge,Ke=!rn&&St("safari"),ot=St("phantom"),rt="OTransition"in We,Ft=navigator.platform.indexOf("Win")===0,Qt=Ge&&"transition"in We,Bn="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!wt,Ln="MozPerspective"in We,Nn=!window.L_DISABLE_3D&&(Qt||Bn||Ln)&&!rt&&!ot,ar=typeof orientation<"u"||St("mobile"),En=ar&&et,jn=ar&&Bn,Mn=!window.PointerEvent&&window.MSPointerEvent,Yn=!!(window.PointerEvent||Mn),br="ontouchstart"in window||!!window.TouchEvent,Or=!window.L_NO_TOUCH&&(br||Yn),gr=ar&&Jt,ii=ar&&un,ft=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Qe=function(){var a=!1;try{var p=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("testPassiveEventSupport",_,p),window.removeEventListener("testPassiveEventSupport",_,p)}catch{}return a}(),$t=function(){return!!document.createElement("canvas").getContext}(),xn=!!(document.createElementNS&&ye("svg").createSVGRect),vn=!!xn&&function(){var a=document.createElement("div");return a.innerHTML="<svg/>",(a.firstChild&&a.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),bn=!xn&&function(){try{var a=document.createElement("div");a.innerHTML='<v:shape adj="1"/>';var p=a.firstChild;return p.style.behavior="url(#default#VML)",p&&typeof p.adj=="object"}catch{return!1}}(),Ht=navigator.platform.indexOf("Mac")===0,Hn=navigator.platform.indexOf("Linux")===0;function St(a){return navigator.userAgent.toLowerCase().indexOf(a)>=0}var mt={ie:Ge,ielt9:tt,edge:Ze,webkit:et,android:He,android23:wt,androidStock:kt,opera:Jt,chrome:rn,gecko:un,safari:Ke,phantom:ot,opera12:rt,win:Ft,ie3d:Qt,webkit3d:Bn,gecko3d:Ln,any3d:Nn,mobile:ar,mobileWebkit:En,mobileWebkit3d:jn,msPointer:Mn,pointer:Yn,touch:Or,touchNative:br,mobileOpera:gr,mobileGecko:ii,retina:ft,passiveEvents:Qe,canvas:$t,svg:xn,vml:bn,inlineSvg:vn,mac:Ht,linux:Hn},wn=mt.msPointer?"MSPointerDown":"pointerdown",Qr=mt.msPointer?"MSPointerMove":"pointermove",Tt=mt.msPointer?"MSPointerUp":"pointerup",Rn=mt.msPointer?"MSPointerCancel":"pointercancel",Qn={touchstart:wn,touchmove:Qr,touchend:Tt,touchcancel:Rn},Pi={touchstart:Oi,touchmove:zi,touchend:zi,touchcancel:zi},Sr={},Pr=!1;function dr(a,p,S){return p==="touchstart"&&tn(),Pi[p]?(S=Pi[p].bind(this,S),a.addEventListener(Qn[p],S,!1),S):(console.warn("wrong event specified:",p),_)}function Mi(a,p,S){if(!Qn[p]){console.warn("wrong event specified:",p);return}a.removeEventListener(Qn[p],S,!1)}function wr(a){Sr[a.pointerId]=a}function Gr(a){Sr[a.pointerId]&&(Sr[a.pointerId]=a)}function Ir(a){delete Sr[a.pointerId]}function tn(){Pr||(document.addEventListener(wn,wr,!0),document.addEventListener(Qr,Gr,!0),document.addEventListener(Tt,Ir,!0),document.addEventListener(Rn,Ir,!0),Pr=!0)}function zi(a,p){if(p.pointerType!==(p.MSPOINTER_TYPE_MOUSE||"mouse")){p.touches=[];for(var S in Sr)p.touches.push(Sr[S]);p.changedTouches=[p],a(p)}}function Oi(a,p){p.MSPOINTER_TYPE_TOUCH&&p.pointerType===p.MSPOINTER_TYPE_TOUCH&&Er(p),zi(a,p)}function Qi(a){var p={},S,V;for(V in a)S=a[V],p[V]=S&&S.bind?S.bind(a):S;return a=p,p.type="dblclick",p.detail=2,p.isTrusted=!1,p._simulated=!0,p}var ei=200;function Br(a,p){a.addEventListener("dblclick",p);var S=0,V;function se(Se){if(Se.detail!==1){V=Se.detail;return}if(!(Se.pointerType==="mouse"||Se.sourceCapabilities&&!Se.sourceCapabilities.firesTouchEvents)){var st=Va(Se);if(!(st.some(function(Vt){return Vt instanceof HTMLLabelElement&&Vt.attributes.for})&&!st.some(function(Vt){return Vt instanceof HTMLInputElement||Vt instanceof HTMLSelectElement}))){var At=Date.now();At-S<=ei?(V++,V===2&&p(Qi(Se))):V=1,S=At}}}return a.addEventListener("click",se),{dblclick:p,simDblclick:se}}function ui(a,p){a.removeEventListener("dblclick",p.dblclick),a.removeEventListener("click",p.simDblclick)}var mr=Cn(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Si=Cn(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ps=Si==="webkitTransition"||Si==="OTransition"?Si+"End":"transitionend";function va(a){return typeof a=="string"?document.getElementById(a):a}function Rr(a,p){var S=a.style[p]||a.currentStyle&&a.currentStyle[p];if((!S||S==="auto")&&document.defaultView){var V=document.defaultView.getComputedStyle(a,null);S=V?V[p]:null}return S==="auto"?null:S}function mn(a,p,S){var V=document.createElement(a);return V.className=p||"",S&&S.appendChild(V),V}function Zn(a){var p=a.parentNode;p&&p.removeChild(a)}function Ei(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function Bi(a){var p=a.parentNode;p&&p.lastChild!==a&&p.appendChild(a)}function Ri(a){var p=a.parentNode;p&&p.firstChild!==a&&p.insertBefore(a,p.firstChild)}function jo(a,p){if(a.classList!==void 0)return a.classList.contains(p);var S=oi(a);return S.length>0&&new RegExp("(^|\\s)"+p+"(\\s|$)").test(S)}function cr(a,p){if(a.classList!==void 0)for(var S=M(p),V=0,se=S.length;V<se;V++)a.classList.add(S[V]);else if(!jo(a,p)){var Se=oi(a);Ms(a,(Se?Se+" ":"")+p)}}function Vn(a,p){a.classList!==void 0?a.classList.remove(p):Ms(a,y((" "+oi(a)+" ").replace(" "+p+" "," ")))}function Ms(a,p){a.className.baseVal===void 0?a.className=p:a.className.baseVal=p}function oi(a){return a.correspondingElement&&(a=a.correspondingElement),a.className.baseVal===void 0?a.className:a.className.baseVal}function Ai(a,p){"opacity"in a.style?a.style.opacity=p:"filter"in a.style&&ci(a,p)}function ci(a,p){var S=!1,V="DXImageTransform.Microsoft.Alpha";try{S=a.filters.item(V)}catch{if(p===1)return}p=Math.round(p*100),S?(S.Enabled=p!==100,S.Opacity=p):a.style.filter+=" progid:"+V+"(opacity="+p+")"}function Cn(a){for(var p=document.documentElement.style,S=0;S<a.length;S++)if(a[S]in p)return a[S];return!1}function cn(a,p,S){var V=p||new ie(0,0);a.style[mr]=(mt.ie3d?"translate("+V.x+"px,"+V.y+"px)":"translate3d("+V.x+"px,"+V.y+"px,0)")+(S?" scale("+S+")":"")}function fr(a,p){a._leaflet_pos=p,mt.any3d?cn(a,p):(a.style.left=p.x+"px",a.style.top=p.y+"px")}function eo(a){return a._leaflet_pos||new ie(0,0)}var Ao,_o,za;if("onselectstart"in document)Ao=function(){yr(window,"selectstart",Er)},_o=function(){zr(window,"selectstart",Er)};else{var Qo=Cn(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Ao=function(){if(Qo){var a=document.documentElement.style;za=a[Qo],a[Qo]="none"}},_o=function(){Qo&&(document.documentElement.style[Qo]=za,za=void 0)}}function il(){yr(window,"dragstart",Er)}function jr(){zr(window,"dragstart",Er)}var As,lo;function es(a){for(;a.tabIndex===-1;)a=a.parentNode;a.style&&(Fi(),As=a,lo=a.style.outlineStyle,a.style.outlineStyle="none",yr(window,"keydown",Fi))}function Fi(){As&&(As.style.outlineStyle=lo,As=void 0,lo=void 0,zr(window,"keydown",Fi))}function Pl(a){do a=a.parentNode;while((!a.offsetWidth||!a.offsetHeight)&&a!==document.body);return a}function $a(a){var p=a.getBoundingClientRect();return{x:p.width/a.offsetWidth||1,y:p.height/a.offsetHeight||1,boundingClientRect:p}}var vr={__proto__:null,TRANSFORM:mr,TRANSITION:Si,TRANSITION_END:ps,get:va,getStyle:Rr,create:mn,remove:Zn,empty:Ei,toFront:Bi,toBack:Ri,hasClass:jo,addClass:cr,removeClass:Vn,setClass:Ms,getClass:oi,setOpacity:Ai,testProp:Cn,setTransform:cn,setPosition:fr,getPosition:eo,get disableTextSelection(){return Ao},get enableTextSelection(){return _o},disableImageDrag:il,enableImageDrag:jr,preventOutline:es,restoreOutline:Fi,getSizedParentNode:Pl,getScale:$a};function yr(a,p,S,V){if(p&&typeof p=="object")for(var se in p)ns(a,se,p[se],S);else{p=M(p);for(var Se=0,st=p.length;Se<st;Se++)ns(a,p[Se],S,V)}return this}var ts="_leaflet_events";function zr(a,p,S,V){if(arguments.length===1)Ml(a),delete a[ts];else if(p&&typeof p=="object")for(var se in p)to(a,se,p[se],S);else if(p=M(p),arguments.length===2)Ml(a,function(At){return ee(p,At)!==-1});else for(var Se=0,st=p.length;Se<st;Se++)to(a,p[Se],S,V);return this}function Ml(a,p){for(var S in a[ts]){var V=S.split(/\d/)[0];(!p||p(V))&&to(a,V,null,null,S)}}var fi={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function ns(a,p,S,V){var se=p+f(S)+(V?"_"+f(V):"");if(a[ts]&&a[ts][se])return this;var Se=function(At){return S.call(V||a,At||window.event)},st=Se;!mt.touchNative&&mt.pointer&&p.indexOf("touch")===0?Se=dr(a,p,Se):mt.touch&&p==="dblclick"?Se=Br(a,Se):"addEventListener"in a?p==="touchstart"||p==="touchmove"||p==="wheel"||p==="mousewheel"?a.addEventListener(fi[p]||p,Se,mt.passiveEvents?{passive:!1}:!1):p==="mouseenter"||p==="mouseleave"?(Se=function(At){At=At||window.event,ol(a,At)&&st(At)},a.addEventListener(fi[p],Se,!1)):a.addEventListener(p,st,!1):a.attachEvent("on"+p,Se),a[ts]=a[ts]||{},a[ts][se]=Se}function to(a,p,S,V,se){se=se||p+f(S)+(V?"_"+f(V):"");var Se=a[ts]&&a[ts][se];if(!Se)return this;!mt.touchNative&&mt.pointer&&p.indexOf("touch")===0?Mi(a,p,Se):mt.touch&&p==="dblclick"?ui(a,Se):"removeEventListener"in a?a.removeEventListener(fi[p]||p,Se,!1):a.detachEvent("on"+p,Se),a[ts][se]=null}function Ua(a){return a.stopPropagation?a.stopPropagation():a.originalEvent?a.originalEvent._stopped=!0:a.cancelBubble=!0,this}function wu(a){return ns(a,"wheel",Ua),this}function Al(a){return yr(a,"mousedown touchstart dblclick contextmenu",Ua),a._leaflet_disable_click=!0,this}function Er(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this}function Hr(a){return Er(a),Ua(a),this}function Va(a){if(a.composedPath)return a.composedPath();for(var p=[],S=a.target;S;)p.push(S),S=S.parentNode;return p}function Yu(a,p){if(!p)return new ie(a.clientX,a.clientY);var S=$a(p),V=S.boundingClientRect;return new ie((a.clientX-V.left)/S.x-p.clientLeft,(a.clientY-V.top)/S.y-p.clientTop)}var kl=mt.linux&&mt.chrome?window.devicePixelRatio:mt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Jl(a){return mt.edge?a.wheelDeltaY/2:a.deltaY&&a.deltaMode===0?-a.deltaY/kl:a.deltaY&&a.deltaMode===1?-a.deltaY*20:a.deltaY&&a.deltaMode===2?-a.deltaY*60:a.deltaX||a.deltaZ?0:a.wheelDelta?(a.wheelDeltaY||a.wheelDelta)/2:a.detail&&Math.abs(a.detail)<32765?-a.detail*20:a.detail?a.detail/-32765*60:0}function ol(a,p){var S=p.relatedTarget;if(!S)return!0;try{for(;S&&S!==a;)S=S.parentNode}catch{return!1}return S!==a}var Tl={__proto__:null,on:yr,off:zr,stopPropagation:Ua,disableScrollPropagation:wu,disableClickPropagation:Al,preventDefault:Er,stop:Hr,getPropagationPath:Va,getMousePosition:Yu,getWheelDelta:Jl,isExternalTarget:ol,addListener:yr,removeListener:zr},Xl=oe.extend({run:function(a,p,S,V){this.stop(),this._el=a,this._inProgress=!0,this._duration=S||.25,this._easeOutPower=1/Math.max(V||.5,.2),this._startPos=eo(a),this._offset=p.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=T(this._animate,this),this._step()},_step:function(a){var p=+new Date-this._startTime,S=this._duration*1e3;p<S?this._runFrame(this._easeOut(p/S),a):(this._runFrame(1),this._complete())},_runFrame:function(a,p){var S=this._startPos.add(this._offset.multiplyBy(a));p&&S._round(),fr(this._el,S),this.fire("step")},_complete:function(){D(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}}),Zr=oe.extend({options:{crs:ce,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(a,p){p=k(this,p),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(a),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),p.maxBounds&&this.setMaxBounds(p.maxBounds),p.zoom!==void 0&&(this._zoom=this._limitZoom(p.zoom)),p.center&&p.zoom!==void 0&&this.setView(le(p.center),p.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Si&&mt.any3d&&!mt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),yr(this._proxy,ps,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(a,p,S){if(p=p===void 0?this._zoom:this._limitZoom(p),a=this._limitCenter(le(a),p,this.options.maxBounds),S=S||{},this._stop(),this._loaded&&!S.reset&&S!==!0){S.animate!==void 0&&(S.zoom=i({animate:S.animate},S.zoom),S.pan=i({animate:S.animate,duration:S.duration},S.pan));var V=this._zoom!==p?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,p,S.zoom):this._tryAnimatedPan(a,S.pan);if(V)return clearTimeout(this._sizeTimer),this}return this._resetView(a,p,S.pan&&S.pan.noMoveStart),this},setZoom:function(a,p){return this._loaded?this.setView(this.getCenter(),a,{zoom:p}):(this._zoom=a,this)},zoomIn:function(a,p){return a=a||(mt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+a,p)},zoomOut:function(a,p){return a=a||(mt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-a,p)},setZoomAround:function(a,p,S){var V=this.getZoomScale(p),se=this.getSize().divideBy(2),Se=a instanceof ie?a:this.latLngToContainerPoint(a),st=Se.subtract(se).multiplyBy(1-1/V),At=this.containerPointToLatLng(se.add(st));return this.setView(At,p,{zoom:S})},_getBoundsCenterZoom:function(a,p){p=p||{},a=a.getBounds?a.getBounds():Q(a);var S=Ce(p.paddingTopLeft||p.padding||[0,0]),V=Ce(p.paddingBottomRight||p.padding||[0,0]),se=this.getBoundsZoom(a,!1,S.add(V));if(se=typeof p.maxZoom=="number"?Math.min(p.maxZoom,se):se,se===1/0)return{center:a.getCenter(),zoom:se};var Se=V.subtract(S).divideBy(2),st=this.project(a.getSouthWest(),se),At=this.project(a.getNorthEast(),se),Vt=this.unproject(st.add(At).divideBy(2).add(Se),se);return{center:Vt,zoom:se}},fitBounds:function(a,p){if(a=Q(a),!a.isValid())throw new Error("Bounds are not valid.");var S=this._getBoundsCenterZoom(a,p);return this.setView(S.center,S.zoom,p)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,p){return this.setView(a,this._zoom,{pan:p})},panBy:function(a,p){if(a=Ce(a).round(),p=p||{},!a.x&&!a.y)return this.fire("moveend");if(p.animate!==!0&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Xl,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),p.noMoveStart||this.fire("movestart"),p.animate!==!1){cr(this._mapPane,"leaflet-pan-anim");var S=this._getMapPanePos().subtract(a).round();this._panAnim.run(this._mapPane,S,p.duration||.25,p.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},flyTo:function(a,p,S){if(S=S||{},S.animate===!1||!mt.any3d)return this.setView(a,p,S);this._stop();var V=this.project(this.getCenter()),se=this.project(a),Se=this.getSize(),st=this._zoom;a=le(a),p=p===void 0?st:p;var At=Math.max(Se.x,Se.y),Vt=At*this.getZoomScale(st,p),sn=se.distanceTo(V)||1,In=1.42,er=In*In;function Fr(pi){var Wo=pi?-1:1,De=pi?Vt:At,_s=Vt*Vt-At*At+Wo*er*er*sn*sn,Su=2*De*er*sn,Bo=_s/Su,Vr=Math.sqrt(Bo*Bo+1)-Bo,Zc=Vr<1e-9?-18:Math.log(Vr);return Zc}function Lo(pi){return(Math.exp(pi)-Math.exp(-pi))/2}function io(pi){return(Math.exp(pi)+Math.exp(-pi))/2}function Oo(pi){return Lo(pi)/io(pi)}var Ki=Fr(0);function ys(pi){return At*(io(Ki)/io(Ki+In*pi))}function wc(pi){return At*(io(Ki)*Oo(Ki+In*pi)-Lo(Ki))/er}function ca(pi){return 1-Math.pow(1-pi,1.5)}var Ys=Date.now(),zs=(Fr(1)-Ki)/In,Tf=S.duration?1e3*S.duration:1e3*zs*.8;function tu(){var pi=(Date.now()-Ys)/Tf,Wo=ca(pi)*zs;pi<=1?(this._flyToFrame=T(tu,this),this._move(this.unproject(V.add(se.subtract(V).multiplyBy(wc(Wo)/sn)),st),this.getScaleZoom(At/ys(Wo),st),{flyTo:!0})):this._move(a,p)._moveEnd(!0)}return this._moveStart(!0,S.noMoveStart),tu.call(this),this},flyToBounds:function(a,p){var S=this._getBoundsCenterZoom(a,p);return this.flyTo(S.center,S.zoom,p)},setMaxBounds:function(a){return a=Q(a),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),a.isValid()?(this.options.maxBounds=a,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(a){var p=this.options.minZoom;return this.options.minZoom=a,this._loaded&&p!==a&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(a):this},setMaxZoom:function(a){var p=this.options.maxZoom;return this.options.maxZoom=a,this._loaded&&p!==a&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(a):this},panInsideBounds:function(a,p){this._enforcingBounds=!0;var S=this.getCenter(),V=this._limitCenter(S,this._zoom,Q(a));return S.equals(V)||this.panTo(V,p),this._enforcingBounds=!1,this},panInside:function(a,p){p=p||{};var S=Ce(p.paddingTopLeft||p.padding||[0,0]),V=Ce(p.paddingBottomRight||p.padding||[0,0]),se=this.project(this.getCenter()),Se=this.project(a),st=this.getPixelBounds(),At=Y([st.min.add(S),st.max.subtract(V)]),Vt=At.getSize();if(!At.contains(Se)){this._enforcingBounds=!0;var sn=Se.subtract(At.getCenter()),In=At.extend(Se).getSize().subtract(Vt);se.x+=sn.x<0?-In.x:In.x,se.y+=sn.y<0?-In.y:In.y,this.panTo(this.unproject(se),p),this._enforcingBounds=!1}return this},invalidateSize:function(a){if(!this._loaded)return this;a=i({animate:!1,pan:!0},a===!0?{animate:!0}:a);var p=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var S=this.getSize(),V=p.divideBy(2).round(),se=S.divideBy(2).round(),Se=V.subtract(se);return!Se.x&&!Se.y?this:(a.animate&&a.pan?this.panBy(Se):(a.pan&&this._rawPanBy(Se),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:p,newSize:S}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(a){if(a=this._locateOptions=i({timeout:1e4,watch:!1},a),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var p=o(this._handleGeolocationResponse,this),S=o(this._handleGeolocationError,this);return a.watch?this._locationWatchId=navigator.geolocation.watchPosition(p,S,a):navigator.geolocation.getCurrentPosition(p,S,a),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(a){if(this._container._leaflet_id){var p=a.code,S=a.message||(p===1?"permission denied":p===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:p,message:"Geolocation error: "+S+"."})}},_handleGeolocationResponse:function(a){if(this._container._leaflet_id){var p=a.coords.latitude,S=a.coords.longitude,V=new ue(p,S),se=V.toBounds(a.coords.accuracy*2),Se=this._locateOptions;if(Se.setView){var st=this.getBoundsZoom(se);this.setView(V,Se.maxZoom?Math.min(st,Se.maxZoom):st)}var At={latlng:V,bounds:se,timestamp:a.timestamp};for(var Vt in a.coords)typeof a.coords[Vt]=="number"&&(At[Vt]=a.coords[Vt]);this.fire("locationfound",At)}},addHandler:function(a,p){if(!p)return this;var S=this[a]=new p(this);return this._handlers.push(S),this.options[a]&&S.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Zn(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(D(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var a;for(a in this._layers)this._layers[a].remove();for(a in this._panes)Zn(this._panes[a]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(a,p){var S="leaflet-pane"+(a?" leaflet-"+a.replace("Pane","")+"-pane":""),V=mn("div",S,p||this._mapPane);return a&&(this._panes[a]=V),V},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),p=this.unproject(a.getBottomLeft()),S=this.unproject(a.getTopRight());return new H(p,S)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,p,S){a=Q(a),S=Ce(S||[0,0]);var V=this.getZoom()||0,se=this.getMinZoom(),Se=this.getMaxZoom(),st=a.getNorthWest(),At=a.getSouthEast(),Vt=this.getSize().subtract(S),sn=Y(this.project(At,V),this.project(st,V)).getSize(),In=mt.any3d?this.options.zoomSnap:1,er=Vt.x/sn.x,Fr=Vt.y/sn.y,Lo=p?Math.max(er,Fr):Math.min(er,Fr);return V=this.getScaleZoom(Lo,V),In&&(V=Math.round(V/(In/100))*(In/100),V=p?Math.ceil(V/In)*In:Math.floor(V/In)*In),Math.max(se,Math.min(Se,V))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new ie(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(a,p){var S=this._getTopLeftPoint(a,p);return new Te(S,S.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(a){return this.options.crs.getProjectedBounds(a===void 0?this.getZoom():a)},getPane:function(a){return typeof a=="string"?this._panes[a]:a},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a,p){var S=this.options.crs;return p=p===void 0?this._zoom:p,S.scale(a)/S.scale(p)},getScaleZoom:function(a,p){var S=this.options.crs;p=p===void 0?this._zoom:p;var V=S.zoom(a*S.scale(p));return isNaN(V)?1/0:V},project:function(a,p){return p=p===void 0?this._zoom:p,this.options.crs.latLngToPoint(le(a),p)},unproject:function(a,p){return p=p===void 0?this._zoom:p,this.options.crs.pointToLatLng(Ce(a),p)},layerPointToLatLng:function(a){var p=Ce(a).add(this.getPixelOrigin());return this.unproject(p)},latLngToLayerPoint:function(a){var p=this.project(le(a))._round();return p._subtract(this.getPixelOrigin())},wrapLatLng:function(a){return this.options.crs.wrapLatLng(le(a))},wrapLatLngBounds:function(a){return this.options.crs.wrapLatLngBounds(Q(a))},distance:function(a,p){return this.options.crs.distance(le(a),le(p))},containerPointToLayerPoint:function(a){return Ce(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return Ce(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){var p=this.containerPointToLayerPoint(Ce(a));return this.layerPointToLatLng(p)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(le(a)))},mouseEventToContainerPoint:function(a){return Yu(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){var p=this._container=va(a);if(p){if(p._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");yr(p,"scroll",this._onScroll,this),this._containerId=f(p)},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&mt.any3d,cr(a,"leaflet-container"+(mt.touch?" leaflet-touch":"")+(mt.retina?" leaflet-retina":"")+(mt.ielt9?" leaflet-oldie":"")+(mt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var p=Rr(a,"position");p!=="absolute"&&p!=="relative"&&p!=="fixed"&&p!=="sticky"&&(a.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),fr(this._mapPane,new ie(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(cr(a.markerPane,"leaflet-zoom-hide"),cr(a.shadowPane,"leaflet-zoom-hide"))},_resetView:function(a,p,S){fr(this._mapPane,new ie(0,0));var V=!this._loaded;this._loaded=!0,p=this._limitZoom(p),this.fire("viewprereset");var se=this._zoom!==p;this._moveStart(se,S)._move(a,p)._moveEnd(se),this.fire("viewreset"),V&&this.fire("load")},_moveStart:function(a,p){return a&&this.fire("zoomstart"),p||this.fire("movestart"),this},_move:function(a,p,S,V){p===void 0&&(p=this._zoom);var se=this._zoom!==p;return this._zoom=p,this._lastCenter=a,this._pixelOrigin=this._getNewPixelOrigin(a),V?S&&S.pinch&&this.fire("zoom",S):((se||S&&S.pinch)&&this.fire("zoom",S),this.fire("move",S)),this},_moveEnd:function(a){return a&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return D(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(a){fr(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(a){this._targets={},this._targets[f(this._container)]=this;var p=a?zr:yr;p(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&p(window,"resize",this._onResize,this),mt.any3d&&this.options.transform3DLimit&&(a?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){D(this._resizeRequest),this._resizeRequest=T(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var a=this._getMapPanePos();Math.max(Math.abs(a.x),Math.abs(a.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(a,p){for(var S=[],V,se=p==="mouseout"||p==="mouseover",Se=a.target||a.srcElement,st=!1;Se;){if(V=this._targets[f(Se)],V&&(p==="click"||p==="preclick")&&this._draggableMoved(V)){st=!0;break}if(V&&V.listens(p,!0)&&(se&&!ol(Se,a)||(S.push(V),se))||Se===this._container)break;Se=Se.parentNode}return!S.length&&!st&&!se&&this.listens(p,!0)&&(S=[this]),S},_isClickDisabled:function(a){for(;a&&a!==this._container;){if(a._leaflet_disable_click)return!0;a=a.parentNode}},_handleDOMEvent:function(a){var p=a.target||a.srcElement;if(!(!this._loaded||p._leaflet_disable_events||a.type==="click"&&this._isClickDisabled(p))){var S=a.type;S==="mousedown"&&es(p),this._fireDOMEvent(a,S)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(a,p,S){if(a.type==="click"){var V=i({},a);V.type="preclick",this._fireDOMEvent(V,V.type,S)}var se=this._findEventTargets(a,p);if(S){for(var Se=[],st=0;st<S.length;st++)S[st].listens(p,!0)&&Se.push(S[st]);se=Se.concat(se)}if(se.length){p==="contextmenu"&&Er(a);var At=se[0],Vt={originalEvent:a};if(a.type!=="keypress"&&a.type!=="keydown"&&a.type!=="keyup"){var sn=At.getLatLng&&(!At._radius||At._radius<=10);Vt.containerPoint=sn?this.latLngToContainerPoint(At.getLatLng()):this.mouseEventToContainerPoint(a),Vt.layerPoint=this.containerPointToLayerPoint(Vt.containerPoint),Vt.latlng=sn?At.getLatLng():this.layerPointToLatLng(Vt.layerPoint)}for(st=0;st<se.length;st++)if(se[st].fire(p,Vt,!0),Vt.originalEvent._stopped||se[st].options.bubblingMouseEvents===!1&&ee(this._mouseEvents,p)!==-1)return}},_draggableMoved:function(a){return a=a.dragging&&a.dragging.enabled()?a:this,a.dragging&&a.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var a=0,p=this._handlers.length;a<p;a++)this._handlers[a].disable()},whenReady:function(a,p){return this._loaded?a.call(p||this,{target:this}):this.on("load",a,p),this},_getMapPanePos:function(){return eo(this._mapPane)||new ie(0,0)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(a,p){var S=a&&p!==void 0?this._getNewPixelOrigin(a,p):this.getPixelOrigin();return S.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(a,p){var S=this.getSize()._divideBy(2);return this.project(a,p)._subtract(S)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(a,p,S){var V=this._getNewPixelOrigin(S,p);return this.project(a,p)._subtract(V)},_latLngBoundsToNewLayerBounds:function(a,p,S){var V=this._getNewPixelOrigin(S,p);return Y([this.project(a.getSouthWest(),p)._subtract(V),this.project(a.getNorthWest(),p)._subtract(V),this.project(a.getSouthEast(),p)._subtract(V),this.project(a.getNorthEast(),p)._subtract(V)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,p,S){if(!S)return a;var V=this.project(a,p),se=this.getSize().divideBy(2),Se=new Te(V.subtract(se),V.add(se)),st=this._getBoundsOffset(Se,S,p);return Math.abs(st.x)<=1&&Math.abs(st.y)<=1?a:this.unproject(V.add(st),p)},_limitOffset:function(a,p){if(!p)return a;var S=this.getPixelBounds(),V=new Te(S.min.add(a),S.max.add(a));return a.add(this._getBoundsOffset(V,p))},_getBoundsOffset:function(a,p,S){var V=Y(this.project(p.getNorthEast(),S),this.project(p.getSouthWest(),S)),se=V.min.subtract(a.min),Se=V.max.subtract(a.max),st=this._rebound(se.x,-Se.x),At=this._rebound(se.y,-Se.y);return new ie(st,At)},_rebound:function(a,p){return a+p>0?Math.round(a-p)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(p))},_limitZoom:function(a){var p=this.getMinZoom(),S=this.getMaxZoom(),V=mt.any3d?this.options.zoomSnap:1;return V&&(a=Math.round(a/V)*V),Math.max(p,Math.min(S,a))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Vn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(a,p){var S=this._getCenterOffset(a)._trunc();return(p&&p.animate)!==!0&&!this.getSize().contains(S)?!1:(this.panBy(S,p),!0)},_createAnimProxy:function(){var a=this._proxy=mn("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(a),this.on("zoomanim",function(p){var S=mr,V=this._proxy.style[S];cn(this._proxy,this.project(p.center,p.zoom),this.getZoomScale(p.zoom,1)),V===this._proxy.style[S]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Zn(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var a=this.getCenter(),p=this.getZoom();cn(this._proxy,this.project(a,p),this.getZoomScale(p,1))},_catchTransitionEnd:function(a){this._animatingZoom&&a.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(a,p,S){if(this._animatingZoom)return!0;if(S=S||{},!this._zoomAnimated||S.animate===!1||this._nothingToAnimate()||Math.abs(p-this._zoom)>this.options.zoomAnimationThreshold)return!1;var V=this.getZoomScale(p),se=this._getCenterOffset(a)._divideBy(1-1/V);return S.animate!==!0&&!this.getSize().contains(se)?!1:(T(function(){this._moveStart(!0,S.noMoveStart||!1)._animateZoom(a,p,!0)},this),!0)},_animateZoom:function(a,p,S,V){this._mapPane&&(S&&(this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=p,cr(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:a,zoom:p,noUpdate:V}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Vn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function uo(a,p){return new Zr(a,p)}var lr=$.extend({options:{position:"topright"},initialize:function(a){k(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var p=this._map;return p&&p.removeControl(this),this.options.position=a,p&&p.addControl(this),this},getContainer:function(){return this._container},addTo:function(a){this.remove(),this._map=a;var p=this._container=this.onAdd(a),S=this.getPosition(),V=a._controlCorners[S];return cr(p,"leaflet-control"),S.indexOf("bottom")!==-1?V.insertBefore(p,V.firstChild):V.appendChild(p),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Zn(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(a){this._map&&a&&a.screenX>0&&a.screenY>0&&this._map.getContainer().focus()}}),co=function(a){return new lr(a)};Zr.include({addControl:function(a){return a.addTo(this),this},removeControl:function(a){return a.remove(),this},_initControlPos:function(){var a=this._controlCorners={},p="leaflet-",S=this._controlContainer=mn("div",p+"control-container",this._container);function V(se,Se){var st=p+se+" "+p+Se;a[se+Se]=mn("div",st,S)}V("top","left"),V("top","right"),V("bottom","left"),V("bottom","right")},_clearControlPos:function(){for(var a in this._controlCorners)Zn(this._controlCorners[a]);Zn(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var sl=lr.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(a,p,S,V){return S<V?-1:V<S?1:0}},initialize:function(a,p,S){k(this,S),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var V in a)this._addLayer(a[V],V);for(V in p)this._addLayer(p[V],V,!0)},onAdd:function(a){this._initLayout(),this._update(),this._map=a,a.on("zoomend",this._checkDisabledLayers,this);for(var p=0;p<this._layers.length;p++)this._layers[p].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(a){return lr.prototype.addTo.call(this,a),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(a,p){return this._addLayer(a,p),this._map?this._update():this},addOverlay:function(a,p){return this._addLayer(a,p,!0),this._map?this._update():this},removeLayer:function(a){a.off("add remove",this._onLayerChange,this);var p=this._getLayer(f(a));return p&&this._layers.splice(this._layers.indexOf(p),1),this._map?this._update():this},expand:function(){cr(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var a=this._map.getSize().y-(this._container.offsetTop+50);return a<this._section.clientHeight?(cr(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=a+"px"):Vn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Vn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var a="leaflet-control-layers",p=this._container=mn("div",a),S=this.options.collapsed;p.setAttribute("aria-haspopup",!0),Al(p),wu(p);var V=this._section=mn("section",a+"-list");S&&(this._map.on("click",this.collapse,this),yr(p,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var se=this._layersLink=mn("a",a+"-toggle",p);se.href="#",se.title="Layers",se.setAttribute("role","button"),yr(se,{keydown:function(Se){Se.keyCode===13&&this._expandSafely()},click:function(Se){Er(Se),this._expandSafely()}},this),S||this.expand(),this._baseLayersList=mn("div",a+"-base",V),this._separator=mn("div",a+"-separator",V),this._overlaysList=mn("div",a+"-overlays",V),p.appendChild(V)},_getLayer:function(a){for(var p=0;p<this._layers.length;p++)if(this._layers[p]&&f(this._layers[p].layer)===a)return this._layers[p]},_addLayer:function(a,p,S){this._map&&a.on("add remove",this._onLayerChange,this),this._layers.push({layer:a,name:p,overlay:S}),this.options.sortLayers&&this._layers.sort(o(function(V,se){return this.options.sortFunction(V.layer,se.layer,V.name,se.name)},this)),this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Ei(this._baseLayersList),Ei(this._overlaysList),this._layerControlInputs=[];var a,p,S,V,se=0;for(S=0;S<this._layers.length;S++)V=this._layers[S],this._addItem(V),p=p||V.overlay,a=a||!V.overlay,se+=V.overlay?0:1;return this.options.hideSingleBase&&(a=a&&se>1,this._baseLayersList.style.display=a?"":"none"),this._separator.style.display=p&&a?"":"none",this},_onLayerChange:function(a){this._handlingClick||this._update();var p=this._getLayer(f(a.target)),S=p.overlay?a.type==="add"?"overlayadd":"overlayremove":a.type==="add"?"baselayerchange":null;S&&this._map.fire(S,p)},_createRadioElement:function(a,p){var S='<input type="radio" class="leaflet-control-layers-selector" name="'+a+'"'+(p?' checked="checked"':"")+"/>",V=document.createElement("div");return V.innerHTML=S,V.firstChild},_addItem:function(a){var p=document.createElement("label"),S=this._map.hasLayer(a.layer),V;a.overlay?(V=document.createElement("input"),V.type="checkbox",V.className="leaflet-control-layers-selector",V.defaultChecked=S):V=this._createRadioElement("leaflet-base-layers_"+f(this),S),this._layerControlInputs.push(V),V.layerId=f(a.layer),yr(V,"click",this._onInputClick,this);var se=document.createElement("span");se.innerHTML=" "+a.name;var Se=document.createElement("span");p.appendChild(Se),Se.appendChild(V),Se.appendChild(se);var st=a.overlay?this._overlaysList:this._baseLayersList;return st.appendChild(p),this._checkDisabledLayers(),p},_onInputClick:function(){if(!this._preventClick){var a=this._layerControlInputs,p,S,V=[],se=[];this._handlingClick=!0;for(var Se=a.length-1;Se>=0;Se--)p=a[Se],S=this._getLayer(p.layerId).layer,p.checked?V.push(S):p.checked||se.push(S);for(Se=0;Se<se.length;Se++)this._map.hasLayer(se[Se])&&this._map.removeLayer(se[Se]);for(Se=0;Se<V.length;Se++)this._map.hasLayer(V[Se])||this._map.addLayer(V[Se]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var a=this._layerControlInputs,p,S,V=this._map.getZoom(),se=a.length-1;se>=0;se--)p=a[se],S=this._getLayer(p.layerId).layer,p.disabled=S.options.minZoom!==void 0&&V<S.options.minZoom||S.options.maxZoom!==void 0&&V>S.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var a=this._section;this._preventClick=!0,yr(a,"click",Er),this.expand();var p=this;setTimeout(function(){zr(a,"click",Er),p._preventClick=!1})}}),ya=function(a,p,S){return new sl(a,p,S)},qi=lr.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(a){var p="leaflet-control-zoom",S=mn("div",p+" leaflet-bar"),V=this.options;return this._zoomInButton=this._createButton(V.zoomInText,V.zoomInTitle,p+"-in",S,this._zoomIn),this._zoomOutButton=this._createButton(V.zoomOutText,V.zoomOutTitle,p+"-out",S,this._zoomOut),this._updateDisabled(),a.on("zoomend zoomlevelschange",this._updateDisabled,this),S},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(a){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(a.shiftKey?3:1))},_zoomOut:function(a){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(a.shiftKey?3:1))},_createButton:function(a,p,S,V,se){var Se=mn("a",S,V);return Se.innerHTML=a,Se.href="#",Se.title=p,Se.setAttribute("role","button"),Se.setAttribute("aria-label",p),Al(Se),yr(Se,"click",Hr),yr(Se,"click",se,this),yr(Se,"click",this._refocusOnMap,this),Se},_updateDisabled:function(){var a=this._map,p="leaflet-disabled";Vn(this._zoomInButton,p),Vn(this._zoomOutButton,p),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||a._zoom===a.getMinZoom())&&(cr(this._zoomOutButton,p),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||a._zoom===a.getMaxZoom())&&(cr(this._zoomInButton,p),this._zoomInButton.setAttribute("aria-disabled","true"))}});Zr.mergeOptions({zoomControl:!0}),Zr.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new qi,this.addControl(this.zoomControl))});var Ql=function(a){return new qi(a)},ta=lr.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(a){var p="leaflet-control-scale",S=mn("div",p),V=this.options;return this._addScales(V,p+"-line",S),a.on(V.updateWhenIdle?"moveend":"move",this._update,this),a.whenReady(this._update,this),S},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,p,S){a.metric&&(this._mScale=mn("div",p,S)),a.imperial&&(this._iScale=mn("div",p,S))},_update:function(){var a=this._map,p=a.getSize().y/2,S=a.distance(a.containerPointToLatLng([0,p]),a.containerPointToLatLng([this.options.maxWidth,p]));this._updateScales(S)},_updateScales:function(a){this.options.metric&&a&&this._updateMetric(a),this.options.imperial&&a&&this._updateImperial(a)},_updateMetric:function(a){var p=this._getRoundNum(a),S=p<1e3?p+" m":p/1e3+" km";this._updateScale(this._mScale,S,p/a)},_updateImperial:function(a){var p=a*3.2808399,S,V,se;p>5280?(S=p/5280,V=this._getRoundNum(S),this._updateScale(this._iScale,V+" mi",V/S)):(se=this._getRoundNum(p),this._updateScale(this._iScale,se+" ft",se/p))},_updateScale:function(a,p,S){a.style.width=Math.round(this.options.maxWidth*S)+"px",a.innerHTML=p},_getRoundNum:function(a){var p=Math.pow(10,(Math.floor(a)+"").length-1),S=a/p;return S=S>=10?10:S>=5?5:S>=3?3:S>=2?2:1,p*S}}),Nl=function(a){return new ta(a)},Dl='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Fs=lr.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(mt.inlineSvg?Dl+" ":"")+"Leaflet</a>"},initialize:function(a){k(this,a),this._attributions={}},onAdd:function(a){a.attributionControl=this,this._container=mn("div","leaflet-control-attribution"),Al(this._container);for(var p in a._layers)a._layers[p].getAttribution&&this.addAttribution(a._layers[p].getAttribution());return this._update(),a.on("layeradd",this._addAttribution,this),this._container},onRemove:function(a){a.off("layeradd",this._addAttribution,this)},_addAttribution:function(a){a.layer.getAttribution&&(this.addAttribution(a.layer.getAttribution()),a.layer.once("remove",function(){this.removeAttribution(a.layer.getAttribution())},this))},setPrefix:function(a){return this.options.prefix=a,this._update(),this},addAttribution:function(a){return a?(this._attributions[a]||(this._attributions[a]=0),this._attributions[a]++,this._update(),this):this},removeAttribution:function(a){return a?(this._attributions[a]&&(this._attributions[a]--,this._update()),this):this},_update:function(){if(this._map){var a=[];for(var p in this._attributions)this._attributions[p]&&a.push(p);var S=[];this.options.prefix&&S.push(this.options.prefix),a.length&&S.push(a.join(", ")),this._container.innerHTML=S.join(' <span aria-hidden="true">|</span> ')}}});Zr.mergeOptions({attributionControl:!0}),Zr.addInitHook(function(){this.options.attributionControl&&new Fs().addTo(this)});var Il=function(a){return new Fs(a)};lr.Layers=sl,lr.Zoom=qi,lr.Scale=ta,lr.Attribution=Fs,co.layers=ya,co.zoom=Ql,co.scale=Nl,co.attribution=Il;var vi=$.extend({initialize:function(a){this._map=a},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});vi.addTo=function(a,p){return a.addHandler(p,this),this};var Ju={Events:G},ko=mt.touch?"touchstart mousedown":"mousedown",Hs=oe.extend({options:{clickTolerance:3},initialize:function(a,p,S,V){k(this,V),this._element=a,this._dragStartTarget=p||a,this._preventOutline=S},enable:function(){this._enabled||(yr(this._dragStartTarget,ko,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Hs._dragging===this&&this.finishDrag(!0),zr(this._dragStartTarget,ko,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(a){if(this._enabled&&(this._moved=!1,!jo(this._element,"leaflet-zoom-anim"))){if(a.touches&&a.touches.length!==1){Hs._dragging===this&&this.finishDrag();return}if(!(Hs._dragging||a.shiftKey||a.which!==1&&a.button!==1&&!a.touches)&&(Hs._dragging=this,this._preventOutline&&es(this._element),il(),Ao(),!this._moving)){this.fire("down");var p=a.touches?a.touches[0]:a,S=Pl(this._element);this._startPoint=new ie(p.clientX,p.clientY),this._startPos=eo(this._element),this._parentScale=$a(S);var V=a.type==="mousedown";yr(document,V?"mousemove":"touchmove",this._onMove,this),yr(document,V?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(a){if(this._enabled){if(a.touches&&a.touches.length>1){this._moved=!0;return}var p=a.touches&&a.touches.length===1?a.touches[0]:a,S=new ie(p.clientX,p.clientY)._subtract(this._startPoint);!S.x&&!S.y||Math.abs(S.x)+Math.abs(S.y)<this.options.clickTolerance||(S.x/=this._parentScale.x,S.y/=this._parentScale.y,Er(a),this._moved||(this.fire("dragstart"),this._moved=!0,cr(document.body,"leaflet-dragging"),this._lastTarget=a.target||a.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),cr(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(S),this._moving=!0,this._lastEvent=a,this._updatePosition())}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a),fr(this._element,this._newPos),this.fire("drag",a)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(a){Vn(document.body,"leaflet-dragging"),this._lastTarget&&(Vn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),zr(document,"mousemove touchmove",this._onMove,this),zr(document,"mouseup touchend touchcancel",this._onUp,this),jr(),_o();var p=this._moved&&this._moving;this._moving=!1,Hs._dragging=!1,p&&this.fire("dragend",{noInertia:a,distance:this._newPos.distanceTo(this._startPos)})}});function Ol(a,p,S){var V,se=[1,4,2,8],Se,st,At,Vt,sn,In,er,Fr;for(Se=0,In=a.length;Se<In;Se++)a[Se]._code=Ut(a[Se],p);for(At=0;At<4;At++){for(er=se[At],V=[],Se=0,In=a.length,st=In-1;Se<In;st=Se++)Vt=a[Se],sn=a[st],Vt._code&er?sn._code&er||(Fr=Lt(sn,Vt,er,p,S),Fr._code=Ut(Fr,p),V.push(Fr)):(sn._code&er&&(Fr=Lt(sn,Vt,er,p,S),Fr._code=Ut(Fr,p),V.push(Fr)),V.push(Vt));a=V}return a}function qs(a,p){var S,V,se,Se,st,At,Vt,sn,In;if(!a||a.length===0)throw new Error("latlngs not passed");zn(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var er=le([0,0]),Fr=Q(a),Lo=Fr.getNorthWest().distanceTo(Fr.getSouthWest())*Fr.getNorthEast().distanceTo(Fr.getNorthWest());Lo<1700&&(er=al(a));var io=a.length,Oo=[];for(S=0;S<io;S++){var Ki=le(a[S]);Oo.push(p.project(le([Ki.lat-er.lat,Ki.lng-er.lng])))}for(At=Vt=sn=0,S=0,V=io-1;S<io;V=S++)se=Oo[S],Se=Oo[V],st=se.y*Se.x-Se.y*se.x,Vt+=(se.x+Se.x)*st,sn+=(se.y+Se.y)*st,At+=st*3;At===0?In=Oo[0]:In=[Vt/At,sn/At];var ys=p.unproject(Ce(In));return le([ys.lat+er.lat,ys.lng+er.lng])}function al(a){for(var p=0,S=0,V=0,se=0;se<a.length;se++){var Se=le(a[se]);p+=Se.lat,S+=Se.lng,V++}return le([p/V,S/V])}var ll={__proto__:null,clipPolygon:Ol,polygonCenter:qs,centroid:al};function yi(a,p){if(!p||!a.length)return a.slice();var S=p*p;return a=_e(a,S),a=fo(a,S),a}function ks(a,p,S){return Math.sqrt(Dn(a,p,S,!0))}function _a(a,p,S){return Dn(a,p,S)}function fo(a,p){var S=a.length,V=typeof Uint8Array<"u"?Uint8Array:Array,se=new V(S);se[0]=se[S-1]=1,O(a,se,p,0,S-1);var Se,st=[];for(Se=0;Se<S;Se++)se[Se]&&st.push(a[Se]);return st}function O(a,p,S,V,se){var Se=0,st,At,Vt;for(At=V+1;At<=se-1;At++)Vt=Dn(a[At],a[V],a[se],!0),Vt>Se&&(st=At,Se=Vt);Se>S&&(p[st]=1,O(a,p,S,V,st),O(a,p,S,st,se))}function _e(a,p){for(var S=[a[0]],V=1,se=0,Se=a.length;V<Se;V++)fn(a[V],a[se])>p&&(S.push(a[V]),se=V);return se<Se-1&&S.push(a[Se-1]),S}var Ye;function ut(a,p,S,V,se){var Se=V?Ye:Ut(a,S),st=Ut(p,S),At,Vt,sn;for(Ye=st;;){if(!(Se|st))return[a,p];if(Se&st)return!1;At=Se||st,Vt=Lt(a,p,At,S,se),sn=Ut(Vt,S),At===Se?(a=Vt,Se=sn):(p=Vt,st=sn)}}function Lt(a,p,S,V,se){var Se=p.x-a.x,st=p.y-a.y,At=V.min,Vt=V.max,sn,In;return S&8?(sn=a.x+Se*(Vt.y-a.y)/st,In=Vt.y):S&4?(sn=a.x+Se*(At.y-a.y)/st,In=At.y):S&2?(sn=Vt.x,In=a.y+st*(Vt.x-a.x)/Se):S&1&&(sn=At.x,In=a.y+st*(At.x-a.x)/Se),new ie(sn,In,se)}function Ut(a,p){var S=0;return a.x<p.min.x?S|=1:a.x>p.max.x&&(S|=2),a.y<p.min.y?S|=4:a.y>p.max.y&&(S|=8),S}function fn(a,p){var S=p.x-a.x,V=p.y-a.y;return S*S+V*V}function Dn(a,p,S,V){var se=p.x,Se=p.y,st=S.x-se,At=S.y-Se,Vt=st*st+At*At,sn;return Vt>0&&(sn=((a.x-se)*st+(a.y-Se)*At)/Vt,sn>1?(se=S.x,Se=S.y):sn>0&&(se+=st*sn,Se+=At*sn)),st=a.x-se,At=a.y-Se,V?st*st+At*At:new ie(se,Se)}function zn(a){return!K(a[0])||typeof a[0][0]!="object"&&typeof a[0][0]<"u"}function ir(a){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),zn(a)}function _r(a,p){var S,V,se,Se,st,At,Vt,sn;if(!a||a.length===0)throw new Error("latlngs not passed");zn(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var In=le([0,0]),er=Q(a),Fr=er.getNorthWest().distanceTo(er.getSouthWest())*er.getNorthEast().distanceTo(er.getNorthWest());Fr<1700&&(In=al(a));var Lo=a.length,io=[];for(S=0;S<Lo;S++){var Oo=le(a[S]);io.push(p.project(le([Oo.lat-In.lat,Oo.lng-In.lng])))}for(S=0,V=0;S<Lo-1;S++)V+=io[S].distanceTo(io[S+1])/2;if(V===0)sn=io[0];else for(S=0,Se=0;S<Lo-1;S++)if(st=io[S],At=io[S+1],se=st.distanceTo(At),Se+=se,Se>V){Vt=(Se-V)/se,sn=[At.x-Vt*(At.x-st.x),At.y-Vt*(At.y-st.y)];break}var Ki=p.unproject(Ce(sn));return le([Ki.lat+In.lat,Ki.lng+In.lng])}var $r={__proto__:null,simplify:yi,pointToSegmentDistance:ks,closestPointOnSegment:_a,clipSegment:ut,_getEdgeIntersection:Lt,_getBitCode:Ut,_sqClosestPointOnSegment:Dn,isFlat:zn,_flat:ir,polylineCenter:_r},Gi={project:function(a){return new ie(a.lng,a.lat)},unproject:function(a){return new ue(a.y,a.x)},bounds:new Te([-180,-90],[180,90])},hi={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Te([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(a){var p=Math.PI/180,S=this.R,V=a.lat*p,se=this.R_MINOR/S,Se=Math.sqrt(1-se*se),st=Se*Math.sin(V),At=Math.tan(Math.PI/4-V/2)/Math.pow((1-st)/(1+st),Se/2);return V=-S*Math.log(Math.max(At,1e-10)),new ie(a.lng*p*S,V)},unproject:function(a){for(var p=180/Math.PI,S=this.R,V=this.R_MINOR/S,se=Math.sqrt(1-V*V),Se=Math.exp(-a.y/S),st=Math.PI/2-2*Math.atan(Se),At=0,Vt=.1,sn;At<15&&Math.abs(Vt)>1e-7;At++)sn=se*Math.sin(st),sn=Math.pow((1-sn)/(1+sn),se/2),Vt=Math.PI/2-2*Math.atan(Se*sn)-st,st+=Vt;return new ue(st*p,a.x*p/S)}},_i={__proto__:null,LonLat:Gi,Mercator:hi,SphericalMercator:ke},ho=i({},Z,{code:"EPSG:3395",projection:hi,transformation:function(){var a=.5/(Math.PI*hi.R);return Ue(a,.5,-a,.5)}()}),bo=i({},Z,{code:"EPSG:4326",projection:Gi,transformation:Ue(1/180,1,-1/180,.5)}),Ts=i({},pe,{projection:Gi,transformation:Ue(1,0,-1,0),scale:function(a){return Math.pow(2,a)},zoom:function(a){return Math.log(a)/Math.LN2},distance:function(a,p){var S=p.lng-a.lng,V=p.lat-a.lat;return Math.sqrt(S*S+V*V)},infinite:!0});pe.Earth=Z,pe.EPSG3395=ho,pe.EPSG3857=ce,pe.EPSG900913=ne,pe.EPSG4326=bo,pe.Simple=Ts;var Ur=oe.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(a){return a.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(a){return a&&a.removeLayer(this),this},getPane:function(a){return this._map.getPane(a?this.options[a]||a:this.options.pane)},addInteractiveTarget:function(a){return this._map._targets[f(a)]=this,this},removeInteractiveTarget:function(a){return delete this._map._targets[f(a)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(a){var p=a.target;if(p.hasLayer(this)){if(this._map=p,this._zoomAnimated=p._zoomAnimated,this.getEvents){var S=this.getEvents();p.on(S,this),this.once("remove",function(){p.off(S,this)},this)}this.onAdd(p),this.fire("add"),p.fire("layeradd",{layer:this})}}});Zr.include({addLayer:function(a){if(!a._layerAdd)throw new Error("The provided object is not a Layer.");var p=f(a);return this._layers[p]?this:(this._layers[p]=a,a._mapToAdd=this,a.beforeAdd&&a.beforeAdd(this),this.whenReady(a._layerAdd,a),this)},removeLayer:function(a){var p=f(a);return this._layers[p]?(this._loaded&&a.onRemove(this),delete this._layers[p],this._loaded&&(this.fire("layerremove",{layer:a}),a.fire("remove")),a._map=a._mapToAdd=null,this):this},hasLayer:function(a){return f(a)in this._layers},eachLayer:function(a,p){for(var S in this._layers)a.call(p,this._layers[S]);return this},_addLayers:function(a){a=a?K(a)?a:[a]:[];for(var p=0,S=a.length;p<S;p++)this.addLayer(a[p])},_addZoomLimit:function(a){(!isNaN(a.options.maxZoom)||!isNaN(a.options.minZoom))&&(this._zoomBoundLayers[f(a)]=a,this._updateZoomLevels())},_removeZoomLimit:function(a){var p=f(a);this._zoomBoundLayers[p]&&(delete this._zoomBoundLayers[p],this._updateZoomLevels())},_updateZoomLevels:function(){var a=1/0,p=-1/0,S=this._getZoomSpan();for(var V in this._zoomBoundLayers){var se=this._zoomBoundLayers[V].options;a=se.minZoom===void 0?a:Math.min(a,se.minZoom),p=se.maxZoom===void 0?p:Math.max(p,se.maxZoom)}this._layersMaxZoom=p===-1/0?void 0:p,this._layersMinZoom=a===1/0?void 0:a,S!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var zo=Ur.extend({initialize:function(a,p){k(this,p),this._layers={};var S,V;if(a)for(S=0,V=a.length;S<V;S++)this.addLayer(a[S])},addLayer:function(a){var p=this.getLayerId(a);return this._layers[p]=a,this._map&&this._map.addLayer(a),this},removeLayer:function(a){var p=a in this._layers?a:this.getLayerId(a);return this._map&&this._layers[p]&&this._map.removeLayer(this._layers[p]),delete this._layers[p],this},hasLayer:function(a){var p=typeof a=="number"?a:this.getLayerId(a);return p in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(a){var p=Array.prototype.slice.call(arguments,1),S,V;for(S in this._layers)V=this._layers[S],V[a]&&V[a].apply(V,p);return this},onAdd:function(a){this.eachLayer(a.addLayer,a)},onRemove:function(a){this.eachLayer(a.removeLayer,a)},eachLayer:function(a,p){for(var S in this._layers)a.call(p,this._layers[S]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[];return this.eachLayer(a.push,a),a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return f(a)}}),ul=function(a,p){return new zo(a,p)},rs=zo.extend({addLayer:function(a){return this.hasLayer(a)?this:(a.addEventParent(this),zo.prototype.addLayer.call(this,a),this.fire("layeradd",{layer:a}))},removeLayer:function(a){return this.hasLayer(a)?(a in this._layers&&(a=this._layers[a]),a.removeEventParent(this),zo.prototype.removeLayer.call(this,a),this.fire("layerremove",{layer:a})):this},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new H;for(var p in this._layers){var S=this._layers[p];a.extend(S.getBounds?S.getBounds():S.getLatLng())}return a}}),eu=function(a,p){return new rs(a,p)},na=$.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(a){k(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,p){var S=this._getIconUrl(a);if(!S){if(a==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var V=this._createImg(S,p&&p.tagName==="IMG"?p:null);return this._setIconStyles(V,a),(this.options.crossOrigin||this.options.crossOrigin==="")&&(V.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),V},_setIconStyles:function(a,p){var S=this.options,V=S[p+"Size"];typeof V=="number"&&(V=[V,V]);var se=Ce(V),Se=Ce(p==="shadow"&&S.shadowAnchor||S.iconAnchor||se&&se.divideBy(2,!0));a.className="leaflet-marker-"+p+" "+(S.className||""),Se&&(a.style.marginLeft=-Se.x+"px",a.style.marginTop=-Se.y+"px"),se&&(a.style.width=se.x+"px",a.style.height=se.y+"px")},_createImg:function(a,p){return p=p||document.createElement("img"),p.src=a,p},_getIconUrl:function(a){return mt.retina&&this.options[a+"RetinaUrl"]||this.options[a+"Url"]}});function xu(a){return new na(a)}var Ga=na.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(a){return typeof Ga.imagePath!="string"&&(Ga.imagePath=this._detectIconPath()),(this.options.imagePath||Ga.imagePath)+na.prototype._getIconUrl.call(this,a)},_stripUrl:function(a){var p=function(S,V,se){var Se=V.exec(S);return Se&&Se[se]};return a=p(a,/^url\((['"])?(.+)\1\)$/,2),a&&p(a,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var a=mn("div","leaflet-default-icon-path",document.body),p=Rr(a,"background-image")||Rr(a,"backgroundImage");if(document.body.removeChild(a),p=this._stripUrl(p),p)return p;var S=document.querySelector('link[href$="leaflet.css"]');return S?S.href.substring(0,S.href.length-11-1):""}}),Ha=vi.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new Hs(a,a,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),cr(a,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Vn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(a){var p=this._marker,S=p._map,V=this._marker.options.autoPanSpeed,se=this._marker.options.autoPanPadding,Se=eo(p._icon),st=S.getPixelBounds(),At=S.getPixelOrigin(),Vt=Y(st.min._subtract(At).add(se),st.max._subtract(At).subtract(se));if(!Vt.contains(Se)){var sn=Ce((Math.max(Vt.max.x,Se.x)-Vt.max.x)/(st.max.x-Vt.max.x)-(Math.min(Vt.min.x,Se.x)-Vt.min.x)/(st.min.x-Vt.min.x),(Math.max(Vt.max.y,Se.y)-Vt.max.y)/(st.max.y-Vt.max.y)-(Math.min(Vt.min.y,Se.y)-Vt.min.y)/(st.min.y-Vt.min.y)).multiplyBy(V);S.panBy(sn,{animate:!1}),this._draggable._newPos._add(sn),this._draggable._startPos._add(sn),fr(p._icon,this._draggable._newPos),this._onDrag(a),this._panRequest=T(this._adjustPan.bind(this,a))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(a){this._marker.options.autoPan&&(D(this._panRequest),this._panRequest=T(this._adjustPan.bind(this,a)))},_onDrag:function(a){var p=this._marker,S=p._shadow,V=eo(p._icon),se=p._map.layerPointToLatLng(V);S&&fr(S,V),p._latlng=se,a.latlng=se,a.oldLatLng=this._oldLatLng,p.fire("move",a).fire("drag",a)},_onDragEnd:function(a){D(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",a)}}),wo=Ur.extend({options:{icon:new Ga,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(a,p){k(this,p),this._latlng=le(a)},onAdd:function(a){this._zoomAnimated=this._zoomAnimated&&a.options.markerZoomAnimation,this._zoomAnimated&&a.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(a){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&a.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(a){var p=this._latlng;return this._latlng=le(a),this.update(),this.fire("move",{oldLatLng:p,latlng:this._latlng})},setZIndexOffset:function(a){return this.options.zIndexOffset=a,this.update()},getIcon:function(){return this.options.icon},setIcon:function(a){return this.options.icon=a,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var a=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(a)}return this},_initIcon:function(){var a=this.options,p="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),S=a.icon.createIcon(this._icon),V=!1;S!==this._icon&&(this._icon&&this._removeIcon(),V=!0,a.title&&(S.title=a.title),S.tagName==="IMG"&&(S.alt=a.alt||"")),cr(S,p),a.keyboard&&(S.tabIndex="0",S.setAttribute("role","button")),this._icon=S,a.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&yr(S,"focus",this._panOnFocus,this);var se=a.icon.createShadow(this._shadow),Se=!1;se!==this._shadow&&(this._removeShadow(),Se=!0),se&&(cr(se,p),se.alt=""),this._shadow=se,a.opacity<1&&this._updateOpacity(),V&&this.getPane().appendChild(this._icon),this._initInteraction(),se&&Se&&this.getPane(a.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&zr(this._icon,"focus",this._panOnFocus,this),Zn(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Zn(this._shadow),this._shadow=null},_setPos:function(a){this._icon&&fr(this._icon,a),this._shadow&&fr(this._shadow,a),this._zIndex=a.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(a){this._icon&&(this._icon.style.zIndex=this._zIndex+a)},_animateZoom:function(a){var p=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(p)},_initInteraction:function(){if(this.options.interactive&&(cr(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ha)){var a=this.options.draggable;this.dragging&&(a=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ha(this),a&&this.dragging.enable()}},setOpacity:function(a){return this.options.opacity=a,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var a=this.options.opacity;this._icon&&Ai(this._icon,a),this._shadow&&Ai(this._shadow,a)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var a=this._map;if(a){var p=this.options.icon.options,S=p.iconSize?Ce(p.iconSize):Ce(0,0),V=p.iconAnchor?Ce(p.iconAnchor):Ce(0,0);a.panInside(this._latlng,{paddingTopLeft:V,paddingBottomRight:S.subtract(V)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function ra(a,p){return new wo(a,p)}var Ns=Ur.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(a){this._renderer=a.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(a){return k(this,a),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&a&&Object.prototype.hasOwnProperty.call(a,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),gs=Ns.extend({options:{fill:!0,radius:10},initialize:function(a,p){k(this,p),this._latlng=le(a),this._radius=this.options.radius},setLatLng:function(a){var p=this._latlng;return this._latlng=le(a),this.redraw(),this.fire("move",{oldLatLng:p,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(a){return this.options.radius=this._radius=a,this.redraw()},getRadius:function(){return this._radius},setStyle:function(a){var p=a&&a.radius||this._radius;return Ns.prototype.setStyle.call(this,a),this.setRadius(p),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var a=this._radius,p=this._radiusY||a,S=this._clickTolerance(),V=[a+S,p+S];this._pxBounds=new Te(this._point.subtract(V),this._point.add(V))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(a){return a.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function cl(a,p){return new gs(a,p)}var $o=gs.extend({initialize:function(a,p,S){if(typeof p=="number"&&(p=i({},S,{radius:p})),k(this,p),this._latlng=le(a),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(a){return this._mRadius=a,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new H(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)))},setStyle:Ns.prototype.setStyle,_project:function(){var a=this._latlng.lng,p=this._latlng.lat,S=this._map,V=S.options.crs;if(V.distance===Z.distance){var se=Math.PI/180,Se=this._mRadius/Z.R/se,st=S.project([p+Se,a]),At=S.project([p-Se,a]),Vt=st.add(At).divideBy(2),sn=S.unproject(Vt).lat,In=Math.acos((Math.cos(Se*se)-Math.sin(p*se)*Math.sin(sn*se))/(Math.cos(p*se)*Math.cos(sn*se)))/se;(isNaN(In)||In===0)&&(In=Se/Math.cos(Math.PI/180*p)),this._point=Vt.subtract(S.getPixelOrigin()),this._radius=isNaN(In)?0:Vt.x-S.project([sn,a-In]).x,this._radiusY=Vt.y-st.y}else{var er=V.unproject(V.project(this._latlng).subtract([this._mRadius,0]));this._point=S.latLngToLayerPoint(this._latlng),this._radius=this._point.x-S.latLngToLayerPoint(er).x}this._updateBounds()}});function is(a,p,S){return new $o(a,p,S)}var os=Ns.extend({options:{smoothFactor:1,noClip:!1},initialize:function(a,p){k(this,p),this._setLatLngs(a)},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){return this._setLatLngs(a),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(a){for(var p=1/0,S=null,V=Dn,se,Se,st=0,At=this._parts.length;st<At;st++)for(var Vt=this._parts[st],sn=1,In=Vt.length;sn<In;sn++){se=Vt[sn-1],Se=Vt[sn];var er=V(a,se,Se,!0);er<p&&(p=er,S=V(a,se,Se))}return S&&(S.distance=Math.sqrt(p)),S},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return _r(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(a,p){return p=p||this._defaultShape(),a=le(a),p.push(a),this._bounds.extend(a),this.redraw()},_setLatLngs:function(a){this._bounds=new H,this._latlngs=this._convertLatLngs(a)},_defaultShape:function(){return zn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(a){for(var p=[],S=zn(a),V=0,se=a.length;V<se;V++)S?(p[V]=le(a[V]),this._bounds.extend(p[V])):p[V]=this._convertLatLngs(a[V]);return p},_project:function(){var a=new Te;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,a),this._bounds.isValid()&&a.isValid()&&(this._rawPxBounds=a,this._updateBounds())},_updateBounds:function(){var a=this._clickTolerance(),p=new ie(a,a);this._rawPxBounds&&(this._pxBounds=new Te([this._rawPxBounds.min.subtract(p),this._rawPxBounds.max.add(p)]))},_projectLatlngs:function(a,p,S){var V=a[0]instanceof ue,se=a.length,Se,st;if(V){for(st=[],Se=0;Se<se;Se++)st[Se]=this._map.latLngToLayerPoint(a[Se]),S.extend(st[Se]);p.push(st)}else for(Se=0;Se<se;Se++)this._projectLatlngs(a[Se],p,S)},_clipPoints:function(){var a=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return}var p=this._parts,S,V,se,Se,st,At,Vt;for(S=0,se=0,Se=this._rings.length;S<Se;S++)for(Vt=this._rings[S],V=0,st=Vt.length;V<st-1;V++)At=ut(Vt[V],Vt[V+1],a,V,!0),At&&(p[se]=p[se]||[],p[se].push(At[0]),(At[1]!==Vt[V+1]||V===st-2)&&(p[se].push(At[1]),se++))}},_simplifyPoints:function(){for(var a=this._parts,p=this.options.smoothFactor,S=0,V=a.length;S<V;S++)a[S]=yi(a[S],p)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(a,p){var S,V,se,Se,st,At,Vt=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(S=0,Se=this._parts.length;S<Se;S++)for(At=this._parts[S],V=0,st=At.length,se=st-1;V<st;se=V++)if(!(!p&&V===0)&&ks(a,At[se],At[V])<=Vt)return!0;return!1}});function Xu(a,p){return new os(a,p)}os._flat=ir;var Po=os.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return qs(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(a){var p=os.prototype._convertLatLngs.call(this,a),S=p.length;return S>=2&&p[0]instanceof ue&&p[0].equals(p[S-1])&&p.pop(),p},_setLatLngs:function(a){os.prototype._setLatLngs.call(this,a),zn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return zn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var a=this._renderer._bounds,p=this.options.weight,S=new ie(p,p);if(a=new Te(a.min.subtract(S),a.max.add(S)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return}for(var V=0,se=this._rings.length,Se;V<se;V++)Se=Ol(this._rings[V],a,!0),Se.length&&this._parts.push(Se)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(a){var p=!1,S,V,se,Se,st,At,Vt,sn;if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(Se=0,Vt=this._parts.length;Se<Vt;Se++)for(S=this._parts[Se],st=0,sn=S.length,At=sn-1;st<sn;At=st++)V=S[st],se=S[At],V.y>a.y!=se.y>a.y&&a.x<(se.x-V.x)*(a.y-V.y)/(se.y-V.y)+V.x&&(p=!p);return p||os.prototype._containsPoint.call(this,a,!0)}});function ba(a,p){return new Po(a,p)}var Uo=rs.extend({initialize:function(a,p){k(this,p),this._layers={},a&&this.addData(a)},addData:function(a){var p=K(a)?a:a.features,S,V,se;if(p){for(S=0,V=p.length;S<V;S++)se=p[S],(se.geometries||se.geometry||se.features||se.coordinates)&&this.addData(se);return this}var Se=this.options;if(Se.filter&&!Se.filter(a))return this;var st=Vo(a,Se);return st?(st.feature=Ho(a),st.defaultOptions=st.options,this.resetStyle(st),Se.onEachFeature&&Se.onEachFeature(a,st),this.addLayer(st)):this},resetStyle:function(a){return a===void 0?this.eachLayer(this.resetStyle,this):(a.options=i({},a.defaultOptions),this._setLayerStyle(a,this.options.style),this)},setStyle:function(a){return this.eachLayer(function(p){this._setLayerStyle(p,a)},this)},_setLayerStyle:function(a,p){a.setStyle&&(typeof p=="function"&&(p=p(a.feature)),a.setStyle(p))}});function Vo(a,p){var S=a.type==="Feature"?a.geometry:a,V=S?S.coordinates:null,se=[],Se=p&&p.pointToLayer,st=p&&p.coordsToLatLng||xa,At,Vt,sn,In;if(!V&&!S)return null;switch(S.type){case"Point":return At=st(V),wa(Se,a,At,p);case"MultiPoint":for(sn=0,In=V.length;sn<In;sn++)At=st(V[sn]),se.push(wa(Se,a,At,p));return new rs(se);case"LineString":case"MultiLineString":return Vt=Go(V,S.type==="LineString"?0:1,st),new os(Vt,p);case"Polygon":case"MultiPolygon":return Vt=Go(V,S.type==="Polygon"?1:2,st),new Po(Vt,p);case"GeometryCollection":for(sn=0,In=S.geometries.length;sn<In;sn++){var er=Vo({geometry:S.geometries[sn],type:"Feature",properties:a.properties},p);er&&se.push(er)}return new rs(se);case"FeatureCollection":for(sn=0,In=S.features.length;sn<In;sn++){var Fr=Vo(S.features[sn],p);Fr&&se.push(Fr)}return new rs(se);default:throw new Error("Invalid GeoJSON object.")}}function wa(a,p,S,V){return a?a(p,S):new wo(S,V&&V.markersInheritOptions&&V)}function xa(a){return new ue(a[1],a[0],a[2])}function Go(a,p,S){for(var V=[],se=0,Se=a.length,st;se<Se;se++)st=p?Go(a[se],p-1,S):(S||xa)(a[se]),V.push(st);return V}function To(a,p){return a=le(a),a.alt!==void 0?[w(a.lng,p),w(a.lat,p),w(a.alt,p)]:[w(a.lng,p),w(a.lat,p)]}function ia(a,p,S,V){for(var se=[],Se=0,st=a.length;Se<st;Se++)se.push(p?ia(a[Se],zn(a[Se])?0:p-1,S,V):To(a[Se],V));return!p&&S&&se.length>0&&se.push(se[0].slice()),se}function Ds(a,p){return a.feature?i({},a.feature,{geometry:p}):Ho(p)}function Ho(a){return a.type==="Feature"||a.type==="FeatureCollection"?a:{type:"Feature",properties:{},geometry:a}}var _t={toGeoJSON:function(a){return Ds(this,{type:"Point",coordinates:To(this.getLatLng(),a)})}};wo.include(_t),$o.include(_t),gs.include(_t),os.include({toGeoJSON:function(a){var p=!zn(this._latlngs),S=ia(this._latlngs,p?1:0,!1,a);return Ds(this,{type:(p?"Multi":"")+"LineString",coordinates:S})}}),Po.include({toGeoJSON:function(a){var p=!zn(this._latlngs),S=p&&!zn(this._latlngs[0]),V=ia(this._latlngs,S?2:p?1:0,!0,a);return p||(V=[V]),Ds(this,{type:(S?"Multi":"")+"Polygon",coordinates:V})}}),zo.include({toMultiPoint:function(a){var p=[];return this.eachLayer(function(S){p.push(S.toGeoJSON(a).geometry.coordinates)}),Ds(this,{type:"MultiPoint",coordinates:p})},toGeoJSON:function(a){var p=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(p==="MultiPoint")return this.toMultiPoint(a);var S=p==="GeometryCollection",V=[];return this.eachLayer(function(se){if(se.toGeoJSON){var Se=se.toGeoJSON(a);if(S)V.push(Se.geometry);else{var st=Ho(Se);st.type==="FeatureCollection"?V.push.apply(V,st.features):V.push(st)}}}),S?Ds(this,{geometries:V,type:"GeometryCollection"}):{type:"FeatureCollection",features:V}}});function Wt(a,p){return new Uo(a,p)}var Nt=Wt,An=Ur.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(a,p,S){this._url=a,this._bounds=Q(p),k(this,S)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(cr(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Zn(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(a){return this.options.opacity=a,this._image&&this._updateOpacity(),this},setStyle:function(a){return a.opacity&&this.setOpacity(a.opacity),this},bringToFront:function(){return this._map&&Bi(this._image),this},bringToBack:function(){return this._map&&Ri(this._image),this},setUrl:function(a){return this._url=a,this._image&&(this._image.src=a),this},setBounds:function(a){return this._bounds=Q(a),this._map&&this._reset(),this},getEvents:function(){var a={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var a=this._url.tagName==="IMG",p=this._image=a?this._url:mn("img");if(cr(p,"leaflet-image-layer"),this._zoomAnimated&&cr(p,"leaflet-zoom-animated"),this.options.className&&cr(p,this.options.className),p.onselectstart=_,p.onmousemove=_,p.onload=o(this.fire,this,"load"),p.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(p.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),a){this._url=p.src;return}p.src=this._url,p.alt=this.options.alt},_animateZoom:function(a){var p=this._map.getZoomScale(a.zoom),S=this._map._latLngBoundsToNewLayerBounds(this._bounds,a.zoom,a.center).min;cn(this._image,S,p)},_reset:function(){var a=this._image,p=new Te(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),S=p.getSize();fr(a,p.min),a.style.width=S.x+"px",a.style.height=S.y+"px"},_updateOpacity:function(){Ai(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var a=this.options.errorOverlayUrl;a&&this._url!==a&&(this._url=a,this._image.src=a)},getCenter:function(){return this._bounds.getCenter()}}),Jn=function(a,p,S){return new An(a,p,S)},xr=An.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var a=this._url.tagName==="VIDEO",p=this._image=a?this._url:mn("video");if(cr(p,"leaflet-image-layer"),this._zoomAnimated&&cr(p,"leaflet-zoom-animated"),this.options.className&&cr(p,this.options.className),p.onselectstart=_,p.onmousemove=_,p.onloadeddata=o(this.fire,this,"load"),a){for(var S=p.getElementsByTagName("source"),V=[],se=0;se<S.length;se++)V.push(S[se].src);this._url=S.length>0?V:[p.src];return}K(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(p.style,"objectFit")&&(p.style.objectFit="fill"),p.autoplay=!!this.options.autoplay,p.loop=!!this.options.loop,p.muted=!!this.options.muted,p.playsInline=!!this.options.playsInline;for(var Se=0;Se<this._url.length;Se++){var st=mn("source");st.src=this._url[Se],p.appendChild(st)}}});function Wi(a,p,S){return new xr(a,p,S)}var bi=An.extend({_initImage:function(){var a=this._image=this._url;cr(a,"leaflet-image-layer"),this._zoomAnimated&&cr(a,"leaflet-zoom-animated"),this.options.className&&cr(a,this.options.className),a.onselectstart=_,a.onmousemove=_}});function Bl(a,p,S){return new bi(a,p,S)}var ss=Ur.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(a,p){a&&(a instanceof ue||K(a))?(this._latlng=le(a),k(this,p)):(k(this,a),this._source=p),this.options.content&&(this._content=this.options.content)},openOn:function(a){return a=arguments.length?a:this._source._map,a.hasLayer(this)||a.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(a){return this._map?this.close():(arguments.length?this._source=a:a=this._source,this._prepareOpen(),this.openOn(a._map)),this},onAdd:function(a){this._zoomAnimated=a._zoomAnimated,this._container||this._initLayout(),a._fadeAnimated&&Ai(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),a._fadeAnimated&&Ai(this._container,1),this.bringToFront(),this.options.interactive&&(cr(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(a){a._fadeAnimated?(Ai(this._container,0),this._removeTimeout=setTimeout(o(Zn,void 0,this._container),200)):Zn(this._container),this.options.interactive&&(Vn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=le(a),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(a){return this._content=a,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var a={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Bi(this._container),this},bringToBack:function(){return this._map&&Ri(this._container),this},_prepareOpen:function(a){var p=this._source;if(!p._map)return!1;if(p instanceof rs){p=null;var S=this._source._layers;for(var V in S)if(S[V]._map){p=S[V];break}if(!p)return!1;this._source=p}if(!a)if(p.getCenter)a=p.getCenter();else if(p.getLatLng)a=p.getLatLng();else if(p.getBounds)a=p.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(a),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var a=this._contentNode,p=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof p=="string")a.innerHTML=p;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(p)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),p=Ce(this.options.offset),S=this._getAnchor();this._zoomAnimated?fr(this._container,a.add(S)):p=p.add(a).add(S);var V=this._containerBottom=-p.y,se=this._containerLeft=-Math.round(this._containerWidth/2)+p.x;this._container.style.bottom=V+"px",this._container.style.left=se+"px"}},_getAnchor:function(){return[0,0]}});Zr.include({_initOverlay:function(a,p,S,V){var se=p;return se instanceof a||(se=new a(V).setContent(p)),S&&se.setLatLng(S),se}}),Ur.include({_initOverlay:function(a,p,S,V){var se=S;return se instanceof a?(k(se,V),se._source=this):(se=p&&!V?p:new a(V,this),se.setContent(S)),se}});var Zi=ss.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(a){return a=arguments.length?a:this._source._map,!a.hasLayer(this)&&a._popup&&a._popup.options.autoClose&&a.removeLayer(a._popup),a._popup=this,ss.prototype.openOn.call(this,a)},onAdd:function(a){ss.prototype.onAdd.call(this,a),a.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ns||this._source.on("preclick",Ua))},onRemove:function(a){ss.prototype.onRemove.call(this,a),a.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ns||this._source.off("preclick",Ua))},getEvents:function(){var a=ss.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(a.preclick=this.close),this.options.keepInView&&(a.moveend=this._adjustPan),a},_initLayout:function(){var a="leaflet-popup",p=this._container=mn("div",a+" "+(this.options.className||"")+" leaflet-zoom-animated"),S=this._wrapper=mn("div",a+"-content-wrapper",p);if(this._contentNode=mn("div",a+"-content",S),Al(p),wu(this._contentNode),yr(p,"contextmenu",Ua),this._tipContainer=mn("div",a+"-tip-container",p),this._tip=mn("div",a+"-tip",this._tipContainer),this.options.closeButton){var V=this._closeButton=mn("a",a+"-close-button",p);V.setAttribute("role","button"),V.setAttribute("aria-label","Close popup"),V.href="#close",V.innerHTML='<span aria-hidden="true">&#215;</span>',yr(V,"click",function(se){Er(se),this.close()},this)}},_updateLayout:function(){var a=this._contentNode,p=a.style;p.width="",p.whiteSpace="nowrap";var S=a.offsetWidth;S=Math.min(S,this.options.maxWidth),S=Math.max(S,this.options.minWidth),p.width=S+1+"px",p.whiteSpace="",p.height="";var V=a.offsetHeight,se=this.options.maxHeight,Se="leaflet-popup-scrolled";se&&V>se?(p.height=se+"px",cr(a,Se)):Vn(a,Se),this._containerWidth=this._container.offsetWidth},_animateZoom:function(a){var p=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center),S=this._getAnchor();fr(this._container,p.add(S))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var a=this._map,p=parseInt(Rr(this._container,"marginBottom"),10)||0,S=this._container.offsetHeight+p,V=this._containerWidth,se=new ie(this._containerLeft,-S-this._containerBottom);se._add(eo(this._container));var Se=a.layerPointToContainerPoint(se),st=Ce(this.options.autoPanPadding),At=Ce(this.options.autoPanPaddingTopLeft||st),Vt=Ce(this.options.autoPanPaddingBottomRight||st),sn=a.getSize(),In=0,er=0;Se.x+V+Vt.x>sn.x&&(In=Se.x+V-sn.x+Vt.x),Se.x-In-At.x<0&&(In=Se.x-At.x),Se.y+S+Vt.y>sn.y&&(er=Se.y+S-sn.y+Vt.y),Se.y-er-At.y<0&&(er=Se.y-At.y),(In||er)&&(this.options.keepInView&&(this._autopanning=!0),a.fire("autopanstart").panBy([In,er]))}},_getAnchor:function(){return Ce(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),oa=function(a,p){return new Zi(a,p)};Zr.mergeOptions({closePopupOnClick:!0}),Zr.include({openPopup:function(a,p,S){return this._initOverlay(Zi,a,p,S).openOn(this),this},closePopup:function(a){return a=arguments.length?a:this._popup,a&&a.close(),this}}),Ur.include({bindPopup:function(a,p){return this._popup=this._initOverlay(Zi,this._popup,a,p),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(a){return this._popup&&(this instanceof rs||(this._popup._source=this),this._popup._prepareOpen(a||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(a){return this._popup&&this._popup.setContent(a),this},getPopup:function(){return this._popup},_openPopup:function(a){if(!(!this._popup||!this._map)){Hr(a);var p=a.layer||a.target;if(this._popup._source===p&&!(p instanceof Ns)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(a.latlng);return}this._popup._source=p,this.openPopup(a.latlng)}},_movePopup:function(a){this._popup.setLatLng(a.latlng)},_onKeyPress:function(a){a.originalEvent.keyCode===13&&this._openPopup(a)}});var La=ss.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(a){ss.prototype.onAdd.call(this,a),this.setOpacity(this.options.opacity),a.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(a){ss.prototype.onRemove.call(this,a),a.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var a=ss.prototype.getEvents.call(this);return this.options.permanent||(a.preclick=this.close),a},_initLayout:function(){var a="leaflet-tooltip",p=a+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=mn("div",p),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+f(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(a){var p,S,V=this._map,se=this._container,Se=V.latLngToContainerPoint(V.getCenter()),st=V.layerPointToContainerPoint(a),At=this.options.direction,Vt=se.offsetWidth,sn=se.offsetHeight,In=Ce(this.options.offset),er=this._getAnchor();At==="top"?(p=Vt/2,S=sn):At==="bottom"?(p=Vt/2,S=0):At==="center"?(p=Vt/2,S=sn/2):At==="right"?(p=0,S=sn/2):At==="left"?(p=Vt,S=sn/2):st.x<Se.x?(At="right",p=0,S=sn/2):(At="left",p=Vt+(In.x+er.x)*2,S=sn/2),a=a.subtract(Ce(p,S,!0)).add(In).add(er),Vn(se,"leaflet-tooltip-right"),Vn(se,"leaflet-tooltip-left"),Vn(se,"leaflet-tooltip-top"),Vn(se,"leaflet-tooltip-bottom"),cr(se,"leaflet-tooltip-"+At),fr(se,a)},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a)},setOpacity:function(a){this.options.opacity=a,this._container&&Ai(this._container,a)},_animateZoom:function(a){var p=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);this._setPosition(p)},_getAnchor:function(){return Ce(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),sa=function(a,p){return new La(a,p)};Zr.include({openTooltip:function(a,p,S){return this._initOverlay(La,a,p,S).openOn(this),this},closeTooltip:function(a){return a.close(),this}}),Ur.include({bindTooltip:function(a,p){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(La,this._tooltip,a,p),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(a){if(!(!a&&this._tooltipHandlersAdded)){var p=a?"off":"on",S={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?S.add=this._openTooltip:(S.mouseover=this._openTooltip,S.mouseout=this.closeTooltip,S.click=this._openTooltip,this._map?this._addFocusListeners():S.add=this._addFocusListeners),this._tooltip.options.sticky&&(S.mousemove=this._moveTooltip),this[p](S),this._tooltipHandlersAdded=!a}},openTooltip:function(a){return this._tooltip&&(this instanceof rs||(this._tooltip._source=this),this._tooltip._prepareOpen(a)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(a){return this._tooltip&&this._tooltip.setContent(a),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(a){var p=typeof a.getElement=="function"&&a.getElement();p&&(yr(p,"focus",function(){this._tooltip._source=a,this.openTooltip()},this),yr(p,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(a){var p=typeof a.getElement=="function"&&a.getElement();p&&p.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(a){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var p=this;this._map.once("moveend",function(){p._openOnceFlag=!1,p._openTooltip(a)});return}this._tooltip._source=a.layer||a.target,this.openTooltip(this._tooltip.options.sticky?a.latlng:void 0)}},_moveTooltip:function(a){var p=a.latlng,S,V;this._tooltip.options.sticky&&a.originalEvent&&(S=this._map.mouseEventToContainerPoint(a.originalEvent),V=this._map.containerPointToLayerPoint(S),p=this._map.layerPointToLatLng(V)),this._tooltip.setLatLng(p)}});var aa=na.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(a){var p=a&&a.tagName==="DIV"?a:document.createElement("div"),S=this.options;if(S.html instanceof Element?(Ei(p),p.appendChild(S.html)):p.innerHTML=S.html!==!1?S.html:"",S.bgPos){var V=Ce(S.bgPos);p.style.backgroundPosition=-V.x+"px "+-V.y+"px"}return this._setIconStyles(p,"icon"),p},createShadow:function(){return null}});function la(a){return new aa(a)}na.Default=Ga;var Kr=Ur.extend({options:{tileSize:256,opacity:1,updateWhenIdle:mt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(a){k(this,a)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(a){a._addZoomLimit(this)},onRemove:function(a){this._removeAllTiles(),Zn(this._container),a._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Bi(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ri(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(a){return this.options.opacity=a,this._updateOpacity(),this},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var a=this._clampZoom(this._map.getZoom());a!==this._tileZoom&&(this._tileZoom=a,this._updateLevels()),this._update()}return this},getEvents:function(){var a={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove),this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},createTile:function(){return document.createElement("div")},getTileSize:function(){var a=this.options.tileSize;return a instanceof ie?a:new ie(a,a)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a){for(var p=this.getPane().children,S=-a(-1/0,1/0),V=0,se=p.length,Se;V<se;V++)Se=p[V].style.zIndex,p[V]!==this._container&&Se&&(S=a(S,+Se));isFinite(S)&&(this.options.zIndex=S+a(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!mt.ielt9){Ai(this._container,this.options.opacity);var a=+new Date,p=!1,S=!1;for(var V in this._tiles){var se=this._tiles[V];if(!(!se.current||!se.loaded)){var Se=Math.min(1,(a-se.loaded)/200);Ai(se.el,Se),Se<1?p=!0:(se.active?S=!0:this._onOpaqueTile(se),se.active=!0)}}S&&!this._noPrune&&this._pruneTiles(),p&&(D(this._fadeFrame),this._fadeFrame=T(this._updateOpacity,this))}},_onOpaqueTile:_,_initContainer:function(){this._container||(this._container=mn("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var a=this._tileZoom,p=this.options.maxZoom;if(a!==void 0){for(var S in this._levels)S=Number(S),this._levels[S].el.children.length||S===a?(this._levels[S].el.style.zIndex=p-Math.abs(a-S),this._onUpdateLevel(S)):(Zn(this._levels[S].el),this._removeTilesAtZoom(S),this._onRemoveLevel(S),delete this._levels[S]);var V=this._levels[a],se=this._map;return V||(V=this._levels[a]={},V.el=mn("div","leaflet-tile-container leaflet-zoom-animated",this._container),V.el.style.zIndex=p,V.origin=se.project(se.unproject(se.getPixelOrigin()),a).round(),V.zoom=a,this._setZoomTransform(V,se.getCenter(),se.getZoom()),_(V.el.offsetWidth),this._onCreateLevel(V)),this._level=V,V}},_onUpdateLevel:_,_onRemoveLevel:_,_onCreateLevel:_,_pruneTiles:function(){if(this._map){var a,p,S=this._map.getZoom();if(S>this.options.maxZoom||S<this.options.minZoom){this._removeAllTiles();return}for(a in this._tiles)p=this._tiles[a],p.retain=p.current;for(a in this._tiles)if(p=this._tiles[a],p.current&&!p.active){var V=p.coords;this._retainParent(V.x,V.y,V.z,V.z-5)||this._retainChildren(V.x,V.y,V.z,V.z+2)}for(a in this._tiles)this._tiles[a].retain||this._removeTile(a)}},_removeTilesAtZoom:function(a){for(var p in this._tiles)this._tiles[p].coords.z===a&&this._removeTile(p)},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a)},_invalidateAll:function(){for(var a in this._levels)Zn(this._levels[a].el),this._onRemoveLevel(Number(a)),delete this._levels[a];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(a,p,S,V){var se=Math.floor(a/2),Se=Math.floor(p/2),st=S-1,At=new ie(+se,+Se);At.z=+st;var Vt=this._tileCoordsToKey(At),sn=this._tiles[Vt];return sn&&sn.active?(sn.retain=!0,!0):(sn&&sn.loaded&&(sn.retain=!0),st>V?this._retainParent(se,Se,st,V):!1)},_retainChildren:function(a,p,S,V){for(var se=2*a;se<2*a+2;se++)for(var Se=2*p;Se<2*p+2;Se++){var st=new ie(se,Se);st.z=S+1;var At=this._tileCoordsToKey(st),Vt=this._tiles[At];if(Vt&&Vt.active){Vt.retain=!0;continue}else Vt&&Vt.loaded&&(Vt.retain=!0);S+1<V&&this._retainChildren(se,Se,S+1,V)}},_resetView:function(a){var p=a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),p,p)},_animateZoom:function(a){this._setView(a.center,a.zoom,!0,a.noUpdate)},_clampZoom:function(a){var p=this.options;return p.minNativeZoom!==void 0&&a<p.minNativeZoom?p.minNativeZoom:p.maxNativeZoom!==void 0&&p.maxNativeZoom<a?p.maxNativeZoom:a},_setView:function(a,p,S,V){var se=Math.round(p);this.options.maxZoom!==void 0&&se>this.options.maxZoom||this.options.minZoom!==void 0&&se<this.options.minZoom?se=void 0:se=this._clampZoom(se);var Se=this.options.updateWhenZooming&&se!==this._tileZoom;(!V||Se)&&(this._tileZoom=se,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),se!==void 0&&this._update(a),S||this._pruneTiles(),this._noPrune=!!S),this._setZoomTransforms(a,p)},_setZoomTransforms:function(a,p){for(var S in this._levels)this._setZoomTransform(this._levels[S],a,p)},_setZoomTransform:function(a,p,S){var V=this._map.getZoomScale(S,a.zoom),se=a.origin.multiplyBy(V).subtract(this._map._getNewPixelOrigin(p,S)).round();mt.any3d?cn(a.el,se,V):fr(a.el,se)},_resetGrid:function(){var a=this._map,p=a.options.crs,S=this._tileSize=this.getTileSize(),V=this._tileZoom,se=this._map.getPixelWorldBounds(this._tileZoom);se&&(this._globalTileRange=this._pxBoundsToTileRange(se)),this._wrapX=p.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,p.wrapLng[0]],V).x/S.x),Math.ceil(a.project([0,p.wrapLng[1]],V).x/S.y)],this._wrapY=p.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([p.wrapLat[0],0],V).y/S.x),Math.ceil(a.project([p.wrapLat[1],0],V).y/S.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(a){var p=this._map,S=p._animatingZoom?Math.max(p._animateToZoom,p.getZoom()):p.getZoom(),V=p.getZoomScale(S,this._tileZoom),se=p.project(a,this._tileZoom).floor(),Se=p.getSize().divideBy(V*2);return new Te(se.subtract(Se),se.add(Se))},_update:function(a){var p=this._map;if(p){var S=this._clampZoom(p.getZoom());if(a===void 0&&(a=p.getCenter()),this._tileZoom!==void 0){var V=this._getTiledPixelBounds(a),se=this._pxBoundsToTileRange(V),Se=se.getCenter(),st=[],At=this.options.keepBuffer,Vt=new Te(se.getBottomLeft().subtract([At,-At]),se.getTopRight().add([At,-At]));if(!(isFinite(se.min.x)&&isFinite(se.min.y)&&isFinite(se.max.x)&&isFinite(se.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var sn in this._tiles){var In=this._tiles[sn].coords;(In.z!==this._tileZoom||!Vt.contains(new ie(In.x,In.y)))&&(this._tiles[sn].current=!1)}if(Math.abs(S-this._tileZoom)>1){this._setView(a,S);return}for(var er=se.min.y;er<=se.max.y;er++)for(var Fr=se.min.x;Fr<=se.max.x;Fr++){var Lo=new ie(Fr,er);if(Lo.z=this._tileZoom,!!this._isValidTile(Lo)){var io=this._tiles[this._tileCoordsToKey(Lo)];io?io.current=!0:st.push(Lo)}}if(st.sort(function(Ki,ys){return Ki.distanceTo(Se)-ys.distanceTo(Se)}),st.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Oo=document.createDocumentFragment();for(Fr=0;Fr<st.length;Fr++)this._addTile(st[Fr],Oo);this._level.el.appendChild(Oo)}}}},_isValidTile:function(a){var p=this._map.options.crs;if(!p.infinite){var S=this._globalTileRange;if(!p.wrapLng&&(a.x<S.min.x||a.x>S.max.x)||!p.wrapLat&&(a.y<S.min.y||a.y>S.max.y))return!1}if(!this.options.bounds)return!0;var V=this._tileCoordsToBounds(a);return Q(this.options.bounds).overlaps(V)},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a))},_tileCoordsToNwSe:function(a){var p=this._map,S=this.getTileSize(),V=a.scaleBy(S),se=V.add(S),Se=p.unproject(V,a.z),st=p.unproject(se,a.z);return[Se,st]},_tileCoordsToBounds:function(a){var p=this._tileCoordsToNwSe(a),S=new H(p[0],p[1]);return this.options.noWrap||(S=this._map.wrapLatLngBounds(S)),S},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_keyToTileCoords:function(a){var p=a.split(":"),S=new ie(+p[0],+p[1]);return S.z=+p[2],S},_removeTile:function(a){var p=this._tiles[a];p&&(Zn(p.el),delete this._tiles[a],this.fire("tileunload",{tile:p.el,coords:this._keyToTileCoords(a)}))},_initTile:function(a){cr(a,"leaflet-tile");var p=this.getTileSize();a.style.width=p.x+"px",a.style.height=p.y+"px",a.onselectstart=_,a.onmousemove=_,mt.ielt9&&this.options.opacity<1&&Ai(a,this.options.opacity)},_addTile:function(a,p){var S=this._getTilePos(a),V=this._tileCoordsToKey(a),se=this.createTile(this._wrapCoords(a),o(this._tileReady,this,a));this._initTile(se),this.createTile.length<2&&T(o(this._tileReady,this,a,null,se)),fr(se,S),this._tiles[V]={el:se,coords:a,current:!0},p.appendChild(se),this.fire("tileloadstart",{tile:se,coords:a})},_tileReady:function(a,p,S){p&&this.fire("tileerror",{error:p,tile:S,coords:a});var V=this._tileCoordsToKey(a);S=this._tiles[V],S&&(S.loaded=+new Date,this._map._fadeAnimated?(Ai(S.el,0),D(this._fadeFrame),this._fadeFrame=T(this._updateOpacity,this)):(S.active=!0,this._pruneTiles()),p||(cr(S.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:S.el,coords:a})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),mt.ielt9||!this._map._fadeAnimated?T(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(a){return a.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(a){var p=new ie(this._wrapX?m(a.x,this._wrapX):a.x,this._wrapY?m(a.y,this._wrapY):a.y);return p.z=a.z,p},_pxBoundsToTileRange:function(a){var p=this.getTileSize();return new Te(a.min.unscaleBy(p).floor(),a.max.unscaleBy(p).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0}});function Ws(a){return new Kr(a)}var No=Kr.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(a,p){this._url=a,p=k(this,p),p.detectRetina&&mt.retina&&p.maxZoom>0?(p.tileSize=Math.floor(p.tileSize/2),p.zoomReverse?(p.zoomOffset--,p.minZoom=Math.min(p.maxZoom,p.minZoom+1)):(p.zoomOffset++,p.maxZoom=Math.max(p.minZoom,p.maxZoom-1)),p.minZoom=Math.max(0,p.minZoom)):p.zoomReverse?p.minZoom=Math.min(p.maxZoom,p.minZoom):p.maxZoom=Math.max(p.minZoom,p.maxZoom),typeof p.subdomains=="string"&&(p.subdomains=p.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(a,p){return this._url===a&&p===void 0&&(p=!0),this._url=a,p||this.redraw(),this},createTile:function(a,p){var S=document.createElement("img");return yr(S,"load",o(this._tileOnLoad,this,p,S)),yr(S,"error",o(this._tileOnError,this,p,S)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(S.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(S.referrerPolicy=this.options.referrerPolicy),S.alt="",S.src=this.getTileUrl(a),S},getTileUrl:function(a){var p={r:mt.retina?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var S=this._globalTileRange.max.y-a.y;this.options.tms&&(p.y=S),p["-y"]=S}return R(this._url,i(p,this.options))},_tileOnLoad:function(a,p){mt.ielt9?setTimeout(o(a,this,null,p),0):a(null,p)},_tileOnError:function(a,p,S){var V=this.options.errorTileUrl;V&&p.getAttribute("src")!==V&&(p.src=V),a(S,p)},_onTileRemove:function(a){a.tile.onload=null},_getZoomForUrl:function(){var a=this._tileZoom,p=this.options.maxZoom,S=this.options.zoomReverse,V=this.options.zoomOffset;return S&&(a=p-a),a+V},_getSubdomain:function(a){var p=Math.abs(a.x+a.y)%this.options.subdomains.length;return this.options.subdomains[p]},_abortLoading:function(){var a,p;for(a in this._tiles)if(this._tiles[a].coords.z!==this._tileZoom&&(p=this._tiles[a].el,p.onload=_,p.onerror=_,!p.complete)){p.src=he;var S=this._tiles[a].coords;Zn(p),delete this._tiles[a],this.fire("tileabort",{tile:p,coords:S})}},_removeTile:function(a){var p=this._tiles[a];if(p)return p.el.setAttribute("src",he),Kr.prototype._removeTile.call(this,a)},_tileReady:function(a,p,S){if(!(!this._map||S&&S.getAttribute("src")===he))return Kr.prototype._tileReady.call(this,a,p,S)}});function wi(a,p){return new No(a,p)}var ki=No.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(a,p){this._url=a;var S=i({},this.defaultWmsParams);for(var V in p)V in this.options||(S[V]=p[V]);p=k(this,p);var se=p.detectRetina&&mt.retina?2:1,Se=this.getTileSize();S.width=Se.x*se,S.height=Se.y*se,this.wmsParams=S},onAdd:function(a){this._crs=this.options.crs||a.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var p=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[p]=this._crs.code,No.prototype.onAdd.call(this,a)},getTileUrl:function(a){var p=this._tileCoordsToNwSe(a),S=this._crs,V=Y(S.project(p[0]),S.project(p[1])),se=V.min,Se=V.max,st=(this._wmsVersion>=1.3&&this._crs===bo?[se.y,se.x,Se.y,Se.x]:[se.x,se.y,Se.x,Se.y]).join(","),At=No.prototype.getTileUrl.call(this,a);return At+F(this.wmsParams,At,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+st},setParams:function(a,p){return i(this.wmsParams,a),p||this.redraw(),this}});function po(a,p){return new ki(a,p)}No.WMS=ki,wi.wms=po;var $i=Ur.extend({options:{padding:.1},initialize:function(a){k(this,a),f(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),cr(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var a={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(a.zoomanim=this._onAnimZoom),a},_onAnimZoom:function(a){this._updateTransform(a.center,a.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(a,p){var S=this._map.getZoomScale(p,this._zoom),V=this._map.getSize().multiplyBy(.5+this.options.padding),se=this._map.project(this._center,p),Se=V.multiplyBy(-S).add(se).subtract(this._map._getNewPixelOrigin(a,p));mt.any3d?cn(this._container,Se,S):fr(this._container,Se)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var a in this._layers)this._layers[a]._reset()},_onZoomEnd:function(){for(var a in this._layers)this._layers[a]._project()},_updatePaths:function(){for(var a in this._layers)this._layers[a]._update()},_update:function(){var a=this.options.padding,p=this._map.getSize(),S=this._map.containerPointToLayerPoint(p.multiplyBy(-a)).round();this._bounds=new Te(S,S.add(p.multiplyBy(1+a*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Is=$i.extend({options:{tolerance:0},getEvents:function(){var a=$i.prototype.getEvents.call(this);return a.viewprereset=this._onViewPreReset,a},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){$i.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var a=this._container=document.createElement("canvas");yr(a,"mousemove",this._onMouseMove,this),yr(a,"click dblclick mousedown mouseup contextmenu",this._onClick,this),yr(a,"mouseout",this._handleMouseOut,this),a._leaflet_disable_events=!0,this._ctx=a.getContext("2d")},_destroyContainer:function(){D(this._redrawRequest),delete this._ctx,Zn(this._container),zr(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var a;this._redrawBounds=null;for(var p in this._layers)a=this._layers[p],a._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){$i.prototype._update.call(this);var a=this._bounds,p=this._container,S=a.getSize(),V=mt.retina?2:1;fr(p,a.min),p.width=V*S.x,p.height=V*S.y,p.style.width=S.x+"px",p.style.height=S.y+"px",mt.retina&&this._ctx.scale(2,2),this._ctx.translate(-a.min.x,-a.min.y),this.fire("update")}},_reset:function(){$i.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(a){this._updateDashArray(a),this._layers[f(a)]=a;var p=a._order={layer:a,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=p),this._drawLast=p,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(a){this._requestRedraw(a)},_removePath:function(a){var p=a._order,S=p.next,V=p.prev;S?S.prev=V:this._drawLast=V,V?V.next=S:this._drawFirst=S,delete a._order,delete this._layers[f(a)],this._requestRedraw(a)},_updatePath:function(a){this._extendRedrawBounds(a),a._project(),a._update(),this._requestRedraw(a)},_updateStyle:function(a){this._updateDashArray(a),this._requestRedraw(a)},_updateDashArray:function(a){if(typeof a.options.dashArray=="string"){var p=a.options.dashArray.split(/[, ]+/),S=[],V,se;for(se=0;se<p.length;se++){if(V=Number(p[se]),isNaN(V))return;S.push(V)}a.options._dashArray=S}else a.options._dashArray=a.options.dashArray},_requestRedraw:function(a){this._map&&(this._extendRedrawBounds(a),this._redrawRequest=this._redrawRequest||T(this._redraw,this))},_extendRedrawBounds:function(a){if(a._pxBounds){var p=(a.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Te,this._redrawBounds.extend(a._pxBounds.min.subtract([p,p])),this._redrawBounds.extend(a._pxBounds.max.add([p,p]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var a=this._redrawBounds;if(a){var p=a.getSize();this._ctx.clearRect(a.min.x,a.min.y,p.x,p.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var a,p=this._redrawBounds;if(this._ctx.save(),p){var S=p.getSize();this._ctx.beginPath(),this._ctx.rect(p.min.x,p.min.y,S.x,S.y),this._ctx.clip()}this._drawing=!0;for(var V=this._drawFirst;V;V=V.next)a=V.layer,(!p||a._pxBounds&&a._pxBounds.intersects(p))&&a._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(a,p){if(this._drawing){var S,V,se,Se,st=a._parts,At=st.length,Vt=this._ctx;if(At){for(Vt.beginPath(),S=0;S<At;S++){for(V=0,se=st[S].length;V<se;V++)Se=st[S][V],Vt[V?"lineTo":"moveTo"](Se.x,Se.y);p&&Vt.closePath()}this._fillStroke(Vt,a)}}},_updateCircle:function(a){if(!(!this._drawing||a._empty())){var p=a._point,S=this._ctx,V=Math.max(Math.round(a._radius),1),se=(Math.max(Math.round(a._radiusY),1)||V)/V;se!==1&&(S.save(),S.scale(1,se)),S.beginPath(),S.arc(p.x,p.y/se,V,0,Math.PI*2,!1),se!==1&&S.restore(),this._fillStroke(S,a)}},_fillStroke:function(a,p){var S=p.options;S.fill&&(a.globalAlpha=S.fillOpacity,a.fillStyle=S.fillColor||S.color,a.fill(S.fillRule||"evenodd")),S.stroke&&S.weight!==0&&(a.setLineDash&&a.setLineDash(p.options&&p.options._dashArray||[]),a.globalAlpha=S.opacity,a.lineWidth=S.weight,a.strokeStyle=S.color,a.lineCap=S.lineCap,a.lineJoin=S.lineJoin,a.stroke())},_onClick:function(a){for(var p=this._map.mouseEventToLayerPoint(a),S,V,se=this._drawFirst;se;se=se.next)S=se.layer,S.options.interactive&&S._containsPoint(p)&&(!(a.type==="click"||a.type==="preclick")||!this._map._draggableMoved(S))&&(V=S);this._fireEvent(V?[V]:!1,a)},_onMouseMove:function(a){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var p=this._map.mouseEventToLayerPoint(a);this._handleMouseHover(a,p)}},_handleMouseOut:function(a){var p=this._hoveredLayer;p&&(Vn(this._container,"leaflet-interactive"),this._fireEvent([p],a,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(a,p){if(!this._mouseHoverThrottled){for(var S,V,se=this._drawFirst;se;se=se.next)S=se.layer,S.options.interactive&&S._containsPoint(p)&&(V=S);V!==this._hoveredLayer&&(this._handleMouseOut(a),V&&(cr(this._container,"leaflet-interactive"),this._fireEvent([V],a,"mouseover"),this._hoveredLayer=V)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,a),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(a,p,S){this._map._fireDOMEvent(p,S||p.type,a)},_bringToFront:function(a){var p=a._order;if(p){var S=p.next,V=p.prev;if(S)S.prev=V;else return;V?V.next=S:S&&(this._drawFirst=S),p.prev=this._drawLast,this._drawLast.next=p,p.next=null,this._drawLast=p,this._requestRedraw(a)}},_bringToBack:function(a){var p=a._order;if(p){var S=p.next,V=p.prev;if(V)V.next=S;else return;S?S.prev=V:V&&(this._drawLast=V),p.prev=null,p.next=this._drawFirst,this._drawFirst.prev=p,this._drawFirst=p,this._requestRedraw(a)}}});function ms(a){return mt.canvas?new Is(a):null}var js=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return document.createElement("<lvml:"+a+' class="lvml">')}}catch{}return function(a){return document.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Lu={_initContainer:function(){this._container=mn("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||($i.prototype._update.call(this),this.fire("update"))},_initPath:function(a){var p=a._container=js("shape");cr(p,"leaflet-vml-shape "+(this.options.className||"")),p.coordsize="1 1",a._path=js("path"),p.appendChild(a._path),this._updateStyle(a),this._layers[f(a)]=a},_addPath:function(a){var p=a._container;this._container.appendChild(p),a.options.interactive&&a.addInteractiveTarget(p)},_removePath:function(a){var p=a._container;Zn(p),a.removeInteractiveTarget(p),delete this._layers[f(a)]},_updateStyle:function(a){var p=a._stroke,S=a._fill,V=a.options,se=a._container;se.stroked=!!V.stroke,se.filled=!!V.fill,V.stroke?(p||(p=a._stroke=js("stroke")),se.appendChild(p),p.weight=V.weight+"px",p.color=V.color,p.opacity=V.opacity,V.dashArray?p.dashStyle=K(V.dashArray)?V.dashArray.join(" "):V.dashArray.replace(/( *, *)/g," "):p.dashStyle="",p.endcap=V.lineCap.replace("butt","flat"),p.joinstyle=V.lineJoin):p&&(se.removeChild(p),a._stroke=null),V.fill?(S||(S=a._fill=js("fill")),se.appendChild(S),S.color=V.fillColor||V.color,S.opacity=V.fillOpacity):S&&(se.removeChild(S),a._fill=null)},_updateCircle:function(a){var p=a._point.round(),S=Math.round(a._radius),V=Math.round(a._radiusY||S);this._setPath(a,a._empty()?"M0 0":"AL "+p.x+","+p.y+" "+S+","+V+" 0,"+65535*360)},_setPath:function(a,p){a._path.v=p},_bringToFront:function(a){Bi(a._container)},_bringToBack:function(a){Ri(a._container)}},ua=mt.vml?js:ye,xo=$i.extend({_initContainer:function(){this._container=ua("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=ua("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Zn(this._container),zr(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){$i.prototype._update.call(this);var a=this._bounds,p=a.getSize(),S=this._container;(!this._svgSize||!this._svgSize.equals(p))&&(this._svgSize=p,S.setAttribute("width",p.x),S.setAttribute("height",p.y)),fr(S,a.min),S.setAttribute("viewBox",[a.min.x,a.min.y,p.x,p.y].join(" ")),this.fire("update")}},_initPath:function(a){var p=a._path=ua("path");a.options.className&&cr(p,a.options.className),a.options.interactive&&cr(p,"leaflet-interactive"),this._updateStyle(a),this._layers[f(a)]=a},_addPath:function(a){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(a._path),a.addInteractiveTarget(a._path)},_removePath:function(a){Zn(a._path),a.removeInteractiveTarget(a._path),delete this._layers[f(a)]},_updatePath:function(a){a._project(),a._update()},_updateStyle:function(a){var p=a._path,S=a.options;p&&(S.stroke?(p.setAttribute("stroke",S.color),p.setAttribute("stroke-opacity",S.opacity),p.setAttribute("stroke-width",S.weight),p.setAttribute("stroke-linecap",S.lineCap),p.setAttribute("stroke-linejoin",S.lineJoin),S.dashArray?p.setAttribute("stroke-dasharray",S.dashArray):p.removeAttribute("stroke-dasharray"),S.dashOffset?p.setAttribute("stroke-dashoffset",S.dashOffset):p.removeAttribute("stroke-dashoffset")):p.setAttribute("stroke","none"),S.fill?(p.setAttribute("fill",S.fillColor||S.color),p.setAttribute("fill-opacity",S.fillOpacity),p.setAttribute("fill-rule",S.fillRule||"evenodd")):p.setAttribute("fill","none"))},_updatePoly:function(a,p){this._setPath(a,de(a._parts,p))},_updateCircle:function(a){var p=a._point,S=Math.max(Math.round(a._radius),1),V=Math.max(Math.round(a._radiusY),1)||S,se="a"+S+","+V+" 0 1,0 ",Se=a._empty()?"M0 0":"M"+(p.x-S)+","+p.y+se+S*2+",0 "+se+-S*2+",0 ";this._setPath(a,Se)},_setPath:function(a,p){a._path.setAttribute("d",p)},_bringToFront:function(a){Bi(a._path)},_bringToBack:function(a){Ri(a._path)}});mt.vml&&xo.include(Lu);function ji(a){return mt.svg||mt.vml?new xo(a):null}Zr.include({getRenderer:function(a){var p=a.options.renderer||this._getPaneRenderer(a.options.pane)||this.options.renderer||this._renderer;return p||(p=this._renderer=this._createRenderer()),this.hasLayer(p)||this.addLayer(p),p},_getPaneRenderer:function(a){if(a==="overlayPane"||a===void 0)return!1;var p=this._paneRenderers[a];return p===void 0&&(p=this._createRenderer({pane:a}),this._paneRenderers[a]=p),p},_createRenderer:function(a){return this.options.preferCanvas&&ms(a)||ji(a)}});var qo=Po.extend({initialize:function(a,p){Po.prototype.initialize.call(this,this._boundsToLatLngs(a),p)},setBounds:function(a){return this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){return a=Q(a),[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});function vs(a,p){return new qo(a,p)}xo.create=ua,xo.pointsToPath=de,Uo.geometryToLayer=Vo,Uo.coordsToLatLng=xa,Uo.coordsToLatLngs=Go,Uo.latLngToCoords=To,Uo.latLngsToCoords=ia,Uo.getFeature=Ds,Uo.asFeature=Ho,Zr.mergeOptions({boxZoom:!0});var pr=vi.extend({initialize:function(a){this._map=a,this._container=a._container,this._pane=a._panes.overlayPane,this._resetStateTimeout=0,a.on("unload",this._destroy,this)},addHooks:function(){yr(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){zr(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Zn(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(a){if(!a.shiftKey||a.which!==1&&a.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Ao(),il(),this._startPoint=this._map.mouseEventToContainerPoint(a),yr(document,{contextmenu:Hr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(a){this._moved||(this._moved=!0,this._box=mn("div","leaflet-zoom-box",this._container),cr(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(a);var p=new Te(this._point,this._startPoint),S=p.getSize();fr(this._box,p.min),this._box.style.width=S.x+"px",this._box.style.height=S.y+"px"},_finish:function(){this._moved&&(Zn(this._box),Vn(this._container,"leaflet-crosshair")),_o(),jr(),zr(document,{contextmenu:Hr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(a){if(!(a.which!==1&&a.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var p=new H(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(p).fire("boxzoomend",{boxZoomBounds:p})}},_onKeyDown:function(a){a.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Zr.addInitHook("addHandler","boxZoom",pr),Zr.mergeOptions({doubleClickZoom:!0});var Sa=vi.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var p=this._map,S=p.getZoom(),V=p.options.zoomDelta,se=a.originalEvent.shiftKey?S-V:S+V;p.options.doubleClickZoom==="center"?p.setZoom(se):p.setZoomAround(a.containerPoint,se)}});Zr.addInitHook("addHandler","doubleClickZoom",Sa),Zr.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Ea=vi.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new Hs(a._mapPane,a._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),a.on("zoomend",this._onZoomEnd,this),a.whenReady(this._onZoomEnd,this))}cr(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Vn(this._map._container,"leaflet-grab"),Vn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var a=this._map;if(a._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var p=Q(this._map.options.maxBounds);this._offsetLimit=Y(this._map.latLngToContainerPoint(p.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(p.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;a.fire("movestart").fire("dragstart"),a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(a){if(this._map.options.inertia){var p=this._lastTime=+new Date,S=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(S),this._times.push(p),this._prunePositions(p)}this._map.fire("move",a).fire("drag",a)},_prunePositions:function(a){for(;this._positions.length>1&&a-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var a=this._map.getSize().divideBy(2),p=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=p.subtract(a).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(a,p){return a-(a-p)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var a=this._draggable._newPos.subtract(this._draggable._startPos),p=this._offsetLimit;a.x<p.min.x&&(a.x=this._viscousLimit(a.x,p.min.x)),a.y<p.min.y&&(a.y=this._viscousLimit(a.y,p.min.y)),a.x>p.max.x&&(a.x=this._viscousLimit(a.x,p.max.x)),a.y>p.max.y&&(a.y=this._viscousLimit(a.y,p.max.y)),this._draggable._newPos=this._draggable._startPos.add(a)}},_onPreDragWrap:function(){var a=this._worldWidth,p=Math.round(a/2),S=this._initialWorldOffset,V=this._draggable._newPos.x,se=(V-p+S)%a+p-S,Se=(V+p+S)%a-p-S,st=Math.abs(se+S)<Math.abs(Se+S)?se:Se;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=st},_onDragEnd:function(a){var p=this._map,S=p.options,V=!S.inertia||a.noInertia||this._times.length<2;if(p.fire("dragend",a),V)p.fire("moveend");else{this._prunePositions(+new Date);var se=this._lastPos.subtract(this._positions[0]),Se=(this._lastTime-this._times[0])/1e3,st=S.easeLinearity,At=se.multiplyBy(st/Se),Vt=At.distanceTo([0,0]),sn=Math.min(S.inertiaMaxSpeed,Vt),In=At.multiplyBy(sn/Vt),er=sn/(S.inertiaDeceleration*st),Fr=In.multiplyBy(-er/2).round();!Fr.x&&!Fr.y?p.fire("moveend"):(Fr=p._limitOffset(Fr,p.options.maxBounds),T(function(){p.panBy(Fr,{duration:er,easeLinearity:st,noMoveStart:!0,animate:!0})}))}}});Zr.addInitHook("addHandler","dragging",Ea),Zr.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Zs=vi.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(a){this._map=a,this._setPanDelta(a.options.keyboardPanDelta),this._setZoomDelta(a.options.zoomDelta)},addHooks:function(){var a=this._map._container;a.tabIndex<=0&&(a.tabIndex="0"),yr(a,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),zr(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var a=document.body,p=document.documentElement,S=a.scrollTop||p.scrollTop,V=a.scrollLeft||p.scrollLeft;this._map._container.focus(),window.scrollTo(V,S)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(a){var p=this._panKeys={},S=this.keyCodes,V,se;for(V=0,se=S.left.length;V<se;V++)p[S.left[V]]=[-1*a,0];for(V=0,se=S.right.length;V<se;V++)p[S.right[V]]=[a,0];for(V=0,se=S.down.length;V<se;V++)p[S.down[V]]=[0,a];for(V=0,se=S.up.length;V<se;V++)p[S.up[V]]=[0,-1*a]},_setZoomDelta:function(a){var p=this._zoomKeys={},S=this.keyCodes,V,se;for(V=0,se=S.zoomIn.length;V<se;V++)p[S.zoomIn[V]]=a;for(V=0,se=S.zoomOut.length;V<se;V++)p[S.zoomOut[V]]=-a},_addHooks:function(){yr(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){zr(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var p=a.keyCode,S=this._map,V;if(p in this._panKeys){if(!S._panAnim||!S._panAnim._inProgress)if(V=this._panKeys[p],a.shiftKey&&(V=Ce(V).multiplyBy(3)),S.options.maxBounds&&(V=S._limitOffset(Ce(V),S.options.maxBounds)),S.options.worldCopyJump){var se=S.wrapLatLng(S.unproject(S.project(S.getCenter()).add(V)));S.panTo(se)}else S.panBy(V)}else if(p in this._zoomKeys)S.setZoom(S.getZoom()+(a.shiftKey?3:1)*this._zoomKeys[p]);else if(p===27&&S._popup&&S._popup.options.closeOnEscapeKey)S.closePopup();else return;Hr(a)}}});Zr.addInitHook("addHandler","keyboard",Zs),Zr.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var as=vi.extend({addHooks:function(){yr(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){zr(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(a){var p=Jl(a),S=this._map.options.wheelDebounceTime;this._delta+=p,this._lastMousePos=this._map.mouseEventToContainerPoint(a),this._startTime||(this._startTime=+new Date);var V=Math.max(S-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),V),Hr(a)},_performZoom:function(){var a=this._map,p=a.getZoom(),S=this._map.options.zoomSnap||0;a._stop();var V=this._delta/(this._map.options.wheelPxPerZoomLevel*4),se=4*Math.log(2/(1+Math.exp(-Math.abs(V))))/Math.LN2,Se=S?Math.ceil(se/S)*S:se,st=a._limitZoom(p+(this._delta>0?Se:-Se))-p;this._delta=0,this._startTime=null,st&&(a.options.scrollWheelZoom==="center"?a.setZoom(p+st):a.setZoomAround(this._lastMousePos,p+st))}});Zr.addInitHook("addHandler","scrollWheelZoom",as);var bc=600;Zr.mergeOptions({tapHold:mt.touchNative&&mt.safari&&mt.mobile,tapTolerance:15});var Do=vi.extend({addHooks:function(){yr(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){zr(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(clearTimeout(this._holdTimeout),a.touches.length===1){var p=a.touches[0];this._startPos=this._newPos=new ie(p.clientX,p.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(yr(document,"touchend",Er),yr(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",p))},this),bc),yr(document,"touchend touchcancel contextmenu",this._cancel,this),yr(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function a(){zr(document,"touchend",Er),zr(document,"touchend touchcancel",a)},_cancel:function(){clearTimeout(this._holdTimeout),zr(document,"touchend touchcancel contextmenu",this._cancel,this),zr(document,"touchmove",this._onMove,this)},_onMove:function(a){var p=a.touches[0];this._newPos=new ie(p.clientX,p.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(a,p){var S=new MouseEvent(a,{bubbles:!0,cancelable:!0,view:window,screenX:p.screenX,screenY:p.screenY,clientX:p.clientX,clientY:p.clientY});S._simulated=!0,p.target.dispatchEvent(S)}});Zr.addInitHook("addHandler","tapHold",Do),Zr.mergeOptions({touchZoom:mt.touch,bounceAtZoomLimits:!0});var Io=vi.extend({addHooks:function(){cr(this._map._container,"leaflet-touch-zoom"),yr(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Vn(this._map._container,"leaflet-touch-zoom"),zr(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var p=this._map;if(!(!a.touches||a.touches.length!==2||p._animatingZoom||this._zooming)){var S=p.mouseEventToContainerPoint(a.touches[0]),V=p.mouseEventToContainerPoint(a.touches[1]);this._centerPoint=p.getSize()._divideBy(2),this._startLatLng=p.containerPointToLatLng(this._centerPoint),p.options.touchZoom!=="center"&&(this._pinchStartLatLng=p.containerPointToLatLng(S.add(V)._divideBy(2))),this._startDist=S.distanceTo(V),this._startZoom=p.getZoom(),this._moved=!1,this._zooming=!0,p._stop(),yr(document,"touchmove",this._onTouchMove,this),yr(document,"touchend touchcancel",this._onTouchEnd,this),Er(a)}},_onTouchMove:function(a){if(!(!a.touches||a.touches.length!==2||!this._zooming)){var p=this._map,S=p.mouseEventToContainerPoint(a.touches[0]),V=p.mouseEventToContainerPoint(a.touches[1]),se=S.distanceTo(V)/this._startDist;if(this._zoom=p.getScaleZoom(se,this._startZoom),!p.options.bounceAtZoomLimits&&(this._zoom<p.getMinZoom()&&se<1||this._zoom>p.getMaxZoom()&&se>1)&&(this._zoom=p._limitZoom(this._zoom)),p.options.touchZoom==="center"){if(this._center=this._startLatLng,se===1)return}else{var Se=S._add(V)._divideBy(2)._subtract(this._centerPoint);if(se===1&&Se.x===0&&Se.y===0)return;this._center=p.unproject(p.project(this._pinchStartLatLng,this._zoom).subtract(Se),this._zoom)}this._moved||(p._moveStart(!0,!1),this._moved=!0),D(this._animRequest);var st=o(p._move,p,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=T(st,this,!0),Er(a)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,D(this._animRequest),zr(document,"touchmove",this._onTouchMove,this),zr(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Zr.addInitHook("addHandler","touchZoom",Io),Zr.BoxZoom=pr,Zr.DoubleClickZoom=Sa,Zr.Drag=Ea,Zr.Keyboard=Zs,Zr.ScrollWheelZoom=as,Zr.TapHold=Do,Zr.TouchZoom=Io,t.Bounds=Te,t.Browser=mt,t.CRS=pe,t.Canvas=Is,t.Circle=$o,t.CircleMarker=gs,t.Class=$,t.Control=lr,t.DivIcon=aa,t.DivOverlay=ss,t.DomEvent=Tl,t.DomUtil=vr,t.Draggable=Hs,t.Evented=oe,t.FeatureGroup=rs,t.GeoJSON=Uo,t.GridLayer=Kr,t.Handler=vi,t.Icon=na,t.ImageOverlay=An,t.LatLng=ue,t.LatLngBounds=H,t.Layer=Ur,t.LayerGroup=zo,t.LineUtil=$r,t.Map=Zr,t.Marker=wo,t.Mixin=Ju,t.Path=Ns,t.Point=ie,t.PolyUtil=ll,t.Polygon=Po,t.Polyline=os,t.Popup=Zi,t.PosAnimation=Xl,t.Projection=_i,t.Rectangle=qo,t.Renderer=$i,t.SVG=xo,t.SVGOverlay=bi,t.TileLayer=No,t.Tooltip=La,t.Transformation=Me,t.Util=B,t.VideoOverlay=xr,t.bind=o,t.bounds=Y,t.canvas=ms,t.circle=is,t.circleMarker=cl,t.control=co,t.divIcon=la,t.extend=i,t.featureGroup=eu,t.geoJSON=Wt,t.geoJson=Nt,t.gridLayer=Ws,t.icon=xu,t.imageOverlay=Jn,t.latLng=le,t.latLngBounds=Q,t.layerGroup=ul,t.map=uo,t.marker=ra,t.point=Ce,t.polygon=ba,t.polyline=Xu,t.popup=oa,t.rectangle=vs,t.setOptions=k,t.stamp=f,t.svg=ji,t.svgOverlay=Bl,t.tileLayer=wi,t.tooltip=sa,t.transformation=Ue,t.version=r,t.videoOverlay=Wi;var Ks=window.L;t.noConflict=function(){return window.L=Ks,this},window.L=t})})(a1,a1.exports);var jt=a1.exports;const qn=fy(jt);var ob={exports:{}};(function(e,n){(function(t,r){r(n)})(ea,function(t){var r=typeof window<"u"?window:typeof ea<"u"?ea:typeof self<"u"?self:{};function i(d,m){return d(m={exports:{}},m.exports),m.exports}var s=i(function(d,m){(function(_){const w={escape:function(W){return W.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},parseExtension:y,mimeType:function(W){return W=y(W).toLowerCase(),function(){var G="application/font-woff",oe="image/jpeg";return{woff:G,woff2:G,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:oe,jpeg:oe,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}()[W]||""},dataAsUrl:function(W,G){return`data:${G};base64,`+W},isDataUrl:function(W){return W.search(/^(data:)/)!==-1},canvasToBlob:function(W){return W.toBlob?new Promise(function(oe){W.toBlob(oe)}):(G=W,new Promise(function(oe){const ie=ve(G.toDataURL().split(",")[1]);var we=ie.length;const Ce=new Uint8Array(we);for(let Te=0;Te<we;Te++)Ce[Te]=ie.charCodeAt(Te);oe(new Blob([Ce],{type:"image/png"}))}));var G},resolveUrl:function(W,G){const oe=document.implementation.createHTMLDocument(),ie=oe.createElement("base"),we=(oe.head.appendChild(ie),oe.createElement("a"));return oe.body.appendChild(we),ie.href=G,we.href=W,we.href},getAndEncode:function(W){let G=he.impl.urlCache.find(function(oe){return oe.url===W});return G||(G={url:W,promise:null},he.impl.urlCache.push(G)),G.promise===null&&(he.impl.options.cacheBust&&(W+=(/\?/.test(W)?"&":"?")+new Date().getTime()),G.promise=new Promise(function(oe){const ie=he.impl.options.httpTimeout,we=new XMLHttpRequest;let Ce;var Te;function Y(H){console.error(H),oe("")}we.onreadystatechange=function(){if(we.readyState===4)if(we.status!==200)Ce?oe(Ce):Y(`cannot fetch resource: ${W}, status: `+we.status);else{const H=new FileReader;H.onloadend=function(){var Q=H.result.split(/,/)[1];oe(Q)},H.readAsDataURL(we.response)}},we.ontimeout=function(){Ce?oe(Ce):Y(`timeout of ${ie}ms occured while fetching resource: `+W)},we.responseType="blob",we.timeout=ie,he.impl.options.useCredentials&&(we.withCredentials=!0),we.open("GET",W,!0),we.send(),he.impl.options.imagePlaceholder&&(Te=he.impl.options.imagePlaceholder.split(/,/))&&Te[1]&&(Ce=Te[1])})),G.promise},uid:function(){let W=0;return function(){return"u"+("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+W++}}(),delay:function(W){return function(G){return new Promise(function(oe){setTimeout(function(){oe(G)},W)})}},asArray:function(W){const G=[],oe=W.length;for(let ie=0;ie<oe;ie++)G.push(W[ie]);return G},escapeXhtml:function(W){return W.replace(/%/g,"%25").replace(/#/g,"%23").replace(/\n/g,"%0A")},makeImage:function(W){return W!=="data:,"?new Promise(function(G,oe){const ie=new Image;he.impl.options.useCredentials&&(ie.crossOrigin="use-credentials"),ie.onload=function(){G(ie)},ie.onerror=oe,ie.src=W}):Promise.resolve()},width:function(W){var G=M(W,"border-left-width"),oe=M(W,"border-right-width");return W.scrollWidth+G+oe},height:function(W){var G=M(W,"border-top-width"),oe=M(W,"border-bottom-width");return W.scrollHeight+G+oe}};function y(W){return(W=/\.([^\.\/]*?)(\?|$)/g.exec(W))?W[1]:""}function M(W,G){const oe=fe(W).getPropertyValue(G);return parseFloat(oe.replace("px",""))}const k=function(){const W=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(we,Ce,Te){return G(we)?Promise.resolve(we).then(oe).then(function(Y){let H=Promise.resolve(we);return Y.forEach(function(Q){H=H.then(function(ue){return ie(ue,Q,Ce,Te)})}),H}):Promise.resolve(we)},shouldProcess:G,impl:{readUrls:oe,inline:ie}};function G(we){return we.search(W)!==-1}function oe(we){const Ce=[];for(var Te;(Te=W.exec(we))!==null;)Ce.push(Te[1]);return Ce.filter(function(Y){return!w.isDataUrl(Y)})}function ie(we,Ce,Te,Y){return Promise.resolve(Ce).then(function(H){return Te?w.resolveUrl(H,Te):H}).then(Y||w.getAndEncode).then(function(H){return w.dataAsUrl(H,w.mimeType(Ce))}).then(function(H){return we.replace((Q=Ce,new RegExp(`(url\\(['"]?)(${w.escape(Q)})(['"]?\\))`,"g")),`$1${H}$3`);var Q})}}(),F={resolveAll:function(){return I().then(function(W){return Promise.all(W.map(function(G){return G.resolve()}))}).then(function(W){return W.join(`
`)})},impl:{readAll:I}};function I(){return Promise.resolve(w.asArray(document.styleSheets)).then(function(G){const oe=[];return G.forEach(function(ie){if(Object.getPrototypeOf(ie).hasOwnProperty("cssRules"))try{w.asArray(ie.cssRules||[]).forEach(oe.push.bind(oe))}catch(we){console.log("Error while reading CSS rules from "+ie.href,we.toString())}}),oe}).then(function(G){return G.filter(function(oe){return oe.type===CSSRule.FONT_FACE_RULE}).filter(function(oe){return k.shouldProcess(oe.style.getPropertyValue("src"))})}).then(function(G){return G.map(W)});function W(G){return{resolve:function(){var oe=(G.parentStyleSheet||{}).href;return k.inlineAll(G.cssText,oe)},src:function(){return G.style.getPropertyValue("src")}}}}const R={inlineAll:function W(G){return G instanceof Element?function(oe){const ie=oe.style.getPropertyValue("background");return ie?k.inlineAll(ie).then(function(we){oe.style.setProperty("background",we,ie)}).then(function(){return oe}):Promise.resolve(oe)}(G).then(function(){return G instanceof HTMLImageElement?K(G).inline():Promise.all(w.asArray(G.childNodes).map(function(oe){return W(oe)}))}):Promise.resolve(G)},impl:{newImage:K}};function K(W){return{inline:function(G){return w.isDataUrl(W.src)?Promise.resolve():Promise.resolve(W.src).then(G||w.getAndEncode).then(function(oe){return w.dataAsUrl(oe,w.mimeType(W.src))}).then(function(oe){return new Promise(function(ie){W.onload=ie,W.onerror=ie,W.src=oe})})}}}const ee={imagePlaceholder:void 0,cacheBust:!1,useCredentials:!1},he={toSvg:z,toPng:function(W,G){return(G=G||{}).raster=!0,U(W,G).then(function(oe){return oe.toDataURL()})},toJpeg:function(W,G){return(G=G||{}).raster=!0,U(W,G).then(function(oe){return oe.toDataURL("image/jpeg",G.quality||1)})},toBlob:function(W,G){return(G=G||{}).raster=!0,U(W,G).then(w.canvasToBlob)},toPixelData:function(W,G){return(G=G||{}).raster=!0,U(W,G).then(function(oe){return oe.getContext("2d").getImageData(0,0,w.width(W),w.height(W)).data})},toCanvas:function(W,G){return(G=G||{}).raster=!0,U(W,G||{})},impl:{fontFaces:F,images:R,util:w,inliner:k,urlCache:[],options:{}}},fe=(d.exports=he,_.getComputedStyle||window.getComputedStyle),ve=_.atob||window.atob;function z(W,G){var oe=G=G||{};return oe.imagePlaceholder===void 0?he.impl.options.imagePlaceholder=ee.imagePlaceholder:he.impl.options.imagePlaceholder=oe.imagePlaceholder,oe.cacheBust===void 0?he.impl.options.cacheBust=ee.cacheBust:he.impl.options.cacheBust=oe.cacheBust,oe.useCredentials===void 0?he.impl.options.useCredentials=ee.useCredentials:he.impl.options.useCredentials=oe.useCredentials,Promise.resolve(W).then(function(ie){return function we(Ce,Te,Y,H,Q=null){return Y||!Te||Te(Ce)?Promise.resolve(Ce).then(function(ue){return ue instanceof HTMLCanvasElement?w.makeImage(ue.toDataURL()):ue.nodeName==="IFRAME"?html2canvas(ue.contentDocument.body).then(le=>le.toDataURL()).then(w.makeImage):ue.cloneNode(!1)}).then(function(ue){return function(le,pe){const Z=le.childNodes;return Z.length===0?Promise.resolve(pe):function(N,ke){const Me=fe(le);let Ue=Promise.resolve();return ke.forEach(function(ce){Ue=Ue.then(function(){return we(ce,Te,!1,H,Me)}).then(function(ne){ne&&N.appendChild(ne)})}),Ue}(pe,w.asArray(Z)).then(function(){return pe})}(Ce,ue)}).then(function(ue){return function(le,pe,Z){return pe instanceof Element?Promise.resolve().then(function(){(function(N,ke){const Me=fe(N);Me.cssText?(ke.style.cssText=Me.cssText,function(Ue,ce){ce.font=Ue.font,ce.fontFamily=Ue.fontFamily,ce.fontFeatureSettings=Ue.fontFeatureSettings,ce.fontKerning=Ue.fontKerning,ce.fontSize=Ue.fontSize,ce.fontStretch=Ue.fontStretch,ce.fontStyle=Ue.fontStyle,ce.fontVariant=Ue.fontVariant,ce.fontVariantCaps=Ue.fontVariantCaps,ce.fontVariantEastAsian=Ue.fontVariantEastAsian,ce.fontVariantLigatures=Ue.fontVariantLigatures,ce.fontVariantNumeric=Ue.fontVariantNumeric,ce.fontVariationSettings=Ue.fontVariationSettings,ce.fontWeight=Ue.fontWeight}(Me,ke.style)):(Z?function(Ue,ce,ne,ye){const de=ne.style,We=Ue.style;for(var Ge of ce){var tt=ce.getPropertyValue(Ge),Ze=We.getPropertyValue(Ge),et=(We.setProperty(Ge,ye?"initial":"unset"),ce.getPropertyValue(Ge));et!==tt?de.setProperty(Ge,tt):de.removeProperty(Ge),We.setProperty(Ge,Ze)}}(N,Me,ke,Y):function(Ue,ce,ne){const ye=function(We){if($[We])return $[We];B||((B=document.createElement("iframe")).style.visibility="hidden",B.style.position="fixed",document.body.appendChild(B),B.contentWindow.document.write('<!DOCTYPE html><meta charset="UTF-8"><title>sandbox</title><body>'));const Ge=document.createElement(We),tt=(B.contentWindow.document.body.appendChild(Ge),Ge.textContent=".",B.contentWindow.getComputedStyle(Ge)),Ze={};return w.asArray(tt).forEach(function(et){Ze[et]=et==="width"||et==="height"?"auto":tt.getPropertyValue(et)}),B.contentWindow.document.body.removeChild(Ge),$[We]=Ze}(ne.tagName),de=ne.style;w.asArray(Ue).forEach(function(We){var Ge=Ue.getPropertyValue(We);(Ge!==ye[We]||ce&&Ge!==ce.getPropertyValue(We))&&de.setProperty(We,Ge,Ue.getPropertyPriority(We))})}(Me,Q,ke),Y&&(["inset-block","inset-block-start","inset-block-end"].forEach(Ue=>ke.style.removeProperty(Ue)),["left","right","top","bottom"].forEach(Ue=>{ke.style.getPropertyValue(Ue)&&ke.style.setProperty(Ue,"0px")})))})(le,pe)}).then(function(){[":before",":after"].forEach(function(N){(function(ke){const Me=fe(le,ke),Ue=Me.getPropertyValue("content");if(Ue!==""&&Ue!=="none"){const ce=w.uid(),ne=pe.getAttribute("class"),ye=(ne&&pe.setAttribute("class",ne+" "+ce),document.createElement("style"));ye.appendChild(function(){const de=`.${ce}:`+ke,We=(Me.cssText?function(){return`${Me.cssText} content: ${Me.getPropertyValue("content")};`}:function(){return w.asArray(Me).map(function(Ge){return Ge+": "+Me.getPropertyValue(Ge)+(Me.getPropertyPriority(Ge)?" !important":"")}).join("; ")+";"})();return document.createTextNode(de+`{${We}}`)}()),pe.appendChild(ye)}})(N)})}).then(function(){le instanceof HTMLTextAreaElement&&(pe.innerHTML=le.value),le instanceof HTMLInputElement&&pe.setAttribute("value",le.value)}).then(function(){pe instanceof SVGElement&&(pe.setAttribute("xmlns","http://www.w3.org/2000/svg"),pe instanceof SVGRectElement&&["width","height"].forEach(function(N){const ke=pe.getAttribute(N);ke&&pe.style.setProperty(N,ke)}))}).then(function(){return pe}):pe}(Ce,ue,H)}):Promise.resolve()}(ie,G.filter,!0,!G.raster)}).then(J).then(T).then(function(ie){G.bgcolor&&(ie.style.backgroundColor=G.bgcolor),G.width&&(ie.style.width=G.width+"px"),G.height&&(ie.style.height=G.height+"px"),G.style&&Object.keys(G.style).forEach(function(Ce){ie.style[Ce]=G.style[Ce]});let we=null;return typeof G.onclone=="function"&&(we=G.onclone(ie)),Promise.resolve(we).then(function(){return ie})}).then(function(ie){return ie=ie,we=G.width||w.width(W),Ce=G.height||w.height(W),Promise.resolve(ie).then(function(Te){return Te.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(Te)}).then(w.escapeXhtml).then(function(Te){return`<foreignObject x="0" y="0" width="100%" height="100%">${Te}</foreignObject>`}).then(function(Te){return`<svg xmlns="http://www.w3.org/2000/svg" width="${we}" height="${Ce}">${Te}</svg>`}).then(function(Te){return"data:image/svg+xml;charset=utf-8,"+Te});var we,Ce}).then(function(ie){return he.impl.urlCache=[],ie})}function U(W,G){return z(W,G).then(w.makeImage).then(w.delay(0)).then(function(oe){var ie=typeof G.scale!="number"?1:G.scale;const we=function(Te,Y){const H=document.createElement("canvas");if(H.width=(G.width||w.width(Te))*Y,H.height=(G.height||w.height(Te))*Y,G.bgcolor){const Q=H.getContext("2d");Q.fillStyle=G.bgcolor,Q.fillRect(0,0,H.width,H.height)}return H}(W,ie),Ce=we.getContext("2d");return Ce.mozImageSmoothingEnabled=!1,Ce.msImageSmoothingEnabled=!1,Ce.imageSmoothingEnabled=!1,oe&&(Ce.scale(ie,ie),Ce.drawImage(oe,0,0)),B&&(document.body.removeChild(B),B=null,D&&clearTimeout(D),D=setTimeout(()=>{D=null,$={}},2e4)),we})}function J(W){return F.resolveAll().then(function(G){const oe=document.createElement("style");return W.appendChild(oe),oe.appendChild(document.createTextNode(G)),W})}function T(W){return R.inlineAll(W).then(function(){return W})}let D=null,B=null,$={}})(r)}),o=i(function(d,m){(function(){function _(F,I,R){var K=new XMLHttpRequest;K.open("GET",F),K.responseType="blob",K.onload=function(){k(K.response,I,R)},K.onerror=function(){console.error("could not download file")},K.send()}function w(F){var I=new XMLHttpRequest;I.open("HEAD",F,!1);try{I.send()}catch{}return 200<=I.status&&299>=I.status}function y(F){try{F.dispatchEvent(new MouseEvent("click"))}catch{var I=document.createEvent("MouseEvents");I.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),F.dispatchEvent(I)}}var M=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof r=="object"&&r.global===r?r:void 0,k=M.saveAs||(typeof window!="object"||window!==M?function(){}:"download"in HTMLAnchorElement.prototype?function(F,I,R){var K=M.URL||M.webkitURL,ee=document.createElement("a");I=I||F.name||"download",ee.download=I,ee.rel="noopener",typeof F=="string"?(ee.href=F,ee.origin===location.origin?y(ee):w(ee.href)?_(F,I,R):y(ee,ee.target="_blank")):(ee.href=K.createObjectURL(F),setTimeout(function(){K.revokeObjectURL(ee.href)},4e4),setTimeout(function(){y(ee)},0))}:"msSaveOrOpenBlob"in navigator?function(F,I,R){if(I=I||F.name||"download",typeof F!="string")navigator.msSaveOrOpenBlob(function(ee,he){return he===void 0?he={autoBom:!1}:typeof he!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),he={autoBom:!he}),he.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(ee.type)?new Blob(["\uFEFF",ee],{type:ee.type}):ee}(F,R),I);else if(w(F))_(F,I,R);else{var K=document.createElement("a");K.href=F,K.target="_blank",setTimeout(function(){y(K)})}}:function(F,I,R,K){if((K=K||open("","_blank"))&&(K.document.title=K.document.body.innerText="downloading..."),typeof F=="string")return _(F,I,R);var ee=F.type==="application/octet-stream",he=/constructor/i.test(M.HTMLElement)||M.safari,fe=/CriOS\/[\d]+/.test(navigator.userAgent);if((fe||ee&&he)&&typeof FileReader=="object"){var ve=new FileReader;ve.onloadend=function(){var J=ve.result;J=fe?J:J.replace(/^data:[^;]*;/,"data:attachment/file;"),K?K.location.href=J:location=J,K=null},ve.readAsDataURL(F)}else{var z=M.URL||M.webkitURL,U=z.createObjectURL(F);K?K.location=U:location.href=U,K=null,setTimeout(function(){z.revokeObjectURL(U)},4e4)}});M.saveAs=k.saveAs=k,d.exports=k})()}),u=L.Control.extend({options:{cropImageByInnerWH:!0,hidden:!1,domtoimageOptions:{},position:"topleft",screenName:"screen",iconUrl:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/PjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDMyIDMyIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAzMiAzMjsiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxnPjxnIGlkPSJjYW1lcmEiPjxwYXRoIHN0eWxlPSJmaWxsOiMwMTAwMDI7IiBkPSJNMTYsOS41MDFjLTQuNDE5LDAtOCwzLjU4MS04LDhjMCw0LjQxOCwzLjU4MSw4LDgsOGM0LjQxOCwwLDgtMy41ODIsOC04UzIwLjQxOCw5LjUwMSwxNiw5LjUwMXogTTIwLjU1NSwyMS40MDZjLTIuMTU2LDIuNTE2LTUuOTQzLDIuODA3LTguNDU5LDAuNjVjLTIuNTE3LTIuMTU2LTIuODA3LTUuOTQ0LTAuNjUtOC40NTljMi4xNTUtMi41MTcsNS45NDMtMi44MDcsOC40NTktMC42NUMyMi40MiwxNS4xMDIsMjIuNzExLDE4Ljg5MSwyMC41NTUsMjEuNDA2eiIvPjxwYXRoIHN0eWxlPSJmaWxsOiMwMTAwMDI7IiBkPSJNMTYsMTMuNTAxYy0yLjIwOSwwLTMuOTk5LDEuNzkxLTQsMy45OTl2MC4wMDJjMCwwLjI3NSwwLjIyNCwwLjUsMC41LDAuNXMwLjUtMC4yMjUsMC41LTAuNVYxNy41YzAuMDAxLTEuNjU2LDEuMzQzLTIuOTk5LDMtMi45OTljMC4yNzYsMCwwLjUtMC4yMjQsMC41LTAuNVMxNi4yNzYsMTMuNTAxLDE2LDEzLjUwMXoiLz48cGF0aCBzdHlsZT0iZmlsbDojMDEwMDAyOyIgZD0iTTI5LjQ5Miw4LjU0MmwtNC4zMzQtMC43MjNsLTEuMzczLTMuNDM0QzIzLjMyNiwzLjI0LDIyLjIzMiwyLjUsMjEsMi41SDExYy0xLjIzMiwwLTIuMzI2LDAuNzQtMi43ODYsMS44ODZMNi44NDIsNy44MTlMMi41MDksOC41NDJDMS4wNTUsOC43ODMsMCwxMC4wMjcsMCwxMS41djE1YzAsMS42NTQsMS4zNDYsMywzLDNoMjZjMS42NTQsMCwzLTEuMzQ2LDMtM3YtMTVDMzIsMTAuMDI3LDMwLjk0NSw4Ljc4MywyOS40OTIsOC41NDJ6IE0zMCwyNi41YzAsMC41NTMtMC40NDcsMS0xLDFIM2MtMC41NTMsMC0xLTAuNDQ3LTEtMXYtMTVjMC0wLjQ4OSwwLjM1NC0wLjkwNiwwLjgzNi0wLjk4Nkw4LjI4LDkuNjA3bDEuNzkxLTQuNDc4QzEwLjIyNCw0Ljc1LDEwLjU5MSw0LjUsMTEsNC41aDEwYzAuNDA4LDAsMC43NzUsMC4yNDksMC45MjgsMC42MjlsMS43OTEsNC40NzhsNS40NDUsMC45MDdDMjkuNjQ2LDEwLjU5NCwzMCwxMS4wMTEsMzAsMTEuNVYyNi41eiIvPjwvZz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PC9zdmc+",hideElementsWithSelectors:[".leaflet-control-container"],onCropBorderSize:2,caption:null,captionFontSize:15,captionFont:"Arial",captionColor:"black",captionBgColor:"white",captionOffset:5,mimeType:"image/png",debugMode:!1,preventDownload:!1,onPixelDataFail:function(d){var m=d.node,_=d.error;return console.warn("Map node is very big "+m.scrollWidth+"x"+m.scrollHeight),console.warn(`Add function: SimpleMapScreenshoter({
              onPixelDataFail: function({ node, plugin, error, mapPane, domtoimageOptions }) {
                 // Solutions:
                 // decrease size of map
                 // or decrease zoom level
                 // or remove elements with big distanses
                 // and after that return image in Promise - plugin._getPixelDataOfNormalMap
                 return plugin._getPixelDataOfNormalMap(domtoimageOptions)
              }
            })`),Promise.reject(_)}},onAdd:function(){return this._container=L.DomUtil.create("div","leaflet-control-simpleMapScreenshoter"),this._link=null,this._screenState={status:1,promise:null},this.options.hidden===!1&&this._addScreenBtn(),this._onUserStartInteractWithMap=this._onUserStartInteractWithMap.bind(this),this._onUserEndInteractWithMap=this._onUserEndInteractWithMap.bind(this),this._map.on("zoomstart",this._onUserStartInteractWithMap),this._map.on("move",this._onUserStartInteractWithMap),this._map.on("zoomend",this._onUserEndInteractWithMap),this._map.on("moveend",this._onUserEndInteractWithMap),this._container},takeScreen:function(){var d=this,m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"blob",_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},w={};for(var y in this.options)_.hasOwnProperty(y)?w[y]=_[y]:w[y]=this.options[y];return this._screenState.status===2?this._screenState.promise:(this._map.fire("simpleMapScreenshoter.takeScreen"),this._screenState.status=2,this._setElementsVisible(!1),this._screenState.promise=this._waitEndOfInteractions().then(function(){return d._getPixelData(w)}).then(function(M){return d._setElementsVisible(!0),d._toCanvas(M,w)}).then(function(M){return m==="image"?d._canvasToImage(M,w):m==="canvas"?M:d._canvasToBlob(M,w)}).then(function(M){return d._screenState.status=1,d._map.fire("simpleMapScreenshoter.done"),M}).catch(function(M){return d._setElementsVisible(!0),d._screenState.status=1,d._map.fire("simpleMapScreenshoter.error",{e:M}),Promise.reject(M)}),this._screenState.promise)},_setElementsVisible:function(){var d=this,m=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.options.hideElementsWithSelectors.forEach(function(_){var w=d._map._container.querySelectorAll(_),y=!0,M=!1,k=void 0;try{for(var F,I=w[Symbol.iterator]();!(y=(F=I.next()).done);y=!0)F.value.style.opacity=m===!1?0:1}catch(R){M=!0,k=R}finally{try{!y&&I.return&&I.return()}finally{if(M)throw k}}})},_canvasToImage:function(d,m){var _=m.mimeType,w=d.toDataURL(_);return w.indexOf("base64")===-1?Promise.reject(new Error("Base64 image generation error")):Promise.resolve(w)},_canvasToBlob:function(d,m){var _=m.mimeType;return new Promise(function(w,y){d.toBlob(function(M){w(M)},_)})},_toCanvas:function(d,m){var _=m.captionOffset,w=m.caption,y=m.captionFontSize,M=m.captionFont,k=m.captionColor,F=m.captionBgColor,I=this._node,R=I.screenHeight,K=I.screenWidth,ee=document.createElement("canvas");ee.width=K,ee.height=R;for(var he=ee.getContext("2d"),fe=he.createImageData(K,R),ve=0;ve<d.length;++ve)fe.data[ve]=d[ve];he.putImageData(fe,0,0),fe=null;var z=document.createElement("canvas"),U=z.getContext("2d"),J=0,T=0,D=R,B=K;if(this.options.cropImageByInnerWH===!0){for(var $=[],W=0,G=0;G<R;++G){W=0;for(var oe=0;oe<K;++oe)d[4*G*K+4*oe+4]===0&&W++;W===K&&$.push(G)}var ie=this._getMinAndMaxOnValuesBreak($);J=ie.min;for(var we=K,Ce=ie.max,Te=[],Y=0,H=T;H<we;++H){Y=0;for(var Q=0;Q<R;++Q)d[4*Q*K+4*H+4]===0&&Y++;Y===R&&Te.push(H)}var ue=this._getMinAndMaxOnValuesBreak(Te);T=ue.min,we=ue.max,(T===0&&we===0||we===null)&&(we=K),(J===0&&Ce===0||Ce===null)&&(Ce=R),this.options.debugMode===!0&&(console.log("emptyYLine",$),console.log("minMaxY",ie),console.log("emptyXLine",Te),console.log("minMaxX",ue),console.log("debugX",{}),console.log("debugY",{})),J===0&&Ce===R&&T===0&&we===K||(J+=this.options.onCropBorderSize,Ce-=this.options.onCropBorderSize,T+=this.options.onCropBorderSize,we-=this.options.onCropBorderSize),D=Ce-J,B=we-T,z.width=B,z.height=D}else z.width=B,z.height=D;var le=null;return w&&(le=typeof w=="function"?w.call(this):w),le!==null&&(z.height=z.height+(_+y+_),U.beginPath(),U.rect(0,0,z.width,z.height),U.fillStyle=F,U.fill(),U.save()),U.drawImage(ee,T,J,B,D,0,0,B,D),le!==null&&(U.font=y+"px "+M,U.fillStyle=k,U.fillText(le,_,D+_+y)),Promise.resolve(z)},_getMinAndMaxOnValuesBreak:function(d){for(var m=0,_=0,w=!1,y=1;y<d.length;y++){if(d[y]-1!==d[y-1]){_=d[y],w=!0;break}m=d[y]}return w===!1&&d[0]>1?(m=0,_=d[0]):w===!1&&(m=d[d.length-1]||0,_=null),{min:m,max:_}},_getPixelData:function(d){var m=this,_=d.domtoimageOptions,w=_===void 0?{}:_;return this._getPixelDataOfNormalMap(w).catch(function(y){return console.warn("May be map size very big on that zoom level, we have error:",y.toString()),console.warn("You can manually hide map elements with large distances between them for fix that warn"),m._getPixelDataOfBigMap(w)})},_getPixelDataOfNormalMap:function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},m=this._map.getContainer();return this._node={node:m,screenHeight:m.scrollHeight,screenWidth:m.scrollWidth},s.toPixelData(m,d)},_getPixelDataOfBigMap:function(){var d=this,m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=this._map.getContainer(),w=this._map.getPane("mapPane");w.style.width=2*_.clientWidth+"px",w.style.height=2*_.clientHeight+"px",w.style.overflow="hidden";var y=function(){w.style.width="initial",w.style.height="initial",w.style.overflow="initial"};return this._node={node:_,screenHeight:_.scrollHeight,screenWidth:_.scrollWidth},s.toPixelData(_,m).then(function(M){return y(),M}).catch(function(M){return y(),_.scrollHeight>=4e3||_.scrollWidth>=4e3?d.options.onPixelDataFail({plugin:d,node:_,mapPane:w,error:M,domtoimageOptions:m}):Promise.reject(M)})},_addScreenBtn:function(){this._link=L.DomUtil.create("a","leaflet-control-simpleMapScreenshoter-btn",this._container),this._addCss(),L.DomEvent.addListener(this._link,"click",this._onScreenBtn,this),L.DomEvent.disableClickPropagation(this._link)},_addCss:function(){var d=`
    .leaflet-control-simpleMapScreenshoter{
       border: 2px solid rgba(0,0,0,0.2);
       background-clip: padding-box;
    }
    .leaflet-control-simpleMapScreenshoter a{
       background-color: #fff;
       border-bottom: 1px solid #ccc;
       width: 30px;
       height: 30px;
       line-height: 30px;
       display: block;
       text-align: center;
       text-decoration: none;
       color: black;
       overflow: hidden;
       border-radius: 2px;
       background-image: url('`+this.options.iconUrl+`');
       background-position: 46% 41%;
       background-repeat: no-repeat;
       background-size: 63%;
    }
    .leaflet-control-simpleMapScreenshoter a:hover{
       cursor: pointer;
    }
    `,m=document.head||document.getElementsByTagName("head")[0],_=document.createElement("style");_.appendChild(document.createTextNode(d)),m.appendChild(_)},_onScreenBtn:function(){var d=this;this._map.fire("simpleMapScreenshoter.click"),this.options.preventDownload||this.takeScreen().then(function(m){var _=typeof d.options.screenName=="function"?d.options.screenName.call(d):d.options.screenName;o.saveAs(m,_+".png")}).catch(function(m){d._map.fire("simpleMapScreenshoter.error",{e:m})})},_onUserStartInteractWithMap:function(){this._interaction=!0},_onUserEndInteractWithMap:function(){this._interaction=!1},_waitEndOfInteractions:function(){var d=this;return new Promise(function(m){var _=setInterval(function(){d._interaction||(m(),clearInterval(_))},100)})}}),f=(L.Control.SimpleMapScreenshoter=u,L.simpleMapScreenshoter=function(d){return new L.Control.SimpleMapScreenshoter(d)},u);t.default=f,t.SimpleMapScreenshoter=u,Object.defineProperty(t,"__esModule",{value:!0})})})(ob,ob.exports);var Xa=63710088e-1,ex={centimeters:Xa*100,centimetres:Xa*100,degrees:360/(2*Math.PI),feet:Xa*3.28084,inches:Xa*39.37,kilometers:Xa/1e3,kilometres:Xa/1e3,meters:Xa,metres:Xa,miles:Xa/1609.344,millimeters:Xa*1e3,millimetres:Xa*1e3,nauticalmiles:Xa/1852,radians:1,yards:Xa*1.0936};function ud(e,n,t={}){const r={type:"Feature"};return(t.id===0||t.id)&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.properties=n||{},r.geometry=e,r}function dm(e,n,t={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!sb(e[0])||!sb(e[1]))throw new Error("coordinates must contain numbers");return ud({type:"Point",coordinates:e},n,t)}function hu(e,n,t={}){for(const i of e){if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(i[i.length-1].length!==i[0].length)throw new Error("First and last Position are not equivalent.");for(let s=0;s<i[i.length-1].length;s++)if(i[i.length-1][s]!==i[0][s])throw new Error("First and last Position are not equivalent.")}return ud({type:"Polygon",coordinates:e},n,t)}function du(e,n,t={}){if(e.length<2)throw new Error("coordinates must be an array of two or more positions");return ud({type:"LineString",coordinates:e},n,t)}function B7(e,n={}){const t={type:"FeatureCollection"};return n.id&&(t.id=n.id),n.bbox&&(t.bbox=n.bbox),t.features=e,t}function R7(e,n,t={}){return ud({type:"MultiPolygon",coordinates:e},n,t)}function F7(e,n="kilometers"){const t=ex[n];if(!t)throw new Error(n+" units is invalid");return e*t}function j7(e,n="kilometers"){const t=ex[n];if(!t)throw new Error(n+" units is invalid");return e/t}function l1(e){return e%(2*Math.PI)*180/Math.PI}function Uu(e){return e%360*Math.PI/180}function sb(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function ab(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function z7(e){return e.type==="Feature"?e.geometry:e}function tx(e,n,t={}){if(t.final===!0)return $7(e,n);const r=ab(e),i=ab(n),s=Uu(r[0]),o=Uu(i[0]),u=Uu(r[1]),f=Uu(i[1]),d=Math.sin(o-s)*Math.cos(f),m=Math.cos(u)*Math.sin(f)-Math.sin(u)*Math.cos(f)*Math.cos(o-s);return l1(Math.atan2(d,m))}function $7(e,n){let t=tx(n,e);return t=(t+180)%360,t}function U7(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function hy(e,n,t,r={}){const i=U7(e),s=Uu(i[0]),o=Uu(i[1]),u=Uu(t),f=j7(n,r.units),d=Math.asin(Math.sin(o)*Math.cos(f)+Math.cos(o)*Math.sin(f)*Math.cos(u)),m=s+Math.atan2(Math.sin(u)*Math.sin(f)*Math.cos(o),Math.cos(f)-Math.sin(o)*Math.sin(d)),_=l1(m),w=l1(d);return dm([_,w],r.properties)}var lb=hy;function ub(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function dy(e,n,t={}){var r=ub(e),i=ub(n),s=Uu(i[1]-r[1]),o=Uu(i[0]-r[0]),u=Uu(r[1]),f=Uu(i[1]),d=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(o/2),2)*Math.cos(u)*Math.cos(f);return F7(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)),t.units)}var nv=dy;function V7(e,n,t={}){const i=z7(e).coordinates;let s=0;for(let o=0;o<i.length&&!(n>=s&&o===i.length-1);o++)if(s>=n){const u=n-s;if(u){const f=tx(i[o],i[o-1])-180;return hy(i[o],u,f,t)}else return dm(i[o])}else s+=dy(i[o],i[o+1],t);return dm(i[i.length-1])}var u1=V7;function G7(e,n){var t,r,i,s,o,u,f,d,m,_,w=0,y=e.type==="FeatureCollection",M=e.type==="Feature",k=y?e.features.length:1;for(t=0;t<k;t++){for(u=y?e.features[t].geometry:M?e.geometry:e,d=y?e.features[t].properties:M?e.properties:{},m=y?e.features[t].bbox:M?e.bbox:void 0,_=y?e.features[t].id:M?e.id:void 0,f=u?u.type==="GeometryCollection":!1,o=f?u.geometries.length:1,i=0;i<o;i++){if(s=f?u.geometries[i]:u,s===null){if(n(null,w,d,m,_)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(n(s,w,d,m,_)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<s.geometries.length;r++)if(n(s.geometries[r],w,d,m,_)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}w++}}function H7(e,n,t){var r=t;return G7(e,function(i,s,o,u,f){s===0&&t===void 0?r=i:r=n(r,i,s,o,u,f)}),r}function nx(e){return H7(e,(n,t)=>n+q7(t),0)}function q7(e){let n=0,t;switch(e.type){case"Polygon":return cb(e.coordinates);case"MultiPolygon":for(t=0;t<e.coordinates.length;t++)n+=cb(e.coordinates[t]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function cb(e){let n=0;if(e&&e.length>0){n+=Math.abs(fb(e[0]));for(let t=1;t<e.length;t++)n-=Math.abs(fb(e[t]))}return n}var W7=Xa*Xa/2,rv=Math.PI/180;function fb(e){const n=e.length-1;if(n<=2)return 0;let t=0,r=0;for(;r<n;){const i=e[r],s=e[r+1===n?0:r+1],o=e[r+2>=n?(r+2)%n:r+2],u=i[0]*rv,f=s[1]*rv,d=o[0]*rv;t+=(d-u)*Math.sin(f),r++}return t*W7}var oc=nx;function rx(e,n,t){if(e!==null)for(var r,i,s,o,u,f,d,m=0,_=0,w,y=e.type,M=y==="FeatureCollection",k=y==="Feature",F=M?e.features.length:1,I=0;I<F;I++){d=M?e.features[I].geometry:k?e.geometry:e,w=d?d.type==="GeometryCollection":!1,u=w?d.geometries.length:1;for(var R=0;R<u;R++){var K=0,ee=0;if(o=w?d.geometries[R]:d,o!==null){f=o.coordinates;var he=o.type;switch(m=he==="Polygon"||he==="MultiPolygon"?1:0,he){case null:break;case"Point":if(n(f,_,I,K,ee)===!1)return!1;_++,K++;break;case"LineString":case"MultiPoint":for(r=0;r<f.length;r++){if(n(f[r],_,I,K,ee)===!1)return!1;_++,he==="MultiPoint"&&K++}he==="LineString"&&K++;break;case"Polygon":case"MultiLineString":for(r=0;r<f.length;r++){for(i=0;i<f[r].length-m;i++){if(n(f[r][i],_,I,K,ee)===!1)return!1;_++}he==="MultiLineString"&&K++,he==="Polygon"&&ee++}he==="Polygon"&&K++;break;case"MultiPolygon":for(r=0;r<f.length;r++){for(ee=0,i=0;i<f[r].length;i++){for(s=0;s<f[r][i].length-m;s++){if(n(f[r][i][s],_,I,K,ee)===!1)return!1;_++}ee++}K++}break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(rx(o.geometries[r],n)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Z7(e,n={}){let t=0,r=0,i=0;return rx(e,function(s){t+=s[0],r+=s[1],i++}),dm([t/i,r/i],n.properties)}var sp=Z7;function K7(e,n,t={}){const r=t.steps||64,i=t.properties?t.properties:!Array.isArray(e)&&e.type==="Feature"&&e.properties?e.properties:{},s=[];for(let o=0;o<r;o++)s.push(hy(e,n,o*-360/r,t).geometry.coordinates);return s.push(s[0]),hu([s],i)}var Y7=K7,J7=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,iv=Math.ceil,cu=Math.floor,_l="[BigNumber Error] ",hb=_l+"Number primitive has more than 15 significant digits: ",Nu=1e14,Xr=14,db=9007199254740991,ov=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],rf=1e7,$l=1e9;function ix(e){var n,t,r,i=R.prototype={constructor:R,toString:null,valueOf:null},s=new R(1),o=20,u=4,f=-7,d=21,m=-1e7,_=1e7,w=!1,y=1,M=0,k={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},F="0123456789abcdefghijklmnopqrstuvwxyz",I=!0;function R(z,U){var J,T,D,B,$,W,G,oe,ie=this;if(!(ie instanceof R))return new R(z,U);if(U==null){if(z&&z._isBigNumber===!0){ie.s=z.s,!z.c||z.e>_?ie.c=ie.e=null:z.e<m?ie.c=[ie.e=0]:(ie.e=z.e,ie.c=z.c.slice());return}if((W=typeof z=="number")&&z*0==0){if(ie.s=1/z<0?(z=-z,-1):1,z===~~z){for(B=0,$=z;$>=10;$/=10,B++);B>_?ie.c=ie.e=null:(ie.e=B,ie.c=[z]);return}oe=String(z)}else{if(!J7.test(oe=String(z)))return r(ie,oe,W);ie.s=oe.charCodeAt(0)==45?(oe=oe.slice(1),-1):1}(B=oe.indexOf("."))>-1&&(oe=oe.replace(".","")),($=oe.search(/e/i))>0?(B<0&&(B=$),B+=+oe.slice($+1),oe=oe.substring(0,$)):B<0&&(B=oe.length)}else{if(Yo(U,2,F.length,"Base"),U==10&&I)return ie=new R(z),fe(ie,o+ie.e+1,u);if(oe=String(z),W=typeof z=="number"){if(z*0!=0)return r(ie,oe,W,U);if(ie.s=1/z<0?(oe=oe.slice(1),-1):1,R.DEBUG&&oe.replace(/^0\.0*|\./,"").length>15)throw Error(hb+z)}else ie.s=oe.charCodeAt(0)===45?(oe=oe.slice(1),-1):1;for(J=F.slice(0,U),B=$=0,G=oe.length;$<G;$++)if(J.indexOf(T=oe.charAt($))<0){if(T=="."){if($>B){B=G;continue}}else if(!D&&(oe==oe.toUpperCase()&&(oe=oe.toLowerCase())||oe==oe.toLowerCase()&&(oe=oe.toUpperCase()))){D=!0,$=-1,B=0;continue}return r(ie,String(z),W,U)}W=!1,oe=t(oe,U,10,ie.s),(B=oe.indexOf("."))>-1?oe=oe.replace(".",""):B=oe.length}for($=0;oe.charCodeAt($)===48;$++);for(G=oe.length;oe.charCodeAt(--G)===48;);if(oe=oe.slice($,++G)){if(G-=$,W&&R.DEBUG&&G>15&&(z>db||z!==cu(z)))throw Error(hb+ie.s*z);if((B=B-$-1)>_)ie.c=ie.e=null;else if(B<m)ie.c=[ie.e=0];else{if(ie.e=B,ie.c=[],$=(B+1)%Xr,B<0&&($+=Xr),$<G){for($&&ie.c.push(+oe.slice(0,$)),G-=Xr;$<G;)ie.c.push(+oe.slice($,$+=Xr));$=Xr-(oe=oe.slice($)).length}else $-=G;for(;$--;oe+="0");ie.c.push(+oe)}}else ie.c=[ie.e=0]}R.clone=ix,R.ROUND_UP=0,R.ROUND_DOWN=1,R.ROUND_CEIL=2,R.ROUND_FLOOR=3,R.ROUND_HALF_UP=4,R.ROUND_HALF_DOWN=5,R.ROUND_HALF_EVEN=6,R.ROUND_HALF_CEIL=7,R.ROUND_HALF_FLOOR=8,R.EUCLID=9,R.config=R.set=function(z){var U,J;if(z!=null)if(typeof z=="object"){if(z.hasOwnProperty(U="DECIMAL_PLACES")&&(J=z[U],Yo(J,0,$l,U),o=J),z.hasOwnProperty(U="ROUNDING_MODE")&&(J=z[U],Yo(J,0,8,U),u=J),z.hasOwnProperty(U="EXPONENTIAL_AT")&&(J=z[U],J&&J.pop?(Yo(J[0],-1e9,0,U),Yo(J[1],0,$l,U),f=J[0],d=J[1]):(Yo(J,-1e9,$l,U),f=-(d=J<0?-J:J))),z.hasOwnProperty(U="RANGE"))if(J=z[U],J&&J.pop)Yo(J[0],-1e9,-1,U),Yo(J[1],1,$l,U),m=J[0],_=J[1];else if(Yo(J,-1e9,$l,U),J)m=-(_=J<0?-J:J);else throw Error(_l+U+" cannot be zero: "+J);if(z.hasOwnProperty(U="CRYPTO"))if(J=z[U],J===!!J)if(J)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))w=J;else throw w=!J,Error(_l+"crypto unavailable");else w=J;else throw Error(_l+U+" not true or false: "+J);if(z.hasOwnProperty(U="MODULO_MODE")&&(J=z[U],Yo(J,0,9,U),y=J),z.hasOwnProperty(U="POW_PRECISION")&&(J=z[U],Yo(J,0,$l,U),M=J),z.hasOwnProperty(U="FORMAT"))if(J=z[U],typeof J=="object")k=J;else throw Error(_l+U+" not an object: "+J);if(z.hasOwnProperty(U="ALPHABET"))if(J=z[U],typeof J=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(J))I=J.slice(0,10)=="0123456789",F=J;else throw Error(_l+U+" invalid: "+J)}else throw Error(_l+"Object expected: "+z);return{DECIMAL_PLACES:o,ROUNDING_MODE:u,EXPONENTIAL_AT:[f,d],RANGE:[m,_],CRYPTO:w,MODULO_MODE:y,POW_PRECISION:M,FORMAT:k,ALPHABET:F}},R.isBigNumber=function(z){if(!z||z._isBigNumber!==!0)return!1;if(!R.DEBUG)return!0;var U,J,T=z.c,D=z.e,B=z.s;e:if({}.toString.call(T)=="[object Array]"){if((B===1||B===-1)&&D>=-1e9&&D<=$l&&D===cu(D)){if(T[0]===0){if(D===0&&T.length===1)return!0;break e}if(U=(D+1)%Xr,U<1&&(U+=Xr),String(T[0]).length==U){for(U=0;U<T.length;U++)if(J=T[U],J<0||J>=Nu||J!==cu(J))break e;if(J!==0)return!0}}}else if(T===null&&D===null&&(B===null||B===1||B===-1))return!0;throw Error(_l+"Invalid BigNumber: "+z)},R.maximum=R.max=function(){return ee(arguments,-1)},R.minimum=R.min=function(){return ee(arguments,1)},R.random=function(){var z=9007199254740992,U=Math.random()*z&2097151?function(){return cu(Math.random()*z)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(J){var T,D,B,$,W,G=0,oe=[],ie=new R(s);if(J==null?J=o:Yo(J,0,$l),$=iv(J/Xr),w)if(crypto.getRandomValues){for(T=crypto.getRandomValues(new Uint32Array($*=2));G<$;)W=T[G]*131072+(T[G+1]>>>11),W>=9e15?(D=crypto.getRandomValues(new Uint32Array(2)),T[G]=D[0],T[G+1]=D[1]):(oe.push(W%1e14),G+=2);G=$/2}else if(crypto.randomBytes){for(T=crypto.randomBytes($*=7);G<$;)W=(T[G]&31)*281474976710656+T[G+1]*1099511627776+T[G+2]*4294967296+T[G+3]*16777216+(T[G+4]<<16)+(T[G+5]<<8)+T[G+6],W>=9e15?crypto.randomBytes(7).copy(T,G):(oe.push(W%1e14),G+=7);G=$/7}else throw w=!1,Error(_l+"crypto unavailable");if(!w)for(;G<$;)W=U(),W<9e15&&(oe[G++]=W%1e14);for($=oe[--G],J%=Xr,$&&J&&(W=ov[Xr-J],oe[G]=cu($/W)*W);oe[G]===0;oe.pop(),G--);if(G<0)oe=[B=0];else{for(B=-1;oe[0]===0;oe.splice(0,1),B-=Xr);for(G=1,W=oe[0];W>=10;W/=10,G++);G<Xr&&(B-=Xr-G)}return ie.e=B,ie.c=oe,ie}}(),R.sum=function(){for(var z=1,U=arguments,J=new R(U[0]);z<U.length;)J=J.plus(U[z++]);return J},t=function(){var z="0123456789";function U(J,T,D,B){for(var $,W=[0],G,oe=0,ie=J.length;oe<ie;){for(G=W.length;G--;W[G]*=T);for(W[0]+=B.indexOf(J.charAt(oe++)),$=0;$<W.length;$++)W[$]>D-1&&(W[$+1]==null&&(W[$+1]=0),W[$+1]+=W[$]/D|0,W[$]%=D)}return W.reverse()}return function(J,T,D,B,$){var W,G,oe,ie,we,Ce,Te,Y,H=J.indexOf("."),Q=o,ue=u;for(H>=0&&(ie=M,M=0,J=J.replace(".",""),Y=new R(T),Ce=Y.pow(J.length-H),M=ie,Y.c=U(Ic(lu(Ce.c),Ce.e,"0"),10,D,z),Y.e=Y.c.length),Te=U(J,T,D,$?(W=F,z):(W=z,F)),oe=ie=Te.length;Te[--ie]==0;Te.pop());if(!Te[0])return W.charAt(0);if(H<0?--oe:(Ce.c=Te,Ce.e=oe,Ce.s=B,Ce=n(Ce,Y,Q,ue,D),Te=Ce.c,we=Ce.r,oe=Ce.e),G=oe+Q+1,H=Te[G],ie=D/2,we=we||G<0||Te[G+1]!=null,we=ue<4?(H!=null||we)&&(ue==0||ue==(Ce.s<0?3:2)):H>ie||H==ie&&(ue==4||we||ue==6&&Te[G-1]&1||ue==(Ce.s<0?8:7)),G<1||!Te[0])J=we?Ic(W.charAt(1),-Q,W.charAt(0)):W.charAt(0);else{if(Te.length=G,we)for(--D;++Te[--G]>D;)Te[G]=0,G||(++oe,Te=[1].concat(Te));for(ie=Te.length;!Te[--ie];);for(H=0,J="";H<=ie;J+=W.charAt(Te[H++]));J=Ic(J,oe,W.charAt(0))}return J}}(),n=function(){function z(T,D,B){var $,W,G,oe,ie=0,we=T.length,Ce=D%rf,Te=D/rf|0;for(T=T.slice();we--;)G=T[we]%rf,oe=T[we]/rf|0,$=Te*G+oe*Ce,W=Ce*G+$%rf*rf+ie,ie=(W/B|0)+($/rf|0)+Te*oe,T[we]=W%B;return ie&&(T=[ie].concat(T)),T}function U(T,D,B,$){var W,G;if(B!=$)G=B>$?1:-1;else for(W=G=0;W<B;W++)if(T[W]!=D[W]){G=T[W]>D[W]?1:-1;break}return G}function J(T,D,B,$){for(var W=0;B--;)T[B]-=W,W=T[B]<D[B]?1:0,T[B]=W*$+T[B]-D[B];for(;!T[0]&&T.length>1;T.splice(0,1));}return function(T,D,B,$,W){var G,oe,ie,we,Ce,Te,Y,H,Q,ue,le,pe,Z,N,ke,Me,Ue,ce=T.s==D.s?1:-1,ne=T.c,ye=D.c;if(!ne||!ne[0]||!ye||!ye[0])return new R(!T.s||!D.s||(ne?ye&&ne[0]==ye[0]:!ye)?NaN:ne&&ne[0]==0||!ye?ce*0:ce/0);for(H=new R(ce),Q=H.c=[],oe=T.e-D.e,ce=B+oe+1,W||(W=Nu,oe=fu(T.e/Xr)-fu(D.e/Xr),ce=ce/Xr|0),ie=0;ye[ie]==(ne[ie]||0);ie++);if(ye[ie]>(ne[ie]||0)&&oe--,ce<0)Q.push(1),we=!0;else{for(N=ne.length,Me=ye.length,ie=0,ce+=2,Ce=cu(W/(ye[0]+1)),Ce>1&&(ye=z(ye,Ce,W),ne=z(ne,Ce,W),Me=ye.length,N=ne.length),Z=Me,ue=ne.slice(0,Me),le=ue.length;le<Me;ue[le++]=0);Ue=ye.slice(),Ue=[0].concat(Ue),ke=ye[0],ye[1]>=W/2&&ke++;do{if(Ce=0,G=U(ye,ue,Me,le),G<0){if(pe=ue[0],Me!=le&&(pe=pe*W+(ue[1]||0)),Ce=cu(pe/ke),Ce>1)for(Ce>=W&&(Ce=W-1),Te=z(ye,Ce,W),Y=Te.length,le=ue.length;U(Te,ue,Y,le)==1;)Ce--,J(Te,Me<Y?Ue:ye,Y,W),Y=Te.length,G=1;else Ce==0&&(G=Ce=1),Te=ye.slice(),Y=Te.length;if(Y<le&&(Te=[0].concat(Te)),J(ue,Te,le,W),le=ue.length,G==-1)for(;U(ye,ue,Me,le)<1;)Ce++,J(ue,Me<le?Ue:ye,le,W),le=ue.length}else G===0&&(Ce++,ue=[0]);Q[ie++]=Ce,ue[0]?ue[le++]=ne[Z]||0:(ue=[ne[Z]],le=1)}while((Z++<N||ue[0]!=null)&&ce--);we=ue[0]!=null,Q[0]||Q.splice(0,1)}if(W==Nu){for(ie=1,ce=Q[0];ce>=10;ce/=10,ie++);fe(H,B+(H.e=ie+oe*Xr-1)+1,$,we)}else H.e=oe,H.r=+we;return H}}();function K(z,U,J,T){var D,B,$,W,G;if(J==null?J=u:Yo(J,0,8),!z.c)return z.toString();if(D=z.c[0],$=z.e,U==null)G=lu(z.c),G=T==1||T==2&&($<=f||$>=d)?yg(G,$):Ic(G,$,"0");else if(z=fe(new R(z),U,J),B=z.e,G=lu(z.c),W=G.length,T==1||T==2&&(U<=B||B<=f)){for(;W<U;G+="0",W++);G=yg(G,B)}else if(U-=$,G=Ic(G,B,"0"),B+1>W){if(--U>0)for(G+=".";U--;G+="0");}else if(U+=B-W,U>0)for(B+1==W&&(G+=".");U--;G+="0");return z.s<0&&D?"-"+G:G}function ee(z,U){for(var J,T,D=1,B=new R(z[0]);D<z.length;D++)T=new R(z[D]),(!T.s||(J=Vf(B,T))===U||J===0&&B.s===U)&&(B=T);return B}function he(z,U,J){for(var T=1,D=U.length;!U[--D];U.pop());for(D=U[0];D>=10;D/=10,T++);return(J=T+J*Xr-1)>_?z.c=z.e=null:J<m?z.c=[z.e=0]:(z.e=J,z.c=U),z}r=function(){var z=/^(-?)0([xbo])(?=\w[\w.]*$)/i,U=/^([^.]+)\.$/,J=/^\.([^.]+)$/,T=/^-?(Infinity|NaN)$/,D=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(B,$,W,G){var oe,ie=W?$:$.replace(D,"");if(T.test(ie))B.s=isNaN(ie)?null:ie<0?-1:1;else{if(!W&&(ie=ie.replace(z,function(we,Ce,Te){return oe=(Te=Te.toLowerCase())=="x"?16:Te=="b"?2:8,!G||G==oe?Ce:we}),G&&(oe=G,ie=ie.replace(U,"$1").replace(J,"0.$1")),$!=ie))return new R(ie,oe);if(R.DEBUG)throw Error(_l+"Not a"+(G?" base "+G:"")+" number: "+$);B.s=null}B.c=B.e=null}}();function fe(z,U,J,T){var D,B,$,W,G,oe,ie,we=z.c,Ce=ov;if(we){e:{for(D=1,W=we[0];W>=10;W/=10,D++);if(B=U-D,B<0)B+=Xr,$=U,G=we[oe=0],ie=cu(G/Ce[D-$-1]%10);else if(oe=iv((B+1)/Xr),oe>=we.length)if(T){for(;we.length<=oe;we.push(0));G=ie=0,D=1,B%=Xr,$=B-Xr+1}else break e;else{for(G=W=we[oe],D=1;W>=10;W/=10,D++);B%=Xr,$=B-Xr+D,ie=$<0?0:cu(G/Ce[D-$-1]%10)}if(T=T||U<0||we[oe+1]!=null||($<0?G:G%Ce[D-$-1]),T=J<4?(ie||T)&&(J==0||J==(z.s<0?3:2)):ie>5||ie==5&&(J==4||T||J==6&&(B>0?$>0?G/Ce[D-$]:0:we[oe-1])%10&1||J==(z.s<0?8:7)),U<1||!we[0])return we.length=0,T?(U-=z.e+1,we[0]=Ce[(Xr-U%Xr)%Xr],z.e=-U||0):we[0]=z.e=0,z;if(B==0?(we.length=oe,W=1,oe--):(we.length=oe+1,W=Ce[Xr-B],we[oe]=$>0?cu(G/Ce[D-$]%Ce[$])*W:0),T)for(;;)if(oe==0){for(B=1,$=we[0];$>=10;$/=10,B++);for($=we[0]+=W,W=1;$>=10;$/=10,W++);B!=W&&(z.e++,we[0]==Nu&&(we[0]=1));break}else{if(we[oe]+=W,we[oe]!=Nu)break;we[oe--]=0,W=1}for(B=we.length;we[--B]===0;we.pop());}z.e>_?z.c=z.e=null:z.e<m&&(z.c=[z.e=0])}return z}function ve(z){var U,J=z.e;return J===null?z.toString():(U=lu(z.c),U=J<=f||J>=d?yg(U,J):Ic(U,J,"0"),z.s<0?"-"+U:U)}return i.absoluteValue=i.abs=function(){var z=new R(this);return z.s<0&&(z.s=1),z},i.comparedTo=function(z,U){return Vf(this,new R(z,U))},i.decimalPlaces=i.dp=function(z,U){var J,T,D,B=this;if(z!=null)return Yo(z,0,$l),U==null?U=u:Yo(U,0,8),fe(new R(B),z+B.e+1,U);if(!(J=B.c))return null;if(T=((D=J.length-1)-fu(this.e/Xr))*Xr,D=J[D])for(;D%10==0;D/=10,T--);return T<0&&(T=0),T},i.dividedBy=i.div=function(z,U){return n(this,new R(z,U),o,u)},i.dividedToIntegerBy=i.idiv=function(z,U){return n(this,new R(z,U),0,1)},i.exponentiatedBy=i.pow=function(z,U){var J,T,D,B,$,W,G,oe,ie,we=this;if(z=new R(z),z.c&&!z.isInteger())throw Error(_l+"Exponent not an integer: "+ve(z));if(U!=null&&(U=new R(U)),W=z.e>14,!we.c||!we.c[0]||we.c[0]==1&&!we.e&&we.c.length==1||!z.c||!z.c[0])return ie=new R(Math.pow(+ve(we),W?z.s*(2-vg(z)):+ve(z))),U?ie.mod(U):ie;if(G=z.s<0,U){if(U.c?!U.c[0]:!U.s)return new R(NaN);T=!G&&we.isInteger()&&U.isInteger(),T&&(we=we.mod(U))}else{if(z.e>9&&(we.e>0||we.e<-1||(we.e==0?we.c[0]>1||W&&we.c[1]>=24e7:we.c[0]<8e13||W&&we.c[0]<=9999975e7)))return B=we.s<0&&vg(z)?-0:0,we.e>-1&&(B=1/B),new R(G?1/B:B);M&&(B=iv(M/Xr+2))}for(W?(J=new R(.5),G&&(z.s=1),oe=vg(z)):(D=Math.abs(+ve(z)),oe=D%2),ie=new R(s);;){if(oe){if(ie=ie.times(we),!ie.c)break;B?ie.c.length>B&&(ie.c.length=B):T&&(ie=ie.mod(U))}if(D){if(D=cu(D/2),D===0)break;oe=D%2}else if(z=z.times(J),fe(z,z.e+1,1),z.e>14)oe=vg(z);else{if(D=+ve(z),D===0)break;oe=D%2}we=we.times(we),B?we.c&&we.c.length>B&&(we.c.length=B):T&&(we=we.mod(U))}return T?ie:(G&&(ie=s.div(ie)),U?ie.mod(U):B?fe(ie,M,u,$):ie)},i.integerValue=function(z){var U=new R(this);return z==null?z=u:Yo(z,0,8),fe(U,U.e+1,z)},i.isEqualTo=i.eq=function(z,U){return Vf(this,new R(z,U))===0},i.isFinite=function(){return!!this.c},i.isGreaterThan=i.gt=function(z,U){return Vf(this,new R(z,U))>0},i.isGreaterThanOrEqualTo=i.gte=function(z,U){return(U=Vf(this,new R(z,U)))===1||U===0},i.isInteger=function(){return!!this.c&&fu(this.e/Xr)>this.c.length-2},i.isLessThan=i.lt=function(z,U){return Vf(this,new R(z,U))<0},i.isLessThanOrEqualTo=i.lte=function(z,U){return(U=Vf(this,new R(z,U)))===-1||U===0},i.isNaN=function(){return!this.s},i.isNegative=function(){return this.s<0},i.isPositive=function(){return this.s>0},i.isZero=function(){return!!this.c&&this.c[0]==0},i.minus=function(z,U){var J,T,D,B,$=this,W=$.s;if(z=new R(z,U),U=z.s,!W||!U)return new R(NaN);if(W!=U)return z.s=-U,$.plus(z);var G=$.e/Xr,oe=z.e/Xr,ie=$.c,we=z.c;if(!G||!oe){if(!ie||!we)return ie?(z.s=-U,z):new R(we?$:NaN);if(!ie[0]||!we[0])return we[0]?(z.s=-U,z):new R(ie[0]?$:u==3?-0:0)}if(G=fu(G),oe=fu(oe),ie=ie.slice(),W=G-oe){for((B=W<0)?(W=-W,D=ie):(oe=G,D=we),D.reverse(),U=W;U--;D.push(0));D.reverse()}else for(T=(B=(W=ie.length)<(U=we.length))?W:U,W=U=0;U<T;U++)if(ie[U]!=we[U]){B=ie[U]<we[U];break}if(B&&(D=ie,ie=we,we=D,z.s=-z.s),U=(T=we.length)-(J=ie.length),U>0)for(;U--;ie[J++]=0);for(U=Nu-1;T>W;){if(ie[--T]<we[T]){for(J=T;J&&!ie[--J];ie[J]=U);--ie[J],ie[T]+=Nu}ie[T]-=we[T]}for(;ie[0]==0;ie.splice(0,1),--oe);return ie[0]?he(z,ie,oe):(z.s=u==3?-1:1,z.c=[z.e=0],z)},i.modulo=i.mod=function(z,U){var J,T,D=this;return z=new R(z,U),!D.c||!z.s||z.c&&!z.c[0]?new R(NaN):!z.c||D.c&&!D.c[0]?new R(D):(y==9?(T=z.s,z.s=1,J=n(D,z,0,3),z.s=T,J.s*=T):J=n(D,z,0,y),z=D.minus(J.times(z)),!z.c[0]&&y==1&&(z.s=D.s),z)},i.multipliedBy=i.times=function(z,U){var J,T,D,B,$,W,G,oe,ie,we,Ce,Te,Y,H,Q,ue=this,le=ue.c,pe=(z=new R(z,U)).c;if(!le||!pe||!le[0]||!pe[0])return!ue.s||!z.s||le&&!le[0]&&!pe||pe&&!pe[0]&&!le?z.c=z.e=z.s=null:(z.s*=ue.s,!le||!pe?z.c=z.e=null:(z.c=[0],z.e=0)),z;for(T=fu(ue.e/Xr)+fu(z.e/Xr),z.s*=ue.s,G=le.length,we=pe.length,G<we&&(Y=le,le=pe,pe=Y,D=G,G=we,we=D),D=G+we,Y=[];D--;Y.push(0));for(H=Nu,Q=rf,D=we;--D>=0;){for(J=0,Ce=pe[D]%Q,Te=pe[D]/Q|0,$=G,B=D+$;B>D;)oe=le[--$]%Q,ie=le[$]/Q|0,W=Te*oe+ie*Ce,oe=Ce*oe+W%Q*Q+Y[B]+J,J=(oe/H|0)+(W/Q|0)+Te*ie,Y[B--]=oe%H;Y[B]=J}return J?++T:Y.splice(0,1),he(z,Y,T)},i.negated=function(){var z=new R(this);return z.s=-z.s||null,z},i.plus=function(z,U){var J,T=this,D=T.s;if(z=new R(z,U),U=z.s,!D||!U)return new R(NaN);if(D!=U)return z.s=-U,T.minus(z);var B=T.e/Xr,$=z.e/Xr,W=T.c,G=z.c;if(!B||!$){if(!W||!G)return new R(D/0);if(!W[0]||!G[0])return G[0]?z:new R(W[0]?T:D*0)}if(B=fu(B),$=fu($),W=W.slice(),D=B-$){for(D>0?($=B,J=G):(D=-D,J=W),J.reverse();D--;J.push(0));J.reverse()}for(D=W.length,U=G.length,D-U<0&&(J=G,G=W,W=J,U=D),D=0;U;)D=(W[--U]=W[U]+G[U]+D)/Nu|0,W[U]=Nu===W[U]?0:W[U]%Nu;return D&&(W=[D].concat(W),++$),he(z,W,$)},i.precision=i.sd=function(z,U){var J,T,D,B=this;if(z!=null&&z!==!!z)return Yo(z,1,$l),U==null?U=u:Yo(U,0,8),fe(new R(B),z,U);if(!(J=B.c))return null;if(D=J.length-1,T=D*Xr+1,D=J[D]){for(;D%10==0;D/=10,T--);for(D=J[0];D>=10;D/=10,T++);}return z&&B.e+1>T&&(T=B.e+1),T},i.shiftedBy=function(z){return Yo(z,-9007199254740991,db),this.times("1e"+z)},i.squareRoot=i.sqrt=function(){var z,U,J,T,D,B=this,$=B.c,W=B.s,G=B.e,oe=o+4,ie=new R("0.5");if(W!==1||!$||!$[0])return new R(!W||W<0&&(!$||$[0])?NaN:$?B:1/0);if(W=Math.sqrt(+ve(B)),W==0||W==1/0?(U=lu($),(U.length+G)%2==0&&(U+="0"),W=Math.sqrt(+U),G=fu((G+1)/2)-(G<0||G%2),W==1/0?U="5e"+G:(U=W.toExponential(),U=U.slice(0,U.indexOf("e")+1)+G),J=new R(U)):J=new R(W+""),J.c[0]){for(G=J.e,W=G+oe,W<3&&(W=0);;)if(D=J,J=ie.times(D.plus(n(B,D,oe,1))),lu(D.c).slice(0,W)===(U=lu(J.c)).slice(0,W))if(J.e<G&&--W,U=U.slice(W-3,W+1),U=="9999"||!T&&U=="4999"){if(!T&&(fe(D,D.e+o+2,0),D.times(D).eq(B))){J=D;break}oe+=4,W+=4,T=1}else{(!+U||!+U.slice(1)&&U.charAt(0)=="5")&&(fe(J,J.e+o+2,1),z=!J.times(J).eq(B));break}}return fe(J,J.e+o+1,u,z)},i.toExponential=function(z,U){return z!=null&&(Yo(z,0,$l),z++),K(this,z,U,1)},i.toFixed=function(z,U){return z!=null&&(Yo(z,0,$l),z=z+this.e+1),K(this,z,U)},i.toFormat=function(z,U,J){var T,D=this;if(J==null)z!=null&&U&&typeof U=="object"?(J=U,U=null):z&&typeof z=="object"?(J=z,z=U=null):J=k;else if(typeof J!="object")throw Error(_l+"Argument not an object: "+J);if(T=D.toFixed(z,U),D.c){var B,$=T.split("."),W=+J.groupSize,G=+J.secondaryGroupSize,oe=J.groupSeparator||"",ie=$[0],we=$[1],Ce=D.s<0,Te=Ce?ie.slice(1):ie,Y=Te.length;if(G&&(B=W,W=G,G=B,Y-=B),W>0&&Y>0){for(B=Y%W||W,ie=Te.substr(0,B);B<Y;B+=W)ie+=oe+Te.substr(B,W);G>0&&(ie+=oe+Te.slice(B)),Ce&&(ie="-"+ie)}T=we?ie+(J.decimalSeparator||"")+((G=+J.fractionGroupSize)?we.replace(new RegExp("\\d{"+G+"}\\B","g"),"$&"+(J.fractionGroupSeparator||"")):we):ie}return(J.prefix||"")+T+(J.suffix||"")},i.toFraction=function(z){var U,J,T,D,B,$,W,G,oe,ie,we,Ce,Te=this,Y=Te.c;if(z!=null&&(W=new R(z),!W.isInteger()&&(W.c||W.s!==1)||W.lt(s)))throw Error(_l+"Argument "+(W.isInteger()?"out of range: ":"not an integer: ")+ve(W));if(!Y)return new R(Te);for(U=new R(s),oe=J=new R(s),T=G=new R(s),Ce=lu(Y),B=U.e=Ce.length-Te.e-1,U.c[0]=ov[($=B%Xr)<0?Xr+$:$],z=!z||W.comparedTo(U)>0?B>0?U:oe:W,$=_,_=1/0,W=new R(Ce),G.c[0]=0;ie=n(W,U,0,1),D=J.plus(ie.times(T)),D.comparedTo(z)!=1;)J=T,T=D,oe=G.plus(ie.times(D=oe)),G=D,U=W.minus(ie.times(D=U)),W=D;return D=n(z.minus(J),T,0,1),G=G.plus(D.times(oe)),J=J.plus(D.times(T)),G.s=oe.s=Te.s,B=B*2,we=n(oe,T,B,u).minus(Te).abs().comparedTo(n(G,J,B,u).minus(Te).abs())<1?[oe,T]:[G,J],_=$,we},i.toNumber=function(){return+ve(this)},i.toPrecision=function(z,U){return z!=null&&Yo(z,1,$l),K(this,z,U,2)},i.toString=function(z){var U,J=this,T=J.s,D=J.e;return D===null?T?(U="Infinity",T<0&&(U="-"+U)):U="NaN":(z==null?U=D<=f||D>=d?yg(lu(J.c),D):Ic(lu(J.c),D,"0"):z===10&&I?(J=fe(new R(J),o+D+1,u),U=Ic(lu(J.c),J.e,"0")):(Yo(z,2,F.length,"Base"),U=t(Ic(lu(J.c),D,"0"),10,z,T,!0)),T<0&&J.c[0]&&(U="-"+U)),U},i.valueOf=i.toJSON=function(){return ve(this)},i._isBigNumber=!0,i[Symbol.toStringTag]="BigNumber",i[Symbol.for("nodejs.util.inspect.custom")]=i.valueOf,e!=null&&R.set(e),R}function fu(e){var n=e|0;return e>0||e===n?n:n-1}function lu(e){for(var n,t,r=1,i=e.length,s=e[0]+"";r<i;){for(n=e[r++]+"",t=Xr-n.length;t--;n="0"+n);s+=n}for(i=s.length;s.charCodeAt(--i)===48;);return s.slice(0,i+1||1)}function Vf(e,n){var t,r,i=e.c,s=n.c,o=e.s,u=n.s,f=e.e,d=n.e;if(!o||!u)return null;if(t=i&&!i[0],r=s&&!s[0],t||r)return t?r?0:-u:o;if(o!=u)return o;if(t=o<0,r=f==d,!i||!s)return r?0:!i^t?1:-1;if(!r)return f>d^t?1:-1;for(u=(f=i.length)<(d=s.length)?f:d,o=0;o<u;o++)if(i[o]!=s[o])return i[o]>s[o]^t?1:-1;return f==d?0:f>d^t?1:-1}function Yo(e,n,t,r){if(e<n||e>t||e!==cu(e))throw Error(_l+(r||"Argument")+(typeof e=="number"?e<n||e>t?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function vg(e){var n=e.c.length-1;return fu(e.e/Xr)==n&&e.c[n]%2!=0}function yg(e,n){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(n<0?"e":"e+")+n}function Ic(e,n,t){var r,i;if(n<0){for(i=t+".";++n;i+=t);e=i+e}else if(r=e.length,++n>r){for(i=t,n-=r;--n;i+=t);e+=i}else n<r&&(e=e.slice(0,n)+"."+e.slice(n));return e}var fc=ix(),X7=class{constructor(e){qt(this,"key");qt(this,"left",null);qt(this,"right",null);this.key=e}},Nd=class extends X7{constructor(e){super(e)}},Q7=class{constructor(){qt(this,"size",0);qt(this,"modificationCount",0);qt(this,"splayCount",0)}splay(e){const n=this.root;if(n==null)return this.compare(e,e),-1;let t=null,r=null,i=null,s=null,o=n;const u=this.compare;let f;for(;;)if(f=u(o.key,e),f>0){let d=o.left;if(d==null||(f=u(d.key,e),f>0&&(o.left=d.right,d.right=o,o=d,d=o.left,d==null)))break;t==null?r=o:t.left=o,t=o,o=d}else if(f<0){let d=o.right;if(d==null||(f=u(d.key,e),f<0&&(o.right=d.left,d.left=o,o=d,d=o.right,d==null)))break;i==null?s=o:i.right=o,i=o,o=d}else break;return i!=null&&(i.right=o.left,o.left=s),t!=null&&(t.left=o.right,o.right=r),this.root!==o&&(this.root=o,this.splayCount++),f}splayMin(e){let n=e,t=n.left;for(;t!=null;){const r=t;n.left=r.right,r.right=n,n=r,t=n.left}return n}splayMax(e){let n=e,t=n.right;for(;t!=null;){const r=t;n.right=r.left,r.left=n,n=r,t=n.right}return n}_delete(e){if(this.root==null||this.splay(e)!=0)return null;let t=this.root;const r=t,i=t.left;if(this.size--,i==null)this.root=t.right;else{const s=t.right;t=this.splayMax(i),t.right=s,this.root=t}return this.modificationCount++,r}addNewRoot(e,n){this.size++,this.modificationCount++;const t=this.root;if(t==null){this.root=e;return}n<0?(e.left=t,e.right=t.right,t.right=null):(e.right=t,e.left=t.left,t.left=null),this.root=e}_first(){const e=this.root;return e==null?null:(this.root=this.splayMin(e),this.root)}_last(){const e=this.root;return e==null?null:(this.root=this.splayMax(e),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(e){return this.validKey(e)&&this.splay(e)==0}defaultCompare(){return(e,n)=>e<n?-1:e>n?1:0}wrap(){return{getRoot:()=>this.root,setRoot:e=>{this.root=e},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:e=>{this.splayCount=e},splay:e=>this.splay(e),has:e=>this.has(e)}}},ew,tw,pm=class Ud extends Q7{constructor(t,r){super();qt(this,"root",null);qt(this,"compare");qt(this,"validKey");qt(this,ew,"[object Set]");this.compare=t??this.defaultCompare(),this.validKey=r??(i=>i!=null&&i!=null)}delete(t){return this.validKey(t)?this._delete(t)!=null:!1}deleteAll(t){for(const r of t)this.delete(r)}forEach(t){const r=this[Symbol.iterator]();let i;for(;i=r.next(),!i.done;)t(i.value,i.value,this)}add(t){const r=this.splay(t);return r!=0&&this.addNewRoot(new Nd(t),r),this}addAndReturn(t){const r=this.splay(t);return r!=0&&this.addNewRoot(new Nd(t),r),this.root.key}addAll(t){for(const r of t)this.add(r)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(t){if(t==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(t)<0)return this.root.key;let i=this.root.left;if(i==null)return null;let s=i.right;for(;s!=null;)i=s,s=i.right;return i.key}firstAfter(t){if(t==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(t)>0)return this.root.key;let i=this.root.right;if(i==null)return null;let s=i.left;for(;s!=null;)i=s,s=i.left;return i.key}retainAll(t){const r=new Ud(this.compare,this.validKey),i=this.modificationCount;for(const s of t){if(i!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(s)&&this.splay(s)==0&&r.add(this.root.key)}r.size!=this.size&&(this.root=r.root,this.size=r.size,this.modificationCount++)}lookup(t){return!this.validKey(t)||this.splay(t)!=0?null:this.root.key}intersection(t){const r=new Ud(this.compare,this.validKey);for(const i of this)t.has(i)&&r.add(i);return r}difference(t){const r=new Ud(this.compare,this.validKey);for(const i of this)t.has(i)||r.add(i);return r}union(t){const r=this.clone();return r.addAll(t),r}clone(){const t=new Ud(this.compare,this.validKey);return t.size=this.size,t.root=this.copyNode(this.root),t}copyNode(t){if(t==null)return null;function r(s,o){let u,f;do{if(u=s.left,f=s.right,u!=null){const d=new Nd(u.key);o.left=d,r(u,d)}if(f!=null){const d=new Nd(f.key);o.right=d,s=f,o=d}}while(f!=null)}const i=new Nd(t.key);return r(t,i),i}toSet(){return this.clone()}entries(){return new tI(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[(tw=Symbol.iterator,ew=Symbol.toStringTag,tw)](){return new eI(this.wrap())}},ox=class{constructor(e){qt(this,"tree");qt(this,"path",new Array);qt(this,"modificationCount",null);qt(this,"splayCount");this.tree=e,this.splayCount=e.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const e=this.path[this.path.length-1];return this.getValue(e)}rebuildPath(e){this.path.splice(0,this.path.length),this.tree.splay(e),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(e){for(;e!=null;)this.path.push(e),e=e.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let t=this.tree.getRoot();for(;t!=null;)this.path.push(t),t=t.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let e=this.path[this.path.length-1],n=e.right;if(n!=null){for(;n!=null;)this.path.push(n),n=n.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===e;)e=this.path.pop();return this.path.length>0}},eI=class extends ox{getValue(e){return e.key}},tI=class extends ox{getValue(e){return[e.key,e.key]}},sx=e=>()=>e,c1=e=>{const n=e?(t,r)=>r.minus(t).abs().isLessThanOrEqualTo(e):sx(!1);return(t,r)=>n(t,r)?0:t.comparedTo(r)};function nI(e){const n=e?(t,r,i,s,o)=>t.exponentiatedBy(2).isLessThanOrEqualTo(s.minus(r).exponentiatedBy(2).plus(o.minus(i).exponentiatedBy(2)).times(e)):sx(!1);return(t,r,i)=>{const s=t.x,o=t.y,u=i.x,f=i.y,d=o.minus(f).times(r.x.minus(u)).minus(s.minus(u).times(r.y.minus(f)));return n(d,s,o,u,f)?0:d.comparedTo(0)}}var rI=e=>e,iI=e=>{if(e){const n=new pm(c1(e)),t=new pm(c1(e)),r=(s,o)=>o.addAndReturn(s),i=s=>({x:r(s.x,n),y:r(s.y,t)});return i({x:new fc(0),y:new fc(0)}),i}return rI},f1=e=>({set:n=>{Hc=f1(n)},reset:()=>f1(e),compare:c1(e),snap:iI(e),orient:nI(e)}),Hc=f1(),Dd=(e,n)=>e.ll.x.isLessThanOrEqualTo(n.x)&&n.x.isLessThanOrEqualTo(e.ur.x)&&e.ll.y.isLessThanOrEqualTo(n.y)&&n.y.isLessThanOrEqualTo(e.ur.y),h1=(e,n)=>{if(n.ur.x.isLessThan(e.ll.x)||e.ur.x.isLessThan(n.ll.x)||n.ur.y.isLessThan(e.ll.y)||e.ur.y.isLessThan(n.ll.y))return null;const t=e.ll.x.isLessThan(n.ll.x)?n.ll.x:e.ll.x,r=e.ur.x.isLessThan(n.ur.x)?e.ur.x:n.ur.x,i=e.ll.y.isLessThan(n.ll.y)?n.ll.y:e.ll.y,s=e.ur.y.isLessThan(n.ur.y)?e.ur.y:n.ur.y;return{ll:{x:t,y:i},ur:{x:r,y:s}}},Rg=(e,n)=>e.x.times(n.y).minus(e.y.times(n.x)),ax=(e,n)=>e.x.times(n.x).plus(e.y.times(n.y)),gm=e=>ax(e,e).sqrt(),oI=(e,n,t)=>{const r={x:n.x.minus(e.x),y:n.y.minus(e.y)},i={x:t.x.minus(e.x),y:t.y.minus(e.y)};return Rg(i,r).div(gm(i)).div(gm(r))},sI=(e,n,t)=>{const r={x:n.x.minus(e.x),y:n.y.minus(e.y)},i={x:t.x.minus(e.x),y:t.y.minus(e.y)};return ax(i,r).div(gm(i)).div(gm(r))},pb=(e,n,t)=>n.y.isZero()?null:{x:e.x.plus(n.x.div(n.y).times(t.minus(e.y))),y:t},gb=(e,n,t)=>n.x.isZero()?null:{x:t,y:e.y.plus(n.y.div(n.x).times(t.minus(e.x)))},aI=(e,n,t,r)=>{if(n.x.isZero())return gb(t,r,e.x);if(r.x.isZero())return gb(e,n,t.x);if(n.y.isZero())return pb(t,r,e.y);if(r.y.isZero())return pb(e,n,t.y);const i=Rg(n,r);if(i.isZero())return null;const s={x:t.x.minus(e.x),y:t.y.minus(e.y)},o=Rg(s,n).div(i),u=Rg(s,r).div(i),f=e.x.plus(u.times(n.x)),d=t.x.plus(o.times(r.x)),m=e.y.plus(u.times(n.y)),_=t.y.plus(o.times(r.y)),w=f.plus(d).div(2),y=m.plus(_).div(2);return{x:w,y}},cc=class lx{constructor(n,t){qt(this,"point");qt(this,"isLeft");qt(this,"segment");qt(this,"otherSE");qt(this,"consumedBy");n.events===void 0?n.events=[this]:n.events.push(this),this.point=n,this.isLeft=t}static compare(n,t){const r=lx.comparePoints(n.point,t.point);return r!==0?r:(n.point!==t.point&&n.link(t),n.isLeft!==t.isLeft?n.isLeft?1:-1:mm.compare(n.segment,t.segment))}static comparePoints(n,t){return n.x.isLessThan(t.x)?-1:n.x.isGreaterThan(t.x)?1:n.y.isLessThan(t.y)?-1:n.y.isGreaterThan(t.y)?1:0}link(n){if(n.point===this.point)throw new Error("Tried to link already linked events");const t=n.point.events;for(let r=0,i=t.length;r<i;r++){const s=t[r];this.point.events.push(s),s.point=this.point}this.checkForConsuming()}checkForConsuming(){const n=this.point.events.length;for(let t=0;t<n;t++){const r=this.point.events[t];if(r.segment.consumedBy===void 0)for(let i=t+1;i<n;i++){const s=this.point.events[i];s.consumedBy===void 0&&r.otherSE.point.events===s.otherSE.point.events&&r.segment.consume(s.segment)}}}getAvailableLinkedEvents(){const n=[];for(let t=0,r=this.point.events.length;t<r;t++){const i=this.point.events[t];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&n.push(i)}return n}getLeftmostComparator(n){const t=new Map,r=i=>{const s=i.otherSE;t.set(i,{sine:oI(this.point,n.point,s.point),cosine:sI(this.point,n.point,s.point)})};return(i,s)=>{t.has(i)||r(i),t.has(s)||r(s);const{sine:o,cosine:u}=t.get(i),{sine:f,cosine:d}=t.get(s);return o.isGreaterThanOrEqualTo(0)&&f.isGreaterThanOrEqualTo(0)?u.isLessThan(d)?1:u.isGreaterThan(d)?-1:0:o.isLessThan(0)&&f.isLessThan(0)?u.isLessThan(d)?-1:u.isGreaterThan(d)?1:0:f.isLessThan(o)?-1:f.isGreaterThan(o)?1:0}}},lI=class d1{constructor(n){qt(this,"events");qt(this,"poly");qt(this,"_isExteriorRing");qt(this,"_enclosingRing");this.events=n;for(let t=0,r=n.length;t<r;t++)n[t].segment.ringOut=this;this.poly=null}static factory(n){const t=[];for(let r=0,i=n.length;r<i;r++){const s=n[r];if(!s.isInResult()||s.ringOut)continue;let o=null,u=s.leftSE,f=s.rightSE;const d=[u],m=u.point,_=[];for(;o=u,u=f,d.push(u),u.point!==m;)for(;;){const w=u.getAvailableLinkedEvents();if(w.length===0){const k=d[0].point,F=d[d.length-1].point;throw new Error(`Unable to complete output ring starting at [${k.x}, ${k.y}]. Last matching segment found ends at [${F.x}, ${F.y}].`)}if(w.length===1){f=w[0].otherSE;break}let y=null;for(let k=0,F=_.length;k<F;k++)if(_[k].point===u.point){y=k;break}if(y!==null){const k=_.splice(y)[0],F=d.splice(k.index);F.unshift(F[0].otherSE),t.push(new d1(F.reverse()));continue}_.push({index:d.length,point:u.point});const M=u.getLeftmostComparator(o);f=w.sort(M)[0].otherSE;break}t.push(new d1(d))}return t}getGeom(){let n=this.events[0].point;const t=[n];for(let d=1,m=this.events.length-1;d<m;d++){const _=this.events[d].point,w=this.events[d+1].point;Hc.orient(_,n,w)!==0&&(t.push(_),n=_)}if(t.length===1)return null;const r=t[0],i=t[1];Hc.orient(r,n,i)===0&&t.shift(),t.push(t[0]);const s=this.isExteriorRing()?1:-1,o=this.isExteriorRing()?0:t.length-1,u=this.isExteriorRing()?t.length:-1,f=[];for(let d=o;d!=u;d+=s)f.push([t[d].x.toNumber(),t[d].y.toNumber()]);return f}isExteriorRing(){if(this._isExteriorRing===void 0){const n=this.enclosingRing();this._isExteriorRing=n?!n.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var i,s;let n=this.events[0];for(let o=1,u=this.events.length;o<u;o++){const f=this.events[o];cc.compare(n,f)>0&&(n=f)}let t=n.segment.prevInResult(),r=t?t.prevInResult():null;for(;;){if(!t)return null;if(!r)return t.ringOut;if(r.ringOut!==t.ringOut)return((i=r.ringOut)==null?void 0:i.enclosingRing())!==t.ringOut?t.ringOut:(s=t.ringOut)==null?void 0:s.enclosingRing();t=r.prevInResult(),r=t?t.prevInResult():null}}},mb=class{constructor(e){qt(this,"exteriorRing");qt(this,"interiorRings");this.exteriorRing=e,e.poly=this,this.interiorRings=[]}addInterior(e){this.interiorRings.push(e),e.poly=this}getGeom(){const e=this.exteriorRing.getGeom();if(e===null)return null;const n=[e];for(let t=0,r=this.interiorRings.length;t<r;t++){const i=this.interiorRings[t].getGeom();i!==null&&n.push(i)}return n}},uI=class{constructor(e){qt(this,"rings");qt(this,"polys");this.rings=e,this.polys=this._composePolys(e)}getGeom(){const e=[];for(let n=0,t=this.polys.length;n<t;n++){const r=this.polys[n].getGeom();r!==null&&e.push(r)}return e}_composePolys(e){var t;const n=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];if(!s.poly)if(s.isExteriorRing())n.push(new mb(s));else{const o=s.enclosingRing();o!=null&&o.poly||n.push(new mb(o)),(t=o==null?void 0:o.poly)==null||t.addInterior(s)}}return n}},cI=class{constructor(e,n=mm.compare){qt(this,"queue");qt(this,"tree");qt(this,"segments");this.queue=e,this.tree=new pm(n),this.segments=[]}process(e){const n=e.segment,t=[];if(e.consumedBy)return e.isLeft?this.queue.delete(e.otherSE):this.tree.delete(n),t;e.isLeft&&this.tree.add(n);let r=n,i=n;do r=this.tree.lastBefore(r);while(r!=null&&r.consumedBy!=null);do i=this.tree.firstAfter(i);while(i!=null&&i.consumedBy!=null);if(e.isLeft){let s=null;if(r){const u=r.getIntersection(n);if(u!==null&&(n.isAnEndpoint(u)||(s=u),!r.isAnEndpoint(u))){const f=this._splitSafely(r,u);for(let d=0,m=f.length;d<m;d++)t.push(f[d])}}let o=null;if(i){const u=i.getIntersection(n);if(u!==null&&(n.isAnEndpoint(u)||(o=u),!i.isAnEndpoint(u))){const f=this._splitSafely(i,u);for(let d=0,m=f.length;d<m;d++)t.push(f[d])}}if(s!==null||o!==null){let u=null;s===null?u=o:o===null?u=s:u=cc.comparePoints(s,o)<=0?s:o,this.queue.delete(n.rightSE),t.push(n.rightSE);const f=n.split(u);for(let d=0,m=f.length;d<m;d++)t.push(f[d])}t.length>0?(this.tree.delete(n),t.push(e)):(this.segments.push(n),n.prev=r)}else{if(r&&i){const s=r.getIntersection(i);if(s!==null){if(!r.isAnEndpoint(s)){const o=this._splitSafely(r,s);for(let u=0,f=o.length;u<f;u++)t.push(o[u])}if(!i.isAnEndpoint(s)){const o=this._splitSafely(i,s);for(let u=0,f=o.length;u<f;u++)t.push(o[u])}}}this.tree.delete(n)}return t}_splitSafely(e,n){this.tree.delete(e);const t=e.rightSE;this.queue.delete(t);const r=e.split(n);return r.push(t),e.consumedBy===void 0&&this.tree.add(e),r}},fI=class{constructor(){qt(this,"type");qt(this,"numMultiPolys")}run(e,n,t){Vd.type=e;const r=[new yb(n,!0)];for(let d=0,m=t.length;d<m;d++)r.push(new yb(t[d],!1));if(Vd.numMultiPolys=r.length,Vd.type==="difference"){const d=r[0];let m=1;for(;m<r.length;)h1(r[m].bbox,d.bbox)!==null?m++:r.splice(m,1)}if(Vd.type==="intersection")for(let d=0,m=r.length;d<m;d++){const _=r[d];for(let w=d+1,y=r.length;w<y;w++)if(h1(_.bbox,r[w].bbox)===null)return[]}const i=new pm(cc.compare);for(let d=0,m=r.length;d<m;d++){const _=r[d].getSweepEvents();for(let w=0,y=_.length;w<y;w++)i.add(_[w])}const s=new cI(i);let o=null;for(i.size!=0&&(o=i.first(),i.delete(o));o;){const d=s.process(o);for(let m=0,_=d.length;m<_;m++){const w=d[m];w.consumedBy===void 0&&i.add(w)}i.size!=0?(o=i.first(),i.delete(o)):o=null}Hc.reset();const u=lI.factory(s.segments);return new uI(u).getGeom()}},Vd=new fI,p1=Vd,hI=0,mm=class Fg{constructor(n,t,r,i){qt(this,"id");qt(this,"leftSE");qt(this,"rightSE");qt(this,"rings");qt(this,"windings");qt(this,"ringOut");qt(this,"consumedBy");qt(this,"prev");qt(this,"_prevInResult");qt(this,"_beforeState");qt(this,"_afterState");qt(this,"_isInResult");this.id=++hI,this.leftSE=n,n.segment=this,n.otherSE=t,this.rightSE=t,t.segment=this,t.otherSE=n,this.rings=r,this.windings=i}static compare(n,t){const r=n.leftSE.point.x,i=t.leftSE.point.x,s=n.rightSE.point.x,o=t.rightSE.point.x;if(o.isLessThan(r))return 1;if(s.isLessThan(i))return-1;const u=n.leftSE.point.y,f=t.leftSE.point.y,d=n.rightSE.point.y,m=t.rightSE.point.y;if(r.isLessThan(i)){if(f.isLessThan(u)&&f.isLessThan(d))return 1;if(f.isGreaterThan(u)&&f.isGreaterThan(d))return-1;const _=n.comparePoint(t.leftSE.point);if(_<0)return 1;if(_>0)return-1;const w=t.comparePoint(n.rightSE.point);return w!==0?w:-1}if(r.isGreaterThan(i)){if(u.isLessThan(f)&&u.isLessThan(m))return-1;if(u.isGreaterThan(f)&&u.isGreaterThan(m))return 1;const _=t.comparePoint(n.leftSE.point);if(_!==0)return _;const w=n.comparePoint(t.rightSE.point);return w<0?1:w>0?-1:1}if(u.isLessThan(f))return-1;if(u.isGreaterThan(f))return 1;if(s.isLessThan(o)){const _=t.comparePoint(n.rightSE.point);if(_!==0)return _}if(s.isGreaterThan(o)){const _=n.comparePoint(t.rightSE.point);if(_<0)return 1;if(_>0)return-1}if(!s.eq(o)){const _=d.minus(u),w=s.minus(r),y=m.minus(f),M=o.minus(i);if(_.isGreaterThan(w)&&y.isLessThan(M))return 1;if(_.isLessThan(w)&&y.isGreaterThan(M))return-1}return s.isGreaterThan(o)?1:s.isLessThan(o)||d.isLessThan(m)?-1:d.isGreaterThan(m)?1:n.id<t.id?-1:n.id>t.id?1:0}static fromRing(n,t,r){let i,s,o;const u=cc.comparePoints(n,t);if(u<0)i=n,s=t,o=1;else if(u>0)i=t,s=n,o=-1;else throw new Error(`Tried to create degenerate segment at [${n.x}, ${n.y}]`);const f=new cc(i,!0),d=new cc(s,!1);return new Fg(f,d,[r],[o])}replaceRightSE(n){this.rightSE=n,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const n=this.leftSE.point.y,t=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:n.isLessThan(t)?n:t},ur:{x:this.rightSE.point.x,y:n.isGreaterThan(t)?n:t}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(n){return n.x.eq(this.leftSE.point.x)&&n.y.eq(this.leftSE.point.y)||n.x.eq(this.rightSE.point.x)&&n.y.eq(this.rightSE.point.y)}comparePoint(n){return Hc.orient(this.leftSE.point,n,this.rightSE.point)}getIntersection(n){const t=this.bbox(),r=n.bbox(),i=h1(t,r);if(i===null)return null;const s=this.leftSE.point,o=this.rightSE.point,u=n.leftSE.point,f=n.rightSE.point,d=Dd(t,u)&&this.comparePoint(u)===0,m=Dd(r,s)&&n.comparePoint(s)===0,_=Dd(t,f)&&this.comparePoint(f)===0,w=Dd(r,o)&&n.comparePoint(o)===0;if(m&&d)return w&&!_?o:!w&&_?f:null;if(m)return _&&s.x.eq(f.x)&&s.y.eq(f.y)?null:s;if(d)return w&&o.x.eq(u.x)&&o.y.eq(u.y)?null:u;if(w&&_)return null;if(w)return o;if(_)return f;const y=aI(s,this.vector(),u,n.vector());return y===null||!Dd(i,y)?null:Hc.snap(y)}split(n){const t=[],r=n.events!==void 0,i=new cc(n,!0),s=new cc(n,!1),o=this.rightSE;this.replaceRightSE(s),t.push(s),t.push(i);const u=new Fg(i,o,this.rings.slice(),this.windings.slice());return cc.comparePoints(u.leftSE.point,u.rightSE.point)>0&&u.swapEvents(),cc.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(i.checkForConsuming(),s.checkForConsuming()),t}swapEvents(){const n=this.rightSE;this.rightSE=this.leftSE,this.leftSE=n,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let t=0,r=this.windings.length;t<r;t++)this.windings[t]*=-1}consume(n){let t=this,r=n;for(;t.consumedBy;)t=t.consumedBy;for(;r.consumedBy;)r=r.consumedBy;const i=Fg.compare(t,r);if(i!==0){if(i>0){const s=t;t=r,r=s}if(t.prev===r){const s=t;t=r,r=s}for(let s=0,o=r.rings.length;s<o;s++){const u=r.rings[s],f=r.windings[s],d=t.rings.indexOf(u);d===-1?(t.rings.push(u),t.windings.push(f)):t.windings[d]+=f}r.rings=null,r.windings=null,r.consumedBy=t,r.leftSE.consumedBy=t.leftSE,r.rightSE.consumedBy=t.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const n=this.prev.consumedBy||this.prev;this._beforeState=n.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const n=this.beforeState();this._afterState={rings:n.rings.slice(0),windings:n.windings.slice(0),multiPolys:[]};const t=this._afterState.rings,r=this._afterState.windings,i=this._afterState.multiPolys;for(let u=0,f=this.rings.length;u<f;u++){const d=this.rings[u],m=this.windings[u],_=t.indexOf(d);_===-1?(t.push(d),r.push(m)):r[_]+=m}const s=[],o=[];for(let u=0,f=t.length;u<f;u++){if(r[u]===0)continue;const d=t[u],m=d.poly;if(o.indexOf(m)===-1)if(d.isExterior)s.push(m);else{o.indexOf(m)===-1&&o.push(m);const _=s.indexOf(d.poly);_!==-1&&s.splice(_,1)}}for(let u=0,f=s.length;u<f;u++){const d=s[u].multiPoly;i.indexOf(d)===-1&&i.push(d)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const n=this.beforeState().multiPolys,t=this.afterState().multiPolys;switch(p1.type){case"union":{const r=n.length===0,i=t.length===0;this._isInResult=r!==i;break}case"intersection":{let r,i;n.length<t.length?(r=n.length,i=t.length):(r=t.length,i=n.length),this._isInResult=i===p1.numMultiPolys&&r<i;break}case"xor":{const r=Math.abs(n.length-t.length);this._isInResult=r%2===1;break}case"difference":{const r=i=>i.length===1&&i[0].isSubject;this._isInResult=r(n)!==r(t);break}}return this._isInResult}},vb=class{constructor(e,n,t){qt(this,"poly");qt(this,"isExterior");qt(this,"segments");qt(this,"bbox");if(!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=t,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const r=Hc.snap({x:new fc(e[0][0]),y:new fc(e[0][1])});this.bbox={ll:{x:r.x,y:r.y},ur:{x:r.x,y:r.y}};let i=r;for(let s=1,o=e.length;s<o;s++){if(typeof e[s][0]!="number"||typeof e[s][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const u=Hc.snap({x:new fc(e[s][0]),y:new fc(e[s][1])});u.x.eq(i.x)&&u.y.eq(i.y)||(this.segments.push(mm.fromRing(i,u,this)),u.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=u.x),u.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=u.y),u.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=u.x),u.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=u.y),i=u)}(!r.x.eq(i.x)||!r.y.eq(i.y))&&this.segments.push(mm.fromRing(i,r,this))}getSweepEvents(){const e=[];for(let n=0,t=this.segments.length;n<t;n++){const r=this.segments[n];e.push(r.leftSE),e.push(r.rightSE)}return e}},dI=class{constructor(e,n){qt(this,"multiPoly");qt(this,"exteriorRing");qt(this,"interiorRings");qt(this,"bbox");if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new vb(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let t=1,r=e.length;t<r;t++){const i=new vb(e[t],this,!1);i.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=i.bbox.ur.y),this.interiorRings.push(i)}this.multiPoly=n}getSweepEvents(){const e=this.exteriorRing.getSweepEvents();for(let n=0,t=this.interiorRings.length;n<t;n++){const r=this.interiorRings[n].getSweepEvents();for(let i=0,s=r.length;i<s;i++)e.push(r[i])}return e}},yb=class{constructor(e,n){qt(this,"isSubject");qt(this,"polys");qt(this,"bbox");if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:new fc(Number.POSITIVE_INFINITY),y:new fc(Number.POSITIVE_INFINITY)},ur:{x:new fc(Number.NEGATIVE_INFINITY),y:new fc(Number.NEGATIVE_INFINITY)}};for(let t=0,r=e.length;t<r;t++){const i=new dI(e[t],this);i.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=i.bbox.ur.y),this.polys.push(i)}this.isSubject=n}getSweepEvents(){const e=[];for(let n=0,t=this.polys.length;n<t;n++){const r=this.polys[n].getSweepEvents();for(let i=0,s=r.length;i<s;i++)e.push(r[i])}return e}},pI=(e,...n)=>p1.run("intersection",e,n);Hc.set;function gI(e,n){var t,r,i,s,o,u,f,d,m,_,w=0,y=e.type==="FeatureCollection",M=e.type==="Feature",k=y?e.features.length:1;for(t=0;t<k;t++){for(u=y?e.features[t].geometry:M?e.geometry:e,d=y?e.features[t].properties:M?e.properties:{},m=y?e.features[t].bbox:M?e.bbox:void 0,_=y?e.features[t].id:M?e.id:void 0,f=u?u.type==="GeometryCollection":!1,o=f?u.geometries.length:1,i=0;i<o;i++){if(s=f?u.geometries[i]:u,s===null){if(n(null,w,d,m,_)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(n(s,w,d,m,_)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<s.geometries.length;r++)if(n(s.geometries[r],w,d,m,_)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}w++}}function mI(e,n={}){const t=[];if(gI(e,i=>{t.push(i.coordinates)}),t.length<2)throw new Error("Must specify at least 2 geometries");const r=pI(t[0],...t.slice(1));return r.length===0?null:r.length===1?hu(r[0],n.properties):R7(r,n.properties)}var vI=mI;function ux(e,n,t){if(e!==null)for(var r,i,s,o,u,f,d,m=0,_=0,w,y=e.type,M=y==="FeatureCollection",k=y==="Feature",F=M?e.features.length:1,I=0;I<F;I++){d=M?e.features[I].geometry:k?e.geometry:e,w=d?d.type==="GeometryCollection":!1,u=w?d.geometries.length:1;for(var R=0;R<u;R++){var K=0,ee=0;if(o=w?d.geometries[R]:d,o!==null){f=o.coordinates;var he=o.type;switch(m=0,he){case null:break;case"Point":if(n(f,_,I,K,ee)===!1)return!1;_++,K++;break;case"LineString":case"MultiPoint":for(r=0;r<f.length;r++){if(n(f[r],_,I,K,ee)===!1)return!1;_++,he==="MultiPoint"&&K++}he==="LineString"&&K++;break;case"Polygon":case"MultiLineString":for(r=0;r<f.length;r++){for(i=0;i<f[r].length-m;i++){if(n(f[r][i],_,I,K,ee)===!1)return!1;_++}he==="MultiLineString"&&K++,he==="Polygon"&&ee++}he==="Polygon"&&K++;break;case"MultiPolygon":for(r=0;r<f.length;r++){for(ee=0,i=0;i<f[r].length;i++){for(s=0;s<f[r][i].length-m;s++){if(n(f[r][i][s],_,I,K,ee)===!1)return!1;_++}ee++}K++}break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(ux(o.geometries[r],n)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function yI(e,n){var t,r,i,s,o,u,f,d,m,_,w=0,y=e.type==="FeatureCollection",M=e.type==="Feature",k=y?e.features.length:1;for(t=0;t<k;t++){for(u=y?e.features[t].geometry:M?e.geometry:e,d=y?e.features[t].properties:M?e.properties:{},m=y?e.features[t].bbox:M?e.bbox:void 0,_=y?e.features[t].id:M?e.id:void 0,f=u?u.type==="GeometryCollection":!1,o=f?u.geometries.length:1,i=0;i<o;i++){if(s=f?u.geometries[i]:u,s===null){if(n(null,w,d,m,_)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(n(s,w,d,m,_)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<s.geometries.length;r++)if(n(s.geometries[r],w,d,m,_)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}w++}}function _I(e,n){yI(e,function(t,r,i,s,o){var u=t===null?null:t.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return n(ud(t,i,{bbox:s,id:o}),r,0)===!1?!1:void 0}var f;switch(u){case"MultiPoint":f="Point";break;case"MultiLineString":f="LineString";break;case"MultiPolygon":f="Polygon";break}for(var d=0;d<t.coordinates.length;d++){var m=t.coordinates[d],_={type:f,coordinates:m};if(n(ud(_,i),r,d)===!1)return!1}})}function bI(e,n){_I(e,function(t,r,i){var s=0;if(t.geometry){var o=t.geometry.type;if(!(o==="Point"||o==="MultiPoint")){var u,f=0,d=0,m=0;if(ux(t,function(_,w,y,M,k){if(u===void 0||r>f||M>d||k>m){u=_,f=r,d=M,m=k,s=0;return}var F=du([u,_],t.properties);if(n(F,r,i,k,s)===!1)return!1;s++,u=_})===!1)return!1}}})}function wI(e,n,t){var r=t,i=!1;return bI(e,function(s,o,u,f,d){i===!1&&t===void 0?r=s:r=n(r,s,o,u,f,d),i=!0}),r}function vm(e,n={}){return wI(e,(t,r)=>{const i=r.geometry.coordinates;return t+dy(i[0],i[1],n)},0)}var Gf=vm;class vf extends qn.Polygon{constructor(t,r={}){super(t,{...r,pmIgnore:!1,interactive:!0});qt(this,"properties");this.properties=hn.measure("Polygon.constructor.initProperties",()=>({type:"Polygon",category:r.category||"forages",accessLevel:r.accessLevel||"visitor",style:{color:r.color||"#2b6451",weight:r.weight||3,opacity:r.opacity||1,fillColor:r.fillColor||"#2b6451",fillOpacity:r.fillOpacity||.2,dashArray:r.dashArray||"",name:r.name||""}})),this.updateProperties(),this.on({add:()=>this.updateProperties(),edit:()=>this.updateProperties(),drag:()=>this.updateProperties()})}updateProperties(){hn.measure("Polygon.updateProperties",()=>{var t,r,i,s,o;try{const u=this.getLatLngs()[0];if(!u||u.length<3){console.warn("Polygon has less than 3 points, cannot calculate properties");return}const f=u.map(I=>[I.lng,I.lat]);f.push(f[0]);const d=hu([f]),m=nx(d),_=vm(du([...f]),{units:"meters"}),w=sp(d),y=qn.latLng(w.geometry.coordinates[1],w.geometry.coordinates[0]),M=((r=(t=this.properties)==null?void 0:t.style)==null?void 0:r.name)||"",k=((i=this.properties)==null?void 0:i.category)||"forages",F=((s=this.properties)==null?void 0:s.accessLevel)||"visitor";this.properties={type:"Polygon",coordinates:u.map(I=>({lat:I.lat,lng:I.lng})),surface:m,perimeter:_,center:{lat:y.lat,lng:y.lng},vertices:u.length,category:k,accessLevel:F,style:{...this.options,color:this.options.color||"#2b6451",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#2b6451",fillOpacity:this.options.fillOpacity||.2,dashArray:((o=this.options)==null?void 0:o.dashArray)||"",name:M}},this.fire("properties:updated",{shape:this,properties:this.properties})}catch(u){console.error("Failed to calculate polygon properties",u)}})}setName(t){hn.measure("Polygon.setName",()=>{this.properties.style||(this.properties.style={}),this.properties.style.name=t,this.fire("properties:updated",{shape:this,properties:this.properties})})}getName(){return hn.measure("Polygon.getName",()=>{var t,r;return((r=(t=this.properties)==null?void 0:t.style)==null?void 0:r.name)||""})}setLatLngs(t){return hn.measure("Polygon.setLatLngs",()=>(super.setLatLngs(t),this.updateProperties(),this))}getMidPoints(){return hn.measure("Polygon.getMidPoints",()=>{const t=this.getLatLngs()[0],r=[];if(t.length<2)return r;for(let i=0;i<t.length;i++){const s=t[i],o=t[(i+1)%t.length];r.push(qn.latLng((s.lat+o.lat)/2,(s.lng+o.lng)/2))}return r})}moveVertex(t,r){hn.measure("Polygon.moveVertex",()=>{const i=this.getLatLngs()[0];t>=0&&t<i.length&&(i[t]=r,qn.Polygon.prototype.setLatLngs.call(this,[i]))})}addVertex(t,r){hn.measure("Polygon.addVertex",()=>{const i=this.getLatLngs()[0];t>=0&&t<i.length&&(i.splice((t+1)%i.length,0,r),qn.Polygon.prototype.setLatLngs.call(this,[i]))})}move(t){return hn.measure("Polygon.move",()=>{const i=this.getLatLngs()[0].map(s=>qn.latLng(s.lat+t.lat,s.lng+t.lng));return qn.Polygon.prototype.setLatLngs.call(this,[i]),this})}getCenter(){return hn.measure("Polygon.getCenter",()=>{const t=this.getLatLngs()[0];if(!t||t.length===0)return new qn.LatLng(0,0);try{const r=t.filter(d=>d&&typeof d.lat=="number"&&typeof d.lng=="number"&&!isNaN(d.lat)&&!isNaN(d.lng)&&Math.abs(d.lat)<=90&&Math.abs(d.lng)<=180);if(r.length===0)return console.warn("Aucun point valide dans le polygone pour calculer le centre"),new qn.LatLng(0,0);const i=r.map(d=>[d.lng,d.lat]);i.push(i[0]);const s=hu([i]),o=sp(s),u=o.geometry.coordinates[1],f=o.geometry.coordinates[0];if(typeof u!="number"||typeof f!="number"||isNaN(u)||isNaN(f)||Math.abs(u)>90||Math.abs(f)>180)throw new Error("Centroid calculé invalide");return qn.latLng(u,f)}catch(r){console.warn("Erreur lors du calcul du centroïde avec turf.js, utilisation de la méthode simple",r);let i=0,s=0,o=0;for(const u of t)u&&typeof u.lat=="number"&&typeof u.lng=="number"&&!isNaN(u.lat)&&!isNaN(u.lng)&&Math.abs(u.lat)<=90&&Math.abs(u.lng)<=180&&(i+=u.lat,s+=u.lng,o++);return o===0?(console.error("Impossible de calculer un centre valide pour le polygone"),new qn.LatLng(0,0)):new qn.LatLng(i/o,s/o)}})}getSegmentLengths(){return hn.measure("Polygon.getSegmentLengths",()=>{const t=this.getLatLngs()[0],r=[];if(t.length<2)return r;for(let i=0;i<t.length;i++){const s=t[i],o=t[(i+1)%t.length];r.push(s.distanceTo(o))}return r})}}class Bs extends qn.Polyline{constructor(t,r={}){super(t,{...r,pmIgnore:!1,interactive:!0});qt(this,"properties");qt(this,"cachedProperties",{});qt(this,"needsUpdate",!0);this.properties=hn.measure("Line.constructor.initProperties",()=>({type:"Line",category:r.category||"forages",accessLevel:r.accessLevel||"visitor",style:{...r||{},name:r.name||""}})),this.updateProperties(),this.on("add",()=>{this.updateProperties()})}updateProperties(){hn.measure("Line.updateProperties",()=>{var i,s,o,u,f;const t=this.getLatLngs();if(!t||t.length<2){console.warn("Line has less than 2 points, cannot calculate properties");return}const r=t.map(d=>[d.lng,d.lat]);try{const d=du(r),m=vm(d,{units:"meters"});let _;if(t.length===2)_=qn.latLng((t[0].lat+t[1].lat)/2,(t[0].lng+t[1].lng)/2);else{const F=u1(d,m/2,{units:"meters"});_=qn.latLng(F.geometry.coordinates[1],F.geometry.coordinates[0])}const w=10,y=((s=(i=this.properties)==null?void 0:i.style)==null?void 0:s.name)||"",M=((o=this.properties)==null?void 0:o.category)||"forages",k=((u=this.properties)==null?void 0:u.accessLevel)||"visitor";this.properties={type:"Line",length:m,coordinates:t.map(F=>({lat:F.lat,lng:F.lng})),center:{lat:_.lat,lng:_.lng},vertices:t.length,surfaceInfluence:m*w,dimensions:{width:w},category:M,accessLevel:k,style:{...this.options,color:this.options.color||"#2b6451",weight:this.options.weight||3,opacity:this.options.opacity||1,dashArray:((f=this.options)==null?void 0:f.dashArray)||"",name:y}},this.cachedProperties.length=m,this.cachedProperties.center=_,this.cachedProperties.midPoints=void 0,this.cachedProperties.segmentLengths=void 0,this.needsUpdate=!1,this.fire("properties:updated",{shape:this,properties:this.properties})}catch(d){console.error("Failed to calculate line properties",d)}})}setName(t){hn.measure("Line.setName",()=>{this.properties.style||(this.properties.style={}),this.properties.style.name=t,this.fire("properties:updated",{shape:this,properties:this.properties})})}getName(){return hn.measure("Line.getName",()=>{var t,r;return((r=(t=this.properties)==null?void 0:t.style)==null?void 0:r.name)||""})}invalidateCache(){hn.measure("Line.invalidateCache",()=>{this.needsUpdate=!0,this.cachedProperties={}})}setLatLngs(t){return super.setLatLngs(t),this.needsUpdate=!0,this.cachedProperties={},this.fire("latlngs:updated",{latlngs:this.getLatLngs()}),this}getMidPoints(){return hn.measure("Line.getMidPoints",()=>{if(!this.needsUpdate&&this.cachedProperties.midPoints)return this.cachedProperties.midPoints;const t=this.getLatLngs(),r=[];if(t.length<2)return r;for(let i=0;i<t.length-1;i++){const s=t[i],o=t[i+1];if(!s||!o){console.warn("Points invalides détectés pour le segment",i);continue}r.push(qn.latLng((s.lat+o.lat)/2,(s.lng+o.lng)/2))}return this.cachedProperties.midPoints=r,r})}getMidPointAt(t){return hn.measure("Line.getMidPointAt",()=>{const r=this.getLatLngs();if(t<0||t>=r.length-1||r.length<2)return null;const i=r[t],s=r[t+1];return!i||!s?(console.warn("Points invalides pour calcul du midpoint au segment",t),null):qn.latLng((i.lat+s.lat)/2,(i.lng+s.lng)/2)})}moveVertex(t,r,i=!1){hn.measure("Line.moveVertex",()=>{const s=this.getLatLngs();t>=0&&t<s.length&&(s[t]=r,this.setLatLngs(s),this.needsUpdate=!0,this.cachedProperties={},this.fire("vertex:moved",{index:t,latlng:r,allPoints:s}),i&&this.updateProperties())})}addVertex(t,r,i=!1){hn.measure("Line.addVertex",()=>{const s=this.getLatLngs();t>=0&&t<s.length-1&&(s.splice(t+1,0,r),qn.Polyline.prototype.setLatLngs.call(this,s),this.needsUpdate=!0,this.cachedProperties.midPoints=void 0,this.cachedProperties.segmentLengths=void 0,this.cachedProperties.center=void 0,this.cachedProperties.length=void 0,i&&this.updateProperties())})}move(t,r=!0){return hn.measure("Line.move",()=>{this.fire("move:start");const i=this.getLatLngs(),s=i.map(o=>qn.latLng(o.lat+t.lat,o.lng+t.lng));return this.setLatLngs(s),this.needsUpdate=!0,this.cachedProperties={},this.fire("move",{delta:t,newPositions:s,oldPositions:i}),r&&(this.updateProperties(),this.fire("properties:updated",{shape:this,properties:this.properties}),this.fire("move:end")),this})}getCenter(){return hn.measure("Line.getCenter",()=>{if(!this.needsUpdate&&this.cachedProperties.center)return this.cachedProperties.center;const t=this.getLatLngs();if(t.length<2)return t[0]||new qn.LatLng(0,0);try{const r=t.map(f=>[f.lng,f.lat]),i=du(r),s=vm(i,{units:"meters"}),o=u1(i,s/2,{units:"meters"}),u=qn.latLng(o.geometry.coordinates[1],o.geometry.coordinates[0]);return this.cachedProperties.center=u,u}catch(r){console.warn("Error calculating line center with turf.js, using simple method",r);const i=t.reduce((u,f)=>u+f.lat,0)/t.length,s=t.reduce((u,f)=>u+f.lng,0)/t.length,o=new qn.LatLng(i,s);return this.cachedProperties.center=o,o}})}getSegmentLengths(){return hn.measure("Line.getSegmentLengths",()=>{if(!this.needsUpdate&&this.cachedProperties.segmentLengths)return this.cachedProperties.segmentLengths;const t=this.getLatLngs(),r=[];if(t.length<2)return r;for(let i=0;i<t.length-1;i++){const s=t[i],o=t[i+1];r.push(s.distanceTo(o))}return this.cachedProperties.segmentLengths=r,r})}getSegmentLengthAt(t){return hn.measure("Line.getSegmentLengthAt",()=>{const r=this.getLatLngs();if(t<0||t>=r.length-1||r.length<2)return 0;const i=r[t],s=r[t+1];return i.distanceTo(s)})}getLengthToVertex(t){return hn.measure("Line.getLengthToVertex",()=>{const r=this.getLatLngs();let i=0;if(t<=0||r.length<2)return 0;for(let s=0;s<Math.min(t,r.length-1);s++)i+=r[s].distanceTo(r[s+1]);return i})}getLength(){return hn.measure("Line.getLength",()=>{if(!this.needsUpdate&&this.cachedProperties.length)return this.cachedProperties.length;const t=this.getLatLngs();let r=0;for(let i=0;i<t.length-1;i++)r+=t[i].distanceTo(t[i+1]);return this.cachedProperties.length=r,r})}}const Qa=class Qa extends Bs{constructor(t,r={}){super(t,{...r,color:"#FF4500",weight:4,opacity:.8,interactive:!1,pmIgnore:!0});qt(this,"elevationData",[]);qt(this,"elevationProfile",null);qt(this,"elevationMarker",null);qt(this,"isZooming",!1);qt(this,"simpleLine",null);qt(this,"isDestroyed",!1);qt(this,"zoomAnimationTimeout",null);this.properties=hn.measure("ElevationLine.constructor.initProperties",()=>({...this.properties,type:"ElevationLine",category:r.category||"forages",accessLevel:r.accessLevel||"visitor",style:{...this.properties.style||{},name:r.name||""},elevationProfile:null,maxElevation:0,minElevation:0,elevationGain:0,elevationLoss:0,dataSource:"pending"})),this.setupEventListeners()}setupEventListeners(){hn.measure("ElevationLine.setupEventListeners",()=>{this.on("move",()=>this.updateElevationProfile()),this.on("add",()=>{this._map&&(this._map.on("zoomstart",this.handleZoomStart,this),this._map.on("zoomend",this.handleZoomEnd,this),this._map.on("zoomanim",this._animateZoom,this))}),this.on("remove",()=>{this.cleanupEventListeners()})})}cleanupEventListeners(){this._map&&(this._map.off("zoomstart",this.handleZoomStart,this),this._map.off("zoomend",this.handleZoomEnd,this),this._map.off("zoomanim",this._animateZoom,this)),this.zoomAnimationTimeout&&(clearTimeout(this.zoomAnimationTimeout),this.zoomAnimationTimeout=null)}_animateZoom(t){if(this.isDestroyed||!this._map||!this.getLatLngs().length){console.debug("[ElevationLine] Animation de zoom ignorée - ligne détruite ou carte non disponible");return}this.zoomAnimationTimeout&&(clearTimeout(this.zoomAnimationTimeout),this.zoomAnimationTimeout=null);try{this.elevationMarker&&this.elevationMarker.remove();const r=this._path;r&&(r.style.display="none");const i=this.getLatLngs();if(i&&i.length>0&&this._map&&!this.isDestroyed){if(!this._map.getContainer()){console.debug("[ElevationLine] Carte non valide pendant l'animation de zoom");return}if(this.simpleLine?this.simpleLine.setLatLngs(i):(this.simpleLine=qn.polyline(i,{color:"#FF4500",weight:3,opacity:.6,smoothFactor:1,interactive:!1}),this._map&&this._map.getContainer()&&this.simpleLine.addTo(this._map)),this.simpleLine&&this.simpleLine._path){const s=this.simpleLine._path.style.transform;this.simpleLine._path.style.transform="",this.zoomAnimationTimeout=setTimeout(()=>{if(this.isDestroyed||!this._map||!this._map.getContainer()){this.cleanup();return}try{this.simpleLine&&this.simpleLine._path&&(this.simpleLine._path.style.transform=s,this.simpleLine._path.style.display=""),r&&!this.isDestroyed&&(r.style.display=""),this._map&&this._map.hasLayer(this)&&!this.isDestroyed&&this.redraw()}catch(o){console.warn("[ElevationLine] Erreur lors de la restauration après animation:",o),this.cleanup()}},300)}}}catch(r){console.debug("[ElevationLine] Animation de zoom ignorée:",r),this.zoomAnimationTimeout=setTimeout(()=>{if(this.isDestroyed||!this._map||!this._map.getContainer()){this.cleanup();return}try{this._path&&(this._path.style.display=""),this._map&&this._map.hasLayer(this)&&!this.isDestroyed&&this.redraw()}catch(i){console.error("[ElevationLine] Erreur lors de la restauration après animation:",i),this.cleanup()}},300)}}handleZoomStart(){this.isDestroyed||hn.measure("ElevationLine.handleZoomStart",()=>{if(!(this.isZooming||!this._map)){this.isZooming=!0;try{this.elevationMarker&&this.elevationMarker.remove();const t=this._path;t&&(t.style.display="none"),this.isDestroyed||this.setStyle({opacity:.3})}catch(t){console.error("[ElevationLine] Error in handleZoomStart:",t),this.cleanup()}}})}handleZoomEnd(){this.isDestroyed||hn.measure("ElevationLine.handleZoomEnd",()=>{if(!this._map){this.isZooming=!1;return}try{this.simpleLine&&this._map&&(this.simpleLine.remove(),this.simpleLine=null);const t=this._path;t&&(t.style.display=""),this.isDestroyed||this.setStyle({opacity:.8}),this.zoomAnimationTimeout&&clearTimeout(this.zoomAnimationTimeout),this.zoomAnimationTimeout=setTimeout(()=>{if(!(this.isDestroyed||!this._map))try{this._map&&this._map.hasLayer(this)&&!this.isDestroyed&&this.redraw()}catch(r){console.warn("[ElevationLine] Erreur lors du redraw après zoom:",r),this.cleanup()}},50)}catch(t){console.error("[ElevationLine] Error in handleZoomEnd:",t)}finally{this.isZooming=!1}})}cleanup(){hn.measure("ElevationLine.cleanup",()=>{if(this.isZooming=!1,this.hideElevationMarker(),this.zoomAnimationTimeout&&(clearTimeout(this.zoomAnimationTimeout),this.zoomAnimationTimeout=null),this.simpleLine&&this._map){try{this.simpleLine.remove()}catch(r){console.error("[ElevationLine] Error removing simpleLine:",r)}this.simpleLine=null}if(this.elevationProfile){try{this.elevationProfile.remove()}catch(r){console.error("[ElevationLine] Error removing elevationProfile:",r)}this.elevationProfile=null}const t=this._path;t&&(t.style.display=""),!this.isDestroyed&&this._map&&this._map.hasLayer(this)&&this.setStyle({opacity:.8})})}calculateOptimalSampleCount(){return hn.measure("ElevationLine.calculateOptimalSampleCount",()=>{const t=this.getLength(),r=Math.ceil(t/Qa.SAMPLE_DISTANCE);return Math.min(Math.max(r,Qa.MIN_SAMPLES),Qa.MAX_SAMPLES)})}async fetchElevationData(t=0){return hn.measure("ElevationLine.fetchElevationData",async()=>{if(this.getLatLngs().length===0)return;const i=this.getLength();let s="";const o=this.calculateOptimalSampleCount();console.log(`[ElevationLine] Using ${o} sample points for ${i.toFixed(0)}m line`);const u=[];for(let f=0;f<o;f++){const d=f/(o-1)*i,m=this.getPointAtDistance(d);m&&u.push(`${m.lat},${m.lng}`)}s=u.join("|");try{const f=await fetch(`${Qa.API_URL}?locations=${s}`);if(!f.ok)throw new Error(`HTTP error ${f.status}`);const d=await f.json();if(!d.results||!Array.isArray(d.results))throw new Error("Invalid API response format");this.elevationData=d.results.map((m,_)=>({distance:_/(o-1)*i,elevation:m.elevation})),this.properties.dataSource="api"}catch(f){if(console.warn(`[ElevationLine] API fetch attempt ${t+1}/${Qa.MAX_RETRIES} failed:`,f),t<Qa.MAX_RETRIES)return await new Promise(d=>setTimeout(d,Qa.RETRY_DELAY)),this.fetchElevationData(t+1);console.warn("[ElevationLine] All API attempts failed, falling back to simulation"),this.simulateElevationData(),this.properties.dataSource="simulation"}this.calculateElevationStatistics()})}simulateElevationData(){hn.measure("ElevationLine.simulateElevationData",()=>{const t=this.getLength(),r=this.calculateOptimalSampleCount();this.elevationData=Array.from({length:r},(i,s)=>{const o=s/(r-1)*t,u=100+Math.sin(o/t*Math.PI*2)*50;return{distance:o,elevation:u}})})}calculateElevationStatistics(){hn.measure("ElevationLine.calculateElevationStatistics",()=>{if(!this.elevationData.length)return;const t=this.elevationData.map(m=>m.elevation),r=t.length?Math.max(...t):0,i=t.length?Math.min(...t):0;let s=0,o=0,u=0,f=0,d=0;console.log("[ElevationLine][calculateElevationStatistics] Données brutes:",{elevationsCount:t.length,maxElevation:r,minElevation:i});for(let m=1;m<this.elevationData.length;m++){const _=this.elevationData[m-1],w=this.elevationData[m],y=w.elevation-_.elevation;y>0?s+=y:o+=Math.abs(y);const M=w.distance-_.distance;if(M>0){const k=y/M*100;u=Math.max(u,Math.abs(k)),f+=Math.abs(k),d++}}console.log("[ElevationLine][calculateElevationStatistics] Calculs intermédiaires:",{gain:s,loss:o,maxSlope:u,averageSlope:d>0?f/d:0}),this.properties={...this.properties,type:"ElevationLine",maxElevation:r,minElevation:i,elevationGain:s,elevationLoss:o,maxSlope:u,averageSlope:d>0?f/d:0,elevationData:this.elevationData,dataSource:this.properties.dataSource,length:this.getLength()},console.log("[ElevationLine][calculateElevationStatistics] Propriétés mises à jour:",this.properties)})}showElevationAt(t){hn.measure("ElevationLine.showElevationAt",()=>{if(!(!this.elevationData.length||!this._map))try{const r=this.elevationData.reduce((s,o)=>Math.abs(o.distance-t)<Math.abs(s.distance-t)?o:s),i=this.getPointAtDistance(t);if(!i)return;this.elevationMarker?(this.elevationMarker.setLatLng(i),this.elevationMarker.setTooltipContent(`Distance: ${this.formatDistance(r.distance)}<br>Altitude: ${this.formatElevation(r.elevation)}`)):(this.elevationMarker=qn.circleMarker(i,{radius:6,color:"#FF4500",fillColor:"#FF4500",fillOpacity:1,weight:2,className:"elevation-marker"}),this.elevationMarker.bindTooltip(`Distance: ${this.formatDistance(r.distance)}<br>Altitude: ${this.formatElevation(r.elevation)}`,{permanent:!0,direction:"top",offset:[0,-10],className:"elevation-marker-tooltip"}),this._map&&this._map.hasLayer(this)&&this.elevationMarker.addTo(this._map)),this.fire("elevation:show",{distance:t,elevation:r.elevation,latLng:i})}catch(r){console.error("[ElevationLine] Erreur lors de l'affichage de l'élévation:",r),this.hideElevationMarker()}})}hideElevationMarker(){hn.measure("ElevationLine.hideElevationMarker",()=>{this.elevationMarker&&(this.elevationMarker.remove(),this.elevationMarker=null)})}getPointAtDistance(t){return hn.measure("ElevationLine.getPointAtDistance",()=>{try{const i=this.getLatLngs().map(u=>[u.lng,u.lat]),s=du(i),o=u1(s,t,{units:"meters"});return qn.latLng(o.geometry.coordinates[1],o.geometry.coordinates[0])}catch(r){return console.error("Error calculating point at distance",r),null}})}moveVertex(t,r,i=!1){hn.measure("ElevationLine.moveVertex",()=>{super.moveVertex(t,r,!1),this.properties.type="ElevationLine",i&&this.updateElevationProfile()})}addVertex(t,r,i=!1){hn.measure("ElevationLine.addVertex",()=>{console.warn("[ElevationLine] Tentative d'ajout de vertex ignorée - non autorisé pour un profil altimétrique")})}setLatLngs(t){return hn.measure("ElevationLine.setLatLngs",()=>(super.setLatLngs(t),this.properties.type="ElevationLine",this.updateElevationProfile(),this))}move(t,r=!0){return hn.measure("ElevationLine.move",()=>(super.move(t,!1),this.properties.type="ElevationLine",r&&this.updateElevationProfile(),this))}setName(t){hn.measure("ElevationLine.setName",()=>{this.properties.style||(this.properties.style={}),this.properties.style.name=t,this.fire("properties:updated",{shape:this,properties:this.properties})})}getName(){return hn.measure("ElevationLine.getName",()=>{var t,r;return((r=(t=this.properties)==null?void 0:t.style)==null?void 0:r.name)||""})}formatDistance(t){return hn.measure("ElevationLine.formatDistance",()=>t>=1e3?`${(t/1e3).toFixed(2)} km`:`${t.toFixed(0)} m`)}formatElevation(t){return hn.measure("ElevationLine.formatElevation",()=>`${t.toFixed(0)} m`)}onAdd(t){return hn.measure("ElevationLine.onAdd",()=>(super.onAdd(t),this))}onRemove(t){return this.isDestroyed=!0,this.cleanupEventListeners(),this.cleanup(),super.onRemove(t)}async updateElevationProfile(){return hn.measure("ElevationLine.updateElevationProfile",async()=>{try{if(this.properties.elevationData&&this.properties.dataSource==="restored"){this.elevationData=this.properties.elevationData,this.calculateElevationStatistics(),this._map&&this._map.hasLayer(this)&&this.redraw(),this.fire("elevation:updated",{shape:this,elevationData:this.elevationData,properties:this.properties});return}await this.fetchElevationData(),this.updateProperties(),this._map&&this._map.hasLayer(this)&&this.redraw(),this.fire("elevation:updated",{shape:this,elevationData:this.elevationData,properties:this.properties})}catch(t){console.error("[ElevationLine] Erreur lors de la mise à jour du profil d'élévation:",t),this.properties.dataSource="error"}})}updateProperties(){hn.measure("ElevationLine.updateProperties",()=>{var t,r;if(super.updateProperties(),this.elevationData&&this.elevationData.length>0){const i=this.elevationData.map(F=>F.elevation),s=Math.max(...i),o=Math.min(...i);let u=0,f=0,d=0,m=0,_=0;for(let F=1;F<this.elevationData.length;F++){const I=this.elevationData[F-1],R=this.elevationData[F],K=R.elevation-I.elevation;K>0?u+=K:f+=Math.abs(K);const ee=R.distance-I.distance;if(ee>0){const he=K/ee*100;d=Math.max(d,Math.abs(he)),m+=Math.abs(he),_++}}const y=this.getLatLngs().map(F=>({lat:F.lat,lng:F.lng})),M=((t=this.properties)==null?void 0:t.category)||"forages",k=((r=this.properties)==null?void 0:r.accessLevel)||"visitor";this.properties={...this.properties,type:"ElevationLine",coordinates:y,elevationData:this.elevationData.map(F=>({distance:F.distance,elevation:F.elevation})),maxElevation:s,minElevation:o,elevationGain:u,elevationLoss:f,maxSlope:d,averageSlope:_>0?m/_:0,dataSource:this.properties.dataSource||"api",category:M,accessLevel:k},this.fire("properties:updated",{shape:this,properties:this.properties})}})}getElevationData(){return hn.measure("ElevationLine.getElevationData",()=>this.elevationData)}};qt(Qa,"API_URL","https://api.open-elevation.com/api/v1/lookup"),qt(Qa,"RETRY_DELAY",2e3),qt(Qa,"MAX_RETRIES",3),qt(Qa,"SAMPLE_DISTANCE",100),qt(Qa,"MIN_SAMPLES",10),qt(Qa,"MAX_SAMPLES",50);let Cf=Qa;var ym={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */ym.exports;(function(e,n){(function(){var t,r="4.17.21",i=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",u="Invalid `variable` option passed into `_.template`",f="__lodash_hash_undefined__",d=500,m="__lodash_placeholder__",_=1,w=2,y=4,M=1,k=2,F=1,I=2,R=4,K=8,ee=16,he=32,fe=64,ve=128,z=256,U=512,J=30,T="...",D=800,B=16,$=1,W=2,G=3,oe=1/0,ie=9007199254740991,we=17976931348623157e292,Ce=NaN,Te=4294967295,Y=Te-1,H=Te>>>1,Q=[["ary",ve],["bind",F],["bindKey",I],["curry",K],["curryRight",ee],["flip",U],["partial",he],["partialRight",fe],["rearg",z]],ue="[object Arguments]",le="[object Array]",pe="[object AsyncFunction]",Z="[object Boolean]",N="[object Date]",ke="[object DOMException]",Me="[object Error]",Ue="[object Function]",ce="[object GeneratorFunction]",ne="[object Map]",ye="[object Number]",de="[object Null]",We="[object Object]",Ge="[object Promise]",tt="[object Proxy]",Ze="[object RegExp]",et="[object Set]",He="[object String]",wt="[object Symbol]",Pt="[object Undefined]",kt="[object WeakMap]",Jt="[object WeakSet]",rn="[object ArrayBuffer]",un="[object DataView]",Ke="[object Float32Array]",ot="[object Float64Array]",rt="[object Int8Array]",Ft="[object Int16Array]",Qt="[object Int32Array]",Bn="[object Uint8Array]",Ln="[object Uint8ClampedArray]",Nn="[object Uint16Array]",ar="[object Uint32Array]",En=/\b__p \+= '';/g,jn=/\b(__p \+=) '' \+/g,Mn=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Yn=/&(?:amp|lt|gt|quot|#39);/g,br=/[&<>"']/g,Or=RegExp(Yn.source),gr=RegExp(br.source),ii=/<%-([\s\S]+?)%>/g,ft=/<%([\s\S]+?)%>/g,Qe=/<%=([\s\S]+?)%>/g,$t=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,xn=/^\w*$/,vn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,bn=/[\\^$.*+?()[\]{}|]/g,Ht=RegExp(bn.source),Hn=/^\s+/,St=/\s/,mt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,wn=/\{\n\/\* \[wrapped with (.+)\] \*/,Qr=/,? & /,Tt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Rn=/[()=,{}\[\]\/\s]/,Qn=/\\(\\)?/g,Pi=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Sr=/\w*$/,Pr=/^[-+]0x[0-9a-f]+$/i,dr=/^0b[01]+$/i,Mi=/^\[object .+?Constructor\]$/,wr=/^0o[0-7]+$/i,Gr=/^(?:0|[1-9]\d*)$/,Ir=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,tn=/($^)/,zi=/['\n\r\u2028\u2029\\]/g,Oi="\\ud800-\\udfff",Qi="\\u0300-\\u036f",ei="\\ufe20-\\ufe2f",Br="\\u20d0-\\u20ff",ui=Qi+ei+Br,mr="\\u2700-\\u27bf",Si="a-z\\xdf-\\xf6\\xf8-\\xff",ps="\\xac\\xb1\\xd7\\xf7",va="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Rr="\\u2000-\\u206f",mn=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Zn="A-Z\\xc0-\\xd6\\xd8-\\xde",Ei="\\ufe0e\\ufe0f",Bi=ps+va+Rr+mn,Ri="['’]",jo="["+Oi+"]",cr="["+Bi+"]",Vn="["+ui+"]",Ms="\\d+",oi="["+mr+"]",Ai="["+Si+"]",ci="[^"+Oi+Bi+Ms+mr+Si+Zn+"]",Cn="\\ud83c[\\udffb-\\udfff]",cn="(?:"+Vn+"|"+Cn+")",fr="[^"+Oi+"]",eo="(?:\\ud83c[\\udde6-\\uddff]){2}",Ao="[\\ud800-\\udbff][\\udc00-\\udfff]",_o="["+Zn+"]",za="\\u200d",Qo="(?:"+Ai+"|"+ci+")",il="(?:"+_o+"|"+ci+")",jr="(?:"+Ri+"(?:d|ll|m|re|s|t|ve))?",As="(?:"+Ri+"(?:D|LL|M|RE|S|T|VE))?",lo=cn+"?",es="["+Ei+"]?",Fi="(?:"+za+"(?:"+[fr,eo,Ao].join("|")+")"+es+lo+")*",Pl="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",$a="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",vr=es+lo+Fi,yr="(?:"+[oi,eo,Ao].join("|")+")"+vr,ts="(?:"+[fr+Vn+"?",Vn,eo,Ao,jo].join("|")+")",zr=RegExp(Ri,"g"),Ml=RegExp(Vn,"g"),fi=RegExp(Cn+"(?="+Cn+")|"+ts+vr,"g"),ns=RegExp([_o+"?"+Ai+"+"+jr+"(?="+[cr,_o,"$"].join("|")+")",il+"+"+As+"(?="+[cr,_o+Qo,"$"].join("|")+")",_o+"?"+Qo+"+"+jr,_o+"+"+As,$a,Pl,Ms,yr].join("|"),"g"),to=RegExp("["+za+Oi+ui+Ei+"]"),Ua=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,wu=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Al=-1,Er={};Er[Ke]=Er[ot]=Er[rt]=Er[Ft]=Er[Qt]=Er[Bn]=Er[Ln]=Er[Nn]=Er[ar]=!0,Er[ue]=Er[le]=Er[rn]=Er[Z]=Er[un]=Er[N]=Er[Me]=Er[Ue]=Er[ne]=Er[ye]=Er[We]=Er[Ze]=Er[et]=Er[He]=Er[kt]=!1;var Hr={};Hr[ue]=Hr[le]=Hr[rn]=Hr[un]=Hr[Z]=Hr[N]=Hr[Ke]=Hr[ot]=Hr[rt]=Hr[Ft]=Hr[Qt]=Hr[ne]=Hr[ye]=Hr[We]=Hr[Ze]=Hr[et]=Hr[He]=Hr[wt]=Hr[Bn]=Hr[Ln]=Hr[Nn]=Hr[ar]=!0,Hr[Me]=Hr[Ue]=Hr[kt]=!1;var Va={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Yu={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},kl={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Jl={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ol=parseFloat,Tl=parseInt,Xl=typeof ea=="object"&&ea&&ea.Object===Object&&ea,Zr=typeof self=="object"&&self&&self.Object===Object&&self,uo=Xl||Zr||Function("return this")(),lr=n&&!n.nodeType&&n,co=lr&&!0&&e&&!e.nodeType&&e,sl=co&&co.exports===lr,ya=sl&&Xl.process,qi=function(){try{var _t=co&&co.require&&co.require("util").types;return _t||ya&&ya.binding&&ya.binding("util")}catch{}}(),Ql=qi&&qi.isArrayBuffer,ta=qi&&qi.isDate,Nl=qi&&qi.isMap,Dl=qi&&qi.isRegExp,Fs=qi&&qi.isSet,Il=qi&&qi.isTypedArray;function vi(_t,Wt,Nt){switch(Nt.length){case 0:return _t.call(Wt);case 1:return _t.call(Wt,Nt[0]);case 2:return _t.call(Wt,Nt[0],Nt[1]);case 3:return _t.call(Wt,Nt[0],Nt[1],Nt[2])}return _t.apply(Wt,Nt)}function Ju(_t,Wt,Nt,An){for(var Jn=-1,xr=_t==null?0:_t.length;++Jn<xr;){var Wi=_t[Jn];Wt(An,Wi,Nt(Wi),_t)}return An}function ko(_t,Wt){for(var Nt=-1,An=_t==null?0:_t.length;++Nt<An&&Wt(_t[Nt],Nt,_t)!==!1;);return _t}function Hs(_t,Wt){for(var Nt=_t==null?0:_t.length;Nt--&&Wt(_t[Nt],Nt,_t)!==!1;);return _t}function Ol(_t,Wt){for(var Nt=-1,An=_t==null?0:_t.length;++Nt<An;)if(!Wt(_t[Nt],Nt,_t))return!1;return!0}function qs(_t,Wt){for(var Nt=-1,An=_t==null?0:_t.length,Jn=0,xr=[];++Nt<An;){var Wi=_t[Nt];Wt(Wi,Nt,_t)&&(xr[Jn++]=Wi)}return xr}function al(_t,Wt){var Nt=_t==null?0:_t.length;return!!Nt&&fn(_t,Wt,0)>-1}function ll(_t,Wt,Nt){for(var An=-1,Jn=_t==null?0:_t.length;++An<Jn;)if(Nt(Wt,_t[An]))return!0;return!1}function yi(_t,Wt){for(var Nt=-1,An=_t==null?0:_t.length,Jn=Array(An);++Nt<An;)Jn[Nt]=Wt(_t[Nt],Nt,_t);return Jn}function ks(_t,Wt){for(var Nt=-1,An=Wt.length,Jn=_t.length;++Nt<An;)_t[Jn+Nt]=Wt[Nt];return _t}function _a(_t,Wt,Nt,An){var Jn=-1,xr=_t==null?0:_t.length;for(An&&xr&&(Nt=_t[++Jn]);++Jn<xr;)Nt=Wt(Nt,_t[Jn],Jn,_t);return Nt}function fo(_t,Wt,Nt,An){var Jn=_t==null?0:_t.length;for(An&&Jn&&(Nt=_t[--Jn]);Jn--;)Nt=Wt(Nt,_t[Jn],Jn,_t);return Nt}function O(_t,Wt){for(var Nt=-1,An=_t==null?0:_t.length;++Nt<An;)if(Wt(_t[Nt],Nt,_t))return!0;return!1}var _e=_r("length");function Ye(_t){return _t.split("")}function ut(_t){return _t.match(Tt)||[]}function Lt(_t,Wt,Nt){var An;return Nt(_t,function(Jn,xr,Wi){if(Wt(Jn,xr,Wi))return An=xr,!1}),An}function Ut(_t,Wt,Nt,An){for(var Jn=_t.length,xr=Nt+(An?1:-1);An?xr--:++xr<Jn;)if(Wt(_t[xr],xr,_t))return xr;return-1}function fn(_t,Wt,Nt){return Wt===Wt?Po(_t,Wt,Nt):Ut(_t,zn,Nt)}function Dn(_t,Wt,Nt,An){for(var Jn=Nt-1,xr=_t.length;++Jn<xr;)if(An(_t[Jn],Wt))return Jn;return-1}function zn(_t){return _t!==_t}function ir(_t,Wt){var Nt=_t==null?0:_t.length;return Nt?_i(_t,Wt)/Nt:Ce}function _r(_t){return function(Wt){return Wt==null?t:Wt[_t]}}function $r(_t){return function(Wt){return _t==null?t:_t[Wt]}}function Gi(_t,Wt,Nt,An,Jn){return Jn(_t,function(xr,Wi,bi){Nt=An?(An=!1,xr):Wt(Nt,xr,Wi,bi)}),Nt}function hi(_t,Wt){var Nt=_t.length;for(_t.sort(Wt);Nt--;)_t[Nt]=_t[Nt].value;return _t}function _i(_t,Wt){for(var Nt,An=-1,Jn=_t.length;++An<Jn;){var xr=Wt(_t[An]);xr!==t&&(Nt=Nt===t?xr:Nt+xr)}return Nt}function ho(_t,Wt){for(var Nt=-1,An=Array(_t);++Nt<_t;)An[Nt]=Wt(Nt);return An}function bo(_t,Wt){return yi(Wt,function(Nt){return[Nt,_t[Nt]]})}function Ts(_t){return _t&&_t.slice(0,wa(_t)+1).replace(Hn,"")}function Ur(_t){return function(Wt){return _t(Wt)}}function zo(_t,Wt){return yi(Wt,function(Nt){return _t[Nt]})}function ul(_t,Wt){return _t.has(Wt)}function rs(_t,Wt){for(var Nt=-1,An=_t.length;++Nt<An&&fn(Wt,_t[Nt],0)>-1;);return Nt}function eu(_t,Wt){for(var Nt=_t.length;Nt--&&fn(Wt,_t[Nt],0)>-1;);return Nt}function na(_t,Wt){for(var Nt=_t.length,An=0;Nt--;)_t[Nt]===Wt&&++An;return An}var xu=$r(Va),Ga=$r(Yu);function Ha(_t){return"\\"+Jl[_t]}function wo(_t,Wt){return _t==null?t:_t[Wt]}function ra(_t){return to.test(_t)}function Ns(_t){return Ua.test(_t)}function gs(_t){for(var Wt,Nt=[];!(Wt=_t.next()).done;)Nt.push(Wt.value);return Nt}function cl(_t){var Wt=-1,Nt=Array(_t.size);return _t.forEach(function(An,Jn){Nt[++Wt]=[Jn,An]}),Nt}function $o(_t,Wt){return function(Nt){return _t(Wt(Nt))}}function is(_t,Wt){for(var Nt=-1,An=_t.length,Jn=0,xr=[];++Nt<An;){var Wi=_t[Nt];(Wi===Wt||Wi===m)&&(_t[Nt]=m,xr[Jn++]=Nt)}return xr}function os(_t){var Wt=-1,Nt=Array(_t.size);return _t.forEach(function(An){Nt[++Wt]=An}),Nt}function Xu(_t){var Wt=-1,Nt=Array(_t.size);return _t.forEach(function(An){Nt[++Wt]=[An,An]}),Nt}function Po(_t,Wt,Nt){for(var An=Nt-1,Jn=_t.length;++An<Jn;)if(_t[An]===Wt)return An;return-1}function ba(_t,Wt,Nt){for(var An=Nt+1;An--;)if(_t[An]===Wt)return An;return An}function Uo(_t){return ra(_t)?Go(_t):_e(_t)}function Vo(_t){return ra(_t)?To(_t):Ye(_t)}function wa(_t){for(var Wt=_t.length;Wt--&&St.test(_t.charAt(Wt)););return Wt}var xa=$r(kl);function Go(_t){for(var Wt=fi.lastIndex=0;fi.test(_t);)++Wt;return Wt}function To(_t){return _t.match(fi)||[]}function ia(_t){return _t.match(ns)||[]}var Ds=function _t(Wt){Wt=Wt==null?uo:Ho.defaults(uo.Object(),Wt,Ho.pick(uo,wu));var Nt=Wt.Array,An=Wt.Date,Jn=Wt.Error,xr=Wt.Function,Wi=Wt.Math,bi=Wt.Object,Bl=Wt.RegExp,ss=Wt.String,Zi=Wt.TypeError,oa=Nt.prototype,La=xr.prototype,sa=bi.prototype,aa=Wt["__core-js_shared__"],la=La.toString,Kr=sa.hasOwnProperty,Ws=0,No=function(){var c=/[^.]+$/.exec(aa&&aa.keys&&aa.keys.IE_PROTO||"");return c?"Symbol(src)_1."+c:""}(),wi=sa.toString,ki=la.call(bi),po=uo._,$i=Bl("^"+la.call(Kr).replace(bn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Is=sl?Wt.Buffer:t,ms=Wt.Symbol,js=Wt.Uint8Array,Lu=Is?Is.allocUnsafe:t,ua=$o(bi.getPrototypeOf,bi),xo=bi.create,ji=sa.propertyIsEnumerable,qo=oa.splice,vs=ms?ms.isConcatSpreadable:t,pr=ms?ms.iterator:t,Sa=ms?ms.toStringTag:t,Ea=function(){try{var c=Ff(bi,"defineProperty");return c({},"",{}),c}catch{}}(),Zs=Wt.clearTimeout!==uo.clearTimeout&&Wt.clearTimeout,as=An&&An.now!==uo.Date.now&&An.now,bc=Wt.setTimeout!==uo.setTimeout&&Wt.setTimeout,Do=Wi.ceil,Io=Wi.floor,Ks=bi.getOwnPropertySymbols,a=Is?Is.isBuffer:t,p=Wt.isFinite,S=oa.join,V=$o(bi.keys,bi),se=Wi.max,Se=Wi.min,st=An.now,At=Wt.parseInt,Vt=Wi.random,sn=oa.reverse,In=Ff(Wt,"DataView"),er=Ff(Wt,"Map"),Fr=Ff(Wt,"Promise"),Lo=Ff(Wt,"Set"),io=Ff(Wt,"WeakMap"),Oo=Ff(bi,"create"),Ki=io&&new io,ys={},wc=jf(In),ca=jf(er),Ys=jf(Fr),zs=jf(Lo),Tf=jf(io),tu=ms?ms.prototype:t,pi=tu?tu.valueOf:t,Wo=tu?tu.toString:t;function De(c){if(ls(c)&&!Jr(c)&&!(c instanceof Vr)){if(c instanceof Bo)return c;if(Kr.call(c,"__wrapped__"))return Jy(c)}return new Bo(c)}var _s=function(){function c(){}return function(g){if(!Ko(g))return{};if(xo)return xo(g);c.prototype=g;var A=new c;return c.prototype=t,A}}();function Su(){}function Bo(c,g){this.__wrapped__=c,this.__actions__=[],this.__chain__=!!g,this.__index__=0,this.__values__=t}De.templateSettings={escape:ii,evaluate:ft,interpolate:Qe,variable:"",imports:{_:De}},De.prototype=Su.prototype,De.prototype.constructor=De,Bo.prototype=_s(Su.prototype),Bo.prototype.constructor=Bo;function Vr(c){this.__wrapped__=c,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Te,this.__views__=[]}function Zc(){var c=new Vr(this.__wrapped__);return c.__actions__=hl(this.__actions__),c.__dir__=this.__dir__,c.__filtered__=this.__filtered__,c.__iteratees__=hl(this.__iteratees__),c.__takeCount__=this.__takeCount__,c.__views__=hl(this.__views__),c}function dh(){if(this.__filtered__){var c=new Vr(this);c.__dir__=-1,c.__filtered__=!0}else c=this.clone(),c.__dir__*=-1;return c}function Kc(){var c=this.__wrapped__.value(),g=this.__dir__,A=Jr(c),te=g<0,xe=A?c.length:0,Re=c3(0,xe,this.__views__),it=Re.start,gt=Re.end,Mt=gt-it,an=te?gt:it-1,ln=this.__iteratees__,yn=ln.length,Un=0,ur=Se(Mt,this.__takeCount__);if(!A||!te&&xe==Mt&&ur==Mt)return nu(c,this.__actions__);var Mr=[];e:for(;Mt--&&Un<ur;){an+=g;for(var li=-1,Ar=c[an];++li<yn;){var xi=ln[li],Ni=xi.iteratee,jl=xi.type,Ka=Ni(Ar);if(jl==W)Ar=Ka;else if(!Ka){if(jl==$)continue e;break e}}Mr[Un++]=Ar}return Mr}Vr.prototype=_s(Su.prototype),Vr.prototype.constructor=Vr;function qa(c){var g=-1,A=c==null?0:c.length;for(this.clear();++g<A;){var te=c[g];this.set(te[0],te[1])}}function xc(){this.__data__=Oo?Oo(null):{},this.size=0}function Nf(c){var g=this.has(c)&&delete this.__data__[c];return this.size-=g?1:0,g}function yd(c){var g=this.__data__;if(Oo){var A=g[c];return A===f?t:A}return Kr.call(g,c)?g[c]:t}function Qu(c){var g=this.__data__;return Oo?g[c]!==t:Kr.call(g,c)}function Yc(c,g){var A=this.__data__;return this.size+=this.has(c)?0:1,A[c]=Oo&&g===t?f:g,this}qa.prototype.clear=xc,qa.prototype.delete=Nf,qa.prototype.get=yd,qa.prototype.has=Qu,qa.prototype.set=Yc;function Rl(c){var g=-1,A=c==null?0:c.length;for(this.clear();++g<A;){var te=c[g];this.set(te[0],te[1])}}function _d(){this.__data__=[],this.size=0}function Jc(c){var g=this.__data__,A=yt(g,c);if(A<0)return!1;var te=g.length-1;return A==te?g.pop():qo.call(g,A,1),--this.size,!0}function Xc(c){var g=this.__data__,A=yt(g,c);return A<0?t:g[A][1]}function ph(c){return yt(this.__data__,c)>-1}function gh(c,g){var A=this.__data__,te=yt(A,c);return te<0?(++this.size,A.push([c,g])):A[te][1]=g,this}Rl.prototype.clear=_d,Rl.prototype.delete=Jc,Rl.prototype.get=Xc,Rl.prototype.has=ph,Rl.prototype.set=gh;function Ca(c){var g=-1,A=c==null?0:c.length;for(this.clear();++g<A;){var te=c[g];this.set(te[0],te[1])}}function mh(){this.size=0,this.__data__={hash:new qa,map:new(er||Rl),string:new qa}}function vh(c){var g=Yp(this,c).delete(c);return this.size-=g?1:0,g}function yh(c){return Yp(this,c).get(c)}function b(c){return Yp(this,c).has(c)}function P(c,g){var A=Yp(this,c),te=A.size;return A.set(c,g),this.size+=A.size==te?0:1,this}Ca.prototype.clear=mh,Ca.prototype.delete=vh,Ca.prototype.get=yh,Ca.prototype.has=b,Ca.prototype.set=P;function q(c){var g=-1,A=c==null?0:c.length;for(this.__data__=new Ca;++g<A;)this.add(c[g])}function ae(c){return this.__data__.set(c,f),this}function be(c){return this.__data__.has(c)}q.prototype.add=q.prototype.push=ae,q.prototype.has=be;function Ee(c){var g=this.__data__=new Rl(c);this.size=g.size}function Ae(){this.__data__=new Rl,this.size=0}function Ne(c){var g=this.__data__,A=g.delete(c);return this.size=g.size,A}function Ie(c){return this.__data__.get(c)}function Ve(c){return this.__data__.has(c)}function ht(c,g){var A=this.__data__;if(A instanceof Rl){var te=A.__data__;if(!er||te.length<i-1)return te.push([c,g]),this.size=++A.size,this;A=this.__data__=new Ca(te)}return A.set(c,g),this.size=A.size,this}Ee.prototype.clear=Ae,Ee.prototype.delete=Ne,Ee.prototype.get=Ie,Ee.prototype.has=Ve,Ee.prototype.set=ht;function Ot(c,g){var A=Jr(c),te=!A&&zf(c),xe=!A&&!te&&ef(c),Re=!A&&!te&&!xe&&Ph(c),it=A||te||xe||Re,gt=it?ho(c.length,ss):[],Mt=gt.length;for(var an in c)(g||Kr.call(c,an))&&!(it&&(an=="length"||xe&&(an=="offset"||an=="parent")||Re&&(an=="buffer"||an=="byteLength"||an=="byteOffset")||Mc(an,Mt)))&&gt.push(an);return gt}function Bt(c){var g=c.length;return g?c[Of(0,g-1)]:t}function xt(c,g){return Jp(hl(c),tr(g,0,c.length))}function Kt(c){return Jp(hl(c))}function Gt(c,g,A){(A!==t&&!ku(c[g],A)||A===t&&!(g in c))&&kn(c,g,A)}function dt(c,g,A){var te=c[g];(!(Kr.call(c,g)&&ku(te,A))||A===t&&!(g in c))&&kn(c,g,A)}function yt(c,g){for(var A=c.length;A--;)if(ku(c[A][0],g))return A;return-1}function en(c,g,A,te){return j(c,function(xe,Re,it){g(te,xe,A(xe),it)}),te}function dn(c,g){return c&&nc(g,Js(g),c)}function nn(c,g){return c&&nc(g,pl(g),c)}function kn(c,g,A){g=="__proto__"&&Ea?Ea(c,g,{configurable:!0,enumerable:!0,value:A,writable:!0}):c[g]=A}function Pn(c,g){for(var A=-1,te=g.length,xe=Nt(te),Re=c==null;++A<te;)xe[A]=Re?t:C0(c,g[A]);return xe}function tr(c,g,A){return c===c&&(A!==t&&(c=c<=A?c:A),g!==t&&(c=c>=g?c:g)),c}function l(c,g,A,te,xe,Re){var it,gt=g&_,Mt=g&w,an=g&y;if(A&&(it=xe?A(c,te,xe,Re):A(c)),it!==t)return it;if(!Ko(c))return c;var ln=Jr(c);if(ln){if(it=h3(c),!gt)return hl(c,it)}else{var yn=Ma(c),Un=yn==Ue||yn==ce;if(ef(c))return Ly(c,gt);if(yn==We||yn==ue||Un&&!xe){if(it=Mt||Un?{}:Uy(c),!gt)return Mt?t3(c,nn(it,c)):e3(c,dn(it,c))}else{if(!Hr[yn])return xe?c:{};it=d3(c,yn,gt)}}Re||(Re=new Ee);var ur=Re.get(c);if(ur)return ur;Re.set(c,it),v2(c)?c.forEach(function(Ar){it.add(l(Ar,g,A,Ar,c,Re))}):g2(c)&&c.forEach(function(Ar,xi){it.set(xi,l(Ar,g,A,xi,c,Re))});var Mr=an?Mt?h0:f0:Mt?pl:Js,li=ln?t:Mr(c);return ko(li||c,function(Ar,xi){li&&(xi=Ar,Ar=c[xi]),dt(it,xi,l(Ar,g,A,xi,c,Re))}),it}function h(c){var g=Js(c);return function(A){return v(A,c,g)}}function v(c,g,A){var te=A.length;if(c==null)return!te;for(c=bi(c);te--;){var xe=A[te],Re=g[xe],it=c[xe];if(it===t&&!(xe in c)||!Re(it))return!1}return!0}function x(c,g,A){if(typeof c!="function")throw new Zi(o);return Sd(function(){c.apply(t,A)},g)}function E(c,g,A,te){var xe=-1,Re=al,it=!0,gt=c.length,Mt=[],an=g.length;if(!gt)return Mt;A&&(g=yi(g,Ur(A))),te?(Re=ll,it=!1):g.length>=i&&(Re=ul,it=!1,g=new q(g));e:for(;++xe<gt;){var ln=c[xe],yn=A==null?ln:A(ln);if(ln=te||ln!==0?ln:0,it&&yn===yn){for(var Un=an;Un--;)if(g[Un]===yn)continue e;Mt.push(ln)}else Re(g,yn,te)||Mt.push(ln)}return Mt}var j=My(Xt),X=My(_n,!0);function re(c,g){var A=!0;return j(c,function(te,xe,Re){return A=!!g(te,xe,Re),A}),A}function ge(c,g,A){for(var te=-1,xe=c.length;++te<xe;){var Re=c[te],it=g(Re);if(it!=null&&(gt===t?it===it&&!Fl(it):A(it,gt)))var gt=it,Mt=Re}return Mt}function Le(c,g,A,te){var xe=c.length;for(A=ai(A),A<0&&(A=-A>xe?0:xe+A),te=te===t||te>xe?xe:ai(te),te<0&&(te+=xe),te=A>te?0:_2(te);A<te;)c[A++]=g;return c}function Xe(c,g){var A=[];return j(c,function(te,xe,Re){g(te,xe,Re)&&A.push(te)}),A}function ze(c,g,A,te,xe){var Re=-1,it=c.length;for(A||(A=g3),xe||(xe=[]);++Re<it;){var gt=c[Re];g>0&&A(gt)?g>1?ze(gt,g-1,A,te,xe):ks(xe,gt):te||(xe[xe.length]=gt)}return xe}var vt=Ay(),Dt=Ay(!0);function Xt(c,g){return c&&vt(c,g,Js)}function _n(c,g){return c&&Dt(c,g,Js)}function Sn(c,g){return qs(g,function(A){return Ac(c[A])})}function hr(c,g){g=Au(g,c);for(var A=0,te=g.length;c!=null&&A<te;)c=c[rc(g[A++])];return A&&A==te?c:t}function Je(c,g,A){var te=g(c);return Jr(c)?te:ks(te,A(c))}function nt(c){return c==null?c===t?Pt:de:Sa&&Sa in bi(c)?u3(c):x3(c)}function ct(c,g){return c>g}function Rt(c,g){return c!=null&&Kr.call(c,g)}function bt(c,g){return c!=null&&g in bi(c)}function It(c,g,A){return c>=Se(g,A)&&c<se(g,A)}function me(c,g,A){for(var te=A?ll:al,xe=c[0].length,Re=c.length,it=Re,gt=Nt(Re),Mt=1/0,an=[];it--;){var ln=c[it];it&&g&&(ln=yi(ln,Ur(g))),Mt=Se(ln.length,Mt),gt[it]=!A&&(g||xe>=120&&ln.length>=120)?new q(it&&ln):t}ln=c[0];var yn=-1,Un=gt[0];e:for(;++yn<xe&&an.length<Mt;){var ur=ln[yn],Mr=g?g(ur):ur;if(ur=A||ur!==0?ur:0,!(Un?ul(Un,Mr):te(an,Mr,A))){for(it=Re;--it;){var li=gt[it];if(!(li?ul(li,Mr):te(c[it],Mr,A)))continue e}Un&&Un.push(Mr),an.push(ur)}}return an}function Pe(c,g,A,te){return Xt(c,function(xe,Re,it){g(te,A(xe),Re,it)}),te}function Be(c,g,A){g=Au(g,c),c=qy(c,g);var te=c==null?c:c[rc(ou(g))];return te==null?t:vi(te,c,A)}function Oe(c){return ls(c)&&nt(c)==ue}function Fe(c){return ls(c)&&nt(c)==rn}function je(c){return ls(c)&&nt(c)==N}function at(c,g,A,te,xe){return c===g?!0:c==null||g==null||!ls(c)&&!ls(g)?c!==c&&g!==g:lt(c,g,A,te,at,xe)}function lt(c,g,A,te,xe,Re){var it=Jr(c),gt=Jr(g),Mt=it?le:Ma(c),an=gt?le:Ma(g);Mt=Mt==ue?We:Mt,an=an==ue?We:an;var ln=Mt==We,yn=an==We,Un=Mt==an;if(Un&&ef(c)){if(!ef(g))return!1;it=!0,ln=!1}if(Un&&!ln)return Re||(Re=new Ee),it||Ph(c)?jy(c,g,A,te,xe,Re):a3(c,g,Mt,A,te,xe,Re);if(!(A&M)){var ur=ln&&Kr.call(c,"__wrapped__"),Mr=yn&&Kr.call(g,"__wrapped__");if(ur||Mr){var li=ur?c.value():c,Ar=Mr?g.value():g;return Re||(Re=new Ee),xe(li,Ar,A,te,Re)}}return Un?(Re||(Re=new Ee),l3(c,g,A,te,xe,Re)):!1}function pt(c){return ls(c)&&Ma(c)==ne}function Et(c,g,A,te){var xe=A.length,Re=xe,it=!te;if(c==null)return!Re;for(c=bi(c);xe--;){var gt=A[xe];if(it&&gt[2]?gt[1]!==c[gt[0]]:!(gt[0]in c))return!1}for(;++xe<Re;){gt=A[xe];var Mt=gt[0],an=c[Mt],ln=gt[1];if(it&&gt[2]){if(an===t&&!(Mt in c))return!1}else{var yn=new Ee;if(te)var Un=te(an,ln,Mt,c,g,yn);if(!(Un===t?at(ln,an,M|k,te,yn):Un))return!1}}return!0}function Ct(c){if(!Ko(c)||v3(c))return!1;var g=Ac(c)?$i:Mi;return g.test(jf(c))}function on(c){return ls(c)&&nt(c)==Ze}function $n(c){return ls(c)&&Ma(c)==et}function Wn(c){return ls(c)&&rg(c.length)&&!!Er[nt(c)]}function nr(c){return typeof c=="function"?c:c==null?gl:typeof c=="object"?Jr(c)?Eu(c[0],c[1]):bs(c):k2(c)}function gi(c){if(!Ld(c))return V(c);var g=[];for(var A in bi(c))Kr.call(c,A)&&A!="constructor"&&g.push(A);return g}function Ti(c){if(!Ko(c))return w3(c);var g=Ld(c),A=[];for(var te in c)te=="constructor"&&(g||!Kr.call(c,te))||A.push(te);return A}function Yr(c,g){return c<g}function Ui(c,g){var A=-1,te=dl(c)?Nt(c.length):[];return j(c,function(xe,Re,it){te[++A]=g(xe,Re,it)}),te}function bs(c){var g=p0(c);return g.length==1&&g[0][2]?Gy(g[0][0],g[0][1]):function(A){return A===c||Et(A,c,g)}}function Eu(c,g){return m0(c)&&Vy(g)?Gy(rc(c),g):function(A){var te=C0(A,c);return te===t&&te===g?P0(A,c):at(g,te,M|k)}}function fa(c,g,A,te,xe){c!==g&&vt(g,function(Re,it){if(xe||(xe=new Ee),Ko(Re))Df(c,g,it,A,fa,te,xe);else{var gt=te?te(y0(c,it),Re,it+"",c,g,xe):t;gt===t&&(gt=Re),Gt(c,it,gt)}},pl)}function Df(c,g,A,te,xe,Re,it){var gt=y0(c,A),Mt=y0(g,A),an=it.get(Mt);if(an){Gt(c,A,an);return}var ln=Re?Re(gt,Mt,A+"",c,g,it):t,yn=ln===t;if(yn){var Un=Jr(Mt),ur=!Un&&ef(Mt),Mr=!Un&&!ur&&Ph(Mt);ln=Mt,Un||ur||Mr?Jr(gt)?ln=gt:ws(gt)?ln=hl(gt):ur?(yn=!1,ln=Ly(Mt,!0)):Mr?(yn=!1,ln=Sy(Mt,!0)):ln=[]:Ed(Mt)||zf(Mt)?(ln=gt,zf(gt)?ln=b2(gt):(!Ko(gt)||Ac(gt))&&(ln=Uy(Mt))):yn=!1}yn&&(it.set(Mt,ln),xe(ln,Mt,te,Re,it),it.delete(Mt)),Gt(c,A,ln)}function Wa(c,g){var A=c.length;if(A)return g+=g<0?A:0,Mc(g,A)?c[g]:t}function ec(c,g,A){g.length?g=yi(g,function(Re){return Jr(Re)?function(it){return hr(it,Re.length===1?Re[0]:Re)}:Re}):g=[gl];var te=-1;g=yi(g,Ur(Cr()));var xe=Ui(c,function(Re,it,gt){var Mt=yi(g,function(an){return an(Re)});return{criteria:Mt,index:++te,value:Re}});return hi(xe,function(Re,it){return Qx(Re,it,A)})}function ha(c,g){return Zo(c,g,function(A,te){return P0(c,te)})}function Zo(c,g,A){for(var te=-1,xe=g.length,Re={};++te<xe;){var it=g[te],gt=hr(c,it);A(gt,it)&&Lc(Re,Au(it,c),gt)}return Re}function go(c){return function(g){return hr(g,c)}}function _h(c,g,A,te){var xe=te?Dn:fn,Re=-1,it=g.length,gt=c;for(c===g&&(g=hl(g)),A&&(gt=yi(c,Ur(A)));++Re<it;)for(var Mt=0,an=g[Re],ln=A?A(an):an;(Mt=xe(gt,ln,Mt,te))>-1;)gt!==c&&qo.call(gt,Mt,1),qo.call(c,Mt,1);return c}function If(c,g){for(var A=c?g.length:0,te=A-1;A--;){var xe=g[A];if(A==te||xe!==Re){var Re=xe;Mc(xe)?qo.call(c,xe,1):Sc(c,xe)}}return c}function Of(c,g){return c+Io(Vt()*(g-c+1))}function Bf(c,g,A,te){for(var xe=-1,Re=se(Do((g-c)/(A||1)),0),it=Nt(Re);Re--;)it[te?Re:++xe]=c,c+=A;return it}function bh(c,g){var A="";if(!c||g<1||g>ie)return A;do g%2&&(A+=c),g=Io(g/2),g&&(c+=c);while(g);return A}function si(c,g){return _0(Hy(c,g,gl),c+"")}function wh(c){return Bt(Mh(c))}function jp(c,g){var A=Mh(c);return Jp(A,tr(g,0,A.length))}function Lc(c,g,A,te){if(!Ko(c))return c;g=Au(g,c);for(var xe=-1,Re=g.length,it=Re-1,gt=c;gt!=null&&++xe<Re;){var Mt=rc(g[xe]),an=A;if(Mt==="__proto__"||Mt==="constructor"||Mt==="prototype")return c;if(xe!=it){var ln=gt[Mt];an=te?te(ln,Mt,gt):t,an===t&&(an=Ko(ln)?ln:Mc(g[xe+1])?[]:{})}dt(gt,Mt,an),gt=gt[Mt]}return c}var Cu=Ki?function(c,g){return Ki.set(c,g),c}:gl,zp=Ea?function(c,g){return Ea(c,"toString",{configurable:!0,enumerable:!1,value:A0(g),writable:!0})}:gl;function $p(c){return Jp(Mh(c))}function fl(c,g,A){var te=-1,xe=c.length;g<0&&(g=-g>xe?0:xe+g),A=A>xe?xe:A,A<0&&(A+=xe),xe=g>A?0:A-g>>>0,g>>>=0;for(var Re=Nt(xe);++te<xe;)Re[te]=c[te+g];return Re}function Up(c,g){var A;return j(c,function(te,xe,Re){return A=g(te,xe,Re),!A}),!!A}function Pu(c,g,A){var te=0,xe=c==null?te:c.length;if(typeof g=="number"&&g===g&&xe<=H){for(;te<xe;){var Re=te+xe>>>1,it=c[Re];it!==null&&!Fl(it)&&(A?it<=g:it<g)?te=Re+1:xe=Re}return xe}return bd(c,g,gl,A)}function bd(c,g,A,te){var xe=0,Re=c==null?0:c.length;if(Re===0)return 0;g=A(g);for(var it=g!==g,gt=g===null,Mt=Fl(g),an=g===t;xe<Re;){var ln=Io((xe+Re)/2),yn=A(c[ln]),Un=yn!==t,ur=yn===null,Mr=yn===yn,li=Fl(yn);if(it)var Ar=te||Mr;else an?Ar=Mr&&(te||Un):gt?Ar=Mr&&Un&&(te||!ur):Mt?Ar=Mr&&Un&&!ur&&(te||!li):ur||li?Ar=!1:Ar=te?yn<=g:yn<g;Ar?xe=ln+1:Re=ln}return Se(Re,Y)}function wd(c,g){for(var A=-1,te=c.length,xe=0,Re=[];++A<te;){var it=c[A],gt=g?g(it):it;if(!A||!ku(gt,Mt)){var Mt=gt;Re[xe++]=it===0?0:it}}return Re}function Vp(c){return typeof c=="number"?c:Fl(c)?Ce:+c}function Pa(c){if(typeof c=="string")return c;if(Jr(c))return yi(c,Pa)+"";if(Fl(c))return Wo?Wo.call(c):"";var g=c+"";return g=="0"&&1/c==-1/0?"-0":g}function tc(c,g,A){var te=-1,xe=al,Re=c.length,it=!0,gt=[],Mt=gt;if(A)it=!1,xe=ll;else if(Re>=i){var an=g?null:o3(c);if(an)return os(an);it=!1,xe=ul,Mt=new q}else Mt=g?[]:gt;e:for(;++te<Re;){var ln=c[te],yn=g?g(ln):ln;if(ln=A||ln!==0?ln:0,it&&yn===yn){for(var Un=Mt.length;Un--;)if(Mt[Un]===yn)continue e;g&&Mt.push(yn),gt.push(ln)}else xe(Mt,yn,A)||(Mt!==gt&&Mt.push(yn),gt.push(ln))}return gt}function Sc(c,g){return g=Au(g,c),c=qy(c,g),c==null||delete c[rc(ou(g))]}function xh(c,g,A,te){return Lc(c,g,A(hr(c,g)),te)}function Ec(c,g,A,te){for(var xe=c.length,Re=te?xe:-1;(te?Re--:++Re<xe)&&g(c[Re],Re,c););return A?fl(c,te?0:Re,te?Re+1:xe):fl(c,te?Re+1:0,te?xe:Re)}function nu(c,g){var A=c;return A instanceof Vr&&(A=A.value()),_a(g,function(te,xe){return xe.func.apply(xe.thisArg,ks([te],xe.args))},A)}function ru(c,g,A){var te=c.length;if(te<2)return te?tc(c[0]):[];for(var xe=-1,Re=Nt(te);++xe<te;)for(var it=c[xe],gt=-1;++gt<te;)gt!=xe&&(Re[xe]=E(Re[xe]||it,c[gt],g,A));return tc(ze(Re,1),g,A)}function Mu(c,g,A){for(var te=-1,xe=c.length,Re=g.length,it={};++te<xe;){var gt=te<Re?g[te]:t;A(it,c[te],gt)}return it}function Qc(c){return ws(c)?c:[]}function Rf(c){return typeof c=="function"?c:gl}function Au(c,g){return Jr(c)?c:m0(c,g)?[c]:Yy(no(c))}var a0=si;function iu(c,g,A){var te=c.length;return A=A===t?te:A,!g&&A>=te?c:fl(c,g,A)}var Lh=Zs||function(c){return uo.clearTimeout(c)};function Ly(c,g){if(g)return c.slice();var A=c.length,te=Lu?Lu(A):new c.constructor(A);return c.copy(te),te}function l0(c){var g=new c.constructor(c.byteLength);return new js(g).set(new js(c)),g}function Yx(c,g){var A=g?l0(c.buffer):c.buffer;return new c.constructor(A,c.byteOffset,c.byteLength)}function Jx(c){var g=new c.constructor(c.source,Sr.exec(c));return g.lastIndex=c.lastIndex,g}function Xx(c){return pi?bi(pi.call(c)):{}}function Sy(c,g){var A=g?l0(c.buffer):c.buffer;return new c.constructor(A,c.byteOffset,c.length)}function Ey(c,g){if(c!==g){var A=c!==t,te=c===null,xe=c===c,Re=Fl(c),it=g!==t,gt=g===null,Mt=g===g,an=Fl(g);if(!gt&&!an&&!Re&&c>g||Re&&it&&Mt&&!gt&&!an||te&&it&&Mt||!A&&Mt||!xe)return 1;if(!te&&!Re&&!an&&c<g||an&&A&&xe&&!te&&!Re||gt&&A&&xe||!it&&xe||!Mt)return-1}return 0}function Qx(c,g,A){for(var te=-1,xe=c.criteria,Re=g.criteria,it=xe.length,gt=A.length;++te<it;){var Mt=Ey(xe[te],Re[te]);if(Mt){if(te>=gt)return Mt;var an=A[te];return Mt*(an=="desc"?-1:1)}}return c.index-g.index}function Cy(c,g,A,te){for(var xe=-1,Re=c.length,it=A.length,gt=-1,Mt=g.length,an=se(Re-it,0),ln=Nt(Mt+an),yn=!te;++gt<Mt;)ln[gt]=g[gt];for(;++xe<it;)(yn||xe<Re)&&(ln[A[xe]]=c[xe]);for(;an--;)ln[gt++]=c[xe++];return ln}function Py(c,g,A,te){for(var xe=-1,Re=c.length,it=-1,gt=A.length,Mt=-1,an=g.length,ln=se(Re-gt,0),yn=Nt(ln+an),Un=!te;++xe<ln;)yn[xe]=c[xe];for(var ur=xe;++Mt<an;)yn[ur+Mt]=g[Mt];for(;++it<gt;)(Un||xe<Re)&&(yn[ur+A[it]]=c[xe++]);return yn}function hl(c,g){var A=-1,te=c.length;for(g||(g=Nt(te));++A<te;)g[A]=c[A];return g}function nc(c,g,A,te){var xe=!A;A||(A={});for(var Re=-1,it=g.length;++Re<it;){var gt=g[Re],Mt=te?te(A[gt],c[gt],gt,A,c):t;Mt===t&&(Mt=c[gt]),xe?kn(A,gt,Mt):dt(A,gt,Mt)}return A}function e3(c,g){return nc(c,g0(c),g)}function t3(c,g){return nc(c,zy(c),g)}function Gp(c,g){return function(A,te){var xe=Jr(A)?Ju:en,Re=g?g():{};return xe(A,c,Cr(te,2),Re)}}function Sh(c){return si(function(g,A){var te=-1,xe=A.length,Re=xe>1?A[xe-1]:t,it=xe>2?A[2]:t;for(Re=c.length>3&&typeof Re=="function"?(xe--,Re):t,it&&Za(A[0],A[1],it)&&(Re=xe<3?t:Re,xe=1),g=bi(g);++te<xe;){var gt=A[te];gt&&c(g,gt,te,Re)}return g})}function My(c,g){return function(A,te){if(A==null)return A;if(!dl(A))return c(A,te);for(var xe=A.length,Re=g?xe:-1,it=bi(A);(g?Re--:++Re<xe)&&te(it[Re],Re,it)!==!1;);return A}}function Ay(c){return function(g,A,te){for(var xe=-1,Re=bi(g),it=te(g),gt=it.length;gt--;){var Mt=it[c?gt:++xe];if(A(Re[Mt],Mt,Re)===!1)break}return g}}function n3(c,g,A){var te=g&F,xe=xd(c);function Re(){var it=this&&this!==uo&&this instanceof Re?xe:c;return it.apply(te?A:this,arguments)}return Re}function ky(c){return function(g){g=no(g);var A=ra(g)?Vo(g):t,te=A?A[0]:g.charAt(0),xe=A?iu(A,1).join(""):g.slice(1);return te[c]()+xe}}function Eh(c){return function(g){return _a(M2(P2(g).replace(zr,"")),c,"")}}function xd(c){return function(){var g=arguments;switch(g.length){case 0:return new c;case 1:return new c(g[0]);case 2:return new c(g[0],g[1]);case 3:return new c(g[0],g[1],g[2]);case 4:return new c(g[0],g[1],g[2],g[3]);case 5:return new c(g[0],g[1],g[2],g[3],g[4]);case 6:return new c(g[0],g[1],g[2],g[3],g[4],g[5]);case 7:return new c(g[0],g[1],g[2],g[3],g[4],g[5],g[6])}var A=_s(c.prototype),te=c.apply(A,g);return Ko(te)?te:A}}function r3(c,g,A){var te=xd(c);function xe(){for(var Re=arguments.length,it=Nt(Re),gt=Re,Mt=Ch(xe);gt--;)it[gt]=arguments[gt];var an=Re<3&&it[0]!==Mt&&it[Re-1]!==Mt?[]:is(it,Mt);if(Re-=an.length,Re<A)return Oy(c,g,Hp,xe.placeholder,t,it,an,t,t,A-Re);var ln=this&&this!==uo&&this instanceof xe?te:c;return vi(ln,this,it)}return xe}function Ty(c){return function(g,A,te){var xe=bi(g);if(!dl(g)){var Re=Cr(A,3);g=Js(g),A=function(gt){return Re(xe[gt],gt,xe)}}var it=c(g,A,te);return it>-1?xe[Re?g[it]:it]:t}}function Ny(c){return Pc(function(g){var A=g.length,te=A,xe=Bo.prototype.thru;for(c&&g.reverse();te--;){var Re=g[te];if(typeof Re!="function")throw new Zi(o);if(xe&&!it&&Kp(Re)=="wrapper")var it=new Bo([],!0)}for(te=it?te:A;++te<A;){Re=g[te];var gt=Kp(Re),Mt=gt=="wrapper"?d0(Re):t;Mt&&v0(Mt[0])&&Mt[1]==(ve|K|he|z)&&!Mt[4].length&&Mt[9]==1?it=it[Kp(Mt[0])].apply(it,Mt[3]):it=Re.length==1&&v0(Re)?it[gt]():it.thru(Re)}return function(){var an=arguments,ln=an[0];if(it&&an.length==1&&Jr(ln))return it.plant(ln).value();for(var yn=0,Un=A?g[yn].apply(this,an):ln;++yn<A;)Un=g[yn].call(this,Un);return Un}})}function Hp(c,g,A,te,xe,Re,it,gt,Mt,an){var ln=g&ve,yn=g&F,Un=g&I,ur=g&(K|ee),Mr=g&U,li=Un?t:xd(c);function Ar(){for(var xi=arguments.length,Ni=Nt(xi),jl=xi;jl--;)Ni[jl]=arguments[jl];if(ur)var Ka=Ch(Ar),zl=na(Ni,Ka);if(te&&(Ni=Cy(Ni,te,xe,ur)),Re&&(Ni=Py(Ni,Re,it,ur)),xi-=zl,ur&&xi<an){var xs=is(Ni,Ka);return Oy(c,g,Hp,Ar.placeholder,A,Ni,xs,gt,Mt,an-xi)}var Tu=yn?A:this,Tc=Un?Tu[c]:c;return xi=Ni.length,gt?Ni=L3(Ni,gt):Mr&&xi>1&&Ni.reverse(),ln&&Mt<xi&&(Ni.length=Mt),this&&this!==uo&&this instanceof Ar&&(Tc=li||xd(Tc)),Tc.apply(Tu,Ni)}return Ar}function Dy(c,g){return function(A,te){return Pe(A,c,g(te),{})}}function qp(c,g){return function(A,te){var xe;if(A===t&&te===t)return g;if(A!==t&&(xe=A),te!==t){if(xe===t)return te;typeof A=="string"||typeof te=="string"?(A=Pa(A),te=Pa(te)):(A=Vp(A),te=Vp(te)),xe=c(A,te)}return xe}}function u0(c){return Pc(function(g){return g=yi(g,Ur(Cr())),si(function(A){var te=this;return c(g,function(xe){return vi(xe,te,A)})})})}function Wp(c,g){g=g===t?" ":Pa(g);var A=g.length;if(A<2)return A?bh(g,c):g;var te=bh(g,Do(c/Uo(g)));return ra(g)?iu(Vo(te),0,c).join(""):te.slice(0,c)}function i3(c,g,A,te){var xe=g&F,Re=xd(c);function it(){for(var gt=-1,Mt=arguments.length,an=-1,ln=te.length,yn=Nt(ln+Mt),Un=this&&this!==uo&&this instanceof it?Re:c;++an<ln;)yn[an]=te[an];for(;Mt--;)yn[an++]=arguments[++gt];return vi(Un,xe?A:this,yn)}return it}function Iy(c){return function(g,A,te){return te&&typeof te!="number"&&Za(g,A,te)&&(A=te=t),g=kc(g),A===t?(A=g,g=0):A=kc(A),te=te===t?g<A?1:-1:kc(te),Bf(g,A,te,c)}}function Zp(c){return function(g,A){return typeof g=="string"&&typeof A=="string"||(g=su(g),A=su(A)),c(g,A)}}function Oy(c,g,A,te,xe,Re,it,gt,Mt,an){var ln=g&K,yn=ln?it:t,Un=ln?t:it,ur=ln?Re:t,Mr=ln?t:Re;g|=ln?he:fe,g&=~(ln?fe:he),g&R||(g&=-4);var li=[c,g,xe,ur,yn,Mr,Un,gt,Mt,an],Ar=A.apply(t,li);return v0(c)&&Wy(Ar,li),Ar.placeholder=te,Zy(Ar,c,g)}function c0(c){var g=Wi[c];return function(A,te){if(A=su(A),te=te==null?0:Se(ai(te),292),te&&p(A)){var xe=(no(A)+"e").split("e"),Re=g(xe[0]+"e"+(+xe[1]+te));return xe=(no(Re)+"e").split("e"),+(xe[0]+"e"+(+xe[1]-te))}return g(A)}}var o3=Lo&&1/os(new Lo([,-0]))[1]==oe?function(c){return new Lo(c)}:N0;function By(c){return function(g){var A=Ma(g);return A==ne?cl(g):A==et?Xu(g):bo(g,c(g))}}function Cc(c,g,A,te,xe,Re,it,gt){var Mt=g&I;if(!Mt&&typeof c!="function")throw new Zi(o);var an=te?te.length:0;if(an||(g&=-97,te=xe=t),it=it===t?it:se(ai(it),0),gt=gt===t?gt:ai(gt),an-=xe?xe.length:0,g&fe){var ln=te,yn=xe;te=xe=t}var Un=Mt?t:d0(c),ur=[c,g,A,te,xe,ln,yn,Re,it,gt];if(Un&&b3(ur,Un),c=ur[0],g=ur[1],A=ur[2],te=ur[3],xe=ur[4],gt=ur[9]=ur[9]===t?Mt?0:c.length:se(ur[9]-an,0),!gt&&g&(K|ee)&&(g&=-25),!g||g==F)var Mr=n3(c,g,A);else g==K||g==ee?Mr=r3(c,g,gt):(g==he||g==(F|he))&&!xe.length?Mr=i3(c,g,A,te):Mr=Hp.apply(t,ur);var li=Un?Cu:Wy;return Zy(li(Mr,ur),c,g)}function Ry(c,g,A,te){return c===t||ku(c,sa[A])&&!Kr.call(te,A)?g:c}function Fy(c,g,A,te,xe,Re){return Ko(c)&&Ko(g)&&(Re.set(g,c),fa(c,g,t,Fy,Re),Re.delete(g)),c}function s3(c){return Ed(c)?t:c}function jy(c,g,A,te,xe,Re){var it=A&M,gt=c.length,Mt=g.length;if(gt!=Mt&&!(it&&Mt>gt))return!1;var an=Re.get(c),ln=Re.get(g);if(an&&ln)return an==g&&ln==c;var yn=-1,Un=!0,ur=A&k?new q:t;for(Re.set(c,g),Re.set(g,c);++yn<gt;){var Mr=c[yn],li=g[yn];if(te)var Ar=it?te(li,Mr,yn,g,c,Re):te(Mr,li,yn,c,g,Re);if(Ar!==t){if(Ar)continue;Un=!1;break}if(ur){if(!O(g,function(xi,Ni){if(!ul(ur,Ni)&&(Mr===xi||xe(Mr,xi,A,te,Re)))return ur.push(Ni)})){Un=!1;break}}else if(!(Mr===li||xe(Mr,li,A,te,Re))){Un=!1;break}}return Re.delete(c),Re.delete(g),Un}function a3(c,g,A,te,xe,Re,it){switch(A){case un:if(c.byteLength!=g.byteLength||c.byteOffset!=g.byteOffset)return!1;c=c.buffer,g=g.buffer;case rn:return!(c.byteLength!=g.byteLength||!Re(new js(c),new js(g)));case Z:case N:case ye:return ku(+c,+g);case Me:return c.name==g.name&&c.message==g.message;case Ze:case He:return c==g+"";case ne:var gt=cl;case et:var Mt=te&M;if(gt||(gt=os),c.size!=g.size&&!Mt)return!1;var an=it.get(c);if(an)return an==g;te|=k,it.set(c,g);var ln=jy(gt(c),gt(g),te,xe,Re,it);return it.delete(c),ln;case wt:if(pi)return pi.call(c)==pi.call(g)}return!1}function l3(c,g,A,te,xe,Re){var it=A&M,gt=f0(c),Mt=gt.length,an=f0(g),ln=an.length;if(Mt!=ln&&!it)return!1;for(var yn=Mt;yn--;){var Un=gt[yn];if(!(it?Un in g:Kr.call(g,Un)))return!1}var ur=Re.get(c),Mr=Re.get(g);if(ur&&Mr)return ur==g&&Mr==c;var li=!0;Re.set(c,g),Re.set(g,c);for(var Ar=it;++yn<Mt;){Un=gt[yn];var xi=c[Un],Ni=g[Un];if(te)var jl=it?te(Ni,xi,Un,g,c,Re):te(xi,Ni,Un,c,g,Re);if(!(jl===t?xi===Ni||xe(xi,Ni,A,te,Re):jl)){li=!1;break}Ar||(Ar=Un=="constructor")}if(li&&!Ar){var Ka=c.constructor,zl=g.constructor;Ka!=zl&&"constructor"in c&&"constructor"in g&&!(typeof Ka=="function"&&Ka instanceof Ka&&typeof zl=="function"&&zl instanceof zl)&&(li=!1)}return Re.delete(c),Re.delete(g),li}function Pc(c){return _0(Hy(c,t,e2),c+"")}function f0(c){return Je(c,Js,g0)}function h0(c){return Je(c,pl,zy)}var d0=Ki?function(c){return Ki.get(c)}:N0;function Kp(c){for(var g=c.name+"",A=ys[g],te=Kr.call(ys,g)?A.length:0;te--;){var xe=A[te],Re=xe.func;if(Re==null||Re==c)return xe.name}return g}function Ch(c){var g=Kr.call(De,"placeholder")?De:c;return g.placeholder}function Cr(){var c=De.iteratee||k0;return c=c===k0?nr:c,arguments.length?c(arguments[0],arguments[1]):c}function Yp(c,g){var A=c.__data__;return m3(g)?A[typeof g=="string"?"string":"hash"]:A.map}function p0(c){for(var g=Js(c),A=g.length;A--;){var te=g[A],xe=c[te];g[A]=[te,xe,Vy(xe)]}return g}function Ff(c,g){var A=wo(c,g);return Ct(A)?A:t}function u3(c){var g=Kr.call(c,Sa),A=c[Sa];try{c[Sa]=t;var te=!0}catch{}var xe=wi.call(c);return te&&(g?c[Sa]=A:delete c[Sa]),xe}var g0=Ks?function(c){return c==null?[]:(c=bi(c),qs(Ks(c),function(g){return ji.call(c,g)}))}:D0,zy=Ks?function(c){for(var g=[];c;)ks(g,g0(c)),c=ua(c);return g}:D0,Ma=nt;(In&&Ma(new In(new ArrayBuffer(1)))!=un||er&&Ma(new er)!=ne||Fr&&Ma(Fr.resolve())!=Ge||Lo&&Ma(new Lo)!=et||io&&Ma(new io)!=kt)&&(Ma=function(c){var g=nt(c),A=g==We?c.constructor:t,te=A?jf(A):"";if(te)switch(te){case wc:return un;case ca:return ne;case Ys:return Ge;case zs:return et;case Tf:return kt}return g});function c3(c,g,A){for(var te=-1,xe=A.length;++te<xe;){var Re=A[te],it=Re.size;switch(Re.type){case"drop":c+=it;break;case"dropRight":g-=it;break;case"take":g=Se(g,c+it);break;case"takeRight":c=se(c,g-it);break}}return{start:c,end:g}}function f3(c){var g=c.match(wn);return g?g[1].split(Qr):[]}function $y(c,g,A){g=Au(g,c);for(var te=-1,xe=g.length,Re=!1;++te<xe;){var it=rc(g[te]);if(!(Re=c!=null&&A(c,it)))break;c=c[it]}return Re||++te!=xe?Re:(xe=c==null?0:c.length,!!xe&&rg(xe)&&Mc(it,xe)&&(Jr(c)||zf(c)))}function h3(c){var g=c.length,A=new c.constructor(g);return g&&typeof c[0]=="string"&&Kr.call(c,"index")&&(A.index=c.index,A.input=c.input),A}function Uy(c){return typeof c.constructor=="function"&&!Ld(c)?_s(ua(c)):{}}function d3(c,g,A){var te=c.constructor;switch(g){case rn:return l0(c);case Z:case N:return new te(+c);case un:return Yx(c,A);case Ke:case ot:case rt:case Ft:case Qt:case Bn:case Ln:case Nn:case ar:return Sy(c,A);case ne:return new te;case ye:case He:return new te(c);case Ze:return Jx(c);case et:return new te;case wt:return Xx(c)}}function p3(c,g){var A=g.length;if(!A)return c;var te=A-1;return g[te]=(A>1?"& ":"")+g[te],g=g.join(A>2?", ":" "),c.replace(mt,`{
/* [wrapped with `+g+`] */
`)}function g3(c){return Jr(c)||zf(c)||!!(vs&&c&&c[vs])}function Mc(c,g){var A=typeof c;return g=g??ie,!!g&&(A=="number"||A!="symbol"&&Gr.test(c))&&c>-1&&c%1==0&&c<g}function Za(c,g,A){if(!Ko(A))return!1;var te=typeof g;return(te=="number"?dl(A)&&Mc(g,A.length):te=="string"&&g in A)?ku(A[g],c):!1}function m0(c,g){if(Jr(c))return!1;var A=typeof c;return A=="number"||A=="symbol"||A=="boolean"||c==null||Fl(c)?!0:xn.test(c)||!$t.test(c)||g!=null&&c in bi(g)}function m3(c){var g=typeof c;return g=="string"||g=="number"||g=="symbol"||g=="boolean"?c!=="__proto__":c===null}function v0(c){var g=Kp(c),A=De[g];if(typeof A!="function"||!(g in Vr.prototype))return!1;if(c===A)return!0;var te=d0(A);return!!te&&c===te[0]}function v3(c){return!!No&&No in c}var y3=aa?Ac:I0;function Ld(c){var g=c&&c.constructor,A=typeof g=="function"&&g.prototype||sa;return c===A}function Vy(c){return c===c&&!Ko(c)}function Gy(c,g){return function(A){return A==null?!1:A[c]===g&&(g!==t||c in bi(A))}}function _3(c){var g=tg(c,function(te){return A.size===d&&A.clear(),te}),A=g.cache;return g}function b3(c,g){var A=c[1],te=g[1],xe=A|te,Re=xe<(F|I|ve),it=te==ve&&A==K||te==ve&&A==z&&c[7].length<=g[8]||te==(ve|z)&&g[7].length<=g[8]&&A==K;if(!(Re||it))return c;te&F&&(c[2]=g[2],xe|=A&F?0:R);var gt=g[3];if(gt){var Mt=c[3];c[3]=Mt?Cy(Mt,gt,g[4]):gt,c[4]=Mt?is(c[3],m):g[4]}return gt=g[5],gt&&(Mt=c[5],c[5]=Mt?Py(Mt,gt,g[6]):gt,c[6]=Mt?is(c[5],m):g[6]),gt=g[7],gt&&(c[7]=gt),te&ve&&(c[8]=c[8]==null?g[8]:Se(c[8],g[8])),c[9]==null&&(c[9]=g[9]),c[0]=g[0],c[1]=xe,c}function w3(c){var g=[];if(c!=null)for(var A in bi(c))g.push(A);return g}function x3(c){return wi.call(c)}function Hy(c,g,A){return g=se(g===t?c.length-1:g,0),function(){for(var te=arguments,xe=-1,Re=se(te.length-g,0),it=Nt(Re);++xe<Re;)it[xe]=te[g+xe];xe=-1;for(var gt=Nt(g+1);++xe<g;)gt[xe]=te[xe];return gt[g]=A(it),vi(c,this,gt)}}function qy(c,g){return g.length<2?c:hr(c,fl(g,0,-1))}function L3(c,g){for(var A=c.length,te=Se(g.length,A),xe=hl(c);te--;){var Re=g[te];c[te]=Mc(Re,A)?xe[Re]:t}return c}function y0(c,g){if(!(g==="constructor"&&typeof c[g]=="function")&&g!="__proto__")return c[g]}var Wy=Ky(Cu),Sd=bc||function(c,g){return uo.setTimeout(c,g)},_0=Ky(zp);function Zy(c,g,A){var te=g+"";return _0(c,p3(te,S3(f3(te),A)))}function Ky(c){var g=0,A=0;return function(){var te=st(),xe=B-(te-A);if(A=te,xe>0){if(++g>=D)return arguments[0]}else g=0;return c.apply(t,arguments)}}function Jp(c,g){var A=-1,te=c.length,xe=te-1;for(g=g===t?te:g;++A<g;){var Re=Of(A,xe),it=c[Re];c[Re]=c[A],c[A]=it}return c.length=g,c}var Yy=_3(function(c){var g=[];return c.charCodeAt(0)===46&&g.push(""),c.replace(vn,function(A,te,xe,Re){g.push(xe?Re.replace(Qn,"$1"):te||A)}),g});function rc(c){if(typeof c=="string"||Fl(c))return c;var g=c+"";return g=="0"&&1/c==-1/0?"-0":g}function jf(c){if(c!=null){try{return la.call(c)}catch{}try{return c+""}catch{}}return""}function S3(c,g){return ko(Q,function(A){var te="_."+A[0];g&A[1]&&!al(c,te)&&c.push(te)}),c.sort()}function Jy(c){if(c instanceof Vr)return c.clone();var g=new Bo(c.__wrapped__,c.__chain__);return g.__actions__=hl(c.__actions__),g.__index__=c.__index__,g.__values__=c.__values__,g}function E3(c,g,A){(A?Za(c,g,A):g===t)?g=1:g=se(ai(g),0);var te=c==null?0:c.length;if(!te||g<1)return[];for(var xe=0,Re=0,it=Nt(Do(te/g));xe<te;)it[Re++]=fl(c,xe,xe+=g);return it}function C3(c){for(var g=-1,A=c==null?0:c.length,te=0,xe=[];++g<A;){var Re=c[g];Re&&(xe[te++]=Re)}return xe}function P3(){var c=arguments.length;if(!c)return[];for(var g=Nt(c-1),A=arguments[0],te=c;te--;)g[te-1]=arguments[te];return ks(Jr(A)?hl(A):[A],ze(g,1))}var M3=si(function(c,g){return ws(c)?E(c,ze(g,1,ws,!0)):[]}),A3=si(function(c,g){var A=ou(g);return ws(A)&&(A=t),ws(c)?E(c,ze(g,1,ws,!0),Cr(A,2)):[]}),k3=si(function(c,g){var A=ou(g);return ws(A)&&(A=t),ws(c)?E(c,ze(g,1,ws,!0),t,A):[]});function T3(c,g,A){var te=c==null?0:c.length;return te?(g=A||g===t?1:ai(g),fl(c,g<0?0:g,te)):[]}function N3(c,g,A){var te=c==null?0:c.length;return te?(g=A||g===t?1:ai(g),g=te-g,fl(c,0,g<0?0:g)):[]}function D3(c,g){return c&&c.length?Ec(c,Cr(g,3),!0,!0):[]}function I3(c,g){return c&&c.length?Ec(c,Cr(g,3),!0):[]}function O3(c,g,A,te){var xe=c==null?0:c.length;return xe?(A&&typeof A!="number"&&Za(c,g,A)&&(A=0,te=xe),Le(c,g,A,te)):[]}function Xy(c,g,A){var te=c==null?0:c.length;if(!te)return-1;var xe=A==null?0:ai(A);return xe<0&&(xe=se(te+xe,0)),Ut(c,Cr(g,3),xe)}function Qy(c,g,A){var te=c==null?0:c.length;if(!te)return-1;var xe=te-1;return A!==t&&(xe=ai(A),xe=A<0?se(te+xe,0):Se(xe,te-1)),Ut(c,Cr(g,3),xe,!0)}function e2(c){var g=c==null?0:c.length;return g?ze(c,1):[]}function B3(c){var g=c==null?0:c.length;return g?ze(c,oe):[]}function R3(c,g){var A=c==null?0:c.length;return A?(g=g===t?1:ai(g),ze(c,g)):[]}function F3(c){for(var g=-1,A=c==null?0:c.length,te={};++g<A;){var xe=c[g];te[xe[0]]=xe[1]}return te}function t2(c){return c&&c.length?c[0]:t}function j3(c,g,A){var te=c==null?0:c.length;if(!te)return-1;var xe=A==null?0:ai(A);return xe<0&&(xe=se(te+xe,0)),fn(c,g,xe)}function z3(c){var g=c==null?0:c.length;return g?fl(c,0,-1):[]}var $3=si(function(c){var g=yi(c,Qc);return g.length&&g[0]===c[0]?me(g):[]}),U3=si(function(c){var g=ou(c),A=yi(c,Qc);return g===ou(A)?g=t:A.pop(),A.length&&A[0]===c[0]?me(A,Cr(g,2)):[]}),V3=si(function(c){var g=ou(c),A=yi(c,Qc);return g=typeof g=="function"?g:t,g&&A.pop(),A.length&&A[0]===c[0]?me(A,t,g):[]});function G3(c,g){return c==null?"":S.call(c,g)}function ou(c){var g=c==null?0:c.length;return g?c[g-1]:t}function H3(c,g,A){var te=c==null?0:c.length;if(!te)return-1;var xe=te;return A!==t&&(xe=ai(A),xe=xe<0?se(te+xe,0):Se(xe,te-1)),g===g?ba(c,g,xe):Ut(c,zn,xe,!0)}function q3(c,g){return c&&c.length?Wa(c,ai(g)):t}var W3=si(n2);function n2(c,g){return c&&c.length&&g&&g.length?_h(c,g):c}function Z3(c,g,A){return c&&c.length&&g&&g.length?_h(c,g,Cr(A,2)):c}function K3(c,g,A){return c&&c.length&&g&&g.length?_h(c,g,t,A):c}var Y3=Pc(function(c,g){var A=c==null?0:c.length,te=Pn(c,g);return If(c,yi(g,function(xe){return Mc(xe,A)?+xe:xe}).sort(Ey)),te});function J3(c,g){var A=[];if(!(c&&c.length))return A;var te=-1,xe=[],Re=c.length;for(g=Cr(g,3);++te<Re;){var it=c[te];g(it,te,c)&&(A.push(it),xe.push(te))}return If(c,xe),A}function b0(c){return c==null?c:sn.call(c)}function X3(c,g,A){var te=c==null?0:c.length;return te?(A&&typeof A!="number"&&Za(c,g,A)?(g=0,A=te):(g=g==null?0:ai(g),A=A===t?te:ai(A)),fl(c,g,A)):[]}function Q3(c,g){return Pu(c,g)}function eL(c,g,A){return bd(c,g,Cr(A,2))}function tL(c,g){var A=c==null?0:c.length;if(A){var te=Pu(c,g);if(te<A&&ku(c[te],g))return te}return-1}function nL(c,g){return Pu(c,g,!0)}function rL(c,g,A){return bd(c,g,Cr(A,2),!0)}function iL(c,g){var A=c==null?0:c.length;if(A){var te=Pu(c,g,!0)-1;if(ku(c[te],g))return te}return-1}function oL(c){return c&&c.length?wd(c):[]}function sL(c,g){return c&&c.length?wd(c,Cr(g,2)):[]}function aL(c){var g=c==null?0:c.length;return g?fl(c,1,g):[]}function lL(c,g,A){return c&&c.length?(g=A||g===t?1:ai(g),fl(c,0,g<0?0:g)):[]}function uL(c,g,A){var te=c==null?0:c.length;return te?(g=A||g===t?1:ai(g),g=te-g,fl(c,g<0?0:g,te)):[]}function cL(c,g){return c&&c.length?Ec(c,Cr(g,3),!1,!0):[]}function fL(c,g){return c&&c.length?Ec(c,Cr(g,3)):[]}var hL=si(function(c){return tc(ze(c,1,ws,!0))}),dL=si(function(c){var g=ou(c);return ws(g)&&(g=t),tc(ze(c,1,ws,!0),Cr(g,2))}),pL=si(function(c){var g=ou(c);return g=typeof g=="function"?g:t,tc(ze(c,1,ws,!0),t,g)});function gL(c){return c&&c.length?tc(c):[]}function mL(c,g){return c&&c.length?tc(c,Cr(g,2)):[]}function vL(c,g){return g=typeof g=="function"?g:t,c&&c.length?tc(c,t,g):[]}function w0(c){if(!(c&&c.length))return[];var g=0;return c=qs(c,function(A){if(ws(A))return g=se(A.length,g),!0}),ho(g,function(A){return yi(c,_r(A))})}function r2(c,g){if(!(c&&c.length))return[];var A=w0(c);return g==null?A:yi(A,function(te){return vi(g,t,te)})}var yL=si(function(c,g){return ws(c)?E(c,g):[]}),_L=si(function(c){return ru(qs(c,ws))}),bL=si(function(c){var g=ou(c);return ws(g)&&(g=t),ru(qs(c,ws),Cr(g,2))}),wL=si(function(c){var g=ou(c);return g=typeof g=="function"?g:t,ru(qs(c,ws),t,g)}),xL=si(w0);function LL(c,g){return Mu(c||[],g||[],dt)}function SL(c,g){return Mu(c||[],g||[],Lc)}var EL=si(function(c){var g=c.length,A=g>1?c[g-1]:t;return A=typeof A=="function"?(c.pop(),A):t,r2(c,A)});function i2(c){var g=De(c);return g.__chain__=!0,g}function CL(c,g){return g(c),c}function Xp(c,g){return g(c)}var PL=Pc(function(c){var g=c.length,A=g?c[0]:0,te=this.__wrapped__,xe=function(Re){return Pn(Re,c)};return g>1||this.__actions__.length||!(te instanceof Vr)||!Mc(A)?this.thru(xe):(te=te.slice(A,+A+(g?1:0)),te.__actions__.push({func:Xp,args:[xe],thisArg:t}),new Bo(te,this.__chain__).thru(function(Re){return g&&!Re.length&&Re.push(t),Re}))});function ML(){return i2(this)}function AL(){return new Bo(this.value(),this.__chain__)}function kL(){this.__values__===t&&(this.__values__=y2(this.value()));var c=this.__index__>=this.__values__.length,g=c?t:this.__values__[this.__index__++];return{done:c,value:g}}function TL(){return this}function NL(c){for(var g,A=this;A instanceof Su;){var te=Jy(A);te.__index__=0,te.__values__=t,g?xe.__wrapped__=te:g=te;var xe=te;A=A.__wrapped__}return xe.__wrapped__=c,g}function DL(){var c=this.__wrapped__;if(c instanceof Vr){var g=c;return this.__actions__.length&&(g=new Vr(this)),g=g.reverse(),g.__actions__.push({func:Xp,args:[b0],thisArg:t}),new Bo(g,this.__chain__)}return this.thru(b0)}function IL(){return nu(this.__wrapped__,this.__actions__)}var OL=Gp(function(c,g,A){Kr.call(c,A)?++c[A]:kn(c,A,1)});function BL(c,g,A){var te=Jr(c)?Ol:re;return A&&Za(c,g,A)&&(g=t),te(c,Cr(g,3))}function RL(c,g){var A=Jr(c)?qs:Xe;return A(c,Cr(g,3))}var FL=Ty(Xy),jL=Ty(Qy);function zL(c,g){return ze(Qp(c,g),1)}function $L(c,g){return ze(Qp(c,g),oe)}function UL(c,g,A){return A=A===t?1:ai(A),ze(Qp(c,g),A)}function o2(c,g){var A=Jr(c)?ko:j;return A(c,Cr(g,3))}function s2(c,g){var A=Jr(c)?Hs:X;return A(c,Cr(g,3))}var VL=Gp(function(c,g,A){Kr.call(c,A)?c[A].push(g):kn(c,A,[g])});function GL(c,g,A,te){c=dl(c)?c:Mh(c),A=A&&!te?ai(A):0;var xe=c.length;return A<0&&(A=se(xe+A,0)),ig(c)?A<=xe&&c.indexOf(g,A)>-1:!!xe&&fn(c,g,A)>-1}var HL=si(function(c,g,A){var te=-1,xe=typeof g=="function",Re=dl(c)?Nt(c.length):[];return j(c,function(it){Re[++te]=xe?vi(g,it,A):Be(it,g,A)}),Re}),qL=Gp(function(c,g,A){kn(c,A,g)});function Qp(c,g){var A=Jr(c)?yi:Ui;return A(c,Cr(g,3))}function WL(c,g,A,te){return c==null?[]:(Jr(g)||(g=g==null?[]:[g]),A=te?t:A,Jr(A)||(A=A==null?[]:[A]),ec(c,g,A))}var ZL=Gp(function(c,g,A){c[A?0:1].push(g)},function(){return[[],[]]});function KL(c,g,A){var te=Jr(c)?_a:Gi,xe=arguments.length<3;return te(c,Cr(g,4),A,xe,j)}function YL(c,g,A){var te=Jr(c)?fo:Gi,xe=arguments.length<3;return te(c,Cr(g,4),A,xe,X)}function JL(c,g){var A=Jr(c)?qs:Xe;return A(c,ng(Cr(g,3)))}function XL(c){var g=Jr(c)?Bt:wh;return g(c)}function QL(c,g,A){(A?Za(c,g,A):g===t)?g=1:g=ai(g);var te=Jr(c)?xt:jp;return te(c,g)}function eS(c){var g=Jr(c)?Kt:$p;return g(c)}function tS(c){if(c==null)return 0;if(dl(c))return ig(c)?Uo(c):c.length;var g=Ma(c);return g==ne||g==et?c.size:gi(c).length}function nS(c,g,A){var te=Jr(c)?O:Up;return A&&Za(c,g,A)&&(g=t),te(c,Cr(g,3))}var rS=si(function(c,g){if(c==null)return[];var A=g.length;return A>1&&Za(c,g[0],g[1])?g=[]:A>2&&Za(g[0],g[1],g[2])&&(g=[g[0]]),ec(c,ze(g,1),[])}),eg=as||function(){return uo.Date.now()};function iS(c,g){if(typeof g!="function")throw new Zi(o);return c=ai(c),function(){if(--c<1)return g.apply(this,arguments)}}function a2(c,g,A){return g=A?t:g,g=c&&g==null?c.length:g,Cc(c,ve,t,t,t,t,g)}function l2(c,g){var A;if(typeof g!="function")throw new Zi(o);return c=ai(c),function(){return--c>0&&(A=g.apply(this,arguments)),c<=1&&(g=t),A}}var x0=si(function(c,g,A){var te=F;if(A.length){var xe=is(A,Ch(x0));te|=he}return Cc(c,te,g,A,xe)}),u2=si(function(c,g,A){var te=F|I;if(A.length){var xe=is(A,Ch(u2));te|=he}return Cc(g,te,c,A,xe)});function c2(c,g,A){g=A?t:g;var te=Cc(c,K,t,t,t,t,t,g);return te.placeholder=c2.placeholder,te}function f2(c,g,A){g=A?t:g;var te=Cc(c,ee,t,t,t,t,t,g);return te.placeholder=f2.placeholder,te}function h2(c,g,A){var te,xe,Re,it,gt,Mt,an=0,ln=!1,yn=!1,Un=!0;if(typeof c!="function")throw new Zi(o);g=su(g)||0,Ko(A)&&(ln=!!A.leading,yn="maxWait"in A,Re=yn?se(su(A.maxWait)||0,g):Re,Un="trailing"in A?!!A.trailing:Un);function ur(xs){var Tu=te,Tc=xe;return te=xe=t,an=xs,it=c.apply(Tc,Tu),it}function Mr(xs){return an=xs,gt=Sd(xi,g),ln?ur(xs):it}function li(xs){var Tu=xs-Mt,Tc=xs-an,T2=g-Tu;return yn?Se(T2,Re-Tc):T2}function Ar(xs){var Tu=xs-Mt,Tc=xs-an;return Mt===t||Tu>=g||Tu<0||yn&&Tc>=Re}function xi(){var xs=eg();if(Ar(xs))return Ni(xs);gt=Sd(xi,li(xs))}function Ni(xs){return gt=t,Un&&te?ur(xs):(te=xe=t,it)}function jl(){gt!==t&&Lh(gt),an=0,te=Mt=xe=gt=t}function Ka(){return gt===t?it:Ni(eg())}function zl(){var xs=eg(),Tu=Ar(xs);if(te=arguments,xe=this,Mt=xs,Tu){if(gt===t)return Mr(Mt);if(yn)return Lh(gt),gt=Sd(xi,g),ur(Mt)}return gt===t&&(gt=Sd(xi,g)),it}return zl.cancel=jl,zl.flush=Ka,zl}var oS=si(function(c,g){return x(c,1,g)}),sS=si(function(c,g,A){return x(c,su(g)||0,A)});function aS(c){return Cc(c,U)}function tg(c,g){if(typeof c!="function"||g!=null&&typeof g!="function")throw new Zi(o);var A=function(){var te=arguments,xe=g?g.apply(this,te):te[0],Re=A.cache;if(Re.has(xe))return Re.get(xe);var it=c.apply(this,te);return A.cache=Re.set(xe,it)||Re,it};return A.cache=new(tg.Cache||Ca),A}tg.Cache=Ca;function ng(c){if(typeof c!="function")throw new Zi(o);return function(){var g=arguments;switch(g.length){case 0:return!c.call(this);case 1:return!c.call(this,g[0]);case 2:return!c.call(this,g[0],g[1]);case 3:return!c.call(this,g[0],g[1],g[2])}return!c.apply(this,g)}}function lS(c){return l2(2,c)}var uS=a0(function(c,g){g=g.length==1&&Jr(g[0])?yi(g[0],Ur(Cr())):yi(ze(g,1),Ur(Cr()));var A=g.length;return si(function(te){for(var xe=-1,Re=Se(te.length,A);++xe<Re;)te[xe]=g[xe].call(this,te[xe]);return vi(c,this,te)})}),L0=si(function(c,g){var A=is(g,Ch(L0));return Cc(c,he,t,g,A)}),d2=si(function(c,g){var A=is(g,Ch(d2));return Cc(c,fe,t,g,A)}),cS=Pc(function(c,g){return Cc(c,z,t,t,t,g)});function fS(c,g){if(typeof c!="function")throw new Zi(o);return g=g===t?g:ai(g),si(c,g)}function hS(c,g){if(typeof c!="function")throw new Zi(o);return g=g==null?0:se(ai(g),0),si(function(A){var te=A[g],xe=iu(A,0,g);return te&&ks(xe,te),vi(c,this,xe)})}function dS(c,g,A){var te=!0,xe=!0;if(typeof c!="function")throw new Zi(o);return Ko(A)&&(te="leading"in A?!!A.leading:te,xe="trailing"in A?!!A.trailing:xe),h2(c,g,{leading:te,maxWait:g,trailing:xe})}function pS(c){return a2(c,1)}function gS(c,g){return L0(Rf(g),c)}function mS(){if(!arguments.length)return[];var c=arguments[0];return Jr(c)?c:[c]}function vS(c){return l(c,y)}function yS(c,g){return g=typeof g=="function"?g:t,l(c,y,g)}function _S(c){return l(c,_|y)}function bS(c,g){return g=typeof g=="function"?g:t,l(c,_|y,g)}function wS(c,g){return g==null||v(c,g,Js(g))}function ku(c,g){return c===g||c!==c&&g!==g}var xS=Zp(ct),LS=Zp(function(c,g){return c>=g}),zf=Oe(function(){return arguments}())?Oe:function(c){return ls(c)&&Kr.call(c,"callee")&&!ji.call(c,"callee")},Jr=Nt.isArray,SS=Ql?Ur(Ql):Fe;function dl(c){return c!=null&&rg(c.length)&&!Ac(c)}function ws(c){return ls(c)&&dl(c)}function ES(c){return c===!0||c===!1||ls(c)&&nt(c)==Z}var ef=a||I0,CS=ta?Ur(ta):je;function PS(c){return ls(c)&&c.nodeType===1&&!Ed(c)}function MS(c){if(c==null)return!0;if(dl(c)&&(Jr(c)||typeof c=="string"||typeof c.splice=="function"||ef(c)||Ph(c)||zf(c)))return!c.length;var g=Ma(c);if(g==ne||g==et)return!c.size;if(Ld(c))return!gi(c).length;for(var A in c)if(Kr.call(c,A))return!1;return!0}function AS(c,g){return at(c,g)}function kS(c,g,A){A=typeof A=="function"?A:t;var te=A?A(c,g):t;return te===t?at(c,g,t,A):!!te}function S0(c){if(!ls(c))return!1;var g=nt(c);return g==Me||g==ke||typeof c.message=="string"&&typeof c.name=="string"&&!Ed(c)}function TS(c){return typeof c=="number"&&p(c)}function Ac(c){if(!Ko(c))return!1;var g=nt(c);return g==Ue||g==ce||g==pe||g==tt}function p2(c){return typeof c=="number"&&c==ai(c)}function rg(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=ie}function Ko(c){var g=typeof c;return c!=null&&(g=="object"||g=="function")}function ls(c){return c!=null&&typeof c=="object"}var g2=Nl?Ur(Nl):pt;function NS(c,g){return c===g||Et(c,g,p0(g))}function DS(c,g,A){return A=typeof A=="function"?A:t,Et(c,g,p0(g),A)}function IS(c){return m2(c)&&c!=+c}function OS(c){if(y3(c))throw new Jn(s);return Ct(c)}function BS(c){return c===null}function RS(c){return c==null}function m2(c){return typeof c=="number"||ls(c)&&nt(c)==ye}function Ed(c){if(!ls(c)||nt(c)!=We)return!1;var g=ua(c);if(g===null)return!0;var A=Kr.call(g,"constructor")&&g.constructor;return typeof A=="function"&&A instanceof A&&la.call(A)==ki}var E0=Dl?Ur(Dl):on;function FS(c){return p2(c)&&c>=-9007199254740991&&c<=ie}var v2=Fs?Ur(Fs):$n;function ig(c){return typeof c=="string"||!Jr(c)&&ls(c)&&nt(c)==He}function Fl(c){return typeof c=="symbol"||ls(c)&&nt(c)==wt}var Ph=Il?Ur(Il):Wn;function jS(c){return c===t}function zS(c){return ls(c)&&Ma(c)==kt}function $S(c){return ls(c)&&nt(c)==Jt}var US=Zp(Yr),VS=Zp(function(c,g){return c<=g});function y2(c){if(!c)return[];if(dl(c))return ig(c)?Vo(c):hl(c);if(pr&&c[pr])return gs(c[pr]());var g=Ma(c),A=g==ne?cl:g==et?os:Mh;return A(c)}function kc(c){if(!c)return c===0?c:0;if(c=su(c),c===oe||c===-1/0){var g=c<0?-1:1;return g*we}return c===c?c:0}function ai(c){var g=kc(c),A=g%1;return g===g?A?g-A:g:0}function _2(c){return c?tr(ai(c),0,Te):0}function su(c){if(typeof c=="number")return c;if(Fl(c))return Ce;if(Ko(c)){var g=typeof c.valueOf=="function"?c.valueOf():c;c=Ko(g)?g+"":g}if(typeof c!="string")return c===0?c:+c;c=Ts(c);var A=dr.test(c);return A||wr.test(c)?Tl(c.slice(2),A?2:8):Pr.test(c)?Ce:+c}function b2(c){return nc(c,pl(c))}function GS(c){return c?tr(ai(c),-9007199254740991,ie):c===0?c:0}function no(c){return c==null?"":Pa(c)}var HS=Sh(function(c,g){if(Ld(g)||dl(g)){nc(g,Js(g),c);return}for(var A in g)Kr.call(g,A)&&dt(c,A,g[A])}),w2=Sh(function(c,g){nc(g,pl(g),c)}),og=Sh(function(c,g,A,te){nc(g,pl(g),c,te)}),qS=Sh(function(c,g,A,te){nc(g,Js(g),c,te)}),WS=Pc(Pn);function ZS(c,g){var A=_s(c);return g==null?A:dn(A,g)}var KS=si(function(c,g){c=bi(c);var A=-1,te=g.length,xe=te>2?g[2]:t;for(xe&&Za(g[0],g[1],xe)&&(te=1);++A<te;)for(var Re=g[A],it=pl(Re),gt=-1,Mt=it.length;++gt<Mt;){var an=it[gt],ln=c[an];(ln===t||ku(ln,sa[an])&&!Kr.call(c,an))&&(c[an]=Re[an])}return c}),YS=si(function(c){return c.push(t,Fy),vi(x2,t,c)});function JS(c,g){return Lt(c,Cr(g,3),Xt)}function XS(c,g){return Lt(c,Cr(g,3),_n)}function QS(c,g){return c==null?c:vt(c,Cr(g,3),pl)}function eE(c,g){return c==null?c:Dt(c,Cr(g,3),pl)}function tE(c,g){return c&&Xt(c,Cr(g,3))}function nE(c,g){return c&&_n(c,Cr(g,3))}function rE(c){return c==null?[]:Sn(c,Js(c))}function iE(c){return c==null?[]:Sn(c,pl(c))}function C0(c,g,A){var te=c==null?t:hr(c,g);return te===t?A:te}function oE(c,g){return c!=null&&$y(c,g,Rt)}function P0(c,g){return c!=null&&$y(c,g,bt)}var sE=Dy(function(c,g,A){g!=null&&typeof g.toString!="function"&&(g=wi.call(g)),c[g]=A},A0(gl)),aE=Dy(function(c,g,A){g!=null&&typeof g.toString!="function"&&(g=wi.call(g)),Kr.call(c,g)?c[g].push(A):c[g]=[A]},Cr),lE=si(Be);function Js(c){return dl(c)?Ot(c):gi(c)}function pl(c){return dl(c)?Ot(c,!0):Ti(c)}function uE(c,g){var A={};return g=Cr(g,3),Xt(c,function(te,xe,Re){kn(A,g(te,xe,Re),te)}),A}function cE(c,g){var A={};return g=Cr(g,3),Xt(c,function(te,xe,Re){kn(A,xe,g(te,xe,Re))}),A}var fE=Sh(function(c,g,A){fa(c,g,A)}),x2=Sh(function(c,g,A,te){fa(c,g,A,te)}),hE=Pc(function(c,g){var A={};if(c==null)return A;var te=!1;g=yi(g,function(Re){return Re=Au(Re,c),te||(te=Re.length>1),Re}),nc(c,h0(c),A),te&&(A=l(A,_|w|y,s3));for(var xe=g.length;xe--;)Sc(A,g[xe]);return A});function dE(c,g){return L2(c,ng(Cr(g)))}var pE=Pc(function(c,g){return c==null?{}:ha(c,g)});function L2(c,g){if(c==null)return{};var A=yi(h0(c),function(te){return[te]});return g=Cr(g),Zo(c,A,function(te,xe){return g(te,xe[0])})}function gE(c,g,A){g=Au(g,c);var te=-1,xe=g.length;for(xe||(xe=1,c=t);++te<xe;){var Re=c==null?t:c[rc(g[te])];Re===t&&(te=xe,Re=A),c=Ac(Re)?Re.call(c):Re}return c}function mE(c,g,A){return c==null?c:Lc(c,g,A)}function vE(c,g,A,te){return te=typeof te=="function"?te:t,c==null?c:Lc(c,g,A,te)}var S2=By(Js),E2=By(pl);function yE(c,g,A){var te=Jr(c),xe=te||ef(c)||Ph(c);if(g=Cr(g,4),A==null){var Re=c&&c.constructor;xe?A=te?new Re:[]:Ko(c)?A=Ac(Re)?_s(ua(c)):{}:A={}}return(xe?ko:Xt)(c,function(it,gt,Mt){return g(A,it,gt,Mt)}),A}function _E(c,g){return c==null?!0:Sc(c,g)}function bE(c,g,A){return c==null?c:xh(c,g,Rf(A))}function wE(c,g,A,te){return te=typeof te=="function"?te:t,c==null?c:xh(c,g,Rf(A),te)}function Mh(c){return c==null?[]:zo(c,Js(c))}function xE(c){return c==null?[]:zo(c,pl(c))}function LE(c,g,A){return A===t&&(A=g,g=t),A!==t&&(A=su(A),A=A===A?A:0),g!==t&&(g=su(g),g=g===g?g:0),tr(su(c),g,A)}function SE(c,g,A){return g=kc(g),A===t?(A=g,g=0):A=kc(A),c=su(c),It(c,g,A)}function EE(c,g,A){if(A&&typeof A!="boolean"&&Za(c,g,A)&&(g=A=t),A===t&&(typeof g=="boolean"?(A=g,g=t):typeof c=="boolean"&&(A=c,c=t)),c===t&&g===t?(c=0,g=1):(c=kc(c),g===t?(g=c,c=0):g=kc(g)),c>g){var te=c;c=g,g=te}if(A||c%1||g%1){var xe=Vt();return Se(c+xe*(g-c+ol("1e-"+((xe+"").length-1))),g)}return Of(c,g)}var CE=Eh(function(c,g,A){return g=g.toLowerCase(),c+(A?C2(g):g)});function C2(c){return M0(no(c).toLowerCase())}function P2(c){return c=no(c),c&&c.replace(Ir,xu).replace(Ml,"")}function PE(c,g,A){c=no(c),g=Pa(g);var te=c.length;A=A===t?te:tr(ai(A),0,te);var xe=A;return A-=g.length,A>=0&&c.slice(A,xe)==g}function ME(c){return c=no(c),c&&gr.test(c)?c.replace(br,Ga):c}function AE(c){return c=no(c),c&&Ht.test(c)?c.replace(bn,"\\$&"):c}var kE=Eh(function(c,g,A){return c+(A?"-":"")+g.toLowerCase()}),TE=Eh(function(c,g,A){return c+(A?" ":"")+g.toLowerCase()}),NE=ky("toLowerCase");function DE(c,g,A){c=no(c),g=ai(g);var te=g?Uo(c):0;if(!g||te>=g)return c;var xe=(g-te)/2;return Wp(Io(xe),A)+c+Wp(Do(xe),A)}function IE(c,g,A){c=no(c),g=ai(g);var te=g?Uo(c):0;return g&&te<g?c+Wp(g-te,A):c}function OE(c,g,A){c=no(c),g=ai(g);var te=g?Uo(c):0;return g&&te<g?Wp(g-te,A)+c:c}function BE(c,g,A){return A||g==null?g=0:g&&(g=+g),At(no(c).replace(Hn,""),g||0)}function RE(c,g,A){return(A?Za(c,g,A):g===t)?g=1:g=ai(g),bh(no(c),g)}function FE(){var c=arguments,g=no(c[0]);return c.length<3?g:g.replace(c[1],c[2])}var jE=Eh(function(c,g,A){return c+(A?"_":"")+g.toLowerCase()});function zE(c,g,A){return A&&typeof A!="number"&&Za(c,g,A)&&(g=A=t),A=A===t?Te:A>>>0,A?(c=no(c),c&&(typeof g=="string"||g!=null&&!E0(g))&&(g=Pa(g),!g&&ra(c))?iu(Vo(c),0,A):c.split(g,A)):[]}var $E=Eh(function(c,g,A){return c+(A?" ":"")+M0(g)});function UE(c,g,A){return c=no(c),A=A==null?0:tr(ai(A),0,c.length),g=Pa(g),c.slice(A,A+g.length)==g}function VE(c,g,A){var te=De.templateSettings;A&&Za(c,g,A)&&(g=t),c=no(c),g=og({},g,te,Ry);var xe=og({},g.imports,te.imports,Ry),Re=Js(xe),it=zo(xe,Re),gt,Mt,an=0,ln=g.interpolate||tn,yn="__p += '",Un=Bl((g.escape||tn).source+"|"+ln.source+"|"+(ln===Qe?Pi:tn).source+"|"+(g.evaluate||tn).source+"|$","g"),ur="//# sourceURL="+(Kr.call(g,"sourceURL")?(g.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Al+"]")+`
`;c.replace(Un,function(Ar,xi,Ni,jl,Ka,zl){return Ni||(Ni=jl),yn+=c.slice(an,zl).replace(zi,Ha),xi&&(gt=!0,yn+=`' +
__e(`+xi+`) +
'`),Ka&&(Mt=!0,yn+=`';
`+Ka+`;
__p += '`),Ni&&(yn+=`' +
((__t = (`+Ni+`)) == null ? '' : __t) +
'`),an=zl+Ar.length,Ar}),yn+=`';
`;var Mr=Kr.call(g,"variable")&&g.variable;if(!Mr)yn=`with (obj) {
`+yn+`
}
`;else if(Rn.test(Mr))throw new Jn(u);yn=(Mt?yn.replace(En,""):yn).replace(jn,"$1").replace(Mn,"$1;"),yn="function("+(Mr||"obj")+`) {
`+(Mr?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(gt?", __e = _.escape":"")+(Mt?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+yn+`return __p
}`;var li=A2(function(){return xr(Re,ur+"return "+yn).apply(t,it)});if(li.source=yn,S0(li))throw li;return li}function GE(c){return no(c).toLowerCase()}function HE(c){return no(c).toUpperCase()}function qE(c,g,A){if(c=no(c),c&&(A||g===t))return Ts(c);if(!c||!(g=Pa(g)))return c;var te=Vo(c),xe=Vo(g),Re=rs(te,xe),it=eu(te,xe)+1;return iu(te,Re,it).join("")}function WE(c,g,A){if(c=no(c),c&&(A||g===t))return c.slice(0,wa(c)+1);if(!c||!(g=Pa(g)))return c;var te=Vo(c),xe=eu(te,Vo(g))+1;return iu(te,0,xe).join("")}function ZE(c,g,A){if(c=no(c),c&&(A||g===t))return c.replace(Hn,"");if(!c||!(g=Pa(g)))return c;var te=Vo(c),xe=rs(te,Vo(g));return iu(te,xe).join("")}function KE(c,g){var A=J,te=T;if(Ko(g)){var xe="separator"in g?g.separator:xe;A="length"in g?ai(g.length):A,te="omission"in g?Pa(g.omission):te}c=no(c);var Re=c.length;if(ra(c)){var it=Vo(c);Re=it.length}if(A>=Re)return c;var gt=A-Uo(te);if(gt<1)return te;var Mt=it?iu(it,0,gt).join(""):c.slice(0,gt);if(xe===t)return Mt+te;if(it&&(gt+=Mt.length-gt),E0(xe)){if(c.slice(gt).search(xe)){var an,ln=Mt;for(xe.global||(xe=Bl(xe.source,no(Sr.exec(xe))+"g")),xe.lastIndex=0;an=xe.exec(ln);)var yn=an.index;Mt=Mt.slice(0,yn===t?gt:yn)}}else if(c.indexOf(Pa(xe),gt)!=gt){var Un=Mt.lastIndexOf(xe);Un>-1&&(Mt=Mt.slice(0,Un))}return Mt+te}function YE(c){return c=no(c),c&&Or.test(c)?c.replace(Yn,xa):c}var JE=Eh(function(c,g,A){return c+(A?" ":"")+g.toUpperCase()}),M0=ky("toUpperCase");function M2(c,g,A){return c=no(c),g=A?t:g,g===t?Ns(c)?ia(c):ut(c):c.match(g)||[]}var A2=si(function(c,g){try{return vi(c,t,g)}catch(A){return S0(A)?A:new Jn(A)}}),XE=Pc(function(c,g){return ko(g,function(A){A=rc(A),kn(c,A,x0(c[A],c))}),c});function QE(c){var g=c==null?0:c.length,A=Cr();return c=g?yi(c,function(te){if(typeof te[1]!="function")throw new Zi(o);return[A(te[0]),te[1]]}):[],si(function(te){for(var xe=-1;++xe<g;){var Re=c[xe];if(vi(Re[0],this,te))return vi(Re[1],this,te)}})}function eC(c){return h(l(c,_))}function A0(c){return function(){return c}}function tC(c,g){return c==null||c!==c?g:c}var nC=Ny(),rC=Ny(!0);function gl(c){return c}function k0(c){return nr(typeof c=="function"?c:l(c,_))}function iC(c){return bs(l(c,_))}function oC(c,g){return Eu(c,l(g,_))}var sC=si(function(c,g){return function(A){return Be(A,c,g)}}),aC=si(function(c,g){return function(A){return Be(c,A,g)}});function T0(c,g,A){var te=Js(g),xe=Sn(g,te);A==null&&!(Ko(g)&&(xe.length||!te.length))&&(A=g,g=c,c=this,xe=Sn(g,Js(g)));var Re=!(Ko(A)&&"chain"in A)||!!A.chain,it=Ac(c);return ko(xe,function(gt){var Mt=g[gt];c[gt]=Mt,it&&(c.prototype[gt]=function(){var an=this.__chain__;if(Re||an){var ln=c(this.__wrapped__),yn=ln.__actions__=hl(this.__actions__);return yn.push({func:Mt,args:arguments,thisArg:c}),ln.__chain__=an,ln}return Mt.apply(c,ks([this.value()],arguments))})}),c}function lC(){return uo._===this&&(uo._=po),this}function N0(){}function uC(c){return c=ai(c),si(function(g){return Wa(g,c)})}var cC=u0(yi),fC=u0(Ol),hC=u0(O);function k2(c){return m0(c)?_r(rc(c)):go(c)}function dC(c){return function(g){return c==null?t:hr(c,g)}}var pC=Iy(),gC=Iy(!0);function D0(){return[]}function I0(){return!1}function mC(){return{}}function vC(){return""}function yC(){return!0}function _C(c,g){if(c=ai(c),c<1||c>ie)return[];var A=Te,te=Se(c,Te);g=Cr(g),c-=Te;for(var xe=ho(te,g);++A<c;)g(A);return xe}function bC(c){return Jr(c)?yi(c,rc):Fl(c)?[c]:hl(Yy(no(c)))}function wC(c){var g=++Ws;return no(c)+g}var xC=qp(function(c,g){return c+g},0),LC=c0("ceil"),SC=qp(function(c,g){return c/g},1),EC=c0("floor");function CC(c){return c&&c.length?ge(c,gl,ct):t}function PC(c,g){return c&&c.length?ge(c,Cr(g,2),ct):t}function MC(c){return ir(c,gl)}function AC(c,g){return ir(c,Cr(g,2))}function kC(c){return c&&c.length?ge(c,gl,Yr):t}function TC(c,g){return c&&c.length?ge(c,Cr(g,2),Yr):t}var NC=qp(function(c,g){return c*g},1),DC=c0("round"),IC=qp(function(c,g){return c-g},0);function OC(c){return c&&c.length?_i(c,gl):0}function BC(c,g){return c&&c.length?_i(c,Cr(g,2)):0}return De.after=iS,De.ary=a2,De.assign=HS,De.assignIn=w2,De.assignInWith=og,De.assignWith=qS,De.at=WS,De.before=l2,De.bind=x0,De.bindAll=XE,De.bindKey=u2,De.castArray=mS,De.chain=i2,De.chunk=E3,De.compact=C3,De.concat=P3,De.cond=QE,De.conforms=eC,De.constant=A0,De.countBy=OL,De.create=ZS,De.curry=c2,De.curryRight=f2,De.debounce=h2,De.defaults=KS,De.defaultsDeep=YS,De.defer=oS,De.delay=sS,De.difference=M3,De.differenceBy=A3,De.differenceWith=k3,De.drop=T3,De.dropRight=N3,De.dropRightWhile=D3,De.dropWhile=I3,De.fill=O3,De.filter=RL,De.flatMap=zL,De.flatMapDeep=$L,De.flatMapDepth=UL,De.flatten=e2,De.flattenDeep=B3,De.flattenDepth=R3,De.flip=aS,De.flow=nC,De.flowRight=rC,De.fromPairs=F3,De.functions=rE,De.functionsIn=iE,De.groupBy=VL,De.initial=z3,De.intersection=$3,De.intersectionBy=U3,De.intersectionWith=V3,De.invert=sE,De.invertBy=aE,De.invokeMap=HL,De.iteratee=k0,De.keyBy=qL,De.keys=Js,De.keysIn=pl,De.map=Qp,De.mapKeys=uE,De.mapValues=cE,De.matches=iC,De.matchesProperty=oC,De.memoize=tg,De.merge=fE,De.mergeWith=x2,De.method=sC,De.methodOf=aC,De.mixin=T0,De.negate=ng,De.nthArg=uC,De.omit=hE,De.omitBy=dE,De.once=lS,De.orderBy=WL,De.over=cC,De.overArgs=uS,De.overEvery=fC,De.overSome=hC,De.partial=L0,De.partialRight=d2,De.partition=ZL,De.pick=pE,De.pickBy=L2,De.property=k2,De.propertyOf=dC,De.pull=W3,De.pullAll=n2,De.pullAllBy=Z3,De.pullAllWith=K3,De.pullAt=Y3,De.range=pC,De.rangeRight=gC,De.rearg=cS,De.reject=JL,De.remove=J3,De.rest=fS,De.reverse=b0,De.sampleSize=QL,De.set=mE,De.setWith=vE,De.shuffle=eS,De.slice=X3,De.sortBy=rS,De.sortedUniq=oL,De.sortedUniqBy=sL,De.split=zE,De.spread=hS,De.tail=aL,De.take=lL,De.takeRight=uL,De.takeRightWhile=cL,De.takeWhile=fL,De.tap=CL,De.throttle=dS,De.thru=Xp,De.toArray=y2,De.toPairs=S2,De.toPairsIn=E2,De.toPath=bC,De.toPlainObject=b2,De.transform=yE,De.unary=pS,De.union=hL,De.unionBy=dL,De.unionWith=pL,De.uniq=gL,De.uniqBy=mL,De.uniqWith=vL,De.unset=_E,De.unzip=w0,De.unzipWith=r2,De.update=bE,De.updateWith=wE,De.values=Mh,De.valuesIn=xE,De.without=yL,De.words=M2,De.wrap=gS,De.xor=_L,De.xorBy=bL,De.xorWith=wL,De.zip=xL,De.zipObject=LL,De.zipObjectDeep=SL,De.zipWith=EL,De.entries=S2,De.entriesIn=E2,De.extend=w2,De.extendWith=og,T0(De,De),De.add=xC,De.attempt=A2,De.camelCase=CE,De.capitalize=C2,De.ceil=LC,De.clamp=LE,De.clone=vS,De.cloneDeep=_S,De.cloneDeepWith=bS,De.cloneWith=yS,De.conformsTo=wS,De.deburr=P2,De.defaultTo=tC,De.divide=SC,De.endsWith=PE,De.eq=ku,De.escape=ME,De.escapeRegExp=AE,De.every=BL,De.find=FL,De.findIndex=Xy,De.findKey=JS,De.findLast=jL,De.findLastIndex=Qy,De.findLastKey=XS,De.floor=EC,De.forEach=o2,De.forEachRight=s2,De.forIn=QS,De.forInRight=eE,De.forOwn=tE,De.forOwnRight=nE,De.get=C0,De.gt=xS,De.gte=LS,De.has=oE,De.hasIn=P0,De.head=t2,De.identity=gl,De.includes=GL,De.indexOf=j3,De.inRange=SE,De.invoke=lE,De.isArguments=zf,De.isArray=Jr,De.isArrayBuffer=SS,De.isArrayLike=dl,De.isArrayLikeObject=ws,De.isBoolean=ES,De.isBuffer=ef,De.isDate=CS,De.isElement=PS,De.isEmpty=MS,De.isEqual=AS,De.isEqualWith=kS,De.isError=S0,De.isFinite=TS,De.isFunction=Ac,De.isInteger=p2,De.isLength=rg,De.isMap=g2,De.isMatch=NS,De.isMatchWith=DS,De.isNaN=IS,De.isNative=OS,De.isNil=RS,De.isNull=BS,De.isNumber=m2,De.isObject=Ko,De.isObjectLike=ls,De.isPlainObject=Ed,De.isRegExp=E0,De.isSafeInteger=FS,De.isSet=v2,De.isString=ig,De.isSymbol=Fl,De.isTypedArray=Ph,De.isUndefined=jS,De.isWeakMap=zS,De.isWeakSet=$S,De.join=G3,De.kebabCase=kE,De.last=ou,De.lastIndexOf=H3,De.lowerCase=TE,De.lowerFirst=NE,De.lt=US,De.lte=VS,De.max=CC,De.maxBy=PC,De.mean=MC,De.meanBy=AC,De.min=kC,De.minBy=TC,De.stubArray=D0,De.stubFalse=I0,De.stubObject=mC,De.stubString=vC,De.stubTrue=yC,De.multiply=NC,De.nth=q3,De.noConflict=lC,De.noop=N0,De.now=eg,De.pad=DE,De.padEnd=IE,De.padStart=OE,De.parseInt=BE,De.random=EE,De.reduce=KL,De.reduceRight=YL,De.repeat=RE,De.replace=FE,De.result=gE,De.round=DC,De.runInContext=_t,De.sample=XL,De.size=tS,De.snakeCase=jE,De.some=nS,De.sortedIndex=Q3,De.sortedIndexBy=eL,De.sortedIndexOf=tL,De.sortedLastIndex=nL,De.sortedLastIndexBy=rL,De.sortedLastIndexOf=iL,De.startCase=$E,De.startsWith=UE,De.subtract=IC,De.sum=OC,De.sumBy=BC,De.template=VE,De.times=_C,De.toFinite=kc,De.toInteger=ai,De.toLength=_2,De.toLower=GE,De.toNumber=su,De.toSafeInteger=GS,De.toString=no,De.toUpper=HE,De.trim=qE,De.trimEnd=WE,De.trimStart=ZE,De.truncate=KE,De.unescape=YE,De.uniqueId=wC,De.upperCase=JE,De.upperFirst=M0,De.each=o2,De.eachRight=s2,De.first=t2,T0(De,function(){var c={};return Xt(De,function(g,A){Kr.call(De.prototype,A)||(c[A]=g)}),c}(),{chain:!1}),De.VERSION=r,ko(["bind","bindKey","curry","curryRight","partial","partialRight"],function(c){De[c].placeholder=De}),ko(["drop","take"],function(c,g){Vr.prototype[c]=function(A){A=A===t?1:se(ai(A),0);var te=this.__filtered__&&!g?new Vr(this):this.clone();return te.__filtered__?te.__takeCount__=Se(A,te.__takeCount__):te.__views__.push({size:Se(A,Te),type:c+(te.__dir__<0?"Right":"")}),te},Vr.prototype[c+"Right"]=function(A){return this.reverse()[c](A).reverse()}}),ko(["filter","map","takeWhile"],function(c,g){var A=g+1,te=A==$||A==G;Vr.prototype[c]=function(xe){var Re=this.clone();return Re.__iteratees__.push({iteratee:Cr(xe,3),type:A}),Re.__filtered__=Re.__filtered__||te,Re}}),ko(["head","last"],function(c,g){var A="take"+(g?"Right":"");Vr.prototype[c]=function(){return this[A](1).value()[0]}}),ko(["initial","tail"],function(c,g){var A="drop"+(g?"":"Right");Vr.prototype[c]=function(){return this.__filtered__?new Vr(this):this[A](1)}}),Vr.prototype.compact=function(){return this.filter(gl)},Vr.prototype.find=function(c){return this.filter(c).head()},Vr.prototype.findLast=function(c){return this.reverse().find(c)},Vr.prototype.invokeMap=si(function(c,g){return typeof c=="function"?new Vr(this):this.map(function(A){return Be(A,c,g)})}),Vr.prototype.reject=function(c){return this.filter(ng(Cr(c)))},Vr.prototype.slice=function(c,g){c=ai(c);var A=this;return A.__filtered__&&(c>0||g<0)?new Vr(A):(c<0?A=A.takeRight(-c):c&&(A=A.drop(c)),g!==t&&(g=ai(g),A=g<0?A.dropRight(-g):A.take(g-c)),A)},Vr.prototype.takeRightWhile=function(c){return this.reverse().takeWhile(c).reverse()},Vr.prototype.toArray=function(){return this.take(Te)},Xt(Vr.prototype,function(c,g){var A=/^(?:filter|find|map|reject)|While$/.test(g),te=/^(?:head|last)$/.test(g),xe=De[te?"take"+(g=="last"?"Right":""):g],Re=te||/^find/.test(g);xe&&(De.prototype[g]=function(){var it=this.__wrapped__,gt=te?[1]:arguments,Mt=it instanceof Vr,an=gt[0],ln=Mt||Jr(it),yn=function(xi){var Ni=xe.apply(De,ks([xi],gt));return te&&Un?Ni[0]:Ni};ln&&A&&typeof an=="function"&&an.length!=1&&(Mt=ln=!1);var Un=this.__chain__,ur=!!this.__actions__.length,Mr=Re&&!Un,li=Mt&&!ur;if(!Re&&ln){it=li?it:new Vr(this);var Ar=c.apply(it,gt);return Ar.__actions__.push({func:Xp,args:[yn],thisArg:t}),new Bo(Ar,Un)}return Mr&&li?c.apply(this,gt):(Ar=this.thru(yn),Mr?te?Ar.value()[0]:Ar.value():Ar)})}),ko(["pop","push","shift","sort","splice","unshift"],function(c){var g=oa[c],A=/^(?:push|sort|unshift)$/.test(c)?"tap":"thru",te=/^(?:pop|shift)$/.test(c);De.prototype[c]=function(){var xe=arguments;if(te&&!this.__chain__){var Re=this.value();return g.apply(Jr(Re)?Re:[],xe)}return this[A](function(it){return g.apply(Jr(it)?it:[],xe)})}}),Xt(Vr.prototype,function(c,g){var A=De[g];if(A){var te=A.name+"";Kr.call(ys,te)||(ys[te]=[]),ys[te].push({name:g,func:A})}}),ys[Hp(t,I).name]=[{name:"wrapper",func:t}],Vr.prototype.clone=Zc,Vr.prototype.reverse=dh,Vr.prototype.value=Kc,De.prototype.at=PL,De.prototype.chain=ML,De.prototype.commit=AL,De.prototype.next=kL,De.prototype.plant=NL,De.prototype.reverse=DL,De.prototype.toJSON=De.prototype.valueOf=De.prototype.value=IL,De.prototype.first=De.prototype.head,pr&&(De.prototype[pr]=TL),De},Ho=Ds();co?((co.exports=Ho)._=Ho,lr._=Ho):uo._=Ho}).call(ea)})(ym,ym.exports);var cx=ym.exports;class pa extends qn.Polygon{constructor(t,r={}){super([],{...r,pmIgnore:!1,interactive:!0});qt(this,"_width");qt(this,"_height");qt(this,"_center");qt(this,"_rotation");qt(this,"_isMapReady",!1);qt(this,"properties");qt(this,"_helperPoints",{corners:[],midPoints:[]});qt(this,"_throttledUpdateProperties");const i=t instanceof qn.LatLngBounds?t:qn.latLngBounds(t);if(this._center=i.getCenter(),this._rotation=0,console.log("[Rectangle][constructor] Initialisation avec options:",{bounds:i,center:this._center,hasExplicitDimensions:!!(r.width&&r.height),width:r.width,height:r.height}),r.width&&r.height)this._width=r.width,this._height=r.height,console.log("[Rectangle][constructor] Utilisation des dimensions explicites:",{width:this._width,height:this._height});else{const s=i.getSouthWest(),o=i.getNorthEast();this._width=hn.measure("Rectangle.constructor.calculateWidth",()=>{const u=nv([s.lng,s.lat],[o.lng,s.lat],{units:"meters"});return Math.max(u,1)}),this._height=hn.measure("Rectangle.constructor.calculateHeight",()=>{const u=nv([s.lng,s.lat],[s.lng,o.lat],{units:"meters"});return Math.max(u,1)}),console.log("[Rectangle][constructor] Dimensions calculées depuis bounds:",{width:this._width,height:this._height})}(this._width<1||this._height<1)&&this._getPixelsPerMeter()>0&&(this._width=Math.max(this._width,1),this._height=Math.max(this._height,1),this._updatePolygonCoordinates()),this.properties=hn.measure("Rectangle.constructor.initProperties",()=>({type:"Rectangle",style:{...r,name:r.name||""},rotation:this._rotation})),this._throttledUpdateProperties=hn.measure("Rectangle.constructor.initThrottle",()=>cx.throttle(()=>{this.updateProperties()},100)),this.on("add",()=>{this._isMapReady=!0,this._updatePolygonCoordinates(),this.updateProperties()}),this.on("remove",()=>{this._isMapReady=!1})}_updatePolygonCoordinates(){hn.measure("Rectangle._updatePolygonCoordinates",()=>{if(!this._isMapReady||!this._map)return;console.log("[Rectangle][_updatePolygonCoordinates] Début mise à jour avec:",{width:this._width,height:this._height,center:this._center,rotation:this._rotation}),this._width=Math.max(this._width,1),this._height=Math.max(this._height,1);const t=this._width/2,r=this._height/2,i=lb([this._center.lng,this._center.lat],r,0,{units:"meters"}).geometry.coordinates,s=lb([this._center.lng,this._center.lat],t,90,{units:"meters"}).geometry.coordinates,o=Math.abs(i[1]-this._center.lat)*2,u=Math.abs(s[0]-this._center.lng)*2,f=[qn.latLng(this._center.lat+o/2,this._center.lng-u/2),qn.latLng(this._center.lat+o/2,this._center.lng+u/2),qn.latLng(this._center.lat-o/2,this._center.lng+u/2),qn.latLng(this._center.lat-o/2,this._center.lng-u/2)];if(this._rotation===0){this.setLatLngs(f);return}const d=this._map.latLngToContainerPoint(this._center),m=f.map(F=>this._map.latLngToContainerPoint(F)),_=-this._rotation*Math.PI/180,w=Math.cos(_),y=Math.sin(_),k=m.map(F=>{const I=F.x-d.x,R=F.y-d.y;return qn.point(d.x+(I*w-R*y),d.y+(I*y+R*w))}).map(F=>this._map.containerPointToLatLng(F));console.log("[Rectangle][_updatePolygonCoordinates] Résultat final:",{corners:k,dimensions:{width:this._width,height:this._height}}),this.setLatLngs(k),this.fire("coordinates:updated",{corners:k,center:this._center,rotation:this._rotation,dimensions:{width:this._width,height:this._height}})})}_getPixelsPerMeter(){return hn.measure("Rectangle._getPixelsPerMeter",()=>{if(!this._isMapReady||!this._map)return 1;const t=Math.max(this._width/1e3,1e-4),r=this._map.latLngToContainerPoint(this._center),s=this._map.latLngToContainerPoint(qn.latLng(this._center.lat,this._center.lng+t)).x-r.x,o=nv([this._center.lng,this._center.lat],[this._center.lng+t,this._center.lat],{units:"meters"}),u=Math.abs(s/o);return isNaN(u)||u<=0?(console.warn("[Rectangle][_getPixelsPerMeter] Ratio invalide, utilisation de la valeur par défaut"),1):u})}getRotatedCorners(){return hn.measure("Rectangle.getRotatedCorners",()=>{try{const t=this.getLatLngs();if(!t||!Array.isArray(t)||t.length===0){const r=this._width/2,i=this._height/2;return[qn.latLng(this._center.lat+i,this._center.lng-r),qn.latLng(this._center.lat+i,this._center.lng+r),qn.latLng(this._center.lat-i,this._center.lng+r),qn.latLng(this._center.lat-i,this._center.lng-r)]}return t[0]}catch(t){console.warn("Error in getRotatedCorners:",t);const r=this._width/2,i=this._height/2;return[qn.latLng(this._center.lat+i,this._center.lng-r),qn.latLng(this._center.lat+i,this._center.lng+r),qn.latLng(this._center.lat-i,this._center.lng+r),qn.latLng(this._center.lat-i,this._center.lng-r)]}})}getMidPoints(){return hn.measure("Rectangle.getMidPoints",()=>{try{const t=this.getRotatedCorners();if(!t||t.length<4){const i=this._width/2,s=this._height/2;return[qn.latLng(this._center.lat+s,this._center.lng),qn.latLng(this._center.lat,this._center.lng+i),qn.latLng(this._center.lat-s,this._center.lng),qn.latLng(this._center.lat,this._center.lng-i)]}if(!t.every(i=>i&&typeof i.lat=="number"&&typeof i.lng=="number"))throw new Error("Invalid corner coordinates");return[this._getMidPoint(t[3],t[0]),this._getMidPoint(t[0],t[1]),this._getMidPoint(t[1],t[2]),this._getMidPoint(t[2],t[3])]}catch(t){console.warn("Error in getMidPoints:",t);const r=this._width/2,i=this._height/2;return[qn.latLng(this._center.lat+i,this._center.lng),qn.latLng(this._center.lat,this._center.lng+r),qn.latLng(this._center.lat-i,this._center.lng),qn.latLng(this._center.lat,this._center.lng-r)]}})}_getMidPoint(t,r){return hn.measure("Rectangle._getMidPoint",()=>{if(!t||!r||typeof t.lat!="number"||typeof t.lng!="number"||typeof r.lat!="number"||typeof r.lng!="number")throw new Error("Invalid points for midpoint calculation");return qn.latLng((t.lat+r.lat)/2,(t.lng+r.lng)/2)})}getCenter(){return hn.measure("Rectangle.getCenter",()=>this._center)}setCenter(t){hn.measure("Rectangle.setCenter",()=>{this._center=t,this._updatePolygonCoordinates(),this.updateProperties(),this.updateHelperPointPositions()})}getRotation(){return hn.measure("Rectangle.getRotation",()=>this._rotation)}setRotation(t,r=!1){hn.measure("Rectangle.setRotation",()=>{this._rotation=(t%360+360)%360,this._updatePolygonCoordinates(),r&&this.updateProperties(),this.updateHelperPointPositions(),this.fire("rotation:updated",{angle:this._rotation,corners:this.getRotatedCorners(),center:this._center})})}finalizeRotation(){hn.measure("Rectangle.finalizeRotation",()=>{this.updateProperties()})}getDimensions(){return hn.measure("Rectangle.getDimensions",()=>({width:this._width,height:this._height}))}setDimensions(t,r){hn.measure("Rectangle.setDimensions",()=>{console.log("[Rectangle][setDimensions] Début de la mise à jour des dimensions:",{oldWidth:this._width,oldHeight:this._height,newWidth:t,newHeight:r}),this._width=t,this._height=r,console.log("[Rectangle][setDimensions] Mise à jour des coordonnées du polygone"),this._updatePolygonCoordinates(),console.log("[Rectangle][setDimensions] Mise à jour des propriétés"),this.updateProperties(),console.log("[Rectangle][setDimensions] Émission de l'événement dimensions:updated"),this.fire("dimensions:updated",{width:this._width,height:this._height,corners:this.getRotatedCorners(),center:this._center}),this.updateHelperPointPositions()})}resizeFromCorner(t,r){hn.measure("Rectangle.resizeFromCorner",()=>{if(!(!this._isMapReady||!this._map))try{const i=this._map.latLngToContainerPoint(this._center),s=this._map.latLngToContainerPoint(r),o=s.x-i.x,u=s.y-i.y,f=-this._rotation*Math.PI/180,d=Math.cos(f),m=Math.sin(f),_=o*d-u*m,w=o*m+u*d,y=this._getPixelsPerMeter(),M=t===0||t===3?-1:1,k=t===0||t===1?1:-1,F=Math.max(Math.abs(_*2)/y,1),I=Math.max(Math.abs(w*2)/y,1),R=F*y/2,K=I*y/2,ee=M*R*d-k*K*m,he=M*R*m+k*K*d,fe=qn.point(s.x-ee,s.y-he),ve=this._map.containerPointToLatLng(fe),J=[qn.point(fe.x-R,fe.y+K),qn.point(fe.x+R,fe.y+K),qn.point(fe.x+R,fe.y-K),qn.point(fe.x-R,fe.y-K)].map(T=>{const D=T.x-fe.x,B=T.y-fe.y;return qn.point(fe.x+(D*d-B*m),fe.y+(D*m+B*d))}).map(T=>this._map.containerPointToLatLng(T));this._width=F,this._height=I,this._center=ve,this.setLatLngs(J),this.fire("coordinates:updated",{corners:J,center:this._center,rotation:this._rotation})}catch(i){console.warn("Error in resizeFromCorner:",i)}})}resizeFromSide(t,r){hn.measure("Rectangle.resizeFromSide",()=>{if(!this._isMapReady||!this._map)return;const i=this._map.latLngToContainerPoint(this._center),s=this._map.latLngToContainerPoint(r),o=s.x-i.x,u=s.y-i.y,f=-this._rotation*Math.PI/180,d=Math.cos(f),m=Math.sin(f),_=o*d-u*m,w=o*m+u*d,y=this._getPixelsPerMeter();t%2===0?this._height=Math.abs(w*2)/y:this._width=Math.abs(_*2)/y,this._updatePolygonCoordinates(),this.updateProperties()})}moveFromCenter(t){hn.measure("Rectangle.moveFromCenter",()=>{this._center=t,this._updatePolygonCoordinates(),this.updateProperties()})}updateProperties(){hn.measure("Rectangle.updateProperties",()=>{var i,s,o;const t=this.getRotatedCorners(),r=((s=(i=this.properties)==null?void 0:i.style)==null?void 0:s.name)||"";this.properties={...this.properties,width:this._width,height:this._height,surface:this._width*this._height,perimeter:2*(this._width+this._height),center:this._center,corners:t,midPoints:this.getMidPoints(),rotation:this._rotation,style:{...this.options,color:this.options.color||"#2b6451",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#2b6451",fillOpacity:this.options.fillOpacity||.2,dashArray:((o=this.options)==null?void 0:o.dashArray)||"",name:r}},this.fire("properties:updated",{shape:this,properties:this.properties,corners:t,midPoints:this.getMidPoints()})})}setName(t){hn.measure("Rectangle.setName",()=>{this.properties.style||(this.properties.style={}),this.properties.style.name=t,this.fire("properties:updated",{shape:this,properties:this.properties})})}getName(){return hn.measure("Rectangle.getName",()=>{var t,r;return((r=(t=this.properties)==null?void 0:t.style)==null?void 0:r.name)||""})}generateHelperPoints(t,r="rgba(220, 38, 38, 0.5)",i="rgba(37, 99, 235, 0.5)"){hn.measure("Rectangle.generateHelperPoints",()=>{this.clearHelperPoints();const s=this.getRotatedCorners(),o=this.getMidPoints();this._helperPoints.corners=s.map(u=>qn.circleMarker(u,{radius:5,color:r,fillColor:r,fillOpacity:.6,weight:1,opacity:.8,className:"rectangle-helper-corner",pmIgnore:!0,interactive:!1}).addTo(t)),this._helperPoints.midPoints=o.map(u=>qn.circleMarker(u,{radius:5,color:i,fillColor:i,fillOpacity:.6,weight:1,opacity:.8,className:"rectangle-helper-midpoint",pmIgnore:!0,interactive:!1}).addTo(t))})}clearHelperPoints(){hn.measure("Rectangle.clearHelperPoints",()=>{this._helperPoints.corners.forEach(t=>{if(t&&t.remove)try{t.remove()}catch(r){console.warn("Erreur lors de la suppression d'un point d'aide de coin:",r)}}),this._helperPoints.midPoints.forEach(t=>{if(t&&t.remove)try{t.remove()}catch(r){console.warn("Erreur lors de la suppression d'un point d'aide de milieu:",r)}}),this._helperPoints.corners=[],this._helperPoints.midPoints=[]})}updateHelperPointPositions(){hn.measure("Rectangle.updateHelperPointPositions",()=>{if(this._helperPoints.corners.length===0&&this._helperPoints.midPoints.length===0)return;const t=this.getRotatedCorners(),r=this.getMidPoints();t.forEach((i,s)=>{this._helperPoints.corners[s]&&this._helperPoints.corners[s].setLatLng(i)}),r.forEach((i,s)=>{this._helperPoints.midPoints[s]&&this._helperPoints.midPoints[s].setLatLng(i)})})}findClosestHelperPoint(t){return hn.measure("Rectangle.findClosestHelperPoint",()=>{const r=this.getRotatedCorners(),i=this.getMidPoints(),s=[...r,...i];if(s.length===0)return null;let o=s[0],u=t.distanceTo(o);for(let f=1;f<s.length;f++){const d=t.distanceTo(s[f]);d<u&&(u=d,o=s[f])}return o})}toggleHelperPoints(t,r,i,s){hn.measure("Rectangle.toggleHelperPoints",()=>{r&&t?this.generateHelperPoints(t,i,s):this.clearHelperPoints()})}containsPoint(t){return hn.measure("Rectangle.containsPoint",()=>{const r=this.getRotatedCorners();if(r.length!==4)return!1;let i=!1;for(let s=0,o=r.length-1;s<r.length;o=s++){const u=r[s].lng,f=r[s].lat,d=r[o].lng,m=r[o].lat;f>t.lat!=m>t.lat&&t.lng<(d-u)*(t.lat-f)/(m-f)+u&&(i=!i)}return i})}}var Xi=(e=>(e.PRIVATE="private",e.COMPANY="company",e.EMPLOYEE="employee",e.VISITOR="visitor",e))(Xi||{});const lh=Dp("notes",()=>{const e=zt([]),n=zt([]),t=sr(()=>T=>e.value.find(D=>D.id===T)),r=sr(()=>T=>{const D=e.value.find(B=>B.id===T);return D?D.color:"#6B7280"}),i=sr(()=>T=>n.value.filter(D=>D.columnId===T).sort((D,B)=>D.order-B.order)),s=sr(()=>e.value.find(T=>T.isDefault)||e.value[0]),o=sr(()=>[...e.value].sort((T,D)=>T.order-D.order)),u=sr(()=>T=>{const D=ma();if(!D.user)return!1;if(D.isAdmin)return!0;switch(T.accessLevel){case"private":return!0;case"company":return D.isAdmin||D.isEntreprise;case"employee":return D.isAdmin||D.isEntreprise||D.isSalarie;case"visitor":return D.isAdmin||D.isEntreprise||D.isSalarie||D.isVisiteur;default:return!1}}),f=sr(()=>n.value.filter(T=>u.value(T))),d=sr(()=>T=>f.value.filter(D=>D.columnId===T).sort((D,B)=>D.order-B.order));async function m(){console.log(`
[NotesStore][loadColumns] Initialisation des colonnes fixes...`);try{const T=[{id:"1",title:"Idées",color:"#8B5CF6",order:0,isDefault:!1},{id:"2",title:"À faire",color:"#F59E0B",order:1,isDefault:!0},{id:"3",title:"En cours",color:"#3B82F6",order:2,isDefault:!1},{id:"4",title:"Terminées",color:"#10B981",order:3,isDefault:!1},{id:"5",title:"Autres",color:"#6B7280",order:4,isDefault:!1}];e.value=T,console.log("[NotesStore][loadColumns] Colonnes fixes initialisées:",e.value)}catch(T){throw console.error("[NotesStore][loadColumns] Erreur:",T),T}}async function _(T){console.log(`
[NotesStore][addColumn] Fonction désactivée - Utilisation de colonnes fixes`)}async function w(T,D){console.log(`
[NotesStore][updateColumn] Mise à jour locale de la colonne:`,T,D);try{const B=e.value.findIndex($=>$.id===T);B!==-1&&(e.value[B]={...e.value[B],...D},console.log("[NotesStore][updateColumn] État des colonnes après mise à jour:",e.value))}catch(B){throw console.error("[NotesStore][updateColumn] Erreur:",B),B}}async function y(T){console.log(`
[NotesStore][removeColumn] Fonction désactivée - Utilisation de colonnes fixes`)}async function M(T){console.log(`
[NotesStore][reorderColumns] FONCTION DÉSACTIVÉE - Le déplacement des colonnes n'est plus possible`)}function k(T){if(!T)return"private";switch(T.toLowerCase()){case"private":return"private";case"company":return"company";case"employee":return"employee";case"visitor":return"visitor";default:return console.warn(`[NotesStore] Niveau d'accès inconnu: ${T}, utilisation de PRIVATE par défaut`),"private"}}function F(T){if(!T.id)throw console.error("[NotesStore][addNote] Erreur: ID du backend manquant"),new Error("L'ID du backend est requis pour ajouter une note");const D=new Date().toISOString(),B=n.value.filter(G=>G.columnId===T.columnId),$=B.length>0?Math.max(...B.map(G=>G.order))+1:0,W=k(T.access_level);return console.log("[NotesStore][addNote] Ajout d'une note avec ID backend:",T.id,"et niveau d'accès:",W),n.value.push({...T,id:T.id,order:$,accessLevel:W,createdAt:D,updatedAt:D,comments:[],photos:[]}),T.id}function I(T,D){console.log(`
[NotesStore][updateNote] Mise à jour de la note:`,T,D);try{const B=n.value.findIndex($=>$.id===T);B!==-1&&(D.color&&(D.style={...n.value[B].style,color:D.color,fillColor:D.color}),D.access_level&&(D.accessLevel=k(D.access_level),delete D.access_level),n.value[B]={...n.value[B],...D},console.log("[NotesStore][updateNote] Note mise à jour:",n.value[B]))}catch(B){throw console.error("[NotesStore][updateNote] Erreur:",B),B}}function R(T){n.value.findIndex(B=>B.id===T)!==-1?(console.log("[NotesStore][removeNote] Suppression de la note avec ID:",T),n.value=n.value.filter(B=>B.id!==T)):console.warn("[NotesStore][removeNote] Tentative de suppression d'une note inexistante avec ID:",T)}function K(T,D){const B=n.value.findIndex($=>$.id===T);if(B!==-1){const $=n.value[B];if($.columnId!==D){const G=n.value.filter(we=>we.columnId===D),oe=G.length>0?Math.max(...G.map(we=>we.order))+1:0,ie={...$,columnId:D,order:oe,updatedAt:new Date().toISOString()};n.value[B]=ie}else n.value[B]={...n.value[B],updatedAt:new Date().toISOString()}}}function ee(T,D){D.forEach((B,$)=>{const W=n.value.findIndex(G=>G.id===B&&G.columnId===T);W!==-1&&(n.value[W]={...n.value[W],order:$,updatedAt:new Date().toISOString()})})}function he(T){switch(T){case"private":return"Privé";case"company":return"Entreprise";case"employee":return"Salariés";case"visitor":return"Visiteurs";default:return"Inconnu"}}async function fe(T,D){try{const B=ma();if(!B.user)throw new Error("Vous devez être connecté pour ajouter un commentaire");if(!B.isEntreprise&&!B.isAdmin)throw new Error("Seules les entreprises peuvent ajouter des commentaires");if(!n.value.some(Ce=>Ce.id===T))throw new Error(`La note avec l'ID ${T} n'existe pas`);const G=(await Qs.addComment(T,D)).data,oe=n.value.findIndex(Ce=>Ce.id===T);if(oe===-1)return;const ie=n.value[oe];ie.comments||(ie.comments=[]);const we={id:G.id,text:G.text,createdAt:G.created_at,userId:G.user,userName:G.user_name,userRole:G.user_role};return ie.comments.push(we),ie.updatedAt=new Date().toISOString(),n.value[oe]={...ie},we.id}catch(B){throw console.error("Erreur lors de l'ajout du commentaire:",B),B}}async function ve(T,D){try{const B=n.value.findIndex(G=>G.id===T);if(B===-1)throw new Error(`La note avec l'ID ${T} n'existe pas`);const $=n.value[B];if(!$.comments||$.comments.length===0)throw new Error("Aucun commentaire trouvé pour cette note");if(!$.comments.some(G=>G.id===D))throw new Error(`Le commentaire avec l'ID ${D} n'existe pas`);await Qs.deleteComment(T,D),$.comments=$.comments.filter(G=>G.id!==D),$.updatedAt=new Date().toISOString(),n.value[B]={...$}}catch(B){throw console.error("Erreur lors de la suppression du commentaire:",B),B}}async function z(T,D){try{if(D.id&&D.image){const B=n.value.findIndex(G=>G.id===T);if(B===-1)return;const $=n.value[B];$.photos||($.photos=[]);const W={id:D.id,url:D.image,caption:D.caption,createdAt:D.created_at};return $.photos.push(W),$.updatedAt=new Date().toISOString(),n.value[B]={...$},W.id}else{const B=new FormData;B.append("image",D.url),D.caption&&B.append("caption",D.caption);const W=(await Qs.addPhoto(T,B)).data,G=n.value.findIndex(we=>we.id===T);if(G===-1)return;const oe=n.value[G];oe.photos||(oe.photos=[]);const ie={id:W.id,url:W.image,caption:W.caption,createdAt:W.created_at};return oe.photos.push(ie),oe.updatedAt=new Date().toISOString(),n.value[G]={...oe},ie.id}}catch(B){throw console.error("Erreur lors de l'ajout de la photo:",B),B}}async function U(T,D){try{await Qs.deletePhoto(T,D);const B=n.value.findIndex(G=>G.id===T);if(B===-1){console.error("[NotesStore] Note non trouvée pour la suppression de la photo");return}n.value[B].photos||(n.value[B].photos=[]);const $=n.value[B],W=($.photos||[]).filter(G=>G.id!==D);n.value[B]={...$,photos:W,updatedAt:new Date().toISOString()},console.log("[NotesStore] Photo supprimée avec succès, photos restantes:",W.length)}catch(B){throw console.error("Erreur lors de la suppression de la photo:",B),B}}async function J(T,D,B){try{await Qs.updatePhoto(T,D,{caption:B});const $=n.value.findIndex(oe=>oe.id===T);if($===-1||!n.value[$].photos)return;const W=n.value[$],G=W.photos.findIndex(oe=>oe.id===D);if(G===-1)return;W.photos[G].caption=B,W.updatedAt=new Date().toISOString(),n.value[$]={...W}}catch($){throw console.error("Erreur lors de la mise à jour de la légende:",$),$}}return{columns:e,notes:n,getColumnById:t,getColumnColor:r,getNotesByColumn:i,getDefaultColumn:s,getSortedColumns:o,hasAccessToNote:u,getAccessibleNotes:f,getAccessibleNotesByColumn:d,getAccessLevelLabel:he,loadColumns:m,addColumn:_,updateColumn:w,removeColumn:y,reorderColumns:M,addNote:F,updateNote:I,removeNote:R,moveNote:K,reorderNotes:ee,addComment:fe,removeComment:ve,addPhoto:z,removePhoto:U,updatePhoto:J}});class zc extends jt.Marker{constructor(t,r={}){const s=`
      <div class="geo-note-marker">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="${r.color||"#2b6451"}" width="24" height="24">
          <path d="M12 22s-8-4.5-8-11.8A8 8 0 0 1 12 2a8 8 0 0 1 8 8.2c0 7.3-8 11.8-8 11.8z" />
          <circle cx="12" cy="10" r="3" fill="white" />
        </svg>
      </div>
    `,u={icon:jt.divIcon({html:s,className:"",iconSize:[24,36],iconAnchor:[12,36],popupAnchor:[0,-36]}),draggable:!1,autoPan:!0};super(t,u);qt(this,"properties");qt(this,"_planSaved",!1);qt(this,"_isMoving",!1);this.properties={type:"Note",name:r.name||"Note géolocalisée",description:r.description||"",columnId:r.columnId||"1",accessLevel:r.accessLevel||Xi.PRIVATE,category:r.category||"forages",style:{color:r.color||"#2b6451",weight:r.weight||2,fillColor:r.fillColor||"#2b6451",fillOpacity:r.fillOpacity!==void 0?r.fillOpacity:.8,radius:r.radius||12},comments:[],photos:[],order:0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},console.log("[GeoNote][constructor] Note créée avec columnId:",this.properties.columnId),this.bindPopup(this.createPopupContent()),this.on("dblclick",this.onDoubleClick),window.addEventListener("geonote:updateStyle",f=>{const d=f.detail.noteId,m=this._dbId||this.properties.id;console.log("[GeoNote][updateStyle] Événement reçu pour noteId:",d,"Comparaison avec ID backend:",m),d===m&&(console.log("[GeoNote][updateStyle] Correspondance trouvée, mise à jour du style:",f.detail.style),this.setNoteStyle(f.detail.style),this.properties&&this.properties.style&&(this.properties.style={...this.properties.style,...f.detail.style}),this.bindPopup(this.createPopupContent()))}),window.addEventListener("geonote:update",f=>{const d=f.detail.noteId,m=this._dbId||this.properties.id;console.log("[GeoNote][update] Événement reçu pour noteId:",d,"Comparaison avec ID backend:",m),d===m&&(console.log("[GeoNote][update] Correspondance trouvée, mise à jour des propriétés:",f.detail.properties),this.properties={...this.properties,name:f.detail.properties.name,description:f.detail.properties.description,columnId:f.detail.properties.columnId,accessLevel:f.detail.properties.accessLevel,style:f.detail.properties.style},this.setNoteStyle(f.detail.properties.style),this.bindPopup(this.createPopupContent()),console.log("[GeoNote][update] Propriétés mises à jour:",this.properties))}),console.log("[GeoNote][constructor] Note créée:",{location:t,name:this.properties.name,type:this.properties.type,style:this.properties.style})}createPopupContent(){const t=document.createElement("div");t.className="geo-note-popup",t.style.display="flex",t.style.flexDirection="column";const r=document.createElement("div");r.className="geo-note-header",t.appendChild(r);const i=document.createElement("div");i.className="geo-note-title",i.textContent=this.properties.name,r.appendChild(i);const s=document.createElement("div");s.className="geo-note-badges",r.appendChild(s);const o=document.createElement("div");o.className="geo-note-badge",o.style.backgroundColor=this.getColumnColor(this.properties.columnId),o.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
        <path d="M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5z" />
        <path d="M11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" />
      </svg>
      ${this.getColumnLabel(this.properties.columnId)}
    `,s.appendChild(o);const u=document.createElement("div");if(u.className="geo-note-badge",u.style.backgroundColor=this.getAccessLevelColor(this.properties.accessLevel),u.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" />
      </svg>
      ${this.getAccessLevelLabel(this.properties.accessLevel)}
    `,s.appendChild(u),this.properties.description&&this.properties.description.trim()!==""){const _=document.createElement("div");_.className="geo-note-content",t.appendChild(_);const w=document.createElement("div");w.className="geo-note-description",w.textContent=this.properties.description,_.appendChild(w)}const f=document.createElement("div");f.className="geo-note-buttons",f.style.display="flex",f.style.width="100%",f.style.marginTop="auto",f.style.borderTop="1px solid #E5E7EB",t.appendChild(f);const d=document.createElement("button");d.className="geo-note-edit-button",d.style.flex="1",d.style.height="36px",d.style.border="none",d.style.borderRight="1px solid #E5E7EB",d.style.background="transparent",d.style.color="#4B5563",d.style.fontSize="11px",d.style.fontWeight="500",d.style.display="flex",d.style.alignItems="center",d.style.justifyContent="center",d.style.cursor="pointer",d.style.padding="0",d.style.margin="0",d.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-3 h-3 mr-1 inline-block align-text-bottom">
        <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z" />
      </svg>
      Éditer
    `,d.onclick=_=>{_.stopPropagation(),this.editNote()},f.appendChild(d);const m=document.createElement("button");return m.className="geo-note-open-button",m.style.flex="1",m.style.height="36px",m.style.border="none",m.style.background="transparent",m.style.color="#3B82F6",m.style.fontSize="11px",m.style.fontWeight="500",m.style.display="flex",m.style.alignItems="center",m.style.justifyContent="center",m.style.cursor="pointer",m.style.padding="0",m.style.margin="0",m.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-3 h-3 mr-1 inline-block align-text-bottom">
        <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd" />
      </svg>
      Itinéraire
    `,m.onclick=_=>{_.stopPropagation(),this.openInGoogleMaps()},f.appendChild(m),t}getColumnColor(t){return{1:"#8B5CF6",2:"#F59E0B",3:"#3B82F6",4:"#10B981",5:"#6B7280"}[t]||"#6B7280"}getColumnLabel(t){return{1:"Idées",2:"À faire",3:"En cours",4:"Terminées",5:"Autres"}[t]||"Colonne "+t}getAccessLevelLabel(t){switch(t){case Xi.PRIVATE:return"Privé";case Xi.COMPANY:return"Entreprise";case Xi.EMPLOYEE:return"Salariés";case Xi.VISITOR:return"Visiteurs";default:return"Inconnu"}}getAccessLevelColor(t){switch(t){case Xi.PRIVATE:return"#9CA3AF";case Xi.COMPANY:return"#EF4444";case Xi.EMPLOYEE:return"#F59E0B";case Xi.VISITOR:return"#10B981";default:return"#6B7280"}}onDoubleClick(t){jt.DomEvent.stopPropagation(t),this.editNote()}editNote(){this.closePopup();const t=this._dbId||this.properties.id||this._leaflet_id;console.log(`[GeoNote][editNote] Édition de note - ID backend: ${this._dbId}, ID properties: ${this.properties.id}, ID Leaflet: ${this._leaflet_id}, ID utilisé: ${t}`);const r={id:t,title:this.properties.name,description:this.properties.description,location:{type:"Point",coordinates:[this.getLatLng().lng,this.getLatLng().lat]},columnId:this.properties.columnId||"1",accessLevel:this.properties.accessLevel||"company",style:this.properties.style||{color:"#2b6451",weight:2,opacity:1,fillColor:"#2b6451",fillOpacity:.6,radius:8},order:0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),comments:this.properties.comments||[],photos:this.properties.photos||[]};console.log("[GeoNote][editNote] Édition de note avec columnId:",r.columnId),console.log("[GeoNote] Émission de l'événement note:edit avec",r);const i=new CustomEvent("geonote:edit",{detail:{note:r,source:this}});window.dispatchEvent(i),this.fire("note:edit",{note:r,source:this})}openInGoogleMaps(){this.closePopup();const t=this.getLatLng().lat,r=this.getLatLng().lng,i=`https://www.google.com/maps/dir/?api=1&destination=${t},${r}`;window.open(i,"_blank")}updateProperties(){var s,o;this.properties.type="Note",this.properties.category||(this.properties.category="forages"),this.properties.accessLevel||(this.properties.accessLevel=Xi.PRIVATE);const t=(s=this.getElement())==null?void 0:s.querySelector(".geo-note-marker"),r=t?window.getComputedStyle(t).color:"#2b6451",i=((o=this.properties.style)==null?void 0:o.radius)||12;this.properties.style={color:r,weight:2,fillColor:r,fillOpacity:.8,radius:i}}setNoteStyle(t){console.log("[GeoNote][setNoteStyle] Mise à jour du style:",t);const r=t.color||t.fillColor||"#2b6451",i=t.fillColor||t.color||"#2b6451";console.log("[GeoNote][setNoteStyle] Nouvelles couleurs - stroke:",r,"fill:",i);const s=`
      <div class="geo-note-marker">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="${i}" width="24" height="24">
          <path d="M12 22s-8-4.5-8-11.8A8 8 0 0 1 12 2a8 8 0 0 1 8 8.2c0 7.3-8 11.8-8 11.8z" />
          <circle cx="12" cy="10" r="3" fill="white" />
        </svg>
      </div>
    `,o=jt.divIcon({html:s,className:"",iconSize:[24,36],iconAnchor:[12,36],popupAnchor:[0,-36]});this.setIcon(o),this.properties&&this.properties.style&&(this.properties.style={...this.properties.style,color:r,weight:t.weight||this.properties.style.weight||2,fillColor:i,fillOpacity:t.fillOpacity!==void 0?t.fillOpacity:this.properties.style.fillOpacity||.8,radius:t.radius||this.properties.style.radius||12}),this.refreshIconStyle()}refreshIconStyle(){const t=this.getElement();t&&(t.style.display="none",t.offsetHeight,t.style.display="")}toBackendFormat(t){this.updateProperties();const r=this.getLatLng(),s={...{...this.properties.style,radius:this.properties.style.radius||12},_accessLevel:this.properties.accessLevel,accessLevel:this.properties.accessLevel},o=this.properties.columnId||"1";return console.log("[GeoNote][toBackendFormat] Sauvegarde de note avec columnId:",o),{id:t,type_forme:"Note",data:{location:{type:"Point",coordinates:[r.lng,r.lat]},name:this.properties.name,description:this.properties.description,columnId:o,accessLevel:this.properties.accessLevel,category:this.properties.category||"forages",style:s,comments:this.properties.comments||[],photos:this.properties.photos||[],order:this.properties.order||0,createdAt:this.properties.createdAt||new Date().toISOString(),updatedAt:new Date().toISOString()}}}updateFromBackendData(t){this.properties.type="Note";const r=t.style?{...t.style,radius:t.style.radius||12}:this.properties.style,i=t.columnId||this.properties.columnId||"1";console.log("[GeoNote][updateFromBackendData] Mise à jour de note avec columnId:",i),this.properties={...this.properties,name:t.name||this.properties.name,description:t.description||this.properties.description,columnId:i,accessLevel:t.accessLevel||this.properties.accessLevel,category:t.category||this.properties.category||"forages",style:r,comments:t.comments||this.properties.comments||[],photos:t.photos||this.properties.photos||[],order:t.order||this.properties.order||0,createdAt:t.createdAt||this.properties.createdAt,updatedAt:t.updatedAt||new Date().toISOString()},this.setNoteStyle(r),this.bindPopup(this.createPopupContent()),console.log("[GeoNote][updateFromBackendData] Note mise à jour:",{name:this.properties.name,type:this.properties.type,style:this.properties.style})}static fromBackendData(t){var u,f,d,m,_,w,y;let r;if(typeof t.location=="object"&&!Array.isArray(t.location)&&t.location.type==="Point"){const M=t.location.coordinates;console.log("[GeoNote][fromBackendData] Coordonnées GeoJSON reçues:",M),r=[M[1],M[0]]}else if(Array.isArray(t.location)&&t.location.length===2)r=t.location;else throw new Error("Les données de la note ne contiennent pas de position valide");console.log("[GeoNote][fromBackendData] Création d'une note à partir des données:",t),console.log("[GeoNote][fromBackendData] Position utilisée:",r);const i=((u=t.style)==null?void 0:u._accessLevel)||((f=t.style)==null?void 0:f.accessLevel)||t.accessLevel||Xi.PRIVATE;console.log("[GeoNote][fromBackendData] Niveau d'accès récupéré:",i,"Style:",t.style),t.accessLevel=i;const s=t.columnId||"1";console.log("[GeoNote][fromBackendData] Création de note avec columnId:",s);const o=new zc(r,{name:t.name,description:t.description,columnId:s,accessLevel:i,category:t.category||"forages",color:(d=t.style)==null?void 0:d.color,weight:(m=t.style)==null?void 0:m.weight,fillColor:(_=t.style)==null?void 0:_.fillColor,fillOpacity:(w=t.style)==null?void 0:w.fillOpacity,radius:(y=t.style)==null?void 0:y.radius});return o.properties.type="Note",o.properties.comments=t.comments||[],o.properties.photos=t.photos||[],o.properties.order=t.order||0,o.properties.createdAt=t.createdAt||new Date().toISOString(),o.properties.updatedAt=t.updatedAt||new Date().toISOString(),t.style&&o.setNoteStyle(t.style),o.bindPopup(o.createPopupContent()),console.log("[GeoNote][fromBackendData] Note créée:",{location:r,name:o.properties.name,type:o.properties.type,style:o.properties.style}),o}async saveNote(t){if(this._planSaved)return this._dbId||0;console.log("[GeoNote][saveNote] Sauvegarde directe de la note via l'API");try{const r={title:this.properties.name,description:this.properties.description,location:{type:"Point",coordinates:[this.getLatLng().lng,this.getLatLng().lat]},column:this.properties.columnId||"1",access_level:this.properties.accessLevel||"company",style:this.properties.style||{color:"#2b6451",weight:2,opacity:1,fillColor:"#2b6451",fillOpacity:.6,radius:8},category:this.properties.category||"forages",comments:this.properties.comments||[],photos:this.properties.photos||[]};t&&(r.plan=t),console.log("[GeoNote][saveNote] Données à envoyer:",r);let i;return this._dbId?(i=(await Qs.updateNote(this._dbId,r)).data,console.log("[GeoNote][saveNote] Note mise à jour avec succès:",i)):(i=(await Qs.createNote(r)).data,console.log("[GeoNote][saveNote] Note créée avec succès:",i),this._dbId=i.id,lh().addNote({...i,id:i.id,columnId:i.column,accessLevel:i.access_level})),this._planSaved=!0,i.id}catch(r){return console.error("[GeoNote][saveNote] Erreur lors de la sauvegarde de la note:",r),vu().error("Erreur lors de la sauvegarde de la note"),0}}triggerPlanSave(){const t=localStorage.getItem("lastPlanId");t?(console.log(`[GeoNote][triggerPlanSave] Sauvegarde de la note avec le plan ${t}`),this.saveNote(parseInt(t))):(console.log("[GeoNote][triggerPlanSave] Aucun plan courant, sauvegarde sans association"),this.saveNote());const r=new CustomEvent("geonote:savePlan");window.dispatchEvent(r)}resetPlanSaveState(){this._planSaved=!1}moveTo(t){this.setLatLng(t),this.fire("note:moved",{latlng:t,note:this}),this.bindPopup(this.createPopupContent()),this.triggerPlanSave()}startMoving(){this._isMoving=!0,this.closePopup(),this.fire("note:movestart",{latlng:this.getLatLng(),note:this})}finishMoving(){this._isMoving=!1,this.fire("note:moveend",{latlng:this.getLatLng(),note:this}),this.triggerPlanSave()}isMoving(){return this._isMoving}}function xI(e){return e&&Array.isArray(e.points)&&e.points.length>0&&Array.isArray(e.points[0])&&e.points[0].length===2}function LI(e){if(!e||typeof e!="object")return console.log("[DrawingStore] ElevationData invalide: pas un objet",{data:e}),!1;const n=Array.isArray(e.points)&&e.points.length>0&&Array.isArray(e.points[0])&&e.points[0].length===2,t=typeof e.style=="object"&&e.style!==null,r=!e.elevationData||Array.isArray(e.elevationData)&&e.elevationData.every(i=>typeof i=="object"&&"distance"in i&&"elevation"in i);return n&&t&&r}function SI(e){return e&&Array.isArray(e.points)&&e.points.length>0&&Array.isArray(e.points[0])&&e.points[0].length===2}function _b(e){var n,t,r,i,s,o,u,f,d,m,_,w,y,M,k,F,I,R,K,ee,he,fe,ve,z,U,J,T;if(console.log("[DrawingStore] Conversion de la forme en élément",{type:(n=e.properties)==null?void 0:n.type,name:(r=(t=e.properties)==null?void 0:t.style)==null?void 0:r.name,properties:e.properties}),((i=e.properties)==null?void 0:i.type)==="Note"){const D=e.getLatLng();return{type_forme:"Note",data:{points:[[D.lng,D.lat]],style:{color:((s=e.properties.style)==null?void 0:s.color)||"#2b6451",weight:((o=e.properties.style)==null?void 0:o.weight)||3,opacity:((u=e.properties.style)==null?void 0:u.opacity)||1,fillColor:((f=e.properties.style)==null?void 0:f.fillColor)||"#2b6451",fillOpacity:((d=e.properties.style)==null?void 0:d.fillOpacity)||.2,name:((m=e.properties.style)==null?void 0:m.name)||""}}}}if(e instanceof Cf||((_=e.properties)==null?void 0:_.type)==="ElevationLine")return{type_forme:"ElevationLine",data:{points:e.getLatLngs().map($=>[$.lng,$.lat]),style:{color:((w=e.properties.style)==null?void 0:w.color)||"#2b6451",weight:((y=e.properties.style)==null?void 0:y.weight)||4,opacity:((M=e.properties.style)==null?void 0:M.opacity)||.8,name:((k=e.properties.style)==null?void 0:k.name)||""},category:e.properties.category||"forages",accessLevel:e.properties.accessLevel||"visitor",elevationData:e.properties.elevationData,minElevation:e.properties.minElevation,maxElevation:e.properties.maxElevation,elevationGain:e.properties.elevationGain,elevationLoss:e.properties.elevationLoss,averageSlope:e.properties.averageSlope,maxSlope:e.properties.maxSlope}};if(e instanceof vf||((F=e.properties)==null?void 0:F.type)==="Polygon")return{type_forme:"Polygon",data:{points:e.getLatLngs()[0].map($=>[$.lng,$.lat]),style:{color:((I=e.properties.style)==null?void 0:I.color)||"#2b6451",weight:((R=e.properties.style)==null?void 0:R.weight)||3,opacity:((K=e.properties.style)==null?void 0:K.opacity)||1,fillColor:((ee=e.properties.style)==null?void 0:ee.fillColor)||"#2b6451",fillOpacity:((he=e.properties.style)==null?void 0:he.fillOpacity)||.2,name:((fe=e.properties.style)==null?void 0:fe.name)||""},category:e.properties.category||"forages",accessLevel:e.properties.accessLevel||"visitor"}};if(e instanceof Bs||((ve=e.properties)==null?void 0:ve.type)==="Line")return{type_forme:"Line",data:{points:e.getLatLngs().map($=>[$.lng,$.lat]),category:e.properties.category||"forages",accessLevel:e.properties.accessLevel||"visitor",style:{color:((z=e.properties.style)==null?void 0:z.color)||"#2b6451",weight:((U=e.properties.style)==null?void 0:U.weight)||3,opacity:((J=e.properties.style)==null?void 0:J.opacity)||1,name:((T=e.properties.style)==null?void 0:T.name)||""}}};throw new Error("Type de forme non reconnu")}function EI(e){var n,t,r,i,s,o,u,f,d,m,_,w,y,M,k,F,I,R,K,ee,he,fe,ve,z,U,J,T,D,B,$,W,G,oe,ie,we,Ce,Te,Y,H,Q,ue,le,pe;switch(console.log("[DrawingStore] Conversion de l'élément stocké en forme",{element:e}),e.type_forme){case"Polygon":{const Z=e.data;if(!xI(Z))return console.error("[DrawingStore] Données invalides pour Polygon"),null;const N=Z.points.map(Ue=>qn.latLng(Ue[1],Ue[0])),ke=((n=Z.style)==null?void 0:n._accessLevel)||((t=Z.style)==null?void 0:t.accessLevel)||Z.accessLevel||"visitor";console.log("[DrawingStore] Polygon - Niveau d'accès récupéré:",ke,"Style:",Z.style),Z.accessLevel=ke;const Me=new vf([N],{color:((r=Z.style)==null?void 0:r.color)||"#2b6451",weight:((i=Z.style)==null?void 0:i.weight)||3,opacity:((s=Z.style)==null?void 0:s.opacity)||1,fillColor:((o=Z.style)==null?void 0:o.fillColor)||"#2b6451",fillOpacity:((u=Z.style)==null?void 0:u.fillOpacity)||.2,dashArray:((f=Z.style)==null?void 0:f.dashArray)||"",name:((d=Z.style)==null?void 0:d.name)||"",category:Z.category||"forages",accessLevel:ke});return Me.updateProperties(),Me}case"ElevationLine":{const Z=e.data;if(!LI(Z))return console.error("[DrawingStore] Données invalides pour ElevationLine"),null;const N=Z.points.map(Ue=>qn.latLng(Ue[1],Ue[0])),ke=((m=Z.style)==null?void 0:m._accessLevel)||((_=Z.style)==null?void 0:_.accessLevel)||Z.accessLevel||"visitor";console.log("[DrawingStore] ElevationLine - Niveau d'accès récupéré:",ke,"Style:",Z.style),Z.accessLevel=ke;const Me=new Cf(N,{color:((w=Z.style)==null?void 0:w.color)||"#2b6451",weight:((y=Z.style)==null?void 0:y.weight)||4,opacity:((M=Z.style)==null?void 0:M.opacity)||.8,name:((k=Z.style)==null?void 0:k.name)||"",category:Z.category||"forages",accessLevel:ke});return Me.properties={type:"ElevationLine",category:Z.category||"forages",accessLevel:ke,style:{...Z.style||{},name:((F=Z.style)==null?void 0:F.name)||""},elevationData:Z.elevationData,minElevation:Z.minElevation,maxElevation:Z.maxElevation,elevationGain:Z.elevationGain,elevationLoss:Z.elevationLoss,averageSlope:Z.averageSlope,maxSlope:Z.maxSlope,dataSource:"restored"},Z.elevationData&&Me.updateElevationProfile(),console.log("[DrawingStore] ElevationLine restored:",{points:N.length,hasElevationData:!!Z.elevationData,name:(I=Z.style)==null?void 0:I.name,properties:Me.properties}),Me}case"Line":{const Z=e.data;if(!SI(Z))return console.error("[DrawingStore] Données invalides pour Ligne"),null;const N=Z.points.map(Ue=>qn.latLng(Ue[1],Ue[0])),ke=((R=Z.style)==null?void 0:R._accessLevel)||((K=Z.style)==null?void 0:K.accessLevel)||Z.accessLevel||"visitor";console.log("[DrawingStore] Line - Niveau d'accès récupéré:",ke,"Style:",Z.style),Z.accessLevel=ke;const Me=new Bs(N,{...Z.style||{},name:((ee=Z.style)==null?void 0:ee.name)||"",category:Z.category||"forages",accessLevel:ke});return Me.updateProperties(),Me}case"Rectangle":{const Z=e.data;if(console.log("[DrawingStore][convertStoredElementToShape] Restauration Rectangle:",{data:Z,bounds:Z.bounds,width:Z.width,height:Z.height,rotation:Z.rotation}),!Z.bounds)return console.error("[DrawingStore] Données de bounds manquantes pour Rectangle"),null;const N=new qn.LatLngBounds(qn.latLng(Z.bounds.southWest[1],Z.bounds.southWest[0]),qn.latLng(Z.bounds.northEast[1],Z.bounds.northEast[0])),ke=new pa(N,{color:((he=Z.style)==null?void 0:he.color)||"#2b6451",weight:((fe=Z.style)==null?void 0:fe.weight)||3,opacity:((ve=Z.style)==null?void 0:ve.opacity)||1,fillColor:((z=Z.style)==null?void 0:z.fillColor)||"#2b6451",fillOpacity:((U=Z.style)==null?void 0:U.fillOpacity)||.2,dashArray:((J=Z.style)==null?void 0:J.dashArray)||"",name:((T=Z.style)==null?void 0:T.name)||"",width:Z.width,height:Z.height});return Z.rotation&&ke.setRotation(Z.rotation),console.log("[DrawingStore][convertStoredElementToShape] Rectangle restauré:",{bounds:ke.getBounds(),dimensions:ke.getDimensions(),properties:ke.properties}),ke}case"Circle":{console.log("[DrawingStore] Traitement d'un Circle à partir de l'API",{id:e.id,data:e.data,hasName:((B=(D=e.data)==null?void 0:D.style)==null?void 0:B.name)!==void 0,name:(W=($=e.data)==null?void 0:$.style)==null?void 0:W.name});const Z=e.data;if(!Z.center||!Z.radius)return console.error("[DrawingStore] Données invalides pour Circle"),null;const N=qn.circle([Z.center[1],Z.center[0]],{color:((G=Z.style)==null?void 0:G.color)||"#2b6451",weight:((oe=Z.style)==null?void 0:oe.weight)||3,opacity:((ie=Z.style)==null?void 0:ie.opacity)||1,fillColor:((we=Z.style)==null?void 0:we.fillColor)||"#2b6451",fillOpacity:((Ce=Z.style)==null?void 0:Ce.fillOpacity)||.2,dashArray:((Te=Z.style)==null?void 0:Te.dashArray)||"",radius:Z.radius});return N.properties={type:"Circle",radius:Z.radius,diameter:Z.radius*2,surface:Math.PI*Z.radius*Z.radius,perimeter:2*Math.PI*Z.radius,style:{...Z.style||{},name:((Y=Z.style)==null?void 0:Y.name)||""}},console.log("[DrawingStore] Cercle créé:",{centerType:typeof Z.center,center:Z.center,radius:Z.radius,style:N.properties.style,name:N.properties.style.name}),N}case"Note":{console.log("[DrawingStore] Traitement d'une Note à partir de l'API",{id:e.id,data:e.data});const Z=e.data;if(!Z.location)return console.error("[DrawingStore] Données invalides pour Note"),null;try{const N={location:Z.location,name:Z.name||"Note géolocalisée",description:Z.description||"",columnId:Z.columnId||"en-cours",accessLevel:Z.accessLevel||"private",category:Z.category||"forages",style:{color:((H=Z.style)==null?void 0:H.color)||"#2b6451",weight:((Q=Z.style)==null?void 0:Q.weight)||2,fillColor:((ue=Z.style)==null?void 0:ue.fillColor)||"#2b6451",fillOpacity:((le=Z.style)==null?void 0:le.fillOpacity)||.8,radius:((pe=Z.style)==null?void 0:pe.radius)||12},comments:Z.comments||[],photos:Z.photos||[],order:Z.order||0,createdAt:Z.createdAt||new Date().toISOString(),updatedAt:Z.updatedAt||new Date().toISOString()};console.log("[DrawingStore] Données préparées pour la note:",N);const ke=zc.fromBackendData(N);return ke._dbId=e.id,console.log("[DrawingStore] Note créée:",{id:e.id,location:N.location,name:N.name,type:ke.properties.type}),ke}catch(N){return console.error("[DrawingStore] Erreur lors de la création de la Note:",N),null}}default:return console.warn("[DrawingStore] Type non géré pour la restauration:",e.type_forme),null}}const cd=Dp("drawing",{state:()=>({currentMapId:null,elements:[],selectedElement:null,unsavedChanges:!1,loading:!1,error:null,currentTool:"",filters:{accessLevels:{company:!0,employee:!0,visitor:!0},categories:{forages:!0,clients:!0,entrepots:!0,livraisons:!0,cultures:!0,parcelles:!0},shapeTypes:{Polygon:!0,Line:!0,ElevationLine:!0,Note:!0}},currentStyle:{strokeStyle:"solid",strokeWidth:2,strokeColor:"#2563EB",fillColor:"#3B82F6",fillOpacity:.2},lastUsedType:null,performanceMonitor:md()}),getters:{hasUnsavedChanges:e=>e.unsavedChanges,getCurrentElements:e=>e.elements,getSelectedElement:e=>e.selectedElement,getCurrentTool:e=>e.currentTool,getCurrentStyle:e=>e.currentStyle,getLastUsedType:e=>e.lastUsedType,getFilters:e=>e.filters,getFilteredElements:e=>{if(e.elements.length===0)return console.log("[DrawingStore][getFilteredElements] Aucun élément dans le store, retour d'un tableau vide"),[];console.log("[DrawingStore][getFilteredElements] Début du filtrage avec",{totalElements:e.elements.length,filters:JSON.stringify({accessLevels:e.filters.accessLevels,categories:e.filters.categories,shapeTypes:e.filters.shapeTypes})}),console.log("[DrawingStore][getFilteredElements] Éléments dans le store:",e.elements.map(t=>({id:t.id,type_forme:t.type_forme,data:t.data?JSON.stringify(t.data):null})));const n=e.elements.filter(t=>{var f,d;if(console.log(`[DrawingStore][getFilteredElements] Vérification de l'élément ${t.id} (${t.type_forme})`),!(t.type_forme in e.filters.shapeTypes?e.filters.shapeTypes[t.type_forme]:!0))return console.log(`[DrawingStore][getFilteredElements] Élément ${t.id} filtré par type: ${t.type_forme} (non visible)`),!1;const i=((f=t.data)==null?void 0:f.category)||"default";if(!(i in e.filters.categories?e.filters.categories[i]:!0))return console.log(`[DrawingStore][getFilteredElements] Élément ${t.id} filtré par catégorie: ${i} (non visible)`),!1;const o=((d=t.data)==null?void 0:d.accessLevel)||"visitor";let u=!0;return o==="company"?u=e.filters.accessLevels.company:o==="employee"?u=e.filters.accessLevels.employee:o==="visitor"&&(u=e.filters.accessLevels.visitor),u?(console.log(`[DrawingStore][getFilteredElements] Élément ${t.id} visible: type=${t.type_forme}, catégorie=${i}, accès=${o}`),!0):(console.log(`[DrawingStore][getFilteredElements] Élément ${t.id} filtré par niveau d'accès: ${o} (non visible)`),!1)});return console.log("[DrawingStore][getFilteredElements] Résultat du filtrage:",{total:e.elements.length,filtered:n.length,filteredIds:n.map(t=>t.id)}),n}},actions:{setCurrentPlan(e){window.dispatchEvent(new CustomEvent("clearControlPoints")),this.currentMapId=e,e===null&&this.clearElements(),this.selectedElement=null,this.unsavedChanges=!1,this.currentTool="",this.lastUsedType=null,this.currentStyle={strokeStyle:"solid",strokeWidth:2,strokeColor:"#2563EB",fillColor:"#3B82F6",fillOpacity:.2},this.filters={accessLevels:{company:!0,employee:!0,visitor:!0},categories:{forages:!0,clients:!0,entrepots:!0,livraisons:!0,cultures:!0,parcelles:!0},shapeTypes:{Polygon:!0,Line:!0,ElevationLine:!0,Note:!0}}},clearCurrentPlan(){(this.currentMapId!==null||this.elements.length>0)&&(this.currentMapId=null,this.elements=[],this.selectedElement=null,this.unsavedChanges=!1,this.loading=!1,this.error=null)},clearElements(){this.elements=[],this.selectedElement=null,this.unsavedChanges=!1,this.error=null},addElement(e){var t;const n=this.performanceMonitor.startMeasure("addElement","DrawingStore");try{if(console.log("[DrawingStore] Ajout d'un élément",{element:e,isLeafletLayer:e instanceof qn.Layer,hasProperties:!!e.properties,properties:e.properties,type:(t=e.properties)==null?void 0:t.type}),e instanceof qn.Layer&&e.properties){const r=this.performanceMonitor.measure("addElement_convert",()=>_b(e),"DrawingStore");console.log("[DrawingStore] Élément converti avant ajout",{original:e,converted:r,type:r.type_forme,data:r.data}),this.elements.push(r)}else!e.type_forme&&this.lastUsedType&&(e.type_forme=this.lastUsedType),this.elements.push(e);this.unsavedChanges=!0}finally{n()}},updateElement(e){const n=this.elements.findIndex(t=>t.id===e.id);if(n!==-1){const t=this.elements[n].type_forme;this.elements[n]={...e,type_forme:t},this.unsavedChanges=!0}},removeElement(e){const n=this.elements.findIndex(t=>t.id===e);n!==-1&&(this.elements.splice(n,1),this.unsavedChanges=!0)},selectElement(e){this.selectedElement=e},setCurrentTool(e){this.currentTool=e,["CERCLE","RECTANGLE","DEMI_CERCLE","LIGNE","TEXTE"].includes(e)&&(this.lastUsedType=e)},setCurrentStyle(e){if(!e||Object.keys(e).length===0){this.currentStyle={strokeStyle:"solid",strokeWidth:2,strokeColor:"#2563EB",fillColor:"#3B82F6",fillOpacity:.2};return}this.currentStyle={...this.currentStyle,...e}},updateFilters(e){if(console.log("[DrawingStore][updateFilters] Mise à jour des filtres:",JSON.stringify(e,null,2)),console.log("[DrawingStore][updateFilters] Filtres avant mise à jour:",JSON.stringify(this.filters,null,2)),e.accessLevels){const n={...this.filters.accessLevels};this.filters.accessLevels={...this.filters.accessLevels,...e.accessLevels},console.log("[DrawingStore][updateFilters] Niveaux d'accès mis à jour:",{avant:n,après:this.filters.accessLevels})}if(e.categories){const n={...this.filters.categories};this.filters.categories={...this.filters.categories,...e.categories},console.log("[DrawingStore][updateFilters] Catégories mises à jour:",{avant:n,après:this.filters.categories});const t=Object.keys(e.categories).filter(r=>n[r]!==this.filters.categories[r]);if(t.length>0){console.log(`[DrawingStore][updateFilters] Catégories modifiées: ${t.join(", ")}`);const r=t.filter(i=>n[i]===!1&&this.filters.categories[i]===!0);r.length>0&&(console.log(`[DrawingStore][updateFilters] Catégories réactivées: ${r.join(", ")}`),window.dispatchEvent(new CustomEvent("categoriesReactivated",{detail:{categories:r}})))}}if(e.shapeTypes){const n={...this.filters.shapeTypes};this.filters.shapeTypes={...this.filters.shapeTypes,...e.shapeTypes},console.log("[DrawingStore][updateFilters] Types de formes mis à jour:",{avant:n,après:this.filters.shapeTypes});const t=Object.keys(e.shapeTypes).filter(r=>n[r]!==this.filters.shapeTypes[r]);if(t.length>0){console.log(`[DrawingStore][updateFilters] Types de formes modifiés: ${t.join(", ")}`);const r=t.filter(i=>n[i]===!1&&this.filters.shapeTypes[i]===!0);r.length>0&&(console.log(`[DrawingStore][updateFilters] Types de formes réactivés: ${r.join(", ")}`),window.dispatchEvent(new CustomEvent("shapeTypesReactivated",{detail:{shapeTypes:r}})))}}console.log("[DrawingStore][updateFilters] Filtres mis à jour:",JSON.stringify(this.filters,null,2)),console.log("[DrawingStore][updateFilters] Émission de l'event filtersChanged"),window.dispatchEvent(new CustomEvent("filtersChanged",{detail:{filters:this.filters}}))},async loadPlanElements(e){const n=this.performanceMonitor.startMeasure("loadPlanElements","DrawingStore");if(this.currentMapId===e&&this.elements.length>0)return console.log(`[DrawingStore] Plan ${e} déjà chargé avec ${this.elements.length} éléments`),n(),this.elements;this.loading=!0;try{console.log("[DrawingStore] Début du chargement du plan",{planId:e});const r=(await this.performanceMonitor.measureAsync("loadPlanElements_apiCall",()=>Gn.get(`/plans/${e}/`),"DrawingStore")).data;return console.log("[DrawingStore] Données du plan reçues",{formes:r.formes,preferences:r.preferences}),r.formes&&Array.isArray(r.formes)&&r.formes.forEach((i,s)=>{var o,u,f;console.log(`[DrawingStore] Analyse détaillée forme ${s}:`,{id:i.id,type_forme:i.type_forme,hasData:!!i.data,dataKeys:i.data?Object.keys(i.data):[],name:(o=i.data)==null?void 0:o.name,hasName:i.data&&"name"in i.data,centerType:(u=i.data)!=null&&u.center?typeof i.data.center:"undefined",center:(f=i.data)==null?void 0:f.center})}),this.elements=r.formes.map(i=>{var s;if(console.log("[DrawingStore] Traitement de la forme stockée",{id:i.id,type_forme:i.type_forme,data:i.data}),i.type_forme)return console.log("[DrawingStore] Forme déjà au format élément",{type_forme:i.type_forme,data:i.data,hasName:i.data&&"name"in i.data,name:(s=i.data)==null?void 0:s.name}),{id:i.id,type_forme:i.type_forme,data:i.data||{}};try{const o=EI(i);if(o)return console.log("[DrawingStore] Forme convertie avec succès",{originalType:i.type_forme,convertedType:o.type,properties:o.properties}),_b(o)}catch(o){console.error("[DrawingStore] Erreur lors de la conversion de la forme",{error:o,forme:i})}return console.warn("[DrawingStore] Utilisation de la forme sans conversion",{type_forme:i.type_forme,data:i.data}),i}),console.log(`[DrawingStore] Plan ${e} - Chargé ${this.elements.length} éléments`,{elements:this.elements.map(i=>({id:i.id,type_forme:i.type_forme}))}),this.currentMapId=e,this.unsavedChanges=!1,r.preferences&&(console.log("[DrawingStore] Chargement des préférences",r.preferences),r.preferences.currentTool&&this.setCurrentTool(r.preferences.currentTool),r.preferences.currentStyle&&(this.currentStyle={...this.currentStyle,...r.preferences.currentStyle}),r.preferences.lastUsedType&&(this.lastUsedType=r.preferences.lastUsedType)),this.elements}catch(t){throw console.error("[DrawingStore] Erreur lors du chargement des éléments:",t),this.error="Erreur lors du chargement des éléments du plan",t}finally{this.loading=!1,n()}},async saveToPlan(e,n){const t=this.performanceMonitor.startMeasure("saveToPlan","DrawingStore");this.loading=!0;try{const r=e||this.currentMapId;if(console.log("[DrawingStore][saveToPlan] Début de la sauvegarde",{targetPlanId:r,currentPlanId:this.currentMapId,elementsCount:this.elements.length,elementsToDelete:n==null?void 0:n.elementsToDelete}),!r)throw new Error("Aucun plan sélectionné pour la sauvegarde");const i=this.performanceMonitor.measure("saveToPlan_prepareElements",()=>this.elements.map(f=>({...f,type_forme:f.type_forme||this.lastUsedType})),"DrawingStore"),s=(n==null?void 0:n.elementsToDelete)||[],o=`/plans/${r}/save_with_elements/`,u=await this.performanceMonitor.measureAsync("saveToPlan_apiCall",()=>Gn.post(o,{formes:i,connexions:[],annotations:[],elementsToDelete:s,preferences:{currentTool:this.currentTool,currentStyle:this.currentStyle,lastUsedType:this.lastUsedType}}),"DrawingStore");return this.elements=this.performanceMonitor.measure("saveToPlan_processResponse",()=>{const f=new Set(s);return u.data.formes.filter(d=>!f.has(d.id)).map(d=>({...d,type_forme:d.type_forme}))},"DrawingStore"),console.log("[DrawingStore][saveToPlan] Éléments après filtrage:",{totalElements:this.elements.length,elementsToDelete:s}),this.unsavedChanges=!1,u.data}catch(r){throw console.error("[DrawingStore][saveToPlan] ERREUR:",r),console.error("[DrawingStore][saveToPlan] Stack trace:",r instanceof Error?r.stack:"No stack trace"),this.error="Erreur lors de la sauvegarde du plan",r}finally{this.loading=!1,t()}}}}),CI={class:"h-full flex flex-col bg-white"},PI={class:"border-b border-gray-200"},MI={class:"flex -mb-px"},AI={class:"flex-1 overflow-y-auto"},kI={key:0,class:"p-3"},TI={class:"grid grid-cols-4 gap-1.5 mb-4"},NI=["onClick","title"],DI=["innerHTML"],II={key:1,class:"my-4 border-t border-gray-200"},OI={key:2,class:"mt-4"},BI={key:0,class:"mb-4"},RI={class:"mb-4"},FI={class:"mb-4"},jI={class:"grid grid-cols-1 gap-4"},zI={key:0,class:"space-y-1"},$I={class:"flex justify-between items-center"},UI={class:"text-sm font-medium text-gray-500"},VI={class:"flex justify-between items-center"},GI={class:"text-sm font-medium text-gray-500"},HI={class:"text-sm font-medium text-gray-500"},qI={class:"flex flex-col space-y-2 w-full"},WI={class:"flex justify-between items-center"},ZI={class:"text-sm font-medium text-gray-500 ml-2"},KI={class:"flex justify-between items-center"},YI={class:"text-sm font-medium text-gray-500 ml-2"},JI={class:"flex justify-between items-center"},XI={class:"text-sm font-medium text-gray-500 ml-2"},QI={class:"flex justify-between items-center"},eO={class:"text-sm font-medium text-gray-500 ml-2"},tO={class:"flex justify-between items-center"},nO={class:"text-sm font-medium text-gray-500 ml-2"},rO={ref:"elevationProfileContainer",class:"elevation-profile-container w-full h-48 bg-gray-50 rounded border border-gray-200 relative mt-4"},iO={ref:"elevationCanvas"},oO={key:1,class:"p-3"},sO={class:"grid grid-cols-6 gap-2 mb-4"},aO=["onClick","title"],lO={key:0,class:"space-y-4"},uO={class:"flex items-center gap-4"},cO={class:"flex items-center gap-2"},fO={class:"flex items-center gap-4"},hO=["value"],dO={key:0,class:"flex items-center gap-4"},pO={class:"flex items-center gap-2"},gO={key:1,class:"space-y-4"},mO={class:"flex items-center gap-4"},vO={class:"flex items-center gap-2"},yO={class:"flex items-center gap-4"},_O={class:"flex items-center gap-2"},bO={key:2,class:"p-3 space-y-4"},wO={class:"space-y-2"},xO={class:"space-y-2"},LO={class:"space-y-1"},SO={class:"flex items-center"},EO={class:"flex items-center"},CO={class:"flex items-center"},PO={class:"flex items-center"},MO={class:"flex items-center"},AO={class:"flex items-center"},kO={class:"space-y-2"},TO={class:"space-y-1"},NO={class:"flex items-center"},DO={class:"flex items-center"},IO={class:"flex items-center"},OO={class:"flex items-center"},BO={key:0,class:"p-3 border-t border-gray-200"},RO={class:"mt-3"},FO={class:"mb-4"},jO={class:"grid grid-cols-2 gap-2"},zO={class:"grid grid-cols-2 gap-2"},$O=ds({__name:"DrawingTools",props:{currentTool:{type:String,default:""},selectedShape:{type:Object,default:null},allLayers:{type:Array,default:()=>[]}},emits:["tool-change","style-update","properties-update","delete-shape","filter-change","close-drawer"],setup(e,{emit:n}){const t=e,r=cd(),i=[{type:"Polygon",label:"Polygone"},{type:"Line",label:"Ligne"},{type:"ElevationLine",label:"Profil altimétrique"},{type:"Note",label:"Note géolocalisée"}],s=Z=>{switch(Z){case"Polygon":return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5l16 0l0 14l-16 0l0 -14z"/></svg>';case"Line":return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 20l16 -16"/></svg>';case"ElevationLine":return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 20h18l-3-3l-4 4l-4-7l-4 4l-3-3"/></svg>';case"Note":return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 2l4 4m-6 0l2-2 4 4-2 2-4-4z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h8" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 14h4" /></svg>';default:return""}},o=zt("tools");oo(o,(Z,N)=>{console.log("[DrawingTools][watch activeTab] Changement d'onglet:",{newTab:Z,oldTab:N}),Z==="filters"&&N!=="filters"&&(console.log("[DrawingTools][watch activeTab] Passage à l'onglet filtres"),console.log("[DrawingTools][watch activeTab] État actuel des filtres dans le store:",JSON.stringify({accessLevels:{...r.filters.accessLevels},categories:{...r.filters.categories},shapeTypes:{...r.filters.shapeTypes}},null,2)),console.log("[DrawingTools][watch activeTab] État actuel des filtres locaux:",JSON.stringify({accessLevels:{...fe.accessLevels},categories:{...fe.categories},shapeTypes:{...fe.shapeTypes}},null,2)),t.selectedShape&&(console.log("[DrawingTools][watch activeTab] Désélection de la forme actuelle lors du passage à l'onglet filtres"),le("tool-change","")),setTimeout(()=>{Ce()},0)),N==="filters"&&Z!=="filters"&&(console.log("[DrawingTools][watch activeTab] Sortie de l'onglet filtres, application des changements"),console.log("[DrawingTools][watch activeTab] État des filtres locaux avant application:",JSON.stringify({accessLevels:{...fe.accessLevels},categories:{...fe.categories},shapeTypes:{...fe.shapeTypes}},null,2)),Ce())});const u=zt({samplePoints:!0,circleSections:!0}),f=zt("#2b6451"),d=zt(2),m=zt("solid"),_=zt("#2b6451"),w=zt(.2),y=zt(!0),M=zt(""),k=zt("default"),F=zt("visitor"),I=zt({radius:4,color:"#2b6451",fillOpacity:.6,weight:2}),R=zt({radius:6,color:"#EF4444",fillOpacity:.8,weight:2}),K=["#2b6451","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899"],ee=[{value:"solid",label:"Continu"},{value:"dashed",label:"Tirets"},{value:"dotted",label:"Pointillés"}],he=zt("company"),fe=Yl({accessLevels:{company:!0,employee:!1,visitor:!1},categories:{forages:!0,clients:!0,entrepots:!0,livraisons:!0,cultures:!0,parcelles:!0},shapeTypes:{Polygon:!0,Line:!0,ElevationLine:!0,Note:!0}}),ve=Z=>{console.log(`[DrawingTools][updateAccessLevelFilter] Changement du niveau d'accès: ${Z}`),he.value=Z,Z==="company"?(fe.accessLevels.company=!0,fe.accessLevels.employee=!1,fe.accessLevels.visitor=!1):Z==="employee"?(fe.accessLevels.company=!1,fe.accessLevels.employee=!0,fe.accessLevels.visitor=!1):Z==="visitor"&&(fe.accessLevels.company=!1,fe.accessLevels.employee=!1,fe.accessLevels.visitor=!0),Ce()},z=Z=>{console.log(`[DrawingTools][updateAccessLevelFilterAndDeselect] Changement du niveau d'accès: ${Z}`),t.selectedShape&&(console.log("[DrawingTools][updateAccessLevelFilterAndDeselect] Désélection de la forme actuelle"),le("tool-change","")),ve(Z)};console.log("[DrawingTools] Initialisation des filtres:",JSON.stringify({local:{accessLevels:{...fe.accessLevels},categories:{...fe.categories},shapeTypes:{...fe.shapeTypes}},store:{accessLevels:{...r.filters.accessLevels},categories:{...r.filters.categories},shapeTypes:{...r.filters.shapeTypes}}},null,2));const U=sr(()=>t.selectedShape&&t.selectedShape.properties||null),J=Z=>{u.value[Z]=!u.value[Z]},T=Z=>{f.value=Z,_.value=Z,D({strokeColor:Z,fillColor:Z})},D=Z=>{t.selectedShape&&le("style-update",Z)},B=()=>{t.selectedShape&&le("properties-update",{name:M.value})},$=()=>{t.selectedShape&&le("properties-update",{category:k.value})},W=()=>{t.selectedShape&&le("properties-update",{accessLevel:F.value})},G=()=>{var Z;!t.selectedShape||((Z=U.value)==null?void 0:Z.type)!=="ElevationLine"||le("style-update",{samplePointStyle:I.value})},oe=()=>{var Z;!t.selectedShape||((Z=U.value)==null?void 0:Z.type)!=="ElevationLine"||le("style-update",{minMaxPointStyle:R.value})},ie=()=>{console.log("[DrawingTools][resetFilters] Début de la réinitialisation des filtres"),console.log("[DrawingTools][resetFilters] État actuel des filtres:",JSON.stringify({accessLevels:{...fe.accessLevels},categories:{...fe.categories},shapeTypes:{...fe.shapeTypes}},null,2));const Z={accessLevels:{company:!0,employee:!0,visitor:!0},categories:{forages:!0,clients:!0,entrepots:!0,livraisons:!0,cultures:!0,parcelles:!0},shapeTypes:{Polygon:!0,Line:!0,ElevationLine:!0,Note:!0}};console.log("[DrawingTools][resetFilters] Nouveaux filtres à appliquer:",JSON.stringify(Z,null,2)),console.log("[DrawingTools][resetFilters] Mise à jour des filtres locaux"),fe.accessLevels.company=!0,fe.accessLevels.employee=!0,fe.accessLevels.visitor=!0,fe.categories.forages=!0,fe.categories.clients=!0,fe.categories.entrepots=!0,fe.categories.livraisons=!0,fe.categories.cultures=!0,fe.categories.parcelles=!0,fe.shapeTypes.Polygon=!0,fe.shapeTypes.Line=!0,fe.shapeTypes.ElevationLine=!0,fe.shapeTypes.Note=!0,console.log("[DrawingTools][resetFilters] Filtres locaux après mise à jour:",JSON.stringify({accessLevels:{...fe.accessLevels},categories:{...fe.categories},shapeTypes:{...fe.shapeTypes}},null,2)),console.log("[DrawingTools][resetFilters] Mise à jour des filtres dans le store"),r.updateFilters(Z),console.log("[DrawingTools][resetFilters] Émission de l'event filter-change"),le("filter-change",Z),console.log("[DrawingTools][resetFilters] Mise à jour forcée de l'affichage"),console.log("[DrawingTools][resetFilters] Filtres réinitialisés avec succès")},we=()=>{console.log("[DrawingTools][resetFiltersAndDeselect] Début de la réinitialisation des filtres avec désélection"),Q(),ie(),console.log("[DrawingTools][resetFiltersAndDeselect] Filtres réinitialisés et forme désélectionnée avec succès")},Ce=()=>{const Z={...fe.accessLevels},N={...fe.categories},ke={...fe.shapeTypes};console.log("[DrawingTools][applyFilters] Application des filtres:",JSON.stringify({accessLevels:Z,categories:N,shapeTypes:ke},null,2));const Me={accessLevels:Z,categories:N,shapeTypes:ke};console.log("[DrawingTools][applyFilters] Envoi des filtres au store:",JSON.stringify(Me,null,2)),r.updateFilters(Me),console.log("[DrawingTools][applyFilters] Émission de l'event filter-change"),le("filter-change",Me),setTimeout(()=>{console.log("[DrawingTools][applyFilters] Mise à jour forcée de l'affichage"),window.dispatchEvent(new CustomEvent("filtersChanged",{detail:{filters:Me}}))},0),console.log("[DrawingTools][applyFilters] Filtres appliqués avec succès")},Te=Z=>`${Math.round(Z)} m`,Y=Z=>Z>=1e4?`${(Z/1e4).toFixed(2)} ha`:`${Math.round(Z)} m²`,H=Z=>`${Z.toFixed(1)}%`,Q=()=>{t.selectedShape&&(console.log("[DrawingTools][deselectCurrentShape] Désélection de la forme actuelle"),le("tool-change",""))},ue=()=>{Q(),o.value="filters"},le=n;wp(()=>{var Z,N,ke,Me,Ue,ce,ne;if(t.selectedShape){console.log("[DrawingTools][watchEffect] Mise à jour des propriétés pour la forme sélectionnée:",{type:t.selectedShape.type,properties:t.selectedShape.properties,options:t.selectedShape.options,layer:(Z=t.selectedShape.layer)==null?void 0:Z._leaflet_id});const ye=t.selectedShape.options||{};f.value=ye.color||"#2b6451",d.value=ye.weight||3,m.value=ye.dashArray?"dashed":"solid",_.value=ye.fillColor||"#2b6451",w.value=ye.fillOpacity||.2;const de=t.selectedShape.type||((N=t.selectedShape.properties)==null?void 0:N.type)||"";y.value=de!=="Line",console.log("[DrawingTools][watchEffect] Type de forme détecté:",de),M.value=((ke=t.selectedShape.properties)==null?void 0:ke.name)||"",k.value=((Me=t.selectedShape.properties)==null?void 0:Me.category)||"forages",F.value=((Ue=t.selectedShape.properties)==null?void 0:Ue.accessLevel)||"visitor",de==="ElevationLine"&&((ce=t.selectedShape.properties)!=null&&ce.samplePointStyle&&(I.value={...t.selectedShape.properties.samplePointStyle}),(ne=t.selectedShape.properties)!=null&&ne.minMaxPointStyle&&(R.value={...t.selectedShape.properties.minMaxPointStyle})),console.log("[DrawingTools][watchEffect] Propriétés mises à jour avec succès")}}),Cs(()=>{console.log("[DrawingTools][onMounted] Initialisation des filtres depuis le store");const Z=r.filters;console.log("[DrawingTools][onMounted] Filtres du store:",JSON.stringify({accessLevels:{...Z.accessLevels},categories:{...Z.categories},shapeTypes:{...Z.shapeTypes}},null,2)),fe.accessLevels.company=Z.accessLevels.company,fe.accessLevels.employee=Z.accessLevels.employee,fe.accessLevels.visitor=Z.accessLevels.visitor,fe.categories.forages=Z.categories.forages,fe.categories.clients=Z.categories.clients,fe.categories.entrepots=Z.categories.entrepots,fe.categories.livraisons=Z.categories.livraisons,fe.categories.cultures=Z.categories.cultures,fe.categories.parcelles=Z.categories.parcelles,fe.shapeTypes.Polygon=Z.shapeTypes.Polygon,fe.shapeTypes.Line=Z.shapeTypes.Line,fe.shapeTypes.ElevationLine=Z.shapeTypes.ElevationLine,fe.shapeTypes.Note=Z.shapeTypes.Note,console.log("[DrawingTools][onMounted] Filtres locaux après initialisation:",JSON.stringify({accessLevels:{...fe.accessLevels},categories:{...fe.categories},shapeTypes:{...fe.shapeTypes}},null,2))}),oo(fe,(Z,N)=>{console.log("[DrawingTools][watch filters] Changement détecté:",{activeTab:o.value,newFilters:JSON.stringify({accessLevels:Z.accessLevels,categories:Z.categories,shapeTypes:Z.shapeTypes}),oldFilters:JSON.stringify({accessLevels:N.accessLevels,categories:N.categories,shapeTypes:N.shapeTypes})});const ke=Object.keys(Z.accessLevels).filter(ne=>N.accessLevels[ne]!==Z.accessLevels[ne]),Me=Object.keys(Z.categories).filter(ne=>N.categories[ne]!==Z.categories[ne]),Ue=Object.keys(Z.shapeTypes).filter(ne=>N.shapeTypes[ne]!==Z.shapeTypes[ne]),ce=ke.length>0||Me.length>0||Ue.length>0;console.log("[DrawingTools][watch filters] Différences détectées:",{accessLevelsDiff:ke,categoriesDiff:Me,shapeTypesDiff:Ue,hasChanges:ce}),o.value==="filters"?(console.log("[DrawingTools][watch filters] Onglet filtres actif, application des filtres"),Ce()):console.log("[DrawingTools][watch filters] Onglet filtres non actif, pas d'application automatique")},{deep:!0});const pe=Z=>{le("tool-change",t.currentTool===Z?"":Z),window.innerWidth<768&&le("close-drawer")};return(Z,N)=>{var ke,Me,Ue,ce;return $e(),qe("div",CI,[N[94]||(N[94]=C("div",{class:"p-3 bg-gray-50 border-b border-gray-200 flex justify-between items-center md:flex hidden"},[C("h3",{class:"text-sm font-semibold text-gray-700"},"Outils de dessin")],-1)),C("div",PI,[C("nav",MI,[C("button",{onClick:N[0]||(N[0]=ne=>o.value="tools"),class:Vi([o.value==="tools"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","flex-1 py-3 px-1 text-center border-b-2 font-medium text-sm"])},N[44]||(N[44]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mx-auto mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1),C("span",null,"Outils",-1)]),2),e.selectedShape&&((ke=e.selectedShape.properties)==null?void 0:ke.type)!=="Note"?($e(),qe("button",{key:0,onClick:N[1]||(N[1]=ne=>o.value="style"),class:Vi([o.value==="style"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","flex-1 py-3 px-1 text-center border-b-2 font-medium text-sm"])},N[45]||(N[45]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mx-auto mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})],-1),C("span",null,"Style",-1)]),2)):pn("",!0),C("button",{onClick:ue,class:Vi([o.value==="filters"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","flex-1 py-3 px-1 text-center border-b-2 font-medium text-sm"])},N[46]||(N[46]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mx-auto mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})],-1),C("span",null,"Filtres",-1)]),2)])]),C("div",AI,[o.value==="tools"?($e(),qe("div",kI,[C("div",TI,[($e(!0),qe(Tn,null,Lr(i.filter(ne=>ne.type!=="delete"),ne=>($e(),qe("button",{key:ne.type,class:Vi(["flex items-center justify-center p-2 rounded-md border",{"bg-blue-50 border-blue-300 text-blue-700 shadow-sm":e.currentTool===ne.type}]),onClick:ye=>pe(ne.type),title:ne.label},[C("span",{class:"icon",innerHTML:s(ne.type)},null,8,DI)],10,NI))),128))]),e.selectedShape?($e(),qe("button",{key:0,class:Vi(["w-full mt-2 p-2 rounded-md border border-red-200 bg-red-50 text-red-600 hover:bg-red-100 flex items-center justify-center",{"bg-red-100":e.currentTool==="delete"}]),onClick:N[2]||(N[2]=ne=>Z.$emit("delete-shape")),title:"Supprimer la forme"},N[47]||(N[47]=[C("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),C("span",{class:"text-sm"},"Supprimer",-1)]),2)):pn("",!0),e.selectedShape&&U.value?($e(),qe("div",II)):pn("",!0),e.selectedShape&&U.value?($e(),qe("div",OI,[U.value.type!=="Note"?($e(),qe("div",BI,[N[48]||(N[48]=C("label",{for:"shapeName",class:"block text-sm font-medium text-gray-700 mb-1"},"Nom de la forme",-1)),Fn(C("input",{type:"text",id:"shapeName","onUpdate:modelValue":N[3]||(N[3]=ne=>M.value=ne),onChange:B,placeholder:"Donnez un nom à cette forme",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"},null,544),[[ni,M.value]])])):pn("",!0),C("div",RI,[N[50]||(N[50]=C("label",{for:"shapeCategory",class:"block text-sm font-medium text-gray-700 mb-1"},"Catégorie",-1)),Fn(C("select",{id:"shapeCategory","onUpdate:modelValue":N[4]||(N[4]=ne=>k.value=ne),onChange:$,class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"},N[49]||(N[49]=[$u('<option value="forages" data-v-cb7f32f1>Forages</option><option value="clients" data-v-cb7f32f1>Clients</option><option value="entrepots" data-v-cb7f32f1>Entrepôts</option><option value="livraisons" data-v-cb7f32f1>Lieux de livraison</option><option value="cultures" data-v-cb7f32f1>Cultures</option><option value="parcelles" data-v-cb7f32f1>Noms des parcelles</option><option value="default" data-v-cb7f32f1>Autre</option>',7)]),544),[[vo,k.value]])]),C("div",FI,[N[52]||(N[52]=C("label",{for:"accessLevel",class:"block text-sm font-medium text-gray-700 mb-1"},"Niveau d'accès",-1)),N[53]||(N[53]=C("div",{class:"p-2 bg-blue-50 rounded mb-2 text-xs text-blue-700"}," Définit qui peut voir cet élément sur la carte. ",-1)),Fn(C("select",{id:"accessLevel","onUpdate:modelValue":N[5]||(N[5]=ne=>F.value=ne),onChange:W,class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"},N[51]||(N[51]=[C("option",{value:"company"},"Entreprise uniquement",-1),C("option",{value:"employee"},"Entreprise et salariés",-1),C("option",{value:"visitor"},"Tous (visiteurs inclus)",-1)]),544),[[vo,F.value]])]),C("div",jI,[U.value.type==="Polygon"?($e(),qe("div",zI,[C("div",$I,[N[54]||(N[54]=C("span",{class:"text-sm font-semibold text-gray-700"},"Surface :",-1)),C("span",UI,Zt(Y(U.value.surface||0)),1)]),C("div",VI,[N[55]||(N[55]=C("span",{class:"text-sm font-semibold text-gray-700"},"Périmètre :",-1)),C("span",GI,Zt(Te(U.value.perimeter||0)),1)])])):U.value.type==="Line"?($e(),qe(Tn,{key:1},[N[56]||(N[56]=C("span",{class:"text-sm font-semibold text-gray-700"},"Longueur :",-1)),C("span",HI,Zt(Te(U.value.length||0)),1)],64)):U.value.type==="ElevationLine"?($e(),qe(Tn,{key:2},[C("div",qI,[C("div",WI,[N[57]||(N[57]=C("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Distance totale :",-1)),C("span",ZI,Zt(Te(U.value.length||0)),1)]),C("div",KI,[N[58]||(N[58]=C("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Dénivelé + :",-1)),C("span",YI,Zt(Te(U.value.elevationGain||0)),1)]),C("div",JI,[N[59]||(N[59]=C("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Dénivelé - :",-1)),C("span",XI,Zt(Te(U.value.elevationLoss||0)),1)]),C("div",QI,[N[60]||(N[60]=C("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Pente moy. :",-1)),C("span",eO,Zt(H(U.value.averageSlope||0)),1)]),C("div",tO,[N[61]||(N[61]=C("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Pente max :",-1)),C("span",nO,Zt(H(U.value.maxSlope||0)),1)])]),C("div",rO,[C("canvas",iO,null,512)],512)],64)):pn("",!0)])])):pn("",!0)])):pn("",!0),o.value==="style"&&e.selectedShape&&((Me=e.selectedShape.properties)==null?void 0:Me.type)!=="Note"?($e(),qe("div",oO,[C("div",sO,[($e(),qe(Tn,null,Lr(K,ne=>C("button",{key:ne,class:"w-8 h-8 rounded-full",style:ql({backgroundColor:ne}),onClick:ye=>T(ne),title:ne},null,12,aO)),64))]),((Ue=U.value)==null?void 0:Ue.type)!=="TextRectangle"?($e(),qe("div",lO,[C("div",uO,[N[62]||(N[62]=C("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Contour",-1)),C("div",cO,[Fn(C("input",{type:"color","onUpdate:modelValue":N[6]||(N[6]=ne=>f.value=ne),class:"w-16 h-8 rounded border",onChange:N[7]||(N[7]=ne=>D({strokeColor:f.value})),title:"Couleur du contour"},null,544),[[ni,f.value]]),Fn(C("input",{type:"range","onUpdate:modelValue":N[8]||(N[8]=ne=>d.value=ne),min:"1",max:"10",class:"w-16 h-2 rounded-md",onChange:N[9]||(N[9]=ne=>D({strokeWidth:d.value})),title:"Épaisseur du contour"},null,544),[[ni,d.value]])])]),C("div",fO,[N[63]||(N[63]=C("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Style",-1)),Fn(C("select",{"onUpdate:modelValue":N[10]||(N[10]=ne=>m.value=ne),class:"w-full rounded border",onChange:N[11]||(N[11]=ne=>D({strokeStyle:m.value}))},[($e(),qe(Tn,null,Lr(ee,ne=>C("option",{key:ne.value,value:ne.value},Zt(ne.label),9,hO)),64))],544),[[vo,m.value]])]),y.value?($e(),qe("div",dO,[N[64]||(N[64]=C("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Remplir",-1)),C("div",pO,[Fn(C("input",{type:"color","onUpdate:modelValue":N[12]||(N[12]=ne=>_.value=ne),class:"w-16 h-8 rounded border",onChange:N[13]||(N[13]=ne=>D({fillColor:_.value})),title:"Couleur de remplissage"},null,544),[[ni,_.value]]),Fn(C("input",{type:"range","onUpdate:modelValue":N[14]||(N[14]=ne=>w.value=ne),min:"0",max:"1",step:"0.1",class:"w-16 h-2 rounded-md",onChange:N[15]||(N[15]=ne=>D({fillOpacity:w.value})),title:"Opacité du remplissage"},null,544),[[ni,w.value]])])])):pn("",!0)])):pn("",!0),((ce=U.value)==null?void 0:ce.type)==="TextRectangle"?($e(),qe("div",gO,[C("div",mO,[N[65]||(N[65]=C("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Contour",-1)),C("div",vO,[Fn(C("input",{type:"color","onUpdate:modelValue":N[16]||(N[16]=ne=>f.value=ne),class:"w-16 h-8 rounded border",onChange:N[17]||(N[17]=ne=>D({strokeColor:f.value})),title:"Couleur du contour"},null,544),[[ni,f.value]]),Fn(C("input",{type:"range","onUpdate:modelValue":N[18]||(N[18]=ne=>d.value=ne),min:"1",max:"10",class:"w-16 h-2 rounded-md",onChange:N[19]||(N[19]=ne=>D({strokeWidth:d.value})),title:"Épaisseur du contour"},null,544),[[ni,d.value]])])]),C("div",yO,[N[66]||(N[66]=C("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Remplir",-1)),C("div",_O,[Fn(C("input",{type:"color","onUpdate:modelValue":N[20]||(N[20]=ne=>_.value=ne),class:"w-16 h-8 rounded border",onChange:N[21]||(N[21]=ne=>D({fillColor:_.value})),title:"Couleur de remplissage"},null,544),[[ni,_.value]]),Fn(C("input",{type:"range","onUpdate:modelValue":N[22]||(N[22]=ne=>w.value=ne),min:"0",max:"1",step:"0.1",class:"w-16 h-2 rounded-md",onChange:N[23]||(N[23]=ne=>D({fillOpacity:w.value})),title:"Opacité du remplissage"},null,544),[[ni,w.value]])])])])):pn("",!0)])):pn("",!0),o.value==="filters"?($e(),qe("div",bO,[C("div",wO,[N[69]||(N[69]=C("h4",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wider"},"Niveau d'accès",-1)),N[70]||(N[70]=C("div",{class:"p-2 bg-blue-50 rounded mb-2 text-xs text-blue-700"}," Sélectionnez votre niveau d'accès pour filtrer les éléments visibles sur la carte. ",-1)),C("div",null,[Fn(C("select",{"onUpdate:modelValue":N[24]||(N[24]=ne=>he.value=ne),onChange:N[25]||(N[25]=ne=>z(he.value)),class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 text-sm"},N[67]||(N[67]=[C("option",{value:"company"},"Entreprise (accès à tout)",-1),C("option",{value:"employee"},"Salariés (accès niveau salariés et visiteurs)",-1),C("option",{value:"visitor"},"Visiteurs (accès niveau visiteurs uniquement)",-1)]),544),[[vo,he.value]]),N[68]||(N[68]=C("div",{class:"mt-2 text-xs text-gray-500"},[C("p",null,[C("strong",null,"Entreprise"),Li(" : Vous verrez tous les éléments (entreprise, salariés, visiteurs)")]),C("p",null,[C("strong",null,"Salariés"),Li(" : Vous verrez les éléments pour salariés et visiteurs")]),C("p",null,[C("strong",null,"Visiteurs"),Li(" : Vous ne verrez que les éléments pour visiteurs")])],-1))])]),C("div",xO,[N[77]||(N[77]=C("h4",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wider"},"Éléments",-1)),C("div",LO,[C("label",SO,[Fn(C("input",{type:"checkbox","onUpdate:modelValue":N[26]||(N[26]=ne=>fe.categories.forages=ne),onChange:Q,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[wl,fe.categories.forages]]),N[71]||(N[71]=C("span",{class:"ml-2 text-sm text-gray-700"},"Forages",-1))]),C("label",EO,[Fn(C("input",{type:"checkbox","onUpdate:modelValue":N[27]||(N[27]=ne=>fe.categories.clients=ne),onChange:Q,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[wl,fe.categories.clients]]),N[72]||(N[72]=C("span",{class:"ml-2 text-sm text-gray-700"},"Clients",-1))]),C("label",CO,[Fn(C("input",{type:"checkbox","onUpdate:modelValue":N[28]||(N[28]=ne=>fe.categories.entrepots=ne),onChange:Q,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[wl,fe.categories.entrepots]]),N[73]||(N[73]=C("span",{class:"ml-2 text-sm text-gray-700"},"Entrepôts",-1))]),C("label",PO,[Fn(C("input",{type:"checkbox","onUpdate:modelValue":N[29]||(N[29]=ne=>fe.categories.livraisons=ne),onChange:Q,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[wl,fe.categories.livraisons]]),N[74]||(N[74]=C("span",{class:"ml-2 text-sm text-gray-700"},"Lieux de livraison",-1))]),C("label",MO,[Fn(C("input",{type:"checkbox","onUpdate:modelValue":N[30]||(N[30]=ne=>fe.categories.cultures=ne),onChange:Q,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[wl,fe.categories.cultures]]),N[75]||(N[75]=C("span",{class:"ml-2 text-sm text-gray-700"},"Cultures",-1))]),C("label",AO,[Fn(C("input",{type:"checkbox","onUpdate:modelValue":N[31]||(N[31]=ne=>fe.categories.parcelles=ne),onChange:Q,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[wl,fe.categories.parcelles]]),N[76]||(N[76]=C("span",{class:"ml-2 text-sm text-gray-700"},"Noms des parcelles",-1))])])]),C("div",kO,[N[82]||(N[82]=C("h4",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wider"},"Types de formes",-1)),C("div",TO,[C("label",NO,[Fn(C("input",{type:"checkbox","onUpdate:modelValue":N[32]||(N[32]=ne=>fe.shapeTypes.Polygon=ne),onChange:Q,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[wl,fe.shapeTypes.Polygon]]),N[78]||(N[78]=C("span",{class:"ml-2 text-sm text-gray-700"},"Polygones",-1))]),C("label",DO,[Fn(C("input",{type:"checkbox","onUpdate:modelValue":N[33]||(N[33]=ne=>fe.shapeTypes.Line=ne),onChange:Q,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[wl,fe.shapeTypes.Line]]),N[79]||(N[79]=C("span",{class:"ml-2 text-sm text-gray-700"},"Lignes",-1))]),C("label",IO,[Fn(C("input",{type:"checkbox","onUpdate:modelValue":N[34]||(N[34]=ne=>fe.shapeTypes.ElevationLine=ne),onChange:Q,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[wl,fe.shapeTypes.ElevationLine]]),N[80]||(N[80]=C("span",{class:"ml-2 text-sm text-gray-700"},"Profils altimétriques",-1))]),C("label",OO,[Fn(C("input",{type:"checkbox","onUpdate:modelValue":N[35]||(N[35]=ne=>fe.shapeTypes.Note=ne),onChange:Q,class:"rounded text-primary-600 focus:ring-primary-500 h-4 w-4"},null,544),[[wl,fe.shapeTypes.Note]]),N[81]||(N[81]=C("span",{class:"ml-2 text-sm text-gray-700"},"Notes",-1))])])]),C("div",{class:"pt-2"},[C("button",{onClick:we,class:"w-full px-3 py-2 bg-gray-100 text-gray-700 text-sm rounded hover:bg-gray-200 transition-colors"}," Réinitialiser ")])])):pn("",!0)]),e.selectedShape&&U.value&&U.value.type==="ElevationLine"?($e(),qe("div",BO,[C("button",{class:"flex items-center justify-between w-full text-sm font-semibold text-gray-700",onClick:N[36]||(N[36]=ne=>J("samplePoints"))},[N[84]||(N[84]=C("span",null,"Points d'échantillonnage",-1)),($e(),qe("svg",{class:Vi(["w-4 h-4",{"rotate-180":!u.value.samplePoints}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},N[83]||(N[83]=[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),Fn(C("div",RO,[C("div",FO,[N[89]||(N[89]=C("h4",{class:"text-sm font-semibold mb-2"},"Points normaux",-1)),C("div",jO,[C("div",null,[N[85]||(N[85]=C("label",{class:"text-xs text-gray-600"},"Taille",-1)),Fn(C("input",{type:"number","onUpdate:modelValue":N[37]||(N[37]=ne=>I.value.radius=ne),min:"2",max:"10",step:"1",class:"w-full px-2 py-1 border rounded",onChange:G},null,544),[[ni,I.value.radius]])]),C("div",null,[N[86]||(N[86]=C("label",{class:"text-xs text-gray-600"},"Couleur",-1)),Fn(C("input",{type:"color","onUpdate:modelValue":N[38]||(N[38]=ne=>I.value.color=ne),class:"w-full h-8 px-1 border rounded",onChange:G},null,544),[[ni,I.value.color]])]),C("div",null,[N[87]||(N[87]=C("label",{class:"text-xs text-gray-600"},"Opacité",-1)),Fn(C("input",{type:"range","onUpdate:modelValue":N[39]||(N[39]=ne=>I.value.fillOpacity=ne),min:"0",max:"1",step:"0.1",class:"w-full",onChange:G},null,544),[[ni,I.value.fillOpacity]])]),C("div",null,[N[88]||(N[88]=C("label",{class:"text-xs text-gray-600"},"Bordure",-1)),Fn(C("input",{type:"number","onUpdate:modelValue":N[40]||(N[40]=ne=>I.value.weight=ne),min:"1",max:"5",step:"1",class:"w-full px-2 py-1 border rounded",onChange:G},null,544),[[ni,I.value.weight]])])])]),C("div",null,[N[93]||(N[93]=C("h4",{class:"text-sm font-semibold mb-2"},"Points min/max",-1)),C("div",zO,[C("div",null,[N[90]||(N[90]=C("label",{class:"text-xs text-gray-600"},"Taille",-1)),Fn(C("input",{type:"number","onUpdate:modelValue":N[41]||(N[41]=ne=>R.value.radius=ne),min:"4",max:"12",step:"1",class:"w-full px-2 py-1 border rounded",onChange:oe},null,544),[[ni,R.value.radius]])]),C("div",null,[N[91]||(N[91]=C("label",{class:"text-xs text-gray-600"},"Bordure",-1)),Fn(C("input",{type:"number","onUpdate:modelValue":N[42]||(N[42]=ne=>R.value.weight=ne),min:"1",max:"5",step:"1",class:"w-full px-2 py-1 border rounded",onChange:oe},null,544),[[ni,R.value.weight]])]),C("div",null,[N[92]||(N[92]=C("label",{class:"text-xs text-gray-600"},"Opacité",-1)),Fn(C("input",{type:"range","onUpdate:modelValue":N[43]||(N[43]=ne=>R.value.fillOpacity=ne),min:"0",max:"1",step:"0.1",class:"w-full",onChange:oe},null,544),[[ni,R.value.fillOpacity]])])])])],512),[[Hm,!u.value.samplePoints]])])):pn("",!0)])}}}),UO=vd($O,[["__scopeId","data-v-cb7f32f1"]]),VO={class:"map-toolbar w-full"},GO={class:"hidden md:flex items-center space-x-2"},HO={class:"dropdown"},qO={class:"dropdown-menu"},WO=["onClick"],ZO={key:0,class:"border-l pl-2 flex-1"},KO={class:"flex items-center"},YO={class:"plan-info"},JO={class:"plan-name"},XO={key:0,class:"plan-description"},QO={class:"border-l pl-2 ml-auto"},eB={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},tB={key:1,class:"h-4 w-4 mr-2 text-primary-600",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},nB={key:"saving"},rB={key:"success",class:"save-success-text"},iB={key:"default"},oB={class:"md:hidden"},sB={class:"flex justify-between items-center"},aB={key:0,class:"truncate mx-2 text-sm font-medium"},lB={key:0,class:"mobile-menu mt-0 bg-white shadow-lg p-4 z-[1900] fixed left-0 right-0 w-full"},uB={class:"flex justify-between items-center mb-3 border-b pb-2"},cB={class:"flex flex-col space-y-4"},fB={key:0,class:"flex flex-col pb-3 border-b"},hB={class:"text-sm font-semibold text-gray-800"},dB={key:0,class:"text-xs text-gray-600 mt-1"},pB={class:"flex flex-col"},gB={class:"grid grid-cols-3 gap-2"},mB=["onClick"],vB={key:0,class:"animate-spin h-4 w-4 mr-2 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},yB={key:1,class:"h-4 w-4 mr-2 text-primary-600",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},_B={key:"saving"},bB={key:"success",class:"save-success-text"},wB={key:"default"},xB=ds({__name:"MapToolbar",props:{lastSave:{},planName:{},planDescription:{},saveStatus:{}},emits:["change-map-type","create-new-plan","load-plan","save-plan","adjust-view","generate-summary"],setup(e,{emit:n}){const t=n,r=e,i=zt("Hybride"),s=zt(!1),o=F=>{const I=F.currentTarget,R=I.nextElementSibling;if(R&&R.classList.contains("dropdown-menu")){const K=I.getBoundingClientRect();R.style.top=`${K.bottom}px`,R.style.left=`${K.left}px`}},u={Hybride:"Hybride",Cadastre:"Cadastre",IGN:"IGN"},f=sr(()=>r.lastSave?new Date(r.lastSave).toLocaleString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Jamais"),d=F=>{i.value=F,t("change-map-type",F),k()},m=()=>{t("create-new-plan"),k()},_=()=>{t("load-plan"),k()},w=()=>{t("save-plan"),k()},y=()=>{t("adjust-view"),k()},M=()=>{t("generate-summary"),k()},k=()=>{s.value=!1};return(F,I)=>($e(),qe("div",VO,[C("div",GO,[C("div",HO,[C("button",{class:"btn-toolbar dropdown-toggle",onMouseover:o},[I[2]||(I[2]=C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[C("path",{"fill-rule":"evenodd",d:"M12 1.586l-4 4V17h8V5.586l-4-4zM2 17V9.276l4-3.638V17H2zM2 8.162V3h4.5L12 8.5V17H6V5.638L2 8.162z","clip-rule":"evenodd"})],-1)),C("span",null,Zt(u[i.value]),1)],32),C("div",qO,[($e(),qe(Tn,null,Lr(u,(R,K)=>C("button",{key:K,class:Vi(["dropdown-item",{active:K===i.value}]),onClick:ee=>d(K)},Zt(R),11,WO)),64))])]),F.planName?($e(),qe("div",ZO,[C("div",KO,[C("div",YO,[C("h2",JO,Zt(F.planName),1),F.planDescription?($e(),qe("p",XO,Zt(F.planDescription),1)):pn("",!0)])])])):pn("",!0),C("div",{class:"border-l pl-2"},[C("div",{class:"flex items-center space-x-1"},[C("button",{onClick:m,class:"btn-toolbar",title:"Nouveau plan"},I[3]||(I[3]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[C("path",{"fill-rule":"evenodd",d:"M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V8z","clip-rule":"evenodd"})],-1),C("span",{class:"hidden lg:inline ml-1"},"Nouveau",-1)])),C("button",{onClick:_,class:"btn-toolbar",title:"Charger un plan"},I[4]||(I[4]=[$u('<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" data-v-bcd65717><path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" data-v-bcd65717></path><path d="M10 9a1 1 0 011-1h5a1 1 0 110 2h-5a1 1 0 01-1-1z" data-v-bcd65717></path><path fill-rule="evenodd" d="M13 5a1 1 0 011 1v4a1 1 0 11-2 0V6a1 1 0 011-1z" clip-rule="evenodd" data-v-bcd65717></path></svg><span class="hidden lg:inline ml-1" data-v-bcd65717>Charger</span>',2)])),C("button",{onClick:w,class:"btn-toolbar",title:"Enregistrer le plan"},I[5]||(I[5]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[C("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6h5a2 2 0 012 2v7a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2h5v5.586l-1.293-1.293zM9 4a1 1 0 012 0v2H9V4z"})],-1),C("span",{class:"hidden lg:inline ml-1"},"Enregistrer",-1)]))])]),C("div",{class:"border-l pl-2"},[C("div",{class:"flex items-center space-x-1"},[C("button",{onClick:y,class:"btn-toolbar",title:"Ajuster la vue"},I[6]||(I[6]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[C("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1),C("span",{class:"hidden lg:inline ml-1"},"Ajuster",-1)])),C("button",{onClick:M,class:"btn-toolbar",title:"Générer une synthèse"},I[7]||(I[7]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[C("path",{"fill-rule":"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})],-1),C("span",{class:"hidden lg:inline ml-1"},"Synthèse",-1)]))])]),C("div",QO,[C("div",{class:Vi(["text-xs hidden lg:flex items-center",{"text-gray-500":!F.saveStatus,"text-primary-600 font-medium":F.saveStatus==="success","text-blue-600 font-medium":F.saveStatus==="saving"}])},[F.saveStatus==="saving"?($e(),qe("svg",eB,I[8]||(I[8]=[C("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),C("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):pn("",!0),F.saveStatus==="success"?($e(),qe("svg",tB,I[9]||(I[9]=[C("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):pn("",!0),di(Gv,{name:"fade-slide",mode:"out-in"},{default:pu(()=>[F.saveStatus==="saving"?($e(),qe("span",nB," Sauvegarde en cours... ")):F.saveStatus==="success"?($e(),qe("span",rB," Sauvegarde réussie ! ")):($e(),qe("span",iB," Dernière modification : "+Zt(f.value),1))]),_:1})],2)])]),C("div",oB,[C("div",sB,[C("button",{onClick:I[0]||(I[0]=R=>s.value=!s.value),class:"p-2 rounded-md border bg-white shadow-sm"},I[10]||(I[10]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-600",viewBox:"0 0 20 20",fill:"currentColor"},[C("path",{"fill-rule":"evenodd",d:"M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})],-1)])),F.planName?($e(),qe("div",aB,Zt(F.planName),1)):pn("",!0),C("div",{class:"flex space-x-2"},[C("button",{onClick:m,class:"p-2 rounded-md border bg-white shadow-sm flex items-center justify-center"},I[11]||(I[11]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-600",viewBox:"0 0 20 20",fill:"currentColor"},[C("path",{"fill-rule":"evenodd",d:"M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V8z","clip-rule":"evenodd"})],-1)])),C("button",{onClick:w,class:"p-2 rounded-md border bg-white shadow-sm flex items-center justify-center"},I[12]||(I[12]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-600",viewBox:"0 0 20 20",fill:"currentColor"},[C("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6h5a2 2 0 012 2v7a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2h5v5.586l-1.293-1.293zM9 4a1 1 0 012 0v2H9V4z"})],-1)])),C("button",{onClick:y,class:"p-2 rounded-md border bg-white shadow-sm flex items-center justify-center"},I[13]||(I[13]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-600",viewBox:"0 0 20 20",fill:"currentColor"},[C("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1)]))])]),s.value?($e(),qe("div",lB,[C("div",uB,[I[15]||(I[15]=C("h3",{class:"text-base font-semibold text-gray-800"},"Menu",-1)),C("button",{onClick:I[1]||(I[1]=R=>s.value=!1),class:"p-1 rounded-full hover:bg-gray-100"},I[14]||(I[14]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),C("div",cB,[F.planName?($e(),qe("div",fB,[C("h3",hB,Zt(F.planName),1),F.planDescription?($e(),qe("p",dB,Zt(F.planDescription),1)):pn("",!0)])):pn("",!0),C("div",pB,[I[16]||(I[16]=C("span",{class:"text-sm font-medium text-gray-700 mb-2"},"Type de carte",-1)),C("div",gB,[($e(),qe(Tn,null,Lr(u,(R,K)=>C("button",{key:K,class:Vi(["px-3 py-2 text-sm rounded-md border shadow-sm",{"bg-blue-50 border-blue-300 text-blue-700 font-medium":K===i.value}]),onClick:ee=>d(K)},Zt(R),11,mB)),64))])]),C("div",{class:"flex flex-col"},[I[20]||(I[20]=C("span",{class:"text-sm font-medium text-gray-700 mb-2"},"Outils de plan",-1)),C("div",{class:"grid grid-cols-3 gap-2"},[C("button",{onClick:m,class:"px-3 py-2 text-sm rounded-md border shadow-sm flex items-center justify-center bg-white"},I[17]||(I[17]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[C("path",{"fill-rule":"evenodd",d:"M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V8z","clip-rule":"evenodd"})],-1),Li(" Nouveau ")])),C("button",{onClick:_,class:"px-3 py-2 text-sm rounded-md border shadow-sm flex items-center justify-center bg-white"},I[18]||(I[18]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[C("path",{"fill-rule":"evenodd",d:"M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z","clip-rule":"evenodd"}),C("path",{d:"M10 9a1 1 0 011-1h5a1 1 0 110 2h-5a1 1 0 01-1-1z"}),C("path",{"fill-rule":"evenodd",d:"M13 5a1 1 0 011 1v4a1 1 0 11-2 0V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),Li(" Charger ")])),C("button",{onClick:M,class:"px-3 py-2 text-sm rounded-md border shadow-sm flex items-center justify-center bg-white"},I[19]||(I[19]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[C("path",{"fill-rule":"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})],-1),Li(" Synthèse ")]))])]),C("div",{class:Vi(["text-sm text-center pt-3 border-t flex items-center justify-center space-x-1 mt-2",{"text-gray-500":!F.saveStatus,"text-primary-600 font-medium":F.saveStatus==="success","text-blue-600 font-medium":F.saveStatus==="saving"}])},[F.saveStatus==="saving"?($e(),qe("svg",vB,I[21]||(I[21]=[C("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),C("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):pn("",!0),F.saveStatus==="success"?($e(),qe("svg",yB,I[22]||(I[22]=[C("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):pn("",!0),di(Gv,{name:"fade-slide",mode:"out-in"},{default:pu(()=>[F.saveStatus==="saving"?($e(),qe("span",_B," Sauvegarde en cours... ")):F.saveStatus==="success"?($e(),qe("span",bB," Sauvegarde réussie ! ")):($e(),qe("span",wB," Dernière modification : "+Zt(f.value),1))]),_:1})],2)])])):pn("",!0)])]))}}),LB=vd(xB,[["__scopeId","data-v-bcd65717"]]),SB={class:"comment-thread"},EB={key:0,class:"space-y-3 mb-4"},CB={class:"flex justify-between items-start"},PB={class:"flex items-center"},MB={class:"font-medium text-sm text-gray-900"},AB={class:"flex items-center"},kB={class:"text-xs text-gray-500"},TB=["onClick"],NB={class:"mt-1 text-sm text-gray-700 whitespace-pre-wrap"},DB={key:1,class:"text-center text-sm text-gray-500 italic my-4"},IB={key:2,class:"mt-3"},OB={class:"flex justify-end mt-2"},BB=["disabled"],RB={key:3,class:"text-center text-sm text-gray-500 italic mt-2"},FB=ds({__name:"CommentThread",props:{noteId:{},comments:{}},emits:["update:comments","comment-added","comment-deleted"],setup(e,{emit:n}){const t=e;console.log("[CommentThread] Commentaires reçus initialement:",t.comments),oo(()=>t.comments,k=>{console.log("[CommentThread] Commentaires mis à jour:",k)},{deep:!0});const r=n,i=ma(),s=lh(),o=vu(),u=zt(""),f=sr(()=>i.isEntreprise||i.isAdmin);function d(k){return i.user&&k.userId===i.user.id||i.isAdmin}async function m(){var k;if(u.value.trim())try{await s.addComment(t.noteId,u.value.trim()),u.value="",o.success("Commentaire ajouté avec succès"),r("comment-added")}catch(F){if(console.error("Erreur lors de l'ajout du commentaire:",F),(k=F.response)!=null&&k.data){const I=F.response.data;I.note?o.error(`Erreur: ${I.note[0]}`):I.user?o.error(`Erreur: ${I.user[0]}`):I.text?o.error(`Erreur: ${I.text[0]}`):o.error("Erreur lors de l'ajout du commentaire")}else o.error("Erreur lors de l'ajout du commentaire")}}async function _(k){var F;if(confirm("Voulez-vous vraiment supprimer ce commentaire ?"))try{await s.removeComment(t.noteId,k),o.success("Commentaire supprimé"),r("comment-deleted")}catch(I){if(console.error("Erreur lors de la suppression du commentaire:",I),(F=I.response)!=null&&F.data){const R=I.response.data;R.detail?o.error(`Erreur: ${R.detail}`):o.error("Erreur lors de la suppression du commentaire")}else o.error("Erreur lors de la suppression du commentaire")}}function w(k){try{if(!k)return"Date inconnue";const F=new Date(k);return isNaN(F.getTime())?(console.warn(`Date invalide: ${k}`),"Date invalide"):new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(F)}catch(F){return console.error(`Erreur lors du formatage de la date: ${k}`,F),"Date invalide"}}function y(k){switch(k){case"admin":return"bg-purple-100 text-purple-800";case"entreprise":return"bg-blue-100 text-blue-800";case"salarie":return"bg-green-100 text-green-800";case"visiteur":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}}function M(k){switch(k){case"admin":return"Admin";case"entreprise":return"Entreprise";case"salarie":return"Salarié";case"visiteur":return"Visiteur";default:return k}}return(k,F)=>($e(),qe("div",SB,[k.comments&&k.comments.length>0?($e(),qe("div",EB,[($e(!0),qe(Tn,null,Lr(k.comments,I=>($e(),qe("div",{key:I.id,class:"bg-gray-50 rounded-lg p-3"},[C("div",CB,[C("div",PB,[C("div",MB,Zt(I.userName),1),C("span",{class:Vi(["ml-2 text-xs px-2 py-0.5 rounded-full",y(I.userRole)])},Zt(M(I.userRole)),3)]),C("div",AB,[C("span",kB,Zt(w(I.createdAt)),1),d(I)?($e(),qe("button",{key:0,onClick:Gc(R=>_(I.id),["prevent"]),class:"ml-2 text-gray-400 hover:text-red-500"},F[1]||(F[1]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,TB)):pn("",!0)])]),C("p",NB,Zt(I.text),1)]))),128))])):($e(),qe("div",DB," Aucun commentaire pour le moment ")),f.value?($e(),qe("div",IB,[Fn(C("textarea",{"onUpdate:modelValue":F[0]||(F[0]=I=>u.value=I),placeholder:"Ajouter un commentaire...",class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:"2"},null,512),[[ni,u.value]]),C("div",OB,[C("button",{type:"button",onClick:Gc(m,["prevent"]),disabled:!u.value.trim(),class:"px-3 py-1 text-sm font-medium text-white bg-primary-600 rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed"}," Ajouter ",8,BB)])])):($e(),qe("div",RB," Seuls les utilisateurs de l'entreprise peuvent ajouter des commentaires "))]))}}),jB={class:"photo-gallery"},zB={key:0,class:"grid grid-cols-2 gap-2 mb-4"},$B=["src","onClick"],UB={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-all duration-200 rounded-lg flex items-center justify-center"},VB={class:"opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex space-x-2"},GB=["onClick"],HB={key:1,class:"text-center text-sm text-gray-500 italic my-4"},qB={class:"flex space-x-2 mt-3"},WB={key:2,class:"mt-4 border border-gray-300 rounded-lg overflow-hidden bg-white"},ZB={class:"relative bg-gray-900",style:{height:"300px"}},KB=["src"],YB={class:"p-3 bg-gray-50 border-t border-gray-300 flex justify-center"},JB={key:1,class:"flex space-x-3"},XB={key:3,class:"fixed inset-0 z-[3002] flex items-center justify-center p-4 bg-black bg-opacity-75"},QB={class:"relative max-w-3xl max-h-[90vh] bg-white rounded-lg overflow-hidden"},eR=["src"],tR=ds({__name:"PhotoGallery",props:{noteId:{},photos:{}},emits:["update:photos","photo-added","photo-deleted"],setup(e,{emit:n}){const t=e,r=n,i=lh(),s=vu(),o=zt(null),u=zt(null),f=zt(null);let d=null;const m=zt(!1),_=zt(!1),w=zt(null),y=zt(null);function M(ve){w.value=ve,m.value=!0}async function k(ve){var z;if(confirm("Êtes-vous sûr de vouloir supprimer cette photo ?"))try{await i.removePhoto(t.noteId,ve),s.success("Photo supprimée"),r("photo-deleted"),m.value&&((z=w.value)==null?void 0:z.id)===ve&&(m.value=!1,w.value=null)}catch(U){console.error("Erreur lors de la suppression de la photo:",U),s.error("Erreur lors de la suppression de la photo")}}function F(){f.value&&f.value.click()}async function I(ve){const z=ve.target;if(!z.files||z.files.length===0)return;const U=z.files[0];if(!U.type.startsWith("image/")){s.error("Le fichier doit être une image");return}if(U.size>5*1024*1024){s.error("L'image est trop volumineuse (max 5MB)");return}try{const J=await R(U);await i.addPhoto(t.noteId,{url:J}),z.value="",s.success("Photo ajoutée"),r("photo-added")}catch(J){console.error("Erreur lors de l'ajout de la photo:",J),s.error("Erreur lors de l'ajout de la photo")}}function R(ve){return new Promise((z,U)=>{const J=new FileReader;J.onload=()=>z(J.result),J.onerror=U,J.readAsDataURL(ve)})}oo(_,async ve=>{if(ve){y.value=null;try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("API de caméra non supportée sur ce navigateur");const z={video:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}};d=await navigator.mediaDevices.getUserMedia(z),o.value&&(o.value.srcObject=d,await new Promise(U=>{o.value.onloadedmetadata=()=>{o.value.play().then(U)}}))}catch(z){console.error("Erreur lors de l'accès à la caméra:",z);let U="Impossible d'accéder à la caméra";z.name==="NotAllowedError"?U="L'accès à la caméra a été refusé. Veuillez vérifier vos permissions.":z.name==="NotFoundError"?U="Aucune caméra n'a été trouvée sur votre appareil.":z.name==="NotSupportedError"&&(U="Votre navigateur ne supporte pas l'accès à la caméra."),s.error(U),_.value=!1}}else d&&(d.getTracks().forEach(z=>z.stop()),d=null)});function K(){if(!o.value||!u.value)return;const ve=o.value,z=u.value;z.width=ve.videoWidth,z.height=ve.videoHeight;const U=z.getContext("2d");U&&(U.drawImage(ve,0,0,z.width,z.height),y.value=z.toDataURL("image/jpeg"))}function ee(){y.value=null}async function he(){if(y.value)try{await i.addPhoto(t.noteId,{url:y.value}),_.value=!1,s.success("Photo ajoutée"),r("photo-added")}catch(ve){console.error("Erreur lors de l'ajout de la photo:",ve),s.error("Erreur lors de l'ajout de la photo")}}function fe(){_.value=!1}return mc(()=>{d&&(d.getTracks().forEach(ve=>ve.stop()),d=null)}),(ve,z)=>($e(),qe("div",jB,[ve.photos&&ve.photos.length>0?($e(),qe("div",zB,[($e(!0),qe(Tn,null,Lr(ve.photos,U=>($e(),qe("div",{key:U.id,class:"relative group"},[C("img",{src:U.url,alt:"Photo",class:"w-full h-32 object-cover rounded-lg cursor-pointer",onClick:J=>M(U)},null,8,$B),C("div",UB,[C("div",VB,[C("button",{onClick:Gc(J=>k(U.id),["stop","prevent"]),class:"p-1 bg-white rounded-full text-gray-700 hover:text-red-600",title:"Supprimer la photo"},z[2]||(z[2]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,GB)])])]))),128))])):($e(),qe("div",HB," Aucune photo pour le moment ")),C("div",qB,[C("button",{type:"button",onClick:z[0]||(z[0]=U=>_.value=!0),class:"flex-1 flex items-center justify-center px-3 py-2 text-sm font-medium text-white bg-primary-600 rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2"},z[3]||(z[3]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1),Li(" Prendre une photo ")])),C("button",{type:"button",onClick:F,class:"flex-1 flex items-center justify-center px-3 py-2 text-sm font-medium text-white bg-primary-600 rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 cursor-pointer"},z[4]||(z[4]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0l-4 4m4-4v12"})],-1),Li(" Téléverser ")])),C("input",{id:"photo-upload",ref_key:"fileInput",ref:f,type:"file",accept:"image/*",class:"hidden",onChange:I},null,544)]),_.value?($e(),qe("div",WB,[C("div",{class:"p-3 bg-gray-50 border-b border-gray-300 flex justify-between items-center"},[z[6]||(z[6]=C("h3",{class:"text-sm font-medium text-gray-700"},"Mode caméra",-1)),C("button",{type:"button",onClick:fe,class:"text-gray-400 hover:text-gray-500"},z[5]||(z[5]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),C("div",ZB,[y.value?($e(),qe("img",{key:1,src:y.value,class:"w-full h-full object-contain",alt:"Captured"},null,8,KB)):($e(),qe("video",{key:0,ref_key:"videoElement",ref:o,autoplay:"",class:"w-full h-full object-contain"},null,512)),C("canvas",{ref_key:"canvasElement",ref:u,class:"hidden"},null,512)]),C("div",YB,[y.value?($e(),qe("div",JB,[C("button",{type:"button",onClick:ee,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2"}," Reprendre "),C("button",{type:"button",onClick:he,class:"px-4 py-2 text-sm font-medium text-white bg-primary-600 rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2"}," Utiliser ")])):($e(),qe("button",{key:0,type:"button",onClick:K,class:"px-4 py-2 text-sm font-medium text-white bg-primary-600 rounded-full w-12 h-12 flex items-center justify-center hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2"},z[7]||(z[7]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"})],-1)])))])])):pn("",!0),m.value?($e(),qe("div",XB,[C("div",QB,[C("button",{type:"button",onClick:z[1]||(z[1]=U=>m.value=!1),class:"absolute top-2 right-2 z-10 p-1 bg-white rounded-full text-gray-700 hover:text-red-600 shadow-md"},z[8]||(z[8]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),w.value?($e(),qe("img",{key:0,src:w.value.url,alt:"Photo",class:"max-h-[80vh] max-w-full object-contain"},null,8,eR)):pn("",!0)])])):pn("",!0)]))}}),nR=vd(tR,[["__scopeId","data-v-f87156b4"]]),rR={class:"fixed z-[9999] inset-0 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},iR={class:"flex items-center justify-center min-h-screen w-full"},oR={class:"relative bg-white w-full h-full md:rounded-lg md:max-w-2xl md:h-auto md:max-h-[90vh] md:my-8 shadow-xl transform transition-all overflow-hidden"},sR={class:"p-4 md:p-6 flex-1 overflow-y-auto"},aR={class:"flex justify-between items-center mb-4 border-b pb-4"},lR={class:"text-xl font-semibold text-gray-900"},uR={class:"mb-4 border-b border-gray-200"},cR={class:"flex space-x-4","aria-label":"Tabs"},fR={key:0,class:"ml-1 px-2 py-0.5 text-xs rounded-full bg-primary-100 text-primary-800"},hR={key:0,class:"ml-1 px-2 py-0.5 text-xs rounded-full bg-primary-100 text-primary-800"},dR={key:0},pR={class:"mb-4"},gR={class:"mb-4"},mR={key:0,class:"mb-4 p-2 rounded bg-gray-50 flex items-center"},vR={class:"mb-4"},yR=["value"],_R={class:"mb-4"},bR=["value"],wR={class:"mb-4"},xR={class:"mt-1 flex space-x-2"},LR=["onClick"],SR={key:1,class:"mt-4"},ER={class:"hidden"},CR={key:2,class:"mt-4"},fx=ds({__name:"NoteEditModal",props:{note:{},isNewNote:{type:Boolean},location:{}},emits:["close","save"],setup(e,{emit:n}){const t=e,r=n,i=lh(),s=vu(),o=zt("info"),u=window.console;oo(o,async J=>{u.log("[NoteEditModal] Onglet actif changé:",J),J==="comments"&&t.note&&t.note.id&&(u.log("[NoteEditModal] Onglet Commentaires sélectionné, commentaires actuels:",f.value.comments),await _(t.note.id)),J==="photos"&&t.note&&t.note.id&&(u.log("[NoteEditModal] Onglet Photos sélectionné, photos actuelles:",f.value.photos),await w(t.note.id))});const f=zt({title:"",description:"",columnId:"",accessLevel:Xi.PRIVATE,style:{color:"#3B82F6",weight:2,opacity:1,fillColor:"#3B82F6",fillOpacity:.6,radius:8},comments:[],photos:[]});function d(J){return Array.isArray(J)?J:typeof J=="object"&&"type"in J&&"coordinates"in J?[J.coordinates[1],J.coordinates[0]]:(u.error("[NoteEditModal] Format de localisation non reconnu:",J),[0,0])}function m(J){if(!J)return new Date().toISOString();try{const T=new Date(J);return isNaN(T.getTime())?(u.warn("[NoteEditModal] Date invalide:",J),new Date().toISOString()):T.toISOString()}catch(T){return u.error("[NoteEditModal] Erreur lors de la création de la date:",T),new Date().toISOString()}}async function _(J){try{u.log(`[NoteEditModal] Chargement des commentaires pour la note ${J}`);const T=await Qs.getComments(J);u.log("[NoteEditModal] Commentaires reçus:",T.data);const D=T.data.map(B=>({id:B.id,text:B.text,createdAt:B.created_at,userId:B.user,userName:B.user_name,userRole:B.user_role}));return u.log("[NoteEditModal] Commentaires transformés:",D),t.note&&(i.updateNote(t.note.id,{comments:D}),f.value.comments=D,u.log("[NoteEditModal] Commentaires mis à jour dans le store et localement"),u.log("[NoteEditModal] editingNote.comments après mise à jour:",f.value.comments)),D}catch(T){return u.error("[NoteEditModal] Erreur lors du chargement des commentaires:",T),s.error("Erreur lors du chargement des commentaires"),[]}}async function w(J){try{u.log(`[NoteEditModal] Chargement des photos pour la note ${J}`);const T=await Qs.getPhotos(J);u.log("[NoteEditModal] Photos reçues:",T.data);const D=T.data.map(B=>({id:B.id,url:B.image,createdAt:B.created_at,caption:B.caption}));return t.note&&(i.updateNote(t.note.id,{photos:D}),f.value.photos=D,u.log("[NoteEditModal] Photos mises à jour dans le store et localement")),D}catch(T){return u.error("[NoteEditModal] Erreur lors du chargement des photos:",T),s.error("Erreur lors du chargement des photos"),[]}}Cs(async()=>{var J,T;if(u.log("[NoteEditModal] onMounted - props:",t),await i.loadColumns(),u.log("[NoteEditModal] Colonnes chargées:",i.columns),t.note){u.log("[NoteEditModal] Édition d'une note existante:",t.note);const D=JSON.parse(JSON.stringify(t.note));D.createdAt=m(D.createdAt),D.updatedAt=m(D.updatedAt),f.value=D,t.note.id&&(u.log("[NoteEditModal] Chargement des commentaires et photos..."),await Promise.all([_(t.note.id),w(t.note.id)]),u.log("[NoteEditModal] Après chargement - Commentaires:",((J=f.value.comments)==null?void 0:J.length)||0),u.log("[NoteEditModal] Après chargement - Photos:",((T=f.value.photos)==null?void 0:T.length)||0),setTimeout(()=>{u.log("[NoteEditModal] Compteurs après timeout - Commentaires:",M.value),u.log("[NoteEditModal] Compteurs après timeout - Photos:",k.value)},0))}else if(t.isNewNote){if(u.log("[NoteEditModal] Création d'une nouvelle note"),f.value={title:"Nouvelle note",description:"",columnId:i.getDefaultColumn.id||"1",accessLevel:Xi.PRIVATE,style:{color:"#3B82F6",weight:2,opacity:1,fillColor:"#3B82F6",fillOpacity:.6,radius:8},comments:[],photos:[],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},t.location){u.log("[NoteEditModal] Ajout de la localisation:",t.location);const D=d(t.location);f.value.location=D}u.log("[NoteEditModal] Niveau d'accès initial:",f.value.accessLevel)}else u.error("[NoteEditModal] Erreur: Ni note existante ni nouvelle note");u.log("[NoteEditModal] editingNote.value après initialisation:",f.value)});const y=sr(()=>i.getSortedColumns),M=sr(()=>{var T;const J=((T=f.value.comments)==null?void 0:T.length)||0;return u.log("[NoteEditModal] Computed commentsCount recalculé:",J),J}),k=sr(()=>{var T;const J=((T=f.value.photos)==null?void 0:T.length)||0;return u.log("[NoteEditModal] Computed photosCount recalculé:",J),J}),F=[{id:Xi.PRIVATE,title:"Privé",description:"Visible uniquement par vous"},{id:Xi.COMPANY,title:"Entreprise",description:"Visible par l'entreprise uniquement"},{id:Xi.EMPLOYEE,title:"Salariés",description:"Visible par l'entreprise et les salariés"},{id:Xi.VISITOR,title:"Visiteurs",description:"Visible par tous"}],I=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#6B7280"],R=J=>{f.value.style?(f.value.style.color=J,f.value.style.fillColor=J):f.value.style={color:J,weight:2,opacity:1,fillColor:J,fillOpacity:.6,radius:8},f.value.color=J},K=()=>{var J,T,D,B,$,W,G,oe,ie,we,Ce;f.value={title:((J=t.note)==null?void 0:J.title)||"",description:((T=t.note)==null?void 0:T.description)||"",columnId:((D=t.note)==null?void 0:D.columnId)||"",accessLevel:((B=t.note)==null?void 0:B.accessLevel)||"private",style:(($=t.note)==null?void 0:$.style)||{color:((W=t.note)==null?void 0:W.color)||"#3B82F6",weight:2,opacity:1,fillColor:((G=t.note)==null?void 0:G.color)||"#3B82F6",fillOpacity:.6,radius:8},color:((oe=t.note)==null?void 0:oe.color)||"#3B82F6",location:t.location||((ie=t.note)==null?void 0:ie.location)||null,comments:((we=t.note)==null?void 0:we.comments)||[],photos:((Ce=t.note)==null?void 0:Ce.photos)||[]}};Cs(()=>{K()}),oo(()=>t.note,()=>{K()},{deep:!0});function ee(){r("close")}async function he(){u.log("[NoteEditModal] Commentaire ajouté, le modal reste ouvert"),t.note&&t.note.id&&await _(t.note.id)}async function fe(){u.log("[NoteEditModal] Photo ajoutée, le modal reste ouvert"),t.note&&t.note.id&&await w(t.note.id)}async function ve(){u.log("[NoteEditModal] Commentaire supprimé, mise à jour de la liste"),t.note&&t.note.id&&await _(t.note.id)}async function z(){u.log("[NoteEditModal] Photo supprimée, mise à jour de la liste"),t.note&&t.note.id&&await w(t.note.id)}async function U(){var J;try{const T={title:f.value.title,description:f.value.description,columnId:f.value.columnId,style:f.value.style,access_level:f.value.accessLevel,comments:f.value.comments||[],photos:f.value.photos||[]};f.value.location&&(T.location=Array.isArray(f.value.location)?{type:"Point",coordinates:[f.value.location[1],f.value.location[0]]}:f.value.location),u.log("[NoteEditModal] Données de note à sauvegarder:",T);let D;if((J=t.note)!=null&&J.id){D=(await Qs.updateNote(t.note.id,T)).data,i.updateNote(t.note.id,{...f.value,...D,accessLevel:f.value.accessLevel,style:f.value.style,updatedAt:new Date().toISOString()});const $=t.note.id,W=new CustomEvent("geonote:update",{detail:{noteId:$,properties:{name:f.value.title,description:f.value.description,columnId:f.value.columnId,accessLevel:f.value.accessLevel,style:f.value.style}}});window.dispatchEvent(W),s.success("Note mise à jour avec succès")}else{if(D=(await Qs.createNote(T)).data,!D.id)throw new Error("Le backend n'a pas fourni d'ID pour la nouvelle note");const $=i.getDefaultColumn,W={...T,id:D.id,columnId:T.columnId||$.id,accessLevel:f.value.accessLevel,style:T.style||{color:"#3B82F6",weight:2,opacity:1,fillColor:"#3B82F6",fillOpacity:.2}};u.log("[NoteEditModal] Note à ajouter au store avec ID backend:",D.id),i.addNote(W),s.success("Note créée avec succès")}D&&(!D.comments&&f.value.comments&&(D.comments=f.value.comments),!D.photos&&f.value.photos&&(D.photos=f.value.photos)),r("save",D),r("close")}catch(T){u.error("[NoteEditModal] Erreur lors de la sauvegarde de la note:",T),s.error("Erreur lors de la sauvegarde de la note")}}return(J,T)=>{var D;return $e(),qe("div",rR,[C("div",iR,[T[17]||(T[17]=C("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true"},null,-1)),C("div",oR,[C("form",{onSubmit:Gc(U,["prevent"]),class:"h-full md:h-auto flex flex-col"},[C("div",sR,[C("div",aR,[C("h3",lR,Zt((D=J.note)!=null&&D.id?"Modifier la note":"Nouvelle note"),1),C("button",{type:"button",onClick:ee,class:"text-gray-400 hover:text-gray-500"},T[7]||(T[7]=[C("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),C("div",uR,[C("nav",cR,[C("button",{type:"button",onClick:T[0]||(T[0]=B=>o.value="info"),class:Vi(["px-3 py-2 text-sm font-medium border-b-2 focus:outline-none",o.value==="info"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])}," Informations ",2),C("button",{type:"button",onClick:T[1]||(T[1]=B=>o.value="comments"),class:Vi(["px-3 py-2 text-sm font-medium border-b-2 focus:outline-none",o.value==="comments"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},[T[8]||(T[8]=Li(" Commentaires ")),M.value>0?($e(),qe("span",fR,Zt(M.value),1)):pn("",!0)],2),C("button",{type:"button",onClick:T[2]||(T[2]=B=>o.value="photos"),class:Vi(["px-3 py-2 text-sm font-medium border-b-2 focus:outline-none",o.value==="photos"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},[T[9]||(T[9]=Li(" Photos ")),k.value>0?($e(),qe("span",hR,Zt(k.value),1)):pn("",!0)],2)])]),o.value==="info"?($e(),qe("div",dR,[C("div",pR,[T[10]||(T[10]=C("label",{for:"title",class:"block text-sm font-medium text-gray-700"},"Titre",-1)),Fn(C("input",{type:"text",id:"title","onUpdate:modelValue":T[3]||(T[3]=B=>f.value.title=B),required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},null,512),[[ni,f.value.title]])]),C("div",gR,[T[11]||(T[11]=C("label",{for:"description",class:"block text-sm font-medium text-gray-700"},"Description",-1)),Fn(C("textarea",{id:"description","onUpdate:modelValue":T[4]||(T[4]=B=>f.value.description=B),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},null,512),[[ni,f.value.description]])]),f.value.location?($e(),qe("div",mR,T[12]||(T[12]=[C("div",{class:"text-primary-600 mr-2"},[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[C("path",{"fill-rule":"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z","clip-rule":"evenodd"})])],-1),C("div",{class:"text-sm text-gray-600"}," Note géolocalisée ",-1)]))):pn("",!0),C("div",vR,[T[13]||(T[13]=C("label",{for:"column",class:"block text-sm font-medium text-gray-700"},"État",-1)),Fn(C("select",{id:"column","onUpdate:modelValue":T[5]||(T[5]=B=>f.value.columnId=B),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},[($e(!0),qe(Tn,null,Lr(y.value,B=>($e(),qe("option",{key:B.id,value:B.id},Zt(B.title),9,yR))),128))],512),[[vo,f.value.columnId]])]),C("div",_R,[T[14]||(T[14]=C("label",{for:"accessLevel",class:"block text-sm font-medium text-gray-700"},"Niveau d'accès",-1)),Fn(C("select",{id:"accessLevel","onUpdate:modelValue":T[6]||(T[6]=B=>f.value.accessLevel=B),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},[($e(),qe(Tn,null,Lr(F,B=>C("option",{key:B.id,value:B.id},Zt(B.title)+" - "+Zt(B.description),9,bR)),64))],512),[[vo,f.value.accessLevel]])]),C("div",wR,[T[15]||(T[15]=C("label",{class:"block text-sm font-medium text-gray-700"},"Couleur",-1)),C("div",xR,[($e(),qe(Tn,null,Lr(I,B=>C("div",{key:B,class:Vi(["w-8 h-8 rounded-full cursor-pointer border-2",{"border-gray-400":f.value.style.color!==B,"border-black":f.value.style.color===B}]),style:ql({backgroundColor:B}),onClick:$=>R(B)},null,14,LR)),64))])])])):o.value==="comments"?($e(),qe("div",SR,[C("div",ER,Zt(u.log("[NoteEditModal] Commentaires passés au composant:",f.value.comments)),1),J.note?($e(),rl(FB,{key:0,noteId:J.note.id,comments:f.value.comments||[],onCommentAdded:he,onCommentDeleted:ve},null,8,["noteId","comments"])):pn("",!0)])):o.value==="photos"?($e(),qe("div",CR,[J.note?($e(),rl(nR,{key:0,noteId:J.note.id,photos:f.value.photos||[],onPhotoAdded:fe,onPhotoDeleted:z},null,8,["noteId","photos"])):pn("",!0)])):pn("",!0)]),C("div",{class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},[T[16]||(T[16]=C("button",{type:"submit",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-primary-600 text-base font-medium text-white hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:ml-3 sm:w-auto sm:text-sm"}," Enregistrer ",-1)),C("button",{onClick:ee,type:"button",class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"}," Annuler ")])],32)])])])}}});(()=>{var Pn,tr;var e=Object.create,n=Object.defineProperty,t=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,i=Object.getPrototypeOf,s=Object.prototype.hasOwnProperty,o=(l,h)=>()=>(h||l((h={exports:{}}).exports,h),h.exports),u=(l,h,v,x)=>{if(h&&typeof h=="object"||typeof h=="function")for(let E of r(h))!s.call(l,E)&&E!==v&&n(l,E,{get:()=>h[E],enumerable:!(x=t(h,E))||x.enumerable});return l},f=(l,h,v)=>(v=l!=null?e(i(l)):{},u(h||!l||!l.__esModule?n(v,"default",{value:l,enumerable:!0}):v,l)),d=o((l,h)=>{function v(){this.__data__=[],this.size=0}h.exports=v}),m=o((l,h)=>{function v(x,E){return x===E||x!==x&&E!==E}h.exports=v}),_=o((l,h)=>{var v=m();function x(E,j){for(var X=E.length;X--;)if(v(E[X][0],j))return X;return-1}h.exports=x}),w=o((l,h)=>{var v=_(),x=Array.prototype,E=x.splice;function j(X){var re=this.__data__,ge=v(re,X);if(ge<0)return!1;var Le=re.length-1;return ge==Le?re.pop():E.call(re,ge,1),--this.size,!0}h.exports=j}),y=o((l,h)=>{var v=_();function x(E){var j=this.__data__,X=v(j,E);return X<0?void 0:j[X][1]}h.exports=x}),M=o((l,h)=>{var v=_();function x(E){return v(this.__data__,E)>-1}h.exports=x}),k=o((l,h)=>{var v=_();function x(E,j){var X=this.__data__,re=v(X,E);return re<0?(++this.size,X.push([E,j])):X[re][1]=j,this}h.exports=x}),F=o((l,h)=>{var v=d(),x=w(),E=y(),j=M(),X=k();function re(ge){var Le=-1,Xe=ge==null?0:ge.length;for(this.clear();++Le<Xe;){var ze=ge[Le];this.set(ze[0],ze[1])}}re.prototype.clear=v,re.prototype.delete=x,re.prototype.get=E,re.prototype.has=j,re.prototype.set=X,h.exports=re}),I=o((l,h)=>{var v=F();function x(){this.__data__=new v,this.size=0}h.exports=x}),R=o((l,h)=>{function v(x){var E=this.__data__,j=E.delete(x);return this.size=E.size,j}h.exports=v}),K=o((l,h)=>{function v(x){return this.__data__.get(x)}h.exports=v}),ee=o((l,h)=>{function v(x){return this.__data__.has(x)}h.exports=v}),he=o((l,h)=>{var v=typeof ea=="object"&&ea&&ea.Object===Object&&ea;h.exports=v}),fe=o((l,h)=>{var v=he(),x=typeof self=="object"&&self&&self.Object===Object&&self,E=v||x||Function("return this")();h.exports=E}),ve=o((l,h)=>{var v=fe(),x=v.Symbol;h.exports=x}),z=o((l,h)=>{var v=ve(),x=Object.prototype,E=x.hasOwnProperty,j=x.toString,X=v?v.toStringTag:void 0;function re(ge){var Le=E.call(ge,X),Xe=ge[X];try{ge[X]=void 0;var ze=!0}catch{}var vt=j.call(ge);return ze&&(Le?ge[X]=Xe:delete ge[X]),vt}h.exports=re}),U=o((l,h)=>{var v=Object.prototype,x=v.toString;function E(j){return x.call(j)}h.exports=E}),J=o((l,h)=>{var v=ve(),x=z(),E=U(),j="[object Null]",X="[object Undefined]",re=v?v.toStringTag:void 0;function ge(Le){return Le==null?Le===void 0?X:j:re&&re in Object(Le)?x(Le):E(Le)}h.exports=ge}),T=o((l,h)=>{function v(x){var E=typeof x;return x!=null&&(E=="object"||E=="function")}h.exports=v}),D=o((l,h)=>{var v=J(),x=T(),E="[object AsyncFunction]",j="[object Function]",X="[object GeneratorFunction]",re="[object Proxy]";function ge(Le){if(!x(Le))return!1;var Xe=v(Le);return Xe==j||Xe==X||Xe==E||Xe==re}h.exports=ge}),B=o((l,h)=>{var v=fe(),x=v["__core-js_shared__"];h.exports=x}),$=o((l,h)=>{var v=B(),x=function(){var j=/[^.]+$/.exec(v&&v.keys&&v.keys.IE_PROTO||"");return j?"Symbol(src)_1."+j:""}();function E(j){return!!x&&x in j}h.exports=E}),W=o((l,h)=>{var v=Function.prototype,x=v.toString;function E(j){if(j!=null){try{return x.call(j)}catch{}try{return j+""}catch{}}return""}h.exports=E}),G=o((l,h)=>{var v=D(),x=$(),E=T(),j=W(),X=/[\\^$.*+?()[\]{}|]/g,re=/^\[object .+?Constructor\]$/,ge=Function.prototype,Le=Object.prototype,Xe=ge.toString,ze=Le.hasOwnProperty,vt=RegExp("^"+Xe.call(ze).replace(X,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Dt(Xt){if(!E(Xt)||x(Xt))return!1;var _n=v(Xt)?vt:re;return _n.test(j(Xt))}h.exports=Dt}),oe=o((l,h)=>{function v(x,E){return x==null?void 0:x[E]}h.exports=v}),ie=o((l,h)=>{var v=G(),x=oe();function E(j,X){var re=x(j,X);return v(re)?re:void 0}h.exports=E}),we=o((l,h)=>{var v=ie(),x=fe(),E=v(x,"Map");h.exports=E}),Ce=o((l,h)=>{var v=ie(),x=v(Object,"create");h.exports=x}),Te=o((l,h)=>{var v=Ce();function x(){this.__data__=v?v(null):{},this.size=0}h.exports=x}),Y=o((l,h)=>{function v(x){var E=this.has(x)&&delete this.__data__[x];return this.size-=E?1:0,E}h.exports=v}),H=o((l,h)=>{var v=Ce(),x="__lodash_hash_undefined__",E=Object.prototype,j=E.hasOwnProperty;function X(re){var ge=this.__data__;if(v){var Le=ge[re];return Le===x?void 0:Le}return j.call(ge,re)?ge[re]:void 0}h.exports=X}),Q=o((l,h)=>{var v=Ce(),x=Object.prototype,E=x.hasOwnProperty;function j(X){var re=this.__data__;return v?re[X]!==void 0:E.call(re,X)}h.exports=j}),ue=o((l,h)=>{var v=Ce(),x="__lodash_hash_undefined__";function E(j,X){var re=this.__data__;return this.size+=this.has(j)?0:1,re[j]=v&&X===void 0?x:X,this}h.exports=E}),le=o((l,h)=>{var v=Te(),x=Y(),E=H(),j=Q(),X=ue();function re(ge){var Le=-1,Xe=ge==null?0:ge.length;for(this.clear();++Le<Xe;){var ze=ge[Le];this.set(ze[0],ze[1])}}re.prototype.clear=v,re.prototype.delete=x,re.prototype.get=E,re.prototype.has=j,re.prototype.set=X,h.exports=re}),pe=o((l,h)=>{var v=le(),x=F(),E=we();function j(){this.size=0,this.__data__={hash:new v,map:new(E||x),string:new v}}h.exports=j}),Z=o((l,h)=>{function v(x){var E=typeof x;return E=="string"||E=="number"||E=="symbol"||E=="boolean"?x!=="__proto__":x===null}h.exports=v}),N=o((l,h)=>{var v=Z();function x(E,j){var X=E.__data__;return v(j)?X[typeof j=="string"?"string":"hash"]:X.map}h.exports=x}),ke=o((l,h)=>{var v=N();function x(E){var j=v(this,E).delete(E);return this.size-=j?1:0,j}h.exports=x}),Me=o((l,h)=>{var v=N();function x(E){return v(this,E).get(E)}h.exports=x}),Ue=o((l,h)=>{var v=N();function x(E){return v(this,E).has(E)}h.exports=x}),ce=o((l,h)=>{var v=N();function x(E,j){var X=v(this,E),re=X.size;return X.set(E,j),this.size+=X.size==re?0:1,this}h.exports=x}),ne=o((l,h)=>{var v=pe(),x=ke(),E=Me(),j=Ue(),X=ce();function re(ge){var Le=-1,Xe=ge==null?0:ge.length;for(this.clear();++Le<Xe;){var ze=ge[Le];this.set(ze[0],ze[1])}}re.prototype.clear=v,re.prototype.delete=x,re.prototype.get=E,re.prototype.has=j,re.prototype.set=X,h.exports=re}),ye=o((l,h)=>{var v=F(),x=we(),E=ne(),j=200;function X(re,ge){var Le=this.__data__;if(Le instanceof v){var Xe=Le.__data__;if(!x||Xe.length<j-1)return Xe.push([re,ge]),this.size=++Le.size,this;Le=this.__data__=new E(Xe)}return Le.set(re,ge),this.size=Le.size,this}h.exports=X}),de=o((l,h)=>{var v=F(),x=I(),E=R(),j=K(),X=ee(),re=ye();function ge(Le){var Xe=this.__data__=new v(Le);this.size=Xe.size}ge.prototype.clear=x,ge.prototype.delete=E,ge.prototype.get=j,ge.prototype.has=X,ge.prototype.set=re,h.exports=ge}),We=o((l,h)=>{var v=ie(),x=function(){try{var E=v(Object,"defineProperty");return E({},"",{}),E}catch{}}();h.exports=x}),Ge=o((l,h)=>{var v=We();function x(E,j,X){j=="__proto__"&&v?v(E,j,{configurable:!0,enumerable:!0,value:X,writable:!0}):E[j]=X}h.exports=x}),tt=o((l,h)=>{var v=Ge(),x=m();function E(j,X,re){(re!==void 0&&!x(j[X],re)||re===void 0&&!(X in j))&&v(j,X,re)}h.exports=E}),Ze=o((l,h)=>{function v(x){return function(E,j,X){for(var re=-1,ge=Object(E),Le=X(E),Xe=Le.length;Xe--;){var ze=Le[x?Xe:++re];if(j(ge[ze],ze,ge)===!1)break}return E}}h.exports=v}),et=o((l,h)=>{var v=Ze(),x=v();h.exports=x}),He=o((l,h)=>{var v=fe(),x=typeof l=="object"&&l&&!l.nodeType&&l,E=x&&typeof h=="object"&&h&&!h.nodeType&&h,j=E&&E.exports===x,X=j?v.Buffer:void 0,re=X?X.allocUnsafe:void 0;function ge(Le,Xe){if(Xe)return Le.slice();var ze=Le.length,vt=re?re(ze):new Le.constructor(ze);return Le.copy(vt),vt}h.exports=ge}),wt=o((l,h)=>{var v=fe(),x=v.Uint8Array;h.exports=x}),Pt=o((l,h)=>{var v=wt();function x(E){var j=new E.constructor(E.byteLength);return new v(j).set(new v(E)),j}h.exports=x}),kt=o((l,h)=>{var v=Pt();function x(E,j){var X=j?v(E.buffer):E.buffer;return new E.constructor(X,E.byteOffset,E.length)}h.exports=x}),Jt=o((l,h)=>{function v(x,E){var j=-1,X=x.length;for(E||(E=Array(X));++j<X;)E[j]=x[j];return E}h.exports=v}),rn=o((l,h)=>{var v=T(),x=Object.create,E=function(){function j(){}return function(X){if(!v(X))return{};if(x)return x(X);j.prototype=X;var re=new j;return j.prototype=void 0,re}}();h.exports=E}),un=o((l,h)=>{function v(x,E){return function(j){return x(E(j))}}h.exports=v}),Ke=o((l,h)=>{var v=un(),x=v(Object.getPrototypeOf,Object);h.exports=x}),ot=o((l,h)=>{var v=Object.prototype;function x(E){var j=E&&E.constructor,X=typeof j=="function"&&j.prototype||v;return E===X}h.exports=x}),rt=o((l,h)=>{var v=rn(),x=Ke(),E=ot();function j(X){return typeof X.constructor=="function"&&!E(X)?v(x(X)):{}}h.exports=j}),Ft=o((l,h)=>{function v(x){return x!=null&&typeof x=="object"}h.exports=v}),Qt=o((l,h)=>{var v=J(),x=Ft(),E="[object Arguments]";function j(X){return x(X)&&v(X)==E}h.exports=j}),Bn=o((l,h)=>{var v=Qt(),x=Ft(),E=Object.prototype,j=E.hasOwnProperty,X=E.propertyIsEnumerable,re=v(function(){return arguments}())?v:function(ge){return x(ge)&&j.call(ge,"callee")&&!X.call(ge,"callee")};h.exports=re}),Ln=o((l,h)=>{var v=Array.isArray;h.exports=v}),Nn=o((l,h)=>{var v=9007199254740991;function x(E){return typeof E=="number"&&E>-1&&E%1==0&&E<=v}h.exports=x}),ar=o((l,h)=>{var v=D(),x=Nn();function E(j){return j!=null&&x(j.length)&&!v(j)}h.exports=E}),En=o((l,h)=>{var v=ar(),x=Ft();function E(j){return x(j)&&v(j)}h.exports=E}),jn=o((l,h)=>{function v(){return!1}h.exports=v}),Mn=o((l,h)=>{var v=fe(),x=jn(),E=typeof l=="object"&&l&&!l.nodeType&&l,j=E&&typeof h=="object"&&h&&!h.nodeType&&h,X=j&&j.exports===E,re=X?v.Buffer:void 0,ge=re?re.isBuffer:void 0,Le=ge||x;h.exports=Le}),Yn=o((l,h)=>{var v=J(),x=Ke(),E=Ft(),j="[object Object]",X=Function.prototype,re=Object.prototype,ge=X.toString,Le=re.hasOwnProperty,Xe=ge.call(Object);function ze(vt){if(!E(vt)||v(vt)!=j)return!1;var Dt=x(vt);if(Dt===null)return!0;var Xt=Le.call(Dt,"constructor")&&Dt.constructor;return typeof Xt=="function"&&Xt instanceof Xt&&ge.call(Xt)==Xe}h.exports=ze}),br=o((l,h)=>{var v=J(),x=Nn(),E=Ft(),j="[object Arguments]",X="[object Array]",re="[object Boolean]",ge="[object Date]",Le="[object Error]",Xe="[object Function]",ze="[object Map]",vt="[object Number]",Dt="[object Object]",Xt="[object RegExp]",_n="[object Set]",Sn="[object String]",hr="[object WeakMap]",Je="[object ArrayBuffer]",nt="[object DataView]",ct="[object Float32Array]",Rt="[object Float64Array]",bt="[object Int8Array]",It="[object Int16Array]",me="[object Int32Array]",Pe="[object Uint8Array]",Be="[object Uint8ClampedArray]",Oe="[object Uint16Array]",Fe="[object Uint32Array]",je={};je[ct]=je[Rt]=je[bt]=je[It]=je[me]=je[Pe]=je[Be]=je[Oe]=je[Fe]=!0,je[j]=je[X]=je[Je]=je[re]=je[nt]=je[ge]=je[Le]=je[Xe]=je[ze]=je[vt]=je[Dt]=je[Xt]=je[_n]=je[Sn]=je[hr]=!1;function at(lt){return E(lt)&&x(lt.length)&&!!je[v(lt)]}h.exports=at}),Or=o((l,h)=>{function v(x){return function(E){return x(E)}}h.exports=v}),gr=o((l,h)=>{var v=he(),x=typeof l=="object"&&l&&!l.nodeType&&l,E=x&&typeof h=="object"&&h&&!h.nodeType&&h,j=E&&E.exports===x,X=j&&v.process,re=function(){try{var ge=E&&E.require&&E.require("util").types;return ge||X&&X.binding&&X.binding("util")}catch{}}();h.exports=re}),ii=o((l,h)=>{var v=br(),x=Or(),E=gr(),j=E&&E.isTypedArray,X=j?x(j):v;h.exports=X}),ft=o((l,h)=>{function v(x,E){if(!(E==="constructor"&&typeof x[E]=="function")&&E!="__proto__")return x[E]}h.exports=v}),Qe=o((l,h)=>{var v=Ge(),x=m(),E=Object.prototype,j=E.hasOwnProperty;function X(re,ge,Le){var Xe=re[ge];(!(j.call(re,ge)&&x(Xe,Le))||Le===void 0&&!(ge in re))&&v(re,ge,Le)}h.exports=X}),$t=o((l,h)=>{var v=Qe(),x=Ge();function E(j,X,re,ge){var Le=!re;re||(re={});for(var Xe=-1,ze=X.length;++Xe<ze;){var vt=X[Xe],Dt=ge?ge(re[vt],j[vt],vt,re,j):void 0;Dt===void 0&&(Dt=j[vt]),Le?x(re,vt,Dt):v(re,vt,Dt)}return re}h.exports=E}),xn=o((l,h)=>{function v(x,E){for(var j=-1,X=Array(x);++j<x;)X[j]=E(j);return X}h.exports=v}),vn=o((l,h)=>{var v=9007199254740991,x=/^(?:0|[1-9]\d*)$/;function E(j,X){var re=typeof j;return X=X??v,!!X&&(re=="number"||re!="symbol"&&x.test(j))&&j>-1&&j%1==0&&j<X}h.exports=E}),bn=o((l,h)=>{var v=xn(),x=Bn(),E=Ln(),j=Mn(),X=vn(),re=ii(),ge=Object.prototype,Le=ge.hasOwnProperty;function Xe(ze,vt){var Dt=E(ze),Xt=!Dt&&x(ze),_n=!Dt&&!Xt&&j(ze),Sn=!Dt&&!Xt&&!_n&&re(ze),hr=Dt||Xt||_n||Sn,Je=hr?v(ze.length,String):[],nt=Je.length;for(var ct in ze)(vt||Le.call(ze,ct))&&!(hr&&(ct=="length"||_n&&(ct=="offset"||ct=="parent")||Sn&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||X(ct,nt)))&&Je.push(ct);return Je}h.exports=Xe}),Ht=o((l,h)=>{function v(x){var E=[];if(x!=null)for(var j in Object(x))E.push(j);return E}h.exports=v}),Hn=o((l,h)=>{var v=T(),x=ot(),E=Ht(),j=Object.prototype,X=j.hasOwnProperty;function re(ge){if(!v(ge))return E(ge);var Le=x(ge),Xe=[];for(var ze in ge)ze=="constructor"&&(Le||!X.call(ge,ze))||Xe.push(ze);return Xe}h.exports=re}),St=o((l,h)=>{var v=bn(),x=Hn(),E=ar();function j(X){return E(X)?v(X,!0):x(X)}h.exports=j}),mt=o((l,h)=>{var v=$t(),x=St();function E(j){return v(j,x(j))}h.exports=E}),wn=o((l,h)=>{var v=tt(),x=He(),E=kt(),j=Jt(),X=rt(),re=Bn(),ge=Ln(),Le=En(),Xe=Mn(),ze=D(),vt=T(),Dt=Yn(),Xt=ii(),_n=ft(),Sn=mt();function hr(Je,nt,ct,Rt,bt,It,me){var Pe=_n(Je,ct),Be=_n(nt,ct),Oe=me.get(Be);if(Oe){v(Je,ct,Oe);return}var Fe=It?It(Pe,Be,ct+"",Je,nt,me):void 0,je=Fe===void 0;if(je){var at=ge(Be),lt=!at&&Xe(Be),pt=!at&&!lt&&Xt(Be);Fe=Be,at||lt||pt?ge(Pe)?Fe=Pe:Le(Pe)?Fe=j(Pe):lt?(je=!1,Fe=x(Be,!0)):pt?(je=!1,Fe=E(Be,!0)):Fe=[]:Dt(Be)||re(Be)?(Fe=Pe,re(Pe)?Fe=Sn(Pe):(!vt(Pe)||ze(Pe))&&(Fe=X(Be))):je=!1}je&&(me.set(Be,Fe),bt(Fe,Be,Rt,It,me),me.delete(Be)),v(Je,ct,Fe)}h.exports=hr}),Qr=o((l,h)=>{var v=de(),x=tt(),E=et(),j=wn(),X=T(),re=St(),ge=ft();function Le(Xe,ze,vt,Dt,Xt){Xe!==ze&&E(ze,function(_n,Sn){if(Xt||(Xt=new v),X(_n))j(Xe,ze,Sn,vt,Le,Dt,Xt);else{var hr=Dt?Dt(ge(Xe,Sn),_n,Sn+"",Xe,ze,Xt):void 0;hr===void 0&&(hr=_n),x(Xe,Sn,hr)}},re)}h.exports=Le}),Tt=o((l,h)=>{function v(x){return x}h.exports=v}),Rn=o((l,h)=>{function v(x,E,j){switch(j.length){case 0:return x.call(E);case 1:return x.call(E,j[0]);case 2:return x.call(E,j[0],j[1]);case 3:return x.call(E,j[0],j[1],j[2])}return x.apply(E,j)}h.exports=v}),Qn=o((l,h)=>{var v=Rn(),x=Math.max;function E(j,X,re){return X=x(X===void 0?j.length-1:X,0),function(){for(var ge=arguments,Le=-1,Xe=x(ge.length-X,0),ze=Array(Xe);++Le<Xe;)ze[Le]=ge[X+Le];Le=-1;for(var vt=Array(X+1);++Le<X;)vt[Le]=ge[Le];return vt[X]=re(ze),v(j,this,vt)}}h.exports=E}),Pi=o((l,h)=>{function v(x){return function(){return x}}h.exports=v}),Sr=o((l,h)=>{var v=Pi(),x=We(),E=Tt(),j=x?function(X,re){return x(X,"toString",{configurable:!0,enumerable:!1,value:v(re),writable:!0})}:E;h.exports=j}),Pr=o((l,h)=>{var v=800,x=16,E=Date.now;function j(X){var re=0,ge=0;return function(){var Le=E(),Xe=x-(Le-ge);if(ge=Le,Xe>0){if(++re>=v)return arguments[0]}else re=0;return X.apply(void 0,arguments)}}h.exports=j}),dr=o((l,h)=>{var v=Sr(),x=Pr(),E=x(v);h.exports=E}),Mi=o((l,h)=>{var v=Tt(),x=Qn(),E=dr();function j(X,re){return E(x(X,re,v),X+"")}h.exports=j}),wr=o((l,h)=>{var v=m(),x=ar(),E=vn(),j=T();function X(re,ge,Le){if(!j(Le))return!1;var Xe=typeof ge;return(Xe=="number"?x(Le)&&E(ge,Le.length):Xe=="string"&&ge in Le)?v(Le[ge],re):!1}h.exports=X}),Gr=o((l,h)=>{var v=Mi(),x=wr();function E(j){return v(function(X,re){var ge=-1,Le=re.length,Xe=Le>1?re[Le-1]:void 0,ze=Le>2?re[2]:void 0;for(Xe=j.length>3&&typeof Xe=="function"?(Le--,Xe):void 0,ze&&x(re[0],re[1],ze)&&(Xe=Le<3?void 0:Xe,Le=1),X=Object(X);++ge<Le;){var vt=re[ge];vt&&j(X,vt,ge,Xe)}return X})}h.exports=E}),Ir=o((l,h)=>{var v=Qr(),x=Gr(),E=x(function(j,X,re){v(j,X,re)});h.exports=E}),tn=o((l,h)=>{var v=J(),x=Ft(),E="[object Symbol]";function j(X){return typeof X=="symbol"||x(X)&&v(X)==E}h.exports=j}),zi=o((l,h)=>{var v=Ln(),x=tn(),E=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,j=/^\w*$/;function X(re,ge){if(v(re))return!1;var Le=typeof re;return Le=="number"||Le=="symbol"||Le=="boolean"||re==null||x(re)?!0:j.test(re)||!E.test(re)||ge!=null&&re in Object(ge)}h.exports=X}),Oi=o((l,h)=>{var v=ne(),x="Expected a function";function E(j,X){if(typeof j!="function"||X!=null&&typeof X!="function")throw new TypeError(x);var re=function(){var ge=arguments,Le=X?X.apply(this,ge):ge[0],Xe=re.cache;if(Xe.has(Le))return Xe.get(Le);var ze=j.apply(this,ge);return re.cache=Xe.set(Le,ze)||Xe,ze};return re.cache=new(E.Cache||v),re}E.Cache=v,h.exports=E}),Qi=o((l,h)=>{var v=Oi(),x=500;function E(j){var X=v(j,function(ge){return re.size===x&&re.clear(),ge}),re=X.cache;return X}h.exports=E}),ei=o((l,h)=>{var v=Qi(),x=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,E=/\\(\\)?/g,j=v(function(X){var re=[];return X.charCodeAt(0)===46&&re.push(""),X.replace(x,function(ge,Le,Xe,ze){re.push(Xe?ze.replace(E,"$1"):Le||ge)}),re});h.exports=j}),Br=o((l,h)=>{function v(x,E){for(var j=-1,X=x==null?0:x.length,re=Array(X);++j<X;)re[j]=E(x[j],j,x);return re}h.exports=v}),ui=o((l,h)=>{var v=ve(),x=Br(),E=Ln(),j=tn(),X=v?v.prototype:void 0,re=X?X.toString:void 0;function ge(Le){if(typeof Le=="string")return Le;if(E(Le))return x(Le,ge)+"";if(j(Le))return re?re.call(Le):"";var Xe=Le+"";return Xe=="0"&&1/Le==-1/0?"-0":Xe}h.exports=ge}),mr=o((l,h)=>{var v=ui();function x(E){return E==null?"":v(E)}h.exports=x}),Si=o((l,h)=>{var v=Ln(),x=zi(),E=ei(),j=mr();function X(re,ge){return v(re)?re:x(re,ge)?[re]:E(j(re))}h.exports=X}),ps=o((l,h)=>{var v=tn();function x(E){if(typeof E=="string"||v(E))return E;var j=E+"";return j=="0"&&1/E==-1/0?"-0":j}h.exports=x}),va=o((l,h)=>{var v=Si(),x=ps();function E(j,X){X=v(X,j);for(var re=0,ge=X.length;j!=null&&re<ge;)j=j[x(X[re++])];return re&&re==ge?j:void 0}h.exports=E}),Rr=o((l,h)=>{var v=va();function x(E,j,X){var re=E==null?void 0:v(E,j);return re===void 0?X:re}h.exports=x}),mn=o((l,h)=>{(function(v,x){typeof l=="object"&&typeof h<"u"?h.exports=x():(v=v||self).RBush=x()})(l,function(){function v(Je,nt,ct,Rt,bt){(function It(me,Pe,Be,Oe,Fe){for(;Oe>Be;){if(Oe-Be>600){var je=Oe-Be+1,at=Pe-Be+1,lt=Math.log(je),pt=.5*Math.exp(2*lt/3),Et=.5*Math.sqrt(lt*pt*(je-pt)/je)*(at-je/2<0?-1:1),Ct=Math.max(Be,Math.floor(Pe-at*pt/je+Et)),on=Math.min(Oe,Math.floor(Pe+(je-at)*pt/je+Et));It(me,Pe,Ct,on,Fe)}var $n=me[Pe],Wn=Be,nr=Oe;for(x(me,Be,Pe),Fe(me[Oe],$n)>0&&x(me,Be,Oe);Wn<nr;){for(x(me,Wn,nr),Wn++,nr--;Fe(me[Wn],$n)<0;)Wn++;for(;Fe(me[nr],$n)>0;)nr--}Fe(me[Be],$n)===0?x(me,Be,nr):x(me,++nr,Oe),nr<=Pe&&(Be=nr+1),Pe<=nr&&(Oe=nr-1)}})(Je,nt,ct||0,Rt||Je.length-1,bt||E)}function x(Je,nt,ct){var Rt=Je[nt];Je[nt]=Je[ct],Je[ct]=Rt}function E(Je,nt){return Je<nt?-1:Je>nt?1:0}var j=function(Je){Je===void 0&&(Je=9),this._maxEntries=Math.max(4,Je),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function X(Je,nt,ct){if(!ct)return nt.indexOf(Je);for(var Rt=0;Rt<nt.length;Rt++)if(ct(Je,nt[Rt]))return Rt;return-1}function re(Je,nt){ge(Je,0,Je.children.length,nt,Je)}function ge(Je,nt,ct,Rt,bt){bt||(bt=Sn(null)),bt.minX=1/0,bt.minY=1/0,bt.maxX=-1/0,bt.maxY=-1/0;for(var It=nt;It<ct;It++){var me=Je.children[It];Le(bt,Je.leaf?Rt(me):me)}return bt}function Le(Je,nt){return Je.minX=Math.min(Je.minX,nt.minX),Je.minY=Math.min(Je.minY,nt.minY),Je.maxX=Math.max(Je.maxX,nt.maxX),Je.maxY=Math.max(Je.maxY,nt.maxY),Je}function Xe(Je,nt){return Je.minX-nt.minX}function ze(Je,nt){return Je.minY-nt.minY}function vt(Je){return(Je.maxX-Je.minX)*(Je.maxY-Je.minY)}function Dt(Je){return Je.maxX-Je.minX+(Je.maxY-Je.minY)}function Xt(Je,nt){return Je.minX<=nt.minX&&Je.minY<=nt.minY&&nt.maxX<=Je.maxX&&nt.maxY<=Je.maxY}function _n(Je,nt){return nt.minX<=Je.maxX&&nt.minY<=Je.maxY&&nt.maxX>=Je.minX&&nt.maxY>=Je.minY}function Sn(Je){return{children:Je,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function hr(Je,nt,ct,Rt,bt){for(var It=[nt,ct];It.length;)if(!((ct=It.pop())-(nt=It.pop())<=Rt)){var me=nt+Math.ceil((ct-nt)/Rt/2)*Rt;v(Je,me,nt,ct,bt),It.push(nt,me,me,ct)}}return j.prototype.all=function(){return this._all(this.data,[])},j.prototype.search=function(Je){var nt=this.data,ct=[];if(!_n(Je,nt))return ct;for(var Rt=this.toBBox,bt=[];nt;){for(var It=0;It<nt.children.length;It++){var me=nt.children[It],Pe=nt.leaf?Rt(me):me;_n(Je,Pe)&&(nt.leaf?ct.push(me):Xt(Je,Pe)?this._all(me,ct):bt.push(me))}nt=bt.pop()}return ct},j.prototype.collides=function(Je){var nt=this.data;if(!_n(Je,nt))return!1;for(var ct=[];nt;){for(var Rt=0;Rt<nt.children.length;Rt++){var bt=nt.children[Rt],It=nt.leaf?this.toBBox(bt):bt;if(_n(Je,It)){if(nt.leaf||Xt(Je,It))return!0;ct.push(bt)}}nt=ct.pop()}return!1},j.prototype.load=function(Je){if(!Je||!Je.length)return this;if(Je.length<this._minEntries){for(var nt=0;nt<Je.length;nt++)this.insert(Je[nt]);return this}var ct=this._build(Je.slice(),0,Je.length-1,0);if(this.data.children.length)if(this.data.height===ct.height)this._splitRoot(this.data,ct);else{if(this.data.height<ct.height){var Rt=this.data;this.data=ct,ct=Rt}this._insert(ct,this.data.height-ct.height-1,!0)}else this.data=ct;return this},j.prototype.insert=function(Je){return Je&&this._insert(Je,this.data.height-1),this},j.prototype.clear=function(){return this.data=Sn([]),this},j.prototype.remove=function(Je,nt){if(!Je)return this;for(var ct,Rt,bt,It=this.data,me=this.toBBox(Je),Pe=[],Be=[];It||Pe.length;){if(It||(It=Pe.pop(),Rt=Pe[Pe.length-1],ct=Be.pop(),bt=!0),It.leaf){var Oe=X(Je,It.children,nt);if(Oe!==-1)return It.children.splice(Oe,1),Pe.push(It),this._condense(Pe),this}bt||It.leaf||!Xt(It,me)?Rt?(ct++,It=Rt.children[ct],bt=!1):It=null:(Pe.push(It),Be.push(ct),ct=0,Rt=It,It=It.children[0])}return this},j.prototype.toBBox=function(Je){return Je},j.prototype.compareMinX=function(Je,nt){return Je.minX-nt.minX},j.prototype.compareMinY=function(Je,nt){return Je.minY-nt.minY},j.prototype.toJSON=function(){return this.data},j.prototype.fromJSON=function(Je){return this.data=Je,this},j.prototype._all=function(Je,nt){for(var ct=[];Je;)Je.leaf?nt.push.apply(nt,Je.children):ct.push.apply(ct,Je.children),Je=ct.pop();return nt},j.prototype._build=function(Je,nt,ct,Rt){var bt,It=ct-nt+1,me=this._maxEntries;if(It<=me)return re(bt=Sn(Je.slice(nt,ct+1)),this.toBBox),bt;Rt||(Rt=Math.ceil(Math.log(It)/Math.log(me)),me=Math.ceil(It/Math.pow(me,Rt-1))),(bt=Sn([])).leaf=!1,bt.height=Rt;var Pe=Math.ceil(It/me),Be=Pe*Math.ceil(Math.sqrt(me));hr(Je,nt,ct,Be,this.compareMinX);for(var Oe=nt;Oe<=ct;Oe+=Be){var Fe=Math.min(Oe+Be-1,ct);hr(Je,Oe,Fe,Pe,this.compareMinY);for(var je=Oe;je<=Fe;je+=Pe){var at=Math.min(je+Pe-1,Fe);bt.children.push(this._build(Je,je,at,Rt-1))}}return re(bt,this.toBBox),bt},j.prototype._chooseSubtree=function(Je,nt,ct,Rt){for(;Rt.push(nt),!nt.leaf&&Rt.length-1!==ct;){for(var bt=1/0,It=1/0,me=void 0,Pe=0;Pe<nt.children.length;Pe++){var Be=nt.children[Pe],Oe=vt(Be),Fe=(je=Je,at=Be,(Math.max(at.maxX,je.maxX)-Math.min(at.minX,je.minX))*(Math.max(at.maxY,je.maxY)-Math.min(at.minY,je.minY))-Oe);Fe<It?(It=Fe,bt=Oe<bt?Oe:bt,me=Be):Fe===It&&Oe<bt&&(bt=Oe,me=Be)}nt=me||nt.children[0]}var je,at;return nt},j.prototype._insert=function(Je,nt,ct){var Rt=ct?Je:this.toBBox(Je),bt=[],It=this._chooseSubtree(Rt,this.data,nt,bt);for(It.children.push(Je),Le(It,Rt);nt>=0&&bt[nt].children.length>this._maxEntries;)this._split(bt,nt),nt--;this._adjustParentBBoxes(Rt,bt,nt)},j.prototype._split=function(Je,nt){var ct=Je[nt],Rt=ct.children.length,bt=this._minEntries;this._chooseSplitAxis(ct,bt,Rt);var It=this._chooseSplitIndex(ct,bt,Rt),me=Sn(ct.children.splice(It,ct.children.length-It));me.height=ct.height,me.leaf=ct.leaf,re(ct,this.toBBox),re(me,this.toBBox),nt?Je[nt-1].children.push(me):this._splitRoot(ct,me)},j.prototype._splitRoot=function(Je,nt){this.data=Sn([Je,nt]),this.data.height=Je.height+1,this.data.leaf=!1,re(this.data,this.toBBox)},j.prototype._chooseSplitIndex=function(Je,nt,ct){for(var Rt,bt,It,me,Pe,Be,Oe,Fe=1/0,je=1/0,at=nt;at<=ct-nt;at++){var lt=ge(Je,0,at,this.toBBox),pt=ge(Je,at,ct,this.toBBox),Et=(bt=lt,It=pt,me=void 0,Pe=void 0,Be=void 0,Oe=void 0,me=Math.max(bt.minX,It.minX),Pe=Math.max(bt.minY,It.minY),Be=Math.min(bt.maxX,It.maxX),Oe=Math.min(bt.maxY,It.maxY),Math.max(0,Be-me)*Math.max(0,Oe-Pe)),Ct=vt(lt)+vt(pt);Et<Fe?(Fe=Et,Rt=at,je=Ct<je?Ct:je):Et===Fe&&Ct<je&&(je=Ct,Rt=at)}return Rt||ct-nt},j.prototype._chooseSplitAxis=function(Je,nt,ct){var Rt=Je.leaf?this.compareMinX:Xe,bt=Je.leaf?this.compareMinY:ze;this._allDistMargin(Je,nt,ct,Rt)<this._allDistMargin(Je,nt,ct,bt)&&Je.children.sort(Rt)},j.prototype._allDistMargin=function(Je,nt,ct,Rt){Je.children.sort(Rt);for(var bt=this.toBBox,It=ge(Je,0,nt,bt),me=ge(Je,ct-nt,ct,bt),Pe=Dt(It)+Dt(me),Be=nt;Be<ct-nt;Be++){var Oe=Je.children[Be];Le(It,Je.leaf?bt(Oe):Oe),Pe+=Dt(It)}for(var Fe=ct-nt-1;Fe>=nt;Fe--){var je=Je.children[Fe];Le(me,Je.leaf?bt(je):je),Pe+=Dt(me)}return Pe},j.prototype._adjustParentBBoxes=function(Je,nt,ct){for(var Rt=ct;Rt>=0;Rt--)Le(nt[Rt],Je)},j.prototype._condense=function(Je){for(var nt=Je.length-1,ct=void 0;nt>=0;nt--)Je[nt].children.length===0?nt>0?(ct=Je[nt-1].children).splice(ct.indexOf(Je[nt]),1):this.clear():re(Je[nt],this.toBBox)},j})}),Zn=o(l=>{Object.defineProperty(l,"__esModule",{value:!0}),l.earthRadius=63710088e-1,l.factors={centimeters:l.earthRadius*100,centimetres:l.earthRadius*100,degrees:l.earthRadius/111325,feet:l.earthRadius*3.28084,inches:l.earthRadius*39.37,kilometers:l.earthRadius/1e3,kilometres:l.earthRadius/1e3,meters:l.earthRadius,metres:l.earthRadius,miles:l.earthRadius/1609.344,millimeters:l.earthRadius*1e3,millimetres:l.earthRadius*1e3,nauticalmiles:l.earthRadius/1852,radians:1,yards:l.earthRadius*1.0936},l.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/l.earthRadius,yards:1.0936133},l.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function h(Oe,Fe,je){je===void 0&&(je={});var at={type:"Feature"};return(je.id===0||je.id)&&(at.id=je.id),je.bbox&&(at.bbox=je.bbox),at.properties=Fe||{},at.geometry=Oe,at}l.feature=h;function v(Oe,Fe,je){switch(Oe){case"Point":return x(Fe).geometry;case"LineString":return re(Fe).geometry;case"Polygon":return j(Fe).geometry;case"MultiPoint":return ze(Fe).geometry;case"MultiLineString":return Xe(Fe).geometry;case"MultiPolygon":return vt(Fe).geometry;default:throw new Error(Oe+" is invalid")}}l.geometry=v;function x(Oe,Fe,je){if(je===void 0&&(je={}),!Oe)throw new Error("coordinates is required");if(!Array.isArray(Oe))throw new Error("coordinates must be an Array");if(Oe.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!It(Oe[0])||!It(Oe[1]))throw new Error("coordinates must contain numbers");var at={type:"Point",coordinates:Oe};return h(at,Fe,je)}l.point=x;function E(Oe,Fe,je){return je===void 0&&(je={}),Le(Oe.map(function(at){return x(at,Fe)}),je)}l.points=E;function j(Oe,Fe,je){je===void 0&&(je={});for(var at=0,lt=Oe;at<lt.length;at++){var pt=lt[at];if(pt.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var Et=0;Et<pt[pt.length-1].length;Et++)if(pt[pt.length-1][Et]!==pt[0][Et])throw new Error("First and last Position are not equivalent.")}var Ct={type:"Polygon",coordinates:Oe};return h(Ct,Fe,je)}l.polygon=j;function X(Oe,Fe,je){return je===void 0&&(je={}),Le(Oe.map(function(at){return j(at,Fe)}),je)}l.polygons=X;function re(Oe,Fe,je){if(je===void 0&&(je={}),Oe.length<2)throw new Error("coordinates must be an array of two or more positions");var at={type:"LineString",coordinates:Oe};return h(at,Fe,je)}l.lineString=re;function ge(Oe,Fe,je){return je===void 0&&(je={}),Le(Oe.map(function(at){return re(at,Fe)}),je)}l.lineStrings=ge;function Le(Oe,Fe){Fe===void 0&&(Fe={});var je={type:"FeatureCollection"};return Fe.id&&(je.id=Fe.id),Fe.bbox&&(je.bbox=Fe.bbox),je.features=Oe,je}l.featureCollection=Le;function Xe(Oe,Fe,je){je===void 0&&(je={});var at={type:"MultiLineString",coordinates:Oe};return h(at,Fe,je)}l.multiLineString=Xe;function ze(Oe,Fe,je){je===void 0&&(je={});var at={type:"MultiPoint",coordinates:Oe};return h(at,Fe,je)}l.multiPoint=ze;function vt(Oe,Fe,je){je===void 0&&(je={});var at={type:"MultiPolygon",coordinates:Oe};return h(at,Fe,je)}l.multiPolygon=vt;function Dt(Oe,Fe,je){je===void 0&&(je={});var at={type:"GeometryCollection",geometries:Oe};return h(at,Fe,je)}l.geometryCollection=Dt;function Xt(Oe,Fe){if(Fe===void 0&&(Fe=0),Fe&&!(Fe>=0))throw new Error("precision must be a positive number");var je=Math.pow(10,Fe||0);return Math.round(Oe*je)/je}l.round=Xt;function _n(Oe,Fe){Fe===void 0&&(Fe="kilometers");var je=l.factors[Fe];if(!je)throw new Error(Fe+" units is invalid");return Oe*je}l.radiansToLength=_n;function Sn(Oe,Fe){Fe===void 0&&(Fe="kilometers");var je=l.factors[Fe];if(!je)throw new Error(Fe+" units is invalid");return Oe/je}l.lengthToRadians=Sn;function hr(Oe,Fe){return nt(Sn(Oe,Fe))}l.lengthToDegrees=hr;function Je(Oe){var Fe=Oe%360;return Fe<0&&(Fe+=360),Fe}l.bearingToAzimuth=Je;function nt(Oe){var Fe=Oe%(2*Math.PI);return Fe*180/Math.PI}l.radiansToDegrees=nt;function ct(Oe){var Fe=Oe%360;return Fe*Math.PI/180}l.degreesToRadians=ct;function Rt(Oe,Fe,je){if(Fe===void 0&&(Fe="kilometers"),je===void 0&&(je="kilometers"),!(Oe>=0))throw new Error("length must be a positive number");return _n(Sn(Oe,Fe),je)}l.convertLength=Rt;function bt(Oe,Fe,je){if(Fe===void 0&&(Fe="meters"),je===void 0&&(je="kilometers"),!(Oe>=0))throw new Error("area must be a positive number");var at=l.areaFactors[Fe];if(!at)throw new Error("invalid original units");var lt=l.areaFactors[je];if(!lt)throw new Error("invalid final units");return Oe/at*lt}l.convertArea=bt;function It(Oe){return!isNaN(Oe)&&Oe!==null&&!Array.isArray(Oe)}l.isNumber=It;function me(Oe){return!!Oe&&Oe.constructor===Object}l.isObject=me;function Pe(Oe){if(!Oe)throw new Error("bbox is required");if(!Array.isArray(Oe))throw new Error("bbox must be an Array");if(Oe.length!==4&&Oe.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");Oe.forEach(function(Fe){if(!It(Fe))throw new Error("bbox must only contain numbers")})}l.validateBBox=Pe;function Be(Oe){if(!Oe)throw new Error("id is required");if(["string","number"].indexOf(typeof Oe)===-1)throw new Error("id must be a number or a string")}l.validateId=Be}),Ei=o(l=>{Object.defineProperty(l,"__esModule",{value:!0});var h=Zn();function v(nt,ct,Rt){if(nt!==null)for(var bt,It,me,Pe,Be,Oe,Fe,je=0,at=0,lt,pt=nt.type,Et=pt==="FeatureCollection",Ct=pt==="Feature",on=Et?nt.features.length:1,$n=0;$n<on;$n++){Fe=Et?nt.features[$n].geometry:Ct?nt.geometry:nt,lt=Fe?Fe.type==="GeometryCollection":!1,Be=lt?Fe.geometries.length:1;for(var Wn=0;Wn<Be;Wn++){var nr=0,gi=0;if(Pe=lt?Fe.geometries[Wn]:Fe,Pe!==null){Oe=Pe.coordinates;var Ti=Pe.type;switch(je=Rt&&(Ti==="Polygon"||Ti==="MultiPolygon")?1:0,Ti){case null:break;case"Point":if(ct(Oe,at,$n,nr,gi)===!1)return!1;at++,nr++;break;case"LineString":case"MultiPoint":for(bt=0;bt<Oe.length;bt++){if(ct(Oe[bt],at,$n,nr,gi)===!1)return!1;at++,Ti==="MultiPoint"&&nr++}Ti==="LineString"&&nr++;break;case"Polygon":case"MultiLineString":for(bt=0;bt<Oe.length;bt++){for(It=0;It<Oe[bt].length-je;It++){if(ct(Oe[bt][It],at,$n,nr,gi)===!1)return!1;at++}Ti==="MultiLineString"&&nr++,Ti==="Polygon"&&gi++}Ti==="Polygon"&&nr++;break;case"MultiPolygon":for(bt=0;bt<Oe.length;bt++){for(gi=0,It=0;It<Oe[bt].length;It++){for(me=0;me<Oe[bt][It].length-je;me++){if(ct(Oe[bt][It][me],at,$n,nr,gi)===!1)return!1;at++}gi++}nr++}break;case"GeometryCollection":for(bt=0;bt<Pe.geometries.length;bt++)if(v(Pe.geometries[bt],ct,Rt)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function x(nt,ct,Rt,bt){var It=Rt;return v(nt,function(me,Pe,Be,Oe,Fe){Pe===0&&Rt===void 0?It=me:It=ct(It,me,Pe,Be,Oe,Fe)},bt),It}function E(nt,ct){var Rt;switch(nt.type){case"FeatureCollection":for(Rt=0;Rt<nt.features.length&&ct(nt.features[Rt].properties,Rt)!==!1;Rt++);break;case"Feature":ct(nt.properties,0);break}}function j(nt,ct,Rt){var bt=Rt;return E(nt,function(It,me){me===0&&Rt===void 0?bt=It:bt=ct(bt,It,me)}),bt}function X(nt,ct){if(nt.type==="Feature")ct(nt,0);else if(nt.type==="FeatureCollection")for(var Rt=0;Rt<nt.features.length&&ct(nt.features[Rt],Rt)!==!1;Rt++);}function re(nt,ct,Rt){var bt=Rt;return X(nt,function(It,me){me===0&&Rt===void 0?bt=It:bt=ct(bt,It,me)}),bt}function ge(nt){var ct=[];return v(nt,function(Rt){ct.push(Rt)}),ct}function Le(nt,ct){var Rt,bt,It,me,Pe,Be,Oe,Fe,je,at,lt=0,pt=nt.type==="FeatureCollection",Et=nt.type==="Feature",Ct=pt?nt.features.length:1;for(Rt=0;Rt<Ct;Rt++){for(Be=pt?nt.features[Rt].geometry:Et?nt.geometry:nt,Fe=pt?nt.features[Rt].properties:Et?nt.properties:{},je=pt?nt.features[Rt].bbox:Et?nt.bbox:void 0,at=pt?nt.features[Rt].id:Et?nt.id:void 0,Oe=Be?Be.type==="GeometryCollection":!1,Pe=Oe?Be.geometries.length:1,It=0;It<Pe;It++){if(me=Oe?Be.geometries[It]:Be,me===null){if(ct(null,lt,Fe,je,at)===!1)return!1;continue}switch(me.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(ct(me,lt,Fe,je,at)===!1)return!1;break}case"GeometryCollection":{for(bt=0;bt<me.geometries.length;bt++)if(ct(me.geometries[bt],lt,Fe,je,at)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}lt++}}function Xe(nt,ct,Rt){var bt=Rt;return Le(nt,function(It,me,Pe,Be,Oe){me===0&&Rt===void 0?bt=It:bt=ct(bt,It,me,Pe,Be,Oe)}),bt}function ze(nt,ct){Le(nt,function(Rt,bt,It,me,Pe){var Be=Rt===null?null:Rt.type;switch(Be){case null:case"Point":case"LineString":case"Polygon":return ct(h.feature(Rt,It,{bbox:me,id:Pe}),bt,0)===!1?!1:void 0}var Oe;switch(Be){case"MultiPoint":Oe="Point";break;case"MultiLineString":Oe="LineString";break;case"MultiPolygon":Oe="Polygon";break}for(var Fe=0;Fe<Rt.coordinates.length;Fe++){var je=Rt.coordinates[Fe],at={type:Oe,coordinates:je};if(ct(h.feature(at,It),bt,Fe)===!1)return!1}})}function vt(nt,ct,Rt){var bt=Rt;return ze(nt,function(It,me,Pe){me===0&&Pe===0&&Rt===void 0?bt=It:bt=ct(bt,It,me,Pe)}),bt}function Dt(nt,ct){ze(nt,function(Rt,bt,It){var me=0;if(Rt.geometry){var Pe=Rt.geometry.type;if(!(Pe==="Point"||Pe==="MultiPoint")){var Be,Oe=0,Fe=0,je=0;if(v(Rt,function(at,lt,pt,Et,Ct){if(Be===void 0||bt>Oe||Et>Fe||Ct>je){Be=at,Oe=bt,Fe=Et,je=Ct,me=0;return}var on=h.lineString([Be,at],Rt.properties);if(ct(on,bt,It,Ct,me)===!1)return!1;me++,Be=at})===!1)return!1}}})}function Xt(nt,ct,Rt){var bt=Rt,It=!1;return Dt(nt,function(me,Pe,Be,Oe,Fe){It===!1&&Rt===void 0?bt=me:bt=ct(bt,me,Pe,Be,Oe,Fe),It=!0}),bt}function _n(nt,ct){if(!nt)throw new Error("geojson is required");ze(nt,function(Rt,bt,It){if(Rt.geometry!==null){var me=Rt.geometry.type,Pe=Rt.geometry.coordinates;switch(me){case"LineString":if(ct(Rt,bt,It,0,0)===!1)return!1;break;case"Polygon":for(var Be=0;Be<Pe.length;Be++)if(ct(h.lineString(Pe[Be],Rt.properties),bt,It,Be)===!1)return!1;break}}})}function Sn(nt,ct,Rt){var bt=Rt;return _n(nt,function(It,me,Pe,Be){me===0&&Rt===void 0?bt=It:bt=ct(bt,It,me,Pe,Be)}),bt}function hr(nt,ct){if(ct=ct||{},!h.isObject(ct))throw new Error("options is invalid");var Rt=ct.featureIndex||0,bt=ct.multiFeatureIndex||0,It=ct.geometryIndex||0,me=ct.segmentIndex||0,Pe=ct.properties,Be;switch(nt.type){case"FeatureCollection":Rt<0&&(Rt=nt.features.length+Rt),Pe=Pe||nt.features[Rt].properties,Be=nt.features[Rt].geometry;break;case"Feature":Pe=Pe||nt.properties,Be=nt.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Be=nt;break;default:throw new Error("geojson is invalid")}if(Be===null)return null;var Oe=Be.coordinates;switch(Be.type){case"Point":case"MultiPoint":return null;case"LineString":return me<0&&(me=Oe.length+me-1),h.lineString([Oe[me],Oe[me+1]],Pe,ct);case"Polygon":return It<0&&(It=Oe.length+It),me<0&&(me=Oe[It].length+me-1),h.lineString([Oe[It][me],Oe[It][me+1]],Pe,ct);case"MultiLineString":return bt<0&&(bt=Oe.length+bt),me<0&&(me=Oe[bt].length+me-1),h.lineString([Oe[bt][me],Oe[bt][me+1]],Pe,ct);case"MultiPolygon":return bt<0&&(bt=Oe.length+bt),It<0&&(It=Oe[bt].length+It),me<0&&(me=Oe[bt][It].length-me-1),h.lineString([Oe[bt][It][me],Oe[bt][It][me+1]],Pe,ct)}throw new Error("geojson is invalid")}function Je(nt,ct){if(ct=ct||{},!h.isObject(ct))throw new Error("options is invalid");var Rt=ct.featureIndex||0,bt=ct.multiFeatureIndex||0,It=ct.geometryIndex||0,me=ct.coordIndex||0,Pe=ct.properties,Be;switch(nt.type){case"FeatureCollection":Rt<0&&(Rt=nt.features.length+Rt),Pe=Pe||nt.features[Rt].properties,Be=nt.features[Rt].geometry;break;case"Feature":Pe=Pe||nt.properties,Be=nt.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Be=nt;break;default:throw new Error("geojson is invalid")}if(Be===null)return null;var Oe=Be.coordinates;switch(Be.type){case"Point":return h.point(Oe,Pe,ct);case"MultiPoint":return bt<0&&(bt=Oe.length+bt),h.point(Oe[bt],Pe,ct);case"LineString":return me<0&&(me=Oe.length+me),h.point(Oe[me],Pe,ct);case"Polygon":return It<0&&(It=Oe.length+It),me<0&&(me=Oe[It].length+me),h.point(Oe[It][me],Pe,ct);case"MultiLineString":return bt<0&&(bt=Oe.length+bt),me<0&&(me=Oe[bt].length+me),h.point(Oe[bt][me],Pe,ct);case"MultiPolygon":return bt<0&&(bt=Oe.length+bt),It<0&&(It=Oe[bt].length+It),me<0&&(me=Oe[bt][It].length-me),h.point(Oe[bt][It][me],Pe,ct)}throw new Error("geojson is invalid")}l.coordAll=ge,l.coordEach=v,l.coordReduce=x,l.featureEach=X,l.featureReduce=re,l.findPoint=Je,l.findSegment=hr,l.flattenEach=ze,l.flattenReduce=vt,l.geomEach=Le,l.geomReduce=Xe,l.lineEach=_n,l.lineReduce=Sn,l.propEach=E,l.propReduce=j,l.segmentEach=Dt,l.segmentReduce=Xt}),Bi=o(l=>{Object.defineProperty(l,"__esModule",{value:!0});var h=Ei();function v(x){var E=[1/0,1/0,-1/0,-1/0];return h.coordEach(x,function(j){E[0]>j[0]&&(E[0]=j[0]),E[1]>j[1]&&(E[1]=j[1]),E[2]<j[0]&&(E[2]=j[0]),E[3]<j[1]&&(E[3]=j[1])}),E}v.default=v,l.default=v}),Ri=o((l,h)=>{var v=mn(),x=Zn(),E=Ei(),j=Bi().default,X=E.featureEach;E.coordEach,x.polygon;var re=x.featureCollection;function ge(Le){var Xe=new v(Le);return Xe.insert=function(ze){if(ze.type!=="Feature")throw new Error("invalid feature");return ze.bbox=ze.bbox?ze.bbox:j(ze),v.prototype.insert.call(this,ze)},Xe.load=function(ze){var vt=[];return Array.isArray(ze)?ze.forEach(function(Dt){if(Dt.type!=="Feature")throw new Error("invalid features");Dt.bbox=Dt.bbox?Dt.bbox:j(Dt),vt.push(Dt)}):X(ze,function(Dt){if(Dt.type!=="Feature")throw new Error("invalid features");Dt.bbox=Dt.bbox?Dt.bbox:j(Dt),vt.push(Dt)}),v.prototype.load.call(this,vt)},Xe.remove=function(ze,vt){if(ze.type!=="Feature")throw new Error("invalid feature");return ze.bbox=ze.bbox?ze.bbox:j(ze),v.prototype.remove.call(this,ze,vt)},Xe.clear=function(){return v.prototype.clear.call(this)},Xe.search=function(ze){var vt=v.prototype.search.call(this,this.toBBox(ze));return re(vt)},Xe.collides=function(ze){return v.prototype.collides.call(this,this.toBBox(ze))},Xe.all=function(){var ze=v.prototype.all.call(this);return re(ze)},Xe.toJSON=function(){return v.prototype.toJSON.call(this)},Xe.fromJSON=function(ze){return v.prototype.fromJSON.call(this,ze)},Xe.toBBox=function(ze){var vt;if(ze.bbox)vt=ze.bbox;else if(Array.isArray(ze)&&ze.length===4)vt=ze;else if(Array.isArray(ze)&&ze.length===6)vt=[ze[0],ze[1],ze[3],ze[4]];else if(ze.type==="Feature")vt=j(ze);else if(ze.type==="FeatureCollection")vt=j(ze);else throw new Error("invalid geojson");return{minX:vt[0],minY:vt[1],maxX:vt[2],maxY:vt[3]}},Xe}h.exports=ge,h.exports.default=ge});Array.prototype.findIndex=Array.prototype.findIndex||function(l){if(this===null)throw new TypeError("Array.prototype.findIndex called on null or undefined");if(typeof l!="function")throw new TypeError("callback must be a function");for(var h=Object(this),v=h.length>>>0,x=arguments[1],E=0;E<v;E++)if(l.call(x,h[E],E,h))return E;return-1},Array.prototype.find=Array.prototype.find||function(l){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof l!="function")throw new TypeError("callback must be a function");for(var h=Object(this),v=h.length>>>0,x=arguments[1],E=0;E<v;E++){var j=h[E];if(l.call(x,j,E,h))return j}},typeof Object.assign!="function"&&(Object.assign=function(l){if(l==null)throw new TypeError("Cannot convert undefined or null to object");l=Object(l);for(var h=1;h<arguments.length;h++){var v=arguments[h];if(v!=null)for(var x in v)Object.prototype.hasOwnProperty.call(v,x)&&(l[x]=v[x])}return l}),function(l){l.forEach(function(h){h.hasOwnProperty("remove")||Object.defineProperty(h,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})}([Element.prototype,CharacterData.prototype,DocumentType.prototype]),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(l,h){if(this==null)throw new TypeError('"this" is null or not defined');var v=Object(this),x=v.length>>>0;if(x===0)return!1;var E=h|0,j=Math.max(E>=0?E:x-Math.abs(E),0);function X(re,ge){return re===ge||typeof re=="number"&&typeof ge=="number"&&isNaN(re)&&isNaN(ge)}for(;j<x;){if(X(v[j],l))return!0;j++}return!1}});var jo={version:"2.18.3"},cr=f(Ir()),Vn={tooltips:{placeMarker:"Click to place marker",firstVertex:"Click to place first vertex",continueLine:"Click to continue drawing",finishLine:"Click any existing marker to finish",finishPoly:"Click first marker to finish",finishRect:"Click to finish",startCircle:"Click to place circle center",finishCircle:"Click to finish circle",placeCircleMarker:"Click to place circle marker",placeText:"Click to place text",selectFirstLayerFor:"Select first layer for {action}",selectSecondLayerFor:"Select second layer for {action}"},actions:{finish:"Finish",cancel:"Cancel",removeLastVertex:"Remove Last Vertex"},buttonTitles:{drawMarkerButton:"Draw Marker",drawPolyButton:"Draw Polygons",drawLineButton:"Draw Polyline",drawCircleButton:"Draw Circle",drawRectButton:"Draw Rectangle",editButton:"Edit Layers",dragButton:"Drag Layers",cutButton:"Cut Layers",deleteButton:"Remove Layers",drawCircleMarkerButton:"Draw Circle Marker",snappingButton:"Snap dragged marker to other layers and vertices",pinningButton:"Pin shared vertices together",rotateButton:"Rotate Layers",drawTextButton:"Draw Text",scaleButton:"Scale Layers",autoTracingButton:"Auto trace Line",snapGuidesButton:"Show SnapGuides",unionButton:"Union layers",differenceButton:"Subtract layers"},measurements:{totalLength:"Length",segmentLength:"Segment length",area:"Area",radius:"Radius",perimeter:"Perimeter",height:"Height",width:"Width",coordinates:"Position",coordinatesMarker:"Position Marker"}},Ms={tooltips:{placeMarker:"Platziere den Marker mit Klick",firstVertex:"Platziere den ersten Marker mit Klick",continueLine:"Klicke, um weiter zu zeichnen",finishLine:"Beende mit Klick auf existierenden Marker",finishPoly:"Beende mit Klick auf ersten Marker",finishRect:"Beende mit Klick",startCircle:"Platziere das Kreiszentrum mit Klick",finishCircle:"Beende den Kreis mit Klick",placeCircleMarker:"Platziere den Kreismarker mit Klick",placeText:"Platziere den Text mit Klick"},actions:{finish:"Beenden",cancel:"Abbrechen",removeLastVertex:"Letzten Vertex löschen"},buttonTitles:{drawMarkerButton:"Marker zeichnen",drawPolyButton:"Polygon zeichnen",drawLineButton:"Polyline zeichnen",drawCircleButton:"Kreis zeichnen",drawRectButton:"Rechteck zeichnen",editButton:"Layer editieren",dragButton:"Layer bewegen",cutButton:"Layer schneiden",deleteButton:"Layer löschen",drawCircleMarkerButton:"Kreismarker zeichnen",snappingButton:"Bewegter Layer an andere Layer oder Vertexe einhacken",pinningButton:"Vertexe an der gleichen Position verknüpfen",rotateButton:"Layer drehen",drawTextButton:"Text zeichnen",scaleButton:"Layer skalieren",autoTracingButton:"Linie automatisch nachzeichen"},measurements:{totalLength:"Länge",segmentLength:"Segment Länge",area:"Fläche",radius:"Radius",perimeter:"Umfang",height:"Höhe",width:"Breite",coordinates:"Position",coordinatesMarker:"Position Marker"}},oi={tooltips:{placeMarker:"Clicca per posizionare un Marker",firstVertex:"Clicca per posizionare il primo vertice",continueLine:"Clicca per continuare a disegnare",finishLine:"Clicca qualsiasi marker esistente per terminare",finishPoly:"Clicca il primo marker per terminare",finishRect:"Clicca per terminare",startCircle:"Clicca per posizionare il punto centrale del cerchio",finishCircle:"Clicca per terminare il cerchio",placeCircleMarker:"Clicca per posizionare un Marker del cherchio"},actions:{finish:"Termina",cancel:"Annulla",removeLastVertex:"Rimuovi l'ultimo vertice"},buttonTitles:{drawMarkerButton:"Disegna Marker",drawPolyButton:"Disegna Poligoni",drawLineButton:"Disegna Polilinea",drawCircleButton:"Disegna Cerchio",drawRectButton:"Disegna Rettangolo",editButton:"Modifica Livelli",dragButton:"Sposta Livelli",cutButton:"Ritaglia Livelli",deleteButton:"Elimina Livelli",drawCircleMarkerButton:"Disegna Marker del Cerchio",snappingButton:"Snap ha trascinato il pennarello su altri strati e vertici",pinningButton:"Pin condiviso vertici insieme",rotateButton:"Ruota livello"}},Ai={tooltips:{placeMarker:"Klik untuk menempatkan marker",firstVertex:"Klik untuk menempatkan vertex pertama",continueLine:"Klik untuk meneruskan digitasi",finishLine:"Klik pada sembarang marker yang ada untuk mengakhiri",finishPoly:"Klik marker pertama untuk mengakhiri",finishRect:"Klik untuk mengakhiri",startCircle:"Klik untuk menempatkan titik pusat lingkaran",finishCircle:"Klik untuk mengakhiri lingkaran",placeCircleMarker:"Klik untuk menempatkan penanda lingkarann"},actions:{finish:"Selesai",cancel:"Batal",removeLastVertex:"Hilangkan Vertex Terakhir"},buttonTitles:{drawMarkerButton:"Digitasi Marker",drawPolyButton:"Digitasi Polygon",drawLineButton:"Digitasi Polyline",drawCircleButton:"Digitasi Lingkaran",drawRectButton:"Digitasi Segi Empat",editButton:"Edit Layer",dragButton:"Geser Layer",cutButton:"Potong Layer",deleteButton:"Hilangkan Layer",drawCircleMarkerButton:"Digitasi Penanda Lingkaran",snappingButton:"Jepretkan penanda yang ditarik ke lapisan dan simpul lain",pinningButton:"Sematkan simpul bersama bersama",rotateButton:"Putar lapisan"}},ci={tooltips:{placeMarker:"Adaugă un punct",firstVertex:"Apasă aici pentru a adăuga primul Vertex",continueLine:"Apasă aici pentru a continua desenul",finishLine:"Apasă pe orice obiect pentru a finisa desenul",finishPoly:"Apasă pe primul obiect pentru a finisa",finishRect:"Apasă pentru a finisa",startCircle:"Apasă pentru a desena un cerc",finishCircle:"Apasă pentru a finisa un cerc",placeCircleMarker:"Adaugă un punct"},actions:{finish:"Termină",cancel:"Anulează",removeLastVertex:"Șterge ultimul Vertex"},buttonTitles:{drawMarkerButton:"Adaugă o bulină",drawPolyButton:"Desenează un poligon",drawLineButton:"Desenează o linie",drawCircleButton:"Desenează un cerc",drawRectButton:"Desenează un dreptunghi",editButton:"Editează straturile",dragButton:"Mută straturile",cutButton:"Taie straturile",deleteButton:"Șterge straturile",drawCircleMarkerButton:"Desenează marcatorul cercului",snappingButton:"Fixați marcatorul glisat pe alte straturi și vârfuri",pinningButton:"Fixați vârfurile partajate împreună",rotateButton:"Rotiți stratul"}},Cn={tooltips:{placeMarker:"Нажмите, чтобы нанести маркер",firstVertex:"Нажмите, чтобы нанести первый объект",continueLine:"Нажмите, чтобы продолжить рисование",finishLine:"Нажмите любой существующий маркер для завершения",finishPoly:"Выберите первую точку, чтобы закончить",finishRect:"Нажмите, чтобы закончить",startCircle:"Нажмите, чтобы добавить центр круга",finishCircle:"Нажмите, чтобы задать радиус",placeCircleMarker:"Нажмите, чтобы нанести круговой маркер"},actions:{finish:"Завершить",cancel:"Отменить",removeLastVertex:"Отменить последнее действие"},buttonTitles:{drawMarkerButton:"Добавить маркер",drawPolyButton:"Рисовать полигон",drawLineButton:"Рисовать кривую",drawCircleButton:"Рисовать круг",drawRectButton:"Рисовать прямоугольник",editButton:"Редактировать слой",dragButton:"Перенести слой",cutButton:"Вырезать слой",deleteButton:"Удалить слой",drawCircleMarkerButton:"Добавить круговой маркер",snappingButton:"Привязать перетаскиваемый маркер к другим слоям и вершинам",pinningButton:"Связать общие точки вместе",rotateButton:"Поворот слоя"}},cn={tooltips:{placeMarker:"Presiona para colocar un marcador",firstVertex:"Presiona para colocar el primer vértice",continueLine:"Presiona para continuar dibujando",finishLine:"Presiona cualquier marcador existente para finalizar",finishPoly:"Presiona el primer marcador para finalizar",finishRect:"Presiona para finalizar",startCircle:"Presiona para colocar el centro del círculo",finishCircle:"Presiona para finalizar el círculo",placeCircleMarker:"Presiona para colocar un marcador de círculo"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Eliminar último vértice"},buttonTitles:{drawMarkerButton:"Dibujar Marcador",drawPolyButton:"Dibujar Polígono",drawLineButton:"Dibujar Línea",drawCircleButton:"Dibujar Círculo",drawRectButton:"Dibujar Rectángulo",editButton:"Editar Capas",dragButton:"Arrastrar Capas",cutButton:"Cortar Capas",deleteButton:"Eliminar Capas",drawCircleMarkerButton:"Dibujar Marcador de Círculo",snappingButton:"El marcador de Snap arrastrado a otras capas y vértices",pinningButton:"Fijar juntos los vértices compartidos",rotateButton:"Rotar capa"}},fr={tooltips:{placeMarker:"Klik om een marker te plaatsen",firstVertex:"Klik om het eerste punt te plaatsen",continueLine:"Klik om te blijven tekenen",finishLine:"Klik op een bestaand punt om te beëindigen",finishPoly:"Klik op het eerst punt om te beëindigen",finishRect:"Klik om te beëindigen",startCircle:"Klik om het middelpunt te plaatsen",finishCircle:"Klik om de cirkel te beëindigen",placeCircleMarker:"Klik om een marker te plaatsen"},actions:{finish:"Bewaar",cancel:"Annuleer",removeLastVertex:"Verwijder laatste punt"},buttonTitles:{drawMarkerButton:"Plaats Marker",drawPolyButton:"Teken een vlak",drawLineButton:"Teken een lijn",drawCircleButton:"Teken een cirkel",drawRectButton:"Teken een vierkant",editButton:"Bewerk",dragButton:"Verplaats",cutButton:"Knip",deleteButton:"Verwijder",drawCircleMarkerButton:"Plaats Marker",snappingButton:"Snap gesleepte marker naar andere lagen en hoekpunten",pinningButton:"Speld gedeelde hoekpunten samen",rotateButton:"Laag roteren"}},eo={tooltips:{placeMarker:"Cliquez pour placer un marqueur",firstVertex:"Cliquez pour placer le premier sommet",continueLine:"Cliquez pour continuer à dessiner",finishLine:"Cliquez sur n'importe quel marqueur pour terminer",finishPoly:"Cliquez sur le premier marqueur pour terminer",finishRect:"Cliquez pour terminer",startCircle:"Cliquez pour placer le centre du cercle",finishCircle:"Cliquez pour finir le cercle",placeCircleMarker:"Cliquez pour placer le marqueur circulaire"},actions:{finish:"Terminer",cancel:"Annuler",removeLastVertex:"Retirer le dernier sommet"},buttonTitles:{drawMarkerButton:"Placer des marqueurs",drawPolyButton:"Dessiner des polygones",drawLineButton:"Dessiner des polylignes",drawCircleButton:"Dessiner un cercle",drawRectButton:"Dessiner un rectangle",editButton:"Éditer des calques",dragButton:"Déplacer des calques",cutButton:"Couper des calques",deleteButton:"Supprimer des calques",drawCircleMarkerButton:"Dessiner un marqueur circulaire",snappingButton:"Glisser le marqueur vers d'autres couches et sommets",pinningButton:"Épingler ensemble les sommets partagés",rotateButton:"Tourner des calques"}},Ao={tooltips:{placeMarker:"单击放置标记",firstVertex:"单击放置首个顶点",continueLine:"单击继续绘制",finishLine:"单击任何存在的标记以完成",finishPoly:"单击第一个标记以完成",finishRect:"单击完成",startCircle:"单击放置圆心",finishCircle:"单击完成圆形",placeCircleMarker:"点击放置圆形标记"},actions:{finish:"完成",cancel:"取消",removeLastVertex:"移除最后的顶点"},buttonTitles:{drawMarkerButton:"绘制标记",drawPolyButton:"绘制多边形",drawLineButton:"绘制线段",drawCircleButton:"绘制圆形",drawRectButton:"绘制长方形",editButton:"编辑图层",dragButton:"拖拽图层",cutButton:"剪切图层",deleteButton:"删除图层",drawCircleMarkerButton:"画圆圈标记",snappingButton:"将拖动的标记捕捉到其他图层和顶点",pinningButton:"将共享顶点固定在一起",rotateButton:"旋转图层"}},_o={tooltips:{placeMarker:"單擊放置標記",firstVertex:"單擊放置第一個頂點",continueLine:"單擊繼續繪製",finishLine:"單擊任何存在的標記以完成",finishPoly:"單擊第一個標記以完成",finishRect:"單擊完成",startCircle:"單擊放置圓心",finishCircle:"單擊完成圓形",placeCircleMarker:"點擊放置圓形標記"},actions:{finish:"完成",cancel:"取消",removeLastVertex:"移除最後一個頂點"},buttonTitles:{drawMarkerButton:"放置標記",drawPolyButton:"繪製多邊形",drawLineButton:"繪製線段",drawCircleButton:"繪製圓形",drawRectButton:"繪製方形",editButton:"編輯圖形",dragButton:"移動圖形",cutButton:"裁切圖形",deleteButton:"刪除圖形",drawCircleMarkerButton:"畫圓圈標記",snappingButton:"將拖動的標記對齊到其他圖層和頂點",pinningButton:"將共享頂點固定在一起",rotateButton:"旋轉圖形"}},za={tooltips:{placeMarker:"Clique para posicionar o marcador",firstVertex:"Clique para posicionar o primeiro vértice",continueLine:"Clique para continuar desenhando",finishLine:"Clique em qualquer marcador existente para finalizar",finishPoly:"Clique no primeiro marcador para finalizar",finishRect:"Clique para finalizar",startCircle:"Clique para posicionar o centro do círculo",finishCircle:"Clique para finalizar o círculo",placeCircleMarker:"Clique para posicionar o marcador circular",placeText:"Clique para inserir texto"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Remover último vértice"},buttonTitles:{drawMarkerButton:"Desenhar Marcador",drawPolyButton:"Desenhar Polígonos",drawLineButton:"Desenhar Linha Poligonal",drawCircleButton:"Desenhar Círculo",drawRectButton:"Desenhar Retângulo",editButton:"Editar Camadas",dragButton:"Arrastar Camadas",cutButton:"Recortar Camadas",deleteButton:"Remover Camadas",drawCircleMarkerButton:"Desenhar Marcador de Círculo",snappingButton:"Ajustar marcador arrastado a outras camadas e vértices",pinningButton:"Unir vértices compartilhados",rotateButton:"Rotacionar Camadas",drawTextButton:"Desenhar Texto",scaleButton:"Redimensionar Camadas",autoTracingButton:"Traçado Automático de Linha"},measurements:{totalLength:"Comprimento",segmentLength:"Comprimento do Segmento",area:"Área",radius:"Raio",perimeter:"Perímetro",height:"Altura",width:"Largura",coordinates:"Posição",coordinatesMarker:"Marcador de Posição"}},Qo={tooltips:{placeMarker:"Clique para colocar marcador",firstVertex:"Clique para colocar primeiro vértice",continueLine:"Clique para continuar a desenhar",finishLine:"Clique num marcador existente para terminar",finishPoly:"Clique no primeiro marcador para terminar",finishRect:"Clique para terminar",startCircle:"Clique para colocar o centro do círculo",finishCircle:"Clique para terminar o círculo",placeCircleMarker:"Clique para colocar marcador de círculo",placeText:"Clique para colocar texto"},actions:{finish:"Terminar",cancel:"Cancelar",removeLastVertex:"Remover Último Vértice"},buttonTitles:{drawMarkerButton:"Desenhar Marcador",drawPolyButton:"Desenhar Polígonos",drawLineButton:"Desenhar Polilinha",drawCircleButton:"Desenhar Círculo",drawRectButton:"Desenhar Retângulo",editButton:"Editar Camadas",dragButton:"Arrastar Camadas",cutButton:"Cortar Camadas",deleteButton:"Remover Camadas",drawCircleMarkerButton:"Desenhar Marcador de Círculo",snappingButton:"Ajustar marcador arrastado a outras camadas e vértices",pinningButton:"Unir vértices partilhados",rotateButton:"Rodar Camadas",drawTextButton:"Desenhar Texto",scaleButton:"Escalar Camadas",autoTracingButton:"Traçado Automático de Linha"},measurements:{totalLength:"Comprimento",segmentLength:"Comprimento do Segmento",area:"Área",radius:"Raio",perimeter:"Perímetro",height:"Altura",width:"Largura",coordinates:"Posição",coordinatesMarker:"Marcador de Posição"}},il={tooltips:{placeMarker:"Kliknij, aby umieścić znacznik",firstVertex:"Kliknij, aby umieścić pierwszy wierzchołek",continueLine:"Kliknij, aby kontynuować rysowanie",finishLine:"Kliknij dowolny istniejący znacznik, aby zakończyć",finishPoly:"Kliknij pierwszy znacznik, aby zakończyć",finishRect:"Kliknij, aby zakończyć",startCircle:"Kliknij, aby umieścić środek okręgu",finishCircle:"Kliknij, aby zakończyć okrąg",placeCircleMarker:"Kliknij, aby umieścić znacznik okręgu",placeText:"Kliknij, aby umieścić tekst"},actions:{finish:"Zakończ",cancel:"Anuluj",removeLastVertex:"Usuń ostatni wierzchołek"},buttonTitles:{drawMarkerButton:"Rysuj znacznik",drawPolyButton:"Rysuj wielokąt",drawLineButton:"Rysuj linię",drawCircleButton:"Rysuj okrąg",drawRectButton:"Rysuj prostokąt",editButton:"Edytuj warstwy",dragButton:"Przeciągnij warstwy",cutButton:"Wytnij warstwy",deleteButton:"Usuń warstwy",drawCircleMarkerButton:"Rysuj znacznik okrągły",snappingButton:"Przyciągnij przenoszony znacznik do innych warstw i wierzchołków",pinningButton:"Przypnij wspólne wierzchołki razem",rotateButton:"Obróć warstwy",drawTextButton:"Rysuj tekst",scaleButton:"Skaluj warstwy",autoTracingButton:"Automatyczne śledzenie linii"},measurements:{totalLength:"Długość",segmentLength:"Długość odcinka",area:"Obszar",radius:"Promień",perimeter:"Obwód",height:"Wysokość",width:"Szerokość",coordinates:"Pozycja",coordinatesMarker:"Znacznik pozycji"}},jr={tooltips:{placeMarker:"Klicka för att placera markör",firstVertex:"Klicka för att placera första hörnet",continueLine:"Klicka för att fortsätta rita",finishLine:"Klicka på en existerande punkt för att slutföra",finishPoly:"Klicka på den första punkten för att slutföra",finishRect:"Klicka för att slutföra",startCircle:"Klicka för att placera cirkelns centrum",finishCircle:"Klicka för att slutföra cirkeln",placeCircleMarker:"Klicka för att placera cirkelmarkör"},actions:{finish:"Slutför",cancel:"Avbryt",removeLastVertex:"Ta bort sista hörnet"},buttonTitles:{drawMarkerButton:"Rita Markör",drawPolyButton:"Rita Polygoner",drawLineButton:"Rita Linje",drawCircleButton:"Rita Cirkel",drawRectButton:"Rita Rektangel",editButton:"Redigera Lager",dragButton:"Dra Lager",cutButton:"Klipp i Lager",deleteButton:"Ta bort Lager",drawCircleMarkerButton:"Rita Cirkelmarkör",snappingButton:"Snäpp dra markören till andra lager och hörn",pinningButton:"Fäst delade hörn tillsammans",rotateButton:"Rotera lagret"}},As={tooltips:{placeMarker:"Κάντε κλικ για να τοποθετήσετε Δείκτη",firstVertex:"Κάντε κλικ για να τοποθετήσετε το πρώτο σημείο",continueLine:"Κάντε κλικ για να συνεχίσετε να σχεδιάζετε",finishLine:"Κάντε κλικ σε οποιονδήποτε υπάρχον σημείο για να ολοκληρωθεί",finishPoly:"Κάντε κλικ στο πρώτο σημείο για να τελειώσετε",finishRect:"Κάντε κλικ για να τελειώσετε",startCircle:"Κάντε κλικ για να τοποθετήσετε κέντρο Κύκλου",finishCircle:"Κάντε κλικ για να ολοκληρώσετε τον Κύκλο",placeCircleMarker:"Κάντε κλικ για να τοποθετήσετε Κυκλικό Δείκτη"},actions:{finish:"Τέλος",cancel:"Ακύρωση",removeLastVertex:"Κατάργηση τελευταίου σημείου"},buttonTitles:{drawMarkerButton:"Σχεδίαση Δείκτη",drawPolyButton:"Σχεδίαση Πολυγώνου",drawLineButton:"Σχεδίαση Γραμμής",drawCircleButton:"Σχεδίαση Κύκλου",drawRectButton:"Σχεδίαση Ορθογωνίου",editButton:"Επεξεργασία Επιπέδων",dragButton:"Μεταφορά Επιπέδων",cutButton:"Αποκοπή Επιπέδων",deleteButton:"Κατάργηση Επιπέδων",drawCircleMarkerButton:"Σχεδίαση Κυκλικού Δείκτη",snappingButton:"Προσκόλληση του Δείκτη μεταφοράς σε άλλα Επίπεδα και Κορυφές",pinningButton:"Περικοπή κοινών κορυφών μαζί",rotateButton:"Περιστρέψτε το στρώμα"}},lo={tooltips:{placeMarker:"Kattintson a jelölő elhelyezéséhez",firstVertex:"Kattintson az első pont elhelyezéséhez",continueLine:"Kattintson a következő pont elhelyezéséhez",finishLine:"A befejezéshez kattintson egy meglévő pontra",finishPoly:"A befejezéshez kattintson az első pontra",finishRect:"Kattintson a befejezéshez",startCircle:"Kattintson a kör középpontjának elhelyezéséhez",finishCircle:"Kattintson a kör befejezéséhez",placeCircleMarker:"Kattintson a körjelölő elhelyezéséhez"},actions:{finish:"Befejezés",cancel:"Mégse",removeLastVertex:"Utolsó pont eltávolítása"},buttonTitles:{drawMarkerButton:"Jelölő rajzolása",drawPolyButton:"Poligon rajzolása",drawLineButton:"Vonal rajzolása",drawCircleButton:"Kör rajzolása",drawRectButton:"Négyzet rajzolása",editButton:"Elemek szerkesztése",dragButton:"Elemek mozgatása",cutButton:"Elemek vágása",deleteButton:"Elemek törlése",drawCircleMarkerButton:"Kör jelölő rajzolása",snappingButton:"Kapcsolja a jelöltőt másik elemhez vagy ponthoz",pinningButton:"Közös pontok összekötése",rotateButton:"Fólia elforgatása"}},es={tooltips:{placeMarker:"Tryk for at placere en markør",firstVertex:"Tryk for at placere det første punkt",continueLine:"Tryk for at fortsætte linjen",finishLine:"Tryk på et eksisterende punkt for at afslutte",finishPoly:"Tryk på det første punkt for at afslutte",finishRect:"Tryk for at afslutte",startCircle:"Tryk for at placere cirklens center",finishCircle:"Tryk for at afslutte cirklen",placeCircleMarker:"Tryk for at placere en cirkelmarkør"},actions:{finish:"Afslut",cancel:"Afbryd",removeLastVertex:"Fjern sidste punkt"},buttonTitles:{drawMarkerButton:"Placer markør",drawPolyButton:"Tegn polygon",drawLineButton:"Tegn linje",drawCircleButton:"Tegn cirkel",drawRectButton:"Tegn firkant",editButton:"Rediger",dragButton:"Træk",cutButton:"Klip",deleteButton:"Fjern",drawCircleMarkerButton:"Tegn cirkelmarkør",snappingButton:"Fastgør trukket markør til andre elementer",pinningButton:"Sammenlæg delte elementer",rotateButton:"Roter laget"}},Fi={tooltips:{placeMarker:"Klikk for å plassere punkt",firstVertex:"Klikk for å plassere første punkt",continueLine:"Klikk for å tegne videre",finishLine:"Klikk på et eksisterende punkt for å fullføre",finishPoly:"Klikk første punkt for å fullføre",finishRect:"Klikk for å fullføre",startCircle:"Klikk for å sette sirkel midtpunkt",finishCircle:"Klikk for å fullføre sirkel",placeCircleMarker:"Klikk for å plassere sirkel",placeText:"Klikk for å plassere tekst"},actions:{finish:"Fullfør",cancel:"Kanseller",removeLastVertex:"Fjern forrige punkt"},buttonTitles:{drawMarkerButton:"Tegn punkt",drawPolyButton:"Tegn flate",drawLineButton:"Tegn linje",drawCircleButton:"Tegn sirkel",drawRectButton:"Tegn rektangel",editButton:"Rediger objekter",dragButton:"Dra objekter",cutButton:"Kutt objekter",deleteButton:"Fjern objekter",drawCircleMarkerButton:"Tegn sirkel-punkt",snappingButton:"Fest dratt punkt til andre objekter og punkt",pinningButton:"Pin delte punkter sammen",rotateButton:"Rotér objekter",drawTextButton:"Tegn tekst",scaleButton:"Skalér objekter",autoTracingButton:"Automatisk sporing av linje"},measurements:{totalLength:"Lengde",segmentLength:"Segmentlengde",area:"Område",radius:"Radius",perimeter:"Omriss",height:"Høyde",width:"Bredde",coordinates:"Posisjon",coordinatesMarker:"Posisjonsmarkør"}},Pl={tooltips:{placeMarker:"کلیک برای جانمایی نشان",firstVertex:"کلیک برای رسم اولین رأس",continueLine:"کلیک برای ادامه رسم",finishLine:"کلیک روی هر نشان موجود برای پایان",finishPoly:"کلیک روی اولین نشان برای پایان",finishRect:"کلیک برای پایان",startCircle:"کلیک برای رسم مرکز دایره",finishCircle:"کلیک برای پایان رسم دایره",placeCircleMarker:"کلیک برای رسم نشان دایره",placeText:"کلیک برای نوشتن متن"},actions:{finish:"پایان",cancel:"لفو",removeLastVertex:"حذف آخرین رأس"},buttonTitles:{drawMarkerButton:"درج نشان",drawPolyButton:"رسم چندضلعی",drawLineButton:"رسم خط",drawCircleButton:"رسم دایره",drawRectButton:"رسم چهارضلعی",editButton:"ویرایش لایه‌ها",dragButton:"جابجایی لایه‌ها",cutButton:"برش لایه‌ها",deleteButton:"حذف لایه‌ها",drawCircleMarkerButton:"رسم نشان دایره",snappingButton:"نشانگر را به لایه‌ها و رئوس دیگر بکشید",pinningButton:"رئوس مشترک را با هم پین کنید",rotateButton:"چرخش لایه",drawTextButton:"رسم متن",scaleButton:"مقیاس‌گذاری",autoTracingButton:"ردیاب خودکار"},measurements:{totalLength:"طول",segmentLength:"طول بخش",area:"ناحیه",radius:"شعاع",perimeter:"محیط",height:"ارتفاع",width:"عرض",coordinates:"موقعیت",coordinatesMarker:"موقعیت نشان"}},$a={tooltips:{placeMarker:"Натисніть, щоб нанести маркер",firstVertex:"Натисніть, щоб нанести першу вершину",continueLine:"Натисніть, щоб продовжити малювати",finishLine:"Натисніть будь-який існуючий маркер для завершення",finishPoly:"Виберіть перший маркер, щоб завершити",finishRect:"Натисніть, щоб завершити",startCircle:"Натисніть, щоб додати центр кола",finishCircle:"Натисніть, щоб завершити коло",placeCircleMarker:"Натисніть, щоб нанести круговий маркер"},actions:{finish:"Завершити",cancel:"Відмінити",removeLastVertex:"Видалити попередню вершину"},buttonTitles:{drawMarkerButton:"Малювати маркер",drawPolyButton:"Малювати полігон",drawLineButton:"Малювати криву",drawCircleButton:"Малювати коло",drawRectButton:"Малювати прямокутник",editButton:"Редагувати шари",dragButton:"Перенести шари",cutButton:"Вирізати шари",deleteButton:"Видалити шари",drawCircleMarkerButton:"Малювати круговий маркер",snappingButton:"Прив’язати перетягнутий маркер до інших шарів та вершин",pinningButton:"Зв'язати спільні вершини разом",rotateButton:"Повернути шар"}},vr={tooltips:{placeMarker:"İşaretçi yerleştirmek için tıklayın",firstVertex:"İlk tepe noktasını yerleştirmek için tıklayın",continueLine:"Çizime devam etmek için tıklayın",finishLine:"Bitirmek için mevcut herhangi bir işaretçiyi tıklayın",finishPoly:"Bitirmek için ilk işaretçiyi tıklayın",finishRect:"Bitirmek için tıklayın",startCircle:"Daire merkezine yerleştirmek için tıklayın",finishCircle:"Daireyi bitirmek için tıklayın",placeCircleMarker:"Daire işaretçisi yerleştirmek için tıklayın"},actions:{finish:"Bitir",cancel:"İptal",removeLastVertex:"Son köşeyi kaldır"},buttonTitles:{drawMarkerButton:"Çizim İşaretçisi",drawPolyButton:"Çokgenler çiz",drawLineButton:"Çoklu çizgi çiz",drawCircleButton:"Çember çiz",drawRectButton:"Dikdörtgen çiz",editButton:"Katmanları düzenle",dragButton:"Katmanları sürükle",cutButton:"Katmanları kes",deleteButton:"Katmanları kaldır",drawCircleMarkerButton:"Daire işaretçisi çiz",snappingButton:"Sürüklenen işaretçiyi diğer katmanlara ve köşelere yapıştır",pinningButton:"Paylaşılan köşeleri birbirine sabitle",rotateButton:"Katmanı döndür"}},yr={tooltips:{placeMarker:"Kliknutím vytvoříte značku",firstVertex:"Kliknutím vytvoříte první objekt",continueLine:"Kliknutím pokračujte v kreslení",finishLine:"Kliknutí na libovolnou existující značku pro dokončení",finishPoly:"Vyberte první bod pro dokončení",finishRect:"Klikněte pro dokončení",startCircle:"Kliknutím přidejte střed kruhu",finishCircle:"Нажмите, чтобы задать радиус",placeCircleMarker:"Kliknutím nastavte poloměr"},actions:{finish:"Dokončit",cancel:"Zrušit",removeLastVertex:"Zrušit poslední akci"},buttonTitles:{drawMarkerButton:"Přidat značku",drawPolyButton:"Nakreslit polygon",drawLineButton:"Nakreslit křivku",drawCircleButton:"Nakreslit kruh",drawRectButton:"Nakreslit obdélník",editButton:"Upravit vrstvu",dragButton:"Přeneste vrstvu",cutButton:"Vyjmout vrstvu",deleteButton:"Smazat vrstvu",drawCircleMarkerButton:"Přidat kruhovou značku",snappingButton:"Navázat tažnou značku k dalším vrstvám a vrcholům",pinningButton:"Spojit společné body dohromady",rotateButton:"Otočte vrstvu"}},ts={tooltips:{placeMarker:"クリックしてマーカーを配置",firstVertex:"クリックして最初の頂点を配置",continueLine:"クリックして描画を続ける",finishLine:"任意のマーカーをクリックして終了",finishPoly:"最初のマーカーをクリックして終了",finishRect:"クリックして終了",startCircle:"クリックして円の中心を配置",finishCircle:"クリックして円の描画を終了",placeCircleMarker:"クリックして円マーカーを配置",placeText:"クリックしてテキストを配置"},actions:{finish:"終了",cancel:"キャンセル",removeLastVertex:"最後の頂点を削除"},buttonTitles:{drawMarkerButton:"マーカーを描画",drawPolyButton:"ポリゴンを描画",drawLineButton:"折れ線を描画",drawCircleButton:"円を描画",drawRectButton:"矩形を描画",editButton:"レイヤーを編集",dragButton:"レイヤーをドラッグ",cutButton:"レイヤーを切り取り",deleteButton:"レイヤーを削除",drawCircleMarkerButton:"円マーカーを描画",snappingButton:"ドラッグしたマーカーを他のレイヤーや頂点にスナップする",pinningButton:"共有する頂点を同時に動かす",rotateButton:"レイヤーを回転",drawTextButton:"テキストを描画"}},zr={tooltips:{placeMarker:"Klikkaa asettaaksesi merkin",firstVertex:"Klikkaa asettaakseni ensimmäisen osuuden",continueLine:"Klikkaa jatkaaksesi piirtämistä",finishLine:"Klikkaa olemassa olevaa merkkiä lopettaaksesi",finishPoly:"Klikkaa ensimmäistä merkkiä lopettaaksesi",finishRect:"Klikkaa lopettaaksesi",startCircle:"Klikkaa asettaaksesi ympyrän keskipisteen",finishCircle:"Klikkaa lopettaaksesi ympyrän",placeCircleMarker:"Klikkaa asettaaksesi ympyrämerkin",placeText:"Klikkaa asettaaksesi tekstin"},actions:{finish:"Valmis",cancel:"Peruuta",removeLastVertex:"Poista viimeinen osuus"},buttonTitles:{drawMarkerButton:"Piirrä merkkejä",drawPolyButton:"Piirrä monikulmioita",drawLineButton:"Piirrä viivoja",drawCircleButton:"Piirrä ympyrä",drawRectButton:"Piirrä neliskulmioita",editButton:"Muokkaa",dragButton:"Siirrä",cutButton:"Leikkaa",deleteButton:"Poista",drawCircleMarkerButton:"Piirrä ympyrämerkki",snappingButton:"Kiinnitä siirrettävä merkki toisiin muotoihin",pinningButton:"Kiinnitä jaetut muodot yhteen",rotateButton:"Käännä",drawTextButton:"Piirrä tekstiä"}},Ml={tooltips:{placeMarker:"마커 위치를 클릭하세요",firstVertex:"첫번째 꼭지점 위치을 클릭하세요",continueLine:"계속 그리려면 클릭하세요",finishLine:"끝내려면 기존 마커를 클릭하세요",finishPoly:"끝내려면 처음 마커를 클릭하세요",finishRect:"끝내려면 클릭하세요",startCircle:"원의 중심이 될 위치를 클릭하세요",finishCircle:"원을 끝내려면 클릭하세요",placeCircleMarker:"원 마커 위치를 클릭하세요",placeText:"텍스트 위치를 클릭하세요"},actions:{finish:"끝내기",cancel:"취소",removeLastVertex:"마지막 꼭지점 제거"},buttonTitles:{drawMarkerButton:"마커 그리기",drawPolyButton:"다각형 그리기",drawLineButton:"다각선 그리기",drawCircleButton:"원 그리기",drawRectButton:"직사각형 그리기",editButton:"레이어 편집하기",dragButton:"레이어 끌기",cutButton:"레이어 자르기",deleteButton:"레이어 제거하기",drawCircleMarkerButton:"원 마커 그리기",snappingButton:"잡아끈 마커를 다른 레이어 및 꼭지점에 들러붙게 하기",pinningButton:"공유 꼭지점을 함께 찍기",rotateButton:"레이어 회전하기",drawTextButton:"텍스트 그리기"}},fi={tooltips:{placeMarker:"Маркерди жайгаштыруу үчүн басыңыз",firstVertex:"Биринчи чокуну жайгаштырууну үчүн басыңыз",continueLine:"Сүрөт тартууну улантуу үчүн басыңыз",finishLine:"Аяктоо үчүн учурдагы маркерди басыңыз",finishPoly:"Бүтүрүү үчүн биринчи маркерди басыңыз",finishRect:"Бүтүрүү үчүн басыңыз",startCircle:"Айлананын борборун жайгаштырууну үчүн басыңыз",finishCircle:"Айлананы бүтүрүү үчүн басыңыз",placeCircleMarker:"Тегерек маркерди жайгаштыруу үчүн басыңыз",placeText:"Текстти жайгаштыруу үчүн басыңыз"},actions:{finish:"Аягы",cancel:"Жок кылуу",removeLastVertex:"Акыркы чокуну өчүрүү"},buttonTitles:{drawMarkerButton:"Маркерди чизуу",drawPolyButton:"Полигон чизуу",drawLineButton:"Полилиния чизуу",drawCircleButton:"Дайынды чизуу",drawRectButton:"Прямоугольник чизуу",editButton:"Слоопту түзөтүү",dragButton:"Слоопту карап сүйлөү",cutButton:"Слооптун башын кесүү",deleteButton:"Слооптун өчүрүү",drawCircleMarkerButton:"Дайынды маркерди чизуу",snappingButton:"Башка слооптордун жана вертекстердин арасына чекилдөө",pinningButton:"Бөлүшкөн вертекстерди бирге тутуштуруу",rotateButton:"Слооптун өзгөртүү",drawTextButton:"Текст чизуу",scaleButton:"Слооптун өлчөмүн өзгөртүү",autoTracingButton:"Автоматтык тизмеги чизуу"},measurements:{totalLength:"Узундук",segmentLength:"Сегмент узундугу",area:"Аймак",radius:"Радиус",perimeter:"Периметр",height:"Диаметр",width:"Кенчилик",coordinates:"Координаттар",coordinatesMarker:"Маркердин координаттары"}},ns=Qo,to={en:Vn,de:Ms,it:oi,id:Ai,ro:ci,ru:Cn,es:cn,nl:fr,fr:eo,pt:ns,pt_br:za,pt_pt:Qo,zh:Ao,zh_tw:_o,pl:il,sv:jr,el:As,hu:lo,da:es,no:Fi,fa:Pl,ua:$a,tr:vr,cz:yr,ja:ts,fi:zr,ko:Ml,ky:fi},Ua={_globalEditModeEnabled:!1,enableGlobalEditMode(l){let h={...l};this._globalEditModeEnabled=!0,this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),L.PM.Utils.findLayers(this.map).forEach(v=>{this._isRelevantForEdit(v)&&v.pm.enable(h)}),this.throttledReInitEdit||(this.throttledReInitEdit=L.Util.throttle(this.handleLayerAdditionInGlobalEditMode,100,this)),this._addedLayersEdit={},this.map.on("layeradd",this._layerAddedEdit,this),this.map.on("layeradd",this.throttledReInitEdit,this),this._fireGlobalEditModeToggled(!0)},disableGlobalEditMode(){this._globalEditModeEnabled=!1,L.PM.Utils.findLayers(this.map).forEach(l=>{l.pm.disable()}),this.map.off("layeradd",this._layerAddedEdit,this),this.map.off("layeradd",this.throttledReInitEdit,this),this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),this._fireGlobalEditModeToggled(!1)},globalEditEnabled(){return this.globalEditModeEnabled()},globalEditModeEnabled(){return this._globalEditModeEnabled},toggleGlobalEditMode(l=this.globalOptions){this.globalEditModeEnabled()?this.disableGlobalEditMode():this.enableGlobalEditMode(l)},handleLayerAdditionInGlobalEditMode(){let l=this._addedLayersEdit;if(this._addedLayersEdit={},this.globalEditModeEnabled())for(let h in l){let v=l[h];this._isRelevantForEdit(v)&&v.pm.enable({...this.globalOptions})}},_layerAddedEdit({layer:l}){this._addedLayersEdit[L.stamp(l)]=l},_isRelevantForEdit(l){return l.pm&&!(l instanceof L.LayerGroup)&&(!L.PM.optIn&&!l.options.pmIgnore||L.PM.optIn&&l.options.pmIgnore===!1)&&!l._pmTempLayer&&l.pm.options.allowEditing}},wu=Ua,Al={_globalDragModeEnabled:!1,enableGlobalDragMode(){let l=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!0,this._addedLayersDrag={},l.forEach(h=>{this._isRelevantForDrag(h)&&h.pm.enableLayerDrag()}),this.throttledReInitDrag||(this.throttledReInitDrag=L.Util.throttle(this.reinitGlobalDragMode,100,this)),this.map.on("layeradd",this._layerAddedDrag,this),this.map.on("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!0)},disableGlobalDragMode(){let l=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!1,l.forEach(h=>{h.pm.disableLayerDrag()}),this.map.off("layeradd",this._layerAddedDrag,this),this.map.off("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!1)},globalDragModeEnabled(){return!!this._globalDragModeEnabled},toggleGlobalDragMode(){this.globalDragModeEnabled()?this.disableGlobalDragMode():this.enableGlobalDragMode()},reinitGlobalDragMode(){let l=this._addedLayersDrag;if(this._addedLayersDrag={},this.globalDragModeEnabled())for(let h in l){let v=l[h];this._isRelevantForDrag(v)&&v.pm.enableLayerDrag()}},_layerAddedDrag({layer:l}){this._addedLayersDrag[L.stamp(l)]=l},_isRelevantForDrag(l){return l.pm&&!(l instanceof L.LayerGroup)&&(!L.PM.optIn&&!l.options.pmIgnore||L.PM.optIn&&l.options.pmIgnore===!1)&&!l._pmTempLayer&&l.pm.options.draggable}},Er=Al,Hr={_globalRemovalModeEnabled:!1,enableGlobalRemovalMode(){this._globalRemovalModeEnabled=!0,this.map.eachLayer(l=>{this._isRelevantForRemoval(l)&&(l.pm.enabled()&&l.pm.disable(),l.on("click",this.removeLayer,this))}),this.throttledReInitRemoval||(this.throttledReInitRemoval=L.Util.throttle(this.handleLayerAdditionInGlobalRemovalMode,100,this)),this._addedLayersRemoval={},this.map.on("layeradd",this._layerAddedRemoval,this),this.map.on("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!0)},disableGlobalRemovalMode(){this._globalRemovalModeEnabled=!1,this.map.eachLayer(l=>{l.off("click",this.removeLayer,this)}),this.map.off("layeradd",this._layerAddedRemoval,this),this.map.off("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!1)},globalRemovalEnabled(){return this.globalRemovalModeEnabled()},globalRemovalModeEnabled(){return!!this._globalRemovalModeEnabled},toggleGlobalRemovalMode(){this.globalRemovalModeEnabled()?this.disableGlobalRemovalMode():this.enableGlobalRemovalMode()},removeLayer(l){let h=l.target;this._isRelevantForRemoval(h)&&!h.pm.dragging()&&(h.removeFrom(this.map.pm._getContainingLayer()),h.remove(),h instanceof L.LayerGroup?(this._fireRemoveLayerGroup(h),this._fireRemoveLayerGroup(this.map,h)):(h.pm._fireRemove(h),h.pm._fireRemove(this.map,h)))},_isRelevantForRemoval(l){return l.pm&&!(l instanceof L.LayerGroup)&&(!L.PM.optIn&&!l.options.pmIgnore||L.PM.optIn&&l.options.pmIgnore===!1)&&!l._pmTempLayer&&l.pm.options.allowRemoval},handleLayerAdditionInGlobalRemovalMode(){let l=this._addedLayersRemoval;if(this._addedLayersRemoval={},this.globalRemovalModeEnabled())for(let h in l){let v=l[h];this._isRelevantForRemoval(v)&&(v.pm.enabled()&&v.pm.disable(),v.on("click",this.removeLayer,this))}},_layerAddedRemoval({layer:l}){this._addedLayersRemoval[L.stamp(l)]=l}},Va=Hr,Yu={_globalRotateModeEnabled:!1,enableGlobalRotateMode(){this._globalRotateModeEnabled=!0,L.PM.Utils.findLayers(this.map).filter(l=>l instanceof L.Polyline).forEach(l=>{this._isRelevantForRotate(l)&&l.pm.enableRotate()}),this.throttledReInitRotate||(this.throttledReInitRotate=L.Util.throttle(this.handleLayerAdditionInGlobalRotateMode,100,this)),this._addedLayersRotate={},this.map.on("layeradd",this._layerAddedRotate,this),this.map.on("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},disableGlobalRotateMode(){this._globalRotateModeEnabled=!1,L.PM.Utils.findLayers(this.map).filter(l=>l instanceof L.Polyline).forEach(l=>{l.pm.disableRotate()}),this.map.off("layeradd",this._layerAddedRotate,this),this.map.off("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},globalRotateModeEnabled(){return!!this._globalRotateModeEnabled},toggleGlobalRotateMode(){this.globalRotateModeEnabled()?this.disableGlobalRotateMode():this.enableGlobalRotateMode()},_isRelevantForRotate(l){return l.pm&&l instanceof L.Polyline&&!(l instanceof L.LayerGroup)&&(!L.PM.optIn&&!l.options.pmIgnore||L.PM.optIn&&l.options.pmIgnore===!1)&&!l._pmTempLayer&&l.pm.options.allowRotation},handleLayerAdditionInGlobalRotateMode(){let l=this._addedLayersRotate;if(this._addedLayersRotate={},this.globalRotateModeEnabled())for(let h in l){let v=l[h];this._isRelevantForRemoval(v)&&v.pm.enableRotate()}},_layerAddedRotate({layer:l}){this._addedLayersRotate[L.stamp(l)]=l}},kl=Yu,Jl=f(Ir()),ol={_fireDrawStart(l="Draw",h={}){this.__fire(this._map,"pm:drawstart",{shape:this._shape,workingLayer:this._layer},l,h)},_fireDrawEnd(l="Draw",h={}){this.__fire(this._map,"pm:drawend",{shape:this._shape},l,h)},_fireCreate(l,h="Draw",v={}){this.__fire(this._map,"pm:create",{shape:this._shape,marker:l,layer:l},h,v)},_fireCenterPlaced(l="Draw",h={}){let v=l==="Draw"?this._layer:void 0,x=l!=="Draw"?this._layer:void 0;this.__fire(this._layer,"pm:centerplaced",{shape:this._shape,workingLayer:v,layer:x,latlng:this._layer.getLatLng()},l,h)},_fireCut(l,h,v,x="Draw",E={}){this.__fire(l,"pm:cut",{shape:this._shape,layer:h,originalLayer:v},x,E)},_fireEdit(l=this._layer,h="Edit",v={}){this.__fire(l,"pm:edit",{layer:this._layer,shape:this.getShape()},h,v)},_fireEnable(l="Edit",h={}){this.__fire(this._layer,"pm:enable",{layer:this._layer,shape:this.getShape()},l,h)},_fireDisable(l="Edit",h={}){this.__fire(this._layer,"pm:disable",{layer:this._layer,shape:this.getShape()},l,h)},_fireUpdate(l="Edit",h={}){this.__fire(this._layer,"pm:update",{layer:this._layer,shape:this.getShape()},l,h)},_fireMarkerDragStart(l,h=void 0,v="Edit",x={}){this.__fire(this._layer,"pm:markerdragstart",{layer:this._layer,markerEvent:l,shape:this.getShape(),indexPath:h},v,x)},_fireMarkerDrag(l,h=void 0,v="Edit",x={}){this.__fire(this._layer,"pm:markerdrag",{layer:this._layer,markerEvent:l,shape:this.getShape(),indexPath:h},v,x)},_fireMarkerDragEnd(l,h=void 0,v=void 0,x="Edit",E={}){this.__fire(this._layer,"pm:markerdragend",{layer:this._layer,markerEvent:l,shape:this.getShape(),indexPath:h,intersectionReset:v},x,E)},_fireDragStart(l="Edit",h={}){this.__fire(this._layer,"pm:dragstart",{layer:this._layer,shape:this.getShape()},l,h)},_fireDrag(l,h="Edit",v={}){this.__fire(this._layer,"pm:drag",{...l,shape:this.getShape()},h,v)},_fireDragEnd(l="Edit",h={}){this.__fire(this._layer,"pm:dragend",{layer:this._layer,shape:this.getShape()},l,h)},_fireDragEnable(l="Edit",h={}){this.__fire(this._layer,"pm:dragenable",{layer:this._layer,shape:this.getShape()},l,h)},_fireDragDisable(l="Edit",h={}){this.__fire(this._layer,"pm:dragdisable",{layer:this._layer,shape:this.getShape()},l,h)},_fireRemove(l,h=l,v="Edit",x={}){this.__fire(l,"pm:remove",{layer:h,shape:this.getShape()},v,x)},_fireVertexAdded(l,h,v,x="Edit",E={}){this.__fire(this._layer,"pm:vertexadded",{layer:this._layer,workingLayer:this._layer,marker:l,indexPath:h,latlng:v,shape:this.getShape()},x,E)},_fireVertexRemoved(l,h,v="Edit",x={}){this.__fire(this._layer,"pm:vertexremoved",{layer:this._layer,marker:l,indexPath:h,shape:this.getShape()},v,x)},_fireVertexClick(l,h,v="Edit",x={}){this.__fire(this._layer,"pm:vertexclick",{layer:this._layer,markerEvent:l,indexPath:h,shape:this.getShape()},v,x)},_fireIntersect(l,h=this._layer,v="Edit",x={}){this.__fire(h,"pm:intersect",{layer:this._layer,intersection:l,shape:this.getShape()},v,x)},_fireLayerReset(l,h,v="Edit",x={}){this.__fire(this._layer,"pm:layerreset",{layer:this._layer,markerEvent:l,indexPath:h,shape:this.getShape()},v,x)},_fireChange(l,h="Edit",v={}){this.__fire(this._layer,"pm:change",{layer:this._layer,latlngs:l,shape:this.getShape()},h,v)},_fireTextChange(l,h="Edit",v={}){this.__fire(this._layer,"pm:textchange",{layer:this._layer,text:l,shape:this.getShape()},h,v)},_fireTextFocus(l="Edit",h={}){this.__fire(this._layer,"pm:textfocus",{layer:this._layer,shape:this.getShape()},l,h)},_fireTextBlur(l="Edit",h={}){this.__fire(this._layer,"pm:textblur",{layer:this._layer,shape:this.getShape()},l,h)},_fireSnapDrag(l,h,v="Snapping",x={}){this.__fire(l,"pm:snapdrag",h,v,x)},_fireSnap(l,h,v="Snapping",x={}){this.__fire(l,"pm:snap",h,v,x)},_fireUnsnap(l,h,v="Snapping",x={}){this.__fire(l,"pm:unsnap",h,v,x)},_fireRotationEnable(l,h,v="Rotation",x={}){this.__fire(l,"pm:rotateenable",{layer:this._layer,helpLayer:this._rotatePoly,shape:this.getShape()},v,x)},_fireRotationDisable(l,h="Rotation",v={}){this.__fire(l,"pm:rotatedisable",{layer:this._layer,shape:this.getShape()},h,v)},_fireRotationStart(l,h,v="Rotation",x={}){this.__fire(l,"pm:rotatestart",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:this._startAngle,originLatLngs:h},v,x)},_fireRotation(l,h,v,x=this._rotationLayer,E="Rotation",j={}){this.__fire(l,"pm:rotate",{layer:x,helpLayer:this._layer,startAngle:this._startAngle,angle:x.pm.getAngle(),angleDiff:h,oldLatLngs:v,newLatLngs:x.getLatLngs()},E,j)},_fireRotationEnd(l,h,v,x="Rotation",E={}){this.__fire(l,"pm:rotateend",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:h,angle:this._rotationLayer.pm.getAngle(),originLatLngs:v,newLatLngs:this._rotationLayer.getLatLngs()},x,E)},_fireActionClick(l,h,v,x="Toolbar",E={}){this.__fire(this._map,"pm:actionclick",{text:l.text,action:l,btnName:h,button:v},x,E)},_fireButtonClick(l,h,v="Toolbar",x={}){this.__fire(this._map,"pm:buttonclick",{btnName:l,button:h},v,x)},_fireLangChange(l,h,v,x,E="Global",j={}){this.__fire(this.map,"pm:langchange",{oldLang:l,activeLang:h,fallback:v,translations:x},E,j)},_fireGlobalDragModeToggled(l,h="Global",v={}){this.__fire(this.map,"pm:globaldragmodetoggled",{enabled:l,map:this.map},h,v)},_fireGlobalEditModeToggled(l,h="Global",v={}){this.__fire(this.map,"pm:globaleditmodetoggled",{enabled:l,map:this.map},h,v)},_fireGlobalRemovalModeToggled(l,h="Global",v={}){this.__fire(this.map,"pm:globalremovalmodetoggled",{enabled:l,map:this.map},h,v)},_fireGlobalCutModeToggled(l="Global",h={}){this.__fire(this._map,"pm:globalcutmodetoggled",{enabled:!!this._enabled,map:this._map},l,h)},_fireGlobalDrawModeToggled(l="Global",h={}){this.__fire(this._map,"pm:globaldrawmodetoggled",{enabled:this._enabled,shape:this._shape,map:this._map},l,h)},_fireGlobalRotateModeToggled(l="Global",h={}){this.__fire(this.map,"pm:globalrotatemodetoggled",{enabled:this.globalRotateModeEnabled(),map:this.map},l,h)},_fireRemoveLayerGroup(l,h=l,v="Edit",x={}){this.__fire(l,"pm:remove",{layer:h,shape:void 0},v,x)},_fireKeyeventEvent(l,h,v,x="Global",E={}){this.__fire(this.map,"pm:keyevent",{event:l,eventType:h,focusOn:v},x,E)},__fire(l,h,v,x,E={}){v=(0,Jl.default)(v,E,{source:x}),L.PM.Utils._fireEvent(l,h,v)}},Tl=ol,Xl=()=>({_lastEvents:{keydown:void 0,keyup:void 0,current:void 0},_initKeyListener(l){this.map=l,L.DomEvent.on(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.on(window,"blur",this._onBlur,this),l.once("unload",this._unbindKeyListenerEvents,this)},_unbindKeyListenerEvents(){L.DomEvent.off(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.off(window,"blur",this._onBlur,this)},_onKeyListener(l){let h="document";this.map.getContainer().contains(l.target)&&(h="map");let v={event:l,eventType:l.type,focusOn:h};this._lastEvents[l.type]=v,this._lastEvents.current=v,this.map.pm._fireKeyeventEvent(l,l.type,h)},_onBlur(l){l.altKey=!1;let h={event:l,eventType:l.type,focusOn:"document"};this._lastEvents[l.type]=h,this._lastEvents.current=h},getLastKeyEvent(l="current"){return this._lastEvents[l]},isShiftKeyPressed(){var l;return(l=this._lastEvents.current)==null?void 0:l.event.shiftKey},isAltKeyPressed(){var l;return(l=this._lastEvents.current)==null?void 0:l.event.altKey},isCtrlKeyPressed(){var l;return(l=this._lastEvents.current)==null?void 0:l.event.ctrlKey},isMetaKeyPressed(){var l;return(l=this._lastEvents.current)==null?void 0:l.event.metaKey},getPressedKey(){var l;return(l=this._lastEvents.current)==null?void 0:l.event.key}}),Zr=Xl,uo=f(Rr());function lr(l){let h=L.PM.activeLang;return(0,uo.default)(to[h],l)||(0,uo.default)(to.en,l)||l}function co(l){for(let h=0;h<l.length;h+=1){let v=l[h];if(Array.isArray(v)){if(co(v))return!0}else if(v!=null&&v!=="")return!0}return!1}function sl(l){return l.reduce((h,v)=>{if(v.length!==0){let x=Array.isArray(v)?sl(v):v;Array.isArray(x)?x.length!==0&&h.push(x):h.push(x)}return h},[])}function ya(l,h,v){let x={a:L.CRS.Earth.R,b:63567523142e-4,f:.0033528106647474805},{a:E,b:j,f:X}=x,re=l.lng,ge=l.lat,Le=v,Xe=Math.PI,ze=h*Xe/180,vt=Math.sin(ze),Dt=Math.cos(ze),Xt=(1-X)*Math.tan(ge*Xe/180),_n=1/Math.sqrt(1+Xt*Xt),Sn=Xt*_n,hr=Math.atan2(Xt,Dt),Je=_n*vt,nt=1-Je*Je,ct=nt*(E*E-j*j)/(j*j),Rt=1+ct/16384*(4096+ct*(-768+ct*(320-175*ct))),bt=ct/1024*(256+ct*(-128+ct*(74-47*ct))),It=Le/(j*Rt),me=2*Math.PI,Pe,Be,Oe;for(;Math.abs(It-me)>1e-12;){Pe=Math.cos(2*hr+It),Be=Math.sin(It),Oe=Math.cos(It);let on=bt*Be*(Pe+bt/4*(Oe*(-1+2*Pe*Pe)-bt/6*Pe*(-3+4*Be*Be)*(-3+4*Pe*Pe)));me=It,It=Le/(j*Rt)+on}let Fe=Sn*Be-_n*Oe*Dt,je=Math.atan2(Sn*Oe+_n*Be*Dt,(1-X)*Math.sqrt(Je*Je+Fe*Fe)),at=Math.atan2(Be*vt,_n*Oe-Sn*Be*Dt),lt=X/16*nt*(4+X*(4-3*nt)),pt=at-(1-lt)*X*Je*(It+lt*Be*(Pe+lt*Oe*(-1+2*Pe*Pe))),Et=re+pt*180/Xe,Ct=je*180/Xe;return L.latLng(Et,Ct)}function qi(l,h,v,x,E=!0){let j,X,re,ge=[];for(let Le=0;Le<v;Le+=1){if(E)j=Le*360/v+x,X=ya(l,j,h),re=L.latLng(X.lng,X.lat);else{let Xe=l.lat+Math.cos(2*Le*Math.PI/v)*h,ze=l.lng+Math.sin(2*Le*Math.PI/v)*h;re=L.latLng(Xe,ze)}ge.push(re)}return ge}function Ql(l,h,v){h=(h+360)%360;let x=Math.PI/180,E=180/Math.PI,{R:j}=L.CRS.Earth,X=l.lng*x,re=l.lat*x,ge=h*x,Le=Math.sin(re),Xe=Math.cos(re),ze=Math.cos(v/j),vt=Math.sin(v/j),Dt=Math.asin(Le*ze+Xe*vt*Math.cos(ge)),Xt=X+Math.atan2(Math.sin(ge)*vt*Xe,ze-Le*Math.sin(Dt));Xt*=E;let _n=Xt-360,Sn=Xt<-180?Xt+360:Xt;return Xt=Xt>180?_n:Sn,L.latLng([Dt*E,Xt])}function ta(l,h,v){let x=l.latLngToContainerPoint(h),E=l.latLngToContainerPoint(v),j=Math.atan2(E.y-x.y,E.x-x.x)*180/Math.PI+90;return j+=j<0?360:0,j}function Nl(l,h,v,x){let E=ta(l,h,v);return Ql(h,E,x)}function Dl(l,h,v="asc"){if(!h||Object.keys(h).length===0)return(ge,Le)=>ge-Le;let x=Object.keys(h),E,j=x.length-1,X={};for(;j>=0;)E=x[j],X[E.toLowerCase()]=h[E],j-=1;function re(ge){if(ge instanceof L.Marker)return"Marker";if(ge instanceof L.Circle)return"Circle";if(ge instanceof L.CircleMarker)return"CircleMarker";if(ge instanceof L.Rectangle)return"Rectangle";if(ge instanceof L.Polygon)return"Polygon";if(ge instanceof L.Polyline)return"Line"}return(ge,Le)=>{let Xe,ze;if(Xe=re(ge.layer).toLowerCase(),ze=re(Le.layer).toLowerCase(),!Xe||!ze)return 0;let vt=Xe in X?X[Xe]:Number.MAX_SAFE_INTEGER,Dt=ze in X?X[ze]:Number.MAX_SAFE_INTEGER,Xt=0;return vt<Dt?Xt=-1:vt>Dt&&(Xt=1),v==="desc"?Xt*-1:Xt}}function Fs(l,h=l.getLatLngs()){return l instanceof L.Polygon?L.polygon(h).getLatLngs():L.polyline(h).getLatLngs()}function Il(l,h){var v,x,E,j;if((x=(v=h.options.crs)==null?void 0:v.projection)!=null&&x.MAX_LATITUDE){let X=(j=(E=h.options.crs)==null?void 0:E.projection)==null?void 0:j.MAX_LATITUDE;l.lat=Math.max(Math.min(X,l.lat),-X)}return l}function vi(l){return l.options.renderer||l._map&&(l._map._getPaneRenderer(l.options.pane)||l._map.options.renderer||l._map._renderer)||l._renderer}var Ju=L.Class.extend({includes:[wu,Er,Va,kl,Tl],initialize(l){this.map=l,this.Draw=new L.PM.Draw(l),this.Toolbar=new L.PM.Toolbar(l),this.Keyboard=Zr(),this.globalOptions={snappable:!0,layerGroup:void 0,snappingOrder:["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],panes:{vertexPane:"markerPane",layerPane:"overlayPane",markerPane:"markerPane"},draggable:!0},this.Keyboard._initKeyListener(l)},setLang(l="en",h,v="en"){if(l=l.trim().toLowerCase(),!/^[a-z]{2}$/.test(l)){let E=l.replace(/[-_\s]/g,"-").replace(/^(\w{2})$/,"$1-").match(/([a-z]{2})-?([a-z]{2})?/);if(E){let j=[`${E[1]}_${E[2]}`,`${E[1]}`];for(let X of j)if(to[X]){l=X;break}}}let x=L.PM.activeLang;h&&(to[l]=(0,cr.default)(to[v],h)),L.PM.activeLang=l,this.map.pm.Toolbar.reinit(),this._fireLangChange(x,l,v,to[l])},addControls(l){this.Toolbar.addControls(l)},removeControls(){this.Toolbar.removeControls()},toggleControls(){this.Toolbar.toggleControls()},controlsVisible(){return this.Toolbar.isVisible},enableDraw(l="Polygon",h){l==="Poly"&&(l="Polygon"),this.Draw.enable(l,h)},disableDraw(l="Polygon"){l==="Poly"&&(l="Polygon"),this.Draw.disable(l)},setPathOptions(l,h={}){let v=h.ignoreShapes||[],x=h.merge||!1;this.map.pm.Draw.shapes.forEach(E=>{v.indexOf(E)===-1&&this.map.pm.Draw[E].setPathOptions(l,x)})},getGlobalOptions(){return this.globalOptions},setGlobalOptions(l){let h=(0,cr.default)(this.globalOptions,l);h.editable&&(h.resizeableCircleMarker=h.editable,delete h.editable);let v=!1;this.map.pm.Draw.CircleMarker.enabled()&&!!this.map.pm.Draw.CircleMarker.options.resizeableCircleMarker!=!!h.resizeableCircleMarker&&(this.map.pm.Draw.CircleMarker.disable(),v=!0);let x=!1;this.map.pm.Draw.Circle.enabled()&&!!this.map.pm.Draw.Circle.options.resizeableCircle!=!!h.resizeableCircle&&(this.map.pm.Draw.Circle.disable(),x=!0),this.map.pm.Draw.shapes.forEach(E=>{this.map.pm.Draw[E].setOptions(h)}),v&&this.map.pm.Draw.CircleMarker.enable(),x&&this.map.pm.Draw.Circle.enable(),L.PM.Utils.findLayers(this.map).forEach(E=>{E.pm.setOptions(h)}),this.map.fire("pm:globaloptionschanged"),this.globalOptions=h,this.applyGlobalOptions()},applyGlobalOptions(){L.PM.Utils.findLayers(this.map).forEach(l=>{l.pm.enabled()&&l.pm.applyOptions()})},globalDrawModeEnabled(){return!!this.Draw.getActiveShape()},globalCutModeEnabled(){return!!this.Draw.Cut.enabled()},enableGlobalCutMode(l){return this.Draw.Cut.enable(l)},toggleGlobalCutMode(l){return this.Draw.Cut.toggle(l)},disableGlobalCutMode(){return this.Draw.Cut.disable()},getGeomanLayers(l=!1){let h=L.PM.Utils.findLayers(this.map);if(!l)return h;let v=L.featureGroup();return v._pmTempLayer=!0,h.forEach(x=>{v.addLayer(x)}),v},getGeomanDrawLayers(l=!1){let h=L.PM.Utils.findLayers(this.map).filter(x=>x._drawnByGeoman===!0);if(!l)return h;let v=L.featureGroup();return v._pmTempLayer=!0,h.forEach(x=>{v.addLayer(x)}),v},_getContainingLayer(){return this.globalOptions.layerGroup&&this.globalOptions.layerGroup instanceof L.LayerGroup?this.globalOptions.layerGroup:this.map},_isCRSSimple(){return this.map.options.crs===L.CRS.Simple},_touchEventCounter:0,_addTouchEvents(l){this._touchEventCounter===0&&(L.DomEvent.on(l,"touchmove",this._canvasTouchMove,this),L.DomEvent.on(l,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter+=1},_removeTouchEvents(l){this._touchEventCounter===1&&(L.DomEvent.off(l,"touchmove",this._canvasTouchMove,this),L.DomEvent.off(l,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter=this._touchEventCounter<=1?0:this._touchEventCounter-1},_canvasTouchMove(l){vi(this.map)._onMouseMove(this._createMouseEvent("mousemove",l))},_canvasTouchClick(l){let h="";l.type==="touchstart"||l.type==="pointerdown"?h="mousedown":(l.type==="touchend"||l.type==="pointerup"||l.type==="touchcancel"||l.type==="pointercancel")&&(h="mouseup"),h&&vi(this.map)._onClick(this._createMouseEvent(h,l))},_createMouseEvent(l,h){let v,x=h.touches[0]||h.changedTouches[0];try{v=new MouseEvent(l,{bubbles:h.bubbles,cancelable:h.cancelable,view:h.view,detail:x.detail,screenX:x.screenX,screenY:x.screenY,clientX:x.clientX,clientY:x.clientY,ctrlKey:h.ctrlKey,altKey:h.altKey,shiftKey:h.shiftKey,metaKey:h.metaKey,button:h.button,relatedTarget:h.relatedTarget})}catch{v=document.createEvent("MouseEvents"),v.initMouseEvent(l,h.bubbles,h.cancelable,h.view,x.detail,x.screenX,x.screenY,x.clientX,x.clientY,h.ctrlKey,h.altKey,h.shiftKey,h.metaKey,h.button,h.relatedTarget)}return v}}),ko=Ju,Hs=L.Control.extend({includes:[Tl],options:{position:"topleft",disableByOtherButtons:!0},initialize(l){this._button=L.Util.extend({},this.options,l)},onAdd(l){return this._map=l,this._map.pm.Toolbar.options.oneBlock?this._container=this._map.pm.Toolbar._createContainer(this.options.position):this._button.tool==="edit"?this._container=this._map.pm.Toolbar.editContainer:this._button.tool==="options"?this._container=this._map.pm.Toolbar.optionsContainer:this._button.tool==="custom"?this._container=this._map.pm.Toolbar.customContainer:this._container=this._map.pm.Toolbar.drawContainer,this._renderButton(),this._container},_renderButton(){let l=this.buttonsDomNode;this.buttonsDomNode=this._makeButton(this._button),l?l.replaceWith(this.buttonsDomNode):this._container.appendChild(this.buttonsDomNode)},onRemove(){return this.buttonsDomNode.remove(),this._container},getText(){return this._button.text},getIconUrl(){return this._button.iconUrl},destroy(){this._button={},this._update()},toggle(l){return typeof l=="boolean"?this._button.toggleStatus=l:this._button.toggleStatus=!this._button.toggleStatus,this._applyStyleClasses(),this._updateActiveAction(this._button),this._button.toggleStatus},toggled(){return this._button.toggleStatus},onCreate(){this.toggle(!1)},disable(){this.toggle(!1),this._button.disabled=!0,this._updateDisabled()},enable(){this._button.disabled=!1,this._updateDisabled(),this._updateActiveAction(this._button)},_triggerClick(l){l&&l.preventDefault(),!this._button.disabled&&(this._button.onClick(l,{button:this,event:l}),this._clicked(l),this._button.afterClick(l,{button:this,event:l}))},_makeButton(l){let h=this.options.position.indexOf("right")>-1?"pos-right":"",v=L.DomUtil.create("div",`button-container  ${h}`,this._container);l.title&&v.setAttribute("title",l.title);let x=L.DomUtil.create("a","leaflet-buttons-control-button",v);x.setAttribute("role","button"),x.setAttribute("tabindex","0"),x.href="#";let E=L.DomUtil.create("div",`leaflet-pm-actions-container ${h}`,v),j=l.actions,X={cancel:{text:lr("actions.cancel"),title:lr("actions.cancel"),onClick(){this._triggerClick()}},finishMode:{text:lr("actions.finish"),title:lr("actions.finish"),onClick(){this._triggerClick()}},removeLastVertex:{text:lr("actions.removeLastVertex"),title:lr("actions.removeLastVertex"),onClick(){this._map.pm.Draw[l.jsClass]._removeLastVertex()}},finish:{text:lr("actions.finish"),title:lr("actions.finish"),onClick(ge){this._map.pm.Draw[l.jsClass]._finishShape(ge)}}};l._preparedActions=j.map(ge=>{let Le=typeof ge=="string"?ge:ge.name,Xe;if(X[Le])Xe=X[Le];else if(ge.text)Xe=ge;else return Xe;let ze=L.DomUtil.create("a",`leaflet-pm-action ${h} action-${Le}`,E);if(ze.setAttribute("role","button"),ze.setAttribute("tabindex","0"),ze.href="#",Xe.title&&(ze.title=Xe.title),ze.innerHTML=Xe.text,L.DomEvent.disableClickPropagation(ze),L.DomEvent.on(ze,"click",L.DomEvent.stop),Xe._node=ze,!l.disabled&&Xe.onClick){let vt=Dt=>{Dt.preventDefault();let Xt="",{buttons:_n}=this._map.pm.Toolbar;for(let Sn in _n)if(_n[Sn]._button===l){Xt=Sn;break}this._fireActionClick(Xe,Xt,l)};L.DomEvent.addListener(ze,"click",vt,this),L.DomEvent.addListener(ze,"click",Xe.onClick,this),L.DomEvent.addListener(ze,"click",()=>this._updateActiveAction(l))}return Xe}),this._updateActiveAction(l),l.toggleStatus&&L.DomUtil.addClass(v,"active");let re=L.DomUtil.create("div","control-icon",x);return l.iconUrl&&re.setAttribute("src",l.iconUrl),l.className&&L.DomUtil.addClass(re,l.className),L.DomEvent.disableClickPropagation(x),L.DomEvent.on(x,"click",L.DomEvent.stop),l.disabled||(L.DomEvent.addListener(x,"click",this._onBtnClick,this),L.DomEvent.addListener(x,"click",this._triggerClick,this)),l.disabled&&(L.DomUtil.addClass(x,"pm-disabled"),x.setAttribute("aria-disabled","true")),v},_applyStyleClasses(){this._container&&(!this._button.toggleStatus||this._button.cssToggle===!1?(L.DomUtil.removeClass(this.buttonsDomNode,"active"),L.DomUtil.removeClass(this._container,"activeChild")):(L.DomUtil.addClass(this.buttonsDomNode,"active"),L.DomUtil.addClass(this._container,"activeChild")))},_onBtnClick(){if(this._button.disabled)return;this._button.disableOtherButtons&&this._map.pm.Toolbar.triggerClickOnToggledButtons(this);let l="",{buttons:h}=this._map.pm.Toolbar;for(let v in h)if(h[v]._button===this._button){l=v;break}this._fireButtonClick(l,this._button)},_clicked(){this._button.doToggle&&this.toggle()},_updateDisabled(){if(!this._container)return;let l="pm-disabled",h=this.buttonsDomNode.children[0];this._button.disabled?(L.DomUtil.addClass(h,l),h.setAttribute("aria-disabled","true")):(L.DomUtil.removeClass(h,l),h.setAttribute("aria-disabled","false"))},_updateActiveAction(l){var h;(h=l._preparedActions)==null||h.forEach(v=>{v!=null&&v._node&&(v.isActive&&v.isActive.call(this)?L.DomUtil.addClass(v._node,"active-action"):L.DomUtil.removeClass(v._node,"active-action"))})}}),Ol=Hs;L.Control.PMButton=Ol;var qs=L.Class.extend({options:{drawMarker:!0,drawRectangle:!0,drawPolyline:!0,drawPolygon:!0,drawCircle:!0,drawCircleMarker:!0,drawText:!0,editMode:!0,dragMode:!0,cutPolygon:!0,removalMode:!0,rotateMode:!0,snappingOption:!0,drawControls:!0,editControls:!0,optionsControls:!0,customControls:!0,oneBlock:!1,position:"topleft",positions:{draw:"",edit:"",options:"",custom:""}},customButtons:[],initialize(l){this.customButtons=[],this.options.positions={draw:"",edit:"",options:"",custom:""},this.init(l)},reinit(){let l=this.isVisible;this.removeControls(),this._defineButtons(),l&&this.addControls()},init(l){this.map=l,this.buttons={},this.isVisible=!1,this.drawContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-draw leaflet-bar leaflet-control"),this.editContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-edit leaflet-bar leaflet-control"),this.optionsContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-options leaflet-bar leaflet-control"),this.customContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-custom leaflet-bar leaflet-control"),this._defineButtons()},_createContainer(l){let h=`${l}Container`;return this[h]||(this[h]=L.DomUtil.create("div",`leaflet-pm-toolbar leaflet-pm-${l} leaflet-bar leaflet-control`)),this[h]},getButtons(){return this.buttons},addControls(l=this.options){typeof l.editPolygon<"u"&&(l.editMode=l.editPolygon),typeof l.deleteLayer<"u"&&(l.removalMode=l.deleteLayer),L.Util.setOptions(this,l),this.applyIconStyle(),this.isVisible=!0,this._showHideButtons()},applyIconStyle(){let l=this.getButtons(),h={geomanIcons:{drawMarker:"control-icon leaflet-pm-icon-marker",drawPolyline:"control-icon leaflet-pm-icon-polyline",drawRectangle:"control-icon leaflet-pm-icon-rectangle",drawPolygon:"control-icon leaflet-pm-icon-polygon",drawCircle:"control-icon leaflet-pm-icon-circle",drawCircleMarker:"control-icon leaflet-pm-icon-circle-marker",editMode:"control-icon leaflet-pm-icon-edit",dragMode:"control-icon leaflet-pm-icon-drag",cutPolygon:"control-icon leaflet-pm-icon-cut",removalMode:"control-icon leaflet-pm-icon-delete",drawText:"control-icon leaflet-pm-icon-text"}};for(let v in l){let x=l[v];L.Util.setOptions(x,{className:h.geomanIcons[v]})}},removeControls(){let l=this.getButtons();for(let h in l)l[h].remove();this.isVisible=!1},toggleControls(l=this.options){this.isVisible?this.removeControls():this.addControls(l)},_addButton(l,h){return this.buttons[l]=h,this.options[l]=!!this.options[l]||!1,this.buttons[l]},triggerClickOnToggledButtons(l){for(let h in this.buttons){let v=this.buttons[h];v._button.disableByOtherButtons&&v!==l&&v.toggled()&&v._triggerClick()}},toggleButton(l,h,v=!0){l==="editPolygon"&&(l="editMode"),l==="deleteLayer"&&(l="removalMode");let x=l;return v&&this.triggerClickOnToggledButtons(this.buttons[x]),this.buttons[x]?this.buttons[x].toggle(h):!1},_defineButtons(){let l={className:"control-icon leaflet-pm-icon-marker",title:lr("buttonTitles.drawMarkerButton"),jsClass:"Marker",onClick:()=>{},afterClick:(vt,Dt)=>{this.map.pm.Draw[Dt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},h={title:lr("buttonTitles.drawPolyButton"),className:"control-icon leaflet-pm-icon-polygon",jsClass:"Polygon",onClick:()=>{},afterClick:(vt,Dt)=>{this.map.pm.Draw[Dt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},v={className:"control-icon leaflet-pm-icon-polyline",title:lr("buttonTitles.drawLineButton"),jsClass:"Line",onClick:()=>{},afterClick:(vt,Dt)=>{this.map.pm.Draw[Dt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},x={title:lr("buttonTitles.drawCircleButton"),className:"control-icon leaflet-pm-icon-circle",jsClass:"Circle",onClick:()=>{},afterClick:(vt,Dt)=>{this.map.pm.Draw[Dt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},E={title:lr("buttonTitles.drawCircleMarkerButton"),className:"control-icon leaflet-pm-icon-circle-marker",jsClass:"CircleMarker",onClick:()=>{},afterClick:(vt,Dt)=>{this.map.pm.Draw[Dt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},j={title:lr("buttonTitles.drawRectButton"),className:"control-icon leaflet-pm-icon-rectangle",jsClass:"Rectangle",onClick:()=>{},afterClick:(vt,Dt)=>{this.map.pm.Draw[Dt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},X={title:lr("buttonTitles.editButton"),className:"control-icon leaflet-pm-icon-edit",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalEditMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},re={title:lr("buttonTitles.dragButton"),className:"control-icon leaflet-pm-icon-drag",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalDragMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},ge={title:lr("buttonTitles.cutButton"),className:"control-icon leaflet-pm-icon-cut",jsClass:"Cut",onClick:()=>{},afterClick:(vt,Dt)=>{this.map.pm.Draw[Dt.button._button.jsClass].toggle({snappable:!0,cursorMarker:!0,allowSelfIntersection:!1})},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finish","removeLastVertex","cancel"]},Le={title:lr("buttonTitles.deleteButton"),className:"control-icon leaflet-pm-icon-delete",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRemovalMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},Xe={title:lr("buttonTitles.rotateButton"),className:"control-icon leaflet-pm-icon-rotate",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRotateMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},ze={className:"control-icon leaflet-pm-icon-text",title:lr("buttonTitles.drawTextButton"),jsClass:"Text",onClick:()=>{},afterClick:(vt,Dt)=>{this.map.pm.Draw[Dt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]};this._addButton("drawMarker",new L.Control.PMButton(l)),this._addButton("drawPolyline",new L.Control.PMButton(v)),this._addButton("drawRectangle",new L.Control.PMButton(j)),this._addButton("drawPolygon",new L.Control.PMButton(h)),this._addButton("drawCircle",new L.Control.PMButton(x)),this._addButton("drawCircleMarker",new L.Control.PMButton(E)),this._addButton("drawText",new L.Control.PMButton(ze)),this._addButton("editMode",new L.Control.PMButton(X)),this._addButton("dragMode",new L.Control.PMButton(re)),this._addButton("cutPolygon",new L.Control.PMButton(ge)),this._addButton("removalMode",new L.Control.PMButton(Le)),this._addButton("rotateMode",new L.Control.PMButton(Xe))},_showHideButtons(){if(!this.isVisible)return;this.removeControls(),this.isVisible=!0;let l=this.getButtons(),h=[];this.options.drawControls===!1&&(h=h.concat(Object.keys(l).filter(v=>!l[v]._button.tool))),this.options.editControls===!1&&(h=h.concat(Object.keys(l).filter(v=>l[v]._button.tool==="edit"))),this.options.optionsControls===!1&&(h=h.concat(Object.keys(l).filter(v=>l[v]._button.tool==="options"))),this.options.customControls===!1&&(h=h.concat(Object.keys(l).filter(v=>l[v]._button.tool==="custom")));for(let v in l)if(this.options[v]&&h.indexOf(v)===-1){let x=l[v]._button.tool;x||(x="draw"),l[v].setPosition(this._getBtnPosition(x)),l[v].addTo(this.map)}},_getBtnPosition(l){return this.options.positions&&this.options.positions[l]?this.options.positions[l]:this.options.position},setBlockPosition(l,h){this.options.positions[l]=h,this._showHideButtons(),this.changeControlOrder()},getBlockPositions(){return this.options.positions},copyDrawControl(l,h){if(h)typeof h!="object"&&(h={name:h});else throw new TypeError("Button has no name");let v=this._btnNameMapping(l);if(!h.name)throw new TypeError("Button has no name");if(this.buttons[h.name])throw new TypeError("Button with this name already exists");let x=this.map.pm.Draw.createNewDrawInstance(h.name,v);h={...this.buttons[v]._button,...h};let E=this.createCustomControl(h);return{drawInstance:x,control:E}},createCustomControl(l){if(!l.name)throw new TypeError("Button has no name");if(this.buttons[l.name])throw new TypeError("Button with this name already exists");l.onClick||(l.onClick=()=>{}),l.afterClick||(l.afterClick=()=>{}),l.toggle!==!1&&(l.toggle=!0),l.block&&(l.block=l.block.toLowerCase()),(!l.block||l.block==="draw")&&(l.block=""),l.className?l.className.indexOf("control-icon")===-1&&(l.className=`control-icon ${l.className}`):l.className="control-icon";let h={tool:l.block,className:l.className,title:l.title||"",jsClass:l.name,onClick:l.onClick,afterClick:l.afterClick,doToggle:l.toggle,toggleStatus:!1,disableOtherButtons:l.disableOtherButtons??!0,disableByOtherButtons:l.disableByOtherButtons??!0,cssToggle:l.toggle,position:this.options.position,actions:l.actions||[],disabled:!!l.disabled};this.options[l.name]!==!1&&(this.options[l.name]=!0);let v=this._addButton(l.name,new L.Control.PMButton(h));return this.changeControlOrder(),v},controlExists(l){return!!this.getButton(l)},getButton(l){return this.getButtons()[l]},getButtonsInBlock(l){let h={};if(l)for(let v in this.getButtons()){let x=this.getButtons()[v];(x._button.tool===l||l==="draw"&&!x._button.tool)&&(h[v]=x)}return h},changeControlOrder(l=[]){let h=this._shapeMapping(),v=[];l.forEach(j=>{h[j]?v.push(h[j]):v.push(j)});let x=this.getButtons(),E={};v.forEach(j=>{x[j]&&(E[j]=x[j])}),Object.keys(x).filter(j=>!x[j]._button.tool||x[j]._button.tool==="draw").forEach(j=>{v.indexOf(j)===-1&&(E[j]=x[j])}),Object.keys(x).filter(j=>x[j]._button.tool==="edit").forEach(j=>{v.indexOf(j)===-1&&(E[j]=x[j])}),Object.keys(x).filter(j=>x[j]._button.tool==="options").forEach(j=>{v.indexOf(j)===-1&&(E[j]=x[j])}),Object.keys(x).filter(j=>x[j]._button.tool==="custom").forEach(j=>{v.indexOf(j)===-1&&(E[j]=x[j])}),Object.keys(x).forEach(j=>{v.indexOf(j)===-1&&(E[j]=x[j])}),this.map.pm.Toolbar.buttons=E,this._showHideButtons()},getControlOrder(){let l=this.getButtons(),h=[];for(let v in l)h.push(v);return h},changeActionsOfControl(l,h){let v=this._btnNameMapping(l);if(!v)throw new TypeError("No name passed");if(!h)throw new TypeError("No actions passed");if(!this.buttons[v])throw new TypeError("Button with this name not exists");this.buttons[v]._button.actions=h,this.changeControlOrder()},setButtonDisabled(l,h){let v=this._btnNameMapping(l);h?this.buttons[v].disable():this.buttons[v].enable()},_shapeMapping(){return{Marker:"drawMarker",Circle:"drawCircle",Polygon:"drawPolygon",Rectangle:"drawRectangle",Polyline:"drawPolyline",Line:"drawPolyline",CircleMarker:"drawCircleMarker",Edit:"editMode",Drag:"dragMode",Cut:"cutPolygon",Removal:"removalMode",Rotate:"rotateMode",Text:"drawText"}},_btnNameMapping(l){let h=this._shapeMapping();return h[l]?h[l]:l}}),al=qs,ll=f(Ir()),yi={_initSnappableMarkers(){this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,this._assignEvents(this._markers),this._layer.off("pm:dragstart",this._unsnap,this),this._layer.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){this._layer.off("pm:dragstart",this._unsnap,this)},_assignEvents(l){l.forEach(h=>{if(Array.isArray(h)){this._assignEvents(h);return}h.off("drag",this._handleSnapping,this),h.on("drag",this._handleSnapping,this),h.off("dragend",this._cleanupSnapping,this),h.on("dragend",this._cleanupSnapping,this)})},_cleanupSnapping(l){if(l){let h=l.target;h._snapped=!1}delete this._snapList,this.throttledList&&(this._map.off("layeradd",this.throttledList,this),this.throttledList=void 0),this._map.off("layerremove",this._handleSnapLayerRemoval,this),this.debugIndicatorLines&&this.debugIndicatorLines.forEach(h=>{h.remove()})},_handleThrottleSnapping(){this.throttledList&&this._createSnapList()},_handleSnapping(l){var re,ge,Le;let h=l.target;if(h._snapped=!1,this.throttledList||(this.throttledList=L.Util.throttle(this._handleThrottleSnapping,100,this)),((re=l==null?void 0:l.originalEvent)==null?void 0:re.altKey)||((Le=(ge=this._map)==null?void 0:ge.pm)==null?void 0:Le.Keyboard.isAltKeyPressed())||(this._snapList===void 0&&(this._createSnapList(),this._map.off("layeradd",this.throttledList,this),this._map.on("layeradd",this.throttledList,this)),this._snapList.length<=0))return!1;let v=this._calcClosestLayer(h.getLatLng(),this._snapList);if(Object.keys(v).length===0)return!1;let x=v.layer instanceof L.Marker||v.layer instanceof L.CircleMarker||!this.options.snapSegment,E;x?E=v.latlng:E=this._checkPrioritiySnapping(v);let j=this.options.snapDistance,X={marker:h,shape:this._shape,snapLatLng:E,segment:v.segment,layer:this._layer,workingLayer:this._layer,layerInteractedWith:v.layer,distance:v.distance};if(this._fireSnapDrag(X.marker,X),this._fireSnapDrag(this._layer,X),v.distance<j){h._orgLatLng=h.getLatLng(),h.setLatLng(E),h._snapped=!0,h._snapInfo=X;let Xe=()=>{this._snapLatLng=E,this._fireSnap(h,X),this._fireSnap(this._layer,X)},ze=this._snapLatLng||{},vt=E||{};(ze.lat!==vt.lat||ze.lng!==vt.lng)&&Xe()}else this._snapLatLng&&(this._unsnap(X),h._snapped=!1,h._snapInfo=void 0,this._fireUnsnap(X.marker,X),this._fireUnsnap(this._layer,X));return!0},_createSnapList(){let l=[],h=[],v=this._map;v.off("layerremove",this._handleSnapLayerRemoval,this),v.on("layerremove",this._handleSnapLayerRemoval,this),v.eachLayer(x=>{if((x instanceof L.Polyline||x instanceof L.Marker||x instanceof L.CircleMarker||x instanceof L.ImageOverlay)&&x.options.snapIgnore!==!0){if(x.options.snapIgnore===void 0&&(!L.PM.optIn&&x.options.pmIgnore===!0||L.PM.optIn&&x.options.pmIgnore!==!1))return;(x instanceof L.Circle||x instanceof L.CircleMarker)&&x.pm&&x.pm._hiddenPolyCircle?l.push(x.pm._hiddenPolyCircle):x instanceof L.ImageOverlay&&(x=L.rectangle(x.getBounds())),l.push(x);let E=L.polyline([],{color:"red",pmIgnore:!0});E._pmTempLayer=!0,h.push(E),(x instanceof L.Circle||x instanceof L.CircleMarker)&&h.push(E)}}),l=l.filter(x=>this._layer!==x),l=l.filter(x=>x._latlng||x._latlngs&&co(x._latlngs)),l=l.filter(x=>!x._pmTempLayer),this._otherSnapLayers?(this._otherSnapLayers.forEach(()=>{let x=L.polyline([],{color:"red",pmIgnore:!0});x._pmTempLayer=!0,h.push(x)}),this._snapList=l.concat(this._otherSnapLayers)):this._snapList=l,this.debugIndicatorLines=h},_handleSnapLayerRemoval({layer:l}){if(!l._leaflet_id)return;let h=this._snapList.findIndex(v=>v._leaflet_id===l._leaflet_id);h>-1&&this._snapList.splice(h,1)},_calcClosestLayer(l,h){return this._calcClosestLayers(l,h,1)[0]},_calcClosestLayers(l,h,v=1){let x=[],E={};h.forEach((X,re)=>{var Le;if(X._parentCopy&&X._parentCopy===this._layer||((Le=X.getLatLngs)==null?void 0:Le.call(X).flat(5).length)<2)return;let ge=this._calcLayerDistances(l,X);if(ge.distance=Math.floor(ge.distance),this.debugIndicatorLines){if(!this.debugIndicatorLines[re]){let Xe=L.polyline([],{color:"red",pmIgnore:!0});Xe._pmTempLayer=!0,this.debugIndicatorLines[re]=Xe}this.debugIndicatorLines[re].setLatLngs([l,ge.latlng])}v===1&&(E.distance===void 0||ge.distance-5<=E.distance)?(ge.distance+5<E.distance&&(x=[]),E=ge,E.layer=X,x.push(E)):v!==1&&(E={},E=ge,E.layer=X,x.push(E))}),v!==1&&(x=x.sort((X,re)=>X.distance-re.distance)),v===-1&&(v=x.length);let j=this._getClosestLayerByPriority(x,v);return L.Util.isArray(j)?j:[j]},_calcLayerDistances(l,h){let v=this._map,x=h instanceof L.Marker||h instanceof L.CircleMarker,E=h instanceof L.Polygon,j=l;if(x){let X=h.getLatLng();return{latlng:{...X},distance:this._getDistance(v,X,j)}}return this._calcLatLngDistances(j,h.getLatLngs(),v,E)},_calcLatLngDistances(l,h,v,x=!1){let E,j,X,re=ge=>{ge.forEach((Le,Xe)=>{if(Array.isArray(Le)){re(Le);return}if(this.options.snapSegment){let ze=Le,vt;x?vt=Xe+1===ge.length?0:Xe+1:vt=Xe+1===ge.length?void 0:Xe+1;let Dt=ge[vt];if(Dt){let Xt=this._getDistanceToSegment(v,l,ze,Dt);(j===void 0||Xt<j)&&(j=Xt,X=[ze,Dt])}}else{let ze=this._getDistance(v,l,Le);(j===void 0||ze<j)&&(j=ze,E=Le)}})};return re(h),this.options.snapSegment?{latlng:{...this._getClosestPointOnSegment(v,l,X[0],X[1])},segment:X,distance:j}:{latlng:E,distance:j}},_getClosestLayerByPriority(l,h=1){l=l.sort((X,re)=>X._leaflet_id-re._leaflet_id);let v=["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],x=this._map.pm.globalOptions.snappingOrder||[],E=0,j={};return x.concat(v).forEach(X=>{j[X]||(E+=1,j[X]=E)}),l.sort(Dl("instanceofShape",j)),h===1?l[0]||{}:l.slice(0,h)},_checkPrioritiySnapping(l){let h=this._map,v=l.segment[0],x=l.segment[1],E=l.latlng,j=E;if(this.options.snapVertex){let X=this._getDistance(h,v,E),re=this._getDistance(h,x,E),ge=X<re?v:x,Le=X<re?X:re;if(this.options.snapMiddle){let ze=L.PM.Utils.calcMiddleLatLng(h,v,x),vt=this._getDistance(h,ze,E);vt<X&&vt<re&&(ge=ze,Le=vt)}let Xe=this.options.snapDistance;Le<Xe&&(j=ge)}return{...j}},_unsnap(){delete this._snapLatLng},_getClosestPointOnSegment(l,h,v,x){let E=l.getMaxZoom();E===1/0&&(E=l.getZoom());let j=l.project(h,E),X=l.project(v,E),re=l.project(x,E),ge=L.LineUtil.closestPointOnSegment(j,X,re);return l.unproject(ge,E)},_getDistanceToSegment(l,h,v,x){let E=l.latLngToContainerPoint(h),j=l.latLngToContainerPoint(v),X=l.latLngToContainerPoint(x);return L.LineUtil.pointToSegmentDistance(E,j,X)},_getDistance(l,h,v){return l.latLngToContainerPoint(h).distanceTo(l.latLngToContainerPoint(v))}},ks=yi,_a=L.Class.extend({includes:[ks,Tl],options:{snappable:!0,snapDistance:20,snapMiddle:!1,allowSelfIntersection:!0,tooltips:!0,templineStyle:{},hintlineStyle:{color:"#3388ff",dashArray:"5,5"},pathOptions:null,cursorMarker:!0,finishOn:null,markerStyle:{draggable:!0,icon:L.icon()},hideMiddleMarkers:!1,minRadiusCircle:null,maxRadiusCircle:null,minRadiusCircleMarker:null,maxRadiusCircleMarker:null,resizeableCircleMarker:!1,resizeableCircle:!0,markerEditable:!0,continueDrawing:!1,snapSegment:!0,requireSnapToFinish:!1,rectangleAngle:0,textOptions:{text:null,focusAfterDraw:null,removeIfEmpty:null,className:null},snapVertex:!0},setOptions(l){L.Util.setOptions(this,l),this.setStyle(this.options)},setStyle(){},getOptions(){return this.options},initialize(l){let h=new L.Icon.Default;h.options.tooltipAnchor=[0,0],this.options.markerStyle.icon=h,this._map=l,this.shapes=["Marker","CircleMarker","Line","Polygon","Rectangle","Circle","Cut","Text"],this.shapes.forEach(v=>{this[v]=new L.PM.Draw[v](this._map)}),this.Marker.setOptions({continueDrawing:!0}),this.CircleMarker.setOptions({continueDrawing:!0})},setPathOptions(l,h=!1){h?this.options.pathOptions=(0,ll.default)(this.options.pathOptions,l):this.options.pathOptions=l},getShapes(){return this.shapes},getShape(){return this._shape},enable(l,h){if(!l)throw new Error(`Error: Please pass a shape as a parameter. Possible shapes are: ${this.getShapes().join(",")}`);this.disable(),this[l].enable(h)},disable(){this.shapes.forEach(l=>{this[l].disable()})},addControls(){this.shapes.forEach(l=>{this[l].addButton()})},getActiveShape(){let l;return this.shapes.forEach(h=>{this[h]._enabled&&(l=h)}),l},_setGlobalDrawMode(){this._shape==="Cut"?this._fireGlobalCutModeToggled():this._fireGlobalDrawModeToggled();let l=[];this._map.eachLayer(h=>{(h instanceof L.Polyline||h instanceof L.Marker||h instanceof L.Circle||h instanceof L.CircleMarker||h instanceof L.ImageOverlay)&&(h._pmTempLayer||l.push(h))}),this._enabled?l.forEach(h=>{L.PM.Utils.disablePopup(h)}):l.forEach(h=>{L.PM.Utils.enablePopup(h)})},createNewDrawInstance(l,h){let v=this._getShapeFromBtnName(h);if(this[l])throw new TypeError("Draw Type already exists");if(!L.PM.Draw[v])throw new TypeError(`There is no class L.PM.Draw.${v}`);return this[l]=new L.PM.Draw[v](this._map),this[l].toolbarButtonName=l,this[l]._shape=l,this.shapes.push(l),this[h]&&this[l].setOptions(this[h].options),this[l].setOptions(this[l].options),this[l]},_getShapeFromBtnName(l){let h={drawMarker:"Marker",drawCircle:"Circle",drawPolygon:"Polygon",drawPolyline:"Line",drawRectangle:"Rectangle",drawCircleMarker:"CircleMarker",editMode:"Edit",dragMode:"Drag",cutPolygon:"Cut",removalMode:"Removal",rotateMode:"Rotate",drawText:"Text"};return h[l]?h[l]:this[l]?this[l]._shape:l},_finishLayer(l){l.pm&&(l.pm.setOptions(this.options),l.pm._shape=this._shape,l.pm._map=this._map),this._addDrawnLayerProp(l)},_addDrawnLayerProp(l){l._drawnByGeoman=!0},_setPane(l,h){h==="layerPane"?l.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":h==="vertexPane"?l.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":h==="markerPane"&&(l.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},_isFirstLayer(){return(this._map||this._layer._map).pm.getGeomanLayers().length===0}}),fo=_a;fo.Marker=fo.extend({initialize(l){this._map=l,this._shape="Marker",this.toolbarButtonName="drawMarker"},enable(l){L.Util.setOptions(this,l),this._enabled=!0,this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),this.options.markerStyle),this._setPane(this._hintMarker,"markerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.tooltips&&this._hintMarker.bindTooltip(lr("tooltips.placeMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this.options.markerEditable&&this._map.eachLayer(h=>{this.isRelevantMarker(h)&&h.pm.enable()}),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createMarker,this),this._hintMarker.remove(),this._map.off("mousemove",this._syncHintMarker,this),this._map.eachLayer(l=>{this.isRelevantMarker(l)&&l.pm.disable()}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(l){this.enabled()?this.disable():this.enable(l)},isRelevantMarker(l){return l instanceof L.Marker&&l.pm&&!l._pmTempLayer&&!l.pm._initTextMarker},_syncHintMarker(l){if(this._hintMarker.setLatLng(l.latlng),this.options.snappable){let h=l;h.target=this._hintMarker,this._handleSnapping(h)}this._fireChange(this._hintMarker.getLatLng(),"Draw")},_createMarker(l){if(!l.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(l.latlng);let h=this._hintMarker.getLatLng(),v=new L.Marker(h,this.options.markerStyle);this._setPane(v,"markerPane"),this._finishLayer(v),v.pm||(v.options.draggable=!1),v.addTo(this._map.pm._getContainingLayer()),v.pm&&this.options.markerEditable?v.pm.enable():v.dragging&&v.dragging.disable(),this._fireCreate(v),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},setStyle(){var l,h;(l=this.options.markerStyle)!=null&&l.icon&&((h=this._hintMarker)==null||h.setIcon(this.options.markerStyle.icon))}});var O=63710088e-1,_e={centimeters:O*100,centimetres:O*100,degrees:O/111325,feet:O*3.28084,inches:O*39.37,kilometers:O/1e3,kilometres:O/1e3,meters:O,metres:O,miles:O/1609.344,millimeters:O*1e3,millimetres:O*1e3,nauticalmiles:O/1852,radians:1,yards:O*1.0936};function Ye(l,h,v){v===void 0&&(v={});var x={type:"Feature"};return(v.id===0||v.id)&&(x.id=v.id),v.bbox&&(x.bbox=v.bbox),x.properties=h||{},x.geometry=l,x}function ut(l,h,v){if(v===void 0&&(v={}),!l)throw new Error("coordinates is required");if(!Array.isArray(l))throw new Error("coordinates must be an Array");if(l.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!_r(l[0])||!_r(l[1]))throw new Error("coordinates must contain numbers");var x={type:"Point",coordinates:l};return Ye(x,h,v)}function Lt(l,h,v){if(v===void 0&&(v={}),l.length<2)throw new Error("coordinates must be an array of two or more positions");var x={type:"LineString",coordinates:l};return Ye(x,h,v)}function Ut(l,h){h===void 0&&(h={});var v={type:"FeatureCollection"};return h.id&&(v.id=h.id),h.bbox&&(v.bbox=h.bbox),v.features=l,v}function fn(l,h){h===void 0&&(h="kilometers");var v=_e[h];if(!v)throw new Error(h+" units is invalid");return l*v}function Dn(l,h){h===void 0&&(h="kilometers");var v=_e[h];if(!v)throw new Error(h+" units is invalid");return l/v}function zn(l){var h=l%(2*Math.PI);return h*180/Math.PI}function ir(l){var h=l%360;return h*Math.PI/180}function _r(l){return!isNaN(l)&&l!==null&&!Array.isArray(l)}function $r(l){var h,v,x={type:"FeatureCollection",features:[]};if(l.type==="Feature"?v=l.geometry:v=l,v.type==="LineString")h=[v.coordinates];else if(v.type==="MultiLineString")h=v.coordinates;else if(v.type==="MultiPolygon")h=[].concat.apply([],v.coordinates);else if(v.type==="Polygon")h=v.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return h.forEach(function(E){h.forEach(function(j){for(var X=0;X<E.length-1;X++)for(var re=X;re<j.length-1;re++)if(!(E===j&&(Math.abs(X-re)===1||X===0&&re===E.length-2&&E[X][0]===E[E.length-1][0]&&E[X][1]===E[E.length-1][1]))){var ge=Gi(E[X][0],E[X][1],E[X+1][0],E[X+1][1],j[re][0],j[re][1],j[re+1][0],j[re+1][1]);ge&&x.features.push(ut([ge[0],ge[1]]))}})}),x}function Gi(l,h,v,x,E,j,X,re){var ge,Le,Xe,ze,vt,Dt={x:null,y:null,onLine1:!1,onLine2:!1};return ge=(re-j)*(v-l)-(X-E)*(x-h),ge===0?Dt.x!==null&&Dt.y!==null?Dt:!1:(Le=h-j,Xe=l-E,ze=(X-E)*Le-(re-j)*Xe,vt=(v-l)*Le-(x-h)*Xe,Le=ze/ge,Xe=vt/ge,Dt.x=l+Le*(v-l),Dt.y=h+Le*(x-h),Le>=0&&Le<=1&&(Dt.onLine1=!0),Xe>=0&&Xe<=1&&(Dt.onLine2=!0),Dt.onLine1&&Dt.onLine2?[Dt.x,Dt.y]:!1)}fo.Line=fo.extend({initialize(l){this._map=l,this._shape="Line",this.toolbarButtonName="drawPolyline",this._doesSelfIntersect=!1},enable(l){L.Util.setOptions(this,l),this._enabled=!0,this._markers=[],this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.polyline([],{...this.options.templineStyle,pmIgnore:!1}),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(lr("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createVertex,this),this.options.finishOn&&this.options.finishOn!=="snap"&&this._map.on(this.options.finishOn,this._finishShape,this),this.options.finishOn==="dblclick"&&(this.tempMapDoubleClickZoomState=this._map.doubleClickZoom._enabled,this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.disable()),this._map.on("mousemove",this._syncHintMarker,this),this._hintMarker.on("move",this._syncHintLine,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this.isRed=!1,this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createVertex,this),this._map.off("mousemove",this._syncHintMarker,this),this.options.finishOn&&this.options.finishOn!=="snap"&&this._map.off(this.options.finishOn,this._finishShape,this),this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.enable(),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(l){this.enabled()?this.disable():this.enable(l)},_syncHintLine(){let l=this._layer.getLatLngs();if(l.length>0){let h=l[l.length-1];this._hintline.setLatLngs([h,this._hintMarker.getLatLng()])}},_syncHintMarker(l){if(this._hintMarker.setLatLng(l.latlng),this.options.snappable){let v=l;v.target=this._hintMarker,this._handleSnapping(v)}this.options.allowSelfIntersection||this._handleSelfIntersection(!0,this._hintMarker.getLatLng());let h=this._layer._defaultShape().slice();h.push(this._hintMarker.getLatLng()),this._change(h)},hasSelfIntersection(){return $r(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersection(l,h){let v=L.polyline(this._layer.getLatLngs());l&&(h||(h=this._hintMarker.getLatLng()),v.addLatLng(h));let x=$r(v.toGeoJSON(15));this._doesSelfIntersect=x.features.length>0,this._doesSelfIntersect?this.isRed||(this.isRed=!0,this._hintline.setStyle({color:"#f00000ff"}),this._fireIntersect(x,this._map,"Draw")):this._hintline.isEmpty()||(this.isRed=!1,this._hintline.setStyle(this.options.hintlineStyle))},_createVertex(l){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,l.latlng),this._doesSelfIntersect))return;this._hintMarker._snapped||this._hintMarker.setLatLng(l.latlng);let h=this._hintMarker.getLatLng(),v=this._layer.getLatLngs(),x=v[v.length-1];if(h.equals(v[0])||v.length>0&&h.equals(x)){this._finishShape();return}this._layer._latlngInfo=this._layer._latlngInfo||[],this._layer._latlngInfo.push({latlng:h,snapInfo:this._hintMarker._snapInfo}),this._layer.addLatLng(h);let E=this._createMarker(h);this._setTooltipText(),this._setHintLineAfterNewVertex(h),this._fireVertexAdded(E,void 0,h,"Draw"),this._change(this._layer.getLatLngs()),this.options.finishOn==="snap"&&this._hintMarker._snapped&&this._finishShape(l)},_setHintLineAfterNewVertex(l){this._hintline.setLatLngs([l,l])},_removeLastVertex(){let l=this._markers;if(l.length<=1){this.disable();return}let h=this._layer.getLatLngs(),v=l[l.length-1],{indexPath:x}=L.PM.Utils.findDeepMarkerIndex(l,v);l.pop(),this._layerGroup.removeLayer(v);let E=l[l.length-1],j=h.indexOf(E.getLatLng());h=h.slice(0,j+1),this._layer.setLatLngs(h),this._layer._latlngInfo.pop(),this._syncHintLine(),this._setTooltipText(),this._fireVertexRemoved(v,x,"Draw"),this._change(this._layer.getLatLngs())},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!1),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let l=this._layer.getLatLngs();if(l.length<=1)return;let h=L.polyline(l,this.options.pathOptions);this._setPane(h,"layerPane"),this._finishLayer(h),h.addTo(this._map.pm._getContainingLayer()),this._fireCreate(h),this.options.snappable&&this._cleanupSnapping();let v=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(v))},_createMarker(l){let h=new L.Marker(l,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(h,"vertexPane"),h._pmTempLayer=!0,this._layerGroup.addLayer(h),this._markers.push(h),h.on("click",this._finishShape,this),h},_setTooltipText(){let{length:l}=this._layer.getLatLngs().flat(),h="";l<=1?h=lr("tooltips.continueLine"):h=lr("tooltips.finishLine"),this._hintMarker.setTooltipContent(h)},_change(l){this._fireChange(l,"Draw")},setStyle(){var l,h;(l=this._layer)==null||l.setStyle(this.options.templineStyle),(h=this._hintline)==null||h.setStyle(this.options.hintlineStyle)}}),fo.Polygon=fo.Line.extend({initialize(l){this._map=l,this._shape="Polygon",this.toolbarButtonName="drawPolygon"},enable(l){L.PM.Draw.Line.prototype.enable.call(this,l),this._layer.pm._shape="Polygon"},_createMarker(l){let h=new L.Marker(l,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(h,"vertexPane"),h._pmTempLayer=!0,this._layerGroup.addLayer(h),this._markers.push(h),this._layer.getLatLngs().flat().length===1?(h.on("click",this._finishShape,this),this._tempSnapLayerIndex=this._otherSnapLayers.push(h)-1,this.options.snappable&&this._cleanupSnapping()):h.on("click",()=>1),h},_setTooltipText(){let{length:l}=this._layer.getLatLngs().flat(),h="";l<=2?h=lr("tooltips.continueLine"):h=lr("tooltips.finishPoly"),this._hintMarker.setTooltipContent(h)},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let l=this._layer.getLatLngs();if(l.length<=2)return;let h=L.polygon(l,this.options.pathOptions);this._setPane(h,"layerPane"),this._finishLayer(h),h.addTo(this._map.pm._getContainingLayer()),this._fireCreate(h),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex;let v=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(v))}}),fo.Rectangle=fo.extend({initialize(l){this._map=l,this._shape="Rectangle",this.toolbarButtonName="drawRectangle"},enable(l){if(L.Util.setOptions(this,l),this._enabled=!0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.rectangle([[0,0],[0,0]],this.options.pathOptions),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._startMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-start-marker"}),draggable:!1,zIndexOffset:-100,opacity:this.options.cursorMarker?1:0}),this._setPane(this._startMarker,"vertexPane"),this._startMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._startMarker),this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:150,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(lr("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this.options.cursorMarker){this._styleMarkers=[];for(let h=0;h<2;h+=1){let v=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-style-marker"}),draggable:!1,zIndexOffset:100});this._setPane(v,"vertexPane"),v._pmTempLayer=!0,this._layerGroup.addLayer(v),this._styleMarkers.push(v)}}this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._placeStartingMarkers,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._finishShape,this),this._map.off("click",this._placeStartingMarkers,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(l){this.enabled()?this.disable():this.enable(l)},_placeStartingMarkers(l){this._hintMarker._snapped||this._hintMarker.setLatLng(l.latlng);let h=this._hintMarker.getLatLng();L.DomUtil.addClass(this._startMarker._icon,"visible"),this._startMarker.setLatLng(h),this.options.cursorMarker&&this._styleMarkers&&this._styleMarkers.forEach(v=>{L.DomUtil.addClass(v._icon,"visible"),v.setLatLng(h)}),this._map.off("click",this._placeStartingMarkers,this),this._map.on("click",this._finishShape,this),this._hintMarker.setTooltipContent(lr("tooltips.finishRect")),this._setRectangleOrigin()},_setRectangleOrigin(){let l=this._startMarker.getLatLng();l&&(this._layerGroup.addLayer(this._layer),this._layer.setLatLngs([l,l]),this._hintMarker.on("move",this._syncRectangleSize,this))},_syncHintMarker(l){if(this._hintMarker.setLatLng(l.latlng),this.options.snappable){let v=l;v.target=this._hintMarker,this._handleSnapping(v)}let h=this._layerGroup&&this._layerGroup.hasLayer(this._layer)?this._layer.getLatLngs():[this._hintMarker.getLatLng()];this._fireChange(h,"Draw")},_syncRectangleSize(){let l=Il(this._startMarker.getLatLng(),this._map),h=Il(this._hintMarker.getLatLng(),this._map),v=L.PM.Utils._getRotatedRectangle(l,h,this.options.rectangleAngle||0,this._map);if(this._layer.setLatLngs(v),this.options.cursorMarker&&this._styleMarkers){let x=[];v.forEach(E=>{!E.equals(l,1e-8)&&!E.equals(h,1e-8)&&x.push(E)}),x.forEach((E,j)=>{try{this._styleMarkers[j].setLatLng(E)}catch{}})}},_findCorners(){let l=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(l[0],l[2],this.options.rectangleAngle||0,this._map)},_finishShape(l){this._hintMarker._snapped||this._hintMarker.setLatLng(l.latlng);let h=this._hintMarker.getLatLng(),v=this._startMarker.getLatLng();if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||v.equals(h))return;let x=L.rectangle([v,h],this.options.pathOptions);if(this.options.rectangleAngle){let j=L.PM.Utils._getRotatedRectangle(v,h,this.options.rectangleAngle||0,this._map);x.setLatLngs(j),x.pm&&x.pm._setAngle(this.options.rectangleAngle||0)}this._setPane(x,"layerPane"),this._finishLayer(x),x.addTo(this._map.pm._getContainingLayer()),this._fireCreate(x);let E=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(E))},setStyle(){var l;(l=this._layer)==null||l.setStyle(this.options.pathOptions)}}),fo.CircleMarker=fo.extend({initialize(l){this._map=l,this._shape="CircleMarker",this.toolbarButtonName="drawCircleMarker",this._layerIsDragging=!1,this._BaseCircleClass=L.CircleMarker,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._defaultRadius=10},enable(l){if(L.Util.setOptions(this,l),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),this._enabled=!0,this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._map.getContainer().classList.add("geoman-draw-cursor"),this.options[this._editableOption]){let h={};L.extend(h,this.options.templineStyle),h.radius=0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=new this._BaseCircleClass(this._map.getCenter(),h),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._centerMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon"}),draggable:!1,zIndexOffset:100}),this._setPane(this._centerMarker,"vertexPane"),this._centerMarker._pmTempLayer=!0,this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:110,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(lr("tooltips.startCircle"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._map.on("click",this._placeCenterMarker,this)}else this._map.on("click",this._createMarker,this),this._hintMarker=new this._BaseCircleClass(this._map.getCenter(),{radius:this._defaultRadius,...this.options.templineStyle}),this._setPane(this._hintMarker,"layerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this._layer=this._hintMarker,this.options.tooltips&&this._hintMarker.bindTooltip(lr("tooltips.placeCircleMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip();this._map.on("mousemove",this._syncHintMarker,this),this._extendingEnable(),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},_extendingEnable(){!this.options[this._editableOption]&&this.options.markerEditable&&this._map.eachLayer(l=>{this.isRelevantMarker(l)&&l.pm.enable()}),this._layer.bringToBack()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this.options[this._editableOption]?(this._map.off("click",this._finishShape,this),this._map.off("click",this._placeCenterMarker,this),this._map.removeLayer(this._layerGroup)):(this._map.off("click",this._createMarker,this),this._extendingDisable(),this._hintMarker.remove()),this._map.off("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},_extendingDisable(){this._map.eachLayer(l=>{this.isRelevantMarker(l)&&l.pm.disable()})},enabled(){return this._enabled},toggle(l){this.enabled()?this.disable():this.enable(l)},_placeCenterMarker(l){this._hintMarker._snapped||this._hintMarker.setLatLng(l.latlng),this._layerGroup.addLayer(this._layer),this._layerGroup.addLayer(this._centerMarker);let h=this._hintMarker.getLatLng();this._centerMarker.setLatLng(h),this._map.off("click",this._placeCenterMarker,this),this._map.on("click",this._finishShape,this),this._placeCircleCenter()},_placeCircleCenter(){let l=this._centerMarker.getLatLng();l&&(this._layer.setLatLng(l),this._hintMarker.on("move",this._syncHintLine,this),this._hintMarker.on("move",this._syncCircleRadius,this),this._hintMarker.setTooltipContent(lr("tooltips.finishCircle")),this._fireCenterPlaced(),this._fireChange(this._layer.getLatLng(),"Draw"))},_syncHintLine(){let l=this._centerMarker.getLatLng(),h=this._getNewDestinationOfHintMarker();this._hintline.setLatLngs([l,h])},_syncCircleRadius(){let l=this._centerMarker.getLatLng(),h=this._hintMarker.getLatLng(),v=this._distanceCalculation(l,h);this.options[this._minRadiusOption]&&v<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&v>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(v)},_syncHintMarker(l){if(this._hintMarker.setLatLng(l.latlng),this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker()),this.options.snappable){let v=l;v.target=this._hintMarker,this._handleSnapping(v)}this._handleHintMarkerSnapping();let h=this._layerGroup&&this._layerGroup.hasLayer(this._centerMarker)?this._centerMarker.getLatLng():this._hintMarker.getLatLng();this._fireChange(h,"Draw")},isRelevantMarker(l){return l instanceof L.CircleMarker&&!(l instanceof L.Circle)&&l.pm&&!l._pmTempLayer},_createMarker(l){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||!l.latlng||this._layerIsDragging)return;this._hintMarker._snapped||this._hintMarker.setLatLng(l.latlng);let h=this._hintMarker.getLatLng(),v=new this._BaseCircleClass(h,{radius:this._defaultRadius,...this.options.pathOptions});this._setPane(v,"layerPane"),this._finishLayer(v),v.addTo(this._map.pm._getContainingLayer()),this._extendingCreateMarker(v),this._fireCreate(v),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},_extendingCreateMarker(l){l.pm&&this.options.markerEditable&&l.pm.enable()},_finishShape(l){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(l.latlng);let h=this._centerMarker.getLatLng(),v=this._defaultRadius;if(this.options[this._editableOption]){let X=this._hintMarker.getLatLng();v=this._distanceCalculation(h,X),this.options[this._minRadiusOption]&&v<this.options[this._minRadiusOption]?v=this.options[this._minRadiusOption]:this.options[this._maxRadiusOption]&&v>this.options[this._maxRadiusOption]&&(v=this.options[this._maxRadiusOption])}let x={...this.options.pathOptions,radius:v},E=new this._BaseCircleClass(h,x);this._setPane(E,"layerPane"),this._finishLayer(E),E.addTo(this._map.pm._getContainingLayer()),E.pm&&E.pm._updateHiddenPolyCircle(),this._fireCreate(E);let j=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(j))},_getNewDestinationOfHintMarker(){let l=this._hintMarker.getLatLng();if(this.options[this._editableOption]){if(!this._layerGroup.hasLayer(this._centerMarker))return l;let h=this._centerMarker.getLatLng(),v=this._distanceCalculation(h,l);this.options[this._minRadiusOption]&&v<this.options[this._minRadiusOption]?l=Nl(this._map,h,l,this._getMinDistanceInMeter()):this.options[this._maxRadiusOption]&&v>this.options[this._maxRadiusOption]&&(l=Nl(this._map,h,l,this._getMaxDistanceInMeter()))}return l},_getMinDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,this._centerMarker.getLatLng())},_getMaxDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,this._centerMarker.getLatLng())},_handleHintMarkerSnapping(){if(this.options[this._editableOption]){if(this._hintMarker._snapped){let l=this._centerMarker.getLatLng(),h=this._hintMarker.getLatLng(),v=this._distanceCalculation(l,h);this._layerGroup.hasLayer(this._centerMarker)&&(this.options[this._minRadiusOption]&&v<this.options[this._minRadiusOption]?this._hintMarker.setLatLng(this._hintMarker._orgLatLng):this.options[this._maxRadiusOption]&&v>this.options[this._maxRadiusOption]&&this._hintMarker.setLatLng(this._hintMarker._orgLatLng))}this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker())}},setStyle(){var h,v;let l={};L.extend(l,this.options.templineStyle),this.options[this._editableOption]&&(l.radius=0),(h=this._layer)==null||h.setStyle(l),(v=this._hintline)==null||v.setStyle(this.options.hintlineStyle)},_distanceCalculation(l,h){return this._map.project(l).distanceTo(this._map.project(h))}}),fo.Circle=fo.CircleMarker.extend({initialize(l){this._map=l,this._shape="Circle",this.toolbarButtonName="drawCircle",this._BaseCircleClass=L.Circle,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizeableCircle",this._defaultRadius=100},_extendingEnable(){},_extendingDisable(){},_extendingCreateMarker(){},isRelevantMarker(){},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_distanceCalculation(l,h){return this._map.distance(l,h)}});function hi(l){if(!l)throw new Error("coord is required");if(!Array.isArray(l)){if(l.type==="Feature"&&l.geometry!==null&&l.geometry.type==="Point")return l.geometry.coordinates;if(l.type==="Point")return l.coordinates}if(Array.isArray(l)&&l.length>=2&&!Array.isArray(l[0])&&!Array.isArray(l[1]))return l;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function _i(l){if(Array.isArray(l))return l;if(l.type==="Feature"){if(l.geometry!==null)return l.geometry.coordinates}else if(l.coordinates)return l.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function ho(l){return l.type==="Feature"?l.geometry:l}function bo(l,h){return l.type==="FeatureCollection"?"FeatureCollection":l.type==="GeometryCollection"?"GeometryCollection":l.type==="Feature"&&l.geometry!==null?l.geometry.type:l.type}function Ts(l,h,v){if(l!==null)for(var x,E,j,X,re,ge,Le,Xe=0,ze=0,vt,Dt=l.type,Xt=Dt==="FeatureCollection",_n=Dt==="Feature",Sn=Xt?l.features.length:1,hr=0;hr<Sn;hr++){Le=Xt?l.features[hr].geometry:_n?l.geometry:l,vt=Le?Le.type==="GeometryCollection":!1,re=vt?Le.geometries.length:1;for(var Je=0;Je<re;Je++){var nt=0,ct=0;if(X=vt?Le.geometries[Je]:Le,X!==null){ge=X.coordinates;var Rt=X.type;switch(Xe=0,Rt){case null:break;case"Point":if(h(ge,ze,hr,nt,ct)===!1)return!1;ze++,nt++;break;case"LineString":case"MultiPoint":for(x=0;x<ge.length;x++){if(h(ge[x],ze,hr,nt,ct)===!1)return!1;ze++,Rt==="MultiPoint"&&nt++}Rt==="LineString"&&nt++;break;case"Polygon":case"MultiLineString":for(x=0;x<ge.length;x++){for(E=0;E<ge[x].length-Xe;E++){if(h(ge[x][E],ze,hr,nt,ct)===!1)return!1;ze++}Rt==="MultiLineString"&&nt++,Rt==="Polygon"&&ct++}Rt==="Polygon"&&nt++;break;case"MultiPolygon":for(x=0;x<ge.length;x++){for(ct=0,E=0;E<ge[x].length;E++){for(j=0;j<ge[x][E].length-Xe;j++){if(h(ge[x][E][j],ze,hr,nt,ct)===!1)return!1;ze++}ct++}nt++}break;case"GeometryCollection":for(x=0;x<X.geometries.length;x++)if(Ts(X.geometries[x],h)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Ur(l,h){if(l.type==="Feature")h(l,0);else if(l.type==="FeatureCollection")for(var v=0;v<l.features.length&&h(l.features[v],v)!==!1;v++);}function zo(l,h,v){var x=v;return Ur(l,function(E,j){j===0&&v===void 0?x=E:x=h(x,E,j)}),x}function ul(l,h){var v,x,E,j,X,re,ge,Le,Xe,ze,vt=0,Dt=l.type==="FeatureCollection",Xt=l.type==="Feature",_n=Dt?l.features.length:1;for(v=0;v<_n;v++){for(re=Dt?l.features[v].geometry:Xt?l.geometry:l,Le=Dt?l.features[v].properties:Xt?l.properties:{},Xe=Dt?l.features[v].bbox:Xt?l.bbox:void 0,ze=Dt?l.features[v].id:Xt?l.id:void 0,ge=re?re.type==="GeometryCollection":!1,X=ge?re.geometries.length:1,E=0;E<X;E++){if(j=ge?re.geometries[E]:re,j===null){if(h(null,vt,Le,Xe,ze)===!1)return!1;continue}switch(j.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(h(j,vt,Le,Xe,ze)===!1)return!1;break}case"GeometryCollection":{for(x=0;x<j.geometries.length;x++)if(h(j.geometries[x],vt,Le,Xe,ze)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}vt++}}function rs(l,h){ul(l,function(v,x,E,j,X){var re=v===null?null:v.type;switch(re){case null:case"Point":case"LineString":case"Polygon":return h(Ye(v,E,{bbox:j,id:X}),x,0)===!1?!1:void 0}var ge;switch(re){case"MultiPoint":ge="Point";break;case"MultiLineString":ge="LineString";break;case"MultiPolygon":ge="Polygon";break}for(var Le=0;Le<v.coordinates.length;Le++){var Xe=v.coordinates[Le],ze={type:ge,coordinates:Xe};if(h(Ye(ze,E),x,Le)===!1)return!1}})}function eu(l){if(!l)throw new Error("geojson is required");var h=[];return rs(l,function(v){na(v,h)}),Ut(h)}function na(l,h){var v=[],x=l.geometry;if(x!==null){switch(x.type){case"Polygon":v=_i(x);break;case"LineString":v=[_i(x)]}v.forEach(function(E){var j=xu(E,l.properties);j.forEach(function(X){X.id=h.length,h.push(X)})})}}function xu(l,h){var v=[];return l.reduce(function(x,E){var j=Lt([x,E],h);return j.bbox=Ga(x,E),v.push(j),E}),v}function Ga(l,h){var v=l[0],x=l[1],E=h[0],j=h[1],X=v<E?v:E,re=x<j?x:j,ge=v>E?v:E,Le=x>j?x:j;return[X,re,ge,Le]}var Ha=eu,wo=f(Ri(),1);function ra(l,h){var v={},x=[];if(l.type==="LineString"&&(l=Ye(l)),h.type==="LineString"&&(h=Ye(h)),l.type==="Feature"&&h.type==="Feature"&&l.geometry!==null&&h.geometry!==null&&l.geometry.type==="LineString"&&h.geometry.type==="LineString"&&l.geometry.coordinates.length===2&&h.geometry.coordinates.length===2){var E=Ns(l,h);return E&&x.push(E),Ut(x)}var j=(0,wo.default)();return j.load(Ha(h)),Ur(Ha(l),function(X){Ur(j.search(X),function(re){var ge=Ns(X,re);if(ge){var Le=_i(ge).join(",");v[Le]||(v[Le]=!0,x.push(ge))}})}),Ut(x)}function Ns(l,h){var v=_i(l),x=_i(h);if(v.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(x.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var E=v[0][0],j=v[0][1],X=v[1][0],re=v[1][1],ge=x[0][0],Le=x[0][1],Xe=x[1][0],ze=x[1][1],vt=(ze-Le)*(X-E)-(Xe-ge)*(re-j),Dt=(Xe-ge)*(j-Le)-(ze-Le)*(E-ge),Xt=(X-E)*(j-Le)-(re-j)*(E-ge);if(vt===0)return null;var _n=Dt/vt,Sn=Xt/vt;if(_n>=0&&_n<=1&&Sn>=0&&Sn<=1){var hr=E+_n*(X-E),Je=j+_n*(re-j);return ut([hr,Je])}return null}var gs=ra,cl=f(Ri(),1);function $o(l,h,v){v===void 0&&(v={});var x=hi(l),E=hi(h),j=ir(E[1]-x[1]),X=ir(E[0]-x[0]),re=ir(x[1]),ge=ir(E[1]),Le=Math.pow(Math.sin(j/2),2)+Math.pow(Math.sin(X/2),2)*Math.cos(re)*Math.cos(ge);return fn(2*Math.atan2(Math.sqrt(Le),Math.sqrt(1-Le)),v.units)}var is=$o;function os(l){var h=l[0],v=l[1],x=l[2],E=l[3],j=is(l.slice(0,2),[x,v]),X=is(l.slice(0,2),[h,E]);if(j>=X){var re=(v+E)/2;return[h,re-(x-h)/2,x,re+(x-h)/2]}else{var ge=(h+x)/2;return[ge-(E-v)/2,v,ge+(E-v)/2,E]}}var Xu=os;function Po(l){var h=[1/0,1/0,-1/0,-1/0];return Ts(l,function(v){h[0]>v[0]&&(h[0]=v[0]),h[1]>v[1]&&(h[1]=v[1]),h[2]<v[0]&&(h[2]=v[0]),h[3]<v[1]&&(h[3]=v[1])}),h}Po.default=Po;var ba=Po;function Uo(l,h){h===void 0&&(h={});var v=h.precision,x=h.coordinates,E=h.mutate;if(v=v==null||isNaN(v)?6:v,x=x==null||isNaN(x)?3:x,!l)throw new Error("<geojson> is required");if(typeof v!="number")throw new Error("<precision> must be a number");if(typeof x!="number")throw new Error("<coordinates> must be a number");(E===!1||E===void 0)&&(l=JSON.parse(JSON.stringify(l)));var j=Math.pow(10,v);return Ts(l,function(X){Vo(X,j,x)}),l}function Vo(l,h,v){l.length>v&&l.splice(v,l.length);for(var x=0;x<l.length;x++)l[x]=Math.round(l[x]*h)/h;return l}var wa=Uo;function xa(l,h,v){if(v===void 0&&(v={}),v.final===!0)return Go(l,h);var x=hi(l),E=hi(h),j=ir(x[0]),X=ir(E[0]),re=ir(x[1]),ge=ir(E[1]),Le=Math.sin(X-j)*Math.cos(ge),Xe=Math.cos(re)*Math.sin(ge)-Math.sin(re)*Math.cos(ge)*Math.cos(X-j);return zn(Math.atan2(Le,Xe))}function Go(l,h){var v=xa(h,l);return v=(v+180)%360,v}function To(l,h,v,x){x===void 0&&(x={});var E=hi(l),j=ir(E[0]),X=ir(E[1]),re=ir(v),ge=Dn(h,x.units),Le=Math.asin(Math.sin(X)*Math.cos(ge)+Math.cos(X)*Math.sin(ge)*Math.cos(re)),Xe=j+Math.atan2(Math.sin(re)*Math.sin(ge)*Math.cos(X),Math.cos(ge)-Math.sin(X)*Math.sin(Le)),ze=zn(Xe),vt=zn(Le);return ut([ze,vt],x.properties)}function ia(l,h,v){v===void 0&&(v={});var x=ut([1/0,1/0],{dist:1/0}),E=0;return rs(l,function(j){for(var X=_i(j),re=0;re<X.length-1;re++){var ge=ut(X[re]);ge.properties.dist=is(h,ge,v);var Le=ut(X[re+1]);Le.properties.dist=is(h,Le,v);var Xe=is(ge,Le,v),ze=Math.max(ge.properties.dist,Le.properties.dist),vt=xa(ge,Le),Dt=To(h,ze,vt+90,v),Xt=To(h,ze,vt-90,v),_n=gs(Lt([Dt.geometry.coordinates,Xt.geometry.coordinates]),Lt([ge.geometry.coordinates,Le.geometry.coordinates])),Sn=null;_n.features.length>0&&(Sn=_n.features[0],Sn.properties.dist=is(h,Sn,v),Sn.properties.location=E+is(ge,Sn,v)),ge.properties.dist<x.properties.dist&&(x=ge,x.properties.index=re,x.properties.location=E),Le.properties.dist<x.properties.dist&&(x=Le,x.properties.index=re+1,x.properties.location=E+Xe),Sn&&Sn.properties.dist<x.properties.dist&&(x=Sn,x.properties.index=re),E+=Xe}}),x}var Ds=ia;function Ho(l,h){if(!l)throw new Error("line is required");if(!h)throw new Error("splitter is required");var v=bo(l),x=bo(h);if(v!=="LineString")throw new Error("line must be LineString");if(x==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(x==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var E=wa(h,{precision:7});switch(x){case"Point":return Wt(l,E);case"MultiPoint":return _t(l,E);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return _t(l,gs(l,E))}}function _t(l,h){var v=[],x=(0,cl.default)();return rs(h,function(E){if(v.forEach(function(re,ge){re.id=ge}),!v.length)v=Wt(l,E).features,v.forEach(function(re){re.bbox||(re.bbox=Xu(ba(re)))}),x.load(Ut(v));else{var j=x.search(E);if(j.features.length){var X=Nt(E,j);v=v.filter(function(re){return re.id!==X.id}),x.remove(X),Ur(Wt(X,E),function(re){v.push(re),x.insert(re)})}}}),Ut(v)}function Wt(l,h){var v=[],x=_i(l)[0],E=_i(l)[l.geometry.coordinates.length-1];if(An(x,hi(h))||An(E,hi(h)))return Ut([l]);var j=(0,cl.default)(),X=Ha(l);j.load(X);var re=j.search(h);if(!re.features.length)return Ut([l]);var ge=Nt(h,re),Le=[x],Xe=zo(X,function(ze,vt,Dt){var Xt=_i(vt)[1],_n=hi(h);return Dt===ge.id?(ze.push(_n),v.push(Lt(ze)),An(_n,Xt)?[_n]:[_n,Xt]):(ze.push(Xt),ze)},Le);return Xe.length>1&&v.push(Lt(Xe)),Ut(v)}function Nt(l,h){if(!h.features.length)throw new Error("lines must contain features");if(h.features.length===1)return h.features[0];var v,x=1/0;return Ur(h,function(E){var j=Ds(E,l),X=j.properties.dist;X<x&&(v=E,x=X)}),v}function An(l,h){return l[0]===h[0]&&l[1]===h[1]}var Jn=Ho;function xr(l,h,v){if(v===void 0&&(v={}),!l)throw new Error("point is required");if(!h)throw new Error("polygon is required");var x=hi(l),E=ho(h),j=E.type,X=h.bbox,re=E.coordinates;if(X&&bi(x,X)===!1)return!1;j==="Polygon"&&(re=[re]);for(var ge=!1,Le=0;Le<re.length&&!ge;Le++)if(Wi(x,re[Le][0],v.ignoreBoundary)){for(var Xe=!1,ze=1;ze<re[Le].length&&!Xe;)Wi(x,re[Le][ze],!v.ignoreBoundary)&&(Xe=!0),ze++;Xe||(ge=!0)}return ge}function Wi(l,h,v){var x=!1;h[0][0]===h[h.length-1][0]&&h[0][1]===h[h.length-1][1]&&(h=h.slice(0,h.length-1));for(var E=0,j=h.length-1;E<h.length;j=E++){var X=h[E][0],re=h[E][1],ge=h[j][0],Le=h[j][1],Xe=l[1]*(X-ge)+re*(ge-l[0])+Le*(l[0]-X)===0&&(X-l[0])*(ge-l[0])<=0&&(re-l[1])*(Le-l[1])<=0;if(Xe)return!v;var ze=re>l[1]!=Le>l[1]&&l[0]<(ge-X)*(l[1]-re)/(Le-re)+X;ze&&(x=!x)}return x}function bi(l,h){return h[0]<=l[0]&&h[1]<=l[1]&&h[2]>=l[0]&&h[3]>=l[1]}function Bl(l,h,v){v===void 0&&(v={});for(var x=hi(l),E=_i(h),j=0;j<E.length-1;j++){var X=!1;if(v.ignoreEndVertices&&(j===0&&(X="start"),j===E.length-2&&(X="end"),j===0&&j+1===E.length-1&&(X="both")),ss(E[j],E[j+1],x,X,typeof v.epsilon>"u"?null:v.epsilon))return!0}return!1}function ss(l,h,v,x,E){var j=v[0],X=v[1],re=l[0],ge=l[1],Le=h[0],Xe=h[1],ze=v[0]-re,vt=v[1]-ge,Dt=Le-re,Xt=Xe-ge,_n=ze*Xt-vt*Dt;if(E!==null){if(Math.abs(_n)>E)return!1}else if(_n!==0)return!1;if(x){if(x==="start")return Math.abs(Dt)>=Math.abs(Xt)?Dt>0?re<j&&j<=Le:Le<=j&&j<re:Xt>0?ge<X&&X<=Xe:Xe<=X&&X<ge;if(x==="end")return Math.abs(Dt)>=Math.abs(Xt)?Dt>0?re<=j&&j<Le:Le<j&&j<=re:Xt>0?ge<=X&&X<Xe:Xe<X&&X<=ge;if(x==="both")return Math.abs(Dt)>=Math.abs(Xt)?Dt>0?re<j&&j<Le:Le<j&&j<re:Xt>0?ge<X&&X<Xe:Xe<X&&X<ge}else return Math.abs(Dt)>=Math.abs(Xt)?Dt>0?re<=j&&j<=Le:Le<=j&&j<=re:Xt>0?ge<=X&&X<=Xe:Xe<=X&&X<=ge;return!1}var Zi=Bl;function oa(l,h){var v=ho(l),x=ho(h),E=v.type,j=x.type,X=v.coordinates,re=x.coordinates;switch(E){case"Point":switch(j){case"Point":return ki(X,re);default:throw new Error("feature2 "+j+" geometry not supported")}case"MultiPoint":switch(j){case"Point":return La(v,x);case"MultiPoint":return sa(v,x);default:throw new Error("feature2 "+j+" geometry not supported")}case"LineString":switch(j){case"Point":return Zi(x,v,{ignoreEndVertices:!0});case"LineString":return Kr(v,x);case"MultiPoint":return aa(v,x);default:throw new Error("feature2 "+j+" geometry not supported")}case"Polygon":switch(j){case"Point":return xr(x,v,{ignoreBoundary:!0});case"LineString":return Ws(v,x);case"Polygon":return No(v,x);case"MultiPoint":return la(v,x);default:throw new Error("feature2 "+j+" geometry not supported")}default:throw new Error("feature1 "+E+" geometry not supported")}}function La(l,h){var v,x=!1;for(v=0;v<l.coordinates.length;v++)if(ki(l.coordinates[v],h.coordinates)){x=!0;break}return x}function sa(l,h){for(var v=0,x=h.coordinates;v<x.length;v++){for(var E=x[v],j=!1,X=0,re=l.coordinates;X<re.length;X++){var ge=re[X];if(ki(E,ge)){j=!0;break}}if(!j)return!1}return!0}function aa(l,h){for(var v=!1,x=0,E=h.coordinates;x<E.length;x++){var j=E[x];if(Zi(j,l,{ignoreEndVertices:!0})&&(v=!0),!Zi(j,l))return!1}return!!v}function la(l,h){for(var v=0,x=h.coordinates;v<x.length;v++){var E=x[v];if(!xr(E,l,{ignoreBoundary:!0}))return!1}return!0}function Kr(l,h){for(var v=!1,x=0,E=h.coordinates;x<E.length;x++){var j=E[x];if(Zi({type:"Point",coordinates:j},l,{ignoreEndVertices:!0})&&(v=!0),!Zi({type:"Point",coordinates:j},l,{ignoreEndVertices:!1}))return!1}return v}function Ws(l,h){var v=!1,x=0,E=ba(l),j=ba(h);if(!wi(E,j))return!1;for(x;x<h.coordinates.length-1;x++){var X=po(h.coordinates[x],h.coordinates[x+1]);if(xr({type:"Point",coordinates:X},l,{ignoreBoundary:!0})){v=!0;break}}return v}function No(l,h){if(l.type==="Feature"&&l.geometry===null||h.type==="Feature"&&h.geometry===null)return!1;var v=ba(l),x=ba(h);if(!wi(v,x))return!1;for(var E=ho(h).coordinates,j=0,X=E;j<X.length;j++)for(var re=X[j],ge=0,Le=re;ge<Le.length;ge++){var Xe=Le[ge];if(!xr(Xe,l))return!1}return!0}function wi(l,h){return!(l[0]>h[0]||l[2]<h[2]||l[1]>h[1]||l[3]<h[3])}function ki(l,h){return l[0]===h[0]&&l[1]===h[1]}function po(l,h){return[(l[0]+h[0])/2,(l[1]+h[1])/2]}var $i=f(Rr()),Is=l=>()=>l,ms=l=>{let h=l?(v,x)=>x.minus(v).abs().isLessThanOrEqualTo(l):Is(!1);return(v,x)=>h(v,x)?0:v.comparedTo(x)};function js(l){let h=l?(v,x,E,j,X)=>v.exponentiatedBy(2).isLessThanOrEqualTo(j.minus(x).exponentiatedBy(2).plus(X.minus(E).exponentiatedBy(2)).times(l)):Is(!1);return(v,x,E)=>{let j=v.x,X=v.y,re=E.x,ge=E.y,Le=X.minus(ge).times(x.x.minus(re)).minus(j.minus(re).times(x.y.minus(ge)));return h(Le,j,X,re,ge)?0:Le.comparedTo(0)}}var Lu=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,ua=Math.ceil,xo=Math.floor,ji="[BigNumber Error] ",qo=ji+"Number primitive has more than 15 significant digits: ",vs=1e14,pr=14,Sa=9007199254740991,Ea=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],Zs=1e7,as=1e9;function bc(l){var h,v,x,E=Je.prototype={constructor:Je,toString:null,valueOf:null},j=new Je(1),X=20,re=4,ge=-7,Le=21,Xe=-1e7,ze=1e7,vt=!1,Dt=1,Xt=0,_n={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},Sn="0123456789abcdefghijklmnopqrstuvwxyz",hr=!0;function Je(me,Pe){var Be,Oe,Fe,je,at,lt,pt,Et,Ct=this;if(!(Ct instanceof Je))return new Je(me,Pe);if(Pe==null){if(me&&me._isBigNumber===!0){Ct.s=me.s,!me.c||me.e>ze?Ct.c=Ct.e=null:me.e<Xe?Ct.c=[Ct.e=0]:(Ct.e=me.e,Ct.c=me.c.slice());return}if((lt=typeof me=="number")&&me*0==0){if(Ct.s=1/me<0?(me=-me,-1):1,me===~~me){for(je=0,at=me;at>=10;at/=10,je++);je>ze?Ct.c=Ct.e=null:(Ct.e=je,Ct.c=[me]);return}Et=String(me)}else{if(!Lu.test(Et=String(me)))return x(Ct,Et,lt);Ct.s=Et.charCodeAt(0)==45?(Et=Et.slice(1),-1):1}(je=Et.indexOf("."))>-1&&(Et=Et.replace(".","")),(at=Et.search(/e/i))>0?(je<0&&(je=at),je+=+Et.slice(at+1),Et=Et.substring(0,at)):je<0&&(je=Et.length)}else{if(a(Pe,2,Sn.length,"Base"),Pe==10&&hr)return Ct=new Je(me),bt(Ct,X+Ct.e+1,re);if(Et=String(me),lt=typeof me=="number"){if(me*0!=0)return x(Ct,Et,lt,Pe);if(Ct.s=1/me<0?(Et=Et.slice(1),-1):1,Je.DEBUG&&Et.replace(/^0\.0*|\./,"").length>15)throw Error(qo+me)}else Ct.s=Et.charCodeAt(0)===45?(Et=Et.slice(1),-1):1;for(Be=Sn.slice(0,Pe),je=at=0,pt=Et.length;at<pt;at++)if(Be.indexOf(Oe=Et.charAt(at))<0){if(Oe=="."){if(at>je){je=pt;continue}}else if(!Fe&&(Et==Et.toUpperCase()&&(Et=Et.toLowerCase())||Et==Et.toLowerCase()&&(Et=Et.toUpperCase()))){Fe=!0,at=-1,je=0;continue}return x(Ct,String(me),lt,Pe)}lt=!1,Et=v(Et,Pe,10,Ct.s),(je=Et.indexOf("."))>-1?Et=Et.replace(".",""):je=Et.length}for(at=0;Et.charCodeAt(at)===48;at++);for(pt=Et.length;Et.charCodeAt(--pt)===48;);if(Et=Et.slice(at,++pt)){if(pt-=at,lt&&Je.DEBUG&&pt>15&&(me>Sa||me!==xo(me)))throw Error(qo+Ct.s*me);if((je=je-at-1)>ze)Ct.c=Ct.e=null;else if(je<Xe)Ct.c=[Ct.e=0];else{if(Ct.e=je,Ct.c=[],at=(je+1)%pr,je<0&&(at+=pr),at<pt){for(at&&Ct.c.push(+Et.slice(0,at)),pt-=pr;at<pt;)Ct.c.push(+Et.slice(at,at+=pr));at=pr-(Et=Et.slice(at)).length}else at-=pt;for(;at--;Et+="0");Ct.c.push(+Et)}}else Ct.c=[Ct.e=0]}Je.clone=bc,Je.ROUND_UP=0,Je.ROUND_DOWN=1,Je.ROUND_CEIL=2,Je.ROUND_FLOOR=3,Je.ROUND_HALF_UP=4,Je.ROUND_HALF_DOWN=5,Je.ROUND_HALF_EVEN=6,Je.ROUND_HALF_CEIL=7,Je.ROUND_HALF_FLOOR=8,Je.EUCLID=9,Je.config=Je.set=function(me){var Pe,Be;if(me!=null)if(typeof me=="object"){if(me.hasOwnProperty(Pe="DECIMAL_PLACES")&&(Be=me[Pe],a(Be,0,as,Pe),X=Be),me.hasOwnProperty(Pe="ROUNDING_MODE")&&(Be=me[Pe],a(Be,0,8,Pe),re=Be),me.hasOwnProperty(Pe="EXPONENTIAL_AT")&&(Be=me[Pe],Be&&Be.pop?(a(Be[0],-1e9,0,Pe),a(Be[1],0,as,Pe),ge=Be[0],Le=Be[1]):(a(Be,-1e9,as,Pe),ge=-(Le=Be<0?-Be:Be))),me.hasOwnProperty(Pe="RANGE"))if(Be=me[Pe],Be&&Be.pop)a(Be[0],-1e9,-1,Pe),a(Be[1],1,as,Pe),Xe=Be[0],ze=Be[1];else if(a(Be,-1e9,as,Pe),Be)Xe=-(ze=Be<0?-Be:Be);else throw Error(ji+Pe+" cannot be zero: "+Be);if(me.hasOwnProperty(Pe="CRYPTO"))if(Be=me[Pe],Be===!!Be)if(Be)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))vt=Be;else throw vt=!Be,Error(ji+"crypto unavailable");else vt=Be;else throw Error(ji+Pe+" not true or false: "+Be);if(me.hasOwnProperty(Pe="MODULO_MODE")&&(Be=me[Pe],a(Be,0,9,Pe),Dt=Be),me.hasOwnProperty(Pe="POW_PRECISION")&&(Be=me[Pe],a(Be,0,as,Pe),Xt=Be),me.hasOwnProperty(Pe="FORMAT"))if(Be=me[Pe],typeof Be=="object")_n=Be;else throw Error(ji+Pe+" not an object: "+Be);if(me.hasOwnProperty(Pe="ALPHABET"))if(Be=me[Pe],typeof Be=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(Be))hr=Be.slice(0,10)=="0123456789",Sn=Be;else throw Error(ji+Pe+" invalid: "+Be)}else throw Error(ji+"Object expected: "+me);return{DECIMAL_PLACES:X,ROUNDING_MODE:re,EXPONENTIAL_AT:[ge,Le],RANGE:[Xe,ze],CRYPTO:vt,MODULO_MODE:Dt,POW_PRECISION:Xt,FORMAT:_n,ALPHABET:Sn}},Je.isBigNumber=function(me){if(!me||me._isBigNumber!==!0)return!1;if(!Je.DEBUG)return!0;var Pe,Be,Oe=me.c,Fe=me.e,je=me.s;e:if({}.toString.call(Oe)=="[object Array]"){if((je===1||je===-1)&&Fe>=-1e9&&Fe<=as&&Fe===xo(Fe)){if(Oe[0]===0){if(Fe===0&&Oe.length===1)return!0;break e}if(Pe=(Fe+1)%pr,Pe<1&&(Pe+=pr),String(Oe[0]).length==Pe){for(Pe=0;Pe<Oe.length;Pe++)if(Be=Oe[Pe],Be<0||Be>=vs||Be!==xo(Be))break e;if(Be!==0)return!0}}}else if(Oe===null&&Fe===null&&(je===null||je===1||je===-1))return!0;throw Error(ji+"Invalid BigNumber: "+me)},Je.maximum=Je.max=function(){return ct(arguments,-1)},Je.minimum=Je.min=function(){return ct(arguments,1)},Je.random=function(){var me=9007199254740992,Pe=Math.random()*me&2097151?function(){return xo(Math.random()*me)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(Be){var Oe,Fe,je,at,lt,pt=0,Et=[],Ct=new Je(j);if(Be==null?Be=X:a(Be,0,as),at=ua(Be/pr),vt)if(crypto.getRandomValues){for(Oe=crypto.getRandomValues(new Uint32Array(at*=2));pt<at;)lt=Oe[pt]*131072+(Oe[pt+1]>>>11),lt>=9e15?(Fe=crypto.getRandomValues(new Uint32Array(2)),Oe[pt]=Fe[0],Oe[pt+1]=Fe[1]):(Et.push(lt%1e14),pt+=2);pt=at/2}else if(crypto.randomBytes){for(Oe=crypto.randomBytes(at*=7);pt<at;)lt=(Oe[pt]&31)*281474976710656+Oe[pt+1]*1099511627776+Oe[pt+2]*4294967296+Oe[pt+3]*16777216+(Oe[pt+4]<<16)+(Oe[pt+5]<<8)+Oe[pt+6],lt>=9e15?crypto.randomBytes(7).copy(Oe,pt):(Et.push(lt%1e14),pt+=7);pt=at/7}else throw vt=!1,Error(ji+"crypto unavailable");if(!vt)for(;pt<at;)lt=Pe(),lt<9e15&&(Et[pt++]=lt%1e14);for(at=Et[--pt],Be%=pr,at&&Be&&(lt=Ea[pr-Be],Et[pt]=xo(at/lt)*lt);Et[pt]===0;Et.pop(),pt--);if(pt<0)Et=[je=0];else{for(je=-1;Et[0]===0;Et.splice(0,1),je-=pr);for(pt=1,lt=Et[0];lt>=10;lt/=10,pt++);pt<pr&&(je-=pr-pt)}return Ct.e=je,Ct.c=Et,Ct}}(),Je.sum=function(){for(var me=1,Pe=arguments,Be=new Je(Pe[0]);me<Pe.length;)Be=Be.plus(Pe[me++]);return Be},v=function(){var me="0123456789";function Pe(Be,Oe,Fe,je){for(var at,lt=[0],pt,Et=0,Ct=Be.length;Et<Ct;){for(pt=lt.length;pt--;lt[pt]*=Oe);for(lt[0]+=je.indexOf(Be.charAt(Et++)),at=0;at<lt.length;at++)lt[at]>Fe-1&&(lt[at+1]==null&&(lt[at+1]=0),lt[at+1]+=lt[at]/Fe|0,lt[at]%=Fe)}return lt.reverse()}return function(Be,Oe,Fe,je,at){var lt,pt,Et,Ct,on,$n,Wn,nr,gi=Be.indexOf("."),Ti=X,Yr=re;for(gi>=0&&(Ct=Xt,Xt=0,Be=Be.replace(".",""),nr=new Je(Oe),$n=nr.pow(Be.length-gi),Xt=Ct,nr.c=Pe(V(Io($n.c),$n.e,"0"),10,Fe,me),nr.e=nr.c.length),Wn=Pe(Be,Oe,Fe,at?(lt=Sn,me):(lt=me,Sn)),Et=Ct=Wn.length;Wn[--Ct]==0;Wn.pop());if(!Wn[0])return lt.charAt(0);if(gi<0?--Et:($n.c=Wn,$n.e=Et,$n.s=je,$n=h($n,nr,Ti,Yr,Fe),Wn=$n.c,on=$n.r,Et=$n.e),pt=Et+Ti+1,gi=Wn[pt],Ct=Fe/2,on=on||pt<0||Wn[pt+1]!=null,on=Yr<4?(gi!=null||on)&&(Yr==0||Yr==($n.s<0?3:2)):gi>Ct||gi==Ct&&(Yr==4||on||Yr==6&&Wn[pt-1]&1||Yr==($n.s<0?8:7)),pt<1||!Wn[0])Be=on?V(lt.charAt(1),-Ti,lt.charAt(0)):lt.charAt(0);else{if(Wn.length=pt,on)for(--Fe;++Wn[--pt]>Fe;)Wn[pt]=0,pt||(++Et,Wn=[1].concat(Wn));for(Ct=Wn.length;!Wn[--Ct];);for(gi=0,Be="";gi<=Ct;Be+=lt.charAt(Wn[gi++]));Be=V(Be,Et,lt.charAt(0))}return Be}}(),h=function(){function me(Oe,Fe,je){var at,lt,pt,Et,Ct=0,on=Oe.length,$n=Fe%Zs,Wn=Fe/Zs|0;for(Oe=Oe.slice();on--;)pt=Oe[on]%Zs,Et=Oe[on]/Zs|0,at=Wn*pt+Et*$n,lt=$n*pt+at%Zs*Zs+Ct,Ct=(lt/je|0)+(at/Zs|0)+Wn*Et,Oe[on]=lt%je;return Ct&&(Oe=[Ct].concat(Oe)),Oe}function Pe(Oe,Fe,je,at){var lt,pt;if(je!=at)pt=je>at?1:-1;else for(lt=pt=0;lt<je;lt++)if(Oe[lt]!=Fe[lt]){pt=Oe[lt]>Fe[lt]?1:-1;break}return pt}function Be(Oe,Fe,je,at){for(var lt=0;je--;)Oe[je]-=lt,lt=Oe[je]<Fe[je]?1:0,Oe[je]=lt*at+Oe[je]-Fe[je];for(;!Oe[0]&&Oe.length>1;Oe.splice(0,1));}return function(Oe,Fe,je,at,lt){var pt,Et,Ct,on,$n,Wn,nr,gi,Ti,Yr,Ui,bs,Eu,fa,Df,Wa,ec,ha=Oe.s==Fe.s?1:-1,Zo=Oe.c,go=Fe.c;if(!Zo||!Zo[0]||!go||!go[0])return new Je(!Oe.s||!Fe.s||(Zo?go&&Zo[0]==go[0]:!go)?NaN:Zo&&Zo[0]==0||!go?ha*0:ha/0);for(gi=new Je(ha),Ti=gi.c=[],Et=Oe.e-Fe.e,ha=je+Et+1,lt||(lt=vs,Et=Do(Oe.e/pr)-Do(Fe.e/pr),ha=ha/pr|0),Ct=0;go[Ct]==(Zo[Ct]||0);Ct++);if(go[Ct]>(Zo[Ct]||0)&&Et--,ha<0)Ti.push(1),on=!0;else{for(fa=Zo.length,Wa=go.length,Ct=0,ha+=2,$n=xo(lt/(go[0]+1)),$n>1&&(go=me(go,$n,lt),Zo=me(Zo,$n,lt),Wa=go.length,fa=Zo.length),Eu=Wa,Yr=Zo.slice(0,Wa),Ui=Yr.length;Ui<Wa;Yr[Ui++]=0);ec=go.slice(),ec=[0].concat(ec),Df=go[0],go[1]>=lt/2&&Df++;do{if($n=0,pt=Pe(go,Yr,Wa,Ui),pt<0){if(bs=Yr[0],Wa!=Ui&&(bs=bs*lt+(Yr[1]||0)),$n=xo(bs/Df),$n>1)for($n>=lt&&($n=lt-1),Wn=me(go,$n,lt),nr=Wn.length,Ui=Yr.length;Pe(Wn,Yr,nr,Ui)==1;)$n--,Be(Wn,Wa<nr?ec:go,nr,lt),nr=Wn.length,pt=1;else $n==0&&(pt=$n=1),Wn=go.slice(),nr=Wn.length;if(nr<Ui&&(Wn=[0].concat(Wn)),Be(Yr,Wn,Ui,lt),Ui=Yr.length,pt==-1)for(;Pe(go,Yr,Wa,Ui)<1;)$n++,Be(Yr,Wa<Ui?ec:go,Ui,lt),Ui=Yr.length}else pt===0&&($n++,Yr=[0]);Ti[Ct++]=$n,Yr[0]?Yr[Ui++]=Zo[Eu]||0:(Yr=[Zo[Eu]],Ui=1)}while((Eu++<fa||Yr[0]!=null)&&ha--);on=Yr[0]!=null,Ti[0]||Ti.splice(0,1)}if(lt==vs){for(Ct=1,ha=Ti[0];ha>=10;ha/=10,Ct++);bt(gi,je+(gi.e=Ct+Et*pr-1)+1,at,on)}else gi.e=Et,gi.r=+on;return gi}}();function nt(me,Pe,Be,Oe){var Fe,je,at,lt,pt;if(Be==null?Be=re:a(Be,0,8),!me.c)return me.toString();if(Fe=me.c[0],at=me.e,Pe==null)pt=Io(me.c),pt=Oe==1||Oe==2&&(at<=ge||at>=Le)?S(pt,at):V(pt,at,"0");else if(me=bt(new Je(me),Pe,Be),je=me.e,pt=Io(me.c),lt=pt.length,Oe==1||Oe==2&&(Pe<=je||je<=ge)){for(;lt<Pe;pt+="0",lt++);pt=S(pt,je)}else if(Pe-=at,pt=V(pt,je,"0"),je+1>lt){if(--Pe>0)for(pt+=".";Pe--;pt+="0");}else if(Pe+=je-lt,Pe>0)for(je+1==lt&&(pt+=".");Pe--;pt+="0");return me.s<0&&Fe?"-"+pt:pt}function ct(me,Pe){for(var Be,Oe,Fe=1,je=new Je(me[0]);Fe<me.length;Fe++)Oe=new Je(me[Fe]),(!Oe.s||(Be=Ks(je,Oe))===Pe||Be===0&&je.s===Pe)&&(je=Oe);return je}function Rt(me,Pe,Be){for(var Oe=1,Fe=Pe.length;!Pe[--Fe];Pe.pop());for(Fe=Pe[0];Fe>=10;Fe/=10,Oe++);return(Be=Oe+Be*pr-1)>ze?me.c=me.e=null:Be<Xe?me.c=[me.e=0]:(me.e=Be,me.c=Pe),me}x=function(){var me=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Pe=/^([^.]+)\.$/,Be=/^\.([^.]+)$/,Oe=/^-?(Infinity|NaN)$/,Fe=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(je,at,lt,pt){var Et,Ct=lt?at:at.replace(Fe,"");if(Oe.test(Ct))je.s=isNaN(Ct)?null:Ct<0?-1:1;else{if(!lt&&(Ct=Ct.replace(me,function(on,$n,Wn){return Et=(Wn=Wn.toLowerCase())=="x"?16:Wn=="b"?2:8,!pt||pt==Et?$n:on}),pt&&(Et=pt,Ct=Ct.replace(Pe,"$1").replace(Be,"0.$1")),at!=Ct))return new Je(Ct,Et);if(Je.DEBUG)throw Error(ji+"Not a"+(pt?" base "+pt:"")+" number: "+at);je.s=null}je.c=je.e=null}}();function bt(me,Pe,Be,Oe){var Fe,je,at,lt,pt,Et,Ct,on=me.c,$n=Ea;if(on){e:{for(Fe=1,lt=on[0];lt>=10;lt/=10,Fe++);if(je=Pe-Fe,je<0)je+=pr,at=Pe,pt=on[Et=0],Ct=xo(pt/$n[Fe-at-1]%10);else if(Et=ua((je+1)/pr),Et>=on.length)if(Oe){for(;on.length<=Et;on.push(0));pt=Ct=0,Fe=1,je%=pr,at=je-pr+1}else break e;else{for(pt=lt=on[Et],Fe=1;lt>=10;lt/=10,Fe++);je%=pr,at=je-pr+Fe,Ct=at<0?0:xo(pt/$n[Fe-at-1]%10)}if(Oe=Oe||Pe<0||on[Et+1]!=null||(at<0?pt:pt%$n[Fe-at-1]),Oe=Be<4?(Ct||Oe)&&(Be==0||Be==(me.s<0?3:2)):Ct>5||Ct==5&&(Be==4||Oe||Be==6&&(je>0?at>0?pt/$n[Fe-at]:0:on[Et-1])%10&1||Be==(me.s<0?8:7)),Pe<1||!on[0])return on.length=0,Oe?(Pe-=me.e+1,on[0]=$n[(pr-Pe%pr)%pr],me.e=-Pe||0):on[0]=me.e=0,me;if(je==0?(on.length=Et,lt=1,Et--):(on.length=Et+1,lt=$n[pr-je],on[Et]=at>0?xo(pt/$n[Fe-at]%$n[at])*lt:0),Oe)for(;;)if(Et==0){for(je=1,at=on[0];at>=10;at/=10,je++);for(at=on[0]+=lt,lt=1;at>=10;at/=10,lt++);je!=lt&&(me.e++,on[0]==vs&&(on[0]=1));break}else{if(on[Et]+=lt,on[Et]!=vs)break;on[Et--]=0,lt=1}for(je=on.length;on[--je]===0;on.pop());}me.e>ze?me.c=me.e=null:me.e<Xe&&(me.c=[me.e=0])}return me}function It(me){var Pe,Be=me.e;return Be===null?me.toString():(Pe=Io(me.c),Pe=Be<=ge||Be>=Le?S(Pe,Be):V(Pe,Be,"0"),me.s<0?"-"+Pe:Pe)}return E.absoluteValue=E.abs=function(){var me=new Je(this);return me.s<0&&(me.s=1),me},E.comparedTo=function(me,Pe){return Ks(this,new Je(me,Pe))},E.decimalPlaces=E.dp=function(me,Pe){var Be,Oe,Fe,je=this;if(me!=null)return a(me,0,as),Pe==null?Pe=re:a(Pe,0,8),bt(new Je(je),me+je.e+1,Pe);if(!(Be=je.c))return null;if(Oe=((Fe=Be.length-1)-Do(this.e/pr))*pr,Fe=Be[Fe])for(;Fe%10==0;Fe/=10,Oe--);return Oe<0&&(Oe=0),Oe},E.dividedBy=E.div=function(me,Pe){return h(this,new Je(me,Pe),X,re)},E.dividedToIntegerBy=E.idiv=function(me,Pe){return h(this,new Je(me,Pe),0,1)},E.exponentiatedBy=E.pow=function(me,Pe){var Be,Oe,Fe,je,at,lt,pt,Et,Ct,on=this;if(me=new Je(me),me.c&&!me.isInteger())throw Error(ji+"Exponent not an integer: "+It(me));if(Pe!=null&&(Pe=new Je(Pe)),lt=me.e>14,!on.c||!on.c[0]||on.c[0]==1&&!on.e&&on.c.length==1||!me.c||!me.c[0])return Ct=new Je(Math.pow(+It(on),lt?me.s*(2-p(me)):+It(me))),Pe?Ct.mod(Pe):Ct;if(pt=me.s<0,Pe){if(Pe.c?!Pe.c[0]:!Pe.s)return new Je(NaN);Oe=!pt&&on.isInteger()&&Pe.isInteger(),Oe&&(on=on.mod(Pe))}else{if(me.e>9&&(on.e>0||on.e<-1||(on.e==0?on.c[0]>1||lt&&on.c[1]>=24e7:on.c[0]<8e13||lt&&on.c[0]<=9999975e7)))return je=on.s<0&&p(me)?-0:0,on.e>-1&&(je=1/je),new Je(pt?1/je:je);Xt&&(je=ua(Xt/pr+2))}for(lt?(Be=new Je(.5),pt&&(me.s=1),Et=p(me)):(Fe=Math.abs(+It(me)),Et=Fe%2),Ct=new Je(j);;){if(Et){if(Ct=Ct.times(on),!Ct.c)break;je?Ct.c.length>je&&(Ct.c.length=je):Oe&&(Ct=Ct.mod(Pe))}if(Fe){if(Fe=xo(Fe/2),Fe===0)break;Et=Fe%2}else if(me=me.times(Be),bt(me,me.e+1,1),me.e>14)Et=p(me);else{if(Fe=+It(me),Fe===0)break;Et=Fe%2}on=on.times(on),je?on.c&&on.c.length>je&&(on.c.length=je):Oe&&(on=on.mod(Pe))}return Oe?Ct:(pt&&(Ct=j.div(Ct)),Pe?Ct.mod(Pe):je?bt(Ct,Xt,re,at):Ct)},E.integerValue=function(me){var Pe=new Je(this);return me==null?me=re:a(me,0,8),bt(Pe,Pe.e+1,me)},E.isEqualTo=E.eq=function(me,Pe){return Ks(this,new Je(me,Pe))===0},E.isFinite=function(){return!!this.c},E.isGreaterThan=E.gt=function(me,Pe){return Ks(this,new Je(me,Pe))>0},E.isGreaterThanOrEqualTo=E.gte=function(me,Pe){return(Pe=Ks(this,new Je(me,Pe)))===1||Pe===0},E.isInteger=function(){return!!this.c&&Do(this.e/pr)>this.c.length-2},E.isLessThan=E.lt=function(me,Pe){return Ks(this,new Je(me,Pe))<0},E.isLessThanOrEqualTo=E.lte=function(me,Pe){return(Pe=Ks(this,new Je(me,Pe)))===-1||Pe===0},E.isNaN=function(){return!this.s},E.isNegative=function(){return this.s<0},E.isPositive=function(){return this.s>0},E.isZero=function(){return!!this.c&&this.c[0]==0},E.minus=function(me,Pe){var Be,Oe,Fe,je,at=this,lt=at.s;if(me=new Je(me,Pe),Pe=me.s,!lt||!Pe)return new Je(NaN);if(lt!=Pe)return me.s=-Pe,at.plus(me);var pt=at.e/pr,Et=me.e/pr,Ct=at.c,on=me.c;if(!pt||!Et){if(!Ct||!on)return Ct?(me.s=-Pe,me):new Je(on?at:NaN);if(!Ct[0]||!on[0])return on[0]?(me.s=-Pe,me):new Je(Ct[0]?at:re==3?-0:0)}if(pt=Do(pt),Et=Do(Et),Ct=Ct.slice(),lt=pt-Et){for((je=lt<0)?(lt=-lt,Fe=Ct):(Et=pt,Fe=on),Fe.reverse(),Pe=lt;Pe--;Fe.push(0));Fe.reverse()}else for(Oe=(je=(lt=Ct.length)<(Pe=on.length))?lt:Pe,lt=Pe=0;Pe<Oe;Pe++)if(Ct[Pe]!=on[Pe]){je=Ct[Pe]<on[Pe];break}if(je&&(Fe=Ct,Ct=on,on=Fe,me.s=-me.s),Pe=(Oe=on.length)-(Be=Ct.length),Pe>0)for(;Pe--;Ct[Be++]=0);for(Pe=vs-1;Oe>lt;){if(Ct[--Oe]<on[Oe]){for(Be=Oe;Be&&!Ct[--Be];Ct[Be]=Pe);--Ct[Be],Ct[Oe]+=vs}Ct[Oe]-=on[Oe]}for(;Ct[0]==0;Ct.splice(0,1),--Et);return Ct[0]?Rt(me,Ct,Et):(me.s=re==3?-1:1,me.c=[me.e=0],me)},E.modulo=E.mod=function(me,Pe){var Be,Oe,Fe=this;return me=new Je(me,Pe),!Fe.c||!me.s||me.c&&!me.c[0]?new Je(NaN):!me.c||Fe.c&&!Fe.c[0]?new Je(Fe):(Dt==9?(Oe=me.s,me.s=1,Be=h(Fe,me,0,3),me.s=Oe,Be.s*=Oe):Be=h(Fe,me,0,Dt),me=Fe.minus(Be.times(me)),!me.c[0]&&Dt==1&&(me.s=Fe.s),me)},E.multipliedBy=E.times=function(me,Pe){var Be,Oe,Fe,je,at,lt,pt,Et,Ct,on,$n,Wn,nr,gi,Ti,Yr=this,Ui=Yr.c,bs=(me=new Je(me,Pe)).c;if(!Ui||!bs||!Ui[0]||!bs[0])return!Yr.s||!me.s||Ui&&!Ui[0]&&!bs||bs&&!bs[0]&&!Ui?me.c=me.e=me.s=null:(me.s*=Yr.s,!Ui||!bs?me.c=me.e=null:(me.c=[0],me.e=0)),me;for(Oe=Do(Yr.e/pr)+Do(me.e/pr),me.s*=Yr.s,pt=Ui.length,on=bs.length,pt<on&&(nr=Ui,Ui=bs,bs=nr,Fe=pt,pt=on,on=Fe),Fe=pt+on,nr=[];Fe--;nr.push(0));for(gi=vs,Ti=Zs,Fe=on;--Fe>=0;){for(Be=0,$n=bs[Fe]%Ti,Wn=bs[Fe]/Ti|0,at=pt,je=Fe+at;je>Fe;)Et=Ui[--at]%Ti,Ct=Ui[at]/Ti|0,lt=Wn*Et+Ct*$n,Et=$n*Et+lt%Ti*Ti+nr[je]+Be,Be=(Et/gi|0)+(lt/Ti|0)+Wn*Ct,nr[je--]=Et%gi;nr[je]=Be}return Be?++Oe:nr.splice(0,1),Rt(me,nr,Oe)},E.negated=function(){var me=new Je(this);return me.s=-me.s||null,me},E.plus=function(me,Pe){var Be,Oe=this,Fe=Oe.s;if(me=new Je(me,Pe),Pe=me.s,!Fe||!Pe)return new Je(NaN);if(Fe!=Pe)return me.s=-Pe,Oe.minus(me);var je=Oe.e/pr,at=me.e/pr,lt=Oe.c,pt=me.c;if(!je||!at){if(!lt||!pt)return new Je(Fe/0);if(!lt[0]||!pt[0])return pt[0]?me:new Je(lt[0]?Oe:Fe*0)}if(je=Do(je),at=Do(at),lt=lt.slice(),Fe=je-at){for(Fe>0?(at=je,Be=pt):(Fe=-Fe,Be=lt),Be.reverse();Fe--;Be.push(0));Be.reverse()}for(Fe=lt.length,Pe=pt.length,Fe-Pe<0&&(Be=pt,pt=lt,lt=Be,Pe=Fe),Fe=0;Pe;)Fe=(lt[--Pe]=lt[Pe]+pt[Pe]+Fe)/vs|0,lt[Pe]=vs===lt[Pe]?0:lt[Pe]%vs;return Fe&&(lt=[Fe].concat(lt),++at),Rt(me,lt,at)},E.precision=E.sd=function(me,Pe){var Be,Oe,Fe,je=this;if(me!=null&&me!==!!me)return a(me,1,as),Pe==null?Pe=re:a(Pe,0,8),bt(new Je(je),me,Pe);if(!(Be=je.c))return null;if(Fe=Be.length-1,Oe=Fe*pr+1,Fe=Be[Fe]){for(;Fe%10==0;Fe/=10,Oe--);for(Fe=Be[0];Fe>=10;Fe/=10,Oe++);}return me&&je.e+1>Oe&&(Oe=je.e+1),Oe},E.shiftedBy=function(me){return a(me,-9007199254740991,Sa),this.times("1e"+me)},E.squareRoot=E.sqrt=function(){var me,Pe,Be,Oe,Fe,je=this,at=je.c,lt=je.s,pt=je.e,Et=X+4,Ct=new Je("0.5");if(lt!==1||!at||!at[0])return new Je(!lt||lt<0&&(!at||at[0])?NaN:at?je:1/0);if(lt=Math.sqrt(+It(je)),lt==0||lt==1/0?(Pe=Io(at),(Pe.length+pt)%2==0&&(Pe+="0"),lt=Math.sqrt(+Pe),pt=Do((pt+1)/2)-(pt<0||pt%2),lt==1/0?Pe="5e"+pt:(Pe=lt.toExponential(),Pe=Pe.slice(0,Pe.indexOf("e")+1)+pt),Be=new Je(Pe)):Be=new Je(lt+""),Be.c[0]){for(pt=Be.e,lt=pt+Et,lt<3&&(lt=0);;)if(Fe=Be,Be=Ct.times(Fe.plus(h(je,Fe,Et,1))),Io(Fe.c).slice(0,lt)===(Pe=Io(Be.c)).slice(0,lt))if(Be.e<pt&&--lt,Pe=Pe.slice(lt-3,lt+1),Pe=="9999"||!Oe&&Pe=="4999"){if(!Oe&&(bt(Fe,Fe.e+X+2,0),Fe.times(Fe).eq(je))){Be=Fe;break}Et+=4,lt+=4,Oe=1}else{(!+Pe||!+Pe.slice(1)&&Pe.charAt(0)=="5")&&(bt(Be,Be.e+X+2,1),me=!Be.times(Be).eq(je));break}}return bt(Be,Be.e+X+1,re,me)},E.toExponential=function(me,Pe){return me!=null&&(a(me,0,as),me++),nt(this,me,Pe,1)},E.toFixed=function(me,Pe){return me!=null&&(a(me,0,as),me=me+this.e+1),nt(this,me,Pe)},E.toFormat=function(me,Pe,Be){var Oe,Fe=this;if(Be==null)me!=null&&Pe&&typeof Pe=="object"?(Be=Pe,Pe=null):me&&typeof me=="object"?(Be=me,me=Pe=null):Be=_n;else if(typeof Be!="object")throw Error(ji+"Argument not an object: "+Be);if(Oe=Fe.toFixed(me,Pe),Fe.c){var je,at=Oe.split("."),lt=+Be.groupSize,pt=+Be.secondaryGroupSize,Et=Be.groupSeparator||"",Ct=at[0],on=at[1],$n=Fe.s<0,Wn=$n?Ct.slice(1):Ct,nr=Wn.length;if(pt&&(je=lt,lt=pt,pt=je,nr-=je),lt>0&&nr>0){for(je=nr%lt||lt,Ct=Wn.substr(0,je);je<nr;je+=lt)Ct+=Et+Wn.substr(je,lt);pt>0&&(Ct+=Et+Wn.slice(je)),$n&&(Ct="-"+Ct)}Oe=on?Ct+(Be.decimalSeparator||"")+((pt=+Be.fractionGroupSize)?on.replace(new RegExp("\\d{"+pt+"}\\B","g"),"$&"+(Be.fractionGroupSeparator||"")):on):Ct}return(Be.prefix||"")+Oe+(Be.suffix||"")},E.toFraction=function(me){var Pe,Be,Oe,Fe,je,at,lt,pt,Et,Ct,on,$n,Wn=this,nr=Wn.c;if(me!=null&&(lt=new Je(me),!lt.isInteger()&&(lt.c||lt.s!==1)||lt.lt(j)))throw Error(ji+"Argument "+(lt.isInteger()?"out of range: ":"not an integer: ")+It(lt));if(!nr)return new Je(Wn);for(Pe=new Je(j),Et=Be=new Je(j),Oe=pt=new Je(j),$n=Io(nr),je=Pe.e=$n.length-Wn.e-1,Pe.c[0]=Ea[(at=je%pr)<0?pr+at:at],me=!me||lt.comparedTo(Pe)>0?je>0?Pe:Et:lt,at=ze,ze=1/0,lt=new Je($n),pt.c[0]=0;Ct=h(lt,Pe,0,1),Fe=Be.plus(Ct.times(Oe)),Fe.comparedTo(me)!=1;)Be=Oe,Oe=Fe,Et=pt.plus(Ct.times(Fe=Et)),pt=Fe,Pe=lt.minus(Ct.times(Fe=Pe)),lt=Fe;return Fe=h(me.minus(Be),Oe,0,1),pt=pt.plus(Fe.times(Et)),Be=Be.plus(Fe.times(Oe)),pt.s=Et.s=Wn.s,je=je*2,on=h(Et,Oe,je,re).minus(Wn).abs().comparedTo(h(pt,Be,je,re).minus(Wn).abs())<1?[Et,Oe]:[pt,Be],ze=at,on},E.toNumber=function(){return+It(this)},E.toPrecision=function(me,Pe){return me!=null&&a(me,1,as),nt(this,me,Pe,2)},E.toString=function(me){var Pe,Be=this,Oe=Be.s,Fe=Be.e;return Fe===null?Oe?(Pe="Infinity",Oe<0&&(Pe="-"+Pe)):Pe="NaN":(me==null?Pe=Fe<=ge||Fe>=Le?S(Io(Be.c),Fe):V(Io(Be.c),Fe,"0"):me===10&&hr?(Be=bt(new Je(Be),X+Fe+1,re),Pe=V(Io(Be.c),Be.e,"0")):(a(me,2,Sn.length,"Base"),Pe=v(V(Io(Be.c),Fe,"0"),10,me,Oe,!0)),Oe<0&&Be.c[0]&&(Pe="-"+Pe)),Pe},E.valueOf=E.toJSON=function(){return It(this)},E._isBigNumber=!0,E[Symbol.toStringTag]="BigNumber",E[Symbol.for("nodejs.util.inspect.custom")]=E.valueOf,l!=null&&Je.set(l),Je}function Do(l){var h=l|0;return l>0||l===h?h:h-1}function Io(l){for(var h,v,x=1,E=l.length,j=l[0]+"";x<E;){for(h=l[x++]+"",v=pr-h.length;v--;h="0"+h);j+=h}for(E=j.length;j.charCodeAt(--E)===48;);return j.slice(0,E+1||1)}function Ks(l,h){var v,x,E=l.c,j=h.c,X=l.s,re=h.s,ge=l.e,Le=h.e;if(!X||!re)return null;if(v=E&&!E[0],x=j&&!j[0],v||x)return v?x?0:-re:X;if(X!=re)return X;if(v=X<0,x=ge==Le,!E||!j)return x?0:!E^v?1:-1;if(!x)return ge>Le^v?1:-1;for(re=(ge=E.length)<(Le=j.length)?ge:Le,X=0;X<re;X++)if(E[X]!=j[X])return E[X]>j[X]^v?1:-1;return ge==Le?0:ge>Le^v?1:-1}function a(l,h,v,x){if(l<h||l>v||l!==xo(l))throw Error(ji+(x||"Argument")+(typeof l=="number"?l<h||l>v?" out of range: ":" not an integer: ":" not a primitive number: ")+String(l))}function p(l){var h=l.c.length-1;return Do(l.e/pr)==h&&l.c[h]%2!=0}function S(l,h){return(l.length>1?l.charAt(0)+"."+l.slice(1):l)+(h<0?"e":"e+")+h}function V(l,h,v){var x,E;if(h<0){for(E=v+".";++h;E+=v);l=E+l}else if(x=l.length,++h>x){for(E=v,h-=x;--h;E+=v);l+=E}else h<x&&(l=l.slice(0,h)+"."+l.slice(h));return l}var se=bc(),Se=se,st=class{constructor(l){qt(this,"key");qt(this,"left",null);qt(this,"right",null);this.key=l}},At=class extends st{constructor(l){super(l)}},Vt=class{constructor(){qt(this,"size",0);qt(this,"modificationCount",0);qt(this,"splayCount",0)}splay(l){let h=this.root;if(h==null)return this.compare(l,l),-1;let v=null,x=null,E=null,j=null,X=h,re=this.compare,ge;for(;;)if(ge=re(X.key,l),ge>0){let Le=X.left;if(Le==null||(ge=re(Le.key,l),ge>0&&(X.left=Le.right,Le.right=X,X=Le,Le=X.left,Le==null)))break;v==null?x=X:v.left=X,v=X,X=Le}else if(ge<0){let Le=X.right;if(Le==null||(ge=re(Le.key,l),ge<0&&(X.right=Le.left,Le.left=X,X=Le,Le=X.right,Le==null)))break;E==null?j=X:E.right=X,E=X,X=Le}else break;return E!=null&&(E.right=X.left,X.left=j),v!=null&&(v.left=X.right,X.right=x),this.root!==X&&(this.root=X,this.splayCount++),ge}splayMin(l){let h=l,v=h.left;for(;v!=null;){let x=v;h.left=x.right,x.right=h,h=x,v=h.left}return h}splayMax(l){let h=l,v=h.right;for(;v!=null;){let x=v;h.right=x.left,x.left=h,h=x,v=h.right}return h}_delete(l){if(this.root==null||this.splay(l)!=0)return null;let h=this.root,v=h,x=h.left;if(this.size--,x==null)this.root=h.right;else{let E=h.right;h=this.splayMax(x),h.right=E,this.root=h}return this.modificationCount++,v}addNewRoot(l,h){this.size++,this.modificationCount++;let v=this.root;if(v==null){this.root=l;return}h<0?(l.left=v,l.right=v.right,v.right=null):(l.right=v,l.left=v.left,v.left=null),this.root=l}_first(){let l=this.root;return l==null?null:(this.root=this.splayMin(l),this.root)}_last(){let l=this.root;return l==null?null:(this.root=this.splayMax(l),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(l){return this.validKey(l)&&this.splay(l)==0}defaultCompare(){return(l,h)=>l<h?-1:l>h?1:0}wrap(){return{getRoot:()=>this.root,setRoot:l=>{this.root=l},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:l=>{this.splayCount=l},splay:l=>this.splay(l),has:l=>this.has(l)}}},sn=class Gd extends Vt{constructor(v,x){super();qt(this,"root",null);qt(this,"compare");qt(this,"validKey");qt(this,Pn,"[object Set]");this.compare=v??this.defaultCompare(),this.validKey=x??(E=>E!=null&&E!=null)}delete(v){return this.validKey(v)?this._delete(v)!=null:!1}deleteAll(v){for(let x of v)this.delete(x)}forEach(v){let x=this[Symbol.iterator](),E;for(;E=x.next(),!E.done;)v(E.value,E.value,this)}add(v){let x=this.splay(v);return x!=0&&this.addNewRoot(new At(v),x),this}addAndReturn(v){let x=this.splay(v);return x!=0&&this.addNewRoot(new At(v),x),this.root.key}addAll(v){for(let x of v)this.add(x)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(v){if(v==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(v)<0)return this.root.key;let x=this.root.left;if(x==null)return null;let E=x.right;for(;E!=null;)x=E,E=x.right;return x.key}firstAfter(v){if(v==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(v)>0)return this.root.key;let x=this.root.right;if(x==null)return null;let E=x.left;for(;E!=null;)x=E,E=x.left;return x.key}retainAll(v){let x=new Gd(this.compare,this.validKey),E=this.modificationCount;for(let j of v){if(E!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(j)&&this.splay(j)==0&&x.add(this.root.key)}x.size!=this.size&&(this.root=x.root,this.size=x.size,this.modificationCount++)}lookup(v){return!this.validKey(v)||this.splay(v)!=0?null:this.root.key}intersection(v){let x=new Gd(this.compare,this.validKey);for(let E of this)v.has(E)&&x.add(E);return x}difference(v){let x=new Gd(this.compare,this.validKey);for(let E of this)v.has(E)||x.add(E);return x}union(v){let x=this.clone();return x.addAll(v),x}clone(){let v=new Gd(this.compare,this.validKey);return v.size=this.size,v.root=this.copyNode(this.root),v}copyNode(v){if(v==null)return null;function x(j,X){let re,ge;do{if(re=j.left,ge=j.right,re!=null){let Le=new At(re.key);X.left=Le,x(re,Le)}if(ge!=null){let Le=new At(ge.key);X.right=Le,j=ge,X=Le}}while(ge!=null)}let E=new At(v.key);return x(v,E),E}toSet(){return this.clone()}entries(){return new Fr(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[(tr=Symbol.iterator,Pn=Symbol.toStringTag,tr)](){return new er(this.wrap())}},In=class{constructor(l){qt(this,"tree");qt(this,"path",new Array);qt(this,"modificationCount",null);qt(this,"splayCount");this.tree=l,this.splayCount=l.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;let l=this.path[this.path.length-1];return this.getValue(l)}rebuildPath(l){this.path.splice(0,this.path.length),this.tree.splay(l),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(l){for(;l!=null;)this.path.push(l),l=l.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let v=this.tree.getRoot();for(;v!=null;)this.path.push(v),v=v.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let l=this.path[this.path.length-1],h=l.right;if(h!=null){for(;h!=null;)this.path.push(h),h=h.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===l;)l=this.path.pop();return this.path.length>0}},er=class extends In{getValue(l){return l.key}},Fr=class extends In{getValue(l){return[l.key,l.key]}},Lo=l=>l,io=l=>{if(l){let h=new sn(ms(l)),v=new sn(ms(l)),x=(j,X)=>X.addAndReturn(j),E=j=>({x:x(j.x,h),y:x(j.y,v)});return E({x:new Se(0),y:new Se(0)}),E}return Lo},Oo=l=>({set:h=>{Ki=Oo(h)},reset:()=>Oo(l),compare:ms(l),snap:io(l),orient:js(l)}),Ki=Oo(),ys=(l,h)=>l.ll.x.isLessThanOrEqualTo(h.x)&&h.x.isLessThanOrEqualTo(l.ur.x)&&l.ll.y.isLessThanOrEqualTo(h.y)&&h.y.isLessThanOrEqualTo(l.ur.y),wc=(l,h)=>{if(h.ur.x.isLessThan(l.ll.x)||l.ur.x.isLessThan(h.ll.x)||h.ur.y.isLessThan(l.ll.y)||l.ur.y.isLessThan(h.ll.y))return null;let v=l.ll.x.isLessThan(h.ll.x)?h.ll.x:l.ll.x,x=l.ur.x.isLessThan(h.ur.x)?l.ur.x:h.ur.x,E=l.ll.y.isLessThan(h.ll.y)?h.ll.y:l.ll.y,j=l.ur.y.isLessThan(h.ur.y)?l.ur.y:h.ur.y;return{ll:{x:v,y:E},ur:{x,y:j}}},ca=(l,h)=>l.x.times(h.y).minus(l.y.times(h.x)),Ys=(l,h)=>l.x.times(h.x).plus(l.y.times(h.y)),zs=l=>Ys(l,l).sqrt(),Tf=(l,h,v)=>{let x={x:h.x.minus(l.x),y:h.y.minus(l.y)},E={x:v.x.minus(l.x),y:v.y.minus(l.y)};return ca(E,x).div(zs(E)).div(zs(x))},tu=(l,h,v)=>{let x={x:h.x.minus(l.x),y:h.y.minus(l.y)},E={x:v.x.minus(l.x),y:v.y.minus(l.y)};return Ys(E,x).div(zs(E)).div(zs(x))},pi=(l,h,v)=>h.y.isZero()?null:{x:l.x.plus(h.x.div(h.y).times(v.minus(l.y))),y:v},Wo=(l,h,v)=>h.x.isZero()?null:{x:v,y:l.y.plus(h.y.div(h.x).times(v.minus(l.x)))},De=(l,h,v,x)=>{if(h.x.isZero())return Wo(v,x,l.x);if(x.x.isZero())return Wo(l,h,v.x);if(h.y.isZero())return pi(v,x,l.y);if(x.y.isZero())return pi(l,h,v.y);let E=ca(h,x);if(E.isZero())return null;let j={x:v.x.minus(l.x),y:v.y.minus(l.y)},X=ca(j,h).div(E),re=ca(j,x).div(E),ge=l.x.plus(re.times(h.x)),Le=v.x.plus(X.times(x.x)),Xe=l.y.plus(re.times(h.y)),ze=v.y.plus(X.times(x.y)),vt=ge.plus(Le).div(2),Dt=Xe.plus(ze).div(2);return{x:vt,y:Dt}},_s=class hx{constructor(h,v){qt(this,"point");qt(this,"isLeft");qt(this,"segment");qt(this,"otherSE");qt(this,"consumedBy");h.events===void 0?h.events=[this]:h.events.push(this),this.point=h,this.isLeft=v}static compare(h,v){let x=hx.comparePoints(h.point,v.point);return x!==0?x:(h.point!==v.point&&h.link(v),h.isLeft!==v.isLeft?h.isLeft?1:-1:Bo.compare(h.segment,v.segment))}static comparePoints(h,v){return h.x.isLessThan(v.x)?-1:h.x.isGreaterThan(v.x)?1:h.y.isLessThan(v.y)?-1:h.y.isGreaterThan(v.y)?1:0}link(h){if(h.point===this.point)throw new Error("Tried to link already linked events");let v=h.point.events;for(let x=0,E=v.length;x<E;x++){let j=v[x];this.point.events.push(j),j.point=this.point}this.checkForConsuming()}checkForConsuming(){let h=this.point.events.length;for(let v=0;v<h;v++){let x=this.point.events[v];if(x.segment.consumedBy===void 0)for(let E=v+1;E<h;E++){let j=this.point.events[E];j.consumedBy===void 0&&x.otherSE.point.events===j.otherSE.point.events&&x.segment.consume(j.segment)}}}getAvailableLinkedEvents(){let h=[];for(let v=0,x=this.point.events.length;v<x;v++){let E=this.point.events[v];E!==this&&!E.segment.ringOut&&E.segment.isInResult()&&h.push(E)}return h}getLeftmostComparator(h){let v=new Map,x=E=>{let j=E.otherSE;v.set(E,{sine:Tf(this.point,h.point,j.point),cosine:tu(this.point,h.point,j.point)})};return(E,j)=>{v.has(E)||x(E),v.has(j)||x(j);let{sine:X,cosine:re}=v.get(E),{sine:ge,cosine:Le}=v.get(j);return X.isGreaterThanOrEqualTo(0)&&ge.isGreaterThanOrEqualTo(0)?re.isLessThan(Le)?1:re.isGreaterThan(Le)?-1:0:X.isLessThan(0)&&ge.isLessThan(0)?re.isLessThan(Le)?-1:re.isGreaterThan(Le)?1:0:ge.isLessThan(X)?-1:ge.isGreaterThan(X)?1:0}}},Su=0,Bo=class jg{constructor(h,v,x,E){qt(this,"id");qt(this,"leftSE");qt(this,"rightSE");qt(this,"rings");qt(this,"windings");qt(this,"ringOut");qt(this,"consumedBy");qt(this,"prev");qt(this,"_prevInResult");qt(this,"_beforeState");qt(this,"_afterState");qt(this,"_isInResult");this.id=++Su,this.leftSE=h,h.segment=this,h.otherSE=v,this.rightSE=v,v.segment=this,v.otherSE=h,this.rings=x,this.windings=E}static compare(h,v){let x=h.leftSE.point.x,E=v.leftSE.point.x,j=h.rightSE.point.x,X=v.rightSE.point.x;if(X.isLessThan(x))return 1;if(j.isLessThan(E))return-1;let re=h.leftSE.point.y,ge=v.leftSE.point.y,Le=h.rightSE.point.y,Xe=v.rightSE.point.y;if(x.isLessThan(E)){if(ge.isLessThan(re)&&ge.isLessThan(Le))return 1;if(ge.isGreaterThan(re)&&ge.isGreaterThan(Le))return-1;let ze=h.comparePoint(v.leftSE.point);if(ze<0)return 1;if(ze>0)return-1;let vt=v.comparePoint(h.rightSE.point);return vt!==0?vt:-1}if(x.isGreaterThan(E)){if(re.isLessThan(ge)&&re.isLessThan(Xe))return-1;if(re.isGreaterThan(ge)&&re.isGreaterThan(Xe))return 1;let ze=v.comparePoint(h.leftSE.point);if(ze!==0)return ze;let vt=h.comparePoint(v.rightSE.point);return vt<0?1:vt>0?-1:1}if(re.isLessThan(ge))return-1;if(re.isGreaterThan(ge))return 1;if(j.isLessThan(X)){let ze=v.comparePoint(h.rightSE.point);if(ze!==0)return ze}if(j.isGreaterThan(X)){let ze=h.comparePoint(v.rightSE.point);if(ze<0)return 1;if(ze>0)return-1}if(!j.eq(X)){let ze=Le.minus(re),vt=j.minus(x),Dt=Xe.minus(ge),Xt=X.minus(E);if(ze.isGreaterThan(vt)&&Dt.isLessThan(Xt))return 1;if(ze.isLessThan(vt)&&Dt.isGreaterThan(Xt))return-1}return j.isGreaterThan(X)?1:j.isLessThan(X)||Le.isLessThan(Xe)?-1:Le.isGreaterThan(Xe)?1:h.id<v.id?-1:h.id>v.id?1:0}static fromRing(h,v,x){let E,j,X,re=_s.comparePoints(h,v);if(re<0)E=h,j=v,X=1;else if(re>0)E=v,j=h,X=-1;else throw new Error(`Tried to create degenerate segment at [${h.x}, ${h.y}]`);let ge=new _s(E,!0),Le=new _s(j,!1);return new jg(ge,Le,[x],[X])}replaceRightSE(h){this.rightSE=h,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){let h=this.leftSE.point.y,v=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:h.isLessThan(v)?h:v},ur:{x:this.rightSE.point.x,y:h.isGreaterThan(v)?h:v}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(h){return h.x.eq(this.leftSE.point.x)&&h.y.eq(this.leftSE.point.y)||h.x.eq(this.rightSE.point.x)&&h.y.eq(this.rightSE.point.y)}comparePoint(h){return Ki.orient(this.leftSE.point,h,this.rightSE.point)}getIntersection(h){let v=this.bbox(),x=h.bbox(),E=wc(v,x);if(E===null)return null;let j=this.leftSE.point,X=this.rightSE.point,re=h.leftSE.point,ge=h.rightSE.point,Le=ys(v,re)&&this.comparePoint(re)===0,Xe=ys(x,j)&&h.comparePoint(j)===0,ze=ys(v,ge)&&this.comparePoint(ge)===0,vt=ys(x,X)&&h.comparePoint(X)===0;if(Xe&&Le)return vt&&!ze?X:!vt&&ze?ge:null;if(Xe)return ze&&j.x.eq(ge.x)&&j.y.eq(ge.y)?null:j;if(Le)return vt&&X.x.eq(re.x)&&X.y.eq(re.y)?null:re;if(vt&&ze)return null;if(vt)return X;if(ze)return ge;let Dt=De(j,this.vector(),re,h.vector());return Dt===null||!ys(E,Dt)?null:Ki.snap(Dt)}split(h){let v=[],x=h.events!==void 0,E=new _s(h,!0),j=new _s(h,!1),X=this.rightSE;this.replaceRightSE(j),v.push(j),v.push(E);let re=new jg(E,X,this.rings.slice(),this.windings.slice());return _s.comparePoints(re.leftSE.point,re.rightSE.point)>0&&re.swapEvents(),_s.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),x&&(E.checkForConsuming(),j.checkForConsuming()),v}swapEvents(){let h=this.rightSE;this.rightSE=this.leftSE,this.leftSE=h,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let v=0,x=this.windings.length;v<x;v++)this.windings[v]*=-1}consume(h){let v=this,x=h;for(;v.consumedBy;)v=v.consumedBy;for(;x.consumedBy;)x=x.consumedBy;let E=jg.compare(v,x);if(E!==0){if(E>0){let j=v;v=x,x=j}if(v.prev===x){let j=v;v=x,x=j}for(let j=0,X=x.rings.length;j<X;j++){let re=x.rings[j],ge=x.windings[j],Le=v.rings.indexOf(re);Le===-1?(v.rings.push(re),v.windings.push(ge)):v.windings[Le]+=ge}x.rings=null,x.windings=null,x.consumedBy=v,x.leftSE.consumedBy=v.leftSE,x.rightSE.consumedBy=v.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{let h=this.prev.consumedBy||this.prev;this._beforeState=h.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;let h=this.beforeState();this._afterState={rings:h.rings.slice(0),windings:h.windings.slice(0),multiPolys:[]};let v=this._afterState.rings,x=this._afterState.windings,E=this._afterState.multiPolys;for(let re=0,ge=this.rings.length;re<ge;re++){let Le=this.rings[re],Xe=this.windings[re],ze=v.indexOf(Le);ze===-1?(v.push(Le),x.push(Xe)):x[ze]+=Xe}let j=[],X=[];for(let re=0,ge=v.length;re<ge;re++){if(x[re]===0)continue;let Le=v[re],Xe=Le.poly;if(X.indexOf(Xe)===-1)if(Le.isExterior)j.push(Xe);else{X.indexOf(Xe)===-1&&X.push(Xe);let ze=j.indexOf(Le.poly);ze!==-1&&j.splice(ze,1)}}for(let re=0,ge=j.length;re<ge;re++){let Le=j[re].multiPoly;E.indexOf(Le)===-1&&E.push(Le)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;let h=this.beforeState().multiPolys,v=this.afterState().multiPolys;switch(Yc.type){case"union":{let x=h.length===0,E=v.length===0;this._isInResult=x!==E;break}case"intersection":{let x,E;h.length<v.length?(x=h.length,E=v.length):(x=v.length,E=h.length),this._isInResult=E===Yc.numMultiPolys&&x<E;break}case"xor":{let x=Math.abs(h.length-v.length);this._isInResult=x%2===1;break}case"difference":{let x=E=>E.length===1&&E[0].isSubject;this._isInResult=x(h)!==x(v);break}}return this._isInResult}},Vr=class{constructor(l,h,v){qt(this,"poly");qt(this,"isExterior");qt(this,"segments");qt(this,"bbox");if(!Array.isArray(l)||l.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=h,this.isExterior=v,this.segments=[],typeof l[0][0]!="number"||typeof l[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let x=Ki.snap({x:new Se(l[0][0]),y:new Se(l[0][1])});this.bbox={ll:{x:x.x,y:x.y},ur:{x:x.x,y:x.y}};let E=x;for(let j=1,X=l.length;j<X;j++){if(typeof l[j][0]!="number"||typeof l[j][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let re=Ki.snap({x:new Se(l[j][0]),y:new Se(l[j][1])});re.x.eq(E.x)&&re.y.eq(E.y)||(this.segments.push(Bo.fromRing(E,re,this)),re.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=re.x),re.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=re.y),re.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=re.x),re.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=re.y),E=re)}(!x.x.eq(E.x)||!x.y.eq(E.y))&&this.segments.push(Bo.fromRing(E,x,this))}getSweepEvents(){let l=[];for(let h=0,v=this.segments.length;h<v;h++){let x=this.segments[h];l.push(x.leftSE),l.push(x.rightSE)}return l}},Zc=class{constructor(l,h){qt(this,"multiPoly");qt(this,"exteriorRing");qt(this,"interiorRings");qt(this,"bbox");if(!Array.isArray(l))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Vr(l[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let v=1,x=l.length;v<x;v++){let E=new Vr(l[v],this,!1);E.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=E.bbox.ll.x),E.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=E.bbox.ll.y),E.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=E.bbox.ur.x),E.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=E.bbox.ur.y),this.interiorRings.push(E)}this.multiPoly=h}getSweepEvents(){let l=this.exteriorRing.getSweepEvents();for(let h=0,v=this.interiorRings.length;h<v;h++){let x=this.interiorRings[h].getSweepEvents();for(let E=0,j=x.length;E<j;E++)l.push(x[E])}return l}},dh=class{constructor(l,h){qt(this,"isSubject");qt(this,"polys");qt(this,"bbox");if(!Array.isArray(l))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof l[0][0][0]=="number"&&(l=[l])}catch{}this.polys=[],this.bbox={ll:{x:new Se(Number.POSITIVE_INFINITY),y:new Se(Number.POSITIVE_INFINITY)},ur:{x:new Se(Number.NEGATIVE_INFINITY),y:new Se(Number.NEGATIVE_INFINITY)}};for(let v=0,x=l.length;v<x;v++){let E=new Zc(l[v],this);E.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=E.bbox.ll.x),E.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=E.bbox.ll.y),E.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=E.bbox.ur.x),E.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=E.bbox.ur.y),this.polys.push(E)}this.isSubject=h}getSweepEvents(){let l=[];for(let h=0,v=this.polys.length;h<v;h++){let x=this.polys[h].getSweepEvents();for(let E=0,j=x.length;E<j;E++)l.push(x[E])}return l}},Kc=class g1{constructor(h){qt(this,"events");qt(this,"poly");qt(this,"_isExteriorRing");qt(this,"_enclosingRing");this.events=h;for(let v=0,x=h.length;v<x;v++)h[v].segment.ringOut=this;this.poly=null}static factory(h){let v=[];for(let x=0,E=h.length;x<E;x++){let j=h[x];if(!j.isInResult()||j.ringOut)continue;let X=null,re=j.leftSE,ge=j.rightSE,Le=[re],Xe=re.point,ze=[];for(;X=re,re=ge,Le.push(re),re.point!==Xe;)for(;;){let vt=re.getAvailableLinkedEvents();if(vt.length===0){let _n=Le[0].point,Sn=Le[Le.length-1].point;throw new Error(`Unable to complete output ring starting at [${_n.x}, ${_n.y}]. Last matching segment found ends at [${Sn.x}, ${Sn.y}].`)}if(vt.length===1){ge=vt[0].otherSE;break}let Dt=null;for(let _n=0,Sn=ze.length;_n<Sn;_n++)if(ze[_n].point===re.point){Dt=_n;break}if(Dt!==null){let _n=ze.splice(Dt)[0],Sn=Le.splice(_n.index);Sn.unshift(Sn[0].otherSE),v.push(new g1(Sn.reverse()));continue}ze.push({index:Le.length,point:re.point});let Xt=re.getLeftmostComparator(X);ge=vt.sort(Xt)[0].otherSE;break}v.push(new g1(Le))}return v}getGeom(){let h=this.events[0].point,v=[h];for(let Le=1,Xe=this.events.length-1;Le<Xe;Le++){let ze=this.events[Le].point,vt=this.events[Le+1].point;Ki.orient(ze,h,vt)!==0&&(v.push(ze),h=ze)}if(v.length===1)return null;let x=v[0],E=v[1];Ki.orient(x,h,E)===0&&v.shift(),v.push(v[0]);let j=this.isExteriorRing()?1:-1,X=this.isExteriorRing()?0:v.length-1,re=this.isExteriorRing()?v.length:-1,ge=[];for(let Le=X;Le!=re;Le+=j)ge.push([v[Le].x.toNumber(),v[Le].y.toNumber()]);return ge}isExteriorRing(){if(this._isExteriorRing===void 0){let h=this.enclosingRing();this._isExteriorRing=h?!h.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var E,j;let h=this.events[0];for(let X=1,re=this.events.length;X<re;X++){let ge=this.events[X];_s.compare(h,ge)>0&&(h=ge)}let v=h.segment.prevInResult(),x=v?v.prevInResult():null;for(;;){if(!v)return null;if(!x)return v.ringOut;if(x.ringOut!==v.ringOut)return((E=x.ringOut)==null?void 0:E.enclosingRing())!==v.ringOut?v.ringOut:(j=v.ringOut)==null?void 0:j.enclosingRing();v=x.prevInResult(),x=v?v.prevInResult():null}}},qa=class{constructor(l){qt(this,"exteriorRing");qt(this,"interiorRings");this.exteriorRing=l,l.poly=this,this.interiorRings=[]}addInterior(l){this.interiorRings.push(l),l.poly=this}getGeom(){let l=this.exteriorRing.getGeom();if(l===null)return null;let h=[l];for(let v=0,x=this.interiorRings.length;v<x;v++){let E=this.interiorRings[v].getGeom();E!==null&&h.push(E)}return h}},xc=class{constructor(l){qt(this,"rings");qt(this,"polys");this.rings=l,this.polys=this._composePolys(l)}getGeom(){let l=[];for(let h=0,v=this.polys.length;h<v;h++){let x=this.polys[h].getGeom();x!==null&&l.push(x)}return l}_composePolys(l){var v;let h=[];for(let x=0,E=l.length;x<E;x++){let j=l[x];if(!j.poly)if(j.isExteriorRing())h.push(new qa(j));else{let X=j.enclosingRing();X!=null&&X.poly||h.push(new qa(X)),(v=X==null?void 0:X.poly)==null||v.addInterior(j)}}return h}},Nf=class{constructor(l,h=Bo.compare){qt(this,"queue");qt(this,"tree");qt(this,"segments");this.queue=l,this.tree=new sn(h),this.segments=[]}process(l){let h=l.segment,v=[];if(l.consumedBy)return l.isLeft?this.queue.delete(l.otherSE):this.tree.delete(h),v;l.isLeft&&this.tree.add(h);let x=h,E=h;do x=this.tree.lastBefore(x);while(x!=null&&x.consumedBy!=null);do E=this.tree.firstAfter(E);while(E!=null&&E.consumedBy!=null);if(l.isLeft){let j=null;if(x){let re=x.getIntersection(h);if(re!==null&&(h.isAnEndpoint(re)||(j=re),!x.isAnEndpoint(re))){let ge=this._splitSafely(x,re);for(let Le=0,Xe=ge.length;Le<Xe;Le++)v.push(ge[Le])}}let X=null;if(E){let re=E.getIntersection(h);if(re!==null&&(h.isAnEndpoint(re)||(X=re),!E.isAnEndpoint(re))){let ge=this._splitSafely(E,re);for(let Le=0,Xe=ge.length;Le<Xe;Le++)v.push(ge[Le])}}if(j!==null||X!==null){let re=null;j===null?re=X:X===null?re=j:re=_s.comparePoints(j,X)<=0?j:X,this.queue.delete(h.rightSE),v.push(h.rightSE);let ge=h.split(re);for(let Le=0,Xe=ge.length;Le<Xe;Le++)v.push(ge[Le])}v.length>0?(this.tree.delete(h),v.push(l)):(this.segments.push(h),h.prev=x)}else{if(x&&E){let j=x.getIntersection(E);if(j!==null){if(!x.isAnEndpoint(j)){let X=this._splitSafely(x,j);for(let re=0,ge=X.length;re<ge;re++)v.push(X[re])}if(!E.isAnEndpoint(j)){let X=this._splitSafely(E,j);for(let re=0,ge=X.length;re<ge;re++)v.push(X[re])}}}this.tree.delete(h)}return v}_splitSafely(l,h){this.tree.delete(l);let v=l.rightSE;this.queue.delete(v);let x=l.split(h);return x.push(v),l.consumedBy===void 0&&this.tree.add(l),x}},yd=class{constructor(){qt(this,"type");qt(this,"numMultiPolys")}run(l,h,v){Qu.type=l;let x=[new dh(h,!0)];for(let ge=0,Le=v.length;ge<Le;ge++)x.push(new dh(v[ge],!1));if(Qu.numMultiPolys=x.length,Qu.type==="difference"){let ge=x[0],Le=1;for(;Le<x.length;)wc(x[Le].bbox,ge.bbox)!==null?Le++:x.splice(Le,1)}if(Qu.type==="intersection")for(let ge=0,Le=x.length;ge<Le;ge++){let Xe=x[ge];for(let ze=ge+1,vt=x.length;ze<vt;ze++)if(wc(Xe.bbox,x[ze].bbox)===null)return[]}let E=new sn(_s.compare);for(let ge=0,Le=x.length;ge<Le;ge++){let Xe=x[ge].getSweepEvents();for(let ze=0,vt=Xe.length;ze<vt;ze++)E.add(Xe[ze])}let j=new Nf(E),X=null;for(E.size!=0&&(X=E.first(),E.delete(X));X;){let ge=j.process(X);for(let Le=0,Xe=ge.length;Le<Xe;Le++){let ze=ge[Le];ze.consumedBy===void 0&&E.add(ze)}E.size!=0?(X=E.first(),E.delete(X)):X=null}Ki.reset();let re=Kc.factory(j.segments);return new xc(re).getGeom()}},Qu=new yd,Yc=Qu,Rl=(l,...h)=>Yc.run("intersection",l,h),_d=(l,...h)=>Yc.run("difference",l,h);Ki.set;function Jc(l){let h={type:"Feature"};return h.geometry=l,h}function Xc(l){return l.type==="Feature"?l.geometry:l}function ph(l){return l&&l.geometry&&l.geometry.coordinates?l.geometry.coordinates:l}function gh(l){return Jc({type:"LineString",coordinates:l})}function Ca(l){return Jc({type:"MultiLineString",coordinates:l})}function mh(l){return Jc({type:"Polygon",coordinates:l})}function vh(l){return Jc({type:"MultiPolygon",coordinates:l})}function yh(l,h){let v=Xc(l),x=Xc(h),E=Rl(v.coordinates,x.coordinates);return E.length===0?null:E.length===1?mh(E[0]):vh(E)}function b(l,h){let v=Xc(l),x=Xc(h),E=_d(v.coordinates,x.coordinates);return E.length===0?null:E.length===1?mh(E[0]):vh(E)}function P(l){return Array.isArray(l)?1+P(l[0]):-1}function q(l){l instanceof L.Polyline&&(l=l.toGeoJSON(15));let h=ph(l),v=P(h),x=[];return v>1?h.forEach(E=>{x.push(gh(E))}):x.push(l),x}function ae(l){let h=[];return l.eachLayer(v=>{h.push(ph(v.toGeoJSON(15)))}),Ca(h)}fo.Cut=fo.Polygon.extend({initialize(l){this._map=l,this._shape="Cut",this.toolbarButtonName="cutPolygon"},_finishShape(){if(this._editedLayers=[],!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let l=this._layer.getLatLngs();if(l.length<=2)return;let h=L.polygon(l,this.options.pathOptions);h._latlngInfos=this._layer._latlngInfo,this.cut(h),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex,this._editedLayers.forEach(({layer:x,originalLayer:E})=>{this._fireCut(E,x,E),this._fireCut(this._map,x,E),E.pm._fireEdit()}),this._editedLayers=[];let v=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(v))},cut(l){let h=this._map._layers,v=l._latlngInfos||[];Object.keys(h).map(x=>h[x]).filter(x=>x.pm).filter(x=>!x._pmTempLayer).filter(x=>!L.PM.optIn&&!x.options.pmIgnore||L.PM.optIn&&x.options.pmIgnore===!1).filter(x=>x instanceof L.Polyline).filter(x=>x!==l).filter(x=>x.pm.options.allowCutting).filter(x=>this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0?this.options.layersToCut.indexOf(x)>-1:!0).filter(x=>!this._layerGroup.hasLayer(x)).filter(x=>{try{let E=!!gs(l.toGeoJSON(15),x.toGeoJSON(15)).features.length>0;return E||x instanceof L.Polyline&&!(x instanceof L.Polygon)?E:!!yh(l.toGeoJSON(15),x.toGeoJSON(15))}catch{return x instanceof L.Polygon&&console.error("You can't cut polygons with self-intersections"),!1}}).forEach(x=>{let E;if(x instanceof L.Polygon){E=L.polygon(x.getLatLngs());let ge=E.getLatLngs();v.forEach(Le=>{if(Le&&Le.snapInfo){let{latlng:Xe}=Le,ze=this._calcClosestLayer(Xe,[E]);if(ze&&ze.segment&&ze.distance<this.options.snapDistance){let{segment:vt}=ze;if(vt&&vt.length===2){let{indexPath:Dt,parentPath:Xt,newIndex:_n}=L.PM.Utils._getIndexFromSegment(ge,vt);(Dt.length>1?(0,$i.default)(ge,Xt):ge).splice(_n,0,Xe)}}}})}else E=x;let j=this._cutLayer(l,E),X=L.geoJSON(j,x.options);X.getLayers().length===1&&([X]=X.getLayers()),this._setPane(X,"layerPane");let re=X.addTo(this._map.pm._getContainingLayer());if(re.pm.enable(x.pm.options),re.pm.disable(),x._pmTempLayer=!0,l._pmTempLayer=!0,x.remove(),x.removeFrom(this._map.pm._getContainingLayer()),l.remove(),l.removeFrom(this._map.pm._getContainingLayer()),re.getLayers&&re.getLayers().length===0&&this._map.pm.removeLayer({target:re}),re instanceof L.LayerGroup?(re.eachLayer(ge=>{this._addDrawnLayerProp(ge)}),this._addDrawnLayerProp(re)):this._addDrawnLayerProp(re),this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0){let ge=this.options.layersToCut.indexOf(x);ge>-1&&this.options.layersToCut.splice(ge,1)}this._editedLayers.push({layer:re,originalLayer:x})})},_cutLayer(l,h){let v=L.geoJSON(),x;if(h instanceof L.Polygon)x=b(h.toGeoJSON(15),l.toGeoJSON(15));else{let E=q(h);E.forEach(j=>{let X=Jn(j,l.toGeoJSON(15)),re;X&&X.features.length>0?re=L.geoJSON(X):re=L.geoJSON(j),re.getLayers().forEach(ge=>{oa(l.toGeoJSON(15),ge.toGeoJSON(15))||ge.addTo(v)})}),E.length>1?x=ae(v):x=v.toGeoJSON(15)}return x},_change:L.Util.falseFn}),fo.Text=fo.extend({initialize(l){this._map=l,this._shape="Text",this.toolbarButtonName="drawText"},enable(l){L.Util.setOptions(this,l),this._enabled=!0,this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(lr("tooltips.placeText"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this._map.getContainer().classList.add("geoman-draw-cursor"),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){var l;this._enabled&&(this._enabled=!1,this._map.off("click",this._createMarker,this),(l=this._hintMarker)==null||l.remove(),this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("mousemove",this._syncHintMarker,this),this._map.off("mousemove",this._showHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(l){this.enabled()?this.disable():this.enable(l)},_syncHintMarker(l){if(this._hintMarker.setLatLng(l.latlng),this.options.snappable){let h=l;h.target=this._hintMarker,this._handleSnapping(h)}},_createMarker(l){var E,j,X,re;if(!l.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(l.latlng);let h=this._hintMarker.getLatLng();if(this.textArea=this._createTextArea(),(E=this.options.textOptions)==null?void 0:E.className){let ge=this.options.textOptions.className.split(" ");this.textArea.classList.add(...ge)}let v=this._createTextIcon(this.textArea),x=new L.Marker(h,{textMarker:!0,_textMarkerOverPM:!0,icon:v});if(this._setPane(x,"markerPane"),this._finishLayer(x),x.pm||(x.options.draggable=!1),x.addTo(this._map.pm._getContainingLayer()),x.pm){x.pm.textArea=this.textArea,L.setOptions(x.pm,{removeIfEmpty:((j=this.options.textOptions)==null?void 0:j.removeIfEmpty)??!0});let ge=((X=this.options.textOptions)==null?void 0:X.focusAfterDraw)??!0;x.pm._createTextMarker(ge),(re=this.options.textOptions)!=null&&re.text&&x.pm.setText(this.options.textOptions.text)}this._fireCreate(x),this._cleanupSnapping(),this.disable(),this.options.continueDrawing&&this._map.once("mousemove",this._showHintMarkerAfterMoving,this)},_showHintMarkerAfterMoving(l){this.enable(),this._hintMarker.setLatLng(l.latlng)},_createTextArea(){let l=document.createElement("textarea");return l.readOnly=!0,l.classList.add("pm-textarea","pm-disabled"),l},_createTextIcon(l){return L.divIcon({className:"pm-text-marker",html:l})}});var be={enableLayerDrag(){if(!this.options.draggable||!this._layer._map)return;this.disable(),this._layerDragEnabled=!0,this._map||(this._map=this._layer._map),(this._layer instanceof L.Marker||this._layer instanceof L.ImageOverlay)&&L.DomEvent.on(this._getDOMElem(),"dragstart",this._stopDOMImageDrag),this._layer.dragging&&this._layer.dragging.disable(),this._tempDragCoord=null,vi(this._layer)instanceof L.Canvas?(this._layer.on("mouseout",this.removeDraggingClass,this),this._layer.on("mouseover",this.addDraggingClass,this)):this.addDraggingClass(),this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!0;let l=this._getDOMElem();l&&(vi(this._layer)instanceof L.Canvas?(this._layer.on("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._addTouchEvents(l)):L.DomEvent.on(l,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._fireDragEnable()},disableLayerDrag(){this._layerDragEnabled=!1,vi(this._layer)instanceof L.Canvas?(this._layer.off("mouseout",this.removeDraggingClass,this),this._layer.off("mouseover",this.addDraggingClass,this)):this.removeDraggingClass(),this._originalMapDragState&&this._dragging&&this._map.dragging.enable(),this._safeToCacheDragState=!1,this._layer.dragging&&this._layer.dragging.disable();let l=this._getDOMElem();l&&(vi(this._layer)instanceof L.Canvas?(this._layer.off("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._removeTouchEvents(l)):L.DomEvent.off(l,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._layerDragged&&this._fireUpdate(),this._layerDragged=!1,this._fireDragDisable()},dragging(){return this._dragging},layerDragEnabled(){return!!this._layerDragEnabled},_simulateMouseDownEvent(l){let h=l.touches?l.touches[0]:l,v={originalEvent:h,target:this._layer};return v.containerPoint=this._map.mouseEventToContainerPoint(h),v.latlng=this._map.containerPointToLatLng(v.containerPoint),this._dragMixinOnMouseDown(v),!1},_simulateMouseMoveEvent(l){let h=l.touches?l.touches[0]:l,v={originalEvent:h,target:this._layer};return v.containerPoint=this._map.mouseEventToContainerPoint(h),v.latlng=this._map.containerPointToLatLng(v.containerPoint),this._dragMixinOnMouseMove(v),!1},_simulateMouseUpEvent(l){let h={originalEvent:l.touches?l.touches[0]:l,target:this._layer};return l.type.indexOf("touch")===-1&&(h.containerPoint=this._map.mouseEventToContainerPoint(l),h.latlng=this._map.containerPointToLatLng(h.containerPoint)),this._dragMixinOnMouseUp(h),!1},_dragMixinOnMouseDown(l){if(l.originalEvent.button>0)return;this._overwriteEventIfItComesFromMarker(l);let h=l._fromLayerSync,v=this._syncLayers("_dragMixinOnMouseDown",l);if(this._layer instanceof L.Marker&&(this.options.snappable&&!h&&!v?this._initSnappableMarkers():this._disableSnapping()),this._layer instanceof L.CircleMarker){let x="resizeableCircleMarker";this._layer instanceof L.Circle&&(x="resizeableCircle"),this.options.snappable&&!h&&!v?this._layer.pm.options[x]||this._initSnappableMarkersDrag():this._layer.pm.options[x]?this._layer.pm._disableSnapping():this._layer.pm._disableSnappingDrag()}this._safeToCacheDragState&&(this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!1),this._tempDragCoord=l.latlng,L.DomEvent.on(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),L.DomEvent.on(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this)},_dragMixinOnMouseMove(l){this._overwriteEventIfItComesFromMarker(l);let h=this._getDOMElem();this._syncLayers("_dragMixinOnMouseMove",l),this._dragging||(this._dragging=!0,L.DomUtil.addClass(h,"leaflet-pm-dragging"),this._layer instanceof L.Marker||this._layer.bringToFront(),this._originalMapDragState&&this._map.dragging.disable(),this._fireDragStart()),this._tempDragCoord||(this._tempDragCoord=l.latlng),this._onLayerDrag(l),this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle()},_dragMixinOnMouseUp(l){let h=this._getDOMElem();return this._syncLayers("_dragMixinOnMouseUp",l),this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0,L.DomEvent.off(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this),L.DomEvent.off(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),this._dragging?(this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle(),this._layerDragged=!0,window.setTimeout(()=>{this._dragging=!1,h&&L.DomUtil.removeClass(h,"leaflet-pm-dragging"),this._fireDragEnd(),this._fireEdit(),this._layerEdited=!0},10),!0):!1},_onLayerDrag(l){let{latlng:h}=l,v={lat:h.lat-this._tempDragCoord.lat,lng:h.lng-this._tempDragCoord.lng},x=E=>E.map(j=>{if(Array.isArray(j))return x(j);let X={lat:j.lat+v.lat,lng:j.lng+v.lng};return(j.alt||j.alt===0)&&(X.alt=j.alt),X});if(this._layer instanceof L.Circle&&this._layer.options.resizeableCircle||this._layer instanceof L.CircleMarker&&this._layer.options.resizeableCircleMarker){let E=x([this._layer.getLatLng()]);this._layer.setLatLng(E[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.CircleMarker||this._layer instanceof L.Marker){let E=this._layer.getLatLng();this._layer._snapped&&(E=this._layer._orgLatLng);let j=x([E]);this._layer.setLatLng(j[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.ImageOverlay){let E=x([this._layer.getBounds().getNorthWest(),this._layer.getBounds().getSouthEast()]);this._layer.setBounds(E),this._fireChange(this._layer.getBounds(),"Edit")}else{let E=x(this._layer.getLatLngs());this._layer.setLatLngs(E),this._fireChange(this._layer.getLatLngs(),"Edit")}this._tempDragCoord=h,l.layer=this._layer,this._fireDrag(l)},addDraggingClass(){let l=this._getDOMElem();l&&L.DomUtil.addClass(l,"leaflet-pm-draggable")},removeDraggingClass(){let l=this._getDOMElem();l&&L.DomUtil.removeClass(l,"leaflet-pm-draggable")},_getDOMElem(){let l=null;return this._layer._path?l=this._layer._path:this._layer._renderer&&this._layer._renderer._container?l=this._layer._renderer._container:this._layer._image?l=this._layer._image:this._layer._icon&&(l=this._layer._icon),l},_overwriteEventIfItComesFromMarker(l){l.target.getLatLng&&(!l.target._radius||l.target._radius<=10)&&(l.containerPoint=this._map.mouseEventToContainerPoint(l.originalEvent),l.latlng=this._map.containerPointToLatLng(l.containerPoint))},_syncLayers(l,h){if(this.enabled())return!1;if(!h._fromLayerSync&&this._layer===h.target&&this.options.syncLayersOnDrag){h._fromLayerSync=!0;let v=[];if(L.Util.isArray(this.options.syncLayersOnDrag))v=this.options.syncLayersOnDrag,this.options.syncLayersOnDrag.forEach(x=>{x instanceof L.LayerGroup&&(v=v.concat(x.pm.getLayers(!0)))});else if(this.options.syncLayersOnDrag===!0&&this._parentLayerGroup)for(let x in this._parentLayerGroup){let E=this._parentLayerGroup[x];E.pm&&(v=E.pm.getLayers(!0))}return L.Util.isArray(v)&&v.length>0&&(v=v.filter(x=>!!x.pm).filter(x=>!!x.pm.options.draggable),v.forEach(x=>{x!==this._layer&&x.pm[l]&&(x._snapped=!1,x.pm[l](h))})),v.length>0}return!1},_stopDOMImageDrag(l){return l.preventDefault(),!1}},Ee=be,Ae=f(Rr());function Ne(l,h,v,x){return v.unproject(h.transform(v.project(l,x)),x)}function Ie(l,h,v){let x=v.getMaxZoom();if(x===1/0&&(x=v.getZoom()),L.Util.isArray(l)){let E=[];return l.forEach(j=>{E.push(Ie(j,h,v))}),E}return l instanceof L.LatLng?Ne(l,h,v,x):null}function Ve(l,h){h instanceof L.Layer&&(h=h.getLatLng());let v=l.getMaxZoom();return v===1/0&&(v=l.getZoom()),l.project(h,v)}function ht(l,h){let v=l.getMaxZoom();return v===1/0&&(v=l.getZoom()),l.unproject(h,v)}var Ot={_onRotateStart(l){this._preventRenderingMarkers(!0),this._rotationOriginLatLng=this._getRotationCenter().clone(),this._rotationOriginPoint=Ve(this._map,this._rotationOriginLatLng),this._rotationStartPoint=Ve(this._map,l.target.getLatLng()),this._initialRotateLatLng=Fs(this._layer),this._startAngle=this.getAngle();let h=Fs(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._fireRotationStart(this._rotationLayer,h),this._fireRotationStart(this._map,h)},_onRotate(l){let h=Ve(this._map,l.target.getLatLng()),v=this._rotationStartPoint,x=this._rotationOriginPoint,E=Math.atan2(h.y-x.y,h.x-x.x)-Math.atan2(v.y-x.y,v.x-x.x);this._layer.setLatLngs(this._rotateLayer(E,this._initialRotateLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let j=this;function X(Xe,ze=[],vt=-1){if(vt>-1&&ze.push(vt),L.Util.isArray(Xe[0]))Xe.forEach((Dt,Xt)=>X(Dt,ze.slice(),Xt));else{let Dt=ze.length>0?(0,Ae.default)(j._markers,ze):j._markers[0];Xe.forEach((Xt,_n)=>{Dt[_n].setLatLng(Xt)})}}X(this._layer.getLatLngs());let re=Fs(this._rotationLayer);this._rotationLayer.setLatLngs(this._rotateLayer(E,this._rotationLayer.pm._rotateOrgLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let ge=E*180/Math.PI;ge=ge<0?ge+360:ge;let Le=ge+this._startAngle;this._setAngle(Le),this._rotationLayer.pm._setAngle(Le),this._fireRotation(this._rotationLayer,ge,re),this._fireRotation(this._map,ge,re),this._rotationLayer.pm._fireChange(this._rotationLayer.getLatLngs(),"Rotation")},_onRotateEnd(){let l=this._startAngle;delete this._rotationOriginLatLng,delete this._rotationOriginPoint,delete this._rotationStartPoint,delete this._initialRotateLatLng,delete this._startAngle;let h=Fs(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._rotationLayer.pm._rotateOrgLatLng=Fs(this._rotationLayer),this._fireRotationEnd(this._rotationLayer,l,h),this._fireRotationEnd(this._map,l,h),this._rotationLayer.pm._fireEdit(this._rotationLayer,"Rotation"),this._preventRenderingMarkers(!1),this._layerRotated=!0},_rotateLayer(l,h,v,x,E){let j=Ve(E,v);return this._matrix=x.clone().rotate(l,j).flip(),Ie(h,this._matrix,E)},_setAngle(l){l=l<0?l+360:l,this._angle=l%360},_getRotationCenter(){if(this._rotationCenter)return this._rotationCenter;let l=L.polygon(this._layer.getLatLngs(),{stroke:!1,fill:!1,pmIgnore:!0}).addTo(this._layer._map),h=l.getCenter();return l.removeFrom(this._layer._map),h},enableRotate(){if(!this.options.allowRotation){this.disableRotate();return}this.rotateEnabled()&&this.disableRotate(),this._layer instanceof L.Rectangle&&this._angle===void 0&&this.setInitAngle(ta(this._layer._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);let l={fill:!1,stroke:!1,pmIgnore:!1,snapIgnore:!0};this._rotatePoly=L.polygon(this._layer.getLatLngs(),l),this._rotatePoly._pmTempLayer=!0,this._rotatePoly.addTo(this._layer._map),this._rotatePoly.pm._setAngle(this.getAngle()),this._rotatePoly.pm.setRotationCenter(this.getRotationCenter()),this._rotatePoly.pm.setOptions(this._layer._map.pm.getGlobalOptions()),this._rotatePoly.pm.setOptions({rotate:!0,snappable:!1,hideMiddleMarkers:!0}),this._rotatePoly.pm._rotationLayer=this._layer,this._rotatePoly.pm.enable(),this._rotateOrgLatLng=Fs(this._layer),this._rotateEnabled=!0,this._layer.on("remove",this.disableRotate,this),this._fireRotationEnable(this._layer),this._fireRotationEnable(this._layer._map)},disableRotate(){this.rotateEnabled()&&(this._rotatePoly.pm._layerRotated&&this._fireUpdate(),this._rotatePoly.pm._layerRotated=!1,this._rotatePoly.pm.disable(),this._rotatePoly.remove(),this._rotatePoly.pm.setOptions({rotate:!1}),this._rotatePoly=void 0,this._rotateOrgLatLng=void 0,this._layer.off("remove",this.disableRotate,this),this._rotateEnabled=!1,this._fireRotationDisable(this._layer),this._fireRotationDisable(this._layer._map))},rotateEnabled(){return!!this._rotateEnabled},rotateLayer(l){let h=this.getAngle(),v=this._layer.getLatLngs(),x=l*(Math.PI/180);this._layer.setLatLngs(this._rotateLayer(x,this._layer.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._layer._map)),this._rotateOrgLatLng=L.polygon(this._layer.getLatLngs()).getLatLngs(),this._setAngle(this.getAngle()+l),this.rotateEnabled()&&this._rotatePoly&&this._rotatePoly.pm.enabled()&&(this._rotatePoly.setLatLngs(this._rotateLayer(x,this._rotatePoly.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._rotatePoly._map)),this._rotatePoly.pm._initMarkers());let E=this.getAngle()-h;E=E<0?E+360:E,this._startAngle=h,this._fireRotation(this._layer,E,v,this._layer),this._fireRotation(this._map||this._layer._map,E,v,this._layer),delete this._startAngle,this._fireChange(this._layer.getLatLngs(),"Rotation")},rotateLayerToAngle(l){let h=l-this.getAngle();this.rotateLayer(h)},getAngle(){return this._angle||0},setInitAngle(l){this._setAngle(l)},getRotationCenter(){return this._getRotationCenter()},setRotationCenter(l){this._rotationCenter=l,this._rotatePoly&&this._rotatePoly.pm.setRotationCenter(l)}},Bt=Ot,xt=L.Class.extend({includes:[Ee,ks,Bt,Tl],options:{snappable:!0,snapDistance:20,allowSelfIntersection:!0,allowSelfIntersectionEdit:!1,preventMarkerRemoval:!1,removeLayerBelowMinVertexCount:!0,limitMarkersToCount:-1,hideMiddleMarkers:!1,snapSegment:!0,syncLayersOnDrag:!1,draggable:!0,allowEditing:!0,allowRemoval:!0,allowCutting:!0,allowRotation:!0,addVertexOn:"click",removeVertexOn:"contextmenu",removeVertexValidation:void 0,addVertexValidation:void 0,moveVertexValidation:void 0,resizeableCircleMarker:!1,resizeableCircle:!0,snapMiddle:!1,snapVertex:!0},setOptions(l){L.Util.setOptions(this,l)},getOptions(){return this.options},applyOptions(){},isPolygon(){return this._layer instanceof L.Polygon},getShape(){return this._shape},_setPane(l,h){h==="layerPane"?l.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":h==="vertexPane"?l.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":h==="markerPane"&&(l.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},remove(){(this._map||this._layer._map).pm.removeLayer({target:this._layer})},_vertexValidation(l,h){let v=h.target,x={layer:this._layer,marker:v,event:h},E="";return l==="move"?E="moveVertexValidation":l==="add"?E="addVertexValidation":l==="remove"&&(E="removeVertexValidation"),this.options[E]&&typeof this.options[E]=="function"&&!this.options[E](x)?(l==="move"&&(v._cancelDragEventChain=v.getLatLng()),!1):(v._cancelDragEventChain=null,!0)},_vertexValidationDrag(l){return l._cancelDragEventChain?(l._latlng=l._cancelDragEventChain,l.update(),!1):!0},_vertexValidationDragEnd(l){return l._cancelDragEventChain?(l._cancelDragEventChain=null,!1):!0}}),Kt=xt;Kt.LayerGroup=L.Class.extend({initialize(l){this._layerGroup=l,this._layers=this.getLayers(),this._getMap(),this._layers.forEach(x=>this._initLayer(x));let h=x=>{if(x.layer._pmTempLayer)return;this._layers=this.getLayers();let E=this._layers.filter(j=>!j.pm._parentLayerGroup||!(this._layerGroup._leaflet_id in j.pm._parentLayerGroup));E.forEach(j=>{this._initLayer(j)}),E.length>0&&this._getMap()&&this._getMap().pm.globalEditModeEnabled()&&this.enabled()&&this.enable(this.getOptions())};this._layerGroup.on("layeradd",L.Util.throttle(h,100,this),this),this._layerGroup.on("layerremove",x=>{this._removeLayerFromGroup(x.target)},this);let v=x=>{x.target._pmTempLayer||(this._layers=this.getLayers())};this._layerGroup.on("layerremove",L.Util.throttle(v,100,this),this)},enable(l,h=[]){h.length===0&&(this._layers=this.getLayers()),this._options=l,this._layers.forEach(v=>{v instanceof L.LayerGroup?h.indexOf(v._leaflet_id)===-1&&(h.push(v._leaflet_id),v.pm.enable(l,h)):v.pm.enable(l)})},disable(l=[]){l.length===0&&(this._layers=this.getLayers()),this._layers.forEach(h=>{h instanceof L.LayerGroup?l.indexOf(h._leaflet_id)===-1&&(l.push(h._leaflet_id),h.pm.disable(l)):h.pm.disable()})},enabled(l=[]){return l.length===0&&(this._layers=this.getLayers()),!!this._layers.find(h=>h instanceof L.LayerGroup?l.indexOf(h._leaflet_id)===-1?(l.push(h._leaflet_id),h.pm.enabled(l)):!1:h.pm.enabled())},toggleEdit(l,h=[]){h.length===0&&(this._layers=this.getLayers()),this._options=l,this._layers.forEach(v=>{v instanceof L.LayerGroup?h.indexOf(v._leaflet_id)===-1&&(h.push(v._leaflet_id),v.pm.toggleEdit(l,h)):v.pm.toggleEdit(l)})},_initLayer(l){let h=L.Util.stamp(this._layerGroup);l.pm._parentLayerGroup||(l.pm._parentLayerGroup={}),l.pm._parentLayerGroup[h]=this._layerGroup},_removeLayerFromGroup(l){if(l.pm&&l.pm._layerGroup){let h=L.Util.stamp(this._layerGroup);delete l.pm._layerGroup[h]}},dragging(){return this._layers=this.getLayers(),this._layers?!!this._layers.find(l=>l.pm.dragging()):!1},getOptions(){return this.options},_getMap(){var l;return this._map||((l=this._layers.find(h=>!!h._map))==null?void 0:l._map)||null},getLayers(l=!1,h=!0,v=!0,x=[]){let E=[];return l?this._layerGroup.getLayers().forEach(j=>{E.push(j),j instanceof L.LayerGroup&&x.indexOf(j._leaflet_id)===-1&&(x.push(j._leaflet_id),E=E.concat(j.pm.getLayers(!0,!0,!0,x)))}):E=this._layerGroup.getLayers(),v&&(E=E.filter(j=>!(j instanceof L.LayerGroup))),h&&(E=E.filter(j=>!!j.pm),E=E.filter(j=>!j._pmTempLayer),E=E.filter(j=>!L.PM.optIn&&!j.options.pmIgnore||L.PM.optIn&&j.options.pmIgnore===!1)),E},setOptions(l,h=[]){h.length===0&&(this._layers=this.getLayers()),this.options=l,this._layers.forEach(v=>{v.pm&&(v instanceof L.LayerGroup?h.indexOf(v._leaflet_id)===-1&&(h.push(v._leaflet_id),v.pm.setOptions(l,h)):v.pm.setOptions(l))})}}),Kt.Marker=Kt.extend({_shape:"Marker",initialize(l){this._layer=l,this._enabled=!1,this._layer.on("dragend",this._onDragEnd,this)},enable(l={draggable:!0}){if(L.Util.setOptions(this,l),!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._fireEnable()},disable(){this.enabled()&&(this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this._layer.off("contextmenu",this._removeMarker,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1)},enabled(){return this._enabled},toggleEdit(l){this.enabled()?this.disable():this.enable(l)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this.options.draggable?this.enableLayerDrag():this.disableLayerDrag(),this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_removeMarker(l){let h=l.target;h.remove(),this._fireRemove(h),this._fireRemove(this._map,h)},_onDragEnd(){this._fireEdit(),this._layerEdited=!0},_initSnappableMarkers(){let l=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,l.off("pm:drag",this._handleSnapping,this),l.on("pm:drag",this._handleSnapping,this),l.off("pm:dragend",this._cleanupSnapping,this),l.on("pm:dragend",this._cleanupSnapping,this),l.off("pm:dragstart",this._unsnap,this),l.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let l=this._layer;l.off("pm:drag",this._handleSnapping,this),l.off("pm:dragend",this._cleanupSnapping,this),l.off("pm:dragstart",this._unsnap,this)}});var Gt=f(Rr()),dt={filterMarkerGroup(){this.markerCache=[],this.createCache(),this._layer.on("pm:edit",this.createCache,this),this.applyLimitFilters({}),this.throttledApplyLimitFilters||(this.throttledApplyLimitFilters=L.Util.throttle(this.applyLimitFilters,100,this)),this._layer.on("pm:disable",this._removeMarkerLimitEvents,this),this._layer.on("remove",this._removeMarkerLimitEvents,this),this.options.limitMarkersToCount>-1&&(this._layer.on("pm:vertexremoved",this._initMarkers,this),this._map.on("mousemove",this.throttledApplyLimitFilters,this))},_removeMarkerLimitEvents(){this._map.off("mousemove",this.throttledApplyLimitFilters,this),this._layer.off("pm:edit",this.createCache,this),this._layer.off("pm:disable",this._removeMarkerLimitEvents,this),this._layer.off("pm:vertexremoved",this._initMarkers,this)},createCache(){let l=[...this._markerGroup.getLayers(),...this.markerCache];this.markerCache=l.filter((h,v,x)=>x.indexOf(h)===v)},_removeFromCache(l){let h=this.markerCache.indexOf(l);h>-1&&this.markerCache.splice(h,1)},renderLimits(l){this.markerCache.forEach(h=>{l.includes(h)?this._markerGroup.addLayer(h):this._markerGroup.removeLayer(h)})},applyLimitFilters({latlng:l={lat:0,lng:0}}){if(this._preventRenderMarkers)return;let h=[...this._filterClosestMarkers(l)];this.renderLimits(h)},_filterClosestMarkers(l){let h=[...this.markerCache],v=this.options.limitMarkersToCount;return v===-1?h:(h.sort((x,E)=>{let j=x._latlng.distanceTo(l),X=E._latlng.distanceTo(l);return j-X}),h.filter((x,E)=>v>-1?E<v:!0))},_preventRenderMarkers:!1,_preventRenderingMarkers(l){this._preventRenderMarkers=!!l}},yt=dt;Kt.Line=Kt.extend({includes:[yt],_shape:"Line",initialize(l){this._layer=l,this._enabled=!1},enable(l){if(L.Util.setOptions(this,l),this._map=this._layer._map,!!this._map){if(!this.options.allowEditing){this.disable();return}this.enabled()&&this.disable(),this._enabled=!0,this._initMarkers(),this.applyOptions(),this._layer.on("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.on("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this),this.options.allowSelfIntersection?this.cachedColor=void 0:(this._layer.options.color!=="#f00000ff"?(this.cachedColor=this._layer.options.color,this.isRed=!1):this.isRed=!0,this._handleLayerStyle()),this._fireEnable()}},disable(){if(!this.enabled()||this._dragging)return;this._enabled=!1,this._markerGroup.clearLayers(),this._markerGroup.removeFrom(this._map),this._layer.off("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.off("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this);let l=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(l,"leaflet-pm-draggable"),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()},enabled(){return this._enabled},toggleEdit(l){return this.enabled()?this.disable():this.enable(l),this.enabled()},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initMarkers(){let l=this._map,h=this._layer.getLatLngs();this._markerGroup&&(this._markerGroup.removeFrom(l),this._markerGroup.clearLayers()),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0;let v=x=>{if(Array.isArray(x[0]))return x.map(v,this);let E=x.map(this._createMarker,this);return this.options.hideMiddleMarkers!==!0&&x.map((j,X)=>{let re=this.isPolygon()?(X+1)%x.length:X+1;return this._createMiddleMarker(E[X],E[re])}),E};this._markers=v(h),this.filterMarkerGroup(),l.addLayer(this._markerGroup)},_createMarker(l){let h=new L.Marker(l,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(h,"vertexPane"),h._pmTempLayer=!0,this.options.rotate?(h.on("dragstart",this._onRotateStart,this),h.on("drag",this._onRotate,this),h.on("dragend",this._onRotateEnd,this)):(h.on("click",this._onVertexClick,this),h.on("dragstart",this._onMarkerDragStart,this),h.on("move",this._onMarkerDrag,this),h.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||h.on(this.options.removeVertexOn,this._removeMarker,this)),this._markerGroup.addLayer(h),h},_createMiddleMarker(l,h){if(!l||!h)return!1;let v=L.PM.Utils.calcMiddleLatLng(this._map,l.getLatLng(),h.getLatLng()),x=this._createMarker(v),E=L.divIcon({className:"marker-icon marker-icon-middle"});return x.setIcon(E),x.leftM=l,x.rightM=h,l._middleMarkerNext=x,h._middleMarkerPrev=x,x.on(this.options.addVertexOn,this._onMiddleMarkerClick,this),x.on("movestart",this._onMiddleMarkerMoveStart,this),x},_onMiddleMarkerClick(l){let h=l.target;if(!this._vertexValidation("add",l))return;let v=L.divIcon({className:"marker-icon"});h.setIcon(v),this._addMarker(h,h.leftM,h.rightM)},_onMiddleMarkerMoveStart(l){let h=l.target;if(h.on("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidation("add",l)){h.on("move",this._onMiddleMarkerMovePrevent,this);return}h._dragging=!0,this._addMarker(h,h.leftM,h.rightM)},_onMiddleMarkerMovePrevent(l){let h=l.target;this._vertexValidationDrag(h)},_onMiddleMarkerMoveEnd(l){let h=l.target;if(h.off("move",this._onMiddleMarkerMovePrevent,this),h.off("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidationDragEnd(h))return;let v=L.divIcon({className:"marker-icon"});h.setIcon(v),setTimeout(()=>{delete h._dragging},100)},_addMarker(l,h,v){l.off("movestart",this._onMiddleMarkerMoveStart,this),l.off(this.options.addVertexOn,this._onMiddleMarkerClick,this);let x=l.getLatLng(),E=this._layer._latlngs;delete l.leftM,delete l.rightM;let{indexPath:j,index:X,parentPath:re}=L.PM.Utils.findDeepMarkerIndex(this._markers,h),ge=j.length>1?(0,Gt.default)(E,re):E,Le=j.length>1?(0,Gt.default)(this._markers,re):this._markers;ge.splice(X+1,0,x),Le.splice(X+1,0,l),this._layer.setLatLngs(E),this.options.hideMiddleMarkers!==!0&&(this._createMiddleMarker(h,l),this._createMiddleMarker(l,v)),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit"),this._fireVertexAdded(l,L.PM.Utils.findDeepMarkerIndex(this._markers,l).indexPath,x),this.options.snappable&&this._initSnappableMarkers()},hasSelfIntersection(){return $r(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersectionOnVertexRemoval(){this._handleLayerStyle(!0)&&(this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers())},_handleLayerStyle(l){let h=this._layer,v,x;if(this.options.allowSelfIntersection?v=!1:(x=$r(this._layer.toGeoJSON(15)),v=x.features.length>0),v){if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!0),this.isRed)return v;l?this._flashLayer():(h.setStyle({color:"#f00000ff"}),this.isRed=!0),this._fireIntersect(x)}else h.setStyle({color:this.cachedColor}),this.isRed=!1,!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!1);return v},_flashLayer(){this.cachedColor||(this.cachedColor=this._layer.options.color),this._layer.setStyle({color:"#f00000ff"}),this.isRed=!0,window.setTimeout(()=>{this._layer.setStyle({color:this.cachedColor}),this.isRed=!1},200)},_updateDisabledMarkerStyle(l,h){l.forEach(v=>{Array.isArray(v)?this._updateDisabledMarkerStyle(v,h):v._icon&&(h&&!this._checkMarkerAllowedToDrag(v)?L.DomUtil.addClass(v._icon,"vertexmarker-disabled"):L.DomUtil.removeClass(v._icon,"vertexmarker-disabled"))})},_removeMarker(l){let h=l.target;if(!this._vertexValidation("remove",l))return;this.options.allowSelfIntersection||(this._coordsBeforeEdit=Fs(this._layer,this._layer.getLatLngs()));let v=this._layer.getLatLngs(),{indexPath:x,index:E,parentPath:j}=L.PM.Utils.findDeepMarkerIndex(this._markers,h);if(!x)return;let X=x.length>1?(0,Gt.default)(v,j):v,re=x.length>1?(0,Gt.default)(this._markers,j):this._markers,ge=j[j.length-1]>0&&this._layer instanceof L.Polygon;if(!this.options.removeLayerBelowMinVertexCount&&!ge&&(X.length<=2||this.isPolygon()&&X.length<=3)){this._flashLayer();return}X.splice(E,1),this._layer.setLatLngs(v),this.isPolygon()&&X.length<=2&&X.splice(0,X.length);let Le=!1;if(X.length<=1&&(X.splice(0,X.length),j.length>1&&x.length>1&&(v=sl(v)),this._layer.setLatLngs(v),this._initMarkers(),Le=!0),co(v)||this._layer.remove(),v=sl(v),this._layer.setLatLngs(v),this._markers=sl(this._markers),!Le&&(re=x.length>1?(0,Gt.default)(this._markers,j):this._markers,h._middleMarkerPrev&&(this._markerGroup.removeLayer(h._middleMarkerPrev),this._removeFromCache(h._middleMarkerPrev)),h._middleMarkerNext&&(this._markerGroup.removeLayer(h._middleMarkerNext),this._removeFromCache(h._middleMarkerNext)),this._markerGroup.removeLayer(h),this._removeFromCache(h),re)){let Xe,ze;if(this.isPolygon()?(Xe=(E+1)%re.length,ze=(E+(re.length-1))%re.length):(ze=E-1<0?void 0:E-1,Xe=E+1>=re.length?void 0:E+1),Xe!==ze){let vt=re[ze],Dt=re[Xe];this.options.hideMiddleMarkers!==!0&&this._createMiddleMarker(vt,Dt)}re.splice(E,1)}this._fireEdit(),this._layerEdited=!0,this._fireVertexRemoved(h,x),this._fireChange(this._layer.getLatLngs(),"Edit")},updatePolygonCoordsFromMarkerDrag(l){let h=this._layer.getLatLngs(),v=l.getLatLng(),{indexPath:x,index:E,parentPath:j}=L.PM.Utils.findDeepMarkerIndex(this._markers,l);(x.length>1?(0,Gt.default)(h,j):h).splice(E,1,v),this._layer.setLatLngs(h)},_getNeighborMarkers(l){let{indexPath:h,index:v,parentPath:x}=L.PM.Utils.findDeepMarkerIndex(this._markers,l),E=h.length>1?(0,Gt.default)(this._markers,x):this._markers,j=(v+1)%E.length,X=(v+(E.length-1))%E.length,re=E[X],ge=E[j];return{prevMarker:re,nextMarker:ge}},_checkMarkerAllowedToDrag(l){let{prevMarker:h,nextMarker:v}=this._getNeighborMarkers(l),x=L.polyline([h.getLatLng(),l.getLatLng()]),E=L.polyline([l.getLatLng(),v.getLatLng()]),j=gs(this._layer.toGeoJSON(15),x.toGeoJSON(15)).features.length,X=gs(this._layer.toGeoJSON(15),E.toGeoJSON(15)).features.length;return l.getLatLng()===this._markers[0][0].getLatLng()?X+=1:l.getLatLng()===this._markers[0][this._markers[0].length-1].getLatLng()&&(j+=1),!(j<=2&&X<=2)},_onMarkerDragStart(l){let h=l.target;if(this.cachedColor||(this.cachedColor=this._layer.options.color),!this._vertexValidation("move",l))return;let{indexPath:v}=L.PM.Utils.findDeepMarkerIndex(this._markers,h);this._fireMarkerDragStart(l,v),this.options.allowSelfIntersection||(this._coordsBeforeEdit=Fs(this._layer,this._layer.getLatLngs())),!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()?this._markerAllowedToDrag=this._checkMarkerAllowedToDrag(h):this._markerAllowedToDrag=null},_onMarkerDrag(l){let h=l.target;if(!this._vertexValidationDrag(h))return;let{indexPath:v,index:x,parentPath:E}=L.PM.Utils.findDeepMarkerIndex(this._markers,h);if(!v)return;if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()&&this._markerAllowedToDrag===!1){this._layer.setLatLngs(this._coordsBeforeEdit),this._initMarkers(),this._handleLayerStyle();return}this.updatePolygonCoordsFromMarkerDrag(h);let j=v.length>1?(0,Gt.default)(this._markers,E):this._markers,X=(x+1)%j.length,re=(x+(j.length-1))%j.length,ge=h.getLatLng(),Le=j[re].getLatLng(),Xe=j[X].getLatLng();if(h._middleMarkerNext){let ze=L.PM.Utils.calcMiddleLatLng(this._map,ge,Xe);h._middleMarkerNext.setLatLng(ze)}if(h._middleMarkerPrev){let ze=L.PM.Utils.calcMiddleLatLng(this._map,ge,Le);h._middleMarkerPrev.setLatLng(ze)}this.options.allowSelfIntersection||this._handleLayerStyle(),this._fireMarkerDrag(l,v),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(l){let h=l.target;if(!this._vertexValidationDragEnd(h))return;let{indexPath:v}=L.PM.Utils.findDeepMarkerIndex(this._markers,h),x=!this.options.allowSelfIntersection&&this.hasSelfIntersection();x&&this.options.allowSelfIntersectionEdit&&this._markerAllowedToDrag&&(x=!1);let E=!this.options.allowSelfIntersection&&x;if(this._fireMarkerDragEnd(l,v,E),E){this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers(),this.options.snappable&&this._initSnappableMarkers(),this._handleLayerStyle(),this._fireLayerReset(l,v);return}!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._handleLayerStyle(),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_onVertexClick(l){let h=l.target;if(h._dragging)return;let{indexPath:v}=L.PM.Utils.findDeepMarkerIndex(this._markers,h);this._fireVertexClick(l,v)}}),Kt.Polygon=Kt.Line.extend({_shape:"Polygon",_checkMarkerAllowedToDrag(l){let{prevMarker:h,nextMarker:v}=this._getNeighborMarkers(l),x=L.polyline([h.getLatLng(),l.getLatLng()]),E=L.polyline([l.getLatLng(),v.getLatLng()]),j=gs(this._layer.toGeoJSON(15),x.toGeoJSON(15)).features.length,X=gs(this._layer.toGeoJSON(15),E.toGeoJSON(15)).features.length;return!(j<=2&&X<=2)}}),Kt.Rectangle=Kt.Polygon.extend({_shape:"Rectangle",_initMarkers(){let l=this._map,h=this._findCorners();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0,l.addLayer(this._markerGroup),this._markers=[],this._markers[0]=h.map(this._createMarker,this),[this._cornerMarkers]=this._markers,this._layer.getLatLngs()[0].forEach((v,x)=>{let E=this._cornerMarkers.find(j=>j._index===x);E&&E.setLatLng(v)})},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this._addMarkerEvents()},_createMarker(l,h){let v=new L.Marker(l,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(v,"vertexPane"),v._origLatLng=l,v._index=h,v._pmTempLayer=!0,v.on("click",this._onVertexClick,this),this._markerGroup.addLayer(v),v},_addMarkerEvents(){this._markers[0].forEach(l=>{l.on("dragstart",this._onMarkerDragStart,this),l.on("drag",this._onMarkerDrag,this),l.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||l.on("contextmenu",this._removeMarker,this)})},_removeMarker(){return null},_onMarkerDragStart(l){if(!this._vertexValidation("move",l))return;let h=l.target,v=this._cornerMarkers;h._oppositeCornerLatLng=v.find(E=>E._index===(h._index+2)%4).getLatLng(),h._snapped=!1;let{indexPath:x}=L.PM.Utils.findDeepMarkerIndex(this._markers,h);this._fireMarkerDragStart(l,x)},_onMarkerDrag(l){let h=l.target;if(!this._vertexValidationDrag(h)||h._index===void 0)return;this._adjustRectangleForMarkerMove(h);let{indexPath:v}=L.PM.Utils.findDeepMarkerIndex(this._markers,h);this._fireMarkerDrag(l,v),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(l){let h=l.target;if(!this._vertexValidationDragEnd(h))return;this._cornerMarkers.forEach(x=>{delete x._oppositeCornerLatLng});let{indexPath:v}=L.PM.Utils.findDeepMarkerIndex(this._markers,h);this._fireMarkerDragEnd(l,v),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_adjustRectangleForMarkerMove(l){L.extend(l._origLatLng,l._latlng);let h=L.PM.Utils._getRotatedRectangle(l.getLatLng(),l._oppositeCornerLatLng,this.getAngle(),this._map);this._layer.setLatLngs(h),this._adjustAllMarkers(l),this._layer.redraw()},_adjustAllMarkers(l){let h=this._layer.getLatLngs()[0];if(h&&h.length!==4&&h.length>0)h.forEach((v,x)=>{this._cornerMarkers[x].setLatLng(v)}),this._cornerMarkers.slice(h.length).forEach(v=>{v.setLatLng(h[0])});else if(!h||!h.length)console.error("The layer has no LatLngs");else{let v=h.findIndex(x=>l.getLatLng().equals(x));v>-1?(this._cornerMarkers[(l._index+1)%4].setLatLng(h[(v+1)%4]),this._cornerMarkers[(l._index+2)%4].setLatLng(h[(v+2)%4]),this._cornerMarkers[(l._index+3)%4].setLatLng(h[(v+3)%4])):this._cornerMarkers.forEach(x=>{x.setLatLng(h[x._index])})}},_findCorners(){this._angle===void 0&&this.setInitAngle(ta(this._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);let l=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(l[0],l[2],this.getAngle(),this._map||this)}}),Kt.CircleMarker=Kt.extend({_shape:"CircleMarker",initialize(l){this._layer=l,this._enabled=!1,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._updateHiddenPolyCircle()},enable(l={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,l),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._extendingEnable(),this._updateHiddenPolyCircle(),this._fireEnable()},_extendingEnable(){this._layer.on("pm:dragstart",this._onDragStart,this),this._layer.on("pm:drag",this._onMarkerDrag,this),this._layer.on("pm:dragend",this._onMarkerDragEnd,this)},disable(){this.dragging()||(this._map||(this._map=this._layer._map),this._map&&this.enabled()&&(this.layerDragEnabled()&&this.disableLayerDrag(),this._helperLayers&&(this._helperLayers.clearLayers(),this._helperLayers.removeFrom(this._map)),this.options[this._editableOption]?(this._map.off("move",this._syncMarkers,this),this._outerMarker.off("drag",this._handleOuterMarkerSnapping,this)):this._map.off("move",this._updateHiddenPolyCircle,this),this._extendingDisable(),this._layer.off("remove",this.disable,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1))},_extendingDisable(){this._layer.off("contextmenu",this._removeMarker,this)},enabled(){return this._enabled},toggleEdit(l){this.enabled()?this.disable():this.enable(l)},applyOptions(){this.options[this._editableOption]?(this._initMarkers(),this._map.on("move",this._syncMarkers,this),this.options.snappable?(this._initSnappableMarkers(),this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this),this._outerMarker.on("move",this._syncHintLine,this),this._outerMarker.on("move",this._syncCircleRadius,this)):this._disableSnapping()):(this.options.draggable&&this.enableLayerDrag(),this._map.on("move",this._updateHiddenPolyCircle,this),this.options.snappable?this._initSnappableMarkersDrag():this._disableSnappingDrag()),this._extendingApplyOptions()},_extendingApplyOptions(){this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_initMarkers(){let l=this._map;this._helperLayers&&(this._helperLayers.removeFrom(l),this._helperLayers.clearLayers()),this._helperLayers=new L.FeatureGroup,this._helperLayers._pmTempLayer=!0,this._helperLayers.addTo(l);let h=this._layer.getLatLng(),v=this._layer._radius,x=this._getLatLngOnCircle(h,v);this._centerMarker=this._createCenterMarker(h),this._outerMarker=this._createOuterMarker(x),this._markers=[this._centerMarker,this._outerMarker],this._createHintLine(this._centerMarker,this._outerMarker)},_getLatLngOnCircle(l,h){let v=this._map.project(l),x=L.point(v.x+h,v.y);return this._map.unproject(x)},_createHintLine(l,h){let v=l.getLatLng(),x=h.getLatLng();this._hintline=L.polyline([v,x],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._helperLayers.addLayer(this._hintline)},_createCenterMarker(l){let h=this._createMarker(l);return this.options.draggable?(L.DomUtil.addClass(h._icon,"leaflet-pm-draggable"),h.on("move",this._moveCircle,this)):h.dragging.disable(),h},_createOuterMarker(l){let h=this._createMarker(l);return h.on("drag",this._resizeCircle,this),h},_createMarker(l){let h=new L.Marker(l,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(h,"vertexPane"),h._origLatLng=l,h._pmTempLayer=!0,h.on("dragstart",this._onMarkerDragStart,this),h.on("drag",this._onMarkerDrag,this),h.on("dragend",this._onMarkerDragEnd,this),h.on("click",this._onVertexClick,this),this._helperLayers.addLayer(h),h},_moveCircle(l){if(l.target._cancelDragEventChain)return;let h=this._centerMarker.getLatLng();this._layer.setLatLng(h);let v=this._layer._radius,x=this._getLatLngOnCircle(h,v);this._outerMarker._latlng=x,this._outerMarker.update(),this._syncHintLine(),this._updateHiddenPolyCircle(),this._fireCenterPlaced("Edit"),this._fireChange(this._layer.getLatLng(),"Edit")},_syncMarkers(){let l=this._layer.getLatLng(),h=this._layer._radius,v=this._getLatLngOnCircle(l,h);this._outerMarker.setLatLng(v),this._centerMarker.setLatLng(l),this._syncHintLine(),this._updateHiddenPolyCircle()},_resizeCircle(){this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker()),this._syncHintLine(),this._syncCircleRadius()},_syncCircleRadius(){let l=this._centerMarker.getLatLng(),h=this._outerMarker.getLatLng(),v=this._distanceCalculation(l,h);this.options[this._minRadiusOption]&&v<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&v>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(v),this._updateHiddenPolyCircle(),this._fireChange(this._layer.getLatLng(),"Edit")},_syncHintLine(){let l=this._centerMarker.getLatLng(),h=this._outerMarker.getLatLng();this._hintline.setLatLngs([l,h])},_removeMarker(){this.options[this._editableOption]&&this.disable(),this._layer.remove(),this._fireRemove(this._layer),this._fireRemove(this._map,this._layer)},_onDragStart(){this._map.pm.Draw.CircleMarker._layerIsDragging=!0},_onMarkerDragStart(l){this._vertexValidation("move",l)&&this._fireMarkerDragStart(l)},_onMarkerDrag(l){let h=l.target;h instanceof L.Marker&&!this._vertexValidationDrag(h)||this._fireMarkerDrag(l)},_onMarkerDragEnd(l){this._extedingMarkerDragEnd();let h=l.target;this._vertexValidationDragEnd(h)&&(this.options[this._editableOption]&&(this._fireEdit(),this._layerEdited=!0),this._fireMarkerDragEnd(l))},_extedingMarkerDragEnd(){this._map.pm.Draw.CircleMarker._layerIsDragging=!1},_initSnappableMarkersDrag(){let l=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,l.off("pm:drag",this._handleSnapping,this),l.on("pm:drag",this._handleSnapping,this),l.off("pm:dragend",this._cleanupSnapping,this),l.on("pm:dragend",this._cleanupSnapping,this),l.off("pm:dragstart",this._unsnap,this),l.on("pm:dragstart",this._unsnap,this)},_disableSnappingDrag(){let l=this._layer;l.off("pm:drag",this._handleSnapping,this),l.off("pm:dragend",this._cleanupSnapping,this),l.off("pm:dragstart",this._unsnap,this)},_updateHiddenPolyCircle(){let l=this._layer._map||this._map;if(l){let h=L.PM.Utils.pxRadiusToMeterRadius(this._layer.getRadius(),l,this._layer.getLatLng()),v=L.circle(this._layer.getLatLng(),this._layer.options);v.setRadius(h);let x=l&&l.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(v,200,!x).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(v,200,!x),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)}},_getNewDestinationOfOuterMarker(){let l=this._centerMarker.getLatLng(),h=this._outerMarker.getLatLng(),v=this._distanceCalculation(l,h);return this.options[this._minRadiusOption]&&v<this.options[this._minRadiusOption]?h=Nl(this._map,l,h,this._getMinDistanceInMeter(l)):this.options[this._maxRadiusOption]&&v>this.options[this._maxRadiusOption]&&(h=Nl(this._map,l,h,this._getMaxDistanceInMeter(l))),h},_handleOuterMarkerSnapping(){if(this._outerMarker._snapped){let l=this._centerMarker.getLatLng(),h=this._outerMarker.getLatLng(),v=this._distanceCalculation(l,h);this.options[this._minRadiusOption]&&v<this.options[this._minRadiusOption]?this._outerMarker.setLatLng(this._outerMarker._orgLatLng):this.options[this._maxRadiusOption]&&v>this.options[this._maxRadiusOption]&&this._outerMarker.setLatLng(this._outerMarker._orgLatLng)}this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker())},_distanceCalculation(l,h){return this._map.project(l).distanceTo(this._map.project(h))},_getMinDistanceInMeter(l){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,l)},_getMaxDistanceInMeter(l){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,l)},_onVertexClick(l){l.target._dragging||this._fireVertexClick(l,void 0)}}),Kt.Circle=Kt.CircleMarker.extend({_shape:"Circle",initialize(l){this._layer=l,this._enabled=!1,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizeableCircle",this._updateHiddenPolyCircle()},enable(l){L.PM.Edit.CircleMarker.prototype.enable.call(this,l||{})},_extendingEnable(){},_extendingDisable(){this._layer.off("remove",this.disable,this);let l=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(l,"leaflet-pm-draggable")},_extendingApplyOptions(){},_syncMarkers(){},_removeMarker(){},_onDragStart(){},_extedingMarkerDragEnd(){},_updateHiddenPolyCircle(){let l=this._map&&this._map.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(this._layer,200,!l).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(this._layer,200,!l),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)},_distanceCalculation(l,h){return this._map.distance(l,h)},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_onVertexClick(l){l.target._dragging||this._fireVertexClick(l,void 0)}}),Kt.ImageOverlay=Kt.extend({_shape:"ImageOverlay",initialize(l){this._layer=l,this._enabled=!1},toggleEdit(l){this.enabled()?this.disable():this.enable(l)},enabled(){return this._enabled},enable(l={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,l),this._map=this._layer._map,!!this._map){if(!this.options.allowEditing){this.disable();return}this.enabled()||this.disable(),this.enableLayerDrag(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._otherSnapLayers=this._findCorners(),this._fireEnable()}},disable(){this._dragging||(this._map||(this._map=this._layer._map),this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this.enabled()||(this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()),this._enabled=!1)},_findCorners(){let l=this._layer.getBounds(),h=l.getNorthWest(),v=l.getNorthEast(),x=l.getSouthEast(),E=l.getSouthWest();return[h,v,x,E]}}),Kt.Text=Kt.extend({_shape:"Text",initialize(l){this._layer=l,this._enabled=!1},enable(l){if(L.Util.setOptions(this,l),!!this.textArea){if(!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._safeToCacheDragState=!0,this._focusChange(),this.textArea.readOnly=!1,this.textArea.classList.remove("pm-disabled"),this._layer.on("remove",this.disable,this),L.DomEvent.on(this.textArea,"input",this._autoResize,this),L.DomEvent.on(this.textArea,"focus",this._focusChange,this),L.DomEvent.on(this.textArea,"blur",this._focusChange,this),this._layer.on("dblclick",L.DomEvent.stop),L.DomEvent.off(this.textArea,"mousedown",this._preventTextSelection),this._enabled=!0,this._fireEnable()}},disable(){if(!this.enabled())return;this._layer.off("remove",this.disable,this),L.DomEvent.off(this.textArea,"input",this._autoResize,this),L.DomEvent.off(this.textArea,"focus",this._focusChange,this),L.DomEvent.off(this.textArea,"blur",this._focusChange,this),L.DomEvent.off(document,"click",this._documentClick,this),this._focusChange(),this.textArea.readOnly=!0,this.textArea.classList.add("pm-disabled");let l=document.activeElement;this.textArea.focus(),this.textArea.selectionStart=0,this.textArea.selectionEnd=0,L.DomEvent.on(this.textArea,"mousedown",this._preventTextSelection),l.focus(),this._disableOnBlurActive=!1,this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1},enabled(){return this._enabled},toggleEdit(l){this.enabled()?this.disable():this.enable(l)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initSnappableMarkers(){let l=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,l.off("pm:drag",this._handleSnapping,this),l.on("pm:drag",this._handleSnapping,this),l.off("pm:dragend",this._cleanupSnapping,this),l.on("pm:dragend",this._cleanupSnapping,this),l.off("pm:dragstart",this._unsnap,this),l.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let l=this._layer;l.off("pm:drag",this._handleSnapping,this),l.off("pm:dragend",this._cleanupSnapping,this),l.off("pm:dragstart",this._unsnap,this)},_autoResize(){this.textArea.style.height="1px",this.textArea.style.width="1px";let l=this.textArea.scrollHeight>21?this.textArea.scrollHeight:21,h=this.textArea.scrollWidth>16?this.textArea.scrollWidth:16;this.textArea.style.height=`${l}px`,this.textArea.style.width=`${h}px`,this._layer.options.text=this.getText(),this._fireTextChange(this.getText())},_disableOnBlur(){this._disableOnBlurActive=!0,setTimeout(()=>{this.enabled()&&L.DomEvent.on(document,"click",this._documentClick,this)},100)},_documentClick(l){l.target!==this.textArea&&(this.disable(),!this.getText()&&this.options.removeIfEmpty&&this.remove())},_focusChange(l={}){let h=this._hasFocus;this._hasFocus=l.type==="focus",!h!=!this._hasFocus&&(this._hasFocus?(this._applyFocus(),this._focusText=this.getText(),this._fireTextFocus()):(this._removeFocus(),this._fireTextBlur(),this._focusText!==this.getText()&&(this._fireEdit(),this._layerEdited=!0)))},_applyFocus(){this.textArea.classList.add("pm-hasfocus"),this._map.dragging&&(this._safeToCacheDragState&&(this._originalMapDragState=this._map.dragging._enabled,this._safeToCacheDragState=!1),this._map.dragging.disable())},_removeFocus(){this._map.dragging&&(this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0),this.textArea.classList.remove("pm-hasfocus")},focus(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.focus()},blur(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.blur(),this._disableOnBlurActive&&this.disable()},hasFocus(){return this._hasFocus},getElement(){return this.textArea},setText(l){l&&(this.textArea.value=l),this._autoResize()},getText(){return this.textArea.value},_initTextMarker(){if(this.textArea=L.PM.Draw.Text.prototype._createTextArea.call(this),this.options.className){let h=this.options.className.split(" ");this.textArea.classList.add(...h)}let l=L.PM.Draw.Text.prototype._createTextIcon.call(this,this.textArea);this._layer.setIcon(l),this._layer.once("add",this._createTextMarker,this)},_createTextMarker(l=!1){this._layer.off("add",this._createTextMarker,this),this._layer.getElement().tabIndex=-1,this.textArea.wrap="off",this.textArea.style.overflow="hidden",this.textArea.style.height=L.DomUtil.getStyle(this.textArea,"font-size"),this.textArea.style.width="1px",this._layer.options.text&&this.setText(this._layer.options.text),this._autoResize(),l===!0&&(this.enable(),this.focus(),this._disableOnBlur())},_preventTextSelection(l){l.preventDefault()}});var en=function(l,h,v,x,E,j){this._matrix=[l,h,v,x,E,j]};en.init=()=>new L.PM.Matrix(1,0,0,1,0,0),en.prototype={transform(l){return this._transform(l.clone())},_transform(l){let h=this._matrix,{x:v,y:x}=l;return l.x=h[0]*v+h[1]*x+h[4],l.y=h[2]*v+h[3]*x+h[5],l},untransform(l){let h=this._matrix;return new L.Point((l.x/h[0]-h[4])/h[0],(l.y/h[2]-h[5])/h[2])},clone(){let l=this._matrix;return new L.PM.Matrix(l[0],l[1],l[2],l[3],l[4],l[5])},translate(l){if(l===void 0)return new L.Point(this._matrix[4],this._matrix[5]);let h,v;return typeof l=="number"?(h=l,v=l):(h=l.x,v=l.y),this._add(1,0,0,1,h,v)},scale(l,h){if(l===void 0)return new L.Point(this._matrix[0],this._matrix[3]);let v,x;return h=h||L.point(0,0),typeof l=="number"?(v=l,x=l):(v=l.x,x=l.y),this._add(v,0,0,x,h.x,h.y)._add(1,0,0,1,-h.x,-h.y)},rotate(l,h){let v=Math.cos(l),x=Math.sin(l);return h=h||new L.Point(0,0),this._add(v,x,-x,v,h.x,h.y)._add(1,0,0,1,-h.x,-h.y)},flip(){return this._matrix[1]*=-1,this._matrix[2]*=-1,this},_add(l,h,v,x,E,j){let X=[[],[],[]],re=this._matrix,ge=[[re[0],re[2],re[4]],[re[1],re[3],re[5]],[0,0,1]],Le=[[l,v,E],[h,x,j],[0,0,1]],Xe;l&&l instanceof L.PM.Matrix&&(re=l._matrix,Le=[[re[0],re[2],re[4]],[re[1],re[3],re[5]],[0,0,1]]);for(let ze=0;ze<3;ze+=1)for(let vt=0;vt<3;vt+=1){Xe=0;for(let Dt=0;Dt<3;Dt+=1)Xe+=ge[ze][Dt]*Le[Dt][vt];X[ze][vt]=Xe}return this._matrix=[X[0][0],X[1][0],X[0][1],X[1][1],X[0][2],X[1][2]],this}};var dn=en,nn={calcMiddleLatLng(l,h,v){let x=l.project(h),E=l.project(v);return l.unproject(x._add(E)._divideBy(2))},findLayers(l){let h=[];return l.eachLayer(v=>{(v instanceof L.Polyline||v instanceof L.Marker||v instanceof L.Circle||v instanceof L.CircleMarker||v instanceof L.ImageOverlay)&&h.push(v)}),h=h.filter(v=>!!v.pm),h=h.filter(v=>!v._pmTempLayer),h=h.filter(v=>!L.PM.optIn&&!v.options.pmIgnore||L.PM.optIn&&v.options.pmIgnore===!1),h},circleToPolygon(l,h=60,v=!0){let x=l.getLatLng(),E=l.getRadius(),j=qi(x,E,h,0,v),X=[];for(let re=0;re<j.length;re+=1){let ge=[j[re].lat,j[re].lng];X.push(ge)}return L.polygon(X,l.options)},disablePopup(l){l.getPopup()&&(l._tempPopupCopy=l.getPopup(),l.unbindPopup())},enablePopup(l){l._tempPopupCopy&&(l.bindPopup(l._tempPopupCopy),delete l._tempPopupCopy)},_fireEvent(l,h,v,x=!1){l.fire(h,v,x);let{groups:E}=this.getAllParentGroups(l);E.forEach(j=>{j.fire(h,v,x)})},getAllParentGroups(l){let h=[],v=[],x=E=>{for(let j in E._eventParents)if(h.indexOf(j)===-1){h.push(j);let X=E._eventParents[j];v.push(X),x(X)}};return!l._pmLastGroupFetch||!l._pmLastGroupFetch.time||new Date().getTime()-l._pmLastGroupFetch.time>1e3?(x(l),l._pmLastGroupFetch={time:new Date().getTime(),groups:v,groupIds:h},{groupIds:h,groups:v}):{groups:l._pmLastGroupFetch.groups,groupIds:l._pmLastGroupFetch.groupIds}},createGeodesicPolygon:qi,getTranslation:lr,findDeepCoordIndex(l,h,v=!0){let x,E=X=>(re,ge)=>{let Le=X.concat(ge);if(v){if(re.lat&&re.lat===h.lat&&re.lng===h.lng)return x=Le,!0}else if(re.lat&&L.latLng(re).equals(h))return x=Le,!0;return Array.isArray(re)&&re.some(E(Le))};l.some(E([]));let j={};return x&&(j={indexPath:x,index:x[x.length-1],parentPath:x.slice(0,x.length-1)}),j},findDeepMarkerIndex(l,h){let v,x=j=>(X,re)=>{let ge=j.concat(re);return X._leaflet_id===h._leaflet_id?(v=ge,!0):Array.isArray(X)&&X.some(x(ge))};l.some(x([]));let E={};return v&&(E={indexPath:v,index:v[v.length-1],parentPath:v.slice(0,v.length-1)}),E},_getIndexFromSegment(l,h){if(h&&h.length===2){let v=this.findDeepCoordIndex(l,h[0]),x=this.findDeepCoordIndex(l,h[1]),E=Math.max(v.index,x.index);return(v.index===0||x.index===0)&&E!==1&&(E+=1),{indexA:v,indexB:x,newIndex:E,indexPath:v.indexPath,parentPath:v.parentPath}}return null},_getRotatedRectangle(l,h,v,x){let E=Ve(x,l),j=Ve(x,h),X=v*Math.PI/180,re=Math.cos(X),ge=Math.sin(X),Le=(j.x-E.x)*re+(j.y-E.y)*ge,Xe=(j.y-E.y)*re-(j.x-E.x)*ge,ze=Le*re+E.x,vt=Le*ge+E.y,Dt=-Xe*ge+E.x,Xt=Xe*re+E.y,_n=ht(x,E),Sn=ht(x,{x:ze,y:vt}),hr=ht(x,j),Je=ht(x,{x:Dt,y:Xt});return[_n,Sn,hr,Je]},pxRadiusToMeterRadius(l,h,v){let x=h.project(v),E=L.point(x.x+l,x.y);return h.distance(h.unproject(E),v)}},kn=nn;L.PM=L.PM||{version:jo.version,Map:ko,Toolbar:al,Draw:fo,Edit:Kt,Utils:kn,Matrix:dn,activeLang:"en",optIn:!1,initialize(l){this.addInitHooks(l)},setOptIn(l){this.optIn=!!l},addInitHooks(){function l(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Map(this)):this.options.pmIgnore||(this.pm=new L.PM.Map(this)),this.pm&&this.pm.setGlobalOptions({})}L.Map.addInitHook(l);function h(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.LayerGroup(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.LayerGroup(this))}L.LayerGroup.addInitHook(h);function v(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this)):this.options.pmIgnore||(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this))}L.Marker.addInitHook(v);function x(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.CircleMarker(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.CircleMarker(this))}L.CircleMarker.addInitHook(x);function E(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Line(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Line(this))}L.Polyline.addInitHook(E);function j(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Polygon(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Polygon(this))}L.Polygon.addInitHook(j);function X(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Rectangle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Rectangle(this))}L.Rectangle.addInitHook(X);function re(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Circle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Circle(this))}L.Circle.addInitHook(re);function ge(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.ImageOverlay(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.ImageOverlay(this))}L.ImageOverlay.addInitHook(ge)},reInitLayer(l){l instanceof L.LayerGroup&&l.eachLayer(h=>{this.reInitLayer(h)}),l.pm||L.PM.optIn&&l.options.pmIgnore!==!1||l.options.pmIgnore||(l instanceof L.Map?l.pm=new L.PM.Map(l):l instanceof L.Marker?l.options.textMarker?(l.pm=new L.PM.Edit.Text(l),l.pm._initTextMarker(),l.pm._createTextMarker(!1)):l.pm=new L.PM.Edit.Marker(l):l instanceof L.Circle?l.pm=new L.PM.Edit.Circle(l):l instanceof L.CircleMarker?l.pm=new L.PM.Edit.CircleMarker(l):l instanceof L.Rectangle?l.pm=new L.PM.Edit.Rectangle(l):l instanceof L.Polygon?l.pm=new L.PM.Edit.Polygon(l):l instanceof L.Polyline?l.pm=new L.PM.Edit.Line(l):l instanceof L.LayerGroup?l.pm=new L.PM.Edit.LayerGroup(l):l instanceof L.ImageOverlay&&(l.pm=new L.PM.Edit.ImageOverlay(l)))}},L.version==="1.7.1"&&L.Canvas.include({_onClick(l){let h=this._map.mouseEventToLayerPoint(l),v,x;for(let E=this._drawFirst;E;E=E.next)v=E.layer,v.options.interactive&&v._containsPoint(h)&&(!(l.type==="click"||l.type==="preclick")||!this._map._draggableMoved(v))&&(x=v);x&&(L.DomEvent.fakeStop(l),this._fireEvent([x],l))}}),L.PM.initialize()})();class zh extends qn.Circle{constructor(t,r){const i=r.radius||10;super(t,i,r);qt(this,"properties");qt(this,"angleCache",new Map);qt(this,"lastCenter");qt(this,"lastCenterCosLat");qt(this,"_pendingNameUpdate",!1);qt(this,"_nameUpdateTimeout",null);hn.measure("Circle.constructor.init",()=>{this.properties={type:"Circle",style:{name:r.name||""}},requestAnimationFrame(()=>{this.updateProperties()}),this.on("add",()=>{requestAnimationFrame(()=>{this.updateProperties()})})},"Circle")}updateProperties(){hn.measure("Circle.updateProperties",()=>{var u,f,d,m;const t=this.getRadius(),r=this.getLatLng(),i=((f=(u=this.properties)==null?void 0:u.style)==null?void 0:f.name)||"",s=((d=this.properties)==null?void 0:d.style)||{},o={type:"Circle",radius:t,diameter:t*2,surface:Math.PI*Math.pow(t,2),perimeter:2*Math.PI*t,center:{lat:r.lat,lng:r.lng},style:{...s,color:this.options.color||"#2b6451",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#2b6451",fillOpacity:this.options.fillOpacity||.2,dashArray:((m=this.options)==null?void 0:m.dashArray)||"",name:i}};JSON.stringify(this.properties)!==JSON.stringify(o)&&(this.properties=o,this.fire("properties:updated",{shape:this,properties:this.properties}))},"Circle")}setName(t){hn.measure("Circle.setName",()=>{var r,i;((i=(r=this.properties)==null?void 0:r.style)==null?void 0:i.name)!==t&&(this.properties.style||(this.properties.style={}),this.properties.style.name=t,!this._pendingNameUpdate&&(this._pendingNameUpdate=!0,this._nameUpdateTimeout&&clearTimeout(this._nameUpdateTimeout),this._nameUpdateTimeout=setTimeout(()=>{this._pendingNameUpdate=!1,this._nameUpdateTimeout=null,this.fire("properties:updated",{shape:this,properties:this.properties})},100)))},"Circle")}getName(){return hn.measure("Circle.getName",()=>{var t,r;return((r=(t=this.properties)==null?void 0:t.style)==null?void 0:r.name)||""},"Circle")}setRadius(t){return hn.measure("Circle.setRadius",()=>(super.setRadius(t),this.updateProperties(),this),"Circle")}setLatLng(t){return hn.measure("Circle.setLatLng",()=>(super.setLatLng(t),this.updateProperties(),this),"Circle")}calculatePointOnCircle(t){return hn.measure("Circle.calculatePointOnCircle",()=>{const r=this.getLatLng(),i=this.getRadius();let s=this.angleCache.get(t);if(!s){const o=t*Math.PI/180;s={sin:Math.sin(o),cos:Math.cos(o)},this.angleCache.set(t,s)}return(!this.lastCenter||!this.lastCenter.equals(r))&&(this.lastCenter=r,this.lastCenterCosLat=Math.cos(r.lat*Math.PI/180)),qn.latLng(r.lat+i/111319.9*s.sin,r.lng+i/(111319.9*this.lastCenterCosLat)*s.cos)},"Circle")}getCardinalPoints(){return hn.measure("Circle.getCardinalPoints",()=>[0,45,90,135,180,225,270,315].map(t=>this.calculatePointOnCircle(t)),"Circle")}calculateAngleFromPoint(t){return hn.measure("Circle.calculateAngleFromPoint",()=>{const r=this.getLatLng(),i=t.lng-r.lng,s=t.lat-r.lat;let o=Math.atan2(s,i)*180/Math.PI;return o<0&&(o+=360),o},"Circle")}resizeFromControlPoint(t){hn.measure("Circle.resizeFromControlPoint",()=>{const i=this.getLatLng().distanceTo(t);i>0&&super.setRadius(i)},"Circle")}clearCache(){this.angleCache.clear(),this.lastCenter=void 0,this.lastCenterCosLat=void 0}}const _m=(e,n)=>{if(!e||typeof e!="string"||!e.startsWith("#"))return`rgba(0, 0, 0, ${n})`;const t=parseInt(e.slice(1,3),16),r=parseInt(e.slice(3,5),16),i=parseInt(e.slice(5,7),16);return`rgba(${t}, ${r}, ${i}, ${n})`},bb=(e,n)=>{e.style.fontSize=n.fontSize,e.style.color=n.color,e.style.backgroundColor=_m(n.backgroundColor,n.backgroundOpacity),n.hasBorder?e.style.border=`${n.borderWidth} solid ${_m(n.borderColor,n.borderOpacity)}`:e.style.border="none",e.style.padding=n.padding,e.style.borderRadius=n.borderRadius},ml=e=>{document.querySelectorAll(".drawing-help-message").forEach(r=>r.remove());const t=jt.DomUtil.create("div","drawing-help-message");return t.innerHTML=e,t.style.cssText=`
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 8px 16px;
    border-radius: 4px;
    font-size: 14px;
    z-index: 2000;
    pointer-events: none;
    text-align: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  `,document.body.appendChild(t),t};function wb(e,n,t){const r=156543.03392*Math.cos(n*Math.PI/180)/Math.pow(2,t);return e/r}const Yi=(e,n="m",t="")=>{let r,i;return n==="m²"?e>=1e4?(r=(e/1e4).toFixed(2),i="ha"):(r=e.toFixed(2),i="m²"):n==="m"?e>=1e3?(r=(e/1e3).toFixed(2),i="km"):(r=e.toFixed(2),i="m"):(r=e.toFixed(2),i=n),t?`${t}: ${r} ${i}`:`${r} ${i}`},PR=e=>({...e,clientX:e.clientX,clientY:e.clientY,button:e.button||0,buttons:e.buttons||0,altKey:e.altKey||!1}),MR=(e,n)=>{let t;return function(...r){window.clearTimeout(t),t=window.setTimeout(()=>e.apply(this,r),n)}},Hf=(e,n)=>{let t=0;return function(...r){const i=Date.now();if(!(i-t<n))return t=i,e.apply(this,r)}};function AR(){const e=zt(null),n=zt(null),t=zt(null),r=zt(null),i=zt(""),s=zt(null),o=zt(!1),u=zt(null);window.addEventListener("clearControlPoints",()=>{s.value=null,t.value&&t.value.clearLayers(),r.value&&r.value.clearLayers(),document.querySelectorAll(".measure-tooltip").forEach(H=>H.remove()),document.querySelectorAll(".drawing-help-message").forEach(H=>H.remove())}),mc(()=>{window.removeEventListener("clearControlPoints",()=>{}),e.value&&(e.value.remove(),e.value=null)});const f=(H,Q="Double-cliquez pour éditer")=>{const ue={fontSize:"14px",color:"#000000",backgroundColor:"#FFFFFF",backgroundOpacity:1,borderColor:"#000000",borderWidth:"1px",borderOpacity:1,padding:"5px 10px",borderRadius:"3px",hasBorder:!0,rotation:0,physicalSize:2},le=(We,Ge)=>{var He;const tt=((He=e.value)==null?void 0:He.getZoom())||14,Ze=H.lat,et=wb(Ge.physicalSize,Ze,tt);return`<div class="text-container" style="width:${et}px;height:${et}px;transform:rotate(${Ge.rotation}deg)">
        <div class="text-annotation" style="font-size:${et*.2}px;color:${Ge.color};background-color:${_m(Ge.backgroundColor,Ge.backgroundOpacity)};border:${Ge.hasBorder?Ge.borderWidth+" solid "+_m(Ge.borderColor,Ge.borderOpacity):"none"};padding:${Ge.padding};border-radius:${Ge.borderRadius}">${We}</div>
        <div class="text-controls"><div class="control-button rotate"></div><div class="control-button move"></div></div>
      </div>`},pe=()=>{if(!e.value)return;const We=N.getIcon(),Ge={html:le(N.properties.text,N.properties.style),className:We.options.className};N.setIcon(jt.divIcon(Ge))},Z=jt.divIcon({html:le(Q,ue),className:"text-container",iconSize:[40,40],iconAnchor:[20,20]}),N=jt.marker(H,{icon:Z,draggable:!1,pmIgnore:!0});N.properties={type:"text",text:Q,style:{...ue}},e.value&&(e.value.on("zoomend",pe),N.on("remove",()=>{var We;(We=e.value)==null||We.off("zoomend",pe)})),pe();let ke=!1,Me=!1,Ue=0,ce=0;const ne=We=>{if(!e.value)return;const Ge=We.target;if(Ge.classList.contains("rotate")){ke=!0;const tt=N.getLatLng(),Ze=e.value.mouseEventToLatLng(We);Ue=Math.atan2(Ze.lat-tt.lat,Ze.lng-tt.lng)*180/Math.PI,ce=N.properties.style.rotation||0}else Ge.classList.contains("move")&&(Me=!0);document.addEventListener("mousemove",ye),document.addEventListener("mouseup",de)},ye=We=>{if(!(!Me||!e.value)){if(ke){const Ge=N.getLatLng(),tt=e.value.mouseEventToLatLng(We),Ze=Math.atan2(tt.lat-Ge.lat,tt.lng-Ge.lng)*180/Math.PI,et=(ce+(Ze-Ue))%360;N.properties.style.rotation=et;const He=N.getIcon(),wt={html:le(N.properties.text,N.properties.style),className:He.options.className};N.setIcon(jt.divIcon(wt))}else if(Me){const Ge=PR(We),tt=e.value.mouseEventToLatLng(Ge);N.setLatLng(tt)}}},de=()=>{ke=!1,Me=!1,document.removeEventListener("mousemove",ye),document.removeEventListener("mouseup",de)};return N.on("add",()=>{const We=N.getElement();We&&We.querySelectorAll(".control-button").forEach(tt=>{tt.addEventListener("mousedown",ne)})}),N.on("remove",()=>{const We=N.getElement();We&&We.querySelectorAll(".control-button").forEach(tt=>{tt.removeEventListener("mousedown",ne)})}),N.on("dblclick",We=>{var wt;jt.DomEvent.stopPropagation(We);const Ge=(wt=N.getElement())==null?void 0:wt.querySelector(".text-annotation");if(!Ge)return;Ge.contentEditable="true",Ge.focus(),Ge.classList.add("editing");const tt=window.getSelection(),Ze=document.createRange();Ze.selectNodeContents(Ge),tt==null||tt.removeAllRanges(),tt==null||tt.addRange(Ze);const et=()=>{Ge.contentEditable="false",Ge.classList.remove("editing");const Pt=Ge.innerText.trim();if(Pt){N.properties.text=Pt;const kt=N.getIcon(),Jt={html:le(Pt,N.properties.style),className:kt.options.className};N.setIcon(jt.divIcon(Jt))}Ge.removeEventListener("blur",et),Ge.removeEventListener("keydown",He)},He=Pt=>{Pt.key==="Enter"&&!Pt.shiftKey&&(Pt.preventDefault(),et())};Ge.addEventListener("blur",et),Ge.addEventListener("keydown",He)}),N},d=(H,Q)=>{const ue=jt.DomUtil.create("div","measure-tooltip");if(ue.innerHTML=Q,ue.style.cssText=`
      position: fixed;
      background-color: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      z-index: 2000;
      pointer-events: none;
      white-space: pre-line;
    `,document.body.appendChild(ue),e.value){const le=e.value.latLngToContainerPoint(H);ue.style.left=`${le.x+10}px`,ue.style.top=`${le.y-25}px`}return ue},m=Hf((H,Q,ue)=>{if(H&&(H.innerHTML=ue,e.value)){const le=e.value.latLngToContainerPoint(Q);H.style.left=`${le.x+10}px`,H.style.top=`${le.y-25}px`}},100),_=(H,Q,ue)=>{H.on("mouseover",()=>{const le=d(H.getLatLng(),ue());H.measureDiv=le}),H.on("mousemove",le=>{H.measureDiv&&e.value&&m(H.measureDiv,le.latlng,ue())}),H.on("mouseout",()=>{H.measureDiv&&(H.measureDiv.remove(),H.measureDiv=void 0)})};let w=[];const y=()=>{var H;w.cleanup&&w.cleanup(),t.value&&t.value.clearLayers(),w=[],(H=r.value)==null||H.clearLayers(),document.querySelectorAll(".measure-tooltip").forEach(Q=>Q.remove()),n.value&&n.value.getLayers().forEach(Q=>{Q instanceof pa&&Q.clearHelperPoints()})},M=(H,Q="#2563EB")=>{const ue=jt.circleMarker(H,{radius:6,color:Q,fillColor:Q,fillOpacity:1,weight:2,className:"control-point",pmIgnore:!0});return t.value&&t.value.addLayer(ue),ue},k=(H,Q)=>{var le,pe,Z,N,ke,Me;console.log("Input layer:",{type:Q,instanceof:{Circle:H instanceof jt.Circle,Rectangle:H instanceof jt.Rectangle,Polygon:H instanceof jt.Polygon,Polyline:H instanceof jt.Polyline,ElevationLine:H instanceof Cf,Line:H instanceof Bs},options:H.options});const ue={type:Q,style:H.options||{}};try{if(H instanceof jt.Circle){const Ue=H.getRadius();ue.radius=Ue,ue.diameter=Ue*2,ue.surface=Math.PI*Math.pow(Ue,2),ue.perimeter=2*Math.PI*Ue,ue.center=H.getLatLng()}else if(H instanceof jt.Rectangle){const Ue=H.getBounds(),ce=Ue.getNorthEast(),ne=Ue.getSouthWest(),ye=du([[ne.lng,ne.lat],[ce.lng,ne.lat]]),de=du([[ne.lng,ne.lat],[ne.lng,ce.lat]]),We=Gf(ye,{units:"meters"}),Ge=Gf(de,{units:"meters"});ue.width=We,ue.height=Ge,ue.surface=We*Ge,ue.perimeter=2*(We+Ge),ue.dimensions={width:We,height:Ge}}else if(H instanceof jt.Polygon)try{const ce=H.getLatLngs()[0].map(ye=>[ye.lng,ye.lat]);ce.push(ce[0]);const ne=hu([ce]);ue.surface=oc(ne),ue.perimeter=Gf(du(ce),{units:"meters"})}catch(Ue){console.error("Erreur lors du calcul des propriétés du polygone",Ue)}else if(H instanceof jt.Polyline&&!(H instanceof jt.Polygon))try{const Ue=H.getLatLngs();let ce=0;for(let ne=1;ne<Ue.length;ne++)ce+=Ue[ne].distanceTo(Ue[ne-1]);ue.length=ce}catch(Ue){console.error("Erreur lors du calcul de la longueur de la ligne",Ue)}ue.style={...ue.style,color:((le=H.options)==null?void 0:le.color)||"#3388ff",weight:((pe=H.options)==null?void 0:pe.weight)||3,opacity:((Z=H.options)==null?void 0:Z.opacity)||1,fillColor:((N=H.options)==null?void 0:N.fillColor)||"#3388ff",fillOpacity:((ke=H.options)==null?void 0:ke.fillOpacity)||.2,dashArray:((Me=H.options)==null?void 0:Me.dashArray)||""}}catch(Ue){console.error("Error calculating shape properties:",Ue)}return ue},F=(H,Q=2)=>{var N;if(!e.value){console.warn("Map is not available for text size update");return}const ue=e.value.getZoom(),le=H.getLatLng().lat,pe=wb(Q,le,ue),Z=(N=H.getElement())==null?void 0:N.querySelector(".text-annotation");Z&&(H.properties.style.fontSize=`${pe}px`,H.properties.physicalWidth=Q,H.properties.physicalHeight=Q,bb(Z,H.properties.style))},I=(H,Q,ue)=>{const le=jt.map(H).setView(Q,ue);e.value=le,jt.tileLayer("/osm_tiles/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:5}).addTo(le);const pe=new jt.FeatureGroup;return pe.addTo(le),n.value=pe,t.value=jt.featureGroup().addTo(le),r.value=jt.featureGroup().addTo(le),le.pm.setGlobalOptions({snappable:!0,snapDistance:20,allowSelfIntersection:!1,preventMarkerRemoval:!0,syncLayersOnDrag:!0,layerGroup:pe,snapLayers:[pe,r.value],templineStyle:{color:"#3388ff",weight:2,opacity:.7,dashArray:"6,6",radius:6},hintlineStyle:{color:"#3388ff",weight:2,opacity:.7,dashArray:"6,6",radius:6}}),le.on("pm:drawstart",Z=>{o.value=!0,Z.shape==="Circle"&&i.value==="Semicircle"&&(le.getContainer().style.cursor="crosshair")}),le.on("pm:drawend",()=>{o.value=!1,le.getContainer().style.cursor="",s.value&&ml("Cliquez sur la forme pour afficher les points de contrôle")}),le.on("pm:create",Te),pe.on("click",Z=>{var ke,Me,Ue,ce,ne,ye,de,We,Ge,tt,Ze,et,He,wt,Pt;jt.DomEvent.stopPropagation(Z);const N=Z.layer;if(N.name&&!((ke=N.properties)!=null&&ke.name)?(N.properties||(N.properties={}),N.properties.name=N.name):(Me=N.properties)!=null&&Me.name&&!N.name&&(N.name=N.properties.name),console.log("[featureGroup click] État du nom:",{directName:N.name,propertiesName:(Ue=N.properties)==null?void 0:Ue.name,fullProperties:N.properties}),(ce=r.value)==null||ce.clearLayers(),y(),s.value=N,N instanceof zh)U(N);else if(N instanceof jt.Circle){console.log("[useMapDrawing] Création du cercle personnalisé:",{propertyDescriptor:Object.getOwnPropertyDescriptor(N,"name"),directName:N.name,propertiesName:(ne=N.properties)==null?void 0:ne.name,styleNameBeforeTransfer:(de=(ye=N.properties)==null?void 0:ye.style)==null?void 0:de.name,nameIsEnumerable:Object.keys(N).includes("name"),allProperties:Object.keys(N.properties||{}),_dbId:N._dbId});const kt=N.name,Jt=(We=N.properties)==null?void 0:We.name,rn=(tt=(Ge=N.properties)==null?void 0:Ge.style)==null?void 0:tt.name,un=N._dbId,Ke=new zh(N.getLatLng(),{...N.options,radius:N.getRadius()});N.properties?Ke.properties={...N.properties||{}}:Ke.updateProperties();const ot=kt||Jt||rn;ot&&(Ke.properties.name=ot,Ke.properties.style||(Ke.properties.style={}),Ke.properties.style.name=ot,Ke.name=ot),un&&(Ke._dbId=un),console.log("[useMapDrawing] Cercle après conversion:",{name:Ke.name,propertiesName:Ke.properties.name,stylePropertyName:(Ze=Ke.properties.style)==null?void 0:Ze.name,allProperties:Object.keys(Ke.properties||{})}),(et=n.value)==null||et.removeLayer(N),(He=n.value)==null||He.addLayer(Ke),s.value=Ke,U(Ke)}else if(N instanceof pa)J(N);else if(N instanceof jt.Rectangle){const kt=new pa(N.getBounds(),{...N.options});kt.updateProperties(),(wt=n.value)==null||wt.removeLayer(N),(Pt=n.value)==null||Pt.addLayer(kt),s.value=kt,J(kt)}else N instanceof jt.Polygon?D(N):N instanceof Bs||N instanceof jt.Polyline?T(N):N instanceof zc&&B(N)}),le.on("pm:edit",Z=>{var ke,Me,Ue;console.log("[pm:edit] Début",{layer:Z.layer,currentProperties:Z.layer.properties});const N=Z.layer;if(N){const ce=((ke=N.properties)==null?void 0:ke.type)||"unknown";if(ve(N,ce),console.log("[pm:edit] Après updateLayerProperties",{updatedProperties:N.properties,selectedShape:s.value}),N instanceof zh)U(N);else if(N instanceof pa)J(N);else if(N instanceof jt.Rectangle){const ne=new pa(N.getBounds(),{...N.options});ne.updateProperties(),(Me=n.value)==null||Me.removeLayer(N),(Ue=n.value)==null||Ue.addLayer(ne),s.value=ne,J(ne)}else N instanceof jt.Polygon?D(N):N instanceof Bs?(N.updateProperties(),ve(N,"Line"),T(N)):N instanceof jt.Polyline?T(N):N instanceof zc&&(N.updateProperties(),B(N))}}),le.on("pm:dragstart",()=>{document.querySelectorAll(".drawing-help-message").forEach(Z=>Z.remove()),ml("Déplacez la forme à l'endroit souhaité")}),le.on("pm:dragend",Z=>{var ke,Me,Ue;console.log("[pm:dragend] Début",{layer:Z.layer,currentProperties:Z.layer.properties});const N=Z.layer;if(N){const ce=((ke=N.properties)==null?void 0:ke.type)||"unknown";if(N instanceof jt.Rectangle&&!(N instanceof pa)){const ne=new pa(N.getBounds(),{...N.options});ne.updateProperties(),(Me=n.value)==null||Me.removeLayer(N),(Ue=n.value)==null||Ue.addLayer(ne),s.value=ne,J(ne)}else N instanceof Bs?(N.updateProperties(),ve(N,"Line"),T(N)):ve(N,ce);console.log("[pm:dragend] Après updateLayerProperties",{updatedProperties:N.properties,selectedShape:s.value})}setTimeout(()=>{ml("Cliquez sur la forme pour afficher les points de contrôle")},100)}),le.on("pm:remove",()=>{var Z;(Z=document.querySelector(".drawing-help-message"))==null||Z.remove()}),le.on("pm:select",()=>{document.querySelectorAll(".drawing-help-message").forEach(Z=>Z.remove()),ml("Utilisez les points de contrôle pour modifier la forme")}),le.on("pm:unselect",()=>{document.querySelectorAll(".drawing-help-message").forEach(Z=>Z.remove())}),le.on("zoomstart",()=>{s.value&&(y(),s.value=null,document.querySelectorAll(".drawing-help-message").forEach(Z=>Z.remove()))}),le},R=()=>{if(!(!e.value||!n.value||!n.value.getLayers().length))try{const H=n.value.getBounds();if(H.isValid()){const Q={zoomAnimation:e.value.options.zoomAnimation,fadeAnimation:e.value.options.fadeAnimation,markerZoomAnimation:e.value.options.markerZoomAnimation};e.value.options.zoomAnimation=!1,e.value.options.fadeAnimation=!1,e.value.options.markerZoomAnimation=!1,e.value.fitBounds(H,{padding:[50,50],maxZoom:18,animate:!1,duration:0,noMoveStart:!0}),e.value.invalidateSize({animate:!1,pan:!1}),setTimeout(()=>{try{e.value.options.fadeAnimation=Q.fadeAnimation,setTimeout(()=>{try{e.value.options.zoomAnimation=Q.zoomAnimation,e.value.options.markerZoomAnimation=Q.markerZoomAnimation}catch(ue){console.warn("[useMapDrawing] Erreur lors de la restauration des animations:",ue)}},500)}catch(ue){console.warn("[useMapDrawing] Erreur lors de la restauration des animations:",ue)}},500)}}catch(H){if(console.warn("[useMapDrawing] Error adjusting view:",H),e.value)try{e.value.options.zoomAnimation=!0,e.value.options.fadeAnimation=!0,e.value.options.markerZoomAnimation=!0,e.value.invalidateSize({animate:!1,pan:!1})}catch(Q){console.error("[useMapDrawing] Erreur lors de la restauration après échec:",Q)}}},K=H=>{var ue;if(!e.value)return;document.querySelectorAll(".drawing-help-message").forEach(le=>le.remove());try{const le=e.value.pm;le.globalEditModeEnabled()&&le.disableGlobalEditMode(),le.globalRemovalModeEnabled()&&le.disableGlobalRemovalMode(),le.disableDraw(),y(),(ue=r.value)==null||ue.clearLayers()}catch(le){console.error("Error disabling modes:",le)}if(i.value=H,!H){y();return}let Q=H;switch(H){case"Note":Q="GeoNote";break;case"Polygon":Q="Polygon";break;case"Line":Q="Line";break;case"ElevationLine":Q="ElevationLine";break;default:Q=H}H=Q,Y(),setTimeout(()=>{var le,pe,Z,N,ke,Me,Ue,ce,ne,ye,de,We,Ge;try{switch(H){case"Polygon":ml("Cliquez pour ajouter des points, double-cliquez pour terminer le polygone"),(le=e.value)==null||le.pm.enableDraw("Polygon",{finishOn:"dblclick",continueDrawing:!1,snapMiddle:!0,snapDistance:20}),(pe=e.value)==null||pe.off("pm:create"),(Z=e.value)==null||Z.on("pm:create",Ze=>{var et,He,wt;if(Ze.shape==="Polygon"&&Ze.layer){const Pt=Ze.layer.getLatLngs()[0];(et=e.value)==null||et.removeLayer(Ze.layer),(He=n.value)!=null&&He.hasLayer(Ze.layer)&&n.value.removeLayer(Ze.layer);const kt=new vf(Pt,{color:"#3B82F6",weight:3,fillColor:"#3B82F6",fillOpacity:.2});n.value&&(n.value.addLayer(kt),s.value=kt,kt.updateProperties()),(wt=e.value)==null||wt.pm.disableDraw(),Y()}});break;case"Circle":n.value&&n.value.getLayers().filter(et=>et instanceof pa).forEach(et=>{et.toggleHelperPoints(e.value,!0,"#DC2626","#2563EB")}),e.value.pm.setGlobalOptions({snapDistance:15,snapSegment:!0,snapVertices:!0,snapLayers:[n.value,r.value],snapMiddle:!0,snapIntersections:!0}),ml("Positionnez le centre du cercle. Points bleus : milieu des côtés, Points rouges : sommets, Point vert : centre"),e.value.pm.enableDraw("Circle",{finishOn:"mouseup",continueDrawing:!1});break;case"Rectangle":ml("Cliquez et maintenez pour dessiner un rectangle, relâchez pour terminer"),(N=e.value)==null||N.pm.enableDraw("Rectangle",{finishOn:"mouseup"});break;case"Polygon":ml("Cliquez pour ajouter des points, double-cliquez pour terminer le polygone"),(ke=e.value)==null||ke.pm.enableDraw("Polygon",{finishOn:"dblclick",continueDrawing:!1,snapMiddle:!0,snapDistance:20});break;case"Line":ml("Cliquez pour ajouter des points, double-cliquez pour terminer la ligne"),(Me=e.value)==null||Me.pm.enableDraw("Line",{finishOn:"dblclick",continueDrawing:!1,snapMiddle:!0,snapDistance:20}),(Ue=e.value)==null||Ue.off("pm:create"),(ce=e.value)==null||ce.on("pm:create",Ze=>{var et,He,wt;if(Ze.shape==="Line"&&Ze.layer){const Pt=Ze.layer.getLatLngs();(et=e.value)==null||et.removeLayer(Ze.layer),(He=n.value)!=null&&He.hasLayer(Ze.layer)&&n.value.removeLayer(Ze.layer);const kt=new Bs(Pt,{color:"#3B82F6",weight:3,opacity:.8});n.value&&(n.value.addLayer(kt),s.value=kt,kt.updateProperties()),(wt=e.value)==null||wt.pm.disableDraw(),Y()}});break;case"Text":if(ml("Cliquez pour ajouter du texte, double-cliquez pour éditer"),e.value){const Ze=et=>{if(!e.value||!n.value)return;const He=f(et.latlng);n.value.addLayer(He),s.value=He,e.value.off("click",Ze),K("")};e.value.on("click",Ze)}break;case"GeoNote":if(ml("Cliquez pour ajouter une note géolocalisée, double-cliquez pour éditer"),e.value){const Ze=async et=>{if(!(!e.value||!n.value))try{const He=cd(),wt=new zc(et.latlng,{color:"#3B82F6",name:"Note géolocalisée",description:"",columnId:"1"});n.value.addLayer(wt),s.value=wt,wt.updateProperties();try{const Pt=He.currentMapId||void 0,kt=await wt.saveNote(Pt);console.log(`[useMapDrawing] Note sauvegardée avec succès, ID backend: ${kt}`);const Jt=wt._leaflet_id;console.log(`[useMapDrawing] ID Leaflet: ${Jt}, ID backend: ${kt}`),window.dispatchEvent(new CustomEvent("note:created",{detail:{geoNote:wt,leafletId:Jt,backendId:kt}})),wt.openPopup()}catch(Pt){console.error("[useMapDrawing] Erreur lors de la sauvegarde de la note:",Pt),mf(async()=>{const{useNotificationStore:kt}=await Promise.resolve().then(()=>f8);return{useNotificationStore:kt}},void 0).then(({useNotificationStore:kt})=>{kt().error("Erreur lors de la création de la note")})}e.value.off("click",Ze),K("")}catch(He){console.error("[useMapDrawing] Erreur lors de la création de la note:",He),e.value.off("click",Ze),K("")}};e.value.on("click",Ze)}break;case"delete":ml("Cliquez sur une forme pour la supprimer"),(ne=e.value)==null||ne.pm.enableGlobalRemovalMode();break;case"ElevationLine":ml("Cliquez et maintenez pour tracer le profil altimétrique"),(ye=e.value)==null||ye.pm.enableDraw("Line",{finishOn:"mouseup",continueDrawing:!1,allowSelfIntersection:!1,templineStyle:{color:"#FF4500",weight:4,opacity:.8}}),(de=e.value)==null||de.pm.setGlobalOptions({continueDrawing:!1,finishOn:"mouseup",preventMarkerRemoval:!0,preventVertexEdit:!0,preventMarkerEdit:!0}),(We=e.value)==null||We.off("pm:create"),(Ge=e.value)==null||Ge.on("pm:create",async Ze=>{var et,He,wt;if(Ze.shape==="Line"&&Ze.layer){const Pt=Ze.layer.getLatLngs();(et=e.value)==null||et.removeLayer(Ze.layer),(He=n.value)!=null&&He.hasLayer(Ze.layer)&&n.value.removeLayer(Ze.layer);const kt=new Cf(Pt,{color:"#FF4500",weight:4,opacity:.8,interactive:!1,pmIgnore:!0});if(n.value){n.value.addLayer(kt),s.value=kt,await kt.updateElevationProfile();const Jt=k(kt,"ElevationLine");Object.assign(kt.properties,{...Jt,...kt.properties,type:"ElevationLine",elevationData:kt.getElevationData()}),s.value=null,Us(()=>{s.value=kt})}(wt=e.value)==null||wt.pm.disableDraw(),i.value="",Y()}});break}}catch(tt){console.error("[setDrawingTool] Erreur lors de la configuration de l'outil:",tt)}},100)},ee=H=>{var ue;if(!s.value)return;const Q=s.value;if(Q.properties=Q.properties||{},Q.properties.style=Q.properties.style||{},Q.properties.style={...Q.properties.style,...H},Q.properties.type==="text"){const le=Q.properties._textLayer,pe=(ue=le==null?void 0:le.getElement())==null?void 0:ue.querySelector(".text-annotation");pe&&bb(pe,Q.properties.style);const Z={color:H.borderColor||Q.properties.style.borderColor,weight:parseInt(H.borderWidth||Q.properties.style.borderWidth),opacity:H.borderOpacity??Q.properties.style.borderOpacity};"setStyle"in Q&&Q.setStyle(Z)}else if(Q.properties.type==="TextRectangle")console.log("[updateShapeStyle] TextRectangle supprimé selon les exigences");else{const le={};H.fillColor&&(le.fillColor=H.fillColor),H.fillOpacity!==void 0&&(le.fillOpacity=H.fillOpacity),H.strokeColor&&(le.color=H.strokeColor),H.strokeOpacity!==void 0&&(le.opacity=H.strokeOpacity),H.strokeWidth!==void 0&&(le.weight=H.strokeWidth),H.dashArray&&(le.dashArray=H.dashArray),"setStyle"in Q&&Q.setStyle(le)}},he=H=>{var N,ke,Me,Ue,ce;if(!s.value){console.warn("[useMapDrawing] Cannot update properties: no shape selected");return}console.log("[useMapDrawing] Updating shape properties",{before:s.value.properties,newProps:H,layerType:(N=s.value.properties)==null?void 0:N.type,beforeName:s.value.name,beforePropertiesName:(ke=s.value.properties)==null?void 0:ke.name,beforeCategory:(Me=s.value.properties)==null?void 0:Me.category,nameIsDirectProperty:"name"in s.value,dbId:s.value._dbId}),s.value.properties||(s.value.properties={});const Q=s.value.properties.type;console.log(`[useMapDrawing] Type actuel de la forme: ${Q}`),s.value.properties.category||(s.value.properties.category="forages"),s.value.properties.accessLevel||(s.value.properties.accessLevel="visitor"),s.value._dbId||(s.value._dbId=Date.now()+Math.floor(Math.random()*1e3),console.log(`[useMapDrawing] Assigned temporary dbId: ${s.value._dbId}`));const ue=s.value.properties.type;console.log(`[useMapDrawing] Type original avant mise à jour: ${ue}`);const le=s.value.properties.category;console.log(`[useMapDrawing] Catégorie existante: ${le}`);const pe="category"in H&&H.category!==le;if(Object.keys(H).forEach(ne=>{ne==="type"&&ue?console.log(`[useMapDrawing] Préservation du type original: ${ue}`):s.value.properties[ne]=H[ne],ne==="name"&&(console.log(`[useMapDrawing] Setting name "${H[ne]}" directly on layer`),s.value.name=H[ne]),ne==="category"&&console.log(`[useMapDrawing] Mise à jour de la catégorie: ${le} -> ${H[ne]}`)}),ue&&(s.value.properties.type=ue),le&&!pe&&(console.log(`[useMapDrawing] Restauration de la catégorie originale: ${le}`),s.value.properties.category=le),s.value._dbId&&pe){const ne=cd(),ye=ne.elements.find(de=>de.id===s.value._dbId);if(ye){console.log(`[useMapDrawing] Mise à jour de la catégorie dans le store: ${s.value.properties.category} pour l'élément ${s.value._dbId}`);const de=ye;de.data||(de.data={}),de.data.category=s.value.properties.category,ne.$patch({unsavedChanges:!0})}}const Z=new CustomEvent("shape:propertiesUpdated",{detail:{shape:s.value,properties:s.value.properties,categoryUpdated:pe}});if(window.dispatchEvent(Z),console.log("[useMapDrawing] Updated shape properties",{after:s.value.properties,name:s.value.name,propertiesName:(Ue=s.value.properties)==null?void 0:Ue.name,allLayerKeys:Object.keys(s.value),allPropertiesKeys:Object.keys(s.value.properties||{})}),((ce=s.value.properties)==null?void 0:ce.type)==="Circle"){const ne=s.value,ye=ne.getRadius();ne.properties.radius=ye,ne.properties.diameter=ye*2,ne.properties.surface=Math.PI*ye*ye,ne.properties.perimeter=2*Math.PI*ye,H.name&&(console.log(`[useMapDrawing] Ensuring circle name "${H.name}" is set in multiple places`),ne.properties.name=H.name,ne.properties.style.name=H.name,ne.name=H.name,console.log("[useMapDrawing] Circle name verification:",{circleDirectName:ne.name,circlePropertiesName:ne.properties.name,nameIsEnumerable:Object.keys(ne).includes("name"),propertiesNameIsEnumerable:Object.keys(ne.properties).includes("name")}))}},fe=H=>{console.log("[forceShapeUpdate] Début",{currentProperties:H.properties,selectedShapeRef:s.value}),s.value=null,Us(()=>{s.value=H,console.log("[forceShapeUpdate] Après mise à jour",{selectedShape:s.value,properties:s.value.properties})})},ve=(H,Q)=>{console.log("[updateLayerProperties] Début",{layer:H,shapeType:Q,currentProperties:H.properties}),MR((le,pe)=>{const Z=k(le,pe);console.log("[updateLayerProperties] Nouvelles propriétés calculées",{newProperties:Z}),le.properties={...Z},fe(le),le.fire("properties:updated",{shape:le,properties:le.properties}),console.log("[updateLayerProperties] Fin",{finalProperties:le.properties,selectedShape:s.value})},100)(H,Q)},z=(H,Q)=>jt.latLng((H.lat+Q.lat)/2,(H.lng+Q.lng)/2),U=H=>{if(!e.value||!n.value)return;y();const Q=H.getLatLng(),ue=H.getRadius(),le=M(Q,"#059669");w.push(le),_(le,H,()=>[Yi(ue,"m","Rayon"),Yi(ue*2,"m","Diamètre"),Yi(Math.PI*Math.pow(ue,2),"m²","Surface")].join("<br>"));const pe=[],Z=[0,45,90,135,180,225,270,315];Z.forEach(N=>{const ke=H.calculatePointOnCircle(N),Me=M(ke,"#2563EB");pe.push(Me),w.push(Me),_(Me,H,()=>Yi(ue,"m","Rayon")),Me.on("mousedown",Ue=>{if(!e.value)return;jt.DomEvent.stopPropagation(Ue),e.value.dragging.disable();let ce=!0;const ne=de=>{ce&&(H.resizeFromControlPoint(de.latlng),pe.forEach((We,Ge)=>{const tt=H.calculatePointOnCircle(Z[Ge]);We.setLatLng(tt)}),le.setLatLng(H.getLatLng()),Me.measureDiv&&(Me.measureDiv.innerHTML=Yi(H.getRadius(),"m","Rayon")))},ye=()=>{ce=!1,e.value&&(e.value.off("mousemove",ne),document.removeEventListener("mouseup",ye),e.value.dragging.enable(),H.updateProperties(),s.value=null,Us(()=>{s.value=H}),ve(H,"Circle"))};e.value.on("mousemove",ne),document.addEventListener("mouseup",ye)})}),le.on("mousedown",N=>{if(!e.value)return;jt.DomEvent.stopPropagation(N),e.value.dragging.disable();let ke=!0;const Me=H.getLatLng(),Ue=N.latlng,ce=ye=>{if(!ke)return;const de=ye.latlng.lng-Ue.lng,We=ye.latlng.lat-Ue.lat,Ge=jt.latLng(Me.lat+We,Me.lng+de);jt.Circle.prototype.setLatLng.call(H,Ge),le.setLatLng(Ge),pe.forEach((tt,Ze)=>{const et=H.calculatePointOnCircle(Z[Ze]);tt.setLatLng(et)}),le.measureDiv&&(le.measureDiv.innerHTML=[Yi(H.getRadius(),"m","Rayon"),Yi(H.getRadius()*2,"m","Diamètre"),Yi(Math.PI*Math.pow(H.getRadius(),2),"m²","Surface")].join("<br>"))},ne=()=>{ke=!1,e.value&&(e.value.off("mousemove",ce),document.removeEventListener("mouseup",ne),e.value.dragging.enable(),H.updateProperties(),s.value=null,Us(()=>{s.value=H}),ve(H,"Circle"))};e.value.on("mousemove",ce),document.addEventListener("mouseup",ne)}),H.on("circle:resized",()=>{ve(H,"Circle")}),s.value=H},J=H=>{var ce;if(!e.value||!n.value)return;if(!(H instanceof pa)){console.warn("La couche n'est pas une instance de Rectangle");return}const Q=H;y();const ue=Q.getCenter(),le=Q.getRotatedCorners(),pe=Q.getMidPoints(),Z=M(ue,"#059669");w.push(Z),_(Z,Q,()=>{const{width:ne,height:ye}=Q.getDimensions(),de=ne*ye,We=Q.getRotation();return[Yi(ne,"m","Largeur"),Yi(ye,"m","Hauteur"),Yi(de,"m²","Surface"),`Rotation: ${We.toFixed(1)}°`].join("<br>")});const N=M(jt.latLng(ue.lat+(le[0].lat-ue.lat)*1.2,ue.lng+(le[0].lng-ue.lng)*1.2),"#F97316");w.push(N);const ke=jt.polyline([ue,N.getLatLng()],{color:"#F97316",weight:1,opacity:.6,dashArray:"4",pmIgnore:!0});(ce=t.value)==null||ce.addLayer(ke);const Me=le.map(ne=>{const ye=M(ne,"#DC2626");return w.push(ye),_(ye,Q,()=>{const{width:de,height:We}=Q.getDimensions();return[Yi(de,"m","Largeur"),Yi(We,"m","Hauteur")].join("<br>")}),ye}),Ue=pe.map((ne,ye)=>{const de=M(ne,"#2b6451");return w.push(de),_(de,Q,()=>{const{width:We,height:Ge}=Q.getDimensions(),tt=ye%2===0?We:Ge;return[Yi(tt,"m","Longueur du côté"),Yi(tt/2,"m","Distance au coin")].join("<br>")}),de});Z.on("mousedown",ne=>{if(!e.value)return;jt.DomEvent.stopPropagation(ne),e.value.dragging.disable();let ye=!0;const de=Ge=>{if(!ye)return;Q.moveFromCenter(Ge.latlng);const tt=Q.getRotatedCorners(),Ze=Q.getMidPoints();Me.forEach((He,wt)=>He.setLatLng(tt[wt])),Ue.forEach((He,wt)=>He.setLatLng(Ze[wt])),Z.setLatLng(Ge.latlng);const et=jt.latLng(Ge.latlng.lat+(tt[0].lat-Ge.latlng.lat)*1.2,Ge.latlng.lng+(tt[0].lng-Ge.latlng.lng)*1.2);N.setLatLng(et),ke.setLatLngs([Ge.latlng,et])},We=()=>{ye=!1,e.value&&(e.value.off("mousemove",de),document.removeEventListener("mouseup",We),e.value.dragging.enable(),Q.updateProperties(),s.value=null,Us(()=>{s.value=Q}))};e.value.on("mousemove",de),document.addEventListener("mouseup",We)}),N.on("mousedown",ne=>{if(!e.value)return;jt.DomEvent.stopPropagation(ne),e.value.dragging.disable();let ye=!1;const de=ne.latlng,We=Q.getRotation(),Ge=Q.getCenter(),tt=de.lng-Ge.lng,Ze=de.lat-Ge.lat,et=Math.atan2(Ze,tt)*180/Math.PI;w.forEach(Pt=>{Pt!==N&&(Pt.setStyle({opacity:0,fillOpacity:0}),Pt.measureDiv&&(Pt.measureDiv.style.display="none"))});const He=Hf(Pt=>{ye||(ye=!0);const kt=Pt.latlng.lng-Ge.lng,Jt=Pt.latlng.lat-Ge.lat;let un=Math.atan2(Jt,kt)*180/Math.PI-et,Ke=(We+un)%360;Ke<0&&(Ke+=360),Q.setRotation(Ke,!1),N.setLatLng(Pt.latlng),ke.setLatLngs([Ge,Pt.latlng])},16),wt=()=>{e.value&&(e.value.off("mousemove",He),document.removeEventListener("mouseup",wt),e.value.dragging.enable(),ye&&Q.finalizeRotation(),s.value=null,Us(()=>{s.value=Q,y(),J(Q)}))};e.value.on("mousemove",He),document.addEventListener("mouseup",wt)}),Q.on("coordinates:updated",ne=>{const{corners:ye,center:de}=ne,We=Q.getMidPoints();Me.forEach((tt,Ze)=>tt.setLatLng(ye[Ze])),Ue.forEach((tt,Ze)=>tt.setLatLng(We[Ze])),Z.setLatLng(de);const Ge=jt.latLng(de.lat+(ye[0].lat-de.lat)*1.2,de.lng+(ye[0].lng-de.lng)*1.2);N.setLatLng(Ge),ke.setLatLngs([de,Ge])})},T=H=>{if(!e.value||!n.value)return;y();const Q=H.getLatLngs();if(!Q||Q.length===0){console.warn("Pas de points pour la ligne");return}let ue=null;if(H instanceof Bs){const le=H.getCenter();ue=M(le,"#059669"),w.push(ue),_(ue,H,()=>{const pe=H.getLength()||0;return Yi(pe,"m","Longueur totale")}),ue.on("mousedown",pe=>{if(!e.value)return;jt.DomEvent.stopPropagation(pe),e.value.dragging.disable();let Z=!0;const N=H.getLatLngs().map(ne=>jt.latLng(ne.lat,ne.lng)),ke=pe.latlng;H instanceof Bs&&(H.off("move:end"),H.off("vertex:moved"),H.off("latlngs:updated"),H.off("properties:updated")),w.forEach((ne,ye)=>{ye>0&&(ne.setStyle({opacity:0,fillOpacity:0}),ne.measureDiv&&(ne.measureDiv.style.display="none"))});const Ue=Hf(ne=>{if(!Z)return;const ye=ne.latlng.lng-ke.lng,de=ne.latlng.lat-ke.lat,We=N.map(Ge=>jt.latLng(Ge.lat+de,Ge.lng+ye));jt.Polyline.prototype.setLatLngs.call(H,We),ue==null||ue.setLatLng(ne.latlng)},16),ce=()=>{if(Z=!1,!!e.value){if(e.value.off("mousemove",Ue),document.removeEventListener("mouseup",ce),e.value.dragging.enable(),H instanceof Bs){const ne=()=>{y(),T(H)};H.on("move:end",ne),H.on("vertex:moved",ne),H.on("latlngs:updated",ne),H.on("properties:updated",ne),H.updateProperties(),ve(H,"Line")}y(),T(H)}};e.value.on("mousemove",Ue),document.addEventListener("mouseup",ce)})}if(Q.forEach((le,pe)=>{const Z=M(le,"#DC2626");w.push(Z),_(Z,H,()=>{if(H instanceof Bs){const N=H.getLength()||0,ke=H.getLengthToVertex(pe);return[Yi(ke,"m","Distance depuis le début"),Yi(N,"m","Longueur totale")].join("<br>")}return""}),Z.on("mousedown",N=>{if(!e.value)return;jt.DomEvent.stopPropagation(N),e.value.dragging.disable();let ke=!0;H instanceof Bs&&(H.off("move:end"),H.off("vertex:moved"),H.off("latlngs:updated"),H.off("properties:updated")),w.forEach((ce,ne)=>{ne!==pe+1&&(ce.setStyle({opacity:0,fillOpacity:0}),ce.measureDiv&&(ce.measureDiv.style.display="none"))});const Me=Hf(ce=>{if(!ke)return;const ne=H.getLatLngs();ne[pe]=ce.latlng,jt.Polyline.prototype.setLatLngs.call(H,ne),Z.setLatLng(ce.latlng)},16),Ue=()=>{if(ke=!1,!!e.value){if(e.value.off("mousemove",Me),document.removeEventListener("mouseup",Ue),e.value.dragging.enable(),H instanceof Bs){const ce=()=>{y(),T(H)};H.on("move:end",ce),H.on("vertex:moved",ce),H.on("latlngs:updated",ce),H.on("properties:updated",ce),H.updateProperties(),ve(H,"Line")}y(),T(H)}};e.value.on("mousemove",Me),document.addEventListener("mouseup",Ue)})}),Q.length>=2)for(let le=0;le<Q.length-1;le++){const pe=Q[le],Z=Q[le+1],N=jt.latLng((pe.lat+Z.lat)/2,(pe.lng+Z.lng)/2),ke=M(N,"#2b6451");w.push(ke),_(ke,H,()=>{if(H instanceof Bs){const Me=H.getSegmentLengthAt(le),Ue=H.getLength()||0,ce=H.getLengthToVertex(le)+Me/2;return[Yi(Me,"m","Longueur du segment"),Yi(Me/2,"m","Demi-segment"),Yi(ce,"m","Distance depuis le début"),Yi(Ue,"m","Longueur totale")].join("<br>")}return""})}if(H instanceof Bs){const le=()=>{y(),T(H)};H.on("move:start",()=>{w.forEach((pe,Z)=>{Z>0&&(pe.setStyle({opacity:0,fillOpacity:0}),pe.measureDiv&&(pe.measureDiv.style.display="none"))})}),H.on("move:end",le),H.on("vertex:moved",le),H.on("latlngs:updated",le),H.on("properties:updated",le),w.cleanup=()=>{H.off("move:start",()=>{}),H.off("move:end",le),H.off("vertex:moved",le),H.off("latlngs:updated",le),H.off("properties:updated",le)}}},D=H=>{if(!e.value||!n.value)return;y();const Q=H.getLatLngs()[0],ue=Q.map(Ue=>[Ue.lng,Ue.lat]);ue.push(ue[0]);const le=hu([ue]),pe=oc(le),Z=Q.reduce((Ue,ce,ne)=>{const ye=Q[(ne+1)%Q.length];return Ue+ce.distanceTo(ye)},0);let N;if(typeof H.getCenter=="function")try{N=H.getCenter()}catch(Ue){console.warn("Erreur lors de la récupération du centre du polygone via getCenter(), utilisation de la méthode alternative",Ue);const ce=sp(le);N=jt.latLng(ce.geometry.coordinates[1],ce.geometry.coordinates[0])}else{const Ue=sp(le);N=jt.latLng(Ue.geometry.coordinates[1],Ue.geometry.coordinates[0])}const ke=M(N,"#059669");w.push(ke),_(ke,H,()=>[Yi(Z,"m","Périmètre"),Yi(pe,"m²","Surface")].join("<br>")),ke.on("mousedown",Ue=>{if(!e.value)return;jt.DomEvent.stopPropagation(Ue),e.value.dragging.disable();let ce=!0;const ne=Ue.latlng,ye=[...Q];w.forEach((tt,Ze)=>{Ze>0&&tt.setStyle({opacity:0,fillOpacity:0})});const de=Hf(tt=>{if(!ce)return;const Ze=tt.latlng.lng-ne.lng,et=tt.latlng.lat-ne.lat,He=ye.map(wt=>jt.latLng(wt.lat+et,wt.lng+Ze));jt.Polygon.prototype.setLatLngs.call(H,[He]),ke.setLatLng(tt.latlng)},16),We=tt=>{ce&&de(tt)},Ge=()=>{if(ce=!1,!!e.value){if(e.value.off("mousemove",We),document.removeEventListener("mouseup",Ge),e.value.dragging.enable(),H.properties){const tt=H.getLatLngs()[0],Ze=tt.map(He=>[He.lng,He.lat]);Ze.push(Ze[0]);const et=hu([Ze]);H.properties.area=oc(et),H.properties.perimeter=tt.reduce((He,wt,Pt)=>{const kt=tt[(Pt+1)%tt.length];return He+wt.distanceTo(kt)},0),H.properties.surface=H.properties.area}y(),D(H),s.value=null,Us(()=>{s.value=H})}};e.value.on("mousemove",We),document.addEventListener("mouseup",Ge)}),Q.forEach((Ue,ce)=>{const ne=M(Ue,"#DC2626");w.push(ne),_(ne,H,()=>{const ye=Q[(ce-1+Q.length)%Q.length],de=Q[(ce+1)%Q.length],We=Ue.distanceTo(ye),Ge=Ue.distanceTo(de);return[Yi(We,"m","Distance au point précédent"),Yi(Ge,"m","Distance au point suivant"),Yi(Z,"m","Périmètre total"),Yi(pe,"m²","Surface")].join("<br>")}),ne.on("mousedown",ye=>{if(jt.DomEvent.stopPropagation(ye),!e.value)return;e.value.dragging.disable();let de=!0;ke&&(ke.setStyle({opacity:0,fillOpacity:0}),ke.measureDiv&&(ke.measureDiv.style.display="none"));const We=Hf(Ze=>{if(!de)return;Q[ce]=Ze.latlng,jt.Polygon.prototype.setLatLngs.call(H,[Q]),ne.setLatLng(Ze.latlng);const et=w.slice(Q.length+1),He=(ce-1+Q.length)%Q.length,wt=et[He];if(wt){const kt=Q[He],Jt=Q[ce],rn=jt.latLng((kt.lat+Jt.lat)/2,(kt.lng+Jt.lng)/2);wt.setLatLng(rn)}const Pt=et[ce];if(Pt){const kt=Q[ce],Jt=Q[(ce+1)%Q.length],rn=jt.latLng((kt.lat+Jt.lat)/2,(kt.lng+Jt.lng)/2);Pt.setLatLng(rn)}},16),Ge=Ze=>{de&&We(Ze)},tt=()=>{if(de=!1,!!e.value){if(e.value.off("mousemove",Ge),document.removeEventListener("mouseup",tt),e.value.dragging.enable(),H.properties){const Ze=H.getLatLngs()[0].map(He=>[He.lng,He.lat]);Ze.push(Ze[0]);const et=hu([Ze]);H.properties.area=oc(et),H.properties.perimeter=Q.reduce((He,wt,Pt)=>{const kt=Q[(Pt+1)%Q.length];return He+wt.distanceTo(kt)},0),H.properties.surface=H.properties.area}y(),D(H),s.value=null,Us(()=>{s.value=H})}};e.value.on("mousemove",Ge),document.addEventListener("mouseup",tt)})}),(()=>{const Ue=H.getLatLngs()[0];w.slice(Ue.length+1).forEach(ne=>{t.value&&t.value.removeLayer(ne)}),w=w.slice(0,Ue.length+1);const ce=new Array(Ue.length);for(let ne=0;ne<Ue.length;ne++){const ye=Ue[ne],de=Ue[(ne+1)%Ue.length];ce[ne]=z(ye,de)}ce.forEach((ne,ye)=>{const de=M(ne,"#2b6451");w.push(de),_(de,H,()=>{const We=Ue[ye],Ge=Ue[(ye+1)%Ue.length],tt=We.distanceTo(Ge);return[Yi(tt,"m","Longueur du segment"),Yi(Z,"m","Périmètre total"),Yi(pe,"m²","Surface")].join("<br>")}),de.on("mousedown",We=>{if(!e.value)return;jt.DomEvent.stopPropagation(We),e.value.dragging.disable();let Ge=!0;const tt=ye;ke&&(ke.setStyle({opacity:0,fillOpacity:0}),ke.measureDiv&&(ke.measureDiv.style.display="none"));const Ze=[...H.getLatLngs()[0]];Ze.splice((tt+1)%Ze.length,0,ne),H.setLatLngs([Ze]),y(),D(H);const et=tt+1,He=1+et,wt=et<w.length-1?w[He]:null;if(wt){const Pt=Jt=>{if(!Ge)return;const rn=H.getLatLngs()[0];rn[et]=Jt.latlng,H.setLatLngs([rn]),wt.setLatLng(Jt.latlng);const un=w.slice(1+rn.length),Ke=(et-1+rn.length)%rn.length,ot=et;if(un[Ke]){const rt=rn[Ke],Ft=rn[et],Qt=jt.latLng((rt.lat+Ft.lat)/2,(rt.lng+Ft.lng)/2);un[Ke].setLatLng(Qt)}if(un[ot]){const rt=rn[et],Ft=rn[(et+1)%rn.length],Qt=jt.latLng((rt.lat+Ft.lat)/2,(rt.lng+Ft.lng)/2);un[ot].setLatLng(Qt)}},kt=()=>{if(Ge=!1,!!e.value){if(e.value.off("mousemove",Pt),document.removeEventListener("mouseup",kt),e.value.dragging.enable(),H.properties){const Jt=H.getLatLngs()[0].map(un=>[un.lng,un.lat]);Jt.push(Jt[0]);const rn=hu([Jt]);H.properties.area=oc(rn),H.properties.perimeter=H.getLatLngs()[0].reduce((un,Ke,ot,rt)=>{const Ft=rt[(ot+1)%rt.length];return un+Ke.distanceTo(Ft)},0)}y(),D(H),s.value=null,Us(()=>{s.value=H})}};e.value.on("mousemove",Pt),document.addEventListener("mouseup",kt)}else e.value.dragging.enable(),y(),D(H)})})})()},B=H=>{if(!e.value||!n.value)return;y();const Q=H.getLatLng(),ue=M(Q,"#059669");w.push(ue),_(ue,H,()=>`Position: ${Q.lat.toFixed(6)}, ${Q.lng.toFixed(6)}`),ue.on("mousedown",le=>{if(!e.value)return;jt.DomEvent.stopPropagation(le),e.value.dragging.disable(),H.startMoving();let pe=!0;const N=Hf(Me=>{pe&&(ue.setLatLng(Me.latlng),H.setLatLng(Me.latlng))},16),ke=()=>{e.value&&(e.value.off("mousemove",N),document.removeEventListener("mouseup",ke),e.value.dragging.enable(),pe=!1,H.finishMoving(),H.updateProperties(),s.value=null,Us(()=>{s.value=H,y(),B(H)}))};e.value.on("mousemove",N),document.addEventListener("mouseup",ke)}),s.value=H},$=H=>{if(!(!e.value||!r.value)){console.log("[generateTempControlPoints] Génération des points temporaires pour",{layerType:H.constructor.name,properties:H.properties}),r.value.clearLayers();try{if(H instanceof pa)H.generateHelperPoints(e.value);else if(H instanceof zh){if("getLatLng"in H&&typeof H.getLatLng=="function"){const Q=H.getLatLng();if(Q){const ue=jt.circleMarker(Q,{radius:5,color:"#059669",fillColor:"#059669",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});r.value.addLayer(ue)}}}else if(H instanceof zc){const Q=H.getLatLng();if(Q){const ue=jt.circleMarker(Q,{radius:5,color:"#059669",fillColor:"#059669",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});r.value.addLayer(ue)}}else if(H instanceof vf||H instanceof jt.Polygon){let Q=[];if("getLatLngs"in H){const le=H.getLatLngs();if(Array.isArray(le)&&le.length>0){const pe=le[0];Array.isArray(pe)?Q=pe:pe instanceof jt.LatLng&&(Q=le)}}let ue=null;if(H instanceof vf&&typeof H.getCenter=="function")ue=H.getCenter();else if(Q.length>0){const le=Q.map(N=>[N.lng,N.lat]);le.push(le[0]);const pe=hu([le]),Z=sp(pe);ue=jt.latLng(Z.geometry.coordinates[1],Z.geometry.coordinates[0])}if(ue){const le=jt.circleMarker(ue,{radius:5,color:"#059669",fillColor:"#059669",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});r.value.addLayer(le)}Q.forEach(le=>{if(le){const pe=jt.circleMarker(le,{radius:5,color:"#DC2626",fillColor:"#DC2626",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});r.value.addLayer(pe)}});for(let le=0;le<Q.length;le++){const pe=Q[le],Z=Q[(le+1)%Q.length];if(pe&&Z){const N=jt.latLng((pe.lat+Z.lat)/2,(pe.lng+Z.lng)/2),ke=jt.circleMarker(N,{radius:5,color:"#2563EB",fillColor:"#2563EB",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});r.value.addLayer(ke)}}}console.log("[generateTempControlPoints] Points temporaires générés",{count:r.value.getLayers().length})}catch(Q){console.error("[generateTempControlPoints] Erreur lors de la génération des points temporaires:",Q)}}},W=H=>{console.log("Nombre total de couches:",H.length);const Q=H.filter(N=>{var Ue;if(!N)return!1;let ke=0,Me={width:0,height:0};if(N instanceof jt.Circle){ke=Math.PI*Math.pow(N.getRadius(),2);const ce=N.getRadius();console.log(`
Forme détectée: Circle`),console.log(`- Surface propre: ${ke.toFixed(2)} m²`),console.log(`- Rayon: ${ce.toFixed(2)} m`),console.log("- Angle: Cercle complet (360°)")}else if(N instanceof pa||N instanceof jt.Rectangle){const ce=N.getBounds(),ne=ce.getSouthWest(),ye=ce.getNorthEast(),de=du([[ne.lng,ne.lat],[ye.lng,ne.lat]]),We=du([[ne.lng,ne.lat],[ne.lng,ye.lat]]);Me.width=Gf(de,{units:"meters"}),Me.height=Gf(We,{units:"meters"}),ke=Me.width*Me.height,console.log(`
Forme détectée: Rectangle`),console.log(`- Surface propre: ${ke.toFixed(2)} m²`),console.log(`- Largeur: ${Me.width.toFixed(2)} m`),console.log(`- Hauteur: ${Me.height.toFixed(2)} m`)}else if(((Ue=N.properties)==null?void 0:Ue.type)==="Semicircle"){const ce=N.getStartAngle(),ne=N.getStopAngle(),ye=(ne-ce+360)%360,de=N.getRadius();ke=Math.PI*Math.pow(de,2)*ye/360,console.log(`
Forme détectée: Semicircle`),console.log(`- Surface propre: ${ke.toFixed(2)} m²`),console.log(`- Rayon: ${de.toFixed(2)} m`),console.log(`- Angle de début: ${ce.toFixed(2)}°`),console.log(`- Angle de fin: ${ne.toFixed(2)}°`),console.log(`- Angle d'ouverture: ${ye.toFixed(2)}°`)}return ke>0});if(Q.length===0)return 0;const ue=new Set,le=[];for(const N of Q)if(!ue.has(N)){const ke=ie(Q,N);ke.length>0&&(le.push(ke),ke.forEach(Me=>ue.add(Me)))}console.log(`
Nombre de groupes de formes connectées: ${le.length}`);const pe=le.map((N,ke)=>{console.log(`
Calcul pour le groupe ${ke+1} (${N.length} formes):`);const Me=N.map(de=>{var We,Ge,tt;try{let Ze;if(de instanceof jt.Circle){const et=de.getLatLng(),He=de.getRadius();Ze=Y7([et.lng,et.lat],He/1e3,{units:"kilometers",steps:256});const wt=oc(Ze),Pt=((We=de.properties)==null?void 0:We.surface)||0;return console.log(`
Conversion Cercle -> GeoJSON`),console.log(`- Rayon: ${He.toFixed(2)}m`),console.log(`- Surface propriété: ${Pt.toFixed(2)}m²`),console.log(`- Surface GeoJSON: ${wt.toFixed(2)}m²`),Ze}else if(de instanceof pa||de instanceof jt.Rectangle){const et=de.getBounds(),He=et.getSouthWest(),wt=et.getNorthEast(),Pt=jt.latLng(wt.lat,He.lng),kt=jt.latLng(He.lat,wt.lng),Jt=[[He.lng,He.lat],[kt.lng,kt.lat],[wt.lng,wt.lat],[Pt.lng,Pt.lat],[He.lng,He.lat]];Ze=hu([Jt]);const rn=oc(Ze),un=du([[He.lng,He.lat],[wt.lng,He.lat]]),Ke=du([[He.lng,He.lat],[He.lng,wt.lat]]),ot=Gf(un,{units:"meters"}),rt=Gf(Ke,{units:"meters"}),Ft=ot*rt;return console.log(`
Conversion Rectangle -> GeoJSON`),console.log(`- Largeur: ${ot.toFixed(2)}m`),console.log(`- Hauteur: ${rt.toFixed(2)}m`),console.log(`- Surface théorique: ${Ft.toFixed(2)}m²`),console.log(`- Surface GeoJSON: ${rn.toFixed(2)}m²`),console.log(`- Différence: ${Math.abs(Ft-rn).toFixed(2)}m² (${(Math.abs(Ft-rn)/Ft*100).toFixed(2)}%)`),Ze}else if(((Ge=de.properties)==null?void 0:Ge.type)==="Semicircle"){const et=de.getCenter(),He=de.getRadius(),wt=de.getStartAngle(),Pt=de.getStopAngle(),kt=[],Jt=64;kt.push([et.lng,et.lat]);for(let Ke=0;Ke<=Jt;Ke++){const rt=(wt+(Pt-wt+360)%360*Ke/Jt)*Math.PI/180,Ft=He*Math.cos(rt),Bn=He*Math.sin(rt)/111319.9,Ln=Ft/(111319.9*Math.cos(et.lat*Math.PI/180));kt.push([et.lng+Ln,et.lat+Bn])}kt.push([et.lng,et.lat]),Ze=hu([kt]);const rn=oc(Ze),un=((tt=de.properties)==null?void 0:tt.surface)||0;return console.log(`
Conversion Semicircle -> GeoJSON`),console.log(`- Rayon: ${He.toFixed(2)}m`),console.log(`- Surface propriété: ${un.toFixed(2)}m²`),console.log(`- Surface GeoJSON: ${rn.toFixed(2)}m²`),console.log(`- Différence: ${Math.abs(un-rn).toFixed(2)}m² (${(Math.abs(un-rn)/un*100).toFixed(2)}%)`),Ze}return null}catch(Ze){return console.error("[useMapDrawing] Erreur lors de la conversion en GeoJSON:",Ze),null}}).filter(de=>de!==null);if(Me.length===0)return 0;const Ue=Me.map(de=>{const We=oc(de);return console.log(`Surface individuelle: ${We.toFixed(2)}m²`),We});let ce=0;for(let de=0;de<Me.length;de++)for(let We=de+1;We<Me.length;We++)try{const Ge=B7([Me[de],Me[We]]),tt=vI(Ge);if(tt){const Ze=oc(tt);ce+=Ze,console.log(`Intersection entre formes ${de+1} et ${We+1}: ${Ze.toFixed(2)}m²`)}}catch(Ge){console.error(`Erreur lors du calcul d'intersection entre les formes ${de+1} et ${We+1}:`,Ge)}const ne=Ue.reduce((de,We)=>de+We,0),ye=ne-ce;return console.log(`
Calcul de la surface d'irrigation pour le groupe ${ke+1}:`),console.log(`- Surface totale (somme): ${ne.toFixed(2)}m²`),console.log(`- Surface d'intersection: ${ce.toFixed(2)}m²`),console.log(`- Surface d'irrigation finale: ${ye.toFixed(2)}m²`),ye}),Z=Math.max(...pe);return console.log(`
Surface d'irrigation maximale parmi les groupes: ${Z.toFixed(2)}m²`),Z},G=()=>{u.value&&(e.value.removeLayer(u.value),u.value=null)},oe=(H,Q)=>{if(!e.value)return;G();const ue=Q?ie(H,Q):H;if(u.value||(u.value=jt.layerGroup().addTo(e.value)),ue.forEach(le=>{var Z;const pe=(Z=le.properties)==null?void 0:Z.type;if(pe==="Circle"||pe==="Semicircle"){const N=le.getLatLng(),ke=le.getRadius(),Me=jt.circle(N,{radius:ke,fillColor:"#3B82F6",fillOpacity:.1,stroke:!0,color:"#3B82F6",weight:1,opacity:.8,dashArray:"5, 5",interactive:!1,renderer:jt.canvas({padding:.5})}),Ue=jt.circle(N,{radius:ke,fillColor:"#3B82F6",fillOpacity:.05,stroke:!1,interactive:!1,renderer:jt.canvas({padding:.5})});u.value&&(u.value.addLayer(Ue),u.value.addLayer(Me))}else if(pe==="Rectangle"||pe==="Polygon"){const N=le.getLatLngs(),ke=jt.polygon(N,{fillColor:"#3B82F6",fillOpacity:.1,stroke:!0,color:"#3B82F6",weight:1,opacity:.8,dashArray:"5, 5",interactive:!1,renderer:jt.canvas({padding:.5})}),Me=jt.polygon(N,{fillColor:"#3B82F6",fillOpacity:.05,stroke:!1,interactive:!1,renderer:jt.canvas({padding:.5})});u.value&&(u.value.addLayer(Me),u.value.addLayer(ke))}}),Q&&ue.length>1&&e.value){const le=jt.latLngBounds([]);ue.forEach(N=>{N.getBounds?le.extend(N.getBounds()):N.getLatLng&&le.extend(N.getLatLng())});const pe=le.getCenter(),Z=jt.tooltip({permanent:!0,direction:"center",className:"connected-group-tooltip"}).setContent("<div>Groupe connecté</div>").setLatLng(pe);u.value&&u.value.addLayer(jt.marker(pe,{opacity:0,interactive:!1}).bindTooltip(Z).openTooltip())}},ie=(H,Q)=>{if(!Q)return[];const ue=new Set,le=[Q],pe=[Q];for(Q._leaflet_id!==void 0&&ue.add(Q._leaflet_id);le.length>0;){const Z=le.shift();for(const N of H){if(N===Z||ue.has(N._leaflet_id))continue;we(Z,N)&&(pe.push(N),le.push(N),ue.add(N._leaflet_id))}}return pe},we=(H,Q)=>{let ue=null,le=null;if(H.getBounds&&typeof H.getBounds=="function")ue=H.getBounds();else if(H.getLatLng&&H.getRadius){const pe=H.getLatLng(),Z=H.getRadius();ue=jt.latLngBounds([pe.lat-Z/111e3,pe.lng-Z/(111e3*Math.cos(pe.lat*Math.PI/180))],[pe.lat+Z/111e3,pe.lng+Z/(111e3*Math.cos(pe.lat*Math.PI/180))])}if(Q.getBounds&&typeof Q.getBounds=="function")le=Q.getBounds();else if(Q.getLatLng&&Q.getRadius){const pe=Q.getLatLng(),Z=Q.getRadius();le=jt.latLngBounds([pe.lat-Z/111e3,pe.lng-Z/(111e3*Math.cos(pe.lat*Math.PI/180))],[pe.lat+Z/111e3,pe.lng+Z/(111e3*Math.cos(pe.lat*Math.PI/180))])}return!(!ue||!le||!ue.intersects(le))},Ce=(H,Q)=>{var le;const ue=ie(H,Q);return ue.length===1&&(le=Q.properties)!=null&&le.surface?Q.properties.surface:W(ue)},Te=H=>{var le,pe,Z,N,ke,Me,Ue,ce,ne;const Q=H.layer;(le=n.value)==null||le.addLayer(Q);let ue="unknown";if(Q instanceof jt.Circle?ue=i.value==="Semicircle"?"Semicircle":"Circle":Q instanceof jt.Rectangle?ue="Rectangle":Q instanceof jt.Polygon?ue="Polygon":Q instanceof jt.Polyline&&!(Q instanceof jt.Polygon)&&(ue="Line"),Q.properties=k(Q,ue),Q.properties||(Q.properties={}),Q.properties.category||(Q.properties.category="forages"),Q.properties.accessLevel||(Q.properties.accessLevel="visitor"),Q._dbId=Date.now()+Math.floor(Math.random()*1e3),s.value=Q,console.log("[useMapDrawing] Input layer:",{type:ue,instanceof:{Circle:Q instanceof jt.Circle,Rectangle:Q instanceof jt.Rectangle,Polygon:Q instanceof jt.Polygon,Polyline:Q instanceof jt.Polyline},options:Q.options,properties:Q.properties,_dbId:Q._dbId}),window.dispatchEvent(new CustomEvent("shape:created",{detail:{shape:Q,type:ue,properties:Q.properties}})),Q.on("mouseover",()=>{console.log("[mouseover] Survol de la forme",{type:ue,isSelected:s.value===Q}),(!s.value||s.value!==Q)&&$(Q)}),Q.on("mouseout",()=>{var ye;console.log("[mouseout] Sortie de la forme",{type:ue,isSelected:s.value===Q}),(!s.value||s.value!==Q)&&((ye=r.value)==null||ye.clearLayers())}),ue==="Semicircle")console.log("Conversion en demi-cercle désactivée selon les exigences");else if(ue==="Circle"){(pe=n.value)==null||pe.removeLayer(Q);const ye=new zh(Q.getLatLng(),{radius:Q.getRadius(),...Q.options});ye.properties={...k(ye,"Circle"),type:"Circle"},Object.defineProperty(ye,"name",{value:ye.properties.name,writable:!0,enumerable:!0,configurable:!0}),console.log("[useMapDrawing] Création du cercle personnalisé:",{propertyDescriptor:Object.getOwnPropertyDescriptor(ye,"name"),directName:ye.name,propertiesName:ye.properties.name,nameIsEnumerable:Object.keys(ye).includes("name"),allProperties:Object.keys(ye.properties),allKeys:Object.keys(ye)}),(Z=n.value)==null||Z.addLayer(ye),s.value=ye,U(ye)}else if(ue==="Rectangle"){(N=n.value)==null||N.removeLayer(Q);const ye=new pa(Q.getBounds(),{...Q.options});ye.updateProperties(),(ke=n.value)==null||ke.addLayer(ye),s.value=ye,J(ye)}else if(Q instanceof jt.Polygon){const ye=Q.getLatLngs()[0],de=new vf([ye],{...Q.options});de.updateProperties(),(Me=n.value)==null||Me.removeLayer(Q),(Ue=n.value)==null||Ue.addLayer(de),s.value=de,D(de)}else if(Q instanceof Bs)T(Q);else if(Q instanceof jt.Polyline&&!(Q instanceof jt.Polygon)){const ye=Q.getLatLngs(),de=new Bs(ye,{...Q.options});de.updateProperties(),(ce=n.value)==null||ce.removeLayer(Q),(ne=n.value)==null||ne.addLayer(de),s.value=de,T(de)}ml("Cliquez sur la forme pour afficher les points de contrôle")},Y=()=>{e.value&&(e.value.off("pm:create"),e.value.on("pm:create",Te))};return{map:e,featureGroup:n,controlPointsGroup:t,tempControlPointsGroup:r,currentTool:i,selectedShape:s,isDrawing:o,initMap:I,setDrawingTool:K,updateShapeStyle:ee,updateShapeProperties:he,updateTextFixedSize:F,adjustView:R,clearActiveControlPoints:y,calculateTotalCoverageArea:W,showCoverageOverlay:oe,hideCoverageOverlay:G,calculateConnectedCoverageArea:Ce,getConnectedShapes:ie}}function kR(){const{isEnabled:e,startMeasure:n}=md(),t=zt(null),r=zt(""),i=zt("Hybride"),s=zt(null),o=n("createBaseMaps","useMapState"),u={Hybride:jt.layerGroup([jt.tileLayer("/osm_tiles/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:4,maxNativeZoom:19,tileSize:256,zoomOffset:0,bounds:jt.latLngBounds(jt.latLng(41.333,-5.566),jt.latLng(51.089,9.555)),crossOrigin:!0,detectRetina:!0,opacity:.6}),jt.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"© Esri",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:4,maxNativeZoom:20,tileSize:256,zoomOffset:0,bounds:jt.latLngBounds(jt.latLng(41.333,-5.566),jt.latLng(51.089,9.555)),crossOrigin:!0,detectRetina:!0,opacity:.6})]),Cadastre:jt.tileLayer("https://data.geopf.fr/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=CADASTRALPARCELS.PARCELLAIRE_EXPRESS&STYLE=normal&FORMAT=image/png&TILEMATRIXSET=PM&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}",{attribution:"Cadastre - Carte © IGN/Geoportail",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:4,maxNativeZoom:18,tileSize:256,zoomOffset:0,bounds:jt.latLngBounds(jt.latLng(41.333,-5.566),jt.latLng(51.089,9.555)),crossOrigin:!0,detectRetina:!0}),IGN:jt.tileLayer("https://data.geopf.fr/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2&STYLE=normal&FORMAT=image/png&TILEMATRIXSET=PM&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}",{attribution:"Carte IGN © IGN/Geoportail",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:4,maxNativeZoom:18,tileSize:256,zoomOffset:0,bounds:jt.latLngBounds(jt.latLng(41.333,-5.566),jt.latLng(51.089,9.555)),crossOrigin:!0,detectRetina:!0})};o();const f=hn.createPerformanceTracker(w=>{hn.measure("initMap:setOptions",()=>{t.value=w,w.options.zoomSnap=.25,w.options.zoomDelta=.25,w.options.wheelPxPerZoomLevel=100,w.options.zoomAnimation=!0,w.options.fadeAnimation=!0,w.options.markerZoomAnimation=!0,w.options.minZoom=2,w.options.maxZoom=19,w.options.scrollWheelZoom=!0,w.options.doubleClickZoom=!0;const y=jt.latLngBounds(jt.latLng(-90,-180),jt.latLng(90,180));w.setMaxBounds(y),w.options.maxBoundsViscosity=1,w.options.trackResize=!0;let M=null;w.getZoom(),w.on("zoomstart",()=>{w.getZoom(),w.options.zoomAnimation=!1,w.options.markerZoomAnimation=!1}),w.on("zoomend",()=>{M&&clearTimeout(M),M=setTimeout(()=>{setTimeout(()=>{w.options.zoomAnimation=!0,w.options.markerZoomAnimation=!0,w.invalidateSize({animate:!1,pan:!1});const F=w.getBounds(),I=w.options.maxBounds;I&&!F.intersects(I)&&w.panInsideBounds(I,{animate:!1})},250)},250)});const k=w._zoomAnimation;k&&(w._zoomAnimation=function(F){try{this._animatingZoom||k.call(this,F)}catch{console.warn("Animation de zoom interrompue, restauration de la vue..."),this._resetView(this.getCenter(),this.getZoom())}})},"useMapState"),hn.measure("initMap:addInitialLayer",()=>{w&&w.whenReady(()=>{const y=i.value;if(u[y]){if(console.log(`Initialisation de la couche de base: ${y}`),s.value&&w.hasLayer(s.value))try{w.removeLayer(s.value),console.log("Couche active précédente supprimée")}catch(M){console.warn("Erreur lors de la suppression de la couche active précédente:",M)}s.value=u[y];try{s.value.addTo(w),console.log(`Couche ${y} ajoutée à la carte`)}catch(M){console.error(`Erreur lors de l'ajout de la couche ${y}:`,M)}}else console.warn(`Couche de base non disponible: ${y}`)})},"useMapState"),w.on("baselayerchange",y=>{const M=n("baselayerchange","useMapState",{layer:y.name});i.value=y.name,s.value=y.layer,M()}),e.value&&(w.on("movestart",()=>{n("mapMove","useMapState",{startCenter:w.getCenter()})}),w.on("moveend",()=>{n("mapMoveEnd","useMapState",{endCenter:w.getCenter()})()}),w.on("tileloadstart",()=>{n("tileLoad","useMapState")}),w.on("tileload",()=>{n("tileLoadEnd","useMapState")()}))},"initMap","useMapState"),d=hn.createAsyncPerformanceTracker(async w=>{if(!t.value||!u[w]){console.warn(`Impossible de changer la carte de base: ${t.value?"type de carte non disponible":"carte non initialisée"}`);return}try{if(i.value===w)return;console.log(`Changement de carte: ${i.value} -> ${w}`);const y=t.value,M=y.getCenter(),k=y.getZoom();y.options.zoomAnimation=!1,y.options.fadeAnimation=!1,y.options.markerZoomAnimation=!1;const F=u[w];if(s.value&&y.hasLayer(s.value))try{y.removeLayer(s.value),console.log(`Couche précédente ${i.value} supprimée`)}catch(I){console.warn("Erreur lors de la suppression de la couche active:",I)}try{F instanceof jt.LayerGroup,F.addTo(y),console.log(`Nouvelle couche ${w} ajoutée`)}catch(I){console.error("Erreur lors de l'ajout de la nouvelle couche:",I);try{y.hasLayer(F)&&y.removeLayer(F),F.addTo(y),console.log(`Récupération: couche ${w} réajoutée`)}catch(R){throw console.error("Échec de la récupération:",R),new Error("Impossible d'ajouter la nouvelle couche")}}s.value=F,i.value=w;try{y.setView(M,k,{animate:!1,duration:0,noMoveStart:!0}),console.log(`Vue réinitialisée: centre=${M}, zoom=${k}`)}catch(I){console.warn("Erreur lors de la réinitialisation de la vue:",I)}try{y.invalidateSize({animate:!1,pan:!1})}catch(I){console.warn("Erreur lors du rafraîchissement de la carte:",I)}setTimeout(()=>{y.options.zoomAnimation=!0,y.options.fadeAnimation=!0,y.options.markerZoomAnimation=!0,console.log("Animations restaurées")},500)}catch(y){if(console.error("Erreur lors du changement de carte de base:",y),t.value)try{const M=t.value;M.eachLayer(F=>{(F instanceof jt.TileLayer||F instanceof jt.LayerGroup)&&M.removeLayer(F)});const k=u[w];k.addTo(M),s.value=k,i.value=w,M.options.zoomAnimation=!0,M.options.fadeAnimation=!0,M.options.markerZoomAnimation=!0,M.invalidateSize({animate:!1,pan:!1}),console.log("Récupération effectuée après erreur")}catch(M){console.error("Erreur lors de la récupération après échec:",M)}}},"changeBaseMap","useMapState"),m=hn.createAsyncPerformanceTracker(async()=>{if(!(!t.value||!r.value))try{const w=await hn.measureAsync("searchLocation:fetchData",async()=>await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(r.value)}`),"useMapState"),y=await hn.measureAsync("searchLocation:parseResponse",async()=>await w.json(),"useMapState");y&&y.length>0&&hn.measure("searchLocation:updateView",()=>{const{lat:M,lon:k}=y[0];t.value.setView([M,k],13,{animate:i.value!=="Cadastre"})},"useMapState")}catch(w){console.error("Erreur lors de la recherche de localisation:",w)}},"searchLocation","useMapState");return{map:t,searchQuery:r,currentBaseMap:i,baseMaps:u,initMap:f,searchLocation:m,changeBaseMap:d,cleanup:()=>{const w=n("cleanup","useMapState");t.value&&(t.value.remove(),t.value=null),s.value&&(s.value=null),w()},isPerformanceEnabled:e}}const py=Dp("irrigation",{state:()=>({plans:[],currentPlan:null,loading:!1,error:null,autoSaveInterval:null,unsavedChanges:!1,planHistory:[],performanceMonitor:md()}),getters:{getPlanById:e=>n=>e.plans.find(t=>t.id===n),hasUnsavedChanges:e=>e.unsavedChanges,getCurrentPlanHistory:e=>e.planHistory},actions:{async fetchPlans(){var t,r;const e=this.performanceMonitor.startMeasure("fetchPlans","IrrigationStore"),n=ma();this.loading=!0;try{let i="/plans/";const s={};n.isSalarie?s.salarie=(t=n.user)==null?void 0:t.id:n.isVisiteur&&(s.visiteur=(r=n.user)==null?void 0:r.id);const o=await this.performanceMonitor.measureAsync("fetchPlans_apiCall",()=>Gn.get(i,{params:s}),"IrrigationStore");this.plans=o.data}catch(i){throw this.error="Erreur lors du chargement des plans",i}finally{this.loading=!1,e()}},async fetchPlansWithDetails(){var t,r;const e=this.performanceMonitor.startMeasure("fetchPlansWithDetails","IrrigationStore"),n=ma();this.loading=!0;try{let i="/plans/";const s={include_details:!0};n.isSalarie?s.salarie=(t=n.user)==null?void 0:t.id:n.isVisiteur&&(s.visiteur=(r=n.user)==null?void 0:r.id);const o=await this.performanceMonitor.measureAsync("fetchPlansWithDetails_apiCall",()=>Gn.get(i,{params:s}),"IrrigationStore"),u=this.performanceMonitor.measure("fetchPlansWithDetails_processResponse",()=>o.data.map(f=>({...f,entreprise:typeof f.entreprise=="object"?f.entreprise:null,salarie:typeof f.salarie=="object"?f.salarie:null,visiteur:typeof f.visiteur=="object"?f.visiteur:null})),"IrrigationStore");return this.plans=u,{data:u}}catch(i){throw console.error("[IrrigationStore] Error fetching plans:",i),this.error="Erreur lors du chargement des plans",i}finally{this.loading=!1,e()}},async fetchClientPlans(e){this.loading=!0;try{return(await mg.getVisiteurPlans(e)).data}catch(n){throw this.error="Erreur lors du chargement des plans du client",n}finally{this.loading=!1}},async createPlan(e){var r;const n=this.performanceMonitor.startMeasure("createPlan","IrrigationStore");this.clearCurrentPlan(),this.loading=!0;const t=vu();try{const i=ma();((r=i.user)==null?void 0:r.user_type)==="visiteur"&&(e={...e,visiteur:i.user.id,salarie_id:i.user.enterprise_id,entreprise_id:i.user.enterprise_id});const s=this.performanceMonitor.measure("createPlan_formatData",()=>({...e,entreprise:e.entreprise?typeof e.entreprise=="object"&&e.entreprise&&"id"in e.entreprise?e.entreprise.id:Number(e.entreprise):null,salarie:e.salarie?typeof e.salarie=="object"&&e.salarie&&"id"in e.salarie?e.salarie.id:Number(e.salarie):null,visiteur:e.visiteur?typeof e.visiteur=="object"&&e.visiteur&&"id"in e.visiteur?e.visiteur.id:Number(e.visiteur):null}),"IrrigationStore"),o=await this.performanceMonitor.measureAsync("createPlan_apiCall",()=>mg.createPlan(s),"IrrigationStore");return this.plans.push(o.data),t.success(`Le plan "${o.data.nom}" a été créé avec succès`),o.data}catch(i){const s=i instanceof Error?i.message:String(i);throw console.error("Error creating plan:",s),this.error=s,t.error(`Erreur lors de la création du plan : ${s}`),i}finally{this.loading=!1,n()}},async createPlanForClient(e,n){this.clearCurrentPlan(),this.loading=!0;try{const t={...e,visiteur:n},r=await mg.createPlanForVisiteur(t);return this.plans.push(r.data),r.data}catch(t){const r=t instanceof Error?t.message:String(t);throw console.error("Error creating plan for client:",r),this.error="Erreur lors de la création du plan pour le client",t}finally{this.loading=!1}},startAutoSave(){this.autoSaveInterval||(this.autoSaveInterval=setInterval(async()=>{this.unsavedChanges&&this.currentPlan&&await this.savePlan(this.currentPlan.id)},3e4))},stopAutoSave(){this.autoSaveInterval&&(clearInterval(this.autoSaveInterval),this.autoSaveInterval=null)},async savePlan(e){const n=this.performanceMonitor.startMeasure("savePlan","IrrigationStore");if(!this.unsavedChanges){console.log("[IrrigationStore][savePlan] Aucun changement à sauvegarder"),n();return}this.loading=!0;try{const t=await this.performanceMonitor.measureAsync("savePlan_apiCall",()=>{var r;return Gn.patch(`/plans/${e}/`,{...this.currentPlan,version:((r=this.currentPlan)==null?void 0:r.version)||1})},"IrrigationStore");return this.performanceMonitor.measure("savePlan_updateState",()=>{var i;const r=this.plans.findIndex(s=>s.id===e);r!==-1&&(this.plans[r]=t.data),((i=this.currentPlan)==null?void 0:i.id)===e&&(this.currentPlan=t.data)},"IrrigationStore"),this.unsavedChanges=!1,t.data}catch(t){throw console.error("[IrrigationStore][savePlan] ERREUR:",t),this.error="Erreur lors de la sauvegarde du plan",t}finally{this.loading=!1,n()}},async updatePlanDetails(e,n){const t=this.performanceMonitor.startMeasure("updatePlanDetails","IrrigationStore"),r=vu();try{const i=await this.performanceMonitor.measureAsync("updatePlanDetails_apiCall",()=>{const{visiteur_id:s,salarie_id:o,entreprise_id:u,...f}=n,d={...f};return s!==void 0&&(d.visiteur_id=s),o!==void 0&&(d.salarie_id=o),u!==void 0&&(d.entreprise_id=u),Gn.patch(`/plans/${e}/`,d)},"IrrigationStore");return this.performanceMonitor.measure("updatePlanDetails_updateState",()=>{this.currentPlan&&this.currentPlan.id===e&&(this.currentPlan={...this.currentPlan,...i.data});const s=this.plans.findIndex(o=>o.id===e);s!==-1&&(this.plans[s]={...this.plans[s],...i.data})},"IrrigationStore"),i.data}catch(i){throw console.error("Erreur lors de la mise à jour du plan:",i),r.error(`Erreur lors de la mise à jour du plan : ${i instanceof Error?i.message:String(i)}`),i}finally{t()}},async fetchPlanHistory(e){this.loading=!0;try{const n=await Gn.get(`/plans/${e}/historique/`);return this.planHistory=n.data,n.data}catch(n){throw this.error="Erreur lors de la récupération de l'historique",n}finally{this.loading=!1}},async restorePlanVersion(e,n){var t;this.loading=!0;try{const r=await Gn.post(`/plans/${e}/restaurer/`,{version_id:n});((t=this.currentPlan)==null?void 0:t.id)===e&&(this.currentPlan=r.data);const i=this.plans.findIndex(s=>s.id===e);return i!==-1&&(this.plans[i]=r.data),r.data}catch(r){throw this.error="Erreur lors de la restauration de la version",r}finally{this.loading=!1}},setCurrentPlan(e){this.currentPlan=e,this.startAutoSave()},clearCurrentPlan(){this.currentPlan=null,this.unsavedChanges=!1,this.autoSaveInterval&&(clearInterval(this.autoSaveInterval),this.autoSaveInterval=null)},markUnsavedChanges(){this.unsavedChanges=!0},async deletePlan(e){var t;this.loading=!0;const n=vu();try{const r=this.plans.find(i=>i.id===e);await mg.deletePlan(e),this.plans=this.plans.filter(i=>i.id!==e),((t=this.currentPlan)==null?void 0:t.id)===e&&this.clearCurrentPlan(),n.success(`Le plan "${(r==null?void 0:r.nom)||""}" a été supprimé avec succès`)}catch(r){throw this.error="Erreur lors de la suppression du plan",n.error(`Erreur lors de la suppression du plan : ${r instanceof Error?r.message:String(r)}`),r}finally{this.loading=!1}}}}),TR={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[3001] overflow-y-auto"},NR={class:"bg-white w-full h-full md:rounded-lg md:max-w-4xl md:h-auto md:max-h-[90vh] md:my-8 relative overflow-y-auto"},DR={class:"p-4 md:p-6 pt-0 overflow-y-auto max-h-[calc(100vh-80px)] md:max-h-[calc(90vh-80px)]"},IR={key:0,class:"mb-4"},OR={key:0,class:"animate-pulse"},BR=["value"],RR={key:1,class:"mb-4"},FR={key:0,class:"animate-pulse"},jR=["disabled"],zR={value:null},$R=["value"],UR={key:2,class:"mb-4"},VR={key:0,class:"animate-pulse"},GR=["disabled"],HR={value:null},qR=["value"],WR={class:"mb-4"},ZR={class:"mb-6"},KR={class:"flex justify-end space-x-3"},YR=["disabled"],JR={key:0},XR={key:1},dx=ds({__name:"NewPlanModal",props:{modelValue:{type:Boolean}},emits:["update:modelValue","created","salarieSelected","visiteurSelected"],setup(e,{expose:n,emit:t}){function r(B){return B?typeof B=="object"?B.id:B:null}function i(B){if(B===null)throw new Error("Invalid ID");return B}const s=e,o=t,u=ma(),f=py(),d=cd(),m=zt(!1),_=zt(null),w=zt([]),y=zt([]),M=zt([]),k=zt(null),F=zt(null),I=zt(!1),R=zt(!1),K=zt(!1),ee=zt({nom:"",description:"",entreprise:null,salarie:null,visiteur:null}),he=sr(()=>{var B,$,W;return((B=u.user)==null?void 0:B.user_type)==="admin"?ee.value.nom.trim()&&ee.value.entreprise&&ee.value.salarie:(($=u.user)==null?void 0:$.user_type)==="entreprise"?ee.value.nom.trim()&&ee.value.salarie:(((W=u.user)==null?void 0:W.user_type)==="salarie",ee.value.nom.trim())});oo(()=>ee.value.entreprise,async B=>{if(!s.modelValue)return;ee.value.salarie=null,ee.value.visiteur=null,y.value=[];const $=r(B);console.log("[NewPlanModal] Entreprise sélectionnée:",$),$?await fe($):w.value=[]}),oo(()=>ee.value.salarie,async B=>{if(!s.modelValue)return;ee.value.visiteur=null;const $=r(B);$?await ve($):y.value=[]}),oo(()=>s.modelValue,B=>{var $,W,G;B?(($=u.user)==null?void 0:$.user_type)==="admin"?T():((W=u.user)==null?void 0:W.user_type)==="entreprise"?fe(u.user.id):((G=u.user)==null?void 0:G.user_type)==="salarie"&&ve(u.user.id):(ee.value={nom:"",description:"",entreprise:null,salarie:null,visiteur:null},k.value=null,F.value=null,y.value=[],w.value=[],M.value=[],_.value=null)});async function fe(B){I.value=!0;try{console.log("[NewPlanModal] Chargement des salaries pour entreprise:",B);const $=await xl.getUsers({role:"SALARIE",entreprise:B});console.log("[NewPlanModal] Réponse salaries:",$.data),w.value=$.data}catch($){console.error("[NewPlanModal] Error loading salaries:",$),w.value=[]}finally{I.value=!1}}async function ve(B){R.value=!0;try{const $=await xl.getUsers({role:"VISITEUR",salarie:B});y.value=$.data}catch($){console.error("[NewPlanModal] Error loading visiteurs:",$),y.value=[]}finally{R.value=!1}}async function z(B){s.modelValue&&(k.value=B,ee.value.salarie=B.id,await ve(B.id),o("salarieSelected",B))}function U(B){s.modelValue&&(F.value=B,ee.value.visiteur=B.id,o("visiteurSelected",B))}function J(){o("update:modelValue",!1),ee.value={nom:"",description:"",entreprise:null,salarie:null,visiteur:null},k.value=null,F.value=null,y.value=[],_.value=null}async function T(){K.value=!0;try{const B=await u.fetchEnterprises();M.value=B}catch(B){console.error("[NewPlanModal] Error loading entreprises:",B),M.value=[]}finally{K.value=!1}}async function D(){var B,$;_.value=null,m.value=!0;try{const W={nom:ee.value.nom.trim(),description:ee.value.description.trim()},G=u.user;if(!G)throw new Error("User not found");if(G.user_type==="admin"){if(!ee.value.entreprise||!ee.value.salarie)throw new Error("Missing required fields");W.entreprise=i(r(ee.value.entreprise)),W.salarie=i(r(ee.value.salarie)),ee.value.visiteur&&(W.visiteur=ee.value.visiteur)}else if(G.user_type==="entreprise"){if(!ee.value.salarie)throw new Error("Missing required fields");W.entreprise=G.id,W.salarie=i(r(ee.value.salarie)),ee.value.visiteur&&(W.visiteur=ee.value.visiteur)}else if(G.user_type==="salarie"){if(!G.entreprise)throw new Error("Missing required fields");W.entreprise=G.entreprise.id,W.salarie=G.id,ee.value.visiteur&&(W.visiteur=ee.value.visiteur)}else if(G.user_type==="visiteur"){if(!G.entreprise||!G.salarie)throw new Error("Missing required fields");W.entreprise=G.entreprise.id,W.salarie=G.salarie.id,W.visiteur=G.id}console.log("Données du plan à créer:",W),f.clearCurrentPlan(),d.setCurrentPlan(null);const oe=await f.createPlan(W);o("created",oe.id),J()}catch(W){console.error("[NewPlanModal] Error creating plan:",W),console.error("Response data:",(B=W.response)==null?void 0:B.data);let G="Une erreur est survenue lors de la création du plan";($=W.response)!=null&&$.data&&(typeof W.response.data=="object"?G=Object.entries(W.response.data).map(([oe,ie])=>Array.isArray(ie)?`${oe}: ${ie.join(", ")}`:`${oe}: ${ie}`).join(`
`):typeof W.response.data=="string"&&(G=W.response.data)),_.value=G}finally{m.value=!1}}return n({salaries:w,visiteurs:y,selectedSalarie:k,selectedVisiteur:F,loadSalaries:fe,loadVisiteurs:ve,selectSalarie:z,selectVisiteur:U}),(B,$)=>{var W,G,oe,ie;return B.modelValue?($e(),qe("div",TR,[C("div",NR,[C("div",{class:"flex justify-between items-center mb-4 sticky top-0 bg-white p-4 md:p-6 pb-4 border-b z-10"},[$[6]||($[6]=C("h2",{class:"text-xl font-semibold text-gray-900"},"Créer un nouveau plan",-1)),C("button",{onClick:J,class:"text-gray-400 hover:text-gray-500"},$[5]||($[5]=[C("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),C("div",DR,[Kn(u).isAdmin?($e(),qe("div",IR,[$[9]||($[9]=C("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Entreprise",-1)),K.value?($e(),qe("div",OR,$[7]||($[7]=[C("div",{class:"h-10 bg-gray-200 rounded"},null,-1)]))):Fn(($e(),qe("select",{key:1,"onUpdate:modelValue":$[0]||($[0]=we=>ee.value.entreprise=we),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"},[$[8]||($[8]=C("option",{value:null},"Sélectionnez une entreprise",-1)),($e(!0),qe(Tn,null,Lr(M.value,we=>($e(),qe("option",{key:we.id,value:we.id},Zt(Kn(Gl)(we)),9,BR))),128))],512)),[[vo,ee.value.entreprise]])])):pn("",!0),((W=Kn(u).user)==null?void 0:W.user_type)==="admin"||((G=Kn(u).user)==null?void 0:G.user_type)==="entreprise"?($e(),qe("div",RR,[$[11]||($[11]=C("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Salarie",-1)),I.value?($e(),qe("div",FR,$[10]||($[10]=[C("div",{class:"h-10 bg-gray-200 rounded"},null,-1)]))):Fn(($e(),qe("select",{key:1,id:"edit-salarie","onUpdate:modelValue":$[1]||($[1]=we=>ee.value.salarie=we),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:Kn(u).isAdmin&&!ee.value.entreprise},[C("option",zR,Zt(w.value.length?"Sélectionnez un salarie":"Aucun salarie disponible"),1),($e(!0),qe(Tn,null,Lr(w.value,we=>($e(),qe("option",{key:we.id,value:we.id},Zt(Kn(Gl)(we)),9,$R))),128))],8,jR)),[[vo,ee.value.salarie]])])):pn("",!0),((oe=Kn(u).user)==null?void 0:oe.user_type)!=="visiteur"?($e(),qe("div",UR,[$[13]||($[13]=C("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Visiteur",-1)),R.value?($e(),qe("div",VR,$[12]||($[12]=[C("div",{class:"h-10 bg-gray-200 rounded"},null,-1)]))):Fn(($e(),qe("select",{key:1,id:"edit-visiteur","onUpdate:modelValue":$[2]||($[2]=we=>ee.value.visiteur=we),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:!y.value.length||((ie=Kn(u).user)==null?void 0:ie.user_type)!=="salarie"&&!ee.value.salarie},[C("option",HR,Zt(y.value.length?"Sélectionnez un visiteur":"Aucun visiteur disponible"),1),($e(!0),qe(Tn,null,Lr(y.value,we=>($e(),qe("option",{key:we.id,value:we.id},Zt(Kn(Gl)(we)),9,qR))),128))],8,GR)),[[vo,ee.value.visiteur]])])):pn("",!0),C("div",WR,[$[14]||($[14]=C("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nom du plan",-1)),Fn(C("input",{id:"edit-nom","onUpdate:modelValue":$[3]||($[3]=we=>ee.value.nom=we),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Entrez le nom du plan"},null,512),[[ni,ee.value.nom]])]),C("div",ZR,[$[15]||($[15]=C("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description",-1)),Fn(C("textarea",{id:"edit-description","onUpdate:modelValue":$[4]||($[4]=we=>ee.value.description=we),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",rows:"3",placeholder:"Entrez une description (optionnel)"},null,512),[[ni,ee.value.description]])]),C("div",KR,[C("button",{onClick:J,class:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500"}," Annuler "),C("button",{onClick:D,class:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:!he.value||m.value},[m.value?($e(),qe("span",JR,"Création en cours...")):($e(),qe("span",XR,"Créer"))],8,YR)])])])])):pn("",!0)}}});function so(e){"@babel/helpers - typeof";return so=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},so(e)}var Ra=Uint8Array,Hl=Uint16Array,gy=Int32Array,r0=new Ra([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),i0=new Ra([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),m1=new Ra([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),px=function(e,n){for(var t=new Hl(31),r=0;r<31;++r)t[r]=n+=1<<e[r-1];for(var i=new gy(t[30]),r=1;r<30;++r)for(var s=t[r];s<t[r+1];++s)i[s]=s-t[r]<<5|r;return{b:t,r:i}},gx=px(r0,2),mx=gx.b,v1=gx.r;mx[28]=258,v1[258]=28;var vx=px(i0,0),QR=vx.b,xb=vx.r,y1=new Hl(32768);for(var Mo=0;Mo<32768;++Mo){var of=(Mo&43690)>>1|(Mo&21845)<<1;of=(of&52428)>>2|(of&13107)<<2,of=(of&61680)>>4|(of&3855)<<4,y1[Mo]=((of&65280)>>8|(of&255)<<8)>>1}var pc=function(e,n,t){for(var r=e.length,i=0,s=new Hl(n);i<r;++i)e[i]&&++s[e[i]-1];var o=new Hl(n);for(i=1;i<n;++i)o[i]=o[i-1]+s[i-1]<<1;var u;if(t){u=new Hl(1<<n);var f=15-n;for(i=0;i<r;++i)if(e[i])for(var d=i<<4|e[i],m=n-e[i],_=o[e[i]-1]++<<m,w=_|(1<<m)-1;_<=w;++_)u[y1[_]>>f]=d}else for(u=new Hl(r),i=0;i<r;++i)e[i]&&(u[i]=y1[o[e[i]-1]++]>>15-e[i]);return u},Pf=new Ra(288);for(var Mo=0;Mo<144;++Mo)Pf[Mo]=8;for(var Mo=144;Mo<256;++Mo)Pf[Mo]=9;for(var Mo=256;Mo<280;++Mo)Pf[Mo]=7;for(var Mo=280;Mo<288;++Mo)Pf[Mo]=8;var Pp=new Ra(32);for(var Mo=0;Mo<32;++Mo)Pp[Mo]=5;var eF=pc(Pf,9,0),tF=pc(Pf,9,1),nF=pc(Pp,5,0),rF=pc(Pp,5,1),sv=function(e){for(var n=e[0],t=1;t<e.length;++t)e[t]>n&&(n=e[t]);return n},Du=function(e,n,t){var r=n/8|0;return(e[r]|e[r+1]<<8)>>(n&7)&t},av=function(e,n){var t=n/8|0;return(e[t]|e[t+1]<<8|e[t+2]<<16)>>(n&7)},my=function(e){return(e+7)/8|0},yx=function(e,n,t){return(t==null||t>e.length)&&(t=e.length),new Ra(e.subarray(n,t))},iF=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Fu=function(e,n,t){var r=new Error(n||iF[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,Fu),!t)throw r;return r},oF=function(e,n,t,r){var i=e.length,s=0;if(!i||n.f&&!n.l)return t||new Ra(0);var o=!t,u=o||n.i!=2,f=n.i;o&&(t=new Ra(i*3));var d=function(Me){var Ue=t.length;if(Me>Ue){var ce=new Ra(Math.max(Ue*2,Me));ce.set(t),t=ce}},m=n.f||0,_=n.p||0,w=n.b||0,y=n.l,M=n.d,k=n.m,F=n.n,I=i*8;do{if(!y){m=Du(e,_,1);var R=Du(e,_+1,3);if(_+=3,R)if(R==1)y=tF,M=rF,k=9,F=5;else if(R==2){var fe=Du(e,_,31)+257,ve=Du(e,_+10,15)+4,z=fe+Du(e,_+5,31)+1;_+=14;for(var U=new Ra(z),J=new Ra(19),T=0;T<ve;++T)J[m1[T]]=Du(e,_+T*3,7);_+=ve*3;for(var D=sv(J),B=(1<<D)-1,$=pc(J,D,1),T=0;T<z;){var W=$[Du(e,_,B)];_+=W&15;var K=W>>4;if(K<16)U[T++]=K;else{var G=0,oe=0;for(K==16?(oe=3+Du(e,_,3),_+=2,G=U[T-1]):K==17?(oe=3+Du(e,_,7),_+=3):K==18&&(oe=11+Du(e,_,127),_+=7);oe--;)U[T++]=G}}var ie=U.subarray(0,fe),we=U.subarray(fe);k=sv(ie),F=sv(we),y=pc(ie,k,1),M=pc(we,F,1)}else Fu(1);else{var K=my(_)+4,ee=e[K-4]|e[K-3]<<8,he=K+ee;if(he>i){f&&Fu(0);break}u&&d(w+ee),t.set(e.subarray(K,he),w),n.b=w+=ee,n.p=_=he*8,n.f=m;continue}if(_>I){f&&Fu(0);break}}u&&d(w+131072);for(var Ce=(1<<k)-1,Te=(1<<F)-1,Y=_;;Y=_){var G=y[av(e,_)&Ce],H=G>>4;if(_+=G&15,_>I){f&&Fu(0);break}if(G||Fu(2),H<256)t[w++]=H;else if(H==256){Y=_,y=null;break}else{var Q=H-254;if(H>264){var T=H-257,ue=r0[T];Q=Du(e,_,(1<<ue)-1)+mx[T],_+=ue}var le=M[av(e,_)&Te],pe=le>>4;le||Fu(3),_+=le&15;var we=QR[pe];if(pe>3){var ue=i0[pe];we+=av(e,_)&(1<<ue)-1,_+=ue}if(_>I){f&&Fu(0);break}u&&d(w+131072);var Z=w+Q;if(w<we){var N=s-we,ke=Math.min(we,Z);for(N+w<0&&Fu(3);w<ke;++w)t[w]=r[N+w]}for(;w<Z;++w)t[w]=t[w-we]}}n.l=y,n.p=Y,n.b=w,n.f=m,y&&(m=1,n.m=k,n.d=M,n.n=F)}while(!m);return w!=t.length&&o?yx(t,0,w):t.subarray(0,w)},Oc=function(e,n,t){t<<=n&7;var r=n/8|0;e[r]|=t,e[r+1]|=t>>8},Id=function(e,n,t){t<<=n&7;var r=n/8|0;e[r]|=t,e[r+1]|=t>>8,e[r+2]|=t>>16},lv=function(e,n){for(var t=[],r=0;r<e.length;++r)e[r]&&t.push({s:r,f:e[r]});var i=t.length,s=t.slice();if(!i)return{t:bx,l:0};if(i==1){var o=new Ra(t[0].s+1);return o[t[0].s]=1,{t:o,l:1}}t.sort(function(he,fe){return he.f-fe.f}),t.push({s:-1,f:25001});var u=t[0],f=t[1],d=0,m=1,_=2;for(t[0]={s:-1,f:u.f+f.f,l:u,r:f};m!=i-1;)u=t[t[d].f<t[_].f?d++:_++],f=t[d!=m&&t[d].f<t[_].f?d++:_++],t[m++]={s:-1,f:u.f+f.f,l:u,r:f};for(var w=s[0].s,r=1;r<i;++r)s[r].s>w&&(w=s[r].s);var y=new Hl(w+1),M=_1(t[m-1],y,0);if(M>n){var r=0,k=0,F=M-n,I=1<<F;for(s.sort(function(fe,ve){return y[ve.s]-y[fe.s]||fe.f-ve.f});r<i;++r){var R=s[r].s;if(y[R]>n)k+=I-(1<<M-y[R]),y[R]=n;else break}for(k>>=F;k>0;){var K=s[r].s;y[K]<n?k-=1<<n-y[K]++-1:++r}for(;r>=0&&k;--r){var ee=s[r].s;y[ee]==n&&(--y[ee],++k)}M=n}return{t:new Ra(y),l:M}},_1=function(e,n,t){return e.s==-1?Math.max(_1(e.l,n,t+1),_1(e.r,n,t+1)):n[e.s]=t},Lb=function(e){for(var n=e.length;n&&!e[--n];);for(var t=new Hl(++n),r=0,i=e[0],s=1,o=function(f){t[r++]=f},u=1;u<=n;++u)if(e[u]==i&&u!=n)++s;else{if(!i&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(i),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(i);s=1,i=e[u]}return{c:t.subarray(0,r),n}},Od=function(e,n){for(var t=0,r=0;r<n.length;++r)t+=e[r]*n[r];return t},_x=function(e,n,t){var r=t.length,i=my(n+2);e[i]=r&255,e[i+1]=r>>8,e[i+2]=e[i]^255,e[i+3]=e[i+1]^255;for(var s=0;s<r;++s)e[i+s+4]=t[s];return(i+4+r)*8},Sb=function(e,n,t,r,i,s,o,u,f,d,m){Oc(n,m++,t),++i[256];for(var _=lv(i,15),w=_.t,y=_.l,M=lv(s,15),k=M.t,F=M.l,I=Lb(w),R=I.c,K=I.n,ee=Lb(k),he=ee.c,fe=ee.n,ve=new Hl(19),z=0;z<R.length;++z)++ve[R[z]&31];for(var z=0;z<he.length;++z)++ve[he[z]&31];for(var U=lv(ve,7),J=U.t,T=U.l,D=19;D>4&&!J[m1[D-1]];--D);var B=d+5<<3,$=Od(i,Pf)+Od(s,Pp)+o,W=Od(i,w)+Od(s,k)+o+14+3*D+Od(ve,J)+2*ve[16]+3*ve[17]+7*ve[18];if(f>=0&&B<=$&&B<=W)return _x(n,m,e.subarray(f,f+d));var G,oe,ie,we;if(Oc(n,m,1+(W<$)),m+=2,W<$){G=pc(w,y,0),oe=w,ie=pc(k,F,0),we=k;var Ce=pc(J,T,0);Oc(n,m,K-257),Oc(n,m+5,fe-1),Oc(n,m+10,D-4),m+=14;for(var z=0;z<D;++z)Oc(n,m+3*z,J[m1[z]]);m+=3*D;for(var Te=[R,he],Y=0;Y<2;++Y)for(var H=Te[Y],z=0;z<H.length;++z){var Q=H[z]&31;Oc(n,m,Ce[Q]),m+=J[Q],Q>15&&(Oc(n,m,H[z]>>5&127),m+=H[z]>>12)}}else G=eF,oe=Pf,ie=nF,we=Pp;for(var z=0;z<u;++z){var ue=r[z];if(ue>255){var Q=ue>>18&31;Id(n,m,G[Q+257]),m+=oe[Q+257],Q>7&&(Oc(n,m,ue>>23&31),m+=r0[Q]);var le=ue&31;Id(n,m,ie[le]),m+=we[le],le>3&&(Id(n,m,ue>>5&8191),m+=i0[le])}else Id(n,m,G[ue]),m+=oe[ue]}return Id(n,m,G[256]),m+oe[256]},sF=new gy([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),bx=new Ra(0),aF=function(e,n,t,r,i,s){var o=s.z||e.length,u=new Ra(r+o+5*(1+Math.ceil(o/7e3))+i),f=u.subarray(r,u.length-i),d=s.l,m=(s.r||0)&7;if(n){m&&(f[0]=s.r>>3);for(var _=sF[n-1],w=_>>13,y=_&8191,M=(1<<t)-1,k=s.p||new Hl(32768),F=s.h||new Hl(M+1),I=Math.ceil(t/3),R=2*I,K=function(ne){return(e[ne]^e[ne+1]<<I^e[ne+2]<<R)&M},ee=new gy(25e3),he=new Hl(288),fe=new Hl(32),ve=0,z=0,U=s.i||0,J=0,T=s.w||0,D=0;U+2<o;++U){var B=K(U),$=U&32767,W=F[B];if(k[$]=W,F[B]=$,T<=U){var G=o-U;if((ve>7e3||J>24576)&&(G>423||!d)){m=Sb(e,f,0,ee,he,fe,z,J,D,U-D,m),J=ve=z=0,D=U;for(var oe=0;oe<286;++oe)he[oe]=0;for(var oe=0;oe<30;++oe)fe[oe]=0}var ie=2,we=0,Ce=y,Te=$-W&32767;if(G>2&&B==K(U-Te))for(var Y=Math.min(w,G)-1,H=Math.min(32767,U),Q=Math.min(258,G);Te<=H&&--Ce&&$!=W;){if(e[U+ie]==e[U+ie-Te]){for(var ue=0;ue<Q&&e[U+ue]==e[U+ue-Te];++ue);if(ue>ie){if(ie=ue,we=Te,ue>Y)break;for(var le=Math.min(Te,ue-2),pe=0,oe=0;oe<le;++oe){var Z=U-Te+oe&32767,N=k[Z],ke=Z-N&32767;ke>pe&&(pe=ke,W=Z)}}}$=W,W=k[$],Te+=$-W&32767}if(we){ee[J++]=268435456|v1[ie]<<18|xb[we];var Me=v1[ie]&31,Ue=xb[we]&31;z+=r0[Me]+i0[Ue],++he[257+Me],++fe[Ue],T=U+ie,++ve}else ee[J++]=e[U],++he[e[U]]}}for(U=Math.max(U,T);U<o;++U)ee[J++]=e[U],++he[e[U]];m=Sb(e,f,d,ee,he,fe,z,J,D,U-D,m),d||(s.r=m&7|f[m/8|0]<<3,m-=7,s.h=F,s.p=k,s.i=U,s.w=T)}else{for(var U=s.w||0;U<o+d;U+=65535){var ce=U+65535;ce>=o&&(f[m/8|0]=d,ce=o),m=_x(f,m+1,e.subarray(U,ce))}s.i=o}return yx(u,0,r+my(m)+i)},wx=function(){var e=1,n=0;return{p:function(t){for(var r=e,i=n,s=t.length|0,o=0;o!=s;){for(var u=Math.min(o+2655,s);o<u;++o)i+=r+=t[o];r=(r&65535)+15*(r>>16),i=(i&65535)+15*(i>>16)}e=r,n=i},d:function(){return e%=65521,n%=65521,(e&255)<<24|(e&65280)<<8|(n&255)<<8|n>>8}}},lF=function(e,n,t,r,i){if(!i&&(i={l:1},n.dictionary)){var s=n.dictionary.subarray(-32768),o=new Ra(s.length+e.length);o.set(s),o.set(e,s.length),e=o,i.w=s.length}return aF(e,n.level==null?6:n.level,n.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+n.mem,t,r,i)},xx=function(e,n,t){for(;t;++n)e[n]=t,t>>>=8},uF=function(e,n){var t=n.level,r=t==0?0:t<6?1:t==9?3:2;if(e[0]=120,e[1]=r<<6|(n.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,n.dictionary){var i=wx();i.p(n.dictionary),xx(e,2,i.d())}},cF=function(e,n){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&Fu(6,"invalid zlib data"),(e[1]>>5&1)==1&&Fu(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function b1(e,n){n||(n={});var t=wx();t.p(e);var r=lF(e,n,n.dictionary?6:2,4);return uF(r,n),xx(r,r.length-4,t.d()),r}function fF(e,n){return oF(e.subarray(cF(e),-4),{i:2},n,n)}var hF=typeof TextDecoder<"u"&&new TextDecoder,dF=0;try{hF.decode(bx,{stream:!0}),dF=1}catch{}var Dr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function uv(){Dr.console&&typeof Dr.console.log=="function"&&Dr.console.log.apply(Dr.console,arguments)}var mo={log:uv,warn:function(e){Dr.console&&(typeof Dr.console.warn=="function"?Dr.console.warn.apply(Dr.console,arguments):uv.call(null,arguments))},error:function(e){Dr.console&&(typeof Dr.console.error=="function"?Dr.console.error.apply(Dr.console,arguments):uv(e))}};function cv(e,n,t){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){Zf(r.response,n,t)},r.onerror=function(){mo.error("could not download file")},r.send()}function Eb(e){var n=new XMLHttpRequest;n.open("HEAD",e,!1);try{n.send()}catch{}return n.status>=200&&n.status<=299}function _g(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(n)}}var ap,w1,Zf=Dr.saveAs||((typeof window>"u"?"undefined":so(window))!=="object"||window!==Dr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,n,t){var r=Dr.URL||Dr.webkitURL,i=document.createElement("a");n=n||e.name||"download",i.download=n,i.rel="noopener",typeof e=="string"?(i.href=e,i.origin!==location.origin?Eb(i.href)?cv(e,n,t):_g(i,i.target="_blank"):_g(i)):(i.href=r.createObjectURL(e),setTimeout(function(){r.revokeObjectURL(i.href)},4e4),setTimeout(function(){_g(i)},0))}:"msSaveOrOpenBlob"in navigator?function(e,n,t){if(n=n||e.name||"download",typeof e=="string")if(Eb(e))cv(e,n,t);else{var r=document.createElement("a");r.href=e,r.target="_blank",setTimeout(function(){_g(r)})}else navigator.msSaveOrOpenBlob(function(i,s){return s===void 0?s={autoBom:!1}:so(s)!=="object"&&(mo.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(e,t),n)}:function(e,n,t,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof e=="string")return cv(e,n,t);var i=e.type==="application/octet-stream",s=/constructor/i.test(Dr.HTMLElement)||Dr.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||i&&s)&&(typeof FileReader>"u"?"undefined":so(FileReader))==="object"){var u=new FileReader;u.onloadend=function(){var m=u.result;m=o?m:m.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=m:location=m,r=null},u.readAsDataURL(e)}else{var f=Dr.URL||Dr.webkitURL,d=f.createObjectURL(e);r?r.location=d:location.href=d,r=null,setTimeout(function(){f.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Lx(e){var n;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(u){return[parseInt(u[1]),parseInt(u[2]),parseInt(u[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(u){return[parseInt(u[1],16),parseInt(u[2],16),parseInt(u[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(u){return[parseInt(u[1]+u[1],16),parseInt(u[2]+u[2],16),parseInt(u[3]+u[3],16)]}}],r=0;r<t.length;r++){var i=t[r].re,s=t[r].process,o=i.exec(e);o&&(n=s(o),this.r=n[0],this.g=n[1],this.b=n[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var u=this.r.toString(16),f=this.g.toString(16),d=this.b.toString(16);return u.length==1&&(u="0"+u),f.length==1&&(f="0"+f),d.length==1&&(d="0"+d),"#"+u+f+d}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function fv(e,n){var t=e[0],r=e[1],i=e[2],s=e[3];t=Aa(t,r,i,s,n[0],7,-680876936),s=Aa(s,t,r,i,n[1],12,-389564586),i=Aa(i,s,t,r,n[2],17,606105819),r=Aa(r,i,s,t,n[3],22,-1044525330),t=Aa(t,r,i,s,n[4],7,-176418897),s=Aa(s,t,r,i,n[5],12,1200080426),i=Aa(i,s,t,r,n[6],17,-1473231341),r=Aa(r,i,s,t,n[7],22,-45705983),t=Aa(t,r,i,s,n[8],7,1770035416),s=Aa(s,t,r,i,n[9],12,-1958414417),i=Aa(i,s,t,r,n[10],17,-42063),r=Aa(r,i,s,t,n[11],22,-1990404162),t=Aa(t,r,i,s,n[12],7,1804603682),s=Aa(s,t,r,i,n[13],12,-40341101),i=Aa(i,s,t,r,n[14],17,-1502002290),t=ka(t,r=Aa(r,i,s,t,n[15],22,1236535329),i,s,n[1],5,-165796510),s=ka(s,t,r,i,n[6],9,-1069501632),i=ka(i,s,t,r,n[11],14,643717713),r=ka(r,i,s,t,n[0],20,-373897302),t=ka(t,r,i,s,n[5],5,-701558691),s=ka(s,t,r,i,n[10],9,38016083),i=ka(i,s,t,r,n[15],14,-660478335),r=ka(r,i,s,t,n[4],20,-405537848),t=ka(t,r,i,s,n[9],5,568446438),s=ka(s,t,r,i,n[14],9,-1019803690),i=ka(i,s,t,r,n[3],14,-187363961),r=ka(r,i,s,t,n[8],20,1163531501),t=ka(t,r,i,s,n[13],5,-1444681467),s=ka(s,t,r,i,n[2],9,-51403784),i=ka(i,s,t,r,n[7],14,1735328473),t=Ta(t,r=ka(r,i,s,t,n[12],20,-1926607734),i,s,n[5],4,-378558),s=Ta(s,t,r,i,n[8],11,-2022574463),i=Ta(i,s,t,r,n[11],16,1839030562),r=Ta(r,i,s,t,n[14],23,-35309556),t=Ta(t,r,i,s,n[1],4,-1530992060),s=Ta(s,t,r,i,n[4],11,1272893353),i=Ta(i,s,t,r,n[7],16,-155497632),r=Ta(r,i,s,t,n[10],23,-1094730640),t=Ta(t,r,i,s,n[13],4,681279174),s=Ta(s,t,r,i,n[0],11,-358537222),i=Ta(i,s,t,r,n[3],16,-722521979),r=Ta(r,i,s,t,n[6],23,76029189),t=Ta(t,r,i,s,n[9],4,-640364487),s=Ta(s,t,r,i,n[12],11,-421815835),i=Ta(i,s,t,r,n[15],16,530742520),t=Na(t,r=Ta(r,i,s,t,n[2],23,-995338651),i,s,n[0],6,-198630844),s=Na(s,t,r,i,n[7],10,1126891415),i=Na(i,s,t,r,n[14],15,-1416354905),r=Na(r,i,s,t,n[5],21,-57434055),t=Na(t,r,i,s,n[12],6,1700485571),s=Na(s,t,r,i,n[3],10,-1894986606),i=Na(i,s,t,r,n[10],15,-1051523),r=Na(r,i,s,t,n[1],21,-2054922799),t=Na(t,r,i,s,n[8],6,1873313359),s=Na(s,t,r,i,n[15],10,-30611744),i=Na(i,s,t,r,n[6],15,-1560198380),r=Na(r,i,s,t,n[13],21,1309151649),t=Na(t,r,i,s,n[4],6,-145523070),s=Na(s,t,r,i,n[11],10,-1120210379),i=Na(i,s,t,r,n[2],15,718787259),r=Na(r,i,s,t,n[9],21,-343485551),e[0]=yf(t,e[0]),e[1]=yf(r,e[1]),e[2]=yf(i,e[2]),e[3]=yf(s,e[3])}function o0(e,n,t,r,i,s){return n=yf(yf(n,e),yf(r,s)),yf(n<<i|n>>>32-i,t)}function Aa(e,n,t,r,i,s,o){return o0(n&t|~n&r,e,n,i,s,o)}function ka(e,n,t,r,i,s,o){return o0(n&r|t&~r,e,n,i,s,o)}function Ta(e,n,t,r,i,s,o){return o0(n^t^r,e,n,i,s,o)}function Na(e,n,t,r,i,s,o){return o0(t^(n|~r),e,n,i,s,o)}function Sx(e){var n,t=e.length,r=[1732584193,-271733879,-1732584194,271733878];for(n=64;n<=e.length;n+=64)fv(r,pF(e.substring(n-64,n)));e=e.substring(n-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(n=0;n<e.length;n++)i[n>>2]|=e.charCodeAt(n)<<(n%4<<3);if(i[n>>2]|=128<<(n%4<<3),n>55)for(fv(r,i),n=0;n<16;n++)i[n]=0;return i[14]=8*t,fv(r,i),r}function pF(e){var n,t=[];for(n=0;n<64;n+=4)t[n>>2]=e.charCodeAt(n)+(e.charCodeAt(n+1)<<8)+(e.charCodeAt(n+2)<<16)+(e.charCodeAt(n+3)<<24);return t}ap=Dr.atob.bind(Dr),w1=Dr.btoa.bind(Dr);var Cb="0123456789abcdef".split("");function gF(e){for(var n="",t=0;t<4;t++)n+=Cb[e>>8*t+4&15]+Cb[e>>8*t&15];return n}function mF(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function x1(e){return Sx(e).map(mF).join("")}var vF=function(e){for(var n=0;n<e.length;n++)e[n]=gF(e[n]);return e.join("")}(Sx("hello"))!="5d41402abc4b2a76b9719d911017c592";function yf(e,n){if(vF){var t=(65535&e)+(65535&n);return(e>>16)+(n>>16)+(t>>16)<<16|65535&t}return e+n&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function L1(e,n){var t,r,i,s;if(e!==t){for(var o=(i=e,s=1+(256/e.length>>0),new Array(s+1).join(i)),u=[],f=0;f<256;f++)u[f]=f;var d=0;for(f=0;f<256;f++){var m=u[f];d=(d+m+o.charCodeAt(f))%256,u[f]=u[d],u[d]=m}t=e,r=u}else u=r;var _=n.length,w=0,y=0,M="";for(f=0;f<_;f++)y=(y+(m=u[w=(w+1)%256]))%256,u[w]=u[y],u[y]=m,o=u[(u[w]+u[y])%256],M+=String.fromCharCode(n.charCodeAt(f)^o);return M}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Pb={print:4,modify:8,copy:16,"annot-forms":32};function $h(e,n,t,r){this.v=1,this.r=2;var i=192;e.forEach(function(u){if(Pb.perm!==void 0)throw new Error("Invalid permission: "+u);i+=Pb[u]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var s=(n+this.padding).substr(0,32),o=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^i)),this.encryptionKey=x1(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=L1(this.encryptionKey,this.padding)}function Uh(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var n="",t=e.length,r=0;r<t;r++){var i=e.charCodeAt(r);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?n+="#"+("0"+i.toString(16)).slice(-2):n+=e[r]}return n}function Mb(e){if(so(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var n={};this.subscribe=function(t,r,i){if(i=i||!1,typeof t!="string"||typeof r!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");n.hasOwnProperty(t)||(n[t]={});var s=Math.random().toString(35);return n[t][s]=[r,!!i],s},this.unsubscribe=function(t){for(var r in n)if(n[r][t])return delete n[r][t],Object.keys(n[r]).length===0&&delete n[r],!0;return!1},this.publish=function(t){if(n.hasOwnProperty(t)){var r=Array.prototype.slice.call(arguments,1),i=[];for(var s in n[t]){var o=n[t][s];try{o[0].apply(e,r)}catch(u){Dr.console&&mo.error("jsPDF PubSub Error",u.message,u)}o[1]&&i.push(s)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return n}}function bm(e){if(!(this instanceof bm))return new bm(e);var n="opacity,stroke-opacity".split(",");for(var t in e)e.hasOwnProperty(t)&&n.indexOf(t)>=0&&(this[t]=e[t]);this.id="",this.objectNumber=-1}function Ex(e,n){this.gState=e,this.matrix=n,this.id="",this.objectNumber=-1}function Yf(e,n,t,r,i){if(!(this instanceof Yf))return new Yf(e,n,t,r,i);this.type=e==="axial"?2:3,this.coords=n,this.colors=t,Ex.call(this,r,i)}function Hh(e,n,t,r,i){if(!(this instanceof Hh))return new Hh(e,n,t,r,i);this.boundingBox=e,this.xStep=n,this.yStep=t,this.stream="",this.cloneIndex=0,Ex.call(this,r,i)}function kr(e){var n,t=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],i=arguments[2],s=arguments[3],o=[],u=1,f=16,d="S",m=null;so(e=e||{})==="object"&&(t=e.orientation,r=e.unit||r,i=e.format||i,s=e.compress||e.compressPdf||s,(m=e.encryption||null)!==null&&(m.userPassword=m.userPassword||"",m.ownerPassword=m.ownerPassword||"",m.userPermissions=m.userPermissions||[]),u=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(n=e.precision),e.floatPrecision!==void 0&&(f=e.floatPrecision),d=e.defaultPathOperation||"S"),o=e.filters||(s===!0?["FlateEncode"]:o),r=r||"mm",t=(""+(t||"P")).toLowerCase();var _=e.putOnlyUsedFonts||!1,w={},y={internal:{},__private__:{}};y.__private__.PubSub=Mb;var M="1.3",k=y.__private__.getPdfVersion=function(){return M};y.__private__.setPdfVersion=function(O){M=O};var F={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};y.__private__.getPageFormats=function(){return F};var I=y.__private__.getPageFormat=function(O){return F[O]};i=i||"a4";var R={COMPAT:"compat",ADVANCED:"advanced"},K=R.COMPAT;function ee(){this.saveGraphicsState(),de(new vn(rt,0,0,-rt,0,_a()*rt).toString()+" cm"),this.setFontSize(this.getFontSize()/rt),d="n",K=R.ADVANCED}function he(){this.restoreGraphicsState(),d="S",K=R.COMPAT}var fe=y.__private__.combineFontStyleAndFontWeight=function(O,_e){if(O=="bold"&&_e=="normal"||O=="bold"&&_e==400||O=="normal"&&_e=="italic"||O=="bold"&&_e=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return _e&&(O=_e==400||_e==="normal"?O==="italic"?"italic":"normal":_e!=700&&_e!=="bold"||O!=="normal"?(_e==700?"bold":_e)+""+O:"bold"),O};y.advancedAPI=function(O){var _e=K===R.COMPAT;return _e&&ee.call(this),typeof O!="function"||(O(this),_e&&he.call(this)),this},y.compatAPI=function(O){var _e=K===R.ADVANCED;return _e&&he.call(this),typeof O!="function"||(O(this),_e&&ee.call(this)),this},y.isAdvancedAPI=function(){return K===R.ADVANCED};var ve,z=function(O){if(K!==R.ADVANCED)throw new Error(O+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},U=y.roundToPrecision=y.__private__.roundToPrecision=function(O,_e){var Ye=n||_e;if(isNaN(O)||isNaN(Ye))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return O.toFixed(Ye).replace(/0+$/,"")};ve=y.hpf=y.__private__.hpf=typeof f=="number"?function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.hpf");return U(O,f)}:f==="smart"?function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.hpf");return U(O,O>-1&&O<1?16:5)}:function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.hpf");return U(O,16)};var J=y.f2=y.__private__.f2=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.f2");return U(O,2)},T=y.__private__.f3=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.f3");return U(O,3)},D=y.scale=y.__private__.scale=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.scale");return K===R.COMPAT?O*rt:K===R.ADVANCED?O:void 0},B=function(O){return K===R.COMPAT?_a()-O:K===R.ADVANCED?O:void 0},$=function(O){return D(B(O))};y.__private__.setPrecision=y.setPrecision=function(O){typeof parseInt(O,10)=="number"&&(n=parseInt(O,10))};var W,G="00000000000000000000000000000000",oe=y.__private__.getFileId=function(){return G},ie=y.__private__.setFileId=function(O){return G=O!==void 0&&/^[a-fA-F0-9]{32}$/.test(O)?O.toUpperCase():G.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),m!==null&&(Fi=new $h(m.userPermissions,m.userPassword,m.ownerPassword,G)),G};y.setFileId=function(O){return ie(O),this},y.getFileId=function(){return oe()};var we=y.__private__.convertDateToPDFDate=function(O){var _e=O.getTimezoneOffset(),Ye=_e<0?"+":"-",ut=Math.floor(Math.abs(_e/60)),Lt=Math.abs(_e%60),Ut=[Ye,Q(ut),"'",Q(Lt),"'"].join("");return["D:",O.getFullYear(),Q(O.getMonth()+1),Q(O.getDate()),Q(O.getHours()),Q(O.getMinutes()),Q(O.getSeconds()),Ut].join("")},Ce=y.__private__.convertPDFDateToDate=function(O){var _e=parseInt(O.substr(2,4),10),Ye=parseInt(O.substr(6,2),10)-1,ut=parseInt(O.substr(8,2),10),Lt=parseInt(O.substr(10,2),10),Ut=parseInt(O.substr(12,2),10),fn=parseInt(O.substr(14,2),10);return new Date(_e,Ye,ut,Lt,Ut,fn,0)},Te=y.__private__.setCreationDate=function(O){var _e;if(O===void 0&&(O=new Date),O instanceof Date)_e=we(O);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(O))throw new Error("Invalid argument passed to jsPDF.setCreationDate");_e=O}return W=_e},Y=y.__private__.getCreationDate=function(O){var _e=W;return O==="jsDate"&&(_e=Ce(W)),_e};y.setCreationDate=function(O){return Te(O),this},y.getCreationDate=function(O){return Y(O)};var H,Q=y.__private__.padd2=function(O){return("0"+parseInt(O)).slice(-2)},ue=y.__private__.padd2Hex=function(O){return("00"+(O=O.toString())).substr(O.length)},le=0,pe=[],Z=[],N=0,ke=[],Me=[],Ue=!1,ce=Z,ne=function(){le=0,N=0,Z=[],pe=[],ke=[],Tt=mt(),Rn=mt()};y.__private__.setCustomOutputDestination=function(O){Ue=!0,ce=O};var ye=function(O){Ue||(ce=O)};y.__private__.resetCustomOutputDestination=function(){Ue=!1,ce=Z};var de=y.__private__.out=function(O){return O=O.toString(),N+=O.length+1,ce.push(O),ce},We=y.__private__.write=function(O){return de(arguments.length===1?O.toString():Array.prototype.join.call(arguments," "))},Ge=y.__private__.getArrayBuffer=function(O){for(var _e=O.length,Ye=new ArrayBuffer(_e),ut=new Uint8Array(Ye);_e--;)ut[_e]=O.charCodeAt(_e);return Ye},tt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];y.__private__.getStandardFonts=function(){return tt};var Ze=e.fontSize||16;y.__private__.setFontSize=y.setFontSize=function(O){return Ze=K===R.ADVANCED?O/rt:O,this};var et,He=y.__private__.getFontSize=y.getFontSize=function(){return K===R.COMPAT?Ze:Ze*rt},wt=e.R2L||!1;y.__private__.setR2L=y.setR2L=function(O){return wt=O,this},y.__private__.getR2L=y.getR2L=function(){return wt};var Pt,kt=y.__private__.setZoomMode=function(O){var _e=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(O))et=O;else if(isNaN(O)){if(_e.indexOf(O)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+O+'" is not recognized.');et=O}else et=parseInt(O,10)};y.__private__.getZoomMode=function(){return et};var Jt,rn=y.__private__.setPageMode=function(O){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(O)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+O+'" is not recognized.');Pt=O};y.__private__.getPageMode=function(){return Pt};var un=y.__private__.setLayoutMode=function(O){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(O)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+O+'" is not recognized.');Jt=O};y.__private__.getLayoutMode=function(){return Jt},y.__private__.setDisplayMode=y.setDisplayMode=function(O,_e,Ye){return kt(O),un(_e),rn(Ye),this};var Ke={title:"",subject:"",author:"",keywords:"",creator:""};y.__private__.getDocumentProperty=function(O){if(Object.keys(Ke).indexOf(O)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ke[O]},y.__private__.getDocumentProperties=function(){return Ke},y.__private__.setDocumentProperties=y.setProperties=y.setDocumentProperties=function(O){for(var _e in Ke)Ke.hasOwnProperty(_e)&&O[_e]&&(Ke[_e]=O[_e]);return this},y.__private__.setDocumentProperty=function(O,_e){if(Object.keys(Ke).indexOf(O)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ke[O]=_e};var ot,rt,Ft,Qt,Bn,Ln={},Nn={},ar=[],En={},jn={},Mn={},Yn={},br=null,Or=0,gr=[],ii=new Mb(y),ft=e.hotfixes||[],Qe={},$t={},xn=[],vn=function O(_e,Ye,ut,Lt,Ut,fn){if(!(this instanceof O))return new O(_e,Ye,ut,Lt,Ut,fn);isNaN(_e)&&(_e=1),isNaN(Ye)&&(Ye=0),isNaN(ut)&&(ut=0),isNaN(Lt)&&(Lt=1),isNaN(Ut)&&(Ut=0),isNaN(fn)&&(fn=0),this._matrix=[_e,Ye,ut,Lt,Ut,fn]};Object.defineProperty(vn.prototype,"sx",{get:function(){return this._matrix[0]},set:function(O){this._matrix[0]=O}}),Object.defineProperty(vn.prototype,"shy",{get:function(){return this._matrix[1]},set:function(O){this._matrix[1]=O}}),Object.defineProperty(vn.prototype,"shx",{get:function(){return this._matrix[2]},set:function(O){this._matrix[2]=O}}),Object.defineProperty(vn.prototype,"sy",{get:function(){return this._matrix[3]},set:function(O){this._matrix[3]=O}}),Object.defineProperty(vn.prototype,"tx",{get:function(){return this._matrix[4]},set:function(O){this._matrix[4]=O}}),Object.defineProperty(vn.prototype,"ty",{get:function(){return this._matrix[5]},set:function(O){this._matrix[5]=O}}),Object.defineProperty(vn.prototype,"a",{get:function(){return this._matrix[0]},set:function(O){this._matrix[0]=O}}),Object.defineProperty(vn.prototype,"b",{get:function(){return this._matrix[1]},set:function(O){this._matrix[1]=O}}),Object.defineProperty(vn.prototype,"c",{get:function(){return this._matrix[2]},set:function(O){this._matrix[2]=O}}),Object.defineProperty(vn.prototype,"d",{get:function(){return this._matrix[3]},set:function(O){this._matrix[3]=O}}),Object.defineProperty(vn.prototype,"e",{get:function(){return this._matrix[4]},set:function(O){this._matrix[4]=O}}),Object.defineProperty(vn.prototype,"f",{get:function(){return this._matrix[5]},set:function(O){this._matrix[5]=O}}),Object.defineProperty(vn.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(vn.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(vn.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(vn.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),vn.prototype.join=function(O){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(ve).join(O)},vn.prototype.multiply=function(O){var _e=O.sx*this.sx+O.shy*this.shx,Ye=O.sx*this.shy+O.shy*this.sy,ut=O.shx*this.sx+O.sy*this.shx,Lt=O.shx*this.shy+O.sy*this.sy,Ut=O.tx*this.sx+O.ty*this.shx+this.tx,fn=O.tx*this.shy+O.ty*this.sy+this.ty;return new vn(_e,Ye,ut,Lt,Ut,fn)},vn.prototype.decompose=function(){var O=this.sx,_e=this.shy,Ye=this.shx,ut=this.sy,Lt=this.tx,Ut=this.ty,fn=Math.sqrt(O*O+_e*_e),Dn=(O/=fn)*Ye+(_e/=fn)*ut;Ye-=O*Dn,ut-=_e*Dn;var zn=Math.sqrt(Ye*Ye+ut*ut);return Dn/=zn,O*(ut/=zn)<_e*(Ye/=zn)&&(O=-O,_e=-_e,Dn=-Dn,fn=-fn),{scale:new vn(fn,0,0,zn,0,0),translate:new vn(1,0,0,1,Lt,Ut),rotate:new vn(O,_e,-_e,O,0,0),skew:new vn(1,0,Dn,1,0,0)}},vn.prototype.toString=function(O){return this.join(" ")},vn.prototype.inversed=function(){var O=this.sx,_e=this.shy,Ye=this.shx,ut=this.sy,Lt=this.tx,Ut=this.ty,fn=1/(O*ut-_e*Ye),Dn=ut*fn,zn=-_e*fn,ir=-Ye*fn,_r=O*fn;return new vn(Dn,zn,ir,_r,-Dn*Lt-ir*Ut,-zn*Lt-_r*Ut)},vn.prototype.applyToPoint=function(O){var _e=O.x*this.sx+O.y*this.shx+this.tx,Ye=O.x*this.shy+O.y*this.sy+this.ty;return new ko(_e,Ye)},vn.prototype.applyToRectangle=function(O){var _e=this.applyToPoint(O),Ye=this.applyToPoint(new ko(O.x+O.w,O.y+O.h));return new Hs(_e.x,_e.y,Ye.x-_e.x,Ye.y-_e.y)},vn.prototype.clone=function(){var O=this.sx,_e=this.shy,Ye=this.shx,ut=this.sy,Lt=this.tx,Ut=this.ty;return new vn(O,_e,Ye,ut,Lt,Ut)},y.Matrix=vn;var bn=y.matrixMult=function(O,_e){return _e.multiply(O)},Ht=new vn(1,0,0,1,0,0);y.unitMatrix=y.identityMatrix=Ht;var Hn=function(O,_e){if(!jn[O]){var Ye=(_e instanceof Yf?"Sh":"P")+(Object.keys(En).length+1).toString(10);_e.id=Ye,jn[O]=Ye,En[Ye]=_e,ii.publish("addPattern",_e)}};y.ShadingPattern=Yf,y.TilingPattern=Hh,y.addShadingPattern=function(O,_e){return z("addShadingPattern()"),Hn(O,_e),this},y.beginTilingPattern=function(O){z("beginTilingPattern()"),qs(O.boundingBox[0],O.boundingBox[1],O.boundingBox[2]-O.boundingBox[0],O.boundingBox[3]-O.boundingBox[1],O.matrix)},y.endTilingPattern=function(O,_e){z("endTilingPattern()"),_e.stream=Me[H].join(`
`),Hn(O,_e),ii.publish("endTilingPattern",_e),xn.pop().restore()};var St=y.__private__.newObject=function(){var O=mt();return wn(O,!0),O},mt=y.__private__.newObjectDeferred=function(){return le++,pe[le]=function(){return N},le},wn=function(O,_e){return _e=typeof _e=="boolean"&&_e,pe[O]=N,_e&&de(O+" 0 obj"),O},Qr=y.__private__.newAdditionalObject=function(){var O={objId:mt(),content:""};return ke.push(O),O},Tt=mt(),Rn=mt(),Qn=y.__private__.decodeColorString=function(O){var _e=O.split(" ");if(_e.length!==2||_e[1]!=="g"&&_e[1]!=="G")_e.length===5&&(_e[4]==="k"||_e[4]==="K")&&(_e=[(1-_e[0])*(1-_e[3]),(1-_e[1])*(1-_e[3]),(1-_e[2])*(1-_e[3]),"r"]);else{var Ye=parseFloat(_e[0]);_e=[Ye,Ye,Ye,"r"]}for(var ut="#",Lt=0;Lt<3;Lt++)ut+=("0"+Math.floor(255*parseFloat(_e[Lt])).toString(16)).slice(-2);return ut},Pi=y.__private__.encodeColorString=function(O){var _e;typeof O=="string"&&(O={ch1:O});var Ye=O.ch1,ut=O.ch2,Lt=O.ch3,Ut=O.ch4,fn=O.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Ye=="string"&&Ye.charAt(0)!=="#"){var Dn=new Lx(Ye);if(Dn.ok)Ye=Dn.toHex();else if(!/^\d*\.?\d*$/.test(Ye))throw new Error('Invalid color "'+Ye+'" passed to jsPDF.encodeColorString.')}if(typeof Ye=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Ye)&&(Ye="#"+Ye[1]+Ye[1]+Ye[2]+Ye[2]+Ye[3]+Ye[3]),typeof Ye=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Ye)){var zn=parseInt(Ye.substr(1),16);Ye=zn>>16&255,ut=zn>>8&255,Lt=255&zn}if(ut===void 0||Ut===void 0&&Ye===ut&&ut===Lt)if(typeof Ye=="string")_e=Ye+" "+fn[0];else switch(O.precision){case 2:_e=J(Ye/255)+" "+fn[0];break;case 3:default:_e=T(Ye/255)+" "+fn[0]}else if(Ut===void 0||so(Ut)==="object"){if(Ut&&!isNaN(Ut.a)&&Ut.a===0)return _e=["1.","1.","1.",fn[1]].join(" ");if(typeof Ye=="string")_e=[Ye,ut,Lt,fn[1]].join(" ");else switch(O.precision){case 2:_e=[J(Ye/255),J(ut/255),J(Lt/255),fn[1]].join(" ");break;default:case 3:_e=[T(Ye/255),T(ut/255),T(Lt/255),fn[1]].join(" ")}}else if(typeof Ye=="string")_e=[Ye,ut,Lt,Ut,fn[2]].join(" ");else switch(O.precision){case 2:_e=[J(Ye),J(ut),J(Lt),J(Ut),fn[2]].join(" ");break;case 3:default:_e=[T(Ye),T(ut),T(Lt),T(Ut),fn[2]].join(" ")}return _e},Sr=y.__private__.getFilters=function(){return o},Pr=y.__private__.putStream=function(O){var _e=(O=O||{}).data||"",Ye=O.filters||Sr(),ut=O.alreadyAppliedFilters||[],Lt=O.addLength1||!1,Ut=_e.length,fn=O.objectId,Dn=function(ho){return ho};if(m!==null&&fn===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");m!==null&&(Dn=Fi.encryptor(fn,0));var zn={};Ye===!0&&(Ye=["FlateEncode"]);var ir=O.additionalKeyValues||[],_r=(zn=kr.API.processDataByFilters!==void 0?kr.API.processDataByFilters(_e,Ye):{data:_e,reverseChain:[]}).reverseChain+(Array.isArray(ut)?ut.join(" "):ut.toString());if(zn.data.length!==0&&(ir.push({key:"Length",value:zn.data.length}),Lt===!0&&ir.push({key:"Length1",value:Ut})),_r.length!=0)if(_r.split("/").length-1==1)ir.push({key:"Filter",value:_r});else{ir.push({key:"Filter",value:"["+_r+"]"});for(var $r=0;$r<ir.length;$r+=1)if(ir[$r].key==="DecodeParms"){for(var Gi=[],hi=0;hi<zn.reverseChain.split("/").length-1;hi+=1)Gi.push("null");Gi.push(ir[$r].value),ir[$r].value="["+Gi.join(" ")+"]"}}de("<<");for(var _i=0;_i<ir.length;_i++)de("/"+ir[_i].key+" "+ir[_i].value);de(">>"),zn.data.length!==0&&(de("stream"),de(Dn(zn.data)),de("endstream"))},dr=y.__private__.putPage=function(O){var _e=O.number,Ye=O.data,ut=O.objId,Lt=O.contentsObjId;wn(ut,!0),de("<</Type /Page"),de("/Parent "+O.rootDictionaryObjId+" 0 R"),de("/Resources "+O.resourceDictionaryObjId+" 0 R"),de("/MediaBox ["+parseFloat(ve(O.mediaBox.bottomLeftX))+" "+parseFloat(ve(O.mediaBox.bottomLeftY))+" "+ve(O.mediaBox.topRightX)+" "+ve(O.mediaBox.topRightY)+"]"),O.cropBox!==null&&de("/CropBox ["+ve(O.cropBox.bottomLeftX)+" "+ve(O.cropBox.bottomLeftY)+" "+ve(O.cropBox.topRightX)+" "+ve(O.cropBox.topRightY)+"]"),O.bleedBox!==null&&de("/BleedBox ["+ve(O.bleedBox.bottomLeftX)+" "+ve(O.bleedBox.bottomLeftY)+" "+ve(O.bleedBox.topRightX)+" "+ve(O.bleedBox.topRightY)+"]"),O.trimBox!==null&&de("/TrimBox ["+ve(O.trimBox.bottomLeftX)+" "+ve(O.trimBox.bottomLeftY)+" "+ve(O.trimBox.topRightX)+" "+ve(O.trimBox.topRightY)+"]"),O.artBox!==null&&de("/ArtBox ["+ve(O.artBox.bottomLeftX)+" "+ve(O.artBox.bottomLeftY)+" "+ve(O.artBox.topRightX)+" "+ve(O.artBox.topRightY)+"]"),typeof O.userUnit=="number"&&O.userUnit!==1&&de("/UserUnit "+O.userUnit),ii.publish("putPage",{objId:ut,pageContext:gr[_e],pageNumber:_e,page:Ye}),de("/Contents "+Lt+" 0 R"),de(">>"),de("endobj");var Ut=Ye.join(`
`);return K===R.ADVANCED&&(Ut+=`
Q`),wn(Lt,!0),Pr({data:Ut,filters:Sr(),objectId:Lt}),de("endobj"),ut},Mi=y.__private__.putPages=function(){var O,_e,Ye=[];for(O=1;O<=Or;O++)gr[O].objId=mt(),gr[O].contentsObjId=mt();for(O=1;O<=Or;O++)Ye.push(dr({number:O,data:Me[O],objId:gr[O].objId,contentsObjId:gr[O].contentsObjId,mediaBox:gr[O].mediaBox,cropBox:gr[O].cropBox,bleedBox:gr[O].bleedBox,trimBox:gr[O].trimBox,artBox:gr[O].artBox,userUnit:gr[O].userUnit,rootDictionaryObjId:Tt,resourceDictionaryObjId:Rn}));wn(Tt,!0),de("<</Type /Pages");var ut="/Kids [";for(_e=0;_e<Or;_e++)ut+=Ye[_e]+" 0 R ";de(ut+"]"),de("/Count "+Or),de(">>"),de("endobj"),ii.publish("postPutPages")},wr=function(O){ii.publish("putFont",{font:O,out:de,newObject:St,putStream:Pr}),O.isAlreadyPutted!==!0&&(O.objectNumber=St(),de("<<"),de("/Type /Font"),de("/BaseFont /"+Uh(O.postScriptName)),de("/Subtype /Type1"),typeof O.encoding=="string"&&de("/Encoding /"+O.encoding),de("/FirstChar 32"),de("/LastChar 255"),de(">>"),de("endobj"))},Gr=function(){for(var O in Ln)Ln.hasOwnProperty(O)&&(_===!1||_===!0&&w.hasOwnProperty(O))&&wr(Ln[O])},Ir=function(O){O.objectNumber=St();var _e=[];_e.push({key:"Type",value:"/XObject"}),_e.push({key:"Subtype",value:"/Form"}),_e.push({key:"BBox",value:"["+[ve(O.x),ve(O.y),ve(O.x+O.width),ve(O.y+O.height)].join(" ")+"]"}),_e.push({key:"Matrix",value:"["+O.matrix.toString()+"]"});var Ye=O.pages[1].join(`
`);Pr({data:Ye,additionalKeyValues:_e,objectId:O.objectNumber}),de("endobj")},tn=function(){for(var O in Qe)Qe.hasOwnProperty(O)&&Ir(Qe[O])},zi=function(O,_e){var Ye,ut=[],Lt=1/(_e-1);for(Ye=0;Ye<1;Ye+=Lt)ut.push(Ye);if(ut.push(1),O[0].offset!=0){var Ut={offset:0,color:O[0].color};O.unshift(Ut)}if(O[O.length-1].offset!=1){var fn={offset:1,color:O[O.length-1].color};O.push(fn)}for(var Dn="",zn=0,ir=0;ir<ut.length;ir++){for(Ye=ut[ir];Ye>O[zn+1].offset;)zn++;var _r=O[zn].offset,$r=(Ye-_r)/(O[zn+1].offset-_r),Gi=O[zn].color,hi=O[zn+1].color;Dn+=ue(Math.round((1-$r)*Gi[0]+$r*hi[0]).toString(16))+ue(Math.round((1-$r)*Gi[1]+$r*hi[1]).toString(16))+ue(Math.round((1-$r)*Gi[2]+$r*hi[2]).toString(16))}return Dn.trim()},Oi=function(O,_e){_e||(_e=21);var Ye=St(),ut=zi(O.colors,_e),Lt=[];Lt.push({key:"FunctionType",value:"0"}),Lt.push({key:"Domain",value:"[0.0 1.0]"}),Lt.push({key:"Size",value:"["+_e+"]"}),Lt.push({key:"BitsPerSample",value:"8"}),Lt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Lt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Pr({data:ut,additionalKeyValues:Lt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Ye}),de("endobj"),O.objectNumber=St(),de("<< /ShadingType "+O.type),de("/ColorSpace /DeviceRGB");var Ut="/Coords ["+ve(parseFloat(O.coords[0]))+" "+ve(parseFloat(O.coords[1]))+" ";O.type===2?Ut+=ve(parseFloat(O.coords[2]))+" "+ve(parseFloat(O.coords[3])):Ut+=ve(parseFloat(O.coords[2]))+" "+ve(parseFloat(O.coords[3]))+" "+ve(parseFloat(O.coords[4]))+" "+ve(parseFloat(O.coords[5])),de(Ut+="]"),O.matrix&&de("/Matrix ["+O.matrix.toString()+"]"),de("/Function "+Ye+" 0 R"),de("/Extend [true true]"),de(">>"),de("endobj")},Qi=function(O,_e){var Ye=mt(),ut=St();_e.push({resourcesOid:Ye,objectOid:ut}),O.objectNumber=ut;var Lt=[];Lt.push({key:"Type",value:"/Pattern"}),Lt.push({key:"PatternType",value:"1"}),Lt.push({key:"PaintType",value:"1"}),Lt.push({key:"TilingType",value:"1"}),Lt.push({key:"BBox",value:"["+O.boundingBox.map(ve).join(" ")+"]"}),Lt.push({key:"XStep",value:ve(O.xStep)}),Lt.push({key:"YStep",value:ve(O.yStep)}),Lt.push({key:"Resources",value:Ye+" 0 R"}),O.matrix&&Lt.push({key:"Matrix",value:"["+O.matrix.toString()+"]"}),Pr({data:O.stream,additionalKeyValues:Lt,objectId:O.objectNumber}),de("endobj")},ei=function(O){var _e;for(_e in En)En.hasOwnProperty(_e)&&(En[_e]instanceof Yf?Oi(En[_e]):En[_e]instanceof Hh&&Qi(En[_e],O))},Br=function(O){for(var _e in O.objectNumber=St(),de("<<"),O)switch(_e){case"opacity":de("/ca "+J(O[_e]));break;case"stroke-opacity":de("/CA "+J(O[_e]))}de(">>"),de("endobj")},ui=function(){var O;for(O in Mn)Mn.hasOwnProperty(O)&&Br(Mn[O])},mr=function(){for(var O in de("/XObject <<"),Qe)Qe.hasOwnProperty(O)&&Qe[O].objectNumber>=0&&de("/"+O+" "+Qe[O].objectNumber+" 0 R");ii.publish("putXobjectDict"),de(">>")},Si=function(){Fi.oid=St(),de("<<"),de("/Filter /Standard"),de("/V "+Fi.v),de("/R "+Fi.r),de("/U <"+Fi.toHexString(Fi.U)+">"),de("/O <"+Fi.toHexString(Fi.O)+">"),de("/P "+Fi.P),de(">>"),de("endobj")},ps=function(){for(var O in de("/Font <<"),Ln)Ln.hasOwnProperty(O)&&(_===!1||_===!0&&w.hasOwnProperty(O))&&de("/"+O+" "+Ln[O].objectNumber+" 0 R");de(">>")},va=function(){if(Object.keys(En).length>0){for(var O in de("/Shading <<"),En)En.hasOwnProperty(O)&&En[O]instanceof Yf&&En[O].objectNumber>=0&&de("/"+O+" "+En[O].objectNumber+" 0 R");ii.publish("putShadingPatternDict"),de(">>")}},Rr=function(O){if(Object.keys(En).length>0){for(var _e in de("/Pattern <<"),En)En.hasOwnProperty(_e)&&En[_e]instanceof y.TilingPattern&&En[_e].objectNumber>=0&&En[_e].objectNumber<O&&de("/"+_e+" "+En[_e].objectNumber+" 0 R");ii.publish("putTilingPatternDict"),de(">>")}},mn=function(){if(Object.keys(Mn).length>0){var O;for(O in de("/ExtGState <<"),Mn)Mn.hasOwnProperty(O)&&Mn[O].objectNumber>=0&&de("/"+O+" "+Mn[O].objectNumber+" 0 R");ii.publish("putGStateDict"),de(">>")}},Zn=function(O){wn(O.resourcesOid,!0),de("<<"),de("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),ps(),va(),Rr(O.objectOid),mn(),mr(),de(">>"),de("endobj")},Ei=function(){var O=[];Gr(),ui(),tn(),ei(O),ii.publish("putResources"),O.forEach(Zn),Zn({resourcesOid:Rn,objectOid:Number.MAX_SAFE_INTEGER}),ii.publish("postPutResources")},Bi=function(){ii.publish("putAdditionalObjects");for(var O=0;O<ke.length;O++){var _e=ke[O];wn(_e.objId,!0),de(_e.content),de("endobj")}ii.publish("postPutAdditionalObjects")},Ri=function(O){Nn[O.fontName]=Nn[O.fontName]||{},Nn[O.fontName][O.fontStyle]=O.id},jo=function(O,_e,Ye,ut,Lt){var Ut={id:"F"+(Object.keys(Ln).length+1).toString(10),postScriptName:O,fontName:_e,fontStyle:Ye,encoding:ut,isStandardFont:Lt||!1,metadata:{}};return ii.publish("addFont",{font:Ut,instance:this}),Ln[Ut.id]=Ut,Ri(Ut),Ut.id},cr=function(O){for(var _e=0,Ye=tt.length;_e<Ye;_e++){var ut=jo.call(this,O[_e][0],O[_e][1],O[_e][2],tt[_e][3],!0);_===!1&&(w[ut]=!0);var Lt=O[_e][0].split("-");Ri({id:ut,fontName:Lt[0],fontStyle:Lt[1]||""})}ii.publish("addFonts",{fonts:Ln,dictionary:Nn})},Vn=function(O){return O.foo=function(){try{return O.apply(this,arguments)}catch(ut){var _e=ut.stack||"";~_e.indexOf(" at ")&&(_e=_e.split(" at ")[1]);var Ye="Error in function "+_e.split(`
`)[0].split("<")[0]+": "+ut.message;if(!Dr.console)throw new Error(Ye);Dr.console.error(Ye,ut),Dr.alert&&alert(Ye)}},O.foo.bar=O,O.foo},Ms=function(O,_e){var Ye,ut,Lt,Ut,fn,Dn,zn,ir,_r;if(Lt=(_e=_e||{}).sourceEncoding||"Unicode",fn=_e.outputEncoding,(_e.autoencode||fn)&&Ln[ot].metadata&&Ln[ot].metadata[Lt]&&Ln[ot].metadata[Lt].encoding&&(Ut=Ln[ot].metadata[Lt].encoding,!fn&&Ln[ot].encoding&&(fn=Ln[ot].encoding),!fn&&Ut.codePages&&(fn=Ut.codePages[0]),typeof fn=="string"&&(fn=Ut[fn]),fn)){for(zn=!1,Dn=[],Ye=0,ut=O.length;Ye<ut;Ye++)(ir=fn[O.charCodeAt(Ye)])?Dn.push(String.fromCharCode(ir)):Dn.push(O[Ye]),Dn[Ye].charCodeAt(0)>>8&&(zn=!0);O=Dn.join("")}for(Ye=O.length;zn===void 0&&Ye!==0;)O.charCodeAt(Ye-1)>>8&&(zn=!0),Ye--;if(!zn)return O;for(Dn=_e.noBOM?[]:[254,255],Ye=0,ut=O.length;Ye<ut;Ye++){if((_r=(ir=O.charCodeAt(Ye))>>8)>>8)throw new Error("Character at position "+Ye+" of string '"+O+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Dn.push(_r),Dn.push(ir-(_r<<8))}return String.fromCharCode.apply(void 0,Dn)},oi=y.__private__.pdfEscape=y.pdfEscape=function(O,_e){return Ms(O,_e).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ai=y.__private__.beginPage=function(O){Me[++Or]=[],gr[Or]={objId:0,contentsObjId:0,userUnit:Number(u),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(O[0]),topRightY:Number(O[1])}},cn(Or),ye(Me[H])},ci=function(O,_e){var Ye,ut,Lt;switch(t=_e||t,typeof O=="string"&&(Ye=I(O.toLowerCase()),Array.isArray(Ye)&&(ut=Ye[0],Lt=Ye[1])),Array.isArray(O)&&(ut=O[0]*rt,Lt=O[1]*rt),isNaN(ut)&&(ut=i[0],Lt=i[1]),(ut>14400||Lt>14400)&&(mo.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ut=Math.min(14400,ut),Lt=Math.min(14400,Lt)),i=[ut,Lt],t.substr(0,1)){case"l":Lt>ut&&(i=[Lt,ut]);break;case"p":ut>Lt&&(i=[Lt,ut])}Ai(i),Tl(Jl),de(qi),Il!==0&&de(Il+" J"),vi!==0&&de(vi+" j"),ii.publish("addPage",{pageNumber:Or})},Cn=function(O){O>0&&O<=Or&&(Me.splice(O,1),gr.splice(O,1),Or--,H>Or&&(H=Or),this.setPage(H))},cn=function(O){O>0&&O<=Or&&(H=O)},fr=y.__private__.getNumberOfPages=y.getNumberOfPages=function(){return Me.length-1},eo=function(O,_e,Ye){var ut,Lt=void 0;return Ye=Ye||{},O=O!==void 0?O:Ln[ot].fontName,_e=_e!==void 0?_e:Ln[ot].fontStyle,ut=O.toLowerCase(),Nn[ut]!==void 0&&Nn[ut][_e]!==void 0?Lt=Nn[ut][_e]:Nn[O]!==void 0&&Nn[O][_e]!==void 0?Lt=Nn[O][_e]:Ye.disableWarning===!1&&mo.warn("Unable to look up font label for font '"+O+"', '"+_e+"'. Refer to getFontList() for available fonts."),Lt||Ye.noFallback||(Lt=Nn.times[_e])==null&&(Lt=Nn.times.normal),Lt},Ao=y.__private__.putInfo=function(){var O=St(),_e=function(ut){return ut};for(var Ye in m!==null&&(_e=Fi.encryptor(O,0)),de("<<"),de("/Producer ("+oi(_e("jsPDF "+kr.version))+")"),Ke)Ke.hasOwnProperty(Ye)&&Ke[Ye]&&de("/"+Ye.substr(0,1).toUpperCase()+Ye.substr(1)+" ("+oi(_e(Ke[Ye]))+")");de("/CreationDate ("+oi(_e(W))+")"),de(">>"),de("endobj")},_o=y.__private__.putCatalog=function(O){var _e=(O=O||{}).rootDictionaryObjId||Tt;switch(St(),de("<<"),de("/Type /Catalog"),de("/Pages "+_e+" 0 R"),et||(et="fullwidth"),et){case"fullwidth":de("/OpenAction [3 0 R /FitH null]");break;case"fullheight":de("/OpenAction [3 0 R /FitV null]");break;case"fullpage":de("/OpenAction [3 0 R /Fit]");break;case"original":de("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Ye=""+et;Ye.substr(Ye.length-1)==="%"&&(et=parseInt(et)/100),typeof et=="number"&&de("/OpenAction [3 0 R /XYZ null null "+J(et)+"]")}switch(Jt||(Jt="continuous"),Jt){case"continuous":de("/PageLayout /OneColumn");break;case"single":de("/PageLayout /SinglePage");break;case"two":case"twoleft":de("/PageLayout /TwoColumnLeft");break;case"tworight":de("/PageLayout /TwoColumnRight")}Pt&&de("/PageMode /"+Pt),ii.publish("putCatalog"),de(">>"),de("endobj")},za=y.__private__.putTrailer=function(){de("trailer"),de("<<"),de("/Size "+(le+1)),de("/Root "+le+" 0 R"),de("/Info "+(le-1)+" 0 R"),m!==null&&de("/Encrypt "+Fi.oid+" 0 R"),de("/ID [ <"+G+"> <"+G+"> ]"),de(">>")},Qo=y.__private__.putHeader=function(){de("%PDF-"+M),de("%ºß¬à")},il=y.__private__.putXRef=function(){var O="0000000000";de("xref"),de("0 "+(le+1)),de("0000000000 65535 f ");for(var _e=1;_e<=le;_e++)typeof pe[_e]=="function"?de((O+pe[_e]()).slice(-10)+" 00000 n "):pe[_e]!==void 0?de((O+pe[_e]).slice(-10)+" 00000 n "):de("0000000000 00000 n ")},jr=y.__private__.buildDocument=function(){ne(),ye(Z),ii.publish("buildDocument"),Qo(),Mi(),Bi(),Ei(),m!==null&&Si(),Ao(),_o();var O=N;return il(),za(),de("startxref"),de(""+O),de("%%EOF"),ye(Me[H]),Z.join(`
`)},As=y.__private__.getBlob=function(O){return new Blob([Ge(O)],{type:"application/pdf"})},lo=y.output=y.__private__.output=Vn(function(O,_e){switch(typeof(_e=_e||{})=="string"?_e={filename:_e}:_e.filename=_e.filename||"generated.pdf",O){case void 0:return jr();case"save":y.save(_e.filename);break;case"arraybuffer":return Ge(jr());case"blob":return As(jr());case"bloburi":case"bloburl":if(Dr.URL!==void 0&&typeof Dr.URL.createObjectURL=="function")return Dr.URL&&Dr.URL.createObjectURL(As(jr()))||void 0;mo.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Ye="",ut=jr();try{Ye=w1(ut)}catch{Ye=w1(unescape(encodeURIComponent(ut)))}return"data:application/pdf;filename="+_e.filename+";base64,"+Ye;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Dr)==="[object Window]"){var Lt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ut=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';_e.pdfObjectUrl&&(Lt=_e.pdfObjectUrl,Ut="");var fn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Lt+'"'+Ut+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(_e)+");<\/script></body></html>",Dn=Dr.open();return Dn!==null&&Dn.document.write(fn),Dn}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Dr)==="[object Window]"){var zn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(_e.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+_e.filename+'" width="500px" height="400px" /></body></html>',ir=Dr.open();if(ir!==null){ir.document.write(zn);var _r=this;ir.document.documentElement.querySelector("#pdfViewer").onload=function(){ir.document.title=_e.filename,ir.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(_r.output("bloburl"))}}return ir}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Dr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var $r='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",_e)+'"></iframe></body></html>',Gi=Dr.open();if(Gi!==null&&(Gi.document.write($r),Gi.document.title=_e.filename),Gi||typeof safari>"u")return Gi;break;case"datauri":case"dataurl":return Dr.document.location.href=this.output("datauristring",_e);default:return null}}),es=function(O){return Array.isArray(ft)===!0&&ft.indexOf(O)>-1};switch(r){case"pt":rt=1;break;case"mm":rt=72/25.4;break;case"cm":rt=72/2.54;break;case"in":rt=72;break;case"px":rt=es("px_scaling")==1?.75:96/72;break;case"pc":case"em":rt=12;break;case"ex":rt=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);rt=r}var Fi=null;Te(),ie();var Pl=function(O){return m!==null?Fi.encryptor(O,0):function(_e){return _e}},$a=y.__private__.getPageInfo=y.getPageInfo=function(O){if(isNaN(O)||O%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:gr[O].objId,pageNumber:O,pageContext:gr[O]}},vr=y.__private__.getPageInfoByObjId=function(O){if(isNaN(O)||O%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var _e in gr)if(gr[_e].objId===O)break;return $a(_e)},yr=y.__private__.getCurrentPageInfo=y.getCurrentPageInfo=function(){return{objId:gr[H].objId,pageNumber:H,pageContext:gr[H]}};y.addPage=function(){return ci.apply(this,arguments),this},y.setPage=function(){return cn.apply(this,arguments),ye.call(this,Me[H]),this},y.insertPage=function(O){return this.addPage(),this.movePage(H,O),this},y.movePage=function(O,_e){var Ye,ut;if(O>_e){Ye=Me[O],ut=gr[O];for(var Lt=O;Lt>_e;Lt--)Me[Lt]=Me[Lt-1],gr[Lt]=gr[Lt-1];Me[_e]=Ye,gr[_e]=ut,this.setPage(_e)}else if(O<_e){Ye=Me[O],ut=gr[O];for(var Ut=O;Ut<_e;Ut++)Me[Ut]=Me[Ut+1],gr[Ut]=gr[Ut+1];Me[_e]=Ye,gr[_e]=ut,this.setPage(_e)}return this},y.deletePage=function(){return Cn.apply(this,arguments),this},y.__private__.text=y.text=function(O,_e,Ye,ut,Lt){var Ut,fn,Dn,zn,ir,_r,$r,Gi,hi,_i=(ut=ut||{}).scope||this;if(typeof O=="number"&&typeof _e=="number"&&(typeof Ye=="string"||Array.isArray(Ye))){var ho=Ye;Ye=_e,_e=O,O=ho}if(arguments[3]instanceof vn?(z("The transform parameter of text() with a Matrix value"),hi=Lt):(Dn=arguments[4],zn=arguments[5],so($r=arguments[3])==="object"&&$r!==null||(typeof Dn=="string"&&(zn=Dn,Dn=null),typeof $r=="string"&&(zn=$r,$r=null),typeof $r=="number"&&(Dn=$r,$r=null),ut={flags:$r,angle:Dn,align:zn})),isNaN(_e)||isNaN(Ye)||O==null)throw new Error("Invalid arguments passed to jsPDF.text");if(O.length===0)return _i;var bo="",Ts=!1,Ur=typeof ut.lineHeightFactor=="number"?ut.lineHeightFactor:kl,zo=_i.internal.scaleFactor;function ul(wi){return wi=wi.split("	").join(Array(ut.TabLen||9).join(" ")),oi(wi,$r)}function rs(wi){for(var ki,po=wi.concat(),$i=[],Is=po.length;Is--;)typeof(ki=po.shift())=="string"?$i.push(ki):Array.isArray(wi)&&(ki.length===1||ki[1]===void 0&&ki[2]===void 0)?$i.push(ki[0]):$i.push([ki[0],ki[1],ki[2]]);return $i}function eu(wi,ki){var po;if(typeof wi=="string")po=ki(wi)[0];else if(Array.isArray(wi)){for(var $i,Is,ms=wi.concat(),js=[],Lu=ms.length;Lu--;)typeof($i=ms.shift())=="string"?js.push(ki($i)[0]):Array.isArray($i)&&typeof $i[0]=="string"&&(Is=ki($i[0],$i[1],$i[2]),js.push([Is[0],Is[1],Is[2]]));po=js}return po}var na=!1,xu=!0;if(typeof O=="string")na=!0;else if(Array.isArray(O)){var Ga=O.concat();fn=[];for(var Ha,wo=Ga.length;wo--;)(typeof(Ha=Ga.shift())!="string"||Array.isArray(Ha)&&typeof Ha[0]!="string")&&(xu=!1);na=xu}if(na===!1)throw new Error('Type of text must be string or Array. "'+O+'" is not recognized.');typeof O=="string"&&(O=O.match(/[\r?\n]/)?O.split(/\r\n|\r|\n/g):[O]);var ra=Ze/_i.internal.scaleFactor,Ns=ra*(Ur-1);switch(ut.baseline){case"bottom":Ye-=Ns;break;case"top":Ye+=ra-Ns;break;case"hanging":Ye+=ra-2*Ns;break;case"middle":Ye+=ra/2-Ns}if((_r=ut.maxWidth||0)>0&&(typeof O=="string"?O=_i.splitTextToSize(O,_r):Object.prototype.toString.call(O)==="[object Array]"&&(O=O.reduce(function(wi,ki){return wi.concat(_i.splitTextToSize(ki,_r))},[]))),Ut={text:O,x:_e,y:Ye,options:ut,mutex:{pdfEscape:oi,activeFontKey:ot,fonts:Ln,activeFontSize:Ze}},ii.publish("preProcessText",Ut),O=Ut.text,Dn=(ut=Ut.options).angle,!(hi instanceof vn)&&Dn&&typeof Dn=="number"){Dn*=Math.PI/180,ut.rotationDirection===0&&(Dn=-Dn),K===R.ADVANCED&&(Dn=-Dn);var gs=Math.cos(Dn),cl=Math.sin(Dn);hi=new vn(gs,cl,-cl,gs,0,0)}else Dn&&Dn instanceof vn&&(hi=Dn);K!==R.ADVANCED||hi||(hi=Ht),(ir=ut.charSpace||Dl)!==void 0&&(bo+=ve(D(ir))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Gi=ut.horizontalScale)!==void 0&&(bo+=ve(100*Gi)+` Tz
`),ut.lang;var $o=-1,is=ut.renderingMode!==void 0?ut.renderingMode:ut.stroke,os=_i.internal.getCurrentPageInfo().pageContext;switch(is){case 0:case!1:case"fill":$o=0;break;case 1:case!0:case"stroke":$o=1;break;case 2:case"fillThenStroke":$o=2;break;case 3:case"invisible":$o=3;break;case 4:case"fillAndAddForClipping":$o=4;break;case 5:case"strokeAndAddPathForClipping":$o=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":$o=6;break;case 7:case"addToPathForClipping":$o=7}var Xu=os.usedRenderingMode!==void 0?os.usedRenderingMode:-1;$o!==-1?bo+=$o+` Tr
`:Xu!==-1&&(bo+=`0 Tr
`),$o!==-1&&(os.usedRenderingMode=$o),zn=ut.align||"left";var Po,ba=Ze*Ur,Uo=_i.internal.pageSize.getWidth(),Vo=Ln[ot];ir=ut.charSpace||Dl,_r=ut.maxWidth||0,$r=Object.assign({autoencode:!0,noBOM:!0},ut.flags);var wa=[],xa=function(wi){return _i.getStringUnitWidth(wi,{font:Vo,charSpace:ir,fontSize:Ze,doKerning:!1})*Ze/zo};if(Object.prototype.toString.call(O)==="[object Array]"){var Go;fn=rs(O),zn!=="left"&&(Po=fn.map(xa));var To,ia=0;if(zn==="right"){_e-=Po[0],O=[],wo=fn.length;for(var Ds=0;Ds<wo;Ds++)Ds===0?(To=lr(_e),Go=co(Ye)):(To=D(ia-Po[Ds]),Go=-ba),O.push([fn[Ds],To,Go]),ia=Po[Ds]}else if(zn==="center"){_e-=Po[0]/2,O=[],wo=fn.length;for(var Ho=0;Ho<wo;Ho++)Ho===0?(To=lr(_e),Go=co(Ye)):(To=D((ia-Po[Ho])/2),Go=-ba),O.push([fn[Ho],To,Go]),ia=Po[Ho]}else if(zn==="left"){O=[],wo=fn.length;for(var _t=0;_t<wo;_t++)O.push(fn[_t])}else if(zn==="justify"&&Vo.encoding==="Identity-H"){O=[],wo=fn.length,_r=_r!==0?_r:Uo;for(var Wt=0,Nt=0;Nt<wo;Nt++)if(Go=Nt===0?co(Ye):-ba,To=Nt===0?lr(_e):Wt,Nt<wo-1){var An=D((_r-Po[Nt])/(fn[Nt].split(" ").length-1)),Jn=fn[Nt].split(" ");O.push([Jn[0]+" ",To,Go]),Wt=0;for(var xr=1;xr<Jn.length;xr++){var Wi=(xa(Jn[xr-1]+" "+Jn[xr])-xa(Jn[xr]))*zo+An;xr==Jn.length-1?O.push([Jn[xr],Wi,0]):O.push([Jn[xr]+" ",Wi,0]),Wt-=Wi}}else O.push([fn[Nt],To,Go]);O.push(["",Wt,0])}else{if(zn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(O=[],wo=fn.length,_r=_r!==0?_r:Uo,Nt=0;Nt<wo;Nt++)Go=Nt===0?co(Ye):-ba,To=Nt===0?lr(_e):0,Nt<wo-1?wa.push(ve(D((_r-Po[Nt])/(fn[Nt].split(" ").length-1)))):wa.push(0),O.push([fn[Nt],To,Go])}}var bi=typeof ut.R2L=="boolean"?ut.R2L:wt;bi===!0&&(O=eu(O,function(wi,ki,po){return[wi.split("").reverse().join(""),ki,po]})),Ut={text:O,x:_e,y:Ye,options:ut,mutex:{pdfEscape:oi,activeFontKey:ot,fonts:Ln,activeFontSize:Ze}},ii.publish("postProcessText",Ut),O=Ut.text,Ts=Ut.mutex.isHex||!1;var Bl=Ln[ot].encoding;Bl!=="WinAnsiEncoding"&&Bl!=="StandardEncoding"||(O=eu(O,function(wi,ki,po){return[ul(wi),ki,po]})),fn=rs(O),O=[];for(var ss,Zi,oa,La=0,sa=1,aa=Array.isArray(fn[0])?sa:La,la="",Kr=function(wi,ki,po){var $i="";return po instanceof vn?(po=typeof ut.angle=="number"?bn(po,new vn(1,0,0,1,wi,ki)):bn(new vn(1,0,0,1,wi,ki),po),K===R.ADVANCED&&(po=bn(new vn(1,0,0,-1,0,0),po)),$i=po.join(" ")+` Tm
`):$i=ve(wi)+" "+ve(ki)+` Td
`,$i},Ws=0;Ws<fn.length;Ws++){switch(la="",aa){case sa:oa=(Ts?"<":"(")+fn[Ws][0]+(Ts?">":")"),ss=parseFloat(fn[Ws][1]),Zi=parseFloat(fn[Ws][2]);break;case La:oa=(Ts?"<":"(")+fn[Ws]+(Ts?">":")"),ss=lr(_e),Zi=co(Ye)}wa!==void 0&&wa[Ws]!==void 0&&(la=wa[Ws]+` Tw
`),Ws===0?O.push(la+Kr(ss,Zi,hi)+oa):aa===La?O.push(la+oa):aa===sa&&O.push(la+Kr(ss,Zi,hi)+oa)}O=aa===La?O.join(` Tj
T* `):O.join(` Tj
`),O+=` Tj
`;var No=`BT
/`;return No+=ot+" "+Ze+` Tf
`,No+=ve(Ze*Ur)+` TL
`,No+=ta+`
`,No+=bo,No+=O,de(No+="ET"),w[ot]=!0,_i};var ts=y.__private__.clip=y.clip=function(O){return de(O==="evenodd"?"W*":"W"),this};y.clipEvenOdd=function(){return ts("evenodd")},y.__private__.discardPath=y.discardPath=function(){return de("n"),this};var zr=y.__private__.isValidStyle=function(O){var _e=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(O)!==-1&&(_e=!0),_e};y.__private__.setDefaultPathOperation=y.setDefaultPathOperation=function(O){return zr(O)&&(d=O),this};var Ml=y.__private__.getStyle=y.getStyle=function(O){var _e=d;switch(O){case"D":case"S":_e="S";break;case"F":_e="f";break;case"FD":case"DF":_e="B";break;case"f":case"f*":case"B":case"B*":_e=O}return _e},fi=y.close=function(){return de("h"),this};y.stroke=function(){return de("S"),this},y.fill=function(O){return ns("f",O),this},y.fillEvenOdd=function(O){return ns("f*",O),this},y.fillStroke=function(O){return ns("B",O),this},y.fillStrokeEvenOdd=function(O){return ns("B*",O),this};var ns=function(O,_e){so(_e)==="object"?wu(_e,O):de(O)},to=function(O){O===null||K===R.ADVANCED&&O===void 0||(O=Ml(O),de(O))};function Ua(O,_e,Ye,ut,Lt){var Ut=new Hh(_e||this.boundingBox,Ye||this.xStep,ut||this.yStep,this.gState,Lt||this.matrix);Ut.stream=this.stream;var fn=O+"$$"+this.cloneIndex+++"$$";return Hn(fn,Ut),Ut}var wu=function(O,_e){var Ye=jn[O.key],ut=En[Ye];if(ut instanceof Yf)de("q"),de(Al(_e)),ut.gState&&y.setGState(ut.gState),de(O.matrix.toString()+" cm"),de("/"+Ye+" sh"),de("Q");else if(ut instanceof Hh){var Lt=new vn(1,0,0,-1,0,_a());O.matrix&&(Lt=Lt.multiply(O.matrix||Ht),Ye=Ua.call(ut,O.key,O.boundingBox,O.xStep,O.yStep,Lt).id),de("q"),de("/Pattern cs"),de("/"+Ye+" scn"),ut.gState&&y.setGState(ut.gState),de(_e),de("Q")}},Al=function(O){switch(O){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Er=y.moveTo=function(O,_e){return de(ve(D(O))+" "+ve($(_e))+" m"),this},Hr=y.lineTo=function(O,_e){return de(ve(D(O))+" "+ve($(_e))+" l"),this},Va=y.curveTo=function(O,_e,Ye,ut,Lt,Ut){return de([ve(D(O)),ve($(_e)),ve(D(Ye)),ve($(ut)),ve(D(Lt)),ve($(Ut)),"c"].join(" ")),this};y.__private__.line=y.line=function(O,_e,Ye,ut,Lt){if(isNaN(O)||isNaN(_e)||isNaN(Ye)||isNaN(ut)||!zr(Lt))throw new Error("Invalid arguments passed to jsPDF.line");return K===R.COMPAT?this.lines([[Ye-O,ut-_e]],O,_e,[1,1],Lt||"S"):this.lines([[Ye-O,ut-_e]],O,_e,[1,1]).stroke()},y.__private__.lines=y.lines=function(O,_e,Ye,ut,Lt,Ut){var fn,Dn,zn,ir,_r,$r,Gi,hi,_i,ho,bo,Ts;if(typeof O=="number"&&(Ts=Ye,Ye=_e,_e=O,O=Ts),ut=ut||[1,1],Ut=Ut||!1,isNaN(_e)||isNaN(Ye)||!Array.isArray(O)||!Array.isArray(ut)||!zr(Lt)||typeof Ut!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Er(_e,Ye),fn=ut[0],Dn=ut[1],ir=O.length,ho=_e,bo=Ye,zn=0;zn<ir;zn++)(_r=O[zn]).length===2?(ho=_r[0]*fn+ho,bo=_r[1]*Dn+bo,Hr(ho,bo)):($r=_r[0]*fn+ho,Gi=_r[1]*Dn+bo,hi=_r[2]*fn+ho,_i=_r[3]*Dn+bo,ho=_r[4]*fn+ho,bo=_r[5]*Dn+bo,Va($r,Gi,hi,_i,ho,bo));return Ut&&fi(),to(Lt),this},y.path=function(O){for(var _e=0;_e<O.length;_e++){var Ye=O[_e],ut=Ye.c;switch(Ye.op){case"m":Er(ut[0],ut[1]);break;case"l":Hr(ut[0],ut[1]);break;case"c":Va.apply(this,ut);break;case"h":fi()}}return this},y.__private__.rect=y.rect=function(O,_e,Ye,ut,Lt){if(isNaN(O)||isNaN(_e)||isNaN(Ye)||isNaN(ut)||!zr(Lt))throw new Error("Invalid arguments passed to jsPDF.rect");return K===R.COMPAT&&(ut=-ut),de([ve(D(O)),ve($(_e)),ve(D(Ye)),ve(D(ut)),"re"].join(" ")),to(Lt),this},y.__private__.triangle=y.triangle=function(O,_e,Ye,ut,Lt,Ut,fn){if(isNaN(O)||isNaN(_e)||isNaN(Ye)||isNaN(ut)||isNaN(Lt)||isNaN(Ut)||!zr(fn))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Ye-O,ut-_e],[Lt-Ye,Ut-ut],[O-Lt,_e-Ut]],O,_e,[1,1],fn,!0),this},y.__private__.roundedRect=y.roundedRect=function(O,_e,Ye,ut,Lt,Ut,fn){if(isNaN(O)||isNaN(_e)||isNaN(Ye)||isNaN(ut)||isNaN(Lt)||isNaN(Ut)||!zr(fn))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Dn=4/3*(Math.SQRT2-1);return Lt=Math.min(Lt,.5*Ye),Ut=Math.min(Ut,.5*ut),this.lines([[Ye-2*Lt,0],[Lt*Dn,0,Lt,Ut-Ut*Dn,Lt,Ut],[0,ut-2*Ut],[0,Ut*Dn,-Lt*Dn,Ut,-Lt,Ut],[2*Lt-Ye,0],[-Lt*Dn,0,-Lt,-Ut*Dn,-Lt,-Ut],[0,2*Ut-ut],[0,-Ut*Dn,Lt*Dn,-Ut,Lt,-Ut]],O+Lt,_e,[1,1],fn,!0),this},y.__private__.ellipse=y.ellipse=function(O,_e,Ye,ut,Lt){if(isNaN(O)||isNaN(_e)||isNaN(Ye)||isNaN(ut)||!zr(Lt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ut=4/3*(Math.SQRT2-1)*Ye,fn=4/3*(Math.SQRT2-1)*ut;return Er(O+Ye,_e),Va(O+Ye,_e-fn,O+Ut,_e-ut,O,_e-ut),Va(O-Ut,_e-ut,O-Ye,_e-fn,O-Ye,_e),Va(O-Ye,_e+fn,O-Ut,_e+ut,O,_e+ut),Va(O+Ut,_e+ut,O+Ye,_e+fn,O+Ye,_e),to(Lt),this},y.__private__.circle=y.circle=function(O,_e,Ye,ut){if(isNaN(O)||isNaN(_e)||isNaN(Ye)||!zr(ut))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(O,_e,Ye,Ye,ut)},y.setFont=function(O,_e,Ye){return Ye&&(_e=fe(_e,Ye)),ot=eo(O,_e,{disableWarning:!1}),this};var Yu=y.__private__.getFont=y.getFont=function(){return Ln[eo.apply(y,arguments)]};y.__private__.getFontList=y.getFontList=function(){var O,_e,Ye={};for(O in Nn)if(Nn.hasOwnProperty(O))for(_e in Ye[O]=[],Nn[O])Nn[O].hasOwnProperty(_e)&&Ye[O].push(_e);return Ye},y.addFont=function(O,_e,Ye,ut,Lt){var Ut=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ut.indexOf(arguments[3])!==-1?Lt=arguments[3]:arguments[3]&&Ut.indexOf(arguments[3])==-1&&(Ye=fe(Ye,ut)),Lt=Lt||"Identity-H",jo.call(this,O,_e,Ye,Lt)};var kl,Jl=e.lineWidth||.200025,ol=y.__private__.getLineWidth=y.getLineWidth=function(){return Jl},Tl=y.__private__.setLineWidth=y.setLineWidth=function(O){return Jl=O,de(ve(D(O))+" w"),this};y.__private__.setLineDash=kr.API.setLineDash=kr.API.setLineDashPattern=function(O,_e){if(O=O||[],_e=_e||0,isNaN(_e)||!Array.isArray(O))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return O=O.map(function(Ye){return ve(D(Ye))}).join(" "),_e=ve(D(_e)),de("["+O+"] "+_e+" d"),this};var Xl=y.__private__.getLineHeight=y.getLineHeight=function(){return Ze*kl};y.__private__.getLineHeight=y.getLineHeight=function(){return Ze*kl};var Zr=y.__private__.setLineHeightFactor=y.setLineHeightFactor=function(O){return typeof(O=O||1.15)=="number"&&(kl=O),this},uo=y.__private__.getLineHeightFactor=y.getLineHeightFactor=function(){return kl};Zr(e.lineHeight);var lr=y.__private__.getHorizontalCoordinate=function(O){return D(O)},co=y.__private__.getVerticalCoordinate=function(O){return K===R.ADVANCED?O:gr[H].mediaBox.topRightY-gr[H].mediaBox.bottomLeftY-D(O)},sl=y.__private__.getHorizontalCoordinateString=y.getHorizontalCoordinateString=function(O){return ve(lr(O))},ya=y.__private__.getVerticalCoordinateString=y.getVerticalCoordinateString=function(O){return ve(co(O))},qi=e.strokeColor||"0 G";y.__private__.getStrokeColor=y.getDrawColor=function(){return Qn(qi)},y.__private__.setStrokeColor=y.setDrawColor=function(O,_e,Ye,ut){return qi=Pi({ch1:O,ch2:_e,ch3:Ye,ch4:ut,pdfColorType:"draw",precision:2}),de(qi),this};var Ql=e.fillColor||"0 g";y.__private__.getFillColor=y.getFillColor=function(){return Qn(Ql)},y.__private__.setFillColor=y.setFillColor=function(O,_e,Ye,ut){return Ql=Pi({ch1:O,ch2:_e,ch3:Ye,ch4:ut,pdfColorType:"fill",precision:2}),de(Ql),this};var ta=e.textColor||"0 g",Nl=y.__private__.getTextColor=y.getTextColor=function(){return Qn(ta)};y.__private__.setTextColor=y.setTextColor=function(O,_e,Ye,ut){return ta=Pi({ch1:O,ch2:_e,ch3:Ye,ch4:ut,pdfColorType:"text",precision:3}),this};var Dl=e.charSpace,Fs=y.__private__.getCharSpace=y.getCharSpace=function(){return parseFloat(Dl||0)};y.__private__.setCharSpace=y.setCharSpace=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Dl=O,this};var Il=0;y.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},y.__private__.setLineCap=y.setLineCap=function(O){var _e=y.CapJoinStyles[O];if(_e===void 0)throw new Error("Line cap style of '"+O+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Il=_e,de(_e+" J"),this};var vi=0;y.__private__.setLineJoin=y.setLineJoin=function(O){var _e=y.CapJoinStyles[O];if(_e===void 0)throw new Error("Line join style of '"+O+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return vi=_e,de(_e+" j"),this},y.__private__.setLineMiterLimit=y.__private__.setMiterLimit=y.setLineMiterLimit=y.setMiterLimit=function(O){if(O=O||0,isNaN(O))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return de(ve(D(O))+" M"),this},y.GState=bm,y.setGState=function(O){(O=typeof O=="string"?Mn[Yn[O]]:Ju(null,O)).equals(br)||(de("/"+O.id+" gs"),br=O)};var Ju=function(O,_e){if(!O||!Yn[O]){var Ye=!1;for(var ut in Mn)if(Mn.hasOwnProperty(ut)&&Mn[ut].equals(_e)){Ye=!0;break}if(Ye)_e=Mn[ut];else{var Lt="GS"+(Object.keys(Mn).length+1).toString(10);Mn[Lt]=_e,_e.id=Lt}return O&&(Yn[O]=_e.id),ii.publish("addGState",_e),_e}};y.addGState=function(O,_e){return Ju(O,_e),this},y.saveGraphicsState=function(){return de("q"),ar.push({key:ot,size:Ze,color:ta}),this},y.restoreGraphicsState=function(){de("Q");var O=ar.pop();return ot=O.key,Ze=O.size,ta=O.color,br=null,this},y.setCurrentTransformationMatrix=function(O){return de(O.toString()+" cm"),this},y.comment=function(O){return de("#"+O),this};var ko=function(O,_e){var Ye=O||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Ye},set:function(Ut){isNaN(Ut)||(Ye=parseFloat(Ut))}});var ut=_e||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ut},set:function(Ut){isNaN(Ut)||(ut=parseFloat(Ut))}});var Lt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Lt},set:function(Ut){Lt=Ut.toString()}}),this},Hs=function(O,_e,Ye,ut){ko.call(this,O,_e),this.type="rect";var Lt=Ye||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Lt},set:function(fn){isNaN(fn)||(Lt=parseFloat(fn))}});var Ut=ut||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ut},set:function(fn){isNaN(fn)||(Ut=parseFloat(fn))}}),this},Ol=function(){this.page=Or,this.currentPage=H,this.pages=Me.slice(0),this.pagesContext=gr.slice(0),this.x=Ft,this.y=Qt,this.matrix=Bn,this.width=yi(H),this.height=_a(H),this.outputDestination=ce,this.id="",this.objectNumber=-1};Ol.prototype.restore=function(){Or=this.page,H=this.currentPage,gr=this.pagesContext,Me=this.pages,Ft=this.x,Qt=this.y,Bn=this.matrix,ks(H,this.width),fo(H,this.height),ce=this.outputDestination};var qs=function(O,_e,Ye,ut,Lt){xn.push(new Ol),Or=H=0,Me=[],Ft=O,Qt=_e,Bn=Lt,Ai([Ye,ut])},al=function(O){if($t[O])xn.pop().restore();else{var _e=new Ol,Ye="Xo"+(Object.keys(Qe).length+1).toString(10);_e.id=Ye,$t[O]=Ye,Qe[Ye]=_e,ii.publish("addFormObject",_e),xn.pop().restore()}};for(var ll in y.beginFormObject=function(O,_e,Ye,ut,Lt){return qs(O,_e,Ye,ut,Lt),this},y.endFormObject=function(O){return al(O),this},y.doFormObject=function(O,_e){var Ye=Qe[$t[O]];return de("q"),de(_e.toString()+" cm"),de("/"+Ye.id+" Do"),de("Q"),this},y.getFormObject=function(O){var _e=Qe[$t[O]];return{x:_e.x,y:_e.y,width:_e.width,height:_e.height,matrix:_e.matrix}},y.save=function(O,_e){return O=O||"generated.pdf",(_e=_e||{}).returnPromise=_e.returnPromise||!1,_e.returnPromise===!1?(Zf(As(jr()),O),typeof Zf.unload=="function"&&Dr.setTimeout&&setTimeout(Zf.unload,911),this):new Promise(function(Ye,ut){try{var Lt=Zf(As(jr()),O);typeof Zf.unload=="function"&&Dr.setTimeout&&setTimeout(Zf.unload,911),Ye(Lt)}catch(Ut){ut(Ut.message)}})},kr.API)kr.API.hasOwnProperty(ll)&&(ll==="events"&&kr.API.events.length?function(O,_e){var Ye,ut,Lt;for(Lt=_e.length-1;Lt!==-1;Lt--)Ye=_e[Lt][0],ut=_e[Lt][1],O.subscribe.apply(O,[Ye].concat(typeof ut=="function"?[ut]:ut))}(ii,kr.API.events):y[ll]=kr.API[ll]);var yi=y.getPageWidth=function(O){return(gr[O=O||H].mediaBox.topRightX-gr[O].mediaBox.bottomLeftX)/rt},ks=y.setPageWidth=function(O,_e){gr[O].mediaBox.topRightX=_e*rt+gr[O].mediaBox.bottomLeftX},_a=y.getPageHeight=function(O){return(gr[O=O||H].mediaBox.topRightY-gr[O].mediaBox.bottomLeftY)/rt},fo=y.setPageHeight=function(O,_e){gr[O].mediaBox.topRightY=_e*rt+gr[O].mediaBox.bottomLeftY};return y.internal={pdfEscape:oi,getStyle:Ml,getFont:Yu,getFontSize:He,getCharSpace:Fs,getTextColor:Nl,getLineHeight:Xl,getLineHeightFactor:uo,getLineWidth:ol,write:We,getHorizontalCoordinate:lr,getVerticalCoordinate:co,getCoordinateString:sl,getVerticalCoordinateString:ya,collections:{},newObject:St,newAdditionalObject:Qr,newObjectDeferred:mt,newObjectDeferredBegin:wn,getFilters:Sr,putStream:Pr,events:ii,scaleFactor:rt,pageSize:{getWidth:function(){return yi(H)},setWidth:function(O){ks(H,O)},getHeight:function(){return _a(H)},setHeight:function(O){fo(H,O)}},encryptionOptions:m,encryption:Fi,getEncryptor:Pl,output:lo,getNumberOfPages:fr,pages:Me,out:de,f2:J,f3:T,getPageInfo:$a,getPageInfoByObjId:vr,getCurrentPageInfo:yr,getPDFVersion:k,Point:ko,Rectangle:Hs,Matrix:vn,hasHotfix:es},Object.defineProperty(y.internal.pageSize,"width",{get:function(){return yi(H)},set:function(O){ks(H,O)},enumerable:!0,configurable:!0}),Object.defineProperty(y.internal.pageSize,"height",{get:function(){return _a(H)},set:function(O){fo(H,O)},enumerable:!0,configurable:!0}),cr.call(y,tt),ot="F1",ci(i,t),ii.publish("initialized"),y}$h.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},$h.prototype.toHexString=function(e){return e.split("").map(function(n){return("0"+(255&n.charCodeAt(0)).toString(16)).slice(-2)}).join("")},$h.prototype.hexToBytes=function(e){for(var n=[],t=0;t<e.length;t+=2)n.push(String.fromCharCode(parseInt(e.substr(t,2),16)));return n.join("")},$h.prototype.processOwnerPassword=function(e,n){return L1(x1(n).substr(0,5),e)},$h.prototype.encryptor=function(e,n){var t=x1(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&n,n>>8&255)).substr(0,10);return function(r){return L1(t,r)}},bm.prototype.equals=function(e){var n,t="id,objectNumber,equals";if(!e||so(e)!==so(this))return!1;var r=0;for(n in this)if(!(t.indexOf(n)>=0)){if(this.hasOwnProperty(n)&&!e.hasOwnProperty(n)||this[n]!==e[n])return!1;r++}for(n in e)e.hasOwnProperty(n)&&t.indexOf(n)<0&&r--;return r===0},kr.API={events:[]},kr.version="2.5.2";var fs=kr.API,vy=1,hh=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Nh=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Wr=function(e){return e.toFixed(2)},sf=function(e){return e.toFixed(5)};fs.__acroform__={};var Cl=function(e,n){e.prototype=Object.create(n.prototype),e.prototype.constructor=e},Ab=function(e){return e*vy},ac=function(e){var n=new Px,t=Xn.internal.getHeight(e)||0,r=Xn.internal.getWidth(e)||0;return n.BBox=[0,0,Number(Wr(r)),Number(Wr(t))],n},yF=fs.__acroform__.setBit=function(e,n){if(e=e||0,n=n||0,isNaN(e)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<n},_F=fs.__acroform__.clearBit=function(e,n){if(e=e||0,n=n||0,isNaN(e)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<n)},bF=fs.__acroform__.getBit=function(e,n){if(isNaN(e)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<n?1:0},Ls=fs.__acroform__.getBitForPdf=function(e,n){if(isNaN(e)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return bF(e,n-1)},Ss=fs.__acroform__.setBitForPdf=function(e,n){if(isNaN(e)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return yF(e,n-1)},Es=fs.__acroform__.clearBitForPdf=function(e,n){if(isNaN(e)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return _F(e,n-1)},wF=fs.__acroform__.calculateCoordinates=function(e,n){var t=n.internal.getHorizontalCoordinate,r=n.internal.getVerticalCoordinate,i=e[0],s=e[1],o=e[2],u=e[3],f={};return f.lowerLeft_X=t(i)||0,f.lowerLeft_Y=r(s+u)||0,f.upperRight_X=t(i+o)||0,f.upperRight_Y=r(s)||0,[Number(Wr(f.lowerLeft_X)),Number(Wr(f.lowerLeft_Y)),Number(Wr(f.upperRight_X)),Number(Wr(f.upperRight_Y))]},xF=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var n=[],t=e._V||e.DV,r=S1(e,t),i=e.scope.internal.getFont(e.fontName,e.fontStyle).id;n.push("/Tx BMC"),n.push("q"),n.push("BT"),n.push(e.scope.__private__.encodeColorString(e.color)),n.push("/"+i+" "+Wr(r.fontSize)+" Tf"),n.push("1 0 0 1 0 0 Tm"),n.push(r.text),n.push("ET"),n.push("Q"),n.push("EMC");var s=ac(e);return s.scope=e.scope,s.stream=n.join(`
`),s}},S1=function(e,n){var t=e.fontSize===0?e.maxFontSize:e.fontSize,r={text:"",fontSize:""},i=(n=(n=n.substr(0,1)=="("?n.substr(1):n).substr(n.length-1)==")"?n.substr(0,n.length-1):n).split(" ");i=e.multiline?i.map(function(T){return T.split(`
`)}):i.map(function(T){return[T]});var s=t,o=Xn.internal.getHeight(e)||0;o=o<0?-o:o;var u=Xn.internal.getWidth(e)||0;u=u<0?-u:u;var f=function(T,D,B){if(T+1<i.length){var $=D+" "+i[T+1][0];return bg($,e,B).width<=u-4}return!1};s++;e:for(;s>0;){n="",s--;var d,m,_=bg("3",e,s).height,w=e.multiline?o-s:(o-_)/2,y=w+=2,M=0,k=0,F=0;if(s<=0){n=`(...) Tj
`,n+="% Width of Text: "+bg(n,e,s=12).width+", FieldWidth:"+u+`
`;break}for(var I="",R=0,K=0;K<i.length;K++)if(i.hasOwnProperty(K)){var ee=!1;if(i[K].length!==1&&F!==i[K].length-1){if((_+2)*(R+2)+2>o)continue e;I+=i[K][F],ee=!0,k=K,K--}else{I=(I+=i[K][F]+" ").substr(I.length-1)==" "?I.substr(0,I.length-1):I;var he=parseInt(K),fe=f(he,I,s),ve=K>=i.length-1;if(fe&&!ve){I+=" ",F=0;continue}if(fe||ve){if(ve)k=he;else if(e.multiline&&(_+2)*(R+2)+2>o)continue e}else{if(!e.multiline||(_+2)*(R+2)+2>o)continue e;k=he}}for(var z="",U=M;U<=k;U++){var J=i[U];if(e.multiline){if(U===k){z+=J[F]+" ",F=(F+1)%J.length;continue}if(U===M){z+=J[J.length-1]+" ";continue}}z+=J[0]+" "}switch(z=z.substr(z.length-1)==" "?z.substr(0,z.length-1):z,m=bg(z,e,s).width,e.textAlign){case"right":d=u-m-2;break;case"center":d=(u-m)/2;break;case"left":default:d=2}n+=Wr(d)+" "+Wr(y)+` Td
`,n+="("+hh(z)+`) Tj
`,n+=-Wr(d)+` 0 Td
`,y=-(s+2),m=0,M=ee?k:k+1,R++,I=""}break}return r.text=n,r.fontSize=s,r},bg=function(e,n,t){var r=n.scope.internal.getFont(n.fontName,n.fontStyle),i=n.scope.getStringUnitWidth(e,{font:r,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:n.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:i}},LF={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},SF=function(e,n){var t={type:"reference",object:e};n.internal.getPageInfo(e.page).pageContext.annotations.find(function(r){return r.type===t.type&&r.object===t.object})===void 0&&n.internal.getPageInfo(e.page).pageContext.annotations.push(t)},EF=function(e,n){for(var t in e)if(e.hasOwnProperty(t)){var r=t,i=e[t];n.internal.newObjectDeferredBegin(i.objId,!0),so(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete e[r]}},CF=function(e,n){if(n.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Zu.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(LF)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");vy=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new Mx,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in r)if(r.hasOwnProperty(i)){var s=r[i];s.objId=void 0,s.hasAnnotation&&SF(s,t)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(t){(function(r,i){var s=!r;for(var o in r||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(o)){var u=r[o],f=[],d=u.Rect;if(u.Rect&&(u.Rect=wF(u.Rect,i)),i.internal.newObjectDeferredBegin(u.objId,!0),u.DA=Xn.createDefaultAppearanceStream(u),so(u)==="object"&&typeof u.getKeyValueListForStream=="function"&&(f=u.getKeyValueListForStream()),u.Rect=d,u.hasAppearanceStream&&!u.appearanceStreamContent){var m=xF(u);f.push({key:"AP",value:"<</N "+m+">>"}),i.internal.acroformPlugin.xForms.push(m)}if(u.appearanceStreamContent){var _="";for(var w in u.appearanceStreamContent)if(u.appearanceStreamContent.hasOwnProperty(w)){var y=u.appearanceStreamContent[w];if(_+="/"+w+" ",_+="<<",Object.keys(y).length>=1||Array.isArray(y)){for(var o in y)if(y.hasOwnProperty(o)){var M=y[o];typeof M=="function"&&(M=M.call(i,u)),_+="/"+o+" "+M+" ",i.internal.acroformPlugin.xForms.indexOf(M)>=0||i.internal.acroformPlugin.xForms.push(M)}}else typeof(M=y)=="function"&&(M=M.call(i,u)),_+="/"+o+" "+M,i.internal.acroformPlugin.xForms.indexOf(M)>=0||i.internal.acroformPlugin.xForms.push(M);_+=">>"}f.push({key:"AP",value:`<<
`+_+">>"})}i.internal.putStream({additionalKeyValues:f,objectId:u.objId}),i.internal.out("endobj")}s&&EF(i.internal.acroformPlugin.xForms,i)})(t,e)}),e.internal.acroformPlugin.isInitialized=!0}},Cx=fs.__acroform__.arrayToPdfArray=function(e,n,t){var r=function(o){return o};if(Array.isArray(e)){for(var i="[",s=0;s<e.length;s++)switch(s!==0&&(i+=" "),so(e[s])){case"boolean":case"number":case"object":i+=e[s].toString();break;case"string":e[s].substr(0,1)!=="/"?(n!==void 0&&t&&(r=t.internal.getEncryptor(n)),i+="("+hh(r(e[s].toString()))+")"):i+=e[s].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},hv=function(e,n,t){var r=function(i){return i};return n!==void 0&&t&&(r=t.internal.getEncryptor(n)),(e=e||"").toString(),e="("+hh(r(e))+")"},hc=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};hc.prototype.toString=function(){return this.objId+" 0 R"},hc.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},hc.prototype.getKeyValueListForStream=function(){var e=[],n=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var t in n)if(Object.getOwnPropertyDescriptor(this,n[t]).configurable===!1){var r=n[t],i=this[r];i&&(Array.isArray(i)?e.push({key:r,value:Cx(i,this.objId,this.scope)}):i instanceof hc?(i.scope=this.scope,e.push({key:r,value:i.objId+" 0 R"})):typeof i!="function"&&e.push({key:r,value:i}))}return e};var Px=function(){hc.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,n=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){e=t.trim()},get:function(){return e||null}})};Cl(Px,hc);var Mx=function(){hc.call(this);var e,n=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return n.length>0?n:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return n}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var t=function(r){return r};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+hh(t(e))+")"}},set:function(t){e=t}})};Cl(Mx,hc);var Zu=function e(){hc.call(this);var n=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return n},set:function(I){if(isNaN(I))throw new Error('Invalid value "'+I+'" for attribute F supplied.');n=I}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Ls(n,3)},set:function(I){I?this.F=Ss(n,3):this.F=Es(n,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(I){if(isNaN(I))throw new Error('Invalid value "'+I+'" for attribute Ff supplied.');t=I}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(I){r=I!==void 0?I:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(I){r[0]=I}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(I){r[1]=I}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(I){r[2]=I}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(I){r[3]=I}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(I){switch(I){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=I;break;default:throw new Error('Invalid value "'+I+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof wm)return;s="FieldObject"+e.FieldNum++}var I=function(R){return R};return this.scope&&(I=this.scope.internal.getEncryptor(this.objId)),"("+hh(I(s))+")"},set:function(I){s=I.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(I){s=I}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(I){o=I}});var u="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return u},set:function(I){u=I}});var f=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return f},set:function(I){f=I}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/vy:d},set:function(I){d=I}});var m="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return m},set:function(I){m=I}});var _="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!_||this instanceof wm||this instanceof rh))return hv(_,this.objId,this.scope)},set:function(I){I=I.toString(),_=I}});var w=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(w)return this instanceof Xs?w:hv(w,this.objId,this.scope)},set:function(I){I=I.toString(),w=this instanceof Xs?I:I.substr(0,1)==="("?Nh(I.substr(1,I.length-2)):Nh(I)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Xs?Nh(w.substr(1,w.length-1)):w},set:function(I){I=I.toString(),w=this instanceof Xs?"/"+I:I}});var y=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(y)return y},set:function(I){this.V=I}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(y)return this instanceof Xs?y:hv(y,this.objId,this.scope)},set:function(I){I=I.toString(),y=this instanceof Xs?I:I.substr(0,1)==="("?Nh(I.substr(1,I.length-2)):Nh(I)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Xs?Nh(y.substr(1,y.length-1)):y},set:function(I){I=I.toString(),y=this instanceof Xs?"/"+I:I}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var M,k=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return k},set:function(I){I=!!I,k=I}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(M)return M},set:function(I){M=I}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Ls(this.Ff,1)},set:function(I){I?this.Ff=Ss(this.Ff,1):this.Ff=Es(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Ls(this.Ff,2)},set:function(I){I?this.Ff=Ss(this.Ff,2):this.Ff=Es(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Ls(this.Ff,3)},set:function(I){I?this.Ff=Ss(this.Ff,3):this.Ff=Es(this.Ff,3)}});var F=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(F!==null)return F},set:function(I){if([0,1,2].indexOf(I)===-1)throw new Error('Invalid value "'+I+'" for attribute Q supplied.');F=I}}),Object.defineProperty(this,"textAlign",{get:function(){var I;switch(F){case 0:default:I="left";break;case 1:I="center";break;case 2:I="right"}return I},configurable:!0,enumerable:!0,set:function(I){switch(I){case"right":case 2:F=2;break;case"center":case 1:F=1;break;case"left":case 0:default:F=0}}})};Cl(Zu,hc);var Qh=function(){Zu.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){e=t}});var n=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Cx(n,this.objId,this.scope)},set:function(t){var r,i;i=[],typeof(r=t)=="string"&&(i=function(s,o,u){u||(u=1);for(var f,d=[];f=o.exec(s);)d.push(f[u]);return d}(r,/\((.*?)\)/g)),n=i}}),this.getOptions=function(){return n},this.setOptions=function(t){n=t,this.sort&&n.sort()},this.addOption=function(t){t=(t=t||"").toString(),n.push(t),this.sort&&n.sort()},this.removeOption=function(t,r){for(r=r||!1,t=(t=t||"").toString();n.indexOf(t)!==-1&&(n.splice(n.indexOf(t),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Ls(this.Ff,18)},set:function(t){t?this.Ff=Ss(this.Ff,18):this.Ff=Es(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Ls(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=Ss(this.Ff,19):this.Ff=Es(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Ls(this.Ff,20)},set:function(t){t?(this.Ff=Ss(this.Ff,20),n.sort()):this.Ff=Es(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ls(this.Ff,22)},set:function(t){t?this.Ff=Ss(this.Ff,22):this.Ff=Es(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ls(this.Ff,23)},set:function(t){t?this.Ff=Ss(this.Ff,23):this.Ff=Es(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Ls(this.Ff,27)},set:function(t){t?this.Ff=Ss(this.Ff,27):this.Ff=Es(this.Ff,27)}}),this.hasAppearanceStream=!1};Cl(Qh,Zu);var ed=function(){Qh.call(this),this.fontName="helvetica",this.combo=!1};Cl(ed,Qh);var td=function(){ed.call(this),this.combo=!0};Cl(td,ed);var zg=function(){td.call(this),this.edit=!0};Cl(zg,td);var Xs=function(){Zu.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Ls(this.Ff,15)},set:function(t){t?this.Ff=Ss(this.Ff,15):this.Ff=Es(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Ls(this.Ff,16)},set:function(t){t?this.Ff=Ss(this.Ff,16):this.Ff=Es(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Ls(this.Ff,17)},set:function(t){t?this.Ff=Ss(this.Ff,17):this.Ff=Es(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Ls(this.Ff,26)},set:function(t){t?this.Ff=Ss(this.Ff,26):this.Ff=Es(this.Ff,26)}});var e,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(s){return s};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(n).length!==0){var r,i=[];for(r in i.push("<<"),n)i.push("/"+r+" ("+hh(t(n[r]))+")");return i.push(">>"),i.join(`
`)}},set:function(t){so(t)==="object"&&(n=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(t){typeof t=="string"&&(n.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(t){e="/"+t}})};Cl(Xs,Zu);var $g=function(){Xs.call(this),this.pushButton=!0};Cl($g,Xs);var nd=function(){Xs.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(n){e=n!==void 0?n:[]}})};Cl(nd,Xs);var wm=function(){var e,n;Zu.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(i){e=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return n},set:function(i){n=i}});var t,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(u){return u};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),r)o.push("/"+s+" ("+hh(i(r[s]))+")");return o.push(">>"),o.join(`
`)},set:function(i){so(i)==="object"&&(r=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(i){typeof i=="string"&&(r.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(i){t="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Xn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Cl(wm,Zu),nd.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var n in this.Kids)if(this.Kids.hasOwnProperty(n)){var t=this.Kids[n];t.appearanceStreamContent=e.createAppearanceStream(t.optionName),t.caption=e.getCA()}},nd.prototype.createOption=function(e){var n=new wm;return n.Parent=this,n.optionName=e,this.Kids.push(n),PF.call(this.scope,n),n};var Ug=function(){Xs.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Xn.CheckBox.createAppearanceStream()};Cl(Ug,Xs);var rh=function(){Zu.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Ls(this.Ff,13)},set:function(n){n?this.Ff=Ss(this.Ff,13):this.Ff=Es(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ls(this.Ff,21)},set:function(n){n?this.Ff=Ss(this.Ff,21):this.Ff=Es(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ls(this.Ff,23)},set:function(n){n?this.Ff=Ss(this.Ff,23):this.Ff=Es(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Ls(this.Ff,24)},set:function(n){n?this.Ff=Ss(this.Ff,24):this.Ff=Es(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Ls(this.Ff,25)},set:function(n){n?this.Ff=Ss(this.Ff,25):this.Ff=Es(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Ls(this.Ff,26)},set:function(n){n?this.Ff=Ss(this.Ff,26):this.Ff=Es(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(n){Number.isInteger(n)&&(e=n)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Cl(rh,Zu);var Vg=function(){rh.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Ls(this.Ff,14)},set:function(e){e?this.Ff=Ss(this.Ff,14):this.Ff=Es(this.Ff,14)}}),this.password=!0};Cl(Vg,rh);var Xn={CheckBox:{createAppearanceStream:function(){return{N:{On:Xn.CheckBox.YesNormal},D:{On:Xn.CheckBox.YesPushDown,Off:Xn.CheckBox.OffPushDown}}},YesPushDown:function(e){var n=ac(e);n.scope=e.scope;var t=[],r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),s=S1(e,e.caption);return t.push("0.749023 g"),t.push("0 0 "+Wr(Xn.internal.getWidth(e))+" "+Wr(Xn.internal.getHeight(e))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+r+" "+Wr(s.fontSize)+" Tf "+i),t.push("BT"),t.push(s.text),t.push("ET"),t.push("Q"),t.push("EMC"),n.stream=t.join(`
`),n},YesNormal:function(e){var n=ac(e);n.scope=e.scope;var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color),i=[],s=Xn.internal.getHeight(e),o=Xn.internal.getWidth(e),u=S1(e,e.caption);return i.push("1 g"),i.push("0 0 "+Wr(o)+" "+Wr(s)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Wr(o-1)+" "+Wr(s-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+t+" "+Wr(u.fontSize)+" Tf "+r),i.push(u.text),i.push("ET"),i.push("Q"),n.stream=i.join(`
`),n},OffPushDown:function(e){var n=ac(e);n.scope=e.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Wr(Xn.internal.getWidth(e))+" "+Wr(Xn.internal.getHeight(e))+" re"),t.push("f"),n.stream=t.join(`
`),n}},RadioButton:{Circle:{createAppearanceStream:function(e){var n={D:{Off:Xn.RadioButton.Circle.OffPushDown},N:{}};return n.N[e]=Xn.RadioButton.Circle.YesNormal,n.D[e]=Xn.RadioButton.Circle.YesPushDown,n},getCA:function(){return"l"},YesNormal:function(e){var n=ac(e);n.scope=e.scope;var t=[],r=Xn.internal.getWidth(e)<=Xn.internal.getHeight(e)?Xn.internal.getWidth(e)/4:Xn.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var i=Xn.internal.Bezier_C,s=Number((r*i).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+sf(Xn.internal.getWidth(e)/2)+" "+sf(Xn.internal.getHeight(e)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),t.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),t.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),t.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),t.push("f"),t.push("Q"),n.stream=t.join(`
`),n},YesPushDown:function(e){var n=ac(e);n.scope=e.scope;var t=[],r=Xn.internal.getWidth(e)<=Xn.internal.getHeight(e)?Xn.internal.getWidth(e)/4:Xn.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),s=Number((i*Xn.internal.Bezier_C).toFixed(5)),o=Number((r*Xn.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+sf(Xn.internal.getWidth(e)/2)+" "+sf(Xn.internal.getHeight(e)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),t.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),t.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),t.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+sf(Xn.internal.getWidth(e)/2)+" "+sf(Xn.internal.getHeight(e)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),t.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),t.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),t.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),t.push("f"),t.push("Q"),n.stream=t.join(`
`),n},OffPushDown:function(e){var n=ac(e);n.scope=e.scope;var t=[],r=Xn.internal.getWidth(e)<=Xn.internal.getHeight(e)?Xn.internal.getWidth(e)/4:Xn.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),s=Number((i*Xn.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+sf(Xn.internal.getWidth(e)/2)+" "+sf(Xn.internal.getHeight(e)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),t.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),t.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),t.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),t.push("f"),t.push("Q"),n.stream=t.join(`
`),n}},Cross:{createAppearanceStream:function(e){var n={D:{Off:Xn.RadioButton.Cross.OffPushDown},N:{}};return n.N[e]=Xn.RadioButton.Cross.YesNormal,n.D[e]=Xn.RadioButton.Cross.YesPushDown,n},getCA:function(){return"8"},YesNormal:function(e){var n=ac(e);n.scope=e.scope;var t=[],r=Xn.internal.calculateCross(e);return t.push("q"),t.push("1 1 "+Wr(Xn.internal.getWidth(e)-2)+" "+Wr(Xn.internal.getHeight(e)-2)+" re"),t.push("W"),t.push("n"),t.push(Wr(r.x1.x)+" "+Wr(r.x1.y)+" m"),t.push(Wr(r.x2.x)+" "+Wr(r.x2.y)+" l"),t.push(Wr(r.x4.x)+" "+Wr(r.x4.y)+" m"),t.push(Wr(r.x3.x)+" "+Wr(r.x3.y)+" l"),t.push("s"),t.push("Q"),n.stream=t.join(`
`),n},YesPushDown:function(e){var n=ac(e);n.scope=e.scope;var t=Xn.internal.calculateCross(e),r=[];return r.push("0.749023 g"),r.push("0 0 "+Wr(Xn.internal.getWidth(e))+" "+Wr(Xn.internal.getHeight(e))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+Wr(Xn.internal.getWidth(e)-2)+" "+Wr(Xn.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Wr(t.x1.x)+" "+Wr(t.x1.y)+" m"),r.push(Wr(t.x2.x)+" "+Wr(t.x2.y)+" l"),r.push(Wr(t.x4.x)+" "+Wr(t.x4.y)+" m"),r.push(Wr(t.x3.x)+" "+Wr(t.x3.y)+" l"),r.push("s"),r.push("Q"),n.stream=r.join(`
`),n},OffPushDown:function(e){var n=ac(e);n.scope=e.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Wr(Xn.internal.getWidth(e))+" "+Wr(Xn.internal.getHeight(e))+" re"),t.push("f"),n.stream=t.join(`
`),n}}},createDefaultAppearanceStream:function(e){var n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,t=e.scope.__private__.encodeColorString(e.color);return"/"+n+" "+e.fontSize+" Tf "+t}};Xn.internal={Bezier_C:.551915024494,calculateCross:function(e){var n=Xn.internal.getWidth(e),t=Xn.internal.getHeight(e),r=Math.min(n,t);return{x1:{x:(n-r)/2,y:(t-r)/2+r},x2:{x:(n-r)/2+r,y:(t-r)/2},x3:{x:(n-r)/2,y:(t-r)/2},x4:{x:(n-r)/2+r,y:(t-r)/2+r}}}},Xn.internal.getWidth=function(e){var n=0;return so(e)==="object"&&(n=Ab(e.Rect[2])),n},Xn.internal.getHeight=function(e){var n=0;return so(e)==="object"&&(n=Ab(e.Rect[3])),n};var PF=fs.addField=function(e){if(CF(this,e),!(e instanceof Zu))throw new Error("Invalid argument passed to jsPDF.addField.");var n;return(n=e).scope.internal.acroformPlugin.printedOut&&(n.scope.internal.acroformPlugin.printedOut=!1,n.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),n.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(n),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};fs.AcroFormChoiceField=Qh,fs.AcroFormListBox=ed,fs.AcroFormComboBox=td,fs.AcroFormEditBox=zg,fs.AcroFormButton=Xs,fs.AcroFormPushButton=$g,fs.AcroFormRadioButton=nd,fs.AcroFormCheckBox=Ug,fs.AcroFormTextField=rh,fs.AcroFormPasswordField=Vg,fs.AcroFormAppearance=Xn,fs.AcroForm={ChoiceField:Qh,ListBox:ed,ComboBox:td,EditBox:zg,Button:Xs,PushButton:$g,RadioButton:nd,CheckBox:Ug,TextField:rh,PasswordField:Vg,Appearance:Xn},kr.AcroForm={ChoiceField:Qh,ListBox:ed,ComboBox:td,EditBox:zg,Button:Xs,PushButton:$g,RadioButton:nd,CheckBox:Ug,TextField:rh,PasswordField:Vg,Appearance:Xn};kr.AcroForm;function Ax(e){return e.reduce(function(n,t,r){return n[t]=r,n},{})}(function(e){e.__addimage__={};var n="UNKNOWN",t={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=e.__addimage__.getImageFileTypeByImageData=function(T,D){var B,$,W,G,oe,ie=n;if((D=D||n)==="RGBA"||T.data!==void 0&&T.data instanceof Uint8ClampedArray&&"height"in T&&"width"in T)return"RGBA";if(fe(T))for(oe in t)for(W=t[oe],B=0;B<W.length;B+=1){for(G=!0,$=0;$<W[B].length;$+=1)if(W[B][$]!==void 0&&W[B][$]!==T[$]){G=!1;break}if(G===!0){ie=oe;break}}else for(oe in t)for(W=t[oe],B=0;B<W.length;B+=1){for(G=!0,$=0;$<W[B].length;$+=1)if(W[B][$]!==void 0&&W[B][$]!==T.charCodeAt($)){G=!1;break}if(G===!0){ie=oe;break}}return ie===n&&D!==n&&(ie=D),ie},i=function T(D){for(var B=this.internal.write,$=this.internal.putStream,W=(0,this.internal.getFilters)();W.indexOf("FlateEncode")!==-1;)W.splice(W.indexOf("FlateEncode"),1);D.objectId=this.internal.newObject();var G=[];if(G.push({key:"Type",value:"/XObject"}),G.push({key:"Subtype",value:"/Image"}),G.push({key:"Width",value:D.width}),G.push({key:"Height",value:D.height}),D.colorSpace===F.INDEXED?G.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(D.palette.length/3-1)+" "+("sMask"in D&&D.sMask!==void 0?D.objectId+2:D.objectId+1)+" 0 R]"}):(G.push({key:"ColorSpace",value:"/"+D.colorSpace}),D.colorSpace===F.DEVICE_CMYK&&G.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),G.push({key:"BitsPerComponent",value:D.bitsPerComponent}),"decodeParameters"in D&&D.decodeParameters!==void 0&&G.push({key:"DecodeParms",value:"<<"+D.decodeParameters+">>"}),"transparency"in D&&Array.isArray(D.transparency)){for(var oe="",ie=0,we=D.transparency.length;ie<we;ie++)oe+=D.transparency[ie]+" "+D.transparency[ie]+" ";G.push({key:"Mask",value:"["+oe+"]"})}D.sMask!==void 0&&G.push({key:"SMask",value:D.objectId+1+" 0 R"});var Ce=D.filter!==void 0?["/"+D.filter]:void 0;if($({data:D.data,additionalKeyValues:G,alreadyAppliedFilters:Ce,objectId:D.objectId}),B("endobj"),"sMask"in D&&D.sMask!==void 0){var Te="/Predictor "+D.predictor+" /Colors 1 /BitsPerComponent "+D.bitsPerComponent+" /Columns "+D.width,Y={width:D.width,height:D.height,colorSpace:"DeviceGray",bitsPerComponent:D.bitsPerComponent,decodeParameters:Te,data:D.sMask};"filter"in D&&(Y.filter=D.filter),T.call(this,Y)}if(D.colorSpace===F.INDEXED){var H=this.internal.newObject();$({data:z(new Uint8Array(D.palette)),objectId:H}),B("endobj")}},s=function(){var T=this.internal.collections.addImage_images;for(var D in T)i.call(this,T[D])},o=function(){var T,D=this.internal.collections.addImage_images,B=this.internal.write;for(var $ in D)B("/I"+(T=D[$]).index,T.objectId,"0","R")},u=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",o))},f=function(){var T=this.internal.collections.addImage_images;return u.call(this),T},d=function(){return Object.keys(this.internal.collections.addImage_images).length},m=function(T){return typeof e["process"+T.toUpperCase()]=="function"},_=function(T){return so(T)==="object"&&T.nodeType===1},w=function(T,D){if(T.nodeName==="IMG"&&T.hasAttribute("src")){var B=""+T.getAttribute("src");if(B.indexOf("data:image/")===0)return ap(unescape(B).split("base64,").pop());var $=e.loadFile(B,!0);if($!==void 0)return $}if(T.nodeName==="CANVAS"){if(T.width===0||T.height===0)throw new Error("Given canvas must have data. Canvas width: "+T.width+", height: "+T.height);var W;switch(D){case"PNG":W="image/png";break;case"WEBP":W="image/webp";break;case"JPEG":case"JPG":default:W="image/jpeg"}return ap(T.toDataURL(W,1).split("base64,").pop())}},y=function(T){var D=this.internal.collections.addImage_images;if(D){for(var B in D)if(T===D[B].alias)return D[B]}},M=function(T,D,B){return T||D||(T=-96,D=-96),T<0&&(T=-1*B.width*72/T/this.internal.scaleFactor),D<0&&(D=-1*B.height*72/D/this.internal.scaleFactor),T===0&&(T=D*B.width/B.height),D===0&&(D=T*B.height/B.width),[T,D]},k=function(T,D,B,$,W,G){var oe=M.call(this,B,$,W),ie=this.internal.getCoordinateString,we=this.internal.getVerticalCoordinateString,Ce=f.call(this);if(B=oe[0],$=oe[1],Ce[W.index]=W,G){G*=Math.PI/180;var Te=Math.cos(G),Y=Math.sin(G),H=function(ue){return ue.toFixed(4)},Q=[H(Te),H(Y),H(-1*Y),H(Te),0,0,"cm"]}this.internal.write("q"),G?(this.internal.write([1,"0","0",1,ie(T),we(D+$),"cm"].join(" ")),this.internal.write(Q.join(" ")),this.internal.write([ie(B),"0","0",ie($),"0","0","cm"].join(" "))):this.internal.write([ie(B),"0","0",ie($),ie(T),we(D+$),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+W.index+" Do"),this.internal.write("Q")},F=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var I=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},R=e.__addimage__.sHashCode=function(T){var D,B,$=0;if(typeof T=="string")for(B=T.length,D=0;D<B;D++)$=($<<5)-$+T.charCodeAt(D),$|=0;else if(fe(T))for(B=T.byteLength/2,D=0;D<B;D++)$=($<<5)-$+T[D],$|=0;return $},K=e.__addimage__.validateStringAsBase64=function(T){(T=T||"").toString().trim();var D=!0;return T.length===0&&(D=!1),T.length%4!=0&&(D=!1),/^[A-Za-z0-9+/]+$/.test(T.substr(0,T.length-2))===!1&&(D=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(T.substr(-2))===!1&&(D=!1),D},ee=e.__addimage__.extractImageFromDataUrl=function(T){var D=(T=T||"").split("base64,"),B=null;if(D.length===2){var $=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(D[0]);Array.isArray($)&&(B={mimeType:$[1],charset:$[2],data:D[1]})}return B},he=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(T){return he()&&T instanceof ArrayBuffer};var fe=e.__addimage__.isArrayBufferView=function(T){return he()&&typeof Uint32Array<"u"&&(T instanceof Int8Array||T instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&T instanceof Uint8ClampedArray||T instanceof Int16Array||T instanceof Uint16Array||T instanceof Int32Array||T instanceof Uint32Array||T instanceof Float32Array||T instanceof Float64Array)},ve=e.__addimage__.binaryStringToUint8Array=function(T){for(var D=T.length,B=new Uint8Array(D),$=0;$<D;$++)B[$]=T.charCodeAt($);return B},z=e.__addimage__.arrayBufferToBinaryString=function(T){for(var D="",B=fe(T)?T:new Uint8Array(T),$=0;$<B.length;$+=8192)D+=String.fromCharCode.apply(null,B.subarray($,$+8192));return D};e.addImage=function(){var T,D,B,$,W,G,oe,ie,we;if(typeof arguments[1]=="number"?(D=n,B=arguments[1],$=arguments[2],W=arguments[3],G=arguments[4],oe=arguments[5],ie=arguments[6],we=arguments[7]):(D=arguments[1],B=arguments[2],$=arguments[3],W=arguments[4],G=arguments[5],oe=arguments[6],ie=arguments[7],we=arguments[8]),so(T=arguments[0])==="object"&&!_(T)&&"imageData"in T){var Ce=T;T=Ce.imageData,D=Ce.format||D||n,B=Ce.x||B||0,$=Ce.y||$||0,W=Ce.w||Ce.width||W,G=Ce.h||Ce.height||G,oe=Ce.alias||oe,ie=Ce.compression||ie,we=Ce.rotation||Ce.angle||we}var Te=this.internal.getFilters();if(ie===void 0&&Te.indexOf("FlateEncode")!==-1&&(ie="SLOW"),isNaN(B)||isNaN($))throw new Error("Invalid coordinates passed to jsPDF.addImage");u.call(this);var Y=U.call(this,T,D,oe,ie);return k.call(this,B,$,W,G,Y,we),this};var U=function(T,D,B,$){var W,G,oe;if(typeof T=="string"&&r(T)===n){T=unescape(T);var ie=J(T,!1);(ie!==""||(ie=e.loadFile(T,!0))!==void 0)&&(T=ie)}if(_(T)&&(T=w(T,D)),D=r(T,D),!m(D))throw new Error("addImage does not support files of type '"+D+"', please ensure that a plugin for '"+D+"' support is added.");if(((oe=B)==null||oe.length===0)&&(B=function(we){return typeof we=="string"||fe(we)?R(we):fe(we.data)?R(we.data):null}(T)),(W=y.call(this,B))||(he()&&(T instanceof Uint8Array||D==="RGBA"||(G=T,T=ve(T))),W=this["process"+D.toUpperCase()](T,d.call(this),B,function(we){return we&&typeof we=="string"&&(we=we.toUpperCase()),we in e.image_compression?we:I.NONE}($),G)),!W)throw new Error("An unknown error occurred whilst processing the image.");return W},J=e.__addimage__.convertBase64ToBinaryString=function(T,D){var B;D=typeof D!="boolean"||D;var $,W="";if(typeof T=="string"){$=(B=ee(T))!==null?B.data:T;try{W=ap($)}catch(G){if(D)throw K($)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+G.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return W};e.getImageProperties=function(T){var D,B,$="";if(_(T)&&(T=w(T)),typeof T=="string"&&r(T)===n&&(($=J(T,!1))===""&&($=e.loadFile(T)||""),T=$),B=r(T),!m(B))throw new Error("addImage does not support files of type '"+B+"', please ensure that a plugin for '"+B+"' support is added.");if(!he()||T instanceof Uint8Array||(T=ve(T)),!(D=this["process"+B.toUpperCase()](T)))throw new Error("An unknown error occurred whilst processing the image");return D.fileType=B,D}})(kr.API),function(e){var n=function(t){if(t!==void 0&&t!="")return!0};kr.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(t){for(var r,i,s,o=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString,f=this.internal.getPageInfoByObjId(t.objId),d=t.pageContext.annotations,m=!1,_=0;_<d.length&&!m;_++)switch((r=d[_]).type){case"link":(n(r.options.url)||n(r.options.pageNumber))&&(m=!0);break;case"reference":case"text":case"freetext":m=!0}if(m!=0){this.internal.write("/Annots [");for(var w=0;w<d.length;w++){r=d[w];var y=this.internal.pdfEscape,M=this.internal.getEncryptor(t.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var k=this.internal.newAdditionalObject(),F=this.internal.newAdditionalObject(),I=this.internal.getEncryptor(k.objId),R=r.title||"Note";s="<</Type /Annot /Subtype /Text "+(i="/Rect ["+o(r.bounds.x)+" "+u(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w)+" "+u(r.bounds.y)+"] ")+"/Contents ("+y(I(r.contents))+")",s+=" /Popup "+F.objId+" 0 R",s+=" /P "+f.objId+" 0 R",s+=" /T ("+y(I(R))+") >>",k.content=s;var K=k.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+o(r.bounds.x+30)+" "+u(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w+30)+" "+u(r.bounds.y)+"] ")+" /Parent "+K,r.open&&(s+=" /Open true"),s+=" >>",F.content=s,this.internal.write(k.objId,"0 R",F.objId,"0 R");break;case"freetext":i="/Rect ["+o(r.bounds.x)+" "+u(r.bounds.y)+" "+o(r.bounds.x+r.bounds.w)+" "+u(r.bounds.y+r.bounds.h)+"] ";var ee=r.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+y(M(r.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+ee+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(r.options.name){var he=this.annotations._nameMap[r.options.name];r.options.pageNumber=he.page,r.options.top=he.y}else r.options.top||(r.options.top=0);if(i="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",s="",r.options.url)s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+y(M(r.options.url))+") >>";else if(r.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,s+=" /FitV "+r.options.left+"]";break;case"XYZ":default:var fe=u(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),s+=" /XYZ "+r.options.left+" "+fe+" "+r.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),e.createAnnotation=function(t){var r=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":r.pageContext.annotations.push(t)}},e.link=function(t,r,i,s,o){var u=this.internal.getCurrentPageInfo(),f=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;u.pageContext.annotations.push({finalBounds:{x:f(t),y:d(r),w:f(t+i),h:d(r+s)},options:o,type:"link"})},e.textWithLink=function(t,r,i,s){var o,u,f=this.getTextWidth(t),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){u=s.maxWidth;var m=this.splitTextToSize(t,u).length;o=Math.ceil(d*m)}else u=f,o=d;return this.text(t,r,i,s),i+=.2*d,s.align==="center"&&(r-=f/2),s.align==="right"&&(r-=f),this.link(r,i-d,u,o,s),f},e.getTextWidth=function(t){var r=this.internal.getFontSize();return this.getStringUnitWidth(t)*r/this.internal.scaleFactor}}(kr.API),function(e){var n={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(k){return n[k.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(k){return typeof k=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(k)},u=e.__arabicParser__.isArabicEndLetter=function(k){return o(k)&&s(k)&&n[k.charCodeAt(0)].length<=2},f=e.__arabicParser__.isArabicAlfLetter=function(k){return o(k)&&i.indexOf(k.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(k){return o(k)&&s(k)&&n[k.charCodeAt(0)].length>=1};var d=e.__arabicParser__.arabicLetterHasFinalForm=function(k){return o(k)&&s(k)&&n[k.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(k){return o(k)&&s(k)&&n[k.charCodeAt(0)].length>=3};var m=e.__arabicParser__.arabicLetterHasMedialForm=function(k){return o(k)&&s(k)&&n[k.charCodeAt(0)].length==4},_=e.__arabicParser__.resolveLigatures=function(k){var F=0,I=t,R="",K=0;for(F=0;F<k.length;F+=1)I[k.charCodeAt(F)]!==void 0?(K++,typeof(I=I[k.charCodeAt(F)])=="number"&&(R+=String.fromCharCode(I),I=t,K=0),F===k.length-1&&(I=t,R+=k.charAt(F-(K-1)),F-=K-1,K=0)):(I=t,R+=k.charAt(F-K),F-=K,K=0);return R};e.__arabicParser__.isArabicDiacritic=function(k){return k!==void 0&&r[k.charCodeAt(0)]!==void 0};var w=e.__arabicParser__.getCorrectForm=function(k,F,I){return o(k)?s(k)===!1?-1:!d(k)||!o(F)&&!o(I)||!o(I)&&u(F)||u(k)&&!o(F)||u(k)&&f(F)||u(k)&&u(F)?0:m(k)&&o(F)&&!u(F)&&o(I)&&d(I)?3:u(k)||!o(I)?1:2:-1},y=function(k){var F=0,I=0,R=0,K="",ee="",he="",fe=(k=k||"").split("\\s+"),ve=[];for(F=0;F<fe.length;F+=1){for(ve.push(""),I=0;I<fe[F].length;I+=1)K=fe[F][I],ee=fe[F][I-1],he=fe[F][I+1],o(K)?(R=w(K,ee,he),ve[F]+=R!==-1?String.fromCharCode(n[K.charCodeAt(0)][R]):K):ve[F]+=K;ve[F]=_(ve[F])}return ve.join(" ")},M=e.__arabicParser__.processArabic=e.processArabic=function(){var k,F=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,I=[];if(Array.isArray(F)){var R=0;for(I=[],R=0;R<F.length;R+=1)Array.isArray(F[R])?I.push([y(F[R][0]),F[R][1],F[R][2]]):I.push([y(F[R])]);k=I}else k=y(F);return typeof arguments[0]=="string"?k:(arguments[0].text=k,arguments[0])};e.events.push(["preProcessText",M])}(kr.API),kr.API.autoPrint=function(e){var n;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){n=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+n+" 0 R")})}return this},function(e){var n=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(u){t=u}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(u){r=isNaN(u)||Number.isInteger(u)===!1||u<0?150:u,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(u){i=isNaN(u)||Number.isInteger(u)===!1||u<0?300:u,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(u){s=u}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(u){o=u}}),Object.defineProperty(this,"parentNode",{})};n.prototype.getContext=function(t,r){var i;if((t=t||"2d")!=="2d")return null;for(i in r)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=r[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},n.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new n,this.canvas.pdf=this}])}(kr.API),function(e){var n={left:0,top:0,bottom:0,right:0},t=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},n),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var f=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return f},set:function(k){f=k}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(k){d=k}});var m=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return m},set:function(k){m=k}});var _=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return _},set:function(k){_=k}});var w=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return w},set:function(k){w=k}});var y=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return y},set:function(k){y=k}});var M=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return M},set:function(k){M=k}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(f){return r.call(this),this.internal.__cell__.headerFunction=typeof f=="function"?f:void 0,this},e.getTextDimensions=function(f,d){r.call(this);var m=(d=d||{}).fontSize||this.getFontSize(),_=d.font||this.getFont(),w=d.scaleFactor||this.internal.scaleFactor,y=0,M=0,k=0,F=this;if(!Array.isArray(f)&&typeof f!="string"){if(typeof f!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");f=String(f)}var I=d.maxWidth;I>0?typeof f=="string"?f=this.splitTextToSize(f,I):Object.prototype.toString.call(f)==="[object Array]"&&(f=f.reduce(function(K,ee){return K.concat(F.splitTextToSize(ee,I))},[])):f=Array.isArray(f)?f:[f];for(var R=0;R<f.length;R++)y<(k=this.getStringUnitWidth(f[R],{font:_})*m)&&(y=k);return y!==0&&(M=f.length),{w:y/=w,h:Math.max((M*m*this.getLineHeightFactor()-m*(this.getLineHeightFactor()-1))/w,0)}},e.cellAddPage=function(){r.call(this),this.addPage();var f=this.internal.__cell__.margins||n;return this.internal.__cell__.lastCell=new s(f.left,f.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var f;f=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var d=this.internal.__cell__.lastCell,m=this.internal.__cell__.padding,_=this.internal.__cell__.margins||n,w=this.internal.__cell__.tableHeaderRow,y=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===f.lineNumber?(f.x=(d.x||0)+(d.width||0),f.y=d.y||0):d.y+d.height+f.height+_.bottom>this.getPageHeight()?(this.cellAddPage(),f.y=_.top,y&&w&&(this.printHeaderRow(f.lineNumber,!0),f.y+=w[0].height)):f.y=d.y+d.height||f.y),f.text[0]!==void 0&&(this.rect(f.x,f.y,f.width,f.height,t===!0?"FD":void 0),f.align==="right"?this.text(f.text,f.x+f.width-m,f.y+m,{align:"right",baseline:"top"}):f.align==="center"?this.text(f.text,f.x+f.width/2,f.y+m,{align:"center",baseline:"top",maxWidth:f.width-m-m}):this.text(f.text,f.x+m,f.y+m,{align:"left",baseline:"top",maxWidth:f.width-m-m})),this.internal.__cell__.lastCell=f,this};e.table=function(f,d,m,_,w){if(r.call(this),!m)throw new Error("No data for PDF table.");var y,M,k,F,I=[],R=[],K=[],ee={},he={},fe=[],ve=[],z=(w=w||{}).autoSize||!1,U=w.printHeaders!==!1,J=w.css&&w.css["font-size"]!==void 0?16*w.css["font-size"]:w.fontSize||12,T=w.margins||Object.assign({width:this.getPageWidth()},n),D=typeof w.padding=="number"?w.padding:3,B=w.headerBackgroundColor||"#c8c8c8",$=w.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=U,this.internal.__cell__.margins=T,this.internal.__cell__.table_font_size=J,this.internal.__cell__.padding=D,this.internal.__cell__.headerBackgroundColor=B,this.internal.__cell__.headerTextColor=$,this.setFontSize(J),_==null)R=I=Object.keys(m[0]),K=I.map(function(){return"left"});else if(Array.isArray(_)&&so(_[0])==="object")for(I=_.map(function(Ce){return Ce.name}),R=_.map(function(Ce){return Ce.prompt||Ce.name||""}),K=_.map(function(Ce){return Ce.align||"left"}),y=0;y<_.length;y+=1)he[_[y].name]=_[y].width*(19.049976/25.4);else Array.isArray(_)&&typeof _[0]=="string"&&(R=I=_,K=I.map(function(){return"left"}));if(z||Array.isArray(_)&&typeof _[0]=="string")for(y=0;y<I.length;y+=1){for(ee[F=I[y]]=m.map(function(Ce){return Ce[F]}),this.setFont(void 0,"bold"),fe.push(this.getTextDimensions(R[y],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),M=ee[F],this.setFont(void 0,"normal"),k=0;k<M.length;k+=1)fe.push(this.getTextDimensions(M[k],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);he[F]=Math.max.apply(null,fe)+D+D,fe=[]}if(U){var W={};for(y=0;y<I.length;y+=1)W[I[y]]={},W[I[y]].text=R[y],W[I[y]].align=K[y];var G=u.call(this,W,he);ve=I.map(function(Ce){return new s(f,d,he[Ce],G,W[Ce].text,void 0,W[Ce].align)}),this.setTableHeaderRow(ve),this.printHeaderRow(1,!1)}var oe=_.reduce(function(Ce,Te){return Ce[Te.name]=Te.align,Ce},{});for(y=0;y<m.length;y+=1){"rowStart"in w&&w.rowStart instanceof Function&&w.rowStart({row:y,data:m[y]},this);var ie=u.call(this,m[y],he);for(k=0;k<I.length;k+=1){var we=m[y][I[k]];"cellStart"in w&&w.cellStart instanceof Function&&w.cellStart({row:y,col:k,data:we},this),o.call(this,new s(f,d,he[I[k]],ie,we,y+2,oe[I[k]]))}}return this.internal.__cell__.table_x=f,this.internal.__cell__.table_y=d,this};var u=function(f,d){var m=this.internal.__cell__.padding,_=this.internal.__cell__.table_font_size,w=this.internal.scaleFactor;return Object.keys(f).map(function(y){var M=f[y];return this.splitTextToSize(M.hasOwnProperty("text")?M.text:M,d[y]-m-m)},this).map(function(y){return this.getLineHeightFactor()*y.length*_/w+m+m},this).reduce(function(y,M){return Math.max(y,M)},0)};e.setTableHeaderRow=function(f){r.call(this),this.internal.__cell__.tableHeaderRow=f},e.printHeaderRow=function(f,d){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var m;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var _=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(_[0],_[1],_[2],_[3],void 0,-1)}this.setFont(void 0,"bold");for(var w=[],y=0;y<this.internal.__cell__.tableHeaderRow.length;y+=1){m=this.internal.__cell__.tableHeaderRow[y].clone(),d&&(m.y=this.internal.__cell__.margins.top||0,w.push(m)),m.lineNumber=f;var M=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,m),this.setTextColor(M)}w.length>0&&this.setTableHeaderRow(w),this.setFont(void 0,"normal"),t=!1}}(kr.API);var kx={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Tx=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],E1=Ax(Tx),Nx=[100,200,300,400,500,600,700,800,900],MF=Ax(Nx);function C1(e){var n=e.family.replace(/"|'/g,"").toLowerCase(),t=function(s){return kx[s=s||"normal"]?s:"normal"}(e.style),r=function(s){if(!s)return 400;if(typeof s=="number")return s>=100&&s<=900&&s%100==0?s:400;if(/^\d00$/.test(s))return parseInt(s);switch(s){case"bold":return 700;case"normal":default:return 400}}(e.weight),i=function(s){return typeof E1[s=s||"normal"]=="number"?s:"normal"}(e.stretch);return{family:n,style:t,weight:r,stretch:i,src:e.src||[],ref:e.ref||{name:n,style:[i,t,r].join(" ")}}}function kb(e,n,t,r){var i;for(i=t;i>=0&&i<n.length;i+=r)if(e[n[i]])return e[n[i]];for(i=t;i>=0&&i<n.length;i-=r)if(e[n[i]])return e[n[i]]}var AF={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Tb={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Nb(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function kF(e,n,t){for(var r=(t=t||{}).defaultFontFamily||"times",i=Object.assign({},AF,t.genericFontFamilies||{}),s=null,o=null,u=0;u<n.length;++u)if(i[(s=C1(n[u])).family]&&(s.family=i[s.family]),e.hasOwnProperty(s.family)){o=e[s.family];break}if(!(o=o||e[r]))throw new Error("Could not find a font-family for the rule '"+Nb(s)+"' and default family '"+r+"'.");if(o=function(f,d){if(d[f])return d[f];var m=E1[f],_=m<=E1.normal?-1:1,w=kb(d,Tx,m,_);if(!w)throw new Error("Could not find a matching font-stretch value for "+f);return w}(s.stretch,o),o=function(f,d){if(d[f])return d[f];for(var m=kx[f],_=0;_<m.length;++_)if(d[m[_]])return d[m[_]];throw new Error("Could not find a matching font-style for "+f)}(s.style,o),!(o=function(f,d){if(d[f])return d[f];if(f===400&&d[500])return d[500];if(f===500&&d[400])return d[400];var m=MF[f],_=kb(d,Nx,m,f<400?-1:1);if(!_)throw new Error("Could not find a matching font-weight for value "+f);return _}(s.weight,o)))throw new Error("Failed to resolve a font for the rule '"+Nb(s)+"'.");return o}function Db(e){return e.trimLeft()}function TF(e,n){for(var t=0;t<e.length;){if(e.charAt(t)===n)return[e.substring(0,t),e.substring(t+1)];t+=1}return null}function NF(e){var n=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return n===null?null:[n[0],e.substring(n[0].length)]}var wg,Ib,Ob,dv=["times"];(function(e){var n,t,r,i,s,o,u,f,d,m=function(Y){return Y=Y||{},this.isStrokeTransparent=Y.isStrokeTransparent||!1,this.strokeOpacity=Y.strokeOpacity||1,this.strokeStyle=Y.strokeStyle||"#000000",this.fillStyle=Y.fillStyle||"#000000",this.isFillTransparent=Y.isFillTransparent||!1,this.fillOpacity=Y.fillOpacity||1,this.font=Y.font||"10px sans-serif",this.textBaseline=Y.textBaseline||"alphabetic",this.textAlign=Y.textAlign||"left",this.lineWidth=Y.lineWidth||1,this.lineJoin=Y.lineJoin||"miter",this.lineCap=Y.lineCap||"butt",this.path=Y.path||[],this.transform=Y.transform!==void 0?Y.transform.clone():new f,this.globalCompositeOperation=Y.globalCompositeOperation||"normal",this.globalAlpha=Y.globalAlpha||1,this.clip_path=Y.clip_path||[],this.currentPoint=Y.currentPoint||new o,this.miterLimit=Y.miterLimit||10,this.lastPoint=Y.lastPoint||new o,this.lineDashOffset=Y.lineDashOffset||0,this.lineDash=Y.lineDash||[],this.margin=Y.margin||[0,0,0,0],this.prevPageLastElemOffset=Y.prevPageLastElemOffset||0,this.ignoreClearRect=typeof Y.ignoreClearRect!="boolean"||Y.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new _(this),n=this.internal.f2,t=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,u=this.internal.Rectangle,f=this.internal.Matrix,d=new m}]);var _=function(Y){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var H=Y;Object.defineProperty(this,"pdf",{get:function(){return H}});var Q=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return Q},set:function(ye){Q=!!ye}});var ue=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return ue},set:function(ye){ue=!!ye}});var le=0;Object.defineProperty(this,"posX",{get:function(){return le},set:function(ye){isNaN(ye)||(le=ye)}});var pe=0;Object.defineProperty(this,"posY",{get:function(){return pe},set:function(ye){isNaN(ye)||(pe=ye)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(ye){var de;typeof ye=="number"?de=[ye,ye,ye,ye]:((de=new Array(4))[0]=ye[0],de[1]=ye.length>=2?ye[1]:de[0],de[2]=ye.length>=3?ye[2]:de[0],de[3]=ye.length>=4?ye[3]:de[1]),d.margin=de}});var Z=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Z},set:function(ye){Z=ye}});var N=0;Object.defineProperty(this,"lastBreak",{get:function(){return N},set:function(ye){N=ye}});var ke=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ke},set:function(ye){ke=ye}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(ye){ye instanceof m&&(d=ye)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(ye){d.path=ye}});var Me=[];Object.defineProperty(this,"ctxStack",{get:function(){return Me},set:function(ye){Me=ye}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ye){var de;de=w(ye),this.ctx.fillStyle=de.style,this.ctx.isFillTransparent=de.a===0,this.ctx.fillOpacity=de.a,this.pdf.setFillColor(de.r,de.g,de.b,{a:de.a}),this.pdf.setTextColor(de.r,de.g,de.b,{a:de.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ye){var de=w(ye);this.ctx.strokeStyle=de.style,this.ctx.isStrokeTransparent=de.a===0,this.ctx.strokeOpacity=de.a,de.a===0?this.pdf.setDrawColor(255,255,255):(de.a,this.pdf.setDrawColor(de.r,de.g,de.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ye){["butt","round","square"].indexOf(ye)!==-1&&(this.ctx.lineCap=ye,this.pdf.setLineCap(ye))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ye){isNaN(ye)||(this.ctx.lineWidth=ye,this.pdf.setLineWidth(ye))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ye){["bevel","round","miter"].indexOf(ye)!==-1&&(this.ctx.lineJoin=ye,this.pdf.setLineJoin(ye))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ye){isNaN(ye)||(this.ctx.miterLimit=ye,this.pdf.setMiterLimit(ye))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ye){this.ctx.textBaseline=ye}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ye){["right","end","center","left","start"].indexOf(ye)!==-1&&(this.ctx.textAlign=ye)}});var Ue=null;function ce(ye,de){if(Ue===null){var We=function(Ge){var tt=[];return Object.keys(Ge).forEach(function(Ze){Ge[Ze].forEach(function(et){var He=null;switch(et){case"bold":He={family:Ze,weight:"bold"};break;case"italic":He={family:Ze,style:"italic"};break;case"bolditalic":He={family:Ze,weight:"bold",style:"italic"};break;case"":case"normal":He={family:Ze}}He!==null&&(He.ref={name:Ze,style:et},tt.push(He))})}),tt}(ye.getFontList());Ue=function(Ge){for(var tt={},Ze=0;Ze<Ge.length;++Ze){var et=C1(Ge[Ze]),He=et.family,wt=et.stretch,Pt=et.style,kt=et.weight;tt[He]=tt[He]||{},tt[He][wt]=tt[He][wt]||{},tt[He][wt][Pt]=tt[He][wt][Pt]||{},tt[He][wt][Pt][kt]=et}return tt}(We.concat(de))}return Ue}var ne=null;Object.defineProperty(this,"fontFaces",{get:function(){return ne},set:function(ye){Ue=null,ne=ye}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ye){var de;if(this.ctx.font=ye,(de=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(ye))!==null){var We=de[1],Ge=(de[2],de[3]),tt=de[4],Ze=(de[5],de[6]),et=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(tt)[2];tt=Math.floor(et==="px"?parseFloat(tt)*this.pdf.internal.scaleFactor:et==="em"?parseFloat(tt)*this.pdf.getFontSize():parseFloat(tt)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(tt);var He=function(Ke){var ot,rt,Ft=[],Qt=Ke.trim();if(Qt==="")return dv;if(Qt in Tb)return[Tb[Qt]];for(;Qt!=="";){switch(rt=null,ot=(Qt=Db(Qt)).charAt(0)){case'"':case"'":rt=TF(Qt.substring(1),ot);break;default:rt=NF(Qt)}if(rt===null||(Ft.push(rt[0]),(Qt=Db(rt[1]))!==""&&Qt.charAt(0)!==","))return dv;Qt=Qt.replace(/^,/,"")}return Ft}(Ze);if(this.fontFaces){var wt=kF(ce(this.pdf,this.fontFaces),He.map(function(Ke){return{family:Ke,stretch:"normal",weight:Ge,style:We}}));this.pdf.setFont(wt.ref.name,wt.ref.style)}else{var Pt="";(Ge==="bold"||parseInt(Ge,10)>=700||We==="bold")&&(Pt="bold"),We==="italic"&&(Pt+="italic"),Pt.length===0&&(Pt="normal");for(var kt="",Jt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},rn=0;rn<He.length;rn++){if(this.pdf.internal.getFont(He[rn],Pt,{noFallback:!0,disableWarning:!0})!==void 0){kt=He[rn];break}if(Pt==="bolditalic"&&this.pdf.internal.getFont(He[rn],"bold",{noFallback:!0,disableWarning:!0})!==void 0)kt=He[rn],Pt="bold";else if(this.pdf.internal.getFont(He[rn],"normal",{noFallback:!0,disableWarning:!0})!==void 0){kt=He[rn],Pt="normal";break}}if(kt===""){for(var un=0;un<He.length;un++)if(Jt[He[un]]){kt=Jt[He[un]];break}}kt=kt===""?"Times":kt,this.pdf.setFont(kt,Pt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ye){this.ctx.globalCompositeOperation=ye}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ye){this.ctx.globalAlpha=ye}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ye){this.ctx.lineDashOffset=ye,Te.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ye){this.ctx.lineDash=ye,Te.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ye){this.ctx.ignoreClearRect=!!ye}})};_.prototype.setLineDash=function(Y){this.lineDash=Y},_.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},_.prototype.fill=function(){ee.call(this,"fill",!1)},_.prototype.stroke=function(){ee.call(this,"stroke",!1)},_.prototype.beginPath=function(){this.path=[{type:"begin"}]},_.prototype.moveTo=function(Y,H){if(isNaN(Y)||isNaN(H))throw mo.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var Q=this.ctx.transform.applyToPoint(new o(Y,H));this.path.push({type:"mt",x:Q.x,y:Q.y}),this.ctx.lastPoint=new o(Y,H)},_.prototype.closePath=function(){var Y=new o(0,0),H=0;for(H=this.path.length-1;H!==-1;H--)if(this.path[H].type==="begin"&&so(this.path[H+1])==="object"&&typeof this.path[H+1].x=="number"){Y=new o(this.path[H+1].x,this.path[H+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(Y.x,Y.y)},_.prototype.lineTo=function(Y,H){if(isNaN(Y)||isNaN(H))throw mo.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var Q=this.ctx.transform.applyToPoint(new o(Y,H));this.path.push({type:"lt",x:Q.x,y:Q.y}),this.ctx.lastPoint=new o(Q.x,Q.y)},_.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),ee.call(this,null,!0)},_.prototype.quadraticCurveTo=function(Y,H,Q,ue){if(isNaN(Q)||isNaN(ue)||isNaN(Y)||isNaN(H))throw mo.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var le=this.ctx.transform.applyToPoint(new o(Q,ue)),pe=this.ctx.transform.applyToPoint(new o(Y,H));this.path.push({type:"qct",x1:pe.x,y1:pe.y,x:le.x,y:le.y}),this.ctx.lastPoint=new o(le.x,le.y)},_.prototype.bezierCurveTo=function(Y,H,Q,ue,le,pe){if(isNaN(le)||isNaN(pe)||isNaN(Y)||isNaN(H)||isNaN(Q)||isNaN(ue))throw mo.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Z=this.ctx.transform.applyToPoint(new o(le,pe)),N=this.ctx.transform.applyToPoint(new o(Y,H)),ke=this.ctx.transform.applyToPoint(new o(Q,ue));this.path.push({type:"bct",x1:N.x,y1:N.y,x2:ke.x,y2:ke.y,x:Z.x,y:Z.y}),this.ctx.lastPoint=new o(Z.x,Z.y)},_.prototype.arc=function(Y,H,Q,ue,le,pe){if(isNaN(Y)||isNaN(H)||isNaN(Q)||isNaN(ue)||isNaN(le))throw mo.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(pe=!!pe,!this.ctx.transform.isIdentity){var Z=this.ctx.transform.applyToPoint(new o(Y,H));Y=Z.x,H=Z.y;var N=this.ctx.transform.applyToPoint(new o(0,Q)),ke=this.ctx.transform.applyToPoint(new o(0,0));Q=Math.sqrt(Math.pow(N.x-ke.x,2)+Math.pow(N.y-ke.y,2))}Math.abs(le-ue)>=2*Math.PI&&(ue=0,le=2*Math.PI),this.path.push({type:"arc",x:Y,y:H,radius:Q,startAngle:ue,endAngle:le,counterclockwise:pe})},_.prototype.arcTo=function(Y,H,Q,ue,le){throw new Error("arcTo not implemented.")},_.prototype.rect=function(Y,H,Q,ue){if(isNaN(Y)||isNaN(H)||isNaN(Q)||isNaN(ue))throw mo.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(Y,H),this.lineTo(Y+Q,H),this.lineTo(Y+Q,H+ue),this.lineTo(Y,H+ue),this.lineTo(Y,H),this.lineTo(Y+Q,H),this.lineTo(Y,H)},_.prototype.fillRect=function(Y,H,Q,ue){if(isNaN(Y)||isNaN(H)||isNaN(Q)||isNaN(ue))throw mo.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!y.call(this)){var le={};this.lineCap!=="butt"&&(le.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(le.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(Y,H,Q,ue),this.fill(),le.hasOwnProperty("lineCap")&&(this.lineCap=le.lineCap),le.hasOwnProperty("lineJoin")&&(this.lineJoin=le.lineJoin)}},_.prototype.strokeRect=function(Y,H,Q,ue){if(isNaN(Y)||isNaN(H)||isNaN(Q)||isNaN(ue))throw mo.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");M.call(this)||(this.beginPath(),this.rect(Y,H,Q,ue),this.stroke())},_.prototype.clearRect=function(Y,H,Q,ue){if(isNaN(Y)||isNaN(H)||isNaN(Q)||isNaN(ue))throw mo.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(Y,H,Q,ue))},_.prototype.save=function(Y){Y=typeof Y!="boolean"||Y;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,Q=0;Q<this.pdf.internal.getNumberOfPages();Q++)this.pdf.setPage(Q+1),this.pdf.internal.out("q");if(this.pdf.setPage(H),Y){this.ctx.fontSize=this.pdf.internal.getFontSize();var ue=new m(this.ctx);this.ctxStack.push(this.ctx),this.ctx=ue}},_.prototype.restore=function(Y){Y=typeof Y!="boolean"||Y;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,Q=0;Q<this.pdf.internal.getNumberOfPages();Q++)this.pdf.setPage(Q+1),this.pdf.internal.out("Q");this.pdf.setPage(H),Y&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},_.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var w=function(Y){var H,Q,ue,le;if(Y.isCanvasGradient===!0&&(Y=Y.getColor()),!Y)return{r:0,g:0,b:0,a:0,style:Y};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(Y))H=0,Q=0,ue=0,le=0;else{var pe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(Y);if(pe!==null)H=parseInt(pe[1]),Q=parseInt(pe[2]),ue=parseInt(pe[3]),le=1;else if((pe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(Y))!==null)H=parseInt(pe[1]),Q=parseInt(pe[2]),ue=parseInt(pe[3]),le=parseFloat(pe[4]);else{if(le=1,typeof Y=="string"&&Y.charAt(0)!=="#"){var Z=new Lx(Y);Y=Z.ok?Z.toHex():"#000000"}Y.length===4?(H=Y.substring(1,2),H+=H,Q=Y.substring(2,3),Q+=Q,ue=Y.substring(3,4),ue+=ue):(H=Y.substring(1,3),Q=Y.substring(3,5),ue=Y.substring(5,7)),H=parseInt(H,16),Q=parseInt(Q,16),ue=parseInt(ue,16)}}return{r:H,g:Q,b:ue,a:le,style:Y}},y=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},M=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};_.prototype.fillText=function(Y,H,Q,ue){if(isNaN(H)||isNaN(Q)||typeof Y!="string")throw mo.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(ue=isNaN(ue)?void 0:ue,!y.call(this)){var le=ie(this.ctx.transform.rotation),pe=this.ctx.transform.scaleX;D.call(this,{text:Y,x:H,y:Q,scale:pe,angle:le,align:this.textAlign,maxWidth:ue})}},_.prototype.strokeText=function(Y,H,Q,ue){if(isNaN(H)||isNaN(Q)||typeof Y!="string")throw mo.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!M.call(this)){ue=isNaN(ue)?void 0:ue;var le=ie(this.ctx.transform.rotation),pe=this.ctx.transform.scaleX;D.call(this,{text:Y,x:H,y:Q,scale:pe,renderingMode:"stroke",angle:le,align:this.textAlign,maxWidth:ue})}},_.prototype.measureText=function(Y){if(typeof Y!="string")throw mo.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var H=this.pdf,Q=this.pdf.internal.scaleFactor,ue=H.internal.getFontSize(),le=H.getStringUnitWidth(Y)*ue/H.internal.scaleFactor,pe=function(Z){var N=(Z=Z||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return N}}),this};return new pe({width:le*=Math.round(96*Q/72*1e4)/1e4})},_.prototype.scale=function(Y,H){if(isNaN(Y)||isNaN(H))throw mo.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var Q=new f(Y,0,0,H,0,0);this.ctx.transform=this.ctx.transform.multiply(Q)},_.prototype.rotate=function(Y){if(isNaN(Y))throw mo.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var H=new f(Math.cos(Y),Math.sin(Y),-Math.sin(Y),Math.cos(Y),0,0);this.ctx.transform=this.ctx.transform.multiply(H)},_.prototype.translate=function(Y,H){if(isNaN(Y)||isNaN(H))throw mo.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var Q=new f(1,0,0,1,Y,H);this.ctx.transform=this.ctx.transform.multiply(Q)},_.prototype.transform=function(Y,H,Q,ue,le,pe){if(isNaN(Y)||isNaN(H)||isNaN(Q)||isNaN(ue)||isNaN(le)||isNaN(pe))throw mo.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Z=new f(Y,H,Q,ue,le,pe);this.ctx.transform=this.ctx.transform.multiply(Z)},_.prototype.setTransform=function(Y,H,Q,ue,le,pe){Y=isNaN(Y)?1:Y,H=isNaN(H)?0:H,Q=isNaN(Q)?0:Q,ue=isNaN(ue)?1:ue,le=isNaN(le)?0:le,pe=isNaN(pe)?0:pe,this.ctx.transform=new f(Y,H,Q,ue,le,pe)};var k=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};_.prototype.drawImage=function(Y,H,Q,ue,le,pe,Z,N,ke){var Me=this.pdf.getImageProperties(Y),Ue=1,ce=1,ne=1,ye=1;ue!==void 0&&N!==void 0&&(ne=N/ue,ye=ke/le,Ue=Me.width/ue*N/ue,ce=Me.height/le*ke/le),pe===void 0&&(pe=H,Z=Q,H=0,Q=0),ue!==void 0&&N===void 0&&(N=ue,ke=le),ue===void 0&&N===void 0&&(N=Me.width,ke=Me.height);for(var de,We=this.ctx.transform.decompose(),Ge=ie(We.rotate.shx),tt=new f,Ze=(tt=(tt=(tt=tt.multiply(We.translate)).multiply(We.skew)).multiply(We.scale)).applyToRectangle(new u(pe-H*ne,Z-Q*ye,ue*Ue,le*ce)),et=F.call(this,Ze),He=[],wt=0;wt<et.length;wt+=1)He.indexOf(et[wt])===-1&&He.push(et[wt]);if(K(He),this.autoPaging)for(var Pt=He[0],kt=He[He.length-1],Jt=Pt;Jt<kt+1;Jt++){this.pdf.setPage(Jt);var rn=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],un=Jt===1?this.posY+this.margin[0]:this.margin[0],Ke=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ot=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],rt=Jt===1?0:Ke+(Jt-2)*ot;if(this.ctx.clip_path.length!==0){var Ft=this.path;de=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=R(de,this.posX+this.margin[3],-rt+un+this.ctx.prevPageLastElemOffset),he.call(this,"fill",!0),this.path=Ft}var Qt=JSON.parse(JSON.stringify(Ze));Qt=R([Qt],this.posX+this.margin[3],-rt+un+this.ctx.prevPageLastElemOffset)[0];var Bn=(Jt>Pt||Jt<kt)&&k.call(this);Bn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],rn,ot,null).clip().discardPath()),this.pdf.addImage(Y,"JPEG",Qt.x,Qt.y,Qt.w,Qt.h,null,null,Ge),Bn&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(Y,"JPEG",Ze.x,Ze.y,Ze.w,Ze.h,null,null,Ge)};var F=function(Y,H,Q){var ue=[];H=H||this.pdf.internal.pageSize.width,Q=Q||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var le=this.posY+this.ctx.prevPageLastElemOffset;switch(Y.type){default:case"mt":case"lt":ue.push(Math.floor((Y.y+le)/Q)+1);break;case"arc":ue.push(Math.floor((Y.y+le-Y.radius)/Q)+1),ue.push(Math.floor((Y.y+le+Y.radius)/Q)+1);break;case"qct":var pe=we(this.ctx.lastPoint.x,this.ctx.lastPoint.y,Y.x1,Y.y1,Y.x,Y.y);ue.push(Math.floor((pe.y+le)/Q)+1),ue.push(Math.floor((pe.y+pe.h+le)/Q)+1);break;case"bct":var Z=Ce(this.ctx.lastPoint.x,this.ctx.lastPoint.y,Y.x1,Y.y1,Y.x2,Y.y2,Y.x,Y.y);ue.push(Math.floor((Z.y+le)/Q)+1),ue.push(Math.floor((Z.y+Z.h+le)/Q)+1);break;case"rect":ue.push(Math.floor((Y.y+le)/Q)+1),ue.push(Math.floor((Y.y+Y.h+le)/Q)+1)}for(var N=0;N<ue.length;N+=1)for(;this.pdf.internal.getNumberOfPages()<ue[N];)I.call(this);return ue},I=function(){var Y=this.fillStyle,H=this.strokeStyle,Q=this.font,ue=this.lineCap,le=this.lineWidth,pe=this.lineJoin;this.pdf.addPage(),this.fillStyle=Y,this.strokeStyle=H,this.font=Q,this.lineCap=ue,this.lineWidth=le,this.lineJoin=pe},R=function(Y,H,Q){for(var ue=0;ue<Y.length;ue++)switch(Y[ue].type){case"bct":Y[ue].x2+=H,Y[ue].y2+=Q;case"qct":Y[ue].x1+=H,Y[ue].y1+=Q;case"mt":case"lt":case"arc":default:Y[ue].x+=H,Y[ue].y+=Q}return Y},K=function(Y){return Y.sort(function(H,Q){return H-Q})},ee=function(Y,H){for(var Q,ue,le=this.fillStyle,pe=this.strokeStyle,Z=this.lineCap,N=this.lineWidth,ke=Math.abs(N*this.ctx.transform.scaleX),Me=this.lineJoin,Ue=JSON.parse(JSON.stringify(this.path)),ce=JSON.parse(JSON.stringify(this.path)),ne=[],ye=0;ye<ce.length;ye++)if(ce[ye].x!==void 0)for(var de=F.call(this,ce[ye]),We=0;We<de.length;We+=1)ne.indexOf(de[We])===-1&&ne.push(de[We]);for(var Ge=0;Ge<ne.length;Ge++)for(;this.pdf.internal.getNumberOfPages()<ne[Ge];)I.call(this);if(K(ne),this.autoPaging)for(var tt=ne[0],Ze=ne[ne.length-1],et=tt;et<Ze+1;et++){this.pdf.setPage(et),this.fillStyle=le,this.strokeStyle=pe,this.lineCap=Z,this.lineWidth=ke,this.lineJoin=Me;var He=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],wt=et===1?this.posY+this.margin[0]:this.margin[0],Pt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],kt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Jt=et===1?0:Pt+(et-2)*kt;if(this.ctx.clip_path.length!==0){var rn=this.path;Q=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=R(Q,this.posX+this.margin[3],-Jt+wt+this.ctx.prevPageLastElemOffset),he.call(this,Y,!0),this.path=rn}if(ue=JSON.parse(JSON.stringify(Ue)),this.path=R(ue,this.posX+this.margin[3],-Jt+wt+this.ctx.prevPageLastElemOffset),H===!1||et===0){var un=(et>tt||et<Ze)&&k.call(this);un&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],He,kt,null).clip().discardPath()),he.call(this,Y,H),un&&this.pdf.restoreGraphicsState()}this.lineWidth=N}else this.lineWidth=ke,he.call(this,Y,H),this.lineWidth=N;this.path=Ue},he=function(Y,H){if((Y!=="stroke"||H||!M.call(this))&&(Y==="stroke"||H||!y.call(this))){for(var Q,ue,le=[],pe=this.path,Z=0;Z<pe.length;Z++){var N=pe[Z];switch(N.type){case"begin":le.push({begin:!0});break;case"close":le.push({close:!0});break;case"mt":le.push({start:N,deltas:[],abs:[]});break;case"lt":var ke=le.length;if(pe[Z-1]&&!isNaN(pe[Z-1].x)&&(Q=[N.x-pe[Z-1].x,N.y-pe[Z-1].y],ke>0)){for(;ke>=0;ke--)if(le[ke-1].close!==!0&&le[ke-1].begin!==!0){le[ke-1].deltas.push(Q),le[ke-1].abs.push(N);break}}break;case"bct":Q=[N.x1-pe[Z-1].x,N.y1-pe[Z-1].y,N.x2-pe[Z-1].x,N.y2-pe[Z-1].y,N.x-pe[Z-1].x,N.y-pe[Z-1].y],le[le.length-1].deltas.push(Q);break;case"qct":var Me=pe[Z-1].x+2/3*(N.x1-pe[Z-1].x),Ue=pe[Z-1].y+2/3*(N.y1-pe[Z-1].y),ce=N.x+2/3*(N.x1-N.x),ne=N.y+2/3*(N.y1-N.y),ye=N.x,de=N.y;Q=[Me-pe[Z-1].x,Ue-pe[Z-1].y,ce-pe[Z-1].x,ne-pe[Z-1].y,ye-pe[Z-1].x,de-pe[Z-1].y],le[le.length-1].deltas.push(Q);break;case"arc":le.push({deltas:[],abs:[],arc:!0}),Array.isArray(le[le.length-1].abs)&&le[le.length-1].abs.push(N)}}ue=H?null:Y==="stroke"?"stroke":"fill";for(var We=!1,Ge=0;Ge<le.length;Ge++)if(le[Ge].arc)for(var tt=le[Ge].abs,Ze=0;Ze<tt.length;Ze++){var et=tt[Ze];et.type==="arc"?z.call(this,et.x,et.y,et.radius,et.startAngle,et.endAngle,et.counterclockwise,void 0,H,!We):B.call(this,et.x,et.y),We=!0}else if(le[Ge].close===!0)this.pdf.internal.out("h"),We=!1;else if(le[Ge].begin!==!0){var He=le[Ge].start.x,wt=le[Ge].start.y;$.call(this,le[Ge].deltas,He,wt),We=!0}ue&&U.call(this,ue),H&&J.call(this)}},fe=function(Y){var H=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,Q=H*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return Y-Q;case"top":return Y+H-Q;case"hanging":return Y+H-2*Q;case"middle":return Y+H/2-Q;case"ideographic":return Y;case"alphabetic":default:return Y}},ve=function(Y){return Y+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};_.prototype.createLinearGradient=function(){var Y=function(){};return Y.colorStops=[],Y.addColorStop=function(H,Q){this.colorStops.push([H,Q])},Y.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},Y.isCanvasGradient=!0,Y},_.prototype.createPattern=function(){return this.createLinearGradient()},_.prototype.createRadialGradient=function(){return this.createLinearGradient()};var z=function(Y,H,Q,ue,le,pe,Z,N,ke){for(var Me=G.call(this,Q,ue,le,pe),Ue=0;Ue<Me.length;Ue++){var ce=Me[Ue];Ue===0&&(ke?T.call(this,ce.x1+Y,ce.y1+H):B.call(this,ce.x1+Y,ce.y1+H)),W.call(this,Y,H,ce.x2,ce.y2,ce.x3,ce.y3,ce.x4,ce.y4)}N?J.call(this):U.call(this,Z)},U=function(Y){switch(Y){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},J=function(){this.pdf.clip(),this.pdf.discardPath()},T=function(Y,H){this.pdf.internal.out(t(Y)+" "+r(H)+" m")},D=function(Y){var H;switch(Y.align){case"right":case"end":H="right";break;case"center":H="center";break;case"left":case"start":default:H="left"}var Q=this.pdf.getTextDimensions(Y.text),ue=fe.call(this,Y.y),le=ve.call(this,ue)-Q.h,pe=this.ctx.transform.applyToPoint(new o(Y.x,ue)),Z=this.ctx.transform.decompose(),N=new f;N=(N=(N=N.multiply(Z.translate)).multiply(Z.skew)).multiply(Z.scale);for(var ke,Me,Ue,ce=this.ctx.transform.applyToRectangle(new u(Y.x,ue,Q.w,Q.h)),ne=N.applyToRectangle(new u(Y.x,le,Q.w,Q.h)),ye=F.call(this,ne),de=[],We=0;We<ye.length;We+=1)de.indexOf(ye[We])===-1&&de.push(ye[We]);if(K(de),this.autoPaging)for(var Ge=de[0],tt=de[de.length-1],Ze=Ge;Ze<tt+1;Ze++){this.pdf.setPage(Ze);var et=Ze===1?this.posY+this.margin[0]:this.margin[0],He=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],wt=this.pdf.internal.pageSize.height-this.margin[2],Pt=wt-this.margin[0],kt=this.pdf.internal.pageSize.width-this.margin[1],Jt=kt-this.margin[3],rn=Ze===1?0:He+(Ze-2)*Pt;if(this.ctx.clip_path.length!==0){var un=this.path;ke=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=R(ke,this.posX+this.margin[3],-1*rn+et),he.call(this,"fill",!0),this.path=un}var Ke=R([JSON.parse(JSON.stringify(ne))],this.posX+this.margin[3],-rn+et+this.ctx.prevPageLastElemOffset)[0];Y.scale>=.01&&(Me=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Me*Y.scale),Ue=this.lineWidth,this.lineWidth=Ue*Y.scale);var ot=this.autoPaging!=="text";if(ot||Ke.y+Ke.h<=wt){if(ot||Ke.y>=et&&Ke.x<=kt){var rt=ot?Y.text:this.pdf.splitTextToSize(Y.text,Y.maxWidth||kt-Ke.x)[0],Ft=R([JSON.parse(JSON.stringify(ce))],this.posX+this.margin[3],-rn+et+this.ctx.prevPageLastElemOffset)[0],Qt=ot&&(Ze>Ge||Ze<tt)&&k.call(this);Qt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Jt,Pt,null).clip().discardPath()),this.pdf.text(rt,Ft.x,Ft.y,{angle:Y.angle,align:H,renderingMode:Y.renderingMode}),Qt&&this.pdf.restoreGraphicsState()}}else Ke.y<wt&&(this.ctx.prevPageLastElemOffset+=wt-Ke.y);Y.scale>=.01&&(this.pdf.setFontSize(Me),this.lineWidth=Ue)}else Y.scale>=.01&&(Me=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Me*Y.scale),Ue=this.lineWidth,this.lineWidth=Ue*Y.scale),this.pdf.text(Y.text,pe.x+this.posX,pe.y+this.posY,{angle:Y.angle,align:H,renderingMode:Y.renderingMode,maxWidth:Y.maxWidth}),Y.scale>=.01&&(this.pdf.setFontSize(Me),this.lineWidth=Ue)},B=function(Y,H,Q,ue){Q=Q||0,ue=ue||0,this.pdf.internal.out(t(Y+Q)+" "+r(H+ue)+" l")},$=function(Y,H,Q){return this.pdf.lines(Y,H,Q,null,null)},W=function(Y,H,Q,ue,le,pe,Z,N){this.pdf.internal.out([n(i(Q+Y)),n(s(ue+H)),n(i(le+Y)),n(s(pe+H)),n(i(Z+Y)),n(s(N+H)),"c"].join(" "))},G=function(Y,H,Q,ue){for(var le=2*Math.PI,pe=Math.PI/2;H>Q;)H-=le;var Z=Math.abs(Q-H);Z<le&&ue&&(Z=le-Z);for(var N=[],ke=ue?-1:1,Me=H;Z>1e-5;){var Ue=Me+ke*Math.min(Z,pe);N.push(oe.call(this,Y,Me,Ue)),Z-=Math.abs(Ue-Me),Me=Ue}return N},oe=function(Y,H,Q){var ue=(Q-H)/2,le=Y*Math.cos(ue),pe=Y*Math.sin(ue),Z=le,N=-pe,ke=Z*Z+N*N,Me=ke+Z*le+N*pe,Ue=4/3*(Math.sqrt(2*ke*Me)-Me)/(Z*pe-N*le),ce=Z-Ue*N,ne=N+Ue*Z,ye=ce,de=-ne,We=ue+H,Ge=Math.cos(We),tt=Math.sin(We);return{x1:Y*Math.cos(H),y1:Y*Math.sin(H),x2:ce*Ge-ne*tt,y2:ce*tt+ne*Ge,x3:ye*Ge-de*tt,y3:ye*tt+de*Ge,x4:Y*Math.cos(Q),y4:Y*Math.sin(Q)}},ie=function(Y){return 180*Y/Math.PI},we=function(Y,H,Q,ue,le,pe){var Z=Y+.5*(Q-Y),N=H+.5*(ue-H),ke=le+.5*(Q-le),Me=pe+.5*(ue-pe),Ue=Math.min(Y,le,Z,ke),ce=Math.max(Y,le,Z,ke),ne=Math.min(H,pe,N,Me),ye=Math.max(H,pe,N,Me);return new u(Ue,ne,ce-Ue,ye-ne)},Ce=function(Y,H,Q,ue,le,pe,Z,N){var ke,Me,Ue,ce,ne,ye,de,We,Ge,tt,Ze,et,He,wt,Pt=Q-Y,kt=ue-H,Jt=le-Q,rn=pe-ue,un=Z-le,Ke=N-pe;for(Me=0;Me<41;Me++)Ge=(de=(Ue=Y+(ke=Me/40)*Pt)+ke*((ne=Q+ke*Jt)-Ue))+ke*(ne+ke*(le+ke*un-ne)-de),tt=(We=(ce=H+ke*kt)+ke*((ye=ue+ke*rn)-ce))+ke*(ye+ke*(pe+ke*Ke-ye)-We),Me==0?(Ze=Ge,et=tt,He=Ge,wt=tt):(Ze=Math.min(Ze,Ge),et=Math.min(et,tt),He=Math.max(He,Ge),wt=Math.max(wt,tt));return new u(Math.round(Ze),Math.round(et),Math.round(He-Ze),Math.round(wt-et))},Te=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var Y,H,Q=(Y=this.ctx.lineDash,H=this.ctx.lineDashOffset,JSON.stringify({lineDash:Y,lineDashOffset:H}));this.prevLineDash!==Q&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=Q)}}})(kr.API),function(e){var n=function(s){var o,u,f,d,m,_,w,y,M,k;for(u=[],f=0,d=(s+=o="\0\0\0\0".slice(s.length%4||4)).length;d>f;f+=4)(m=(s.charCodeAt(f)<<24)+(s.charCodeAt(f+1)<<16)+(s.charCodeAt(f+2)<<8)+s.charCodeAt(f+3))!==0?(_=(m=((m=((m=((m=(m-(k=m%85))/85)-(M=m%85))/85)-(y=m%85))/85)-(w=m%85))/85)%85,u.push(_+33,w+33,y+33,M+33,k+33)):u.push(122);return function(F,I){for(var R=I;R>0;R--)F.pop()}(u,o.length),String.fromCharCode.apply(String,u)+"~>"},t=function(s){var o,u,f,d,m,_=String,w="length",y=255,M="charCodeAt",k="slice",F="replace";for(s[k](-2),s=s[k](0,-2)[F](/\s/g,"")[F]("z","!!!!!"),f=[],d=0,m=(s+=o="uuuuu"[k](s[w]%5||5))[w];m>d;d+=5)u=52200625*(s[M](d)-33)+614125*(s[M](d+1)-33)+7225*(s[M](d+2)-33)+85*(s[M](d+3)-33)+(s[M](d+4)-33),f.push(y&u>>24,y&u>>16,y&u>>8,y&u);return function(I,R){for(var K=R;K>0;K--)I.pop()}(f,o[w]),_.fromCharCode.apply(_,f)},r=function(s){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),o.test(s)===!1)return"";for(var u="",f=0;f<s.length;f+=2)u+=String.fromCharCode("0x"+(s[f]+s[f+1]));return u},i=function(s){for(var o=new Uint8Array(s.length),u=s.length;u--;)o[u]=s.charCodeAt(u);return s=(o=b1(o)).reduce(function(f,d){return f+String.fromCharCode(d)},"")};e.processDataByFilters=function(s,o){var u=0,f=s||"",d=[];for(typeof(o=o||[])=="string"&&(o=[o]),u=0;u<o.length;u+=1)switch(o[u]){case"ASCII85Decode":case"/ASCII85Decode":f=t(f),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":f=n(f),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":f=r(f),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":f=f.split("").map(function(m){return("0"+m.charCodeAt().toString(16)).slice(-2)}).join("")+">",d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":f=i(f),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[u]+'" is not implemented')}return{data:f,reverseChain:d.reverse().join(" ")}}}(kr.API),function(e){e.loadFile=function(n,t,r){return function(i,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var u=void 0;try{u=function(f,d,m){var _=new XMLHttpRequest,w=0,y=function(M){var k=M.length,F=[],I=String.fromCharCode;for(w=0;w<k;w+=1)F.push(I(255&M.charCodeAt(w)));return F.join("")};if(_.open("GET",f,!d),_.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(_.onload=function(){_.status===200?m(y(this.responseText)):m(void 0)}),_.send(null),d&&_.status===200)return y(_.responseText)}(i,s,o)}catch{}return u}(n,t,r)},e.loadImageFile=e.loadFile}(kr.API),function(e){function n(){return(Dr.html2canvas?Promise.resolve(Dr.html2canvas):mf(()=>import("./html2canvas.esm.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function t(){return(Dr.DOMPurify?Promise.resolve(Dr.DOMPurify):mf(()=>import("./purify.es.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var r=function(o){var u=so(o);return u==="undefined"?"undefined":u==="string"||o instanceof String?"string":u==="number"||o instanceof Number?"number":u==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":u==="object"?"object":"unknown"},i=function(o,u){var f=document.createElement(o);for(var d in u.className&&(f.className=u.className),u.innerHTML&&u.dompurify&&(f.innerHTML=u.dompurify.sanitize(u.innerHTML)),u.style)f.style[d]=u.style[d];return f},s=function o(u){var f=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),d=o.convert(Promise.resolve(),f);return d=(d=d.setProgress(1,o,1,[o])).set(u)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(o,u){return o.__proto__=u||s.prototype,o},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(o,u){return this.then(function(){switch(u=u||function(f){switch(r(f)){case"string":return"string";case"element":return f.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o)){case"string":return this.then(t).then(function(f){return this.set({src:i("div",{innerHTML:o,dompurify:f})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},s.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},u=function f(d,m){for(var _=d.nodeType===3?document.createTextNode(d.nodeValue):d.cloneNode(!1),w=d.firstChild;w;w=w.nextSibling)m!==!0&&w.nodeType===1&&w.nodeName==="SCRIPT"||_.appendChild(f(w,m));return d.nodeType===1&&(d.nodeName==="CANVAS"?(_.width=d.width,_.height=d.height,_.getContext("2d").drawImage(d,0,0)):d.nodeName!=="TEXTAREA"&&d.nodeName!=="SELECT"||(_.value=d.value),_.addEventListener("load",function(){_.scrollTop=d.scrollTop,_.scrollLeft=d.scrollLeft},!0)),_}(this.prop.src,this.opt.html2canvas.javascriptEnabled);u.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(u),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(n).then(function(u){var f=Object.assign({},this.opt.html2canvas);return delete f.onrendered,u(this.prop.container,f)}).then(function(u){(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(n).then(function(u){var f=this.opt.jsPDF,d=this.opt.fontFaces,m=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,_=Object.assign({async:!0,allowTaint:!0,scale:m,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete _.onrendered,f.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,f.context2d.posX=this.opt.x,f.context2d.posY=this.opt.y,f.context2d.margin=this.opt.margin,f.context2d.fontFaces=d,d)for(var w=0;w<d.length;++w){var y=d[w],M=y.src.find(function(k){return k.format==="truetype"});M&&f.addFont(M.url,y.ref.name,y.ref.style)}return _.windowHeight=_.windowHeight||0,_.windowHeight=_.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):_.windowHeight,f.context2d.save(!0),u(this.prop.container,_)}).then(function(u){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(o,u,f){return(f=f||"pdf").toLowerCase()==="img"||f.toLowerCase()==="image"?this.outputImg(o,u):this.outputPdf(o,u)},s.prototype.outputPdf=function(o,u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,u)})},s.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},s.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(o){if(r(o)!=="object")return this;var u=Object.keys(o||{}).map(function(f){if(f in s.template.prop)return function(){this.prop[f]=o[f]};switch(f){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[f]=o[f]}}},this);return this.then(function(){return this.thenList(u)})},s.prototype.get=function(o,u){return this.then(function(){var f=o in s.template.prop?this.prop[o]:this.opt[o];return u?u(f):f})},s.prototype.setMargin=function(o){return this.then(function(){switch(r(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},s.prototype.setPageSize=function(o){function u(f,d){return Math.floor(f*d/72*96)}return this.then(function(){(o=o||kr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:u(o.inner.width,o.k),height:u(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},s.prototype.setProgress=function(o,u,f,d){return o!=null&&(this.progress.val=o),u!=null&&(this.progress.state=u),f!=null&&(this.progress.n=f),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(o,u,f,d){return this.setProgress(o?this.progress.val+o:null,u||null,f?this.progress.n+f:null,d?this.progress.stack.concat(d):null)},s.prototype.then=function(o,u){var f=this;return this.thenCore(o,u,function(d,m){return f.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(_){return f.updateProgress(null,d),_}).then(d,m).then(function(_){return f.updateProgress(1),_})})},s.prototype.thenCore=function(o,u,f){f=f||Promise.prototype.then,o&&(o=o.bind(this)),u&&(u=u.bind(this));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:s.convert(Object.assign({},this),Promise.prototype),m=f.call(d,o,u);return s.convert(m,this.__proto__)},s.prototype.thenExternal=function(o,u){return Promise.prototype.then.call(this,o,u)},s.prototype.thenList=function(o){var u=this;return o.forEach(function(f){u=u.thenCore(f)}),u},s.prototype.catch=function(o){o&&(o=o.bind(this));var u=Promise.prototype.catch.call(this,o);return s.convert(u,this)},s.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},s.prototype.error=function(o){return this.then(function(){throw new Error(o)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,kr.getPageSize=function(o,u,f){if(so(o)==="object"){var d=o;o=d.orientation,u=d.unit||u,f=d.format||f}u=u||"mm",f=f||"a4",o=(""+(o||"P")).toLowerCase();var m,_=(""+f).toLowerCase(),w={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(u){case"pt":m=1;break;case"mm":m=72/25.4;break;case"cm":m=72/2.54;break;case"in":m=72;break;case"px":m=.75;break;case"pc":case"em":m=12;break;case"ex":m=6;break;default:throw"Invalid unit: "+u}var y,M=0,k=0;if(w.hasOwnProperty(_))M=w[_][1]/m,k=w[_][0]/m;else try{M=f[1],k=f[0]}catch{throw new Error("Invalid format: "+f)}if(o==="p"||o==="portrait")o="p",k>M&&(y=k,k=M,M=y);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",M>k&&(y=k,k=M,M=y)}return{width:k,height:M,unit:u,k:m,orientation:o}},e.html=function(o,u){(u=u||{}).callback=u.callback||function(){},u.html2canvas=u.html2canvas||{},u.html2canvas.canvas=u.html2canvas.canvas||this.canvas,u.jsPDF=u.jsPDF||this,u.fontFaces=u.fontFaces?u.fontFaces.map(C1):null;var f=new s(u);return u.worker?f:f.from(o).doCallback()}}(kr.API),kr.API.addJS=function(e){return Ob=e,this.internal.events.subscribe("postPutResources",function(){wg=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(wg+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Ib=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Ob+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){wg!==void 0&&Ib!==void 0&&this.internal.out("/Names <</JavaScript "+wg+" 0 R>>")}),this},function(e){var n;e.events.push(["postPutResources",function(){var t=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=t.outline.render().split(/\r\n/),s=0;s<i.length;s++){var o=i[s],u=r.exec(o);if(u!=null){var f=u[1];t.internal.newObjectDeferredBegin(f,!1)}t.internal.write(o)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,m=[];for(s=0;s<d;s++){var _=t.internal.newObject();m.push(_);var w=t.internal.getPageInfo(s+1);t.internal.write("<< /D["+w.objId+" 0 R /XYZ null null null]>> endobj")}var y=t.internal.newObject();for(t.internal.write("<< /Names [ "),s=0;s<m.length;s++)t.internal.write("(page_"+(s+1)+")"+m[s]+" 0 R");t.internal.write(" ] >>","endobj"),n=t.internal.newObject(),t.internal.write("<< /Dests "+y+" 0 R"),t.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+n+" 0 R"))}]),e.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(r,i,s){var o={title:i,options:s,children:[]};return r==null&&(r=this.root),r.children.push(o),o},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(r){r.id=t.internal.newObjectDeferred();for(var i=0;i<r.children.length;i++)this.genIds_r(r.children[i])},t.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},t.outline.renderItems=function(r){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<r.children.length;s++){var o=r.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(r)),s>0&&this.line("/Prev "+this.makeRef(r.children[s-1])),s<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var u=this.count=this.count_r({count:0},o);if(u>0&&this.line("/Count "+u),o.options&&o.options.pageNumber){var f=t.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+f.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var d=0;d<r.children.length;d++)this.renderItems(r.children[d])},t.outline.line=function(r){this.ctx.val+=r+`\r
`},t.outline.makeRef=function(r){return r.id+" 0 R"},t.outline.makeString=function(r){return"("+t.internal.pdfEscape(r)+")"},t.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(r,i){for(var s=0;s<i.children.length;s++)r.count++,this.count_r(r,i.children[s]);return r.count}}])}(kr.API),function(e){var n=[192,193,194,195,196,197,198,199];e.processJPEG=function(t,r,i,s,o,u){var f,d=this.decode.DCT_DECODE,m=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=o||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,(f=function(_){for(var w,y=256*_.charCodeAt(4)+_.charCodeAt(5),M=_.length,k={width:0,height:0,numcomponents:1},F=4;F<M;F+=2){if(F+=y,n.indexOf(_.charCodeAt(F+1))!==-1){w=256*_.charCodeAt(F+5)+_.charCodeAt(F+6),k={width:256*_.charCodeAt(F+7)+_.charCodeAt(F+8),height:w,numcomponents:_.charCodeAt(F+9)};break}y=256*_.charCodeAt(F+2)+_.charCodeAt(F+3)}return k}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:u=this.color_spaces.DEVICE_GRAY;break;case 4:u=this.color_spaces.DEVICE_CMYK;break;case 3:u=this.color_spaces.DEVICE_RGB}m={data:t,width:f.width,height:f.height,colorSpace:u,bitsPerComponent:8,filter:d,index:r,alias:i}}return m}}(kr.API);var Dh,xg,Bb,Rb,Fb,DF=function(){var e,n,t;function r(s){var o,u,f,d,m,_,w,y,M,k,F,I,R,K;for(this.data=s,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},_=null;;){switch(o=this.readUInt32(),M=(function(){var ee,he;for(he=[],ee=0;ee<4;++ee)he.push(String.fromCharCode(this.data[this.pos++]));return he}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(o);break;case"fcTL":_&&this.animation.frames.push(_),this.pos+=4,_={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},m=this.readUInt16(),d=this.readUInt16()||100,_.delay=1e3*m/d,_.disposeOp=this.data[this.pos++],_.blendOp=this.data[this.pos++],_.data=[];break;case"IDAT":case"fdAT":for(M==="fdAT"&&(this.pos+=4,o-=4),s=(_!=null?_.data:void 0)||this.imgData,I=0;0<=o?I<o:I>o;0<=o?++I:--I)s.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(f=this.palette.length/3,this.transparency.indexed=this.read(o),this.transparency.indexed.length>f)throw new Error("More transparent colors than palette size");if((k=f-this.transparency.indexed.length)>0)for(R=0;0<=k?R<k:R>k;0<=k?++R:--R)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(o)[0];break;case 2:this.transparency.rgb=this.read(o)}break;case"tEXt":w=(F=this.read(o)).indexOf(0),y=String.fromCharCode.apply(String,F.slice(0,w)),this.text[y]=String.fromCharCode.apply(String,F.slice(w+1));break;case"IEND":return _&&this.animation.frames.push(_),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(K=this.colorType)===4||K===6,u=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*u,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=o}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}r.prototype.read=function(s){var o,u;for(u=[],o=0;0<=s?o<s:o>s;0<=s?++o:--o)u.push(this.data[this.pos++]);return u},r.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.decodePixels=function(s){var o=this.pixelBitlength/8,u=new Uint8Array(this.width*this.height*o),f=0,d=this;if(s==null&&(s=this.imgData),s.length===0)return new Uint8Array(0);function m(_,w,y,M){var k,F,I,R,K,ee,he,fe,ve,z,U,J,T,D,B,$,W,G,oe,ie,we,Ce=Math.ceil((d.width-_)/y),Te=Math.ceil((d.height-w)/M),Y=d.width==Ce&&d.height==Te;for(D=o*Ce,J=Y?u:new Uint8Array(D*Te),ee=s.length,T=0,F=0;T<Te&&f<ee;){switch(s[f++]){case 0:for(R=W=0;W<D;R=W+=1)J[F++]=s[f++];break;case 1:for(R=G=0;G<D;R=G+=1)k=s[f++],K=R<o?0:J[F-o],J[F++]=(k+K)%256;break;case 2:for(R=oe=0;oe<D;R=oe+=1)k=s[f++],I=(R-R%o)/o,B=T&&J[(T-1)*D+I*o+R%o],J[F++]=(B+k)%256;break;case 3:for(R=ie=0;ie<D;R=ie+=1)k=s[f++],I=(R-R%o)/o,K=R<o?0:J[F-o],B=T&&J[(T-1)*D+I*o+R%o],J[F++]=(k+Math.floor((K+B)/2))%256;break;case 4:for(R=we=0;we<D;R=we+=1)k=s[f++],I=(R-R%o)/o,K=R<o?0:J[F-o],T===0?B=$=0:(B=J[(T-1)*D+I*o+R%o],$=I&&J[(T-1)*D+(I-1)*o+R%o]),he=K+B-$,fe=Math.abs(he-K),z=Math.abs(he-B),U=Math.abs(he-$),ve=fe<=z&&fe<=U?K:z<=U?B:$,J[F++]=(k+ve)%256;break;default:throw new Error("Invalid filter algorithm: "+s[f-1])}if(!Y){var H=((w+T*M)*d.width+_)*o,Q=T*D;for(R=0;R<Ce;R+=1){for(var ue=0;ue<o;ue+=1)u[H++]=J[Q++];H+=(y-1)*o}}T++}}return s=fF(s),d.interlaceMethod==1?(m(0,0,8,8),m(4,0,8,8),m(0,4,4,8),m(2,0,4,4),m(0,2,2,4),m(1,0,2,2),m(0,1,1,2)):m(0,0,1,1),u},r.prototype.decodePalette=function(){var s,o,u,f,d,m,_,w,y;for(u=this.palette,m=this.transparency.indexed||[],d=new Uint8Array((m.length||0)+u.length),f=0,s=0,o=_=0,w=u.length;_<w;o=_+=3)d[f++]=u[o],d[f++]=u[o+1],d[f++]=u[o+2],d[f++]=(y=m[s++])!=null?y:255;return d},r.prototype.copyToImageData=function(s,o){var u,f,d,m,_,w,y,M,k,F,I;if(f=this.colors,k=null,u=this.hasAlphaChannel,this.palette.length&&(k=(I=this._decodedPalette)!=null?I:this._decodedPalette=this.decodePalette(),f=4,u=!0),M=(d=s.data||s).length,_=k||o,m=w=0,f===1)for(;m<M;)y=k?4*o[m/4]:w,F=_[y++],d[m++]=F,d[m++]=F,d[m++]=F,d[m++]=u?_[y++]:255,w=y;else for(;m<M;)y=k?4*o[m/4]:w,d[m++]=_[y++],d[m++]=_[y++],d[m++]=_[y++],d[m++]=u?_[y++]:255,w=y},r.prototype.decode=function(){var s;return s=new Uint8Array(this.width*this.height*4),this.copyToImageData(s,this.decodePixels()),s};var i=function(){if(Object.prototype.toString.call(Dr)==="[object Window]"){try{n=Dr.document.createElement("canvas"),t=n.getContext("2d")}catch{return!1}return!0}return!1};return i(),e=function(s){var o;if(i()===!0)return t.width=s.width,t.height=s.height,t.clearRect(0,0,s.width,s.height),t.putImageData(s,0,0),(o=new Image).src=n.toDataURL(),o;throw new Error("This method requires a Browser with Canvas-capability.")},r.prototype.decodeFrames=function(s){var o,u,f,d,m,_,w,y;if(this.animation){for(y=[],u=m=0,_=(w=this.animation.frames).length;m<_;u=++m)o=w[u],f=s.createImageData(o.width,o.height),d=this.decodePixels(new Uint8Array(o.data)),this.copyToImageData(f,d),o.imageData=f,y.push(o.image=e(f));return y}},r.prototype.renderFrame=function(s,o){var u,f,d;return u=(f=this.animation.frames)[o],d=f[o-1],o===0&&s.clearRect(0,0,this.width,this.height),(d!=null?d.disposeOp:void 0)===1?s.clearRect(d.xOffset,d.yOffset,d.width,d.height):(d!=null?d.disposeOp:void 0)===2&&s.putImageData(d.imageData,d.xOffset,d.yOffset),u.blendOp===0&&s.clearRect(u.xOffset,u.yOffset,u.width,u.height),s.drawImage(u.image,u.xOffset,u.yOffset)},r.prototype.animate=function(s){var o,u,f,d,m,_,w=this;return u=0,_=this.animation,d=_.numFrames,f=_.frames,m=_.numPlays,(o=function(){var y,M;if(y=u++%d,M=f[y],w.renderFrame(s,y),d>1&&u/d<m)return w.animation._timeout=setTimeout(o,M.delay)})()},r.prototype.stopAnimation=function(){var s;return clearTimeout((s=this.animation)!=null?s._timeout:void 0)},r.prototype.render=function(s){var o,u;return s._png&&s._png.stopAnimation(),s._png=this,s.width=this.width,s.height=this.height,o=s.getContext("2d"),this.animation?(this.decodeFrames(o),this.animate(o)):(u=o.createImageData(this.width,this.height),this.copyToImageData(u,this.decodePixels()),o.putImageData(u,0,0))},r}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function IF(e){var n=0;if(e[n++]!==71||e[n++]!==73||e[n++]!==70||e[n++]!==56||(e[n++]+1&253)!=56||e[n++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=e[n++]|e[n++]<<8,r=e[n++]|e[n++]<<8,i=e[n++],s=i>>7,o=1<<(7&i)+1;e[n++],e[n++];var u=null,f=null;s&&(u=n,f=o,n+=3*o);var d=!0,m=[],_=0,w=null,y=0,M=null;for(this.width=t,this.height=r;d&&n<e.length;)switch(e[n++]){case 33:switch(e[n++]){case 255:if(e[n]!==11||e[n+1]==78&&e[n+2]==69&&e[n+3]==84&&e[n+4]==83&&e[n+5]==67&&e[n+6]==65&&e[n+7]==80&&e[n+8]==69&&e[n+9]==50&&e[n+10]==46&&e[n+11]==48&&e[n+12]==3&&e[n+13]==1&&e[n+16]==0)n+=14,M=e[n++]|e[n++]<<8,n++;else for(n+=12;;){if(!((T=e[n++])>=0))throw Error("Invalid block size");if(T===0)break;n+=T}break;case 249:if(e[n++]!==4||e[n+4]!==0)throw new Error("Invalid graphics extension block.");var k=e[n++];_=e[n++]|e[n++]<<8,w=e[n++],!(1&k)&&(w=null),y=k>>2&7,n++;break;case 254:for(;;){if(!((T=e[n++])>=0))throw Error("Invalid block size");if(T===0)break;n+=T}break;default:throw new Error("Unknown graphic control label: 0x"+e[n-1].toString(16))}break;case 44:var F=e[n++]|e[n++]<<8,I=e[n++]|e[n++]<<8,R=e[n++]|e[n++]<<8,K=e[n++]|e[n++]<<8,ee=e[n++],he=ee>>6&1,fe=1<<(7&ee)+1,ve=u,z=f,U=!1;ee>>7&&(U=!0,ve=n,z=fe,n+=3*fe);var J=n;for(n++;;){var T;if(!((T=e[n++])>=0))throw Error("Invalid block size");if(T===0)break;n+=T}m.push({x:F,y:I,width:R,height:K,has_local_palette:U,palette_offset:ve,palette_size:z,data_offset:J,data_length:n-J,transparent_index:w,interlaced:!!he,delay:_,disposal:y});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+e[n-1].toString(16))}this.numFrames=function(){return m.length},this.loopCount=function(){return M},this.frameInfo=function(D){if(D<0||D>=m.length)throw new Error("Frame index out of range.");return m[D]},this.decodeAndBlitFrameBGRA=function(D,B){var $=this.frameInfo(D),W=$.width*$.height,G=new Uint8Array(W);jb(e,$.data_offset,G,W);var oe=$.palette_offset,ie=$.transparent_index;ie===null&&(ie=256);var we=$.width,Ce=t-we,Te=we,Y=4*($.y*t+$.x),H=4*(($.y+$.height)*t+$.x),Q=Y,ue=4*Ce;$.interlaced===!0&&(ue+=4*t*7);for(var le=8,pe=0,Z=G.length;pe<Z;++pe){var N=G[pe];if(Te===0&&(Te=we,(Q+=ue)>=H&&(ue=4*Ce+4*t*(le-1),Q=Y+(we+Ce)*(le<<1),le>>=1)),N===ie)Q+=4;else{var ke=e[oe+3*N],Me=e[oe+3*N+1],Ue=e[oe+3*N+2];B[Q++]=Ue,B[Q++]=Me,B[Q++]=ke,B[Q++]=255}--Te}},this.decodeAndBlitFrameRGBA=function(D,B){var $=this.frameInfo(D),W=$.width*$.height,G=new Uint8Array(W);jb(e,$.data_offset,G,W);var oe=$.palette_offset,ie=$.transparent_index;ie===null&&(ie=256);var we=$.width,Ce=t-we,Te=we,Y=4*($.y*t+$.x),H=4*(($.y+$.height)*t+$.x),Q=Y,ue=4*Ce;$.interlaced===!0&&(ue+=4*t*7);for(var le=8,pe=0,Z=G.length;pe<Z;++pe){var N=G[pe];if(Te===0&&(Te=we,(Q+=ue)>=H&&(ue=4*Ce+4*t*(le-1),Q=Y+(we+Ce)*(le<<1),le>>=1)),N===ie)Q+=4;else{var ke=e[oe+3*N],Me=e[oe+3*N+1],Ue=e[oe+3*N+2];B[Q++]=ke,B[Q++]=Me,B[Q++]=Ue,B[Q++]=255}--Te}}}function jb(e,n,t,r){for(var i=e[n++],s=1<<i,o=s+1,u=o+1,f=i+1,d=(1<<f)-1,m=0,_=0,w=0,y=e[n++],M=new Int32Array(4096),k=null;;){for(;m<16&&y!==0;)_|=e[n++]<<m,m+=8,y===1?y=e[n++]:--y;if(m<f)break;var F=_&d;if(_>>=f,m-=f,F!==s){if(F===o)break;for(var I=F<u?F:k,R=0,K=I;K>s;)K=M[K]>>8,++R;var ee=K;if(w+R+(I!==F?1:0)>r)return void mo.log("Warning, gif stream longer than expected.");t[w++]=ee;var he=w+=R;for(I!==F&&(t[w++]=ee),K=I;R--;)K=M[K],t[--he]=255&K,K>>=8;k!==null&&u<4096&&(M[u++]=k<<8|ee,u>=d+1&&f<12&&(++f,d=d<<1|1)),k=F}else u=o+1,d=(1<<(f=i+1))-1,k=null}return w!==r&&mo.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function pv(e){var n,t,r,i,s,o=Math.floor,u=new Array(64),f=new Array(64),d=new Array(64),m=new Array(64),_=new Array(65535),w=new Array(65535),y=new Array(64),M=new Array(64),k=[],F=0,I=7,R=new Array(64),K=new Array(64),ee=new Array(64),he=new Array(256),fe=new Array(2048),ve=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],z=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],U=[0,1,2,3,4,5,6,7,8,9,10,11],J=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],T=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],D=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],B=[0,1,2,3,4,5,6,7,8,9,10,11],$=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],W=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function G(Y,H){for(var Q=0,ue=0,le=new Array,pe=1;pe<=16;pe++){for(var Z=1;Z<=Y[pe];Z++)le[H[ue]]=[],le[H[ue]][0]=Q,le[H[ue]][1]=pe,ue++,Q++;Q*=2}return le}function oe(Y){for(var H=Y[0],Q=Y[1]-1;Q>=0;)H&1<<Q&&(F|=1<<I),Q--,--I<0&&(F==255?(ie(255),ie(0)):ie(F),I=7,F=0)}function ie(Y){k.push(Y)}function we(Y){ie(Y>>8&255),ie(255&Y)}function Ce(Y,H,Q,ue,le){for(var pe,Z=le[0],N=le[240],ke=function(tt,Ze){var et,He,wt,Pt,kt,Jt,rn,un,Ke,ot,rt=0;for(Ke=0;Ke<8;++Ke){et=tt[rt],He=tt[rt+1],wt=tt[rt+2],Pt=tt[rt+3],kt=tt[rt+4],Jt=tt[rt+5],rn=tt[rt+6];var Ft=et+(un=tt[rt+7]),Qt=et-un,Bn=He+rn,Ln=He-rn,Nn=wt+Jt,ar=wt-Jt,En=Pt+kt,jn=Pt-kt,Mn=Ft+En,Yn=Ft-En,br=Bn+Nn,Or=Bn-Nn;tt[rt]=Mn+br,tt[rt+4]=Mn-br;var gr=.707106781*(Or+Yn);tt[rt+2]=Yn+gr,tt[rt+6]=Yn-gr;var ii=.382683433*((Mn=jn+ar)-(Or=Ln+Qt)),ft=.5411961*Mn+ii,Qe=1.306562965*Or+ii,$t=.707106781*(br=ar+Ln),xn=Qt+$t,vn=Qt-$t;tt[rt+5]=vn+ft,tt[rt+3]=vn-ft,tt[rt+1]=xn+Qe,tt[rt+7]=xn-Qe,rt+=8}for(rt=0,Ke=0;Ke<8;++Ke){et=tt[rt],He=tt[rt+8],wt=tt[rt+16],Pt=tt[rt+24],kt=tt[rt+32],Jt=tt[rt+40],rn=tt[rt+48];var bn=et+(un=tt[rt+56]),Ht=et-un,Hn=He+rn,St=He-rn,mt=wt+Jt,wn=wt-Jt,Qr=Pt+kt,Tt=Pt-kt,Rn=bn+Qr,Qn=bn-Qr,Pi=Hn+mt,Sr=Hn-mt;tt[rt]=Rn+Pi,tt[rt+32]=Rn-Pi;var Pr=.707106781*(Sr+Qn);tt[rt+16]=Qn+Pr,tt[rt+48]=Qn-Pr;var dr=.382683433*((Rn=Tt+wn)-(Sr=St+Ht)),Mi=.5411961*Rn+dr,wr=1.306562965*Sr+dr,Gr=.707106781*(Pi=wn+St),Ir=Ht+Gr,tn=Ht-Gr;tt[rt+40]=tn+Mi,tt[rt+24]=tn-Mi,tt[rt+8]=Ir+wr,tt[rt+56]=Ir-wr,rt++}for(Ke=0;Ke<64;++Ke)ot=tt[Ke]*Ze[Ke],y[Ke]=ot>0?ot+.5|0:ot-.5|0;return y}(Y,H),Me=0;Me<64;++Me)M[ve[Me]]=ke[Me];var Ue=M[0]-Q;Q=M[0],Ue==0?oe(ue[0]):(oe(ue[w[pe=32767+Ue]]),oe(_[pe]));for(var ce=63;ce>0&&M[ce]==0;)ce--;if(ce==0)return oe(Z),Q;for(var ne,ye=1;ye<=ce;){for(var de=ye;M[ye]==0&&ye<=ce;)++ye;var We=ye-de;if(We>=16){ne=We>>4;for(var Ge=1;Ge<=ne;++Ge)oe(N);We&=15}pe=32767+M[ye],oe(le[(We<<4)+w[pe]]),oe(_[pe]),ye++}return ce!=63&&oe(Z),Q}function Te(Y){Y=Math.min(Math.max(Y,1),100),s!=Y&&(function(H){for(var Q=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],ue=0;ue<64;ue++){var le=o((Q[ue]*H+50)/100);le=Math.min(Math.max(le,1),255),u[ve[ue]]=le}for(var pe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Z=0;Z<64;Z++){var N=o((pe[Z]*H+50)/100);N=Math.min(Math.max(N,1),255),f[ve[Z]]=N}for(var ke=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Me=0,Ue=0;Ue<8;Ue++)for(var ce=0;ce<8;ce++)d[Me]=1/(u[ve[Me]]*ke[Ue]*ke[ce]*8),m[Me]=1/(f[ve[Me]]*ke[Ue]*ke[ce]*8),Me++}(Y<50?Math.floor(5e3/Y):Math.floor(200-2*Y)),s=Y)}this.encode=function(Y,H){H&&Te(H),k=new Array,F=0,I=7,we(65496),we(65504),we(16),ie(74),ie(70),ie(73),ie(70),ie(0),ie(1),ie(1),ie(0),we(1),we(1),ie(0),ie(0),function(){we(65499),we(132),ie(0);for(var He=0;He<64;He++)ie(u[He]);ie(1);for(var wt=0;wt<64;wt++)ie(f[wt])}(),function(He,wt){we(65472),we(17),ie(8),we(wt),we(He),ie(3),ie(1),ie(17),ie(0),ie(2),ie(17),ie(1),ie(3),ie(17),ie(1)}(Y.width,Y.height),function(){we(65476),we(418),ie(0);for(var He=0;He<16;He++)ie(z[He+1]);for(var wt=0;wt<=11;wt++)ie(U[wt]);ie(16);for(var Pt=0;Pt<16;Pt++)ie(J[Pt+1]);for(var kt=0;kt<=161;kt++)ie(T[kt]);ie(1);for(var Jt=0;Jt<16;Jt++)ie(D[Jt+1]);for(var rn=0;rn<=11;rn++)ie(B[rn]);ie(17);for(var un=0;un<16;un++)ie($[un+1]);for(var Ke=0;Ke<=161;Ke++)ie(W[Ke])}(),we(65498),we(12),ie(3),ie(1),ie(0),ie(2),ie(17),ie(3),ie(17),ie(0),ie(63),ie(0);var Q=0,ue=0,le=0;F=0,I=7,this.encode.displayName="_encode_";for(var pe,Z,N,ke,Me,Ue,ce,ne,ye,de=Y.data,We=Y.width,Ge=Y.height,tt=4*We,Ze=0;Ze<Ge;){for(pe=0;pe<tt;){for(Me=tt*Ze+pe,ce=-1,ne=0,ye=0;ye<64;ye++)Ue=Me+(ne=ye>>3)*tt+(ce=4*(7&ye)),Ze+ne>=Ge&&(Ue-=tt*(Ze+1+ne-Ge)),pe+ce>=tt&&(Ue-=pe+ce-tt+4),Z=de[Ue++],N=de[Ue++],ke=de[Ue++],R[ye]=(fe[Z]+fe[N+256>>0]+fe[ke+512>>0]>>16)-128,K[ye]=(fe[Z+768>>0]+fe[N+1024>>0]+fe[ke+1280>>0]>>16)-128,ee[ye]=(fe[Z+1280>>0]+fe[N+1536>>0]+fe[ke+1792>>0]>>16)-128;Q=Ce(R,d,Q,n,r),ue=Ce(K,m,ue,t,i),le=Ce(ee,m,le,t,i),pe+=32}Ze+=8}if(I>=0){var et=[];et[1]=I+1,et[0]=(1<<I+1)-1,oe(et)}return we(65497),new Uint8Array(k)},e=e||50,function(){for(var Y=String.fromCharCode,H=0;H<256;H++)he[H]=Y(H)}(),n=G(z,U),t=G(D,B),r=G(J,T),i=G($,W),function(){for(var Y=1,H=2,Q=1;Q<=15;Q++){for(var ue=Y;ue<H;ue++)w[32767+ue]=Q,_[32767+ue]=[],_[32767+ue][1]=Q,_[32767+ue][0]=ue;for(var le=-(H-1);le<=-Y;le++)w[32767+le]=Q,_[32767+le]=[],_[32767+le][1]=Q,_[32767+le][0]=H-1+le;Y<<=1,H<<=1}}(),function(){for(var Y=0;Y<256;Y++)fe[Y]=19595*Y,fe[Y+256>>0]=38470*Y,fe[Y+512>>0]=7471*Y+32768,fe[Y+768>>0]=-11059*Y,fe[Y+1024>>0]=-21709*Y,fe[Y+1280>>0]=32768*Y+8421375,fe[Y+1536>>0]=-27439*Y,fe[Y+1792>>0]=-5329*Y}(),Te(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Iu(e,n){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!n,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function zb(e){function n(z){if(!z)throw Error("assert :P")}function t(z,U,J){for(var T=0;4>T;T++)if(z[U+T]!=J.charCodeAt(T))return!0;return!1}function r(z,U,J,T,D){for(var B=0;B<D;B++)z[U+B]=J[T+B]}function i(z,U,J,T){for(var D=0;D<T;D++)z[U+D]=J}function s(z){return new Int32Array(z)}function o(z,U){for(var J=[],T=0;T<z;T++)J.push(new U);return J}function u(z,U){var J=[];return function T(D,B,$){for(var W=$[B],G=0;G<W&&(D.push($.length>B+1?[]:new U),!($.length<B+1));G++)T(D[G],B+1,$)}(J,0,z),J}var f=function(){var z=this;function U(b,P){for(var q=1<<P-1>>>0;b&q;)q>>>=1;return q?(b&q-1)+q:b}function J(b,P,q,ae,be){n(!(ae%q));do b[P+(ae-=q)]=be;while(0<ae)}function T(b,P,q,ae,be){if(n(2328>=be),512>=be)var Ee=s(512);else if((Ee=s(be))==null)return 0;return function(Ae,Ne,Ie,Ve,ht,Ot){var Bt,xt,Kt=Ne,Gt=1<<Ie,dt=s(16),yt=s(16);for(n(ht!=0),n(Ve!=null),n(Ae!=null),n(0<Ie),xt=0;xt<ht;++xt){if(15<Ve[xt])return 0;++dt[Ve[xt]]}if(dt[0]==ht)return 0;for(yt[1]=0,Bt=1;15>Bt;++Bt){if(dt[Bt]>1<<Bt)return 0;yt[Bt+1]=yt[Bt]+dt[Bt]}for(xt=0;xt<ht;++xt)Bt=Ve[xt],0<Ve[xt]&&(Ot[yt[Bt]++]=xt);if(yt[15]==1)return(Ve=new D).g=0,Ve.value=Ot[0],J(Ae,Kt,1,Gt,Ve),Gt;var en,dn=-1,nn=Gt-1,kn=0,Pn=1,tr=1,l=1<<Ie;for(xt=0,Bt=1,ht=2;Bt<=Ie;++Bt,ht<<=1){if(Pn+=tr<<=1,0>(tr-=dt[Bt]))return 0;for(;0<dt[Bt];--dt[Bt])(Ve=new D).g=Bt,Ve.value=Ot[xt++],J(Ae,Kt+kn,ht,l,Ve),kn=U(kn,Bt)}for(Bt=Ie+1,ht=2;15>=Bt;++Bt,ht<<=1){if(Pn+=tr<<=1,0>(tr-=dt[Bt]))return 0;for(;0<dt[Bt];--dt[Bt]){if(Ve=new D,(kn&nn)!=dn){for(Kt+=l,en=1<<(dn=Bt)-Ie;15>dn&&!(0>=(en-=dt[dn]));)++dn,en<<=1;Gt+=l=1<<(en=dn-Ie),Ae[Ne+(dn=kn&nn)].g=en+Ie,Ae[Ne+dn].value=Kt-Ne-dn}Ve.g=Bt-Ie,Ve.value=Ot[xt++],J(Ae,Kt+(kn>>Ie),ht,l,Ve),kn=U(kn,Bt)}}return Pn!=2*yt[15]-1?0:Gt}(b,P,q,ae,be,Ee)}function D(){this.value=this.g=0}function B(){this.value=this.g=0}function $(){this.G=o(5,D),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(wo,B)}function W(b,P,q,ae){n(b!=null),n(P!=null),n(2147483648>ae),b.Ca=254,b.I=0,b.b=-8,b.Ka=0,b.oa=P,b.pa=q,b.Jd=P,b.Yc=q+ae,b.Zc=4<=ae?q+ae-4+1:q,pe(b)}function G(b,P){for(var q=0;0<P--;)q|=N(b,128)<<P;return q}function oe(b,P){var q=G(b,P);return Z(b)?-q:q}function ie(b,P,q,ae){var be,Ee=0;for(n(b!=null),n(P!=null),n(4294967288>ae),b.Sb=ae,b.Ra=0,b.u=0,b.h=0,4<ae&&(ae=4),be=0;be<ae;++be)Ee+=P[q+be]<<8*be;b.Ra=Ee,b.bb=ae,b.oa=P,b.pa=q}function we(b){for(;8<=b.u&&b.bb<b.Sb;)b.Ra>>>=8,b.Ra+=b.oa[b.pa+b.bb]<<gs-8>>>0,++b.bb,b.u-=8;Q(b)&&(b.h=1,b.u=0)}function Ce(b,P){if(n(0<=P),!b.h&&P<=Ns){var q=H(b)&ra[P];return b.u+=P,we(b),q}return b.h=1,b.u=0}function Te(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function Y(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function H(b){return b.Ra>>>(b.u&gs-1)>>>0}function Q(b){return n(b.bb<=b.Sb),b.h||b.bb==b.Sb&&b.u>gs}function ue(b,P){b.u=P,b.h=Q(b)}function le(b){b.u>=cl&&(n(b.u>=cl),we(b))}function pe(b){n(b!=null&&b.oa!=null),b.pa<b.Zc?(b.I=(b.oa[b.pa++]|b.I<<8)>>>0,b.b+=8):(n(b!=null&&b.oa!=null),b.pa<b.Yc?(b.b+=8,b.I=b.oa[b.pa++]|b.I<<8):b.Ka?b.b=0:(b.I<<=8,b.b+=8,b.Ka=1))}function Z(b){return G(b,1)}function N(b,P){var q=b.Ca;0>b.b&&pe(b);var ae=b.b,be=q*P>>>8,Ee=(b.I>>>ae>be)+0;for(Ee?(q-=be,b.I-=be+1<<ae>>>0):q=be+1,ae=q,be=0;256<=ae;)be+=8,ae>>=8;return ae=7^be+$o[ae],b.b-=ae,b.Ca=(q<<ae)-1,Ee}function ke(b,P,q){b[P+0]=q>>24&255,b[P+1]=q>>16&255,b[P+2]=q>>8&255,b[P+3]=q>>0&255}function Me(b,P){return b[P+0]<<0|b[P+1]<<8}function Ue(b,P){return Me(b,P)|b[P+2]<<16}function ce(b,P){return Me(b,P)|Me(b,P+2)<<16}function ne(b,P){var q=1<<P;return n(b!=null),n(0<P),b.X=s(q),b.X==null?0:(b.Mb=32-P,b.Xa=P,1)}function ye(b,P){n(b!=null),n(P!=null),n(b.Xa==P.Xa),r(P.X,0,b.X,0,1<<P.Xa)}function de(){this.X=[],this.Xa=this.Mb=0}function We(b,P,q,ae){n(q!=null),n(ae!=null);var be=q[0],Ee=ae[0];return be==0&&(be=(b*Ee+P/2)/P),Ee==0&&(Ee=(P*be+b/2)/b),0>=be||0>=Ee?0:(q[0]=be,ae[0]=Ee,1)}function Ge(b,P){return b+(1<<P)-1>>>P}function tt(b,P){return((4278255360&b)+(4278255360&P)>>>0&4278255360)+((16711935&b)+(16711935&P)>>>0&16711935)>>>0}function Ze(b,P){z[P]=function(q,ae,be,Ee,Ae,Ne,Ie){var Ve;for(Ve=0;Ve<Ae;++Ve){var ht=z[b](Ne[Ie+Ve-1],be,Ee+Ve);Ne[Ie+Ve]=tt(q[ae+Ve],ht)}}}function et(){this.ud=this.hd=this.jd=0}function He(b,P){return((4278124286&(b^P))>>>1)+(b&P)>>>0}function wt(b){return 0<=b&&256>b?b:0>b?0:255<b?255:void 0}function Pt(b,P){return wt(b+(b-P+.5>>1))}function kt(b,P,q){return Math.abs(P-q)-Math.abs(b-q)}function Jt(b,P,q,ae,be,Ee,Ae){for(ae=Ee[Ae-1],q=0;q<be;++q)Ee[Ae+q]=ae=tt(b[P+q],ae)}function rn(b,P,q,ae,be){var Ee;for(Ee=0;Ee<q;++Ee){var Ae=b[P+Ee],Ne=Ae>>8&255,Ie=16711935&(Ie=(Ie=16711935&Ae)+((Ne<<16)+Ne));ae[be+Ee]=(4278255360&Ae)+Ie>>>0}}function un(b,P){P.jd=b>>0&255,P.hd=b>>8&255,P.ud=b>>16&255}function Ke(b,P,q,ae,be,Ee){var Ae;for(Ae=0;Ae<ae;++Ae){var Ne=P[q+Ae],Ie=Ne>>>8,Ve=Ne,ht=255&(ht=(ht=Ne>>>16)+((b.jd<<24>>24)*(Ie<<24>>24)>>>5));Ve=255&(Ve=(Ve=Ve+((b.hd<<24>>24)*(Ie<<24>>24)>>>5))+((b.ud<<24>>24)*(ht<<24>>24)>>>5)),be[Ee+Ae]=(4278255360&Ne)+(ht<<16)+Ve}}function ot(b,P,q,ae,be){z[P]=function(Ee,Ae,Ne,Ie,Ve,ht,Ot,Bt,xt){for(Ie=Ot;Ie<Bt;++Ie)for(Ot=0;Ot<xt;++Ot)Ve[ht++]=be(Ne[ae(Ee[Ae++])])},z[b]=function(Ee,Ae,Ne,Ie,Ve,ht,Ot){var Bt=8>>Ee.b,xt=Ee.Ea,Kt=Ee.K[0],Gt=Ee.w;if(8>Bt)for(Ee=(1<<Ee.b)-1,Gt=(1<<Bt)-1;Ae<Ne;++Ae){var dt,yt=0;for(dt=0;dt<xt;++dt)dt&Ee||(yt=ae(Ie[Ve++])),ht[Ot++]=be(Kt[yt&Gt]),yt>>=Bt}else z["VP8LMapColor"+q](Ie,Ve,Kt,Gt,ht,Ot,Ae,Ne,xt)}}function rt(b,P,q,ae,be){for(q=P+q;P<q;){var Ee=b[P++];ae[be++]=Ee>>16&255,ae[be++]=Ee>>8&255,ae[be++]=Ee>>0&255}}function Ft(b,P,q,ae,be){for(q=P+q;P<q;){var Ee=b[P++];ae[be++]=Ee>>16&255,ae[be++]=Ee>>8&255,ae[be++]=Ee>>0&255,ae[be++]=Ee>>24&255}}function Qt(b,P,q,ae,be){for(q=P+q;P<q;){var Ee=(Ae=b[P++])>>16&240|Ae>>12&15,Ae=Ae>>0&240|Ae>>28&15;ae[be++]=Ee,ae[be++]=Ae}}function Bn(b,P,q,ae,be){for(q=P+q;P<q;){var Ee=(Ae=b[P++])>>16&248|Ae>>13&7,Ae=Ae>>5&224|Ae>>3&31;ae[be++]=Ee,ae[be++]=Ae}}function Ln(b,P,q,ae,be){for(q=P+q;P<q;){var Ee=b[P++];ae[be++]=Ee>>0&255,ae[be++]=Ee>>8&255,ae[be++]=Ee>>16&255}}function Nn(b,P,q,ae,be,Ee){if(Ee==0)for(q=P+q;P<q;)ke(ae,((Ee=b[P++])[0]>>24|Ee[1]>>8&65280|Ee[2]<<8&16711680|Ee[3]<<24)>>>0),be+=32;else r(ae,be,b,P,q)}function ar(b,P){z[P][0]=z[b+"0"],z[P][1]=z[b+"1"],z[P][2]=z[b+"2"],z[P][3]=z[b+"3"],z[P][4]=z[b+"4"],z[P][5]=z[b+"5"],z[P][6]=z[b+"6"],z[P][7]=z[b+"7"],z[P][8]=z[b+"8"],z[P][9]=z[b+"9"],z[P][10]=z[b+"10"],z[P][11]=z[b+"11"],z[P][12]=z[b+"12"],z[P][13]=z[b+"13"],z[P][14]=z[b+"0"],z[P][15]=z[b+"0"]}function En(b){return b==Do||b==Io||b==Ks||b==a}function jn(){this.eb=[],this.size=this.A=this.fb=0}function Mn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Yn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new jn,this.f.kb=new Mn,this.sd=null}function br(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Or(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function gr(b){return alert("todo:WebPSamplerProcessPlane"),b.T}function ii(b,P){var q=b.T,ae=P.ba.f.RGBA,be=ae.eb,Ee=ae.fb+b.ka*ae.A,Ae=Wo[P.ba.S],Ne=b.y,Ie=b.O,Ve=b.f,ht=b.N,Ot=b.ea,Bt=b.W,xt=P.cc,Kt=P.dc,Gt=P.Mc,dt=P.Nc,yt=b.ka,en=b.ka+b.T,dn=b.U,nn=dn+1>>1;for(yt==0?Ae(Ne,Ie,null,null,Ve,ht,Ot,Bt,Ve,ht,Ot,Bt,be,Ee,null,null,dn):(Ae(P.ec,P.fc,Ne,Ie,xt,Kt,Gt,dt,Ve,ht,Ot,Bt,be,Ee-ae.A,be,Ee,dn),++q);yt+2<en;yt+=2)xt=Ve,Kt=ht,Gt=Ot,dt=Bt,ht+=b.Rc,Bt+=b.Rc,Ee+=2*ae.A,Ae(Ne,(Ie+=2*b.fa)-b.fa,Ne,Ie,xt,Kt,Gt,dt,Ve,ht,Ot,Bt,be,Ee-ae.A,be,Ee,dn);return Ie+=b.fa,b.j+en<b.o?(r(P.ec,P.fc,Ne,Ie,dn),r(P.cc,P.dc,Ve,ht,nn),r(P.Mc,P.Nc,Ot,Bt,nn),q--):1&en||Ae(Ne,Ie,null,null,Ve,ht,Ot,Bt,Ve,ht,Ot,Bt,be,Ee+ae.A,null,null,dn),q}function ft(b,P,q){var ae=b.F,be=[b.J];if(ae!=null){var Ee=b.U,Ae=P.ba.S,Ne=Ae==Zs||Ae==Ks;P=P.ba.f.RGBA;var Ie=[0],Ve=b.ka;Ie[0]=b.T,b.Kb&&(Ve==0?--Ie[0]:(--Ve,be[0]-=b.width),b.j+b.ka+b.T==b.o&&(Ie[0]=b.o-b.j-Ve));var ht=P.eb;Ve=P.fb+Ve*P.A,b=ki(ae,be[0],b.width,Ee,Ie,ht,Ve+(Ne?0:3),P.A),n(q==Ie),b&&En(Ae)&&No(ht,Ve,Ne,Ee,Ie,P.A)}return 0}function Qe(b){var P=b.ma,q=P.ba.S,ae=11>q,be=q==pr||q==Ea||q==Zs||q==as||q==12||En(q);if(P.memory=null,P.Ib=null,P.Jb=null,P.Nd=null,!xu(P.Oa,b,be?11:12))return 0;if(be&&En(q)&&fn(),b.da)alert("todo:use_scaling");else{if(ae){if(P.Ib=gr,b.Kb){if(q=b.U+1>>1,P.memory=s(b.U+2*q),P.memory==null)return 0;P.ec=P.memory,P.fc=0,P.cc=P.ec,P.dc=P.fc+b.U,P.Mc=P.cc,P.Nc=P.dc+q,P.Ib=ii,fn()}}else alert("todo:EmitYUV");be&&(P.Jb=ft,ae&&Lt())}if(ae&&!Qu){for(b=0;256>b;++b)Yc[b]=89858*(b-128)+qa>>Kc,Jc[b]=-22014*(b-128)+qa,_d[b]=-45773*(b-128),Rl[b]=113618*(b-128)+qa>>Kc;for(b=xc;b<Nf;++b)P=76283*(b-16)+qa>>Kc,Xc[b-xc]=Ur(P,255),ph[b-xc]=Ur(P+8>>4,15);Qu=1}return 1}function $t(b){var P=b.ma,q=b.U,ae=b.T;return n(!(1&b.ka)),0>=q||0>=ae?0:(q=P.Ib(b,P),P.Jb!=null&&P.Jb(b,P,q),P.Dc+=q,1)}function xn(b){b.ma.memory=null}function vn(b,P,q,ae){return Ce(b,8)!=47?0:(P[0]=Ce(b,14)+1,q[0]=Ce(b,14)+1,ae[0]=Ce(b,1),Ce(b,3)!=0?0:!b.h)}function bn(b,P){if(4>b)return b+1;var q=b-2>>1;return(2+(1&b)<<q)+Ce(P,q)+1}function Ht(b,P){return 120<P?P-120:1<=(q=((q=st[P-1])>>4)*b+(8-(15&q)))?q:1;var q}function Hn(b,P,q){var ae=H(q),be=b[P+=255&ae].g-8;return 0<be&&(ue(q,q.u+8),ae=H(q),P+=b[P].value,P+=ae&(1<<be)-1),ue(q,q.u+b[P].g),b[P].value}function St(b,P,q){return q.g+=b.g,q.value+=b.value<<P>>>0,n(8>=q.g),b.g}function mt(b,P,q){var ae=b.xc;return n((P=ae==0?0:b.vc[b.md*(q>>ae)+(P>>ae)])<b.Wb),b.Ya[P]}function wn(b,P,q,ae){var be=b.ab,Ee=b.c*P,Ae=b.C;P=Ae+P;var Ne=q,Ie=ae;for(ae=b.Ta,q=b.Ua;0<be--;){var Ve=b.gc[be],ht=Ae,Ot=P,Bt=Ne,xt=Ie,Kt=(Ie=ae,Ne=q,Ve.Ea);switch(n(ht<Ot),n(Ot<=Ve.nc),Ve.hc){case 2:Xu(Bt,xt,(Ot-ht)*Kt,Ie,Ne);break;case 0:var Gt=ht,dt=Ot,yt=Ie,en=Ne,dn=(l=Ve).Ea;Gt==0&&(is(Bt,xt,null,null,1,yt,en),Jt(Bt,xt+1,0,0,dn-1,yt,en+1),xt+=dn,en+=dn,++Gt);for(var nn=1<<l.b,kn=nn-1,Pn=Ge(dn,l.b),tr=l.K,l=l.w+(Gt>>l.b)*Pn;Gt<dt;){var h=tr,v=l,x=1;for(os(Bt,xt,yt,en-dn,1,yt,en);x<dn;){var E=(x&~kn)+nn;E>dn&&(E=dn),(0,wa[h[v++]>>8&15])(Bt,xt+ +x,yt,en+x-dn,E-x,yt,en+x),x=E}xt+=dn,en+=dn,++Gt&kn||(l+=Pn)}Ot!=Ve.nc&&r(Ie,Ne-Kt,Ie,Ne+(Ot-ht-1)*Kt,Kt);break;case 1:for(Kt=Bt,dt=xt,dn=(Bt=Ve.Ea)-(en=Bt&~(yt=(xt=1<<Ve.b)-1)),Gt=Ge(Bt,Ve.b),nn=Ve.K,Ve=Ve.w+(ht>>Ve.b)*Gt;ht<Ot;){for(kn=nn,Pn=Ve,tr=new et,l=dt+en,h=dt+Bt;dt<l;)un(kn[Pn++],tr),xa(tr,Kt,dt,xt,Ie,Ne),dt+=xt,Ne+=xt;dt<h&&(un(kn[Pn++],tr),xa(tr,Kt,dt,dn,Ie,Ne),dt+=dn,Ne+=dn),++ht&yt||(Ve+=Gt)}break;case 3:if(Bt==Ie&&xt==Ne&&0<Ve.b){for(dt=Ie,Bt=Kt=Ne+(Ot-ht)*Kt-(en=(Ot-ht)*Ge(Ve.Ea,Ve.b)),xt=Ie,yt=Ne,Gt=[],en=(dn=en)-1;0<=en;--en)Gt[en]=xt[yt+en];for(en=dn-1;0<=en;--en)dt[Bt+en]=Gt[en];Po(Ve,ht,Ot,Ie,Kt,Ie,Ne)}else Po(Ve,ht,Ot,Bt,xt,Ie,Ne)}Ne=ae,Ie=q}Ie!=q&&r(ae,q,Ne,Ie,Ee)}function Qr(b,P){var q=b.V,ae=b.Ba+b.c*b.C,be=P-b.C;if(n(P<=b.l.o),n(16>=be),0<be){var Ee=b.l,Ae=b.Ta,Ne=b.Ua,Ie=Ee.width;if(wn(b,be,q,ae),be=Ne=[Ne],n((q=b.C)<(ae=P)),n(Ee.v<Ee.va),ae>Ee.o&&(ae=Ee.o),q<Ee.j){var Ve=Ee.j-q;q=Ee.j,be[0]+=Ve*Ie}if(q>=ae?q=0:(be[0]+=4*Ee.v,Ee.ka=q-Ee.j,Ee.U=Ee.va-Ee.v,Ee.T=ae-q,q=1),q){if(Ne=Ne[0],11>(q=b.ca).S){var ht=q.f.RGBA,Ot=(ae=q.S,be=Ee.U,Ee=Ee.T,Ve=ht.eb,ht.A),Bt=Ee;for(ht=ht.fb+b.Ma*ht.A;0<Bt--;){var xt=Ae,Kt=Ne,Gt=be,dt=Ve,yt=ht;switch(ae){case vs:Go(xt,Kt,Gt,dt,yt);break;case pr:To(xt,Kt,Gt,dt,yt);break;case Do:To(xt,Kt,Gt,dt,yt),No(dt,yt,0,Gt,1,0);break;case Sa:Ho(xt,Kt,Gt,dt,yt);break;case Ea:Nn(xt,Kt,Gt,dt,yt,1);break;case Io:Nn(xt,Kt,Gt,dt,yt,1),No(dt,yt,0,Gt,1,0);break;case Zs:Nn(xt,Kt,Gt,dt,yt,0);break;case Ks:Nn(xt,Kt,Gt,dt,yt,0),No(dt,yt,1,Gt,1,0);break;case as:ia(xt,Kt,Gt,dt,yt);break;case a:ia(xt,Kt,Gt,dt,yt),wi(dt,yt,Gt,1,0);break;case bc:Ds(xt,Kt,Gt,dt,yt);break;default:n(0)}Ne+=Ie,ht+=Ot}b.Ma+=Ee}else alert("todo:EmitRescaledRowsYUVA");n(b.Ma<=q.height)}}b.C=P,n(b.C<=b.i)}function Tt(b){var P;if(0<b.ua)return 0;for(P=0;P<b.Wb;++P){var q=b.Ya[P].G,ae=b.Ya[P].H;if(0<q[1][ae[1]+0].g||0<q[2][ae[2]+0].g||0<q[3][ae[3]+0].g)return 0}return 1}function Rn(b,P,q,ae,be,Ee){if(b.Z!=0){var Ae=b.qd,Ne=b.rd;for(n(pi[b.Z]!=null);P<q;++P)pi[b.Z](Ae,Ne,ae,be,ae,be,Ee),Ae=ae,Ne=be,be+=Ee;b.qd=Ae,b.rd=Ne}}function Qn(b,P){var q=b.l.ma,ae=q.Z==0||q.Z==1?b.l.j:b.C;if(ae=b.C<ae?ae:b.C,n(P<=b.l.o),P>ae){var be=b.l.width,Ee=q.ca,Ae=q.tb+be*ae,Ne=b.V,Ie=b.Ba+b.c*ae,Ve=b.gc;n(b.ab==1),n(Ve[0].hc==3),Uo(Ve[0],ae,P,Ne,Ie,Ee,Ae),Rn(q,ae,P,Ee,Ae,be)}b.C=b.Ma=P}function Pi(b,P,q,ae,be,Ee,Ae){var Ne=b.$/ae,Ie=b.$%ae,Ve=b.m,ht=b.s,Ot=q+b.$,Bt=Ot;be=q+ae*be;var xt=q+ae*Ee,Kt=280+ht.ua,Gt=b.Pb?Ne:16777216,dt=0<ht.ua?ht.Wa:null,yt=ht.wc,en=Ot<xt?mt(ht,Ie,Ne):null;n(b.C<Ee),n(xt<=be);var dn=!1;e:for(;;){for(;dn||Ot<xt;){var nn=0;if(Ne>=Gt){var kn=Ot-q;n((Gt=b).Pb),Gt.wd=Gt.m,Gt.xd=kn,0<Gt.s.ua&&ye(Gt.s.Wa,Gt.s.vb),Gt=Ne+Vt}if(Ie&yt||(en=mt(ht,Ie,Ne)),n(en!=null),en.Qb&&(P[Ot]=en.qb,dn=!0),!dn)if(le(Ve),en.jc){nn=Ve,kn=P;var Pn=Ot,tr=en.pd[H(nn)&wo-1];n(en.jc),256>tr.g?(ue(nn,nn.u+tr.g),kn[Pn]=tr.value,nn=0):(ue(nn,nn.u+tr.g-256),n(256<=tr.value),nn=tr.value),nn==0&&(dn=!0)}else nn=Hn(en.G[0],en.H[0],Ve);if(Ve.h)break;if(dn||256>nn){if(!dn)if(en.nd)P[Ot]=(en.qb|nn<<8)>>>0;else{if(le(Ve),dn=Hn(en.G[1],en.H[1],Ve),le(Ve),kn=Hn(en.G[2],en.H[2],Ve),Pn=Hn(en.G[3],en.H[3],Ve),Ve.h)break;P[Ot]=(Pn<<24|dn<<16|nn<<8|kn)>>>0}if(dn=!1,++Ot,++Ie>=ae&&(Ie=0,++Ne,Ae!=null&&Ne<=Ee&&!(Ne%16)&&Ae(b,Ne),dt!=null))for(;Bt<Ot;)nn=P[Bt++],dt.X[(506832829*nn&4294967295)>>>dt.Mb]=nn}else if(280>nn){if(nn=bn(nn-256,Ve),kn=Hn(en.G[4],en.H[4],Ve),le(Ve),kn=Ht(ae,kn=bn(kn,Ve)),Ve.h)break;if(Ot-q<kn||be-Ot<nn)break e;for(Pn=0;Pn<nn;++Pn)P[Ot+Pn]=P[Ot+Pn-kn];for(Ot+=nn,Ie+=nn;Ie>=ae;)Ie-=ae,++Ne,Ae!=null&&Ne<=Ee&&!(Ne%16)&&Ae(b,Ne);if(n(Ot<=be),Ie&yt&&(en=mt(ht,Ie,Ne)),dt!=null)for(;Bt<Ot;)nn=P[Bt++],dt.X[(506832829*nn&4294967295)>>>dt.Mb]=nn}else{if(!(nn<Kt))break e;for(dn=nn-280,n(dt!=null);Bt<Ot;)nn=P[Bt++],dt.X[(506832829*nn&4294967295)>>>dt.Mb]=nn;nn=Ot,n(!(dn>>>(kn=dt).Xa)),P[nn]=kn.X[dn],dn=!0}dn||n(Ve.h==Q(Ve))}if(b.Pb&&Ve.h&&Ot<be)n(b.m.h),b.a=5,b.m=b.wd,b.$=b.xd,0<b.s.ua&&ye(b.s.vb,b.s.Wa);else{if(Ve.h)break e;Ae!=null&&Ae(b,Ne>Ee?Ee:Ne),b.a=0,b.$=Ot-q}return 1}return b.a=3,0}function Sr(b){n(b!=null),b.vc=null,b.yc=null,b.Ya=null;var P=b.Wa;P!=null&&(P.X=null),b.vb=null,n(b!=null)}function Pr(){var b=new al;return b==null?null:(b.a=0,b.xb=tu,ar("Predictor","VP8LPredictors"),ar("Predictor","VP8LPredictors_C"),ar("PredictorAdd","VP8LPredictorsAdd"),ar("PredictorAdd","VP8LPredictorsAdd_C"),Xu=rn,xa=Ke,Go=rt,To=Ft,ia=Qt,Ds=Bn,Ho=Ln,z.VP8LMapColor32b=ba,z.VP8LMapColor8b=Vo,b)}function dr(b,P,q,ae,be){var Ee=1,Ae=[b],Ne=[P],Ie=ae.m,Ve=ae.s,ht=null,Ot=0;e:for(;;){if(q)for(;Ee&&Ce(Ie,1);){var Bt=Ae,xt=Ne,Kt=ae,Gt=1,dt=Kt.m,yt=Kt.gc[Kt.ab],en=Ce(dt,2);if(Kt.Oc&1<<en)Ee=0;else{switch(Kt.Oc|=1<<en,yt.hc=en,yt.Ea=Bt[0],yt.nc=xt[0],yt.K=[null],++Kt.ab,n(4>=Kt.ab),en){case 0:case 1:yt.b=Ce(dt,3)+2,Gt=dr(Ge(yt.Ea,yt.b),Ge(yt.nc,yt.b),0,Kt,yt.K),yt.K=yt.K[0];break;case 3:var dn,nn=Ce(dt,8)+1,kn=16<nn?0:4<nn?1:2<nn?2:3;if(Bt[0]=Ge(yt.Ea,kn),yt.b=kn,dn=Gt=dr(nn,1,0,Kt,yt.K)){var Pn,tr=nn,l=yt,h=1<<(8>>l.b),v=s(h);if(v==null)dn=0;else{var x=l.K[0],E=l.w;for(v[0]=l.K[0][0],Pn=1;Pn<1*tr;++Pn)v[Pn]=tt(x[E+Pn],v[Pn-1]);for(;Pn<4*h;++Pn)v[Pn]=0;l.K[0]=null,l.K[0]=v,dn=1}}Gt=dn;break;case 2:break;default:n(0)}Ee=Gt}}if(Ae=Ae[0],Ne=Ne[0],Ee&&Ce(Ie,1)&&!(Ee=1<=(Ot=Ce(Ie,4))&&11>=Ot)){ae.a=3;break e}var j;if(j=Ee)t:{var X,re,ge,Le=ae,Xe=Ae,ze=Ne,vt=Ot,Dt=q,Xt=Le.m,_n=Le.s,Sn=[null],hr=1,Je=0,nt=At[vt];n:for(;;){if(Dt&&Ce(Xt,1)){var ct=Ce(Xt,3)+2,Rt=Ge(Xe,ct),bt=Ge(ze,ct),It=Rt*bt;if(!dr(Rt,bt,0,Le,Sn))break n;for(Sn=Sn[0],_n.xc=ct,X=0;X<It;++X){var me=Sn[X]>>8&65535;Sn[X]=me,me>=hr&&(hr=me+1)}}if(Xt.h)break n;for(re=0;5>re;++re){var Pe=V[re];!re&&0<vt&&(Pe+=1<<vt),Je<Pe&&(Je=Pe)}var Be=o(hr*nt,D),Oe=hr,Fe=o(Oe,$);if(Fe==null)var je=null;else n(65536>=Oe),je=Fe;var at=s(Je);if(je==null||at==null||Be==null){Le.a=1;break n}var lt=Be;for(X=ge=0;X<hr;++X){var pt=je[X],Et=pt.G,Ct=pt.H,on=0,$n=1,Wn=0;for(re=0;5>re;++re){Pe=V[re],Et[re]=lt,Ct[re]=ge,!re&&0<vt&&(Pe+=1<<vt);i:{var nr,gi=Pe,Ti=Le,Yr=at,Ui=lt,bs=ge,Eu=0,fa=Ti.m,Df=Ce(fa,1);if(i(Yr,0,0,gi),Df){var Wa=Ce(fa,1)+1,ec=Ce(fa,1),ha=Ce(fa,ec==0?1:8);Yr[ha]=1,Wa==2&&(Yr[ha=Ce(fa,8)]=1);var Zo=1}else{var go=s(19),_h=Ce(fa,4)+4;if(19<_h){Ti.a=3;var If=0;break i}for(nr=0;nr<_h;++nr)go[Se[nr]]=Ce(fa,3);var Of=void 0,Bf=void 0,bh=Ti,si=go,wh=gi,jp=Yr,Lc=0,Cu=bh.m,zp=8,$p=o(128,D);r:for(;T($p,0,7,si,19);){if(Ce(Cu,1)){var fl=2+2*Ce(Cu,3);if((Of=2+Ce(Cu,fl))>wh)break r}else Of=wh;for(Bf=0;Bf<wh&&Of--;){le(Cu);var Up=$p[0+(127&H(Cu))];ue(Cu,Cu.u+Up.g);var Pu=Up.value;if(16>Pu)jp[Bf++]=Pu,Pu!=0&&(zp=Pu);else{var bd=Pu==16,wd=Pu-16,Vp=S[wd],Pa=Ce(Cu,p[wd])+Vp;if(Bf+Pa>wh)break r;for(var tc=bd?zp:0;0<Pa--;)jp[Bf++]=tc}}Lc=1;break r}Lc||(bh.a=3),Zo=Lc}(Zo=Zo&&!fa.h)&&(Eu=T(Ui,bs,8,Yr,gi)),Zo&&Eu!=0?If=Eu:(Ti.a=3,If=0)}if(If==0)break n;if($n&&se[re]==1&&($n=lt[ge].g==0),on+=lt[ge].g,ge+=If,3>=re){var Sc,xh=at[0];for(Sc=1;Sc<Pe;++Sc)at[Sc]>xh&&(xh=at[Sc]);Wn+=xh}}if(pt.nd=$n,pt.Qb=0,$n&&(pt.qb=(Et[3][Ct[3]+0].value<<24|Et[1][Ct[1]+0].value<<16|Et[2][Ct[2]+0].value)>>>0,on==0&&256>Et[0][Ct[0]+0].value&&(pt.Qb=1,pt.qb+=Et[0][Ct[0]+0].value<<8)),pt.jc=!pt.Qb&&6>Wn,pt.jc){var Ec,nu=pt;for(Ec=0;Ec<wo;++Ec){var ru=Ec,Mu=nu.pd[ru],Qc=nu.G[0][nu.H[0]+ru];256<=Qc.value?(Mu.g=Qc.g+256,Mu.value=Qc.value):(Mu.g=0,Mu.value=0,ru>>=St(Qc,8,Mu),ru>>=St(nu.G[1][nu.H[1]+ru],16,Mu),ru>>=St(nu.G[2][nu.H[2]+ru],0,Mu),St(nu.G[3][nu.H[3]+ru],24,Mu))}}}_n.vc=Sn,_n.Wb=hr,_n.Ya=je,_n.yc=Be,j=1;break t}j=0}if(!(Ee=j)){ae.a=3;break e}if(0<Ot){if(Ve.ua=1<<Ot,!ne(Ve.Wa,Ot)){ae.a=1,Ee=0;break e}}else Ve.ua=0;var Rf=ae,Au=Ae,a0=Ne,iu=Rf.s,Lh=iu.xc;if(Rf.c=Au,Rf.i=a0,iu.md=Ge(Au,Lh),iu.wc=Lh==0?-1:(1<<Lh)-1,q){ae.xb=Tf;break e}if((ht=s(Ae*Ne))==null){ae.a=1,Ee=0;break e}Ee=(Ee=Pi(ae,ht,0,Ae,Ne,Ne,null))&&!Ie.h;break e}return Ee?(be!=null?be[0]=ht:(n(ht==null),n(q)),ae.$=0,q||Sr(Ve)):Sr(Ve),Ee}function Mi(b,P){var q=b.c*b.i,ae=q+P+16*P;return n(b.c<=P),b.V=s(ae),b.V==null?(b.Ta=null,b.Ua=0,b.a=1,0):(b.Ta=b.V,b.Ua=b.Ba+q+P,1)}function wr(b,P){var q=b.C,ae=P-q,be=b.V,Ee=b.Ba+b.c*q;for(n(P<=b.l.o);0<ae;){var Ae=16<ae?16:ae,Ne=b.l.ma,Ie=b.l.width,Ve=Ie*Ae,ht=Ne.ca,Ot=Ne.tb+Ie*q,Bt=b.Ta,xt=b.Ua;wn(b,Ae,be,Ee),po(Bt,xt,ht,Ot,Ve),Rn(Ne,q,q+Ae,ht,Ot,Ie),ae-=Ae,be+=Ae*b.c,q+=Ae}n(q==P),b.C=b.Ma=P}function Gr(){this.ub=this.yd=this.td=this.Rb=0}function Ir(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function tn(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function zi(){this.Yb=function(){var b=[];return function P(q,ae,be){for(var Ee=be[ae],Ae=0;Ae<Ee&&(q.push(be.length>ae+1?[]:0),!(be.length<ae+1));Ae++)P(q[Ae],ae+1,be)}(b,0,[3,11]),b}()}function Oi(){this.jb=s(3),this.Wc=u([4,8],zi),this.Xc=u([4,17],zi)}function Qi(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function ei(){this.ld=this.La=this.dd=this.tc=0}function Br(){this.Na=this.la=0}function ui(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function mr(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Si(){this.uc=this.M=this.Nb=0,this.wa=Array(new ei),this.Y=0,this.ya=Array(new mr),this.aa=0,this.l=new Rr}function ps(){this.y=s(16),this.f=s(8),this.ea=s(8)}function va(){this.cb=this.a=0,this.sc="",this.m=new Te,this.Od=new Gr,this.Kc=new Ir,this.ed=new Qi,this.Qa=new tn,this.Ic=this.$c=this.Aa=0,this.D=new Si,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,Te),this.ia=0,this.pb=o(4,ui),this.Pa=new Oi,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new ps),this.Hd=0,this.rb=Array(new Br),this.sb=0,this.wa=Array(new ei),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new mr),this.L=this.aa=0,this.gd=u([4,2],ei),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Rr(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function mn(){var b=new va;return b!=null&&(b.a=0,b.sc="OK",b.cb=0,b.Xb=0,er||(er=Ri)),b}function Zn(b,P,q){return b.a==0&&(b.a=P,b.sc=q,b.cb=0),0}function Ei(b,P,q){return 3<=q&&b[P+0]==157&&b[P+1]==1&&b[P+2]==42}function Bi(b,P){if(b==null)return 0;if(b.a=0,b.sc="OK",P==null)return Zn(b,2,"null VP8Io passed to VP8GetHeaders()");var q=P.data,ae=P.w,be=P.ha;if(4>be)return Zn(b,7,"Truncated header.");var Ee=q[ae+0]|q[ae+1]<<8|q[ae+2]<<16,Ae=b.Od;if(Ae.Rb=!(1&Ee),Ae.td=Ee>>1&7,Ae.yd=Ee>>4&1,Ae.ub=Ee>>5,3<Ae.td)return Zn(b,3,"Incorrect keyframe parameters.");if(!Ae.yd)return Zn(b,4,"Frame not displayable.");ae+=3,be-=3;var Ne=b.Kc;if(Ae.Rb){if(7>be)return Zn(b,7,"cannot parse picture header");if(!Ei(q,ae,be))return Zn(b,3,"Bad code word");Ne.c=16383&(q[ae+4]<<8|q[ae+3]),Ne.Td=q[ae+4]>>6,Ne.i=16383&(q[ae+6]<<8|q[ae+5]),Ne.Ud=q[ae+6]>>6,ae+=7,be-=7,b.za=Ne.c+15>>4,b.Ub=Ne.i+15>>4,P.width=Ne.c,P.height=Ne.i,P.Da=0,P.j=0,P.v=0,P.va=P.width,P.o=P.height,P.da=0,P.ib=P.width,P.hb=P.height,P.U=P.width,P.T=P.height,i((Ee=b.Pa).jb,0,255,Ee.jb.length),n((Ee=b.Qa)!=null),Ee.Cb=0,Ee.Bb=0,Ee.Fb=1,i(Ee.Zb,0,0,Ee.Zb.length),i(Ee.Lb,0,0,Ee.Lb)}if(Ae.ub>be)return Zn(b,7,"bad partition length");W(Ee=b.m,q,ae,Ae.ub),ae+=Ae.ub,be-=Ae.ub,Ae.Rb&&(Ne.Ld=Z(Ee),Ne.Kd=Z(Ee)),Ne=b.Qa;var Ie,Ve=b.Pa;if(n(Ee!=null),n(Ne!=null),Ne.Cb=Z(Ee),Ne.Cb){if(Ne.Bb=Z(Ee),Z(Ee)){for(Ne.Fb=Z(Ee),Ie=0;4>Ie;++Ie)Ne.Zb[Ie]=Z(Ee)?oe(Ee,7):0;for(Ie=0;4>Ie;++Ie)Ne.Lb[Ie]=Z(Ee)?oe(Ee,6):0}if(Ne.Bb)for(Ie=0;3>Ie;++Ie)Ve.jb[Ie]=Z(Ee)?G(Ee,8):255}else Ne.Bb=0;if(Ee.Ka)return Zn(b,3,"cannot parse segment header");if((Ne=b.ed).zd=Z(Ee),Ne.Tb=G(Ee,6),Ne.wb=G(Ee,3),Ne.Pc=Z(Ee),Ne.Pc&&Z(Ee)){for(Ve=0;4>Ve;++Ve)Z(Ee)&&(Ne.vd[Ve]=oe(Ee,6));for(Ve=0;4>Ve;++Ve)Z(Ee)&&(Ne.od[Ve]=oe(Ee,6))}if(b.L=Ne.Tb==0?0:Ne.zd?1:2,Ee.Ka)return Zn(b,3,"cannot parse filter header");var ht=be;if(be=Ie=ae,ae=Ie+ht,Ne=ht,b.Xb=(1<<G(b.m,2))-1,ht<3*(Ve=b.Xb))q=7;else{for(Ie+=3*Ve,Ne-=3*Ve,ht=0;ht<Ve;++ht){var Ot=q[be+0]|q[be+1]<<8|q[be+2]<<16;Ot>Ne&&(Ot=Ne),W(b.Jc[+ht],q,Ie,Ot),Ie+=Ot,Ne-=Ot,be+=3}W(b.Jc[+Ve],q,Ie,Ne),q=Ie<ae?0:5}if(q!=0)return Zn(b,q,"cannot parse partitions");for(q=G(Ie=b.m,7),be=Z(Ie)?oe(Ie,4):0,ae=Z(Ie)?oe(Ie,4):0,Ne=Z(Ie)?oe(Ie,4):0,Ve=Z(Ie)?oe(Ie,4):0,Ie=Z(Ie)?oe(Ie,4):0,ht=b.Qa,Ot=0;4>Ot;++Ot){if(ht.Cb){var Bt=ht.Zb[Ot];ht.Fb||(Bt+=q)}else{if(0<Ot){b.pb[Ot]=b.pb[0];continue}Bt=q}var xt=b.pb[Ot];xt.Sc[0]=sn[Ur(Bt+be,127)],xt.Sc[1]=In[Ur(Bt+0,127)],xt.Eb[0]=2*sn[Ur(Bt+ae,127)],xt.Eb[1]=101581*In[Ur(Bt+Ne,127)]>>16,8>xt.Eb[1]&&(xt.Eb[1]=8),xt.Qc[0]=sn[Ur(Bt+Ve,117)],xt.Qc[1]=In[Ur(Bt+Ie,127)],xt.lc=Bt+Ie}if(!Ae.Rb)return Zn(b,4,"Not a key frame.");for(Z(Ee),Ae=b.Pa,q=0;4>q;++q){for(be=0;8>be;++be)for(ae=0;3>ae;++ae)for(Ne=0;11>Ne;++Ne)Ve=N(Ee,ys[q][be][ae][Ne])?G(Ee,8):Oo[q][be][ae][Ne],Ae.Wc[q][be].Yb[ae][Ne]=Ve;for(be=0;17>be;++be)Ae.Xc[q][be]=Ae.Wc[q][wc[be]]}return b.kc=Z(Ee),b.kc&&(b.Bd=G(Ee,8)),b.cb=1}function Ri(b,P,q,ae,be,Ee,Ae){var Ne=P[be].Yb[q];for(q=0;16>be;++be){if(!N(b,Ne[q+0]))return be;for(;!N(b,Ne[q+1]);)if(Ne=P[++be].Yb[0],q=0,be==16)return 16;var Ie=P[be+1].Yb;if(N(b,Ne[q+2])){var Ve=b,ht=0;if(N(Ve,(Bt=Ne)[(Ot=q)+3]))if(N(Ve,Bt[Ot+6])){for(Ne=0,Ot=2*(ht=N(Ve,Bt[Ot+8]))+(Bt=N(Ve,Bt[Ot+9+ht])),ht=0,Bt=Fr[Ot];Bt[Ne];++Ne)ht+=ht+N(Ve,Bt[Ne]);ht+=3+(8<<Ot)}else N(Ve,Bt[Ot+7])?(ht=7+2*N(Ve,165),ht+=N(Ve,145)):ht=5+N(Ve,159);else ht=N(Ve,Bt[Ot+4])?3+N(Ve,Bt[Ot+5]):2;Ne=Ie[2]}else ht=1,Ne=Ie[1];Ie=Ae+Lo[be],0>(Ve=b).b&&pe(Ve);var Ot,Bt=Ve.b,xt=(Ot=Ve.Ca>>1)-(Ve.I>>Bt)>>31;--Ve.b,Ve.Ca+=xt,Ve.Ca|=1,Ve.I-=(Ot+1&xt)<<Bt,Ee[Ie]=((ht^xt)-xt)*ae[(0<be)+0]}return 16}function jo(b){var P=b.rb[b.sb-1];P.la=0,P.Na=0,i(b.zc,0,0,b.zc.length),b.ja=0}function cr(b,P){if(b==null)return 0;if(P==null)return Zn(b,2,"NULL VP8Io parameter in VP8Decode().");if(!b.cb&&!Bi(b,P))return 0;if(n(b.cb),P.ac==null||P.ac(P)){P.ob&&(b.L=0);var q=Ca[b.L];if(b.L==2?(b.yb=0,b.zb=0):(b.yb=P.v-q>>4,b.zb=P.j-q>>4,0>b.yb&&(b.yb=0),0>b.zb&&(b.zb=0)),b.Va=P.o+15+q>>4,b.Hb=P.va+15+q>>4,b.Hb>b.za&&(b.Hb=b.za),b.Va>b.Ub&&(b.Va=b.Ub),0<b.L){var ae=b.ed;for(q=0;4>q;++q){var be;if(b.Qa.Cb){var Ee=b.Qa.Lb[q];b.Qa.Fb||(Ee+=ae.Tb)}else Ee=ae.Tb;for(be=0;1>=be;++be){var Ae=b.gd[q][be],Ne=Ee;if(ae.Pc&&(Ne+=ae.vd[0],be&&(Ne+=ae.od[0])),0<(Ne=0>Ne?0:63<Ne?63:Ne)){var Ie=Ne;0<ae.wb&&(Ie=4<ae.wb?Ie>>2:Ie>>1)>9-ae.wb&&(Ie=9-ae.wb),1>Ie&&(Ie=1),Ae.dd=Ie,Ae.tc=2*Ne+Ie,Ae.ld=40<=Ne?2:15<=Ne?1:0}else Ae.tc=0;Ae.La=be}}}q=0}else Zn(b,6,"Frame setup failed"),q=b.a;if(q=q==0){if(q){b.$c=0,0<b.Aa||(b.Ic=vh);e:{q=b.Ic,ae=4*(Ie=b.za);var Ve=32*Ie,ht=Ie+1,Ot=0<b.L?Ie*(0<b.Aa?2:1):0,Bt=(b.Aa==2?2:1)*Ie;if((Ae=ae+832+(be=3*(16*q+Ca[b.L])/2*Ve)+(Ee=b.Fa!=null&&0<b.Fa.length?b.Kc.c*b.Kc.i:0))!=Ae)q=0;else{if(Ae>b.Vb){if(b.Vb=0,b.Ec=s(Ae),b.Fc=0,b.Ec==null){q=Zn(b,1,"no memory during frame initialization.");break e}b.Vb=Ae}Ae=b.Ec,Ne=b.Fc,b.Ac=Ae,b.Bc=Ne,Ne+=ae,b.Gd=o(Ve,ps),b.Hd=0,b.rb=o(ht+1,Br),b.sb=1,b.wa=Ot?o(Ot,ei):null,b.Y=0,b.D.Nb=0,b.D.wa=b.wa,b.D.Y=b.Y,0<b.Aa&&(b.D.Y+=Ie),n(!0),b.oc=Ae,b.pc=Ne,Ne+=832,b.ya=o(Bt,mr),b.aa=0,b.D.ya=b.ya,b.D.aa=b.aa,b.Aa==2&&(b.D.aa+=Ie),b.R=16*Ie,b.B=8*Ie,Ie=(Ve=Ca[b.L])*b.R,Ve=Ve/2*b.B,b.sa=Ae,b.ta=Ne+Ie,b.qa=b.sa,b.ra=b.ta+16*q*b.R+Ve,b.Ha=b.qa,b.Ia=b.ra+8*q*b.B+Ve,b.$c=0,Ne+=be,b.mb=Ee?Ae:null,b.nb=Ee?Ne:null,n(Ne+Ee<=b.Fc+b.Vb),jo(b),i(b.Ac,b.Bc,0,ae),q=1}}if(q){if(P.ka=0,P.y=b.sa,P.O=b.ta,P.f=b.qa,P.N=b.ra,P.ea=b.Ha,P.Vd=b.Ia,P.fa=b.R,P.Rc=b.B,P.F=null,P.J=0,!Lu){for(q=-255;255>=q;++q)$i[255+q]=0>q?-q:q;for(q=-1020;1020>=q;++q)Is[1020+q]=-128>q?-128:127<q?127:q;for(q=-112;112>=q;++q)ms[112+q]=-16>q?-16:15<q?15:q;for(q=-255;510>=q;++q)js[255+q]=0>q?0:255<q?255:q;Lu=1}_t=Ao,Wt=Cn,An=cn,Jn=fr,xr=eo,Nt=ci,Wi=Ql,bi=ta,Bl=Fs,ss=Il,Zi=Nl,oa=Dl,La=vi,sa=Ju,aa=uo,la=lr,Kr=co,Ws=sl,Ys[0]=zr,Ys[1]=za,Ys[2]=yr,Ys[3]=ts,Ys[4]=Ml,Ys[5]=ns,Ys[6]=fi,Ys[7]=to,Ys[8]=wu,Ys[9]=Ua,ca[0]=es,ca[1]=il,ca[2]=jr,ca[3]=As,ca[4]=Fi,ca[5]=Pl,ca[6]=$a,zs[0]=Va,zs[1]=Qo,zs[2]=Al,zs[3]=Er,zs[4]=kl,zs[5]=Yu,zs[6]=Jl,q=1}else q=0}q&&(q=function(xt,Kt){for(xt.M=0;xt.M<xt.Va;++xt.M){var Gt,dt=xt.Jc[xt.M&xt.Xb],yt=xt.m,en=xt;for(Gt=0;Gt<en.za;++Gt){var dn=yt,nn=en,kn=nn.Ac,Pn=nn.Bc+4*Gt,tr=nn.zc,l=nn.ya[nn.aa+Gt];if(nn.Qa.Bb?l.$b=N(dn,nn.Pa.jb[0])?2+N(dn,nn.Pa.jb[2]):N(dn,nn.Pa.jb[1]):l.$b=0,nn.kc&&(l.Ad=N(dn,nn.Bd)),l.Za=!N(dn,145)+0,l.Za){var h=l.Ob,v=0;for(nn=0;4>nn;++nn){var x,E=tr[0+nn];for(x=0;4>x;++x){E=Ki[kn[Pn+x]][E];for(var j=io[N(dn,E[0])];0<j;)j=io[2*j+N(dn,E[j])];E=-j,kn[Pn+x]=E}r(h,v,kn,Pn,4),v+=4,tr[0+nn]=E}}else E=N(dn,156)?N(dn,128)?1:3:N(dn,163)?2:0,l.Ob[0]=E,i(kn,Pn,E,4),i(tr,0,E,4);l.Dd=N(dn,142)?N(dn,114)?N(dn,183)?1:3:2:0}if(en.m.Ka)return Zn(xt,7,"Premature end-of-partition0 encountered.");for(;xt.ja<xt.za;++xt.ja){if(en=dt,dn=(yt=xt).rb[yt.sb-1],kn=yt.rb[yt.sb+yt.ja],Gt=yt.ya[yt.aa+yt.ja],Pn=yt.kc?Gt.Ad:0)dn.la=kn.la=0,Gt.Za||(dn.Na=kn.Na=0),Gt.Hc=0,Gt.Gc=0,Gt.ia=0;else{var X,re;if(dn=kn,kn=en,Pn=yt.Pa.Xc,tr=yt.ya[yt.aa+yt.ja],l=yt.pb[tr.$b],nn=tr.ad,h=0,v=yt.rb[yt.sb-1],E=x=0,i(nn,h,0,384),tr.Za)var ge=0,Le=Pn[3];else{j=s(16);var Xe=dn.Na+v.Na;if(Xe=er(kn,Pn[1],Xe,l.Eb,0,j,0),dn.Na=v.Na=(0<Xe)+0,1<Xe)_t(j,0,nn,h);else{var ze=j[0]+3>>3;for(j=0;256>j;j+=16)nn[h+j]=ze}ge=1,Le=Pn[0]}var vt=15&dn.la,Dt=15&v.la;for(j=0;4>j;++j){var Xt=1&Dt;for(ze=re=0;4>ze;++ze)vt=vt>>1|(Xt=(Xe=er(kn,Le,Xe=Xt+(1&vt),l.Sc,ge,nn,h))>ge)<<7,re=re<<2|(3<Xe?3:1<Xe?2:nn[h+0]!=0),h+=16;vt>>=4,Dt=Dt>>1|Xt<<7,x=(x<<8|re)>>>0}for(Le=vt,ge=Dt>>4,X=0;4>X;X+=2){for(re=0,vt=dn.la>>4+X,Dt=v.la>>4+X,j=0;2>j;++j){for(Xt=1&Dt,ze=0;2>ze;++ze)Xe=Xt+(1&vt),vt=vt>>1|(Xt=0<(Xe=er(kn,Pn[2],Xe,l.Qc,0,nn,h)))<<3,re=re<<2|(3<Xe?3:1<Xe?2:nn[h+0]!=0),h+=16;vt>>=2,Dt=Dt>>1|Xt<<5}E|=re<<4*X,Le|=vt<<4<<X,ge|=(240&Dt)<<X}dn.la=Le,v.la=ge,tr.Hc=x,tr.Gc=E,tr.ia=43690&E?0:l.ia,Pn=!(x|E)}if(0<yt.L&&(yt.wa[yt.Y+yt.ja]=yt.gd[Gt.$b][Gt.Za],yt.wa[yt.Y+yt.ja].La|=!Pn),en.Ka)return Zn(xt,7,"Premature end-of-file encountered.")}if(jo(xt),yt=Kt,en=1,Gt=(dt=xt).D,dn=0<dt.L&&dt.M>=dt.zb&&dt.M<=dt.Va,dt.Aa==0)e:{if(Gt.M=dt.M,Gt.uc=dn,eu(dt,Gt),en=1,Gt=(re=dt.D).Nb,dn=(E=Ca[dt.L])*dt.R,kn=E/2*dt.B,j=16*Gt*dt.R,ze=8*Gt*dt.B,Pn=dt.sa,tr=dt.ta-dn+j,l=dt.qa,nn=dt.ra-kn+ze,h=dt.Ha,v=dt.Ia-kn+ze,Dt=(vt=re.M)==0,x=vt>=dt.Va-1,dt.Aa==2&&eu(dt,re),re.uc)for(Xt=(Xe=dt).D.M,n(Xe.D.uc),re=Xe.yb;re<Xe.Hb;++re){ge=re,Le=Xt;var _n=(Sn=(Pe=Xe).D).Nb;X=Pe.R;var Sn=Sn.wa[Sn.Y+ge],hr=Pe.sa,Je=Pe.ta+16*_n*X+16*ge,nt=Sn.dd,ct=Sn.tc;if(ct!=0)if(n(3<=ct),Pe.L==1)0<ge&&la(hr,Je,X,ct+4),Sn.La&&Ws(hr,Je,X,ct),0<Le&&aa(hr,Je,X,ct+4),Sn.La&&Kr(hr,Je,X,ct);else{var Rt=Pe.B,bt=Pe.qa,It=Pe.ra+8*_n*Rt+8*ge,me=Pe.Ha,Pe=Pe.Ia+8*_n*Rt+8*ge;_n=Sn.ld,0<ge&&(bi(hr,Je,X,ct+4,nt,_n),ss(bt,It,me,Pe,Rt,ct+4,nt,_n)),Sn.La&&(oa(hr,Je,X,ct,nt,_n),sa(bt,It,me,Pe,Rt,ct,nt,_n)),0<Le&&(Wi(hr,Je,X,ct+4,nt,_n),Bl(bt,It,me,Pe,Rt,ct+4,nt,_n)),Sn.La&&(Zi(hr,Je,X,ct,nt,_n),La(bt,It,me,Pe,Rt,ct,nt,_n))}}if(dt.ia&&alert("todo:DitherRow"),yt.put!=null){if(re=16*vt,vt=16*(vt+1),Dt?(yt.y=dt.sa,yt.O=dt.ta+j,yt.f=dt.qa,yt.N=dt.ra+ze,yt.ea=dt.Ha,yt.W=dt.Ia+ze):(re-=E,yt.y=Pn,yt.O=tr,yt.f=l,yt.N=nn,yt.ea=h,yt.W=v),x||(vt-=E),vt>yt.o&&(vt=yt.o),yt.F=null,yt.J=null,dt.Fa!=null&&0<dt.Fa.length&&re<vt&&(yt.J=fo(dt,yt,re,vt-re),yt.F=dt.mb,yt.F==null&&yt.F.length==0)){en=Zn(dt,3,"Could not decode alpha data.");break e}re<yt.j&&(E=yt.j-re,re=yt.j,n(!(1&E)),yt.O+=dt.R*E,yt.N+=dt.B*(E>>1),yt.W+=dt.B*(E>>1),yt.F!=null&&(yt.J+=yt.width*E)),re<vt&&(yt.O+=yt.v,yt.N+=yt.v>>1,yt.W+=yt.v>>1,yt.F!=null&&(yt.J+=yt.v),yt.ka=re-yt.j,yt.U=yt.va-yt.v,yt.T=vt-re,en=yt.put(yt))}Gt+1!=dt.Ic||x||(r(dt.sa,dt.ta-dn,Pn,tr+16*dt.R,dn),r(dt.qa,dt.ra-kn,l,nn+8*dt.B,kn),r(dt.Ha,dt.Ia-kn,h,v+8*dt.B,kn))}if(!en)return Zn(xt,6,"Output aborted.")}return 1}(b,P)),P.bc!=null&&P.bc(P),q&=1}return q?(b.cb=0,q):0}function Vn(b,P,q,ae,be){be=b[P+q+32*ae]+(be>>3),b[P+q+32*ae]=-256&be?0>be?0:255:be}function Ms(b,P,q,ae,be,Ee){Vn(b,P,0,q,ae+be),Vn(b,P,1,q,ae+Ee),Vn(b,P,2,q,ae-Ee),Vn(b,P,3,q,ae-be)}function oi(b){return(20091*b>>16)+b}function Ai(b,P,q,ae){var be,Ee=0,Ae=s(16);for(be=0;4>be;++be){var Ne=b[P+0]+b[P+8],Ie=b[P+0]-b[P+8],Ve=(35468*b[P+4]>>16)-oi(b[P+12]),ht=oi(b[P+4])+(35468*b[P+12]>>16);Ae[Ee+0]=Ne+ht,Ae[Ee+1]=Ie+Ve,Ae[Ee+2]=Ie-Ve,Ae[Ee+3]=Ne-ht,Ee+=4,P++}for(be=Ee=0;4>be;++be)Ne=(b=Ae[Ee+0]+4)+Ae[Ee+8],Ie=b-Ae[Ee+8],Ve=(35468*Ae[Ee+4]>>16)-oi(Ae[Ee+12]),Vn(q,ae,0,0,Ne+(ht=oi(Ae[Ee+4])+(35468*Ae[Ee+12]>>16))),Vn(q,ae,1,0,Ie+Ve),Vn(q,ae,2,0,Ie-Ve),Vn(q,ae,3,0,Ne-ht),Ee++,ae+=32}function ci(b,P,q,ae){var be=b[P+0]+4,Ee=35468*b[P+4]>>16,Ae=oi(b[P+4]),Ne=35468*b[P+1]>>16;Ms(q,ae,0,be+Ae,b=oi(b[P+1]),Ne),Ms(q,ae,1,be+Ee,b,Ne),Ms(q,ae,2,be-Ee,b,Ne),Ms(q,ae,3,be-Ae,b,Ne)}function Cn(b,P,q,ae,be){Ai(b,P,q,ae),be&&Ai(b,P+16,q,ae+4)}function cn(b,P,q,ae){Wt(b,P+0,q,ae,1),Wt(b,P+32,q,ae+128,1)}function fr(b,P,q,ae){var be;for(b=b[P+0]+4,be=0;4>be;++be)for(P=0;4>P;++P)Vn(q,ae,P,be,b)}function eo(b,P,q,ae){b[P+0]&&Jn(b,P+0,q,ae),b[P+16]&&Jn(b,P+16,q,ae+4),b[P+32]&&Jn(b,P+32,q,ae+128),b[P+48]&&Jn(b,P+48,q,ae+128+4)}function Ao(b,P,q,ae){var be,Ee=s(16);for(be=0;4>be;++be){var Ae=b[P+0+be]+b[P+12+be],Ne=b[P+4+be]+b[P+8+be],Ie=b[P+4+be]-b[P+8+be],Ve=b[P+0+be]-b[P+12+be];Ee[0+be]=Ae+Ne,Ee[8+be]=Ae-Ne,Ee[4+be]=Ve+Ie,Ee[12+be]=Ve-Ie}for(be=0;4>be;++be)Ae=(b=Ee[0+4*be]+3)+Ee[3+4*be],Ne=Ee[1+4*be]+Ee[2+4*be],Ie=Ee[1+4*be]-Ee[2+4*be],Ve=b-Ee[3+4*be],q[ae+0]=Ae+Ne>>3,q[ae+16]=Ve+Ie>>3,q[ae+32]=Ae-Ne>>3,q[ae+48]=Ve-Ie>>3,ae+=64}function _o(b,P,q){var ae,be=P-32,Ee=ji,Ae=255-b[be-1];for(ae=0;ae<q;++ae){var Ne,Ie=Ee,Ve=Ae+b[P-1];for(Ne=0;Ne<q;++Ne)b[P+Ne]=Ie[Ve+b[be+Ne]];P+=32}}function za(b,P){_o(b,P,4)}function Qo(b,P){_o(b,P,8)}function il(b,P){_o(b,P,16)}function jr(b,P){var q;for(q=0;16>q;++q)r(b,P+32*q,b,P-32,16)}function As(b,P){var q;for(q=16;0<q;--q)i(b,P,b[P-1],16),P+=32}function lo(b,P,q){var ae;for(ae=0;16>ae;++ae)i(P,q+32*ae,b,16)}function es(b,P){var q,ae=16;for(q=0;16>q;++q)ae+=b[P-1+32*q]+b[P+q-32];lo(ae>>5,b,P)}function Fi(b,P){var q,ae=8;for(q=0;16>q;++q)ae+=b[P-1+32*q];lo(ae>>4,b,P)}function Pl(b,P){var q,ae=8;for(q=0;16>q;++q)ae+=b[P+q-32];lo(ae>>4,b,P)}function $a(b,P){lo(128,b,P)}function vr(b,P,q){return b+2*P+q+2>>2}function yr(b,P){var q,ae=P-32;for(ae=new Uint8Array([vr(b[ae-1],b[ae+0],b[ae+1]),vr(b[ae+0],b[ae+1],b[ae+2]),vr(b[ae+1],b[ae+2],b[ae+3]),vr(b[ae+2],b[ae+3],b[ae+4])]),q=0;4>q;++q)r(b,P+32*q,ae,0,ae.length)}function ts(b,P){var q=b[P-1],ae=b[P-1+32],be=b[P-1+64],Ee=b[P-1+96];ke(b,P+0,16843009*vr(b[P-1-32],q,ae)),ke(b,P+32,16843009*vr(q,ae,be)),ke(b,P+64,16843009*vr(ae,be,Ee)),ke(b,P+96,16843009*vr(be,Ee,Ee))}function zr(b,P){var q,ae=4;for(q=0;4>q;++q)ae+=b[P+q-32]+b[P-1+32*q];for(ae>>=3,q=0;4>q;++q)i(b,P+32*q,ae,4)}function Ml(b,P){var q=b[P-1+0],ae=b[P-1+32],be=b[P-1+64],Ee=b[P-1-32],Ae=b[P+0-32],Ne=b[P+1-32],Ie=b[P+2-32],Ve=b[P+3-32];b[P+0+96]=vr(ae,be,b[P-1+96]),b[P+1+96]=b[P+0+64]=vr(q,ae,be),b[P+2+96]=b[P+1+64]=b[P+0+32]=vr(Ee,q,ae),b[P+3+96]=b[P+2+64]=b[P+1+32]=b[P+0+0]=vr(Ae,Ee,q),b[P+3+64]=b[P+2+32]=b[P+1+0]=vr(Ne,Ae,Ee),b[P+3+32]=b[P+2+0]=vr(Ie,Ne,Ae),b[P+3+0]=vr(Ve,Ie,Ne)}function fi(b,P){var q=b[P+1-32],ae=b[P+2-32],be=b[P+3-32],Ee=b[P+4-32],Ae=b[P+5-32],Ne=b[P+6-32],Ie=b[P+7-32];b[P+0+0]=vr(b[P+0-32],q,ae),b[P+1+0]=b[P+0+32]=vr(q,ae,be),b[P+2+0]=b[P+1+32]=b[P+0+64]=vr(ae,be,Ee),b[P+3+0]=b[P+2+32]=b[P+1+64]=b[P+0+96]=vr(be,Ee,Ae),b[P+3+32]=b[P+2+64]=b[P+1+96]=vr(Ee,Ae,Ne),b[P+3+64]=b[P+2+96]=vr(Ae,Ne,Ie),b[P+3+96]=vr(Ne,Ie,Ie)}function ns(b,P){var q=b[P-1+0],ae=b[P-1+32],be=b[P-1+64],Ee=b[P-1-32],Ae=b[P+0-32],Ne=b[P+1-32],Ie=b[P+2-32],Ve=b[P+3-32];b[P+0+0]=b[P+1+64]=Ee+Ae+1>>1,b[P+1+0]=b[P+2+64]=Ae+Ne+1>>1,b[P+2+0]=b[P+3+64]=Ne+Ie+1>>1,b[P+3+0]=Ie+Ve+1>>1,b[P+0+96]=vr(be,ae,q),b[P+0+64]=vr(ae,q,Ee),b[P+0+32]=b[P+1+96]=vr(q,Ee,Ae),b[P+1+32]=b[P+2+96]=vr(Ee,Ae,Ne),b[P+2+32]=b[P+3+96]=vr(Ae,Ne,Ie),b[P+3+32]=vr(Ne,Ie,Ve)}function to(b,P){var q=b[P+0-32],ae=b[P+1-32],be=b[P+2-32],Ee=b[P+3-32],Ae=b[P+4-32],Ne=b[P+5-32],Ie=b[P+6-32],Ve=b[P+7-32];b[P+0+0]=q+ae+1>>1,b[P+1+0]=b[P+0+64]=ae+be+1>>1,b[P+2+0]=b[P+1+64]=be+Ee+1>>1,b[P+3+0]=b[P+2+64]=Ee+Ae+1>>1,b[P+0+32]=vr(q,ae,be),b[P+1+32]=b[P+0+96]=vr(ae,be,Ee),b[P+2+32]=b[P+1+96]=vr(be,Ee,Ae),b[P+3+32]=b[P+2+96]=vr(Ee,Ae,Ne),b[P+3+64]=vr(Ae,Ne,Ie),b[P+3+96]=vr(Ne,Ie,Ve)}function Ua(b,P){var q=b[P-1+0],ae=b[P-1+32],be=b[P-1+64],Ee=b[P-1+96];b[P+0+0]=q+ae+1>>1,b[P+2+0]=b[P+0+32]=ae+be+1>>1,b[P+2+32]=b[P+0+64]=be+Ee+1>>1,b[P+1+0]=vr(q,ae,be),b[P+3+0]=b[P+1+32]=vr(ae,be,Ee),b[P+3+32]=b[P+1+64]=vr(be,Ee,Ee),b[P+3+64]=b[P+2+64]=b[P+0+96]=b[P+1+96]=b[P+2+96]=b[P+3+96]=Ee}function wu(b,P){var q=b[P-1+0],ae=b[P-1+32],be=b[P-1+64],Ee=b[P-1+96],Ae=b[P-1-32],Ne=b[P+0-32],Ie=b[P+1-32],Ve=b[P+2-32];b[P+0+0]=b[P+2+32]=q+Ae+1>>1,b[P+0+32]=b[P+2+64]=ae+q+1>>1,b[P+0+64]=b[P+2+96]=be+ae+1>>1,b[P+0+96]=Ee+be+1>>1,b[P+3+0]=vr(Ne,Ie,Ve),b[P+2+0]=vr(Ae,Ne,Ie),b[P+1+0]=b[P+3+32]=vr(q,Ae,Ne),b[P+1+32]=b[P+3+64]=vr(ae,q,Ae),b[P+1+64]=b[P+3+96]=vr(be,ae,q),b[P+1+96]=vr(Ee,be,ae)}function Al(b,P){var q;for(q=0;8>q;++q)r(b,P+32*q,b,P-32,8)}function Er(b,P){var q;for(q=0;8>q;++q)i(b,P,b[P-1],8),P+=32}function Hr(b,P,q){var ae;for(ae=0;8>ae;++ae)i(P,q+32*ae,b,8)}function Va(b,P){var q,ae=8;for(q=0;8>q;++q)ae+=b[P+q-32]+b[P-1+32*q];Hr(ae>>4,b,P)}function Yu(b,P){var q,ae=4;for(q=0;8>q;++q)ae+=b[P+q-32];Hr(ae>>3,b,P)}function kl(b,P){var q,ae=4;for(q=0;8>q;++q)ae+=b[P-1+32*q];Hr(ae>>3,b,P)}function Jl(b,P){Hr(128,b,P)}function ol(b,P,q){var ae=b[P-q],be=b[P+0],Ee=3*(be-ae)+ua[1020+b[P-2*q]-b[P+q]],Ae=xo[112+(Ee+4>>3)];b[P-q]=ji[255+ae+xo[112+(Ee+3>>3)]],b[P+0]=ji[255+be-Ae]}function Tl(b,P,q,ae){var be=b[P+0],Ee=b[P+q];return qo[255+b[P-2*q]-b[P-q]]>ae||qo[255+Ee-be]>ae}function Xl(b,P,q,ae){return 4*qo[255+b[P-q]-b[P+0]]+qo[255+b[P-2*q]-b[P+q]]<=ae}function Zr(b,P,q,ae,be){var Ee=b[P-3*q],Ae=b[P-2*q],Ne=b[P-q],Ie=b[P+0],Ve=b[P+q],ht=b[P+2*q],Ot=b[P+3*q];return 4*qo[255+Ne-Ie]+qo[255+Ae-Ve]>ae?0:qo[255+b[P-4*q]-Ee]<=be&&qo[255+Ee-Ae]<=be&&qo[255+Ae-Ne]<=be&&qo[255+Ot-ht]<=be&&qo[255+ht-Ve]<=be&&qo[255+Ve-Ie]<=be}function uo(b,P,q,ae){var be=2*ae+1;for(ae=0;16>ae;++ae)Xl(b,P+ae,q,be)&&ol(b,P+ae,q)}function lr(b,P,q,ae){var be=2*ae+1;for(ae=0;16>ae;++ae)Xl(b,P+ae*q,1,be)&&ol(b,P+ae*q,1)}function co(b,P,q,ae){var be;for(be=3;0<be;--be)uo(b,P+=4*q,q,ae)}function sl(b,P,q,ae){var be;for(be=3;0<be;--be)lr(b,P+=4,q,ae)}function ya(b,P,q,ae,be,Ee,Ae,Ne){for(Ee=2*Ee+1;0<be--;){if(Zr(b,P,q,Ee,Ae))if(Tl(b,P,q,Ne))ol(b,P,q);else{var Ie=b,Ve=P,ht=q,Ot=Ie[Ve-2*ht],Bt=Ie[Ve-ht],xt=Ie[Ve+0],Kt=Ie[Ve+ht],Gt=Ie[Ve+2*ht],dt=27*(en=ua[1020+3*(xt-Bt)+ua[1020+Ot-Kt]])+63>>7,yt=18*en+63>>7,en=9*en+63>>7;Ie[Ve-3*ht]=ji[255+Ie[Ve-3*ht]+en],Ie[Ve-2*ht]=ji[255+Ot+yt],Ie[Ve-ht]=ji[255+Bt+dt],Ie[Ve+0]=ji[255+xt-dt],Ie[Ve+ht]=ji[255+Kt-yt],Ie[Ve+2*ht]=ji[255+Gt-en]}P+=ae}}function qi(b,P,q,ae,be,Ee,Ae,Ne){for(Ee=2*Ee+1;0<be--;){if(Zr(b,P,q,Ee,Ae))if(Tl(b,P,q,Ne))ol(b,P,q);else{var Ie=b,Ve=P,ht=q,Ot=Ie[Ve-ht],Bt=Ie[Ve+0],xt=Ie[Ve+ht],Kt=xo[112+((Gt=3*(Bt-Ot))+4>>3)],Gt=xo[112+(Gt+3>>3)],dt=Kt+1>>1;Ie[Ve-2*ht]=ji[255+Ie[Ve-2*ht]+dt],Ie[Ve-ht]=ji[255+Ot+Gt],Ie[Ve+0]=ji[255+Bt-Kt],Ie[Ve+ht]=ji[255+xt-dt]}P+=ae}}function Ql(b,P,q,ae,be,Ee){ya(b,P,q,1,16,ae,be,Ee)}function ta(b,P,q,ae,be,Ee){ya(b,P,1,q,16,ae,be,Ee)}function Nl(b,P,q,ae,be,Ee){var Ae;for(Ae=3;0<Ae;--Ae)qi(b,P+=4*q,q,1,16,ae,be,Ee)}function Dl(b,P,q,ae,be,Ee){var Ae;for(Ae=3;0<Ae;--Ae)qi(b,P+=4,1,q,16,ae,be,Ee)}function Fs(b,P,q,ae,be,Ee,Ae,Ne){ya(b,P,be,1,8,Ee,Ae,Ne),ya(q,ae,be,1,8,Ee,Ae,Ne)}function Il(b,P,q,ae,be,Ee,Ae,Ne){ya(b,P,1,be,8,Ee,Ae,Ne),ya(q,ae,1,be,8,Ee,Ae,Ne)}function vi(b,P,q,ae,be,Ee,Ae,Ne){qi(b,P+4*be,be,1,8,Ee,Ae,Ne),qi(q,ae+4*be,be,1,8,Ee,Ae,Ne)}function Ju(b,P,q,ae,be,Ee,Ae,Ne){qi(b,P+4,1,be,8,Ee,Ae,Ne),qi(q,ae+4,1,be,8,Ee,Ae,Ne)}function ko(){this.ba=new Yn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Or,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Hs(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ol(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function qs(){this.ua=0,this.Wa=new de,this.vb=new de,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new $,this.yc=new D}function al(){this.xb=this.a=0,this.l=new Rr,this.ca=new Yn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new Y,this.Pb=0,this.wd=new Y,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new qs,this.ab=0,this.gc=o(4,Ol),this.Oc=0}function ll(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Rr,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function yi(b,P,q,ae,be,Ee,Ae){for(b=b==null?0:b[P+0],P=0;P<Ae;++P)be[Ee+P]=b+q[ae+P]&255,b=be[Ee+P]}function ks(b,P,q,ae,be,Ee,Ae){var Ne;if(b==null)yi(null,null,q,ae,be,Ee,Ae);else for(Ne=0;Ne<Ae;++Ne)be[Ee+Ne]=b[P+Ne]+q[ae+Ne]&255}function _a(b,P,q,ae,be,Ee,Ae){if(b==null)yi(null,null,q,ae,be,Ee,Ae);else{var Ne,Ie=b[P+0],Ve=Ie,ht=Ie;for(Ne=0;Ne<Ae;++Ne)Ve=ht+(Ie=b[P+Ne])-Ve,ht=q[ae+Ne]+(-256&Ve?0>Ve?0:255:Ve)&255,Ve=Ie,be[Ee+Ne]=ht}}function fo(b,P,q,ae){var be=P.width,Ee=P.o;if(n(b!=null&&P!=null),0>q||0>=ae||q+ae>Ee)return null;if(!b.Cc){if(b.ga==null){var Ae;if(b.ga=new ll,(Ae=b.ga==null)||(Ae=P.width*P.o,n(b.Gb.length==0),b.Gb=s(Ae),b.Uc=0,b.Gb==null?Ae=0:(b.mb=b.Gb,b.nb=b.Uc,b.rc=null,Ae=1),Ae=!Ae),!Ae){Ae=b.ga;var Ne=b.Fa,Ie=b.P,Ve=b.qc,ht=b.mb,Ot=b.nb,Bt=Ie+1,xt=Ve-1,Kt=Ae.l;if(n(Ne!=null&&ht!=null&&P!=null),pi[0]=null,pi[1]=yi,pi[2]=ks,pi[3]=_a,Ae.ca=ht,Ae.tb=Ot,Ae.c=P.width,Ae.i=P.height,n(0<Ae.c&&0<Ae.i),1>=Ve)P=0;else if(Ae.$a=Ne[Ie+0]>>0&3,Ae.Z=Ne[Ie+0]>>2&3,Ae.Lc=Ne[Ie+0]>>4&3,Ie=Ne[Ie+0]>>6&3,0>Ae.$a||1<Ae.$a||4<=Ae.Z||1<Ae.Lc||Ie)P=0;else if(Kt.put=$t,Kt.ac=Qe,Kt.bc=xn,Kt.ma=Ae,Kt.width=P.width,Kt.height=P.height,Kt.Da=P.Da,Kt.v=P.v,Kt.va=P.va,Kt.j=P.j,Kt.o=P.o,Ae.$a)e:{n(Ae.$a==1),P=Pr();t:for(;;){if(P==null){P=0;break e}if(n(Ae!=null),Ae.mc=P,P.c=Ae.c,P.i=Ae.i,P.l=Ae.l,P.l.ma=Ae,P.l.width=Ae.c,P.l.height=Ae.i,P.a=0,ie(P.m,Ne,Bt,xt),!dr(Ae.c,Ae.i,1,P,null)||(P.ab==1&&P.gc[0].hc==3&&Tt(P.s)?(Ae.ic=1,Ne=P.c*P.i,P.Ta=null,P.Ua=0,P.V=s(Ne),P.Ba=0,P.V==null?(P.a=1,P=0):P=1):(Ae.ic=0,P=Mi(P,Ae.c)),!P))break t;P=1;break e}Ae.mc=null,P=0}else P=xt>=Ae.c*Ae.i;Ae=!P}if(Ae)return null;b.ga.Lc!=1?b.Ga=0:ae=Ee-q}n(b.ga!=null),n(q+ae<=Ee);e:{if(P=(Ne=b.ga).c,Ee=Ne.l.o,Ne.$a==0){if(Bt=b.rc,xt=b.Vc,Kt=b.Fa,Ie=b.P+1+q*P,Ve=b.mb,ht=b.nb+q*P,n(Ie<=b.P+b.qc),Ne.Z!=0)for(n(pi[Ne.Z]!=null),Ae=0;Ae<ae;++Ae)pi[Ne.Z](Bt,xt,Kt,Ie,Ve,ht,P),Bt=Ve,xt=ht,ht+=P,Ie+=P;else for(Ae=0;Ae<ae;++Ae)r(Ve,ht,Kt,Ie,P),Bt=Ve,xt=ht,ht+=P,Ie+=P;b.rc=Bt,b.Vc=xt}else{if(n(Ne.mc!=null),P=q+ae,n((Ae=Ne.mc)!=null),n(P<=Ae.i),Ae.C>=P)P=1;else if(Ne.ic||Lt(),Ne.ic){Ne=Ae.V,Bt=Ae.Ba,xt=Ae.c;var Gt=Ae.i,dt=(Kt=1,Ie=Ae.$/xt,Ve=Ae.$%xt,ht=Ae.m,Ot=Ae.s,Ae.$),yt=xt*Gt,en=xt*P,dn=Ot.wc,nn=dt<en?mt(Ot,Ve,Ie):null;n(dt<=yt),n(P<=Gt),n(Tt(Ot));t:for(;;){for(;!ht.h&&dt<en;){if(Ve&dn||(nn=mt(Ot,Ve,Ie)),n(nn!=null),le(ht),256>(Gt=Hn(nn.G[0],nn.H[0],ht)))Ne[Bt+dt]=Gt,++dt,++Ve>=xt&&(Ve=0,++Ie<=P&&!(Ie%16)&&Qn(Ae,Ie));else{if(!(280>Gt)){Kt=0;break t}Gt=bn(Gt-256,ht);var kn,Pn=Hn(nn.G[4],nn.H[4],ht);if(le(ht),!(dt>=(Pn=Ht(xt,Pn=bn(Pn,ht)))&&yt-dt>=Gt)){Kt=0;break t}for(kn=0;kn<Gt;++kn)Ne[Bt+dt+kn]=Ne[Bt+dt+kn-Pn];for(dt+=Gt,Ve+=Gt;Ve>=xt;)Ve-=xt,++Ie<=P&&!(Ie%16)&&Qn(Ae,Ie);dt<en&&Ve&dn&&(nn=mt(Ot,Ve,Ie))}n(ht.h==Q(ht))}Qn(Ae,Ie>P?P:Ie);break t}!Kt||ht.h&&dt<yt?(Kt=0,Ae.a=ht.h?5:3):Ae.$=dt,P=Kt}else P=Pi(Ae,Ae.V,Ae.Ba,Ae.c,Ae.i,P,wr);if(!P){ae=0;break e}}q+ae>=Ee&&(b.Cc=1),ae=1}if(!ae)return null;if(b.Cc&&((ae=b.ga)!=null&&(ae.mc=null),b.ga=null,0<b.Ga))return alert("todo:WebPDequantizeLevels"),null}return b.nb+q*be}function O(b,P,q,ae,be,Ee){for(;0<be--;){var Ae,Ne=b,Ie=P+(q?1:0),Ve=b,ht=P+(q?0:3);for(Ae=0;Ae<ae;++Ae){var Ot=Ve[ht+4*Ae];Ot!=255&&(Ot*=32897,Ne[Ie+4*Ae+0]=Ne[Ie+4*Ae+0]*Ot>>23,Ne[Ie+4*Ae+1]=Ne[Ie+4*Ae+1]*Ot>>23,Ne[Ie+4*Ae+2]=Ne[Ie+4*Ae+2]*Ot>>23)}P+=Ee}}function _e(b,P,q,ae,be){for(;0<ae--;){var Ee;for(Ee=0;Ee<q;++Ee){var Ae=b[P+2*Ee+0],Ne=15&(Ve=b[P+2*Ee+1]),Ie=4369*Ne,Ve=(240&Ve|Ve>>4)*Ie>>16;b[P+2*Ee+0]=(240&Ae|Ae>>4)*Ie>>16&240|(15&Ae|Ae<<4)*Ie>>16>>4&15,b[P+2*Ee+1]=240&Ve|Ne}P+=be}}function Ye(b,P,q,ae,be,Ee,Ae,Ne){var Ie,Ve,ht=255;for(Ve=0;Ve<be;++Ve){for(Ie=0;Ie<ae;++Ie){var Ot=b[P+Ie];Ee[Ae+4*Ie]=Ot,ht&=Ot}P+=q,Ae+=Ne}return ht!=255}function ut(b,P,q,ae,be){var Ee;for(Ee=0;Ee<be;++Ee)q[ae+Ee]=b[P+Ee]>>8}function Lt(){No=O,wi=_e,ki=Ye,po=ut}function Ut(b,P,q){z[b]=function(ae,be,Ee,Ae,Ne,Ie,Ve,ht,Ot,Bt,xt,Kt,Gt,dt,yt,en,dn){var nn,kn=dn-1>>1,Pn=Ne[Ie+0]|Ve[ht+0]<<16,tr=Ot[Bt+0]|xt[Kt+0]<<16;n(ae!=null);var l=3*Pn+tr+131074>>2;for(P(ae[be+0],255&l,l>>16,Gt,dt),Ee!=null&&(l=3*tr+Pn+131074>>2,P(Ee[Ae+0],255&l,l>>16,yt,en)),nn=1;nn<=kn;++nn){var h=Ne[Ie+nn]|Ve[ht+nn]<<16,v=Ot[Bt+nn]|xt[Kt+nn]<<16,x=Pn+h+tr+v+524296,E=x+2*(h+tr)>>3;l=E+Pn>>1,Pn=(x=x+2*(Pn+v)>>3)+h>>1,P(ae[be+2*nn-1],255&l,l>>16,Gt,dt+(2*nn-1)*q),P(ae[be+2*nn-0],255&Pn,Pn>>16,Gt,dt+(2*nn-0)*q),Ee!=null&&(l=x+tr>>1,Pn=E+v>>1,P(Ee[Ae+2*nn-1],255&l,l>>16,yt,en+(2*nn-1)*q),P(Ee[Ae+2*nn+0],255&Pn,Pn>>16,yt,en+(2*nn+0)*q)),Pn=h,tr=v}1&dn||(l=3*Pn+tr+131074>>2,P(ae[be+dn-1],255&l,l>>16,Gt,dt+(dn-1)*q),Ee!=null&&(l=3*tr+Pn+131074>>2,P(Ee[Ae+dn-1],255&l,l>>16,yt,en+(dn-1)*q)))}}function fn(){Wo[vs]=De,Wo[pr]=Su,Wo[Sa]=_s,Wo[Ea]=Bo,Wo[Zs]=Vr,Wo[as]=Zc,Wo[bc]=dh,Wo[Do]=Su,Wo[Io]=Bo,Wo[Ks]=Vr,Wo[a]=Zc}function Dn(b){return b&-16384?0>b?0:255:b>>yd}function zn(b,P){return Dn((19077*b>>8)+(26149*P>>8)-14234)}function ir(b,P,q){return Dn((19077*b>>8)-(6419*P>>8)-(13320*q>>8)+8708)}function _r(b,P){return Dn((19077*b>>8)+(33050*P>>8)-17685)}function $r(b,P,q,ae,be){ae[be+0]=zn(b,q),ae[be+1]=ir(b,P,q),ae[be+2]=_r(b,P)}function Gi(b,P,q,ae,be){ae[be+0]=_r(b,P),ae[be+1]=ir(b,P,q),ae[be+2]=zn(b,q)}function hi(b,P,q,ae,be){var Ee=ir(b,P,q);P=Ee<<3&224|_r(b,P)>>3,ae[be+0]=248&zn(b,q)|Ee>>5,ae[be+1]=P}function _i(b,P,q,ae,be){var Ee=240&_r(b,P)|15;ae[be+0]=240&zn(b,q)|ir(b,P,q)>>4,ae[be+1]=Ee}function ho(b,P,q,ae,be){ae[be+0]=255,$r(b,P,q,ae,be+1)}function bo(b,P,q,ae,be){Gi(b,P,q,ae,be),ae[be+3]=255}function Ts(b,P,q,ae,be){$r(b,P,q,ae,be),ae[be+3]=255}function Ur(b,P){return 0>b?0:b>P?P:b}function zo(b,P,q){z[b]=function(ae,be,Ee,Ae,Ne,Ie,Ve,ht,Ot){for(var Bt=ht+(-2&Ot)*q;ht!=Bt;)P(ae[be+0],Ee[Ae+0],Ne[Ie+0],Ve,ht),P(ae[be+1],Ee[Ae+0],Ne[Ie+0],Ve,ht+q),be+=2,++Ae,++Ie,ht+=2*q;1&Ot&&P(ae[be+0],Ee[Ae+0],Ne[Ie+0],Ve,ht)}}function ul(b,P,q){return q==0?b==0?P==0?6:5:P==0?4:0:q}function rs(b,P,q,ae,be){switch(b>>>30){case 3:Wt(P,q,ae,be,0);break;case 2:Nt(P,q,ae,be);break;case 1:Jn(P,q,ae,be)}}function eu(b,P){var q,ae,be=P.M,Ee=P.Nb,Ae=b.oc,Ne=b.pc+40,Ie=b.oc,Ve=b.pc+584,ht=b.oc,Ot=b.pc+600;for(q=0;16>q;++q)Ae[Ne+32*q-1]=129;for(q=0;8>q;++q)Ie[Ve+32*q-1]=129,ht[Ot+32*q-1]=129;for(0<be?Ae[Ne-1-32]=Ie[Ve-1-32]=ht[Ot-1-32]=129:(i(Ae,Ne-32-1,127,21),i(Ie,Ve-32-1,127,9),i(ht,Ot-32-1,127,9)),ae=0;ae<b.za;++ae){var Bt=P.ya[P.aa+ae];if(0<ae){for(q=-1;16>q;++q)r(Ae,Ne+32*q-4,Ae,Ne+32*q+12,4);for(q=-1;8>q;++q)r(Ie,Ve+32*q-4,Ie,Ve+32*q+4,4),r(ht,Ot+32*q-4,ht,Ot+32*q+4,4)}var xt=b.Gd,Kt=b.Hd+ae,Gt=Bt.ad,dt=Bt.Hc;if(0<be&&(r(Ae,Ne-32,xt[Kt].y,0,16),r(Ie,Ve-32,xt[Kt].f,0,8),r(ht,Ot-32,xt[Kt].ea,0,8)),Bt.Za){var yt=Ae,en=Ne-32+16;for(0<be&&(ae>=b.za-1?i(yt,en,xt[Kt].y[15],4):r(yt,en,xt[Kt+1].y,0,4)),q=0;4>q;q++)yt[en+128+q]=yt[en+256+q]=yt[en+384+q]=yt[en+0+q];for(q=0;16>q;++q,dt<<=2)yt=Ae,en=Ne+gh[q],Ys[Bt.Ob[q]](yt,en),rs(dt,Gt,16*+q,yt,en)}else if(yt=ul(ae,be,Bt.Ob[0]),ca[yt](Ae,Ne),dt!=0)for(q=0;16>q;++q,dt<<=2)rs(dt,Gt,16*+q,Ae,Ne+gh[q]);for(q=Bt.Gc,yt=ul(ae,be,Bt.Dd),zs[yt](Ie,Ve),zs[yt](ht,Ot),dt=Gt,yt=Ie,en=Ve,255&(Bt=q>>0)&&(170&Bt?An(dt,256,yt,en):xr(dt,256,yt,en)),Bt=ht,dt=Ot,255&(q>>=8)&&(170&q?An(Gt,320,Bt,dt):xr(Gt,320,Bt,dt)),be<b.Ub-1&&(r(xt[Kt].y,0,Ae,Ne+480,16),r(xt[Kt].f,0,Ie,Ve+224,8),r(xt[Kt].ea,0,ht,Ot+224,8)),q=8*Ee*b.B,xt=b.sa,Kt=b.ta+16*ae+16*Ee*b.R,Gt=b.qa,Bt=b.ra+8*ae+q,dt=b.Ha,yt=b.Ia+8*ae+q,q=0;16>q;++q)r(xt,Kt+q*b.R,Ae,Ne+32*q,16);for(q=0;8>q;++q)r(Gt,Bt+q*b.B,Ie,Ve+32*q,8),r(dt,yt+q*b.B,ht,Ot+32*q,8)}}function na(b,P,q,ae,be,Ee,Ae,Ne,Ie){var Ve=[0],ht=[0],Ot=0,Bt=Ie!=null?Ie.kd:0,xt=Ie??new Hs;if(b==null||12>q)return 7;xt.data=b,xt.w=P,xt.ha=q,P=[P],q=[q],xt.gb=[xt.gb];e:{var Kt=P,Gt=q,dt=xt.gb;if(n(b!=null),n(Gt!=null),n(dt!=null),dt[0]=0,12<=Gt[0]&&!t(b,Kt[0],"RIFF")){if(t(b,Kt[0]+8,"WEBP")){dt=3;break e}var yt=ce(b,Kt[0]+4);if(12>yt||4294967286<yt){dt=3;break e}if(Bt&&yt>Gt[0]-8){dt=7;break e}dt[0]=yt,Kt[0]+=12,Gt[0]-=12}dt=0}if(dt!=0)return dt;for(yt=0<xt.gb[0],q=q[0];;){e:{var en=b;Gt=P,dt=q;var dn=Ve,nn=ht,kn=Kt=[0];if((l=Ot=[Ot])[0]=0,8>dt[0])dt=7;else{if(!t(en,Gt[0],"VP8X")){if(ce(en,Gt[0]+4)!=10){dt=3;break e}if(18>dt[0]){dt=7;break e}var Pn=ce(en,Gt[0]+8),tr=1+Ue(en,Gt[0]+12);if(2147483648<=tr*(en=1+Ue(en,Gt[0]+15))){dt=3;break e}kn!=null&&(kn[0]=Pn),dn!=null&&(dn[0]=tr),nn!=null&&(nn[0]=en),Gt[0]+=18,dt[0]-=18,l[0]=1}dt=0}}if(Ot=Ot[0],Kt=Kt[0],dt!=0)return dt;if(Gt=!!(2&Kt),!yt&&Ot)return 3;if(Ee!=null&&(Ee[0]=!!(16&Kt)),Ae!=null&&(Ae[0]=Gt),Ne!=null&&(Ne[0]=0),Ae=Ve[0],Kt=ht[0],Ot&&Gt&&Ie==null){dt=0;break}if(4>q){dt=7;break}if(yt&&Ot||!yt&&!Ot&&!t(b,P[0],"ALPH")){q=[q],xt.na=[xt.na],xt.P=[xt.P],xt.Sa=[xt.Sa];e:{Pn=b,dt=P,yt=q;var l=xt.gb;dn=xt.na,nn=xt.P,kn=xt.Sa,tr=22,n(Pn!=null),n(yt!=null),en=dt[0];var h=yt[0];for(n(dn!=null),n(kn!=null),dn[0]=null,nn[0]=null,kn[0]=0;;){if(dt[0]=en,yt[0]=h,8>h){dt=7;break e}var v=ce(Pn,en+4);if(4294967286<v){dt=3;break e}var x=8+v+1&-2;if(tr+=x,0<l&&tr>l){dt=3;break e}if(!t(Pn,en,"VP8 ")||!t(Pn,en,"VP8L")){dt=0;break e}if(h[0]<x){dt=7;break e}t(Pn,en,"ALPH")||(dn[0]=Pn,nn[0]=en+8,kn[0]=v),en+=x,h-=x}}if(q=q[0],xt.na=xt.na[0],xt.P=xt.P[0],xt.Sa=xt.Sa[0],dt!=0)break}q=[q],xt.Ja=[xt.Ja],xt.xa=[xt.xa];e:if(l=b,dt=P,yt=q,dn=xt.gb[0],nn=xt.Ja,kn=xt.xa,Pn=dt[0],en=!t(l,Pn,"VP8 "),tr=!t(l,Pn,"VP8L"),n(l!=null),n(yt!=null),n(nn!=null),n(kn!=null),8>yt[0])dt=7;else{if(en||tr){if(l=ce(l,Pn+4),12<=dn&&l>dn-12){dt=3;break e}if(Bt&&l>yt[0]-8){dt=7;break e}nn[0]=l,dt[0]+=8,yt[0]-=8,kn[0]=tr}else kn[0]=5<=yt[0]&&l[Pn+0]==47&&!(l[Pn+4]>>5),nn[0]=yt[0];dt=0}if(q=q[0],xt.Ja=xt.Ja[0],xt.xa=xt.xa[0],P=P[0],dt!=0)break;if(4294967286<xt.Ja)return 3;if(Ne==null||Gt||(Ne[0]=xt.xa?2:1),Ae=[Ae],Kt=[Kt],xt.xa){if(5>q){dt=7;break}Ne=Ae,Bt=Kt,Gt=Ee,b==null||5>q?b=0:5<=q&&b[P+0]==47&&!(b[P+4]>>5)?(yt=[0],l=[0],dn=[0],ie(nn=new Y,b,P,q),vn(nn,yt,l,dn)?(Ne!=null&&(Ne[0]=yt[0]),Bt!=null&&(Bt[0]=l[0]),Gt!=null&&(Gt[0]=dn[0]),b=1):b=0):b=0}else{if(10>q){dt=7;break}Ne=Kt,b==null||10>q||!Ei(b,P+3,q-3)?b=0:(Bt=b[P+0]|b[P+1]<<8|b[P+2]<<16,Gt=16383&(b[P+7]<<8|b[P+6]),b=16383&(b[P+9]<<8|b[P+8]),1&Bt||3<(Bt>>1&7)||!(Bt>>4&1)||Bt>>5>=xt.Ja||!Gt||!b?b=0:(Ae&&(Ae[0]=Gt),Ne&&(Ne[0]=b),b=1))}if(!b||(Ae=Ae[0],Kt=Kt[0],Ot&&(Ve[0]!=Ae||ht[0]!=Kt)))return 3;Ie!=null&&(Ie[0]=xt,Ie.offset=P-Ie.w,n(4294967286>P-Ie.w),n(Ie.offset==Ie.ha-q));break}return dt==0||dt==7&&Ot&&Ie==null?(Ee!=null&&(Ee[0]|=xt.na!=null&&0<xt.na.length),ae!=null&&(ae[0]=Ae),be!=null&&(be[0]=Kt),0):dt}function xu(b,P,q){var ae=P.width,be=P.height,Ee=0,Ae=0,Ne=ae,Ie=be;if(P.Da=b!=null&&0<b.Da,P.Da&&(Ne=b.cd,Ie=b.bd,Ee=b.v,Ae=b.j,11>q||(Ee&=-2,Ae&=-2),0>Ee||0>Ae||0>=Ne||0>=Ie||Ee+Ne>ae||Ae+Ie>be))return 0;if(P.v=Ee,P.j=Ae,P.va=Ee+Ne,P.o=Ae+Ie,P.U=Ne,P.T=Ie,P.da=b!=null&&0<b.da,P.da){if(!We(Ne,Ie,q=[b.ib],Ee=[b.hb]))return 0;P.ib=q[0],P.hb=Ee[0]}return P.ob=b!=null&&b.ob,P.Kb=b==null||!b.Sd,P.da&&(P.ob=P.ib<3*ae/4&&P.hb<3*be/4,P.Kb=0),1}function Ga(b){if(b==null)return 2;if(11>b.S){var P=b.f.RGBA;P.fb+=(b.height-1)*P.A,P.A=-P.A}else P=b.f.kb,b=b.height,P.O+=(b-1)*P.fa,P.fa=-P.fa,P.N+=(b-1>>1)*P.Ab,P.Ab=-P.Ab,P.W+=(b-1>>1)*P.Db,P.Db=-P.Db,P.F!=null&&(P.J+=(b-1)*P.lb,P.lb=-P.lb);return 0}function Ha(b,P,q,ae){if(ae==null||0>=b||0>=P)return 2;if(q!=null){if(q.Da){var be=q.cd,Ee=q.bd,Ae=-2&q.v,Ne=-2&q.j;if(0>Ae||0>Ne||0>=be||0>=Ee||Ae+be>b||Ne+Ee>P)return 2;b=be,P=Ee}if(q.da){if(!We(b,P,be=[q.ib],Ee=[q.hb]))return 2;b=be[0],P=Ee[0]}}ae.width=b,ae.height=P;e:{var Ie=ae.width,Ve=ae.height;if(b=ae.S,0>=Ie||0>=Ve||!(b>=vs&&13>b))b=2;else{if(0>=ae.Rd&&ae.sd==null){Ae=Ee=be=P=0;var ht=(Ne=Ie*yh[b])*Ve;if(11>b||(Ee=(Ve+1)/2*(P=(Ie+1)/2),b==12&&(Ae=(be=Ie)*Ve)),(Ve=s(ht+2*Ee+Ae))==null){b=1;break e}ae.sd=Ve,11>b?((Ie=ae.f.RGBA).eb=Ve,Ie.fb=0,Ie.A=Ne,Ie.size=ht):((Ie=ae.f.kb).y=Ve,Ie.O=0,Ie.fa=Ne,Ie.Fd=ht,Ie.f=Ve,Ie.N=0+ht,Ie.Ab=P,Ie.Cd=Ee,Ie.ea=Ve,Ie.W=0+ht+Ee,Ie.Db=P,Ie.Ed=Ee,b==12&&(Ie.F=Ve,Ie.J=0+ht+2*Ee),Ie.Tc=Ae,Ie.lb=be)}if(P=1,be=ae.S,Ee=ae.width,Ae=ae.height,be>=vs&&13>be)if(11>be)b=ae.f.RGBA,P&=(Ne=Math.abs(b.A))*(Ae-1)+Ee<=b.size,P&=Ne>=Ee*yh[be],P&=b.eb!=null;else{b=ae.f.kb,Ne=(Ee+1)/2,ht=(Ae+1)/2,Ie=Math.abs(b.fa),Ve=Math.abs(b.Ab);var Ot=Math.abs(b.Db),Bt=Math.abs(b.lb),xt=Bt*(Ae-1)+Ee;P&=Ie*(Ae-1)+Ee<=b.Fd,P&=Ve*(ht-1)+Ne<=b.Cd,P=(P&=Ot*(ht-1)+Ne<=b.Ed)&Ie>=Ee&Ve>=Ne&Ot>=Ne,P&=b.y!=null,P&=b.f!=null,P&=b.ea!=null,be==12&&(P&=Bt>=Ee,P&=xt<=b.Tc,P&=b.F!=null)}else P=0;b=P?0:2}}return b!=0||q!=null&&q.fd&&(b=Ga(ae)),b}var wo=64,ra=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ns=24,gs=32,cl=8,$o=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ze("Predictor0","PredictorAdd0"),z.Predictor0=function(){return 4278190080},z.Predictor1=function(b){return b},z.Predictor2=function(b,P,q){return P[q+0]},z.Predictor3=function(b,P,q){return P[q+1]},z.Predictor4=function(b,P,q){return P[q-1]},z.Predictor5=function(b,P,q){return He(He(b,P[q+1]),P[q+0])},z.Predictor6=function(b,P,q){return He(b,P[q-1])},z.Predictor7=function(b,P,q){return He(b,P[q+0])},z.Predictor8=function(b,P,q){return He(P[q-1],P[q+0])},z.Predictor9=function(b,P,q){return He(P[q+0],P[q+1])},z.Predictor10=function(b,P,q){return He(He(b,P[q-1]),He(P[q+0],P[q+1]))},z.Predictor11=function(b,P,q){var ae=P[q+0];return 0>=kt(ae>>24&255,b>>24&255,(P=P[q-1])>>24&255)+kt(ae>>16&255,b>>16&255,P>>16&255)+kt(ae>>8&255,b>>8&255,P>>8&255)+kt(255&ae,255&b,255&P)?ae:b},z.Predictor12=function(b,P,q){var ae=P[q+0];return(wt((b>>24&255)+(ae>>24&255)-((P=P[q-1])>>24&255))<<24|wt((b>>16&255)+(ae>>16&255)-(P>>16&255))<<16|wt((b>>8&255)+(ae>>8&255)-(P>>8&255))<<8|wt((255&b)+(255&ae)-(255&P)))>>>0},z.Predictor13=function(b,P,q){var ae=P[q-1];return(Pt((b=He(b,P[q+0]))>>24&255,ae>>24&255)<<24|Pt(b>>16&255,ae>>16&255)<<16|Pt(b>>8&255,ae>>8&255)<<8|Pt(b>>0&255,ae>>0&255))>>>0};var is=z.PredictorAdd0;z.PredictorAdd1=Jt,Ze("Predictor2","PredictorAdd2"),Ze("Predictor3","PredictorAdd3"),Ze("Predictor4","PredictorAdd4"),Ze("Predictor5","PredictorAdd5"),Ze("Predictor6","PredictorAdd6"),Ze("Predictor7","PredictorAdd7"),Ze("Predictor8","PredictorAdd8"),Ze("Predictor9","PredictorAdd9"),Ze("Predictor10","PredictorAdd10"),Ze("Predictor11","PredictorAdd11"),Ze("Predictor12","PredictorAdd12"),Ze("Predictor13","PredictorAdd13");var os=z.PredictorAdd2;ot("ColorIndexInverseTransform","MapARGB","32b",function(b){return b>>8&255},function(b){return b}),ot("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(b){return b},function(b){return b>>8&255});var Xu,Po=z.ColorIndexInverseTransform,ba=z.MapARGB,Uo=z.VP8LColorIndexInverseTransformAlpha,Vo=z.MapAlpha,wa=z.VP8LPredictorsAdd=[];wa.length=16,(z.VP8LPredictors=[]).length=16,(z.VP8LPredictorsAdd_C=[]).length=16,(z.VP8LPredictors_C=[]).length=16;var xa,Go,To,ia,Ds,Ho,_t,Wt,Nt,An,Jn,xr,Wi,bi,Bl,ss,Zi,oa,La,sa,aa,la,Kr,Ws,No,wi,ki,po,$i=s(511),Is=s(2041),ms=s(225),js=s(767),Lu=0,ua=Is,xo=ms,ji=js,qo=$i,vs=0,pr=1,Sa=2,Ea=3,Zs=4,as=5,bc=6,Do=7,Io=8,Ks=9,a=10,p=[2,3,7],S=[3,3,11],V=[280,256,256,256,40],se=[0,1,1,1,0],Se=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],st=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],At=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Vt=8,sn=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],In=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],er=null,Fr=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Lo=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],io=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Oo=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Ki=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],ys=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],wc=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ca=[],Ys=[],zs=[],Tf=1,tu=2,pi=[],Wo=[];Ut("UpsampleRgbLinePair",$r,3),Ut("UpsampleBgrLinePair",Gi,3),Ut("UpsampleRgbaLinePair",Ts,4),Ut("UpsampleBgraLinePair",bo,4),Ut("UpsampleArgbLinePair",ho,4),Ut("UpsampleRgba4444LinePair",_i,2),Ut("UpsampleRgb565LinePair",hi,2);var De=z.UpsampleRgbLinePair,_s=z.UpsampleBgrLinePair,Su=z.UpsampleRgbaLinePair,Bo=z.UpsampleBgraLinePair,Vr=z.UpsampleArgbLinePair,Zc=z.UpsampleRgba4444LinePair,dh=z.UpsampleRgb565LinePair,Kc=16,qa=1<<Kc-1,xc=-227,Nf=482,yd=6,Qu=0,Yc=s(256),Rl=s(256),_d=s(256),Jc=s(256),Xc=s(Nf-xc),ph=s(Nf-xc);zo("YuvToRgbRow",$r,3),zo("YuvToBgrRow",Gi,3),zo("YuvToRgbaRow",Ts,4),zo("YuvToBgraRow",bo,4),zo("YuvToArgbRow",ho,4),zo("YuvToRgba4444Row",_i,2),zo("YuvToRgb565Row",hi,2);var gh=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Ca=[0,2,8],mh=[8,7,6,4,4,2,2,2,1,1,1,1],vh=1;this.WebPDecodeRGBA=function(b,P,q,ae,be){var Ee=pr,Ae=new ko,Ne=new Yn;Ae.ba=Ne,Ne.S=Ee,Ne.width=[Ne.width],Ne.height=[Ne.height];var Ie=Ne.width,Ve=Ne.height,ht=new br;if(ht==null||b==null)var Ot=2;else n(ht!=null),Ot=na(b,P,q,ht.width,ht.height,ht.Pd,ht.Qd,ht.format,null);if(Ot!=0?Ie=0:(Ie!=null&&(Ie[0]=ht.width[0]),Ve!=null&&(Ve[0]=ht.height[0]),Ie=1),Ie){Ne.width=Ne.width[0],Ne.height=Ne.height[0],ae!=null&&(ae[0]=Ne.width),be!=null&&(be[0]=Ne.height);e:{if(ae=new Rr,(be=new Hs).data=b,be.w=P,be.ha=q,be.kd=1,P=[0],n(be!=null),((b=na(be.data,be.w,be.ha,null,null,null,P,null,be))==0||b==7)&&P[0]&&(b=4),(P=b)==0){if(n(Ae!=null),ae.data=be.data,ae.w=be.w+be.offset,ae.ha=be.ha-be.offset,ae.put=$t,ae.ac=Qe,ae.bc=xn,ae.ma=Ae,be.xa){if((b=Pr())==null){Ae=1;break e}if(function(Bt,xt){var Kt=[0],Gt=[0],dt=[0];t:for(;;){if(Bt==null)return 0;if(xt==null)return Bt.a=2,0;if(Bt.l=xt,Bt.a=0,ie(Bt.m,xt.data,xt.w,xt.ha),!vn(Bt.m,Kt,Gt,dt)){Bt.a=3;break t}if(Bt.xb=tu,xt.width=Kt[0],xt.height=Gt[0],!dr(Kt[0],Gt[0],1,Bt,null))break t;return 1}return n(Bt.a!=0),0}(b,ae)){if(ae=(P=Ha(ae.width,ae.height,Ae.Oa,Ae.ba))==0){t:{ae=b;n:for(;;){if(ae==null){ae=0;break t}if(n(ae.s.yc!=null),n(ae.s.Ya!=null),n(0<ae.s.Wb),n((q=ae.l)!=null),n((be=q.ma)!=null),ae.xb!=0){if(ae.ca=be.ba,ae.tb=be.tb,n(ae.ca!=null),!xu(be.Oa,q,Ea)){ae.a=2;break n}if(!Mi(ae,q.width)||q.da)break n;if((q.da||En(ae.ca.S))&&Lt(),11>ae.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),ae.ca.f.kb.F!=null&&Lt()),ae.Pb&&0<ae.s.ua&&ae.s.vb.X==null&&!ne(ae.s.vb,ae.s.Wa.Xa)){ae.a=1;break n}ae.xb=0}if(!Pi(ae,ae.V,ae.Ba,ae.c,ae.i,q.o,Qr))break n;be.Dc=ae.Ma,ae=1;break t}n(ae.a!=0),ae=0}ae=!ae}ae&&(P=b.a)}else P=b.a}else{if((b=new mn)==null){Ae=1;break e}if(b.Fa=be.na,b.P=be.P,b.qc=be.Sa,Bi(b,ae)){if((P=Ha(ae.width,ae.height,Ae.Oa,Ae.ba))==0){if(b.Aa=0,q=Ae.Oa,n((be=b)!=null),q!=null){if(0<(Ie=0>(Ie=q.Md)?0:100<Ie?255:255*Ie/100)){for(Ve=ht=0;4>Ve;++Ve)12>(Ot=be.pb[Ve]).lc&&(Ot.ia=Ie*mh[0>Ot.lc?0:Ot.lc]>>3),ht|=Ot.ia;ht&&(alert("todo:VP8InitRandom"),be.ia=1)}be.Ga=q.Id,100<be.Ga?be.Ga=100:0>be.Ga&&(be.Ga=0)}cr(b,ae)||(P=b.a)}}else P=b.a}P==0&&Ae.Oa!=null&&Ae.Oa.fd&&(P=Ga(Ae.ba))}Ae=P}Ee=Ae!=0?null:11>Ee?Ne.f.RGBA.eb:Ne.f.kb.y}else Ee=null;return Ee};var yh=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(z,U){for(var J="",T=0;T<4;T++)J+=String.fromCharCode(z[U++]);return J}function m(z,U){return(z[U+0]<<0|z[U+1]<<8|z[U+2]<<16)>>>0}function _(z,U){return(z[U+0]<<0|z[U+1]<<8|z[U+2]<<16|z[U+3]<<24)>>>0}new f;var w=[0],y=[0],M=[],k=new f,F=e,I=function(z,U){var J={},T=0,D=!1,B=0,$=0;if(J.frames=[],!function(H,Q,ue,le){for(var pe=0;pe<le;pe++)if(H[Q+pe]!=ue.charCodeAt(pe))return!0;return!1}(z,U,"RIFF",4)){var W,G;for(_(z,U+=4),U+=8;U<z.length;){var oe=d(z,U),ie=_(z,U+=4);U+=4;var we=ie+(1&ie);switch(oe){case"VP8 ":case"VP8L":J.frames[T]===void 0&&(J.frames[T]={}),(Y=J.frames[T]).src_off=D?$:U-8,Y.src_size=B+ie+8,T++,D&&(D=!1,B=0,$=0);break;case"VP8X":(Y=J.header={}).feature_flags=z[U];var Ce=U+4;Y.canvas_width=1+m(z,Ce),Ce+=3,Y.canvas_height=1+m(z,Ce),Ce+=3;break;case"ALPH":D=!0,B=we+8,$=U-8;break;case"ANIM":(Y=J.header).bgcolor=_(z,U),Ce=U+4,Y.loop_count=(W=z)[(G=Ce)+0]<<0|W[G+1]<<8,Ce+=2;break;case"ANMF":var Te,Y;(Y=J.frames[T]={}).offset_x=2*m(z,U),U+=3,Y.offset_y=2*m(z,U),U+=3,Y.width=1+m(z,U),U+=3,Y.height=1+m(z,U),U+=3,Y.duration=m(z,U),U+=3,Te=z[U++],Y.dispose=1&Te,Y.blend=Te>>1&1}oe!="ANMF"&&(U+=we)}return J}}(F,0);I.response=F,I.rgbaoutput=!0,I.dataurl=!1;var R=I.header?I.header:null,K=I.frames?I.frames:null;if(R){R.loop_counter=R.loop_count,w=[R.canvas_height],y=[R.canvas_width];for(var ee=0;ee<K.length&&K[ee].blend!=0;ee++);}var he=K[0],fe=k.WebPDecodeRGBA(F,he.src_off,he.src_size,y,w);he.rgba=fe,he.imgwidth=y[0],he.imgheight=w[0];for(var ve=0;ve<y[0]*w[0]*4;ve++)M[ve]=fe[ve];return this.width=y,this.height=w,this.data=M,this}(function(e){var n=function(){return typeof b1=="function"},t=function(w,y,M,k){var F=4,I=o;switch(k){case e.image_compression.FAST:F=1,I=s;break;case e.image_compression.MEDIUM:F=6,I=u;break;case e.image_compression.SLOW:F=9,I=f}w=r(w,y,M,I);var R=b1(w,{level:F});return e.__addimage__.arrayBufferToBinaryString(R)},r=function(w,y,M,k){for(var F,I,R,K=w.length/y,ee=new Uint8Array(w.length+K),he=m(),fe=0;fe<K;fe+=1){if(R=fe*y,F=w.subarray(R,R+y),k)ee.set(k(F,M,I),R+fe);else{for(var ve,z=he.length,U=[];ve<z;ve+=1)U[ve]=he[ve](F,M,I);var J=_(U.concat());ee.set(U[J],R+fe)}I=F}return ee},i=function(w){var y=Array.apply([],w);return y.unshift(0),y},s=function(w,y){var M,k=[],F=w.length;k[0]=1;for(var I=0;I<F;I+=1)M=w[I-y]||0,k[I+1]=w[I]-M+256&255;return k},o=function(w,y,M){var k,F=[],I=w.length;F[0]=2;for(var R=0;R<I;R+=1)k=M&&M[R]||0,F[R+1]=w[R]-k+256&255;return F},u=function(w,y,M){var k,F,I=[],R=w.length;I[0]=3;for(var K=0;K<R;K+=1)k=w[K-y]||0,F=M&&M[K]||0,I[K+1]=w[K]+256-(k+F>>>1)&255;return I},f=function(w,y,M){var k,F,I,R,K=[],ee=w.length;K[0]=4;for(var he=0;he<ee;he+=1)k=w[he-y]||0,F=M&&M[he]||0,I=M&&M[he-y]||0,R=d(k,F,I),K[he+1]=w[he]-R+256&255;return K},d=function(w,y,M){if(w===y&&y===M)return w;var k=Math.abs(y-M),F=Math.abs(w-M),I=Math.abs(w+y-M-M);return k<=F&&k<=I?w:F<=I?y:M},m=function(){return[i,s,o,u,f]},_=function(w){var y=w.map(function(M){return M.reduce(function(k,F){return k+Math.abs(F)},0)});return y.indexOf(Math.min.apply(null,y))};e.processPNG=function(w,y,M,k){var F,I,R,K,ee,he,fe,ve,z,U,J,T,D,B,$,W=this.decode.FLATE_DECODE,G="";if(this.__addimage__.isArrayBuffer(w)&&(w=new Uint8Array(w)),this.__addimage__.isArrayBufferView(w)){if(w=(R=new DF(w)).imgData,I=R.bits,F=R.colorSpace,ee=R.colors,[4,6].indexOf(R.colorType)!==-1){if(R.bits===8){z=(ve=R.pixelBitlength==32?new Uint32Array(R.decodePixels().buffer):R.pixelBitlength==16?new Uint16Array(R.decodePixels().buffer):new Uint8Array(R.decodePixels().buffer)).length,J=new Uint8Array(z*R.colors),U=new Uint8Array(z);var oe,ie=R.pixelBitlength-R.bits;for(B=0,$=0;B<z;B++){for(D=ve[B],oe=0;oe<ie;)J[$++]=D>>>oe&255,oe+=R.bits;U[B]=D>>>oe&255}}if(R.bits===16){z=(ve=new Uint32Array(R.decodePixels().buffer)).length,J=new Uint8Array(z*(32/R.pixelBitlength)*R.colors),U=new Uint8Array(z*(32/R.pixelBitlength)),T=R.colors>1,B=0,$=0;for(var we=0;B<z;)D=ve[B++],J[$++]=D>>>0&255,T&&(J[$++]=D>>>16&255,D=ve[B++],J[$++]=D>>>0&255),U[we++]=D>>>16&255;I=8}k!==e.image_compression.NONE&&n()?(w=t(J,R.width*R.colors,R.colors,k),fe=t(U,R.width,1,k)):(w=J,fe=U,W=void 0)}if(R.colorType===3&&(F=this.color_spaces.INDEXED,he=R.palette,R.transparency.indexed)){var Ce=R.transparency.indexed,Te=0;for(B=0,z=Ce.length;B<z;++B)Te+=Ce[B];if((Te/=255)===z-1&&Ce.indexOf(0)!==-1)K=[Ce.indexOf(0)];else if(Te!==z){for(ve=R.decodePixels(),U=new Uint8Array(ve.length),B=0,z=ve.length;B<z;B++)U[B]=Ce[ve[B]];fe=t(U,R.width,1)}}var Y=function(H){var Q;switch(H){case e.image_compression.FAST:Q=11;break;case e.image_compression.MEDIUM:Q=13;break;case e.image_compression.SLOW:Q=14;break;default:Q=12}return Q}(k);return W===this.decode.FLATE_DECODE&&(G="/Predictor "+Y+" "),G+="/Colors "+ee+" /BitsPerComponent "+I+" /Columns "+R.width,(this.__addimage__.isArrayBuffer(w)||this.__addimage__.isArrayBufferView(w))&&(w=this.__addimage__.arrayBufferToBinaryString(w)),(fe&&this.__addimage__.isArrayBuffer(fe)||this.__addimage__.isArrayBufferView(fe))&&(fe=this.__addimage__.arrayBufferToBinaryString(fe)),{alias:M,data:w,index:y,filter:W,decodeParameters:G,transparency:K,palette:he,sMask:fe,predictor:Y,width:R.width,height:R.height,bitsPerComponent:I,colorSpace:F}}}})(kr.API),function(e){e.processGIF89A=function(n,t,r,i){var s=new IF(n),o=s.width,u=s.height,f=[];s.decodeAndBlitFrameRGBA(0,f);var d={data:f,width:o,height:u},m=new pv(100).encode(d,100);return e.processJPEG.call(this,m,t,r,i)},e.processGIF87A=e.processGIF89A}(kr.API),Iu.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var n=0;n<e;n++){var t=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[n]={red:i,green:r,blue:t,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Iu.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,n=this.width*this.height*4;this.data=new Uint8Array(n),this[e]()}catch(t){mo.log("bit decode error:"+t)}},Iu.prototype.bit1=function(){var e,n=Math.ceil(this.width/8),t=n%4;for(e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,i=0;i<n;i++)for(var s=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+8*i*4,u=0;u<8&&8*i+u<this.width;u++){var f=this.palette[s>>7-u&1];this.data[o+4*u]=f.blue,this.data[o+4*u+1]=f.green,this.data[o+4*u+2]=f.red,this.data[o+4*u+3]=255}t!==0&&(this.pos+=4-t)}},Iu.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),n=e%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,i=0;i<e;i++){var s=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+2*i*4,u=s>>4,f=15&s,d=this.palette[u];if(this.data[o]=d.blue,this.data[o+1]=d.green,this.data[o+2]=d.red,this.data[o+3]=255,2*i+1>=this.width)break;d=this.palette[f],this.data[o+4]=d.blue,this.data[o+4+1]=d.green,this.data[o+4+2]=d.red,this.data[o+4+3]=255}n!==0&&(this.pos+=4-n)}},Iu.prototype.bit8=function(){for(var e=this.width%4,n=this.height-1;n>=0;n--){for(var t=this.bottom_up?n:this.height-1-n,r=0;r<this.width;r++){var i=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*r;if(i<this.palette.length){var o=this.palette[i];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}e!==0&&(this.pos+=4-e)}},Iu.prototype.bit15=function(){for(var e=this.width%3,n=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&n)/n*255|0,u=(s>>5&n)/n*255|0,f=(s>>10&n)/n*255|0,d=s>>15?255:0,m=r*this.width*4+4*i;this.data[m]=f,this.data[m+1]=u,this.data[m+2]=o,this.data[m+3]=d}this.pos+=e}},Iu.prototype.bit16=function(){for(var e=this.width%3,n=parseInt("11111",2),t=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var u=(o&n)/n*255|0,f=(o>>5&t)/t*255|0,d=(o>>11)/n*255|0,m=i*this.width*4+4*s;this.data[m]=d,this.data[m+1]=f,this.data[m+2]=u,this.data[m+3]=255}this.pos+=e}},Iu.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,t=0;t<this.width;t++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+4*t;this.data[o]=s,this.data[o+1]=i,this.data[o+2]=r,this.data[o+3]=255}this.pos+=this.width%4}},Iu.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var n=this.bottom_up?e:this.height-1-e,t=0;t<this.width;t++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),u=n*this.width*4+4*t;this.data[u]=s,this.data[u+1]=i,this.data[u+2]=r,this.data[u+3]=o}},Iu.prototype.getData=function(){return this.data},function(e){e.processBMP=function(n,t,r,i){var s=new Iu(n,!1),o=s.width,u=s.height,f={data:s.getData(),width:o,height:u},d=new pv(100).encode(f,100);return e.processJPEG.call(this,d,t,r,i)}}(kr.API),zb.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(n,t,r,i){var s=new zb(n),o=s.width,u=s.height,f={data:s.getData(),width:o,height:u},d=new pv(100).encode(f,100);return e.processJPEG.call(this,d,t,r,i)}}(kr.API),kr.API.processRGBA=function(e,n,t){for(var r=e.data,i=r.length,s=new Uint8Array(i/4*3),o=new Uint8Array(i/4),u=0,f=0,d=0;d<i;d+=4){var m=r[d],_=r[d+1],w=r[d+2],y=r[d+3];s[u++]=m,s[u++]=_,s[u++]=w,o[f++]=y}var M=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:M,index:n,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},kr.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Dh=kr.API,xg=Dh.getCharWidthsArray=function(e,n){var t,r,i=(n=n||{}).font||this.internal.getFont(),s=n.fontSize||this.internal.getFontSize(),o=n.charSpace||this.internal.getCharSpace(),u=n.widths?n.widths:i.metadata.Unicode.widths,f=u.fof?u.fof:1,d=n.kerning?n.kerning:i.metadata.Unicode.kerning,m=d.fof?d.fof:1,_=n.doKerning!==!1,w=0,y=e.length,M=0,k=u[0]||f,F=[];for(t=0;t<y;t++)r=e.charCodeAt(t),typeof i.metadata.widthOfString=="function"?F.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(r))+o*(1e3/s)||0)/1e3):(w=_&&so(d[r])==="object"&&!isNaN(parseInt(d[r][M],10))?d[r][M]/m:0,F.push((u[r]||k)/f+w)),M=r;return F},Bb=Dh.getStringUnitWidth=function(e,n){var t=(n=n||{}).fontSize||this.internal.getFontSize(),r=n.font||this.internal.getFont(),i=n.charSpace||this.internal.getCharSpace();return Dh.processArabic&&(e=Dh.processArabic(e)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(e,t,i)/t:xg.apply(this,arguments).reduce(function(s,o){return s+o},0)},Rb=function(e,n,t,r){for(var i=[],s=0,o=e.length,u=0;s!==o&&u+n[s]<t;)u+=n[s],s++;i.push(e.slice(0,s));var f=s;for(u=0;s!==o;)u+n[s]>r&&(i.push(e.slice(f,s)),u=0,f=s),u+=n[s],s++;return f!==s&&i.push(e.slice(f,s)),i},Fb=function(e,n,t){t||(t={});var r,i,s,o,u,f,d,m=[],_=[m],w=t.textIndent||0,y=0,M=0,k=e.split(" "),F=xg.apply(this,[" ",t])[0];if(f=t.lineIndent===-1?k[0].length+2:t.lineIndent||0){var I=Array(f).join(" "),R=[];k.map(function(ee){(ee=ee.split(/\s*\n/)).length>1?R=R.concat(ee.map(function(he,fe){return(fe&&he.length?`
`:"")+he})):R.push(ee[0])}),k=R,f=Bb.apply(this,[I,t])}for(s=0,o=k.length;s<o;s++){var K=0;if(r=k[s],f&&r[0]==`
`&&(r=r.substr(1),K=1),w+y+(M=(i=xg.apply(this,[r,t])).reduce(function(ee,he){return ee+he},0))>n||K){if(M>n){for(u=Rb.apply(this,[r,i,n-(w+y),n]),m.push(u.shift()),m=[u.pop()];u.length;)_.push([u.shift()]);M=i.slice(r.length-(m[0]?m[0].length:0)).reduce(function(ee,he){return ee+he},0)}else m=[r];_.push(m),w=M+f,y=F}else m.push(r),w+=y+M,y=F}return d=f?function(ee,he){return(he?I:"")+ee.join(" ")}:function(ee){return ee.join(" ")},_.map(d)},Dh.splitTextToSize=function(e,n,t){var r,i=(t=t||{}).fontSize||this.internal.getFontSize(),s=(function(m){if(m.widths&&m.kerning)return{widths:m.widths,kerning:m.kerning};var _=this.internal.getFont(m.fontName,m.fontStyle);return _.metadata.Unicode?{widths:_.metadata.Unicode.widths||{0:1},kerning:_.metadata.Unicode.kerning||{}}:{font:_.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);r=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*n/i;s.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/i:0,s.lineIndent=t.lineIndent;var u,f,d=[];for(u=0,f=r.length;u<f;u++)d=d.concat(Fb.apply(this,[r[u],o,s]));return d},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var n="klmnopqrstuvwxyz",t={},r={},i=0;i<n.length;i++)t[n[i]]="0123456789abcdef"[i],r["0123456789abcdef"[i]]=n[i];var s=function(_){return"0x"+parseInt(_,10).toString(16)},o=e.__fontmetrics__.compress=function(_){var w,y,M,k,F=["{"];for(var I in _){if(w=_[I],isNaN(parseInt(I,10))?y="'"+I+"'":(I=parseInt(I,10),y=(y=s(I).slice(2)).slice(0,-1)+r[y.slice(-1)]),typeof w=="number")w<0?(M=s(w).slice(3),k="-"):(M=s(w).slice(2),k=""),M=k+M.slice(0,-1)+r[M.slice(-1)];else{if(so(w)!=="object")throw new Error("Don't know what to do with value type "+so(w)+".");M=o(w)}F.push(y+M)}return F.push("}"),F.join("")},u=e.__fontmetrics__.uncompress=function(_){if(typeof _!="string")throw new Error("Invalid argument passed to uncompress.");for(var w,y,M,k,F={},I=1,R=F,K=[],ee="",he="",fe=_.length-1,ve=1;ve<fe;ve+=1)(k=_[ve])=="'"?w?(M=w.join(""),w=void 0):w=[]:w?w.push(k):k=="{"?(K.push([R,M]),R={},M=void 0):k=="}"?((y=K.pop())[0][y[1]]=R,M=void 0,R=y[0]):k=="-"?I=-1:M===void 0?t.hasOwnProperty(k)?(ee+=t[k],M=parseInt(ee,16)*I,I=1,ee=""):ee+=k:t.hasOwnProperty(k)?(he+=t[k],R[M]=parseInt(he,16)*I,I=1,M=void 0,he=""):he+=k;return F},f={codePages:["WinAnsiEncoding"],WinAnsiEncoding:u("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:f,"Courier-Bold":f,"Courier-BoldOblique":f,"Courier-Oblique":f,Helvetica:f,"Helvetica-Bold":f,"Helvetica-BoldOblique":f,"Helvetica-Oblique":f,"Times-Roman":f,"Times-Bold":f,"Times-BoldItalic":f,"Times-Italic":f}},m={Unicode:{"Courier-Oblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":u("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":u("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:u("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:u("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":u("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":u("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(_){var w=_.font,y=m.Unicode[w.postScriptName];y&&(w.metadata.Unicode={},w.metadata.Unicode.widths=y.widths,w.metadata.Unicode.kerning=y.kerning);var M=d.Unicode[w.postScriptName];M&&(w.metadata.Unicode.encoding=M,w.encoding=M.codePages[0])}])}(kr.API),function(e){var n=function(t){for(var r=t.length,i=new Uint8Array(r),s=0;s<r;s++)i[s]=t.charCodeAt(s);return i};e.API.events.push(["addFont",function(t){var r=void 0,i=t.font,s=t.instance;if(!i.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(r=s.existsFileInVFS(i.postScriptName)===!1?s.loadFile(i.postScriptName):s.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(o,u){u=/^\x00\x01\x00\x00/.test(u)?n(u):n(ap(u)),o.metadata=e.API.TTFFont.open(u),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(i,r)}}])}(kr),function(e){function n(){return(Dr.canvg?Promise.resolve(Dr.canvg):mf(()=>import("./index.es.js"),[])).catch(function(t){return Promise.reject(new Error("Could not load canvg: "+t))}).then(function(t){return t.default?t.default:t})}kr.API.addSvgAsImage=function(t,r,i,s,o,u,f,d){if(isNaN(r)||isNaN(i))throw mo.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(o))throw mo.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var m=document.createElement("canvas");m.width=s,m.height=o;var _=m.getContext("2d");_.fillStyle="#fff",_.fillRect(0,0,m.width,m.height);var w={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},y=this;return n().then(function(M){return M.fromString(_,t,w)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(M){return M.render(w)}).then(function(){y.addImage(m.toDataURL("image/jpeg",1),r,i,s,o,f,d)})}}(),kr.API.putTotalPages=function(e){var n,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(n=new RegExp(e,"g"),t=this.internal.getNumberOfPages()):(n=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var i=0;i<this.internal.pages[r].length;i++)this.internal.pages[r][i]=this.internal.pages[r][i].replace(n,t);return this},kr.API.viewerPreferences=function(e,n){var t;e=e||{},n=n||!1;var r,i,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},u=Object.keys(o),f=[],d=0,m=0,_=0;function w(M,k){var F,I=!1;for(F=0;F<M.length;F+=1)M[F]===k&&(I=!0);return I}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,e==="reset"||n===!0){var y=u.length;for(_=0;_<y;_+=1)t[u[_]].value=t[u[_]].defaultValue,t[u[_]].explicitSet=!1}if(so(e)==="object"){for(i in e)if(s=e[i],w(u,i)&&s!==void 0){if(t[i].type==="boolean"&&typeof s=="boolean")t[i].value=s;else if(t[i].type==="name"&&w(t[i].valueSet,s))t[i].value=s;else if(t[i].type==="integer"&&Number.isInteger(s))t[i].value=s;else if(t[i].type==="array"){for(d=0;d<s.length;d+=1)if(r=!0,s[d].length===1&&typeof s[d][0]=="number")f.push(String(s[d]-1));else if(s[d].length>1){for(m=0;m<s[d].length;m+=1)typeof s[d][m]!="number"&&(r=!1);r===!0&&f.push([s[d][0]-1,s[d][1]-1].join(" "))}t[i].value="["+f.join(" ")+"]"}else t[i].value=t[i].defaultValue;t[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var M,k=[];for(M in t)t[M].explicitSet===!0&&(t[M].type==="name"?k.push("/"+M+" /"+t[M].value):k.push("/"+M+" "+t[M].value));k.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+k.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},function(e){var n=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(r)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),u=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),f=unescape(encodeURIComponent("</x:xmpmeta>")),d=s.length+o.length+u.length+i.length+f.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(i+s+o+u+f),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(r,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",n)),this}}(kr.API),function(e){var n=e.API,t=n.pdfEscape16=function(s,o){for(var u,f=o.metadata.Unicode.widths,d=["","0","00","000","0000"],m=[""],_=0,w=s.length;_<w;++_){if(u=o.metadata.characterToGlyph(s.charCodeAt(_)),o.metadata.glyIdsUsed.push(u),o.metadata.toUnicode[u]=s.charCodeAt(_),f.indexOf(u)==-1&&(f.push(u),f.push([parseInt(o.metadata.widthOfGlyph(u),10)])),u=="0")return m.join("");u=u.toString(16),m.push(d[4-u.length],u)}return m.join("")},r=function(s){var o,u,f,d,m,_,w;for(m=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,f=[],_=0,w=(u=Object.keys(s).sort(function(y,M){return y-M})).length;_<w;_++)o=u[_],f.length>=100&&(m+=`
`+f.length+` beginbfchar
`+f.join(`
`)+`
endbfchar`,f=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(d=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),f.push("<"+o+"><"+d+">"));return f.length&&(m+=`
`+f.length+` beginbfchar
`+f.join(`
`)+`
endbfchar
`),m+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};n.events.push(["putFont",function(s){(function(o){var u=o.font,f=o.out,d=o.newObject,m=o.putStream;if(u.metadata instanceof e.API.TTFFont&&u.encoding==="Identity-H"){for(var _=u.metadata.Unicode.widths,w=u.metadata.subset.encode(u.metadata.glyIdsUsed,1),y="",M=0;M<w.length;M++)y+=String.fromCharCode(w[M]);var k=d();m({data:y,addLength1:!0,objectId:k}),f("endobj");var F=d();m({data:r(u.metadata.toUnicode),addLength1:!0,objectId:F}),f("endobj");var I=d();f("<<"),f("/Type /FontDescriptor"),f("/FontName /"+Uh(u.fontName)),f("/FontFile2 "+k+" 0 R"),f("/FontBBox "+e.API.PDFObject.convert(u.metadata.bbox)),f("/Flags "+u.metadata.flags),f("/StemV "+u.metadata.stemV),f("/ItalicAngle "+u.metadata.italicAngle),f("/Ascent "+u.metadata.ascender),f("/Descent "+u.metadata.decender),f("/CapHeight "+u.metadata.capHeight),f(">>"),f("endobj");var R=d();f("<<"),f("/Type /Font"),f("/BaseFont /"+Uh(u.fontName)),f("/FontDescriptor "+I+" 0 R"),f("/W "+e.API.PDFObject.convert(_)),f("/CIDToGIDMap /Identity"),f("/DW 1000"),f("/Subtype /CIDFontType2"),f("/CIDSystemInfo"),f("<<"),f("/Supplement 0"),f("/Registry (Adobe)"),f("/Ordering ("+u.encoding+")"),f(">>"),f(">>"),f("endobj"),u.objectNumber=d(),f("<<"),f("/Type /Font"),f("/Subtype /Type0"),f("/ToUnicode "+F+" 0 R"),f("/BaseFont /"+Uh(u.fontName)),f("/Encoding /"+u.encoding),f("/DescendantFonts ["+R+" 0 R]"),f(">>"),f("endobj"),u.isAlreadyPutted=!0}})(s)}]),n.events.push(["putFont",function(s){(function(o){var u=o.font,f=o.out,d=o.newObject,m=o.putStream;if(u.metadata instanceof e.API.TTFFont&&u.encoding==="WinAnsiEncoding"){for(var _=u.metadata.rawData,w="",y=0;y<_.length;y++)w+=String.fromCharCode(_[y]);var M=d();m({data:w,addLength1:!0,objectId:M}),f("endobj");var k=d();m({data:r(u.metadata.toUnicode),addLength1:!0,objectId:k}),f("endobj");var F=d();f("<<"),f("/Descent "+u.metadata.decender),f("/CapHeight "+u.metadata.capHeight),f("/StemV "+u.metadata.stemV),f("/Type /FontDescriptor"),f("/FontFile2 "+M+" 0 R"),f("/Flags 96"),f("/FontBBox "+e.API.PDFObject.convert(u.metadata.bbox)),f("/FontName /"+Uh(u.fontName)),f("/ItalicAngle "+u.metadata.italicAngle),f("/Ascent "+u.metadata.ascender),f(">>"),f("endobj"),u.objectNumber=d();for(var I=0;I<u.metadata.hmtx.widths.length;I++)u.metadata.hmtx.widths[I]=parseInt(u.metadata.hmtx.widths[I]*(1e3/u.metadata.head.unitsPerEm));f("<</Subtype/TrueType/Type/Font/ToUnicode "+k+" 0 R/BaseFont/"+Uh(u.fontName)+"/FontDescriptor "+F+" 0 R/Encoding/"+u.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(u.metadata.hmtx.widths)+">>"),f("endobj"),u.isAlreadyPutted=!0}})(s)}]);var i=function(s){var o,u=s.text||"",f=s.x,d=s.y,m=s.options||{},_=s.mutex||{},w=_.pdfEscape,y=_.activeFontKey,M=_.fonts,k=y,F="",I=0,R="",K=M[k].encoding;if(M[k].encoding!=="Identity-H")return{text:u,x:f,y:d,options:m,mutex:_};for(R=u,k=y,Array.isArray(u)&&(R=u[0]),I=0;I<R.length;I+=1)M[k].metadata.hasOwnProperty("cmap")&&(o=M[k].metadata.cmap.unicode.codeMap[R[I].charCodeAt(0)]),o||R[I].charCodeAt(0)<256&&M[k].metadata.hasOwnProperty("Unicode")?F+=R[I]:F+="";var ee="";return parseInt(k.slice(1))<14||K==="WinAnsiEncoding"?ee=w(F,k).split("").map(function(he){return he.charCodeAt(0).toString(16)}).join(""):K==="Identity-H"&&(ee=t(F,M[k])),_.isHex=!0,{text:ee,x:f,y:d,options:m,mutex:_}};n.events.push(["postProcessText",function(s){var o=s.text||"",u=[],f={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var d=0;for(d=0;d<o.length;d+=1)Array.isArray(o[d])&&o[d].length===3?u.push([i(Object.assign({},f,{text:o[d][0]})).text,o[d][1],o[d][2]]):u.push(i(Object.assign({},f,{text:o[d]})).text);s.text=u}else s.text=i(Object.assign({},f,{text:o})).text}])}(kr),function(e){var n=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(t){return n.call(this),this.internal.vFS[t]!==void 0},e.addFileToVFS=function(t,r){return n.call(this),this.internal.vFS[t]=r,this},e.getFileFromVFS=function(t){return n.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}}(kr.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(r){var i,s,o,u,f,d,m,_=n,w=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],y=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],M={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},k={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},F=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],I=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),R=!1,K=0;this.__bidiEngine__={};var ee=function(T){var D=T.charCodeAt(),B=D>>8,$=k[B];return $!==void 0?_[256*$+(255&D)]:B===252||B===253?"AL":I.test(B)?"L":B===8?"R":"N"},he=function(T){for(var D,B=0;B<T.length;B++){if((D=ee(T.charAt(B)))==="L")return!1;if(D==="R")return!0}return!1},fe=function(T,D,B,$){var W,G,oe,ie,we=D[$];switch(we){case"L":case"R":R=!1;break;case"N":case"AN":break;case"EN":R&&(we="AN");break;case"AL":R=!0,we="R";break;case"WS":we="N";break;case"CS":$<1||$+1>=D.length||(W=B[$-1])!=="EN"&&W!=="AN"||(G=D[$+1])!=="EN"&&G!=="AN"?we="N":R&&(G="AN"),we=G===W?G:"N";break;case"ES":we=(W=$>0?B[$-1]:"B")==="EN"&&$+1<D.length&&D[$+1]==="EN"?"EN":"N";break;case"ET":if($>0&&B[$-1]==="EN"){we="EN";break}if(R){we="N";break}for(oe=$+1,ie=D.length;oe<ie&&D[oe]==="ET";)oe++;we=oe<ie&&D[oe]==="EN"?"EN":"N";break;case"NSM":if(o&&!u){for(ie=D.length,oe=$+1;oe<ie&&D[oe]==="NSM";)oe++;if(oe<ie){var Ce=T[$],Te=Ce>=1425&&Ce<=2303||Ce===64286;if(W=D[oe],Te&&(W==="R"||W==="AL")){we="R";break}}}we=$<1||(W=D[$-1])==="B"?"N":B[$-1];break;case"B":R=!1,i=!0,we=K;break;case"S":s=!0,we="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":R=!1;break;case"BN":we="N"}return we},ve=function(T,D,B){var $=T.split("");return B&&z($,B,{hiLevel:K}),$.reverse(),D&&D.reverse(),$.join("")},z=function(T,D,B){var $,W,G,oe,ie,we=-1,Ce=T.length,Te=0,Y=[],H=K?y:w,Q=[];for(R=!1,i=!1,s=!1,W=0;W<Ce;W++)Q[W]=ee(T[W]);for(G=0;G<Ce;G++){if(ie=Te,Y[G]=fe(T,Q,Y,G),$=240&(Te=H[ie][M[Y[G]]]),Te&=15,D[G]=oe=H[Te][5],$>0)if($===16){for(W=we;W<G;W++)D[W]=1;we=-1}else we=-1;if(H[Te][6])we===-1&&(we=G);else if(we>-1){for(W=we;W<G;W++)D[W]=oe;we=-1}Q[G]==="B"&&(D[G]=0),B.hiLevel|=oe}s&&function(ue,le,pe){for(var Z=0;Z<pe;Z++)if(ue[Z]==="S"){le[Z]=K;for(var N=Z-1;N>=0&&ue[N]==="WS";N--)le[N]=K}}(Q,D,Ce)},U=function(T,D,B,$,W){if(!(W.hiLevel<T)){if(T===1&&K===1&&!i)return D.reverse(),void(B&&B.reverse());for(var G,oe,ie,we,Ce=D.length,Te=0;Te<Ce;){if($[Te]>=T){for(ie=Te+1;ie<Ce&&$[ie]>=T;)ie++;for(we=Te,oe=ie-1;we<oe;we++,oe--)G=D[we],D[we]=D[oe],D[oe]=G,B&&(G=B[we],B[we]=B[oe],B[oe]=G);Te=ie}Te++}}},J=function(T,D,B){var $=T.split(""),W={hiLevel:K};return B||(B=[]),z($,B,W),function(G,oe,ie){if(ie.hiLevel!==0&&m)for(var we,Ce=0;Ce<G.length;Ce++)oe[Ce]===1&&(we=F.indexOf(G[Ce]))>=0&&(G[Ce]=F[we+1])}($,B,W),U(2,$,D,B,W),U(1,$,D,B,W),$.join("")};return this.__bidiEngine__.doBidiReorder=function(T,D,B){if(function(W,G){if(G)for(var oe=0;oe<W.length;oe++)G[oe]=oe;u===void 0&&(u=he(W)),d===void 0&&(d=he(W))}(T,D),o||!f||d)if(o&&f&&u^d)K=u?1:0,T=ve(T,D,B);else if(!o&&f&&d)K=u?1:0,T=J(T,D,B),T=ve(T,D);else if(!o||u||f||d){if(o&&!f&&u^d)T=ve(T,D),u?(K=0,T=J(T,D,B)):(K=1,T=J(T,D,B),T=ve(T,D));else if(o&&u&&!f&&d)K=1,T=J(T,D,B),T=ve(T,D);else if(!o&&!f&&u^d){var $=m;u?(K=1,T=J(T,D,B),K=0,m=!1,T=J(T,D,B),m=$):(K=0,T=J(T,D,B),T=ve(T,D),K=1,m=!1,T=J(T,D,B),m=$,T=ve(T,D))}}else K=0,T=J(T,D,B);else K=u?1:0,T=J(T,D,B);return T},this.__bidiEngine__.setOptions=function(T){T&&(o=T.isInputVisual,f=T.isOutputVisual,u=T.isInputRtl,d=T.isOutputRtl,m=T.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var n=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(r){var i=r.text,s=(r.x,r.y,r.options||{}),o=(r.mutex,s.lang,[]);if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,t.setOptions(s),Object.prototype.toString.call(i)==="[object Array]"){var u=0;for(o=[],u=0;u<i.length;u+=1)Object.prototype.toString.call(i[u])==="[object Array]"?o.push([t.doBidiReorder(i[u][0]),i[u][1],i[u][2]]):o.push([t.doBidiReorder(i[u])]);r.text=o}else r.text=t.doBidiReorder(i);t.setOptions({isInputVisual:!0})}])}(kr),kr.API.TTFFont=function(){function e(n){var t;if(this.rawData=n,t=this.contents=new Mf(n),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new KF(this),this.registerTTF()}return e.open=function(n){return new e(n)},e.prototype.parse=function(){return this.directory=new OF(this.contents),this.head=new RF(this),this.name=new UF(this),this.cmap=new Dx(this),this.toUnicode={},this.hhea=new FF(this),this.maxp=new VF(this),this.hmtx=new GF(this),this.post=new zF(this),this.os2=new jF(this),this.loca=new ZF(this),this.glyf=new HF(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var n,t,r,i,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,u,f,d;for(d=[],o=0,u=(f=this.bbox).length;o<u;o++)n=f[o],d.push(Math.round(n*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(r=255&(i=this.post.italic_angle),32768&(t=i>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(n){var t;return((t=this.cmap.unicode)!=null?t.codeMap[n]:void 0)||0},e.prototype.widthOfGlyph=function(n){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(n).advance*t},e.prototype.widthOfString=function(n,t,r){var i,s,o,u;for(o=0,s=0,u=(n=""+n).length;0<=u?s<u:s>u;s=0<=u?++s:--s)i=n.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(i))+r*(1e3/t)||0;return o*(t/1e3)},e.prototype.lineHeight=function(n,t){var r;return t==null&&(t=!1),r=t?this.lineGap:0,(this.ascender+r-this.decender)/1e3*n},e}();var Ku,Mf=function(){function e(n){this.data=n??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(n){return this.data[this.pos++]=n},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(n){return this.writeByte(n>>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt32=function(){var n;return(n=this.readUInt32())>=2147483648?n-4294967296:n},e.prototype.writeInt32=function(n){return n<0&&(n+=4294967296),this.writeUInt32(n)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(n){return this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt16=function(){var n;return(n=this.readUInt16())>=32768?n-65536:n},e.prototype.writeInt16=function(n){return n<0&&(n+=65536),this.writeUInt16(n)},e.prototype.readString=function(n){var t,r;for(r=[],t=0;0<=n?t<n:t>n;t=0<=n?++t:--t)r[t]=String.fromCharCode(this.readByte());return r.join("")},e.prototype.writeString=function(n){var t,r,i;for(i=[],t=0,r=n.length;0<=r?t<r:t>r;t=0<=r?++t:--t)i.push(this.writeByte(n.charCodeAt(t)));return i},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(n){return this.writeInt16(n)},e.prototype.readLongLong=function(){var n,t,r,i,s,o,u,f;return n=this.readByte(),t=this.readByte(),r=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),u=this.readByte(),f=this.readByte(),128&n?-1*(72057594037927940*(255^n)+281474976710656*(255^t)+1099511627776*(255^r)+4294967296*(255^i)+16777216*(255^s)+65536*(255^o)+256*(255^u)+(255^f)+1):72057594037927940*n+281474976710656*t+1099511627776*r+4294967296*i+16777216*s+65536*o+256*u+f},e.prototype.writeLongLong=function(n){var t,r;return t=Math.floor(n/4294967296),r=4294967295&n,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(n){return this.writeInt32(n)},e.prototype.read=function(n){var t,r;for(t=[],r=0;0<=n?r<n:r>n;r=0<=n?++r:--r)t.push(this.readByte());return t},e.prototype.write=function(n){var t,r,i,s;for(s=[],r=0,i=n.length;r<i;r++)t=n[r],s.push(this.writeByte(t));return s},e}(),OF=function(){var e;function n(t){var r,i,s;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},i=0,s=this.tableCount;0<=s?i<s:i>s;i=0<=s?++i:--i)r={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[r.tag]=r}return n.prototype.encode=function(t){var r,i,s,o,u,f,d,m,_,w,y,M,k;for(k in y=Object.keys(t).length,f=Math.log(2),_=16*Math.floor(Math.log(y)/f),o=Math.floor(_/f),m=16*y-_,(i=new Mf).writeInt(this.scalarType),i.writeShort(y),i.writeShort(_),i.writeShort(o),i.writeShort(m),s=16*y,d=i.pos+s,u=null,M=[],t)for(w=t[k],i.writeString(k),i.writeInt(e(w)),i.writeInt(d),i.writeInt(w.length),M=M.concat(w),k==="head"&&(u=d),d+=w.length;d%4;)M.push(0),d++;return i.write(M),r=2981146554-e(i.data),i.pos=u+8,i.writeUInt32(r),i.data},e=function(t){var r,i,s,o;for(t=Ix.call(t);t.length%4;)t.push(0);for(s=new Mf(t),i=0,r=0,o=t.length;r<o;r=r+=4)i+=s.readUInt32();return 4294967295&i},n}(),BF={}.hasOwnProperty,_c=function(e,n){for(var t in n)BF.call(n,t)&&(e[t]=n[t]);function r(){this.constructor=e}return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e};Ku=function(){function e(n){var t;this.file=n,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var RF=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return _c(n,Ku),n.prototype.tag="head",n.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},n.prototype.encode=function(t){var r;return(r=new Mf).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},n}(),$b=function(){function e(n,t){var r,i,s,o,u,f,d,m,_,w,y,M,k,F,I,R,K;switch(this.platformID=n.readUInt16(),this.encodingID=n.readShort(),this.offset=t+n.readInt(),_=n.pos,n.pos=this.offset,this.format=n.readUInt16(),this.length=n.readUInt16(),this.language=n.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(f=0;f<256;++f)this.codeMap[f]=n.readByte();break;case 4:for(y=n.readUInt16(),w=y/2,n.pos+=6,s=function(){var ee,he;for(he=[],f=ee=0;0<=w?ee<w:ee>w;f=0<=w?++ee:--ee)he.push(n.readUInt16());return he}(),n.pos+=2,k=function(){var ee,he;for(he=[],f=ee=0;0<=w?ee<w:ee>w;f=0<=w?++ee:--ee)he.push(n.readUInt16());return he}(),d=function(){var ee,he;for(he=[],f=ee=0;0<=w?ee<w:ee>w;f=0<=w?++ee:--ee)he.push(n.readUInt16());return he}(),m=function(){var ee,he;for(he=[],f=ee=0;0<=w?ee<w:ee>w;f=0<=w?++ee:--ee)he.push(n.readUInt16());return he}(),i=(this.length-n.pos+this.offset)/2,u=function(){var ee,he;for(he=[],f=ee=0;0<=i?ee<i:ee>i;f=0<=i?++ee:--ee)he.push(n.readUInt16());return he}(),f=I=0,K=s.length;I<K;f=++I)for(F=s[f],r=R=M=k[f];M<=F?R<=F:R>=F;r=M<=F?++R:--R)m[f]===0?o=r+d[f]:(o=u[m[f]/2+(r-M)-(w-f)]||0)!==0&&(o+=d[f]),this.codeMap[r]=65535&o}n.pos=_}return e.encode=function(n,t){var r,i,s,o,u,f,d,m,_,w,y,M,k,F,I,R,K,ee,he,fe,ve,z,U,J,T,D,B,$,W,G,oe,ie,we,Ce,Te,Y,H,Q,ue,le,pe,Z,N,ke,Me,Ue;switch($=new Mf,o=Object.keys(n).sort(function(ce,ne){return ce-ne}),t){case"macroman":for(k=0,F=function(){var ce=[];for(M=0;M<256;++M)ce.push(0);return ce}(),R={0:0},s={},W=0,we=o.length;W<we;W++)R[N=n[i=o[W]]]==null&&(R[N]=++k),s[i]={old:n[i],new:R[n[i]]},F[i]=R[n[i]];return $.writeUInt16(1),$.writeUInt16(0),$.writeUInt32(12),$.writeUInt16(0),$.writeUInt16(262),$.writeUInt16(0),$.write(F),{charMap:s,subtable:$.data,maxGlyphID:k+1};case"unicode":for(D=[],_=[],K=0,R={},r={},I=d=null,G=0,Ce=o.length;G<Ce;G++)R[he=n[i=o[G]]]==null&&(R[he]=++K),r[i]={old:he,new:R[he]},u=R[he]-i,I!=null&&u===d||(I&&_.push(I),D.push(i),d=u),I=i;for(I&&_.push(I),_.push(65535),D.push(65535),J=2*(U=D.length),z=2*Math.pow(Math.log(U)/Math.LN2,2),w=Math.log(z/2)/Math.LN2,ve=2*U-z,f=[],fe=[],y=[],M=oe=0,Te=D.length;oe<Te;M=++oe){if(T=D[M],m=_[M],T===65535){f.push(0),fe.push(0);break}if(T-(B=r[T].new)>=32768)for(f.push(0),fe.push(2*(y.length+U-M)),i=ie=T;T<=m?ie<=m:ie>=m;i=T<=m?++ie:--ie)y.push(r[i].new);else f.push(B-T),fe.push(0)}for($.writeUInt16(3),$.writeUInt16(1),$.writeUInt32(12),$.writeUInt16(4),$.writeUInt16(16+8*U+2*y.length),$.writeUInt16(0),$.writeUInt16(J),$.writeUInt16(z),$.writeUInt16(w),$.writeUInt16(ve),pe=0,Y=_.length;pe<Y;pe++)i=_[pe],$.writeUInt16(i);for($.writeUInt16(0),Z=0,H=D.length;Z<H;Z++)i=D[Z],$.writeUInt16(i);for(ke=0,Q=f.length;ke<Q;ke++)u=f[ke],$.writeUInt16(u);for(Me=0,ue=fe.length;Me<ue;Me++)ee=fe[Me],$.writeUInt16(ee);for(Ue=0,le=y.length;Ue<le;Ue++)k=y[Ue],$.writeUInt16(k);return{charMap:r,subtable:$.data,maxGlyphID:K+1}}},e}(),Dx=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return _c(n,Ku),n.prototype.tag="cmap",n.prototype.parse=function(t){var r,i,s;for(t.pos=this.offset,this.version=t.readUInt16(),s=t.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=s?i<s:i>s;i=0<=s?++i:--i)r=new $b(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},n.encode=function(t,r){var i,s;return r==null&&(r="macroman"),i=$b.encode(t,r),(s=new Mf).writeUInt16(0),s.writeUInt16(1),i.table=s.data.concat(i.subtable),i},n}(),FF=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return _c(n,Ku),n.prototype.tag="hhea",n.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},n}(),jF=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return _c(n,Ku),n.prototype.tag="OS/2",n.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,i;for(i=[],r=0;r<10;++r)i.push(t.readByte());return i}(),this.charRange=function(){var r,i;for(i=[],r=0;r<4;++r)i.push(t.readInt());return i}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,i;for(i=[],r=0;r<2;r=++r)i.push(t.readInt());return i}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},n}(),zF=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return _c(n,Ku),n.prototype.tag="post",n.prototype.parse=function(t){var r,i,s;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:break;case 131072:var o;for(i=t.readUInt16(),this.glyphNameIndex=[],o=0;0<=i?o<i:o>i;o=0<=i?++o:--o)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],s=[];t.pos<this.offset+this.length;)r=t.readByte(),s.push(this.names.push(t.readString(r)));return s;case 151552:return i=t.readUInt16(),this.offsets=t.read(i);case 196608:break;case 262144:return this.map=(function(){var u,f,d;for(d=[],o=u=0,f=this.file.maxp.numGlyphs;0<=f?u<f:u>f;o=0<=f?++u:--u)d.push(t.readUInt32());return d}).call(this)}},n}(),$F=function(e,n){this.raw=e,this.length=e.length,this.platformID=n.platformID,this.encodingID=n.encodingID,this.languageID=n.languageID},UF=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return _c(n,Ku),n.prototype.tag="name",n.prototype.parse=function(t){var r,i,s,o,u,f,d,m,_,w,y;for(t.pos=this.offset,t.readShort(),r=t.readShort(),f=t.readShort(),i=[],o=0;0<=r?o<r:o>r;o=0<=r?++o:--o)i.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+f+t.readShort()});for(d={},o=_=0,w=i.length;_<w;o=++_)s=i[o],t.pos=s.offset,m=t.readString(s.length),u=new $F(m,s),d[y=s.nameID]==null&&(d[y]=[]),d[s.nameID].push(u);this.strings=d,this.copyright=d[0],this.fontFamily=d[1],this.fontSubfamily=d[2],this.uniqueSubfamily=d[3],this.fontName=d[4],this.version=d[5];try{this.postscriptName=d[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=d[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=d[7],this.manufacturer=d[8],this.designer=d[9],this.description=d[10],this.vendorUrl=d[11],this.designerUrl=d[12],this.license=d[13],this.licenseUrl=d[14],this.preferredFamily=d[15],this.preferredSubfamily=d[17],this.compatibleFull=d[18],this.sampleText=d[19]},n}(),VF=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return _c(n,Ku),n.prototype.tag="maxp",n.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},n}(),GF=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return _c(n,Ku),n.prototype.tag="hmtx",n.prototype.parse=function(t){var r,i,s,o,u,f,d;for(t.pos=this.offset,this.metrics=[],r=0,f=this.file.hhea.numberOfMetrics;0<=f?r<f:r>f;r=0<=f?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var m,_;for(_=[],r=m=0;0<=s?m<s:m>s;r=0<=s?++m:--m)_.push(t.readInt16());return _}(),this.widths=(function(){var m,_,w,y;for(y=[],m=0,_=(w=this.metrics).length;m<_;m++)o=w[m],y.push(o.advance);return y}).call(this),i=this.widths[this.widths.length-1],d=[],r=u=0;0<=s?u<s:u>s;r=0<=s?++u:--u)d.push(this.widths.push(i));return d},n.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},n}(),Ix=[].slice,HF=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return _c(n,Ku),n.prototype.tag="glyf",n.prototype.parse=function(){return this.cache={}},n.prototype.glyphFor=function(t){var r,i,s,o,u,f,d,m,_,w;return t in this.cache?this.cache[t]:(o=this.file.loca,r=this.file.contents,i=o.indexOf(t),(s=o.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+i,u=(f=new Mf(r.read(s))).readShort(),m=f.readShort(),w=f.readShort(),d=f.readShort(),_=f.readShort(),this.cache[t]=u===-1?new WF(f,m,w,d,_):new qF(f,u,m,w,d,_),this.cache[t]))},n.prototype.encode=function(t,r,i){var s,o,u,f,d;for(u=[],o=[],f=0,d=r.length;f<d;f++)s=t[r[f]],o.push(u.length),s&&(u=u.concat(s.encode(i)));return o.push(u.length),{table:u,offsets:o}},n}(),qF=function(){function e(n,t,r,i,s,o){this.raw=n,this.numberOfContours=t,this.xMin=r,this.yMin=i,this.xMax=s,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),WF=function(){function e(n,t,r,i,s){var o,u;for(this.raw=n,this.xMin=t,this.yMin=r,this.xMax=i,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;u=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&u;)o.pos+=1&u?4:2,128&u?o.pos+=8:64&u?o.pos+=4:8&u&&(o.pos+=2)}return e.prototype.encode=function(){var n,t,r;for(t=new Mf(Ix.call(this.raw.data)),n=0,r=this.glyphIDs.length;n<r;++n)t.pos=this.glyphOffsets[n];return t.data},e}(),ZF=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return _c(n,Ku),n.prototype.tag="loca",n.prototype.parse=function(t){var r,i;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var s,o;for(o=[],i=0,s=this.length;i<s;i+=2)o.push(2*t.readUInt16());return o}).call(this):(function(){var s,o;for(o=[],i=0,s=this.length;i<s;i+=4)o.push(t.readUInt32());return o}).call(this)},n.prototype.indexOf=function(t){return this.offsets[t]},n.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},n.prototype.encode=function(t,r){for(var i=new Uint32Array(this.offsets.length),s=0,o=0,u=0;u<i.length;++u)if(i[u]=s,o<r.length&&r[o]==u){++o,i[u]=s;var f=this.offsets[u],d=this.offsets[u+1]-f;d>0&&(s+=d)}for(var m=new Array(4*i.length),_=0;_<i.length;++_)m[4*_+3]=255&i[_],m[4*_+2]=(65280&i[_])>>8,m[4*_+1]=(16711680&i[_])>>16,m[4*_]=(4278190080&i[_])>>24;return m},n}(),KF=function(){function e(n){this.font=n,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var n,t,r,i,s;for(t in i=this.font.cmap.tables[0].codeMap,n={},s=this.subset)r=s[t],n[t]=i[r];return n},e.prototype.glyphsFor=function(n){var t,r,i,s,o,u,f;for(i={},o=0,u=n.length;o<u;o++)i[s=n[o]]=this.font.glyf.glyphFor(s);for(s in t=[],i)(r=i[s])!=null&&r.compound&&t.push.apply(t,r.glyphIDs);if(t.length>0)for(s in f=this.glyphsFor(t))r=f[s],i[s]=r;return i},e.prototype.encode=function(n,t){var r,i,s,o,u,f,d,m,_,w,y,M,k,F,I;for(i in r=Dx.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(n),y={0:0},I=r.charMap)y[(f=I[i]).old]=f.new;for(M in w=r.maxGlyphID,o)M in y||(y[M]=w++);return m=function(R){var K,ee;for(K in ee={},R)ee[R[K]]=K;return ee}(y),_=Object.keys(m).sort(function(R,K){return R-K}),k=function(){var R,K,ee;for(ee=[],R=0,K=_.length;R<K;R++)u=_[R],ee.push(m[u]);return ee}(),s=this.font.glyf.encode(o,k,y),d=this.font.loca.encode(s.offsets,k),F={cmap:this.font.cmap.raw(),glyf:s.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(F["OS/2"]=this.font.os2.raw()),this.font.directory.encode(F)},e}();kr.API.PDFObject=function(){var e;function n(){}return e=function(t,r){return(Array(r+1).join("0")+t).slice(-r)},n.convert=function(t){var r,i,s,o;if(Array.isArray(t))return"["+function(){var u,f,d;for(d=[],u=0,f=t.length;u<f;u++)r=t[u],d.push(n.convert(r));return d}().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+e(t.getUTCFullYear(),4)+e(t.getUTCMonth(),2)+e(t.getUTCDate(),2)+e(t.getUTCHours(),2)+e(t.getUTCMinutes(),2)+e(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(i in s=["<<"],t)o=t[i],s.push("/"+i+" "+n.convert(o));return s.push(">>"),s.join(`
`)}return""+t},n}();const YF={class:"h-full flex"},JF={class:"flex-1 relative"},XF={key:0,class:"absolute inset-0 bg-black/30 backdrop-blur-sm z-[2000] flex items-center justify-center"},QF={key:1,class:"absolute inset-0 flex items-center justify-center bg-gray-50 z-[3000]"},e9={class:"text-center max-w-lg mx-auto p-8"},t9={class:"space-y-4"},n9={class:"map-parent"},r9={key:0,class:"fixed left-0 right-0 z-[1500]",style:{top:"var(--header-height)"}},i9={class:"map-content flex flex-col md:flex-row relative"},o9={class:"flex-1 relative"},s9={key:1,class:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-75 z-50"},a9={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center z-[9999] p-4 overflow-y-auto"},l9={class:"bg-white rounded-lg p-6 max-w-2xl w-full my-8 relative"},u9={class:"flex justify-between items-center mb-4 sticky top-0 bg-white pb-4 border-b"},c9={class:"overflow-y-auto max-h-[calc(100vh-12rem)]"},f9={key:0,class:"space-y-4"},h9={key:0,class:"space-y-2"},d9={class:"grid grid-cols-1 gap-2"},p9=["onClick"],g9={class:"font-medium text-gray-900"},m9={key:1,class:"space-y-2"},v9={class:"flex items-center mb-4"},y9={class:"text-sm text-gray-600"},_9={class:"grid grid-cols-1 gap-2"},b9=["onClick"],w9={class:"font-medium text-gray-900"},x9={key:2,class:"space-y-2"},L9={class:"flex items-center mb-4"},S9={class:"text-sm text-gray-600"},E9={class:"grid grid-cols-1 gap-2"},C9={key:0,class:"text-center py-4"},P9=["onClick"],M9={class:"font-medium text-gray-900"},A9={key:3,class:"space-y-2"},k9={class:"flex items-center mb-4"},T9={class:"text-sm text-gray-600"},N9={class:"grid grid-cols-1 gap-2"},D9=["onClick"],I9={class:"font-medium text-gray-900"},O9={class:"text-sm text-gray-500"},B9={class:"text-xs text-gray-400 mt-1"},R9={key:1,class:"space-y-4"},F9={key:0,class:"space-y-2"},j9={class:"grid grid-cols-1 gap-2"},z9={key:0,class:"text-center py-8"},$9=["onClick"],U9={class:"font-medium text-gray-900"},V9={key:1,class:"space-y-2"},G9={class:"flex items-center mb-4"},H9={class:"text-sm text-gray-600"},q9={class:"grid grid-cols-1 gap-2"},W9=["onClick"],Z9={class:"font-medium text-gray-900"},K9={class:"text-sm text-gray-500"},Y9={class:"text-xs text-gray-400 mt-1"},J9={key:2,class:"space-y-4"},X9={key:3,class:"space-y-4"},Q9={key:0,class:"text-center py-8"},ej={key:1,class:"space-y-2"},tj=["onClick"],nj={class:"font-medium text-gray-900"},rj={class:"text-sm text-gray-500"},ij={class:"text-xs text-gray-400 mt-1"},Ub=ds({__name:"MapView",emits:["shape-selected"],setup(e,{emit:n}){const t=c8(),r=zt(null),i=zt(!1),s=py(),o=cd(),u=lh(),f=vu(),d=zt([]),m=zt({planId:t.query.planId?parseInt(t.query.planId):null,noteId:t.query.noteId?parseInt(t.query.noteId):null,lat:t.query.lat?parseFloat(t.query.lat):null,lng:t.query.lng?parseFloat(t.query.lng):null,tool:t.query.tool||null}),{currentTool:_,selectedShape:w,map:y,initMap:M,setDrawingTool:k,updateShapeStyle:F,updateShapeProperties:I,featureGroup:R,adjustView:K,clearActiveControlPoints:ee,calculateConnectedCoverageArea:he}=AR(),{initMap:fe,changeBaseMap:ve}=kR(),z=zt(!1),U=zt(!1),J=zt(!1),T=zt(null),D=zt(null),B=zt(!1),$=zt(null),W=ma(),G=zt([]),oe=zt([]),ie=zt([]),we=zt(null),Ce=zt(null),Te=zt(null),Y=zt(!1),H=zt(!1),Q=zt(!1),ue=zt(null),le=sr(()=>{var ft,Qe;return console.log("[MapView][filteredClients] Computing with:",{userType:(ft=W.user)==null?void 0:ft.user_type,selectedSalarie:we.value,salarieVisiteurs:oe.value,visiteurCount:((Qe=oe.value)==null?void 0:Qe.length)||0}),W.isSalarie||we.value?oe.value:[]}),pe=sr(()=>{var bn,Ht,Hn;if(!w.value)return null;console.log("[MapView][selectedShape] Initial layer state:",{layer:w.value,hasName:"name"in w.value,name:w.value.name,hasProperties:"properties"in w.value,propertiesName:(bn=w.value.properties)==null?void 0:bn.name,allLayerKeys:Object.keys(w.value),allPropertiesKeys:w.value.properties?Object.keys(w.value.properties):[],_leaflet_id:w.value._leaflet_id,_dbId:w.value._dbId,descriptor:Object.getOwnPropertyDescriptor(w.value,"name")});const ft=w.value.properties||{};let Qe="unknown";ft.type?Qe=ft.type:w.value instanceof jt.Circle?Qe="Circle":w.value instanceof pa||w.value instanceof jt.Rectangle?Qe="Rectangle":w.value instanceof vf||w.value instanceof jt.Polygon?Qe="Polygon":w.value instanceof Cf?Qe="ElevationLine":(w.value instanceof Bs||w.value instanceof jt.Polyline&&!(w.value instanceof jt.Polygon))&&(Qe="Line"),console.log(`[MapView][selectedShape] Type de forme détecté: ${Qe}`),ft.type||(w.value.properties||(w.value.properties={}),w.value.properties.type=Qe);let $t;if(ft.style&&ft.style.name)$t=ft.style.name,console.log("[MapView][selectedShape] Using name from style:",$t);else if(ft.name)$t=ft.name,console.log("[MapView][selectedShape] Using name from properties:",$t);else if(w.value.name)$t=w.value.name,console.log("[MapView][selectedShape] Using name from layer:",$t);else{const St=Object.getOwnPropertyDescriptor(w.value,"name");St&&St.value&&($t=St.value,console.log("[MapView][selectedShape] Found name in non-enumerable layer property:",$t));const mt=["_name","displayName","title"];for(const wn of mt)if(w.value[wn]){$t=w.value[wn],console.log(`[MapView][selectedShape] Found name in ${wn}:`,$t);break}}$t&&(console.log(`[MapView][selectedShape] Ensuring name "${$t}" is set everywhere`),w.value.properties||(w.value.properties={}),w.value.properties.name=$t,w.value.properties.style||(w.value.properties.style={}),w.value.properties.style.name=$t,w.value.name=$t,typeof w.value.setName=="function"&&(w.value.setName($t),console.log(`[MapView][selectedShape] Used setName method to set name "${$t}"`))),w.value.properties.category||(w.value.properties.category="forages"),w.value.properties.accessLevel||(w.value.properties.accessLevel="visitor"),console.log("[MapView][selectedShape] Preparing properties for DrawingTools:",{type:Qe,name:ft.name,foundName:$t,hasNameProperty:"name"in ft,allPropertiesKeys:Object.keys(ft),layerId:w.value._leaflet_id,rawProperties:ft,layerName:w.value.name,layerPropertiesName:(Ht=w.value.properties)==null?void 0:Ht.name});const xn={...ft,type:Qe,name:$t||w.value.name||ft.name||void 0,category:w.value.properties.category||"forages",accessLevel:w.value.properties.accessLevel||"visitor"},vn={type:Qe,properties:xn,layer:w.value,options:w.value.options||{}};return console.log("[MapView][selectedShape] Final shape object for DrawingTools:",{type:vn.type,hasName:"name"in vn.properties,name:vn.properties.name,layerName:vn.layer.name,layerPropertiesName:(Hn=vn.layer.properties)==null?void 0:Hn.name}),vn});function Z(ft){const Qe=ft.getCenter(),$t=ft.getZoom(),xn={lat:Qe.lat,lng:Qe.lng,zoom:$t};document.cookie=`mapState=${JSON.stringify(xn)};max-age=2592000;path=/`}function N(){const Qe=document.cookie.split(";").find($t=>$t.trim().startsWith("mapState="));if(Qe)try{return JSON.parse(Qe.split("=")[1])}catch($t){return console.error("Erreur lors de la lecture du cookie de position:",$t),null}return null}Cs(async()=>{var ft,Qe;console.log("[MapView][onMounted] Initialisation du composant MapView"),console.log("[MapView][onMounted] État initial des filtres dans le store:",JSON.stringify({accessLevels:{...o.filters.accessLevels},categories:{...o.filters.categories},shapeTypes:{...o.filters.shapeTypes}},null,2));try{if(await s.fetchPlans(),(W.isAdmin||W.isEntreprise)&&await Qt(),W.isEntreprise){Y.value=!0;try{const St=await Gn.get("/users/",{params:{role:"SALARIE",entreprise:(ft=W.user)==null?void 0:ft.id}});G.value=St.data}catch(St){console.error("Error loading salaries:",St),G.value=[]}finally{Y.value=!1}}if(W.isSalarie){H.value=!0;try{const St=await W.fetchSalarieVisiteurs(((Qe=W.user)==null?void 0:Qe.id)||0);oe.value=Array.isArray(St)?St:[St]}catch(St){console.error("Error loading clients:",St)}finally{H.value=!1}}const $t=N(),xn=$t?[$t.lat,$t.lng]:[46.603354,1.888334],vn=($t==null?void 0:$t.zoom)??6;if(r.value&&!y.value){const St=M(r.value,xn,vn);St.pm.setLang("fr"),St.pm.addControls({rotateMode:!1}),fe(St),St.on("moveend",()=>{Z(St)}),window.addEventListener("map-set-location",mt=>{if(St&&mt.detail){const{lat:wn,lng:Qr,zoom:Tt}=mt.detail;St.flyTo([wn,Qr],Tt,{duration:1.5,easeLinearity:.25})}}),R.value&&(R.value.on("layeradd",mt=>{const wn=mt.layer;wn&&wn._leaflet_id&&d.value.findIndex(Tt=>Tt.layer&&Tt.layer._leaflet_id===wn._leaflet_id)===-1&&(console.log(`[MapView][featureGroup.layeradd] Ajout de la couche ${wn._leaflet_id} à shapes.value`),d.value.push({layer:wn,id:wn._dbId||wn._leaflet_id}))}),R.value.on("layerremove",mt=>{const wn=mt.layer;wn&&wn._leaflet_id&&console.log(`[MapView][featureGroup.layerremove] Couche ${wn._leaflet_id} supprimée du featureGroup mais conservée dans shapes.value`)}))}if(m.value.planId)try{console.log("[MapView][onMounted] Chargement du plan depuis les paramètres d'URL:",m.value.planId),await ne(m.value.planId);const St=document.querySelector(".map-parent");St instanceof HTMLElement&&(St.style.display="block"),m.value.lat&&m.value.lng&&y.value&&(console.log("[MapView][onMounted] Centrage de la carte sur les coordonnées:",m.value.lat,m.value.lng),y.value.flyTo([m.value.lat,m.value.lng],16)),m.value.noteId&&R.value&&(console.log("[MapView][onMounted] Recherche de la note:",m.value.noteId),setTimeout(()=>{var wn;const mt=((wn=R.value)==null?void 0:wn.getLayers())||[];for(const Qr of mt)if(Qr._dbId===m.value.noteId||Qr.id===m.value.noteId){console.log("[MapView][onMounted] Note trouvée:",Qr),typeof Qr.fire=="function"&&Qr.fire("click");break}},1e3)),m.value.tool&&(console.log("[MapView][onMounted] Activation de l'outil:",m.value.tool),k(m.value.tool))}catch(St){console.error("[MapView][onMounted] Erreur chargement plan depuis URL:",St),bn()}else bn();async function bn(){const St=localStorage.getItem("lastPlanId");if(St)try{console.log("[MapView][loadLastPlan] Chargement du dernier plan:",St),await ne(parseInt(St));const mt=document.querySelector(".map-parent");mt instanceof HTMLElement&&(mt.style.display="block")}catch(mt){console.error("[MapView][loadLastPlan] Erreur chargement dernier plan:",mt),T.value=null,s.clearCurrentPlan(),o.clearCurrentPlan(),Ue(),localStorage.removeItem("lastPlanId")}else console.log("[MapView][loadLastPlan] Aucun dernier plan à charger"),T.value=null,s.clearCurrentPlan(),o.clearCurrentPlan(),Ue()}window.addEventListener("shape:created",St=>{const{shape:mt,type:wn,properties:Qr}=St.detail;console.log("[MapView] Nouvelle forme créée",{shape:mt,type:wn,properties:Qr}),o.addElement(mt),k("")}),window.addEventListener("geonote:savePlan",()=>{console.log("[MapView] Événement geonote:savePlan reçu - Sauvegarde automatique du plan"),ye()}),window.addEventListener("categoriesReactivated",St=>{console.log("[MapView][categoriesReactivated] Événement reçu:",St.detail),Yn()}),window.addEventListener("shapeTypesReactivated",St=>{console.log("[MapView][shapeTypesReactivated] Événement reçu:",St.detail),Yn()});const Ht=St=>{if(console.log("[MapView] Édition de note via Leaflet",St),console.log("[MapView] Type de e:",typeof St,"Contenu de e:",JSON.stringify(St)),!St||!St.note){console.error("[MapView] Erreur: e.note est undefined ou null",St);return}const mt=St.note;console.log("[MapView] Note à éditer:",mt),D.value={id:mt.id,title:mt.title||mt.name,description:mt.description,location:mt.location,columnId:mt.columnId||u.getDefaultColumn.id,accessLevel:mt.accessLevel,style:mt.style||{color:"#3B82F6",weight:2,opacity:1,fillColor:"#3B82F6",fillOpacity:.6,radius:8},order:0,createdAt:mt.createdAt||new Date().toISOString(),updatedAt:mt.updatedAt||new Date().toISOString(),comments:mt.comments||[],photos:mt.photos||[]},console.log("[MapView] editingMapNote.value après conversion:",D.value),J.value=!0,console.log("[MapView] showNoteEditModal.value:",J.value)},Hn=St=>{if(console.log("[MapView] Édition de note via événement global",St),!St.detail||!St.detail.note){console.error("[MapView] Erreur: event.detail.note est undefined ou null",St);return}const mt=St.detail.note;console.log("[MapView] Note à éditer (global):",mt);const wn=d.value.find(Tt=>Tt.layer===St.detail.source),Qr=wn?wn.id:mt.id;console.log("[MapView] ID de la note pour l'API:",Qr,"Source:",St.detail.source?"Couche Leaflet":"Autre"),D.value={id:Qr,title:mt.title||mt.name,description:mt.description,location:mt.location,columnId:mt.columnId||u.getDefaultColumn.id,accessLevel:mt.accessLevel,style:mt.style||{color:"#3B82F6",weight:2,opacity:1,fillColor:"#3B82F6",fillOpacity:.6,radius:8},order:0,createdAt:mt.createdAt||new Date().toISOString(),updatedAt:mt.updatedAt||new Date().toISOString(),comments:mt.comments||[],photos:mt.photos||[]},J.value=!0};window.addEventListener("geonote:edit",Hn),R.value&&(R.value.off("note:edit"),R.value.on("note:edit",Ht))}catch($t){console.error("Error during component mount:",$t),T.value=null,s.clearCurrentPlan(),o.clearCurrentPlan(),Ue(),localStorage.removeItem("lastPlanId")}}),oo(()=>o.hasUnsavedChanges,ft=>{console.log("[MapView][watch drawingStore.hasUnsavedChanges]",ft),ft&&T.value&&s.markUnsavedChanges()}),oo(()=>o.filters,(ft,Qe)=>{if(console.log("[MapView][watch drawingStore.filters] Changement de filtres détecté:",JSON.stringify(ft,null,2)),Qe){const $t=JSON.stringify(Qe.accessLevels)!==JSON.stringify(ft.accessLevels),xn=JSON.stringify(Qe.categories)!==JSON.stringify(ft.categories),vn=JSON.stringify(Qe.shapeTypes)!==JSON.stringify(ft.shapeTypes);console.log("[MapView][watch drawingStore.filters] Changements détectés:",{accessLevelsChanged:$t,categoriesChanged:xn,shapeTypesChanged:vn}),$t||xn||vn?(console.log("[MapView][watch drawingStore.filters] Mise à jour de l'affichage suite au changement de filtres"),Yn()):console.log("[MapView][watch drawingStore.filters] Aucun changement réel, pas de mise à jour")}else console.log("[MapView][watch drawingStore.filters] Mise à jour de l'affichage suite au changement de filtres"),Yn()},{deep:!0});const ke=ft=>{console.log("[MapView][filtersChanged] Événement reçu:",ft.detail),Yn()};Cs(()=>{window.addEventListener("filtersChanged",ke)}),mc(()=>{window.removeEventListener("filtersChanged",ke),console.log("[MapView][filtersChanged] Événement désactivé")}),oo(()=>o.getFilteredElements,(ft,Qe)=>{console.log("[MapView][watch drawingStore.getFilteredElements] Mise à jour de l'affichage, éléments filtrés:",{nouveaux:ft.length,anciens:Qe?Qe.length:"aucun",ids:ft.map($t=>$t.id)}),console.log("[MapView][watch drawingStore.getFilteredElements] Mise à jour de l'affichage suite au changement d'elements filtrés"),Yn()},{deep:!0}),oo(y,async ft=>{var Qe;console.log(`
[MapView][watch map] Nouvelle carte:`,!!ft),ft&&s.currentPlan&&!((Qe=R.value)!=null&&Qe.getLayers().length)&&(console.log("[MapView][watch map] Chargement initial des éléments du plan:",s.currentPlan.id),Ue(),await o.loadPlanElements(s.currentPlan.id))}),oo(()=>s.currentPlan,async(ft,Qe)=>{var $t,xn,vn;if((ft==null?void 0:ft.id)===(Qe==null?void 0:Qe.id)){console.log("[MapView][watch currentPlan] Plan identique, pas de rechargement nécessaire");return}console.log(`
[MapView][watch currentPlan] ====== CHANGEMENT DE PLAN ======`),console.log("[MapView][watch currentPlan] Nouveau plan:",ft==null?void 0:ft.id);try{if(ft){console.log("[MapView][watch currentPlan] Mise à jour du plan courant..."),T.value=ft;const bn=document.querySelector(".map-parent");bn instanceof HTMLElement&&(bn.style.display="block"),console.log("[MapView][watch currentPlan] Plan mis à jour avec succès")}else{console.log("[MapView][watch currentPlan] Nettoyage du plan courant..."),T.value=null,Ue();const bn=document.querySelector(".map-parent");bn instanceof HTMLElement&&(bn.style.display="none")}}catch(bn){console.error("[MapView][watch currentPlan] ERREUR:",bn),T.value=null,Ue()}console.log("[MapView][watch currentPlan] État final:",{currentPlanId:($t=T.value)==null?void 0:$t.id,storePlanId:(xn=s.currentPlan)==null?void 0:xn.id,mapVisible:y.value!==null,mapParentDisplay:(vn=document.querySelector(".map-parent"))==null?void 0:vn.getAttribute("style")}),console.log(`[MapView][watch currentPlan] ====== FIN CHANGEMENT ======
`)},{immediate:!0}),fh(()=>{y.value&&y.value.off("moveend"),window.removeEventListener("shape:created",()=>{})});function Me(){i.value=!i.value}function Ue(){R.value&&(R.value.eachLayer(ft=>{var Qe;((Qe=ft.properties)==null?void 0:Qe.type)==="Note"&&typeof ft.resetPlanSaveState=="function"&&ft.resetPlanSaveState()}),R.value.clearLayers()),d.value=[],ee(),w.value=null,_.value=""}async function ce(ft){return await hn.measureAsync("refreshMapWithPlan",async()=>{try{hn.measure("refreshMapWithPlan:clearMap",()=>{Ue()},"MapView"),await hn.measureAsync("refreshMapWithPlan:loadPlanElements",async()=>{await o.loadPlanElements(ft)},"MapView");const Qe=hn.measure("refreshMapWithPlan:getPlanById",()=>s.getPlanById(ft),"MapView");Qe?(hn.measure("refreshMapWithPlan:updateCurrentPlan",()=>{T.value=Qe,s.setCurrentPlan(Qe),o.setCurrentPlan(Qe.id),localStorage.setItem("lastPlanId",Qe.id.toString())},"MapView"),await hn.measureAsync("refreshMapWithPlan:loadPlanNotes",async()=>{try{console.log("[MapView][refreshMapWithPlan] Chargement des notes géolocalisées associées au plan:",ft);const xn=(await Qs.getNotesByPlan(ft)).data;console.log(`[MapView][refreshMapWithPlan] ${xn.length} notes géolocalisées récupérées`);const vn=lh();y.value&&R.value&&xn.forEach(bn=>{try{if(vn.addNote({...bn,id:bn.id,columnId:bn.column,accessLevel:bn.access_level}),bn.location&&bn.location.type==="Point"&&Array.isArray(bn.location.coordinates)&&bn.location.coordinates.length===2){const Ht=zc.fromBackendData({name:bn.title,description:bn.description,location:bn.location,columnId:bn.column,accessLevel:bn.access_level,style:bn.style||{color:bn.color||"#3B82F6",weight:2,opacity:1,fillColor:bn.color||"#3B82F6",fillOpacity:.6,radius:8},category:bn.category||"forages",comments:bn.comments||[],photos:bn.photos||[]});Ht._dbId=bn.id,R.value.addLayer(Ht),d.value.push({id:bn.id,type:"Note",layer:Ht,properties:Ht.properties}),console.log("[MapView][refreshMapWithPlan] Note géolocalisée ajoutée à la carte:",{id:bn.id,title:bn.title,location:bn.location})}}catch(Ht){console.error("[MapView][refreshMapWithPlan] Erreur lors de l'ajout de la note géolocalisée:",Ht)}})}catch($t){console.error("[MapView][refreshMapWithPlan] Erreur lors du chargement des notes géolocalisées:",$t)}},"MapView"),y.value&&R.value&&await hn.measureAsync("refreshMapWithPlan:addShapesToMap",async()=>{console.log("[MapView][refreshMapWithPlan] Éléments disponibles:",{count:o.getCurrentElements.length,elements:o.getCurrentElements.map(bn=>{var Ht;return{id:bn.id,type:bn.type_forme,hasName:bn.data&&"name"in bn.data,name:(Ht=bn.data)==null?void 0:Ht.name}})});const $t=o.getCurrentElements.reduce((bn,Ht)=>(bn[Ht.type_forme]||(bn[Ht.type_forme]=[]),bn[Ht.type_forme].push(Ht),bn),{}),xn=10,vn=Object.entries($t).map(async([bn,Ht])=>{for(let Hn=0;Hn<Ht.length;Hn+=xn){const St=Ht.slice(Hn,Hn+xn);await Promise.all(St.map(async mt=>{await hn.measureAsync(`refreshMapWithPlan:createElement:${mt.type_forme}`,async()=>{var Qr;if(!R.value||!mt.data)return;let wn=null;switch(mt.type_forme){case"Circle":{const Tt=mt.data;Tt.center&&Tt.radius&&(wn=new zh(jt.latLng(Tt.center[1],Tt.center[0]),{...Tt.style,radius:Tt.radius}),Tt.name&&(wn.properties={type:"Circle",name:Tt.name,style:Tt.style,radius:Tt.radius,diameter:Tt.radius*2,surface:Math.PI*Tt.radius*Tt.radius,perimeter:2*Math.PI*Tt.radius},wn.name=Tt.name));break}case"Rectangle":{const Tt=mt.data;if(Tt.bounds){const Rn=jt.latLngBounds(jt.latLng(Tt.bounds.southWest[1],Tt.bounds.southWest[0]),jt.latLng(Tt.bounds.northEast[1],Tt.bounds.northEast[0]));wn=new pa(Rn,Tt.style),Tt.name&&(wn.properties={name:Tt.name},wn.name=Tt.name)}break}case"Polygon":{const Tt=mt.data;if(Tt.points&&Tt.points.length>0){const Rn=Tt.points.map(Qn=>jt.latLng(Qn[1],Qn[0]));wn=new vf(Rn,Tt.style),Tt.name&&(wn.properties={name:Tt.name},wn.name=Tt.name)}break}case"Line":{const Tt=mt.data;if(Tt.points&&Tt.points.length>0){const Rn=Tt.points.map(Qn=>jt.latLng(Qn[1],Qn[0]));wn=new Bs(Rn,Tt.style),Tt.name&&(wn.properties={name:Tt.name},wn.name=Tt.name)}break}case"ElevationLine":{const Tt=mt.data;if(Tt.points&&Tt.points.length>0){const Rn=Tt.points.map(Qn=>jt.latLng(Qn[1],Qn[0]));wn=new Cf(Rn,Tt.style),Tt.name&&(wn.properties={name:Tt.name,type:"ElevationLine",elevationData:Tt.elevationData,minElevation:Tt.minElevation,maxElevation:Tt.maxElevation,elevationGain:Tt.elevationGain,elevationLoss:Tt.elevationLoss,averageSlope:Tt.averageSlope,maxSlope:Tt.maxSlope},wn.name=Tt.name),Tt.elevationData&&(wn.elevationData=Tt.elevationData)}break}case"Note":{console.log("[MapView][refreshMapWithPlan] Création d'une note:",mt.data);const Tt=mt.data;if(Tt.location&&Array.isArray(Tt.location)&&Tt.location.length===2||Tt.location&&typeof Tt.location=="object"&&Tt.location.type==="Point"&&Array.isArray(Tt.location.coordinates)&&Tt.location.coordinates.length===2)try{Tt.category||(Tt.category="forages",console.log("[MapView][refreshMapWithPlan] Catégorie par défaut ajoutée:",Tt.category)),Tt.accessLevel||(Tt.accessLevel="private",console.log("[MapView][refreshMapWithPlan] Niveau d'accès par défaut ajouté:",Tt.accessLevel));const Qn=zc.fromBackendData(Tt);Qn._dbId=mt.id,wn=Qn,console.log("[MapView][refreshMapWithPlan] Note créée:",{id:mt.id,location:Tt.location,name:Tt.name,category:Tt.category,accessLevel:Tt.accessLevel,type:Qn.properties.type})}catch(Qn){console.error("[MapView][refreshMapWithPlan] Erreur lors de la création de la Note:",Qn)}else console.error("[MapView][refreshMapWithPlan] Données invalides pour Note:",Tt),console.log("[MapView][refreshMapWithPlan] Format de location attendu:",{formatArray:"[lat, lng]",formatGeoJSON:'{ type: "Point", coordinates: [lng, lat] }'});break}}wn&&(wn._dbId=mt.id,(Qr=R.value)==null||Qr.addLayer(wn),d.value.push({id:mt.id,type:mt.type_forme,layer:wn,properties:wn.properties}))},"MapView")})),await new Promise(mt=>setTimeout(mt,0))}});await Promise.all(vn),hn.measure("refreshMapWithPlan:adjustView",()=>{K()},"MapView")},"MapView"),console.log(`Plan ${ft} chargé avec succès avec ${o.getCurrentElements.length} formes`)):console.error(`Plan ${ft} introuvable après chargement`),U.value=!1}catch(Qe){throw console.error("Erreur lors du rafraîchissement de la carte:",Qe),Qe}},"MapView")}async function ne(ft){return await hn.measureAsync("loadPlan",async()=>{var Qe;console.log(`
[MapView][loadPlan] ====== DÉBUT CHARGEMENT PLAN ======`),console.log("[MapView][loadPlan] Tentative de chargement du plan:",ft);try{const $t=await hn.measureAsync("loadPlan:getPlanFromStore",async()=>s.getPlanById(ft),"MapView");if(console.log("[MapView][loadPlan] Plan trouvé dans le store:",!!$t),!$t){console.log("[MapView][loadPlan] Plan non trouvé dans le store, vérification API...");try{await hn.measureAsync("loadPlan:apiCheck",async()=>{await Gn.get(`/plans/${ft}/`)},"MapView")}catch(xn){throw((Qe=xn.response)==null?void 0:Qe.status)===404&&(console.warn("[MapView][loadPlan] Plan non trouvé - Nettoyage du localStorage"),localStorage.removeItem("lastPlanId"),T.value=null,s.clearCurrentPlan(),o.clearCurrentPlan(),Ue()),xn}}console.log("[MapView][loadPlan] Rafraîchissement de la carte..."),await hn.measureAsync("loadPlan:refreshMap",async()=>{await ce(ft)},"MapView"),U.value=!1,console.log("[MapView][loadPlan] Invalidation de la taille de la carte..."),rn(),console.log("[MapView][loadPlan] Plan chargé avec succès:",{planId:ft,elementsCount:o.getCurrentElements.length})}catch($t){throw console.error("Erreur lors du chargement du plan:",$t),hn.measure("loadPlan:errorRecovery",()=>{T.value=null,s.clearCurrentPlan(),o.clearCurrentPlan(),Ue(),localStorage.removeItem("lastPlanId")},"MapView"),$t}},"MapView")}async function ye(){var ft;if(!T.value||!R.value){console.warn("Aucun plan actif ou groupe de formes à sauvegarder");return}B.value=!0,$.value="saving";try{const Qe=[],$t=new Set(o.getCurrentElements.filter(Ht=>Ht.id!==void 0).map(Ht=>Ht.id)),xn=new Set;console.log("[savePlan] Début de la sauvegarde",{featureGroupLayers:R.value.getLayers().length,existingIds:Array.from($t),currentElements:o.getCurrentElements}),R.value.eachLayer(Ht=>{var wn,Qr,Tt,Rn,Qn,Pi,Sr,Pr,dr,Mi,wr,Gr,Ir,tn,zi,Oi,Qi,ei,Br;console.log("[savePlan] Traitement de la couche",{type:(wn=Ht.properties)==null?void 0:wn.type,name:(Qr=Ht.properties)==null?void 0:Qr.name,isPolygon:Ht instanceof jt.Polygon,properties:Ht.properties});let Hn,St;const mt={color:Ht.options.color||"#2b6451",weight:Ht.options.weight||3,opacity:Ht.options.opacity||1,fillColor:Ht.options.fillColor||"#2b6451",fillOpacity:Ht.options.fillOpacity||.2,dashArray:Ht.options.dashArray||""};if(Ht instanceof pa){Hn="Rectangle";const ui=Ht.getBounds();St={bounds:{southWest:[ui.getSouthWest().lng,ui.getSouthWest().lat],northEast:[ui.getNorthEast().lng,ui.getNorthEast().lat]},style:mt,name:((Tt=Ht.properties)==null?void 0:Tt.name)||"",rotation:Ht.getRotation(),width:Ht.getDimensions().width,height:Ht.getDimensions().height,center:[Ht.getCenter().lng,Ht.getCenter().lat]}}else if(Ht instanceof jt.Circle)Hn="Circle",St={center:[Ht.getLatLng().lng,Ht.getLatLng().lat],radius:Ht.getRadius(),name:((Rn=Ht.properties)==null?void 0:Rn.name)||"",style:mt};else if(Ht instanceof jt.Rectangle){Hn="Rectangle";const ui=Ht.getBounds();St={bounds:{southWest:[ui.getSouthWest().lng,ui.getSouthWest().lat],northEast:[ui.getNorthEast().lng,ui.getNorthEast().lat]},name:((Qn=Ht.properties)==null?void 0:Qn.name)||"",style:mt}}else if(Ht instanceof jt.Polyline&&!(Ht instanceof jt.Polygon))if(((Pi=Ht.properties)==null?void 0:Pi.type)==="ElevationLine"){Hn="ElevationLine";const ui=Ht.getLatLngs(),mr=((Sr=Ht.properties)==null?void 0:Sr.category)||"forages",Si=((Pr=Ht.properties)==null?void 0:Pr.accessLevel)||"visitor";console.log("[savePlan] ElevationLine - Catégorie:",mr,"Niveau d'accès:",Si),St={points:ui.map(ps=>[ps.lng,ps.lat]),style:{...mt,color:((dr=Ht.properties.style)==null?void 0:dr.color)||"#FF4500",weight:((Mi=Ht.properties.style)==null?void 0:Mi.weight)||4,opacity:((wr=Ht.properties.style)==null?void 0:wr.opacity)||.8,_accessLevel:Si,accessLevel:Si},name:((Gr=Ht.properties)==null?void 0:Gr.name)||"",category:mr,accessLevel:Si,elevationData:Ht.properties.elevationData,samplePointStyle:Ht.properties.samplePointStyle,minMaxPointStyle:Ht.properties.minMaxPointStyle,minElevation:Ht.properties.minElevation,maxElevation:Ht.properties.maxElevation,elevationGain:Ht.properties.elevationGain,elevationLoss:Ht.properties.elevationLoss,averageSlope:Ht.properties.averageSlope,maxSlope:Ht.properties.maxSlope}}else{Hn="Line";const ui=Ht.getLatLngs(),mr=((Ir=Ht.properties)==null?void 0:Ir.category)||"forages",Si=((tn=Ht.properties)==null?void 0:tn.accessLevel)||"visitor";console.log("[savePlan] Line - Catégorie:",mr,"Niveau d'accès:",Si),St={points:ui.map(ps=>[ps.lng,ps.lat]),name:((zi=Ht.properties)==null?void 0:zi.name)||"",category:mr,accessLevel:Si,style:{...mt,_accessLevel:Si,accessLevel:Si}}}else if(Ht instanceof jt.Polygon&&!(Ht instanceof jt.Rectangle)){Hn="Polygon";const ui=Ht.getLatLngs()[0],mr=((Oi=Ht.properties)==null?void 0:Oi.category)||"forages",Si=((Qi=Ht.properties)==null?void 0:Qi.accessLevel)||"visitor";console.log("[savePlan] Polygon - Catégorie:",mr,"Niveau d'accès:",Si),St={points:ui.map(ps=>[ps.lng,ps.lat]),name:((ei=Ht.properties)==null?void 0:ei.name)||"",category:mr,accessLevel:Si,style:{...mt,_accessLevel:Si,accessLevel:Si}}}else if(((Br=Ht.properties)==null?void 0:Br.type)==="Note"){console.log("[savePlan] Note géolocalisée détectée - ignorée pour la sauvegarde du plan");const ui=Ht;ui._dbId&&typeof ui._dbId=="number"&&xn.add(ui._dbId),Hn=void 0,St=void 0}if(Hn&&St){let ui=Ht._elementId;Ht._dbId&&(ui=Ht._dbId,typeof ui=="number"&&xn.add(ui)),Qe.push({id:ui,type_forme:Hn,data:St})}}),console.log("[savePlan] Éléments à sauvegarder",{totalElements:Qe.length,elements:Qe.map(Ht=>({type:Ht.type_forme,hasPoints:"points"in Ht.data,hasStyle:"style"in Ht.data}))});const vn=Array.from($t).filter(Ht=>!xn.has(Ht));console.log("[savePlan] Éléments supprimés:",{existingIds:Array.from($t),currentLayerIds:Array.from(xn),elementsToDelete:vn}),o.elements=Qe.filter(Ht=>!Ht.id||!vn.includes(Ht.id));const bn=await o.saveToPlan(T.value.id,{elementsToDelete:vn});if(bn&&((ft=T.value)!=null&&ft.id)){const Ht=T.value.id;T.value={...T.value,...bn},s.updatePlanDetails(Ht,bn)}$.value="success",R.value&&R.value.eachLayer(Ht=>{var Hn;((Hn=Ht.properties)==null?void 0:Hn.type)==="Note"&&typeof Ht.resetPlanSaveState=="function"&&Ht.resetPlanSaveState()}),setTimeout(()=>{$.value=null},3e3)}catch(Qe){console.error("Erreur lors de la sauvegarde du plan:",Qe),$.value=null}finally{B.value=!1}}mc(()=>{W.user||et(),s.clearCurrentPlan(),o.clearCurrentPlan(),R.value&&R.value.off("note:edit"),window.removeEventListener("geonote:edit",()=>{}),window.removeEventListener("categoriesReactivated",()=>{}),window.removeEventListener("shapeTypesReactivated",()=>{}),window.removeEventListener("shape:created",()=>{}),window.removeEventListener("map-set-location",()=>{})});function de(ft){if(console.log("[MapView][updateShapeProperties] Mise à jour des propriétés:",ft),I(ft),ft.category&&w.value&&w.value._dbId){const Qe=w.value._dbId,$t=o.elements.find(xn=>xn.id===Qe);if($t){console.log(`[MapView][updateShapeProperties] Mise à jour de la catégorie dans le store: ${ft.category} pour l'élément ${Qe}`);const xn=$t;xn.data||(xn.data={}),xn.data.category=ft.category,o.$patch({unsavedChanges:!0})}}}function We(ft){try{const Qe=new Date(ft);return isNaN(Qe.getTime())?(console.error("Date invalide reçue:",ft),"Date invalide"):new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Paris"}).format(Qe)}catch(Qe){return console.error("Erreur lors du formatage de la date:",Qe),"Date invalide"}}const Ge=()=>{R.value&&K()},tt=async()=>{var ft;if(w.value&&R.value){const Qe=w.value._leaflet_id,$t=w.value._dbId;if(((ft=w.value.properties)==null?void 0:ft.type)==="Note"&&$t)try{console.log(`[MapView][deleteSelectedShape] Suppression de la note ${$t} du backend...`),await Qs.deleteNote($t),u.removeNote($t),console.log(`[MapView][deleteSelectedShape] Note ${$t} supprimée avec succès du backend et du store`),f.success("Note supprimée avec succès")}catch(vn){console.error(`[MapView][deleteSelectedShape] Erreur lors de la suppression de la note ${$t} du backend:`,vn),f.error("Erreur lors de la suppression de la note")}k(""),R.value.removeLayer(w.value),d.value=d.value.filter(vn=>vn.layer&&vn.layer._leaflet_id!==Qe),console.log(`[MapView][deleteSelectedShape] Forme ${Qe} (dbId: ${$t}) supprimée du featureGroup et de shapes.value`),w.value=null}};async function Ze(ft){console.log(`onPlanCreated - Tentative de chargement du plan ${ft}`),await s.fetchPlans();const Qe=s.getPlanById(ft);Qe?(console.log(`Plan ${ft} trouvé, chargement en cours...`),localStorage.setItem("lastPlanId",ft.toString()),T.value=Qe,s.setCurrentPlan(Qe),o.setCurrentPlan(Qe.id),z.value=!1,rn(),console.log(`Plan ${ft} chargé avec succès`)):console.error(`Plan ${ft} introuvable après création! Vérifiez les permissions.`)}oo(we,async ft=>{var Qe;if(ft&&((Qe=W.user)==null?void 0:Qe.user_type)==="admin"){H.value=!0;try{const $t=await W.fetchSalarieVisiteurs(ft.id);oe.value=Array.isArray($t)?$t:[$t]}catch($t){console.error("[MapView][watch selectedSalarie] Error:",$t),oe.value=[]}finally{H.value=!1}}});function et(){localStorage.removeItem("lastPlanId")}function He(ft,Qe="m"){return Qe==="m²"?`${(ft/1e4).toFixed(2)} ha`:Qe==="m"?ft>=1e3?`${(ft/1e3).toFixed(2)} km`:`${ft.toFixed(2)} m`:`${ft.toFixed(2)} ${Qe}`}const wt=zt(!1);function Pt(ft){return{Circle:"Cercle",Rectangle:"Rectangle",Semicircle:"Demi-cercle",Line:"Ligne",Polygon:"Polygone",TextRectangle:"Annotation",ElevationLine:"Profil altimétrique"}[ft]||ft}async function kt(){var Qe,$t,xn,vn,bn,Ht,Hn,St,mt,wn;if(!T.value||!y.value||!R.value){console.error("[generateSynthesis] Plan, map ou featureGroup manquant");return}const ft=T.value;try{console.log("[generateSynthesis] Début de la génération"),console.log("[generateSynthesis] Plan courant complet:",ft),await ye();let Mi=ft;if(!ft.salarie_details&&!ft.entreprise_details&&!ft.client_details){console.log("[generateSynthesis] Détails manquants, tentative de récupération...");try{const mr=await Gn.get(`/plans/${ft.id}/`);mr.status===200&&(console.log("[generateSynthesis] Plan mis à jour:",mr.data),T.value={...ft,...mr.data},Mi=mr.data,s.updatePlanDetails(ft.id,mr.data))}catch(mr){console.error("[generateSynthesis] Erreur lors de la récupération des détails:",mr)}}await new Promise(mr=>setTimeout(mr,1e3)),wt.value=!0;const wr=Mi.salarie_details,Gr=Mi.client_details,Ir=(wr==null?void 0:wr.entreprise_details)||Mi.entreprise_details;console.log("[generateSynthesis] Détails du plan utilisé:",Mi),console.log("[generateSynthesis] Détails des utilisateurs:",{salarie:wr?{id:wr.id,nom:`${wr.first_name} ${wr.last_name}`,company:wr.company_name,logo:wr.logo}:null,entreprise:Ir?{id:Ir.id,nom:`${Ir.first_name} ${Ir.last_name}`,company:Ir.company_name,logo:Ir.logo}:null,client:Gr?{id:Gr.id,nom:`${Gr.first_name} ${Gr.last_name}`,company:Gr.company_name}:null}),w.value&&(ee(),w.value=null);const tn=new kr("l","mm","a4");console.log("[generateSynthesis] Chargement du logo de l'application");const zi=new Image;zi.src=ib,await new Promise(mr=>{zi.onload=()=>{console.log("[generateSynthesis] Logo application chargé"),mr()},zi.onerror=Si=>{console.error("[generateSynthesis] Erreur chargement logo application:",Si),mr()}}),console.log("[generateSynthesis] Tentative de chargement du logo entreprise:",Ir==null?void 0:Ir.logo);let Oi=null;Ir!=null&&Ir.logo&&(Oi=new Image,Oi.src=Ir.logo,await new Promise(mr=>{Oi?(Oi.onload=()=>{console.log("[generateSynthesis] Logo entreprise chargé avec succès"),mr()},Oi.onerror=Si=>{console.error("[generateSynthesis] Erreur chargement logo entreprise:",Si),mr()}):mr()})),console.log("[generateSynthesis] Tentative de chargement du logo salarie:",wr==null?void 0:wr.logo);let Qi=null;wr!=null&&wr.logo&&(Qi=new Image,Qi.src=wr.logo,await new Promise(mr=>{Qi?(Qi.onload=()=>{console.log("[generateSynthesis] Logo salarie chargé avec succès"),mr()},Qi.onerror=Si=>{console.error("[generateSynthesis] Erreur chargement logo salarie:",Si),mr()}):mr()})),console.log("[generateSynthesis] Ajout des logos au PDF:",{logoApplication:!0,logoEntreprise:Oi!==null,logoSalarie:Qi!==null}),Oi!==null&&tn.addImage(Oi,"JPEG",148.5-40-30,20,40,40),tn.addImage(zi,"JPEG",148.5-40/2,20,40,40),Qi!==null&&tn.addImage(Qi,"JPEG",148.5+30,20,40,40),tn.setFontSize(24),tn.setTextColor(0),tn.text(ft.nom||"Sans titre",297/2,100,{align:"center"});let ei=120;if(Ir&&(tn.setFontSize(14),tn.setFont("helvetica","bold"),tn.text("Entreprise:",20,ei),tn.setFont("helvetica","normal"),tn.text(`${Ir.first_name} ${Ir.last_name}${Ir.company_name?` (${Ir.company_name})`:""}`,20,ei+6),ei+=15),wr&&(tn.setFontSize(14),tn.setFont("helvetica","bold"),tn.text("Salarie:",20,ei),tn.setFont("helvetica","normal"),tn.text(`${wr.first_name} ${wr.last_name}${wr.company_name?` (${wr.company_name})`:""}`,20,ei+6),ei+=15),Gr&&(tn.setFontSize(14),tn.setFont("helvetica","bold"),tn.text("Client:",20,ei),tn.setFont("helvetica","normal"),tn.text(`${Gr.first_name} ${Gr.last_name}${Gr.company_name?` (${Gr.company_name})`:""}`,20,ei+6),ei+=15),ft.description){tn.setFont("helvetica","bold"),tn.text("Description:",20,ei),tn.setFont("helvetica","normal");const mr=tn.splitTextToSize(ft.description,150);tn.text(mr,20,ei+6),ei+=8*mr.length+10}ei=Math.min(ei,180),tn.setFontSize(10),tn.setTextColor(100),tn.text(`Date de création: ${We(ft.date_creation)}`,20,190),tn.text(`Dernière modification: ${We(ft.date_modification)}`,277,190,{align:"right"});const Br=[];R.value.eachLayer(mr=>Br.push(mr));const ui=jt.simpleMapScreenshoter({hideElementsWithSelectors:[".leaflet-control-container",".leaflet-pm-toolbar",".leaflet-grid-layer",".leaflet-grid-label"],preventDownload:!0}).addTo(y.value);await new Promise(mr=>setTimeout(mr,3e3));for(let mr=0;mr<Br.length;mr++){tn.addPage(),tn.setFillColor(248,250,252),tn.setDrawColor(226,232,240),tn.rect(0,0,297,25,"F"),tn.setFontSize(10),tn.setTextColor(50,50,50),tn.setFont("helvetica","bold"),tn.text(ft.nom||"Sans titre",20,12);let va=297-20-(15*(1+(Oi!==null?1:0)+(Qi!==null?1:0))+5*(1+(Oi!==null?1:0)));Oi!==null&&(tn.addImage(Oi,"JPEG",va,5,15,15),va+=20),tn.addImage(zi,"JPEG",va,5,15,15),va+=20,Qi!==null&&tn.addImage(Qi,"JPEG",va,5,15,15),tn.setDrawColor(200,200,200),tn.setLineWidth(.5),tn.line(0,25,297,25);const Rr=Br[mr],mn=Rr.properties;if(mn){tn.setTextColor(0),tn.setFontSize(14),tn.setFont("helvetica","bold");const Zn=mn.name||Pt(mn.type);let Ei="";if(mn.type!=="TextRectangle"){const Ri=he(Br,Rr);Ei=Ri>0?` (surface totale d'irrigation : ${He(Ri,"m²")})`:""}const Bi=`${Zn}${Ei}`;tn.text(Bi,20,35)}if(mn&&mn.type==="ElevationLine")try{const Zn=((Qe=Rr.getBounds)==null?void 0:Qe.call(Rr))||(($t=Rr.getLatLng)==null?void 0:$t.call(Rr));Zn&&y.value.fitBounds(Zn instanceof jt.LatLng?jt.latLngBounds([Zn]):Zn,{padding:[50,50]});try{const Cn=((xn=Rr.getBounds)==null?void 0:xn.call(Rr))||((vn=Rr.getLatLng)==null?void 0:vn.call(Rr));if(!Cn||!y.value)console.warn("[generateSynthesis] Bounds ou carte invalide");else{const cn=Cn instanceof jt.LatLng?jt.latLngBounds([Cn]):Cn;cn&&cn.isValid&&cn.isValid()&&y.value.getContainer()&&document.body.contains(y.value.getContainer())&&y.value.fitBounds(cn,{padding:[50,50],animate:!1})}}catch(Cn){console.warn("[generateSynthesis] Erreur lors de l'ajustement de la vue:",Cn)}await new Promise(Cn=>setTimeout(Cn,2e3)),y.value.invalidateSize();try{y.value&&y.value.getContainer()&&document.body.contains(y.value.getContainer())?y.value.invalidateSize({animate:!1}):console.warn("[generateSynthesis] Carte non valide pour l'invalidation de taille")}catch(Cn){console.warn("[generateSynthesis] Erreur lors de l'invalidation de la taille de la carte:",Cn)}await new Promise(Cn=>{const cn=()=>{var _o;const fr=(_o=y.value)==null?void 0:_o.getContainer();if(!fr){Cn();return}const eo=fr.querySelectorAll(".leaflet-tile-loaded");fr.querySelectorAll(".leaflet-tile-loading").length===0&&eo.length>0?Cn():setTimeout(cn,100)};cn()});const Ei=await ui.takeScreen("image"),Bi=await new Promise((Cn,cn)=>{const fr=new Image;fr.onload=()=>Cn(fr),fr.onerror=eo=>cn(eo),fr.src=Ei}),Ri=40,jo=237/2,cr=Math.min(70,Bi.height*jo/Bi.width);if(tn.addImage(Bi,"PNG",20,Ri,jo,cr),mn.elevationData&&mn.elevationData.length>0){const Cn=document.createElement("canvas");Cn.width=800,Cn.height=400;const cn=Cn.getContext("2d");if(cn){const fr=mn.elevationData,eo=mn.minElevation,Ao=mn.maxElevation,za=(Ao-eo)*.05,Qo=eo-za,il=Ao+za,jr=40,As=Cn.width-2*jr,lo=Cn.height-2*jr,es=fi=>jr+fi/fr[fr.length-1].distance*As,Fi=fi=>jr+lo-(fi-Qo)/(il-Qo)*lo;cn.fillStyle="#f8fafc",cn.fillRect(0,0,Cn.width,Cn.height),cn.fillStyle="#334155",cn.font="bold 20px Arial",cn.textAlign="center",cn.fillText("Profil altimétrique",Cn.width/2,25),cn.strokeStyle="#e2e8f0",cn.lineWidth=1,cn.beginPath(),cn.moveTo(jr,jr),cn.lineTo(jr,lo+jr),cn.lineTo(As+jr,lo+jr),cn.strokeStyle="#94a3b8",cn.stroke();const Pl=5;for(let fi=0;fi<=Pl;fi++){const ns=Qo+fi/Pl*(il-Qo),to=Fi(ns);cn.beginPath(),cn.strokeStyle="#e2e8f0",cn.moveTo(jr,to),cn.lineTo(As+jr,to),cn.stroke(),cn.beginPath(),cn.strokeStyle="#94a3b8",cn.moveTo(jr-5,to),cn.lineTo(jr,to),cn.stroke(),cn.fillStyle="#64748b",cn.font="12px Arial",cn.textAlign="right",cn.fillText(`${Math.round(ns)}m`,jr-8,to+4)}const $a=5,vr=fr[fr.length-1].distance;for(let fi=0;fi<=$a;fi++){const ns=fi/$a*vr,to=es(ns);cn.beginPath(),cn.strokeStyle="#e2e8f0",cn.moveTo(to,jr),cn.lineTo(to,lo+jr),cn.stroke(),cn.beginPath(),cn.strokeStyle="#94a3b8",cn.moveTo(to,lo+jr),cn.lineTo(to,lo+jr+5),cn.stroke(),cn.fillStyle="#64748b",cn.font="12px Arial",cn.textAlign="center",cn.fillText(`${Math.round(ns)}m`,to,lo+jr+16)}const yr=cn.createLinearGradient(0,jr,0,lo+jr);yr.addColorStop(0,"rgba(255, 69, 0, 0.8)"),yr.addColorStop(1,"rgba(255, 69, 0, 0.2)"),cn.beginPath(),cn.moveTo(es(fr[0].distance),Fi(fr[0].elevation)),fr.forEach((fi,ns)=>{ns>0&&cn.lineTo(es(fi.distance),Fi(fi.elevation))}),cn.strokeStyle="#FF4500",cn.lineWidth=2,cn.stroke(),cn.lineTo(es(fr[fr.length-1].distance),Fi(Qo)),cn.lineTo(es(fr[0].distance),Fi(Qo)),cn.closePath(),cn.fillStyle=yr,cn.fill(),fr.forEach(fi=>{cn.beginPath(),cn.arc(es(fi.distance),Fi(fi.elevation),3,0,Math.PI*2),cn.fillStyle="#FF4500",cn.fill(),cn.strokeStyle="white",cn.lineWidth=1,cn.stroke()});let ts=0,zr=0;for(let fi=0;fi<fr.length;fi++)fr[fi].elevation===eo&&(ts=fi),fr[fi].elevation===Ao&&(zr=fi);cn.beginPath(),cn.arc(es(fr[zr].distance),Fi(fr[zr].elevation),6,0,Math.PI*2),cn.fillStyle="#059669",cn.fill(),cn.strokeStyle="white",cn.lineWidth=2,cn.stroke(),cn.beginPath(),cn.arc(es(fr[ts].distance),Fi(fr[ts].elevation),6,0,Math.PI*2),cn.fillStyle="#DC2626",cn.fill(),cn.strokeStyle="white",cn.lineWidth=2,cn.stroke(),cn.font="12px Arial",cn.fillStyle="#059669",cn.textAlign="left",cn.fillText(`Point haut: ${He(Ao,"m")}`,jr,lo+jr+35),cn.fillStyle="#DC2626",cn.fillText(`Point bas: ${He(eo,"m")}`,jr+200,lo+jr+35);const Ml=Cn.toDataURL("image/png");tn.addImage(Ml,"PNG",20+jo+20,Ri,jo,cr)}}const Vn=Ri+cr+15;tn.setFillColor(248,250,252),tn.setDrawColor(226,232,240),tn.roundedRect(20,Vn,257,50,3,3,"FD"),tn.setFont("helvetica","bold"),tn.setFontSize(12),tn.setTextColor(51,65,85),tn.text("Caractéristiques",30,Vn+10);const Ms=[{label:"Distance totale",value:He(mn.length||0)},{label:"Dénivelé positif",value:He(mn.elevationGain||0,"m")},{label:"Dénivelé négatif",value:He(mn.elevationLoss||0,"m")}],oi=[{label:"Pente moyenne",value:`${(mn.averageSlope||0).toFixed(1)}%`},{label:"Pente maximale",value:`${(mn.maxSlope||0).toFixed(1)}%`},{label:"Altitude min/max",value:`${He(mn.minElevation||0,"m")} / ${He(mn.maxElevation||0,"m")}`}];let Ai=Vn+20;tn.setFont("helvetica","normal"),tn.setFontSize(10),Ms.forEach(Cn=>{tn.setTextColor(100,116,139),tn.text(Cn.label,30,Ai),tn.setTextColor(15,23,42),tn.setFont("helvetica","bold"),tn.text(Cn.value,110,Ai),tn.setFont("helvetica","normal"),Ai+=9}),Ai=Vn+20;const ci=297/2;oi.forEach(Cn=>{tn.setTextColor(100,116,139),tn.text(Cn.label,ci,Ai),tn.setTextColor(15,23,42),tn.setFont("helvetica","bold"),tn.text(Cn.value,ci+80,Ai),tn.setFont("helvetica","normal"),Ai+=9})}catch(Zn){console.error("[generateSynthesis] Erreur traitement profil altimétrique:",Zn)}else{const Zn=((bn=Rr.getBounds)==null?void 0:bn.call(Rr))||((Ht=Rr.getLatLng)==null?void 0:Ht.call(Rr));Zn&&y.value.fitBounds(Zn instanceof jt.LatLng?jt.latLngBounds([Zn]):Zn,{padding:[50,50]});try{const Ei=((Hn=Rr.getBounds)==null?void 0:Hn.call(Rr))||((St=Rr.getLatLng)==null?void 0:St.call(Rr));if(!Ei||!y.value)console.warn("[generateSynthesis] Bounds ou carte invalide");else{const Bi=Ei instanceof jt.LatLng?jt.latLngBounds([Ei]):Ei;Bi&&Bi.isValid&&Bi.isValid()&&y.value.getContainer()&&document.body.contains(y.value.getContainer())&&y.value.fitBounds(Bi,{padding:[50,50],animate:!1})}}catch(Ei){console.warn("[generateSynthesis] Erreur lors de l'ajustement de la vue:",Ei)}await new Promise(Ei=>setTimeout(Ei,2e3)),y.value.invalidateSize(),await new Promise(Ei=>{const Bi=()=>{var Vn;const Ri=(Vn=y.value)==null?void 0:Vn.getContainer();if(!Ri){Ei();return}const jo=Ri.querySelectorAll(".leaflet-tile-loaded");Ri.querySelectorAll(".leaflet-tile-loading").length===0&&jo.length>0?Ei():setTimeout(Bi,100)};Bi()});try{const Ei=await ui.takeScreen("image"),Bi=await new Promise((Vn,Ms)=>{const oi=new Image;oi.onload=()=>Vn(oi),oi.onerror=Ai=>Ms(Ai),oi.src=Ei}),Ri=45,jo=297*.6-30;let cr=Bi.height*jo/Bi.width;if(cr>210*.9&&(cr=210*.9),tn.addImage(Bi,"PNG",20,Ri,jo,cr),mn){let Vn=function(cn,fr,eo,Ao,_o){tn.setTextColor(100,116,139),tn.setFont("helvetica","normal"),tn.text(cn,eo+10,Ao),tn.setTextColor(15,23,42),tn.setFont("helvetica","bold"),tn.text(fr,eo+_o-10,Ao,{align:"right"})},oi=0;if(mn.type==="Circle")oi=4;else if(mn.type==="Rectangle")oi=4;else if(mn.type==="Line")oi=1,(mt=mn.dimensions)!=null&&mt.width&&oi++,mn.surfaceInfluence&&oi++;else if(mn.type==="Semicircle")oi=6;else if(mn.type==="Polygon")oi=2;else if(mn.type==="CircleWithSections"&&(oi=3,mn.sections&&mn.sections.length>0)){const cn=Math.ceil(mn.sections.length/3);oi+=cn*3}const Ai=Math.max(15+oi*12+30,60),ci=297-188.2-20;tn.setFillColor(248,250,252),tn.setDrawColor(226,232,240),tn.roundedRect(188.2,Ri,ci,Ai,3,3,"FD"),tn.setFont("helvetica","bold"),tn.setFontSize(12),tn.setTextColor(51,65,85),tn.text("Caractéristiques",188.2+10,Ri+15);let Cn=Ri+30;tn.setFontSize(10),mn.type==="Circle"?(Vn("Rayon",He(mn.radius),188.2,Cn,ci),Cn+=12,Vn("Diamètre",He(mn.radius*2),188.2,Cn,ci),Cn+=12,Vn("Surface",He(mn.surface,"m²"),188.2,Cn,ci),Cn+=12,Vn("Périmètre",He(mn.perimeter),188.2,Cn,ci)):mn.type==="Rectangle"?(Vn("Largeur",He(mn.width),188.2,Cn,ci),Cn+=12,Vn("Hauteur",He(mn.height),188.2,Cn,ci),Cn+=12,Vn("Surface",He(mn.surface,"m²"),188.2,Cn,ci),Cn+=12,Vn("Périmètre",He(mn.perimeter),188.2,Cn,ci)):mn.type==="Line"?(Vn("Longueur",He(mn.length),188.2,Cn,ci),Cn+=12,(wn=mn.dimensions)!=null&&wn.width&&(Vn("Largeur d'influence",He(mn.dimensions.width),188.2,Cn,ci),Cn+=12),mn.surfaceInfluence&&Vn("Surface d'influence",He(mn.surfaceInfluence,"m²"),188.2,Cn,ci)):mn.type==="Semicircle"?(Vn("Rayon",He(mn.radius),188.2,Cn,ci),Cn+=12,Vn("Diamètre",He(mn.radius*2),188.2,Cn,ci),Cn+=12,Vn("Surface",He(mn.surface,"m²"),188.2,Cn,ci),Cn+=12,Vn("Périmètre",He(mn.perimeter),188.2,Cn,ci),Cn+=12,Vn("Longueur d'arc",He(mn.arcLength),188.2,Cn,ci),Cn+=12,Vn("Angle d'ouverture",`${mn.openingAngle.toFixed(1)}°`,188.2,Cn,ci)):mn.type==="Polygon"?(Vn("Surface",He(mn.surface,"m²"),188.2,Cn,ci),Cn+=12,Vn("Périmètre",He(mn.perimeter),188.2,Cn,ci)):mn.type==="CircleWithSections"&&(Vn("Rayon",He(mn.radius),188.2,Cn,ci),Cn+=12,Vn("Surface totale",He(mn.surface,"m²"),188.2,Cn,ci),Cn+=12,Vn("Périmètre",He(mn.perimeter),188.2,Cn,ci),Cn+=20,mn.sections&&mn.sections.length>0&&(Cn=ii(mn.sections,tn,188.2,Cn,ci)))}}catch(Ei){console.error(`[generateSynthesis] Erreur capture forme ${mr+1}:`,Ei)}}}y.value.removeControl(ui),tn.save(`synthese_${ft.nom}.pdf`)}catch(Qr){console.error("[generateSynthesis] Erreur:",Qr),alert("Une erreur est survenue lors de la génération de la synthèse. Veuillez réessayer.")}finally{wt.value=!1}}const Jt=cx.debounce(()=>{const ft=hn.startMeasure("invalidateMapSize","MapView");if(!y.value){ft();return}Us(()=>{hn.measure("invalidateMapSize:nextTick",()=>{var Qe;try{if(y.value&&y.value.getContainer()&&document.body.contains(y.value.getContainer())){if(y.value.invalidateSize({animate:!1}),(Qe=R.value)!=null&&Qe.getLayers().length)try{K()}catch($t){console.warn("[invalidateMapSize] Erreur lors de l'ajustement de la vue:",$t)}}else console.warn("[invalidateMapSize] Carte non valide pour l'invalidation")}catch($t){console.warn("[invalidateMapSize] Erreur lors de l'invalidation de la taille de la carte:",$t)}ft()},"MapView")})},250);function rn(){Jt()}oo(T,(ft,Qe)=>{ft&&ft.id!==(Qe==null?void 0:Qe.id)&&Us(()=>{rn()})});const un=zt(null),Ke=zt(!1),ot=zt([]),rt=sr(()=>{if(console.log("[MapView][filteredSalaries] Computing with:",{selectedEntreprise:un.value,salaries:G.value,salariesLength:G.value.length}),!un.value)return[];const ft=G.value.filter(Qe=>{var vn,bn,Ht;const $t=Qe.entreprise,xn=typeof $t=="object"&&$t!==null?$t.id:$t;return console.log("[MapView][filteredSalaries] Checking salarie:",{salarie:Qe,salarieEntreprise:$t,salarieEntrepriseId:xn,selectedEntrepriseId:(vn=un.value)==null?void 0:vn.id,matches:xn===((bn=un.value)==null?void 0:bn.id)}),xn===((Ht=un.value)==null?void 0:Ht.id)});return console.log("[MapView][filteredSalaries] Filtered result:",ft),ft});function Ft(ft){if(!ft)return"";const Qe=ft.first_name||"",$t=ft.last_name?ft.last_name.toUpperCase():"",xn=ft.company_name||ft.role||"";return`${Qe} ${$t} (${xn})`}async function Qt(){Ke.value=!0;try{const ft=await Gn.get("/users/",{params:{role:"ENTREPRISE"}});ot.value=ft.data}catch(ft){console.error("[MapView] Error loading entreprises:",ft),ot.value=[]}finally{Ke.value=!1}}async function Bn(ft){console.log("[MapView][selectEntreprise] Sélection de l'entreprise:",ft),un.value=ft,Y.value=!0;try{console.log("[MapView][selectEntreprise] Envoi de la requête avec params:",{role:"SALARIE",entreprise:ft.id});const Qe=await Gn.get("/users/",{params:{role:"SALARIE",entreprise:ft.id}});console.log("[MapView][selectEntreprise] Réponse reçue:",Qe.data),G.value=Qe.data,console.log("[MapView][selectEntreprise] Salaries mis à jour:",G.value)}catch(Qe){console.error("[MapView] Error loading salaries for entreprise:",Qe),G.value=[]}finally{Y.value=!1}}function Ln(){un.value=null,we.value=null,Te.value=null,G.value=[],oe.value=[],ie.value=[]}function Nn(){we.value=null,Te.value=null,oe.value=[],ie.value=[]}function ar(){Te.value=null,ie.value=[]}async function En(ft){var Qe,$t,xn,vn,bn,Ht;console.log(`
[MapView][selectSalarie] ====== DÉBUT SÉLECTION SALARIE ======`),console.log("Informations du salarie:",{id:ft.id,username:ft.username,company:ft.company_name,role:ft.role}),console.log("Contexte utilisateur:",{userType:(Qe=W.user)==null?void 0:Qe.user_type,userId:($t=W.user)==null?void 0:$t.id,userRole:(xn=W.user)==null?void 0:xn.role,selectedEntrepriseId:(vn=un.value)==null?void 0:vn.id}),we.value=ft,H.value=!0;try{const Hn={role:"VISITEUR",salarie:ft.id};W.isEntreprise?(console.log("Ajout de l'ID de l'entreprise connectée:",(bn=W.user)==null?void 0:bn.id),Hn.entreprise=(Ht=W.user)==null?void 0:Ht.id):un.value&&(console.log("Ajout de l'ID de l'entreprise sélectionnée:",un.value.id),Hn.entreprise=un.value.id),console.log("Paramètres de la requête:",Hn);const St=await Gn.get("/users/",{params:Hn});console.log("Réponse reçue du serveur:",{status:St.status,dataLength:Array.isArray(St.data)?St.data.length:"non-array",data:St.data}),Array.isArray(St.data)?(oe.value=St.data,console.log(`${St.data.length} visiteurs chargés`),St.data.forEach((mt,wn)=>{console.log(`Visiteur ${wn+1}:`,{id:mt.id,username:mt.username,company:mt.company_name,salarie:mt.salarie})})):(console.warn("Format de réponse inattendu:",St.data),oe.value=[]),oe.value.length===0&&console.warn("Aucun visiteur trouvé pour ce salarie")}catch(Hn){if(console.error("ERREUR lors du chargement des visiteurs:",Hn),Hn&&typeof Hn=="object"&&"response"in Hn){const St=Hn;console.error("Détails de l'erreur:",{status:St.response.status,data:St.response.data})}oe.value=[]}finally{H.value=!1,console.log(`[MapView][selectSalarie] ====== FIN SÉLECTION SALARIE ======
`)}}function jn(){J.value=!1,D.value=null}function Mn(ft){console.log("[MapView][handleFilterChange] Nouveaux filtres reçus:",JSON.stringify(ft,null,2)),console.log("[MapView][handleFilterChange] Filtres actuels dans le store:",JSON.stringify({accessLevels:{...o.filters.accessLevels},categories:{...o.filters.categories},shapeTypes:{...o.filters.shapeTypes}},null,2)),console.log("[MapView][handleFilterChange] Mise à jour des filtres dans le store"),o.updateFilters(ft),console.log("[MapView][handleFilterChange] Éléments dans le store:",{count:o.elements.length,ids:o.elements.map(Qe=>Qe.id)}),console.log("[MapView][handleFilterChange] Mise à jour de l'affichage de la carte"),Yn(),setTimeout(()=>{console.log("[MapView][handleFilterChange] Mise à jour forcée de l'affichage"),Yn()},100),console.log("[MapView][handleFilterChange] Traitement des filtres terminé")}function Yn(){if(!R.value)return;const ft={accessLevels:{...o.filters.accessLevels},categories:{...o.filters.categories},shapeTypes:{...o.filters.shapeTypes}};console.log("[MapView][updateMapDisplay] Mise à jour de l'affichage avec filtres:",JSON.stringify(ft,null,2));const Qe={count:o.elements.length,elements:o.elements.map(Tt=>({id:Tt.id,type_forme:Tt.type_forme}))};console.log("[MapView][updateMapDisplay] Éléments dans le store:",JSON.stringify(Qe,null,2));const $t=o.getFilteredElements;console.log("[MapView][updateMapDisplay] Éléments filtrés:",{total:o.elements.length,filtered:$t.length,filteredIds:$t.map(Tt=>Tt.id)});const xn=R.value.getLayers();console.log("[MapView][updateMapDisplay] Couches actuelles:",xn.length);const vn=xn.map(Tt=>({_leaflet_id:Tt._leaflet_id,_dbId:Tt._dbId,hasProperties:!!Tt.properties,propertyType:Tt.properties?Tt.properties.type:null,category:Tt.properties?Tt.properties.category:null}));console.log("[MapView][updateMapDisplay] Détails des couches:",JSON.stringify(vn,null,2)),console.log("[MapView][updateMapDisplay] État des filtres pour les catégories:",{forages:o.filters.categories.forages,clients:o.filters.categories.clients,entrepots:o.filters.categories.entrepots,livraisons:o.filters.categories.livraisons,cultures:o.filters.categories.cultures,parcelles:o.filters.categories.parcelles});const bn=new Map;d.value.forEach(Tt=>{Tt.layer&&Tt.id&&bn.set(Tt.id,Tt.layer)});const Ht=new Map;xn.forEach(Tt=>{Tt._dbId&&Ht.set(Tt,Tt._dbId)});const Hn=new Set($t.map(Tt=>Tt.id));console.log("[MapView][updateMapDisplay] Début du traitement des couches");const St=Array.from(Hn);console.log("[MapView][updateMapDisplay] IDs des éléments filtrés:",JSON.stringify(St));let mt=0,wn=0,Qr=0;xn.forEach(Tt=>{var Oi,Qi;const Rn=Tt._dbId,Qn=Tt._leaflet_id;if(!Rn){if(!Tt.properties){Qr++,console.log(`[MapView][updateMapDisplay] Couche ${Qn} sans dbId et sans propriétés, ignorée`);return}Tt._dbId=Date.now()+Math.floor(Math.random()*1e3),console.log(`[MapView][updateMapDisplay] Couche ${Qn} sans dbId, ID temporaire assigné: ${Tt._dbId}`)}const Pi=Tt.properties||{},Sr=Pi.type||Tt.type_forme||"";let Pr=Pi.category;if(Tt._dbId){const ei=o.elements.find(Br=>Br.id===Tt._dbId);if(ei){const Br=ei.data;Br&&Br.category&&(Pr!==Br.category&&(console.log(`[MapView][updateMapDisplay] Catégorie différente détectée - Propriétés: ${Pr}, Store: ${Br.category} pour la couche ${Tt._dbId}`),Pr=Br.category),Tt.properties||(Tt.properties={}),Tt.properties.category=Pr)}}Pr||(Pr="default");const dr=Pi.accessLevel||"visitor";console.log(`[MapView][updateMapDisplay] Couche ${Qn} (dbId: ${Tt._dbId}): type=${Sr}, category=${Pr}, accessLevel=${dr}`),console.log("[MapView][updateMapDisplay] Filtres actuels:",JSON.stringify(o.filters));let Mi=!1;Sr?Mi=Sr in o.filters.shapeTypes&&o.filters.shapeTypes[Sr]===!0:Mi=o.filters.shapeTypes.Polygon===!0;let wr=!1;Pr?Pr in o.filters.categories?(wr=o.filters.categories[Pr]===!0,console.log(`[MapView][updateMapDisplay] Vérification de la catégorie ${Pr}: ${wr}`)):(wr=o.filters.categories.forages===!0,console.log(`[MapView][updateMapDisplay] Catégorie ${Pr} non trouvée dans les filtres, utilisation de 'forages': ${wr}`)):(wr=o.filters.categories.forages===!0,console.log(`[MapView][updateMapDisplay] Catégorie non spécifiée, utilisation de 'forages': ${wr}`));let Gr=!1;const Ir={company:o.filters.accessLevels.company===!0,employee:o.filters.accessLevels.employee===!0,visitor:o.filters.accessLevels.visitor===!0};let tn="visitor";Ir.company?tn="company":Ir.employee?tn="employee":Ir.visitor&&(tn="visitor"),console.log(`[MapView][updateMapDisplay] Niveau d'accès sélectionné par l'utilisateur: ${tn}`),tn==="company"?Gr=!0:tn==="employee"?Gr=dr==="employee"||dr==="visitor":tn==="visitor"&&(Gr=dr==="visitor"),console.log(`[MapView][updateMapDisplay] Niveau d'accès de la couche: ${dr}, visible: ${Gr}`);const zi=Mi&&wr&&Gr;console.log(`[MapView][updateMapDisplay] Visibilité de la couche ${Qn}: typeVisible=${Mi}, categoryVisible=${wr}, accessLevelVisible=${Gr}, isVisible=${zi}`),console.log(`[MapView][updateMapDisplay] Détails de la couche ${Qn}: type=${Sr}, category=${Pr}, accessLevel=${dr}`),console.log("[MapView][updateMapDisplay] Filtres actuels:",JSON.stringify({accessLevels:o.filters.accessLevels,categories:o.filters.categories,shapeTypes:o.filters.shapeTypes},null,2)),zi?R.value.hasLayer(Tt)?(mt++,console.log(`[MapView][updateMapDisplay] Couche ${Tt._dbId} (${Sr}) déjà visible avec catégorie ${((Qi=Tt.properties)==null?void 0:Qi.category)||"non définie"}`)):(Pr&&Pr!=="default"&&(!Tt.properties||!Tt.properties.category)&&(Tt.properties||(Tt.properties={}),Tt.properties.category=Pr,console.log(`[MapView][updateMapDisplay] Catégorie définie avant ajout: ${Pr} pour la couche ${Tt._dbId}`)),R.value.addLayer(Tt),mt++,console.log(`[MapView][updateMapDisplay] Affichage de la couche ${Tt._dbId} (${Sr}) avec catégorie ${((Oi=Tt.properties)==null?void 0:Oi.category)||"non définie"}`)):R.value.hasLayer(Tt)?(R.value.removeLayer(Tt),wn++,console.log(`[MapView][updateMapDisplay] Masquage de la couche ${Tt._dbId} (${Sr}) - Filtres non respectés`)):(wn++,console.log(`[MapView][updateMapDisplay] Couche ${Tt._dbId} (${Sr}) déjà masquée`))}),console.log("[MapView][updateMapDisplay] Début de la restauration des couches filtrées"),console.log("[MapView][updateMapDisplay] Nombre de formes dans shapes.value:",d.value.length),d.value.forEach(Tt=>{var Qi;if(!Tt.layer){console.log("[MapView][updateMapDisplay] Forme sans couche, ignorée");return}const Rn=Tt.layer,Qn=Rn._leaflet_id,Pi=Rn._dbId;if(console.log(`[MapView][updateMapDisplay] Traitement de la forme ${Qn} (dbId: ${Pi})`),R.value.hasLayer(Rn)){console.log(`[MapView][updateMapDisplay] La couche ${Qn} est déjà dans le featureGroup, ignorée`);return}const Sr=Rn.properties||{},Pr=Sr.type||Rn.type_forme||"";let dr=null;if(Rn._dbId){const ei=o.elements.find(Br=>Br.id===Rn._dbId);if(ei){const Br=ei.data;Br&&Br.category&&(dr=Br.category,console.log(`[MapView][updateMapDisplay] Catégorie récupérée depuis le store: ${dr} pour la couche ${Rn._dbId}`))}}!dr&&Sr.category&&(dr=Sr.category,console.log(`[MapView][updateMapDisplay] Catégorie récupérée depuis les propriétés: ${dr} pour la couche ${Qn}`)),dr||(dr="default");const Mi=Sr.accessLevel||"visitor";if(Rn.properties||(Rn.properties={}),dr&&dr!=="default"&&(Rn.properties.category=dr,console.log(`[MapView][updateMapDisplay] Catégorie définie/restaurée: ${dr} pour la couche ${Rn._dbId}`),Rn._dbId)){const ei=o.elements.find(Br=>Br.id===Rn._dbId);if(ei){const Br=ei;Br.data||(Br.data={}),Br.data.category!==dr&&(console.log(`[MapView][updateMapDisplay] Mise à jour de la catégorie dans le store: ${dr} pour l'élément ${Rn._dbId}`),Br.data.category=dr,o.$patch({unsavedChanges:!0}))}}Rn.properties.accessLevel||(Rn.properties.accessLevel="visitor"),console.log(`[MapView][updateMapDisplay] Propriétés de la couche ${Qn}: type=${Pr}, category=${dr}, accessLevel=${Mi}`);let wr=!1;Pr?wr=Pr in o.filters.shapeTypes&&o.filters.shapeTypes[Pr]===!0:wr=o.filters.shapeTypes.Polygon===!0;let Gr=!1;dr?dr in o.filters.categories?(Gr=o.filters.categories[dr]===!0,console.log(`[MapView][updateMapDisplay] Vérification de la catégorie ${dr}: ${Gr}`)):(Gr=o.filters.categories.forages===!0,console.log(`[MapView][updateMapDisplay] Catégorie ${dr} non trouvée, utilisation de 'forages': ${Gr}`)):(Gr=o.filters.categories.forages===!0,console.log(`[MapView][updateMapDisplay] Pas de catégorie, utilisation de 'forages': ${Gr}`));let Ir=!1;const tn={company:o.filters.accessLevels.company===!0,employee:o.filters.accessLevels.employee===!0,visitor:o.filters.accessLevels.visitor===!0};let zi="visitor";tn.company?zi="company":tn.employee?zi="employee":tn.visitor&&(zi="visitor"),console.log(`[MapView][updateMapDisplay] Niveau d'accès sélectionné par l'utilisateur (2ème étape): ${zi}`),zi==="company"?Ir=!0:zi==="employee"?Ir=Mi==="employee"||Mi==="visitor":zi==="visitor"&&(Ir=Mi==="visitor"),console.log(`[MapView][updateMapDisplay] Niveau d'accès de la couche (2ème étape): ${Mi}, visible: ${Ir}`);const Oi=wr&&Gr&&Ir;if(console.log(`[MapView][updateMapDisplay] Visibilité de la couche ${Qn}: typeVisible=${wr}, categoryVisible=${Gr}, accessLevelVisible=${Ir}, isVisible=${Oi}`),Oi){if(dr&&dr!=="default"&&(Rn.properties||(Rn.properties={}),Rn.properties.category=dr,console.log(`[MapView][updateMapDisplay] Catégorie définie avant restauration: ${dr} pour la couche ${Qn}`),Rn._dbId)){const ei=o.elements.find(Br=>Br.id===Rn._dbId);if(ei){const Br=ei;Br.data||(Br.data={}),Br.data.category!==dr&&(console.log(`[MapView][updateMapDisplay] Mise à jour de la catégorie dans le store avant restauration: ${dr} pour l'élément ${Rn._dbId}`),Br.data.category=dr,o.$patch({unsavedChanges:!0}))}}R.value.addLayer(Rn),mt++,console.log(`[MapView][updateMapDisplay] Restauration de la couche ${Qn} (${Pr}) avec catégorie ${((Qi=Rn.properties)==null?void 0:Qi.category)||"non définie"} - Filtres respectés`)}else console.log(`[MapView][updateMapDisplay] La couche ${Qn} (${Pr}) reste masquée - Filtres non respectés`)}),console.log(`[MapView][updateMapDisplay] Restauration terminée: ${mt} couches visibles au total`),console.log(`[MapView][updateMapDisplay] Statistiques: ${mt} couches visibles, ${wn} couches masquées, ${Qr} couches sans dbId`),console.log("[MapView][updateMapDisplay] Mise à jour terminée")}function br(ft){if(R.value){const $t=R.value.getLayers().find(xn=>xn._leaflet_id===ft.id);$t&&($t.properties.name=ft.title,$t.properties.description=ft.description,$t.properties.columnId=ft.columnId,$t.properties.accessLevel=ft.accessLevel,$t.properties.category||($t.properties.category="forages"),$t.setNoteStyle({color:ft.style.color,fillColor:ft.style.fillColor,weight:ft.style.weight,fillOpacity:ft.style.fillOpacity,radius:ft.style.radius}),$t.closePopup(),$t.unbindPopup(),$t.bindPopup($t.createPopupContent()),console.log("[handleNoteSave] Note mise à jour:",{name:$t.properties.name,category:$t.properties.category,accessLevel:$t.properties.accessLevel,columnId:$t.properties.columnId}),u.notes.find(vn=>vn.id===ft.id)?(u.updateNote(ft.id,{title:ft.title,description:ft.description,columnId:ft.columnId,accessLevel:ft.accessLevel,style:ft.style,updatedAt:new Date().toISOString()}),console.log("[handleNoteSave] Note mise à jour dans le store avec columnId:",ft.columnId)):(u.addNote({title:ft.title,description:ft.description,location:[ft.location[0],ft.location[1]],columnId:ft.columnId||"1",style:ft.style,accessLevel:ft.accessLevel}),console.log("[handleNoteSave] Note ajoutée au store avec columnId:",ft.columnId||"1")))}f.success("Note enregistrée avec succès")}async function Or(ft){var Qe;Te.value=ft,Q.value=!0;try{const $t={visiteur:ft.id};W.isEntreprise?$t.entreprise=(Qe=W.user)==null?void 0:Qe.id:un.value&&($t.entreprise=un.value.id),we.value&&($t.salarie=we.value.id);const xn=await Gn.get("/plans/",{params:$t});ie.value=xn.data}catch($t){console.error("[MapView] Error loading client plans:",$t),ie.value=[]}finally{Q.value=!1}}async function gr(){var Qe;console.log("[MapView][loadPlansWithoutVisiteur] Chargement des plans sans visiteur");const ft={id:-1,username:"sans_visiteur",first_name:"Sans",last_name:"Visiteur",company_name:"",role:"VISITEUR",display_name:"Plans sans visiteur"};Te.value=ft,Q.value=!0;try{const $t={visiteur_null:!0};W.isEntreprise?$t.entreprise=(Qe=W.user)==null?void 0:Qe.id:un.value&&($t.entreprise=un.value.id),we.value&&($t.salarie=we.value.id),console.log("[MapView][loadPlansWithoutVisiteur] Paramètres de requête:",$t);const xn=await Gn.get("/plans/",{params:$t});console.log("[MapView][loadPlansWithoutVisiteur] Plans reçus:",xn.data),ie.value=xn.data}catch($t){console.error("[MapView] Error loading plans without visiteur:",$t),ie.value=[]}finally{Q.value=!1}}function ii(ft,Qe,$t,xn,vn){if(!ft||ft.length===0)return xn;const bn=[...ft].sort((Rn,Qn)=>(Qn.surface||0)-(Rn.surface||0)),Ht=vn,Hn=7,St=6,mt=2,wn=[{header:"Nom",width:.3,align:"left"},{header:"Surface",width:.2,align:"right"},{header:"Angles",width:.25,align:"right"},{header:"Rayon",width:.15,align:"right"},{header:"Type",width:.1,align:"center"}],Qr=Hn+St*bn.length;Qe.setFillColor(248,250,252),Qe.setDrawColor(226,232,240),Qe.roundedRect($t,xn,Ht,Qr+mt*2,2,2,"FD"),Qe.setFillColor(241,245,249),Qe.rect($t+mt,xn+mt,Ht-mt*2,Hn,"F"),Qe.setFont("helvetica","bold"),Qe.setFontSize(7),Qe.setTextColor(51,65,85);let Tt=$t+mt;return wn.forEach(Rn=>{const Qn=Rn.width*(Ht-mt*2);Rn.align==="right"?Qe.text(Rn.header,Tt+Qn-mt,xn+mt+5,{align:"right"}):Rn.align==="center"?Qe.text(Rn.header,Tt+Qn/2,xn+mt+5,{align:"center"}):Qe.text(Rn.header,Tt+mt/2,xn+mt+5),Tt+=Qn}),Qe.setFont("helvetica","normal"),Qe.setFontSize(6.5),Qe.setTextColor(71,85,105),bn.forEach((Rn,Qn)=>{const Pi=xn+Hn+mt+Qn*St;Qn%2===0&&(Qe.setFillColor(250,252,254),Qe.rect($t+mt,Pi,Ht-mt*2,St,"F"));let Sr=$t+mt;const Pr=Rn.name||`Section ${Qn+1}`;Qe.text(Pr,Sr+mt/2,Pi+4),Sr+=wn[0].width*(Ht-mt*2);const dr=He(Rn.surface||0,"m²");Qe.text(dr,Sr+wn[1].width*(Ht-mt*2)-mt,Pi+4,{align:"right"}),Sr+=wn[1].width*(Ht-mt*2);const Mi=Rn.startAngle===0&&Rn.endAngle===360?"Complet":`${Rn.startAngle}°-${Rn.endAngle}°`;Qe.text(Mi,Sr+wn[2].width*(Ht-mt*2)-mt,Pi+4,{align:"right"}),Sr+=wn[2].width*(Ht-mt*2);const wr=He(Rn.radius||0);Qe.text(wr,Sr+wn[3].width*(Ht-mt*2)-mt,Pi+4,{align:"right"}),Sr+=wn[3].width*(Ht-mt*2);const Gr=Rn.startAngle===0&&Rn.endAngle===360?"C":"P";Qe.text(Gr,Sr+wn[4].width*(Ht-mt*2)/2,Pi+4,{align:"center"})}),Qe.setDrawColor(226,232,240),Qe.setLineWidth(.05),Qe.line($t+mt,xn+Hn+mt,$t+Ht-mt,xn+Hn+mt),xn+Qr+mt*2}return(ft,Qe)=>{var $t,xn,vn,bn,Ht,Hn;return $e(),qe(Tn,null,[C("div",YF,[C("div",JF,[wt.value?($e(),qe("div",XF,Qe[9]||(Qe[9]=[$u('<div class="bg-white/90 rounded-2xl p-8 max-w-md shadow-2xl border border-gray-100"><div class="flex flex-col items-center"><div class="relative w-24 h-24 mb-6"><div class="absolute inset-0 border-4 border-primary-200 rounded-full"></div><div class="absolute inset-0 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"></div><div class="absolute inset-2 border-2 border-primary-400/30 rounded-full animate-pulse"></div><div class="absolute inset-0 flex items-center justify-center"><svg class="w-8 h-8 text-primary-600 animate-bounce" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div></div><h3 class="text-xl font-semibold text-gray-900 mb-2"> Génération de la synthèse </h3><div class="space-y-2 text-center"><p class="text-primary-600 font-medium"> Capture des formes en cours... </p><p class="text-sm text-gray-500"> Nous optimisons la qualité de vos captures pour un rendu parfait </p></div></div></div>',1)]))):pn("",!0),T.value?pn("",!0):($e(),qe("div",QF,[C("div",e9,[Qe[12]||(Qe[12]=$u('<div class="relative w-48 h-48 mx-auto mb-12 rounded-full bg-gradient-to-br from-primary-100 to-primary-50 p-8 shadow-lg ring-4 ring-white"><img src="'+ib+'" alt="TagMap Logo" class="w-full h-full object-contain filter drop-shadow-md"><div class="absolute inset-0 rounded-full bg-gradient-to-t from-transparent to-white/10 pointer-events-none"></div></div><h1 class="text-3xl font-bold text-gray-900 mb-4">Bienvenue sur TagMap</h1><p class="text-gray-600 mb-8">Pour commencer à dessiner, vous devez d&#39;abord créer un nouveau plan ou charger un plan existant.</p>',3)),C("div",t9,[C("button",{onClick:Qe[0]||(Qe[0]=St=>z.value=!0),class:"w-full flex items-center justify-center px-4 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors duration-200"},Qe[10]||(Qe[10]=[C("svg",{class:"w-6 h-6 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),Li(" Créer un nouveau plan ")])),C("button",{onClick:Qe[1]||(Qe[1]=St=>U.value=!0),class:"w-full flex items-center justify-center px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors duration-200"},Qe[11]||(Qe[11]=[C("svg",{class:"w-6 h-6 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),Li(" Charger un plan existant ")]))])])])),Fn(C("div",n9,[T.value&&!wt.value?($e(),qe("div",r9,[di(LB,{"last-save":($t=T.value)!=null&&$t.date_modification?new Date(T.value.date_modification):void 0,"plan-name":(xn=T.value)==null?void 0:xn.nom,"plan-description":(vn=T.value)==null?void 0:vn.description,"save-status":$.value,onChangeMapType:Kn(ve),onCreateNewPlan:Qe[2]||(Qe[2]=St=>z.value=!0),onLoadPlan:Qe[3]||(Qe[3]=St=>U.value=!0),onSavePlan:ye,onAdjustView:Ge,onGenerateSummary:kt},null,8,["last-save","plan-name","plan-description","save-status","onChangeMapType"])])):pn("",!0),C("div",i9,[i.value&&T.value&&!wt.value?($e(),qe("div",{key:0,onClick:Me,class:"md:hidden fixed inset-0 bg-black/30 z-[1800] transition-opacity duration-300"})):pn("",!0),T.value&&!wt.value?($e(),qe("div",{key:1,class:"md:hidden fixed left-0 right-0 z-[1900] bg-white py-3 px-3 shadow-lg border-t border-gray-200 flex items-center justify-between cursor-pointer",style:{height:"var(--mobile-bottom-toolbar-height)",bottom:"0"},onClick:Me},Qe[13]||(Qe[13]=[$u('<div class="flex items-center w-full justify-center"><div class="flex items-center space-x-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"></path></svg><span class="text-sm text-gray-500 font-medium">Outils de dessin</span></div></div>',1)]))):pn("",!0),C("div",o9,[C("div",{ref_key:"mapContainer",ref:r,class:"absolute inset-0 z-[1000]"},null,512)]),T.value&&!wt.value?($e(),qe("div",{key:2,class:Vi([i.value?"translate-y-0":"translate-y-full md:translate-y-0","w-full md:w-64 bg-white border-t md:border-t-0 border-gray-200 flex-shrink-0 z-[2000] transition-transform duration-300 ease-out","fixed md:relative bottom-0 md:bottom-auto right-0 md:top-0 h-[80%] md:h-auto rounded-t-xl md:rounded-none shadow-lg md:shadow-none"]),style:{bottom:"var(--mobile-bottom-toolbar-height)"}},[C("div",{class:"md:hidden w-full flex justify-between items-center px-4 py-2 border-b border-gray-200 cursor-pointer",onClick:Me},Qe[14]||(Qe[14]=[$u('<div class="flex items-center"><div class="w-10 h-1.5 bg-gray-300 rounded-full mr-3"></div></div><button class="p-1.5 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>',2)])),di(UO,{"current-tool":Kn(_),"selected-shape":pe.value,"all-layers":((bn=Kn(R))==null?void 0:bn.getLayers())||[],onToolChange:Kn(k),onStyleUpdate:Kn(F),onPropertiesUpdate:de,onDeleteShape:tt,onFilterChange:Mn,onCloseDrawer:Qe[4]||(Qe[4]=St=>i.value=!1)},null,8,["current-tool","selected-shape","all-layers","onToolChange","onStyleUpdate"])],2)):pn("",!0)]),wt.value?($e(),qe("div",s9,Qe[15]||(Qe[15]=[$u('<div class="text-center"><div class="mb-4"><svg class="animate-spin h-10 w-10 mx-auto text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></div><p class="text-lg font-medium text-gray-900">Génération de la synthèse en cours...</p><p class="text-sm text-gray-500 mt-2">Veuillez patienter pendant que nous analysons votre plan.</p></div>',1)]))):pn("",!0)],512),[[Hm,T.value]]),($e(),rl(kv,{to:"body"},[di(dx,{ref_key:"newPlanModalRef",ref:ue,modelValue:z.value,"onUpdate:modelValue":Qe[5]||(Qe[5]=St=>z.value=St),onCreated:Ze,onSalarieSelected:Qe[6]||(Qe[6]=St=>we.value=St),onVisiteurSelected:Qe[7]||(Qe[7]=St=>Ce.value=St)},null,8,["modelValue"])])),($e(),rl(kv,{to:"body"},[U.value?($e(),qe("div",a9,[C("div",l9,[C("div",u9,[Qe[17]||(Qe[17]=C("h2",{class:"text-xl font-semibold text-gray-900"},"Charger un plan existant",-1)),C("button",{onClick:Qe[8]||(Qe[8]=St=>U.value=!1),class:"text-gray-400 hover:text-gray-500 focus:outline-none"},Qe[16]||(Qe[16]=[C("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),C("div",c9,[Kn(W).isAdmin?($e(),qe("div",f9,[un.value?we.value?Te.value?($e(),qe("div",A9,[C("div",k9,[C("button",{onClick:ar,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},Qe[33]||(Qe[33]=[C("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),Li(" Retour à la liste des clients ")])),Qe[34]||(Qe[34]=C("span",{class:"mx-2 text-gray-400"},"|",-1)),C("span",T9,Zt(Ft(Te.value)),1)]),Qe[36]||(Qe[36]=C("h3",{class:"font-medium text-gray-700"},"Plans disponibles",-1)),C("div",N9,[Q.value?($e(),qe(Tn,{key:0},Lr(3,St=>C("div",{key:St,class:"animate-pulse"},Qe[35]||(Qe[35]=[C("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[C("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),C("div",{class:"h-4 bg-gray-100 rounded w-2/3 mb-2"}),C("div",{class:"h-3 bg-gray-50 rounded w-1/3"})],-1)]))),64)):($e(!0),qe(Tn,{key:1},Lr(ie.value,St=>($e(),qe("button",{key:St.id,onClick:mt=>ne(St.id),class:"w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[C("div",I9,Zt(St.nom),1),C("div",O9,Zt(St.description),1),C("div",B9," Modifié le "+Zt(We(St.date_modification)),1)],8,D9))),128))])])):($e(),qe("div",x9,[C("div",L9,[C("button",{onClick:Nn,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},Qe[26]||(Qe[26]=[C("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),Li(" Retour à la liste des salaries ")])),Qe[27]||(Qe[27]=C("span",{class:"mx-2 text-gray-400"},"|",-1)),C("span",S9,Zt(Ft(we.value)),1)]),Qe[32]||(Qe[32]=C("h3",{class:"font-medium text-gray-700"},"Sélectionnez un visiteur",-1)),C("div",E9,[C("button",{onClick:gr,class:"flex items-center p-3 text-left bg-primary-50 hover:bg-primary-100 rounded-lg border border-primary-200 transition-colors duration-200"},Qe[28]||(Qe[28]=[C("div",null,[C("div",{class:"font-medium text-primary-700"},"Plans sans visiteur"),C("div",{class:"text-xs text-primary-600"},"Afficher les plans créés sans visiteur associé")],-1),C("svg",{class:"w-5 h-5 ml-auto text-primary-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])),H.value?($e(),qe(Tn,{key:0},Lr(3,St=>C("div",{key:St,class:"animate-pulse"},Qe[29]||(Qe[29]=[C("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[C("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),C("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):($e(),qe(Tn,{key:1},[le.value.length===0?($e(),qe("div",C9,Qe[30]||(Qe[30]=[C("div",{class:"text-gray-500 mb-2"},"Aucun visiteur trouvé pour ce salarie",-1),C("div",{class:"text-sm text-gray-400"},` Vous pouvez utiliser l'option "Plans sans visiteur" ci-dessus `,-1)]))):($e(!0),qe(Tn,{key:1},Lr(le.value,St=>($e(),qe("button",{key:St.id,onClick:mt=>Or(St),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[C("div",null,[C("div",M9,Zt(Ft(St)),1)]),Qe[31]||(Qe[31]=C("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,P9))),128))],64))])])):($e(),qe("div",m9,[C("div",v9,[C("button",{onClick:Ln,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},Qe[21]||(Qe[21]=[C("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),Li(" Retour à la liste des entreprises ")])),Qe[22]||(Qe[22]=C("span",{class:"mx-2 text-gray-400"},"|",-1)),C("span",y9,Zt(Ft(un.value)),1)]),Qe[25]||(Qe[25]=C("h3",{class:"font-medium text-gray-700"},"Sélectionnez un salarie",-1)),C("div",_9,[Y.value?($e(),qe(Tn,{key:0},Lr(3,St=>C("div",{key:St,class:"animate-pulse"},Qe[23]||(Qe[23]=[C("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[C("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),C("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):($e(!0),qe(Tn,{key:1},Lr(rt.value,St=>($e(),qe("button",{key:St.id,onClick:mt=>En(St),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[C("div",null,[C("div",w9,Zt(Ft(St)),1)]),Qe[24]||(Qe[24]=C("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,b9))),128))])])):($e(),qe("div",h9,[Qe[20]||(Qe[20]=C("h3",{class:"font-medium text-gray-700"},"Sélectionnez une entreprise",-1)),C("div",d9,[Ke.value?($e(),qe(Tn,{key:0},Lr(3,St=>C("div",{key:St,class:"animate-pulse"},Qe[18]||(Qe[18]=[C("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[C("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),C("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):($e(!0),qe(Tn,{key:1},Lr(ot.value,St=>($e(),qe("button",{key:St.id,onClick:mt=>Bn(St),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[C("div",null,[C("div",g9,Zt(Ft(St)),1)]),Qe[19]||(Qe[19]=C("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,p9))),128))])]))])):Kn(W).isSalarie?($e(),qe("div",R9,[Te.value?($e(),qe("div",V9,[C("div",G9,[C("button",{onClick:ar,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},Qe[41]||(Qe[41]=[C("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),Li(" Retour à la liste des clients ")])),Qe[42]||(Qe[42]=C("span",{class:"mx-2 text-gray-400"},"|",-1)),C("span",H9,Zt(Ft(Te.value)),1)]),Qe[44]||(Qe[44]=C("h3",{class:"font-medium text-gray-700"},"Plans disponibles",-1)),C("div",q9,[Q.value?($e(),qe(Tn,{key:0},Lr(3,St=>C("div",{key:St,class:"animate-pulse"},Qe[43]||(Qe[43]=[C("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[C("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),C("div",{class:"h-4 bg-gray-100 rounded w-2/3 mb-2"}),C("div",{class:"h-3 bg-gray-50 rounded w-1/3"})],-1)]))),64)):($e(!0),qe(Tn,{key:1},Lr(ie.value,St=>($e(),qe("button",{key:St.id,onClick:mt=>ne(St.id),class:"w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[C("div",Z9,Zt(St.nom),1),C("div",K9,Zt(St.description),1),C("div",Y9," Modifié le "+Zt(We(St.date_modification)),1)],8,W9))),128))])])):($e(),qe("div",F9,[Qe[40]||(Qe[40]=C("h3",{class:"font-medium text-gray-700"},"Sélectionnez un visiteur",-1)),C("div",j9,[H.value?($e(),qe(Tn,{key:0},Lr(3,St=>C("div",{key:St,class:"animate-pulse"},Qe[37]||(Qe[37]=[C("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[C("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),C("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):($e(),qe(Tn,{key:1},[le.value.length===0?($e(),qe("div",z9,Qe[38]||(Qe[38]=[C("div",{class:"text-gray-500 mb-2"},"Aucun visiteur trouvé pour ce salarie",-1),C("div",{class:"text-sm text-gray-400"}," Veuillez vérifier que des visiteurs ont été assignés à ce salarie ",-1)]))):($e(!0),qe(Tn,{key:1},Lr(le.value,St=>($e(),qe("button",{key:St.id,onClick:mt=>Or(St),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[C("div",null,[C("div",U9,Zt(Ft(St)),1)]),Qe[39]||(Qe[39]=C("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,$9))),128))],64))])]))])):Kn(W).isEntreprise?($e(),qe("div",J9,Zt(Kn(W).isEntreprise?"...":""),1)):($e(),qe("div",X9,[Kn(s).plans.length===0?($e(),qe("div",Q9,Qe[45]||(Qe[45]=[C("p",{class:"text-gray-500"},"Aucun plan disponible",-1)]))):($e(),qe("div",ej,[($e(!0),qe(Tn,null,Lr(Kn(s).plans,St=>($e(),qe("button",{key:St.id,onClick:mt=>ne(St.id),class:"w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[C("div",nj,Zt(St.nom),1),C("div",rj,Zt(St.description),1),C("div",ij," Modifié le "+Zt(We(St.date_modification)),1)],8,tj))),128))]))]))])])])):pn("",!0)]))])]),J.value?($e(),rl(fx,{key:0,note:D.value,"is-new-note":!((Ht=D.value)!=null&&Ht.id),location:(Hn=D.value)==null?void 0:Hn.location,onClose:jn,onSave:br},null,8,["note","is-new-note","location"])):pn("",!0)],64)}}}),oj={class:"fixed inset-0 z-[3001] overflow-y-auto"},sj={class:"flex items-center justify-center min-h-screen w-full p-0"},aj={class:"relative bg-white w-full h-full max-h-full overflow-y-auto md:rounded-lg md:max-w-4xl md:h-auto md:max-h-[90vh] md:my-8 shadow-xl transform transition-all",role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"},lj={class:"p-4 md:p-6"},uj={class:"flex justify-between items-center mb-4 border-b pb-4"},cj={class:"text-xl font-semibold text-gray-900",id:"modal-headline"},fj={class:"mt-4"},hj={key:0,class:"mb-4 rounded-md bg-red-50 p-4"},dj={class:"flex"},pj={class:"ml-3"},gj={class:"text-sm font-medium text-red-800"},mj={key:0},vj={key:1},yj=["value"],_j={key:2},bj={key:3},wj=["value"],xj={class:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-2"},Lj={key:0,class:"mt-2 text-sm text-red-600"},Sj={key:0,class:"mt-2 text-sm text-red-600"},Ej={key:4},Cj={class:"flex items-center"},Pj={key:5},Mj={key:6},Aj={key:0,class:"mt-2 text-sm text-red-600"},kj={class:"flex justify-end space-x-3"},Tj=["disabled"],Nj={key:0,class:"mr-2"},Dj=ds({__name:"UserFormModal",props:{user:{type:Object,default:()=>({})},salaries:{type:Array,default:()=>[]},entreprises:{type:Array,default:()=>[]},isAdmin:{type:Boolean,default:!1},isEntreprise:{type:Boolean,default:!1},currentSalarie:{type:String,default:void 0},currentEntreprise:{type:String,default:void 0},apiErrors:{type:Array,default:()=>[]},refreshKey:{type:Number,default:0}},emits:["close","save","refresh"],setup(e,{emit:n}){const t=e,r=n,i=zt(!1),s=zt(""),o=zt(""),u=zt(""),f=zt(""),d=zt(""),m=Yl({id:void 0,first_name:"",last_name:"",username:"",email:"",password:"",company_name:"",role:t.isEntreprise?"SALARIE":t.isAdmin?"ADMIN":"VISITEUR",salarie:null,entreprise:null,is_active:!0,storage_quota:50,storage_used:0});Cs(()=>{var w;(w=t.user)!=null&&w.id?(m.id=t.user.id,m.first_name=t.user.first_name||"",m.last_name=t.user.last_name||"",m.username=t.user.username||"",m.email=t.user.email||"",m.company_name=t.user.company_name||"",m.role=t.user.role||"VISITEUR",m.is_active=t.user.is_active??!0,t.user.salarie?typeof t.user.salarie=="object"?m.salarie=t.user.salarie.id:m.salarie=t.user.salarie:t.user.salarie_id?m.salarie=t.user.salarie_id:t.currentSalarie&&(m.salarie=parseInt(t.currentSalarie)),t.user.entreprise?typeof t.user.entreprise=="object"?m.entreprise=t.user.entreprise.id:m.entreprise=t.user.entreprise:t.user.entreprise_id?m.entreprise=t.user.entreprise_id:t.currentEntreprise&&(m.entreprise=parseInt(t.currentEntreprise))):(t.currentSalarie&&(m.salarie=parseInt(t.currentSalarie)),t.currentEntreprise&&(m.entreprise=parseInt(t.currentEntreprise)),t.isEntreprise?m.role="SALARIE":t.isAdmin||(m.role="VISITEUR"))}),wp(()=>{m.role==="ADMIN"||m.role==="ENTREPRISE"?(m.salarie=null,m.entreprise=null):m.role==="SALARIE"&&(m.salarie=null,t.isEntreprise&&t.currentEntreprise&&(m.entreprise=parseInt(t.currentEntreprise)))}),wp(()=>{s.value="",o.value="",u.value="",f.value="",t.apiErrors&&t.apiErrors.length>0&&t.apiErrors.forEach(w=>{switch(w.field){case"email":s.value=w.message;break;case"username":o.value=w.message;break;case"password":u.value=w.message;break;case"non_field_error":default:f.value=w.message;break}})});async function _(){s.value="",o.value="",u.value="",f.value="";let w=!0;if(m.id||(m.password!==d.value?(u.value="Les mots de passe ne correspondent pas",w=!1):m.password.length<8&&(u.value="Le mot de passe doit contenir au moins 8 caractères",w=!1)),!!w){i.value=!0;try{const y={...m};m.id&&delete y.password,t.isEntreprise&&["SALARIE","VISITEUR"].includes(m.role)&&(y.entreprise_id=t.currentEntreprise?parseInt(t.currentEntreprise):void 0),y.salarie&&(y.salarie_id=y.salarie,delete y.salarie),t.currentSalarie&&m.role==="VISITEUR"&&(y.salarie_id=parseInt(t.currentSalarie)),await r("save",y),r("refresh")}catch(y){console.error("Erreur locale:",y)}finally{i.value=!1}}}return(w,y)=>($e(),qe("div",oj,[C("div",sj,[y[35]||(y[35]=C("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[C("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),C("div",aj,[C("div",null,[C("div",lj,[C("div",uj,[C("h3",cj,Zt(e.user?"Modifier l'utilisateur":"Nouvel utilisateur"),1),C("button",{type:"button",onClick:y[0]||(y[0]=M=>w.$emit("close")),class:"text-gray-400 hover:text-gray-500"},y[14]||(y[14]=[C("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),C("div",fj,[f.value?($e(),qe("div",hj,[C("div",dj,[y[15]||(y[15]=C("div",{class:"flex-shrink-0"},[C("svg",{class:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[C("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),C("div",pj,[C("h3",gj,Zt(f.value),1)])])])):pn("",!0),C("form",{onSubmit:Gc(_,["prevent"]),class:"space-y-6"},[e.isAdmin?($e(),qe("div",mj,[y[17]||(y[17]=C("label",{for:"role",class:"block text-sm font-medium text-gray-700"},"Type d'utilisateur",-1)),Fn(C("select",{id:"role","onUpdate:modelValue":y[1]||(y[1]=M=>m.role=M),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:""},y[16]||(y[16]=[C("option",{value:"ADMIN"},"Administrateur",-1),C("option",{value:"ENTREPRISE"},"Entreprise",-1),C("option",{value:"SALARIE"},"Salarie",-1),C("option",{value:"VISITEUR"},"Visiteur",-1)]),512),[[vo,m.role]])])):pn("",!0),e.isAdmin&&m.role==="SALARIE"?($e(),qe("div",vj,[y[19]||(y[19]=C("label",{for:"entreprise",class:"block text-sm font-medium text-gray-700"},"Entreprise",-1)),Fn(C("select",{id:"entreprise","onUpdate:modelValue":y[2]||(y[2]=M=>m.entreprise=M),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},[y[18]||(y[18]=C("option",{value:null},"-- Sélectionner une entreprise --",-1)),($e(!0),qe(Tn,null,Lr(e.entreprises,M=>($e(),qe("option",{key:M.id,value:M.id},Zt(M.first_name)+" "+Zt(M.last_name)+" ("+Zt(M.company_name||"Entreprise")+") ",9,yj))),128))],512),[[vo,m.entreprise]])])):pn("",!0),e.isEntreprise&&!m.id?($e(),qe("div",_j,[y[21]||(y[21]=C("label",{for:"role",class:"block text-sm font-medium text-gray-700"},"Type d'utilisateur",-1)),Fn(C("select",{id:"role","onUpdate:modelValue":y[3]||(y[3]=M=>m.role=M),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:""},y[20]||(y[20]=[C("option",{value:"SALARIE"},"Salarie",-1),C("option",{value:"VISITEUR"},"Visiteur",-1)]),512),[[vo,m.role]])])):pn("",!0),(e.isAdmin||e.isEntreprise)&&m.role==="VISITEUR"&&!e.currentSalarie?($e(),qe("div",bj,[y[23]||(y[23]=C("label",{for:"salarie",class:"block text-sm font-medium text-gray-700"},"Salarie",-1)),Fn(C("select",{id:"salarie","onUpdate:modelValue":y[4]||(y[4]=M=>m.salarie=M),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:""},[y[22]||(y[22]=C("option",{value:null},"-- Sélectionner un salarie --",-1)),($e(!0),qe(Tn,null,Lr(e.salaries,M=>($e(),qe("option",{key:M.id,value:M.id},Zt(M.first_name)+" "+Zt(M.last_name)+" ("+Zt(M.company_name||"Salarie")+") ",9,wj))),128))],512),[[vo,m.salarie]])])):pn("",!0),C("div",xj,[C("div",null,[y[24]||(y[24]=C("label",{for:"first_name",class:"block text-sm font-medium text-gray-700"},"Prénom",-1)),Fn(C("input",{type:"text",id:"first_name","onUpdate:modelValue":y[5]||(y[5]=M=>m.first_name=M),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[ni,m.first_name]])]),C("div",null,[y[25]||(y[25]=C("label",{for:"last_name",class:"block text-sm font-medium text-gray-700"},"Nom",-1)),Fn(C("input",{type:"text",id:"last_name","onUpdate:modelValue":y[6]||(y[6]=M=>m.last_name=M),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[ni,m.last_name]])])]),C("div",null,[y[26]||(y[26]=C("label",{for:"email",class:"block text-sm font-medium text-gray-700"},"Email",-1)),Fn(C("input",{type:"email",id:"email","onUpdate:modelValue":y[7]||(y[7]=M=>m.email=M),required:"",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[ni,m.email]]),s.value?($e(),qe("div",Lj,Zt(s.value),1)):pn("",!0)]),C("div",null,[y[27]||(y[27]=C("label",{for:"username",class:"block text-sm font-medium text-gray-700"},"Nom d'utilisateur",-1)),Fn(C("input",{type:"text",id:"username","onUpdate:modelValue":y[8]||(y[8]=M=>m.username=M),required:"",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[ni,m.username]]),o.value?($e(),qe("div",Sj,Zt(o.value),1)):pn("",!0)]),C("div",null,[y[28]||(y[28]=C("label",{for:"company_name",class:"block text-sm font-medium text-gray-700"},"Entreprise",-1)),Fn(C("input",{type:"text",id:"company_name","onUpdate:modelValue":y[9]||(y[9]=M=>m.company_name=M),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[ni,m.company_name]])]),m.role==="ENTREPRISE"||m.role==="SALARIE"?($e(),qe("div",Ej,[y[30]||(y[30]=C("label",{for:"storage_quota",class:"block text-sm font-medium text-gray-700"},"Quota de stockage (MB)",-1)),C("div",Cj,[Fn(C("input",{type:"number",id:"storage_quota","onUpdate:modelValue":y[10]||(y[10]=M=>m.storage_quota=M),min:"1",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[ni,m.storage_quota]]),y[29]||(y[29]=C("span",{class:"ml-2 text-sm text-gray-500"},"MB",-1))]),y[31]||(y[31]=C("p",{class:"mt-1 text-sm text-gray-500"},"Espace de stockage maximum pour les photos des notes",-1))])):pn("",!0),m.id?pn("",!0):($e(),qe("div",Pj,[y[32]||(y[32]=C("label",{for:"password",class:"block text-sm font-medium text-gray-700"},"Mot de passe",-1)),Fn(C("input",{type:"password",id:"password","onUpdate:modelValue":y[11]||(y[11]=M=>m.password=M),required:"",autocomplete:"new-password",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[ni,m.password]])])),m.id?pn("",!0):($e(),qe("div",Mj,[y[33]||(y[33]=C("label",{for:"password_confirm",class:"block text-sm font-medium text-gray-700"},"Confirmer le mot de passe",-1)),Fn(C("input",{type:"password",id:"password_confirm","onUpdate:modelValue":y[12]||(y[12]=M=>d.value=M),required:"",autocomplete:"new-password",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[ni,d.value]]),u.value?($e(),qe("div",Aj,Zt(u.value),1)):pn("",!0)])),C("div",kj,[C("button",{type:"button",onClick:y[13]||(y[13]=M=>w.$emit("close")),class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"}," Annuler "),C("button",{type:"submit",disabled:i.value,class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},[i.value?($e(),qe("span",Nj,y[34]||(y[34]=[C("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[C("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),C("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):pn("",!0),Li(" "+Zt(m.id?"Enregistrer":"Créer"),1)],8,Tj)])],32)])])])])])]))}}),Ij={class:"fixed inset-0 z-[3001] overflow-y-auto"},Oj={class:"flex items-center justify-center min-h-screen w-full"},Bj={class:"relative bg-white w-full h-full md:rounded-lg md:max-w-lg md:h-auto md:max-h-[90vh] md:my-8 shadow-xl transform transition-all overflow-hidden",role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"},Rj={class:"p-4 md:p-6"},Fj={class:"flex items-start"},jj={class:"ml-4 flex-1"},zj={class:"text-lg leading-6 font-medium text-gray-900",id:"modal-headline"},$j={class:"mt-2"},Uj={class:"text-sm text-gray-500"},Vj={class:"mt-6 flex flex-col-reverse sm:flex-row-reverse sm:justify-end gap-3"},Ox=ds({__name:"ConfirmationModal",props:{title:{type:String,required:!0},message:{type:String,required:!0}},emits:["confirm","cancel"],setup(e){return(n,t)=>($e(),qe("div",Ij,[C("div",Oj,[t[3]||(t[3]=C("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[C("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),C("div",Bj,[C("div",Rj,[C("div",Fj,[t[2]||(t[2]=C("div",{class:"flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100"},[C("svg",{class:"h-6 w-6 text-red-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),C("div",jj,[C("h3",zj,Zt(e.title),1),C("div",$j,[C("p",Uj,Zt(e.message),1)])])]),C("div",Vj,[C("button",{type:"button",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:w-auto sm:text-sm",onClick:t[0]||(t[0]=r=>n.$emit("confirm"))}," Confirmer "),C("button",{type:"button",class:"w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:w-auto sm:text-sm",onClick:t[1]||(t[1]=r=>n.$emit("cancel"))}," Annuler ")])])])])]))}}),Gj={class:"h-full bg-gray-50"},Hj={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},qj={class:"flex justify-between items-center mb-8"},Wj={class:"text-3xl font-extrabold text-gray-900"},Zj={key:0},Kj={key:1},Yj={key:2},Jj={key:0},Xj={key:1},Qj={key:2},ez={class:"bg-white shadow rounded-lg mb-6 p-4"},tz={class:"space-y-4"},nz={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},rz={key:0},iz={key:0,value:"ADMIN"},oz={key:1,value:"ENTREPRISE"},sz={key:1},az=["value"],lz={key:2},uz=["value"],cz={class:"w-full"},fz={class:"bg-white shadow rounded-lg"},hz={class:"overflow-x-auto"},dz={class:"min-w-full divide-y divide-gray-200"},pz={class:"bg-gray-50"},gz={key:0,scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},mz={key:1,scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},vz={class:"bg-white divide-y divide-gray-200"},yz={key:0,class:"animate-pulse"},_z={key:1},bz={class:"px-6 py-4 whitespace-nowrap"},wz={class:"flex items-center"},xz={class:"flex-shrink-0 h-10 w-10"},Lz={class:"h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center"},Sz={class:"text-primary-600 font-medium"},Ez={class:"ml-4"},Cz={class:"text-sm font-medium text-gray-900"},Pz={class:"text-sm text-gray-500"},Mz={class:"px-6 py-4 whitespace-nowrap"},Az={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},kz={key:0,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Tz={key:1,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Nz={class:"px-6 py-4 whitespace-nowrap"},Dz={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Iz=["onClick"],Oz=["onClick"],Bz={key:0,class:"fixed inset-0 z-[3001] overflow-y-auto"},Rz=ds({__name:"UserListView",setup(e){const n=ma(),t=vu(),r=zt([]),i=zt([]),s=zt([]),o=zt(!1),u=zt(!1),f=zt(null),d=zt(null),m=zt(!0),_=zt([]),w=Yl({role:"",search:"",salarie:"",entreprise:""}),y=sr(()=>n.isAdmin),M=sr(()=>n.isEntreprise),k=sr(()=>n.isSalarie),F=sr(()=>y.value?r.value.filter($=>$.role==="SALARIE"):M.value?r.value.filter($=>{var W,G;return $.role==="SALARIE"&&((W=$.entreprise)==null?void 0:W.id)===((G=n.user)==null?void 0:G.id)}):[]),I=sr(()=>{let $=r.value;if(M.value&&($=$.filter(W=>{var G,oe,ie,we,Ce;return W.role==="SALARIE"?((G=W.entreprise)==null?void 0:G.id)===((oe=n.user)==null?void 0:oe.id):W.role==="VISITEUR"?((we=(ie=W.salarie)==null?void 0:ie.entreprise)==null?void 0:we.id)===((Ce=n.user)==null?void 0:Ce.id):!1})),k.value&&($=$.filter(W=>{var G,oe;return W.role==="VISITEUR"&&(W.salarie_id===((G=n.user)==null?void 0:G.id)||W.salarie&&W.salarie.id===((oe=n.user)==null?void 0:oe.id))})),(y.value||M.value)&&(w.role&&($=$.filter(W=>W.role===w.role)),w.salarie&&($=$.filter(W=>{var oe;const G=((oe=W.salarie)==null?void 0:oe.id)||W.salarie_id;return(G==null?void 0:G.toString())===w.salarie.toString()})),w.entreprise&&y.value&&($=$.filter(W=>{var G,oe,ie,we,Ce;return W.role==="SALARIE"?((oe=(G=W.entreprise)==null?void 0:G.id)==null?void 0:oe.toString())===w.entreprise.toString():W.role==="VISITEUR"?((Ce=(we=(ie=W.salarie)==null?void 0:ie.entreprise)==null?void 0:we.id)==null?void 0:Ce.toString())===w.entreprise.toString():!1}))),w.search){const W=w.search.toLowerCase();$=$.filter(G=>{var oe,ie,we,Ce;return((oe=G.username)==null?void 0:oe.toLowerCase().includes(W))||((ie=G.email)==null?void 0:ie.toLowerCase().includes(W))||((we=G.first_name)==null?void 0:we.toLowerCase().includes(W))||((Ce=G.last_name)==null?void 0:Ce.toLowerCase().includes(W))||G.company_name&&G.company_name.toLowerCase().includes(W)})}return $});Cs(async()=>{await R(),await K()});async function R(){var $,W,G;m.value=!0;try{if(y.value)r.value=await n.fetchUsers();else if(M.value){const[oe,ie]=await Promise.all([Bg({role:"SALARIE",entrepriseId:($=n.user)==null?void 0:$.id}),Bg({role:"VISITEUR",entrepriseId:(W=n.user)==null?void 0:W.id})]);r.value=[...oe,...ie]}else k.value&&(r.value=await Bg({role:"VISITEUR",salarieId:(G=n.user)==null?void 0:G.id,includeDetails:!0}),console.log("Visiteurs récupérés:",r.value))}catch(oe){console.error("Erreur lors de la récupération des utilisateurs:",oe),t.error("Erreur lors de la récupération des utilisateurs")}finally{m.value=!1}}async function K(){try{y.value?await Promise.all([ee(),fe()]):M.value&&await he()}catch($){console.error("Erreur lors de la récupération des dépendances:",$)}}async function ee(){var $;try{y.value?i.value=await n.fetchUsersByRole({role:"SALARIE"}):M.value&&(i.value=await n.fetchEntrepriseSalaries(($=n.user)==null?void 0:$.id))}catch(W){console.error("Erreur lors de la récupération des salaries:",W)}}async function he(){var $,W;if(!(!M.value||!(($=n.user)!=null&&$.id)))try{i.value=await n.fetchEntrepriseSalaries((W=n.user)==null?void 0:W.id)}catch(G){console.error("Erreur lors de la récupération des salaries de l'entreprise:",G)}}async function fe(){try{s.value=await n.fetchEnterprises()}catch($){console.error("Erreur lors de la récupération des entreprises:",$)}}function ve(){f.value=null,o.value=!0}function z($){f.value={...$},o.value=!0}function U(){o.value=!1,f.value=null,_.value=[]}async function J($){var G,oe,ie,we,Ce,Te;_.value=[];const W=!!$.id;try{const Y={...$};y.value?(Y.entreprise&&typeof Y.entreprise=="object"?Y.entreprise_id=Y.entreprise.id:typeof Y.entreprise=="number"&&(Y.entreprise_id=Y.entreprise),Y.salarie&&typeof Y.salarie=="object"?Y.salarie_id=Y.salarie.id:typeof Y.salarie=="number"&&(Y.salarie_id=Y.salarie)):M.value?(Y.entreprise_id=(G=n.user)==null?void 0:G.id,Y.role==="VISITEUR"&&(Y.salarie&&typeof Y.salarie=="object"?Y.salarie_id=Y.salarie.id:typeof Y.salarie=="number"&&(Y.salarie_id=Y.salarie))):k.value&&(Y.role="VISITEUR",Y.salarie_id=(oe=n.user)==null?void 0:oe.id),Y.role==="SALARIE"?((ie=Y.entreprise)!=null&&ie.id?(Y.entreprise_id=Y.entreprise.id,delete Y.entreprise):typeof Y.entreprise=="number"&&(Y.entreprise_id=Y.entreprise,delete Y.entreprise),delete Y.salarie):Y.role==="VISITEUR"&&((we=Y.salarie)!=null&&we.id?(Y.salarie_id=Y.salarie.id,delete Y.salarie):typeof Y.salarie=="number"&&(Y.salarie_id=Y.salarie,delete Y.salarie),delete Y.entreprise,delete Y.entreprise_id),W?(await n.updateUser($.id,Y),t.success("Utilisateur modifié avec succès")):(await n.createUser(Y),t.success("Utilisateur créé avec succès")),await Promise.all([R(),K()]),U()}catch(Y){console.error("Error saving user:",((Ce=Y.response)==null?void 0:Ce.data)||Y),_.value=tT(Y),t.error("Erreur lors de la sauvegarde de l'utilisateur");const H=((Te=Y.response)==null?void 0:Te.data)||{};let Q="";throw typeof H=="object"&&(Q=Object.entries(H).map(([ue,le])=>Array.isArray(le)?`${ue}: ${le[0]}`:`${ue}: ${le}`).filter(ue=>ue).join(`
`)),Q||(Q="Une erreur est survenue lors de la sauvegarde"),new Error(Q)}}function T($){d.value=$,u.value=!0}async function D(){if(d.value)try{await n.deleteUser(d.value.id),t.success("Utilisateur supprimé avec succès"),await Promise.all([R(),K()]),u.value=!1,d.value=null}catch($){throw console.error("Erreur lors de la suppression de l'utilisateur:",$),t.error("Erreur lors de la suppression de l'utilisateur"),$}}function B($){var W,G,oe,ie,we,Ce,Te,Y;return y.value?!0:M.value?$.role==="SALARIE"?((W=$.entreprise)==null?void 0:W.id)===((G=n.user)==null?void 0:G.id):$.role==="VISITEUR"?((ie=(oe=$.salarie)==null?void 0:oe.entreprise)==null?void 0:ie.id)===((we=n.user)==null?void 0:we.id):!1:k.value?$.role==="VISITEUR"&&($.salarie_id===((Ce=n.user)==null?void 0:Ce.id)||((Te=$.salarie)==null?void 0:Te.id)===((Y=n.user)==null?void 0:Y.id)):!1}return($,W)=>{var G,oe,ie,we;return $e(),qe("div",Gj,[C("div",Hj,[C("div",qj,[C("h1",Wj,[y.value?($e(),qe("span",Zj,"Gestion des utilisateurs")):M.value?($e(),qe("span",Kj,"Gestion des salaries et visiteurs")):k.value?($e(),qe("span",Yj,"Gestion des visiteurs")):pn("",!0)]),C("button",{onClick:ve,class:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},[W[5]||(W[5]=C("svg",{class:"-ml-1 mr-2 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[C("path",{"fill-rule":"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z","clip-rule":"evenodd"})],-1)),y.value?($e(),qe("span",Jj,"Nouvel utilisateur")):M.value?($e(),qe("span",Xj,"Nouveau salarie/visiteur")):k.value?($e(),qe("span",Qj,"Nouvel visiteur")):pn("",!0)])]),C("div",ez,[C("div",tz,[C("div",nz,[y.value||M.value?($e(),qe("div",rz,[W[9]||(W[9]=C("label",{for:"role-filter",class:"block text-sm font-medium text-gray-700"},"Rôle",-1)),Fn(C("select",{id:"role-filter","onUpdate:modelValue":W[0]||(W[0]=Ce=>w.role=Ce),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[W[6]||(W[6]=C("option",{value:""},"Tous les rôles",-1)),y.value?($e(),qe("option",iz,"Administrateur")):pn("",!0),y.value?($e(),qe("option",oz,"Entreprise")):pn("",!0),W[7]||(W[7]=C("option",{value:"SALARIE"},"Salarie",-1)),W[8]||(W[8]=C("option",{value:"VISITEUR"},"Visiteur",-1))],512),[[vo,w.role]])])):pn("",!0),y.value?($e(),qe("div",sz,[W[11]||(W[11]=C("label",{for:"entreprise-filter",class:"block text-sm font-medium text-gray-700"},"Entreprise",-1)),Fn(C("select",{id:"entreprise-filter","onUpdate:modelValue":W[1]||(W[1]=Ce=>w.entreprise=Ce),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[W[10]||(W[10]=C("option",{value:""},"Toutes les entreprises",-1)),($e(!0),qe(Tn,null,Lr(s.value,Ce=>($e(),qe("option",{key:Ce.id,value:Ce.id},Zt(Kn(Gl)(Ce)),9,az))),128))],512),[[vo,w.entreprise]])])):pn("",!0),y.value||M.value?($e(),qe("div",lz,[W[13]||(W[13]=C("label",{for:"salarie-filter",class:"block text-sm font-medium text-gray-700"},"Salarie",-1)),Fn(C("select",{id:"salarie-filter","onUpdate:modelValue":W[2]||(W[2]=Ce=>w.salarie=Ce),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[W[12]||(W[12]=C("option",{value:""},"Tous les salaries",-1)),($e(!0),qe(Tn,null,Lr(F.value,Ce=>($e(),qe("option",{key:Ce.id,value:Ce.id},Zt(Kn(Gl)(Ce)),9,uz))),128))],512),[[vo,w.salarie]])])):pn("",!0)]),C("div",cz,[W[14]||(W[14]=C("label",{for:"search",class:"block text-sm font-medium text-gray-700"},"Recherche",-1)),Fn(C("input",{type:"text",id:"search","onUpdate:modelValue":W[3]||(W[3]=Ce=>w.search=Ce),placeholder:"Rechercher par nom, email, entreprise...",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},null,512),[[ni,w.search]])])])]),C("div",fz,[C("div",hz,[C("table",dz,[C("thead",pz,[C("tr",null,[W[15]||(W[15]=C("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Utilisateur ",-1)),W[16]||(W[16]=C("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Rôle ",-1)),W[17]||(W[17]=C("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Email ",-1)),y.value||M.value?($e(),qe("th",gz," Entreprise ")):pn("",!0),y.value||M.value?($e(),qe("th",mz," Salarie ")):pn("",!0),W[18]||(W[18]=C("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Statut ",-1)),W[19]||(W[19]=C("th",{scope:"col",class:"relative px-6 py-3"},[C("span",{class:"sr-only"},"Actions")],-1))])]),C("tbody",vz,[m.value?($e(),qe("tr",yz,W[20]||(W[20]=[C("td",{colspan:"7",class:"py-4 px-6"},[C("div",{class:"h-4 bg-gray-200 rounded w-3/4"})],-1)]))):I.value.length===0?($e(),qe("tr",_z,W[21]||(W[21]=[C("td",{colspan:"7",class:"py-4 px-6 text-center text-gray-500"}," Aucun utilisateur trouvé ",-1)]))):pn("",!0),($e(!0),qe(Tn,null,Lr(I.value,Ce=>{var Te;return $e(),qe("tr",{key:Ce.id},[C("td",bz,[C("div",wz,[C("div",xz,[C("div",Lz,[C("span",Sz,Zt(Kn(rT)(Ce.first_name,Ce.last_name)),1)])]),C("div",Ez,[C("div",Cz,Zt(Kn(Gl)(Ce)),1),C("div",Pz,Zt(Ce.username),1)])])]),C("td",Mz,[C("span",{class:Vi(Kn(sT)())},Zt(Kn(oT)(Ce.role)),3)]),C("td",Az,Zt(Ce.email),1),y.value||M.value?($e(),qe("td",kz,[Ce.role==="ENTREPRISE"?($e(),qe(Tn,{key:0},[Li(" - ")],64)):Ce.role==="SALARIE"?($e(),qe(Tn,{key:1},[Li(Zt(Ce.entreprise?Kn(Gl)(Ce.entreprise):"Non assigné"),1)],64)):Ce.role==="VISITEUR"?($e(),qe(Tn,{key:2},[Li(Zt((Te=Ce.salarie)!=null&&Te.entreprise?Kn(Gl)(Ce.salarie.entreprise):"Non assigné"),1)],64)):($e(),qe(Tn,{key:3},[Li(" - ")],64))])):pn("",!0),y.value||M.value?($e(),qe("td",Tz,[Ce.role==="ENTREPRISE"||Ce.role==="ADMIN"?($e(),qe(Tn,{key:0},[Li(" - ")],64)):Ce.role==="SALARIE"?($e(),qe(Tn,{key:1},[Li(" - ")],64)):($e(),qe(Tn,{key:2},[Li(Zt(Ce.salarie?Kn(Gl)(Ce.salarie):"Non assigné"),1)],64))])):pn("",!0),C("td",Nz,[C("span",{class:Vi(Kn(aT)(Ce.is_active))},Zt(Ce.is_active?"Actif":"Inactif"),3)]),C("td",Dz,[C("button",{onClick:Y=>z(Ce),class:"text-primary-600 hover:text-primary-900 mr-4"}," Modifier ",8,Iz),B(Ce)?($e(),qe("button",{key:0,onClick:Y=>T(Ce),class:"text-red-600 hover:text-red-900"}," Supprimer ",8,Oz)):pn("",!0)])])}),128))])])])])]),o.value?($e(),qe("div",Bz,[di(Dj,{user:f.value,salaries:i.value,entreprises:s.value,"is-admin":y.value,"is-entreprise":M.value,"current-salarie":k.value?(oe=(G=Kn(n).user)==null?void 0:G.id)==null?void 0:oe.toString():void 0,"current-entreprise":M.value?(we=(ie=Kn(n).user)==null?void 0:ie.id)==null?void 0:we.toString():void 0,"api-errors":_.value,onClose:U,onSave:J},null,8,["user","salaries","entreprises","is-admin","is-entreprise","current-salarie","current-entreprise","api-errors"])])):pn("",!0),u.value?($e(),rl(Ox,{key:1,title:"Supprimer l'utilisateur",message:"Êtes-vous sûr de vouloir supprimer cet utilisateur ? Cette action est irréversible.",onConfirm:D,onCancel:W[4]||(W[4]=Ce=>u.value=!1)})):pn("",!0)])}}}),Fz={class:"h-full bg-gray-50"},jz={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},zz={class:"sm:flex sm:items-center"},$z={class:"sm:flex-auto"},Uz={class:"text-2xl font-semibold text-gray-900"},Vz={class:"mt-2 text-sm text-gray-700"},Gz={key:0,class:"mt-8"},Hz={class:"mb-6"},qz=["value"],Wz={class:"mb-6"},Zz={value:null},Kz=["value"],Yz={key:0,class:"mb-6"},Jz={value:null},Xz=["value"],Qz={key:1,class:"mt-8"},e$={class:"mb-6"},t$=["value"],n$={class:"mt-8"},r$={class:"overflow-hidden shadow-sm ring-1 ring-black ring-opacity-5 rounded-lg"},i$={class:"overflow-x-auto"},o$={class:"min-w-full divide-y divide-gray-300"},s$={class:"bg-gray-50"},a$={scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6 lg:pl-8"},l$={class:"ml-2 flex-none rounded"},u$={scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},c$={class:"ml-2 flex-none rounded"},f$={class:"divide-y divide-gray-200 bg-white"},h$={key:0},d$={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 lg:pl-8"},p$={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},g$={class:"px-3 py-4 text-sm text-gray-900"},m$={key:0,class:"flex items-center"},v$={class:"h-8 w-8 flex-shrink-0"},y$={class:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center"},_$={class:"text-primary-700 font-medium text-sm"},b$={class:"ml-3"},w$={class:"font-medium"},x$={key:1,class:"text-gray-500"},L$={class:"px-3 py-4 text-sm text-gray-900"},S$={key:0,class:"flex items-center"},E$={class:"h-8 w-8 flex-shrink-0"},C$={class:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center"},P$={class:"text-primary-700 font-medium text-sm"},M$={class:"ml-3"},A$={class:"font-medium"},k$={key:1,class:"text-gray-500"},T$={class:"px-3 py-4 text-sm text-gray-900"},N$={key:0,class:"flex items-center"},D$={class:"h-8 w-8 flex-shrink-0"},I$={class:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center"},O$={class:"text-primary-700 font-medium text-sm"},B$={class:"ml-3"},R$={class:"font-medium"},F$={key:1,class:"text-gray-500"},j$={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},z$={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6 lg:pr-8"},$$=["onClick"],U$=["onClick"],V$=["onClick"],G$={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[2000]"},H$={class:"bg-white rounded-lg p-6 max-w-md w-full"},q$={class:"flex justify-between items-center mb-4"},W$=["disabled"],Z$=["disabled"],K$={key:0,class:"space-y-4"},Y$={key:0},J$=["disabled"],X$=["value"],Q$=["disabled"],eU=["value"],tU={key:0,class:"mt-1 text-sm text-gray-500"},nU=["disabled"],rU=["value"],iU={key:0,class:"mt-1 text-sm text-gray-500"},oU={key:1,class:"mt-4 bg-red-50 p-4 rounded-md"},sU={class:"flex"},aU={class:"ml-3"},lU={class:"text-sm font-medium text-red-800"},uU={class:"mt-5 sm:mt-6 sm:grid sm:grid-cols-2 sm:gap-3"},cU=["disabled"],fU={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},hU=ds({__name:"PlansView",setup(e){const n=Bp(),t=py(),r=ma(),i=zt([]),s=zt([]),o=zt([]),u=zt([]),f=zt(!1),d=zt(!1),m=zt(!1),_=zt(null),w=zt({nom:"",description:"",client:null}),y=zt({id:0,nom:"",description:"",entreprise:null,salarie:null,visiteur:null}),M=zt(!1),k=zt(null),F=zt(null),I=zt(null),R=zt("date_modification"),K=zt("desc"),ee=zt(null),he=sr(()=>F.value?u.value.filter(Z=>typeof Z.salarie=="object"&&Z.salarie?Z.salarie.id===F.value:Z.salarie===F.value||Z.salarie_id===F.value):u.value),fe=sr(()=>{let Z=i.value;console.log(`
[PlansView] Filtering plans:`,Z.map(ke=>({id:ke.id,entreprise:ke.entreprise,salarie:ke.salarie,visiteur:ke.visiteur}))),r.isAdmin?(ee.value&&(Z=Z.filter(ke=>{var Me;return typeof ke.entreprise=="object"?((Me=ke.entreprise)==null?void 0:Me.id)===ee.value:ke.entreprise===ee.value})),F.value&&(Z=Z.filter(ke=>{var Me;return typeof ke.salarie=="object"?((Me=ke.salarie)==null?void 0:Me.id)===F.value:ke.salarie===F.value}),I.value&&(Z=Z.filter(ke=>{var Me;return typeof ke.visiteur=="object"?((Me=ke.visiteur)==null?void 0:Me.id)===I.value:ke.visiteur===I.value})))):r.isSalarie&&(Z=Z.filter(ke=>{var Me,Ue,ce;return typeof ke.salarie=="object"?((Me=ke.salarie)==null?void 0:Me.id)===((Ue=r.user)==null?void 0:Ue.id):ke.salarie===((ce=r.user)==null?void 0:ce.id)}),I.value&&(Z=Z.filter(ke=>{var Me;return typeof ke.visiteur=="object"?((Me=ke.visiteur)==null?void 0:Me.id)===I.value:ke.visiteur===I.value})));const N=[...Z].sort((ke,Me)=>{if(R.value==="nom")return K.value==="asc"?ke.nom.localeCompare(Me.nom):Me.nom.localeCompare(ke.nom);{const Ue=new Date(ke[R.value]).getTime(),ce=new Date(Me[R.value]).getTime();return K.value==="asc"?Ue-ce:ce-Ue}});return console.log("[PlansView] Final filtered and sorted plans:",N.map(ke=>({id:ke.id,entreprise:ke.entreprise,salarie:ke.salarie,visiteur:ke.visiteur}))),N}),ve=sr(()=>r.isAdmin?{title:"Tous les plans",description:"Liste complète des plans",plans:i.value}:r.isSalarie?{title:"Plans des visiteurs",description:"Plans où vous êtes assigné comme salarie",plans:i.value.filter(Z=>{var N,ke,Me;return typeof Z.salarie=="object"?((N=Z.salarie)==null?void 0:N.id)===((ke=r.user)==null?void 0:ke.id):Z.salarie===((Me=r.user)==null?void 0:Me.id)})}:{title:"Mes plans",description:"Plans qui vous sont assignés ou que vous avez créés",plans:i.value.filter(Z=>{var Me,Ue,ce,ne;const N=Z.createur.id===((Me=r.user)==null?void 0:Me.id);let ke=!1;return typeof Z.visiteur=="object"?ke=((Ue=Z.visiteur)==null?void 0:Ue.id)===((ce=r.user)==null?void 0:ce.id):ke=Z.visiteur===((ne=r.user)==null?void 0:ne.id),ke||N})}),z=sr(()=>ee.value?s.value.filter(Z=>{var N;return typeof Z.entreprise=="object"?((N=Z.entreprise)==null?void 0:N.id)===ee.value:Z.entreprise_id===ee.value}):s.value),U=sr(()=>y.value.entreprise?s.value.filter(Z=>{var N;return typeof Z.entreprise=="object"?((N=Z.entreprise)==null?void 0:N.id)===y.value.entreprise:Z.entreprise_id===y.value.entreprise}):[]),J=sr(()=>!y.value.entreprise||!y.value.salarie?[]:u.value.filter(Z=>typeof Z.salarie=="object"&&Z.salarie?Z.salarie.id===y.value.salarie:Z.salarie===y.value.salarie||Z.salarie_id===y.value.salarie));Cs(async()=>{var Z;await T(),r.isAdmin?await D():r.isSalarie&&await $(((Z=r.user)==null?void 0:Z.id)||0)});async function T(){try{const Z=await t.fetchPlansWithDetails();i.value=Z.data}catch(Z){console.error("Erreur lors du chargement des plans:",Z)}}async function D(){try{console.log("Chargement des entreprises..."),o.value=await r.fetchEnterprises(),console.log("Entreprises chargées:",o.value)}catch(Z){console.error("Erreur lors du chargement des entreprises:",Z)}}async function B(Z){try{if(console.log("Chargement des salaries pour l'entreprise:",Z),Z===void 0){const N=await r.fetchUsersByRole({role:"SALARIE"});s.value=N}else s.value=await r.fetchEntrepriseSalaries(Z);console.log("Salaries chargés:",s.value)}catch(N){console.error("Erreur lors du chargement des salaries:",N)}}async function $(Z){try{console.log("Chargement des visiteurs pour le salarie:",Z);const N=await Bg({role:"VISITEUR",salarieId:Z});u.value=N.map(ke=>({...ke,salarie_id:Z})),console.log("Visiteurs chargés:",u.value)}catch(N){console.error("Erreur lors du chargement des visiteurs:",N)}}function W(){f.value=!0,w.value={nom:"",description:"",client:null}}async function G(Z){console.log(`
[PlansView][editPlan] ====== DÉBUT ÉDITION PLAN ======`),console.log("[PlansView][editPlan] Plan reçu:",{id:Z.id,nom:Z.nom,entreprise:Z.entreprise,salarie:Z.salarie,visiteur:Z.visiteur});try{console.log("[PlansView][editPlan] Définition du plan courant dans le store..."),t.setCurrentPlan(Z),console.log("[PlansView][editPlan] Sauvegarde de l'ID dans localStorage:",Z.id),localStorage.setItem("lastPlanId",Z.id.toString()),console.log("[PlansView][editPlan] Redirection vers la vue carte..."),await n.push("/"),console.log(`[PlansView][editPlan] ====== FIN ÉDITION PLAN ======
`)}catch(N){console.error("[PlansView][editPlan] ERREUR:",N),N instanceof Error&&console.error("[PlansView][editPlan] Stack trace:",N.stack),alert("Une erreur est survenue lors du chargement du plan")}}async function oe(Z){Z!=null&&Z.id&&(_.value=Z,m.value=!0)}async function ie(){var Z,N;if((Z=_.value)!=null&&Z.id)try{await t.deletePlan(_.value.id),await T(),((N=t.currentPlan)==null?void 0:N.id)===_.value.id&&t.clearCurrentPlan()}catch(ke){console.error("Erreur lors de la suppression du plan:",ke),alert("Une erreur est survenue lors de la suppression du plan")}finally{m.value=!1,_.value=null}}function we(){m.value=!1,_.value=null}function Ce(Z){return new Date(Z).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}function Te(Z){if(!Z)return"";const N=Z.first_name||"",ke=Z.last_name||"";return(N.charAt(0)+ke.charAt(0)).toUpperCase()}async function Y(Z){M.value=!0,k.value=null;try{r.isAdmin&&!o.value.length&&await D();const N=typeof Z.entreprise=="object"&&Z.entreprise?Z.entreprise.id:Z.entreprise,ke=typeof Z.salarie=="object"&&Z.salarie?Z.salarie.id:Z.salarie,Me=typeof Z.visiteur=="object"&&Z.visiteur?Z.visiteur.id:Z.visiteur;y.value={id:Z.id,nom:Z.nom,description:Z.description,entreprise:N||null,salarie:ke||null,visiteur:Me||null},N&&await B(N),ke&&await $(ke),d.value=!0}catch(N){console.error("Erreur lors de l'ouverture du modal:",N),k.value="Erreur lors du chargement des données"}finally{M.value=!1}}async function H(){var Z,N,ke,Me,Ue;k.value=null,M.value=!0;try{if(!y.value.nom.trim())throw new Error("Le nom du plan est requis");if(y.value.visiteur&&!y.value.salarie)throw new Error("Un salarie doit être sélectionné pour assigner un visiteur");if(y.value.salarie&&!y.value.entreprise)throw new Error("Une entreprise doit être sélectionnée pour assigner un salarie");console.log("Données envoyées pour la mise à jour:",{id:y.value.id,nom:y.value.nom.trim(),description:y.value.description.trim(),entreprise_id:y.value.entreprise,salarie_id:y.value.salarie,visiteur_id:y.value.visiteur});const ce=await t.updatePlanDetails(y.value.id,{nom:y.value.nom.trim(),description:y.value.description.trim(),entreprise_id:y.value.entreprise,salarie_id:y.value.salarie,visiteur_id:y.value.visiteur});console.log("Réponse de la mise à jour:",ce),ce&&(d.value=!1,await T())}catch(ce){if(console.error("Erreur lors de la mise à jour du plan:",ce),(N=(Z=ce.response)==null?void 0:Z.data)!=null&&N.detail)k.value=ce.response.data.detail;else if((Me=(ke=ce.response)==null?void 0:ke.data)!=null&&Me.non_field_errors)k.value=ce.response.data.non_field_errors[0];else if((Ue=ce.response)!=null&&Ue.data){const ne=Object.entries(ce.response.data).map(([ye,de])=>`${ye}: ${Array.isArray(de)?de[0]:de}`);k.value=ne.join(`
`)}else k.value=ce.message||"Une erreur est survenue lors de la mise à jour du plan"}finally{M.value=!1}}oo(()=>ee.value,async Z=>{F.value=null,I.value=null,Z?await B(Z):await B()}),oo(()=>F.value,async Z=>{I.value=null,Z&&await $(Z)}),oo(()=>y.value.entreprise,async Z=>{Z===null?(y.value.salarie=null,y.value.visiteur=null):await B(Z)}),oo(()=>y.value.salarie,async Z=>{y.value.visiteur=null,Z&&await $(Z)});function Q(Z){var Ue,ce,ne;const N=r.user;if(!N)return!1;if(N.user_type==="admin")return!0;if(N.user_type==="entreprise")return typeof Z.entreprise=="object"?((Ue=Z.entreprise)==null?void 0:Ue.id)===N.id:Z.entreprise===N.id;if(N.user_type==="salarie")return typeof Z.salarie=="object"?((ce=Z.salarie)==null?void 0:ce.id)===N.id:Z.salarie===N.id;const ke=Z.createur.id===N.id;let Me=!1;return typeof Z.visiteur=="object"?Me=((ne=Z.visiteur)==null?void 0:ne.id)===N.id:Me=Z.visiteur===N.id,Me||ke}async function ue(Z){await T(),localStorage.setItem("lastPlanId",Z.toString()),console.log(`Plan ${Z} créé et défini comme plan actif`),n.push("/")}function le(Z){R.value===Z?K.value=K.value==="asc"?"desc":"asc":(R.value=Z,K.value="desc")}function pe(Z){return Z?Gl(Z):""}return(Z,N)=>{var ke;return $e(),qe("div",Fz,[C("div",jz,[C("div",zz,[C("div",$z,[C("h1",Uz,Zt(ve.value.title),1),C("p",Vz,Zt(ve.value.description),1)]),C("div",{class:"mt-4 sm:mt-0 sm:ml-16 sm:flex-none"},[C("button",{onClick:W,class:"inline-flex items-center justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:w-auto"}," Nouveau plan ")])]),Kn(r).isAdmin?($e(),qe("div",Gz,[C("div",Hz,[N[15]||(N[15]=C("label",{for:"entreprise-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par entreprise",-1)),Fn(C("select",{id:"entreprise-filter","onUpdate:modelValue":N[0]||(N[0]=Me=>ee.value=Me),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[N[14]||(N[14]=C("option",{value:null},"Toutes les entreprises",-1)),($e(!0),qe(Tn,null,Lr(o.value,Me=>($e(),qe("option",{key:Me.id,value:Me.id},Zt(pe(Me)),9,qz))),128))],512),[[vo,ee.value]])]),C("div",Wz,[N[16]||(N[16]=C("label",{for:"salarie-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par salarie",-1)),Fn(C("select",{id:"salarie-filter","onUpdate:modelValue":N[1]||(N[1]=Me=>F.value=Me),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[C("option",Zz,Zt(z.value.length?"Tous les salaries":"Aucun salarie disponible"),1),($e(!0),qe(Tn,null,Lr(z.value,Me=>($e(),qe("option",{key:Me.id,value:Me.id},Zt(pe(Me)),9,Kz))),128))],512),[[vo,F.value]])]),F.value?($e(),qe("div",Yz,[N[17]||(N[17]=C("label",{for:"visiteur-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par visiteur",-1)),Fn(C("select",{id:"visiteur-filter","onUpdate:modelValue":N[2]||(N[2]=Me=>I.value=Me),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[C("option",Jz,Zt(he.value.length?"Tous les visiteurs":"Aucun visiteur disponible"),1),($e(!0),qe(Tn,null,Lr(he.value,Me=>($e(),qe("option",{key:Me.id,value:Me.id},Zt(pe(Me)),9,Xz))),128))],512),[[vo,I.value]])])):pn("",!0)])):Kn(r).isSalarie?($e(),qe("div",Qz,[C("div",e$,[N[19]||(N[19]=C("label",{for:"visiteur-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par visiteur",-1)),Fn(C("select",{id:"visiteur-filter","onUpdate:modelValue":N[3]||(N[3]=Me=>I.value=Me),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[N[18]||(N[18]=C("option",{value:null},"Tous les visiteurs",-1)),($e(!0),qe(Tn,null,Lr(u.value,Me=>($e(),qe("option",{key:Me.id,value:Me.id},Zt(pe(Me)),9,t$))),128))],512),[[vo,I.value]])])])):pn("",!0),C("div",n$,[C("div",r$,[C("div",i$,[C("table",o$,[C("thead",s$,[C("tr",null,[C("th",a$,[C("button",{onClick:N[4]||(N[4]=Me=>le("nom")),class:"group inline-flex items-center"},[N[21]||(N[21]=Li(" Nom ")),C("span",l$,[($e(),qe("svg",{class:Vi(["h-5 w-5",{"text-gray-900":R.value==="nom","text-gray-400":R.value!=="nom","rotate-180":R.value==="nom"&&K.value==="asc"}]),viewBox:"0 0 20 20",fill:"currentColor"},N[20]||(N[20]=[C("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)]),2))])])]),N[24]||(N[24]=C("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Description ",-1)),N[25]||(N[25]=C("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Entreprise ",-1)),N[26]||(N[26]=C("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Salarie ",-1)),N[27]||(N[27]=C("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Visiteur ",-1)),C("th",u$,[C("button",{onClick:N[5]||(N[5]=Me=>le("date_modification")),class:"group inline-flex items-center"},[N[23]||(N[23]=Li(" Dernière modification ")),C("span",c$,[($e(),qe("svg",{class:Vi(["h-5 w-5",{"text-gray-900":R.value==="date_modification","text-gray-400":R.value!=="date_modification","rotate-180":R.value==="date_modification"&&K.value==="asc"}]),viewBox:"0 0 20 20",fill:"currentColor"},N[22]||(N[22]=[C("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)]),2))])])]),N[28]||(N[28]=C("th",{scope:"col",class:"relative py-3.5 pl-3 pr-4 sm:pr-6 lg:pr-8"},[C("span",{class:"sr-only"},"Actions")],-1))])]),C("tbody",f$,[fe.value.length===0?($e(),qe("tr",h$,N[29]||(N[29]=[C("td",{colspan:"7",class:"py-4 px-6 text-center text-gray-500"}," Aucun plan disponible ",-1)]))):pn("",!0),($e(!0),qe(Tn,null,Lr(fe.value,Me=>($e(),qe("tr",{key:Me.id,class:"hover:bg-gray-50"},[C("td",d$,Zt(Me.nom),1),C("td",p$,Zt(Me.description||"-"),1),C("td",g$,[Me.entreprise&&typeof Me.entreprise=="object"?($e(),qe("div",m$,[C("div",v$,[C("div",y$,[C("span",_$,Zt(Te(Me.entreprise)),1)])]),C("div",b$,[C("div",w$,Zt(Kn(Gl)(Me.entreprise)),1)])])):($e(),qe("div",x$," Non assigné "))]),C("td",L$,[Me.salarie&&typeof Me.salarie=="object"?($e(),qe("div",S$,[C("div",E$,[C("div",C$,[C("span",P$,Zt(Te(Me.salarie)),1)])]),C("div",M$,[C("div",A$,Zt(Kn(Gl)(Me.salarie)),1)])])):($e(),qe("div",k$," Non assigné "))]),C("td",T$,[Me.visiteur&&typeof Me.visiteur=="object"?($e(),qe("div",N$,[C("div",D$,[C("div",I$,[C("span",O$,Zt(Te(Me.visiteur)),1)])]),C("div",B$,[C("div",R$,Zt(Kn(Gl)(Me.visiteur)),1)])])):($e(),qe("div",F$," Non assigné "))]),C("td",j$,Zt(Ce(Me.date_modification)),1),C("td",z$,[C("button",{onClick:Ue=>G(Me),class:"text-primary-600 hover:text-primary-900 mr-4"}," Ouvrir ",8,$$),C("button",{onClick:Ue=>Y(Me),class:"text-primary-600 hover:text-primary-900 mr-4"}," Modifier ",8,U$),Q(Me)?($e(),qe("button",{key:0,onClick:Ue=>oe(Me),class:"text-red-600 hover:text-red-900"}," Supprimer ",8,V$)):pn("",!0)])]))),128))])])])])]),di(dx,{modelValue:f.value,"onUpdate:modelValue":N[6]||(N[6]=Me=>f.value=Me),salaries:s.value,clients:u.value,onCreated:ue},null,8,["modelValue","salaries","clients"]),d.value?($e(),qe("div",G$,[C("div",H$,[C("div",q$,[N[31]||(N[31]=C("h2",{class:"text-xl font-semibold text-gray-900"},"Modifier le plan",-1)),C("button",{onClick:N[7]||(N[7]=Me=>d.value=!1),class:"text-gray-400 hover:text-gray-500 focus:outline-none"},N[30]||(N[30]=[C("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),C("form",{onSubmit:Gc(H,["prevent"]),class:"space-y-4"},[C("div",null,[N[32]||(N[32]=C("label",{for:"edit-nom",class:"block text-sm font-medium text-gray-700"}," Nom ",-1)),Fn(C("input",{type:"text",id:"edit-nom","onUpdate:modelValue":N[8]||(N[8]=Me=>y.value.nom=Me),disabled:M.value,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",required:""},null,8,W$),[[ni,y.value.nom]])]),C("div",null,[N[33]||(N[33]=C("label",{for:"edit-description",class:"block text-sm font-medium text-gray-700"}," Description ",-1)),Fn(C("textarea",{id:"edit-description","onUpdate:modelValue":N[9]||(N[9]=Me=>y.value.description=Me),disabled:M.value,rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm disabled:bg-gray-100 disabled:cursor-not-allowed"},null,8,Z$),[[ni,y.value.description]])]),Kn(r).isAdmin||((ke=Kn(r).user)==null?void 0:ke.user_type)==="entreprise"?($e(),qe("div",K$,[Kn(r).isAdmin?($e(),qe("div",Y$,[N[35]||(N[35]=C("label",{for:"edit-entreprise",class:"block text-sm font-medium text-gray-700"}," Entreprise ",-1)),Fn(C("select",{id:"edit-entreprise","onUpdate:modelValue":N[10]||(N[10]=Me=>y.value.entreprise=Me),disabled:M.value,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed"},[N[34]||(N[34]=C("option",{value:null},"Sélectionner une entreprise",-1)),($e(!0),qe(Tn,null,Lr(o.value,Me=>($e(),qe("option",{key:Me.id,value:Me.id},Zt(pe(Me)),9,X$))),128))],8,J$),[[vo,y.value.entreprise]])])):pn("",!0),C("div",null,[N[37]||(N[37]=C("label",{for:"edit-salarie",class:"block text-sm font-medium text-gray-700"}," Salarie ",-1)),Fn(C("select",{id:"edit-salarie","onUpdate:modelValue":N[11]||(N[11]=Me=>y.value.salarie=Me),disabled:Kn(r).isAdmin&&!y.value.entreprise||M.value,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed"},[N[36]||(N[36]=C("option",{value:null},"Sélectionner un salarie",-1)),($e(!0),qe(Tn,null,Lr(U.value,Me=>($e(),qe("option",{key:Me.id,value:Me.id},Zt(pe(Me)),9,eU))),128))],8,Q$),[[vo,y.value.salarie]]),Kn(r).isAdmin&&!y.value.entreprise?($e(),qe("p",tU," Veuillez d'abord sélectionner une entreprise ")):pn("",!0)]),C("div",null,[N[39]||(N[39]=C("label",{for:"edit-visiteur",class:"block text-sm font-medium text-gray-700"}," Visiteur ",-1)),Fn(C("select",{id:"edit-visiteur","onUpdate:modelValue":N[12]||(N[12]=Me=>y.value.visiteur=Me),disabled:!y.value.salarie||M.value,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed"},[N[38]||(N[38]=C("option",{value:null},"Sélectionner un visiteur",-1)),($e(!0),qe(Tn,null,Lr(J.value,Me=>($e(),qe("option",{key:Me.id,value:Me.id},Zt(pe(Me)),9,rU))),128))],8,nU),[[vo,y.value.visiteur]]),y.value.salarie?pn("",!0):($e(),qe("p",iU," Veuillez d'abord sélectionner un salarie "))])])):pn("",!0),k.value?($e(),qe("div",oU,[C("div",sU,[N[40]||(N[40]=C("div",{class:"flex-shrink-0"},[C("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[C("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),C("div",aU,[C("p",lU,Zt(k.value),1)])])])):pn("",!0),C("div",uU,[C("button",{type:"button",class:"mt-3 inline-flex w-full justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-base font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:mt-0 sm:text-sm",onClick:N[13]||(N[13]=Me=>d.value=!1)}," Annuler "),C("button",{type:"submit",disabled:M.value,class:"inline-flex w-full justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:text-sm disabled:opacity-50"},[M.value?($e(),qe("svg",fU,N[41]||(N[41]=[C("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),C("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):pn("",!0),Li(" "+Zt(M.value?"Enregistrement...":"Enregistrer"),1)],8,cU)])],32)])])):pn("",!0),m.value?($e(),rl(Ox,{key:3,title:"Supprimer le plan",message:"Êtes-vous sûr de vouloir supprimer ce plan ? Cette action est irréversible.",onConfirm:ie,onCancel:we})):pn("",!0)])])}}});var Bx={exports:{}};const dU=K5(g6);/**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Vb(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,r)}return t}function yc(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?Vb(Object(t),!0).forEach(function(r){pU(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Vb(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function Gg(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Gg=function(n){return typeof n}:Gg=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Gg(e)}function pU(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function _u(){return _u=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},_u.apply(this,arguments)}function gU(e,n){if(e==null)return{};var t={},r=Object.keys(e),i,s;for(s=0;s<r.length;s++)i=r[s],!(n.indexOf(i)>=0)&&(t[i]=e[i]);return t}function mU(e,n){if(e==null)return{};var t=gU(e,n),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)r=s[i],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}function vU(e){return yU(e)||_U(e)||bU(e)||wU()}function yU(e){if(Array.isArray(e))return P1(e)}function _U(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bU(e,n){if(e){if(typeof e=="string")return P1(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return P1(e,n)}}function P1(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function wU(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var xU="1.14.0";function $c(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var Wc=$c(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Rp=$c(/Edge/i),Gb=$c(/firefox/i),lp=$c(/safari/i)&&!$c(/chrome/i)&&!$c(/android/i),Rx=$c(/iP(ad|od|hone)/i),LU=$c(/chrome/i)&&$c(/android/i),Fx={capture:!1,passive:!1};function Ci(e,n,t){e.addEventListener(n,t,!Wc&&Fx)}function mi(e,n,t){e.removeEventListener(n,t,!Wc&&Fx)}function xm(e,n){if(n){if(n[0]===">"&&(n=n.substring(1)),e)try{if(e.matches)return e.matches(n);if(e.msMatchesSelector)return e.msMatchesSelector(n);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(n)}catch{return!1}return!1}}function SU(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function ju(e,n,t,r){if(e){t=t||document;do{if(n!=null&&(n[0]===">"?e.parentNode===t&&xm(e,n):xm(e,n))||r&&e===t)return e;if(e===t)break}while(e=SU(e))}return null}var Hb=/\s+/g;function Jo(e,n,t){if(e&&n)if(e.classList)e.classList[t?"add":"remove"](n);else{var r=(" "+e.className+" ").replace(Hb," ").replace(" "+n+" "," ");e.className=(r+(t?" "+n:"")).replace(Hb," ")}}function or(e,n,t){var r=e&&e.style;if(r){if(t===void 0)return document.defaultView&&document.defaultView.getComputedStyle?t=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(t=e.currentStyle),n===void 0?t:t[n];!(n in r)&&n.indexOf("webkit")===-1&&(n="-webkit-"+n),r[n]=t+(typeof t=="string"?"":"px")}}function ih(e,n){var t="";if(typeof e=="string")t=e;else do{var r=or(e,"transform");r&&r!=="none"&&(t=r+" "+t)}while(!n&&(e=e.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(t)}function jx(e,n,t){if(e){var r=e.getElementsByTagName(n),i=0,s=r.length;if(t)for(;i<s;i++)t(r[i],i);return r}return[]}function gc(){var e=document.scrollingElement;return e||document.documentElement}function Fo(e,n,t,r,i){if(!(!e.getBoundingClientRect&&e!==window)){var s,o,u,f,d,m,_;if(e!==window&&e.parentNode&&e!==gc()?(s=e.getBoundingClientRect(),o=s.top,u=s.left,f=s.bottom,d=s.right,m=s.height,_=s.width):(o=0,u=0,f=window.innerHeight,d=window.innerWidth,m=window.innerHeight,_=window.innerWidth),(n||t)&&e!==window&&(i=i||e.parentNode,!Wc))do if(i&&i.getBoundingClientRect&&(or(i,"transform")!=="none"||t&&or(i,"position")!=="static")){var w=i.getBoundingClientRect();o-=w.top+parseInt(or(i,"border-top-width")),u-=w.left+parseInt(or(i,"border-left-width")),f=o+s.height,d=u+s.width;break}while(i=i.parentNode);if(r&&e!==window){var y=ih(i||e),M=y&&y.a,k=y&&y.d;y&&(o/=k,u/=M,_/=M,m/=k,f=o+m,d=u+_)}return{top:o,left:u,bottom:f,right:d,width:_,height:m}}}function qb(e,n,t){for(var r=_f(e,!0),i=Fo(e)[n];r;){var s=Fo(r)[t],o=void 0;if(o=i>=s,!o)return r;if(r===gc())break;r=_f(r,!1)}return!1}function fd(e,n,t,r){for(var i=0,s=0,o=e.children;s<o.length;){if(o[s].style.display!=="none"&&o[s]!==Nr.ghost&&(r||o[s]!==Nr.dragged)&&ju(o[s],t.draggable,e,!1)){if(i===n)return o[s];i++}s++}return null}function yy(e,n){for(var t=e.lastElementChild;t&&(t===Nr.ghost||or(t,"display")==="none"||n&&!xm(t,n));)t=t.previousElementSibling;return t||null}function hs(e,n){var t=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==Nr.clone&&(!n||xm(e,n))&&t++;return t}function Wb(e){var n=0,t=0,r=gc();if(e)do{var i=ih(e),s=i.a,o=i.d;n+=e.scrollLeft*s,t+=e.scrollTop*o}while(e!==r&&(e=e.parentNode));return[n,t]}function EU(e,n){for(var t in e)if(e.hasOwnProperty(t)){for(var r in n)if(n.hasOwnProperty(r)&&n[r]===e[t][r])return Number(t)}return-1}function _f(e,n){if(!e||!e.getBoundingClientRect)return gc();var t=e,r=!1;do if(t.clientWidth<t.scrollWidth||t.clientHeight<t.scrollHeight){var i=or(t);if(t.clientWidth<t.scrollWidth&&(i.overflowX=="auto"||i.overflowX=="scroll")||t.clientHeight<t.scrollHeight&&(i.overflowY=="auto"||i.overflowY=="scroll")){if(!t.getBoundingClientRect||t===document.body)return gc();if(r||n)return t;r=!0}}while(t=t.parentNode);return gc()}function CU(e,n){if(e&&n)for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e}function gv(e,n){return Math.round(e.top)===Math.round(n.top)&&Math.round(e.left)===Math.round(n.left)&&Math.round(e.height)===Math.round(n.height)&&Math.round(e.width)===Math.round(n.width)}var up;function zx(e,n){return function(){if(!up){var t=arguments,r=this;t.length===1?e.call(r,t[0]):e.apply(r,t),up=setTimeout(function(){up=void 0},n)}}}function PU(){clearTimeout(up),up=void 0}function $x(e,n,t){e.scrollLeft+=n,e.scrollTop+=t}function _y(e){var n=window.Polymer,t=window.jQuery||window.Zepto;return n&&n.dom?n.dom(e).cloneNode(!0):t?t(e).clone(!0)[0]:e.cloneNode(!0)}function Zb(e,n){or(e,"position","absolute"),or(e,"top",n.top),or(e,"left",n.left),or(e,"width",n.width),or(e,"height",n.height)}function mv(e){or(e,"position",""),or(e,"top",""),or(e,"left",""),or(e,"width",""),or(e,"height","")}var Fa="Sortable"+new Date().getTime();function MU(){var e=[],n;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var r=[].slice.call(this.el.children);r.forEach(function(i){if(!(or(i,"display")==="none"||i===Nr.ghost)){e.push({target:i,rect:Fo(i)});var s=yc({},e[e.length-1].rect);if(i.thisAnimationDuration){var o=ih(i,!0);o&&(s.top-=o.f,s.left-=o.e)}i.fromRect=s}})}},addAnimationState:function(r){e.push(r)},removeAnimationState:function(r){e.splice(EU(e,{target:r}),1)},animateAll:function(r){var i=this;if(!this.options.animation){clearTimeout(n),typeof r=="function"&&r();return}var s=!1,o=0;e.forEach(function(u){var f=0,d=u.target,m=d.fromRect,_=Fo(d),w=d.prevFromRect,y=d.prevToRect,M=u.rect,k=ih(d,!0);k&&(_.top-=k.f,_.left-=k.e),d.toRect=_,d.thisAnimationDuration&&gv(w,_)&&!gv(m,_)&&(M.top-_.top)/(M.left-_.left)===(m.top-_.top)/(m.left-_.left)&&(f=kU(M,w,y,i.options)),gv(_,m)||(d.prevFromRect=m,d.prevToRect=_,f||(f=i.options.animation),i.animate(d,M,_,f)),f&&(s=!0,o=Math.max(o,f),clearTimeout(d.animationResetTimer),d.animationResetTimer=setTimeout(function(){d.animationTime=0,d.prevFromRect=null,d.fromRect=null,d.prevToRect=null,d.thisAnimationDuration=null},f),d.thisAnimationDuration=f)}),clearTimeout(n),s?n=setTimeout(function(){typeof r=="function"&&r()},o):typeof r=="function"&&r(),e=[]},animate:function(r,i,s,o){if(o){or(r,"transition",""),or(r,"transform","");var u=ih(this.el),f=u&&u.a,d=u&&u.d,m=(i.left-s.left)/(f||1),_=(i.top-s.top)/(d||1);r.animatingX=!!m,r.animatingY=!!_,or(r,"transform","translate3d("+m+"px,"+_+"px,0)"),this.forRepaintDummy=AU(r),or(r,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),or(r,"transform","translate3d(0,0,0)"),typeof r.animated=="number"&&clearTimeout(r.animated),r.animated=setTimeout(function(){or(r,"transition",""),or(r,"transform",""),r.animated=!1,r.animatingX=!1,r.animatingY=!1},o)}}}}function AU(e){return e.offsetWidth}function kU(e,n,t,r){return Math.sqrt(Math.pow(n.top-e.top,2)+Math.pow(n.left-e.left,2))/Math.sqrt(Math.pow(n.top-t.top,2)+Math.pow(n.left-t.left,2))*r.animation}var Ih=[],vv={initializeByDefault:!0},Fp={mount:function(n){for(var t in vv)vv.hasOwnProperty(t)&&!(t in n)&&(n[t]=vv[t]);Ih.forEach(function(r){if(r.pluginName===n.pluginName)throw"Sortable: Cannot mount plugin ".concat(n.pluginName," more than once")}),Ih.push(n)},pluginEvent:function(n,t,r){var i=this;this.eventCanceled=!1,r.cancel=function(){i.eventCanceled=!0};var s=n+"Global";Ih.forEach(function(o){t[o.pluginName]&&(t[o.pluginName][s]&&t[o.pluginName][s](yc({sortable:t},r)),t.options[o.pluginName]&&t[o.pluginName][n]&&t[o.pluginName][n](yc({sortable:t},r)))})},initializePlugins:function(n,t,r,i){Ih.forEach(function(u){var f=u.pluginName;if(!(!n.options[f]&&!u.initializeByDefault)){var d=new u(n,t,n.options);d.sortable=n,d.options=n.options,n[f]=d,_u(r,d.defaults)}});for(var s in n.options)if(n.options.hasOwnProperty(s)){var o=this.modifyOption(n,s,n.options[s]);typeof o<"u"&&(n.options[s]=o)}},getEventProperties:function(n,t){var r={};return Ih.forEach(function(i){typeof i.eventProperties=="function"&&_u(r,i.eventProperties.call(t[i.pluginName],n))}),r},modifyOption:function(n,t,r){var i;return Ih.forEach(function(s){n[s.pluginName]&&s.optionListeners&&typeof s.optionListeners[t]=="function"&&(i=s.optionListeners[t].call(n[s.pluginName],r))}),i}};function Hd(e){var n=e.sortable,t=e.rootEl,r=e.name,i=e.targetEl,s=e.cloneEl,o=e.toEl,u=e.fromEl,f=e.oldIndex,d=e.newIndex,m=e.oldDraggableIndex,_=e.newDraggableIndex,w=e.originalEvent,y=e.putSortable,M=e.extraEventProperties;if(n=n||t&&t[Fa],!!n){var k,F=n.options,I="on"+r.charAt(0).toUpperCase()+r.substr(1);window.CustomEvent&&!Wc&&!Rp?k=new CustomEvent(r,{bubbles:!0,cancelable:!0}):(k=document.createEvent("Event"),k.initEvent(r,!0,!0)),k.to=o||t,k.from=u||t,k.item=i||t,k.clone=s,k.oldIndex=f,k.newIndex=d,k.oldDraggableIndex=m,k.newDraggableIndex=_,k.originalEvent=w,k.pullMode=y?y.lastPutMode:void 0;var R=yc(yc({},M),Fp.getEventProperties(r,n));for(var K in R)k[K]=R[K];t&&t.dispatchEvent(k),F[I]&&F[I].call(n,k)}}var TU=["evt"],vl=function(n,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=r.evt,s=mU(r,TU);Fp.pluginEvent.bind(Nr)(n,t,yc({dragEl:On,parentEl:us,ghostEl:ti,rootEl:Ro,nextEl:Kf,lastDownEl:Hg,cloneEl:cs,cloneHidden:gf,dragStarted:qd,putSortable:da,activeSortable:Nr.active,originalEvent:i,oldIndex:qh,oldDraggableIndex:cp,newIndex:Vl,newDraggableIndex:pf,hideGhostForTarget:Hx,unhideGhostForTarget:qx,cloneNowHidden:function(){gf=!0},cloneNowShown:function(){gf=!1},dispatchSortableEvent:function(u){Ja({sortable:t,name:u,originalEvent:i})}},s))};function Ja(e){Hd(yc({putSortable:da,cloneEl:cs,targetEl:On,rootEl:Ro,oldIndex:qh,oldDraggableIndex:cp,newIndex:Vl,newDraggableIndex:pf},e))}var On,us,ti,Ro,Kf,Hg,cs,gf,qh,Vl,cp,pf,Lg,da,Vh=!1,Lm=!1,Sm=[],qf,Ou,yv,_v,Kb,Yb,qd,Oh,fp,hp=!1,Sg=!1,qg,Da,bv=[],M1=!1,Em=[],s0=typeof document<"u",Eg=Rx,Jb=Rp||Wc?"cssFloat":"float",NU=s0&&!LU&&!Rx&&"draggable"in document.createElement("div"),Ux=function(){if(s0){if(Wc)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}}(),Vx=function(n,t){var r=or(n),i=parseInt(r.width)-parseInt(r.paddingLeft)-parseInt(r.paddingRight)-parseInt(r.borderLeftWidth)-parseInt(r.borderRightWidth),s=fd(n,0,t),o=fd(n,1,t),u=s&&or(s),f=o&&or(o),d=u&&parseInt(u.marginLeft)+parseInt(u.marginRight)+Fo(s).width,m=f&&parseInt(f.marginLeft)+parseInt(f.marginRight)+Fo(o).width;if(r.display==="flex")return r.flexDirection==="column"||r.flexDirection==="column-reverse"?"vertical":"horizontal";if(r.display==="grid")return r.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(s&&u.float&&u.float!=="none"){var _=u.float==="left"?"left":"right";return o&&(f.clear==="both"||f.clear===_)?"vertical":"horizontal"}return s&&(u.display==="block"||u.display==="flex"||u.display==="table"||u.display==="grid"||d>=i&&r[Jb]==="none"||o&&r[Jb]==="none"&&d+m>i)?"vertical":"horizontal"},DU=function(n,t,r){var i=r?n.left:n.top,s=r?n.right:n.bottom,o=r?n.width:n.height,u=r?t.left:t.top,f=r?t.right:t.bottom,d=r?t.width:t.height;return i===u||s===f||i+o/2===u+d/2},IU=function(n,t){var r;return Sm.some(function(i){var s=i[Fa].options.emptyInsertThreshold;if(!(!s||yy(i))){var o=Fo(i),u=n>=o.left-s&&n<=o.right+s,f=t>=o.top-s&&t<=o.bottom+s;if(u&&f)return r=i}}),r},Gx=function(n){function t(s,o){return function(u,f,d,m){var _=u.options.group.name&&f.options.group.name&&u.options.group.name===f.options.group.name;if(s==null&&(o||_))return!0;if(s==null||s===!1)return!1;if(o&&s==="clone")return s;if(typeof s=="function")return t(s(u,f,d,m),o)(u,f,d,m);var w=(o?u:f).options.group.name;return s===!0||typeof s=="string"&&s===w||s.join&&s.indexOf(w)>-1}}var r={},i=n.group;(!i||Gg(i)!="object")&&(i={name:i}),r.name=i.name,r.checkPull=t(i.pull,!0),r.checkPut=t(i.put),r.revertClone=i.revertClone,n.group=r},Hx=function(){!Ux&&ti&&or(ti,"display","none")},qx=function(){!Ux&&ti&&or(ti,"display","")};s0&&document.addEventListener("click",function(e){if(Lm)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Lm=!1,!1},!0);var Wf=function(n){if(On){n=n.touches?n.touches[0]:n;var t=IU(n.clientX,n.clientY);if(t){var r={};for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i]);r.target=r.rootEl=t,r.preventDefault=void 0,r.stopPropagation=void 0,t[Fa]._onDragOver(r)}}},OU=function(n){On&&On.parentNode[Fa]._isOutsideThisEl(n.target)};function Nr(e,n){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=n=_u({},n),e[Fa]=this;var t={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Vx(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(o,u){o.setData("Text",u.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Nr.supportPointer!==!1&&"PointerEvent"in window&&!lp,emptyInsertThreshold:5};Fp.initializePlugins(this,e,t);for(var r in t)!(r in n)&&(n[r]=t[r]);Gx(n);for(var i in this)i.charAt(0)==="_"&&typeof this[i]=="function"&&(this[i]=this[i].bind(this));this.nativeDraggable=n.forceFallback?!1:NU,this.nativeDraggable&&(this.options.touchStartThreshold=1),n.supportPointer?Ci(e,"pointerdown",this._onTapStart):(Ci(e,"mousedown",this._onTapStart),Ci(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(Ci(e,"dragover",this),Ci(e,"dragenter",this)),Sm.push(this.el),n.store&&n.store.get&&this.sort(n.store.get(this)||[]),_u(this,MU())}Nr.prototype={constructor:Nr,_isOutsideThisEl:function(n){!this.el.contains(n)&&n!==this.el&&(Oh=null)},_getDirection:function(n,t){return typeof this.options.direction=="function"?this.options.direction.call(this,n,t,On):this.options.direction},_onTapStart:function(n){if(n.cancelable){var t=this,r=this.el,i=this.options,s=i.preventOnFilter,o=n.type,u=n.touches&&n.touches[0]||n.pointerType&&n.pointerType==="touch"&&n,f=(u||n).target,d=n.target.shadowRoot&&(n.path&&n.path[0]||n.composedPath&&n.composedPath()[0])||f,m=i.filter;if(VU(r),!On&&!(/mousedown|pointerdown/.test(o)&&n.button!==0||i.disabled)&&!d.isContentEditable&&!(!this.nativeDraggable&&lp&&f&&f.tagName.toUpperCase()==="SELECT")&&(f=ju(f,i.draggable,r,!1),!(f&&f.animated)&&Hg!==f)){if(qh=hs(f),cp=hs(f,i.draggable),typeof m=="function"){if(m.call(this,n,f,this)){Ja({sortable:t,rootEl:d,name:"filter",targetEl:f,toEl:r,fromEl:r}),vl("filter",t,{evt:n}),s&&n.cancelable&&n.preventDefault();return}}else if(m&&(m=m.split(",").some(function(_){if(_=ju(d,_.trim(),r,!1),_)return Ja({sortable:t,rootEl:_,name:"filter",targetEl:f,fromEl:r,toEl:r}),vl("filter",t,{evt:n}),!0}),m)){s&&n.cancelable&&n.preventDefault();return}i.handle&&!ju(d,i.handle,r,!1)||this._prepareDragStart(n,u,f)}}},_prepareDragStart:function(n,t,r){var i=this,s=i.el,o=i.options,u=s.ownerDocument,f;if(r&&!On&&r.parentNode===s){var d=Fo(r);if(Ro=s,On=r,us=On.parentNode,Kf=On.nextSibling,Hg=r,Lg=o.group,Nr.dragged=On,qf={target:On,clientX:(t||n).clientX,clientY:(t||n).clientY},Kb=qf.clientX-d.left,Yb=qf.clientY-d.top,this._lastX=(t||n).clientX,this._lastY=(t||n).clientY,On.style["will-change"]="all",f=function(){if(vl("delayEnded",i,{evt:n}),Nr.eventCanceled){i._onDrop();return}i._disableDelayedDragEvents(),!Gb&&i.nativeDraggable&&(On.draggable=!0),i._triggerDragStart(n,t),Ja({sortable:i,name:"choose",originalEvent:n}),Jo(On,o.chosenClass,!0)},o.ignore.split(",").forEach(function(m){jx(On,m.trim(),wv)}),Ci(u,"dragover",Wf),Ci(u,"mousemove",Wf),Ci(u,"touchmove",Wf),Ci(u,"mouseup",i._onDrop),Ci(u,"touchend",i._onDrop),Ci(u,"touchcancel",i._onDrop),Gb&&this.nativeDraggable&&(this.options.touchStartThreshold=4,On.draggable=!0),vl("delayStart",this,{evt:n}),o.delay&&(!o.delayOnTouchOnly||t)&&(!this.nativeDraggable||!(Rp||Wc))){if(Nr.eventCanceled){this._onDrop();return}Ci(u,"mouseup",i._disableDelayedDrag),Ci(u,"touchend",i._disableDelayedDrag),Ci(u,"touchcancel",i._disableDelayedDrag),Ci(u,"mousemove",i._delayedDragTouchMoveHandler),Ci(u,"touchmove",i._delayedDragTouchMoveHandler),o.supportPointer&&Ci(u,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(f,o.delay)}else f()}},_delayedDragTouchMoveHandler:function(n){var t=n.touches?n.touches[0]:n;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){On&&wv(On),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var n=this.el.ownerDocument;mi(n,"mouseup",this._disableDelayedDrag),mi(n,"touchend",this._disableDelayedDrag),mi(n,"touchcancel",this._disableDelayedDrag),mi(n,"mousemove",this._delayedDragTouchMoveHandler),mi(n,"touchmove",this._delayedDragTouchMoveHandler),mi(n,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(n,t){t=t||n.pointerType=="touch"&&n,!this.nativeDraggable||t?this.options.supportPointer?Ci(document,"pointermove",this._onTouchMove):t?Ci(document,"touchmove",this._onTouchMove):Ci(document,"mousemove",this._onTouchMove):(Ci(On,"dragend",this),Ci(Ro,"dragstart",this._onDragStart));try{document.selection?Wg(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(n,t){if(Vh=!1,Ro&&On){vl("dragStarted",this,{evt:t}),this.nativeDraggable&&Ci(document,"dragover",OU);var r=this.options;!n&&Jo(On,r.dragClass,!1),Jo(On,r.ghostClass,!0),Nr.active=this,n&&this._appendGhost(),Ja({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(Ou){this._lastX=Ou.clientX,this._lastY=Ou.clientY,Hx();for(var n=document.elementFromPoint(Ou.clientX,Ou.clientY),t=n;n&&n.shadowRoot&&(n=n.shadowRoot.elementFromPoint(Ou.clientX,Ou.clientY),n!==t);)t=n;if(On.parentNode[Fa]._isOutsideThisEl(n),t)do{if(t[Fa]){var r=void 0;if(r=t[Fa]._onDragOver({clientX:Ou.clientX,clientY:Ou.clientY,target:n,rootEl:t}),r&&!this.options.dragoverBubble)break}n=t}while(t=t.parentNode);qx()}},_onTouchMove:function(n){if(qf){var t=this.options,r=t.fallbackTolerance,i=t.fallbackOffset,s=n.touches?n.touches[0]:n,o=ti&&ih(ti,!0),u=ti&&o&&o.a,f=ti&&o&&o.d,d=Eg&&Da&&Wb(Da),m=(s.clientX-qf.clientX+i.x)/(u||1)+(d?d[0]-bv[0]:0)/(u||1),_=(s.clientY-qf.clientY+i.y)/(f||1)+(d?d[1]-bv[1]:0)/(f||1);if(!Nr.active&&!Vh){if(r&&Math.max(Math.abs(s.clientX-this._lastX),Math.abs(s.clientY-this._lastY))<r)return;this._onDragStart(n,!0)}if(ti){o?(o.e+=m-(yv||0),o.f+=_-(_v||0)):o={a:1,b:0,c:0,d:1,e:m,f:_};var w="matrix(".concat(o.a,",").concat(o.b,",").concat(o.c,",").concat(o.d,",").concat(o.e,",").concat(o.f,")");or(ti,"webkitTransform",w),or(ti,"mozTransform",w),or(ti,"msTransform",w),or(ti,"transform",w),yv=m,_v=_,Ou=s}n.cancelable&&n.preventDefault()}},_appendGhost:function(){if(!ti){var n=this.options.fallbackOnBody?document.body:Ro,t=Fo(On,!0,Eg,!0,n),r=this.options;if(Eg){for(Da=n;or(Da,"position")==="static"&&or(Da,"transform")==="none"&&Da!==document;)Da=Da.parentNode;Da!==document.body&&Da!==document.documentElement?(Da===document&&(Da=gc()),t.top+=Da.scrollTop,t.left+=Da.scrollLeft):Da=gc(),bv=Wb(Da)}ti=On.cloneNode(!0),Jo(ti,r.ghostClass,!1),Jo(ti,r.fallbackClass,!0),Jo(ti,r.dragClass,!0),or(ti,"transition",""),or(ti,"transform",""),or(ti,"box-sizing","border-box"),or(ti,"margin",0),or(ti,"top",t.top),or(ti,"left",t.left),or(ti,"width",t.width),or(ti,"height",t.height),or(ti,"opacity","0.8"),or(ti,"position",Eg?"absolute":"fixed"),or(ti,"zIndex","100000"),or(ti,"pointerEvents","none"),Nr.ghost=ti,n.appendChild(ti),or(ti,"transform-origin",Kb/parseInt(ti.style.width)*100+"% "+Yb/parseInt(ti.style.height)*100+"%")}},_onDragStart:function(n,t){var r=this,i=n.dataTransfer,s=r.options;if(vl("dragStart",this,{evt:n}),Nr.eventCanceled){this._onDrop();return}vl("setupClone",this),Nr.eventCanceled||(cs=_y(On),cs.draggable=!1,cs.style["will-change"]="",this._hideClone(),Jo(cs,this.options.chosenClass,!1),Nr.clone=cs),r.cloneId=Wg(function(){vl("clone",r),!Nr.eventCanceled&&(r.options.removeCloneOnHide||Ro.insertBefore(cs,On),r._hideClone(),Ja({sortable:r,name:"clone"}))}),!t&&Jo(On,s.dragClass,!0),t?(Lm=!0,r._loopId=setInterval(r._emulateDragOver,50)):(mi(document,"mouseup",r._onDrop),mi(document,"touchend",r._onDrop),mi(document,"touchcancel",r._onDrop),i&&(i.effectAllowed="move",s.setData&&s.setData.call(r,i,On)),Ci(document,"drop",r),or(On,"transform","translateZ(0)")),Vh=!0,r._dragStartId=Wg(r._dragStarted.bind(r,t,n)),Ci(document,"selectstart",r),qd=!0,lp&&or(document.body,"user-select","none")},_onDragOver:function(n){var t=this.el,r=n.target,i,s,o,u=this.options,f=u.group,d=Nr.active,m=Lg===f,_=u.sort,w=da||d,y,M=this,k=!1;if(M1)return;function F(ie,we){vl(ie,M,yc({evt:n,isOwner:m,axis:y?"vertical":"horizontal",revert:o,dragRect:i,targetRect:s,canSort:_,fromSortable:w,target:r,completed:R,onMove:function(Te,Y){return Cg(Ro,t,On,i,Te,Fo(Te),n,Y)},changed:K},we))}function I(){F("dragOverAnimationCapture"),M.captureAnimationState(),M!==w&&w.captureAnimationState()}function R(ie){return F("dragOverCompleted",{insertion:ie}),ie&&(m?d._hideClone():d._showClone(M),M!==w&&(Jo(On,da?da.options.ghostClass:d.options.ghostClass,!1),Jo(On,u.ghostClass,!0)),da!==M&&M!==Nr.active?da=M:M===Nr.active&&da&&(da=null),w===M&&(M._ignoreWhileAnimating=r),M.animateAll(function(){F("dragOverAnimationComplete"),M._ignoreWhileAnimating=null}),M!==w&&(w.animateAll(),w._ignoreWhileAnimating=null)),(r===On&&!On.animated||r===t&&!r.animated)&&(Oh=null),!u.dragoverBubble&&!n.rootEl&&r!==document&&(On.parentNode[Fa]._isOutsideThisEl(n.target),!ie&&Wf(n)),!u.dragoverBubble&&n.stopPropagation&&n.stopPropagation(),k=!0}function K(){Vl=hs(On),pf=hs(On,u.draggable),Ja({sortable:M,name:"change",toEl:t,newIndex:Vl,newDraggableIndex:pf,originalEvent:n})}if(n.preventDefault!==void 0&&n.cancelable&&n.preventDefault(),r=ju(r,u.draggable,t,!0),F("dragOver"),Nr.eventCanceled)return k;if(On.contains(n.target)||r.animated&&r.animatingX&&r.animatingY||M._ignoreWhileAnimating===r)return R(!1);if(Lm=!1,d&&!u.disabled&&(m?_||(o=us!==Ro):da===this||(this.lastPutMode=Lg.checkPull(this,d,On,n))&&f.checkPut(this,d,On,n))){if(y=this._getDirection(n,r)==="vertical",i=Fo(On),F("dragOverValid"),Nr.eventCanceled)return k;if(o)return us=Ro,I(),this._hideClone(),F("revert"),Nr.eventCanceled||(Kf?Ro.insertBefore(On,Kf):Ro.appendChild(On)),R(!0);var ee=yy(t,u.draggable);if(!ee||jU(n,y,this)&&!ee.animated){if(ee===On)return R(!1);if(ee&&t===n.target&&(r=ee),r&&(s=Fo(r)),Cg(Ro,t,On,i,r,s,n,!!r)!==!1)return I(),t.appendChild(On),us=t,K(),R(!0)}else if(ee&&FU(n,y,this)){var he=fd(t,0,u,!0);if(he===On)return R(!1);if(r=he,s=Fo(r),Cg(Ro,t,On,i,r,s,n,!1)!==!1)return I(),t.insertBefore(On,he),us=t,K(),R(!0)}else if(r.parentNode===t){s=Fo(r);var fe=0,ve,z=On.parentNode!==t,U=!DU(On.animated&&On.toRect||i,r.animated&&r.toRect||s,y),J=y?"top":"left",T=qb(r,"top","top")||qb(On,"top","top"),D=T?T.scrollTop:void 0;Oh!==r&&(ve=s[J],hp=!1,Sg=!U&&u.invertSwap||z),fe=zU(n,r,s,y,U?1:u.swapThreshold,u.invertedSwapThreshold==null?u.swapThreshold:u.invertedSwapThreshold,Sg,Oh===r);var B;if(fe!==0){var $=hs(On);do $-=fe,B=us.children[$];while(B&&(or(B,"display")==="none"||B===ti))}if(fe===0||B===r)return R(!1);Oh=r,fp=fe;var W=r.nextElementSibling,G=!1;G=fe===1;var oe=Cg(Ro,t,On,i,r,s,n,G);if(oe!==!1)return(oe===1||oe===-1)&&(G=oe===1),M1=!0,setTimeout(RU,30),I(),G&&!W?t.appendChild(On):r.parentNode.insertBefore(On,G?W:r),T&&$x(T,0,D-T.scrollTop),us=On.parentNode,ve!==void 0&&!Sg&&(qg=Math.abs(ve-Fo(r)[J])),K(),R(!0)}if(t.contains(On))return R(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){mi(document,"mousemove",this._onTouchMove),mi(document,"touchmove",this._onTouchMove),mi(document,"pointermove",this._onTouchMove),mi(document,"dragover",Wf),mi(document,"mousemove",Wf),mi(document,"touchmove",Wf)},_offUpEvents:function(){var n=this.el.ownerDocument;mi(n,"mouseup",this._onDrop),mi(n,"touchend",this._onDrop),mi(n,"pointerup",this._onDrop),mi(n,"touchcancel",this._onDrop),mi(document,"selectstart",this)},_onDrop:function(n){var t=this.el,r=this.options;if(Vl=hs(On),pf=hs(On,r.draggable),vl("drop",this,{evt:n}),us=On&&On.parentNode,Vl=hs(On),pf=hs(On,r.draggable),Nr.eventCanceled){this._nulling();return}Vh=!1,Sg=!1,hp=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),A1(this.cloneId),A1(this._dragStartId),this.nativeDraggable&&(mi(document,"drop",this),mi(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),lp&&or(document.body,"user-select",""),or(On,"transform",""),n&&(qd&&(n.cancelable&&n.preventDefault(),!r.dropBubble&&n.stopPropagation()),ti&&ti.parentNode&&ti.parentNode.removeChild(ti),(Ro===us||da&&da.lastPutMode!=="clone")&&cs&&cs.parentNode&&cs.parentNode.removeChild(cs),On&&(this.nativeDraggable&&mi(On,"dragend",this),wv(On),On.style["will-change"]="",qd&&!Vh&&Jo(On,da?da.options.ghostClass:this.options.ghostClass,!1),Jo(On,this.options.chosenClass,!1),Ja({sortable:this,name:"unchoose",toEl:us,newIndex:null,newDraggableIndex:null,originalEvent:n}),Ro!==us?(Vl>=0&&(Ja({rootEl:us,name:"add",toEl:us,fromEl:Ro,originalEvent:n}),Ja({sortable:this,name:"remove",toEl:us,originalEvent:n}),Ja({rootEl:us,name:"sort",toEl:us,fromEl:Ro,originalEvent:n}),Ja({sortable:this,name:"sort",toEl:us,originalEvent:n})),da&&da.save()):Vl!==qh&&Vl>=0&&(Ja({sortable:this,name:"update",toEl:us,originalEvent:n}),Ja({sortable:this,name:"sort",toEl:us,originalEvent:n})),Nr.active&&((Vl==null||Vl===-1)&&(Vl=qh,pf=cp),Ja({sortable:this,name:"end",toEl:us,originalEvent:n}),this.save()))),this._nulling()},_nulling:function(){vl("nulling",this),Ro=On=us=ti=Kf=cs=Hg=gf=qf=Ou=qd=Vl=pf=qh=cp=Oh=fp=da=Lg=Nr.dragged=Nr.ghost=Nr.clone=Nr.active=null,Em.forEach(function(n){n.checked=!0}),Em.length=yv=_v=0},handleEvent:function(n){switch(n.type){case"drop":case"dragend":this._onDrop(n);break;case"dragenter":case"dragover":On&&(this._onDragOver(n),BU(n));break;case"selectstart":n.preventDefault();break}},toArray:function(){for(var n=[],t,r=this.el.children,i=0,s=r.length,o=this.options;i<s;i++)t=r[i],ju(t,o.draggable,this.el,!1)&&n.push(t.getAttribute(o.dataIdAttr)||UU(t));return n},sort:function(n,t){var r={},i=this.el;this.toArray().forEach(function(s,o){var u=i.children[o];ju(u,this.options.draggable,i,!1)&&(r[s]=u)},this),t&&this.captureAnimationState(),n.forEach(function(s){r[s]&&(i.removeChild(r[s]),i.appendChild(r[s]))}),t&&this.animateAll()},save:function(){var n=this.options.store;n&&n.set&&n.set(this)},closest:function(n,t){return ju(n,t||this.options.draggable,this.el,!1)},option:function(n,t){var r=this.options;if(t===void 0)return r[n];var i=Fp.modifyOption(this,n,t);typeof i<"u"?r[n]=i:r[n]=t,n==="group"&&Gx(r)},destroy:function(){vl("destroy",this);var n=this.el;n[Fa]=null,mi(n,"mousedown",this._onTapStart),mi(n,"touchstart",this._onTapStart),mi(n,"pointerdown",this._onTapStart),this.nativeDraggable&&(mi(n,"dragover",this),mi(n,"dragenter",this)),Array.prototype.forEach.call(n.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Sm.splice(Sm.indexOf(this.el),1),this.el=n=null},_hideClone:function(){if(!gf){if(vl("hideClone",this),Nr.eventCanceled)return;or(cs,"display","none"),this.options.removeCloneOnHide&&cs.parentNode&&cs.parentNode.removeChild(cs),gf=!0}},_showClone:function(n){if(n.lastPutMode!=="clone"){this._hideClone();return}if(gf){if(vl("showClone",this),Nr.eventCanceled)return;On.parentNode==Ro&&!this.options.group.revertClone?Ro.insertBefore(cs,On):Kf?Ro.insertBefore(cs,Kf):Ro.appendChild(cs),this.options.group.revertClone&&this.animate(On,cs),or(cs,"display",""),gf=!1}}};function BU(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function Cg(e,n,t,r,i,s,o,u){var f,d=e[Fa],m=d.options.onMove,_;return window.CustomEvent&&!Wc&&!Rp?f=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(f=document.createEvent("Event"),f.initEvent("move",!0,!0)),f.to=n,f.from=e,f.dragged=t,f.draggedRect=r,f.related=i||n,f.relatedRect=s||Fo(n),f.willInsertAfter=u,f.originalEvent=o,e.dispatchEvent(f),m&&(_=m.call(d,f,o)),_}function wv(e){e.draggable=!1}function RU(){M1=!1}function FU(e,n,t){var r=Fo(fd(t.el,0,t.options,!0)),i=10;return n?e.clientX<r.left-i||e.clientY<r.top&&e.clientX<r.right:e.clientY<r.top-i||e.clientY<r.bottom&&e.clientX<r.left}function jU(e,n,t){var r=Fo(yy(t.el,t.options.draggable)),i=10;return n?e.clientX>r.right+i||e.clientX<=r.right&&e.clientY>r.bottom&&e.clientX>=r.left:e.clientX>r.right&&e.clientY>r.top||e.clientX<=r.right&&e.clientY>r.bottom+i}function zU(e,n,t,r,i,s,o,u){var f=r?e.clientY:e.clientX,d=r?t.height:t.width,m=r?t.top:t.left,_=r?t.bottom:t.right,w=!1;if(!o){if(u&&qg<d*i){if(!hp&&(fp===1?f>m+d*s/2:f<_-d*s/2)&&(hp=!0),hp)w=!0;else if(fp===1?f<m+qg:f>_-qg)return-fp}else if(f>m+d*(1-i)/2&&f<_-d*(1-i)/2)return $U(n)}return w=w||o,w&&(f<m+d*s/2||f>_-d*s/2)?f>m+d/2?1:-1:0}function $U(e){return hs(On)<hs(e)?1:-1}function UU(e){for(var n=e.tagName+e.className+e.src+e.href+e.textContent,t=n.length,r=0;t--;)r+=n.charCodeAt(t);return r.toString(36)}function VU(e){Em.length=0;for(var n=e.getElementsByTagName("input"),t=n.length;t--;){var r=n[t];r.checked&&Em.push(r)}}function Wg(e){return setTimeout(e,0)}function A1(e){return clearTimeout(e)}s0&&Ci(document,"touchmove",function(e){(Nr.active||Vh)&&e.cancelable&&e.preventDefault()});Nr.utils={on:Ci,off:mi,css:or,find:jx,is:function(n,t){return!!ju(n,t,n,!1)},extend:CU,throttle:zx,closest:ju,toggleClass:Jo,clone:_y,index:hs,nextTick:Wg,cancelNextTick:A1,detectDirection:Vx,getChild:fd};Nr.get=function(e){return e[Fa]};Nr.mount=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];n[0].constructor===Array&&(n=n[0]),n.forEach(function(r){if(!r.prototype||!r.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(r));r.utils&&(Nr.utils=yc(yc({},Nr.utils),r.utils)),Fp.mount(r)})};Nr.create=function(e,n){return new Nr(e,n)};Nr.version=xU;var Os=[],Wd,k1,T1=!1,xv,Lv,Cm,Zd;function GU(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var n in this)n.charAt(0)==="_"&&typeof this[n]=="function"&&(this[n]=this[n].bind(this))}return e.prototype={dragStarted:function(t){var r=t.originalEvent;this.sortable.nativeDraggable?Ci(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Ci(document,"pointermove",this._handleFallbackAutoScroll):r.touches?Ci(document,"touchmove",this._handleFallbackAutoScroll):Ci(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(t){var r=t.originalEvent;!this.options.dragOverBubble&&!r.rootEl&&this._handleAutoScroll(r)},drop:function(){this.sortable.nativeDraggable?mi(document,"dragover",this._handleAutoScroll):(mi(document,"pointermove",this._handleFallbackAutoScroll),mi(document,"touchmove",this._handleFallbackAutoScroll),mi(document,"mousemove",this._handleFallbackAutoScroll)),Xb(),Zg(),PU()},nulling:function(){Cm=k1=Wd=T1=Zd=xv=Lv=null,Os.length=0},_handleFallbackAutoScroll:function(t){this._handleAutoScroll(t,!0)},_handleAutoScroll:function(t,r){var i=this,s=(t.touches?t.touches[0]:t).clientX,o=(t.touches?t.touches[0]:t).clientY,u=document.elementFromPoint(s,o);if(Cm=t,r||this.options.forceAutoScrollFallback||Rp||Wc||lp){Sv(t,this.options,u,r);var f=_f(u,!0);T1&&(!Zd||s!==xv||o!==Lv)&&(Zd&&Xb(),Zd=setInterval(function(){var d=_f(document.elementFromPoint(s,o),!0);d!==f&&(f=d,Zg()),Sv(t,i.options,d,r)},10),xv=s,Lv=o)}else{if(!this.options.bubbleScroll||_f(u,!0)===gc()){Zg();return}Sv(t,this.options,_f(u,!1),!1)}}},_u(e,{pluginName:"scroll",initializeByDefault:!0})}function Zg(){Os.forEach(function(e){clearInterval(e.pid)}),Os=[]}function Xb(){clearInterval(Zd)}var Sv=zx(function(e,n,t,r){if(n.scroll){var i=(e.touches?e.touches[0]:e).clientX,s=(e.touches?e.touches[0]:e).clientY,o=n.scrollSensitivity,u=n.scrollSpeed,f=gc(),d=!1,m;k1!==t&&(k1=t,Zg(),Wd=n.scroll,m=n.scrollFn,Wd===!0&&(Wd=_f(t,!0)));var _=0,w=Wd;do{var y=w,M=Fo(y),k=M.top,F=M.bottom,I=M.left,R=M.right,K=M.width,ee=M.height,he=void 0,fe=void 0,ve=y.scrollWidth,z=y.scrollHeight,U=or(y),J=y.scrollLeft,T=y.scrollTop;y===f?(he=K<ve&&(U.overflowX==="auto"||U.overflowX==="scroll"||U.overflowX==="visible"),fe=ee<z&&(U.overflowY==="auto"||U.overflowY==="scroll"||U.overflowY==="visible")):(he=K<ve&&(U.overflowX==="auto"||U.overflowX==="scroll"),fe=ee<z&&(U.overflowY==="auto"||U.overflowY==="scroll"));var D=he&&(Math.abs(R-i)<=o&&J+K<ve)-(Math.abs(I-i)<=o&&!!J),B=fe&&(Math.abs(F-s)<=o&&T+ee<z)-(Math.abs(k-s)<=o&&!!T);if(!Os[_])for(var $=0;$<=_;$++)Os[$]||(Os[$]={});(Os[_].vx!=D||Os[_].vy!=B||Os[_].el!==y)&&(Os[_].el=y,Os[_].vx=D,Os[_].vy=B,clearInterval(Os[_].pid),(D!=0||B!=0)&&(d=!0,Os[_].pid=setInterval((function(){r&&this.layer===0&&Nr.active._onTouchMove(Cm);var W=Os[this.layer].vy?Os[this.layer].vy*u:0,G=Os[this.layer].vx?Os[this.layer].vx*u:0;typeof m=="function"&&m.call(Nr.dragged.parentNode[Fa],G,W,e,Cm,Os[this.layer].el)!=="continue"||$x(Os[this.layer].el,G,W)}).bind({layer:_}),24))),_++}while(n.bubbleScroll&&w!==f&&(w=_f(w,!1)));T1=d}},30),Wx=function(n){var t=n.originalEvent,r=n.putSortable,i=n.dragEl,s=n.activeSortable,o=n.dispatchSortableEvent,u=n.hideGhostForTarget,f=n.unhideGhostForTarget;if(t){var d=r||s;u();var m=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,_=document.elementFromPoint(m.clientX,m.clientY);f(),d&&!d.el.contains(_)&&(o("spill"),this.onSpill({dragEl:i,putSortable:r}))}};function by(){}by.prototype={startIndex:null,dragStart:function(n){var t=n.oldDraggableIndex;this.startIndex=t},onSpill:function(n){var t=n.dragEl,r=n.putSortable;this.sortable.captureAnimationState(),r&&r.captureAnimationState();var i=fd(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(t,i):this.sortable.el.appendChild(t),this.sortable.animateAll(),r&&r.animateAll()},drop:Wx};_u(by,{pluginName:"revertOnSpill"});function wy(){}wy.prototype={onSpill:function(n){var t=n.dragEl,r=n.putSortable,i=r||this.sortable;i.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),i.animateAll()},drop:Wx};_u(wy,{pluginName:"removeOnSpill"});var uu;function HU(){function e(){this.defaults={swapClass:"sortable-swap-highlight"}}return e.prototype={dragStart:function(t){var r=t.dragEl;uu=r},dragOverValid:function(t){var r=t.completed,i=t.target,s=t.onMove,o=t.activeSortable,u=t.changed,f=t.cancel;if(o.options.swap){var d=this.sortable.el,m=this.options;if(i&&i!==d){var _=uu;s(i)!==!1?(Jo(i,m.swapClass,!0),uu=i):uu=null,_&&_!==uu&&Jo(_,m.swapClass,!1)}u(),r(!0),f()}},drop:function(t){var r=t.activeSortable,i=t.putSortable,s=t.dragEl,o=i||this.sortable,u=this.options;uu&&Jo(uu,u.swapClass,!1),uu&&(u.swap||i&&i.options.swap)&&s!==uu&&(o.captureAnimationState(),o!==r&&r.captureAnimationState(),qU(s,uu),o.animateAll(),o!==r&&r.animateAll())},nulling:function(){uu=null}},_u(e,{pluginName:"swap",eventProperties:function(){return{swapItem:uu}}})}function qU(e,n){var t=e.parentNode,r=n.parentNode,i,s;!t||!r||t.isEqualNode(n)||r.isEqualNode(e)||(i=hs(e),s=hs(n),t.isEqualNode(r)&&i<s&&s++,t.insertBefore(n,t.children[i]),r.insertBefore(e,r.children[s]))}var qr=[],Ul=[],Bd,Bu,Rd=!1,yl=!1,Bh=!1,So,Fd,Pg;function WU(){function e(n){for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this));n.options.supportPointer?Ci(document,"pointerup",this._deselectMultiDrag):(Ci(document,"mouseup",this._deselectMultiDrag),Ci(document,"touchend",this._deselectMultiDrag)),Ci(document,"keydown",this._checkKeyDown),Ci(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(i,s){var o="";qr.length&&Bu===n?qr.forEach(function(u,f){o+=(f?", ":"")+u.textContent}):o=s.textContent,i.setData("Text",o)}}}return e.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(t){var r=t.dragEl;So=r},delayEnded:function(){this.isMultiDrag=~qr.indexOf(So)},setupClone:function(t){var r=t.sortable,i=t.cancel;if(this.isMultiDrag){for(var s=0;s<qr.length;s++)Ul.push(_y(qr[s])),Ul[s].sortableIndex=qr[s].sortableIndex,Ul[s].draggable=!1,Ul[s].style["will-change"]="",Jo(Ul[s],this.options.selectedClass,!1),qr[s]===So&&Jo(Ul[s],this.options.chosenClass,!1);r._hideClone(),i()}},clone:function(t){var r=t.sortable,i=t.rootEl,s=t.dispatchSortableEvent,o=t.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||qr.length&&Bu===r&&(Qb(!0,i),s("clone"),o()))},showClone:function(t){var r=t.cloneNowShown,i=t.rootEl,s=t.cancel;this.isMultiDrag&&(Qb(!1,i),Ul.forEach(function(o){or(o,"display","")}),r(),Pg=!1,s())},hideClone:function(t){var r=this;t.sortable;var i=t.cloneNowHidden,s=t.cancel;this.isMultiDrag&&(Ul.forEach(function(o){or(o,"display","none"),r.options.removeCloneOnHide&&o.parentNode&&o.parentNode.removeChild(o)}),i(),Pg=!0,s())},dragStartGlobal:function(t){t.sortable,!this.isMultiDrag&&Bu&&Bu.multiDrag._deselectMultiDrag(),qr.forEach(function(r){r.sortableIndex=hs(r)}),qr=qr.sort(function(r,i){return r.sortableIndex-i.sortableIndex}),Bh=!0},dragStarted:function(t){var r=this,i=t.sortable;if(this.isMultiDrag){if(this.options.sort&&(i.captureAnimationState(),this.options.animation)){qr.forEach(function(o){o!==So&&or(o,"position","absolute")});var s=Fo(So,!1,!0,!0);qr.forEach(function(o){o!==So&&Zb(o,s)}),yl=!0,Rd=!0}i.animateAll(function(){yl=!1,Rd=!1,r.options.animation&&qr.forEach(function(o){mv(o)}),r.options.sort&&Mg()})}},dragOver:function(t){var r=t.target,i=t.completed,s=t.cancel;yl&&~qr.indexOf(r)&&(i(!1),s())},revert:function(t){var r=t.fromSortable,i=t.rootEl,s=t.sortable,o=t.dragRect;qr.length>1&&(qr.forEach(function(u){s.addAnimationState({target:u,rect:yl?Fo(u):o}),mv(u),u.fromRect=o,r.removeAnimationState(u)}),yl=!1,ZU(!this.options.removeCloneOnHide,i))},dragOverCompleted:function(t){var r=t.sortable,i=t.isOwner,s=t.insertion,o=t.activeSortable,u=t.parentEl,f=t.putSortable,d=this.options;if(s){if(i&&o._hideClone(),Rd=!1,d.animation&&qr.length>1&&(yl||!i&&!o.options.sort&&!f)){var m=Fo(So,!1,!0,!0);qr.forEach(function(w){w!==So&&(Zb(w,m),u.appendChild(w))}),yl=!0}if(!i)if(yl||Mg(),qr.length>1){var _=Pg;o._showClone(r),o.options.animation&&!Pg&&_&&Ul.forEach(function(w){o.addAnimationState({target:w,rect:Fd}),w.fromRect=Fd,w.thisAnimationDuration=null})}else o._showClone(r)}},dragOverAnimationCapture:function(t){var r=t.dragRect,i=t.isOwner,s=t.activeSortable;if(qr.forEach(function(u){u.thisAnimationDuration=null}),s.options.animation&&!i&&s.multiDrag.isMultiDrag){Fd=_u({},r);var o=ih(So,!0);Fd.top-=o.f,Fd.left-=o.e}},dragOverAnimationComplete:function(){yl&&(yl=!1,Mg())},drop:function(t){var r=t.originalEvent,i=t.rootEl,s=t.parentEl,o=t.sortable,u=t.dispatchSortableEvent,f=t.oldIndex,d=t.putSortable,m=d||this.sortable;if(r){var _=this.options,w=s.children;if(!Bh)if(_.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),Jo(So,_.selectedClass,!~qr.indexOf(So)),~qr.indexOf(So))qr.splice(qr.indexOf(So),1),Bd=null,Hd({sortable:o,rootEl:i,name:"deselect",targetEl:So});else{if(qr.push(So),Hd({sortable:o,rootEl:i,name:"select",targetEl:So}),r.shiftKey&&Bd&&o.el.contains(Bd)){var y=hs(Bd),M=hs(So);if(~y&&~M&&y!==M){var k,F;for(M>y?(F=y,k=M):(F=M,k=y+1);F<k;F++)~qr.indexOf(w[F])||(Jo(w[F],_.selectedClass,!0),qr.push(w[F]),Hd({sortable:o,rootEl:i,name:"select",targetEl:w[F]}))}}else Bd=So;Bu=m}if(Bh&&this.isMultiDrag){if(yl=!1,(s[Fa].options.sort||s!==i)&&qr.length>1){var I=Fo(So),R=hs(So,":not(."+this.options.selectedClass+")");if(!Rd&&_.animation&&(So.thisAnimationDuration=null),m.captureAnimationState(),!Rd&&(_.animation&&(So.fromRect=I,qr.forEach(function(ee){if(ee.thisAnimationDuration=null,ee!==So){var he=yl?Fo(ee):I;ee.fromRect=he,m.addAnimationState({target:ee,rect:he})}})),Mg(),qr.forEach(function(ee){w[R]?s.insertBefore(ee,w[R]):s.appendChild(ee),R++}),f===hs(So))){var K=!1;qr.forEach(function(ee){if(ee.sortableIndex!==hs(ee)){K=!0;return}}),K&&u("update")}qr.forEach(function(ee){mv(ee)}),m.animateAll()}Bu=m}(i===s||d&&d.lastPutMode!=="clone")&&Ul.forEach(function(ee){ee.parentNode&&ee.parentNode.removeChild(ee)})}},nullingGlobal:function(){this.isMultiDrag=Bh=!1,Ul.length=0},destroyGlobal:function(){this._deselectMultiDrag(),mi(document,"pointerup",this._deselectMultiDrag),mi(document,"mouseup",this._deselectMultiDrag),mi(document,"touchend",this._deselectMultiDrag),mi(document,"keydown",this._checkKeyDown),mi(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(t){if(!(typeof Bh<"u"&&Bh)&&Bu===this.sortable&&!(t&&ju(t.target,this.options.draggable,this.sortable.el,!1))&&!(t&&t.button!==0))for(;qr.length;){var r=qr[0];Jo(r,this.options.selectedClass,!1),qr.shift(),Hd({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:r})}},_checkKeyDown:function(t){t.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(t){t.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},_u(e,{pluginName:"multiDrag",utils:{select:function(t){var r=t.parentNode[Fa];!r||!r.options.multiDrag||~qr.indexOf(t)||(Bu&&Bu!==r&&(Bu.multiDrag._deselectMultiDrag(),Bu=r),Jo(t,r.options.selectedClass,!0),qr.push(t))},deselect:function(t){var r=t.parentNode[Fa],i=qr.indexOf(t);!r||!r.options.multiDrag||!~i||(Jo(t,r.options.selectedClass,!1),qr.splice(i,1))}},eventProperties:function(){var t=this,r=[],i=[];return qr.forEach(function(s){r.push({multiDragElement:s,index:s.sortableIndex});var o;yl&&s!==So?o=-1:yl?o=hs(s,":not(."+t.options.selectedClass+")"):o=hs(s),i.push({multiDragElement:s,index:o})}),{items:vU(qr),clones:[].concat(Ul),oldIndicies:r,newIndicies:i}},optionListeners:{multiDragKey:function(t){return t=t.toLowerCase(),t==="ctrl"?t="Control":t.length>1&&(t=t.charAt(0).toUpperCase()+t.substr(1)),t}}})}function ZU(e,n){qr.forEach(function(t,r){var i=n.children[t.sortableIndex+(e?Number(r):0)];i?n.insertBefore(t,i):n.appendChild(t)})}function Qb(e,n){Ul.forEach(function(t,r){var i=n.children[t.sortableIndex+(e?Number(r):0)];i?n.insertBefore(t,i):n.appendChild(t)})}function Mg(){qr.forEach(function(e){e!==So&&e.parentNode&&e.parentNode.removeChild(e)})}Nr.mount(new GU);Nr.mount(wy,by);const KU=Object.freeze(Object.defineProperty({__proto__:null,MultiDrag:WU,Sortable:Nr,Swap:HU,default:Nr},Symbol.toStringTag,{value:"Module"})),YU=K5(KU);(function(e,n){(function(r,i){e.exports=i(dU,YU)})(typeof self<"u"?self:ea,function(t,r){return function(i){var s={};function o(u){if(s[u])return s[u].exports;var f=s[u]={i:u,l:!1,exports:{}};return i[u].call(f.exports,f,f.exports,o),f.l=!0,f.exports}return o.m=i,o.c=s,o.d=function(u,f,d){o.o(u,f)||Object.defineProperty(u,f,{enumerable:!0,get:d})},o.r=function(u){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(u,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(u,"__esModule",{value:!0})},o.t=function(u,f){if(f&1&&(u=o(u)),f&8||f&4&&typeof u=="object"&&u&&u.__esModule)return u;var d=Object.create(null);if(o.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:u}),f&2&&typeof u!="string")for(var m in u)o.d(d,m,(function(_){return u[_]}).bind(null,m));return d},o.n=function(u){var f=u&&u.__esModule?function(){return u.default}:function(){return u};return o.d(f,"a",f),f},o.o=function(u,f){return Object.prototype.hasOwnProperty.call(u,f)},o.p="",o(o.s="fb15")}({"00ee":function(i,s,o){var u=o("b622"),f=u("toStringTag"),d={};d[f]="z",i.exports=String(d)==="[object z]"},"0366":function(i,s,o){var u=o("1c0b");i.exports=function(f,d,m){if(u(f),d===void 0)return f;switch(m){case 0:return function(){return f.call(d)};case 1:return function(_){return f.call(d,_)};case 2:return function(_,w){return f.call(d,_,w)};case 3:return function(_,w,y){return f.call(d,_,w,y)}}return function(){return f.apply(d,arguments)}}},"057f":function(i,s,o){var u=o("fc6a"),f=o("241c").f,d={}.toString,m=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],_=function(w){try{return f(w)}catch{return m.slice()}};i.exports.f=function(y){return m&&d.call(y)=="[object Window]"?_(y):f(u(y))}},"06cf":function(i,s,o){var u=o("83ab"),f=o("d1e7"),d=o("5c6c"),m=o("fc6a"),_=o("c04e"),w=o("5135"),y=o("0cfb"),M=Object.getOwnPropertyDescriptor;s.f=u?M:function(F,I){if(F=m(F),I=_(I,!0),y)try{return M(F,I)}catch{}if(w(F,I))return d(!f.f.call(F,I),F[I])}},"0cfb":function(i,s,o){var u=o("83ab"),f=o("d039"),d=o("cc12");i.exports=!u&&!f(function(){return Object.defineProperty(d("div"),"a",{get:function(){return 7}}).a!=7})},"13d5":function(i,s,o){var u=o("23e7"),f=o("d58f").left,d=o("a640"),m=o("ae40"),_=d("reduce"),w=m("reduce",{1:0});u({target:"Array",proto:!0,forced:!_||!w},{reduce:function(M){return f(this,M,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"14c3":function(i,s,o){var u=o("c6b6"),f=o("9263");i.exports=function(d,m){var _=d.exec;if(typeof _=="function"){var w=_.call(d,m);if(typeof w!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return w}if(u(d)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return f.call(d,m)}},"159b":function(i,s,o){var u=o("da84"),f=o("fdbc"),d=o("17c2"),m=o("9112");for(var _ in f){var w=u[_],y=w&&w.prototype;if(y&&y.forEach!==d)try{m(y,"forEach",d)}catch{y.forEach=d}}},"17c2":function(i,s,o){var u=o("b727").forEach,f=o("a640"),d=o("ae40"),m=f("forEach"),_=d("forEach");i.exports=!m||!_?function(y){return u(this,y,arguments.length>1?arguments[1]:void 0)}:[].forEach},"1be4":function(i,s,o){var u=o("d066");i.exports=u("document","documentElement")},"1c0b":function(i,s){i.exports=function(o){if(typeof o!="function")throw TypeError(String(o)+" is not a function");return o}},"1c7e":function(i,s,o){var u=o("b622"),f=u("iterator"),d=!1;try{var m=0,_={next:function(){return{done:!!m++}},return:function(){d=!0}};_[f]=function(){return this},Array.from(_,function(){throw 2})}catch{}i.exports=function(w,y){if(!y&&!d)return!1;var M=!1;try{var k={};k[f]=function(){return{next:function(){return{done:M=!0}}}},w(k)}catch{}return M}},"1d80":function(i,s){i.exports=function(o){if(o==null)throw TypeError("Can't call method on "+o);return o}},"1dde":function(i,s,o){var u=o("d039"),f=o("b622"),d=o("2d00"),m=f("species");i.exports=function(_){return d>=51||!u(function(){var w=[],y=w.constructor={};return y[m]=function(){return{foo:1}},w[_](Boolean).foo!==1})}},"23cb":function(i,s,o){var u=o("a691"),f=Math.max,d=Math.min;i.exports=function(m,_){var w=u(m);return w<0?f(w+_,0):d(w,_)}},"23e7":function(i,s,o){var u=o("da84"),f=o("06cf").f,d=o("9112"),m=o("6eeb"),_=o("ce4e"),w=o("e893"),y=o("94ca");i.exports=function(M,k){var F=M.target,I=M.global,R=M.stat,K,ee,he,fe,ve,z;if(I?ee=u:R?ee=u[F]||_(F,{}):ee=(u[F]||{}).prototype,ee)for(he in k){if(ve=k[he],M.noTargetGet?(z=f(ee,he),fe=z&&z.value):fe=ee[he],K=y(I?he:F+(R?".":"#")+he,M.forced),!K&&fe!==void 0){if(typeof ve==typeof fe)continue;w(ve,fe)}(M.sham||fe&&fe.sham)&&d(ve,"sham",!0),m(ee,he,ve,M)}}},"241c":function(i,s,o){var u=o("ca84"),f=o("7839"),d=f.concat("length","prototype");s.f=Object.getOwnPropertyNames||function(_){return u(_,d)}},"25f0":function(i,s,o){var u=o("6eeb"),f=o("825a"),d=o("d039"),m=o("ad6d"),_="toString",w=RegExp.prototype,y=w[_],M=d(function(){return y.call({source:"a",flags:"b"})!="/a/b"}),k=y.name!=_;(M||k)&&u(RegExp.prototype,_,function(){var I=f(this),R=String(I.source),K=I.flags,ee=String(K===void 0&&I instanceof RegExp&&!("flags"in w)?m.call(I):K);return"/"+R+"/"+ee},{unsafe:!0})},"2ca0":function(i,s,o){var u=o("23e7"),f=o("06cf").f,d=o("50c4"),m=o("5a34"),_=o("1d80"),w=o("ab13"),y=o("c430"),M="".startsWith,k=Math.min,F=w("startsWith"),I=!y&&!F&&!!function(){var R=f(String.prototype,"startsWith");return R&&!R.writable}();u({target:"String",proto:!0,forced:!I&&!F},{startsWith:function(K){var ee=String(_(this));m(K);var he=d(k(arguments.length>1?arguments[1]:void 0,ee.length)),fe=String(K);return M?M.call(ee,fe,he):ee.slice(he,he+fe.length)===fe}})},"2d00":function(i,s,o){var u=o("da84"),f=o("342f"),d=u.process,m=d&&d.versions,_=m&&m.v8,w,y;_?(w=_.split("."),y=w[0]+w[1]):f&&(w=f.match(/Edge\/(\d+)/),(!w||w[1]>=74)&&(w=f.match(/Chrome\/(\d+)/),w&&(y=w[1]))),i.exports=y&&+y},"342f":function(i,s,o){var u=o("d066");i.exports=u("navigator","userAgent")||""},"35a1":function(i,s,o){var u=o("f5df"),f=o("3f8c"),d=o("b622"),m=d("iterator");i.exports=function(_){if(_!=null)return _[m]||_["@@iterator"]||f[u(_)]}},"37e8":function(i,s,o){var u=o("83ab"),f=o("9bf2"),d=o("825a"),m=o("df75");i.exports=u?Object.defineProperties:function(w,y){d(w);for(var M=m(y),k=M.length,F=0,I;k>F;)f.f(w,I=M[F++],y[I]);return w}},"3bbe":function(i,s,o){var u=o("861d");i.exports=function(f){if(!u(f)&&f!==null)throw TypeError("Can't set "+String(f)+" as a prototype");return f}},"3ca3":function(i,s,o){var u=o("6547").charAt,f=o("69f3"),d=o("7dd0"),m="String Iterator",_=f.set,w=f.getterFor(m);d(String,"String",function(y){_(this,{type:m,string:String(y),index:0})},function(){var M=w(this),k=M.string,F=M.index,I;return F>=k.length?{value:void 0,done:!0}:(I=u(k,F),M.index+=I.length,{value:I,done:!1})})},"3f8c":function(i,s){i.exports={}},4160:function(i,s,o){var u=o("23e7"),f=o("17c2");u({target:"Array",proto:!0,forced:[].forEach!=f},{forEach:f})},"428f":function(i,s,o){var u=o("da84");i.exports=u},"44ad":function(i,s,o){var u=o("d039"),f=o("c6b6"),d="".split;i.exports=u(function(){return!Object("z").propertyIsEnumerable(0)})?function(m){return f(m)=="String"?d.call(m,""):Object(m)}:Object},"44d2":function(i,s,o){var u=o("b622"),f=o("7c73"),d=o("9bf2"),m=u("unscopables"),_=Array.prototype;_[m]==null&&d.f(_,m,{configurable:!0,value:f(null)}),i.exports=function(w){_[m][w]=!0}},"44e7":function(i,s,o){var u=o("861d"),f=o("c6b6"),d=o("b622"),m=d("match");i.exports=function(_){var w;return u(_)&&((w=_[m])!==void 0?!!w:f(_)=="RegExp")}},4930:function(i,s,o){var u=o("d039");i.exports=!!Object.getOwnPropertySymbols&&!u(function(){return!String(Symbol())})},"4d64":function(i,s,o){var u=o("fc6a"),f=o("50c4"),d=o("23cb"),m=function(_){return function(w,y,M){var k=u(w),F=f(k.length),I=d(M,F),R;if(_&&y!=y){for(;F>I;)if(R=k[I++],R!=R)return!0}else for(;F>I;I++)if((_||I in k)&&k[I]===y)return _||I||0;return!_&&-1}};i.exports={includes:m(!0),indexOf:m(!1)}},"4de4":function(i,s,o){var u=o("23e7"),f=o("b727").filter,d=o("1dde"),m=o("ae40"),_=d("filter"),w=m("filter");u({target:"Array",proto:!0,forced:!_||!w},{filter:function(M){return f(this,M,arguments.length>1?arguments[1]:void 0)}})},"4df4":function(i,s,o){var u=o("0366"),f=o("7b0b"),d=o("9bdd"),m=o("e95a"),_=o("50c4"),w=o("8418"),y=o("35a1");i.exports=function(k){var F=f(k),I=typeof this=="function"?this:Array,R=arguments.length,K=R>1?arguments[1]:void 0,ee=K!==void 0,he=y(F),fe=0,ve,z,U,J,T,D;if(ee&&(K=u(K,R>2?arguments[2]:void 0,2)),he!=null&&!(I==Array&&m(he)))for(J=he.call(F),T=J.next,z=new I;!(U=T.call(J)).done;fe++)D=ee?d(J,K,[U.value,fe],!0):U.value,w(z,fe,D);else for(ve=_(F.length),z=new I(ve);ve>fe;fe++)D=ee?K(F[fe],fe):F[fe],w(z,fe,D);return z.length=fe,z}},"4fad":function(i,s,o){var u=o("23e7"),f=o("6f53").entries;u({target:"Object",stat:!0},{entries:function(m){return f(m)}})},"50c4":function(i,s,o){var u=o("a691"),f=Math.min;i.exports=function(d){return d>0?f(u(d),9007199254740991):0}},5135:function(i,s){var o={}.hasOwnProperty;i.exports=function(u,f){return o.call(u,f)}},5319:function(i,s,o){var u=o("d784"),f=o("825a"),d=o("7b0b"),m=o("50c4"),_=o("a691"),w=o("1d80"),y=o("8aa5"),M=o("14c3"),k=Math.max,F=Math.min,I=Math.floor,R=/\$([$&'`]|\d\d?|<[^>]*>)/g,K=/\$([$&'`]|\d\d?)/g,ee=function(he){return he===void 0?he:String(he)};u("replace",2,function(he,fe,ve,z){var U=z.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,J=z.REPLACE_KEEPS_$0,T=U?"$":"$0";return[function($,W){var G=w(this),oe=$==null?void 0:$[he];return oe!==void 0?oe.call($,G,W):fe.call(String(G),$,W)},function(B,$){if(!U&&J||typeof $=="string"&&$.indexOf(T)===-1){var W=ve(fe,B,this,$);if(W.done)return W.value}var G=f(B),oe=String(this),ie=typeof $=="function";ie||($=String($));var we=G.global;if(we){var Ce=G.unicode;G.lastIndex=0}for(var Te=[];;){var Y=M(G,oe);if(Y===null||(Te.push(Y),!we))break;var H=String(Y[0]);H===""&&(G.lastIndex=y(oe,m(G.lastIndex),Ce))}for(var Q="",ue=0,le=0;le<Te.length;le++){Y=Te[le];for(var pe=String(Y[0]),Z=k(F(_(Y.index),oe.length),0),N=[],ke=1;ke<Y.length;ke++)N.push(ee(Y[ke]));var Me=Y.groups;if(ie){var Ue=[pe].concat(N,Z,oe);Me!==void 0&&Ue.push(Me);var ce=String($.apply(void 0,Ue))}else ce=D(pe,oe,Z,N,Me,$);Z>=ue&&(Q+=oe.slice(ue,Z)+ce,ue=Z+pe.length)}return Q+oe.slice(ue)}];function D(B,$,W,G,oe,ie){var we=W+B.length,Ce=G.length,Te=K;return oe!==void 0&&(oe=d(oe),Te=R),fe.call(ie,Te,function(Y,H){var Q;switch(H.charAt(0)){case"$":return"$";case"&":return B;case"`":return $.slice(0,W);case"'":return $.slice(we);case"<":Q=oe[H.slice(1,-1)];break;default:var ue=+H;if(ue===0)return Y;if(ue>Ce){var le=I(ue/10);return le===0?Y:le<=Ce?G[le-1]===void 0?H.charAt(1):G[le-1]+H.charAt(1):Y}Q=G[ue-1]}return Q===void 0?"":Q})}})},5692:function(i,s,o){var u=o("c430"),f=o("c6cd");(i.exports=function(d,m){return f[d]||(f[d]=m!==void 0?m:{})})("versions",[]).push({version:"3.6.5",mode:u?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},"56ef":function(i,s,o){var u=o("d066"),f=o("241c"),d=o("7418"),m=o("825a");i.exports=u("Reflect","ownKeys")||function(w){var y=f.f(m(w)),M=d.f;return M?y.concat(M(w)):y}},"5a34":function(i,s,o){var u=o("44e7");i.exports=function(f){if(u(f))throw TypeError("The method doesn't accept regular expressions");return f}},"5c6c":function(i,s){i.exports=function(o,u){return{enumerable:!(o&1),configurable:!(o&2),writable:!(o&4),value:u}}},"5db7":function(i,s,o){var u=o("23e7"),f=o("a2bf"),d=o("7b0b"),m=o("50c4"),_=o("1c0b"),w=o("65f0");u({target:"Array",proto:!0},{flatMap:function(M){var k=d(this),F=m(k.length),I;return _(M),I=w(k,0),I.length=f(I,k,k,F,0,1,M,arguments.length>1?arguments[1]:void 0),I}})},6547:function(i,s,o){var u=o("a691"),f=o("1d80"),d=function(m){return function(_,w){var y=String(f(_)),M=u(w),k=y.length,F,I;return M<0||M>=k?m?"":void 0:(F=y.charCodeAt(M),F<55296||F>56319||M+1===k||(I=y.charCodeAt(M+1))<56320||I>57343?m?y.charAt(M):F:m?y.slice(M,M+2):(F-55296<<10)+(I-56320)+65536)}};i.exports={codeAt:d(!1),charAt:d(!0)}},"65f0":function(i,s,o){var u=o("861d"),f=o("e8b5"),d=o("b622"),m=d("species");i.exports=function(_,w){var y;return f(_)&&(y=_.constructor,typeof y=="function"&&(y===Array||f(y.prototype))?y=void 0:u(y)&&(y=y[m],y===null&&(y=void 0))),new(y===void 0?Array:y)(w===0?0:w)}},"69f3":function(i,s,o){var u=o("7f9a"),f=o("da84"),d=o("861d"),m=o("9112"),_=o("5135"),w=o("f772"),y=o("d012"),M=f.WeakMap,k,F,I,R=function(U){return I(U)?F(U):k(U,{})},K=function(U){return function(J){var T;if(!d(J)||(T=F(J)).type!==U)throw TypeError("Incompatible receiver, "+U+" required");return T}};if(u){var ee=new M,he=ee.get,fe=ee.has,ve=ee.set;k=function(U,J){return ve.call(ee,U,J),J},F=function(U){return he.call(ee,U)||{}},I=function(U){return fe.call(ee,U)}}else{var z=w("state");y[z]=!0,k=function(U,J){return m(U,z,J),J},F=function(U){return _(U,z)?U[z]:{}},I=function(U){return _(U,z)}}i.exports={set:k,get:F,has:I,enforce:R,getterFor:K}},"6eeb":function(i,s,o){var u=o("da84"),f=o("9112"),d=o("5135"),m=o("ce4e"),_=o("8925"),w=o("69f3"),y=w.get,M=w.enforce,k=String(String).split("String");(i.exports=function(F,I,R,K){var ee=K?!!K.unsafe:!1,he=K?!!K.enumerable:!1,fe=K?!!K.noTargetGet:!1;if(typeof R=="function"&&(typeof I=="string"&&!d(R,"name")&&f(R,"name",I),M(R).source=k.join(typeof I=="string"?I:"")),F===u){he?F[I]=R:m(I,R);return}else ee?!fe&&F[I]&&(he=!0):delete F[I];he?F[I]=R:f(F,I,R)})(Function.prototype,"toString",function(){return typeof this=="function"&&y(this).source||_(this)})},"6f53":function(i,s,o){var u=o("83ab"),f=o("df75"),d=o("fc6a"),m=o("d1e7").f,_=function(w){return function(y){for(var M=d(y),k=f(M),F=k.length,I=0,R=[],K;F>I;)K=k[I++],(!u||m.call(M,K))&&R.push(w?[K,M[K]]:M[K]);return R}};i.exports={entries:_(!0),values:_(!1)}},"73d9":function(i,s,o){var u=o("44d2");u("flatMap")},7418:function(i,s){s.f=Object.getOwnPropertySymbols},"746f":function(i,s,o){var u=o("428f"),f=o("5135"),d=o("e538"),m=o("9bf2").f;i.exports=function(_){var w=u.Symbol||(u.Symbol={});f(w,_)||m(w,_,{value:d.f(_)})}},7839:function(i,s){i.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"7b0b":function(i,s,o){var u=o("1d80");i.exports=function(f){return Object(u(f))}},"7c73":function(i,s,o){var u=o("825a"),f=o("37e8"),d=o("7839"),m=o("d012"),_=o("1be4"),w=o("cc12"),y=o("f772"),M=">",k="<",F="prototype",I="script",R=y("IE_PROTO"),K=function(){},ee=function(U){return k+I+M+U+k+"/"+I+M},he=function(U){U.write(ee("")),U.close();var J=U.parentWindow.Object;return U=null,J},fe=function(){var U=w("iframe"),J="java"+I+":",T;return U.style.display="none",_.appendChild(U),U.src=String(J),T=U.contentWindow.document,T.open(),T.write(ee("document.F=Object")),T.close(),T.F},ve,z=function(){try{ve=document.domain&&new ActiveXObject("htmlfile")}catch{}z=ve?he(ve):fe();for(var U=d.length;U--;)delete z[F][d[U]];return z()};m[R]=!0,i.exports=Object.create||function(J,T){var D;return J!==null?(K[F]=u(J),D=new K,K[F]=null,D[R]=J):D=z(),T===void 0?D:f(D,T)}},"7dd0":function(i,s,o){var u=o("23e7"),f=o("9ed3"),d=o("e163"),m=o("d2bb"),_=o("d44e"),w=o("9112"),y=o("6eeb"),M=o("b622"),k=o("c430"),F=o("3f8c"),I=o("ae93"),R=I.IteratorPrototype,K=I.BUGGY_SAFARI_ITERATORS,ee=M("iterator"),he="keys",fe="values",ve="entries",z=function(){return this};i.exports=function(U,J,T,D,B,$,W){f(T,J,D);var G=function(le){if(le===B&&Te)return Te;if(!K&&le in we)return we[le];switch(le){case he:return function(){return new T(this,le)};case fe:return function(){return new T(this,le)};case ve:return function(){return new T(this,le)}}return function(){return new T(this)}},oe=J+" Iterator",ie=!1,we=U.prototype,Ce=we[ee]||we["@@iterator"]||B&&we[B],Te=!K&&Ce||G(B),Y=J=="Array"&&we.entries||Ce,H,Q,ue;if(Y&&(H=d(Y.call(new U)),R!==Object.prototype&&H.next&&(!k&&d(H)!==R&&(m?m(H,R):typeof H[ee]!="function"&&w(H,ee,z)),_(H,oe,!0,!0),k&&(F[oe]=z))),B==fe&&Ce&&Ce.name!==fe&&(ie=!0,Te=function(){return Ce.call(this)}),(!k||W)&&we[ee]!==Te&&w(we,ee,Te),F[J]=Te,B)if(Q={values:G(fe),keys:$?Te:G(he),entries:G(ve)},W)for(ue in Q)(K||ie||!(ue in we))&&y(we,ue,Q[ue]);else u({target:J,proto:!0,forced:K||ie},Q);return Q}},"7f9a":function(i,s,o){var u=o("da84"),f=o("8925"),d=u.WeakMap;i.exports=typeof d=="function"&&/native code/.test(f(d))},"825a":function(i,s,o){var u=o("861d");i.exports=function(f){if(!u(f))throw TypeError(String(f)+" is not an object");return f}},"83ab":function(i,s,o){var u=o("d039");i.exports=!u(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},8418:function(i,s,o){var u=o("c04e"),f=o("9bf2"),d=o("5c6c");i.exports=function(m,_,w){var y=u(_);y in m?f.f(m,y,d(0,w)):m[y]=w}},"861d":function(i,s){i.exports=function(o){return typeof o=="object"?o!==null:typeof o=="function"}},8875:function(i,s,o){var u,f,d;(function(m,_){f=[],u=_,d=typeof u=="function"?u.apply(s,f):u,d!==void 0&&(i.exports=d)})(typeof self<"u"?self:this,function(){function m(){var _=Object.getOwnPropertyDescriptor(document,"currentScript");if(!_&&"currentScript"in document&&document.currentScript||_&&_.get!==m&&document.currentScript)return document.currentScript;try{throw new Error}catch(ve){var w=/.*at [^(]*\((.*):(.+):(.+)\)$/ig,y=/@([^@]*):(\d+):(\d+)\s*$/ig,M=w.exec(ve.stack)||y.exec(ve.stack),k=M&&M[1]||!1,F=M&&M[2]||!1,I=document.location.href.replace(document.location.hash,""),R,K,ee,he=document.getElementsByTagName("script");k===I&&(R=document.documentElement.outerHTML,K=new RegExp("(?:[^\\n]+?\\n){0,"+(F-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),ee=R.replace(K,"$1").trim());for(var fe=0;fe<he.length;fe++)if(he[fe].readyState==="interactive"||he[fe].src===k||k===I&&he[fe].innerHTML&&he[fe].innerHTML.trim()===ee)return he[fe];return null}}return m})},8925:function(i,s,o){var u=o("c6cd"),f=Function.toString;typeof u.inspectSource!="function"&&(u.inspectSource=function(d){return f.call(d)}),i.exports=u.inspectSource},"8aa5":function(i,s,o){var u=o("6547").charAt;i.exports=function(f,d,m){return d+(m?u(f,d).length:1)}},"8bbf":function(i,s){i.exports=t},"90e3":function(i,s){var o=0,u=Math.random();i.exports=function(f){return"Symbol("+String(f===void 0?"":f)+")_"+(++o+u).toString(36)}},9112:function(i,s,o){var u=o("83ab"),f=o("9bf2"),d=o("5c6c");i.exports=u?function(m,_,w){return f.f(m,_,d(1,w))}:function(m,_,w){return m[_]=w,m}},9263:function(i,s,o){var u=o("ad6d"),f=o("9f7f"),d=RegExp.prototype.exec,m=String.prototype.replace,_=d,w=function(){var F=/a/,I=/b*/g;return d.call(F,"a"),d.call(I,"a"),F.lastIndex!==0||I.lastIndex!==0}(),y=f.UNSUPPORTED_Y||f.BROKEN_CARET,M=/()??/.exec("")[1]!==void 0,k=w||M||y;k&&(_=function(I){var R=this,K,ee,he,fe,ve=y&&R.sticky,z=u.call(R),U=R.source,J=0,T=I;return ve&&(z=z.replace("y",""),z.indexOf("g")===-1&&(z+="g"),T=String(I).slice(R.lastIndex),R.lastIndex>0&&(!R.multiline||R.multiline&&I[R.lastIndex-1]!==`
`)&&(U="(?: "+U+")",T=" "+T,J++),ee=new RegExp("^(?:"+U+")",z)),M&&(ee=new RegExp("^"+U+"$(?!\\s)",z)),w&&(K=R.lastIndex),he=d.call(ve?ee:R,T),ve?he?(he.input=he.input.slice(J),he[0]=he[0].slice(J),he.index=R.lastIndex,R.lastIndex+=he[0].length):R.lastIndex=0:w&&he&&(R.lastIndex=R.global?he.index+he[0].length:K),M&&he&&he.length>1&&m.call(he[0],ee,function(){for(fe=1;fe<arguments.length-2;fe++)arguments[fe]===void 0&&(he[fe]=void 0)}),he}),i.exports=_},"94ca":function(i,s,o){var u=o("d039"),f=/#|\.prototype\./,d=function(M,k){var F=_[m(M)];return F==y?!0:F==w?!1:typeof k=="function"?u(k):!!k},m=d.normalize=function(M){return String(M).replace(f,".").toLowerCase()},_=d.data={},w=d.NATIVE="N",y=d.POLYFILL="P";i.exports=d},"99af":function(i,s,o){var u=o("23e7"),f=o("d039"),d=o("e8b5"),m=o("861d"),_=o("7b0b"),w=o("50c4"),y=o("8418"),M=o("65f0"),k=o("1dde"),F=o("b622"),I=o("2d00"),R=F("isConcatSpreadable"),K=9007199254740991,ee="Maximum allowed index exceeded",he=I>=51||!f(function(){var U=[];return U[R]=!1,U.concat()[0]!==U}),fe=k("concat"),ve=function(U){if(!m(U))return!1;var J=U[R];return J!==void 0?!!J:d(U)},z=!he||!fe;u({target:"Array",proto:!0,forced:z},{concat:function(J){var T=_(this),D=M(T,0),B=0,$,W,G,oe,ie;for($=-1,G=arguments.length;$<G;$++)if(ie=$===-1?T:arguments[$],ve(ie)){if(oe=w(ie.length),B+oe>K)throw TypeError(ee);for(W=0;W<oe;W++,B++)W in ie&&y(D,B,ie[W])}else{if(B>=K)throw TypeError(ee);y(D,B++,ie)}return D.length=B,D}})},"9bdd":function(i,s,o){var u=o("825a");i.exports=function(f,d,m,_){try{return _?d(u(m)[0],m[1]):d(m)}catch(y){var w=f.return;throw w!==void 0&&u(w.call(f)),y}}},"9bf2":function(i,s,o){var u=o("83ab"),f=o("0cfb"),d=o("825a"),m=o("c04e"),_=Object.defineProperty;s.f=u?_:function(y,M,k){if(d(y),M=m(M,!0),d(k),f)try{return _(y,M,k)}catch{}if("get"in k||"set"in k)throw TypeError("Accessors not supported");return"value"in k&&(y[M]=k.value),y}},"9ed3":function(i,s,o){var u=o("ae93").IteratorPrototype,f=o("7c73"),d=o("5c6c"),m=o("d44e"),_=o("3f8c"),w=function(){return this};i.exports=function(y,M,k){var F=M+" Iterator";return y.prototype=f(u,{next:d(1,k)}),m(y,F,!1,!0),_[F]=w,y}},"9f7f":function(i,s,o){var u=o("d039");function f(d,m){return RegExp(d,m)}s.UNSUPPORTED_Y=u(function(){var d=f("a","y");return d.lastIndex=2,d.exec("abcd")!=null}),s.BROKEN_CARET=u(function(){var d=f("^r","gy");return d.lastIndex=2,d.exec("str")!=null})},a2bf:function(i,s,o){var u=o("e8b5"),f=o("50c4"),d=o("0366"),m=function(_,w,y,M,k,F,I,R){for(var K=k,ee=0,he=I?d(I,R,3):!1,fe;ee<M;){if(ee in y){if(fe=he?he(y[ee],ee,w):y[ee],F>0&&u(fe))K=m(_,w,fe,f(fe.length),K,F-1)-1;else{if(K>=9007199254740991)throw TypeError("Exceed the acceptable array length");_[K]=fe}K++}ee++}return K};i.exports=m},a352:function(i,s){i.exports=r},a434:function(i,s,o){var u=o("23e7"),f=o("23cb"),d=o("a691"),m=o("50c4"),_=o("7b0b"),w=o("65f0"),y=o("8418"),M=o("1dde"),k=o("ae40"),F=M("splice"),I=k("splice",{ACCESSORS:!0,0:0,1:2}),R=Math.max,K=Math.min,ee=9007199254740991,he="Maximum allowed length exceeded";u({target:"Array",proto:!0,forced:!F||!I},{splice:function(ve,z){var U=_(this),J=m(U.length),T=f(ve,J),D=arguments.length,B,$,W,G,oe,ie;if(D===0?B=$=0:D===1?(B=0,$=J-T):(B=D-2,$=K(R(d(z),0),J-T)),J+B-$>ee)throw TypeError(he);for(W=w(U,$),G=0;G<$;G++)oe=T+G,oe in U&&y(W,G,U[oe]);if(W.length=$,B<$){for(G=T;G<J-$;G++)oe=G+$,ie=G+B,oe in U?U[ie]=U[oe]:delete U[ie];for(G=J;G>J-$+B;G--)delete U[G-1]}else if(B>$)for(G=J-$;G>T;G--)oe=G+$-1,ie=G+B-1,oe in U?U[ie]=U[oe]:delete U[ie];for(G=0;G<B;G++)U[G+T]=arguments[G+2];return U.length=J-$+B,W}})},a4d3:function(i,s,o){var u=o("23e7"),f=o("da84"),d=o("d066"),m=o("c430"),_=o("83ab"),w=o("4930"),y=o("fdbf"),M=o("d039"),k=o("5135"),F=o("e8b5"),I=o("861d"),R=o("825a"),K=o("7b0b"),ee=o("fc6a"),he=o("c04e"),fe=o("5c6c"),ve=o("7c73"),z=o("df75"),U=o("241c"),J=o("057f"),T=o("7418"),D=o("06cf"),B=o("9bf2"),$=o("d1e7"),W=o("9112"),G=o("6eeb"),oe=o("5692"),ie=o("f772"),we=o("d012"),Ce=o("90e3"),Te=o("b622"),Y=o("e538"),H=o("746f"),Q=o("d44e"),ue=o("69f3"),le=o("b727").forEach,pe=ie("hidden"),Z="Symbol",N="prototype",ke=Te("toPrimitive"),Me=ue.set,Ue=ue.getterFor(Z),ce=Object[N],ne=f.Symbol,ye=d("JSON","stringify"),de=D.f,We=B.f,Ge=J.f,tt=$.f,Ze=oe("symbols"),et=oe("op-symbols"),He=oe("string-to-symbol-registry"),wt=oe("symbol-to-string-registry"),Pt=oe("wks"),kt=f.QObject,Jt=!kt||!kt[N]||!kt[N].findChild,rn=_&&M(function(){return ve(We({},"a",{get:function(){return We(this,"a",{value:7}).a}})).a!=7})?function(En,jn,Mn){var Yn=de(ce,jn);Yn&&delete ce[jn],We(En,jn,Mn),Yn&&En!==ce&&We(ce,jn,Yn)}:We,un=function(En,jn){var Mn=Ze[En]=ve(ne[N]);return Me(Mn,{type:Z,tag:En,description:jn}),_||(Mn.description=jn),Mn},Ke=y?function(En){return typeof En=="symbol"}:function(En){return Object(En)instanceof ne},ot=function(jn,Mn,Yn){jn===ce&&ot(et,Mn,Yn),R(jn);var br=he(Mn,!0);return R(Yn),k(Ze,br)?(Yn.enumerable?(k(jn,pe)&&jn[pe][br]&&(jn[pe][br]=!1),Yn=ve(Yn,{enumerable:fe(0,!1)})):(k(jn,pe)||We(jn,pe,fe(1,{})),jn[pe][br]=!0),rn(jn,br,Yn)):We(jn,br,Yn)},rt=function(jn,Mn){R(jn);var Yn=ee(Mn),br=z(Yn).concat(Nn(Yn));return le(br,function(Or){(!_||Qt.call(Yn,Or))&&ot(jn,Or,Yn[Or])}),jn},Ft=function(jn,Mn){return Mn===void 0?ve(jn):rt(ve(jn),Mn)},Qt=function(jn){var Mn=he(jn,!0),Yn=tt.call(this,Mn);return this===ce&&k(Ze,Mn)&&!k(et,Mn)?!1:Yn||!k(this,Mn)||!k(Ze,Mn)||k(this,pe)&&this[pe][Mn]?Yn:!0},Bn=function(jn,Mn){var Yn=ee(jn),br=he(Mn,!0);if(!(Yn===ce&&k(Ze,br)&&!k(et,br))){var Or=de(Yn,br);return Or&&k(Ze,br)&&!(k(Yn,pe)&&Yn[pe][br])&&(Or.enumerable=!0),Or}},Ln=function(jn){var Mn=Ge(ee(jn)),Yn=[];return le(Mn,function(br){!k(Ze,br)&&!k(we,br)&&Yn.push(br)}),Yn},Nn=function(jn){var Mn=jn===ce,Yn=Ge(Mn?et:ee(jn)),br=[];return le(Yn,function(Or){k(Ze,Or)&&(!Mn||k(ce,Or))&&br.push(Ze[Or])}),br};if(w||(ne=function(){if(this instanceof ne)throw TypeError("Symbol is not a constructor");var jn=!arguments.length||arguments[0]===void 0?void 0:String(arguments[0]),Mn=Ce(jn),Yn=function(br){this===ce&&Yn.call(et,br),k(this,pe)&&k(this[pe],Mn)&&(this[pe][Mn]=!1),rn(this,Mn,fe(1,br))};return _&&Jt&&rn(ce,Mn,{configurable:!0,set:Yn}),un(Mn,jn)},G(ne[N],"toString",function(){return Ue(this).tag}),G(ne,"withoutSetter",function(En){return un(Ce(En),En)}),$.f=Qt,B.f=ot,D.f=Bn,U.f=J.f=Ln,T.f=Nn,Y.f=function(En){return un(Te(En),En)},_&&(We(ne[N],"description",{configurable:!0,get:function(){return Ue(this).description}}),m||G(ce,"propertyIsEnumerable",Qt,{unsafe:!0}))),u({global:!0,wrap:!0,forced:!w,sham:!w},{Symbol:ne}),le(z(Pt),function(En){H(En)}),u({target:Z,stat:!0,forced:!w},{for:function(En){var jn=String(En);if(k(He,jn))return He[jn];var Mn=ne(jn);return He[jn]=Mn,wt[Mn]=jn,Mn},keyFor:function(jn){if(!Ke(jn))throw TypeError(jn+" is not a symbol");if(k(wt,jn))return wt[jn]},useSetter:function(){Jt=!0},useSimple:function(){Jt=!1}}),u({target:"Object",stat:!0,forced:!w,sham:!_},{create:Ft,defineProperty:ot,defineProperties:rt,getOwnPropertyDescriptor:Bn}),u({target:"Object",stat:!0,forced:!w},{getOwnPropertyNames:Ln,getOwnPropertySymbols:Nn}),u({target:"Object",stat:!0,forced:M(function(){T.f(1)})},{getOwnPropertySymbols:function(jn){return T.f(K(jn))}}),ye){var ar=!w||M(function(){var En=ne();return ye([En])!="[null]"||ye({a:En})!="{}"||ye(Object(En))!="{}"});u({target:"JSON",stat:!0,forced:ar},{stringify:function(jn,Mn,Yn){for(var br=[jn],Or=1,gr;arguments.length>Or;)br.push(arguments[Or++]);if(gr=Mn,!(!I(Mn)&&jn===void 0||Ke(jn)))return F(Mn)||(Mn=function(ii,ft){if(typeof gr=="function"&&(ft=gr.call(this,ii,ft)),!Ke(ft))return ft}),br[1]=Mn,ye.apply(null,br)}})}ne[N][ke]||W(ne[N],ke,ne[N].valueOf),Q(ne,Z),we[pe]=!0},a630:function(i,s,o){var u=o("23e7"),f=o("4df4"),d=o("1c7e"),m=!d(function(_){Array.from(_)});u({target:"Array",stat:!0,forced:m},{from:f})},a640:function(i,s,o){var u=o("d039");i.exports=function(f,d){var m=[][f];return!!m&&u(function(){m.call(null,d||function(){throw 1},1)})}},a691:function(i,s){var o=Math.ceil,u=Math.floor;i.exports=function(f){return isNaN(f=+f)?0:(f>0?u:o)(f)}},ab13:function(i,s,o){var u=o("b622"),f=u("match");i.exports=function(d){var m=/./;try{"/./"[d](m)}catch{try{return m[f]=!1,"/./"[d](m)}catch{}}return!1}},ac1f:function(i,s,o){var u=o("23e7"),f=o("9263");u({target:"RegExp",proto:!0,forced:/./.exec!==f},{exec:f})},ad6d:function(i,s,o){var u=o("825a");i.exports=function(){var f=u(this),d="";return f.global&&(d+="g"),f.ignoreCase&&(d+="i"),f.multiline&&(d+="m"),f.dotAll&&(d+="s"),f.unicode&&(d+="u"),f.sticky&&(d+="y"),d}},ae40:function(i,s,o){var u=o("83ab"),f=o("d039"),d=o("5135"),m=Object.defineProperty,_={},w=function(y){throw y};i.exports=function(y,M){if(d(_,y))return _[y];M||(M={});var k=[][y],F=d(M,"ACCESSORS")?M.ACCESSORS:!1,I=d(M,0)?M[0]:w,R=d(M,1)?M[1]:void 0;return _[y]=!!k&&!f(function(){if(F&&!u)return!0;var K={length:-1};F?m(K,1,{enumerable:!0,get:w}):K[1]=1,k.call(K,I,R)})}},ae93:function(i,s,o){var u=o("e163"),f=o("9112"),d=o("5135"),m=o("b622"),_=o("c430"),w=m("iterator"),y=!1,M=function(){return this},k,F,I;[].keys&&(I=[].keys(),"next"in I?(F=u(u(I)),F!==Object.prototype&&(k=F)):y=!0),k==null&&(k={}),!_&&!d(k,w)&&f(k,w,M),i.exports={IteratorPrototype:k,BUGGY_SAFARI_ITERATORS:y}},b041:function(i,s,o){var u=o("00ee"),f=o("f5df");i.exports=u?{}.toString:function(){return"[object "+f(this)+"]"}},b0c0:function(i,s,o){var u=o("83ab"),f=o("9bf2").f,d=Function.prototype,m=d.toString,_=/^\s*function ([^ (]*)/,w="name";u&&!(w in d)&&f(d,w,{configurable:!0,get:function(){try{return m.call(this).match(_)[1]}catch{return""}}})},b622:function(i,s,o){var u=o("da84"),f=o("5692"),d=o("5135"),m=o("90e3"),_=o("4930"),w=o("fdbf"),y=f("wks"),M=u.Symbol,k=w?M:M&&M.withoutSetter||m;i.exports=function(F){return d(y,F)||(_&&d(M,F)?y[F]=M[F]:y[F]=k("Symbol."+F)),y[F]}},b64b:function(i,s,o){var u=o("23e7"),f=o("7b0b"),d=o("df75"),m=o("d039"),_=m(function(){d(1)});u({target:"Object",stat:!0,forced:_},{keys:function(y){return d(f(y))}})},b727:function(i,s,o){var u=o("0366"),f=o("44ad"),d=o("7b0b"),m=o("50c4"),_=o("65f0"),w=[].push,y=function(M){var k=M==1,F=M==2,I=M==3,R=M==4,K=M==6,ee=M==5||K;return function(he,fe,ve,z){for(var U=d(he),J=f(U),T=u(fe,ve,3),D=m(J.length),B=0,$=z||_,W=k?$(he,D):F?$(he,0):void 0,G,oe;D>B;B++)if((ee||B in J)&&(G=J[B],oe=T(G,B,U),M)){if(k)W[B]=oe;else if(oe)switch(M){case 3:return!0;case 5:return G;case 6:return B;case 2:w.call(W,G)}else if(R)return!1}return K?-1:I||R?R:W}};i.exports={forEach:y(0),map:y(1),filter:y(2),some:y(3),every:y(4),find:y(5),findIndex:y(6)}},c04e:function(i,s,o){var u=o("861d");i.exports=function(f,d){if(!u(f))return f;var m,_;if(d&&typeof(m=f.toString)=="function"&&!u(_=m.call(f))||typeof(m=f.valueOf)=="function"&&!u(_=m.call(f))||!d&&typeof(m=f.toString)=="function"&&!u(_=m.call(f)))return _;throw TypeError("Can't convert object to primitive value")}},c430:function(i,s){i.exports=!1},c6b6:function(i,s){var o={}.toString;i.exports=function(u){return o.call(u).slice(8,-1)}},c6cd:function(i,s,o){var u=o("da84"),f=o("ce4e"),d="__core-js_shared__",m=u[d]||f(d,{});i.exports=m},c740:function(i,s,o){var u=o("23e7"),f=o("b727").findIndex,d=o("44d2"),m=o("ae40"),_="findIndex",w=!0,y=m(_);_ in[]&&Array(1)[_](function(){w=!1}),u({target:"Array",proto:!0,forced:w||!y},{findIndex:function(k){return f(this,k,arguments.length>1?arguments[1]:void 0)}}),d(_)},c8ba:function(i,s){var o;o=function(){return this}();try{o=o||new Function("return this")()}catch{typeof window=="object"&&(o=window)}i.exports=o},c975:function(i,s,o){var u=o("23e7"),f=o("4d64").indexOf,d=o("a640"),m=o("ae40"),_=[].indexOf,w=!!_&&1/[1].indexOf(1,-0)<0,y=d("indexOf"),M=m("indexOf",{ACCESSORS:!0,1:0});u({target:"Array",proto:!0,forced:w||!y||!M},{indexOf:function(F){return w?_.apply(this,arguments)||0:f(this,F,arguments.length>1?arguments[1]:void 0)}})},ca84:function(i,s,o){var u=o("5135"),f=o("fc6a"),d=o("4d64").indexOf,m=o("d012");i.exports=function(_,w){var y=f(_),M=0,k=[],F;for(F in y)!u(m,F)&&u(y,F)&&k.push(F);for(;w.length>M;)u(y,F=w[M++])&&(~d(k,F)||k.push(F));return k}},caad:function(i,s,o){var u=o("23e7"),f=o("4d64").includes,d=o("44d2"),m=o("ae40"),_=m("indexOf",{ACCESSORS:!0,1:0});u({target:"Array",proto:!0,forced:!_},{includes:function(y){return f(this,y,arguments.length>1?arguments[1]:void 0)}}),d("includes")},cc12:function(i,s,o){var u=o("da84"),f=o("861d"),d=u.document,m=f(d)&&f(d.createElement);i.exports=function(_){return m?d.createElement(_):{}}},ce4e:function(i,s,o){var u=o("da84"),f=o("9112");i.exports=function(d,m){try{f(u,d,m)}catch{u[d]=m}return m}},d012:function(i,s){i.exports={}},d039:function(i,s){i.exports=function(o){try{return!!o()}catch{return!0}}},d066:function(i,s,o){var u=o("428f"),f=o("da84"),d=function(m){return typeof m=="function"?m:void 0};i.exports=function(m,_){return arguments.length<2?d(u[m])||d(f[m]):u[m]&&u[m][_]||f[m]&&f[m][_]}},d1e7:function(i,s,o){var u={}.propertyIsEnumerable,f=Object.getOwnPropertyDescriptor,d=f&&!u.call({1:2},1);s.f=d?function(_){var w=f(this,_);return!!w&&w.enumerable}:u},d28b:function(i,s,o){var u=o("746f");u("iterator")},d2bb:function(i,s,o){var u=o("825a"),f=o("3bbe");i.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var d=!1,m={},_;try{_=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,_.call(m,[]),d=m instanceof Array}catch{}return function(y,M){return u(y),f(M),d?_.call(y,M):y.__proto__=M,y}}():void 0)},d3b7:function(i,s,o){var u=o("00ee"),f=o("6eeb"),d=o("b041");u||f(Object.prototype,"toString",d,{unsafe:!0})},d44e:function(i,s,o){var u=o("9bf2").f,f=o("5135"),d=o("b622"),m=d("toStringTag");i.exports=function(_,w,y){_&&!f(_=y?_:_.prototype,m)&&u(_,m,{configurable:!0,value:w})}},d58f:function(i,s,o){var u=o("1c0b"),f=o("7b0b"),d=o("44ad"),m=o("50c4"),_=function(w){return function(y,M,k,F){u(M);var I=f(y),R=d(I),K=m(I.length),ee=w?K-1:0,he=w?-1:1;if(k<2)for(;;){if(ee in R){F=R[ee],ee+=he;break}if(ee+=he,w?ee<0:K<=ee)throw TypeError("Reduce of empty array with no initial value")}for(;w?ee>=0:K>ee;ee+=he)ee in R&&(F=M(F,R[ee],ee,I));return F}};i.exports={left:_(!1),right:_(!0)}},d784:function(i,s,o){o("ac1f");var u=o("6eeb"),f=o("d039"),d=o("b622"),m=o("9263"),_=o("9112"),w=d("species"),y=!f(function(){var R=/./;return R.exec=function(){var K=[];return K.groups={a:"7"},K},"".replace(R,"$<a>")!=="7"}),M=function(){return"a".replace(/./,"$0")==="$0"}(),k=d("replace"),F=function(){return/./[k]?/./[k]("a","$0")==="":!1}(),I=!f(function(){var R=/(?:)/,K=R.exec;R.exec=function(){return K.apply(this,arguments)};var ee="ab".split(R);return ee.length!==2||ee[0]!=="a"||ee[1]!=="b"});i.exports=function(R,K,ee,he){var fe=d(R),ve=!f(function(){var B={};return B[fe]=function(){return 7},""[R](B)!=7}),z=ve&&!f(function(){var B=!1,$=/a/;return R==="split"&&($={},$.constructor={},$.constructor[w]=function(){return $},$.flags="",$[fe]=/./[fe]),$.exec=function(){return B=!0,null},$[fe](""),!B});if(!ve||!z||R==="replace"&&!(y&&M&&!F)||R==="split"&&!I){var U=/./[fe],J=ee(fe,""[R],function(B,$,W,G,oe){return $.exec===m?ve&&!oe?{done:!0,value:U.call($,W,G)}:{done:!0,value:B.call(W,$,G)}:{done:!1}},{REPLACE_KEEPS_$0:M,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:F}),T=J[0],D=J[1];u(String.prototype,R,T),u(RegExp.prototype,fe,K==2?function(B,$){return D.call(B,this,$)}:function(B){return D.call(B,this)})}he&&_(RegExp.prototype[fe],"sham",!0)}},d81d:function(i,s,o){var u=o("23e7"),f=o("b727").map,d=o("1dde"),m=o("ae40"),_=d("map"),w=m("map");u({target:"Array",proto:!0,forced:!_||!w},{map:function(M){return f(this,M,arguments.length>1?arguments[1]:void 0)}})},da84:function(i,s,o){(function(u){var f=function(d){return d&&d.Math==Math&&d};i.exports=f(typeof globalThis=="object"&&globalThis)||f(typeof window=="object"&&window)||f(typeof self=="object"&&self)||f(typeof u=="object"&&u)||Function("return this")()}).call(this,o("c8ba"))},dbb4:function(i,s,o){var u=o("23e7"),f=o("83ab"),d=o("56ef"),m=o("fc6a"),_=o("06cf"),w=o("8418");u({target:"Object",stat:!0,sham:!f},{getOwnPropertyDescriptors:function(M){for(var k=m(M),F=_.f,I=d(k),R={},K=0,ee,he;I.length>K;)he=F(k,ee=I[K++]),he!==void 0&&w(R,ee,he);return R}})},dbf1:function(i,s,o){(function(u){o.d(s,"a",function(){return d});function f(){return typeof window<"u"?window.console:u.console}var d=f()}).call(this,o("c8ba"))},ddb0:function(i,s,o){var u=o("da84"),f=o("fdbc"),d=o("e260"),m=o("9112"),_=o("b622"),w=_("iterator"),y=_("toStringTag"),M=d.values;for(var k in f){var F=u[k],I=F&&F.prototype;if(I){if(I[w]!==M)try{m(I,w,M)}catch{I[w]=M}if(I[y]||m(I,y,k),f[k]){for(var R in d)if(I[R]!==d[R])try{m(I,R,d[R])}catch{I[R]=d[R]}}}}},df75:function(i,s,o){var u=o("ca84"),f=o("7839");i.exports=Object.keys||function(m){return u(m,f)}},e01a:function(i,s,o){var u=o("23e7"),f=o("83ab"),d=o("da84"),m=o("5135"),_=o("861d"),w=o("9bf2").f,y=o("e893"),M=d.Symbol;if(f&&typeof M=="function"&&(!("description"in M.prototype)||M().description!==void 0)){var k={},F=function(){var fe=arguments.length<1||arguments[0]===void 0?void 0:String(arguments[0]),ve=this instanceof F?new M(fe):fe===void 0?M():M(fe);return fe===""&&(k[ve]=!0),ve};y(F,M);var I=F.prototype=M.prototype;I.constructor=F;var R=I.toString,K=String(M("test"))=="Symbol(test)",ee=/^Symbol\((.*)\)[^)]+$/;w(I,"description",{configurable:!0,get:function(){var fe=_(this)?this.valueOf():this,ve=R.call(fe);if(m(k,fe))return"";var z=K?ve.slice(7,-1):ve.replace(ee,"$1");return z===""?void 0:z}}),u({global:!0,forced:!0},{Symbol:F})}},e163:function(i,s,o){var u=o("5135"),f=o("7b0b"),d=o("f772"),m=o("e177"),_=d("IE_PROTO"),w=Object.prototype;i.exports=m?Object.getPrototypeOf:function(y){return y=f(y),u(y,_)?y[_]:typeof y.constructor=="function"&&y instanceof y.constructor?y.constructor.prototype:y instanceof Object?w:null}},e177:function(i,s,o){var u=o("d039");i.exports=!u(function(){function f(){}return f.prototype.constructor=null,Object.getPrototypeOf(new f)!==f.prototype})},e260:function(i,s,o){var u=o("fc6a"),f=o("44d2"),d=o("3f8c"),m=o("69f3"),_=o("7dd0"),w="Array Iterator",y=m.set,M=m.getterFor(w);i.exports=_(Array,"Array",function(k,F){y(this,{type:w,target:u(k),index:0,kind:F})},function(){var k=M(this),F=k.target,I=k.kind,R=k.index++;return!F||R>=F.length?(k.target=void 0,{value:void 0,done:!0}):I=="keys"?{value:R,done:!1}:I=="values"?{value:F[R],done:!1}:{value:[R,F[R]],done:!1}},"values"),d.Arguments=d.Array,f("keys"),f("values"),f("entries")},e439:function(i,s,o){var u=o("23e7"),f=o("d039"),d=o("fc6a"),m=o("06cf").f,_=o("83ab"),w=f(function(){m(1)}),y=!_||w;u({target:"Object",stat:!0,forced:y,sham:!_},{getOwnPropertyDescriptor:function(k,F){return m(d(k),F)}})},e538:function(i,s,o){var u=o("b622");s.f=u},e893:function(i,s,o){var u=o("5135"),f=o("56ef"),d=o("06cf"),m=o("9bf2");i.exports=function(_,w){for(var y=f(w),M=m.f,k=d.f,F=0;F<y.length;F++){var I=y[F];u(_,I)||M(_,I,k(w,I))}}},e8b5:function(i,s,o){var u=o("c6b6");i.exports=Array.isArray||function(d){return u(d)=="Array"}},e95a:function(i,s,o){var u=o("b622"),f=o("3f8c"),d=u("iterator"),m=Array.prototype;i.exports=function(_){return _!==void 0&&(f.Array===_||m[d]===_)}},f5df:function(i,s,o){var u=o("00ee"),f=o("c6b6"),d=o("b622"),m=d("toStringTag"),_=f(function(){return arguments}())=="Arguments",w=function(y,M){try{return y[M]}catch{}};i.exports=u?f:function(y){var M,k,F;return y===void 0?"Undefined":y===null?"Null":typeof(k=w(M=Object(y),m))=="string"?k:_?f(M):(F=f(M))=="Object"&&typeof M.callee=="function"?"Arguments":F}},f772:function(i,s,o){var u=o("5692"),f=o("90e3"),d=u("keys");i.exports=function(m){return d[m]||(d[m]=f(m))}},fb15:function(i,s,o){if(o.r(s),typeof window<"u"){var u=window.document.currentScript;{var f=o("8875");u=f(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:f})}var d=u&&u.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);d&&(o.p=d[1])}o("99af"),o("4de4"),o("4160"),o("c975"),o("d81d"),o("a434"),o("159b"),o("a4d3"),o("e439"),o("dbb4"),o("b64b");function m(Ke,ot,rt){return ot in Ke?Object.defineProperty(Ke,ot,{value:rt,enumerable:!0,configurable:!0,writable:!0}):Ke[ot]=rt,Ke}function _(Ke,ot){var rt=Object.keys(Ke);if(Object.getOwnPropertySymbols){var Ft=Object.getOwnPropertySymbols(Ke);ot&&(Ft=Ft.filter(function(Qt){return Object.getOwnPropertyDescriptor(Ke,Qt).enumerable})),rt.push.apply(rt,Ft)}return rt}function w(Ke){for(var ot=1;ot<arguments.length;ot++){var rt=arguments[ot]!=null?arguments[ot]:{};ot%2?_(Object(rt),!0).forEach(function(Ft){m(Ke,Ft,rt[Ft])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ke,Object.getOwnPropertyDescriptors(rt)):_(Object(rt)).forEach(function(Ft){Object.defineProperty(Ke,Ft,Object.getOwnPropertyDescriptor(rt,Ft))})}return Ke}function y(Ke){if(Array.isArray(Ke))return Ke}o("e01a"),o("d28b"),o("e260"),o("d3b7"),o("3ca3"),o("ddb0");function M(Ke,ot){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(Ke)))){var rt=[],Ft=!0,Qt=!1,Bn=void 0;try{for(var Ln=Ke[Symbol.iterator](),Nn;!(Ft=(Nn=Ln.next()).done)&&(rt.push(Nn.value),!(ot&&rt.length===ot));Ft=!0);}catch(ar){Qt=!0,Bn=ar}finally{try{!Ft&&Ln.return!=null&&Ln.return()}finally{if(Qt)throw Bn}}return rt}}o("a630"),o("fb6a"),o("b0c0"),o("25f0");function k(Ke,ot){(ot==null||ot>Ke.length)&&(ot=Ke.length);for(var rt=0,Ft=new Array(ot);rt<ot;rt++)Ft[rt]=Ke[rt];return Ft}function F(Ke,ot){if(Ke){if(typeof Ke=="string")return k(Ke,ot);var rt=Object.prototype.toString.call(Ke).slice(8,-1);if(rt==="Object"&&Ke.constructor&&(rt=Ke.constructor.name),rt==="Map"||rt==="Set")return Array.from(Ke);if(rt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(rt))return k(Ke,ot)}}function I(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function R(Ke,ot){return y(Ke)||M(Ke,ot)||F(Ke,ot)||I()}function K(Ke){if(Array.isArray(Ke))return k(Ke)}function ee(Ke){if(typeof Symbol<"u"&&Symbol.iterator in Object(Ke))return Array.from(Ke)}function he(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fe(Ke){return K(Ke)||ee(Ke)||F(Ke)||he()}var ve=o("a352"),z=o.n(ve);function U(Ke){Ke.parentElement!==null&&Ke.parentElement.removeChild(Ke)}function J(Ke,ot,rt){var Ft=rt===0?Ke.children[0]:Ke.children[rt-1].nextSibling;Ke.insertBefore(ot,Ft)}var T=o("dbf1");o("13d5"),o("4fad"),o("ac1f"),o("5319");function D(Ke){var ot=Object.create(null);return function(Ft){var Qt=ot[Ft];return Qt||(ot[Ft]=Ke(Ft))}}var B=/-(\w)/g,$=D(function(Ke){return Ke.replace(B,function(ot,rt){return rt.toUpperCase()})});o("5db7"),o("73d9");var W=["Start","Add","Remove","Update","End"],G=["Choose","Unchoose","Sort","Filter","Clone"],oe=["Move"],ie=[oe,W,G].flatMap(function(Ke){return Ke}).map(function(Ke){return"on".concat(Ke)}),we={manage:oe,manageAndEmit:W,emit:G};function Ce(Ke){return ie.indexOf(Ke)!==-1}o("caad"),o("2ca0");var Te=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"];function Y(Ke){return Te.includes(Ke)}function H(Ke){return["transition-group","TransitionGroup"].includes(Ke)}function Q(Ke){return["id","class","role","style"].includes(Ke)||Ke.startsWith("data-")||Ke.startsWith("aria-")||Ke.startsWith("on")}function ue(Ke){return Ke.reduce(function(ot,rt){var Ft=R(rt,2),Qt=Ft[0],Bn=Ft[1];return ot[Qt]=Bn,ot},{})}function le(Ke){var ot=Ke.$attrs,rt=Ke.componentData,Ft=rt===void 0?{}:rt,Qt=ue(Object.entries(ot).filter(function(Bn){var Ln=R(Bn,2),Nn=Ln[0];return Ln[1],Q(Nn)}));return w(w({},Qt),Ft)}function pe(Ke){var ot=Ke.$attrs,rt=Ke.callBackBuilder,Ft=ue(Z(ot));Object.entries(rt).forEach(function(Bn){var Ln=R(Bn,2),Nn=Ln[0],ar=Ln[1];we[Nn].forEach(function(En){Ft["on".concat(En)]=ar(En)})});var Qt="[data-draggable]".concat(Ft.draggable||"");return w(w({},Ft),{},{draggable:Qt})}function Z(Ke){return Object.entries(Ke).filter(function(ot){var rt=R(ot,2),Ft=rt[0];return rt[1],!Q(Ft)}).map(function(ot){var rt=R(ot,2),Ft=rt[0],Qt=rt[1];return[$(Ft),Qt]}).filter(function(ot){var rt=R(ot,2),Ft=rt[0];return rt[1],!Ce(Ft)})}o("c740");function N(Ke,ot){if(!(Ke instanceof ot))throw new TypeError("Cannot call a class as a function")}function ke(Ke,ot){for(var rt=0;rt<ot.length;rt++){var Ft=ot[rt];Ft.enumerable=Ft.enumerable||!1,Ft.configurable=!0,"value"in Ft&&(Ft.writable=!0),Object.defineProperty(Ke,Ft.key,Ft)}}function Me(Ke,ot,rt){return ot&&ke(Ke.prototype,ot),Ke}var Ue=function(ot){var rt=ot.el;return rt},ce=function(ot,rt){return ot.__draggable_context=rt},ne=function(ot){return ot.__draggable_context},ye=function(){function Ke(ot){var rt=ot.nodes,Ft=rt.header,Qt=rt.default,Bn=rt.footer,Ln=ot.root,Nn=ot.realList;N(this,Ke),this.defaultNodes=Qt,this.children=[].concat(fe(Ft),fe(Qt),fe(Bn)),this.externalComponent=Ln.externalComponent,this.rootTransition=Ln.transition,this.tag=Ln.tag,this.realList=Nn}return Me(Ke,[{key:"render",value:function(rt,Ft){var Qt=this.tag,Bn=this.children,Ln=this._isRootComponent,Nn=Ln?{default:function(){return Bn}}:Bn;return rt(Qt,Ft,Nn)}},{key:"updated",value:function(){var rt=this.defaultNodes,Ft=this.realList;rt.forEach(function(Qt,Bn){ce(Ue(Qt),{element:Ft[Bn],index:Bn})})}},{key:"getUnderlyingVm",value:function(rt){return ne(rt)}},{key:"getVmIndexFromDomIndex",value:function(rt,Ft){var Qt=this.defaultNodes,Bn=Qt.length,Ln=Ft.children,Nn=Ln.item(rt);if(Nn===null)return Bn;var ar=ne(Nn);if(ar)return ar.index;if(Bn===0)return 0;var En=Ue(Qt[0]),jn=fe(Ln).findIndex(function(Mn){return Mn===En});return rt<jn?0:Bn}},{key:"_isRootComponent",get:function(){return this.externalComponent||this.rootTransition}}]),Ke}(),de=o("8bbf");function We(Ke,ot){var rt=Ke[ot];return rt?rt():[]}function Ge(Ke){var ot=Ke.$slots,rt=Ke.realList,Ft=Ke.getKey,Qt=rt||[],Bn=["header","footer"].map(function(Mn){return We(ot,Mn)}),Ln=R(Bn,2),Nn=Ln[0],ar=Ln[1],En=ot.item;if(!En)throw new Error("draggable element must have an item slot");var jn=Qt.flatMap(function(Mn,Yn){return En({element:Mn,index:Yn}).map(function(br){return br.key=Ft(Mn),br.props=w(w({},br.props||{}),{},{"data-draggable":!0}),br})});if(jn.length!==Qt.length)throw new Error("Item slot must have only one child");return{header:Nn,footer:ar,default:jn}}function tt(Ke){var ot=H(Ke),rt=!Y(Ke)&&!ot;return{transition:ot,externalComponent:rt,tag:rt?Object(de.resolveComponent)(Ke):ot?de.TransitionGroup:Ke}}function Ze(Ke){var ot=Ke.$slots,rt=Ke.tag,Ft=Ke.realList,Qt=Ke.getKey,Bn=Ge({$slots:ot,realList:Ft,getKey:Qt}),Ln=tt(rt);return new ye({nodes:Bn,root:Ln,realList:Ft})}function et(Ke,ot){var rt=this;Object(de.nextTick)(function(){return rt.$emit(Ke.toLowerCase(),ot)})}function He(Ke){var ot=this;return function(rt,Ft){if(ot.realList!==null)return ot["onDrag".concat(Ke)](rt,Ft)}}function wt(Ke){var ot=this,rt=He.call(this,Ke);return function(Ft,Qt){rt.call(ot,Ft,Qt),et.call(ot,Ke,Ft)}}var Pt=null,kt={list:{type:Array,required:!1,default:null},modelValue:{type:Array,required:!1,default:null},itemKey:{type:[String,Function],required:!0},clone:{type:Function,default:function(ot){return ot}},tag:{type:String,default:"div"},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},Jt=["update:modelValue","change"].concat(fe([].concat(fe(we.manageAndEmit),fe(we.emit)).map(function(Ke){return Ke.toLowerCase()}))),rn=Object(de.defineComponent)({name:"draggable",inheritAttrs:!1,props:kt,emits:Jt,data:function(){return{error:!1}},render:function(){try{this.error=!1;var ot=this.$slots,rt=this.$attrs,Ft=this.tag,Qt=this.componentData,Bn=this.realList,Ln=this.getKey,Nn=Ze({$slots:ot,tag:Ft,realList:Bn,getKey:Ln});this.componentStructure=Nn;var ar=le({$attrs:rt,componentData:Qt});return Nn.render(de.h,ar)}catch(En){return this.error=!0,Object(de.h)("pre",{style:{color:"red"}},En.stack)}},created:function(){this.list!==null&&this.modelValue!==null&&T.a.error("modelValue and list props are mutually exclusive! Please set one or another.")},mounted:function(){var ot=this;if(!this.error){var rt=this.$attrs,Ft=this.$el,Qt=this.componentStructure;Qt.updated();var Bn=pe({$attrs:rt,callBackBuilder:{manageAndEmit:function(ar){return wt.call(ot,ar)},emit:function(ar){return et.bind(ot,ar)},manage:function(ar){return He.call(ot,ar)}}}),Ln=Ft.nodeType===1?Ft:Ft.parentElement;this._sortable=new z.a(Ln,Bn),this.targetDomElement=Ln,Ln.__draggable_component__=this}},updated:function(){this.componentStructure.updated()},beforeUnmount:function(){this._sortable!==void 0&&this._sortable.destroy()},computed:{realList:function(){var ot=this.list;return ot||this.modelValue},getKey:function(){var ot=this.itemKey;return typeof ot=="function"?ot:function(rt){return rt[ot]}}},watch:{$attrs:{handler:function(ot){var rt=this._sortable;rt&&Z(ot).forEach(function(Ft){var Qt=R(Ft,2),Bn=Qt[0],Ln=Qt[1];rt.option(Bn,Ln)})},deep:!0}},methods:{getUnderlyingVm:function(ot){return this.componentStructure.getUnderlyingVm(ot)||null},getUnderlyingPotencialDraggableComponent:function(ot){return ot.__draggable_component__},emitChanges:function(ot){var rt=this;Object(de.nextTick)(function(){return rt.$emit("change",ot)})},alterList:function(ot){if(this.list){ot(this.list);return}var rt=fe(this.modelValue);ot(rt),this.$emit("update:modelValue",rt)},spliceList:function(){var ot=arguments,rt=function(Qt){return Qt.splice.apply(Qt,fe(ot))};this.alterList(rt)},updatePosition:function(ot,rt){var Ft=function(Bn){return Bn.splice(rt,0,Bn.splice(ot,1)[0])};this.alterList(Ft)},getRelatedContextFromMoveEvent:function(ot){var rt=ot.to,Ft=ot.related,Qt=this.getUnderlyingPotencialDraggableComponent(rt);if(!Qt)return{component:Qt};var Bn=Qt.realList,Ln={list:Bn,component:Qt};if(rt!==Ft&&Bn){var Nn=Qt.getUnderlyingVm(Ft)||{};return w(w({},Nn),Ln)}return Ln},getVmIndexFromDomIndex:function(ot){return this.componentStructure.getVmIndexFromDomIndex(ot,this.targetDomElement)},onDragStart:function(ot){this.context=this.getUnderlyingVm(ot.item),ot.item._underlying_vm_=this.clone(this.context.element),Pt=ot.item},onDragAdd:function(ot){var rt=ot.item._underlying_vm_;if(rt!==void 0){U(ot.item);var Ft=this.getVmIndexFromDomIndex(ot.newIndex);this.spliceList(Ft,0,rt);var Qt={element:rt,newIndex:Ft};this.emitChanges({added:Qt})}},onDragRemove:function(ot){if(J(this.$el,ot.item,ot.oldIndex),ot.pullMode==="clone"){U(ot.clone);return}var rt=this.context,Ft=rt.index,Qt=rt.element;this.spliceList(Ft,1);var Bn={element:Qt,oldIndex:Ft};this.emitChanges({removed:Bn})},onDragUpdate:function(ot){U(ot.item),J(ot.from,ot.item,ot.oldIndex);var rt=this.context.index,Ft=this.getVmIndexFromDomIndex(ot.newIndex);this.updatePosition(rt,Ft);var Qt={element:this.context.element,oldIndex:rt,newIndex:Ft};this.emitChanges({moved:Qt})},computeFutureIndex:function(ot,rt){if(!ot.element)return 0;var Ft=fe(rt.to.children).filter(function(Nn){return Nn.style.display!=="none"}),Qt=Ft.indexOf(rt.related),Bn=ot.component.getVmIndexFromDomIndex(Qt),Ln=Ft.indexOf(Pt)!==-1;return Ln||!rt.willInsertAfter?Bn:Bn+1},onDragMove:function(ot,rt){var Ft=this.move,Qt=this.realList;if(!Ft||!Qt)return!0;var Bn=this.getRelatedContextFromMoveEvent(ot),Ln=this.computeFutureIndex(Bn,ot),Nn=w(w({},this.context),{},{futureIndex:Ln}),ar=w(w({},ot),{},{relatedContext:Bn,draggedContext:Nn});return Ft(ar,rt)},onDragEnd:function(){Pt=null}}}),un=rn;s.default=un},fb6a:function(i,s,o){var u=o("23e7"),f=o("861d"),d=o("e8b5"),m=o("23cb"),_=o("50c4"),w=o("fc6a"),y=o("8418"),M=o("b622"),k=o("1dde"),F=o("ae40"),I=k("slice"),R=F("slice",{ACCESSORS:!0,0:0,1:2}),K=M("species"),ee=[].slice,he=Math.max;u({target:"Array",proto:!0,forced:!I||!R},{slice:function(ve,z){var U=w(this),J=_(U.length),T=m(ve,J),D=m(z===void 0?J:z,J),B,$,W;if(d(U)&&(B=U.constructor,typeof B=="function"&&(B===Array||d(B.prototype))?B=void 0:f(B)&&(B=B[K],B===null&&(B=void 0)),B===Array||B===void 0))return ee.call(U,T,D);for($=new(B===void 0?Array:B)(he(D-T,0)),W=0;T<D;T++,W++)T in U&&y($,W,U[T]);return $.length=W,$}})},fc6a:function(i,s,o){var u=o("44ad"),f=o("1d80");i.exports=function(d){return u(f(d))}},fdbc:function(i,s){i.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},fdbf:function(i,s,o){var u=o("4930");i.exports=u&&!Symbol.sham&&typeof Symbol.iterator=="symbol"}}).default})})(Bx);var JU=Bx.exports;const XU=fy(JU),QU={class:"h-full bg-gray-50"},eV={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},tV={class:"sm:flex sm:items-center"},nV={class:"mt-4 sm:mt-0 sm:ml-16 sm:flex-none"},rV={key:0,class:"origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none z-10"},iV={class:"mt-6 bg-white shadow rounded-lg p-4"},oV={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},sV=["value"],aV={key:0,class:"mt-6 p-6 text-center bg-white shadow rounded-lg"},lV={key:1,class:"mt-6 overflow-x-auto pb-4"},uV={key:0,class:"p-6 text-center bg-white shadow rounded-lg mb-4"},cV={class:"flex space-x-4 min-w-max"},fV={class:"bg-white rounded-lg shadow overflow-hidden"},hV={class:"flex items-center"},dV={class:"flex items-center"},pV={class:"text-xs text-gray-500 bg-white px-2 py-1 rounded-full"},gV={class:"p-2 max-h-[calc(100vh-250px)] overflow-y-auto"},mV={class:"min-h-[100px] draggable-container"},vV={class:"note-container"},yV={class:"bg-white rounded-md shadow-sm border border-gray-200 overflow-hidden"},_V={class:"p-3 flex items-center justify-between note-drag-handle cursor-move no-select"},bV={class:"flex items-center"},wV={class:"text-sm font-medium text-gray-900 truncate"},xV={class:"px-3 py-2"},LV={class:"text-sm text-gray-500 line-clamp-2"},SV={class:"px-3 py-2 bg-gray-50 border-t border-gray-100 flex justify-between items-center"},EV={class:"text-xs text-gray-500"},CV={class:"flex space-x-1"},PV={key:0,class:"text-xs text-primary-500 flex items-center mr-1",title:"Note géolocalisée"},MV={key:1,class:"text-xs text-gray-400 flex items-center mr-1",title:"Note simple"},AV=["onClick"],kV=["onClick"],TV=["onClick"],NV=["onClick"],DV={key:0,class:"fixed z-[3001] inset-0 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},IV={class:"flex items-center justify-center min-h-screen w-full"},OV={class:"relative bg-white w-full h-full md:rounded-lg md:max-w-lg md:h-auto md:max-h-[90vh] md:my-8 shadow-xl transform transition-all overflow-hidden"},BV={class:"mt-6 flex flex-col-reverse sm:flex-row-reverse sm:justify-end gap-3 p-4 md:px-6"},RV=ds({__name:"NotesView",setup(e){const n=Bp(),t=vu(),r=lh(),i=cd(),s=zt(!0),o=zt(!1),u=zt(!1),f=zt(null),d=zt(null),m=zt("info"),_=zt(null),w=sr(()=>{const Te=r.getSortedColumns;return console.log("[NotesView][columnsForDrag] Colonnes triées:",Te),Te}),y=[{id:Xi.PRIVATE,title:"Privé",description:"Visible uniquement par vous"},{id:Xi.COMPANY,title:"Entreprise",description:"Visible uniquement par l'entreprise"},{id:Xi.EMPLOYEE,title:"Salariés",description:"Visible par l'entreprise et ses salariés"},{id:Xi.VISITOR,title:"Visiteurs",description:"Visible par tous (entreprise, salariés et visiteurs)"}],M=Yl({search:"",date:"",accessLevel:""});function k(Te){if(!Te)return"Date non définie";try{const Y=new Date(Te);return isNaN(Y.getTime())?(console.warn("[safeFormatDate] Date invalide:",Te),"Date invalide"):new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(Y)}catch(Y){return console.error("[safeFormatDate] Erreur lors du formatage de la date:",Y),"Date invalide"}}function F(Te){if(!Te)return null;try{const Y=new Date(Te);return isNaN(Y.getTime())?(console.warn("[safeDate] Date invalide:",Te),null):Y}catch(Y){return console.error("[safeDate] Erreur lors de la création de la date:",Y),null}}function I(Te){return k(Te)}const R=sr(()=>{let Te=r.getAccessibleNotes;if(M.search){const Y=M.search.toLowerCase();Te=Te.filter(H=>H.title.toLowerCase().includes(Y)||H.description.toLowerCase().includes(Y))}if(M.accessLevel&&(Te=Te.filter(Y=>Y.accessLevel===M.accessLevel)),M.date){const Y=new Date;Y.setHours(0,0,0,0);const H=new Date(Y);H.setDate(Y.getDate()-Y.getDay());const Q=new Date(Y.getFullYear(),Y.getMonth(),1);Te=Te.filter(ue=>{const le=F(ue.createdAt);return le?M.date==="today"?le>=Y:M.date==="week"?le>=H:M.date==="month"?le>=Q:!0:!1})}return Te}),K=sr(()=>Te=>r.getNotesByColumn(Te));function ee(Te){if(Te==null)return"Non défini";switch(Te){case Xi.PRIVATE:return"Privé";case Xi.COMPANY:return"Entreprise";case Xi.EMPLOYEE:return"Salariés";case Xi.VISITOR:return"Visiteurs";default:return"Non défini"}}function he(Te){if(Te==null)return"#9CA3AF";switch(Te){case Xi.PRIVATE:return"#9CA3AF";case Xi.COMPANY:return"#EF4444";case Xi.EMPLOYEE:return"#F59E0B";case Xi.VISITOR:return"#10B981";default:return"#6B7280"}}Cs(()=>{console.log("[NotesView] Composant monté"),fe().then(()=>{console.log("[NotesView] Données chargées avec succès")}).catch(Te=>{console.error("[NotesView] Erreur lors du chargement des données:",Te),t.error("Erreur lors du chargement des données")})});async function fe(){console.log(`
[NotesView][loadInitialData] Début du chargement des données`);try{s.value=!0,console.log("[NotesView][loadInitialData] Chargement des colonnes..."),await r.loadColumns(),console.log("[NotesView][loadInitialData] Colonnes chargées:",r.columns),console.log("[NotesView][loadInitialData] Chargement des notes...");const Te=await Qs.getNotes();console.log("[NotesView][loadInitialData] Notes reçues:",Te.data),Te.data.length>0?(console.log("[NotesView][loadInitialData] Détails des notes:"),Te.data.forEach((ue,le)=>{console.log(`Note ${le+1}:`,{id:ue.id,title:ue.title,columnId:ue.column||ue.column_id,access_level:ue.access_level,column:ue.column})})):console.warn("[NotesView][loadInitialData] Aucune note reçue du backend!");const Y=r.columns.map(ue=>ue.id),H=Te.data.filter(ue=>{const le=(ue.column||ue.column_id||"").toString();return le===""||!Y.includes(le)});if(H.length>0){console.warn(`[NotesView][loadInitialData] ${H.length} notes avec des colonnes invalides:`,H),console.log("[NotesView][loadInitialData] Assignation des notes à la colonne À faire (2)");for(const ue of H)try{await Qs.updateNote(ue.id,{column:"2"})}catch(le){console.error(`[NotesView][loadInitialData] Erreur lors de l'assignation de la note ${ue.id} à la colonne À faire:`,le)}}const Q=Te.data.map(ue=>({id:ue.id,title:ue.title,description:ue.description,location:ue.location,columnId:(ue.column||ue.column_id||"2").toString(),access_level:ue.access_level,style:ue.style||{},comments:ue.comments||[],photos:ue.photos||[],order:ue.order||0,createdAt:ue.created_at,updatedAt:ue.updated_at}));r.notes.length=0,Q.forEach(ue=>{r.addNote(ue)}),console.log("[NotesView][loadInitialData] Notes chargées dans le store");for(const ue of r.columns){const le=r.getNotesByColumn(ue.id);console.log(`[NotesView][loadInitialData] Colonne ${ue.title} (${ue.id}): ${le.length} notes`),le.length>0&&le.forEach(pe=>{console.log(`  - Note ID=${pe.id}, Titre="${pe.title}", Niveau d'accès=${pe.accessLevel}, Colonne=${pe.columnId}`)})}}catch(Te){console.error("[NotesView][loadInitialData] Erreur:",Te),t.error("Erreur lors du chargement des données")}finally{s.value=!1,console.log("[NotesView][loadInitialData] Chargement terminé")}}function ve(){n.push({path:"/",query:{tool:"Note"}})}async function z(Te){if(!Te.location){t.warning("Cette note n'est pas géolocalisée");return}try{const H=(await Qs.getNote(Te.id)).data,Q=H.plan;console.log("[NotesView][viewOnMap] Détails de la note récupérés:",H),n.push({path:"/",query:{lat:Array.isArray(Te.location)?Te.location[0].toString():Te.location.coordinates[1].toString(),lng:Array.isArray(Te.location)?Te.location[1].toString():Te.location.coordinates[0].toString(),noteId:Te.id.toString(),planId:Q?Q.toString():void 0}})}catch(Y){console.error("[NotesView][viewOnMap] Erreur lors de la récupération des détails de la note:",Y),t.error("Erreur lors de l'ouverture de la note sur la carte")}}function U(Te){if(!Te.location){t.warning("Cette note n'est pas géolocalisée");return}let Y,H;Array.isArray(Te.location)?(Y=Te.location[0],H=Te.location[1]):(Y=Te.location.coordinates[1],H=Te.location.coordinates[0]);const Q=`https://www.google.com/maps/dir/?api=1&destination=${Y},${H}`;window.open(Q,"_blank")}function J(Te){d.value=JSON.parse(JSON.stringify(Te)),m.value="info",u.value=!0}async function T(Te){if(console.log("[NotesView][handleNoteSave] Note sauvegardée:",Te),Te&&Te.id){const Y=r.notes.find(H=>H.id===Te.id);Y&&(!Te.comments&&Y.comments&&(Te.comments=Y.comments),!Te.photos&&Y.photos&&(Te.photos=Y.photos))}if(u.value=!1,_.value&&d.value)try{const Y={location:d.value.location,name:d.value.title,description:d.value.description,columnId:d.value.columnId,accessLevel:d.value.accessLevel,style:d.value.style,comments:d.value.comments||[],photos:d.value.photos||[],order:d.value.order,createdAt:d.value.createdAt,updatedAt:new Date().toISOString()},H=i.elements.findIndex(Q=>{var ue;return Q.type_forme==="Note"&&Q.id===((ue=d.value)==null?void 0:ue.id)});H!==-1?i.elements[H].data=Y:i.elements.push({id:d.value.id,type_forme:"Note",data:Y}),await i.saveToPlan(_.value),t.success("Note sauvegardée et plan mis à jour avec succès")}catch(Y){console.error("Erreur lors de la sauvegarde de la note:",Y),t.error("Erreur lors de la sauvegarde de la note")}}function D(Te){f.value=Te,o.value=!0}async function B(){if(f.value)try{try{await Qs.deleteNote(f.value.id)}catch(Te){if(Te.response&&Te.response.status===404)console.log("[NotesView][deleteNote] Note non trouvée dans le backend (404), suppression locale uniquement");else throw Te}r.removeNote(f.value.id),t.success("Note supprimée avec succès")}catch(Te){console.error("Erreur lors de la suppression de la note:",Te),t.error("Erreur lors de la suppression de la note")}finally{o.value=!1,f.value=null}}async function $(Te,Y){console.log("[NotesView][onDragChange] Événement:",Te),console.log("[NotesView][onDragChange] Colonne cible:",Y);try{if(Te.added){const{element:H}=Te.added;console.log("[NotesView][onDragChange] Note à déplacer:",H);const Q=typeof H=="object"&&H.id?H.id:null;if(!Q)throw console.error("[NotesView][onDragChange] ID de note invalide:",H),new Error("ID de note invalide");r.moveNote(Q,Y);const le=K.value(Y).map(Z=>Z.id);r.reorderNotes(Y,le);const pe=r.getColumnById(Y);t.success(`Note déplacée vers ${(pe==null?void 0:pe.title)||"une autre colonne"}`),await W(Q,{columnId:Y})}if(Te.moved){const H=K.value(Y),Q=H.map(ue=>ue.id);r.reorderNotes(Y,Q),t.success("Ordre des notes mis à jour");for(const[ue,le]of H.entries())await W(le.id,{order:ue})}}catch(H){console.error("[NotesView][onDragChange] Erreur:",H),t.error("Une erreur est survenue lors du déplacement de la note")}}async function W(Te,Y){console.log("[NotesView][updateNoteInBackend] Mise à jour de la note:",Te,Y);try{const H=r.notes.find(le=>le.id===Te);if(!H){console.error("[NotesView][updateNoteInBackend] Note non trouvée:",Te);return}const Q={...Y};if(Y.columnId){const le=r.getColumnById(Y.columnId);le?(console.log(`[NotesView][updateNoteInBackend] Mise à jour de la colonne: ${le.id} (${le.title})`),Q.column=le.id,delete Q.columnId,delete Q.column_id):console.warn(`[NotesView][updateNoteInBackend] Colonne non trouvée: ${Y.columnId}`)}const ue={...H,...Q,updatedAt:new Date().toISOString()};console.log("[NotesView][updateNoteInBackend] Données envoyées au backend:",ue),await Qs.updateNote(Te,ue),console.log("[NotesView][updateNoteInBackend] Note mise à jour avec succès")}catch(H){throw console.error("[NotesView][updateNoteInBackend] Erreur:",H),H}}function G(){d.value={id:"",title:"Nouvelle note",description:"",location:null,columnId:r.getDefaultColumn.id,accessLevel:Xi.PRIVATE,style:{color:"#3B82F6",weight:2,opacity:1,fillColor:"#3B82F6",fillOpacity:.6,radius:8},order:0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),comments:[],photos:[]},u.value=!0,m.value="info"}const oe=zt(null),ie=zt(!1);function we(){ie.value=!ie.value}function Ce(Te){oe.value&&!oe.value.contains(Te.target)&&(ie.value=!1)}return Cs(()=>{document.addEventListener("click",Ce)}),fh(()=>{document.removeEventListener("click",Ce)}),(Te,Y)=>{var H,Q;return $e(),qe("div",QU,[C("div",eV,[C("div",tV,[Y[6]||(Y[6]=C("div",{class:"sm:flex-auto"},[C("h1",{class:"text-2xl font-semibold text-gray-900"},"Notes"),C("p",{class:"mt-2 text-sm text-gray-700"}," Liste de toutes vos notes. ")],-1)),C("div",nV,[C("div",{class:"relative",ref_key:"dropdownRef",ref:oe},[C("button",{onClick:we,class:"inline-flex items-center justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:w-auto"},Y[5]||(Y[5]=[Li(" Créer "),C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1)])),ie.value?($e(),qe("div",rV,[C("div",{class:"py-1"},[C("button",{onClick:G,class:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"}," Note simple "),C("button",{onClick:ve,class:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"}," Note géolocalisée ")])])):pn("",!0)],512)])]),C("div",iV,[C("div",oV,[C("div",null,[Y[7]||(Y[7]=C("label",{for:"search",class:"block text-sm font-medium text-gray-700"},"Recherche",-1)),Fn(C("input",{type:"text",id:"search","onUpdate:modelValue":Y[0]||(Y[0]=ue=>M.search=ue),placeholder:"Rechercher par titre ou description...",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},null,512),[[ni,M.search]])]),C("div",null,[Y[9]||(Y[9]=C("label",{for:"date",class:"block text-sm font-medium text-gray-700"},"Date",-1)),Fn(C("select",{id:"date","onUpdate:modelValue":Y[1]||(Y[1]=ue=>M.date=ue),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},Y[8]||(Y[8]=[C("option",{value:""},"Toutes les dates",-1),C("option",{value:"today"},"Aujourd'hui",-1),C("option",{value:"week"},"Cette semaine",-1),C("option",{value:"month"},"Ce mois",-1)]),512),[[vo,M.date]])]),C("div",null,[Y[11]||(Y[11]=C("label",{for:"accessLevel",class:"block text-sm font-medium text-gray-700"},"Niveau d'accès",-1)),Fn(C("select",{id:"accessLevel","onUpdate:modelValue":Y[2]||(Y[2]=ue=>M.accessLevel=ue),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},[Y[10]||(Y[10]=C("option",{value:""},"Tous les niveaux",-1)),($e(),qe(Tn,null,Lr(y,ue=>C("option",{key:ue.id,value:ue.id},Zt(ue.title),9,sV)),64))],512),[[vo,M.accessLevel]])])])]),s.value?($e(),qe("div",aV,Y[12]||(Y[12]=[C("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"},null,-1),C("p",{class:"mt-2 text-sm text-gray-500"},"Chargement des notes...",-1)]))):($e(),qe("div",lV,[R.value.length===0&&w.value.length===0?($e(),qe("div",uV,Y[13]||(Y[13]=[C("p",{class:"text-sm text-gray-500"},"Aucune note ni colonne trouvée",-1)]))):pn("",!0),C("div",cV,[($e(!0),qe(Tn,null,Lr(w.value,ue=>($e(),qe("div",{key:ue.id,class:"column-wrapper w-80 flex-shrink-0"},[C("div",fV,[C("div",{class:"p-3 flex items-center justify-between no-select",style:ql({backgroundColor:ue.color+"20",borderBottom:"2px solid "+ue.color})},[C("div",hV,[C("h3",{class:"text-sm font-semibold",style:ql({color:ue.color})},Zt(ue.title),5)]),C("div",dV,[C("span",pV,Zt(K.value(ue.id).length),1)])],4),C("div",gV,[C("div",mV,[di(Kn(XU),{list:K.value(ue.id),class:"space-y-2",group:"notes","item-key":"id",handle:".note-drag-handle",onChange:le=>$(le,ue.id),animation:150,"ghost-class":"ghost-card","chosen-class":"chosen","drag-class":"dragging"},{item:pu(({element:le})=>[C("div",vV,[C("div",yV,[C("div",_V,[C("div",bV,[Y[14]||(Y[14]=C("svg",{class:"h-4 w-4 mr-2 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8h16M4 16h16"})],-1)),C("h4",wV,Zt(le.title),1)]),C("div",null,[C("span",{class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium",style:ql({backgroundColor:he(le.accessLevel)+"20",color:he(le.accessLevel)})},Zt(ee(le.accessLevel)||"Non défini"),5)])]),C("div",xV,[C("p",LV,Zt(le.description||"Aucune description"),1)]),C("div",SV,[C("span",EV,Zt(le.updatedAt?I(le.updatedAt):le.createdAt?I(le.createdAt):"Date non définie"),1),C("div",CV,[le.location?($e(),qe("span",PV,Y[15]||(Y[15]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1)]))):($e(),qe("span",MV,Y[16]||(Y[16]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)]))),le.location?($e(),qe(Tn,{key:2},[C("button",{onClick:pe=>U(le),class:"p-1 text-gray-400 hover:text-primary-500 focus:outline-none",title:"Ouvrir dans Google Maps"},Y[17]||(Y[17]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1)]),8,AV),C("button",{onClick:pe=>z(le),class:"p-1 text-gray-400 hover:text-primary-500 focus:outline-none",title:"Voir sur la carte"},Y[18]||(Y[18]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})],-1)]),8,kV)],64)):pn("",!0),C("button",{onClick:pe=>J(le),class:"p-1 text-gray-400 hover:text-primary-500 focus:outline-none",title:"Éditer la note"},Y[19]||(Y[19]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,TV),C("button",{onClick:pe=>D(le),class:"p-1 text-gray-400 hover:text-red-500 focus:outline-none",title:"Supprimer la note"},Y[20]||(Y[20]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[C("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,NV)])])])])]),"empty-content":pu(()=>Y[21]||(Y[21]=[C("div",{class:"p-4 text-center text-gray-400 text-sm italic"}," Aucune note dans cette colonne ",-1)])),_:2},1032,["list","onChange"])])])])]))),128))])]))]),o.value?($e(),qe("div",DV,[C("div",IV,[Y[23]||(Y[23]=C("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true"},null,-1)),C("div",OV,[Y[22]||(Y[22]=$u('<div class="p-4 md:p-6" data-v-3f5bbe8c><div class="flex items-start" data-v-3f5bbe8c><div class="flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100" data-v-3f5bbe8c><svg class="h-6 w-6 text-red-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true" data-v-3f5bbe8c><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" data-v-3f5bbe8c></path></svg></div><div class="ml-4 flex-1" data-v-3f5bbe8c><h3 class="text-lg leading-6 font-medium text-gray-900" id="modal-title" data-v-3f5bbe8c> Supprimer la note </h3><div class="mt-2" data-v-3f5bbe8c><p class="text-sm text-gray-500" data-v-3f5bbe8c> Êtes-vous sûr de vouloir supprimer cette note ? Cette action est irréversible. </p></div></div></div></div>',1)),C("div",BV,[C("button",{onClick:B,type:"button",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:w-auto sm:text-sm"}," Supprimer "),C("button",{onClick:Y[3]||(Y[3]=ue=>o.value=!1),type:"button",class:"w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:w-auto sm:text-sm"}," Annuler ")])])])])):pn("",!0),u.value?($e(),rl(fx,{key:1,note:d.value,"is-new-note":!((H=d.value)!=null&&H.id),location:(Q=d.value)==null?void 0:Q.location,onClose:Y[4]||(Y[4]=ue=>u.value=!1),onSave:T},null,8,["note","is-new-note","location"])):pn("",!0)])}}}),FV=vd(RV,[["__scopeId","data-v-3f5bbe8c"]]),Zx=l8({history:jT("/"),routes:[{path:"/",name:"home",component:Ub,meta:{requiresAuth:!0,allowedRoles:["admin","entreprise","salarie","visiteur"]}},{path:"/plans",name:"plans",component:hU,meta:{requiresAuth:!0,allowedRoles:["admin","entreprise","salarie","visiteur"]}},{path:"/users",name:"users",component:Rz,meta:{requiresAuth:!0,allowedRoles:["admin","entreprise","salarie"]}},{path:"/profile",name:"profile",component:()=>mf(()=>import("./ProfileView.js"),[]),meta:{requiresAuth:!0,allowedRoles:["admin","entreprise","salarie","visiteur"]}},{path:"/login",name:"login",component:O7,meta:{requiresGuest:!0}},{path:"/forgot-password",name:"forgot-password",component:()=>mf(()=>import("./ForgotPasswordView.js"),[]),meta:{requiresGuest:!0}},{path:"/reset-password/:token",name:"reset-password",component:()=>mf(()=>import("./ResetPasswordView.js"),[]),meta:{requiresGuest:!0}},{path:"/change-password",name:"changePassword",component:r7,meta:{requiresAuth:!0,allowedRoles:["admin","entreprise","salarie","visiteur"]}},{path:"/notes",name:"notes",component:FV,meta:{requiresAuth:!0,allowedRoles:["admin","entreprise","salarie","visiteur"]}},{path:"/map",name:"map",component:Ub,meta:{requiresAuth:!0}},{path:"/:pathMatch(.*)*",name:"not-found",component:()=>mf(()=>import("./NotFoundView.js"),[])}]});Zx.beforeEach(async(e,n,t)=>{var u,f;const r=ma();if(console.log("Route:",e.path,"Auth state:",{initialized:r.initialized,isAuthenticated:r.isAuthenticated,user:r.user}),!r.initialized)try{await r.initialize(window.INITIAL_STATE)}catch(d){console.error("Error initializing auth store:",d)}const i=r.isAuthenticated,s=(u=r.user)==null?void 0:u.must_change_password,o=(f=r.user)==null?void 0:f.user_type;if(e.meta.requiresAuth&&!i){t("/login");return}if(i&&s&&e.name!=="changePassword"){t({name:"changePassword"});return}if(e.name==="changePassword"&&!s){t({name:"home"});return}if(e.meta.allowedRoles&&o&&!e.meta.allowedRoles.includes(o)){t({name:"home"});return}if(e.meta.requiresGuest&&i){t({name:"home"});return}t()});const xy=um(OD),Kx=m6();xy.use(Kx);xy.use(Zx);const jV=ma(Kx);window.INITIAL_STATE&&jV.initialize(window.INITIAL_STATE);xy.mount("#app");export{so as _,Yl as a,C as b,qe as c,ds as d,pn as e,Kn as f,Li as g,Fn as h,$e as i,$u as j,di as k,pu as l,Kw as m,Vi as n,Cs as o,c8 as p,Bp as q,zt as r,ea as s,Zt as t,ma as u,ni as v,Gc as w,fy as x};

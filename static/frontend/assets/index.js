var Ox=Object.defineProperty;var Ix=(e,n,t)=>n in e?Ox(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var Mt=(e,n,t)=>Ix(e,typeof n!="symbol"?n+"":n,t);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Kg(e){const n=Object.create(null);for(const t of e.split(","))n[t]=1;return t=>t in n}const Yr={},zh=[],Pu=()=>{},Fx=()=>!1,bp=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Jg=e=>e.startsWith("onUpdate:"),So=Object.assign,Yg=(e,n)=>{const t=e.indexOf(n);t>-1&&e.splice(t,1)},zx=Object.prototype.hasOwnProperty,Dr=(e,n)=>zx.call(e,n),hi=Array.isArray,jh=e=>Zf(e)==="[object Map]",Jh=e=>Zf(e)==="[object Set]",I1=e=>Zf(e)==="[object Date]",Ri=e=>typeof e=="function",js=e=>typeof e=="string",Au=e=>typeof e=="symbol",Xr=e=>e!==null&&typeof e=="object",Yy=e=>(Xr(e)||Ri(e))&&Ri(e.then)&&Ri(e.catch),Xy=Object.prototype.toString,Zf=e=>Xy.call(e),jx=e=>Zf(e).slice(8,-1),Qy=e=>Zf(e)==="[object Object]",Xg=e=>js(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Lf=Kg(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),wp=e=>{const n=Object.create(null);return t=>n[t]||(n[t]=e(t))},Ux=/-(\w)/g,Bl=wp(e=>e.replace(Ux,(n,t)=>t?t.toUpperCase():"")),$x=/\B([A-Z])/g,ch=wp(e=>e.replace($x,"-$1").toLowerCase()),xp=wp(e=>e.charAt(0).toUpperCase()+e.slice(1)),x0=wp(e=>e?`on${xp(e)}`:""),xc=(e,n)=>!Object.is(e,n),Nd=(e,...n)=>{for(let t=0;t<e.length;t++)e[t](...n)},e_=(e,n,t,i=!1)=>{Object.defineProperty(e,n,{configurable:!0,enumerable:!1,writable:i,value:t})},Jd=e=>{const n=parseFloat(e);return isNaN(n)?e:n},qx=e=>{const n=js(e)?Number(e):NaN;return isNaN(n)?e:n};let F1;const Lp=()=>F1||(F1=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function _c(e){if(hi(e)){const n={};for(let t=0;t<e.length;t++){const i=e[t],r=js(i)?Wx(i):_c(i);if(r)for(const o in r)n[o]=r[o]}return n}else if(js(e)||Xr(e))return e}const Gx=/;(?![^(]*\))/g,Vx=/:([^]+)/,Hx=/\/\*[^]*?\*\//g;function Wx(e){const n={};return e.replace(Hx,"").split(Gx).forEach(t=>{if(t){const i=t.split(Vx);i.length>1&&(n[i[0].trim()]=i[1].trim())}}),n}function Jr(e){let n="";if(js(e))n=e;else if(hi(e))for(let t=0;t<e.length;t++){const i=Jr(e[t]);i&&(n+=i+" ")}else if(Xr(e))for(const t in e)e[t]&&(n+=t+" ");return n.trim()}const Zx="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Kx=Kg(Zx);function t_(e){return!!e||e===""}function Jx(e,n){if(e.length!==n.length)return!1;let t=!0;for(let i=0;t&&i<e.length;i++)t=ah(e[i],n[i]);return t}function ah(e,n){if(e===n)return!0;let t=I1(e),i=I1(n);if(t||i)return t&&i?e.getTime()===n.getTime():!1;if(t=Au(e),i=Au(n),t||i)return e===n;if(t=hi(e),i=hi(n),t||i)return t&&i?Jx(e,n):!1;if(t=Xr(e),i=Xr(n),t||i){if(!t||!i)return!1;const r=Object.keys(e).length,o=Object.keys(n).length;if(r!==o)return!1;for(const l in e){const h=e.hasOwnProperty(l),p=n.hasOwnProperty(l);if(h&&!p||!h&&p||!ah(e[l],n[l]))return!1}}return String(e)===String(n)}function Qg(e,n){return e.findIndex(t=>ah(t,n))}const n_=e=>!!(e&&e.__v_isRef===!0),Jt=e=>js(e)?e:e==null?"":hi(e)||Xr(e)&&(e.toString===Xy||!Ri(e.toString))?n_(e)?Jt(e.value):JSON.stringify(e,i_,2):String(e),i_=(e,n)=>n_(n)?i_(e,n.value):jh(n)?{[`Map(${n.size})`]:[...n.entries()].reduce((t,[i,r],o)=>(t[L0(i,o)+" =>"]=r,t),{})}:Jh(n)?{[`Set(${n.size})`]:[...n.values()].map(t=>L0(t))}:Au(n)?L0(n):Xr(n)&&!hi(n)&&!Qy(n)?String(n):n,L0=(e,n="")=>{var t;return Au(e)?`Symbol(${(t=e.description)!=null?t:n})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let La;class r_{constructor(n=!1){this.detached=n,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=La,!n&&La&&(this.index=(La.scopes||(La.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let n,t;if(this.scopes)for(n=0,t=this.scopes.length;n<t;n++)this.scopes[n].pause();for(n=0,t=this.effects.length;n<t;n++)this.effects[n].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let n,t;if(this.scopes)for(n=0,t=this.scopes.length;n<t;n++)this.scopes[n].resume();for(n=0,t=this.effects.length;n<t;n++)this.effects[n].resume()}}run(n){if(this._active){const t=La;try{return La=this,n()}finally{La=t}}}on(){La=this}off(){La=this.parent}stop(n){if(this._active){this._active=!1;let t,i;for(t=0,i=this.effects.length;t<i;t++)this.effects[t].stop();for(this.effects.length=0,t=0,i=this.cleanups.length;t<i;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,i=this.scopes.length;t<i;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!n){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0}}}function s_(e){return new r_(e)}function o_(){return La}function Yx(e,n=!1){La&&La.cleanups.push(e)}let is;const C0=new WeakSet;class a_{constructor(n){this.fn=n,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,La&&La.active&&La.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,C0.has(this)&&(C0.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||u_(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,z1(this),c_(this);const n=is,t=Ql;is=this,Ql=!0;try{return this.fn()}finally{h_(this),is=n,Ql=t,this.flags&=-3}}stop(){if(this.flags&1){for(let n=this.deps;n;n=n.nextDep)nm(n);this.deps=this.depsTail=void 0,z1(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?C0.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){tg(this)&&this.run()}get dirty(){return tg(this)}}let l_=0,Cf,Sf;function u_(e,n=!1){if(e.flags|=8,n){e.next=Sf,Sf=e;return}e.next=Cf,Cf=e}function em(){l_++}function tm(){if(--l_>0)return;if(Sf){let n=Sf;for(Sf=void 0;n;){const t=n.next;n.next=void 0,n.flags&=-9,n=t}}let e;for(;Cf;){let n=Cf;for(Cf=void 0;n;){const t=n.next;if(n.next=void 0,n.flags&=-9,n.flags&1)try{n.trigger()}catch(i){e||(e=i)}n=t}}if(e)throw e}function c_(e){for(let n=e.deps;n;n=n.nextDep)n.version=-1,n.prevActiveLink=n.dep.activeLink,n.dep.activeLink=n}function h_(e){let n,t=e.depsTail,i=t;for(;i;){const r=i.prevDep;i.version===-1?(i===t&&(t=r),nm(i),Xx(i)):n=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=r}e.deps=n,e.depsTail=t}function tg(e){for(let n=e.deps;n;n=n.nextDep)if(n.dep.version!==n.version||n.dep.computed&&(f_(n.dep.computed)||n.dep.version!==n.version))return!0;return!!e._dirty}function f_(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===If))return;e.globalVersion=If;const n=e.dep;if(e.flags|=2,n.version>0&&!e.isSSR&&e.deps&&!tg(e)){e.flags&=-3;return}const t=is,i=Ql;is=e,Ql=!0;try{c_(e);const r=e.fn(e._value);(n.version===0||xc(r,e._value))&&(e._value=r,n.version++)}catch(r){throw n.version++,r}finally{is=t,Ql=i,h_(e),e.flags&=-3}}function nm(e,n=!1){const{dep:t,prevSub:i,nextSub:r}=e;if(i&&(i.nextSub=r,e.prevSub=void 0),r&&(r.prevSub=i,e.nextSub=void 0),t.subs===e&&(t.subs=i,!i&&t.computed)){t.computed.flags&=-5;for(let o=t.computed.deps;o;o=o.nextDep)nm(o,!0)}!n&&!--t.sc&&t.map&&t.map.delete(t.key)}function Xx(e){const{prevDep:n,nextDep:t}=e;n&&(n.nextDep=t,e.prevDep=void 0),t&&(t.prevDep=n,e.nextDep=void 0)}let Ql=!0;const d_=[];function Tc(){d_.push(Ql),Ql=!1}function Bc(){const e=d_.pop();Ql=e===void 0?!0:e}function z1(e){const{cleanup:n}=e;if(e.cleanup=void 0,n){const t=is;is=void 0;try{n()}finally{is=t}}}let If=0;class Qx{constructor(n,t){this.sub=n,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class im{constructor(n){this.computed=n,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(n){if(!is||!Ql||is===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==is)t=this.activeLink=new Qx(is,this),is.deps?(t.prevDep=is.depsTail,is.depsTail.nextDep=t,is.depsTail=t):is.deps=is.depsTail=t,p_(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const i=t.nextDep;i.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=i),t.prevDep=is.depsTail,t.nextDep=void 0,is.depsTail.nextDep=t,is.depsTail=t,is.deps===t&&(is.deps=i)}return t}trigger(n){this.version++,If++,this.notify(n)}notify(n){em();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{tm()}}}function p_(e){if(e.dep.sc++,e.sub.flags&4){const n=e.dep.computed;if(n&&!e.dep.subs){n.flags|=20;for(let i=n.deps;i;i=i.nextDep)p_(i)}const t=e.dep.subs;t!==e&&(e.prevSub=t,t&&(t.nextSub=e)),e.dep.subs=e}}const Yd=new WeakMap,ih=Symbol(""),ng=Symbol(""),Ff=Symbol("");function oa(e,n,t){if(Ql&&is){let i=Yd.get(e);i||Yd.set(e,i=new Map);let r=i.get(t);r||(i.set(t,r=new im),r.map=i,r.key=t),r.track()}}function Ju(e,n,t,i,r,o){const l=Yd.get(e);if(!l){If++;return}const h=p=>{p&&p.trigger()};if(em(),n==="clear")l.forEach(h);else{const p=hi(e),m=p&&Xg(t);if(p&&t==="length"){const _=Number(i);l.forEach((w,E)=>{(E==="length"||E===Ff||!Au(E)&&E>=_)&&h(w)})}else switch((t!==void 0||l.has(void 0))&&h(l.get(t)),m&&h(l.get(Ff)),n){case"add":p?m&&h(l.get("length")):(h(l.get(ih)),jh(e)&&h(l.get(ng)));break;case"delete":p||(h(l.get(ih)),jh(e)&&h(l.get(ng)));break;case"set":jh(e)&&h(l.get(ih));break}}tm()}function eL(e,n){const t=Yd.get(e);return t&&t.get(n)}function kh(e){const n=wr(e);return n===e?n:(oa(n,"iterate",Ff),kl(e)?n:n.map(aa))}function Cp(e){return oa(e=wr(e),"iterate",Ff),e}const tL={__proto__:null,[Symbol.iterator](){return S0(this,Symbol.iterator,aa)},concat(...e){return kh(this).concat(...e.map(n=>hi(n)?kh(n):n))},entries(){return S0(this,"entries",e=>(e[1]=aa(e[1]),e))},every(e,n){return qu(this,"every",e,n,void 0,arguments)},filter(e,n){return qu(this,"filter",e,n,t=>t.map(aa),arguments)},find(e,n){return qu(this,"find",e,n,aa,arguments)},findIndex(e,n){return qu(this,"findIndex",e,n,void 0,arguments)},findLast(e,n){return qu(this,"findLast",e,n,aa,arguments)},findLastIndex(e,n){return qu(this,"findLastIndex",e,n,void 0,arguments)},forEach(e,n){return qu(this,"forEach",e,n,void 0,arguments)},includes(...e){return P0(this,"includes",e)},indexOf(...e){return P0(this,"indexOf",e)},join(e){return kh(this).join(e)},lastIndexOf(...e){return P0(this,"lastIndexOf",e)},map(e,n){return qu(this,"map",e,n,void 0,arguments)},pop(){return lf(this,"pop")},push(...e){return lf(this,"push",e)},reduce(e,...n){return j1(this,"reduce",e,n)},reduceRight(e,...n){return j1(this,"reduceRight",e,n)},shift(){return lf(this,"shift")},some(e,n){return qu(this,"some",e,n,void 0,arguments)},splice(...e){return lf(this,"splice",e)},toReversed(){return kh(this).toReversed()},toSorted(e){return kh(this).toSorted(e)},toSpliced(...e){return kh(this).toSpliced(...e)},unshift(...e){return lf(this,"unshift",e)},values(){return S0(this,"values",aa)}};function S0(e,n,t){const i=Cp(e),r=i[n]();return i!==e&&!kl(e)&&(r._next=r.next,r.next=()=>{const o=r._next();return o.value&&(o.value=t(o.value)),o}),r}const nL=Array.prototype;function qu(e,n,t,i,r,o){const l=Cp(e),h=l!==e&&!kl(e),p=l[n];if(p!==nL[n]){const w=p.apply(e,o);return h?aa(w):w}let m=t;l!==e&&(h?m=function(w,E){return t.call(this,aa(w),E,e)}:t.length>2&&(m=function(w,E){return t.call(this,w,E,e)}));const _=p.call(l,m,i);return h&&r?r(_):_}function j1(e,n,t,i){const r=Cp(e);let o=t;return r!==e&&(kl(e)?t.length>3&&(o=function(l,h,p){return t.call(this,l,h,p,e)}):o=function(l,h,p){return t.call(this,l,aa(h),p,e)}),r[n](o,...i)}function P0(e,n,t){const i=wr(e);oa(i,"iterate",Ff);const r=i[n](...t);return(r===-1||r===!1)&&om(t[0])?(t[0]=wr(t[0]),i[n](...t)):r}function lf(e,n,t=[]){Tc(),em();const i=wr(e)[n].apply(e,t);return tm(),Bc(),i}const iL=Kg("__proto__,__v_isRef,__isVue"),g_=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Au));function rL(e){Au(e)||(e=String(e));const n=wr(this);return oa(n,"has",e),n.hasOwnProperty(e)}class m_{constructor(n=!1,t=!1){this._isReadonly=n,this._isShallow=t}get(n,t,i){if(t==="__v_skip")return n.__v_skip;const r=this._isReadonly,o=this._isShallow;if(t==="__v_isReactive")return!r;if(t==="__v_isReadonly")return r;if(t==="__v_isShallow")return o;if(t==="__v_raw")return i===(r?o?pL:b_:o?__:y_).get(n)||Object.getPrototypeOf(n)===Object.getPrototypeOf(i)?n:void 0;const l=hi(n);if(!r){let p;if(l&&(p=tL[t]))return p;if(t==="hasOwnProperty")return rL}const h=Reflect.get(n,t,Qs(n)?n:i);return(Au(t)?g_.has(t):iL(t))||(r||oa(n,"get",t),o)?h:Qs(h)?l&&Xg(t)?h:h.value:Xr(h)?r?_u(h):ku(h):h}}class v_ extends m_{constructor(n=!1){super(!1,n)}set(n,t,i,r){let o=n[t];if(!this._isShallow){const p=lh(o);if(!kl(i)&&!lh(i)&&(o=wr(o),i=wr(i)),!hi(n)&&Qs(o)&&!Qs(i))return p?!1:(o.value=i,!0)}const l=hi(n)&&Xg(t)?Number(t)<n.length:Dr(n,t),h=Reflect.set(n,t,i,Qs(n)?n:r);return n===wr(r)&&(l?xc(i,o)&&Ju(n,"set",t,i):Ju(n,"add",t,i)),h}deleteProperty(n,t){const i=Dr(n,t);n[t];const r=Reflect.deleteProperty(n,t);return r&&i&&Ju(n,"delete",t,void 0),r}has(n,t){const i=Reflect.has(n,t);return(!Au(t)||!g_.has(t))&&oa(n,"has",t),i}ownKeys(n){return oa(n,"iterate",hi(n)?"length":ih),Reflect.ownKeys(n)}}class sL extends m_{constructor(n=!1){super(!0,n)}set(n,t){return!0}deleteProperty(n,t){return!0}}const oL=new v_,aL=new sL,lL=new v_(!0);const ig=e=>e,bd=e=>Reflect.getPrototypeOf(e);function uL(e,n,t){return function(...i){const r=this.__v_raw,o=wr(r),l=jh(o),h=e==="entries"||e===Symbol.iterator&&l,p=e==="keys"&&l,m=r[e](...i),_=t?ig:n?rg:aa;return!n&&oa(o,"iterate",p?ng:ih),{next(){const{value:w,done:E}=m.next();return E?{value:w,done:E}:{value:h?[_(w[0]),_(w[1])]:_(w),done:E}},[Symbol.iterator](){return this}}}}function wd(e){return function(...n){return e==="delete"?!1:e==="clear"?void 0:this}}function cL(e,n){const t={get(r){const o=this.__v_raw,l=wr(o),h=wr(r);e||(xc(r,h)&&oa(l,"get",r),oa(l,"get",h));const{has:p}=bd(l),m=n?ig:e?rg:aa;if(p.call(l,r))return m(o.get(r));if(p.call(l,h))return m(o.get(h));o!==l&&o.get(r)},get size(){const r=this.__v_raw;return!e&&oa(wr(r),"iterate",ih),Reflect.get(r,"size",r)},has(r){const o=this.__v_raw,l=wr(o),h=wr(r);return e||(xc(r,h)&&oa(l,"has",r),oa(l,"has",h)),r===h?o.has(r):o.has(r)||o.has(h)},forEach(r,o){const l=this,h=l.__v_raw,p=wr(h),m=n?ig:e?rg:aa;return!e&&oa(p,"iterate",ih),h.forEach((_,w)=>r.call(o,m(_),m(w),l))}};return So(t,e?{add:wd("add"),set:wd("set"),delete:wd("delete"),clear:wd("clear")}:{add(r){!n&&!kl(r)&&!lh(r)&&(r=wr(r));const o=wr(this);return bd(o).has.call(o,r)||(o.add(r),Ju(o,"add",r,r)),this},set(r,o){!n&&!kl(o)&&!lh(o)&&(o=wr(o));const l=wr(this),{has:h,get:p}=bd(l);let m=h.call(l,r);m||(r=wr(r),m=h.call(l,r));const _=p.call(l,r);return l.set(r,o),m?xc(o,_)&&Ju(l,"set",r,o):Ju(l,"add",r,o),this},delete(r){const o=wr(this),{has:l,get:h}=bd(o);let p=l.call(o,r);p||(r=wr(r),p=l.call(o,r)),h&&h.call(o,r);const m=o.delete(r);return p&&Ju(o,"delete",r,void 0),m},clear(){const r=wr(this),o=r.size!==0,l=r.clear();return o&&Ju(r,"clear",void 0,void 0),l}}),["keys","values","entries",Symbol.iterator].forEach(r=>{t[r]=uL(r,e,n)}),t}function rm(e,n){const t=cL(e,n);return(i,r,o)=>r==="__v_isReactive"?!e:r==="__v_isReadonly"?e:r==="__v_raw"?i:Reflect.get(Dr(t,r)&&r in i?t:i,r,o)}const hL={get:rm(!1,!1)},fL={get:rm(!1,!0)},dL={get:rm(!0,!1)};const y_=new WeakMap,__=new WeakMap,b_=new WeakMap,pL=new WeakMap;function gL(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function mL(e){return e.__v_skip||!Object.isExtensible(e)?0:gL(jx(e))}function ku(e){return lh(e)?e:sm(e,!1,oL,hL,y_)}function w_(e){return sm(e,!1,lL,fL,__)}function _u(e){return sm(e,!0,aL,dL,b_)}function sm(e,n,t,i,r){if(!Xr(e)||e.__v_raw&&!(n&&e.__v_isReactive))return e;const o=r.get(e);if(o)return o;const l=mL(e);if(l===0)return e;const h=new Proxy(e,l===2?i:t);return r.set(e,h),h}function Lc(e){return lh(e)?Lc(e.__v_raw):!!(e&&e.__v_isReactive)}function lh(e){return!!(e&&e.__v_isReadonly)}function kl(e){return!!(e&&e.__v_isShallow)}function om(e){return e?!!e.__v_raw:!1}function wr(e){const n=e&&e.__v_raw;return n?wr(n):e}function am(e){return!Dr(e,"__v_skip")&&Object.isExtensible(e)&&e_(e,"__v_skip",!0),e}const aa=e=>Xr(e)?ku(e):e,rg=e=>Xr(e)?_u(e):e;function Qs(e){return e?e.__v_isRef===!0:!1}function Yt(e){return x_(e,!1)}function vL(e){return x_(e,!0)}function x_(e,n){return Qs(e)?e:new yL(e,n)}class yL{constructor(n,t){this.dep=new im,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?n:wr(n),this._value=t?n:aa(n),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(n){const t=this._rawValue,i=this.__v_isShallow||kl(n)||lh(n);n=i?n:wr(n),xc(n,t)&&(this._rawValue=n,this._value=i?n:aa(n),this.dep.trigger())}}function Xn(e){return Qs(e)?e.value:e}const _L={get:(e,n,t)=>n==="__v_raw"?e:Xn(Reflect.get(e,n,t)),set:(e,n,t,i)=>{const r=e[n];return Qs(r)&&!Qs(t)?(r.value=t,!0):Reflect.set(e,n,t,i)}};function L_(e){return Lc(e)?e:new Proxy(e,_L)}function bL(e){const n=hi(e)?new Array(e.length):{};for(const t in e)n[t]=xL(e,t);return n}class wL{constructor(n,t,i){this._object=n,this._key=t,this._defaultValue=i,this.__v_isRef=!0,this._value=void 0}get value(){const n=this._object[this._key];return this._value=n===void 0?this._defaultValue:n}set value(n){this._object[this._key]=n}get dep(){return eL(wr(this._object),this._key)}}function xL(e,n,t){const i=e[n];return Qs(i)?i:new wL(e,n,t)}class LL{constructor(n,t,i){this.fn=n,this.setter=t,this._value=void 0,this.dep=new im(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=If-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&is!==this)return u_(this,!0),!0}get value(){const n=this.dep.track();return f_(this),n&&(n.version=this.dep.version),this._value}set value(n){this.setter&&this.setter(n)}}function CL(e,n,t=!1){let i,r;return Ri(e)?i=e:(i=e.get,r=e.set),new LL(i,r,t)}const xd={},Xd=new WeakMap;let Kc;function SL(e,n=!1,t=Kc){if(t){let i=Xd.get(t);i||Xd.set(t,i=[]),i.push(e)}}function PL(e,n,t=Yr){const{immediate:i,deep:r,once:o,scheduler:l,augmentJob:h,call:p}=t,m=Ee=>r?Ee:kl(Ee)||r===!1||r===0?Yu(Ee,1):Yu(Ee);let _,w,E,b,D=!1,j=!1;if(Qs(e)?(w=()=>e.value,D=kl(e)):Lc(e)?(w=()=>m(e),D=!0):hi(e)?(j=!0,D=e.some(Ee=>Lc(Ee)||kl(Ee)),w=()=>e.map(Ee=>{if(Qs(Ee))return Ee.value;if(Lc(Ee))return m(Ee);if(Ri(Ee))return p?p(Ee,2):Ee()})):Ri(e)?n?w=p?()=>p(e,2):e:w=()=>{if(E){Tc();try{E()}finally{Bc()}}const Ee=Kc;Kc=_;try{return p?p(e,3,[b]):e(b)}finally{Kc=Ee}}:w=Pu,n&&r){const Ee=w,Ie=r===!0?1/0:r;w=()=>Yu(Ee(),Ie)}const Q=o_(),F=()=>{_.stop(),Q&&Q.active&&Yg(Q.effects,_)};if(o&&n){const Ee=n;n=(...Ie)=>{Ee(...Ie),F()}}let V=j?new Array(e.length).fill(xd):xd;const pe=Ee=>{if(!(!(_.flags&1)||!_.dirty&&!Ee))if(n){const Ie=_.run();if(r||D||(j?Ie.some((nt,We)=>xc(nt,V[We])):xc(Ie,V))){E&&E();const nt=Kc;Kc=_;try{const We=[Ie,V===xd?void 0:j&&V[0]===xd?[]:V,b];p?p(n,3,We):n(...We),V=Ie}finally{Kc=nt}}}else _.run()};return h&&h(pe),_=new a_(w),_.scheduler=l?()=>l(pe,!1):pe,b=Ee=>SL(Ee,!1,_),E=_.onStop=()=>{const Ee=Xd.get(_);if(Ee){if(p)p(Ee,4);else for(const Ie of Ee)Ie();Xd.delete(_)}},n?i?pe(!0):V=_.run():l?l(pe.bind(null,!0),!0):_.run(),F.pause=_.pause.bind(_),F.resume=_.resume.bind(_),F.stop=F,F}function Yu(e,n=1/0,t){if(n<=0||!Xr(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),n--,Qs(e))Yu(e.value,n,t);else if(hi(e))for(let i=0;i<e.length;i++)Yu(e[i],n,t);else if(Jh(e)||jh(e))e.forEach(i=>{Yu(i,n,t)});else if(Qy(e)){for(const i in e)Yu(e[i],n,t);for(const i of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,i)&&Yu(e[i],n,t)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Kf(e,n,t,i){try{return i?e(...i):e()}catch(r){Sp(r,n,t)}}function eu(e,n,t,i){if(Ri(e)){const r=Kf(e,n,t,i);return r&&Yy(r)&&r.catch(o=>{Sp(o,n,t)}),r}if(hi(e)){const r=[];for(let o=0;o<e.length;o++)r.push(eu(e[o],n,t,i));return r}}function Sp(e,n,t,i=!0){const r=n?n.vnode:null,{errorHandler:o,throwUnhandledErrorInProduction:l}=n&&n.appContext.config||Yr;if(n){let h=n.parent;const p=n.proxy,m=`https://vuejs.org/error-reference/#runtime-${t}`;for(;h;){const _=h.ec;if(_){for(let w=0;w<_.length;w++)if(_[w](e,p,m)===!1)return}h=h.parent}if(o){Tc(),Kf(o,null,10,[e,p,m]),Bc();return}}EL(e,t,r,i,l)}function EL(e,n,t,i=!0,r=!1){if(r)throw e;console.error(e)}const Ca=[];let bu=-1;const Uh=[];let gc=null,Nh=0;const C_=Promise.resolve();let Qd=null;function ks(e){const n=Qd||C_;return e?n.then(this?e.bind(this):e):n}function AL(e){let n=bu+1,t=Ca.length;for(;n<t;){const i=n+t>>>1,r=Ca[i],o=zf(r);o<e||o===e&&r.flags&2?n=i+1:t=i}return n}function lm(e){if(!(e.flags&1)){const n=zf(e),t=Ca[Ca.length-1];!t||!(e.flags&2)&&n>=zf(t)?Ca.push(e):Ca.splice(AL(n),0,e),e.flags|=1,S_()}}function S_(){Qd||(Qd=C_.then(E_))}function kL(e){hi(e)?Uh.push(...e):gc&&e.id===-1?gc.splice(Nh+1,0,e):e.flags&1||(Uh.push(e),e.flags|=1),S_()}function U1(e,n,t=bu+1){for(;t<Ca.length;t++){const i=Ca[t];if(i&&i.flags&2){if(e&&i.id!==e.uid)continue;Ca.splice(t,1),t--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function P_(e){if(Uh.length){const n=[...new Set(Uh)].sort((t,i)=>zf(t)-zf(i));if(Uh.length=0,gc){gc.push(...n);return}for(gc=n,Nh=0;Nh<gc.length;Nh++){const t=gc[Nh];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}gc=null,Nh=0}}const zf=e=>e.id==null?e.flags&2?-1:1/0:e.id;function E_(e){try{for(bu=0;bu<Ca.length;bu++){const n=Ca[bu];n&&!(n.flags&8)&&(n.flags&4&&(n.flags&=-2),Kf(n,n.i,n.i?15:14),n.flags&4||(n.flags&=-2))}}finally{for(;bu<Ca.length;bu++){const n=Ca[bu];n&&(n.flags&=-2)}bu=-1,Ca.length=0,P_(),Qd=null,(Ca.length||Uh.length)&&E_()}}let Sa=null,A_=null;function ep(e){const n=Sa;return Sa=e,A_=e&&e.type.__scopeId||null,n}function Kl(e,n=Sa,t){if(!n||e._n)return e;const i=(...r)=>{i._d&&tv(-1);const o=ep(n);let l;try{l=e(...r)}finally{ep(o),i._d&&tv(1)}return l};return i._n=!0,i._c=!0,i._d=!0,i}function zn(e,n){if(Sa===null)return e;const t=Tp(Sa),i=e.dirs||(e.dirs=[]);for(let r=0;r<n.length;r++){let[o,l,h,p=Yr]=n[r];o&&(Ri(o)&&(o={mounted:o,updated:o}),o.deep&&Yu(l),i.push({dir:o,instance:t,value:l,oldValue:void 0,arg:h,modifiers:p}))}return e}function qc(e,n,t,i){const r=e.dirs,o=n&&n.dirs;for(let l=0;l<r.length;l++){const h=r[l];o&&(h.oldValue=o[l].value);let p=h.dir[i];p&&(Tc(),eu(p,t,8,[e.el,h,e,n]),Bc())}}const k_=Symbol("_vte"),M_=e=>e.__isTeleport,Pf=e=>e&&(e.disabled||e.disabled===""),$1=e=>e&&(e.defer||e.defer===""),q1=e=>typeof SVGElement<"u"&&e instanceof SVGElement,G1=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,sg=(e,n)=>{const t=e&&e.to;return js(t)?n?n(t):null:t},T_={name:"Teleport",__isTeleport:!0,process(e,n,t,i,r,o,l,h,p,m){const{mc:_,pc:w,pbc:E,o:{insert:b,querySelector:D,createText:j,createComment:Q}}=m,F=Pf(n.props);let{shapeFlag:V,children:pe,dynamicChildren:Ee}=n;if(e==null){const Ie=n.el=j(""),nt=n.anchor=j("");b(Ie,t,i),b(nt,t,i);const We=(H,le)=>{V&16&&(r&&r.isCE&&(r.ce._teleportTarget=H),_(pe,H,le,r,o,l,h,p))},O=()=>{const H=n.target=sg(n.props,D),le=B_(H,n,j,b);H&&(l!=="svg"&&q1(H)?l="svg":l!=="mathml"&&G1(H)&&(l="mathml"),F||(We(H,le),Dd(n,!1)))};F&&(We(t,nt),Dd(n,!0)),$1(n.props)?xa(()=>{O(),n.el.__isMounted=!0},o):O()}else{if($1(n.props)&&!e.el.__isMounted){xa(()=>{T_.process(e,n,t,i,r,o,l,h,p,m),delete e.el.__isMounted},o);return}n.el=e.el,n.targetStart=e.targetStart;const Ie=n.anchor=e.anchor,nt=n.target=e.target,We=n.targetAnchor=e.targetAnchor,O=Pf(e.props),H=O?t:nt,le=O?Ie:We;if(l==="svg"||q1(nt)?l="svg":(l==="mathml"||G1(nt))&&(l="mathml"),Ee?(E(e.dynamicChildren,Ee,H,r,o,l,h),cm(e,n,!0)):p||w(e,n,H,le,r,o,l,h,!1),F)O?n.props&&e.props&&n.props.to!==e.props.to&&(n.props.to=e.props.to):Ld(n,t,Ie,m,1);else if((n.props&&n.props.to)!==(e.props&&e.props.to)){const G=n.target=sg(n.props,D);G&&Ld(n,G,null,m,0)}else O&&Ld(n,nt,We,m,1);Dd(n,F)}},remove(e,n,t,{um:i,o:{remove:r}},o){const{shapeFlag:l,children:h,anchor:p,targetStart:m,targetAnchor:_,target:w,props:E}=e;if(w&&(r(m),r(_)),o&&r(p),l&16){const b=o||!Pf(E);for(let D=0;D<h.length;D++){const j=h[D];i(j,n,t,b,!!j.dynamicChildren)}}},move:Ld,hydrate:ML};function Ld(e,n,t,{o:{insert:i},m:r},o=2){o===0&&i(e.targetAnchor,n,t);const{el:l,anchor:h,shapeFlag:p,children:m,props:_}=e,w=o===2;if(w&&i(l,n,t),(!w||Pf(_))&&p&16)for(let E=0;E<m.length;E++)r(m[E],n,t,2);w&&i(h,n,t)}function ML(e,n,t,i,r,o,{o:{nextSibling:l,parentNode:h,querySelector:p,insert:m,createText:_}},w){const E=n.target=sg(n.props,p);if(E){const b=Pf(n.props),D=E._lpa||E.firstChild;if(n.shapeFlag&16)if(b)n.anchor=w(l(e),n,h(e),t,i,r,o),n.targetStart=D,n.targetAnchor=D&&l(D);else{n.anchor=l(e);let j=D;for(;j;){if(j&&j.nodeType===8){if(j.data==="teleport start anchor")n.targetStart=j;else if(j.data==="teleport anchor"){n.targetAnchor=j,E._lpa=n.targetAnchor&&l(n.targetAnchor);break}}j=l(j)}n.targetAnchor||B_(E,n,_,m),w(D&&l(D),n,E,t,i,r,o)}Dd(n,b)}return n.anchor&&l(n.anchor)}const E0=T_;function Dd(e,n){const t=e.ctx;if(t&&t.ut){let i,r;for(n?(i=e.el,r=e.anchor):(i=e.targetStart,r=e.targetAnchor);i&&i!==r;)i.nodeType===1&&i.setAttribute("data-v-owner",t.uid),i=i.nextSibling;t.ut()}}function B_(e,n,t,i){const r=n.targetStart=t(""),o=n.targetAnchor=t("");return r[k_]=o,e&&(i(r,e),i(o,e)),o}const mc=Symbol("_leaveCb"),Cd=Symbol("_enterCb");function TL(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Ha(()=>{e.isMounted=!0}),Ap(()=>{e.isUnmounting=!0}),e}const Ll=[Function,Array],N_={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Ll,onEnter:Ll,onAfterEnter:Ll,onEnterCancelled:Ll,onBeforeLeave:Ll,onLeave:Ll,onAfterLeave:Ll,onLeaveCancelled:Ll,onBeforeAppear:Ll,onAppear:Ll,onAfterAppear:Ll,onAppearCancelled:Ll},D_=e=>{const n=e.subTree;return n.component?D_(n.component):n},BL={name:"BaseTransition",props:N_,setup(e,{slots:n}){const t=MC(),i=TL();return()=>{const r=n.default&&I_(n.default(),!0);if(!r||!r.length)return;const o=R_(r),l=wr(e),{mode:h}=l;if(i.isLeaving)return A0(o);const p=V1(o);if(!p)return A0(o);let m=og(p,l,i,t,w=>m=w);p.type!==qa&&jf(p,m);let _=t.subTree&&V1(t.subTree);if(_&&_.type!==qa&&!Yc(p,_)&&D_(t).type!==qa){let w=og(_,l,i,t);if(jf(_,w),h==="out-in"&&p.type!==qa)return i.isLeaving=!0,w.afterLeave=()=>{i.isLeaving=!1,t.job.flags&8||t.update(),delete w.afterLeave,_=void 0},A0(o);h==="in-out"&&p.type!==qa?w.delayLeave=(E,b,D)=>{const j=O_(i,_);j[String(_.key)]=_,E[mc]=()=>{b(),E[mc]=void 0,delete m.delayedLeave,_=void 0},m.delayedLeave=()=>{D(),delete m.delayedLeave,_=void 0}}:_=void 0}else _&&(_=void 0);return o}}};function R_(e){let n=e[0];if(e.length>1){for(const t of e)if(t.type!==qa){n=t;break}}return n}const NL=BL;function O_(e,n){const{leavingVNodes:t}=e;let i=t.get(n.type);return i||(i=Object.create(null),t.set(n.type,i)),i}function og(e,n,t,i,r){const{appear:o,mode:l,persisted:h=!1,onBeforeEnter:p,onEnter:m,onAfterEnter:_,onEnterCancelled:w,onBeforeLeave:E,onLeave:b,onAfterLeave:D,onLeaveCancelled:j,onBeforeAppear:Q,onAppear:F,onAfterAppear:V,onAppearCancelled:pe}=n,Ee=String(e.key),Ie=O_(t,e),nt=(H,le)=>{H&&eu(H,i,9,le)},We=(H,le)=>{const G=le[1];nt(H,le),hi(H)?H.every(I=>I.length<=1)&&G():H.length<=1&&G()},O={mode:l,persisted:h,beforeEnter(H){let le=p;if(!t.isMounted)if(o)le=Q||p;else return;H[mc]&&H[mc](!0);const G=Ie[Ee];G&&Yc(e,G)&&G.el[mc]&&G.el[mc](),nt(le,[H])},enter(H){let le=m,G=_,I=w;if(!t.isMounted)if(o)le=F||m,G=V||_,I=pe||w;else return;let Y=!1;const $=H[Cd]=R=>{Y||(Y=!0,R?nt(I,[H]):nt(G,[H]),O.delayedLeave&&O.delayedLeave(),H[Cd]=void 0)};le?We(le,[H,$]):$()},leave(H,le){const G=String(e.key);if(H[Cd]&&H[Cd](!0),t.isUnmounting)return le();nt(E,[H]);let I=!1;const Y=H[mc]=$=>{I||(I=!0,le(),$?nt(j,[H]):nt(D,[H]),H[mc]=void 0,Ie[G]===e&&delete Ie[G])};Ie[G]=e,b?We(b,[H,Y]):Y()},clone(H){const le=og(H,n,t,i,r);return r&&r(le),le}};return O}function A0(e){if(Pp(e))return e=Pc(e),e.children=null,e}function V1(e){if(!Pp(e))return M_(e.type)&&e.children?R_(e.children):e;const{shapeFlag:n,children:t}=e;if(t){if(n&16)return t[0];if(n&32&&Ri(t.default))return t.default()}}function jf(e,n){e.shapeFlag&6&&e.component?(e.transition=n,jf(e.component.subTree,n)):e.shapeFlag&128?(e.ssContent.transition=n.clone(e.ssContent),e.ssFallback.transition=n.clone(e.ssFallback)):e.transition=n}function I_(e,n=!1,t){let i=[],r=0;for(let o=0;o<e.length;o++){let l=e[o];const h=t==null?l.key:String(t)+String(l.key!=null?l.key:o);l.type===Vn?(l.patchFlag&128&&r++,i=i.concat(I_(l.children,n,h))):(n||l.type!==qa)&&i.push(h!=null?Pc(l,{key:h}):l)}if(r>1)for(let o=0;o<i.length;o++)i[o].patchFlag=-2;return i}/*! #__NO_SIDE_EFFECTS__ */function Pa(e,n){return Ri(e)?So({name:e.name},n,{setup:e}):e}function F_(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function tp(e,n,t,i,r=!1){if(hi(e)){e.forEach((D,j)=>tp(D,n&&(hi(n)?n[j]:n),t,i,r));return}if(Ef(i)&&!r){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&tp(e,n,t,i.component.subTree);return}const o=i.shapeFlag&4?Tp(i.component):i.el,l=r?null:o,{i:h,r:p}=e,m=n&&n.r,_=h.refs===Yr?h.refs={}:h.refs,w=h.setupState,E=wr(w),b=w===Yr?()=>!1:D=>Dr(E,D);if(m!=null&&m!==p&&(js(m)?(_[m]=null,b(m)&&(w[m]=null)):Qs(m)&&(m.value=null)),Ri(p))Kf(p,h,12,[l,_]);else{const D=js(p),j=Qs(p);if(D||j){const Q=()=>{if(e.f){const F=D?b(p)?w[p]:_[p]:p.value;r?hi(F)&&Yg(F,o):hi(F)?F.includes(o)||F.push(o):D?(_[p]=[o],b(p)&&(w[p]=_[p])):(p.value=[o],e.k&&(_[e.k]=p.value))}else D?(_[p]=l,b(p)&&(w[p]=l)):j&&(p.value=l,e.k&&(_[e.k]=l))};l?(Q.id=-1,xa(Q,t)):Q()}}}Lp().requestIdleCallback;Lp().cancelIdleCallback;const Ef=e=>!!e.type.__asyncLoader,Pp=e=>e.type.__isKeepAlive;function DL(e,n){z_(e,"a",n)}function RL(e,n){z_(e,"da",n)}function z_(e,n,t=Co){const i=e.__wdc||(e.__wdc=()=>{let r=t;for(;r;){if(r.isDeactivated)return;r=r.parent}return e()});if(Ep(n,i,t),t){let r=t.parent;for(;r&&r.parent;)Pp(r.parent.vnode)&&OL(i,n,t,r),r=r.parent}}function OL(e,n,t,i){const r=Ep(n,e,i,!0);Qu(()=>{Yg(i[n],r)},t)}function Ep(e,n,t=Co,i=!1){if(t){const r=t[e]||(t[e]=[]),o=n.__weh||(n.__weh=(...l)=>{Tc();const h=Jf(t),p=eu(n,t,e,l);return h(),Bc(),p});return i?r.unshift(o):r.push(o),o}}const tc=e=>(n,t=Co)=>{(!$f||e==="sp")&&Ep(e,(...i)=>n(...i),t)},IL=tc("bm"),Ha=tc("m"),FL=tc("bu"),zL=tc("u"),Ap=tc("bum"),Qu=tc("um"),jL=tc("sp"),UL=tc("rtg"),$L=tc("rtc");function qL(e,n=Co){Ep("ec",e,n)}const GL="components";function VL(e,n){return WL(GL,e,!0,n)||e}const HL=Symbol.for("v-ndc");function WL(e,n,t=!0,i=!1){const r=Sa||Co;if(r){const o=r.type;{const h=RC(o,!1);if(h&&(h===n||h===Bl(n)||h===xp(Bl(n))))return o}const l=H1(r[e]||o[e],n)||H1(r.appContext[e],n);return!l&&i?o:l}}function H1(e,n){return e&&(e[n]||e[Bl(n)]||e[xp(Bl(n))])}function $i(e,n,t,i){let r;const o=t,l=hi(e);if(l||js(e)){const h=l&&Lc(e);let p=!1;h&&(p=!kl(e),e=Cp(e)),r=new Array(e.length);for(let m=0,_=e.length;m<_;m++)r[m]=n(p?aa(e[m]):e[m],m,void 0,o)}else if(typeof e=="number"){r=new Array(e);for(let h=0;h<e;h++)r[h]=n(h+1,h,void 0,o)}else if(Xr(e))if(e[Symbol.iterator])r=Array.from(e,(h,p)=>n(h,p,void 0,o));else{const h=Object.keys(e);r=new Array(h.length);for(let p=0,m=h.length;p<m;p++){const _=h[p];r[p]=n(e[_],_,p,o)}}else r=[];return r}const ag=e=>e?r2(e)?Tp(e):ag(e.parent):null,Af=So(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>ag(e.parent),$root:e=>ag(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>U_(e),$forceUpdate:e=>e.f||(e.f=()=>{lm(e.update)}),$nextTick:e=>e.n||(e.n=ks.bind(e.proxy)),$watch:e=>gC.bind(e)}),k0=(e,n)=>e!==Yr&&!e.__isScriptSetup&&Dr(e,n),ZL={get({_:e},n){if(n==="__v_skip")return!0;const{ctx:t,setupState:i,data:r,props:o,accessCache:l,type:h,appContext:p}=e;let m;if(n[0]!=="$"){const b=l[n];if(b!==void 0)switch(b){case 1:return i[n];case 2:return r[n];case 4:return t[n];case 3:return o[n]}else{if(k0(i,n))return l[n]=1,i[n];if(r!==Yr&&Dr(r,n))return l[n]=2,r[n];if((m=e.propsOptions[0])&&Dr(m,n))return l[n]=3,o[n];if(t!==Yr&&Dr(t,n))return l[n]=4,t[n];lg&&(l[n]=0)}}const _=Af[n];let w,E;if(_)return n==="$attrs"&&oa(e.attrs,"get",""),_(e);if((w=h.__cssModules)&&(w=w[n]))return w;if(t!==Yr&&Dr(t,n))return l[n]=4,t[n];if(E=p.config.globalProperties,Dr(E,n))return E[n]},set({_:e},n,t){const{data:i,setupState:r,ctx:o}=e;return k0(r,n)?(r[n]=t,!0):i!==Yr&&Dr(i,n)?(i[n]=t,!0):Dr(e.props,n)||n[0]==="$"&&n.slice(1)in e?!1:(o[n]=t,!0)},has({_:{data:e,setupState:n,accessCache:t,ctx:i,appContext:r,propsOptions:o}},l){let h;return!!t[l]||e!==Yr&&Dr(e,l)||k0(n,l)||(h=o[0])&&Dr(h,l)||Dr(i,l)||Dr(Af,l)||Dr(r.config.globalProperties,l)},defineProperty(e,n,t){return t.get!=null?e._.accessCache[n]=0:Dr(t,"value")&&this.set(e,n,t.value,null),Reflect.defineProperty(e,n,t)}};function W1(e){return hi(e)?e.reduce((n,t)=>(n[t]=null,n),{}):e}let lg=!0;function KL(e){const n=U_(e),t=e.proxy,i=e.ctx;lg=!1,n.beforeCreate&&Z1(n.beforeCreate,e,"bc");const{data:r,computed:o,methods:l,watch:h,provide:p,inject:m,created:_,beforeMount:w,mounted:E,beforeUpdate:b,updated:D,activated:j,deactivated:Q,beforeDestroy:F,beforeUnmount:V,destroyed:pe,unmounted:Ee,render:Ie,renderTracked:nt,renderTriggered:We,errorCaptured:O,serverPrefetch:H,expose:le,inheritAttrs:G,components:I,directives:Y,filters:$}=n;if(m&&JL(m,i,null),l)for(const se in l){const ie=l[se];Ri(ie)&&(i[se]=ie.bind(t))}if(r){const se=r.call(t,t);Xr(se)&&(e.data=ku(se))}if(lg=!0,o)for(const se in o){const ie=o[se],Ae=Ri(ie)?ie.bind(t,t):Ri(ie.get)?ie.get.bind(t,t):Pu,Te=!Ri(ie)&&Ri(ie.set)?ie.set.bind(t):Pu,ut=Di({get:Ae,set:Te});Object.defineProperty(i,se,{enumerable:!0,configurable:!0,get:()=>ut.value,set:X=>ut.value=X})}if(h)for(const se in h)j_(h[se],i,t,se);if(p){const se=Ri(p)?p.call(t):p;Reflect.ownKeys(se).forEach(ie=>{Rd(ie,se[ie])})}_&&Z1(_,e,"c");function Z(se,ie){hi(ie)?ie.forEach(Ae=>se(Ae.bind(t))):ie&&se(ie.bind(t))}if(Z(IL,w),Z(Ha,E),Z(FL,b),Z(zL,D),Z(DL,j),Z(RL,Q),Z(qL,O),Z($L,nt),Z(UL,We),Z(Ap,V),Z(Qu,Ee),Z(jL,H),hi(le))if(le.length){const se=e.exposed||(e.exposed={});le.forEach(ie=>{Object.defineProperty(se,ie,{get:()=>t[ie],set:Ae=>t[ie]=Ae})})}else e.exposed||(e.exposed={});Ie&&e.render===Pu&&(e.render=Ie),G!=null&&(e.inheritAttrs=G),I&&(e.components=I),Y&&(e.directives=Y),H&&F_(e)}function JL(e,n,t=Pu){hi(e)&&(e=ug(e));for(const i in e){const r=e[i];let o;Xr(r)?"default"in r?o=Ml(r.from||i,r.default,!0):o=Ml(r.from||i):o=Ml(r),Qs(o)?Object.defineProperty(n,i,{enumerable:!0,configurable:!0,get:()=>o.value,set:l=>o.value=l}):n[i]=o}}function Z1(e,n,t){eu(hi(e)?e.map(i=>i.bind(n.proxy)):e.bind(n.proxy),n,t)}function j_(e,n,t,i){let r=i.includes(".")?Q_(t,i):()=>t[i];if(js(e)){const o=n[e];Ri(o)&&Ur(r,o)}else if(Ri(e))Ur(r,e.bind(t));else if(Xr(e))if(hi(e))e.forEach(o=>j_(o,n,t,i));else{const o=Ri(e.handler)?e.handler.bind(t):n[e.handler];Ri(o)&&Ur(r,o,e)}}function U_(e){const n=e.type,{mixins:t,extends:i}=n,{mixins:r,optionsCache:o,config:{optionMergeStrategies:l}}=e.appContext,h=o.get(n);let p;return h?p=h:!r.length&&!t&&!i?p=n:(p={},r.length&&r.forEach(m=>np(p,m,l,!0)),np(p,n,l)),Xr(n)&&o.set(n,p),p}function np(e,n,t,i=!1){const{mixins:r,extends:o}=n;o&&np(e,o,t,!0),r&&r.forEach(l=>np(e,l,t,!0));for(const l in n)if(!(i&&l==="expose")){const h=YL[l]||t&&t[l];e[l]=h?h(e[l],n[l]):n[l]}return e}const YL={data:K1,props:J1,emits:J1,methods:yf,computed:yf,beforeCreate:_a,created:_a,beforeMount:_a,mounted:_a,beforeUpdate:_a,updated:_a,beforeDestroy:_a,beforeUnmount:_a,destroyed:_a,unmounted:_a,activated:_a,deactivated:_a,errorCaptured:_a,serverPrefetch:_a,components:yf,directives:yf,watch:QL,provide:K1,inject:XL};function K1(e,n){return n?e?function(){return So(Ri(e)?e.call(this,this):e,Ri(n)?n.call(this,this):n)}:n:e}function XL(e,n){return yf(ug(e),ug(n))}function ug(e){if(hi(e)){const n={};for(let t=0;t<e.length;t++)n[e[t]]=e[t];return n}return e}function _a(e,n){return e?[...new Set([].concat(e,n))]:n}function yf(e,n){return e?So(Object.create(null),e,n):n}function J1(e,n){return e?hi(e)&&hi(n)?[...new Set([...e,...n])]:So(Object.create(null),W1(e),W1(n??{})):n}function QL(e,n){if(!e)return n;if(!n)return e;const t=So(Object.create(null),e);for(const i in n)t[i]=_a(e[i],n[i]);return t}function $_(){return{app:null,config:{isNativeTag:Fx,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let eC=0;function tC(e,n){return function(i,r=null){Ri(i)||(i=So({},i)),r!=null&&!Xr(r)&&(r=null);const o=$_(),l=new WeakSet,h=[];let p=!1;const m=o.app={_uid:eC++,_component:i,_props:r,_container:null,_context:o,_instance:null,version:IC,get config(){return o.config},set config(_){},use(_,...w){return l.has(_)||(_&&Ri(_.install)?(l.add(_),_.install(m,...w)):Ri(_)&&(l.add(_),_(m,...w))),m},mixin(_){return o.mixins.includes(_)||o.mixins.push(_),m},component(_,w){return w?(o.components[_]=w,m):o.components[_]},directive(_,w){return w?(o.directives[_]=w,m):o.directives[_]},mount(_,w,E){if(!p){const b=m._ceVNode||$r(i,r);return b.appContext=o,E===!0?E="svg":E===!1&&(E=void 0),e(b,_,E),p=!0,m._container=_,_.__vue_app__=m,Tp(b.component)}},onUnmount(_){h.push(_)},unmount(){p&&(eu(h,m._instance,16),e(null,m._container),delete m._container.__vue_app__)},provide(_,w){return o.provides[_]=w,m},runWithContext(_){const w=rh;rh=m;try{return _()}finally{rh=w}}};return m}}let rh=null;function Rd(e,n){if(Co){let t=Co.provides;const i=Co.parent&&Co.parent.provides;i===t&&(t=Co.provides=Object.create(i)),t[e]=n}}function Ml(e,n,t=!1){const i=Co||Sa;if(i||rh){const r=rh?rh._context.provides:i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(r&&e in r)return r[e];if(arguments.length>1)return t&&Ri(n)?n.call(i&&i.proxy):n}}function nC(){return!!(Co||Sa||rh)}const q_={},G_=()=>Object.create(q_),V_=e=>Object.getPrototypeOf(e)===q_;function iC(e,n,t,i=!1){const r={},o=G_();e.propsDefaults=Object.create(null),H_(e,n,r,o);for(const l in e.propsOptions[0])l in r||(r[l]=void 0);t?e.props=i?r:w_(r):e.type.props?e.props=r:e.props=o,e.attrs=o}function rC(e,n,t,i){const{props:r,attrs:o,vnode:{patchFlag:l}}=e,h=wr(r),[p]=e.propsOptions;let m=!1;if((i||l>0)&&!(l&16)){if(l&8){const _=e.vnode.dynamicProps;for(let w=0;w<_.length;w++){let E=_[w];if(kp(e.emitsOptions,E))continue;const b=n[E];if(p)if(Dr(o,E))b!==o[E]&&(o[E]=b,m=!0);else{const D=Bl(E);r[D]=cg(p,h,D,b,e,!1)}else b!==o[E]&&(o[E]=b,m=!0)}}}else{H_(e,n,r,o)&&(m=!0);let _;for(const w in h)(!n||!Dr(n,w)&&((_=ch(w))===w||!Dr(n,_)))&&(p?t&&(t[w]!==void 0||t[_]!==void 0)&&(r[w]=cg(p,h,w,void 0,e,!0)):delete r[w]);if(o!==h)for(const w in o)(!n||!Dr(n,w))&&(delete o[w],m=!0)}m&&Ju(e.attrs,"set","")}function H_(e,n,t,i){const[r,o]=e.propsOptions;let l=!1,h;if(n)for(let p in n){if(Lf(p))continue;const m=n[p];let _;r&&Dr(r,_=Bl(p))?!o||!o.includes(_)?t[_]=m:(h||(h={}))[_]=m:kp(e.emitsOptions,p)||(!(p in i)||m!==i[p])&&(i[p]=m,l=!0)}if(o){const p=wr(t),m=h||Yr;for(let _=0;_<o.length;_++){const w=o[_];t[w]=cg(r,p,w,m[w],e,!Dr(m,w))}}return l}function cg(e,n,t,i,r,o){const l=e[t];if(l!=null){const h=Dr(l,"default");if(h&&i===void 0){const p=l.default;if(l.type!==Function&&!l.skipFactory&&Ri(p)){const{propsDefaults:m}=r;if(t in m)i=m[t];else{const _=Jf(r);i=m[t]=p.call(null,n),_()}}else i=p;r.ce&&r.ce._setProp(t,i)}l[0]&&(o&&!h?i=!1:l[1]&&(i===""||i===ch(t))&&(i=!0))}return i}const sC=new WeakMap;function W_(e,n,t=!1){const i=t?sC:n.propsCache,r=i.get(e);if(r)return r;const o=e.props,l={},h=[];let p=!1;if(!Ri(e)){const _=w=>{p=!0;const[E,b]=W_(w,n,!0);So(l,E),b&&h.push(...b)};!t&&n.mixins.length&&n.mixins.forEach(_),e.extends&&_(e.extends),e.mixins&&e.mixins.forEach(_)}if(!o&&!p)return Xr(e)&&i.set(e,zh),zh;if(hi(o))for(let _=0;_<o.length;_++){const w=Bl(o[_]);Y1(w)&&(l[w]=Yr)}else if(o)for(const _ in o){const w=Bl(_);if(Y1(w)){const E=o[_],b=l[w]=hi(E)||Ri(E)?{type:E}:So({},E),D=b.type;let j=!1,Q=!0;if(hi(D))for(let F=0;F<D.length;++F){const V=D[F],pe=Ri(V)&&V.name;if(pe==="Boolean"){j=!0;break}else pe==="String"&&(Q=!1)}else j=Ri(D)&&D.name==="Boolean";b[0]=j,b[1]=Q,(j||Dr(b,"default"))&&h.push(w)}}const m=[l,h];return Xr(e)&&i.set(e,m),m}function Y1(e){return e[0]!=="$"&&!Lf(e)}const Z_=e=>e[0]==="_"||e==="$stable",um=e=>hi(e)?e.map(xu):[xu(e)],oC=(e,n,t)=>{if(n._n)return n;const i=Kl((...r)=>um(n(...r)),t);return i._c=!1,i},K_=(e,n,t)=>{const i=e._ctx;for(const r in e){if(Z_(r))continue;const o=e[r];if(Ri(o))n[r]=oC(r,o,i);else if(o!=null){const l=um(o);n[r]=()=>l}}},J_=(e,n)=>{const t=um(n);e.slots.default=()=>t},Y_=(e,n,t)=>{for(const i in n)(t||i!=="_")&&(e[i]=n[i])},aC=(e,n,t)=>{const i=e.slots=G_();if(e.vnode.shapeFlag&32){const r=n._;r?(Y_(i,n,t),t&&e_(i,"_",r,!0)):K_(n,i)}else n&&J_(e,n)},lC=(e,n,t)=>{const{vnode:i,slots:r}=e;let o=!0,l=Yr;if(i.shapeFlag&32){const h=n._;h?t&&h===1?o=!1:Y_(r,n,t):(o=!n.$stable,K_(n,r)),l=n}else n&&(J_(e,n),l={default:1});if(o)for(const h in r)!Z_(h)&&l[h]==null&&delete r[h]},xa=xC;function uC(e){return cC(e)}function cC(e,n){const t=Lp();t.__VUE__=!0;const{insert:i,remove:r,patchProp:o,createElement:l,createText:h,createComment:p,setText:m,setElementText:_,parentNode:w,nextSibling:E,setScopeId:b=Pu,insertStaticContent:D}=e,j=(te,ae,Le,ye=null,ue=null,Oe=null,De=void 0,Me=null,Ve=!!ae.dynamicChildren)=>{if(te===ae)return;te&&!Yc(te,ae)&&(ye=ne(te),X(te,ue,Oe,!0),te=null),ae.patchFlag===-2&&(Ve=!1,ae.dynamicChildren=null);const{type:ze,ref:st,shapeFlag:Qe}=ae;switch(ze){case Mp:Q(te,ae,Le,ye);break;case qa:F(te,ae,Le,ye);break;case Od:te==null&&V(ae,Le,ye,De);break;case Vn:I(te,ae,Le,ye,ue,Oe,De,Me,Ve);break;default:Qe&1?Ie(te,ae,Le,ye,ue,Oe,De,Me,Ve):Qe&6?Y(te,ae,Le,ye,ue,Oe,De,Me,Ve):(Qe&64||Qe&128)&&ze.process(te,ae,Le,ye,ue,Oe,De,Me,Ve,oe)}st!=null&&ue&&tp(st,te&&te.ref,Oe,ae||te,!ae)},Q=(te,ae,Le,ye)=>{if(te==null)i(ae.el=h(ae.children),Le,ye);else{const ue=ae.el=te.el;ae.children!==te.children&&m(ue,ae.children)}},F=(te,ae,Le,ye)=>{te==null?i(ae.el=p(ae.children||""),Le,ye):ae.el=te.el},V=(te,ae,Le,ye)=>{[te.el,te.anchor]=D(te.children,ae,Le,ye,te.el,te.anchor)},pe=({el:te,anchor:ae},Le,ye)=>{let ue;for(;te&&te!==ae;)ue=E(te),i(te,Le,ye),te=ue;i(ae,Le,ye)},Ee=({el:te,anchor:ae})=>{let Le;for(;te&&te!==ae;)Le=E(te),r(te),te=Le;r(ae)},Ie=(te,ae,Le,ye,ue,Oe,De,Me,Ve)=>{ae.type==="svg"?De="svg":ae.type==="math"&&(De="mathml"),te==null?nt(ae,Le,ye,ue,Oe,De,Me,Ve):H(te,ae,ue,Oe,De,Me,Ve)},nt=(te,ae,Le,ye,ue,Oe,De,Me)=>{let Ve,ze;const{props:st,shapeFlag:Qe,transition:pt,dirs:wt}=te;if(Ve=te.el=l(te.type,Oe,st&&st.is,st),Qe&8?_(Ve,te.children):Qe&16&&O(te.children,Ve,null,ye,ue,M0(te,Oe),De,Me),wt&&qc(te,null,ye,"created"),We(Ve,te,te.scopeId,De,ye),st){for(const nn in st)nn!=="value"&&!Lf(nn)&&o(Ve,nn,null,st[nn],Oe,ye);"value"in st&&o(Ve,"value",null,st.value,Oe),(ze=st.onVnodeBeforeMount)&&gu(ze,ye,te)}wt&&qc(te,null,ye,"beforeMount");const Ht=hC(ue,pt);Ht&&pt.beforeEnter(Ve),i(Ve,ae,Le),((ze=st&&st.onVnodeMounted)||Ht||wt)&&xa(()=>{ze&&gu(ze,ye,te),Ht&&pt.enter(Ve),wt&&qc(te,null,ye,"mounted")},ue)},We=(te,ae,Le,ye,ue)=>{if(Le&&b(te,Le),ye)for(let Oe=0;Oe<ye.length;Oe++)b(te,ye[Oe]);if(ue){let Oe=ue.subTree;if(ae===Oe||t2(Oe.type)&&(Oe.ssContent===ae||Oe.ssFallback===ae)){const De=ue.vnode;We(te,De,De.scopeId,De.slotScopeIds,ue.parent)}}},O=(te,ae,Le,ye,ue,Oe,De,Me,Ve=0)=>{for(let ze=Ve;ze<te.length;ze++){const st=te[ze]=Me?vc(te[ze]):xu(te[ze]);j(null,st,ae,Le,ye,ue,Oe,De,Me)}},H=(te,ae,Le,ye,ue,Oe,De)=>{const Me=ae.el=te.el;let{patchFlag:Ve,dynamicChildren:ze,dirs:st}=ae;Ve|=te.patchFlag&16;const Qe=te.props||Yr,pt=ae.props||Yr;let wt;if(Le&&Gc(Le,!1),(wt=pt.onVnodeBeforeUpdate)&&gu(wt,Le,ae,te),st&&qc(ae,te,Le,"beforeUpdate"),Le&&Gc(Le,!0),(Qe.innerHTML&&pt.innerHTML==null||Qe.textContent&&pt.textContent==null)&&_(Me,""),ze?le(te.dynamicChildren,ze,Me,Le,ye,M0(ae,ue),Oe):De||ie(te,ae,Me,null,Le,ye,M0(ae,ue),Oe,!1),Ve>0){if(Ve&16)G(Me,Qe,pt,Le,ue);else if(Ve&2&&Qe.class!==pt.class&&o(Me,"class",null,pt.class,ue),Ve&4&&o(Me,"style",Qe.style,pt.style,ue),Ve&8){const Ht=ae.dynamicProps;for(let nn=0;nn<Ht.length;nn++){const tt=Ht[nn],Qt=Qe[tt],rn=pt[tt];(rn!==Qt||tt==="value")&&o(Me,tt,Qt,rn,ue,Le)}}Ve&1&&te.children!==ae.children&&_(Me,ae.children)}else!De&&ze==null&&G(Me,Qe,pt,Le,ue);((wt=pt.onVnodeUpdated)||st)&&xa(()=>{wt&&gu(wt,Le,ae,te),st&&qc(ae,te,Le,"updated")},ye)},le=(te,ae,Le,ye,ue,Oe,De)=>{for(let Me=0;Me<ae.length;Me++){const Ve=te[Me],ze=ae[Me],st=Ve.el&&(Ve.type===Vn||!Yc(Ve,ze)||Ve.shapeFlag&70)?w(Ve.el):Le;j(Ve,ze,st,null,ye,ue,Oe,De,!0)}},G=(te,ae,Le,ye,ue)=>{if(ae!==Le){if(ae!==Yr)for(const Oe in ae)!Lf(Oe)&&!(Oe in Le)&&o(te,Oe,ae[Oe],null,ue,ye);for(const Oe in Le){if(Lf(Oe))continue;const De=Le[Oe],Me=ae[Oe];De!==Me&&Oe!=="value"&&o(te,Oe,Me,De,ue,ye)}"value"in Le&&o(te,"value",ae.value,Le.value,ue)}},I=(te,ae,Le,ye,ue,Oe,De,Me,Ve)=>{const ze=ae.el=te?te.el:h(""),st=ae.anchor=te?te.anchor:h("");let{patchFlag:Qe,dynamicChildren:pt,slotScopeIds:wt}=ae;wt&&(Me=Me?Me.concat(wt):wt),te==null?(i(ze,Le,ye),i(st,Le,ye),O(ae.children||[],Le,st,ue,Oe,De,Me,Ve)):Qe>0&&Qe&64&&pt&&te.dynamicChildren?(le(te.dynamicChildren,pt,Le,ue,Oe,De,Me),(ae.key!=null||ue&&ae===ue.subTree)&&cm(te,ae,!0)):ie(te,ae,Le,st,ue,Oe,De,Me,Ve)},Y=(te,ae,Le,ye,ue,Oe,De,Me,Ve)=>{ae.slotScopeIds=Me,te==null?ae.shapeFlag&512?ue.ctx.activate(ae,Le,ye,De,Ve):$(ae,Le,ye,ue,Oe,De,Ve):R(te,ae,Ve)},$=(te,ae,Le,ye,ue,Oe,De)=>{const Me=te.component=kC(te,ye,ue);if(Pp(te)&&(Me.ctx.renderer=oe),TC(Me,!1,De),Me.asyncDep){if(ue&&ue.registerDep(Me,Z,De),!te.el){const Ve=Me.subTree=$r(qa);F(null,Ve,ae,Le)}}else Z(Me,te,ae,Le,ue,Oe,De)},R=(te,ae,Le)=>{const ye=ae.component=te.component;if(bC(te,ae,Le))if(ye.asyncDep&&!ye.asyncResolved){se(ye,ae,Le);return}else ye.next=ae,ye.update();else ae.el=te.el,ye.vnode=ae},Z=(te,ae,Le,ye,ue,Oe,De)=>{const Me=()=>{if(te.isMounted){let{next:Qe,bu:pt,u:wt,parent:Ht,vnode:nn}=te;{const Ke=X_(te);if(Ke){Qe&&(Qe.el=nn.el,se(te,Qe,De)),Ke.asyncDep.then(()=>{te.isUnmounted||Me()});return}}let tt=Qe,Qt;Gc(te,!1),Qe?(Qe.el=nn.el,se(te,Qe,De)):Qe=nn,pt&&Nd(pt),(Qt=Qe.props&&Qe.props.onVnodeBeforeUpdate)&&gu(Qt,Ht,Qe,nn),Gc(te,!0);const rn=Q1(te),it=te.subTree;te.subTree=rn,j(it,rn,w(it.el),ne(it),te,ue,Oe),Qe.el=rn.el,tt===null&&wC(te,rn.el),wt&&xa(wt,ue),(Qt=Qe.props&&Qe.props.onVnodeUpdated)&&xa(()=>gu(Qt,Ht,Qe,nn),ue)}else{let Qe;const{el:pt,props:wt}=ae,{bm:Ht,m:nn,parent:tt,root:Qt,type:rn}=te,it=Ef(ae);Gc(te,!1),Ht&&Nd(Ht),!it&&(Qe=wt&&wt.onVnodeBeforeMount)&&gu(Qe,tt,ae),Gc(te,!0);{Qt.ce&&Qt.ce._injectChildStyle(rn);const Ke=te.subTree=Q1(te);j(null,Ke,Le,ye,te,ue,Oe),ae.el=Ke.el}if(nn&&xa(nn,ue),!it&&(Qe=wt&&wt.onVnodeMounted)){const Ke=ae;xa(()=>gu(Qe,tt,Ke),ue)}(ae.shapeFlag&256||tt&&Ef(tt.vnode)&&tt.vnode.shapeFlag&256)&&te.a&&xa(te.a,ue),te.isMounted=!0,ae=Le=ye=null}};te.scope.on();const Ve=te.effect=new a_(Me);te.scope.off();const ze=te.update=Ve.run.bind(Ve),st=te.job=Ve.runIfDirty.bind(Ve);st.i=te,st.id=te.uid,Ve.scheduler=()=>lm(st),Gc(te,!0),ze()},se=(te,ae,Le)=>{ae.component=te;const ye=te.vnode.props;te.vnode=ae,te.next=null,rC(te,ae.props,ye,Le),lC(te,ae.children,Le),Tc(),U1(te),Bc()},ie=(te,ae,Le,ye,ue,Oe,De,Me,Ve=!1)=>{const ze=te&&te.children,st=te?te.shapeFlag:0,Qe=ae.children,{patchFlag:pt,shapeFlag:wt}=ae;if(pt>0){if(pt&128){Te(ze,Qe,Le,ye,ue,Oe,De,Me,Ve);return}else if(pt&256){Ae(ze,Qe,Le,ye,ue,Oe,De,Me,Ve);return}}wt&8?(st&16&&he(ze,ue,Oe),Qe!==ze&&_(Le,Qe)):st&16?wt&16?Te(ze,Qe,Le,ye,ue,Oe,De,Me,Ve):he(ze,ue,Oe,!0):(st&8&&_(Le,""),wt&16&&O(Qe,Le,ye,ue,Oe,De,Me,Ve))},Ae=(te,ae,Le,ye,ue,Oe,De,Me,Ve)=>{te=te||zh,ae=ae||zh;const ze=te.length,st=ae.length,Qe=Math.min(ze,st);let pt;for(pt=0;pt<Qe;pt++){const wt=ae[pt]=Ve?vc(ae[pt]):xu(ae[pt]);j(te[pt],wt,Le,null,ue,Oe,De,Me,Ve)}ze>st?he(te,ue,Oe,!0,!1,Qe):O(ae,Le,ye,ue,Oe,De,Me,Ve,Qe)},Te=(te,ae,Le,ye,ue,Oe,De,Me,Ve)=>{let ze=0;const st=ae.length;let Qe=te.length-1,pt=st-1;for(;ze<=Qe&&ze<=pt;){const wt=te[ze],Ht=ae[ze]=Ve?vc(ae[ze]):xu(ae[ze]);if(Yc(wt,Ht))j(wt,Ht,Le,null,ue,Oe,De,Me,Ve);else break;ze++}for(;ze<=Qe&&ze<=pt;){const wt=te[Qe],Ht=ae[pt]=Ve?vc(ae[pt]):xu(ae[pt]);if(Yc(wt,Ht))j(wt,Ht,Le,null,ue,Oe,De,Me,Ve);else break;Qe--,pt--}if(ze>Qe){if(ze<=pt){const wt=pt+1,Ht=wt<st?ae[wt].el:ye;for(;ze<=pt;)j(null,ae[ze]=Ve?vc(ae[ze]):xu(ae[ze]),Le,Ht,ue,Oe,De,Me,Ve),ze++}}else if(ze>pt)for(;ze<=Qe;)X(te[ze],ue,Oe,!0),ze++;else{const wt=ze,Ht=ze,nn=new Map;for(ze=Ht;ze<=pt;ze++){const xn=ae[ze]=Ve?vc(ae[ze]):xu(ae[ze]);xn.key!=null&&nn.set(xn.key,ze)}let tt,Qt=0;const rn=pt-Ht+1;let it=!1,Ke=0;const qt=new Array(rn);for(ze=0;ze<rn;ze++)qt[ze]=0;for(ze=wt;ze<=Qe;ze++){const xn=te[ze];if(Qt>=rn){X(xn,ue,Oe,!0);continue}let wn;if(xn.key!=null)wn=nn.get(xn.key);else for(tt=Ht;tt<=pt;tt++)if(qt[tt-Ht]===0&&Yc(xn,ae[tt])){wn=tt;break}wn===void 0?X(xn,ue,Oe,!0):(qt[wn-Ht]=ze+1,wn>=Ke?Ke=wn:it=!0,j(xn,ae[wn],Le,null,ue,Oe,De,Me,Ve),Qt++)}const mn=it?fC(qt):zh;for(tt=mn.length-1,ze=rn-1;ze>=0;ze--){const xn=Ht+ze,wn=ae[xn],ot=xn+1<st?ae[xn+1].el:ye;qt[ze]===0?j(null,wn,Le,ot,ue,Oe,De,Me,Ve):it&&(tt<0||ze!==mn[tt]?ut(wn,Le,ot,2):tt--)}}},ut=(te,ae,Le,ye,ue=null)=>{const{el:Oe,type:De,transition:Me,children:Ve,shapeFlag:ze}=te;if(ze&6){ut(te.component.subTree,ae,Le,ye);return}if(ze&128){te.suspense.move(ae,Le,ye);return}if(ze&64){De.move(te,ae,Le,oe);return}if(De===Vn){i(Oe,ae,Le);for(let Qe=0;Qe<Ve.length;Qe++)ut(Ve[Qe],ae,Le,ye);i(te.anchor,ae,Le);return}if(De===Od){pe(te,ae,Le);return}if(ye!==2&&ze&1&&Me)if(ye===0)Me.beforeEnter(Oe),i(Oe,ae,Le),xa(()=>Me.enter(Oe),ue);else{const{leave:Qe,delayLeave:pt,afterLeave:wt}=Me,Ht=()=>i(Oe,ae,Le),nn=()=>{Qe(Oe,()=>{Ht(),wt&&wt()})};pt?pt(Oe,Ht,nn):nn()}else i(Oe,ae,Le)},X=(te,ae,Le,ye=!1,ue=!1)=>{const{type:Oe,props:De,ref:Me,children:Ve,dynamicChildren:ze,shapeFlag:st,patchFlag:Qe,dirs:pt,cacheIndex:wt}=te;if(Qe===-2&&(ue=!1),Me!=null&&tp(Me,null,Le,te,!0),wt!=null&&(ae.renderCache[wt]=void 0),st&256){ae.ctx.deactivate(te);return}const Ht=st&1&&pt,nn=!Ef(te);let tt;if(nn&&(tt=De&&De.onVnodeBeforeUnmount)&&gu(tt,ae,te),st&6)W(te.component,Le,ye);else{if(st&128){te.suspense.unmount(Le,ye);return}Ht&&qc(te,null,ae,"beforeUnmount"),st&64?te.type.remove(te,ae,Le,oe,ye):ze&&!ze.hasOnce&&(Oe!==Vn||Qe>0&&Qe&64)?he(ze,ae,Le,!1,!0):(Oe===Vn&&Qe&384||!ue&&st&16)&&he(Ve,ae,Le),ye&&ke(te)}(nn&&(tt=De&&De.onVnodeUnmounted)||Ht)&&xa(()=>{tt&&gu(tt,ae,te),Ht&&qc(te,null,ae,"unmounted")},Le)},ke=te=>{const{type:ae,el:Le,anchor:ye,transition:ue}=te;if(ae===Vn){B(Le,ye);return}if(ae===Od){Ee(te);return}const Oe=()=>{r(Le),ue&&!ue.persisted&&ue.afterLeave&&ue.afterLeave()};if(te.shapeFlag&1&&ue&&!ue.persisted){const{leave:De,delayLeave:Me}=ue,Ve=()=>De(Le,Oe);Me?Me(te.el,Oe,Ve):Ve()}else Oe()},B=(te,ae)=>{let Le;for(;te!==ae;)Le=E(te),r(te),te=Le;r(ae)},W=(te,ae,Le)=>{const{bum:ye,scope:ue,job:Oe,subTree:De,um:Me,m:Ve,a:ze}=te;X1(Ve),X1(ze),ye&&Nd(ye),ue.stop(),Oe&&(Oe.flags|=8,X(De,te,ae,Le)),Me&&xa(Me,ae),xa(()=>{te.isUnmounted=!0},ae),ae&&ae.pendingBranch&&!ae.isUnmounted&&te.asyncDep&&!te.asyncResolved&&te.suspenseId===ae.pendingId&&(ae.deps--,ae.deps===0&&ae.resolve())},he=(te,ae,Le,ye=!1,ue=!1,Oe=0)=>{for(let De=Oe;De<te.length;De++)X(te[De],ae,Le,ye,ue)},ne=te=>{if(te.shapeFlag&6)return ne(te.component.subTree);if(te.shapeFlag&128)return te.suspense.next();const ae=E(te.anchor||te.el),Le=ae&&ae[k_];return Le?E(Le):ae};let re=!1;const ee=(te,ae,Le)=>{te==null?ae._vnode&&X(ae._vnode,null,null,!0):j(ae._vnode||null,te,ae,null,null,null,Le),ae._vnode=te,re||(re=!0,U1(),P_(),re=!1)},oe={p:j,um:X,m:ut,r:ke,mt:$,mc:O,pc:ie,pbc:le,n:ne,o:e};return{render:ee,hydrate:void 0,createApp:tC(ee)}}function M0({type:e,props:n},t){return t==="svg"&&e==="foreignObject"||t==="mathml"&&e==="annotation-xml"&&n&&n.encoding&&n.encoding.includes("html")?void 0:t}function Gc({effect:e,job:n},t){t?(e.flags|=32,n.flags|=4):(e.flags&=-33,n.flags&=-5)}function hC(e,n){return(!e||e&&!e.pendingBranch)&&n&&!n.persisted}function cm(e,n,t=!1){const i=e.children,r=n.children;if(hi(i)&&hi(r))for(let o=0;o<i.length;o++){const l=i[o];let h=r[o];h.shapeFlag&1&&!h.dynamicChildren&&((h.patchFlag<=0||h.patchFlag===32)&&(h=r[o]=vc(r[o]),h.el=l.el),!t&&h.patchFlag!==-2&&cm(l,h)),h.type===Mp&&(h.el=l.el)}}function fC(e){const n=e.slice(),t=[0];let i,r,o,l,h;const p=e.length;for(i=0;i<p;i++){const m=e[i];if(m!==0){if(r=t[t.length-1],e[r]<m){n[i]=r,t.push(i);continue}for(o=0,l=t.length-1;o<l;)h=o+l>>1,e[t[h]]<m?o=h+1:l=h;m<e[t[o]]&&(o>0&&(n[i]=t[o-1]),t[o]=i)}}for(o=t.length,l=t[o-1];o-- >0;)t[o]=l,l=n[l];return t}function X_(e){const n=e.subTree.component;if(n)return n.asyncDep&&!n.asyncResolved?n:X_(n)}function X1(e){if(e)for(let n=0;n<e.length;n++)e[n].flags|=8}const dC=Symbol.for("v-scx"),pC=()=>Ml(dC);function hg(e,n){return hm(e,null,n)}function Ur(e,n,t){return hm(e,n,t)}function hm(e,n,t=Yr){const{immediate:i,deep:r,flush:o,once:l}=t,h=So({},t),p=n&&i||!n&&o!=="post";let m;if($f){if(o==="sync"){const b=pC();m=b.__watcherHandles||(b.__watcherHandles=[])}else if(!p){const b=()=>{};return b.stop=Pu,b.resume=Pu,b.pause=Pu,b}}const _=Co;h.call=(b,D,j)=>eu(b,_,D,j);let w=!1;o==="post"?h.scheduler=b=>{xa(b,_&&_.suspense)}:o!=="sync"&&(w=!0,h.scheduler=(b,D)=>{D?b():lm(b)}),h.augmentJob=b=>{n&&(b.flags|=4),w&&(b.flags|=2,_&&(b.id=_.uid,b.i=_))};const E=PL(e,n,h);return $f&&(m?m.push(E):p&&E()),E}function gC(e,n,t){const i=this.proxy,r=js(e)?e.includes(".")?Q_(i,e):()=>i[e]:e.bind(i,i);let o;Ri(n)?o=n:(o=n.handler,t=n);const l=Jf(this),h=hm(r,o.bind(i),t);return l(),h}function Q_(e,n){const t=n.split(".");return()=>{let i=e;for(let r=0;r<t.length&&i;r++)i=i[t[r]];return i}}const mC=(e,n)=>n==="modelValue"||n==="model-value"?e.modelModifiers:e[`${n}Modifiers`]||e[`${Bl(n)}Modifiers`]||e[`${ch(n)}Modifiers`];function vC(e,n,...t){if(e.isUnmounted)return;const i=e.vnode.props||Yr;let r=t;const o=n.startsWith("update:"),l=o&&mC(i,n.slice(7));l&&(l.trim&&(r=t.map(_=>js(_)?_.trim():_)),l.number&&(r=t.map(Jd)));let h,p=i[h=x0(n)]||i[h=x0(Bl(n))];!p&&o&&(p=i[h=x0(ch(n))]),p&&eu(p,e,6,r);const m=i[h+"Once"];if(m){if(!e.emitted)e.emitted={};else if(e.emitted[h])return;e.emitted[h]=!0,eu(m,e,6,r)}}function e2(e,n,t=!1){const i=n.emitsCache,r=i.get(e);if(r!==void 0)return r;const o=e.emits;let l={},h=!1;if(!Ri(e)){const p=m=>{const _=e2(m,n,!0);_&&(h=!0,So(l,_))};!t&&n.mixins.length&&n.mixins.forEach(p),e.extends&&p(e.extends),e.mixins&&e.mixins.forEach(p)}return!o&&!h?(Xr(e)&&i.set(e,null),null):(hi(o)?o.forEach(p=>l[p]=null):So(l,o),Xr(e)&&i.set(e,l),l)}function kp(e,n){return!e||!bp(n)?!1:(n=n.slice(2).replace(/Once$/,""),Dr(e,n[0].toLowerCase()+n.slice(1))||Dr(e,ch(n))||Dr(e,n))}function Q1(e){const{type:n,vnode:t,proxy:i,withProxy:r,propsOptions:[o],slots:l,attrs:h,emit:p,render:m,renderCache:_,props:w,data:E,setupState:b,ctx:D,inheritAttrs:j}=e,Q=ep(e);let F,V;try{if(t.shapeFlag&4){const Ee=r||i,Ie=Ee;F=xu(m.call(Ie,Ee,_,w,b,E,D)),V=h}else{const Ee=n;F=xu(Ee.length>1?Ee(w,{attrs:h,slots:l,emit:p}):Ee(w,null)),V=n.props?h:yC(h)}}catch(Ee){kf.length=0,Sp(Ee,e,1),F=$r(qa)}let pe=F;if(V&&j!==!1){const Ee=Object.keys(V),{shapeFlag:Ie}=pe;Ee.length&&Ie&7&&(o&&Ee.some(Jg)&&(V=_C(V,o)),pe=Pc(pe,V,!1,!0))}return t.dirs&&(pe=Pc(pe,null,!1,!0),pe.dirs=pe.dirs?pe.dirs.concat(t.dirs):t.dirs),t.transition&&jf(pe,t.transition),F=pe,ep(Q),F}const yC=e=>{let n;for(const t in e)(t==="class"||t==="style"||bp(t))&&((n||(n={}))[t]=e[t]);return n},_C=(e,n)=>{const t={};for(const i in e)(!Jg(i)||!(i.slice(9)in n))&&(t[i]=e[i]);return t};function bC(e,n,t){const{props:i,children:r,component:o}=e,{props:l,children:h,patchFlag:p}=n,m=o.emitsOptions;if(n.dirs||n.transition)return!0;if(t&&p>=0){if(p&1024)return!0;if(p&16)return i?ev(i,l,m):!!l;if(p&8){const _=n.dynamicProps;for(let w=0;w<_.length;w++){const E=_[w];if(l[E]!==i[E]&&!kp(m,E))return!0}}}else return(r||h)&&(!h||!h.$stable)?!0:i===l?!1:i?l?ev(i,l,m):!0:!!l;return!1}function ev(e,n,t){const i=Object.keys(n);if(i.length!==Object.keys(e).length)return!0;for(let r=0;r<i.length;r++){const o=i[r];if(n[o]!==e[o]&&!kp(t,o))return!0}return!1}function wC({vnode:e,parent:n},t){for(;n;){const i=n.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i===e)(e=n.vnode).el=t,n=n.parent;else break}}const t2=e=>e.__isSuspense;function xC(e,n){n&&n.pendingBranch?hi(e)?n.effects.push(...e):n.effects.push(e):kL(e)}const Vn=Symbol.for("v-fgt"),Mp=Symbol.for("v-txt"),qa=Symbol.for("v-cmt"),Od=Symbol.for("v-stc"),kf=[];let ul=null;function et(e=!1){kf.push(ul=e?null:[])}function LC(){kf.pop(),ul=kf[kf.length-1]||null}let Uf=1;function tv(e,n=!1){Uf+=e,e<0&&ul&&n&&(ul.hasOnce=!0)}function n2(e){return e.dynamicChildren=Uf>0?ul||zh:null,LC(),Uf>0&&ul&&ul.push(e),e}function rt(e,n,t,i,r,o){return n2(A(e,n,t,i,r,o,!0))}function Yl(e,n,t,i,r){return n2($r(e,n,t,i,r,!0))}function ip(e){return e?e.__v_isVNode===!0:!1}function Yc(e,n){return e.type===n.type&&e.key===n.key}const i2=({key:e})=>e??null,Id=({ref:e,ref_key:n,ref_for:t})=>(typeof e=="number"&&(e=""+e),e!=null?js(e)||Qs(e)||Ri(e)?{i:Sa,r:e,k:n,f:!!t}:e:null);function A(e,n=null,t=null,i=0,r=null,o=e===Vn?0:1,l=!1,h=!1){const p={__v_isVNode:!0,__v_skip:!0,type:e,props:n,key:n&&i2(n),ref:n&&Id(n),scopeId:A_,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:Sa};return h?(fm(p,t),o&128&&e.normalize(p)):t&&(p.shapeFlag|=js(t)?8:16),Uf>0&&!l&&ul&&(p.patchFlag>0||o&6)&&p.patchFlag!==32&&ul.push(p),p}const $r=CC;function CC(e,n=null,t=null,i=0,r=null,o=!1){if((!e||e===HL)&&(e=qa),ip(e)){const h=Pc(e,n,!0);return t&&fm(h,t),Uf>0&&!o&&ul&&(h.shapeFlag&6?ul[ul.indexOf(e)]=h:ul.push(h)),h.patchFlag=-2,h}if(OC(e)&&(e=e.__vccOpts),n){n=SC(n);let{class:h,style:p}=n;h&&!js(h)&&(n.class=Jr(h)),Xr(p)&&(om(p)&&!hi(p)&&(p=So({},p)),n.style=_c(p))}const l=js(e)?1:t2(e)?128:M_(e)?64:Xr(e)?4:Ri(e)?2:0;return A(e,n,t,i,r,l,o,!0)}function SC(e){return e?om(e)||V_(e)?So({},e):e:null}function Pc(e,n,t=!1,i=!1){const{props:r,ref:o,patchFlag:l,children:h,transition:p}=e,m=n?PC(r||{},n):r,_={__v_isVNode:!0,__v_skip:!0,type:e.type,props:m,key:m&&i2(m),ref:n&&n.ref?t&&o?hi(o)?o.concat(Id(n)):[o,Id(n)]:Id(n):o,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:h,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:n&&e.type!==Vn?l===-1?16:l|16:l,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:p,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Pc(e.ssContent),ssFallback:e.ssFallback&&Pc(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return p&&i&&jf(_,p.clone(_)),_}function Ir(e=" ",n=0){return $r(Mp,null,e,n)}function Cc(e,n){const t=$r(Od,null,e);return t.staticCount=n,t}function Cn(e="",n=!1){return n?(et(),Yl(qa,null,e)):$r(qa,null,e)}function xu(e){return e==null||typeof e=="boolean"?$r(qa):hi(e)?$r(Vn,null,e.slice()):ip(e)?vc(e):$r(Mp,null,String(e))}function vc(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Pc(e)}function fm(e,n){let t=0;const{shapeFlag:i}=e;if(n==null)n=null;else if(hi(n))t=16;else if(typeof n=="object")if(i&65){const r=n.default;r&&(r._c&&(r._d=!1),fm(e,r()),r._c&&(r._d=!0));return}else{t=32;const r=n._;!r&&!V_(n)?n._ctx=Sa:r===3&&Sa&&(Sa.slots._===1?n._=1:(n._=2,e.patchFlag|=1024))}else Ri(n)?(n={default:n,_ctx:Sa},t=32):(n=String(n),i&64?(t=16,n=[Ir(n)]):t=8);e.children=n,e.shapeFlag|=t}function PC(...e){const n={};for(let t=0;t<e.length;t++){const i=e[t];for(const r in i)if(r==="class")n.class!==i.class&&(n.class=Jr([n.class,i.class]));else if(r==="style")n.style=_c([n.style,i.style]);else if(bp(r)){const o=n[r],l=i[r];l&&o!==l&&!(hi(o)&&o.includes(l))&&(n[r]=o?[].concat(o,l):l)}else r!==""&&(n[r]=i[r])}return n}function gu(e,n,t,i=null){eu(e,n,7,[t,i])}const EC=$_();let AC=0;function kC(e,n,t){const i=e.type,r=(n?n.appContext:e.appContext)||EC,o={uid:AC++,vnode:e,type:i,parent:n,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new r_(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:n?n.provides:Object.create(r.provides),ids:n?n.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:W_(i,r),emitsOptions:e2(i,r),emit:null,emitted:null,propsDefaults:Yr,inheritAttrs:i.inheritAttrs,ctx:Yr,data:Yr,props:Yr,attrs:Yr,slots:Yr,refs:Yr,setupState:Yr,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return o.ctx={_:o},o.root=n?n.root:o,o.emit=vC.bind(null,o),e.ce&&e.ce(o),o}let Co=null;const MC=()=>Co||Sa;let rp,fg;{const e=Lp(),n=(t,i)=>{let r;return(r=e[t])||(r=e[t]=[]),r.push(i),o=>{r.length>1?r.forEach(l=>l(o)):r[0](o)}};rp=n("__VUE_INSTANCE_SETTERS__",t=>Co=t),fg=n("__VUE_SSR_SETTERS__",t=>$f=t)}const Jf=e=>{const n=Co;return rp(e),e.scope.on(),()=>{e.scope.off(),rp(n)}},nv=()=>{Co&&Co.scope.off(),rp(null)};function r2(e){return e.vnode.shapeFlag&4}let $f=!1;function TC(e,n=!1,t=!1){n&&fg(n);const{props:i,children:r}=e.vnode,o=r2(e);iC(e,i,o,n),aC(e,r,t);const l=o?BC(e,n):void 0;return n&&fg(!1),l}function BC(e,n){const t=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,ZL);const{setup:i}=t;if(i){Tc();const r=e.setupContext=i.length>1?DC(e):null,o=Jf(e),l=Kf(i,e,0,[e.props,r]),h=Yy(l);if(Bc(),o(),(h||e.sp)&&!Ef(e)&&F_(e),h){if(l.then(nv,nv),n)return l.then(p=>{iv(e,p)}).catch(p=>{Sp(p,e,0)});e.asyncDep=l}else iv(e,l)}else s2(e)}function iv(e,n,t){Ri(n)?e.type.__ssrInlineRender?e.ssrRender=n:e.render=n:Xr(n)&&(e.setupState=L_(n)),s2(e)}function s2(e,n,t){const i=e.type;e.render||(e.render=i.render||Pu);{const r=Jf(e);Tc();try{KL(e)}finally{Bc(),r()}}}const NC={get(e,n){return oa(e,"get",""),e[n]}};function DC(e){const n=t=>{e.exposed=t||{}};return{attrs:new Proxy(e.attrs,NC),slots:e.slots,emit:e.emit,expose:n}}function Tp(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(L_(am(e.exposed)),{get(n,t){if(t in n)return n[t];if(t in Af)return Af[t](e)},has(n,t){return t in n||t in Af}})):e.proxy}function RC(e,n=!0){return Ri(e)?e.displayName||e.name:e.name||n&&e.__name}function OC(e){return Ri(e)&&"__vccOpts"in e}const Di=(e,n)=>CL(e,n,$f);function dm(e,n,t){const i=arguments.length;return i===2?Xr(n)&&!hi(n)?ip(n)?$r(e,null,[n]):$r(e,n):$r(e,null,n):(i>3?t=Array.prototype.slice.call(arguments,2):i===3&&ip(t)&&(t=[t]),$r(e,n,t))}const IC="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let dg;const rv=typeof window<"u"&&window.trustedTypes;if(rv)try{dg=rv.createPolicy("vue",{createHTML:e=>e})}catch{}const o2=dg?e=>dg.createHTML(e):e=>e,FC="http://www.w3.org/2000/svg",zC="http://www.w3.org/1998/Math/MathML",Ku=typeof document<"u"?document:null,sv=Ku&&Ku.createElement("template"),jC={insert:(e,n,t)=>{n.insertBefore(e,t||null)},remove:e=>{const n=e.parentNode;n&&n.removeChild(e)},createElement:(e,n,t,i)=>{const r=n==="svg"?Ku.createElementNS(FC,e):n==="mathml"?Ku.createElementNS(zC,e):t?Ku.createElement(e,{is:t}):Ku.createElement(e);return e==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:e=>Ku.createTextNode(e),createComment:e=>Ku.createComment(e),setText:(e,n)=>{e.nodeValue=n},setElementText:(e,n)=>{e.textContent=n},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Ku.querySelector(e),setScopeId(e,n){e.setAttribute(n,"")},insertStaticContent(e,n,t,i,r,o){const l=t?t.previousSibling:n.lastChild;if(r&&(r===o||r.nextSibling))for(;n.insertBefore(r.cloneNode(!0),t),!(r===o||!(r=r.nextSibling)););else{sv.innerHTML=o2(i==="svg"?`<svg>${e}</svg>`:i==="mathml"?`<math>${e}</math>`:e);const h=sv.content;if(i==="svg"||i==="mathml"){const p=h.firstChild;for(;p.firstChild;)h.appendChild(p.firstChild);h.removeChild(p)}n.insertBefore(h,t)}return[l?l.nextSibling:n.firstChild,t?t.previousSibling:n.lastChild]}},uc="transition",uf="animation",qf=Symbol("_vtc"),a2={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},UC=So({},N_,a2),$C=e=>(e.displayName="Transition",e.props=UC,e),sp=$C((e,{slots:n})=>dm(NL,qC(e),n)),Vc=(e,n=[])=>{hi(e)?e.forEach(t=>t(...n)):e&&e(...n)},ov=e=>e?hi(e)?e.some(n=>n.length>1):e.length>1:!1;function qC(e){const n={};for(const I in e)I in a2||(n[I]=e[I]);if(e.css===!1)return n;const{name:t="v",type:i,duration:r,enterFromClass:o=`${t}-enter-from`,enterActiveClass:l=`${t}-enter-active`,enterToClass:h=`${t}-enter-to`,appearFromClass:p=o,appearActiveClass:m=l,appearToClass:_=h,leaveFromClass:w=`${t}-leave-from`,leaveActiveClass:E=`${t}-leave-active`,leaveToClass:b=`${t}-leave-to`}=e,D=GC(r),j=D&&D[0],Q=D&&D[1],{onBeforeEnter:F,onEnter:V,onEnterCancelled:pe,onLeave:Ee,onLeaveCancelled:Ie,onBeforeAppear:nt=F,onAppear:We=V,onAppearCancelled:O=pe}=n,H=(I,Y,$,R)=>{I._enterCancelled=R,Hc(I,Y?_:h),Hc(I,Y?m:l),$&&$()},le=(I,Y)=>{I._isLeaving=!1,Hc(I,w),Hc(I,b),Hc(I,E),Y&&Y()},G=I=>(Y,$)=>{const R=I?We:V,Z=()=>H(Y,I,$);Vc(R,[Y,Z]),av(()=>{Hc(Y,I?p:o),Gu(Y,I?_:h),ov(R)||lv(Y,i,j,Z)})};return So(n,{onBeforeEnter(I){Vc(F,[I]),Gu(I,o),Gu(I,l)},onBeforeAppear(I){Vc(nt,[I]),Gu(I,p),Gu(I,m)},onEnter:G(!1),onAppear:G(!0),onLeave(I,Y){I._isLeaving=!0;const $=()=>le(I,Y);Gu(I,w),I._enterCancelled?(Gu(I,E),hv()):(hv(),Gu(I,E)),av(()=>{I._isLeaving&&(Hc(I,w),Gu(I,b),ov(Ee)||lv(I,i,Q,$))}),Vc(Ee,[I,$])},onEnterCancelled(I){H(I,!1,void 0,!0),Vc(pe,[I])},onAppearCancelled(I){H(I,!0,void 0,!0),Vc(O,[I])},onLeaveCancelled(I){le(I),Vc(Ie,[I])}})}function GC(e){if(e==null)return null;if(Xr(e))return[T0(e.enter),T0(e.leave)];{const n=T0(e);return[n,n]}}function T0(e){return qx(e)}function Gu(e,n){n.split(/\s+/).forEach(t=>t&&e.classList.add(t)),(e[qf]||(e[qf]=new Set)).add(n)}function Hc(e,n){n.split(/\s+/).forEach(i=>i&&e.classList.remove(i));const t=e[qf];t&&(t.delete(n),t.size||(e[qf]=void 0))}function av(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let VC=0;function lv(e,n,t,i){const r=e._endId=++VC,o=()=>{r===e._endId&&i()};if(t!=null)return setTimeout(o,t);const{type:l,timeout:h,propCount:p}=HC(e,n);if(!l)return i();const m=l+"end";let _=0;const w=()=>{e.removeEventListener(m,E),o()},E=b=>{b.target===e&&++_>=p&&w()};setTimeout(()=>{_<p&&w()},h+1),e.addEventListener(m,E)}function HC(e,n){const t=window.getComputedStyle(e),i=D=>(t[D]||"").split(", "),r=i(`${uc}Delay`),o=i(`${uc}Duration`),l=uv(r,o),h=i(`${uf}Delay`),p=i(`${uf}Duration`),m=uv(h,p);let _=null,w=0,E=0;n===uc?l>0&&(_=uc,w=l,E=o.length):n===uf?m>0&&(_=uf,w=m,E=p.length):(w=Math.max(l,m),_=w>0?l>m?uc:uf:null,E=_?_===uc?o.length:p.length:0);const b=_===uc&&/\b(transform|all)(,|$)/.test(i(`${uc}Property`).toString());return{type:_,timeout:w,propCount:E,hasTransform:b}}function uv(e,n){for(;e.length<n.length;)e=e.concat(e);return Math.max(...n.map((t,i)=>cv(t)+cv(e[i])))}function cv(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function hv(){return document.body.offsetHeight}function WC(e,n,t){const i=e[qf];i&&(n=(n?[n,...i]:[...i]).join(" ")),n==null?e.removeAttribute("class"):t?e.setAttribute("class",n):e.className=n}const op=Symbol("_vod"),l2=Symbol("_vsh"),_f={beforeMount(e,{value:n},{transition:t}){e[op]=e.style.display==="none"?"":e.style.display,t&&n?t.beforeEnter(e):cf(e,n)},mounted(e,{value:n},{transition:t}){t&&n&&t.enter(e)},updated(e,{value:n,oldValue:t},{transition:i}){!n!=!t&&(i?n?(i.beforeEnter(e),cf(e,!0),i.enter(e)):i.leave(e,()=>{cf(e,!1)}):cf(e,n))},beforeUnmount(e,{value:n}){cf(e,n)}};function cf(e,n){e.style.display=n?e[op]:"none",e[l2]=!n}const ZC=Symbol(""),KC=/(^|;)\s*display\s*:/;function JC(e,n,t){const i=e.style,r=js(t);let o=!1;if(t&&!r){if(n)if(js(n))for(const l of n.split(";")){const h=l.slice(0,l.indexOf(":")).trim();t[h]==null&&Fd(i,h,"")}else for(const l in n)t[l]==null&&Fd(i,l,"");for(const l in t)l==="display"&&(o=!0),Fd(i,l,t[l])}else if(r){if(n!==t){const l=i[ZC];l&&(t+=";"+l),i.cssText=t,o=KC.test(t)}}else n&&e.removeAttribute("style");op in e&&(e[op]=o?i.display:"",e[l2]&&(i.display="none"))}const fv=/\s*!important$/;function Fd(e,n,t){if(hi(t))t.forEach(i=>Fd(e,n,i));else if(t==null&&(t=""),n.startsWith("--"))e.setProperty(n,t);else{const i=YC(e,n);fv.test(t)?e.setProperty(ch(i),t.replace(fv,""),"important"):e[i]=t}}const dv=["Webkit","Moz","ms"],B0={};function YC(e,n){const t=B0[n];if(t)return t;let i=Bl(n);if(i!=="filter"&&i in e)return B0[n]=i;i=xp(i);for(let r=0;r<dv.length;r++){const o=dv[r]+i;if(o in e)return B0[n]=o}return n}const pv="http://www.w3.org/1999/xlink";function gv(e,n,t,i,r,o=Kx(n)){i&&n.startsWith("xlink:")?t==null?e.removeAttributeNS(pv,n.slice(6,n.length)):e.setAttributeNS(pv,n,t):t==null||o&&!t_(t)?e.removeAttribute(n):e.setAttribute(n,o?"":Au(t)?String(t):t)}function mv(e,n,t,i,r){if(n==="innerHTML"||n==="textContent"){t!=null&&(e[n]=n==="innerHTML"?o2(t):t);return}const o=e.tagName;if(n==="value"&&o!=="PROGRESS"&&!o.includes("-")){const h=o==="OPTION"?e.getAttribute("value")||"":e.value,p=t==null?e.type==="checkbox"?"on":"":String(t);(h!==p||!("_value"in e))&&(e.value=p),t==null&&e.removeAttribute(n),e._value=t;return}let l=!1;if(t===""||t==null){const h=typeof e[n];h==="boolean"?t=t_(t):t==null&&h==="string"?(t="",l=!0):h==="number"&&(t=0,l=!0)}try{e[n]=t}catch{}l&&e.removeAttribute(r||n)}function Xu(e,n,t,i){e.addEventListener(n,t,i)}function XC(e,n,t,i){e.removeEventListener(n,t,i)}const vv=Symbol("_vei");function QC(e,n,t,i,r=null){const o=e[vv]||(e[vv]={}),l=o[n];if(i&&l)l.value=i;else{const[h,p]=eS(n);if(i){const m=o[n]=iS(i,r);Xu(e,h,m,p)}else l&&(XC(e,h,l,p),o[n]=void 0)}}const yv=/(?:Once|Passive|Capture)$/;function eS(e){let n;if(yv.test(e)){n={};let i;for(;i=e.match(yv);)e=e.slice(0,e.length-i[0].length),n[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):ch(e.slice(2)),n]}let N0=0;const tS=Promise.resolve(),nS=()=>N0||(tS.then(()=>N0=0),N0=Date.now());function iS(e,n){const t=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=t.attached)return;eu(rS(i,t.value),n,5,[i])};return t.value=e,t.attached=nS(),t}function rS(e,n){if(hi(n)){const t=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{t.call(e),e._stopped=!0},n.map(i=>r=>!r._stopped&&i&&i(r))}else return n}const _v=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,sS=(e,n,t,i,r,o)=>{const l=r==="svg";n==="class"?WC(e,i,l):n==="style"?JC(e,t,i):bp(n)?Jg(n)||QC(e,n,t,i,o):(n[0]==="."?(n=n.slice(1),!0):n[0]==="^"?(n=n.slice(1),!1):oS(e,n,i,l))?(mv(e,n,i),!e.tagName.includes("-")&&(n==="value"||n==="checked"||n==="selected")&&gv(e,n,i,l,o,n!=="value")):e._isVueCE&&(/[A-Z]/.test(n)||!js(i))?mv(e,Bl(n),i,o,n):(n==="true-value"?e._trueValue=i:n==="false-value"&&(e._falseValue=i),gv(e,n,i,l))};function oS(e,n,t,i){if(i)return!!(n==="innerHTML"||n==="textContent"||n in e&&_v(n)&&Ri(t));if(n==="spellcheck"||n==="draggable"||n==="translate"||n==="form"||n==="list"&&e.tagName==="INPUT"||n==="type"&&e.tagName==="TEXTAREA")return!1;if(n==="width"||n==="height"){const r=e.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return _v(n)&&js(t)?!1:n in e}const Ec=e=>{const n=e.props["onUpdate:modelValue"]||!1;return hi(n)?t=>Nd(n,t):n};function aS(e){e.target.composing=!0}function bv(e){const n=e.target;n.composing&&(n.composing=!1,n.dispatchEvent(new Event("input")))}const Tl=Symbol("_assign"),Ui={created(e,{modifiers:{lazy:n,trim:t,number:i}},r){e[Tl]=Ec(r);const o=i||r.props&&r.props.type==="number";Xu(e,n?"change":"input",l=>{if(l.target.composing)return;let h=e.value;t&&(h=h.trim()),o&&(h=Jd(h)),e[Tl](h)}),t&&Xu(e,"change",()=>{e.value=e.value.trim()}),n||(Xu(e,"compositionstart",aS),Xu(e,"compositionend",bv),Xu(e,"change",bv))},mounted(e,{value:n}){e.value=n??""},beforeUpdate(e,{value:n,oldValue:t,modifiers:{lazy:i,trim:r,number:o}},l){if(e[Tl]=Ec(l),e.composing)return;const h=(o||e.type==="number")&&!/^0\d/.test(e.value)?Jd(e.value):e.value,p=n??"";h!==p&&(document.activeElement===e&&e.type!=="range"&&(i&&n===t||r&&e.value.trim()===p)||(e.value=p))}},u2={deep:!0,created(e,n,t){e[Tl]=Ec(t),Xu(e,"change",()=>{const i=e._modelValue,r=Hh(e),o=e.checked,l=e[Tl];if(hi(i)){const h=Qg(i,r),p=h!==-1;if(o&&!p)l(i.concat(r));else if(!o&&p){const m=[...i];m.splice(h,1),l(m)}}else if(Jh(i)){const h=new Set(i);o?h.add(r):h.delete(r),l(h)}else l(c2(e,o))})},mounted:wv,beforeUpdate(e,n,t){e[Tl]=Ec(t),wv(e,n,t)}};function wv(e,{value:n,oldValue:t},i){e._modelValue=n;let r;if(hi(n))r=Qg(n,i.props.value)>-1;else if(Jh(n))r=n.has(i.props.value);else{if(n===t)return;r=ah(n,c2(e,!0))}e.checked!==r&&(e.checked=r)}const lS={created(e,{value:n},t){e.checked=ah(n,t.props.value),e[Tl]=Ec(t),Xu(e,"change",()=>{e[Tl](Hh(e))})},beforeUpdate(e,{value:n,oldValue:t},i){e[Tl]=Ec(i),n!==t&&(e.checked=ah(n,i.props.value))}},Ks={deep:!0,created(e,{value:n,modifiers:{number:t}},i){const r=Jh(n);Xu(e,"change",()=>{const o=Array.prototype.filter.call(e.options,l=>l.selected).map(l=>t?Jd(Hh(l)):Hh(l));e[Tl](e.multiple?r?new Set(o):o:o[0]),e._assigning=!0,ks(()=>{e._assigning=!1})}),e[Tl]=Ec(i)},mounted(e,{value:n}){xv(e,n)},beforeUpdate(e,n,t){e[Tl]=Ec(t)},updated(e,{value:n}){e._assigning||xv(e,n)}};function xv(e,n){const t=e.multiple,i=hi(n);if(!(t&&!i&&!Jh(n))){for(let r=0,o=e.options.length;r<o;r++){const l=e.options[r],h=Hh(l);if(t)if(i){const p=typeof h;p==="string"||p==="number"?l.selected=n.some(m=>String(m)===String(h)):l.selected=Qg(n,h)>-1}else l.selected=n.has(h);else if(ah(Hh(l),n)){e.selectedIndex!==r&&(e.selectedIndex=r);return}}!t&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function Hh(e){return"_value"in e?e._value:e.value}function c2(e,n){const t=n?"_trueValue":"_falseValue";return t in e?e[t]:n}const uS={created(e,n,t){Sd(e,n,t,null,"created")},mounted(e,n,t){Sd(e,n,t,null,"mounted")},beforeUpdate(e,n,t,i){Sd(e,n,t,i,"beforeUpdate")},updated(e,n,t,i){Sd(e,n,t,i,"updated")}};function cS(e,n){switch(e){case"SELECT":return Ks;case"TEXTAREA":return Ui;default:switch(n){case"checkbox":return u2;case"radio":return lS;default:return Ui}}}function Sd(e,n,t,i,r){const l=cS(e.tagName,t.props&&t.props.type)[r];l&&l(e,n,t,i)}const hS=["ctrl","shift","alt","meta"],fS={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,n)=>hS.some(t=>e[`${t}Key`]&&!n.includes(t))},Bp=(e,n)=>{const t=e._withMods||(e._withMods={}),i=n.join(".");return t[i]||(t[i]=(r,...o)=>{for(let l=0;l<n.length;l++){const h=fS[n[l]];if(h&&h(r,n))return}return e(r,...o)})},dS=So({patchProp:sS},jC);let Lv;function pS(){return Lv||(Lv=uC(dS))}const gS=(...e)=>{const n=pS().createApp(...e),{mount:t}=n;return n.mount=i=>{const r=vS(i);if(!r)return;const o=n._component;!Ri(o)&&!o.render&&!o.template&&(o.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const l=t(r,!1,mS(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),l},n};function mS(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function vS(e){return js(e)?document.querySelector(e):e}/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let h2;const Np=e=>h2=e,f2=Symbol();function pg(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var Mf;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Mf||(Mf={}));function yS(){const e=s_(!0),n=e.run(()=>Yt({}));let t=[],i=[];const r=am({install(o){Np(r),r._a=o,o.provide(f2,r),o.config.globalProperties.$pinia=r,i.forEach(l=>t.push(l)),i=[]},use(o){return this._a?t.push(o):i.push(o),this},_p:t,_a:null,_e:e,_s:new Map,state:n});return r}const d2=()=>{};function Cv(e,n,t,i=d2){e.push(n);const r=()=>{const o=e.indexOf(n);o>-1&&(e.splice(o,1),i())};return!t&&o_()&&Yx(r),r}function Mh(e,...n){e.slice().forEach(t=>{t(...n)})}const _S=e=>e(),Sv=Symbol(),D0=Symbol();function gg(e,n){e instanceof Map&&n instanceof Map?n.forEach((t,i)=>e.set(i,t)):e instanceof Set&&n instanceof Set&&n.forEach(e.add,e);for(const t in n){if(!n.hasOwnProperty(t))continue;const i=n[t],r=e[t];pg(r)&&pg(i)&&e.hasOwnProperty(t)&&!Qs(i)&&!Lc(i)?e[t]=gg(r,i):e[t]=i}return e}const bS=Symbol();function wS(e){return!pg(e)||!e.hasOwnProperty(bS)}const{assign:pc}=Object;function xS(e){return!!(Qs(e)&&e.effect)}function LS(e,n,t,i){const{state:r,actions:o,getters:l}=n,h=t.state.value[e];let p;function m(){h||(t.state.value[e]=r?r():{});const _=bL(t.state.value[e]);return pc(_,o,Object.keys(l||{}).reduce((w,E)=>(w[E]=am(Di(()=>{Np(t);const b=t._s.get(e);return l[E].call(b,b)})),w),{}))}return p=p2(e,m,n,t,i,!0),p}function p2(e,n,t={},i,r,o){let l;const h=pc({actions:{}},t),p={deep:!0};let m,_,w=[],E=[],b;const D=i.state.value[e];!o&&!D&&(i.state.value[e]={}),Yt({});let j;function Q(O){let H;m=_=!1,typeof O=="function"?(O(i.state.value[e]),H={type:Mf.patchFunction,storeId:e,events:b}):(gg(i.state.value[e],O),H={type:Mf.patchObject,payload:O,storeId:e,events:b});const le=j=Symbol();ks().then(()=>{j===le&&(m=!0)}),_=!0,Mh(w,H,i.state.value[e])}const F=o?function(){const{state:H}=t,le=H?H():{};this.$patch(G=>{pc(G,le)})}:d2;function V(){l.stop(),w=[],E=[],i._s.delete(e)}const pe=(O,H="")=>{if(Sv in O)return O[D0]=H,O;const le=function(){Np(i);const G=Array.from(arguments),I=[],Y=[];function $(se){I.push(se)}function R(se){Y.push(se)}Mh(E,{args:G,name:le[D0],store:Ie,after:$,onError:R});let Z;try{Z=O.apply(this&&this.$id===e?this:Ie,G)}catch(se){throw Mh(Y,se),se}return Z instanceof Promise?Z.then(se=>(Mh(I,se),se)).catch(se=>(Mh(Y,se),Promise.reject(se))):(Mh(I,Z),Z)};return le[Sv]=!0,le[D0]=H,le},Ee={_p:i,$id:e,$onAction:Cv.bind(null,E),$patch:Q,$reset:F,$subscribe(O,H={}){const le=Cv(w,O,H.detached,()=>G()),G=l.run(()=>Ur(()=>i.state.value[e],I=>{(H.flush==="sync"?_:m)&&O({storeId:e,type:Mf.direct,events:b},I)},pc({},p,H)));return le},$dispose:V},Ie=ku(Ee);i._s.set(e,Ie);const We=(i._a&&i._a.runWithContext||_S)(()=>i._e.run(()=>(l=s_()).run(()=>n({action:pe}))));for(const O in We){const H=We[O];if(Qs(H)&&!xS(H)||Lc(H))o||(D&&wS(H)&&(Qs(H)?H.value=D[O]:gg(H,D[O])),i.state.value[e][O]=H);else if(typeof H=="function"){const le=pe(H,O);We[O]=le,h.actions[O]=H}}return pc(Ie,We),pc(wr(Ie),We),Object.defineProperty(Ie,"$state",{get:()=>i.state.value[e],set:O=>{Q(H=>{pc(H,O)})}}),i._p.forEach(O=>{pc(Ie,l.run(()=>O({store:Ie,app:i._a,pinia:i,options:h})))}),D&&o&&t.hydrate&&t.hydrate(Ie.$state,D),m=!0,_=!0,Ie}/*! #__NO_SIDE_EFFECTS__ */function Dp(e,n,t){let i,r;const o=typeof n=="function";typeof e=="string"?(i=e,r=o?t:n):(r=e,i=e.id);function l(h,p){const m=nC();return h=h||(m?Ml(f2,null):null),h&&Np(h),h=h2,h._s.has(i)||(o?p2(i,n,r,h):LS(i,r,h)),h._s.get(i)}return l.$id=i,l}function g2(e,n){return function(){return e.apply(n,arguments)}}const{toString:CS}=Object.prototype,{getPrototypeOf:pm}=Object,Rp=(e=>n=>{const t=CS.call(n);return e[t]||(e[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),iu=e=>(e=e.toLowerCase(),n=>Rp(n)===e),Op=e=>n=>typeof n===e,{isArray:Yh}=Array,Gf=Op("undefined");function SS(e){return e!==null&&!Gf(e)&&e.constructor!==null&&!Gf(e.constructor)&&hl(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const m2=iu("ArrayBuffer");function PS(e){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(e):n=e&&e.buffer&&m2(e.buffer),n}const ES=Op("string"),hl=Op("function"),v2=Op("number"),Ip=e=>e!==null&&typeof e=="object",AS=e=>e===!0||e===!1,zd=e=>{if(Rp(e)!=="object")return!1;const n=pm(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},kS=iu("Date"),MS=iu("File"),TS=iu("Blob"),BS=iu("FileList"),NS=e=>Ip(e)&&hl(e.pipe),DS=e=>{let n;return e&&(typeof FormData=="function"&&e instanceof FormData||hl(e.append)&&((n=Rp(e))==="formdata"||n==="object"&&hl(e.toString)&&e.toString()==="[object FormData]"))},RS=iu("URLSearchParams"),[OS,IS,FS,zS]=["ReadableStream","Request","Response","Headers"].map(iu),jS=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Yf(e,n,{allOwnKeys:t=!1}={}){if(e===null||typeof e>"u")return;let i,r;if(typeof e!="object"&&(e=[e]),Yh(e))for(i=0,r=e.length;i<r;i++)n.call(null,e[i],i,e);else{const o=t?Object.getOwnPropertyNames(e):Object.keys(e),l=o.length;let h;for(i=0;i<l;i++)h=o[i],n.call(null,e[h],h,e)}}function y2(e,n){n=n.toLowerCase();const t=Object.keys(e);let i=t.length,r;for(;i-- >0;)if(r=t[i],n===r.toLowerCase())return r;return null}const eh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,_2=e=>!Gf(e)&&e!==eh;function mg(){const{caseless:e}=_2(this)&&this||{},n={},t=(i,r)=>{const o=e&&y2(n,r)||r;zd(n[o])&&zd(i)?n[o]=mg(n[o],i):zd(i)?n[o]=mg({},i):Yh(i)?n[o]=i.slice():n[o]=i};for(let i=0,r=arguments.length;i<r;i++)arguments[i]&&Yf(arguments[i],t);return n}const US=(e,n,t,{allOwnKeys:i}={})=>(Yf(n,(r,o)=>{t&&hl(r)?e[o]=g2(r,t):e[o]=r},{allOwnKeys:i}),e),$S=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),qS=(e,n,t,i)=>{e.prototype=Object.create(n.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:n.prototype}),t&&Object.assign(e.prototype,t)},GS=(e,n,t,i)=>{let r,o,l;const h={};if(n=n||{},e==null)return n;do{for(r=Object.getOwnPropertyNames(e),o=r.length;o-- >0;)l=r[o],(!i||i(l,e,n))&&!h[l]&&(n[l]=e[l],h[l]=!0);e=t!==!1&&pm(e)}while(e&&(!t||t(e,n))&&e!==Object.prototype);return n},VS=(e,n,t)=>{e=String(e),(t===void 0||t>e.length)&&(t=e.length),t-=n.length;const i=e.indexOf(n,t);return i!==-1&&i===t},HS=e=>{if(!e)return null;if(Yh(e))return e;let n=e.length;if(!v2(n))return null;const t=new Array(n);for(;n-- >0;)t[n]=e[n];return t},WS=(e=>n=>e&&n instanceof e)(typeof Uint8Array<"u"&&pm(Uint8Array)),ZS=(e,n)=>{const i=(e&&e[Symbol.iterator]).call(e);let r;for(;(r=i.next())&&!r.done;){const o=r.value;n.call(e,o[0],o[1])}},KS=(e,n)=>{let t;const i=[];for(;(t=e.exec(n))!==null;)i.push(t);return i},JS=iu("HTMLFormElement"),YS=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,i,r){return i.toUpperCase()+r}),Pv=(({hasOwnProperty:e})=>(n,t)=>e.call(n,t))(Object.prototype),XS=iu("RegExp"),b2=(e,n)=>{const t=Object.getOwnPropertyDescriptors(e),i={};Yf(t,(r,o)=>{let l;(l=n(r,o,e))!==!1&&(i[o]=l||r)}),Object.defineProperties(e,i)},QS=e=>{b2(e,(n,t)=>{if(hl(e)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const i=e[t];if(hl(i)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},eP=(e,n)=>{const t={},i=r=>{r.forEach(o=>{t[o]=!0})};return Yh(e)?i(e):i(String(e).split(n)),t},tP=()=>{},nP=(e,n)=>e!=null&&Number.isFinite(e=+e)?e:n;function iP(e){return!!(e&&hl(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const rP=e=>{const n=new Array(10),t=(i,r)=>{if(Ip(i)){if(n.indexOf(i)>=0)return;if(!("toJSON"in i)){n[r]=i;const o=Yh(i)?[]:{};return Yf(i,(l,h)=>{const p=t(l,r+1);!Gf(p)&&(o[h]=p)}),n[r]=void 0,o}}return i};return t(e,0)},sP=iu("AsyncFunction"),oP=e=>e&&(Ip(e)||hl(e))&&hl(e.then)&&hl(e.catch),w2=((e,n)=>e?setImmediate:n?((t,i)=>(eh.addEventListener("message",({source:r,data:o})=>{r===eh&&o===t&&i.length&&i.shift()()},!1),r=>{i.push(r),eh.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",hl(eh.postMessage)),aP=typeof queueMicrotask<"u"?queueMicrotask.bind(eh):typeof process<"u"&&process.nextTick||w2,Xt={isArray:Yh,isArrayBuffer:m2,isBuffer:SS,isFormData:DS,isArrayBufferView:PS,isString:ES,isNumber:v2,isBoolean:AS,isObject:Ip,isPlainObject:zd,isReadableStream:OS,isRequest:IS,isResponse:FS,isHeaders:zS,isUndefined:Gf,isDate:kS,isFile:MS,isBlob:TS,isRegExp:XS,isFunction:hl,isStream:NS,isURLSearchParams:RS,isTypedArray:WS,isFileList:BS,forEach:Yf,merge:mg,extend:US,trim:jS,stripBOM:$S,inherits:qS,toFlatObject:GS,kindOf:Rp,kindOfTest:iu,endsWith:VS,toArray:HS,forEachEntry:ZS,matchAll:KS,isHTMLForm:JS,hasOwnProperty:Pv,hasOwnProp:Pv,reduceDescriptors:b2,freezeMethods:QS,toObjectSet:eP,toCamelCase:YS,noop:tP,toFiniteNumber:nP,findKey:y2,global:eh,isContextDefined:_2,isSpecCompliantForm:iP,toJSONObject:rP,isAsyncFn:sP,isThenable:oP,setImmediate:w2,asap:aP};function Hi(e,n,t,i,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",n&&(this.code=n),t&&(this.config=t),i&&(this.request=i),r&&(this.response=r,this.status=r.status?r.status:null)}Xt.inherits(Hi,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Xt.toJSONObject(this.config),code:this.code,status:this.status}}});const x2=Hi.prototype,L2={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{L2[e]={value:e}});Object.defineProperties(Hi,L2);Object.defineProperty(x2,"isAxiosError",{value:!0});Hi.from=(e,n,t,i,r,o)=>{const l=Object.create(x2);return Xt.toFlatObject(e,l,function(p){return p!==Error.prototype},h=>h!=="isAxiosError"),Hi.call(l,e.message,n,t,i,r),l.cause=e,l.name=e.name,o&&Object.assign(l,o),l};const lP=null;function vg(e){return Xt.isPlainObject(e)||Xt.isArray(e)}function C2(e){return Xt.endsWith(e,"[]")?e.slice(0,-2):e}function Ev(e,n,t){return e?e.concat(n).map(function(r,o){return r=C2(r),!t&&o?"["+r+"]":r}).join(t?".":""):n}function uP(e){return Xt.isArray(e)&&!e.some(vg)}const cP=Xt.toFlatObject(Xt,{},null,function(n){return/^is[A-Z]/.test(n)});function Fp(e,n,t){if(!Xt.isObject(e))throw new TypeError("target must be an object");n=n||new FormData,t=Xt.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(j,Q){return!Xt.isUndefined(Q[j])});const i=t.metaTokens,r=t.visitor||_,o=t.dots,l=t.indexes,p=(t.Blob||typeof Blob<"u"&&Blob)&&Xt.isSpecCompliantForm(n);if(!Xt.isFunction(r))throw new TypeError("visitor must be a function");function m(D){if(D===null)return"";if(Xt.isDate(D))return D.toISOString();if(!p&&Xt.isBlob(D))throw new Hi("Blob is not supported. Use a Buffer instead.");return Xt.isArrayBuffer(D)||Xt.isTypedArray(D)?p&&typeof Blob=="function"?new Blob([D]):Buffer.from(D):D}function _(D,j,Q){let F=D;if(D&&!Q&&typeof D=="object"){if(Xt.endsWith(j,"{}"))j=i?j:j.slice(0,-2),D=JSON.stringify(D);else if(Xt.isArray(D)&&uP(D)||(Xt.isFileList(D)||Xt.endsWith(j,"[]"))&&(F=Xt.toArray(D)))return j=C2(j),F.forEach(function(pe,Ee){!(Xt.isUndefined(pe)||pe===null)&&n.append(l===!0?Ev([j],Ee,o):l===null?j:j+"[]",m(pe))}),!1}return vg(D)?!0:(n.append(Ev(Q,j,o),m(D)),!1)}const w=[],E=Object.assign(cP,{defaultVisitor:_,convertValue:m,isVisitable:vg});function b(D,j){if(!Xt.isUndefined(D)){if(w.indexOf(D)!==-1)throw Error("Circular reference detected in "+j.join("."));w.push(D),Xt.forEach(D,function(F,V){(!(Xt.isUndefined(F)||F===null)&&r.call(n,F,Xt.isString(V)?V.trim():V,j,E))===!0&&b(F,j?j.concat(V):[V])}),w.pop()}}if(!Xt.isObject(e))throw new TypeError("data must be an object");return b(e),n}function Av(e){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(i){return n[i]})}function gm(e,n){this._pairs=[],e&&Fp(e,this,n)}const S2=gm.prototype;S2.append=function(n,t){this._pairs.push([n,t])};S2.toString=function(n){const t=n?function(i){return n.call(this,i,Av)}:Av;return this._pairs.map(function(r){return t(r[0])+"="+t(r[1])},"").join("&")};function hP(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function P2(e,n,t){if(!n)return e;const i=t&&t.encode||hP;Xt.isFunction(t)&&(t={serialize:t});const r=t&&t.serialize;let o;if(r?o=r(n,t):o=Xt.isURLSearchParams(n)?n.toString():new gm(n,t).toString(i),o){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+o}return e}class kv{constructor(){this.handlers=[]}use(n,t,i){return this.handlers.push({fulfilled:n,rejected:t,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){Xt.forEach(this.handlers,function(i){i!==null&&n(i)})}}const E2={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},fP=typeof URLSearchParams<"u"?URLSearchParams:gm,dP=typeof FormData<"u"?FormData:null,pP=typeof Blob<"u"?Blob:null,gP={isBrowser:!0,classes:{URLSearchParams:fP,FormData:dP,Blob:pP},protocols:["http","https","file","blob","url","data"]},mm=typeof window<"u"&&typeof document<"u",yg=typeof navigator=="object"&&navigator||void 0,mP=mm&&(!yg||["ReactNative","NativeScript","NS"].indexOf(yg.product)<0),vP=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",yP=mm&&window.location.href||"http://localhost",_P=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:mm,hasStandardBrowserEnv:mP,hasStandardBrowserWebWorkerEnv:vP,navigator:yg,origin:yP},Symbol.toStringTag,{value:"Module"})),la={..._P,...gP};function bP(e,n){return Fp(e,new la.classes.URLSearchParams,Object.assign({visitor:function(t,i,r,o){return la.isNode&&Xt.isBuffer(t)?(this.append(i,t.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},n))}function wP(e){return Xt.matchAll(/\w+|\[(\w*)]/g,e).map(n=>n[0]==="[]"?"":n[1]||n[0])}function xP(e){const n={},t=Object.keys(e);let i;const r=t.length;let o;for(i=0;i<r;i++)o=t[i],n[o]=e[o];return n}function A2(e){function n(t,i,r,o){let l=t[o++];if(l==="__proto__")return!0;const h=Number.isFinite(+l),p=o>=t.length;return l=!l&&Xt.isArray(r)?r.length:l,p?(Xt.hasOwnProp(r,l)?r[l]=[r[l],i]:r[l]=i,!h):((!r[l]||!Xt.isObject(r[l]))&&(r[l]=[]),n(t,i,r[l],o)&&Xt.isArray(r[l])&&(r[l]=xP(r[l])),!h)}if(Xt.isFormData(e)&&Xt.isFunction(e.entries)){const t={};return Xt.forEachEntry(e,(i,r)=>{n(wP(i),r,t,0)}),t}return null}function LP(e,n,t){if(Xt.isString(e))try{return(n||JSON.parse)(e),Xt.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(t||JSON.stringify)(e)}const Xf={transitional:E2,adapter:["xhr","http","fetch"],transformRequest:[function(n,t){const i=t.getContentType()||"",r=i.indexOf("application/json")>-1,o=Xt.isObject(n);if(o&&Xt.isHTMLForm(n)&&(n=new FormData(n)),Xt.isFormData(n))return r?JSON.stringify(A2(n)):n;if(Xt.isArrayBuffer(n)||Xt.isBuffer(n)||Xt.isStream(n)||Xt.isFile(n)||Xt.isBlob(n)||Xt.isReadableStream(n))return n;if(Xt.isArrayBufferView(n))return n.buffer;if(Xt.isURLSearchParams(n))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let h;if(o){if(i.indexOf("application/x-www-form-urlencoded")>-1)return bP(n,this.formSerializer).toString();if((h=Xt.isFileList(n))||i.indexOf("multipart/form-data")>-1){const p=this.env&&this.env.FormData;return Fp(h?{"files[]":n}:n,p&&new p,this.formSerializer)}}return o||r?(t.setContentType("application/json",!1),LP(n)):n}],transformResponse:[function(n){const t=this.transitional||Xf.transitional,i=t&&t.forcedJSONParsing,r=this.responseType==="json";if(Xt.isResponse(n)||Xt.isReadableStream(n))return n;if(n&&Xt.isString(n)&&(i&&!this.responseType||r)){const l=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(n)}catch(h){if(l)throw h.name==="SyntaxError"?Hi.from(h,Hi.ERR_BAD_RESPONSE,this,null,this.response):h}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:la.classes.FormData,Blob:la.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Xt.forEach(["delete","get","head","post","put","patch"],e=>{Xf.headers[e]={}});const CP=Xt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),SP=e=>{const n={};let t,i,r;return e&&e.split(`
`).forEach(function(l){r=l.indexOf(":"),t=l.substring(0,r).trim().toLowerCase(),i=l.substring(r+1).trim(),!(!t||n[t]&&CP[t])&&(t==="set-cookie"?n[t]?n[t].push(i):n[t]=[i]:n[t]=n[t]?n[t]+", "+i:i)}),n},Mv=Symbol("internals");function hf(e){return e&&String(e).trim().toLowerCase()}function jd(e){return e===!1||e==null?e:Xt.isArray(e)?e.map(jd):String(e)}function PP(e){const n=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=t.exec(e);)n[i[1]]=i[2];return n}const EP=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function R0(e,n,t,i,r){if(Xt.isFunction(i))return i.call(this,n,t);if(r&&(n=t),!!Xt.isString(n)){if(Xt.isString(i))return n.indexOf(i)!==-1;if(Xt.isRegExp(i))return i.test(n)}}function AP(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,t,i)=>t.toUpperCase()+i)}function kP(e,n){const t=Xt.toCamelCase(" "+n);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+t,{value:function(r,o,l){return this[i].call(this,n,r,o,l)},configurable:!0})})}let Ga=class{constructor(n){n&&this.set(n)}set(n,t,i){const r=this;function o(h,p,m){const _=hf(p);if(!_)throw new Error("header name must be a non-empty string");const w=Xt.findKey(r,_);(!w||r[w]===void 0||m===!0||m===void 0&&r[w]!==!1)&&(r[w||p]=jd(h))}const l=(h,p)=>Xt.forEach(h,(m,_)=>o(m,_,p));if(Xt.isPlainObject(n)||n instanceof this.constructor)l(n,t);else if(Xt.isString(n)&&(n=n.trim())&&!EP(n))l(SP(n),t);else if(Xt.isHeaders(n))for(const[h,p]of n.entries())o(p,h,i);else n!=null&&o(t,n,i);return this}get(n,t){if(n=hf(n),n){const i=Xt.findKey(this,n);if(i){const r=this[i];if(!t)return r;if(t===!0)return PP(r);if(Xt.isFunction(t))return t.call(this,r,i);if(Xt.isRegExp(t))return t.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,t){if(n=hf(n),n){const i=Xt.findKey(this,n);return!!(i&&this[i]!==void 0&&(!t||R0(this,this[i],i,t)))}return!1}delete(n,t){const i=this;let r=!1;function o(l){if(l=hf(l),l){const h=Xt.findKey(i,l);h&&(!t||R0(i,i[h],h,t))&&(delete i[h],r=!0)}}return Xt.isArray(n)?n.forEach(o):o(n),r}clear(n){const t=Object.keys(this);let i=t.length,r=!1;for(;i--;){const o=t[i];(!n||R0(this,this[o],o,n,!0))&&(delete this[o],r=!0)}return r}normalize(n){const t=this,i={};return Xt.forEach(this,(r,o)=>{const l=Xt.findKey(i,o);if(l){t[l]=jd(r),delete t[o];return}const h=n?AP(o):String(o).trim();h!==o&&delete t[o],t[h]=jd(r),i[h]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const t=Object.create(null);return Xt.forEach(this,(i,r)=>{i!=null&&i!==!1&&(t[r]=n&&Xt.isArray(i)?i.join(", "):i)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,t])=>n+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...t){const i=new this(n);return t.forEach(r=>i.set(r)),i}static accessor(n){const i=(this[Mv]=this[Mv]={accessors:{}}).accessors,r=this.prototype;function o(l){const h=hf(l);i[h]||(kP(r,l),i[h]=!0)}return Xt.isArray(n)?n.forEach(o):o(n),this}};Ga.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Xt.reduceDescriptors(Ga.prototype,({value:e},n)=>{let t=n[0].toUpperCase()+n.slice(1);return{get:()=>e,set(i){this[t]=i}}});Xt.freezeMethods(Ga);function O0(e,n){const t=this||Xf,i=n||t,r=Ga.from(i.headers);let o=i.data;return Xt.forEach(e,function(h){o=h.call(t,o,r.normalize(),n?n.status:void 0)}),r.normalize(),o}function k2(e){return!!(e&&e.__CANCEL__)}function Xh(e,n,t){Hi.call(this,e??"canceled",Hi.ERR_CANCELED,n,t),this.name="CanceledError"}Xt.inherits(Xh,Hi,{__CANCEL__:!0});function M2(e,n,t){const i=t.config.validateStatus;!t.status||!i||i(t.status)?e(t):n(new Hi("Request failed with status code "+t.status,[Hi.ERR_BAD_REQUEST,Hi.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function MP(e){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}function TP(e,n){e=e||10;const t=new Array(e),i=new Array(e);let r=0,o=0,l;return n=n!==void 0?n:1e3,function(p){const m=Date.now(),_=i[o];l||(l=m),t[r]=p,i[r]=m;let w=o,E=0;for(;w!==r;)E+=t[w++],w=w%e;if(r=(r+1)%e,r===o&&(o=(o+1)%e),m-l<n)return;const b=_&&m-_;return b?Math.round(E*1e3/b):void 0}}function BP(e,n){let t=0,i=1e3/n,r,o;const l=(m,_=Date.now())=>{t=_,r=null,o&&(clearTimeout(o),o=null),e.apply(null,m)};return[(...m)=>{const _=Date.now(),w=_-t;w>=i?l(m,_):(r=m,o||(o=setTimeout(()=>{o=null,l(r)},i-w)))},()=>r&&l(r)]}const ap=(e,n,t=3)=>{let i=0;const r=TP(50,250);return BP(o=>{const l=o.loaded,h=o.lengthComputable?o.total:void 0,p=l-i,m=r(p),_=l<=h;i=l;const w={loaded:l,total:h,progress:h?l/h:void 0,bytes:p,rate:m||void 0,estimated:m&&h&&_?(h-l)/m:void 0,event:o,lengthComputable:h!=null,[n?"download":"upload"]:!0};e(w)},t)},Tv=(e,n)=>{const t=e!=null;return[i=>n[0]({lengthComputable:t,total:e,loaded:i}),n[1]]},Bv=e=>(...n)=>Xt.asap(()=>e(...n)),NP=la.hasStandardBrowserEnv?((e,n)=>t=>(t=new URL(t,la.origin),e.protocol===t.protocol&&e.host===t.host&&(n||e.port===t.port)))(new URL(la.origin),la.navigator&&/(msie|trident)/i.test(la.navigator.userAgent)):()=>!0,DP=la.hasStandardBrowserEnv?{write(e,n,t,i,r,o){const l=[e+"="+encodeURIComponent(n)];Xt.isNumber(t)&&l.push("expires="+new Date(t).toGMTString()),Xt.isString(i)&&l.push("path="+i),Xt.isString(r)&&l.push("domain="+r),o===!0&&l.push("secure"),document.cookie=l.join("; ")},read(e){const n=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function RP(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function OP(e,n){return n?e.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):e}function T2(e,n,t){let i=!RP(n);return e&&(i||t==!1)?OP(e,n):n}const Nv=e=>e instanceof Ga?{...e}:e;function uh(e,n){n=n||{};const t={};function i(m,_,w,E){return Xt.isPlainObject(m)&&Xt.isPlainObject(_)?Xt.merge.call({caseless:E},m,_):Xt.isPlainObject(_)?Xt.merge({},_):Xt.isArray(_)?_.slice():_}function r(m,_,w,E){if(Xt.isUndefined(_)){if(!Xt.isUndefined(m))return i(void 0,m,w,E)}else return i(m,_,w,E)}function o(m,_){if(!Xt.isUndefined(_))return i(void 0,_)}function l(m,_){if(Xt.isUndefined(_)){if(!Xt.isUndefined(m))return i(void 0,m)}else return i(void 0,_)}function h(m,_,w){if(w in n)return i(m,_);if(w in e)return i(void 0,m)}const p={url:o,method:o,data:o,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:h,headers:(m,_,w)=>r(Nv(m),Nv(_),w,!0)};return Xt.forEach(Object.keys(Object.assign({},e,n)),function(_){const w=p[_]||r,E=w(e[_],n[_],_);Xt.isUndefined(E)&&w!==h||(t[_]=E)}),t}const B2=e=>{const n=uh({},e);let{data:t,withXSRFToken:i,xsrfHeaderName:r,xsrfCookieName:o,headers:l,auth:h}=n;n.headers=l=Ga.from(l),n.url=P2(T2(n.baseURL,n.url,n.allowAbsoluteUrls),e.params,e.paramsSerializer),h&&l.set("Authorization","Basic "+btoa((h.username||"")+":"+(h.password?unescape(encodeURIComponent(h.password)):"")));let p;if(Xt.isFormData(t)){if(la.hasStandardBrowserEnv||la.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if((p=l.getContentType())!==!1){const[m,..._]=p?p.split(";").map(w=>w.trim()).filter(Boolean):[];l.setContentType([m||"multipart/form-data",..._].join("; "))}}if(la.hasStandardBrowserEnv&&(i&&Xt.isFunction(i)&&(i=i(n)),i||i!==!1&&NP(n.url))){const m=r&&o&&DP.read(o);m&&l.set(r,m)}return n},IP=typeof XMLHttpRequest<"u",FP=IP&&function(e){return new Promise(function(t,i){const r=B2(e);let o=r.data;const l=Ga.from(r.headers).normalize();let{responseType:h,onUploadProgress:p,onDownloadProgress:m}=r,_,w,E,b,D;function j(){b&&b(),D&&D(),r.cancelToken&&r.cancelToken.unsubscribe(_),r.signal&&r.signal.removeEventListener("abort",_)}let Q=new XMLHttpRequest;Q.open(r.method.toUpperCase(),r.url,!0),Q.timeout=r.timeout;function F(){if(!Q)return;const pe=Ga.from("getAllResponseHeaders"in Q&&Q.getAllResponseHeaders()),Ie={data:!h||h==="text"||h==="json"?Q.responseText:Q.response,status:Q.status,statusText:Q.statusText,headers:pe,config:e,request:Q};M2(function(We){t(We),j()},function(We){i(We),j()},Ie),Q=null}"onloadend"in Q?Q.onloadend=F:Q.onreadystatechange=function(){!Q||Q.readyState!==4||Q.status===0&&!(Q.responseURL&&Q.responseURL.indexOf("file:")===0)||setTimeout(F)},Q.onabort=function(){Q&&(i(new Hi("Request aborted",Hi.ECONNABORTED,e,Q)),Q=null)},Q.onerror=function(){i(new Hi("Network Error",Hi.ERR_NETWORK,e,Q)),Q=null},Q.ontimeout=function(){let Ee=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const Ie=r.transitional||E2;r.timeoutErrorMessage&&(Ee=r.timeoutErrorMessage),i(new Hi(Ee,Ie.clarifyTimeoutError?Hi.ETIMEDOUT:Hi.ECONNABORTED,e,Q)),Q=null},o===void 0&&l.setContentType(null),"setRequestHeader"in Q&&Xt.forEach(l.toJSON(),function(Ee,Ie){Q.setRequestHeader(Ie,Ee)}),Xt.isUndefined(r.withCredentials)||(Q.withCredentials=!!r.withCredentials),h&&h!=="json"&&(Q.responseType=r.responseType),m&&([E,D]=ap(m,!0),Q.addEventListener("progress",E)),p&&Q.upload&&([w,b]=ap(p),Q.upload.addEventListener("progress",w),Q.upload.addEventListener("loadend",b)),(r.cancelToken||r.signal)&&(_=pe=>{Q&&(i(!pe||pe.type?new Xh(null,e,Q):pe),Q.abort(),Q=null)},r.cancelToken&&r.cancelToken.subscribe(_),r.signal&&(r.signal.aborted?_():r.signal.addEventListener("abort",_)));const V=MP(r.url);if(V&&la.protocols.indexOf(V)===-1){i(new Hi("Unsupported protocol "+V+":",Hi.ERR_BAD_REQUEST,e));return}Q.send(o||null)})},zP=(e,n)=>{const{length:t}=e=e?e.filter(Boolean):[];if(n||t){let i=new AbortController,r;const o=function(m){if(!r){r=!0,h();const _=m instanceof Error?m:this.reason;i.abort(_ instanceof Hi?_:new Xh(_ instanceof Error?_.message:_))}};let l=n&&setTimeout(()=>{l=null,o(new Hi(`timeout ${n} of ms exceeded`,Hi.ETIMEDOUT))},n);const h=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(m=>{m.unsubscribe?m.unsubscribe(o):m.removeEventListener("abort",o)}),e=null)};e.forEach(m=>m.addEventListener("abort",o));const{signal:p}=i;return p.unsubscribe=()=>Xt.asap(h),p}},jP=function*(e,n){let t=e.byteLength;if(t<n){yield e;return}let i=0,r;for(;i<t;)r=i+n,yield e.slice(i,r),i=r},UP=async function*(e,n){for await(const t of $P(e))yield*jP(t,n)},$P=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const n=e.getReader();try{for(;;){const{done:t,value:i}=await n.read();if(t)break;yield i}}finally{await n.cancel()}},Dv=(e,n,t,i)=>{const r=UP(e,n);let o=0,l,h=p=>{l||(l=!0,i&&i(p))};return new ReadableStream({async pull(p){try{const{done:m,value:_}=await r.next();if(m){h(),p.close();return}let w=_.byteLength;if(t){let E=o+=w;t(E)}p.enqueue(new Uint8Array(_))}catch(m){throw h(m),m}},cancel(p){return h(p),r.return()}},{highWaterMark:2})},zp=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",N2=zp&&typeof ReadableStream=="function",qP=zp&&(typeof TextEncoder=="function"?(e=>n=>e.encode(n))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),D2=(e,...n)=>{try{return!!e(...n)}catch{return!1}},GP=N2&&D2(()=>{let e=!1;const n=new Request(la.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!n}),Rv=64*1024,_g=N2&&D2(()=>Xt.isReadableStream(new Response("").body)),lp={stream:_g&&(e=>e.body)};zp&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(n=>{!lp[n]&&(lp[n]=Xt.isFunction(e[n])?t=>t[n]():(t,i)=>{throw new Hi(`Response type '${n}' is not supported`,Hi.ERR_NOT_SUPPORT,i)})})})(new Response);const VP=async e=>{if(e==null)return 0;if(Xt.isBlob(e))return e.size;if(Xt.isSpecCompliantForm(e))return(await new Request(la.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(Xt.isArrayBufferView(e)||Xt.isArrayBuffer(e))return e.byteLength;if(Xt.isURLSearchParams(e)&&(e=e+""),Xt.isString(e))return(await qP(e)).byteLength},HP=async(e,n)=>{const t=Xt.toFiniteNumber(e.getContentLength());return t??VP(n)},WP=zp&&(async e=>{let{url:n,method:t,data:i,signal:r,cancelToken:o,timeout:l,onDownloadProgress:h,onUploadProgress:p,responseType:m,headers:_,withCredentials:w="same-origin",fetchOptions:E}=B2(e);m=m?(m+"").toLowerCase():"text";let b=zP([r,o&&o.toAbortSignal()],l),D;const j=b&&b.unsubscribe&&(()=>{b.unsubscribe()});let Q;try{if(p&&GP&&t!=="get"&&t!=="head"&&(Q=await HP(_,i))!==0){let Ie=new Request(n,{method:"POST",body:i,duplex:"half"}),nt;if(Xt.isFormData(i)&&(nt=Ie.headers.get("content-type"))&&_.setContentType(nt),Ie.body){const[We,O]=Tv(Q,ap(Bv(p)));i=Dv(Ie.body,Rv,We,O)}}Xt.isString(w)||(w=w?"include":"omit");const F="credentials"in Request.prototype;D=new Request(n,{...E,signal:b,method:t.toUpperCase(),headers:_.normalize().toJSON(),body:i,duplex:"half",credentials:F?w:void 0});let V=await fetch(D);const pe=_g&&(m==="stream"||m==="response");if(_g&&(h||pe&&j)){const Ie={};["status","statusText","headers"].forEach(H=>{Ie[H]=V[H]});const nt=Xt.toFiniteNumber(V.headers.get("content-length")),[We,O]=h&&Tv(nt,ap(Bv(h),!0))||[];V=new Response(Dv(V.body,Rv,We,()=>{O&&O(),j&&j()}),Ie)}m=m||"text";let Ee=await lp[Xt.findKey(lp,m)||"text"](V,e);return!pe&&j&&j(),await new Promise((Ie,nt)=>{M2(Ie,nt,{data:Ee,headers:Ga.from(V.headers),status:V.status,statusText:V.statusText,config:e,request:D})})}catch(F){throw j&&j(),F&&F.name==="TypeError"&&/fetch/i.test(F.message)?Object.assign(new Hi("Network Error",Hi.ERR_NETWORK,e,D),{cause:F.cause||F}):Hi.from(F,F&&F.code,e,D)}}),bg={http:lP,xhr:FP,fetch:WP};Xt.forEach(bg,(e,n)=>{if(e){try{Object.defineProperty(e,"name",{value:n})}catch{}Object.defineProperty(e,"adapterName",{value:n})}});const Ov=e=>`- ${e}`,ZP=e=>Xt.isFunction(e)||e===null||e===!1,R2={getAdapter:e=>{e=Xt.isArray(e)?e:[e];const{length:n}=e;let t,i;const r={};for(let o=0;o<n;o++){t=e[o];let l;if(i=t,!ZP(t)&&(i=bg[(l=String(t)).toLowerCase()],i===void 0))throw new Hi(`Unknown adapter '${l}'`);if(i)break;r[l||"#"+o]=i}if(!i){const o=Object.entries(r).map(([h,p])=>`adapter ${h} `+(p===!1?"is not supported by the environment":"is not available in the build"));let l=n?o.length>1?`since :
`+o.map(Ov).join(`
`):" "+Ov(o[0]):"as no adapter specified";throw new Hi("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return i},adapters:bg};function I0(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Xh(null,e)}function Iv(e){return I0(e),e.headers=Ga.from(e.headers),e.data=O0.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),R2.getAdapter(e.adapter||Xf.adapter)(e).then(function(i){return I0(e),i.data=O0.call(e,e.transformResponse,i),i.headers=Ga.from(i.headers),i},function(i){return k2(i)||(I0(e),i&&i.response&&(i.response.data=O0.call(e,e.transformResponse,i.response),i.response.headers=Ga.from(i.response.headers))),Promise.reject(i)})}const O2="1.8.4",jp={};["object","boolean","number","function","string","symbol"].forEach((e,n)=>{jp[e]=function(i){return typeof i===e||"a"+(n<1?"n ":" ")+e}});const Fv={};jp.transitional=function(n,t,i){function r(o,l){return"[Axios v"+O2+"] Transitional option '"+o+"'"+l+(i?". "+i:"")}return(o,l,h)=>{if(n===!1)throw new Hi(r(l," has been removed"+(t?" in "+t:"")),Hi.ERR_DEPRECATED);return t&&!Fv[l]&&(Fv[l]=!0,console.warn(r(l," has been deprecated since v"+t+" and will be removed in the near future"))),n?n(o,l,h):!0}};jp.spelling=function(n){return(t,i)=>(console.warn(`${i} is likely a misspelling of ${n}`),!0)};function KP(e,n,t){if(typeof e!="object")throw new Hi("options must be an object",Hi.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let r=i.length;for(;r-- >0;){const o=i[r],l=n[o];if(l){const h=e[o],p=h===void 0||l(h,o,e);if(p!==!0)throw new Hi("option "+o+" must be "+p,Hi.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Hi("Unknown option "+o,Hi.ERR_BAD_OPTION)}}const Ud={assertOptions:KP,validators:jp},mu=Ud.validators;let sh=class{constructor(n){this.defaults=n,this.interceptors={request:new kv,response:new kv}}async request(n,t){try{return await this._request(n,t)}catch(i){if(i instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const o=r.stack?r.stack.replace(/^.+\n/,""):"";try{i.stack?o&&!String(i.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+o):i.stack=o}catch{}}throw i}}_request(n,t){typeof n=="string"?(t=t||{},t.url=n):t=n||{},t=uh(this.defaults,t);const{transitional:i,paramsSerializer:r,headers:o}=t;i!==void 0&&Ud.assertOptions(i,{silentJSONParsing:mu.transitional(mu.boolean),forcedJSONParsing:mu.transitional(mu.boolean),clarifyTimeoutError:mu.transitional(mu.boolean)},!1),r!=null&&(Xt.isFunction(r)?t.paramsSerializer={serialize:r}:Ud.assertOptions(r,{encode:mu.function,serialize:mu.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Ud.assertOptions(t,{baseUrl:mu.spelling("baseURL"),withXsrfToken:mu.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let l=o&&Xt.merge(o.common,o[t.method]);o&&Xt.forEach(["delete","get","head","post","put","patch","common"],D=>{delete o[D]}),t.headers=Ga.concat(l,o);const h=[];let p=!0;this.interceptors.request.forEach(function(j){typeof j.runWhen=="function"&&j.runWhen(t)===!1||(p=p&&j.synchronous,h.unshift(j.fulfilled,j.rejected))});const m=[];this.interceptors.response.forEach(function(j){m.push(j.fulfilled,j.rejected)});let _,w=0,E;if(!p){const D=[Iv.bind(this),void 0];for(D.unshift.apply(D,h),D.push.apply(D,m),E=D.length,_=Promise.resolve(t);w<E;)_=_.then(D[w++],D[w++]);return _}E=h.length;let b=t;for(w=0;w<E;){const D=h[w++],j=h[w++];try{b=D(b)}catch(Q){j.call(this,Q);break}}try{_=Iv.call(this,b)}catch(D){return Promise.reject(D)}for(w=0,E=m.length;w<E;)_=_.then(m[w++],m[w++]);return _}getUri(n){n=uh(this.defaults,n);const t=T2(n.baseURL,n.url,n.allowAbsoluteUrls);return P2(t,n.params,n.paramsSerializer)}};Xt.forEach(["delete","get","head","options"],function(n){sh.prototype[n]=function(t,i){return this.request(uh(i||{},{method:n,url:t,data:(i||{}).data}))}});Xt.forEach(["post","put","patch"],function(n){function t(i){return function(o,l,h){return this.request(uh(h||{},{method:n,headers:i?{"Content-Type":"multipart/form-data"}:{},url:o,data:l}))}}sh.prototype[n]=t(),sh.prototype[n+"Form"]=t(!0)});let JP=class I2{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(o){t=o});const i=this;this.promise.then(r=>{if(!i._listeners)return;let o=i._listeners.length;for(;o-- >0;)i._listeners[o](r);i._listeners=null}),this.promise.then=r=>{let o;const l=new Promise(h=>{i.subscribe(h),o=h}).then(r);return l.cancel=function(){i.unsubscribe(o)},l},n(function(o,l,h){i.reason||(i.reason=new Xh(o,l,h),t(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const t=this._listeners.indexOf(n);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const n=new AbortController,t=i=>{n.abort(i)};return this.subscribe(t),n.signal.unsubscribe=()=>this.unsubscribe(t),n.signal}static source(){let n;return{token:new I2(function(r){n=r}),cancel:n}}};function YP(e){return function(t){return e.apply(null,t)}}function XP(e){return Xt.isObject(e)&&e.isAxiosError===!0}const wg={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(wg).forEach(([e,n])=>{wg[n]=e});function F2(e){const n=new sh(e),t=g2(sh.prototype.request,n);return Xt.extend(t,sh.prototype,n,{allOwnKeys:!0}),Xt.extend(t,n,null,{allOwnKeys:!0}),t.create=function(r){return F2(uh(e,r))},t}const eo=F2(Xf);eo.Axios=sh;eo.CanceledError=Xh;eo.CancelToken=JP;eo.isCancel=k2;eo.VERSION=O2;eo.toFormData=Fp;eo.AxiosError=Hi;eo.Cancel=eo.CanceledError;eo.all=function(n){return Promise.all(n)};eo.spread=YP;eo.isAxiosError=XP;eo.mergeConfig=uh;eo.AxiosHeaders=Ga;eo.formToJSON=e=>A2(Xt.isHTMLForm(e)?new FormData(e):e);eo.getAdapter=R2.getAdapter;eo.HttpStatusCode=wg;eo.default=eo;const{Axios:QI,AxiosError:eF,CanceledError:tF,isCancel:nF,CancelToken:iF,VERSION:rF,all:sF,Cancel:oF,isAxiosError:aF,spread:lF,toFormData:uF,AxiosHeaders:cF,HttpStatusCode:hF,formToJSON:fF,getAdapter:dF,mergeConfig:pF}=eo,pn=ku({measures:[],longTasks:[],memorySnapshots:[],framesPerSecond:0,lastFpsUpdate:0,frameCount:0,isRecording:!1,isEnabled:!1,startTime:0,currentOperation:null,operationStack:[],operationHistory:[]});let Sc=null,th=null;const QP=1e3;function Up(){if(pn.isEnabled){pn.isRecording=!0,pn.startTime=performance.now(),pn.frameCount=0,pn.lastFpsUpdate=performance.now();try{window.PerformanceObserver&&PerformanceObserver.supportedEntryTypes.includes("longtask")&&(Sc=new PerformanceObserver(e=>{e.getEntries().forEach(t=>{pn.longTasks.push({duration:t.duration,startTime:t.startTime,name:t.name,component:tu()})})}),Sc.observe({entryTypes:["longtask"]}))}catch(e){console.warn("PerformanceObserver pour longues tâches non supporté",e)}eE(),vm()}}function up(){pn.isRecording=!1,Sc&&(Sc.disconnect(),Sc=null),$2()}function xg(){Sc&&(Sc.disconnect(),Sc=null),$2(),pn.measures=[],pn.longTasks=[],pn.memorySnapshots=[],pn.operationHistory=[],pn.frameCount=0,pn.framesPerSecond=0,pn.lastFpsUpdate=0,pn.isEnabled&&Up()}function z2(e,n,t){if(!pn.isEnabled||!pn.isRecording)return()=>{};const i=performance.now(),r=pn.currentOperation;return pn.currentOperation=e,pn.operationStack.push(e),()=>{const o=performance.now()-i;pn.operationStack.pop(),pn.currentOperation=pn.operationStack[pn.operationStack.length-1]||null,pn.measures.push({name:e,startTime:i,duration:o,component:n||tu(),info:t,parentOperation:r||void 0}),o>10&&pn.operationHistory.push({operation:e,component:n||tu()||"unknown",durationMs:o,timestamp:Date.now()})}}async function j2(e,n,t,i){if(!pn.isEnabled||!pn.isRecording)return n();const r=performance.now(),o=pn.currentOperation;pn.currentOperation=e,pn.operationStack.push(e);try{return await n()}finally{const l=performance.now()-r;pn.operationStack.pop(),pn.currentOperation=pn.operationStack[pn.operationStack.length-1]||null,pn.measures.push({name:e,startTime:r,duration:l,component:t||tu(),info:i,parentOperation:o||void 0}),l>10&&pn.operationHistory.push({operation:e,component:t||tu()||"unknown",durationMs:l,timestamp:Date.now()})}}function U2(e,n,t,i){if(!pn.isEnabled||!pn.isRecording)return n();const r=performance.now(),o=pn.currentOperation;pn.currentOperation=e,pn.operationStack.push(e);try{return n()}finally{const l=performance.now()-r;pn.operationStack.pop(),pn.currentOperation=pn.operationStack[pn.operationStack.length-1]||null,pn.measures.push({name:e,startTime:r,duration:l,component:t||tu(),info:i,parentOperation:o||void 0}),l>10&&pn.operationHistory.push({operation:e,component:t||tu()||"unknown",durationMs:l,timestamp:Date.now()})}}function vm(){!pn.isEnabled||!pn.isRecording||(performance.memory?pn.memorySnapshots.push({jsHeapSizeLimit:performance.memory.jsHeapSizeLimit,totalJSHeapSize:performance.memory.totalJSHeapSize,usedJSHeapSize:performance.memory.usedJSHeapSize,timestamp:performance.now()}):pn.memorySnapshots.push({timestamp:performance.now()}))}function eE(){th!==null&&cancelAnimationFrame(th),pn.frameCount=0,pn.lastFpsUpdate=performance.now();function e(){pn.frameCount++;const n=performance.now();n-pn.lastFpsUpdate>=QP&&(pn.framesPerSecond=Math.round(pn.frameCount*1e3/(n-pn.lastFpsUpdate)),pn.frameCount=0,pn.lastFpsUpdate=n),pn.isRecording&&(th=requestAnimationFrame(e))}th=requestAnimationFrame(e)}function $2(){th!==null&&(cancelAnimationFrame(th),th=null)}function tu(){return""}function Lg(e){pn.isEnabled=e,e&&!pn.isRecording?Up():!e&&pn.isRecording&&up()}function q2(e,n,t){return(...i)=>{if(!pn.isEnabled||!pn.isRecording)return e(...i);const r=performance.now();try{return e(...i)}finally{const o=performance.now()-r;pn.measures.push({name:n,startTime:r,duration:o,component:t||tu(),info:{args:i}}),o>10&&pn.operationHistory.push({operation:n,component:t||tu()||"unknown",durationMs:o,timestamp:Date.now()})}}}function G2(e,n,t){return async(...i)=>{if(!pn.isEnabled||!pn.isRecording)return await e(...i);const r=performance.now();try{return await e(...i)}finally{const o=performance.now()-r;pn.measures.push({name:n,startTime:r,duration:o,component:t||tu(),info:{args:i}}),o>10&&pn.operationHistory.push({operation:n,component:t||tu()||"unknown",durationMs:o,timestamp:Date.now()})}}}function tE(e,n){const t=pn.measures.filter(l=>l.startTime>=e&&l.startTime+l.duration<=n),i=new Map,r=[];t.forEach(l=>{l.parentOperation?(i.has(l.parentOperation)||i.set(l.parentOperation,[]),i.get(l.parentOperation).push(l)):r.push(l)});function o(l){const h=i.get(l.name)||[];return{operation:l.name,duration:l.duration,component:l.component,children:h.sort((p,m)=>m.duration-p.duration).map(p=>o(p))}}return r.sort((l,h)=>h.duration-l.duration).map(l=>o(l))}function Cg(e,n){const t=e||pn.startTime,i=n||performance.now(),r=tE(t,i),o=i-t,l=new Map;function h(m){const _=l.get(m.operation)||{duration:0,component:m.component};_.duration+=m.duration,l.set(m.operation,_),m.children.forEach(w=>h(w))}r.forEach(m=>h(m));const p=Array.from(l.entries()).map(([m,{duration:_,component:w}])=>({operation:m,duration:_,component:w,impact:_/o*100})).sort((m,_)=>_.impact-m.impact).slice(0,10);return{criticalPaths:r,totalTime:o,bottlenecks:p}}function hh(){const e=Yt(!1);Ha(()=>{try{const i=new URL(window.location.href).searchParams.get("perf")==="true";e.value=i,Lg(i),xg()}catch(t){console.warn("Erreur lors de la vérification du paramètre perf:",t),e.value=!1,Lg(!1)}}),Qu(()=>{pn.isRecording&&up()});const n=(t,i)=>{if(!pn.isEnabled||!pn.isRecording)return null;const r=pn.measures.find(m=>m.name===t&&m.startTime===i);if(!r)return null;const o=r.startTime+r.duration,l=pn.measures.filter(m=>m.startTime>=r.startTime&&m.startTime<=o&&m!==r),h=pn.longTasks.filter(m=>m.startTime>=r.startTime&&m.startTime<=o),p=pn.memorySnapshots.filter(m=>m.timestamp>=r.startTime&&m.timestamp<=o);return{operation:{name:r.name,component:r.component,startTime:r.startTime,duration:r.duration,info:r.info},context:{relatedOperations:l.map(m=>({name:m.name,component:m.component,startTime:m.startTime-r.startTime,duration:m.duration,info:m.info})),longTasks:h.map(m=>({duration:m.duration,startTime:m.startTime-r.startTime,name:m.name,component:m.component})),memorySnapshots:p.map(m=>({...m,timestamp:m.timestamp-r.startTime}))},summary:{totalRelatedOperations:l.length,totalLongTasks:h.length,maxLongTaskDuration:Math.max(...h.map(m=>m.duration),0),memoryDelta:p.length>1?(p[p.length-1].usedJSHeapSize||0)-(p[0].usedJSHeapSize||0):0}}};return{isEnabled:_u(Yt(pn.isEnabled)),isQueryParamEnabled:_u(e),isRecording:_u(Yt(pn.isRecording)),measures:_u(Yt(pn.measures)),longTasks:_u(Yt(pn.longTasks)),memorySnapshots:_u(Yt(pn.memorySnapshots)),framesPerSecond:_u(Yt(pn.framesPerSecond)),operationHistory:_u(Yt(pn.operationHistory)),startRecording:Up,stopRecording:up,clearRecording:xg,startMeasure:z2,measure:U2,measureAsync:j2,captureMemorySnapshot:vm,createPerformanceTracker:q2,createAsyncPerformanceTracker:G2,getOperationDetails:n,getSlowOperations:()=>!pn.isEnabled||!pn.isRecording?[]:[...pn.measures].sort((t,i)=>i.duration-t.duration).slice(0,10),getLongTasks:()=>!pn.isEnabled||!pn.isRecording?[]:[...pn.longTasks].sort((t,i)=>i.duration-t.duration),getPerformanceReport:()=>{if(!pn.isEnabled||!pn.isRecording)return null;const t=Cg();return{totalMeasures:pn.measures.length,totalLongTasks:pn.longTasks.length,slowestOperations:[...pn.measures].sort((i,r)=>r.duration-i.duration).slice(0,10),averageFps:pn.framesPerSecond,memoryUsage:pn.memorySnapshots.length>0?pn.memorySnapshots[pn.memorySnapshots.length-1]:null,operationsByComponent:nE(pn.measures),criticalPaths:t.criticalPaths,bottlenecks:t.bottlenecks,recordingDuration:pn.isRecording?performance.now()-pn.startTime:null}},analyzeCriticalPaths:Cg}}function nE(e){if(!pn.isEnabled||!pn.isRecording)return{};const n={};return e.forEach(t=>{const i=t.component||"unknown";n[i]||(n[i]={totalTime:0,callCount:0,operations:{}}),n[i].totalTime+=t.duration,n[i].callCount++,n[i].operations[t.name]||(n[i].operations[t.name]={totalTime:0,callCount:0}),n[i].operations[t.name].totalTime+=t.duration,n[i].operations[t.name].callCount++}),n}const At={startRecording:Up,stopRecording:up,clearRecording:xg,startMeasure:z2,measure:U2,measureAsync:j2,captureMemorySnapshot:vm,createPerformanceTracker:q2,createAsyncPerformanceTracker:G2,setEnabled:Lg,analyzeCriticalPaths:Cg},ii=eo.create({baseURL:"/api",headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0}),oo=hh();function V2(e){var i;const t=`; ${document.cookie}`.split(`; ${e}=`);return t.length===2&&((i=t.pop())==null?void 0:i.split(";").shift())||null}ii.interceptors.request.use(async e=>{const n=oo.startMeasure("api_request_interceptor","ApiService");try{const t=V2("access_token");return t&&(e.headers.Authorization=`Bearer ${t}`),console.log("Request config:",{url:e.url,method:e.method,headers:e.headers,withCredentials:e.withCredentials}),e}finally{n()}},e=>(console.error("Request interceptor error:",e),Promise.reject(e)));ii.interceptors.response.use(e=>e,async e=>{var i;const n=oo.startMeasure("api_response_interceptor","ApiService"),t=e.config;try{if(((i=e.response)==null?void 0:i.status)===401&&!t._retry){t._retry=!0;const r=Va();await oo.measureAsync("token_refresh",()=>r.refreshToken(),"ApiService");const o=V2("access_token");if(o)return t.headers.Authorization=`Bearer ${o}`,ii(t)}return Promise.reject(e)}catch(r){return console.error("Token refresh failed:",r),window.location.href="/login",Promise.reject(r)}finally{n()}});function iE(e){var t;const n=[];if((t=e.response)!=null&&t.data){const i=e.response.data;typeof i=="object"&&!Array.isArray(i)?Object.entries(i).forEach(([r,o])=>{Array.isArray(o)?o.forEach(l=>{n.push({field:r,message:l})}):typeof o=="string"&&n.push({field:r,message:o})}):typeof i=="string"?n.push({field:"non_field_error",message:i}):i.detail&&n.push({field:"non_field_error",message:i.detail})}else e.message&&n.push({field:"non_field_error",message:`Erreur de connexion: ${e.message}`});return n.length===0&&n.push({field:"non_field_error",message:"Une erreur inconnue s'est produite"}),n}async function $d(e){console.log("[fetchUsersByHierarchy] Récupération des utilisateurs:",e);const n={role:e.role};e.usineId&&(n.usine=e.usineId),e.concessionnaireId&&(n.concessionnaire=e.concessionnaireId),e.includeDetails&&(n.include_plans=!0),e.search&&(n.search=e.search),console.log("[fetchUsersByHierarchy] Filtres appliqués:",n);try{const t=await $a.getUsers(n);return console.log(`[fetchUsersByHierarchy] Résultat (${t.data.length} utilisateurs):`,t.data),t.data}catch(t){throw console.error("[fetchUsersByHierarchy] Erreur lors de la récupération des utilisateurs:",t),t}}const $a={async getUsers(e={}){const n=oo.startMeasure("get_users","UserService");try{return await oo.measureAsync("get_users_request",()=>ii.get("/users/",{params:e}),"UserService")}finally{n()}},async getUser(e){return await ii.get(`/users/${e}/`)},async createUser(e){return await ii.post("/users/",e)},async updateUser(e,n){return await ii.patch(`/users/${e}/`,n)},async deleteUser(e){return await ii.delete(`/users/${e}/`)},async getUsines(){return await ii.get("/users/",{params:{role:"USINE"}})},async getConcessionnaires(e){const n={role:"CONCESSIONNAIRE"};return e&&(n.usine=e),await ii.get("/users/",{params:n})},async getConcessionnaireAgriculteurs(e){return await ii.get("/users/",{params:{role:"AGRICULTEUR",concessionnaire:e}})},async getUsineAgriculteurs(e){return await ii.get("/users/",{params:{role:"AGRICULTEUR",usine:e}})},async getUsersByHierarchy(e){const n=oo.startMeasure("get_users_hierarchy","UserService");try{const t=oo.measure("prepare_hierarchy_filters",()=>{const i={role:e.role};return e.usineId&&(i.usine=e.usineId),e.concessionnaireId&&(i.concessionnaire=e.concessionnaireId),e.includeDetails&&(i.include_plans=!0),e.search&&(i.search=e.search),i},"UserService");return await oo.measureAsync("get_users_hierarchy_request",()=>ii.get("/users/",{params:t}),"UserService")}finally{n()}},async getUsineConcessionnaires(e){return await ii.get("/users/",{params:{role:"CONCESSIONNAIRE",usine:e}})},async getAgriculteurs(e,n){const t={role:"AGRICULTEUR"};return e&&(t.concessionnaire=e),n&&(t.usine=n),await ii.get("/users/",{params:t})},async assignUsineToConcessionnaire(e,n){return await ii.patch(`/users/${e}/`,{usine:n})},async assignConcessionnaireToAgriculteur(e,n){return await ii.patch(`/users/${e}/`,{concessionnaire:n})},formatLogoFileName(e){return oo.measure("format_logo_filename",()=>{var r;const n=new Date().getTime(),t=((r=e.name.split(".").pop())==null?void 0:r.toLowerCase())||"";return`${e.name.split(".")[0].toLowerCase().replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}-${n}.${t}`},"UserService")},async uploadLogo(e){const n=oo.startMeasure("upload_logo","UserService");try{const t=new FormData,i=this.formatLogoFileName(e),r=new File([e],i,{type:e.type});return t.append("logo",r),await oo.measureAsync("upload_logo_request",()=>ii.post("/users/upload_logo/",t,{headers:{"Content-Type":"multipart/form-data"}}),"UserService")}finally{n()}}},Pd={async getPlans(){const e=oo.startMeasure("get_plans","IrrigationService");try{return await oo.measureAsync("get_plans_request",()=>ii.get("/plans/"),"IrrigationService")}finally{e()}},async createPlan(e){const n=oo.startMeasure("create_plan","IrrigationService");try{const t=oo.measure("format_plan_data",()=>({...e,usine:e.usine?typeof e.usine=="object"&&"id"in e.usine?e.usine.id:Number(e.usine):null,concessionnaire:e.concessionnaire?typeof e.concessionnaire=="object"&&"id"in e.concessionnaire?e.concessionnaire.id:Number(e.concessionnaire):null,agriculteur:e.agriculteur?typeof e.agriculteur=="object"&&"id"in e.agriculteur?e.agriculteur.id:Number(e.agriculteur):null}),"IrrigationService");return await oo.measureAsync("create_plan_request",()=>ii.post("/plans/",t),"IrrigationService")}finally{n()}},async updatePlan(e,n){const t=oo.startMeasure("update_plan","IrrigationService");try{return await oo.measureAsync("update_plan_request",()=>ii.put(`/plans/${e}/`,n),"IrrigationService")}finally{t()}},async deletePlan(e){const n=oo.startMeasure("delete_plan","IrrigationService");try{return await oo.measureAsync("delete_plan_request",()=>ii.delete(`/plans/${e}/`),"IrrigationService")}finally{n()}},async getAgriculteurPlans(e){return await ii.get("/plans/",{params:{agriculteur:e}})},async createPlanForAgriculteur(e){return await ii.post("/plans/",e)},async getUsinePlans(e){return await ii.get("/plans/",{params:{usine:e}})},async getConcessionnairePlans(e){return await ii.get("/plans/",{params:{concessionnaire:e}})},async createPlanForConcessionnaire(e,n){const t={...e,concessionnaire:n};return await ii.post("/plans/",t)},async createPlanForUsine(e,n){const t={...e,usine:n};return await ii.post("/plans/",t)}};ii.defaults.baseURL="/api";ii.defaults.headers.common["Content-Type"]="application/json";ii.defaults.withCredentials=!0;function cp(e){var i;const t=`; ${document.cookie}`.split(`; ${e}=`);return t.length===2&&((i=t.pop())==null?void 0:i.split(";").shift())||null}ii.interceptors.request.use(e=>{const n=cp("access_token");return n&&(e.headers.Authorization=`Bearer ${n}`),e},e=>(console.error("Request interceptor error:",e),Promise.reject(e)));ii.interceptors.response.use(e=>e,async e=>{var i,r;const n=Va(),t=e.config;if(((i=e.response)==null?void 0:i.status)===401&&!t._retry&&!((r=t.url)!=null&&r.includes("/token/refresh/"))){t._retry=!0;try{if(!cp("access_token"))throw new Error("No token available");await n.refreshToken();const l=cp("access_token");if(l)return t.headers.Authorization=`Bearer ${l}`,ii(t)}catch(o){console.error("Token refresh failed:",o),await n.logout(),window.location.pathname!=="/login"&&(window.location.href="/login")}}return Promise.reject(e)});function rE(e,n,t=1){const i=new Date;i.setTime(i.getTime()+t*24*60*60*1e3);const r=`expires=${i.toUTCString()}`;document.cookie=`${e}=${n};${r};path=/;secure;samesite=Strict`}function ll(e){if(!e)return"-";const n=e.first_name||"",t=e.last_name?e.last_name.toUpperCase():"",i=`${n} ${t}`.trim(),r=e.company_name||e.role||"";return!i&&!r?"-":i?r?`${i} (${r})`:i:`(${r})`}function sE(e="",n=""){return`${(e==null?void 0:e.charAt(0))||""}${(n==null?void 0:n.charAt(0))||""}`.toUpperCase()}const oE={ADMIN:"Administrateur",USINE:"Usine",CONCESSIONNAIRE:"Concessionnaire",AGRICULTEUR:"Agriculteur"};function aE(e){return oE[e]||e}function lE(){return"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800"}function uE(e){return e?"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800":"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800"}async function cE({role:e,usineId:n,concessionnaireId:t,includeDetails:i=!1}){const r={role:e};return n&&(r.usine=n),t&&(r.concessionnaire=t),i&&(r.include_plans=!0),(await $a.getUsers(r)).data}const Va=Dp("auth",{state:()=>({user:null,isAuthenticated:!1,mustChangePassword:!1,initialized:!1,loading:!1,error:null,concessionnaires:[],usines:[],concessionnaires_list:[],agriculteurs:[]}),getters:{isAdmin:e=>{var n;return((n=e.user)==null?void 0:n.user_type)==="admin"},isUsine:e=>{var n;return((n=e.user)==null?void 0:n.user_type)==="usine"},isConcessionnaire:e=>{var n;return((n=e.user)==null?void 0:n.user_type)==="concessionnaire"},isAgriculteur:e=>{var n;return((n=e.user)==null?void 0:n.user_type)==="agriculteur"},currentUser:e=>e.user,hasConcessionnaire:e=>{var n;return!!((n=e.user)!=null&&n.concessionnaire)},hasUsine:e=>{var n;return!!((n=e.user)!=null&&n.usine)}},actions:{async initialize(e){if(!e){const t=await this.restoreSession();return this.initialized=!0,t}if(e.isAuthenticated&&e.user)return this.user=e.user,this.isAuthenticated=!0,this.mustChangePassword=e.user.must_change_password||!1,this.initialized=!0,!0;const n=await this.restoreSession();return this.initialized=!0,n},async restoreSession(){try{if(!cp("access_token"))return this.isAuthenticated=!1,this.user=null,!1;const n=await ii.post("/token/refresh/");return n.data.user?(this.user=n.data.user,this.isAuthenticated=!0,this.mustChangePassword=n.data.user.must_change_password||!1,!0):(await this.fetchUserProfile(),!0)}catch(e){return console.error("Failed to restore session:",e),this.isAuthenticated=!1,this.user=null,!1}},async login(e,n){var t,i,r;try{const o=await ii.post("/token/",{username:e,password:n});if(!o.data.access)throw new Error("Token d'accès non reçu");document.cookie=`access_token=${o.data.access}; path=/; secure; samesite=Strict`;const l=await this.fetchUserProfile();return this.user=l,this.isAuthenticated=!0,!0}catch(o){throw this.isAuthenticated=!1,this.user=null,((t=o.response)==null?void 0:t.status)===401?new Error("Identifiants incorrects"):(r=(i=o.response)==null?void 0:i.data)!=null&&r.detail?new Error(o.response.data.detail):o}},async logout(){this.user=null,this.isAuthenticated=!1,this.mustChangePassword=!1,document.cookie="access_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="refresh_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT"},async checkAuth(){try{return await this.fetchUserProfile(),!0}catch{return this.isAuthenticated=!1,this.user=null,!1}},async fetchUserProfile(){try{const e=await ii.get("/users/me/");return this.user=e.data,this.isAuthenticated=!0,this.mustChangePassword=e.data.must_change_password||!1,e.data}catch(e){throw this.isAuthenticated=!1,this.user=null,e}},async changePassword(e,n){try{const t=await ii.post("/users/change_password/",{old_password:e,password:n});return this.user={...this.user,must_change_password:!1},t.data}catch(t){throw console.error("Password change error:",t),t}},async refreshToken(){var e,n,t,i;try{const r=await ii.post("/token/refresh/",{},{withCredentials:!0}),{access:o}=r.data;if(!o)throw new Error("No access token received");return rE("access_token",o,1),this.isAuthenticated=!0,o}catch(r){throw console.error("Error refreshing token:",{status:(e=r.response)==null?void 0:e.status,data:(n=r.response)==null?void 0:n.data}),(((t=r.response)==null?void 0:t.status)===401||((i=r.response)==null?void 0:i.status)===403)&&await this.logout(),r}},async fetchUsers(e={}){this.loading=!0;try{return(await $a.getUsers(e)).data}catch(n){throw this.error="Erreur lors de la récupération des utilisateurs",n}finally{this.loading=!1}},async fetchUsines(){this.loading=!0;try{const e=await $a.getUsines();return this.usines=e.data,this.usines}catch(e){throw this.error="Erreur lors de la récupération des usines",e}finally{this.loading=!1}},async fetchUsineConcessionnaires(e){this.loading=!0;try{const n=await $a.getUsineConcessionnaires(e);return this.concessionnaires_list=n.data,this.concessionnaires_list}catch(n){throw this.error="Erreur lors de la récupération des concessionnaires de l'usine",n}finally{this.loading=!1}},async fetchConcessionnaireAgriculteurs(e){this.loading=!0;try{const n=await $a.getAgriculteurs(e);return this.agriculteurs=Array.isArray(n.data)?n.data:[n.data],this.agriculteurs}catch(n){throw this.error="Erreur lors de la récupération des agriculteurs",n}finally{this.loading=!1}},async fetchUsineAgriculteurs(e){this.loading=!0;try{const n=await $a.getAgriculteurs(void 0,e);return Array.isArray(n.data)?n.data:[n.data]}catch(n){throw this.error="Erreur lors de la récupération des agriculteurs de l'usine",n}finally{this.loading=!1}},async setUsineForConcessionnaire(e,n){this.loading=!0;try{return await $a.assignUsineToConcessionnaire(e,n)}catch(t){throw this.error="Erreur lors de l'assignation de l'usine au concessionnaire",t}finally{this.loading=!1}},async setConcessionnaireForAgriculteur(e,n){this.loading=!0;try{return await $a.assignConcessionnaireToAgriculteur(e,n)}catch(t){throw this.error="Erreur lors de l'assignation du concessionnaire à l'agriculteur",t}finally{this.loading=!1}},async createUser(e){this.loading=!0;try{return(await $a.createUser(e)).data}catch(n){throw this.error="Erreur lors de la création de l'utilisateur",n}finally{this.loading=!1}},async updateUser(e,n){this.loading=!0;try{return(await $a.updateUser(e,n)).data}catch(t){throw this.error="Erreur lors de la mise à jour de l'utilisateur",t}finally{this.loading=!1}},async deleteUser(e){this.loading=!0;try{return await $a.deleteUser(e),!0}catch(n){throw this.error="Erreur lors de la suppression de l'utilisateur",n}finally{this.loading=!1}},async fetchConcessionnairesLegacy(){this.loading=!0;try{const e=await ii.get("/users/",{params:{role:"concessionnaire"}});this.concessionnaires=e.data}catch(e){throw this.error="Erreur lors de la récupération des concessionnaires",e}finally{this.loading=!1}},async setConcessionnaire(e,n){this.loading=!0;try{await ii.patch(`/users/${e}/`,{concessionnaire:n}),this.user&&this.user.id===e&&(this.user.concessionnaire=n)}catch(t){throw this.error="Erreur lors de la mise à jour du concessionnaire",t}finally{this.loading=!1}},async updateUserRole(e,n){this.loading=!0;try{const t=await ii.patch(`/users/${e}/`,{role:n});return this.user&&this.user.id===e&&(this.user.user_type=n),t.data}catch(t){throw this.error="Erreur lors de la mise à jour du rôle",t}finally{this.loading=!1}},async updateUserEmail(e){var n;this.loading=!0;try{const t=await ii.patch(`/users/${(n=this.user)==null?void 0:n.id}/`,{email:e});return this.user&&(this.user.email=e),t.data}catch(t){throw this.error="Erreur lors de la mise à jour de l'email",t}finally{this.loading=!1}},async uploadLogo(e){this.loading=!0;try{const n=await $a.uploadLogo(e);return this.user&&n.data.logo&&(this.user.logo=n.data.logo),n.data}catch(n){throw this.error="Erreur lors du téléversement du logo",n}finally{this.loading=!1}},checkAccess(e){return this.user?e.includes(this.user.user_type):!1},async fetchUsersByRole(e){this.loading=!0;try{return await cE(e)}catch(n){throw console.error(`Error fetching ${e.role}:`,n),n}finally{this.loading=!1}}}});/*!
  * vue-router v4.5.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const Dh=typeof document<"u";function H2(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function hE(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&H2(e.default)}const Nr=Object.assign;function F0(e,n){const t={};for(const i in n){const r=n[i];t[i]=nu(r)?r.map(e):e(r)}return t}const Tf=()=>{},nu=Array.isArray,W2=/#/g,fE=/&/g,dE=/\//g,pE=/=/g,gE=/\?/g,Z2=/\+/g,mE=/%5B/g,vE=/%5D/g,K2=/%5E/g,yE=/%60/g,J2=/%7B/g,_E=/%7C/g,Y2=/%7D/g,bE=/%20/g;function ym(e){return encodeURI(""+e).replace(_E,"|").replace(mE,"[").replace(vE,"]")}function wE(e){return ym(e).replace(J2,"{").replace(Y2,"}").replace(K2,"^")}function Sg(e){return ym(e).replace(Z2,"%2B").replace(bE,"+").replace(W2,"%23").replace(fE,"%26").replace(yE,"`").replace(J2,"{").replace(Y2,"}").replace(K2,"^")}function xE(e){return Sg(e).replace(pE,"%3D")}function LE(e){return ym(e).replace(W2,"%23").replace(gE,"%3F")}function CE(e){return e==null?"":LE(e).replace(dE,"%2F")}function Vf(e){try{return decodeURIComponent(""+e)}catch{}return""+e}const SE=/\/$/,PE=e=>e.replace(SE,"");function z0(e,n,t="/"){let i,r={},o="",l="";const h=n.indexOf("#");let p=n.indexOf("?");return h<p&&h>=0&&(p=-1),p>-1&&(i=n.slice(0,p),o=n.slice(p+1,h>-1?h:n.length),r=e(o)),h>-1&&(i=i||n.slice(0,h),l=n.slice(h,n.length)),i=ME(i??n,t),{fullPath:i+(o&&"?")+o+l,path:i,query:r,hash:Vf(l)}}function EE(e,n){const t=n.query?e(n.query):"";return n.path+(t&&"?")+t+(n.hash||"")}function zv(e,n){return!n||!e.toLowerCase().startsWith(n.toLowerCase())?e:e.slice(n.length)||"/"}function AE(e,n,t){const i=n.matched.length-1,r=t.matched.length-1;return i>-1&&i===r&&Wh(n.matched[i],t.matched[r])&&X2(n.params,t.params)&&e(n.query)===e(t.query)&&n.hash===t.hash}function Wh(e,n){return(e.aliasOf||e)===(n.aliasOf||n)}function X2(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const t in e)if(!kE(e[t],n[t]))return!1;return!0}function kE(e,n){return nu(e)?jv(e,n):nu(n)?jv(n,e):e===n}function jv(e,n){return nu(n)?e.length===n.length&&e.every((t,i)=>t===n[i]):e.length===1&&e[0]===n}function ME(e,n){if(e.startsWith("/"))return e;if(!e)return n;const t=n.split("/"),i=e.split("/"),r=i[i.length-1];(r===".."||r===".")&&i.push("");let o=t.length-1,l,h;for(l=0;l<i.length;l++)if(h=i[l],h!==".")if(h==="..")o>1&&o--;else break;return t.slice(0,o).join("/")+"/"+i.slice(l).join("/")}const cc={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Hf;(function(e){e.pop="pop",e.push="push"})(Hf||(Hf={}));var Bf;(function(e){e.back="back",e.forward="forward",e.unknown=""})(Bf||(Bf={}));function TE(e){if(!e)if(Dh){const n=document.querySelector("base");e=n&&n.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),PE(e)}const BE=/^[^#]+#/;function NE(e,n){return e.replace(BE,"#")+n}function DE(e,n){const t=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:n.behavior,left:i.left-t.left-(n.left||0),top:i.top-t.top-(n.top||0)}}const $p=()=>({left:window.scrollX,top:window.scrollY});function RE(e){let n;if("el"in e){const t=e.el,i=typeof t=="string"&&t.startsWith("#"),r=typeof t=="string"?i?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!r)return;n=DE(r,e)}else n=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(n):window.scrollTo(n.left!=null?n.left:window.scrollX,n.top!=null?n.top:window.scrollY)}function Uv(e,n){return(history.state?history.state.position-n:-1)+e}const Pg=new Map;function OE(e,n){Pg.set(e,n)}function IE(e){const n=Pg.get(e);return Pg.delete(e),n}let FE=()=>location.protocol+"//"+location.host;function Q2(e,n){const{pathname:t,search:i,hash:r}=n,o=e.indexOf("#");if(o>-1){let h=r.includes(e.slice(o))?e.slice(o).length:1,p=r.slice(h);return p[0]!=="/"&&(p="/"+p),zv(p,"")}return zv(t,e)+i+r}function zE(e,n,t,i){let r=[],o=[],l=null;const h=({state:E})=>{const b=Q2(e,location),D=t.value,j=n.value;let Q=0;if(E){if(t.value=b,n.value=E,l&&l===D){l=null;return}Q=j?E.position-j.position:0}else i(b);r.forEach(F=>{F(t.value,D,{delta:Q,type:Hf.pop,direction:Q?Q>0?Bf.forward:Bf.back:Bf.unknown})})};function p(){l=t.value}function m(E){r.push(E);const b=()=>{const D=r.indexOf(E);D>-1&&r.splice(D,1)};return o.push(b),b}function _(){const{history:E}=window;E.state&&E.replaceState(Nr({},E.state,{scroll:$p()}),"")}function w(){for(const E of o)E();o=[],window.removeEventListener("popstate",h),window.removeEventListener("beforeunload",_)}return window.addEventListener("popstate",h),window.addEventListener("beforeunload",_,{passive:!0}),{pauseListeners:p,listen:m,destroy:w}}function $v(e,n,t,i=!1,r=!1){return{back:e,current:n,forward:t,replaced:i,position:window.history.length,scroll:r?$p():null}}function jE(e){const{history:n,location:t}=window,i={value:Q2(e,t)},r={value:n.state};r.value||o(i.value,{back:null,current:i.value,forward:null,position:n.length-1,replaced:!0,scroll:null},!0);function o(p,m,_){const w=e.indexOf("#"),E=w>-1?(t.host&&document.querySelector("base")?e:e.slice(w))+p:FE()+e+p;try{n[_?"replaceState":"pushState"](m,"",E),r.value=m}catch(b){console.error(b),t[_?"replace":"assign"](E)}}function l(p,m){const _=Nr({},n.state,$v(r.value.back,p,r.value.forward,!0),m,{position:r.value.position});o(p,_,!0),i.value=p}function h(p,m){const _=Nr({},r.value,n.state,{forward:p,scroll:$p()});o(_.current,_,!0);const w=Nr({},$v(i.value,p,null),{position:_.position+1},m);o(p,w,!1),i.value=p}return{location:i,state:r,push:h,replace:l}}function UE(e){e=TE(e);const n=jE(e),t=zE(e,n.state,n.location,n.replace);function i(o,l=!0){l||t.pauseListeners(),history.go(o)}const r=Nr({location:"",base:e,go:i,createHref:NE.bind(null,e)},n,t);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>n.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>n.state.value}),r}function $E(e){return typeof e=="string"||e&&typeof e=="object"}function e4(e){return typeof e=="string"||typeof e=="symbol"}const t4=Symbol("");var qv;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(qv||(qv={}));function Zh(e,n){return Nr(new Error,{type:e,[t4]:!0},n)}function Vu(e,n){return e instanceof Error&&t4 in e&&(n==null||!!(e.type&n))}const Gv="[^/]+?",qE={sensitive:!1,strict:!1,start:!0,end:!0},GE=/[.+*?^${}()[\]/\\]/g;function VE(e,n){const t=Nr({},qE,n),i=[];let r=t.start?"^":"";const o=[];for(const m of e){const _=m.length?[]:[90];t.strict&&!m.length&&(r+="/");for(let w=0;w<m.length;w++){const E=m[w];let b=40+(t.sensitive?.25:0);if(E.type===0)w||(r+="/"),r+=E.value.replace(GE,"\\$&"),b+=40;else if(E.type===1){const{value:D,repeatable:j,optional:Q,regexp:F}=E;o.push({name:D,repeatable:j,optional:Q});const V=F||Gv;if(V!==Gv){b+=10;try{new RegExp(`(${V})`)}catch(Ee){throw new Error(`Invalid custom RegExp for param "${D}" (${V}): `+Ee.message)}}let pe=j?`((?:${V})(?:/(?:${V}))*)`:`(${V})`;w||(pe=Q&&m.length<2?`(?:/${pe})`:"/"+pe),Q&&(pe+="?"),r+=pe,b+=20,Q&&(b+=-8),j&&(b+=-20),V===".*"&&(b+=-50)}_.push(b)}i.push(_)}if(t.strict&&t.end){const m=i.length-1;i[m][i[m].length-1]+=.7000000000000001}t.strict||(r+="/?"),t.end?r+="$":t.strict&&!r.endsWith("/")&&(r+="(?:/|$)");const l=new RegExp(r,t.sensitive?"":"i");function h(m){const _=m.match(l),w={};if(!_)return null;for(let E=1;E<_.length;E++){const b=_[E]||"",D=o[E-1];w[D.name]=b&&D.repeatable?b.split("/"):b}return w}function p(m){let _="",w=!1;for(const E of e){(!w||!_.endsWith("/"))&&(_+="/"),w=!1;for(const b of E)if(b.type===0)_+=b.value;else if(b.type===1){const{value:D,repeatable:j,optional:Q}=b,F=D in m?m[D]:"";if(nu(F)&&!j)throw new Error(`Provided param "${D}" is an array but it is not repeatable (* or + modifiers)`);const V=nu(F)?F.join("/"):F;if(!V)if(Q)E.length<2&&(_.endsWith("/")?_=_.slice(0,-1):w=!0);else throw new Error(`Missing required param "${D}"`);_+=V}}return _||"/"}return{re:l,score:i,keys:o,parse:h,stringify:p}}function HE(e,n){let t=0;for(;t<e.length&&t<n.length;){const i=n[t]-e[t];if(i)return i;t++}return e.length<n.length?e.length===1&&e[0]===80?-1:1:e.length>n.length?n.length===1&&n[0]===80?1:-1:0}function n4(e,n){let t=0;const i=e.score,r=n.score;for(;t<i.length&&t<r.length;){const o=HE(i[t],r[t]);if(o)return o;t++}if(Math.abs(r.length-i.length)===1){if(Vv(i))return 1;if(Vv(r))return-1}return r.length-i.length}function Vv(e){const n=e[e.length-1];return e.length>0&&n[n.length-1]<0}const WE={type:0,value:""},ZE=/[a-zA-Z0-9_]/;function KE(e){if(!e)return[[]];if(e==="/")return[[WE]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function n(b){throw new Error(`ERR (${t})/"${m}": ${b}`)}let t=0,i=t;const r=[];let o;function l(){o&&r.push(o),o=[]}let h=0,p,m="",_="";function w(){m&&(t===0?o.push({type:0,value:m}):t===1||t===2||t===3?(o.length>1&&(p==="*"||p==="+")&&n(`A repeatable param (${m}) must be alone in its segment. eg: '/:ids+.`),o.push({type:1,value:m,regexp:_,repeatable:p==="*"||p==="+",optional:p==="*"||p==="?"})):n("Invalid state to consume buffer"),m="")}function E(){m+=p}for(;h<e.length;){if(p=e[h++],p==="\\"&&t!==2){i=t,t=4;continue}switch(t){case 0:p==="/"?(m&&w(),l()):p===":"?(w(),t=1):E();break;case 4:E(),t=i;break;case 1:p==="("?t=2:ZE.test(p)?E():(w(),t=0,p!=="*"&&p!=="?"&&p!=="+"&&h--);break;case 2:p===")"?_[_.length-1]=="\\"?_=_.slice(0,-1)+p:t=3:_+=p;break;case 3:w(),t=0,p!=="*"&&p!=="?"&&p!=="+"&&h--,_="";break;default:n("Unknown state");break}}return t===2&&n(`Unfinished custom RegExp for param "${m}"`),w(),l(),r}function JE(e,n,t){const i=VE(KE(e.path),t),r=Nr(i,{record:e,parent:n,children:[],alias:[]});return n&&!r.record.aliasOf==!n.record.aliasOf&&n.children.push(r),r}function YE(e,n){const t=[],i=new Map;n=Kv({strict:!1,end:!0,sensitive:!1},n);function r(w){return i.get(w)}function o(w,E,b){const D=!b,j=Wv(w);j.aliasOf=b&&b.record;const Q=Kv(n,w),F=[j];if("alias"in w){const Ee=typeof w.alias=="string"?[w.alias]:w.alias;for(const Ie of Ee)F.push(Wv(Nr({},j,{components:b?b.record.components:j.components,path:Ie,aliasOf:b?b.record:j})))}let V,pe;for(const Ee of F){const{path:Ie}=Ee;if(E&&Ie[0]!=="/"){const nt=E.record.path,We=nt[nt.length-1]==="/"?"":"/";Ee.path=E.record.path+(Ie&&We+Ie)}if(V=JE(Ee,E,Q),b?b.alias.push(V):(pe=pe||V,pe!==V&&pe.alias.push(V),D&&w.name&&!Zv(V)&&l(w.name)),i4(V)&&p(V),j.children){const nt=j.children;for(let We=0;We<nt.length;We++)o(nt[We],V,b&&b.children[We])}b=b||V}return pe?()=>{l(pe)}:Tf}function l(w){if(e4(w)){const E=i.get(w);E&&(i.delete(w),t.splice(t.indexOf(E),1),E.children.forEach(l),E.alias.forEach(l))}else{const E=t.indexOf(w);E>-1&&(t.splice(E,1),w.record.name&&i.delete(w.record.name),w.children.forEach(l),w.alias.forEach(l))}}function h(){return t}function p(w){const E=eA(w,t);t.splice(E,0,w),w.record.name&&!Zv(w)&&i.set(w.record.name,w)}function m(w,E){let b,D={},j,Q;if("name"in w&&w.name){if(b=i.get(w.name),!b)throw Zh(1,{location:w});Q=b.record.name,D=Nr(Hv(E.params,b.keys.filter(pe=>!pe.optional).concat(b.parent?b.parent.keys.filter(pe=>pe.optional):[]).map(pe=>pe.name)),w.params&&Hv(w.params,b.keys.map(pe=>pe.name))),j=b.stringify(D)}else if(w.path!=null)j=w.path,b=t.find(pe=>pe.re.test(j)),b&&(D=b.parse(j),Q=b.record.name);else{if(b=E.name?i.get(E.name):t.find(pe=>pe.re.test(E.path)),!b)throw Zh(1,{location:w,currentLocation:E});Q=b.record.name,D=Nr({},E.params,w.params),j=b.stringify(D)}const F=[];let V=b;for(;V;)F.unshift(V.record),V=V.parent;return{name:Q,path:j,params:D,matched:F,meta:QE(F)}}e.forEach(w=>o(w));function _(){t.length=0,i.clear()}return{addRoute:o,resolve:m,removeRoute:l,clearRoutes:_,getRoutes:h,getRecordMatcher:r}}function Hv(e,n){const t={};for(const i of n)i in e&&(t[i]=e[i]);return t}function Wv(e){const n={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:XE(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(n,"mods",{value:{}}),n}function XE(e){const n={},t=e.props||!1;if("component"in e)n.default=t;else for(const i in e.components)n[i]=typeof t=="object"?t[i]:t;return n}function Zv(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function QE(e){return e.reduce((n,t)=>Nr(n,t.meta),{})}function Kv(e,n){const t={};for(const i in e)t[i]=i in n?n[i]:e[i];return t}function eA(e,n){let t=0,i=n.length;for(;t!==i;){const o=t+i>>1;n4(e,n[o])<0?i=o:t=o+1}const r=tA(e);return r&&(i=n.lastIndexOf(r,i-1)),i}function tA(e){let n=e;for(;n=n.parent;)if(i4(n)&&n4(e,n)===0)return n}function i4({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function nA(e){const n={};if(e===""||e==="?")return n;const i=(e[0]==="?"?e.slice(1):e).split("&");for(let r=0;r<i.length;++r){const o=i[r].replace(Z2," "),l=o.indexOf("="),h=Vf(l<0?o:o.slice(0,l)),p=l<0?null:Vf(o.slice(l+1));if(h in n){let m=n[h];nu(m)||(m=n[h]=[m]),m.push(p)}else n[h]=p}return n}function Jv(e){let n="";for(let t in e){const i=e[t];if(t=xE(t),i==null){i!==void 0&&(n+=(n.length?"&":"")+t);continue}(nu(i)?i.map(o=>o&&Sg(o)):[i&&Sg(i)]).forEach(o=>{o!==void 0&&(n+=(n.length?"&":"")+t,o!=null&&(n+="="+o))})}return n}function iA(e){const n={};for(const t in e){const i=e[t];i!==void 0&&(n[t]=nu(i)?i.map(r=>r==null?null:""+r):i==null?i:""+i)}return n}const rA=Symbol(""),Yv=Symbol(""),qp=Symbol(""),_m=Symbol(""),Eg=Symbol("");function ff(){let e=[];function n(i){return e.push(i),()=>{const r=e.indexOf(i);r>-1&&e.splice(r,1)}}function t(){e=[]}return{add:n,list:()=>e.slice(),reset:t}}function yc(e,n,t,i,r,o=l=>l()){const l=i&&(i.enterCallbacks[r]=i.enterCallbacks[r]||[]);return()=>new Promise((h,p)=>{const m=E=>{E===!1?p(Zh(4,{from:t,to:n})):E instanceof Error?p(E):$E(E)?p(Zh(2,{from:n,to:E})):(l&&i.enterCallbacks[r]===l&&typeof E=="function"&&l.push(E),h())},_=o(()=>e.call(i&&i.instances[r],n,t,m));let w=Promise.resolve(_);e.length<3&&(w=w.then(m)),w.catch(E=>p(E))})}function j0(e,n,t,i,r=o=>o()){const o=[];for(const l of e)for(const h in l.components){let p=l.components[h];if(!(n!=="beforeRouteEnter"&&!l.instances[h]))if(H2(p)){const _=(p.__vccOpts||p)[n];_&&o.push(yc(_,t,i,l,h,r))}else{let m=p();o.push(()=>m.then(_=>{if(!_)throw new Error(`Couldn't resolve component "${h}" at "${l.path}"`);const w=hE(_)?_.default:_;l.mods[h]=_,l.components[h]=w;const b=(w.__vccOpts||w)[n];return b&&yc(b,t,i,l,h,r)()}))}}return o}function Xv(e){const n=Ml(qp),t=Ml(_m),i=Di(()=>{const p=Xn(e.to);return n.resolve(p)}),r=Di(()=>{const{matched:p}=i.value,{length:m}=p,_=p[m-1],w=t.matched;if(!_||!w.length)return-1;const E=w.findIndex(Wh.bind(null,_));if(E>-1)return E;const b=Qv(p[m-2]);return m>1&&Qv(_)===b&&w[w.length-1].path!==b?w.findIndex(Wh.bind(null,p[m-2])):E}),o=Di(()=>r.value>-1&&lA(t.params,i.value.params)),l=Di(()=>r.value>-1&&r.value===t.matched.length-1&&X2(t.params,i.value.params));function h(p={}){if(aA(p)){const m=n[Xn(e.replace)?"replace":"push"](Xn(e.to)).catch(Tf);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>m),m}return Promise.resolve()}return{route:i,href:Di(()=>i.value.href),isActive:o,isExactActive:l,navigate:h}}function sA(e){return e.length===1?e[0]:e}const oA=Pa({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Xv,setup(e,{slots:n}){const t=ku(Xv(e)),{options:i}=Ml(qp),r=Di(()=>({[ey(e.activeClass,i.linkActiveClass,"router-link-active")]:t.isActive,[ey(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const o=n.default&&sA(n.default(t));return e.custom?o:dm("a",{"aria-current":t.isExactActive?e.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:r.value},o)}}}),Rh=oA;function aA(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const n=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(n))return}return e.preventDefault&&e.preventDefault(),!0}}function lA(e,n){for(const t in n){const i=n[t],r=e[t];if(typeof i=="string"){if(i!==r)return!1}else if(!nu(r)||r.length!==i.length||i.some((o,l)=>o!==r[l]))return!1}return!0}function Qv(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const ey=(e,n,t)=>e??n??t,uA=Pa({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:n,slots:t}){const i=Ml(Eg),r=Di(()=>e.route||i.value),o=Ml(Yv,0),l=Di(()=>{let m=Xn(o);const{matched:_}=r.value;let w;for(;(w=_[m])&&!w.components;)m++;return m}),h=Di(()=>r.value.matched[l.value]);Rd(Yv,Di(()=>l.value+1)),Rd(rA,h),Rd(Eg,r);const p=Yt();return Ur(()=>[p.value,h.value,e.name],([m,_,w],[E,b,D])=>{_&&(_.instances[w]=m,b&&b!==_&&m&&m===E&&(_.leaveGuards.size||(_.leaveGuards=b.leaveGuards),_.updateGuards.size||(_.updateGuards=b.updateGuards))),m&&_&&(!b||!Wh(_,b)||!E)&&(_.enterCallbacks[w]||[]).forEach(j=>j(m))},{flush:"post"}),()=>{const m=r.value,_=e.name,w=h.value,E=w&&w.components[_];if(!E)return ty(t.default,{Component:E,route:m});const b=w.props[_],D=b?b===!0?m.params:typeof b=="function"?b(m):b:null,Q=dm(E,Nr({},D,n,{onVnodeUnmounted:F=>{F.component.isUnmounted&&(w.instances[_]=null)},ref:p}));return ty(t.default,{Component:Q,route:m})||Q}}});function ty(e,n){if(!e)return null;const t=e(n);return t.length===1?t[0]:t}const r4=uA;function cA(e){const n=YE(e.routes,e),t=e.parseQuery||nA,i=e.stringifyQuery||Jv,r=e.history,o=ff(),l=ff(),h=ff(),p=vL(cc);let m=cc;Dh&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const _=F0.bind(null,ne=>""+ne),w=F0.bind(null,CE),E=F0.bind(null,Vf);function b(ne,re){let ee,oe;return e4(ne)?(ee=n.getRecordMatcher(ne),oe=re):oe=ne,n.addRoute(oe,ee)}function D(ne){const re=n.getRecordMatcher(ne);re&&n.removeRoute(re)}function j(){return n.getRoutes().map(ne=>ne.record)}function Q(ne){return!!n.getRecordMatcher(ne)}function F(ne,re){if(re=Nr({},re||p.value),typeof ne=="string"){const Le=z0(t,ne,re.path),ye=n.resolve({path:Le.path},re),ue=r.createHref(Le.fullPath);return Nr(Le,ye,{params:E(ye.params),hash:Vf(Le.hash),redirectedFrom:void 0,href:ue})}let ee;if(ne.path!=null)ee=Nr({},ne,{path:z0(t,ne.path,re.path).path});else{const Le=Nr({},ne.params);for(const ye in Le)Le[ye]==null&&delete Le[ye];ee=Nr({},ne,{params:w(Le)}),re.params=w(re.params)}const oe=n.resolve(ee,re),Se=ne.hash||"";oe.params=_(E(oe.params));const te=EE(i,Nr({},ne,{hash:wE(Se),path:oe.path})),ae=r.createHref(te);return Nr({fullPath:te,hash:Se,query:i===Jv?iA(ne.query):ne.query||{}},oe,{redirectedFrom:void 0,href:ae})}function V(ne){return typeof ne=="string"?z0(t,ne,p.value.path):Nr({},ne)}function pe(ne,re){if(m!==ne)return Zh(8,{from:re,to:ne})}function Ee(ne){return We(ne)}function Ie(ne){return Ee(Nr(V(ne),{replace:!0}))}function nt(ne){const re=ne.matched[ne.matched.length-1];if(re&&re.redirect){const{redirect:ee}=re;let oe=typeof ee=="function"?ee(ne):ee;return typeof oe=="string"&&(oe=oe.includes("?")||oe.includes("#")?oe=V(oe):{path:oe},oe.params={}),Nr({query:ne.query,hash:ne.hash,params:oe.path!=null?{}:ne.params},oe)}}function We(ne,re){const ee=m=F(ne),oe=p.value,Se=ne.state,te=ne.force,ae=ne.replace===!0,Le=nt(ee);if(Le)return We(Nr(V(Le),{state:typeof Le=="object"?Nr({},Se,Le.state):Se,force:te,replace:ae}),re||ee);const ye=ee;ye.redirectedFrom=re;let ue;return!te&&AE(i,oe,ee)&&(ue=Zh(16,{to:ye,from:oe}),ut(oe,oe,!0,!1)),(ue?Promise.resolve(ue):le(ye,oe)).catch(Oe=>Vu(Oe)?Vu(Oe,2)?Oe:Te(Oe):ie(Oe,ye,oe)).then(Oe=>{if(Oe){if(Vu(Oe,2))return We(Nr({replace:ae},V(Oe.to),{state:typeof Oe.to=="object"?Nr({},Se,Oe.to.state):Se,force:te}),re||ye)}else Oe=I(ye,oe,!0,ae,Se);return G(ye,oe,Oe),Oe})}function O(ne,re){const ee=pe(ne,re);return ee?Promise.reject(ee):Promise.resolve()}function H(ne){const re=B.values().next().value;return re&&typeof re.runWithContext=="function"?re.runWithContext(ne):ne()}function le(ne,re){let ee;const[oe,Se,te]=hA(ne,re);ee=j0(oe.reverse(),"beforeRouteLeave",ne,re);for(const Le of oe)Le.leaveGuards.forEach(ye=>{ee.push(yc(ye,ne,re))});const ae=O.bind(null,ne,re);return ee.push(ae),he(ee).then(()=>{ee=[];for(const Le of o.list())ee.push(yc(Le,ne,re));return ee.push(ae),he(ee)}).then(()=>{ee=j0(Se,"beforeRouteUpdate",ne,re);for(const Le of Se)Le.updateGuards.forEach(ye=>{ee.push(yc(ye,ne,re))});return ee.push(ae),he(ee)}).then(()=>{ee=[];for(const Le of te)if(Le.beforeEnter)if(nu(Le.beforeEnter))for(const ye of Le.beforeEnter)ee.push(yc(ye,ne,re));else ee.push(yc(Le.beforeEnter,ne,re));return ee.push(ae),he(ee)}).then(()=>(ne.matched.forEach(Le=>Le.enterCallbacks={}),ee=j0(te,"beforeRouteEnter",ne,re,H),ee.push(ae),he(ee))).then(()=>{ee=[];for(const Le of l.list())ee.push(yc(Le,ne,re));return ee.push(ae),he(ee)}).catch(Le=>Vu(Le,8)?Le:Promise.reject(Le))}function G(ne,re,ee){h.list().forEach(oe=>H(()=>oe(ne,re,ee)))}function I(ne,re,ee,oe,Se){const te=pe(ne,re);if(te)return te;const ae=re===cc,Le=Dh?history.state:{};ee&&(oe||ae?r.replace(ne.fullPath,Nr({scroll:ae&&Le&&Le.scroll},Se)):r.push(ne.fullPath,Se)),p.value=ne,ut(ne,re,ee,ae),Te()}let Y;function $(){Y||(Y=r.listen((ne,re,ee)=>{if(!W.listening)return;const oe=F(ne),Se=nt(oe);if(Se){We(Nr(Se,{replace:!0,force:!0}),oe).catch(Tf);return}m=oe;const te=p.value;Dh&&OE(Uv(te.fullPath,ee.delta),$p()),le(oe,te).catch(ae=>Vu(ae,12)?ae:Vu(ae,2)?(We(Nr(V(ae.to),{force:!0}),oe).then(Le=>{Vu(Le,20)&&!ee.delta&&ee.type===Hf.pop&&r.go(-1,!1)}).catch(Tf),Promise.reject()):(ee.delta&&r.go(-ee.delta,!1),ie(ae,oe,te))).then(ae=>{ae=ae||I(oe,te,!1),ae&&(ee.delta&&!Vu(ae,8)?r.go(-ee.delta,!1):ee.type===Hf.pop&&Vu(ae,20)&&r.go(-1,!1)),G(oe,te,ae)}).catch(Tf)}))}let R=ff(),Z=ff(),se;function ie(ne,re,ee){Te(ne);const oe=Z.list();return oe.length?oe.forEach(Se=>Se(ne,re,ee)):console.error(ne),Promise.reject(ne)}function Ae(){return se&&p.value!==cc?Promise.resolve():new Promise((ne,re)=>{R.add([ne,re])})}function Te(ne){return se||(se=!ne,$(),R.list().forEach(([re,ee])=>ne?ee(ne):re()),R.reset()),ne}function ut(ne,re,ee,oe){const{scrollBehavior:Se}=e;if(!Dh||!Se)return Promise.resolve();const te=!ee&&IE(Uv(ne.fullPath,0))||(oe||!ee)&&history.state&&history.state.scroll||null;return ks().then(()=>Se(ne,re,te)).then(ae=>ae&&RE(ae)).catch(ae=>ie(ae,ne,re))}const X=ne=>r.go(ne);let ke;const B=new Set,W={currentRoute:p,listening:!0,addRoute:b,removeRoute:D,clearRoutes:n.clearRoutes,hasRoute:Q,getRoutes:j,resolve:F,options:e,push:Ee,replace:Ie,go:X,back:()=>X(-1),forward:()=>X(1),beforeEach:o.add,beforeResolve:l.add,afterEach:h.add,onError:Z.add,isReady:Ae,install(ne){const re=this;ne.component("RouterLink",Rh),ne.component("RouterView",r4),ne.config.globalProperties.$router=re,Object.defineProperty(ne.config.globalProperties,"$route",{enumerable:!0,get:()=>Xn(p)}),Dh&&!ke&&p.value===cc&&(ke=!0,Ee(r.location).catch(Se=>{}));const ee={};for(const Se in cc)Object.defineProperty(ee,Se,{get:()=>p.value[Se],enumerable:!0});ne.provide(qp,re),ne.provide(_m,w_(ee)),ne.provide(Eg,p);const oe=ne.unmount;B.add(ne),ne.unmount=function(){B.delete(ne),B.size<1&&(m=cc,Y&&Y(),Y=null,p.value=cc,ke=!1,se=!1),oe()}}};function he(ne){return ne.reduce((re,ee)=>re.then(()=>H(ee)),Promise.resolve())}return W}function hA(e,n){const t=[],i=[],r=[],o=Math.max(n.matched.length,e.matched.length);for(let l=0;l<o;l++){const h=n.matched[l];h&&(e.matched.find(m=>Wh(m,h))?i.push(h):t.push(h));const p=e.matched[l];p&&(n.matched.find(m=>Wh(m,p))||r.push(p))}return[t,i,r]}function Gp(){return Ml(qp)}function gF(e){return Ml(_m)}const Nf=Dp("notification",()=>{const e=Yt([]),n=Yt(0),t=Yt(null),i=Di(()=>[...e.value].sort((w,E)=>E.timestamp-w.timestamp));function r({type:w,message:E,duration:b=5e3}){const D=++n.value,j=Date.now(),Q={id:D,type:w,message:E,duration:b,timestamp:j};return e.value.push(Q),t.value=D,b>0&&setTimeout(()=>{m(D)},b),D}const o=(w,E=5e3)=>r({type:"success",message:w,duration:E}),l=(w,E=5e3)=>r({type:"error",message:w,duration:E}),h=(w,E=5e3)=>r({type:"info",message:w,duration:E}),p=(w,E=5e3)=>r({type:"warning",message:w,duration:E});function m(w){const E=e.value.findIndex(b=>b.id===w);E!==-1&&e.value.splice(E,1),t.value===w&&(t.value=null)}function _(){e.value=[],t.value=null}return{notifications:i,lastAddedId:t,addNotification:r,removeNotification:m,clearAll:_,success:o,error:l,info:h,warning:p}});var qo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function s4(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function fA(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}var o4=fA,dA=typeof qo=="object"&&qo&&qo.Object===Object&&qo,pA=dA,gA=pA,mA=typeof self=="object"&&self&&self.Object===Object&&self,vA=gA||mA||Function("return this")(),a4=vA,yA=a4,_A=function(){return yA.Date.now()},bA=_A,wA=/\s/;function xA(e){for(var n=e.length;n--&&wA.test(e.charAt(n)););return n}var LA=xA,CA=LA,SA=/^\s+/;function PA(e){return e&&e.slice(0,CA(e)+1).replace(SA,"")}var EA=PA,AA=a4,kA=AA.Symbol,l4=kA,ny=l4,u4=Object.prototype,MA=u4.hasOwnProperty,TA=u4.toString,df=ny?ny.toStringTag:void 0;function BA(e){var n=MA.call(e,df),t=e[df];try{e[df]=void 0;var i=!0}catch{}var r=TA.call(e);return i&&(n?e[df]=t:delete e[df]),r}var NA=BA,DA=Object.prototype,RA=DA.toString;function OA(e){return RA.call(e)}var IA=OA,iy=l4,FA=NA,zA=IA,jA="[object Null]",UA="[object Undefined]",ry=iy?iy.toStringTag:void 0;function $A(e){return e==null?e===void 0?UA:jA:ry&&ry in Object(e)?FA(e):zA(e)}var qA=$A;function GA(e){return e!=null&&typeof e=="object"}var VA=GA,HA=qA,WA=VA,ZA="[object Symbol]";function KA(e){return typeof e=="symbol"||WA(e)&&HA(e)==ZA}var JA=KA,YA=EA,sy=o4,XA=JA,oy=NaN,QA=/^[-+]0x[0-9a-f]+$/i,e6=/^0b[01]+$/i,t6=/^0o[0-7]+$/i,n6=parseInt;function i6(e){if(typeof e=="number")return e;if(XA(e))return oy;if(sy(e)){var n=typeof e.valueOf=="function"?e.valueOf():e;e=sy(n)?n+"":n}if(typeof e!="string")return e===0?e:+e;e=YA(e);var t=e6.test(e);return t||t6.test(e)?n6(e.slice(2),t?2:8):QA.test(e)?oy:+e}var r6=i6,s6=o4,U0=bA,ay=r6,o6="Expected a function",a6=Math.max,l6=Math.min;function u6(e,n,t){var i,r,o,l,h,p,m=0,_=!1,w=!1,E=!0;if(typeof e!="function")throw new TypeError(o6);n=ay(n)||0,s6(t)&&(_=!!t.leading,w="maxWait"in t,o=w?a6(ay(t.maxWait)||0,n):o,E="trailing"in t?!!t.trailing:E);function b(nt){var We=i,O=r;return i=r=void 0,m=nt,l=e.apply(O,We),l}function D(nt){return m=nt,h=setTimeout(F,n),_?b(nt):l}function j(nt){var We=nt-p,O=nt-m,H=n-We;return w?l6(H,o-O):H}function Q(nt){var We=nt-p,O=nt-m;return p===void 0||We>=n||We<0||w&&O>=o}function F(){var nt=U0();if(Q(nt))return V(nt);h=setTimeout(F,j(nt))}function V(nt){return h=void 0,E&&i?b(nt):(i=r=void 0,l)}function pe(){h!==void 0&&clearTimeout(h),m=0,i=p=r=h=void 0}function Ee(){return h===void 0?l:V(U0())}function Ie(){var nt=U0(),We=Q(nt);if(i=arguments,r=this,p=nt,We){if(h===void 0)return D(p);if(w)return clearTimeout(h),h=setTimeout(F,n),b(p)}return h===void 0&&(h=setTimeout(F,n)),l}return Ie.cancel=pe,Ie.flush=Ee,Ie}var c6=u6;const h6=s4(c6),f6={class:"relative w-full"},d6={key:0,class:"search-results w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto"},p6=["onClick"],ly=Pa({__name:"SearchBar",emits:["select-location"],setup(e,{emit:n}){const t=Yt(""),i=Yt([]),r=n,o=h6(async p=>{if(p.length<3){i.value=[];return}try{const _=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(p)}`)).json();i.value=_}catch(m){console.error("Erreur lors de la recherche d'adresse:",m),i.value=[]}},300);function l(){o(t.value)}function h(p){t.value=p.display_name,i.value=[],r("select-location",{lat:parseFloat(p.lat),lng:parseFloat(p.lon)})}return(p,m)=>(et(),rt("div",f6,[zn(A("input",{"onUpdate:modelValue":m[0]||(m[0]=_=>t.value=_),onInput:l,type:"text",placeholder:"Rechercher une adresse...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"},null,544),[[Ui,t.value]]),i.value.length>0?(et(),rt("div",d6,[(et(!0),rt(Vn,null,$i(i.value,_=>(et(),rt("div",{key:_.place_id,onClick:w=>h(_),class:"px-4 py-2 hover:bg-gray-100 cursor-pointer"},Jt(_.display_name),9,p6))),128))])):Cn("",!0)]))}}),g6={class:"perf-title"},m6={class:"perf-basic-stats"},v6={class:"perf-stat"},y6={class:"perf-stat"},_6={class:"perf-expand-btn"},b6={key:0,class:"perf-content"},w6={class:"perf-section"},x6={class:"perf-metrics"},L6={class:"perf-metric"},C6={class:"perf-metric-value"},S6={class:"perf-metric"},P6={class:"perf-metric-value"},E6={class:"perf-metric"},A6={class:"perf-metric-value"},k6={class:"perf-metric"},M6={class:"perf-metric-value"},T6={class:"perf-section"},B6={class:"perf-metrics"},N6={key:0,class:"perf-metric"},D6={class:"perf-metric-value"},R6={key:1,class:"perf-metric"},O6={class:"perf-metric-value"},I6={key:2,class:"perf-metric"},F6={class:"perf-metric-value"},z6={class:"perf-section"},j6={class:"perf-table"},U6={class:"perf-table-cell"},$6={class:"perf-table-cell"},q6={class:"perf-table-cell"},G6={class:"perf-table-cell"},V6=["onClick"],H6={key:0,class:"perf-empty"},W6=Pa({__name:"PerformancePanel",props:{position:{}},setup(e){const t=e.position||"bottom-left",i=Yt(!1),{isQueryParamEnabled:r,isRecording:o,measures:l,longTasks:h,memorySnapshots:p,framesPerSecond:m,operationHistory:_,startRecording:w,stopRecording:E,clearRecording:b,captureMemorySnapshot:D,getSlowOperations:j,getPerformanceReport:Q,getOperationDetails:F}=hh(),V=Di(()=>{const I=Q()??{totalMeasures:0,totalLongTasks:0,slowestOperations:[],averageFps:0,memoryUsage:null};return{totalMeasures:I.totalMeasures,totalLongTasks:I.totalLongTasks,averageDuration:I.slowestOperations.length>0?I.slowestOperations.reduce((Y,$)=>Y+$.duration,0)/I.slowestOperations.length:0,fps:I.averageFps,slowestOperations:I.slowestOperations,memoryUsage:I.memoryUsage}}),pe=Di(()=>(Q()??{slowestOperations:[]}).slowestOperations.slice(0,5).map(Y=>({operation:Y.name,component:Y.component||"unknown",durationMs:Y.duration,timestamp:Y.startTime}))),Ee=Yt(null);Ha(()=>{r.value&&(Ee.value=window.setInterval(()=>{D()},1e3))}),Qu(()=>{Ee.value!==null&&clearInterval(Ee.value)});function Ie(I){return I===void 0?"N/A":I<1024?I+" B":I<1024*1024?(I/1024).toFixed(2)+" KB":I<1024*1024*1024?(I/(1024*1024)).toFixed(2)+" MB":(I/(1024*1024*1024)).toFixed(2)+" GB"}function nt(I){return I.toFixed(2)}const We=()=>{D()};function O(){const I=Q(),Y="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(I,null,2)),$=document.createElement("a");$.setAttribute("href",Y),$.setAttribute("download","performance_report.json"),document.body.appendChild($),$.click(),$.remove()}function H(){b(),We()}function le(){const I=Q();navigator.clipboard.writeText(JSON.stringify(I,null,2)).then(()=>{alert("Données de performance copiées dans le presse-papiers")}).catch(Y=>{console.error("Erreur lors de la copie des données",Y),alert("Erreur lors de la copie des données")})}async function G(I){const Y=F(I.operation,I.timestamp);if(!Y){alert("Impossible de trouver les détails de cette opération");return}const $={operation:{...Y.operation,startTimeRelative:"0ms",startTimeAbsolute:new Date(Y.operation.startTime).toISOString()},context:{...Y.context,relatedOperations:Y.context.relatedOperations.map(R=>({...R,startTime:`+${R.startTime.toFixed(2)}ms`})),longTasks:Y.context.longTasks.map(R=>({...R,startTime:`+${R.startTime.toFixed(2)}ms`})),memorySnapshots:Y.context.memorySnapshots.map(R=>({...R,timestamp:`+${R.timestamp.toFixed(2)}ms`,usedJSHeapSize:R.usedJSHeapSize?Ie(R.usedJSHeapSize):"N/A",totalJSHeapSize:R.totalJSHeapSize?Ie(R.totalJSHeapSize):"N/A"}))},summary:{...Y.summary,memoryDelta:Ie(Y.summary.memoryDelta),maxLongTaskDuration:`${Y.summary.maxLongTaskDuration.toFixed(2)}ms`}};try{await navigator.clipboard.writeText(JSON.stringify($,null,2)),alert("Détails de l'opération copiés dans le presse-papiers")}catch(R){console.error("Erreur lors de la copie des détails",R),alert("Erreur lors de la copie des détails")}}return(I,Y)=>{var $,R,Z,se,ie,Ae;return Xn(r)?(et(),rt("div",{key:0,class:Jr(["performance-panel",`position-${Xn(t)}`,{expanded:i.value}])},[A("div",{class:"perf-header",onClick:Y[0]||(Y[0]=Te=>i.value=!i.value)},[A("div",g6,[A("div",{class:Jr(["perf-indicator",{active:Xn(o)}])},null,2),Y[1]||(Y[1]=A("span",null,"Performance",-1))]),A("div",m6,[A("span",v6,Jt(V.value.fps)+" FPS",1),A("span",y6,Jt(nt(V.value.averageDuration))+"ms",1)]),A("button",_6,Jt(i.value?"▼":"▲"),1)]),i.value?(et(),rt("div",b6,[A("div",w6,[Y[6]||(Y[6]=A("h3",null,"Métriques générales",-1)),A("div",x6,[A("div",L6,[Y[2]||(Y[2]=A("span",{class:"perf-metric-label"},"Mesures",-1)),A("span",C6,Jt(V.value.totalMeasures),1)]),A("div",S6,[Y[3]||(Y[3]=A("span",{class:"perf-metric-label"},"Tâches longues",-1)),A("span",P6,Jt(V.value.totalLongTasks),1)]),A("div",E6,[Y[4]||(Y[4]=A("span",{class:"perf-metric-label"},"Durée moyenne",-1)),A("span",A6,Jt(nt(V.value.averageDuration))+"ms",1)]),A("div",k6,[Y[5]||(Y[5]=A("span",{class:"perf-metric-label"},"FPS",-1)),A("span",M6,Jt(V.value.fps),1)])])]),A("div",T6,[Y[10]||(Y[10]=A("h3",null,"Mémoire",-1)),A("div",B6,[(($=V.value.memoryUsage)==null?void 0:$.usedJSHeapSize)!==void 0?(et(),rt("div",N6,[Y[7]||(Y[7]=A("span",{class:"perf-metric-label"},"Utilisée",-1)),A("span",D6,Jt(Ie((R=V.value.memoryUsage)==null?void 0:R.usedJSHeapSize)),1)])):Cn("",!0),((Z=V.value.memoryUsage)==null?void 0:Z.totalJSHeapSize)!==void 0?(et(),rt("div",R6,[Y[8]||(Y[8]=A("span",{class:"perf-metric-label"},"Totale",-1)),A("span",O6,Jt(Ie((se=V.value.memoryUsage)==null?void 0:se.totalJSHeapSize)),1)])):Cn("",!0),((ie=V.value.memoryUsage)==null?void 0:ie.jsHeapSizeLimit)!==void 0?(et(),rt("div",I6,[Y[9]||(Y[9]=A("span",{class:"perf-metric-label"},"Limite",-1)),A("span",F6,Jt(Ie((Ae=V.value.memoryUsage)==null?void 0:Ae.jsHeapSizeLimit)),1)])):Cn("",!0)])]),A("div",z6,[Y[13]||(Y[13]=A("h3",null,"Opérations les plus lentes",-1)),A("div",j6,[Y[12]||(Y[12]=Cc('<div class="perf-table-header" data-v-fefe39b0><div class="perf-table-cell" data-v-fefe39b0>Opération</div><div class="perf-table-cell" data-v-fefe39b0>Composant</div><div class="perf-table-cell" data-v-fefe39b0>Durée</div><div class="perf-table-cell" data-v-fefe39b0>Actions</div></div>',1)),(et(!0),rt(Vn,null,$i(pe.value,Te=>(et(),rt("div",{class:"perf-table-row",key:Te.timestamp},[A("div",U6,Jt(Te.operation),1),A("div",$6,Jt(Te.component),1),A("div",q6,Jt(nt(Te.durationMs))+"ms",1),A("div",G6,[A("button",{onClick:ut=>G(Te),class:"perf-action-button",title:"Copier les détails"},Y[11]||(Y[11]=[A("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)]),8,V6)])]))),128)),pe.value.length===0?(et(),rt("div",H6," Aucune opération enregistrée ")):Cn("",!0)])]),A("div",{class:"perf-actions"},[A("button",{onClick:H,class:"perf-button"}," Réinitialiser "),A("button",{onClick:O,class:"perf-button"}," Télécharger "),A("button",{onClick:le,class:"perf-button"}," Copier ")])])):Cn("",!0)],2)):Cn("",!0)}}}),bm=(e,n)=>{const t=e.__vccOpts||e;for(const[i,r]of n)t[i]=r;return t},Z6=bm(W6,[["__scopeId","data-v-fefe39b0"]]),K6={class:"h-screen flex flex-col"},J6={key:0,class:"bg-white shadow-sm z-[2000] flex-shrink-0"},Y6={class:"mx-auto px-4 sm:px-6 lg:px-8"},X6={class:"flex h-16 items-center justify-between"},Q6={class:"flex items-center space-x-8"},ek={class:"hidden md:flex space-x-6"},tk={key:0,class:"hidden md:block flex-1 mx-8"},nk={key:1,class:"flex-1"},ik={class:"flex items-center space-x-2 md:space-x-4"},rk={key:0,class:"hidden md:flex items-center justify-center p-2 text-amber-500 hover:text-amber-600 rounded-full hover:bg-amber-50 focus:outline-none focus:ring-2 focus:ring-amber-400",title:"Performance activée"},sk={class:"flex md:hidden"},ok={class:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},ak={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"},lk={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},uk={class:"relative"},ck={class:"flex items-center h-full px-3 motion-reduce:transition-none"},hk={class:"flex-shrink-0"},fk={key:0,class:"h-5 w-5 text-white",viewBox:"0 0 20 20",fill:"currentColor"},dk={key:1,class:"h-5 w-5 text-white",viewBox:"0 0 20 20",fill:"currentColor"},pk={key:2,class:"h-5 w-5 text-white",viewBox:"0 0 20 20",fill:"currentColor"},gk={key:3,class:"h-5 w-5 text-white",viewBox:"0 0 20 20",fill:"currentColor"},mk={key:0,class:"ml-2 text-white font-medium message-container"},vk={key:0,class:"absolute right-0 mt-2 w-80 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-[3000]"},yk={class:"px-4 py-2 border-b border-gray-100 flex justify-between items-center"},_k={class:"max-h-72 overflow-y-auto"},bk={key:0,class:"px-4 py-3 text-sm text-gray-500 text-center"},wk={class:"flex items-start"},xk={class:"flex-shrink-0 mr-3"},Lk={key:0,class:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor"},Ck={key:1,class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},Sk={key:2,class:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},Pk={key:3,class:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor"},Ek={class:"flex-1"},Ak={class:"text-sm text-gray-800"},kk=["onClick"],Mk={class:"relative"},Tk={class:"hidden md:flex flex-col items-end"},Bk={class:"text-sm font-medium text-gray-700"},Nk={key:0,class:"text-xs text-gray-500"},Dk=["src","alt"],Rk={key:0,class:"absolute right-0 mt-2 w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-[3000]"},Ok={class:"md:hidden px-4 py-2 border-b border-gray-100"},Ik={class:"text-sm font-medium text-gray-700"},Fk={class:"text-xs text-gray-500"},zk={key:0,class:"md:hidden"},jk={class:"space-y-1 px-2 pb-3 pt-2"},Uk={key:0,class:"px-4 py-3"},$k={key:0,class:"fixed inset-0 bg-white z-[2001] flex flex-col items-center justify-center p-6 text-center"},qk=Pa({__name:"App",setup(e){const n=Gp(),t=Va(),i=Nf(),{isQueryParamEnabled:r}=hh(),o=Yt(!1),l=Yt(!1),h=Yt(!1),p=Yt(!1),m=Yt(!1),_=Yt(null),w=Yt(!1),E=Yt(null),b=Yt("13px"),D=Yt("65px");function j(){p.value=window.innerWidth<768}Ha(()=>{j(),window.addEventListener("resize",j),window.addEventListener("resize",Q)}),Ap(()=>{window.removeEventListener("resize",j),window.removeEventListener("resize",Q)});function Q(){if(!E.value)return;const $=E.value.getBoundingClientRect();b.value=`${$.top+window.scrollY+5}px`;const R=$.left+$.width/2;D.value=`${window.innerWidth-R-22}px`}const F=Di(()=>{const $=t.user;if(!$)return"";const R=`${$.first_name} ${$.last_name.toUpperCase()}`;return $.company_name?`${R} (${$.company_name})`:R}),V=Di(()=>{var R;switch((R=t.user)==null?void 0:R.user_type){case"admin":return"Accès administrateur";case"usine":return"Accès usine";case"concessionnaire":return"Accès concessionnaire";case"agriculteur":return"Accès agriculteur";default:return""}}),pe=Di(()=>{var $;return(($=t.user)==null?void 0:$.user_type)==="admin"}),Ee=Di(()=>t.isAuthenticated),Ie=[{name:"Carte",to:"/"},{name:"Plans",to:"/plans"}],nt=Di(()=>{var R,Z;if(!Ee.value)return[];const $=[...Ie];return(pe.value||((R=t.user)==null?void 0:R.user_type)==="usine"||((Z=t.user)==null?void 0:Z.user_type)==="concessionnaire")&&$.push({name:"Utilisateurs",to:"/users"}),$}),We=Di(()=>Ee.value?[{name:"Mon profil",to:"/profile"}]:[]);async function O(){try{await t.logout(),n.push("/login")}catch($){console.error("Erreur lors de la déconnexion:",$)}}function H($){window.dispatchEvent(new CustomEvent("map-set-location",{detail:{lat:$.lat,lng:$.lng,zoom:16}}))}Ha(async()=>{console.log("App mounted, checking auth...");try{if(localStorage.getItem("token")){console.log("Token found, checking auth..."),await t.checkAuth(),await t.fetchUserProfile();const R=localStorage.getItem("lastPlanId");R&&window.dispatchEvent(new CustomEvent("load-last-plan",{detail:{planId:R}}))}else console.log("No token found")}catch($){console.error("Auth check error:",$),n.push("/login")}});const le=Di(()=>{const $="IrrigationDesign";if(!Ee.value)return`${$} - Connexion`;const R=n.currentRoute.value,se={home:"Carte",plans:"Plans",users:"Utilisateurs",profile:"Mon profil",selectConcessionnaire:"Sélection du concessionnaire",changePassword:"Changement de mot de passe",map:"Carte"}[R.name]||"";return se?`${$} - ${se}`:$});Ur(le,$=>{document.title=$},{immediate:!0});const G=Di(()=>i.notifications.length);function I(){i.clearAll(),h.value=!1}function Y(){_.value&&(w.value=!1,setTimeout(()=>{_.value=null},300))}return hg(()=>{if(i.lastAddedId!==null){const $=i.notifications.find(R=>R.id===i.lastAddedId);$&&ks(()=>{Q(),m.value=!0,_.value={id:$.id,message:$.message,type:$.type},requestAnimationFrame(()=>{setTimeout(()=>{w.value=!0,setTimeout(()=>{w.value=!1,setTimeout(()=>{var R;((R=_.value)==null?void 0:R.id)===$.id&&(_.value=null,m.value=!1)},300)},4e3)},50)})})}}),($,R)=>{var Z;return et(),rt("div",K6,[Ee.value?(et(),rt("header",J6,[A("nav",Y6,[A("div",X6,[A("div",Q6,[$r(Xn(Rh),{to:"/",class:"text-xl font-semibold text-primary-600 truncate"},{default:Kl(()=>R[5]||(R[5]=[A("span",{class:"md:inline hidden"},"IrrigationDesign",-1),A("span",{class:"md:hidden inline"},"ID",-1)])),_:1}),A("div",ek,[(et(!0),rt(Vn,null,$i(nt.value,se=>(et(),Yl(Xn(Rh),{key:se.name,to:se.to,class:Jr(["text-sm font-medium transition-colors duration-200",[$.$route.path===se.to?"text-primary-600 border-b-2 border-primary-500":"text-gray-500 hover:text-gray-900"]])},{default:Kl(()=>[Ir(Jt(se.name),1)]),_:2},1032,["to","class"]))),128))])]),$.$route.path==="/"?(et(),rt("div",tk,[$r(ly,{onSelectLocation:H})])):(et(),rt("div",nk)),A("div",ik,[Xn(r)?(et(),rt("button",rk,R[6]||(R[6]=[A("span",{class:"sr-only"},"Performance",-1),A("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)]))):Cn("",!0),A("div",sk,[A("button",{onClick:R[0]||(R[0]=se=>l.value=!l.value),class:"inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500"},[R[7]||(R[7]=A("span",{class:"sr-only"},"Ouvrir le menu",-1)),(et(),rt("svg",ok,[l.value?(et(),rt("path",lk)):(et(),rt("path",ak))]))])]),A("div",uk,[A("button",{ref_key:"bellButtonRef",ref:E,onClick:R[1]||(R[1]=se=>h.value=!h.value),class:Jr(["relative flex items-center justify-center p-2 text-gray-400 hover:text-gray-500 rounded-full hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",{"animate-bell":m.value}])},R[8]||(R[8]=[A("span",{class:"sr-only"},"Voir les notifications",-1),A("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})],-1)]),2),$r(sp,{name:"island"},{default:Kl(()=>[_.value?(et(),rt("div",{key:0,class:Jr(["dynamic-island fixed z-[9999] shadow-xl",[w.value?"island-expanded":"island-pill",_.value.type==="success"?"bg-green-500":_.value.type==="error"?"bg-red-500":_.value.type==="warning"?"bg-yellow-500":"bg-blue-500"]]),style:_c({top:b.value,right:D.value,transform:"translateZ(0)"}),onClick:Y},[A("div",ck,[A("div",hk,[_.value.type==="success"?(et(),rt("svg",fk,R[9]||(R[9]=[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):_.value.type==="error"?(et(),rt("svg",dk,R[10]||(R[10]=[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"},null,-1)]))):_.value.type==="warning"?(et(),rt("svg",pk,R[11]||(R[11]=[A("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)]))):(et(),rt("svg",gk,R[12]||(R[12]=[A("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"},null,-1)])))]),$r(sp,{name:"message",duration:{enter:200,leave:150}},{default:Kl(()=>[w.value?(et(),rt("div",mk,Jt(_.value.message),1)):Cn("",!0)]),_:1})])],6)):Cn("",!0)]),_:1}),h.value?(et(),rt("div",vk,[A("div",yk,[R[13]||(R[13]=A("h3",{class:"text-sm font-semibold text-gray-700"},"Notifications",-1)),G.value>0?(et(),rt("button",{key:0,onClick:I,class:"text-xs text-primary-600 hover:text-primary-800"}," Tout effacer ")):Cn("",!0)]),A("div",_k,[G.value===0?(et(),rt("div",bk," Aucune notification ")):Cn("",!0),(et(!0),rt(Vn,null,$i(Xn(i).notifications,se=>(et(),rt("div",{key:se.id,class:"px-4 py-3 border-b border-gray-100 last:border-0 hover:bg-gray-50"},[A("div",wk,[A("div",xk,[se.type==="success"?(et(),rt("svg",Lk,R[14]||(R[14]=[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):se.type==="error"?(et(),rt("svg",Ck,R[15]||(R[15]=[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"},null,-1)]))):se.type==="warning"?(et(),rt("svg",Sk,R[16]||(R[16]=[A("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)]))):(et(),rt("svg",Pk,R[17]||(R[17]=[A("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"},null,-1)])))]),A("div",Ek,[A("p",Ak,Jt(se.message),1),A("button",{onClick:ie=>Xn(i).removeNotification(se.id),class:"text-xs text-primary-600 hover:text-primary-800 mt-1"}," Fermer ",8,kk)])])]))),128))])])):Cn("",!0)]),A("div",Mk,[A("button",{onClick:R[2]||(R[2]=se=>o.value=!o.value),class:"flex items-center space-x-2 md:space-x-3 focus:outline-none"},[A("div",Tk,[A("span",Bk,Jt(F.value),1),V.value?(et(),rt("span",Nk,Jt(V.value),1)):Cn("",!0)]),A("img",{class:"h-8 w-8 rounded-full ring-2 ring-white",src:((Z=Xn(t).user)==null?void 0:Z.logo)||"https://ui-avatars.com/api/?name="+encodeURIComponent(F.value),alt:F.value},null,8,Dk)]),o.value?(et(),rt("div",Rk,[A("div",Ok,[A("div",Ik,Jt(F.value),1),A("div",Fk,Jt(V.value),1)]),(et(!0),rt(Vn,null,$i(We.value,se=>(et(),Yl(Xn(Rh),{key:se.name,to:se.to,class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",onClick:R[3]||(R[3]=ie=>o.value=!1)},{default:Kl(()=>[Ir(Jt(se.name),1)]),_:2},1032,["to"]))),128)),A("button",{onClick:O,class:"block w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-gray-50"}," Déconnexion ")])):Cn("",!0)])])]),l.value?(et(),rt("div",zk,[A("div",jk,[(et(!0),rt(Vn,null,$i(nt.value,se=>(et(),Yl(Xn(Rh),{key:se.name,to:se.to,class:Jr(["block px-3 py-2 rounded-md text-base font-medium",[$.$route.path===se.to?"bg-primary-50 text-primary-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"]]),onClick:R[4]||(R[4]=ie=>l.value=!1)},{default:Kl(()=>[Ir(Jt(se.name),1)]),_:2},1032,["to","class"]))),128))]),$.$route.path==="/"?(et(),rt("div",Uk,[$r(ly,{onSelectLocation:H})])):Cn("",!0)])):Cn("",!0)])])):Cn("",!0),A("main",{class:Jr([$.$route.path==="/"?"overflow-hidden":"overflow-auto","flex-1 flex flex-col h-[calc(100vh-64px)]"])},[p.value&&$.$route.path==="/"?(et(),rt("div",$k,[R[19]||(R[19]=A("svg",{class:"w-24 h-24 text-primary-500 mb-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})],-1)),R[20]||(R[20]=A("h2",{class:"text-2xl font-bold text-gray-900 mb-4"}," Version bureau recommandée ",-1)),R[21]||(R[21]=A("p",{class:"text-gray-600 mb-8 max-w-md"}," Pour une meilleure expérience de conception d'irrigation, nous vous recommandons d'utiliser un écran plus large ou un ordinateur. ",-1)),$r(Xn(Rh),{to:"/plans",class:"inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700"},{default:Kl(()=>R[18]||(R[18]=[Ir(" Voir mes plans ")])),_:1})])):(et(),Yl(Xn(r4),{key:1}))],2),$r(Z6,{position:"bottom-left"})])}}}),Gk="modulepreload",Vk=function(e){return"/static/frontend/"+e},uy={},nh=function(n,t,i){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),h=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));r=Promise.allSettled(t.map(p=>{if(p=Vk(p),p in uy)return;uy[p]=!0;const m=p.endsWith(".css"),_=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${_}`))return;const w=document.createElement("link");if(w.rel=m?"stylesheet":Gk,m||(w.as="script"),w.crossOrigin="",w.href=p,h&&w.setAttribute("nonce",h),document.head.appendChild(w),m)return new Promise((E,b)=>{w.addEventListener("load",E),w.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${p}`)))})}))}function o(l){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=l,window.dispatchEvent(h),!h.defaultPrevented)throw l}return r.then(l=>{for(const h of l||[])h.status==="rejected"&&o(h.reason);return n().catch(o)})},Hk={class:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8"},Wk={class:"max-w-md w-full space-y-8"},Zk={class:"space-y-4"},Kk={class:"mt-1"},Jk={class:"mt-1"},Yk={class:"mt-1"},Xk={key:0,class:"rounded-md bg-red-50 p-4"},Qk={class:"flex"},eM={class:"ml-3"},tM={class:"text-sm font-medium text-red-800"},nM={key:1,class:"rounded-md bg-yellow-50 p-4"},iM={class:"flex"},rM={class:"ml-3"},sM={class:"mt-2 text-sm text-yellow-700"},oM={class:"list-disc pl-5 space-y-1"},aM=["disabled"],lM={class:"absolute left-0 inset-y-0 flex items-center pl-3"},uM={key:0,class:"h-5 w-5 text-primary-500 group-hover:text-primary-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},cM={key:1,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},hM=Pa({__name:"ChangePasswordForm",setup(e){const n=Gp(),t=Va(),i=ku({oldPassword:"",newPassword:"",confirmPassword:""}),r=Yt(!1),o=Yt("");Ha(()=>{var m,_;console.log("ChangePasswordForm mounted, auth state:",{isAuthenticated:t.isAuthenticated,userId:(m=t.user)==null?void 0:m.id,mustChangePassword:(_=t.user)==null?void 0:_.must_change_password})});const l=Di(()=>{const m=[];return i.newPassword&&i.newPassword.length<8&&m.push("Le nouveau mot de passe doit contenir au moins 8 caractères"),i.newPassword&&i.confirmPassword&&i.newPassword!==i.confirmPassword&&m.push("Les mots de passe ne correspondent pas"),m}),h=Di(()=>i.oldPassword.length>0&&i.newPassword.length>=8&&i.newPassword===i.confirmPassword);async function p(){var m,_,w,E,b,D,j,Q;if(!h.value){o.value="Veuillez corriger les erreurs avant de continuer";return}if(!((m=t.user)!=null&&m.id)){o.value="Erreur : utilisateur non identifié";return}r.value=!0,o.value="";try{console.log("Submitting password change..."),await t.changePassword(i.oldPassword,i.newPassword),console.log("Password changed successfully"),n.push("/")}catch(F){console.error("Password change failed:",F),(w=(_=F.response)==null?void 0:_.data)!=null&&w.detail?o.value=F.response.data.detail:(b=(E=F.response)==null?void 0:E.data)!=null&&b.old_password?o.value=F.response.data.old_password[0]:(j=(D=F.response)==null?void 0:D.data)!=null&&j.password?o.value=F.response.data.password[0]:((Q=F.response)==null?void 0:Q.status)===401?(o.value="Session expirée, veuillez vous reconnecter",await t.logout(),n.push("/login")):o.value="Une erreur est survenue lors du changement de mot de passe"}finally{r.value=!1}}return(m,_)=>(et(),rt("div",Hk,[A("div",Wk,[_[12]||(_[12]=A("div",null,[A("h2",{class:"mt-6 text-center text-3xl font-extrabold text-gray-900"}," Changement de mot de passe "),A("p",{class:"mt-2 text-center text-sm text-gray-600"}," Pour des raisons de sécurité, vous devez changer votre mot de passe. ")],-1)),A("form",{class:"mt-8 space-y-6",onSubmit:Bp(p,["prevent"])},[A("div",Zk,[A("div",null,[_[3]||(_[3]=A("label",{for:"old-password",class:"block text-sm font-medium text-gray-700"},"Ancien mot de passe",-1)),A("div",Kk,[zn(A("input",{id:"old-password","onUpdate:modelValue":_[0]||(_[0]=w=>i.oldPassword=w),name:"old-password",type:"password",required:"",autocomplete:"current-password",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Entrez votre mot de passe actuel"},null,512),[[Ui,i.oldPassword]])])]),A("div",null,[_[4]||(_[4]=A("label",{for:"new-password",class:"block text-sm font-medium text-gray-700"},"Nouveau mot de passe",-1)),A("div",Jk,[zn(A("input",{id:"new-password","onUpdate:modelValue":_[1]||(_[1]=w=>i.newPassword=w),name:"new-password",type:"password",required:"",autocomplete:"new-password",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Entrez votre nouveau mot de passe"},null,512),[[Ui,i.newPassword]])]),_[5]||(_[5]=A("p",{class:"mt-1 text-sm text-gray-500"}," Le mot de passe doit contenir au moins 8 caractères ",-1))]),A("div",null,[_[6]||(_[6]=A("label",{for:"confirm-password",class:"block text-sm font-medium text-gray-700"},"Confirmer le mot de passe",-1)),A("div",Yk,[zn(A("input",{id:"confirm-password","onUpdate:modelValue":_[2]||(_[2]=w=>i.confirmPassword=w),name:"confirm-password",type:"password",required:"",autocomplete:"new-password",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Confirmez votre nouveau mot de passe"},null,512),[[Ui,i.confirmPassword]])])])]),o.value?(et(),rt("div",Xk,[A("div",Qk,[_[7]||(_[7]=A("div",{class:"flex-shrink-0"},[A("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),A("div",eM,[A("h3",tM,Jt(o.value),1)])])])):Cn("",!0),l.value.length>0?(et(),rt("div",nM,[A("div",iM,[_[9]||(_[9]=A("div",{class:"flex-shrink-0"},[A("svg",{class:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])],-1)),A("div",rM,[_[8]||(_[8]=A("h3",{class:"text-sm font-medium text-yellow-800"},"Attention",-1)),A("div",sM,[A("ul",oM,[(et(!0),rt(Vn,null,$i(l.value,(w,E)=>(et(),rt("li",{key:E},Jt(w),1))),128))])])])])])):Cn("",!0),A("div",null,[A("button",{type:"submit",disabled:r.value||!h.value,class:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50"},[A("span",lM,[r.value?(et(),rt("svg",cM,_[11]||(_[11]=[A("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),A("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(et(),rt("svg",uM,_[10]||(_[10]=[A("path",{"fill-rule":"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule":"evenodd"},null,-1)])))]),Ir(" "+Jt(r.value?"Modification en cours...":"Changer le mot de passe"),1)],8,aM)])],32)])]))}}),fM="/static/frontend/assets/logo.svg",dM={class:"min-h-screen bg-white from-blue-50 to-white flex flex-col justify-center py-12 sm:px-6 lg:px-8"},pM={class:"mt-8 sm:mx-auto sm:w-full sm:max-w-md"},gM={class:"bg-white py-8 px-6 shadow-lg rounded-md sm:px-10"},mM={key:0,class:"rounded-md bg-red-50 p-4"},vM={class:"flex"},yM={class:"ml-3"},_M={class:"text-sm font-medium text-red-800"},bM={class:"mt-1"},wM={class:"mt-1 relative"},xM=["type"],LM={key:0,class:"h-5 w-5 text-gray-400 hover:text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},CM={key:1,class:"h-5 w-5 text-gray-400 hover:text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},SM={class:"flex items-center justify-between"},PM={class:"flex items-center"},EM={class:"text-sm"},AM=["disabled"],kM={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},MM=Pa({__name:"LoginView",setup(e){const n=Gp(),t=Va(),i=Yt(!1),r=Yt(null),o=Yt(!1),l=ku({username:"",password:"",rememberMe:!1});Ha(()=>{var p;console.log("LoginView mounted"),console.log("INITIAL_STATE:",window.INITIAL_STATE),(p=window.INITIAL_STATE)!=null&&p.isAuthenticated&&(console.log("User is authenticated, redirecting to home"),n.push("/"))});async function h(){var p,m,_,w,E,b,D,j,Q;i.value=!0,r.value=null;try{if(!l.username||!l.password){r.value="Veuillez remplir tous les champs";return}await t.login(l.username,l.password),(p=t.user)!=null&&p.must_change_password?n.push("/change-password"):n.push("/")}catch(F){console.error("Login error:",F),((m=F==null?void 0:F.response)==null?void 0:m.status)===500?r.value="Le service est temporairement indisponible. Veuillez réessayer dans quelques instants.":((_=F==null?void 0:F.response)==null?void 0:_.status)===401||((w=F==null?void 0:F.response)==null?void 0:w.status)===403?r.value="Identifiants incorrects. Veuillez vérifier votre nom d'utilisateur et mot de passe.":(b=(E=F==null?void 0:F.response)==null?void 0:E.data)!=null&&b.detail?r.value=F.response.data.detail:(Q=(j=(D=F==null?void 0:F.response)==null?void 0:D.data)==null?void 0:j.non_field_errors)!=null&&Q[0]?r.value=F.response.data.non_field_errors[0]:(F==null?void 0:F.message)==="Network Error"?r.value="Impossible de se connecter au serveur. Veuillez vérifier votre connexion internet.":r.value="Une erreur est survenue lors de la connexion. Veuillez réessayer."}finally{i.value=!1}}return(p,m)=>{const _=VL("router-link");return et(),rt("div",dM,[m[12]||(m[12]=A("div",{class:"sm:mx-auto sm:w-full sm:max-w-md"},[A("img",{src:fM,alt:"IrrigationDesign Logo",class:"mx-auto h-40 w-auto transition-transform duration-300 hover:scale-110"}),A("h2",{class:"mt-2 text-center text-3xl font-bold text-gray-800"}," IrrigationDesign "),A("p",{class:"mt-2 text-center text-sm text-gray-600"}," Connectez-vous pour accéder à votre espace ")],-1)),A("div",pM,[A("div",gM,[A("form",{class:"space-y-6",onSubmit:Bp(h,["prevent"])},[r.value?(et(),rt("div",mM,[A("div",vM,[m[4]||(m[4]=A("div",{class:"flex-shrink-0"},[A("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),A("div",yM,[A("h3",_M,Jt(r.value),1)])])])):Cn("",!0),A("div",null,[m[5]||(m[5]=A("label",{for:"username",class:"block text-sm font-medium text-gray-700"}," Nom d'utilisateur ",-1)),A("div",bM,[zn(A("input",{id:"username","onUpdate:modelValue":m[0]||(m[0]=w=>l.username=w),name:"username",type:"text",required:"",autocomplete:"username",class:"appearance-none block w-full h-11 px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 sm:text-sm","aria-label":"Nom d'utilisateur"},null,512),[[Ui,l.username]])])]),A("div",null,[m[8]||(m[8]=A("label",{for:"password",class:"block text-sm font-medium text-gray-700"}," Mot de passe ",-1)),A("div",wM,[zn(A("input",{id:"password","onUpdate:modelValue":m[1]||(m[1]=w=>l.password=w),type:o.value?"text":"password",name:"password",required:"",autocomplete:"current-password",class:"appearance-none block w-full h-11 px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 sm:text-sm pr-10","aria-label":"Mot de passe"},null,8,xM),[[uS,l.password]]),A("button",{type:"button",onClick:m[2]||(m[2]=w=>o.value=!o.value),class:"absolute inset-y-0 right-0 pr-3 flex items-center","aria-label":"Afficher/masquer le mot de passe"},[o.value?(et(),rt("svg",LM,m[6]||(m[6]=[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)]))):(et(),rt("svg",CM,m[7]||(m[7]=[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])))])])]),A("div",SM,[A("div",PM,[zn(A("input",{id:"remember-me","onUpdate:modelValue":m[3]||(m[3]=w=>l.rememberMe=w),name:"remember-me",type:"checkbox",class:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded","aria-label":"Se souvenir de moi"},null,512),[[u2,l.rememberMe]]),m[9]||(m[9]=A("label",{for:"remember-me",class:"ml-2 block text-sm text-gray-900"}," Se souvenir de moi ",-1))]),A("div",EM,[$r(_,{to:"/forgot-password",class:"font-medium text-primary-600 hover:text-primary-500 transition-colors duration-200"},{default:Kl(()=>m[10]||(m[10]=[Ir(" Mot de passe oublié ? ")])),_:1})])]),A("div",null,[A("button",{type:"submit",disabled:i.value,class:"w-full h-11 flex justify-center items-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Se connecter"},[i.value?(et(),rt("svg",kM,m[11]||(m[11]=[A("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),A("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):Cn("",!0),Ir(" "+Jt(i.value?"Connexion en cours...":"Se connecter"),1)],8,AM)])],32)])])])}}}),cy="/static/frontend/assets/logo.jpeg";var Ag={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,n){(function(t,i){i(n)})(qo,function(t){var i="1.9.4";function r(s){var f,x,T,K;for(x=1,T=arguments.length;x<T;x++){K=arguments[x];for(f in K)s[f]=K[f]}return s}var o=Object.create||function(){function s(){}return function(f){return s.prototype=f,new s}}();function l(s,f){var x=Array.prototype.slice;if(s.bind)return s.bind.apply(s,x.call(arguments,1));var T=x.call(arguments,2);return function(){return s.apply(f,T.length?T.concat(x.call(arguments)):arguments)}}var h=0;function p(s){return"_leaflet_id"in s||(s._leaflet_id=++h),s._leaflet_id}function m(s,f,x){var T,K,we,ct;return ct=function(){T=!1,K&&(we.apply(x,K),K=!1)},we=function(){T?K=arguments:(s.apply(x,arguments),setTimeout(ct,f),T=!0)},we}function _(s,f,x){var T=f[1],K=f[0],we=T-K;return s===T&&x?s:((s-K)%we+we)%we+K}function w(){return!1}function E(s,f){if(f===!1)return s;var x=Math.pow(10,f===void 0?6:f);return Math.round(s*x)/x}function b(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function D(s){return b(s).split(/\s+/)}function j(s,f){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?o(s.options):{});for(var x in f)s.options[x]=f[x];return s.options}function Q(s,f,x){var T=[];for(var K in s)T.push(encodeURIComponent(x?K.toUpperCase():K)+"="+encodeURIComponent(s[K]));return(!f||f.indexOf("?")===-1?"?":"&")+T.join("&")}var F=/\{ *([\w_ -]+) *\}/g;function V(s,f){return s.replace(F,function(x,T){var K=f[T];if(K===void 0)throw new Error("No value provided for variable "+x);return typeof K=="function"&&(K=K(f)),K})}var pe=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function Ee(s,f){for(var x=0;x<s.length;x++)if(s[x]===f)return x;return-1}var Ie="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function nt(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var We=0;function O(s){var f=+new Date,x=Math.max(0,16-(f-We));return We=f+x,window.setTimeout(s,x)}var H=window.requestAnimationFrame||nt("RequestAnimationFrame")||O,le=window.cancelAnimationFrame||nt("CancelAnimationFrame")||nt("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function G(s,f,x){if(x&&H===O)s.call(f);else return H.call(window,l(s,f))}function I(s){s&&le.call(window,s)}var Y={__proto__:null,extend:r,create:o,bind:l,get lastId(){return h},stamp:p,throttle:m,wrapNum:_,falseFn:w,formatNum:E,trim:b,splitWords:D,setOptions:j,getParamString:Q,template:V,isArray:pe,indexOf:Ee,emptyImageUrl:Ie,requestFn:H,cancelFn:le,requestAnimFrame:G,cancelAnimFrame:I};function $(){}$.extend=function(s){var f=function(){j(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},x=f.__super__=this.prototype,T=o(x);T.constructor=f,f.prototype=T;for(var K in this)Object.prototype.hasOwnProperty.call(this,K)&&K!=="prototype"&&K!=="__super__"&&(f[K]=this[K]);return s.statics&&r(f,s.statics),s.includes&&(R(s.includes),r.apply(null,[T].concat(s.includes))),r(T,s),delete T.statics,delete T.includes,T.options&&(T.options=x.options?o(x.options):{},r(T.options,s.options)),T._initHooks=[],T.callInitHooks=function(){if(!this._initHooksCalled){x.callInitHooks&&x.callInitHooks.call(this),this._initHooksCalled=!0;for(var we=0,ct=T._initHooks.length;we<ct;we++)T._initHooks[we].call(this)}},f},$.include=function(s){var f=this.prototype.options;return r(this.prototype,s),s.options&&(this.prototype.options=f,this.mergeOptions(s.options)),this},$.mergeOptions=function(s){return r(this.prototype.options,s),this},$.addInitHook=function(s){var f=Array.prototype.slice.call(arguments,1),x=typeof s=="function"?s:function(){this[s].apply(this,f)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(x),this};function R(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=pe(s)?s:[s];for(var f=0;f<s.length;f++)s[f]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Z={on:function(s,f,x){if(typeof s=="object")for(var T in s)this._on(T,s[T],f);else{s=D(s);for(var K=0,we=s.length;K<we;K++)this._on(s[K],f,x)}return this},off:function(s,f,x){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var T in s)this._off(T,s[T],f);else{s=D(s);for(var K=arguments.length===1,we=0,ct=s.length;we<ct;we++)K?this._off(s[we]):this._off(s[we],f,x)}return this},_on:function(s,f,x,T){if(typeof f!="function"){console.warn("wrong listener type: "+typeof f);return}if(this._listens(s,f,x)===!1){x===this&&(x=void 0);var K={fn:f,ctx:x};T&&(K.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(K)}},_off:function(s,f,x){var T,K,we;if(this._events&&(T=this._events[s],!!T)){if(arguments.length===1){if(this._firingCount)for(K=0,we=T.length;K<we;K++)T[K].fn=w;delete this._events[s];return}if(typeof f!="function"){console.warn("wrong listener type: "+typeof f);return}var ct=this._listens(s,f,x);if(ct!==!1){var Dt=T[ct];this._firingCount&&(Dt.fn=w,this._events[s]=T=T.slice()),T.splice(ct,1)}}},fire:function(s,f,x){if(!this.listens(s,x))return this;var T=r({},f,{type:s,target:this,sourceTarget:f&&f.sourceTarget||this});if(this._events){var K=this._events[s];if(K){this._firingCount=this._firingCount+1||1;for(var we=0,ct=K.length;we<ct;we++){var Dt=K[we],$t=Dt.fn;Dt.once&&this.off(s,$t,Dt.ctx),$t.call(Dt.ctx||this,T)}this._firingCount--}}return x&&this._propagateEvent(T),this},listens:function(s,f,x,T){typeof s!="string"&&console.warn('"string" type argument expected');var K=f;typeof f!="function"&&(T=!!f,K=void 0,x=void 0);var we=this._events&&this._events[s];if(we&&we.length&&this._listens(s,K,x)!==!1)return!0;if(T){for(var ct in this._eventParents)if(this._eventParents[ct].listens(s,f,x,T))return!0}return!1},_listens:function(s,f,x){if(!this._events)return!1;var T=this._events[s]||[];if(!f)return!!T.length;x===this&&(x=void 0);for(var K=0,we=T.length;K<we;K++)if(T[K].fn===f&&T[K].ctx===x)return K;return!1},once:function(s,f,x){if(typeof s=="object")for(var T in s)this._on(T,s[T],f,!0);else{s=D(s);for(var K=0,we=s.length;K<we;K++)this._on(s[K],f,x,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[p(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[p(s)],this},_propagateEvent:function(s){for(var f in this._eventParents)this._eventParents[f].fire(s.type,r({layer:s.target,propagatedFrom:s.target},s),!0)}};Z.addEventListener=Z.on,Z.removeEventListener=Z.clearAllEventListeners=Z.off,Z.addOneTimeEventListener=Z.once,Z.fireEvent=Z.fire,Z.hasEventListeners=Z.listens;var se=$.extend(Z);function ie(s,f,x){this.x=x?Math.round(s):s,this.y=x?Math.round(f):f}var Ae=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};ie.prototype={clone:function(){return new ie(this.x,this.y)},add:function(s){return this.clone()._add(Te(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(Te(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new ie(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new ie(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Ae(this.x),this.y=Ae(this.y),this},distanceTo:function(s){s=Te(s);var f=s.x-this.x,x=s.y-this.y;return Math.sqrt(f*f+x*x)},equals:function(s){return s=Te(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=Te(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+E(this.x)+", "+E(this.y)+")"}};function Te(s,f,x){return s instanceof ie?s:pe(s)?new ie(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new ie(s.x,s.y):new ie(s,f,x)}function ut(s,f){if(s)for(var x=f?[s,f]:s,T=0,K=x.length;T<K;T++)this.extend(x[T])}ut.prototype={extend:function(s){var f,x;if(!s)return this;if(s instanceof ie||typeof s[0]=="number"||"x"in s)f=x=Te(s);else if(s=X(s),f=s.min,x=s.max,!f||!x)return this;return!this.min&&!this.max?(this.min=f.clone(),this.max=x.clone()):(this.min.x=Math.min(f.x,this.min.x),this.max.x=Math.max(x.x,this.max.x),this.min.y=Math.min(f.y,this.min.y),this.max.y=Math.max(x.y,this.max.y)),this},getCenter:function(s){return Te((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return Te(this.min.x,this.max.y)},getTopRight:function(){return Te(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var f,x;return typeof s[0]=="number"||s instanceof ie?s=Te(s):s=X(s),s instanceof ut?(f=s.min,x=s.max):f=x=s,f.x>=this.min.x&&x.x<=this.max.x&&f.y>=this.min.y&&x.y<=this.max.y},intersects:function(s){s=X(s);var f=this.min,x=this.max,T=s.min,K=s.max,we=K.x>=f.x&&T.x<=x.x,ct=K.y>=f.y&&T.y<=x.y;return we&&ct},overlaps:function(s){s=X(s);var f=this.min,x=this.max,T=s.min,K=s.max,we=K.x>f.x&&T.x<x.x,ct=K.y>f.y&&T.y<x.y;return we&&ct},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var f=this.min,x=this.max,T=Math.abs(f.x-x.x)*s,K=Math.abs(f.y-x.y)*s;return X(Te(f.x-T,f.y-K),Te(x.x+T,x.y+K))},equals:function(s){return s?(s=X(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function X(s,f){return!s||s instanceof ut?s:new ut(s,f)}function ke(s,f){if(s)for(var x=f?[s,f]:s,T=0,K=x.length;T<K;T++)this.extend(x[T])}ke.prototype={extend:function(s){var f=this._southWest,x=this._northEast,T,K;if(s instanceof W)T=s,K=s;else if(s instanceof ke){if(T=s._southWest,K=s._northEast,!T||!K)return this}else return s?this.extend(he(s)||B(s)):this;return!f&&!x?(this._southWest=new W(T.lat,T.lng),this._northEast=new W(K.lat,K.lng)):(f.lat=Math.min(T.lat,f.lat),f.lng=Math.min(T.lng,f.lng),x.lat=Math.max(K.lat,x.lat),x.lng=Math.max(K.lng,x.lng)),this},pad:function(s){var f=this._southWest,x=this._northEast,T=Math.abs(f.lat-x.lat)*s,K=Math.abs(f.lng-x.lng)*s;return new ke(new W(f.lat-T,f.lng-K),new W(x.lat+T,x.lng+K))},getCenter:function(){return new W((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new W(this.getNorth(),this.getWest())},getSouthEast:function(){return new W(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof W||"lat"in s?s=he(s):s=B(s);var f=this._southWest,x=this._northEast,T,K;return s instanceof ke?(T=s.getSouthWest(),K=s.getNorthEast()):T=K=s,T.lat>=f.lat&&K.lat<=x.lat&&T.lng>=f.lng&&K.lng<=x.lng},intersects:function(s){s=B(s);var f=this._southWest,x=this._northEast,T=s.getSouthWest(),K=s.getNorthEast(),we=K.lat>=f.lat&&T.lat<=x.lat,ct=K.lng>=f.lng&&T.lng<=x.lng;return we&&ct},overlaps:function(s){s=B(s);var f=this._southWest,x=this._northEast,T=s.getSouthWest(),K=s.getNorthEast(),we=K.lat>f.lat&&T.lat<x.lat,ct=K.lng>f.lng&&T.lng<x.lng;return we&&ct},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,f){return s?(s=B(s),this._southWest.equals(s.getSouthWest(),f)&&this._northEast.equals(s.getNorthEast(),f)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function B(s,f){return s instanceof ke?s:new ke(s,f)}function W(s,f,x){if(isNaN(s)||isNaN(f))throw new Error("Invalid LatLng object: ("+s+", "+f+")");this.lat=+s,this.lng=+f,x!==void 0&&(this.alt=+x)}W.prototype={equals:function(s,f){if(!s)return!1;s=he(s);var x=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return x<=(f===void 0?1e-9:f)},toString:function(s){return"LatLng("+E(this.lat,s)+", "+E(this.lng,s)+")"},distanceTo:function(s){return re.distance(this,he(s))},wrap:function(){return re.wrapLatLng(this)},toBounds:function(s){var f=180*s/40075017,x=f/Math.cos(Math.PI/180*this.lat);return B([this.lat-f,this.lng-x],[this.lat+f,this.lng+x])},clone:function(){return new W(this.lat,this.lng,this.alt)}};function he(s,f,x){return s instanceof W?s:pe(s)&&typeof s[0]!="object"?s.length===3?new W(s[0],s[1],s[2]):s.length===2?new W(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new W(s.lat,"lng"in s?s.lng:s.lon,s.alt):f===void 0?null:new W(s,f,x)}var ne={latLngToPoint:function(s,f){var x=this.projection.project(s),T=this.scale(f);return this.transformation._transform(x,T)},pointToLatLng:function(s,f){var x=this.scale(f),T=this.transformation.untransform(s,x);return this.projection.unproject(T)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var f=this.projection.bounds,x=this.scale(s),T=this.transformation.transform(f.min,x),K=this.transformation.transform(f.max,x);return new ut(T,K)},infinite:!1,wrapLatLng:function(s){var f=this.wrapLng?_(s.lng,this.wrapLng,!0):s.lng,x=this.wrapLat?_(s.lat,this.wrapLat,!0):s.lat,T=s.alt;return new W(x,f,T)},wrapLatLngBounds:function(s){var f=s.getCenter(),x=this.wrapLatLng(f),T=f.lat-x.lat,K=f.lng-x.lng;if(T===0&&K===0)return s;var we=s.getSouthWest(),ct=s.getNorthEast(),Dt=new W(we.lat-T,we.lng-K),$t=new W(ct.lat-T,ct.lng-K);return new ke(Dt,$t)}},re=r({},ne,{wrapLng:[-180,180],R:6371e3,distance:function(s,f){var x=Math.PI/180,T=s.lat*x,K=f.lat*x,we=Math.sin((f.lat-s.lat)*x/2),ct=Math.sin((f.lng-s.lng)*x/2),Dt=we*we+Math.cos(T)*Math.cos(K)*ct*ct,$t=2*Math.atan2(Math.sqrt(Dt),Math.sqrt(1-Dt));return this.R*$t}}),ee=6378137,oe={R:ee,MAX_LATITUDE:85.0511287798,project:function(s){var f=Math.PI/180,x=this.MAX_LATITUDE,T=Math.max(Math.min(x,s.lat),-x),K=Math.sin(T*f);return new ie(this.R*s.lng*f,this.R*Math.log((1+K)/(1-K))/2)},unproject:function(s){var f=180/Math.PI;return new W((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*f,s.x*f/this.R)},bounds:function(){var s=ee*Math.PI;return new ut([-s,-s],[s,s])}()};function Se(s,f,x,T){if(pe(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=f,this._c=x,this._d=T}Se.prototype={transform:function(s,f){return this._transform(s.clone(),f)},_transform:function(s,f){return f=f||1,s.x=f*(this._a*s.x+this._b),s.y=f*(this._c*s.y+this._d),s},untransform:function(s,f){return f=f||1,new ie((s.x/f-this._b)/this._a,(s.y/f-this._d)/this._c)}};function te(s,f,x,T){return new Se(s,f,x,T)}var ae=r({},re,{code:"EPSG:3857",projection:oe,transformation:function(){var s=.5/(Math.PI*oe.R);return te(s,.5,-s,.5)}()}),Le=r({},ae,{code:"EPSG:900913"});function ye(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function ue(s,f){var x="",T,K,we,ct,Dt,$t;for(T=0,we=s.length;T<we;T++){for(Dt=s[T],K=0,ct=Dt.length;K<ct;K++)$t=Dt[K],x+=(K?"L":"M")+$t.x+" "+$t.y;x+=f?yn.svg?"z":"x":""}return x||"M0 0"}var Oe=document.documentElement.style,De="ActiveXObject"in window,Me=De&&!document.addEventListener,Ve="msLaunchUri"in navigator&&!("documentMode"in document),ze=Wt("webkit"),st=Wt("android"),Qe=Wt("android 2")||Wt("android 3"),pt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),wt=st&&Wt("Google")&&pt<537&&!("AudioNode"in window),Ht=!!window.opera,nn=!Ve&&Wt("chrome"),tt=Wt("gecko")&&!ze&&!Ht&&!De,Qt=!nn&&Wt("safari"),rn=Wt("phantom"),it="OTransition"in Oe,Ke=navigator.platform.indexOf("Win")===0,qt=De&&"transition"in Oe,mn="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Qe,xn="MozPerspective"in Oe,wn=!window.L_DISABLE_3D&&(qt||mn||xn)&&!it&&!rn,ot=typeof orientation<"u"||Wt("mobile"),de=ot&&ze,_e=ot&&mn,$e=!window.PointerEvent&&window.MSPointerEvent,Gt=!!(window.PointerEvent||$e),Dn="ontouchstart"in window||!!window.TouchEvent,Ln=!window.L_NO_TOUCH&&(Dn||Gt),bt=ot&&Ht,_n=ot&&tt,$n=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ni=function(){var s=!1;try{var f=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",w,f),window.removeEventListener("testPassiveEventSupport",w,f)}catch{}return s}(),ri=function(){return!!document.createElement("canvas").getContext}(),Li=!!(document.createElementNS&&ye("svg").createSVGRect),Sn=!!Li&&function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Un=!Li&&function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var f=s.firstChild;return f.style.behavior="url(#default#VML)",f&&typeof f.adj=="object"}catch{return!1}}(),ui=navigator.platform.indexOf("Mac")===0,jn=navigator.platform.indexOf("Linux")===0;function Wt(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var yn={ie:De,ielt9:Me,edge:Ve,webkit:ze,android:st,android23:Qe,androidStock:wt,opera:Ht,chrome:nn,gecko:tt,safari:Qt,phantom:rn,opera12:it,win:Ke,ie3d:qt,webkit3d:mn,gecko3d:xn,any3d:wn,mobile:ot,mobileWebkit:de,mobileWebkit3d:_e,msPointer:$e,pointer:Gt,touch:Ln,touchNative:Dn,mobileOpera:bt,mobileGecko:_n,retina:$n,passiveEvents:ni,canvas:ri,svg:Li,vml:Un,inlineSvg:Sn,mac:ui,linux:jn},Ci=yn.msPointer?"MSPointerDown":"pointerdown",qi=yn.msPointer?"MSPointerMove":"pointermove",Si=yn.msPointer?"MSPointerUp":"pointerup",Qi=yn.msPointer?"MSPointerCancel":"pointercancel",fr={touchstart:Ci,touchmove:qi,touchend:Si,touchcancel:Qi},Hn={touchstart:zr,touchmove:dr,touchend:dr,touchcancel:dr},ai={},rr=!1;function Yi(s,f,x){return f==="touchstart"&&Wi(),Hn[f]?(x=Hn[f].bind(this,x),s.addEventListener(fr[f],x,!1),x):(console.warn("wrong event specified:",f),w)}function Pi(s,f,x){if(!fr[f]){console.warn("wrong event specified:",f);return}s.removeEventListener(fr[f],x,!1)}function kn(s){ai[s.pointerId]=s}function xr(s){ai[s.pointerId]&&(ai[s.pointerId]=s)}function Gi(s){delete ai[s.pointerId]}function Wi(){rr||(document.addEventListener(Ci,kn,!0),document.addEventListener(qi,xr,!0),document.addEventListener(Si,Gi,!0),document.addEventListener(Qi,Gi,!0),rr=!0)}function dr(s,f){if(f.pointerType!==(f.MSPOINTER_TYPE_MOUSE||"mouse")){f.touches=[];for(var x in ai)f.touches.push(ai[x]);f.changedTouches=[f],s(f)}}function zr(s,f){f.MSPOINTER_TYPE_TOUCH&&f.pointerType===f.MSPOINTER_TYPE_TOUCH&&mi(f),dr(s,f)}function Vi(s){var f={},x,T;for(T in s)x=s[T],f[T]=x&&x.bind?x.bind(s):x;return s=f,f.type="dblclick",f.detail=2,f.isTrusted=!1,f._simulated=!0,f}var fi=200;function gs(s,f){s.addEventListener("dblclick",f);var x=0,T;function K(we){if(we.detail!==1){T=we.detail;return}if(!(we.pointerType==="mouse"||we.sourceCapabilities&&!we.sourceCapabilities.firesTouchEvents)){var ct=fa(we);if(!(ct.some(function($t){return $t instanceof HTMLLabelElement&&$t.attributes.for})&&!ct.some(function($t){return $t instanceof HTMLInputElement||$t instanceof HTMLSelectElement}))){var Dt=Date.now();Dt-x<=fi?(T++,T===2&&f(Vi(we))):T=1,x=Dt}}}return s.addEventListener("click",K),{dblclick:f,simDblclick:K}}function Pr(s,f){s.removeEventListener("dblclick",f.dblclick),s.removeEventListener("click",f.simDblclick)}var Rr=Po(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Ai=Po(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),En=Ai==="webkitTransition"||Ai==="OTransition"?Ai+"End":"transitionend";function hn(s){return typeof s=="string"?document.getElementById(s):s}function di(s,f){var x=s.style[f]||s.currentStyle&&s.currentStyle[f];if((!x||x==="auto")&&document.defaultView){var T=document.defaultView.getComputedStyle(s,null);x=T?T[f]:null}return x==="auto"?null:x}function li(s,f,x){var T=document.createElement(s);return T.className=f||"",x&&x.appendChild(T),T}function Wn(s){var f=s.parentNode;f&&f.removeChild(s)}function as(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function Ms(s){var f=s.parentNode;f&&f.lastChild!==s&&f.appendChild(s)}function jr(s){var f=s.parentNode;f&&f.firstChild!==s&&f.insertBefore(s,f.firstChild)}function ao(s,f){if(s.classList!==void 0)return s.classList.contains(f);var x=vr(s);return x.length>0&&new RegExp("(^|\\s)"+f+"(\\s|$)").test(x)}function dn(s,f){if(s.classList!==void 0)for(var x=D(f),T=0,K=x.length;T<K;T++)s.classList.add(x[T]);else if(!ao(s,f)){var we=vr(s);Er(s,(we?we+" ":"")+f)}}function si(s,f){s.classList!==void 0?s.classList.remove(f):Er(s,b((" "+vr(s)+" ").replace(" "+f+" "," ")))}function Er(s,f){s.className.baseVal===void 0?s.className=f:s.className.baseVal=f}function vr(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function Lr(s,f){"opacity"in s.style?s.style.opacity=f:"filter"in s.style&&Ea(s,f)}function Ea(s,f){var x=!1,T="DXImageTransform.Microsoft.Alpha";try{x=s.filters.item(T)}catch{if(f===1)return}f=Math.round(f*100),x?(x.Enabled=f!==100,x.Opacity=f):s.style.filter+=" progid:"+T+"(opacity="+f+")"}function Po(s){for(var f=document.documentElement.style,x=0;x<s.length;x++)if(s[x]in f)return s[x];return!1}function Eo(s,f,x){var T=f||new ie(0,0);s.style[Rr]=(yn.ie3d?"translate("+T.x+"px,"+T.y+"px)":"translate3d("+T.x+"px,"+T.y+"px,0)")+(x?" scale("+x+")":"")}function Cr(s,f){s._leaflet_pos=f,yn.any3d?Eo(s,f):(s.style.left=f.x+"px",s.style.top=f.y+"px")}function Ts(s){return s._leaflet_pos||new ie(0,0)}var lo,Bs,sr;if("onselectstart"in document)lo=function(){yi(window,"selectstart",mi)},Bs=function(){Zi(window,"selectstart",mi)};else{var ms=Po(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);lo=function(){if(ms){var s=document.documentElement.style;sr=s[ms],s[ms]="none"}},Bs=function(){ms&&(document.documentElement.style[ms]=sr,sr=void 0)}}function vs(){yi(window,"dragstart",mi)}function fo(){Zi(window,"dragstart",mi)}var Go,ca;function Za(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(rs(),Go=s,ca=s.style.outlineStyle,s.style.outlineStyle="none",yi(window,"keydown",rs))}function rs(){Go&&(Go.style.outlineStyle=ca,Go=void 0,ca=void 0,Zi(window,"keydown",rs))}function ou(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function fl(s){var f=s.getBoundingClientRect();return{x:f.width/s.offsetWidth||1,y:f.height/s.offsetHeight||1,boundingClientRect:f}}var pi={__proto__:null,TRANSFORM:Rr,TRANSITION:Ai,TRANSITION_END:En,get:hn,getStyle:di,create:li,remove:Wn,empty:as,toFront:Ms,toBack:jr,hasClass:ao,addClass:dn,removeClass:si,setClass:Er,getClass:vr,setOpacity:Lr,testProp:Po,setTransform:Eo,setPosition:Cr,getPosition:Ts,get disableTextSelection(){return lo},get enableTextSelection(){return Bs},disableImageDrag:vs,enableImageDrag:fo,preventOutline:Za,restoreOutline:rs,getSizedParentNode:ou,getScale:fl};function yi(s,f,x,T){if(f&&typeof f=="object")for(var K in f)ka(s,K,f[K],x);else{f=D(f);for(var we=0,ct=f.length;we<ct;we++)ka(s,f[we],x,T)}return this}var po="_leaflet_events";function Zi(s,f,x,T){if(arguments.length===1)Nl(s),delete s[po];else if(f&&typeof f=="object")for(var K in f)go(s,K,f[K],x);else if(f=D(f),arguments.length===2)Nl(s,function(Dt){return Ee(f,Dt)!==-1});else for(var we=0,ct=f.length;we<ct;we++)go(s,f[we],x,T);return this}function Nl(s,f){for(var x in s[po]){var T=x.split(/\d/)[0];(!f||f(T))&&go(s,T,null,null,x)}}var Aa={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function ka(s,f,x,T){var K=f+p(x)+(T?"_"+p(T):"");if(s[po]&&s[po][K])return this;var we=function(Dt){return x.call(T||s,Dt||window.event)},ct=we;!yn.touchNative&&yn.pointer&&f.indexOf("touch")===0?we=Yi(s,f,we):yn.touch&&f==="dblclick"?we=gs(s,we):"addEventListener"in s?f==="touchstart"||f==="touchmove"||f==="wheel"||f==="mousewheel"?s.addEventListener(Aa[f]||f,we,yn.passiveEvents?{passive:!1}:!1):f==="mouseenter"||f==="mouseleave"?(we=function(Dt){Dt=Dt||window.event,Ma(s,Dt)&&ct(Dt)},s.addEventListener(Aa[f],we,!1)):s.addEventListener(f,ct,!1):s.attachEvent("on"+f,we),s[po]=s[po]||{},s[po][K]=we}function go(s,f,x,T,K){K=K||f+p(x)+(T?"_"+p(T):"");var we=s[po]&&s[po][K];if(!we)return this;!yn.touchNative&&yn.pointer&&f.indexOf("touch")===0?Pi(s,f,we):yn.touch&&f==="dblclick"?Pr(s,we):"removeEventListener"in s?s.removeEventListener(Aa[f]||f,we,!1):s.detachEvent("on"+f,we),s[po][K]=null}function ha(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function Dl(s){return ka(s,"wheel",ha),this}function Ka(s){return yi(s,"mousedown touchstart dblclick contextmenu",ha),s._leaflet_disable_click=!0,this}function mi(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function Bi(s){return mi(s),ha(s),this}function fa(s){if(s.composedPath)return s.composedPath();for(var f=[],x=s.target;x;)f.push(x),x=x.parentNode;return f}function au(s,f){if(!f)return new ie(s.clientX,s.clientY);var x=fl(f),T=x.boundingClientRect;return new ie((s.clientX-T.left)/x.x-f.clientLeft,(s.clientY-T.top)/x.y-f.clientTop)}var Ja=yn.linux&&yn.chrome?window.devicePixelRatio:yn.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function dl(s){return yn.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/Ja:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function Ma(s,f){var x=f.relatedTarget;if(!x)return!0;try{for(;x&&x!==s;)x=x.parentNode}catch{return!1}return x!==s}var Ya={__proto__:null,on:yi,off:Zi,stopPropagation:ha,disableScrollPropagation:Dl,disableClickPropagation:Ka,preventDefault:mi,stop:Bi,getPropagationPath:fa,getMousePosition:au,getWheelDelta:dl,isExternalTarget:Ma,addListener:yi,removeListener:Zi},pl=se.extend({run:function(s,f,x,T){this.stop(),this._el=s,this._inProgress=!0,this._duration=x||.25,this._easeOutPower=1/Math.max(T||.5,.2),this._startPos=Ts(s),this._offset=f.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=G(this._animate,this),this._step()},_step:function(s){var f=+new Date-this._startTime,x=this._duration*1e3;f<x?this._runFrame(this._easeOut(f/x),s):(this._runFrame(1),this._complete())},_runFrame:function(s,f){var x=this._startPos.add(this._offset.multiplyBy(s));f&&x._round(),Cr(this._el,x),this.fire("step")},_complete:function(){I(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),Oi=se.extend({options:{crs:ae,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,f){f=j(this,f),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),f.maxBounds&&this.setMaxBounds(f.maxBounds),f.zoom!==void 0&&(this._zoom=this._limitZoom(f.zoom)),f.center&&f.zoom!==void 0&&this.setView(he(f.center),f.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Ai&&yn.any3d&&!yn.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),yi(this._proxy,En,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,f,x){if(f=f===void 0?this._zoom:this._limitZoom(f),s=this._limitCenter(he(s),f,this.options.maxBounds),x=x||{},this._stop(),this._loaded&&!x.reset&&x!==!0){x.animate!==void 0&&(x.zoom=r({animate:x.animate},x.zoom),x.pan=r({animate:x.animate,duration:x.duration},x.pan));var T=this._zoom!==f?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,f,x.zoom):this._tryAnimatedPan(s,x.pan);if(T)return clearTimeout(this._sizeTimer),this}return this._resetView(s,f,x.pan&&x.pan.noMoveStart),this},setZoom:function(s,f){return this._loaded?this.setView(this.getCenter(),s,{zoom:f}):(this._zoom=s,this)},zoomIn:function(s,f){return s=s||(yn.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,f)},zoomOut:function(s,f){return s=s||(yn.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,f)},setZoomAround:function(s,f,x){var T=this.getZoomScale(f),K=this.getSize().divideBy(2),we=s instanceof ie?s:this.latLngToContainerPoint(s),ct=we.subtract(K).multiplyBy(1-1/T),Dt=this.containerPointToLatLng(K.add(ct));return this.setView(Dt,f,{zoom:x})},_getBoundsCenterZoom:function(s,f){f=f||{},s=s.getBounds?s.getBounds():B(s);var x=Te(f.paddingTopLeft||f.padding||[0,0]),T=Te(f.paddingBottomRight||f.padding||[0,0]),K=this.getBoundsZoom(s,!1,x.add(T));if(K=typeof f.maxZoom=="number"?Math.min(f.maxZoom,K):K,K===1/0)return{center:s.getCenter(),zoom:K};var we=T.subtract(x).divideBy(2),ct=this.project(s.getSouthWest(),K),Dt=this.project(s.getNorthEast(),K),$t=this.unproject(ct.add(Dt).divideBy(2).add(we),K);return{center:$t,zoom:K}},fitBounds:function(s,f){if(s=B(s),!s.isValid())throw new Error("Bounds are not valid.");var x=this._getBoundsCenterZoom(s,f);return this.setView(x.center,x.zoom,f)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,f){return this.setView(s,this._zoom,{pan:f})},panBy:function(s,f){if(s=Te(s).round(),f=f||{},!s.x&&!s.y)return this.fire("moveend");if(f.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new pl,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),f.noMoveStart||this.fire("movestart"),f.animate!==!1){dn(this._mapPane,"leaflet-pan-anim");var x=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,x,f.duration||.25,f.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,f,x){if(x=x||{},x.animate===!1||!yn.any3d)return this.setView(s,f,x);this._stop();var T=this.project(this.getCenter()),K=this.project(s),we=this.getSize(),ct=this._zoom;s=he(s),f=f===void 0?ct:f;var Dt=Math.max(we.x,we.y),$t=Dt*this.getZoomScale(ct,f),an=K.distanceTo(T)||1,Nn=1.42,Zn=Nn*Nn;function Ei(nr){var Ss=nr?-1:1,Ne=nr?$t:Dt,Vs=$t*$t-Dt*Dt+Ss*Zn*Zn*an*an,Il=2*Ne*Zn*an,ps=Vs/Il,Ti=Math.sqrt(ps*ps+1)-ps,nc=Ti<1e-9?-18:Math.log(Ti);return nc}function ns(nr){return(Math.exp(nr)-Math.exp(-nr))/2}function Or(nr){return(Math.exp(nr)+Math.exp(-nr))/2}function ds(nr){return ns(nr)/Or(nr)}var Tr=Ei(0);function Gs(nr){return Dt*(Or(Tr)/Or(Tr+Nn*nr))}function Bu(nr){return Dt*(Or(Tr)*ds(Tr+Nn*nr)-ns(Tr))/Zn}function Io(nr){return 1-Math.pow(1-nr,1.5)}var wo=Date.now(),ho=(Ei(1)-Tr)/Nn,Nc=x.duration?1e3*x.duration:1e3*ho*.8;function vl(){var nr=(Date.now()-wo)/Nc,Ss=Io(nr)*ho;nr<=1?(this._flyToFrame=G(vl,this),this._move(this.unproject(T.add(K.subtract(T).multiplyBy(Bu(Ss)/an)),ct),this.getScaleZoom(Dt/Gs(Ss),ct),{flyTo:!0})):this._move(s,f)._moveEnd(!0)}return this._moveStart(!0,x.noMoveStart),vl.call(this),this},flyToBounds:function(s,f){var x=this._getBoundsCenterZoom(s,f);return this.flyTo(x.center,x.zoom,f)},setMaxBounds:function(s){return s=B(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var f=this.options.minZoom;return this.options.minZoom=s,this._loaded&&f!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var f=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&f!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,f){this._enforcingBounds=!0;var x=this.getCenter(),T=this._limitCenter(x,this._zoom,B(s));return x.equals(T)||this.panTo(T,f),this._enforcingBounds=!1,this},panInside:function(s,f){f=f||{};var x=Te(f.paddingTopLeft||f.padding||[0,0]),T=Te(f.paddingBottomRight||f.padding||[0,0]),K=this.project(this.getCenter()),we=this.project(s),ct=this.getPixelBounds(),Dt=X([ct.min.add(x),ct.max.subtract(T)]),$t=Dt.getSize();if(!Dt.contains(we)){this._enforcingBounds=!0;var an=we.subtract(Dt.getCenter()),Nn=Dt.extend(we).getSize().subtract($t);K.x+=an.x<0?-Nn.x:Nn.x,K.y+=an.y<0?-Nn.y:Nn.y,this.panTo(this.unproject(K),f),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=r({animate:!1,pan:!0},s===!0?{animate:!0}:s);var f=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var x=this.getSize(),T=f.divideBy(2).round(),K=x.divideBy(2).round(),we=T.subtract(K);return!we.x&&!we.y?this:(s.animate&&s.pan?this.panBy(we):(s.pan&&this._rawPanBy(we),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:f,newSize:x}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=r({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var f=l(this._handleGeolocationResponse,this),x=l(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(f,x,s):navigator.geolocation.getCurrentPosition(f,x,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var f=s.code,x=s.message||(f===1?"permission denied":f===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:f,message:"Geolocation error: "+x+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var f=s.coords.latitude,x=s.coords.longitude,T=new W(f,x),K=T.toBounds(s.coords.accuracy*2),we=this._locateOptions;if(we.setView){var ct=this.getBoundsZoom(K);this.setView(T,we.maxZoom?Math.min(ct,we.maxZoom):ct)}var Dt={latlng:T,bounds:K,timestamp:s.timestamp};for(var $t in s.coords)typeof s.coords[$t]=="number"&&(Dt[$t]=s.coords[$t]);this.fire("locationfound",Dt)}},addHandler:function(s,f){if(!f)return this;var x=this[s]=new f(this);return this._handlers.push(x),this.options[s]&&x.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Wn(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(I(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)Wn(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,f){var x="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),T=li("div",x,f||this._mapPane);return s&&(this._panes[s]=T),T},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),f=this.unproject(s.getBottomLeft()),x=this.unproject(s.getTopRight());return new ke(f,x)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,f,x){s=B(s),x=Te(x||[0,0]);var T=this.getZoom()||0,K=this.getMinZoom(),we=this.getMaxZoom(),ct=s.getNorthWest(),Dt=s.getSouthEast(),$t=this.getSize().subtract(x),an=X(this.project(Dt,T),this.project(ct,T)).getSize(),Nn=yn.any3d?this.options.zoomSnap:1,Zn=$t.x/an.x,Ei=$t.y/an.y,ns=f?Math.max(Zn,Ei):Math.min(Zn,Ei);return T=this.getScaleZoom(ns,T),Nn&&(T=Math.round(T/(Nn/100))*(Nn/100),T=f?Math.ceil(T/Nn)*Nn:Math.floor(T/Nn)*Nn),Math.max(K,Math.min(we,T))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new ie(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,f){var x=this._getTopLeftPoint(s,f);return new ut(x,x.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,f){var x=this.options.crs;return f=f===void 0?this._zoom:f,x.scale(s)/x.scale(f)},getScaleZoom:function(s,f){var x=this.options.crs;f=f===void 0?this._zoom:f;var T=x.zoom(s*x.scale(f));return isNaN(T)?1/0:T},project:function(s,f){return f=f===void 0?this._zoom:f,this.options.crs.latLngToPoint(he(s),f)},unproject:function(s,f){return f=f===void 0?this._zoom:f,this.options.crs.pointToLatLng(Te(s),f)},layerPointToLatLng:function(s){var f=Te(s).add(this.getPixelOrigin());return this.unproject(f)},latLngToLayerPoint:function(s){var f=this.project(he(s))._round();return f._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(he(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(B(s))},distance:function(s,f){return this.options.crs.distance(he(s),he(f))},containerPointToLayerPoint:function(s){return Te(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return Te(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var f=this.containerPointToLayerPoint(Te(s));return this.layerPointToLatLng(f)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(he(s)))},mouseEventToContainerPoint:function(s){return au(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var f=this._container=hn(s);if(f){if(f._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");yi(f,"scroll",this._onScroll,this),this._containerId=p(f)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&yn.any3d,dn(s,"leaflet-container"+(yn.touch?" leaflet-touch":"")+(yn.retina?" leaflet-retina":"")+(yn.ielt9?" leaflet-oldie":"")+(yn.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var f=di(s,"position");f!=="absolute"&&f!=="relative"&&f!=="fixed"&&f!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Cr(this._mapPane,new ie(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(dn(s.markerPane,"leaflet-zoom-hide"),dn(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,f,x){Cr(this._mapPane,new ie(0,0));var T=!this._loaded;this._loaded=!0,f=this._limitZoom(f),this.fire("viewprereset");var K=this._zoom!==f;this._moveStart(K,x)._move(s,f)._moveEnd(K),this.fire("viewreset"),T&&this.fire("load")},_moveStart:function(s,f){return s&&this.fire("zoomstart"),f||this.fire("movestart"),this},_move:function(s,f,x,T){f===void 0&&(f=this._zoom);var K=this._zoom!==f;return this._zoom=f,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),T?x&&x.pinch&&this.fire("zoom",x):((K||x&&x.pinch)&&this.fire("zoom",x),this.fire("move",x)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return I(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){Cr(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[p(this._container)]=this;var f=s?Zi:yi;f(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&f(window,"resize",this._onResize,this),yn.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){I(this._resizeRequest),this._resizeRequest=G(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,f){for(var x=[],T,K=f==="mouseout"||f==="mouseover",we=s.target||s.srcElement,ct=!1;we;){if(T=this._targets[p(we)],T&&(f==="click"||f==="preclick")&&this._draggableMoved(T)){ct=!0;break}if(T&&T.listens(f,!0)&&(K&&!Ma(we,s)||(x.push(T),K))||we===this._container)break;we=we.parentNode}return!x.length&&!ct&&!K&&this.listens(f,!0)&&(x=[this]),x},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var f=s.target||s.srcElement;if(!(!this._loaded||f._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(f))){var x=s.type;x==="mousedown"&&Za(f),this._fireDOMEvent(s,x)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,f,x){if(s.type==="click"){var T=r({},s);T.type="preclick",this._fireDOMEvent(T,T.type,x)}var K=this._findEventTargets(s,f);if(x){for(var we=[],ct=0;ct<x.length;ct++)x[ct].listens(f,!0)&&we.push(x[ct]);K=we.concat(K)}if(K.length){f==="contextmenu"&&mi(s);var Dt=K[0],$t={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var an=Dt.getLatLng&&(!Dt._radius||Dt._radius<=10);$t.containerPoint=an?this.latLngToContainerPoint(Dt.getLatLng()):this.mouseEventToContainerPoint(s),$t.layerPoint=this.containerPointToLayerPoint($t.containerPoint),$t.latlng=an?Dt.getLatLng():this.layerPointToLatLng($t.layerPoint)}for(ct=0;ct<K.length;ct++)if(K[ct].fire(f,$t,!0),$t.originalEvent._stopped||K[ct].options.bubblingMouseEvents===!1&&Ee(this._mouseEvents,f)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,f=this._handlers.length;s<f;s++)this._handlers[s].disable()},whenReady:function(s,f){return this._loaded?s.call(f||this,{target:this}):this.on("load",s,f),this},_getMapPanePos:function(){return Ts(this._mapPane)||new ie(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,f){var x=s&&f!==void 0?this._getNewPixelOrigin(s,f):this.getPixelOrigin();return x.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,f){var x=this.getSize()._divideBy(2);return this.project(s,f)._subtract(x)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,f,x){var T=this._getNewPixelOrigin(x,f);return this.project(s,f)._subtract(T)},_latLngBoundsToNewLayerBounds:function(s,f,x){var T=this._getNewPixelOrigin(x,f);return X([this.project(s.getSouthWest(),f)._subtract(T),this.project(s.getNorthWest(),f)._subtract(T),this.project(s.getSouthEast(),f)._subtract(T),this.project(s.getNorthEast(),f)._subtract(T)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,f,x){if(!x)return s;var T=this.project(s,f),K=this.getSize().divideBy(2),we=new ut(T.subtract(K),T.add(K)),ct=this._getBoundsOffset(we,x,f);return Math.abs(ct.x)<=1&&Math.abs(ct.y)<=1?s:this.unproject(T.add(ct),f)},_limitOffset:function(s,f){if(!f)return s;var x=this.getPixelBounds(),T=new ut(x.min.add(s),x.max.add(s));return s.add(this._getBoundsOffset(T,f))},_getBoundsOffset:function(s,f,x){var T=X(this.project(f.getNorthEast(),x),this.project(f.getSouthWest(),x)),K=T.min.subtract(s.min),we=T.max.subtract(s.max),ct=this._rebound(K.x,-we.x),Dt=this._rebound(K.y,-we.y);return new ie(ct,Dt)},_rebound:function(s,f){return s+f>0?Math.round(s-f)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(f))},_limitZoom:function(s){var f=this.getMinZoom(),x=this.getMaxZoom(),T=yn.any3d?this.options.zoomSnap:1;return T&&(s=Math.round(s/T)*T),Math.max(f,Math.min(x,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){si(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,f){var x=this._getCenterOffset(s)._trunc();return(f&&f.animate)!==!0&&!this.getSize().contains(x)?!1:(this.panBy(x,f),!0)},_createAnimProxy:function(){var s=this._proxy=li("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(f){var x=Rr,T=this._proxy.style[x];Eo(this._proxy,this.project(f.center,f.zoom),this.getZoomScale(f.zoom,1)),T===this._proxy.style[x]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Wn(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),f=this.getZoom();Eo(this._proxy,this.project(s,f),this.getZoomScale(f,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,f,x){if(this._animatingZoom)return!0;if(x=x||{},!this._zoomAnimated||x.animate===!1||this._nothingToAnimate()||Math.abs(f-this._zoom)>this.options.zoomAnimationThreshold)return!1;var T=this.getZoomScale(f),K=this._getCenterOffset(s)._divideBy(1-1/T);return x.animate!==!0&&!this.getSize().contains(K)?!1:(G(function(){this._moveStart(!0,x.noMoveStart||!1)._animateZoom(s,f,!0)},this),!0)},_animateZoom:function(s,f,x,T){this._mapPane&&(x&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=f,dn(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:f,noUpdate:T}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&si(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function qr(s,f){return new Oi(s,f)}var Qn=$.extend({options:{position:"topright"},initialize:function(s){j(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var f=this._map;return f&&f.removeControl(this),this.options.position=s,f&&f.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var f=this._container=this.onAdd(s),x=this.getPosition(),T=s._controlCorners[x];return dn(f,"leaflet-control"),x.indexOf("bottom")!==-1?T.insertBefore(f,T.firstChild):T.appendChild(f),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Wn(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),Gr=function(s){return new Qn(s)};Oi.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},f="leaflet-",x=this._controlContainer=li("div",f+"control-container",this._container);function T(K,we){var ct=f+K+" "+f+we;s[K+we]=li("div",ct,x)}T("top","left"),T("top","right"),T("bottom","left"),T("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)Wn(this._controlCorners[s]);Wn(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Ta=Qn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,f,x,T){return x<T?-1:T<x?1:0}},initialize:function(s,f,x){j(this,x),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var T in s)this._addLayer(s[T],T);for(T in f)this._addLayer(f[T],T,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var f=0;f<this._layers.length;f++)this._layers[f].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return Qn.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,f){return this._addLayer(s,f),this._map?this._update():this},addOverlay:function(s,f){return this._addLayer(s,f,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var f=this._getLayer(p(s));return f&&this._layers.splice(this._layers.indexOf(f),1),this._map?this._update():this},expand:function(){dn(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(dn(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):si(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return si(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",f=this._container=li("div",s),x=this.options.collapsed;f.setAttribute("aria-haspopup",!0),Ka(f),Dl(f);var T=this._section=li("section",s+"-list");x&&(this._map.on("click",this.collapse,this),yi(f,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var K=this._layersLink=li("a",s+"-toggle",f);K.href="#",K.title="Layers",K.setAttribute("role","button"),yi(K,{keydown:function(we){we.keyCode===13&&this._expandSafely()},click:function(we){mi(we),this._expandSafely()}},this),x||this.expand(),this._baseLayersList=li("div",s+"-base",T),this._separator=li("div",s+"-separator",T),this._overlaysList=li("div",s+"-overlays",T),f.appendChild(T)},_getLayer:function(s){for(var f=0;f<this._layers.length;f++)if(this._layers[f]&&p(this._layers[f].layer)===s)return this._layers[f]},_addLayer:function(s,f,x){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:f,overlay:x}),this.options.sortLayers&&this._layers.sort(l(function(T,K){return this.options.sortFunction(T.layer,K.layer,T.name,K.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;as(this._baseLayersList),as(this._overlaysList),this._layerControlInputs=[];var s,f,x,T,K=0;for(x=0;x<this._layers.length;x++)T=this._layers[x],this._addItem(T),f=f||T.overlay,s=s||!T.overlay,K+=T.overlay?0:1;return this.options.hideSingleBase&&(s=s&&K>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=f&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var f=this._getLayer(p(s.target)),x=f.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;x&&this._map.fire(x,f)},_createRadioElement:function(s,f){var x='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(f?' checked="checked"':"")+"/>",T=document.createElement("div");return T.innerHTML=x,T.firstChild},_addItem:function(s){var f=document.createElement("label"),x=this._map.hasLayer(s.layer),T;s.overlay?(T=document.createElement("input"),T.type="checkbox",T.className="leaflet-control-layers-selector",T.defaultChecked=x):T=this._createRadioElement("leaflet-base-layers_"+p(this),x),this._layerControlInputs.push(T),T.layerId=p(s.layer),yi(T,"click",this._onInputClick,this);var K=document.createElement("span");K.innerHTML=" "+s.name;var we=document.createElement("span");f.appendChild(we),we.appendChild(T),we.appendChild(K);var ct=s.overlay?this._overlaysList:this._baseLayersList;return ct.appendChild(f),this._checkDisabledLayers(),f},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,f,x,T=[],K=[];this._handlingClick=!0;for(var we=s.length-1;we>=0;we--)f=s[we],x=this._getLayer(f.layerId).layer,f.checked?T.push(x):f.checked||K.push(x);for(we=0;we<K.length;we++)this._map.hasLayer(K[we])&&this._map.removeLayer(K[we]);for(we=0;we<T.length;we++)this._map.hasLayer(T[we])||this._map.addLayer(T[we]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,f,x,T=this._map.getZoom(),K=s.length-1;K>=0;K--)f=s[K],x=this._getLayer(f.layerId).layer,f.disabled=x.options.minZoom!==void 0&&T<x.options.minZoom||x.options.maxZoom!==void 0&&T>x.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,yi(s,"click",mi),this.expand();var f=this;setTimeout(function(){Zi(s,"click",mi),f._preventClick=!1})}}),Vo=function(s,f,x){return new Ta(s,f,x)},Ar=Qn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var f="leaflet-control-zoom",x=li("div",f+" leaflet-bar"),T=this.options;return this._zoomInButton=this._createButton(T.zoomInText,T.zoomInTitle,f+"-in",x,this._zoomIn),this._zoomOutButton=this._createButton(T.zoomOutText,T.zoomOutTitle,f+"-out",x,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),x},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,f,x,T,K){var we=li("a",x,T);return we.innerHTML=s,we.href="#",we.title=f,we.setAttribute("role","button"),we.setAttribute("aria-label",f),Ka(we),yi(we,"click",Bi),yi(we,"click",K,this),yi(we,"click",this._refocusOnMap,this),we},_updateDisabled:function(){var s=this._map,f="leaflet-disabled";si(this._zoomInButton,f),si(this._zoomOutButton,f),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(dn(this._zoomOutButton,f),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(dn(this._zoomInButton,f),this._zoomInButton.setAttribute("aria-disabled","true"))}});Oi.mergeOptions({zoomControl:!0}),Oi.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Ar,this.addControl(this.zoomControl))});var gl=function(s){return new Ar(s)},Ao=Qn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var f="leaflet-control-scale",x=li("div",f),T=this.options;return this._addScales(T,f+"-line",x),s.on(T.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),x},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,f,x){s.metric&&(this._mScale=li("div",f,x)),s.imperial&&(this._iScale=li("div",f,x))},_update:function(){var s=this._map,f=s.getSize().y/2,x=s.distance(s.containerPointToLatLng([0,f]),s.containerPointToLatLng([this.options.maxWidth,f]));this._updateScales(x)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var f=this._getRoundNum(s),x=f<1e3?f+" m":f/1e3+" km";this._updateScale(this._mScale,x,f/s)},_updateImperial:function(s){var f=s*3.2808399,x,T,K;f>5280?(x=f/5280,T=this._getRoundNum(x),this._updateScale(this._iScale,T+" mi",T/x)):(K=this._getRoundNum(f),this._updateScale(this._iScale,K+" ft",K/f))},_updateScale:function(s,f,x){s.style.width=Math.round(this.options.maxWidth*x)+"px",s.innerHTML=f},_getRoundNum:function(s){var f=Math.pow(10,(Math.floor(s)+"").length-1),x=s/f;return x=x>=10?10:x>=5?5:x>=3?3:x>=2?2:1,f*x}}),Xa=function(s){return new Ao(s)},Qa='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',uo=Qn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(yn.inlineSvg?Qa+" ":"")+"Leaflet</a>"},initialize:function(s){j(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=li("div","leaflet-control-attribution"),Ka(this._container);for(var f in s._layers)s._layers[f].getAttribution&&this.addAttribution(s._layers[f].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var f in this._attributions)this._attributions[f]&&s.push(f);var x=[];this.options.prefix&&x.push(this.options.prefix),s.length&&x.push(s.join(", ")),this._container.innerHTML=x.join(' <span aria-hidden="true">|</span> ')}}});Oi.mergeOptions({attributionControl:!0}),Oi.addInitHook(function(){this.options.attributionControl&&new uo().addTo(this)});var el=function(s){return new uo(s)};Qn.Layers=Ta,Qn.Zoom=Ar,Qn.Scale=Ao,Qn.Attribution=uo,Gr.layers=Vo,Gr.zoom=gl,Gr.scale=Xa,Gr.attribution=el;var or=$.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});or.addTo=function(s,f){return s.addHandler(f,this),this};var lu={Events:Z},ls=yn.touch?"touchstart mousedown":"mousedown",mo=se.extend({options:{clickTolerance:3},initialize:function(s,f,x,T){j(this,T),this._element=s,this._dragStartTarget=f||s,this._preventOutline=x},enable:function(){this._enabled||(yi(this._dragStartTarget,ls,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(mo._dragging===this&&this.finishDrag(),Zi(this._dragStartTarget,ls,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!ao(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){mo._dragging===this&&this.finishDrag();return}if(!(mo._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(mo._dragging=this,this._preventOutline&&Za(this._element),vs(),lo(),!this._moving)){this.fire("down");var f=s.touches?s.touches[0]:s,x=ou(this._element);this._startPoint=new ie(f.clientX,f.clientY),this._startPos=Ts(this._element),this._parentScale=fl(x);var T=s.type==="mousedown";yi(document,T?"mousemove":"touchmove",this._onMove,this),yi(document,T?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var f=s.touches&&s.touches.length===1?s.touches[0]:s,x=new ie(f.clientX,f.clientY)._subtract(this._startPoint);!x.x&&!x.y||Math.abs(x.x)+Math.abs(x.y)<this.options.clickTolerance||(x.x/=this._parentScale.x,x.y/=this._parentScale.y,mi(s),this._moved||(this.fire("dragstart"),this._moved=!0,dn(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),dn(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(x),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),Cr(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){si(document.body,"leaflet-dragging"),this._lastTarget&&(si(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Zi(document,"mousemove touchmove",this._onMove,this),Zi(document,"mouseup touchend touchcancel",this._onUp,this),fo(),Bs();var f=this._moved&&this._moving;this._moving=!1,mo._dragging=!1,f&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function tl(s,f,x){var T,K=[1,4,2,8],we,ct,Dt,$t,an,Nn,Zn,Ei;for(we=0,Nn=s.length;we<Nn;we++)s[we]._code=Ut(s[we],f);for(Dt=0;Dt<4;Dt++){for(Zn=K[Dt],T=[],we=0,Nn=s.length,ct=Nn-1;we<Nn;ct=we++)$t=s[we],an=s[ct],$t._code&Zn?an._code&Zn||(Ei=kt(an,$t,Zn,f,x),Ei._code=Ut(Ei,f),T.push(Ei)):(an._code&Zn&&(Ei=kt(an,$t,Zn,f,x),Ei._code=Ut(Ei,f),T.push(Ei)),T.push($t));s=T}return s}function vo(s,f){var x,T,K,we,ct,Dt,$t,an,Nn;if(!s||s.length===0)throw new Error("latlngs not passed");Rn(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var Zn=he([0,0]),Ei=B(s),ns=Ei.getNorthWest().distanceTo(Ei.getSouthWest())*Ei.getNorthEast().distanceTo(Ei.getNorthWest());ns<1700&&(Zn=Ba(s));var Or=s.length,ds=[];for(x=0;x<Or;x++){var Tr=he(s[x]);ds.push(f.project(he([Tr.lat-Zn.lat,Tr.lng-Zn.lng])))}for(Dt=$t=an=0,x=0,T=Or-1;x<Or;T=x++)K=ds[x],we=ds[T],ct=K.y*we.x-we.y*K.x,$t+=(K.x+we.x)*ct,an+=(K.y+we.y)*ct,Dt+=ct*3;Dt===0?Nn=ds[0]:Nn=[$t/Dt,an/Dt];var Gs=f.unproject(Te(Nn));return he([Gs.lat+Zn.lat,Gs.lng+Zn.lng])}function Ba(s){for(var f=0,x=0,T=0,K=0;K<s.length;K++){var we=he(s[K]);f+=we.lat,x+=we.lng,T++}return he([f/T,x/T])}var Na={__proto__:null,clipPolygon:tl,polygonCenter:vo,centroid:Ba};function ar(s,f){if(!f||!s.length)return s.slice();var x=f*f;return s=ge(s,x),s=Vr(s,x),s}function to(s,f,x){return Math.sqrt(Bn(s,f,x,!0))}function Ho(s,f,x){return Bn(s,f,x)}function Vr(s,f){var x=s.length,T=typeof Uint8Array<"u"?Uint8Array:Array,K=new T(x);K[0]=K[x-1]=1,k(s,K,f,0,x-1);var we,ct=[];for(we=0;we<x;we++)K[we]&&ct.push(s[we]);return ct}function k(s,f,x,T,K){var we=0,ct,Dt,$t;for(Dt=T+1;Dt<=K-1;Dt++)$t=Bn(s[Dt],s[T],s[K],!0),$t>we&&(ct=Dt,we=$t);we>x&&(f[ct]=1,k(s,f,x,T,ct),k(s,f,x,ct,K))}function ge(s,f){for(var x=[s[0]],T=1,K=0,we=s.length;T<we;T++)cn(s[T],s[K])>f&&(x.push(s[T]),K=T);return K<we-1&&x.push(s[we-1]),x}var Je;function dt(s,f,x,T,K){var we=T?Je:Ut(s,x),ct=Ut(f,x),Dt,$t,an;for(Je=ct;;){if(!(we|ct))return[s,f];if(we&ct)return!1;Dt=we||ct,$t=kt(s,f,Dt,x,K),an=Ut($t,x),Dt===we?(s=$t,we=an):(f=$t,ct=an)}}function kt(s,f,x,T,K){var we=f.x-s.x,ct=f.y-s.y,Dt=T.min,$t=T.max,an,Nn;return x&8?(an=s.x+we*($t.y-s.y)/ct,Nn=$t.y):x&4?(an=s.x+we*(Dt.y-s.y)/ct,Nn=Dt.y):x&2?(an=$t.x,Nn=s.y+ct*($t.x-s.x)/we):x&1&&(an=Dt.x,Nn=s.y+ct*(Dt.x-s.x)/we),new ie(an,Nn,K)}function Ut(s,f){var x=0;return s.x<f.min.x?x|=1:s.x>f.max.x&&(x|=2),s.y<f.min.y?x|=4:s.y>f.max.y&&(x|=8),x}function cn(s,f){var x=f.x-s.x,T=f.y-s.y;return x*x+T*T}function Bn(s,f,x,T){var K=f.x,we=f.y,ct=x.x-K,Dt=x.y-we,$t=ct*ct+Dt*Dt,an;return $t>0&&(an=((s.x-K)*ct+(s.y-we)*Dt)/$t,an>1?(K=x.x,we=x.y):an>0&&(K+=ct*an,we+=Dt*an)),ct=s.x-K,Dt=s.y-we,T?ct*ct+Dt*Dt:new ie(K,we)}function Rn(s){return!pe(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function Yn(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Rn(s)}function ci(s,f){var x,T,K,we,ct,Dt,$t,an;if(!s||s.length===0)throw new Error("latlngs not passed");Rn(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var Nn=he([0,0]),Zn=B(s),Ei=Zn.getNorthWest().distanceTo(Zn.getSouthWest())*Zn.getNorthEast().distanceTo(Zn.getNorthWest());Ei<1700&&(Nn=Ba(s));var ns=s.length,Or=[];for(x=0;x<ns;x++){var ds=he(s[x]);Or.push(f.project(he([ds.lat-Nn.lat,ds.lng-Nn.lng])))}for(x=0,T=0;x<ns-1;x++)T+=Or[x].distanceTo(Or[x+1])/2;if(T===0)an=Or[0];else for(x=0,we=0;x<ns-1;x++)if(ct=Or[x],Dt=Or[x+1],K=ct.distanceTo(Dt),we+=K,we>T){$t=(we-T)/K,an=[Dt.x-$t*(Dt.x-ct.x),Dt.y-$t*(Dt.y-ct.y)];break}var Tr=f.unproject(Te(an));return he([Tr.lat+Nn.lat,Tr.lng+Nn.lng])}var ki={__proto__:null,simplify:ar,pointToSegmentDistance:to,closestPointOnSegment:Ho,clipSegment:dt,_getEdgeIntersection:kt,_getBitCode:Ut,_sqClosestPointOnSegment:Bn,isFlat:Rn,_flat:Yn,polylineCenter:ci},Sr={project:function(s){return new ie(s.lng,s.lat)},unproject:function(s){return new W(s.y,s.x)},bounds:new ut([-180,-90],[180,90])},er={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ut([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var f=Math.PI/180,x=this.R,T=s.lat*f,K=this.R_MINOR/x,we=Math.sqrt(1-K*K),ct=we*Math.sin(T),Dt=Math.tan(Math.PI/4-T/2)/Math.pow((1-ct)/(1+ct),we/2);return T=-x*Math.log(Math.max(Dt,1e-10)),new ie(s.lng*f*x,T)},unproject:function(s){for(var f=180/Math.PI,x=this.R,T=this.R_MINOR/x,K=Math.sqrt(1-T*T),we=Math.exp(-s.y/x),ct=Math.PI/2-2*Math.atan(we),Dt=0,$t=.1,an;Dt<15&&Math.abs($t)>1e-7;Dt++)an=K*Math.sin(ct),an=Math.pow((1-an)/(1+an),K/2),$t=Math.PI/2-2*Math.atan(we*an)-ct,ct+=$t;return new W(ct*f,s.x*f/x)}},lr={__proto__:null,LonLat:Sr,Mercator:er,SphericalMercator:oe},Hr=r({},re,{code:"EPSG:3395",projection:er,transformation:function(){var s=.5/(Math.PI*er.R);return te(s,.5,-s,.5)}()}),Qr=r({},re,{code:"EPSG:4326",projection:Sr,transformation:te(1/180,1,-1/180,.5)}),no=r({},ne,{projection:Sr,transformation:te(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,f){var x=f.lng-s.lng,T=f.lat-s.lat;return Math.sqrt(x*x+T*T)},infinite:!0});ne.Earth=re,ne.EPSG3395=Hr,ne.EPSG3857=ae,ne.EPSG900913=Le,ne.EPSG4326=Qr,ne.Simple=no;var Mi=se.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[p(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[p(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var f=s.target;if(f.hasLayer(this)){if(this._map=f,this._zoomAnimated=f._zoomAnimated,this.getEvents){var x=this.getEvents();f.on(x,this),this.once("remove",function(){f.off(x,this)},this)}this.onAdd(f),this.fire("add"),f.fire("layeradd",{layer:this})}}});Oi.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var f=p(s);return this._layers[f]?this:(this._layers[f]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var f=p(s);return this._layers[f]?(this._loaded&&s.onRemove(this),delete this._layers[f],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return p(s)in this._layers},eachLayer:function(s,f){for(var x in this._layers)s.call(f,this._layers[x]);return this},_addLayers:function(s){s=s?pe(s)?s:[s]:[];for(var f=0,x=s.length;f<x;f++)this.addLayer(s[f])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[p(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var f=p(s);this._zoomBoundLayers[f]&&(delete this._zoomBoundLayers[f],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,f=-1/0,x=this._getZoomSpan();for(var T in this._zoomBoundLayers){var K=this._zoomBoundLayers[T].options;s=K.minZoom===void 0?s:Math.min(s,K.minZoom),f=K.maxZoom===void 0?f:Math.max(f,K.maxZoom)}this._layersMaxZoom=f===-1/0?void 0:f,this._layersMinZoom=s===1/0?void 0:s,x!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var ys=Mi.extend({initialize:function(s,f){j(this,f),this._layers={};var x,T;if(s)for(x=0,T=s.length;x<T;x++)this.addLayer(s[x])},addLayer:function(s){var f=this.getLayerId(s);return this._layers[f]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var f=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[f]&&this._map.removeLayer(this._layers[f]),delete this._layers[f],this},hasLayer:function(s){var f=typeof s=="number"?s:this.getLayerId(s);return f in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var f=Array.prototype.slice.call(arguments,1),x,T;for(x in this._layers)T=this._layers[x],T[s]&&T[s].apply(T,f);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,f){for(var x in this._layers)s.call(f,this._layers[x]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return p(s)}}),Da=function(s,f){return new ys(s,f)},Ns=ys.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),ys.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),ys.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new ke;for(var f in this._layers){var x=this._layers[f];s.extend(x.getBounds?x.getBounds():x.getLatLng())}return s}}),ml=function(s,f){return new Ns(s,f)},ko=$.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){j(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,f){var x=this._getIconUrl(s);if(!x){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var T=this._createImg(x,f&&f.tagName==="IMG"?f:null);return this._setIconStyles(T,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(T.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),T},_setIconStyles:function(s,f){var x=this.options,T=x[f+"Size"];typeof T=="number"&&(T=[T,T]);var K=Te(T),we=Te(f==="shadow"&&x.shadowAnchor||x.iconAnchor||K&&K.divideBy(2,!0));s.className="leaflet-marker-"+f+" "+(x.className||""),we&&(s.style.marginLeft=-we.x+"px",s.style.marginTop=-we.y+"px"),K&&(s.style.width=K.x+"px",s.style.height=K.y+"px")},_createImg:function(s,f){return f=f||document.createElement("img"),f.src=s,f},_getIconUrl:function(s){return yn.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function Rl(s){return new ko(s)}var da=ko.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof da.imagePath!="string"&&(da.imagePath=this._detectIconPath()),(this.options.imagePath||da.imagePath)+ko.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var f=function(x,T,K){var we=T.exec(x);return we&&we[K]};return s=f(s,/^url\((['"])?(.+)\1\)$/,2),s&&f(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=li("div","leaflet-default-icon-path",document.body),f=di(s,"background-image")||di(s,"backgroundImage");if(document.body.removeChild(s),f=this._stripUrl(f),f)return f;var x=document.querySelector('link[href$="leaflet.css"]');return x?x.href.substring(0,x.href.length-11-1):""}}),pa=or.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new mo(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),dn(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&si(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var f=this._marker,x=f._map,T=this._marker.options.autoPanSpeed,K=this._marker.options.autoPanPadding,we=Ts(f._icon),ct=x.getPixelBounds(),Dt=x.getPixelOrigin(),$t=X(ct.min._subtract(Dt).add(K),ct.max._subtract(Dt).subtract(K));if(!$t.contains(we)){var an=Te((Math.max($t.max.x,we.x)-$t.max.x)/(ct.max.x-$t.max.x)-(Math.min($t.min.x,we.x)-$t.min.x)/(ct.min.x-$t.min.x),(Math.max($t.max.y,we.y)-$t.max.y)/(ct.max.y-$t.max.y)-(Math.min($t.min.y,we.y)-$t.min.y)/(ct.min.y-$t.min.y)).multiplyBy(T);x.panBy(an,{animate:!1}),this._draggable._newPos._add(an),this._draggable._startPos._add(an),Cr(f._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=G(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(I(this._panRequest),this._panRequest=G(this._adjustPan.bind(this,s)))},_onDrag:function(s){var f=this._marker,x=f._shadow,T=Ts(f._icon),K=f._map.layerPointToLatLng(T);x&&Cr(x,T),f._latlng=K,s.latlng=K,s.oldLatLng=this._oldLatLng,f.fire("move",s).fire("drag",s)},_onDragEnd:function(s){I(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),es=Mi.extend({options:{icon:new da,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,f){j(this,f),this._latlng=he(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var f=this._latlng;return this._latlng=he(s),this.update(),this.fire("move",{oldLatLng:f,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,f="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),x=s.icon.createIcon(this._icon),T=!1;x!==this._icon&&(this._icon&&this._removeIcon(),T=!0,s.title&&(x.title=s.title),x.tagName==="IMG"&&(x.alt=s.alt||"")),dn(x,f),s.keyboard&&(x.tabIndex="0",x.setAttribute("role","button")),this._icon=x,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&yi(x,"focus",this._panOnFocus,this);var K=s.icon.createShadow(this._shadow),we=!1;K!==this._shadow&&(this._removeShadow(),we=!0),K&&(dn(K,f),K.alt=""),this._shadow=K,s.opacity<1&&this._updateOpacity(),T&&this.getPane().appendChild(this._icon),this._initInteraction(),K&&we&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Zi(this._icon,"focus",this._panOnFocus,this),Wn(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Wn(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&Cr(this._icon,s),this._shadow&&Cr(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){if(console.log("[DEBUG] _animateZoom - Starting animation with params:",{hasMap:!!this._map,hasLatLng:!!this._latlng,zoomLevel:s.zoom,centerPoint:s.center}),!this._map){console.error("[DEBUG] _animateZoom - Map is null");return}if(!this._latlng){console.error("[DEBUG] _animateZoom - LatLng is null");return}try{var f=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);console.log("[DEBUG] _animateZoom - New position calculated:",f),this._setPos(f)}catch(x){console.error("[DEBUG] _animateZoom - Error during animation:",x,{mapState:this._map,latlng:this._latlng,zoom:s.zoom,center:s.center})}},_initInteraction:function(){if(this.options.interactive&&(dn(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),pa)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new pa(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&Lr(this._icon,s),this._shadow&&Lr(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var f=this.options.icon.options,x=f.iconSize?Te(f.iconSize):Te(0,0),T=f.iconAnchor?Te(f.iconAnchor):Te(0,0);s.panInside(this._latlng,{paddingTopLeft:T,paddingBottomRight:x.subtract(T)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Mo(s,f){return new es(s,f)}var io=Mi.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return j(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Us=io.extend({options:{fill:!0,radius:10},initialize:function(s,f){j(this,f),this._latlng=he(s),this._radius=this.options.radius},setLatLng:function(s){var f=this._latlng;return this._latlng=he(s),this.redraw(),this.fire("move",{oldLatLng:f,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var f=s&&s.radius||this._radius;return io.prototype.setStyle.call(this,s),this.setRadius(f),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,f=this._radiusY||s,x=this._clickTolerance(),T=[s+x,f+x];this._pxBounds=new ut(this._point.subtract(T),this._point.add(T))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Ra(s,f){return new Us(s,f)}var _s=Us.extend({initialize:function(s,f,x){if(typeof f=="number"&&(f=r({},x,{radius:f})),j(this,f),this._latlng=he(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new ke(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:io.prototype.setStyle,_project:function(){var s=this._latlng.lng,f=this._latlng.lat,x=this._map,T=x.options.crs;if(T.distance===re.distance){var K=Math.PI/180,we=this._mRadius/re.R/K,ct=x.project([f+we,s]),Dt=x.project([f-we,s]),$t=ct.add(Dt).divideBy(2),an=x.unproject($t).lat,Nn=Math.acos((Math.cos(we*K)-Math.sin(f*K)*Math.sin(an*K))/(Math.cos(f*K)*Math.cos(an*K)))/K;(isNaN(Nn)||Nn===0)&&(Nn=we/Math.cos(Math.PI/180*f)),this._point=$t.subtract(x.getPixelOrigin()),this._radius=isNaN(Nn)?0:$t.x-x.project([an,s-Nn]).x,this._radiusY=$t.y-ct.y}else{var Zn=T.unproject(T.project(this._latlng).subtract([this._mRadius,0]));this._point=x.latLngToLayerPoint(this._latlng),this._radius=this._point.x-x.latLngToLayerPoint(Zn).x}this._updateBounds()}});function Ds(s,f,x){return new _s(s,f,x)}var Rs=io.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,f){j(this,f),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var f=1/0,x=null,T=Bn,K,we,ct=0,Dt=this._parts.length;ct<Dt;ct++)for(var $t=this._parts[ct],an=1,Nn=$t.length;an<Nn;an++){K=$t[an-1],we=$t[an];var Zn=T(s,K,we,!0);Zn<f&&(f=Zn,x=T(s,K,we))}return x&&(x.distance=Math.sqrt(f)),x},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ci(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,f){return f=f||this._defaultShape(),s=he(s),f.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new ke,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return Rn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var f=[],x=Rn(s),T=0,K=s.length;T<K;T++)x?(f[T]=he(s[T]),this._bounds.extend(f[T])):f[T]=this._convertLatLngs(s[T]);return f},_project:function(){var s=new ut;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),f=new ie(s,s);this._rawPxBounds&&(this._pxBounds=new ut([this._rawPxBounds.min.subtract(f),this._rawPxBounds.max.add(f)]))},_projectLatlngs:function(s,f,x){var T=s[0]instanceof W,K=s.length,we,ct;if(T){for(ct=[],we=0;we<K;we++)ct[we]=this._map.latLngToLayerPoint(s[we]),x.extend(ct[we]);f.push(ct)}else for(we=0;we<K;we++)this._projectLatlngs(s[we],f,x)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var f=this._parts,x,T,K,we,ct,Dt,$t;for(x=0,K=0,we=this._rings.length;x<we;x++)for($t=this._rings[x],T=0,ct=$t.length;T<ct-1;T++)Dt=dt($t[T],$t[T+1],s,T,!0),Dt&&(f[K]=f[K]||[],f[K].push(Dt[0]),(Dt[1]!==$t[T+1]||T===ct-2)&&(f[K].push(Dt[1]),K++))}},_simplifyPoints:function(){for(var s=this._parts,f=this.options.smoothFactor,x=0,T=s.length;x<T;x++)s[x]=ar(s[x],f)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,f){var x,T,K,we,ct,Dt,$t=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(x=0,we=this._parts.length;x<we;x++)for(Dt=this._parts[x],T=0,ct=Dt.length,K=ct-1;T<ct;K=T++)if(!(!f&&T===0)&&to(s,Dt[K],Dt[T])<=$t)return!0;return!1}});function uu(s,f){return new Rs(s,f)}Rs._flat=Yn;var ss=Rs.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return vo(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var f=Rs.prototype._convertLatLngs.call(this,s),x=f.length;return x>=2&&f[0]instanceof W&&f[0].equals(f[x-1])&&f.pop(),f},_setLatLngs:function(s){Rs.prototype._setLatLngs.call(this,s),Rn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Rn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,f=this.options.weight,x=new ie(f,f);if(s=new ut(s.min.subtract(x),s.max.add(x)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var T=0,K=this._rings.length,we;T<K;T++)we=tl(this._rings[T],s,!0),we.length&&this._parts.push(we)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var f=!1,x,T,K,we,ct,Dt,$t,an;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(we=0,$t=this._parts.length;we<$t;we++)for(x=this._parts[we],ct=0,an=x.length,Dt=an-1;ct<an;Dt=ct++)T=x[ct],K=x[Dt],T.y>s.y!=K.y>s.y&&s.x<(K.x-T.x)*(s.y-T.y)/(K.y-T.y)+T.x&&(f=!f);return f||Rs.prototype._containsPoint.call(this,s,!0)}});function Wo(s,f){return new ss(s,f)}var bs=Ns.extend({initialize:function(s,f){j(this,f),this._layers={},s&&this.addData(s)},addData:function(s){var f=pe(s)?s:s.features,x,T,K;if(f){for(x=0,T=f.length;x<T;x++)K=f[x],(K.geometries||K.geometry||K.features||K.coordinates)&&this.addData(K);return this}var we=this.options;if(we.filter&&!we.filter(s))return this;var ct=ws(s,we);return ct?(ct.feature=Ls(s),ct.defaultOptions=ct.options,this.resetStyle(ct),we.onEachFeature&&we.onEachFeature(s,ct),this.addLayer(ct)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=r({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(f){this._setLayerStyle(f,s)},this)},_setLayerStyle:function(s,f){s.setStyle&&(typeof f=="function"&&(f=f(s.feature)),s.setStyle(f))}});function ws(s,f){var x=s.type==="Feature"?s.geometry:s,T=x?x.coordinates:null,K=[],we=f&&f.pointToLayer,ct=f&&f.coordsToLatLng||Ko,Dt,$t,an,Nn;if(!T&&!x)return null;switch(x.type){case"Point":return Dt=ct(T),Zo(we,s,Dt,f);case"MultiPoint":for(an=0,Nn=T.length;an<Nn;an++)Dt=ct(T[an]),K.push(Zo(we,s,Dt,f));return new Ns(K);case"LineString":case"MultiLineString":return $t=xs(T,x.type==="LineString"?0:1,ct),new Rs($t,f);case"Polygon":case"MultiPolygon":return $t=xs(T,x.type==="Polygon"?1:2,ct),new ss($t,f);case"GeometryCollection":for(an=0,Nn=x.geometries.length;an<Nn;an++){var Zn=ws({geometry:x.geometries[an],type:"Feature",properties:s.properties},f);Zn&&K.push(Zn)}return new Ns(K);case"FeatureCollection":for(an=0,Nn=x.features.length;an<Nn;an++){var Ei=ws(x.features[an],f);Ei&&K.push(Ei)}return new Ns(K);default:throw new Error("Invalid GeoJSON object.")}}function Zo(s,f,x,T){return s?s(f,x):new es(x,T&&T.markersInheritOptions&&T)}function Ko(s){return new W(s[1],s[0],s[2])}function xs(s,f,x){for(var T=[],K=0,we=s.length,ct;K<we;K++)ct=f?xs(s[K],f-1,x):(x||Ko)(s[K]),T.push(ct);return T}function us(s,f){return s=he(s),s.alt!==void 0?[E(s.lng,f),E(s.lat,f),E(s.alt,f)]:[E(s.lng,f),E(s.lat,f)]}function To(s,f,x,T){for(var K=[],we=0,ct=s.length;we<ct;we++)K.push(f?To(s[we],Rn(s[we])?0:f-1,x,T):us(s[we],T));return!f&&x&&K.length>0&&K.push(K[0].slice()),K}function ro(s,f){return s.feature?r({},s.feature,{geometry:f}):Ls(f)}function Ls(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var Ct={toGeoJSON:function(s){return ro(this,{type:"Point",coordinates:us(this.getLatLng(),s)})}};es.include(Ct),_s.include(Ct),Us.include(Ct),Rs.include({toGeoJSON:function(s){var f=!Rn(this._latlngs),x=To(this._latlngs,f?1:0,!1,s);return ro(this,{type:(f?"Multi":"")+"LineString",coordinates:x})}}),ss.include({toGeoJSON:function(s){var f=!Rn(this._latlngs),x=f&&!Rn(this._latlngs[0]),T=To(this._latlngs,x?2:f?1:0,!0,s);return f||(T=[T]),ro(this,{type:(x?"Multi":"")+"Polygon",coordinates:T})}}),ys.include({toMultiPoint:function(s){var f=[];return this.eachLayer(function(x){f.push(x.toGeoJSON(s).geometry.coordinates)}),ro(this,{type:"MultiPoint",coordinates:f})},toGeoJSON:function(s){var f=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(f==="MultiPoint")return this.toMultiPoint(s);var x=f==="GeometryCollection",T=[];return this.eachLayer(function(K){if(K.toGeoJSON){var we=K.toGeoJSON(s);if(x)T.push(we.geometry);else{var ct=Ls(we);ct.type==="FeatureCollection"?T.push.apply(T,ct.features):T.push(ct)}}}),x?ro(this,{geometries:T,type:"GeometryCollection"}):{type:"FeatureCollection",features:T}}});function Zt(s,f){return new bs(s,f)}var Rt=Zt,Mn=Mi.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,f,x){this._url=s,this._bounds=B(f),j(this,x)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(dn(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Wn(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&Ms(this._image),this},bringToBack:function(){return this._map&&jr(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=B(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",f=this._image=s?this._url:li("img");if(dn(f,"leaflet-image-layer"),this._zoomAnimated&&dn(f,"leaflet-zoom-animated"),this.options.className&&dn(f,this.options.className),f.onselectstart=w,f.onmousemove=w,f.onload=l(this.fire,this,"load"),f.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(f.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=f.src;return}f.src=this._url,f.alt=this.options.alt},_animateZoom:function(s){if(console.log("[DEBUG] _animateZoom - Starting animation with params:",{hasMap:!!this._map,hasLatLng:!!this._latlng,zoomLevel:s.zoom,centerPoint:s.center}),!this._map){console.error("[DEBUG] _animateZoom - Map is null");return}if(!this._latlng){console.error("[DEBUG] _animateZoom - LatLng is null");return}try{var f=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);console.log("[DEBUG] _animateZoom - New position calculated:",f),this._setPos(f)}catch(x){console.error("[DEBUG] _animateZoom - Error during animation:",x,{mapState:this._map,latlng:this._latlng,zoom:s.zoom,center:s.center})}},_reset:function(){var s=this._image,f=new ut(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),x=f.getSize();Cr(s,f.min),s.style.width=x.x+"px",s.style.height=x.y+"px"},_updateOpacity:function(){Lr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),qn=function(s,f,x){return new Mn(s,f,x)},gi=Mn.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",f=this._image=s?this._url:li("video");if(dn(f,"leaflet-image-layer"),this._zoomAnimated&&dn(f,"leaflet-zoom-animated"),this.options.className&&dn(f,this.options.className),f.onselectstart=w,f.onmousemove=w,f.onloadeddata=l(this.fire,this,"load"),s){for(var x=f.getElementsByTagName("source"),T=[],K=0;K<x.length;K++)T.push(x[K].src);this._url=x.length>0?T:[f.src];return}pe(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(f.style,"objectFit")&&(f.style.objectFit="fill"),f.autoplay=!!this.options.autoplay,f.loop=!!this.options.loop,f.muted=!!this.options.muted,f.playsInline=!!this.options.playsInline;for(var we=0;we<this._url.length;we++){var ct=li("source");ct.src=this._url[we],f.appendChild(ct)}}});function kr(s,f,x){return new gi(s,f,x)}var ur=Mn.extend({_initImage:function(){var s=this._image=this._url;dn(s,"leaflet-image-layer"),this._zoomAnimated&&dn(s,"leaflet-zoom-animated"),this.options.className&&dn(s,this.options.className),s.onselectstart=w,s.onmousemove=w}});function nl(s,f,x){return new ur(s,f,x)}var Os=Mi.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,f){s&&(s instanceof W||pe(s))?(this._latlng=he(s),j(this,f)):(j(this,s),this._source=f),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&Lr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&Lr(this._container,1),this.bringToFront(),this.options.interactive&&(dn(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(Lr(this._container,0),this._removeTimeout=setTimeout(l(Wn,void 0,this._container),200)):Wn(this._container),this.options.interactive&&(si(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=he(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Ms(this._container),this},bringToBack:function(){return this._map&&jr(this._container),this},_prepareOpen:function(s){var f=this._source;if(!f._map)return!1;if(f instanceof Ns){f=null;var x=this._source._layers;for(var T in x)if(x[T]._map){f=x[T];break}if(!f)return!1;this._source=f}if(!s)if(f.getCenter)s=f.getCenter();else if(f.getLatLng)s=f.getLatLng();else if(f.getBounds)s=f.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,f=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof f=="string")s.innerHTML=f;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(f)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),f=Te(this.options.offset),x=this._getAnchor();this._zoomAnimated?Cr(this._container,s.add(x)):f=f.add(s).add(x);var T=this._containerBottom=-f.y,K=this._containerLeft=-Math.round(this._containerWidth/2)+f.x;this._container.style.bottom=T+"px",this._container.style.left=K+"px"}},_getAnchor:function(){return[0,0]}});Oi.include({_initOverlay:function(s,f,x,T){var K=f;return K instanceof s||(K=new s(T).setContent(f)),x&&K.setLatLng(x),K}}),Mi.include({_initOverlay:function(s,f,x,T){var K=x;return K instanceof s?(j(K,T),K._source=this):(K=f&&!T?f:new s(T,this),K.setContent(x)),K}});var Mr=Os.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,Os.prototype.openOn.call(this,s)},onAdd:function(s){Os.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof io||this._source.on("preclick",ha))},onRemove:function(s){Os.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof io||this._source.off("preclick",ha))},getEvents:function(){var s=Os.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",f=this._container=li("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),x=this._wrapper=li("div",s+"-content-wrapper",f);if(this._contentNode=li("div",s+"-content",x),Ka(f),Dl(this._contentNode),yi(f,"contextmenu",ha),this._tipContainer=li("div",s+"-tip-container",f),this._tip=li("div",s+"-tip",this._tipContainer),this.options.closeButton){var T=this._closeButton=li("a",s+"-close-button",f);T.setAttribute("role","button"),T.setAttribute("aria-label","Close popup"),T.href="#close",T.innerHTML='<span aria-hidden="true">&#215;</span>',yi(T,"click",function(K){mi(K),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,f=s.style;f.width="",f.whiteSpace="nowrap";var x=s.offsetWidth;x=Math.min(x,this.options.maxWidth),x=Math.max(x,this.options.minWidth),f.width=x+1+"px",f.whiteSpace="",f.height="";var T=s.offsetHeight,K=this.options.maxHeight,we="leaflet-popup-scrolled";K&&T>K?(f.height=K+"px",dn(s,we)):si(s,we),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){if(console.log("[DEBUG] _animateZoom - Starting animation with params:",{hasMap:!!this._map,hasLatLng:!!this._latlng,zoomLevel:s.zoom,centerPoint:s.center}),!this._map){console.error("[DEBUG] _animateZoom - Map is null");return}if(!this._latlng){console.error("[DEBUG] _animateZoom - LatLng is null");return}try{var f=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);console.log("[DEBUG] _animateZoom - New position calculated:",f),this._setPosition(f)}catch(x){console.error("[DEBUG] _animateZoom - Error during animation:",x,{mapState:this._map,latlng:this._latlng,zoom:s.zoom,center:s.center})}},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,f=parseInt(di(this._container,"marginBottom"),10)||0,x=this._container.offsetHeight+f,T=this._containerWidth,K=new ie(this._containerLeft,-x-this._containerBottom);K._add(Ts(this._container));var we=s.layerPointToContainerPoint(K),ct=Te(this.options.autoPanPadding),Dt=Te(this.options.autoPanPaddingTopLeft||ct),$t=Te(this.options.autoPanPaddingBottomRight||ct),an=s.getSize(),Nn=0,Zn=0;we.x+T+$t.x>an.x&&(Nn=we.x+T-an.x+$t.x),we.x-Nn-Dt.x<0&&(Nn=we.x-Dt.x),we.y+x+$t.y>an.y&&(Zn=we.y+x-an.y+$t.y),we.y-Zn-Dt.y<0&&(Zn=we.y-Dt.y),(Nn||Zn)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([Nn,Zn]))}},_getAnchor:function(){return Te(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Bo=function(s,f){return new Mr(s,f)};Oi.mergeOptions({closePopupOnClick:!0}),Oi.include({openPopup:function(s,f,x){return this._initOverlay(Mr,s,f,x).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),Mi.include({bindPopup:function(s,f){return this._popup=this._initOverlay(Mr,this._popup,s,f),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof Ns||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){Bi(s);var f=s.layer||s.target;if(this._popup._source===f&&!(f instanceof io)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=f,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var Jo=Os.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){Os.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){Os.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=Os.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",f=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=li("div",f),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+p(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var f,x,T=this._map,K=this._container,we=T.latLngToContainerPoint(T.getCenter()),ct=T.layerPointToContainerPoint(s),Dt=this.options.direction,$t=K.offsetWidth,an=K.offsetHeight,Nn=Te(this.options.offset),Zn=this._getAnchor();Dt==="top"?(f=$t/2,x=an):Dt==="bottom"?(f=$t/2,x=0):Dt==="center"?(f=$t/2,x=an/2):Dt==="right"?(f=0,x=an/2):Dt==="left"?(f=$t,x=an/2):ct.x<we.x?(Dt="right",f=0,x=an/2):(Dt="left",f=$t+(Nn.x+Zn.x)*2,x=an/2),s=s.subtract(Te(f,x,!0)).add(Nn).add(Zn),si(K,"leaflet-tooltip-right"),si(K,"leaflet-tooltip-left"),si(K,"leaflet-tooltip-top"),si(K,"leaflet-tooltip-bottom"),dn(K,"leaflet-tooltip-"+Dt),Cr(K,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&Lr(this._container,s)},_animateZoom:function(s){if(console.log("[DEBUG] _animateZoom - Starting animation with params:",{hasMap:!!this._map,hasLatLng:!!this._latlng,zoomLevel:s.zoom,centerPoint:s.center}),!this._map){console.error("[DEBUG] _animateZoom - Map is null");return}if(!this._latlng){console.error("[DEBUG] _animateZoom - LatLng is null");return}try{var f=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);console.log("[DEBUG] _animateZoom - New position calculated:",f),this._setPosition(f)}catch(x){console.error("[DEBUG] _animateZoom - Error during animation:",x,{mapState:this._map,latlng:this._latlng,zoom:s.zoom,center:s.center})}},_getAnchor:function(){return Te(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),No=function(s,f){return new Jo(s,f)};Oi.include({openTooltip:function(s,f,x){return this._initOverlay(Jo,s,f,x).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),Mi.include({bindTooltip:function(s,f){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Jo,this._tooltip,s,f),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var f=s?"off":"on",x={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?x.add=this._openTooltip:(x.mouseover=this._openTooltip,x.mouseout=this.closeTooltip,x.click=this._openTooltip,this._map?this._addFocusListeners():x.add=this._addFocusListeners),this._tooltip.options.sticky&&(x.mousemove=this._moveTooltip),this[f](x),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof Ns||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var f=typeof s.getElement=="function"&&s.getElement();f&&(yi(f,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),yi(f,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var f=typeof s.getElement=="function"&&s.getElement();f&&f.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var f=this;this._map.once("moveend",function(){f._openOnceFlag=!1,f._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var f=s.latlng,x,T;this._tooltip.options.sticky&&s.originalEvent&&(x=this._map.mouseEventToContainerPoint(s.originalEvent),T=this._map.containerPointToLayerPoint(x),f=this._map.layerPointToLatLng(T)),this._tooltip.setLatLng(f)}});var Do=ko.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var f=s&&s.tagName==="DIV"?s:document.createElement("div"),x=this.options;if(x.html instanceof Element?(as(f),f.appendChild(x.html)):f.innerHTML=x.html!==!1?x.html:"",x.bgPos){var T=Te(x.bgPos);f.style.backgroundPosition=-T.x+"px "+-T.y+"px"}return this._setIconStyles(f,"icon"),f},createShadow:function(){return null}});function Ro(s){return new Do(s)}ko.Default=da;var Ii=Mi.extend({options:{tileSize:256,opacity:1,updateWhenIdle:yn.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){j(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),Wn(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Ms(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(jr(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=m(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof ie?s:new ie(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var f=this.getPane().children,x=-s(-1/0,1/0),T=0,K=f.length,we;T<K;T++)we=f[T].style.zIndex,f[T]!==this._container&&we&&(x=s(x,+we));isFinite(x)&&(this.options.zIndex=x+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!yn.ielt9){Lr(this._container,this.options.opacity);var s=+new Date,f=!1,x=!1;for(var T in this._tiles){var K=this._tiles[T];if(!(!K.current||!K.loaded)){var we=Math.min(1,(s-K.loaded)/200);Lr(K.el,we),we<1?f=!0:(K.active?x=!0:this._onOpaqueTile(K),K.active=!0)}}x&&!this._noPrune&&this._pruneTiles(),f&&(I(this._fadeFrame),this._fadeFrame=G(this._updateOpacity,this))}},_onOpaqueTile:w,_initContainer:function(){this._container||(this._container=li("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,f=this.options.maxZoom;if(s!==void 0){for(var x in this._levels)x=Number(x),this._levels[x].el.children.length||x===s?(this._levels[x].el.style.zIndex=f-Math.abs(s-x),this._onUpdateLevel(x)):(Wn(this._levels[x].el),this._removeTilesAtZoom(x),this._onRemoveLevel(x),delete this._levels[x]);var T=this._levels[s],K=this._map;return T||(T=this._levels[s]={},T.el=li("div","leaflet-tile-container leaflet-zoom-animated",this._container),T.el.style.zIndex=f,T.origin=K.project(K.unproject(K.getPixelOrigin()),s).round(),T.zoom=s,this._setZoomTransform(T,K.getCenter(),K.getZoom()),w(T.el.offsetWidth),this._onCreateLevel(T)),this._level=T,T}},_onUpdateLevel:w,_onRemoveLevel:w,_onCreateLevel:w,_pruneTiles:function(){if(this._map){var s,f,x=this._map.getZoom();if(x>this.options.maxZoom||x<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)f=this._tiles[s],f.retain=f.current;for(s in this._tiles)if(f=this._tiles[s],f.current&&!f.active){var T=f.coords;this._retainParent(T.x,T.y,T.z,T.z-5)||this._retainChildren(T.x,T.y,T.z,T.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var f in this._tiles)this._tiles[f].coords.z===s&&this._removeTile(f)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)Wn(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,f,x,T){var K=Math.floor(s/2),we=Math.floor(f/2),ct=x-1,Dt=new ie(+K,+we);Dt.z=+ct;var $t=this._tileCoordsToKey(Dt),an=this._tiles[$t];return an&&an.active?(an.retain=!0,!0):(an&&an.loaded&&(an.retain=!0),ct>T?this._retainParent(K,we,ct,T):!1)},_retainChildren:function(s,f,x,T){for(var K=2*s;K<2*s+2;K++)for(var we=2*f;we<2*f+2;we++){var ct=new ie(K,we);ct.z=x+1;var Dt=this._tileCoordsToKey(ct),$t=this._tiles[Dt];if($t&&$t.active){$t.retain=!0;continue}else $t&&$t.loaded&&($t.retain=!0);x+1<T&&this._retainChildren(K,we,x+1,T)}},_resetView:function(s){var f=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),f,f)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var f=this.options;return f.minNativeZoom!==void 0&&s<f.minNativeZoom?f.minNativeZoom:f.maxNativeZoom!==void 0&&f.maxNativeZoom<s?f.maxNativeZoom:s},_setView:function(s,f,x,T){var K=Math.round(f);this.options.maxZoom!==void 0&&K>this.options.maxZoom||this.options.minZoom!==void 0&&K<this.options.minZoom?K=void 0:K=this._clampZoom(K);var we=this.options.updateWhenZooming&&K!==this._tileZoom;(!T||we)&&(this._tileZoom=K,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),K!==void 0&&this._update(s),x||this._pruneTiles(),this._noPrune=!!x),this._setZoomTransforms(s,f)},_setZoomTransforms:function(s,f){for(var x in this._levels)this._setZoomTransform(this._levels[x],s,f)},_setZoomTransform:function(s,f,x){var T=this._map.getZoomScale(x,s.zoom),K=s.origin.multiplyBy(T).subtract(this._map._getNewPixelOrigin(f,x)).round();yn.any3d?Eo(s.el,K,T):Cr(s.el,K)},_resetGrid:function(){var s=this._map,f=s.options.crs,x=this._tileSize=this.getTileSize(),T=this._tileZoom,K=this._map.getPixelWorldBounds(this._tileZoom);K&&(this._globalTileRange=this._pxBoundsToTileRange(K)),this._wrapX=f.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,f.wrapLng[0]],T).x/x.x),Math.ceil(s.project([0,f.wrapLng[1]],T).x/x.y)],this._wrapY=f.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([f.wrapLat[0],0],T).y/x.x),Math.ceil(s.project([f.wrapLat[1],0],T).y/x.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var f=this._map,x=f._animatingZoom?Math.max(f._animateToZoom,f.getZoom()):f.getZoom(),T=f.getZoomScale(x,this._tileZoom),K=f.project(s,this._tileZoom).floor(),we=f.getSize().divideBy(T*2);return new ut(K.subtract(we),K.add(we))},_update:function(s){var f=this._map;if(f){var x=this._clampZoom(f.getZoom());if(s===void 0&&(s=f.getCenter()),this._tileZoom!==void 0){var T=this._getTiledPixelBounds(s),K=this._pxBoundsToTileRange(T),we=K.getCenter(),ct=[],Dt=this.options.keepBuffer,$t=new ut(K.getBottomLeft().subtract([Dt,-Dt]),K.getTopRight().add([Dt,-Dt]));if(!(isFinite(K.min.x)&&isFinite(K.min.y)&&isFinite(K.max.x)&&isFinite(K.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var an in this._tiles){var Nn=this._tiles[an].coords;(Nn.z!==this._tileZoom||!$t.contains(new ie(Nn.x,Nn.y)))&&(this._tiles[an].current=!1)}if(Math.abs(x-this._tileZoom)>1){this._setView(s,x);return}for(var Zn=K.min.y;Zn<=K.max.y;Zn++)for(var Ei=K.min.x;Ei<=K.max.x;Ei++){var ns=new ie(Ei,Zn);if(ns.z=this._tileZoom,!!this._isValidTile(ns)){var Or=this._tiles[this._tileCoordsToKey(ns)];Or?Or.current=!0:ct.push(ns)}}if(ct.sort(function(Tr,Gs){return Tr.distanceTo(we)-Gs.distanceTo(we)}),ct.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var ds=document.createDocumentFragment();for(Ei=0;Ei<ct.length;Ei++)this._addTile(ct[Ei],ds);this._level.el.appendChild(ds)}}}},_isValidTile:function(s){var f=this._map.options.crs;if(!f.infinite){var x=this._globalTileRange;if(!f.wrapLng&&(s.x<x.min.x||s.x>x.max.x)||!f.wrapLat&&(s.y<x.min.y||s.y>x.max.y))return!1}if(!this.options.bounds)return!0;var T=this._tileCoordsToBounds(s);return B(this.options.bounds).overlaps(T)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var f=this._map,x=this.getTileSize(),T=s.scaleBy(x),K=T.add(x),we=f.unproject(T,s.z),ct=f.unproject(K,s.z);return[we,ct]},_tileCoordsToBounds:function(s){var f=this._tileCoordsToNwSe(s),x=new ke(f[0],f[1]);return this.options.noWrap||(x=this._map.wrapLatLngBounds(x)),x},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var f=s.split(":"),x=new ie(+f[0],+f[1]);return x.z=+f[2],x},_removeTile:function(s){var f=this._tiles[s];f&&(Wn(f.el),delete this._tiles[s],this.fire("tileunload",{tile:f.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){dn(s,"leaflet-tile");var f=this.getTileSize();s.style.width=f.x+"px",s.style.height=f.y+"px",s.onselectstart=w,s.onmousemove=w,yn.ielt9&&this.options.opacity<1&&Lr(s,this.options.opacity)},_addTile:function(s,f){var x=this._getTilePos(s),T=this._tileCoordsToKey(s),K=this.createTile(this._wrapCoords(s),l(this._tileReady,this,s));this._initTile(K),this.createTile.length<2&&G(l(this._tileReady,this,s,null,K)),Cr(K,x),this._tiles[T]={el:K,coords:s,current:!0},f.appendChild(K),this.fire("tileloadstart",{tile:K,coords:s})},_tileReady:function(s,f,x){f&&this.fire("tileerror",{error:f,tile:x,coords:s});var T=this._tileCoordsToKey(s);x=this._tiles[T],x&&(x.loaded=+new Date,this._map._fadeAnimated?(Lr(x.el,0),I(this._fadeFrame),this._fadeFrame=G(this._updateOpacity,this)):(x.active=!0,this._pruneTiles()),f||(dn(x.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:x.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),yn.ielt9||!this._map._fadeAnimated?G(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var f=new ie(this._wrapX?_(s.x,this._wrapX):s.x,this._wrapY?_(s.y,this._wrapY):s.y);return f.z=s.z,f},_pxBoundsToTileRange:function(s){var f=this.getTileSize();return new ut(s.min.unscaleBy(f).floor(),s.max.unscaleBy(f).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function yo(s){return new Ii(s)}var cs=Ii.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,f){this._url=s,f=j(this,f),f.detectRetina&&yn.retina&&f.maxZoom>0?(f.tileSize=Math.floor(f.tileSize/2),f.zoomReverse?(f.zoomOffset--,f.minZoom=Math.min(f.maxZoom,f.minZoom+1)):(f.zoomOffset++,f.maxZoom=Math.max(f.minZoom,f.maxZoom-1)),f.minZoom=Math.max(0,f.minZoom)):f.zoomReverse?f.minZoom=Math.min(f.maxZoom,f.minZoom):f.maxZoom=Math.max(f.minZoom,f.maxZoom),typeof f.subdomains=="string"&&(f.subdomains=f.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,f){return this._url===s&&f===void 0&&(f=!0),this._url=s,f||this.redraw(),this},createTile:function(s,f){var x=document.createElement("img");return yi(x,"load",l(this._tileOnLoad,this,f,x)),yi(x,"error",l(this._tileOnError,this,f,x)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(x.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(x.referrerPolicy=this.options.referrerPolicy),x.alt="",x.src=this.getTileUrl(s),x},getTileUrl:function(s){var f={r:yn.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var x=this._globalTileRange.max.y-s.y;this.options.tms&&(f.y=x),f["-y"]=x}return V(this._url,r(f,this.options))},_tileOnLoad:function(s,f){yn.ielt9?setTimeout(l(s,this,null,f),0):s(null,f)},_tileOnError:function(s,f,x){var T=this.options.errorTileUrl;T&&f.getAttribute("src")!==T&&(f.src=T),s(x,f)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,f=this.options.maxZoom,x=this.options.zoomReverse,T=this.options.zoomOffset;return x&&(s=f-s),s+T},_getSubdomain:function(s){var f=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[f]},_abortLoading:function(){var s,f;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(f=this._tiles[s].el,f.onload=w,f.onerror=w,!f.complete)){f.src=Ie;var x=this._tiles[s].coords;Wn(f),delete this._tiles[s],this.fire("tileabort",{tile:f,coords:x})}},_removeTile:function(s){var f=this._tiles[s];if(f)return f.el.setAttribute("src",Ie),Ii.prototype._removeTile.call(this,s)},_tileReady:function(s,f,x){if(!(!this._map||x&&x.getAttribute("src")===Ie))return Ii.prototype._tileReady.call(this,s,f,x)}});function cr(s,f){return new cs(s,f)}var pr=cs.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,f){this._url=s;var x=r({},this.defaultWmsParams);for(var T in f)T in this.options||(x[T]=f[T]);f=j(this,f);var K=f.detectRetina&&yn.retina?2:1,we=this.getTileSize();x.width=we.x*K,x.height=we.y*K,this.wmsParams=x},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var f=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[f]=this._crs.code,cs.prototype.onAdd.call(this,s)},getTileUrl:function(s){var f=this._tileCoordsToNwSe(s),x=this._crs,T=X(x.project(f[0]),x.project(f[1])),K=T.min,we=T.max,ct=(this._wmsVersion>=1.3&&this._crs===Qr?[K.y,K.x,we.y,we.x]:[K.x,K.y,we.x,we.y]).join(","),Dt=cs.prototype.getTileUrl.call(this,s);return Dt+Q(this.wmsParams,Dt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+ct},setParams:function(s,f){return r(this.wmsParams,s),f||this.redraw(),this}});function Wr(s,f){return new pr(s,f)}cs.WMS=pr,cr.wms=Wr;var _r=Mi.extend({options:{padding:.1},initialize:function(s){j(this,s),p(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),dn(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,f){var x=this._map.getZoomScale(f,this._zoom),T=this._map.getSize().multiplyBy(.5+this.options.padding),K=this._map.project(this._center,f),we=T.multiplyBy(-x).add(K).subtract(this._map._getNewPixelOrigin(s,f));yn.any3d?Eo(this._container,we,x):Cr(this._container,we)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,f=this._map.getSize(),x=this._map.containerPointToLayerPoint(f.multiplyBy(-s)).round();this._bounds=new ut(x,x.add(f.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),so=_r.extend({options:{tolerance:0},getEvents:function(){var s=_r.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){_r.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");yi(s,"mousemove",this._onMouseMove,this),yi(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),yi(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){I(this._redrawRequest),delete this._ctx,Wn(this._container),Zi(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var f in this._layers)s=this._layers[f],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){_r.prototype._update.call(this);var s=this._bounds,f=this._container,x=s.getSize(),T=yn.retina?2:1;Cr(f,s.min),f.width=T*x.x,f.height=T*x.y,f.style.width=x.x+"px",f.style.height=x.y+"px",yn.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){_r.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[p(s)]=s;var f=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=f),this._drawLast=f,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var f=s._order,x=f.next,T=f.prev;x?x.prev=T:this._drawLast=T,T?T.next=x:this._drawFirst=x,delete s._order,delete this._layers[p(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var f=s.options.dashArray.split(/[, ]+/),x=[],T,K;for(K=0;K<f.length;K++){if(T=Number(f[K]),isNaN(T))return;x.push(T)}s.options._dashArray=x}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||G(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var f=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ut,this._redrawBounds.extend(s._pxBounds.min.subtract([f,f])),this._redrawBounds.extend(s._pxBounds.max.add([f,f]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var f=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,f.x,f.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,f=this._redrawBounds;if(this._ctx.save(),f){var x=f.getSize();this._ctx.beginPath(),this._ctx.rect(f.min.x,f.min.y,x.x,x.y),this._ctx.clip()}this._drawing=!0;for(var T=this._drawFirst;T;T=T.next)s=T.layer,(!f||s._pxBounds&&s._pxBounds.intersects(f))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,f){if(this._drawing){var x,T,K,we,ct=s._parts,Dt=ct.length,$t=this._ctx;if(Dt){for($t.beginPath(),x=0;x<Dt;x++){for(T=0,K=ct[x].length;T<K;T++)we=ct[x][T],$t[T?"lineTo":"moveTo"](we.x,we.y);f&&$t.closePath()}this._fillStroke($t,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var f=s._point,x=this._ctx,T=Math.max(Math.round(s._radius),1),K=(Math.max(Math.round(s._radiusY),1)||T)/T;K!==1&&(x.save(),x.scale(1,K)),x.beginPath(),x.arc(f.x,f.y/K,T,0,Math.PI*2,!1),K!==1&&x.restore(),this._fillStroke(x,s)}},_fillStroke:function(s,f){var x=f.options;x.fill&&(s.globalAlpha=x.fillOpacity,s.fillStyle=x.fillColor||x.color,s.fill(x.fillRule||"evenodd")),x.stroke&&x.weight!==0&&(s.setLineDash&&s.setLineDash(f.options&&f.options._dashArray||[]),s.globalAlpha=x.opacity,s.lineWidth=x.weight,s.strokeStyle=x.color,s.lineCap=x.lineCap,s.lineJoin=x.lineJoin,s.stroke())},_onClick:function(s){for(var f=this._map.mouseEventToLayerPoint(s),x,T,K=this._drawFirst;K;K=K.next)x=K.layer,x.options.interactive&&x._containsPoint(f)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(x))&&(T=x);this._fireEvent(T?[T]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var f=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,f)}},_handleMouseOut:function(s){var f=this._hoveredLayer;f&&(si(this._container,"leaflet-interactive"),this._fireEvent([f],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,f){if(!this._mouseHoverThrottled){for(var x,T,K=this._drawFirst;K;K=K.next)x=K.layer,x.options.interactive&&x._containsPoint(f)&&(T=x);T!==this._hoveredLayer&&(this._handleMouseOut(s),T&&(dn(this._container,"leaflet-interactive"),this._fireEvent([T],s,"mouseover"),this._hoveredLayer=T)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,f,x){this._map._fireDOMEvent(f,x||f.type,s)},_bringToFront:function(s){var f=s._order;if(f){var x=f.next,T=f.prev;if(x)x.prev=T;else return;T?T.next=x:x&&(this._drawFirst=x),f.prev=this._drawLast,this._drawLast.next=f,f.next=null,this._drawLast=f,this._requestRedraw(s)}},_bringToBack:function(s){var f=s._order;if(f){var x=f.next,T=f.prev;if(T)T.next=x;else return;x?x.prev=T:T&&(this._drawLast=T),f.prev=null,f.next=this._drawFirst,this._drawFirst.prev=f,this._drawFirst=f,this._requestRedraw(s)}}});function $s(s){return yn.canvas?new so(s):null}var co=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Ol={_initContainer:function(){this._container=li("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(_r.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var f=s._container=co("shape");dn(f,"leaflet-vml-shape "+(this.options.className||"")),f.coordsize="1 1",s._path=co("path"),f.appendChild(s._path),this._updateStyle(s),this._layers[p(s)]=s},_addPath:function(s){var f=s._container;this._container.appendChild(f),s.options.interactive&&s.addInteractiveTarget(f)},_removePath:function(s){var f=s._container;Wn(f),s.removeInteractiveTarget(f),delete this._layers[p(s)]},_updateStyle:function(s){var f=s._stroke,x=s._fill,T=s.options,K=s._container;K.stroked=!!T.stroke,K.filled=!!T.fill,T.stroke?(f||(f=s._stroke=co("stroke")),K.appendChild(f),f.weight=T.weight+"px",f.color=T.color,f.opacity=T.opacity,T.dashArray?f.dashStyle=pe(T.dashArray)?T.dashArray.join(" "):T.dashArray.replace(/( *, *)/g," "):f.dashStyle="",f.endcap=T.lineCap.replace("butt","flat"),f.joinstyle=T.lineJoin):f&&(K.removeChild(f),s._stroke=null),T.fill?(x||(x=s._fill=co("fill")),K.appendChild(x),x.color=T.fillColor||T.color,x.opacity=T.fillOpacity):x&&(K.removeChild(x),s._fill=null)},_updateCircle:function(s){var f=s._point.round(),x=Math.round(s._radius),T=Math.round(s._radiusY||x);this._setPath(s,s._empty()?"M0 0":"AL "+f.x+","+f.y+" "+x+","+T+" 0,"+65535*360)},_setPath:function(s,f){s._path.v=f},_bringToFront:function(s){Ms(s._container)},_bringToBack:function(s){jr(s._container)}},Oo=yn.vml?co:ye,ts=_r.extend({_initContainer:function(){this._container=Oo("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Oo("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Wn(this._container),Zi(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){_r.prototype._update.call(this);var s=this._bounds,f=s.getSize(),x=this._container;(!this._svgSize||!this._svgSize.equals(f))&&(this._svgSize=f,x.setAttribute("width",f.x),x.setAttribute("height",f.y)),Cr(x,s.min),x.setAttribute("viewBox",[s.min.x,s.min.y,f.x,f.y].join(" ")),this.fire("update")}},_initPath:function(s){var f=s._path=Oo("path");s.options.className&&dn(f,s.options.className),s.options.interactive&&dn(f,"leaflet-interactive"),this._updateStyle(s),this._layers[p(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){Wn(s._path),s.removeInteractiveTarget(s._path),delete this._layers[p(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var f=s._path,x=s.options;f&&(x.stroke?(f.setAttribute("stroke",x.color),f.setAttribute("stroke-opacity",x.opacity),f.setAttribute("stroke-width",x.weight),f.setAttribute("stroke-linecap",x.lineCap),f.setAttribute("stroke-linejoin",x.lineJoin),x.dashArray?f.setAttribute("stroke-dasharray",x.dashArray):f.removeAttribute("stroke-dasharray"),x.dashOffset?f.setAttribute("stroke-dashoffset",x.dashOffset):f.removeAttribute("stroke-dashoffset")):f.setAttribute("stroke","none"),x.fill?(f.setAttribute("fill",x.fillColor||x.color),f.setAttribute("fill-opacity",x.fillOpacity),f.setAttribute("fill-rule",x.fillRule||"evenodd")):f.setAttribute("fill","none"))},_updatePoly:function(s,f){this._setPath(s,ue(s._parts,f))},_updateCircle:function(s){var f=s._point,x=Math.max(Math.round(s._radius),1),T=Math.max(Math.round(s._radiusY),1)||x,K="a"+x+","+T+" 0 1,0 ",we=s._empty()?"M0 0":"M"+(f.x-x)+","+f.y+K+x*2+",0 "+K+-x*2+",0 ";this._setPath(s,we)},_setPath:function(s,f){s._path.setAttribute("d",f)},_bringToFront:function(s){Ms(s._path)},_bringToBack:function(s){jr(s._path)}});yn.vml&&ts.include(Ol);function yr(s){return yn.svg||yn.vml?new ts(s):null}Oi.include({getRenderer:function(s){var f=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return f||(f=this._renderer=this._createRenderer()),this.hasLayer(f)||this.addLayer(f),f},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var f=this._paneRenderers[s];return f===void 0&&(f=this._createRenderer({pane:s}),this._paneRenderers[s]=f),f},_createRenderer:function(s){return this.options.preferCanvas&&$s(s)||yr(s)}});var Cs=ss.extend({initialize:function(s,f){ss.prototype.initialize.call(this,this._boundsToLatLngs(s),f)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=B(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function qs(s,f){return new Cs(s,f)}ts.create=Oo,ts.pointsToPath=ue,bs.geometryToLayer=ws,bs.coordsToLatLng=Ko,bs.coordsToLatLngs=xs,bs.latLngToCoords=us,bs.latLngsToCoords=To,bs.getFeature=ro,bs.asFeature=Ls,Oi.mergeOptions({boxZoom:!0});var oi=or.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){yi(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Zi(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Wn(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),lo(),vs(),this._startPoint=this._map.mouseEventToContainerPoint(s),yi(document,{contextmenu:Bi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=li("div","leaflet-zoom-box",this._container),dn(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var f=new ut(this._point,this._startPoint),x=f.getSize();Cr(this._box,f.min),this._box.style.width=x.x+"px",this._box.style.height=x.y+"px"},_finish:function(){this._moved&&(Wn(this._box),si(this._container,"leaflet-crosshair")),Bs(),fo(),Zi(document,{contextmenu:Bi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var f=new ke(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(f).fire("boxzoomend",{boxZoomBounds:f})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Oi.addInitHook("addHandler","boxZoom",oi),Oi.mergeOptions({doubleClickZoom:!0});var Yo=or.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var f=this._map,x=f.getZoom(),T=f.options.zoomDelta,K=s.originalEvent.shiftKey?x-T:x+T;f.options.doubleClickZoom==="center"?f.setZoom(K):f.setZoomAround(s.containerPoint,K)}});Oi.addInitHook("addHandler","doubleClickZoom",Yo),Oi.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Xo=or.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new mo(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}dn(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){si(this._map._container,"leaflet-grab"),si(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var f=B(this._map.options.maxBounds);this._offsetLimit=X(this._map.latLngToContainerPoint(f.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(f.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var f=this._lastTime=+new Date,x=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(x),this._times.push(f),this._prunePositions(f)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),f=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=f.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,f){return s-(s-f)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),f=this._offsetLimit;s.x<f.min.x&&(s.x=this._viscousLimit(s.x,f.min.x)),s.y<f.min.y&&(s.y=this._viscousLimit(s.y,f.min.y)),s.x>f.max.x&&(s.x=this._viscousLimit(s.x,f.max.x)),s.y>f.max.y&&(s.y=this._viscousLimit(s.y,f.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,f=Math.round(s/2),x=this._initialWorldOffset,T=this._draggable._newPos.x,K=(T-f+x)%s+f-x,we=(T+f+x)%s-f-x,ct=Math.abs(K+x)<Math.abs(we+x)?K:we;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=ct},_onDragEnd:function(s){var f=this._map,x=f.options,T=!x.inertia||s.noInertia||this._times.length<2;if(f.fire("dragend",s),T)f.fire("moveend");else{this._prunePositions(+new Date);var K=this._lastPos.subtract(this._positions[0]),we=(this._lastTime-this._times[0])/1e3,ct=x.easeLinearity,Dt=K.multiplyBy(ct/we),$t=Dt.distanceTo([0,0]),an=Math.min(x.inertiaMaxSpeed,$t),Nn=Dt.multiplyBy(an/$t),Zn=an/(x.inertiaDeceleration*ct),Ei=Nn.multiplyBy(-Zn/2).round();!Ei.x&&!Ei.y?f.fire("moveend"):(Ei=f._limitOffset(Ei,f.options.maxBounds),G(function(){f.panBy(Ei,{duration:Zn,easeLinearity:ct,noMoveStart:!0,animate:!0})}))}}});Oi.addInitHook("addHandler","dragging",Xo),Oi.mergeOptions({keyboard:!0,keyboardPanDelta:80});var _o=or.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),yi(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Zi(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,f=document.documentElement,x=s.scrollTop||f.scrollTop,T=s.scrollLeft||f.scrollLeft;this._map._container.focus(),window.scrollTo(T,x)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var f=this._panKeys={},x=this.keyCodes,T,K;for(T=0,K=x.left.length;T<K;T++)f[x.left[T]]=[-1*s,0];for(T=0,K=x.right.length;T<K;T++)f[x.right[T]]=[s,0];for(T=0,K=x.down.length;T<K;T++)f[x.down[T]]=[0,s];for(T=0,K=x.up.length;T<K;T++)f[x.up[T]]=[0,-1*s]},_setZoomDelta:function(s){var f=this._zoomKeys={},x=this.keyCodes,T,K;for(T=0,K=x.zoomIn.length;T<K;T++)f[x.zoomIn[T]]=s;for(T=0,K=x.zoomOut.length;T<K;T++)f[x.zoomOut[T]]=-s},_addHooks:function(){yi(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Zi(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var f=s.keyCode,x=this._map,T;if(f in this._panKeys){if(!x._panAnim||!x._panAnim._inProgress)if(T=this._panKeys[f],s.shiftKey&&(T=Te(T).multiplyBy(3)),x.options.maxBounds&&(T=x._limitOffset(Te(T),x.options.maxBounds)),x.options.worldCopyJump){var K=x.wrapLatLng(x.unproject(x.project(x.getCenter()).add(T)));x.panTo(K)}else x.panBy(T)}else if(f in this._zoomKeys)x.setZoom(x.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[f]);else if(f===27&&x._popup&&x._popup.options.closeOnEscapeKey)x.closePopup();else return;Bi(s)}}});Oi.addInitHook("addHandler","keyboard",_o),Oi.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Is=or.extend({addHooks:function(){yi(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Zi(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var f=dl(s),x=this._map.options.wheelDebounceTime;this._delta+=f,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var T=Math.max(x-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),T),Bi(s)},_performZoom:function(){var s=this._map,f=s.getZoom(),x=this._map.options.zoomSnap||0;s._stop();var T=this._delta/(this._map.options.wheelPxPerZoomLevel*4),K=4*Math.log(2/(1+Math.exp(-Math.abs(T))))/Math.LN2,we=x?Math.ceil(K/x)*x:K,ct=s._limitZoom(f+(this._delta>0?we:-we))-f;this._delta=0,this._startTime=null,ct&&(s.options.scrollWheelZoom==="center"?s.setZoom(f+ct):s.setZoomAround(this._lastMousePos,f+ct))}});Oi.addInitHook("addHandler","scrollWheelZoom",Is);var Tu=600;Oi.mergeOptions({tapHold:yn.touchNative&&yn.safari&&yn.mobile,tapTolerance:15});var hs=or.extend({addHooks:function(){yi(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Zi(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var f=s.touches[0];this._startPos=this._newPos=new ie(f.clientX,f.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(yi(document,"touchend",mi),yi(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",f))},this),Tu),yi(document,"touchend touchcancel contextmenu",this._cancel,this),yi(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){Zi(document,"touchend",mi),Zi(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),Zi(document,"touchend touchcancel contextmenu",this._cancel,this),Zi(document,"touchmove",this._onMove,this)},_onMove:function(s){var f=s.touches[0];this._newPos=new ie(f.clientX,f.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,f){var x=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:f.screenX,screenY:f.screenY,clientX:f.clientX,clientY:f.clientY});x._simulated=!0,f.target.dispatchEvent(x)}});Oi.addInitHook("addHandler","tapHold",hs),Oi.mergeOptions({touchZoom:yn.touch,bounceAtZoomLimits:!0});var fs=or.extend({addHooks:function(){dn(this._map._container,"leaflet-touch-zoom"),yi(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){si(this._map._container,"leaflet-touch-zoom"),Zi(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var f=this._map;if(!(!s.touches||s.touches.length!==2||f._animatingZoom||this._zooming)){var x=f.mouseEventToContainerPoint(s.touches[0]),T=f.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=f.getSize()._divideBy(2),this._startLatLng=f.containerPointToLatLng(this._centerPoint),f.options.touchZoom!=="center"&&(this._pinchStartLatLng=f.containerPointToLatLng(x.add(T)._divideBy(2))),this._startDist=x.distanceTo(T),this._startZoom=f.getZoom(),this._moved=!1,this._zooming=!0,f._stop(),yi(document,"touchmove",this._onTouchMove,this),yi(document,"touchend touchcancel",this._onTouchEnd,this),mi(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var f=this._map,x=f.mouseEventToContainerPoint(s.touches[0]),T=f.mouseEventToContainerPoint(s.touches[1]),K=x.distanceTo(T)/this._startDist;if(this._zoom=f.getScaleZoom(K,this._startZoom),!f.options.bounceAtZoomLimits&&(this._zoom<f.getMinZoom()&&K<1||this._zoom>f.getMaxZoom()&&K>1)&&(this._zoom=f._limitZoom(this._zoom)),f.options.touchZoom==="center"){if(this._center=this._startLatLng,K===1)return}else{var we=x._add(T)._divideBy(2)._subtract(this._centerPoint);if(K===1&&we.x===0&&we.y===0)return;this._center=f.unproject(f.project(this._pinchStartLatLng,this._zoom).subtract(we),this._zoom)}this._moved||(f._moveStart(!0,!1),this._moved=!0),I(this._animRequest);var ct=l(f._move,f,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=G(ct,this,!0),mi(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,I(this._animRequest),Zi(document,"touchmove",this._onTouchMove,this),Zi(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Oi.addInitHook("addHandler","touchZoom",fs),Oi.BoxZoom=oi,Oi.DoubleClickZoom=Yo,Oi.Drag=Xo,Oi.Keyboard=_o,Oi.ScrollWheelZoom=Is,Oi.TapHold=hs,Oi.TouchZoom=fs,t.Bounds=ut,t.Browser=yn,t.CRS=ne,t.Canvas=so,t.Circle=_s,t.CircleMarker=Us,t.Class=$,t.Control=Qn,t.DivIcon=Do,t.DivOverlay=Os,t.DomEvent=Ya,t.DomUtil=pi,t.Draggable=mo,t.Evented=se,t.FeatureGroup=Ns,t.GeoJSON=bs,t.GridLayer=Ii,t.Handler=or,t.Icon=ko,t.ImageOverlay=Mn,t.LatLng=W,t.LatLngBounds=ke,t.Layer=Mi,t.LayerGroup=ys,t.LineUtil=ki,t.Map=Oi,t.Marker=es,t.Mixin=lu,t.Path=io,t.Point=ie,t.PolyUtil=Na,t.Polygon=ss,t.Polyline=Rs,t.Popup=Mr,t.PosAnimation=pl,t.Projection=lr,t.Rectangle=Cs,t.Renderer=_r,t.SVG=ts,t.SVGOverlay=ur,t.TileLayer=cs,t.Tooltip=Jo,t.Transformation=Se,t.Util=Y,t.VideoOverlay=gi,t.bind=l,t.bounds=X,t.canvas=$s,t.circle=Ds,t.circleMarker=Ra,t.control=Gr,t.divIcon=Ro,t.extend=r,t.featureGroup=ml,t.geoJSON=Zt,t.geoJson=Rt,t.gridLayer=yo,t.icon=Rl,t.imageOverlay=qn,t.latLng=he,t.latLngBounds=B,t.layerGroup=Da,t.map=qr,t.marker=Mo,t.point=Te,t.polygon=Wo,t.polyline=uu,t.popup=Bo,t.rectangle=qs,t.setOptions=j,t.stamp=p,t.svg=yr,t.svgOverlay=nl,t.tileLayer=cr,t.tooltip=No,t.transformation=te,t.version=i,t.videoOverlay=kr;var bo=window.L;t.noConflict=function(){return window.L=bo,this},window.L=t})})(Ag,Ag.exports);var St=Ag.exports;const gn=s4(St);var hy={exports:{}};(function(e,n){(function(t,i){i(n)})(qo,function(t){var i=typeof window<"u"?window:typeof qo<"u"?qo:typeof self<"u"?self:{};function r(m,_){return m(_={exports:{}},_.exports),_.exports}var o=r(function(m,_){(function(w){const E={escape:function(R){return R.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},parseExtension:b,mimeType:function(R){return R=b(R).toLowerCase(),function(){var Z="application/font-woff",se="image/jpeg";return{woff:Z,woff2:Z,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:se,jpeg:se,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}()[R]||""},dataAsUrl:function(R,Z){return`data:${Z};base64,`+R},isDataUrl:function(R){return R.search(/^(data:)/)!==-1},canvasToBlob:function(R){return R.toBlob?new Promise(function(se){R.toBlob(se)}):(Z=R,new Promise(function(se){const ie=We(Z.toDataURL().split(",")[1]);var Ae=ie.length;const Te=new Uint8Array(Ae);for(let ut=0;ut<Ae;ut++)Te[ut]=ie.charCodeAt(ut);se(new Blob([Te],{type:"image/png"}))}));var Z},resolveUrl:function(R,Z){const se=document.implementation.createHTMLDocument(),ie=se.createElement("base"),Ae=(se.head.appendChild(ie),se.createElement("a"));return se.body.appendChild(Ae),ie.href=Z,Ae.href=R,Ae.href},getAndEncode:function(R){let Z=Ie.impl.urlCache.find(function(se){return se.url===R});return Z||(Z={url:R,promise:null},Ie.impl.urlCache.push(Z)),Z.promise===null&&(Ie.impl.options.cacheBust&&(R+=(/\?/.test(R)?"&":"?")+new Date().getTime()),Z.promise=new Promise(function(se){const ie=Ie.impl.options.httpTimeout,Ae=new XMLHttpRequest;let Te;var ut;function X(ke){console.error(ke),se("")}Ae.onreadystatechange=function(){if(Ae.readyState===4)if(Ae.status!==200)Te?se(Te):X(`cannot fetch resource: ${R}, status: `+Ae.status);else{const ke=new FileReader;ke.onloadend=function(){var B=ke.result.split(/,/)[1];se(B)},ke.readAsDataURL(Ae.response)}},Ae.ontimeout=function(){Te?se(Te):X(`timeout of ${ie}ms occured while fetching resource: `+R)},Ae.responseType="blob",Ae.timeout=ie,Ie.impl.options.useCredentials&&(Ae.withCredentials=!0),Ae.open("GET",R,!0),Ae.send(),Ie.impl.options.imagePlaceholder&&(ut=Ie.impl.options.imagePlaceholder.split(/,/))&&ut[1]&&(Te=ut[1])})),Z.promise},uid:function(){let R=0;return function(){return"u"+("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+R++}}(),delay:function(R){return function(Z){return new Promise(function(se){setTimeout(function(){se(Z)},R)})}},asArray:function(R){const Z=[],se=R.length;for(let ie=0;ie<se;ie++)Z.push(R[ie]);return Z},escapeXhtml:function(R){return R.replace(/%/g,"%25").replace(/#/g,"%23").replace(/\n/g,"%0A")},makeImage:function(R){return R!=="data:,"?new Promise(function(Z,se){const ie=new Image;Ie.impl.options.useCredentials&&(ie.crossOrigin="use-credentials"),ie.onload=function(){Z(ie)},ie.onerror=se,ie.src=R}):Promise.resolve()},width:function(R){var Z=D(R,"border-left-width"),se=D(R,"border-right-width");return R.scrollWidth+Z+se},height:function(R){var Z=D(R,"border-top-width"),se=D(R,"border-bottom-width");return R.scrollHeight+Z+se}};function b(R){return(R=/\.([^\.\/]*?)(\?|$)/g.exec(R))?R[1]:""}function D(R,Z){const se=nt(R).getPropertyValue(Z);return parseFloat(se.replace("px",""))}const j=function(){const R=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(Ae,Te,ut){return Z(Ae)?Promise.resolve(Ae).then(se).then(function(X){let ke=Promise.resolve(Ae);return X.forEach(function(B){ke=ke.then(function(W){return ie(W,B,Te,ut)})}),ke}):Promise.resolve(Ae)},shouldProcess:Z,impl:{readUrls:se,inline:ie}};function Z(Ae){return Ae.search(R)!==-1}function se(Ae){const Te=[];for(var ut;(ut=R.exec(Ae))!==null;)Te.push(ut[1]);return Te.filter(function(X){return!E.isDataUrl(X)})}function ie(Ae,Te,ut,X){return Promise.resolve(Te).then(function(ke){return ut?E.resolveUrl(ke,ut):ke}).then(X||E.getAndEncode).then(function(ke){return E.dataAsUrl(ke,E.mimeType(Te))}).then(function(ke){return Ae.replace((B=Te,new RegExp(`(url\\(['"]?)(${E.escape(B)})(['"]?\\))`,"g")),`$1${ke}$3`);var B})}}(),Q={resolveAll:function(){return F().then(function(R){return Promise.all(R.map(function(Z){return Z.resolve()}))}).then(function(R){return R.join(`
`)})},impl:{readAll:F}};function F(){return Promise.resolve(E.asArray(document.styleSheets)).then(function(Z){const se=[];return Z.forEach(function(ie){if(Object.getPrototypeOf(ie).hasOwnProperty("cssRules"))try{E.asArray(ie.cssRules||[]).forEach(se.push.bind(se))}catch(Ae){console.log("Error while reading CSS rules from "+ie.href,Ae.toString())}}),se}).then(function(Z){return Z.filter(function(se){return se.type===CSSRule.FONT_FACE_RULE}).filter(function(se){return j.shouldProcess(se.style.getPropertyValue("src"))})}).then(function(Z){return Z.map(R)});function R(Z){return{resolve:function(){var se=(Z.parentStyleSheet||{}).href;return j.inlineAll(Z.cssText,se)},src:function(){return Z.style.getPropertyValue("src")}}}}const V={inlineAll:function R(Z){return Z instanceof Element?function(se){const ie=se.style.getPropertyValue("background");return ie?j.inlineAll(ie).then(function(Ae){se.style.setProperty("background",Ae,ie)}).then(function(){return se}):Promise.resolve(se)}(Z).then(function(){return Z instanceof HTMLImageElement?pe(Z).inline():Promise.all(E.asArray(Z.childNodes).map(function(se){return R(se)}))}):Promise.resolve(Z)},impl:{newImage:pe}};function pe(R){return{inline:function(Z){return E.isDataUrl(R.src)?Promise.resolve():Promise.resolve(R.src).then(Z||E.getAndEncode).then(function(se){return E.dataAsUrl(se,E.mimeType(R.src))}).then(function(se){return new Promise(function(ie){R.onload=ie,R.onerror=ie,R.src=se})})}}}const Ee={imagePlaceholder:void 0,cacheBust:!1,useCredentials:!1},Ie={toSvg:O,toPng:function(R,Z){return(Z=Z||{}).raster=!0,H(R,Z).then(function(se){return se.toDataURL()})},toJpeg:function(R,Z){return(Z=Z||{}).raster=!0,H(R,Z).then(function(se){return se.toDataURL("image/jpeg",Z.quality||1)})},toBlob:function(R,Z){return(Z=Z||{}).raster=!0,H(R,Z).then(E.canvasToBlob)},toPixelData:function(R,Z){return(Z=Z||{}).raster=!0,H(R,Z).then(function(se){return se.getContext("2d").getImageData(0,0,E.width(R),E.height(R)).data})},toCanvas:function(R,Z){return(Z=Z||{}).raster=!0,H(R,Z||{})},impl:{fontFaces:Q,images:V,util:E,inliner:j,urlCache:[],options:{}}},nt=(m.exports=Ie,w.getComputedStyle||window.getComputedStyle),We=w.atob||window.atob;function O(R,Z){var se=Z=Z||{};return se.imagePlaceholder===void 0?Ie.impl.options.imagePlaceholder=Ee.imagePlaceholder:Ie.impl.options.imagePlaceholder=se.imagePlaceholder,se.cacheBust===void 0?Ie.impl.options.cacheBust=Ee.cacheBust:Ie.impl.options.cacheBust=se.cacheBust,se.useCredentials===void 0?Ie.impl.options.useCredentials=Ee.useCredentials:Ie.impl.options.useCredentials=se.useCredentials,Promise.resolve(R).then(function(ie){return function Ae(Te,ut,X,ke,B=null){return X||!ut||ut(Te)?Promise.resolve(Te).then(function(W){return W instanceof HTMLCanvasElement?E.makeImage(W.toDataURL()):W.nodeName==="IFRAME"?html2canvas(W.contentDocument.body).then(he=>he.toDataURL()).then(E.makeImage):W.cloneNode(!1)}).then(function(W){return function(he,ne){const re=he.childNodes;return re.length===0?Promise.resolve(ne):function(ee,oe){const Se=nt(he);let te=Promise.resolve();return oe.forEach(function(ae){te=te.then(function(){return Ae(ae,ut,!1,ke,Se)}).then(function(Le){Le&&ee.appendChild(Le)})}),te}(ne,E.asArray(re)).then(function(){return ne})}(Te,W)}).then(function(W){return function(he,ne,re){return ne instanceof Element?Promise.resolve().then(function(){(function(ee,oe){const Se=nt(ee);Se.cssText?(oe.style.cssText=Se.cssText,function(te,ae){ae.font=te.font,ae.fontFamily=te.fontFamily,ae.fontFeatureSettings=te.fontFeatureSettings,ae.fontKerning=te.fontKerning,ae.fontSize=te.fontSize,ae.fontStretch=te.fontStretch,ae.fontStyle=te.fontStyle,ae.fontVariant=te.fontVariant,ae.fontVariantCaps=te.fontVariantCaps,ae.fontVariantEastAsian=te.fontVariantEastAsian,ae.fontVariantLigatures=te.fontVariantLigatures,ae.fontVariantNumeric=te.fontVariantNumeric,ae.fontVariationSettings=te.fontVariationSettings,ae.fontWeight=te.fontWeight}(Se,oe.style)):(re?function(te,ae,Le,ye){const ue=Le.style,Oe=te.style;for(var De of ae){var Me=ae.getPropertyValue(De),Ve=Oe.getPropertyValue(De),ze=(Oe.setProperty(De,ye?"initial":"unset"),ae.getPropertyValue(De));ze!==Me?ue.setProperty(De,Me):ue.removeProperty(De),Oe.setProperty(De,Ve)}}(ee,Se,oe,X):function(te,ae,Le){const ye=function(Oe){if($[Oe])return $[Oe];Y||((Y=document.createElement("iframe")).style.visibility="hidden",Y.style.position="fixed",document.body.appendChild(Y),Y.contentWindow.document.write('<!DOCTYPE html><meta charset="UTF-8"><title>sandbox</title><body>'));const De=document.createElement(Oe),Me=(Y.contentWindow.document.body.appendChild(De),De.textContent=".",Y.contentWindow.getComputedStyle(De)),Ve={};return E.asArray(Me).forEach(function(ze){Ve[ze]=ze==="width"||ze==="height"?"auto":Me.getPropertyValue(ze)}),Y.contentWindow.document.body.removeChild(De),$[Oe]=Ve}(Le.tagName),ue=Le.style;E.asArray(te).forEach(function(Oe){var De=te.getPropertyValue(Oe);(De!==ye[Oe]||ae&&De!==ae.getPropertyValue(Oe))&&ue.setProperty(Oe,De,te.getPropertyPriority(Oe))})}(Se,B,oe),X&&(["inset-block","inset-block-start","inset-block-end"].forEach(te=>oe.style.removeProperty(te)),["left","right","top","bottom"].forEach(te=>{oe.style.getPropertyValue(te)&&oe.style.setProperty(te,"0px")})))})(he,ne)}).then(function(){[":before",":after"].forEach(function(ee){(function(oe){const Se=nt(he,oe),te=Se.getPropertyValue("content");if(te!==""&&te!=="none"){const ae=E.uid(),Le=ne.getAttribute("class"),ye=(Le&&ne.setAttribute("class",Le+" "+ae),document.createElement("style"));ye.appendChild(function(){const ue=`.${ae}:`+oe,Oe=(Se.cssText?function(){return`${Se.cssText} content: ${Se.getPropertyValue("content")};`}:function(){return E.asArray(Se).map(function(De){return De+": "+Se.getPropertyValue(De)+(Se.getPropertyPriority(De)?" !important":"")}).join("; ")+";"})();return document.createTextNode(ue+`{${Oe}}`)}()),ne.appendChild(ye)}})(ee)})}).then(function(){he instanceof HTMLTextAreaElement&&(ne.innerHTML=he.value),he instanceof HTMLInputElement&&ne.setAttribute("value",he.value)}).then(function(){ne instanceof SVGElement&&(ne.setAttribute("xmlns","http://www.w3.org/2000/svg"),ne instanceof SVGRectElement&&["width","height"].forEach(function(ee){const oe=ne.getAttribute(ee);oe&&ne.style.setProperty(ee,oe)}))}).then(function(){return ne}):ne}(Te,W,ke)}):Promise.resolve()}(ie,Z.filter,!0,!Z.raster)}).then(le).then(G).then(function(ie){Z.bgcolor&&(ie.style.backgroundColor=Z.bgcolor),Z.width&&(ie.style.width=Z.width+"px"),Z.height&&(ie.style.height=Z.height+"px"),Z.style&&Object.keys(Z.style).forEach(function(Te){ie.style[Te]=Z.style[Te]});let Ae=null;return typeof Z.onclone=="function"&&(Ae=Z.onclone(ie)),Promise.resolve(Ae).then(function(){return ie})}).then(function(ie){return ie=ie,Ae=Z.width||E.width(R),Te=Z.height||E.height(R),Promise.resolve(ie).then(function(ut){return ut.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(ut)}).then(E.escapeXhtml).then(function(ut){return`<foreignObject x="0" y="0" width="100%" height="100%">${ut}</foreignObject>`}).then(function(ut){return`<svg xmlns="http://www.w3.org/2000/svg" width="${Ae}" height="${Te}">${ut}</svg>`}).then(function(ut){return"data:image/svg+xml;charset=utf-8,"+ut});var Ae,Te}).then(function(ie){return Ie.impl.urlCache=[],ie})}function H(R,Z){return O(R,Z).then(E.makeImage).then(E.delay(0)).then(function(se){var ie=typeof Z.scale!="number"?1:Z.scale;const Ae=function(ut,X){const ke=document.createElement("canvas");if(ke.width=(Z.width||E.width(ut))*X,ke.height=(Z.height||E.height(ut))*X,Z.bgcolor){const B=ke.getContext("2d");B.fillStyle=Z.bgcolor,B.fillRect(0,0,ke.width,ke.height)}return ke}(R,ie),Te=Ae.getContext("2d");return Te.mozImageSmoothingEnabled=!1,Te.msImageSmoothingEnabled=!1,Te.imageSmoothingEnabled=!1,se&&(Te.scale(ie,ie),Te.drawImage(se,0,0)),Y&&(document.body.removeChild(Y),Y=null,I&&clearTimeout(I),I=setTimeout(()=>{I=null,$={}},2e4)),Ae})}function le(R){return Q.resolveAll().then(function(Z){const se=document.createElement("style");return R.appendChild(se),se.appendChild(document.createTextNode(Z)),R})}function G(R){return V.inlineAll(R).then(function(){return R})}let I=null,Y=null,$={}})(i)}),l=r(function(m,_){(function(){function w(Q,F,V){var pe=new XMLHttpRequest;pe.open("GET",Q),pe.responseType="blob",pe.onload=function(){j(pe.response,F,V)},pe.onerror=function(){console.error("could not download file")},pe.send()}function E(Q){var F=new XMLHttpRequest;F.open("HEAD",Q,!1);try{F.send()}catch{}return 200<=F.status&&299>=F.status}function b(Q){try{Q.dispatchEvent(new MouseEvent("click"))}catch{var F=document.createEvent("MouseEvents");F.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),Q.dispatchEvent(F)}}var D=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof i=="object"&&i.global===i?i:void 0,j=D.saveAs||(typeof window!="object"||window!==D?function(){}:"download"in HTMLAnchorElement.prototype?function(Q,F,V){var pe=D.URL||D.webkitURL,Ee=document.createElement("a");F=F||Q.name||"download",Ee.download=F,Ee.rel="noopener",typeof Q=="string"?(Ee.href=Q,Ee.origin===location.origin?b(Ee):E(Ee.href)?w(Q,F,V):b(Ee,Ee.target="_blank")):(Ee.href=pe.createObjectURL(Q),setTimeout(function(){pe.revokeObjectURL(Ee.href)},4e4),setTimeout(function(){b(Ee)},0))}:"msSaveOrOpenBlob"in navigator?function(Q,F,V){if(F=F||Q.name||"download",typeof Q!="string")navigator.msSaveOrOpenBlob(function(Ee,Ie){return Ie===void 0?Ie={autoBom:!1}:typeof Ie!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),Ie={autoBom:!Ie}),Ie.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(Ee.type)?new Blob(["\uFEFF",Ee],{type:Ee.type}):Ee}(Q,V),F);else if(E(Q))w(Q,F,V);else{var pe=document.createElement("a");pe.href=Q,pe.target="_blank",setTimeout(function(){b(pe)})}}:function(Q,F,V,pe){if((pe=pe||open("","_blank"))&&(pe.document.title=pe.document.body.innerText="downloading..."),typeof Q=="string")return w(Q,F,V);var Ee=Q.type==="application/octet-stream",Ie=/constructor/i.test(D.HTMLElement)||D.safari,nt=/CriOS\/[\d]+/.test(navigator.userAgent);if((nt||Ee&&Ie)&&typeof FileReader=="object"){var We=new FileReader;We.onloadend=function(){var le=We.result;le=nt?le:le.replace(/^data:[^;]*;/,"data:attachment/file;"),pe?pe.location.href=le:location=le,pe=null},We.readAsDataURL(Q)}else{var O=D.URL||D.webkitURL,H=O.createObjectURL(Q);pe?pe.location=H:location.href=H,pe=null,setTimeout(function(){O.revokeObjectURL(H)},4e4)}});D.saveAs=j.saveAs=j,m.exports=j})()}),h=L.Control.extend({options:{cropImageByInnerWH:!0,hidden:!1,domtoimageOptions:{},position:"topleft",screenName:"screen",iconUrl:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/PjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDMyIDMyIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAzMiAzMjsiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxnPjxnIGlkPSJjYW1lcmEiPjxwYXRoIHN0eWxlPSJmaWxsOiMwMTAwMDI7IiBkPSJNMTYsOS41MDFjLTQuNDE5LDAtOCwzLjU4MS04LDhjMCw0LjQxOCwzLjU4MSw4LDgsOGM0LjQxOCwwLDgtMy41ODIsOC04UzIwLjQxOCw5LjUwMSwxNiw5LjUwMXogTTIwLjU1NSwyMS40MDZjLTIuMTU2LDIuNTE2LTUuOTQzLDIuODA3LTguNDU5LDAuNjVjLTIuNTE3LTIuMTU2LTIuODA3LTUuOTQ0LTAuNjUtOC40NTljMi4xNTUtMi41MTcsNS45NDMtMi44MDcsOC40NTktMC42NUMyMi40MiwxNS4xMDIsMjIuNzExLDE4Ljg5MSwyMC41NTUsMjEuNDA2eiIvPjxwYXRoIHN0eWxlPSJmaWxsOiMwMTAwMDI7IiBkPSJNMTYsMTMuNTAxYy0yLjIwOSwwLTMuOTk5LDEuNzkxLTQsMy45OTl2MC4wMDJjMCwwLjI3NSwwLjIyNCwwLjUsMC41LDAuNXMwLjUtMC4yMjUsMC41LTAuNVYxNy41YzAuMDAxLTEuNjU2LDEuMzQzLTIuOTk5LDMtMi45OTljMC4yNzYsMCwwLjUtMC4yMjQsMC41LTAuNVMxNi4yNzYsMTMuNTAxLDE2LDEzLjUwMXoiLz48cGF0aCBzdHlsZT0iZmlsbDojMDEwMDAyOyIgZD0iTTI5LjQ5Miw4LjU0MmwtNC4zMzQtMC43MjNsLTEuMzczLTMuNDM0QzIzLjMyNiwzLjI0LDIyLjIzMiwyLjUsMjEsMi41SDExYy0xLjIzMiwwLTIuMzI2LDAuNzQtMi43ODYsMS44ODZMNi44NDIsNy44MTlMMi41MDksOC41NDJDMS4wNTUsOC43ODMsMCwxMC4wMjcsMCwxMS41djE1YzAsMS42NTQsMS4zNDYsMywzLDNoMjZjMS42NTQsMCwzLTEuMzQ2LDMtM3YtMTVDMzIsMTAuMDI3LDMwLjk0NSw4Ljc4MywyOS40OTIsOC41NDJ6IE0zMCwyNi41YzAsMC41NTMtMC40NDcsMS0xLDFIM2MtMC41NTMsMC0xLTAuNDQ3LTEtMXYtMTVjMC0wLjQ4OSwwLjM1NC0wLjkwNiwwLjgzNi0wLjk4Nkw4LjI4LDkuNjA3bDEuNzkxLTQuNDc4QzEwLjIyNCw0Ljc1LDEwLjU5MSw0LjUsMTEsNC41aDEwYzAuNDA4LDAsMC43NzUsMC4yNDksMC45MjgsMC42MjlsMS43OTEsNC40NzhsNS40NDUsMC45MDdDMjkuNjQ2LDEwLjU5NCwzMCwxMS4wMTEsMzAsMTEuNVYyNi41eiIvPjwvZz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PC9zdmc+",hideElementsWithSelectors:[".leaflet-control-container"],onCropBorderSize:2,caption:null,captionFontSize:15,captionFont:"Arial",captionColor:"black",captionBgColor:"white",captionOffset:5,mimeType:"image/png",debugMode:!1,preventDownload:!1,onPixelDataFail:function(m){var _=m.node,w=m.error;return console.warn("Map node is very big "+_.scrollWidth+"x"+_.scrollHeight),console.warn(`Add function: SimpleMapScreenshoter({
              onPixelDataFail: function({ node, plugin, error, mapPane, domtoimageOptions }) {
                 // Solutions:
                 // decrease size of map
                 // or decrease zoom level
                 // or remove elements with big distanses
                 // and after that return image in Promise - plugin._getPixelDataOfNormalMap
                 return plugin._getPixelDataOfNormalMap(domtoimageOptions)
              }
            })`),Promise.reject(w)}},onAdd:function(){return this._container=L.DomUtil.create("div","leaflet-control-simpleMapScreenshoter"),this._link=null,this._screenState={status:1,promise:null},this.options.hidden===!1&&this._addScreenBtn(),this._onUserStartInteractWithMap=this._onUserStartInteractWithMap.bind(this),this._onUserEndInteractWithMap=this._onUserEndInteractWithMap.bind(this),this._map.on("zoomstart",this._onUserStartInteractWithMap),this._map.on("move",this._onUserStartInteractWithMap),this._map.on("zoomend",this._onUserEndInteractWithMap),this._map.on("moveend",this._onUserEndInteractWithMap),this._container},takeScreen:function(){var m=this,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"blob",w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},E={};for(var b in this.options)w.hasOwnProperty(b)?E[b]=w[b]:E[b]=this.options[b];return this._screenState.status===2?this._screenState.promise:(this._map.fire("simpleMapScreenshoter.takeScreen"),this._screenState.status=2,this._setElementsVisible(!1),this._screenState.promise=this._waitEndOfInteractions().then(function(){return m._getPixelData(E)}).then(function(D){return m._setElementsVisible(!0),m._toCanvas(D,E)}).then(function(D){return _==="image"?m._canvasToImage(D,E):_==="canvas"?D:m._canvasToBlob(D,E)}).then(function(D){return m._screenState.status=1,m._map.fire("simpleMapScreenshoter.done"),D}).catch(function(D){return m._setElementsVisible(!0),m._screenState.status=1,m._map.fire("simpleMapScreenshoter.error",{e:D}),Promise.reject(D)}),this._screenState.promise)},_setElementsVisible:function(){var m=this,_=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.options.hideElementsWithSelectors.forEach(function(w){var E=m._map._container.querySelectorAll(w),b=!0,D=!1,j=void 0;try{for(var Q,F=E[Symbol.iterator]();!(b=(Q=F.next()).done);b=!0)Q.value.style.opacity=_===!1?0:1}catch(V){D=!0,j=V}finally{try{!b&&F.return&&F.return()}finally{if(D)throw j}}})},_canvasToImage:function(m,_){var w=_.mimeType,E=m.toDataURL(w);return E.indexOf("base64")===-1?Promise.reject(new Error("Base64 image generation error")):Promise.resolve(E)},_canvasToBlob:function(m,_){var w=_.mimeType;return new Promise(function(E,b){m.toBlob(function(D){E(D)},w)})},_toCanvas:function(m,_){var w=_.captionOffset,E=_.caption,b=_.captionFontSize,D=_.captionFont,j=_.captionColor,Q=_.captionBgColor,F=this._node,V=F.screenHeight,pe=F.screenWidth,Ee=document.createElement("canvas");Ee.width=pe,Ee.height=V;for(var Ie=Ee.getContext("2d"),nt=Ie.createImageData(pe,V),We=0;We<m.length;++We)nt.data[We]=m[We];Ie.putImageData(nt,0,0),nt=null;var O=document.createElement("canvas"),H=O.getContext("2d"),le=0,G=0,I=V,Y=pe;if(this.options.cropImageByInnerWH===!0){for(var $=[],R=0,Z=0;Z<V;++Z){R=0;for(var se=0;se<pe;++se)m[4*Z*pe+4*se+4]===0&&R++;R===pe&&$.push(Z)}var ie=this._getMinAndMaxOnValuesBreak($);le=ie.min;for(var Ae=pe,Te=ie.max,ut=[],X=0,ke=G;ke<Ae;++ke){X=0;for(var B=0;B<V;++B)m[4*B*pe+4*ke+4]===0&&X++;X===V&&ut.push(ke)}var W=this._getMinAndMaxOnValuesBreak(ut);G=W.min,Ae=W.max,(G===0&&Ae===0||Ae===null)&&(Ae=pe),(le===0&&Te===0||Te===null)&&(Te=V),this.options.debugMode===!0&&(console.log("emptyYLine",$),console.log("minMaxY",ie),console.log("emptyXLine",ut),console.log("minMaxX",W),console.log("debugX",{}),console.log("debugY",{})),le===0&&Te===V&&G===0&&Ae===pe||(le+=this.options.onCropBorderSize,Te-=this.options.onCropBorderSize,G+=this.options.onCropBorderSize,Ae-=this.options.onCropBorderSize),I=Te-le,Y=Ae-G,O.width=Y,O.height=I}else O.width=Y,O.height=I;var he=null;return E&&(he=typeof E=="function"?E.call(this):E),he!==null&&(O.height=O.height+(w+b+w),H.beginPath(),H.rect(0,0,O.width,O.height),H.fillStyle=Q,H.fill(),H.save()),H.drawImage(Ee,G,le,Y,I,0,0,Y,I),he!==null&&(H.font=b+"px "+D,H.fillStyle=j,H.fillText(he,w,I+w+b)),Promise.resolve(O)},_getMinAndMaxOnValuesBreak:function(m){for(var _=0,w=0,E=!1,b=1;b<m.length;b++){if(m[b]-1!==m[b-1]){w=m[b],E=!0;break}_=m[b]}return E===!1&&m[0]>1?(_=0,w=m[0]):E===!1&&(_=m[m.length-1]||0,w=null),{min:_,max:w}},_getPixelData:function(m){var _=this,w=m.domtoimageOptions,E=w===void 0?{}:w;return this._getPixelDataOfNormalMap(E).catch(function(b){return console.warn("May be map size very big on that zoom level, we have error:",b.toString()),console.warn("You can manually hide map elements with large distances between them for fix that warn"),_._getPixelDataOfBigMap(E)})},_getPixelDataOfNormalMap:function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=this._map.getContainer();return this._node={node:_,screenHeight:_.scrollHeight,screenWidth:_.scrollWidth},o.toPixelData(_,m)},_getPixelDataOfBigMap:function(){var m=this,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},w=this._map.getContainer(),E=this._map.getPane("mapPane");E.style.width=2*w.clientWidth+"px",E.style.height=2*w.clientHeight+"px",E.style.overflow="hidden";var b=function(){E.style.width="initial",E.style.height="initial",E.style.overflow="initial"};return this._node={node:w,screenHeight:w.scrollHeight,screenWidth:w.scrollWidth},o.toPixelData(w,_).then(function(D){return b(),D}).catch(function(D){return b(),w.scrollHeight>=4e3||w.scrollWidth>=4e3?m.options.onPixelDataFail({plugin:m,node:w,mapPane:E,error:D,domtoimageOptions:_}):Promise.reject(D)})},_addScreenBtn:function(){this._link=L.DomUtil.create("a","leaflet-control-simpleMapScreenshoter-btn",this._container),this._addCss(),L.DomEvent.addListener(this._link,"click",this._onScreenBtn,this),L.DomEvent.disableClickPropagation(this._link)},_addCss:function(){var m=`
    .leaflet-control-simpleMapScreenshoter{
       border: 2px solid rgba(0,0,0,0.2);
       background-clip: padding-box;
    }
    .leaflet-control-simpleMapScreenshoter a{
       background-color: #fff;
       border-bottom: 1px solid #ccc;
       width: 30px;
       height: 30px;
       line-height: 30px;
       display: block;
       text-align: center;
       text-decoration: none;
       color: black;
       overflow: hidden;
       border-radius: 2px;
       background-image: url('`+this.options.iconUrl+`');
       background-position: 46% 41%;
       background-repeat: no-repeat;
       background-size: 63%;
    }
    .leaflet-control-simpleMapScreenshoter a:hover{
       cursor: pointer;
    }
    `,_=document.head||document.getElementsByTagName("head")[0],w=document.createElement("style");w.appendChild(document.createTextNode(m)),_.appendChild(w)},_onScreenBtn:function(){var m=this;this._map.fire("simpleMapScreenshoter.click"),this.options.preventDownload||this.takeScreen().then(function(_){var w=typeof m.options.screenName=="function"?m.options.screenName.call(m):m.options.screenName;l.saveAs(_,w+".png")}).catch(function(_){m._map.fire("simpleMapScreenshoter.error",{e:_})})},_onUserStartInteractWithMap:function(){this._interaction=!0},_onUserEndInteractWithMap:function(){this._interaction=!1},_waitEndOfInteractions:function(){var m=this;return new Promise(function(_){var w=setInterval(function(){m._interaction||(_(),clearInterval(w))},100)})}}),p=(L.Control.SimpleMapScreenshoter=h,L.simpleMapScreenshoter=function(m){return new L.Control.SimpleMapScreenshoter(m)},h);t.default=p,t.SimpleMapScreenshoter=h,Object.defineProperty(t,"__esModule",{value:!0})})})(hy,hy.exports);(()=>{var An,Kn;var e=Object.create,n=Object.defineProperty,t=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,r=Object.getPrototypeOf,o=Object.prototype.hasOwnProperty,l=(a,c)=>()=>(c||a((c={exports:{}}).exports,c),c.exports),h=(a,c,g,y)=>{if(c&&typeof c=="object"||typeof c=="function")for(let C of i(c))!o.call(a,C)&&C!==g&&n(a,C,{get:()=>c[C],enumerable:!(y=t(c,C))||y.enumerable});return a},p=(a,c,g)=>(g=a!=null?e(r(a)):{},h(c||!a||!a.__esModule?n(g,"default",{value:a,enumerable:!0}):g,a)),m=l((a,c)=>{function g(){this.__data__=[],this.size=0}c.exports=g}),_=l((a,c)=>{function g(y,C){return y===C||y!==y&&C!==C}c.exports=g}),w=l((a,c)=>{var g=_();function y(C,M){for(var z=C.length;z--;)if(g(C[z][0],M))return z;return-1}c.exports=y}),E=l((a,c)=>{var g=w(),y=Array.prototype,C=y.splice;function M(z){var q=this.__data__,ce=g(q,z);if(ce<0)return!1;var be=q.length-1;return ce==be?q.pop():C.call(q,ce,1),--this.size,!0}c.exports=M}),b=l((a,c)=>{var g=w();function y(C){var M=this.__data__,z=g(M,C);return z<0?void 0:M[z][1]}c.exports=y}),D=l((a,c)=>{var g=w();function y(C){return g(this.__data__,C)>-1}c.exports=y}),j=l((a,c)=>{var g=w();function y(C,M){var z=this.__data__,q=g(z,C);return q<0?(++this.size,z.push([C,M])):z[q][1]=M,this}c.exports=y}),Q=l((a,c)=>{var g=m(),y=E(),C=b(),M=D(),z=j();function q(ce){var be=-1,Xe=ce==null?0:ce.length;for(this.clear();++be<Xe;){var He=ce[be];this.set(He[0],He[1])}}q.prototype.clear=g,q.prototype.delete=y,q.prototype.get=C,q.prototype.has=M,q.prototype.set=z,c.exports=q}),F=l((a,c)=>{var g=Q();function y(){this.__data__=new g,this.size=0}c.exports=y}),V=l((a,c)=>{function g(y){var C=this.__data__,M=C.delete(y);return this.size=C.size,M}c.exports=g}),pe=l((a,c)=>{function g(y){return this.__data__.get(y)}c.exports=g}),Ee=l((a,c)=>{function g(y){return this.__data__.has(y)}c.exports=g}),Ie=l((a,c)=>{var g=typeof qo=="object"&&qo&&qo.Object===Object&&qo;c.exports=g}),nt=l((a,c)=>{var g=Ie(),y=typeof self=="object"&&self&&self.Object===Object&&self,C=g||y||Function("return this")();c.exports=C}),We=l((a,c)=>{var g=nt(),y=g.Symbol;c.exports=y}),O=l((a,c)=>{var g=We(),y=Object.prototype,C=y.hasOwnProperty,M=y.toString,z=g?g.toStringTag:void 0;function q(ce){var be=C.call(ce,z),Xe=ce[z];try{ce[z]=void 0;var He=!0}catch{}var xt=M.call(ce);return He&&(be?ce[z]=Xe:delete ce[z]),xt}c.exports=q}),H=l((a,c)=>{var g=Object.prototype,y=g.toString;function C(M){return y.call(M)}c.exports=C}),le=l((a,c)=>{var g=We(),y=O(),C=H(),M="[object Null]",z="[object Undefined]",q=g?g.toStringTag:void 0;function ce(be){return be==null?be===void 0?z:M:q&&q in Object(be)?y(be):C(be)}c.exports=ce}),G=l((a,c)=>{function g(y){var C=typeof y;return y!=null&&(C=="object"||C=="function")}c.exports=g}),I=l((a,c)=>{var g=le(),y=G(),C="[object AsyncFunction]",M="[object Function]",z="[object GeneratorFunction]",q="[object Proxy]";function ce(be){if(!y(be))return!1;var Xe=g(be);return Xe==M||Xe==z||Xe==C||Xe==q}c.exports=ce}),Y=l((a,c)=>{var g=nt(),y=g["__core-js_shared__"];c.exports=y}),$=l((a,c)=>{var g=Y(),y=function(){var M=/[^.]+$/.exec(g&&g.keys&&g.keys.IE_PROTO||"");return M?"Symbol(src)_1."+M:""}();function C(M){return!!y&&y in M}c.exports=C}),R=l((a,c)=>{var g=Function.prototype,y=g.toString;function C(M){if(M!=null){try{return y.call(M)}catch{}try{return M+""}catch{}}return""}c.exports=C}),Z=l((a,c)=>{var g=I(),y=$(),C=G(),M=R(),z=/[\\^$.*+?()[\]{}|]/g,q=/^\[object .+?Constructor\]$/,ce=Function.prototype,be=Object.prototype,Xe=ce.toString,He=be.hasOwnProperty,xt=RegExp("^"+Xe.call(He).replace(z,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Ot(en){if(!C(en)||y(en))return!1;var bn=g(en)?xt:q;return bn.test(M(en))}c.exports=Ot}),se=l((a,c)=>{function g(y,C){return y==null?void 0:y[C]}c.exports=g}),ie=l((a,c)=>{var g=Z(),y=se();function C(M,z){var q=y(M,z);return g(q)?q:void 0}c.exports=C}),Ae=l((a,c)=>{var g=ie(),y=nt(),C=g(y,"Map");c.exports=C}),Te=l((a,c)=>{var g=ie(),y=g(Object,"create");c.exports=y}),ut=l((a,c)=>{var g=Te();function y(){this.__data__=g?g(null):{},this.size=0}c.exports=y}),X=l((a,c)=>{function g(y){var C=this.has(y)&&delete this.__data__[y];return this.size-=C?1:0,C}c.exports=g}),ke=l((a,c)=>{var g=Te(),y="__lodash_hash_undefined__",C=Object.prototype,M=C.hasOwnProperty;function z(q){var ce=this.__data__;if(g){var be=ce[q];return be===y?void 0:be}return M.call(ce,q)?ce[q]:void 0}c.exports=z}),B=l((a,c)=>{var g=Te(),y=Object.prototype,C=y.hasOwnProperty;function M(z){var q=this.__data__;return g?q[z]!==void 0:C.call(q,z)}c.exports=M}),W=l((a,c)=>{var g=Te(),y="__lodash_hash_undefined__";function C(M,z){var q=this.__data__;return this.size+=this.has(M)?0:1,q[M]=g&&z===void 0?y:z,this}c.exports=C}),he=l((a,c)=>{var g=ut(),y=X(),C=ke(),M=B(),z=W();function q(ce){var be=-1,Xe=ce==null?0:ce.length;for(this.clear();++be<Xe;){var He=ce[be];this.set(He[0],He[1])}}q.prototype.clear=g,q.prototype.delete=y,q.prototype.get=C,q.prototype.has=M,q.prototype.set=z,c.exports=q}),ne=l((a,c)=>{var g=he(),y=Q(),C=Ae();function M(){this.size=0,this.__data__={hash:new g,map:new(C||y),string:new g}}c.exports=M}),re=l((a,c)=>{function g(y){var C=typeof y;return C=="string"||C=="number"||C=="symbol"||C=="boolean"?y!=="__proto__":y===null}c.exports=g}),ee=l((a,c)=>{var g=re();function y(C,M){var z=C.__data__;return g(M)?z[typeof M=="string"?"string":"hash"]:z.map}c.exports=y}),oe=l((a,c)=>{var g=ee();function y(C){var M=g(this,C).delete(C);return this.size-=M?1:0,M}c.exports=y}),Se=l((a,c)=>{var g=ee();function y(C){return g(this,C).get(C)}c.exports=y}),te=l((a,c)=>{var g=ee();function y(C){return g(this,C).has(C)}c.exports=y}),ae=l((a,c)=>{var g=ee();function y(C,M){var z=g(this,C),q=z.size;return z.set(C,M),this.size+=z.size==q?0:1,this}c.exports=y}),Le=l((a,c)=>{var g=ne(),y=oe(),C=Se(),M=te(),z=ae();function q(ce){var be=-1,Xe=ce==null?0:ce.length;for(this.clear();++be<Xe;){var He=ce[be];this.set(He[0],He[1])}}q.prototype.clear=g,q.prototype.delete=y,q.prototype.get=C,q.prototype.has=M,q.prototype.set=z,c.exports=q}),ye=l((a,c)=>{var g=Q(),y=Ae(),C=Le(),M=200;function z(q,ce){var be=this.__data__;if(be instanceof g){var Xe=be.__data__;if(!y||Xe.length<M-1)return Xe.push([q,ce]),this.size=++be.size,this;be=this.__data__=new C(Xe)}return be.set(q,ce),this.size=be.size,this}c.exports=z}),ue=l((a,c)=>{var g=Q(),y=F(),C=V(),M=pe(),z=Ee(),q=ye();function ce(be){var Xe=this.__data__=new g(be);this.size=Xe.size}ce.prototype.clear=y,ce.prototype.delete=C,ce.prototype.get=M,ce.prototype.has=z,ce.prototype.set=q,c.exports=ce}),Oe=l((a,c)=>{var g=ie(),y=function(){try{var C=g(Object,"defineProperty");return C({},"",{}),C}catch{}}();c.exports=y}),De=l((a,c)=>{var g=Oe();function y(C,M,z){M=="__proto__"&&g?g(C,M,{configurable:!0,enumerable:!0,value:z,writable:!0}):C[M]=z}c.exports=y}),Me=l((a,c)=>{var g=De(),y=_();function C(M,z,q){(q!==void 0&&!y(M[z],q)||q===void 0&&!(z in M))&&g(M,z,q)}c.exports=C}),Ve=l((a,c)=>{function g(y){return function(C,M,z){for(var q=-1,ce=Object(C),be=z(C),Xe=be.length;Xe--;){var He=be[y?Xe:++q];if(M(ce[He],He,ce)===!1)break}return C}}c.exports=g}),ze=l((a,c)=>{var g=Ve(),y=g();c.exports=y}),st=l((a,c)=>{var g=nt(),y=typeof a=="object"&&a&&!a.nodeType&&a,C=y&&typeof c=="object"&&c&&!c.nodeType&&c,M=C&&C.exports===y,z=M?g.Buffer:void 0,q=z?z.allocUnsafe:void 0;function ce(be,Xe){if(Xe)return be.slice();var He=be.length,xt=q?q(He):new be.constructor(He);return be.copy(xt),xt}c.exports=ce}),Qe=l((a,c)=>{var g=nt(),y=g.Uint8Array;c.exports=y}),pt=l((a,c)=>{var g=Qe();function y(C){var M=new C.constructor(C.byteLength);return new g(M).set(new g(C)),M}c.exports=y}),wt=l((a,c)=>{var g=pt();function y(C,M){var z=M?g(C.buffer):C.buffer;return new C.constructor(z,C.byteOffset,C.length)}c.exports=y}),Ht=l((a,c)=>{function g(y,C){var M=-1,z=y.length;for(C||(C=Array(z));++M<z;)C[M]=y[M];return C}c.exports=g}),nn=l((a,c)=>{var g=G(),y=Object.create,C=function(){function M(){}return function(z){if(!g(z))return{};if(y)return y(z);M.prototype=z;var q=new M;return M.prototype=void 0,q}}();c.exports=C}),tt=l((a,c)=>{function g(y,C){return function(M){return y(C(M))}}c.exports=g}),Qt=l((a,c)=>{var g=tt(),y=g(Object.getPrototypeOf,Object);c.exports=y}),rn=l((a,c)=>{var g=Object.prototype;function y(C){var M=C&&C.constructor,z=typeof M=="function"&&M.prototype||g;return C===z}c.exports=y}),it=l((a,c)=>{var g=nn(),y=Qt(),C=rn();function M(z){return typeof z.constructor=="function"&&!C(z)?g(y(z)):{}}c.exports=M}),Ke=l((a,c)=>{function g(y){return y!=null&&typeof y=="object"}c.exports=g}),qt=l((a,c)=>{var g=le(),y=Ke(),C="[object Arguments]";function M(z){return y(z)&&g(z)==C}c.exports=M}),mn=l((a,c)=>{var g=qt(),y=Ke(),C=Object.prototype,M=C.hasOwnProperty,z=C.propertyIsEnumerable,q=g(function(){return arguments}())?g:function(ce){return y(ce)&&M.call(ce,"callee")&&!z.call(ce,"callee")};c.exports=q}),xn=l((a,c)=>{var g=Array.isArray;c.exports=g}),wn=l((a,c)=>{var g=9007199254740991;function y(C){return typeof C=="number"&&C>-1&&C%1==0&&C<=g}c.exports=y}),ot=l((a,c)=>{var g=I(),y=wn();function C(M){return M!=null&&y(M.length)&&!g(M)}c.exports=C}),de=l((a,c)=>{var g=ot(),y=Ke();function C(M){return y(M)&&g(M)}c.exports=C}),_e=l((a,c)=>{function g(){return!1}c.exports=g}),$e=l((a,c)=>{var g=nt(),y=_e(),C=typeof a=="object"&&a&&!a.nodeType&&a,M=C&&typeof c=="object"&&c&&!c.nodeType&&c,z=M&&M.exports===C,q=z?g.Buffer:void 0,ce=q?q.isBuffer:void 0,be=ce||y;c.exports=be}),Gt=l((a,c)=>{var g=le(),y=Qt(),C=Ke(),M="[object Object]",z=Function.prototype,q=Object.prototype,ce=z.toString,be=q.hasOwnProperty,Xe=ce.call(Object);function He(xt){if(!C(xt)||g(xt)!=M)return!1;var Ot=y(xt);if(Ot===null)return!0;var en=be.call(Ot,"constructor")&&Ot.constructor;return typeof en=="function"&&en instanceof en&&ce.call(en)==Xe}c.exports=He}),Dn=l((a,c)=>{var g=le(),y=wn(),C=Ke(),M="[object Arguments]",z="[object Array]",q="[object Boolean]",ce="[object Date]",be="[object Error]",Xe="[object Function]",He="[object Map]",xt="[object Number]",Ot="[object Object]",en="[object RegExp]",bn="[object Set]",Pn="[object String]",ti="[object WeakMap]",Ye="[object ArrayBuffer]",at="[object DataView]",gt="[object Float32Array]",jt="[object Float64Array]",Pt="[object Int8Array]",It="[object Int16Array]",fe="[object Int32Array]",Ce="[object Uint8Array]",je="[object Uint8ClampedArray]",Fe="[object Uint16Array]",qe="[object Uint32Array]",Ge={};Ge[gt]=Ge[jt]=Ge[Pt]=Ge[It]=Ge[fe]=Ge[Ce]=Ge[je]=Ge[Fe]=Ge[qe]=!0,Ge[M]=Ge[z]=Ge[Ye]=Ge[q]=Ge[at]=Ge[ce]=Ge[be]=Ge[Xe]=Ge[He]=Ge[xt]=Ge[Ot]=Ge[en]=Ge[bn]=Ge[Pn]=Ge[ti]=!1;function ht(ft){return C(ft)&&y(ft.length)&&!!Ge[g(ft)]}c.exports=ht}),Ln=l((a,c)=>{function g(y){return function(C){return y(C)}}c.exports=g}),bt=l((a,c)=>{var g=Ie(),y=typeof a=="object"&&a&&!a.nodeType&&a,C=y&&typeof c=="object"&&c&&!c.nodeType&&c,M=C&&C.exports===y,z=M&&g.process,q=function(){try{var ce=C&&C.require&&C.require("util").types;return ce||z&&z.binding&&z.binding("util")}catch{}}();c.exports=q}),_n=l((a,c)=>{var g=Dn(),y=Ln(),C=bt(),M=C&&C.isTypedArray,z=M?y(M):g;c.exports=z}),$n=l((a,c)=>{function g(y,C){if(!(C==="constructor"&&typeof y[C]=="function")&&C!="__proto__")return y[C]}c.exports=g}),ni=l((a,c)=>{var g=De(),y=_(),C=Object.prototype,M=C.hasOwnProperty;function z(q,ce,be){var Xe=q[ce];(!(M.call(q,ce)&&y(Xe,be))||be===void 0&&!(ce in q))&&g(q,ce,be)}c.exports=z}),ri=l((a,c)=>{var g=ni(),y=De();function C(M,z,q,ce){var be=!q;q||(q={});for(var Xe=-1,He=z.length;++Xe<He;){var xt=z[Xe],Ot=ce?ce(q[xt],M[xt],xt,q,M):void 0;Ot===void 0&&(Ot=M[xt]),be?y(q,xt,Ot):g(q,xt,Ot)}return q}c.exports=C}),Li=l((a,c)=>{function g(y,C){for(var M=-1,z=Array(y);++M<y;)z[M]=C(M);return z}c.exports=g}),Sn=l((a,c)=>{var g=9007199254740991,y=/^(?:0|[1-9]\d*)$/;function C(M,z){var q=typeof M;return z=z??g,!!z&&(q=="number"||q!="symbol"&&y.test(M))&&M>-1&&M%1==0&&M<z}c.exports=C}),Un=l((a,c)=>{var g=Li(),y=mn(),C=xn(),M=$e(),z=Sn(),q=_n(),ce=Object.prototype,be=ce.hasOwnProperty;function Xe(He,xt){var Ot=C(He),en=!Ot&&y(He),bn=!Ot&&!en&&M(He),Pn=!Ot&&!en&&!bn&&q(He),ti=Ot||en||bn||Pn,Ye=ti?g(He.length,String):[],at=Ye.length;for(var gt in He)(xt||be.call(He,gt))&&!(ti&&(gt=="length"||bn&&(gt=="offset"||gt=="parent")||Pn&&(gt=="buffer"||gt=="byteLength"||gt=="byteOffset")||z(gt,at)))&&Ye.push(gt);return Ye}c.exports=Xe}),ui=l((a,c)=>{function g(y){var C=[];if(y!=null)for(var M in Object(y))C.push(M);return C}c.exports=g}),jn=l((a,c)=>{var g=G(),y=rn(),C=ui(),M=Object.prototype,z=M.hasOwnProperty;function q(ce){if(!g(ce))return C(ce);var be=y(ce),Xe=[];for(var He in ce)He=="constructor"&&(be||!z.call(ce,He))||Xe.push(He);return Xe}c.exports=q}),Wt=l((a,c)=>{var g=Un(),y=jn(),C=ot();function M(z){return C(z)?g(z,!0):y(z)}c.exports=M}),yn=l((a,c)=>{var g=ri(),y=Wt();function C(M){return g(M,y(M))}c.exports=C}),Ci=l((a,c)=>{var g=Me(),y=st(),C=wt(),M=Ht(),z=it(),q=mn(),ce=xn(),be=de(),Xe=$e(),He=I(),xt=G(),Ot=Gt(),en=_n(),bn=$n(),Pn=yn();function ti(Ye,at,gt,jt,Pt,It,fe){var Ce=bn(Ye,gt),je=bn(at,gt),Fe=fe.get(je);if(Fe){g(Ye,gt,Fe);return}var qe=It?It(Ce,je,gt+"",Ye,at,fe):void 0,Ge=qe===void 0;if(Ge){var ht=ce(je),ft=!ht&&Xe(je),yt=!ht&&!ft&&en(je);qe=je,ht||ft||yt?ce(Ce)?qe=Ce:be(Ce)?qe=M(Ce):ft?(Ge=!1,qe=y(je,!0)):yt?(Ge=!1,qe=C(je,!0)):qe=[]:Ot(je)||q(je)?(qe=Ce,q(Ce)?qe=Pn(Ce):(!xt(Ce)||He(Ce))&&(qe=z(je))):Ge=!1}Ge&&(fe.set(je,qe),Pt(qe,je,jt,It,fe),fe.delete(je)),g(Ye,gt,qe)}c.exports=ti}),qi=l((a,c)=>{var g=ue(),y=Me(),C=ze(),M=Ci(),z=G(),q=Wt(),ce=$n();function be(Xe,He,xt,Ot,en){Xe!==He&&C(He,function(bn,Pn){if(en||(en=new g),z(bn))M(Xe,He,Pn,xt,be,Ot,en);else{var ti=Ot?Ot(ce(Xe,Pn),bn,Pn+"",Xe,He,en):void 0;ti===void 0&&(ti=bn),y(Xe,Pn,ti)}},q)}c.exports=be}),Si=l((a,c)=>{function g(y){return y}c.exports=g}),Qi=l((a,c)=>{function g(y,C,M){switch(M.length){case 0:return y.call(C);case 1:return y.call(C,M[0]);case 2:return y.call(C,M[0],M[1]);case 3:return y.call(C,M[0],M[1],M[2])}return y.apply(C,M)}c.exports=g}),fr=l((a,c)=>{var g=Qi(),y=Math.max;function C(M,z,q){return z=y(z===void 0?M.length-1:z,0),function(){for(var ce=arguments,be=-1,Xe=y(ce.length-z,0),He=Array(Xe);++be<Xe;)He[be]=ce[z+be];be=-1;for(var xt=Array(z+1);++be<z;)xt[be]=ce[be];return xt[z]=q(He),g(M,this,xt)}}c.exports=C}),Hn=l((a,c)=>{function g(y){return function(){return y}}c.exports=g}),ai=l((a,c)=>{var g=Hn(),y=Oe(),C=Si(),M=y?function(z,q){return y(z,"toString",{configurable:!0,enumerable:!1,value:g(q),writable:!0})}:C;c.exports=M}),rr=l((a,c)=>{var g=800,y=16,C=Date.now;function M(z){var q=0,ce=0;return function(){var be=C(),Xe=y-(be-ce);if(ce=be,Xe>0){if(++q>=g)return arguments[0]}else q=0;return z.apply(void 0,arguments)}}c.exports=M}),Yi=l((a,c)=>{var g=ai(),y=rr(),C=y(g);c.exports=C}),Pi=l((a,c)=>{var g=Si(),y=fr(),C=Yi();function M(z,q){return C(y(z,q,g),z+"")}c.exports=M}),kn=l((a,c)=>{var g=_(),y=ot(),C=Sn(),M=G();function z(q,ce,be){if(!M(be))return!1;var Xe=typeof ce;return(Xe=="number"?y(be)&&C(ce,be.length):Xe=="string"&&ce in be)?g(be[ce],q):!1}c.exports=z}),xr=l((a,c)=>{var g=Pi(),y=kn();function C(M){return g(function(z,q){var ce=-1,be=q.length,Xe=be>1?q[be-1]:void 0,He=be>2?q[2]:void 0;for(Xe=M.length>3&&typeof Xe=="function"?(be--,Xe):void 0,He&&y(q[0],q[1],He)&&(Xe=be<3?void 0:Xe,be=1),z=Object(z);++ce<be;){var xt=q[ce];xt&&M(z,xt,ce,Xe)}return z})}c.exports=C}),Gi=l((a,c)=>{var g=qi(),y=xr(),C=y(function(M,z,q){g(M,z,q)});c.exports=C}),Wi=l((a,c)=>{var g=le(),y=Ke(),C="[object Symbol]";function M(z){return typeof z=="symbol"||y(z)&&g(z)==C}c.exports=M}),dr=l((a,c)=>{var g=xn(),y=Wi(),C=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,M=/^\w*$/;function z(q,ce){if(g(q))return!1;var be=typeof q;return be=="number"||be=="symbol"||be=="boolean"||q==null||y(q)?!0:M.test(q)||!C.test(q)||ce!=null&&q in Object(ce)}c.exports=z}),zr=l((a,c)=>{var g=Le(),y="Expected a function";function C(M,z){if(typeof M!="function"||z!=null&&typeof z!="function")throw new TypeError(y);var q=function(){var ce=arguments,be=z?z.apply(this,ce):ce[0],Xe=q.cache;if(Xe.has(be))return Xe.get(be);var He=M.apply(this,ce);return q.cache=Xe.set(be,He)||Xe,He};return q.cache=new(C.Cache||g),q}C.Cache=g,c.exports=C}),Vi=l((a,c)=>{var g=zr(),y=500;function C(M){var z=g(M,function(ce){return q.size===y&&q.clear(),ce}),q=z.cache;return z}c.exports=C}),fi=l((a,c)=>{var g=Vi(),y=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,C=/\\(\\)?/g,M=g(function(z){var q=[];return z.charCodeAt(0)===46&&q.push(""),z.replace(y,function(ce,be,Xe,He){q.push(Xe?He.replace(C,"$1"):be||ce)}),q});c.exports=M}),gs=l((a,c)=>{function g(y,C){for(var M=-1,z=y==null?0:y.length,q=Array(z);++M<z;)q[M]=C(y[M],M,y);return q}c.exports=g}),Pr=l((a,c)=>{var g=We(),y=gs(),C=xn(),M=Wi(),z=g?g.prototype:void 0,q=z?z.toString:void 0;function ce(be){if(typeof be=="string")return be;if(C(be))return y(be,ce)+"";if(M(be))return q?q.call(be):"";var Xe=be+"";return Xe=="0"&&1/be==-1/0?"-0":Xe}c.exports=ce}),Rr=l((a,c)=>{var g=Pr();function y(C){return C==null?"":g(C)}c.exports=y}),Ai=l((a,c)=>{var g=xn(),y=dr(),C=fi(),M=Rr();function z(q,ce){return g(q)?q:y(q,ce)?[q]:C(M(q))}c.exports=z}),En=l((a,c)=>{var g=Wi();function y(C){if(typeof C=="string"||g(C))return C;var M=C+"";return M=="0"&&1/C==-1/0?"-0":M}c.exports=y}),hn=l((a,c)=>{var g=Ai(),y=En();function C(M,z){z=g(z,M);for(var q=0,ce=z.length;M!=null&&q<ce;)M=M[y(z[q++])];return q&&q==ce?M:void 0}c.exports=C}),di=l((a,c)=>{var g=hn();function y(C,M,z){var q=C==null?void 0:g(C,M);return q===void 0?z:q}c.exports=y}),li=l((a,c)=>{(function(g,y){typeof a=="object"&&typeof c<"u"?c.exports=y():(g=g||self).RBush=y()})(a,function(){function g(Ye,at,gt,jt,Pt){(function It(fe,Ce,je,Fe,qe){for(;Fe>je;){if(Fe-je>600){var Ge=Fe-je+1,ht=Ce-je+1,ft=Math.log(Ge),yt=.5*Math.exp(2*ft/3),Tt=.5*Math.sqrt(ft*yt*(Ge-yt)/Ge)*(ht-Ge/2<0?-1:1),Bt=Math.max(je,Math.floor(Ce-ht*yt/Ge+Tt)),on=Math.min(Fe,Math.floor(Ce+(Ge-ht)*yt/Ge+Tt));It(fe,Ce,Bt,on,qe)}var On=fe[Ce],Fn=je,Jn=Fe;for(y(fe,je,Ce),qe(fe[Fe],On)>0&&y(fe,je,Fe);Fn<Jn;){for(y(fe,Fn,Jn),Fn++,Jn--;qe(fe[Fn],On)<0;)Fn++;for(;qe(fe[Jn],On)>0;)Jn--}qe(fe[je],On)===0?y(fe,je,Jn):y(fe,++Jn,Fe),Jn<=Ce&&(je=Jn+1),Ce<=Jn&&(Fe=Jn-1)}})(Ye,at,gt||0,jt||Ye.length-1,Pt||C)}function y(Ye,at,gt){var jt=Ye[at];Ye[at]=Ye[gt],Ye[gt]=jt}function C(Ye,at){return Ye<at?-1:Ye>at?1:0}var M=function(Ye){Ye===void 0&&(Ye=9),this._maxEntries=Math.max(4,Ye),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function z(Ye,at,gt){if(!gt)return at.indexOf(Ye);for(var jt=0;jt<at.length;jt++)if(gt(Ye,at[jt]))return jt;return-1}function q(Ye,at){ce(Ye,0,Ye.children.length,at,Ye)}function ce(Ye,at,gt,jt,Pt){Pt||(Pt=Pn(null)),Pt.minX=1/0,Pt.minY=1/0,Pt.maxX=-1/0,Pt.maxY=-1/0;for(var It=at;It<gt;It++){var fe=Ye.children[It];be(Pt,Ye.leaf?jt(fe):fe)}return Pt}function be(Ye,at){return Ye.minX=Math.min(Ye.minX,at.minX),Ye.minY=Math.min(Ye.minY,at.minY),Ye.maxX=Math.max(Ye.maxX,at.maxX),Ye.maxY=Math.max(Ye.maxY,at.maxY),Ye}function Xe(Ye,at){return Ye.minX-at.minX}function He(Ye,at){return Ye.minY-at.minY}function xt(Ye){return(Ye.maxX-Ye.minX)*(Ye.maxY-Ye.minY)}function Ot(Ye){return Ye.maxX-Ye.minX+(Ye.maxY-Ye.minY)}function en(Ye,at){return Ye.minX<=at.minX&&Ye.minY<=at.minY&&at.maxX<=Ye.maxX&&at.maxY<=Ye.maxY}function bn(Ye,at){return at.minX<=Ye.maxX&&at.minY<=Ye.maxY&&at.maxX>=Ye.minX&&at.maxY>=Ye.minY}function Pn(Ye){return{children:Ye,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ti(Ye,at,gt,jt,Pt){for(var It=[at,gt];It.length;)if(!((gt=It.pop())-(at=It.pop())<=jt)){var fe=at+Math.ceil((gt-at)/jt/2)*jt;g(Ye,fe,at,gt,Pt),It.push(at,fe,fe,gt)}}return M.prototype.all=function(){return this._all(this.data,[])},M.prototype.search=function(Ye){var at=this.data,gt=[];if(!bn(Ye,at))return gt;for(var jt=this.toBBox,Pt=[];at;){for(var It=0;It<at.children.length;It++){var fe=at.children[It],Ce=at.leaf?jt(fe):fe;bn(Ye,Ce)&&(at.leaf?gt.push(fe):en(Ye,Ce)?this._all(fe,gt):Pt.push(fe))}at=Pt.pop()}return gt},M.prototype.collides=function(Ye){var at=this.data;if(!bn(Ye,at))return!1;for(var gt=[];at;){for(var jt=0;jt<at.children.length;jt++){var Pt=at.children[jt],It=at.leaf?this.toBBox(Pt):Pt;if(bn(Ye,It)){if(at.leaf||en(Ye,It))return!0;gt.push(Pt)}}at=gt.pop()}return!1},M.prototype.load=function(Ye){if(!Ye||!Ye.length)return this;if(Ye.length<this._minEntries){for(var at=0;at<Ye.length;at++)this.insert(Ye[at]);return this}var gt=this._build(Ye.slice(),0,Ye.length-1,0);if(this.data.children.length)if(this.data.height===gt.height)this._splitRoot(this.data,gt);else{if(this.data.height<gt.height){var jt=this.data;this.data=gt,gt=jt}this._insert(gt,this.data.height-gt.height-1,!0)}else this.data=gt;return this},M.prototype.insert=function(Ye){return Ye&&this._insert(Ye,this.data.height-1),this},M.prototype.clear=function(){return this.data=Pn([]),this},M.prototype.remove=function(Ye,at){if(!Ye)return this;for(var gt,jt,Pt,It=this.data,fe=this.toBBox(Ye),Ce=[],je=[];It||Ce.length;){if(It||(It=Ce.pop(),jt=Ce[Ce.length-1],gt=je.pop(),Pt=!0),It.leaf){var Fe=z(Ye,It.children,at);if(Fe!==-1)return It.children.splice(Fe,1),Ce.push(It),this._condense(Ce),this}Pt||It.leaf||!en(It,fe)?jt?(gt++,It=jt.children[gt],Pt=!1):It=null:(Ce.push(It),je.push(gt),gt=0,jt=It,It=It.children[0])}return this},M.prototype.toBBox=function(Ye){return Ye},M.prototype.compareMinX=function(Ye,at){return Ye.minX-at.minX},M.prototype.compareMinY=function(Ye,at){return Ye.minY-at.minY},M.prototype.toJSON=function(){return this.data},M.prototype.fromJSON=function(Ye){return this.data=Ye,this},M.prototype._all=function(Ye,at){for(var gt=[];Ye;)Ye.leaf?at.push.apply(at,Ye.children):gt.push.apply(gt,Ye.children),Ye=gt.pop();return at},M.prototype._build=function(Ye,at,gt,jt){var Pt,It=gt-at+1,fe=this._maxEntries;if(It<=fe)return q(Pt=Pn(Ye.slice(at,gt+1)),this.toBBox),Pt;jt||(jt=Math.ceil(Math.log(It)/Math.log(fe)),fe=Math.ceil(It/Math.pow(fe,jt-1))),(Pt=Pn([])).leaf=!1,Pt.height=jt;var Ce=Math.ceil(It/fe),je=Ce*Math.ceil(Math.sqrt(fe));ti(Ye,at,gt,je,this.compareMinX);for(var Fe=at;Fe<=gt;Fe+=je){var qe=Math.min(Fe+je-1,gt);ti(Ye,Fe,qe,Ce,this.compareMinY);for(var Ge=Fe;Ge<=qe;Ge+=Ce){var ht=Math.min(Ge+Ce-1,qe);Pt.children.push(this._build(Ye,Ge,ht,jt-1))}}return q(Pt,this.toBBox),Pt},M.prototype._chooseSubtree=function(Ye,at,gt,jt){for(;jt.push(at),!at.leaf&&jt.length-1!==gt;){for(var Pt=1/0,It=1/0,fe=void 0,Ce=0;Ce<at.children.length;Ce++){var je=at.children[Ce],Fe=xt(je),qe=(Ge=Ye,ht=je,(Math.max(ht.maxX,Ge.maxX)-Math.min(ht.minX,Ge.minX))*(Math.max(ht.maxY,Ge.maxY)-Math.min(ht.minY,Ge.minY))-Fe);qe<It?(It=qe,Pt=Fe<Pt?Fe:Pt,fe=je):qe===It&&Fe<Pt&&(Pt=Fe,fe=je)}at=fe||at.children[0]}var Ge,ht;return at},M.prototype._insert=function(Ye,at,gt){var jt=gt?Ye:this.toBBox(Ye),Pt=[],It=this._chooseSubtree(jt,this.data,at,Pt);for(It.children.push(Ye),be(It,jt);at>=0&&Pt[at].children.length>this._maxEntries;)this._split(Pt,at),at--;this._adjustParentBBoxes(jt,Pt,at)},M.prototype._split=function(Ye,at){var gt=Ye[at],jt=gt.children.length,Pt=this._minEntries;this._chooseSplitAxis(gt,Pt,jt);var It=this._chooseSplitIndex(gt,Pt,jt),fe=Pn(gt.children.splice(It,gt.children.length-It));fe.height=gt.height,fe.leaf=gt.leaf,q(gt,this.toBBox),q(fe,this.toBBox),at?Ye[at-1].children.push(fe):this._splitRoot(gt,fe)},M.prototype._splitRoot=function(Ye,at){this.data=Pn([Ye,at]),this.data.height=Ye.height+1,this.data.leaf=!1,q(this.data,this.toBBox)},M.prototype._chooseSplitIndex=function(Ye,at,gt){for(var jt,Pt,It,fe,Ce,je,Fe,qe=1/0,Ge=1/0,ht=at;ht<=gt-at;ht++){var ft=ce(Ye,0,ht,this.toBBox),yt=ce(Ye,ht,gt,this.toBBox),Tt=(Pt=ft,It=yt,fe=void 0,Ce=void 0,je=void 0,Fe=void 0,fe=Math.max(Pt.minX,It.minX),Ce=Math.max(Pt.minY,It.minY),je=Math.min(Pt.maxX,It.maxX),Fe=Math.min(Pt.maxY,It.maxY),Math.max(0,je-fe)*Math.max(0,Fe-Ce)),Bt=xt(ft)+xt(yt);Tt<qe?(qe=Tt,jt=ht,Ge=Bt<Ge?Bt:Ge):Tt===qe&&Bt<Ge&&(Ge=Bt,jt=ht)}return jt||gt-at},M.prototype._chooseSplitAxis=function(Ye,at,gt){var jt=Ye.leaf?this.compareMinX:Xe,Pt=Ye.leaf?this.compareMinY:He;this._allDistMargin(Ye,at,gt,jt)<this._allDistMargin(Ye,at,gt,Pt)&&Ye.children.sort(jt)},M.prototype._allDistMargin=function(Ye,at,gt,jt){Ye.children.sort(jt);for(var Pt=this.toBBox,It=ce(Ye,0,at,Pt),fe=ce(Ye,gt-at,gt,Pt),Ce=Ot(It)+Ot(fe),je=at;je<gt-at;je++){var Fe=Ye.children[je];be(It,Ye.leaf?Pt(Fe):Fe),Ce+=Ot(It)}for(var qe=gt-at-1;qe>=at;qe--){var Ge=Ye.children[qe];be(fe,Ye.leaf?Pt(Ge):Ge),Ce+=Ot(fe)}return Ce},M.prototype._adjustParentBBoxes=function(Ye,at,gt){for(var jt=gt;jt>=0;jt--)be(at[jt],Ye)},M.prototype._condense=function(Ye){for(var at=Ye.length-1,gt=void 0;at>=0;at--)Ye[at].children.length===0?at>0?(gt=Ye[at-1].children).splice(gt.indexOf(Ye[at]),1):this.clear():q(Ye[at],this.toBBox)},M})}),Wn=l(a=>{Object.defineProperty(a,"__esModule",{value:!0}),a.earthRadius=63710088e-1,a.factors={centimeters:a.earthRadius*100,centimetres:a.earthRadius*100,degrees:a.earthRadius/111325,feet:a.earthRadius*3.28084,inches:a.earthRadius*39.37,kilometers:a.earthRadius/1e3,kilometres:a.earthRadius/1e3,meters:a.earthRadius,metres:a.earthRadius,miles:a.earthRadius/1609.344,millimeters:a.earthRadius*1e3,millimetres:a.earthRadius*1e3,nauticalmiles:a.earthRadius/1852,radians:1,yards:a.earthRadius*1.0936},a.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/a.earthRadius,yards:1.0936133},a.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function c(Fe,qe,Ge){Ge===void 0&&(Ge={});var ht={type:"Feature"};return(Ge.id===0||Ge.id)&&(ht.id=Ge.id),Ge.bbox&&(ht.bbox=Ge.bbox),ht.properties=qe||{},ht.geometry=Fe,ht}a.feature=c;function g(Fe,qe,Ge){switch(Fe){case"Point":return y(qe).geometry;case"LineString":return q(qe).geometry;case"Polygon":return M(qe).geometry;case"MultiPoint":return He(qe).geometry;case"MultiLineString":return Xe(qe).geometry;case"MultiPolygon":return xt(qe).geometry;default:throw new Error(Fe+" is invalid")}}a.geometry=g;function y(Fe,qe,Ge){if(Ge===void 0&&(Ge={}),!Fe)throw new Error("coordinates is required");if(!Array.isArray(Fe))throw new Error("coordinates must be an Array");if(Fe.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!It(Fe[0])||!It(Fe[1]))throw new Error("coordinates must contain numbers");var ht={type:"Point",coordinates:Fe};return c(ht,qe,Ge)}a.point=y;function C(Fe,qe,Ge){return Ge===void 0&&(Ge={}),be(Fe.map(function(ht){return y(ht,qe)}),Ge)}a.points=C;function M(Fe,qe,Ge){Ge===void 0&&(Ge={});for(var ht=0,ft=Fe;ht<ft.length;ht++){var yt=ft[ht];if(yt.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var Tt=0;Tt<yt[yt.length-1].length;Tt++)if(yt[yt.length-1][Tt]!==yt[0][Tt])throw new Error("First and last Position are not equivalent.")}var Bt={type:"Polygon",coordinates:Fe};return c(Bt,qe,Ge)}a.polygon=M;function z(Fe,qe,Ge){return Ge===void 0&&(Ge={}),be(Fe.map(function(ht){return M(ht,qe)}),Ge)}a.polygons=z;function q(Fe,qe,Ge){if(Ge===void 0&&(Ge={}),Fe.length<2)throw new Error("coordinates must be an array of two or more positions");var ht={type:"LineString",coordinates:Fe};return c(ht,qe,Ge)}a.lineString=q;function ce(Fe,qe,Ge){return Ge===void 0&&(Ge={}),be(Fe.map(function(ht){return q(ht,qe)}),Ge)}a.lineStrings=ce;function be(Fe,qe){qe===void 0&&(qe={});var Ge={type:"FeatureCollection"};return qe.id&&(Ge.id=qe.id),qe.bbox&&(Ge.bbox=qe.bbox),Ge.features=Fe,Ge}a.featureCollection=be;function Xe(Fe,qe,Ge){Ge===void 0&&(Ge={});var ht={type:"MultiLineString",coordinates:Fe};return c(ht,qe,Ge)}a.multiLineString=Xe;function He(Fe,qe,Ge){Ge===void 0&&(Ge={});var ht={type:"MultiPoint",coordinates:Fe};return c(ht,qe,Ge)}a.multiPoint=He;function xt(Fe,qe,Ge){Ge===void 0&&(Ge={});var ht={type:"MultiPolygon",coordinates:Fe};return c(ht,qe,Ge)}a.multiPolygon=xt;function Ot(Fe,qe,Ge){Ge===void 0&&(Ge={});var ht={type:"GeometryCollection",geometries:Fe};return c(ht,qe,Ge)}a.geometryCollection=Ot;function en(Fe,qe){if(qe===void 0&&(qe=0),qe&&!(qe>=0))throw new Error("precision must be a positive number");var Ge=Math.pow(10,qe||0);return Math.round(Fe*Ge)/Ge}a.round=en;function bn(Fe,qe){qe===void 0&&(qe="kilometers");var Ge=a.factors[qe];if(!Ge)throw new Error(qe+" units is invalid");return Fe*Ge}a.radiansToLength=bn;function Pn(Fe,qe){qe===void 0&&(qe="kilometers");var Ge=a.factors[qe];if(!Ge)throw new Error(qe+" units is invalid");return Fe/Ge}a.lengthToRadians=Pn;function ti(Fe,qe){return at(Pn(Fe,qe))}a.lengthToDegrees=ti;function Ye(Fe){var qe=Fe%360;return qe<0&&(qe+=360),qe}a.bearingToAzimuth=Ye;function at(Fe){var qe=Fe%(2*Math.PI);return qe*180/Math.PI}a.radiansToDegrees=at;function gt(Fe){var qe=Fe%360;return qe*Math.PI/180}a.degreesToRadians=gt;function jt(Fe,qe,Ge){if(qe===void 0&&(qe="kilometers"),Ge===void 0&&(Ge="kilometers"),!(Fe>=0))throw new Error("length must be a positive number");return bn(Pn(Fe,qe),Ge)}a.convertLength=jt;function Pt(Fe,qe,Ge){if(qe===void 0&&(qe="meters"),Ge===void 0&&(Ge="kilometers"),!(Fe>=0))throw new Error("area must be a positive number");var ht=a.areaFactors[qe];if(!ht)throw new Error("invalid original units");var ft=a.areaFactors[Ge];if(!ft)throw new Error("invalid final units");return Fe/ht*ft}a.convertArea=Pt;function It(Fe){return!isNaN(Fe)&&Fe!==null&&!Array.isArray(Fe)}a.isNumber=It;function fe(Fe){return!!Fe&&Fe.constructor===Object}a.isObject=fe;function Ce(Fe){if(!Fe)throw new Error("bbox is required");if(!Array.isArray(Fe))throw new Error("bbox must be an Array");if(Fe.length!==4&&Fe.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");Fe.forEach(function(qe){if(!It(qe))throw new Error("bbox must only contain numbers")})}a.validateBBox=Ce;function je(Fe){if(!Fe)throw new Error("id is required");if(["string","number"].indexOf(typeof Fe)===-1)throw new Error("id must be a number or a string")}a.validateId=je}),as=l(a=>{Object.defineProperty(a,"__esModule",{value:!0});var c=Wn();function g(at,gt,jt){if(at!==null)for(var Pt,It,fe,Ce,je,Fe,qe,Ge=0,ht=0,ft,yt=at.type,Tt=yt==="FeatureCollection",Bt=yt==="Feature",on=Tt?at.features.length:1,On=0;On<on;On++){qe=Tt?at.features[On].geometry:Bt?at.geometry:at,ft=qe?qe.type==="GeometryCollection":!1,je=ft?qe.geometries.length:1;for(var Fn=0;Fn<je;Fn++){var Jn=0,ir=0;if(Ce=ft?qe.geometries[Fn]:qe,Ce!==null){Fe=Ce.coordinates;var gr=Ce.type;switch(Ge=jt&&(gr==="Polygon"||gr==="MultiPolygon")?1:0,gr){case null:break;case"Point":if(gt(Fe,ht,On,Jn,ir)===!1)return!1;ht++,Jn++;break;case"LineString":case"MultiPoint":for(Pt=0;Pt<Fe.length;Pt++){if(gt(Fe[Pt],ht,On,Jn,ir)===!1)return!1;ht++,gr==="MultiPoint"&&Jn++}gr==="LineString"&&Jn++;break;case"Polygon":case"MultiLineString":for(Pt=0;Pt<Fe.length;Pt++){for(It=0;It<Fe[Pt].length-Ge;It++){if(gt(Fe[Pt][It],ht,On,Jn,ir)===!1)return!1;ht++}gr==="MultiLineString"&&Jn++,gr==="Polygon"&&ir++}gr==="Polygon"&&Jn++;break;case"MultiPolygon":for(Pt=0;Pt<Fe.length;Pt++){for(ir=0,It=0;It<Fe[Pt].length;It++){for(fe=0;fe<Fe[Pt][It].length-Ge;fe++){if(gt(Fe[Pt][It][fe],ht,On,Jn,ir)===!1)return!1;ht++}ir++}Jn++}break;case"GeometryCollection":for(Pt=0;Pt<Ce.geometries.length;Pt++)if(g(Ce.geometries[Pt],gt,jt)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function y(at,gt,jt,Pt){var It=jt;return g(at,function(fe,Ce,je,Fe,qe){Ce===0&&jt===void 0?It=fe:It=gt(It,fe,Ce,je,Fe,qe)},Pt),It}function C(at,gt){var jt;switch(at.type){case"FeatureCollection":for(jt=0;jt<at.features.length&&gt(at.features[jt].properties,jt)!==!1;jt++);break;case"Feature":gt(at.properties,0);break}}function M(at,gt,jt){var Pt=jt;return C(at,function(It,fe){fe===0&&jt===void 0?Pt=It:Pt=gt(Pt,It,fe)}),Pt}function z(at,gt){if(at.type==="Feature")gt(at,0);else if(at.type==="FeatureCollection")for(var jt=0;jt<at.features.length&&gt(at.features[jt],jt)!==!1;jt++);}function q(at,gt,jt){var Pt=jt;return z(at,function(It,fe){fe===0&&jt===void 0?Pt=It:Pt=gt(Pt,It,fe)}),Pt}function ce(at){var gt=[];return g(at,function(jt){gt.push(jt)}),gt}function be(at,gt){var jt,Pt,It,fe,Ce,je,Fe,qe,Ge,ht,ft=0,yt=at.type==="FeatureCollection",Tt=at.type==="Feature",Bt=yt?at.features.length:1;for(jt=0;jt<Bt;jt++){for(je=yt?at.features[jt].geometry:Tt?at.geometry:at,qe=yt?at.features[jt].properties:Tt?at.properties:{},Ge=yt?at.features[jt].bbox:Tt?at.bbox:void 0,ht=yt?at.features[jt].id:Tt?at.id:void 0,Fe=je?je.type==="GeometryCollection":!1,Ce=Fe?je.geometries.length:1,It=0;It<Ce;It++){if(fe=Fe?je.geometries[It]:je,fe===null){if(gt(null,ft,qe,Ge,ht)===!1)return!1;continue}switch(fe.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(gt(fe,ft,qe,Ge,ht)===!1)return!1;break}case"GeometryCollection":{for(Pt=0;Pt<fe.geometries.length;Pt++)if(gt(fe.geometries[Pt],ft,qe,Ge,ht)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}ft++}}function Xe(at,gt,jt){var Pt=jt;return be(at,function(It,fe,Ce,je,Fe){fe===0&&jt===void 0?Pt=It:Pt=gt(Pt,It,fe,Ce,je,Fe)}),Pt}function He(at,gt){be(at,function(jt,Pt,It,fe,Ce){var je=jt===null?null:jt.type;switch(je){case null:case"Point":case"LineString":case"Polygon":return gt(c.feature(jt,It,{bbox:fe,id:Ce}),Pt,0)===!1?!1:void 0}var Fe;switch(je){case"MultiPoint":Fe="Point";break;case"MultiLineString":Fe="LineString";break;case"MultiPolygon":Fe="Polygon";break}for(var qe=0;qe<jt.coordinates.length;qe++){var Ge=jt.coordinates[qe],ht={type:Fe,coordinates:Ge};if(gt(c.feature(ht,It),Pt,qe)===!1)return!1}})}function xt(at,gt,jt){var Pt=jt;return He(at,function(It,fe,Ce){fe===0&&Ce===0&&jt===void 0?Pt=It:Pt=gt(Pt,It,fe,Ce)}),Pt}function Ot(at,gt){He(at,function(jt,Pt,It){var fe=0;if(jt.geometry){var Ce=jt.geometry.type;if(!(Ce==="Point"||Ce==="MultiPoint")){var je,Fe=0,qe=0,Ge=0;if(g(jt,function(ht,ft,yt,Tt,Bt){if(je===void 0||Pt>Fe||Tt>qe||Bt>Ge){je=ht,Fe=Pt,qe=Tt,Ge=Bt,fe=0;return}var on=c.lineString([je,ht],jt.properties);if(gt(on,Pt,It,Bt,fe)===!1)return!1;fe++,je=ht})===!1)return!1}}})}function en(at,gt,jt){var Pt=jt,It=!1;return Ot(at,function(fe,Ce,je,Fe,qe){It===!1&&jt===void 0?Pt=fe:Pt=gt(Pt,fe,Ce,je,Fe,qe),It=!0}),Pt}function bn(at,gt){if(!at)throw new Error("geojson is required");He(at,function(jt,Pt,It){if(jt.geometry!==null){var fe=jt.geometry.type,Ce=jt.geometry.coordinates;switch(fe){case"LineString":if(gt(jt,Pt,It,0,0)===!1)return!1;break;case"Polygon":for(var je=0;je<Ce.length;je++)if(gt(c.lineString(Ce[je],jt.properties),Pt,It,je)===!1)return!1;break}}})}function Pn(at,gt,jt){var Pt=jt;return bn(at,function(It,fe,Ce,je){fe===0&&jt===void 0?Pt=It:Pt=gt(Pt,It,fe,Ce,je)}),Pt}function ti(at,gt){if(gt=gt||{},!c.isObject(gt))throw new Error("options is invalid");var jt=gt.featureIndex||0,Pt=gt.multiFeatureIndex||0,It=gt.geometryIndex||0,fe=gt.segmentIndex||0,Ce=gt.properties,je;switch(at.type){case"FeatureCollection":jt<0&&(jt=at.features.length+jt),Ce=Ce||at.features[jt].properties,je=at.features[jt].geometry;break;case"Feature":Ce=Ce||at.properties,je=at.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":je=at;break;default:throw new Error("geojson is invalid")}if(je===null)return null;var Fe=je.coordinates;switch(je.type){case"Point":case"MultiPoint":return null;case"LineString":return fe<0&&(fe=Fe.length+fe-1),c.lineString([Fe[fe],Fe[fe+1]],Ce,gt);case"Polygon":return It<0&&(It=Fe.length+It),fe<0&&(fe=Fe[It].length+fe-1),c.lineString([Fe[It][fe],Fe[It][fe+1]],Ce,gt);case"MultiLineString":return Pt<0&&(Pt=Fe.length+Pt),fe<0&&(fe=Fe[Pt].length+fe-1),c.lineString([Fe[Pt][fe],Fe[Pt][fe+1]],Ce,gt);case"MultiPolygon":return Pt<0&&(Pt=Fe.length+Pt),It<0&&(It=Fe[Pt].length+It),fe<0&&(fe=Fe[Pt][It].length-fe-1),c.lineString([Fe[Pt][It][fe],Fe[Pt][It][fe+1]],Ce,gt)}throw new Error("geojson is invalid")}function Ye(at,gt){if(gt=gt||{},!c.isObject(gt))throw new Error("options is invalid");var jt=gt.featureIndex||0,Pt=gt.multiFeatureIndex||0,It=gt.geometryIndex||0,fe=gt.coordIndex||0,Ce=gt.properties,je;switch(at.type){case"FeatureCollection":jt<0&&(jt=at.features.length+jt),Ce=Ce||at.features[jt].properties,je=at.features[jt].geometry;break;case"Feature":Ce=Ce||at.properties,je=at.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":je=at;break;default:throw new Error("geojson is invalid")}if(je===null)return null;var Fe=je.coordinates;switch(je.type){case"Point":return c.point(Fe,Ce,gt);case"MultiPoint":return Pt<0&&(Pt=Fe.length+Pt),c.point(Fe[Pt],Ce,gt);case"LineString":return fe<0&&(fe=Fe.length+fe),c.point(Fe[fe],Ce,gt);case"Polygon":return It<0&&(It=Fe.length+It),fe<0&&(fe=Fe[It].length+fe),c.point(Fe[It][fe],Ce,gt);case"MultiLineString":return Pt<0&&(Pt=Fe.length+Pt),fe<0&&(fe=Fe[Pt].length+fe),c.point(Fe[Pt][fe],Ce,gt);case"MultiPolygon":return Pt<0&&(Pt=Fe.length+Pt),It<0&&(It=Fe[Pt].length+It),fe<0&&(fe=Fe[Pt][It].length-fe),c.point(Fe[Pt][It][fe],Ce,gt)}throw new Error("geojson is invalid")}a.coordAll=ce,a.coordEach=g,a.coordReduce=y,a.featureEach=z,a.featureReduce=q,a.findPoint=Ye,a.findSegment=ti,a.flattenEach=He,a.flattenReduce=xt,a.geomEach=be,a.geomReduce=Xe,a.lineEach=bn,a.lineReduce=Pn,a.propEach=C,a.propReduce=M,a.segmentEach=Ot,a.segmentReduce=en}),Ms=l(a=>{Object.defineProperty(a,"__esModule",{value:!0});var c=as();function g(y){var C=[1/0,1/0,-1/0,-1/0];return c.coordEach(y,function(M){C[0]>M[0]&&(C[0]=M[0]),C[1]>M[1]&&(C[1]=M[1]),C[2]<M[0]&&(C[2]=M[0]),C[3]<M[1]&&(C[3]=M[1])}),C}g.default=g,a.default=g}),jr=l((a,c)=>{var g=li(),y=Wn(),C=as(),M=Ms().default,z=C.featureEach;C.coordEach,y.polygon;var q=y.featureCollection;function ce(be){var Xe=new g(be);return Xe.insert=function(He){if(He.type!=="Feature")throw new Error("invalid feature");return He.bbox=He.bbox?He.bbox:M(He),g.prototype.insert.call(this,He)},Xe.load=function(He){var xt=[];return Array.isArray(He)?He.forEach(function(Ot){if(Ot.type!=="Feature")throw new Error("invalid features");Ot.bbox=Ot.bbox?Ot.bbox:M(Ot),xt.push(Ot)}):z(He,function(Ot){if(Ot.type!=="Feature")throw new Error("invalid features");Ot.bbox=Ot.bbox?Ot.bbox:M(Ot),xt.push(Ot)}),g.prototype.load.call(this,xt)},Xe.remove=function(He,xt){if(He.type!=="Feature")throw new Error("invalid feature");return He.bbox=He.bbox?He.bbox:M(He),g.prototype.remove.call(this,He,xt)},Xe.clear=function(){return g.prototype.clear.call(this)},Xe.search=function(He){var xt=g.prototype.search.call(this,this.toBBox(He));return q(xt)},Xe.collides=function(He){return g.prototype.collides.call(this,this.toBBox(He))},Xe.all=function(){var He=g.prototype.all.call(this);return q(He)},Xe.toJSON=function(){return g.prototype.toJSON.call(this)},Xe.fromJSON=function(He){return g.prototype.fromJSON.call(this,He)},Xe.toBBox=function(He){var xt;if(He.bbox)xt=He.bbox;else if(Array.isArray(He)&&He.length===4)xt=He;else if(Array.isArray(He)&&He.length===6)xt=[He[0],He[1],He[3],He[4]];else if(He.type==="Feature")xt=M(He);else if(He.type==="FeatureCollection")xt=M(He);else throw new Error("invalid geojson");return{minX:xt[0],minY:xt[1],maxX:xt[2],maxY:xt[3]}},Xe}c.exports=ce,c.exports.default=ce});Array.prototype.findIndex=Array.prototype.findIndex||function(a){if(this===null)throw new TypeError("Array.prototype.findIndex called on null or undefined");if(typeof a!="function")throw new TypeError("callback must be a function");for(var c=Object(this),g=c.length>>>0,y=arguments[1],C=0;C<g;C++)if(a.call(y,c[C],C,c))return C;return-1},Array.prototype.find=Array.prototype.find||function(a){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof a!="function")throw new TypeError("callback must be a function");for(var c=Object(this),g=c.length>>>0,y=arguments[1],C=0;C<g;C++){var M=c[C];if(a.call(y,M,C,c))return M}},typeof Object.assign!="function"&&(Object.assign=function(a){if(a==null)throw new TypeError("Cannot convert undefined or null to object");a=Object(a);for(var c=1;c<arguments.length;c++){var g=arguments[c];if(g!=null)for(var y in g)Object.prototype.hasOwnProperty.call(g,y)&&(a[y]=g[y])}return a}),function(a){a.forEach(function(c){c.hasOwnProperty("remove")||Object.defineProperty(c,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})}([Element.prototype,CharacterData.prototype,DocumentType.prototype]),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(a,c){if(this==null)throw new TypeError('"this" is null or not defined');var g=Object(this),y=g.length>>>0;if(y===0)return!1;var C=c|0,M=Math.max(C>=0?C:y-Math.abs(C),0);function z(q,ce){return q===ce||typeof q=="number"&&typeof ce=="number"&&isNaN(q)&&isNaN(ce)}for(;M<y;){if(z(g[M],a))return!0;M++}return!1}});var ao={version:"2.18.3"},dn=p(Gi()),si={tooltips:{placeMarker:"Click to place marker",firstVertex:"Click to place first vertex",continueLine:"Click to continue drawing",finishLine:"Click any existing marker to finish",finishPoly:"Click first marker to finish",finishRect:"Click to finish",startCircle:"Click to place circle center",finishCircle:"Click to finish circle",placeCircleMarker:"Click to place circle marker",placeText:"Click to place text",selectFirstLayerFor:"Select first layer for {action}",selectSecondLayerFor:"Select second layer for {action}"},actions:{finish:"Finish",cancel:"Cancel",removeLastVertex:"Remove Last Vertex"},buttonTitles:{drawMarkerButton:"Draw Marker",drawPolyButton:"Draw Polygons",drawLineButton:"Draw Polyline",drawCircleButton:"Draw Circle",drawRectButton:"Draw Rectangle",editButton:"Edit Layers",dragButton:"Drag Layers",cutButton:"Cut Layers",deleteButton:"Remove Layers",drawCircleMarkerButton:"Draw Circle Marker",snappingButton:"Snap dragged marker to other layers and vertices",pinningButton:"Pin shared vertices together",rotateButton:"Rotate Layers",drawTextButton:"Draw Text",scaleButton:"Scale Layers",autoTracingButton:"Auto trace Line",snapGuidesButton:"Show SnapGuides",unionButton:"Union layers",differenceButton:"Subtract layers"},measurements:{totalLength:"Length",segmentLength:"Segment length",area:"Area",radius:"Radius",perimeter:"Perimeter",height:"Height",width:"Width",coordinates:"Position",coordinatesMarker:"Position Marker"}},Er={tooltips:{placeMarker:"Platziere den Marker mit Klick",firstVertex:"Platziere den ersten Marker mit Klick",continueLine:"Klicke, um weiter zu zeichnen",finishLine:"Beende mit Klick auf existierenden Marker",finishPoly:"Beende mit Klick auf ersten Marker",finishRect:"Beende mit Klick",startCircle:"Platziere das Kreiszentrum mit Klick",finishCircle:"Beende den Kreis mit Klick",placeCircleMarker:"Platziere den Kreismarker mit Klick",placeText:"Platziere den Text mit Klick"},actions:{finish:"Beenden",cancel:"Abbrechen",removeLastVertex:"Letzten Vertex löschen"},buttonTitles:{drawMarkerButton:"Marker zeichnen",drawPolyButton:"Polygon zeichnen",drawLineButton:"Polyline zeichnen",drawCircleButton:"Kreis zeichnen",drawRectButton:"Rechteck zeichnen",editButton:"Layer editieren",dragButton:"Layer bewegen",cutButton:"Layer schneiden",deleteButton:"Layer löschen",drawCircleMarkerButton:"Kreismarker zeichnen",snappingButton:"Bewegter Layer an andere Layer oder Vertexe einhacken",pinningButton:"Vertexe an der gleichen Position verknüpfen",rotateButton:"Layer drehen",drawTextButton:"Text zeichnen",scaleButton:"Layer skalieren",autoTracingButton:"Linie automatisch nachzeichen"},measurements:{totalLength:"Länge",segmentLength:"Segment Länge",area:"Fläche",radius:"Radius",perimeter:"Umfang",height:"Höhe",width:"Breite",coordinates:"Position",coordinatesMarker:"Position Marker"}},vr={tooltips:{placeMarker:"Clicca per posizionare un Marker",firstVertex:"Clicca per posizionare il primo vertice",continueLine:"Clicca per continuare a disegnare",finishLine:"Clicca qualsiasi marker esistente per terminare",finishPoly:"Clicca il primo marker per terminare",finishRect:"Clicca per terminare",startCircle:"Clicca per posizionare il punto centrale del cerchio",finishCircle:"Clicca per terminare il cerchio",placeCircleMarker:"Clicca per posizionare un Marker del cherchio"},actions:{finish:"Termina",cancel:"Annulla",removeLastVertex:"Rimuovi l'ultimo vertice"},buttonTitles:{drawMarkerButton:"Disegna Marker",drawPolyButton:"Disegna Poligoni",drawLineButton:"Disegna Polilinea",drawCircleButton:"Disegna Cerchio",drawRectButton:"Disegna Rettangolo",editButton:"Modifica Livelli",dragButton:"Sposta Livelli",cutButton:"Ritaglia Livelli",deleteButton:"Elimina Livelli",drawCircleMarkerButton:"Disegna Marker del Cerchio",snappingButton:"Snap ha trascinato il pennarello su altri strati e vertici",pinningButton:"Pin condiviso vertici insieme",rotateButton:"Ruota livello"}},Lr={tooltips:{placeMarker:"Klik untuk menempatkan marker",firstVertex:"Klik untuk menempatkan vertex pertama",continueLine:"Klik untuk meneruskan digitasi",finishLine:"Klik pada sembarang marker yang ada untuk mengakhiri",finishPoly:"Klik marker pertama untuk mengakhiri",finishRect:"Klik untuk mengakhiri",startCircle:"Klik untuk menempatkan titik pusat lingkaran",finishCircle:"Klik untuk mengakhiri lingkaran",placeCircleMarker:"Klik untuk menempatkan penanda lingkarann"},actions:{finish:"Selesai",cancel:"Batal",removeLastVertex:"Hilangkan Vertex Terakhir"},buttonTitles:{drawMarkerButton:"Digitasi Marker",drawPolyButton:"Digitasi Polygon",drawLineButton:"Digitasi Polyline",drawCircleButton:"Digitasi Lingkaran",drawRectButton:"Digitasi Segi Empat",editButton:"Edit Layer",dragButton:"Geser Layer",cutButton:"Potong Layer",deleteButton:"Hilangkan Layer",drawCircleMarkerButton:"Digitasi Penanda Lingkaran",snappingButton:"Jepretkan penanda yang ditarik ke lapisan dan simpul lain",pinningButton:"Sematkan simpul bersama bersama",rotateButton:"Putar lapisan"}},Ea={tooltips:{placeMarker:"Adaugă un punct",firstVertex:"Apasă aici pentru a adăuga primul Vertex",continueLine:"Apasă aici pentru a continua desenul",finishLine:"Apasă pe orice obiect pentru a finisa desenul",finishPoly:"Apasă pe primul obiect pentru a finisa",finishRect:"Apasă pentru a finisa",startCircle:"Apasă pentru a desena un cerc",finishCircle:"Apasă pentru a finisa un cerc",placeCircleMarker:"Adaugă un punct"},actions:{finish:"Termină",cancel:"Anulează",removeLastVertex:"Șterge ultimul Vertex"},buttonTitles:{drawMarkerButton:"Adaugă o bulină",drawPolyButton:"Desenează un poligon",drawLineButton:"Desenează o linie",drawCircleButton:"Desenează un cerc",drawRectButton:"Desenează un dreptunghi",editButton:"Editează straturile",dragButton:"Mută straturile",cutButton:"Taie straturile",deleteButton:"Șterge straturile",drawCircleMarkerButton:"Desenează marcatorul cercului",snappingButton:"Fixați marcatorul glisat pe alte straturi și vârfuri",pinningButton:"Fixați vârfurile partajate împreună",rotateButton:"Rotiți stratul"}},Po={tooltips:{placeMarker:"Нажмите, чтобы нанести маркер",firstVertex:"Нажмите, чтобы нанести первый объект",continueLine:"Нажмите, чтобы продолжить рисование",finishLine:"Нажмите любой существующий маркер для завершения",finishPoly:"Выберите первую точку, чтобы закончить",finishRect:"Нажмите, чтобы закончить",startCircle:"Нажмите, чтобы добавить центр круга",finishCircle:"Нажмите, чтобы задать радиус",placeCircleMarker:"Нажмите, чтобы нанести круговой маркер"},actions:{finish:"Завершить",cancel:"Отменить",removeLastVertex:"Отменить последнее действие"},buttonTitles:{drawMarkerButton:"Добавить маркер",drawPolyButton:"Рисовать полигон",drawLineButton:"Рисовать кривую",drawCircleButton:"Рисовать круг",drawRectButton:"Рисовать прямоугольник",editButton:"Редактировать слой",dragButton:"Перенести слой",cutButton:"Вырезать слой",deleteButton:"Удалить слой",drawCircleMarkerButton:"Добавить круговой маркер",snappingButton:"Привязать перетаскиваемый маркер к другим слоям и вершинам",pinningButton:"Связать общие точки вместе",rotateButton:"Поворот слоя"}},Eo={tooltips:{placeMarker:"Presiona para colocar un marcador",firstVertex:"Presiona para colocar el primer vértice",continueLine:"Presiona para continuar dibujando",finishLine:"Presiona cualquier marcador existente para finalizar",finishPoly:"Presiona el primer marcador para finalizar",finishRect:"Presiona para finalizar",startCircle:"Presiona para colocar el centro del círculo",finishCircle:"Presiona para finalizar el círculo",placeCircleMarker:"Presiona para colocar un marcador de círculo"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Eliminar último vértice"},buttonTitles:{drawMarkerButton:"Dibujar Marcador",drawPolyButton:"Dibujar Polígono",drawLineButton:"Dibujar Línea",drawCircleButton:"Dibujar Círculo",drawRectButton:"Dibujar Rectángulo",editButton:"Editar Capas",dragButton:"Arrastrar Capas",cutButton:"Cortar Capas",deleteButton:"Eliminar Capas",drawCircleMarkerButton:"Dibujar Marcador de Círculo",snappingButton:"El marcador de Snap arrastrado a otras capas y vértices",pinningButton:"Fijar juntos los vértices compartidos",rotateButton:"Rotar capa"}},Cr={tooltips:{placeMarker:"Klik om een marker te plaatsen",firstVertex:"Klik om het eerste punt te plaatsen",continueLine:"Klik om te blijven tekenen",finishLine:"Klik op een bestaand punt om te beëindigen",finishPoly:"Klik op het eerst punt om te beëindigen",finishRect:"Klik om te beëindigen",startCircle:"Klik om het middelpunt te plaatsen",finishCircle:"Klik om de cirkel te beëindigen",placeCircleMarker:"Klik om een marker te plaatsen"},actions:{finish:"Bewaar",cancel:"Annuleer",removeLastVertex:"Verwijder laatste punt"},buttonTitles:{drawMarkerButton:"Plaats Marker",drawPolyButton:"Teken een vlak",drawLineButton:"Teken een lijn",drawCircleButton:"Teken een cirkel",drawRectButton:"Teken een vierkant",editButton:"Bewerk",dragButton:"Verplaats",cutButton:"Knip",deleteButton:"Verwijder",drawCircleMarkerButton:"Plaats Marker",snappingButton:"Snap gesleepte marker naar andere lagen en hoekpunten",pinningButton:"Speld gedeelde hoekpunten samen",rotateButton:"Laag roteren"}},Ts={tooltips:{placeMarker:"Cliquez pour placer un marqueur",firstVertex:"Cliquez pour placer le premier sommet",continueLine:"Cliquez pour continuer à dessiner",finishLine:"Cliquez sur n'importe quel marqueur pour terminer",finishPoly:"Cliquez sur le premier marqueur pour terminer",finishRect:"Cliquez pour terminer",startCircle:"Cliquez pour placer le centre du cercle",finishCircle:"Cliquez pour finir le cercle",placeCircleMarker:"Cliquez pour placer le marqueur circulaire"},actions:{finish:"Terminer",cancel:"Annuler",removeLastVertex:"Retirer le dernier sommet"},buttonTitles:{drawMarkerButton:"Placer des marqueurs",drawPolyButton:"Dessiner des polygones",drawLineButton:"Dessiner des polylignes",drawCircleButton:"Dessiner un cercle",drawRectButton:"Dessiner un rectangle",editButton:"Éditer des calques",dragButton:"Déplacer des calques",cutButton:"Couper des calques",deleteButton:"Supprimer des calques",drawCircleMarkerButton:"Dessiner un marqueur circulaire",snappingButton:"Glisser le marqueur vers d'autres couches et sommets",pinningButton:"Épingler ensemble les sommets partagés",rotateButton:"Tourner des calques"}},lo={tooltips:{placeMarker:"单击放置标记",firstVertex:"单击放置首个顶点",continueLine:"单击继续绘制",finishLine:"单击任何存在的标记以完成",finishPoly:"单击第一个标记以完成",finishRect:"单击完成",startCircle:"单击放置圆心",finishCircle:"单击完成圆形",placeCircleMarker:"点击放置圆形标记"},actions:{finish:"完成",cancel:"取消",removeLastVertex:"移除最后的顶点"},buttonTitles:{drawMarkerButton:"绘制标记",drawPolyButton:"绘制多边形",drawLineButton:"绘制线段",drawCircleButton:"绘制圆形",drawRectButton:"绘制长方形",editButton:"编辑图层",dragButton:"拖拽图层",cutButton:"剪切图层",deleteButton:"删除图层",drawCircleMarkerButton:"画圆圈标记",snappingButton:"将拖动的标记捕捉到其他图层和顶点",pinningButton:"将共享顶点固定在一起",rotateButton:"旋转图层"}},Bs={tooltips:{placeMarker:"單擊放置標記",firstVertex:"單擊放置第一個頂點",continueLine:"單擊繼續繪製",finishLine:"單擊任何存在的標記以完成",finishPoly:"單擊第一個標記以完成",finishRect:"單擊完成",startCircle:"單擊放置圓心",finishCircle:"單擊完成圓形",placeCircleMarker:"點擊放置圓形標記"},actions:{finish:"完成",cancel:"取消",removeLastVertex:"移除最後一個頂點"},buttonTitles:{drawMarkerButton:"放置標記",drawPolyButton:"繪製多邊形",drawLineButton:"繪製線段",drawCircleButton:"繪製圓形",drawRectButton:"繪製方形",editButton:"編輯圖形",dragButton:"移動圖形",cutButton:"裁切圖形",deleteButton:"刪除圖形",drawCircleMarkerButton:"畫圓圈標記",snappingButton:"將拖動的標記對齊到其他圖層和頂點",pinningButton:"將共享頂點固定在一起",rotateButton:"旋轉圖形"}},sr={tooltips:{placeMarker:"Clique para posicionar o marcador",firstVertex:"Clique para posicionar o primeiro vértice",continueLine:"Clique para continuar desenhando",finishLine:"Clique em qualquer marcador existente para finalizar",finishPoly:"Clique no primeiro marcador para finalizar",finishRect:"Clique para finalizar",startCircle:"Clique para posicionar o centro do círculo",finishCircle:"Clique para finalizar o círculo",placeCircleMarker:"Clique para posicionar o marcador circular",placeText:"Clique para inserir texto"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Remover último vértice"},buttonTitles:{drawMarkerButton:"Desenhar Marcador",drawPolyButton:"Desenhar Polígonos",drawLineButton:"Desenhar Linha Poligonal",drawCircleButton:"Desenhar Círculo",drawRectButton:"Desenhar Retângulo",editButton:"Editar Camadas",dragButton:"Arrastar Camadas",cutButton:"Recortar Camadas",deleteButton:"Remover Camadas",drawCircleMarkerButton:"Desenhar Marcador de Círculo",snappingButton:"Ajustar marcador arrastado a outras camadas e vértices",pinningButton:"Unir vértices compartilhados",rotateButton:"Rotacionar Camadas",drawTextButton:"Desenhar Texto",scaleButton:"Redimensionar Camadas",autoTracingButton:"Traçado Automático de Linha"},measurements:{totalLength:"Comprimento",segmentLength:"Comprimento do Segmento",area:"Área",radius:"Raio",perimeter:"Perímetro",height:"Altura",width:"Largura",coordinates:"Posição",coordinatesMarker:"Marcador de Posição"}},ms={tooltips:{placeMarker:"Clique para colocar marcador",firstVertex:"Clique para colocar primeiro vértice",continueLine:"Clique para continuar a desenhar",finishLine:"Clique num marcador existente para terminar",finishPoly:"Clique no primeiro marcador para terminar",finishRect:"Clique para terminar",startCircle:"Clique para colocar o centro do círculo",finishCircle:"Clique para terminar o círculo",placeCircleMarker:"Clique para colocar marcador de círculo",placeText:"Clique para colocar texto"},actions:{finish:"Terminar",cancel:"Cancelar",removeLastVertex:"Remover Último Vértice"},buttonTitles:{drawMarkerButton:"Desenhar Marcador",drawPolyButton:"Desenhar Polígonos",drawLineButton:"Desenhar Polilinha",drawCircleButton:"Desenhar Círculo",drawRectButton:"Desenhar Retângulo",editButton:"Editar Camadas",dragButton:"Arrastar Camadas",cutButton:"Cortar Camadas",deleteButton:"Remover Camadas",drawCircleMarkerButton:"Desenhar Marcador de Círculo",snappingButton:"Ajustar marcador arrastado a outras camadas e vértices",pinningButton:"Unir vértices partilhados",rotateButton:"Rodar Camadas",drawTextButton:"Desenhar Texto",scaleButton:"Escalar Camadas",autoTracingButton:"Traçado Automático de Linha"},measurements:{totalLength:"Comprimento",segmentLength:"Comprimento do Segmento",area:"Área",radius:"Raio",perimeter:"Perímetro",height:"Altura",width:"Largura",coordinates:"Posição",coordinatesMarker:"Marcador de Posição"}},vs={tooltips:{placeMarker:"Kliknij, aby umieścić znacznik",firstVertex:"Kliknij, aby umieścić pierwszy wierzchołek",continueLine:"Kliknij, aby kontynuować rysowanie",finishLine:"Kliknij dowolny istniejący znacznik, aby zakończyć",finishPoly:"Kliknij pierwszy znacznik, aby zakończyć",finishRect:"Kliknij, aby zakończyć",startCircle:"Kliknij, aby umieścić środek okręgu",finishCircle:"Kliknij, aby zakończyć okrąg",placeCircleMarker:"Kliknij, aby umieścić znacznik okręgu",placeText:"Kliknij, aby umieścić tekst"},actions:{finish:"Zakończ",cancel:"Anuluj",removeLastVertex:"Usuń ostatni wierzchołek"},buttonTitles:{drawMarkerButton:"Rysuj znacznik",drawPolyButton:"Rysuj wielokąt",drawLineButton:"Rysuj linię",drawCircleButton:"Rysuj okrąg",drawRectButton:"Rysuj prostokąt",editButton:"Edytuj warstwy",dragButton:"Przeciągnij warstwy",cutButton:"Wytnij warstwy",deleteButton:"Usuń warstwy",drawCircleMarkerButton:"Rysuj znacznik okrągły",snappingButton:"Przyciągnij przenoszony znacznik do innych warstw i wierzchołków",pinningButton:"Przypnij wspólne wierzchołki razem",rotateButton:"Obróć warstwy",drawTextButton:"Rysuj tekst",scaleButton:"Skaluj warstwy",autoTracingButton:"Automatyczne śledzenie linii"},measurements:{totalLength:"Długość",segmentLength:"Długość odcinka",area:"Obszar",radius:"Promień",perimeter:"Obwód",height:"Wysokość",width:"Szerokość",coordinates:"Pozycja",coordinatesMarker:"Znacznik pozycji"}},fo={tooltips:{placeMarker:"Klicka för att placera markör",firstVertex:"Klicka för att placera första hörnet",continueLine:"Klicka för att fortsätta rita",finishLine:"Klicka på en existerande punkt för att slutföra",finishPoly:"Klicka på den första punkten för att slutföra",finishRect:"Klicka för att slutföra",startCircle:"Klicka för att placera cirkelns centrum",finishCircle:"Klicka för att slutföra cirkeln",placeCircleMarker:"Klicka för att placera cirkelmarkör"},actions:{finish:"Slutför",cancel:"Avbryt",removeLastVertex:"Ta bort sista hörnet"},buttonTitles:{drawMarkerButton:"Rita Markör",drawPolyButton:"Rita Polygoner",drawLineButton:"Rita Linje",drawCircleButton:"Rita Cirkel",drawRectButton:"Rita Rektangel",editButton:"Redigera Lager",dragButton:"Dra Lager",cutButton:"Klipp i Lager",deleteButton:"Ta bort Lager",drawCircleMarkerButton:"Rita Cirkelmarkör",snappingButton:"Snäpp dra markören till andra lager och hörn",pinningButton:"Fäst delade hörn tillsammans",rotateButton:"Rotera lagret"}},Go={tooltips:{placeMarker:"Κάντε κλικ για να τοποθετήσετε Δείκτη",firstVertex:"Κάντε κλικ για να τοποθετήσετε το πρώτο σημείο",continueLine:"Κάντε κλικ για να συνεχίσετε να σχεδιάζετε",finishLine:"Κάντε κλικ σε οποιονδήποτε υπάρχον σημείο για να ολοκληρωθεί",finishPoly:"Κάντε κλικ στο πρώτο σημείο για να τελειώσετε",finishRect:"Κάντε κλικ για να τελειώσετε",startCircle:"Κάντε κλικ για να τοποθετήσετε κέντρο Κύκλου",finishCircle:"Κάντε κλικ για να ολοκληρώσετε τον Κύκλο",placeCircleMarker:"Κάντε κλικ για να τοποθετήσετε Κυκλικό Δείκτη"},actions:{finish:"Τέλος",cancel:"Ακύρωση",removeLastVertex:"Κατάργηση τελευταίου σημείου"},buttonTitles:{drawMarkerButton:"Σχεδίαση Δείκτη",drawPolyButton:"Σχεδίαση Πολυγώνου",drawLineButton:"Σχεδίαση Γραμμής",drawCircleButton:"Σχεδίαση Κύκλου",drawRectButton:"Σχεδίαση Ορθογωνίου",editButton:"Επεξεργασία Επιπέδων",dragButton:"Μεταφορά Επιπέδων",cutButton:"Αποκοπή Επιπέδων",deleteButton:"Κατάργηση Επιπέδων",drawCircleMarkerButton:"Σχεδίαση Κυκλικού Δείκτη",snappingButton:"Προσκόλληση του Δείκτη μεταφοράς σε άλλα Επίπεδα και Κορυφές",pinningButton:"Περικοπή κοινών κορυφών μαζί",rotateButton:"Περιστρέψτε το στρώμα"}},ca={tooltips:{placeMarker:"Kattintson a jelölő elhelyezéséhez",firstVertex:"Kattintson az első pont elhelyezéséhez",continueLine:"Kattintson a következő pont elhelyezéséhez",finishLine:"A befejezéshez kattintson egy meglévő pontra",finishPoly:"A befejezéshez kattintson az első pontra",finishRect:"Kattintson a befejezéshez",startCircle:"Kattintson a kör középpontjának elhelyezéséhez",finishCircle:"Kattintson a kör befejezéséhez",placeCircleMarker:"Kattintson a körjelölő elhelyezéséhez"},actions:{finish:"Befejezés",cancel:"Mégse",removeLastVertex:"Utolsó pont eltávolítása"},buttonTitles:{drawMarkerButton:"Jelölő rajzolása",drawPolyButton:"Poligon rajzolása",drawLineButton:"Vonal rajzolása",drawCircleButton:"Kör rajzolása",drawRectButton:"Négyzet rajzolása",editButton:"Elemek szerkesztése",dragButton:"Elemek mozgatása",cutButton:"Elemek vágása",deleteButton:"Elemek törlése",drawCircleMarkerButton:"Kör jelölő rajzolása",snappingButton:"Kapcsolja a jelöltőt másik elemhez vagy ponthoz",pinningButton:"Közös pontok összekötése",rotateButton:"Fólia elforgatása"}},Za={tooltips:{placeMarker:"Tryk for at placere en markør",firstVertex:"Tryk for at placere det første punkt",continueLine:"Tryk for at fortsætte linjen",finishLine:"Tryk på et eksisterende punkt for at afslutte",finishPoly:"Tryk på det første punkt for at afslutte",finishRect:"Tryk for at afslutte",startCircle:"Tryk for at placere cirklens center",finishCircle:"Tryk for at afslutte cirklen",placeCircleMarker:"Tryk for at placere en cirkelmarkør"},actions:{finish:"Afslut",cancel:"Afbryd",removeLastVertex:"Fjern sidste punkt"},buttonTitles:{drawMarkerButton:"Placer markør",drawPolyButton:"Tegn polygon",drawLineButton:"Tegn linje",drawCircleButton:"Tegn cirkel",drawRectButton:"Tegn firkant",editButton:"Rediger",dragButton:"Træk",cutButton:"Klip",deleteButton:"Fjern",drawCircleMarkerButton:"Tegn cirkelmarkør",snappingButton:"Fastgør trukket markør til andre elementer",pinningButton:"Sammenlæg delte elementer",rotateButton:"Roter laget"}},rs={tooltips:{placeMarker:"Klikk for å plassere punkt",firstVertex:"Klikk for å plassere første punkt",continueLine:"Klikk for å tegne videre",finishLine:"Klikk på et eksisterende punkt for å fullføre",finishPoly:"Klikk første punkt for å fullføre",finishRect:"Klikk for å fullføre",startCircle:"Klikk for å sette sirkel midtpunkt",finishCircle:"Klikk for å fullføre sirkel",placeCircleMarker:"Klikk for å plassere sirkel",placeText:"Klikk for å plassere tekst"},actions:{finish:"Fullfør",cancel:"Kanseller",removeLastVertex:"Fjern forrige punkt"},buttonTitles:{drawMarkerButton:"Tegn punkt",drawPolyButton:"Tegn flate",drawLineButton:"Tegn linje",drawCircleButton:"Tegn sirkel",drawRectButton:"Tegn rektangel",editButton:"Rediger objekter",dragButton:"Dra objekter",cutButton:"Kutt objekter",deleteButton:"Fjern objekter",drawCircleMarkerButton:"Tegn sirkel-punkt",snappingButton:"Fest dratt punkt til andre objekter og punkt",pinningButton:"Pin delte punkter sammen",rotateButton:"Rotér objekter",drawTextButton:"Tegn tekst",scaleButton:"Skalér objekter",autoTracingButton:"Automatisk sporing av linje"},measurements:{totalLength:"Lengde",segmentLength:"Segmentlengde",area:"Område",radius:"Radius",perimeter:"Omriss",height:"Høyde",width:"Bredde",coordinates:"Posisjon",coordinatesMarker:"Posisjonsmarkør"}},ou={tooltips:{placeMarker:"کلیک برای جانمایی نشان",firstVertex:"کلیک برای رسم اولین رأس",continueLine:"کلیک برای ادامه رسم",finishLine:"کلیک روی هر نشان موجود برای پایان",finishPoly:"کلیک روی اولین نشان برای پایان",finishRect:"کلیک برای پایان",startCircle:"کلیک برای رسم مرکز دایره",finishCircle:"کلیک برای پایان رسم دایره",placeCircleMarker:"کلیک برای رسم نشان دایره",placeText:"کلیک برای نوشتن متن"},actions:{finish:"پایان",cancel:"لفو",removeLastVertex:"حذف آخرین رأس"},buttonTitles:{drawMarkerButton:"درج نشان",drawPolyButton:"رسم چندضلعی",drawLineButton:"رسم خط",drawCircleButton:"رسم دایره",drawRectButton:"رسم چهارضلعی",editButton:"ویرایش لایه‌ها",dragButton:"جابجایی لایه‌ها",cutButton:"برش لایه‌ها",deleteButton:"حذف لایه‌ها",drawCircleMarkerButton:"رسم نشان دایره",snappingButton:"نشانگر را به لایه‌ها و رئوس دیگر بکشید",pinningButton:"رئوس مشترک را با هم پین کنید",rotateButton:"چرخش لایه",drawTextButton:"رسم متن",scaleButton:"مقیاس‌گذاری",autoTracingButton:"ردیاب خودکار"},measurements:{totalLength:"طول",segmentLength:"طول بخش",area:"ناحیه",radius:"شعاع",perimeter:"محیط",height:"ارتفاع",width:"عرض",coordinates:"موقعیت",coordinatesMarker:"موقعیت نشان"}},fl={tooltips:{placeMarker:"Натисніть, щоб нанести маркер",firstVertex:"Натисніть, щоб нанести першу вершину",continueLine:"Натисніть, щоб продовжити малювати",finishLine:"Натисніть будь-який існуючий маркер для завершення",finishPoly:"Виберіть перший маркер, щоб завершити",finishRect:"Натисніть, щоб завершити",startCircle:"Натисніть, щоб додати центр кола",finishCircle:"Натисніть, щоб завершити коло",placeCircleMarker:"Натисніть, щоб нанести круговий маркер"},actions:{finish:"Завершити",cancel:"Відмінити",removeLastVertex:"Видалити попередню вершину"},buttonTitles:{drawMarkerButton:"Малювати маркер",drawPolyButton:"Малювати полігон",drawLineButton:"Малювати криву",drawCircleButton:"Малювати коло",drawRectButton:"Малювати прямокутник",editButton:"Редагувати шари",dragButton:"Перенести шари",cutButton:"Вирізати шари",deleteButton:"Видалити шари",drawCircleMarkerButton:"Малювати круговий маркер",snappingButton:"Прив’язати перетягнутий маркер до інших шарів та вершин",pinningButton:"Зв'язати спільні вершини разом",rotateButton:"Повернути шар"}},pi={tooltips:{placeMarker:"İşaretçi yerleştirmek için tıklayın",firstVertex:"İlk tepe noktasını yerleştirmek için tıklayın",continueLine:"Çizime devam etmek için tıklayın",finishLine:"Bitirmek için mevcut herhangi bir işaretçiyi tıklayın",finishPoly:"Bitirmek için ilk işaretçiyi tıklayın",finishRect:"Bitirmek için tıklayın",startCircle:"Daire merkezine yerleştirmek için tıklayın",finishCircle:"Daireyi bitirmek için tıklayın",placeCircleMarker:"Daire işaretçisi yerleştirmek için tıklayın"},actions:{finish:"Bitir",cancel:"İptal",removeLastVertex:"Son köşeyi kaldır"},buttonTitles:{drawMarkerButton:"Çizim İşaretçisi",drawPolyButton:"Çokgenler çiz",drawLineButton:"Çoklu çizgi çiz",drawCircleButton:"Çember çiz",drawRectButton:"Dikdörtgen çiz",editButton:"Katmanları düzenle",dragButton:"Katmanları sürükle",cutButton:"Katmanları kes",deleteButton:"Katmanları kaldır",drawCircleMarkerButton:"Daire işaretçisi çiz",snappingButton:"Sürüklenen işaretçiyi diğer katmanlara ve köşelere yapıştır",pinningButton:"Paylaşılan köşeleri birbirine sabitle",rotateButton:"Katmanı döndür"}},yi={tooltips:{placeMarker:"Kliknutím vytvoříte značku",firstVertex:"Kliknutím vytvoříte první objekt",continueLine:"Kliknutím pokračujte v kreslení",finishLine:"Kliknutí na libovolnou existující značku pro dokončení",finishPoly:"Vyberte první bod pro dokončení",finishRect:"Klikněte pro dokončení",startCircle:"Kliknutím přidejte střed kruhu",finishCircle:"Нажмите, чтобы задать радиус",placeCircleMarker:"Kliknutím nastavte poloměr"},actions:{finish:"Dokončit",cancel:"Zrušit",removeLastVertex:"Zrušit poslední akci"},buttonTitles:{drawMarkerButton:"Přidat značku",drawPolyButton:"Nakreslit polygon",drawLineButton:"Nakreslit křivku",drawCircleButton:"Nakreslit kruh",drawRectButton:"Nakreslit obdélník",editButton:"Upravit vrstvu",dragButton:"Přeneste vrstvu",cutButton:"Vyjmout vrstvu",deleteButton:"Smazat vrstvu",drawCircleMarkerButton:"Přidat kruhovou značku",snappingButton:"Navázat tažnou značku k dalším vrstvám a vrcholům",pinningButton:"Spojit společné body dohromady",rotateButton:"Otočte vrstvu"}},po={tooltips:{placeMarker:"クリックしてマーカーを配置",firstVertex:"クリックして最初の頂点を配置",continueLine:"クリックして描画を続ける",finishLine:"任意のマーカーをクリックして終了",finishPoly:"最初のマーカーをクリックして終了",finishRect:"クリックして終了",startCircle:"クリックして円の中心を配置",finishCircle:"クリックして円の描画を終了",placeCircleMarker:"クリックして円マーカーを配置",placeText:"クリックしてテキストを配置"},actions:{finish:"終了",cancel:"キャンセル",removeLastVertex:"最後の頂点を削除"},buttonTitles:{drawMarkerButton:"マーカーを描画",drawPolyButton:"ポリゴンを描画",drawLineButton:"折れ線を描画",drawCircleButton:"円を描画",drawRectButton:"矩形を描画",editButton:"レイヤーを編集",dragButton:"レイヤーをドラッグ",cutButton:"レイヤーを切り取り",deleteButton:"レイヤーを削除",drawCircleMarkerButton:"円マーカーを描画",snappingButton:"ドラッグしたマーカーを他のレイヤーや頂点にスナップする",pinningButton:"共有する頂点を同時に動かす",rotateButton:"レイヤーを回転",drawTextButton:"テキストを描画"}},Zi={tooltips:{placeMarker:"Klikkaa asettaaksesi merkin",firstVertex:"Klikkaa asettaakseni ensimmäisen osuuden",continueLine:"Klikkaa jatkaaksesi piirtämistä",finishLine:"Klikkaa olemassa olevaa merkkiä lopettaaksesi",finishPoly:"Klikkaa ensimmäistä merkkiä lopettaaksesi",finishRect:"Klikkaa lopettaaksesi",startCircle:"Klikkaa asettaaksesi ympyrän keskipisteen",finishCircle:"Klikkaa lopettaaksesi ympyrän",placeCircleMarker:"Klikkaa asettaaksesi ympyrämerkin",placeText:"Klikkaa asettaaksesi tekstin"},actions:{finish:"Valmis",cancel:"Peruuta",removeLastVertex:"Poista viimeinen osuus"},buttonTitles:{drawMarkerButton:"Piirrä merkkejä",drawPolyButton:"Piirrä monikulmioita",drawLineButton:"Piirrä viivoja",drawCircleButton:"Piirrä ympyrä",drawRectButton:"Piirrä neliskulmioita",editButton:"Muokkaa",dragButton:"Siirrä",cutButton:"Leikkaa",deleteButton:"Poista",drawCircleMarkerButton:"Piirrä ympyrämerkki",snappingButton:"Kiinnitä siirrettävä merkki toisiin muotoihin",pinningButton:"Kiinnitä jaetut muodot yhteen",rotateButton:"Käännä",drawTextButton:"Piirrä tekstiä"}},Nl={tooltips:{placeMarker:"마커 위치를 클릭하세요",firstVertex:"첫번째 꼭지점 위치을 클릭하세요",continueLine:"계속 그리려면 클릭하세요",finishLine:"끝내려면 기존 마커를 클릭하세요",finishPoly:"끝내려면 처음 마커를 클릭하세요",finishRect:"끝내려면 클릭하세요",startCircle:"원의 중심이 될 위치를 클릭하세요",finishCircle:"원을 끝내려면 클릭하세요",placeCircleMarker:"원 마커 위치를 클릭하세요",placeText:"텍스트 위치를 클릭하세요"},actions:{finish:"끝내기",cancel:"취소",removeLastVertex:"마지막 꼭지점 제거"},buttonTitles:{drawMarkerButton:"마커 그리기",drawPolyButton:"다각형 그리기",drawLineButton:"다각선 그리기",drawCircleButton:"원 그리기",drawRectButton:"직사각형 그리기",editButton:"레이어 편집하기",dragButton:"레이어 끌기",cutButton:"레이어 자르기",deleteButton:"레이어 제거하기",drawCircleMarkerButton:"원 마커 그리기",snappingButton:"잡아끈 마커를 다른 레이어 및 꼭지점에 들러붙게 하기",pinningButton:"공유 꼭지점을 함께 찍기",rotateButton:"레이어 회전하기",drawTextButton:"텍스트 그리기"}},Aa={tooltips:{placeMarker:"Маркерди жайгаштыруу үчүн басыңыз",firstVertex:"Биринчи чокуну жайгаштырууну үчүн басыңыз",continueLine:"Сүрөт тартууну улантуу үчүн басыңыз",finishLine:"Аяктоо үчүн учурдагы маркерди басыңыз",finishPoly:"Бүтүрүү үчүн биринчи маркерди басыңыз",finishRect:"Бүтүрүү үчүн басыңыз",startCircle:"Айлананын борборун жайгаштырууну үчүн басыңыз",finishCircle:"Айлананы бүтүрүү үчүн басыңыз",placeCircleMarker:"Тегерек маркерди жайгаштыруу үчүн басыңыз",placeText:"Текстти жайгаштыруу үчүн басыңыз"},actions:{finish:"Аягы",cancel:"Жок кылуу",removeLastVertex:"Акыркы чокуну өчүрүү"},buttonTitles:{drawMarkerButton:"Маркерди чизуу",drawPolyButton:"Полигон чизуу",drawLineButton:"Полилиния чизуу",drawCircleButton:"Дайынды чизуу",drawRectButton:"Прямоугольник чизуу",editButton:"Слоопту түзөтүү",dragButton:"Слоопту карап сүйлөү",cutButton:"Слооптун башын кесүү",deleteButton:"Слооптун өчүрүү",drawCircleMarkerButton:"Дайынды маркерди чизуу",snappingButton:"Башка слооптордун жана вертекстердин арасына чекилдөө",pinningButton:"Бөлүшкөн вертекстерди бирге тутуштуруу",rotateButton:"Слооптун өзгөртүү",drawTextButton:"Текст чизуу",scaleButton:"Слооптун өлчөмүн өзгөртүү",autoTracingButton:"Автоматтык тизмеги чизуу"},measurements:{totalLength:"Узундук",segmentLength:"Сегмент узундугу",area:"Аймак",radius:"Радиус",perimeter:"Периметр",height:"Диаметр",width:"Кенчилик",coordinates:"Координаттар",coordinatesMarker:"Маркердин координаттары"}},ka=ms,go={en:si,de:Er,it:vr,id:Lr,ro:Ea,ru:Po,es:Eo,nl:Cr,fr:Ts,pt:ka,pt_br:sr,pt_pt:ms,zh:lo,zh_tw:Bs,pl:vs,sv:fo,el:Go,hu:ca,da:Za,no:rs,fa:ou,ua:fl,tr:pi,cz:yi,ja:po,fi:Zi,ko:Nl,ky:Aa},ha={_globalEditModeEnabled:!1,enableGlobalEditMode(a){let c={...a};this._globalEditModeEnabled=!0,this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),L.PM.Utils.findLayers(this.map).forEach(g=>{this._isRelevantForEdit(g)&&g.pm.enable(c)}),this.throttledReInitEdit||(this.throttledReInitEdit=L.Util.throttle(this.handleLayerAdditionInGlobalEditMode,100,this)),this._addedLayersEdit={},this.map.on("layeradd",this._layerAddedEdit,this),this.map.on("layeradd",this.throttledReInitEdit,this),this._fireGlobalEditModeToggled(!0)},disableGlobalEditMode(){this._globalEditModeEnabled=!1,L.PM.Utils.findLayers(this.map).forEach(a=>{a.pm.disable()}),this.map.off("layeradd",this._layerAddedEdit,this),this.map.off("layeradd",this.throttledReInitEdit,this),this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),this._fireGlobalEditModeToggled(!1)},globalEditEnabled(){return this.globalEditModeEnabled()},globalEditModeEnabled(){return this._globalEditModeEnabled},toggleGlobalEditMode(a=this.globalOptions){this.globalEditModeEnabled()?this.disableGlobalEditMode():this.enableGlobalEditMode(a)},handleLayerAdditionInGlobalEditMode(){let a=this._addedLayersEdit;if(this._addedLayersEdit={},this.globalEditModeEnabled())for(let c in a){let g=a[c];this._isRelevantForEdit(g)&&g.pm.enable({...this.globalOptions})}},_layerAddedEdit({layer:a}){this._addedLayersEdit[L.stamp(a)]=a},_isRelevantForEdit(a){return a.pm&&!(a instanceof L.LayerGroup)&&(!L.PM.optIn&&!a.options.pmIgnore||L.PM.optIn&&a.options.pmIgnore===!1)&&!a._pmTempLayer&&a.pm.options.allowEditing}},Dl=ha,Ka={_globalDragModeEnabled:!1,enableGlobalDragMode(){let a=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!0,this._addedLayersDrag={},a.forEach(c=>{this._isRelevantForDrag(c)&&c.pm.enableLayerDrag()}),this.throttledReInitDrag||(this.throttledReInitDrag=L.Util.throttle(this.reinitGlobalDragMode,100,this)),this.map.on("layeradd",this._layerAddedDrag,this),this.map.on("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!0)},disableGlobalDragMode(){let a=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!1,a.forEach(c=>{c.pm.disableLayerDrag()}),this.map.off("layeradd",this._layerAddedDrag,this),this.map.off("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!1)},globalDragModeEnabled(){return!!this._globalDragModeEnabled},toggleGlobalDragMode(){this.globalDragModeEnabled()?this.disableGlobalDragMode():this.enableGlobalDragMode()},reinitGlobalDragMode(){let a=this._addedLayersDrag;if(this._addedLayersDrag={},this.globalDragModeEnabled())for(let c in a){let g=a[c];this._isRelevantForDrag(g)&&g.pm.enableLayerDrag()}},_layerAddedDrag({layer:a}){this._addedLayersDrag[L.stamp(a)]=a},_isRelevantForDrag(a){return a.pm&&!(a instanceof L.LayerGroup)&&(!L.PM.optIn&&!a.options.pmIgnore||L.PM.optIn&&a.options.pmIgnore===!1)&&!a._pmTempLayer&&a.pm.options.draggable}},mi=Ka,Bi={_globalRemovalModeEnabled:!1,enableGlobalRemovalMode(){this._globalRemovalModeEnabled=!0,this.map.eachLayer(a=>{this._isRelevantForRemoval(a)&&(a.pm.enabled()&&a.pm.disable(),a.on("click",this.removeLayer,this))}),this.throttledReInitRemoval||(this.throttledReInitRemoval=L.Util.throttle(this.handleLayerAdditionInGlobalRemovalMode,100,this)),this._addedLayersRemoval={},this.map.on("layeradd",this._layerAddedRemoval,this),this.map.on("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!0)},disableGlobalRemovalMode(){this._globalRemovalModeEnabled=!1,this.map.eachLayer(a=>{a.off("click",this.removeLayer,this)}),this.map.off("layeradd",this._layerAddedRemoval,this),this.map.off("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!1)},globalRemovalEnabled(){return this.globalRemovalModeEnabled()},globalRemovalModeEnabled(){return!!this._globalRemovalModeEnabled},toggleGlobalRemovalMode(){this.globalRemovalModeEnabled()?this.disableGlobalRemovalMode():this.enableGlobalRemovalMode()},removeLayer(a){let c=a.target;this._isRelevantForRemoval(c)&&!c.pm.dragging()&&(c.removeFrom(this.map.pm._getContainingLayer()),c.remove(),c instanceof L.LayerGroup?(this._fireRemoveLayerGroup(c),this._fireRemoveLayerGroup(this.map,c)):(c.pm._fireRemove(c),c.pm._fireRemove(this.map,c)))},_isRelevantForRemoval(a){return a.pm&&!(a instanceof L.LayerGroup)&&(!L.PM.optIn&&!a.options.pmIgnore||L.PM.optIn&&a.options.pmIgnore===!1)&&!a._pmTempLayer&&a.pm.options.allowRemoval},handleLayerAdditionInGlobalRemovalMode(){let a=this._addedLayersRemoval;if(this._addedLayersRemoval={},this.globalRemovalModeEnabled())for(let c in a){let g=a[c];this._isRelevantForRemoval(g)&&(g.pm.enabled()&&g.pm.disable(),g.on("click",this.removeLayer,this))}},_layerAddedRemoval({layer:a}){this._addedLayersRemoval[L.stamp(a)]=a}},fa=Bi,au={_globalRotateModeEnabled:!1,enableGlobalRotateMode(){this._globalRotateModeEnabled=!0,L.PM.Utils.findLayers(this.map).filter(a=>a instanceof L.Polyline).forEach(a=>{this._isRelevantForRotate(a)&&a.pm.enableRotate()}),this.throttledReInitRotate||(this.throttledReInitRotate=L.Util.throttle(this.handleLayerAdditionInGlobalRotateMode,100,this)),this._addedLayersRotate={},this.map.on("layeradd",this._layerAddedRotate,this),this.map.on("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},disableGlobalRotateMode(){this._globalRotateModeEnabled=!1,L.PM.Utils.findLayers(this.map).filter(a=>a instanceof L.Polyline).forEach(a=>{a.pm.disableRotate()}),this.map.off("layeradd",this._layerAddedRotate,this),this.map.off("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},globalRotateModeEnabled(){return!!this._globalRotateModeEnabled},toggleGlobalRotateMode(){this.globalRotateModeEnabled()?this.disableGlobalRotateMode():this.enableGlobalRotateMode()},_isRelevantForRotate(a){return a.pm&&a instanceof L.Polyline&&!(a instanceof L.LayerGroup)&&(!L.PM.optIn&&!a.options.pmIgnore||L.PM.optIn&&a.options.pmIgnore===!1)&&!a._pmTempLayer&&a.pm.options.allowRotation},handleLayerAdditionInGlobalRotateMode(){let a=this._addedLayersRotate;if(this._addedLayersRotate={},this.globalRotateModeEnabled())for(let c in a){let g=a[c];this._isRelevantForRemoval(g)&&g.pm.enableRotate()}},_layerAddedRotate({layer:a}){this._addedLayersRotate[L.stamp(a)]=a}},Ja=au,dl=p(Gi()),Ma={_fireDrawStart(a="Draw",c={}){this.__fire(this._map,"pm:drawstart",{shape:this._shape,workingLayer:this._layer},a,c)},_fireDrawEnd(a="Draw",c={}){this.__fire(this._map,"pm:drawend",{shape:this._shape},a,c)},_fireCreate(a,c="Draw",g={}){this.__fire(this._map,"pm:create",{shape:this._shape,marker:a,layer:a},c,g)},_fireCenterPlaced(a="Draw",c={}){let g=a==="Draw"?this._layer:void 0,y=a!=="Draw"?this._layer:void 0;this.__fire(this._layer,"pm:centerplaced",{shape:this._shape,workingLayer:g,layer:y,latlng:this._layer.getLatLng()},a,c)},_fireCut(a,c,g,y="Draw",C={}){this.__fire(a,"pm:cut",{shape:this._shape,layer:c,originalLayer:g},y,C)},_fireEdit(a=this._layer,c="Edit",g={}){this.__fire(a,"pm:edit",{layer:this._layer,shape:this.getShape()},c,g)},_fireEnable(a="Edit",c={}){this.__fire(this._layer,"pm:enable",{layer:this._layer,shape:this.getShape()},a,c)},_fireDisable(a="Edit",c={}){this.__fire(this._layer,"pm:disable",{layer:this._layer,shape:this.getShape()},a,c)},_fireUpdate(a="Edit",c={}){this.__fire(this._layer,"pm:update",{layer:this._layer,shape:this.getShape()},a,c)},_fireMarkerDragStart(a,c=void 0,g="Edit",y={}){this.__fire(this._layer,"pm:markerdragstart",{layer:this._layer,markerEvent:a,shape:this.getShape(),indexPath:c},g,y)},_fireMarkerDrag(a,c=void 0,g="Edit",y={}){this.__fire(this._layer,"pm:markerdrag",{layer:this._layer,markerEvent:a,shape:this.getShape(),indexPath:c},g,y)},_fireMarkerDragEnd(a,c=void 0,g=void 0,y="Edit",C={}){this.__fire(this._layer,"pm:markerdragend",{layer:this._layer,markerEvent:a,shape:this.getShape(),indexPath:c,intersectionReset:g},y,C)},_fireDragStart(a="Edit",c={}){this.__fire(this._layer,"pm:dragstart",{layer:this._layer,shape:this.getShape()},a,c)},_fireDrag(a,c="Edit",g={}){this.__fire(this._layer,"pm:drag",{...a,shape:this.getShape()},c,g)},_fireDragEnd(a="Edit",c={}){this.__fire(this._layer,"pm:dragend",{layer:this._layer,shape:this.getShape()},a,c)},_fireDragEnable(a="Edit",c={}){this.__fire(this._layer,"pm:dragenable",{layer:this._layer,shape:this.getShape()},a,c)},_fireDragDisable(a="Edit",c={}){this.__fire(this._layer,"pm:dragdisable",{layer:this._layer,shape:this.getShape()},a,c)},_fireRemove(a,c=a,g="Edit",y={}){this.__fire(a,"pm:remove",{layer:c,shape:this.getShape()},g,y)},_fireVertexAdded(a,c,g,y="Edit",C={}){this.__fire(this._layer,"pm:vertexadded",{layer:this._layer,workingLayer:this._layer,marker:a,indexPath:c,latlng:g,shape:this.getShape()},y,C)},_fireVertexRemoved(a,c,g="Edit",y={}){this.__fire(this._layer,"pm:vertexremoved",{layer:this._layer,marker:a,indexPath:c,shape:this.getShape()},g,y)},_fireVertexClick(a,c,g="Edit",y={}){this.__fire(this._layer,"pm:vertexclick",{layer:this._layer,markerEvent:a,indexPath:c,shape:this.getShape()},g,y)},_fireIntersect(a,c=this._layer,g="Edit",y={}){this.__fire(c,"pm:intersect",{layer:this._layer,intersection:a,shape:this.getShape()},g,y)},_fireLayerReset(a,c,g="Edit",y={}){this.__fire(this._layer,"pm:layerreset",{layer:this._layer,markerEvent:a,indexPath:c,shape:this.getShape()},g,y)},_fireChange(a,c="Edit",g={}){this.__fire(this._layer,"pm:change",{layer:this._layer,latlngs:a,shape:this.getShape()},c,g)},_fireTextChange(a,c="Edit",g={}){this.__fire(this._layer,"pm:textchange",{layer:this._layer,text:a,shape:this.getShape()},c,g)},_fireTextFocus(a="Edit",c={}){this.__fire(this._layer,"pm:textfocus",{layer:this._layer,shape:this.getShape()},a,c)},_fireTextBlur(a="Edit",c={}){this.__fire(this._layer,"pm:textblur",{layer:this._layer,shape:this.getShape()},a,c)},_fireSnapDrag(a,c,g="Snapping",y={}){this.__fire(a,"pm:snapdrag",c,g,y)},_fireSnap(a,c,g="Snapping",y={}){this.__fire(a,"pm:snap",c,g,y)},_fireUnsnap(a,c,g="Snapping",y={}){this.__fire(a,"pm:unsnap",c,g,y)},_fireRotationEnable(a,c,g="Rotation",y={}){this.__fire(a,"pm:rotateenable",{layer:this._layer,helpLayer:this._rotatePoly,shape:this.getShape()},g,y)},_fireRotationDisable(a,c="Rotation",g={}){this.__fire(a,"pm:rotatedisable",{layer:this._layer,shape:this.getShape()},c,g)},_fireRotationStart(a,c,g="Rotation",y={}){this.__fire(a,"pm:rotatestart",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:this._startAngle,originLatLngs:c},g,y)},_fireRotation(a,c,g,y=this._rotationLayer,C="Rotation",M={}){this.__fire(a,"pm:rotate",{layer:y,helpLayer:this._layer,startAngle:this._startAngle,angle:y.pm.getAngle(),angleDiff:c,oldLatLngs:g,newLatLngs:y.getLatLngs()},C,M)},_fireRotationEnd(a,c,g,y="Rotation",C={}){this.__fire(a,"pm:rotateend",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:c,angle:this._rotationLayer.pm.getAngle(),originLatLngs:g,newLatLngs:this._rotationLayer.getLatLngs()},y,C)},_fireActionClick(a,c,g,y="Toolbar",C={}){this.__fire(this._map,"pm:actionclick",{text:a.text,action:a,btnName:c,button:g},y,C)},_fireButtonClick(a,c,g="Toolbar",y={}){this.__fire(this._map,"pm:buttonclick",{btnName:a,button:c},g,y)},_fireLangChange(a,c,g,y,C="Global",M={}){this.__fire(this.map,"pm:langchange",{oldLang:a,activeLang:c,fallback:g,translations:y},C,M)},_fireGlobalDragModeToggled(a,c="Global",g={}){this.__fire(this.map,"pm:globaldragmodetoggled",{enabled:a,map:this.map},c,g)},_fireGlobalEditModeToggled(a,c="Global",g={}){this.__fire(this.map,"pm:globaleditmodetoggled",{enabled:a,map:this.map},c,g)},_fireGlobalRemovalModeToggled(a,c="Global",g={}){this.__fire(this.map,"pm:globalremovalmodetoggled",{enabled:a,map:this.map},c,g)},_fireGlobalCutModeToggled(a="Global",c={}){this.__fire(this._map,"pm:globalcutmodetoggled",{enabled:!!this._enabled,map:this._map},a,c)},_fireGlobalDrawModeToggled(a="Global",c={}){this.__fire(this._map,"pm:globaldrawmodetoggled",{enabled:this._enabled,shape:this._shape,map:this._map},a,c)},_fireGlobalRotateModeToggled(a="Global",c={}){this.__fire(this.map,"pm:globalrotatemodetoggled",{enabled:this.globalRotateModeEnabled(),map:this.map},a,c)},_fireRemoveLayerGroup(a,c=a,g="Edit",y={}){this.__fire(a,"pm:remove",{layer:c,shape:void 0},g,y)},_fireKeyeventEvent(a,c,g,y="Global",C={}){this.__fire(this.map,"pm:keyevent",{event:a,eventType:c,focusOn:g},y,C)},__fire(a,c,g,y,C={}){g=(0,dl.default)(g,C,{source:y}),L.PM.Utils._fireEvent(a,c,g)}},Ya=Ma,pl=()=>({_lastEvents:{keydown:void 0,keyup:void 0,current:void 0},_initKeyListener(a){this.map=a,L.DomEvent.on(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.on(window,"blur",this._onBlur,this),a.once("unload",this._unbindKeyListenerEvents,this)},_unbindKeyListenerEvents(){L.DomEvent.off(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.off(window,"blur",this._onBlur,this)},_onKeyListener(a){let c="document";this.map.getContainer().contains(a.target)&&(c="map");let g={event:a,eventType:a.type,focusOn:c};this._lastEvents[a.type]=g,this._lastEvents.current=g,this.map.pm._fireKeyeventEvent(a,a.type,c)},_onBlur(a){a.altKey=!1;let c={event:a,eventType:a.type,focusOn:"document"};this._lastEvents[a.type]=c,this._lastEvents.current=c},getLastKeyEvent(a="current"){return this._lastEvents[a]},isShiftKeyPressed(){var a;return(a=this._lastEvents.current)==null?void 0:a.event.shiftKey},isAltKeyPressed(){var a;return(a=this._lastEvents.current)==null?void 0:a.event.altKey},isCtrlKeyPressed(){var a;return(a=this._lastEvents.current)==null?void 0:a.event.ctrlKey},isMetaKeyPressed(){var a;return(a=this._lastEvents.current)==null?void 0:a.event.metaKey},getPressedKey(){var a;return(a=this._lastEvents.current)==null?void 0:a.event.key}}),Oi=pl,qr=p(di());function Qn(a){let c=L.PM.activeLang;return(0,qr.default)(go[c],a)||(0,qr.default)(go.en,a)||a}function Gr(a){for(let c=0;c<a.length;c+=1){let g=a[c];if(Array.isArray(g)){if(Gr(g))return!0}else if(g!=null&&g!=="")return!0}return!1}function Ta(a){return a.reduce((c,g)=>{if(g.length!==0){let y=Array.isArray(g)?Ta(g):g;Array.isArray(y)?y.length!==0&&c.push(y):c.push(y)}return c},[])}function Vo(a,c,g){let y={a:L.CRS.Earth.R,b:63567523142e-4,f:.0033528106647474805},{a:C,b:M,f:z}=y,q=a.lng,ce=a.lat,be=g,Xe=Math.PI,He=c*Xe/180,xt=Math.sin(He),Ot=Math.cos(He),en=(1-z)*Math.tan(ce*Xe/180),bn=1/Math.sqrt(1+en*en),Pn=en*bn,ti=Math.atan2(en,Ot),Ye=bn*xt,at=1-Ye*Ye,gt=at*(C*C-M*M)/(M*M),jt=1+gt/16384*(4096+gt*(-768+gt*(320-175*gt))),Pt=gt/1024*(256+gt*(-128+gt*(74-47*gt))),It=be/(M*jt),fe=2*Math.PI,Ce,je,Fe;for(;Math.abs(It-fe)>1e-12;){Ce=Math.cos(2*ti+It),je=Math.sin(It),Fe=Math.cos(It);let on=Pt*je*(Ce+Pt/4*(Fe*(-1+2*Ce*Ce)-Pt/6*Ce*(-3+4*je*je)*(-3+4*Ce*Ce)));fe=It,It=be/(M*jt)+on}let qe=Pn*je-bn*Fe*Ot,Ge=Math.atan2(Pn*Fe+bn*je*Ot,(1-z)*Math.sqrt(Ye*Ye+qe*qe)),ht=Math.atan2(je*xt,bn*Fe-Pn*je*Ot),ft=z/16*at*(4+z*(4-3*at)),yt=ht-(1-ft)*z*Ye*(It+ft*je*(Ce+ft*Fe*(-1+2*Ce*Ce))),Tt=q+yt*180/Xe,Bt=Ge*180/Xe;return L.latLng(Tt,Bt)}function Ar(a,c,g,y,C=!0){let M,z,q,ce=[];for(let be=0;be<g;be+=1){if(C)M=be*360/g+y,z=Vo(a,M,c),q=L.latLng(z.lng,z.lat);else{let Xe=a.lat+Math.cos(2*be*Math.PI/g)*c,He=a.lng+Math.sin(2*be*Math.PI/g)*c;q=L.latLng(Xe,He)}ce.push(q)}return ce}function gl(a,c,g){c=(c+360)%360;let y=Math.PI/180,C=180/Math.PI,{R:M}=L.CRS.Earth,z=a.lng*y,q=a.lat*y,ce=c*y,be=Math.sin(q),Xe=Math.cos(q),He=Math.cos(g/M),xt=Math.sin(g/M),Ot=Math.asin(be*He+Xe*xt*Math.cos(ce)),en=z+Math.atan2(Math.sin(ce)*xt*Xe,He-be*Math.sin(Ot));en*=C;let bn=en-360,Pn=en<-180?en+360:en;return en=en>180?bn:Pn,L.latLng([Ot*C,en])}function Ao(a,c,g){let y=a.latLngToContainerPoint(c),C=a.latLngToContainerPoint(g),M=Math.atan2(C.y-y.y,C.x-y.x)*180/Math.PI+90;return M+=M<0?360:0,M}function Xa(a,c,g,y){let C=Ao(a,c,g);return gl(c,C,y)}function Qa(a,c,g="asc"){if(!c||Object.keys(c).length===0)return(ce,be)=>ce-be;let y=Object.keys(c),C,M=y.length-1,z={};for(;M>=0;)C=y[M],z[C.toLowerCase()]=c[C],M-=1;function q(ce){if(ce instanceof L.Marker)return"Marker";if(ce instanceof L.Circle)return"Circle";if(ce instanceof L.CircleMarker)return"CircleMarker";if(ce instanceof L.Rectangle)return"Rectangle";if(ce instanceof L.Polygon)return"Polygon";if(ce instanceof L.Polyline)return"Line"}return(ce,be)=>{let Xe,He;if(Xe=q(ce.layer).toLowerCase(),He=q(be.layer).toLowerCase(),!Xe||!He)return 0;let xt=Xe in z?z[Xe]:Number.MAX_SAFE_INTEGER,Ot=He in z?z[He]:Number.MAX_SAFE_INTEGER,en=0;return xt<Ot?en=-1:xt>Ot&&(en=1),g==="desc"?en*-1:en}}function uo(a,c=a.getLatLngs()){return a instanceof L.Polygon?L.polygon(c).getLatLngs():L.polyline(c).getLatLngs()}function el(a,c){var g,y,C,M;if((y=(g=c.options.crs)==null?void 0:g.projection)!=null&&y.MAX_LATITUDE){let z=(M=(C=c.options.crs)==null?void 0:C.projection)==null?void 0:M.MAX_LATITUDE;a.lat=Math.max(Math.min(z,a.lat),-z)}return a}function or(a){return a.options.renderer||a._map&&(a._map._getPaneRenderer(a.options.pane)||a._map.options.renderer||a._map._renderer)||a._renderer}var lu=L.Class.extend({includes:[Dl,mi,fa,Ja,Ya],initialize(a){this.map=a,this.Draw=new L.PM.Draw(a),this.Toolbar=new L.PM.Toolbar(a),this.Keyboard=Oi(),this.globalOptions={snappable:!0,layerGroup:void 0,snappingOrder:["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],panes:{vertexPane:"markerPane",layerPane:"overlayPane",markerPane:"markerPane"},draggable:!0},this.Keyboard._initKeyListener(a)},setLang(a="en",c,g="en"){if(a=a.trim().toLowerCase(),!/^[a-z]{2}$/.test(a)){let C=a.replace(/[-_\s]/g,"-").replace(/^(\w{2})$/,"$1-").match(/([a-z]{2})-?([a-z]{2})?/);if(C){let M=[`${C[1]}_${C[2]}`,`${C[1]}`];for(let z of M)if(go[z]){a=z;break}}}let y=L.PM.activeLang;c&&(go[a]=(0,dn.default)(go[g],c)),L.PM.activeLang=a,this.map.pm.Toolbar.reinit(),this._fireLangChange(y,a,g,go[a])},addControls(a){this.Toolbar.addControls(a)},removeControls(){this.Toolbar.removeControls()},toggleControls(){this.Toolbar.toggleControls()},controlsVisible(){return this.Toolbar.isVisible},enableDraw(a="Polygon",c){a==="Poly"&&(a="Polygon"),this.Draw.enable(a,c)},disableDraw(a="Polygon"){a==="Poly"&&(a="Polygon"),this.Draw.disable(a)},setPathOptions(a,c={}){let g=c.ignoreShapes||[],y=c.merge||!1;this.map.pm.Draw.shapes.forEach(C=>{g.indexOf(C)===-1&&this.map.pm.Draw[C].setPathOptions(a,y)})},getGlobalOptions(){return this.globalOptions},setGlobalOptions(a){let c=(0,dn.default)(this.globalOptions,a);c.editable&&(c.resizeableCircleMarker=c.editable,delete c.editable);let g=!1;this.map.pm.Draw.CircleMarker.enabled()&&!!this.map.pm.Draw.CircleMarker.options.resizeableCircleMarker!=!!c.resizeableCircleMarker&&(this.map.pm.Draw.CircleMarker.disable(),g=!0);let y=!1;this.map.pm.Draw.Circle.enabled()&&!!this.map.pm.Draw.Circle.options.resizeableCircle!=!!c.resizeableCircle&&(this.map.pm.Draw.Circle.disable(),y=!0),this.map.pm.Draw.shapes.forEach(C=>{this.map.pm.Draw[C].setOptions(c)}),g&&this.map.pm.Draw.CircleMarker.enable(),y&&this.map.pm.Draw.Circle.enable(),L.PM.Utils.findLayers(this.map).forEach(C=>{C.pm.setOptions(c)}),this.map.fire("pm:globaloptionschanged"),this.globalOptions=c,this.applyGlobalOptions()},applyGlobalOptions(){L.PM.Utils.findLayers(this.map).forEach(a=>{a.pm.enabled()&&a.pm.applyOptions()})},globalDrawModeEnabled(){return!!this.Draw.getActiveShape()},globalCutModeEnabled(){return!!this.Draw.Cut.enabled()},enableGlobalCutMode(a){return this.Draw.Cut.enable(a)},toggleGlobalCutMode(a){return this.Draw.Cut.toggle(a)},disableGlobalCutMode(){return this.Draw.Cut.disable()},getGeomanLayers(a=!1){let c=L.PM.Utils.findLayers(this.map);if(!a)return c;let g=L.featureGroup();return g._pmTempLayer=!0,c.forEach(y=>{g.addLayer(y)}),g},getGeomanDrawLayers(a=!1){let c=L.PM.Utils.findLayers(this.map).filter(y=>y._drawnByGeoman===!0);if(!a)return c;let g=L.featureGroup();return g._pmTempLayer=!0,c.forEach(y=>{g.addLayer(y)}),g},_getContainingLayer(){return this.globalOptions.layerGroup&&this.globalOptions.layerGroup instanceof L.LayerGroup?this.globalOptions.layerGroup:this.map},_isCRSSimple(){return this.map.options.crs===L.CRS.Simple},_touchEventCounter:0,_addTouchEvents(a){this._touchEventCounter===0&&(L.DomEvent.on(a,"touchmove",this._canvasTouchMove,this),L.DomEvent.on(a,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter+=1},_removeTouchEvents(a){this._touchEventCounter===1&&(L.DomEvent.off(a,"touchmove",this._canvasTouchMove,this),L.DomEvent.off(a,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter=this._touchEventCounter<=1?0:this._touchEventCounter-1},_canvasTouchMove(a){or(this.map)._onMouseMove(this._createMouseEvent("mousemove",a))},_canvasTouchClick(a){let c="";a.type==="touchstart"||a.type==="pointerdown"?c="mousedown":(a.type==="touchend"||a.type==="pointerup"||a.type==="touchcancel"||a.type==="pointercancel")&&(c="mouseup"),c&&or(this.map)._onClick(this._createMouseEvent(c,a))},_createMouseEvent(a,c){let g,y=c.touches[0]||c.changedTouches[0];try{g=new MouseEvent(a,{bubbles:c.bubbles,cancelable:c.cancelable,view:c.view,detail:y.detail,screenX:y.screenX,screenY:y.screenY,clientX:y.clientX,clientY:y.clientY,ctrlKey:c.ctrlKey,altKey:c.altKey,shiftKey:c.shiftKey,metaKey:c.metaKey,button:c.button,relatedTarget:c.relatedTarget})}catch{g=document.createEvent("MouseEvents"),g.initMouseEvent(a,c.bubbles,c.cancelable,c.view,y.detail,y.screenX,y.screenY,y.clientX,y.clientY,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,c.button,c.relatedTarget)}return g}}),ls=lu,mo=L.Control.extend({includes:[Ya],options:{position:"topleft",disableByOtherButtons:!0},initialize(a){this._button=L.Util.extend({},this.options,a)},onAdd(a){return this._map=a,this._map.pm.Toolbar.options.oneBlock?this._container=this._map.pm.Toolbar._createContainer(this.options.position):this._button.tool==="edit"?this._container=this._map.pm.Toolbar.editContainer:this._button.tool==="options"?this._container=this._map.pm.Toolbar.optionsContainer:this._button.tool==="custom"?this._container=this._map.pm.Toolbar.customContainer:this._container=this._map.pm.Toolbar.drawContainer,this._renderButton(),this._container},_renderButton(){let a=this.buttonsDomNode;this.buttonsDomNode=this._makeButton(this._button),a?a.replaceWith(this.buttonsDomNode):this._container.appendChild(this.buttonsDomNode)},onRemove(){return this.buttonsDomNode.remove(),this._container},getText(){return this._button.text},getIconUrl(){return this._button.iconUrl},destroy(){this._button={},this._update()},toggle(a){return typeof a=="boolean"?this._button.toggleStatus=a:this._button.toggleStatus=!this._button.toggleStatus,this._applyStyleClasses(),this._updateActiveAction(this._button),this._button.toggleStatus},toggled(){return this._button.toggleStatus},onCreate(){this.toggle(!1)},disable(){this.toggle(!1),this._button.disabled=!0,this._updateDisabled()},enable(){this._button.disabled=!1,this._updateDisabled(),this._updateActiveAction(this._button)},_triggerClick(a){a&&a.preventDefault(),!this._button.disabled&&(this._button.onClick(a,{button:this,event:a}),this._clicked(a),this._button.afterClick(a,{button:this,event:a}))},_makeButton(a){let c=this.options.position.indexOf("right")>-1?"pos-right":"",g=L.DomUtil.create("div",`button-container  ${c}`,this._container);a.title&&g.setAttribute("title",a.title);let y=L.DomUtil.create("a","leaflet-buttons-control-button",g);y.setAttribute("role","button"),y.setAttribute("tabindex","0"),y.href="#";let C=L.DomUtil.create("div",`leaflet-pm-actions-container ${c}`,g),M=a.actions,z={cancel:{text:Qn("actions.cancel"),title:Qn("actions.cancel"),onClick(){this._triggerClick()}},finishMode:{text:Qn("actions.finish"),title:Qn("actions.finish"),onClick(){this._triggerClick()}},removeLastVertex:{text:Qn("actions.removeLastVertex"),title:Qn("actions.removeLastVertex"),onClick(){this._map.pm.Draw[a.jsClass]._removeLastVertex()}},finish:{text:Qn("actions.finish"),title:Qn("actions.finish"),onClick(ce){this._map.pm.Draw[a.jsClass]._finishShape(ce)}}};a._preparedActions=M.map(ce=>{let be=typeof ce=="string"?ce:ce.name,Xe;if(z[be])Xe=z[be];else if(ce.text)Xe=ce;else return Xe;let He=L.DomUtil.create("a",`leaflet-pm-action ${c} action-${be}`,C);if(He.setAttribute("role","button"),He.setAttribute("tabindex","0"),He.href="#",Xe.title&&(He.title=Xe.title),He.innerHTML=Xe.text,L.DomEvent.disableClickPropagation(He),L.DomEvent.on(He,"click",L.DomEvent.stop),Xe._node=He,!a.disabled&&Xe.onClick){let xt=Ot=>{Ot.preventDefault();let en="",{buttons:bn}=this._map.pm.Toolbar;for(let Pn in bn)if(bn[Pn]._button===a){en=Pn;break}this._fireActionClick(Xe,en,a)};L.DomEvent.addListener(He,"click",xt,this),L.DomEvent.addListener(He,"click",Xe.onClick,this),L.DomEvent.addListener(He,"click",()=>this._updateActiveAction(a))}return Xe}),this._updateActiveAction(a),a.toggleStatus&&L.DomUtil.addClass(g,"active");let q=L.DomUtil.create("div","control-icon",y);return a.iconUrl&&q.setAttribute("src",a.iconUrl),a.className&&L.DomUtil.addClass(q,a.className),L.DomEvent.disableClickPropagation(y),L.DomEvent.on(y,"click",L.DomEvent.stop),a.disabled||(L.DomEvent.addListener(y,"click",this._onBtnClick,this),L.DomEvent.addListener(y,"click",this._triggerClick,this)),a.disabled&&(L.DomUtil.addClass(y,"pm-disabled"),y.setAttribute("aria-disabled","true")),g},_applyStyleClasses(){this._container&&(!this._button.toggleStatus||this._button.cssToggle===!1?(L.DomUtil.removeClass(this.buttonsDomNode,"active"),L.DomUtil.removeClass(this._container,"activeChild")):(L.DomUtil.addClass(this.buttonsDomNode,"active"),L.DomUtil.addClass(this._container,"activeChild")))},_onBtnClick(){if(this._button.disabled)return;this._button.disableOtherButtons&&this._map.pm.Toolbar.triggerClickOnToggledButtons(this);let a="",{buttons:c}=this._map.pm.Toolbar;for(let g in c)if(c[g]._button===this._button){a=g;break}this._fireButtonClick(a,this._button)},_clicked(){this._button.doToggle&&this.toggle()},_updateDisabled(){if(!this._container)return;let a="pm-disabled",c=this.buttonsDomNode.children[0];this._button.disabled?(L.DomUtil.addClass(c,a),c.setAttribute("aria-disabled","true")):(L.DomUtil.removeClass(c,a),c.setAttribute("aria-disabled","false"))},_updateActiveAction(a){var c;(c=a._preparedActions)==null||c.forEach(g=>{g!=null&&g._node&&(g.isActive&&g.isActive.call(this)?L.DomUtil.addClass(g._node,"active-action"):L.DomUtil.removeClass(g._node,"active-action"))})}}),tl=mo;L.Control.PMButton=tl;var vo=L.Class.extend({options:{drawMarker:!0,drawRectangle:!0,drawPolyline:!0,drawPolygon:!0,drawCircle:!0,drawCircleMarker:!0,drawText:!0,editMode:!0,dragMode:!0,cutPolygon:!0,removalMode:!0,rotateMode:!0,snappingOption:!0,drawControls:!0,editControls:!0,optionsControls:!0,customControls:!0,oneBlock:!1,position:"topleft",positions:{draw:"",edit:"",options:"",custom:""}},customButtons:[],initialize(a){this.customButtons=[],this.options.positions={draw:"",edit:"",options:"",custom:""},this.init(a)},reinit(){let a=this.isVisible;this.removeControls(),this._defineButtons(),a&&this.addControls()},init(a){this.map=a,this.buttons={},this.isVisible=!1,this.drawContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-draw leaflet-bar leaflet-control"),this.editContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-edit leaflet-bar leaflet-control"),this.optionsContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-options leaflet-bar leaflet-control"),this.customContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-custom leaflet-bar leaflet-control"),this._defineButtons()},_createContainer(a){let c=`${a}Container`;return this[c]||(this[c]=L.DomUtil.create("div",`leaflet-pm-toolbar leaflet-pm-${a} leaflet-bar leaflet-control`)),this[c]},getButtons(){return this.buttons},addControls(a=this.options){typeof a.editPolygon<"u"&&(a.editMode=a.editPolygon),typeof a.deleteLayer<"u"&&(a.removalMode=a.deleteLayer),L.Util.setOptions(this,a),this.applyIconStyle(),this.isVisible=!0,this._showHideButtons()},applyIconStyle(){let a=this.getButtons(),c={geomanIcons:{drawMarker:"control-icon leaflet-pm-icon-marker",drawPolyline:"control-icon leaflet-pm-icon-polyline",drawRectangle:"control-icon leaflet-pm-icon-rectangle",drawPolygon:"control-icon leaflet-pm-icon-polygon",drawCircle:"control-icon leaflet-pm-icon-circle",drawCircleMarker:"control-icon leaflet-pm-icon-circle-marker",editMode:"control-icon leaflet-pm-icon-edit",dragMode:"control-icon leaflet-pm-icon-drag",cutPolygon:"control-icon leaflet-pm-icon-cut",removalMode:"control-icon leaflet-pm-icon-delete",drawText:"control-icon leaflet-pm-icon-text"}};for(let g in a){let y=a[g];L.Util.setOptions(y,{className:c.geomanIcons[g]})}},removeControls(){let a=this.getButtons();for(let c in a)a[c].remove();this.isVisible=!1},toggleControls(a=this.options){this.isVisible?this.removeControls():this.addControls(a)},_addButton(a,c){return this.buttons[a]=c,this.options[a]=!!this.options[a]||!1,this.buttons[a]},triggerClickOnToggledButtons(a){for(let c in this.buttons){let g=this.buttons[c];g._button.disableByOtherButtons&&g!==a&&g.toggled()&&g._triggerClick()}},toggleButton(a,c,g=!0){a==="editPolygon"&&(a="editMode"),a==="deleteLayer"&&(a="removalMode");let y=a;return g&&this.triggerClickOnToggledButtons(this.buttons[y]),this.buttons[y]?this.buttons[y].toggle(c):!1},_defineButtons(){let a={className:"control-icon leaflet-pm-icon-marker",title:Qn("buttonTitles.drawMarkerButton"),jsClass:"Marker",onClick:()=>{},afterClick:(xt,Ot)=>{this.map.pm.Draw[Ot.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},c={title:Qn("buttonTitles.drawPolyButton"),className:"control-icon leaflet-pm-icon-polygon",jsClass:"Polygon",onClick:()=>{},afterClick:(xt,Ot)=>{this.map.pm.Draw[Ot.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},g={className:"control-icon leaflet-pm-icon-polyline",title:Qn("buttonTitles.drawLineButton"),jsClass:"Line",onClick:()=>{},afterClick:(xt,Ot)=>{this.map.pm.Draw[Ot.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},y={title:Qn("buttonTitles.drawCircleButton"),className:"control-icon leaflet-pm-icon-circle",jsClass:"Circle",onClick:()=>{},afterClick:(xt,Ot)=>{this.map.pm.Draw[Ot.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},C={title:Qn("buttonTitles.drawCircleMarkerButton"),className:"control-icon leaflet-pm-icon-circle-marker",jsClass:"CircleMarker",onClick:()=>{},afterClick:(xt,Ot)=>{this.map.pm.Draw[Ot.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},M={title:Qn("buttonTitles.drawRectButton"),className:"control-icon leaflet-pm-icon-rectangle",jsClass:"Rectangle",onClick:()=>{},afterClick:(xt,Ot)=>{this.map.pm.Draw[Ot.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},z={title:Qn("buttonTitles.editButton"),className:"control-icon leaflet-pm-icon-edit",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalEditMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},q={title:Qn("buttonTitles.dragButton"),className:"control-icon leaflet-pm-icon-drag",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalDragMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},ce={title:Qn("buttonTitles.cutButton"),className:"control-icon leaflet-pm-icon-cut",jsClass:"Cut",onClick:()=>{},afterClick:(xt,Ot)=>{this.map.pm.Draw[Ot.button._button.jsClass].toggle({snappable:!0,cursorMarker:!0,allowSelfIntersection:!1})},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finish","removeLastVertex","cancel"]},be={title:Qn("buttonTitles.deleteButton"),className:"control-icon leaflet-pm-icon-delete",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRemovalMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},Xe={title:Qn("buttonTitles.rotateButton"),className:"control-icon leaflet-pm-icon-rotate",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRotateMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},He={className:"control-icon leaflet-pm-icon-text",title:Qn("buttonTitles.drawTextButton"),jsClass:"Text",onClick:()=>{},afterClick:(xt,Ot)=>{this.map.pm.Draw[Ot.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]};this._addButton("drawMarker",new L.Control.PMButton(a)),this._addButton("drawPolyline",new L.Control.PMButton(g)),this._addButton("drawRectangle",new L.Control.PMButton(M)),this._addButton("drawPolygon",new L.Control.PMButton(c)),this._addButton("drawCircle",new L.Control.PMButton(y)),this._addButton("drawCircleMarker",new L.Control.PMButton(C)),this._addButton("drawText",new L.Control.PMButton(He)),this._addButton("editMode",new L.Control.PMButton(z)),this._addButton("dragMode",new L.Control.PMButton(q)),this._addButton("cutPolygon",new L.Control.PMButton(ce)),this._addButton("removalMode",new L.Control.PMButton(be)),this._addButton("rotateMode",new L.Control.PMButton(Xe))},_showHideButtons(){if(!this.isVisible)return;this.removeControls(),this.isVisible=!0;let a=this.getButtons(),c=[];this.options.drawControls===!1&&(c=c.concat(Object.keys(a).filter(g=>!a[g]._button.tool))),this.options.editControls===!1&&(c=c.concat(Object.keys(a).filter(g=>a[g]._button.tool==="edit"))),this.options.optionsControls===!1&&(c=c.concat(Object.keys(a).filter(g=>a[g]._button.tool==="options"))),this.options.customControls===!1&&(c=c.concat(Object.keys(a).filter(g=>a[g]._button.tool==="custom")));for(let g in a)if(this.options[g]&&c.indexOf(g)===-1){let y=a[g]._button.tool;y||(y="draw"),a[g].setPosition(this._getBtnPosition(y)),a[g].addTo(this.map)}},_getBtnPosition(a){return this.options.positions&&this.options.positions[a]?this.options.positions[a]:this.options.position},setBlockPosition(a,c){this.options.positions[a]=c,this._showHideButtons(),this.changeControlOrder()},getBlockPositions(){return this.options.positions},copyDrawControl(a,c){if(c)typeof c!="object"&&(c={name:c});else throw new TypeError("Button has no name");let g=this._btnNameMapping(a);if(!c.name)throw new TypeError("Button has no name");if(this.buttons[c.name])throw new TypeError("Button with this name already exists");let y=this.map.pm.Draw.createNewDrawInstance(c.name,g);c={...this.buttons[g]._button,...c};let C=this.createCustomControl(c);return{drawInstance:y,control:C}},createCustomControl(a){if(!a.name)throw new TypeError("Button has no name");if(this.buttons[a.name])throw new TypeError("Button with this name already exists");a.onClick||(a.onClick=()=>{}),a.afterClick||(a.afterClick=()=>{}),a.toggle!==!1&&(a.toggle=!0),a.block&&(a.block=a.block.toLowerCase()),(!a.block||a.block==="draw")&&(a.block=""),a.className?a.className.indexOf("control-icon")===-1&&(a.className=`control-icon ${a.className}`):a.className="control-icon";let c={tool:a.block,className:a.className,title:a.title||"",jsClass:a.name,onClick:a.onClick,afterClick:a.afterClick,doToggle:a.toggle,toggleStatus:!1,disableOtherButtons:a.disableOtherButtons??!0,disableByOtherButtons:a.disableByOtherButtons??!0,cssToggle:a.toggle,position:this.options.position,actions:a.actions||[],disabled:!!a.disabled};this.options[a.name]!==!1&&(this.options[a.name]=!0);let g=this._addButton(a.name,new L.Control.PMButton(c));return this.changeControlOrder(),g},controlExists(a){return!!this.getButton(a)},getButton(a){return this.getButtons()[a]},getButtonsInBlock(a){let c={};if(a)for(let g in this.getButtons()){let y=this.getButtons()[g];(y._button.tool===a||a==="draw"&&!y._button.tool)&&(c[g]=y)}return c},changeControlOrder(a=[]){let c=this._shapeMapping(),g=[];a.forEach(M=>{c[M]?g.push(c[M]):g.push(M)});let y=this.getButtons(),C={};g.forEach(M=>{y[M]&&(C[M]=y[M])}),Object.keys(y).filter(M=>!y[M]._button.tool||y[M]._button.tool==="draw").forEach(M=>{g.indexOf(M)===-1&&(C[M]=y[M])}),Object.keys(y).filter(M=>y[M]._button.tool==="edit").forEach(M=>{g.indexOf(M)===-1&&(C[M]=y[M])}),Object.keys(y).filter(M=>y[M]._button.tool==="options").forEach(M=>{g.indexOf(M)===-1&&(C[M]=y[M])}),Object.keys(y).filter(M=>y[M]._button.tool==="custom").forEach(M=>{g.indexOf(M)===-1&&(C[M]=y[M])}),Object.keys(y).forEach(M=>{g.indexOf(M)===-1&&(C[M]=y[M])}),this.map.pm.Toolbar.buttons=C,this._showHideButtons()},getControlOrder(){let a=this.getButtons(),c=[];for(let g in a)c.push(g);return c},changeActionsOfControl(a,c){let g=this._btnNameMapping(a);if(!g)throw new TypeError("No name passed");if(!c)throw new TypeError("No actions passed");if(!this.buttons[g])throw new TypeError("Button with this name not exists");this.buttons[g]._button.actions=c,this.changeControlOrder()},setButtonDisabled(a,c){let g=this._btnNameMapping(a);c?this.buttons[g].disable():this.buttons[g].enable()},_shapeMapping(){return{Marker:"drawMarker",Circle:"drawCircle",Polygon:"drawPolygon",Rectangle:"drawRectangle",Polyline:"drawPolyline",Line:"drawPolyline",CircleMarker:"drawCircleMarker",Edit:"editMode",Drag:"dragMode",Cut:"cutPolygon",Removal:"removalMode",Rotate:"rotateMode",Text:"drawText"}},_btnNameMapping(a){let c=this._shapeMapping();return c[a]?c[a]:a}}),Ba=vo,Na=p(Gi()),ar={_initSnappableMarkers(){this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,this._assignEvents(this._markers),this._layer.off("pm:dragstart",this._unsnap,this),this._layer.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){this._layer.off("pm:dragstart",this._unsnap,this)},_assignEvents(a){a.forEach(c=>{if(Array.isArray(c)){this._assignEvents(c);return}c.off("drag",this._handleSnapping,this),c.on("drag",this._handleSnapping,this),c.off("dragend",this._cleanupSnapping,this),c.on("dragend",this._cleanupSnapping,this)})},_cleanupSnapping(a){if(a){let c=a.target;c._snapped=!1}delete this._snapList,this.throttledList&&(this._map.off("layeradd",this.throttledList,this),this.throttledList=void 0),this._map.off("layerremove",this._handleSnapLayerRemoval,this),this.debugIndicatorLines&&this.debugIndicatorLines.forEach(c=>{c.remove()})},_handleThrottleSnapping(){this.throttledList&&this._createSnapList()},_handleSnapping(a){var q,ce,be;let c=a.target;if(c._snapped=!1,this.throttledList||(this.throttledList=L.Util.throttle(this._handleThrottleSnapping,100,this)),((q=a==null?void 0:a.originalEvent)==null?void 0:q.altKey)||((be=(ce=this._map)==null?void 0:ce.pm)==null?void 0:be.Keyboard.isAltKeyPressed())||(this._snapList===void 0&&(this._createSnapList(),this._map.off("layeradd",this.throttledList,this),this._map.on("layeradd",this.throttledList,this)),this._snapList.length<=0))return!1;let g=this._calcClosestLayer(c.getLatLng(),this._snapList);if(Object.keys(g).length===0)return!1;let y=g.layer instanceof L.Marker||g.layer instanceof L.CircleMarker||!this.options.snapSegment,C;y?C=g.latlng:C=this._checkPrioritiySnapping(g);let M=this.options.snapDistance,z={marker:c,shape:this._shape,snapLatLng:C,segment:g.segment,layer:this._layer,workingLayer:this._layer,layerInteractedWith:g.layer,distance:g.distance};if(this._fireSnapDrag(z.marker,z),this._fireSnapDrag(this._layer,z),g.distance<M){c._orgLatLng=c.getLatLng(),c.setLatLng(C),c._snapped=!0,c._snapInfo=z;let Xe=()=>{this._snapLatLng=C,this._fireSnap(c,z),this._fireSnap(this._layer,z)},He=this._snapLatLng||{},xt=C||{};(He.lat!==xt.lat||He.lng!==xt.lng)&&Xe()}else this._snapLatLng&&(this._unsnap(z),c._snapped=!1,c._snapInfo=void 0,this._fireUnsnap(z.marker,z),this._fireUnsnap(this._layer,z));return!0},_createSnapList(){let a=[],c=[],g=this._map;g.off("layerremove",this._handleSnapLayerRemoval,this),g.on("layerremove",this._handleSnapLayerRemoval,this),g.eachLayer(y=>{if((y instanceof L.Polyline||y instanceof L.Marker||y instanceof L.CircleMarker||y instanceof L.ImageOverlay)&&y.options.snapIgnore!==!0){if(y.options.snapIgnore===void 0&&(!L.PM.optIn&&y.options.pmIgnore===!0||L.PM.optIn&&y.options.pmIgnore!==!1))return;(y instanceof L.Circle||y instanceof L.CircleMarker)&&y.pm&&y.pm._hiddenPolyCircle?a.push(y.pm._hiddenPolyCircle):y instanceof L.ImageOverlay&&(y=L.rectangle(y.getBounds())),a.push(y);let C=L.polyline([],{color:"red",pmIgnore:!0});C._pmTempLayer=!0,c.push(C),(y instanceof L.Circle||y instanceof L.CircleMarker)&&c.push(C)}}),a=a.filter(y=>this._layer!==y),a=a.filter(y=>y._latlng||y._latlngs&&Gr(y._latlngs)),a=a.filter(y=>!y._pmTempLayer),this._otherSnapLayers?(this._otherSnapLayers.forEach(()=>{let y=L.polyline([],{color:"red",pmIgnore:!0});y._pmTempLayer=!0,c.push(y)}),this._snapList=a.concat(this._otherSnapLayers)):this._snapList=a,this.debugIndicatorLines=c},_handleSnapLayerRemoval({layer:a}){if(!a._leaflet_id)return;let c=this._snapList.findIndex(g=>g._leaflet_id===a._leaflet_id);c>-1&&this._snapList.splice(c,1)},_calcClosestLayer(a,c){return this._calcClosestLayers(a,c,1)[0]},_calcClosestLayers(a,c,g=1){let y=[],C={};c.forEach((z,q)=>{var be;if(z._parentCopy&&z._parentCopy===this._layer||((be=z.getLatLngs)==null?void 0:be.call(z).flat(5).length)<2)return;let ce=this._calcLayerDistances(a,z);if(ce.distance=Math.floor(ce.distance),this.debugIndicatorLines){if(!this.debugIndicatorLines[q]){let Xe=L.polyline([],{color:"red",pmIgnore:!0});Xe._pmTempLayer=!0,this.debugIndicatorLines[q]=Xe}this.debugIndicatorLines[q].setLatLngs([a,ce.latlng])}g===1&&(C.distance===void 0||ce.distance-5<=C.distance)?(ce.distance+5<C.distance&&(y=[]),C=ce,C.layer=z,y.push(C)):g!==1&&(C={},C=ce,C.layer=z,y.push(C))}),g!==1&&(y=y.sort((z,q)=>z.distance-q.distance)),g===-1&&(g=y.length);let M=this._getClosestLayerByPriority(y,g);return L.Util.isArray(M)?M:[M]},_calcLayerDistances(a,c){let g=this._map,y=c instanceof L.Marker||c instanceof L.CircleMarker,C=c instanceof L.Polygon,M=a;if(y){let z=c.getLatLng();return{latlng:{...z},distance:this._getDistance(g,z,M)}}return this._calcLatLngDistances(M,c.getLatLngs(),g,C)},_calcLatLngDistances(a,c,g,y=!1){let C,M,z,q=ce=>{ce.forEach((be,Xe)=>{if(Array.isArray(be)){q(be);return}if(this.options.snapSegment){let He=be,xt;y?xt=Xe+1===ce.length?0:Xe+1:xt=Xe+1===ce.length?void 0:Xe+1;let Ot=ce[xt];if(Ot){let en=this._getDistanceToSegment(g,a,He,Ot);(M===void 0||en<M)&&(M=en,z=[He,Ot])}}else{let He=this._getDistance(g,a,be);(M===void 0||He<M)&&(M=He,C=be)}})};return q(c),this.options.snapSegment?{latlng:{...this._getClosestPointOnSegment(g,a,z[0],z[1])},segment:z,distance:M}:{latlng:C,distance:M}},_getClosestLayerByPriority(a,c=1){a=a.sort((z,q)=>z._leaflet_id-q._leaflet_id);let g=["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],y=this._map.pm.globalOptions.snappingOrder||[],C=0,M={};return y.concat(g).forEach(z=>{M[z]||(C+=1,M[z]=C)}),a.sort(Qa("instanceofShape",M)),c===1?a[0]||{}:a.slice(0,c)},_checkPrioritiySnapping(a){let c=this._map,g=a.segment[0],y=a.segment[1],C=a.latlng,M=C;if(this.options.snapVertex){let z=this._getDistance(c,g,C),q=this._getDistance(c,y,C),ce=z<q?g:y,be=z<q?z:q;if(this.options.snapMiddle){let He=L.PM.Utils.calcMiddleLatLng(c,g,y),xt=this._getDistance(c,He,C);xt<z&&xt<q&&(ce=He,be=xt)}let Xe=this.options.snapDistance;be<Xe&&(M=ce)}return{...M}},_unsnap(){delete this._snapLatLng},_getClosestPointOnSegment(a,c,g,y){let C=a.getMaxZoom();C===1/0&&(C=a.getZoom());let M=a.project(c,C),z=a.project(g,C),q=a.project(y,C),ce=L.LineUtil.closestPointOnSegment(M,z,q);return a.unproject(ce,C)},_getDistanceToSegment(a,c,g,y){let C=a.latLngToContainerPoint(c),M=a.latLngToContainerPoint(g),z=a.latLngToContainerPoint(y);return L.LineUtil.pointToSegmentDistance(C,M,z)},_getDistance(a,c,g){return a.latLngToContainerPoint(c).distanceTo(a.latLngToContainerPoint(g))}},to=ar,Ho=L.Class.extend({includes:[to,Ya],options:{snappable:!0,snapDistance:20,snapMiddle:!1,allowSelfIntersection:!0,tooltips:!0,templineStyle:{},hintlineStyle:{color:"#3388ff",dashArray:"5,5"},pathOptions:null,cursorMarker:!0,finishOn:null,markerStyle:{draggable:!0,icon:L.icon()},hideMiddleMarkers:!1,minRadiusCircle:null,maxRadiusCircle:null,minRadiusCircleMarker:null,maxRadiusCircleMarker:null,resizeableCircleMarker:!1,resizeableCircle:!0,markerEditable:!0,continueDrawing:!1,snapSegment:!0,requireSnapToFinish:!1,rectangleAngle:0,textOptions:{text:null,focusAfterDraw:null,removeIfEmpty:null,className:null},snapVertex:!0},setOptions(a){L.Util.setOptions(this,a),this.setStyle(this.options)},setStyle(){},getOptions(){return this.options},initialize(a){let c=new L.Icon.Default;c.options.tooltipAnchor=[0,0],this.options.markerStyle.icon=c,this._map=a,this.shapes=["Marker","CircleMarker","Line","Polygon","Rectangle","Circle","Cut","Text"],this.shapes.forEach(g=>{this[g]=new L.PM.Draw[g](this._map)}),this.Marker.setOptions({continueDrawing:!0}),this.CircleMarker.setOptions({continueDrawing:!0})},setPathOptions(a,c=!1){c?this.options.pathOptions=(0,Na.default)(this.options.pathOptions,a):this.options.pathOptions=a},getShapes(){return this.shapes},getShape(){return this._shape},enable(a,c){if(!a)throw new Error(`Error: Please pass a shape as a parameter. Possible shapes are: ${this.getShapes().join(",")}`);this.disable(),this[a].enable(c)},disable(){this.shapes.forEach(a=>{this[a].disable()})},addControls(){this.shapes.forEach(a=>{this[a].addButton()})},getActiveShape(){let a;return this.shapes.forEach(c=>{this[c]._enabled&&(a=c)}),a},_setGlobalDrawMode(){this._shape==="Cut"?this._fireGlobalCutModeToggled():this._fireGlobalDrawModeToggled();let a=[];this._map.eachLayer(c=>{(c instanceof L.Polyline||c instanceof L.Marker||c instanceof L.Circle||c instanceof L.CircleMarker||c instanceof L.ImageOverlay)&&(c._pmTempLayer||a.push(c))}),this._enabled?a.forEach(c=>{L.PM.Utils.disablePopup(c)}):a.forEach(c=>{L.PM.Utils.enablePopup(c)})},createNewDrawInstance(a,c){let g=this._getShapeFromBtnName(c);if(this[a])throw new TypeError("Draw Type already exists");if(!L.PM.Draw[g])throw new TypeError(`There is no class L.PM.Draw.${g}`);return this[a]=new L.PM.Draw[g](this._map),this[a].toolbarButtonName=a,this[a]._shape=a,this.shapes.push(a),this[c]&&this[a].setOptions(this[c].options),this[a].setOptions(this[a].options),this[a]},_getShapeFromBtnName(a){let c={drawMarker:"Marker",drawCircle:"Circle",drawPolygon:"Polygon",drawPolyline:"Line",drawRectangle:"Rectangle",drawCircleMarker:"CircleMarker",editMode:"Edit",dragMode:"Drag",cutPolygon:"Cut",removalMode:"Removal",rotateMode:"Rotate",drawText:"Text"};return c[a]?c[a]:this[a]?this[a]._shape:a},_finishLayer(a){a.pm&&(a.pm.setOptions(this.options),a.pm._shape=this._shape,a.pm._map=this._map),this._addDrawnLayerProp(a)},_addDrawnLayerProp(a){a._drawnByGeoman=!0},_setPane(a,c){c==="layerPane"?a.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":c==="vertexPane"?a.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":c==="markerPane"&&(a.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},_isFirstLayer(){return(this._map||this._layer._map).pm.getGeomanLayers().length===0}}),Vr=Ho;Vr.Marker=Vr.extend({initialize(a){this._map=a,this._shape="Marker",this.toolbarButtonName="drawMarker"},enable(a){L.Util.setOptions(this,a),this._enabled=!0,this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),this.options.markerStyle),this._setPane(this._hintMarker,"markerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.tooltips&&this._hintMarker.bindTooltip(Qn("tooltips.placeMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this.options.markerEditable&&this._map.eachLayer(c=>{this.isRelevantMarker(c)&&c.pm.enable()}),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createMarker,this),this._hintMarker.remove(),this._map.off("mousemove",this._syncHintMarker,this),this._map.eachLayer(a=>{this.isRelevantMarker(a)&&a.pm.disable()}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(a){this.enabled()?this.disable():this.enable(a)},isRelevantMarker(a){return a instanceof L.Marker&&a.pm&&!a._pmTempLayer&&!a.pm._initTextMarker},_syncHintMarker(a){if(this._hintMarker.setLatLng(a.latlng),this.options.snappable){let c=a;c.target=this._hintMarker,this._handleSnapping(c)}this._fireChange(this._hintMarker.getLatLng(),"Draw")},_createMarker(a){if(!a.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(a.latlng);let c=this._hintMarker.getLatLng(),g=new L.Marker(c,this.options.markerStyle);this._setPane(g,"markerPane"),this._finishLayer(g),g.pm||(g.options.draggable=!1),g.addTo(this._map.pm._getContainingLayer()),g.pm&&this.options.markerEditable?g.pm.enable():g.dragging&&g.dragging.disable(),this._fireCreate(g),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},setStyle(){var a,c;(a=this.options.markerStyle)!=null&&a.icon&&((c=this._hintMarker)==null||c.setIcon(this.options.markerStyle.icon))}});var k=63710088e-1,ge={centimeters:k*100,centimetres:k*100,degrees:k/111325,feet:k*3.28084,inches:k*39.37,kilometers:k/1e3,kilometres:k/1e3,meters:k,metres:k,miles:k/1609.344,millimeters:k*1e3,millimetres:k*1e3,nauticalmiles:k/1852,radians:1,yards:k*1.0936};function Je(a,c,g){g===void 0&&(g={});var y={type:"Feature"};return(g.id===0||g.id)&&(y.id=g.id),g.bbox&&(y.bbox=g.bbox),y.properties=c||{},y.geometry=a,y}function dt(a,c,g){if(g===void 0&&(g={}),!a)throw new Error("coordinates is required");if(!Array.isArray(a))throw new Error("coordinates must be an Array");if(a.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ci(a[0])||!ci(a[1]))throw new Error("coordinates must contain numbers");var y={type:"Point",coordinates:a};return Je(y,c,g)}function kt(a,c,g){if(g===void 0&&(g={}),a.length<2)throw new Error("coordinates must be an array of two or more positions");var y={type:"LineString",coordinates:a};return Je(y,c,g)}function Ut(a,c){c===void 0&&(c={});var g={type:"FeatureCollection"};return c.id&&(g.id=c.id),c.bbox&&(g.bbox=c.bbox),g.features=a,g}function cn(a,c){c===void 0&&(c="kilometers");var g=ge[c];if(!g)throw new Error(c+" units is invalid");return a*g}function Bn(a,c){c===void 0&&(c="kilometers");var g=ge[c];if(!g)throw new Error(c+" units is invalid");return a/g}function Rn(a){var c=a%(2*Math.PI);return c*180/Math.PI}function Yn(a){var c=a%360;return c*Math.PI/180}function ci(a){return!isNaN(a)&&a!==null&&!Array.isArray(a)}function ki(a){var c,g,y={type:"FeatureCollection",features:[]};if(a.type==="Feature"?g=a.geometry:g=a,g.type==="LineString")c=[g.coordinates];else if(g.type==="MultiLineString")c=g.coordinates;else if(g.type==="MultiPolygon")c=[].concat.apply([],g.coordinates);else if(g.type==="Polygon")c=g.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return c.forEach(function(C){c.forEach(function(M){for(var z=0;z<C.length-1;z++)for(var q=z;q<M.length-1;q++)if(!(C===M&&(Math.abs(z-q)===1||z===0&&q===C.length-2&&C[z][0]===C[C.length-1][0]&&C[z][1]===C[C.length-1][1]))){var ce=Sr(C[z][0],C[z][1],C[z+1][0],C[z+1][1],M[q][0],M[q][1],M[q+1][0],M[q+1][1]);ce&&y.features.push(dt([ce[0],ce[1]]))}})}),y}function Sr(a,c,g,y,C,M,z,q){var ce,be,Xe,He,xt,Ot={x:null,y:null,onLine1:!1,onLine2:!1};return ce=(q-M)*(g-a)-(z-C)*(y-c),ce===0?Ot.x!==null&&Ot.y!==null?Ot:!1:(be=c-M,Xe=a-C,He=(z-C)*be-(q-M)*Xe,xt=(g-a)*be-(y-c)*Xe,be=He/ce,Xe=xt/ce,Ot.x=a+be*(g-a),Ot.y=c+be*(y-c),be>=0&&be<=1&&(Ot.onLine1=!0),Xe>=0&&Xe<=1&&(Ot.onLine2=!0),Ot.onLine1&&Ot.onLine2?[Ot.x,Ot.y]:!1)}Vr.Line=Vr.extend({initialize(a){this._map=a,this._shape="Line",this.toolbarButtonName="drawPolyline",this._doesSelfIntersect=!1},enable(a){L.Util.setOptions(this,a),this._enabled=!0,this._markers=[],this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.polyline([],{...this.options.templineStyle,pmIgnore:!1}),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(Qn("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createVertex,this),this.options.finishOn&&this.options.finishOn!=="snap"&&this._map.on(this.options.finishOn,this._finishShape,this),this.options.finishOn==="dblclick"&&(this.tempMapDoubleClickZoomState=this._map.doubleClickZoom._enabled,this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.disable()),this._map.on("mousemove",this._syncHintMarker,this),this._hintMarker.on("move",this._syncHintLine,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this.isRed=!1,this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createVertex,this),this._map.off("mousemove",this._syncHintMarker,this),this.options.finishOn&&this.options.finishOn!=="snap"&&this._map.off(this.options.finishOn,this._finishShape,this),this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.enable(),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(a){this.enabled()?this.disable():this.enable(a)},_syncHintLine(){let a=this._layer.getLatLngs();if(a.length>0){let c=a[a.length-1];this._hintline.setLatLngs([c,this._hintMarker.getLatLng()])}},_syncHintMarker(a){if(this._hintMarker.setLatLng(a.latlng),this.options.snappable){let g=a;g.target=this._hintMarker,this._handleSnapping(g)}this.options.allowSelfIntersection||this._handleSelfIntersection(!0,this._hintMarker.getLatLng());let c=this._layer._defaultShape().slice();c.push(this._hintMarker.getLatLng()),this._change(c)},hasSelfIntersection(){return ki(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersection(a,c){let g=L.polyline(this._layer.getLatLngs());a&&(c||(c=this._hintMarker.getLatLng()),g.addLatLng(c));let y=ki(g.toGeoJSON(15));this._doesSelfIntersect=y.features.length>0,this._doesSelfIntersect?this.isRed||(this.isRed=!0,this._hintline.setStyle({color:"#f00000ff"}),this._fireIntersect(y,this._map,"Draw")):this._hintline.isEmpty()||(this.isRed=!1,this._hintline.setStyle(this.options.hintlineStyle))},_createVertex(a){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,a.latlng),this._doesSelfIntersect))return;this._hintMarker._snapped||this._hintMarker.setLatLng(a.latlng);let c=this._hintMarker.getLatLng(),g=this._layer.getLatLngs(),y=g[g.length-1];if(c.equals(g[0])||g.length>0&&c.equals(y)){this._finishShape();return}this._layer._latlngInfo=this._layer._latlngInfo||[],this._layer._latlngInfo.push({latlng:c,snapInfo:this._hintMarker._snapInfo}),this._layer.addLatLng(c);let C=this._createMarker(c);this._setTooltipText(),this._setHintLineAfterNewVertex(c),this._fireVertexAdded(C,void 0,c,"Draw"),this._change(this._layer.getLatLngs()),this.options.finishOn==="snap"&&this._hintMarker._snapped&&this._finishShape(a)},_setHintLineAfterNewVertex(a){this._hintline.setLatLngs([a,a])},_removeLastVertex(){let a=this._markers;if(a.length<=1){this.disable();return}let c=this._layer.getLatLngs(),g=a[a.length-1],{indexPath:y}=L.PM.Utils.findDeepMarkerIndex(a,g);a.pop(),this._layerGroup.removeLayer(g);let C=a[a.length-1],M=c.indexOf(C.getLatLng());c=c.slice(0,M+1),this._layer.setLatLngs(c),this._layer._latlngInfo.pop(),this._syncHintLine(),this._setTooltipText(),this._fireVertexRemoved(g,y,"Draw"),this._change(this._layer.getLatLngs())},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!1),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let a=this._layer.getLatLngs();if(a.length<=1)return;let c=L.polyline(a,this.options.pathOptions);this._setPane(c,"layerPane"),this._finishLayer(c),c.addTo(this._map.pm._getContainingLayer()),this._fireCreate(c),this.options.snappable&&this._cleanupSnapping();let g=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(g))},_createMarker(a){let c=new L.Marker(a,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(c,"vertexPane"),c._pmTempLayer=!0,this._layerGroup.addLayer(c),this._markers.push(c),c.on("click",this._finishShape,this),c},_setTooltipText(){let{length:a}=this._layer.getLatLngs().flat(),c="";a<=1?c=Qn("tooltips.continueLine"):c=Qn("tooltips.finishLine"),this._hintMarker.setTooltipContent(c)},_change(a){this._fireChange(a,"Draw")},setStyle(){var a,c;(a=this._layer)==null||a.setStyle(this.options.templineStyle),(c=this._hintline)==null||c.setStyle(this.options.hintlineStyle)}}),Vr.Polygon=Vr.Line.extend({initialize(a){this._map=a,this._shape="Polygon",this.toolbarButtonName="drawPolygon"},enable(a){L.PM.Draw.Line.prototype.enable.call(this,a),this._layer.pm._shape="Polygon"},_createMarker(a){let c=new L.Marker(a,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(c,"vertexPane"),c._pmTempLayer=!0,this._layerGroup.addLayer(c),this._markers.push(c),this._layer.getLatLngs().flat().length===1?(c.on("click",this._finishShape,this),this._tempSnapLayerIndex=this._otherSnapLayers.push(c)-1,this.options.snappable&&this._cleanupSnapping()):c.on("click",()=>1),c},_setTooltipText(){let{length:a}=this._layer.getLatLngs().flat(),c="";a<=2?c=Qn("tooltips.continueLine"):c=Qn("tooltips.finishPoly"),this._hintMarker.setTooltipContent(c)},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let a=this._layer.getLatLngs();if(a.length<=2)return;let c=L.polygon(a,this.options.pathOptions);this._setPane(c,"layerPane"),this._finishLayer(c),c.addTo(this._map.pm._getContainingLayer()),this._fireCreate(c),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex;let g=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(g))}}),Vr.Rectangle=Vr.extend({initialize(a){this._map=a,this._shape="Rectangle",this.toolbarButtonName="drawRectangle"},enable(a){if(L.Util.setOptions(this,a),this._enabled=!0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.rectangle([[0,0],[0,0]],this.options.pathOptions),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._startMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-start-marker"}),draggable:!1,zIndexOffset:-100,opacity:this.options.cursorMarker?1:0}),this._setPane(this._startMarker,"vertexPane"),this._startMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._startMarker),this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:150,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(Qn("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this.options.cursorMarker){this._styleMarkers=[];for(let c=0;c<2;c+=1){let g=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-style-marker"}),draggable:!1,zIndexOffset:100});this._setPane(g,"vertexPane"),g._pmTempLayer=!0,this._layerGroup.addLayer(g),this._styleMarkers.push(g)}}this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._placeStartingMarkers,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._finishShape,this),this._map.off("click",this._placeStartingMarkers,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(a){this.enabled()?this.disable():this.enable(a)},_placeStartingMarkers(a){this._hintMarker._snapped||this._hintMarker.setLatLng(a.latlng);let c=this._hintMarker.getLatLng();L.DomUtil.addClass(this._startMarker._icon,"visible"),this._startMarker.setLatLng(c),this.options.cursorMarker&&this._styleMarkers&&this._styleMarkers.forEach(g=>{L.DomUtil.addClass(g._icon,"visible"),g.setLatLng(c)}),this._map.off("click",this._placeStartingMarkers,this),this._map.on("click",this._finishShape,this),this._hintMarker.setTooltipContent(Qn("tooltips.finishRect")),this._setRectangleOrigin()},_setRectangleOrigin(){let a=this._startMarker.getLatLng();a&&(this._layerGroup.addLayer(this._layer),this._layer.setLatLngs([a,a]),this._hintMarker.on("move",this._syncRectangleSize,this))},_syncHintMarker(a){if(this._hintMarker.setLatLng(a.latlng),this.options.snappable){let g=a;g.target=this._hintMarker,this._handleSnapping(g)}let c=this._layerGroup&&this._layerGroup.hasLayer(this._layer)?this._layer.getLatLngs():[this._hintMarker.getLatLng()];this._fireChange(c,"Draw")},_syncRectangleSize(){let a=el(this._startMarker.getLatLng(),this._map),c=el(this._hintMarker.getLatLng(),this._map),g=L.PM.Utils._getRotatedRectangle(a,c,this.options.rectangleAngle||0,this._map);if(this._layer.setLatLngs(g),this.options.cursorMarker&&this._styleMarkers){let y=[];g.forEach(C=>{!C.equals(a,1e-8)&&!C.equals(c,1e-8)&&y.push(C)}),y.forEach((C,M)=>{try{this._styleMarkers[M].setLatLng(C)}catch{}})}},_findCorners(){let a=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(a[0],a[2],this.options.rectangleAngle||0,this._map)},_finishShape(a){this._hintMarker._snapped||this._hintMarker.setLatLng(a.latlng);let c=this._hintMarker.getLatLng(),g=this._startMarker.getLatLng();if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||g.equals(c))return;let y=L.rectangle([g,c],this.options.pathOptions);if(this.options.rectangleAngle){let M=L.PM.Utils._getRotatedRectangle(g,c,this.options.rectangleAngle||0,this._map);y.setLatLngs(M),y.pm&&y.pm._setAngle(this.options.rectangleAngle||0)}this._setPane(y,"layerPane"),this._finishLayer(y),y.addTo(this._map.pm._getContainingLayer()),this._fireCreate(y);let C=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(C))},setStyle(){var a;(a=this._layer)==null||a.setStyle(this.options.pathOptions)}}),Vr.CircleMarker=Vr.extend({initialize(a){this._map=a,this._shape="CircleMarker",this.toolbarButtonName="drawCircleMarker",this._layerIsDragging=!1,this._BaseCircleClass=L.CircleMarker,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._defaultRadius=10},enable(a){if(L.Util.setOptions(this,a),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),this._enabled=!0,this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._map.getContainer().classList.add("geoman-draw-cursor"),this.options[this._editableOption]){let c={};L.extend(c,this.options.templineStyle),c.radius=0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=new this._BaseCircleClass(this._map.getCenter(),c),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._centerMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon"}),draggable:!1,zIndexOffset:100}),this._setPane(this._centerMarker,"vertexPane"),this._centerMarker._pmTempLayer=!0,this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:110,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(Qn("tooltips.startCircle"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._map.on("click",this._placeCenterMarker,this)}else this._map.on("click",this._createMarker,this),this._hintMarker=new this._BaseCircleClass(this._map.getCenter(),{radius:this._defaultRadius,...this.options.templineStyle}),this._setPane(this._hintMarker,"layerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this._layer=this._hintMarker,this.options.tooltips&&this._hintMarker.bindTooltip(Qn("tooltips.placeCircleMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip();this._map.on("mousemove",this._syncHintMarker,this),this._extendingEnable(),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},_extendingEnable(){!this.options[this._editableOption]&&this.options.markerEditable&&this._map.eachLayer(a=>{this.isRelevantMarker(a)&&a.pm.enable()}),this._layer.bringToBack()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this.options[this._editableOption]?(this._map.off("click",this._finishShape,this),this._map.off("click",this._placeCenterMarker,this),this._map.removeLayer(this._layerGroup)):(this._map.off("click",this._createMarker,this),this._extendingDisable(),this._hintMarker.remove()),this._map.off("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},_extendingDisable(){this._map.eachLayer(a=>{this.isRelevantMarker(a)&&a.pm.disable()})},enabled(){return this._enabled},toggle(a){this.enabled()?this.disable():this.enable(a)},_placeCenterMarker(a){this._hintMarker._snapped||this._hintMarker.setLatLng(a.latlng),this._layerGroup.addLayer(this._layer),this._layerGroup.addLayer(this._centerMarker);let c=this._hintMarker.getLatLng();this._centerMarker.setLatLng(c),this._map.off("click",this._placeCenterMarker,this),this._map.on("click",this._finishShape,this),this._placeCircleCenter()},_placeCircleCenter(){let a=this._centerMarker.getLatLng();a&&(this._layer.setLatLng(a),this._hintMarker.on("move",this._syncHintLine,this),this._hintMarker.on("move",this._syncCircleRadius,this),this._hintMarker.setTooltipContent(Qn("tooltips.finishCircle")),this._fireCenterPlaced(),this._fireChange(this._layer.getLatLng(),"Draw"))},_syncHintLine(){let a=this._centerMarker.getLatLng(),c=this._getNewDestinationOfHintMarker();this._hintline.setLatLngs([a,c])},_syncCircleRadius(){let a=this._centerMarker.getLatLng(),c=this._hintMarker.getLatLng(),g=this._distanceCalculation(a,c);this.options[this._minRadiusOption]&&g<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&g>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(g)},_syncHintMarker(a){if(this._hintMarker.setLatLng(a.latlng),this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker()),this.options.snappable){let g=a;g.target=this._hintMarker,this._handleSnapping(g)}this._handleHintMarkerSnapping();let c=this._layerGroup&&this._layerGroup.hasLayer(this._centerMarker)?this._centerMarker.getLatLng():this._hintMarker.getLatLng();this._fireChange(c,"Draw")},isRelevantMarker(a){return a instanceof L.CircleMarker&&!(a instanceof L.Circle)&&a.pm&&!a._pmTempLayer},_createMarker(a){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||!a.latlng||this._layerIsDragging)return;this._hintMarker._snapped||this._hintMarker.setLatLng(a.latlng);let c=this._hintMarker.getLatLng(),g=new this._BaseCircleClass(c,{radius:this._defaultRadius,...this.options.pathOptions});this._setPane(g,"layerPane"),this._finishLayer(g),g.addTo(this._map.pm._getContainingLayer()),this._extendingCreateMarker(g),this._fireCreate(g),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},_extendingCreateMarker(a){a.pm&&this.options.markerEditable&&a.pm.enable()},_finishShape(a){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(a.latlng);let c=this._centerMarker.getLatLng(),g=this._defaultRadius;if(this.options[this._editableOption]){let z=this._hintMarker.getLatLng();g=this._distanceCalculation(c,z),this.options[this._minRadiusOption]&&g<this.options[this._minRadiusOption]?g=this.options[this._minRadiusOption]:this.options[this._maxRadiusOption]&&g>this.options[this._maxRadiusOption]&&(g=this.options[this._maxRadiusOption])}let y={...this.options.pathOptions,radius:g},C=new this._BaseCircleClass(c,y);this._setPane(C,"layerPane"),this._finishLayer(C),C.addTo(this._map.pm._getContainingLayer()),C.pm&&C.pm._updateHiddenPolyCircle(),this._fireCreate(C);let M=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(M))},_getNewDestinationOfHintMarker(){let a=this._hintMarker.getLatLng();if(this.options[this._editableOption]){if(!this._layerGroup.hasLayer(this._centerMarker))return a;let c=this._centerMarker.getLatLng(),g=this._distanceCalculation(c,a);this.options[this._minRadiusOption]&&g<this.options[this._minRadiusOption]?a=Xa(this._map,c,a,this._getMinDistanceInMeter()):this.options[this._maxRadiusOption]&&g>this.options[this._maxRadiusOption]&&(a=Xa(this._map,c,a,this._getMaxDistanceInMeter()))}return a},_getMinDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,this._centerMarker.getLatLng())},_getMaxDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,this._centerMarker.getLatLng())},_handleHintMarkerSnapping(){if(this.options[this._editableOption]){if(this._hintMarker._snapped){let a=this._centerMarker.getLatLng(),c=this._hintMarker.getLatLng(),g=this._distanceCalculation(a,c);this._layerGroup.hasLayer(this._centerMarker)&&(this.options[this._minRadiusOption]&&g<this.options[this._minRadiusOption]?this._hintMarker.setLatLng(this._hintMarker._orgLatLng):this.options[this._maxRadiusOption]&&g>this.options[this._maxRadiusOption]&&this._hintMarker.setLatLng(this._hintMarker._orgLatLng))}this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker())}},setStyle(){var c,g;let a={};L.extend(a,this.options.templineStyle),this.options[this._editableOption]&&(a.radius=0),(c=this._layer)==null||c.setStyle(a),(g=this._hintline)==null||g.setStyle(this.options.hintlineStyle)},_distanceCalculation(a,c){return this._map.project(a).distanceTo(this._map.project(c))}}),Vr.Circle=Vr.CircleMarker.extend({initialize(a){this._map=a,this._shape="Circle",this.toolbarButtonName="drawCircle",this._BaseCircleClass=L.Circle,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizeableCircle",this._defaultRadius=100},_extendingEnable(){},_extendingDisable(){},_extendingCreateMarker(){},isRelevantMarker(){},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_distanceCalculation(a,c){return this._map.distance(a,c)}});function er(a){if(!a)throw new Error("coord is required");if(!Array.isArray(a)){if(a.type==="Feature"&&a.geometry!==null&&a.geometry.type==="Point")return a.geometry.coordinates;if(a.type==="Point")return a.coordinates}if(Array.isArray(a)&&a.length>=2&&!Array.isArray(a[0])&&!Array.isArray(a[1]))return a;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function lr(a){if(Array.isArray(a))return a;if(a.type==="Feature"){if(a.geometry!==null)return a.geometry.coordinates}else if(a.coordinates)return a.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Hr(a){return a.type==="Feature"?a.geometry:a}function Qr(a,c){return a.type==="FeatureCollection"?"FeatureCollection":a.type==="GeometryCollection"?"GeometryCollection":a.type==="Feature"&&a.geometry!==null?a.geometry.type:a.type}function no(a,c,g){if(a!==null)for(var y,C,M,z,q,ce,be,Xe=0,He=0,xt,Ot=a.type,en=Ot==="FeatureCollection",bn=Ot==="Feature",Pn=en?a.features.length:1,ti=0;ti<Pn;ti++){be=en?a.features[ti].geometry:bn?a.geometry:a,xt=be?be.type==="GeometryCollection":!1,q=xt?be.geometries.length:1;for(var Ye=0;Ye<q;Ye++){var at=0,gt=0;if(z=xt?be.geometries[Ye]:be,z!==null){ce=z.coordinates;var jt=z.type;switch(Xe=0,jt){case null:break;case"Point":if(c(ce,He,ti,at,gt)===!1)return!1;He++,at++;break;case"LineString":case"MultiPoint":for(y=0;y<ce.length;y++){if(c(ce[y],He,ti,at,gt)===!1)return!1;He++,jt==="MultiPoint"&&at++}jt==="LineString"&&at++;break;case"Polygon":case"MultiLineString":for(y=0;y<ce.length;y++){for(C=0;C<ce[y].length-Xe;C++){if(c(ce[y][C],He,ti,at,gt)===!1)return!1;He++}jt==="MultiLineString"&&at++,jt==="Polygon"&&gt++}jt==="Polygon"&&at++;break;case"MultiPolygon":for(y=0;y<ce.length;y++){for(gt=0,C=0;C<ce[y].length;C++){for(M=0;M<ce[y][C].length-Xe;M++){if(c(ce[y][C][M],He,ti,at,gt)===!1)return!1;He++}gt++}at++}break;case"GeometryCollection":for(y=0;y<z.geometries.length;y++)if(no(z.geometries[y],c)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Mi(a,c){if(a.type==="Feature")c(a,0);else if(a.type==="FeatureCollection")for(var g=0;g<a.features.length&&c(a.features[g],g)!==!1;g++);}function ys(a,c,g){var y=g;return Mi(a,function(C,M){M===0&&g===void 0?y=C:y=c(y,C,M)}),y}function Da(a,c){var g,y,C,M,z,q,ce,be,Xe,He,xt=0,Ot=a.type==="FeatureCollection",en=a.type==="Feature",bn=Ot?a.features.length:1;for(g=0;g<bn;g++){for(q=Ot?a.features[g].geometry:en?a.geometry:a,be=Ot?a.features[g].properties:en?a.properties:{},Xe=Ot?a.features[g].bbox:en?a.bbox:void 0,He=Ot?a.features[g].id:en?a.id:void 0,ce=q?q.type==="GeometryCollection":!1,z=ce?q.geometries.length:1,C=0;C<z;C++){if(M=ce?q.geometries[C]:q,M===null){if(c(null,xt,be,Xe,He)===!1)return!1;continue}switch(M.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(c(M,xt,be,Xe,He)===!1)return!1;break}case"GeometryCollection":{for(y=0;y<M.geometries.length;y++)if(c(M.geometries[y],xt,be,Xe,He)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}xt++}}function Ns(a,c){Da(a,function(g,y,C,M,z){var q=g===null?null:g.type;switch(q){case null:case"Point":case"LineString":case"Polygon":return c(Je(g,C,{bbox:M,id:z}),y,0)===!1?!1:void 0}var ce;switch(q){case"MultiPoint":ce="Point";break;case"MultiLineString":ce="LineString";break;case"MultiPolygon":ce="Polygon";break}for(var be=0;be<g.coordinates.length;be++){var Xe=g.coordinates[be],He={type:ce,coordinates:Xe};if(c(Je(He,C),y,be)===!1)return!1}})}function ml(a){if(!a)throw new Error("geojson is required");var c=[];return Ns(a,function(g){ko(g,c)}),Ut(c)}function ko(a,c){var g=[],y=a.geometry;if(y!==null){switch(y.type){case"Polygon":g=lr(y);break;case"LineString":g=[lr(y)]}g.forEach(function(C){var M=Rl(C,a.properties);M.forEach(function(z){z.id=c.length,c.push(z)})})}}function Rl(a,c){var g=[];return a.reduce(function(y,C){var M=kt([y,C],c);return M.bbox=da(y,C),g.push(M),C}),g}function da(a,c){var g=a[0],y=a[1],C=c[0],M=c[1],z=g<C?g:C,q=y<M?y:M,ce=g>C?g:C,be=y>M?y:M;return[z,q,ce,be]}var pa=ml,es=p(jr(),1);function Mo(a,c){var g={},y=[];if(a.type==="LineString"&&(a=Je(a)),c.type==="LineString"&&(c=Je(c)),a.type==="Feature"&&c.type==="Feature"&&a.geometry!==null&&c.geometry!==null&&a.geometry.type==="LineString"&&c.geometry.type==="LineString"&&a.geometry.coordinates.length===2&&c.geometry.coordinates.length===2){var C=io(a,c);return C&&y.push(C),Ut(y)}var M=(0,es.default)();return M.load(pa(c)),Mi(pa(a),function(z){Mi(M.search(z),function(q){var ce=io(z,q);if(ce){var be=lr(ce).join(",");g[be]||(g[be]=!0,y.push(ce))}})}),Ut(y)}function io(a,c){var g=lr(a),y=lr(c);if(g.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(y.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var C=g[0][0],M=g[0][1],z=g[1][0],q=g[1][1],ce=y[0][0],be=y[0][1],Xe=y[1][0],He=y[1][1],xt=(He-be)*(z-C)-(Xe-ce)*(q-M),Ot=(Xe-ce)*(M-be)-(He-be)*(C-ce),en=(z-C)*(M-be)-(q-M)*(C-ce);if(xt===0)return null;var bn=Ot/xt,Pn=en/xt;if(bn>=0&&bn<=1&&Pn>=0&&Pn<=1){var ti=C+bn*(z-C),Ye=M+bn*(q-M);return dt([ti,Ye])}return null}var Us=Mo,Ra=p(jr(),1);function _s(a,c,g){g===void 0&&(g={});var y=er(a),C=er(c),M=Yn(C[1]-y[1]),z=Yn(C[0]-y[0]),q=Yn(y[1]),ce=Yn(C[1]),be=Math.pow(Math.sin(M/2),2)+Math.pow(Math.sin(z/2),2)*Math.cos(q)*Math.cos(ce);return cn(2*Math.atan2(Math.sqrt(be),Math.sqrt(1-be)),g.units)}var Ds=_s;function Rs(a){var c=a[0],g=a[1],y=a[2],C=a[3],M=Ds(a.slice(0,2),[y,g]),z=Ds(a.slice(0,2),[c,C]);if(M>=z){var q=(g+C)/2;return[c,q-(y-c)/2,y,q+(y-c)/2]}else{var ce=(c+y)/2;return[ce-(C-g)/2,g,ce+(C-g)/2,C]}}var uu=Rs;function ss(a){var c=[1/0,1/0,-1/0,-1/0];return no(a,function(g){c[0]>g[0]&&(c[0]=g[0]),c[1]>g[1]&&(c[1]=g[1]),c[2]<g[0]&&(c[2]=g[0]),c[3]<g[1]&&(c[3]=g[1])}),c}ss.default=ss;var Wo=ss;function bs(a,c){c===void 0&&(c={});var g=c.precision,y=c.coordinates,C=c.mutate;if(g=g==null||isNaN(g)?6:g,y=y==null||isNaN(y)?3:y,!a)throw new Error("<geojson> is required");if(typeof g!="number")throw new Error("<precision> must be a number");if(typeof y!="number")throw new Error("<coordinates> must be a number");(C===!1||C===void 0)&&(a=JSON.parse(JSON.stringify(a)));var M=Math.pow(10,g);return no(a,function(z){ws(z,M,y)}),a}function ws(a,c,g){a.length>g&&a.splice(g,a.length);for(var y=0;y<a.length;y++)a[y]=Math.round(a[y]*c)/c;return a}var Zo=bs;function Ko(a,c,g){if(g===void 0&&(g={}),g.final===!0)return xs(a,c);var y=er(a),C=er(c),M=Yn(y[0]),z=Yn(C[0]),q=Yn(y[1]),ce=Yn(C[1]),be=Math.sin(z-M)*Math.cos(ce),Xe=Math.cos(q)*Math.sin(ce)-Math.sin(q)*Math.cos(ce)*Math.cos(z-M);return Rn(Math.atan2(be,Xe))}function xs(a,c){var g=Ko(c,a);return g=(g+180)%360,g}function us(a,c,g,y){y===void 0&&(y={});var C=er(a),M=Yn(C[0]),z=Yn(C[1]),q=Yn(g),ce=Bn(c,y.units),be=Math.asin(Math.sin(z)*Math.cos(ce)+Math.cos(z)*Math.sin(ce)*Math.cos(q)),Xe=M+Math.atan2(Math.sin(q)*Math.sin(ce)*Math.cos(z),Math.cos(ce)-Math.sin(z)*Math.sin(be)),He=Rn(Xe),xt=Rn(be);return dt([He,xt],y.properties)}function To(a,c,g){g===void 0&&(g={});var y=dt([1/0,1/0],{dist:1/0}),C=0;return Ns(a,function(M){for(var z=lr(M),q=0;q<z.length-1;q++){var ce=dt(z[q]);ce.properties.dist=Ds(c,ce,g);var be=dt(z[q+1]);be.properties.dist=Ds(c,be,g);var Xe=Ds(ce,be,g),He=Math.max(ce.properties.dist,be.properties.dist),xt=Ko(ce,be),Ot=us(c,He,xt+90,g),en=us(c,He,xt-90,g),bn=Us(kt([Ot.geometry.coordinates,en.geometry.coordinates]),kt([ce.geometry.coordinates,be.geometry.coordinates])),Pn=null;bn.features.length>0&&(Pn=bn.features[0],Pn.properties.dist=Ds(c,Pn,g),Pn.properties.location=C+Ds(ce,Pn,g)),ce.properties.dist<y.properties.dist&&(y=ce,y.properties.index=q,y.properties.location=C),be.properties.dist<y.properties.dist&&(y=be,y.properties.index=q+1,y.properties.location=C+Xe),Pn&&Pn.properties.dist<y.properties.dist&&(y=Pn,y.properties.index=q),C+=Xe}}),y}var ro=To;function Ls(a,c){if(!a)throw new Error("line is required");if(!c)throw new Error("splitter is required");var g=Qr(a),y=Qr(c);if(g!=="LineString")throw new Error("line must be LineString");if(y==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(y==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var C=Zo(c,{precision:7});switch(y){case"Point":return Zt(a,C);case"MultiPoint":return Ct(a,C);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return Ct(a,Us(a,C))}}function Ct(a,c){var g=[],y=(0,Ra.default)();return Ns(c,function(C){if(g.forEach(function(q,ce){q.id=ce}),!g.length)g=Zt(a,C).features,g.forEach(function(q){q.bbox||(q.bbox=uu(Wo(q)))}),y.load(Ut(g));else{var M=y.search(C);if(M.features.length){var z=Rt(C,M);g=g.filter(function(q){return q.id!==z.id}),y.remove(z),Mi(Zt(z,C),function(q){g.push(q),y.insert(q)})}}}),Ut(g)}function Zt(a,c){var g=[],y=lr(a)[0],C=lr(a)[a.geometry.coordinates.length-1];if(Mn(y,er(c))||Mn(C,er(c)))return Ut([a]);var M=(0,Ra.default)(),z=pa(a);M.load(z);var q=M.search(c);if(!q.features.length)return Ut([a]);var ce=Rt(c,q),be=[y],Xe=ys(z,function(He,xt,Ot){var en=lr(xt)[1],bn=er(c);return Ot===ce.id?(He.push(bn),g.push(kt(He)),Mn(bn,en)?[bn]:[bn,en]):(He.push(en),He)},be);return Xe.length>1&&g.push(kt(Xe)),Ut(g)}function Rt(a,c){if(!c.features.length)throw new Error("lines must contain features");if(c.features.length===1)return c.features[0];var g,y=1/0;return Mi(c,function(C){var M=ro(C,a),z=M.properties.dist;z<y&&(g=C,y=z)}),g}function Mn(a,c){return a[0]===c[0]&&a[1]===c[1]}var qn=Ls;function gi(a,c,g){if(g===void 0&&(g={}),!a)throw new Error("point is required");if(!c)throw new Error("polygon is required");var y=er(a),C=Hr(c),M=C.type,z=c.bbox,q=C.coordinates;if(z&&ur(y,z)===!1)return!1;M==="Polygon"&&(q=[q]);for(var ce=!1,be=0;be<q.length&&!ce;be++)if(kr(y,q[be][0],g.ignoreBoundary)){for(var Xe=!1,He=1;He<q[be].length&&!Xe;)kr(y,q[be][He],!g.ignoreBoundary)&&(Xe=!0),He++;Xe||(ce=!0)}return ce}function kr(a,c,g){var y=!1;c[0][0]===c[c.length-1][0]&&c[0][1]===c[c.length-1][1]&&(c=c.slice(0,c.length-1));for(var C=0,M=c.length-1;C<c.length;M=C++){var z=c[C][0],q=c[C][1],ce=c[M][0],be=c[M][1],Xe=a[1]*(z-ce)+q*(ce-a[0])+be*(a[0]-z)===0&&(z-a[0])*(ce-a[0])<=0&&(q-a[1])*(be-a[1])<=0;if(Xe)return!g;var He=q>a[1]!=be>a[1]&&a[0]<(ce-z)*(a[1]-q)/(be-q)+z;He&&(y=!y)}return y}function ur(a,c){return c[0]<=a[0]&&c[1]<=a[1]&&c[2]>=a[0]&&c[3]>=a[1]}function nl(a,c,g){g===void 0&&(g={});for(var y=er(a),C=lr(c),M=0;M<C.length-1;M++){var z=!1;if(g.ignoreEndVertices&&(M===0&&(z="start"),M===C.length-2&&(z="end"),M===0&&M+1===C.length-1&&(z="both")),Os(C[M],C[M+1],y,z,typeof g.epsilon>"u"?null:g.epsilon))return!0}return!1}function Os(a,c,g,y,C){var M=g[0],z=g[1],q=a[0],ce=a[1],be=c[0],Xe=c[1],He=g[0]-q,xt=g[1]-ce,Ot=be-q,en=Xe-ce,bn=He*en-xt*Ot;if(C!==null){if(Math.abs(bn)>C)return!1}else if(bn!==0)return!1;if(y){if(y==="start")return Math.abs(Ot)>=Math.abs(en)?Ot>0?q<M&&M<=be:be<=M&&M<q:en>0?ce<z&&z<=Xe:Xe<=z&&z<ce;if(y==="end")return Math.abs(Ot)>=Math.abs(en)?Ot>0?q<=M&&M<be:be<M&&M<=q:en>0?ce<=z&&z<Xe:Xe<z&&z<=ce;if(y==="both")return Math.abs(Ot)>=Math.abs(en)?Ot>0?q<M&&M<be:be<M&&M<q:en>0?ce<z&&z<Xe:Xe<z&&z<ce}else return Math.abs(Ot)>=Math.abs(en)?Ot>0?q<=M&&M<=be:be<=M&&M<=q:en>0?ce<=z&&z<=Xe:Xe<=z&&z<=ce;return!1}var Mr=nl;function Bo(a,c){var g=Hr(a),y=Hr(c),C=g.type,M=y.type,z=g.coordinates,q=y.coordinates;switch(C){case"Point":switch(M){case"Point":return pr(z,q);default:throw new Error("feature2 "+M+" geometry not supported")}case"MultiPoint":switch(M){case"Point":return Jo(g,y);case"MultiPoint":return No(g,y);default:throw new Error("feature2 "+M+" geometry not supported")}case"LineString":switch(M){case"Point":return Mr(y,g,{ignoreEndVertices:!0});case"LineString":return Ii(g,y);case"MultiPoint":return Do(g,y);default:throw new Error("feature2 "+M+" geometry not supported")}case"Polygon":switch(M){case"Point":return gi(y,g,{ignoreBoundary:!0});case"LineString":return yo(g,y);case"Polygon":return cs(g,y);case"MultiPoint":return Ro(g,y);default:throw new Error("feature2 "+M+" geometry not supported")}default:throw new Error("feature1 "+C+" geometry not supported")}}function Jo(a,c){var g,y=!1;for(g=0;g<a.coordinates.length;g++)if(pr(a.coordinates[g],c.coordinates)){y=!0;break}return y}function No(a,c){for(var g=0,y=c.coordinates;g<y.length;g++){for(var C=y[g],M=!1,z=0,q=a.coordinates;z<q.length;z++){var ce=q[z];if(pr(C,ce)){M=!0;break}}if(!M)return!1}return!0}function Do(a,c){for(var g=!1,y=0,C=c.coordinates;y<C.length;y++){var M=C[y];if(Mr(M,a,{ignoreEndVertices:!0})&&(g=!0),!Mr(M,a))return!1}return!!g}function Ro(a,c){for(var g=0,y=c.coordinates;g<y.length;g++){var C=y[g];if(!gi(C,a,{ignoreBoundary:!0}))return!1}return!0}function Ii(a,c){for(var g=!1,y=0,C=c.coordinates;y<C.length;y++){var M=C[y];if(Mr({type:"Point",coordinates:M},a,{ignoreEndVertices:!0})&&(g=!0),!Mr({type:"Point",coordinates:M},a,{ignoreEndVertices:!1}))return!1}return g}function yo(a,c){var g=!1,y=0,C=Wo(a),M=Wo(c);if(!cr(C,M))return!1;for(y;y<c.coordinates.length-1;y++){var z=Wr(c.coordinates[y],c.coordinates[y+1]);if(gi({type:"Point",coordinates:z},a,{ignoreBoundary:!0})){g=!0;break}}return g}function cs(a,c){if(a.type==="Feature"&&a.geometry===null||c.type==="Feature"&&c.geometry===null)return!1;var g=Wo(a),y=Wo(c);if(!cr(g,y))return!1;for(var C=Hr(c).coordinates,M=0,z=C;M<z.length;M++)for(var q=z[M],ce=0,be=q;ce<be.length;ce++){var Xe=be[ce];if(!gi(Xe,a))return!1}return!0}function cr(a,c){return!(a[0]>c[0]||a[2]<c[2]||a[1]>c[1]||a[3]<c[3])}function pr(a,c){return a[0]===c[0]&&a[1]===c[1]}function Wr(a,c){return[(a[0]+c[0])/2,(a[1]+c[1])/2]}var _r=p(di()),so=a=>()=>a,$s=a=>{let c=a?(g,y)=>y.minus(g).abs().isLessThanOrEqualTo(a):so(!1);return(g,y)=>c(g,y)?0:g.comparedTo(y)};function co(a){let c=a?(g,y,C,M,z)=>g.exponentiatedBy(2).isLessThanOrEqualTo(M.minus(y).exponentiatedBy(2).plus(z.minus(C).exponentiatedBy(2)).times(a)):so(!1);return(g,y,C)=>{let M=g.x,z=g.y,q=C.x,ce=C.y,be=z.minus(ce).times(y.x.minus(q)).minus(M.minus(q).times(y.y.minus(ce)));return c(be,M,z,q,ce)?0:be.comparedTo(0)}}var Ol=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,Oo=Math.ceil,ts=Math.floor,yr="[BigNumber Error] ",Cs=yr+"Number primitive has more than 15 significant digits: ",qs=1e14,oi=14,Yo=9007199254740991,Xo=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],_o=1e7,Is=1e9;function Tu(a){var c,g,y,C=Ye.prototype={constructor:Ye,toString:null,valueOf:null},M=new Ye(1),z=20,q=4,ce=-7,be=21,Xe=-1e7,He=1e7,xt=!1,Ot=1,en=0,bn={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},Pn="0123456789abcdefghijklmnopqrstuvwxyz",ti=!0;function Ye(fe,Ce){var je,Fe,qe,Ge,ht,ft,yt,Tt,Bt=this;if(!(Bt instanceof Ye))return new Ye(fe,Ce);if(Ce==null){if(fe&&fe._isBigNumber===!0){Bt.s=fe.s,!fe.c||fe.e>He?Bt.c=Bt.e=null:fe.e<Xe?Bt.c=[Bt.e=0]:(Bt.e=fe.e,Bt.c=fe.c.slice());return}if((ft=typeof fe=="number")&&fe*0==0){if(Bt.s=1/fe<0?(fe=-fe,-1):1,fe===~~fe){for(Ge=0,ht=fe;ht>=10;ht/=10,Ge++);Ge>He?Bt.c=Bt.e=null:(Bt.e=Ge,Bt.c=[fe]);return}Tt=String(fe)}else{if(!Ol.test(Tt=String(fe)))return y(Bt,Tt,ft);Bt.s=Tt.charCodeAt(0)==45?(Tt=Tt.slice(1),-1):1}(Ge=Tt.indexOf("."))>-1&&(Tt=Tt.replace(".","")),(ht=Tt.search(/e/i))>0?(Ge<0&&(Ge=ht),Ge+=+Tt.slice(ht+1),Tt=Tt.substring(0,ht)):Ge<0&&(Ge=Tt.length)}else{if(s(Ce,2,Pn.length,"Base"),Ce==10&&ti)return Bt=new Ye(fe),Pt(Bt,z+Bt.e+1,q);if(Tt=String(fe),ft=typeof fe=="number"){if(fe*0!=0)return y(Bt,Tt,ft,Ce);if(Bt.s=1/fe<0?(Tt=Tt.slice(1),-1):1,Ye.DEBUG&&Tt.replace(/^0\.0*|\./,"").length>15)throw Error(Cs+fe)}else Bt.s=Tt.charCodeAt(0)===45?(Tt=Tt.slice(1),-1):1;for(je=Pn.slice(0,Ce),Ge=ht=0,yt=Tt.length;ht<yt;ht++)if(je.indexOf(Fe=Tt.charAt(ht))<0){if(Fe=="."){if(ht>Ge){Ge=yt;continue}}else if(!qe&&(Tt==Tt.toUpperCase()&&(Tt=Tt.toLowerCase())||Tt==Tt.toLowerCase()&&(Tt=Tt.toUpperCase()))){qe=!0,ht=-1,Ge=0;continue}return y(Bt,String(fe),ft,Ce)}ft=!1,Tt=g(Tt,Ce,10,Bt.s),(Ge=Tt.indexOf("."))>-1?Tt=Tt.replace(".",""):Ge=Tt.length}for(ht=0;Tt.charCodeAt(ht)===48;ht++);for(yt=Tt.length;Tt.charCodeAt(--yt)===48;);if(Tt=Tt.slice(ht,++yt)){if(yt-=ht,ft&&Ye.DEBUG&&yt>15&&(fe>Yo||fe!==ts(fe)))throw Error(Cs+Bt.s*fe);if((Ge=Ge-ht-1)>He)Bt.c=Bt.e=null;else if(Ge<Xe)Bt.c=[Bt.e=0];else{if(Bt.e=Ge,Bt.c=[],ht=(Ge+1)%oi,Ge<0&&(ht+=oi),ht<yt){for(ht&&Bt.c.push(+Tt.slice(0,ht)),yt-=oi;ht<yt;)Bt.c.push(+Tt.slice(ht,ht+=oi));ht=oi-(Tt=Tt.slice(ht)).length}else ht-=yt;for(;ht--;Tt+="0");Bt.c.push(+Tt)}}else Bt.c=[Bt.e=0]}Ye.clone=Tu,Ye.ROUND_UP=0,Ye.ROUND_DOWN=1,Ye.ROUND_CEIL=2,Ye.ROUND_FLOOR=3,Ye.ROUND_HALF_UP=4,Ye.ROUND_HALF_DOWN=5,Ye.ROUND_HALF_EVEN=6,Ye.ROUND_HALF_CEIL=7,Ye.ROUND_HALF_FLOOR=8,Ye.EUCLID=9,Ye.config=Ye.set=function(fe){var Ce,je;if(fe!=null)if(typeof fe=="object"){if(fe.hasOwnProperty(Ce="DECIMAL_PLACES")&&(je=fe[Ce],s(je,0,Is,Ce),z=je),fe.hasOwnProperty(Ce="ROUNDING_MODE")&&(je=fe[Ce],s(je,0,8,Ce),q=je),fe.hasOwnProperty(Ce="EXPONENTIAL_AT")&&(je=fe[Ce],je&&je.pop?(s(je[0],-1e9,0,Ce),s(je[1],0,Is,Ce),ce=je[0],be=je[1]):(s(je,-1e9,Is,Ce),ce=-(be=je<0?-je:je))),fe.hasOwnProperty(Ce="RANGE"))if(je=fe[Ce],je&&je.pop)s(je[0],-1e9,-1,Ce),s(je[1],1,Is,Ce),Xe=je[0],He=je[1];else if(s(je,-1e9,Is,Ce),je)Xe=-(He=je<0?-je:je);else throw Error(yr+Ce+" cannot be zero: "+je);if(fe.hasOwnProperty(Ce="CRYPTO"))if(je=fe[Ce],je===!!je)if(je)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))xt=je;else throw xt=!je,Error(yr+"crypto unavailable");else xt=je;else throw Error(yr+Ce+" not true or false: "+je);if(fe.hasOwnProperty(Ce="MODULO_MODE")&&(je=fe[Ce],s(je,0,9,Ce),Ot=je),fe.hasOwnProperty(Ce="POW_PRECISION")&&(je=fe[Ce],s(je,0,Is,Ce),en=je),fe.hasOwnProperty(Ce="FORMAT"))if(je=fe[Ce],typeof je=="object")bn=je;else throw Error(yr+Ce+" not an object: "+je);if(fe.hasOwnProperty(Ce="ALPHABET"))if(je=fe[Ce],typeof je=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(je))ti=je.slice(0,10)=="0123456789",Pn=je;else throw Error(yr+Ce+" invalid: "+je)}else throw Error(yr+"Object expected: "+fe);return{DECIMAL_PLACES:z,ROUNDING_MODE:q,EXPONENTIAL_AT:[ce,be],RANGE:[Xe,He],CRYPTO:xt,MODULO_MODE:Ot,POW_PRECISION:en,FORMAT:bn,ALPHABET:Pn}},Ye.isBigNumber=function(fe){if(!fe||fe._isBigNumber!==!0)return!1;if(!Ye.DEBUG)return!0;var Ce,je,Fe=fe.c,qe=fe.e,Ge=fe.s;e:if({}.toString.call(Fe)=="[object Array]"){if((Ge===1||Ge===-1)&&qe>=-1e9&&qe<=Is&&qe===ts(qe)){if(Fe[0]===0){if(qe===0&&Fe.length===1)return!0;break e}if(Ce=(qe+1)%oi,Ce<1&&(Ce+=oi),String(Fe[0]).length==Ce){for(Ce=0;Ce<Fe.length;Ce++)if(je=Fe[Ce],je<0||je>=qs||je!==ts(je))break e;if(je!==0)return!0}}}else if(Fe===null&&qe===null&&(Ge===null||Ge===1||Ge===-1))return!0;throw Error(yr+"Invalid BigNumber: "+fe)},Ye.maximum=Ye.max=function(){return gt(arguments,-1)},Ye.minimum=Ye.min=function(){return gt(arguments,1)},Ye.random=function(){var fe=9007199254740992,Ce=Math.random()*fe&2097151?function(){return ts(Math.random()*fe)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(je){var Fe,qe,Ge,ht,ft,yt=0,Tt=[],Bt=new Ye(M);if(je==null?je=z:s(je,0,Is),ht=Oo(je/oi),xt)if(crypto.getRandomValues){for(Fe=crypto.getRandomValues(new Uint32Array(ht*=2));yt<ht;)ft=Fe[yt]*131072+(Fe[yt+1]>>>11),ft>=9e15?(qe=crypto.getRandomValues(new Uint32Array(2)),Fe[yt]=qe[0],Fe[yt+1]=qe[1]):(Tt.push(ft%1e14),yt+=2);yt=ht/2}else if(crypto.randomBytes){for(Fe=crypto.randomBytes(ht*=7);yt<ht;)ft=(Fe[yt]&31)*281474976710656+Fe[yt+1]*1099511627776+Fe[yt+2]*4294967296+Fe[yt+3]*16777216+(Fe[yt+4]<<16)+(Fe[yt+5]<<8)+Fe[yt+6],ft>=9e15?crypto.randomBytes(7).copy(Fe,yt):(Tt.push(ft%1e14),yt+=7);yt=ht/7}else throw xt=!1,Error(yr+"crypto unavailable");if(!xt)for(;yt<ht;)ft=Ce(),ft<9e15&&(Tt[yt++]=ft%1e14);for(ht=Tt[--yt],je%=oi,ht&&je&&(ft=Xo[oi-je],Tt[yt]=ts(ht/ft)*ft);Tt[yt]===0;Tt.pop(),yt--);if(yt<0)Tt=[Ge=0];else{for(Ge=-1;Tt[0]===0;Tt.splice(0,1),Ge-=oi);for(yt=1,ft=Tt[0];ft>=10;ft/=10,yt++);yt<oi&&(Ge-=oi-yt)}return Bt.e=Ge,Bt.c=Tt,Bt}}(),Ye.sum=function(){for(var fe=1,Ce=arguments,je=new Ye(Ce[0]);fe<Ce.length;)je=je.plus(Ce[fe++]);return je},g=function(){var fe="0123456789";function Ce(je,Fe,qe,Ge){for(var ht,ft=[0],yt,Tt=0,Bt=je.length;Tt<Bt;){for(yt=ft.length;yt--;ft[yt]*=Fe);for(ft[0]+=Ge.indexOf(je.charAt(Tt++)),ht=0;ht<ft.length;ht++)ft[ht]>qe-1&&(ft[ht+1]==null&&(ft[ht+1]=0),ft[ht+1]+=ft[ht]/qe|0,ft[ht]%=qe)}return ft.reverse()}return function(je,Fe,qe,Ge,ht){var ft,yt,Tt,Bt,on,On,Fn,Jn,ir=je.indexOf("."),gr=z,Fi=q;for(ir>=0&&(Bt=en,en=0,je=je.replace(".",""),Jn=new Ye(Fe),On=Jn.pow(je.length-ir),en=Bt,Jn.c=Ce(T(fs(On.c),On.e,"0"),10,qe,fe),Jn.e=Jn.c.length),Fn=Ce(je,Fe,qe,ht?(ft=Pn,fe):(ft=fe,Pn)),Tt=Bt=Fn.length;Fn[--Bt]==0;Fn.pop());if(!Fn[0])return ft.charAt(0);if(ir<0?--Tt:(On.c=Fn,On.e=Tt,On.s=Ge,On=c(On,Jn,gr,Fi,qe),Fn=On.c,on=On.r,Tt=On.e),yt=Tt+gr+1,ir=Fn[yt],Bt=qe/2,on=on||yt<0||Fn[yt+1]!=null,on=Fi<4?(ir!=null||on)&&(Fi==0||Fi==(On.s<0?3:2)):ir>Bt||ir==Bt&&(Fi==4||on||Fi==6&&Fn[yt-1]&1||Fi==(On.s<0?8:7)),yt<1||!Fn[0])je=on?T(ft.charAt(1),-gr,ft.charAt(0)):ft.charAt(0);else{if(Fn.length=yt,on)for(--qe;++Fn[--yt]>qe;)Fn[yt]=0,yt||(++Tt,Fn=[1].concat(Fn));for(Bt=Fn.length;!Fn[--Bt];);for(ir=0,je="";ir<=Bt;je+=ft.charAt(Fn[ir++]));je=T(je,Tt,ft.charAt(0))}return je}}(),c=function(){function fe(Fe,qe,Ge){var ht,ft,yt,Tt,Bt=0,on=Fe.length,On=qe%_o,Fn=qe/_o|0;for(Fe=Fe.slice();on--;)yt=Fe[on]%_o,Tt=Fe[on]/_o|0,ht=Fn*yt+Tt*On,ft=On*yt+ht%_o*_o+Bt,Bt=(ft/Ge|0)+(ht/_o|0)+Fn*Tt,Fe[on]=ft%Ge;return Bt&&(Fe=[Bt].concat(Fe)),Fe}function Ce(Fe,qe,Ge,ht){var ft,yt;if(Ge!=ht)yt=Ge>ht?1:-1;else for(ft=yt=0;ft<Ge;ft++)if(Fe[ft]!=qe[ft]){yt=Fe[ft]>qe[ft]?1:-1;break}return yt}function je(Fe,qe,Ge,ht){for(var ft=0;Ge--;)Fe[Ge]-=ft,ft=Fe[Ge]<qe[Ge]?1:0,Fe[Ge]=ft*ht+Fe[Ge]-qe[Ge];for(;!Fe[0]&&Fe.length>1;Fe.splice(0,1));}return function(Fe,qe,Ge,ht,ft){var yt,Tt,Bt,on,On,Fn,Jn,ir,gr,Fi,br,Hs,Fl,Fo,Rc,ma,hu,zo=Fe.s==qe.s?1:-1,Ps=Fe.c,Zr=qe.c;if(!Ps||!Ps[0]||!Zr||!Zr[0])return new Ye(!Fe.s||!qe.s||(Ps?Zr&&Ps[0]==Zr[0]:!Zr)?NaN:Ps&&Ps[0]==0||!Zr?zo*0:zo/0);for(ir=new Ye(zo),gr=ir.c=[],Tt=Fe.e-qe.e,zo=Ge+Tt+1,ft||(ft=qs,Tt=hs(Fe.e/oi)-hs(qe.e/oi),zo=zo/oi|0),Bt=0;Zr[Bt]==(Ps[Bt]||0);Bt++);if(Zr[Bt]>(Ps[Bt]||0)&&Tt--,zo<0)gr.push(1),on=!0;else{for(Fo=Ps.length,ma=Zr.length,Bt=0,zo+=2,On=ts(ft/(Zr[0]+1)),On>1&&(Zr=fe(Zr,On,ft),Ps=fe(Ps,On,ft),ma=Zr.length,Fo=Ps.length),Fl=ma,Fi=Ps.slice(0,ma),br=Fi.length;br<ma;Fi[br++]=0);hu=Zr.slice(),hu=[0].concat(hu),Rc=Zr[0],Zr[1]>=ft/2&&Rc++;do{if(On=0,yt=Ce(Zr,Fi,ma,br),yt<0){if(Hs=Fi[0],ma!=br&&(Hs=Hs*ft+(Fi[1]||0)),On=ts(Hs/Rc),On>1)for(On>=ft&&(On=ft-1),Fn=fe(Zr,On,ft),Jn=Fn.length,br=Fi.length;Ce(Fn,Fi,Jn,br)==1;)On--,je(Fn,ma<Jn?hu:Zr,Jn,ft),Jn=Fn.length,yt=1;else On==0&&(yt=On=1),Fn=Zr.slice(),Jn=Fn.length;if(Jn<br&&(Fn=[0].concat(Fn)),je(Fi,Fn,br,ft),br=Fi.length,yt==-1)for(;Ce(Zr,Fi,ma,br)<1;)On++,je(Fi,ma<br?hu:Zr,br,ft),br=Fi.length}else yt===0&&(On++,Fi=[0]);gr[Bt++]=On,Fi[0]?Fi[br++]=Ps[Fl]||0:(Fi=[Ps[Fl]],br=1)}while((Fl++<Fo||Fi[0]!=null)&&zo--);on=Fi[0]!=null,gr[0]||gr.splice(0,1)}if(ft==qs){for(Bt=1,zo=gr[0];zo>=10;zo/=10,Bt++);Pt(ir,Ge+(ir.e=Bt+Tt*oi-1)+1,ht,on)}else ir.e=Tt,ir.r=+on;return ir}}();function at(fe,Ce,je,Fe){var qe,Ge,ht,ft,yt;if(je==null?je=q:s(je,0,8),!fe.c)return fe.toString();if(qe=fe.c[0],ht=fe.e,Ce==null)yt=fs(fe.c),yt=Fe==1||Fe==2&&(ht<=ce||ht>=be)?x(yt,ht):T(yt,ht,"0");else if(fe=Pt(new Ye(fe),Ce,je),Ge=fe.e,yt=fs(fe.c),ft=yt.length,Fe==1||Fe==2&&(Ce<=Ge||Ge<=ce)){for(;ft<Ce;yt+="0",ft++);yt=x(yt,Ge)}else if(Ce-=ht,yt=T(yt,Ge,"0"),Ge+1>ft){if(--Ce>0)for(yt+=".";Ce--;yt+="0");}else if(Ce+=Ge-ft,Ce>0)for(Ge+1==ft&&(yt+=".");Ce--;yt+="0");return fe.s<0&&qe?"-"+yt:yt}function gt(fe,Ce){for(var je,Fe,qe=1,Ge=new Ye(fe[0]);qe<fe.length;qe++)Fe=new Ye(fe[qe]),(!Fe.s||(je=bo(Ge,Fe))===Ce||je===0&&Ge.s===Ce)&&(Ge=Fe);return Ge}function jt(fe,Ce,je){for(var Fe=1,qe=Ce.length;!Ce[--qe];Ce.pop());for(qe=Ce[0];qe>=10;qe/=10,Fe++);return(je=Fe+je*oi-1)>He?fe.c=fe.e=null:je<Xe?fe.c=[fe.e=0]:(fe.e=je,fe.c=Ce),fe}y=function(){var fe=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Ce=/^([^.]+)\.$/,je=/^\.([^.]+)$/,Fe=/^-?(Infinity|NaN)$/,qe=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(Ge,ht,ft,yt){var Tt,Bt=ft?ht:ht.replace(qe,"");if(Fe.test(Bt))Ge.s=isNaN(Bt)?null:Bt<0?-1:1;else{if(!ft&&(Bt=Bt.replace(fe,function(on,On,Fn){return Tt=(Fn=Fn.toLowerCase())=="x"?16:Fn=="b"?2:8,!yt||yt==Tt?On:on}),yt&&(Tt=yt,Bt=Bt.replace(Ce,"$1").replace(je,"0.$1")),ht!=Bt))return new Ye(Bt,Tt);if(Ye.DEBUG)throw Error(yr+"Not a"+(yt?" base "+yt:"")+" number: "+ht);Ge.s=null}Ge.c=Ge.e=null}}();function Pt(fe,Ce,je,Fe){var qe,Ge,ht,ft,yt,Tt,Bt,on=fe.c,On=Xo;if(on){e:{for(qe=1,ft=on[0];ft>=10;ft/=10,qe++);if(Ge=Ce-qe,Ge<0)Ge+=oi,ht=Ce,yt=on[Tt=0],Bt=ts(yt/On[qe-ht-1]%10);else if(Tt=Oo((Ge+1)/oi),Tt>=on.length)if(Fe){for(;on.length<=Tt;on.push(0));yt=Bt=0,qe=1,Ge%=oi,ht=Ge-oi+1}else break e;else{for(yt=ft=on[Tt],qe=1;ft>=10;ft/=10,qe++);Ge%=oi,ht=Ge-oi+qe,Bt=ht<0?0:ts(yt/On[qe-ht-1]%10)}if(Fe=Fe||Ce<0||on[Tt+1]!=null||(ht<0?yt:yt%On[qe-ht-1]),Fe=je<4?(Bt||Fe)&&(je==0||je==(fe.s<0?3:2)):Bt>5||Bt==5&&(je==4||Fe||je==6&&(Ge>0?ht>0?yt/On[qe-ht]:0:on[Tt-1])%10&1||je==(fe.s<0?8:7)),Ce<1||!on[0])return on.length=0,Fe?(Ce-=fe.e+1,on[0]=On[(oi-Ce%oi)%oi],fe.e=-Ce||0):on[0]=fe.e=0,fe;if(Ge==0?(on.length=Tt,ft=1,Tt--):(on.length=Tt+1,ft=On[oi-Ge],on[Tt]=ht>0?ts(yt/On[qe-ht]%On[ht])*ft:0),Fe)for(;;)if(Tt==0){for(Ge=1,ht=on[0];ht>=10;ht/=10,Ge++);for(ht=on[0]+=ft,ft=1;ht>=10;ht/=10,ft++);Ge!=ft&&(fe.e++,on[0]==qs&&(on[0]=1));break}else{if(on[Tt]+=ft,on[Tt]!=qs)break;on[Tt--]=0,ft=1}for(Ge=on.length;on[--Ge]===0;on.pop());}fe.e>He?fe.c=fe.e=null:fe.e<Xe&&(fe.c=[fe.e=0])}return fe}function It(fe){var Ce,je=fe.e;return je===null?fe.toString():(Ce=fs(fe.c),Ce=je<=ce||je>=be?x(Ce,je):T(Ce,je,"0"),fe.s<0?"-"+Ce:Ce)}return C.absoluteValue=C.abs=function(){var fe=new Ye(this);return fe.s<0&&(fe.s=1),fe},C.comparedTo=function(fe,Ce){return bo(this,new Ye(fe,Ce))},C.decimalPlaces=C.dp=function(fe,Ce){var je,Fe,qe,Ge=this;if(fe!=null)return s(fe,0,Is),Ce==null?Ce=q:s(Ce,0,8),Pt(new Ye(Ge),fe+Ge.e+1,Ce);if(!(je=Ge.c))return null;if(Fe=((qe=je.length-1)-hs(this.e/oi))*oi,qe=je[qe])for(;qe%10==0;qe/=10,Fe--);return Fe<0&&(Fe=0),Fe},C.dividedBy=C.div=function(fe,Ce){return c(this,new Ye(fe,Ce),z,q)},C.dividedToIntegerBy=C.idiv=function(fe,Ce){return c(this,new Ye(fe,Ce),0,1)},C.exponentiatedBy=C.pow=function(fe,Ce){var je,Fe,qe,Ge,ht,ft,yt,Tt,Bt,on=this;if(fe=new Ye(fe),fe.c&&!fe.isInteger())throw Error(yr+"Exponent not an integer: "+It(fe));if(Ce!=null&&(Ce=new Ye(Ce)),ft=fe.e>14,!on.c||!on.c[0]||on.c[0]==1&&!on.e&&on.c.length==1||!fe.c||!fe.c[0])return Bt=new Ye(Math.pow(+It(on),ft?fe.s*(2-f(fe)):+It(fe))),Ce?Bt.mod(Ce):Bt;if(yt=fe.s<0,Ce){if(Ce.c?!Ce.c[0]:!Ce.s)return new Ye(NaN);Fe=!yt&&on.isInteger()&&Ce.isInteger(),Fe&&(on=on.mod(Ce))}else{if(fe.e>9&&(on.e>0||on.e<-1||(on.e==0?on.c[0]>1||ft&&on.c[1]>=24e7:on.c[0]<8e13||ft&&on.c[0]<=9999975e7)))return Ge=on.s<0&&f(fe)?-0:0,on.e>-1&&(Ge=1/Ge),new Ye(yt?1/Ge:Ge);en&&(Ge=Oo(en/oi+2))}for(ft?(je=new Ye(.5),yt&&(fe.s=1),Tt=f(fe)):(qe=Math.abs(+It(fe)),Tt=qe%2),Bt=new Ye(M);;){if(Tt){if(Bt=Bt.times(on),!Bt.c)break;Ge?Bt.c.length>Ge&&(Bt.c.length=Ge):Fe&&(Bt=Bt.mod(Ce))}if(qe){if(qe=ts(qe/2),qe===0)break;Tt=qe%2}else if(fe=fe.times(je),Pt(fe,fe.e+1,1),fe.e>14)Tt=f(fe);else{if(qe=+It(fe),qe===0)break;Tt=qe%2}on=on.times(on),Ge?on.c&&on.c.length>Ge&&(on.c.length=Ge):Fe&&(on=on.mod(Ce))}return Fe?Bt:(yt&&(Bt=M.div(Bt)),Ce?Bt.mod(Ce):Ge?Pt(Bt,en,q,ht):Bt)},C.integerValue=function(fe){var Ce=new Ye(this);return fe==null?fe=q:s(fe,0,8),Pt(Ce,Ce.e+1,fe)},C.isEqualTo=C.eq=function(fe,Ce){return bo(this,new Ye(fe,Ce))===0},C.isFinite=function(){return!!this.c},C.isGreaterThan=C.gt=function(fe,Ce){return bo(this,new Ye(fe,Ce))>0},C.isGreaterThanOrEqualTo=C.gte=function(fe,Ce){return(Ce=bo(this,new Ye(fe,Ce)))===1||Ce===0},C.isInteger=function(){return!!this.c&&hs(this.e/oi)>this.c.length-2},C.isLessThan=C.lt=function(fe,Ce){return bo(this,new Ye(fe,Ce))<0},C.isLessThanOrEqualTo=C.lte=function(fe,Ce){return(Ce=bo(this,new Ye(fe,Ce)))===-1||Ce===0},C.isNaN=function(){return!this.s},C.isNegative=function(){return this.s<0},C.isPositive=function(){return this.s>0},C.isZero=function(){return!!this.c&&this.c[0]==0},C.minus=function(fe,Ce){var je,Fe,qe,Ge,ht=this,ft=ht.s;if(fe=new Ye(fe,Ce),Ce=fe.s,!ft||!Ce)return new Ye(NaN);if(ft!=Ce)return fe.s=-Ce,ht.plus(fe);var yt=ht.e/oi,Tt=fe.e/oi,Bt=ht.c,on=fe.c;if(!yt||!Tt){if(!Bt||!on)return Bt?(fe.s=-Ce,fe):new Ye(on?ht:NaN);if(!Bt[0]||!on[0])return on[0]?(fe.s=-Ce,fe):new Ye(Bt[0]?ht:q==3?-0:0)}if(yt=hs(yt),Tt=hs(Tt),Bt=Bt.slice(),ft=yt-Tt){for((Ge=ft<0)?(ft=-ft,qe=Bt):(Tt=yt,qe=on),qe.reverse(),Ce=ft;Ce--;qe.push(0));qe.reverse()}else for(Fe=(Ge=(ft=Bt.length)<(Ce=on.length))?ft:Ce,ft=Ce=0;Ce<Fe;Ce++)if(Bt[Ce]!=on[Ce]){Ge=Bt[Ce]<on[Ce];break}if(Ge&&(qe=Bt,Bt=on,on=qe,fe.s=-fe.s),Ce=(Fe=on.length)-(je=Bt.length),Ce>0)for(;Ce--;Bt[je++]=0);for(Ce=qs-1;Fe>ft;){if(Bt[--Fe]<on[Fe]){for(je=Fe;je&&!Bt[--je];Bt[je]=Ce);--Bt[je],Bt[Fe]+=qs}Bt[Fe]-=on[Fe]}for(;Bt[0]==0;Bt.splice(0,1),--Tt);return Bt[0]?jt(fe,Bt,Tt):(fe.s=q==3?-1:1,fe.c=[fe.e=0],fe)},C.modulo=C.mod=function(fe,Ce){var je,Fe,qe=this;return fe=new Ye(fe,Ce),!qe.c||!fe.s||fe.c&&!fe.c[0]?new Ye(NaN):!fe.c||qe.c&&!qe.c[0]?new Ye(qe):(Ot==9?(Fe=fe.s,fe.s=1,je=c(qe,fe,0,3),fe.s=Fe,je.s*=Fe):je=c(qe,fe,0,Ot),fe=qe.minus(je.times(fe)),!fe.c[0]&&Ot==1&&(fe.s=qe.s),fe)},C.multipliedBy=C.times=function(fe,Ce){var je,Fe,qe,Ge,ht,ft,yt,Tt,Bt,on,On,Fn,Jn,ir,gr,Fi=this,br=Fi.c,Hs=(fe=new Ye(fe,Ce)).c;if(!br||!Hs||!br[0]||!Hs[0])return!Fi.s||!fe.s||br&&!br[0]&&!Hs||Hs&&!Hs[0]&&!br?fe.c=fe.e=fe.s=null:(fe.s*=Fi.s,!br||!Hs?fe.c=fe.e=null:(fe.c=[0],fe.e=0)),fe;for(Fe=hs(Fi.e/oi)+hs(fe.e/oi),fe.s*=Fi.s,yt=br.length,on=Hs.length,yt<on&&(Jn=br,br=Hs,Hs=Jn,qe=yt,yt=on,on=qe),qe=yt+on,Jn=[];qe--;Jn.push(0));for(ir=qs,gr=_o,qe=on;--qe>=0;){for(je=0,On=Hs[qe]%gr,Fn=Hs[qe]/gr|0,ht=yt,Ge=qe+ht;Ge>qe;)Tt=br[--ht]%gr,Bt=br[ht]/gr|0,ft=Fn*Tt+Bt*On,Tt=On*Tt+ft%gr*gr+Jn[Ge]+je,je=(Tt/ir|0)+(ft/gr|0)+Fn*Bt,Jn[Ge--]=Tt%ir;Jn[Ge]=je}return je?++Fe:Jn.splice(0,1),jt(fe,Jn,Fe)},C.negated=function(){var fe=new Ye(this);return fe.s=-fe.s||null,fe},C.plus=function(fe,Ce){var je,Fe=this,qe=Fe.s;if(fe=new Ye(fe,Ce),Ce=fe.s,!qe||!Ce)return new Ye(NaN);if(qe!=Ce)return fe.s=-Ce,Fe.minus(fe);var Ge=Fe.e/oi,ht=fe.e/oi,ft=Fe.c,yt=fe.c;if(!Ge||!ht){if(!ft||!yt)return new Ye(qe/0);if(!ft[0]||!yt[0])return yt[0]?fe:new Ye(ft[0]?Fe:qe*0)}if(Ge=hs(Ge),ht=hs(ht),ft=ft.slice(),qe=Ge-ht){for(qe>0?(ht=Ge,je=yt):(qe=-qe,je=ft),je.reverse();qe--;je.push(0));je.reverse()}for(qe=ft.length,Ce=yt.length,qe-Ce<0&&(je=yt,yt=ft,ft=je,Ce=qe),qe=0;Ce;)qe=(ft[--Ce]=ft[Ce]+yt[Ce]+qe)/qs|0,ft[Ce]=qs===ft[Ce]?0:ft[Ce]%qs;return qe&&(ft=[qe].concat(ft),++ht),jt(fe,ft,ht)},C.precision=C.sd=function(fe,Ce){var je,Fe,qe,Ge=this;if(fe!=null&&fe!==!!fe)return s(fe,1,Is),Ce==null?Ce=q:s(Ce,0,8),Pt(new Ye(Ge),fe,Ce);if(!(je=Ge.c))return null;if(qe=je.length-1,Fe=qe*oi+1,qe=je[qe]){for(;qe%10==0;qe/=10,Fe--);for(qe=je[0];qe>=10;qe/=10,Fe++);}return fe&&Ge.e+1>Fe&&(Fe=Ge.e+1),Fe},C.shiftedBy=function(fe){return s(fe,-9007199254740991,Yo),this.times("1e"+fe)},C.squareRoot=C.sqrt=function(){var fe,Ce,je,Fe,qe,Ge=this,ht=Ge.c,ft=Ge.s,yt=Ge.e,Tt=z+4,Bt=new Ye("0.5");if(ft!==1||!ht||!ht[0])return new Ye(!ft||ft<0&&(!ht||ht[0])?NaN:ht?Ge:1/0);if(ft=Math.sqrt(+It(Ge)),ft==0||ft==1/0?(Ce=fs(ht),(Ce.length+yt)%2==0&&(Ce+="0"),ft=Math.sqrt(+Ce),yt=hs((yt+1)/2)-(yt<0||yt%2),ft==1/0?Ce="5e"+yt:(Ce=ft.toExponential(),Ce=Ce.slice(0,Ce.indexOf("e")+1)+yt),je=new Ye(Ce)):je=new Ye(ft+""),je.c[0]){for(yt=je.e,ft=yt+Tt,ft<3&&(ft=0);;)if(qe=je,je=Bt.times(qe.plus(c(Ge,qe,Tt,1))),fs(qe.c).slice(0,ft)===(Ce=fs(je.c)).slice(0,ft))if(je.e<yt&&--ft,Ce=Ce.slice(ft-3,ft+1),Ce=="9999"||!Fe&&Ce=="4999"){if(!Fe&&(Pt(qe,qe.e+z+2,0),qe.times(qe).eq(Ge))){je=qe;break}Tt+=4,ft+=4,Fe=1}else{(!+Ce||!+Ce.slice(1)&&Ce.charAt(0)=="5")&&(Pt(je,je.e+z+2,1),fe=!je.times(je).eq(Ge));break}}return Pt(je,je.e+z+1,q,fe)},C.toExponential=function(fe,Ce){return fe!=null&&(s(fe,0,Is),fe++),at(this,fe,Ce,1)},C.toFixed=function(fe,Ce){return fe!=null&&(s(fe,0,Is),fe=fe+this.e+1),at(this,fe,Ce)},C.toFormat=function(fe,Ce,je){var Fe,qe=this;if(je==null)fe!=null&&Ce&&typeof Ce=="object"?(je=Ce,Ce=null):fe&&typeof fe=="object"?(je=fe,fe=Ce=null):je=bn;else if(typeof je!="object")throw Error(yr+"Argument not an object: "+je);if(Fe=qe.toFixed(fe,Ce),qe.c){var Ge,ht=Fe.split("."),ft=+je.groupSize,yt=+je.secondaryGroupSize,Tt=je.groupSeparator||"",Bt=ht[0],on=ht[1],On=qe.s<0,Fn=On?Bt.slice(1):Bt,Jn=Fn.length;if(yt&&(Ge=ft,ft=yt,yt=Ge,Jn-=Ge),ft>0&&Jn>0){for(Ge=Jn%ft||ft,Bt=Fn.substr(0,Ge);Ge<Jn;Ge+=ft)Bt+=Tt+Fn.substr(Ge,ft);yt>0&&(Bt+=Tt+Fn.slice(Ge)),On&&(Bt="-"+Bt)}Fe=on?Bt+(je.decimalSeparator||"")+((yt=+je.fractionGroupSize)?on.replace(new RegExp("\\d{"+yt+"}\\B","g"),"$&"+(je.fractionGroupSeparator||"")):on):Bt}return(je.prefix||"")+Fe+(je.suffix||"")},C.toFraction=function(fe){var Ce,je,Fe,qe,Ge,ht,ft,yt,Tt,Bt,on,On,Fn=this,Jn=Fn.c;if(fe!=null&&(ft=new Ye(fe),!ft.isInteger()&&(ft.c||ft.s!==1)||ft.lt(M)))throw Error(yr+"Argument "+(ft.isInteger()?"out of range: ":"not an integer: ")+It(ft));if(!Jn)return new Ye(Fn);for(Ce=new Ye(M),Tt=je=new Ye(M),Fe=yt=new Ye(M),On=fs(Jn),Ge=Ce.e=On.length-Fn.e-1,Ce.c[0]=Xo[(ht=Ge%oi)<0?oi+ht:ht],fe=!fe||ft.comparedTo(Ce)>0?Ge>0?Ce:Tt:ft,ht=He,He=1/0,ft=new Ye(On),yt.c[0]=0;Bt=c(ft,Ce,0,1),qe=je.plus(Bt.times(Fe)),qe.comparedTo(fe)!=1;)je=Fe,Fe=qe,Tt=yt.plus(Bt.times(qe=Tt)),yt=qe,Ce=ft.minus(Bt.times(qe=Ce)),ft=qe;return qe=c(fe.minus(je),Fe,0,1),yt=yt.plus(qe.times(Tt)),je=je.plus(qe.times(Fe)),yt.s=Tt.s=Fn.s,Ge=Ge*2,on=c(Tt,Fe,Ge,q).minus(Fn).abs().comparedTo(c(yt,je,Ge,q).minus(Fn).abs())<1?[Tt,Fe]:[yt,je],He=ht,on},C.toNumber=function(){return+It(this)},C.toPrecision=function(fe,Ce){return fe!=null&&s(fe,1,Is),at(this,fe,Ce,2)},C.toString=function(fe){var Ce,je=this,Fe=je.s,qe=je.e;return qe===null?Fe?(Ce="Infinity",Fe<0&&(Ce="-"+Ce)):Ce="NaN":(fe==null?Ce=qe<=ce||qe>=be?x(fs(je.c),qe):T(fs(je.c),qe,"0"):fe===10&&ti?(je=Pt(new Ye(je),z+qe+1,q),Ce=T(fs(je.c),je.e,"0")):(s(fe,2,Pn.length,"Base"),Ce=g(T(fs(je.c),qe,"0"),10,fe,Fe,!0)),Fe<0&&je.c[0]&&(Ce="-"+Ce)),Ce},C.valueOf=C.toJSON=function(){return It(this)},C._isBigNumber=!0,C[Symbol.toStringTag]="BigNumber",C[Symbol.for("nodejs.util.inspect.custom")]=C.valueOf,a!=null&&Ye.set(a),Ye}function hs(a){var c=a|0;return a>0||a===c?c:c-1}function fs(a){for(var c,g,y=1,C=a.length,M=a[0]+"";y<C;){for(c=a[y++]+"",g=oi-c.length;g--;c="0"+c);M+=c}for(C=M.length;M.charCodeAt(--C)===48;);return M.slice(0,C+1||1)}function bo(a,c){var g,y,C=a.c,M=c.c,z=a.s,q=c.s,ce=a.e,be=c.e;if(!z||!q)return null;if(g=C&&!C[0],y=M&&!M[0],g||y)return g?y?0:-q:z;if(z!=q)return z;if(g=z<0,y=ce==be,!C||!M)return y?0:!C^g?1:-1;if(!y)return ce>be^g?1:-1;for(q=(ce=C.length)<(be=M.length)?ce:be,z=0;z<q;z++)if(C[z]!=M[z])return C[z]>M[z]^g?1:-1;return ce==be?0:ce>be^g?1:-1}function s(a,c,g,y){if(a<c||a>g||a!==ts(a))throw Error(yr+(y||"Argument")+(typeof a=="number"?a<c||a>g?" out of range: ":" not an integer: ":" not a primitive number: ")+String(a))}function f(a){var c=a.c.length-1;return hs(a.e/oi)==c&&a.c[c]%2!=0}function x(a,c){return(a.length>1?a.charAt(0)+"."+a.slice(1):a)+(c<0?"e":"e+")+c}function T(a,c,g){var y,C;if(c<0){for(C=g+".";++c;C+=g);a=C+a}else if(y=a.length,++c>y){for(C=g,c-=y;--c;C+=g);a+=C}else c<y&&(a=a.slice(0,c)+"."+a.slice(c));return a}var K=Tu(),we=K,ct=class{constructor(a){Mt(this,"key");Mt(this,"left",null);Mt(this,"right",null);this.key=a}},Dt=class extends ct{constructor(a){super(a)}},$t=class{constructor(){Mt(this,"size",0);Mt(this,"modificationCount",0);Mt(this,"splayCount",0)}splay(a){let c=this.root;if(c==null)return this.compare(a,a),-1;let g=null,y=null,C=null,M=null,z=c,q=this.compare,ce;for(;;)if(ce=q(z.key,a),ce>0){let be=z.left;if(be==null||(ce=q(be.key,a),ce>0&&(z.left=be.right,be.right=z,z=be,be=z.left,be==null)))break;g==null?y=z:g.left=z,g=z,z=be}else if(ce<0){let be=z.right;if(be==null||(ce=q(be.key,a),ce<0&&(z.right=be.left,be.left=z,z=be,be=z.right,be==null)))break;C==null?M=z:C.right=z,C=z,z=be}else break;return C!=null&&(C.right=z.left,z.left=M),g!=null&&(g.left=z.right,z.right=y),this.root!==z&&(this.root=z,this.splayCount++),ce}splayMin(a){let c=a,g=c.left;for(;g!=null;){let y=g;c.left=y.right,y.right=c,c=y,g=c.left}return c}splayMax(a){let c=a,g=c.right;for(;g!=null;){let y=g;c.right=y.left,y.left=c,c=y,g=c.right}return c}_delete(a){if(this.root==null||this.splay(a)!=0)return null;let c=this.root,g=c,y=c.left;if(this.size--,y==null)this.root=c.right;else{let C=c.right;c=this.splayMax(y),c.right=C,this.root=c}return this.modificationCount++,g}addNewRoot(a,c){this.size++,this.modificationCount++;let g=this.root;if(g==null){this.root=a;return}c<0?(a.left=g,a.right=g.right,g.right=null):(a.right=g,a.left=g.left,g.left=null),this.root=a}_first(){let a=this.root;return a==null?null:(this.root=this.splayMin(a),this.root)}_last(){let a=this.root;return a==null?null:(this.root=this.splayMax(a),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(a){return this.validKey(a)&&this.splay(a)==0}defaultCompare(){return(a,c)=>a<c?-1:a>c?1:0}wrap(){return{getRoot:()=>this.root,setRoot:a=>{this.root=a},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:a=>{this.splayCount=a},splay:a=>this.splay(a),has:a=>this.has(a)}}},an=class bf extends $t{constructor(g,y){super();Mt(this,"root",null);Mt(this,"compare");Mt(this,"validKey");Mt(this,An,"[object Set]");this.compare=g??this.defaultCompare(),this.validKey=y??(C=>C!=null&&C!=null)}delete(g){return this.validKey(g)?this._delete(g)!=null:!1}deleteAll(g){for(let y of g)this.delete(y)}forEach(g){let y=this[Symbol.iterator](),C;for(;C=y.next(),!C.done;)g(C.value,C.value,this)}add(g){let y=this.splay(g);return y!=0&&this.addNewRoot(new Dt(g),y),this}addAndReturn(g){let y=this.splay(g);return y!=0&&this.addNewRoot(new Dt(g),y),this.root.key}addAll(g){for(let y of g)this.add(y)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(g){if(g==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(g)<0)return this.root.key;let y=this.root.left;if(y==null)return null;let C=y.right;for(;C!=null;)y=C,C=y.right;return y.key}firstAfter(g){if(g==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(g)>0)return this.root.key;let y=this.root.right;if(y==null)return null;let C=y.left;for(;C!=null;)y=C,C=y.left;return y.key}retainAll(g){let y=new bf(this.compare,this.validKey),C=this.modificationCount;for(let M of g){if(C!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(M)&&this.splay(M)==0&&y.add(this.root.key)}y.size!=this.size&&(this.root=y.root,this.size=y.size,this.modificationCount++)}lookup(g){return!this.validKey(g)||this.splay(g)!=0?null:this.root.key}intersection(g){let y=new bf(this.compare,this.validKey);for(let C of this)g.has(C)&&y.add(C);return y}difference(g){let y=new bf(this.compare,this.validKey);for(let C of this)g.has(C)||y.add(C);return y}union(g){let y=this.clone();return y.addAll(g),y}clone(){let g=new bf(this.compare,this.validKey);return g.size=this.size,g.root=this.copyNode(this.root),g}copyNode(g){if(g==null)return null;function y(M,z){let q,ce;do{if(q=M.left,ce=M.right,q!=null){let be=new Dt(q.key);z.left=be,y(q,be)}if(ce!=null){let be=new Dt(ce.key);z.right=be,M=ce,z=be}}while(ce!=null)}let C=new Dt(g.key);return y(g,C),C}toSet(){return this.clone()}entries(){return new Ei(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[(Kn=Symbol.iterator,An=Symbol.toStringTag,Kn)](){return new Zn(this.wrap())}},Nn=class{constructor(a){Mt(this,"tree");Mt(this,"path",new Array);Mt(this,"modificationCount",null);Mt(this,"splayCount");this.tree=a,this.splayCount=a.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;let a=this.path[this.path.length-1];return this.getValue(a)}rebuildPath(a){this.path.splice(0,this.path.length),this.tree.splay(a),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(a){for(;a!=null;)this.path.push(a),a=a.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let g=this.tree.getRoot();for(;g!=null;)this.path.push(g),g=g.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let a=this.path[this.path.length-1],c=a.right;if(c!=null){for(;c!=null;)this.path.push(c),c=c.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===a;)a=this.path.pop();return this.path.length>0}},Zn=class extends Nn{getValue(a){return a.key}},Ei=class extends Nn{getValue(a){return[a.key,a.key]}},ns=a=>a,Or=a=>{if(a){let c=new an($s(a)),g=new an($s(a)),y=(M,z)=>z.addAndReturn(M),C=M=>({x:y(M.x,c),y:y(M.y,g)});return C({x:new we(0),y:new we(0)}),C}return ns},ds=a=>({set:c=>{Tr=ds(c)},reset:()=>ds(a),compare:$s(a),snap:Or(a),orient:co(a)}),Tr=ds(),Gs=(a,c)=>a.ll.x.isLessThanOrEqualTo(c.x)&&c.x.isLessThanOrEqualTo(a.ur.x)&&a.ll.y.isLessThanOrEqualTo(c.y)&&c.y.isLessThanOrEqualTo(a.ur.y),Bu=(a,c)=>{if(c.ur.x.isLessThan(a.ll.x)||a.ur.x.isLessThan(c.ll.x)||c.ur.y.isLessThan(a.ll.y)||a.ur.y.isLessThan(c.ll.y))return null;let g=a.ll.x.isLessThan(c.ll.x)?c.ll.x:a.ll.x,y=a.ur.x.isLessThan(c.ur.x)?a.ur.x:c.ur.x,C=a.ll.y.isLessThan(c.ll.y)?c.ll.y:a.ll.y,M=a.ur.y.isLessThan(c.ur.y)?a.ur.y:c.ur.y;return{ll:{x:g,y:C},ur:{x:y,y:M}}},Io=(a,c)=>a.x.times(c.y).minus(a.y.times(c.x)),wo=(a,c)=>a.x.times(c.x).plus(a.y.times(c.y)),ho=a=>wo(a,a).sqrt(),Nc=(a,c,g)=>{let y={x:c.x.minus(a.x),y:c.y.minus(a.y)},C={x:g.x.minus(a.x),y:g.y.minus(a.y)};return Io(C,y).div(ho(C)).div(ho(y))},vl=(a,c,g)=>{let y={x:c.x.minus(a.x),y:c.y.minus(a.y)},C={x:g.x.minus(a.x),y:g.y.minus(a.y)};return wo(C,y).div(ho(C)).div(ho(y))},nr=(a,c,g)=>c.y.isZero()?null:{x:a.x.plus(c.x.div(c.y).times(g.minus(a.y))),y:g},Ss=(a,c,g)=>c.x.isZero()?null:{x:g,y:a.y.plus(c.y.div(c.x).times(g.minus(a.x)))},Ne=(a,c,g,y)=>{if(c.x.isZero())return Ss(g,y,a.x);if(y.x.isZero())return Ss(a,c,g.x);if(c.y.isZero())return nr(g,y,a.y);if(y.y.isZero())return nr(a,c,g.y);let C=Io(c,y);if(C.isZero())return null;let M={x:g.x.minus(a.x),y:g.y.minus(a.y)},z=Io(M,c).div(C),q=Io(M,y).div(C),ce=a.x.plus(q.times(c.x)),be=g.x.plus(z.times(y.x)),Xe=a.y.plus(q.times(c.y)),He=g.y.plus(z.times(y.y)),xt=ce.plus(be).div(2),Ot=Xe.plus(He).div(2);return{x:xt,y:Ot}},Vs=class c4{constructor(c,g){Mt(this,"point");Mt(this,"isLeft");Mt(this,"segment");Mt(this,"otherSE");Mt(this,"consumedBy");c.events===void 0?c.events=[this]:c.events.push(this),this.point=c,this.isLeft=g}static compare(c,g){let y=c4.comparePoints(c.point,g.point);return y!==0?y:(c.point!==g.point&&c.link(g),c.isLeft!==g.isLeft?c.isLeft?1:-1:ps.compare(c.segment,g.segment))}static comparePoints(c,g){return c.x.isLessThan(g.x)?-1:c.x.isGreaterThan(g.x)?1:c.y.isLessThan(g.y)?-1:c.y.isGreaterThan(g.y)?1:0}link(c){if(c.point===this.point)throw new Error("Tried to link already linked events");let g=c.point.events;for(let y=0,C=g.length;y<C;y++){let M=g[y];this.point.events.push(M),M.point=this.point}this.checkForConsuming()}checkForConsuming(){let c=this.point.events.length;for(let g=0;g<c;g++){let y=this.point.events[g];if(y.segment.consumedBy===void 0)for(let C=g+1;C<c;C++){let M=this.point.events[C];M.consumedBy===void 0&&y.otherSE.point.events===M.otherSE.point.events&&y.segment.consume(M.segment)}}}getAvailableLinkedEvents(){let c=[];for(let g=0,y=this.point.events.length;g<y;g++){let C=this.point.events[g];C!==this&&!C.segment.ringOut&&C.segment.isInResult()&&c.push(C)}return c}getLeftmostComparator(c){let g=new Map,y=C=>{let M=C.otherSE;g.set(C,{sine:Nc(this.point,c.point,M.point),cosine:vl(this.point,c.point,M.point)})};return(C,M)=>{g.has(C)||y(C),g.has(M)||y(M);let{sine:z,cosine:q}=g.get(C),{sine:ce,cosine:be}=g.get(M);return z.isGreaterThanOrEqualTo(0)&&ce.isGreaterThanOrEqualTo(0)?q.isLessThan(be)?1:q.isGreaterThan(be)?-1:0:z.isLessThan(0)&&ce.isLessThan(0)?q.isLessThan(be)?-1:q.isGreaterThan(be)?1:0:ce.isLessThan(z)?-1:ce.isGreaterThan(z)?1:0}}},Il=0,ps=class qd{constructor(c,g,y,C){Mt(this,"id");Mt(this,"leftSE");Mt(this,"rightSE");Mt(this,"rings");Mt(this,"windings");Mt(this,"ringOut");Mt(this,"consumedBy");Mt(this,"prev");Mt(this,"_prevInResult");Mt(this,"_beforeState");Mt(this,"_afterState");Mt(this,"_isInResult");this.id=++Il,this.leftSE=c,c.segment=this,c.otherSE=g,this.rightSE=g,g.segment=this,g.otherSE=c,this.rings=y,this.windings=C}static compare(c,g){let y=c.leftSE.point.x,C=g.leftSE.point.x,M=c.rightSE.point.x,z=g.rightSE.point.x;if(z.isLessThan(y))return 1;if(M.isLessThan(C))return-1;let q=c.leftSE.point.y,ce=g.leftSE.point.y,be=c.rightSE.point.y,Xe=g.rightSE.point.y;if(y.isLessThan(C)){if(ce.isLessThan(q)&&ce.isLessThan(be))return 1;if(ce.isGreaterThan(q)&&ce.isGreaterThan(be))return-1;let He=c.comparePoint(g.leftSE.point);if(He<0)return 1;if(He>0)return-1;let xt=g.comparePoint(c.rightSE.point);return xt!==0?xt:-1}if(y.isGreaterThan(C)){if(q.isLessThan(ce)&&q.isLessThan(Xe))return-1;if(q.isGreaterThan(ce)&&q.isGreaterThan(Xe))return 1;let He=g.comparePoint(c.leftSE.point);if(He!==0)return He;let xt=c.comparePoint(g.rightSE.point);return xt<0?1:xt>0?-1:1}if(q.isLessThan(ce))return-1;if(q.isGreaterThan(ce))return 1;if(M.isLessThan(z)){let He=g.comparePoint(c.rightSE.point);if(He!==0)return He}if(M.isGreaterThan(z)){let He=c.comparePoint(g.rightSE.point);if(He<0)return 1;if(He>0)return-1}if(!M.eq(z)){let He=be.minus(q),xt=M.minus(y),Ot=Xe.minus(ce),en=z.minus(C);if(He.isGreaterThan(xt)&&Ot.isLessThan(en))return 1;if(He.isLessThan(xt)&&Ot.isGreaterThan(en))return-1}return M.isGreaterThan(z)?1:M.isLessThan(z)||be.isLessThan(Xe)?-1:be.isGreaterThan(Xe)?1:c.id<g.id?-1:c.id>g.id?1:0}static fromRing(c,g,y){let C,M,z,q=Vs.comparePoints(c,g);if(q<0)C=c,M=g,z=1;else if(q>0)C=g,M=c,z=-1;else throw new Error(`Tried to create degenerate segment at [${c.x}, ${c.y}]`);let ce=new Vs(C,!0),be=new Vs(M,!1);return new qd(ce,be,[y],[z])}replaceRightSE(c){this.rightSE=c,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){let c=this.leftSE.point.y,g=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:c.isLessThan(g)?c:g},ur:{x:this.rightSE.point.x,y:c.isGreaterThan(g)?c:g}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(c){return c.x.eq(this.leftSE.point.x)&&c.y.eq(this.leftSE.point.y)||c.x.eq(this.rightSE.point.x)&&c.y.eq(this.rightSE.point.y)}comparePoint(c){return Tr.orient(this.leftSE.point,c,this.rightSE.point)}getIntersection(c){let g=this.bbox(),y=c.bbox(),C=Bu(g,y);if(C===null)return null;let M=this.leftSE.point,z=this.rightSE.point,q=c.leftSE.point,ce=c.rightSE.point,be=Gs(g,q)&&this.comparePoint(q)===0,Xe=Gs(y,M)&&c.comparePoint(M)===0,He=Gs(g,ce)&&this.comparePoint(ce)===0,xt=Gs(y,z)&&c.comparePoint(z)===0;if(Xe&&be)return xt&&!He?z:!xt&&He?ce:null;if(Xe)return He&&M.x.eq(ce.x)&&M.y.eq(ce.y)?null:M;if(be)return xt&&z.x.eq(q.x)&&z.y.eq(q.y)?null:q;if(xt&&He)return null;if(xt)return z;if(He)return ce;let Ot=Ne(M,this.vector(),q,c.vector());return Ot===null||!Gs(C,Ot)?null:Tr.snap(Ot)}split(c){let g=[],y=c.events!==void 0,C=new Vs(c,!0),M=new Vs(c,!1),z=this.rightSE;this.replaceRightSE(M),g.push(M),g.push(C);let q=new qd(C,z,this.rings.slice(),this.windings.slice());return Vs.comparePoints(q.leftSE.point,q.rightSE.point)>0&&q.swapEvents(),Vs.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),y&&(C.checkForConsuming(),M.checkForConsuming()),g}swapEvents(){let c=this.rightSE;this.rightSE=this.leftSE,this.leftSE=c,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let g=0,y=this.windings.length;g<y;g++)this.windings[g]*=-1}consume(c){let g=this,y=c;for(;g.consumedBy;)g=g.consumedBy;for(;y.consumedBy;)y=y.consumedBy;let C=qd.compare(g,y);if(C!==0){if(C>0){let M=g;g=y,y=M}if(g.prev===y){let M=g;g=y,y=M}for(let M=0,z=y.rings.length;M<z;M++){let q=y.rings[M],ce=y.windings[M],be=g.rings.indexOf(q);be===-1?(g.rings.push(q),g.windings.push(ce)):g.windings[be]+=ce}y.rings=null,y.windings=null,y.consumedBy=g,y.leftSE.consumedBy=g.leftSE,y.rightSE.consumedBy=g.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{let c=this.prev.consumedBy||this.prev;this._beforeState=c.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;let c=this.beforeState();this._afterState={rings:c.rings.slice(0),windings:c.windings.slice(0),multiPolys:[]};let g=this._afterState.rings,y=this._afterState.windings,C=this._afterState.multiPolys;for(let q=0,ce=this.rings.length;q<ce;q++){let be=this.rings[q],Xe=this.windings[q],He=g.indexOf(be);He===-1?(g.push(be),y.push(Xe)):y[He]+=Xe}let M=[],z=[];for(let q=0,ce=g.length;q<ce;q++){if(y[q]===0)continue;let be=g[q],Xe=be.poly;if(z.indexOf(Xe)===-1)if(be.isExterior)M.push(Xe);else{z.indexOf(Xe)===-1&&z.push(Xe);let He=M.indexOf(be.poly);He!==-1&&M.splice(He,1)}}for(let q=0,ce=M.length;q<ce;q++){let be=M[q].multiPoly;C.indexOf(be)===-1&&C.push(be)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;let c=this.beforeState().multiPolys,g=this.afterState().multiPolys;switch(rc.type){case"union":{let y=c.length===0,C=g.length===0;this._isInResult=y!==C;break}case"intersection":{let y,C;c.length<g.length?(y=c.length,C=g.length):(y=g.length,C=c.length),this._isInResult=C===rc.numMultiPolys&&y<C;break}case"xor":{let y=Math.abs(c.length-g.length);this._isInResult=y%2===1;break}case"difference":{let y=C=>C.length===1&&C[0].isSubject;this._isInResult=y(c)!==y(g);break}}return this._isInResult}},Ti=class{constructor(a,c,g){Mt(this,"poly");Mt(this,"isExterior");Mt(this,"segments");Mt(this,"bbox");if(!Array.isArray(a)||a.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=c,this.isExterior=g,this.segments=[],typeof a[0][0]!="number"||typeof a[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let y=Tr.snap({x:new we(a[0][0]),y:new we(a[0][1])});this.bbox={ll:{x:y.x,y:y.y},ur:{x:y.x,y:y.y}};let C=y;for(let M=1,z=a.length;M<z;M++){if(typeof a[M][0]!="number"||typeof a[M][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let q=Tr.snap({x:new we(a[M][0]),y:new we(a[M][1])});q.x.eq(C.x)&&q.y.eq(C.y)||(this.segments.push(ps.fromRing(C,q,this)),q.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=q.x),q.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=q.y),q.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=q.x),q.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=q.y),C=q)}(!y.x.eq(C.x)||!y.y.eq(C.y))&&this.segments.push(ps.fromRing(C,y,this))}getSweepEvents(){let a=[];for(let c=0,g=this.segments.length;c<g;c++){let y=this.segments[c];a.push(y.leftSE),a.push(y.rightSE)}return a}},nc=class{constructor(a,c){Mt(this,"multiPoly");Mt(this,"exteriorRing");Mt(this,"interiorRings");Mt(this,"bbox");if(!Array.isArray(a))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Ti(a[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let g=1,y=a.length;g<y;g++){let C=new Ti(a[g],this,!1);C.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=C.bbox.ll.x),C.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=C.bbox.ll.y),C.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=C.bbox.ur.x),C.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=C.bbox.ur.y),this.interiorRings.push(C)}this.multiPoly=c}getSweepEvents(){let a=this.exteriorRing.getSweepEvents();for(let c=0,g=this.interiorRings.length;c<g;c++){let y=this.interiorRings[c].getSweepEvents();for(let C=0,M=y.length;C<M;C++)a.push(y[C])}return a}},dh=class{constructor(a,c){Mt(this,"isSubject");Mt(this,"polys");Mt(this,"bbox");if(!Array.isArray(a))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof a[0][0][0]=="number"&&(a=[a])}catch{}this.polys=[],this.bbox={ll:{x:new we(Number.POSITIVE_INFINITY),y:new we(Number.POSITIVE_INFINITY)},ur:{x:new we(Number.NEGATIVE_INFINITY),y:new we(Number.NEGATIVE_INFINITY)}};for(let g=0,y=a.length;g<y;g++){let C=new nc(a[g],this);C.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=C.bbox.ll.x),C.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=C.bbox.ll.y),C.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=C.bbox.ur.x),C.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=C.bbox.ur.y),this.polys.push(C)}this.isSubject=c}getSweepEvents(){let a=[];for(let c=0,g=this.polys.length;c<g;c++){let y=this.polys[c].getSweepEvents();for(let C=0,M=y.length;C<M;C++)a.push(y[C])}return a}},ic=class kg{constructor(c){Mt(this,"events");Mt(this,"poly");Mt(this,"_isExteriorRing");Mt(this,"_enclosingRing");this.events=c;for(let g=0,y=c.length;g<y;g++)c[g].segment.ringOut=this;this.poly=null}static factory(c){let g=[];for(let y=0,C=c.length;y<C;y++){let M=c[y];if(!M.isInResult()||M.ringOut)continue;let z=null,q=M.leftSE,ce=M.rightSE,be=[q],Xe=q.point,He=[];for(;z=q,q=ce,be.push(q),q.point!==Xe;)for(;;){let xt=q.getAvailableLinkedEvents();if(xt.length===0){let bn=be[0].point,Pn=be[be.length-1].point;throw new Error(`Unable to complete output ring starting at [${bn.x}, ${bn.y}]. Last matching segment found ends at [${Pn.x}, ${Pn.y}].`)}if(xt.length===1){ce=xt[0].otherSE;break}let Ot=null;for(let bn=0,Pn=He.length;bn<Pn;bn++)if(He[bn].point===q.point){Ot=bn;break}if(Ot!==null){let bn=He.splice(Ot)[0],Pn=be.splice(bn.index);Pn.unshift(Pn[0].otherSE),g.push(new kg(Pn.reverse()));continue}He.push({index:be.length,point:q.point});let en=q.getLeftmostComparator(z);ce=xt.sort(en)[0].otherSE;break}g.push(new kg(be))}return g}getGeom(){let c=this.events[0].point,g=[c];for(let be=1,Xe=this.events.length-1;be<Xe;be++){let He=this.events[be].point,xt=this.events[be+1].point;Tr.orient(He,c,xt)!==0&&(g.push(He),c=He)}if(g.length===1)return null;let y=g[0],C=g[1];Tr.orient(y,c,C)===0&&g.shift(),g.push(g[0]);let M=this.isExteriorRing()?1:-1,z=this.isExteriorRing()?0:g.length-1,q=this.isExteriorRing()?g.length:-1,ce=[];for(let be=z;be!=q;be+=M)ce.push([g[be].x.toNumber(),g[be].y.toNumber()]);return ce}isExteriorRing(){if(this._isExteriorRing===void 0){let c=this.enclosingRing();this._isExteriorRing=c?!c.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var C,M;let c=this.events[0];for(let z=1,q=this.events.length;z<q;z++){let ce=this.events[z];Vs.compare(c,ce)>0&&(c=ce)}let g=c.segment.prevInResult(),y=g?g.prevInResult():null;for(;;){if(!g)return null;if(!y)return g.ringOut;if(y.ringOut!==g.ringOut)return((C=y.ringOut)==null?void 0:C.enclosingRing())!==g.ringOut?g.ringOut:(M=g.ringOut)==null?void 0:M.enclosingRing();g=y.prevInResult(),y=g?g.prevInResult():null}}},ga=class{constructor(a){Mt(this,"exteriorRing");Mt(this,"interiorRings");this.exteriorRing=a,a.poly=this,this.interiorRings=[]}addInterior(a){this.interiorRings.push(a),a.poly=this}getGeom(){let a=this.exteriorRing.getGeom();if(a===null)return null;let c=[a];for(let g=0,y=this.interiorRings.length;g<y;g++){let C=this.interiorRings[g].getGeom();C!==null&&c.push(C)}return c}},Nu=class{constructor(a){Mt(this,"rings");Mt(this,"polys");this.rings=a,this.polys=this._composePolys(a)}getGeom(){let a=[];for(let c=0,g=this.polys.length;c<g;c++){let y=this.polys[c].getGeom();y!==null&&a.push(y)}return a}_composePolys(a){var g;let c=[];for(let y=0,C=a.length;y<C;y++){let M=a[y];if(!M.poly)if(M.isExteriorRing())c.push(new ga(M));else{let z=M.enclosingRing();z!=null&&z.poly||c.push(new ga(z)),(g=z==null?void 0:z.poly)==null||g.addInterior(M)}}return c}},Dc=class{constructor(a,c=ps.compare){Mt(this,"queue");Mt(this,"tree");Mt(this,"segments");this.queue=a,this.tree=new an(c),this.segments=[]}process(a){let c=a.segment,g=[];if(a.consumedBy)return a.isLeft?this.queue.delete(a.otherSE):this.tree.delete(c),g;a.isLeft&&this.tree.add(c);let y=c,C=c;do y=this.tree.lastBefore(y);while(y!=null&&y.consumedBy!=null);do C=this.tree.firstAfter(C);while(C!=null&&C.consumedBy!=null);if(a.isLeft){let M=null;if(y){let q=y.getIntersection(c);if(q!==null&&(c.isAnEndpoint(q)||(M=q),!y.isAnEndpoint(q))){let ce=this._splitSafely(y,q);for(let be=0,Xe=ce.length;be<Xe;be++)g.push(ce[be])}}let z=null;if(C){let q=C.getIntersection(c);if(q!==null&&(c.isAnEndpoint(q)||(z=q),!C.isAnEndpoint(q))){let ce=this._splitSafely(C,q);for(let be=0,Xe=ce.length;be<Xe;be++)g.push(ce[be])}}if(M!==null||z!==null){let q=null;M===null?q=z:z===null?q=M:q=Vs.comparePoints(M,z)<=0?M:z,this.queue.delete(c.rightSE),g.push(c.rightSE);let ce=c.split(q);for(let be=0,Xe=ce.length;be<Xe;be++)g.push(ce[be])}g.length>0?(this.tree.delete(c),g.push(a)):(this.segments.push(c),c.prev=y)}else{if(y&&C){let M=y.getIntersection(C);if(M!==null){if(!y.isAnEndpoint(M)){let z=this._splitSafely(y,M);for(let q=0,ce=z.length;q<ce;q++)g.push(z[q])}if(!C.isAnEndpoint(M)){let z=this._splitSafely(C,M);for(let q=0,ce=z.length;q<ce;q++)g.push(z[q])}}}this.tree.delete(c)}return g}_splitSafely(a,c){this.tree.delete(a);let g=a.rightSE;this.queue.delete(g);let y=a.split(c);return y.push(g),a.consumedBy===void 0&&this.tree.add(a),y}},Qh=class{constructor(){Mt(this,"type");Mt(this,"numMultiPolys")}run(a,c,g){cu.type=a;let y=[new dh(c,!0)];for(let ce=0,be=g.length;ce<be;ce++)y.push(new dh(g[ce],!1));if(cu.numMultiPolys=y.length,cu.type==="difference"){let ce=y[0],be=1;for(;be<y.length;)Bu(y[be].bbox,ce.bbox)!==null?be++:y.splice(be,1)}if(cu.type==="intersection")for(let ce=0,be=y.length;ce<be;ce++){let Xe=y[ce];for(let He=ce+1,xt=y.length;He<xt;He++)if(Bu(Xe.bbox,y[He].bbox)===null)return[]}let C=new an(Vs.compare);for(let ce=0,be=y.length;ce<be;ce++){let Xe=y[ce].getSweepEvents();for(let He=0,xt=Xe.length;He<xt;He++)C.add(Xe[He])}let M=new Dc(C),z=null;for(C.size!=0&&(z=C.first(),C.delete(z));z;){let ce=M.process(z);for(let be=0,Xe=ce.length;be<Xe;be++){let He=ce[be];He.consumedBy===void 0&&C.add(He)}C.size!=0?(z=C.first(),C.delete(z)):z=null}Tr.reset();let q=ic.factory(M.segments);return new Nu(q).getGeom()}},cu=new Qh,rc=cu,il=(a,...c)=>rc.run("intersection",a,c),ef=(a,...c)=>rc.run("difference",a,c);Tr.set;function sc(a){let c={type:"Feature"};return c.geometry=a,c}function oc(a){return a.type==="Feature"?a.geometry:a}function ph(a){return a&&a.geometry&&a.geometry.coordinates?a.geometry.coordinates:a}function gh(a){return sc({type:"LineString",coordinates:a})}function Qo(a){return sc({type:"MultiLineString",coordinates:a})}function mh(a){return sc({type:"Polygon",coordinates:a})}function vh(a){return sc({type:"MultiPolygon",coordinates:a})}function yh(a,c){let g=oc(a),y=oc(c),C=il(g.coordinates,y.coordinates);return C.length===0?null:C.length===1?mh(C[0]):vh(C)}function v(a,c){let g=oc(a),y=oc(c),C=ef(g.coordinates,y.coordinates);return C.length===0?null:C.length===1?mh(C[0]):vh(C)}function S(a){return Array.isArray(a)?1+S(a[0]):-1}function N(a){a instanceof L.Polyline&&(a=a.toGeoJSON(15));let c=ph(a),g=S(c),y=[];return g>1?c.forEach(C=>{y.push(gh(C))}):y.push(a),y}function J(a){let c=[];return a.eachLayer(g=>{c.push(ph(g.toGeoJSON(15)))}),Qo(c)}Vr.Cut=Vr.Polygon.extend({initialize(a){this._map=a,this._shape="Cut",this.toolbarButtonName="cutPolygon"},_finishShape(){if(this._editedLayers=[],!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let a=this._layer.getLatLngs();if(a.length<=2)return;let c=L.polygon(a,this.options.pathOptions);c._latlngInfos=this._layer._latlngInfo,this.cut(c),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex,this._editedLayers.forEach(({layer:y,originalLayer:C})=>{this._fireCut(C,y,C),this._fireCut(this._map,y,C),C.pm._fireEdit()}),this._editedLayers=[];let g=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(g))},cut(a){let c=this._map._layers,g=a._latlngInfos||[];Object.keys(c).map(y=>c[y]).filter(y=>y.pm).filter(y=>!y._pmTempLayer).filter(y=>!L.PM.optIn&&!y.options.pmIgnore||L.PM.optIn&&y.options.pmIgnore===!1).filter(y=>y instanceof L.Polyline).filter(y=>y!==a).filter(y=>y.pm.options.allowCutting).filter(y=>this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0?this.options.layersToCut.indexOf(y)>-1:!0).filter(y=>!this._layerGroup.hasLayer(y)).filter(y=>{try{let C=!!Us(a.toGeoJSON(15),y.toGeoJSON(15)).features.length>0;return C||y instanceof L.Polyline&&!(y instanceof L.Polygon)?C:!!yh(a.toGeoJSON(15),y.toGeoJSON(15))}catch{return y instanceof L.Polygon&&console.error("You can't cut polygons with self-intersections"),!1}}).forEach(y=>{let C;if(y instanceof L.Polygon){C=L.polygon(y.getLatLngs());let ce=C.getLatLngs();g.forEach(be=>{if(be&&be.snapInfo){let{latlng:Xe}=be,He=this._calcClosestLayer(Xe,[C]);if(He&&He.segment&&He.distance<this.options.snapDistance){let{segment:xt}=He;if(xt&&xt.length===2){let{indexPath:Ot,parentPath:en,newIndex:bn}=L.PM.Utils._getIndexFromSegment(ce,xt);(Ot.length>1?(0,_r.default)(ce,en):ce).splice(bn,0,Xe)}}}})}else C=y;let M=this._cutLayer(a,C),z=L.geoJSON(M,y.options);z.getLayers().length===1&&([z]=z.getLayers()),this._setPane(z,"layerPane");let q=z.addTo(this._map.pm._getContainingLayer());if(q.pm.enable(y.pm.options),q.pm.disable(),y._pmTempLayer=!0,a._pmTempLayer=!0,y.remove(),y.removeFrom(this._map.pm._getContainingLayer()),a.remove(),a.removeFrom(this._map.pm._getContainingLayer()),q.getLayers&&q.getLayers().length===0&&this._map.pm.removeLayer({target:q}),q instanceof L.LayerGroup?(q.eachLayer(ce=>{this._addDrawnLayerProp(ce)}),this._addDrawnLayerProp(q)):this._addDrawnLayerProp(q),this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0){let ce=this.options.layersToCut.indexOf(y);ce>-1&&this.options.layersToCut.splice(ce,1)}this._editedLayers.push({layer:q,originalLayer:y})})},_cutLayer(a,c){let g=L.geoJSON(),y;if(c instanceof L.Polygon)y=v(c.toGeoJSON(15),a.toGeoJSON(15));else{let C=N(c);C.forEach(M=>{let z=qn(M,a.toGeoJSON(15)),q;z&&z.features.length>0?q=L.geoJSON(z):q=L.geoJSON(M),q.getLayers().forEach(ce=>{Bo(a.toGeoJSON(15),ce.toGeoJSON(15))||ce.addTo(g)})}),C.length>1?y=J(g):y=g.toGeoJSON(15)}return y},_change:L.Util.falseFn}),Vr.Text=Vr.extend({initialize(a){this._map=a,this._shape="Text",this.toolbarButtonName="drawText"},enable(a){L.Util.setOptions(this,a),this._enabled=!0,this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(Qn("tooltips.placeText"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this._map.getContainer().classList.add("geoman-draw-cursor"),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){var a;this._enabled&&(this._enabled=!1,this._map.off("click",this._createMarker,this),(a=this._hintMarker)==null||a.remove(),this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("mousemove",this._syncHintMarker,this),this._map.off("mousemove",this._showHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(a){this.enabled()?this.disable():this.enable(a)},_syncHintMarker(a){if(this._hintMarker.setLatLng(a.latlng),this.options.snappable){let c=a;c.target=this._hintMarker,this._handleSnapping(c)}},_createMarker(a){var C,M,z,q;if(!a.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(a.latlng);let c=this._hintMarker.getLatLng();if(this.textArea=this._createTextArea(),(C=this.options.textOptions)==null?void 0:C.className){let ce=this.options.textOptions.className.split(" ");this.textArea.classList.add(...ce)}let g=this._createTextIcon(this.textArea),y=new L.Marker(c,{textMarker:!0,_textMarkerOverPM:!0,icon:g});if(this._setPane(y,"markerPane"),this._finishLayer(y),y.pm||(y.options.draggable=!1),y.addTo(this._map.pm._getContainingLayer()),y.pm){y.pm.textArea=this.textArea,L.setOptions(y.pm,{removeIfEmpty:((M=this.options.textOptions)==null?void 0:M.removeIfEmpty)??!0});let ce=((z=this.options.textOptions)==null?void 0:z.focusAfterDraw)??!0;y.pm._createTextMarker(ce),(q=this.options.textOptions)!=null&&q.text&&y.pm.setText(this.options.textOptions.text)}this._fireCreate(y),this._cleanupSnapping(),this.disable(),this.options.continueDrawing&&this._map.once("mousemove",this._showHintMarkerAfterMoving,this)},_showHintMarkerAfterMoving(a){this.enable(),this._hintMarker.setLatLng(a.latlng)},_createTextArea(){let a=document.createElement("textarea");return a.readOnly=!0,a.classList.add("pm-textarea","pm-disabled"),a},_createTextIcon(a){return L.divIcon({className:"pm-text-marker",html:a})}});var me={enableLayerDrag(){if(!this.options.draggable||!this._layer._map)return;this.disable(),this._layerDragEnabled=!0,this._map||(this._map=this._layer._map),(this._layer instanceof L.Marker||this._layer instanceof L.ImageOverlay)&&L.DomEvent.on(this._getDOMElem(),"dragstart",this._stopDOMImageDrag),this._layer.dragging&&this._layer.dragging.disable(),this._tempDragCoord=null,or(this._layer)instanceof L.Canvas?(this._layer.on("mouseout",this.removeDraggingClass,this),this._layer.on("mouseover",this.addDraggingClass,this)):this.addDraggingClass(),this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!0;let a=this._getDOMElem();a&&(or(this._layer)instanceof L.Canvas?(this._layer.on("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._addTouchEvents(a)):L.DomEvent.on(a,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._fireDragEnable()},disableLayerDrag(){this._layerDragEnabled=!1,or(this._layer)instanceof L.Canvas?(this._layer.off("mouseout",this.removeDraggingClass,this),this._layer.off("mouseover",this.addDraggingClass,this)):this.removeDraggingClass(),this._originalMapDragState&&this._dragging&&this._map.dragging.enable(),this._safeToCacheDragState=!1,this._layer.dragging&&this._layer.dragging.disable();let a=this._getDOMElem();a&&(or(this._layer)instanceof L.Canvas?(this._layer.off("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._removeTouchEvents(a)):L.DomEvent.off(a,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._layerDragged&&this._fireUpdate(),this._layerDragged=!1,this._fireDragDisable()},dragging(){return this._dragging},layerDragEnabled(){return!!this._layerDragEnabled},_simulateMouseDownEvent(a){let c=a.touches?a.touches[0]:a,g={originalEvent:c,target:this._layer};return g.containerPoint=this._map.mouseEventToContainerPoint(c),g.latlng=this._map.containerPointToLatLng(g.containerPoint),this._dragMixinOnMouseDown(g),!1},_simulateMouseMoveEvent(a){let c=a.touches?a.touches[0]:a,g={originalEvent:c,target:this._layer};return g.containerPoint=this._map.mouseEventToContainerPoint(c),g.latlng=this._map.containerPointToLatLng(g.containerPoint),this._dragMixinOnMouseMove(g),!1},_simulateMouseUpEvent(a){let c={originalEvent:a.touches?a.touches[0]:a,target:this._layer};return a.type.indexOf("touch")===-1&&(c.containerPoint=this._map.mouseEventToContainerPoint(a),c.latlng=this._map.containerPointToLatLng(c.containerPoint)),this._dragMixinOnMouseUp(c),!1},_dragMixinOnMouseDown(a){if(a.originalEvent.button>0)return;this._overwriteEventIfItComesFromMarker(a);let c=a._fromLayerSync,g=this._syncLayers("_dragMixinOnMouseDown",a);if(this._layer instanceof L.Marker&&(this.options.snappable&&!c&&!g?this._initSnappableMarkers():this._disableSnapping()),this._layer instanceof L.CircleMarker){let y="resizeableCircleMarker";this._layer instanceof L.Circle&&(y="resizeableCircle"),this.options.snappable&&!c&&!g?this._layer.pm.options[y]||this._initSnappableMarkersDrag():this._layer.pm.options[y]?this._layer.pm._disableSnapping():this._layer.pm._disableSnappingDrag()}this._safeToCacheDragState&&(this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!1),this._tempDragCoord=a.latlng,L.DomEvent.on(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),L.DomEvent.on(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this)},_dragMixinOnMouseMove(a){this._overwriteEventIfItComesFromMarker(a);let c=this._getDOMElem();this._syncLayers("_dragMixinOnMouseMove",a),this._dragging||(this._dragging=!0,L.DomUtil.addClass(c,"leaflet-pm-dragging"),this._layer instanceof L.Marker||this._layer.bringToFront(),this._originalMapDragState&&this._map.dragging.disable(),this._fireDragStart()),this._tempDragCoord||(this._tempDragCoord=a.latlng),this._onLayerDrag(a),this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle()},_dragMixinOnMouseUp(a){let c=this._getDOMElem();return this._syncLayers("_dragMixinOnMouseUp",a),this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0,L.DomEvent.off(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this),L.DomEvent.off(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),this._dragging?(this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle(),this._layerDragged=!0,window.setTimeout(()=>{this._dragging=!1,c&&L.DomUtil.removeClass(c,"leaflet-pm-dragging"),this._fireDragEnd(),this._fireEdit(),this._layerEdited=!0},10),!0):!1},_onLayerDrag(a){let{latlng:c}=a,g={lat:c.lat-this._tempDragCoord.lat,lng:c.lng-this._tempDragCoord.lng},y=C=>C.map(M=>{if(Array.isArray(M))return y(M);let z={lat:M.lat+g.lat,lng:M.lng+g.lng};return(M.alt||M.alt===0)&&(z.alt=M.alt),z});if(this._layer instanceof L.Circle&&this._layer.options.resizeableCircle||this._layer instanceof L.CircleMarker&&this._layer.options.resizeableCircleMarker){let C=y([this._layer.getLatLng()]);this._layer.setLatLng(C[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.CircleMarker||this._layer instanceof L.Marker){let C=this._layer.getLatLng();this._layer._snapped&&(C=this._layer._orgLatLng);let M=y([C]);this._layer.setLatLng(M[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.ImageOverlay){let C=y([this._layer.getBounds().getNorthWest(),this._layer.getBounds().getSouthEast()]);this._layer.setBounds(C),this._fireChange(this._layer.getBounds(),"Edit")}else{let C=y(this._layer.getLatLngs());this._layer.setLatLngs(C),this._fireChange(this._layer.getLatLngs(),"Edit")}this._tempDragCoord=c,a.layer=this._layer,this._fireDrag(a)},addDraggingClass(){let a=this._getDOMElem();a&&L.DomUtil.addClass(a,"leaflet-pm-draggable")},removeDraggingClass(){let a=this._getDOMElem();a&&L.DomUtil.removeClass(a,"leaflet-pm-draggable")},_getDOMElem(){let a=null;return this._layer._path?a=this._layer._path:this._layer._renderer&&this._layer._renderer._container?a=this._layer._renderer._container:this._layer._image?a=this._layer._image:this._layer._icon&&(a=this._layer._icon),a},_overwriteEventIfItComesFromMarker(a){a.target.getLatLng&&(!a.target._radius||a.target._radius<=10)&&(a.containerPoint=this._map.mouseEventToContainerPoint(a.originalEvent),a.latlng=this._map.containerPointToLatLng(a.containerPoint))},_syncLayers(a,c){if(this.enabled())return!1;if(!c._fromLayerSync&&this._layer===c.target&&this.options.syncLayersOnDrag){c._fromLayerSync=!0;let g=[];if(L.Util.isArray(this.options.syncLayersOnDrag))g=this.options.syncLayersOnDrag,this.options.syncLayersOnDrag.forEach(y=>{y instanceof L.LayerGroup&&(g=g.concat(y.pm.getLayers(!0)))});else if(this.options.syncLayersOnDrag===!0&&this._parentLayerGroup)for(let y in this._parentLayerGroup){let C=this._parentLayerGroup[y];C.pm&&(g=C.pm.getLayers(!0))}return L.Util.isArray(g)&&g.length>0&&(g=g.filter(y=>!!y.pm).filter(y=>!!y.pm.options.draggable),g.forEach(y=>{y!==this._layer&&y.pm[a]&&(y._snapped=!1,y.pm[a](c))})),g.length>0}return!1},_stopDOMImageDrag(a){return a.preventDefault(),!1}},xe=me,Pe=p(di());function Be(a,c,g,y){return g.unproject(c.transform(g.project(a,y)),y)}function Re(a,c,g){let y=g.getMaxZoom();if(y===1/0&&(y=g.getZoom()),L.Util.isArray(a)){let C=[];return a.forEach(M=>{C.push(Re(M,c,g))}),C}return a instanceof L.LatLng?Be(a,c,g,y):null}function Ze(a,c){c instanceof L.Layer&&(c=c.getLatLng());let g=a.getMaxZoom();return g===1/0&&(g=a.getZoom()),a.project(c,g)}function mt(a,c){let g=a.getMaxZoom();return g===1/0&&(g=a.getZoom()),a.unproject(c,g)}var Ft={_onRotateStart(a){this._preventRenderingMarkers(!0),this._rotationOriginLatLng=this._getRotationCenter().clone(),this._rotationOriginPoint=Ze(this._map,this._rotationOriginLatLng),this._rotationStartPoint=Ze(this._map,a.target.getLatLng()),this._initialRotateLatLng=uo(this._layer),this._startAngle=this.getAngle();let c=uo(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._fireRotationStart(this._rotationLayer,c),this._fireRotationStart(this._map,c)},_onRotate(a){let c=Ze(this._map,a.target.getLatLng()),g=this._rotationStartPoint,y=this._rotationOriginPoint,C=Math.atan2(c.y-y.y,c.x-y.x)-Math.atan2(g.y-y.y,g.x-y.x);this._layer.setLatLngs(this._rotateLayer(C,this._initialRotateLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let M=this;function z(Xe,He=[],xt=-1){if(xt>-1&&He.push(xt),L.Util.isArray(Xe[0]))Xe.forEach((Ot,en)=>z(Ot,He.slice(),en));else{let Ot=He.length>0?(0,Pe.default)(M._markers,He):M._markers[0];Xe.forEach((en,bn)=>{Ot[bn].setLatLng(en)})}}z(this._layer.getLatLngs());let q=uo(this._rotationLayer);this._rotationLayer.setLatLngs(this._rotateLayer(C,this._rotationLayer.pm._rotateOrgLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let ce=C*180/Math.PI;ce=ce<0?ce+360:ce;let be=ce+this._startAngle;this._setAngle(be),this._rotationLayer.pm._setAngle(be),this._fireRotation(this._rotationLayer,ce,q),this._fireRotation(this._map,ce,q),this._rotationLayer.pm._fireChange(this._rotationLayer.getLatLngs(),"Rotation")},_onRotateEnd(){let a=this._startAngle;delete this._rotationOriginLatLng,delete this._rotationOriginPoint,delete this._rotationStartPoint,delete this._initialRotateLatLng,delete this._startAngle;let c=uo(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._rotationLayer.pm._rotateOrgLatLng=uo(this._rotationLayer),this._fireRotationEnd(this._rotationLayer,a,c),this._fireRotationEnd(this._map,a,c),this._rotationLayer.pm._fireEdit(this._rotationLayer,"Rotation"),this._preventRenderingMarkers(!1),this._layerRotated=!0},_rotateLayer(a,c,g,y,C){let M=Ze(C,g);return this._matrix=y.clone().rotate(a,M).flip(),Re(c,this._matrix,C)},_setAngle(a){a=a<0?a+360:a,this._angle=a%360},_getRotationCenter(){if(this._rotationCenter)return this._rotationCenter;let a=L.polygon(this._layer.getLatLngs(),{stroke:!1,fill:!1,pmIgnore:!0}).addTo(this._layer._map),c=a.getCenter();return a.removeFrom(this._layer._map),c},enableRotate(){if(!this.options.allowRotation){this.disableRotate();return}this.rotateEnabled()&&this.disableRotate(),this._layer instanceof L.Rectangle&&this._angle===void 0&&this.setInitAngle(Ao(this._layer._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);let a={fill:!1,stroke:!1,pmIgnore:!1,snapIgnore:!0};this._rotatePoly=L.polygon(this._layer.getLatLngs(),a),this._rotatePoly._pmTempLayer=!0,this._rotatePoly.addTo(this._layer._map),this._rotatePoly.pm._setAngle(this.getAngle()),this._rotatePoly.pm.setRotationCenter(this.getRotationCenter()),this._rotatePoly.pm.setOptions(this._layer._map.pm.getGlobalOptions()),this._rotatePoly.pm.setOptions({rotate:!0,snappable:!1,hideMiddleMarkers:!0}),this._rotatePoly.pm._rotationLayer=this._layer,this._rotatePoly.pm.enable(),this._rotateOrgLatLng=uo(this._layer),this._rotateEnabled=!0,this._layer.on("remove",this.disableRotate,this),this._fireRotationEnable(this._layer),this._fireRotationEnable(this._layer._map)},disableRotate(){this.rotateEnabled()&&(this._rotatePoly.pm._layerRotated&&this._fireUpdate(),this._rotatePoly.pm._layerRotated=!1,this._rotatePoly.pm.disable(),this._rotatePoly.remove(),this._rotatePoly.pm.setOptions({rotate:!1}),this._rotatePoly=void 0,this._rotateOrgLatLng=void 0,this._layer.off("remove",this.disableRotate,this),this._rotateEnabled=!1,this._fireRotationDisable(this._layer),this._fireRotationDisable(this._layer._map))},rotateEnabled(){return!!this._rotateEnabled},rotateLayer(a){let c=this.getAngle(),g=this._layer.getLatLngs(),y=a*(Math.PI/180);this._layer.setLatLngs(this._rotateLayer(y,this._layer.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._layer._map)),this._rotateOrgLatLng=L.polygon(this._layer.getLatLngs()).getLatLngs(),this._setAngle(this.getAngle()+a),this.rotateEnabled()&&this._rotatePoly&&this._rotatePoly.pm.enabled()&&(this._rotatePoly.setLatLngs(this._rotateLayer(y,this._rotatePoly.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._rotatePoly._map)),this._rotatePoly.pm._initMarkers());let C=this.getAngle()-c;C=C<0?C+360:C,this._startAngle=c,this._fireRotation(this._layer,C,g,this._layer),this._fireRotation(this._map||this._layer._map,C,g,this._layer),delete this._startAngle,this._fireChange(this._layer.getLatLngs(),"Rotation")},rotateLayerToAngle(a){let c=a-this.getAngle();this.rotateLayer(c)},getAngle(){return this._angle||0},setInitAngle(a){this._setAngle(a)},getRotationCenter(){return this._getRotationCenter()},setRotationCenter(a){this._rotationCenter=a,this._rotatePoly&&this._rotatePoly.pm.setRotationCenter(a)}},zt=Ft,Et=L.Class.extend({includes:[xe,to,zt,Ya],options:{snappable:!0,snapDistance:20,allowSelfIntersection:!0,allowSelfIntersectionEdit:!1,preventMarkerRemoval:!1,removeLayerBelowMinVertexCount:!0,limitMarkersToCount:-1,hideMiddleMarkers:!1,snapSegment:!0,syncLayersOnDrag:!1,draggable:!0,allowEditing:!0,allowRemoval:!0,allowCutting:!0,allowRotation:!0,addVertexOn:"click",removeVertexOn:"contextmenu",removeVertexValidation:void 0,addVertexValidation:void 0,moveVertexValidation:void 0,resizeableCircleMarker:!1,resizeableCircle:!0,snapMiddle:!1,snapVertex:!0},setOptions(a){L.Util.setOptions(this,a)},getOptions(){return this.options},applyOptions(){},isPolygon(){return this._layer instanceof L.Polygon},getShape(){return this._shape},_setPane(a,c){c==="layerPane"?a.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":c==="vertexPane"?a.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":c==="markerPane"&&(a.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},remove(){(this._map||this._layer._map).pm.removeLayer({target:this._layer})},_vertexValidation(a,c){let g=c.target,y={layer:this._layer,marker:g,event:c},C="";return a==="move"?C="moveVertexValidation":a==="add"?C="addVertexValidation":a==="remove"&&(C="removeVertexValidation"),this.options[C]&&typeof this.options[C]=="function"&&!this.options[C](y)?(a==="move"&&(g._cancelDragEventChain=g.getLatLng()),!1):(g._cancelDragEventChain=null,!0)},_vertexValidationDrag(a){return a._cancelDragEventChain?(a._latlng=a._cancelDragEventChain,a.update(),!1):!0},_vertexValidationDragEnd(a){return a._cancelDragEventChain?(a._cancelDragEventChain=null,!1):!0}}),Kt=Et;Kt.LayerGroup=L.Class.extend({initialize(a){this._layerGroup=a,this._layers=this.getLayers(),this._getMap(),this._layers.forEach(y=>this._initLayer(y));let c=y=>{if(y.layer._pmTempLayer)return;this._layers=this.getLayers();let C=this._layers.filter(M=>!M.pm._parentLayerGroup||!(this._layerGroup._leaflet_id in M.pm._parentLayerGroup));C.forEach(M=>{this._initLayer(M)}),C.length>0&&this._getMap()&&this._getMap().pm.globalEditModeEnabled()&&this.enabled()&&this.enable(this.getOptions())};this._layerGroup.on("layeradd",L.Util.throttle(c,100,this),this),this._layerGroup.on("layerremove",y=>{this._removeLayerFromGroup(y.target)},this);let g=y=>{y.target._pmTempLayer||(this._layers=this.getLayers())};this._layerGroup.on("layerremove",L.Util.throttle(g,100,this),this)},enable(a,c=[]){c.length===0&&(this._layers=this.getLayers()),this._options=a,this._layers.forEach(g=>{g instanceof L.LayerGroup?c.indexOf(g._leaflet_id)===-1&&(c.push(g._leaflet_id),g.pm.enable(a,c)):g.pm.enable(a)})},disable(a=[]){a.length===0&&(this._layers=this.getLayers()),this._layers.forEach(c=>{c instanceof L.LayerGroup?a.indexOf(c._leaflet_id)===-1&&(a.push(c._leaflet_id),c.pm.disable(a)):c.pm.disable()})},enabled(a=[]){return a.length===0&&(this._layers=this.getLayers()),!!this._layers.find(c=>c instanceof L.LayerGroup?a.indexOf(c._leaflet_id)===-1?(a.push(c._leaflet_id),c.pm.enabled(a)):!1:c.pm.enabled())},toggleEdit(a,c=[]){c.length===0&&(this._layers=this.getLayers()),this._options=a,this._layers.forEach(g=>{g instanceof L.LayerGroup?c.indexOf(g._leaflet_id)===-1&&(c.push(g._leaflet_id),g.pm.toggleEdit(a,c)):g.pm.toggleEdit(a)})},_initLayer(a){let c=L.Util.stamp(this._layerGroup);a.pm._parentLayerGroup||(a.pm._parentLayerGroup={}),a.pm._parentLayerGroup[c]=this._layerGroup},_removeLayerFromGroup(a){if(a.pm&&a.pm._layerGroup){let c=L.Util.stamp(this._layerGroup);delete a.pm._layerGroup[c]}},dragging(){return this._layers=this.getLayers(),this._layers?!!this._layers.find(a=>a.pm.dragging()):!1},getOptions(){return this.options},_getMap(){var a;return this._map||((a=this._layers.find(c=>!!c._map))==null?void 0:a._map)||null},getLayers(a=!1,c=!0,g=!0,y=[]){let C=[];return a?this._layerGroup.getLayers().forEach(M=>{C.push(M),M instanceof L.LayerGroup&&y.indexOf(M._leaflet_id)===-1&&(y.push(M._leaflet_id),C=C.concat(M.pm.getLayers(!0,!0,!0,y)))}):C=this._layerGroup.getLayers(),g&&(C=C.filter(M=>!(M instanceof L.LayerGroup))),c&&(C=C.filter(M=>!!M.pm),C=C.filter(M=>!M._pmTempLayer),C=C.filter(M=>!L.PM.optIn&&!M.options.pmIgnore||L.PM.optIn&&M.options.pmIgnore===!1)),C},setOptions(a,c=[]){c.length===0&&(this._layers=this.getLayers()),this.options=a,this._layers.forEach(g=>{g.pm&&(g instanceof L.LayerGroup?c.indexOf(g._leaflet_id)===-1&&(c.push(g._leaflet_id),g.pm.setOptions(a,c)):g.pm.setOptions(a))})}}),Kt.Marker=Kt.extend({_shape:"Marker",initialize(a){this._layer=a,this._enabled=!1,this._layer.on("dragend",this._onDragEnd,this)},enable(a={draggable:!0}){if(L.Util.setOptions(this,a),!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._fireEnable()},disable(){this.enabled()&&(this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this._layer.off("contextmenu",this._removeMarker,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1)},enabled(){return this._enabled},toggleEdit(a){this.enabled()?this.disable():this.enable(a)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this.options.draggable?this.enableLayerDrag():this.disableLayerDrag(),this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_removeMarker(a){let c=a.target;c.remove(),this._fireRemove(c),this._fireRemove(this._map,c)},_onDragEnd(){this._fireEdit(),this._layerEdited=!0},_initSnappableMarkers(){let a=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,a.off("pm:drag",this._handleSnapping,this),a.on("pm:drag",this._handleSnapping,this),a.off("pm:dragend",this._cleanupSnapping,this),a.on("pm:dragend",this._cleanupSnapping,this),a.off("pm:dragstart",this._unsnap,this),a.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let a=this._layer;a.off("pm:drag",this._handleSnapping,this),a.off("pm:dragend",this._cleanupSnapping,this),a.off("pm:dragstart",this._unsnap,this)}});var Vt=p(di()),vt={filterMarkerGroup(){this.markerCache=[],this.createCache(),this._layer.on("pm:edit",this.createCache,this),this.applyLimitFilters({}),this.throttledApplyLimitFilters||(this.throttledApplyLimitFilters=L.Util.throttle(this.applyLimitFilters,100,this)),this._layer.on("pm:disable",this._removeMarkerLimitEvents,this),this._layer.on("remove",this._removeMarkerLimitEvents,this),this.options.limitMarkersToCount>-1&&(this._layer.on("pm:vertexremoved",this._initMarkers,this),this._map.on("mousemove",this.throttledApplyLimitFilters,this))},_removeMarkerLimitEvents(){this._map.off("mousemove",this.throttledApplyLimitFilters,this),this._layer.off("pm:edit",this.createCache,this),this._layer.off("pm:disable",this._removeMarkerLimitEvents,this),this._layer.off("pm:vertexremoved",this._initMarkers,this)},createCache(){let a=[...this._markerGroup.getLayers(),...this.markerCache];this.markerCache=a.filter((c,g,y)=>y.indexOf(c)===g)},_removeFromCache(a){let c=this.markerCache.indexOf(a);c>-1&&this.markerCache.splice(c,1)},renderLimits(a){this.markerCache.forEach(c=>{a.includes(c)?this._markerGroup.addLayer(c):this._markerGroup.removeLayer(c)})},applyLimitFilters({latlng:a={lat:0,lng:0}}){if(this._preventRenderMarkers)return;let c=[...this._filterClosestMarkers(a)];this.renderLimits(c)},_filterClosestMarkers(a){let c=[...this.markerCache],g=this.options.limitMarkersToCount;return g===-1?c:(c.sort((y,C)=>{let M=y._latlng.distanceTo(a),z=C._latlng.distanceTo(a);return M-z}),c.filter((y,C)=>g>-1?C<g:!0))},_preventRenderMarkers:!1,_preventRenderingMarkers(a){this._preventRenderMarkers=!!a}},Lt=vt;Kt.Line=Kt.extend({includes:[Lt],_shape:"Line",initialize(a){this._layer=a,this._enabled=!1},enable(a){if(L.Util.setOptions(this,a),this._map=this._layer._map,!!this._map){if(!this.options.allowEditing){this.disable();return}this.enabled()&&this.disable(),this._enabled=!0,this._initMarkers(),this.applyOptions(),this._layer.on("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.on("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this),this.options.allowSelfIntersection?this.cachedColor=void 0:(this._layer.options.color!=="#f00000ff"?(this.cachedColor=this._layer.options.color,this.isRed=!1):this.isRed=!0,this._handleLayerStyle()),this._fireEnable()}},disable(){if(!this.enabled()||this._dragging)return;this._enabled=!1,this._markerGroup.clearLayers(),this._markerGroup.removeFrom(this._map),this._layer.off("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.off("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this);let a=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(a,"leaflet-pm-draggable"),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()},enabled(){return this._enabled},toggleEdit(a){return this.enabled()?this.disable():this.enable(a),this.enabled()},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initMarkers(){let a=this._map,c=this._layer.getLatLngs();this._markerGroup&&(this._markerGroup.removeFrom(a),this._markerGroup.clearLayers()),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0;let g=y=>{if(Array.isArray(y[0]))return y.map(g,this);let C=y.map(this._createMarker,this);return this.options.hideMiddleMarkers!==!0&&y.map((M,z)=>{let q=this.isPolygon()?(z+1)%y.length:z+1;return this._createMiddleMarker(C[z],C[q])}),C};this._markers=g(c),this.filterMarkerGroup(),a.addLayer(this._markerGroup)},_createMarker(a){let c=new L.Marker(a,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(c,"vertexPane"),c._pmTempLayer=!0,this.options.rotate?(c.on("dragstart",this._onRotateStart,this),c.on("drag",this._onRotate,this),c.on("dragend",this._onRotateEnd,this)):(c.on("click",this._onVertexClick,this),c.on("dragstart",this._onMarkerDragStart,this),c.on("move",this._onMarkerDrag,this),c.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||c.on(this.options.removeVertexOn,this._removeMarker,this)),this._markerGroup.addLayer(c),c},_createMiddleMarker(a,c){if(!a||!c)return!1;let g=L.PM.Utils.calcMiddleLatLng(this._map,a.getLatLng(),c.getLatLng()),y=this._createMarker(g),C=L.divIcon({className:"marker-icon marker-icon-middle"});return y.setIcon(C),y.leftM=a,y.rightM=c,a._middleMarkerNext=y,c._middleMarkerPrev=y,y.on(this.options.addVertexOn,this._onMiddleMarkerClick,this),y.on("movestart",this._onMiddleMarkerMoveStart,this),y},_onMiddleMarkerClick(a){let c=a.target;if(!this._vertexValidation("add",a))return;let g=L.divIcon({className:"marker-icon"});c.setIcon(g),this._addMarker(c,c.leftM,c.rightM)},_onMiddleMarkerMoveStart(a){let c=a.target;if(c.on("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidation("add",a)){c.on("move",this._onMiddleMarkerMovePrevent,this);return}c._dragging=!0,this._addMarker(c,c.leftM,c.rightM)},_onMiddleMarkerMovePrevent(a){let c=a.target;this._vertexValidationDrag(c)},_onMiddleMarkerMoveEnd(a){let c=a.target;if(c.off("move",this._onMiddleMarkerMovePrevent,this),c.off("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidationDragEnd(c))return;let g=L.divIcon({className:"marker-icon"});c.setIcon(g),setTimeout(()=>{delete c._dragging},100)},_addMarker(a,c,g){a.off("movestart",this._onMiddleMarkerMoveStart,this),a.off(this.options.addVertexOn,this._onMiddleMarkerClick,this);let y=a.getLatLng(),C=this._layer._latlngs;delete a.leftM,delete a.rightM;let{indexPath:M,index:z,parentPath:q}=L.PM.Utils.findDeepMarkerIndex(this._markers,c),ce=M.length>1?(0,Vt.default)(C,q):C,be=M.length>1?(0,Vt.default)(this._markers,q):this._markers;ce.splice(z+1,0,y),be.splice(z+1,0,a),this._layer.setLatLngs(C),this.options.hideMiddleMarkers!==!0&&(this._createMiddleMarker(c,a),this._createMiddleMarker(a,g)),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit"),this._fireVertexAdded(a,L.PM.Utils.findDeepMarkerIndex(this._markers,a).indexPath,y),this.options.snappable&&this._initSnappableMarkers()},hasSelfIntersection(){return ki(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersectionOnVertexRemoval(){this._handleLayerStyle(!0)&&(this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers())},_handleLayerStyle(a){let c=this._layer,g,y;if(this.options.allowSelfIntersection?g=!1:(y=ki(this._layer.toGeoJSON(15)),g=y.features.length>0),g){if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!0),this.isRed)return g;a?this._flashLayer():(c.setStyle({color:"#f00000ff"}),this.isRed=!0),this._fireIntersect(y)}else c.setStyle({color:this.cachedColor}),this.isRed=!1,!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!1);return g},_flashLayer(){this.cachedColor||(this.cachedColor=this._layer.options.color),this._layer.setStyle({color:"#f00000ff"}),this.isRed=!0,window.setTimeout(()=>{this._layer.setStyle({color:this.cachedColor}),this.isRed=!1},200)},_updateDisabledMarkerStyle(a,c){a.forEach(g=>{Array.isArray(g)?this._updateDisabledMarkerStyle(g,c):g._icon&&(c&&!this._checkMarkerAllowedToDrag(g)?L.DomUtil.addClass(g._icon,"vertexmarker-disabled"):L.DomUtil.removeClass(g._icon,"vertexmarker-disabled"))})},_removeMarker(a){let c=a.target;if(!this._vertexValidation("remove",a))return;this.options.allowSelfIntersection||(this._coordsBeforeEdit=uo(this._layer,this._layer.getLatLngs()));let g=this._layer.getLatLngs(),{indexPath:y,index:C,parentPath:M}=L.PM.Utils.findDeepMarkerIndex(this._markers,c);if(!y)return;let z=y.length>1?(0,Vt.default)(g,M):g,q=y.length>1?(0,Vt.default)(this._markers,M):this._markers,ce=M[M.length-1]>0&&this._layer instanceof L.Polygon;if(!this.options.removeLayerBelowMinVertexCount&&!ce&&(z.length<=2||this.isPolygon()&&z.length<=3)){this._flashLayer();return}z.splice(C,1),this._layer.setLatLngs(g),this.isPolygon()&&z.length<=2&&z.splice(0,z.length);let be=!1;if(z.length<=1&&(z.splice(0,z.length),M.length>1&&y.length>1&&(g=Ta(g)),this._layer.setLatLngs(g),this._initMarkers(),be=!0),Gr(g)||this._layer.remove(),g=Ta(g),this._layer.setLatLngs(g),this._markers=Ta(this._markers),!be&&(q=y.length>1?(0,Vt.default)(this._markers,M):this._markers,c._middleMarkerPrev&&(this._markerGroup.removeLayer(c._middleMarkerPrev),this._removeFromCache(c._middleMarkerPrev)),c._middleMarkerNext&&(this._markerGroup.removeLayer(c._middleMarkerNext),this._removeFromCache(c._middleMarkerNext)),this._markerGroup.removeLayer(c),this._removeFromCache(c),q)){let Xe,He;if(this.isPolygon()?(Xe=(C+1)%q.length,He=(C+(q.length-1))%q.length):(He=C-1<0?void 0:C-1,Xe=C+1>=q.length?void 0:C+1),Xe!==He){let xt=q[He],Ot=q[Xe];this.options.hideMiddleMarkers!==!0&&this._createMiddleMarker(xt,Ot)}q.splice(C,1)}this._fireEdit(),this._layerEdited=!0,this._fireVertexRemoved(c,y),this._fireChange(this._layer.getLatLngs(),"Edit")},updatePolygonCoordsFromMarkerDrag(a){let c=this._layer.getLatLngs(),g=a.getLatLng(),{indexPath:y,index:C,parentPath:M}=L.PM.Utils.findDeepMarkerIndex(this._markers,a);(y.length>1?(0,Vt.default)(c,M):c).splice(C,1,g),this._layer.setLatLngs(c)},_getNeighborMarkers(a){let{indexPath:c,index:g,parentPath:y}=L.PM.Utils.findDeepMarkerIndex(this._markers,a),C=c.length>1?(0,Vt.default)(this._markers,y):this._markers,M=(g+1)%C.length,z=(g+(C.length-1))%C.length,q=C[z],ce=C[M];return{prevMarker:q,nextMarker:ce}},_checkMarkerAllowedToDrag(a){let{prevMarker:c,nextMarker:g}=this._getNeighborMarkers(a),y=L.polyline([c.getLatLng(),a.getLatLng()]),C=L.polyline([a.getLatLng(),g.getLatLng()]),M=Us(this._layer.toGeoJSON(15),y.toGeoJSON(15)).features.length,z=Us(this._layer.toGeoJSON(15),C.toGeoJSON(15)).features.length;return a.getLatLng()===this._markers[0][0].getLatLng()?z+=1:a.getLatLng()===this._markers[0][this._markers[0].length-1].getLatLng()&&(M+=1),!(M<=2&&z<=2)},_onMarkerDragStart(a){let c=a.target;if(this.cachedColor||(this.cachedColor=this._layer.options.color),!this._vertexValidation("move",a))return;let{indexPath:g}=L.PM.Utils.findDeepMarkerIndex(this._markers,c);this._fireMarkerDragStart(a,g),this.options.allowSelfIntersection||(this._coordsBeforeEdit=uo(this._layer,this._layer.getLatLngs())),!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()?this._markerAllowedToDrag=this._checkMarkerAllowedToDrag(c):this._markerAllowedToDrag=null},_onMarkerDrag(a){let c=a.target;if(!this._vertexValidationDrag(c))return;let{indexPath:g,index:y,parentPath:C}=L.PM.Utils.findDeepMarkerIndex(this._markers,c);if(!g)return;if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()&&this._markerAllowedToDrag===!1){this._layer.setLatLngs(this._coordsBeforeEdit),this._initMarkers(),this._handleLayerStyle();return}this.updatePolygonCoordsFromMarkerDrag(c);let M=g.length>1?(0,Vt.default)(this._markers,C):this._markers,z=(y+1)%M.length,q=(y+(M.length-1))%M.length,ce=c.getLatLng(),be=M[q].getLatLng(),Xe=M[z].getLatLng();if(c._middleMarkerNext){let He=L.PM.Utils.calcMiddleLatLng(this._map,ce,Xe);c._middleMarkerNext.setLatLng(He)}if(c._middleMarkerPrev){let He=L.PM.Utils.calcMiddleLatLng(this._map,ce,be);c._middleMarkerPrev.setLatLng(He)}this.options.allowSelfIntersection||this._handleLayerStyle(),this._fireMarkerDrag(a,g),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(a){let c=a.target;if(!this._vertexValidationDragEnd(c))return;let{indexPath:g}=L.PM.Utils.findDeepMarkerIndex(this._markers,c),y=!this.options.allowSelfIntersection&&this.hasSelfIntersection();y&&this.options.allowSelfIntersectionEdit&&this._markerAllowedToDrag&&(y=!1);let C=!this.options.allowSelfIntersection&&y;if(this._fireMarkerDragEnd(a,g,C),C){this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers(),this.options.snappable&&this._initSnappableMarkers(),this._handleLayerStyle(),this._fireLayerReset(a,g);return}!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._handleLayerStyle(),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_onVertexClick(a){let c=a.target;if(c._dragging)return;let{indexPath:g}=L.PM.Utils.findDeepMarkerIndex(this._markers,c);this._fireVertexClick(a,g)}}),Kt.Polygon=Kt.Line.extend({_shape:"Polygon",_checkMarkerAllowedToDrag(a){let{prevMarker:c,nextMarker:g}=this._getNeighborMarkers(a),y=L.polyline([c.getLatLng(),a.getLatLng()]),C=L.polyline([a.getLatLng(),g.getLatLng()]),M=Us(this._layer.toGeoJSON(15),y.toGeoJSON(15)).features.length,z=Us(this._layer.toGeoJSON(15),C.toGeoJSON(15)).features.length;return!(M<=2&&z<=2)}}),Kt.Rectangle=Kt.Polygon.extend({_shape:"Rectangle",_initMarkers(){let a=this._map,c=this._findCorners();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0,a.addLayer(this._markerGroup),this._markers=[],this._markers[0]=c.map(this._createMarker,this),[this._cornerMarkers]=this._markers,this._layer.getLatLngs()[0].forEach((g,y)=>{let C=this._cornerMarkers.find(M=>M._index===y);C&&C.setLatLng(g)})},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this._addMarkerEvents()},_createMarker(a,c){let g=new L.Marker(a,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(g,"vertexPane"),g._origLatLng=a,g._index=c,g._pmTempLayer=!0,g.on("click",this._onVertexClick,this),this._markerGroup.addLayer(g),g},_addMarkerEvents(){this._markers[0].forEach(a=>{a.on("dragstart",this._onMarkerDragStart,this),a.on("drag",this._onMarkerDrag,this),a.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||a.on("contextmenu",this._removeMarker,this)})},_removeMarker(){return null},_onMarkerDragStart(a){if(!this._vertexValidation("move",a))return;let c=a.target,g=this._cornerMarkers;c._oppositeCornerLatLng=g.find(C=>C._index===(c._index+2)%4).getLatLng(),c._snapped=!1;let{indexPath:y}=L.PM.Utils.findDeepMarkerIndex(this._markers,c);this._fireMarkerDragStart(a,y)},_onMarkerDrag(a){let c=a.target;if(!this._vertexValidationDrag(c)||c._index===void 0)return;this._adjustRectangleForMarkerMove(c);let{indexPath:g}=L.PM.Utils.findDeepMarkerIndex(this._markers,c);this._fireMarkerDrag(a,g),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(a){let c=a.target;if(!this._vertexValidationDragEnd(c))return;this._cornerMarkers.forEach(y=>{delete y._oppositeCornerLatLng});let{indexPath:g}=L.PM.Utils.findDeepMarkerIndex(this._markers,c);this._fireMarkerDragEnd(a,g),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_adjustRectangleForMarkerMove(a){L.extend(a._origLatLng,a._latlng);let c=L.PM.Utils._getRotatedRectangle(a.getLatLng(),a._oppositeCornerLatLng,this.getAngle(),this._map);this._layer.setLatLngs(c),this._adjustAllMarkers(a),this._layer.redraw()},_adjustAllMarkers(a){let c=this._layer.getLatLngs()[0];if(c&&c.length!==4&&c.length>0)c.forEach((g,y)=>{this._cornerMarkers[y].setLatLng(g)}),this._cornerMarkers.slice(c.length).forEach(g=>{g.setLatLng(c[0])});else if(!c||!c.length)console.error("The layer has no LatLngs");else{let g=c.findIndex(y=>a.getLatLng().equals(y));g>-1?(this._cornerMarkers[(a._index+1)%4].setLatLng(c[(g+1)%4]),this._cornerMarkers[(a._index+2)%4].setLatLng(c[(g+2)%4]),this._cornerMarkers[(a._index+3)%4].setLatLng(c[(g+3)%4])):this._cornerMarkers.forEach(y=>{y.setLatLng(c[y._index])})}},_findCorners(){this._angle===void 0&&this.setInitAngle(Ao(this._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);let a=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(a[0],a[2],this.getAngle(),this._map||this)}}),Kt.CircleMarker=Kt.extend({_shape:"CircleMarker",initialize(a){this._layer=a,this._enabled=!1,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._updateHiddenPolyCircle()},enable(a={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,a),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._extendingEnable(),this._updateHiddenPolyCircle(),this._fireEnable()},_extendingEnable(){this._layer.on("pm:dragstart",this._onDragStart,this),this._layer.on("pm:drag",this._onMarkerDrag,this),this._layer.on("pm:dragend",this._onMarkerDragEnd,this)},disable(){this.dragging()||(this._map||(this._map=this._layer._map),this._map&&this.enabled()&&(this.layerDragEnabled()&&this.disableLayerDrag(),this._helperLayers&&(this._helperLayers.clearLayers(),this._helperLayers.removeFrom(this._map)),this.options[this._editableOption]?(this._map.off("move",this._syncMarkers,this),this._outerMarker.off("drag",this._handleOuterMarkerSnapping,this)):this._map.off("move",this._updateHiddenPolyCircle,this),this._extendingDisable(),this._layer.off("remove",this.disable,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1))},_extendingDisable(){this._layer.off("contextmenu",this._removeMarker,this)},enabled(){return this._enabled},toggleEdit(a){this.enabled()?this.disable():this.enable(a)},applyOptions(){this.options[this._editableOption]?(this._initMarkers(),this._map.on("move",this._syncMarkers,this),this.options.snappable?(this._initSnappableMarkers(),this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this),this._outerMarker.on("move",this._syncHintLine,this),this._outerMarker.on("move",this._syncCircleRadius,this)):this._disableSnapping()):(this.options.draggable&&this.enableLayerDrag(),this._map.on("move",this._updateHiddenPolyCircle,this),this.options.snappable?this._initSnappableMarkersDrag():this._disableSnappingDrag()),this._extendingApplyOptions()},_extendingApplyOptions(){this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_initMarkers(){let a=this._map;this._helperLayers&&(this._helperLayers.removeFrom(a),this._helperLayers.clearLayers()),this._helperLayers=new L.FeatureGroup,this._helperLayers._pmTempLayer=!0,this._helperLayers.addTo(a);let c=this._layer.getLatLng(),g=this._layer._radius,y=this._getLatLngOnCircle(c,g);this._centerMarker=this._createCenterMarker(c),this._outerMarker=this._createOuterMarker(y),this._markers=[this._centerMarker,this._outerMarker],this._createHintLine(this._centerMarker,this._outerMarker)},_getLatLngOnCircle(a,c){let g=this._map.project(a),y=L.point(g.x+c,g.y);return this._map.unproject(y)},_createHintLine(a,c){let g=a.getLatLng(),y=c.getLatLng();this._hintline=L.polyline([g,y],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._helperLayers.addLayer(this._hintline)},_createCenterMarker(a){let c=this._createMarker(a);return this.options.draggable?(L.DomUtil.addClass(c._icon,"leaflet-pm-draggable"),c.on("move",this._moveCircle,this)):c.dragging.disable(),c},_createOuterMarker(a){let c=this._createMarker(a);return c.on("drag",this._resizeCircle,this),c},_createMarker(a){let c=new L.Marker(a,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(c,"vertexPane"),c._origLatLng=a,c._pmTempLayer=!0,c.on("dragstart",this._onMarkerDragStart,this),c.on("drag",this._onMarkerDrag,this),c.on("dragend",this._onMarkerDragEnd,this),c.on("click",this._onVertexClick,this),this._helperLayers.addLayer(c),c},_moveCircle(a){if(a.target._cancelDragEventChain)return;let c=this._centerMarker.getLatLng();this._layer.setLatLng(c);let g=this._layer._radius,y=this._getLatLngOnCircle(c,g);this._outerMarker._latlng=y,this._outerMarker.update(),this._syncHintLine(),this._updateHiddenPolyCircle(),this._fireCenterPlaced("Edit"),this._fireChange(this._layer.getLatLng(),"Edit")},_syncMarkers(){let a=this._layer.getLatLng(),c=this._layer._radius,g=this._getLatLngOnCircle(a,c);this._outerMarker.setLatLng(g),this._centerMarker.setLatLng(a),this._syncHintLine(),this._updateHiddenPolyCircle()},_resizeCircle(){this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker()),this._syncHintLine(),this._syncCircleRadius()},_syncCircleRadius(){let a=this._centerMarker.getLatLng(),c=this._outerMarker.getLatLng(),g=this._distanceCalculation(a,c);this.options[this._minRadiusOption]&&g<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&g>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(g),this._updateHiddenPolyCircle(),this._fireChange(this._layer.getLatLng(),"Edit")},_syncHintLine(){let a=this._centerMarker.getLatLng(),c=this._outerMarker.getLatLng();this._hintline.setLatLngs([a,c])},_removeMarker(){this.options[this._editableOption]&&this.disable(),this._layer.remove(),this._fireRemove(this._layer),this._fireRemove(this._map,this._layer)},_onDragStart(){this._map.pm.Draw.CircleMarker._layerIsDragging=!0},_onMarkerDragStart(a){this._vertexValidation("move",a)&&this._fireMarkerDragStart(a)},_onMarkerDrag(a){let c=a.target;c instanceof L.Marker&&!this._vertexValidationDrag(c)||this._fireMarkerDrag(a)},_onMarkerDragEnd(a){this._extedingMarkerDragEnd();let c=a.target;this._vertexValidationDragEnd(c)&&(this.options[this._editableOption]&&(this._fireEdit(),this._layerEdited=!0),this._fireMarkerDragEnd(a))},_extedingMarkerDragEnd(){this._map.pm.Draw.CircleMarker._layerIsDragging=!1},_initSnappableMarkersDrag(){let a=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,a.off("pm:drag",this._handleSnapping,this),a.on("pm:drag",this._handleSnapping,this),a.off("pm:dragend",this._cleanupSnapping,this),a.on("pm:dragend",this._cleanupSnapping,this),a.off("pm:dragstart",this._unsnap,this),a.on("pm:dragstart",this._unsnap,this)},_disableSnappingDrag(){let a=this._layer;a.off("pm:drag",this._handleSnapping,this),a.off("pm:dragend",this._cleanupSnapping,this),a.off("pm:dragstart",this._unsnap,this)},_updateHiddenPolyCircle(){let a=this._layer._map||this._map;if(a){let c=L.PM.Utils.pxRadiusToMeterRadius(this._layer.getRadius(),a,this._layer.getLatLng()),g=L.circle(this._layer.getLatLng(),this._layer.options);g.setRadius(c);let y=a&&a.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(g,200,!y).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(g,200,!y),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)}},_getNewDestinationOfOuterMarker(){let a=this._centerMarker.getLatLng(),c=this._outerMarker.getLatLng(),g=this._distanceCalculation(a,c);return this.options[this._minRadiusOption]&&g<this.options[this._minRadiusOption]?c=Xa(this._map,a,c,this._getMinDistanceInMeter(a)):this.options[this._maxRadiusOption]&&g>this.options[this._maxRadiusOption]&&(c=Xa(this._map,a,c,this._getMaxDistanceInMeter(a))),c},_handleOuterMarkerSnapping(){if(this._outerMarker._snapped){let a=this._centerMarker.getLatLng(),c=this._outerMarker.getLatLng(),g=this._distanceCalculation(a,c);this.options[this._minRadiusOption]&&g<this.options[this._minRadiusOption]?this._outerMarker.setLatLng(this._outerMarker._orgLatLng):this.options[this._maxRadiusOption]&&g>this.options[this._maxRadiusOption]&&this._outerMarker.setLatLng(this._outerMarker._orgLatLng)}this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker())},_distanceCalculation(a,c){return this._map.project(a).distanceTo(this._map.project(c))},_getMinDistanceInMeter(a){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,a)},_getMaxDistanceInMeter(a){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,a)},_onVertexClick(a){a.target._dragging||this._fireVertexClick(a,void 0)}}),Kt.Circle=Kt.CircleMarker.extend({_shape:"Circle",initialize(a){this._layer=a,this._enabled=!1,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizeableCircle",this._updateHiddenPolyCircle()},enable(a){L.PM.Edit.CircleMarker.prototype.enable.call(this,a||{})},_extendingEnable(){},_extendingDisable(){this._layer.off("remove",this.disable,this);let a=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(a,"leaflet-pm-draggable")},_extendingApplyOptions(){},_syncMarkers(){},_removeMarker(){},_onDragStart(){},_extedingMarkerDragEnd(){},_updateHiddenPolyCircle(){let a=this._map&&this._map.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(this._layer,200,!a).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(this._layer,200,!a),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)},_distanceCalculation(a,c){return this._map.distance(a,c)},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_onVertexClick(a){a.target._dragging||this._fireVertexClick(a,void 0)}}),Kt.ImageOverlay=Kt.extend({_shape:"ImageOverlay",initialize(a){this._layer=a,this._enabled=!1},toggleEdit(a){this.enabled()?this.disable():this.enable(a)},enabled(){return this._enabled},enable(a={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,a),this._map=this._layer._map,!!this._map){if(!this.options.allowEditing){this.disable();return}this.enabled()||this.disable(),this.enableLayerDrag(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._otherSnapLayers=this._findCorners(),this._fireEnable()}},disable(){this._dragging||(this._map||(this._map=this._layer._map),this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this.enabled()||(this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()),this._enabled=!1)},_findCorners(){let a=this._layer.getBounds(),c=a.getNorthWest(),g=a.getNorthEast(),y=a.getSouthEast(),C=a.getSouthWest();return[c,g,y,C]}}),Kt.Text=Kt.extend({_shape:"Text",initialize(a){this._layer=a,this._enabled=!1},enable(a){if(L.Util.setOptions(this,a),!!this.textArea){if(!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._safeToCacheDragState=!0,this._focusChange(),this.textArea.readOnly=!1,this.textArea.classList.remove("pm-disabled"),this._layer.on("remove",this.disable,this),L.DomEvent.on(this.textArea,"input",this._autoResize,this),L.DomEvent.on(this.textArea,"focus",this._focusChange,this),L.DomEvent.on(this.textArea,"blur",this._focusChange,this),this._layer.on("dblclick",L.DomEvent.stop),L.DomEvent.off(this.textArea,"mousedown",this._preventTextSelection),this._enabled=!0,this._fireEnable()}},disable(){if(!this.enabled())return;this._layer.off("remove",this.disable,this),L.DomEvent.off(this.textArea,"input",this._autoResize,this),L.DomEvent.off(this.textArea,"focus",this._focusChange,this),L.DomEvent.off(this.textArea,"blur",this._focusChange,this),L.DomEvent.off(document,"click",this._documentClick,this),this._focusChange(),this.textArea.readOnly=!0,this.textArea.classList.add("pm-disabled");let a=document.activeElement;this.textArea.focus(),this.textArea.selectionStart=0,this.textArea.selectionEnd=0,L.DomEvent.on(this.textArea,"mousedown",this._preventTextSelection),a.focus(),this._disableOnBlurActive=!1,this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1},enabled(){return this._enabled},toggleEdit(a){this.enabled()?this.disable():this.enable(a)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initSnappableMarkers(){let a=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,a.off("pm:drag",this._handleSnapping,this),a.on("pm:drag",this._handleSnapping,this),a.off("pm:dragend",this._cleanupSnapping,this),a.on("pm:dragend",this._cleanupSnapping,this),a.off("pm:dragstart",this._unsnap,this),a.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let a=this._layer;a.off("pm:drag",this._handleSnapping,this),a.off("pm:dragend",this._cleanupSnapping,this),a.off("pm:dragstart",this._unsnap,this)},_autoResize(){this.textArea.style.height="1px",this.textArea.style.width="1px";let a=this.textArea.scrollHeight>21?this.textArea.scrollHeight:21,c=this.textArea.scrollWidth>16?this.textArea.scrollWidth:16;this.textArea.style.height=`${a}px`,this.textArea.style.width=`${c}px`,this._layer.options.text=this.getText(),this._fireTextChange(this.getText())},_disableOnBlur(){this._disableOnBlurActive=!0,setTimeout(()=>{this.enabled()&&L.DomEvent.on(document,"click",this._documentClick,this)},100)},_documentClick(a){a.target!==this.textArea&&(this.disable(),!this.getText()&&this.options.removeIfEmpty&&this.remove())},_focusChange(a={}){let c=this._hasFocus;this._hasFocus=a.type==="focus",!c!=!this._hasFocus&&(this._hasFocus?(this._applyFocus(),this._focusText=this.getText(),this._fireTextFocus()):(this._removeFocus(),this._fireTextBlur(),this._focusText!==this.getText()&&(this._fireEdit(),this._layerEdited=!0)))},_applyFocus(){this.textArea.classList.add("pm-hasfocus"),this._map.dragging&&(this._safeToCacheDragState&&(this._originalMapDragState=this._map.dragging._enabled,this._safeToCacheDragState=!1),this._map.dragging.disable())},_removeFocus(){this._map.dragging&&(this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0),this.textArea.classList.remove("pm-hasfocus")},focus(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.focus()},blur(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.blur(),this._disableOnBlurActive&&this.disable()},hasFocus(){return this._hasFocus},getElement(){return this.textArea},setText(a){a&&(this.textArea.value=a),this._autoResize()},getText(){return this.textArea.value},_initTextMarker(){if(this.textArea=L.PM.Draw.Text.prototype._createTextArea.call(this),this.options.className){let c=this.options.className.split(" ");this.textArea.classList.add(...c)}let a=L.PM.Draw.Text.prototype._createTextIcon.call(this,this.textArea);this._layer.setIcon(a),this._layer.once("add",this._createTextMarker,this)},_createTextMarker(a=!1){this._layer.off("add",this._createTextMarker,this),this._layer.getElement().tabIndex=-1,this.textArea.wrap="off",this.textArea.style.overflow="hidden",this.textArea.style.height=L.DomUtil.getStyle(this.textArea,"font-size"),this.textArea.style.width="1px",this._layer.options.text&&this.setText(this._layer.options.text),this._autoResize(),a===!0&&(this.enable(),this.focus(),this._disableOnBlur())},_preventTextSelection(a){a.preventDefault()}});var tn=function(a,c,g,y,C,M){this._matrix=[a,c,g,y,C,M]};tn.init=()=>new L.PM.Matrix(1,0,0,1,0,0),tn.prototype={transform(a){return this._transform(a.clone())},_transform(a){let c=this._matrix,{x:g,y}=a;return a.x=c[0]*g+c[1]*y+c[4],a.y=c[2]*g+c[3]*y+c[5],a},untransform(a){let c=this._matrix;return new L.Point((a.x/c[0]-c[4])/c[0],(a.y/c[2]-c[5])/c[2])},clone(){let a=this._matrix;return new L.PM.Matrix(a[0],a[1],a[2],a[3],a[4],a[5])},translate(a){if(a===void 0)return new L.Point(this._matrix[4],this._matrix[5]);let c,g;return typeof a=="number"?(c=a,g=a):(c=a.x,g=a.y),this._add(1,0,0,1,c,g)},scale(a,c){if(a===void 0)return new L.Point(this._matrix[0],this._matrix[3]);let g,y;return c=c||L.point(0,0),typeof a=="number"?(g=a,y=a):(g=a.x,y=a.y),this._add(g,0,0,y,c.x,c.y)._add(1,0,0,1,-c.x,-c.y)},rotate(a,c){let g=Math.cos(a),y=Math.sin(a);return c=c||new L.Point(0,0),this._add(g,y,-y,g,c.x,c.y)._add(1,0,0,1,-c.x,-c.y)},flip(){return this._matrix[1]*=-1,this._matrix[2]*=-1,this},_add(a,c,g,y,C,M){let z=[[],[],[]],q=this._matrix,ce=[[q[0],q[2],q[4]],[q[1],q[3],q[5]],[0,0,1]],be=[[a,g,C],[c,y,M],[0,0,1]],Xe;a&&a instanceof L.PM.Matrix&&(q=a._matrix,be=[[q[0],q[2],q[4]],[q[1],q[3],q[5]],[0,0,1]]);for(let He=0;He<3;He+=1)for(let xt=0;xt<3;xt+=1){Xe=0;for(let Ot=0;Ot<3;Ot+=1)Xe+=ce[He][Ot]*be[Ot][xt];z[He][xt]=Xe}return this._matrix=[z[0][0],z[1][0],z[0][1],z[1][1],z[0][2],z[1][2]],this}};var fn=tn,sn={calcMiddleLatLng(a,c,g){let y=a.project(c),C=a.project(g);return a.unproject(y._add(C)._divideBy(2))},findLayers(a){let c=[];return a.eachLayer(g=>{(g instanceof L.Polyline||g instanceof L.Marker||g instanceof L.Circle||g instanceof L.CircleMarker||g instanceof L.ImageOverlay)&&c.push(g)}),c=c.filter(g=>!!g.pm),c=c.filter(g=>!g._pmTempLayer),c=c.filter(g=>!L.PM.optIn&&!g.options.pmIgnore||L.PM.optIn&&g.options.pmIgnore===!1),c},circleToPolygon(a,c=60,g=!0){let y=a.getLatLng(),C=a.getRadius(),M=Ar(y,C,c,0,g),z=[];for(let q=0;q<M.length;q+=1){let ce=[M[q].lat,M[q].lng];z.push(ce)}return L.polygon(z,a.options)},disablePopup(a){a.getPopup()&&(a._tempPopupCopy=a.getPopup(),a.unbindPopup())},enablePopup(a){a._tempPopupCopy&&(a.bindPopup(a._tempPopupCopy),delete a._tempPopupCopy)},_fireEvent(a,c,g,y=!1){a.fire(c,g,y);let{groups:C}=this.getAllParentGroups(a);C.forEach(M=>{M.fire(c,g,y)})},getAllParentGroups(a){let c=[],g=[],y=C=>{for(let M in C._eventParents)if(c.indexOf(M)===-1){c.push(M);let z=C._eventParents[M];g.push(z),y(z)}};return!a._pmLastGroupFetch||!a._pmLastGroupFetch.time||new Date().getTime()-a._pmLastGroupFetch.time>1e3?(y(a),a._pmLastGroupFetch={time:new Date().getTime(),groups:g,groupIds:c},{groupIds:c,groups:g}):{groups:a._pmLastGroupFetch.groups,groupIds:a._pmLastGroupFetch.groupIds}},createGeodesicPolygon:Ar,getTranslation:Qn,findDeepCoordIndex(a,c,g=!0){let y,C=z=>(q,ce)=>{let be=z.concat(ce);if(g){if(q.lat&&q.lat===c.lat&&q.lng===c.lng)return y=be,!0}else if(q.lat&&L.latLng(q).equals(c))return y=be,!0;return Array.isArray(q)&&q.some(C(be))};a.some(C([]));let M={};return y&&(M={indexPath:y,index:y[y.length-1],parentPath:y.slice(0,y.length-1)}),M},findDeepMarkerIndex(a,c){let g,y=M=>(z,q)=>{let ce=M.concat(q);return z._leaflet_id===c._leaflet_id?(g=ce,!0):Array.isArray(z)&&z.some(y(ce))};a.some(y([]));let C={};return g&&(C={indexPath:g,index:g[g.length-1],parentPath:g.slice(0,g.length-1)}),C},_getIndexFromSegment(a,c){if(c&&c.length===2){let g=this.findDeepCoordIndex(a,c[0]),y=this.findDeepCoordIndex(a,c[1]),C=Math.max(g.index,y.index);return(g.index===0||y.index===0)&&C!==1&&(C+=1),{indexA:g,indexB:y,newIndex:C,indexPath:g.indexPath,parentPath:g.parentPath}}return null},_getRotatedRectangle(a,c,g,y){let C=Ze(y,a),M=Ze(y,c),z=g*Math.PI/180,q=Math.cos(z),ce=Math.sin(z),be=(M.x-C.x)*q+(M.y-C.y)*ce,Xe=(M.y-C.y)*q-(M.x-C.x)*ce,He=be*q+C.x,xt=be*ce+C.y,Ot=-Xe*ce+C.x,en=Xe*q+C.y,bn=mt(y,C),Pn=mt(y,{x:He,y:xt}),ti=mt(y,M),Ye=mt(y,{x:Ot,y:en});return[bn,Pn,ti,Ye]},pxRadiusToMeterRadius(a,c,g){let y=c.project(g),C=L.point(y.x+a,y.y);return c.distance(c.unproject(C),g)}},Tn=sn;L.PM=L.PM||{version:ao.version,Map:ls,Toolbar:Ba,Draw:Vr,Edit:Kt,Utils:Tn,Matrix:fn,activeLang:"en",optIn:!1,initialize(a){this.addInitHooks(a)},setOptIn(a){this.optIn=!!a},addInitHooks(){function a(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Map(this)):this.options.pmIgnore||(this.pm=new L.PM.Map(this)),this.pm&&this.pm.setGlobalOptions({})}L.Map.addInitHook(a);function c(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.LayerGroup(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.LayerGroup(this))}L.LayerGroup.addInitHook(c);function g(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this)):this.options.pmIgnore||(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this))}L.Marker.addInitHook(g);function y(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.CircleMarker(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.CircleMarker(this))}L.CircleMarker.addInitHook(y);function C(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Line(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Line(this))}L.Polyline.addInitHook(C);function M(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Polygon(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Polygon(this))}L.Polygon.addInitHook(M);function z(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Rectangle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Rectangle(this))}L.Rectangle.addInitHook(z);function q(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Circle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Circle(this))}L.Circle.addInitHook(q);function ce(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.ImageOverlay(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.ImageOverlay(this))}L.ImageOverlay.addInitHook(ce)},reInitLayer(a){a instanceof L.LayerGroup&&a.eachLayer(c=>{this.reInitLayer(c)}),a.pm||L.PM.optIn&&a.options.pmIgnore!==!1||a.options.pmIgnore||(a instanceof L.Map?a.pm=new L.PM.Map(a):a instanceof L.Marker?a.options.textMarker?(a.pm=new L.PM.Edit.Text(a),a.pm._initTextMarker(),a.pm._createTextMarker(!1)):a.pm=new L.PM.Edit.Marker(a):a instanceof L.Circle?a.pm=new L.PM.Edit.Circle(a):a instanceof L.CircleMarker?a.pm=new L.PM.Edit.CircleMarker(a):a instanceof L.Rectangle?a.pm=new L.PM.Edit.Rectangle(a):a instanceof L.Polygon?a.pm=new L.PM.Edit.Polygon(a):a instanceof L.Polyline?a.pm=new L.PM.Edit.Line(a):a instanceof L.LayerGroup?a.pm=new L.PM.Edit.LayerGroup(a):a instanceof L.ImageOverlay&&(a.pm=new L.PM.Edit.ImageOverlay(a)))}},L.version==="1.7.1"&&L.Canvas.include({_onClick(a){let c=this._map.mouseEventToLayerPoint(a),g,y;for(let C=this._drawFirst;C;C=C.next)g=C.layer,g.options.interactive&&g._containsPoint(c)&&(!(a.type==="click"||a.type==="preclick")||!this._map._draggableMoved(g))&&(y=g);y&&(L.DomEvent.fakeStop(a),this._fireEvent([y],a))}}),L.PM.initialize()})();class Lu extends gn.Polygon{constructor(t,i,r=0,o=180,l={}){super([[]],{...l,pmIgnore:!1,interactive:!0,className:"leaflet-semicircle"});Mt(this,"center");Mt(this,"radius");Mt(this,"startAngle");Mt(this,"stopAngle");Mt(this,"numPoints");Mt(this,"properties");Mt(this,"pm");Mt(this,"getRadius",()=>this.radius);Mt(this,"getStartAngle",()=>this.startAngle);Mt(this,"getStopAngle",()=>this.stopAngle);this.center=t,this.radius=i,this.startAngle=this.normalizeAngle(r),this.stopAngle=this.normalizeAngle(o),this.numPoints=64,this.properties=At.measure("CircleArc.constructor.initProperties",()=>({type:"Semicircle",radius:this.radius,startAngle:this.startAngle,stopAngle:this.stopAngle,style:{...l,startAngle:this.startAngle,stopAngle:this.stopAngle,name:l.name||""}})),this.on("pm:enable",()=>{var h;this.pm&&(this.pm._layers=[],this.pm._markers=[],(h=this.pm._markerGroup)==null||h.clearLayers())}),this.on("pm:vertexadded",()=>{var h;this.pm&&((h=this.pm._markerGroup)==null||h.clearLayers())}),this.on("add",()=>{this._map&&(this.updateGeometry(),this.pm&&this.pm.enable({allowSelfIntersection:!1,preventMarkerRemoval:!0}))}),this.updateProperties()}normalizeAngle(t){return At.measure("CircleArc.normalizeAngle",()=>(t%360+360)%360)}calculateArcPoints(){return At.measure("CircleArc.calculateArcPoints",()=>{if(!this._map)return[];const t=[],i=this.getOpeningAngle();t.push(this.center);for(let r=0;r<=this.numPoints;r++){const l=(this.startAngle+i*r/this.numPoints)*Math.PI/180,h=this.radius*Math.cos(l),m=this.radius*Math.sin(l)/111319.9,_=h/(111319.9*Math.cos(this.center.lat*Math.PI/180)),w=gn.latLng(this.center.lat+m,this.center.lng+_);t.push(w)}return t.push(this.center),t})}setRadius(t){return At.measure("CircleArc.setRadius",()=>t<=0?this:(this.radius=t,this.properties.radius=t,this.updateGeometry(),this.updateProperties(),this))}setAngles(t,i){return At.measure("CircleArc.setAngles",()=>{const r=this.normalizeAngle(t),o=this.normalizeAngle(i),l=this.getOpeningAngle();let h=(o-r+360)%360;const p=45;return Math.abs(h-l)>p&&(h>l?h=l+p:h=l-p),h=Math.max(5,Math.min(355,h)),this.startAngle===t?this.stopAngle=(this.startAngle+h)%360:(this.startAngle=r,this.stopAngle=(r+h)%360),this.properties.startAngle=this.startAngle,this.properties.stopAngle=this.stopAngle,this.properties.openingAngle=h,this.properties.style.startAngle=this.startAngle,this.properties.style.stopAngle=this.stopAngle,this.updateGeometry(),this})}setOpeningAngle(t){return At.measure("CircleArc.setOpeningAngle",()=>t<5||t>355?this:(this.stopAngle=(this.startAngle+t)%360,this.properties.openingAngle=t,this.updateGeometry(),this.updateProperties(),this))}setCenter(t){return At.measure("CircleArc.setCenter",()=>!t.lat||!t.lng?this:(this.center=t,this.updateGeometry(),this.updateProperties(),this))}getCenter(){return At.measure("CircleArc.getCenter",()=>this.center)}getOpeningAngle(){return At.measure("CircleArc.getOpeningAngle",()=>(this.stopAngle-this.startAngle+360)%360)}calculatePointOnArc(t){return At.measure("CircleArc.calculatePointOnArc",()=>{const i=t*Math.PI/180,r=this.radius*Math.cos(i),l=this.radius*Math.sin(i)/111319.9,h=r/(111319.9*Math.cos(this.center.lat*Math.PI/180));return gn.latLng(this.center.lat+l,this.center.lng+h)})}calculateMidpointPosition(){return At.measure("CircleArc.calculateMidpointPosition",()=>{const t=this.getOpeningAngle(),i=(this.startAngle+t/2)%360;return this.calculatePointOnArc(i)})}calculateAngleToPoint(t){return At.measure("CircleArc.calculateAngleToPoint",()=>Math.atan2(t.lat-this.center.lat,t.lng-this.center.lng)*180/Math.PI)}createControlPoints(t,i){At.measure("CircleArc.createControlPoints",()=>{const r=[],o=this.calculatePointOnArc(this.startAngle),l=this.calculatePointOnArc(this.stopAngle),h=this.calculateMidpointPosition(),p=this.createControlPoint(t,this.center,"#059669"),m=this.createControlPoint(t,o,"#DC2626"),_=this.createControlPoint(t,l,"#DC2626"),w=this.createControlPoint(t,h,"#2563EB");r.push(p,m,_,w),i(r)})}createControlPoint(t,i,r){return At.measure("CircleArc.createControlPoint",()=>gn.circleMarker(i,{radius:6,color:r,fillColor:r,fillOpacity:1,weight:2,className:"control-point",pmIgnore:!0}).addTo(t))}updateProperties(){At.measure("CircleArc.updateProperties",()=>{var l,h,p,m;const t=this.getOpeningAngle(),i=Math.PI*Math.pow(this.radius,2)*t/360,r=2*Math.PI*this.radius*t/360,o=r+2*this.radius;console.log(`
Mise à jour des propriétés du secteur de cercle:`),console.log(`- Rayon: ${this.radius.toFixed(2)}m`),console.log(`- Angle d'ouverture: ${t.toFixed(2)}°`),console.log(`- Surface calculée: ${i.toFixed(2)}m²`),console.log(`- Longueur d'arc: ${r.toFixed(2)}m`),console.log(`- Périmètre total: ${o.toFixed(2)}m`),this.properties={type:"Semicircle",radius:this.radius,startAngle:this.startAngle,stopAngle:this.stopAngle,surface:i,arcLength:r,perimeter:o,openingAngle:t,diameter:this.radius*2,center:{lat:this.center.lat,lng:this.center.lng},style:{...(l=this.properties)==null?void 0:l.style,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#3388ff",fillOpacity:this.options.fillOpacity||.2,dashArray:((h=this.options)==null?void 0:h.dashArray)||"",name:((m=(p=this.properties)==null?void 0:p.style)==null?void 0:m.name)||""}},this.fire("properties:updated",{shape:this,properties:this.properties})})}updateGeometry(){At.measure("CircleArc.updateGeometry",()=>{if(!this._map)return;const t=this.calculateArcPoints();t.length>0&&(this.setLatLngs([t]),this.updateProperties())})}toGeoJSON(){return At.measure("CircleArc.toGeoJSON",()=>{const t=super.toGeoJSON();return{...t,properties:{...t.properties,type:"Semicircle",radius:this.radius,startAngle:this.startAngle,stopAngle:this.stopAngle,openingAngle:this.getOpeningAngle()}}})}setName(t){At.measure("CircleArc.setName",()=>{this.properties.style||(this.properties.style={}),this.properties.style.name=t,this.fire("properties:updated",{shape:this,properties:this.properties})})}getName(){return At.measure("CircleArc.getName",()=>{var t,i;return((i=(t=this.properties)==null?void 0:t.style)==null?void 0:i.name)||""})}}class Xc extends gn.Circle{constructor(t,i){const r=i.radius||10;super(t,r,i);Mt(this,"properties");Mt(this,"angleCache",new Map);Mt(this,"lastCenter");Mt(this,"lastCenterCosLat");Mt(this,"_pendingNameUpdate",!1);Mt(this,"_nameUpdateTimeout",null);At.measure("Circle.constructor.init",()=>{this.properties={type:"Circle",style:{name:i.name||""}},requestAnimationFrame(()=>{this.updateProperties()}),this.on("add",()=>{requestAnimationFrame(()=>{this.updateProperties()})})},"Circle")}updateProperties(){At.measure("Circle.updateProperties",()=>{var h,p,m,_;const t=this.getRadius(),i=this.getLatLng(),r=((p=(h=this.properties)==null?void 0:h.style)==null?void 0:p.name)||"",o=((m=this.properties)==null?void 0:m.style)||{},l={type:"Circle",radius:t,diameter:t*2,surface:Math.PI*Math.pow(t,2),perimeter:2*Math.PI*t,center:{lat:i.lat,lng:i.lng},style:{...o,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#3388ff",fillOpacity:this.options.fillOpacity||.2,dashArray:((_=this.options)==null?void 0:_.dashArray)||"",name:r}};JSON.stringify(this.properties)!==JSON.stringify(l)&&(this.properties=l,this.fire("properties:updated",{shape:this,properties:this.properties}))},"Circle")}setName(t){At.measure("Circle.setName",()=>{var i,r;((r=(i=this.properties)==null?void 0:i.style)==null?void 0:r.name)!==t&&(this.properties.style||(this.properties.style={}),this.properties.style.name=t,!this._pendingNameUpdate&&(this._pendingNameUpdate=!0,this._nameUpdateTimeout&&clearTimeout(this._nameUpdateTimeout),this._nameUpdateTimeout=setTimeout(()=>{this._pendingNameUpdate=!1,this._nameUpdateTimeout=null,this.fire("properties:updated",{shape:this,properties:this.properties})},100)))},"Circle")}getName(){return At.measure("Circle.getName",()=>{var t,i;return((i=(t=this.properties)==null?void 0:t.style)==null?void 0:i.name)||""},"Circle")}setRadius(t){return At.measure("Circle.setRadius",()=>(super.setRadius(t),this.updateProperties(),this),"Circle")}setLatLng(t){return At.measure("Circle.setLatLng",()=>(super.setLatLng(t),this.updateProperties(),this),"Circle")}calculatePointOnCircle(t){return At.measure("Circle.calculatePointOnCircle",()=>{const i=this.getLatLng(),r=this.getRadius();let o=this.angleCache.get(t);if(!o){const l=t*Math.PI/180;o={sin:Math.sin(l),cos:Math.cos(l)},this.angleCache.set(t,o)}return(!this.lastCenter||!this.lastCenter.equals(i))&&(this.lastCenter=i,this.lastCenterCosLat=Math.cos(i.lat*Math.PI/180)),gn.latLng(i.lat+r/111319.9*o.sin,i.lng+r/(111319.9*this.lastCenterCosLat)*o.cos)},"Circle")}getCardinalPoints(){return At.measure("Circle.getCardinalPoints",()=>[0,45,90,135,180,225,270,315].map(t=>this.calculatePointOnCircle(t)),"Circle")}calculateAngleFromPoint(t){return At.measure("Circle.calculateAngleFromPoint",()=>{const i=this.getLatLng(),r=t.lng-i.lng,o=t.lat-i.lat;let l=Math.atan2(o,r)*180/Math.PI;return l<0&&(l+=360),l},"Circle")}resizeFromControlPoint(t){At.measure("Circle.resizeFromControlPoint",()=>{const r=this.getLatLng().distanceTo(t);r>0&&super.setRadius(r)},"Circle")}clearCache(){this.angleCache.clear(),this.lastCenter=void 0,this.lastCenterCosLat=void 0}}var ba=63710088e-1,h4={centimeters:ba*100,centimetres:ba*100,degrees:360/(2*Math.PI),feet:ba*3.28084,inches:ba*39.37,kilometers:ba/1e3,kilometres:ba/1e3,meters:ba,metres:ba,miles:ba/1609.344,millimeters:ba*1e3,millimetres:ba*1e3,nauticalmiles:ba/1852,radians:1,yards:ba*1.0936};function Kh(e,n,t={}){const i={type:"Feature"};return(t.id===0||t.id)&&(i.id=t.id),t.bbox&&(i.bbox=t.bbox),i.properties=n||{},i.geometry=e,i}function hp(e,n,t={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!fy(e[0])||!fy(e[1]))throw new Error("coordinates must contain numbers");return Kh({type:"Point",coordinates:e},n,t)}function El(e,n,t={}){for(const r of e){if(r.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(r[r.length-1].length!==r[0].length)throw new Error("First and last Position are not equivalent.");for(let o=0;o<r[r.length-1].length;o++)if(r[r.length-1][o]!==r[0][o])throw new Error("First and last Position are not equivalent.")}return Kh({type:"Polygon",coordinates:e},n,t)}function Al(e,n,t={}){if(e.length<2)throw new Error("coordinates must be an array of two or more positions");return Kh({type:"LineString",coordinates:e},n,t)}function TM(e,n={}){const t={type:"FeatureCollection"};return n.id&&(t.id=n.id),n.bbox&&(t.bbox=n.bbox),t.features=e,t}function BM(e,n,t={}){return Kh({type:"MultiPolygon",coordinates:e},n,t)}function NM(e,n="kilometers"){const t=h4[n];if(!t)throw new Error(n+" units is invalid");return e*t}function DM(e,n="kilometers"){const t=h4[n];if(!t)throw new Error(n+" units is invalid");return e/t}function Mg(e){return e%(2*Math.PI)*180/Math.PI}function Xl(e){return e%360*Math.PI/180}function fy(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function dy(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function wm(e,n,t={}){var i=dy(e),r=dy(n),o=Xl(r[1]-i[1]),l=Xl(r[0]-i[0]),h=Xl(i[1]),p=Xl(r[1]),m=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(l/2),2)*Math.cos(h)*Math.cos(p);return NM(2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m)),t.units)}var $0=wm;function RM(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function xm(e,n,t,i={}){const r=RM(e),o=Xl(r[0]),l=Xl(r[1]),h=Xl(t),p=DM(n,i.units),m=Math.asin(Math.sin(l)*Math.cos(p)+Math.cos(l)*Math.sin(p)*Math.cos(h)),_=o+Math.atan2(Math.sin(h)*Math.sin(p)*Math.cos(l),Math.cos(p)-Math.sin(l)*Math.sin(m)),w=Mg(_),E=Mg(m);return hp([w,E],i.properties)}var py=xm,fp={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */fp.exports;(function(e,n){(function(){var t,i="4.17.21",r=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",h="Invalid `variable` option passed into `_.template`",p="__lodash_hash_undefined__",m=500,_="__lodash_placeholder__",w=1,E=2,b=4,D=1,j=2,Q=1,F=2,V=4,pe=8,Ee=16,Ie=32,nt=64,We=128,O=256,H=512,le=30,G="...",I=800,Y=16,$=1,R=2,Z=3,se=1/0,ie=9007199254740991,Ae=17976931348623157e292,Te=NaN,ut=4294967295,X=ut-1,ke=ut>>>1,B=[["ary",We],["bind",Q],["bindKey",F],["curry",pe],["curryRight",Ee],["flip",H],["partial",Ie],["partialRight",nt],["rearg",O]],W="[object Arguments]",he="[object Array]",ne="[object AsyncFunction]",re="[object Boolean]",ee="[object Date]",oe="[object DOMException]",Se="[object Error]",te="[object Function]",ae="[object GeneratorFunction]",Le="[object Map]",ye="[object Number]",ue="[object Null]",Oe="[object Object]",De="[object Promise]",Me="[object Proxy]",Ve="[object RegExp]",ze="[object Set]",st="[object String]",Qe="[object Symbol]",pt="[object Undefined]",wt="[object WeakMap]",Ht="[object WeakSet]",nn="[object ArrayBuffer]",tt="[object DataView]",Qt="[object Float32Array]",rn="[object Float64Array]",it="[object Int8Array]",Ke="[object Int16Array]",qt="[object Int32Array]",mn="[object Uint8Array]",xn="[object Uint8ClampedArray]",wn="[object Uint16Array]",ot="[object Uint32Array]",de=/\b__p \+= '';/g,_e=/\b(__p \+=) '' \+/g,$e=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Gt=/&(?:amp|lt|gt|quot|#39);/g,Dn=/[&<>"']/g,Ln=RegExp(Gt.source),bt=RegExp(Dn.source),_n=/<%-([\s\S]+?)%>/g,$n=/<%([\s\S]+?)%>/g,ni=/<%=([\s\S]+?)%>/g,ri=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Li=/^\w*$/,Sn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Un=/[\\^$.*+?()[\]{}|]/g,ui=RegExp(Un.source),jn=/^\s+/,Wt=/\s/,yn=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ci=/\{\n\/\* \[wrapped with (.+)\] \*/,qi=/,? & /,Si=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Qi=/[()=,{}\[\]\/\s]/,fr=/\\(\\)?/g,Hn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ai=/\w*$/,rr=/^[-+]0x[0-9a-f]+$/i,Yi=/^0b[01]+$/i,Pi=/^\[object .+?Constructor\]$/,kn=/^0o[0-7]+$/i,xr=/^(?:0|[1-9]\d*)$/,Gi=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Wi=/($^)/,dr=/['\n\r\u2028\u2029\\]/g,zr="\\ud800-\\udfff",Vi="\\u0300-\\u036f",fi="\\ufe20-\\ufe2f",gs="\\u20d0-\\u20ff",Pr=Vi+fi+gs,Rr="\\u2700-\\u27bf",Ai="a-z\\xdf-\\xf6\\xf8-\\xff",En="\\xac\\xb1\\xd7\\xf7",hn="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",di="\\u2000-\\u206f",li=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Wn="A-Z\\xc0-\\xd6\\xd8-\\xde",as="\\ufe0e\\ufe0f",Ms=En+hn+di+li,jr="['’]",ao="["+zr+"]",dn="["+Ms+"]",si="["+Pr+"]",Er="\\d+",vr="["+Rr+"]",Lr="["+Ai+"]",Ea="[^"+zr+Ms+Er+Rr+Ai+Wn+"]",Po="\\ud83c[\\udffb-\\udfff]",Eo="(?:"+si+"|"+Po+")",Cr="[^"+zr+"]",Ts="(?:\\ud83c[\\udde6-\\uddff]){2}",lo="[\\ud800-\\udbff][\\udc00-\\udfff]",Bs="["+Wn+"]",sr="\\u200d",ms="(?:"+Lr+"|"+Ea+")",vs="(?:"+Bs+"|"+Ea+")",fo="(?:"+jr+"(?:d|ll|m|re|s|t|ve))?",Go="(?:"+jr+"(?:D|LL|M|RE|S|T|VE))?",ca=Eo+"?",Za="["+as+"]?",rs="(?:"+sr+"(?:"+[Cr,Ts,lo].join("|")+")"+Za+ca+")*",ou="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",fl="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",pi=Za+ca+rs,yi="(?:"+[vr,Ts,lo].join("|")+")"+pi,po="(?:"+[Cr+si+"?",si,Ts,lo,ao].join("|")+")",Zi=RegExp(jr,"g"),Nl=RegExp(si,"g"),Aa=RegExp(Po+"(?="+Po+")|"+po+pi,"g"),ka=RegExp([Bs+"?"+Lr+"+"+fo+"(?="+[dn,Bs,"$"].join("|")+")",vs+"+"+Go+"(?="+[dn,Bs+ms,"$"].join("|")+")",Bs+"?"+ms+"+"+fo,Bs+"+"+Go,fl,ou,Er,yi].join("|"),"g"),go=RegExp("["+sr+zr+Pr+as+"]"),ha=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Dl=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ka=-1,mi={};mi[Qt]=mi[rn]=mi[it]=mi[Ke]=mi[qt]=mi[mn]=mi[xn]=mi[wn]=mi[ot]=!0,mi[W]=mi[he]=mi[nn]=mi[re]=mi[tt]=mi[ee]=mi[Se]=mi[te]=mi[Le]=mi[ye]=mi[Oe]=mi[Ve]=mi[ze]=mi[st]=mi[wt]=!1;var Bi={};Bi[W]=Bi[he]=Bi[nn]=Bi[tt]=Bi[re]=Bi[ee]=Bi[Qt]=Bi[rn]=Bi[it]=Bi[Ke]=Bi[qt]=Bi[Le]=Bi[ye]=Bi[Oe]=Bi[Ve]=Bi[ze]=Bi[st]=Bi[Qe]=Bi[mn]=Bi[xn]=Bi[wn]=Bi[ot]=!0,Bi[Se]=Bi[te]=Bi[wt]=!1;var fa={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},au={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ja={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},dl={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ma=parseFloat,Ya=parseInt,pl=typeof qo=="object"&&qo&&qo.Object===Object&&qo,Oi=typeof self=="object"&&self&&self.Object===Object&&self,qr=pl||Oi||Function("return this")(),Qn=n&&!n.nodeType&&n,Gr=Qn&&!0&&e&&!e.nodeType&&e,Ta=Gr&&Gr.exports===Qn,Vo=Ta&&pl.process,Ar=function(){try{var Ct=Gr&&Gr.require&&Gr.require("util").types;return Ct||Vo&&Vo.binding&&Vo.binding("util")}catch{}}(),gl=Ar&&Ar.isArrayBuffer,Ao=Ar&&Ar.isDate,Xa=Ar&&Ar.isMap,Qa=Ar&&Ar.isRegExp,uo=Ar&&Ar.isSet,el=Ar&&Ar.isTypedArray;function or(Ct,Zt,Rt){switch(Rt.length){case 0:return Ct.call(Zt);case 1:return Ct.call(Zt,Rt[0]);case 2:return Ct.call(Zt,Rt[0],Rt[1]);case 3:return Ct.call(Zt,Rt[0],Rt[1],Rt[2])}return Ct.apply(Zt,Rt)}function lu(Ct,Zt,Rt,Mn){for(var qn=-1,gi=Ct==null?0:Ct.length;++qn<gi;){var kr=Ct[qn];Zt(Mn,kr,Rt(kr),Ct)}return Mn}function ls(Ct,Zt){for(var Rt=-1,Mn=Ct==null?0:Ct.length;++Rt<Mn&&Zt(Ct[Rt],Rt,Ct)!==!1;);return Ct}function mo(Ct,Zt){for(var Rt=Ct==null?0:Ct.length;Rt--&&Zt(Ct[Rt],Rt,Ct)!==!1;);return Ct}function tl(Ct,Zt){for(var Rt=-1,Mn=Ct==null?0:Ct.length;++Rt<Mn;)if(!Zt(Ct[Rt],Rt,Ct))return!1;return!0}function vo(Ct,Zt){for(var Rt=-1,Mn=Ct==null?0:Ct.length,qn=0,gi=[];++Rt<Mn;){var kr=Ct[Rt];Zt(kr,Rt,Ct)&&(gi[qn++]=kr)}return gi}function Ba(Ct,Zt){var Rt=Ct==null?0:Ct.length;return!!Rt&&cn(Ct,Zt,0)>-1}function Na(Ct,Zt,Rt){for(var Mn=-1,qn=Ct==null?0:Ct.length;++Mn<qn;)if(Rt(Zt,Ct[Mn]))return!0;return!1}function ar(Ct,Zt){for(var Rt=-1,Mn=Ct==null?0:Ct.length,qn=Array(Mn);++Rt<Mn;)qn[Rt]=Zt(Ct[Rt],Rt,Ct);return qn}function to(Ct,Zt){for(var Rt=-1,Mn=Zt.length,qn=Ct.length;++Rt<Mn;)Ct[qn+Rt]=Zt[Rt];return Ct}function Ho(Ct,Zt,Rt,Mn){var qn=-1,gi=Ct==null?0:Ct.length;for(Mn&&gi&&(Rt=Ct[++qn]);++qn<gi;)Rt=Zt(Rt,Ct[qn],qn,Ct);return Rt}function Vr(Ct,Zt,Rt,Mn){var qn=Ct==null?0:Ct.length;for(Mn&&qn&&(Rt=Ct[--qn]);qn--;)Rt=Zt(Rt,Ct[qn],qn,Ct);return Rt}function k(Ct,Zt){for(var Rt=-1,Mn=Ct==null?0:Ct.length;++Rt<Mn;)if(Zt(Ct[Rt],Rt,Ct))return!0;return!1}var ge=ci("length");function Je(Ct){return Ct.split("")}function dt(Ct){return Ct.match(Si)||[]}function kt(Ct,Zt,Rt){var Mn;return Rt(Ct,function(qn,gi,kr){if(Zt(qn,gi,kr))return Mn=gi,!1}),Mn}function Ut(Ct,Zt,Rt,Mn){for(var qn=Ct.length,gi=Rt+(Mn?1:-1);Mn?gi--:++gi<qn;)if(Zt(Ct[gi],gi,Ct))return gi;return-1}function cn(Ct,Zt,Rt){return Zt===Zt?ss(Ct,Zt,Rt):Ut(Ct,Rn,Rt)}function Bn(Ct,Zt,Rt,Mn){for(var qn=Rt-1,gi=Ct.length;++qn<gi;)if(Mn(Ct[qn],Zt))return qn;return-1}function Rn(Ct){return Ct!==Ct}function Yn(Ct,Zt){var Rt=Ct==null?0:Ct.length;return Rt?lr(Ct,Zt)/Rt:Te}function ci(Ct){return function(Zt){return Zt==null?t:Zt[Ct]}}function ki(Ct){return function(Zt){return Ct==null?t:Ct[Zt]}}function Sr(Ct,Zt,Rt,Mn,qn){return qn(Ct,function(gi,kr,ur){Rt=Mn?(Mn=!1,gi):Zt(Rt,gi,kr,ur)}),Rt}function er(Ct,Zt){var Rt=Ct.length;for(Ct.sort(Zt);Rt--;)Ct[Rt]=Ct[Rt].value;return Ct}function lr(Ct,Zt){for(var Rt,Mn=-1,qn=Ct.length;++Mn<qn;){var gi=Zt(Ct[Mn]);gi!==t&&(Rt=Rt===t?gi:Rt+gi)}return Rt}function Hr(Ct,Zt){for(var Rt=-1,Mn=Array(Ct);++Rt<Ct;)Mn[Rt]=Zt(Rt);return Mn}function Qr(Ct,Zt){return ar(Zt,function(Rt){return[Rt,Ct[Rt]]})}function no(Ct){return Ct&&Ct.slice(0,Zo(Ct)+1).replace(jn,"")}function Mi(Ct){return function(Zt){return Ct(Zt)}}function ys(Ct,Zt){return ar(Zt,function(Rt){return Ct[Rt]})}function Da(Ct,Zt){return Ct.has(Zt)}function Ns(Ct,Zt){for(var Rt=-1,Mn=Ct.length;++Rt<Mn&&cn(Zt,Ct[Rt],0)>-1;);return Rt}function ml(Ct,Zt){for(var Rt=Ct.length;Rt--&&cn(Zt,Ct[Rt],0)>-1;);return Rt}function ko(Ct,Zt){for(var Rt=Ct.length,Mn=0;Rt--;)Ct[Rt]===Zt&&++Mn;return Mn}var Rl=ki(fa),da=ki(au);function pa(Ct){return"\\"+dl[Ct]}function es(Ct,Zt){return Ct==null?t:Ct[Zt]}function Mo(Ct){return go.test(Ct)}function io(Ct){return ha.test(Ct)}function Us(Ct){for(var Zt,Rt=[];!(Zt=Ct.next()).done;)Rt.push(Zt.value);return Rt}function Ra(Ct){var Zt=-1,Rt=Array(Ct.size);return Ct.forEach(function(Mn,qn){Rt[++Zt]=[qn,Mn]}),Rt}function _s(Ct,Zt){return function(Rt){return Ct(Zt(Rt))}}function Ds(Ct,Zt){for(var Rt=-1,Mn=Ct.length,qn=0,gi=[];++Rt<Mn;){var kr=Ct[Rt];(kr===Zt||kr===_)&&(Ct[Rt]=_,gi[qn++]=Rt)}return gi}function Rs(Ct){var Zt=-1,Rt=Array(Ct.size);return Ct.forEach(function(Mn){Rt[++Zt]=Mn}),Rt}function uu(Ct){var Zt=-1,Rt=Array(Ct.size);return Ct.forEach(function(Mn){Rt[++Zt]=[Mn,Mn]}),Rt}function ss(Ct,Zt,Rt){for(var Mn=Rt-1,qn=Ct.length;++Mn<qn;)if(Ct[Mn]===Zt)return Mn;return-1}function Wo(Ct,Zt,Rt){for(var Mn=Rt+1;Mn--;)if(Ct[Mn]===Zt)return Mn;return Mn}function bs(Ct){return Mo(Ct)?xs(Ct):ge(Ct)}function ws(Ct){return Mo(Ct)?us(Ct):Je(Ct)}function Zo(Ct){for(var Zt=Ct.length;Zt--&&Wt.test(Ct.charAt(Zt)););return Zt}var Ko=ki(Ja);function xs(Ct){for(var Zt=Aa.lastIndex=0;Aa.test(Ct);)++Zt;return Zt}function us(Ct){return Ct.match(Aa)||[]}function To(Ct){return Ct.match(ka)||[]}var ro=function Ct(Zt){Zt=Zt==null?qr:Ls.defaults(qr.Object(),Zt,Ls.pick(qr,Dl));var Rt=Zt.Array,Mn=Zt.Date,qn=Zt.Error,gi=Zt.Function,kr=Zt.Math,ur=Zt.Object,nl=Zt.RegExp,Os=Zt.String,Mr=Zt.TypeError,Bo=Rt.prototype,Jo=gi.prototype,No=ur.prototype,Do=Zt["__core-js_shared__"],Ro=Jo.toString,Ii=No.hasOwnProperty,yo=0,cs=function(){var u=/[^.]+$/.exec(Do&&Do.keys&&Do.keys.IE_PROTO||"");return u?"Symbol(src)_1."+u:""}(),cr=No.toString,pr=Ro.call(ur),Wr=qr._,_r=nl("^"+Ro.call(Ii).replace(Un,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),so=Ta?Zt.Buffer:t,$s=Zt.Symbol,co=Zt.Uint8Array,Ol=so?so.allocUnsafe:t,Oo=_s(ur.getPrototypeOf,ur),ts=ur.create,yr=No.propertyIsEnumerable,Cs=Bo.splice,qs=$s?$s.isConcatSpreadable:t,oi=$s?$s.iterator:t,Yo=$s?$s.toStringTag:t,Xo=function(){try{var u=jc(ur,"defineProperty");return u({},"",{}),u}catch{}}(),_o=Zt.clearTimeout!==qr.clearTimeout&&Zt.clearTimeout,Is=Mn&&Mn.now!==qr.Date.now&&Mn.now,Tu=Zt.setTimeout!==qr.setTimeout&&Zt.setTimeout,hs=kr.ceil,fs=kr.floor,bo=ur.getOwnPropertySymbols,s=so?so.isBuffer:t,f=Zt.isFinite,x=Bo.join,T=_s(ur.keys,ur),K=kr.max,we=kr.min,ct=Mn.now,Dt=Zt.parseInt,$t=kr.random,an=Bo.reverse,Nn=jc(Zt,"DataView"),Zn=jc(Zt,"Map"),Ei=jc(Zt,"Promise"),ns=jc(Zt,"Set"),Or=jc(Zt,"WeakMap"),ds=jc(ur,"create"),Tr=Or&&new Or,Gs={},Bu=Uc(Nn),Io=Uc(Zn),wo=Uc(Ei),ho=Uc(ns),Nc=Uc(Or),vl=$s?$s.prototype:t,nr=vl?vl.valueOf:t,Ss=vl?vl.toString:t;function Ne(u){if(Fs(u)&&!zi(u)&&!(u instanceof Ti)){if(u instanceof ps)return u;if(Ii.call(u,"__wrapped__"))return n1(u)}return new ps(u)}var Vs=function(){function u(){}return function(d){if(!Es(d))return{};if(ts)return ts(d);u.prototype=d;var P=new u;return u.prototype=t,P}}();function Il(){}function ps(u,d){this.__wrapped__=u,this.__actions__=[],this.__chain__=!!d,this.__index__=0,this.__values__=t}Ne.templateSettings={escape:_n,evaluate:$n,interpolate:ni,variable:"",imports:{_:Ne}},Ne.prototype=Il.prototype,Ne.prototype.constructor=Ne,ps.prototype=Vs(Il.prototype),ps.prototype.constructor=ps;function Ti(u){this.__wrapped__=u,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ut,this.__views__=[]}function nc(){var u=new Ti(this.__wrapped__);return u.__actions__=Ia(this.__actions__),u.__dir__=this.__dir__,u.__filtered__=this.__filtered__,u.__iteratees__=Ia(this.__iteratees__),u.__takeCount__=this.__takeCount__,u.__views__=Ia(this.__views__),u}function dh(){if(this.__filtered__){var u=new Ti(this);u.__dir__=-1,u.__filtered__=!0}else u=this.clone(),u.__dir__*=-1;return u}function ic(){var u=this.__wrapped__.value(),d=this.__dir__,P=zi(u),U=d<0,ve=P?u.length:0,Ue=ub(0,ve,this.__views__),lt=Ue.start,_t=Ue.end,Nt=_t-lt,ln=U?_t:lt-1,un=this.__iteratees__,vn=un.length,In=0,ei=we(Nt,this.__takeCount__);if(!P||!U&&ve==Nt&&ei==Nt)return yl(u,this.__actions__);var _i=[];e:for(;Nt--&&In<ei;){ln+=d;for(var Xi=-1,bi=u[ln];++Xi<vn;){var hr=un[Xi],mr=hr.iteratee,sl=hr.type,ya=mr(bi);if(sl==R)bi=ya;else if(!ya){if(sl==$)continue e;break e}}_i[In++]=bi}return _i}Ti.prototype=Vs(Il.prototype),Ti.prototype.constructor=Ti;function ga(u){var d=-1,P=u==null?0:u.length;for(this.clear();++d<P;){var U=u[d];this.set(U[0],U[1])}}function Nu(){this.__data__=ds?ds(null):{},this.size=0}function Dc(u){var d=this.has(u)&&delete this.__data__[u];return this.size-=d?1:0,d}function Qh(u){var d=this.__data__;if(ds){var P=d[u];return P===p?t:P}return Ii.call(d,u)?d[u]:t}function cu(u){var d=this.__data__;return ds?d[u]!==t:Ii.call(d,u)}function rc(u,d){var P=this.__data__;return this.size+=this.has(u)?0:1,P[u]=ds&&d===t?p:d,this}ga.prototype.clear=Nu,ga.prototype.delete=Dc,ga.prototype.get=Qh,ga.prototype.has=cu,ga.prototype.set=rc;function il(u){var d=-1,P=u==null?0:u.length;for(this.clear();++d<P;){var U=u[d];this.set(U[0],U[1])}}function ef(){this.__data__=[],this.size=0}function sc(u){var d=this.__data__,P=Lt(d,u);if(P<0)return!1;var U=d.length-1;return P==U?d.pop():Cs.call(d,P,1),--this.size,!0}function oc(u){var d=this.__data__,P=Lt(d,u);return P<0?t:d[P][1]}function ph(u){return Lt(this.__data__,u)>-1}function gh(u,d){var P=this.__data__,U=Lt(P,u);return U<0?(++this.size,P.push([u,d])):P[U][1]=d,this}il.prototype.clear=ef,il.prototype.delete=sc,il.prototype.get=oc,il.prototype.has=ph,il.prototype.set=gh;function Qo(u){var d=-1,P=u==null?0:u.length;for(this.clear();++d<P;){var U=u[d];this.set(U[0],U[1])}}function mh(){this.size=0,this.__data__={hash:new ga,map:new(Zn||il),string:new ga}}function vh(u){var d=cd(this,u).delete(u);return this.size-=d?1:0,d}function yh(u){return cd(this,u).get(u)}function v(u){return cd(this,u).has(u)}function S(u,d){var P=cd(this,u),U=P.size;return P.set(u,d),this.size+=P.size==U?0:1,this}Qo.prototype.clear=mh,Qo.prototype.delete=vh,Qo.prototype.get=yh,Qo.prototype.has=v,Qo.prototype.set=S;function N(u){var d=-1,P=u==null?0:u.length;for(this.__data__=new Qo;++d<P;)this.add(u[d])}function J(u){return this.__data__.set(u,p),this}function me(u){return this.__data__.has(u)}N.prototype.add=N.prototype.push=J,N.prototype.has=me;function xe(u){var d=this.__data__=new il(u);this.size=d.size}function Pe(){this.__data__=new il,this.size=0}function Be(u){var d=this.__data__,P=d.delete(u);return this.size=d.size,P}function Re(u){return this.__data__.get(u)}function Ze(u){return this.__data__.has(u)}function mt(u,d){var P=this.__data__;if(P instanceof il){var U=P.__data__;if(!Zn||U.length<r-1)return U.push([u,d]),this.size=++P.size,this;P=this.__data__=new Qo(U)}return P.set(u,d),this.size=P.size,this}xe.prototype.clear=Pe,xe.prototype.delete=Be,xe.prototype.get=Re,xe.prototype.has=Ze,xe.prototype.set=mt;function Ft(u,d){var P=zi(u),U=!P&&$c(u),ve=!P&&!U&&lc(u),Ue=!P&&!U&&!ve&&Eh(u),lt=P||U||ve||Ue,_t=lt?Hr(u.length,Os):[],Nt=_t.length;for(var ln in u)(d||Ii.call(u,ln))&&!(lt&&(ln=="length"||ve&&(ln=="offset"||ln=="parent")||Ue&&(ln=="buffer"||ln=="byteLength"||ln=="byteOffset")||zu(ln,Nt)))&&_t.push(ln);return _t}function zt(u){var d=u.length;return d?u[Ic(0,d-1)]:t}function Et(u,d){return hd(Ia(u),Kn(d,0,u.length))}function Kt(u){return hd(Ia(u))}function Vt(u,d,P){(P!==t&&!ql(u[d],P)||P===t&&!(d in u))&&Tn(u,d,P)}function vt(u,d,P){var U=u[d];(!(Ii.call(u,d)&&ql(U,P))||P===t&&!(d in u))&&Tn(u,d,P)}function Lt(u,d){for(var P=u.length;P--;)if(ql(u[P][0],d))return P;return-1}function tn(u,d,P,U){return M(u,function(ve,Ue,lt){d(U,ve,P(ve),lt)}),U}function fn(u,d){return u&&du(d,xo(d),u)}function sn(u,d){return u&&du(d,za(d),u)}function Tn(u,d,P){d=="__proto__"&&Xo?Xo(u,d,{configurable:!0,enumerable:!0,value:P,writable:!0}):u[d]=P}function An(u,d){for(var P=-1,U=d.length,ve=Rt(U),Ue=u==null;++P<U;)ve[P]=Ue?t:d0(u,d[P]);return ve}function Kn(u,d,P){return u===u&&(P!==t&&(u=u<=P?u:P),d!==t&&(u=u>=d?u:d)),u}function a(u,d,P,U,ve,Ue){var lt,_t=d&w,Nt=d&E,ln=d&b;if(P&&(lt=ve?P(u,U,ve,Ue):P(u)),lt!==t)return lt;if(!Es(u))return u;var un=zi(u);if(un){if(lt=hb(u),!_t)return Ia(u,lt)}else{var vn=ta(u),In=vn==te||vn==ae;if(lc(u))return Am(u,_t);if(vn==Oe||vn==W||In&&!ve){if(lt=Nt||In?{}:Wm(u),!_t)return Nt?eb(u,sn(lt,u)):Q4(u,fn(lt,u))}else{if(!Bi[vn])return ve?u:{};lt=fb(u,vn,_t)}}Ue||(Ue=new xe);var ei=Ue.get(u);if(ei)return ei;Ue.set(u,lt),x1(u)?u.forEach(function(bi){lt.add(a(bi,d,P,bi,u,Ue))}):b1(u)&&u.forEach(function(bi,hr){lt.set(hr,a(bi,d,P,hr,u,Ue))});var _i=ln?Nt?Qp:Xp:Nt?za:xo,Xi=un?t:_i(u);return ls(Xi||u,function(bi,hr){Xi&&(hr=bi,bi=u[hr]),vt(lt,hr,a(bi,d,P,hr,u,Ue))}),lt}function c(u){var d=xo(u);return function(P){return g(P,u,d)}}function g(u,d,P){var U=P.length;if(u==null)return!U;for(u=ur(u);U--;){var ve=P[U],Ue=d[ve],lt=u[ve];if(lt===t&&!(ve in u)||!Ue(lt))return!1}return!0}function y(u,d,P){if(typeof u!="function")throw new Mr(l);return of(function(){u.apply(t,P)},d)}function C(u,d,P,U){var ve=-1,Ue=Ba,lt=!0,_t=u.length,Nt=[],ln=d.length;if(!_t)return Nt;P&&(d=ar(d,Mi(P))),U?(Ue=Na,lt=!1):d.length>=r&&(Ue=Da,lt=!1,d=new N(d));e:for(;++ve<_t;){var un=u[ve],vn=P==null?un:P(un);if(un=U||un!==0?un:0,lt&&vn===vn){for(var In=ln;In--;)if(d[In]===vn)continue e;Nt.push(un)}else Ue(d,vn,U)||Nt.push(un)}return Nt}var M=Nm(en),z=Nm(bn,!0);function q(u,d){var P=!0;return M(u,function(U,ve,Ue){return P=!!d(U,ve,Ue),P}),P}function ce(u,d,P){for(var U=-1,ve=u.length;++U<ve;){var Ue=u[U],lt=d(Ue);if(lt!=null&&(_t===t?lt===lt&&!rl(lt):P(lt,_t)))var _t=lt,Nt=Ue}return Nt}function be(u,d,P,U){var ve=u.length;for(P=Ji(P),P<0&&(P=-P>ve?0:ve+P),U=U===t||U>ve?ve:Ji(U),U<0&&(U+=ve),U=P>U?0:C1(U);P<U;)u[P++]=d;return u}function Xe(u,d){var P=[];return M(u,function(U,ve,Ue){d(U,ve,Ue)&&P.push(U)}),P}function He(u,d,P,U,ve){var Ue=-1,lt=u.length;for(P||(P=pb),ve||(ve=[]);++Ue<lt;){var _t=u[Ue];d>0&&P(_t)?d>1?He(_t,d-1,P,U,ve):to(ve,_t):U||(ve[ve.length]=_t)}return ve}var xt=Dm(),Ot=Dm(!0);function en(u,d){return u&&xt(u,d,xo)}function bn(u,d){return u&&Ot(u,d,xo)}function Pn(u,d){return vo(d,function(P){return ju(u[P])})}function ti(u,d){d=$l(d,u);for(var P=0,U=d.length;u!=null&&P<U;)u=u[pu(d[P++])];return P&&P==U?u:t}function Ye(u,d,P){var U=d(u);return zi(u)?U:to(U,P(u))}function at(u){return u==null?u===t?pt:ue:Yo&&Yo in ur(u)?lb(u):wb(u)}function gt(u,d){return u>d}function jt(u,d){return u!=null&&Ii.call(u,d)}function Pt(u,d){return u!=null&&d in ur(u)}function It(u,d,P){return u>=we(d,P)&&u<K(d,P)}function fe(u,d,P){for(var U=P?Na:Ba,ve=u[0].length,Ue=u.length,lt=Ue,_t=Rt(Ue),Nt=1/0,ln=[];lt--;){var un=u[lt];lt&&d&&(un=ar(un,Mi(d))),Nt=we(un.length,Nt),_t[lt]=!P&&(d||ve>=120&&un.length>=120)?new N(lt&&un):t}un=u[0];var vn=-1,In=_t[0];e:for(;++vn<ve&&ln.length<Nt;){var ei=un[vn],_i=d?d(ei):ei;if(ei=P||ei!==0?ei:0,!(In?Da(In,_i):U(ln,_i,P))){for(lt=Ue;--lt;){var Xi=_t[lt];if(!(Xi?Da(Xi,_i):U(u[lt],_i,P)))continue e}In&&In.push(_i),ln.push(ei)}}return ln}function Ce(u,d,P,U){return en(u,function(ve,Ue,lt){d(U,P(ve),Ue,lt)}),U}function je(u,d,P){d=$l(d,u),u=Ym(u,d);var U=u==null?u:u[pu(wl(d))];return U==null?t:or(U,u,P)}function Fe(u){return Fs(u)&&at(u)==W}function qe(u){return Fs(u)&&at(u)==nn}function Ge(u){return Fs(u)&&at(u)==ee}function ht(u,d,P,U,ve){return u===d?!0:u==null||d==null||!Fs(u)&&!Fs(d)?u!==u&&d!==d:ft(u,d,P,U,ht,ve)}function ft(u,d,P,U,ve,Ue){var lt=zi(u),_t=zi(d),Nt=lt?he:ta(u),ln=_t?he:ta(d);Nt=Nt==W?Oe:Nt,ln=ln==W?Oe:ln;var un=Nt==Oe,vn=ln==Oe,In=Nt==ln;if(In&&lc(u)){if(!lc(d))return!1;lt=!0,un=!1}if(In&&!un)return Ue||(Ue=new xe),lt||Eh(u)?Gm(u,d,P,U,ve,Ue):ob(u,d,Nt,P,U,ve,Ue);if(!(P&D)){var ei=un&&Ii.call(u,"__wrapped__"),_i=vn&&Ii.call(d,"__wrapped__");if(ei||_i){var Xi=ei?u.value():u,bi=_i?d.value():d;return Ue||(Ue=new xe),ve(Xi,bi,P,U,Ue)}}return In?(Ue||(Ue=new xe),ab(u,d,P,U,ve,Ue)):!1}function yt(u){return Fs(u)&&ta(u)==Le}function Tt(u,d,P,U){var ve=P.length,Ue=ve,lt=!U;if(u==null)return!Ue;for(u=ur(u);ve--;){var _t=P[ve];if(lt&&_t[2]?_t[1]!==u[_t[0]]:!(_t[0]in u))return!1}for(;++ve<Ue;){_t=P[ve];var Nt=_t[0],ln=u[Nt],un=_t[1];if(lt&&_t[2]){if(ln===t&&!(Nt in u))return!1}else{var vn=new xe;if(U)var In=U(ln,un,Nt,u,d,vn);if(!(In===t?ht(un,ln,D|j,U,vn):In))return!1}}return!0}function Bt(u){if(!Es(u)||mb(u))return!1;var d=ju(u)?_r:Pi;return d.test(Uc(u))}function on(u){return Fs(u)&&at(u)==Ve}function On(u){return Fs(u)&&ta(u)==ze}function Fn(u){return Fs(u)&&vd(u.length)&&!!mi[at(u)]}function Jn(u){return typeof u=="function"?u:u==null?ja:typeof u=="object"?zi(u)?Fl(u[0],u[1]):Hs(u):R1(u)}function ir(u){if(!sf(u))return T(u);var d=[];for(var P in ur(u))Ii.call(u,P)&&P!="constructor"&&d.push(P);return d}function gr(u){if(!Es(u))return bb(u);var d=sf(u),P=[];for(var U in u)U=="constructor"&&(d||!Ii.call(u,U))||P.push(U);return P}function Fi(u,d){return u<d}function br(u,d){var P=-1,U=Fa(u)?Rt(u.length):[];return M(u,function(ve,Ue,lt){U[++P]=d(ve,Ue,lt)}),U}function Hs(u){var d=t0(u);return d.length==1&&d[0][2]?Km(d[0][0],d[0][1]):function(P){return P===u||Tt(P,u,d)}}function Fl(u,d){return i0(u)&&Zm(d)?Km(pu(u),d):function(P){var U=d0(P,u);return U===t&&U===d?p0(P,u):ht(d,U,D|j)}}function Fo(u,d,P,U,ve){u!==d&&xt(d,function(Ue,lt){if(ve||(ve=new xe),Es(Ue))Rc(u,d,lt,P,Fo,U,ve);else{var _t=U?U(s0(u,lt),Ue,lt+"",u,d,ve):t;_t===t&&(_t=Ue),Vt(u,lt,_t)}},za)}function Rc(u,d,P,U,ve,Ue,lt){var _t=s0(u,P),Nt=s0(d,P),ln=lt.get(Nt);if(ln){Vt(u,P,ln);return}var un=Ue?Ue(_t,Nt,P+"",u,d,lt):t,vn=un===t;if(vn){var In=zi(Nt),ei=!In&&lc(Nt),_i=!In&&!ei&&Eh(Nt);un=Nt,In||ei||_i?zi(_t)?un=_t:Ws(_t)?un=Ia(_t):ei?(vn=!1,un=Am(Nt,!0)):_i?(vn=!1,un=km(Nt,!0)):un=[]:af(Nt)||$c(Nt)?(un=_t,$c(_t)?un=S1(_t):(!Es(_t)||ju(_t))&&(un=Wm(Nt))):vn=!1}vn&&(lt.set(Nt,un),ve(un,Nt,U,Ue,lt),lt.delete(Nt)),Vt(u,P,un)}function ma(u,d){var P=u.length;if(P)return d+=d<0?P:0,zu(d,P)?u[d]:t}function hu(u,d,P){d.length?d=ar(d,function(Ue){return zi(Ue)?function(lt){return ti(lt,Ue.length===1?Ue[0]:Ue)}:Ue}):d=[ja];var U=-1;d=ar(d,Mi(vi()));var ve=br(u,function(Ue,lt,_t){var Nt=ar(d,function(ln){return ln(Ue)});return{criteria:Nt,index:++U,value:Ue}});return er(ve,function(Ue,lt){return X4(Ue,lt,P)})}function zo(u,d){return Ps(u,d,function(P,U){return p0(u,U)})}function Ps(u,d,P){for(var U=-1,ve=d.length,Ue={};++U<ve;){var lt=d[U],_t=ti(u,lt);P(_t,lt)&&Du(Ue,$l(lt,u),_t)}return Ue}function Zr(u){return function(d){return ti(d,u)}}function _h(u,d,P,U){var ve=U?Bn:cn,Ue=-1,lt=d.length,_t=u;for(u===d&&(d=Ia(d)),P&&(_t=ar(u,Mi(P)));++Ue<lt;)for(var Nt=0,ln=d[Ue],un=P?P(ln):ln;(Nt=ve(_t,un,Nt,U))>-1;)_t!==u&&Cs.call(_t,Nt,1),Cs.call(u,Nt,1);return u}function Oc(u,d){for(var P=u?d.length:0,U=P-1;P--;){var ve=d[P];if(P==U||ve!==Ue){var Ue=ve;zu(ve)?Cs.call(u,ve,1):Ru(u,ve)}}return u}function Ic(u,d){return u+fs($t()*(d-u+1))}function Fc(u,d,P,U){for(var ve=-1,Ue=K(hs((d-u)/(P||1)),0),lt=Rt(Ue);Ue--;)lt[U?Ue:++ve]=u,u+=P;return lt}function bh(u,d){var P="";if(!u||d<1||d>ie)return P;do d%2&&(P+=u),d=fs(d/2),d&&(u+=u);while(d);return P}function Ki(u,d){return o0(Jm(u,d,ja),u+"")}function wh(u){return zt(Ah(u))}function Qf(u,d){var P=Ah(u);return hd(P,Kn(d,0,P.length))}function Du(u,d,P,U){if(!Es(u))return u;d=$l(d,u);for(var ve=-1,Ue=d.length,lt=Ue-1,_t=u;_t!=null&&++ve<Ue;){var Nt=pu(d[ve]),ln=P;if(Nt==="__proto__"||Nt==="constructor"||Nt==="prototype")return u;if(ve!=lt){var un=_t[Nt];ln=U?U(un,Nt,_t):t,ln===t&&(ln=Es(un)?un:zu(d[ve+1])?[]:{})}vt(_t,Nt,ln),_t=_t[Nt]}return u}var zl=Tr?function(u,d){return Tr.set(u,d),u}:ja,ed=Xo?function(u,d){return Xo(u,"toString",{configurable:!0,enumerable:!1,value:m0(d),writable:!0})}:ja;function td(u){return hd(Ah(u))}function Oa(u,d,P){var U=-1,ve=u.length;d<0&&(d=-d>ve?0:ve+d),P=P>ve?ve:P,P<0&&(P+=ve),ve=d>P?0:P-d>>>0,d>>>=0;for(var Ue=Rt(ve);++U<ve;)Ue[U]=u[U+d];return Ue}function nd(u,d){var P;return M(u,function(U,ve,Ue){return P=d(U,ve,Ue),!P}),!!P}function jl(u,d,P){var U=0,ve=u==null?U:u.length;if(typeof d=="number"&&d===d&&ve<=ke){for(;U<ve;){var Ue=U+ve>>>1,lt=u[Ue];lt!==null&&!rl(lt)&&(P?lt<=d:lt<d)?U=Ue+1:ve=Ue}return ve}return tf(u,d,ja,P)}function tf(u,d,P,U){var ve=0,Ue=u==null?0:u.length;if(Ue===0)return 0;d=P(d);for(var lt=d!==d,_t=d===null,Nt=rl(d),ln=d===t;ve<Ue;){var un=fs((ve+Ue)/2),vn=P(u[un]),In=vn!==t,ei=vn===null,_i=vn===vn,Xi=rl(vn);if(lt)var bi=U||_i;else ln?bi=_i&&(U||In):_t?bi=_i&&In&&(U||!ei):Nt?bi=_i&&In&&!ei&&(U||!Xi):ei||Xi?bi=!1:bi=U?vn<=d:vn<d;bi?ve=un+1:Ue=un}return we(Ue,X)}function nf(u,d){for(var P=-1,U=u.length,ve=0,Ue=[];++P<U;){var lt=u[P],_t=d?d(lt):lt;if(!P||!ql(_t,Nt)){var Nt=_t;Ue[ve++]=lt===0?0:lt}}return Ue}function id(u){return typeof u=="number"?u:rl(u)?Te:+u}function ea(u){if(typeof u=="string")return u;if(zi(u))return ar(u,ea)+"";if(rl(u))return Ss?Ss.call(u):"";var d=u+"";return d=="0"&&1/u==-1/0?"-0":d}function fu(u,d,P){var U=-1,ve=Ba,Ue=u.length,lt=!0,_t=[],Nt=_t;if(P)lt=!1,ve=Na;else if(Ue>=r){var ln=d?null:rb(u);if(ln)return Rs(ln);lt=!1,ve=Da,Nt=new N}else Nt=d?[]:_t;e:for(;++U<Ue;){var un=u[U],vn=d?d(un):un;if(un=P||un!==0?un:0,lt&&vn===vn){for(var In=Nt.length;In--;)if(Nt[In]===vn)continue e;d&&Nt.push(vn),_t.push(un)}else ve(Nt,vn,P)||(Nt!==_t&&Nt.push(vn),_t.push(un))}return _t}function Ru(u,d){return d=$l(d,u),u=Ym(u,d),u==null||delete u[pu(wl(d))]}function xh(u,d,P,U){return Du(u,d,P(ti(u,d)),U)}function Ou(u,d,P,U){for(var ve=u.length,Ue=U?ve:-1;(U?Ue--:++Ue<ve)&&d(u[Ue],Ue,u););return P?Oa(u,U?0:Ue,U?Ue+1:ve):Oa(u,U?Ue+1:0,U?ve:Ue)}function yl(u,d){var P=u;return P instanceof Ti&&(P=P.value()),Ho(d,function(U,ve){return ve.func.apply(ve.thisArg,to([U],ve.args))},P)}function _l(u,d,P){var U=u.length;if(U<2)return U?fu(u[0]):[];for(var ve=-1,Ue=Rt(U);++ve<U;)for(var lt=u[ve],_t=-1;++_t<U;)_t!=ve&&(Ue[ve]=C(Ue[ve]||lt,u[_t],d,P));return fu(He(Ue,1),d,P)}function Ul(u,d,P){for(var U=-1,ve=u.length,Ue=d.length,lt={};++U<ve;){var _t=U<Ue?d[U]:t;P(lt,u[U],_t)}return lt}function ac(u){return Ws(u)?u:[]}function zc(u){return typeof u=="function"?u:ja}function $l(u,d){return zi(u)?u:i0(u,d)?[u]:t1(Br(u))}var Zp=Ki;function bl(u,d,P){var U=u.length;return P=P===t?U:P,!d&&P>=U?u:Oa(u,d,P)}var Lh=_o||function(u){return qr.clearTimeout(u)};function Am(u,d){if(d)return u.slice();var P=u.length,U=Ol?Ol(P):new u.constructor(P);return u.copy(U),U}function Kp(u){var d=new u.constructor(u.byteLength);return new co(d).set(new co(u)),d}function K4(u,d){var P=d?Kp(u.buffer):u.buffer;return new u.constructor(P,u.byteOffset,u.byteLength)}function J4(u){var d=new u.constructor(u.source,ai.exec(u));return d.lastIndex=u.lastIndex,d}function Y4(u){return nr?ur(nr.call(u)):{}}function km(u,d){var P=d?Kp(u.buffer):u.buffer;return new u.constructor(P,u.byteOffset,u.length)}function Mm(u,d){if(u!==d){var P=u!==t,U=u===null,ve=u===u,Ue=rl(u),lt=d!==t,_t=d===null,Nt=d===d,ln=rl(d);if(!_t&&!ln&&!Ue&&u>d||Ue&&lt&&Nt&&!_t&&!ln||U&&lt&&Nt||!P&&Nt||!ve)return 1;if(!U&&!Ue&&!ln&&u<d||ln&&P&&ve&&!U&&!Ue||_t&&P&&ve||!lt&&ve||!Nt)return-1}return 0}function X4(u,d,P){for(var U=-1,ve=u.criteria,Ue=d.criteria,lt=ve.length,_t=P.length;++U<lt;){var Nt=Mm(ve[U],Ue[U]);if(Nt){if(U>=_t)return Nt;var ln=P[U];return Nt*(ln=="desc"?-1:1)}}return u.index-d.index}function Tm(u,d,P,U){for(var ve=-1,Ue=u.length,lt=P.length,_t=-1,Nt=d.length,ln=K(Ue-lt,0),un=Rt(Nt+ln),vn=!U;++_t<Nt;)un[_t]=d[_t];for(;++ve<lt;)(vn||ve<Ue)&&(un[P[ve]]=u[ve]);for(;ln--;)un[_t++]=u[ve++];return un}function Bm(u,d,P,U){for(var ve=-1,Ue=u.length,lt=-1,_t=P.length,Nt=-1,ln=d.length,un=K(Ue-_t,0),vn=Rt(un+ln),In=!U;++ve<un;)vn[ve]=u[ve];for(var ei=ve;++Nt<ln;)vn[ei+Nt]=d[Nt];for(;++lt<_t;)(In||ve<Ue)&&(vn[ei+P[lt]]=u[ve++]);return vn}function Ia(u,d){var P=-1,U=u.length;for(d||(d=Rt(U));++P<U;)d[P]=u[P];return d}function du(u,d,P,U){var ve=!P;P||(P={});for(var Ue=-1,lt=d.length;++Ue<lt;){var _t=d[Ue],Nt=U?U(P[_t],u[_t],_t,P,u):t;Nt===t&&(Nt=u[_t]),ve?Tn(P,_t,Nt):vt(P,_t,Nt)}return P}function Q4(u,d){return du(u,n0(u),d)}function eb(u,d){return du(u,Vm(u),d)}function rd(u,d){return function(P,U){var ve=zi(P)?lu:tn,Ue=d?d():{};return ve(P,u,vi(U,2),Ue)}}function Ch(u){return Ki(function(d,P){var U=-1,ve=P.length,Ue=ve>1?P[ve-1]:t,lt=ve>2?P[2]:t;for(Ue=u.length>3&&typeof Ue=="function"?(ve--,Ue):t,lt&&va(P[0],P[1],lt)&&(Ue=ve<3?t:Ue,ve=1),d=ur(d);++U<ve;){var _t=P[U];_t&&u(d,_t,U,Ue)}return d})}function Nm(u,d){return function(P,U){if(P==null)return P;if(!Fa(P))return u(P,U);for(var ve=P.length,Ue=d?ve:-1,lt=ur(P);(d?Ue--:++Ue<ve)&&U(lt[Ue],Ue,lt)!==!1;);return P}}function Dm(u){return function(d,P,U){for(var ve=-1,Ue=ur(d),lt=U(d),_t=lt.length;_t--;){var Nt=lt[u?_t:++ve];if(P(Ue[Nt],Nt,Ue)===!1)break}return d}}function tb(u,d,P){var U=d&Q,ve=rf(u);function Ue(){var lt=this&&this!==qr&&this instanceof Ue?ve:u;return lt.apply(U?P:this,arguments)}return Ue}function Rm(u){return function(d){d=Br(d);var P=Mo(d)?ws(d):t,U=P?P[0]:d.charAt(0),ve=P?bl(P,1).join(""):d.slice(1);return U[u]()+ve}}function Sh(u){return function(d){return Ho(N1(B1(d).replace(Zi,"")),u,"")}}function rf(u){return function(){var d=arguments;switch(d.length){case 0:return new u;case 1:return new u(d[0]);case 2:return new u(d[0],d[1]);case 3:return new u(d[0],d[1],d[2]);case 4:return new u(d[0],d[1],d[2],d[3]);case 5:return new u(d[0],d[1],d[2],d[3],d[4]);case 6:return new u(d[0],d[1],d[2],d[3],d[4],d[5]);case 7:return new u(d[0],d[1],d[2],d[3],d[4],d[5],d[6])}var P=Vs(u.prototype),U=u.apply(P,d);return Es(U)?U:P}}function nb(u,d,P){var U=rf(u);function ve(){for(var Ue=arguments.length,lt=Rt(Ue),_t=Ue,Nt=Ph(ve);_t--;)lt[_t]=arguments[_t];var ln=Ue<3&&lt[0]!==Nt&&lt[Ue-1]!==Nt?[]:Ds(lt,Nt);if(Ue-=ln.length,Ue<P)return jm(u,d,sd,ve.placeholder,t,lt,ln,t,t,P-Ue);var un=this&&this!==qr&&this instanceof ve?U:u;return or(un,this,lt)}return ve}function Om(u){return function(d,P,U){var ve=ur(d);if(!Fa(d)){var Ue=vi(P,3);d=xo(d),P=function(_t){return Ue(ve[_t],_t,ve)}}var lt=u(d,P,U);return lt>-1?ve[Ue?d[lt]:lt]:t}}function Im(u){return Fu(function(d){var P=d.length,U=P,ve=ps.prototype.thru;for(u&&d.reverse();U--;){var Ue=d[U];if(typeof Ue!="function")throw new Mr(l);if(ve&&!lt&&ud(Ue)=="wrapper")var lt=new ps([],!0)}for(U=lt?U:P;++U<P;){Ue=d[U];var _t=ud(Ue),Nt=_t=="wrapper"?e0(Ue):t;Nt&&r0(Nt[0])&&Nt[1]==(We|pe|Ie|O)&&!Nt[4].length&&Nt[9]==1?lt=lt[ud(Nt[0])].apply(lt,Nt[3]):lt=Ue.length==1&&r0(Ue)?lt[_t]():lt.thru(Ue)}return function(){var ln=arguments,un=ln[0];if(lt&&ln.length==1&&zi(un))return lt.plant(un).value();for(var vn=0,In=P?d[vn].apply(this,ln):un;++vn<P;)In=d[vn].call(this,In);return In}})}function sd(u,d,P,U,ve,Ue,lt,_t,Nt,ln){var un=d&We,vn=d&Q,In=d&F,ei=d&(pe|Ee),_i=d&H,Xi=In?t:rf(u);function bi(){for(var hr=arguments.length,mr=Rt(hr),sl=hr;sl--;)mr[sl]=arguments[sl];if(ei)var ya=Ph(bi),ol=ko(mr,ya);if(U&&(mr=Tm(mr,U,ve,ei)),Ue&&(mr=Bm(mr,Ue,lt,ei)),hr-=ol,ei&&hr<ln){var Zs=Ds(mr,ya);return jm(u,d,sd,bi.placeholder,P,mr,Zs,_t,Nt,ln-hr)}var Gl=vn?P:this,$u=In?Gl[u]:u;return hr=mr.length,_t?mr=xb(mr,_t):_i&&hr>1&&mr.reverse(),un&&Nt<hr&&(mr.length=Nt),this&&this!==qr&&this instanceof bi&&($u=Xi||rf($u)),$u.apply(Gl,mr)}return bi}function Fm(u,d){return function(P,U){return Ce(P,u,d(U),{})}}function od(u,d){return function(P,U){var ve;if(P===t&&U===t)return d;if(P!==t&&(ve=P),U!==t){if(ve===t)return U;typeof P=="string"||typeof U=="string"?(P=ea(P),U=ea(U)):(P=id(P),U=id(U)),ve=u(P,U)}return ve}}function Jp(u){return Fu(function(d){return d=ar(d,Mi(vi())),Ki(function(P){var U=this;return u(d,function(ve){return or(ve,U,P)})})})}function ad(u,d){d=d===t?" ":ea(d);var P=d.length;if(P<2)return P?bh(d,u):d;var U=bh(d,hs(u/bs(d)));return Mo(d)?bl(ws(U),0,u).join(""):U.slice(0,u)}function ib(u,d,P,U){var ve=d&Q,Ue=rf(u);function lt(){for(var _t=-1,Nt=arguments.length,ln=-1,un=U.length,vn=Rt(un+Nt),In=this&&this!==qr&&this instanceof lt?Ue:u;++ln<un;)vn[ln]=U[ln];for(;Nt--;)vn[ln++]=arguments[++_t];return or(In,ve?P:this,vn)}return lt}function zm(u){return function(d,P,U){return U&&typeof U!="number"&&va(d,P,U)&&(P=U=t),d=Uu(d),P===t?(P=d,d=0):P=Uu(P),U=U===t?d<P?1:-1:Uu(U),Fc(d,P,U,u)}}function ld(u){return function(d,P){return typeof d=="string"&&typeof P=="string"||(d=xl(d),P=xl(P)),u(d,P)}}function jm(u,d,P,U,ve,Ue,lt,_t,Nt,ln){var un=d&pe,vn=un?lt:t,In=un?t:lt,ei=un?Ue:t,_i=un?t:Ue;d|=un?Ie:nt,d&=~(un?nt:Ie),d&V||(d&=-4);var Xi=[u,d,ve,ei,vn,_i,In,_t,Nt,ln],bi=P.apply(t,Xi);return r0(u)&&Xm(bi,Xi),bi.placeholder=U,Qm(bi,u,d)}function Yp(u){var d=kr[u];return function(P,U){if(P=xl(P),U=U==null?0:we(Ji(U),292),U&&f(P)){var ve=(Br(P)+"e").split("e"),Ue=d(ve[0]+"e"+(+ve[1]+U));return ve=(Br(Ue)+"e").split("e"),+(ve[0]+"e"+(+ve[1]-U))}return d(P)}}var rb=ns&&1/Rs(new ns([,-0]))[1]==se?function(u){return new ns(u)}:_0;function Um(u){return function(d){var P=ta(d);return P==Le?Ra(d):P==ze?uu(d):Qr(d,u(d))}}function Iu(u,d,P,U,ve,Ue,lt,_t){var Nt=d&F;if(!Nt&&typeof u!="function")throw new Mr(l);var ln=U?U.length:0;if(ln||(d&=-97,U=ve=t),lt=lt===t?lt:K(Ji(lt),0),_t=_t===t?_t:Ji(_t),ln-=ve?ve.length:0,d&nt){var un=U,vn=ve;U=ve=t}var In=Nt?t:e0(u),ei=[u,d,P,U,ve,un,vn,Ue,lt,_t];if(In&&_b(ei,In),u=ei[0],d=ei[1],P=ei[2],U=ei[3],ve=ei[4],_t=ei[9]=ei[9]===t?Nt?0:u.length:K(ei[9]-ln,0),!_t&&d&(pe|Ee)&&(d&=-25),!d||d==Q)var _i=tb(u,d,P);else d==pe||d==Ee?_i=nb(u,d,_t):(d==Ie||d==(Q|Ie))&&!ve.length?_i=ib(u,d,P,U):_i=sd.apply(t,ei);var Xi=In?zl:Xm;return Qm(Xi(_i,ei),u,d)}function $m(u,d,P,U){return u===t||ql(u,No[P])&&!Ii.call(U,P)?d:u}function qm(u,d,P,U,ve,Ue){return Es(u)&&Es(d)&&(Ue.set(d,u),Fo(u,d,t,qm,Ue),Ue.delete(d)),u}function sb(u){return af(u)?t:u}function Gm(u,d,P,U,ve,Ue){var lt=P&D,_t=u.length,Nt=d.length;if(_t!=Nt&&!(lt&&Nt>_t))return!1;var ln=Ue.get(u),un=Ue.get(d);if(ln&&un)return ln==d&&un==u;var vn=-1,In=!0,ei=P&j?new N:t;for(Ue.set(u,d),Ue.set(d,u);++vn<_t;){var _i=u[vn],Xi=d[vn];if(U)var bi=lt?U(Xi,_i,vn,d,u,Ue):U(_i,Xi,vn,u,d,Ue);if(bi!==t){if(bi)continue;In=!1;break}if(ei){if(!k(d,function(hr,mr){if(!Da(ei,mr)&&(_i===hr||ve(_i,hr,P,U,Ue)))return ei.push(mr)})){In=!1;break}}else if(!(_i===Xi||ve(_i,Xi,P,U,Ue))){In=!1;break}}return Ue.delete(u),Ue.delete(d),In}function ob(u,d,P,U,ve,Ue,lt){switch(P){case tt:if(u.byteLength!=d.byteLength||u.byteOffset!=d.byteOffset)return!1;u=u.buffer,d=d.buffer;case nn:return!(u.byteLength!=d.byteLength||!Ue(new co(u),new co(d)));case re:case ee:case ye:return ql(+u,+d);case Se:return u.name==d.name&&u.message==d.message;case Ve:case st:return u==d+"";case Le:var _t=Ra;case ze:var Nt=U&D;if(_t||(_t=Rs),u.size!=d.size&&!Nt)return!1;var ln=lt.get(u);if(ln)return ln==d;U|=j,lt.set(u,d);var un=Gm(_t(u),_t(d),U,ve,Ue,lt);return lt.delete(u),un;case Qe:if(nr)return nr.call(u)==nr.call(d)}return!1}function ab(u,d,P,U,ve,Ue){var lt=P&D,_t=Xp(u),Nt=_t.length,ln=Xp(d),un=ln.length;if(Nt!=un&&!lt)return!1;for(var vn=Nt;vn--;){var In=_t[vn];if(!(lt?In in d:Ii.call(d,In)))return!1}var ei=Ue.get(u),_i=Ue.get(d);if(ei&&_i)return ei==d&&_i==u;var Xi=!0;Ue.set(u,d),Ue.set(d,u);for(var bi=lt;++vn<Nt;){In=_t[vn];var hr=u[In],mr=d[In];if(U)var sl=lt?U(mr,hr,In,d,u,Ue):U(hr,mr,In,u,d,Ue);if(!(sl===t?hr===mr||ve(hr,mr,P,U,Ue):sl)){Xi=!1;break}bi||(bi=In=="constructor")}if(Xi&&!bi){var ya=u.constructor,ol=d.constructor;ya!=ol&&"constructor"in u&&"constructor"in d&&!(typeof ya=="function"&&ya instanceof ya&&typeof ol=="function"&&ol instanceof ol)&&(Xi=!1)}return Ue.delete(u),Ue.delete(d),Xi}function Fu(u){return o0(Jm(u,t,s1),u+"")}function Xp(u){return Ye(u,xo,n0)}function Qp(u){return Ye(u,za,Vm)}var e0=Tr?function(u){return Tr.get(u)}:_0;function ud(u){for(var d=u.name+"",P=Gs[d],U=Ii.call(Gs,d)?P.length:0;U--;){var ve=P[U],Ue=ve.func;if(Ue==null||Ue==u)return ve.name}return d}function Ph(u){var d=Ii.call(Ne,"placeholder")?Ne:u;return d.placeholder}function vi(){var u=Ne.iteratee||v0;return u=u===v0?Jn:u,arguments.length?u(arguments[0],arguments[1]):u}function cd(u,d){var P=u.__data__;return gb(d)?P[typeof d=="string"?"string":"hash"]:P.map}function t0(u){for(var d=xo(u),P=d.length;P--;){var U=d[P],ve=u[U];d[P]=[U,ve,Zm(ve)]}return d}function jc(u,d){var P=es(u,d);return Bt(P)?P:t}function lb(u){var d=Ii.call(u,Yo),P=u[Yo];try{u[Yo]=t;var U=!0}catch{}var ve=cr.call(u);return U&&(d?u[Yo]=P:delete u[Yo]),ve}var n0=bo?function(u){return u==null?[]:(u=ur(u),vo(bo(u),function(d){return yr.call(u,d)}))}:b0,Vm=bo?function(u){for(var d=[];u;)to(d,n0(u)),u=Oo(u);return d}:b0,ta=at;(Nn&&ta(new Nn(new ArrayBuffer(1)))!=tt||Zn&&ta(new Zn)!=Le||Ei&&ta(Ei.resolve())!=De||ns&&ta(new ns)!=ze||Or&&ta(new Or)!=wt)&&(ta=function(u){var d=at(u),P=d==Oe?u.constructor:t,U=P?Uc(P):"";if(U)switch(U){case Bu:return tt;case Io:return Le;case wo:return De;case ho:return ze;case Nc:return wt}return d});function ub(u,d,P){for(var U=-1,ve=P.length;++U<ve;){var Ue=P[U],lt=Ue.size;switch(Ue.type){case"drop":u+=lt;break;case"dropRight":d-=lt;break;case"take":d=we(d,u+lt);break;case"takeRight":u=K(u,d-lt);break}}return{start:u,end:d}}function cb(u){var d=u.match(Ci);return d?d[1].split(qi):[]}function Hm(u,d,P){d=$l(d,u);for(var U=-1,ve=d.length,Ue=!1;++U<ve;){var lt=pu(d[U]);if(!(Ue=u!=null&&P(u,lt)))break;u=u[lt]}return Ue||++U!=ve?Ue:(ve=u==null?0:u.length,!!ve&&vd(ve)&&zu(lt,ve)&&(zi(u)||$c(u)))}function hb(u){var d=u.length,P=new u.constructor(d);return d&&typeof u[0]=="string"&&Ii.call(u,"index")&&(P.index=u.index,P.input=u.input),P}function Wm(u){return typeof u.constructor=="function"&&!sf(u)?Vs(Oo(u)):{}}function fb(u,d,P){var U=u.constructor;switch(d){case nn:return Kp(u);case re:case ee:return new U(+u);case tt:return K4(u,P);case Qt:case rn:case it:case Ke:case qt:case mn:case xn:case wn:case ot:return km(u,P);case Le:return new U;case ye:case st:return new U(u);case Ve:return J4(u);case ze:return new U;case Qe:return Y4(u)}}function db(u,d){var P=d.length;if(!P)return u;var U=P-1;return d[U]=(P>1?"& ":"")+d[U],d=d.join(P>2?", ":" "),u.replace(yn,`{
/* [wrapped with `+d+`] */
`)}function pb(u){return zi(u)||$c(u)||!!(qs&&u&&u[qs])}function zu(u,d){var P=typeof u;return d=d??ie,!!d&&(P=="number"||P!="symbol"&&xr.test(u))&&u>-1&&u%1==0&&u<d}function va(u,d,P){if(!Es(P))return!1;var U=typeof d;return(U=="number"?Fa(P)&&zu(d,P.length):U=="string"&&d in P)?ql(P[d],u):!1}function i0(u,d){if(zi(u))return!1;var P=typeof u;return P=="number"||P=="symbol"||P=="boolean"||u==null||rl(u)?!0:Li.test(u)||!ri.test(u)||d!=null&&u in ur(d)}function gb(u){var d=typeof u;return d=="string"||d=="number"||d=="symbol"||d=="boolean"?u!=="__proto__":u===null}function r0(u){var d=ud(u),P=Ne[d];if(typeof P!="function"||!(d in Ti.prototype))return!1;if(u===P)return!0;var U=e0(P);return!!U&&u===U[0]}function mb(u){return!!cs&&cs in u}var vb=Do?ju:w0;function sf(u){var d=u&&u.constructor,P=typeof d=="function"&&d.prototype||No;return u===P}function Zm(u){return u===u&&!Es(u)}function Km(u,d){return function(P){return P==null?!1:P[u]===d&&(d!==t||u in ur(P))}}function yb(u){var d=gd(u,function(U){return P.size===m&&P.clear(),U}),P=d.cache;return d}function _b(u,d){var P=u[1],U=d[1],ve=P|U,Ue=ve<(Q|F|We),lt=U==We&&P==pe||U==We&&P==O&&u[7].length<=d[8]||U==(We|O)&&d[7].length<=d[8]&&P==pe;if(!(Ue||lt))return u;U&Q&&(u[2]=d[2],ve|=P&Q?0:V);var _t=d[3];if(_t){var Nt=u[3];u[3]=Nt?Tm(Nt,_t,d[4]):_t,u[4]=Nt?Ds(u[3],_):d[4]}return _t=d[5],_t&&(Nt=u[5],u[5]=Nt?Bm(Nt,_t,d[6]):_t,u[6]=Nt?Ds(u[5],_):d[6]),_t=d[7],_t&&(u[7]=_t),U&We&&(u[8]=u[8]==null?d[8]:we(u[8],d[8])),u[9]==null&&(u[9]=d[9]),u[0]=d[0],u[1]=ve,u}function bb(u){var d=[];if(u!=null)for(var P in ur(u))d.push(P);return d}function wb(u){return cr.call(u)}function Jm(u,d,P){return d=K(d===t?u.length-1:d,0),function(){for(var U=arguments,ve=-1,Ue=K(U.length-d,0),lt=Rt(Ue);++ve<Ue;)lt[ve]=U[d+ve];ve=-1;for(var _t=Rt(d+1);++ve<d;)_t[ve]=U[ve];return _t[d]=P(lt),or(u,this,_t)}}function Ym(u,d){return d.length<2?u:ti(u,Oa(d,0,-1))}function xb(u,d){for(var P=u.length,U=we(d.length,P),ve=Ia(u);U--;){var Ue=d[U];u[U]=zu(Ue,P)?ve[Ue]:t}return u}function s0(u,d){if(!(d==="constructor"&&typeof u[d]=="function")&&d!="__proto__")return u[d]}var Xm=e1(zl),of=Tu||function(u,d){return qr.setTimeout(u,d)},o0=e1(ed);function Qm(u,d,P){var U=d+"";return o0(u,db(U,Lb(cb(U),P)))}function e1(u){var d=0,P=0;return function(){var U=ct(),ve=Y-(U-P);if(P=U,ve>0){if(++d>=I)return arguments[0]}else d=0;return u.apply(t,arguments)}}function hd(u,d){var P=-1,U=u.length,ve=U-1;for(d=d===t?U:d;++P<d;){var Ue=Ic(P,ve),lt=u[Ue];u[Ue]=u[P],u[P]=lt}return u.length=d,u}var t1=yb(function(u){var d=[];return u.charCodeAt(0)===46&&d.push(""),u.replace(Sn,function(P,U,ve,Ue){d.push(ve?Ue.replace(fr,"$1"):U||P)}),d});function pu(u){if(typeof u=="string"||rl(u))return u;var d=u+"";return d=="0"&&1/u==-1/0?"-0":d}function Uc(u){if(u!=null){try{return Ro.call(u)}catch{}try{return u+""}catch{}}return""}function Lb(u,d){return ls(B,function(P){var U="_."+P[0];d&P[1]&&!Ba(u,U)&&u.push(U)}),u.sort()}function n1(u){if(u instanceof Ti)return u.clone();var d=new ps(u.__wrapped__,u.__chain__);return d.__actions__=Ia(u.__actions__),d.__index__=u.__index__,d.__values__=u.__values__,d}function Cb(u,d,P){(P?va(u,d,P):d===t)?d=1:d=K(Ji(d),0);var U=u==null?0:u.length;if(!U||d<1)return[];for(var ve=0,Ue=0,lt=Rt(hs(U/d));ve<U;)lt[Ue++]=Oa(u,ve,ve+=d);return lt}function Sb(u){for(var d=-1,P=u==null?0:u.length,U=0,ve=[];++d<P;){var Ue=u[d];Ue&&(ve[U++]=Ue)}return ve}function Pb(){var u=arguments.length;if(!u)return[];for(var d=Rt(u-1),P=arguments[0],U=u;U--;)d[U-1]=arguments[U];return to(zi(P)?Ia(P):[P],He(d,1))}var Eb=Ki(function(u,d){return Ws(u)?C(u,He(d,1,Ws,!0)):[]}),Ab=Ki(function(u,d){var P=wl(d);return Ws(P)&&(P=t),Ws(u)?C(u,He(d,1,Ws,!0),vi(P,2)):[]}),kb=Ki(function(u,d){var P=wl(d);return Ws(P)&&(P=t),Ws(u)?C(u,He(d,1,Ws,!0),t,P):[]});function Mb(u,d,P){var U=u==null?0:u.length;return U?(d=P||d===t?1:Ji(d),Oa(u,d<0?0:d,U)):[]}function Tb(u,d,P){var U=u==null?0:u.length;return U?(d=P||d===t?1:Ji(d),d=U-d,Oa(u,0,d<0?0:d)):[]}function Bb(u,d){return u&&u.length?Ou(u,vi(d,3),!0,!0):[]}function Nb(u,d){return u&&u.length?Ou(u,vi(d,3),!0):[]}function Db(u,d,P,U){var ve=u==null?0:u.length;return ve?(P&&typeof P!="number"&&va(u,d,P)&&(P=0,U=ve),be(u,d,P,U)):[]}function i1(u,d,P){var U=u==null?0:u.length;if(!U)return-1;var ve=P==null?0:Ji(P);return ve<0&&(ve=K(U+ve,0)),Ut(u,vi(d,3),ve)}function r1(u,d,P){var U=u==null?0:u.length;if(!U)return-1;var ve=U-1;return P!==t&&(ve=Ji(P),ve=P<0?K(U+ve,0):we(ve,U-1)),Ut(u,vi(d,3),ve,!0)}function s1(u){var d=u==null?0:u.length;return d?He(u,1):[]}function Rb(u){var d=u==null?0:u.length;return d?He(u,se):[]}function Ob(u,d){var P=u==null?0:u.length;return P?(d=d===t?1:Ji(d),He(u,d)):[]}function Ib(u){for(var d=-1,P=u==null?0:u.length,U={};++d<P;){var ve=u[d];U[ve[0]]=ve[1]}return U}function o1(u){return u&&u.length?u[0]:t}function Fb(u,d,P){var U=u==null?0:u.length;if(!U)return-1;var ve=P==null?0:Ji(P);return ve<0&&(ve=K(U+ve,0)),cn(u,d,ve)}function zb(u){var d=u==null?0:u.length;return d?Oa(u,0,-1):[]}var jb=Ki(function(u){var d=ar(u,ac);return d.length&&d[0]===u[0]?fe(d):[]}),Ub=Ki(function(u){var d=wl(u),P=ar(u,ac);return d===wl(P)?d=t:P.pop(),P.length&&P[0]===u[0]?fe(P,vi(d,2)):[]}),$b=Ki(function(u){var d=wl(u),P=ar(u,ac);return d=typeof d=="function"?d:t,d&&P.pop(),P.length&&P[0]===u[0]?fe(P,t,d):[]});function qb(u,d){return u==null?"":x.call(u,d)}function wl(u){var d=u==null?0:u.length;return d?u[d-1]:t}function Gb(u,d,P){var U=u==null?0:u.length;if(!U)return-1;var ve=U;return P!==t&&(ve=Ji(P),ve=ve<0?K(U+ve,0):we(ve,U-1)),d===d?Wo(u,d,ve):Ut(u,Rn,ve,!0)}function Vb(u,d){return u&&u.length?ma(u,Ji(d)):t}var Hb=Ki(a1);function a1(u,d){return u&&u.length&&d&&d.length?_h(u,d):u}function Wb(u,d,P){return u&&u.length&&d&&d.length?_h(u,d,vi(P,2)):u}function Zb(u,d,P){return u&&u.length&&d&&d.length?_h(u,d,t,P):u}var Kb=Fu(function(u,d){var P=u==null?0:u.length,U=An(u,d);return Oc(u,ar(d,function(ve){return zu(ve,P)?+ve:ve}).sort(Mm)),U});function Jb(u,d){var P=[];if(!(u&&u.length))return P;var U=-1,ve=[],Ue=u.length;for(d=vi(d,3);++U<Ue;){var lt=u[U];d(lt,U,u)&&(P.push(lt),ve.push(U))}return Oc(u,ve),P}function a0(u){return u==null?u:an.call(u)}function Yb(u,d,P){var U=u==null?0:u.length;return U?(P&&typeof P!="number"&&va(u,d,P)?(d=0,P=U):(d=d==null?0:Ji(d),P=P===t?U:Ji(P)),Oa(u,d,P)):[]}function Xb(u,d){return jl(u,d)}function Qb(u,d,P){return tf(u,d,vi(P,2))}function e5(u,d){var P=u==null?0:u.length;if(P){var U=jl(u,d);if(U<P&&ql(u[U],d))return U}return-1}function t5(u,d){return jl(u,d,!0)}function n5(u,d,P){return tf(u,d,vi(P,2),!0)}function i5(u,d){var P=u==null?0:u.length;if(P){var U=jl(u,d,!0)-1;if(ql(u[U],d))return U}return-1}function r5(u){return u&&u.length?nf(u):[]}function s5(u,d){return u&&u.length?nf(u,vi(d,2)):[]}function o5(u){var d=u==null?0:u.length;return d?Oa(u,1,d):[]}function a5(u,d,P){return u&&u.length?(d=P||d===t?1:Ji(d),Oa(u,0,d<0?0:d)):[]}function l5(u,d,P){var U=u==null?0:u.length;return U?(d=P||d===t?1:Ji(d),d=U-d,Oa(u,d<0?0:d,U)):[]}function u5(u,d){return u&&u.length?Ou(u,vi(d,3),!1,!0):[]}function c5(u,d){return u&&u.length?Ou(u,vi(d,3)):[]}var h5=Ki(function(u){return fu(He(u,1,Ws,!0))}),f5=Ki(function(u){var d=wl(u);return Ws(d)&&(d=t),fu(He(u,1,Ws,!0),vi(d,2))}),d5=Ki(function(u){var d=wl(u);return d=typeof d=="function"?d:t,fu(He(u,1,Ws,!0),t,d)});function p5(u){return u&&u.length?fu(u):[]}function g5(u,d){return u&&u.length?fu(u,vi(d,2)):[]}function m5(u,d){return d=typeof d=="function"?d:t,u&&u.length?fu(u,t,d):[]}function l0(u){if(!(u&&u.length))return[];var d=0;return u=vo(u,function(P){if(Ws(P))return d=K(P.length,d),!0}),Hr(d,function(P){return ar(u,ci(P))})}function l1(u,d){if(!(u&&u.length))return[];var P=l0(u);return d==null?P:ar(P,function(U){return or(d,t,U)})}var v5=Ki(function(u,d){return Ws(u)?C(u,d):[]}),y5=Ki(function(u){return _l(vo(u,Ws))}),_5=Ki(function(u){var d=wl(u);return Ws(d)&&(d=t),_l(vo(u,Ws),vi(d,2))}),b5=Ki(function(u){var d=wl(u);return d=typeof d=="function"?d:t,_l(vo(u,Ws),t,d)}),w5=Ki(l0);function x5(u,d){return Ul(u||[],d||[],vt)}function L5(u,d){return Ul(u||[],d||[],Du)}var C5=Ki(function(u){var d=u.length,P=d>1?u[d-1]:t;return P=typeof P=="function"?(u.pop(),P):t,l1(u,P)});function u1(u){var d=Ne(u);return d.__chain__=!0,d}function S5(u,d){return d(u),u}function fd(u,d){return d(u)}var P5=Fu(function(u){var d=u.length,P=d?u[0]:0,U=this.__wrapped__,ve=function(Ue){return An(Ue,u)};return d>1||this.__actions__.length||!(U instanceof Ti)||!zu(P)?this.thru(ve):(U=U.slice(P,+P+(d?1:0)),U.__actions__.push({func:fd,args:[ve],thisArg:t}),new ps(U,this.__chain__).thru(function(Ue){return d&&!Ue.length&&Ue.push(t),Ue}))});function E5(){return u1(this)}function A5(){return new ps(this.value(),this.__chain__)}function k5(){this.__values__===t&&(this.__values__=L1(this.value()));var u=this.__index__>=this.__values__.length,d=u?t:this.__values__[this.__index__++];return{done:u,value:d}}function M5(){return this}function T5(u){for(var d,P=this;P instanceof Il;){var U=n1(P);U.__index__=0,U.__values__=t,d?ve.__wrapped__=U:d=U;var ve=U;P=P.__wrapped__}return ve.__wrapped__=u,d}function B5(){var u=this.__wrapped__;if(u instanceof Ti){var d=u;return this.__actions__.length&&(d=new Ti(this)),d=d.reverse(),d.__actions__.push({func:fd,args:[a0],thisArg:t}),new ps(d,this.__chain__)}return this.thru(a0)}function N5(){return yl(this.__wrapped__,this.__actions__)}var D5=rd(function(u,d,P){Ii.call(u,P)?++u[P]:Tn(u,P,1)});function R5(u,d,P){var U=zi(u)?tl:q;return P&&va(u,d,P)&&(d=t),U(u,vi(d,3))}function O5(u,d){var P=zi(u)?vo:Xe;return P(u,vi(d,3))}var I5=Om(i1),F5=Om(r1);function z5(u,d){return He(dd(u,d),1)}function j5(u,d){return He(dd(u,d),se)}function U5(u,d,P){return P=P===t?1:Ji(P),He(dd(u,d),P)}function c1(u,d){var P=zi(u)?ls:M;return P(u,vi(d,3))}function h1(u,d){var P=zi(u)?mo:z;return P(u,vi(d,3))}var $5=rd(function(u,d,P){Ii.call(u,P)?u[P].push(d):Tn(u,P,[d])});function q5(u,d,P,U){u=Fa(u)?u:Ah(u),P=P&&!U?Ji(P):0;var ve=u.length;return P<0&&(P=K(ve+P,0)),yd(u)?P<=ve&&u.indexOf(d,P)>-1:!!ve&&cn(u,d,P)>-1}var G5=Ki(function(u,d,P){var U=-1,ve=typeof d=="function",Ue=Fa(u)?Rt(u.length):[];return M(u,function(lt){Ue[++U]=ve?or(d,lt,P):je(lt,d,P)}),Ue}),V5=rd(function(u,d,P){Tn(u,P,d)});function dd(u,d){var P=zi(u)?ar:br;return P(u,vi(d,3))}function H5(u,d,P,U){return u==null?[]:(zi(d)||(d=d==null?[]:[d]),P=U?t:P,zi(P)||(P=P==null?[]:[P]),hu(u,d,P))}var W5=rd(function(u,d,P){u[P?0:1].push(d)},function(){return[[],[]]});function Z5(u,d,P){var U=zi(u)?Ho:Sr,ve=arguments.length<3;return U(u,vi(d,4),P,ve,M)}function K5(u,d,P){var U=zi(u)?Vr:Sr,ve=arguments.length<3;return U(u,vi(d,4),P,ve,z)}function J5(u,d){var P=zi(u)?vo:Xe;return P(u,md(vi(d,3)))}function Y5(u){var d=zi(u)?zt:wh;return d(u)}function X5(u,d,P){(P?va(u,d,P):d===t)?d=1:d=Ji(d);var U=zi(u)?Et:Qf;return U(u,d)}function Q5(u){var d=zi(u)?Kt:td;return d(u)}function ew(u){if(u==null)return 0;if(Fa(u))return yd(u)?bs(u):u.length;var d=ta(u);return d==Le||d==ze?u.size:ir(u).length}function tw(u,d,P){var U=zi(u)?k:nd;return P&&va(u,d,P)&&(d=t),U(u,vi(d,3))}var nw=Ki(function(u,d){if(u==null)return[];var P=d.length;return P>1&&va(u,d[0],d[1])?d=[]:P>2&&va(d[0],d[1],d[2])&&(d=[d[0]]),hu(u,He(d,1),[])}),pd=Is||function(){return qr.Date.now()};function iw(u,d){if(typeof d!="function")throw new Mr(l);return u=Ji(u),function(){if(--u<1)return d.apply(this,arguments)}}function f1(u,d,P){return d=P?t:d,d=u&&d==null?u.length:d,Iu(u,We,t,t,t,t,d)}function d1(u,d){var P;if(typeof d!="function")throw new Mr(l);return u=Ji(u),function(){return--u>0&&(P=d.apply(this,arguments)),u<=1&&(d=t),P}}var u0=Ki(function(u,d,P){var U=Q;if(P.length){var ve=Ds(P,Ph(u0));U|=Ie}return Iu(u,U,d,P,ve)}),p1=Ki(function(u,d,P){var U=Q|F;if(P.length){var ve=Ds(P,Ph(p1));U|=Ie}return Iu(d,U,u,P,ve)});function g1(u,d,P){d=P?t:d;var U=Iu(u,pe,t,t,t,t,t,d);return U.placeholder=g1.placeholder,U}function m1(u,d,P){d=P?t:d;var U=Iu(u,Ee,t,t,t,t,t,d);return U.placeholder=m1.placeholder,U}function v1(u,d,P){var U,ve,Ue,lt,_t,Nt,ln=0,un=!1,vn=!1,In=!0;if(typeof u!="function")throw new Mr(l);d=xl(d)||0,Es(P)&&(un=!!P.leading,vn="maxWait"in P,Ue=vn?K(xl(P.maxWait)||0,d):Ue,In="trailing"in P?!!P.trailing:In);function ei(Zs){var Gl=U,$u=ve;return U=ve=t,ln=Zs,lt=u.apply($u,Gl),lt}function _i(Zs){return ln=Zs,_t=of(hr,d),un?ei(Zs):lt}function Xi(Zs){var Gl=Zs-Nt,$u=Zs-ln,O1=d-Gl;return vn?we(O1,Ue-$u):O1}function bi(Zs){var Gl=Zs-Nt,$u=Zs-ln;return Nt===t||Gl>=d||Gl<0||vn&&$u>=Ue}function hr(){var Zs=pd();if(bi(Zs))return mr(Zs);_t=of(hr,Xi(Zs))}function mr(Zs){return _t=t,In&&U?ei(Zs):(U=ve=t,lt)}function sl(){_t!==t&&Lh(_t),ln=0,U=Nt=ve=_t=t}function ya(){return _t===t?lt:mr(pd())}function ol(){var Zs=pd(),Gl=bi(Zs);if(U=arguments,ve=this,Nt=Zs,Gl){if(_t===t)return _i(Nt);if(vn)return Lh(_t),_t=of(hr,d),ei(Nt)}return _t===t&&(_t=of(hr,d)),lt}return ol.cancel=sl,ol.flush=ya,ol}var rw=Ki(function(u,d){return y(u,1,d)}),sw=Ki(function(u,d,P){return y(u,xl(d)||0,P)});function ow(u){return Iu(u,H)}function gd(u,d){if(typeof u!="function"||d!=null&&typeof d!="function")throw new Mr(l);var P=function(){var U=arguments,ve=d?d.apply(this,U):U[0],Ue=P.cache;if(Ue.has(ve))return Ue.get(ve);var lt=u.apply(this,U);return P.cache=Ue.set(ve,lt)||Ue,lt};return P.cache=new(gd.Cache||Qo),P}gd.Cache=Qo;function md(u){if(typeof u!="function")throw new Mr(l);return function(){var d=arguments;switch(d.length){case 0:return!u.call(this);case 1:return!u.call(this,d[0]);case 2:return!u.call(this,d[0],d[1]);case 3:return!u.call(this,d[0],d[1],d[2])}return!u.apply(this,d)}}function aw(u){return d1(2,u)}var lw=Zp(function(u,d){d=d.length==1&&zi(d[0])?ar(d[0],Mi(vi())):ar(He(d,1),Mi(vi()));var P=d.length;return Ki(function(U){for(var ve=-1,Ue=we(U.length,P);++ve<Ue;)U[ve]=d[ve].call(this,U[ve]);return or(u,this,U)})}),c0=Ki(function(u,d){var P=Ds(d,Ph(c0));return Iu(u,Ie,t,d,P)}),y1=Ki(function(u,d){var P=Ds(d,Ph(y1));return Iu(u,nt,t,d,P)}),uw=Fu(function(u,d){return Iu(u,O,t,t,t,d)});function cw(u,d){if(typeof u!="function")throw new Mr(l);return d=d===t?d:Ji(d),Ki(u,d)}function hw(u,d){if(typeof u!="function")throw new Mr(l);return d=d==null?0:K(Ji(d),0),Ki(function(P){var U=P[d],ve=bl(P,0,d);return U&&to(ve,U),or(u,this,ve)})}function fw(u,d,P){var U=!0,ve=!0;if(typeof u!="function")throw new Mr(l);return Es(P)&&(U="leading"in P?!!P.leading:U,ve="trailing"in P?!!P.trailing:ve),v1(u,d,{leading:U,maxWait:d,trailing:ve})}function dw(u){return f1(u,1)}function pw(u,d){return c0(zc(d),u)}function gw(){if(!arguments.length)return[];var u=arguments[0];return zi(u)?u:[u]}function mw(u){return a(u,b)}function vw(u,d){return d=typeof d=="function"?d:t,a(u,b,d)}function yw(u){return a(u,w|b)}function _w(u,d){return d=typeof d=="function"?d:t,a(u,w|b,d)}function bw(u,d){return d==null||g(u,d,xo(d))}function ql(u,d){return u===d||u!==u&&d!==d}var ww=ld(gt),xw=ld(function(u,d){return u>=d}),$c=Fe(function(){return arguments}())?Fe:function(u){return Fs(u)&&Ii.call(u,"callee")&&!yr.call(u,"callee")},zi=Rt.isArray,Lw=gl?Mi(gl):qe;function Fa(u){return u!=null&&vd(u.length)&&!ju(u)}function Ws(u){return Fs(u)&&Fa(u)}function Cw(u){return u===!0||u===!1||Fs(u)&&at(u)==re}var lc=s||w0,Sw=Ao?Mi(Ao):Ge;function Pw(u){return Fs(u)&&u.nodeType===1&&!af(u)}function Ew(u){if(u==null)return!0;if(Fa(u)&&(zi(u)||typeof u=="string"||typeof u.splice=="function"||lc(u)||Eh(u)||$c(u)))return!u.length;var d=ta(u);if(d==Le||d==ze)return!u.size;if(sf(u))return!ir(u).length;for(var P in u)if(Ii.call(u,P))return!1;return!0}function Aw(u,d){return ht(u,d)}function kw(u,d,P){P=typeof P=="function"?P:t;var U=P?P(u,d):t;return U===t?ht(u,d,t,P):!!U}function h0(u){if(!Fs(u))return!1;var d=at(u);return d==Se||d==oe||typeof u.message=="string"&&typeof u.name=="string"&&!af(u)}function Mw(u){return typeof u=="number"&&f(u)}function ju(u){if(!Es(u))return!1;var d=at(u);return d==te||d==ae||d==ne||d==Me}function _1(u){return typeof u=="number"&&u==Ji(u)}function vd(u){return typeof u=="number"&&u>-1&&u%1==0&&u<=ie}function Es(u){var d=typeof u;return u!=null&&(d=="object"||d=="function")}function Fs(u){return u!=null&&typeof u=="object"}var b1=Xa?Mi(Xa):yt;function Tw(u,d){return u===d||Tt(u,d,t0(d))}function Bw(u,d,P){return P=typeof P=="function"?P:t,Tt(u,d,t0(d),P)}function Nw(u){return w1(u)&&u!=+u}function Dw(u){if(vb(u))throw new qn(o);return Bt(u)}function Rw(u){return u===null}function Ow(u){return u==null}function w1(u){return typeof u=="number"||Fs(u)&&at(u)==ye}function af(u){if(!Fs(u)||at(u)!=Oe)return!1;var d=Oo(u);if(d===null)return!0;var P=Ii.call(d,"constructor")&&d.constructor;return typeof P=="function"&&P instanceof P&&Ro.call(P)==pr}var f0=Qa?Mi(Qa):on;function Iw(u){return _1(u)&&u>=-9007199254740991&&u<=ie}var x1=uo?Mi(uo):On;function yd(u){return typeof u=="string"||!zi(u)&&Fs(u)&&at(u)==st}function rl(u){return typeof u=="symbol"||Fs(u)&&at(u)==Qe}var Eh=el?Mi(el):Fn;function Fw(u){return u===t}function zw(u){return Fs(u)&&ta(u)==wt}function jw(u){return Fs(u)&&at(u)==Ht}var Uw=ld(Fi),$w=ld(function(u,d){return u<=d});function L1(u){if(!u)return[];if(Fa(u))return yd(u)?ws(u):Ia(u);if(oi&&u[oi])return Us(u[oi]());var d=ta(u),P=d==Le?Ra:d==ze?Rs:Ah;return P(u)}function Uu(u){if(!u)return u===0?u:0;if(u=xl(u),u===se||u===-1/0){var d=u<0?-1:1;return d*Ae}return u===u?u:0}function Ji(u){var d=Uu(u),P=d%1;return d===d?P?d-P:d:0}function C1(u){return u?Kn(Ji(u),0,ut):0}function xl(u){if(typeof u=="number")return u;if(rl(u))return Te;if(Es(u)){var d=typeof u.valueOf=="function"?u.valueOf():u;u=Es(d)?d+"":d}if(typeof u!="string")return u===0?u:+u;u=no(u);var P=Yi.test(u);return P||kn.test(u)?Ya(u.slice(2),P?2:8):rr.test(u)?Te:+u}function S1(u){return du(u,za(u))}function qw(u){return u?Kn(Ji(u),-9007199254740991,ie):u===0?u:0}function Br(u){return u==null?"":ea(u)}var Gw=Ch(function(u,d){if(sf(d)||Fa(d)){du(d,xo(d),u);return}for(var P in d)Ii.call(d,P)&&vt(u,P,d[P])}),P1=Ch(function(u,d){du(d,za(d),u)}),_d=Ch(function(u,d,P,U){du(d,za(d),u,U)}),Vw=Ch(function(u,d,P,U){du(d,xo(d),u,U)}),Hw=Fu(An);function Ww(u,d){var P=Vs(u);return d==null?P:fn(P,d)}var Zw=Ki(function(u,d){u=ur(u);var P=-1,U=d.length,ve=U>2?d[2]:t;for(ve&&va(d[0],d[1],ve)&&(U=1);++P<U;)for(var Ue=d[P],lt=za(Ue),_t=-1,Nt=lt.length;++_t<Nt;){var ln=lt[_t],un=u[ln];(un===t||ql(un,No[ln])&&!Ii.call(u,ln))&&(u[ln]=Ue[ln])}return u}),Kw=Ki(function(u){return u.push(t,qm),or(E1,t,u)});function Jw(u,d){return kt(u,vi(d,3),en)}function Yw(u,d){return kt(u,vi(d,3),bn)}function Xw(u,d){return u==null?u:xt(u,vi(d,3),za)}function Qw(u,d){return u==null?u:Ot(u,vi(d,3),za)}function e3(u,d){return u&&en(u,vi(d,3))}function t3(u,d){return u&&bn(u,vi(d,3))}function n3(u){return u==null?[]:Pn(u,xo(u))}function i3(u){return u==null?[]:Pn(u,za(u))}function d0(u,d,P){var U=u==null?t:ti(u,d);return U===t?P:U}function r3(u,d){return u!=null&&Hm(u,d,jt)}function p0(u,d){return u!=null&&Hm(u,d,Pt)}var s3=Fm(function(u,d,P){d!=null&&typeof d.toString!="function"&&(d=cr.call(d)),u[d]=P},m0(ja)),o3=Fm(function(u,d,P){d!=null&&typeof d.toString!="function"&&(d=cr.call(d)),Ii.call(u,d)?u[d].push(P):u[d]=[P]},vi),a3=Ki(je);function xo(u){return Fa(u)?Ft(u):ir(u)}function za(u){return Fa(u)?Ft(u,!0):gr(u)}function l3(u,d){var P={};return d=vi(d,3),en(u,function(U,ve,Ue){Tn(P,d(U,ve,Ue),U)}),P}function u3(u,d){var P={};return d=vi(d,3),en(u,function(U,ve,Ue){Tn(P,ve,d(U,ve,Ue))}),P}var c3=Ch(function(u,d,P){Fo(u,d,P)}),E1=Ch(function(u,d,P,U){Fo(u,d,P,U)}),h3=Fu(function(u,d){var P={};if(u==null)return P;var U=!1;d=ar(d,function(Ue){return Ue=$l(Ue,u),U||(U=Ue.length>1),Ue}),du(u,Qp(u),P),U&&(P=a(P,w|E|b,sb));for(var ve=d.length;ve--;)Ru(P,d[ve]);return P});function f3(u,d){return A1(u,md(vi(d)))}var d3=Fu(function(u,d){return u==null?{}:zo(u,d)});function A1(u,d){if(u==null)return{};var P=ar(Qp(u),function(U){return[U]});return d=vi(d),Ps(u,P,function(U,ve){return d(U,ve[0])})}function p3(u,d,P){d=$l(d,u);var U=-1,ve=d.length;for(ve||(ve=1,u=t);++U<ve;){var Ue=u==null?t:u[pu(d[U])];Ue===t&&(U=ve,Ue=P),u=ju(Ue)?Ue.call(u):Ue}return u}function g3(u,d,P){return u==null?u:Du(u,d,P)}function m3(u,d,P,U){return U=typeof U=="function"?U:t,u==null?u:Du(u,d,P,U)}var k1=Um(xo),M1=Um(za);function v3(u,d,P){var U=zi(u),ve=U||lc(u)||Eh(u);if(d=vi(d,4),P==null){var Ue=u&&u.constructor;ve?P=U?new Ue:[]:Es(u)?P=ju(Ue)?Vs(Oo(u)):{}:P={}}return(ve?ls:en)(u,function(lt,_t,Nt){return d(P,lt,_t,Nt)}),P}function y3(u,d){return u==null?!0:Ru(u,d)}function _3(u,d,P){return u==null?u:xh(u,d,zc(P))}function b3(u,d,P,U){return U=typeof U=="function"?U:t,u==null?u:xh(u,d,zc(P),U)}function Ah(u){return u==null?[]:ys(u,xo(u))}function w3(u){return u==null?[]:ys(u,za(u))}function x3(u,d,P){return P===t&&(P=d,d=t),P!==t&&(P=xl(P),P=P===P?P:0),d!==t&&(d=xl(d),d=d===d?d:0),Kn(xl(u),d,P)}function L3(u,d,P){return d=Uu(d),P===t?(P=d,d=0):P=Uu(P),u=xl(u),It(u,d,P)}function C3(u,d,P){if(P&&typeof P!="boolean"&&va(u,d,P)&&(d=P=t),P===t&&(typeof d=="boolean"?(P=d,d=t):typeof u=="boolean"&&(P=u,u=t)),u===t&&d===t?(u=0,d=1):(u=Uu(u),d===t?(d=u,u=0):d=Uu(d)),u>d){var U=u;u=d,d=U}if(P||u%1||d%1){var ve=$t();return we(u+ve*(d-u+Ma("1e-"+((ve+"").length-1))),d)}return Ic(u,d)}var S3=Sh(function(u,d,P){return d=d.toLowerCase(),u+(P?T1(d):d)});function T1(u){return g0(Br(u).toLowerCase())}function B1(u){return u=Br(u),u&&u.replace(Gi,Rl).replace(Nl,"")}function P3(u,d,P){u=Br(u),d=ea(d);var U=u.length;P=P===t?U:Kn(Ji(P),0,U);var ve=P;return P-=d.length,P>=0&&u.slice(P,ve)==d}function E3(u){return u=Br(u),u&&bt.test(u)?u.replace(Dn,da):u}function A3(u){return u=Br(u),u&&ui.test(u)?u.replace(Un,"\\$&"):u}var k3=Sh(function(u,d,P){return u+(P?"-":"")+d.toLowerCase()}),M3=Sh(function(u,d,P){return u+(P?" ":"")+d.toLowerCase()}),T3=Rm("toLowerCase");function B3(u,d,P){u=Br(u),d=Ji(d);var U=d?bs(u):0;if(!d||U>=d)return u;var ve=(d-U)/2;return ad(fs(ve),P)+u+ad(hs(ve),P)}function N3(u,d,P){u=Br(u),d=Ji(d);var U=d?bs(u):0;return d&&U<d?u+ad(d-U,P):u}function D3(u,d,P){u=Br(u),d=Ji(d);var U=d?bs(u):0;return d&&U<d?ad(d-U,P)+u:u}function R3(u,d,P){return P||d==null?d=0:d&&(d=+d),Dt(Br(u).replace(jn,""),d||0)}function O3(u,d,P){return(P?va(u,d,P):d===t)?d=1:d=Ji(d),bh(Br(u),d)}function I3(){var u=arguments,d=Br(u[0]);return u.length<3?d:d.replace(u[1],u[2])}var F3=Sh(function(u,d,P){return u+(P?"_":"")+d.toLowerCase()});function z3(u,d,P){return P&&typeof P!="number"&&va(u,d,P)&&(d=P=t),P=P===t?ut:P>>>0,P?(u=Br(u),u&&(typeof d=="string"||d!=null&&!f0(d))&&(d=ea(d),!d&&Mo(u))?bl(ws(u),0,P):u.split(d,P)):[]}var j3=Sh(function(u,d,P){return u+(P?" ":"")+g0(d)});function U3(u,d,P){return u=Br(u),P=P==null?0:Kn(Ji(P),0,u.length),d=ea(d),u.slice(P,P+d.length)==d}function $3(u,d,P){var U=Ne.templateSettings;P&&va(u,d,P)&&(d=t),u=Br(u),d=_d({},d,U,$m);var ve=_d({},d.imports,U.imports,$m),Ue=xo(ve),lt=ys(ve,Ue),_t,Nt,ln=0,un=d.interpolate||Wi,vn="__p += '",In=nl((d.escape||Wi).source+"|"+un.source+"|"+(un===ni?Hn:Wi).source+"|"+(d.evaluate||Wi).source+"|$","g"),ei="//# sourceURL="+(Ii.call(d,"sourceURL")?(d.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ka+"]")+`
`;u.replace(In,function(bi,hr,mr,sl,ya,ol){return mr||(mr=sl),vn+=u.slice(ln,ol).replace(dr,pa),hr&&(_t=!0,vn+=`' +
__e(`+hr+`) +
'`),ya&&(Nt=!0,vn+=`';
`+ya+`;
__p += '`),mr&&(vn+=`' +
((__t = (`+mr+`)) == null ? '' : __t) +
'`),ln=ol+bi.length,bi}),vn+=`';
`;var _i=Ii.call(d,"variable")&&d.variable;if(!_i)vn=`with (obj) {
`+vn+`
}
`;else if(Qi.test(_i))throw new qn(h);vn=(Nt?vn.replace(de,""):vn).replace(_e,"$1").replace($e,"$1;"),vn="function("+(_i||"obj")+`) {
`+(_i?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(_t?", __e = _.escape":"")+(Nt?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+vn+`return __p
}`;var Xi=D1(function(){return gi(Ue,ei+"return "+vn).apply(t,lt)});if(Xi.source=vn,h0(Xi))throw Xi;return Xi}function q3(u){return Br(u).toLowerCase()}function G3(u){return Br(u).toUpperCase()}function V3(u,d,P){if(u=Br(u),u&&(P||d===t))return no(u);if(!u||!(d=ea(d)))return u;var U=ws(u),ve=ws(d),Ue=Ns(U,ve),lt=ml(U,ve)+1;return bl(U,Ue,lt).join("")}function H3(u,d,P){if(u=Br(u),u&&(P||d===t))return u.slice(0,Zo(u)+1);if(!u||!(d=ea(d)))return u;var U=ws(u),ve=ml(U,ws(d))+1;return bl(U,0,ve).join("")}function W3(u,d,P){if(u=Br(u),u&&(P||d===t))return u.replace(jn,"");if(!u||!(d=ea(d)))return u;var U=ws(u),ve=Ns(U,ws(d));return bl(U,ve).join("")}function Z3(u,d){var P=le,U=G;if(Es(d)){var ve="separator"in d?d.separator:ve;P="length"in d?Ji(d.length):P,U="omission"in d?ea(d.omission):U}u=Br(u);var Ue=u.length;if(Mo(u)){var lt=ws(u);Ue=lt.length}if(P>=Ue)return u;var _t=P-bs(U);if(_t<1)return U;var Nt=lt?bl(lt,0,_t).join(""):u.slice(0,_t);if(ve===t)return Nt+U;if(lt&&(_t+=Nt.length-_t),f0(ve)){if(u.slice(_t).search(ve)){var ln,un=Nt;for(ve.global||(ve=nl(ve.source,Br(ai.exec(ve))+"g")),ve.lastIndex=0;ln=ve.exec(un);)var vn=ln.index;Nt=Nt.slice(0,vn===t?_t:vn)}}else if(u.indexOf(ea(ve),_t)!=_t){var In=Nt.lastIndexOf(ve);In>-1&&(Nt=Nt.slice(0,In))}return Nt+U}function K3(u){return u=Br(u),u&&Ln.test(u)?u.replace(Gt,Ko):u}var J3=Sh(function(u,d,P){return u+(P?" ":"")+d.toUpperCase()}),g0=Rm("toUpperCase");function N1(u,d,P){return u=Br(u),d=P?t:d,d===t?io(u)?To(u):dt(u):u.match(d)||[]}var D1=Ki(function(u,d){try{return or(u,t,d)}catch(P){return h0(P)?P:new qn(P)}}),Y3=Fu(function(u,d){return ls(d,function(P){P=pu(P),Tn(u,P,u0(u[P],u))}),u});function X3(u){var d=u==null?0:u.length,P=vi();return u=d?ar(u,function(U){if(typeof U[1]!="function")throw new Mr(l);return[P(U[0]),U[1]]}):[],Ki(function(U){for(var ve=-1;++ve<d;){var Ue=u[ve];if(or(Ue[0],this,U))return or(Ue[1],this,U)}})}function Q3(u){return c(a(u,w))}function m0(u){return function(){return u}}function ex(u,d){return u==null||u!==u?d:u}var tx=Im(),nx=Im(!0);function ja(u){return u}function v0(u){return Jn(typeof u=="function"?u:a(u,w))}function ix(u){return Hs(a(u,w))}function rx(u,d){return Fl(u,a(d,w))}var sx=Ki(function(u,d){return function(P){return je(P,u,d)}}),ox=Ki(function(u,d){return function(P){return je(u,P,d)}});function y0(u,d,P){var U=xo(d),ve=Pn(d,U);P==null&&!(Es(d)&&(ve.length||!U.length))&&(P=d,d=u,u=this,ve=Pn(d,xo(d)));var Ue=!(Es(P)&&"chain"in P)||!!P.chain,lt=ju(u);return ls(ve,function(_t){var Nt=d[_t];u[_t]=Nt,lt&&(u.prototype[_t]=function(){var ln=this.__chain__;if(Ue||ln){var un=u(this.__wrapped__),vn=un.__actions__=Ia(this.__actions__);return vn.push({func:Nt,args:arguments,thisArg:u}),un.__chain__=ln,un}return Nt.apply(u,to([this.value()],arguments))})}),u}function ax(){return qr._===this&&(qr._=Wr),this}function _0(){}function lx(u){return u=Ji(u),Ki(function(d){return ma(d,u)})}var ux=Jp(ar),cx=Jp(tl),hx=Jp(k);function R1(u){return i0(u)?ci(pu(u)):Zr(u)}function fx(u){return function(d){return u==null?t:ti(u,d)}}var dx=zm(),px=zm(!0);function b0(){return[]}function w0(){return!1}function gx(){return{}}function mx(){return""}function vx(){return!0}function yx(u,d){if(u=Ji(u),u<1||u>ie)return[];var P=ut,U=we(u,ut);d=vi(d),u-=ut;for(var ve=Hr(U,d);++P<u;)d(P);return ve}function _x(u){return zi(u)?ar(u,pu):rl(u)?[u]:Ia(t1(Br(u)))}function bx(u){var d=++yo;return Br(u)+d}var wx=od(function(u,d){return u+d},0),xx=Yp("ceil"),Lx=od(function(u,d){return u/d},1),Cx=Yp("floor");function Sx(u){return u&&u.length?ce(u,ja,gt):t}function Px(u,d){return u&&u.length?ce(u,vi(d,2),gt):t}function Ex(u){return Yn(u,ja)}function Ax(u,d){return Yn(u,vi(d,2))}function kx(u){return u&&u.length?ce(u,ja,Fi):t}function Mx(u,d){return u&&u.length?ce(u,vi(d,2),Fi):t}var Tx=od(function(u,d){return u*d},1),Bx=Yp("round"),Nx=od(function(u,d){return u-d},0);function Dx(u){return u&&u.length?lr(u,ja):0}function Rx(u,d){return u&&u.length?lr(u,vi(d,2)):0}return Ne.after=iw,Ne.ary=f1,Ne.assign=Gw,Ne.assignIn=P1,Ne.assignInWith=_d,Ne.assignWith=Vw,Ne.at=Hw,Ne.before=d1,Ne.bind=u0,Ne.bindAll=Y3,Ne.bindKey=p1,Ne.castArray=gw,Ne.chain=u1,Ne.chunk=Cb,Ne.compact=Sb,Ne.concat=Pb,Ne.cond=X3,Ne.conforms=Q3,Ne.constant=m0,Ne.countBy=D5,Ne.create=Ww,Ne.curry=g1,Ne.curryRight=m1,Ne.debounce=v1,Ne.defaults=Zw,Ne.defaultsDeep=Kw,Ne.defer=rw,Ne.delay=sw,Ne.difference=Eb,Ne.differenceBy=Ab,Ne.differenceWith=kb,Ne.drop=Mb,Ne.dropRight=Tb,Ne.dropRightWhile=Bb,Ne.dropWhile=Nb,Ne.fill=Db,Ne.filter=O5,Ne.flatMap=z5,Ne.flatMapDeep=j5,Ne.flatMapDepth=U5,Ne.flatten=s1,Ne.flattenDeep=Rb,Ne.flattenDepth=Ob,Ne.flip=ow,Ne.flow=tx,Ne.flowRight=nx,Ne.fromPairs=Ib,Ne.functions=n3,Ne.functionsIn=i3,Ne.groupBy=$5,Ne.initial=zb,Ne.intersection=jb,Ne.intersectionBy=Ub,Ne.intersectionWith=$b,Ne.invert=s3,Ne.invertBy=o3,Ne.invokeMap=G5,Ne.iteratee=v0,Ne.keyBy=V5,Ne.keys=xo,Ne.keysIn=za,Ne.map=dd,Ne.mapKeys=l3,Ne.mapValues=u3,Ne.matches=ix,Ne.matchesProperty=rx,Ne.memoize=gd,Ne.merge=c3,Ne.mergeWith=E1,Ne.method=sx,Ne.methodOf=ox,Ne.mixin=y0,Ne.negate=md,Ne.nthArg=lx,Ne.omit=h3,Ne.omitBy=f3,Ne.once=aw,Ne.orderBy=H5,Ne.over=ux,Ne.overArgs=lw,Ne.overEvery=cx,Ne.overSome=hx,Ne.partial=c0,Ne.partialRight=y1,Ne.partition=W5,Ne.pick=d3,Ne.pickBy=A1,Ne.property=R1,Ne.propertyOf=fx,Ne.pull=Hb,Ne.pullAll=a1,Ne.pullAllBy=Wb,Ne.pullAllWith=Zb,Ne.pullAt=Kb,Ne.range=dx,Ne.rangeRight=px,Ne.rearg=uw,Ne.reject=J5,Ne.remove=Jb,Ne.rest=cw,Ne.reverse=a0,Ne.sampleSize=X5,Ne.set=g3,Ne.setWith=m3,Ne.shuffle=Q5,Ne.slice=Yb,Ne.sortBy=nw,Ne.sortedUniq=r5,Ne.sortedUniqBy=s5,Ne.split=z3,Ne.spread=hw,Ne.tail=o5,Ne.take=a5,Ne.takeRight=l5,Ne.takeRightWhile=u5,Ne.takeWhile=c5,Ne.tap=S5,Ne.throttle=fw,Ne.thru=fd,Ne.toArray=L1,Ne.toPairs=k1,Ne.toPairsIn=M1,Ne.toPath=_x,Ne.toPlainObject=S1,Ne.transform=v3,Ne.unary=dw,Ne.union=h5,Ne.unionBy=f5,Ne.unionWith=d5,Ne.uniq=p5,Ne.uniqBy=g5,Ne.uniqWith=m5,Ne.unset=y3,Ne.unzip=l0,Ne.unzipWith=l1,Ne.update=_3,Ne.updateWith=b3,Ne.values=Ah,Ne.valuesIn=w3,Ne.without=v5,Ne.words=N1,Ne.wrap=pw,Ne.xor=y5,Ne.xorBy=_5,Ne.xorWith=b5,Ne.zip=w5,Ne.zipObject=x5,Ne.zipObjectDeep=L5,Ne.zipWith=C5,Ne.entries=k1,Ne.entriesIn=M1,Ne.extend=P1,Ne.extendWith=_d,y0(Ne,Ne),Ne.add=wx,Ne.attempt=D1,Ne.camelCase=S3,Ne.capitalize=T1,Ne.ceil=xx,Ne.clamp=x3,Ne.clone=mw,Ne.cloneDeep=yw,Ne.cloneDeepWith=_w,Ne.cloneWith=vw,Ne.conformsTo=bw,Ne.deburr=B1,Ne.defaultTo=ex,Ne.divide=Lx,Ne.endsWith=P3,Ne.eq=ql,Ne.escape=E3,Ne.escapeRegExp=A3,Ne.every=R5,Ne.find=I5,Ne.findIndex=i1,Ne.findKey=Jw,Ne.findLast=F5,Ne.findLastIndex=r1,Ne.findLastKey=Yw,Ne.floor=Cx,Ne.forEach=c1,Ne.forEachRight=h1,Ne.forIn=Xw,Ne.forInRight=Qw,Ne.forOwn=e3,Ne.forOwnRight=t3,Ne.get=d0,Ne.gt=ww,Ne.gte=xw,Ne.has=r3,Ne.hasIn=p0,Ne.head=o1,Ne.identity=ja,Ne.includes=q5,Ne.indexOf=Fb,Ne.inRange=L3,Ne.invoke=a3,Ne.isArguments=$c,Ne.isArray=zi,Ne.isArrayBuffer=Lw,Ne.isArrayLike=Fa,Ne.isArrayLikeObject=Ws,Ne.isBoolean=Cw,Ne.isBuffer=lc,Ne.isDate=Sw,Ne.isElement=Pw,Ne.isEmpty=Ew,Ne.isEqual=Aw,Ne.isEqualWith=kw,Ne.isError=h0,Ne.isFinite=Mw,Ne.isFunction=ju,Ne.isInteger=_1,Ne.isLength=vd,Ne.isMap=b1,Ne.isMatch=Tw,Ne.isMatchWith=Bw,Ne.isNaN=Nw,Ne.isNative=Dw,Ne.isNil=Ow,Ne.isNull=Rw,Ne.isNumber=w1,Ne.isObject=Es,Ne.isObjectLike=Fs,Ne.isPlainObject=af,Ne.isRegExp=f0,Ne.isSafeInteger=Iw,Ne.isSet=x1,Ne.isString=yd,Ne.isSymbol=rl,Ne.isTypedArray=Eh,Ne.isUndefined=Fw,Ne.isWeakMap=zw,Ne.isWeakSet=jw,Ne.join=qb,Ne.kebabCase=k3,Ne.last=wl,Ne.lastIndexOf=Gb,Ne.lowerCase=M3,Ne.lowerFirst=T3,Ne.lt=Uw,Ne.lte=$w,Ne.max=Sx,Ne.maxBy=Px,Ne.mean=Ex,Ne.meanBy=Ax,Ne.min=kx,Ne.minBy=Mx,Ne.stubArray=b0,Ne.stubFalse=w0,Ne.stubObject=gx,Ne.stubString=mx,Ne.stubTrue=vx,Ne.multiply=Tx,Ne.nth=Vb,Ne.noConflict=ax,Ne.noop=_0,Ne.now=pd,Ne.pad=B3,Ne.padEnd=N3,Ne.padStart=D3,Ne.parseInt=R3,Ne.random=C3,Ne.reduce=Z5,Ne.reduceRight=K5,Ne.repeat=O3,Ne.replace=I3,Ne.result=p3,Ne.round=Bx,Ne.runInContext=Ct,Ne.sample=Y5,Ne.size=ew,Ne.snakeCase=F3,Ne.some=tw,Ne.sortedIndex=Xb,Ne.sortedIndexBy=Qb,Ne.sortedIndexOf=e5,Ne.sortedLastIndex=t5,Ne.sortedLastIndexBy=n5,Ne.sortedLastIndexOf=i5,Ne.startCase=j3,Ne.startsWith=U3,Ne.subtract=Nx,Ne.sum=Dx,Ne.sumBy=Rx,Ne.template=$3,Ne.times=yx,Ne.toFinite=Uu,Ne.toInteger=Ji,Ne.toLength=C1,Ne.toLower=q3,Ne.toNumber=xl,Ne.toSafeInteger=qw,Ne.toString=Br,Ne.toUpper=G3,Ne.trim=V3,Ne.trimEnd=H3,Ne.trimStart=W3,Ne.truncate=Z3,Ne.unescape=K3,Ne.uniqueId=bx,Ne.upperCase=J3,Ne.upperFirst=g0,Ne.each=c1,Ne.eachRight=h1,Ne.first=o1,y0(Ne,function(){var u={};return en(Ne,function(d,P){Ii.call(Ne.prototype,P)||(u[P]=d)}),u}(),{chain:!1}),Ne.VERSION=i,ls(["bind","bindKey","curry","curryRight","partial","partialRight"],function(u){Ne[u].placeholder=Ne}),ls(["drop","take"],function(u,d){Ti.prototype[u]=function(P){P=P===t?1:K(Ji(P),0);var U=this.__filtered__&&!d?new Ti(this):this.clone();return U.__filtered__?U.__takeCount__=we(P,U.__takeCount__):U.__views__.push({size:we(P,ut),type:u+(U.__dir__<0?"Right":"")}),U},Ti.prototype[u+"Right"]=function(P){return this.reverse()[u](P).reverse()}}),ls(["filter","map","takeWhile"],function(u,d){var P=d+1,U=P==$||P==Z;Ti.prototype[u]=function(ve){var Ue=this.clone();return Ue.__iteratees__.push({iteratee:vi(ve,3),type:P}),Ue.__filtered__=Ue.__filtered__||U,Ue}}),ls(["head","last"],function(u,d){var P="take"+(d?"Right":"");Ti.prototype[u]=function(){return this[P](1).value()[0]}}),ls(["initial","tail"],function(u,d){var P="drop"+(d?"":"Right");Ti.prototype[u]=function(){return this.__filtered__?new Ti(this):this[P](1)}}),Ti.prototype.compact=function(){return this.filter(ja)},Ti.prototype.find=function(u){return this.filter(u).head()},Ti.prototype.findLast=function(u){return this.reverse().find(u)},Ti.prototype.invokeMap=Ki(function(u,d){return typeof u=="function"?new Ti(this):this.map(function(P){return je(P,u,d)})}),Ti.prototype.reject=function(u){return this.filter(md(vi(u)))},Ti.prototype.slice=function(u,d){u=Ji(u);var P=this;return P.__filtered__&&(u>0||d<0)?new Ti(P):(u<0?P=P.takeRight(-u):u&&(P=P.drop(u)),d!==t&&(d=Ji(d),P=d<0?P.dropRight(-d):P.take(d-u)),P)},Ti.prototype.takeRightWhile=function(u){return this.reverse().takeWhile(u).reverse()},Ti.prototype.toArray=function(){return this.take(ut)},en(Ti.prototype,function(u,d){var P=/^(?:filter|find|map|reject)|While$/.test(d),U=/^(?:head|last)$/.test(d),ve=Ne[U?"take"+(d=="last"?"Right":""):d],Ue=U||/^find/.test(d);ve&&(Ne.prototype[d]=function(){var lt=this.__wrapped__,_t=U?[1]:arguments,Nt=lt instanceof Ti,ln=_t[0],un=Nt||zi(lt),vn=function(hr){var mr=ve.apply(Ne,to([hr],_t));return U&&In?mr[0]:mr};un&&P&&typeof ln=="function"&&ln.length!=1&&(Nt=un=!1);var In=this.__chain__,ei=!!this.__actions__.length,_i=Ue&&!In,Xi=Nt&&!ei;if(!Ue&&un){lt=Xi?lt:new Ti(this);var bi=u.apply(lt,_t);return bi.__actions__.push({func:fd,args:[vn],thisArg:t}),new ps(bi,In)}return _i&&Xi?u.apply(this,_t):(bi=this.thru(vn),_i?U?bi.value()[0]:bi.value():bi)})}),ls(["pop","push","shift","sort","splice","unshift"],function(u){var d=Bo[u],P=/^(?:push|sort|unshift)$/.test(u)?"tap":"thru",U=/^(?:pop|shift)$/.test(u);Ne.prototype[u]=function(){var ve=arguments;if(U&&!this.__chain__){var Ue=this.value();return d.apply(zi(Ue)?Ue:[],ve)}return this[P](function(lt){return d.apply(zi(lt)?lt:[],ve)})}}),en(Ti.prototype,function(u,d){var P=Ne[d];if(P){var U=P.name+"";Ii.call(Gs,U)||(Gs[U]=[]),Gs[U].push({name:d,func:P})}}),Gs[sd(t,F).name]=[{name:"wrapper",func:t}],Ti.prototype.clone=nc,Ti.prototype.reverse=dh,Ti.prototype.value=ic,Ne.prototype.at=P5,Ne.prototype.chain=E5,Ne.prototype.commit=A5,Ne.prototype.next=k5,Ne.prototype.plant=T5,Ne.prototype.reverse=B5,Ne.prototype.toJSON=Ne.prototype.valueOf=Ne.prototype.value=N5,Ne.prototype.first=Ne.prototype.head,oi&&(Ne.prototype[oi]=M5),Ne},Ls=ro();Gr?((Gr.exports=Ls)._=Ls,Qn._=Ls):qr._=Ls}).call(qo)})(fp,fp.exports);var f4=fp.exports;class Uo extends gn.Polygon{constructor(t,i={}){super([],{...i,pmIgnore:!1,interactive:!0});Mt(this,"_width");Mt(this,"_height");Mt(this,"_center");Mt(this,"_rotation");Mt(this,"_isMapReady",!1);Mt(this,"properties");Mt(this,"_helperPoints",{corners:[],midPoints:[]});Mt(this,"_throttledUpdateProperties");const r=t instanceof gn.LatLngBounds?t:gn.latLngBounds(t);if(this._center=r.getCenter(),this._rotation=0,console.log("[Rectangle][constructor] Initialisation avec options:",{bounds:r,center:this._center,hasExplicitDimensions:!!(i.width&&i.height),width:i.width,height:i.height}),i.width&&i.height)this._width=i.width,this._height=i.height,console.log("[Rectangle][constructor] Utilisation des dimensions explicites:",{width:this._width,height:this._height});else{const o=r.getSouthWest(),l=r.getNorthEast();this._width=At.measure("Rectangle.constructor.calculateWidth",()=>{const h=$0([o.lng,o.lat],[l.lng,o.lat],{units:"meters"});return Math.max(h,1)}),this._height=At.measure("Rectangle.constructor.calculateHeight",()=>{const h=$0([o.lng,o.lat],[o.lng,l.lat],{units:"meters"});return Math.max(h,1)}),console.log("[Rectangle][constructor] Dimensions calculées depuis bounds:",{width:this._width,height:this._height})}(this._width<1||this._height<1)&&this._getPixelsPerMeter()>0&&(this._width=Math.max(this._width,1),this._height=Math.max(this._height,1),this._updatePolygonCoordinates()),this.properties=At.measure("Rectangle.constructor.initProperties",()=>({type:"Rectangle",style:{...i,name:i.name||""},rotation:this._rotation})),this._throttledUpdateProperties=At.measure("Rectangle.constructor.initThrottle",()=>f4.throttle(()=>{this.updateProperties()},100)),this.on("add",()=>{this._isMapReady=!0,this._updatePolygonCoordinates(),this.updateProperties()}),this.on("remove",()=>{this._isMapReady=!1})}_updatePolygonCoordinates(){At.measure("Rectangle._updatePolygonCoordinates",()=>{if(!this._isMapReady||!this._map)return;console.log("[Rectangle][_updatePolygonCoordinates] Début mise à jour avec:",{width:this._width,height:this._height,center:this._center,rotation:this._rotation}),this._width=Math.max(this._width,1),this._height=Math.max(this._height,1);const t=this._width/2,i=this._height/2,r=py([this._center.lng,this._center.lat],i,0,{units:"meters"}).geometry.coordinates,o=py([this._center.lng,this._center.lat],t,90,{units:"meters"}).geometry.coordinates,l=Math.abs(r[1]-this._center.lat)*2,h=Math.abs(o[0]-this._center.lng)*2,p=[gn.latLng(this._center.lat+l/2,this._center.lng-h/2),gn.latLng(this._center.lat+l/2,this._center.lng+h/2),gn.latLng(this._center.lat-l/2,this._center.lng+h/2),gn.latLng(this._center.lat-l/2,this._center.lng-h/2)];if(this._rotation===0){this.setLatLngs(p);return}const m=this._map.latLngToContainerPoint(this._center),_=p.map(Q=>this._map.latLngToContainerPoint(Q)),w=-this._rotation*Math.PI/180,E=Math.cos(w),b=Math.sin(w),j=_.map(Q=>{const F=Q.x-m.x,V=Q.y-m.y;return gn.point(m.x+(F*E-V*b),m.y+(F*b+V*E))}).map(Q=>this._map.containerPointToLatLng(Q));console.log("[Rectangle][_updatePolygonCoordinates] Résultat final:",{corners:j,dimensions:{width:this._width,height:this._height}}),this.setLatLngs(j),this.fire("coordinates:updated",{corners:j,center:this._center,rotation:this._rotation,dimensions:{width:this._width,height:this._height}})})}_getPixelsPerMeter(){return At.measure("Rectangle._getPixelsPerMeter",()=>{if(!this._isMapReady||!this._map)return 1;const t=Math.max(this._width/1e3,1e-4),i=this._map.latLngToContainerPoint(this._center),o=this._map.latLngToContainerPoint(gn.latLng(this._center.lat,this._center.lng+t)).x-i.x,l=$0([this._center.lng,this._center.lat],[this._center.lng+t,this._center.lat],{units:"meters"}),h=Math.abs(o/l);return isNaN(h)||h<=0?(console.warn("[Rectangle][_getPixelsPerMeter] Ratio invalide, utilisation de la valeur par défaut"),1):h})}getRotatedCorners(){return At.measure("Rectangle.getRotatedCorners",()=>{try{const t=this.getLatLngs();if(!t||!Array.isArray(t)||t.length===0){const i=this._width/2,r=this._height/2;return[gn.latLng(this._center.lat+r,this._center.lng-i),gn.latLng(this._center.lat+r,this._center.lng+i),gn.latLng(this._center.lat-r,this._center.lng+i),gn.latLng(this._center.lat-r,this._center.lng-i)]}return t[0]}catch(t){console.warn("Error in getRotatedCorners:",t);const i=this._width/2,r=this._height/2;return[gn.latLng(this._center.lat+r,this._center.lng-i),gn.latLng(this._center.lat+r,this._center.lng+i),gn.latLng(this._center.lat-r,this._center.lng+i),gn.latLng(this._center.lat-r,this._center.lng-i)]}})}getMidPoints(){return At.measure("Rectangle.getMidPoints",()=>{try{const t=this.getRotatedCorners();if(!t||t.length<4){const r=this._width/2,o=this._height/2;return[gn.latLng(this._center.lat+o,this._center.lng),gn.latLng(this._center.lat,this._center.lng+r),gn.latLng(this._center.lat-o,this._center.lng),gn.latLng(this._center.lat,this._center.lng-r)]}if(!t.every(r=>r&&typeof r.lat=="number"&&typeof r.lng=="number"))throw new Error("Invalid corner coordinates");return[this._getMidPoint(t[3],t[0]),this._getMidPoint(t[0],t[1]),this._getMidPoint(t[1],t[2]),this._getMidPoint(t[2],t[3])]}catch(t){console.warn("Error in getMidPoints:",t);const i=this._width/2,r=this._height/2;return[gn.latLng(this._center.lat+r,this._center.lng),gn.latLng(this._center.lat,this._center.lng+i),gn.latLng(this._center.lat-r,this._center.lng),gn.latLng(this._center.lat,this._center.lng-i)]}})}_getMidPoint(t,i){return At.measure("Rectangle._getMidPoint",()=>{if(!t||!i||typeof t.lat!="number"||typeof t.lng!="number"||typeof i.lat!="number"||typeof i.lng!="number")throw new Error("Invalid points for midpoint calculation");return gn.latLng((t.lat+i.lat)/2,(t.lng+i.lng)/2)})}getCenter(){return At.measure("Rectangle.getCenter",()=>this._center)}setCenter(t){At.measure("Rectangle.setCenter",()=>{this._center=t,this._updatePolygonCoordinates(),this.updateProperties(),this.updateHelperPointPositions()})}getRotation(){return At.measure("Rectangle.getRotation",()=>this._rotation)}setRotation(t,i=!1){At.measure("Rectangle.setRotation",()=>{this._rotation=(t%360+360)%360,this._updatePolygonCoordinates(),i&&this.updateProperties(),this.updateHelperPointPositions(),this.fire("rotation:updated",{angle:this._rotation,corners:this.getRotatedCorners(),center:this._center})})}finalizeRotation(){At.measure("Rectangle.finalizeRotation",()=>{this.updateProperties()})}getDimensions(){return At.measure("Rectangle.getDimensions",()=>({width:this._width,height:this._height}))}setDimensions(t,i){At.measure("Rectangle.setDimensions",()=>{console.log("[Rectangle][setDimensions] Début de la mise à jour des dimensions:",{oldWidth:this._width,oldHeight:this._height,newWidth:t,newHeight:i}),this._width=t,this._height=i,console.log("[Rectangle][setDimensions] Mise à jour des coordonnées du polygone"),this._updatePolygonCoordinates(),console.log("[Rectangle][setDimensions] Mise à jour des propriétés"),this.updateProperties(),console.log("[Rectangle][setDimensions] Émission de l'événement dimensions:updated"),this.fire("dimensions:updated",{width:this._width,height:this._height,corners:this.getRotatedCorners(),center:this._center}),this.updateHelperPointPositions()})}resizeFromCorner(t,i){At.measure("Rectangle.resizeFromCorner",()=>{if(!(!this._isMapReady||!this._map))try{const r=this._map.latLngToContainerPoint(this._center),o=this._map.latLngToContainerPoint(i),l=o.x-r.x,h=o.y-r.y,p=-this._rotation*Math.PI/180,m=Math.cos(p),_=Math.sin(p),w=l*m-h*_,E=l*_+h*m,b=this._getPixelsPerMeter(),D=t===0||t===3?-1:1,j=t===0||t===1?1:-1,Q=Math.max(Math.abs(w*2)/b,1),F=Math.max(Math.abs(E*2)/b,1),V=Q*b/2,pe=F*b/2,Ee=D*V*m-j*pe*_,Ie=D*V*_+j*pe*m,nt=gn.point(o.x-Ee,o.y-Ie),We=this._map.containerPointToLatLng(nt),le=[gn.point(nt.x-V,nt.y+pe),gn.point(nt.x+V,nt.y+pe),gn.point(nt.x+V,nt.y-pe),gn.point(nt.x-V,nt.y-pe)].map(G=>{const I=G.x-nt.x,Y=G.y-nt.y;return gn.point(nt.x+(I*m-Y*_),nt.y+(I*_+Y*m))}).map(G=>this._map.containerPointToLatLng(G));this._width=Q,this._height=F,this._center=We,this.setLatLngs(le),this.fire("coordinates:updated",{corners:le,center:this._center,rotation:this._rotation})}catch(r){console.warn("Error in resizeFromCorner:",r)}})}resizeFromSide(t,i){At.measure("Rectangle.resizeFromSide",()=>{if(!this._isMapReady||!this._map)return;const r=this._map.latLngToContainerPoint(this._center),o=this._map.latLngToContainerPoint(i),l=o.x-r.x,h=o.y-r.y,p=-this._rotation*Math.PI/180,m=Math.cos(p),_=Math.sin(p),w=l*m-h*_,E=l*_+h*m,b=this._getPixelsPerMeter();t%2===0?this._height=Math.abs(E*2)/b:this._width=Math.abs(w*2)/b,this._updatePolygonCoordinates(),this.updateProperties()})}moveFromCenter(t){At.measure("Rectangle.moveFromCenter",()=>{this._center=t,this._updatePolygonCoordinates(),this.updateProperties()})}updateProperties(){At.measure("Rectangle.updateProperties",()=>{var r,o,l;const t=this.getRotatedCorners(),i=((o=(r=this.properties)==null?void 0:r.style)==null?void 0:o.name)||"";this.properties={...this.properties,width:this._width,height:this._height,surface:this._width*this._height,perimeter:2*(this._width+this._height),center:this._center,corners:t,midPoints:this.getMidPoints(),rotation:this._rotation,style:{...this.options,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#3388ff",fillOpacity:this.options.fillOpacity||.2,dashArray:((l=this.options)==null?void 0:l.dashArray)||"",name:i}},this.fire("properties:updated",{shape:this,properties:this.properties,corners:t,midPoints:this.getMidPoints()})})}setName(t){At.measure("Rectangle.setName",()=>{this.properties.style||(this.properties.style={}),this.properties.style.name=t,this.fire("properties:updated",{shape:this,properties:this.properties})})}getName(){return At.measure("Rectangle.getName",()=>{var t,i;return((i=(t=this.properties)==null?void 0:t.style)==null?void 0:i.name)||""})}generateHelperPoints(t,i="rgba(220, 38, 38, 0.5)",r="rgba(37, 99, 235, 0.5)"){At.measure("Rectangle.generateHelperPoints",()=>{this.clearHelperPoints();const o=this.getRotatedCorners(),l=this.getMidPoints();this._helperPoints.corners=o.map(h=>gn.circleMarker(h,{radius:5,color:i,fillColor:i,fillOpacity:.6,weight:1,opacity:.8,className:"rectangle-helper-corner",pmIgnore:!0,interactive:!1}).addTo(t)),this._helperPoints.midPoints=l.map(h=>gn.circleMarker(h,{radius:5,color:r,fillColor:r,fillOpacity:.6,weight:1,opacity:.8,className:"rectangle-helper-midpoint",pmIgnore:!0,interactive:!1}).addTo(t))})}clearHelperPoints(){At.measure("Rectangle.clearHelperPoints",()=>{this._helperPoints.corners.forEach(t=>{if(t&&t.remove)try{t.remove()}catch(i){console.warn("Erreur lors de la suppression d'un point d'aide de coin:",i)}}),this._helperPoints.midPoints.forEach(t=>{if(t&&t.remove)try{t.remove()}catch(i){console.warn("Erreur lors de la suppression d'un point d'aide de milieu:",i)}}),this._helperPoints.corners=[],this._helperPoints.midPoints=[]})}updateHelperPointPositions(){At.measure("Rectangle.updateHelperPointPositions",()=>{if(this._helperPoints.corners.length===0&&this._helperPoints.midPoints.length===0)return;const t=this.getRotatedCorners(),i=this.getMidPoints();t.forEach((r,o)=>{this._helperPoints.corners[o]&&this._helperPoints.corners[o].setLatLng(r)}),i.forEach((r,o)=>{this._helperPoints.midPoints[o]&&this._helperPoints.midPoints[o].setLatLng(r)})})}findClosestHelperPoint(t){return At.measure("Rectangle.findClosestHelperPoint",()=>{const i=this.getRotatedCorners(),r=this.getMidPoints(),o=[...i,...r];if(o.length===0)return null;let l=o[0],h=t.distanceTo(l);for(let p=1;p<o.length;p++){const m=t.distanceTo(o[p]);m<h&&(h=m,l=o[p])}return l})}toggleHelperPoints(t,i,r,o){At.measure("Rectangle.toggleHelperPoints",()=>{i&&t?this.generateHelperPoints(t,r,o):this.clearHelperPoints()})}containsPoint(t){return At.measure("Rectangle.containsPoint",()=>{const i=this.getRotatedCorners();if(i.length!==4)return!1;let r=!1;for(let o=0,l=i.length-1;o<i.length;l=o++){const h=i[o].lng,p=i[o].lat,m=i[l].lng,_=i[l].lat;p>t.lat!=_>t.lat&&t.lng<(m-h)*(t.lat-p)/(_-p)+h&&(r=!r)}return r})}}class Jl extends gn.Rectangle{constructor(t,i="Double-cliquez pour éditer",r={}){var p,m,_,w,E,b,D,j;const o=t instanceof gn.LatLngBounds?t:gn.latLngBounds(t);if(!o.isValid()){console.warn("[TextRectangle] Limites invalides, utilisation de limites par défaut");const Q=gn.latLng(0,0);o.extend(gn.latLng(Q.lat+.001,Q.lng+.001)),o.extend(gn.latLng(Q.lat-.001,Q.lng-.001))}const l={...r.textStyle,color:r.textColor||((p=r.textStyle)==null?void 0:p.color)||"#000000",fontFamily:r.fontFamily||((m=r.textStyle)==null?void 0:m.fontFamily)||"Arial, sans-serif",textAlign:r.textAlign||((_=r.textStyle)==null?void 0:_.textAlign)||"center",backgroundColor:r.backgroundColor||((w=r.textStyle)==null?void 0:w.backgroundColor)||"#FFFFFF",backgroundOpacity:r.backgroundOpacity??((E=r.textStyle)==null?void 0:E.backgroundOpacity)??1,bold:r.bold||((b=r.textStyle)==null?void 0:b.bold)||!1,italic:r.italic||((D=r.textStyle)==null?void 0:D.italic)||!1,fontSize:((j=r.textStyle)==null?void 0:j.fontSize)||"14px"},h={pmIgnore:!1,interactive:!0,fill:!0,stroke:!0,className:"leaflet-text-rectangle",...r,textStyle:l};super(o,h);Mt(this,"properties",{type:"TextRectangle",text:"",width:0,height:0,area:0,rotation:0,style:{textStyle:{color:"#000000",fontSize:"14px",fontFamily:"Arial, sans-serif",textAlign:"center",backgroundColor:"#FFFFFF",backgroundOpacity:1,bold:!1,italic:!1}}});Mt(this,"_textNode",null);Mt(this,"_isEditing",!1);Mt(this,"_editableDiv",null);Mt(this,"_text");Mt(this,"_rotation",0);Mt(this,"_textStyle",{color:"#000000",fontSize:"14px",fontFamily:"Arial, sans-serif",textAlign:"center",backgroundColor:"#FFFFFF",backgroundOpacity:1,bold:!1,italic:!1});Mt(this,"_initialBounds",null);Mt(this,"_isResizing",!1);Mt(this,"_resizePreview",null);Mt(this,"_minWidth",50);Mt(this,"_minHeight",30);Mt(this,"_maxWidth",2e3);Mt(this,"_maxHeight",1e3);Mt(this,"_onKeyDown",t=>{At.measure("TextRectangle._onKeyDown",()=>{t.key==="Enter"&&t.ctrlKey?(t.preventDefault(),this._finishEditing()):t.key==="Escape"&&(t.preventDefault(),this._cancelEditing())})});Mt(this,"_finishEditing",()=>{At.measure("TextRectangle._finishEditing",()=>{if(this._editableDiv)try{const t=this._editableDiv.innerText.trim()||"Double-cliquez pour éditer";this._cleanupEditableDiv(),this.setText(t),this._textRedraw(),this.fire("edit:end"),this.map&&!this.map.dragging.enabled()&&this.map.dragging.enable()}catch(t){console.error("[TextRectangle] Erreur lors de la finalisation de l'édition :",t),this._cleanupEditableDiv()}})});Mt(this,"_cancelEditing",()=>{this._textRedraw(),this._cleanupEditableDiv(),this.map&&!this.map.dragging.enabled()&&this.map.dragging.enable()});Mt(this,"_updateTextPosition",()=>{At.measure("TextRectangle._updateTextPosition",()=>{this.updateProperties(),this._textRedraw()})});Mt(this,"_onZoomEnd",()=>{At.measure("TextRectangle._onZoomEnd",()=>{this._path&&(this._path.style.display=""),this._textNode&&(this._textNode.style.display=""),this._textRedraw()})});Mt(this,"_onAdd",()=>{At.measure("TextRectangle._onAdd",()=>{this._textRedraw(),this.map&&(this.map.on("zoomend",this._onZoomEnd.bind(this)),this.map.on("zoomanim",this._animateZoom.bind(this)))})});Mt(this,"_onRemove",()=>{At.measure("TextRectangle._onRemove",()=>{this._removeTextNode(),this.map&&(this.map.off("zoomend",this._onZoomEnd),this.map.off("zoomanim",this._animateZoom))})});this._text=i,this._textStyle={...l},this.properties={type:"TextRectangle",text:this._text,width:0,height:0,area:0,rotation:this._rotation,style:{...h,textStyle:{...this._textStyle},name:r.name||""}},this.on({add:this._onAdd,remove:this._onRemove,dblclick:this._onDoubleClick,dragend:this._updateTextPosition,"pm:edit":this._updateTextPosition,"pm:dragend":this._updateTextPosition,"pm:markerdragend":this._updateTextPosition,"pm:vertexadded":this._updateTextPosition,"pm:vertexremoved":this._updateTextPosition}),this.pm&&this.pm.enableLayerDrag()}get map(){return this._map}set map(t){this._map=t}setText(t,i){At.measure("TextRectangle.setText",()=>{const r=this.properties.text;this._text=t,i&&(this._textStyle={...this._textStyle,...i}),this.properties.text=t||"Double-cliquez pour éditer",console.log("[TextRectangle] Mise à jour du texte",{oldText:r,newText:this.properties.text,hasTextNode:!!this._textNode}),this._textRedraw(),this.fire("text:updated",{text:this.properties.text,oldText:r,bounds:this.getBounds(),style:this.properties.style}),this.fire("properties:updated",{shape:this,properties:this.properties,source:"setText"})})}setTextStyle(t){At.measure("TextRectangle.setTextStyle",()=>{var i,r;console.log("[TextRectangle] Setting text style",{currentStyle:{...this._textStyle},newStyle:t,currentProps:(r=(i=this.properties)==null?void 0:i.style)==null?void 0:r.textStyle}),this._textStyle={...this._textStyle,...t},this.properties.style.textStyle?this.properties.style.textStyle={...this.properties.style.textStyle,...t}:this.properties.style.textStyle={...this._textStyle},t.fontSize&&(this._textStyle.fontSize=t.fontSize,this.properties.style.textStyle.fontSize=t.fontSize),console.log("[TextRectangle] After style update",{textStyle:{...this._textStyle},propsTextStyle:{...this.properties.style.textStyle}}),this._textRedraw(),this.fire("properties:updated",{shape:this,properties:this.properties})})}setRotation(t){At.measure("TextRectangle.setRotation",()=>{this.properties.rotation=t%360,this._textRedraw(),this.fire("properties:updated",{shape:this,properties:this.properties})})}getTextElement(){return this._textNode}updateProperties(){At.measure("TextRectangle.updateProperties",()=>{var l,h;const t=this.getBounds(),i=t.getCenter(),r=this.getDimensions().width,o=this.getDimensions().height;this.properties={type:"TextRectangle",text:this._text,width:r,height:o,area:r*o,rotation:this._rotation,center:{lat:i.lat,lng:i.lng},bounds:{northEast:{lat:t.getNorthEast().lat,lng:t.getNorthEast().lng},southWest:{lat:t.getSouthWest().lat,lng:t.getSouthWest().lng}},style:{...this.options,textStyle:{...this._textStyle},name:((h=(l=this.properties)==null?void 0:l.style)==null?void 0:h.name)||""}},this.fire("properties:updated",{shape:this,properties:this.properties})})}setBounds(t){return At.measure("TextRectangle.setBounds",()=>{const i=t instanceof gn.LatLngBounds?t:gn.latLngBounds(t);return gn.Rectangle.prototype.setBounds.call(this,i),this._textRedraw(),this.updateProperties(),this})}startResize(){At.measure("TextRectangle.startResize",()=>{if(!this._isResizing&&(this._isResizing=!0,this._initialBounds=this.getBounds(),this.map&&!this._resizePreview))try{if(this._resizePreview=gn.rectangle(this._initialBounds,{color:this.options.color||"#3388ff",weight:this.options.weight||2,opacity:.8,fillColor:this.options.fillColor||"#3388ff",fillOpacity:.2,dashArray:this.options.dashArray||"5,5",className:"resize-preview"}).addTo(this.map),this._rotation!==0){const t=this._resizePreview._path;t&&(t.style.transformOrigin="center",t.style.transform=`rotate(${this._rotation}deg)`)}this._textNode&&(this._textNode.style.opacity="0.5")}catch(t){console.error("[TextRectangle] Erreur lors de la création du rectangle fantôme:",t),this._cleanupResizePreview()}})}updateResizePreview(t){At.measure("TextRectangle.updateResizePreview",()=>{if(!(!this._isResizing||!this._resizePreview||!this.map))try{const i=this.map.latLngToContainerPoint(t.getNorthWest()),r=this.map.latLngToContainerPoint(t.getSouthEast()),o=Math.abs(r.x-i.x),l=Math.abs(r.y-i.y);if(o<this._minWidth||l<this._minHeight||o>this._maxWidth||l>this._maxHeight)return;if(this._resizePreview.setBounds(t),this._rotation!==0){const h=this._resizePreview._path;h&&(h.style.transformOrigin="center",h.style.transform=`rotate(${this._rotation}deg)`)}if(this._textNode){const h=Math.min(o,l)*.1,p=Math.max(10,Math.min(48,h)),m=p*1.2,w=this.properties.text.split(`
`).length*m,E=i.y+(l-w)/2,b=this._calculateTextX(i.x,r.x,5);if(this._textNode.setAttribute("x",b.toString()),this._textNode.setAttribute("y",E.toString()),this._textNode.querySelectorAll("tspan").forEach((D,j)=>{D.setAttribute("x",b.toString()),D.setAttribute("dy",j===0?"0":`${m}px`),D.style.fontSize=`${p}px`}),this._rotation!==0){const D=this.map.latLngToLayerPoint(t.getCenter());this._textNode.setAttribute("transform",`rotate(${this._rotation}, ${D.x}, ${D.y})`)}}this.fire("resize:update",{bounds:t})}catch(i){console.error("[TextRectangle] Erreur lors de la mise à jour du rectangle fantôme:",i),this._cleanupResizePreview()}})}endResize(t){At.measure("TextRectangle.endResize",()=>{if(this._isResizing)try{if(this._cleanupResizePreview(),this._textNode&&(this._textNode.style.opacity="1"),this.map){const i=this.map.latLngToContainerPoint(t.getNorthWest()),r=this.map.latLngToContainerPoint(t.getSouthEast()),o=Math.abs(r.x-i.x),l=Math.abs(r.y-i.y);if(o<this._minWidth||l<this._minHeight||o>this._maxWidth||l>this._maxHeight){this.cancelResize();return}}this.setBounds(t),this._textRedraw(),this.fire("resize:end",{bounds:t})}catch(i){console.error("[TextRectangle] Erreur lors de la fin du redimensionnement:",i),this.cancelResize()}finally{this._isResizing=!1}})}cancelResize(){At.measure("TextRectangle.cancelResize",()=>{if(!(!this._isResizing||!this._initialBounds))try{this._cleanupResizePreview(),this._textNode&&(this._textNode.style.opacity="1"),this.setBounds(this._initialBounds)}catch(t){console.error("[TextRectangle] Erreur lors de l'annulation du redimensionnement:",t)}finally{this._isResizing=!1,this._initialBounds=null}})}_cleanupResizePreview(){At.measure("TextRectangle._cleanupResizePreview",()=>{if(this._resizePreview&&this.map)try{this.map.removeLayer(this._resizePreview)}catch(t){console.error("[TextRectangle] Erreur lors du nettoyage du rectangle fantôme:",t)}finally{this._resizePreview=null}})}_onDoubleClick(t){At.measure("TextRectangle._onDoubleClick",()=>{this._isEditing||this._isResizing||(gn.DomEvent.stopPropagation(t),this.fire("edit:start"),this._isEditing=!0,this._removeTextNode(),this._createEditableDiv())})}_createEditableDiv(){At.measure("TextRectangle._createEditableDiv",()=>{var t;if(this.map)try{const i=this.getBounds(),r=this.map.latLngToContainerPoint(i.getNorthWest()),o=this.map.latLngToContainerPoint(i.getSouthEast()),l=o.x-r.x,h=o.y-r.y,p=document.createElement("div");p.className="leaflet-text-rectangle-editor",p.contentEditable="true",p.innerText=this.properties.text;let m=Math.min(l,h)*.1;const _=((t=this.properties.style.textStyle)==null?void 0:t.fontSize)||"",w=parseInt(_),E=isNaN(w)?m:w,b=Math.max(10,Math.min(48,E));if(Object.assign(p.style,{position:"absolute",left:`${r.x}px`,top:`${r.y}px`,width:`${l}px`,height:`${h}px`,backgroundColor:this.properties.style.fillColor||"#FFFFFF",opacity:`${this.properties.style.fillOpacity??1}`,color:this.properties.style.textColor||"#000000",fontSize:`${b}px`,fontFamily:this.properties.style.fontFamily||"Arial, sans-serif",fontWeight:this.properties.style.bold?"bold":"normal",fontStyle:this.properties.style.italic?"italic":"normal",textAlign:this.properties.style.textAlign||"center",border:`${this.properties.style.weight||2}px solid ${this.properties.style.color||"#3388ff"}`,borderRadius:"2px",padding:"4px",boxSizing:"border-box",zIndex:"1000",overflow:"auto",whiteSpace:"pre-wrap",wordBreak:"break-word",cursor:"text",userSelect:"text",outline:"none",display:"flex",alignItems:"center",justifyContent:this._getJustifyContent()}),this.properties.rotation!==0){const F=this.map.latLngToContainerPoint(i.getCenter());p.style.transformOrigin=`${F.x-r.x}px ${F.y-r.y}px`,p.style.transform=`rotate(${this.properties.rotation}deg)`}this.map.getContainer().appendChild(p),this._editableDiv=p,p.focus();const j=window.getSelection(),Q=document.createRange();Q.selectNodeContents(p),j==null||j.removeAllRanges(),j==null||j.addRange(Q),p.addEventListener("keydown",this._onKeyDown.bind(this)),p.addEventListener("blur",this._finishEditing.bind(this)),p.addEventListener("paste",F=>{var pe;F.preventDefault();const V=((pe=F.clipboardData)==null?void 0:pe.getData("text/plain"))||"";document.execCommand("insertText",!1,V)}),this.map.dragging.enabled()&&this.map.dragging.disable(),console.log("[TextRectangle] Div éditable créé",{position:{left:r.x,top:r.y},size:{width:l,height:h},fontSize:b,styles:this.properties.style})}catch(i){console.error("[TextRectangle] Erreur lors de la création de l'éditeur :",i),this._isEditing=!1}})}_getJustifyContent(){return At.measure("TextRectangle._getJustifyContent",()=>{switch(this.properties.style.textAlign||"center"){case"left":return"flex-start";case"right":return"flex-end";case"center":default:return"center"}})}_cleanupEditableDiv(){At.measure("TextRectangle._cleanupEditableDiv",()=>{this._editableDiv&&(this._editableDiv.removeEventListener("keydown",this._onKeyDown),this._editableDiv.removeEventListener("blur",this._finishEditing),this._editableDiv.parentNode&&this._editableDiv.parentNode.removeChild(this._editableDiv),this._editableDiv=null,this._isEditing=!1)})}_textRedraw(){At.measure("TextRectangle._textRedraw",()=>{var i;if(!gn.Browser.svg||!this.map||this._isEditing||!this._path){console.log("[TextRectangle] _textRedraw ignoré",{reason:gn.Browser.svg?this.map?this._isEditing?"En cours d'édition":"Chemin SVG non trouvé":"Carte non disponible":"SVG non supporté"});return}this._removeTextNode();const t=this.properties.text;if(t)try{const r=this._path;if(!r){console.warn("[TextRectangle] Chemin SVG non trouvé");return}const o=r.ownerSVGElement;if(!o){console.warn("[TextRectangle] Élément SVG parent non trouvé");return}if(!this.map||!this.map.getContainer()||!this._map){console.warn("[TextRectangle] Carte non valide pour le rendu");return}const l=gn.SVG.create("text");l.setAttribute("class","leaflet-text-rectangle-text"),l.style.zIndex="1000",Object.assign(l.style,{fill:this.properties.style.textColor||"#000000",fontFamily:this.properties.style.fontFamily||"Arial, sans-serif",fontWeight:this.properties.style.bold?"bold":"normal",fontStyle:this.properties.style.italic?"italic":"normal",stroke:"white",strokeWidth:"0.5px",paintOrder:"stroke fill",pointerEvents:"none",userSelect:"none"});try{const h=this.getBounds();if(!h.isValid()){console.warn("[TextRectangle] Limites non valides pour le rendu");return}let p,m;try{p=this.map.latLngToLayerPoint(h.getNorthWest()),m=this.map.latLngToLayerPoint(h.getSouthEast())}catch(We){console.warn("[TextRectangle] Erreur de conversion de coordonnées:",We);return}const _=m.x-p.x,w=m.y-p.y;if(_<=0||w<=0||isNaN(_)||isNaN(w)){console.warn("[TextRectangle] Dimensions non valides:",{rectWidth:_,rectHeight:w});return}let E=Math.min(_,w)*.1;const b=((i=this.properties.style.textStyle)==null?void 0:i.fontSize)||"",D=parseInt(b),j=isNaN(D)?E:D,Q=Math.max(12,Math.min(48,j)),F=t.split(`
`),V=Q*1.2,pe=F.length*V,Ee=p.y+(w-pe)/2,Ie=this._getTextAnchor(),nt=this._calculateTextX(p.x,m.x,5);if(l.setAttribute("text-anchor",Ie),l.setAttribute("dominant-baseline","hanging"),l.setAttribute("vector-effect","non-scaling-stroke"),F.forEach((We,O)=>{const H=gn.SVG.create("tspan");H.textContent=We,H.setAttribute("x",nt.toString()),H.setAttribute("dy",O===0?"0":`${V}px`),H.style.fontSize=`${Q}px`,H.style.textShadow="1px 1px 2px rgba(255,255,255,0.8)",l.appendChild(H)}),l.setAttribute("y",Ee.toString()),this.properties.rotation!==0)try{const We=this.map.latLngToLayerPoint(h.getCenter());l.setAttribute("transform",`rotate(${this.properties.rotation}, ${We.x}, ${We.y})`)}catch(We){console.warn("[TextRectangle] Erreur lors de la rotation:",We)}this._textNode=l,o.appendChild(l),l.parentNode&&l.parentNode.appendChild(l),this.fire("text:redrawn",{text:t,fontSize:Q,position:{x:nt,y:Ee},dimensions:{width:_,height:w}})}catch(h){console.error("[TextRectangle] Erreur lors des calculs de coordonnées:",h),this._textNode&&this._textNode.parentNode&&(this._textNode.parentNode.removeChild(this._textNode),this._textNode=null)}}catch(r){console.error("[TextRectangle] Erreur lors du rendu du texte:",r)}})}_calculateTextX(t,i,r){return At.measure("TextRectangle._calculateTextX",()=>{const o=i-t;switch(this.properties.style.textAlign){case"left":return t+r;case"right":return i-r;case"center":default:return t+o/2}})}_getTextAnchor(){return At.measure("TextRectangle._getTextAnchor",()=>{switch(this.properties.style.textAlign){case"left":return"start";case"right":return"end";case"center":default:return"middle"}})}_removeTextNode(){At.measure("TextRectangle._removeTextNode",()=>{this._textNode&&this._textNode.parentNode&&(this._textNode.parentNode.removeChild(this._textNode),this._textNode=null)})}getDimensions(){return At.measure("TextRectangle.getDimensions",()=>{const t=this.getBounds();if(!this.map)return{width:0,height:0};const i=t.getSouthWest(),r=gn.latLng(t.getSouth(),t.getEast()),o=this.map.distance(i,r),l=this.map.distance(i,gn.latLng(t.getNorth(),t.getWest()));return{width:o,height:l}})}getMidPoints(){return At.measure("TextRectangle.getMidPoints",()=>{const t=this.getBounds(),i=t.getNorthWest(),r=t.getNorthEast(),o=t.getSouthEast(),l=t.getSouthWest();return[gn.latLng((i.lat+r.lat)/2,(i.lng+r.lng)/2),gn.latLng((r.lat+o.lat)/2,(r.lng+o.lng)/2),gn.latLng((l.lat+o.lat)/2,(l.lng+o.lng)/2),gn.latLng((i.lat+l.lat)/2,(i.lng+l.lng)/2)]})}setName(t){At.measure("TextRectangle.setName",()=>{this.properties.style||(this.properties.style={textStyle:this._textStyle,name:t}),this.properties.style.name=t,this.fire("properties:updated",{shape:this,properties:this.properties,source:"setName"})})}getName(){return At.measure("TextRectangle.getName",()=>{var t,i;return((i=(t=this.properties)==null?void 0:t.style)==null?void 0:i.name)||""})}_animateZoom(t){if(this.map)try{const i=this._path;if(i&&(i.style.display="none"),this._textNode&&(this._textNode.style.display="none"),i){const r=i.style.transform;i.style.transform="",setTimeout(()=>{i&&(i.style.transform=r,i.style.display=""),this._textNode&&(this._textNode.style.display="",this._textRedraw())},300)}}catch(i){console.warn("[TextRectangle] Erreur pendant l'animation du zoom:",i),setTimeout(()=>{try{this._path&&(this._path.style.display=""),this._textNode&&(this._textNode.style.display="",this._textRedraw())}catch(r){console.error("[TextRectangle] Erreur lors de la restauration après animation:",r)}},300)}}}function gy(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function OM(e){return e.type==="Feature"?e.geometry:e}function d4(e,n,t={}){if(t.final===!0)return IM(e,n);const i=gy(e),r=gy(n),o=Xl(i[0]),l=Xl(r[0]),h=Xl(i[1]),p=Xl(r[1]),m=Math.sin(l-o)*Math.cos(p),_=Math.cos(h)*Math.sin(p)-Math.sin(h)*Math.cos(p)*Math.cos(l-o);return Mg(Math.atan2(m,_))}function IM(e,n){let t=d4(n,e);return t=(t+180)%360,t}function FM(e,n,t={}){const r=OM(e).coordinates;let o=0;for(let l=0;l<r.length&&!(n>=o&&l===r.length-1);l++)if(o>=n){const h=n-o;if(h){const p=d4(r[l],r[l-1])-180;return xm(r[l],h,p,t)}else return hp(r[l])}else o+=wm(r[l],r[l+1],t);return hp(r[r.length-1])}var Tg=FM;function zM(e,n){var t,i,r,o,l,h,p,m,_,w,E=0,b=e.type==="FeatureCollection",D=e.type==="Feature",j=b?e.features.length:1;for(t=0;t<j;t++){for(h=b?e.features[t].geometry:D?e.geometry:e,m=b?e.features[t].properties:D?e.properties:{},_=b?e.features[t].bbox:D?e.bbox:void 0,w=b?e.features[t].id:D?e.id:void 0,p=h?h.type==="GeometryCollection":!1,l=p?h.geometries.length:1,r=0;r<l;r++){if(o=p?h.geometries[r]:h,o===null){if(n(null,E,m,_,w)===!1)return!1;continue}switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(n(o,E,m,_,w)===!1)return!1;break}case"GeometryCollection":{for(i=0;i<o.geometries.length;i++)if(n(o.geometries[i],E,m,_,w)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}E++}}function jM(e,n,t){var i=t;return zM(e,function(r,o,l,h,p){o===0&&t===void 0?i=r:i=n(i,r,o,l,h,p)}),i}function p4(e){return jM(e,(n,t)=>n+UM(t),0)}function UM(e){let n=0,t;switch(e.type){case"Polygon":return my(e.coordinates);case"MultiPolygon":for(t=0;t<e.coordinates.length;t++)n+=my(e.coordinates[t]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function my(e){let n=0;if(e&&e.length>0){n+=Math.abs(vy(e[0]));for(let t=1;t<e.length;t++)n-=Math.abs(vy(e[t]))}return n}var $M=ba*ba/2,q0=Math.PI/180;function vy(e){const n=e.length-1;if(n<=2)return 0;let t=0,i=0;for(;i<n;){const r=e[i],o=e[i+1===n?0:i+1],l=e[i+2>=n?(i+2)%n:i+2],h=r[0]*q0,p=o[1]*q0,m=l[0]*q0;t+=(m-h)*Math.sin(p),i++}return t*$M}var vu=p4;function g4(e,n,t){if(e!==null)for(var i,r,o,l,h,p,m,_=0,w=0,E,b=e.type,D=b==="FeatureCollection",j=b==="Feature",Q=D?e.features.length:1,F=0;F<Q;F++){m=D?e.features[F].geometry:j?e.geometry:e,E=m?m.type==="GeometryCollection":!1,h=E?m.geometries.length:1;for(var V=0;V<h;V++){var pe=0,Ee=0;if(l=E?m.geometries[V]:m,l!==null){p=l.coordinates;var Ie=l.type;switch(_=Ie==="Polygon"||Ie==="MultiPolygon"?1:0,Ie){case null:break;case"Point":if(n(p,w,F,pe,Ee)===!1)return!1;w++,pe++;break;case"LineString":case"MultiPoint":for(i=0;i<p.length;i++){if(n(p[i],w,F,pe,Ee)===!1)return!1;w++,Ie==="MultiPoint"&&pe++}Ie==="LineString"&&pe++;break;case"Polygon":case"MultiLineString":for(i=0;i<p.length;i++){for(r=0;r<p[i].length-_;r++){if(n(p[i][r],w,F,pe,Ee)===!1)return!1;w++}Ie==="MultiLineString"&&pe++,Ie==="Polygon"&&Ee++}Ie==="Polygon"&&pe++;break;case"MultiPolygon":for(i=0;i<p.length;i++){for(Ee=0,r=0;r<p[i].length;r++){for(o=0;o<p[i][r].length-_;o++){if(n(p[i][r][o],w,F,pe,Ee)===!1)return!1;w++}Ee++}pe++}break;case"GeometryCollection":for(i=0;i<l.geometries.length;i++)if(g4(l.geometries[i],n)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function qM(e,n={}){let t=0,i=0,r=0;return g4(e,function(o){t+=o[0],i+=o[1],r++}),hp([t/r,i/r],n.properties)}var Df=qM;function GM(e,n,t={}){const i=t.steps||64,r=t.properties?t.properties:!Array.isArray(e)&&e.type==="Feature"&&e.properties?e.properties:{},o=[];for(let l=0;l<i;l++)o.push(xm(e,n,l*-360/i,t).geometry.coordinates);return o.push(o[0]),El([o],r)}var VM=GM,HM=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,G0=Math.ceil,Sl=Math.floor,Ua="[BigNumber Error] ",yy=Ua+"Number primitive has more than 15 significant digits: ",Vl=1e14,ji=14,_y=9007199254740991,V0=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],hc=1e7,al=1e9;function m4(e){var n,t,i,r=V.prototype={constructor:V,toString:null,valueOf:null},o=new V(1),l=20,h=4,p=-7,m=21,_=-1e7,w=1e7,E=!1,b=1,D=0,j={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},Q="0123456789abcdefghijklmnopqrstuvwxyz",F=!0;function V(O,H){var le,G,I,Y,$,R,Z,se,ie=this;if(!(ie instanceof V))return new V(O,H);if(H==null){if(O&&O._isBigNumber===!0){ie.s=O.s,!O.c||O.e>w?ie.c=ie.e=null:O.e<_?ie.c=[ie.e=0]:(ie.e=O.e,ie.c=O.c.slice());return}if((R=typeof O=="number")&&O*0==0){if(ie.s=1/O<0?(O=-O,-1):1,O===~~O){for(Y=0,$=O;$>=10;$/=10,Y++);Y>w?ie.c=ie.e=null:(ie.e=Y,ie.c=[O]);return}se=String(O)}else{if(!HM.test(se=String(O)))return i(ie,se,R);ie.s=se.charCodeAt(0)==45?(se=se.slice(1),-1):1}(Y=se.indexOf("."))>-1&&(se=se.replace(".","")),($=se.search(/e/i))>0?(Y<0&&(Y=$),Y+=+se.slice($+1),se=se.substring(0,$)):Y<0&&(Y=se.length)}else{if(As(H,2,Q.length,"Base"),H==10&&F)return ie=new V(O),nt(ie,l+ie.e+1,h);if(se=String(O),R=typeof O=="number"){if(O*0!=0)return i(ie,se,R,H);if(ie.s=1/O<0?(se=se.slice(1),-1):1,V.DEBUG&&se.replace(/^0\.0*|\./,"").length>15)throw Error(yy+O)}else ie.s=se.charCodeAt(0)===45?(se=se.slice(1),-1):1;for(le=Q.slice(0,H),Y=$=0,Z=se.length;$<Z;$++)if(le.indexOf(G=se.charAt($))<0){if(G=="."){if($>Y){Y=Z;continue}}else if(!I&&(se==se.toUpperCase()&&(se=se.toLowerCase())||se==se.toLowerCase()&&(se=se.toUpperCase()))){I=!0,$=-1,Y=0;continue}return i(ie,String(O),R,H)}R=!1,se=t(se,H,10,ie.s),(Y=se.indexOf("."))>-1?se=se.replace(".",""):Y=se.length}for($=0;se.charCodeAt($)===48;$++);for(Z=se.length;se.charCodeAt(--Z)===48;);if(se=se.slice($,++Z)){if(Z-=$,R&&V.DEBUG&&Z>15&&(O>_y||O!==Sl(O)))throw Error(yy+ie.s*O);if((Y=Y-$-1)>w)ie.c=ie.e=null;else if(Y<_)ie.c=[ie.e=0];else{if(ie.e=Y,ie.c=[],$=(Y+1)%ji,Y<0&&($+=ji),$<Z){for($&&ie.c.push(+se.slice(0,$)),Z-=ji;$<Z;)ie.c.push(+se.slice($,$+=ji));$=ji-(se=se.slice($)).length}else $-=Z;for(;$--;se+="0");ie.c.push(+se)}}else ie.c=[ie.e=0]}V.clone=m4,V.ROUND_UP=0,V.ROUND_DOWN=1,V.ROUND_CEIL=2,V.ROUND_FLOOR=3,V.ROUND_HALF_UP=4,V.ROUND_HALF_DOWN=5,V.ROUND_HALF_EVEN=6,V.ROUND_HALF_CEIL=7,V.ROUND_HALF_FLOOR=8,V.EUCLID=9,V.config=V.set=function(O){var H,le;if(O!=null)if(typeof O=="object"){if(O.hasOwnProperty(H="DECIMAL_PLACES")&&(le=O[H],As(le,0,al,H),l=le),O.hasOwnProperty(H="ROUNDING_MODE")&&(le=O[H],As(le,0,8,H),h=le),O.hasOwnProperty(H="EXPONENTIAL_AT")&&(le=O[H],le&&le.pop?(As(le[0],-1e9,0,H),As(le[1],0,al,H),p=le[0],m=le[1]):(As(le,-1e9,al,H),p=-(m=le<0?-le:le))),O.hasOwnProperty(H="RANGE"))if(le=O[H],le&&le.pop)As(le[0],-1e9,-1,H),As(le[1],1,al,H),_=le[0],w=le[1];else if(As(le,-1e9,al,H),le)_=-(w=le<0?-le:le);else throw Error(Ua+H+" cannot be zero: "+le);if(O.hasOwnProperty(H="CRYPTO"))if(le=O[H],le===!!le)if(le)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))E=le;else throw E=!le,Error(Ua+"crypto unavailable");else E=le;else throw Error(Ua+H+" not true or false: "+le);if(O.hasOwnProperty(H="MODULO_MODE")&&(le=O[H],As(le,0,9,H),b=le),O.hasOwnProperty(H="POW_PRECISION")&&(le=O[H],As(le,0,al,H),D=le),O.hasOwnProperty(H="FORMAT"))if(le=O[H],typeof le=="object")j=le;else throw Error(Ua+H+" not an object: "+le);if(O.hasOwnProperty(H="ALPHABET"))if(le=O[H],typeof le=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(le))F=le.slice(0,10)=="0123456789",Q=le;else throw Error(Ua+H+" invalid: "+le)}else throw Error(Ua+"Object expected: "+O);return{DECIMAL_PLACES:l,ROUNDING_MODE:h,EXPONENTIAL_AT:[p,m],RANGE:[_,w],CRYPTO:E,MODULO_MODE:b,POW_PRECISION:D,FORMAT:j,ALPHABET:Q}},V.isBigNumber=function(O){if(!O||O._isBigNumber!==!0)return!1;if(!V.DEBUG)return!0;var H,le,G=O.c,I=O.e,Y=O.s;e:if({}.toString.call(G)=="[object Array]"){if((Y===1||Y===-1)&&I>=-1e9&&I<=al&&I===Sl(I)){if(G[0]===0){if(I===0&&G.length===1)return!0;break e}if(H=(I+1)%ji,H<1&&(H+=ji),String(G[0]).length==H){for(H=0;H<G.length;H++)if(le=G[H],le<0||le>=Vl||le!==Sl(le))break e;if(le!==0)return!0}}}else if(G===null&&I===null&&(Y===null||Y===1||Y===-1))return!0;throw Error(Ua+"Invalid BigNumber: "+O)},V.maximum=V.max=function(){return Ee(arguments,-1)},V.minimum=V.min=function(){return Ee(arguments,1)},V.random=function(){var O=9007199254740992,H=Math.random()*O&2097151?function(){return Sl(Math.random()*O)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(le){var G,I,Y,$,R,Z=0,se=[],ie=new V(o);if(le==null?le=l:As(le,0,al),$=G0(le/ji),E)if(crypto.getRandomValues){for(G=crypto.getRandomValues(new Uint32Array($*=2));Z<$;)R=G[Z]*131072+(G[Z+1]>>>11),R>=9e15?(I=crypto.getRandomValues(new Uint32Array(2)),G[Z]=I[0],G[Z+1]=I[1]):(se.push(R%1e14),Z+=2);Z=$/2}else if(crypto.randomBytes){for(G=crypto.randomBytes($*=7);Z<$;)R=(G[Z]&31)*281474976710656+G[Z+1]*1099511627776+G[Z+2]*4294967296+G[Z+3]*16777216+(G[Z+4]<<16)+(G[Z+5]<<8)+G[Z+6],R>=9e15?crypto.randomBytes(7).copy(G,Z):(se.push(R%1e14),Z+=7);Z=$/7}else throw E=!1,Error(Ua+"crypto unavailable");if(!E)for(;Z<$;)R=H(),R<9e15&&(se[Z++]=R%1e14);for($=se[--Z],le%=ji,$&&le&&(R=V0[ji-le],se[Z]=Sl($/R)*R);se[Z]===0;se.pop(),Z--);if(Z<0)se=[Y=0];else{for(Y=-1;se[0]===0;se.splice(0,1),Y-=ji);for(Z=1,R=se[0];R>=10;R/=10,Z++);Z<ji&&(Y-=ji-Z)}return ie.e=Y,ie.c=se,ie}}(),V.sum=function(){for(var O=1,H=arguments,le=new V(H[0]);O<H.length;)le=le.plus(H[O++]);return le},t=function(){var O="0123456789";function H(le,G,I,Y){for(var $,R=[0],Z,se=0,ie=le.length;se<ie;){for(Z=R.length;Z--;R[Z]*=G);for(R[0]+=Y.indexOf(le.charAt(se++)),$=0;$<R.length;$++)R[$]>I-1&&(R[$+1]==null&&(R[$+1]=0),R[$+1]+=R[$]/I|0,R[$]%=I)}return R.reverse()}return function(le,G,I,Y,$){var R,Z,se,ie,Ae,Te,ut,X,ke=le.indexOf("."),B=l,W=h;for(ke>=0&&(ie=D,D=0,le=le.replace(".",""),X=new V(G),Te=X.pow(le.length-ke),D=ie,X.c=H(Hu(Cl(Te.c),Te.e,"0"),10,I,O),X.e=X.c.length),ut=H(le,G,I,$?(R=Q,O):(R=O,Q)),se=ie=ut.length;ut[--ie]==0;ut.pop());if(!ut[0])return R.charAt(0);if(ke<0?--se:(Te.c=ut,Te.e=se,Te.s=Y,Te=n(Te,X,B,W,I),ut=Te.c,Ae=Te.r,se=Te.e),Z=se+B+1,ke=ut[Z],ie=I/2,Ae=Ae||Z<0||ut[Z+1]!=null,Ae=W<4?(ke!=null||Ae)&&(W==0||W==(Te.s<0?3:2)):ke>ie||ke==ie&&(W==4||Ae||W==6&&ut[Z-1]&1||W==(Te.s<0?8:7)),Z<1||!ut[0])le=Ae?Hu(R.charAt(1),-B,R.charAt(0)):R.charAt(0);else{if(ut.length=Z,Ae)for(--I;++ut[--Z]>I;)ut[Z]=0,Z||(++se,ut=[1].concat(ut));for(ie=ut.length;!ut[--ie];);for(ke=0,le="";ke<=ie;le+=R.charAt(ut[ke++]));le=Hu(le,se,R.charAt(0))}return le}}(),n=function(){function O(G,I,Y){var $,R,Z,se,ie=0,Ae=G.length,Te=I%hc,ut=I/hc|0;for(G=G.slice();Ae--;)Z=G[Ae]%hc,se=G[Ae]/hc|0,$=ut*Z+se*Te,R=Te*Z+$%hc*hc+ie,ie=(R/Y|0)+($/hc|0)+ut*se,G[Ae]=R%Y;return ie&&(G=[ie].concat(G)),G}function H(G,I,Y,$){var R,Z;if(Y!=$)Z=Y>$?1:-1;else for(R=Z=0;R<Y;R++)if(G[R]!=I[R]){Z=G[R]>I[R]?1:-1;break}return Z}function le(G,I,Y,$){for(var R=0;Y--;)G[Y]-=R,R=G[Y]<I[Y]?1:0,G[Y]=R*$+G[Y]-I[Y];for(;!G[0]&&G.length>1;G.splice(0,1));}return function(G,I,Y,$,R){var Z,se,ie,Ae,Te,ut,X,ke,B,W,he,ne,re,ee,oe,Se,te,ae=G.s==I.s?1:-1,Le=G.c,ye=I.c;if(!Le||!Le[0]||!ye||!ye[0])return new V(!G.s||!I.s||(Le?ye&&Le[0]==ye[0]:!ye)?NaN:Le&&Le[0]==0||!ye?ae*0:ae/0);for(ke=new V(ae),B=ke.c=[],se=G.e-I.e,ae=Y+se+1,R||(R=Vl,se=Pl(G.e/ji)-Pl(I.e/ji),ae=ae/ji|0),ie=0;ye[ie]==(Le[ie]||0);ie++);if(ye[ie]>(Le[ie]||0)&&se--,ae<0)B.push(1),Ae=!0;else{for(ee=Le.length,Se=ye.length,ie=0,ae+=2,Te=Sl(R/(ye[0]+1)),Te>1&&(ye=O(ye,Te,R),Le=O(Le,Te,R),Se=ye.length,ee=Le.length),re=Se,W=Le.slice(0,Se),he=W.length;he<Se;W[he++]=0);te=ye.slice(),te=[0].concat(te),oe=ye[0],ye[1]>=R/2&&oe++;do{if(Te=0,Z=H(ye,W,Se,he),Z<0){if(ne=W[0],Se!=he&&(ne=ne*R+(W[1]||0)),Te=Sl(ne/oe),Te>1)for(Te>=R&&(Te=R-1),ut=O(ye,Te,R),X=ut.length,he=W.length;H(ut,W,X,he)==1;)Te--,le(ut,Se<X?te:ye,X,R),X=ut.length,Z=1;else Te==0&&(Z=Te=1),ut=ye.slice(),X=ut.length;if(X<he&&(ut=[0].concat(ut)),le(W,ut,he,R),he=W.length,Z==-1)for(;H(ye,W,Se,he)<1;)Te++,le(W,Se<he?te:ye,he,R),he=W.length}else Z===0&&(Te++,W=[0]);B[ie++]=Te,W[0]?W[he++]=Le[re]||0:(W=[Le[re]],he=1)}while((re++<ee||W[0]!=null)&&ae--);Ae=W[0]!=null,B[0]||B.splice(0,1)}if(R==Vl){for(ie=1,ae=B[0];ae>=10;ae/=10,ie++);nt(ke,Y+(ke.e=ie+se*ji-1)+1,$,Ae)}else ke.e=se,ke.r=+Ae;return ke}}();function pe(O,H,le,G){var I,Y,$,R,Z;if(le==null?le=h:As(le,0,8),!O.c)return O.toString();if(I=O.c[0],$=O.e,H==null)Z=Cl(O.c),Z=G==1||G==2&&($<=p||$>=m)?Ad(Z,$):Hu(Z,$,"0");else if(O=nt(new V(O),H,le),Y=O.e,Z=Cl(O.c),R=Z.length,G==1||G==2&&(H<=Y||Y<=p)){for(;R<H;Z+="0",R++);Z=Ad(Z,Y)}else if(H-=$,Z=Hu(Z,Y,"0"),Y+1>R){if(--H>0)for(Z+=".";H--;Z+="0");}else if(H+=Y-R,H>0)for(Y+1==R&&(Z+=".");H--;Z+="0");return O.s<0&&I?"-"+Z:Z}function Ee(O,H){for(var le,G,I=1,Y=new V(O[0]);I<O.length;I++)G=new V(O[I]),(!G.s||(le=Wc(Y,G))===H||le===0&&Y.s===H)&&(Y=G);return Y}function Ie(O,H,le){for(var G=1,I=H.length;!H[--I];H.pop());for(I=H[0];I>=10;I/=10,G++);return(le=G+le*ji-1)>w?O.c=O.e=null:le<_?O.c=[O.e=0]:(O.e=le,O.c=H),O}i=function(){var O=/^(-?)0([xbo])(?=\w[\w.]*$)/i,H=/^([^.]+)\.$/,le=/^\.([^.]+)$/,G=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(Y,$,R,Z){var se,ie=R?$:$.replace(I,"");if(G.test(ie))Y.s=isNaN(ie)?null:ie<0?-1:1;else{if(!R&&(ie=ie.replace(O,function(Ae,Te,ut){return se=(ut=ut.toLowerCase())=="x"?16:ut=="b"?2:8,!Z||Z==se?Te:Ae}),Z&&(se=Z,ie=ie.replace(H,"$1").replace(le,"0.$1")),$!=ie))return new V(ie,se);if(V.DEBUG)throw Error(Ua+"Not a"+(Z?" base "+Z:"")+" number: "+$);Y.s=null}Y.c=Y.e=null}}();function nt(O,H,le,G){var I,Y,$,R,Z,se,ie,Ae=O.c,Te=V0;if(Ae){e:{for(I=1,R=Ae[0];R>=10;R/=10,I++);if(Y=H-I,Y<0)Y+=ji,$=H,Z=Ae[se=0],ie=Sl(Z/Te[I-$-1]%10);else if(se=G0((Y+1)/ji),se>=Ae.length)if(G){for(;Ae.length<=se;Ae.push(0));Z=ie=0,I=1,Y%=ji,$=Y-ji+1}else break e;else{for(Z=R=Ae[se],I=1;R>=10;R/=10,I++);Y%=ji,$=Y-ji+I,ie=$<0?0:Sl(Z/Te[I-$-1]%10)}if(G=G||H<0||Ae[se+1]!=null||($<0?Z:Z%Te[I-$-1]),G=le<4?(ie||G)&&(le==0||le==(O.s<0?3:2)):ie>5||ie==5&&(le==4||G||le==6&&(Y>0?$>0?Z/Te[I-$]:0:Ae[se-1])%10&1||le==(O.s<0?8:7)),H<1||!Ae[0])return Ae.length=0,G?(H-=O.e+1,Ae[0]=Te[(ji-H%ji)%ji],O.e=-H||0):Ae[0]=O.e=0,O;if(Y==0?(Ae.length=se,R=1,se--):(Ae.length=se+1,R=Te[ji-Y],Ae[se]=$>0?Sl(Z/Te[I-$]%Te[$])*R:0),G)for(;;)if(se==0){for(Y=1,$=Ae[0];$>=10;$/=10,Y++);for($=Ae[0]+=R,R=1;$>=10;$/=10,R++);Y!=R&&(O.e++,Ae[0]==Vl&&(Ae[0]=1));break}else{if(Ae[se]+=R,Ae[se]!=Vl)break;Ae[se--]=0,R=1}for(Y=Ae.length;Ae[--Y]===0;Ae.pop());}O.e>w?O.c=O.e=null:O.e<_&&(O.c=[O.e=0])}return O}function We(O){var H,le=O.e;return le===null?O.toString():(H=Cl(O.c),H=le<=p||le>=m?Ad(H,le):Hu(H,le,"0"),O.s<0?"-"+H:H)}return r.absoluteValue=r.abs=function(){var O=new V(this);return O.s<0&&(O.s=1),O},r.comparedTo=function(O,H){return Wc(this,new V(O,H))},r.decimalPlaces=r.dp=function(O,H){var le,G,I,Y=this;if(O!=null)return As(O,0,al),H==null?H=h:As(H,0,8),nt(new V(Y),O+Y.e+1,H);if(!(le=Y.c))return null;if(G=((I=le.length-1)-Pl(this.e/ji))*ji,I=le[I])for(;I%10==0;I/=10,G--);return G<0&&(G=0),G},r.dividedBy=r.div=function(O,H){return n(this,new V(O,H),l,h)},r.dividedToIntegerBy=r.idiv=function(O,H){return n(this,new V(O,H),0,1)},r.exponentiatedBy=r.pow=function(O,H){var le,G,I,Y,$,R,Z,se,ie,Ae=this;if(O=new V(O),O.c&&!O.isInteger())throw Error(Ua+"Exponent not an integer: "+We(O));if(H!=null&&(H=new V(H)),R=O.e>14,!Ae.c||!Ae.c[0]||Ae.c[0]==1&&!Ae.e&&Ae.c.length==1||!O.c||!O.c[0])return ie=new V(Math.pow(+We(Ae),R?O.s*(2-Ed(O)):+We(O))),H?ie.mod(H):ie;if(Z=O.s<0,H){if(H.c?!H.c[0]:!H.s)return new V(NaN);G=!Z&&Ae.isInteger()&&H.isInteger(),G&&(Ae=Ae.mod(H))}else{if(O.e>9&&(Ae.e>0||Ae.e<-1||(Ae.e==0?Ae.c[0]>1||R&&Ae.c[1]>=24e7:Ae.c[0]<8e13||R&&Ae.c[0]<=9999975e7)))return Y=Ae.s<0&&Ed(O)?-0:0,Ae.e>-1&&(Y=1/Y),new V(Z?1/Y:Y);D&&(Y=G0(D/ji+2))}for(R?(le=new V(.5),Z&&(O.s=1),se=Ed(O)):(I=Math.abs(+We(O)),se=I%2),ie=new V(o);;){if(se){if(ie=ie.times(Ae),!ie.c)break;Y?ie.c.length>Y&&(ie.c.length=Y):G&&(ie=ie.mod(H))}if(I){if(I=Sl(I/2),I===0)break;se=I%2}else if(O=O.times(le),nt(O,O.e+1,1),O.e>14)se=Ed(O);else{if(I=+We(O),I===0)break;se=I%2}Ae=Ae.times(Ae),Y?Ae.c&&Ae.c.length>Y&&(Ae.c.length=Y):G&&(Ae=Ae.mod(H))}return G?ie:(Z&&(ie=o.div(ie)),H?ie.mod(H):Y?nt(ie,D,h,$):ie)},r.integerValue=function(O){var H=new V(this);return O==null?O=h:As(O,0,8),nt(H,H.e+1,O)},r.isEqualTo=r.eq=function(O,H){return Wc(this,new V(O,H))===0},r.isFinite=function(){return!!this.c},r.isGreaterThan=r.gt=function(O,H){return Wc(this,new V(O,H))>0},r.isGreaterThanOrEqualTo=r.gte=function(O,H){return(H=Wc(this,new V(O,H)))===1||H===0},r.isInteger=function(){return!!this.c&&Pl(this.e/ji)>this.c.length-2},r.isLessThan=r.lt=function(O,H){return Wc(this,new V(O,H))<0},r.isLessThanOrEqualTo=r.lte=function(O,H){return(H=Wc(this,new V(O,H)))===-1||H===0},r.isNaN=function(){return!this.s},r.isNegative=function(){return this.s<0},r.isPositive=function(){return this.s>0},r.isZero=function(){return!!this.c&&this.c[0]==0},r.minus=function(O,H){var le,G,I,Y,$=this,R=$.s;if(O=new V(O,H),H=O.s,!R||!H)return new V(NaN);if(R!=H)return O.s=-H,$.plus(O);var Z=$.e/ji,se=O.e/ji,ie=$.c,Ae=O.c;if(!Z||!se){if(!ie||!Ae)return ie?(O.s=-H,O):new V(Ae?$:NaN);if(!ie[0]||!Ae[0])return Ae[0]?(O.s=-H,O):new V(ie[0]?$:h==3?-0:0)}if(Z=Pl(Z),se=Pl(se),ie=ie.slice(),R=Z-se){for((Y=R<0)?(R=-R,I=ie):(se=Z,I=Ae),I.reverse(),H=R;H--;I.push(0));I.reverse()}else for(G=(Y=(R=ie.length)<(H=Ae.length))?R:H,R=H=0;H<G;H++)if(ie[H]!=Ae[H]){Y=ie[H]<Ae[H];break}if(Y&&(I=ie,ie=Ae,Ae=I,O.s=-O.s),H=(G=Ae.length)-(le=ie.length),H>0)for(;H--;ie[le++]=0);for(H=Vl-1;G>R;){if(ie[--G]<Ae[G]){for(le=G;le&&!ie[--le];ie[le]=H);--ie[le],ie[G]+=Vl}ie[G]-=Ae[G]}for(;ie[0]==0;ie.splice(0,1),--se);return ie[0]?Ie(O,ie,se):(O.s=h==3?-1:1,O.c=[O.e=0],O)},r.modulo=r.mod=function(O,H){var le,G,I=this;return O=new V(O,H),!I.c||!O.s||O.c&&!O.c[0]?new V(NaN):!O.c||I.c&&!I.c[0]?new V(I):(b==9?(G=O.s,O.s=1,le=n(I,O,0,3),O.s=G,le.s*=G):le=n(I,O,0,b),O=I.minus(le.times(O)),!O.c[0]&&b==1&&(O.s=I.s),O)},r.multipliedBy=r.times=function(O,H){var le,G,I,Y,$,R,Z,se,ie,Ae,Te,ut,X,ke,B,W=this,he=W.c,ne=(O=new V(O,H)).c;if(!he||!ne||!he[0]||!ne[0])return!W.s||!O.s||he&&!he[0]&&!ne||ne&&!ne[0]&&!he?O.c=O.e=O.s=null:(O.s*=W.s,!he||!ne?O.c=O.e=null:(O.c=[0],O.e=0)),O;for(G=Pl(W.e/ji)+Pl(O.e/ji),O.s*=W.s,Z=he.length,Ae=ne.length,Z<Ae&&(X=he,he=ne,ne=X,I=Z,Z=Ae,Ae=I),I=Z+Ae,X=[];I--;X.push(0));for(ke=Vl,B=hc,I=Ae;--I>=0;){for(le=0,Te=ne[I]%B,ut=ne[I]/B|0,$=Z,Y=I+$;Y>I;)se=he[--$]%B,ie=he[$]/B|0,R=ut*se+ie*Te,se=Te*se+R%B*B+X[Y]+le,le=(se/ke|0)+(R/B|0)+ut*ie,X[Y--]=se%ke;X[Y]=le}return le?++G:X.splice(0,1),Ie(O,X,G)},r.negated=function(){var O=new V(this);return O.s=-O.s||null,O},r.plus=function(O,H){var le,G=this,I=G.s;if(O=new V(O,H),H=O.s,!I||!H)return new V(NaN);if(I!=H)return O.s=-H,G.minus(O);var Y=G.e/ji,$=O.e/ji,R=G.c,Z=O.c;if(!Y||!$){if(!R||!Z)return new V(I/0);if(!R[0]||!Z[0])return Z[0]?O:new V(R[0]?G:I*0)}if(Y=Pl(Y),$=Pl($),R=R.slice(),I=Y-$){for(I>0?($=Y,le=Z):(I=-I,le=R),le.reverse();I--;le.push(0));le.reverse()}for(I=R.length,H=Z.length,I-H<0&&(le=Z,Z=R,R=le,H=I),I=0;H;)I=(R[--H]=R[H]+Z[H]+I)/Vl|0,R[H]=Vl===R[H]?0:R[H]%Vl;return I&&(R=[I].concat(R),++$),Ie(O,R,$)},r.precision=r.sd=function(O,H){var le,G,I,Y=this;if(O!=null&&O!==!!O)return As(O,1,al),H==null?H=h:As(H,0,8),nt(new V(Y),O,H);if(!(le=Y.c))return null;if(I=le.length-1,G=I*ji+1,I=le[I]){for(;I%10==0;I/=10,G--);for(I=le[0];I>=10;I/=10,G++);}return O&&Y.e+1>G&&(G=Y.e+1),G},r.shiftedBy=function(O){return As(O,-9007199254740991,_y),this.times("1e"+O)},r.squareRoot=r.sqrt=function(){var O,H,le,G,I,Y=this,$=Y.c,R=Y.s,Z=Y.e,se=l+4,ie=new V("0.5");if(R!==1||!$||!$[0])return new V(!R||R<0&&(!$||$[0])?NaN:$?Y:1/0);if(R=Math.sqrt(+We(Y)),R==0||R==1/0?(H=Cl($),(H.length+Z)%2==0&&(H+="0"),R=Math.sqrt(+H),Z=Pl((Z+1)/2)-(Z<0||Z%2),R==1/0?H="5e"+Z:(H=R.toExponential(),H=H.slice(0,H.indexOf("e")+1)+Z),le=new V(H)):le=new V(R+""),le.c[0]){for(Z=le.e,R=Z+se,R<3&&(R=0);;)if(I=le,le=ie.times(I.plus(n(Y,I,se,1))),Cl(I.c).slice(0,R)===(H=Cl(le.c)).slice(0,R))if(le.e<Z&&--R,H=H.slice(R-3,R+1),H=="9999"||!G&&H=="4999"){if(!G&&(nt(I,I.e+l+2,0),I.times(I).eq(Y))){le=I;break}se+=4,R+=4,G=1}else{(!+H||!+H.slice(1)&&H.charAt(0)=="5")&&(nt(le,le.e+l+2,1),O=!le.times(le).eq(Y));break}}return nt(le,le.e+l+1,h,O)},r.toExponential=function(O,H){return O!=null&&(As(O,0,al),O++),pe(this,O,H,1)},r.toFixed=function(O,H){return O!=null&&(As(O,0,al),O=O+this.e+1),pe(this,O,H)},r.toFormat=function(O,H,le){var G,I=this;if(le==null)O!=null&&H&&typeof H=="object"?(le=H,H=null):O&&typeof O=="object"?(le=O,O=H=null):le=j;else if(typeof le!="object")throw Error(Ua+"Argument not an object: "+le);if(G=I.toFixed(O,H),I.c){var Y,$=G.split("."),R=+le.groupSize,Z=+le.secondaryGroupSize,se=le.groupSeparator||"",ie=$[0],Ae=$[1],Te=I.s<0,ut=Te?ie.slice(1):ie,X=ut.length;if(Z&&(Y=R,R=Z,Z=Y,X-=Y),R>0&&X>0){for(Y=X%R||R,ie=ut.substr(0,Y);Y<X;Y+=R)ie+=se+ut.substr(Y,R);Z>0&&(ie+=se+ut.slice(Y)),Te&&(ie="-"+ie)}G=Ae?ie+(le.decimalSeparator||"")+((Z=+le.fractionGroupSize)?Ae.replace(new RegExp("\\d{"+Z+"}\\B","g"),"$&"+(le.fractionGroupSeparator||"")):Ae):ie}return(le.prefix||"")+G+(le.suffix||"")},r.toFraction=function(O){var H,le,G,I,Y,$,R,Z,se,ie,Ae,Te,ut=this,X=ut.c;if(O!=null&&(R=new V(O),!R.isInteger()&&(R.c||R.s!==1)||R.lt(o)))throw Error(Ua+"Argument "+(R.isInteger()?"out of range: ":"not an integer: ")+We(R));if(!X)return new V(ut);for(H=new V(o),se=le=new V(o),G=Z=new V(o),Te=Cl(X),Y=H.e=Te.length-ut.e-1,H.c[0]=V0[($=Y%ji)<0?ji+$:$],O=!O||R.comparedTo(H)>0?Y>0?H:se:R,$=w,w=1/0,R=new V(Te),Z.c[0]=0;ie=n(R,H,0,1),I=le.plus(ie.times(G)),I.comparedTo(O)!=1;)le=G,G=I,se=Z.plus(ie.times(I=se)),Z=I,H=R.minus(ie.times(I=H)),R=I;return I=n(O.minus(le),G,0,1),Z=Z.plus(I.times(se)),le=le.plus(I.times(G)),Z.s=se.s=ut.s,Y=Y*2,Ae=n(se,G,Y,h).minus(ut).abs().comparedTo(n(Z,le,Y,h).minus(ut).abs())<1?[se,G]:[Z,le],w=$,Ae},r.toNumber=function(){return+We(this)},r.toPrecision=function(O,H){return O!=null&&As(O,1,al),pe(this,O,H,2)},r.toString=function(O){var H,le=this,G=le.s,I=le.e;return I===null?G?(H="Infinity",G<0&&(H="-"+H)):H="NaN":(O==null?H=I<=p||I>=m?Ad(Cl(le.c),I):Hu(Cl(le.c),I,"0"):O===10&&F?(le=nt(new V(le),l+I+1,h),H=Hu(Cl(le.c),le.e,"0")):(As(O,2,Q.length,"Base"),H=t(Hu(Cl(le.c),I,"0"),10,O,G,!0)),G<0&&le.c[0]&&(H="-"+H)),H},r.valueOf=r.toJSON=function(){return We(this)},r._isBigNumber=!0,r[Symbol.toStringTag]="BigNumber",r[Symbol.for("nodejs.util.inspect.custom")]=r.valueOf,e!=null&&V.set(e),V}function Pl(e){var n=e|0;return e>0||e===n?n:n-1}function Cl(e){for(var n,t,i=1,r=e.length,o=e[0]+"";i<r;){for(n=e[i++]+"",t=ji-n.length;t--;n="0"+n);o+=n}for(r=o.length;o.charCodeAt(--r)===48;);return o.slice(0,r+1||1)}function Wc(e,n){var t,i,r=e.c,o=n.c,l=e.s,h=n.s,p=e.e,m=n.e;if(!l||!h)return null;if(t=r&&!r[0],i=o&&!o[0],t||i)return t?i?0:-h:l;if(l!=h)return l;if(t=l<0,i=p==m,!r||!o)return i?0:!r^t?1:-1;if(!i)return p>m^t?1:-1;for(h=(p=r.length)<(m=o.length)?p:m,l=0;l<h;l++)if(r[l]!=o[l])return r[l]>o[l]^t?1:-1;return p==m?0:p>m^t?1:-1}function As(e,n,t,i){if(e<n||e>t||e!==Sl(e))throw Error(Ua+(i||"Argument")+(typeof e=="number"?e<n||e>t?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function Ed(e){var n=e.c.length-1;return Pl(e.e/ji)==n&&e.c[n]%2!=0}function Ad(e,n){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(n<0?"e":"e+")+n}function Hu(e,n,t){var i,r;if(n<0){for(r=t+".";++n;r+=t);e=r+e}else if(i=e.length,++n>i){for(r=t,n-=i;--n;r+=t);e+=r}else n<i&&(e=e.slice(0,n)+"."+e.slice(n));return e}var Cu=m4(),WM=class{constructor(e){Mt(this,"key");Mt(this,"left",null);Mt(this,"right",null);this.key=e}},pf=class extends WM{constructor(e){super(e)}},ZM=class{constructor(){Mt(this,"size",0);Mt(this,"modificationCount",0);Mt(this,"splayCount",0)}splay(e){const n=this.root;if(n==null)return this.compare(e,e),-1;let t=null,i=null,r=null,o=null,l=n;const h=this.compare;let p;for(;;)if(p=h(l.key,e),p>0){let m=l.left;if(m==null||(p=h(m.key,e),p>0&&(l.left=m.right,m.right=l,l=m,m=l.left,m==null)))break;t==null?i=l:t.left=l,t=l,l=m}else if(p<0){let m=l.right;if(m==null||(p=h(m.key,e),p<0&&(l.right=m.left,m.left=l,l=m,m=l.right,m==null)))break;r==null?o=l:r.right=l,r=l,l=m}else break;return r!=null&&(r.right=l.left,l.left=o),t!=null&&(t.left=l.right,l.right=i),this.root!==l&&(this.root=l,this.splayCount++),p}splayMin(e){let n=e,t=n.left;for(;t!=null;){const i=t;n.left=i.right,i.right=n,n=i,t=n.left}return n}splayMax(e){let n=e,t=n.right;for(;t!=null;){const i=t;n.right=i.left,i.left=n,n=i,t=n.right}return n}_delete(e){if(this.root==null||this.splay(e)!=0)return null;let t=this.root;const i=t,r=t.left;if(this.size--,r==null)this.root=t.right;else{const o=t.right;t=this.splayMax(r),t.right=o,this.root=t}return this.modificationCount++,i}addNewRoot(e,n){this.size++,this.modificationCount++;const t=this.root;if(t==null){this.root=e;return}n<0?(e.left=t,e.right=t.right,t.right=null):(e.right=t,e.left=t.left,t.left=null),this.root=e}_first(){const e=this.root;return e==null?null:(this.root=this.splayMin(e),this.root)}_last(){const e=this.root;return e==null?null:(this.root=this.splayMax(e),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(e){return this.validKey(e)&&this.splay(e)==0}defaultCompare(){return(e,n)=>e<n?-1:e>n?1:0}wrap(){return{getRoot:()=>this.root,setRoot:e=>{this.root=e},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:e=>{this.splayCount=e},splay:e=>this.splay(e),has:e=>this.has(e)}}},Ky,Jy,dp=class wf extends ZM{constructor(t,i){super();Mt(this,"root",null);Mt(this,"compare");Mt(this,"validKey");Mt(this,Ky,"[object Set]");this.compare=t??this.defaultCompare(),this.validKey=i??(r=>r!=null&&r!=null)}delete(t){return this.validKey(t)?this._delete(t)!=null:!1}deleteAll(t){for(const i of t)this.delete(i)}forEach(t){const i=this[Symbol.iterator]();let r;for(;r=i.next(),!r.done;)t(r.value,r.value,this)}add(t){const i=this.splay(t);return i!=0&&this.addNewRoot(new pf(t),i),this}addAndReturn(t){const i=this.splay(t);return i!=0&&this.addNewRoot(new pf(t),i),this.root.key}addAll(t){for(const i of t)this.add(i)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(t){if(t==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(t)<0)return this.root.key;let r=this.root.left;if(r==null)return null;let o=r.right;for(;o!=null;)r=o,o=r.right;return r.key}firstAfter(t){if(t==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(t)>0)return this.root.key;let r=this.root.right;if(r==null)return null;let o=r.left;for(;o!=null;)r=o,o=r.left;return r.key}retainAll(t){const i=new wf(this.compare,this.validKey),r=this.modificationCount;for(const o of t){if(r!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(o)&&this.splay(o)==0&&i.add(this.root.key)}i.size!=this.size&&(this.root=i.root,this.size=i.size,this.modificationCount++)}lookup(t){return!this.validKey(t)||this.splay(t)!=0?null:this.root.key}intersection(t){const i=new wf(this.compare,this.validKey);for(const r of this)t.has(r)&&i.add(r);return i}difference(t){const i=new wf(this.compare,this.validKey);for(const r of this)t.has(r)||i.add(r);return i}union(t){const i=this.clone();return i.addAll(t),i}clone(){const t=new wf(this.compare,this.validKey);return t.size=this.size,t.root=this.copyNode(this.root),t}copyNode(t){if(t==null)return null;function i(o,l){let h,p;do{if(h=o.left,p=o.right,h!=null){const m=new pf(h.key);l.left=m,i(h,m)}if(p!=null){const m=new pf(p.key);l.right=m,o=p,l=m}}while(p!=null)}const r=new pf(t.key);return i(t,r),r}toSet(){return this.clone()}entries(){return new JM(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[(Jy=Symbol.iterator,Ky=Symbol.toStringTag,Jy)](){return new KM(this.wrap())}},v4=class{constructor(e){Mt(this,"tree");Mt(this,"path",new Array);Mt(this,"modificationCount",null);Mt(this,"splayCount");this.tree=e,this.splayCount=e.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const e=this.path[this.path.length-1];return this.getValue(e)}rebuildPath(e){this.path.splice(0,this.path.length),this.tree.splay(e),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(e){for(;e!=null;)this.path.push(e),e=e.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let t=this.tree.getRoot();for(;t!=null;)this.path.push(t),t=t.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let e=this.path[this.path.length-1],n=e.right;if(n!=null){for(;n!=null;)this.path.push(n),n=n.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===e;)e=this.path.pop();return this.path.length>0}},KM=class extends v4{getValue(e){return e.key}},JM=class extends v4{getValue(e){return[e.key,e.key]}},y4=e=>()=>e,Bg=e=>{const n=e?(t,i)=>i.minus(t).abs().isLessThanOrEqualTo(e):y4(!1);return(t,i)=>n(t,i)?0:t.comparedTo(i)};function YM(e){const n=e?(t,i,r,o,l)=>t.exponentiatedBy(2).isLessThanOrEqualTo(o.minus(i).exponentiatedBy(2).plus(l.minus(r).exponentiatedBy(2)).times(e)):y4(!1);return(t,i,r)=>{const o=t.x,l=t.y,h=r.x,p=r.y,m=l.minus(p).times(i.x.minus(h)).minus(o.minus(h).times(i.y.minus(p)));return n(m,o,l,h,p)?0:m.comparedTo(0)}}var XM=e=>e,QM=e=>{if(e){const n=new dp(Bg(e)),t=new dp(Bg(e)),i=(o,l)=>l.addAndReturn(o),r=o=>({x:i(o.x,n),y:i(o.y,t)});return r({x:new Cu(0),y:new Cu(0)}),r}return XM},Ng=e=>({set:n=>{ec=Ng(n)},reset:()=>Ng(e),compare:Bg(e),snap:QM(e),orient:YM(e)}),ec=Ng(),gf=(e,n)=>e.ll.x.isLessThanOrEqualTo(n.x)&&n.x.isLessThanOrEqualTo(e.ur.x)&&e.ll.y.isLessThanOrEqualTo(n.y)&&n.y.isLessThanOrEqualTo(e.ur.y),Dg=(e,n)=>{if(n.ur.x.isLessThan(e.ll.x)||e.ur.x.isLessThan(n.ll.x)||n.ur.y.isLessThan(e.ll.y)||e.ur.y.isLessThan(n.ll.y))return null;const t=e.ll.x.isLessThan(n.ll.x)?n.ll.x:e.ll.x,i=e.ur.x.isLessThan(n.ur.x)?e.ur.x:n.ur.x,r=e.ll.y.isLessThan(n.ll.y)?n.ll.y:e.ll.y,o=e.ur.y.isLessThan(n.ur.y)?e.ur.y:n.ur.y;return{ll:{x:t,y:r},ur:{x:i,y:o}}},Gd=(e,n)=>e.x.times(n.y).minus(e.y.times(n.x)),_4=(e,n)=>e.x.times(n.x).plus(e.y.times(n.y)),pp=e=>_4(e,e).sqrt(),e8=(e,n,t)=>{const i={x:n.x.minus(e.x),y:n.y.minus(e.y)},r={x:t.x.minus(e.x),y:t.y.minus(e.y)};return Gd(r,i).div(pp(r)).div(pp(i))},t8=(e,n,t)=>{const i={x:n.x.minus(e.x),y:n.y.minus(e.y)},r={x:t.x.minus(e.x),y:t.y.minus(e.y)};return _4(r,i).div(pp(r)).div(pp(i))},by=(e,n,t)=>n.y.isZero()?null:{x:e.x.plus(n.x.div(n.y).times(t.minus(e.y))),y:t},wy=(e,n,t)=>n.x.isZero()?null:{x:t,y:e.y.plus(n.y.div(n.x).times(t.minus(e.x)))},n8=(e,n,t,i)=>{if(n.x.isZero())return wy(t,i,e.x);if(i.x.isZero())return wy(e,n,t.x);if(n.y.isZero())return by(t,i,e.y);if(i.y.isZero())return by(e,n,t.y);const r=Gd(n,i);if(r.isZero())return null;const o={x:t.x.minus(e.x),y:t.y.minus(e.y)},l=Gd(o,n).div(r),h=Gd(o,i).div(r),p=e.x.plus(h.times(n.x)),m=t.x.plus(l.times(i.x)),_=e.y.plus(h.times(n.y)),w=t.y.plus(l.times(i.y)),E=p.plus(m).div(2),b=_.plus(w).div(2);return{x:E,y:b}},wu=class b4{constructor(n,t){Mt(this,"point");Mt(this,"isLeft");Mt(this,"segment");Mt(this,"otherSE");Mt(this,"consumedBy");n.events===void 0?n.events=[this]:n.events.push(this),this.point=n,this.isLeft=t}static compare(n,t){const i=b4.comparePoints(n.point,t.point);return i!==0?i:(n.point!==t.point&&n.link(t),n.isLeft!==t.isLeft?n.isLeft?1:-1:gp.compare(n.segment,t.segment))}static comparePoints(n,t){return n.x.isLessThan(t.x)?-1:n.x.isGreaterThan(t.x)?1:n.y.isLessThan(t.y)?-1:n.y.isGreaterThan(t.y)?1:0}link(n){if(n.point===this.point)throw new Error("Tried to link already linked events");const t=n.point.events;for(let i=0,r=t.length;i<r;i++){const o=t[i];this.point.events.push(o),o.point=this.point}this.checkForConsuming()}checkForConsuming(){const n=this.point.events.length;for(let t=0;t<n;t++){const i=this.point.events[t];if(i.segment.consumedBy===void 0)for(let r=t+1;r<n;r++){const o=this.point.events[r];o.consumedBy===void 0&&i.otherSE.point.events===o.otherSE.point.events&&i.segment.consume(o.segment)}}}getAvailableLinkedEvents(){const n=[];for(let t=0,i=this.point.events.length;t<i;t++){const r=this.point.events[t];r!==this&&!r.segment.ringOut&&r.segment.isInResult()&&n.push(r)}return n}getLeftmostComparator(n){const t=new Map,i=r=>{const o=r.otherSE;t.set(r,{sine:e8(this.point,n.point,o.point),cosine:t8(this.point,n.point,o.point)})};return(r,o)=>{t.has(r)||i(r),t.has(o)||i(o);const{sine:l,cosine:h}=t.get(r),{sine:p,cosine:m}=t.get(o);return l.isGreaterThanOrEqualTo(0)&&p.isGreaterThanOrEqualTo(0)?h.isLessThan(m)?1:h.isGreaterThan(m)?-1:0:l.isLessThan(0)&&p.isLessThan(0)?h.isLessThan(m)?-1:h.isGreaterThan(m)?1:0:p.isLessThan(l)?-1:p.isGreaterThan(l)?1:0}}},i8=class Rg{constructor(n){Mt(this,"events");Mt(this,"poly");Mt(this,"_isExteriorRing");Mt(this,"_enclosingRing");this.events=n;for(let t=0,i=n.length;t<i;t++)n[t].segment.ringOut=this;this.poly=null}static factory(n){const t=[];for(let i=0,r=n.length;i<r;i++){const o=n[i];if(!o.isInResult()||o.ringOut)continue;let l=null,h=o.leftSE,p=o.rightSE;const m=[h],_=h.point,w=[];for(;l=h,h=p,m.push(h),h.point!==_;)for(;;){const E=h.getAvailableLinkedEvents();if(E.length===0){const j=m[0].point,Q=m[m.length-1].point;throw new Error(`Unable to complete output ring starting at [${j.x}, ${j.y}]. Last matching segment found ends at [${Q.x}, ${Q.y}].`)}if(E.length===1){p=E[0].otherSE;break}let b=null;for(let j=0,Q=w.length;j<Q;j++)if(w[j].point===h.point){b=j;break}if(b!==null){const j=w.splice(b)[0],Q=m.splice(j.index);Q.unshift(Q[0].otherSE),t.push(new Rg(Q.reverse()));continue}w.push({index:m.length,point:h.point});const D=h.getLeftmostComparator(l);p=E.sort(D)[0].otherSE;break}t.push(new Rg(m))}return t}getGeom(){let n=this.events[0].point;const t=[n];for(let m=1,_=this.events.length-1;m<_;m++){const w=this.events[m].point,E=this.events[m+1].point;ec.orient(w,n,E)!==0&&(t.push(w),n=w)}if(t.length===1)return null;const i=t[0],r=t[1];ec.orient(i,n,r)===0&&t.shift(),t.push(t[0]);const o=this.isExteriorRing()?1:-1,l=this.isExteriorRing()?0:t.length-1,h=this.isExteriorRing()?t.length:-1,p=[];for(let m=l;m!=h;m+=o)p.push([t[m].x.toNumber(),t[m].y.toNumber()]);return p}isExteriorRing(){if(this._isExteriorRing===void 0){const n=this.enclosingRing();this._isExteriorRing=n?!n.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var r,o;let n=this.events[0];for(let l=1,h=this.events.length;l<h;l++){const p=this.events[l];wu.compare(n,p)>0&&(n=p)}let t=n.segment.prevInResult(),i=t?t.prevInResult():null;for(;;){if(!t)return null;if(!i)return t.ringOut;if(i.ringOut!==t.ringOut)return((r=i.ringOut)==null?void 0:r.enclosingRing())!==t.ringOut?t.ringOut:(o=t.ringOut)==null?void 0:o.enclosingRing();t=i.prevInResult(),i=t?t.prevInResult():null}}},xy=class{constructor(e){Mt(this,"exteriorRing");Mt(this,"interiorRings");this.exteriorRing=e,e.poly=this,this.interiorRings=[]}addInterior(e){this.interiorRings.push(e),e.poly=this}getGeom(){const e=this.exteriorRing.getGeom();if(e===null)return null;const n=[e];for(let t=0,i=this.interiorRings.length;t<i;t++){const r=this.interiorRings[t].getGeom();r!==null&&n.push(r)}return n}},r8=class{constructor(e){Mt(this,"rings");Mt(this,"polys");this.rings=e,this.polys=this._composePolys(e)}getGeom(){const e=[];for(let n=0,t=this.polys.length;n<t;n++){const i=this.polys[n].getGeom();i!==null&&e.push(i)}return e}_composePolys(e){var t;const n=[];for(let i=0,r=e.length;i<r;i++){const o=e[i];if(!o.poly)if(o.isExteriorRing())n.push(new xy(o));else{const l=o.enclosingRing();l!=null&&l.poly||n.push(new xy(l)),(t=l==null?void 0:l.poly)==null||t.addInterior(o)}}return n}},s8=class{constructor(e,n=gp.compare){Mt(this,"queue");Mt(this,"tree");Mt(this,"segments");this.queue=e,this.tree=new dp(n),this.segments=[]}process(e){const n=e.segment,t=[];if(e.consumedBy)return e.isLeft?this.queue.delete(e.otherSE):this.tree.delete(n),t;e.isLeft&&this.tree.add(n);let i=n,r=n;do i=this.tree.lastBefore(i);while(i!=null&&i.consumedBy!=null);do r=this.tree.firstAfter(r);while(r!=null&&r.consumedBy!=null);if(e.isLeft){let o=null;if(i){const h=i.getIntersection(n);if(h!==null&&(n.isAnEndpoint(h)||(o=h),!i.isAnEndpoint(h))){const p=this._splitSafely(i,h);for(let m=0,_=p.length;m<_;m++)t.push(p[m])}}let l=null;if(r){const h=r.getIntersection(n);if(h!==null&&(n.isAnEndpoint(h)||(l=h),!r.isAnEndpoint(h))){const p=this._splitSafely(r,h);for(let m=0,_=p.length;m<_;m++)t.push(p[m])}}if(o!==null||l!==null){let h=null;o===null?h=l:l===null?h=o:h=wu.comparePoints(o,l)<=0?o:l,this.queue.delete(n.rightSE),t.push(n.rightSE);const p=n.split(h);for(let m=0,_=p.length;m<_;m++)t.push(p[m])}t.length>0?(this.tree.delete(n),t.push(e)):(this.segments.push(n),n.prev=i)}else{if(i&&r){const o=i.getIntersection(r);if(o!==null){if(!i.isAnEndpoint(o)){const l=this._splitSafely(i,o);for(let h=0,p=l.length;h<p;h++)t.push(l[h])}if(!r.isAnEndpoint(o)){const l=this._splitSafely(r,o);for(let h=0,p=l.length;h<p;h++)t.push(l[h])}}}this.tree.delete(n)}return t}_splitSafely(e,n){this.tree.delete(e);const t=e.rightSE;this.queue.delete(t);const i=e.split(n);return i.push(t),e.consumedBy===void 0&&this.tree.add(e),i}},o8=class{constructor(){Mt(this,"type");Mt(this,"numMultiPolys")}run(e,n,t){xf.type=e;const i=[new Cy(n,!0)];for(let m=0,_=t.length;m<_;m++)i.push(new Cy(t[m],!1));if(xf.numMultiPolys=i.length,xf.type==="difference"){const m=i[0];let _=1;for(;_<i.length;)Dg(i[_].bbox,m.bbox)!==null?_++:i.splice(_,1)}if(xf.type==="intersection")for(let m=0,_=i.length;m<_;m++){const w=i[m];for(let E=m+1,b=i.length;E<b;E++)if(Dg(w.bbox,i[E].bbox)===null)return[]}const r=new dp(wu.compare);for(let m=0,_=i.length;m<_;m++){const w=i[m].getSweepEvents();for(let E=0,b=w.length;E<b;E++)r.add(w[E])}const o=new s8(r);let l=null;for(r.size!=0&&(l=r.first(),r.delete(l));l;){const m=o.process(l);for(let _=0,w=m.length;_<w;_++){const E=m[_];E.consumedBy===void 0&&r.add(E)}r.size!=0?(l=r.first(),r.delete(l)):l=null}ec.reset();const h=i8.factory(o.segments);return new r8(h).getGeom()}},xf=new o8,Og=xf,a8=0,gp=class Vd{constructor(n,t,i,r){Mt(this,"id");Mt(this,"leftSE");Mt(this,"rightSE");Mt(this,"rings");Mt(this,"windings");Mt(this,"ringOut");Mt(this,"consumedBy");Mt(this,"prev");Mt(this,"_prevInResult");Mt(this,"_beforeState");Mt(this,"_afterState");Mt(this,"_isInResult");this.id=++a8,this.leftSE=n,n.segment=this,n.otherSE=t,this.rightSE=t,t.segment=this,t.otherSE=n,this.rings=i,this.windings=r}static compare(n,t){const i=n.leftSE.point.x,r=t.leftSE.point.x,o=n.rightSE.point.x,l=t.rightSE.point.x;if(l.isLessThan(i))return 1;if(o.isLessThan(r))return-1;const h=n.leftSE.point.y,p=t.leftSE.point.y,m=n.rightSE.point.y,_=t.rightSE.point.y;if(i.isLessThan(r)){if(p.isLessThan(h)&&p.isLessThan(m))return 1;if(p.isGreaterThan(h)&&p.isGreaterThan(m))return-1;const w=n.comparePoint(t.leftSE.point);if(w<0)return 1;if(w>0)return-1;const E=t.comparePoint(n.rightSE.point);return E!==0?E:-1}if(i.isGreaterThan(r)){if(h.isLessThan(p)&&h.isLessThan(_))return-1;if(h.isGreaterThan(p)&&h.isGreaterThan(_))return 1;const w=t.comparePoint(n.leftSE.point);if(w!==0)return w;const E=n.comparePoint(t.rightSE.point);return E<0?1:E>0?-1:1}if(h.isLessThan(p))return-1;if(h.isGreaterThan(p))return 1;if(o.isLessThan(l)){const w=t.comparePoint(n.rightSE.point);if(w!==0)return w}if(o.isGreaterThan(l)){const w=n.comparePoint(t.rightSE.point);if(w<0)return 1;if(w>0)return-1}if(!o.eq(l)){const w=m.minus(h),E=o.minus(i),b=_.minus(p),D=l.minus(r);if(w.isGreaterThan(E)&&b.isLessThan(D))return 1;if(w.isLessThan(E)&&b.isGreaterThan(D))return-1}return o.isGreaterThan(l)?1:o.isLessThan(l)||m.isLessThan(_)?-1:m.isGreaterThan(_)?1:n.id<t.id?-1:n.id>t.id?1:0}static fromRing(n,t,i){let r,o,l;const h=wu.comparePoints(n,t);if(h<0)r=n,o=t,l=1;else if(h>0)r=t,o=n,l=-1;else throw new Error(`Tried to create degenerate segment at [${n.x}, ${n.y}]`);const p=new wu(r,!0),m=new wu(o,!1);return new Vd(p,m,[i],[l])}replaceRightSE(n){this.rightSE=n,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const n=this.leftSE.point.y,t=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:n.isLessThan(t)?n:t},ur:{x:this.rightSE.point.x,y:n.isGreaterThan(t)?n:t}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(n){return n.x.eq(this.leftSE.point.x)&&n.y.eq(this.leftSE.point.y)||n.x.eq(this.rightSE.point.x)&&n.y.eq(this.rightSE.point.y)}comparePoint(n){return ec.orient(this.leftSE.point,n,this.rightSE.point)}getIntersection(n){const t=this.bbox(),i=n.bbox(),r=Dg(t,i);if(r===null)return null;const o=this.leftSE.point,l=this.rightSE.point,h=n.leftSE.point,p=n.rightSE.point,m=gf(t,h)&&this.comparePoint(h)===0,_=gf(i,o)&&n.comparePoint(o)===0,w=gf(t,p)&&this.comparePoint(p)===0,E=gf(i,l)&&n.comparePoint(l)===0;if(_&&m)return E&&!w?l:!E&&w?p:null;if(_)return w&&o.x.eq(p.x)&&o.y.eq(p.y)?null:o;if(m)return E&&l.x.eq(h.x)&&l.y.eq(h.y)?null:h;if(E&&w)return null;if(E)return l;if(w)return p;const b=n8(o,this.vector(),h,n.vector());return b===null||!gf(r,b)?null:ec.snap(b)}split(n){const t=[],i=n.events!==void 0,r=new wu(n,!0),o=new wu(n,!1),l=this.rightSE;this.replaceRightSE(o),t.push(o),t.push(r);const h=new Vd(r,l,this.rings.slice(),this.windings.slice());return wu.comparePoints(h.leftSE.point,h.rightSE.point)>0&&h.swapEvents(),wu.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),i&&(r.checkForConsuming(),o.checkForConsuming()),t}swapEvents(){const n=this.rightSE;this.rightSE=this.leftSE,this.leftSE=n,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let t=0,i=this.windings.length;t<i;t++)this.windings[t]*=-1}consume(n){let t=this,i=n;for(;t.consumedBy;)t=t.consumedBy;for(;i.consumedBy;)i=i.consumedBy;const r=Vd.compare(t,i);if(r!==0){if(r>0){const o=t;t=i,i=o}if(t.prev===i){const o=t;t=i,i=o}for(let o=0,l=i.rings.length;o<l;o++){const h=i.rings[o],p=i.windings[o],m=t.rings.indexOf(h);m===-1?(t.rings.push(h),t.windings.push(p)):t.windings[m]+=p}i.rings=null,i.windings=null,i.consumedBy=t,i.leftSE.consumedBy=t.leftSE,i.rightSE.consumedBy=t.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const n=this.prev.consumedBy||this.prev;this._beforeState=n.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const n=this.beforeState();this._afterState={rings:n.rings.slice(0),windings:n.windings.slice(0),multiPolys:[]};const t=this._afterState.rings,i=this._afterState.windings,r=this._afterState.multiPolys;for(let h=0,p=this.rings.length;h<p;h++){const m=this.rings[h],_=this.windings[h],w=t.indexOf(m);w===-1?(t.push(m),i.push(_)):i[w]+=_}const o=[],l=[];for(let h=0,p=t.length;h<p;h++){if(i[h]===0)continue;const m=t[h],_=m.poly;if(l.indexOf(_)===-1)if(m.isExterior)o.push(_);else{l.indexOf(_)===-1&&l.push(_);const w=o.indexOf(m.poly);w!==-1&&o.splice(w,1)}}for(let h=0,p=o.length;h<p;h++){const m=o[h].multiPoly;r.indexOf(m)===-1&&r.push(m)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const n=this.beforeState().multiPolys,t=this.afterState().multiPolys;switch(Og.type){case"union":{const i=n.length===0,r=t.length===0;this._isInResult=i!==r;break}case"intersection":{let i,r;n.length<t.length?(i=n.length,r=t.length):(i=t.length,r=n.length),this._isInResult=r===Og.numMultiPolys&&i<r;break}case"xor":{const i=Math.abs(n.length-t.length);this._isInResult=i%2===1;break}case"difference":{const i=r=>r.length===1&&r[0].isSubject;this._isInResult=i(n)!==i(t);break}}return this._isInResult}},Ly=class{constructor(e,n,t){Mt(this,"poly");Mt(this,"isExterior");Mt(this,"segments");Mt(this,"bbox");if(!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=t,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const i=ec.snap({x:new Cu(e[0][0]),y:new Cu(e[0][1])});this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};let r=i;for(let o=1,l=e.length;o<l;o++){if(typeof e[o][0]!="number"||typeof e[o][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const h=ec.snap({x:new Cu(e[o][0]),y:new Cu(e[o][1])});h.x.eq(r.x)&&h.y.eq(r.y)||(this.segments.push(gp.fromRing(r,h,this)),h.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=h.x),h.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=h.y),h.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=h.x),h.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=h.y),r=h)}(!i.x.eq(r.x)||!i.y.eq(r.y))&&this.segments.push(gp.fromRing(r,i,this))}getSweepEvents(){const e=[];for(let n=0,t=this.segments.length;n<t;n++){const i=this.segments[n];e.push(i.leftSE),e.push(i.rightSE)}return e}},l8=class{constructor(e,n){Mt(this,"multiPoly");Mt(this,"exteriorRing");Mt(this,"interiorRings");Mt(this,"bbox");if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Ly(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let t=1,i=e.length;t<i;t++){const r=new Ly(e[t],this,!1);r.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=r.bbox.ll.x),r.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=r.bbox.ll.y),r.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=r.bbox.ur.x),r.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=r.bbox.ur.y),this.interiorRings.push(r)}this.multiPoly=n}getSweepEvents(){const e=this.exteriorRing.getSweepEvents();for(let n=0,t=this.interiorRings.length;n<t;n++){const i=this.interiorRings[n].getSweepEvents();for(let r=0,o=i.length;r<o;r++)e.push(i[r])}return e}},Cy=class{constructor(e,n){Mt(this,"isSubject");Mt(this,"polys");Mt(this,"bbox");if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:new Cu(Number.POSITIVE_INFINITY),y:new Cu(Number.POSITIVE_INFINITY)},ur:{x:new Cu(Number.NEGATIVE_INFINITY),y:new Cu(Number.NEGATIVE_INFINITY)}};for(let t=0,i=e.length;t<i;t++){const r=new l8(e[t],this);r.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=r.bbox.ll.x),r.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=r.bbox.ll.y),r.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=r.bbox.ur.x),r.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=r.bbox.ur.y),this.polys.push(r)}this.isSubject=n}getSweepEvents(){const e=[];for(let n=0,t=this.polys.length;n<t;n++){const i=this.polys[n].getSweepEvents();for(let r=0,o=i.length;r<o;r++)e.push(i[r])}return e}},u8=(e,...n)=>Og.run("intersection",e,n);ec.set;function c8(e,n){var t,i,r,o,l,h,p,m,_,w,E=0,b=e.type==="FeatureCollection",D=e.type==="Feature",j=b?e.features.length:1;for(t=0;t<j;t++){for(h=b?e.features[t].geometry:D?e.geometry:e,m=b?e.features[t].properties:D?e.properties:{},_=b?e.features[t].bbox:D?e.bbox:void 0,w=b?e.features[t].id:D?e.id:void 0,p=h?h.type==="GeometryCollection":!1,l=p?h.geometries.length:1,r=0;r<l;r++){if(o=p?h.geometries[r]:h,o===null){if(n(null,E,m,_,w)===!1)return!1;continue}switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(n(o,E,m,_,w)===!1)return!1;break}case"GeometryCollection":{for(i=0;i<o.geometries.length;i++)if(n(o.geometries[i],E,m,_,w)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}E++}}function h8(e,n={}){const t=[];if(c8(e,r=>{t.push(r.coordinates)}),t.length<2)throw new Error("Must specify at least 2 geometries");const i=u8(t[0],...t.slice(1));return i.length===0?null:i.length===1?El(i[0],n.properties):BM(i,n.properties)}var f8=h8;function w4(e,n,t){if(e!==null)for(var i,r,o,l,h,p,m,_=0,w=0,E,b=e.type,D=b==="FeatureCollection",j=b==="Feature",Q=D?e.features.length:1,F=0;F<Q;F++){m=D?e.features[F].geometry:j?e.geometry:e,E=m?m.type==="GeometryCollection":!1,h=E?m.geometries.length:1;for(var V=0;V<h;V++){var pe=0,Ee=0;if(l=E?m.geometries[V]:m,l!==null){p=l.coordinates;var Ie=l.type;switch(_=0,Ie){case null:break;case"Point":if(n(p,w,F,pe,Ee)===!1)return!1;w++,pe++;break;case"LineString":case"MultiPoint":for(i=0;i<p.length;i++){if(n(p[i],w,F,pe,Ee)===!1)return!1;w++,Ie==="MultiPoint"&&pe++}Ie==="LineString"&&pe++;break;case"Polygon":case"MultiLineString":for(i=0;i<p.length;i++){for(r=0;r<p[i].length-_;r++){if(n(p[i][r],w,F,pe,Ee)===!1)return!1;w++}Ie==="MultiLineString"&&pe++,Ie==="Polygon"&&Ee++}Ie==="Polygon"&&pe++;break;case"MultiPolygon":for(i=0;i<p.length;i++){for(Ee=0,r=0;r<p[i].length;r++){for(o=0;o<p[i][r].length-_;o++){if(n(p[i][r][o],w,F,pe,Ee)===!1)return!1;w++}Ee++}pe++}break;case"GeometryCollection":for(i=0;i<l.geometries.length;i++)if(w4(l.geometries[i],n)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function d8(e,n){var t,i,r,o,l,h,p,m,_,w,E=0,b=e.type==="FeatureCollection",D=e.type==="Feature",j=b?e.features.length:1;for(t=0;t<j;t++){for(h=b?e.features[t].geometry:D?e.geometry:e,m=b?e.features[t].properties:D?e.properties:{},_=b?e.features[t].bbox:D?e.bbox:void 0,w=b?e.features[t].id:D?e.id:void 0,p=h?h.type==="GeometryCollection":!1,l=p?h.geometries.length:1,r=0;r<l;r++){if(o=p?h.geometries[r]:h,o===null){if(n(null,E,m,_,w)===!1)return!1;continue}switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(n(o,E,m,_,w)===!1)return!1;break}case"GeometryCollection":{for(i=0;i<o.geometries.length;i++)if(n(o.geometries[i],E,m,_,w)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}E++}}function p8(e,n){d8(e,function(t,i,r,o,l){var h=t===null?null:t.type;switch(h){case null:case"Point":case"LineString":case"Polygon":return n(Kh(t,r,{bbox:o,id:l}),i,0)===!1?!1:void 0}var p;switch(h){case"MultiPoint":p="Point";break;case"MultiLineString":p="LineString";break;case"MultiPolygon":p="Polygon";break}for(var m=0;m<t.coordinates.length;m++){var _=t.coordinates[m],w={type:p,coordinates:_};if(n(Kh(w,r),i,m)===!1)return!1}})}function g8(e,n){p8(e,function(t,i,r){var o=0;if(t.geometry){var l=t.geometry.type;if(!(l==="Point"||l==="MultiPoint")){var h,p=0,m=0,_=0;if(w4(t,function(w,E,b,D,j){if(h===void 0||i>p||D>m||j>_){h=w,p=i,m=D,_=j,o=0;return}var Q=Al([h,w],t.properties);if(n(Q,i,r,j,o)===!1)return!1;o++,h=w})===!1)return!1}}})}function m8(e,n,t){var i=t,r=!1;return g8(e,function(o,l,h,p,m){r===!1&&t===void 0?i=o:i=n(i,o,l,h,p,m),r=!0}),i}function mp(e,n={}){return m8(e,(t,i)=>{const r=i.geometry.coordinates;return t+wm(r[0],r[1],n)},0)}var Zc=mp;class $o extends gn.Polyline{constructor(t,i={}){super(t,{...i,pmIgnore:!1,interactive:!0});Mt(this,"properties");Mt(this,"cachedProperties",{});Mt(this,"needsUpdate",!0);this.properties=At.measure("Line.constructor.initProperties",()=>({type:"Line",style:{...i||{},name:i.name||""}})),this.updateProperties(),this.on("add",()=>{this.updateProperties()})}updateProperties(){At.measure("Line.updateProperties",()=>{var r,o,l;const t=this.getLatLngs();if(!t||t.length<2){console.warn("Line has less than 2 points, cannot calculate properties");return}const i=t.map(h=>[h.lng,h.lat]);try{const h=Al(i),p=mp(h,{units:"meters"});let m;if(t.length===2)m=gn.latLng((t[0].lat+t[1].lat)/2,(t[0].lng+t[1].lng)/2);else{const E=Tg(h,p/2,{units:"meters"});m=gn.latLng(E.geometry.coordinates[1],E.geometry.coordinates[0])}const _=10,w=((o=(r=this.properties)==null?void 0:r.style)==null?void 0:o.name)||"";this.properties={type:"Line",length:p,coordinates:t.map(E=>({lat:E.lat,lng:E.lng})),center:{lat:m.lat,lng:m.lng},vertices:t.length,surfaceInfluence:p*_,dimensions:{width:_},style:{...this.options,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,dashArray:((l=this.options)==null?void 0:l.dashArray)||"",name:w}},this.cachedProperties.length=p,this.cachedProperties.center=m,this.cachedProperties.midPoints=void 0,this.cachedProperties.segmentLengths=void 0,this.needsUpdate=!1,this.fire("properties:updated",{shape:this,properties:this.properties})}catch(h){console.error("Failed to calculate line properties",h)}})}setName(t){At.measure("Line.setName",()=>{this.properties.style||(this.properties.style={}),this.properties.style.name=t,this.fire("properties:updated",{shape:this,properties:this.properties})})}getName(){return At.measure("Line.getName",()=>{var t,i;return((i=(t=this.properties)==null?void 0:t.style)==null?void 0:i.name)||""})}invalidateCache(){At.measure("Line.invalidateCache",()=>{this.needsUpdate=!0,this.cachedProperties={}})}setLatLngs(t){return super.setLatLngs(t),this.needsUpdate=!0,this.cachedProperties={},this.fire("latlngs:updated",{latlngs:this.getLatLngs()}),this}getMidPoints(){return At.measure("Line.getMidPoints",()=>{if(!this.needsUpdate&&this.cachedProperties.midPoints)return this.cachedProperties.midPoints;const t=this.getLatLngs(),i=[];if(t.length<2)return i;for(let r=0;r<t.length-1;r++){const o=t[r],l=t[r+1];if(!o||!l){console.warn("Points invalides détectés pour le segment",r);continue}i.push(gn.latLng((o.lat+l.lat)/2,(o.lng+l.lng)/2))}return this.cachedProperties.midPoints=i,i})}getMidPointAt(t){return At.measure("Line.getMidPointAt",()=>{const i=this.getLatLngs();if(t<0||t>=i.length-1||i.length<2)return null;const r=i[t],o=i[t+1];return!r||!o?(console.warn("Points invalides pour calcul du midpoint au segment",t),null):gn.latLng((r.lat+o.lat)/2,(r.lng+o.lng)/2)})}moveVertex(t,i,r=!1){At.measure("Line.moveVertex",()=>{const o=this.getLatLngs();t>=0&&t<o.length&&(o[t]=i,this.setLatLngs(o),this.needsUpdate=!0,this.cachedProperties={},this.fire("vertex:moved",{index:t,latlng:i,allPoints:o}),r&&this.updateProperties())})}addVertex(t,i,r=!1){At.measure("Line.addVertex",()=>{const o=this.getLatLngs();t>=0&&t<o.length-1&&(o.splice(t+1,0,i),gn.Polyline.prototype.setLatLngs.call(this,o),this.needsUpdate=!0,this.cachedProperties.midPoints=void 0,this.cachedProperties.segmentLengths=void 0,this.cachedProperties.center=void 0,this.cachedProperties.length=void 0,r&&this.updateProperties())})}move(t,i=!0){return At.measure("Line.move",()=>{this.fire("move:start");const r=this.getLatLngs(),o=r.map(l=>gn.latLng(l.lat+t.lat,l.lng+t.lng));return this.setLatLngs(o),this.needsUpdate=!0,this.cachedProperties={},this.fire("move",{delta:t,newPositions:o,oldPositions:r}),i&&(this.updateProperties(),this.fire("properties:updated",{shape:this,properties:this.properties}),this.fire("move:end")),this})}getCenter(){return At.measure("Line.getCenter",()=>{if(!this.needsUpdate&&this.cachedProperties.center)return this.cachedProperties.center;const t=this.getLatLngs();if(t.length<2)return t[0]||new gn.LatLng(0,0);try{const i=t.map(p=>[p.lng,p.lat]),r=Al(i),o=mp(r,{units:"meters"}),l=Tg(r,o/2,{units:"meters"}),h=gn.latLng(l.geometry.coordinates[1],l.geometry.coordinates[0]);return this.cachedProperties.center=h,h}catch(i){console.warn("Error calculating line center with turf.js, using simple method",i);const r=t.reduce((h,p)=>h+p.lat,0)/t.length,o=t.reduce((h,p)=>h+p.lng,0)/t.length,l=new gn.LatLng(r,o);return this.cachedProperties.center=l,l}})}getSegmentLengths(){return At.measure("Line.getSegmentLengths",()=>{if(!this.needsUpdate&&this.cachedProperties.segmentLengths)return this.cachedProperties.segmentLengths;const t=this.getLatLngs(),i=[];if(t.length<2)return i;for(let r=0;r<t.length-1;r++){const o=t[r],l=t[r+1];i.push(o.distanceTo(l))}return this.cachedProperties.segmentLengths=i,i})}getSegmentLengthAt(t){return At.measure("Line.getSegmentLengthAt",()=>{const i=this.getLatLngs();if(t<0||t>=i.length-1||i.length<2)return 0;const r=i[t],o=i[t+1];return r.distanceTo(o)})}getLengthToVertex(t){return At.measure("Line.getLengthToVertex",()=>{const i=this.getLatLngs();let r=0;if(t<=0||i.length<2)return 0;for(let o=0;o<Math.min(t,i.length-1);o++)r+=i[o].distanceTo(i[o+1]);return r})}getLength(){return At.measure("Line.getLength",()=>{if(!this.needsUpdate&&this.cachedProperties.length)return this.cachedProperties.length;const t=this.getLatLngs();let i=0;for(let r=0;r<t.length-1;r++)i+=t[r].distanceTo(t[r+1]);return this.cachedProperties.length=i,i})}}class Rf extends gn.Polygon{constructor(t,i={}){super(t,{...i,pmIgnore:!1,interactive:!0});Mt(this,"properties");this.properties=At.measure("Polygon.constructor.initProperties",()=>({type:"Polygon",style:{color:i.color||"#3388ff",weight:i.weight||3,opacity:i.opacity||1,fillColor:i.fillColor||"#3388ff",fillOpacity:i.fillOpacity||.2,dashArray:i.dashArray||"",name:i.name||""}})),this.updateProperties(),this.on({add:()=>this.updateProperties(),edit:()=>this.updateProperties(),drag:()=>this.updateProperties()})}updateProperties(){At.measure("Polygon.updateProperties",()=>{var t,i,r;try{const o=this.getLatLngs()[0];if(!o||o.length<3){console.warn("Polygon has less than 3 points, cannot calculate properties");return}const l=o.map(b=>[b.lng,b.lat]);l.push(l[0]);const h=El([l]),p=p4(h),m=mp(Al([...l]),{units:"meters"}),_=Df(h),w=gn.latLng(_.geometry.coordinates[1],_.geometry.coordinates[0]),E=((i=(t=this.properties)==null?void 0:t.style)==null?void 0:i.name)||"";this.properties={type:"Polygon",coordinates:o.map(b=>({lat:b.lat,lng:b.lng})),surface:p,perimeter:m,center:{lat:w.lat,lng:w.lng},vertices:o.length,style:{...this.options,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#3388ff",fillOpacity:this.options.fillOpacity||.2,dashArray:((r=this.options)==null?void 0:r.dashArray)||"",name:E}},this.fire("properties:updated",{shape:this,properties:this.properties})}catch(o){console.error("Failed to calculate polygon properties",o)}})}setName(t){At.measure("Polygon.setName",()=>{this.properties.style||(this.properties.style={}),this.properties.style.name=t,this.fire("properties:updated",{shape:this,properties:this.properties})})}getName(){return At.measure("Polygon.getName",()=>{var t,i;return((i=(t=this.properties)==null?void 0:t.style)==null?void 0:i.name)||""})}setLatLngs(t){return At.measure("Polygon.setLatLngs",()=>(super.setLatLngs(t),this.updateProperties(),this))}getMidPoints(){return At.measure("Polygon.getMidPoints",()=>{const t=this.getLatLngs()[0],i=[];if(t.length<2)return i;for(let r=0;r<t.length;r++){const o=t[r],l=t[(r+1)%t.length];i.push(gn.latLng((o.lat+l.lat)/2,(o.lng+l.lng)/2))}return i})}moveVertex(t,i){At.measure("Polygon.moveVertex",()=>{const r=this.getLatLngs()[0];t>=0&&t<r.length&&(r[t]=i,gn.Polygon.prototype.setLatLngs.call(this,[r]))})}addVertex(t,i){At.measure("Polygon.addVertex",()=>{const r=this.getLatLngs()[0];t>=0&&t<r.length&&(r.splice((t+1)%r.length,0,i),gn.Polygon.prototype.setLatLngs.call(this,[r]))})}move(t){return At.measure("Polygon.move",()=>{const r=this.getLatLngs()[0].map(o=>gn.latLng(o.lat+t.lat,o.lng+t.lng));return gn.Polygon.prototype.setLatLngs.call(this,[r]),this})}getCenter(){return At.measure("Polygon.getCenter",()=>{const t=this.getLatLngs()[0];if(!t||t.length===0)return new gn.LatLng(0,0);try{const i=t.filter(m=>m&&typeof m.lat=="number"&&typeof m.lng=="number"&&!isNaN(m.lat)&&!isNaN(m.lng)&&Math.abs(m.lat)<=90&&Math.abs(m.lng)<=180);if(i.length===0)return console.warn("Aucun point valide dans le polygone pour calculer le centre"),new gn.LatLng(0,0);const r=i.map(m=>[m.lng,m.lat]);r.push(r[0]);const o=El([r]),l=Df(o),h=l.geometry.coordinates[1],p=l.geometry.coordinates[0];if(typeof h!="number"||typeof p!="number"||isNaN(h)||isNaN(p)||Math.abs(h)>90||Math.abs(p)>180)throw new Error("Centroid calculé invalide");return gn.latLng(h,p)}catch(i){console.warn("Erreur lors du calcul du centroïde avec turf.js, utilisation de la méthode simple",i);let r=0,o=0,l=0;for(const h of t)h&&typeof h.lat=="number"&&typeof h.lng=="number"&&!isNaN(h.lat)&&!isNaN(h.lng)&&Math.abs(h.lat)<=90&&Math.abs(h.lng)<=180&&(r+=h.lat,o+=h.lng,l++);return l===0?(console.error("Impossible de calculer un centre valide pour le polygone"),new gn.LatLng(0,0)):new gn.LatLng(r/l,o/l)}})}getSegmentLengths(){return At.measure("Polygon.getSegmentLengths",()=>{const t=this.getLatLngs()[0],i=[];if(t.length<2)return i;for(let r=0;r<t.length;r++){const o=t[r],l=t[(r+1)%t.length];i.push(o.distanceTo(l))}return i})}}const wa=class wa extends $o{constructor(t,i={}){super(t,{...i,color:"#FF4500",weight:4,opacity:.8,interactive:!1,pmIgnore:!0});Mt(this,"elevationData",[]);Mt(this,"elevationProfile",null);Mt(this,"elevationMarker",null);Mt(this,"samplePoints",[]);Mt(this,"sampleTooltips",[]);Mt(this,"isZooming",!1);Mt(this,"simpleLine",null);Mt(this,"isDestroyed",!1);Mt(this,"zoomAnimationTimeout",null);Mt(this,"samplePointStyle",{radius:4,color:"#FF4500",fillColor:"#FF4500",fillOpacity:.6,weight:2,opacity:.8});Mt(this,"minMaxPointStyle",{radius:6,weight:3,opacity:1,fillOpacity:1});this.properties=At.measure("ElevationLine.constructor.initProperties",()=>({...this.properties,type:"ElevationLine",style:{...this.properties.style||{},name:i.name||""},elevationProfile:null,maxElevation:0,minElevation:0,elevationGain:0,elevationLoss:0,dataSource:"pending",samplePointStyle:this.samplePointStyle,minMaxPointStyle:this.minMaxPointStyle})),this.setupEventListeners()}setupEventListeners(){At.measure("ElevationLine.setupEventListeners",()=>{this.on("move",()=>this.updateElevationProfile()),this.on("add",()=>{this._map&&(this._map.on("zoomstart",this.handleZoomStart,this),this._map.on("zoomend",this.handleZoomEnd,this),this._map.on("zoomanim",this._animateZoom,this))}),this.on("remove",()=>{this.cleanupEventListeners()})})}cleanupEventListeners(){this._map&&(this._map.off("zoomstart",this.handleZoomStart,this),this._map.off("zoomend",this.handleZoomEnd,this),this._map.off("zoomanim",this._animateZoom,this)),this.zoomAnimationTimeout&&(clearTimeout(this.zoomAnimationTimeout),this.zoomAnimationTimeout=null)}_animateZoom(t){if(this.isDestroyed||!this._map||!this.getLatLngs().length){console.debug("[ElevationLine] Animation de zoom ignorée - ligne détruite ou carte non disponible");return}this.zoomAnimationTimeout&&(clearTimeout(this.zoomAnimationTimeout),this.zoomAnimationTimeout=null);try{this.clearSamplePoints(),this.elevationMarker&&this.elevationMarker.remove();const i=this._path;i&&(i.style.display="none");const r=this.getLatLngs();if(r&&r.length>0&&this._map&&!this.isDestroyed&&(this.simpleLine?this.simpleLine.setLatLngs(r):this.simpleLine=gn.polyline(r,{color:"#FF4500",weight:3,opacity:.6,smoothFactor:1,interactive:!1}).addTo(this._map),this.simpleLine&&this.simpleLine._path)){const o=this.simpleLine._path.style.transform;this.simpleLine._path.style.transform="",this.zoomAnimationTimeout=setTimeout(()=>{if(this.isDestroyed||!this._map){this.cleanup();return}try{this.simpleLine&&this.simpleLine._path&&(this.simpleLine._path.style.transform=o,this.simpleLine._path.style.display=""),i&&!this.isDestroyed&&(i.style.display=""),this._map&&this._map.hasLayer(this)&&!this.isDestroyed&&(this.redraw(),this.showSamplePoints())}catch(l){console.warn("[ElevationLine] Erreur lors de la restauration après animation:",l),this.cleanup()}},300)}}catch(i){console.debug("[ElevationLine] Animation de zoom ignorée:",i),this.zoomAnimationTimeout=setTimeout(()=>{if(this.isDestroyed||!this._map){this.cleanup();return}try{this._path&&(this._path.style.display=""),this._map&&this._map.hasLayer(this)&&!this.isDestroyed&&(this.redraw(),this.showSamplePoints())}catch(r){console.error("[ElevationLine] Erreur lors de la restauration après animation:",r),this.cleanup()}},300)}}handleZoomStart(){this.isDestroyed||At.measure("ElevationLine.handleZoomStart",()=>{if(!(this.isZooming||!this._map)){this.isZooming=!0;try{this.clearSamplePoints(),this.elevationMarker&&this.elevationMarker.remove();const t=this._path;t&&(t.style.display="none"),this.isDestroyed||this.setStyle({opacity:.3})}catch(t){console.error("[ElevationLine] Error in handleZoomStart:",t),this.cleanup()}}})}handleZoomEnd(){this.isDestroyed||At.measure("ElevationLine.handleZoomEnd",()=>{if(!this._map){this.isZooming=!1;return}try{this.simpleLine&&this._map&&(this.simpleLine.remove(),this.simpleLine=null);const t=this._path;t&&(t.style.display=""),this.isDestroyed||this.setStyle({opacity:.8}),this.zoomAnimationTimeout&&clearTimeout(this.zoomAnimationTimeout),this.zoomAnimationTimeout=setTimeout(()=>{if(!(this.isDestroyed||!this._map))try{this._map&&this._map.hasLayer(this)&&!this.isDestroyed&&(this.redraw(),this.showSamplePoints())}catch(i){console.warn("[ElevationLine] Erreur lors du redraw après zoom:",i),this.cleanup()}},50)}catch(t){console.error("[ElevationLine] Error in handleZoomEnd:",t)}finally{this.isZooming=!1}})}cleanup(){At.measure("ElevationLine.cleanup",()=>{if(this.isZooming=!1,this.clearSamplePoints(),this.hideElevationMarker(),this.zoomAnimationTimeout&&(clearTimeout(this.zoomAnimationTimeout),this.zoomAnimationTimeout=null),this.simpleLine&&this._map){try{this.simpleLine.remove()}catch(i){console.error("[ElevationLine] Error removing simpleLine:",i)}this.simpleLine=null}if(this.elevationProfile){try{this.elevationProfile.remove()}catch(i){console.error("[ElevationLine] Error removing elevationProfile:",i)}this.elevationProfile=null}const t=this._path;t&&(t.style.display=""),!this.isDestroyed&&this._map&&this._map.hasLayer(this)&&this.setStyle({opacity:.8})})}calculateOptimalSampleCount(){return At.measure("ElevationLine.calculateOptimalSampleCount",()=>{const t=this.getLength(),i=Math.ceil(t/wa.SAMPLE_DISTANCE);return Math.min(Math.max(i,wa.MIN_SAMPLES),wa.MAX_SAMPLES)})}async fetchElevationData(t=0){return At.measure("ElevationLine.fetchElevationData",async()=>{if(this.getLatLngs().length===0)return;const r=this.getLength();let o="";const l=this.calculateOptimalSampleCount();console.log(`[ElevationLine] Using ${l} sample points for ${r.toFixed(0)}m line`);const h=[];for(let p=0;p<l;p++){const m=p/(l-1)*r,_=this.getPointAtDistance(m);_&&h.push(`${_.lat},${_.lng}`)}o=h.join("|");try{const p=await fetch(`${wa.API_URL}?locations=${o}`);if(!p.ok)throw new Error(`HTTP error ${p.status}`);const m=await p.json();if(!m.results||!Array.isArray(m.results))throw new Error("Invalid API response format");this.elevationData=m.results.map((_,w)=>({distance:w/(l-1)*r,elevation:_.elevation})),this.properties.dataSource="api"}catch(p){if(console.warn(`[ElevationLine] API fetch attempt ${t+1}/${wa.MAX_RETRIES} failed:`,p),t<wa.MAX_RETRIES)return await new Promise(m=>setTimeout(m,wa.RETRY_DELAY)),this.fetchElevationData(t+1);console.warn("[ElevationLine] All API attempts failed, falling back to simulation"),this.simulateElevationData(),this.properties.dataSource="simulation"}this.calculateElevationStatistics()})}simulateElevationData(){At.measure("ElevationLine.simulateElevationData",()=>{const t=this.getLength(),i=this.calculateOptimalSampleCount();this.elevationData=Array.from({length:i},(r,o)=>{const l=o/(i-1)*t,h=100+Math.sin(l/t*Math.PI*2)*50;return{distance:l,elevation:h}})})}calculateElevationStatistics(){At.measure("ElevationLine.calculateElevationStatistics",()=>{if(!this.elevationData.length)return;const t=this.elevationData.map(_=>_.elevation),i=t.length?Math.max(...t):0,r=t.length?Math.min(...t):0;let o=0,l=0,h=0,p=0,m=0;console.log("[ElevationLine][calculateElevationStatistics] Données brutes:",{elevationsCount:t.length,maxElevation:i,minElevation:r});for(let _=1;_<this.elevationData.length;_++){const w=this.elevationData[_-1],E=this.elevationData[_],b=E.elevation-w.elevation;b>0?o+=b:l+=Math.abs(b);const D=E.distance-w.distance;if(D>0){const j=b/D*100;h=Math.max(h,Math.abs(j)),p+=Math.abs(j),m++}}console.log("[ElevationLine][calculateElevationStatistics] Calculs intermédiaires:",{gain:o,loss:l,maxSlope:h,averageSlope:m>0?p/m:0}),this.properties={...this.properties,type:"ElevationLine",maxElevation:i,minElevation:r,elevationGain:o,elevationLoss:l,maxSlope:h,averageSlope:m>0?p/m:0,elevationData:this.elevationData,dataSource:this.properties.dataSource,length:this.getLength()},console.log("[ElevationLine][calculateElevationStatistics] Propriétés mises à jour:",this.properties)})}showSamplePoints(){At.measure("ElevationLine.showSamplePoints",()=>{if(this.clearSamplePoints(),!this.elevationData.length)return;const t=this.elevationData.map(o=>o.elevation),i=Math.max(...t),r=Math.min(...t);this.elevationData.forEach(o=>{const l=this.getPointAtDistance(o.distance);if(!l)return;const h=o.elevation===r,p=o.elevation===i;let m={...this.samplePointStyle};h?m={...m,...this.minMaxPointStyle,color:"#DC2626",fillColor:"#DC2626"}:p&&(m={...m,...this.minMaxPointStyle,color:"#059669",fillColor:"#059669"});const _=gn.circleMarker(l,m),w=gn.tooltip({permanent:!1,direction:"top",className:"elevation-tooltip",offset:[0,-10]});let E=`
          Distance: ${this.formatDistance(o.distance)}<br>
          Altitude: ${this.formatElevation(o.elevation)}
        `;h&&(E+="<br><strong>Point le plus bas</strong>"),p&&(E+="<br><strong>Point le plus haut</strong>"),w.setContent(E),_.on("mouseover",()=>{_.setStyle({...m,radius:m.radius+2,fillOpacity:1}),_.bindTooltip(w).openTooltip()}),_.on("mouseout",()=>{_.setStyle(m),_.closeTooltip()}),this._map&&(_.addTo(this._map),this.samplePoints.push(_),this.sampleTooltips.push(w))})})}clearSamplePoints(){At.measure("ElevationLine.clearSamplePoints",()=>{this.samplePoints.forEach(t=>t.remove()),this.samplePoints=[],this.sampleTooltips.forEach(t=>t.remove()),this.sampleTooltips=[]})}formatDistance(t){return At.measure("ElevationLine.formatDistance",()=>t>=1e3?`${(t/1e3).toFixed(2)} km`:`${t.toFixed(0)} m`)}formatElevation(t){return At.measure("ElevationLine.formatElevation",()=>`${t.toFixed(0)} m`)}onAdd(t){return At.measure("ElevationLine.onAdd",()=>(super.onAdd(t),this.showSamplePoints(),this))}onRemove(t){return this.isDestroyed=!0,this.cleanupEventListeners(),this.cleanup(),super.onRemove(t)}async updateElevationProfile(){return At.measure("ElevationLine.updateElevationProfile",async()=>{try{if(this.properties.elevationData&&this.properties.dataSource==="restored"){this.elevationData=this.properties.elevationData,this.calculateElevationStatistics(),this._map&&this._map.hasLayer(this)&&this.showSamplePoints(),this.fire("elevation:updated",{shape:this,elevationData:this.elevationData,properties:this.properties});return}await this.fetchElevationData(),this.updateProperties(),this._map&&this._map.hasLayer(this)&&this.showSamplePoints(),this.fire("elevation:updated",{shape:this,elevationData:this.elevationData,properties:this.properties})}catch(t){console.error("[ElevationLine] Erreur lors de la mise à jour du profil d'élévation:",t),this.properties.dataSource="error"}})}updateProperties(){At.measure("ElevationLine.updateProperties",()=>{if(super.updateProperties(),this.elevationData&&this.elevationData.length>0){const t=this.elevationData.map(E=>E.elevation),i=Math.max(...t),r=Math.min(...t);let o=0,l=0,h=0,p=0,m=0;for(let E=1;E<this.elevationData.length;E++){const b=this.elevationData[E-1],D=this.elevationData[E],j=D.elevation-b.elevation;j>0?o+=j:l+=Math.abs(j);const Q=D.distance-b.distance;if(Q>0){const F=j/Q*100;h=Math.max(h,Math.abs(F)),p+=Math.abs(F),m++}}const w=this.getLatLngs().map(E=>({lat:E.lat,lng:E.lng}));this.properties={...this.properties,type:"ElevationLine",coordinates:w,elevationData:this.elevationData.map(E=>({distance:E.distance,elevation:E.elevation})),maxElevation:i,minElevation:r,elevationGain:o,elevationLoss:l,maxSlope:h,averageSlope:m>0?p/m:0,dataSource:this.properties.dataSource||"api"},this.fire("properties:updated",{shape:this,properties:this.properties})}})}getElevationData(){return At.measure("ElevationLine.getElevationData",()=>this.elevationData)}showElevationAt(t){At.measure("ElevationLine.showElevationAt",()=>{if(!(!this.elevationData.length||!this._map))try{const i=this.elevationData.reduce((o,l)=>Math.abs(l.distance-t)<Math.abs(o.distance-t)?l:o),r=this.getPointAtDistance(t);if(!r)return;this.elevationMarker?(this.elevationMarker.setLatLng(r),this.elevationMarker.setTooltipContent(`Distance: ${this.formatDistance(i.distance)}<br>Altitude: ${this.formatElevation(i.elevation)}`)):(this.elevationMarker=gn.circleMarker(r,{radius:6,color:"#FF4500",fillColor:"#FF4500",fillOpacity:1,weight:2,className:"elevation-marker"}),this.elevationMarker.bindTooltip(`Distance: ${this.formatDistance(i.distance)}<br>Altitude: ${this.formatElevation(i.elevation)}`,{permanent:!0,direction:"top",offset:[0,-10],className:"elevation-marker-tooltip"}),this._map&&this._map.hasLayer(this)&&this.elevationMarker.addTo(this._map)),this.fire("elevation:show",{distance:t,elevation:i.elevation,latLng:r})}catch(i){console.error("[ElevationLine] Erreur lors de l'affichage de l'élévation:",i),this.hideElevationMarker()}})}hideElevationMarker(){At.measure("ElevationLine.hideElevationMarker",()=>{this.elevationMarker&&(this.elevationMarker.remove(),this.elevationMarker=null)})}getPointAtDistance(t){return At.measure("ElevationLine.getPointAtDistance",()=>{try{const r=this.getLatLngs().map(h=>[h.lng,h.lat]),o=Al(r),l=Tg(o,t,{units:"meters"});return gn.latLng(l.geometry.coordinates[1],l.geometry.coordinates[0])}catch(i){return console.error("Error calculating point at distance",i),null}})}moveVertex(t,i,r=!1){At.measure("ElevationLine.moveVertex",()=>{super.moveVertex(t,i,!1),this.properties.type="ElevationLine",r&&this.updateElevationProfile()})}addVertex(t,i,r=!1){At.measure("ElevationLine.addVertex",()=>{console.warn("[ElevationLine] Tentative d'ajout de vertex ignorée - non autorisé pour un profil altimétrique")})}setLatLngs(t){return At.measure("ElevationLine.setLatLngs",()=>(super.setLatLngs(t),this.properties.type="ElevationLine",this.updateElevationProfile(),this))}move(t,i=!0){return At.measure("ElevationLine.move",()=>(super.move(t,!1),this.properties.type="ElevationLine",i&&this.updateElevationProfile(),this))}setSamplePointStyle(t){At.measure("ElevationLine.setSamplePointStyle",()=>{this.samplePointStyle={...this.samplePointStyle,...t},this.properties.samplePointStyle=this.samplePointStyle,this._map&&this.showSamplePoints()})}setMinMaxPointStyle(t){At.measure("ElevationLine.setMinMaxPointStyle",()=>{this.minMaxPointStyle={...this.minMaxPointStyle,...t},this.properties.minMaxPointStyle=this.minMaxPointStyle,this._map&&this.showSamplePoints()})}setName(t){At.measure("ElevationLine.setName",()=>{this.properties.style||(this.properties.style={}),this.properties.style.name=t,this.fire("properties:updated",{shape:this,properties:this.properties})})}getName(){return At.measure("ElevationLine.getName",()=>{var t,i;return((i=(t=this.properties)==null?void 0:t.style)==null?void 0:i.name)||""})}};Mt(wa,"API_URL","https://api.open-elevation.com/api/v1/lookup"),Mt(wa,"RETRY_DELAY",2e3),Mt(wa,"MAX_RETRIES",3),Mt(wa,"SAMPLE_DISTANCE",100),Mt(wa,"MIN_SAMPLES",10),Mt(wa,"MAX_SAMPLES",50);let Ac=wa;class bc extends Xc{constructor(t,i){super(t,i);Mt(this,"_sections",[]);Mt(this,"_sectionLayers",[]);Mt(this,"_isDragging",!1);Mt(this,"_dragTimeout",null);At.measure("CircleWithSections.constructor",()=>(this._sections=i.sections||[],this.properties.type="CircleWithSections",this.properties.sections=this._sections,this.on("add",()=>{setTimeout(()=>this._initSections(),100)}),this.on("remove",()=>this._clearSections()),this.on("dragstart",()=>{this._isDragging=!0,this._clearSections()}),this.on("drag",()=>{this._dragTimeout&&clearTimeout(this._dragTimeout),this._dragTimeout=window.setTimeout(()=>{this._isDragging&&this._map&&this._renderSectionsPreview()},50)}),this.on("dragend",()=>{this._isDragging=!1,this._dragTimeout&&(clearTimeout(this._dragTimeout),this._dragTimeout=null),setTimeout(()=>{this._map&&(this._initSections(),this.updateProperties())},100)}),this.on("zoomanim",()=>{this._map&&this._clearSections()}),this.on("zoomend",()=>{this._map&&setTimeout(()=>{this._map&&(this._clearSections(),this._initSections())},100)}),this.updateProperties(),this))}_initSections(){At.measure("CircleWithSections._initSections",()=>{this.getMap()&&(this._clearSections(),setTimeout(()=>{this.getMap()&&this._sections.forEach(i=>{this._renderSection(i)})},0))})}_clearSections(){At.measure("CircleWithSections._clearSections",()=>{this._sectionLayers.forEach(t=>{try{t&&t.remove&&this._map&&this._map.hasLayer(t)&&t.remove()}catch(i){console.warn("Erreur lors de la suppression d'une section:",i)}}),this._sectionLayers=[]})}_isFullCircle(t){return At.measure("CircleWithSections._isFullCircle",()=>t.startAngle===0&&t.endAngle===360)}_renderSection(t){At.measure("CircleWithSections._renderSection",()=>{const i=this.getMap();if(!i)return;const r=this.getLatLng(),o=[];if(this._isFullCircle(t)){console.log("[CircleWithSections] Rendu d'une section circulaire complète",{sectionId:t.id,name:t.name,radius:t.radius});const _=new gn.Circle(r,{radius:t.radius,color:t.color,fillColor:t.color,fillOpacity:.4,weight:2,interactive:!0});_.addTo(i),this._sectionLayers.push(_),_.on("click",w=>{console.log("[CircleWithSections] Clic sur une section circulaire complète",{sectionId:t.id,name:t.name,event:w,parentCircle:this}),this._emitCustomEvent("section:clicked",{section:t,parentCircle:this});const E=this._findFeatureGroup();E&&E.fire("click",{...w,layer:this,target:this,type:"click"})});return}console.log("[CircleWithSections] Rendu d'une section partielle",{sectionId:t.id,name:t.name,startAngle:t.startAngle,endAngle:t.endAngle,radius:t.radius}),o.push(r);const h=32,p=t.endAngle-t.startAngle;for(let _=0;_<=h;_++){const w=t.startAngle+p*_/h,E=this._calculatePointOnCircle(w,t.radius);o.push(E)}o.push(r);const m=new gn.Polygon(o,{color:t.color,fillColor:t.color,fillOpacity:.4,weight:2,interactive:!0});m.addTo(i),this._sectionLayers.push(m),m.on("click",_=>{console.log("[CircleWithSections] Clic sur une section partielle",{sectionId:t.id,name:t.name,event:_,parentCircle:this}),this._emitCustomEvent("section:clicked",{section:t,parentCircle:this});const w=this._findFeatureGroup();w&&w.fire("click",{..._,layer:this,target:this,type:"click"})})})}_findFeatureGroup(){return At.measure("CircleWithSections._findFeatureGroup",()=>{if(!this._map)return null;let t=null;return this._map.eachLayer(i=>{i instanceof gn.FeatureGroup&&i.hasLayer(this)&&(t=i)}),t})}_normalizeAngle(t){return At.measure("CircleWithSections._normalizeAngle",()=>(t%360+360)%360)}_updateSectionAngles(t,i,r){At.measure("CircleWithSections._updateSectionAngles",()=>{const o=this._normalizeAngle(t.startAngle),l=this._normalizeAngle(t.endAngle),h=(l-o+360)%360;let p=i!==null?this._normalizeAngle(i):o,m=r!==null?this._normalizeAngle(r):l,_=(m-p+360)%360;const w=45;Math.abs(_-h)>w&&(_>h?_=h+w:_=h-w,i!==null?m=(p+_)%360:p=(m-_+360)%360),_<355&&(_=Math.max(5,_),i!==null?m=(p+_)%360:p=(m-_+360)%360),t.startAngle=p,t.endAngle=m})}_addMarkerEvents(t,i,r){At.measure("CircleWithSections._addMarkerEvents",()=>{let o=!1;const l=this.getMap();if(!l)return;const h=(_,w)=>{if(!o)return;const E=this._calculateAngleFromPoint(_.latlng);w?this._updateSectionAngles(r,E,null):this._updateSectionAngles(r,null,E),this._clearSections(),this._renderSection(r),this._emitCustomEvent("section:visual-update",{section:r,sections:this._sections})},p=()=>{o=!1,l.dragging.enable(),this.updateProperties(),this._emitCustomEvent("section:updated",{section:r,sections:this._sections})};t.on("mousedown",()=>{o=!0,l.dragging.disable()}),t.on("mousemove",_=>{h(_,!0)}),t.on("mouseup",p),t.on("mouseout",()=>{o&&p(),t.setStyle({radius:5,fillOpacity:1}),l.getContainer().style.cursor=""}),i.on("mousedown",()=>{o=!0,l.dragging.disable()}),i.on("mousemove",_=>{h(_,!1)}),i.on("mouseup",p),i.on("mouseout",()=>{o&&p(),i.setStyle({radius:5,fillOpacity:1}),l.getContainer().style.cursor=""});const m=(_,w)=>{w?(_.setStyle({radius:6,fillOpacity:.8}),l.getContainer().style.cursor="pointer"):o||(_.setStyle({radius:5,fillOpacity:1}),l.getContainer().style.cursor="")};t.on("mouseover",()=>m(t,!0)),t.on("mouseout",()=>m(t,!1)),i.on("mouseover",()=>m(i,!0)),i.on("mouseout",()=>m(i,!1)),l.on("mousemove",_=>{if(o){const w=_.originalEvent.target;w===t.getElement()?h(_,!0):w===i.getElement()&&h(_,!1)}}),l.on("mouseup",()=>{o&&p()})})}_calculatePointOnCircle(t,i){return At.measure("CircleWithSections._calculatePointOnCircle",()=>{const r=this.getLatLng(),o=t*Math.PI/180,l=i;return gn.latLng(r.lat+l/111319.9*Math.sin(o),r.lng+l/(111319.9*Math.cos(r.lat*Math.PI/180))*Math.cos(o))})}_calculateAngleFromPoint(t){return At.measure("CircleWithSections._calculateAngleFromPoint",()=>{const i=this.getLatLng(),r=t.lng-i.lng,o=t.lat-i.lat;let l=Math.atan2(o,r)*180/Math.PI;return l=(90-l)%360,l<0&&(l+=360),Math.round(l)})}updateSection(t,i){return At.measure("CircleWithSections.updateSection",()=>{const r=this._sections.findIndex(o=>o.id===t);if(r!==-1){i.radius!==void 0&&(i.radius=Math.max(1,i.radius),i.radius=Math.floor(i.radius)),this._sections[r]={...this._sections[r],...i};const o=this._sections[r];return i.startAngle===0&&i.endAngle===360&&(o.startAngle=0,o.endAngle=360),this.properties.sections=this._sections,this._clearSections(),this._sections.forEach(l=>{this._renderSection(l)}),this._emitCustomEvent("section:updated",{section:this._sections[r],sections:this._sections}),this.updateProperties(),!0}return!1})}addSection(t={}){return At.measure("CircleWithSections.addSection",()=>{const i=this.getRadius();let r;if(t.radius!==void 0)r=Math.max(1,t.radius);else{const h=this._sections[this._sections.length-1];h?r=Math.max(h.radius-20,20):r=Math.max(i-20,20)}const o={id:`section-${Date.now()}-${Math.floor(Math.random()*1e3)}`,startAngle:t.startAngle||0,endAngle:t.endAngle||45,radius:Math.floor(r),color:t.color||this._getRandomColor(),name:t.name||`Section ${this._sections.length+1}`};return this._sections.push(o),this.properties.sections=this._sections,this.getMap()&&this._renderSection(o),this._emitCustomEvent("section:added",{section:o,sections:this._sections}),this.updateProperties(),o})}removeSection(t){return At.measure("CircleWithSections.removeSection",()=>{const i=this._sections.length;return this._sections=this._sections.filter(r=>r.id!==t),i!==this._sections.length?(this.properties.sections=this._sections,this._clearSections(),this._sections.forEach(r=>{this._renderSection(r)}),this._emitCustomEvent("section:removed",{sectionId:t,sections:this._sections}),this.updateProperties(),!0):!1})}makeFullCircle(t){At.measure("CircleWithSections.makeFullCircle",()=>{t.startAngle=0,t.endAngle=360,this._clearSections(),this._renderSection(t),this._emitCustomEvent("section:updated",{section:t,sections:this._sections}),this.updateProperties()})}getSections(){return At.measure("CircleWithSections.getSections",()=>[...this._sections])}updateProperties(){At.measure("CircleWithSections.updateProperties",()=>{var l,h,p,m;const t=this.getLatLng(),i=this.getRadius();let r=0;const o=this._sections.map(_=>{const E=(_.endAngle-_.startAngle)*Math.PI/180/(2*Math.PI)*Math.PI*Math.pow(_.radius,2),b=Math.round(E*100)/100;return r+=E,{..._,surface:b}});this.properties={type:"CircleWithSections",radius:i,diameter:i*2,surface:Math.PI*Math.pow(i,2),perimeter:2*Math.PI*i,center:{lat:t.lat,lng:t.lng},sections:o,sectionArea:r,style:{...(l=this.properties)==null?void 0:l.style,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#3388ff",fillOpacity:this.options.fillOpacity||.2,dashArray:((h=this.options)==null?void 0:h.dashArray)||"",name:((m=(p=this.properties)==null?void 0:p.style)==null?void 0:m.name)||""}},this.fire("properties:updated",{shape:this,properties:this.properties})})}_getRandomColor(){return At.measure("CircleWithSections._getRandomColor",()=>{const t=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899","#14B8A6","#F97316","#6366F1","#84CC16"],i=this._sections.map(o=>o.color),r=t.filter(o=>!i.includes(o));return r.length>0?r[Math.floor(Math.random()*r.length)]:t[Math.floor(Math.random()*t.length)]})}setRadius(t){return At.measure("CircleWithSections.setRadius",()=>(super.setRadius(t),this._sections=this._sections.map(i=>({...i,radius:Math.min(i.radius,t)})),this._clearSections(),this._initSections(),this))}setLatLng(t){return At.measure("CircleWithSections.setLatLng",()=>(super.setLatLng(t),this._isDragging?this._renderSectionsPreview():(this._clearSections(),this._initSections()),this))}getMap(){return At.measure("CircleWithSections.getMap",()=>this._map)}_renderSectionsPreview(){At.measure("CircleWithSections._renderSectionsPreview",()=>{const t=this.getMap();if(!(!t||!this._map))try{this._clearSections(),this._sections.forEach(i=>{if(Math.abs(i.endAngle-i.startAngle)>=360)try{const o=new gn.Circle(this.getLatLng(),{radius:i.radius,color:i.color,fillColor:i.color,fillOpacity:.2,weight:1,dashArray:"5,5",interactive:!1});t&&t.hasLayer(this)&&(o.addTo(t),this._sectionLayers.push(o))}catch(o){console.warn("Erreur lors du rendu de la prévisualisation du cercle complet:",o)}else try{const o=[];o.push(this.getLatLng());const l=16,h=i.endAngle-i.startAngle;for(let m=0;m<=l;m++){const _=i.startAngle+h*m/l,w=this._calculatePointOnCircle(_,i.radius);o.push(w)}o.push(this.getLatLng());const p=new gn.Polygon(o,{color:i.color,fillColor:i.color,fillOpacity:.2,weight:1,dashArray:"5,5",interactive:!1});t&&t.hasLayer(this)&&(p.addTo(t),this._sectionLayers.push(p))}catch(o){console.warn("Erreur lors du rendu de la prévisualisation de la section partielle:",o)}})}catch(i){console.error("Erreur lors du rendu des prévisualisations:",i)}})}getMinRadius(){return At.measure("CircleWithSections.getMinRadius",()=>1)}_emitCustomEvent(t,i){At.measure("CircleWithSections._emitCustomEvent",()=>{this.fire(t,i);const r=new CustomEvent(t,{detail:i,bubbles:!0,cancelable:!0});window.dispatchEvent(r),console.log(`[CircleWithSections] Événement émis: ${t}`,i)})}}const vp=(e,n)=>{if(!e||typeof e!="string"||!e.startsWith("#"))return`rgba(0, 0, 0, ${n})`;const t=parseInt(e.slice(1,3),16),i=parseInt(e.slice(3,5),16),r=parseInt(e.slice(5,7),16);return`rgba(${t}, ${i}, ${r}, ${n})`},Sy=(e,n)=>{e.style.fontSize=n.fontSize,e.style.color=n.color,e.style.backgroundColor=vp(n.backgroundColor,n.backgroundOpacity),n.hasBorder?e.style.border=`${n.borderWidth} solid ${vp(n.borderColor,n.borderOpacity)}`:e.style.border="none",e.style.padding=n.padding,e.style.borderRadius=n.borderRadius},jo=e=>{document.querySelectorAll(".drawing-help-message").forEach(i=>i.remove());const t=St.DomUtil.create("div","drawing-help-message");return t.innerHTML=e,t.style.cssText=`
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 8px 16px;
    border-radius: 4px;
    font-size: 14px;
    z-index: 2000;
    pointer-events: none;
    text-align: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  `,document.body.appendChild(t),t};function Py(e,n,t){const i=156543.03392*Math.cos(n*Math.PI/180)/Math.pow(2,t);return e/i}const tr=(e,n="m",t="")=>{let i,r;return n==="m²"?e>=1e4?(i=(e/1e4).toFixed(2),r="ha"):(i=e.toFixed(2),r="m²"):n==="m"?e>=1e3?(i=(e/1e3).toFixed(2),r="km"):(i=e.toFixed(2),r="m"):(i=e.toFixed(2),r=n),t?`${t}: ${i} ${r}`:`${i} ${r}`},v8=e=>({...e,clientX:e.clientX,clientY:e.clientY,button:e.button||0,buttons:e.buttons||0,altKey:e.altKey||!1}),y8=(e,n)=>{let t;return function(...i){window.clearTimeout(t),t=window.setTimeout(()=>e.apply(this,i),n)}},Wu=(e,n)=>{let t=0;return function(...i){const r=Date.now();if(!(r-t<n))return t=r,e.apply(this,i)}};function x4(){const e=Yt(null),n=Yt(null),t=Yt(null),i=Yt(null),r=Yt(""),o=Yt(null),l=Yt(!1),h=Yt(null);window.addEventListener("clearControlPoints",()=>{o.value=null,t.value&&t.value.clearLayers(),i.value&&i.value.clearLayers(),document.querySelectorAll(".measure-tooltip").forEach(B=>B.remove()),document.querySelectorAll(".drawing-help-message").forEach(B=>B.remove())}),Qu(()=>{window.removeEventListener("clearControlPoints",()=>{}),e.value&&(e.value.remove(),e.value=null)});const p=(B,W="Double-cliquez pour éditer")=>{const he={fontSize:"14px",color:"#000000",backgroundColor:"#FFFFFF",backgroundOpacity:1,borderColor:"#000000",borderWidth:"1px",borderOpacity:1,padding:"5px 10px",borderRadius:"3px",hasBorder:!0,rotation:0,physicalSize:2},ne=(De,Me)=>{var Qe;const Ve=((Qe=e.value)==null?void 0:Qe.getZoom())||14,ze=B.lat,st=Py(Me.physicalSize,ze,Ve);return`<div class="text-container" style="width:${st}px;height:${st}px;transform:rotate(${Me.rotation}deg)">
        <div class="text-annotation" style="font-size:${st*.2}px;color:${Me.color};background-color:${vp(Me.backgroundColor,Me.backgroundOpacity)};border:${Me.hasBorder?Me.borderWidth+" solid "+vp(Me.borderColor,Me.borderOpacity):"none"};padding:${Me.padding};border-radius:${Me.borderRadius}">${De}</div>
        <div class="text-controls"><div class="control-button rotate"></div><div class="control-button move"></div></div>
      </div>`},re=()=>{if(!e.value)return;const De=oe.getIcon(),Me={html:ne(oe.properties.text,oe.properties.style),className:De.options.className};oe.setIcon(St.divIcon(Me))},ee=St.divIcon({html:ne(W,he),className:"text-container",iconSize:[40,40],iconAnchor:[20,20]}),oe=St.marker(B,{icon:ee,draggable:!1,pmIgnore:!0});oe.properties={type:"text",text:W,style:{...he}},e.value&&(e.value.on("zoomend",re),oe.on("remove",()=>{var De;(De=e.value)==null||De.off("zoomend",re)})),re();let Se=!1,te=!1,ae=0,Le=0;const ye=De=>{if(!e.value)return;const Me=De.target;if(Me.classList.contains("rotate")){Se=!0;const Ve=oe.getLatLng(),ze=e.value.mouseEventToLatLng(De);ae=Math.atan2(ze.lat-Ve.lat,ze.lng-Ve.lng)*180/Math.PI,Le=oe.properties.style.rotation||0}else Me.classList.contains("move")&&(te=!0);document.addEventListener("mousemove",ue),document.addEventListener("mouseup",Oe)},ue=De=>{if(!(!te||!e.value)){if(Se){const Me=oe.getLatLng(),Ve=e.value.mouseEventToLatLng(De),ze=Math.atan2(Ve.lat-Me.lat,Ve.lng-Me.lng)*180/Math.PI,st=(Le+(ze-ae))%360;oe.properties.style.rotation=st;const Qe=oe.getIcon(),pt={html:ne(oe.properties.text,oe.properties.style),className:Qe.options.className};oe.setIcon(St.divIcon(pt))}else if(te){const Me=v8(De),Ve=e.value.mouseEventToLatLng(Me);oe.setLatLng(Ve)}}},Oe=()=>{Se=!1,te=!1,document.removeEventListener("mousemove",ue),document.removeEventListener("mouseup",Oe)};return oe.on("add",()=>{const De=oe.getElement();De&&De.querySelectorAll(".control-button").forEach(Ve=>{Ve.addEventListener("mousedown",ye)})}),oe.on("remove",()=>{const De=oe.getElement();De&&De.querySelectorAll(".control-button").forEach(Ve=>{Ve.removeEventListener("mousedown",ye)})}),oe.on("dblclick",De=>{var pt;St.DomEvent.stopPropagation(De);const Me=(pt=oe.getElement())==null?void 0:pt.querySelector(".text-annotation");if(!Me)return;Me.contentEditable="true",Me.focus(),Me.classList.add("editing");const Ve=window.getSelection(),ze=document.createRange();ze.selectNodeContents(Me),Ve==null||Ve.removeAllRanges(),Ve==null||Ve.addRange(ze);const st=()=>{Me.contentEditable="false",Me.classList.remove("editing");const wt=Me.innerText.trim();if(wt){oe.properties.text=wt;const Ht=oe.getIcon(),nn={html:ne(wt,oe.properties.style),className:Ht.options.className};oe.setIcon(St.divIcon(nn))}Me.removeEventListener("blur",st),Me.removeEventListener("keydown",Qe)},Qe=wt=>{wt.key==="Enter"&&!wt.shiftKey&&(wt.preventDefault(),st())};Me.addEventListener("blur",st),Me.addEventListener("keydown",Qe)}),oe},m=(B,W)=>{const he=St.DomUtil.create("div","measure-tooltip");if(he.innerHTML=W,he.style.cssText=`
      position: fixed;
      background-color: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      z-index: 2000;
      pointer-events: none;
      white-space: pre-line;
    `,document.body.appendChild(he),e.value){const ne=e.value.latLngToContainerPoint(B);he.style.left=`${ne.x+10}px`,he.style.top=`${ne.y-25}px`}return he},_=Wu((B,W,he)=>{if(B&&(B.innerHTML=he,e.value)){const ne=e.value.latLngToContainerPoint(W);B.style.left=`${ne.x+10}px`,B.style.top=`${ne.y-25}px`}},100),w=(B,W,he)=>{B.on("mouseover",()=>{const ne=m(B.getLatLng(),he());B.measureDiv=ne}),B.on("mousemove",ne=>{B.measureDiv&&e.value&&_(B.measureDiv,ne.latlng,he())}),B.on("mouseout",()=>{B.measureDiv&&(B.measureDiv.remove(),B.measureDiv=void 0)})};let E=[];const b=()=>{var B;E.cleanup&&E.cleanup(),t.value&&t.value.clearLayers(),E=[],(B=i.value)==null||B.clearLayers(),document.querySelectorAll(".measure-tooltip").forEach(W=>W.remove()),n.value&&n.value.getLayers().forEach(W=>{W instanceof Uo&&W.clearHelperPoints()})},D=(B,W="#2563EB")=>{const he=St.circleMarker(B,{radius:6,color:W,fillColor:W,fillOpacity:1,weight:2,className:"control-point",pmIgnore:!0});return t.value&&t.value.addLayer(he),he},j=(B,W)=>{var ne,re,ee,oe,Se,te,ae,Le,ye,ue,Oe,De,Me,Ve;console.log("Input layer:",{type:W,instanceof:{Circle:B instanceof St.Circle,Rectangle:B instanceof St.Rectangle,Polygon:B instanceof St.Polygon,Polyline:B instanceof St.Polyline,CircleArc:B instanceof Lu,TextRectangle:B instanceof Jl,ElevationLine:B instanceof Ac,Line:B instanceof $o,CircleWithSections:((ne=B.properties)==null?void 0:ne.type)==="CircleWithSections"},options:B.options});const he={type:W,style:B.options||{}};try{if(B instanceof Jl)return B.properties;if(((re=B.properties)==null?void 0:re.type)==="CircleWithSections"){const ze=B.properties;return{...ze,type:"CircleWithSections",style:{...ze.style,color:((ee=B.options)==null?void 0:ee.color)||"#3388ff",weight:((oe=B.options)==null?void 0:oe.weight)||3,opacity:((Se=B.options)==null?void 0:Se.opacity)||1,fillColor:((te=B.options)==null?void 0:te.fillColor)||"#3388ff",fillOpacity:((ae=B.options)==null?void 0:ae.fillOpacity)||.2,dashArray:((Le=B.options)==null?void 0:Le.dashArray)||""}}}else if(B instanceof St.Circle){const ze=B.getRadius();he.radius=ze,he.diameter=ze*2,he.surface=Math.PI*Math.pow(ze,2),he.perimeter=2*Math.PI*ze,he.center=B.getLatLng()}else if(B instanceof Lu){const ze=B.getRadius?B.getRadius():0,st=B.getCenter?B.getCenter():{lat:0,lng:0},Qe=B.getStartAngle?B.getStartAngle():0,pt=B.getStopAngle?B.getStopAngle():180,wt=(pt-Qe+360)%360;he.radius=ze,he.diameter=ze*2,he.surface=Math.PI*Math.pow(ze,2)*wt/360,he.arcLength=2*Math.PI*ze*wt/360,he.perimeter=he.arcLength+2*ze,he.center=st,he.startAngle=Qe,he.stopAngle=pt,he.openingAngle=wt}else if(B instanceof St.Rectangle){const ze=B.getBounds(),st=ze.getNorthEast(),Qe=ze.getSouthWest(),pt=Al([[Qe.lng,Qe.lat],[st.lng,Qe.lat]]),wt=Al([[Qe.lng,Qe.lat],[Qe.lng,st.lat]]),Ht=Zc(pt,{units:"meters"}),nn=Zc(wt,{units:"meters"});he.width=Ht,he.height=nn,he.surface=Ht*nn,he.perimeter=2*(Ht+nn),he.dimensions={width:Ht,height:nn}}else if(B instanceof St.Polygon)try{const st=B.getLatLngs()[0].map(pt=>[pt.lng,pt.lat]);st.push(st[0]);const Qe=El([st]);he.surface=vu(Qe),he.perimeter=Zc(Al(st),{units:"meters"})}catch(ze){console.error("Erreur lors du calcul des propriétés du polygone",ze)}else if(B instanceof St.Polyline&&!(B instanceof St.Polygon))try{const ze=B.getLatLngs();let st=0;for(let Qe=1;Qe<ze.length;Qe++)st+=ze[Qe].distanceTo(ze[Qe-1]);he.length=st}catch(ze){console.error("Erreur lors du calcul de la longueur de la ligne",ze)}he.style={...he.style,color:((ye=B.options)==null?void 0:ye.color)||"#3388ff",weight:((ue=B.options)==null?void 0:ue.weight)||3,opacity:((Oe=B.options)==null?void 0:Oe.opacity)||1,fillColor:((De=B.options)==null?void 0:De.fillColor)||"#3388ff",fillOpacity:((Me=B.options)==null?void 0:Me.fillOpacity)||.2,dashArray:((Ve=B.options)==null?void 0:Ve.dashArray)||""}}catch(ze){console.error("Error calculating shape properties:",ze)}return he},Q=(B,W=2)=>{var oe;if(!e.value){console.warn("Map is not available for text size update");return}const he=e.value.getZoom(),ne=B.getLatLng().lat,re=Py(W,ne,he),ee=(oe=B.getElement())==null?void 0:oe.querySelector(".text-annotation");ee&&(B.properties.style.fontSize=`${re}px`,B.properties.physicalWidth=W,B.properties.physicalHeight=W,Sy(ee,B.properties.style))},F=(B,W,he)=>{const ne=St.map(B).setView(W,he);e.value=ne,St.tileLayer("/osm_tiles/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:5}).addTo(ne);const re=new St.FeatureGroup;return re.addTo(ne),n.value=re,t.value=St.featureGroup().addTo(ne),i.value=St.featureGroup().addTo(ne),ne.pm.setGlobalOptions({snappable:!0,snapDistance:20,allowSelfIntersection:!1,preventMarkerRemoval:!0,syncLayersOnDrag:!0,layerGroup:re,snapLayers:[re,i.value],templineStyle:{color:"#3388ff",weight:2,opacity:.7,dashArray:"6,6",radius:6},hintlineStyle:{color:"#3388ff",weight:2,opacity:.7,dashArray:"6,6",radius:6}}),ne.on("pm:drawstart",ee=>{l.value=!0,ee.shape==="Circle"&&r.value==="Semicircle"&&(ne.getContainer().style.cursor="crosshair")}),ne.on("pm:drawend",()=>{l.value=!1,ne.getContainer().style.cursor="",o.value&&jo("Cliquez sur la forme pour afficher les points de contrôle")}),ne.on("pm:create",X),re.on("click",ee=>{var Se,te,ae,Le,ye,ue,Oe,De,Me,Ve,ze,st,Qe,pt,wt,Ht,nn,tt,Qt;St.DomEvent.stopPropagation(ee);const oe=ee.layer;if(oe.name&&!((Se=oe.properties)!=null&&Se.name)?(oe.properties||(oe.properties={}),oe.properties.name=oe.name):(te=oe.properties)!=null&&te.name&&!oe.name&&(oe.name=oe.properties.name),console.log("[featureGroup click] État du nom:",{directName:oe.name,propertiesName:(ae=oe.properties)==null?void 0:ae.name,fullProperties:oe.properties}),(Le=i.value)==null||Le.clearLayers(),b(),o.value=oe,oe instanceof Jl){console.log("[featureGroup click] TextRectangle sélectionné",{id:oe._leaflet_id,bounds:oe.getBounds(),hasTextContainer:!!oe.getTextElement(),properties:oe.properties}),(ye=e.value)!=null&&ye.pm.globalEditModeEnabled()&&e.value.pm.disableGlobalEditMode(),R(oe),jo("Double-cliquez pour éditer le texte. Utilisez les points rouges pour redimensionner.");return}if(oe instanceof bc||((ue=oe.properties)==null?void 0:ue.type)==="CircleWithSections"){console.log("[featureGroup click] CircleWithSections sélectionné",{id:oe._leaflet_id,properties:oe.properties,sections:(Oe=oe.properties)==null?void 0:Oe.sections}),H(oe),jo("Utilisez les points de contrôle verts pour manipuler le cercle. Configurez les sections dans le panneau latéral.");return}if(oe instanceof Lu||((De=oe.properties)==null?void 0:De.type)==="Semicircle")Y(oe);else if(oe instanceof Xc)H(oe);else if(oe instanceof St.Circle){console.log("[useMapDrawing] Création du cercle personnalisé:",{propertyDescriptor:Object.getOwnPropertyDescriptor(oe,"name"),directName:oe.name,propertiesName:(Me=oe.properties)==null?void 0:Me.name,styleNameBeforeTransfer:(ze=(Ve=oe.properties)==null?void 0:Ve.style)==null?void 0:ze.name,nameIsEnumerable:Object.keys(oe).includes("name"),allProperties:Object.keys(oe.properties||{}),_dbId:oe._dbId});const rn=oe.name,it=(st=oe.properties)==null?void 0:st.name,Ke=(pt=(Qe=oe.properties)==null?void 0:Qe.style)==null?void 0:pt.name,qt=oe._dbId,mn=new Xc(oe.getLatLng(),{...oe.options,radius:oe.getRadius()});oe.properties?mn.properties={...oe.properties||{}}:mn.updateProperties();const xn=rn||it||Ke;xn&&(mn.properties.name=xn,mn.properties.style||(mn.properties.style={}),mn.properties.style.name=xn,mn.name=xn),qt&&(mn._dbId=qt),console.log("[useMapDrawing] Cercle après conversion:",{name:mn.name,propertiesName:mn.properties.name,stylePropertyName:(wt=mn.properties.style)==null?void 0:wt.name,allProperties:Object.keys(mn.properties||{})}),(Ht=n.value)==null||Ht.removeLayer(oe),(nn=n.value)==null||nn.addLayer(mn),o.value=mn,H(mn)}else if(oe instanceof Uo)le(oe);else if(oe instanceof St.Rectangle){const rn=new Uo(oe.getBounds(),{...oe.options});rn.updateProperties(),(tt=n.value)==null||tt.removeLayer(oe),(Qt=n.value)==null||Qt.addLayer(rn),o.value=rn,le(rn)}else oe instanceof St.Polygon?I(oe):(oe instanceof $o||oe instanceof St.Polyline)&&G(oe)}),ne.on("pm:edit",ee=>{var Se,te,ae;console.log("[pm:edit] Début",{layer:ee.layer,currentProperties:ee.layer.properties});const oe=ee.layer;if(oe){const Le=((Se=oe.properties)==null?void 0:Se.type)||"unknown";if(We(oe,Le),console.log("[pm:edit] Après updateLayerProperties",{updatedProperties:oe.properties,selectedShape:o.value}),Le==="Semicircle")Y(oe);else if(oe instanceof Xc)H(oe);else if(oe instanceof Uo)le(oe);else if(oe instanceof St.Rectangle){const ye=new Uo(oe.getBounds(),{...oe.options});ye.updateProperties(),(te=n.value)==null||te.removeLayer(oe),(ae=n.value)==null||ae.addLayer(ye),o.value=ye,le(ye)}else oe instanceof St.Polygon?I(oe):oe instanceof $o?(oe.updateProperties(),We(oe,"Line"),G(oe)):oe instanceof St.Polyline&&G(oe)}}),ne.on("pm:dragstart",()=>{document.querySelectorAll(".drawing-help-message").forEach(ee=>ee.remove()),jo("Déplacez la forme à l'endroit souhaité")}),ne.on("pm:dragend",ee=>{var Se,te,ae;console.log("[pm:dragend] Début",{layer:ee.layer,currentProperties:ee.layer.properties});const oe=ee.layer;if(oe){const Le=((Se=oe.properties)==null?void 0:Se.type)||"unknown";if(oe instanceof St.Rectangle&&!(oe instanceof Uo)){const ye=new Uo(oe.getBounds(),{...oe.options});ye.updateProperties(),(te=n.value)==null||te.removeLayer(oe),(ae=n.value)==null||ae.addLayer(ye),o.value=ye,le(ye)}else oe instanceof $o?(oe.updateProperties(),We(oe,"Line"),G(oe)):We(oe,Le);console.log("[pm:dragend] Après updateLayerProperties",{updatedProperties:oe.properties,selectedShape:o.value})}setTimeout(()=>{jo("Cliquez sur la forme pour afficher les points de contrôle")},100)}),ne.on("pm:remove",()=>{var ee;(ee=document.querySelector(".drawing-help-message"))==null||ee.remove()}),ne.on("pm:select",ee=>{var Se;const oe=ee.layer;document.querySelectorAll(".drawing-help-message").forEach(te=>te.remove()),oe instanceof Lu||((Se=oe.properties)==null?void 0:Se.type)==="Semicircle"?jo(`Points de contrôle : <span style="color: #059669">●</span> Ajuster le rayon, <span style="color: #2563EB">●</span> et <span style="color: #DC2626">●</span> Modifier l'ouverture du demi-cercle`):jo("Utilisez les points de contrôle pour modifier la forme")}),ne.on("pm:unselect",()=>{document.querySelectorAll(".drawing-help-message").forEach(ee=>ee.remove())}),ne.on("zoomstart",()=>{o.value&&(b(),o.value=null,document.querySelectorAll(".drawing-help-message").forEach(ee=>ee.remove()))}),ne},V=()=>{if(!(!e.value||!n.value||!n.value.getLayers().length))try{const B=n.value.getBounds();if(B.isValid()){const W={zoomAnimation:e.value.options.zoomAnimation,fadeAnimation:e.value.options.fadeAnimation,markerZoomAnimation:e.value.options.markerZoomAnimation};e.value.options.zoomAnimation=!1,e.value.options.fadeAnimation=!1,e.value.options.markerZoomAnimation=!1,e.value.fitBounds(B,{padding:[50,50],maxZoom:18,animate:!1,duration:0,noMoveStart:!0}),e.value.invalidateSize({animate:!1,pan:!1}),setTimeout(()=>{try{e.value.options.fadeAnimation=W.fadeAnimation,setTimeout(()=>{try{e.value.options.zoomAnimation=W.zoomAnimation,e.value.options.markerZoomAnimation=W.markerZoomAnimation}catch(he){console.warn("[useMapDrawing] Erreur lors de la restauration des animations:",he)}},500)}catch(he){console.warn("[useMapDrawing] Erreur lors de la restauration des animations:",he)}},500)}}catch(B){if(console.warn("[useMapDrawing] Error adjusting view:",B),e.value)try{e.value.options.zoomAnimation=!0,e.value.options.fadeAnimation=!0,e.value.options.markerZoomAnimation=!0,e.value.invalidateSize({animate:!1,pan:!1})}catch(W){console.error("[useMapDrawing] Erreur lors de la restauration après échec:",W)}}},pe=B=>{var W;if(e.value){document.querySelectorAll(".drawing-help-message").forEach(he=>he.remove());try{const he=e.value.pm;he.globalEditModeEnabled()&&he.disableGlobalEditMode(),he.globalRemovalModeEnabled()&&he.disableGlobalRemovalMode(),he.disableDraw(),b(),(W=i.value)==null||W.clearLayers()}catch(he){console.error("Error disabling modes:",he)}if(r.value=B,!B){b();return}ke(),setTimeout(()=>{var he,ne,re,ee,oe,Se,te,ae,Le,ye,ue,Oe;try{switch(B){case"Circle":case"Semicircle":n.value&&n.value.getLayers().filter(Ve=>Ve instanceof Uo).forEach(Ve=>{Ve.toggleHelperPoints(e.value,!0,"#DC2626","#2563EB")}),e.value.pm.setGlobalOptions({snapDistance:15,snapSegment:!0,snapVertices:!0,snapLayers:[n.value,i.value],snapMiddle:!0,snapIntersections:!0});let De="Positionnez le centre du cercle. Points bleus : milieu des côtés, Points rouges : sommets, Point vert : centre";B==="Semicircle"&&(De="Positionnez le centre du demi-cercle. Points bleus : milieu des côtés, Points rouges : sommets, Point vert : centre"),jo(De),e.value.pm.enableDraw("Circle",{finishOn:"mouseup",continueDrawing:!1});break;case"CircleWithSections":n.value&&n.value.getLayers().filter(Ve=>Ve instanceof Uo).forEach(Ve=>{Ve.toggleHelperPoints(e.value,!0,"#DC2626","#2563EB")}),e.value.pm.setGlobalOptions({snapDistance:15,snapSegment:!0,snapVertices:!0,snapLayers:[n.value,i.value],snapMiddle:!0,snapIntersections:!0}),jo("Positionnez le centre du cercle d'irrigation. Vous pourrez ajouter des sections après sa création."),e.value.pm.enableDraw("Circle",{finishOn:"mouseup",continueDrawing:!1}),e.value.off("pm:create"),e.value.on("pm:create",Me=>{var Ve,ze,st;if(Me.shape==="Circle"&&Me.layer&&r.value==="CircleWithSections"){const Qe=Me.layer,pt=Qe.getLatLng(),wt=Qe.getRadius();(Ve=e.value)==null||Ve.removeLayer(Qe),(ze=n.value)!=null&&ze.hasLayer(Qe)&&n.value.removeLayer(Qe);const Ht=new bc(pt,{radius:wt,color:"#3B82F6",weight:2,fillColor:"#3B82F6",fillOpacity:.2,name:"Cercle d'irrigation"});n.value&&(n.value.addLayer(Ht),o.value=Ht,Ht.updateProperties(),console.log("[CircleWithSections] Nouveau cercle avec sections créé",{center:pt,radius:wt,properties:Ht.properties}),Ht.addSection({startAngle:0,endAngle:90,radius:wt>=20?wt-20:wt,name:"Section 1"})),(st=e.value)==null||st.pm.disableDraw(),ke()}});break;case"Rectangle":jo("Cliquez et maintenez pour dessiner un rectangle, relâchez pour terminer"),(he=e.value)==null||he.pm.enableDraw("Rectangle",{finishOn:"mouseup"});break;case"Polygon":jo("Cliquez pour ajouter des points, double-cliquez pour terminer le polygone"),(ne=e.value)==null||ne.pm.enableDraw("Polygon",{finishOn:"dblclick",continueDrawing:!1,snapMiddle:!0,snapDistance:20});break;case"Line":jo("Cliquez pour ajouter des points, double-cliquez pour terminer la ligne"),(re=e.value)==null||re.pm.enableDraw("Line",{finishOn:"dblclick",continueDrawing:!1,snapMiddle:!0,snapDistance:20});break;case"Text":if(jo("Cliquez pour ajouter du texte, double-cliquez pour éditer"),e.value){const Me=Ve=>{if(!e.value||!n.value)return;const ze=p(Ve.latlng);n.value.addLayer(ze),o.value=ze,e.value.off("click",Me),pe("")};e.value.on("click",Me)}break;case"delete":jo("Cliquez sur une forme pour la supprimer"),(ee=e.value)==null||ee.pm.enableGlobalRemovalMode();break;case"TextRectangle":jo("Cliquez et maintenez pour dessiner un rectangle avec texte, relâchez pour terminer"),(oe=e.value)!=null&&oe.pm.globalEditModeEnabled()&&e.value.pm.disableGlobalEditMode(),(Se=e.value)==null||Se.pm.enableDraw("Rectangle",{finishOn:"mouseup",continueDrawing:!1,templineStyle:{color:"#3B82F6",weight:2,dashArray:"5,5"}}),(te=e.value)==null||te.off("pm:create"),(ae=e.value)==null||ae.on("pm:create",Me=>{var Ve,ze,st;if(Me.shape==="Rectangle"&&Me.layer){const Qe=Me.layer.getBounds();let pt=!1;if(n.value&&n.value.eachLayer(wt=>{if(wt instanceof Jl){const Ht=wt.getBounds(),nn=1e-8;Math.abs(Ht.getNorth()-Qe.getNorth())<nn&&Math.abs(Ht.getSouth()-Qe.getSouth())<nn&&Math.abs(Ht.getEast()-Qe.getEast())<nn&&Math.abs(Ht.getWest()-Qe.getWest())<nn&&(pt=!0,o.value=wt,console.log("[TextRectangle] Rectangle existant trouvé, sélection au lieu de création"))}}),!pt){(Ve=e.value)==null||Ve.removeLayer(Me.layer),(ze=n.value)!=null&&ze.hasLayer(Me.layer)&&n.value.removeLayer(Me.layer);const wt=new Jl(Qe,"Double-cliquez pour éditer",{color:"#3B82F6",weight:2,fillColor:"#F9FAFB",fillOpacity:.8,textColor:"#000000",fontFamily:"Arial, sans-serif",textAlign:"center",bold:!1,italic:!1});n.value&&(n.value.addLayer(wt),o.value=wt,wt.updateProperties(),R(wt),console.log("[TextRectangle] Nouveau rectangle créé avec succès",{bounds:wt.getBounds(),properties:wt.properties,style:wt.properties.style}))}(st=e.value)==null||st.pm.disableDraw(),ke()}});break;case"ElevationLine":jo("Cliquez et maintenez pour tracer le profil altimétrique"),(Le=e.value)==null||Le.pm.enableDraw("Line",{finishOn:"mouseup",continueDrawing:!1,allowSelfIntersection:!1,templineStyle:{color:"#FF4500",weight:4,opacity:.8}}),(ye=e.value)==null||ye.pm.setGlobalOptions({continueDrawing:!1,finishOn:"mouseup",preventMarkerRemoval:!0,preventVertexEdit:!0,preventMarkerEdit:!0}),(ue=e.value)==null||ue.off("pm:create"),(Oe=e.value)==null||Oe.on("pm:create",async Me=>{var Ve,ze,st;if(Me.shape==="Line"&&Me.layer){const Qe=Me.layer.getLatLngs();(Ve=e.value)==null||Ve.removeLayer(Me.layer),(ze=n.value)!=null&&ze.hasLayer(Me.layer)&&n.value.removeLayer(Me.layer);const pt=new Ac(Qe,{color:"#FF4500",weight:4,opacity:.8,interactive:!1,pmIgnore:!0});if(n.value){n.value.addLayer(pt),o.value=pt,await pt.updateElevationProfile();const wt=j(pt,"ElevationLine");Object.assign(pt.properties,{...wt,...pt.properties,type:"ElevationLine",elevationData:pt.getElevationData()}),o.value=null,ks(()=>{o.value=pt})}(st=e.value)==null||st.pm.disableDraw(),r.value="",ke()}});break}}catch(De){console.error("[setDrawingTool] Erreur lors de la configuration de l'outil:",De)}},100)}},Ee=B=>{var he;if(!o.value)return;const W=o.value;if(W.properties=W.properties||{},W.properties.style=W.properties.style||{},W.properties.style={...W.properties.style,...B},W.properties.type==="text"){const ne=W.properties._textLayer,re=(he=ne==null?void 0:ne.getElement())==null?void 0:he.querySelector(".text-annotation");re&&Sy(re,W.properties.style);const ee={color:B.borderColor||W.properties.style.borderColor,weight:parseInt(B.borderWidth||W.properties.style.borderWidth),opacity:B.borderOpacity??W.properties.style.borderOpacity};"setStyle"in W&&W.setStyle(ee)}else if(W.properties.type==="TextRectangle"){if(W instanceof Jl){console.log("[updateShapeStyle] Processing TextRectangle style update",{incoming:B,currentStyle:W.properties.style,hasTextStyle:!!W.properties.style.textStyle,textStyleIncoming:B.textStyle});let ne={};B.textStyle?(console.log("[updateShapeStyle] Using nested textStyle object",B.textStyle),ne={...B.textStyle}):(B.textColor!==void 0&&(ne.color=B.textColor),B.fontSize!==void 0&&(ne.fontSize=B.fontSize,console.log(`[updateShapeStyle] Setting fontSize to ${B.fontSize}`)),B.fontFamily!==void 0&&(ne.fontFamily=B.fontFamily),B.backgroundColor!==void 0&&(ne.backgroundColor=B.backgroundColor),B.backgroundOpacity!==void 0&&(ne.backgroundOpacity=B.backgroundOpacity),B.textAlign!==void 0&&(ne.textAlign=B.textAlign),B.bold!==void 0&&(ne.bold=B.bold),B.italic!==void 0&&(ne.italic=B.italic)),B.fillColor&&(ne.fillColor=B.fillColor),B.fillOpacity!==void 0&&(ne.fillOpacity=B.fillOpacity),B.strokeColor&&(ne.color=B.strokeColor),B.color&&(ne.color=B.color),B.strokeOpacity!==void 0&&(ne.opacity=B.strokeOpacity),B.strokeWidth!==void 0&&(ne.weight=B.strokeWidth),B.weight!==void 0&&(ne.weight=B.weight),B.dashArray&&(ne.dashArray=B.dashArray),console.log("[updateShapeStyle] Final textStyles being applied:",ne),W.setTextStyle(ne)}}else{const ne={};B.fillColor&&(ne.fillColor=B.fillColor),B.fillOpacity!==void 0&&(ne.fillOpacity=B.fillOpacity),B.strokeColor&&(ne.color=B.strokeColor),B.strokeOpacity!==void 0&&(ne.opacity=B.strokeOpacity),B.strokeWidth!==void 0&&(ne.weight=B.strokeWidth),B.dashArray&&(ne.dashArray=B.dashArray),"setStyle"in W&&W.setStyle(ne)}},Ie=B=>{var he,ne,re,ee;if(!o.value){console.warn("[useMapDrawing] Cannot update properties: no shape selected");return}if(console.log("[useMapDrawing] Updating shape properties",{before:o.value.properties,newProps:B,layerType:(he=o.value.properties)==null?void 0:he.type,beforeName:o.value.name,beforePropertiesName:(ne=o.value.properties)==null?void 0:ne.name,nameIsDirectProperty:"name"in o.value}),o.value.properties&&Object.keys(B).forEach(oe=>{o.value.properties[oe]=B[oe],oe==="name"&&(console.log(`[useMapDrawing] Setting name "${B[oe]}" directly on layer`),o.value.name=B[oe])}),console.log("[useMapDrawing] Updated shape properties",{after:o.value.properties,name:o.value.name,propertiesName:(re=o.value.properties)==null?void 0:re.name,allLayerKeys:Object.keys(o.value),allPropertiesKeys:Object.keys(o.value.properties||{})}),((ee=o.value.properties)==null?void 0:ee.type)==="Circle"){const oe=o.value,Se=oe.getRadius();oe.properties.radius=Se,oe.properties.diameter=Se*2,oe.properties.surface=Math.PI*Se*Se,oe.properties.perimeter=2*Math.PI*Se,B.name&&(console.log(`[useMapDrawing] Ensuring circle name "${B.name}" is set in multiple places`),oe.properties.name=B.name,oe.properties.style.name=B.name,oe.name=B.name,console.log("[useMapDrawing] Circle name verification:",{circleDirectName:oe.name,circlePropertiesName:oe.properties.name,nameIsEnumerable:Object.keys(oe).includes("name"),propertiesNameIsEnumerable:Object.keys(oe.properties).includes("name")}))}const W=new CustomEvent("shape:propertiesUpdated",{detail:{shape:o.value,properties:o.value.properties}});window.dispatchEvent(W)},nt=B=>{console.log("[forceShapeUpdate] Début",{currentProperties:B.properties,selectedShapeRef:o.value}),o.value=null,ks(()=>{o.value=B,console.log("[forceShapeUpdate] Après mise à jour",{selectedShape:o.value,properties:o.value.properties})})},We=(B,W)=>{console.log("[updateLayerProperties] Début",{layer:B,shapeType:W,currentProperties:B.properties}),y8((ne,re)=>{const ee=j(ne,re);console.log("[updateLayerProperties] Nouvelles propriétés calculées",{newProperties:ee}),ne.properties={...ee},nt(ne),ne.fire("properties:updated",{shape:ne,properties:ne.properties}),console.log("[updateLayerProperties] Fin",{finalProperties:ne.properties,selectedShape:o.value})},100)(B,W)},O=(B,W)=>St.latLng((B.lat+W.lat)/2,(B.lng+W.lng)/2),H=B=>{var Se;if(!e.value||!n.value)return;b();const W=B.getLatLng(),he=B.getRadius(),ne=B instanceof bc||((Se=B.properties)==null?void 0:Se.type)==="CircleWithSections",re=D(W,"#059669");E.push(re),w(re,B,()=>[tr(he,"m","Rayon"),tr(he*2,"m","Diamètre"),tr(Math.PI*Math.pow(he,2),"m²","Surface")].join("<br>"));const ee=[],oe=[0,45,90,135,180,225,270,315];oe.forEach(te=>{const ae=B.calculatePointOnCircle(te),Le=D(ae,"#2563EB");ee.push(Le),E.push(Le),w(Le,B,()=>tr(he,"m","Rayon")),Le.on("mousedown",ye=>{if(!e.value)return;St.DomEvent.stopPropagation(ye),e.value.dragging.disable();let ue=!0;ne&&B._clearSections();const Oe=Me=>{ue&&(B.resizeFromControlPoint(Me.latlng),ee.forEach((Ve,ze)=>{const st=B.calculatePointOnCircle(oe[ze]);Ve.setLatLng(st)}),re.setLatLng(B.getLatLng()),Le.measureDiv&&(Le.measureDiv.innerHTML=tr(B.getRadius(),"m","Rayon")))},De=()=>{ue=!1,e.value&&(e.value.off("mousemove",Oe),document.removeEventListener("mouseup",De),e.value.dragging.enable(),B.updateProperties(),ne&&B._initSections&&setTimeout(()=>{B._initSections()},100),o.value=null,ks(()=>{o.value=B}),We(B,"Circle"))};e.value.on("mousemove",Oe),document.addEventListener("mouseup",De)})}),re.on("mousedown",te=>{if(!e.value)return;St.DomEvent.stopPropagation(te),e.value.dragging.disable();let ae=!0;const Le=B.getLatLng(),ye=te.latlng;ne&&B._clearSections();const ue=De=>{if(!ae)return;const Me=De.latlng.lng-ye.lng,Ve=De.latlng.lat-ye.lat,ze=St.latLng(Le.lat+Ve,Le.lng+Me);St.Circle.prototype.setLatLng.call(B,ze),re.setLatLng(ze),ee.forEach((st,Qe)=>{const pt=B.calculatePointOnCircle(oe[Qe]);st.setLatLng(pt)}),re.measureDiv&&(re.measureDiv.innerHTML=[tr(B.getRadius(),"m","Rayon"),tr(B.getRadius()*2,"m","Diamètre"),tr(Math.PI*Math.pow(B.getRadius(),2),"m²","Surface")].join("<br>"))},Oe=()=>{ae=!1,e.value&&(e.value.off("mousemove",ue),document.removeEventListener("mouseup",Oe),e.value.dragging.enable(),B.updateProperties(),ne&&B._initSections&&setTimeout(()=>{B._initSections()},100),o.value=null,ks(()=>{o.value=B}),We(B,"Circle"))};e.value.on("mousemove",ue),document.addEventListener("mouseup",Oe)}),B.on("circle:resized",()=>{We(B,"Circle")}),o.value=B},le=B=>{var Le;if(!e.value||!n.value)return;if(!(B instanceof Uo)){console.warn("La couche n'est pas une instance de Rectangle");return}const W=B;b();const he=W.getCenter(),ne=W.getRotatedCorners(),re=W.getMidPoints(),ee=D(he,"#059669");E.push(ee),w(ee,W,()=>{const{width:ye,height:ue}=W.getDimensions(),Oe=ye*ue,De=W.getRotation();return[tr(ye,"m","Largeur"),tr(ue,"m","Hauteur"),tr(Oe,"m²","Surface"),`Rotation: ${De.toFixed(1)}°`].join("<br>")});const oe=D(St.latLng(he.lat+(ne[0].lat-he.lat)*1.2,he.lng+(ne[0].lng-he.lng)*1.2),"#F97316");E.push(oe);const Se=St.polyline([he,oe.getLatLng()],{color:"#F97316",weight:1,opacity:.6,dashArray:"4",pmIgnore:!0});(Le=t.value)==null||Le.addLayer(Se);const te=ne.map(ye=>{const ue=D(ye,"#DC2626");return E.push(ue),w(ue,W,()=>{const{width:Oe,height:De}=W.getDimensions();return[tr(Oe,"m","Largeur"),tr(De,"m","Hauteur")].join("<br>")}),ue}),ae=re.map((ye,ue)=>{const Oe=D(ye,"#2563EB");return E.push(Oe),w(Oe,W,()=>{const{width:De,height:Me}=W.getDimensions(),Ve=ue%2===0?De:Me;return[tr(Ve,"m","Longueur du côté"),tr(Ve/2,"m","Distance au coin")].join("<br>")}),Oe});ee.on("mousedown",ye=>{if(!e.value)return;St.DomEvent.stopPropagation(ye),e.value.dragging.disable();let ue=!0;const Oe=Me=>{if(!ue)return;W.moveFromCenter(Me.latlng);const Ve=W.getRotatedCorners(),ze=W.getMidPoints();te.forEach((Qe,pt)=>Qe.setLatLng(Ve[pt])),ae.forEach((Qe,pt)=>Qe.setLatLng(ze[pt])),ee.setLatLng(Me.latlng);const st=St.latLng(Me.latlng.lat+(Ve[0].lat-Me.latlng.lat)*1.2,Me.latlng.lng+(Ve[0].lng-Me.latlng.lng)*1.2);oe.setLatLng(st),Se.setLatLngs([Me.latlng,st])},De=()=>{ue=!1,e.value&&(e.value.off("mousemove",Oe),document.removeEventListener("mouseup",De),e.value.dragging.enable(),W.updateProperties(),o.value=null,ks(()=>{o.value=W}))};e.value.on("mousemove",Oe),document.addEventListener("mouseup",De)}),oe.on("mousedown",ye=>{if(!e.value)return;St.DomEvent.stopPropagation(ye),e.value.dragging.disable();let ue=!1;const Oe=ye.latlng,De=W.getRotation(),Me=W.getCenter(),Ve=Oe.lng-Me.lng,ze=Oe.lat-Me.lat,st=Math.atan2(ze,Ve)*180/Math.PI;E.forEach(wt=>{wt!==oe&&(wt.setStyle({opacity:0,fillOpacity:0}),wt.measureDiv&&(wt.measureDiv.style.display="none"))});const Qe=Wu(wt=>{ue||(ue=!0);const Ht=wt.latlng.lng-Me.lng,nn=wt.latlng.lat-Me.lat;let Qt=Math.atan2(nn,Ht)*180/Math.PI-st,rn=(De+Qt)%360;rn<0&&(rn+=360),W.setRotation(rn,!1),oe.setLatLng(wt.latlng),Se.setLatLngs([Me,wt.latlng])},16),pt=()=>{e.value&&(e.value.off("mousemove",Qe),document.removeEventListener("mouseup",pt),e.value.dragging.enable(),ue&&W.finalizeRotation(),o.value=null,ks(()=>{o.value=W,b(),le(W)}))};e.value.on("mousemove",Qe),document.addEventListener("mouseup",pt)}),W.on("coordinates:updated",ye=>{const{corners:ue,center:Oe}=ye,De=W.getMidPoints();te.forEach((Ve,ze)=>Ve.setLatLng(ue[ze])),ae.forEach((Ve,ze)=>Ve.setLatLng(De[ze])),ee.setLatLng(Oe);const Me=St.latLng(Oe.lat+(ue[0].lat-Oe.lat)*1.2,Oe.lng+(ue[0].lng-Oe.lng)*1.2);oe.setLatLng(Me),Se.setLatLngs([Oe,Me])})},G=B=>{if(!e.value||!n.value)return;b();const W=B.getLatLngs();if(!W||W.length===0){console.warn("Pas de points pour la ligne");return}let he=null;if(B instanceof $o){const ne=B.getCenter();he=D(ne,"#059669"),E.push(he),w(he,B,()=>{const re=B.getLength()||0;return tr(re,"m","Longueur totale")}),he.on("mousedown",re=>{if(!e.value)return;St.DomEvent.stopPropagation(re),e.value.dragging.disable();let ee=!0;const oe=B.getLatLngs().map(ye=>St.latLng(ye.lat,ye.lng)),Se=re.latlng;B instanceof $o&&(B.off("move:end"),B.off("vertex:moved"),B.off("latlngs:updated"),B.off("properties:updated")),E.forEach((ye,ue)=>{ue>0&&(ye.setStyle({opacity:0,fillOpacity:0}),ye.measureDiv&&(ye.measureDiv.style.display="none"))});const ae=Wu(ye=>{if(!ee)return;const ue=ye.latlng.lng-Se.lng,Oe=ye.latlng.lat-Se.lat,De=oe.map(Me=>St.latLng(Me.lat+Oe,Me.lng+ue));St.Polyline.prototype.setLatLngs.call(B,De),he==null||he.setLatLng(ye.latlng)},16),Le=()=>{if(ee=!1,!!e.value){if(e.value.off("mousemove",ae),document.removeEventListener("mouseup",Le),e.value.dragging.enable(),B instanceof $o){const ye=()=>{b(),G(B)};B.on("move:end",ye),B.on("vertex:moved",ye),B.on("latlngs:updated",ye),B.on("properties:updated",ye),B.updateProperties(),We(B,"Line")}b(),G(B)}};e.value.on("mousemove",ae),document.addEventListener("mouseup",Le)})}if(W.forEach((ne,re)=>{const ee=D(ne,"#DC2626");E.push(ee),w(ee,B,()=>{if(B instanceof $o){const oe=B.getLength()||0,Se=B.getLengthToVertex(re);return[tr(Se,"m","Distance depuis le début"),tr(oe,"m","Longueur totale")].join("<br>")}return""}),ee.on("mousedown",oe=>{if(!e.value)return;St.DomEvent.stopPropagation(oe),e.value.dragging.disable();let Se=!0;B instanceof $o&&(B.off("move:end"),B.off("vertex:moved"),B.off("latlngs:updated"),B.off("properties:updated")),E.forEach((Le,ye)=>{ye!==re+1&&(Le.setStyle({opacity:0,fillOpacity:0}),Le.measureDiv&&(Le.measureDiv.style.display="none"))});const te=Wu(Le=>{if(!Se)return;const ye=B.getLatLngs();ye[re]=Le.latlng,St.Polyline.prototype.setLatLngs.call(B,ye),ee.setLatLng(Le.latlng)},16),ae=()=>{if(Se=!1,!!e.value){if(e.value.off("mousemove",te),document.removeEventListener("mouseup",ae),e.value.dragging.enable(),B instanceof $o){const Le=()=>{b(),G(B)};B.on("move:end",Le),B.on("vertex:moved",Le),B.on("latlngs:updated",Le),B.on("properties:updated",Le),B.updateProperties(),We(B,"Line")}b(),G(B)}};e.value.on("mousemove",te),document.addEventListener("mouseup",ae)})}),W.length>=2)for(let ne=0;ne<W.length-1;ne++){const re=W[ne],ee=W[ne+1],oe=St.latLng((re.lat+ee.lat)/2,(re.lng+ee.lng)/2),Se=D(oe,"#2563EB");E.push(Se),w(Se,B,()=>{if(B instanceof $o){const te=B.getSegmentLengthAt(ne),ae=B.getLength()||0,Le=B.getLengthToVertex(ne)+te/2;return[tr(te,"m","Longueur du segment"),tr(te/2,"m","Demi-segment"),tr(Le,"m","Distance depuis le début"),tr(ae,"m","Longueur totale")].join("<br>")}return""})}if(B instanceof $o){const ne=()=>{b(),G(B)};B.on("move:start",()=>{E.forEach((re,ee)=>{ee>0&&(re.setStyle({opacity:0,fillOpacity:0}),re.measureDiv&&(re.measureDiv.style.display="none"))})}),B.on("move:end",ne),B.on("vertex:moved",ne),B.on("latlngs:updated",ne),B.on("properties:updated",ne),E.cleanup=()=>{B.off("move:start",()=>{}),B.off("move:end",ne),B.off("vertex:moved",ne),B.off("latlngs:updated",ne),B.off("properties:updated",ne)}}},I=B=>{if(!e.value||!n.value)return;b();const W=B.getLatLngs()[0],he=W.map(ae=>[ae.lng,ae.lat]);he.push(he[0]);const ne=El([he]),re=vu(ne),ee=W.reduce((ae,Le,ye)=>{const ue=W[(ye+1)%W.length];return ae+Le.distanceTo(ue)},0);let oe;if(typeof B.getCenter=="function")try{oe=B.getCenter()}catch(ae){console.warn("Erreur lors de la récupération du centre du polygone via getCenter(), utilisation de la méthode alternative",ae);const Le=Df(ne);oe=St.latLng(Le.geometry.coordinates[1],Le.geometry.coordinates[0])}else{const ae=Df(ne);oe=St.latLng(ae.geometry.coordinates[1],ae.geometry.coordinates[0])}const Se=D(oe,"#059669");E.push(Se),w(Se,B,()=>[tr(ee,"m","Périmètre"),tr(re,"m²","Surface")].join("<br>")),Se.on("mousedown",ae=>{if(!e.value)return;St.DomEvent.stopPropagation(ae),e.value.dragging.disable();let Le=!0;const ye=ae.latlng,ue=[...W];E.forEach((Ve,ze)=>{ze>0&&Ve.setStyle({opacity:0,fillOpacity:0})});const Oe=Wu(Ve=>{if(!Le)return;const ze=Ve.latlng.lng-ye.lng,st=Ve.latlng.lat-ye.lat,Qe=ue.map(pt=>St.latLng(pt.lat+st,pt.lng+ze));St.Polygon.prototype.setLatLngs.call(B,[Qe]),Se.setLatLng(Ve.latlng)},16),De=Ve=>{Le&&Oe(Ve)},Me=()=>{if(Le=!1,!!e.value){if(e.value.off("mousemove",De),document.removeEventListener("mouseup",Me),e.value.dragging.enable(),B.properties){const Ve=B.getLatLngs()[0],ze=Ve.map(Qe=>[Qe.lng,Qe.lat]);ze.push(ze[0]);const st=El([ze]);B.properties.area=vu(st),B.properties.perimeter=Ve.reduce((Qe,pt,wt)=>{const Ht=Ve[(wt+1)%Ve.length];return Qe+pt.distanceTo(Ht)},0),B.properties.surface=B.properties.area}b(),I(B),o.value=null,ks(()=>{o.value=B})}};e.value.on("mousemove",De),document.addEventListener("mouseup",Me)}),W.forEach((ae,Le)=>{const ye=D(ae,"#DC2626");E.push(ye),w(ye,B,()=>{const ue=W[(Le-1+W.length)%W.length],Oe=W[(Le+1)%W.length],De=ae.distanceTo(ue),Me=ae.distanceTo(Oe);return[tr(De,"m","Distance au point précédent"),tr(Me,"m","Distance au point suivant"),tr(ee,"m","Périmètre total"),tr(re,"m²","Surface")].join("<br>")}),ye.on("mousedown",ue=>{if(St.DomEvent.stopPropagation(ue),!e.value)return;e.value.dragging.disable();let Oe=!0;Se&&(Se.setStyle({opacity:0,fillOpacity:0}),Se.measureDiv&&(Se.measureDiv.style.display="none"));const De=Wu(ze=>{if(!Oe)return;W[Le]=ze.latlng,St.Polygon.prototype.setLatLngs.call(B,[W]),ye.setLatLng(ze.latlng);const st=E.slice(W.length+1),Qe=(Le-1+W.length)%W.length,pt=st[Qe];if(pt){const Ht=W[Qe],nn=W[Le],tt=St.latLng((Ht.lat+nn.lat)/2,(Ht.lng+nn.lng)/2);pt.setLatLng(tt)}const wt=st[Le];if(wt){const Ht=W[Le],nn=W[(Le+1)%W.length],tt=St.latLng((Ht.lat+nn.lat)/2,(Ht.lng+nn.lng)/2);wt.setLatLng(tt)}},16),Me=ze=>{Oe&&De(ze)},Ve=()=>{if(Oe=!1,!!e.value){if(e.value.off("mousemove",Me),document.removeEventListener("mouseup",Ve),e.value.dragging.enable(),B.properties){const ze=B.getLatLngs()[0].map(Qe=>[Qe.lng,Qe.lat]);ze.push(ze[0]);const st=El([ze]);B.properties.area=vu(st),B.properties.perimeter=W.reduce((Qe,pt,wt)=>{const Ht=W[(wt+1)%W.length];return Qe+pt.distanceTo(Ht)},0),B.properties.surface=B.properties.area}b(),I(B),o.value=null,ks(()=>{o.value=B})}};e.value.on("mousemove",Me),document.addEventListener("mouseup",Ve)})}),(()=>{const ae=B.getLatLngs()[0];E.slice(ae.length+1).forEach(ye=>{t.value&&t.value.removeLayer(ye)}),E=E.slice(0,ae.length+1);const Le=new Array(ae.length);for(let ye=0;ye<ae.length;ye++){const ue=ae[ye],Oe=ae[(ye+1)%ae.length];Le[ye]=O(ue,Oe)}Le.forEach((ye,ue)=>{const Oe=D(ye,"#2563EB");E.push(Oe),w(Oe,B,()=>{const De=ae[ue],Me=ae[(ue+1)%ae.length],Ve=De.distanceTo(Me);return[tr(Ve,"m","Longueur du segment"),tr(ee,"m","Périmètre total"),tr(re,"m²","Surface")].join("<br>")}),Oe.on("mousedown",De=>{if(!e.value)return;St.DomEvent.stopPropagation(De),e.value.dragging.disable();let Me=!0;const Ve=ue;Se&&(Se.setStyle({opacity:0,fillOpacity:0}),Se.measureDiv&&(Se.measureDiv.style.display="none"));const ze=[...B.getLatLngs()[0]];ze.splice((Ve+1)%ze.length,0,ye),B.setLatLngs([ze]),b(),I(B);const st=Ve+1,Qe=1+st,pt=st<E.length-1?E[Qe]:null;if(pt){const wt=nn=>{if(!Me)return;const tt=B.getLatLngs()[0];tt[st]=nn.latlng,B.setLatLngs([tt]),pt.setLatLng(nn.latlng);const Qt=E.slice(1+tt.length),rn=(st-1+tt.length)%tt.length,it=st;if(Qt[rn]){const Ke=tt[rn],qt=tt[st],mn=St.latLng((Ke.lat+qt.lat)/2,(Ke.lng+qt.lng)/2);Qt[rn].setLatLng(mn)}if(Qt[it]){const Ke=tt[st],qt=tt[(st+1)%tt.length],mn=St.latLng((Ke.lat+qt.lat)/2,(Ke.lng+qt.lng)/2);Qt[it].setLatLng(mn)}},Ht=()=>{if(Me=!1,!!e.value){if(e.value.off("mousemove",wt),document.removeEventListener("mouseup",Ht),e.value.dragging.enable(),B.properties){const nn=B.getLatLngs()[0].map(Qt=>[Qt.lng,Qt.lat]);nn.push(nn[0]);const tt=El([nn]);B.properties.area=vu(tt),B.properties.perimeter=B.getLatLngs()[0].reduce((Qt,rn,it,Ke)=>{const qt=Ke[(it+1)%Ke.length];return Qt+rn.distanceTo(qt)},0)}b(),I(B),o.value=null,ks(()=>{o.value=B})}};e.value.on("mousemove",wt),document.addEventListener("mouseup",Ht)}else e.value.dragging.enable(),b(),I(B)})})})()},Y=B=>{if(!e.value||!n.value)return;b();const W=B.getCenter(),he=B.getStartAngle(),ne=B.getStopAngle(),re=B.getOpeningAngle(),ee=B.calculatePointOnArc(he),oe=B.calculatePointOnArc(ne),Se=D(ee,"#DC2626"),te=D(oe,"#DC2626");E.push(Se,te);const ae=D(W,"#059669");E.push(ae);let Le=null;if(re>5){const ye=B.calculateMidpointPosition();Le=D(ye,"#2563EB"),E.push(Le),Le.on("mousedown",ue=>{if(!e.value||!Le)return;St.DomEvent.stopPropagation(ue),e.value.dragging.disable();let Oe=!0;const De=Ve=>{if(!Oe||!Le)return;const ze=W.distanceTo(Ve.latlng);B.setRadius(ze);const st=B.calculatePointOnArc(he),Qe=B.calculatePointOnArc(ne),pt=B.calculateMidpointPosition();Se.setLatLng(st),te.setLatLng(Qe),Le.setLatLng(pt),B.updateProperties();const wt=Le;wt!=null&&wt.measureDiv&&(wt.measureDiv.innerHTML=tr(ze,"m","Rayon"))},Me=()=>{Oe=!1,e.value&&(e.value.off("mousemove",De),document.removeEventListener("mouseup",Me),e.value.dragging.enable(),B.updateProperties(),o.value=null,ks(()=>{o.value=B}),We(B,"Semicircle"))};e.value.on("mousemove",De),document.addEventListener("mouseup",Me)})}[Se,te].forEach((ye,ue)=>{ye.on("mousedown",Oe=>{if(!e.value)return;St.DomEvent.stopPropagation(Oe),e.value.dragging.disable();let De=!0;const Me=ze=>{if(!De||!e.value)return;const st=ze.latlng.lng-W.lng,Qe=ze.latlng.lat-W.lat,pt=B.getRadius(),wt=Math.sqrt(st*st+Qe*Qe),Ht=pt/(wt*111319.9*Math.cos(W.lat*Math.PI/180)),nn=W.lng+st*Ht,tt=W.lat+Qe*Ht,Qt=(Math.atan2(tt-W.lat,nn-W.lng)*180/Math.PI+360)%360;ue===0?B.setAngles(Qt,B.getStopAngle()):B.setAngles(B.getStartAngle(),Qt);const rn=B.getStartAngle(),it=B.getStopAngle(),Ke=B.getOpeningAngle(),qt=B.calculatePointOnArc(rn),mn=B.calculatePointOnArc(it);if(Se.setLatLng(qt),te.setLatLng(mn),Le&&Ke>5){const xn=B.calculateMidpointPosition();Le.setLatLng(xn),Le.setStyle({opacity:1,fillOpacity:1})}else Le&&Le.setStyle({opacity:0,fillOpacity:0});B.updateProperties(),o.value=B},Ve=()=>{De=!1,e.value&&(e.value.off("mousemove",Me),document.removeEventListener("mouseup",Ve),e.value.dragging.enable(),B.updateProperties(),o.value=null,ks(()=>{o.value=B}),We(B,"Semicircle"),Y(B))};e.value.on("mousemove",Me),document.addEventListener("mouseup",Ve)})}),ae.on("mousedown",ye=>{if(!e.value)return;St.DomEvent.stopPropagation(ye),e.value.dragging.disable();let ue=!0;const Oe=Me=>{if(!ue)return;B.setCenter(Me.latlng),ae.setLatLng(Me.latlng);const Ve=B.getStartAngle(),ze=B.getStopAngle(),st=B.getOpeningAngle(),Qe=B.calculatePointOnArc(Ve),pt=B.calculatePointOnArc(ze);if(Se.setLatLng(Qe),te.setLatLng(pt),Le&&st>5){const wt=B.calculateMidpointPosition();Le.setLatLng(wt),Le.setStyle({opacity:1,fillOpacity:1})}else Le&&Le.setStyle({opacity:0,fillOpacity:0});B.updateProperties(),o.value=B},De=()=>{ue=!1,e.value&&(e.value.off("mousemove",Oe),document.removeEventListener("mouseup",De),e.value.dragging.enable(),B.updateProperties(),o.value=null,ks(()=>{o.value=B}),We(B,"Semicircle"))};e.value.on("mousemove",Oe),document.addEventListener("mouseup",De)})},$=B=>{var W;if(!(!e.value||!i.value)){console.log("[generateTempControlPoints] Génération des points temporaires pour",{layerType:B.constructor.name,properties:B.properties}),i.value.clearLayers();try{if(B instanceof Jl){const he=(W=B.getBounds)==null?void 0:W.call(B).getCenter();if(he){const ne=St.circleMarker(he,{radius:0,className:"text-hint-marker",pmIgnore:!0});i.value.addLayer(ne)}}else if(B instanceof Uo)B.generateHelperPoints(e.value);else if(B instanceof Xc||B instanceof Lu||B instanceof bc){if("getLatLng"in B&&typeof B.getLatLng=="function"){const he=B.getLatLng();if(he){const ne=St.circleMarker(he,{radius:5,color:"#059669",fillColor:"#059669",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});i.value.addLayer(ne)}}}else if(B instanceof Rf||B instanceof St.Polygon){let he=[];if("getLatLngs"in B){const re=B.getLatLngs();if(Array.isArray(re)&&re.length>0){const ee=re[0];Array.isArray(ee)?he=ee:ee instanceof St.LatLng&&(he=re)}}let ne=null;if(B instanceof Rf&&typeof B.getCenter=="function")ne=B.getCenter();else if(he.length>0){const re=he.map(Se=>[Se.lng,Se.lat]);re.push(re[0]);const ee=El([re]),oe=Df(ee);ne=St.latLng(oe.geometry.coordinates[1],oe.geometry.coordinates[0])}if(ne){const re=St.circleMarker(ne,{radius:5,color:"#059669",fillColor:"#059669",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});i.value.addLayer(re)}he.forEach(re=>{if(re){const ee=St.circleMarker(re,{radius:5,color:"#DC2626",fillColor:"#DC2626",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});i.value.addLayer(ee)}});for(let re=0;re<he.length;re++){const ee=he[re],oe=he[(re+1)%he.length];if(ee&&oe){const Se=St.latLng((ee.lat+oe.lat)/2,(ee.lng+oe.lng)/2),te=St.circleMarker(Se,{radius:5,color:"#2563EB",fillColor:"#2563EB",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});i.value.addLayer(te)}}}console.log("[generateTempControlPoints] Points temporaires générés",{count:i.value.getLayers().length})}catch(he){console.error("[generateTempControlPoints] Erreur lors de la génération des points temporaires:",he)}}},R=B=>{if(!e.value||!n.value||!B.getBounds)return;const W=B;b(),W.on("edit:start",()=>{b()}),W.on("edit:end",()=>{R(W)});const he=W.getBounds(),ne=he.getCenter(),re=W.properties.rotation||0,ee=ue=>{if(re===0)return ue;const Oe=re*Math.PI/180,De=Math.cos(Oe),Me=Math.sin(Oe),Ve=ue.lng-ne.lng,ze=ue.lat-ne.lat,st=Ve*De-ze*Me,Qe=Ve*Me+ze*De;return St.latLng(ne.lat+Qe,ne.lng+st)},oe=[he.getNorthWest(),he.getNorthEast(),he.getSouthEast(),he.getSouthWest()].map(ue=>ee(ue)),Se=W.getMidPoints().map(ue=>ee(ue)),te=D(ne,"#059669");te.addTo(e.value),E.push(te),w(te,W,()=>{const{width:ue,height:Oe}=W.getDimensions(),De=ue*Oe;return[tr(ue,"m","Largeur"),tr(Oe,"m","Hauteur"),tr(De,"m²","Surface"),`Rotation: ${re.toFixed(1)}°`].join("<br>")});const ae=oe.map((ue,Oe)=>{const De=D(ue,"#DC2626");return De.addTo(e.value),E.push(De),w(De,W,()=>{const{width:Me,height:Ve}=W.getDimensions();return[tr(Me,"m","Largeur"),tr(Ve,"m","Hauteur")].join("<br>")}),De.on("mousedown",Me=>{if(!e.value)return;St.DomEvent.stopPropagation(Me),e.value.dragging.disable();const Ve=(Oe+2)%4,ze=oe[Ve];W.startResize();const st=Wu(wt=>{const Ht=St.latLngBounds(ze,wt.latlng);W.updateResizePreview(Ht)},16),Qe=wt=>st(wt),pt=()=>{if(!e.value)return;e.value.off("mousemove",Qe),document.removeEventListener("mouseup",pt),e.value.dragging.enable();const wt=St.latLngBounds(ze,De.getLatLng());W.endResize(wt),o.value=null,ks(()=>{o.value=W})};e.value.on("mousemove",Qe),document.addEventListener("mouseup",pt)}),De}),Le=Se.map((ue,Oe)=>{const De=D(ue,"#2563EB");return De.addTo(e.value),E.push(De),w(De,W,()=>{const{width:Me,height:Ve}=W.getDimensions(),ze=Oe%2===0?Me:Ve;return[tr(ze,"m","Longueur du côté"),tr(ze/2,"m","Distance au coin"),`Rotation: ${re.toFixed(1)}°`].join("<br>")}),De.on("mousedown",Me=>{if(!e.value)return;St.DomEvent.stopPropagation(Me),e.value.dragging.disable(),W.startResize();const Ve=Wu(Qe=>{const pt=W.getBounds();let wt;switch(Oe){case 0:wt=St.latLngBounds(St.latLng(Qe.latlng.lat,pt.getWest()),St.latLng(pt.getSouth(),pt.getEast()));break;case 1:wt=St.latLngBounds(St.latLng(pt.getNorth(),pt.getWest()),St.latLng(pt.getSouth(),Qe.latlng.lng));break;case 2:wt=St.latLngBounds(St.latLng(pt.getNorth(),pt.getWest()),St.latLng(Qe.latlng.lat,pt.getEast()));break;case 3:wt=St.latLngBounds(St.latLng(pt.getNorth(),Qe.latlng.lng),St.latLng(pt.getSouth(),pt.getEast()));break;default:return}W.updateResizePreview(wt)},16),ze=Qe=>Ve(Qe),st=()=>{if(!e.value)return;e.value.off("mousemove",ze),document.removeEventListener("mouseup",st),e.value.dragging.enable();const Qe=W.getBounds();let pt;switch(Oe){case 0:pt=St.latLngBounds(St.latLng(De.getLatLng().lat,Qe.getWest()),St.latLng(Qe.getSouth(),Qe.getEast()));break;case 1:pt=St.latLngBounds(St.latLng(Qe.getNorth(),Qe.getWest()),St.latLng(Qe.getSouth(),De.getLatLng().lng));break;case 2:pt=St.latLngBounds(St.latLng(Qe.getNorth(),Qe.getWest()),St.latLng(De.getLatLng().lat,Qe.getEast()));break;case 3:pt=St.latLngBounds(St.latLng(Qe.getNorth(),De.getLatLng().lng),St.latLng(Qe.getSouth(),Qe.getEast()));break;default:return}W.endResize(pt),o.value=null,ks(()=>{o.value=W})};e.value.on("mousemove",ze),document.addEventListener("mouseup",st)}),De});te.on("mousedown",ue=>{if(!e.value)return;St.DomEvent.stopPropagation(ue),e.value.dragging.disable();const Oe=W.getBounds().getCenter(),De=ue.latlng;W.startResize();const Me=Wu(st=>{const Qe=st.latlng.lng-De.lng,pt=st.latlng.lat-De.lat,wt=St.latLng(Oe.lat+pt,Oe.lng+Qe),Ht=W.getBounds(),nn=Ht.getEast()-Ht.getWest(),tt=Ht.getNorth()-Ht.getSouth(),Qt=St.latLngBounds(St.latLng(wt.lat-tt/2,wt.lng-nn/2),St.latLng(wt.lat+tt/2,wt.lng+nn/2));W.updateResizePreview(Qt)},16),Ve=st=>Me(st),ze=()=>{if(!e.value)return;e.value.off("mousemove",Ve),document.removeEventListener("mouseup",ze),e.value.dragging.enable();const st=W.getBounds(),Qe=st.getEast()-st.getWest(),pt=st.getNorth()-st.getSouth(),wt=te.getLatLng(),Ht=St.latLngBounds(St.latLng(wt.lat-pt/2,wt.lng-Qe/2),St.latLng(wt.lat+pt/2,wt.lng+Qe/2));W.endResize(Ht),o.value=null,ks(()=>{o.value=W})};e.value.on("mousemove",Ve),document.addEventListener("mouseup",ze)}),W.on("resize:update",ue=>{const Oe=ue.bounds,De=Oe.getCenter(),Me=[Oe.getNorthWest(),Oe.getNorthEast(),Oe.getSouthEast(),Oe.getSouthWest()].map(ze=>ee(ze));ae.forEach((ze,st)=>{ze.setLatLng(Me[st])}),te.setLatLng(De);const Ve=[St.latLng((Me[0].lat+Me[1].lat)/2,(Me[0].lng+Me[1].lng)/2),St.latLng((Me[1].lat+Me[2].lat)/2,(Me[1].lng+Me[2].lng)/2),St.latLng((Me[2].lat+Me[3].lat)/2,(Me[2].lng+Me[3].lng)/2),St.latLng((Me[3].lat+Me[0].lat)/2,(Me[3].lng+Me[0].lng)/2)].map(ze=>ee(ze));Le.forEach((ze,st)=>{ze.setLatLng(Ve[st])})});const ye=()=>{W.off("edit:start"),W.off("edit:end"),W.off("resize:update")};E.cleanup=ye},Z=B=>{console.log("Nombre total de couches:",B.length);const W=B.filter(oe=>{var ae;if(!oe)return!1;let Se=0,te={width:0,height:0};if(oe instanceof St.Circle){Se=Math.PI*Math.pow(oe.getRadius(),2);const Le=oe.getRadius();console.log(`
Forme détectée: Circle`),console.log(`- Surface propre: ${Se.toFixed(2)} m²`),console.log(`- Rayon: ${Le.toFixed(2)} m`),console.log("- Angle: Cercle complet (360°)")}else if(oe instanceof Uo||oe instanceof St.Rectangle){const Le=oe.getBounds(),ye=Le.getSouthWest(),ue=Le.getNorthEast(),Oe=Al([[ye.lng,ye.lat],[ue.lng,ye.lat]]),De=Al([[ye.lng,ye.lat],[ye.lng,ue.lat]]);te.width=Zc(Oe,{units:"meters"}),te.height=Zc(De,{units:"meters"}),Se=te.width*te.height,console.log(`
Forme détectée: Rectangle`),console.log(`- Surface propre: ${Se.toFixed(2)} m²`),console.log(`- Largeur: ${te.width.toFixed(2)} m`),console.log(`- Hauteur: ${te.height.toFixed(2)} m`)}else if(((ae=oe.properties)==null?void 0:ae.type)==="Semicircle"){const Le=oe.getStartAngle(),ye=oe.getStopAngle(),ue=(ye-Le+360)%360,Oe=oe.getRadius();Se=Math.PI*Math.pow(Oe,2)*ue/360,console.log(`
Forme détectée: Semicircle`),console.log(`- Surface propre: ${Se.toFixed(2)} m²`),console.log(`- Rayon: ${Oe.toFixed(2)} m`),console.log(`- Angle de début: ${Le.toFixed(2)}°`),console.log(`- Angle de fin: ${ye.toFixed(2)}°`),console.log(`- Angle d'ouverture: ${ue.toFixed(2)}°`)}return Se>0});if(W.length===0)return 0;const he=new Set,ne=[];for(const oe of W)if(!he.has(oe)){const Se=Ae(W,oe);Se.length>0&&(ne.push(Se),Se.forEach(te=>he.add(te)))}console.log(`
Nombre de groupes de formes connectées: ${ne.length}`);const re=ne.map((oe,Se)=>{console.log(`
Calcul pour le groupe ${Se+1} (${oe.length} formes):`);const te=oe.map(Oe=>{var De,Me,Ve;try{let ze;if(Oe instanceof St.Circle){const st=Oe.getLatLng(),Qe=Oe.getRadius();ze=VM([st.lng,st.lat],Qe/1e3,{units:"kilometers",steps:256});const pt=vu(ze),wt=((De=Oe.properties)==null?void 0:De.surface)||0;return console.log(`
Conversion Cercle -> GeoJSON`),console.log(`- Rayon: ${Qe.toFixed(2)}m`),console.log(`- Surface propriété: ${wt.toFixed(2)}m²`),console.log(`- Surface GeoJSON: ${pt.toFixed(2)}m²`),ze}else if(Oe instanceof Uo||Oe instanceof St.Rectangle){const st=Oe.getBounds(),Qe=st.getSouthWest(),pt=st.getNorthEast(),wt=St.latLng(pt.lat,Qe.lng),Ht=St.latLng(Qe.lat,pt.lng),nn=[[Qe.lng,Qe.lat],[Ht.lng,Ht.lat],[pt.lng,pt.lat],[wt.lng,wt.lat],[Qe.lng,Qe.lat]];ze=El([nn]);const tt=vu(ze),Qt=Al([[Qe.lng,Qe.lat],[pt.lng,Qe.lat]]),rn=Al([[Qe.lng,Qe.lat],[Qe.lng,pt.lat]]),it=Zc(Qt,{units:"meters"}),Ke=Zc(rn,{units:"meters"}),qt=it*Ke;return console.log(`
Conversion Rectangle -> GeoJSON`),console.log(`- Largeur: ${it.toFixed(2)}m`),console.log(`- Hauteur: ${Ke.toFixed(2)}m`),console.log(`- Surface théorique: ${qt.toFixed(2)}m²`),console.log(`- Surface GeoJSON: ${tt.toFixed(2)}m²`),console.log(`- Différence: ${Math.abs(qt-tt).toFixed(2)}m² (${(Math.abs(qt-tt)/qt*100).toFixed(2)}%)`),ze}else if(((Me=Oe.properties)==null?void 0:Me.type)==="Semicircle"){const st=Oe.getCenter(),Qe=Oe.getRadius(),pt=Oe.getStartAngle(),wt=Oe.getStopAngle(),Ht=[],nn=64;Ht.push([st.lng,st.lat]);for(let rn=0;rn<=nn;rn++){const Ke=(pt+(wt-pt+360)%360*rn/nn)*Math.PI/180,qt=Qe*Math.cos(Ke),xn=Qe*Math.sin(Ke)/111319.9,wn=qt/(111319.9*Math.cos(st.lat*Math.PI/180));Ht.push([st.lng+wn,st.lat+xn])}Ht.push([st.lng,st.lat]),ze=El([Ht]);const tt=vu(ze),Qt=((Ve=Oe.properties)==null?void 0:Ve.surface)||0;return console.log(`
Conversion Semicircle -> GeoJSON`),console.log(`- Rayon: ${Qe.toFixed(2)}m`),console.log(`- Surface propriété: ${Qt.toFixed(2)}m²`),console.log(`- Surface GeoJSON: ${tt.toFixed(2)}m²`),console.log(`- Différence: ${Math.abs(Qt-tt).toFixed(2)}m² (${(Math.abs(Qt-tt)/Qt*100).toFixed(2)}%)`),ze}return null}catch(ze){return console.error("[useMapDrawing] Erreur lors de la conversion en GeoJSON:",ze),null}}).filter(Oe=>Oe!==null);if(te.length===0)return 0;const ae=te.map(Oe=>{const De=vu(Oe);return console.log(`Surface individuelle: ${De.toFixed(2)}m²`),De});let Le=0;for(let Oe=0;Oe<te.length;Oe++)for(let De=Oe+1;De<te.length;De++)try{const Me=TM([te[Oe],te[De]]),Ve=f8(Me);if(Ve){const ze=vu(Ve);Le+=ze,console.log(`Intersection entre formes ${Oe+1} et ${De+1}: ${ze.toFixed(2)}m²`)}}catch(Me){console.error(`Erreur lors du calcul d'intersection entre les formes ${Oe+1} et ${De+1}:`,Me)}const ye=ae.reduce((Oe,De)=>Oe+De,0),ue=ye-Le;return console.log(`
Calcul de la surface d'irrigation pour le groupe ${Se+1}:`),console.log(`- Surface totale (somme): ${ye.toFixed(2)}m²`),console.log(`- Surface d'intersection: ${Le.toFixed(2)}m²`),console.log(`- Surface d'irrigation finale: ${ue.toFixed(2)}m²`),ue}),ee=Math.max(...re);return console.log(`
Surface d'irrigation maximale parmi les groupes: ${ee.toFixed(2)}m²`),ee},se=()=>{h.value&&(e.value.removeLayer(h.value),h.value=null)},ie=(B,W)=>{if(!e.value)return;se();const he=W?Ae(B,W):B;if(h.value||(h.value=St.layerGroup().addTo(e.value)),he.forEach(ne=>{var ee;const re=(ee=ne.properties)==null?void 0:ee.type;if(re==="Circle"||re==="Semicircle"){const oe=ne.getLatLng(),Se=ne.getRadius(),te=St.circle(oe,{radius:Se,fillColor:"#3B82F6",fillOpacity:.1,stroke:!0,color:"#3B82F6",weight:1,opacity:.8,dashArray:"5, 5",interactive:!1,renderer:St.canvas({padding:.5})}),ae=St.circle(oe,{radius:Se,fillColor:"#3B82F6",fillOpacity:.05,stroke:!1,interactive:!1,renderer:St.canvas({padding:.5})});h.value&&(h.value.addLayer(ae),h.value.addLayer(te))}else if(re==="Rectangle"||re==="Polygon"){const oe=ne.getLatLngs(),Se=St.polygon(oe,{fillColor:"#3B82F6",fillOpacity:.1,stroke:!0,color:"#3B82F6",weight:1,opacity:.8,dashArray:"5, 5",interactive:!1,renderer:St.canvas({padding:.5})}),te=St.polygon(oe,{fillColor:"#3B82F6",fillOpacity:.05,stroke:!1,interactive:!1,renderer:St.canvas({padding:.5})});h.value&&(h.value.addLayer(te),h.value.addLayer(Se))}}),W&&he.length>1&&e.value){const ne=St.latLngBounds([]);he.forEach(oe=>{oe.getBounds?ne.extend(oe.getBounds()):oe.getLatLng&&ne.extend(oe.getLatLng())});const re=ne.getCenter(),ee=St.tooltip({permanent:!0,direction:"center",className:"connected-group-tooltip"}).setContent("<div>Groupe connecté</div>").setLatLng(re);h.value&&h.value.addLayer(St.marker(re,{opacity:0,interactive:!1}).bindTooltip(ee).openTooltip())}},Ae=(B,W)=>{if(!W)return[];const he=new Set,ne=[W],re=[W];for(W._leaflet_id!==void 0&&he.add(W._leaflet_id);ne.length>0;){const ee=ne.shift();for(const oe of B){if(oe===ee||he.has(oe._leaflet_id))continue;Te(ee,oe)&&(re.push(oe),ne.push(oe),he.add(oe._leaflet_id))}}return re},Te=(B,W)=>{let he=null,ne=null;if(B.getBounds&&typeof B.getBounds=="function")he=B.getBounds();else if(B.getLatLng&&B.getRadius){const re=B.getLatLng(),ee=B.getRadius();he=St.latLngBounds([re.lat-ee/111e3,re.lng-ee/(111e3*Math.cos(re.lat*Math.PI/180))],[re.lat+ee/111e3,re.lng+ee/(111e3*Math.cos(re.lat*Math.PI/180))])}if(W.getBounds&&typeof W.getBounds=="function")ne=W.getBounds();else if(W.getLatLng&&W.getRadius){const re=W.getLatLng(),ee=W.getRadius();ne=St.latLngBounds([re.lat-ee/111e3,re.lng-ee/(111e3*Math.cos(re.lat*Math.PI/180))],[re.lat+ee/111e3,re.lng+ee/(111e3*Math.cos(re.lat*Math.PI/180))])}return!(!he||!ne||!he.intersects(ne))},ut=(B,W)=>{var ne;const he=Ae(B,W);return he.length===1&&(ne=W.properties)!=null&&ne.surface?W.properties.surface:Z(he)},X=B=>{var ne,re,ee,oe,Se,te,ae,Le,ye,ue,Oe;const W=B.layer;(ne=n.value)==null||ne.addLayer(W);let he="unknown";if(W instanceof St.Circle?he=r.value==="Semicircle"?"Semicircle":"Circle":W instanceof St.Rectangle?he="Rectangle":W instanceof St.Polygon?he="Polygon":W instanceof St.Polyline&&!(W instanceof St.Polygon)&&(he="Line"),W.properties=j(W,he),o.value=W,console.log("[useMapDrawing] Input layer:",{type:he,instanceof:{Circle:W instanceof St.Circle,Rectangle:W instanceof St.Rectangle,Polygon:W instanceof St.Polygon,Polyline:W instanceof St.Polyline},options:W.options,properties:W.properties}),window.dispatchEvent(new CustomEvent("shape:created",{detail:{shape:W,type:he,properties:W.properties}})),W.on("mouseover",()=>{console.log("[mouseover] Survol de la forme",{type:he,isSelected:o.value===W}),(!o.value||o.value!==W)&&$(W)}),W.on("mouseout",()=>{var De;console.log("[mouseout] Sortie de la forme",{type:he,isSelected:o.value===W}),(!o.value||o.value!==W)&&((De=i.value)==null||De.clearLayers())}),he==="Semicircle"){const De=W.getLatLng(),Me=W.getRadius();(re=n.value)==null||re.removeLayer(W);const Ve=new Lu(De,Me);Ve.properties=j(Ve,"Semicircle"),(ee=n.value)==null||ee.addLayer(Ve),o.value=Ve,Y(Ve)}else if(he==="Circle"){(oe=n.value)==null||oe.removeLayer(W);const De=new Xc(W.getLatLng(),{radius:W.getRadius(),...W.options});De.properties={...j(De,"Circle"),type:"Circle"},Object.defineProperty(De,"name",{value:De.properties.name,writable:!0,enumerable:!0,configurable:!0}),console.log("[useMapDrawing] Création du cercle personnalisé:",{propertyDescriptor:Object.getOwnPropertyDescriptor(De,"name"),directName:De.name,propertiesName:De.properties.name,nameIsEnumerable:Object.keys(De).includes("name"),allProperties:Object.keys(De.properties),allKeys:Object.keys(De)}),(Se=n.value)==null||Se.addLayer(De),o.value=De,H(De)}else if(he==="Rectangle"){(te=n.value)==null||te.removeLayer(W);const De=new Uo(W.getBounds(),{...W.options});De.updateProperties(),(ae=n.value)==null||ae.addLayer(De),o.value=De,le(De)}else if(W instanceof St.Polygon){const De=W.getLatLngs()[0],Me=new Rf([De],{...W.options});Me.updateProperties(),(Le=n.value)==null||Le.removeLayer(W),(ye=n.value)==null||ye.addLayer(Me),o.value=Me,I(Me)}else if(W instanceof $o)G(W);else if(W instanceof St.Polyline&&!(W instanceof St.Polygon)){const De=W.getLatLngs(),Me=new $o(De,{...W.options});Me.updateProperties(),(ue=n.value)==null||ue.removeLayer(W),(Oe=n.value)==null||Oe.addLayer(Me),o.value=Me,G(Me)}jo("Cliquez sur la forme pour afficher les points de contrôle")},ke=()=>{e.value&&(e.value.off("pm:create"),e.value.on("pm:create",X))};return{map:e,featureGroup:n,controlPointsGroup:t,tempControlPointsGroup:i,currentTool:r,selectedShape:o,isDrawing:l,initMap:F,setDrawingTool:pe,updateShapeStyle:Ee,updateShapeProperties:Ie,updateTextFixedSize:Q,adjustView:V,clearActiveControlPoints:b,calculateTotalCoverageArea:Z,showCoverageOverlay:ie,hideCoverageOverlay:se,calculateConnectedCoverageArea:ut,getConnectedShapes:Ae}}const _8={class:"h-full flex flex-col bg-white overflow-y-auto"},b8={class:"p-3 border-b border-gray-200"},w8={class:"grid grid-cols-4 gap-1"},x8=["onClick","title"],L8=["innerHTML"],C8={key:0,class:"flex-1 overflow-y-auto"},S8={class:"p-3 border-b border-gray-200"},P8={class:"p-3"},E8={class:"grid grid-cols-6 gap-2 mb-4"},A8=["onClick","title"],k8={key:0,class:"space-y-4"},M8={class:"flex items-center gap-4"},T8={class:"flex items-center gap-2"},B8={class:"flex items-center gap-4"},N8=["value"],D8={key:0,class:"flex items-center gap-4"},R8={class:"flex items-center gap-2"},O8={key:1,class:"space-y-4"},I8={class:"flex items-center gap-4"},F8={class:"flex items-center gap-2"},z8={class:"flex items-center gap-4"},j8={class:"flex items-center gap-2"},U8={class:"flex items-center gap-4"},$8={class:"flex items-center gap-2"},q8={class:"flex items-center gap-4"},G8={class:"flex items-center gap-2 w-full"},V8={class:"flex items-center gap-4"},H8={class:"flex items-center gap-2"},W8={class:"flex items-center gap-4"},Z8={class:"flex items-center gap-2"},K8=["onClick","title"],J8=["innerHTML"],Y8={key:1,class:"p-3 border-t border-gray-200"},X8={class:"mt-3"},Q8={key:0},eT={class:"mb-4"},tT={class:"grid grid-cols-1 gap-4"},nT={key:0,class:"space-y-1"},iT={class:"flex justify-between items-center"},rT={class:"text-sm font-medium text-gray-500"},sT={class:"flex justify-between items-center"},oT={class:"text-sm font-medium text-gray-500"},aT={class:"flex justify-between items-center"},lT={class:"text-sm font-medium text-gray-500"},uT={key:1,class:"space-y-1"},cT={class:"flex justify-between items-center"},hT={class:"text-sm font-medium text-gray-500"},fT={class:"flex justify-between items-center"},dT={class:"text-sm font-medium text-gray-500"},pT={class:"flex justify-between items-center"},gT={class:"text-sm font-medium text-gray-500"},mT={class:"flex justify-between items-center"},vT={class:"text-sm font-medium text-gray-500"},yT={key:2,class:"space-y-1"},_T={class:"flex items-center mb-2"},bT={class:"flex-1 flex items-center"},wT={class:"flex items-center mb-2"},xT={class:"flex-1 flex items-center"},LT={class:"flex justify-between items-center"},CT={class:"text-sm font-medium text-gray-500"},ST={class:"flex justify-between items-center"},PT={class:"text-sm font-medium text-gray-500"},ET={key:3,class:"space-y-1"},AT={class:"flex justify-between items-center"},kT={class:"text-sm font-medium text-gray-500"},MT={class:"flex justify-between items-center"},TT={class:"text-sm font-medium text-gray-500"},BT={class:"flex justify-between items-center"},NT={class:"text-sm font-medium text-gray-500"},DT={class:"flex justify-between items-center"},RT={class:"text-sm font-medium text-gray-500"},OT={class:"text-sm font-medium text-gray-500"},IT={key:5,class:"space-y-1"},FT={class:"flex justify-between items-center"},zT={class:"text-sm font-medium text-gray-500"},jT={class:"flex justify-between items-center"},UT={class:"text-sm font-medium text-gray-500"},$T={class:"flex justify-between items-center"},qT={class:"text-sm font-medium text-gray-500"},GT={class:"flex flex-col space-y-2 w-full"},VT={class:"flex justify-between items-center"},HT={class:"text-sm font-medium text-gray-500 ml-2"},WT={class:"flex justify-between items-center"},ZT={class:"text-sm font-medium text-gray-500 ml-2"},KT={class:"flex justify-between items-center"},JT={class:"text-sm font-medium text-gray-500 ml-2"},YT={class:"flex justify-between items-center"},XT={class:"text-sm font-medium text-gray-500 ml-2"},QT={class:"flex justify-between items-center"},eB={class:"text-sm font-medium text-gray-500 ml-2"},tB={key:1,class:"text-center text-sm text-gray-500"},nB={key:2,class:"p-3 border-t border-gray-200"},iB={class:"mt-3"},rB={class:"mb-4"},sB={class:"grid grid-cols-2 gap-2"},oB={class:"grid grid-cols-2 gap-2"},aB={key:3,class:"p-3 border-t border-gray-200"},lB={class:"mt-3"},uB={key:0,class:"space-y-3"},cB={class:"pl-3"},hB={class:"flex justify-between items-center mb-2"},fB={class:"flex-grow min-w-0 mr-2"},dB=["onUpdate:modelValue","onChange"],pB=["onClick"],gB={class:"grid grid-cols-2 gap-2 mb-2"},mB={class:"min-w-0"},vB=["onUpdate:modelValue","onChange"],yB={class:"min-w-0"},_B=["onUpdate:modelValue","onChange"],bB={class:"min-w-0"},wB=["onUpdate:modelValue","onChange"],xB={class:"min-w-0"},LB={class:"w-full px-2 py-1 text-sm text-gray-700 bg-gray-50 rounded truncate"},CB={class:"col-span-2"},SB=["onUpdate:modelValue","onChange"],PB={class:"w-full h-8 bg-gray-100 rounded relative overflow-hidden"},EB=["onClick"],AB={key:0,class:"mt-1 text-xs text-center p-1 bg-blue-100 text-blue-800 rounded"},kB={key:1,class:"text-center text-sm text-gray-500 py-2"},MB=Pa({__name:"DrawingTools",props:{currentTool:{},selectedShape:{},allLayers:{}},emits:["tool-change","style-update","properties-update","delete-shape","shape-selected"],setup(e,{emit:n}){const{measure:t,measureAsync:i,startMeasure:r}=hh(),{calculateConnectedCoverageArea:o,showCoverageOverlay:l,hideCoverageOverlay:h,map:p}=x4(),m=e,_=n,w=Yt(null),E=Yt("Double-cliquez pour éditer"),b=Yt(""),D=Yt("#3B82F6"),j=Yt(.2),Q=Yt("#2563EB"),F=Yt(2),V=Yt("solid"),pe=Yt("#000000"),Ee=Yt("Arial, sans-serif"),Ie=Yt("center"),nt=Yt(!1),We=Yt(!1),O=Yt("14px"),H=Yt({style:!1,properties:!1,samplePoints:!0,elevationProfile:!1,circleSections:!1}),le=Yt({radius:4,color:"#FF4500",fillColor:"#FF4500",fillOpacity:.6,weight:2,opacity:.8}),G=Yt({radius:6,weight:3,opacity:1,fillOpacity:1}),I=Di(()=>{var de,_e;return!((de=m.selectedShape)!=null&&de.properties)||m.selectedShape.properties.type!=="TextRectangle"?"center":((_e=m.selectedShape.properties.style)==null?void 0:_e.textAlign)||"center"});Ur(()=>m.selectedShape,de=>{var Dn,Ln,bt,_n,$n,ni,ri,Li,Sn,Un,ui,jn,Wt;const _e=r("watchSelectedShape","DrawingTools");if(h(),!de){w.value=null,Y(),_e();return}const $e=((Ln=(Dn=de.properties)==null?void 0:Dn.style)==null?void 0:Ln.name)||(($n=(_n=(bt=de.layer)==null?void 0:bt.properties)==null?void 0:_n.style)==null?void 0:$n.name)||((ni=de.layer)==null?void 0:ni.name)||((Li=(ri=de.layer)==null?void 0:ri.properties)==null?void 0:Li.name)||((Sn=de.properties)==null?void 0:Sn.name)||"";b.value=$e,w.value=de.properties?{...de.properties}:null,$e&&w.value&&(w.value.name=$e),$(((Un=de.properties)==null?void 0:Un.style)||{}),((ui=de.properties)==null?void 0:ui.type)==="TextRectangle"?R(de):((jn=de.properties)==null?void 0:jn.type)==="ElevationLine"&&Z(de);const Gt=(Wt=de.properties)==null?void 0:Wt.type;["Circle","Rectangle","Polygon","Semicircle"].includes(Gt)&&m.allLayers&&p.value&&setTimeout(()=>{m.allLayers&&p.value&&l(m.allLayers,de.layer)},50),_e()},{immediate:!0});function Y(){Ie.value="center",nt.value=!1,We.value=!1,E.value="Double-cliquez pour éditer",D.value="#3B82F6",j.value=.2,Q.value="#2563EB",F.value=2,V.value="solid",pe.value="#000000",Ee.value="Arial, sans-serif",O.value="14px",b.value=""}function $(de){D.value=de.fillColor||"#3B82F6",j.value=de.fillOpacity!==void 0?de.fillOpacity:.2,Q.value=de.color||"#2563EB",F.value=de.weight||2,V.value=de.dashArray?"dashed":"solid"}function R(de){var $e,Gt,Dn;const _e=((Gt=($e=de.properties)==null?void 0:$e.style)==null?void 0:Gt.textStyle)||{};pe.value=_e.color||"#000000",Ee.value=_e.fontFamily||"Arial, sans-serif",Ie.value=_e.textAlign||"center",nt.value=_e.bold||!1,We.value=_e.italic||!1,O.value=_e.fontSize||"14px",E.value=((Dn=de.properties)==null?void 0:Dn.text)||"Double-cliquez pour éditer"}function Z(de){var _e,$e;(_e=de.properties)!=null&&_e.samplePointStyle&&(le.value={radius:de.properties.samplePointStyle.radius??4,color:de.properties.samplePointStyle.color??"#FF4500",fillColor:de.properties.samplePointStyle.fillColor??"#FF4500",fillOpacity:de.properties.samplePointStyle.fillOpacity??.6,weight:de.properties.samplePointStyle.weight??2,opacity:de.properties.samplePointStyle.opacity??.8}),($e=de.properties)!=null&&$e.minMaxPointStyle&&(G.value={radius:de.properties.minMaxPointStyle.radius??6,weight:de.properties.minMaxPointStyle.weight??3,opacity:de.properties.minMaxPointStyle.opacity??1,fillOpacity:de.properties.minMaxPointStyle.fillOpacity??1})}Ur(()=>{var de,_e;return(_e=(de=m.selectedShape)==null?void 0:de.properties)==null?void 0:_e.text},de=>{var _e,$e;(($e=(_e=m.selectedShape)==null?void 0:_e.properties)==null?void 0:$e.type)==="TextRectangle"&&(console.log("[DrawingTools] Mise à jour du texte :",de),E.value=de||"Double-cliquez pour éditer")},{immediate:!0}),Ur(()=>{var de,_e;return(_e=(de=m.selectedShape)==null?void 0:de.properties)==null?void 0:_e.style},de=>{var _e,$e,Gt,Dn,Ln,bt,_n,$n;(_e=m.selectedShape)!=null&&_e.properties&&m.selectedShape.properties.type==="TextRectangle"&&de&&(console.log("[DrawingTools] Style watch triggered",{newStyle:de,textStyle:de.textStyle,fontSize:($e=de.textStyle)==null?void 0:$e.fontSize}),pe.value=((Gt=de.textStyle)==null?void 0:Gt.color)||"#000000",Ee.value=((Dn=de.textStyle)==null?void 0:Dn.fontFamily)||"Arial, sans-serif",Ie.value=((Ln=de.textStyle)==null?void 0:Ln.textAlign)||"center",nt.value=((bt=de.textStyle)==null?void 0:bt.bold)||!1,We.value=((_n=de.textStyle)==null?void 0:_n.italic)||!1,O.value=(($n=de.textStyle)==null?void 0:$n.fontSize)||"14px")},{deep:!0});const se=(de,_e)=>{let $e=null;return(...Gt)=>{$e!==null&&clearTimeout($e),$e=window.setTimeout(()=>{de(...Gt),$e=null},_e)}},ie=(de,_e)=>{if(de===_e)return!0;if(de===null||_e===null)return!1;if(typeof de!="object"||typeof _e!="object")return de===_e;const $e=Object.keys(de),Gt=Object.keys(_e);if($e.length!==Gt.length)return!1;for(const Dn of $e)if(!Gt.includes(Dn)||!ie(de[Dn],_e[Dn]))return!1;return!0},Ae=se((de,_e)=>{console.log("[DrawingTools] Changement détecté dans localProperties",{newProperties:de,oldProperties:_e,selectedShape:m.selectedShape})},300);Ur(()=>w.value,(de,_e)=>{de&&_e&&!ie(de,_e)&&Ae(de,_e)},{deep:!0});const Te=de=>({Circle:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10" /></svg>',Semicircle:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 12a10 10 0 0 1 20 0" /></svg>',Rectangle:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2" /></svg>',Polygon:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 3l9 7-3 9H6l-3-9 9-7z" /></svg>',delete:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6" /><path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2" /><line x1="10" y1="11" x2="10" y2="17" /><line x1="14" y1="11" x2="14" y2="17" /></svg>',Line:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 19l18-14" /></svg>',TextRectangle:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" /><path d="M9 8h6m-3 0v8" /></svg>',ElevationLine:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12h3l3-9 6 18 3-9h3" /></svg>',CircleWithSections:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 3c5.523 0 10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2zm0 18c4.418 0 8-3.582 8-8s-3.582-8-8-8-8 3.582-8 8 3.582 8 8 8z" /></svg>'})[de]||"",ut=[{type:"Circle",label:"Cercle"},{type:"Semicircle",label:"Demi-cercle"},{type:"Rectangle",label:"Rectangle"},{type:"Polygon",label:"Polygone"},{type:"Line",label:"Ligne"},{type:"ElevationLine",label:"Profil altimétrique"},{type:"TextRectangle",label:"Texte"},{type:"delete",label:"Supprimer"},{type:"CircleWithSections",label:"Cercle avec sections"}],X=["#2563EB","#DC2626","#059669","#D97706","#7C3AED","#DB2777"],ke=[{value:"solid",label:"Continu"},{value:"dashed",label:"Tirets"},{value:"dotted",label:"Pointillé"},{value:"dashdot",label:"Tiret-point"}],B=[{value:"left",label:"Aligné à gauche",icon:"&#8678;"},{value:"center",label:"Centré",icon:"&#8645;"},{value:"right",label:"Aligné à droite",icon:"&#8680;"}],W=Di(()=>{var _e,$e;const de=($e=(_e=m.selectedShape)==null?void 0:_e.properties)==null?void 0:$e.type;return console.log("[DrawingTools] Calcul de showFillOptions",{shapeType:de,selectedShape:m.selectedShape}),de?["Circle","Rectangle","Polygon","Semicircle"].includes(de)&&de!=="ElevationLine":!1}),he=de=>{H.value[de]=!H.value[de]},ne=de=>{switch(de){case"dashed":return"10,10";case"dotted":return"2,5";case"dashdot":return"10,5,2,5";default:return""}},re=de=>{var _e,$e,Gt;if(Q.value=de,(W.value||((_e=w.value)==null?void 0:_e.type)==="TextRectangle")&&(D.value=de),(($e=w.value)==null?void 0:$e.type)==="TextRectangle"){pe.value=de,oe({textColor:de});return}ee({strokeColor:de,fillColor:W.value||((Gt=w.value)==null?void 0:Gt.type)==="TextRectangle"?de:void 0})},ee=de=>{const _e={...de};de.strokeStyle&&(_e.dashArray=ne(de.strokeStyle)),de.fillOpacity!==void 0&&(_e.fillOpacity=parseFloat(de.fillOpacity)),de.strokeOpacity!==void 0&&(_e.strokeOpacity=parseFloat(de.strokeOpacity)),de.strokeWidth!==void 0&&(_e.weight=parseInt(de.strokeWidth)),de.strokeColor&&(_e.color=de.strokeColor),_("style-update",_e)},oe=de=>{var Gt,Dn,Ln,bt,_n,$n,ni,ri,Li,Sn,Un,ui,jn,Wt,yn,Ci,qi,Si,Qi,fr,Hn,ai,rr;if(((Dn=(Gt=m.selectedShape)==null?void 0:Gt.properties)==null?void 0:Dn.type)!=="TextRectangle")return;console.log("[DrawingTools] Updating text style",{current:{style:m.selectedShape.properties.style,textStyle:(Ln=m.selectedShape.properties.style)==null?void 0:Ln.textStyle,textColor:(_n=(bt=m.selectedShape.properties.style)==null?void 0:bt.textStyle)==null?void 0:_n.color,fontSize:(ni=($n=m.selectedShape.properties.style)==null?void 0:$n.textStyle)==null?void 0:ni.fontSize},new:de});let _e={...de};_e.fontSize&&!_e.fontSize.endsWith("px")&&(_e.fontSize=`${_e.fontSize}px`);const $e={textStyle:{color:de.textColor||((Li=(ri=m.selectedShape.properties.style)==null?void 0:ri.textStyle)==null?void 0:Li.color),fontSize:_e.fontSize||((Un=(Sn=m.selectedShape.properties.style)==null?void 0:Sn.textStyle)==null?void 0:Un.fontSize)||"14px",fontFamily:de.fontFamily||((jn=(ui=m.selectedShape.properties.style)==null?void 0:ui.textStyle)==null?void 0:jn.fontFamily),textAlign:de.textAlign||((yn=(Wt=m.selectedShape.properties.style)==null?void 0:Wt.textStyle)==null?void 0:yn.textAlign),backgroundColor:((qi=(Ci=m.selectedShape.properties.style)==null?void 0:Ci.textStyle)==null?void 0:qi.backgroundColor)||"#FFFFFF",backgroundOpacity:((Qi=(Si=m.selectedShape.properties.style)==null?void 0:Si.textStyle)==null?void 0:Qi.backgroundOpacity)??1,bold:de.bold!==void 0?de.bold:(Hn=(fr=m.selectedShape.properties.style)==null?void 0:fr.textStyle)==null?void 0:Hn.bold,italic:de.italic!==void 0?de.italic:(rr=(ai=m.selectedShape.properties.style)==null?void 0:ai.textStyle)==null?void 0:rr.italic}};console.log("[DrawingTools] Emitting style update with textStyle structure",$e),_("style-update",$e)},Se=()=>{nt.value=!nt.value,oe({bold:nt.value})},te=()=>{We.value=!We.value,oe({italic:We.value})},ae=de=>de?de>=1e3?`${(de/1e3).toFixed(2)} km`:`${de.toFixed(2)} m`:"0 m",Le=de=>de?`${(de/1e4).toFixed(2)} ha`:"0 ha",ye=()=>{var de,_e;if(((_e=(de=m.selectedShape)==null?void 0:de.properties)==null?void 0:_e.type)==="ElevationLine"){const $e={...le.value,fillColor:le.value.color};m.selectedShape.layer.setSamplePointStyle($e)}},ue=()=>{var de,_e;((_e=(de=m.selectedShape)==null?void 0:de.properties)==null?void 0:_e.type)==="ElevationLine"&&m.selectedShape.layer.setMinMaxPointStyle(G.value)},Oe=Yt(null),De=Yt(null),Me=de=>`${de.toFixed(1)}%`,Ve=()=>{var Si,Qi,fr,Hn;if(!Oe.value||!((Qi=(Si=m.selectedShape)==null?void 0:Si.properties)!=null&&Qi.elevationData)){console.log("[DrawingTools] Impossible de dessiner le profil : canvas ou données manquantes",{canvas:!!Oe.value,data:!!((Hn=(fr=m.selectedShape)==null?void 0:fr.properties)!=null&&Hn.elevationData)});return}console.log("[DrawingTools] Dessin du profil avec les données:",{data:m.selectedShape.properties.elevationData,minElevation:m.selectedShape.properties.minElevation,maxElevation:m.selectedShape.properties.maxElevation});const de=Oe.value.getContext("2d");if(!de)return;De.value=de;const _e=Oe.value,$e=m.selectedShape.properties.elevationData,Gt=window.devicePixelRatio||1,Dn=_e.getBoundingClientRect();_e.width=Dn.width*Gt,_e.height=Dn.height*Gt,_e.style.width=`${Dn.width}px`,_e.style.height=`${Dn.height}px`,de.scale(Gt,Gt),de.clearRect(0,0,Dn.width,Dn.height);const Ln=30,bt=Dn.width-2*Ln,_n=Dn.height-2*Ln,$n=m.selectedShape.properties.minElevation,ni=m.selectedShape.properties.maxElevation,Li=(ni-$n)*.05,Sn=$n-Li,Un=ni+Li,ui=ai=>Ln+ai/$e[$e.length-1].distance*bt,jn=ai=>Ln+_n-(ai-Sn)/(Un-Sn)*_n;de.fillStyle="#f8fafc",de.fillRect(Ln,Ln,bt,_n),de.strokeStyle="#e2e8f0",de.lineWidth=1,de.beginPath(),de.moveTo(Ln,Ln),de.lineTo(Ln,_n+Ln),de.lineTo(bt+Ln,_n+Ln),de.strokeStyle="#94a3b8",de.stroke();const Wt=5;for(let ai=0;ai<=Wt;ai++){const rr=Sn+ai/Wt*(Un-Sn),Yi=jn(rr);de.beginPath(),de.strokeStyle="#e2e8f0",de.moveTo(Ln,Yi),de.lineTo(bt+Ln,Yi),de.stroke(),de.beginPath(),de.strokeStyle="#94a3b8",de.moveTo(Ln-5,Yi),de.lineTo(Ln,Yi),de.stroke(),de.fillStyle="#64748b",de.font="10px sans-serif",de.textAlign="right",de.fillText(`${Math.round(rr)}m`,Ln-8,Yi+4)}const yn=5,Ci=$e[$e.length-1].distance;for(let ai=0;ai<=yn;ai++){const rr=ai/yn*Ci,Yi=ui(rr);de.beginPath(),de.strokeStyle="#e2e8f0",de.moveTo(Yi,Ln),de.lineTo(Yi,_n+Ln),de.stroke(),de.beginPath(),de.strokeStyle="#94a3b8",de.moveTo(Yi,_n+Ln),de.lineTo(Yi,_n+Ln+5),de.stroke(),de.fillStyle="#64748b",de.font="10px sans-serif",de.textAlign="center",de.fillText(`${Math.round(rr)}m`,Yi,_n+Ln+16)}const qi=de.createLinearGradient(0,Ln,0,_n+Ln);qi.addColorStop(0,"rgba(255, 69, 0, 0.8)"),qi.addColorStop(1,"rgba(255, 69, 0, 0.2)"),de.beginPath(),de.moveTo(ui($e[0].distance),jn($e[0].elevation)),$e.forEach((ai,rr)=>{rr>0&&de.lineTo(ui(ai.distance),jn(ai.elevation))}),de.strokeStyle="#FF4500",de.lineWidth=2,de.stroke(),de.lineTo(ui($e[$e.length-1].distance),jn(Sn)),de.lineTo(ui($e[0].distance),jn(Sn)),de.closePath(),de.fillStyle=qi,de.fill(),$e.forEach(ai=>{de.beginPath(),de.arc(ui(ai.distance),jn(ai.elevation),3,0,Math.PI*2),de.fillStyle="#FF4500",de.fill(),de.strokeStyle="white",de.lineWidth=1,de.stroke()}),console.log("[DrawingTools] Profil dessiné avec succès")},ze=de=>{var $n,ni;if(!Oe.value||!((ni=($n=m.selectedShape)==null?void 0:$n.properties)!=null&&ni.elevationData))return;const _e=Oe.value.getBoundingClientRect(),$e=de.clientX-_e.left,Gt=m.selectedShape.properties.elevationData,Dn=30,Ln=_e.width-2*Dn,bt=Math.max(0,Math.min(($e-Dn)/Ln*Gt[Gt.length-1].distance,Gt[Gt.length-1].distance)),_n=Gt.reduce((ri,Li)=>Math.abs(Li.distance-bt)<Math.abs(ri.distance-bt)?Li:ri);if(m.selectedShape&&m.selectedShape.layer&&typeof m.selectedShape.layer.showElevationAt=="function"&&m.selectedShape.layer.showElevationAt(_n.distance),Ve(),De.value){const ri=De.value,Li=Oe.value.getBoundingClientRect(),Sn=Li.width-2*Dn,Un=Li.height-2*Dn,ui=m.selectedShape.properties.minElevation,jn=m.selectedShape.properties.maxElevation,Wt=(jn-ui)*.05,yn=ui-Wt,Ci=jn+Wt,qi=Qi=>Dn+Qi/Gt[Gt.length-1].distance*Sn,Si=Qi=>Dn+Un-(Qi-yn)/(Ci-yn)*Un;ri.beginPath(),ri.setLineDash([5,5]),ri.strokeStyle="rgba(0, 0, 0, 0.3)",ri.lineWidth=1,ri.moveTo(qi(_n.distance),Dn),ri.lineTo(qi(_n.distance),Un+Dn),ri.stroke(),ri.setLineDash([]),ri.beginPath(),ri.arc(qi(_n.distance),Si(_n.elevation),6,0,Math.PI*2),ri.fillStyle="#FF4500",ri.fill(),ri.strokeStyle="white",ri.lineWidth=2,ri.stroke()}},st=()=>{Ve(),m.selectedShape&&m.selectedShape.layer&&typeof m.selectedShape.layer.hideElevationMarker=="function"&&m.selectedShape.layer.hideElevationMarker()},Qe=new ResizeObserver(()=>{Ve()});Ha(()=>{Oe.value&&Qe.observe(Oe.value),window.addEventListener("resize",wt)}),Qu(()=>{Oe.value&&Qe.unobserve(Oe.value),window.removeEventListener("resize",wt)}),Ur(()=>{var de,_e;return(_e=(de=m.selectedShape)==null?void 0:de.properties)==null?void 0:_e.elevationData},()=>{t("watchElevationData",()=>{ks(()=>{if(Oe.value&&pt.value){const de=pt.value.getBoundingClientRect();Oe.value.style.width=`${de.width}px`,Oe.value.style.height=`${de.height}px`,Ve()}})},"DrawingTools")},{deep:!0});const pt=Yt(null),wt=se(()=>{if(Oe.value&&pt.value){const de=pt.value.getBoundingClientRect();Oe.value.style.width=`${de.width}px`,Oe.value.style.height=`${de.height}px`,Ve()}},250);function Ht(){var de,_e,$e,Gt,Dn,Ln,bt,_n,$n;m.selectedShape&&(console.log("[DrawingTools] Mise à jour du nom de la forme",{oldName:(de=m.selectedShape.properties)==null?void 0:de.name,layerDirectOldName:(_e=m.selectedShape.layer)==null?void 0:_e.name,layerPropertiesOldName:(Gt=($e=m.selectedShape.layer)==null?void 0:$e.properties)==null?void 0:Gt.name,newName:b.value,oldShapeName:b.value,layerType:((Dn=m.selectedShape.properties)==null?void 0:Dn.type)||m.selectedShape.type}),m.selectedShape.properties&&(m.selectedShape.properties.name=b.value),_("properties-update",{name:b.value}),console.log("[DrawingTools] Vérification après mise à jour du nom:",{propertiesName:(Ln=m.selectedShape.properties)==null?void 0:Ln.name,layerName:(bt=m.selectedShape.layer)==null?void 0:bt.name,layerPropertiesName:($n=(_n=m.selectedShape.layer)==null?void 0:_n.properties)==null?void 0:$n.name}))}const nn=se((de,_e)=>{p.value&&l(de,_e)},250),tt=Di(()=>{if(!m.allLayers||!m.selectedShape)return 0;const de=m.allLayers.filter(_e=>{var Gt;const $e=(Gt=_e.properties)==null?void 0:Gt.type;return $e==="Circle"||$e==="Rectangle"||$e==="Polygon"||$e==="Semicircle"});return de.length===0?0:o(de,m.selectedShape.layer)});Ur(()=>m.selectedShape,de=>{var Gt,Dn,Ln,bt,_n,$n,ni,ri,Li,Sn,Un,ui,jn;if(h(),!de){Y();return}w.value=de.properties?{...de.properties}:null;const _e=((Dn=(Gt=de.properties)==null?void 0:Gt.style)==null?void 0:Dn.name)||((_n=(bt=(Ln=de.layer)==null?void 0:Ln.properties)==null?void 0:bt.style)==null?void 0:_n.name)||(($n=de.layer)==null?void 0:$n.name)||((ri=(ni=de.layer)==null?void 0:ni.properties)==null?void 0:ri.name)||((Li=de.properties)==null?void 0:Li.name)||"";b.value=_e,$(((Sn=de.properties)==null?void 0:Sn.style)||{}),((Un=de.properties)==null?void 0:Un.type)==="TextRectangle"?R(de):((ui=de.properties)==null?void 0:ui.type)==="ElevationLine"&&Z(de);const $e=(jn=de.properties)==null?void 0:jn.type;["Circle","Rectangle","Polygon","Semicircle"].includes($e)&&m.allLayers&&p.value&&l(m.allLayers,de.layer)}),Ur(()=>m.allLayers,de=>{var _e;if(de&&m.selectedShape&&p.value){const $e=(_e=m.selectedShape.properties)==null?void 0:_e.type;($e==="Circle"||$e==="Rectangle"||$e==="Polygon"||$e==="Semicircle")&&document.visibilityState==="visible"&&l(de,m.selectedShape.layer)}}),Ur(()=>m.selectedShape,de=>{var Gt,Dn,Ln,bt,_n,$n,ni,ri,Li,Sn,Un,ui,jn,Wt,yn,Ci,qi,Si,Qi,fr,Hn,ai,rr,Yi,Pi,kn,xr,Gi,Wi,dr,zr;if(h(),de&&m.allLayers&&p.value){const Vi=(Gt=de.properties)==null?void 0:Gt.type;(Vi==="Circle"||Vi==="Rectangle"||Vi==="Polygon"||Vi==="Semicircle")&&nn(m.allLayers,de.layer)}if(console.log("[DrawingTools] Changement de forme sélectionnée:",{hasShape:!!de,shapeType:(Dn=de==null?void 0:de.properties)==null?void 0:Dn.type,shapeId:(Ln=de==null?void 0:de.layer)==null?void 0:Ln._leaflet_id,nombreDeLayers:(bt=m.allLayers)==null?void 0:bt.length}),!de){console.log("[DrawingTools] Resetting shape state"),w.value=null,Ie.value="center",nt.value=!1,We.value=!1,E.value="Double-cliquez pour éditer",D.value="#3B82F6",j.value=.2,Q.value="#2563EB",F.value=2,V.value="solid",pe.value="#000000",Ee.value="Arial, sans-serif",O.value="14px",b.value="";return}console.log("[DrawingTools] Structure détaillée de newShape:",{newShape:de,propertiesType:typeof de.properties,isProxy:de.properties&&de.properties.__v_isProxy,propsKeys:de.properties?Object.keys(de.properties):[],hasNameProperty:de.properties&&"name"in de.properties,namePropertyValue:(_n=de.properties)==null?void 0:_n.name,nameWithBrackets:de.properties&&de.properties.name,layerId:($n=de.layer)==null?void 0:$n._leaflet_id,layerProperties:(ni=de.layer)==null?void 0:ni.properties,layerName:(ri=de.layer)==null?void 0:ri.name,layerDirectName:de.layer&&"name"in de.layer?de.layer.name:void 0,layerPropertiesName:(Sn=(Li=de.layer)==null?void 0:Li.properties)==null?void 0:Sn.name,layerRawName:(Un=de.layer)==null?void 0:Un.name,allLayerKeys:de.layer?Object.keys(de.layer):[]});let _e;if((jn=(ui=de.properties)==null?void 0:ui.style)!=null&&jn.name)_e=de.properties.style.name,console.log("[DrawingTools] Name found in style:",_e);else if((Ci=(yn=(Wt=de.layer)==null?void 0:Wt.properties)==null?void 0:yn.style)!=null&&Ci.name)_e=de.layer.properties.style.name,console.log("[DrawingTools] Name found in layer.properties.style:",_e);else if((qi=de.layer)!=null&&qi.name)_e=de.layer.name,console.log("[DrawingTools] Name found directly on layer:",_e);else if((Qi=(Si=de.layer)==null?void 0:Si.properties)!=null&&Qi.name)_e=de.layer.properties.name,console.log("[DrawingTools] Name found in layer.properties:",_e);else if(de.properties&&Object.keys(de.properties).includes("name"))_e=de.properties.name,console.log("[DrawingTools] Name found with bracket notation:",_e);else{try{if(de.layer){const Vi=Object.getOwnPropertyDescriptor(de.layer,"name"),fi=de.layer.properties?Object.getOwnPropertyDescriptor(de.layer.properties,"name"):null,gs=(fr=de.layer.properties)!=null&&fr.style?Object.getOwnPropertyDescriptor(de.layer.properties.style,"name"):null;console.log("[DrawingTools] Recherche de propriété non-énumérable:",{layerDescriptor:Vi,propsDescriptor:fi,styleNameDescriptor:gs,layerPropertiesStyle:(Hn=de.layer.properties)==null?void 0:Hn.style}),gs&&gs.value?(_e=gs.value,console.log("[DrawingTools] Name found as non-enumerable property in style:",_e)):Vi&&Vi.value?(_e=Vi.value,console.log("[DrawingTools] Name found as non-enumerable property on layer:",_e)):fi&&fi.value&&(_e=fi.value,console.log("[DrawingTools] Name found as non-enumerable property on layer.properties:",_e))}}catch(Vi){console.error("[DrawingTools] Erreur lors de la recherche de propriété non-énumérable:",Vi)}_e||(console.log("[DrawingTools] Name not found in any location"),_e="")}console.log("[DrawingTools] Propriétés du nom de la forme:",{shapesName:_e,propertiesObject:de.properties,hasName:de.properties&&"name"in de.properties,layerName:(ai=de.layer)==null?void 0:ai.name,layerPropertiesName:(Yi=(rr=de.layer)==null?void 0:rr.properties)==null?void 0:Yi.name}),b.value=_e||"",console.log("[DrawingTools] Nom chargé pour la forme:",b.value),w.value=de.properties?{...de.properties}:null,_e&&w.value&&(w.value.name=_e,console.log("[DrawingTools] Nom explicitement défini dans localProperties:",_e)),w.value&&console.log("[DrawingTools] localProperties mis à jour",{type:w.value.type,name:w.value.name,hasLocalName:"name"in w.value,elevationData:w.value.elevationData,length:w.value.length,minElevation:w.value.minElevation,maxElevation:w.value.maxElevation,elevationGain:w.value.elevationGain,elevationLoss:w.value.elevationLoss,averageSlope:w.value.averageSlope,maxSlope:w.value.maxSlope,allKeys:Object.keys(w.value),layerName:(Pi=de.layer)==null?void 0:Pi.name,layerPropertiesName:(xr=(kn=de.layer)==null?void 0:kn.properties)==null?void 0:xr.name});const $e=((Gi=de.properties)==null?void 0:Gi.style)||{};if(D.value=$e.fillColor||"#3B82F6",j.value=$e.fillOpacity!==void 0?$e.fillOpacity:.2,Q.value=$e.color||"#2563EB",F.value=$e.weight||2,V.value=$e.dashArray?"dashed":"solid",((Wi=de.properties)==null?void 0:Wi.type)==="TextRectangle"){const Vi=$e.textStyle||{};console.log("[DrawingTools] TextRectangle style structure:",{style:$e,textStyle:Vi,fontSize:Vi.fontSize,textStylePath:(dr=$e==null?void 0:$e.textStyle)==null?void 0:dr.fontSize,directFontSize:$e.fontSize}),pe.value=Vi.color||"#000000",Ee.value=Vi.fontFamily||"Arial, sans-serif",Ie.value=Vi.textAlign||"center",nt.value=Vi.bold||!1,We.value=Vi.italic||!1,O.value=Vi.fontSize||"14px",E.value=de.properties.text||"Double-cliquez pour éditer",console.log("[DrawingTools] Initialisation du TextRectangle",{text:E.value,style:$e,fontSizeSelected:O.value})}((zr=de.properties)==null?void 0:zr.type)==="ElevationLine"&&(le.value={...de.properties.samplePointStyle},G.value={...de.properties.minMaxPointStyle})},{immediate:!0,deep:!0}),Qu(()=>{h()});const Qt=Yt([]),rn=()=>t("addSection",()=>{if(!(!m.selectedShape||!m.selectedShape.layer)&&typeof m.selectedShape.layer.addSection=="function"){const de=m.selectedShape.layer.addSection();console.log("[DrawingTools] Nouvelle section ajoutée:",de)}},"DrawingTools"),it=(de,_e)=>t("updateSection",()=>{!m.selectedShape||!m.selectedShape.layer||typeof m.selectedShape.layer.updateSection=="function"&&(m.selectedShape.layer.updateSection(de,_e),console.log("[DrawingTools] Section mise à jour:",{sectionId:de,updates:_e}))},"DrawingTools"),Ke=de=>t("removeSection",()=>{!m.selectedShape||!m.selectedShape.layer||typeof m.selectedShape.layer.removeSection=="function"&&(m.selectedShape.layer.removeSection(de),console.log("[DrawingTools] Section supprimée:",de))},"DrawingTools");Ur(()=>{var de,_e;return(_e=(de=m.selectedShape)==null?void 0:de.properties)==null?void 0:_e.sections},de=>{t("watchSections",()=>{de&&Array.isArray(de)?(Qt.value=JSON.parse(JSON.stringify(de)),console.log("[DrawingTools] Sections mises à jour:",Qt.value)):Qt.value=[]},"DrawingTools")},{deep:!0,immediate:!0}),Ha(()=>{const de=$e=>{t("handleSectionVisualUpdate",()=>{var Gt,Dn,Ln;(Gt=m.selectedShape)!=null&&Gt.layer&&((Dn=m.selectedShape.properties)==null?void 0:Dn.type)==="CircleWithSections"&&((Ln=$e.detail)!=null&&Ln.sections)&&(console.log("[DrawingTools] Mise à jour visuelle des sections reçue:",$e.detail),Qt.value=JSON.parse(JSON.stringify($e.detail.sections)))},"DrawingTools")},_e=$e=>{t("handleShapeSelection",()=>{var Gt;if(console.log("[DrawingTools] Événement de sélection de forme reçu:",$e.detail),(Gt=$e.detail)!=null&&Gt.shape){const Dn=$e.detail.shape,Ln={type:$e.detail.type,properties:Dn.properties,layer:Dn};_("tool-change",""),_("shape-selected",Ln),console.log("[DrawingTools] Forme sélectionnée:",{type:Ln.type,properties:Ln.properties,layer:Ln.layer})}},"DrawingTools")};window.addEventListener("section:visual-update",de),window.addEventListener("select:shape",_e),Qu(()=>{window.removeEventListener("section:visual-update",de),window.removeEventListener("select:shape",_e)})});const qt=de=>{if(!de)return!1;if(de.startAngle===de.endAngle)return!0;const _e=(de.endAngle-de.startAngle+360)%360;return _e<2||_e>358},mn=de=>{if(!de)return;const _e={...de,startAngle:0,endAngle:360};it(de.id,_e)},xn=Yt(0),wn=Yt(0),ot=()=>{if(!w.value||!m.selectedShape||!m.selectedShape.layer){console.warn("[DrawingTools] Impossible de mettre à jour les dimensions: données manquantes");return}console.log("[DrawingTools] Début de mise à jour des dimensions du rectangle:",{width:xn.value,height:wn.value,shape:m.selectedShape});const de=parseFloat(Number(xn.value).toFixed(2)),_e=parseFloat(Number(wn.value).toFixed(2));m.selectedShape.layer.setDimensions?(console.log("[DrawingTools] Appel de setDimensions avec:",{width:de,height:_e}),m.selectedShape.layer.setDimensions(de,_e),m.selectedShape.layer.fire&&(console.log("[DrawingTools] Émission de l'événement coordinates:updated pour forcer la mise à jour des points de contrôle"),m.selectedShape.layer.fire("coordinates:updated",{corners:m.selectedShape.layer.getRotatedCorners(),center:m.selectedShape.layer.getCenter(),rotation:m.selectedShape.layer.getRotation()})),w.value&&(w.value.width=de,w.value.height=_e,w.value.surface=de*_e,console.log("[DrawingTools] Propriétés locales mises à jour:",w.value))):(console.warn("[DrawingTools] Selected shape does not support setDimensions method"),_("properties-update",{width:de,height:_e}))};return Ur(()=>w.value,de=>{de&&de.type==="Rectangle"&&(xn.value=de.width?Number(de.width.toFixed(2)):0,wn.value=de.height?Number(de.height.toFixed(2)):0)},{immediate:!0,deep:!0}),(de,_e)=>(et(),rt("div",_8,[_e[106]||(_e[106]=A("div",{class:"p-3 bg-gray-50 border-b border-gray-200"},[A("h3",{class:"text-sm font-semibold text-gray-700"},"Outils de dessin")],-1)),A("div",b8,[A("div",w8,[(et(!0),rt(Vn,null,$i(ut.filter($e=>$e.type!=="delete"),$e=>(et(),rt("button",{key:$e.type,class:Jr(["flex items-center justify-center p-2 rounded border",{"bg-blue-50 border-blue-200 text-blue-700":de.currentTool===$e.type}]),onClick:Gt=>de.$emit("tool-change",de.currentTool===$e.type?"":$e.type),title:$e.label},[A("span",{class:"icon",innerHTML:Te($e.type)},null,8,L8)],10,x8))),128))]),de.selectedShape?(et(),rt("button",{key:0,class:Jr(["w-full mt-2 p-2 rounded border border-red-200 bg-red-50 text-red-600 hover:bg-red-100",{"bg-red-100":de.currentTool==="delete"}]),onClick:_e[0]||(_e[0]=$e=>de.$emit("delete-shape")),title:"Supprimer la forme"},_e[39]||(_e[39]=[A("svg",{class:"w-4 h-4 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),2)):Cn("",!0)]),de.selectedShape&&w.value?(et(),rt("div",C8,[A("div",S8,[A("button",{class:"flex items-center justify-between w-full text-sm font-semibold text-gray-700",onClick:_e[1]||(_e[1]=$e=>he("style"))},[_e[41]||(_e[41]=A("span",null,"Style",-1)),(et(),rt("svg",{class:Jr(["w-4 h-4",{"rotate-180":!H.value.style}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},_e[40]||(_e[40]=[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))])]),zn(A("div",P8,[A("div",E8,[(et(),rt(Vn,null,$i(X,$e=>A("button",{key:$e,class:"w-8 h-8 rounded-full",style:_c({backgroundColor:$e}),onClick:Gt=>re($e),title:$e},null,12,A8)),64))]),w.value.type!=="TextRectangle"?(et(),rt("div",k8,[A("div",M8,[_e[42]||(_e[42]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Contour",-1)),A("div",T8,[zn(A("input",{type:"color","onUpdate:modelValue":_e[2]||(_e[2]=$e=>Q.value=$e),class:"w-16 h-8 rounded border",onChange:_e[3]||(_e[3]=$e=>ee({strokeColor:Q.value})),title:"Couleur du contour"},null,544),[[Ui,Q.value]]),zn(A("input",{type:"range","onUpdate:modelValue":_e[4]||(_e[4]=$e=>F.value=$e),min:"1",max:"10",class:"w-16 h-2 rounded-md",onChange:_e[5]||(_e[5]=$e=>ee({strokeWidth:F.value})),title:"Épaisseur du contour"},null,544),[[Ui,F.value]])])]),A("div",B8,[_e[43]||(_e[43]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Style",-1)),zn(A("select",{"onUpdate:modelValue":_e[6]||(_e[6]=$e=>V.value=$e),class:"w-full rounded border",onChange:_e[7]||(_e[7]=$e=>ee({strokeStyle:V.value}))},[(et(),rt(Vn,null,$i(ke,$e=>A("option",{key:$e.value,value:$e.value},Jt($e.label),9,N8)),64))],544),[[Ks,V.value]])]),W.value?(et(),rt("div",D8,[_e[44]||(_e[44]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Remplir",-1)),A("div",R8,[zn(A("input",{type:"color","onUpdate:modelValue":_e[8]||(_e[8]=$e=>D.value=$e),class:"w-16 h-8 rounded border",onChange:_e[9]||(_e[9]=$e=>ee({fillColor:D.value})),title:"Couleur de remplissage"},null,544),[[Ui,D.value]]),zn(A("input",{type:"range","onUpdate:modelValue":_e[10]||(_e[10]=$e=>j.value=$e),min:"0",max:"1",step:"0.1",class:"w-16 h-2 rounded-md",onChange:_e[11]||(_e[11]=$e=>ee({fillOpacity:j.value})),title:"Opacité du remplissage"},null,544),[[Ui,j.value]])])])):Cn("",!0)])):Cn("",!0),w.value.type==="TextRectangle"?(et(),rt("div",O8,[A("div",I8,[_e[45]||(_e[45]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Contour",-1)),A("div",F8,[zn(A("input",{type:"color","onUpdate:modelValue":_e[12]||(_e[12]=$e=>Q.value=$e),class:"w-16 h-8 rounded border",onChange:_e[13]||(_e[13]=$e=>ee({strokeColor:Q.value})),title:"Couleur du contour"},null,544),[[Ui,Q.value]]),zn(A("input",{type:"range","onUpdate:modelValue":_e[14]||(_e[14]=$e=>F.value=$e),min:"1",max:"10",class:"w-16 h-2 rounded-md",onChange:_e[15]||(_e[15]=$e=>ee({strokeWidth:F.value})),title:"Épaisseur du contour"},null,544),[[Ui,F.value]])])]),A("div",z8,[_e[46]||(_e[46]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Remplir",-1)),A("div",j8,[zn(A("input",{type:"color","onUpdate:modelValue":_e[16]||(_e[16]=$e=>D.value=$e),class:"w-16 h-8 rounded border",onChange:_e[17]||(_e[17]=$e=>ee({fillColor:D.value})),title:"Couleur de remplissage"},null,544),[[Ui,D.value]]),zn(A("input",{type:"range","onUpdate:modelValue":_e[18]||(_e[18]=$e=>j.value=$e),min:"0",max:"1",step:"0.1",class:"w-16 h-2 rounded-md",onChange:_e[19]||(_e[19]=$e=>ee({fillOpacity:j.value})),title:"Opacité du remplissage"},null,544),[[Ui,j.value]])])]),A("div",U8,[_e[47]||(_e[47]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Texte",-1)),A("div",$8,[zn(A("input",{type:"color","onUpdate:modelValue":_e[20]||(_e[20]=$e=>pe.value=$e),class:"w-16 h-8 rounded border",onChange:_e[21]||(_e[21]=$e=>oe({textColor:pe.value})),title:"Couleur du texte"},null,544),[[Ui,pe.value]])])]),A("div",q8,[_e[49]||(_e[49]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Taille",-1)),A("div",G8,[zn(A("select",{"onUpdate:modelValue":_e[22]||(_e[22]=$e=>O.value=$e),class:"w-full rounded border",onChange:_e[23]||(_e[23]=$e=>oe({fontSize:O.value}))},_e[48]||(_e[48]=[Cc('<option value="10px" data-v-f05b2cd1>Très petit</option><option value="12px" data-v-f05b2cd1>Petit</option><option value="14px" data-v-f05b2cd1>Normal</option><option value="16px" data-v-f05b2cd1>Moyen</option><option value="18px" data-v-f05b2cd1>Grand</option><option value="24px" data-v-f05b2cd1>Très grand</option><option value="32px" data-v-f05b2cd1>Énorme</option>',7)]),544),[[Ks,O.value]])])]),A("div",V8,[_e[51]||(_e[51]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Police",-1)),A("div",H8,[zn(A("select",{"onUpdate:modelValue":_e[24]||(_e[24]=$e=>Ee.value=$e),class:"w-full rounded border",onChange:_e[25]||(_e[25]=$e=>oe({fontFamily:Ee.value}))},_e[50]||(_e[50]=[Cc('<option value="Arial, sans-serif" data-v-f05b2cd1>Arial</option><option value="&#39;Times New Roman&#39;, serif" data-v-f05b2cd1>Times</option><option value="&#39;Courier New&#39;, monospace" data-v-f05b2cd1>Courier</option><option value="Georgia, serif" data-v-f05b2cd1>Georgia</option><option value="Verdana, sans-serif" data-v-f05b2cd1>Verdana</option>',5)]),544),[[Ks,Ee.value]])])]),A("div",W8,[_e[52]||(_e[52]=A("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Align.",-1)),A("div",Z8,[(et(),rt(Vn,null,$i(B,$e=>A("button",{key:$e.value,class:Jr(["flex items-center justify-center p-2 rounded border",{"bg-blue-50 border-blue-200 text-blue-700":I.value===$e.value}]),onClick:Gt=>oe({textAlign:$e.value}),title:$e.label},[A("span",{innerHTML:$e.icon},null,8,J8)],10,K8)),64)),A("button",{class:Jr(["flex items-center justify-center p-2 rounded border",{"bg-blue-50 border-blue-200 text-blue-700":nt.value}]),onClick:Se,title:"Gras"}," B ",2),A("button",{class:Jr(["flex items-center justify-center p-2 rounded border",{"bg-blue-50 border-blue-200 text-blue-700":We.value}]),onClick:te,title:"Italique"}," I ",2)])])])):Cn("",!0)],512),[[_f,!H.value.style]])])):Cn("",!0),de.selectedShape&&w.value&&w.value.type!=="TextRectangle"?(et(),rt("div",Y8,[A("button",{class:"flex items-center justify-between w-full text-sm font-semibold text-gray-700",onClick:_e[26]||(_e[26]=$e=>he("properties"))},[_e[54]||(_e[54]=A("span",null,"Propriétés",-1)),(et(),rt("svg",{class:Jr(["w-4 h-4",{"rotate-180":!H.value.properties}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},_e[53]||(_e[53]=[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),zn(A("div",X8,[w.value?(et(),rt("div",Q8,[A("div",eT,[_e[55]||(_e[55]=A("label",{for:"shapeName",class:"block text-sm font-medium text-gray-700 mb-1"},"Nom de la forme",-1)),zn(A("input",{type:"text",id:"shapeName","onUpdate:modelValue":_e[27]||(_e[27]=$e=>b.value=$e),onChange:Ht,placeholder:"Donnez un nom à cette forme",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"},null,544),[[Ui,b.value]])]),A("div",tT,[w.value.type==="Circle"?(et(),rt("div",nT,[A("div",iT,[_e[56]||(_e[56]=A("span",{class:"text-sm font-semibold text-gray-700"},"Rayon :",-1)),A("span",rT,Jt(ae(w.value.radius||0)),1)]),A("div",sT,[_e[57]||(_e[57]=A("span",{class:"text-sm font-semibold text-gray-700"},"Surface :",-1)),A("span",oT,Jt(Le(w.value.surface||0)),1)]),A("div",aT,[_e[58]||(_e[58]=A("span",{class:"text-sm font-semibold text-gray-700"},"Surface totale d'irrigation :",-1)),A("span",lT,Jt(Le(tt.value||0)),1)])])):w.value.type==="CircleWithSections"?(et(),rt("div",uT,[A("div",cT,[_e[59]||(_e[59]=A("span",{class:"text-sm font-semibold text-gray-700"},"Rayon total :",-1)),A("span",hT,Jt(ae(w.value.radius||0)),1)]),A("div",fT,[_e[60]||(_e[60]=A("span",{class:"text-sm font-semibold text-gray-700"},"Surface totale :",-1)),A("span",dT,Jt(Le(w.value.surface||0)),1)]),A("div",pT,[_e[61]||(_e[61]=A("span",{class:"text-sm font-semibold text-gray-700"},"Surface des sections :",-1)),A("span",gT,Jt(Le(w.value.sectionArea||0)),1)]),A("div",mT,[_e[62]||(_e[62]=A("span",{class:"text-sm font-semibold text-gray-700"},"Nombre de sections :",-1)),A("span",vT,Jt(Qt.value.length),1)])])):w.value.type==="Rectangle"?(et(),rt("div",yT,[A("div",_T,[_e[64]||(_e[64]=A("label",{for:"rectangle-width",class:"text-sm font-semibold text-gray-700 w-20"},"Largeur :",-1)),A("div",bT,[zn(A("input",{id:"rectangle-width",type:"number","onUpdate:modelValue":_e[28]||(_e[28]=$e=>xn.value=$e),min:"1",step:"0.01",class:"w-full px-2 py-1 border border-gray-300 rounded-md text-sm",onChange:ot},null,544),[[Ui,xn.value]]),_e[63]||(_e[63]=A("span",{class:"text-sm text-gray-500 ml-1"},"m",-1))])]),A("div",wT,[_e[66]||(_e[66]=A("label",{for:"rectangle-height",class:"text-sm font-semibold text-gray-700 w-20"},"Hauteur :",-1)),A("div",xT,[zn(A("input",{id:"rectangle-height",type:"number","onUpdate:modelValue":_e[29]||(_e[29]=$e=>wn.value=$e),min:"1",step:"0.01",class:"w-full px-2 py-1 border border-gray-300 rounded-md text-sm",onChange:ot},null,544),[[Ui,wn.value]]),_e[65]||(_e[65]=A("span",{class:"text-sm text-gray-500 ml-1"},"m",-1))])]),A("div",LT,[_e[67]||(_e[67]=A("span",{class:"text-sm font-semibold text-gray-700"},"Surface :",-1)),A("span",CT,Jt(Le(w.value.surface||0)),1)]),A("div",ST,[_e[68]||(_e[68]=A("span",{class:"text-sm font-semibold text-gray-700"},"Surface totale d'irrigation :",-1)),A("span",PT,Jt(Le(tt.value||0)),1)])])):w.value.type==="Semicircle"?(et(),rt("div",ET,[A("div",AT,[_e[69]||(_e[69]=A("span",{class:"text-sm font-semibold text-gray-700"},"Rayon :",-1)),A("span",kT,Jt(ae(w.value.radius||0)),1)]),A("div",MT,[_e[70]||(_e[70]=A("span",{class:"text-sm font-semibold text-gray-700"},"Surface :",-1)),A("span",TT,Jt(Le(w.value.surface||0)),1)]),A("div",BT,[_e[71]||(_e[71]=A("span",{class:"text-sm font-semibold text-gray-700"},"Surface totale d'irrigation :",-1)),A("span",NT,Jt(Le(tt.value||0)),1)]),A("div",DT,[_e[72]||(_e[72]=A("span",{class:"text-sm font-semibold text-gray-700"},"Angle :",-1)),A("span",RT,Jt(Math.round(w.value.openingAngle||0))+"°",1)])])):w.value.type==="Line"?(et(),rt(Vn,{key:4},[_e[73]||(_e[73]=A("span",{class:"text-sm font-semibold text-gray-700"},"Longueur :",-1)),A("span",OT,Jt(ae(w.value.length||0)),1)],64)):w.value.type==="Polygon"?(et(),rt("div",IT,[A("div",FT,[_e[74]||(_e[74]=A("span",{class:"text-sm font-semibold text-gray-700"},"Surface :",-1)),A("span",zT,Jt(Le(w.value.surface||0)),1)]),A("div",jT,[_e[75]||(_e[75]=A("span",{class:"text-sm font-semibold text-gray-700"},"Surface totale d'irrigation :",-1)),A("span",UT,Jt(Le(tt.value||0)),1)]),A("div",$T,[_e[76]||(_e[76]=A("span",{class:"text-sm font-semibold text-gray-700"},"Périmètre :",-1)),A("span",qT,Jt(ae(w.value.perimeter||0)),1)])])):w.value.type==="ElevationLine"?(et(),rt(Vn,{key:6},[A("div",GT,[A("div",VT,[_e[77]||(_e[77]=A("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Distance totale :",-1)),A("span",HT,Jt(ae(w.value.length||0)),1)]),A("div",WT,[_e[78]||(_e[78]=A("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Dénivelé + :",-1)),A("span",ZT,Jt(ae(w.value.elevationGain||0)),1)]),A("div",KT,[_e[79]||(_e[79]=A("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Dénivelé - :",-1)),A("span",JT,Jt(ae(w.value.elevationLoss||0)),1)]),A("div",YT,[_e[80]||(_e[80]=A("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Pente moy. :",-1)),A("span",XT,Jt(Me(w.value.averageSlope||0)),1)]),A("div",QT,[_e[81]||(_e[81]=A("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Pente max :",-1)),A("span",eB,Jt(Me(w.value.maxSlope||0)),1)])]),A("div",{ref_key:"elevationProfileContainer",ref:pt,class:"elevation-profile-container w-full h-48 bg-gray-50 rounded border border-gray-200 relative mt-4",onMousemove:ze,onMouseleave:st},[A("canvas",{ref_key:"elevationCanvas",ref:Oe},null,512)],544)],64)):Cn("",!0)])])):(et(),rt("div",tB," Aucune propriété disponible "))],512),[[_f,!H.value.properties]])])):Cn("",!0),de.selectedShape&&w.value&&w.value.type==="ElevationLine"?(et(),rt("div",nB,[A("button",{class:"flex items-center justify-between w-full text-sm font-semibold text-gray-700",onClick:_e[30]||(_e[30]=$e=>he("samplePoints"))},[_e[83]||(_e[83]=A("span",null,"Points d'échantillonnage",-1)),(et(),rt("svg",{class:Jr(["w-4 h-4",{"rotate-180":!H.value.samplePoints}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},_e[82]||(_e[82]=[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),zn(A("div",iB,[A("div",rB,[_e[88]||(_e[88]=A("h4",{class:"text-sm font-semibold mb-2"},"Points normaux",-1)),A("div",sB,[A("div",null,[_e[84]||(_e[84]=A("label",{class:"text-xs text-gray-600"},"Taille",-1)),zn(A("input",{type:"number","onUpdate:modelValue":_e[31]||(_e[31]=$e=>le.value.radius=$e),min:"2",max:"10",step:"1",class:"w-full px-2 py-1 border rounded",onChange:ye},null,544),[[Ui,le.value.radius]])]),A("div",null,[_e[85]||(_e[85]=A("label",{class:"text-xs text-gray-600"},"Couleur",-1)),zn(A("input",{type:"color","onUpdate:modelValue":_e[32]||(_e[32]=$e=>le.value.color=$e),class:"w-full h-8 px-1 border rounded",onChange:ye},null,544),[[Ui,le.value.color]])]),A("div",null,[_e[86]||(_e[86]=A("label",{class:"text-xs text-gray-600"},"Opacité",-1)),zn(A("input",{type:"range","onUpdate:modelValue":_e[33]||(_e[33]=$e=>le.value.fillOpacity=$e),min:"0",max:"1",step:"0.1",class:"w-full",onChange:ye},null,544),[[Ui,le.value.fillOpacity]])]),A("div",null,[_e[87]||(_e[87]=A("label",{class:"text-xs text-gray-600"},"Bordure",-1)),zn(A("input",{type:"number","onUpdate:modelValue":_e[34]||(_e[34]=$e=>le.value.weight=$e),min:"1",max:"5",step:"1",class:"w-full px-2 py-1 border rounded",onChange:ye},null,544),[[Ui,le.value.weight]])])])]),A("div",null,[_e[92]||(_e[92]=A("h4",{class:"text-sm font-semibold mb-2"},"Points min/max",-1)),A("div",oB,[A("div",null,[_e[89]||(_e[89]=A("label",{class:"text-xs text-gray-600"},"Taille",-1)),zn(A("input",{type:"number","onUpdate:modelValue":_e[35]||(_e[35]=$e=>G.value.radius=$e),min:"4",max:"12",step:"1",class:"w-full px-2 py-1 border rounded",onChange:ue},null,544),[[Ui,G.value.radius]])]),A("div",null,[_e[90]||(_e[90]=A("label",{class:"text-xs text-gray-600"},"Bordure",-1)),zn(A("input",{type:"number","onUpdate:modelValue":_e[36]||(_e[36]=$e=>G.value.weight=$e),min:"1",max:"5",step:"1",class:"w-full px-2 py-1 border rounded",onChange:ue},null,544),[[Ui,G.value.weight]])]),A("div",null,[_e[91]||(_e[91]=A("label",{class:"text-xs text-gray-600"},"Opacité",-1)),zn(A("input",{type:"range","onUpdate:modelValue":_e[37]||(_e[37]=$e=>G.value.fillOpacity=$e),min:"0",max:"1",step:"0.1",class:"w-full",onChange:ue},null,544),[[Ui,G.value.fillOpacity]])])])])],512),[[_f,!H.value.samplePoints]])])):Cn("",!0),de.selectedShape&&w.value&&w.value.type==="CircleWithSections"?(et(),rt("div",aB,[A("button",{class:"flex items-center justify-between w-full text-sm font-semibold text-gray-700",onClick:_e[38]||(_e[38]=$e=>he("circleSections"))},[_e[94]||(_e[94]=A("span",null,"Sections",-1)),(et(),rt("svg",{class:Jr(["w-4 h-4",{"rotate-180":!H.value.circleSections}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},_e[93]||(_e[93]=[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),zn(A("div",lB,[A("div",{class:"flex justify-between items-center mb-3"},[_e[96]||(_e[96]=A("h4",{class:"text-sm font-semibold"},"Sections d'irrigation",-1)),A("button",{class:"p-1 rounded-full bg-blue-500 text-white hover:bg-blue-600",onClick:rn,title:"Ajouter une section"},_e[95]||(_e[95]=[A("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)]))]),Qt.value.length>0?(et(),rt("div",uB,[(et(!0),rt(Vn,null,$i(Qt.value,$e=>(et(),rt("div",{key:$e.id,class:"border rounded p-2 relative"},[A("div",{class:"absolute top-0 left-0 w-1 h-full",style:_c({backgroundColor:$e.color})},null,4),A("div",cB,[A("div",hB,[A("div",fB,[zn(A("input",{type:"text","onUpdate:modelValue":Gt=>$e.name=Gt,class:"w-full font-medium px-2 py-1 border border-gray-200 focus:border-blue-300 rounded text-sm truncate text-ellipsis",onChange:Gt=>it($e.id,{name:$e.name})},null,40,dB),[[Ui,$e.name]])]),A("button",{class:"text-red-500 hover:text-red-700 p-1 rounded hover:bg-red-50 flex-shrink-0",onClick:Gt=>Ke($e.id),title:"Supprimer la section"},_e[97]||(_e[97]=[A("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,pB)]),A("div",gB,[A("div",mB,[_e[98]||(_e[98]=A("label",{class:"text-xs text-gray-600 block truncate"},"Angle début",-1)),zn(A("input",{type:"number","onUpdate:modelValue":Gt=>$e.startAngle=Gt,min:"0",max:"360",step:"5",class:"w-full px-2 py-1 border rounded text-sm",onChange:Gt=>it($e.id,{startAngle:$e.startAngle})},null,40,vB),[[Ui,$e.startAngle,void 0,{number:!0}]])]),A("div",yB,[_e[99]||(_e[99]=A("label",{class:"text-xs text-gray-600 block truncate"},"Angle fin",-1)),zn(A("input",{type:"number","onUpdate:modelValue":Gt=>$e.endAngle=Gt,min:"0",max:"360",step:"5",class:"w-full px-2 py-1 border rounded text-sm",onChange:Gt=>it($e.id,{endAngle:$e.endAngle})},null,40,_B),[[Ui,$e.endAngle,void 0,{number:!0}]])]),A("div",bB,[_e[100]||(_e[100]=A("label",{class:"text-xs text-gray-600 block truncate"},"Rayon (m)",-1)),zn(A("input",{type:"number","onUpdate:modelValue":Gt=>$e.radius=Gt,min:1,step:"1",class:"w-full px-2 py-1 border rounded text-sm",onChange:Gt=>it($e.id,{radius:$e.radius})},null,40,wB),[[Ui,$e.radius,void 0,{number:!0}]])]),A("div",xB,[_e[101]||(_e[101]=A("label",{class:"text-xs text-gray-600 block truncate"},"Surface",-1)),A("div",LB,Jt(Le(Math.PI*$e.radius*$e.radius*($e.endAngle-$e.startAngle)/360||0)),1)]),A("div",CB,[_e[102]||(_e[102]=A("label",{class:"text-xs text-gray-600 block truncate"},"Couleur",-1)),zn(A("input",{type:"color","onUpdate:modelValue":Gt=>$e.color=Gt,class:"w-full h-8 px-1 border rounded",onChange:Gt=>it($e.id,{color:$e.color})},null,40,SB),[[Ui,$e.color]])])]),A("div",PB,[qt($e)?(et(),rt("div",{key:0,class:"absolute h-full w-full",style:_c({backgroundColor:$e.color,opacity:.5})},null,4)):(et(),rt("div",{key:1,class:"absolute h-full",style:_c({backgroundColor:$e.color,opacity:.5,left:$e.startAngle/360*100+"%",width:($e.endAngle-$e.startAngle+360)%360/360*100+"%"})},null,4)),qt($e)?Cn("",!0):(et(),rt("button",{key:2,class:"absolute right-0 top-0 p-0.5 text-xs text-gray-500 hover:text-gray-700 z-10",title:"Faire un cercle complet",onClick:Gt=>mn($e)},_e[103]||(_e[103]=[A("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)]),8,EB)),_e[104]||(_e[104]=Cc('<div class="absolute h-full w-px bg-gray-400 left-0" data-v-f05b2cd1></div><div class="absolute h-full w-px bg-gray-400 left-25%" data-v-f05b2cd1></div><div class="absolute h-full w-px bg-gray-400 left-50%" data-v-f05b2cd1></div><div class="absolute h-full w-px bg-gray-400 left-75%" data-v-f05b2cd1></div><div class="absolute h-full w-px bg-gray-400 right-0" data-v-f05b2cd1></div><div class="absolute text-xs bottom-0 left-0 text-gray-600" data-v-f05b2cd1>0°</div><div class="absolute text-xs bottom-0 left-25% -ml-2 text-gray-600" data-v-f05b2cd1>90°</div><div class="absolute text-xs bottom-0 left-50% -ml-2 text-gray-600" data-v-f05b2cd1>180°</div><div class="absolute text-xs bottom-0 left-75% -ml-2 text-gray-600" data-v-f05b2cd1>270°</div><div class="absolute text-xs bottom-0 right-0 -mr-6 text-gray-600" data-v-f05b2cd1>360°</div>',10))]),qt($e)?(et(),rt("div",AB," Cercle complet (360°) ")):Cn("",!0)])]))),128))])):(et(),rt("div",kB,_e[105]||(_e[105]=[Ir(" Aucune section d'irrigation définie. "),A("br",null,null,-1),Ir(" Cliquez sur le bouton + pour en ajouter. ")])))],512),[[_f,!H.value.circleSections]])])):Cn("",!0)]))}}),TB=bm(MB,[["__scopeId","data-v-f05b2cd1"]]),BB={class:"map-toolbar w-full"},NB={class:"hidden md:flex items-center space-x-2"},DB={class:"dropdown"},RB={class:"dropdown-menu"},OB=["onClick"],IB={key:0,class:"border-l pl-2 flex-1"},FB={class:"flex items-center"},zB={class:"plan-info"},jB={class:"plan-name"},UB={key:0,class:"plan-description"},$B={class:"border-l pl-2 ml-auto"},qB={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},GB={key:1,class:"h-4 w-4 mr-2 text-primary-600",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},VB={key:"saving"},HB={key:"success",class:"save-success-text"},WB={key:"default"},ZB={class:"md:hidden"},KB={class:"flex justify-between items-center"},JB={key:0,class:"truncate mx-2 text-sm font-medium"},YB={key:0,class:"mobile-menu mt-2 bg-white shadow-md rounded p-2 z-50"},XB={class:"flex flex-col space-y-2"},QB={key:0,class:"flex flex-col pb-2 border-b"},e7={class:"text-sm font-semibold text-gray-800"},t7={key:0,class:"text-xs text-gray-600 mt-1"},n7={class:"flex flex-col"},i7={class:"grid grid-cols-2 gap-1"},r7=["onClick"],s7={key:0,class:"animate-spin h-3 w-3 mr-1 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},o7={key:1,class:"h-3 w-3 mr-1 text-primary-600",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},a7={key:"saving"},l7={key:"success",class:"save-success-text"},u7={key:"default"},c7=Pa({__name:"MapToolbar",props:{lastSave:{},planName:{},planDescription:{},saveStatus:{}},emits:["change-map-type","create-new-plan","load-plan","save-plan","adjust-view","generate-summary"],setup(e,{emit:n}){const t=n,i=e,r=Yt("Ville"),o=Yt(!1),l=Q=>{const F=Q.currentTarget,V=F.nextElementSibling;if(V&&V.classList.contains("dropdown-menu")){const pe=F.getBoundingClientRect();V.style.top=`${pe.bottom}px`,V.style.left=`${pe.left}px`}},h={Ville:"Ville",Satellite:"Satellite",Cadastre:"Cadastre"},p=Di(()=>i.lastSave?new Date(i.lastSave).toLocaleString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Jamais"),m=Q=>{r.value=Q,t("change-map-type",Q),j()},_=()=>{t("create-new-plan"),j()},w=()=>{t("load-plan"),j()},E=()=>{t("save-plan"),j()},b=()=>{t("adjust-view"),j()},D=()=>{t("generate-summary"),j()},j=()=>{o.value=!1};return(Q,F)=>(et(),rt("div",BB,[A("div",NB,[A("div",DB,[A("button",{class:"btn-toolbar dropdown-toggle",onMouseover:l},[F[1]||(F[1]=A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M12 1.586l-4 4V17h8V5.586l-4-4zM2 17V9.276l4-3.638V17H2zM2 8.162V3h4.5L12 8.5V17H6V5.638L2 8.162z","clip-rule":"evenodd"})],-1)),A("span",null,Jt(h[r.value]),1)],32),A("div",RB,[(et(),rt(Vn,null,$i(h,(V,pe)=>A("button",{key:pe,class:Jr(["dropdown-item",{active:pe===r.value}]),onClick:Ee=>m(pe)},Jt(V),11,OB)),64))])]),Q.planName?(et(),rt("div",IB,[A("div",FB,[A("div",zB,[A("h2",jB,Jt(Q.planName),1),Q.planDescription?(et(),rt("p",UB,Jt(Q.planDescription),1)):Cn("",!0)])])])):Cn("",!0),A("div",{class:"border-l pl-2"},[A("div",{class:"flex items-center space-x-1"},[A("button",{onClick:_,class:"btn-toolbar",title:"Nouveau plan"},F[2]||(F[2]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V8z","clip-rule":"evenodd"})],-1),A("span",{class:"hidden lg:inline ml-1"},"Nouveau",-1)])),A("button",{onClick:w,class:"btn-toolbar",title:"Charger un plan"},F[3]||(F[3]=[Cc('<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" data-v-206c3e68><path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" data-v-206c3e68></path><path d="M10 9a1 1 0 011-1h5a1 1 0 110 2h-5a1 1 0 01-1-1z" data-v-206c3e68></path><path fill-rule="evenodd" d="M13 5a1 1 0 011 1v4a1 1 0 11-2 0V6a1 1 0 011-1z" clip-rule="evenodd" data-v-206c3e68></path></svg><span class="hidden lg:inline ml-1" data-v-206c3e68>Charger</span>',2)])),A("button",{onClick:E,class:"btn-toolbar",title:"Enregistrer le plan"},F[4]||(F[4]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6h5a2 2 0 012 2v7a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2h5v5.586l-1.293-1.293zM9 4a1 1 0 012 0v2H9V4z"})],-1),A("span",{class:"hidden lg:inline ml-1"},"Enregistrer",-1)]))])]),A("div",{class:"border-l pl-2"},[A("div",{class:"flex items-center space-x-1"},[A("button",{onClick:b,class:"btn-toolbar",title:"Ajuster la vue"},F[5]||(F[5]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1),A("span",{class:"hidden lg:inline ml-1"},"Ajuster",-1)])),A("button",{onClick:D,class:"btn-toolbar",title:"Générer une synthèse"},F[6]||(F[6]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})],-1),A("span",{class:"hidden lg:inline ml-1"},"Synthèse",-1)]))])]),A("div",$B,[A("div",{class:Jr(["text-xs hidden lg:flex items-center",{"text-gray-500":!Q.saveStatus,"text-primary-600 font-medium":Q.saveStatus==="success","text-blue-600 font-medium":Q.saveStatus==="saving"}])},[Q.saveStatus==="saving"?(et(),rt("svg",qB,F[7]||(F[7]=[A("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),A("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):Cn("",!0),Q.saveStatus==="success"?(et(),rt("svg",GB,F[8]||(F[8]=[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):Cn("",!0),$r(sp,{name:"fade-slide",mode:"out-in"},{default:Kl(()=>[Q.saveStatus==="saving"?(et(),rt("span",VB," Sauvegarde en cours... ")):Q.saveStatus==="success"?(et(),rt("span",HB," Sauvegarde réussie ! ")):(et(),rt("span",WB," Dernière modification : "+Jt(p.value),1))]),_:1})],2)])]),A("div",ZB,[A("div",KB,[A("button",{onClick:F[0]||(F[0]=V=>o.value=!o.value),class:"p-1 rounded border"},F[9]||(F[9]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-600",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})],-1)])),Q.planName?(et(),rt("div",JB,Jt(Q.planName),1)):Cn("",!0),A("div",{class:"flex space-x-1"},[A("button",{onClick:_,class:"p-1 rounded border bg-white"},F[10]||(F[10]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V8z","clip-rule":"evenodd"})],-1)])),A("button",{onClick:E,class:"p-1 rounded border bg-white"},F[11]||(F[11]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6h5a2 2 0 012 2v7a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2h5v5.586l-1.293-1.293zM9 4a1 1 0 012 0v2H9V4z"})],-1)])),A("button",{onClick:b,class:"p-1 rounded border bg-white"},F[12]||(F[12]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1)]))])]),o.value?(et(),rt("div",YB,[A("div",XB,[Q.planName?(et(),rt("div",QB,[A("h3",e7,Jt(Q.planName),1),Q.planDescription?(et(),rt("p",t7,Jt(Q.planDescription),1)):Cn("",!0)])):Cn("",!0),A("div",n7,[F[13]||(F[13]=A("span",{class:"text-xs font-medium text-gray-500 mb-1"},"Type de carte",-1)),A("div",i7,[(et(),rt(Vn,null,$i(h,(V,pe)=>A("button",{key:pe,class:Jr(["px-2 py-1 text-xs rounded border",{"bg-blue-50 border-blue-200 text-blue-700":pe===r.value}]),onClick:Ee=>m(pe)},Jt(V),11,r7)),64))])]),A("div",{class:"flex flex-col"},[F[16]||(F[16]=A("span",{class:"text-xs font-medium text-gray-500 mb-1"},"Outils de plan",-1)),A("div",{class:"grid grid-cols-2 gap-1"},[A("button",{onClick:w,class:"px-2 py-1 text-xs rounded border flex items-center justify-center"},F[14]||(F[14]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z","clip-rule":"evenodd"}),A("path",{d:"M10 9a1 1 0 011-1h5a1 1 0 110 2h-5a1 1 0 01-1-1z"}),A("path",{"fill-rule":"evenodd",d:"M13 5a1 1 0 011 1v4a1 1 0 11-2 0V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),Ir(" Charger ")])),A("button",{onClick:D,class:"px-2 py-1 text-xs rounded border flex items-center justify-center"},F[15]||(F[15]=[A("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})],-1),Ir(" Synthèse ")]))])]),A("div",{class:Jr(["text-xs text-center pt-1 border-t flex items-center justify-center space-x-1",{"text-gray-500":!Q.saveStatus,"text-primary-600 font-medium":Q.saveStatus==="success","text-blue-600 font-medium":Q.saveStatus==="saving"}])},[Q.saveStatus==="saving"?(et(),rt("svg",s7,F[17]||(F[17]=[A("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),A("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):Cn("",!0),Q.saveStatus==="success"?(et(),rt("svg",o7,F[18]||(F[18]=[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):Cn("",!0),$r(sp,{name:"fade-slide",mode:"out-in"},{default:Kl(()=>[Q.saveStatus==="saving"?(et(),rt("span",a7," Sauvegarde en cours... ")):Q.saveStatus==="success"?(et(),rt("span",l7," Sauvegarde réussie ! ")):(et(),rt("span",u7," Dernière modification : "+Jt(p.value),1))]),_:1})],2)])])):Cn("",!0)])]))}}),h7=bm(c7,[["__scopeId","data-v-206c3e68"]]);function f7(){const{isEnabled:e,startMeasure:n}=hh(),t=Yt(null),i=Yt(""),r=Yt("Ville"),o=Yt(null),l=n("createBaseMaps","useMapState"),h={Ville:St.tileLayer("/osm_tiles/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:4,maxNativeZoom:18,tileSize:256,zoomOffset:0,bounds:St.latLngBounds(St.latLng(41.333,-5.566),St.latLng(51.089,9.555)),crossOrigin:!0,detectRetina:!0}),Satellite:St.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"© Esri",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:4,maxNativeZoom:18,tileSize:256,zoomOffset:0,bounds:St.latLngBounds(St.latLng(41.333,-5.566),St.latLng(51.089,9.555)),crossOrigin:!0,detectRetina:!0}),Cadastre:St.tileLayer("https://data.geopf.fr/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=CADASTRALPARCELS.PARCELLAIRE_EXPRESS&STYLE=normal&FORMAT=image/png&TILEMATRIXSET=PM&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}",{attribution:"Cadastre - Carte © IGN/Geoportail",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:4,maxNativeZoom:18,tileSize:256,zoomOffset:0,bounds:St.latLngBounds(St.latLng(41.333,-5.566),St.latLng(51.089,9.555)),crossOrigin:!0,detectRetina:!0})};l();const p=At.createPerformanceTracker(E=>{At.measure("initMap:setOptions",()=>{t.value=E,E.options.zoomSnap=.25,E.options.zoomDelta=.25,E.options.wheelPxPerZoomLevel=100,E.options.zoomAnimation=!0,E.options.fadeAnimation=!0,E.options.markerZoomAnimation=!0,E.options.minZoom=2,E.options.maxZoom=19,E.options.scrollWheelZoom=!0,E.options.doubleClickZoom=!0;const b=St.latLngBounds(St.latLng(-90,-180),St.latLng(90,180));E.setMaxBounds(b),E.options.maxBoundsViscosity=1,E.options.trackResize=!0;let D=null,j=E.getZoom();E.on("zoomstart",()=>{D&&clearTimeout(D),E.options.zoomAnimation=!1,E.options.markerZoomAnimation=!1,j=E.getZoom()}),E.on("zoom",()=>{const F=E.getZoom();F<j-2&&E.invalidateSize({animate:!1,pan:!1}),j=F}),E.on("zoomend",()=>{D&&clearTimeout(D),D=setTimeout(()=>{setTimeout(()=>{E.options.zoomAnimation=!0,E.options.markerZoomAnimation=!0,E.invalidateSize({animate:!1,pan:!1});const F=E.getBounds(),V=E.options.maxBounds;V&&!F.intersects(V)&&E.panInsideBounds(V,{animate:!1})},250)},250)});const Q=E._zoomAnimation;Q&&(E._zoomAnimation=function(F){try{this._animatingZoom||Q.call(this,F)}catch{console.warn("Animation de zoom interrompue, restauration de la vue..."),this._resetView(this.getCenter(),this.getZoom())}})},"useMapState"),At.measure("initMap:addInitialLayer",()=>{o.value=h[r.value],o.value.addTo(E)},"useMapState"),E.on("baselayerchange",b=>{const D=n("baselayerchange","useMapState",{layer:b.name});r.value=b.name,o.value=b.layer,D()}),e.value&&(E.on("movestart",()=>{n("mapMove","useMapState",{startCenter:E.getCenter()})}),E.on("moveend",()=>{n("mapMoveEnd","useMapState",{endCenter:E.getCenter()})()}),E.on("tileloadstart",()=>{n("tileLoad","useMapState")}),E.on("tileload",()=>{n("tileLoadEnd","useMapState")()}))},"initMap","useMapState"),m=At.createAsyncPerformanceTracker(async E=>{if(!(!t.value||!h[E]))try{if(r.value===E)return;const b=t.value,D={zoomAnimation:b.options.zoomAnimation,fadeAnimation:b.options.fadeAnimation,markerZoomAnimation:b.options.markerZoomAnimation};b.options.zoomAnimation=!1,b.options.fadeAnimation=!1,b.options.markerZoomAnimation=!1;const j=b.getCenter(),Q=b.getZoom(),F=h[E];if(typeof F.setOpacity=="function"&&F.setOpacity(0),b&&typeof b.addLayer=="function")try{b.addLayer(F)}catch(V){console.warn("Erreur lors de l'ajout de la couche:",V),typeof F.addTo=="function"&&F.addTo(b)}await new Promise(V=>{typeof F.isLoading=="function"&&F.isLoading()?F.once("load",()=>V()):setTimeout(V,100)}),await new Promise(V=>{let pe=1;const Ee=setInterval(()=>{if(pe-=.1,o.value&&typeof o.value.setOpacity=="function"&&o.value.setOpacity(Math.max(0,pe)),typeof F.setOpacity=="function"&&F.setOpacity(Math.max(0,1-pe)),pe<=0){if(clearInterval(Ee),o.value&&b&&typeof b.removeLayer=="function")try{b.removeLayer(o.value)}catch(Ie){console.warn("Erreur lors de la suppression de la couche active:",Ie)}o.value=F,r.value=E,V()}},50)});try{b.setView(j,Q,{animate:!1,duration:0,noMoveStart:!0})}catch(V){console.warn("Erreur lors de la réinitialisation de la vue:",V)}try{b.invalidateSize({animate:!1,pan:!1})}catch(V){console.warn("Erreur lors de l'invalidation de la taille:",V)}await new Promise(V=>setTimeout(V,300)),E!=="Cadastre"&&setTimeout(()=>{try{b.options.fadeAnimation=D.fadeAnimation,setTimeout(()=>{try{b.options.zoomAnimation=D.zoomAnimation,b.options.markerZoomAnimation=D.markerZoomAnimation}catch(V){console.warn("Erreur lors de la restauration des animations:",V)}},500)}catch(V){console.warn("Erreur lors de la restauration des animations:",V)}},500)}catch(b){if(console.error("Erreur lors du changement de carte de base:",b),t.value)try{const D=t.value;D.options.zoomAnimation=!0,D.options.fadeAnimation=!0,D.options.markerZoomAnimation=!0,D.invalidateSize({animate:!1,pan:!1})}catch(D){console.error("Erreur lors de la restauration après échec:",D)}}},"changeBaseMap","useMapState"),_=At.createAsyncPerformanceTracker(async()=>{if(!(!t.value||!i.value))try{const E=await At.measureAsync("searchLocation:fetchData",async()=>await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(i.value)}`),"useMapState"),b=await At.measureAsync("searchLocation:parseResponse",async()=>await E.json(),"useMapState");b&&b.length>0&&At.measure("searchLocation:updateView",()=>{const{lat:D,lon:j}=b[0];t.value.setView([D,j],13,{animate:r.value!=="Cadastre"})},"useMapState")}catch(E){console.error("Erreur lors de la recherche de localisation:",E)}},"searchLocation","useMapState");return{map:t,searchQuery:i,currentBaseMap:r,baseMaps:h,initMap:p,searchLocation:_,changeBaseMap:m,cleanup:()=>{const E=n("cleanup","useMapState");t.value&&(t.value.remove(),t.value=null),o.value&&(o.value=null),E()},isPerformanceEnabled:e}}const Lm=Dp("irrigation",{state:()=>({plans:[],currentPlan:null,loading:!1,error:null,autoSaveInterval:null,unsavedChanges:!1,planHistory:[],performanceMonitor:hh()}),getters:{getPlanById:e=>n=>e.plans.find(t=>t.id===n),hasUnsavedChanges:e=>e.unsavedChanges,getCurrentPlanHistory:e=>e.planHistory},actions:{async fetchPlans(){var t,i;const e=this.performanceMonitor.startMeasure("fetchPlans","IrrigationStore"),n=Va();this.loading=!0;try{let r="/plans/";const o={};n.isConcessionnaire?o.concessionnaire=(t=n.user)==null?void 0:t.id:n.isAgriculteur&&(o.agriculteur=(i=n.user)==null?void 0:i.id);const l=await this.performanceMonitor.measureAsync("fetchPlans_apiCall",()=>ii.get(r,{params:o}),"IrrigationStore");this.plans=l.data}catch(r){throw this.error="Erreur lors du chargement des plans",r}finally{this.loading=!1,e()}},async fetchPlansWithDetails(){var t,i;const e=this.performanceMonitor.startMeasure("fetchPlansWithDetails","IrrigationStore"),n=Va();this.loading=!0;try{let r="/plans/";const o={include_details:!0};n.isConcessionnaire?o.concessionnaire=(t=n.user)==null?void 0:t.id:n.isAgriculteur&&(o.agriculteur=(i=n.user)==null?void 0:i.id);const l=await this.performanceMonitor.measureAsync("fetchPlansWithDetails_apiCall",()=>ii.get(r,{params:o}),"IrrigationStore"),h=this.performanceMonitor.measure("fetchPlansWithDetails_processResponse",()=>l.data.map(p=>({...p,usine:typeof p.usine=="object"?p.usine:null,concessionnaire:typeof p.concessionnaire=="object"?p.concessionnaire:null,agriculteur:typeof p.agriculteur=="object"?p.agriculteur:null})),"IrrigationStore");return this.plans=h,{data:h}}catch(r){throw console.error("[IrrigationStore] Error fetching plans:",r),this.error="Erreur lors du chargement des plans",r}finally{this.loading=!1,e()}},async fetchClientPlans(e){this.loading=!0;try{return(await Pd.getAgriculteurPlans(e)).data}catch(n){throw this.error="Erreur lors du chargement des plans du client",n}finally{this.loading=!1}},async createPlan(e){var i;const n=this.performanceMonitor.startMeasure("createPlan","IrrigationStore");this.clearCurrentPlan(),this.loading=!0;const t=Nf();try{const r=Va();((i=r.user)==null?void 0:i.user_type)==="agriculteur"&&(e={...e,agriculteur:r.user.id,concessionnaire:r.user.concessionnaire,usine:r.user.usine});const o=this.performanceMonitor.measure("createPlan_formatData",()=>({...e,usine:e.usine?typeof e.usine=="object"&&e.usine&&"id"in e.usine?e.usine.id:Number(e.usine):null,concessionnaire:e.concessionnaire?typeof e.concessionnaire=="object"&&e.concessionnaire&&"id"in e.concessionnaire?e.concessionnaire.id:Number(e.concessionnaire):null,agriculteur:e.agriculteur?typeof e.agriculteur=="object"&&e.agriculteur&&"id"in e.agriculteur?e.agriculteur.id:Number(e.agriculteur):null}),"IrrigationStore"),l=await this.performanceMonitor.measureAsync("createPlan_apiCall",()=>Pd.createPlan(o),"IrrigationStore");return this.plans.push(l.data),t.success(`Le plan "${l.data.nom}" a été créé avec succès`),l.data}catch(r){const o=r instanceof Error?r.message:String(r);throw console.error("Error creating plan:",o),this.error=o,t.error(`Erreur lors de la création du plan : ${o}`),r}finally{this.loading=!1,n()}},async createPlanForClient(e,n){this.clearCurrentPlan(),this.loading=!0;try{const t={...e,agriculteur:n},i=await Pd.createPlanForAgriculteur(t);return this.plans.push(i.data),i.data}catch(t){const i=t instanceof Error?t.message:String(t);throw console.error("Error creating plan for client:",i),this.error="Erreur lors de la création du plan pour le client",t}finally{this.loading=!1}},startAutoSave(){this.autoSaveInterval||(this.autoSaveInterval=setInterval(async()=>{this.unsavedChanges&&this.currentPlan&&await this.savePlan(this.currentPlan.id)},3e4))},stopAutoSave(){this.autoSaveInterval&&(clearInterval(this.autoSaveInterval),this.autoSaveInterval=null)},async savePlan(e){const n=this.performanceMonitor.startMeasure("savePlan","IrrigationStore");if(!this.unsavedChanges){console.log("[IrrigationStore][savePlan] Aucun changement à sauvegarder"),n();return}this.loading=!0;try{const t=await this.performanceMonitor.measureAsync("savePlan_apiCall",()=>{var i;return ii.patch(`/plans/${e}/`,{...this.currentPlan,version:((i=this.currentPlan)==null?void 0:i.version)||1})},"IrrigationStore");return this.performanceMonitor.measure("savePlan_updateState",()=>{var r;const i=this.plans.findIndex(o=>o.id===e);i!==-1&&(this.plans[i]=t.data),((r=this.currentPlan)==null?void 0:r.id)===e&&(this.currentPlan=t.data)},"IrrigationStore"),this.unsavedChanges=!1,t.data}catch(t){throw console.error("[IrrigationStore][savePlan] ERREUR:",t),this.error="Erreur lors de la sauvegarde du plan",t}finally{this.loading=!1,n()}},async updatePlanDetails(e,n){const t=this.performanceMonitor.startMeasure("updatePlanDetails","IrrigationStore"),i=Nf();try{const r=await this.performanceMonitor.measureAsync("updatePlanDetails_apiCall",()=>{const{agriculteur_id:o,concessionnaire_id:l,usine_id:h,...p}=n,m={...p};return o!==void 0&&(m.agriculteur_id=o),l!==void 0&&(m.concessionnaire_id=l),h!==void 0&&(m.usine_id=h),ii.patch(`/plans/${e}/`,m)},"IrrigationStore");return this.performanceMonitor.measure("updatePlanDetails_updateState",()=>{this.currentPlan&&this.currentPlan.id===e&&(this.currentPlan={...this.currentPlan,...r.data});const o=this.plans.findIndex(l=>l.id===e);o!==-1&&(this.plans[o]={...this.plans[o],...r.data})},"IrrigationStore"),r.data}catch(r){throw console.error("Erreur lors de la mise à jour du plan:",r),i.error(`Erreur lors de la mise à jour du plan : ${r instanceof Error?r.message:String(r)}`),r}finally{t()}},async fetchPlanHistory(e){this.loading=!0;try{const n=await ii.get(`/plans/${e}/historique/`);return this.planHistory=n.data,n.data}catch(n){throw this.error="Erreur lors de la récupération de l'historique",n}finally{this.loading=!1}},async restorePlanVersion(e,n){var t;this.loading=!0;try{const i=await ii.post(`/plans/${e}/restaurer/`,{version_id:n});((t=this.currentPlan)==null?void 0:t.id)===e&&(this.currentPlan=i.data);const r=this.plans.findIndex(o=>o.id===e);return r!==-1&&(this.plans[r]=i.data),i.data}catch(i){throw this.error="Erreur lors de la restauration de la version",i}finally{this.loading=!1}},setCurrentPlan(e){this.currentPlan=e,this.startAutoSave()},clearCurrentPlan(){this.currentPlan=null,this.unsavedChanges=!1,this.autoSaveInterval&&(clearInterval(this.autoSaveInterval),this.autoSaveInterval=null)},markUnsavedChanges(){this.unsavedChanges=!0},async deletePlan(e){var t;this.loading=!0;const n=Nf();try{const i=this.plans.find(r=>r.id===e);await Pd.deletePlan(e),this.plans=this.plans.filter(r=>r.id!==e),((t=this.currentPlan)==null?void 0:t.id)===e&&this.clearCurrentPlan(),n.success(`Le plan "${(i==null?void 0:i.nom)||""}" a été supprimé avec succès`)}catch(i){throw this.error="Erreur lors de la suppression du plan",n.error(`Erreur lors de la suppression du plan : ${i instanceof Error?i.message:String(i)}`),i}finally{this.loading=!1}}}});function Ig(e){return"content"in e&&"bounds"in e}function d7(e){return e&&Array.isArray(e.points)&&e.points.length>0&&Array.isArray(e.points[0])&&e.points[0].length===2}function p7(e){var o,l;if(!e||typeof e!="object")return console.log("[DrawingStore] ElevationData invalide: pas un objet",{data:e}),!1;const n=Array.isArray(e.points)&&e.points.length>0&&Array.isArray(e.points[0])&&e.points[0].length===2,t=typeof e.style=="object"&&e.style!==null,i=!e.elevationData||Array.isArray(e.elevationData)&&e.elevationData.every(h=>typeof h=="object"&&"distance"in h&&"elevation"in h),r=n&&t&&i;return console.log("[DrawingStore] Validation ElevationData:",{data:e,isValid:r,hasValidPoints:n,hasValidStyle:t,hasValidElevationData:i,pointsFormat:(o=e==null?void 0:e.points)==null?void 0:o[0],elevationDataSample:(l=e==null?void 0:e.elevationData)==null?void 0:l[0]}),r}function g7(e){return e&&Array.isArray(e.points)&&e.points.length>0&&Array.isArray(e.points[0])&&e.points[0].length===2}function Ey(e){var i,r,o,l,h,p,m,_,w,E,b,D,j,Q,F,V,pe,Ee,Ie,nt,We,O,H,le,G,I,Y,$,R,Z,se,ie,Ae,Te,ut,X,ke,B,W,he,ne,re,ee,oe;if(console.log("[DrawingStore] Conversion de la forme en élément",{type:(i=e.properties)==null?void 0:i.type,name:(o=(r=e.properties)==null?void 0:r.style)==null?void 0:o.name,properties:e.properties,bounds:(l=e.getBounds)==null?void 0:l.call(e),shape:e,isElevationLine:e instanceof Ac,hasElevationData:!!((h=e.properties)!=null&&h.elevationData)}),e instanceof bc||((p=e.properties)==null?void 0:p.type)==="CircleWithSections"){const Se=e.getLatLng(),te={center:[Se.lng,Se.lat],radius:e.getRadius(),sections:e.properties.sections||[],style:{color:((m=e.properties.style)==null?void 0:m.color)||"#3388ff",weight:((_=e.properties.style)==null?void 0:_.weight)||3,opacity:((w=e.properties.style)==null?void 0:w.opacity)||1,fillColor:((E=e.properties.style)==null?void 0:E.fillColor)||"#3388ff",fillOpacity:((b=e.properties.style)==null?void 0:b.fillOpacity)||.2,dashArray:((D=e.properties.style)==null?void 0:D.dashArray)||"",name:((j=e.properties.style)==null?void 0:j.name)||""}};return console.log("[DrawingStore] CircleWithSections converti:",{type_forme:"CircleWithSections",data:te,sections:te.sections.length}),{type_forme:"CircleWithSections",data:te}}if(e instanceof Ac||((Q=e.properties)==null?void 0:Q.type)==="ElevationLine"||(F=e.properties)!=null&&F.elevationData&&Array.isArray(e.properties.elevationData)){const te={points:e.getLatLngs().map(ae=>[ae.lng,ae.lat]),style:{color:((V=e.properties.style)==null?void 0:V.color)||"#FF4500",weight:((pe=e.properties.style)==null?void 0:pe.weight)||4,opacity:((Ee=e.properties.style)==null?void 0:Ee.opacity)||.8,name:((Ie=e.properties.style)==null?void 0:Ie.name)||""},elevationData:e.properties.elevationData,samplePointStyle:e.properties.samplePointStyle,minMaxPointStyle:e.properties.minMaxPointStyle,minElevation:e.properties.minElevation,maxElevation:e.properties.maxElevation,elevationGain:e.properties.elevationGain,elevationLoss:e.properties.elevationLoss,averageSlope:e.properties.averageSlope,maxSlope:e.properties.maxSlope};return console.log("[DrawingStore] ElevationLine convertie:",{type_forme:"ElevationLine",data:te,originalProperties:e.properties}),{type_forme:"ElevationLine",data:te}}let n,t;if(e instanceof Jl||((nt=e.properties)==null?void 0:nt.type)==="TextRectangle"){n="TextRectangle";const Se=e.getBounds();return t={bounds:{southWest:[Se.getSouthWest().lng,Se.getSouthWest().lat],northEast:[Se.getNorthEast().lng,Se.getNorthEast().lat]},content:e.properties.text||"",style:{...e.properties.style,name:((We=e.properties.style)==null?void 0:We.name)||"",textStyle:{color:((O=e.properties.style.textStyle)==null?void 0:O.color)||"#000000",fontSize:((H=e.properties.style.textStyle)==null?void 0:H.fontSize)||"14px",fontFamily:((le=e.properties.style.textStyle)==null?void 0:le.fontFamily)||"Arial, sans-serif",textAlign:((G=e.properties.style.textStyle)==null?void 0:G.textAlign)||"center",backgroundColor:((I=e.properties.style.textStyle)==null?void 0:I.backgroundColor)||"#FFFFFF",backgroundOpacity:((Y=e.properties.style.textStyle)==null?void 0:Y.backgroundOpacity)??1,bold:(($=e.properties.style.textStyle)==null?void 0:$.bold)||!1,italic:((R=e.properties.style.textStyle)==null?void 0:R.italic)||!1}},rotation:e.properties.rotation||0},{type_forme:n,data:t}}switch((Z=e.properties)==null?void 0:Z.type){case"Circle":{n="Circle";const ye=e.getLatLng();t={center:[ye.lng,ye.lat],radius:e.getRadius(),style:{color:((se=e.properties.style)==null?void 0:se.color)||"#3388ff",weight:((ie=e.properties.style)==null?void 0:ie.weight)||3,opacity:((Ae=e.properties.style)==null?void 0:Ae.opacity)||1,fillColor:((Te=e.properties.style)==null?void 0:Te.fillColor)||"#3388ff",fillOpacity:((ut=e.properties.style)==null?void 0:ut.fillOpacity)||.2,dashArray:((X=e.properties.style)==null?void 0:X.dashArray)||"",name:((ke=e.properties.style)==null?void 0:ke.name)||""}};break}case"Polygon":n="Polygon",t={points:e.getLatLngs()[0].map(ye=>[ye.lng,ye.lat]),style:{color:e.properties.style.color||"#3388ff",weight:e.properties.style.weight||3,opacity:e.properties.style.opacity||1,fillColor:e.properties.style.fillColor||"#3388ff",fillOpacity:e.properties.style.fillOpacity||.2,dashArray:e.properties.style.dashArray||"",name:((B=e.properties.style)==null?void 0:B.name)||""}};break;case"Semicircle":n="Semicircle";const te=e.getCenter?e.getCenter():e.getLatLng();t={center:[te.lng,te.lat],radius:e.getRadius(),startAngle:e.properties.startAngle||0,endAngle:e.properties.stopAngle||180,style:{color:e.properties.style.color||"#3388ff",weight:e.properties.style.weight||3,opacity:e.properties.style.opacity||1,fillColor:e.properties.style.fillColor||"#3388ff",fillOpacity:e.properties.style.fillOpacity||.2,dashArray:e.properties.style.dashArray||"",name:((W=e.properties.style)==null?void 0:W.name)||""}};break;case"Rectangle":n="Rectangle";let ae={width:0,height:0};try{typeof e.getDimensions=="function"?ae=e.getDimensions():console.warn("[DrawingStore] Shape does not have getDimensions method")}catch(ye){console.error("[DrawingStore] Error getting dimensions:",ye)}t={bounds:{southWest:[e.getBounds().getSouthWest().lng,e.getBounds().getSouthWest().lat],northEast:[e.getBounds().getNorthEast().lng,e.getBounds().getNorthEast().lat]},width:ae.width,height:ae.height,rotation:typeof e.getRotation=="function"?e.getRotation():0,style:{...((he=e.properties)==null?void 0:he.style)||{},name:((re=(ne=e.properties)==null?void 0:ne.style)==null?void 0:re.name)||""}};break;case"Line":n="Line",t={points:e.getLatLngs().map(ye=>[ye.lng,ye.lat]),style:{...e.properties.style||{},name:((ee=e.properties.style)==null?void 0:ee.name)||""}};break;default:console.warn("[DrawingStore] Type de forme non géré:",(oe=e.properties)==null?void 0:oe.type),n="unknown",t={}}return console.log("[DrawingStore] Élément converti",{type_forme:n,data:t}),{type_forme:n,data:t}}function m7(e){var n,t,i,r,o,l,h,p,m,_,w,E,b,D,j,Q,F,V,pe,Ee,Ie,nt,We,O,H,le,G,I,Y,$,R,Z,se,ie,Ae,Te,ut,X,ke,B,W,he,ne,re,ee,oe,Se,te,ae,Le,ye,ue,Oe,De,Me,Ve,ze,st,Qe,pt,wt,Ht,nn;switch(console.log("[DrawingStore] Conversion de l'élément stocké en forme",{element:e}),e.type_forme){case"CircleWithSections":{const tt=e.data;if(!tt.center||!tt.radius)return console.error("[DrawingStore] Données invalides pour CircleWithSections"),null;const Qt=new bc(gn.latLng(tt.center[1],tt.center[0]),{color:((n=tt.style)==null?void 0:n.color)||"#3388ff",weight:((t=tt.style)==null?void 0:t.weight)||3,opacity:((i=tt.style)==null?void 0:i.opacity)||1,fillColor:((r=tt.style)==null?void 0:r.fillColor)||"#3388ff",fillOpacity:((o=tt.style)==null?void 0:o.fillOpacity)||.2,dashArray:((l=tt.style)==null?void 0:l.dashArray)||"",name:((h=tt.style)==null?void 0:h.name)||"",radius:tt.radius,sections:tt.sections||[]});return Qt.properties.type="CircleWithSections",console.log("[DrawingStore] CircleWithSections restauré:",{center:tt.center,radius:tt.radius,sections:((p=tt.sections)==null?void 0:p.length)||0}),Qt}case"TextRectangle":{if(!Ig(e.data))return console.error("[DrawingStore] Données invalides pour TextRectangle"),null;const tt=e.data;if(!tt.bounds)return console.error("[DrawingStore] Données de bounds manquantes pour TextRectangle"),null;const Qt=new gn.LatLngBounds(gn.latLng(tt.bounds.southWest[1],tt.bounds.southWest[0]),gn.latLng(tt.bounds.northEast[1],tt.bounds.northEast[0])),rn={color:((m=tt.style)==null?void 0:m.color)||"#3388ff",fillColor:((_=tt.style)==null?void 0:_.fillColor)||"#3388ff",fillOpacity:((w=tt.style)==null?void 0:w.fillOpacity)||.2,weight:((E=tt.style)==null?void 0:E.weight)||3,opacity:((b=tt.style)==null?void 0:b.opacity)||1,name:((D=tt.style)==null?void 0:D.name)||"",textStyle:{color:((j=tt.style.textStyle)==null?void 0:j.color)||"#000000",fontSize:((Q=tt.style.textStyle)==null?void 0:Q.fontSize)||"14px",fontFamily:((F=tt.style.textStyle)==null?void 0:F.fontFamily)||"Arial, sans-serif",textAlign:((V=tt.style.textStyle)==null?void 0:V.textAlign)||"center",backgroundColor:((pe=tt.style.textStyle)==null?void 0:pe.backgroundColor)||"#FFFFFF",backgroundOpacity:((Ee=tt.style.textStyle)==null?void 0:Ee.backgroundOpacity)??1,bold:((Ie=tt.style.textStyle)==null?void 0:Ie.bold)||!1,italic:((nt=tt.style.textStyle)==null?void 0:nt.italic)||!1}},it=new Jl(Qt,tt.content||"Double-cliquez pour éditer",rn);return tt.rotation&&it.setRotation(tt.rotation),(We=tt.style)!=null&&We.name&&(it.properties.style.name=tt.style.name),it}case"Polygon":{const tt=e.data;if(!d7(tt))return console.error("[DrawingStore] Données invalides pour Polygon"),null;const Qt=tt.points.map(it=>gn.latLng(it[1],it[0])),rn=new Rf([Qt],{color:((O=tt.style)==null?void 0:O.color)||"#3388ff",weight:((H=tt.style)==null?void 0:H.weight)||3,opacity:((le=tt.style)==null?void 0:le.opacity)||1,fillColor:((G=tt.style)==null?void 0:G.fillColor)||"#3388ff",fillOpacity:((I=tt.style)==null?void 0:I.fillOpacity)||.2,dashArray:((Y=tt.style)==null?void 0:Y.dashArray)||"",name:(($=tt.style)==null?void 0:$.name)||""});return rn.updateProperties(),rn}case"ElevationLine":{const tt=e.data;if(!p7(tt))return console.error("[DrawingStore] Données invalides pour ElevationLine"),null;const Qt=tt.points.map(it=>gn.latLng(it[1],it[0])),rn=new Ac(Qt,{color:((R=tt.style)==null?void 0:R.color)||"#FF4500",weight:((Z=tt.style)==null?void 0:Z.weight)||4,opacity:((se=tt.style)==null?void 0:se.opacity)||.8,name:((ie=tt.style)==null?void 0:ie.name)||""});return rn.properties={type:"ElevationLine",style:{...tt.style||{},name:((Ae=tt.style)==null?void 0:Ae.name)||""},elevationData:tt.elevationData,samplePointStyle:tt.samplePointStyle,minMaxPointStyle:tt.minMaxPointStyle,minElevation:tt.minElevation,maxElevation:tt.maxElevation,elevationGain:tt.elevationGain,elevationLoss:tt.elevationLoss,averageSlope:tt.averageSlope,maxSlope:tt.maxSlope,dataSource:"restored"},tt.elevationData&&rn.updateElevationProfile(),console.log("[DrawingStore] ElevationLine restored:",{points:Qt.length,hasElevationData:!!tt.elevationData,name:(Te=tt.style)==null?void 0:Te.name,properties:rn.properties}),rn}case"Line":{const tt=e.data;if(!g7(tt))return console.error("[DrawingStore] Données invalides pour Ligne"),null;const Qt=tt.points.map(it=>gn.latLng(it[1],it[0])),rn=new $o(Qt,{...tt.style||{},name:((ut=tt.style)==null?void 0:ut.name)||""});return rn.updateProperties(),rn}case"Semicircle":{const tt=e.data;if(!tt.center||!tt.radius)return console.error("[DrawingStore] Données invalides pour Semicircle"),null;const Qt=gn.latLng(tt.center[1],tt.center[0]),rn=new Lu(Qt,tt.radius,tt.startAngle||0,tt.endAngle||180,{color:((X=tt.style)==null?void 0:X.color)||"#3388ff",weight:((ke=tt.style)==null?void 0:ke.weight)||3,opacity:((B=tt.style)==null?void 0:B.opacity)||1,fillColor:((W=tt.style)==null?void 0:W.fillColor)||"#3388ff",fillOpacity:((he=tt.style)==null?void 0:he.fillOpacity)||.2,dashArray:((ne=tt.style)==null?void 0:ne.dashArray)||"",name:((re=tt.style)==null?void 0:re.name)||""});rn.properties={type:"Semicircle",radius:tt.radius,startAngle:tt.startAngle||0,stopAngle:tt.endAngle||180,style:{...tt.style||{},name:((ee=tt.style)==null?void 0:ee.name)||""},center:Qt};const it=((tt.endAngle||180)-(tt.startAngle||0)+360)%360,Ke=Math.PI*Math.pow(tt.radius,2)*it/360,qt=2*Math.PI*tt.radius*it/360,mn=qt+2*tt.radius;return rn.properties.surface=Ke,rn.properties.arcLength=qt,rn.properties.perimeter=mn,rn.properties.openingAngle=it,rn.properties.diameter=tt.radius*2,console.log("[DrawingStore] Semicircle restauré:",{center:tt.center,radius:tt.radius,angles:{start:tt.startAngle,end:tt.endAngle},properties:rn.properties}),rn}case"Rectangle":{const tt=e.data;if(console.log("[DrawingStore][convertStoredElementToShape] Restauration Rectangle:",{data:tt,bounds:tt.bounds,width:tt.width,height:tt.height,rotation:tt.rotation}),!tt.bounds)return console.error("[DrawingStore] Données de bounds manquantes pour Rectangle"),null;const Qt=new gn.LatLngBounds(gn.latLng(tt.bounds.southWest[1],tt.bounds.southWest[0]),gn.latLng(tt.bounds.northEast[1],tt.bounds.northEast[0])),rn=new Uo(Qt,{color:((oe=tt.style)==null?void 0:oe.color)||"#3388ff",weight:((Se=tt.style)==null?void 0:Se.weight)||3,opacity:((te=tt.style)==null?void 0:te.opacity)||1,fillColor:((ae=tt.style)==null?void 0:ae.fillColor)||"#3388ff",fillOpacity:((Le=tt.style)==null?void 0:Le.fillOpacity)||.2,dashArray:((ye=tt.style)==null?void 0:ye.dashArray)||"",name:((ue=tt.style)==null?void 0:ue.name)||"",width:tt.width,height:tt.height});return tt.rotation&&rn.setRotation(tt.rotation),console.log("[DrawingStore][convertStoredElementToShape] Rectangle restauré:",{bounds:rn.getBounds(),dimensions:rn.getDimensions(),properties:rn.properties}),rn}case"Circle":{console.log("[DrawingStore] Traitement d'un Circle à partir de l'API",{id:e.id,data:e.data,hasName:((De=(Oe=e.data)==null?void 0:Oe.style)==null?void 0:De.name)!==void 0,name:(Ve=(Me=e.data)==null?void 0:Me.style)==null?void 0:Ve.name});const tt=e.data;if(!tt.center||!tt.radius)return console.error("[DrawingStore] Données invalides pour Circle"),null;const Qt=gn.circle([tt.center[1],tt.center[0]],{color:((ze=tt.style)==null?void 0:ze.color)||"#3388ff",weight:((st=tt.style)==null?void 0:st.weight)||3,opacity:((Qe=tt.style)==null?void 0:Qe.opacity)||1,fillColor:((pt=tt.style)==null?void 0:pt.fillColor)||"#3388ff",fillOpacity:((wt=tt.style)==null?void 0:wt.fillOpacity)||.2,dashArray:((Ht=tt.style)==null?void 0:Ht.dashArray)||"",radius:tt.radius});return Qt.properties={type:"Circle",radius:tt.radius,diameter:tt.radius*2,surface:Math.PI*tt.radius*tt.radius,perimeter:2*Math.PI*tt.radius,style:{...tt.style||{},name:((nn=tt.style)==null?void 0:nn.name)||""}},console.log("[DrawingStore] Cercle créé:",{centerType:typeof tt.center,center:tt.center,radius:tt.radius,style:Qt.properties.style,name:Qt.properties.style.name}),Qt}default:return console.warn("[DrawingStore] Type non géré pour la restauration:",e.type_forme),null}}const L4=Dp("drawing",{state:()=>({currentPlanId:null,elements:[],selectedElement:null,unsavedChanges:!1,loading:!1,error:null,currentTool:"",currentStyle:{strokeStyle:"solid",strokeWidth:2,strokeColor:"#2563EB",fillColor:"#3B82F6",fillOpacity:.2},lastUsedType:null,performanceMonitor:hh()}),getters:{hasUnsavedChanges:e=>e.unsavedChanges,getCurrentElements:e=>e.elements,getSelectedElement:e=>e.selectedElement,getCurrentTool:e=>e.currentTool,getCurrentStyle:e=>e.currentStyle,getLastUsedType:e=>e.lastUsedType},actions:{setCurrentPlan(e){window.dispatchEvent(new CustomEvent("clearControlPoints")),this.currentPlanId=e,e===null&&this.clearElements(),this.selectedElement=null,this.unsavedChanges=!1,this.currentTool="",this.lastUsedType=null,this.currentStyle={strokeStyle:"solid",strokeWidth:2,strokeColor:"#2563EB",fillColor:"#3B82F6",fillOpacity:.2}},clearCurrentPlan(){(this.currentPlanId!==null||this.elements.length>0)&&(this.currentPlanId=null,this.elements=[],this.selectedElement=null,this.unsavedChanges=!1,this.loading=!1,this.error=null)},clearElements(){this.elements=[],this.selectedElement=null,this.unsavedChanges=!1,this.error=null},addElement(e){var t;const n=this.performanceMonitor.startMeasure("addElement","DrawingStore");try{if(console.log("[DrawingStore] Ajout d'un élément",{element:e,isLeafletLayer:e instanceof gn.Layer,hasProperties:!!e.properties,properties:e.properties,type:(t=e.properties)==null?void 0:t.type}),e instanceof gn.Layer&&e.properties){const i=this.performanceMonitor.measure("addElement_convert",()=>Ey(e),"DrawingStore");console.log("[DrawingStore] Élément converti avant ajout",{original:e,converted:i,type:i.type_forme,data:i.data}),this.elements.push(i)}else!e.type_forme&&this.lastUsedType&&(e.type_forme=this.lastUsedType),this.elements.push(e);this.unsavedChanges=!0}finally{n()}},updateElement(e){const n=this.elements.findIndex(t=>t.id===e.id);if(n!==-1){const t=this.elements[n].type_forme;this.elements[n]={...e,type_forme:t},this.unsavedChanges=!0}},removeElement(e){const n=this.elements.findIndex(t=>t.id===e);n!==-1&&(this.elements.splice(n,1),this.unsavedChanges=!0)},selectElement(e){this.selectedElement=e},setCurrentTool(e){this.currentTool=e,["CERCLE","RECTANGLE","DEMI_CERCLE","LIGNE","TEXTE"].includes(e)&&(this.lastUsedType=e)},setCurrentStyle(e){if(!e||Object.keys(e).length===0){this.currentStyle={strokeStyle:"solid",strokeWidth:2,strokeColor:"#2563EB",fillColor:"#3B82F6",fillOpacity:.2};return}this.currentStyle={...this.currentStyle,...e}},async loadPlanElements(e){const n=this.performanceMonitor.startMeasure("loadPlanElements","DrawingStore");if(this.currentPlanId===e&&this.elements.length>0)return console.log(`[DrawingStore] Plan ${e} déjà chargé avec ${this.elements.length} éléments`),n(),this.elements;this.loading=!0;try{console.log("[DrawingStore] Début du chargement du plan",{planId:e});const i=(await this.performanceMonitor.measureAsync("loadPlanElements_apiCall",()=>ii.get(`/plans/${e}/`),"DrawingStore")).data;return console.log("[DrawingStore] Données du plan reçues",{formes:i.formes,preferences:i.preferences}),i.formes&&Array.isArray(i.formes)&&i.formes.forEach((r,o)=>{var l,h,p;console.log(`[DrawingStore] Analyse détaillée forme ${o}:`,{id:r.id,type_forme:r.type_forme,hasData:!!r.data,dataKeys:r.data?Object.keys(r.data):[],name:(l=r.data)==null?void 0:l.name,hasName:r.data&&"name"in r.data,centerType:(h=r.data)!=null&&h.center?typeof r.data.center:"undefined",center:(p=r.data)==null?void 0:p.center})}),this.elements=i.formes.map(r=>{var o;if(console.log("[DrawingStore] Traitement de la forme stockée",{id:r.id,type_forme:r.type_forme,data:r.data,isTextRectangle:r.type_forme==="TEXTE"||r.data&&Ig(r.data)}),r.type_forme)return console.log("[DrawingStore] Forme déjà au format élément",{type_forme:r.type_forme,data:r.data,hasName:r.data&&"name"in r.data,name:(o=r.data)==null?void 0:o.name}),{id:r.id,type_forme:r.type_forme,data:r.data||{}};try{const l=m7(r);if(l)return console.log("[DrawingStore] Forme convertie avec succès",{originalType:r.type_forme,convertedType:l.type,properties:l.properties}),Ey(l)}catch(l){console.error("[DrawingStore] Erreur lors de la conversion de la forme",{error:l,forme:r})}return console.warn("[DrawingStore] Utilisation de la forme sans conversion",{type_forme:r.type_forme,data:r.data}),r}),console.log(`[DrawingStore] Plan ${e} - Chargé ${this.elements.length} éléments`,{elements:this.elements.map(r=>({id:r.id,type_forme:r.type_forme,isTextRectangle:r.type_forme==="TextRectangle"||Ig(r.data)}))}),this.currentPlanId=e,this.unsavedChanges=!1,i.preferences&&(console.log("[DrawingStore] Chargement des préférences",i.preferences),i.preferences.currentTool&&this.setCurrentTool(i.preferences.currentTool),i.preferences.currentStyle&&(this.currentStyle={...this.currentStyle,...i.preferences.currentStyle}),i.preferences.lastUsedType&&(this.lastUsedType=i.preferences.lastUsedType)),this.elements}catch(t){throw console.error("[DrawingStore] Erreur lors du chargement des éléments:",t),this.error="Erreur lors du chargement des éléments du plan",t}finally{this.loading=!1,n()}},async saveToPlan(e,n){const t=this.performanceMonitor.startMeasure("saveToPlan","DrawingStore");this.loading=!0;try{const i=e||this.currentPlanId;if(console.log("[DrawingStore][saveToPlan] Début de la sauvegarde",{targetPlanId:i,currentPlanId:this.currentPlanId,elementsCount:this.elements.length,elementsToDelete:n==null?void 0:n.elementsToDelete}),!i)throw new Error("Aucun plan sélectionné pour la sauvegarde");const r=this.performanceMonitor.measure("saveToPlan_prepareElements",()=>this.elements.map(p=>({...p,type_forme:p.type_forme||this.lastUsedType})),"DrawingStore"),o=(n==null?void 0:n.elementsToDelete)||[],l=`/plans/${i}/save_with_elements/`,h=await this.performanceMonitor.measureAsync("saveToPlan_apiCall",()=>ii.post(l,{formes:r,connexions:[],annotations:[],elementsToDelete:o,preferences:{currentTool:this.currentTool,currentStyle:this.currentStyle,lastUsedType:this.lastUsedType}}),"DrawingStore");return this.elements=this.performanceMonitor.measure("saveToPlan_processResponse",()=>h.data.formes.map(p=>({...p,type_forme:p.type_forme})),"DrawingStore"),this.unsavedChanges=!1,h.data}catch(i){throw console.error("[DrawingStore][saveToPlan] ERREUR:",i),console.error("[DrawingStore][saveToPlan] Stack trace:",i instanceof Error?i.stack:"No stack trace"),this.error="Erreur lors de la sauvegarde du plan",i}finally{this.loading=!1,t()}}}}),v7={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center z-[9999] p-4 overflow-y-auto"},y7={class:"bg-white rounded-lg p-6 max-w-2xl w-full my-8 relative"},_7={class:"overflow-y-auto max-h-[calc(100vh-12rem)]"},b7={key:0,class:"mb-4"},w7={key:0,class:"animate-pulse"},x7=["value"],L7={key:1,class:"mb-4"},C7={key:0,class:"animate-pulse"},S7=["disabled"],P7={value:null},E7=["value"],A7={key:2,class:"mb-4"},k7={key:0,class:"animate-pulse"},M7=["disabled"],T7={value:null},B7=["value"],N7={class:"mb-4"},D7={class:"mb-6"},R7={class:"flex justify-end space-x-3"},O7=["disabled"],I7={key:0},F7={key:1},C4=Pa({__name:"NewPlanModal",props:{modelValue:{type:Boolean}},emits:["update:modelValue","created","concessionnaireSelected","clientSelected"],setup(e,{expose:n,emit:t}){function i(Y){return Y?typeof Y=="object"?Y.id:Y:null}function r(Y){if(Y===null)throw new Error("Invalid ID");return Y}const o=e,l=t,h=Va(),p=Lm(),m=L4(),_=Yt(!1),w=Yt(null),E=Yt([]),b=Yt([]),D=Yt([]),j=Yt(null),Q=Yt(null),F=Yt(!1),V=Yt(!1),pe=Yt(!1),Ee=Yt({nom:"",description:"",usine:null,concessionnaire:null,client:null}),Ie=Di(()=>{var Y,$,R;return((Y=h.user)==null?void 0:Y.user_type)==="admin"?Ee.value.nom.trim()&&Ee.value.usine&&Ee.value.concessionnaire&&Ee.value.client:(($=h.user)==null?void 0:$.user_type)==="usine"?Ee.value.nom.trim()&&Ee.value.concessionnaire&&Ee.value.client:((R=h.user)==null?void 0:R.user_type)==="concessionnaire"?Ee.value.nom.trim()&&Ee.value.client:Ee.value.nom.trim()});Ur(()=>Ee.value.usine,async Y=>{if(!o.modelValue)return;Ee.value.concessionnaire=null,Ee.value.client=null,b.value=[];const $=i(Y);$?await nt($):E.value=[]}),Ur(()=>Ee.value.concessionnaire,async Y=>{if(!o.modelValue)return;Ee.value.client=null;const $=i(Y);$?await We($):b.value=[]}),Ur(()=>o.modelValue,Y=>{var $,R,Z;Y?(($=h.user)==null?void 0:$.user_type)==="admin"?G():((R=h.user)==null?void 0:R.user_type)==="usine"?nt(h.user.id):((Z=h.user)==null?void 0:Z.user_type)==="concessionnaire"&&We(h.user.id):(Ee.value={nom:"",description:"",usine:null,concessionnaire:null,client:null},j.value=null,Q.value=null,b.value=[],E.value=[],D.value=[],w.value=null)});async function nt(Y){F.value=!0;try{if(Y)E.value=await h.fetchUsineConcessionnaires(Y);else{const $=await $a.getConcessionnaires();E.value=$.data}}catch($){console.error("[NewPlanModal] Error loading concessionnaires:",$),E.value=[]}finally{F.value=!1}}async function We(Y){V.value=!0;try{b.value=await h.fetchConcessionnaireAgriculteurs(Y)}catch($){console.error("[NewPlanModal] Error loading clients:",$),b.value=[]}finally{V.value=!1}}async function O(Y){o.modelValue&&(j.value=Y,Ee.value.concessionnaire=Y.id,await We(Y.id),l("concessionnaireSelected",Y))}function H(Y){o.modelValue&&(Q.value=Y,Ee.value.client=Y.id,l("clientSelected",Y))}function le(){l("update:modelValue",!1),Ee.value={nom:"",description:"",usine:null,concessionnaire:null,client:null},j.value=null,Q.value=null,b.value=[],w.value=null}async function G(){pe.value=!0;try{D.value=await h.fetchUsines()}catch(Y){console.error("[NewPlanModal] Error loading usines:",Y),D.value=[]}finally{pe.value=!1}}async function I(){var Y,$;w.value=null,_.value=!0;try{const R={nom:Ee.value.nom.trim(),description:Ee.value.description.trim()},Z=h.user;if(!Z)throw new Error("User not found");if(Z.user_type==="admin"){if(!Ee.value.usine||!Ee.value.concessionnaire||!Ee.value.client)throw new Error("Missing required fields");R.usine=r(i(Ee.value.usine)),R.concessionnaire=r(i(Ee.value.concessionnaire)),R.agriculteur=Ee.value.client}else if(Z.user_type==="usine"){if(!Ee.value.concessionnaire||!Ee.value.client)throw new Error("Missing required fields");R.usine=Z.id,R.concessionnaire=r(i(Ee.value.concessionnaire)),R.agriculteur=Ee.value.client}else if(Z.user_type==="concessionnaire"){if(!Z.usine||!Ee.value.client)throw new Error("Missing required fields");R.usine=r(i(Z.usine)),R.concessionnaire=Z.id,R.agriculteur=Ee.value.client}else if(Z.user_type==="agriculteur"){if(!Z.usine||!Z.concessionnaire)throw new Error("Missing required fields");R.usine=r(i(Z.usine)),R.concessionnaire=r(i(Z.concessionnaire)),R.agriculteur=Z.id}console.log("Données du plan à créer:",R),p.clearCurrentPlan(),m.setCurrentPlan(null);const se=await p.createPlan(R);l("created",se.id),le()}catch(R){console.error("[NewPlanModal] Error creating plan:",R),console.error("Response data:",(Y=R.response)==null?void 0:Y.data);let Z="Une erreur est survenue lors de la création du plan";($=R.response)!=null&&$.data&&(typeof R.response.data=="object"?Z=Object.entries(R.response.data).map(([se,ie])=>Array.isArray(ie)?`${se}: ${ie.join(", ")}`:`${se}: ${ie}`).join(`
`):typeof R.response.data=="string"&&(Z=R.response.data)),w.value=Z}finally{_.value=!1}}return n({concessionnaires:E,concessionnaireClients:b,selectedConcessionnaire:j,selectedClient:Q,loadConcessionnaires:nt,loadConcessionnaireClients:We,selectConcessionnaire:O,selectClient:H}),(Y,$)=>{var R,Z,se,ie;return Y.modelValue?(et(),rt("div",v7,[A("div",y7,[A("div",{class:"flex justify-between items-center mb-4 sticky top-0 bg-white pb-4 border-b"},[$[6]||($[6]=A("h2",{class:"text-xl font-semibold text-gray-900"},"Créer un nouveau plan",-1)),A("button",{onClick:le,class:"text-gray-400 hover:text-gray-500"},$[5]||($[5]=[A("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),A("div",_7,[Xn(h).isAdmin?(et(),rt("div",b7,[$[9]||($[9]=A("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Usine",-1)),pe.value?(et(),rt("div",w7,$[7]||($[7]=[A("div",{class:"h-10 bg-gray-200 rounded"},null,-1)]))):zn((et(),rt("select",{key:1,"onUpdate:modelValue":$[0]||($[0]=Ae=>Ee.value.usine=Ae),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"},[$[8]||($[8]=A("option",{value:null},"Sélectionnez une usine",-1)),(et(!0),rt(Vn,null,$i(D.value,Ae=>(et(),rt("option",{key:Ae.id,value:Ae.id},Jt(Xn(ll)(Ae)),9,x7))),128))],512)),[[Ks,Ee.value.usine]])])):Cn("",!0),((R=Xn(h).user)==null?void 0:R.user_type)==="admin"||((Z=Xn(h).user)==null?void 0:Z.user_type)==="usine"?(et(),rt("div",L7,[$[11]||($[11]=A("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Concessionnaire",-1)),F.value?(et(),rt("div",C7,$[10]||($[10]=[A("div",{class:"h-10 bg-gray-200 rounded"},null,-1)]))):zn((et(),rt("select",{key:1,id:"edit-concessionnaire","onUpdate:modelValue":$[1]||($[1]=Ae=>Ee.value.concessionnaire=Ae),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:!E.value.length||Xn(h).isAdmin&&!Ee.value.usine},[A("option",P7,Jt(E.value.length?"Sélectionnez un concessionnaire":"Aucun concessionnaire disponible"),1),(et(!0),rt(Vn,null,$i(E.value,Ae=>(et(),rt("option",{key:Ae.id,value:Ae.id},Jt(Xn(ll)(Ae)),9,E7))),128))],8,S7)),[[Ks,Ee.value.concessionnaire]])])):Cn("",!0),((se=Xn(h).user)==null?void 0:se.user_type)!=="agriculteur"?(et(),rt("div",A7,[$[13]||($[13]=A("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Agriculteur",-1)),V.value?(et(),rt("div",k7,$[12]||($[12]=[A("div",{class:"h-10 bg-gray-200 rounded"},null,-1)]))):zn((et(),rt("select",{key:1,id:"edit-agriculteur","onUpdate:modelValue":$[2]||($[2]=Ae=>Ee.value.client=Ae),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:!b.value.length||((ie=Xn(h).user)==null?void 0:ie.user_type)!=="concessionnaire"&&!Ee.value.concessionnaire},[A("option",T7,Jt(b.value.length?"Sélectionnez un agriculteur":"Aucun agriculteur disponible"),1),(et(!0),rt(Vn,null,$i(b.value,Ae=>(et(),rt("option",{key:Ae.id,value:Ae.id},Jt(Xn(ll)(Ae)),9,B7))),128))],8,M7)),[[Ks,Ee.value.client]])])):Cn("",!0),A("div",N7,[$[14]||($[14]=A("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nom du plan",-1)),zn(A("input",{id:"edit-nom","onUpdate:modelValue":$[3]||($[3]=Ae=>Ee.value.nom=Ae),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Entrez le nom du plan"},null,512),[[Ui,Ee.value.nom]])]),A("div",D7,[$[15]||($[15]=A("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description",-1)),zn(A("textarea",{id:"edit-description","onUpdate:modelValue":$[4]||($[4]=Ae=>Ee.value.description=Ae),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",rows:"3",placeholder:"Entrez une description (optionnel)"},null,512),[[Ui,Ee.value.description]])]),A("div",R7,[A("button",{onClick:le,class:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500"}," Annuler "),A("button",{onClick:I,class:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:!Ie.value||_.value},[_.value?(et(),rt("span",I7,"Création en cours...")):(et(),rt("span",F7,"Créer"))],8,O7)])])])])):Cn("",!0)}}});function Fr(e){"@babel/helpers - typeof";return Fr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Fr(e)}var ua=Uint8Array,cl=Uint16Array,Cm=Int32Array,Vp=new ua([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Hp=new ua([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Fg=new ua([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),S4=function(e,n){for(var t=new cl(31),i=0;i<31;++i)t[i]=n+=1<<e[i-1];for(var r=new Cm(t[30]),i=1;i<30;++i)for(var o=t[i];o<t[i+1];++o)r[o]=o-t[i]<<5|i;return{b:t,r}},P4=S4(Vp,2),E4=P4.b,zg=P4.r;E4[28]=258,zg[258]=28;var A4=S4(Hp,0),z7=A4.b,Ay=A4.r,jg=new cl(32768);for(var os=0;os<32768;++os){var fc=(os&43690)>>1|(os&21845)<<1;fc=(fc&52428)>>2|(fc&13107)<<2,fc=(fc&61680)>>4|(fc&3855)<<4,jg[os]=((fc&65280)>>8|(fc&255)<<8)>>1}var Eu=function(e,n,t){for(var i=e.length,r=0,o=new cl(n);r<i;++r)e[r]&&++o[e[r]-1];var l=new cl(n);for(r=1;r<n;++r)l[r]=l[r-1]+o[r-1]<<1;var h;if(t){h=new cl(1<<n);var p=15-n;for(r=0;r<i;++r)if(e[r])for(var m=r<<4|e[r],_=n-e[r],w=l[e[r]-1]++<<_,E=w|(1<<_)-1;w<=E;++w)h[jg[w]>>p]=m}else for(h=new cl(i),r=0;r<i;++r)e[r]&&(h[r]=jg[l[e[r]-1]++]>>15-e[r]);return h},kc=new ua(288);for(var os=0;os<144;++os)kc[os]=8;for(var os=144;os<256;++os)kc[os]=9;for(var os=256;os<280;++os)kc[os]=7;for(var os=280;os<288;++os)kc[os]=8;var Wf=new ua(32);for(var os=0;os<32;++os)Wf[os]=5;var j7=Eu(kc,9,0),U7=Eu(kc,9,1),$7=Eu(Wf,5,0),q7=Eu(Wf,5,1),H0=function(e){for(var n=e[0],t=1;t<e.length;++t)e[t]>n&&(n=e[t]);return n},Hl=function(e,n,t){var i=n/8|0;return(e[i]|e[i+1]<<8)>>(n&7)&t},W0=function(e,n){var t=n/8|0;return(e[t]|e[t+1]<<8|e[t+2]<<16)>>(n&7)},Sm=function(e){return(e+7)/8|0},k4=function(e,n,t){return(t==null||t>e.length)&&(t=e.length),new ua(e.subarray(n,t))},G7=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Zl=function(e,n,t){var i=new Error(n||G7[e]);if(i.code=e,Error.captureStackTrace&&Error.captureStackTrace(i,Zl),!t)throw i;return i},V7=function(e,n,t,i){var r=e.length,o=0;if(!r||n.f&&!n.l)return t||new ua(0);var l=!t,h=l||n.i!=2,p=n.i;l&&(t=new ua(r*3));var m=function(Se){var te=t.length;if(Se>te){var ae=new ua(Math.max(te*2,Se));ae.set(t),t=ae}},_=n.f||0,w=n.p||0,E=n.b||0,b=n.l,D=n.d,j=n.m,Q=n.n,F=r*8;do{if(!b){_=Hl(e,w,1);var V=Hl(e,w+1,3);if(w+=3,V)if(V==1)b=U7,D=q7,j=9,Q=5;else if(V==2){var nt=Hl(e,w,31)+257,We=Hl(e,w+10,15)+4,O=nt+Hl(e,w+5,31)+1;w+=14;for(var H=new ua(O),le=new ua(19),G=0;G<We;++G)le[Fg[G]]=Hl(e,w+G*3,7);w+=We*3;for(var I=H0(le),Y=(1<<I)-1,$=Eu(le,I,1),G=0;G<O;){var R=$[Hl(e,w,Y)];w+=R&15;var pe=R>>4;if(pe<16)H[G++]=pe;else{var Z=0,se=0;for(pe==16?(se=3+Hl(e,w,3),w+=2,Z=H[G-1]):pe==17?(se=3+Hl(e,w,7),w+=3):pe==18&&(se=11+Hl(e,w,127),w+=7);se--;)H[G++]=Z}}var ie=H.subarray(0,nt),Ae=H.subarray(nt);j=H0(ie),Q=H0(Ae),b=Eu(ie,j,1),D=Eu(Ae,Q,1)}else Zl(1);else{var pe=Sm(w)+4,Ee=e[pe-4]|e[pe-3]<<8,Ie=pe+Ee;if(Ie>r){p&&Zl(0);break}h&&m(E+Ee),t.set(e.subarray(pe,Ie),E),n.b=E+=Ee,n.p=w=Ie*8,n.f=_;continue}if(w>F){p&&Zl(0);break}}h&&m(E+131072);for(var Te=(1<<j)-1,ut=(1<<Q)-1,X=w;;X=w){var Z=b[W0(e,w)&Te],ke=Z>>4;if(w+=Z&15,w>F){p&&Zl(0);break}if(Z||Zl(2),ke<256)t[E++]=ke;else if(ke==256){X=w,b=null;break}else{var B=ke-254;if(ke>264){var G=ke-257,W=Vp[G];B=Hl(e,w,(1<<W)-1)+E4[G],w+=W}var he=D[W0(e,w)&ut],ne=he>>4;he||Zl(3),w+=he&15;var Ae=z7[ne];if(ne>3){var W=Hp[ne];Ae+=W0(e,w)&(1<<W)-1,w+=W}if(w>F){p&&Zl(0);break}h&&m(E+131072);var re=E+B;if(E<Ae){var ee=o-Ae,oe=Math.min(Ae,re);for(ee+E<0&&Zl(3);E<oe;++E)t[E]=i[ee+E]}for(;E<re;++E)t[E]=t[E-Ae]}}n.l=b,n.p=X,n.b=E,n.f=_,b&&(_=1,n.m=j,n.d=D,n.n=Q)}while(!_);return E!=t.length&&l?k4(t,0,E):t.subarray(0,E)},Zu=function(e,n,t){t<<=n&7;var i=n/8|0;e[i]|=t,e[i+1]|=t>>8},mf=function(e,n,t){t<<=n&7;var i=n/8|0;e[i]|=t,e[i+1]|=t>>8,e[i+2]|=t>>16},Z0=function(e,n){for(var t=[],i=0;i<e.length;++i)e[i]&&t.push({s:i,f:e[i]});var r=t.length,o=t.slice();if(!r)return{t:T4,l:0};if(r==1){var l=new ua(t[0].s+1);return l[t[0].s]=1,{t:l,l:1}}t.sort(function(Ie,nt){return Ie.f-nt.f}),t.push({s:-1,f:25001});var h=t[0],p=t[1],m=0,_=1,w=2;for(t[0]={s:-1,f:h.f+p.f,l:h,r:p};_!=r-1;)h=t[t[m].f<t[w].f?m++:w++],p=t[m!=_&&t[m].f<t[w].f?m++:w++],t[_++]={s:-1,f:h.f+p.f,l:h,r:p};for(var E=o[0].s,i=1;i<r;++i)o[i].s>E&&(E=o[i].s);var b=new cl(E+1),D=Ug(t[_-1],b,0);if(D>n){var i=0,j=0,Q=D-n,F=1<<Q;for(o.sort(function(nt,We){return b[We.s]-b[nt.s]||nt.f-We.f});i<r;++i){var V=o[i].s;if(b[V]>n)j+=F-(1<<D-b[V]),b[V]=n;else break}for(j>>=Q;j>0;){var pe=o[i].s;b[pe]<n?j-=1<<n-b[pe]++-1:++i}for(;i>=0&&j;--i){var Ee=o[i].s;b[Ee]==n&&(--b[Ee],++j)}D=n}return{t:new ua(b),l:D}},Ug=function(e,n,t){return e.s==-1?Math.max(Ug(e.l,n,t+1),Ug(e.r,n,t+1)):n[e.s]=t},ky=function(e){for(var n=e.length;n&&!e[--n];);for(var t=new cl(++n),i=0,r=e[0],o=1,l=function(p){t[i++]=p},h=1;h<=n;++h)if(e[h]==r&&h!=n)++o;else{if(!r&&o>2){for(;o>138;o-=138)l(32754);o>2&&(l(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(l(r),--o;o>6;o-=6)l(8304);o>2&&(l(o-3<<5|8208),o=0)}for(;o--;)l(r);o=1,r=e[h]}return{c:t.subarray(0,i),n}},vf=function(e,n){for(var t=0,i=0;i<n.length;++i)t+=e[i]*n[i];return t},M4=function(e,n,t){var i=t.length,r=Sm(n+2);e[r]=i&255,e[r+1]=i>>8,e[r+2]=e[r]^255,e[r+3]=e[r+1]^255;for(var o=0;o<i;++o)e[r+o+4]=t[o];return(r+4+i)*8},My=function(e,n,t,i,r,o,l,h,p,m,_){Zu(n,_++,t),++r[256];for(var w=Z0(r,15),E=w.t,b=w.l,D=Z0(o,15),j=D.t,Q=D.l,F=ky(E),V=F.c,pe=F.n,Ee=ky(j),Ie=Ee.c,nt=Ee.n,We=new cl(19),O=0;O<V.length;++O)++We[V[O]&31];for(var O=0;O<Ie.length;++O)++We[Ie[O]&31];for(var H=Z0(We,7),le=H.t,G=H.l,I=19;I>4&&!le[Fg[I-1]];--I);var Y=m+5<<3,$=vf(r,kc)+vf(o,Wf)+l,R=vf(r,E)+vf(o,j)+l+14+3*I+vf(We,le)+2*We[16]+3*We[17]+7*We[18];if(p>=0&&Y<=$&&Y<=R)return M4(n,_,e.subarray(p,p+m));var Z,se,ie,Ae;if(Zu(n,_,1+(R<$)),_+=2,R<$){Z=Eu(E,b,0),se=E,ie=Eu(j,Q,0),Ae=j;var Te=Eu(le,G,0);Zu(n,_,pe-257),Zu(n,_+5,nt-1),Zu(n,_+10,I-4),_+=14;for(var O=0;O<I;++O)Zu(n,_+3*O,le[Fg[O]]);_+=3*I;for(var ut=[V,Ie],X=0;X<2;++X)for(var ke=ut[X],O=0;O<ke.length;++O){var B=ke[O]&31;Zu(n,_,Te[B]),_+=le[B],B>15&&(Zu(n,_,ke[O]>>5&127),_+=ke[O]>>12)}}else Z=j7,se=kc,ie=$7,Ae=Wf;for(var O=0;O<h;++O){var W=i[O];if(W>255){var B=W>>18&31;mf(n,_,Z[B+257]),_+=se[B+257],B>7&&(Zu(n,_,W>>23&31),_+=Vp[B]);var he=W&31;mf(n,_,ie[he]),_+=Ae[he],he>3&&(mf(n,_,W>>5&8191),_+=Hp[he])}else mf(n,_,Z[W]),_+=se[W]}return mf(n,_,Z[256]),_+se[256]},H7=new Cm([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),T4=new ua(0),W7=function(e,n,t,i,r,o){var l=o.z||e.length,h=new ua(i+l+5*(1+Math.ceil(l/7e3))+r),p=h.subarray(i,h.length-r),m=o.l,_=(o.r||0)&7;if(n){_&&(p[0]=o.r>>3);for(var w=H7[n-1],E=w>>13,b=w&8191,D=(1<<t)-1,j=o.p||new cl(32768),Q=o.h||new cl(D+1),F=Math.ceil(t/3),V=2*F,pe=function(Le){return(e[Le]^e[Le+1]<<F^e[Le+2]<<V)&D},Ee=new Cm(25e3),Ie=new cl(288),nt=new cl(32),We=0,O=0,H=o.i||0,le=0,G=o.w||0,I=0;H+2<l;++H){var Y=pe(H),$=H&32767,R=Q[Y];if(j[$]=R,Q[Y]=$,G<=H){var Z=l-H;if((We>7e3||le>24576)&&(Z>423||!m)){_=My(e,p,0,Ee,Ie,nt,O,le,I,H-I,_),le=We=O=0,I=H;for(var se=0;se<286;++se)Ie[se]=0;for(var se=0;se<30;++se)nt[se]=0}var ie=2,Ae=0,Te=b,ut=$-R&32767;if(Z>2&&Y==pe(H-ut))for(var X=Math.min(E,Z)-1,ke=Math.min(32767,H),B=Math.min(258,Z);ut<=ke&&--Te&&$!=R;){if(e[H+ie]==e[H+ie-ut]){for(var W=0;W<B&&e[H+W]==e[H+W-ut];++W);if(W>ie){if(ie=W,Ae=ut,W>X)break;for(var he=Math.min(ut,W-2),ne=0,se=0;se<he;++se){var re=H-ut+se&32767,ee=j[re],oe=re-ee&32767;oe>ne&&(ne=oe,R=re)}}}$=R,R=j[$],ut+=$-R&32767}if(Ae){Ee[le++]=268435456|zg[ie]<<18|Ay[Ae];var Se=zg[ie]&31,te=Ay[Ae]&31;O+=Vp[Se]+Hp[te],++Ie[257+Se],++nt[te],G=H+ie,++We}else Ee[le++]=e[H],++Ie[e[H]]}}for(H=Math.max(H,G);H<l;++H)Ee[le++]=e[H],++Ie[e[H]];_=My(e,p,m,Ee,Ie,nt,O,le,I,H-I,_),m||(o.r=_&7|p[_/8|0]<<3,_-=7,o.h=Q,o.p=j,o.i=H,o.w=G)}else{for(var H=o.w||0;H<l+m;H+=65535){var ae=H+65535;ae>=l&&(p[_/8|0]=m,ae=l),_=M4(p,_+1,e.subarray(H,ae))}o.i=l}return k4(h,0,i+Sm(_)+r)},B4=function(){var e=1,n=0;return{p:function(t){for(var i=e,r=n,o=t.length|0,l=0;l!=o;){for(var h=Math.min(l+2655,o);l<h;++l)r+=i+=t[l];i=(i&65535)+15*(i>>16),r=(r&65535)+15*(r>>16)}e=i,n=r},d:function(){return e%=65521,n%=65521,(e&255)<<24|(e&65280)<<8|(n&255)<<8|n>>8}}},Z7=function(e,n,t,i,r){if(!r&&(r={l:1},n.dictionary)){var o=n.dictionary.subarray(-32768),l=new ua(o.length+e.length);l.set(o),l.set(e,o.length),e=l,r.w=o.length}return W7(e,n.level==null?6:n.level,n.mem==null?r.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+n.mem,t,i,r)},N4=function(e,n,t){for(;t;++n)e[n]=t,t>>>=8},K7=function(e,n){var t=n.level,i=t==0?0:t<6?1:t==9?3:2;if(e[0]=120,e[1]=i<<6|(n.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,n.dictionary){var r=B4();r.p(n.dictionary),N4(e,2,r.d())}},J7=function(e,n){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&Zl(6,"invalid zlib data"),(e[1]>>5&1)==1&&Zl(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function $g(e,n){n||(n={});var t=B4();t.p(e);var i=Z7(e,n,n.dictionary?6:2,4);return K7(i,n),N4(i,i.length-4,t.d()),i}function Y7(e,n){return V7(e.subarray(J7(e),-4),{i:2},n,n)}var X7=typeof TextDecoder<"u"&&new TextDecoder,Q7=0;try{X7.decode(T4,{stream:!0}),Q7=1}catch{}var xi=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function K0(){xi.console&&typeof xi.console.log=="function"&&xi.console.log.apply(xi.console,arguments)}var Kr={log:K0,warn:function(e){xi.console&&(typeof xi.console.warn=="function"?xi.console.warn.apply(xi.console,arguments):K0.call(null,arguments))},error:function(e){xi.console&&(typeof xi.console.error=="function"?xi.console.error.apply(xi.console,arguments):K0(e))}};function J0(e,n,t){var i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.onload=function(){Jc(i.response,n,t)},i.onerror=function(){Kr.error("could not download file")},i.send()}function Ty(e){var n=new XMLHttpRequest;n.open("HEAD",e,!1);try{n.send()}catch{}return n.status>=200&&n.status<=299}function kd(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(n)}}var Of,qg,Jc=xi.saveAs||((typeof window>"u"?"undefined":Fr(window))!=="object"||window!==xi?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,n,t){var i=xi.URL||xi.webkitURL,r=document.createElement("a");n=n||e.name||"download",r.download=n,r.rel="noopener",typeof e=="string"?(r.href=e,r.origin!==location.origin?Ty(r.href)?J0(e,n,t):kd(r,r.target="_blank"):kd(r)):(r.href=i.createObjectURL(e),setTimeout(function(){i.revokeObjectURL(r.href)},4e4),setTimeout(function(){kd(r)},0))}:"msSaveOrOpenBlob"in navigator?function(e,n,t){if(n=n||e.name||"download",typeof e=="string")if(Ty(e))J0(e,n,t);else{var i=document.createElement("a");i.href=e,i.target="_blank",setTimeout(function(){kd(i)})}else navigator.msSaveOrOpenBlob(function(r,o){return o===void 0?o={autoBom:!1}:Fr(o)!=="object"&&(Kr.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\uFEFF",r],{type:r.type}):r}(e,t),n)}:function(e,n,t,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),typeof e=="string")return J0(e,n,t);var r=e.type==="application/octet-stream",o=/constructor/i.test(xi.HTMLElement)||xi.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||r&&o)&&(typeof FileReader>"u"?"undefined":Fr(FileReader))==="object"){var h=new FileReader;h.onloadend=function(){var _=h.result;_=l?_:_.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=_:location=_,i=null},h.readAsDataURL(e)}else{var p=xi.URL||xi.webkitURL,m=p.createObjectURL(e);i?i.location=m:location.href=m,i=null,setTimeout(function(){p.revokeObjectURL(m)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function D4(e){var n;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(h){return[parseInt(h[1]),parseInt(h[2]),parseInt(h[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(h){return[parseInt(h[1],16),parseInt(h[2],16),parseInt(h[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(h){return[parseInt(h[1]+h[1],16),parseInt(h[2]+h[2],16),parseInt(h[3]+h[3],16)]}}],i=0;i<t.length;i++){var r=t[i].re,o=t[i].process,l=r.exec(e);l&&(n=o(l),this.r=n[0],this.g=n[1],this.b=n[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var h=this.r.toString(16),p=this.g.toString(16),m=this.b.toString(16);return h.length==1&&(h="0"+h),p.length==1&&(p="0"+p),m.length==1&&(m="0"+m),"#"+h+p+m}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Y0(e,n){var t=e[0],i=e[1],r=e[2],o=e[3];t=na(t,i,r,o,n[0],7,-680876936),o=na(o,t,i,r,n[1],12,-389564586),r=na(r,o,t,i,n[2],17,606105819),i=na(i,r,o,t,n[3],22,-1044525330),t=na(t,i,r,o,n[4],7,-176418897),o=na(o,t,i,r,n[5],12,1200080426),r=na(r,o,t,i,n[6],17,-1473231341),i=na(i,r,o,t,n[7],22,-45705983),t=na(t,i,r,o,n[8],7,1770035416),o=na(o,t,i,r,n[9],12,-1958414417),r=na(r,o,t,i,n[10],17,-42063),i=na(i,r,o,t,n[11],22,-1990404162),t=na(t,i,r,o,n[12],7,1804603682),o=na(o,t,i,r,n[13],12,-40341101),r=na(r,o,t,i,n[14],17,-1502002290),t=ia(t,i=na(i,r,o,t,n[15],22,1236535329),r,o,n[1],5,-165796510),o=ia(o,t,i,r,n[6],9,-1069501632),r=ia(r,o,t,i,n[11],14,643717713),i=ia(i,r,o,t,n[0],20,-373897302),t=ia(t,i,r,o,n[5],5,-701558691),o=ia(o,t,i,r,n[10],9,38016083),r=ia(r,o,t,i,n[15],14,-660478335),i=ia(i,r,o,t,n[4],20,-405537848),t=ia(t,i,r,o,n[9],5,568446438),o=ia(o,t,i,r,n[14],9,-1019803690),r=ia(r,o,t,i,n[3],14,-187363961),i=ia(i,r,o,t,n[8],20,1163531501),t=ia(t,i,r,o,n[13],5,-1444681467),o=ia(o,t,i,r,n[2],9,-51403784),r=ia(r,o,t,i,n[7],14,1735328473),t=ra(t,i=ia(i,r,o,t,n[12],20,-1926607734),r,o,n[5],4,-378558),o=ra(o,t,i,r,n[8],11,-2022574463),r=ra(r,o,t,i,n[11],16,1839030562),i=ra(i,r,o,t,n[14],23,-35309556),t=ra(t,i,r,o,n[1],4,-1530992060),o=ra(o,t,i,r,n[4],11,1272893353),r=ra(r,o,t,i,n[7],16,-155497632),i=ra(i,r,o,t,n[10],23,-1094730640),t=ra(t,i,r,o,n[13],4,681279174),o=ra(o,t,i,r,n[0],11,-358537222),r=ra(r,o,t,i,n[3],16,-722521979),i=ra(i,r,o,t,n[6],23,76029189),t=ra(t,i,r,o,n[9],4,-640364487),o=ra(o,t,i,r,n[12],11,-421815835),r=ra(r,o,t,i,n[15],16,530742520),t=sa(t,i=ra(i,r,o,t,n[2],23,-995338651),r,o,n[0],6,-198630844),o=sa(o,t,i,r,n[7],10,1126891415),r=sa(r,o,t,i,n[14],15,-1416354905),i=sa(i,r,o,t,n[5],21,-57434055),t=sa(t,i,r,o,n[12],6,1700485571),o=sa(o,t,i,r,n[3],10,-1894986606),r=sa(r,o,t,i,n[10],15,-1051523),i=sa(i,r,o,t,n[1],21,-2054922799),t=sa(t,i,r,o,n[8],6,1873313359),o=sa(o,t,i,r,n[15],10,-30611744),r=sa(r,o,t,i,n[6],15,-1560198380),i=sa(i,r,o,t,n[13],21,1309151649),t=sa(t,i,r,o,n[4],6,-145523070),o=sa(o,t,i,r,n[11],10,-1120210379),r=sa(r,o,t,i,n[2],15,718787259),i=sa(i,r,o,t,n[9],21,-343485551),e[0]=wc(t,e[0]),e[1]=wc(i,e[1]),e[2]=wc(r,e[2]),e[3]=wc(o,e[3])}function Wp(e,n,t,i,r,o){return n=wc(wc(n,e),wc(i,o)),wc(n<<r|n>>>32-r,t)}function na(e,n,t,i,r,o,l){return Wp(n&t|~n&i,e,n,r,o,l)}function ia(e,n,t,i,r,o,l){return Wp(n&i|t&~i,e,n,r,o,l)}function ra(e,n,t,i,r,o,l){return Wp(n^t^i,e,n,r,o,l)}function sa(e,n,t,i,r,o,l){return Wp(t^(n|~i),e,n,r,o,l)}function R4(e){var n,t=e.length,i=[1732584193,-271733879,-1732584194,271733878];for(n=64;n<=e.length;n+=64)Y0(i,eN(e.substring(n-64,n)));e=e.substring(n-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(n=0;n<e.length;n++)r[n>>2]|=e.charCodeAt(n)<<(n%4<<3);if(r[n>>2]|=128<<(n%4<<3),n>55)for(Y0(i,r),n=0;n<16;n++)r[n]=0;return r[14]=8*t,Y0(i,r),i}function eN(e){var n,t=[];for(n=0;n<64;n+=4)t[n>>2]=e.charCodeAt(n)+(e.charCodeAt(n+1)<<8)+(e.charCodeAt(n+2)<<16)+(e.charCodeAt(n+3)<<24);return t}Of=xi.atob.bind(xi),qg=xi.btoa.bind(xi);var By="0123456789abcdef".split("");function tN(e){for(var n="",t=0;t<4;t++)n+=By[e>>8*t+4&15]+By[e>>8*t&15];return n}function nN(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Gg(e){return R4(e).map(nN).join("")}var iN=function(e){for(var n=0;n<e.length;n++)e[n]=tN(e[n]);return e.join("")}(R4("hello"))!="5d41402abc4b2a76b9719d911017c592";function wc(e,n){if(iN){var t=(65535&e)+(65535&n);return(e>>16)+(n>>16)+(t>>16)<<16|65535&t}return e+n&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Vg(e,n){var t,i,r,o;if(e!==t){for(var l=(r=e,o=1+(256/e.length>>0),new Array(o+1).join(r)),h=[],p=0;p<256;p++)h[p]=p;var m=0;for(p=0;p<256;p++){var _=h[p];m=(m+_+l.charCodeAt(p))%256,h[p]=h[m],h[m]=_}t=e,i=h}else h=i;var w=n.length,E=0,b=0,D="";for(p=0;p<w;p++)b=(b+(_=h[E=(E+1)%256]))%256,h[E]=h[b],h[b]=_,l=h[(h[E]+h[b])%256],D+=String.fromCharCode(n.charCodeAt(p)^l);return D}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Ny={print:4,modify:8,copy:16,"annot-forms":32};function Oh(e,n,t,i){this.v=1,this.r=2;var r=192;e.forEach(function(h){if(Ny.perm!==void 0)throw new Error("Invalid permission: "+h);r+=Ny[h]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var o=(n+this.padding).substr(0,32),l=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,l),this.P=-(1+(255^r)),this.encryptionKey=Gg(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(i)).substr(0,5),this.U=Vg(this.encryptionKey,this.padding)}function Ih(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var n="",t=e.length,i=0;i<t;i++){var r=e.charCodeAt(i);r<33||r===35||r===37||r===40||r===41||r===47||r===60||r===62||r===91||r===93||r===123||r===125||r>126?n+="#"+("0"+r.toString(16)).slice(-2):n+=e[i]}return n}function Dy(e){if(Fr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var n={};this.subscribe=function(t,i,r){if(r=r||!1,typeof t!="string"||typeof i!="function"||typeof r!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");n.hasOwnProperty(t)||(n[t]={});var o=Math.random().toString(35);return n[t][o]=[i,!!r],o},this.unsubscribe=function(t){for(var i in n)if(n[i][t])return delete n[i][t],Object.keys(n[i]).length===0&&delete n[i],!0;return!1},this.publish=function(t){if(n.hasOwnProperty(t)){var i=Array.prototype.slice.call(arguments,1),r=[];for(var o in n[t]){var l=n[t][o];try{l[0].apply(e,i)}catch(h){xi.console&&Kr.error("jsPDF PubSub Error",h.message,h)}l[1]&&r.push(o)}r.length&&r.forEach(this.unsubscribe)}},this.getTopics=function(){return n}}function yp(e){if(!(this instanceof yp))return new yp(e);var n="opacity,stroke-opacity".split(",");for(var t in e)e.hasOwnProperty(t)&&n.indexOf(t)>=0&&(this[t]=e[t]);this.id="",this.objectNumber=-1}function O4(e,n){this.gState=e,this.matrix=n,this.id="",this.objectNumber=-1}function Qc(e,n,t,i,r){if(!(this instanceof Qc))return new Qc(e,n,t,i,r);this.type=e==="axial"?2:3,this.coords=n,this.colors=t,O4.call(this,i,r)}function Fh(e,n,t,i,r){if(!(this instanceof Fh))return new Fh(e,n,t,i,r);this.boundingBox=e,this.xStep=n,this.yStep=t,this.stream="",this.cloneIndex=0,O4.call(this,i,r)}function wi(e){var n,t=typeof arguments[0]=="string"?arguments[0]:"p",i=arguments[1],r=arguments[2],o=arguments[3],l=[],h=1,p=16,m="S",_=null;Fr(e=e||{})==="object"&&(t=e.orientation,i=e.unit||i,r=e.format||r,o=e.compress||e.compressPdf||o,(_=e.encryption||null)!==null&&(_.userPassword=_.userPassword||"",_.ownerPassword=_.ownerPassword||"",_.userPermissions=_.userPermissions||[]),h=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(n=e.precision),e.floatPrecision!==void 0&&(p=e.floatPrecision),m=e.defaultPathOperation||"S"),l=e.filters||(o===!0?["FlateEncode"]:l),i=i||"mm",t=(""+(t||"P")).toLowerCase();var w=e.putOnlyUsedFonts||!1,E={},b={internal:{},__private__:{}};b.__private__.PubSub=Dy;var D="1.3",j=b.__private__.getPdfVersion=function(){return D};b.__private__.setPdfVersion=function(k){D=k};var Q={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};b.__private__.getPageFormats=function(){return Q};var F=b.__private__.getPageFormat=function(k){return Q[k]};r=r||"a4";var V={COMPAT:"compat",ADVANCED:"advanced"},pe=V.COMPAT;function Ee(){this.saveGraphicsState(),ue(new Sn(it,0,0,-it,0,Ho()*it).toString()+" cm"),this.setFontSize(this.getFontSize()/it),m="n",pe=V.ADVANCED}function Ie(){this.restoreGraphicsState(),m="S",pe=V.COMPAT}var nt=b.__private__.combineFontStyleAndFontWeight=function(k,ge){if(k=="bold"&&ge=="normal"||k=="bold"&&ge==400||k=="normal"&&ge=="italic"||k=="bold"&&ge=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ge&&(k=ge==400||ge==="normal"?k==="italic"?"italic":"normal":ge!=700&&ge!=="bold"||k!=="normal"?(ge==700?"bold":ge)+""+k:"bold"),k};b.advancedAPI=function(k){var ge=pe===V.COMPAT;return ge&&Ee.call(this),typeof k!="function"||(k(this),ge&&Ie.call(this)),this},b.compatAPI=function(k){var ge=pe===V.ADVANCED;return ge&&Ie.call(this),typeof k!="function"||(k(this),ge&&Ee.call(this)),this},b.isAdvancedAPI=function(){return pe===V.ADVANCED};var We,O=function(k){if(pe!==V.ADVANCED)throw new Error(k+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},H=b.roundToPrecision=b.__private__.roundToPrecision=function(k,ge){var Je=n||ge;if(isNaN(k)||isNaN(Je))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return k.toFixed(Je).replace(/0+$/,"")};We=b.hpf=b.__private__.hpf=typeof p=="number"?function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return H(k,p)}:p==="smart"?function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return H(k,k>-1&&k<1?16:5)}:function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return H(k,16)};var le=b.f2=b.__private__.f2=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.f2");return H(k,2)},G=b.__private__.f3=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.f3");return H(k,3)},I=b.scale=b.__private__.scale=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.scale");return pe===V.COMPAT?k*it:pe===V.ADVANCED?k:void 0},Y=function(k){return pe===V.COMPAT?Ho()-k:pe===V.ADVANCED?k:void 0},$=function(k){return I(Y(k))};b.__private__.setPrecision=b.setPrecision=function(k){typeof parseInt(k,10)=="number"&&(n=parseInt(k,10))};var R,Z="00000000000000000000000000000000",se=b.__private__.getFileId=function(){return Z},ie=b.__private__.setFileId=function(k){return Z=k!==void 0&&/^[a-fA-F0-9]{32}$/.test(k)?k.toUpperCase():Z.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),_!==null&&(rs=new Oh(_.userPermissions,_.userPassword,_.ownerPassword,Z)),Z};b.setFileId=function(k){return ie(k),this},b.getFileId=function(){return se()};var Ae=b.__private__.convertDateToPDFDate=function(k){var ge=k.getTimezoneOffset(),Je=ge<0?"+":"-",dt=Math.floor(Math.abs(ge/60)),kt=Math.abs(ge%60),Ut=[Je,B(dt),"'",B(kt),"'"].join("");return["D:",k.getFullYear(),B(k.getMonth()+1),B(k.getDate()),B(k.getHours()),B(k.getMinutes()),B(k.getSeconds()),Ut].join("")},Te=b.__private__.convertPDFDateToDate=function(k){var ge=parseInt(k.substr(2,4),10),Je=parseInt(k.substr(6,2),10)-1,dt=parseInt(k.substr(8,2),10),kt=parseInt(k.substr(10,2),10),Ut=parseInt(k.substr(12,2),10),cn=parseInt(k.substr(14,2),10);return new Date(ge,Je,dt,kt,Ut,cn,0)},ut=b.__private__.setCreationDate=function(k){var ge;if(k===void 0&&(k=new Date),k instanceof Date)ge=Ae(k);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(k))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ge=k}return R=ge},X=b.__private__.getCreationDate=function(k){var ge=R;return k==="jsDate"&&(ge=Te(R)),ge};b.setCreationDate=function(k){return ut(k),this},b.getCreationDate=function(k){return X(k)};var ke,B=b.__private__.padd2=function(k){return("0"+parseInt(k)).slice(-2)},W=b.__private__.padd2Hex=function(k){return("00"+(k=k.toString())).substr(k.length)},he=0,ne=[],re=[],ee=0,oe=[],Se=[],te=!1,ae=re,Le=function(){he=0,ee=0,re=[],ne=[],oe=[],Si=yn(),Qi=yn()};b.__private__.setCustomOutputDestination=function(k){te=!0,ae=k};var ye=function(k){te||(ae=k)};b.__private__.resetCustomOutputDestination=function(){te=!1,ae=re};var ue=b.__private__.out=function(k){return k=k.toString(),ee+=k.length+1,ae.push(k),ae},Oe=b.__private__.write=function(k){return ue(arguments.length===1?k.toString():Array.prototype.join.call(arguments," "))},De=b.__private__.getArrayBuffer=function(k){for(var ge=k.length,Je=new ArrayBuffer(ge),dt=new Uint8Array(Je);ge--;)dt[ge]=k.charCodeAt(ge);return Je},Me=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];b.__private__.getStandardFonts=function(){return Me};var Ve=e.fontSize||16;b.__private__.setFontSize=b.setFontSize=function(k){return Ve=pe===V.ADVANCED?k/it:k,this};var ze,st=b.__private__.getFontSize=b.getFontSize=function(){return pe===V.COMPAT?Ve:Ve*it},Qe=e.R2L||!1;b.__private__.setR2L=b.setR2L=function(k){return Qe=k,this},b.__private__.getR2L=b.getR2L=function(){return Qe};var pt,wt=b.__private__.setZoomMode=function(k){var ge=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(k))ze=k;else if(isNaN(k)){if(ge.indexOf(k)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+k+'" is not recognized.');ze=k}else ze=parseInt(k,10)};b.__private__.getZoomMode=function(){return ze};var Ht,nn=b.__private__.setPageMode=function(k){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(k)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+k+'" is not recognized.');pt=k};b.__private__.getPageMode=function(){return pt};var tt=b.__private__.setLayoutMode=function(k){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(k)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+k+'" is not recognized.');Ht=k};b.__private__.getLayoutMode=function(){return Ht},b.__private__.setDisplayMode=b.setDisplayMode=function(k,ge,Je){return wt(k),tt(ge),nn(Je),this};var Qt={title:"",subject:"",author:"",keywords:"",creator:""};b.__private__.getDocumentProperty=function(k){if(Object.keys(Qt).indexOf(k)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Qt[k]},b.__private__.getDocumentProperties=function(){return Qt},b.__private__.setDocumentProperties=b.setProperties=b.setDocumentProperties=function(k){for(var ge in Qt)Qt.hasOwnProperty(ge)&&k[ge]&&(Qt[ge]=k[ge]);return this},b.__private__.setDocumentProperty=function(k,ge){if(Object.keys(Qt).indexOf(k)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Qt[k]=ge};var rn,it,Ke,qt,mn,xn={},wn={},ot=[],de={},_e={},$e={},Gt={},Dn=null,Ln=0,bt=[],_n=new Dy(b),$n=e.hotfixes||[],ni={},ri={},Li=[],Sn=function k(ge,Je,dt,kt,Ut,cn){if(!(this instanceof k))return new k(ge,Je,dt,kt,Ut,cn);isNaN(ge)&&(ge=1),isNaN(Je)&&(Je=0),isNaN(dt)&&(dt=0),isNaN(kt)&&(kt=1),isNaN(Ut)&&(Ut=0),isNaN(cn)&&(cn=0),this._matrix=[ge,Je,dt,kt,Ut,cn]};Object.defineProperty(Sn.prototype,"sx",{get:function(){return this._matrix[0]},set:function(k){this._matrix[0]=k}}),Object.defineProperty(Sn.prototype,"shy",{get:function(){return this._matrix[1]},set:function(k){this._matrix[1]=k}}),Object.defineProperty(Sn.prototype,"shx",{get:function(){return this._matrix[2]},set:function(k){this._matrix[2]=k}}),Object.defineProperty(Sn.prototype,"sy",{get:function(){return this._matrix[3]},set:function(k){this._matrix[3]=k}}),Object.defineProperty(Sn.prototype,"tx",{get:function(){return this._matrix[4]},set:function(k){this._matrix[4]=k}}),Object.defineProperty(Sn.prototype,"ty",{get:function(){return this._matrix[5]},set:function(k){this._matrix[5]=k}}),Object.defineProperty(Sn.prototype,"a",{get:function(){return this._matrix[0]},set:function(k){this._matrix[0]=k}}),Object.defineProperty(Sn.prototype,"b",{get:function(){return this._matrix[1]},set:function(k){this._matrix[1]=k}}),Object.defineProperty(Sn.prototype,"c",{get:function(){return this._matrix[2]},set:function(k){this._matrix[2]=k}}),Object.defineProperty(Sn.prototype,"d",{get:function(){return this._matrix[3]},set:function(k){this._matrix[3]=k}}),Object.defineProperty(Sn.prototype,"e",{get:function(){return this._matrix[4]},set:function(k){this._matrix[4]=k}}),Object.defineProperty(Sn.prototype,"f",{get:function(){return this._matrix[5]},set:function(k){this._matrix[5]=k}}),Object.defineProperty(Sn.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Sn.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Sn.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Sn.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Sn.prototype.join=function(k){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(We).join(k)},Sn.prototype.multiply=function(k){var ge=k.sx*this.sx+k.shy*this.shx,Je=k.sx*this.shy+k.shy*this.sy,dt=k.shx*this.sx+k.sy*this.shx,kt=k.shx*this.shy+k.sy*this.sy,Ut=k.tx*this.sx+k.ty*this.shx+this.tx,cn=k.tx*this.shy+k.ty*this.sy+this.ty;return new Sn(ge,Je,dt,kt,Ut,cn)},Sn.prototype.decompose=function(){var k=this.sx,ge=this.shy,Je=this.shx,dt=this.sy,kt=this.tx,Ut=this.ty,cn=Math.sqrt(k*k+ge*ge),Bn=(k/=cn)*Je+(ge/=cn)*dt;Je-=k*Bn,dt-=ge*Bn;var Rn=Math.sqrt(Je*Je+dt*dt);return Bn/=Rn,k*(dt/=Rn)<ge*(Je/=Rn)&&(k=-k,ge=-ge,Bn=-Bn,cn=-cn),{scale:new Sn(cn,0,0,Rn,0,0),translate:new Sn(1,0,0,1,kt,Ut),rotate:new Sn(k,ge,-ge,k,0,0),skew:new Sn(1,0,Bn,1,0,0)}},Sn.prototype.toString=function(k){return this.join(" ")},Sn.prototype.inversed=function(){var k=this.sx,ge=this.shy,Je=this.shx,dt=this.sy,kt=this.tx,Ut=this.ty,cn=1/(k*dt-ge*Je),Bn=dt*cn,Rn=-ge*cn,Yn=-Je*cn,ci=k*cn;return new Sn(Bn,Rn,Yn,ci,-Bn*kt-Yn*Ut,-Rn*kt-ci*Ut)},Sn.prototype.applyToPoint=function(k){var ge=k.x*this.sx+k.y*this.shx+this.tx,Je=k.x*this.shy+k.y*this.sy+this.ty;return new ls(ge,Je)},Sn.prototype.applyToRectangle=function(k){var ge=this.applyToPoint(k),Je=this.applyToPoint(new ls(k.x+k.w,k.y+k.h));return new mo(ge.x,ge.y,Je.x-ge.x,Je.y-ge.y)},Sn.prototype.clone=function(){var k=this.sx,ge=this.shy,Je=this.shx,dt=this.sy,kt=this.tx,Ut=this.ty;return new Sn(k,ge,Je,dt,kt,Ut)},b.Matrix=Sn;var Un=b.matrixMult=function(k,ge){return ge.multiply(k)},ui=new Sn(1,0,0,1,0,0);b.unitMatrix=b.identityMatrix=ui;var jn=function(k,ge){if(!_e[k]){var Je=(ge instanceof Qc?"Sh":"P")+(Object.keys(de).length+1).toString(10);ge.id=Je,_e[k]=Je,de[Je]=ge,_n.publish("addPattern",ge)}};b.ShadingPattern=Qc,b.TilingPattern=Fh,b.addShadingPattern=function(k,ge){return O("addShadingPattern()"),jn(k,ge),this},b.beginTilingPattern=function(k){O("beginTilingPattern()"),vo(k.boundingBox[0],k.boundingBox[1],k.boundingBox[2]-k.boundingBox[0],k.boundingBox[3]-k.boundingBox[1],k.matrix)},b.endTilingPattern=function(k,ge){O("endTilingPattern()"),ge.stream=Se[ke].join(`
`),jn(k,ge),_n.publish("endTilingPattern",ge),Li.pop().restore()};var Wt=b.__private__.newObject=function(){var k=yn();return Ci(k,!0),k},yn=b.__private__.newObjectDeferred=function(){return he++,ne[he]=function(){return ee},he},Ci=function(k,ge){return ge=typeof ge=="boolean"&&ge,ne[k]=ee,ge&&ue(k+" 0 obj"),k},qi=b.__private__.newAdditionalObject=function(){var k={objId:yn(),content:""};return oe.push(k),k},Si=yn(),Qi=yn(),fr=b.__private__.decodeColorString=function(k){var ge=k.split(" ");if(ge.length!==2||ge[1]!=="g"&&ge[1]!=="G")ge.length===5&&(ge[4]==="k"||ge[4]==="K")&&(ge=[(1-ge[0])*(1-ge[3]),(1-ge[1])*(1-ge[3]),(1-ge[2])*(1-ge[3]),"r"]);else{var Je=parseFloat(ge[0]);ge=[Je,Je,Je,"r"]}for(var dt="#",kt=0;kt<3;kt++)dt+=("0"+Math.floor(255*parseFloat(ge[kt])).toString(16)).slice(-2);return dt},Hn=b.__private__.encodeColorString=function(k){var ge;typeof k=="string"&&(k={ch1:k});var Je=k.ch1,dt=k.ch2,kt=k.ch3,Ut=k.ch4,cn=k.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Je=="string"&&Je.charAt(0)!=="#"){var Bn=new D4(Je);if(Bn.ok)Je=Bn.toHex();else if(!/^\d*\.?\d*$/.test(Je))throw new Error('Invalid color "'+Je+'" passed to jsPDF.encodeColorString.')}if(typeof Je=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Je)&&(Je="#"+Je[1]+Je[1]+Je[2]+Je[2]+Je[3]+Je[3]),typeof Je=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Je)){var Rn=parseInt(Je.substr(1),16);Je=Rn>>16&255,dt=Rn>>8&255,kt=255&Rn}if(dt===void 0||Ut===void 0&&Je===dt&&dt===kt)if(typeof Je=="string")ge=Je+" "+cn[0];else switch(k.precision){case 2:ge=le(Je/255)+" "+cn[0];break;case 3:default:ge=G(Je/255)+" "+cn[0]}else if(Ut===void 0||Fr(Ut)==="object"){if(Ut&&!isNaN(Ut.a)&&Ut.a===0)return ge=["1.","1.","1.",cn[1]].join(" ");if(typeof Je=="string")ge=[Je,dt,kt,cn[1]].join(" ");else switch(k.precision){case 2:ge=[le(Je/255),le(dt/255),le(kt/255),cn[1]].join(" ");break;default:case 3:ge=[G(Je/255),G(dt/255),G(kt/255),cn[1]].join(" ")}}else if(typeof Je=="string")ge=[Je,dt,kt,Ut,cn[2]].join(" ");else switch(k.precision){case 2:ge=[le(Je),le(dt),le(kt),le(Ut),cn[2]].join(" ");break;case 3:default:ge=[G(Je),G(dt),G(kt),G(Ut),cn[2]].join(" ")}return ge},ai=b.__private__.getFilters=function(){return l},rr=b.__private__.putStream=function(k){var ge=(k=k||{}).data||"",Je=k.filters||ai(),dt=k.alreadyAppliedFilters||[],kt=k.addLength1||!1,Ut=ge.length,cn=k.objectId,Bn=function(Hr){return Hr};if(_!==null&&cn===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");_!==null&&(Bn=rs.encryptor(cn,0));var Rn={};Je===!0&&(Je=["FlateEncode"]);var Yn=k.additionalKeyValues||[],ci=(Rn=wi.API.processDataByFilters!==void 0?wi.API.processDataByFilters(ge,Je):{data:ge,reverseChain:[]}).reverseChain+(Array.isArray(dt)?dt.join(" "):dt.toString());if(Rn.data.length!==0&&(Yn.push({key:"Length",value:Rn.data.length}),kt===!0&&Yn.push({key:"Length1",value:Ut})),ci.length!=0)if(ci.split("/").length-1==1)Yn.push({key:"Filter",value:ci});else{Yn.push({key:"Filter",value:"["+ci+"]"});for(var ki=0;ki<Yn.length;ki+=1)if(Yn[ki].key==="DecodeParms"){for(var Sr=[],er=0;er<Rn.reverseChain.split("/").length-1;er+=1)Sr.push("null");Sr.push(Yn[ki].value),Yn[ki].value="["+Sr.join(" ")+"]"}}ue("<<");for(var lr=0;lr<Yn.length;lr++)ue("/"+Yn[lr].key+" "+Yn[lr].value);ue(">>"),Rn.data.length!==0&&(ue("stream"),ue(Bn(Rn.data)),ue("endstream"))},Yi=b.__private__.putPage=function(k){var ge=k.number,Je=k.data,dt=k.objId,kt=k.contentsObjId;Ci(dt,!0),ue("<</Type /Page"),ue("/Parent "+k.rootDictionaryObjId+" 0 R"),ue("/Resources "+k.resourceDictionaryObjId+" 0 R"),ue("/MediaBox ["+parseFloat(We(k.mediaBox.bottomLeftX))+" "+parseFloat(We(k.mediaBox.bottomLeftY))+" "+We(k.mediaBox.topRightX)+" "+We(k.mediaBox.topRightY)+"]"),k.cropBox!==null&&ue("/CropBox ["+We(k.cropBox.bottomLeftX)+" "+We(k.cropBox.bottomLeftY)+" "+We(k.cropBox.topRightX)+" "+We(k.cropBox.topRightY)+"]"),k.bleedBox!==null&&ue("/BleedBox ["+We(k.bleedBox.bottomLeftX)+" "+We(k.bleedBox.bottomLeftY)+" "+We(k.bleedBox.topRightX)+" "+We(k.bleedBox.topRightY)+"]"),k.trimBox!==null&&ue("/TrimBox ["+We(k.trimBox.bottomLeftX)+" "+We(k.trimBox.bottomLeftY)+" "+We(k.trimBox.topRightX)+" "+We(k.trimBox.topRightY)+"]"),k.artBox!==null&&ue("/ArtBox ["+We(k.artBox.bottomLeftX)+" "+We(k.artBox.bottomLeftY)+" "+We(k.artBox.topRightX)+" "+We(k.artBox.topRightY)+"]"),typeof k.userUnit=="number"&&k.userUnit!==1&&ue("/UserUnit "+k.userUnit),_n.publish("putPage",{objId:dt,pageContext:bt[ge],pageNumber:ge,page:Je}),ue("/Contents "+kt+" 0 R"),ue(">>"),ue("endobj");var Ut=Je.join(`
`);return pe===V.ADVANCED&&(Ut+=`
Q`),Ci(kt,!0),rr({data:Ut,filters:ai(),objectId:kt}),ue("endobj"),dt},Pi=b.__private__.putPages=function(){var k,ge,Je=[];for(k=1;k<=Ln;k++)bt[k].objId=yn(),bt[k].contentsObjId=yn();for(k=1;k<=Ln;k++)Je.push(Yi({number:k,data:Se[k],objId:bt[k].objId,contentsObjId:bt[k].contentsObjId,mediaBox:bt[k].mediaBox,cropBox:bt[k].cropBox,bleedBox:bt[k].bleedBox,trimBox:bt[k].trimBox,artBox:bt[k].artBox,userUnit:bt[k].userUnit,rootDictionaryObjId:Si,resourceDictionaryObjId:Qi}));Ci(Si,!0),ue("<</Type /Pages");var dt="/Kids [";for(ge=0;ge<Ln;ge++)dt+=Je[ge]+" 0 R ";ue(dt+"]"),ue("/Count "+Ln),ue(">>"),ue("endobj"),_n.publish("postPutPages")},kn=function(k){_n.publish("putFont",{font:k,out:ue,newObject:Wt,putStream:rr}),k.isAlreadyPutted!==!0&&(k.objectNumber=Wt(),ue("<<"),ue("/Type /Font"),ue("/BaseFont /"+Ih(k.postScriptName)),ue("/Subtype /Type1"),typeof k.encoding=="string"&&ue("/Encoding /"+k.encoding),ue("/FirstChar 32"),ue("/LastChar 255"),ue(">>"),ue("endobj"))},xr=function(){for(var k in xn)xn.hasOwnProperty(k)&&(w===!1||w===!0&&E.hasOwnProperty(k))&&kn(xn[k])},Gi=function(k){k.objectNumber=Wt();var ge=[];ge.push({key:"Type",value:"/XObject"}),ge.push({key:"Subtype",value:"/Form"}),ge.push({key:"BBox",value:"["+[We(k.x),We(k.y),We(k.x+k.width),We(k.y+k.height)].join(" ")+"]"}),ge.push({key:"Matrix",value:"["+k.matrix.toString()+"]"});var Je=k.pages[1].join(`
`);rr({data:Je,additionalKeyValues:ge,objectId:k.objectNumber}),ue("endobj")},Wi=function(){for(var k in ni)ni.hasOwnProperty(k)&&Gi(ni[k])},dr=function(k,ge){var Je,dt=[],kt=1/(ge-1);for(Je=0;Je<1;Je+=kt)dt.push(Je);if(dt.push(1),k[0].offset!=0){var Ut={offset:0,color:k[0].color};k.unshift(Ut)}if(k[k.length-1].offset!=1){var cn={offset:1,color:k[k.length-1].color};k.push(cn)}for(var Bn="",Rn=0,Yn=0;Yn<dt.length;Yn++){for(Je=dt[Yn];Je>k[Rn+1].offset;)Rn++;var ci=k[Rn].offset,ki=(Je-ci)/(k[Rn+1].offset-ci),Sr=k[Rn].color,er=k[Rn+1].color;Bn+=W(Math.round((1-ki)*Sr[0]+ki*er[0]).toString(16))+W(Math.round((1-ki)*Sr[1]+ki*er[1]).toString(16))+W(Math.round((1-ki)*Sr[2]+ki*er[2]).toString(16))}return Bn.trim()},zr=function(k,ge){ge||(ge=21);var Je=Wt(),dt=dr(k.colors,ge),kt=[];kt.push({key:"FunctionType",value:"0"}),kt.push({key:"Domain",value:"[0.0 1.0]"}),kt.push({key:"Size",value:"["+ge+"]"}),kt.push({key:"BitsPerSample",value:"8"}),kt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),kt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),rr({data:dt,additionalKeyValues:kt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Je}),ue("endobj"),k.objectNumber=Wt(),ue("<< /ShadingType "+k.type),ue("/ColorSpace /DeviceRGB");var Ut="/Coords ["+We(parseFloat(k.coords[0]))+" "+We(parseFloat(k.coords[1]))+" ";k.type===2?Ut+=We(parseFloat(k.coords[2]))+" "+We(parseFloat(k.coords[3])):Ut+=We(parseFloat(k.coords[2]))+" "+We(parseFloat(k.coords[3]))+" "+We(parseFloat(k.coords[4]))+" "+We(parseFloat(k.coords[5])),ue(Ut+="]"),k.matrix&&ue("/Matrix ["+k.matrix.toString()+"]"),ue("/Function "+Je+" 0 R"),ue("/Extend [true true]"),ue(">>"),ue("endobj")},Vi=function(k,ge){var Je=yn(),dt=Wt();ge.push({resourcesOid:Je,objectOid:dt}),k.objectNumber=dt;var kt=[];kt.push({key:"Type",value:"/Pattern"}),kt.push({key:"PatternType",value:"1"}),kt.push({key:"PaintType",value:"1"}),kt.push({key:"TilingType",value:"1"}),kt.push({key:"BBox",value:"["+k.boundingBox.map(We).join(" ")+"]"}),kt.push({key:"XStep",value:We(k.xStep)}),kt.push({key:"YStep",value:We(k.yStep)}),kt.push({key:"Resources",value:Je+" 0 R"}),k.matrix&&kt.push({key:"Matrix",value:"["+k.matrix.toString()+"]"}),rr({data:k.stream,additionalKeyValues:kt,objectId:k.objectNumber}),ue("endobj")},fi=function(k){var ge;for(ge in de)de.hasOwnProperty(ge)&&(de[ge]instanceof Qc?zr(de[ge]):de[ge]instanceof Fh&&Vi(de[ge],k))},gs=function(k){for(var ge in k.objectNumber=Wt(),ue("<<"),k)switch(ge){case"opacity":ue("/ca "+le(k[ge]));break;case"stroke-opacity":ue("/CA "+le(k[ge]))}ue(">>"),ue("endobj")},Pr=function(){var k;for(k in $e)$e.hasOwnProperty(k)&&gs($e[k])},Rr=function(){for(var k in ue("/XObject <<"),ni)ni.hasOwnProperty(k)&&ni[k].objectNumber>=0&&ue("/"+k+" "+ni[k].objectNumber+" 0 R");_n.publish("putXobjectDict"),ue(">>")},Ai=function(){rs.oid=Wt(),ue("<<"),ue("/Filter /Standard"),ue("/V "+rs.v),ue("/R "+rs.r),ue("/U <"+rs.toHexString(rs.U)+">"),ue("/O <"+rs.toHexString(rs.O)+">"),ue("/P "+rs.P),ue(">>"),ue("endobj")},En=function(){for(var k in ue("/Font <<"),xn)xn.hasOwnProperty(k)&&(w===!1||w===!0&&E.hasOwnProperty(k))&&ue("/"+k+" "+xn[k].objectNumber+" 0 R");ue(">>")},hn=function(){if(Object.keys(de).length>0){for(var k in ue("/Shading <<"),de)de.hasOwnProperty(k)&&de[k]instanceof Qc&&de[k].objectNumber>=0&&ue("/"+k+" "+de[k].objectNumber+" 0 R");_n.publish("putShadingPatternDict"),ue(">>")}},di=function(k){if(Object.keys(de).length>0){for(var ge in ue("/Pattern <<"),de)de.hasOwnProperty(ge)&&de[ge]instanceof b.TilingPattern&&de[ge].objectNumber>=0&&de[ge].objectNumber<k&&ue("/"+ge+" "+de[ge].objectNumber+" 0 R");_n.publish("putTilingPatternDict"),ue(">>")}},li=function(){if(Object.keys($e).length>0){var k;for(k in ue("/ExtGState <<"),$e)$e.hasOwnProperty(k)&&$e[k].objectNumber>=0&&ue("/"+k+" "+$e[k].objectNumber+" 0 R");_n.publish("putGStateDict"),ue(">>")}},Wn=function(k){Ci(k.resourcesOid,!0),ue("<<"),ue("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),En(),hn(),di(k.objectOid),li(),Rr(),ue(">>"),ue("endobj")},as=function(){var k=[];xr(),Pr(),Wi(),fi(k),_n.publish("putResources"),k.forEach(Wn),Wn({resourcesOid:Qi,objectOid:Number.MAX_SAFE_INTEGER}),_n.publish("postPutResources")},Ms=function(){_n.publish("putAdditionalObjects");for(var k=0;k<oe.length;k++){var ge=oe[k];Ci(ge.objId,!0),ue(ge.content),ue("endobj")}_n.publish("postPutAdditionalObjects")},jr=function(k){wn[k.fontName]=wn[k.fontName]||{},wn[k.fontName][k.fontStyle]=k.id},ao=function(k,ge,Je,dt,kt){var Ut={id:"F"+(Object.keys(xn).length+1).toString(10),postScriptName:k,fontName:ge,fontStyle:Je,encoding:dt,isStandardFont:kt||!1,metadata:{}};return _n.publish("addFont",{font:Ut,instance:this}),xn[Ut.id]=Ut,jr(Ut),Ut.id},dn=function(k){for(var ge=0,Je=Me.length;ge<Je;ge++){var dt=ao.call(this,k[ge][0],k[ge][1],k[ge][2],Me[ge][3],!0);w===!1&&(E[dt]=!0);var kt=k[ge][0].split("-");jr({id:dt,fontName:kt[0],fontStyle:kt[1]||""})}_n.publish("addFonts",{fonts:xn,dictionary:wn})},si=function(k){return k.foo=function(){try{return k.apply(this,arguments)}catch(dt){var ge=dt.stack||"";~ge.indexOf(" at ")&&(ge=ge.split(" at ")[1]);var Je="Error in function "+ge.split(`
`)[0].split("<")[0]+": "+dt.message;if(!xi.console)throw new Error(Je);xi.console.error(Je,dt),xi.alert&&alert(Je)}},k.foo.bar=k,k.foo},Er=function(k,ge){var Je,dt,kt,Ut,cn,Bn,Rn,Yn,ci;if(kt=(ge=ge||{}).sourceEncoding||"Unicode",cn=ge.outputEncoding,(ge.autoencode||cn)&&xn[rn].metadata&&xn[rn].metadata[kt]&&xn[rn].metadata[kt].encoding&&(Ut=xn[rn].metadata[kt].encoding,!cn&&xn[rn].encoding&&(cn=xn[rn].encoding),!cn&&Ut.codePages&&(cn=Ut.codePages[0]),typeof cn=="string"&&(cn=Ut[cn]),cn)){for(Rn=!1,Bn=[],Je=0,dt=k.length;Je<dt;Je++)(Yn=cn[k.charCodeAt(Je)])?Bn.push(String.fromCharCode(Yn)):Bn.push(k[Je]),Bn[Je].charCodeAt(0)>>8&&(Rn=!0);k=Bn.join("")}for(Je=k.length;Rn===void 0&&Je!==0;)k.charCodeAt(Je-1)>>8&&(Rn=!0),Je--;if(!Rn)return k;for(Bn=ge.noBOM?[]:[254,255],Je=0,dt=k.length;Je<dt;Je++){if((ci=(Yn=k.charCodeAt(Je))>>8)>>8)throw new Error("Character at position "+Je+" of string '"+k+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Bn.push(ci),Bn.push(Yn-(ci<<8))}return String.fromCharCode.apply(void 0,Bn)},vr=b.__private__.pdfEscape=b.pdfEscape=function(k,ge){return Er(k,ge).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Lr=b.__private__.beginPage=function(k){Se[++Ln]=[],bt[Ln]={objId:0,contentsObjId:0,userUnit:Number(h),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(k[0]),topRightY:Number(k[1])}},Eo(Ln),ye(Se[ke])},Ea=function(k,ge){var Je,dt,kt;switch(t=ge||t,typeof k=="string"&&(Je=F(k.toLowerCase()),Array.isArray(Je)&&(dt=Je[0],kt=Je[1])),Array.isArray(k)&&(dt=k[0]*it,kt=k[1]*it),isNaN(dt)&&(dt=r[0],kt=r[1]),(dt>14400||kt>14400)&&(Kr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),dt=Math.min(14400,dt),kt=Math.min(14400,kt)),r=[dt,kt],t.substr(0,1)){case"l":kt>dt&&(r=[kt,dt]);break;case"p":dt>kt&&(r=[kt,dt])}Lr(r),Ya(dl),ue(Ar),el!==0&&ue(el+" J"),or!==0&&ue(or+" j"),_n.publish("addPage",{pageNumber:Ln})},Po=function(k){k>0&&k<=Ln&&(Se.splice(k,1),bt.splice(k,1),Ln--,ke>Ln&&(ke=Ln),this.setPage(ke))},Eo=function(k){k>0&&k<=Ln&&(ke=k)},Cr=b.__private__.getNumberOfPages=b.getNumberOfPages=function(){return Se.length-1},Ts=function(k,ge,Je){var dt,kt=void 0;return Je=Je||{},k=k!==void 0?k:xn[rn].fontName,ge=ge!==void 0?ge:xn[rn].fontStyle,dt=k.toLowerCase(),wn[dt]!==void 0&&wn[dt][ge]!==void 0?kt=wn[dt][ge]:wn[k]!==void 0&&wn[k][ge]!==void 0?kt=wn[k][ge]:Je.disableWarning===!1&&Kr.warn("Unable to look up font label for font '"+k+"', '"+ge+"'. Refer to getFontList() for available fonts."),kt||Je.noFallback||(kt=wn.times[ge])==null&&(kt=wn.times.normal),kt},lo=b.__private__.putInfo=function(){var k=Wt(),ge=function(dt){return dt};for(var Je in _!==null&&(ge=rs.encryptor(k,0)),ue("<<"),ue("/Producer ("+vr(ge("jsPDF "+wi.version))+")"),Qt)Qt.hasOwnProperty(Je)&&Qt[Je]&&ue("/"+Je.substr(0,1).toUpperCase()+Je.substr(1)+" ("+vr(ge(Qt[Je]))+")");ue("/CreationDate ("+vr(ge(R))+")"),ue(">>"),ue("endobj")},Bs=b.__private__.putCatalog=function(k){var ge=(k=k||{}).rootDictionaryObjId||Si;switch(Wt(),ue("<<"),ue("/Type /Catalog"),ue("/Pages "+ge+" 0 R"),ze||(ze="fullwidth"),ze){case"fullwidth":ue("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ue("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ue("/OpenAction [3 0 R /Fit]");break;case"original":ue("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Je=""+ze;Je.substr(Je.length-1)==="%"&&(ze=parseInt(ze)/100),typeof ze=="number"&&ue("/OpenAction [3 0 R /XYZ null null "+le(ze)+"]")}switch(Ht||(Ht="continuous"),Ht){case"continuous":ue("/PageLayout /OneColumn");break;case"single":ue("/PageLayout /SinglePage");break;case"two":case"twoleft":ue("/PageLayout /TwoColumnLeft");break;case"tworight":ue("/PageLayout /TwoColumnRight")}pt&&ue("/PageMode /"+pt),_n.publish("putCatalog"),ue(">>"),ue("endobj")},sr=b.__private__.putTrailer=function(){ue("trailer"),ue("<<"),ue("/Size "+(he+1)),ue("/Root "+he+" 0 R"),ue("/Info "+(he-1)+" 0 R"),_!==null&&ue("/Encrypt "+rs.oid+" 0 R"),ue("/ID [ <"+Z+"> <"+Z+"> ]"),ue(">>")},ms=b.__private__.putHeader=function(){ue("%PDF-"+D),ue("%ºß¬à")},vs=b.__private__.putXRef=function(){var k="0000000000";ue("xref"),ue("0 "+(he+1)),ue("0000000000 65535 f ");for(var ge=1;ge<=he;ge++)typeof ne[ge]=="function"?ue((k+ne[ge]()).slice(-10)+" 00000 n "):ne[ge]!==void 0?ue((k+ne[ge]).slice(-10)+" 00000 n "):ue("0000000000 00000 n ")},fo=b.__private__.buildDocument=function(){Le(),ye(re),_n.publish("buildDocument"),ms(),Pi(),Ms(),as(),_!==null&&Ai(),lo(),Bs();var k=ee;return vs(),sr(),ue("startxref"),ue(""+k),ue("%%EOF"),ye(Se[ke]),re.join(`
`)},Go=b.__private__.getBlob=function(k){return new Blob([De(k)],{type:"application/pdf"})},ca=b.output=b.__private__.output=si(function(k,ge){switch(typeof(ge=ge||{})=="string"?ge={filename:ge}:ge.filename=ge.filename||"generated.pdf",k){case void 0:return fo();case"save":b.save(ge.filename);break;case"arraybuffer":return De(fo());case"blob":return Go(fo());case"bloburi":case"bloburl":if(xi.URL!==void 0&&typeof xi.URL.createObjectURL=="function")return xi.URL&&xi.URL.createObjectURL(Go(fo()))||void 0;Kr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Je="",dt=fo();try{Je=qg(dt)}catch{Je=qg(unescape(encodeURIComponent(dt)))}return"data:application/pdf;filename="+ge.filename+";base64,"+Je;case"pdfobjectnewwindow":if(Object.prototype.toString.call(xi)==="[object Window]"){var kt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ut=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ge.pdfObjectUrl&&(kt=ge.pdfObjectUrl,Ut="");var cn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+kt+'"'+Ut+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ge)+");<\/script></body></html>",Bn=xi.open();return Bn!==null&&Bn.document.write(cn),Bn}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(xi)==="[object Window]"){var Rn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ge.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ge.filename+'" width="500px" height="400px" /></body></html>',Yn=xi.open();if(Yn!==null){Yn.document.write(Rn);var ci=this;Yn.document.documentElement.querySelector("#pdfViewer").onload=function(){Yn.document.title=ge.filename,Yn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(ci.output("bloburl"))}}return Yn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(xi)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var ki='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ge)+'"></iframe></body></html>',Sr=xi.open();if(Sr!==null&&(Sr.document.write(ki),Sr.document.title=ge.filename),Sr||typeof safari>"u")return Sr;break;case"datauri":case"dataurl":return xi.document.location.href=this.output("datauristring",ge);default:return null}}),Za=function(k){return Array.isArray($n)===!0&&$n.indexOf(k)>-1};switch(i){case"pt":it=1;break;case"mm":it=72/25.4;break;case"cm":it=72/2.54;break;case"in":it=72;break;case"px":it=Za("px_scaling")==1?.75:96/72;break;case"pc":case"em":it=12;break;case"ex":it=6;break;default:if(typeof i!="number")throw new Error("Invalid unit: "+i);it=i}var rs=null;ut(),ie();var ou=function(k){return _!==null?rs.encryptor(k,0):function(ge){return ge}},fl=b.__private__.getPageInfo=b.getPageInfo=function(k){if(isNaN(k)||k%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:bt[k].objId,pageNumber:k,pageContext:bt[k]}},pi=b.__private__.getPageInfoByObjId=function(k){if(isNaN(k)||k%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ge in bt)if(bt[ge].objId===k)break;return fl(ge)},yi=b.__private__.getCurrentPageInfo=b.getCurrentPageInfo=function(){return{objId:bt[ke].objId,pageNumber:ke,pageContext:bt[ke]}};b.addPage=function(){return Ea.apply(this,arguments),this},b.setPage=function(){return Eo.apply(this,arguments),ye.call(this,Se[ke]),this},b.insertPage=function(k){return this.addPage(),this.movePage(ke,k),this},b.movePage=function(k,ge){var Je,dt;if(k>ge){Je=Se[k],dt=bt[k];for(var kt=k;kt>ge;kt--)Se[kt]=Se[kt-1],bt[kt]=bt[kt-1];Se[ge]=Je,bt[ge]=dt,this.setPage(ge)}else if(k<ge){Je=Se[k],dt=bt[k];for(var Ut=k;Ut<ge;Ut++)Se[Ut]=Se[Ut+1],bt[Ut]=bt[Ut+1];Se[ge]=Je,bt[ge]=dt,this.setPage(ge)}return this},b.deletePage=function(){return Po.apply(this,arguments),this},b.__private__.text=b.text=function(k,ge,Je,dt,kt){var Ut,cn,Bn,Rn,Yn,ci,ki,Sr,er,lr=(dt=dt||{}).scope||this;if(typeof k=="number"&&typeof ge=="number"&&(typeof Je=="string"||Array.isArray(Je))){var Hr=Je;Je=ge,ge=k,k=Hr}if(arguments[3]instanceof Sn?(O("The transform parameter of text() with a Matrix value"),er=kt):(Bn=arguments[4],Rn=arguments[5],Fr(ki=arguments[3])==="object"&&ki!==null||(typeof Bn=="string"&&(Rn=Bn,Bn=null),typeof ki=="string"&&(Rn=ki,ki=null),typeof ki=="number"&&(Bn=ki,ki=null),dt={flags:ki,angle:Bn,align:Rn})),isNaN(ge)||isNaN(Je)||k==null)throw new Error("Invalid arguments passed to jsPDF.text");if(k.length===0)return lr;var Qr="",no=!1,Mi=typeof dt.lineHeightFactor=="number"?dt.lineHeightFactor:Ja,ys=lr.internal.scaleFactor;function Da(cr){return cr=cr.split("	").join(Array(dt.TabLen||9).join(" ")),vr(cr,ki)}function Ns(cr){for(var pr,Wr=cr.concat(),_r=[],so=Wr.length;so--;)typeof(pr=Wr.shift())=="string"?_r.push(pr):Array.isArray(cr)&&(pr.length===1||pr[1]===void 0&&pr[2]===void 0)?_r.push(pr[0]):_r.push([pr[0],pr[1],pr[2]]);return _r}function ml(cr,pr){var Wr;if(typeof cr=="string")Wr=pr(cr)[0];else if(Array.isArray(cr)){for(var _r,so,$s=cr.concat(),co=[],Ol=$s.length;Ol--;)typeof(_r=$s.shift())=="string"?co.push(pr(_r)[0]):Array.isArray(_r)&&typeof _r[0]=="string"&&(so=pr(_r[0],_r[1],_r[2]),co.push([so[0],so[1],so[2]]));Wr=co}return Wr}var ko=!1,Rl=!0;if(typeof k=="string")ko=!0;else if(Array.isArray(k)){var da=k.concat();cn=[];for(var pa,es=da.length;es--;)(typeof(pa=da.shift())!="string"||Array.isArray(pa)&&typeof pa[0]!="string")&&(Rl=!1);ko=Rl}if(ko===!1)throw new Error('Type of text must be string or Array. "'+k+'" is not recognized.');typeof k=="string"&&(k=k.match(/[\r?\n]/)?k.split(/\r\n|\r|\n/g):[k]);var Mo=Ve/lr.internal.scaleFactor,io=Mo*(Mi-1);switch(dt.baseline){case"bottom":Je-=io;break;case"top":Je+=Mo-io;break;case"hanging":Je+=Mo-2*io;break;case"middle":Je+=Mo/2-io}if((ci=dt.maxWidth||0)>0&&(typeof k=="string"?k=lr.splitTextToSize(k,ci):Object.prototype.toString.call(k)==="[object Array]"&&(k=k.reduce(function(cr,pr){return cr.concat(lr.splitTextToSize(pr,ci))},[]))),Ut={text:k,x:ge,y:Je,options:dt,mutex:{pdfEscape:vr,activeFontKey:rn,fonts:xn,activeFontSize:Ve}},_n.publish("preProcessText",Ut),k=Ut.text,Bn=(dt=Ut.options).angle,!(er instanceof Sn)&&Bn&&typeof Bn=="number"){Bn*=Math.PI/180,dt.rotationDirection===0&&(Bn=-Bn),pe===V.ADVANCED&&(Bn=-Bn);var Us=Math.cos(Bn),Ra=Math.sin(Bn);er=new Sn(Us,Ra,-Ra,Us,0,0)}else Bn&&Bn instanceof Sn&&(er=Bn);pe!==V.ADVANCED||er||(er=ui),(Yn=dt.charSpace||Qa)!==void 0&&(Qr+=We(I(Yn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Sr=dt.horizontalScale)!==void 0&&(Qr+=We(100*Sr)+` Tz
`),dt.lang;var _s=-1,Ds=dt.renderingMode!==void 0?dt.renderingMode:dt.stroke,Rs=lr.internal.getCurrentPageInfo().pageContext;switch(Ds){case 0:case!1:case"fill":_s=0;break;case 1:case!0:case"stroke":_s=1;break;case 2:case"fillThenStroke":_s=2;break;case 3:case"invisible":_s=3;break;case 4:case"fillAndAddForClipping":_s=4;break;case 5:case"strokeAndAddPathForClipping":_s=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":_s=6;break;case 7:case"addToPathForClipping":_s=7}var uu=Rs.usedRenderingMode!==void 0?Rs.usedRenderingMode:-1;_s!==-1?Qr+=_s+` Tr
`:uu!==-1&&(Qr+=`0 Tr
`),_s!==-1&&(Rs.usedRenderingMode=_s),Rn=dt.align||"left";var ss,Wo=Ve*Mi,bs=lr.internal.pageSize.getWidth(),ws=xn[rn];Yn=dt.charSpace||Qa,ci=dt.maxWidth||0,ki=Object.assign({autoencode:!0,noBOM:!0},dt.flags);var Zo=[],Ko=function(cr){return lr.getStringUnitWidth(cr,{font:ws,charSpace:Yn,fontSize:Ve,doKerning:!1})*Ve/ys};if(Object.prototype.toString.call(k)==="[object Array]"){var xs;cn=Ns(k),Rn!=="left"&&(ss=cn.map(Ko));var us,To=0;if(Rn==="right"){ge-=ss[0],k=[],es=cn.length;for(var ro=0;ro<es;ro++)ro===0?(us=Qn(ge),xs=Gr(Je)):(us=I(To-ss[ro]),xs=-Wo),k.push([cn[ro],us,xs]),To=ss[ro]}else if(Rn==="center"){ge-=ss[0]/2,k=[],es=cn.length;for(var Ls=0;Ls<es;Ls++)Ls===0?(us=Qn(ge),xs=Gr(Je)):(us=I((To-ss[Ls])/2),xs=-Wo),k.push([cn[Ls],us,xs]),To=ss[Ls]}else if(Rn==="left"){k=[],es=cn.length;for(var Ct=0;Ct<es;Ct++)k.push(cn[Ct])}else if(Rn==="justify"&&ws.encoding==="Identity-H"){k=[],es=cn.length,ci=ci!==0?ci:bs;for(var Zt=0,Rt=0;Rt<es;Rt++)if(xs=Rt===0?Gr(Je):-Wo,us=Rt===0?Qn(ge):Zt,Rt<es-1){var Mn=I((ci-ss[Rt])/(cn[Rt].split(" ").length-1)),qn=cn[Rt].split(" ");k.push([qn[0]+" ",us,xs]),Zt=0;for(var gi=1;gi<qn.length;gi++){var kr=(Ko(qn[gi-1]+" "+qn[gi])-Ko(qn[gi]))*ys+Mn;gi==qn.length-1?k.push([qn[gi],kr,0]):k.push([qn[gi]+" ",kr,0]),Zt-=kr}}else k.push([cn[Rt],us,xs]);k.push(["",Zt,0])}else{if(Rn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(k=[],es=cn.length,ci=ci!==0?ci:bs,Rt=0;Rt<es;Rt++)xs=Rt===0?Gr(Je):-Wo,us=Rt===0?Qn(ge):0,Rt<es-1?Zo.push(We(I((ci-ss[Rt])/(cn[Rt].split(" ").length-1)))):Zo.push(0),k.push([cn[Rt],us,xs])}}var ur=typeof dt.R2L=="boolean"?dt.R2L:Qe;ur===!0&&(k=ml(k,function(cr,pr,Wr){return[cr.split("").reverse().join(""),pr,Wr]})),Ut={text:k,x:ge,y:Je,options:dt,mutex:{pdfEscape:vr,activeFontKey:rn,fonts:xn,activeFontSize:Ve}},_n.publish("postProcessText",Ut),k=Ut.text,no=Ut.mutex.isHex||!1;var nl=xn[rn].encoding;nl!=="WinAnsiEncoding"&&nl!=="StandardEncoding"||(k=ml(k,function(cr,pr,Wr){return[Da(cr),pr,Wr]})),cn=Ns(k),k=[];for(var Os,Mr,Bo,Jo=0,No=1,Do=Array.isArray(cn[0])?No:Jo,Ro="",Ii=function(cr,pr,Wr){var _r="";return Wr instanceof Sn?(Wr=typeof dt.angle=="number"?Un(Wr,new Sn(1,0,0,1,cr,pr)):Un(new Sn(1,0,0,1,cr,pr),Wr),pe===V.ADVANCED&&(Wr=Un(new Sn(1,0,0,-1,0,0),Wr)),_r=Wr.join(" ")+` Tm
`):_r=We(cr)+" "+We(pr)+` Td
`,_r},yo=0;yo<cn.length;yo++){switch(Ro="",Do){case No:Bo=(no?"<":"(")+cn[yo][0]+(no?">":")"),Os=parseFloat(cn[yo][1]),Mr=parseFloat(cn[yo][2]);break;case Jo:Bo=(no?"<":"(")+cn[yo]+(no?">":")"),Os=Qn(ge),Mr=Gr(Je)}Zo!==void 0&&Zo[yo]!==void 0&&(Ro=Zo[yo]+` Tw
`),yo===0?k.push(Ro+Ii(Os,Mr,er)+Bo):Do===Jo?k.push(Ro+Bo):Do===No&&k.push(Ro+Ii(Os,Mr,er)+Bo)}k=Do===Jo?k.join(` Tj
T* `):k.join(` Tj
`),k+=` Tj
`;var cs=`BT
/`;return cs+=rn+" "+Ve+` Tf
`,cs+=We(Ve*Mi)+` TL
`,cs+=Ao+`
`,cs+=Qr,cs+=k,ue(cs+="ET"),E[rn]=!0,lr};var po=b.__private__.clip=b.clip=function(k){return ue(k==="evenodd"?"W*":"W"),this};b.clipEvenOdd=function(){return po("evenodd")},b.__private__.discardPath=b.discardPath=function(){return ue("n"),this};var Zi=b.__private__.isValidStyle=function(k){var ge=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(k)!==-1&&(ge=!0),ge};b.__private__.setDefaultPathOperation=b.setDefaultPathOperation=function(k){return Zi(k)&&(m=k),this};var Nl=b.__private__.getStyle=b.getStyle=function(k){var ge=m;switch(k){case"D":case"S":ge="S";break;case"F":ge="f";break;case"FD":case"DF":ge="B";break;case"f":case"f*":case"B":case"B*":ge=k}return ge},Aa=b.close=function(){return ue("h"),this};b.stroke=function(){return ue("S"),this},b.fill=function(k){return ka("f",k),this},b.fillEvenOdd=function(k){return ka("f*",k),this},b.fillStroke=function(k){return ka("B",k),this},b.fillStrokeEvenOdd=function(k){return ka("B*",k),this};var ka=function(k,ge){Fr(ge)==="object"?Dl(ge,k):ue(k)},go=function(k){k===null||pe===V.ADVANCED&&k===void 0||(k=Nl(k),ue(k))};function ha(k,ge,Je,dt,kt){var Ut=new Fh(ge||this.boundingBox,Je||this.xStep,dt||this.yStep,this.gState,kt||this.matrix);Ut.stream=this.stream;var cn=k+"$$"+this.cloneIndex+++"$$";return jn(cn,Ut),Ut}var Dl=function(k,ge){var Je=_e[k.key],dt=de[Je];if(dt instanceof Qc)ue("q"),ue(Ka(ge)),dt.gState&&b.setGState(dt.gState),ue(k.matrix.toString()+" cm"),ue("/"+Je+" sh"),ue("Q");else if(dt instanceof Fh){var kt=new Sn(1,0,0,-1,0,Ho());k.matrix&&(kt=kt.multiply(k.matrix||ui),Je=ha.call(dt,k.key,k.boundingBox,k.xStep,k.yStep,kt).id),ue("q"),ue("/Pattern cs"),ue("/"+Je+" scn"),dt.gState&&b.setGState(dt.gState),ue(ge),ue("Q")}},Ka=function(k){switch(k){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},mi=b.moveTo=function(k,ge){return ue(We(I(k))+" "+We($(ge))+" m"),this},Bi=b.lineTo=function(k,ge){return ue(We(I(k))+" "+We($(ge))+" l"),this},fa=b.curveTo=function(k,ge,Je,dt,kt,Ut){return ue([We(I(k)),We($(ge)),We(I(Je)),We($(dt)),We(I(kt)),We($(Ut)),"c"].join(" ")),this};b.__private__.line=b.line=function(k,ge,Je,dt,kt){if(isNaN(k)||isNaN(ge)||isNaN(Je)||isNaN(dt)||!Zi(kt))throw new Error("Invalid arguments passed to jsPDF.line");return pe===V.COMPAT?this.lines([[Je-k,dt-ge]],k,ge,[1,1],kt||"S"):this.lines([[Je-k,dt-ge]],k,ge,[1,1]).stroke()},b.__private__.lines=b.lines=function(k,ge,Je,dt,kt,Ut){var cn,Bn,Rn,Yn,ci,ki,Sr,er,lr,Hr,Qr,no;if(typeof k=="number"&&(no=Je,Je=ge,ge=k,k=no),dt=dt||[1,1],Ut=Ut||!1,isNaN(ge)||isNaN(Je)||!Array.isArray(k)||!Array.isArray(dt)||!Zi(kt)||typeof Ut!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(mi(ge,Je),cn=dt[0],Bn=dt[1],Yn=k.length,Hr=ge,Qr=Je,Rn=0;Rn<Yn;Rn++)(ci=k[Rn]).length===2?(Hr=ci[0]*cn+Hr,Qr=ci[1]*Bn+Qr,Bi(Hr,Qr)):(ki=ci[0]*cn+Hr,Sr=ci[1]*Bn+Qr,er=ci[2]*cn+Hr,lr=ci[3]*Bn+Qr,Hr=ci[4]*cn+Hr,Qr=ci[5]*Bn+Qr,fa(ki,Sr,er,lr,Hr,Qr));return Ut&&Aa(),go(kt),this},b.path=function(k){for(var ge=0;ge<k.length;ge++){var Je=k[ge],dt=Je.c;switch(Je.op){case"m":mi(dt[0],dt[1]);break;case"l":Bi(dt[0],dt[1]);break;case"c":fa.apply(this,dt);break;case"h":Aa()}}return this},b.__private__.rect=b.rect=function(k,ge,Je,dt,kt){if(isNaN(k)||isNaN(ge)||isNaN(Je)||isNaN(dt)||!Zi(kt))throw new Error("Invalid arguments passed to jsPDF.rect");return pe===V.COMPAT&&(dt=-dt),ue([We(I(k)),We($(ge)),We(I(Je)),We(I(dt)),"re"].join(" ")),go(kt),this},b.__private__.triangle=b.triangle=function(k,ge,Je,dt,kt,Ut,cn){if(isNaN(k)||isNaN(ge)||isNaN(Je)||isNaN(dt)||isNaN(kt)||isNaN(Ut)||!Zi(cn))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Je-k,dt-ge],[kt-Je,Ut-dt],[k-kt,ge-Ut]],k,ge,[1,1],cn,!0),this},b.__private__.roundedRect=b.roundedRect=function(k,ge,Je,dt,kt,Ut,cn){if(isNaN(k)||isNaN(ge)||isNaN(Je)||isNaN(dt)||isNaN(kt)||isNaN(Ut)||!Zi(cn))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Bn=4/3*(Math.SQRT2-1);return kt=Math.min(kt,.5*Je),Ut=Math.min(Ut,.5*dt),this.lines([[Je-2*kt,0],[kt*Bn,0,kt,Ut-Ut*Bn,kt,Ut],[0,dt-2*Ut],[0,Ut*Bn,-kt*Bn,Ut,-kt,Ut],[2*kt-Je,0],[-kt*Bn,0,-kt,-Ut*Bn,-kt,-Ut],[0,2*Ut-dt],[0,-Ut*Bn,kt*Bn,-Ut,kt,-Ut]],k+kt,ge,[1,1],cn,!0),this},b.__private__.ellipse=b.ellipse=function(k,ge,Je,dt,kt){if(isNaN(k)||isNaN(ge)||isNaN(Je)||isNaN(dt)||!Zi(kt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ut=4/3*(Math.SQRT2-1)*Je,cn=4/3*(Math.SQRT2-1)*dt;return mi(k+Je,ge),fa(k+Je,ge-cn,k+Ut,ge-dt,k,ge-dt),fa(k-Ut,ge-dt,k-Je,ge-cn,k-Je,ge),fa(k-Je,ge+cn,k-Ut,ge+dt,k,ge+dt),fa(k+Ut,ge+dt,k+Je,ge+cn,k+Je,ge),go(kt),this},b.__private__.circle=b.circle=function(k,ge,Je,dt){if(isNaN(k)||isNaN(ge)||isNaN(Je)||!Zi(dt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(k,ge,Je,Je,dt)},b.setFont=function(k,ge,Je){return Je&&(ge=nt(ge,Je)),rn=Ts(k,ge,{disableWarning:!1}),this};var au=b.__private__.getFont=b.getFont=function(){return xn[Ts.apply(b,arguments)]};b.__private__.getFontList=b.getFontList=function(){var k,ge,Je={};for(k in wn)if(wn.hasOwnProperty(k))for(ge in Je[k]=[],wn[k])wn[k].hasOwnProperty(ge)&&Je[k].push(ge);return Je},b.addFont=function(k,ge,Je,dt,kt){var Ut=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ut.indexOf(arguments[3])!==-1?kt=arguments[3]:arguments[3]&&Ut.indexOf(arguments[3])==-1&&(Je=nt(Je,dt)),kt=kt||"Identity-H",ao.call(this,k,ge,Je,kt)};var Ja,dl=e.lineWidth||.200025,Ma=b.__private__.getLineWidth=b.getLineWidth=function(){return dl},Ya=b.__private__.setLineWidth=b.setLineWidth=function(k){return dl=k,ue(We(I(k))+" w"),this};b.__private__.setLineDash=wi.API.setLineDash=wi.API.setLineDashPattern=function(k,ge){if(k=k||[],ge=ge||0,isNaN(ge)||!Array.isArray(k))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return k=k.map(function(Je){return We(I(Je))}).join(" "),ge=We(I(ge)),ue("["+k+"] "+ge+" d"),this};var pl=b.__private__.getLineHeight=b.getLineHeight=function(){return Ve*Ja};b.__private__.getLineHeight=b.getLineHeight=function(){return Ve*Ja};var Oi=b.__private__.setLineHeightFactor=b.setLineHeightFactor=function(k){return typeof(k=k||1.15)=="number"&&(Ja=k),this},qr=b.__private__.getLineHeightFactor=b.getLineHeightFactor=function(){return Ja};Oi(e.lineHeight);var Qn=b.__private__.getHorizontalCoordinate=function(k){return I(k)},Gr=b.__private__.getVerticalCoordinate=function(k){return pe===V.ADVANCED?k:bt[ke].mediaBox.topRightY-bt[ke].mediaBox.bottomLeftY-I(k)},Ta=b.__private__.getHorizontalCoordinateString=b.getHorizontalCoordinateString=function(k){return We(Qn(k))},Vo=b.__private__.getVerticalCoordinateString=b.getVerticalCoordinateString=function(k){return We(Gr(k))},Ar=e.strokeColor||"0 G";b.__private__.getStrokeColor=b.getDrawColor=function(){return fr(Ar)},b.__private__.setStrokeColor=b.setDrawColor=function(k,ge,Je,dt){return Ar=Hn({ch1:k,ch2:ge,ch3:Je,ch4:dt,pdfColorType:"draw",precision:2}),ue(Ar),this};var gl=e.fillColor||"0 g";b.__private__.getFillColor=b.getFillColor=function(){return fr(gl)},b.__private__.setFillColor=b.setFillColor=function(k,ge,Je,dt){return gl=Hn({ch1:k,ch2:ge,ch3:Je,ch4:dt,pdfColorType:"fill",precision:2}),ue(gl),this};var Ao=e.textColor||"0 g",Xa=b.__private__.getTextColor=b.getTextColor=function(){return fr(Ao)};b.__private__.setTextColor=b.setTextColor=function(k,ge,Je,dt){return Ao=Hn({ch1:k,ch2:ge,ch3:Je,ch4:dt,pdfColorType:"text",precision:3}),this};var Qa=e.charSpace,uo=b.__private__.getCharSpace=b.getCharSpace=function(){return parseFloat(Qa||0)};b.__private__.setCharSpace=b.setCharSpace=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Qa=k,this};var el=0;b.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},b.__private__.setLineCap=b.setLineCap=function(k){var ge=b.CapJoinStyles[k];if(ge===void 0)throw new Error("Line cap style of '"+k+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return el=ge,ue(ge+" J"),this};var or=0;b.__private__.setLineJoin=b.setLineJoin=function(k){var ge=b.CapJoinStyles[k];if(ge===void 0)throw new Error("Line join style of '"+k+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return or=ge,ue(ge+" j"),this},b.__private__.setLineMiterLimit=b.__private__.setMiterLimit=b.setLineMiterLimit=b.setMiterLimit=function(k){if(k=k||0,isNaN(k))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ue(We(I(k))+" M"),this},b.GState=yp,b.setGState=function(k){(k=typeof k=="string"?$e[Gt[k]]:lu(null,k)).equals(Dn)||(ue("/"+k.id+" gs"),Dn=k)};var lu=function(k,ge){if(!k||!Gt[k]){var Je=!1;for(var dt in $e)if($e.hasOwnProperty(dt)&&$e[dt].equals(ge)){Je=!0;break}if(Je)ge=$e[dt];else{var kt="GS"+(Object.keys($e).length+1).toString(10);$e[kt]=ge,ge.id=kt}return k&&(Gt[k]=ge.id),_n.publish("addGState",ge),ge}};b.addGState=function(k,ge){return lu(k,ge),this},b.saveGraphicsState=function(){return ue("q"),ot.push({key:rn,size:Ve,color:Ao}),this},b.restoreGraphicsState=function(){ue("Q");var k=ot.pop();return rn=k.key,Ve=k.size,Ao=k.color,Dn=null,this},b.setCurrentTransformationMatrix=function(k){return ue(k.toString()+" cm"),this},b.comment=function(k){return ue("#"+k),this};var ls=function(k,ge){var Je=k||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Je},set:function(Ut){isNaN(Ut)||(Je=parseFloat(Ut))}});var dt=ge||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return dt},set:function(Ut){isNaN(Ut)||(dt=parseFloat(Ut))}});var kt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return kt},set:function(Ut){kt=Ut.toString()}}),this},mo=function(k,ge,Je,dt){ls.call(this,k,ge),this.type="rect";var kt=Je||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return kt},set:function(cn){isNaN(cn)||(kt=parseFloat(cn))}});var Ut=dt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ut},set:function(cn){isNaN(cn)||(Ut=parseFloat(cn))}}),this},tl=function(){this.page=Ln,this.currentPage=ke,this.pages=Se.slice(0),this.pagesContext=bt.slice(0),this.x=Ke,this.y=qt,this.matrix=mn,this.width=ar(ke),this.height=Ho(ke),this.outputDestination=ae,this.id="",this.objectNumber=-1};tl.prototype.restore=function(){Ln=this.page,ke=this.currentPage,bt=this.pagesContext,Se=this.pages,Ke=this.x,qt=this.y,mn=this.matrix,to(ke,this.width),Vr(ke,this.height),ae=this.outputDestination};var vo=function(k,ge,Je,dt,kt){Li.push(new tl),Ln=ke=0,Se=[],Ke=k,qt=ge,mn=kt,Lr([Je,dt])},Ba=function(k){if(ri[k])Li.pop().restore();else{var ge=new tl,Je="Xo"+(Object.keys(ni).length+1).toString(10);ge.id=Je,ri[k]=Je,ni[Je]=ge,_n.publish("addFormObject",ge),Li.pop().restore()}};for(var Na in b.beginFormObject=function(k,ge,Je,dt,kt){return vo(k,ge,Je,dt,kt),this},b.endFormObject=function(k){return Ba(k),this},b.doFormObject=function(k,ge){var Je=ni[ri[k]];return ue("q"),ue(ge.toString()+" cm"),ue("/"+Je.id+" Do"),ue("Q"),this},b.getFormObject=function(k){var ge=ni[ri[k]];return{x:ge.x,y:ge.y,width:ge.width,height:ge.height,matrix:ge.matrix}},b.save=function(k,ge){return k=k||"generated.pdf",(ge=ge||{}).returnPromise=ge.returnPromise||!1,ge.returnPromise===!1?(Jc(Go(fo()),k),typeof Jc.unload=="function"&&xi.setTimeout&&setTimeout(Jc.unload,911),this):new Promise(function(Je,dt){try{var kt=Jc(Go(fo()),k);typeof Jc.unload=="function"&&xi.setTimeout&&setTimeout(Jc.unload,911),Je(kt)}catch(Ut){dt(Ut.message)}})},wi.API)wi.API.hasOwnProperty(Na)&&(Na==="events"&&wi.API.events.length?function(k,ge){var Je,dt,kt;for(kt=ge.length-1;kt!==-1;kt--)Je=ge[kt][0],dt=ge[kt][1],k.subscribe.apply(k,[Je].concat(typeof dt=="function"?[dt]:dt))}(_n,wi.API.events):b[Na]=wi.API[Na]);var ar=b.getPageWidth=function(k){return(bt[k=k||ke].mediaBox.topRightX-bt[k].mediaBox.bottomLeftX)/it},to=b.setPageWidth=function(k,ge){bt[k].mediaBox.topRightX=ge*it+bt[k].mediaBox.bottomLeftX},Ho=b.getPageHeight=function(k){return(bt[k=k||ke].mediaBox.topRightY-bt[k].mediaBox.bottomLeftY)/it},Vr=b.setPageHeight=function(k,ge){bt[k].mediaBox.topRightY=ge*it+bt[k].mediaBox.bottomLeftY};return b.internal={pdfEscape:vr,getStyle:Nl,getFont:au,getFontSize:st,getCharSpace:uo,getTextColor:Xa,getLineHeight:pl,getLineHeightFactor:qr,getLineWidth:Ma,write:Oe,getHorizontalCoordinate:Qn,getVerticalCoordinate:Gr,getCoordinateString:Ta,getVerticalCoordinateString:Vo,collections:{},newObject:Wt,newAdditionalObject:qi,newObjectDeferred:yn,newObjectDeferredBegin:Ci,getFilters:ai,putStream:rr,events:_n,scaleFactor:it,pageSize:{getWidth:function(){return ar(ke)},setWidth:function(k){to(ke,k)},getHeight:function(){return Ho(ke)},setHeight:function(k){Vr(ke,k)}},encryptionOptions:_,encryption:rs,getEncryptor:ou,output:ca,getNumberOfPages:Cr,pages:Se,out:ue,f2:le,f3:G,getPageInfo:fl,getPageInfoByObjId:pi,getCurrentPageInfo:yi,getPDFVersion:j,Point:ls,Rectangle:mo,Matrix:Sn,hasHotfix:Za},Object.defineProperty(b.internal.pageSize,"width",{get:function(){return ar(ke)},set:function(k){to(ke,k)},enumerable:!0,configurable:!0}),Object.defineProperty(b.internal.pageSize,"height",{get:function(){return Ho(ke)},set:function(k){Vr(ke,k)},enumerable:!0,configurable:!0}),dn.call(b,Me),rn="F1",Ea(r,t),_n.publish("initialized"),b}Oh.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},Oh.prototype.toHexString=function(e){return e.split("").map(function(n){return("0"+(255&n.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Oh.prototype.hexToBytes=function(e){for(var n=[],t=0;t<e.length;t+=2)n.push(String.fromCharCode(parseInt(e.substr(t,2),16)));return n.join("")},Oh.prototype.processOwnerPassword=function(e,n){return Vg(Gg(n).substr(0,5),e)},Oh.prototype.encryptor=function(e,n){var t=Gg(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&n,n>>8&255)).substr(0,10);return function(i){return Vg(t,i)}},yp.prototype.equals=function(e){var n,t="id,objectNumber,equals";if(!e||Fr(e)!==Fr(this))return!1;var i=0;for(n in this)if(!(t.indexOf(n)>=0)){if(this.hasOwnProperty(n)&&!e.hasOwnProperty(n)||this[n]!==e[n])return!1;i++}for(n in e)e.hasOwnProperty(n)&&t.indexOf(n)<0&&i--;return i===0},wi.API={events:[]},wi.version="2.5.2";var zs=wi.API,Pm=1,fh=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Th=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Ni=function(e){return e.toFixed(2)},dc=function(e){return e.toFixed(5)};zs.__acroform__={};var Wa=function(e,n){e.prototype=Object.create(n.prototype),e.prototype.constructor=e},Ry=function(e){return e*Pm},yu=function(e){var n=new F4,t=Gn.internal.getHeight(e)||0,i=Gn.internal.getWidth(e)||0;return n.BBox=[0,0,Number(Ni(i)),Number(Ni(t))],n},rN=zs.__acroform__.setBit=function(e,n){if(e=e||0,n=n||0,isNaN(e)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<n},sN=zs.__acroform__.clearBit=function(e,n){if(e=e||0,n=n||0,isNaN(e)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<n)},oN=zs.__acroform__.getBit=function(e,n){if(isNaN(e)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<n?1:0},Js=zs.__acroform__.getBitForPdf=function(e,n){if(isNaN(e)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return oN(e,n-1)},Ys=zs.__acroform__.setBitForPdf=function(e,n){if(isNaN(e)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return rN(e,n-1)},Xs=zs.__acroform__.clearBitForPdf=function(e,n){if(isNaN(e)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return sN(e,n-1)},aN=zs.__acroform__.calculateCoordinates=function(e,n){var t=n.internal.getHorizontalCoordinate,i=n.internal.getVerticalCoordinate,r=e[0],o=e[1],l=e[2],h=e[3],p={};return p.lowerLeft_X=t(r)||0,p.lowerLeft_Y=i(o+h)||0,p.upperRight_X=t(r+l)||0,p.upperRight_Y=i(o)||0,[Number(Ni(p.lowerLeft_X)),Number(Ni(p.lowerLeft_Y)),Number(Ni(p.upperRight_X)),Number(Ni(p.upperRight_Y))]},lN=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var n=[],t=e._V||e.DV,i=Hg(e,t),r=e.scope.internal.getFont(e.fontName,e.fontStyle).id;n.push("/Tx BMC"),n.push("q"),n.push("BT"),n.push(e.scope.__private__.encodeColorString(e.color)),n.push("/"+r+" "+Ni(i.fontSize)+" Tf"),n.push("1 0 0 1 0 0 Tm"),n.push(i.text),n.push("ET"),n.push("Q"),n.push("EMC");var o=yu(e);return o.scope=e.scope,o.stream=n.join(`
`),o}},Hg=function(e,n){var t=e.fontSize===0?e.maxFontSize:e.fontSize,i={text:"",fontSize:""},r=(n=(n=n.substr(0,1)=="("?n.substr(1):n).substr(n.length-1)==")"?n.substr(0,n.length-1):n).split(" ");r=e.multiline?r.map(function(G){return G.split(`
`)}):r.map(function(G){return[G]});var o=t,l=Gn.internal.getHeight(e)||0;l=l<0?-l:l;var h=Gn.internal.getWidth(e)||0;h=h<0?-h:h;var p=function(G,I,Y){if(G+1<r.length){var $=I+" "+r[G+1][0];return Md($,e,Y).width<=h-4}return!1};o++;e:for(;o>0;){n="",o--;var m,_,w=Md("3",e,o).height,E=e.multiline?l-o:(l-w)/2,b=E+=2,D=0,j=0,Q=0;if(o<=0){n=`(...) Tj
`,n+="% Width of Text: "+Md(n,e,o=12).width+", FieldWidth:"+h+`
`;break}for(var F="",V=0,pe=0;pe<r.length;pe++)if(r.hasOwnProperty(pe)){var Ee=!1;if(r[pe].length!==1&&Q!==r[pe].length-1){if((w+2)*(V+2)+2>l)continue e;F+=r[pe][Q],Ee=!0,j=pe,pe--}else{F=(F+=r[pe][Q]+" ").substr(F.length-1)==" "?F.substr(0,F.length-1):F;var Ie=parseInt(pe),nt=p(Ie,F,o),We=pe>=r.length-1;if(nt&&!We){F+=" ",Q=0;continue}if(nt||We){if(We)j=Ie;else if(e.multiline&&(w+2)*(V+2)+2>l)continue e}else{if(!e.multiline||(w+2)*(V+2)+2>l)continue e;j=Ie}}for(var O="",H=D;H<=j;H++){var le=r[H];if(e.multiline){if(H===j){O+=le[Q]+" ",Q=(Q+1)%le.length;continue}if(H===D){O+=le[le.length-1]+" ";continue}}O+=le[0]+" "}switch(O=O.substr(O.length-1)==" "?O.substr(0,O.length-1):O,_=Md(O,e,o).width,e.textAlign){case"right":m=h-_-2;break;case"center":m=(h-_)/2;break;case"left":default:m=2}n+=Ni(m)+" "+Ni(b)+` Td
`,n+="("+fh(O)+`) Tj
`,n+=-Ni(m)+` 0 Td
`,b=-(o+2),_=0,D=Ee?j:j+1,V++,F=""}break}return i.text=n,i.fontSize=o,i},Md=function(e,n,t){var i=n.scope.internal.getFont(n.fontName,n.fontStyle),r=n.scope.getStringUnitWidth(e,{font:i,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:n.scope.getStringUnitWidth("3",{font:i,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:r}},uN={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},cN=function(e,n){var t={type:"reference",object:e};n.internal.getPageInfo(e.page).pageContext.annotations.find(function(i){return i.type===t.type&&i.object===t.object})===void 0&&n.internal.getPageInfo(e.page).pageContext.annotations.push(t)},hN=function(e,n){for(var t in e)if(e.hasOwnProperty(t)){var i=t,r=e[t];n.internal.newObjectDeferredBegin(r.objId,!0),Fr(r)==="object"&&typeof r.putStream=="function"&&r.putStream(),delete e[i]}},fN=function(e,n){if(n.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(ru.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(uN)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Pm=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new z4,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var i=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var r in i)if(i.hasOwnProperty(r)){var o=i[r];o.objId=void 0,o.hasAnnotation&&cN(o,t)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(t){(function(i,r){var o=!i;for(var l in i||(r.internal.newObjectDeferredBegin(r.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),r.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),i=i||r.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(i.hasOwnProperty(l)){var h=i[l],p=[],m=h.Rect;if(h.Rect&&(h.Rect=aN(h.Rect,r)),r.internal.newObjectDeferredBegin(h.objId,!0),h.DA=Gn.createDefaultAppearanceStream(h),Fr(h)==="object"&&typeof h.getKeyValueListForStream=="function"&&(p=h.getKeyValueListForStream()),h.Rect=m,h.hasAppearanceStream&&!h.appearanceStreamContent){var _=lN(h);p.push({key:"AP",value:"<</N "+_+">>"}),r.internal.acroformPlugin.xForms.push(_)}if(h.appearanceStreamContent){var w="";for(var E in h.appearanceStreamContent)if(h.appearanceStreamContent.hasOwnProperty(E)){var b=h.appearanceStreamContent[E];if(w+="/"+E+" ",w+="<<",Object.keys(b).length>=1||Array.isArray(b)){for(var l in b)if(b.hasOwnProperty(l)){var D=b[l];typeof D=="function"&&(D=D.call(r,h)),w+="/"+l+" "+D+" ",r.internal.acroformPlugin.xForms.indexOf(D)>=0||r.internal.acroformPlugin.xForms.push(D)}}else typeof(D=b)=="function"&&(D=D.call(r,h)),w+="/"+l+" "+D,r.internal.acroformPlugin.xForms.indexOf(D)>=0||r.internal.acroformPlugin.xForms.push(D);w+=">>"}p.push({key:"AP",value:`<<
`+w+">>"})}r.internal.putStream({additionalKeyValues:p,objectId:h.objId}),r.internal.out("endobj")}o&&hN(r.internal.acroformPlugin.xForms,r)})(t,e)}),e.internal.acroformPlugin.isInitialized=!0}},I4=zs.__acroform__.arrayToPdfArray=function(e,n,t){var i=function(l){return l};if(Array.isArray(e)){for(var r="[",o=0;o<e.length;o++)switch(o!==0&&(r+=" "),Fr(e[o])){case"boolean":case"number":case"object":r+=e[o].toString();break;case"string":e[o].substr(0,1)!=="/"?(n!==void 0&&t&&(i=t.internal.getEncryptor(n)),r+="("+fh(i(e[o].toString()))+")"):r+=e[o].toString()}return r+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},X0=function(e,n,t){var i=function(r){return r};return n!==void 0&&t&&(i=t.internal.getEncryptor(n)),(e=e||"").toString(),e="("+fh(i(e))+")"},Su=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Su.prototype.toString=function(){return this.objId+" 0 R"},Su.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Su.prototype.getKeyValueListForStream=function(){var e=[],n=Object.getOwnPropertyNames(this).filter(function(o){return o!="content"&&o!="appearanceStreamContent"&&o!="scope"&&o!="objId"&&o.substring(0,1)!="_"});for(var t in n)if(Object.getOwnPropertyDescriptor(this,n[t]).configurable===!1){var i=n[t],r=this[i];r&&(Array.isArray(r)?e.push({key:i,value:I4(r,this.objId,this.scope)}):r instanceof Su?(r.scope=this.scope,e.push({key:i,value:r.objId+" 0 R"})):typeof r!="function"&&e.push({key:i,value:r}))}return e};var F4=function(){Su.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,n=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){e=t.trim()},get:function(){return e||null}})};Wa(F4,Su);var z4=function(){Su.call(this);var e,n=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return n.length>0?n:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return n}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var t=function(i){return i};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+fh(t(e))+")"}},set:function(t){e=t}})};Wa(z4,Su);var ru=function e(){Su.call(this);var n=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return n},set:function(F){if(isNaN(F))throw new Error('Invalid value "'+F+'" for attribute F supplied.');n=F}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Js(n,3)},set:function(F){F?this.F=Ys(n,3):this.F=Xs(n,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(F){if(isNaN(F))throw new Error('Invalid value "'+F+'" for attribute Ff supplied.');t=F}});var i=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(i.length!==0)return i},set:function(F){i=F!==void 0?F:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[0])?0:i[0]},set:function(F){i[0]=F}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[1])?0:i[1]},set:function(F){i[1]=F}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[2])?0:i[2]},set:function(F){i[2]=F}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[3])?0:i[3]},set:function(F){i[3]=F}});var r="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return r},set:function(F){switch(F){case"/Btn":case"/Tx":case"/Ch":case"/Sig":r=F;break;default:throw new Error('Invalid value "'+F+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof _p)return;o="FieldObject"+e.FieldNum++}var F=function(V){return V};return this.scope&&(F=this.scope.internal.getEncryptor(this.objId)),"("+fh(F(o))+")"},set:function(F){o=F.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(F){o=F}});var l="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return l},set:function(F){l=F}});var h="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return h},set:function(F){h=F}});var p=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return p},set:function(F){p=F}});var m=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return m===void 0?50/Pm:m},set:function(F){m=F}});var _="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return _},set:function(F){_=F}});var w="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!w||this instanceof _p||this instanceof oh))return X0(w,this.objId,this.scope)},set:function(F){F=F.toString(),w=F}});var E=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(E)return this instanceof Lo?E:X0(E,this.objId,this.scope)},set:function(F){F=F.toString(),E=this instanceof Lo?F:F.substr(0,1)==="("?Th(F.substr(1,F.length-2)):Th(F)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Lo?Th(E.substr(1,E.length-1)):E},set:function(F){F=F.toString(),E=this instanceof Lo?"/"+F:F}});var b=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(b)return b},set:function(F){this.V=F}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(b)return this instanceof Lo?b:X0(b,this.objId,this.scope)},set:function(F){F=F.toString(),b=this instanceof Lo?F:F.substr(0,1)==="("?Th(F.substr(1,F.length-2)):Th(F)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Lo?Th(b.substr(1,b.length-1)):b},set:function(F){F=F.toString(),b=this instanceof Lo?"/"+F:F}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var D,j=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return j},set:function(F){F=!!F,j=F}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(D)return D},set:function(F){D=F}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Js(this.Ff,1)},set:function(F){F?this.Ff=Ys(this.Ff,1):this.Ff=Xs(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Js(this.Ff,2)},set:function(F){F?this.Ff=Ys(this.Ff,2):this.Ff=Xs(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Js(this.Ff,3)},set:function(F){F?this.Ff=Ys(this.Ff,3):this.Ff=Xs(this.Ff,3)}});var Q=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(Q!==null)return Q},set:function(F){if([0,1,2].indexOf(F)===-1)throw new Error('Invalid value "'+F+'" for attribute Q supplied.');Q=F}}),Object.defineProperty(this,"textAlign",{get:function(){var F;switch(Q){case 0:default:F="left";break;case 1:F="center";break;case 2:F="right"}return F},configurable:!0,enumerable:!0,set:function(F){switch(F){case"right":case 2:Q=2;break;case"center":case 1:Q=1;break;case"left":case 0:default:Q=0}}})};Wa(ru,Su);var $h=function(){ru.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){e=t}});var n=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return I4(n,this.objId,this.scope)},set:function(t){var i,r;r=[],typeof(i=t)=="string"&&(r=function(o,l,h){h||(h=1);for(var p,m=[];p=l.exec(o);)m.push(p[h]);return m}(i,/\((.*?)\)/g)),n=r}}),this.getOptions=function(){return n},this.setOptions=function(t){n=t,this.sort&&n.sort()},this.addOption=function(t){t=(t=t||"").toString(),n.push(t),this.sort&&n.sort()},this.removeOption=function(t,i){for(i=i||!1,t=(t=t||"").toString();n.indexOf(t)!==-1&&(n.splice(n.indexOf(t),1),i!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Js(this.Ff,18)},set:function(t){t?this.Ff=Ys(this.Ff,18):this.Ff=Xs(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Js(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=Ys(this.Ff,19):this.Ff=Xs(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Js(this.Ff,20)},set:function(t){t?(this.Ff=Ys(this.Ff,20),n.sort()):this.Ff=Xs(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Js(this.Ff,22)},set:function(t){t?this.Ff=Ys(this.Ff,22):this.Ff=Xs(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Js(this.Ff,23)},set:function(t){t?this.Ff=Ys(this.Ff,23):this.Ff=Xs(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Js(this.Ff,27)},set:function(t){t?this.Ff=Ys(this.Ff,27):this.Ff=Xs(this.Ff,27)}}),this.hasAppearanceStream=!1};Wa($h,ru);var qh=function(){$h.call(this),this.fontName="helvetica",this.combo=!1};Wa(qh,$h);var Gh=function(){qh.call(this),this.combo=!0};Wa(Gh,qh);var Hd=function(){Gh.call(this),this.edit=!0};Wa(Hd,Gh);var Lo=function(){ru.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Js(this.Ff,15)},set:function(t){t?this.Ff=Ys(this.Ff,15):this.Ff=Xs(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Js(this.Ff,16)},set:function(t){t?this.Ff=Ys(this.Ff,16):this.Ff=Xs(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Js(this.Ff,17)},set:function(t){t?this.Ff=Ys(this.Ff,17):this.Ff=Xs(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Js(this.Ff,26)},set:function(t){t?this.Ff=Ys(this.Ff,26):this.Ff=Xs(this.Ff,26)}});var e,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(o){return o};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(n).length!==0){var i,r=[];for(i in r.push("<<"),n)r.push("/"+i+" ("+fh(t(n[i]))+")");return r.push(">>"),r.join(`
`)}},set:function(t){Fr(t)==="object"&&(n=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(t){typeof t=="string"&&(n.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(t){e="/"+t}})};Wa(Lo,ru);var Wd=function(){Lo.call(this),this.pushButton=!0};Wa(Wd,Lo);var Vh=function(){Lo.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(n){e=n!==void 0?n:[]}})};Wa(Vh,Lo);var _p=function(){var e,n;ru.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return n},set:function(r){n=r}});var t,i={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(h){return h};this.scope&&(r=this.scope.internal.getEncryptor(this.objId));var o,l=[];for(o in l.push("<<"),i)l.push("/"+o+" ("+fh(r(i[o]))+")");return l.push(">>"),l.join(`
`)},set:function(r){Fr(r)==="object"&&(i=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return i.CA||""},set:function(r){typeof r=="string"&&(i.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Gn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Wa(_p,ru),Vh.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var n in this.Kids)if(this.Kids.hasOwnProperty(n)){var t=this.Kids[n];t.appearanceStreamContent=e.createAppearanceStream(t.optionName),t.caption=e.getCA()}},Vh.prototype.createOption=function(e){var n=new _p;return n.Parent=this,n.optionName=e,this.Kids.push(n),dN.call(this.scope,n),n};var Zd=function(){Lo.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Gn.CheckBox.createAppearanceStream()};Wa(Zd,Lo);var oh=function(){ru.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Js(this.Ff,13)},set:function(n){n?this.Ff=Ys(this.Ff,13):this.Ff=Xs(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Js(this.Ff,21)},set:function(n){n?this.Ff=Ys(this.Ff,21):this.Ff=Xs(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Js(this.Ff,23)},set:function(n){n?this.Ff=Ys(this.Ff,23):this.Ff=Xs(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Js(this.Ff,24)},set:function(n){n?this.Ff=Ys(this.Ff,24):this.Ff=Xs(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Js(this.Ff,25)},set:function(n){n?this.Ff=Ys(this.Ff,25):this.Ff=Xs(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Js(this.Ff,26)},set:function(n){n?this.Ff=Ys(this.Ff,26):this.Ff=Xs(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(n){Number.isInteger(n)&&(e=n)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Wa(oh,ru);var Kd=function(){oh.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Js(this.Ff,14)},set:function(e){e?this.Ff=Ys(this.Ff,14):this.Ff=Xs(this.Ff,14)}}),this.password=!0};Wa(Kd,oh);var Gn={CheckBox:{createAppearanceStream:function(){return{N:{On:Gn.CheckBox.YesNormal},D:{On:Gn.CheckBox.YesPushDown,Off:Gn.CheckBox.OffPushDown}}},YesPushDown:function(e){var n=yu(e);n.scope=e.scope;var t=[],i=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color),o=Hg(e,e.caption);return t.push("0.749023 g"),t.push("0 0 "+Ni(Gn.internal.getWidth(e))+" "+Ni(Gn.internal.getHeight(e))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+i+" "+Ni(o.fontSize)+" Tf "+r),t.push("BT"),t.push(o.text),t.push("ET"),t.push("Q"),t.push("EMC"),n.stream=t.join(`
`),n},YesNormal:function(e){var n=yu(e);n.scope=e.scope;var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),r=[],o=Gn.internal.getHeight(e),l=Gn.internal.getWidth(e),h=Hg(e,e.caption);return r.push("1 g"),r.push("0 0 "+Ni(l)+" "+Ni(o)+" re"),r.push("f"),r.push("q"),r.push("0 0 1 rg"),r.push("0 0 "+Ni(l-1)+" "+Ni(o-1)+" re"),r.push("W"),r.push("n"),r.push("0 g"),r.push("BT"),r.push("/"+t+" "+Ni(h.fontSize)+" Tf "+i),r.push(h.text),r.push("ET"),r.push("Q"),n.stream=r.join(`
`),n},OffPushDown:function(e){var n=yu(e);n.scope=e.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Ni(Gn.internal.getWidth(e))+" "+Ni(Gn.internal.getHeight(e))+" re"),t.push("f"),n.stream=t.join(`
`),n}},RadioButton:{Circle:{createAppearanceStream:function(e){var n={D:{Off:Gn.RadioButton.Circle.OffPushDown},N:{}};return n.N[e]=Gn.RadioButton.Circle.YesNormal,n.D[e]=Gn.RadioButton.Circle.YesPushDown,n},getCA:function(){return"l"},YesNormal:function(e){var n=yu(e);n.scope=e.scope;var t=[],i=Gn.internal.getWidth(e)<=Gn.internal.getHeight(e)?Gn.internal.getWidth(e)/4:Gn.internal.getHeight(e)/4;i=Number((.9*i).toFixed(5));var r=Gn.internal.Bezier_C,o=Number((i*r).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+dc(Gn.internal.getWidth(e)/2)+" "+dc(Gn.internal.getHeight(e)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),t.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),t.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),t.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),t.push("f"),t.push("Q"),n.stream=t.join(`
`),n},YesPushDown:function(e){var n=yu(e);n.scope=e.scope;var t=[],i=Gn.internal.getWidth(e)<=Gn.internal.getHeight(e)?Gn.internal.getWidth(e)/4:Gn.internal.getHeight(e)/4;i=Number((.9*i).toFixed(5));var r=Number((2*i).toFixed(5)),o=Number((r*Gn.internal.Bezier_C).toFixed(5)),l=Number((i*Gn.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+dc(Gn.internal.getWidth(e)/2)+" "+dc(Gn.internal.getHeight(e)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),t.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),t.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),t.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+dc(Gn.internal.getWidth(e)/2)+" "+dc(Gn.internal.getHeight(e)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+l+" "+l+" "+i+" 0 "+i+" c"),t.push("-"+l+" "+i+" -"+i+" "+l+" -"+i+" 0 c"),t.push("-"+i+" -"+l+" -"+l+" -"+i+" 0 -"+i+" c"),t.push(l+" -"+i+" "+i+" -"+l+" "+i+" 0 c"),t.push("f"),t.push("Q"),n.stream=t.join(`
`),n},OffPushDown:function(e){var n=yu(e);n.scope=e.scope;var t=[],i=Gn.internal.getWidth(e)<=Gn.internal.getHeight(e)?Gn.internal.getWidth(e)/4:Gn.internal.getHeight(e)/4;i=Number((.9*i).toFixed(5));var r=Number((2*i).toFixed(5)),o=Number((r*Gn.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+dc(Gn.internal.getWidth(e)/2)+" "+dc(Gn.internal.getHeight(e)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),t.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),t.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),t.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),t.push("f"),t.push("Q"),n.stream=t.join(`
`),n}},Cross:{createAppearanceStream:function(e){var n={D:{Off:Gn.RadioButton.Cross.OffPushDown},N:{}};return n.N[e]=Gn.RadioButton.Cross.YesNormal,n.D[e]=Gn.RadioButton.Cross.YesPushDown,n},getCA:function(){return"8"},YesNormal:function(e){var n=yu(e);n.scope=e.scope;var t=[],i=Gn.internal.calculateCross(e);return t.push("q"),t.push("1 1 "+Ni(Gn.internal.getWidth(e)-2)+" "+Ni(Gn.internal.getHeight(e)-2)+" re"),t.push("W"),t.push("n"),t.push(Ni(i.x1.x)+" "+Ni(i.x1.y)+" m"),t.push(Ni(i.x2.x)+" "+Ni(i.x2.y)+" l"),t.push(Ni(i.x4.x)+" "+Ni(i.x4.y)+" m"),t.push(Ni(i.x3.x)+" "+Ni(i.x3.y)+" l"),t.push("s"),t.push("Q"),n.stream=t.join(`
`),n},YesPushDown:function(e){var n=yu(e);n.scope=e.scope;var t=Gn.internal.calculateCross(e),i=[];return i.push("0.749023 g"),i.push("0 0 "+Ni(Gn.internal.getWidth(e))+" "+Ni(Gn.internal.getHeight(e))+" re"),i.push("f"),i.push("q"),i.push("1 1 "+Ni(Gn.internal.getWidth(e)-2)+" "+Ni(Gn.internal.getHeight(e)-2)+" re"),i.push("W"),i.push("n"),i.push(Ni(t.x1.x)+" "+Ni(t.x1.y)+" m"),i.push(Ni(t.x2.x)+" "+Ni(t.x2.y)+" l"),i.push(Ni(t.x4.x)+" "+Ni(t.x4.y)+" m"),i.push(Ni(t.x3.x)+" "+Ni(t.x3.y)+" l"),i.push("s"),i.push("Q"),n.stream=i.join(`
`),n},OffPushDown:function(e){var n=yu(e);n.scope=e.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Ni(Gn.internal.getWidth(e))+" "+Ni(Gn.internal.getHeight(e))+" re"),t.push("f"),n.stream=t.join(`
`),n}}},createDefaultAppearanceStream:function(e){var n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,t=e.scope.__private__.encodeColorString(e.color);return"/"+n+" "+e.fontSize+" Tf "+t}};Gn.internal={Bezier_C:.551915024494,calculateCross:function(e){var n=Gn.internal.getWidth(e),t=Gn.internal.getHeight(e),i=Math.min(n,t);return{x1:{x:(n-i)/2,y:(t-i)/2+i},x2:{x:(n-i)/2+i,y:(t-i)/2},x3:{x:(n-i)/2,y:(t-i)/2},x4:{x:(n-i)/2+i,y:(t-i)/2+i}}}},Gn.internal.getWidth=function(e){var n=0;return Fr(e)==="object"&&(n=Ry(e.Rect[2])),n},Gn.internal.getHeight=function(e){var n=0;return Fr(e)==="object"&&(n=Ry(e.Rect[3])),n};var dN=zs.addField=function(e){if(fN(this,e),!(e instanceof ru))throw new Error("Invalid argument passed to jsPDF.addField.");var n;return(n=e).scope.internal.acroformPlugin.printedOut&&(n.scope.internal.acroformPlugin.printedOut=!1,n.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),n.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(n),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};zs.AcroFormChoiceField=$h,zs.AcroFormListBox=qh,zs.AcroFormComboBox=Gh,zs.AcroFormEditBox=Hd,zs.AcroFormButton=Lo,zs.AcroFormPushButton=Wd,zs.AcroFormRadioButton=Vh,zs.AcroFormCheckBox=Zd,zs.AcroFormTextField=oh,zs.AcroFormPasswordField=Kd,zs.AcroFormAppearance=Gn,zs.AcroForm={ChoiceField:$h,ListBox:qh,ComboBox:Gh,EditBox:Hd,Button:Lo,PushButton:Wd,RadioButton:Vh,CheckBox:Zd,TextField:oh,PasswordField:Kd,Appearance:Gn},wi.AcroForm={ChoiceField:$h,ListBox:qh,ComboBox:Gh,EditBox:Hd,Button:Lo,PushButton:Wd,RadioButton:Vh,CheckBox:Zd,TextField:oh,PasswordField:Kd,Appearance:Gn};wi.AcroForm;function j4(e){return e.reduce(function(n,t,i){return n[t]=i,n},{})}(function(e){e.__addimage__={};var n="UNKNOWN",t={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=e.__addimage__.getImageFileTypeByImageData=function(G,I){var Y,$,R,Z,se,ie=n;if((I=I||n)==="RGBA"||G.data!==void 0&&G.data instanceof Uint8ClampedArray&&"height"in G&&"width"in G)return"RGBA";if(nt(G))for(se in t)for(R=t[se],Y=0;Y<R.length;Y+=1){for(Z=!0,$=0;$<R[Y].length;$+=1)if(R[Y][$]!==void 0&&R[Y][$]!==G[$]){Z=!1;break}if(Z===!0){ie=se;break}}else for(se in t)for(R=t[se],Y=0;Y<R.length;Y+=1){for(Z=!0,$=0;$<R[Y].length;$+=1)if(R[Y][$]!==void 0&&R[Y][$]!==G.charCodeAt($)){Z=!1;break}if(Z===!0){ie=se;break}}return ie===n&&I!==n&&(ie=I),ie},r=function G(I){for(var Y=this.internal.write,$=this.internal.putStream,R=(0,this.internal.getFilters)();R.indexOf("FlateEncode")!==-1;)R.splice(R.indexOf("FlateEncode"),1);I.objectId=this.internal.newObject();var Z=[];if(Z.push({key:"Type",value:"/XObject"}),Z.push({key:"Subtype",value:"/Image"}),Z.push({key:"Width",value:I.width}),Z.push({key:"Height",value:I.height}),I.colorSpace===Q.INDEXED?Z.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(I.palette.length/3-1)+" "+("sMask"in I&&I.sMask!==void 0?I.objectId+2:I.objectId+1)+" 0 R]"}):(Z.push({key:"ColorSpace",value:"/"+I.colorSpace}),I.colorSpace===Q.DEVICE_CMYK&&Z.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Z.push({key:"BitsPerComponent",value:I.bitsPerComponent}),"decodeParameters"in I&&I.decodeParameters!==void 0&&Z.push({key:"DecodeParms",value:"<<"+I.decodeParameters+">>"}),"transparency"in I&&Array.isArray(I.transparency)){for(var se="",ie=0,Ae=I.transparency.length;ie<Ae;ie++)se+=I.transparency[ie]+" "+I.transparency[ie]+" ";Z.push({key:"Mask",value:"["+se+"]"})}I.sMask!==void 0&&Z.push({key:"SMask",value:I.objectId+1+" 0 R"});var Te=I.filter!==void 0?["/"+I.filter]:void 0;if($({data:I.data,additionalKeyValues:Z,alreadyAppliedFilters:Te,objectId:I.objectId}),Y("endobj"),"sMask"in I&&I.sMask!==void 0){var ut="/Predictor "+I.predictor+" /Colors 1 /BitsPerComponent "+I.bitsPerComponent+" /Columns "+I.width,X={width:I.width,height:I.height,colorSpace:"DeviceGray",bitsPerComponent:I.bitsPerComponent,decodeParameters:ut,data:I.sMask};"filter"in I&&(X.filter=I.filter),G.call(this,X)}if(I.colorSpace===Q.INDEXED){var ke=this.internal.newObject();$({data:O(new Uint8Array(I.palette)),objectId:ke}),Y("endobj")}},o=function(){var G=this.internal.collections.addImage_images;for(var I in G)r.call(this,G[I])},l=function(){var G,I=this.internal.collections.addImage_images,Y=this.internal.write;for(var $ in I)Y("/I"+(G=I[$]).index,G.objectId,"0","R")},h=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},p=function(){var G=this.internal.collections.addImage_images;return h.call(this),G},m=function(){return Object.keys(this.internal.collections.addImage_images).length},_=function(G){return typeof e["process"+G.toUpperCase()]=="function"},w=function(G){return Fr(G)==="object"&&G.nodeType===1},E=function(G,I){if(G.nodeName==="IMG"&&G.hasAttribute("src")){var Y=""+G.getAttribute("src");if(Y.indexOf("data:image/")===0)return Of(unescape(Y).split("base64,").pop());var $=e.loadFile(Y,!0);if($!==void 0)return $}if(G.nodeName==="CANVAS"){if(G.width===0||G.height===0)throw new Error("Given canvas must have data. Canvas width: "+G.width+", height: "+G.height);var R;switch(I){case"PNG":R="image/png";break;case"WEBP":R="image/webp";break;case"JPEG":case"JPG":default:R="image/jpeg"}return Of(G.toDataURL(R,1).split("base64,").pop())}},b=function(G){var I=this.internal.collections.addImage_images;if(I){for(var Y in I)if(G===I[Y].alias)return I[Y]}},D=function(G,I,Y){return G||I||(G=-96,I=-96),G<0&&(G=-1*Y.width*72/G/this.internal.scaleFactor),I<0&&(I=-1*Y.height*72/I/this.internal.scaleFactor),G===0&&(G=I*Y.width/Y.height),I===0&&(I=G*Y.height/Y.width),[G,I]},j=function(G,I,Y,$,R,Z){var se=D.call(this,Y,$,R),ie=this.internal.getCoordinateString,Ae=this.internal.getVerticalCoordinateString,Te=p.call(this);if(Y=se[0],$=se[1],Te[R.index]=R,Z){Z*=Math.PI/180;var ut=Math.cos(Z),X=Math.sin(Z),ke=function(W){return W.toFixed(4)},B=[ke(ut),ke(X),ke(-1*X),ke(ut),0,0,"cm"]}this.internal.write("q"),Z?(this.internal.write([1,"0","0",1,ie(G),Ae(I+$),"cm"].join(" ")),this.internal.write(B.join(" ")),this.internal.write([ie(Y),"0","0",ie($),"0","0","cm"].join(" "))):this.internal.write([ie(Y),"0","0",ie($),ie(G),Ae(I+$),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+R.index+" Do"),this.internal.write("Q")},Q=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var F=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},V=e.__addimage__.sHashCode=function(G){var I,Y,$=0;if(typeof G=="string")for(Y=G.length,I=0;I<Y;I++)$=($<<5)-$+G.charCodeAt(I),$|=0;else if(nt(G))for(Y=G.byteLength/2,I=0;I<Y;I++)$=($<<5)-$+G[I],$|=0;return $},pe=e.__addimage__.validateStringAsBase64=function(G){(G=G||"").toString().trim();var I=!0;return G.length===0&&(I=!1),G.length%4!=0&&(I=!1),/^[A-Za-z0-9+/]+$/.test(G.substr(0,G.length-2))===!1&&(I=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(G.substr(-2))===!1&&(I=!1),I},Ee=e.__addimage__.extractImageFromDataUrl=function(G){var I=(G=G||"").split("base64,"),Y=null;if(I.length===2){var $=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(I[0]);Array.isArray($)&&(Y={mimeType:$[1],charset:$[2],data:I[1]})}return Y},Ie=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(G){return Ie()&&G instanceof ArrayBuffer};var nt=e.__addimage__.isArrayBufferView=function(G){return Ie()&&typeof Uint32Array<"u"&&(G instanceof Int8Array||G instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&G instanceof Uint8ClampedArray||G instanceof Int16Array||G instanceof Uint16Array||G instanceof Int32Array||G instanceof Uint32Array||G instanceof Float32Array||G instanceof Float64Array)},We=e.__addimage__.binaryStringToUint8Array=function(G){for(var I=G.length,Y=new Uint8Array(I),$=0;$<I;$++)Y[$]=G.charCodeAt($);return Y},O=e.__addimage__.arrayBufferToBinaryString=function(G){for(var I="",Y=nt(G)?G:new Uint8Array(G),$=0;$<Y.length;$+=8192)I+=String.fromCharCode.apply(null,Y.subarray($,$+8192));return I};e.addImage=function(){var G,I,Y,$,R,Z,se,ie,Ae;if(typeof arguments[1]=="number"?(I=n,Y=arguments[1],$=arguments[2],R=arguments[3],Z=arguments[4],se=arguments[5],ie=arguments[6],Ae=arguments[7]):(I=arguments[1],Y=arguments[2],$=arguments[3],R=arguments[4],Z=arguments[5],se=arguments[6],ie=arguments[7],Ae=arguments[8]),Fr(G=arguments[0])==="object"&&!w(G)&&"imageData"in G){var Te=G;G=Te.imageData,I=Te.format||I||n,Y=Te.x||Y||0,$=Te.y||$||0,R=Te.w||Te.width||R,Z=Te.h||Te.height||Z,se=Te.alias||se,ie=Te.compression||ie,Ae=Te.rotation||Te.angle||Ae}var ut=this.internal.getFilters();if(ie===void 0&&ut.indexOf("FlateEncode")!==-1&&(ie="SLOW"),isNaN(Y)||isNaN($))throw new Error("Invalid coordinates passed to jsPDF.addImage");h.call(this);var X=H.call(this,G,I,se,ie);return j.call(this,Y,$,R,Z,X,Ae),this};var H=function(G,I,Y,$){var R,Z,se;if(typeof G=="string"&&i(G)===n){G=unescape(G);var ie=le(G,!1);(ie!==""||(ie=e.loadFile(G,!0))!==void 0)&&(G=ie)}if(w(G)&&(G=E(G,I)),I=i(G,I),!_(I))throw new Error("addImage does not support files of type '"+I+"', please ensure that a plugin for '"+I+"' support is added.");if(((se=Y)==null||se.length===0)&&(Y=function(Ae){return typeof Ae=="string"||nt(Ae)?V(Ae):nt(Ae.data)?V(Ae.data):null}(G)),(R=b.call(this,Y))||(Ie()&&(G instanceof Uint8Array||I==="RGBA"||(Z=G,G=We(G))),R=this["process"+I.toUpperCase()](G,m.call(this),Y,function(Ae){return Ae&&typeof Ae=="string"&&(Ae=Ae.toUpperCase()),Ae in e.image_compression?Ae:F.NONE}($),Z)),!R)throw new Error("An unknown error occurred whilst processing the image.");return R},le=e.__addimage__.convertBase64ToBinaryString=function(G,I){var Y;I=typeof I!="boolean"||I;var $,R="";if(typeof G=="string"){$=(Y=Ee(G))!==null?Y.data:G;try{R=Of($)}catch(Z){if(I)throw pe($)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Z.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return R};e.getImageProperties=function(G){var I,Y,$="";if(w(G)&&(G=E(G)),typeof G=="string"&&i(G)===n&&(($=le(G,!1))===""&&($=e.loadFile(G)||""),G=$),Y=i(G),!_(Y))throw new Error("addImage does not support files of type '"+Y+"', please ensure that a plugin for '"+Y+"' support is added.");if(!Ie()||G instanceof Uint8Array||(G=We(G)),!(I=this["process"+Y.toUpperCase()](G)))throw new Error("An unknown error occurred whilst processing the image");return I.fileType=Y,I}})(wi.API),function(e){var n=function(t){if(t!==void 0&&t!="")return!0};wi.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(t){for(var i,r,o,l=this.internal.getCoordinateString,h=this.internal.getVerticalCoordinateString,p=this.internal.getPageInfoByObjId(t.objId),m=t.pageContext.annotations,_=!1,w=0;w<m.length&&!_;w++)switch((i=m[w]).type){case"link":(n(i.options.url)||n(i.options.pageNumber))&&(_=!0);break;case"reference":case"text":case"freetext":_=!0}if(_!=0){this.internal.write("/Annots [");for(var E=0;E<m.length;E++){i=m[E];var b=this.internal.pdfEscape,D=this.internal.getEncryptor(t.objId);switch(i.type){case"reference":this.internal.write(" "+i.object.objId+" 0 R ");break;case"text":var j=this.internal.newAdditionalObject(),Q=this.internal.newAdditionalObject(),F=this.internal.getEncryptor(j.objId),V=i.title||"Note";o="<</Type /Annot /Subtype /Text "+(r="/Rect ["+l(i.bounds.x)+" "+h(i.bounds.y+i.bounds.h)+" "+l(i.bounds.x+i.bounds.w)+" "+h(i.bounds.y)+"] ")+"/Contents ("+b(F(i.contents))+")",o+=" /Popup "+Q.objId+" 0 R",o+=" /P "+p.objId+" 0 R",o+=" /T ("+b(F(V))+") >>",j.content=o;var pe=j.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(r="/Rect ["+l(i.bounds.x+30)+" "+h(i.bounds.y+i.bounds.h)+" "+l(i.bounds.x+i.bounds.w+30)+" "+h(i.bounds.y)+"] ")+" /Parent "+pe,i.open&&(o+=" /Open true"),o+=" >>",Q.content=o,this.internal.write(j.objId,"0 R",Q.objId,"0 R");break;case"freetext":r="/Rect ["+l(i.bounds.x)+" "+h(i.bounds.y)+" "+l(i.bounds.x+i.bounds.w)+" "+h(i.bounds.y+i.bounds.h)+"] ";var Ee=i.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+r+"/Contents ("+b(D(i.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+Ee+")",o+=" /Border [0 0 0]",o+=" >>",this.internal.write(o);break;case"link":if(i.options.name){var Ie=this.annotations._nameMap[i.options.name];i.options.pageNumber=Ie.page,i.options.top=Ie.y}else i.options.top||(i.options.top=0);if(r="/Rect ["+i.finalBounds.x+" "+i.finalBounds.y+" "+i.finalBounds.w+" "+i.finalBounds.h+"] ",o="",i.options.url)o="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /A <</S /URI /URI ("+b(D(i.options.url))+") >>";else if(i.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(i.options.pageNumber).objId+" 0 R",i.options.magFactor=i.options.magFactor||"XYZ",i.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+i.options.top+"]";break;case"FitV":i.options.left=i.options.left||0,o+=" /FitV "+i.options.left+"]";break;case"XYZ":default:var nt=h(i.options.top);i.options.left=i.options.left||0,i.options.zoom===void 0&&(i.options.zoom=0),o+=" /XYZ "+i.options.left+" "+nt+" "+i.options.zoom+"]"}o!=""&&(o+=" >>",this.internal.write(o))}}this.internal.write("]")}}]),e.createAnnotation=function(t){var i=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":i.pageContext.annotations.push(t)}},e.link=function(t,i,r,o,l){var h=this.internal.getCurrentPageInfo(),p=this.internal.getCoordinateString,m=this.internal.getVerticalCoordinateString;h.pageContext.annotations.push({finalBounds:{x:p(t),y:m(i),w:p(t+r),h:m(i+o)},options:l,type:"link"})},e.textWithLink=function(t,i,r,o){var l,h,p=this.getTextWidth(t),m=this.internal.getLineHeight()/this.internal.scaleFactor;if(o.maxWidth!==void 0){h=o.maxWidth;var _=this.splitTextToSize(t,h).length;l=Math.ceil(m*_)}else h=p,l=m;return this.text(t,i,r,o),r+=.2*m,o.align==="center"&&(i-=p/2),o.align==="right"&&(i-=p),this.link(i,r-m,h,l,o),p},e.getTextWidth=function(t){var i=this.internal.getFontSize();return this.getStringUnitWidth(t)*i/this.internal.scaleFactor}}(wi.API),function(e){var n={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},i={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},r=[1570,1571,1573,1575];e.__arabicParser__={};var o=e.__arabicParser__.isInArabicSubstitutionA=function(j){return n[j.charCodeAt(0)]!==void 0},l=e.__arabicParser__.isArabicLetter=function(j){return typeof j=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(j)},h=e.__arabicParser__.isArabicEndLetter=function(j){return l(j)&&o(j)&&n[j.charCodeAt(0)].length<=2},p=e.__arabicParser__.isArabicAlfLetter=function(j){return l(j)&&r.indexOf(j.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(j){return l(j)&&o(j)&&n[j.charCodeAt(0)].length>=1};var m=e.__arabicParser__.arabicLetterHasFinalForm=function(j){return l(j)&&o(j)&&n[j.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(j){return l(j)&&o(j)&&n[j.charCodeAt(0)].length>=3};var _=e.__arabicParser__.arabicLetterHasMedialForm=function(j){return l(j)&&o(j)&&n[j.charCodeAt(0)].length==4},w=e.__arabicParser__.resolveLigatures=function(j){var Q=0,F=t,V="",pe=0;for(Q=0;Q<j.length;Q+=1)F[j.charCodeAt(Q)]!==void 0?(pe++,typeof(F=F[j.charCodeAt(Q)])=="number"&&(V+=String.fromCharCode(F),F=t,pe=0),Q===j.length-1&&(F=t,V+=j.charAt(Q-(pe-1)),Q-=pe-1,pe=0)):(F=t,V+=j.charAt(Q-pe),Q-=pe,pe=0);return V};e.__arabicParser__.isArabicDiacritic=function(j){return j!==void 0&&i[j.charCodeAt(0)]!==void 0};var E=e.__arabicParser__.getCorrectForm=function(j,Q,F){return l(j)?o(j)===!1?-1:!m(j)||!l(Q)&&!l(F)||!l(F)&&h(Q)||h(j)&&!l(Q)||h(j)&&p(Q)||h(j)&&h(Q)?0:_(j)&&l(Q)&&!h(Q)&&l(F)&&m(F)?3:h(j)||!l(F)?1:2:-1},b=function(j){var Q=0,F=0,V=0,pe="",Ee="",Ie="",nt=(j=j||"").split("\\s+"),We=[];for(Q=0;Q<nt.length;Q+=1){for(We.push(""),F=0;F<nt[Q].length;F+=1)pe=nt[Q][F],Ee=nt[Q][F-1],Ie=nt[Q][F+1],l(pe)?(V=E(pe,Ee,Ie),We[Q]+=V!==-1?String.fromCharCode(n[pe.charCodeAt(0)][V]):pe):We[Q]+=pe;We[Q]=w(We[Q])}return We.join(" ")},D=e.__arabicParser__.processArabic=e.processArabic=function(){var j,Q=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,F=[];if(Array.isArray(Q)){var V=0;for(F=[],V=0;V<Q.length;V+=1)Array.isArray(Q[V])?F.push([b(Q[V][0]),Q[V][1],Q[V][2]]):F.push([b(Q[V])]);j=F}else j=b(Q);return typeof arguments[0]=="string"?j:(arguments[0].text=j,arguments[0])};e.events.push(["preProcessText",D])}(wi.API),wi.API.autoPrint=function(e){var n;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){n=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+n+" 0 R")})}return this},function(e){var n=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(h){t=h}});var i=150;Object.defineProperty(this,"width",{get:function(){return i},set:function(h){i=isNaN(h)||Number.isInteger(h)===!1||h<0?150:h,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=i+1)}});var r=300;Object.defineProperty(this,"height",{get:function(){return r},set:function(h){r=isNaN(h)||Number.isInteger(h)===!1||h<0?300:h,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=r+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(h){o=h}});var l={};Object.defineProperty(this,"style",{get:function(){return l},set:function(h){l=h}}),Object.defineProperty(this,"parentNode",{})};n.prototype.getContext=function(t,i){var r;if((t=t||"2d")!=="2d")return null;for(r in i)this.pdf.context2d.hasOwnProperty(r)&&(this.pdf.context2d[r]=i[r]);return this.pdf.context2d._canvas=this,this.pdf.context2d},n.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new n,this.canvas.pdf=this}])}(wi.API),function(e){var n={left:0,top:0,bottom:0,right:0},t=!1,i=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},n),this.internal.__cell__.margins.width=this.getPageWidth(),r.call(this))},r=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var p=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return p},set:function(j){p=j}});var m=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return m},set:function(j){m=j}});var _=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return _},set:function(j){_=j}});var w=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return w},set:function(j){w=j}});var E=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return E},set:function(j){E=j}});var b=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return b},set:function(j){b=j}});var D=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return D},set:function(j){D=j}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(p){return i.call(this),this.internal.__cell__.headerFunction=typeof p=="function"?p:void 0,this},e.getTextDimensions=function(p,m){i.call(this);var _=(m=m||{}).fontSize||this.getFontSize(),w=m.font||this.getFont(),E=m.scaleFactor||this.internal.scaleFactor,b=0,D=0,j=0,Q=this;if(!Array.isArray(p)&&typeof p!="string"){if(typeof p!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");p=String(p)}var F=m.maxWidth;F>0?typeof p=="string"?p=this.splitTextToSize(p,F):Object.prototype.toString.call(p)==="[object Array]"&&(p=p.reduce(function(pe,Ee){return pe.concat(Q.splitTextToSize(Ee,F))},[])):p=Array.isArray(p)?p:[p];for(var V=0;V<p.length;V++)b<(j=this.getStringUnitWidth(p[V],{font:w})*_)&&(b=j);return b!==0&&(D=p.length),{w:b/=E,h:Math.max((D*_*this.getLineHeightFactor()-_*(this.getLineHeightFactor()-1))/E,0)}},e.cellAddPage=function(){i.call(this),this.addPage();var p=this.internal.__cell__.margins||n;return this.internal.__cell__.lastCell=new o(p.left,p.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var l=e.cell=function(){var p;p=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),i.call(this);var m=this.internal.__cell__.lastCell,_=this.internal.__cell__.padding,w=this.internal.__cell__.margins||n,E=this.internal.__cell__.tableHeaderRow,b=this.internal.__cell__.printHeaders;return m.lineNumber!==void 0&&(m.lineNumber===p.lineNumber?(p.x=(m.x||0)+(m.width||0),p.y=m.y||0):m.y+m.height+p.height+w.bottom>this.getPageHeight()?(this.cellAddPage(),p.y=w.top,b&&E&&(this.printHeaderRow(p.lineNumber,!0),p.y+=E[0].height)):p.y=m.y+m.height||p.y),p.text[0]!==void 0&&(this.rect(p.x,p.y,p.width,p.height,t===!0?"FD":void 0),p.align==="right"?this.text(p.text,p.x+p.width-_,p.y+_,{align:"right",baseline:"top"}):p.align==="center"?this.text(p.text,p.x+p.width/2,p.y+_,{align:"center",baseline:"top",maxWidth:p.width-_-_}):this.text(p.text,p.x+_,p.y+_,{align:"left",baseline:"top",maxWidth:p.width-_-_})),this.internal.__cell__.lastCell=p,this};e.table=function(p,m,_,w,E){if(i.call(this),!_)throw new Error("No data for PDF table.");var b,D,j,Q,F=[],V=[],pe=[],Ee={},Ie={},nt=[],We=[],O=(E=E||{}).autoSize||!1,H=E.printHeaders!==!1,le=E.css&&E.css["font-size"]!==void 0?16*E.css["font-size"]:E.fontSize||12,G=E.margins||Object.assign({width:this.getPageWidth()},n),I=typeof E.padding=="number"?E.padding:3,Y=E.headerBackgroundColor||"#c8c8c8",$=E.headerTextColor||"#000";if(r.call(this),this.internal.__cell__.printHeaders=H,this.internal.__cell__.margins=G,this.internal.__cell__.table_font_size=le,this.internal.__cell__.padding=I,this.internal.__cell__.headerBackgroundColor=Y,this.internal.__cell__.headerTextColor=$,this.setFontSize(le),w==null)V=F=Object.keys(_[0]),pe=F.map(function(){return"left"});else if(Array.isArray(w)&&Fr(w[0])==="object")for(F=w.map(function(Te){return Te.name}),V=w.map(function(Te){return Te.prompt||Te.name||""}),pe=w.map(function(Te){return Te.align||"left"}),b=0;b<w.length;b+=1)Ie[w[b].name]=w[b].width*(19.049976/25.4);else Array.isArray(w)&&typeof w[0]=="string"&&(V=F=w,pe=F.map(function(){return"left"}));if(O||Array.isArray(w)&&typeof w[0]=="string")for(b=0;b<F.length;b+=1){for(Ee[Q=F[b]]=_.map(function(Te){return Te[Q]}),this.setFont(void 0,"bold"),nt.push(this.getTextDimensions(V[b],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),D=Ee[Q],this.setFont(void 0,"normal"),j=0;j<D.length;j+=1)nt.push(this.getTextDimensions(D[j],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);Ie[Q]=Math.max.apply(null,nt)+I+I,nt=[]}if(H){var R={};for(b=0;b<F.length;b+=1)R[F[b]]={},R[F[b]].text=V[b],R[F[b]].align=pe[b];var Z=h.call(this,R,Ie);We=F.map(function(Te){return new o(p,m,Ie[Te],Z,R[Te].text,void 0,R[Te].align)}),this.setTableHeaderRow(We),this.printHeaderRow(1,!1)}var se=w.reduce(function(Te,ut){return Te[ut.name]=ut.align,Te},{});for(b=0;b<_.length;b+=1){"rowStart"in E&&E.rowStart instanceof Function&&E.rowStart({row:b,data:_[b]},this);var ie=h.call(this,_[b],Ie);for(j=0;j<F.length;j+=1){var Ae=_[b][F[j]];"cellStart"in E&&E.cellStart instanceof Function&&E.cellStart({row:b,col:j,data:Ae},this),l.call(this,new o(p,m,Ie[F[j]],ie,Ae,b+2,se[F[j]]))}}return this.internal.__cell__.table_x=p,this.internal.__cell__.table_y=m,this};var h=function(p,m){var _=this.internal.__cell__.padding,w=this.internal.__cell__.table_font_size,E=this.internal.scaleFactor;return Object.keys(p).map(function(b){var D=p[b];return this.splitTextToSize(D.hasOwnProperty("text")?D.text:D,m[b]-_-_)},this).map(function(b){return this.getLineHeightFactor()*b.length*w/E+_+_},this).reduce(function(b,D){return Math.max(b,D)},0)};e.setTableHeaderRow=function(p){i.call(this),this.internal.__cell__.tableHeaderRow=p},e.printHeaderRow=function(p,m){if(i.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var _;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var w=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(w[0],w[1],w[2],w[3],void 0,-1)}this.setFont(void 0,"bold");for(var E=[],b=0;b<this.internal.__cell__.tableHeaderRow.length;b+=1){_=this.internal.__cell__.tableHeaderRow[b].clone(),m&&(_.y=this.internal.__cell__.margins.top||0,E.push(_)),_.lineNumber=p;var D=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),l.call(this,_),this.setTextColor(D)}E.length>0&&this.setTableHeaderRow(E),this.setFont(void 0,"normal"),t=!1}}(wi.API);var U4={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},$4=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Wg=j4($4),q4=[100,200,300,400,500,600,700,800,900],pN=j4(q4);function Zg(e){var n=e.family.replace(/"|'/g,"").toLowerCase(),t=function(o){return U4[o=o||"normal"]?o:"normal"}(e.style),i=function(o){if(!o)return 400;if(typeof o=="number")return o>=100&&o<=900&&o%100==0?o:400;if(/^\d00$/.test(o))return parseInt(o);switch(o){case"bold":return 700;case"normal":default:return 400}}(e.weight),r=function(o){return typeof Wg[o=o||"normal"]=="number"?o:"normal"}(e.stretch);return{family:n,style:t,weight:i,stretch:r,src:e.src||[],ref:e.ref||{name:n,style:[r,t,i].join(" ")}}}function Oy(e,n,t,i){var r;for(r=t;r>=0&&r<n.length;r+=i)if(e[n[r]])return e[n[r]];for(r=t;r>=0&&r<n.length;r-=i)if(e[n[r]])return e[n[r]]}var gN={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Iy={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Fy(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function mN(e,n,t){for(var i=(t=t||{}).defaultFontFamily||"times",r=Object.assign({},gN,t.genericFontFamilies||{}),o=null,l=null,h=0;h<n.length;++h)if(r[(o=Zg(n[h])).family]&&(o.family=r[o.family]),e.hasOwnProperty(o.family)){l=e[o.family];break}if(!(l=l||e[i]))throw new Error("Could not find a font-family for the rule '"+Fy(o)+"' and default family '"+i+"'.");if(l=function(p,m){if(m[p])return m[p];var _=Wg[p],w=_<=Wg.normal?-1:1,E=Oy(m,$4,_,w);if(!E)throw new Error("Could not find a matching font-stretch value for "+p);return E}(o.stretch,l),l=function(p,m){if(m[p])return m[p];for(var _=U4[p],w=0;w<_.length;++w)if(m[_[w]])return m[_[w]];throw new Error("Could not find a matching font-style for "+p)}(o.style,l),!(l=function(p,m){if(m[p])return m[p];if(p===400&&m[500])return m[500];if(p===500&&m[400])return m[400];var _=pN[p],w=Oy(m,q4,_,p<400?-1:1);if(!w)throw new Error("Could not find a matching font-weight for value "+p);return w}(o.weight,l)))throw new Error("Failed to resolve a font for the rule '"+Fy(o)+"'.");return l}function zy(e){return e.trimLeft()}function vN(e,n){for(var t=0;t<e.length;){if(e.charAt(t)===n)return[e.substring(0,t),e.substring(t+1)];t+=1}return null}function yN(e){var n=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return n===null?null:[n[0],e.substring(n[0].length)]}var Td,jy,Uy,Q0=["times"];(function(e){var n,t,i,r,o,l,h,p,m,_=function(X){return X=X||{},this.isStrokeTransparent=X.isStrokeTransparent||!1,this.strokeOpacity=X.strokeOpacity||1,this.strokeStyle=X.strokeStyle||"#000000",this.fillStyle=X.fillStyle||"#000000",this.isFillTransparent=X.isFillTransparent||!1,this.fillOpacity=X.fillOpacity||1,this.font=X.font||"10px sans-serif",this.textBaseline=X.textBaseline||"alphabetic",this.textAlign=X.textAlign||"left",this.lineWidth=X.lineWidth||1,this.lineJoin=X.lineJoin||"miter",this.lineCap=X.lineCap||"butt",this.path=X.path||[],this.transform=X.transform!==void 0?X.transform.clone():new p,this.globalCompositeOperation=X.globalCompositeOperation||"normal",this.globalAlpha=X.globalAlpha||1,this.clip_path=X.clip_path||[],this.currentPoint=X.currentPoint||new l,this.miterLimit=X.miterLimit||10,this.lastPoint=X.lastPoint||new l,this.lineDashOffset=X.lineDashOffset||0,this.lineDash=X.lineDash||[],this.margin=X.margin||[0,0,0,0],this.prevPageLastElemOffset=X.prevPageLastElemOffset||0,this.ignoreClearRect=typeof X.ignoreClearRect!="boolean"||X.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new w(this),n=this.internal.f2,t=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,r=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,l=this.internal.Point,h=this.internal.Rectangle,p=this.internal.Matrix,m=new _}]);var w=function(X){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var ke=X;Object.defineProperty(this,"pdf",{get:function(){return ke}});var B=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return B},set:function(ye){B=!!ye}});var W=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return W},set:function(ye){W=!!ye}});var he=0;Object.defineProperty(this,"posX",{get:function(){return he},set:function(ye){isNaN(ye)||(he=ye)}});var ne=0;Object.defineProperty(this,"posY",{get:function(){return ne},set:function(ye){isNaN(ye)||(ne=ye)}}),Object.defineProperty(this,"margin",{get:function(){return m.margin},set:function(ye){var ue;typeof ye=="number"?ue=[ye,ye,ye,ye]:((ue=new Array(4))[0]=ye[0],ue[1]=ye.length>=2?ye[1]:ue[0],ue[2]=ye.length>=3?ye[2]:ue[0],ue[3]=ye.length>=4?ye[3]:ue[1]),m.margin=ue}});var re=!1;Object.defineProperty(this,"autoPaging",{get:function(){return re},set:function(ye){re=ye}});var ee=0;Object.defineProperty(this,"lastBreak",{get:function(){return ee},set:function(ye){ee=ye}});var oe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return oe},set:function(ye){oe=ye}}),Object.defineProperty(this,"ctx",{get:function(){return m},set:function(ye){ye instanceof _&&(m=ye)}}),Object.defineProperty(this,"path",{get:function(){return m.path},set:function(ye){m.path=ye}});var Se=[];Object.defineProperty(this,"ctxStack",{get:function(){return Se},set:function(ye){Se=ye}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ye){var ue;ue=E(ye),this.ctx.fillStyle=ue.style,this.ctx.isFillTransparent=ue.a===0,this.ctx.fillOpacity=ue.a,this.pdf.setFillColor(ue.r,ue.g,ue.b,{a:ue.a}),this.pdf.setTextColor(ue.r,ue.g,ue.b,{a:ue.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ye){var ue=E(ye);this.ctx.strokeStyle=ue.style,this.ctx.isStrokeTransparent=ue.a===0,this.ctx.strokeOpacity=ue.a,ue.a===0?this.pdf.setDrawColor(255,255,255):(ue.a,this.pdf.setDrawColor(ue.r,ue.g,ue.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ye){["butt","round","square"].indexOf(ye)!==-1&&(this.ctx.lineCap=ye,this.pdf.setLineCap(ye))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ye){isNaN(ye)||(this.ctx.lineWidth=ye,this.pdf.setLineWidth(ye))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ye){["bevel","round","miter"].indexOf(ye)!==-1&&(this.ctx.lineJoin=ye,this.pdf.setLineJoin(ye))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ye){isNaN(ye)||(this.ctx.miterLimit=ye,this.pdf.setMiterLimit(ye))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ye){this.ctx.textBaseline=ye}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ye){["right","end","center","left","start"].indexOf(ye)!==-1&&(this.ctx.textAlign=ye)}});var te=null;function ae(ye,ue){if(te===null){var Oe=function(De){var Me=[];return Object.keys(De).forEach(function(Ve){De[Ve].forEach(function(ze){var st=null;switch(ze){case"bold":st={family:Ve,weight:"bold"};break;case"italic":st={family:Ve,style:"italic"};break;case"bolditalic":st={family:Ve,weight:"bold",style:"italic"};break;case"":case"normal":st={family:Ve}}st!==null&&(st.ref={name:Ve,style:ze},Me.push(st))})}),Me}(ye.getFontList());te=function(De){for(var Me={},Ve=0;Ve<De.length;++Ve){var ze=Zg(De[Ve]),st=ze.family,Qe=ze.stretch,pt=ze.style,wt=ze.weight;Me[st]=Me[st]||{},Me[st][Qe]=Me[st][Qe]||{},Me[st][Qe][pt]=Me[st][Qe][pt]||{},Me[st][Qe][pt][wt]=ze}return Me}(Oe.concat(ue))}return te}var Le=null;Object.defineProperty(this,"fontFaces",{get:function(){return Le},set:function(ye){te=null,Le=ye}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ye){var ue;if(this.ctx.font=ye,(ue=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(ye))!==null){var Oe=ue[1],De=(ue[2],ue[3]),Me=ue[4],Ve=(ue[5],ue[6]),ze=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Me)[2];Me=Math.floor(ze==="px"?parseFloat(Me)*this.pdf.internal.scaleFactor:ze==="em"?parseFloat(Me)*this.pdf.getFontSize():parseFloat(Me)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Me);var st=function(Qt){var rn,it,Ke=[],qt=Qt.trim();if(qt==="")return Q0;if(qt in Iy)return[Iy[qt]];for(;qt!=="";){switch(it=null,rn=(qt=zy(qt)).charAt(0)){case'"':case"'":it=vN(qt.substring(1),rn);break;default:it=yN(qt)}if(it===null||(Ke.push(it[0]),(qt=zy(it[1]))!==""&&qt.charAt(0)!==","))return Q0;qt=qt.replace(/^,/,"")}return Ke}(Ve);if(this.fontFaces){var Qe=mN(ae(this.pdf,this.fontFaces),st.map(function(Qt){return{family:Qt,stretch:"normal",weight:De,style:Oe}}));this.pdf.setFont(Qe.ref.name,Qe.ref.style)}else{var pt="";(De==="bold"||parseInt(De,10)>=700||Oe==="bold")&&(pt="bold"),Oe==="italic"&&(pt+="italic"),pt.length===0&&(pt="normal");for(var wt="",Ht={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},nn=0;nn<st.length;nn++){if(this.pdf.internal.getFont(st[nn],pt,{noFallback:!0,disableWarning:!0})!==void 0){wt=st[nn];break}if(pt==="bolditalic"&&this.pdf.internal.getFont(st[nn],"bold",{noFallback:!0,disableWarning:!0})!==void 0)wt=st[nn],pt="bold";else if(this.pdf.internal.getFont(st[nn],"normal",{noFallback:!0,disableWarning:!0})!==void 0){wt=st[nn],pt="normal";break}}if(wt===""){for(var tt=0;tt<st.length;tt++)if(Ht[st[tt]]){wt=Ht[st[tt]];break}}wt=wt===""?"Times":wt,this.pdf.setFont(wt,pt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ye){this.ctx.globalCompositeOperation=ye}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ye){this.ctx.globalAlpha=ye}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ye){this.ctx.lineDashOffset=ye,ut.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ye){this.ctx.lineDash=ye,ut.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ye){this.ctx.ignoreClearRect=!!ye}})};w.prototype.setLineDash=function(X){this.lineDash=X},w.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},w.prototype.fill=function(){Ee.call(this,"fill",!1)},w.prototype.stroke=function(){Ee.call(this,"stroke",!1)},w.prototype.beginPath=function(){this.path=[{type:"begin"}]},w.prototype.moveTo=function(X,ke){if(isNaN(X)||isNaN(ke))throw Kr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var B=this.ctx.transform.applyToPoint(new l(X,ke));this.path.push({type:"mt",x:B.x,y:B.y}),this.ctx.lastPoint=new l(X,ke)},w.prototype.closePath=function(){var X=new l(0,0),ke=0;for(ke=this.path.length-1;ke!==-1;ke--)if(this.path[ke].type==="begin"&&Fr(this.path[ke+1])==="object"&&typeof this.path[ke+1].x=="number"){X=new l(this.path[ke+1].x,this.path[ke+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l(X.x,X.y)},w.prototype.lineTo=function(X,ke){if(isNaN(X)||isNaN(ke))throw Kr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var B=this.ctx.transform.applyToPoint(new l(X,ke));this.path.push({type:"lt",x:B.x,y:B.y}),this.ctx.lastPoint=new l(B.x,B.y)},w.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),Ee.call(this,null,!0)},w.prototype.quadraticCurveTo=function(X,ke,B,W){if(isNaN(B)||isNaN(W)||isNaN(X)||isNaN(ke))throw Kr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var he=this.ctx.transform.applyToPoint(new l(B,W)),ne=this.ctx.transform.applyToPoint(new l(X,ke));this.path.push({type:"qct",x1:ne.x,y1:ne.y,x:he.x,y:he.y}),this.ctx.lastPoint=new l(he.x,he.y)},w.prototype.bezierCurveTo=function(X,ke,B,W,he,ne){if(isNaN(he)||isNaN(ne)||isNaN(X)||isNaN(ke)||isNaN(B)||isNaN(W))throw Kr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var re=this.ctx.transform.applyToPoint(new l(he,ne)),ee=this.ctx.transform.applyToPoint(new l(X,ke)),oe=this.ctx.transform.applyToPoint(new l(B,W));this.path.push({type:"bct",x1:ee.x,y1:ee.y,x2:oe.x,y2:oe.y,x:re.x,y:re.y}),this.ctx.lastPoint=new l(re.x,re.y)},w.prototype.arc=function(X,ke,B,W,he,ne){if(isNaN(X)||isNaN(ke)||isNaN(B)||isNaN(W)||isNaN(he))throw Kr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ne=!!ne,!this.ctx.transform.isIdentity){var re=this.ctx.transform.applyToPoint(new l(X,ke));X=re.x,ke=re.y;var ee=this.ctx.transform.applyToPoint(new l(0,B)),oe=this.ctx.transform.applyToPoint(new l(0,0));B=Math.sqrt(Math.pow(ee.x-oe.x,2)+Math.pow(ee.y-oe.y,2))}Math.abs(he-W)>=2*Math.PI&&(W=0,he=2*Math.PI),this.path.push({type:"arc",x:X,y:ke,radius:B,startAngle:W,endAngle:he,counterclockwise:ne})},w.prototype.arcTo=function(X,ke,B,W,he){throw new Error("arcTo not implemented.")},w.prototype.rect=function(X,ke,B,W){if(isNaN(X)||isNaN(ke)||isNaN(B)||isNaN(W))throw Kr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(X,ke),this.lineTo(X+B,ke),this.lineTo(X+B,ke+W),this.lineTo(X,ke+W),this.lineTo(X,ke),this.lineTo(X+B,ke),this.lineTo(X,ke)},w.prototype.fillRect=function(X,ke,B,W){if(isNaN(X)||isNaN(ke)||isNaN(B)||isNaN(W))throw Kr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!b.call(this)){var he={};this.lineCap!=="butt"&&(he.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(he.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(X,ke,B,W),this.fill(),he.hasOwnProperty("lineCap")&&(this.lineCap=he.lineCap),he.hasOwnProperty("lineJoin")&&(this.lineJoin=he.lineJoin)}},w.prototype.strokeRect=function(X,ke,B,W){if(isNaN(X)||isNaN(ke)||isNaN(B)||isNaN(W))throw Kr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");D.call(this)||(this.beginPath(),this.rect(X,ke,B,W),this.stroke())},w.prototype.clearRect=function(X,ke,B,W){if(isNaN(X)||isNaN(ke)||isNaN(B)||isNaN(W))throw Kr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(X,ke,B,W))},w.prototype.save=function(X){X=typeof X!="boolean"||X;for(var ke=this.pdf.internal.getCurrentPageInfo().pageNumber,B=0;B<this.pdf.internal.getNumberOfPages();B++)this.pdf.setPage(B+1),this.pdf.internal.out("q");if(this.pdf.setPage(ke),X){this.ctx.fontSize=this.pdf.internal.getFontSize();var W=new _(this.ctx);this.ctxStack.push(this.ctx),this.ctx=W}},w.prototype.restore=function(X){X=typeof X!="boolean"||X;for(var ke=this.pdf.internal.getCurrentPageInfo().pageNumber,B=0;B<this.pdf.internal.getNumberOfPages();B++)this.pdf.setPage(B+1),this.pdf.internal.out("Q");this.pdf.setPage(ke),X&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},w.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var E=function(X){var ke,B,W,he;if(X.isCanvasGradient===!0&&(X=X.getColor()),!X)return{r:0,g:0,b:0,a:0,style:X};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(X))ke=0,B=0,W=0,he=0;else{var ne=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(X);if(ne!==null)ke=parseInt(ne[1]),B=parseInt(ne[2]),W=parseInt(ne[3]),he=1;else if((ne=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(X))!==null)ke=parseInt(ne[1]),B=parseInt(ne[2]),W=parseInt(ne[3]),he=parseFloat(ne[4]);else{if(he=1,typeof X=="string"&&X.charAt(0)!=="#"){var re=new D4(X);X=re.ok?re.toHex():"#000000"}X.length===4?(ke=X.substring(1,2),ke+=ke,B=X.substring(2,3),B+=B,W=X.substring(3,4),W+=W):(ke=X.substring(1,3),B=X.substring(3,5),W=X.substring(5,7)),ke=parseInt(ke,16),B=parseInt(B,16),W=parseInt(W,16)}}return{r:ke,g:B,b:W,a:he,style:X}},b=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},D=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};w.prototype.fillText=function(X,ke,B,W){if(isNaN(ke)||isNaN(B)||typeof X!="string")throw Kr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(W=isNaN(W)?void 0:W,!b.call(this)){var he=ie(this.ctx.transform.rotation),ne=this.ctx.transform.scaleX;I.call(this,{text:X,x:ke,y:B,scale:ne,angle:he,align:this.textAlign,maxWidth:W})}},w.prototype.strokeText=function(X,ke,B,W){if(isNaN(ke)||isNaN(B)||typeof X!="string")throw Kr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!D.call(this)){W=isNaN(W)?void 0:W;var he=ie(this.ctx.transform.rotation),ne=this.ctx.transform.scaleX;I.call(this,{text:X,x:ke,y:B,scale:ne,renderingMode:"stroke",angle:he,align:this.textAlign,maxWidth:W})}},w.prototype.measureText=function(X){if(typeof X!="string")throw Kr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var ke=this.pdf,B=this.pdf.internal.scaleFactor,W=ke.internal.getFontSize(),he=ke.getStringUnitWidth(X)*W/ke.internal.scaleFactor,ne=function(re){var ee=(re=re||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ee}}),this};return new ne({width:he*=Math.round(96*B/72*1e4)/1e4})},w.prototype.scale=function(X,ke){if(isNaN(X)||isNaN(ke))throw Kr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var B=new p(X,0,0,ke,0,0);this.ctx.transform=this.ctx.transform.multiply(B)},w.prototype.rotate=function(X){if(isNaN(X))throw Kr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var ke=new p(Math.cos(X),Math.sin(X),-Math.sin(X),Math.cos(X),0,0);this.ctx.transform=this.ctx.transform.multiply(ke)},w.prototype.translate=function(X,ke){if(isNaN(X)||isNaN(ke))throw Kr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var B=new p(1,0,0,1,X,ke);this.ctx.transform=this.ctx.transform.multiply(B)},w.prototype.transform=function(X,ke,B,W,he,ne){if(isNaN(X)||isNaN(ke)||isNaN(B)||isNaN(W)||isNaN(he)||isNaN(ne))throw Kr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var re=new p(X,ke,B,W,he,ne);this.ctx.transform=this.ctx.transform.multiply(re)},w.prototype.setTransform=function(X,ke,B,W,he,ne){X=isNaN(X)?1:X,ke=isNaN(ke)?0:ke,B=isNaN(B)?0:B,W=isNaN(W)?1:W,he=isNaN(he)?0:he,ne=isNaN(ne)?0:ne,this.ctx.transform=new p(X,ke,B,W,he,ne)};var j=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};w.prototype.drawImage=function(X,ke,B,W,he,ne,re,ee,oe){var Se=this.pdf.getImageProperties(X),te=1,ae=1,Le=1,ye=1;W!==void 0&&ee!==void 0&&(Le=ee/W,ye=oe/he,te=Se.width/W*ee/W,ae=Se.height/he*oe/he),ne===void 0&&(ne=ke,re=B,ke=0,B=0),W!==void 0&&ee===void 0&&(ee=W,oe=he),W===void 0&&ee===void 0&&(ee=Se.width,oe=Se.height);for(var ue,Oe=this.ctx.transform.decompose(),De=ie(Oe.rotate.shx),Me=new p,Ve=(Me=(Me=(Me=Me.multiply(Oe.translate)).multiply(Oe.skew)).multiply(Oe.scale)).applyToRectangle(new h(ne-ke*Le,re-B*ye,W*te,he*ae)),ze=Q.call(this,Ve),st=[],Qe=0;Qe<ze.length;Qe+=1)st.indexOf(ze[Qe])===-1&&st.push(ze[Qe]);if(pe(st),this.autoPaging)for(var pt=st[0],wt=st[st.length-1],Ht=pt;Ht<wt+1;Ht++){this.pdf.setPage(Ht);var nn=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],tt=Ht===1?this.posY+this.margin[0]:this.margin[0],Qt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],rn=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],it=Ht===1?0:Qt+(Ht-2)*rn;if(this.ctx.clip_path.length!==0){var Ke=this.path;ue=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=V(ue,this.posX+this.margin[3],-it+tt+this.ctx.prevPageLastElemOffset),Ie.call(this,"fill",!0),this.path=Ke}var qt=JSON.parse(JSON.stringify(Ve));qt=V([qt],this.posX+this.margin[3],-it+tt+this.ctx.prevPageLastElemOffset)[0];var mn=(Ht>pt||Ht<wt)&&j.call(this);mn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],nn,rn,null).clip().discardPath()),this.pdf.addImage(X,"JPEG",qt.x,qt.y,qt.w,qt.h,null,null,De),mn&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(X,"JPEG",Ve.x,Ve.y,Ve.w,Ve.h,null,null,De)};var Q=function(X,ke,B){var W=[];ke=ke||this.pdf.internal.pageSize.width,B=B||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var he=this.posY+this.ctx.prevPageLastElemOffset;switch(X.type){default:case"mt":case"lt":W.push(Math.floor((X.y+he)/B)+1);break;case"arc":W.push(Math.floor((X.y+he-X.radius)/B)+1),W.push(Math.floor((X.y+he+X.radius)/B)+1);break;case"qct":var ne=Ae(this.ctx.lastPoint.x,this.ctx.lastPoint.y,X.x1,X.y1,X.x,X.y);W.push(Math.floor((ne.y+he)/B)+1),W.push(Math.floor((ne.y+ne.h+he)/B)+1);break;case"bct":var re=Te(this.ctx.lastPoint.x,this.ctx.lastPoint.y,X.x1,X.y1,X.x2,X.y2,X.x,X.y);W.push(Math.floor((re.y+he)/B)+1),W.push(Math.floor((re.y+re.h+he)/B)+1);break;case"rect":W.push(Math.floor((X.y+he)/B)+1),W.push(Math.floor((X.y+X.h+he)/B)+1)}for(var ee=0;ee<W.length;ee+=1)for(;this.pdf.internal.getNumberOfPages()<W[ee];)F.call(this);return W},F=function(){var X=this.fillStyle,ke=this.strokeStyle,B=this.font,W=this.lineCap,he=this.lineWidth,ne=this.lineJoin;this.pdf.addPage(),this.fillStyle=X,this.strokeStyle=ke,this.font=B,this.lineCap=W,this.lineWidth=he,this.lineJoin=ne},V=function(X,ke,B){for(var W=0;W<X.length;W++)switch(X[W].type){case"bct":X[W].x2+=ke,X[W].y2+=B;case"qct":X[W].x1+=ke,X[W].y1+=B;case"mt":case"lt":case"arc":default:X[W].x+=ke,X[W].y+=B}return X},pe=function(X){return X.sort(function(ke,B){return ke-B})},Ee=function(X,ke){for(var B,W,he=this.fillStyle,ne=this.strokeStyle,re=this.lineCap,ee=this.lineWidth,oe=Math.abs(ee*this.ctx.transform.scaleX),Se=this.lineJoin,te=JSON.parse(JSON.stringify(this.path)),ae=JSON.parse(JSON.stringify(this.path)),Le=[],ye=0;ye<ae.length;ye++)if(ae[ye].x!==void 0)for(var ue=Q.call(this,ae[ye]),Oe=0;Oe<ue.length;Oe+=1)Le.indexOf(ue[Oe])===-1&&Le.push(ue[Oe]);for(var De=0;De<Le.length;De++)for(;this.pdf.internal.getNumberOfPages()<Le[De];)F.call(this);if(pe(Le),this.autoPaging)for(var Me=Le[0],Ve=Le[Le.length-1],ze=Me;ze<Ve+1;ze++){this.pdf.setPage(ze),this.fillStyle=he,this.strokeStyle=ne,this.lineCap=re,this.lineWidth=oe,this.lineJoin=Se;var st=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Qe=ze===1?this.posY+this.margin[0]:this.margin[0],pt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],wt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ht=ze===1?0:pt+(ze-2)*wt;if(this.ctx.clip_path.length!==0){var nn=this.path;B=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=V(B,this.posX+this.margin[3],-Ht+Qe+this.ctx.prevPageLastElemOffset),Ie.call(this,X,!0),this.path=nn}if(W=JSON.parse(JSON.stringify(te)),this.path=V(W,this.posX+this.margin[3],-Ht+Qe+this.ctx.prevPageLastElemOffset),ke===!1||ze===0){var tt=(ze>Me||ze<Ve)&&j.call(this);tt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],st,wt,null).clip().discardPath()),Ie.call(this,X,ke),tt&&this.pdf.restoreGraphicsState()}this.lineWidth=ee}else this.lineWidth=oe,Ie.call(this,X,ke),this.lineWidth=ee;this.path=te},Ie=function(X,ke){if((X!=="stroke"||ke||!D.call(this))&&(X==="stroke"||ke||!b.call(this))){for(var B,W,he=[],ne=this.path,re=0;re<ne.length;re++){var ee=ne[re];switch(ee.type){case"begin":he.push({begin:!0});break;case"close":he.push({close:!0});break;case"mt":he.push({start:ee,deltas:[],abs:[]});break;case"lt":var oe=he.length;if(ne[re-1]&&!isNaN(ne[re-1].x)&&(B=[ee.x-ne[re-1].x,ee.y-ne[re-1].y],oe>0)){for(;oe>=0;oe--)if(he[oe-1].close!==!0&&he[oe-1].begin!==!0){he[oe-1].deltas.push(B),he[oe-1].abs.push(ee);break}}break;case"bct":B=[ee.x1-ne[re-1].x,ee.y1-ne[re-1].y,ee.x2-ne[re-1].x,ee.y2-ne[re-1].y,ee.x-ne[re-1].x,ee.y-ne[re-1].y],he[he.length-1].deltas.push(B);break;case"qct":var Se=ne[re-1].x+2/3*(ee.x1-ne[re-1].x),te=ne[re-1].y+2/3*(ee.y1-ne[re-1].y),ae=ee.x+2/3*(ee.x1-ee.x),Le=ee.y+2/3*(ee.y1-ee.y),ye=ee.x,ue=ee.y;B=[Se-ne[re-1].x,te-ne[re-1].y,ae-ne[re-1].x,Le-ne[re-1].y,ye-ne[re-1].x,ue-ne[re-1].y],he[he.length-1].deltas.push(B);break;case"arc":he.push({deltas:[],abs:[],arc:!0}),Array.isArray(he[he.length-1].abs)&&he[he.length-1].abs.push(ee)}}W=ke?null:X==="stroke"?"stroke":"fill";for(var Oe=!1,De=0;De<he.length;De++)if(he[De].arc)for(var Me=he[De].abs,Ve=0;Ve<Me.length;Ve++){var ze=Me[Ve];ze.type==="arc"?O.call(this,ze.x,ze.y,ze.radius,ze.startAngle,ze.endAngle,ze.counterclockwise,void 0,ke,!Oe):Y.call(this,ze.x,ze.y),Oe=!0}else if(he[De].close===!0)this.pdf.internal.out("h"),Oe=!1;else if(he[De].begin!==!0){var st=he[De].start.x,Qe=he[De].start.y;$.call(this,he[De].deltas,st,Qe),Oe=!0}W&&H.call(this,W),ke&&le.call(this)}},nt=function(X){var ke=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,B=ke*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return X-B;case"top":return X+ke-B;case"hanging":return X+ke-2*B;case"middle":return X+ke/2-B;case"ideographic":return X;case"alphabetic":default:return X}},We=function(X){return X+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};w.prototype.createLinearGradient=function(){var X=function(){};return X.colorStops=[],X.addColorStop=function(ke,B){this.colorStops.push([ke,B])},X.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},X.isCanvasGradient=!0,X},w.prototype.createPattern=function(){return this.createLinearGradient()},w.prototype.createRadialGradient=function(){return this.createLinearGradient()};var O=function(X,ke,B,W,he,ne,re,ee,oe){for(var Se=Z.call(this,B,W,he,ne),te=0;te<Se.length;te++){var ae=Se[te];te===0&&(oe?G.call(this,ae.x1+X,ae.y1+ke):Y.call(this,ae.x1+X,ae.y1+ke)),R.call(this,X,ke,ae.x2,ae.y2,ae.x3,ae.y3,ae.x4,ae.y4)}ee?le.call(this):H.call(this,re)},H=function(X){switch(X){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},le=function(){this.pdf.clip(),this.pdf.discardPath()},G=function(X,ke){this.pdf.internal.out(t(X)+" "+i(ke)+" m")},I=function(X){var ke;switch(X.align){case"right":case"end":ke="right";break;case"center":ke="center";break;case"left":case"start":default:ke="left"}var B=this.pdf.getTextDimensions(X.text),W=nt.call(this,X.y),he=We.call(this,W)-B.h,ne=this.ctx.transform.applyToPoint(new l(X.x,W)),re=this.ctx.transform.decompose(),ee=new p;ee=(ee=(ee=ee.multiply(re.translate)).multiply(re.skew)).multiply(re.scale);for(var oe,Se,te,ae=this.ctx.transform.applyToRectangle(new h(X.x,W,B.w,B.h)),Le=ee.applyToRectangle(new h(X.x,he,B.w,B.h)),ye=Q.call(this,Le),ue=[],Oe=0;Oe<ye.length;Oe+=1)ue.indexOf(ye[Oe])===-1&&ue.push(ye[Oe]);if(pe(ue),this.autoPaging)for(var De=ue[0],Me=ue[ue.length-1],Ve=De;Ve<Me+1;Ve++){this.pdf.setPage(Ve);var ze=Ve===1?this.posY+this.margin[0]:this.margin[0],st=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Qe=this.pdf.internal.pageSize.height-this.margin[2],pt=Qe-this.margin[0],wt=this.pdf.internal.pageSize.width-this.margin[1],Ht=wt-this.margin[3],nn=Ve===1?0:st+(Ve-2)*pt;if(this.ctx.clip_path.length!==0){var tt=this.path;oe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=V(oe,this.posX+this.margin[3],-1*nn+ze),Ie.call(this,"fill",!0),this.path=tt}var Qt=V([JSON.parse(JSON.stringify(Le))],this.posX+this.margin[3],-nn+ze+this.ctx.prevPageLastElemOffset)[0];X.scale>=.01&&(Se=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Se*X.scale),te=this.lineWidth,this.lineWidth=te*X.scale);var rn=this.autoPaging!=="text";if(rn||Qt.y+Qt.h<=Qe){if(rn||Qt.y>=ze&&Qt.x<=wt){var it=rn?X.text:this.pdf.splitTextToSize(X.text,X.maxWidth||wt-Qt.x)[0],Ke=V([JSON.parse(JSON.stringify(ae))],this.posX+this.margin[3],-nn+ze+this.ctx.prevPageLastElemOffset)[0],qt=rn&&(Ve>De||Ve<Me)&&j.call(this);qt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ht,pt,null).clip().discardPath()),this.pdf.text(it,Ke.x,Ke.y,{angle:X.angle,align:ke,renderingMode:X.renderingMode}),qt&&this.pdf.restoreGraphicsState()}}else Qt.y<Qe&&(this.ctx.prevPageLastElemOffset+=Qe-Qt.y);X.scale>=.01&&(this.pdf.setFontSize(Se),this.lineWidth=te)}else X.scale>=.01&&(Se=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Se*X.scale),te=this.lineWidth,this.lineWidth=te*X.scale),this.pdf.text(X.text,ne.x+this.posX,ne.y+this.posY,{angle:X.angle,align:ke,renderingMode:X.renderingMode,maxWidth:X.maxWidth}),X.scale>=.01&&(this.pdf.setFontSize(Se),this.lineWidth=te)},Y=function(X,ke,B,W){B=B||0,W=W||0,this.pdf.internal.out(t(X+B)+" "+i(ke+W)+" l")},$=function(X,ke,B){return this.pdf.lines(X,ke,B,null,null)},R=function(X,ke,B,W,he,ne,re,ee){this.pdf.internal.out([n(r(B+X)),n(o(W+ke)),n(r(he+X)),n(o(ne+ke)),n(r(re+X)),n(o(ee+ke)),"c"].join(" "))},Z=function(X,ke,B,W){for(var he=2*Math.PI,ne=Math.PI/2;ke>B;)ke-=he;var re=Math.abs(B-ke);re<he&&W&&(re=he-re);for(var ee=[],oe=W?-1:1,Se=ke;re>1e-5;){var te=Se+oe*Math.min(re,ne);ee.push(se.call(this,X,Se,te)),re-=Math.abs(te-Se),Se=te}return ee},se=function(X,ke,B){var W=(B-ke)/2,he=X*Math.cos(W),ne=X*Math.sin(W),re=he,ee=-ne,oe=re*re+ee*ee,Se=oe+re*he+ee*ne,te=4/3*(Math.sqrt(2*oe*Se)-Se)/(re*ne-ee*he),ae=re-te*ee,Le=ee+te*re,ye=ae,ue=-Le,Oe=W+ke,De=Math.cos(Oe),Me=Math.sin(Oe);return{x1:X*Math.cos(ke),y1:X*Math.sin(ke),x2:ae*De-Le*Me,y2:ae*Me+Le*De,x3:ye*De-ue*Me,y3:ye*Me+ue*De,x4:X*Math.cos(B),y4:X*Math.sin(B)}},ie=function(X){return 180*X/Math.PI},Ae=function(X,ke,B,W,he,ne){var re=X+.5*(B-X),ee=ke+.5*(W-ke),oe=he+.5*(B-he),Se=ne+.5*(W-ne),te=Math.min(X,he,re,oe),ae=Math.max(X,he,re,oe),Le=Math.min(ke,ne,ee,Se),ye=Math.max(ke,ne,ee,Se);return new h(te,Le,ae-te,ye-Le)},Te=function(X,ke,B,W,he,ne,re,ee){var oe,Se,te,ae,Le,ye,ue,Oe,De,Me,Ve,ze,st,Qe,pt=B-X,wt=W-ke,Ht=he-B,nn=ne-W,tt=re-he,Qt=ee-ne;for(Se=0;Se<41;Se++)De=(ue=(te=X+(oe=Se/40)*pt)+oe*((Le=B+oe*Ht)-te))+oe*(Le+oe*(he+oe*tt-Le)-ue),Me=(Oe=(ae=ke+oe*wt)+oe*((ye=W+oe*nn)-ae))+oe*(ye+oe*(ne+oe*Qt-ye)-Oe),Se==0?(Ve=De,ze=Me,st=De,Qe=Me):(Ve=Math.min(Ve,De),ze=Math.min(ze,Me),st=Math.max(st,De),Qe=Math.max(Qe,Me));return new h(Math.round(Ve),Math.round(ze),Math.round(st-Ve),Math.round(Qe-ze))},ut=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var X,ke,B=(X=this.ctx.lineDash,ke=this.ctx.lineDashOffset,JSON.stringify({lineDash:X,lineDashOffset:ke}));this.prevLineDash!==B&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=B)}}})(wi.API),function(e){var n=function(o){var l,h,p,m,_,w,E,b,D,j;for(h=[],p=0,m=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;m>p;p+=4)(_=(o.charCodeAt(p)<<24)+(o.charCodeAt(p+1)<<16)+(o.charCodeAt(p+2)<<8)+o.charCodeAt(p+3))!==0?(w=(_=((_=((_=((_=(_-(j=_%85))/85)-(D=_%85))/85)-(b=_%85))/85)-(E=_%85))/85)%85,h.push(w+33,E+33,b+33,D+33,j+33)):h.push(122);return function(Q,F){for(var V=F;V>0;V--)Q.pop()}(h,l.length),String.fromCharCode.apply(String,h)+"~>"},t=function(o){var l,h,p,m,_,w=String,E="length",b=255,D="charCodeAt",j="slice",Q="replace";for(o[j](-2),o=o[j](0,-2)[Q](/\s/g,"")[Q]("z","!!!!!"),p=[],m=0,_=(o+=l="uuuuu"[j](o[E]%5||5))[E];_>m;m+=5)h=52200625*(o[D](m)-33)+614125*(o[D](m+1)-33)+7225*(o[D](m+2)-33)+85*(o[D](m+3)-33)+(o[D](m+4)-33),p.push(b&h>>24,b&h>>16,b&h>>8,b&h);return function(F,V){for(var pe=V;pe>0;pe--)F.pop()}(p,l[E]),w.fromCharCode.apply(w,p)},i=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var h="",p=0;p<o.length;p+=2)h+=String.fromCharCode("0x"+(o[p]+o[p+1]));return h},r=function(o){for(var l=new Uint8Array(o.length),h=o.length;h--;)l[h]=o.charCodeAt(h);return o=(l=$g(l)).reduce(function(p,m){return p+String.fromCharCode(m)},"")};e.processDataByFilters=function(o,l){var h=0,p=o||"",m=[];for(typeof(l=l||[])=="string"&&(l=[l]),h=0;h<l.length;h+=1)switch(l[h]){case"ASCII85Decode":case"/ASCII85Decode":p=t(p),m.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":p=n(p),m.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":p=i(p),m.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":p=p.split("").map(function(_){return("0"+_.charCodeAt().toString(16)).slice(-2)}).join("")+">",m.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":p=r(p),m.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[h]+'" is not implemented')}return{data:p,reverseChain:m.reverse().join(" ")}}}(wi.API),function(e){e.loadFile=function(n,t,i){return function(r,o,l){o=o!==!1,l=typeof l=="function"?l:function(){};var h=void 0;try{h=function(p,m,_){var w=new XMLHttpRequest,E=0,b=function(D){var j=D.length,Q=[],F=String.fromCharCode;for(E=0;E<j;E+=1)Q.push(F(255&D.charCodeAt(E)));return Q.join("")};if(w.open("GET",p,!m),w.overrideMimeType("text/plain; charset=x-user-defined"),m===!1&&(w.onload=function(){w.status===200?_(b(this.responseText)):_(void 0)}),w.send(null),m&&w.status===200)return b(w.responseText)}(r,o,l)}catch{}return h}(n,t,i)},e.loadImageFile=e.loadFile}(wi.API),function(e){function n(){return(xi.html2canvas?Promise.resolve(xi.html2canvas):nh(()=>import("./html2canvas.esm.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function t(){return(xi.DOMPurify?Promise.resolve(xi.DOMPurify):nh(()=>import("./purify.es.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var i=function(l){var h=Fr(l);return h==="undefined"?"undefined":h==="string"||l instanceof String?"string":h==="number"||l instanceof Number?"number":h==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":h==="object"?"object":"unknown"},r=function(l,h){var p=document.createElement(l);for(var m in h.className&&(p.className=h.className),h.innerHTML&&h.dompurify&&(p.innerHTML=h.dompurify.sanitize(h.innerHTML)),h.style)p.style[m]=h.style[m];return p},o=function l(h){var p=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),m=l.convert(Promise.resolve(),p);return m=(m=m.setProgress(1,l,1,[l])).set(h)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,h){return l.__proto__=h||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,h){return this.then(function(){switch(h=h||function(p){switch(i(p)){case"string":return"string";case"element":return p.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l)){case"string":return this.then(t).then(function(p){return this.set({src:r("div",{innerHTML:l,dompurify:p})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},h=function p(m,_){for(var w=m.nodeType===3?document.createTextNode(m.nodeValue):m.cloneNode(!1),E=m.firstChild;E;E=E.nextSibling)_!==!0&&E.nodeType===1&&E.nodeName==="SCRIPT"||w.appendChild(p(E,_));return m.nodeType===1&&(m.nodeName==="CANVAS"?(w.width=m.width,w.height=m.height,w.getContext("2d").drawImage(m,0,0)):m.nodeName!=="TEXTAREA"&&m.nodeName!=="SELECT"||(w.value=m.value),w.addEventListener("load",function(){w.scrollTop=m.scrollTop,w.scrollLeft=m.scrollLeft},!0)),w}(this.prop.src,this.opt.html2canvas.javascriptEnabled);h.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=r("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=r("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(h),this.prop.container.firstChild.appendChild(r("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(n).then(function(h){var p=Object.assign({},this.opt.html2canvas);return delete p.onrendered,h(this.prop.container,p)}).then(function(h){(this.opt.html2canvas.onrendered||function(){})(h),this.prop.canvas=h,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(n).then(function(h){var p=this.opt.jsPDF,m=this.opt.fontFaces,_=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,w=Object.assign({async:!0,allowTaint:!0,scale:_,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete w.onrendered,p.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,p.context2d.posX=this.opt.x,p.context2d.posY=this.opt.y,p.context2d.margin=this.opt.margin,p.context2d.fontFaces=m,m)for(var E=0;E<m.length;++E){var b=m[E],D=b.src.find(function(j){return j.format==="truetype"});D&&p.addFont(D.url,b.ref.name,b.ref.style)}return w.windowHeight=w.windowHeight||0,w.windowHeight=w.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):w.windowHeight,p.context2d.save(!0),h(this.prop.container,w)}).then(function(h){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(h),this.prop.canvas=h,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,h,p){return(p=p||"pdf").toLowerCase()==="img"||p.toLowerCase()==="image"?this.outputImg(l,h):this.outputPdf(l,h)},o.prototype.outputPdf=function(l,h){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,h)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(i(l)!=="object")return this;var h=Object.keys(l||{}).map(function(p){if(p in o.template.prop)return function(){this.prop[p]=l[p]};switch(p){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[p]=l[p]}}},this);return this.then(function(){return this.thenList(h)})},o.prototype.get=function(l,h){return this.then(function(){var p=l in o.template.prop?this.prop[l]:this.opt[l];return h?h(p):p})},o.prototype.setMargin=function(l){return this.then(function(){switch(i(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function h(p,m){return Math.floor(p*m/72*96)}return this.then(function(){(l=l||wi.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:h(l.inner.width,l.k),height:h(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,h,p,m){return l!=null&&(this.progress.val=l),h!=null&&(this.progress.state=h),p!=null&&(this.progress.n=p),m!=null&&(this.progress.stack=m),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,h,p,m){return this.setProgress(l?this.progress.val+l:null,h||null,p?this.progress.n+p:null,m?this.progress.stack.concat(m):null)},o.prototype.then=function(l,h){var p=this;return this.thenCore(l,h,function(m,_){return p.updateProgress(null,null,1,[m]),Promise.prototype.then.call(this,function(w){return p.updateProgress(null,m),w}).then(m,_).then(function(w){return p.updateProgress(1),w})})},o.prototype.thenCore=function(l,h,p){p=p||Promise.prototype.then,l&&(l=l.bind(this)),h&&(h=h.bind(this));var m=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:o.convert(Object.assign({},this),Promise.prototype),_=p.call(m,l,h);return o.convert(_,this.__proto__)},o.prototype.thenExternal=function(l,h){return Promise.prototype.then.call(this,l,h)},o.prototype.thenList=function(l){var h=this;return l.forEach(function(p){h=h.thenCore(p)}),h},o.prototype.catch=function(l){l&&(l=l.bind(this));var h=Promise.prototype.catch.call(this,l);return o.convert(h,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,wi.getPageSize=function(l,h,p){if(Fr(l)==="object"){var m=l;l=m.orientation,h=m.unit||h,p=m.format||p}h=h||"mm",p=p||"a4",l=(""+(l||"P")).toLowerCase();var _,w=(""+p).toLowerCase(),E={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(h){case"pt":_=1;break;case"mm":_=72/25.4;break;case"cm":_=72/2.54;break;case"in":_=72;break;case"px":_=.75;break;case"pc":case"em":_=12;break;case"ex":_=6;break;default:throw"Invalid unit: "+h}var b,D=0,j=0;if(E.hasOwnProperty(w))D=E[w][1]/_,j=E[w][0]/_;else try{D=p[1],j=p[0]}catch{throw new Error("Invalid format: "+p)}if(l==="p"||l==="portrait")l="p",j>D&&(b=j,j=D,D=b);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",D>j&&(b=j,j=D,D=b)}return{width:j,height:D,unit:h,k:_,orientation:l}},e.html=function(l,h){(h=h||{}).callback=h.callback||function(){},h.html2canvas=h.html2canvas||{},h.html2canvas.canvas=h.html2canvas.canvas||this.canvas,h.jsPDF=h.jsPDF||this,h.fontFaces=h.fontFaces?h.fontFaces.map(Zg):null;var p=new o(h);return h.worker?p:p.from(l).doCallback()}}(wi.API),wi.API.addJS=function(e){return Uy=e,this.internal.events.subscribe("postPutResources",function(){Td=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Td+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),jy=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Uy+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Td!==void 0&&jy!==void 0&&this.internal.out("/Names <</JavaScript "+Td+" 0 R>>")}),this},function(e){var n;e.events.push(["postPutResources",function(){var t=this,i=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=t.outline.render().split(/\r\n/),o=0;o<r.length;o++){var l=r[o],h=i.exec(l);if(h!=null){var p=h[1];t.internal.newObjectDeferredBegin(p,!1)}t.internal.write(l)}if(this.outline.createNamedDestinations){var m=this.internal.pages.length,_=[];for(o=0;o<m;o++){var w=t.internal.newObject();_.push(w);var E=t.internal.getPageInfo(o+1);t.internal.write("<< /D["+E.objId+" 0 R /XYZ null null null]>> endobj")}var b=t.internal.newObject();for(t.internal.write("<< /Names [ "),o=0;o<_.length;o++)t.internal.write("(page_"+(o+1)+")"+_[o]+" 0 R");t.internal.write(" ] >>","endobj"),n=t.internal.newObject(),t.internal.write("<< /Dests "+b+" 0 R"),t.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+n+" 0 R"))}]),e.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(i,r,o){var l={title:r,options:o,children:[]};return i==null&&(i=this.root),i.children.push(l),l},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(i){i.id=t.internal.newObjectDeferred();for(var r=0;r<i.children.length;r++)this.genIds_r(i.children[r])},t.outline.renderRoot=function(i){this.objStart(i),this.line("/Type /Outlines"),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1]))),this.line("/Count "+this.count_r({count:0},i)),this.objEnd()},t.outline.renderItems=function(i){for(var r=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<i.children.length;o++){var l=i.children[o];this.objStart(l),this.line("/Title "+this.makeString(l.title)),this.line("/Parent "+this.makeRef(i)),o>0&&this.line("/Prev "+this.makeRef(i.children[o-1])),o<i.children.length-1&&this.line("/Next "+this.makeRef(i.children[o+1])),l.children.length>0&&(this.line("/First "+this.makeRef(l.children[0])),this.line("/Last "+this.makeRef(l.children[l.children.length-1])));var h=this.count=this.count_r({count:0},l);if(h>0&&this.line("/Count "+h),l.options&&l.options.pageNumber){var p=t.internal.getPageInfo(l.options.pageNumber);this.line("/Dest ["+p.objId+" 0 R /XYZ 0 "+r(0)+" 0]")}this.objEnd()}for(var m=0;m<i.children.length;m++)this.renderItems(i.children[m])},t.outline.line=function(i){this.ctx.val+=i+`\r
`},t.outline.makeRef=function(i){return i.id+" 0 R"},t.outline.makeString=function(i){return"("+t.internal.pdfEscape(i)+")"},t.outline.objStart=function(i){this.ctx.val+=`\r
`+i.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(i,r){for(var o=0;o<r.children.length;o++)i.count++,this.count_r(i,r.children[o]);return i.count}}])}(wi.API),function(e){var n=[192,193,194,195,196,197,198,199];e.processJPEG=function(t,i,r,o,l,h){var p,m=this.decode.DCT_DECODE,_=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=l||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,(p=function(w){for(var E,b=256*w.charCodeAt(4)+w.charCodeAt(5),D=w.length,j={width:0,height:0,numcomponents:1},Q=4;Q<D;Q+=2){if(Q+=b,n.indexOf(w.charCodeAt(Q+1))!==-1){E=256*w.charCodeAt(Q+5)+w.charCodeAt(Q+6),j={width:256*w.charCodeAt(Q+7)+w.charCodeAt(Q+8),height:E,numcomponents:w.charCodeAt(Q+9)};break}b=256*w.charCodeAt(Q+2)+w.charCodeAt(Q+3)}return j}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:h=this.color_spaces.DEVICE_GRAY;break;case 4:h=this.color_spaces.DEVICE_CMYK;break;case 3:h=this.color_spaces.DEVICE_RGB}_={data:t,width:p.width,height:p.height,colorSpace:h,bitsPerComponent:8,filter:m,index:i,alias:r}}return _}}(wi.API);var Bh,Bd,$y,qy,Gy,_N=function(){var e,n,t;function i(o){var l,h,p,m,_,w,E,b,D,j,Q,F,V,pe;for(this.data=o,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},w=null;;){switch(l=this.readUInt32(),D=(function(){var Ee,Ie;for(Ie=[],Ee=0;Ee<4;++Ee)Ie.push(String.fromCharCode(this.data[this.pos++]));return Ie}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(l);break;case"fcTL":w&&this.animation.frames.push(w),this.pos+=4,w={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},_=this.readUInt16(),m=this.readUInt16()||100,w.delay=1e3*_/m,w.disposeOp=this.data[this.pos++],w.blendOp=this.data[this.pos++],w.data=[];break;case"IDAT":case"fdAT":for(D==="fdAT"&&(this.pos+=4,l-=4),o=(w!=null?w.data:void 0)||this.imgData,F=0;0<=l?F<l:F>l;0<=l?++F:--F)o.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(p=this.palette.length/3,this.transparency.indexed=this.read(l),this.transparency.indexed.length>p)throw new Error("More transparent colors than palette size");if((j=p-this.transparency.indexed.length)>0)for(V=0;0<=j?V<j:V>j;0<=j?++V:--V)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(l)[0];break;case 2:this.transparency.rgb=this.read(l)}break;case"tEXt":E=(Q=this.read(l)).indexOf(0),b=String.fromCharCode.apply(String,Q.slice(0,E)),this.text[b]=String.fromCharCode.apply(String,Q.slice(E+1));break;case"IEND":return w&&this.animation.frames.push(w),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(pe=this.colorType)===4||pe===6,h=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*h,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=l}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}i.prototype.read=function(o){var l,h;for(h=[],l=0;0<=o?l<o:l>o;0<=o?++l:--l)h.push(this.data[this.pos++]);return h},i.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},i.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},i.prototype.decodePixels=function(o){var l=this.pixelBitlength/8,h=new Uint8Array(this.width*this.height*l),p=0,m=this;if(o==null&&(o=this.imgData),o.length===0)return new Uint8Array(0);function _(w,E,b,D){var j,Q,F,V,pe,Ee,Ie,nt,We,O,H,le,G,I,Y,$,R,Z,se,ie,Ae,Te=Math.ceil((m.width-w)/b),ut=Math.ceil((m.height-E)/D),X=m.width==Te&&m.height==ut;for(I=l*Te,le=X?h:new Uint8Array(I*ut),Ee=o.length,G=0,Q=0;G<ut&&p<Ee;){switch(o[p++]){case 0:for(V=R=0;R<I;V=R+=1)le[Q++]=o[p++];break;case 1:for(V=Z=0;Z<I;V=Z+=1)j=o[p++],pe=V<l?0:le[Q-l],le[Q++]=(j+pe)%256;break;case 2:for(V=se=0;se<I;V=se+=1)j=o[p++],F=(V-V%l)/l,Y=G&&le[(G-1)*I+F*l+V%l],le[Q++]=(Y+j)%256;break;case 3:for(V=ie=0;ie<I;V=ie+=1)j=o[p++],F=(V-V%l)/l,pe=V<l?0:le[Q-l],Y=G&&le[(G-1)*I+F*l+V%l],le[Q++]=(j+Math.floor((pe+Y)/2))%256;break;case 4:for(V=Ae=0;Ae<I;V=Ae+=1)j=o[p++],F=(V-V%l)/l,pe=V<l?0:le[Q-l],G===0?Y=$=0:(Y=le[(G-1)*I+F*l+V%l],$=F&&le[(G-1)*I+(F-1)*l+V%l]),Ie=pe+Y-$,nt=Math.abs(Ie-pe),O=Math.abs(Ie-Y),H=Math.abs(Ie-$),We=nt<=O&&nt<=H?pe:O<=H?Y:$,le[Q++]=(j+We)%256;break;default:throw new Error("Invalid filter algorithm: "+o[p-1])}if(!X){var ke=((E+G*D)*m.width+w)*l,B=G*I;for(V=0;V<Te;V+=1){for(var W=0;W<l;W+=1)h[ke++]=le[B++];ke+=(b-1)*l}}G++}}return o=Y7(o),m.interlaceMethod==1?(_(0,0,8,8),_(4,0,8,8),_(0,4,4,8),_(2,0,4,4),_(0,2,2,4),_(1,0,2,2),_(0,1,1,2)):_(0,0,1,1),h},i.prototype.decodePalette=function(){var o,l,h,p,m,_,w,E,b;for(h=this.palette,_=this.transparency.indexed||[],m=new Uint8Array((_.length||0)+h.length),p=0,o=0,l=w=0,E=h.length;w<E;l=w+=3)m[p++]=h[l],m[p++]=h[l+1],m[p++]=h[l+2],m[p++]=(b=_[o++])!=null?b:255;return m},i.prototype.copyToImageData=function(o,l){var h,p,m,_,w,E,b,D,j,Q,F;if(p=this.colors,j=null,h=this.hasAlphaChannel,this.palette.length&&(j=(F=this._decodedPalette)!=null?F:this._decodedPalette=this.decodePalette(),p=4,h=!0),D=(m=o.data||o).length,w=j||l,_=E=0,p===1)for(;_<D;)b=j?4*l[_/4]:E,Q=w[b++],m[_++]=Q,m[_++]=Q,m[_++]=Q,m[_++]=h?w[b++]:255,E=b;else for(;_<D;)b=j?4*l[_/4]:E,m[_++]=w[b++],m[_++]=w[b++],m[_++]=w[b++],m[_++]=h?w[b++]:255,E=b},i.prototype.decode=function(){var o;return o=new Uint8Array(this.width*this.height*4),this.copyToImageData(o,this.decodePixels()),o};var r=function(){if(Object.prototype.toString.call(xi)==="[object Window]"){try{n=xi.document.createElement("canvas"),t=n.getContext("2d")}catch{return!1}return!0}return!1};return r(),e=function(o){var l;if(r()===!0)return t.width=o.width,t.height=o.height,t.clearRect(0,0,o.width,o.height),t.putImageData(o,0,0),(l=new Image).src=n.toDataURL(),l;throw new Error("This method requires a Browser with Canvas-capability.")},i.prototype.decodeFrames=function(o){var l,h,p,m,_,w,E,b;if(this.animation){for(b=[],h=_=0,w=(E=this.animation.frames).length;_<w;h=++_)l=E[h],p=o.createImageData(l.width,l.height),m=this.decodePixels(new Uint8Array(l.data)),this.copyToImageData(p,m),l.imageData=p,b.push(l.image=e(p));return b}},i.prototype.renderFrame=function(o,l){var h,p,m;return h=(p=this.animation.frames)[l],m=p[l-1],l===0&&o.clearRect(0,0,this.width,this.height),(m!=null?m.disposeOp:void 0)===1?o.clearRect(m.xOffset,m.yOffset,m.width,m.height):(m!=null?m.disposeOp:void 0)===2&&o.putImageData(m.imageData,m.xOffset,m.yOffset),h.blendOp===0&&o.clearRect(h.xOffset,h.yOffset,h.width,h.height),o.drawImage(h.image,h.xOffset,h.yOffset)},i.prototype.animate=function(o){var l,h,p,m,_,w,E=this;return h=0,w=this.animation,m=w.numFrames,p=w.frames,_=w.numPlays,(l=function(){var b,D;if(b=h++%m,D=p[b],E.renderFrame(o,b),m>1&&h/m<_)return E.animation._timeout=setTimeout(l,D.delay)})()},i.prototype.stopAnimation=function(){var o;return clearTimeout((o=this.animation)!=null?o._timeout:void 0)},i.prototype.render=function(o){var l,h;return o._png&&o._png.stopAnimation(),o._png=this,o.width=this.width,o.height=this.height,l=o.getContext("2d"),this.animation?(this.decodeFrames(l),this.animate(l)):(h=l.createImageData(this.width,this.height),this.copyToImageData(h,this.decodePixels()),l.putImageData(h,0,0))},i}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function bN(e){var n=0;if(e[n++]!==71||e[n++]!==73||e[n++]!==70||e[n++]!==56||(e[n++]+1&253)!=56||e[n++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=e[n++]|e[n++]<<8,i=e[n++]|e[n++]<<8,r=e[n++],o=r>>7,l=1<<(7&r)+1;e[n++],e[n++];var h=null,p=null;o&&(h=n,p=l,n+=3*l);var m=!0,_=[],w=0,E=null,b=0,D=null;for(this.width=t,this.height=i;m&&n<e.length;)switch(e[n++]){case 33:switch(e[n++]){case 255:if(e[n]!==11||e[n+1]==78&&e[n+2]==69&&e[n+3]==84&&e[n+4]==83&&e[n+5]==67&&e[n+6]==65&&e[n+7]==80&&e[n+8]==69&&e[n+9]==50&&e[n+10]==46&&e[n+11]==48&&e[n+12]==3&&e[n+13]==1&&e[n+16]==0)n+=14,D=e[n++]|e[n++]<<8,n++;else for(n+=12;;){if(!((G=e[n++])>=0))throw Error("Invalid block size");if(G===0)break;n+=G}break;case 249:if(e[n++]!==4||e[n+4]!==0)throw new Error("Invalid graphics extension block.");var j=e[n++];w=e[n++]|e[n++]<<8,E=e[n++],!(1&j)&&(E=null),b=j>>2&7,n++;break;case 254:for(;;){if(!((G=e[n++])>=0))throw Error("Invalid block size");if(G===0)break;n+=G}break;default:throw new Error("Unknown graphic control label: 0x"+e[n-1].toString(16))}break;case 44:var Q=e[n++]|e[n++]<<8,F=e[n++]|e[n++]<<8,V=e[n++]|e[n++]<<8,pe=e[n++]|e[n++]<<8,Ee=e[n++],Ie=Ee>>6&1,nt=1<<(7&Ee)+1,We=h,O=p,H=!1;Ee>>7&&(H=!0,We=n,O=nt,n+=3*nt);var le=n;for(n++;;){var G;if(!((G=e[n++])>=0))throw Error("Invalid block size");if(G===0)break;n+=G}_.push({x:Q,y:F,width:V,height:pe,has_local_palette:H,palette_offset:We,palette_size:O,data_offset:le,data_length:n-le,transparent_index:E,interlaced:!!Ie,delay:w,disposal:b});break;case 59:m=!1;break;default:throw new Error("Unknown gif block: 0x"+e[n-1].toString(16))}this.numFrames=function(){return _.length},this.loopCount=function(){return D},this.frameInfo=function(I){if(I<0||I>=_.length)throw new Error("Frame index out of range.");return _[I]},this.decodeAndBlitFrameBGRA=function(I,Y){var $=this.frameInfo(I),R=$.width*$.height,Z=new Uint8Array(R);Vy(e,$.data_offset,Z,R);var se=$.palette_offset,ie=$.transparent_index;ie===null&&(ie=256);var Ae=$.width,Te=t-Ae,ut=Ae,X=4*($.y*t+$.x),ke=4*(($.y+$.height)*t+$.x),B=X,W=4*Te;$.interlaced===!0&&(W+=4*t*7);for(var he=8,ne=0,re=Z.length;ne<re;++ne){var ee=Z[ne];if(ut===0&&(ut=Ae,(B+=W)>=ke&&(W=4*Te+4*t*(he-1),B=X+(Ae+Te)*(he<<1),he>>=1)),ee===ie)B+=4;else{var oe=e[se+3*ee],Se=e[se+3*ee+1],te=e[se+3*ee+2];Y[B++]=te,Y[B++]=Se,Y[B++]=oe,Y[B++]=255}--ut}},this.decodeAndBlitFrameRGBA=function(I,Y){var $=this.frameInfo(I),R=$.width*$.height,Z=new Uint8Array(R);Vy(e,$.data_offset,Z,R);var se=$.palette_offset,ie=$.transparent_index;ie===null&&(ie=256);var Ae=$.width,Te=t-Ae,ut=Ae,X=4*($.y*t+$.x),ke=4*(($.y+$.height)*t+$.x),B=X,W=4*Te;$.interlaced===!0&&(W+=4*t*7);for(var he=8,ne=0,re=Z.length;ne<re;++ne){var ee=Z[ne];if(ut===0&&(ut=Ae,(B+=W)>=ke&&(W=4*Te+4*t*(he-1),B=X+(Ae+Te)*(he<<1),he>>=1)),ee===ie)B+=4;else{var oe=e[se+3*ee],Se=e[se+3*ee+1],te=e[se+3*ee+2];Y[B++]=oe,Y[B++]=Se,Y[B++]=te,Y[B++]=255}--ut}}}function Vy(e,n,t,i){for(var r=e[n++],o=1<<r,l=o+1,h=l+1,p=r+1,m=(1<<p)-1,_=0,w=0,E=0,b=e[n++],D=new Int32Array(4096),j=null;;){for(;_<16&&b!==0;)w|=e[n++]<<_,_+=8,b===1?b=e[n++]:--b;if(_<p)break;var Q=w&m;if(w>>=p,_-=p,Q!==o){if(Q===l)break;for(var F=Q<h?Q:j,V=0,pe=F;pe>o;)pe=D[pe]>>8,++V;var Ee=pe;if(E+V+(F!==Q?1:0)>i)return void Kr.log("Warning, gif stream longer than expected.");t[E++]=Ee;var Ie=E+=V;for(F!==Q&&(t[E++]=Ee),pe=F;V--;)pe=D[pe],t[--Ie]=255&pe,pe>>=8;j!==null&&h<4096&&(D[h++]=j<<8|Ee,h>=m+1&&p<12&&(++p,m=m<<1|1)),j=Q}else h=l+1,m=(1<<(p=r+1))-1,j=null}return E!==i&&Kr.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function eg(e){var n,t,i,r,o,l=Math.floor,h=new Array(64),p=new Array(64),m=new Array(64),_=new Array(64),w=new Array(65535),E=new Array(65535),b=new Array(64),D=new Array(64),j=[],Q=0,F=7,V=new Array(64),pe=new Array(64),Ee=new Array(64),Ie=new Array(256),nt=new Array(2048),We=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],O=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],H=[0,1,2,3,4,5,6,7,8,9,10,11],le=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],G=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],I=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Y=[0,1,2,3,4,5,6,7,8,9,10,11],$=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],R=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Z(X,ke){for(var B=0,W=0,he=new Array,ne=1;ne<=16;ne++){for(var re=1;re<=X[ne];re++)he[ke[W]]=[],he[ke[W]][0]=B,he[ke[W]][1]=ne,W++,B++;B*=2}return he}function se(X){for(var ke=X[0],B=X[1]-1;B>=0;)ke&1<<B&&(Q|=1<<F),B--,--F<0&&(Q==255?(ie(255),ie(0)):ie(Q),F=7,Q=0)}function ie(X){j.push(X)}function Ae(X){ie(X>>8&255),ie(255&X)}function Te(X,ke,B,W,he){for(var ne,re=he[0],ee=he[240],oe=function(Me,Ve){var ze,st,Qe,pt,wt,Ht,nn,tt,Qt,rn,it=0;for(Qt=0;Qt<8;++Qt){ze=Me[it],st=Me[it+1],Qe=Me[it+2],pt=Me[it+3],wt=Me[it+4],Ht=Me[it+5],nn=Me[it+6];var Ke=ze+(tt=Me[it+7]),qt=ze-tt,mn=st+nn,xn=st-nn,wn=Qe+Ht,ot=Qe-Ht,de=pt+wt,_e=pt-wt,$e=Ke+de,Gt=Ke-de,Dn=mn+wn,Ln=mn-wn;Me[it]=$e+Dn,Me[it+4]=$e-Dn;var bt=.707106781*(Ln+Gt);Me[it+2]=Gt+bt,Me[it+6]=Gt-bt;var _n=.382683433*(($e=_e+ot)-(Ln=xn+qt)),$n=.5411961*$e+_n,ni=1.306562965*Ln+_n,ri=.707106781*(Dn=ot+xn),Li=qt+ri,Sn=qt-ri;Me[it+5]=Sn+$n,Me[it+3]=Sn-$n,Me[it+1]=Li+ni,Me[it+7]=Li-ni,it+=8}for(it=0,Qt=0;Qt<8;++Qt){ze=Me[it],st=Me[it+8],Qe=Me[it+16],pt=Me[it+24],wt=Me[it+32],Ht=Me[it+40],nn=Me[it+48];var Un=ze+(tt=Me[it+56]),ui=ze-tt,jn=st+nn,Wt=st-nn,yn=Qe+Ht,Ci=Qe-Ht,qi=pt+wt,Si=pt-wt,Qi=Un+qi,fr=Un-qi,Hn=jn+yn,ai=jn-yn;Me[it]=Qi+Hn,Me[it+32]=Qi-Hn;var rr=.707106781*(ai+fr);Me[it+16]=fr+rr,Me[it+48]=fr-rr;var Yi=.382683433*((Qi=Si+Ci)-(ai=Wt+ui)),Pi=.5411961*Qi+Yi,kn=1.306562965*ai+Yi,xr=.707106781*(Hn=Ci+Wt),Gi=ui+xr,Wi=ui-xr;Me[it+40]=Wi+Pi,Me[it+24]=Wi-Pi,Me[it+8]=Gi+kn,Me[it+56]=Gi-kn,it++}for(Qt=0;Qt<64;++Qt)rn=Me[Qt]*Ve[Qt],b[Qt]=rn>0?rn+.5|0:rn-.5|0;return b}(X,ke),Se=0;Se<64;++Se)D[We[Se]]=oe[Se];var te=D[0]-B;B=D[0],te==0?se(W[0]):(se(W[E[ne=32767+te]]),se(w[ne]));for(var ae=63;ae>0&&D[ae]==0;)ae--;if(ae==0)return se(re),B;for(var Le,ye=1;ye<=ae;){for(var ue=ye;D[ye]==0&&ye<=ae;)++ye;var Oe=ye-ue;if(Oe>=16){Le=Oe>>4;for(var De=1;De<=Le;++De)se(ee);Oe&=15}ne=32767+D[ye],se(he[(Oe<<4)+E[ne]]),se(w[ne]),ye++}return ae!=63&&se(re),B}function ut(X){X=Math.min(Math.max(X,1),100),o!=X&&(function(ke){for(var B=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],W=0;W<64;W++){var he=l((B[W]*ke+50)/100);he=Math.min(Math.max(he,1),255),h[We[W]]=he}for(var ne=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],re=0;re<64;re++){var ee=l((ne[re]*ke+50)/100);ee=Math.min(Math.max(ee,1),255),p[We[re]]=ee}for(var oe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Se=0,te=0;te<8;te++)for(var ae=0;ae<8;ae++)m[Se]=1/(h[We[Se]]*oe[te]*oe[ae]*8),_[Se]=1/(p[We[Se]]*oe[te]*oe[ae]*8),Se++}(X<50?Math.floor(5e3/X):Math.floor(200-2*X)),o=X)}this.encode=function(X,ke){ke&&ut(ke),j=new Array,Q=0,F=7,Ae(65496),Ae(65504),Ae(16),ie(74),ie(70),ie(73),ie(70),ie(0),ie(1),ie(1),ie(0),Ae(1),Ae(1),ie(0),ie(0),function(){Ae(65499),Ae(132),ie(0);for(var st=0;st<64;st++)ie(h[st]);ie(1);for(var Qe=0;Qe<64;Qe++)ie(p[Qe])}(),function(st,Qe){Ae(65472),Ae(17),ie(8),Ae(Qe),Ae(st),ie(3),ie(1),ie(17),ie(0),ie(2),ie(17),ie(1),ie(3),ie(17),ie(1)}(X.width,X.height),function(){Ae(65476),Ae(418),ie(0);for(var st=0;st<16;st++)ie(O[st+1]);for(var Qe=0;Qe<=11;Qe++)ie(H[Qe]);ie(16);for(var pt=0;pt<16;pt++)ie(le[pt+1]);for(var wt=0;wt<=161;wt++)ie(G[wt]);ie(1);for(var Ht=0;Ht<16;Ht++)ie(I[Ht+1]);for(var nn=0;nn<=11;nn++)ie(Y[nn]);ie(17);for(var tt=0;tt<16;tt++)ie($[tt+1]);for(var Qt=0;Qt<=161;Qt++)ie(R[Qt])}(),Ae(65498),Ae(12),ie(3),ie(1),ie(0),ie(2),ie(17),ie(3),ie(17),ie(0),ie(63),ie(0);var B=0,W=0,he=0;Q=0,F=7,this.encode.displayName="_encode_";for(var ne,re,ee,oe,Se,te,ae,Le,ye,ue=X.data,Oe=X.width,De=X.height,Me=4*Oe,Ve=0;Ve<De;){for(ne=0;ne<Me;){for(Se=Me*Ve+ne,ae=-1,Le=0,ye=0;ye<64;ye++)te=Se+(Le=ye>>3)*Me+(ae=4*(7&ye)),Ve+Le>=De&&(te-=Me*(Ve+1+Le-De)),ne+ae>=Me&&(te-=ne+ae-Me+4),re=ue[te++],ee=ue[te++],oe=ue[te++],V[ye]=(nt[re]+nt[ee+256>>0]+nt[oe+512>>0]>>16)-128,pe[ye]=(nt[re+768>>0]+nt[ee+1024>>0]+nt[oe+1280>>0]>>16)-128,Ee[ye]=(nt[re+1280>>0]+nt[ee+1536>>0]+nt[oe+1792>>0]>>16)-128;B=Te(V,m,B,n,i),W=Te(pe,_,W,t,r),he=Te(Ee,_,he,t,r),ne+=32}Ve+=8}if(F>=0){var ze=[];ze[1]=F+1,ze[0]=(1<<F+1)-1,se(ze)}return Ae(65497),new Uint8Array(j)},e=e||50,function(){for(var X=String.fromCharCode,ke=0;ke<256;ke++)Ie[ke]=X(ke)}(),n=Z(O,H),t=Z(I,Y),i=Z(le,G),r=Z($,R),function(){for(var X=1,ke=2,B=1;B<=15;B++){for(var W=X;W<ke;W++)E[32767+W]=B,w[32767+W]=[],w[32767+W][1]=B,w[32767+W][0]=W;for(var he=-(ke-1);he<=-X;he++)E[32767+he]=B,w[32767+he]=[],w[32767+he][1]=B,w[32767+he][0]=ke-1+he;X<<=1,ke<<=1}}(),function(){for(var X=0;X<256;X++)nt[X]=19595*X,nt[X+256>>0]=38470*X,nt[X+512>>0]=7471*X+32768,nt[X+768>>0]=-11059*X,nt[X+1024>>0]=-21709*X,nt[X+1280>>0]=32768*X+8421375,nt[X+1536>>0]=-27439*X,nt[X+1792>>0]=-5329*X}(),ut(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Wl(e,n){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!n,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Hy(e){function n(O){if(!O)throw Error("assert :P")}function t(O,H,le){for(var G=0;4>G;G++)if(O[H+G]!=le.charCodeAt(G))return!0;return!1}function i(O,H,le,G,I){for(var Y=0;Y<I;Y++)O[H+Y]=le[G+Y]}function r(O,H,le,G){for(var I=0;I<G;I++)O[H+I]=le}function o(O){return new Int32Array(O)}function l(O,H){for(var le=[],G=0;G<O;G++)le.push(new H);return le}function h(O,H){var le=[];return function G(I,Y,$){for(var R=$[Y],Z=0;Z<R&&(I.push($.length>Y+1?[]:new H),!($.length<Y+1));Z++)G(I[Z],Y+1,$)}(le,0,O),le}var p=function(){var O=this;function H(v,S){for(var N=1<<S-1>>>0;v&N;)N>>>=1;return N?(v&N-1)+N:v}function le(v,S,N,J,me){n(!(J%N));do v[S+(J-=N)]=me;while(0<J)}function G(v,S,N,J,me){if(n(2328>=me),512>=me)var xe=o(512);else if((xe=o(me))==null)return 0;return function(Pe,Be,Re,Ze,mt,Ft){var zt,Et,Kt=Be,Vt=1<<Re,vt=o(16),Lt=o(16);for(n(mt!=0),n(Ze!=null),n(Pe!=null),n(0<Re),Et=0;Et<mt;++Et){if(15<Ze[Et])return 0;++vt[Ze[Et]]}if(vt[0]==mt)return 0;for(Lt[1]=0,zt=1;15>zt;++zt){if(vt[zt]>1<<zt)return 0;Lt[zt+1]=Lt[zt]+vt[zt]}for(Et=0;Et<mt;++Et)zt=Ze[Et],0<Ze[Et]&&(Ft[Lt[zt]++]=Et);if(Lt[15]==1)return(Ze=new I).g=0,Ze.value=Ft[0],le(Pe,Kt,1,Vt,Ze),Vt;var tn,fn=-1,sn=Vt-1,Tn=0,An=1,Kn=1,a=1<<Re;for(Et=0,zt=1,mt=2;zt<=Re;++zt,mt<<=1){if(An+=Kn<<=1,0>(Kn-=vt[zt]))return 0;for(;0<vt[zt];--vt[zt])(Ze=new I).g=zt,Ze.value=Ft[Et++],le(Pe,Kt+Tn,mt,a,Ze),Tn=H(Tn,zt)}for(zt=Re+1,mt=2;15>=zt;++zt,mt<<=1){if(An+=Kn<<=1,0>(Kn-=vt[zt]))return 0;for(;0<vt[zt];--vt[zt]){if(Ze=new I,(Tn&sn)!=fn){for(Kt+=a,tn=1<<(fn=zt)-Re;15>fn&&!(0>=(tn-=vt[fn]));)++fn,tn<<=1;Vt+=a=1<<(tn=fn-Re),Pe[Be+(fn=Tn&sn)].g=tn+Re,Pe[Be+fn].value=Kt-Be-fn}Ze.g=zt-Re,Ze.value=Ft[Et++],le(Pe,Kt+(Tn>>Re),mt,a,Ze),Tn=H(Tn,zt)}}return An!=2*Lt[15]-1?0:Vt}(v,S,N,J,me,xe)}function I(){this.value=this.g=0}function Y(){this.value=this.g=0}function $(){this.G=l(5,I),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=l(es,Y)}function R(v,S,N,J){n(v!=null),n(S!=null),n(2147483648>J),v.Ca=254,v.I=0,v.b=-8,v.Ka=0,v.oa=S,v.pa=N,v.Jd=S,v.Yc=N+J,v.Zc=4<=J?N+J-4+1:N,ne(v)}function Z(v,S){for(var N=0;0<S--;)N|=ee(v,128)<<S;return N}function se(v,S){var N=Z(v,S);return re(v)?-N:N}function ie(v,S,N,J){var me,xe=0;for(n(v!=null),n(S!=null),n(4294967288>J),v.Sb=J,v.Ra=0,v.u=0,v.h=0,4<J&&(J=4),me=0;me<J;++me)xe+=S[N+me]<<8*me;v.Ra=xe,v.bb=J,v.oa=S,v.pa=N}function Ae(v){for(;8<=v.u&&v.bb<v.Sb;)v.Ra>>>=8,v.Ra+=v.oa[v.pa+v.bb]<<Us-8>>>0,++v.bb,v.u-=8;B(v)&&(v.h=1,v.u=0)}function Te(v,S){if(n(0<=S),!v.h&&S<=io){var N=ke(v)&Mo[S];return v.u+=S,Ae(v),N}return v.h=1,v.u=0}function ut(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function X(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function ke(v){return v.Ra>>>(v.u&Us-1)>>>0}function B(v){return n(v.bb<=v.Sb),v.h||v.bb==v.Sb&&v.u>Us}function W(v,S){v.u=S,v.h=B(v)}function he(v){v.u>=Ra&&(n(v.u>=Ra),Ae(v))}function ne(v){n(v!=null&&v.oa!=null),v.pa<v.Zc?(v.I=(v.oa[v.pa++]|v.I<<8)>>>0,v.b+=8):(n(v!=null&&v.oa!=null),v.pa<v.Yc?(v.b+=8,v.I=v.oa[v.pa++]|v.I<<8):v.Ka?v.b=0:(v.I<<=8,v.b+=8,v.Ka=1))}function re(v){return Z(v,1)}function ee(v,S){var N=v.Ca;0>v.b&&ne(v);var J=v.b,me=N*S>>>8,xe=(v.I>>>J>me)+0;for(xe?(N-=me,v.I-=me+1<<J>>>0):N=me+1,J=N,me=0;256<=J;)me+=8,J>>=8;return J=7^me+_s[J],v.b-=J,v.Ca=(N<<J)-1,xe}function oe(v,S,N){v[S+0]=N>>24&255,v[S+1]=N>>16&255,v[S+2]=N>>8&255,v[S+3]=N>>0&255}function Se(v,S){return v[S+0]<<0|v[S+1]<<8}function te(v,S){return Se(v,S)|v[S+2]<<16}function ae(v,S){return Se(v,S)|Se(v,S+2)<<16}function Le(v,S){var N=1<<S;return n(v!=null),n(0<S),v.X=o(N),v.X==null?0:(v.Mb=32-S,v.Xa=S,1)}function ye(v,S){n(v!=null),n(S!=null),n(v.Xa==S.Xa),i(S.X,0,v.X,0,1<<S.Xa)}function ue(){this.X=[],this.Xa=this.Mb=0}function Oe(v,S,N,J){n(N!=null),n(J!=null);var me=N[0],xe=J[0];return me==0&&(me=(v*xe+S/2)/S),xe==0&&(xe=(S*me+v/2)/v),0>=me||0>=xe?0:(N[0]=me,J[0]=xe,1)}function De(v,S){return v+(1<<S)-1>>>S}function Me(v,S){return((4278255360&v)+(4278255360&S)>>>0&4278255360)+((16711935&v)+(16711935&S)>>>0&16711935)>>>0}function Ve(v,S){O[S]=function(N,J,me,xe,Pe,Be,Re){var Ze;for(Ze=0;Ze<Pe;++Ze){var mt=O[v](Be[Re+Ze-1],me,xe+Ze);Be[Re+Ze]=Me(N[J+Ze],mt)}}}function ze(){this.ud=this.hd=this.jd=0}function st(v,S){return((4278124286&(v^S))>>>1)+(v&S)>>>0}function Qe(v){return 0<=v&&256>v?v:0>v?0:255<v?255:void 0}function pt(v,S){return Qe(v+(v-S+.5>>1))}function wt(v,S,N){return Math.abs(S-N)-Math.abs(v-N)}function Ht(v,S,N,J,me,xe,Pe){for(J=xe[Pe-1],N=0;N<me;++N)xe[Pe+N]=J=Me(v[S+N],J)}function nn(v,S,N,J,me){var xe;for(xe=0;xe<N;++xe){var Pe=v[S+xe],Be=Pe>>8&255,Re=16711935&(Re=(Re=16711935&Pe)+((Be<<16)+Be));J[me+xe]=(4278255360&Pe)+Re>>>0}}function tt(v,S){S.jd=v>>0&255,S.hd=v>>8&255,S.ud=v>>16&255}function Qt(v,S,N,J,me,xe){var Pe;for(Pe=0;Pe<J;++Pe){var Be=S[N+Pe],Re=Be>>>8,Ze=Be,mt=255&(mt=(mt=Be>>>16)+((v.jd<<24>>24)*(Re<<24>>24)>>>5));Ze=255&(Ze=(Ze=Ze+((v.hd<<24>>24)*(Re<<24>>24)>>>5))+((v.ud<<24>>24)*(mt<<24>>24)>>>5)),me[xe+Pe]=(4278255360&Be)+(mt<<16)+Ze}}function rn(v,S,N,J,me){O[S]=function(xe,Pe,Be,Re,Ze,mt,Ft,zt,Et){for(Re=Ft;Re<zt;++Re)for(Ft=0;Ft<Et;++Ft)Ze[mt++]=me(Be[J(xe[Pe++])])},O[v]=function(xe,Pe,Be,Re,Ze,mt,Ft){var zt=8>>xe.b,Et=xe.Ea,Kt=xe.K[0],Vt=xe.w;if(8>zt)for(xe=(1<<xe.b)-1,Vt=(1<<zt)-1;Pe<Be;++Pe){var vt,Lt=0;for(vt=0;vt<Et;++vt)vt&xe||(Lt=J(Re[Ze++])),mt[Ft++]=me(Kt[Lt&Vt]),Lt>>=zt}else O["VP8LMapColor"+N](Re,Ze,Kt,Vt,mt,Ft,Pe,Be,Et)}}function it(v,S,N,J,me){for(N=S+N;S<N;){var xe=v[S++];J[me++]=xe>>16&255,J[me++]=xe>>8&255,J[me++]=xe>>0&255}}function Ke(v,S,N,J,me){for(N=S+N;S<N;){var xe=v[S++];J[me++]=xe>>16&255,J[me++]=xe>>8&255,J[me++]=xe>>0&255,J[me++]=xe>>24&255}}function qt(v,S,N,J,me){for(N=S+N;S<N;){var xe=(Pe=v[S++])>>16&240|Pe>>12&15,Pe=Pe>>0&240|Pe>>28&15;J[me++]=xe,J[me++]=Pe}}function mn(v,S,N,J,me){for(N=S+N;S<N;){var xe=(Pe=v[S++])>>16&248|Pe>>13&7,Pe=Pe>>5&224|Pe>>3&31;J[me++]=xe,J[me++]=Pe}}function xn(v,S,N,J,me){for(N=S+N;S<N;){var xe=v[S++];J[me++]=xe>>0&255,J[me++]=xe>>8&255,J[me++]=xe>>16&255}}function wn(v,S,N,J,me,xe){if(xe==0)for(N=S+N;S<N;)oe(J,((xe=v[S++])[0]>>24|xe[1]>>8&65280|xe[2]<<8&16711680|xe[3]<<24)>>>0),me+=32;else i(J,me,v,S,N)}function ot(v,S){O[S][0]=O[v+"0"],O[S][1]=O[v+"1"],O[S][2]=O[v+"2"],O[S][3]=O[v+"3"],O[S][4]=O[v+"4"],O[S][5]=O[v+"5"],O[S][6]=O[v+"6"],O[S][7]=O[v+"7"],O[S][8]=O[v+"8"],O[S][9]=O[v+"9"],O[S][10]=O[v+"10"],O[S][11]=O[v+"11"],O[S][12]=O[v+"12"],O[S][13]=O[v+"13"],O[S][14]=O[v+"0"],O[S][15]=O[v+"0"]}function de(v){return v==hs||v==fs||v==bo||v==s}function _e(){this.eb=[],this.size=this.A=this.fb=0}function $e(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Gt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new _e,this.f.kb=new $e,this.sd=null}function Dn(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ln(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function bt(v){return alert("todo:WebPSamplerProcessPlane"),v.T}function _n(v,S){var N=v.T,J=S.ba.f.RGBA,me=J.eb,xe=J.fb+v.ka*J.A,Pe=Ss[S.ba.S],Be=v.y,Re=v.O,Ze=v.f,mt=v.N,Ft=v.ea,zt=v.W,Et=S.cc,Kt=S.dc,Vt=S.Mc,vt=S.Nc,Lt=v.ka,tn=v.ka+v.T,fn=v.U,sn=fn+1>>1;for(Lt==0?Pe(Be,Re,null,null,Ze,mt,Ft,zt,Ze,mt,Ft,zt,me,xe,null,null,fn):(Pe(S.ec,S.fc,Be,Re,Et,Kt,Vt,vt,Ze,mt,Ft,zt,me,xe-J.A,me,xe,fn),++N);Lt+2<tn;Lt+=2)Et=Ze,Kt=mt,Vt=Ft,vt=zt,mt+=v.Rc,zt+=v.Rc,xe+=2*J.A,Pe(Be,(Re+=2*v.fa)-v.fa,Be,Re,Et,Kt,Vt,vt,Ze,mt,Ft,zt,me,xe-J.A,me,xe,fn);return Re+=v.fa,v.j+tn<v.o?(i(S.ec,S.fc,Be,Re,fn),i(S.cc,S.dc,Ze,mt,sn),i(S.Mc,S.Nc,Ft,zt,sn),N--):1&tn||Pe(Be,Re,null,null,Ze,mt,Ft,zt,Ze,mt,Ft,zt,me,xe+J.A,null,null,fn),N}function $n(v,S,N){var J=v.F,me=[v.J];if(J!=null){var xe=v.U,Pe=S.ba.S,Be=Pe==_o||Pe==bo;S=S.ba.f.RGBA;var Re=[0],Ze=v.ka;Re[0]=v.T,v.Kb&&(Ze==0?--Re[0]:(--Ze,me[0]-=v.width),v.j+v.ka+v.T==v.o&&(Re[0]=v.o-v.j-Ze));var mt=S.eb;Ze=S.fb+Ze*S.A,v=pr(J,me[0],v.width,xe,Re,mt,Ze+(Be?0:3),S.A),n(N==Re),v&&de(Pe)&&cs(mt,Ze,Be,xe,Re,S.A)}return 0}function ni(v){var S=v.ma,N=S.ba.S,J=11>N,me=N==oi||N==Xo||N==_o||N==Is||N==12||de(N);if(S.memory=null,S.Ib=null,S.Jb=null,S.Nd=null,!Rl(S.Oa,v,me?11:12))return 0;if(me&&de(N)&&cn(),v.da)alert("todo:use_scaling");else{if(J){if(S.Ib=bt,v.Kb){if(N=v.U+1>>1,S.memory=o(v.U+2*N),S.memory==null)return 0;S.ec=S.memory,S.fc=0,S.cc=S.ec,S.dc=S.fc+v.U,S.Mc=S.cc,S.Nc=S.dc+N,S.Ib=_n,cn()}}else alert("todo:EmitYUV");me&&(S.Jb=$n,J&&kt())}if(J&&!cu){for(v=0;256>v;++v)rc[v]=89858*(v-128)+ga>>ic,sc[v]=-22014*(v-128)+ga,ef[v]=-45773*(v-128),il[v]=113618*(v-128)+ga>>ic;for(v=Nu;v<Dc;++v)S=76283*(v-16)+ga>>ic,oc[v-Nu]=Mi(S,255),ph[v-Nu]=Mi(S+8>>4,15);cu=1}return 1}function ri(v){var S=v.ma,N=v.U,J=v.T;return n(!(1&v.ka)),0>=N||0>=J?0:(N=S.Ib(v,S),S.Jb!=null&&S.Jb(v,S,N),S.Dc+=N,1)}function Li(v){v.ma.memory=null}function Sn(v,S,N,J){return Te(v,8)!=47?0:(S[0]=Te(v,14)+1,N[0]=Te(v,14)+1,J[0]=Te(v,1),Te(v,3)!=0?0:!v.h)}function Un(v,S){if(4>v)return v+1;var N=v-2>>1;return(2+(1&v)<<N)+Te(S,N)+1}function ui(v,S){return 120<S?S-120:1<=(N=((N=ct[S-1])>>4)*v+(8-(15&N)))?N:1;var N}function jn(v,S,N){var J=ke(N),me=v[S+=255&J].g-8;return 0<me&&(W(N,N.u+8),J=ke(N),S+=v[S].value,S+=J&(1<<me)-1),W(N,N.u+v[S].g),v[S].value}function Wt(v,S,N){return N.g+=v.g,N.value+=v.value<<S>>>0,n(8>=N.g),v.g}function yn(v,S,N){var J=v.xc;return n((S=J==0?0:v.vc[v.md*(N>>J)+(S>>J)])<v.Wb),v.Ya[S]}function Ci(v,S,N,J){var me=v.ab,xe=v.c*S,Pe=v.C;S=Pe+S;var Be=N,Re=J;for(J=v.Ta,N=v.Ua;0<me--;){var Ze=v.gc[me],mt=Pe,Ft=S,zt=Be,Et=Re,Kt=(Re=J,Be=N,Ze.Ea);switch(n(mt<Ft),n(Ft<=Ze.nc),Ze.hc){case 2:uu(zt,Et,(Ft-mt)*Kt,Re,Be);break;case 0:var Vt=mt,vt=Ft,Lt=Re,tn=Be,fn=(a=Ze).Ea;Vt==0&&(Ds(zt,Et,null,null,1,Lt,tn),Ht(zt,Et+1,0,0,fn-1,Lt,tn+1),Et+=fn,tn+=fn,++Vt);for(var sn=1<<a.b,Tn=sn-1,An=De(fn,a.b),Kn=a.K,a=a.w+(Vt>>a.b)*An;Vt<vt;){var c=Kn,g=a,y=1;for(Rs(zt,Et,Lt,tn-fn,1,Lt,tn);y<fn;){var C=(y&~Tn)+sn;C>fn&&(C=fn),(0,Zo[c[g++]>>8&15])(zt,Et+ +y,Lt,tn+y-fn,C-y,Lt,tn+y),y=C}Et+=fn,tn+=fn,++Vt&Tn||(a+=An)}Ft!=Ze.nc&&i(Re,Be-Kt,Re,Be+(Ft-mt-1)*Kt,Kt);break;case 1:for(Kt=zt,vt=Et,fn=(zt=Ze.Ea)-(tn=zt&~(Lt=(Et=1<<Ze.b)-1)),Vt=De(zt,Ze.b),sn=Ze.K,Ze=Ze.w+(mt>>Ze.b)*Vt;mt<Ft;){for(Tn=sn,An=Ze,Kn=new ze,a=vt+tn,c=vt+zt;vt<a;)tt(Tn[An++],Kn),Ko(Kn,Kt,vt,Et,Re,Be),vt+=Et,Be+=Et;vt<c&&(tt(Tn[An++],Kn),Ko(Kn,Kt,vt,fn,Re,Be),vt+=fn,Be+=fn),++mt&Lt||(Ze+=Vt)}break;case 3:if(zt==Re&&Et==Be&&0<Ze.b){for(vt=Re,zt=Kt=Be+(Ft-mt)*Kt-(tn=(Ft-mt)*De(Ze.Ea,Ze.b)),Et=Re,Lt=Be,Vt=[],tn=(fn=tn)-1;0<=tn;--tn)Vt[tn]=Et[Lt+tn];for(tn=fn-1;0<=tn;--tn)vt[zt+tn]=Vt[tn];ss(Ze,mt,Ft,Re,Kt,Re,Be)}else ss(Ze,mt,Ft,zt,Et,Re,Be)}Be=J,Re=N}Re!=N&&i(J,N,Be,Re,xe)}function qi(v,S){var N=v.V,J=v.Ba+v.c*v.C,me=S-v.C;if(n(S<=v.l.o),n(16>=me),0<me){var xe=v.l,Pe=v.Ta,Be=v.Ua,Re=xe.width;if(Ci(v,me,N,J),me=Be=[Be],n((N=v.C)<(J=S)),n(xe.v<xe.va),J>xe.o&&(J=xe.o),N<xe.j){var Ze=xe.j-N;N=xe.j,me[0]+=Ze*Re}if(N>=J?N=0:(me[0]+=4*xe.v,xe.ka=N-xe.j,xe.U=xe.va-xe.v,xe.T=J-N,N=1),N){if(Be=Be[0],11>(N=v.ca).S){var mt=N.f.RGBA,Ft=(J=N.S,me=xe.U,xe=xe.T,Ze=mt.eb,mt.A),zt=xe;for(mt=mt.fb+v.Ma*mt.A;0<zt--;){var Et=Pe,Kt=Be,Vt=me,vt=Ze,Lt=mt;switch(J){case qs:xs(Et,Kt,Vt,vt,Lt);break;case oi:us(Et,Kt,Vt,vt,Lt);break;case hs:us(Et,Kt,Vt,vt,Lt),cs(vt,Lt,0,Vt,1,0);break;case Yo:Ls(Et,Kt,Vt,vt,Lt);break;case Xo:wn(Et,Kt,Vt,vt,Lt,1);break;case fs:wn(Et,Kt,Vt,vt,Lt,1),cs(vt,Lt,0,Vt,1,0);break;case _o:wn(Et,Kt,Vt,vt,Lt,0);break;case bo:wn(Et,Kt,Vt,vt,Lt,0),cs(vt,Lt,1,Vt,1,0);break;case Is:To(Et,Kt,Vt,vt,Lt);break;case s:To(Et,Kt,Vt,vt,Lt),cr(vt,Lt,Vt,1,0);break;case Tu:ro(Et,Kt,Vt,vt,Lt);break;default:n(0)}Be+=Re,mt+=Ft}v.Ma+=xe}else alert("todo:EmitRescaledRowsYUVA");n(v.Ma<=N.height)}}v.C=S,n(v.C<=v.i)}function Si(v){var S;if(0<v.ua)return 0;for(S=0;S<v.Wb;++S){var N=v.Ya[S].G,J=v.Ya[S].H;if(0<N[1][J[1]+0].g||0<N[2][J[2]+0].g||0<N[3][J[3]+0].g)return 0}return 1}function Qi(v,S,N,J,me,xe){if(v.Z!=0){var Pe=v.qd,Be=v.rd;for(n(nr[v.Z]!=null);S<N;++S)nr[v.Z](Pe,Be,J,me,J,me,xe),Pe=J,Be=me,me+=xe;v.qd=Pe,v.rd=Be}}function fr(v,S){var N=v.l.ma,J=N.Z==0||N.Z==1?v.l.j:v.C;if(J=v.C<J?J:v.C,n(S<=v.l.o),S>J){var me=v.l.width,xe=N.ca,Pe=N.tb+me*J,Be=v.V,Re=v.Ba+v.c*J,Ze=v.gc;n(v.ab==1),n(Ze[0].hc==3),bs(Ze[0],J,S,Be,Re,xe,Pe),Qi(N,J,S,xe,Pe,me)}v.C=v.Ma=S}function Hn(v,S,N,J,me,xe,Pe){var Be=v.$/J,Re=v.$%J,Ze=v.m,mt=v.s,Ft=N+v.$,zt=Ft;me=N+J*me;var Et=N+J*xe,Kt=280+mt.ua,Vt=v.Pb?Be:16777216,vt=0<mt.ua?mt.Wa:null,Lt=mt.wc,tn=Ft<Et?yn(mt,Re,Be):null;n(v.C<xe),n(Et<=me);var fn=!1;e:for(;;){for(;fn||Ft<Et;){var sn=0;if(Be>=Vt){var Tn=Ft-N;n((Vt=v).Pb),Vt.wd=Vt.m,Vt.xd=Tn,0<Vt.s.ua&&ye(Vt.s.Wa,Vt.s.vb),Vt=Be+$t}if(Re&Lt||(tn=yn(mt,Re,Be)),n(tn!=null),tn.Qb&&(S[Ft]=tn.qb,fn=!0),!fn)if(he(Ze),tn.jc){sn=Ze,Tn=S;var An=Ft,Kn=tn.pd[ke(sn)&es-1];n(tn.jc),256>Kn.g?(W(sn,sn.u+Kn.g),Tn[An]=Kn.value,sn=0):(W(sn,sn.u+Kn.g-256),n(256<=Kn.value),sn=Kn.value),sn==0&&(fn=!0)}else sn=jn(tn.G[0],tn.H[0],Ze);if(Ze.h)break;if(fn||256>sn){if(!fn)if(tn.nd)S[Ft]=(tn.qb|sn<<8)>>>0;else{if(he(Ze),fn=jn(tn.G[1],tn.H[1],Ze),he(Ze),Tn=jn(tn.G[2],tn.H[2],Ze),An=jn(tn.G[3],tn.H[3],Ze),Ze.h)break;S[Ft]=(An<<24|fn<<16|sn<<8|Tn)>>>0}if(fn=!1,++Ft,++Re>=J&&(Re=0,++Be,Pe!=null&&Be<=xe&&!(Be%16)&&Pe(v,Be),vt!=null))for(;zt<Ft;)sn=S[zt++],vt.X[(506832829*sn&4294967295)>>>vt.Mb]=sn}else if(280>sn){if(sn=Un(sn-256,Ze),Tn=jn(tn.G[4],tn.H[4],Ze),he(Ze),Tn=ui(J,Tn=Un(Tn,Ze)),Ze.h)break;if(Ft-N<Tn||me-Ft<sn)break e;for(An=0;An<sn;++An)S[Ft+An]=S[Ft+An-Tn];for(Ft+=sn,Re+=sn;Re>=J;)Re-=J,++Be,Pe!=null&&Be<=xe&&!(Be%16)&&Pe(v,Be);if(n(Ft<=me),Re&Lt&&(tn=yn(mt,Re,Be)),vt!=null)for(;zt<Ft;)sn=S[zt++],vt.X[(506832829*sn&4294967295)>>>vt.Mb]=sn}else{if(!(sn<Kt))break e;for(fn=sn-280,n(vt!=null);zt<Ft;)sn=S[zt++],vt.X[(506832829*sn&4294967295)>>>vt.Mb]=sn;sn=Ft,n(!(fn>>>(Tn=vt).Xa)),S[sn]=Tn.X[fn],fn=!0}fn||n(Ze.h==B(Ze))}if(v.Pb&&Ze.h&&Ft<me)n(v.m.h),v.a=5,v.m=v.wd,v.$=v.xd,0<v.s.ua&&ye(v.s.vb,v.s.Wa);else{if(Ze.h)break e;Pe!=null&&Pe(v,Be>xe?xe:Be),v.a=0,v.$=Ft-N}return 1}return v.a=3,0}function ai(v){n(v!=null),v.vc=null,v.yc=null,v.Ya=null;var S=v.Wa;S!=null&&(S.X=null),v.vb=null,n(v!=null)}function rr(){var v=new Ba;return v==null?null:(v.a=0,v.xb=vl,ot("Predictor","VP8LPredictors"),ot("Predictor","VP8LPredictors_C"),ot("PredictorAdd","VP8LPredictorsAdd"),ot("PredictorAdd","VP8LPredictorsAdd_C"),uu=nn,Ko=Qt,xs=it,us=Ke,To=qt,ro=mn,Ls=xn,O.VP8LMapColor32b=Wo,O.VP8LMapColor8b=ws,v)}function Yi(v,S,N,J,me){var xe=1,Pe=[v],Be=[S],Re=J.m,Ze=J.s,mt=null,Ft=0;e:for(;;){if(N)for(;xe&&Te(Re,1);){var zt=Pe,Et=Be,Kt=J,Vt=1,vt=Kt.m,Lt=Kt.gc[Kt.ab],tn=Te(vt,2);if(Kt.Oc&1<<tn)xe=0;else{switch(Kt.Oc|=1<<tn,Lt.hc=tn,Lt.Ea=zt[0],Lt.nc=Et[0],Lt.K=[null],++Kt.ab,n(4>=Kt.ab),tn){case 0:case 1:Lt.b=Te(vt,3)+2,Vt=Yi(De(Lt.Ea,Lt.b),De(Lt.nc,Lt.b),0,Kt,Lt.K),Lt.K=Lt.K[0];break;case 3:var fn,sn=Te(vt,8)+1,Tn=16<sn?0:4<sn?1:2<sn?2:3;if(zt[0]=De(Lt.Ea,Tn),Lt.b=Tn,fn=Vt=Yi(sn,1,0,Kt,Lt.K)){var An,Kn=sn,a=Lt,c=1<<(8>>a.b),g=o(c);if(g==null)fn=0;else{var y=a.K[0],C=a.w;for(g[0]=a.K[0][0],An=1;An<1*Kn;++An)g[An]=Me(y[C+An],g[An-1]);for(;An<4*c;++An)g[An]=0;a.K[0]=null,a.K[0]=g,fn=1}}Vt=fn;break;case 2:break;default:n(0)}xe=Vt}}if(Pe=Pe[0],Be=Be[0],xe&&Te(Re,1)&&!(xe=1<=(Ft=Te(Re,4))&&11>=Ft)){J.a=3;break e}var M;if(M=xe)t:{var z,q,ce,be=J,Xe=Pe,He=Be,xt=Ft,Ot=N,en=be.m,bn=be.s,Pn=[null],ti=1,Ye=0,at=Dt[xt];n:for(;;){if(Ot&&Te(en,1)){var gt=Te(en,3)+2,jt=De(Xe,gt),Pt=De(He,gt),It=jt*Pt;if(!Yi(jt,Pt,0,be,Pn))break n;for(Pn=Pn[0],bn.xc=gt,z=0;z<It;++z){var fe=Pn[z]>>8&65535;Pn[z]=fe,fe>=ti&&(ti=fe+1)}}if(en.h)break n;for(q=0;5>q;++q){var Ce=T[q];!q&&0<xt&&(Ce+=1<<xt),Ye<Ce&&(Ye=Ce)}var je=l(ti*at,I),Fe=ti,qe=l(Fe,$);if(qe==null)var Ge=null;else n(65536>=Fe),Ge=qe;var ht=o(Ye);if(Ge==null||ht==null||je==null){be.a=1;break n}var ft=je;for(z=ce=0;z<ti;++z){var yt=Ge[z],Tt=yt.G,Bt=yt.H,on=0,On=1,Fn=0;for(q=0;5>q;++q){Ce=T[q],Tt[q]=ft,Bt[q]=ce,!q&&0<xt&&(Ce+=1<<xt);r:{var Jn,ir=Ce,gr=be,Fi=ht,br=ft,Hs=ce,Fl=0,Fo=gr.m,Rc=Te(Fo,1);if(r(Fi,0,0,ir),Rc){var ma=Te(Fo,1)+1,hu=Te(Fo,1),zo=Te(Fo,hu==0?1:8);Fi[zo]=1,ma==2&&(Fi[zo=Te(Fo,8)]=1);var Ps=1}else{var Zr=o(19),_h=Te(Fo,4)+4;if(19<_h){gr.a=3;var Oc=0;break r}for(Jn=0;Jn<_h;++Jn)Zr[we[Jn]]=Te(Fo,3);var Ic=void 0,Fc=void 0,bh=gr,Ki=Zr,wh=ir,Qf=Fi,Du=0,zl=bh.m,ed=8,td=l(128,I);i:for(;G(td,0,7,Ki,19);){if(Te(zl,1)){var Oa=2+2*Te(zl,3);if((Ic=2+Te(zl,Oa))>wh)break i}else Ic=wh;for(Fc=0;Fc<wh&&Ic--;){he(zl);var nd=td[0+(127&ke(zl))];W(zl,zl.u+nd.g);var jl=nd.value;if(16>jl)Qf[Fc++]=jl,jl!=0&&(ed=jl);else{var tf=jl==16,nf=jl-16,id=x[nf],ea=Te(zl,f[nf])+id;if(Fc+ea>wh)break i;for(var fu=tf?ed:0;0<ea--;)Qf[Fc++]=fu}}Du=1;break i}Du||(bh.a=3),Ps=Du}(Ps=Ps&&!Fo.h)&&(Fl=G(br,Hs,8,Fi,ir)),Ps&&Fl!=0?Oc=Fl:(gr.a=3,Oc=0)}if(Oc==0)break n;if(On&&K[q]==1&&(On=ft[ce].g==0),on+=ft[ce].g,ce+=Oc,3>=q){var Ru,xh=ht[0];for(Ru=1;Ru<Ce;++Ru)ht[Ru]>xh&&(xh=ht[Ru]);Fn+=xh}}if(yt.nd=On,yt.Qb=0,On&&(yt.qb=(Tt[3][Bt[3]+0].value<<24|Tt[1][Bt[1]+0].value<<16|Tt[2][Bt[2]+0].value)>>>0,on==0&&256>Tt[0][Bt[0]+0].value&&(yt.Qb=1,yt.qb+=Tt[0][Bt[0]+0].value<<8)),yt.jc=!yt.Qb&&6>Fn,yt.jc){var Ou,yl=yt;for(Ou=0;Ou<es;++Ou){var _l=Ou,Ul=yl.pd[_l],ac=yl.G[0][yl.H[0]+_l];256<=ac.value?(Ul.g=ac.g+256,Ul.value=ac.value):(Ul.g=0,Ul.value=0,_l>>=Wt(ac,8,Ul),_l>>=Wt(yl.G[1][yl.H[1]+_l],16,Ul),_l>>=Wt(yl.G[2][yl.H[2]+_l],0,Ul),Wt(yl.G[3][yl.H[3]+_l],24,Ul))}}}bn.vc=Pn,bn.Wb=ti,bn.Ya=Ge,bn.yc=je,M=1;break t}M=0}if(!(xe=M)){J.a=3;break e}if(0<Ft){if(Ze.ua=1<<Ft,!Le(Ze.Wa,Ft)){J.a=1,xe=0;break e}}else Ze.ua=0;var zc=J,$l=Pe,Zp=Be,bl=zc.s,Lh=bl.xc;if(zc.c=$l,zc.i=Zp,bl.md=De($l,Lh),bl.wc=Lh==0?-1:(1<<Lh)-1,N){J.xb=Nc;break e}if((mt=o(Pe*Be))==null){J.a=1,xe=0;break e}xe=(xe=Hn(J,mt,0,Pe,Be,Be,null))&&!Re.h;break e}return xe?(me!=null?me[0]=mt:(n(mt==null),n(N)),J.$=0,N||ai(Ze)):ai(Ze),xe}function Pi(v,S){var N=v.c*v.i,J=N+S+16*S;return n(v.c<=S),v.V=o(J),v.V==null?(v.Ta=null,v.Ua=0,v.a=1,0):(v.Ta=v.V,v.Ua=v.Ba+N+S,1)}function kn(v,S){var N=v.C,J=S-N,me=v.V,xe=v.Ba+v.c*N;for(n(S<=v.l.o);0<J;){var Pe=16<J?16:J,Be=v.l.ma,Re=v.l.width,Ze=Re*Pe,mt=Be.ca,Ft=Be.tb+Re*N,zt=v.Ta,Et=v.Ua;Ci(v,Pe,me,xe),Wr(zt,Et,mt,Ft,Ze),Qi(Be,N,N+Pe,mt,Ft,Re),J-=Pe,me+=Pe*v.c,N+=Pe}n(N==S),v.C=v.Ma=S}function xr(){this.ub=this.yd=this.td=this.Rb=0}function Gi(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Wi(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function dr(){this.Yb=function(){var v=[];return function S(N,J,me){for(var xe=me[J],Pe=0;Pe<xe&&(N.push(me.length>J+1?[]:0),!(me.length<J+1));Pe++)S(N[Pe],J+1,me)}(v,0,[3,11]),v}()}function zr(){this.jb=o(3),this.Wc=h([4,8],dr),this.Xc=h([4,17],dr)}function Vi(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function fi(){this.ld=this.La=this.dd=this.tc=0}function gs(){this.Na=this.la=0}function Pr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Rr(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ai(){this.uc=this.M=this.Nb=0,this.wa=Array(new fi),this.Y=0,this.ya=Array(new Rr),this.aa=0,this.l=new di}function En(){this.y=o(16),this.f=o(8),this.ea=o(8)}function hn(){this.cb=this.a=0,this.sc="",this.m=new ut,this.Od=new xr,this.Kc=new Gi,this.ed=new Vi,this.Qa=new Wi,this.Ic=this.$c=this.Aa=0,this.D=new Ai,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=l(8,ut),this.ia=0,this.pb=l(4,Pr),this.Pa=new zr,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new En),this.Hd=0,this.rb=Array(new gs),this.sb=0,this.wa=Array(new fi),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Rr),this.L=this.aa=0,this.gd=h([4,2],fi),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function di(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function li(){var v=new hn;return v!=null&&(v.a=0,v.sc="OK",v.cb=0,v.Xb=0,Zn||(Zn=jr)),v}function Wn(v,S,N){return v.a==0&&(v.a=S,v.sc=N,v.cb=0),0}function as(v,S,N){return 3<=N&&v[S+0]==157&&v[S+1]==1&&v[S+2]==42}function Ms(v,S){if(v==null)return 0;if(v.a=0,v.sc="OK",S==null)return Wn(v,2,"null VP8Io passed to VP8GetHeaders()");var N=S.data,J=S.w,me=S.ha;if(4>me)return Wn(v,7,"Truncated header.");var xe=N[J+0]|N[J+1]<<8|N[J+2]<<16,Pe=v.Od;if(Pe.Rb=!(1&xe),Pe.td=xe>>1&7,Pe.yd=xe>>4&1,Pe.ub=xe>>5,3<Pe.td)return Wn(v,3,"Incorrect keyframe parameters.");if(!Pe.yd)return Wn(v,4,"Frame not displayable.");J+=3,me-=3;var Be=v.Kc;if(Pe.Rb){if(7>me)return Wn(v,7,"cannot parse picture header");if(!as(N,J,me))return Wn(v,3,"Bad code word");Be.c=16383&(N[J+4]<<8|N[J+3]),Be.Td=N[J+4]>>6,Be.i=16383&(N[J+6]<<8|N[J+5]),Be.Ud=N[J+6]>>6,J+=7,me-=7,v.za=Be.c+15>>4,v.Ub=Be.i+15>>4,S.width=Be.c,S.height=Be.i,S.Da=0,S.j=0,S.v=0,S.va=S.width,S.o=S.height,S.da=0,S.ib=S.width,S.hb=S.height,S.U=S.width,S.T=S.height,r((xe=v.Pa).jb,0,255,xe.jb.length),n((xe=v.Qa)!=null),xe.Cb=0,xe.Bb=0,xe.Fb=1,r(xe.Zb,0,0,xe.Zb.length),r(xe.Lb,0,0,xe.Lb)}if(Pe.ub>me)return Wn(v,7,"bad partition length");R(xe=v.m,N,J,Pe.ub),J+=Pe.ub,me-=Pe.ub,Pe.Rb&&(Be.Ld=re(xe),Be.Kd=re(xe)),Be=v.Qa;var Re,Ze=v.Pa;if(n(xe!=null),n(Be!=null),Be.Cb=re(xe),Be.Cb){if(Be.Bb=re(xe),re(xe)){for(Be.Fb=re(xe),Re=0;4>Re;++Re)Be.Zb[Re]=re(xe)?se(xe,7):0;for(Re=0;4>Re;++Re)Be.Lb[Re]=re(xe)?se(xe,6):0}if(Be.Bb)for(Re=0;3>Re;++Re)Ze.jb[Re]=re(xe)?Z(xe,8):255}else Be.Bb=0;if(xe.Ka)return Wn(v,3,"cannot parse segment header");if((Be=v.ed).zd=re(xe),Be.Tb=Z(xe,6),Be.wb=Z(xe,3),Be.Pc=re(xe),Be.Pc&&re(xe)){for(Ze=0;4>Ze;++Ze)re(xe)&&(Be.vd[Ze]=se(xe,6));for(Ze=0;4>Ze;++Ze)re(xe)&&(Be.od[Ze]=se(xe,6))}if(v.L=Be.Tb==0?0:Be.zd?1:2,xe.Ka)return Wn(v,3,"cannot parse filter header");var mt=me;if(me=Re=J,J=Re+mt,Be=mt,v.Xb=(1<<Z(v.m,2))-1,mt<3*(Ze=v.Xb))N=7;else{for(Re+=3*Ze,Be-=3*Ze,mt=0;mt<Ze;++mt){var Ft=N[me+0]|N[me+1]<<8|N[me+2]<<16;Ft>Be&&(Ft=Be),R(v.Jc[+mt],N,Re,Ft),Re+=Ft,Be-=Ft,me+=3}R(v.Jc[+Ze],N,Re,Be),N=Re<J?0:5}if(N!=0)return Wn(v,N,"cannot parse partitions");for(N=Z(Re=v.m,7),me=re(Re)?se(Re,4):0,J=re(Re)?se(Re,4):0,Be=re(Re)?se(Re,4):0,Ze=re(Re)?se(Re,4):0,Re=re(Re)?se(Re,4):0,mt=v.Qa,Ft=0;4>Ft;++Ft){if(mt.Cb){var zt=mt.Zb[Ft];mt.Fb||(zt+=N)}else{if(0<Ft){v.pb[Ft]=v.pb[0];continue}zt=N}var Et=v.pb[Ft];Et.Sc[0]=an[Mi(zt+me,127)],Et.Sc[1]=Nn[Mi(zt+0,127)],Et.Eb[0]=2*an[Mi(zt+J,127)],Et.Eb[1]=101581*Nn[Mi(zt+Be,127)]>>16,8>Et.Eb[1]&&(Et.Eb[1]=8),Et.Qc[0]=an[Mi(zt+Ze,117)],Et.Qc[1]=Nn[Mi(zt+Re,127)],Et.lc=zt+Re}if(!Pe.Rb)return Wn(v,4,"Not a key frame.");for(re(xe),Pe=v.Pa,N=0;4>N;++N){for(me=0;8>me;++me)for(J=0;3>J;++J)for(Be=0;11>Be;++Be)Ze=ee(xe,Gs[N][me][J][Be])?Z(xe,8):ds[N][me][J][Be],Pe.Wc[N][me].Yb[J][Be]=Ze;for(me=0;17>me;++me)Pe.Xc[N][me]=Pe.Wc[N][Bu[me]]}return v.kc=re(xe),v.kc&&(v.Bd=Z(xe,8)),v.cb=1}function jr(v,S,N,J,me,xe,Pe){var Be=S[me].Yb[N];for(N=0;16>me;++me){if(!ee(v,Be[N+0]))return me;for(;!ee(v,Be[N+1]);)if(Be=S[++me].Yb[0],N=0,me==16)return 16;var Re=S[me+1].Yb;if(ee(v,Be[N+2])){var Ze=v,mt=0;if(ee(Ze,(zt=Be)[(Ft=N)+3]))if(ee(Ze,zt[Ft+6])){for(Be=0,Ft=2*(mt=ee(Ze,zt[Ft+8]))+(zt=ee(Ze,zt[Ft+9+mt])),mt=0,zt=Ei[Ft];zt[Be];++Be)mt+=mt+ee(Ze,zt[Be]);mt+=3+(8<<Ft)}else ee(Ze,zt[Ft+7])?(mt=7+2*ee(Ze,165),mt+=ee(Ze,145)):mt=5+ee(Ze,159);else mt=ee(Ze,zt[Ft+4])?3+ee(Ze,zt[Ft+5]):2;Be=Re[2]}else mt=1,Be=Re[1];Re=Pe+ns[me],0>(Ze=v).b&&ne(Ze);var Ft,zt=Ze.b,Et=(Ft=Ze.Ca>>1)-(Ze.I>>zt)>>31;--Ze.b,Ze.Ca+=Et,Ze.Ca|=1,Ze.I-=(Ft+1&Et)<<zt,xe[Re]=((mt^Et)-Et)*J[(0<me)+0]}return 16}function ao(v){var S=v.rb[v.sb-1];S.la=0,S.Na=0,r(v.zc,0,0,v.zc.length),v.ja=0}function dn(v,S){if(v==null)return 0;if(S==null)return Wn(v,2,"NULL VP8Io parameter in VP8Decode().");if(!v.cb&&!Ms(v,S))return 0;if(n(v.cb),S.ac==null||S.ac(S)){S.ob&&(v.L=0);var N=Qo[v.L];if(v.L==2?(v.yb=0,v.zb=0):(v.yb=S.v-N>>4,v.zb=S.j-N>>4,0>v.yb&&(v.yb=0),0>v.zb&&(v.zb=0)),v.Va=S.o+15+N>>4,v.Hb=S.va+15+N>>4,v.Hb>v.za&&(v.Hb=v.za),v.Va>v.Ub&&(v.Va=v.Ub),0<v.L){var J=v.ed;for(N=0;4>N;++N){var me;if(v.Qa.Cb){var xe=v.Qa.Lb[N];v.Qa.Fb||(xe+=J.Tb)}else xe=J.Tb;for(me=0;1>=me;++me){var Pe=v.gd[N][me],Be=xe;if(J.Pc&&(Be+=J.vd[0],me&&(Be+=J.od[0])),0<(Be=0>Be?0:63<Be?63:Be)){var Re=Be;0<J.wb&&(Re=4<J.wb?Re>>2:Re>>1)>9-J.wb&&(Re=9-J.wb),1>Re&&(Re=1),Pe.dd=Re,Pe.tc=2*Be+Re,Pe.ld=40<=Be?2:15<=Be?1:0}else Pe.tc=0;Pe.La=me}}}N=0}else Wn(v,6,"Frame setup failed"),N=v.a;if(N=N==0){if(N){v.$c=0,0<v.Aa||(v.Ic=vh);e:{N=v.Ic,J=4*(Re=v.za);var Ze=32*Re,mt=Re+1,Ft=0<v.L?Re*(0<v.Aa?2:1):0,zt=(v.Aa==2?2:1)*Re;if((Pe=J+832+(me=3*(16*N+Qo[v.L])/2*Ze)+(xe=v.Fa!=null&&0<v.Fa.length?v.Kc.c*v.Kc.i:0))!=Pe)N=0;else{if(Pe>v.Vb){if(v.Vb=0,v.Ec=o(Pe),v.Fc=0,v.Ec==null){N=Wn(v,1,"no memory during frame initialization.");break e}v.Vb=Pe}Pe=v.Ec,Be=v.Fc,v.Ac=Pe,v.Bc=Be,Be+=J,v.Gd=l(Ze,En),v.Hd=0,v.rb=l(mt+1,gs),v.sb=1,v.wa=Ft?l(Ft,fi):null,v.Y=0,v.D.Nb=0,v.D.wa=v.wa,v.D.Y=v.Y,0<v.Aa&&(v.D.Y+=Re),n(!0),v.oc=Pe,v.pc=Be,Be+=832,v.ya=l(zt,Rr),v.aa=0,v.D.ya=v.ya,v.D.aa=v.aa,v.Aa==2&&(v.D.aa+=Re),v.R=16*Re,v.B=8*Re,Re=(Ze=Qo[v.L])*v.R,Ze=Ze/2*v.B,v.sa=Pe,v.ta=Be+Re,v.qa=v.sa,v.ra=v.ta+16*N*v.R+Ze,v.Ha=v.qa,v.Ia=v.ra+8*N*v.B+Ze,v.$c=0,Be+=me,v.mb=xe?Pe:null,v.nb=xe?Be:null,n(Be+xe<=v.Fc+v.Vb),ao(v),r(v.Ac,v.Bc,0,J),N=1}}if(N){if(S.ka=0,S.y=v.sa,S.O=v.ta,S.f=v.qa,S.N=v.ra,S.ea=v.Ha,S.Vd=v.Ia,S.fa=v.R,S.Rc=v.B,S.F=null,S.J=0,!Ol){for(N=-255;255>=N;++N)_r[255+N]=0>N?-N:N;for(N=-1020;1020>=N;++N)so[1020+N]=-128>N?-128:127<N?127:N;for(N=-112;112>=N;++N)$s[112+N]=-16>N?-16:15<N?15:N;for(N=-255;510>=N;++N)co[255+N]=0>N?0:255<N?255:N;Ol=1}Ct=lo,Zt=Po,Mn=Eo,qn=Cr,gi=Ts,Rt=Ea,kr=gl,ur=Ao,nl=uo,Os=el,Mr=Xa,Bo=Qa,Jo=or,No=lu,Do=qr,Ro=Qn,Ii=Gr,yo=Ta,wo[0]=Zi,wo[1]=sr,wo[2]=yi,wo[3]=po,wo[4]=Nl,wo[5]=ka,wo[6]=Aa,wo[7]=go,wo[8]=Dl,wo[9]=ha,Io[0]=Za,Io[1]=vs,Io[2]=fo,Io[3]=Go,Io[4]=rs,Io[5]=ou,Io[6]=fl,ho[0]=fa,ho[1]=ms,ho[2]=Ka,ho[3]=mi,ho[4]=Ja,ho[5]=au,ho[6]=dl,N=1}else N=0}N&&(N=function(Et,Kt){for(Et.M=0;Et.M<Et.Va;++Et.M){var Vt,vt=Et.Jc[Et.M&Et.Xb],Lt=Et.m,tn=Et;for(Vt=0;Vt<tn.za;++Vt){var fn=Lt,sn=tn,Tn=sn.Ac,An=sn.Bc+4*Vt,Kn=sn.zc,a=sn.ya[sn.aa+Vt];if(sn.Qa.Bb?a.$b=ee(fn,sn.Pa.jb[0])?2+ee(fn,sn.Pa.jb[2]):ee(fn,sn.Pa.jb[1]):a.$b=0,sn.kc&&(a.Ad=ee(fn,sn.Bd)),a.Za=!ee(fn,145)+0,a.Za){var c=a.Ob,g=0;for(sn=0;4>sn;++sn){var y,C=Kn[0+sn];for(y=0;4>y;++y){C=Tr[Tn[An+y]][C];for(var M=Or[ee(fn,C[0])];0<M;)M=Or[2*M+ee(fn,C[M])];C=-M,Tn[An+y]=C}i(c,g,Tn,An,4),g+=4,Kn[0+sn]=C}}else C=ee(fn,156)?ee(fn,128)?1:3:ee(fn,163)?2:0,a.Ob[0]=C,r(Tn,An,C,4),r(Kn,0,C,4);a.Dd=ee(fn,142)?ee(fn,114)?ee(fn,183)?1:3:2:0}if(tn.m.Ka)return Wn(Et,7,"Premature end-of-partition0 encountered.");for(;Et.ja<Et.za;++Et.ja){if(tn=vt,fn=(Lt=Et).rb[Lt.sb-1],Tn=Lt.rb[Lt.sb+Lt.ja],Vt=Lt.ya[Lt.aa+Lt.ja],An=Lt.kc?Vt.Ad:0)fn.la=Tn.la=0,Vt.Za||(fn.Na=Tn.Na=0),Vt.Hc=0,Vt.Gc=0,Vt.ia=0;else{var z,q;if(fn=Tn,Tn=tn,An=Lt.Pa.Xc,Kn=Lt.ya[Lt.aa+Lt.ja],a=Lt.pb[Kn.$b],sn=Kn.ad,c=0,g=Lt.rb[Lt.sb-1],C=y=0,r(sn,c,0,384),Kn.Za)var ce=0,be=An[3];else{M=o(16);var Xe=fn.Na+g.Na;if(Xe=Zn(Tn,An[1],Xe,a.Eb,0,M,0),fn.Na=g.Na=(0<Xe)+0,1<Xe)Ct(M,0,sn,c);else{var He=M[0]+3>>3;for(M=0;256>M;M+=16)sn[c+M]=He}ce=1,be=An[0]}var xt=15&fn.la,Ot=15&g.la;for(M=0;4>M;++M){var en=1&Ot;for(He=q=0;4>He;++He)xt=xt>>1|(en=(Xe=Zn(Tn,be,Xe=en+(1&xt),a.Sc,ce,sn,c))>ce)<<7,q=q<<2|(3<Xe?3:1<Xe?2:sn[c+0]!=0),c+=16;xt>>=4,Ot=Ot>>1|en<<7,y=(y<<8|q)>>>0}for(be=xt,ce=Ot>>4,z=0;4>z;z+=2){for(q=0,xt=fn.la>>4+z,Ot=g.la>>4+z,M=0;2>M;++M){for(en=1&Ot,He=0;2>He;++He)Xe=en+(1&xt),xt=xt>>1|(en=0<(Xe=Zn(Tn,An[2],Xe,a.Qc,0,sn,c)))<<3,q=q<<2|(3<Xe?3:1<Xe?2:sn[c+0]!=0),c+=16;xt>>=2,Ot=Ot>>1|en<<5}C|=q<<4*z,be|=xt<<4<<z,ce|=(240&Ot)<<z}fn.la=be,g.la=ce,Kn.Hc=y,Kn.Gc=C,Kn.ia=43690&C?0:a.ia,An=!(y|C)}if(0<Lt.L&&(Lt.wa[Lt.Y+Lt.ja]=Lt.gd[Vt.$b][Vt.Za],Lt.wa[Lt.Y+Lt.ja].La|=!An),tn.Ka)return Wn(Et,7,"Premature end-of-file encountered.")}if(ao(Et),Lt=Kt,tn=1,Vt=(vt=Et).D,fn=0<vt.L&&vt.M>=vt.zb&&vt.M<=vt.Va,vt.Aa==0)e:{if(Vt.M=vt.M,Vt.uc=fn,ml(vt,Vt),tn=1,Vt=(q=vt.D).Nb,fn=(C=Qo[vt.L])*vt.R,Tn=C/2*vt.B,M=16*Vt*vt.R,He=8*Vt*vt.B,An=vt.sa,Kn=vt.ta-fn+M,a=vt.qa,sn=vt.ra-Tn+He,c=vt.Ha,g=vt.Ia-Tn+He,Ot=(xt=q.M)==0,y=xt>=vt.Va-1,vt.Aa==2&&ml(vt,q),q.uc)for(en=(Xe=vt).D.M,n(Xe.D.uc),q=Xe.yb;q<Xe.Hb;++q){ce=q,be=en;var bn=(Pn=(Ce=Xe).D).Nb;z=Ce.R;var Pn=Pn.wa[Pn.Y+ce],ti=Ce.sa,Ye=Ce.ta+16*bn*z+16*ce,at=Pn.dd,gt=Pn.tc;if(gt!=0)if(n(3<=gt),Ce.L==1)0<ce&&Ro(ti,Ye,z,gt+4),Pn.La&&yo(ti,Ye,z,gt),0<be&&Do(ti,Ye,z,gt+4),Pn.La&&Ii(ti,Ye,z,gt);else{var jt=Ce.B,Pt=Ce.qa,It=Ce.ra+8*bn*jt+8*ce,fe=Ce.Ha,Ce=Ce.Ia+8*bn*jt+8*ce;bn=Pn.ld,0<ce&&(ur(ti,Ye,z,gt+4,at,bn),Os(Pt,It,fe,Ce,jt,gt+4,at,bn)),Pn.La&&(Bo(ti,Ye,z,gt,at,bn),No(Pt,It,fe,Ce,jt,gt,at,bn)),0<be&&(kr(ti,Ye,z,gt+4,at,bn),nl(Pt,It,fe,Ce,jt,gt+4,at,bn)),Pn.La&&(Mr(ti,Ye,z,gt,at,bn),Jo(Pt,It,fe,Ce,jt,gt,at,bn))}}if(vt.ia&&alert("todo:DitherRow"),Lt.put!=null){if(q=16*xt,xt=16*(xt+1),Ot?(Lt.y=vt.sa,Lt.O=vt.ta+M,Lt.f=vt.qa,Lt.N=vt.ra+He,Lt.ea=vt.Ha,Lt.W=vt.Ia+He):(q-=C,Lt.y=An,Lt.O=Kn,Lt.f=a,Lt.N=sn,Lt.ea=c,Lt.W=g),y||(xt-=C),xt>Lt.o&&(xt=Lt.o),Lt.F=null,Lt.J=null,vt.Fa!=null&&0<vt.Fa.length&&q<xt&&(Lt.J=Vr(vt,Lt,q,xt-q),Lt.F=vt.mb,Lt.F==null&&Lt.F.length==0)){tn=Wn(vt,3,"Could not decode alpha data.");break e}q<Lt.j&&(C=Lt.j-q,q=Lt.j,n(!(1&C)),Lt.O+=vt.R*C,Lt.N+=vt.B*(C>>1),Lt.W+=vt.B*(C>>1),Lt.F!=null&&(Lt.J+=Lt.width*C)),q<xt&&(Lt.O+=Lt.v,Lt.N+=Lt.v>>1,Lt.W+=Lt.v>>1,Lt.F!=null&&(Lt.J+=Lt.v),Lt.ka=q-Lt.j,Lt.U=Lt.va-Lt.v,Lt.T=xt-q,tn=Lt.put(Lt))}Vt+1!=vt.Ic||y||(i(vt.sa,vt.ta-fn,An,Kn+16*vt.R,fn),i(vt.qa,vt.ra-Tn,a,sn+8*vt.B,Tn),i(vt.Ha,vt.Ia-Tn,c,g+8*vt.B,Tn))}if(!tn)return Wn(Et,6,"Output aborted.")}return 1}(v,S)),S.bc!=null&&S.bc(S),N&=1}return N?(v.cb=0,N):0}function si(v,S,N,J,me){me=v[S+N+32*J]+(me>>3),v[S+N+32*J]=-256&me?0>me?0:255:me}function Er(v,S,N,J,me,xe){si(v,S,0,N,J+me),si(v,S,1,N,J+xe),si(v,S,2,N,J-xe),si(v,S,3,N,J-me)}function vr(v){return(20091*v>>16)+v}function Lr(v,S,N,J){var me,xe=0,Pe=o(16);for(me=0;4>me;++me){var Be=v[S+0]+v[S+8],Re=v[S+0]-v[S+8],Ze=(35468*v[S+4]>>16)-vr(v[S+12]),mt=vr(v[S+4])+(35468*v[S+12]>>16);Pe[xe+0]=Be+mt,Pe[xe+1]=Re+Ze,Pe[xe+2]=Re-Ze,Pe[xe+3]=Be-mt,xe+=4,S++}for(me=xe=0;4>me;++me)Be=(v=Pe[xe+0]+4)+Pe[xe+8],Re=v-Pe[xe+8],Ze=(35468*Pe[xe+4]>>16)-vr(Pe[xe+12]),si(N,J,0,0,Be+(mt=vr(Pe[xe+4])+(35468*Pe[xe+12]>>16))),si(N,J,1,0,Re+Ze),si(N,J,2,0,Re-Ze),si(N,J,3,0,Be-mt),xe++,J+=32}function Ea(v,S,N,J){var me=v[S+0]+4,xe=35468*v[S+4]>>16,Pe=vr(v[S+4]),Be=35468*v[S+1]>>16;Er(N,J,0,me+Pe,v=vr(v[S+1]),Be),Er(N,J,1,me+xe,v,Be),Er(N,J,2,me-xe,v,Be),Er(N,J,3,me-Pe,v,Be)}function Po(v,S,N,J,me){Lr(v,S,N,J),me&&Lr(v,S+16,N,J+4)}function Eo(v,S,N,J){Zt(v,S+0,N,J,1),Zt(v,S+32,N,J+128,1)}function Cr(v,S,N,J){var me;for(v=v[S+0]+4,me=0;4>me;++me)for(S=0;4>S;++S)si(N,J,S,me,v)}function Ts(v,S,N,J){v[S+0]&&qn(v,S+0,N,J),v[S+16]&&qn(v,S+16,N,J+4),v[S+32]&&qn(v,S+32,N,J+128),v[S+48]&&qn(v,S+48,N,J+128+4)}function lo(v,S,N,J){var me,xe=o(16);for(me=0;4>me;++me){var Pe=v[S+0+me]+v[S+12+me],Be=v[S+4+me]+v[S+8+me],Re=v[S+4+me]-v[S+8+me],Ze=v[S+0+me]-v[S+12+me];xe[0+me]=Pe+Be,xe[8+me]=Pe-Be,xe[4+me]=Ze+Re,xe[12+me]=Ze-Re}for(me=0;4>me;++me)Pe=(v=xe[0+4*me]+3)+xe[3+4*me],Be=xe[1+4*me]+xe[2+4*me],Re=xe[1+4*me]-xe[2+4*me],Ze=v-xe[3+4*me],N[J+0]=Pe+Be>>3,N[J+16]=Ze+Re>>3,N[J+32]=Pe-Be>>3,N[J+48]=Ze-Re>>3,J+=64}function Bs(v,S,N){var J,me=S-32,xe=yr,Pe=255-v[me-1];for(J=0;J<N;++J){var Be,Re=xe,Ze=Pe+v[S-1];for(Be=0;Be<N;++Be)v[S+Be]=Re[Ze+v[me+Be]];S+=32}}function sr(v,S){Bs(v,S,4)}function ms(v,S){Bs(v,S,8)}function vs(v,S){Bs(v,S,16)}function fo(v,S){var N;for(N=0;16>N;++N)i(v,S+32*N,v,S-32,16)}function Go(v,S){var N;for(N=16;0<N;--N)r(v,S,v[S-1],16),S+=32}function ca(v,S,N){var J;for(J=0;16>J;++J)r(S,N+32*J,v,16)}function Za(v,S){var N,J=16;for(N=0;16>N;++N)J+=v[S-1+32*N]+v[S+N-32];ca(J>>5,v,S)}function rs(v,S){var N,J=8;for(N=0;16>N;++N)J+=v[S-1+32*N];ca(J>>4,v,S)}function ou(v,S){var N,J=8;for(N=0;16>N;++N)J+=v[S+N-32];ca(J>>4,v,S)}function fl(v,S){ca(128,v,S)}function pi(v,S,N){return v+2*S+N+2>>2}function yi(v,S){var N,J=S-32;for(J=new Uint8Array([pi(v[J-1],v[J+0],v[J+1]),pi(v[J+0],v[J+1],v[J+2]),pi(v[J+1],v[J+2],v[J+3]),pi(v[J+2],v[J+3],v[J+4])]),N=0;4>N;++N)i(v,S+32*N,J,0,J.length)}function po(v,S){var N=v[S-1],J=v[S-1+32],me=v[S-1+64],xe=v[S-1+96];oe(v,S+0,16843009*pi(v[S-1-32],N,J)),oe(v,S+32,16843009*pi(N,J,me)),oe(v,S+64,16843009*pi(J,me,xe)),oe(v,S+96,16843009*pi(me,xe,xe))}function Zi(v,S){var N,J=4;for(N=0;4>N;++N)J+=v[S+N-32]+v[S-1+32*N];for(J>>=3,N=0;4>N;++N)r(v,S+32*N,J,4)}function Nl(v,S){var N=v[S-1+0],J=v[S-1+32],me=v[S-1+64],xe=v[S-1-32],Pe=v[S+0-32],Be=v[S+1-32],Re=v[S+2-32],Ze=v[S+3-32];v[S+0+96]=pi(J,me,v[S-1+96]),v[S+1+96]=v[S+0+64]=pi(N,J,me),v[S+2+96]=v[S+1+64]=v[S+0+32]=pi(xe,N,J),v[S+3+96]=v[S+2+64]=v[S+1+32]=v[S+0+0]=pi(Pe,xe,N),v[S+3+64]=v[S+2+32]=v[S+1+0]=pi(Be,Pe,xe),v[S+3+32]=v[S+2+0]=pi(Re,Be,Pe),v[S+3+0]=pi(Ze,Re,Be)}function Aa(v,S){var N=v[S+1-32],J=v[S+2-32],me=v[S+3-32],xe=v[S+4-32],Pe=v[S+5-32],Be=v[S+6-32],Re=v[S+7-32];v[S+0+0]=pi(v[S+0-32],N,J),v[S+1+0]=v[S+0+32]=pi(N,J,me),v[S+2+0]=v[S+1+32]=v[S+0+64]=pi(J,me,xe),v[S+3+0]=v[S+2+32]=v[S+1+64]=v[S+0+96]=pi(me,xe,Pe),v[S+3+32]=v[S+2+64]=v[S+1+96]=pi(xe,Pe,Be),v[S+3+64]=v[S+2+96]=pi(Pe,Be,Re),v[S+3+96]=pi(Be,Re,Re)}function ka(v,S){var N=v[S-1+0],J=v[S-1+32],me=v[S-1+64],xe=v[S-1-32],Pe=v[S+0-32],Be=v[S+1-32],Re=v[S+2-32],Ze=v[S+3-32];v[S+0+0]=v[S+1+64]=xe+Pe+1>>1,v[S+1+0]=v[S+2+64]=Pe+Be+1>>1,v[S+2+0]=v[S+3+64]=Be+Re+1>>1,v[S+3+0]=Re+Ze+1>>1,v[S+0+96]=pi(me,J,N),v[S+0+64]=pi(J,N,xe),v[S+0+32]=v[S+1+96]=pi(N,xe,Pe),v[S+1+32]=v[S+2+96]=pi(xe,Pe,Be),v[S+2+32]=v[S+3+96]=pi(Pe,Be,Re),v[S+3+32]=pi(Be,Re,Ze)}function go(v,S){var N=v[S+0-32],J=v[S+1-32],me=v[S+2-32],xe=v[S+3-32],Pe=v[S+4-32],Be=v[S+5-32],Re=v[S+6-32],Ze=v[S+7-32];v[S+0+0]=N+J+1>>1,v[S+1+0]=v[S+0+64]=J+me+1>>1,v[S+2+0]=v[S+1+64]=me+xe+1>>1,v[S+3+0]=v[S+2+64]=xe+Pe+1>>1,v[S+0+32]=pi(N,J,me),v[S+1+32]=v[S+0+96]=pi(J,me,xe),v[S+2+32]=v[S+1+96]=pi(me,xe,Pe),v[S+3+32]=v[S+2+96]=pi(xe,Pe,Be),v[S+3+64]=pi(Pe,Be,Re),v[S+3+96]=pi(Be,Re,Ze)}function ha(v,S){var N=v[S-1+0],J=v[S-1+32],me=v[S-1+64],xe=v[S-1+96];v[S+0+0]=N+J+1>>1,v[S+2+0]=v[S+0+32]=J+me+1>>1,v[S+2+32]=v[S+0+64]=me+xe+1>>1,v[S+1+0]=pi(N,J,me),v[S+3+0]=v[S+1+32]=pi(J,me,xe),v[S+3+32]=v[S+1+64]=pi(me,xe,xe),v[S+3+64]=v[S+2+64]=v[S+0+96]=v[S+1+96]=v[S+2+96]=v[S+3+96]=xe}function Dl(v,S){var N=v[S-1+0],J=v[S-1+32],me=v[S-1+64],xe=v[S-1+96],Pe=v[S-1-32],Be=v[S+0-32],Re=v[S+1-32],Ze=v[S+2-32];v[S+0+0]=v[S+2+32]=N+Pe+1>>1,v[S+0+32]=v[S+2+64]=J+N+1>>1,v[S+0+64]=v[S+2+96]=me+J+1>>1,v[S+0+96]=xe+me+1>>1,v[S+3+0]=pi(Be,Re,Ze),v[S+2+0]=pi(Pe,Be,Re),v[S+1+0]=v[S+3+32]=pi(N,Pe,Be),v[S+1+32]=v[S+3+64]=pi(J,N,Pe),v[S+1+64]=v[S+3+96]=pi(me,J,N),v[S+1+96]=pi(xe,me,J)}function Ka(v,S){var N;for(N=0;8>N;++N)i(v,S+32*N,v,S-32,8)}function mi(v,S){var N;for(N=0;8>N;++N)r(v,S,v[S-1],8),S+=32}function Bi(v,S,N){var J;for(J=0;8>J;++J)r(S,N+32*J,v,8)}function fa(v,S){var N,J=8;for(N=0;8>N;++N)J+=v[S+N-32]+v[S-1+32*N];Bi(J>>4,v,S)}function au(v,S){var N,J=4;for(N=0;8>N;++N)J+=v[S+N-32];Bi(J>>3,v,S)}function Ja(v,S){var N,J=4;for(N=0;8>N;++N)J+=v[S-1+32*N];Bi(J>>3,v,S)}function dl(v,S){Bi(128,v,S)}function Ma(v,S,N){var J=v[S-N],me=v[S+0],xe=3*(me-J)+Oo[1020+v[S-2*N]-v[S+N]],Pe=ts[112+(xe+4>>3)];v[S-N]=yr[255+J+ts[112+(xe+3>>3)]],v[S+0]=yr[255+me-Pe]}function Ya(v,S,N,J){var me=v[S+0],xe=v[S+N];return Cs[255+v[S-2*N]-v[S-N]]>J||Cs[255+xe-me]>J}function pl(v,S,N,J){return 4*Cs[255+v[S-N]-v[S+0]]+Cs[255+v[S-2*N]-v[S+N]]<=J}function Oi(v,S,N,J,me){var xe=v[S-3*N],Pe=v[S-2*N],Be=v[S-N],Re=v[S+0],Ze=v[S+N],mt=v[S+2*N],Ft=v[S+3*N];return 4*Cs[255+Be-Re]+Cs[255+Pe-Ze]>J?0:Cs[255+v[S-4*N]-xe]<=me&&Cs[255+xe-Pe]<=me&&Cs[255+Pe-Be]<=me&&Cs[255+Ft-mt]<=me&&Cs[255+mt-Ze]<=me&&Cs[255+Ze-Re]<=me}function qr(v,S,N,J){var me=2*J+1;for(J=0;16>J;++J)pl(v,S+J,N,me)&&Ma(v,S+J,N)}function Qn(v,S,N,J){var me=2*J+1;for(J=0;16>J;++J)pl(v,S+J*N,1,me)&&Ma(v,S+J*N,1)}function Gr(v,S,N,J){var me;for(me=3;0<me;--me)qr(v,S+=4*N,N,J)}function Ta(v,S,N,J){var me;for(me=3;0<me;--me)Qn(v,S+=4,N,J)}function Vo(v,S,N,J,me,xe,Pe,Be){for(xe=2*xe+1;0<me--;){if(Oi(v,S,N,xe,Pe))if(Ya(v,S,N,Be))Ma(v,S,N);else{var Re=v,Ze=S,mt=N,Ft=Re[Ze-2*mt],zt=Re[Ze-mt],Et=Re[Ze+0],Kt=Re[Ze+mt],Vt=Re[Ze+2*mt],vt=27*(tn=Oo[1020+3*(Et-zt)+Oo[1020+Ft-Kt]])+63>>7,Lt=18*tn+63>>7,tn=9*tn+63>>7;Re[Ze-3*mt]=yr[255+Re[Ze-3*mt]+tn],Re[Ze-2*mt]=yr[255+Ft+Lt],Re[Ze-mt]=yr[255+zt+vt],Re[Ze+0]=yr[255+Et-vt],Re[Ze+mt]=yr[255+Kt-Lt],Re[Ze+2*mt]=yr[255+Vt-tn]}S+=J}}function Ar(v,S,N,J,me,xe,Pe,Be){for(xe=2*xe+1;0<me--;){if(Oi(v,S,N,xe,Pe))if(Ya(v,S,N,Be))Ma(v,S,N);else{var Re=v,Ze=S,mt=N,Ft=Re[Ze-mt],zt=Re[Ze+0],Et=Re[Ze+mt],Kt=ts[112+((Vt=3*(zt-Ft))+4>>3)],Vt=ts[112+(Vt+3>>3)],vt=Kt+1>>1;Re[Ze-2*mt]=yr[255+Re[Ze-2*mt]+vt],Re[Ze-mt]=yr[255+Ft+Vt],Re[Ze+0]=yr[255+zt-Kt],Re[Ze+mt]=yr[255+Et-vt]}S+=J}}function gl(v,S,N,J,me,xe){Vo(v,S,N,1,16,J,me,xe)}function Ao(v,S,N,J,me,xe){Vo(v,S,1,N,16,J,me,xe)}function Xa(v,S,N,J,me,xe){var Pe;for(Pe=3;0<Pe;--Pe)Ar(v,S+=4*N,N,1,16,J,me,xe)}function Qa(v,S,N,J,me,xe){var Pe;for(Pe=3;0<Pe;--Pe)Ar(v,S+=4,1,N,16,J,me,xe)}function uo(v,S,N,J,me,xe,Pe,Be){Vo(v,S,me,1,8,xe,Pe,Be),Vo(N,J,me,1,8,xe,Pe,Be)}function el(v,S,N,J,me,xe,Pe,Be){Vo(v,S,1,me,8,xe,Pe,Be),Vo(N,J,1,me,8,xe,Pe,Be)}function or(v,S,N,J,me,xe,Pe,Be){Ar(v,S+4*me,me,1,8,xe,Pe,Be),Ar(N,J+4*me,me,1,8,xe,Pe,Be)}function lu(v,S,N,J,me,xe,Pe,Be){Ar(v,S+4,1,me,8,xe,Pe,Be),Ar(N,J+4,1,me,8,xe,Pe,Be)}function ls(){this.ba=new Gt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ln,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function mo(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function tl(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function vo(){this.ua=0,this.Wa=new ue,this.vb=new ue,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new $,this.yc=new I}function Ba(){this.xb=this.a=0,this.l=new di,this.ca=new Gt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new X,this.Pb=0,this.wd=new X,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new vo,this.ab=0,this.gc=l(4,tl),this.Oc=0}function Na(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new di,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ar(v,S,N,J,me,xe,Pe){for(v=v==null?0:v[S+0],S=0;S<Pe;++S)me[xe+S]=v+N[J+S]&255,v=me[xe+S]}function to(v,S,N,J,me,xe,Pe){var Be;if(v==null)ar(null,null,N,J,me,xe,Pe);else for(Be=0;Be<Pe;++Be)me[xe+Be]=v[S+Be]+N[J+Be]&255}function Ho(v,S,N,J,me,xe,Pe){if(v==null)ar(null,null,N,J,me,xe,Pe);else{var Be,Re=v[S+0],Ze=Re,mt=Re;for(Be=0;Be<Pe;++Be)Ze=mt+(Re=v[S+Be])-Ze,mt=N[J+Be]+(-256&Ze?0>Ze?0:255:Ze)&255,Ze=Re,me[xe+Be]=mt}}function Vr(v,S,N,J){var me=S.width,xe=S.o;if(n(v!=null&&S!=null),0>N||0>=J||N+J>xe)return null;if(!v.Cc){if(v.ga==null){var Pe;if(v.ga=new Na,(Pe=v.ga==null)||(Pe=S.width*S.o,n(v.Gb.length==0),v.Gb=o(Pe),v.Uc=0,v.Gb==null?Pe=0:(v.mb=v.Gb,v.nb=v.Uc,v.rc=null,Pe=1),Pe=!Pe),!Pe){Pe=v.ga;var Be=v.Fa,Re=v.P,Ze=v.qc,mt=v.mb,Ft=v.nb,zt=Re+1,Et=Ze-1,Kt=Pe.l;if(n(Be!=null&&mt!=null&&S!=null),nr[0]=null,nr[1]=ar,nr[2]=to,nr[3]=Ho,Pe.ca=mt,Pe.tb=Ft,Pe.c=S.width,Pe.i=S.height,n(0<Pe.c&&0<Pe.i),1>=Ze)S=0;else if(Pe.$a=Be[Re+0]>>0&3,Pe.Z=Be[Re+0]>>2&3,Pe.Lc=Be[Re+0]>>4&3,Re=Be[Re+0]>>6&3,0>Pe.$a||1<Pe.$a||4<=Pe.Z||1<Pe.Lc||Re)S=0;else if(Kt.put=ri,Kt.ac=ni,Kt.bc=Li,Kt.ma=Pe,Kt.width=S.width,Kt.height=S.height,Kt.Da=S.Da,Kt.v=S.v,Kt.va=S.va,Kt.j=S.j,Kt.o=S.o,Pe.$a)e:{n(Pe.$a==1),S=rr();t:for(;;){if(S==null){S=0;break e}if(n(Pe!=null),Pe.mc=S,S.c=Pe.c,S.i=Pe.i,S.l=Pe.l,S.l.ma=Pe,S.l.width=Pe.c,S.l.height=Pe.i,S.a=0,ie(S.m,Be,zt,Et),!Yi(Pe.c,Pe.i,1,S,null)||(S.ab==1&&S.gc[0].hc==3&&Si(S.s)?(Pe.ic=1,Be=S.c*S.i,S.Ta=null,S.Ua=0,S.V=o(Be),S.Ba=0,S.V==null?(S.a=1,S=0):S=1):(Pe.ic=0,S=Pi(S,Pe.c)),!S))break t;S=1;break e}Pe.mc=null,S=0}else S=Et>=Pe.c*Pe.i;Pe=!S}if(Pe)return null;v.ga.Lc!=1?v.Ga=0:J=xe-N}n(v.ga!=null),n(N+J<=xe);e:{if(S=(Be=v.ga).c,xe=Be.l.o,Be.$a==0){if(zt=v.rc,Et=v.Vc,Kt=v.Fa,Re=v.P+1+N*S,Ze=v.mb,mt=v.nb+N*S,n(Re<=v.P+v.qc),Be.Z!=0)for(n(nr[Be.Z]!=null),Pe=0;Pe<J;++Pe)nr[Be.Z](zt,Et,Kt,Re,Ze,mt,S),zt=Ze,Et=mt,mt+=S,Re+=S;else for(Pe=0;Pe<J;++Pe)i(Ze,mt,Kt,Re,S),zt=Ze,Et=mt,mt+=S,Re+=S;v.rc=zt,v.Vc=Et}else{if(n(Be.mc!=null),S=N+J,n((Pe=Be.mc)!=null),n(S<=Pe.i),Pe.C>=S)S=1;else if(Be.ic||kt(),Be.ic){Be=Pe.V,zt=Pe.Ba,Et=Pe.c;var Vt=Pe.i,vt=(Kt=1,Re=Pe.$/Et,Ze=Pe.$%Et,mt=Pe.m,Ft=Pe.s,Pe.$),Lt=Et*Vt,tn=Et*S,fn=Ft.wc,sn=vt<tn?yn(Ft,Ze,Re):null;n(vt<=Lt),n(S<=Vt),n(Si(Ft));t:for(;;){for(;!mt.h&&vt<tn;){if(Ze&fn||(sn=yn(Ft,Ze,Re)),n(sn!=null),he(mt),256>(Vt=jn(sn.G[0],sn.H[0],mt)))Be[zt+vt]=Vt,++vt,++Ze>=Et&&(Ze=0,++Re<=S&&!(Re%16)&&fr(Pe,Re));else{if(!(280>Vt)){Kt=0;break t}Vt=Un(Vt-256,mt);var Tn,An=jn(sn.G[4],sn.H[4],mt);if(he(mt),!(vt>=(An=ui(Et,An=Un(An,mt)))&&Lt-vt>=Vt)){Kt=0;break t}for(Tn=0;Tn<Vt;++Tn)Be[zt+vt+Tn]=Be[zt+vt+Tn-An];for(vt+=Vt,Ze+=Vt;Ze>=Et;)Ze-=Et,++Re<=S&&!(Re%16)&&fr(Pe,Re);vt<tn&&Ze&fn&&(sn=yn(Ft,Ze,Re))}n(mt.h==B(mt))}fr(Pe,Re>S?S:Re);break t}!Kt||mt.h&&vt<Lt?(Kt=0,Pe.a=mt.h?5:3):Pe.$=vt,S=Kt}else S=Hn(Pe,Pe.V,Pe.Ba,Pe.c,Pe.i,S,kn);if(!S){J=0;break e}}N+J>=xe&&(v.Cc=1),J=1}if(!J)return null;if(v.Cc&&((J=v.ga)!=null&&(J.mc=null),v.ga=null,0<v.Ga))return alert("todo:WebPDequantizeLevels"),null}return v.nb+N*me}function k(v,S,N,J,me,xe){for(;0<me--;){var Pe,Be=v,Re=S+(N?1:0),Ze=v,mt=S+(N?0:3);for(Pe=0;Pe<J;++Pe){var Ft=Ze[mt+4*Pe];Ft!=255&&(Ft*=32897,Be[Re+4*Pe+0]=Be[Re+4*Pe+0]*Ft>>23,Be[Re+4*Pe+1]=Be[Re+4*Pe+1]*Ft>>23,Be[Re+4*Pe+2]=Be[Re+4*Pe+2]*Ft>>23)}S+=xe}}function ge(v,S,N,J,me){for(;0<J--;){var xe;for(xe=0;xe<N;++xe){var Pe=v[S+2*xe+0],Be=15&(Ze=v[S+2*xe+1]),Re=4369*Be,Ze=(240&Ze|Ze>>4)*Re>>16;v[S+2*xe+0]=(240&Pe|Pe>>4)*Re>>16&240|(15&Pe|Pe<<4)*Re>>16>>4&15,v[S+2*xe+1]=240&Ze|Be}S+=me}}function Je(v,S,N,J,me,xe,Pe,Be){var Re,Ze,mt=255;for(Ze=0;Ze<me;++Ze){for(Re=0;Re<J;++Re){var Ft=v[S+Re];xe[Pe+4*Re]=Ft,mt&=Ft}S+=N,Pe+=Be}return mt!=255}function dt(v,S,N,J,me){var xe;for(xe=0;xe<me;++xe)N[J+xe]=v[S+xe]>>8}function kt(){cs=k,cr=ge,pr=Je,Wr=dt}function Ut(v,S,N){O[v]=function(J,me,xe,Pe,Be,Re,Ze,mt,Ft,zt,Et,Kt,Vt,vt,Lt,tn,fn){var sn,Tn=fn-1>>1,An=Be[Re+0]|Ze[mt+0]<<16,Kn=Ft[zt+0]|Et[Kt+0]<<16;n(J!=null);var a=3*An+Kn+131074>>2;for(S(J[me+0],255&a,a>>16,Vt,vt),xe!=null&&(a=3*Kn+An+131074>>2,S(xe[Pe+0],255&a,a>>16,Lt,tn)),sn=1;sn<=Tn;++sn){var c=Be[Re+sn]|Ze[mt+sn]<<16,g=Ft[zt+sn]|Et[Kt+sn]<<16,y=An+c+Kn+g+524296,C=y+2*(c+Kn)>>3;a=C+An>>1,An=(y=y+2*(An+g)>>3)+c>>1,S(J[me+2*sn-1],255&a,a>>16,Vt,vt+(2*sn-1)*N),S(J[me+2*sn-0],255&An,An>>16,Vt,vt+(2*sn-0)*N),xe!=null&&(a=y+Kn>>1,An=C+g>>1,S(xe[Pe+2*sn-1],255&a,a>>16,Lt,tn+(2*sn-1)*N),S(xe[Pe+2*sn+0],255&An,An>>16,Lt,tn+(2*sn+0)*N)),An=c,Kn=g}1&fn||(a=3*An+Kn+131074>>2,S(J[me+fn-1],255&a,a>>16,Vt,vt+(fn-1)*N),xe!=null&&(a=3*Kn+An+131074>>2,S(xe[Pe+fn-1],255&a,a>>16,Lt,tn+(fn-1)*N)))}}function cn(){Ss[qs]=Ne,Ss[oi]=Il,Ss[Yo]=Vs,Ss[Xo]=ps,Ss[_o]=Ti,Ss[Is]=nc,Ss[Tu]=dh,Ss[hs]=Il,Ss[fs]=ps,Ss[bo]=Ti,Ss[s]=nc}function Bn(v){return v&-16384?0>v?0:255:v>>Qh}function Rn(v,S){return Bn((19077*v>>8)+(26149*S>>8)-14234)}function Yn(v,S,N){return Bn((19077*v>>8)-(6419*S>>8)-(13320*N>>8)+8708)}function ci(v,S){return Bn((19077*v>>8)+(33050*S>>8)-17685)}function ki(v,S,N,J,me){J[me+0]=Rn(v,N),J[me+1]=Yn(v,S,N),J[me+2]=ci(v,S)}function Sr(v,S,N,J,me){J[me+0]=ci(v,S),J[me+1]=Yn(v,S,N),J[me+2]=Rn(v,N)}function er(v,S,N,J,me){var xe=Yn(v,S,N);S=xe<<3&224|ci(v,S)>>3,J[me+0]=248&Rn(v,N)|xe>>5,J[me+1]=S}function lr(v,S,N,J,me){var xe=240&ci(v,S)|15;J[me+0]=240&Rn(v,N)|Yn(v,S,N)>>4,J[me+1]=xe}function Hr(v,S,N,J,me){J[me+0]=255,ki(v,S,N,J,me+1)}function Qr(v,S,N,J,me){Sr(v,S,N,J,me),J[me+3]=255}function no(v,S,N,J,me){ki(v,S,N,J,me),J[me+3]=255}function Mi(v,S){return 0>v?0:v>S?S:v}function ys(v,S,N){O[v]=function(J,me,xe,Pe,Be,Re,Ze,mt,Ft){for(var zt=mt+(-2&Ft)*N;mt!=zt;)S(J[me+0],xe[Pe+0],Be[Re+0],Ze,mt),S(J[me+1],xe[Pe+0],Be[Re+0],Ze,mt+N),me+=2,++Pe,++Re,mt+=2*N;1&Ft&&S(J[me+0],xe[Pe+0],Be[Re+0],Ze,mt)}}function Da(v,S,N){return N==0?v==0?S==0?6:5:S==0?4:0:N}function Ns(v,S,N,J,me){switch(v>>>30){case 3:Zt(S,N,J,me,0);break;case 2:Rt(S,N,J,me);break;case 1:qn(S,N,J,me)}}function ml(v,S){var N,J,me=S.M,xe=S.Nb,Pe=v.oc,Be=v.pc+40,Re=v.oc,Ze=v.pc+584,mt=v.oc,Ft=v.pc+600;for(N=0;16>N;++N)Pe[Be+32*N-1]=129;for(N=0;8>N;++N)Re[Ze+32*N-1]=129,mt[Ft+32*N-1]=129;for(0<me?Pe[Be-1-32]=Re[Ze-1-32]=mt[Ft-1-32]=129:(r(Pe,Be-32-1,127,21),r(Re,Ze-32-1,127,9),r(mt,Ft-32-1,127,9)),J=0;J<v.za;++J){var zt=S.ya[S.aa+J];if(0<J){for(N=-1;16>N;++N)i(Pe,Be+32*N-4,Pe,Be+32*N+12,4);for(N=-1;8>N;++N)i(Re,Ze+32*N-4,Re,Ze+32*N+4,4),i(mt,Ft+32*N-4,mt,Ft+32*N+4,4)}var Et=v.Gd,Kt=v.Hd+J,Vt=zt.ad,vt=zt.Hc;if(0<me&&(i(Pe,Be-32,Et[Kt].y,0,16),i(Re,Ze-32,Et[Kt].f,0,8),i(mt,Ft-32,Et[Kt].ea,0,8)),zt.Za){var Lt=Pe,tn=Be-32+16;for(0<me&&(J>=v.za-1?r(Lt,tn,Et[Kt].y[15],4):i(Lt,tn,Et[Kt+1].y,0,4)),N=0;4>N;N++)Lt[tn+128+N]=Lt[tn+256+N]=Lt[tn+384+N]=Lt[tn+0+N];for(N=0;16>N;++N,vt<<=2)Lt=Pe,tn=Be+gh[N],wo[zt.Ob[N]](Lt,tn),Ns(vt,Vt,16*+N,Lt,tn)}else if(Lt=Da(J,me,zt.Ob[0]),Io[Lt](Pe,Be),vt!=0)for(N=0;16>N;++N,vt<<=2)Ns(vt,Vt,16*+N,Pe,Be+gh[N]);for(N=zt.Gc,Lt=Da(J,me,zt.Dd),ho[Lt](Re,Ze),ho[Lt](mt,Ft),vt=Vt,Lt=Re,tn=Ze,255&(zt=N>>0)&&(170&zt?Mn(vt,256,Lt,tn):gi(vt,256,Lt,tn)),zt=mt,vt=Ft,255&(N>>=8)&&(170&N?Mn(Vt,320,zt,vt):gi(Vt,320,zt,vt)),me<v.Ub-1&&(i(Et[Kt].y,0,Pe,Be+480,16),i(Et[Kt].f,0,Re,Ze+224,8),i(Et[Kt].ea,0,mt,Ft+224,8)),N=8*xe*v.B,Et=v.sa,Kt=v.ta+16*J+16*xe*v.R,Vt=v.qa,zt=v.ra+8*J+N,vt=v.Ha,Lt=v.Ia+8*J+N,N=0;16>N;++N)i(Et,Kt+N*v.R,Pe,Be+32*N,16);for(N=0;8>N;++N)i(Vt,zt+N*v.B,Re,Ze+32*N,8),i(vt,Lt+N*v.B,mt,Ft+32*N,8)}}function ko(v,S,N,J,me,xe,Pe,Be,Re){var Ze=[0],mt=[0],Ft=0,zt=Re!=null?Re.kd:0,Et=Re??new mo;if(v==null||12>N)return 7;Et.data=v,Et.w=S,Et.ha=N,S=[S],N=[N],Et.gb=[Et.gb];e:{var Kt=S,Vt=N,vt=Et.gb;if(n(v!=null),n(Vt!=null),n(vt!=null),vt[0]=0,12<=Vt[0]&&!t(v,Kt[0],"RIFF")){if(t(v,Kt[0]+8,"WEBP")){vt=3;break e}var Lt=ae(v,Kt[0]+4);if(12>Lt||4294967286<Lt){vt=3;break e}if(zt&&Lt>Vt[0]-8){vt=7;break e}vt[0]=Lt,Kt[0]+=12,Vt[0]-=12}vt=0}if(vt!=0)return vt;for(Lt=0<Et.gb[0],N=N[0];;){e:{var tn=v;Vt=S,vt=N;var fn=Ze,sn=mt,Tn=Kt=[0];if((a=Ft=[Ft])[0]=0,8>vt[0])vt=7;else{if(!t(tn,Vt[0],"VP8X")){if(ae(tn,Vt[0]+4)!=10){vt=3;break e}if(18>vt[0]){vt=7;break e}var An=ae(tn,Vt[0]+8),Kn=1+te(tn,Vt[0]+12);if(2147483648<=Kn*(tn=1+te(tn,Vt[0]+15))){vt=3;break e}Tn!=null&&(Tn[0]=An),fn!=null&&(fn[0]=Kn),sn!=null&&(sn[0]=tn),Vt[0]+=18,vt[0]-=18,a[0]=1}vt=0}}if(Ft=Ft[0],Kt=Kt[0],vt!=0)return vt;if(Vt=!!(2&Kt),!Lt&&Ft)return 3;if(xe!=null&&(xe[0]=!!(16&Kt)),Pe!=null&&(Pe[0]=Vt),Be!=null&&(Be[0]=0),Pe=Ze[0],Kt=mt[0],Ft&&Vt&&Re==null){vt=0;break}if(4>N){vt=7;break}if(Lt&&Ft||!Lt&&!Ft&&!t(v,S[0],"ALPH")){N=[N],Et.na=[Et.na],Et.P=[Et.P],Et.Sa=[Et.Sa];e:{An=v,vt=S,Lt=N;var a=Et.gb;fn=Et.na,sn=Et.P,Tn=Et.Sa,Kn=22,n(An!=null),n(Lt!=null),tn=vt[0];var c=Lt[0];for(n(fn!=null),n(Tn!=null),fn[0]=null,sn[0]=null,Tn[0]=0;;){if(vt[0]=tn,Lt[0]=c,8>c){vt=7;break e}var g=ae(An,tn+4);if(4294967286<g){vt=3;break e}var y=8+g+1&-2;if(Kn+=y,0<a&&Kn>a){vt=3;break e}if(!t(An,tn,"VP8 ")||!t(An,tn,"VP8L")){vt=0;break e}if(c[0]<y){vt=7;break e}t(An,tn,"ALPH")||(fn[0]=An,sn[0]=tn+8,Tn[0]=g),tn+=y,c-=y}}if(N=N[0],Et.na=Et.na[0],Et.P=Et.P[0],Et.Sa=Et.Sa[0],vt!=0)break}N=[N],Et.Ja=[Et.Ja],Et.xa=[Et.xa];e:if(a=v,vt=S,Lt=N,fn=Et.gb[0],sn=Et.Ja,Tn=Et.xa,An=vt[0],tn=!t(a,An,"VP8 "),Kn=!t(a,An,"VP8L"),n(a!=null),n(Lt!=null),n(sn!=null),n(Tn!=null),8>Lt[0])vt=7;else{if(tn||Kn){if(a=ae(a,An+4),12<=fn&&a>fn-12){vt=3;break e}if(zt&&a>Lt[0]-8){vt=7;break e}sn[0]=a,vt[0]+=8,Lt[0]-=8,Tn[0]=Kn}else Tn[0]=5<=Lt[0]&&a[An+0]==47&&!(a[An+4]>>5),sn[0]=Lt[0];vt=0}if(N=N[0],Et.Ja=Et.Ja[0],Et.xa=Et.xa[0],S=S[0],vt!=0)break;if(4294967286<Et.Ja)return 3;if(Be==null||Vt||(Be[0]=Et.xa?2:1),Pe=[Pe],Kt=[Kt],Et.xa){if(5>N){vt=7;break}Be=Pe,zt=Kt,Vt=xe,v==null||5>N?v=0:5<=N&&v[S+0]==47&&!(v[S+4]>>5)?(Lt=[0],a=[0],fn=[0],ie(sn=new X,v,S,N),Sn(sn,Lt,a,fn)?(Be!=null&&(Be[0]=Lt[0]),zt!=null&&(zt[0]=a[0]),Vt!=null&&(Vt[0]=fn[0]),v=1):v=0):v=0}else{if(10>N){vt=7;break}Be=Kt,v==null||10>N||!as(v,S+3,N-3)?v=0:(zt=v[S+0]|v[S+1]<<8|v[S+2]<<16,Vt=16383&(v[S+7]<<8|v[S+6]),v=16383&(v[S+9]<<8|v[S+8]),1&zt||3<(zt>>1&7)||!(zt>>4&1)||zt>>5>=Et.Ja||!Vt||!v?v=0:(Pe&&(Pe[0]=Vt),Be&&(Be[0]=v),v=1))}if(!v||(Pe=Pe[0],Kt=Kt[0],Ft&&(Ze[0]!=Pe||mt[0]!=Kt)))return 3;Re!=null&&(Re[0]=Et,Re.offset=S-Re.w,n(4294967286>S-Re.w),n(Re.offset==Re.ha-N));break}return vt==0||vt==7&&Ft&&Re==null?(xe!=null&&(xe[0]|=Et.na!=null&&0<Et.na.length),J!=null&&(J[0]=Pe),me!=null&&(me[0]=Kt),0):vt}function Rl(v,S,N){var J=S.width,me=S.height,xe=0,Pe=0,Be=J,Re=me;if(S.Da=v!=null&&0<v.Da,S.Da&&(Be=v.cd,Re=v.bd,xe=v.v,Pe=v.j,11>N||(xe&=-2,Pe&=-2),0>xe||0>Pe||0>=Be||0>=Re||xe+Be>J||Pe+Re>me))return 0;if(S.v=xe,S.j=Pe,S.va=xe+Be,S.o=Pe+Re,S.U=Be,S.T=Re,S.da=v!=null&&0<v.da,S.da){if(!Oe(Be,Re,N=[v.ib],xe=[v.hb]))return 0;S.ib=N[0],S.hb=xe[0]}return S.ob=v!=null&&v.ob,S.Kb=v==null||!v.Sd,S.da&&(S.ob=S.ib<3*J/4&&S.hb<3*me/4,S.Kb=0),1}function da(v){if(v==null)return 2;if(11>v.S){var S=v.f.RGBA;S.fb+=(v.height-1)*S.A,S.A=-S.A}else S=v.f.kb,v=v.height,S.O+=(v-1)*S.fa,S.fa=-S.fa,S.N+=(v-1>>1)*S.Ab,S.Ab=-S.Ab,S.W+=(v-1>>1)*S.Db,S.Db=-S.Db,S.F!=null&&(S.J+=(v-1)*S.lb,S.lb=-S.lb);return 0}function pa(v,S,N,J){if(J==null||0>=v||0>=S)return 2;if(N!=null){if(N.Da){var me=N.cd,xe=N.bd,Pe=-2&N.v,Be=-2&N.j;if(0>Pe||0>Be||0>=me||0>=xe||Pe+me>v||Be+xe>S)return 2;v=me,S=xe}if(N.da){if(!Oe(v,S,me=[N.ib],xe=[N.hb]))return 2;v=me[0],S=xe[0]}}J.width=v,J.height=S;e:{var Re=J.width,Ze=J.height;if(v=J.S,0>=Re||0>=Ze||!(v>=qs&&13>v))v=2;else{if(0>=J.Rd&&J.sd==null){Pe=xe=me=S=0;var mt=(Be=Re*yh[v])*Ze;if(11>v||(xe=(Ze+1)/2*(S=(Re+1)/2),v==12&&(Pe=(me=Re)*Ze)),(Ze=o(mt+2*xe+Pe))==null){v=1;break e}J.sd=Ze,11>v?((Re=J.f.RGBA).eb=Ze,Re.fb=0,Re.A=Be,Re.size=mt):((Re=J.f.kb).y=Ze,Re.O=0,Re.fa=Be,Re.Fd=mt,Re.f=Ze,Re.N=0+mt,Re.Ab=S,Re.Cd=xe,Re.ea=Ze,Re.W=0+mt+xe,Re.Db=S,Re.Ed=xe,v==12&&(Re.F=Ze,Re.J=0+mt+2*xe),Re.Tc=Pe,Re.lb=me)}if(S=1,me=J.S,xe=J.width,Pe=J.height,me>=qs&&13>me)if(11>me)v=J.f.RGBA,S&=(Be=Math.abs(v.A))*(Pe-1)+xe<=v.size,S&=Be>=xe*yh[me],S&=v.eb!=null;else{v=J.f.kb,Be=(xe+1)/2,mt=(Pe+1)/2,Re=Math.abs(v.fa),Ze=Math.abs(v.Ab);var Ft=Math.abs(v.Db),zt=Math.abs(v.lb),Et=zt*(Pe-1)+xe;S&=Re*(Pe-1)+xe<=v.Fd,S&=Ze*(mt-1)+Be<=v.Cd,S=(S&=Ft*(mt-1)+Be<=v.Ed)&Re>=xe&Ze>=Be&Ft>=Be,S&=v.y!=null,S&=v.f!=null,S&=v.ea!=null,me==12&&(S&=zt>=xe,S&=Et<=v.Tc,S&=v.F!=null)}else S=0;v=S?0:2}}return v!=0||N!=null&&N.fd&&(v=da(J)),v}var es=64,Mo=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],io=24,Us=32,Ra=8,_s=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ve("Predictor0","PredictorAdd0"),O.Predictor0=function(){return 4278190080},O.Predictor1=function(v){return v},O.Predictor2=function(v,S,N){return S[N+0]},O.Predictor3=function(v,S,N){return S[N+1]},O.Predictor4=function(v,S,N){return S[N-1]},O.Predictor5=function(v,S,N){return st(st(v,S[N+1]),S[N+0])},O.Predictor6=function(v,S,N){return st(v,S[N-1])},O.Predictor7=function(v,S,N){return st(v,S[N+0])},O.Predictor8=function(v,S,N){return st(S[N-1],S[N+0])},O.Predictor9=function(v,S,N){return st(S[N+0],S[N+1])},O.Predictor10=function(v,S,N){return st(st(v,S[N-1]),st(S[N+0],S[N+1]))},O.Predictor11=function(v,S,N){var J=S[N+0];return 0>=wt(J>>24&255,v>>24&255,(S=S[N-1])>>24&255)+wt(J>>16&255,v>>16&255,S>>16&255)+wt(J>>8&255,v>>8&255,S>>8&255)+wt(255&J,255&v,255&S)?J:v},O.Predictor12=function(v,S,N){var J=S[N+0];return(Qe((v>>24&255)+(J>>24&255)-((S=S[N-1])>>24&255))<<24|Qe((v>>16&255)+(J>>16&255)-(S>>16&255))<<16|Qe((v>>8&255)+(J>>8&255)-(S>>8&255))<<8|Qe((255&v)+(255&J)-(255&S)))>>>0},O.Predictor13=function(v,S,N){var J=S[N-1];return(pt((v=st(v,S[N+0]))>>24&255,J>>24&255)<<24|pt(v>>16&255,J>>16&255)<<16|pt(v>>8&255,J>>8&255)<<8|pt(v>>0&255,J>>0&255))>>>0};var Ds=O.PredictorAdd0;O.PredictorAdd1=Ht,Ve("Predictor2","PredictorAdd2"),Ve("Predictor3","PredictorAdd3"),Ve("Predictor4","PredictorAdd4"),Ve("Predictor5","PredictorAdd5"),Ve("Predictor6","PredictorAdd6"),Ve("Predictor7","PredictorAdd7"),Ve("Predictor8","PredictorAdd8"),Ve("Predictor9","PredictorAdd9"),Ve("Predictor10","PredictorAdd10"),Ve("Predictor11","PredictorAdd11"),Ve("Predictor12","PredictorAdd12"),Ve("Predictor13","PredictorAdd13");var Rs=O.PredictorAdd2;rn("ColorIndexInverseTransform","MapARGB","32b",function(v){return v>>8&255},function(v){return v}),rn("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(v){return v},function(v){return v>>8&255});var uu,ss=O.ColorIndexInverseTransform,Wo=O.MapARGB,bs=O.VP8LColorIndexInverseTransformAlpha,ws=O.MapAlpha,Zo=O.VP8LPredictorsAdd=[];Zo.length=16,(O.VP8LPredictors=[]).length=16,(O.VP8LPredictorsAdd_C=[]).length=16,(O.VP8LPredictors_C=[]).length=16;var Ko,xs,us,To,ro,Ls,Ct,Zt,Rt,Mn,qn,gi,kr,ur,nl,Os,Mr,Bo,Jo,No,Do,Ro,Ii,yo,cs,cr,pr,Wr,_r=o(511),so=o(2041),$s=o(225),co=o(767),Ol=0,Oo=so,ts=$s,yr=co,Cs=_r,qs=0,oi=1,Yo=2,Xo=3,_o=4,Is=5,Tu=6,hs=7,fs=8,bo=9,s=10,f=[2,3,7],x=[3,3,11],T=[280,256,256,256,40],K=[0,1,1,1,0],we=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],ct=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Dt=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],$t=8,an=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Nn=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Zn=null,Ei=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],ns=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Or=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],ds=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Tr=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Gs=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Bu=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Io=[],wo=[],ho=[],Nc=1,vl=2,nr=[],Ss=[];Ut("UpsampleRgbLinePair",ki,3),Ut("UpsampleBgrLinePair",Sr,3),Ut("UpsampleRgbaLinePair",no,4),Ut("UpsampleBgraLinePair",Qr,4),Ut("UpsampleArgbLinePair",Hr,4),Ut("UpsampleRgba4444LinePair",lr,2),Ut("UpsampleRgb565LinePair",er,2);var Ne=O.UpsampleRgbLinePair,Vs=O.UpsampleBgrLinePair,Il=O.UpsampleRgbaLinePair,ps=O.UpsampleBgraLinePair,Ti=O.UpsampleArgbLinePair,nc=O.UpsampleRgba4444LinePair,dh=O.UpsampleRgb565LinePair,ic=16,ga=1<<ic-1,Nu=-227,Dc=482,Qh=6,cu=0,rc=o(256),il=o(256),ef=o(256),sc=o(256),oc=o(Dc-Nu),ph=o(Dc-Nu);ys("YuvToRgbRow",ki,3),ys("YuvToBgrRow",Sr,3),ys("YuvToRgbaRow",no,4),ys("YuvToBgraRow",Qr,4),ys("YuvToArgbRow",Hr,4),ys("YuvToRgba4444Row",lr,2),ys("YuvToRgb565Row",er,2);var gh=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Qo=[0,2,8],mh=[8,7,6,4,4,2,2,2,1,1,1,1],vh=1;this.WebPDecodeRGBA=function(v,S,N,J,me){var xe=oi,Pe=new ls,Be=new Gt;Pe.ba=Be,Be.S=xe,Be.width=[Be.width],Be.height=[Be.height];var Re=Be.width,Ze=Be.height,mt=new Dn;if(mt==null||v==null)var Ft=2;else n(mt!=null),Ft=ko(v,S,N,mt.width,mt.height,mt.Pd,mt.Qd,mt.format,null);if(Ft!=0?Re=0:(Re!=null&&(Re[0]=mt.width[0]),Ze!=null&&(Ze[0]=mt.height[0]),Re=1),Re){Be.width=Be.width[0],Be.height=Be.height[0],J!=null&&(J[0]=Be.width),me!=null&&(me[0]=Be.height);e:{if(J=new di,(me=new mo).data=v,me.w=S,me.ha=N,me.kd=1,S=[0],n(me!=null),((v=ko(me.data,me.w,me.ha,null,null,null,S,null,me))==0||v==7)&&S[0]&&(v=4),(S=v)==0){if(n(Pe!=null),J.data=me.data,J.w=me.w+me.offset,J.ha=me.ha-me.offset,J.put=ri,J.ac=ni,J.bc=Li,J.ma=Pe,me.xa){if((v=rr())==null){Pe=1;break e}if(function(zt,Et){var Kt=[0],Vt=[0],vt=[0];t:for(;;){if(zt==null)return 0;if(Et==null)return zt.a=2,0;if(zt.l=Et,zt.a=0,ie(zt.m,Et.data,Et.w,Et.ha),!Sn(zt.m,Kt,Vt,vt)){zt.a=3;break t}if(zt.xb=vl,Et.width=Kt[0],Et.height=Vt[0],!Yi(Kt[0],Vt[0],1,zt,null))break t;return 1}return n(zt.a!=0),0}(v,J)){if(J=(S=pa(J.width,J.height,Pe.Oa,Pe.ba))==0){t:{J=v;n:for(;;){if(J==null){J=0;break t}if(n(J.s.yc!=null),n(J.s.Ya!=null),n(0<J.s.Wb),n((N=J.l)!=null),n((me=N.ma)!=null),J.xb!=0){if(J.ca=me.ba,J.tb=me.tb,n(J.ca!=null),!Rl(me.Oa,N,Xo)){J.a=2;break n}if(!Pi(J,N.width)||N.da)break n;if((N.da||de(J.ca.S))&&kt(),11>J.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),J.ca.f.kb.F!=null&&kt()),J.Pb&&0<J.s.ua&&J.s.vb.X==null&&!Le(J.s.vb,J.s.Wa.Xa)){J.a=1;break n}J.xb=0}if(!Hn(J,J.V,J.Ba,J.c,J.i,N.o,qi))break n;me.Dc=J.Ma,J=1;break t}n(J.a!=0),J=0}J=!J}J&&(S=v.a)}else S=v.a}else{if((v=new li)==null){Pe=1;break e}if(v.Fa=me.na,v.P=me.P,v.qc=me.Sa,Ms(v,J)){if((S=pa(J.width,J.height,Pe.Oa,Pe.ba))==0){if(v.Aa=0,N=Pe.Oa,n((me=v)!=null),N!=null){if(0<(Re=0>(Re=N.Md)?0:100<Re?255:255*Re/100)){for(Ze=mt=0;4>Ze;++Ze)12>(Ft=me.pb[Ze]).lc&&(Ft.ia=Re*mh[0>Ft.lc?0:Ft.lc]>>3),mt|=Ft.ia;mt&&(alert("todo:VP8InitRandom"),me.ia=1)}me.Ga=N.Id,100<me.Ga?me.Ga=100:0>me.Ga&&(me.Ga=0)}dn(v,J)||(S=v.a)}}else S=v.a}S==0&&Pe.Oa!=null&&Pe.Oa.fd&&(S=da(Pe.ba))}Pe=S}xe=Pe!=0?null:11>xe?Be.f.RGBA.eb:Be.f.kb.y}else xe=null;return xe};var yh=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function m(O,H){for(var le="",G=0;G<4;G++)le+=String.fromCharCode(O[H++]);return le}function _(O,H){return(O[H+0]<<0|O[H+1]<<8|O[H+2]<<16)>>>0}function w(O,H){return(O[H+0]<<0|O[H+1]<<8|O[H+2]<<16|O[H+3]<<24)>>>0}new p;var E=[0],b=[0],D=[],j=new p,Q=e,F=function(O,H){var le={},G=0,I=!1,Y=0,$=0;if(le.frames=[],!function(ke,B,W,he){for(var ne=0;ne<he;ne++)if(ke[B+ne]!=W.charCodeAt(ne))return!0;return!1}(O,H,"RIFF",4)){var R,Z;for(w(O,H+=4),H+=8;H<O.length;){var se=m(O,H),ie=w(O,H+=4);H+=4;var Ae=ie+(1&ie);switch(se){case"VP8 ":case"VP8L":le.frames[G]===void 0&&(le.frames[G]={}),(X=le.frames[G]).src_off=I?$:H-8,X.src_size=Y+ie+8,G++,I&&(I=!1,Y=0,$=0);break;case"VP8X":(X=le.header={}).feature_flags=O[H];var Te=H+4;X.canvas_width=1+_(O,Te),Te+=3,X.canvas_height=1+_(O,Te),Te+=3;break;case"ALPH":I=!0,Y=Ae+8,$=H-8;break;case"ANIM":(X=le.header).bgcolor=w(O,H),Te=H+4,X.loop_count=(R=O)[(Z=Te)+0]<<0|R[Z+1]<<8,Te+=2;break;case"ANMF":var ut,X;(X=le.frames[G]={}).offset_x=2*_(O,H),H+=3,X.offset_y=2*_(O,H),H+=3,X.width=1+_(O,H),H+=3,X.height=1+_(O,H),H+=3,X.duration=_(O,H),H+=3,ut=O[H++],X.dispose=1&ut,X.blend=ut>>1&1}se!="ANMF"&&(H+=Ae)}return le}}(Q,0);F.response=Q,F.rgbaoutput=!0,F.dataurl=!1;var V=F.header?F.header:null,pe=F.frames?F.frames:null;if(V){V.loop_counter=V.loop_count,E=[V.canvas_height],b=[V.canvas_width];for(var Ee=0;Ee<pe.length&&pe[Ee].blend!=0;Ee++);}var Ie=pe[0],nt=j.WebPDecodeRGBA(Q,Ie.src_off,Ie.src_size,b,E);Ie.rgba=nt,Ie.imgwidth=b[0],Ie.imgheight=E[0];for(var We=0;We<b[0]*E[0]*4;We++)D[We]=nt[We];return this.width=b,this.height=E,this.data=D,this}(function(e){var n=function(){return typeof $g=="function"},t=function(E,b,D,j){var Q=4,F=l;switch(j){case e.image_compression.FAST:Q=1,F=o;break;case e.image_compression.MEDIUM:Q=6,F=h;break;case e.image_compression.SLOW:Q=9,F=p}E=i(E,b,D,F);var V=$g(E,{level:Q});return e.__addimage__.arrayBufferToBinaryString(V)},i=function(E,b,D,j){for(var Q,F,V,pe=E.length/b,Ee=new Uint8Array(E.length+pe),Ie=_(),nt=0;nt<pe;nt+=1){if(V=nt*b,Q=E.subarray(V,V+b),j)Ee.set(j(Q,D,F),V+nt);else{for(var We,O=Ie.length,H=[];We<O;We+=1)H[We]=Ie[We](Q,D,F);var le=w(H.concat());Ee.set(H[le],V+nt)}F=Q}return Ee},r=function(E){var b=Array.apply([],E);return b.unshift(0),b},o=function(E,b){var D,j=[],Q=E.length;j[0]=1;for(var F=0;F<Q;F+=1)D=E[F-b]||0,j[F+1]=E[F]-D+256&255;return j},l=function(E,b,D){var j,Q=[],F=E.length;Q[0]=2;for(var V=0;V<F;V+=1)j=D&&D[V]||0,Q[V+1]=E[V]-j+256&255;return Q},h=function(E,b,D){var j,Q,F=[],V=E.length;F[0]=3;for(var pe=0;pe<V;pe+=1)j=E[pe-b]||0,Q=D&&D[pe]||0,F[pe+1]=E[pe]+256-(j+Q>>>1)&255;return F},p=function(E,b,D){var j,Q,F,V,pe=[],Ee=E.length;pe[0]=4;for(var Ie=0;Ie<Ee;Ie+=1)j=E[Ie-b]||0,Q=D&&D[Ie]||0,F=D&&D[Ie-b]||0,V=m(j,Q,F),pe[Ie+1]=E[Ie]-V+256&255;return pe},m=function(E,b,D){if(E===b&&b===D)return E;var j=Math.abs(b-D),Q=Math.abs(E-D),F=Math.abs(E+b-D-D);return j<=Q&&j<=F?E:Q<=F?b:D},_=function(){return[r,o,l,h,p]},w=function(E){var b=E.map(function(D){return D.reduce(function(j,Q){return j+Math.abs(Q)},0)});return b.indexOf(Math.min.apply(null,b))};e.processPNG=function(E,b,D,j){var Q,F,V,pe,Ee,Ie,nt,We,O,H,le,G,I,Y,$,R=this.decode.FLATE_DECODE,Z="";if(this.__addimage__.isArrayBuffer(E)&&(E=new Uint8Array(E)),this.__addimage__.isArrayBufferView(E)){if(E=(V=new _N(E)).imgData,F=V.bits,Q=V.colorSpace,Ee=V.colors,[4,6].indexOf(V.colorType)!==-1){if(V.bits===8){O=(We=V.pixelBitlength==32?new Uint32Array(V.decodePixels().buffer):V.pixelBitlength==16?new Uint16Array(V.decodePixels().buffer):new Uint8Array(V.decodePixels().buffer)).length,le=new Uint8Array(O*V.colors),H=new Uint8Array(O);var se,ie=V.pixelBitlength-V.bits;for(Y=0,$=0;Y<O;Y++){for(I=We[Y],se=0;se<ie;)le[$++]=I>>>se&255,se+=V.bits;H[Y]=I>>>se&255}}if(V.bits===16){O=(We=new Uint32Array(V.decodePixels().buffer)).length,le=new Uint8Array(O*(32/V.pixelBitlength)*V.colors),H=new Uint8Array(O*(32/V.pixelBitlength)),G=V.colors>1,Y=0,$=0;for(var Ae=0;Y<O;)I=We[Y++],le[$++]=I>>>0&255,G&&(le[$++]=I>>>16&255,I=We[Y++],le[$++]=I>>>0&255),H[Ae++]=I>>>16&255;F=8}j!==e.image_compression.NONE&&n()?(E=t(le,V.width*V.colors,V.colors,j),nt=t(H,V.width,1,j)):(E=le,nt=H,R=void 0)}if(V.colorType===3&&(Q=this.color_spaces.INDEXED,Ie=V.palette,V.transparency.indexed)){var Te=V.transparency.indexed,ut=0;for(Y=0,O=Te.length;Y<O;++Y)ut+=Te[Y];if((ut/=255)===O-1&&Te.indexOf(0)!==-1)pe=[Te.indexOf(0)];else if(ut!==O){for(We=V.decodePixels(),H=new Uint8Array(We.length),Y=0,O=We.length;Y<O;Y++)H[Y]=Te[We[Y]];nt=t(H,V.width,1)}}var X=function(ke){var B;switch(ke){case e.image_compression.FAST:B=11;break;case e.image_compression.MEDIUM:B=13;break;case e.image_compression.SLOW:B=14;break;default:B=12}return B}(j);return R===this.decode.FLATE_DECODE&&(Z="/Predictor "+X+" "),Z+="/Colors "+Ee+" /BitsPerComponent "+F+" /Columns "+V.width,(this.__addimage__.isArrayBuffer(E)||this.__addimage__.isArrayBufferView(E))&&(E=this.__addimage__.arrayBufferToBinaryString(E)),(nt&&this.__addimage__.isArrayBuffer(nt)||this.__addimage__.isArrayBufferView(nt))&&(nt=this.__addimage__.arrayBufferToBinaryString(nt)),{alias:D,data:E,index:b,filter:R,decodeParameters:Z,transparency:pe,palette:Ie,sMask:nt,predictor:X,width:V.width,height:V.height,bitsPerComponent:F,colorSpace:Q}}}})(wi.API),function(e){e.processGIF89A=function(n,t,i,r){var o=new bN(n),l=o.width,h=o.height,p=[];o.decodeAndBlitFrameRGBA(0,p);var m={data:p,width:l,height:h},_=new eg(100).encode(m,100);return e.processJPEG.call(this,_,t,i,r)},e.processGIF87A=e.processGIF89A}(wi.API),Wl.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var n=0;n<e;n++){var t=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[n]={red:r,green:i,blue:t,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Wl.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,n=this.width*this.height*4;this.data=new Uint8Array(n),this[e]()}catch(t){Kr.log("bit decode error:"+t)}},Wl.prototype.bit1=function(){var e,n=Math.ceil(this.width/8),t=n%4;for(e=this.height-1;e>=0;e--){for(var i=this.bottom_up?e:this.height-1-e,r=0;r<n;r++)for(var o=this.datav.getUint8(this.pos++,!0),l=i*this.width*4+8*r*4,h=0;h<8&&8*r+h<this.width;h++){var p=this.palette[o>>7-h&1];this.data[l+4*h]=p.blue,this.data[l+4*h+1]=p.green,this.data[l+4*h+2]=p.red,this.data[l+4*h+3]=255}t!==0&&(this.pos+=4-t)}},Wl.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),n=e%4,t=this.height-1;t>=0;t--){for(var i=this.bottom_up?t:this.height-1-t,r=0;r<e;r++){var o=this.datav.getUint8(this.pos++,!0),l=i*this.width*4+2*r*4,h=o>>4,p=15&o,m=this.palette[h];if(this.data[l]=m.blue,this.data[l+1]=m.green,this.data[l+2]=m.red,this.data[l+3]=255,2*r+1>=this.width)break;m=this.palette[p],this.data[l+4]=m.blue,this.data[l+4+1]=m.green,this.data[l+4+2]=m.red,this.data[l+4+3]=255}n!==0&&(this.pos+=4-n)}},Wl.prototype.bit8=function(){for(var e=this.width%4,n=this.height-1;n>=0;n--){for(var t=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var r=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*i;if(r<this.palette.length){var l=this.palette[r];this.data[o]=l.red,this.data[o+1]=l.green,this.data[o+2]=l.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}e!==0&&(this.pos+=4-e)}},Wl.prototype.bit15=function(){for(var e=this.width%3,n=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var i=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&n)/n*255|0,h=(o>>5&n)/n*255|0,p=(o>>10&n)/n*255|0,m=o>>15?255:0,_=i*this.width*4+4*r;this.data[_]=p,this.data[_+1]=h,this.data[_+2]=l,this.data[_+3]=m}this.pos+=e}},Wl.prototype.bit16=function(){for(var e=this.width%3,n=parseInt("11111",2),t=parseInt("111111",2),i=this.height-1;i>=0;i--){for(var r=this.bottom_up?i:this.height-1-i,o=0;o<this.width;o++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var h=(l&n)/n*255|0,p=(l>>5&t)/t*255|0,m=(l>>11)/n*255|0,_=r*this.width*4+4*o;this.data[_]=m,this.data[_+1]=p,this.data[_+2]=h,this.data[_+3]=255}this.pos+=e}},Wl.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,t=0;t<this.width;t++){var i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=n*this.width*4+4*t;this.data[l]=o,this.data[l+1]=r,this.data[l+2]=i,this.data[l+3]=255}this.pos+=this.width%4}},Wl.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var n=this.bottom_up?e:this.height-1-e,t=0;t<this.width;t++){var i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),h=n*this.width*4+4*t;this.data[h]=o,this.data[h+1]=r,this.data[h+2]=i,this.data[h+3]=l}},Wl.prototype.getData=function(){return this.data},function(e){e.processBMP=function(n,t,i,r){var o=new Wl(n,!1),l=o.width,h=o.height,p={data:o.getData(),width:l,height:h},m=new eg(100).encode(p,100);return e.processJPEG.call(this,m,t,i,r)}}(wi.API),Hy.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(n,t,i,r){var o=new Hy(n),l=o.width,h=o.height,p={data:o.getData(),width:l,height:h},m=new eg(100).encode(p,100);return e.processJPEG.call(this,m,t,i,r)}}(wi.API),wi.API.processRGBA=function(e,n,t){for(var i=e.data,r=i.length,o=new Uint8Array(r/4*3),l=new Uint8Array(r/4),h=0,p=0,m=0;m<r;m+=4){var _=i[m],w=i[m+1],E=i[m+2],b=i[m+3];o[h++]=_,o[h++]=w,o[h++]=E,l[p++]=b}var D=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(l),data:D,index:n,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},wi.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Bh=wi.API,Bd=Bh.getCharWidthsArray=function(e,n){var t,i,r=(n=n||{}).font||this.internal.getFont(),o=n.fontSize||this.internal.getFontSize(),l=n.charSpace||this.internal.getCharSpace(),h=n.widths?n.widths:r.metadata.Unicode.widths,p=h.fof?h.fof:1,m=n.kerning?n.kerning:r.metadata.Unicode.kerning,_=m.fof?m.fof:1,w=n.doKerning!==!1,E=0,b=e.length,D=0,j=h[0]||p,Q=[];for(t=0;t<b;t++)i=e.charCodeAt(t),typeof r.metadata.widthOfString=="function"?Q.push((r.metadata.widthOfGlyph(r.metadata.characterToGlyph(i))+l*(1e3/o)||0)/1e3):(E=w&&Fr(m[i])==="object"&&!isNaN(parseInt(m[i][D],10))?m[i][D]/_:0,Q.push((h[i]||j)/p+E)),D=i;return Q},$y=Bh.getStringUnitWidth=function(e,n){var t=(n=n||{}).fontSize||this.internal.getFontSize(),i=n.font||this.internal.getFont(),r=n.charSpace||this.internal.getCharSpace();return Bh.processArabic&&(e=Bh.processArabic(e)),typeof i.metadata.widthOfString=="function"?i.metadata.widthOfString(e,t,r)/t:Bd.apply(this,arguments).reduce(function(o,l){return o+l},0)},qy=function(e,n,t,i){for(var r=[],o=0,l=e.length,h=0;o!==l&&h+n[o]<t;)h+=n[o],o++;r.push(e.slice(0,o));var p=o;for(h=0;o!==l;)h+n[o]>i&&(r.push(e.slice(p,o)),h=0,p=o),h+=n[o],o++;return p!==o&&r.push(e.slice(p,o)),r},Gy=function(e,n,t){t||(t={});var i,r,o,l,h,p,m,_=[],w=[_],E=t.textIndent||0,b=0,D=0,j=e.split(" "),Q=Bd.apply(this,[" ",t])[0];if(p=t.lineIndent===-1?j[0].length+2:t.lineIndent||0){var F=Array(p).join(" "),V=[];j.map(function(Ee){(Ee=Ee.split(/\s*\n/)).length>1?V=V.concat(Ee.map(function(Ie,nt){return(nt&&Ie.length?`
`:"")+Ie})):V.push(Ee[0])}),j=V,p=$y.apply(this,[F,t])}for(o=0,l=j.length;o<l;o++){var pe=0;if(i=j[o],p&&i[0]==`
`&&(i=i.substr(1),pe=1),E+b+(D=(r=Bd.apply(this,[i,t])).reduce(function(Ee,Ie){return Ee+Ie},0))>n||pe){if(D>n){for(h=qy.apply(this,[i,r,n-(E+b),n]),_.push(h.shift()),_=[h.pop()];h.length;)w.push([h.shift()]);D=r.slice(i.length-(_[0]?_[0].length:0)).reduce(function(Ee,Ie){return Ee+Ie},0)}else _=[i];w.push(_),E=D+p,b=Q}else _.push(i),E+=b+D,b=Q}return m=p?function(Ee,Ie){return(Ie?F:"")+Ee.join(" ")}:function(Ee){return Ee.join(" ")},w.map(m)},Bh.splitTextToSize=function(e,n,t){var i,r=(t=t||{}).fontSize||this.internal.getFontSize(),o=(function(_){if(_.widths&&_.kerning)return{widths:_.widths,kerning:_.kerning};var w=this.internal.getFont(_.fontName,_.fontStyle);return w.metadata.Unicode?{widths:w.metadata.Unicode.widths||{0:1},kerning:w.metadata.Unicode.kerning||{}}:{font:w.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);i=Array.isArray(e)?e:String(e).split(/\r?\n/);var l=1*this.internal.scaleFactor*n/r;o.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/r:0,o.lineIndent=t.lineIndent;var h,p,m=[];for(h=0,p=i.length;h<p;h++)m=m.concat(Gy.apply(this,[i[h],l,o]));return m},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var n="klmnopqrstuvwxyz",t={},i={},r=0;r<n.length;r++)t[n[r]]="0123456789abcdef"[r],i["0123456789abcdef"[r]]=n[r];var o=function(w){return"0x"+parseInt(w,10).toString(16)},l=e.__fontmetrics__.compress=function(w){var E,b,D,j,Q=["{"];for(var F in w){if(E=w[F],isNaN(parseInt(F,10))?b="'"+F+"'":(F=parseInt(F,10),b=(b=o(F).slice(2)).slice(0,-1)+i[b.slice(-1)]),typeof E=="number")E<0?(D=o(E).slice(3),j="-"):(D=o(E).slice(2),j=""),D=j+D.slice(0,-1)+i[D.slice(-1)];else{if(Fr(E)!=="object")throw new Error("Don't know what to do with value type "+Fr(E)+".");D=l(E)}Q.push(b+D)}return Q.push("}"),Q.join("")},h=e.__fontmetrics__.uncompress=function(w){if(typeof w!="string")throw new Error("Invalid argument passed to uncompress.");for(var E,b,D,j,Q={},F=1,V=Q,pe=[],Ee="",Ie="",nt=w.length-1,We=1;We<nt;We+=1)(j=w[We])=="'"?E?(D=E.join(""),E=void 0):E=[]:E?E.push(j):j=="{"?(pe.push([V,D]),V={},D=void 0):j=="}"?((b=pe.pop())[0][b[1]]=V,D=void 0,V=b[0]):j=="-"?F=-1:D===void 0?t.hasOwnProperty(j)?(Ee+=t[j],D=parseInt(Ee,16)*F,F=1,Ee=""):Ee+=j:t.hasOwnProperty(j)?(Ie+=t[j],V[D]=parseInt(Ie,16)*F,F=1,D=void 0,Ie=""):Ie+=j;return Q},p={codePages:["WinAnsiEncoding"],WinAnsiEncoding:h("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},m={Unicode:{Courier:p,"Courier-Bold":p,"Courier-BoldOblique":p,"Courier-Oblique":p,Helvetica:p,"Helvetica-Bold":p,"Helvetica-BoldOblique":p,"Helvetica-Oblique":p,"Times-Roman":p,"Times-Bold":p,"Times-BoldItalic":p,"Times-Italic":p}},_={Unicode:{"Courier-Oblique":h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":h("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":h("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":h("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:h("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:h("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":h("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:h("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":h("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":h("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":h("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(w){var E=w.font,b=_.Unicode[E.postScriptName];b&&(E.metadata.Unicode={},E.metadata.Unicode.widths=b.widths,E.metadata.Unicode.kerning=b.kerning);var D=m.Unicode[E.postScriptName];D&&(E.metadata.Unicode.encoding=D,E.encoding=D.codePages[0])}])}(wi.API),function(e){var n=function(t){for(var i=t.length,r=new Uint8Array(i),o=0;o<i;o++)r[o]=t.charCodeAt(o);return r};e.API.events.push(["addFont",function(t){var i=void 0,r=t.font,o=t.instance;if(!r.isStandardFont){if(o===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");if(typeof(i=o.existsFileInVFS(r.postScriptName)===!1?o.loadFile(r.postScriptName):o.getFileFromVFS(r.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");(function(l,h){h=/^\x00\x01\x00\x00/.test(h)?n(h):n(Of(h)),l.metadata=e.API.TTFFont.open(h),l.metadata.Unicode=l.metadata.Unicode||{encoding:{},kerning:{},widths:[]},l.metadata.glyIdsUsed=[0]})(r,i)}}])}(wi),function(e){function n(){return(xi.canvg?Promise.resolve(xi.canvg):nh(()=>import("./index.es.js"),[])).catch(function(t){return Promise.reject(new Error("Could not load canvg: "+t))}).then(function(t){return t.default?t.default:t})}wi.API.addSvgAsImage=function(t,i,r,o,l,h,p,m){if(isNaN(i)||isNaN(r))throw Kr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(o)||isNaN(l))throw Kr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var _=document.createElement("canvas");_.width=o,_.height=l;var w=_.getContext("2d");w.fillStyle="#fff",w.fillRect(0,0,_.width,_.height);var E={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},b=this;return n().then(function(D){return D.fromString(w,t,E)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(D){return D.render(E)}).then(function(){b.addImage(_.toDataURL("image/jpeg",1),i,r,o,l,p,m)})}}(),wi.API.putTotalPages=function(e){var n,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(n=new RegExp(e,"g"),t=this.internal.getNumberOfPages()):(n=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var i=1;i<=this.internal.getNumberOfPages();i++)for(var r=0;r<this.internal.pages[i].length;r++)this.internal.pages[i][r]=this.internal.pages[i][r].replace(n,t);return this},wi.API.viewerPreferences=function(e,n){var t;e=e||{},n=n||!1;var i,r,o,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},h=Object.keys(l),p=[],m=0,_=0,w=0;function E(D,j){var Q,F=!1;for(Q=0;Q<D.length;Q+=1)D[Q]===j&&(F=!0);return F}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,e==="reset"||n===!0){var b=h.length;for(w=0;w<b;w+=1)t[h[w]].value=t[h[w]].defaultValue,t[h[w]].explicitSet=!1}if(Fr(e)==="object"){for(r in e)if(o=e[r],E(h,r)&&o!==void 0){if(t[r].type==="boolean"&&typeof o=="boolean")t[r].value=o;else if(t[r].type==="name"&&E(t[r].valueSet,o))t[r].value=o;else if(t[r].type==="integer"&&Number.isInteger(o))t[r].value=o;else if(t[r].type==="array"){for(m=0;m<o.length;m+=1)if(i=!0,o[m].length===1&&typeof o[m][0]=="number")p.push(String(o[m]-1));else if(o[m].length>1){for(_=0;_<o[m].length;_+=1)typeof o[m][_]!="number"&&(i=!1);i===!0&&p.push([o[m][0]-1,o[m][1]-1].join(" "))}t[r].value="["+p.join(" ")+"]"}else t[r].value=t[r].defaultValue;t[r].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var D,j=[];for(D in t)t[D].explicitSet===!0&&(t[D].type==="name"?j.push("/"+D+" /"+t[D].value):j.push("/"+D+" "+t[D].value));j.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+j.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},function(e){var n=function(){var i='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',r=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(i)),l=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),h=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),p=unescape(encodeURIComponent("</x:xmpmeta>")),m=o.length+l.length+h.length+r.length+p.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+m+" >>"),this.internal.write("stream"),this.internal.write(r+o+l+h+p),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(i,r){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:i,namespaceuri:r||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",n)),this}}(wi.API),function(e){var n=e.API,t=n.pdfEscape16=function(o,l){for(var h,p=l.metadata.Unicode.widths,m=["","0","00","000","0000"],_=[""],w=0,E=o.length;w<E;++w){if(h=l.metadata.characterToGlyph(o.charCodeAt(w)),l.metadata.glyIdsUsed.push(h),l.metadata.toUnicode[h]=o.charCodeAt(w),p.indexOf(h)==-1&&(p.push(h),p.push([parseInt(l.metadata.widthOfGlyph(h),10)])),h=="0")return _.join("");h=h.toString(16),_.push(m[4-h.length],h)}return _.join("")},i=function(o){var l,h,p,m,_,w,E;for(_=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,p=[],w=0,E=(h=Object.keys(o).sort(function(b,D){return b-D})).length;w<E;w++)l=h[w],p.length>=100&&(_+=`
`+p.length+` beginbfchar
`+p.join(`
`)+`
endbfchar`,p=[]),o[l]!==void 0&&o[l]!==null&&typeof o[l].toString=="function"&&(m=("0000"+o[l].toString(16)).slice(-4),l=("0000"+(+l).toString(16)).slice(-4),p.push("<"+l+"><"+m+">"));return p.length&&(_+=`
`+p.length+` beginbfchar
`+p.join(`
`)+`
endbfchar
`),_+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};n.events.push(["putFont",function(o){(function(l){var h=l.font,p=l.out,m=l.newObject,_=l.putStream;if(h.metadata instanceof e.API.TTFFont&&h.encoding==="Identity-H"){for(var w=h.metadata.Unicode.widths,E=h.metadata.subset.encode(h.metadata.glyIdsUsed,1),b="",D=0;D<E.length;D++)b+=String.fromCharCode(E[D]);var j=m();_({data:b,addLength1:!0,objectId:j}),p("endobj");var Q=m();_({data:i(h.metadata.toUnicode),addLength1:!0,objectId:Q}),p("endobj");var F=m();p("<<"),p("/Type /FontDescriptor"),p("/FontName /"+Ih(h.fontName)),p("/FontFile2 "+j+" 0 R"),p("/FontBBox "+e.API.PDFObject.convert(h.metadata.bbox)),p("/Flags "+h.metadata.flags),p("/StemV "+h.metadata.stemV),p("/ItalicAngle "+h.metadata.italicAngle),p("/Ascent "+h.metadata.ascender),p("/Descent "+h.metadata.decender),p("/CapHeight "+h.metadata.capHeight),p(">>"),p("endobj");var V=m();p("<<"),p("/Type /Font"),p("/BaseFont /"+Ih(h.fontName)),p("/FontDescriptor "+F+" 0 R"),p("/W "+e.API.PDFObject.convert(w)),p("/CIDToGIDMap /Identity"),p("/DW 1000"),p("/Subtype /CIDFontType2"),p("/CIDSystemInfo"),p("<<"),p("/Supplement 0"),p("/Registry (Adobe)"),p("/Ordering ("+h.encoding+")"),p(">>"),p(">>"),p("endobj"),h.objectNumber=m(),p("<<"),p("/Type /Font"),p("/Subtype /Type0"),p("/ToUnicode "+Q+" 0 R"),p("/BaseFont /"+Ih(h.fontName)),p("/Encoding /"+h.encoding),p("/DescendantFonts ["+V+" 0 R]"),p(">>"),p("endobj"),h.isAlreadyPutted=!0}})(o)}]),n.events.push(["putFont",function(o){(function(l){var h=l.font,p=l.out,m=l.newObject,_=l.putStream;if(h.metadata instanceof e.API.TTFFont&&h.encoding==="WinAnsiEncoding"){for(var w=h.metadata.rawData,E="",b=0;b<w.length;b++)E+=String.fromCharCode(w[b]);var D=m();_({data:E,addLength1:!0,objectId:D}),p("endobj");var j=m();_({data:i(h.metadata.toUnicode),addLength1:!0,objectId:j}),p("endobj");var Q=m();p("<<"),p("/Descent "+h.metadata.decender),p("/CapHeight "+h.metadata.capHeight),p("/StemV "+h.metadata.stemV),p("/Type /FontDescriptor"),p("/FontFile2 "+D+" 0 R"),p("/Flags 96"),p("/FontBBox "+e.API.PDFObject.convert(h.metadata.bbox)),p("/FontName /"+Ih(h.fontName)),p("/ItalicAngle "+h.metadata.italicAngle),p("/Ascent "+h.metadata.ascender),p(">>"),p("endobj"),h.objectNumber=m();for(var F=0;F<h.metadata.hmtx.widths.length;F++)h.metadata.hmtx.widths[F]=parseInt(h.metadata.hmtx.widths[F]*(1e3/h.metadata.head.unitsPerEm));p("<</Subtype/TrueType/Type/Font/ToUnicode "+j+" 0 R/BaseFont/"+Ih(h.fontName)+"/FontDescriptor "+Q+" 0 R/Encoding/"+h.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(h.metadata.hmtx.widths)+">>"),p("endobj"),h.isAlreadyPutted=!0}})(o)}]);var r=function(o){var l,h=o.text||"",p=o.x,m=o.y,_=o.options||{},w=o.mutex||{},E=w.pdfEscape,b=w.activeFontKey,D=w.fonts,j=b,Q="",F=0,V="",pe=D[j].encoding;if(D[j].encoding!=="Identity-H")return{text:h,x:p,y:m,options:_,mutex:w};for(V=h,j=b,Array.isArray(h)&&(V=h[0]),F=0;F<V.length;F+=1)D[j].metadata.hasOwnProperty("cmap")&&(l=D[j].metadata.cmap.unicode.codeMap[V[F].charCodeAt(0)]),l||V[F].charCodeAt(0)<256&&D[j].metadata.hasOwnProperty("Unicode")?Q+=V[F]:Q+="";var Ee="";return parseInt(j.slice(1))<14||pe==="WinAnsiEncoding"?Ee=E(Q,j).split("").map(function(Ie){return Ie.charCodeAt(0).toString(16)}).join(""):pe==="Identity-H"&&(Ee=t(Q,D[j])),w.isHex=!0,{text:Ee,x:p,y:m,options:_,mutex:w}};n.events.push(["postProcessText",function(o){var l=o.text||"",h=[],p={text:l,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(l)){var m=0;for(m=0;m<l.length;m+=1)Array.isArray(l[m])&&l[m].length===3?h.push([r(Object.assign({},p,{text:l[m][0]})).text,l[m][1],l[m][2]]):h.push(r(Object.assign({},p,{text:l[m]})).text);o.text=h}else o.text=r(Object.assign({},p,{text:l})).text}])}(wi),function(e){var n=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(t){return n.call(this),this.internal.vFS[t]!==void 0},e.addFileToVFS=function(t,i){return n.call(this),this.internal.vFS[t]=i,this},e.getFileFromVFS=function(t){return n.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}}(wi.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(i){var r,o,l,h,p,m,_,w=n,E=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],b=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],D={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},j={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},Q=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],F=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),V=!1,pe=0;this.__bidiEngine__={};var Ee=function(G){var I=G.charCodeAt(),Y=I>>8,$=j[Y];return $!==void 0?w[256*$+(255&I)]:Y===252||Y===253?"AL":F.test(Y)?"L":Y===8?"R":"N"},Ie=function(G){for(var I,Y=0;Y<G.length;Y++){if((I=Ee(G.charAt(Y)))==="L")return!1;if(I==="R")return!0}return!1},nt=function(G,I,Y,$){var R,Z,se,ie,Ae=I[$];switch(Ae){case"L":case"R":V=!1;break;case"N":case"AN":break;case"EN":V&&(Ae="AN");break;case"AL":V=!0,Ae="R";break;case"WS":Ae="N";break;case"CS":$<1||$+1>=I.length||(R=Y[$-1])!=="EN"&&R!=="AN"||(Z=I[$+1])!=="EN"&&Z!=="AN"?Ae="N":V&&(Z="AN"),Ae=Z===R?Z:"N";break;case"ES":Ae=(R=$>0?Y[$-1]:"B")==="EN"&&$+1<I.length&&I[$+1]==="EN"?"EN":"N";break;case"ET":if($>0&&Y[$-1]==="EN"){Ae="EN";break}if(V){Ae="N";break}for(se=$+1,ie=I.length;se<ie&&I[se]==="ET";)se++;Ae=se<ie&&I[se]==="EN"?"EN":"N";break;case"NSM":if(l&&!h){for(ie=I.length,se=$+1;se<ie&&I[se]==="NSM";)se++;if(se<ie){var Te=G[$],ut=Te>=1425&&Te<=2303||Te===64286;if(R=I[se],ut&&(R==="R"||R==="AL")){Ae="R";break}}}Ae=$<1||(R=I[$-1])==="B"?"N":Y[$-1];break;case"B":V=!1,r=!0,Ae=pe;break;case"S":o=!0,Ae="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":V=!1;break;case"BN":Ae="N"}return Ae},We=function(G,I,Y){var $=G.split("");return Y&&O($,Y,{hiLevel:pe}),$.reverse(),I&&I.reverse(),$.join("")},O=function(G,I,Y){var $,R,Z,se,ie,Ae=-1,Te=G.length,ut=0,X=[],ke=pe?b:E,B=[];for(V=!1,r=!1,o=!1,R=0;R<Te;R++)B[R]=Ee(G[R]);for(Z=0;Z<Te;Z++){if(ie=ut,X[Z]=nt(G,B,X,Z),$=240&(ut=ke[ie][D[X[Z]]]),ut&=15,I[Z]=se=ke[ut][5],$>0)if($===16){for(R=Ae;R<Z;R++)I[R]=1;Ae=-1}else Ae=-1;if(ke[ut][6])Ae===-1&&(Ae=Z);else if(Ae>-1){for(R=Ae;R<Z;R++)I[R]=se;Ae=-1}B[Z]==="B"&&(I[Z]=0),Y.hiLevel|=se}o&&function(W,he,ne){for(var re=0;re<ne;re++)if(W[re]==="S"){he[re]=pe;for(var ee=re-1;ee>=0&&W[ee]==="WS";ee--)he[ee]=pe}}(B,I,Te)},H=function(G,I,Y,$,R){if(!(R.hiLevel<G)){if(G===1&&pe===1&&!r)return I.reverse(),void(Y&&Y.reverse());for(var Z,se,ie,Ae,Te=I.length,ut=0;ut<Te;){if($[ut]>=G){for(ie=ut+1;ie<Te&&$[ie]>=G;)ie++;for(Ae=ut,se=ie-1;Ae<se;Ae++,se--)Z=I[Ae],I[Ae]=I[se],I[se]=Z,Y&&(Z=Y[Ae],Y[Ae]=Y[se],Y[se]=Z);ut=ie}ut++}}},le=function(G,I,Y){var $=G.split(""),R={hiLevel:pe};return Y||(Y=[]),O($,Y,R),function(Z,se,ie){if(ie.hiLevel!==0&&_)for(var Ae,Te=0;Te<Z.length;Te++)se[Te]===1&&(Ae=Q.indexOf(Z[Te]))>=0&&(Z[Te]=Q[Ae+1])}($,Y,R),H(2,$,I,Y,R),H(1,$,I,Y,R),$.join("")};return this.__bidiEngine__.doBidiReorder=function(G,I,Y){if(function(R,Z){if(Z)for(var se=0;se<R.length;se++)Z[se]=se;h===void 0&&(h=Ie(R)),m===void 0&&(m=Ie(R))}(G,I),l||!p||m)if(l&&p&&h^m)pe=h?1:0,G=We(G,I,Y);else if(!l&&p&&m)pe=h?1:0,G=le(G,I,Y),G=We(G,I);else if(!l||h||p||m){if(l&&!p&&h^m)G=We(G,I),h?(pe=0,G=le(G,I,Y)):(pe=1,G=le(G,I,Y),G=We(G,I));else if(l&&h&&!p&&m)pe=1,G=le(G,I,Y),G=We(G,I);else if(!l&&!p&&h^m){var $=_;h?(pe=1,G=le(G,I,Y),pe=0,_=!1,G=le(G,I,Y),_=$):(pe=0,G=le(G,I,Y),G=We(G,I),pe=1,_=!1,G=le(G,I,Y),_=$,G=We(G,I))}}else pe=0,G=le(G,I,Y);else pe=h?1:0,G=le(G,I,Y);return G},this.__bidiEngine__.setOptions=function(G){G&&(l=G.isInputVisual,p=G.isOutputVisual,h=G.isInputRtl,m=G.isOutputRtl,_=G.isSymmetricSwapping)},this.__bidiEngine__.setOptions(i),this.__bidiEngine__};var n=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(i){var r=i.text,o=(i.x,i.y,i.options||{}),l=(i.mutex,o.lang,[]);if(o.isInputVisual=typeof o.isInputVisual!="boolean"||o.isInputVisual,t.setOptions(o),Object.prototype.toString.call(r)==="[object Array]"){var h=0;for(l=[],h=0;h<r.length;h+=1)Object.prototype.toString.call(r[h])==="[object Array]"?l.push([t.doBidiReorder(r[h][0]),r[h][1],r[h][2]]):l.push([t.doBidiReorder(r[h])]);i.text=l}else i.text=t.doBidiReorder(r);t.setOptions({isInputVisual:!0})}])}(wi),wi.API.TTFFont=function(){function e(n){var t;if(this.rawData=n,t=this.contents=new Mc(n),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new RN(this),this.registerTTF()}return e.open=function(n){return new e(n)},e.prototype.parse=function(){return this.directory=new wN(this.contents),this.head=new LN(this),this.name=new AN(this),this.cmap=new G4(this),this.toUnicode={},this.hhea=new CN(this),this.maxp=new kN(this),this.hmtx=new MN(this),this.post=new PN(this),this.os2=new SN(this),this.loca=new DN(this),this.glyf=new TN(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var n,t,i,r,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var l,h,p,m;for(m=[],l=0,h=(p=this.bbox).length;l<h;l++)n=p[l],m.push(Math.round(n*this.scaleFactor));return m}).call(this),this.stemV=0,this.post.exists?(i=255&(r=this.post.italic_angle),32768&(t=r>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+i)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(o=this.familyClass)===1||o===2||o===3||o===4||o===5||o===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(n){var t;return((t=this.cmap.unicode)!=null?t.codeMap[n]:void 0)||0},e.prototype.widthOfGlyph=function(n){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(n).advance*t},e.prototype.widthOfString=function(n,t,i){var r,o,l,h;for(l=0,o=0,h=(n=""+n).length;0<=h?o<h:o>h;o=0<=h?++o:--o)r=n.charCodeAt(o),l+=this.widthOfGlyph(this.characterToGlyph(r))+i*(1e3/t)||0;return l*(t/1e3)},e.prototype.lineHeight=function(n,t){var i;return t==null&&(t=!1),i=t?this.lineGap:0,(this.ascender+i-this.decender)/1e3*n},e}();var su,Mc=function(){function e(n){this.data=n??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(n){return this.data[this.pos++]=n},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(n){return this.writeByte(n>>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt32=function(){var n;return(n=this.readUInt32())>=2147483648?n-4294967296:n},e.prototype.writeInt32=function(n){return n<0&&(n+=4294967296),this.writeUInt32(n)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(n){return this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt16=function(){var n;return(n=this.readUInt16())>=32768?n-65536:n},e.prototype.writeInt16=function(n){return n<0&&(n+=65536),this.writeUInt16(n)},e.prototype.readString=function(n){var t,i;for(i=[],t=0;0<=n?t<n:t>n;t=0<=n?++t:--t)i[t]=String.fromCharCode(this.readByte());return i.join("")},e.prototype.writeString=function(n){var t,i,r;for(r=[],t=0,i=n.length;0<=i?t<i:t>i;t=0<=i?++t:--t)r.push(this.writeByte(n.charCodeAt(t)));return r},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(n){return this.writeInt16(n)},e.prototype.readLongLong=function(){var n,t,i,r,o,l,h,p;return n=this.readByte(),t=this.readByte(),i=this.readByte(),r=this.readByte(),o=this.readByte(),l=this.readByte(),h=this.readByte(),p=this.readByte(),128&n?-1*(72057594037927940*(255^n)+281474976710656*(255^t)+1099511627776*(255^i)+4294967296*(255^r)+16777216*(255^o)+65536*(255^l)+256*(255^h)+(255^p)+1):72057594037927940*n+281474976710656*t+1099511627776*i+4294967296*r+16777216*o+65536*l+256*h+p},e.prototype.writeLongLong=function(n){var t,i;return t=Math.floor(n/4294967296),i=4294967295&n,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(i>>24&255),this.writeByte(i>>16&255),this.writeByte(i>>8&255),this.writeByte(255&i)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(n){return this.writeInt32(n)},e.prototype.read=function(n){var t,i;for(t=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)t.push(this.readByte());return t},e.prototype.write=function(n){var t,i,r,o;for(o=[],i=0,r=n.length;i<r;i++)t=n[i],o.push(this.writeByte(t));return o},e}(),wN=function(){var e;function n(t){var i,r,o;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},r=0,o=this.tableCount;0<=o?r<o:r>o;r=0<=o?++r:--r)i={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[i.tag]=i}return n.prototype.encode=function(t){var i,r,o,l,h,p,m,_,w,E,b,D,j;for(j in b=Object.keys(t).length,p=Math.log(2),w=16*Math.floor(Math.log(b)/p),l=Math.floor(w/p),_=16*b-w,(r=new Mc).writeInt(this.scalarType),r.writeShort(b),r.writeShort(w),r.writeShort(l),r.writeShort(_),o=16*b,m=r.pos+o,h=null,D=[],t)for(E=t[j],r.writeString(j),r.writeInt(e(E)),r.writeInt(m),r.writeInt(E.length),D=D.concat(E),j==="head"&&(h=m),m+=E.length;m%4;)D.push(0),m++;return r.write(D),i=2981146554-e(r.data),r.pos=h+8,r.writeUInt32(i),r.data},e=function(t){var i,r,o,l;for(t=V4.call(t);t.length%4;)t.push(0);for(o=new Mc(t),r=0,i=0,l=t.length;i<l;i=i+=4)r+=o.readUInt32();return 4294967295&r},n}(),xN={}.hasOwnProperty,Mu=function(e,n){for(var t in n)xN.call(n,t)&&(e[t]=n[t]);function i(){this.constructor=e}return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};su=function(){function e(n){var t;this.file=n,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var LN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,su),n.prototype.tag="head",n.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},n.prototype.encode=function(t){var i;return(i=new Mc).writeInt(this.version),i.writeInt(this.revision),i.writeInt(this.checkSumAdjustment),i.writeInt(this.magicNumber),i.writeShort(this.flags),i.writeShort(this.unitsPerEm),i.writeLongLong(this.created),i.writeLongLong(this.modified),i.writeShort(this.xMin),i.writeShort(this.yMin),i.writeShort(this.xMax),i.writeShort(this.yMax),i.writeShort(this.macStyle),i.writeShort(this.lowestRecPPEM),i.writeShort(this.fontDirectionHint),i.writeShort(t),i.writeShort(this.glyphDataFormat),i.data},n}(),Wy=function(){function e(n,t){var i,r,o,l,h,p,m,_,w,E,b,D,j,Q,F,V,pe;switch(this.platformID=n.readUInt16(),this.encodingID=n.readShort(),this.offset=t+n.readInt(),w=n.pos,n.pos=this.offset,this.format=n.readUInt16(),this.length=n.readUInt16(),this.language=n.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(p=0;p<256;++p)this.codeMap[p]=n.readByte();break;case 4:for(b=n.readUInt16(),E=b/2,n.pos+=6,o=function(){var Ee,Ie;for(Ie=[],p=Ee=0;0<=E?Ee<E:Ee>E;p=0<=E?++Ee:--Ee)Ie.push(n.readUInt16());return Ie}(),n.pos+=2,j=function(){var Ee,Ie;for(Ie=[],p=Ee=0;0<=E?Ee<E:Ee>E;p=0<=E?++Ee:--Ee)Ie.push(n.readUInt16());return Ie}(),m=function(){var Ee,Ie;for(Ie=[],p=Ee=0;0<=E?Ee<E:Ee>E;p=0<=E?++Ee:--Ee)Ie.push(n.readUInt16());return Ie}(),_=function(){var Ee,Ie;for(Ie=[],p=Ee=0;0<=E?Ee<E:Ee>E;p=0<=E?++Ee:--Ee)Ie.push(n.readUInt16());return Ie}(),r=(this.length-n.pos+this.offset)/2,h=function(){var Ee,Ie;for(Ie=[],p=Ee=0;0<=r?Ee<r:Ee>r;p=0<=r?++Ee:--Ee)Ie.push(n.readUInt16());return Ie}(),p=F=0,pe=o.length;F<pe;p=++F)for(Q=o[p],i=V=D=j[p];D<=Q?V<=Q:V>=Q;i=D<=Q?++V:--V)_[p]===0?l=i+m[p]:(l=h[_[p]/2+(i-D)-(E-p)]||0)!==0&&(l+=m[p]),this.codeMap[i]=65535&l}n.pos=w}return e.encode=function(n,t){var i,r,o,l,h,p,m,_,w,E,b,D,j,Q,F,V,pe,Ee,Ie,nt,We,O,H,le,G,I,Y,$,R,Z,se,ie,Ae,Te,ut,X,ke,B,W,he,ne,re,ee,oe,Se,te;switch($=new Mc,l=Object.keys(n).sort(function(ae,Le){return ae-Le}),t){case"macroman":for(j=0,Q=function(){var ae=[];for(D=0;D<256;++D)ae.push(0);return ae}(),V={0:0},o={},R=0,Ae=l.length;R<Ae;R++)V[ee=n[r=l[R]]]==null&&(V[ee]=++j),o[r]={old:n[r],new:V[n[r]]},Q[r]=V[n[r]];return $.writeUInt16(1),$.writeUInt16(0),$.writeUInt32(12),$.writeUInt16(0),$.writeUInt16(262),$.writeUInt16(0),$.write(Q),{charMap:o,subtable:$.data,maxGlyphID:j+1};case"unicode":for(I=[],w=[],pe=0,V={},i={},F=m=null,Z=0,Te=l.length;Z<Te;Z++)V[Ie=n[r=l[Z]]]==null&&(V[Ie]=++pe),i[r]={old:Ie,new:V[Ie]},h=V[Ie]-r,F!=null&&h===m||(F&&w.push(F),I.push(r),m=h),F=r;for(F&&w.push(F),w.push(65535),I.push(65535),le=2*(H=I.length),O=2*Math.pow(Math.log(H)/Math.LN2,2),E=Math.log(O/2)/Math.LN2,We=2*H-O,p=[],nt=[],b=[],D=se=0,ut=I.length;se<ut;D=++se){if(G=I[D],_=w[D],G===65535){p.push(0),nt.push(0);break}if(G-(Y=i[G].new)>=32768)for(p.push(0),nt.push(2*(b.length+H-D)),r=ie=G;G<=_?ie<=_:ie>=_;r=G<=_?++ie:--ie)b.push(i[r].new);else p.push(Y-G),nt.push(0)}for($.writeUInt16(3),$.writeUInt16(1),$.writeUInt32(12),$.writeUInt16(4),$.writeUInt16(16+8*H+2*b.length),$.writeUInt16(0),$.writeUInt16(le),$.writeUInt16(O),$.writeUInt16(E),$.writeUInt16(We),ne=0,X=w.length;ne<X;ne++)r=w[ne],$.writeUInt16(r);for($.writeUInt16(0),re=0,ke=I.length;re<ke;re++)r=I[re],$.writeUInt16(r);for(oe=0,B=p.length;oe<B;oe++)h=p[oe],$.writeUInt16(h);for(Se=0,W=nt.length;Se<W;Se++)Ee=nt[Se],$.writeUInt16(Ee);for(te=0,he=b.length;te<he;te++)j=b[te],$.writeUInt16(j);return{charMap:i,subtable:$.data,maxGlyphID:pe+1}}},e}(),G4=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,su),n.prototype.tag="cmap",n.prototype.parse=function(t){var i,r,o;for(t.pos=this.offset,this.version=t.readUInt16(),o=t.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=o?r<o:r>o;r=0<=o?++r:--r)i=new Wy(t,this.offset),this.tables.push(i),i.isUnicode&&this.unicode==null&&(this.unicode=i);return!0},n.encode=function(t,i){var r,o;return i==null&&(i="macroman"),r=Wy.encode(t,i),(o=new Mc).writeUInt16(0),o.writeUInt16(1),r.table=o.data.concat(r.subtable),r},n}(),CN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,su),n.prototype.tag="hhea",n.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},n}(),SN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,su),n.prototype.tag="OS/2",n.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var i,r;for(r=[],i=0;i<10;++i)r.push(t.readByte());return r}(),this.charRange=function(){var i,r;for(r=[],i=0;i<4;++i)r.push(t.readInt());return r}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var i,r;for(r=[],i=0;i<2;i=++i)r.push(t.readInt());return r}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},n}(),PN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,su),n.prototype.tag="post",n.prototype.parse=function(t){var i,r,o;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:break;case 131072:var l;for(r=t.readUInt16(),this.glyphNameIndex=[],l=0;0<=r?l<r:l>r;l=0<=r?++l:--l)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],o=[];t.pos<this.offset+this.length;)i=t.readByte(),o.push(this.names.push(t.readString(i)));return o;case 151552:return r=t.readUInt16(),this.offsets=t.read(r);case 196608:break;case 262144:return this.map=(function(){var h,p,m;for(m=[],l=h=0,p=this.file.maxp.numGlyphs;0<=p?h<p:h>p;l=0<=p?++h:--h)m.push(t.readUInt32());return m}).call(this)}},n}(),EN=function(e,n){this.raw=e,this.length=e.length,this.platformID=n.platformID,this.encodingID=n.encodingID,this.languageID=n.languageID},AN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,su),n.prototype.tag="name",n.prototype.parse=function(t){var i,r,o,l,h,p,m,_,w,E,b;for(t.pos=this.offset,t.readShort(),i=t.readShort(),p=t.readShort(),r=[],l=0;0<=i?l<i:l>i;l=0<=i?++l:--l)r.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+p+t.readShort()});for(m={},l=w=0,E=r.length;w<E;l=++w)o=r[l],t.pos=o.offset,_=t.readString(o.length),h=new EN(_,o),m[b=o.nameID]==null&&(m[b]=[]),m[o.nameID].push(h);this.strings=m,this.copyright=m[0],this.fontFamily=m[1],this.fontSubfamily=m[2],this.uniqueSubfamily=m[3],this.fontName=m[4],this.version=m[5];try{this.postscriptName=m[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=m[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=m[7],this.manufacturer=m[8],this.designer=m[9],this.description=m[10],this.vendorUrl=m[11],this.designerUrl=m[12],this.license=m[13],this.licenseUrl=m[14],this.preferredFamily=m[15],this.preferredSubfamily=m[17],this.compatibleFull=m[18],this.sampleText=m[19]},n}(),kN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,su),n.prototype.tag="maxp",n.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},n}(),MN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,su),n.prototype.tag="hmtx",n.prototype.parse=function(t){var i,r,o,l,h,p,m;for(t.pos=this.offset,this.metrics=[],i=0,p=this.file.hhea.numberOfMetrics;0<=p?i<p:i>p;i=0<=p?++i:--i)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(o=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var _,w;for(w=[],i=_=0;0<=o?_<o:_>o;i=0<=o?++_:--_)w.push(t.readInt16());return w}(),this.widths=(function(){var _,w,E,b;for(b=[],_=0,w=(E=this.metrics).length;_<w;_++)l=E[_],b.push(l.advance);return b}).call(this),r=this.widths[this.widths.length-1],m=[],i=h=0;0<=o?h<o:h>o;i=0<=o?++h:--h)m.push(this.widths.push(r));return m},n.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},n}(),V4=[].slice,TN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,su),n.prototype.tag="glyf",n.prototype.parse=function(){return this.cache={}},n.prototype.glyphFor=function(t){var i,r,o,l,h,p,m,_,w,E;return t in this.cache?this.cache[t]:(l=this.file.loca,i=this.file.contents,r=l.indexOf(t),(o=l.lengthOf(t))===0?this.cache[t]=null:(i.pos=this.offset+r,h=(p=new Mc(i.read(o))).readShort(),_=p.readShort(),E=p.readShort(),m=p.readShort(),w=p.readShort(),this.cache[t]=h===-1?new NN(p,_,E,m,w):new BN(p,h,_,E,m,w),this.cache[t]))},n.prototype.encode=function(t,i,r){var o,l,h,p,m;for(h=[],l=[],p=0,m=i.length;p<m;p++)o=t[i[p]],l.push(h.length),o&&(h=h.concat(o.encode(r)));return l.push(h.length),{table:h,offsets:l}},n}(),BN=function(){function e(n,t,i,r,o,l){this.raw=n,this.numberOfContours=t,this.xMin=i,this.yMin=r,this.xMax=o,this.yMax=l,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),NN=function(){function e(n,t,i,r,o){var l,h;for(this.raw=n,this.xMin=t,this.yMin=i,this.xMax=r,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],l=this.raw;h=l.readShort(),this.glyphOffsets.push(l.pos),this.glyphIDs.push(l.readUInt16()),32&h;)l.pos+=1&h?4:2,128&h?l.pos+=8:64&h?l.pos+=4:8&h&&(l.pos+=2)}return e.prototype.encode=function(){var n,t,i;for(t=new Mc(V4.call(this.raw.data)),n=0,i=this.glyphIDs.length;n<i;++n)t.pos=this.glyphOffsets[n];return t.data},e}(),DN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,su),n.prototype.tag="loca",n.prototype.parse=function(t){var i,r;return t.pos=this.offset,i=this.file.head.indexToLocFormat,this.offsets=i===0?(function(){var o,l;for(l=[],r=0,o=this.length;r<o;r+=2)l.push(2*t.readUInt16());return l}).call(this):(function(){var o,l;for(l=[],r=0,o=this.length;r<o;r+=4)l.push(t.readUInt32());return l}).call(this)},n.prototype.indexOf=function(t){return this.offsets[t]},n.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},n.prototype.encode=function(t,i){for(var r=new Uint32Array(this.offsets.length),o=0,l=0,h=0;h<r.length;++h)if(r[h]=o,l<i.length&&i[l]==h){++l,r[h]=o;var p=this.offsets[h],m=this.offsets[h+1]-p;m>0&&(o+=m)}for(var _=new Array(4*r.length),w=0;w<r.length;++w)_[4*w+3]=255&r[w],_[4*w+2]=(65280&r[w])>>8,_[4*w+1]=(16711680&r[w])>>16,_[4*w]=(4278190080&r[w])>>24;return _},n}(),RN=function(){function e(n){this.font=n,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var n,t,i,r,o;for(t in r=this.font.cmap.tables[0].codeMap,n={},o=this.subset)i=o[t],n[t]=r[i];return n},e.prototype.glyphsFor=function(n){var t,i,r,o,l,h,p;for(r={},l=0,h=n.length;l<h;l++)r[o=n[l]]=this.font.glyf.glyphFor(o);for(o in t=[],r)(i=r[o])!=null&&i.compound&&t.push.apply(t,i.glyphIDs);if(t.length>0)for(o in p=this.glyphsFor(t))i=p[o],r[o]=i;return r},e.prototype.encode=function(n,t){var i,r,o,l,h,p,m,_,w,E,b,D,j,Q,F;for(r in i=G4.encode(this.generateCmap(),"unicode"),l=this.glyphsFor(n),b={0:0},F=i.charMap)b[(p=F[r]).old]=p.new;for(D in E=i.maxGlyphID,l)D in b||(b[D]=E++);return _=function(V){var pe,Ee;for(pe in Ee={},V)Ee[V[pe]]=pe;return Ee}(b),w=Object.keys(_).sort(function(V,pe){return V-pe}),j=function(){var V,pe,Ee;for(Ee=[],V=0,pe=w.length;V<pe;V++)h=w[V],Ee.push(_[h]);return Ee}(),o=this.font.glyf.encode(l,j,b),m=this.font.loca.encode(o.offsets,j),Q={cmap:this.font.cmap.raw(),glyf:o.table,loca:m,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(Q["OS/2"]=this.font.os2.raw()),this.font.directory.encode(Q)},e}();wi.API.PDFObject=function(){var e;function n(){}return e=function(t,i){return(Array(i+1).join("0")+t).slice(-i)},n.convert=function(t){var i,r,o,l;if(Array.isArray(t))return"["+function(){var h,p,m;for(m=[],h=0,p=t.length;h<p;h++)i=t[h],m.push(n.convert(i));return m}().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+e(t.getUTCFullYear(),4)+e(t.getUTCMonth(),2)+e(t.getUTCDate(),2)+e(t.getUTCHours(),2)+e(t.getUTCMinutes(),2)+e(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(r in o=["<<"],t)l=t[r],o.push("/"+r+" "+n.convert(l));return o.push(">>"),o.join(`
`)}return""+t},n}();const ON={class:"h-full flex"},IN={class:"flex-1 relative"},FN={key:0,class:"absolute inset-0 bg-black/30 backdrop-blur-sm z-[2000] flex items-center justify-center"},zN={key:1,class:"absolute inset-0 flex items-center justify-center bg-gray-50 z-[3000]"},jN={class:"text-center max-w-lg mx-auto p-8"},UN={class:"space-y-4"},$N={class:"map-parent"},qN={key:0,class:"fixed top-16 left-0 right-0 z-[1500]"},GN={class:"map-content flex"},VN={class:"flex-1 relative"},HN={key:0,class:"w-64 bg-white border-l border-gray-200 flex-shrink-0 z-[2000]"},WN={key:0,class:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-75 z-50"},ZN={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center z-[9999] p-4 overflow-y-auto"},KN={class:"bg-white rounded-lg p-6 max-w-2xl w-full my-8 relative"},JN={class:"flex justify-between items-center mb-4 sticky top-0 bg-white pb-4 border-b"},YN={class:"overflow-y-auto max-h-[calc(100vh-12rem)]"},XN={key:0,class:"space-y-4"},QN={key:0,class:"space-y-2"},eD={class:"grid grid-cols-1 gap-2"},tD=["onClick"],nD={class:"font-medium text-gray-900"},iD={key:1,class:"space-y-2"},rD={class:"flex items-center mb-4"},sD={class:"text-sm text-gray-600"},oD={class:"grid grid-cols-1 gap-2"},aD=["onClick"],lD={class:"font-medium text-gray-900"},uD={key:2,class:"space-y-2"},cD={class:"flex items-center mb-4"},hD={class:"text-sm text-gray-600"},fD={class:"grid grid-cols-1 gap-2"},dD={key:0,class:"text-center py-8"},pD=["onClick"],gD={class:"font-medium text-gray-900"},mD={key:3,class:"space-y-2"},vD={class:"flex items-center mb-4"},yD={class:"text-sm text-gray-600"},_D={class:"grid grid-cols-1 gap-2"},bD=["onClick"],wD={class:"font-medium text-gray-900"},xD={class:"text-sm text-gray-500"},LD={class:"text-xs text-gray-400 mt-1"},CD={key:1,class:"space-y-4"},SD={key:0,class:"space-y-2"},PD={class:"grid grid-cols-1 gap-2"},ED={key:0,class:"text-center py-8"},AD=["onClick"],kD={class:"font-medium text-gray-900"},MD={key:1,class:"space-y-2"},TD={class:"flex items-center mb-4"},BD={class:"text-sm text-gray-600"},ND={class:"grid grid-cols-1 gap-2"},DD=["onClick"],RD={class:"font-medium text-gray-900"},OD={class:"text-sm text-gray-500"},ID={class:"text-xs text-gray-400 mt-1"},FD={key:2,class:"space-y-4"},zD={key:3,class:"space-y-4"},jD={key:0,class:"text-center py-8"},UD={key:1,class:"space-y-2"},$D=["onClick"],qD={class:"font-medium text-gray-900"},GD={class:"text-sm text-gray-500"},VD={class:"text-xs text-gray-400 mt-1"},Zy=Pa({__name:"MapView",emits:["shape-selected"],setup(e,{emit:n}){const t=Yt(null),i=Lm(),r=L4(),o=Yt([]),{currentTool:l,selectedShape:h,map:p,initMap:m,setDrawingTool:_,updateShapeStyle:w,updateShapeProperties:E,featureGroup:b,adjustView:D,clearActiveControlPoints:j,calculateConnectedCoverageArea:Q}=x4(),{initMap:F,changeBaseMap:V}=f7(),pe=Yt(!1),Ee=Yt(!1),Ie=Yt(null),nt=Yt(!1),We=Yt(null),O=Va(),H=Yt([]),le=Yt([]),G=Yt([]),I=Yt(null),Y=Yt(null),$=Yt(!1),R=Yt(!1),Z=Yt(!1),se=Yt(null),ie=Di(()=>{var it,Ke;return console.log("[MapView][filteredClients] Computing with:",{userType:(it=O.user)==null?void 0:it.user_type,selectedConcessionnaire:I.value,concessionnaireAgriculteurs:le.value,agriculteurCount:((Ke=le.value)==null?void 0:Ke.length)||0}),O.isConcessionnaire||I.value?le.value:[]}),Ae=Di(()=>{var xn,wn,ot;if(!h.value)return null;console.log("[MapView][selectedShape] Initial layer state:",{layer:h.value,hasName:"name"in h.value,name:h.value.name,hasProperties:"properties"in h.value,propertiesName:(xn=h.value.properties)==null?void 0:xn.name,allLayerKeys:Object.keys(h.value),allPropertiesKeys:h.value.properties?Object.keys(h.value.properties):[],_leaflet_id:h.value._leaflet_id,_dbId:h.value._dbId,descriptor:Object.getOwnPropertyDescriptor(h.value,"name")});const it=h.value.properties||{};let Ke;if(it.style&&it.style.name)Ke=it.style.name,console.log("[MapView][selectedShape] Using name from style:",Ke);else if(it.name)Ke=it.name,console.log("[MapView][selectedShape] Using name from properties:",Ke);else if(h.value.name)Ke=h.value.name,console.log("[MapView][selectedShape] Using name from layer:",Ke);else{const de=Object.getOwnPropertyDescriptor(h.value,"name");de&&de.value&&(Ke=de.value,console.log("[MapView][selectedShape] Found name in non-enumerable layer property:",Ke));const _e=["_name","displayName","title"];for(const $e of _e)if(h.value[$e]){Ke=h.value[$e],console.log(`[MapView][selectedShape] Found name in ${$e}:`,Ke);break}}Ke&&(console.log(`[MapView][selectedShape] Ensuring name "${Ke}" is set everywhere`),h.value.properties||(h.value.properties={}),h.value.properties.name=Ke,h.value.properties.style||(h.value.properties.style={}),h.value.properties.style.name=Ke,h.value.name=Ke,typeof h.value.setName=="function"&&(h.value.setName(Ke),console.log(`[MapView][selectedShape] Used setName method to set name "${Ke}"`))),console.log("[MapView][selectedShape] Preparing properties for DrawingTools:",{type:it.type,name:it.name,foundName:Ke,hasNameProperty:"name"in it,allPropertiesKeys:Object.keys(it),layerId:h.value._leaflet_id,rawProperties:it,layerName:h.value.name,layerPropertiesName:(wn=h.value.properties)==null?void 0:wn.name});const qt={...it,name:Ke||h.value.name||it.name||void 0},mn={type:qt.type||"unknown",properties:qt,layer:h.value};return console.log("[MapView][selectedShape] Final shape object for DrawingTools:",{type:mn.type,hasName:"name"in mn.properties,name:mn.properties.name,layerName:mn.layer.name,layerPropertiesName:(ot=mn.layer.properties)==null?void 0:ot.name}),mn});function Te(it){const Ke=it.getCenter(),qt=it.getZoom(),mn={lat:Ke.lat,lng:Ke.lng,zoom:qt};document.cookie=`mapState=${JSON.stringify(mn)};max-age=2592000;path=/`}function ut(){const Ke=document.cookie.split(";").find(qt=>qt.trim().startsWith("mapState="));if(Ke)try{return JSON.parse(Ke.split("=")[1])}catch(qt){return console.error("Erreur lors de la lecture du cookie de position:",qt),null}return null}Ha(async()=>{var it,Ke;try{if(await i.fetchPlans(),(O.isAdmin||O.isUsine)&&await Qe(),O.isUsine){$.value=!0;try{const ot=await ii.get("/users/",{params:{role:"CONCESSIONNAIRE",usine:(it=O.user)==null?void 0:it.id}});H.value=ot.data}catch(ot){console.error("Error loading concessionnaires:",ot),H.value=[]}finally{$.value=!1}}if(O.isConcessionnaire){R.value=!0;try{const ot=await O.fetchConcessionnaireAgriculteurs(((Ke=O.user)==null?void 0:Ke.id)||0);le.value=Array.isArray(ot)?ot:[ot]}catch(ot){console.error("Error loading clients:",ot)}finally{R.value=!1}}const qt=ut(),mn=qt?[qt.lat,qt.lng]:[46.603354,1.888334],xn=(qt==null?void 0:qt.zoom)??6;if(t.value&&!p.value){const ot=m(t.value,mn,xn);ot.pm.setLang("fr"),ot.pm.addControls({rotateMode:!1}),F(ot),ot.on("moveend",()=>{Te(ot)}),window.addEventListener("map-set-location",de=>{if(ot&&de.detail){const{lat:_e,lng:$e,zoom:Gt}=de.detail;ot.flyTo([_e,$e],Gt,{duration:1.5,easeLinearity:.25})}})}const wn=localStorage.getItem("lastPlanId");if(wn)try{console.log("[MapView][onMounted] Chargement immédiat du dernier plan:",wn),await B(parseInt(wn));const ot=document.querySelector(".map-parent");ot instanceof HTMLElement&&(ot.style.display="block")}catch(ot){console.error("[MapView][onMounted] Erreur chargement dernier plan:",ot),Ie.value=null,i.clearCurrentPlan(),r.clearCurrentPlan(),X(),localStorage.removeItem("lastPlanId")}else console.log("[MapView][onMounted] Aucun dernier plan à charger"),Ie.value=null,i.clearCurrentPlan(),r.clearCurrentPlan(),X();window.addEventListener("shape:created",ot=>{const{shape:de,type:_e,properties:$e}=ot.detail;console.log("[MapView] Nouvelle forme créée",{shape:de,type:_e,properties:$e}),r.addElement(de),_("")})}catch(qt){console.error("Error during component mount:",qt),Ie.value=null,i.clearCurrentPlan(),r.clearCurrentPlan(),X(),localStorage.removeItem("lastPlanId")}}),Ur(()=>r.hasUnsavedChanges,it=>{console.log("[MapView][watch drawingStore.hasUnsavedChanges]",it),it&&Ie.value&&i.markUnsavedChanges()}),Ur(p,async it=>{var Ke;console.log(`
[MapView][watch map] Nouvelle carte:`,!!it),it&&i.currentPlan&&!((Ke=b.value)!=null&&Ke.getLayers().length)&&(console.log("[MapView][watch map] Chargement initial des éléments du plan:",i.currentPlan.id),X(),await r.loadPlanElements(i.currentPlan.id))}),Ur(()=>i.currentPlan,async(it,Ke)=>{var qt,mn,xn;if((it==null?void 0:it.id)===(Ke==null?void 0:Ke.id)){console.log("[MapView][watch currentPlan] Plan identique, pas de rechargement nécessaire");return}console.log(`
[MapView][watch currentPlan] ====== CHANGEMENT DE PLAN ======`),console.log("[MapView][watch currentPlan] Nouveau plan:",it==null?void 0:it.id);try{if(it){console.log("[MapView][watch currentPlan] Mise à jour du plan courant..."),Ie.value=it;const wn=document.querySelector(".map-parent");wn instanceof HTMLElement&&(wn.style.display="block"),console.log("[MapView][watch currentPlan] Plan mis à jour avec succès")}else{console.log("[MapView][watch currentPlan] Nettoyage du plan courant..."),Ie.value=null,X();const wn=document.querySelector(".map-parent");wn instanceof HTMLElement&&(wn.style.display="none")}}catch(wn){console.error("[MapView][watch currentPlan] ERREUR:",wn),Ie.value=null,X()}console.log("[MapView][watch currentPlan] État final:",{currentPlanId:(qt=Ie.value)==null?void 0:qt.id,storePlanId:(mn=i.currentPlan)==null?void 0:mn.id,mapVisible:p.value!==null,mapParentDisplay:(xn=document.querySelector(".map-parent"))==null?void 0:xn.getAttribute("style")}),console.log(`[MapView][watch currentPlan] ====== FIN CHANGEMENT ======
`)},{immediate:!0}),Ap(()=>{p.value&&p.value.off("moveend"),window.removeEventListener("shape:created",()=>{})});function X(){b.value&&b.value.clearLayers(),o.value=[],j(),h.value=null,l.value=""}async function ke(it){return await At.measureAsync("refreshMapWithPlan",async()=>{try{At.measure("refreshMapWithPlan:clearMap",()=>{X()},"MapView"),await At.measureAsync("refreshMapWithPlan:loadPlanElements",async()=>{await r.loadPlanElements(it)},"MapView");const Ke=At.measure("refreshMapWithPlan:getPlanById",()=>i.getPlanById(it),"MapView");Ke?(At.measure("refreshMapWithPlan:updateCurrentPlan",()=>{Ie.value=Ke,i.setCurrentPlan(Ke),r.setCurrentPlan(Ke.id),localStorage.setItem("lastPlanId",Ke.id.toString())},"MapView"),p.value&&b.value&&await At.measureAsync("refreshMapWithPlan:addShapesToMap",async()=>{console.log("[MapView][refreshMapWithPlan] Éléments disponibles:",{count:r.getCurrentElements.length,elements:r.getCurrentElements.map(wn=>{var ot;return{id:wn.id,type:wn.type_forme,hasName:wn.data&&"name"in wn.data,name:(ot=wn.data)==null?void 0:ot.name}})});const qt=r.getCurrentElements.reduce((wn,ot)=>(wn[ot.type_forme]||(wn[ot.type_forme]=[]),wn[ot.type_forme].push(ot),wn),{}),mn=10,xn=Object.entries(qt).map(async([wn,ot])=>{for(let de=0;de<ot.length;de+=mn){const _e=ot.slice(de,de+mn);await Promise.all(_e.map(async $e=>{await At.measureAsync(`refreshMapWithPlan:createElement:${$e.type_forme}`,async()=>{var Dn,Ln;if(!b.value||!$e.data)return;let Gt=null;switch($e.type_forme){case"TextRectangle":{const bt=$e.data;if(!bt.bounds)return;const _n=St.latLngBounds(St.latLng(bt.bounds.southWest[1],bt.bounds.southWest[0]),St.latLng(bt.bounds.northEast[1],bt.bounds.northEast[0]));Gt=new Jl(_n,bt.content||"Double-cliquez pour éditer",{...bt.style,textStyle:bt.style.textStyle}),bt.rotation&&typeof Gt.setRotation=="function"&&Gt.setRotation(bt.rotation),bt.name&&(Gt.properties={name:bt.name},Gt.name=bt.name);break}case"Circle":{const bt=$e.data;bt.center&&bt.radius&&(Gt=new Xc(St.latLng(bt.center[1],bt.center[0]),{...bt.style,radius:bt.radius}),bt.name&&(Gt.properties={type:"Circle",name:bt.name,style:bt.style,radius:bt.radius,diameter:bt.radius*2,surface:Math.PI*bt.radius*bt.radius,perimeter:2*Math.PI*bt.radius},Gt.name=bt.name));break}case"Semicircle":{const bt=$e.data;if(bt.center&&bt.radius){const _n=St.latLng(bt.center[1],bt.center[0]);Gt=new Lu(_n,bt.radius,bt.startAngle||0,bt.endAngle||180,{...bt.style}),Gt.properties={type:"Semicircle",radius:bt.radius,startAngle:bt.startAngle||0,stopAngle:bt.endAngle||180,style:{...bt.style||{},name:((Dn=bt.style)==null?void 0:Dn.name)||""},center:_n};const $n=((bt.endAngle||180)-(bt.startAngle||0)+360)%360,ni=Math.PI*Math.pow(bt.radius,2)*$n/360,ri=2*Math.PI*bt.radius*$n/360,Li=ri+2*bt.radius;Gt.properties.surface=ni,Gt.properties.arcLength=ri,Gt.properties.perimeter=Li,Gt.properties.openingAngle=$n,Gt.properties.diameter=bt.radius*2,Gt.updateProperties()}break}case"Rectangle":{const bt=$e.data;if(bt.bounds){const _n=St.latLngBounds(St.latLng(bt.bounds.southWest[1],bt.bounds.southWest[0]),St.latLng(bt.bounds.northEast[1],bt.bounds.northEast[0]));Gt=new Uo(_n,bt.style),bt.name&&(Gt.properties={name:bt.name},Gt.name=bt.name)}break}case"Polygon":{const bt=$e.data;if(bt.points&&bt.points.length>0){const _n=bt.points.map($n=>St.latLng($n[1],$n[0]));Gt=new Rf(_n,bt.style),bt.name&&(Gt.properties={name:bt.name},Gt.name=bt.name)}break}case"Line":{const bt=$e.data;if(bt.points&&bt.points.length>0){const _n=bt.points.map($n=>St.latLng($n[1],$n[0]));Gt=new $o(_n,bt.style),bt.name&&(Gt.properties={name:bt.name},Gt.name=bt.name)}break}case"ElevationLine":{const bt=$e.data;if(bt.points&&bt.points.length>0){const _n=bt.points.map($n=>St.latLng($n[1],$n[0]));Gt=new Ac(_n,bt.style),bt.name&&(Gt.properties={name:bt.name,type:"ElevationLine",elevationData:bt.elevationData,minElevation:bt.minElevation,maxElevation:bt.maxElevation,elevationGain:bt.elevationGain,elevationLoss:bt.elevationLoss,averageSlope:bt.averageSlope,maxSlope:bt.maxSlope},Gt.name=bt.name),bt.elevationData&&(Gt.elevationData=bt.elevationData)}break}case"CircleWithSections":{const bt=$e.data;if(bt.center&&bt.radius){const _n=St.latLng(bt.center[1],bt.center[0]);Gt=new bc(_n,{...bt.style,radius:bt.radius}),bt.sections&&bt.sections.forEach($n=>{Gt.addSection($n)}),bt.name&&(Gt.properties={name:bt.name},Gt.name=bt.name)}break}}Gt&&(Gt._dbId=$e.id,(Ln=b.value)==null||Ln.addLayer(Gt),o.value.push({id:$e.id,type:$e.type_forme,layer:Gt,properties:Gt.properties}))},"MapView")})),await new Promise($e=>setTimeout($e,0))}});await Promise.all(xn),At.measure("refreshMapWithPlan:adjustView",()=>{D()},"MapView")},"MapView"),console.log(`Plan ${it} chargé avec succès avec ${r.getCurrentElements.length} formes`)):console.error(`Plan ${it} introuvable après chargement`),Ee.value=!1}catch(Ke){throw console.error("Erreur lors du rafraîchissement de la carte:",Ke),Ke}},"MapView")}async function B(it){return await At.measureAsync("loadPlan",async()=>{var Ke;console.log(`
[MapView][loadPlan] ====== DÉBUT CHARGEMENT PLAN ======`),console.log("[MapView][loadPlan] Tentative de chargement du plan:",it);try{const qt=await At.measureAsync("loadPlan:getPlanFromStore",async()=>i.getPlanById(it),"MapView");if(console.log("[MapView][loadPlan] Plan trouvé dans le store:",!!qt),!qt){console.log("[MapView][loadPlan] Plan non trouvé dans le store, vérification API...");try{await At.measureAsync("loadPlan:apiCheck",async()=>{await ii.get(`/plans/${it}/`)},"MapView")}catch(mn){throw((Ke=mn.response)==null?void 0:Ke.status)===404&&(console.warn("[MapView][loadPlan] Plan non trouvé - Nettoyage du localStorage"),localStorage.removeItem("lastPlanId"),Ie.value=null,i.clearCurrentPlan(),r.clearCurrentPlan(),X()),mn}}console.log("[MapView][loadPlan] Rafraîchissement de la carte..."),await At.measureAsync("loadPlan:refreshMap",async()=>{await ke(it)},"MapView"),Ee.value=!1,console.log("[MapView][loadPlan] Invalidation de la taille de la carte..."),Oe(),console.log("[MapView][loadPlan] Plan chargé avec succès:",{planId:it,elementsCount:r.getCurrentElements.length})}catch(qt){throw console.error("Erreur lors du chargement du plan:",qt),At.measure("loadPlan:errorRecovery",()=>{Ie.value=null,i.clearCurrentPlan(),r.clearCurrentPlan(),X(),localStorage.removeItem("lastPlanId")},"MapView"),qt}},"MapView")}async function W(){var it;if(!Ie.value||!b.value){console.warn("Aucun plan actif ou groupe de formes à sauvegarder");return}nt.value=!0,We.value="saving";try{const Ke=[],qt=new Set(r.getCurrentElements.filter(ot=>ot.id!==void 0).map(ot=>ot.id)),mn=new Set;console.log("[savePlan] Début de la sauvegarde",{featureGroupLayers:b.value.getLayers().length,existingIds:Array.from(qt),currentElements:r.getCurrentElements}),b.value.eachLayer(ot=>{var Gt,Dn,Ln,bt,_n,$n,ni,ri,Li,Sn,Un,ui,jn,Wt,yn,Ci,qi,Si,Qi,fr,Hn,ai,rr,Yi,Pi,kn,xr,Gi,Wi,dr,zr,Vi,fi,gs,Pr,Rr,Ai,En,hn,di,li,Wn,as,Ms,jr,ao;console.log("[savePlan] Traitement de la couche",{type:(Gt=ot.properties)==null?void 0:Gt.type,name:(Dn=ot.properties)==null?void 0:Dn.name,isPolygon:ot instanceof St.Polygon,isCircleArc:ot instanceof Lu,properties:ot.properties});let de,_e;const $e={color:ot.options.color||"#3388ff",weight:ot.options.weight||3,opacity:ot.options.opacity||1,fillColor:ot.options.fillColor||"#3388ff",fillOpacity:ot.options.fillOpacity||.2,dashArray:ot.options.dashArray||""};if(ot instanceof Jl){de="TextRectangle";const dn=ot.getBounds();_e={bounds:{southWest:[dn.getSouthWest().lng,dn.getSouthWest().lat],northEast:[dn.getNorthEast().lng,dn.getNorthEast().lat]},content:((Ln=ot.properties)==null?void 0:Ln.text)||"",name:((_n=(bt=ot.properties)==null?void 0:bt.style)==null?void 0:_n.name)||"",style:{...$e,textStyle:{color:((ri=(ni=($n=ot.properties)==null?void 0:$n.style)==null?void 0:ni.textStyle)==null?void 0:ri.color)||"#000000",fontSize:((Un=(Sn=(Li=ot.properties)==null?void 0:Li.style)==null?void 0:Sn.textStyle)==null?void 0:Un.fontSize)||"14px",fontFamily:((Wt=(jn=(ui=ot.properties)==null?void 0:ui.style)==null?void 0:jn.textStyle)==null?void 0:Wt.fontFamily)||"Arial, sans-serif",textAlign:((qi=(Ci=(yn=ot.properties)==null?void 0:yn.style)==null?void 0:Ci.textStyle)==null?void 0:qi.textAlign)||"center",backgroundColor:((fr=(Qi=(Si=ot.properties)==null?void 0:Si.style)==null?void 0:Qi.textStyle)==null?void 0:fr.backgroundColor)||"#FFFFFF",backgroundOpacity:((rr=(ai=(Hn=ot.properties)==null?void 0:Hn.style)==null?void 0:ai.textStyle)==null?void 0:rr.backgroundOpacity)??1,bold:((kn=(Pi=(Yi=ot.properties)==null?void 0:Yi.style)==null?void 0:Pi.textStyle)==null?void 0:kn.bold)||!1,italic:((Wi=(Gi=(xr=ot.properties)==null?void 0:xr.style)==null?void 0:Gi.textStyle)==null?void 0:Wi.italic)||!1}},rotation:((dr=ot.properties)==null?void 0:dr.rotation)||0}}else if(ot instanceof Uo){de="Rectangle";const dn=ot.getBounds();_e={bounds:{southWest:[dn.getSouthWest().lng,dn.getSouthWest().lat],northEast:[dn.getNorthEast().lng,dn.getNorthEast().lat]},style:$e,name:((zr=ot.properties)==null?void 0:zr.name)||"",rotation:ot.getRotation(),width:ot.getDimensions().width,height:ot.getDimensions().height,center:[ot.getCenter().lng,ot.getCenter().lat]}}else if(ot instanceof Lu||((Vi=ot.properties)==null?void 0:Vi.type)==="Semicircle"){de="Semicircle";let dn;typeof ot.getLatLng=="function"?dn=ot.getLatLng():ot.getCenter&&typeof ot.getCenter=="function"?dn=ot.getCenter():ot._latlng?dn=ot._latlng:dn={lat:0,lng:0};const si=ot.getRadius?ot.getRadius():0,Er=((fi=ot.properties)==null?void 0:fi.startAngle)||0,vr=((gs=ot.properties)==null?void 0:gs.stopAngle)||180;_e={center:[dn.lng,dn.lat],radius:si,startAngle:Er,endAngle:vr,name:((Pr=ot.properties)==null?void 0:Pr.name)||"",style:$e}}else if(ot instanceof bc||((Rr=ot.properties)==null?void 0:Rr.type)==="CircleWithSections"){de="CircleWithSections";const dn=ot.getLatLng(),si=ot.getRadius(),Er=ot.getSections();_e={center:[dn.lng,dn.lat],radius:si,name:((Ai=ot.properties)==null?void 0:Ai.name)||"",style:$e,sections:Er}}else if(ot instanceof St.Circle)de="Circle",_e={center:[ot.getLatLng().lng,ot.getLatLng().lat],radius:ot.getRadius(),name:((En=ot.properties)==null?void 0:En.name)||"",style:$e};else if(ot instanceof St.Rectangle){de="Rectangle";const dn=ot.getBounds();_e={bounds:{southWest:[dn.getSouthWest().lng,dn.getSouthWest().lat],northEast:[dn.getNorthEast().lng,dn.getNorthEast().lat]},name:((hn=ot.properties)==null?void 0:hn.name)||"",style:$e}}else ot instanceof St.Polyline&&!(ot instanceof St.Polygon)?((di=ot.properties)==null?void 0:di.type)==="ElevationLine"?(de="ElevationLine",_e={points:ot.getLatLngs().map(si=>[si.lng,si.lat]),style:{...$e,color:((li=ot.properties.style)==null?void 0:li.color)||"#FF4500",weight:((Wn=ot.properties.style)==null?void 0:Wn.weight)||4,opacity:((as=ot.properties.style)==null?void 0:as.opacity)||.8},name:((Ms=ot.properties)==null?void 0:Ms.name)||"",elevationData:ot.properties.elevationData,samplePointStyle:ot.properties.samplePointStyle,minMaxPointStyle:ot.properties.minMaxPointStyle,minElevation:ot.properties.minElevation,maxElevation:ot.properties.maxElevation,elevationGain:ot.properties.elevationGain,elevationLoss:ot.properties.elevationLoss,averageSlope:ot.properties.averageSlope,maxSlope:ot.properties.maxSlope}):(de="Line",_e={points:ot.getLatLngs().map(si=>[si.lng,si.lat]),name:((jr=ot.properties)==null?void 0:jr.name)||"",style:$e}):ot instanceof St.Polygon&&!(ot instanceof St.Rectangle)&&(de="Polygon",_e={points:ot.getLatLngs()[0].map(si=>[si.lng,si.lat]),name:((ao=ot.properties)==null?void 0:ao.name)||"",style:$e});if(de&&_e){let dn=ot._elementId;ot._dbId&&(dn=ot._dbId,typeof dn=="number"&&mn.add(dn)),Ke.push({id:dn,type_forme:de,data:_e})}}),console.log("[savePlan] Éléments à sauvegarder",{totalElements:Ke.length,elements:Ke.map(ot=>({type:ot.type_forme,hasPoints:"points"in ot.data,hasStyle:"style"in ot.data}))});const xn=Array.from(qt).filter(ot=>!mn.has(ot));r.elements=Ke;const wn=await r.saveToPlan(Ie.value.id,{elementsToDelete:xn});if(wn&&((it=Ie.value)!=null&&it.id)){const ot=Ie.value.id;Ie.value={...Ie.value,...wn},i.updatePlanDetails(ot,wn)}We.value="success",setTimeout(()=>{We.value=null},3e3)}catch(Ke){console.error("Erreur lors de la sauvegarde du plan:",Ke),We.value=null}finally{nt.value=!1}}Qu(()=>{O.user||Se(),i.clearCurrentPlan(),r.clearCurrentPlan()});function he(it){E(it)}function ne(it){try{const Ke=new Date(it);return isNaN(Ke.getTime())?(console.error("Date invalide reçue:",it),"Date invalide"):new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Paris"}).format(Ke)}catch(Ke){return console.error("Erreur lors du formatage de la date:",Ke),"Date invalide"}}const re=()=>{b.value&&D()},ee=()=>{h.value&&b.value&&(_(""),b.value.removeLayer(h.value),h.value=null)};async function oe(it){console.log(`onPlanCreated - Tentative de chargement du plan ${it}`),await i.fetchPlans();const Ke=i.getPlanById(it);Ke?(console.log(`Plan ${it} trouvé, chargement en cours...`),localStorage.setItem("lastPlanId",it.toString()),Ie.value=Ke,i.setCurrentPlan(Ke),r.setCurrentPlan(Ke.id),pe.value=!1,Oe(),console.log(`Plan ${it} chargé avec succès`)):console.error(`Plan ${it} introuvable après création! Vérifiez les permissions.`)}Ur(I,async it=>{var Ke;if(it&&((Ke=O.user)==null?void 0:Ke.user_type)==="admin"){R.value=!0;try{const qt=await O.fetchConcessionnaireAgriculteurs(it.id);le.value=Array.isArray(qt)?qt:[qt]}catch(qt){console.error("[MapView][watch selectedConcessionnaire] Error:",qt),le.value=[]}finally{R.value=!1}}});function Se(){localStorage.removeItem("lastPlanId")}function te(it,Ke="m"){return Ke==="m²"?`${(it/1e4).toFixed(2)} ha`:Ke==="m"?it>=1e3?`${(it/1e3).toFixed(2)} km`:`${it.toFixed(2)} m`:`${it.toFixed(2)} ${Ke}`}const ae=Yt(!1);function Le(it){return{Circle:"Cercle",Rectangle:"Rectangle",Semicircle:"Demi-cercle",Line:"Ligne",Polygon:"Polygone",TextRectangle:"Annotation",ElevationLine:"Profil altimétrique"}[it]||it}async function ye(){var Ke,qt,mn,xn,wn,ot,de,_e,$e,Gt;if(!Ie.value||!p.value||!b.value){console.error("[generateSynthesis] Plan, map ou featureGroup manquant");return}const it=Ie.value;try{console.log("[generateSynthesis] Début de la génération"),console.log("[generateSynthesis] Plan courant complet:",it),await W();let Sn=it;if(!it.concessionnaire_details&&!it.usine_details&&!it.client_details){console.log("[generateSynthesis] Détails manquants, tentative de récupération...");try{const Hn=await ii.get(`/plans/${it.id}/`);Hn.status===200&&(console.log("[generateSynthesis] Plan mis à jour:",Hn.data),Ie.value={...it,...Hn.data},Sn=Hn.data,i.updatePlanDetails(it.id,Hn.data))}catch(Hn){console.error("[generateSynthesis] Erreur lors de la récupération des détails:",Hn)}}await new Promise(Hn=>setTimeout(Hn,1e3)),ae.value=!0;const Un=Sn.concessionnaire_details,ui=Sn.client_details,jn=(Un==null?void 0:Un.usine_details)||Sn.usine_details;console.log("[generateSynthesis] Détails du plan utilisé:",Sn),console.log("[generateSynthesis] Détails des utilisateurs:",{concessionnaire:Un?{id:Un.id,nom:`${Un.first_name} ${Un.last_name}`,company:Un.company_name,logo:Un.logo}:null,usine:jn?{id:jn.id,nom:`${jn.first_name} ${jn.last_name}`,company:jn.company_name,logo:jn.logo}:null,client:ui?{id:ui.id,nom:`${ui.first_name} ${ui.last_name}`,company:ui.company_name}:null}),h.value&&(j(),h.value=null);const Wt=new wi("l","mm","a4");console.log("[generateSynthesis] Chargement du logo de l'application");const yn=new Image;yn.src=cy,await new Promise(Hn=>{yn.onload=()=>{console.log("[generateSynthesis] Logo application chargé"),Hn()},yn.onerror=ai=>{console.error("[generateSynthesis] Erreur chargement logo application:",ai),Hn()}}),console.log("[generateSynthesis] Tentative de chargement du logo usine:",jn==null?void 0:jn.logo);let Ci=null;jn!=null&&jn.logo&&(Ci=new Image,Ci.src=jn.logo,await new Promise(Hn=>{Ci?(Ci.onload=()=>{console.log("[generateSynthesis] Logo usine chargé avec succès"),Hn()},Ci.onerror=ai=>{console.error("[generateSynthesis] Erreur chargement logo usine:",ai),Hn()}):Hn()})),console.log("[generateSynthesis] Tentative de chargement du logo concessionnaire:",Un==null?void 0:Un.logo);let qi=null;Un!=null&&Un.logo&&(qi=new Image,qi.src=Un.logo,await new Promise(Hn=>{qi?(qi.onload=()=>{console.log("[generateSynthesis] Logo concessionnaire chargé avec succès"),Hn()},qi.onerror=ai=>{console.error("[generateSynthesis] Erreur chargement logo concessionnaire:",ai),Hn()}):Hn()})),console.log("[generateSynthesis] Ajout des logos au PDF:",{logoApplication:!0,logoUsine:Ci!==null,logoConcessionnaire:qi!==null}),Ci!==null&&Wt.addImage(Ci,"JPEG",148.5-40-30,20,40,40),Wt.addImage(yn,"JPEG",148.5-40/2,20,40,40),qi!==null&&Wt.addImage(qi,"JPEG",148.5+30,20,40,40),Wt.setFontSize(24),Wt.setTextColor(0),Wt.text(it.nom||"Sans titre",297/2,100,{align:"center"});let Si=120;if(jn&&(Wt.setFontSize(14),Wt.setFont("helvetica","bold"),Wt.text("Usine:",20,Si),Wt.setFont("helvetica","normal"),Wt.text(`${jn.first_name} ${jn.last_name}${jn.company_name?` (${jn.company_name})`:""}`,20,Si+6),Si+=15),Un&&(Wt.setFontSize(14),Wt.setFont("helvetica","bold"),Wt.text("Concessionnaire:",20,Si),Wt.setFont("helvetica","normal"),Wt.text(`${Un.first_name} ${Un.last_name}${Un.company_name?` (${Un.company_name})`:""}`,20,Si+6),Si+=15),ui&&(Wt.setFontSize(14),Wt.setFont("helvetica","bold"),Wt.text("Client:",20,Si),Wt.setFont("helvetica","normal"),Wt.text(`${ui.first_name} ${ui.last_name}${ui.company_name?` (${ui.company_name})`:""}`,20,Si+6),Si+=15),it.description){Wt.setFont("helvetica","bold"),Wt.text("Description:",20,Si),Wt.setFont("helvetica","normal");const Hn=Wt.splitTextToSize(it.description,150);Wt.text(Hn,20,Si+6),Si+=8*Hn.length+10}Si=Math.min(Si,180),Wt.setFontSize(10),Wt.setTextColor(100),Wt.text(`Date de création: ${ne(it.date_creation)}`,20,190),Wt.text(`Dernière modification: ${ne(it.date_modification)}`,277,190,{align:"right"});const Qi=[];b.value.eachLayer(Hn=>Qi.push(Hn));const fr=St.simpleMapScreenshoter({hideElementsWithSelectors:[".leaflet-control-container",".leaflet-pm-toolbar",".leaflet-grid-layer",".leaflet-grid-label"],preventDownload:!0}).addTo(p.value);await new Promise(Hn=>setTimeout(Hn,3e3));for(let Hn=0;Hn<Qi.length;Hn++){Wt.addPage(),Wt.setFillColor(248,250,252),Wt.setDrawColor(226,232,240),Wt.rect(0,0,297,25,"F"),Wt.setFontSize(10),Wt.setTextColor(50,50,50),Wt.setFont("helvetica","bold"),Wt.text(it.nom||"Sans titre",20,12);let Yi=297-20-(15*(1+(Ci!==null?1:0)+(qi!==null?1:0))+5*(1+(Ci!==null?1:0)));Ci!==null&&(Wt.addImage(Ci,"JPEG",Yi,5,15,15),Yi+=20),Wt.addImage(yn,"JPEG",Yi,5,15,15),Yi+=20,qi!==null&&Wt.addImage(qi,"JPEG",Yi,5,15,15),Wt.setDrawColor(200,200,200),Wt.setLineWidth(.5),Wt.line(0,25,297,25);const Pi=Qi[Hn],kn=Pi.properties;if(kn){Wt.setTextColor(0),Wt.setFontSize(14),Wt.setFont("helvetica","bold");const xr=kn.name||Le(kn.type);let Gi="";if(kn.type!=="TextRectangle"){const dr=Q(Qi,Pi);Gi=dr>0?` (surface totale d'irrigation : ${te(dr,"m²")})`:""}const Wi=`${xr}${Gi}`;Wt.text(Wi,20,35)}if(kn&&kn.type==="ElevationLine")try{const xr=((Ke=Pi.getBounds)==null?void 0:Ke.call(Pi))||((qt=Pi.getLatLng)==null?void 0:qt.call(Pi));xr&&p.value.fitBounds(xr instanceof St.LatLng?St.latLngBounds([xr]):xr,{padding:[50,50]});try{const En=((mn=Pi.getBounds)==null?void 0:mn.call(Pi))||((xn=Pi.getLatLng)==null?void 0:xn.call(Pi));if(!En||!p.value)console.warn("[generateSynthesis] Bounds ou carte invalide");else{const hn=En instanceof St.LatLng?St.latLngBounds([En]):En;hn&&hn.isValid&&hn.isValid()&&p.value.getContainer()&&document.body.contains(p.value.getContainer())&&p.value.fitBounds(hn,{padding:[50,50],animate:!1})}}catch(En){console.warn("[generateSynthesis] Erreur lors de l'ajustement de la vue:",En)}await new Promise(En=>setTimeout(En,2e3)),p.value.invalidateSize();try{p.value&&p.value.getContainer()&&document.body.contains(p.value.getContainer())?p.value.invalidateSize({animate:!1}):console.warn("[generateSynthesis] Carte non valide pour l'invalidation de taille")}catch(En){console.warn("[generateSynthesis] Erreur lors de l'invalidation de la taille de la carte:",En)}await new Promise(En=>{const hn=()=>{var as;const di=(as=p.value)==null?void 0:as.getContainer();if(!di){En();return}const li=di.querySelectorAll(".leaflet-tile-loaded");di.querySelectorAll(".leaflet-tile-loading").length===0&&li.length>0?En():setTimeout(hn,100)};hn()});const Gi=await fr.takeScreen("image"),Wi=await new Promise((En,hn)=>{const di=new Image;di.onload=()=>En(di),di.onerror=li=>hn(li),di.src=Gi}),dr=40,zr=237/2,Vi=Math.min(70,Wi.height*zr/Wi.width);if(Wt.addImage(Wi,"PNG",20,dr,zr,Vi),kn.elevationData&&kn.elevationData.length>0){const En=document.createElement("canvas");En.width=800,En.height=400;const hn=En.getContext("2d");if(hn){const di=kn.elevationData,li=kn.minElevation,Wn=kn.maxElevation,Ms=(Wn-li)*.05,jr=li-Ms,ao=Wn+Ms,dn=40,si=En.width-2*dn,Er=En.height-2*dn,vr=sr=>dn+sr/di[di.length-1].distance*si,Lr=sr=>dn+Er-(sr-jr)/(ao-jr)*Er;hn.fillStyle="#f8fafc",hn.fillRect(0,0,En.width,En.height),hn.fillStyle="#334155",hn.font="bold 20px Arial",hn.textAlign="center",hn.fillText("Profil altimétrique",En.width/2,25),hn.strokeStyle="#e2e8f0",hn.lineWidth=1,hn.beginPath(),hn.moveTo(dn,dn),hn.lineTo(dn,Er+dn),hn.lineTo(si+dn,Er+dn),hn.strokeStyle="#94a3b8",hn.stroke();const Ea=5;for(let sr=0;sr<=Ea;sr++){const ms=jr+sr/Ea*(ao-jr),vs=Lr(ms);hn.beginPath(),hn.strokeStyle="#e2e8f0",hn.moveTo(dn,vs),hn.lineTo(si+dn,vs),hn.stroke(),hn.beginPath(),hn.strokeStyle="#94a3b8",hn.moveTo(dn-5,vs),hn.lineTo(dn,vs),hn.stroke(),hn.fillStyle="#64748b",hn.font="12px Arial",hn.textAlign="right",hn.fillText(`${Math.round(ms)}m`,dn-8,vs+4)}const Po=5,Eo=di[di.length-1].distance;for(let sr=0;sr<=Po;sr++){const ms=sr/Po*Eo,vs=vr(ms);hn.beginPath(),hn.strokeStyle="#e2e8f0",hn.moveTo(vs,dn),hn.lineTo(vs,Er+dn),hn.stroke(),hn.beginPath(),hn.strokeStyle="#94a3b8",hn.moveTo(vs,Er+dn),hn.lineTo(vs,Er+dn+5),hn.stroke(),hn.fillStyle="#64748b",hn.font="12px Arial",hn.textAlign="center",hn.fillText(`${Math.round(ms)}m`,vs,Er+dn+16)}const Cr=hn.createLinearGradient(0,dn,0,Er+dn);Cr.addColorStop(0,"rgba(255, 69, 0, 0.8)"),Cr.addColorStop(1,"rgba(255, 69, 0, 0.2)"),hn.beginPath(),hn.moveTo(vr(di[0].distance),Lr(di[0].elevation)),di.forEach((sr,ms)=>{ms>0&&hn.lineTo(vr(sr.distance),Lr(sr.elevation))}),hn.strokeStyle="#FF4500",hn.lineWidth=2,hn.stroke(),hn.lineTo(vr(di[di.length-1].distance),Lr(jr)),hn.lineTo(vr(di[0].distance),Lr(jr)),hn.closePath(),hn.fillStyle=Cr,hn.fill(),di.forEach(sr=>{hn.beginPath(),hn.arc(vr(sr.distance),Lr(sr.elevation),3,0,Math.PI*2),hn.fillStyle="#FF4500",hn.fill(),hn.strokeStyle="white",hn.lineWidth=1,hn.stroke()});let Ts=0,lo=0;for(let sr=0;sr<di.length;sr++)di[sr].elevation===li&&(Ts=sr),di[sr].elevation===Wn&&(lo=sr);hn.beginPath(),hn.arc(vr(di[lo].distance),Lr(di[lo].elevation),6,0,Math.PI*2),hn.fillStyle="#059669",hn.fill(),hn.strokeStyle="white",hn.lineWidth=2,hn.stroke(),hn.beginPath(),hn.arc(vr(di[Ts].distance),Lr(di[Ts].elevation),6,0,Math.PI*2),hn.fillStyle="#DC2626",hn.fill(),hn.strokeStyle="white",hn.lineWidth=2,hn.stroke(),hn.font="12px Arial",hn.fillStyle="#059669",hn.textAlign="left",hn.fillText(`Point haut: ${te(Wn,"m")}`,dn,Er+dn+35),hn.fillStyle="#DC2626",hn.fillText(`Point bas: ${te(li,"m")}`,dn+200,Er+dn+35);const Bs=En.toDataURL("image/png");Wt.addImage(Bs,"PNG",20+zr+20,dr,zr,Vi)}}const fi=dr+Vi+15;Wt.setFillColor(248,250,252),Wt.setDrawColor(226,232,240),Wt.roundedRect(20,fi,257,50,3,3,"FD"),Wt.setFont("helvetica","bold"),Wt.setFontSize(12),Wt.setTextColor(51,65,85),Wt.text("Caractéristiques",30,fi+10);const gs=[{label:"Distance totale",value:te(kn.length||0)},{label:"Dénivelé positif",value:te(kn.elevationGain||0,"m")},{label:"Dénivelé négatif",value:te(kn.elevationLoss||0,"m")}],Pr=[{label:"Pente moyenne",value:`${(kn.averageSlope||0).toFixed(1)}%`},{label:"Pente maximale",value:`${(kn.maxSlope||0).toFixed(1)}%`},{label:"Altitude min/max",value:`${te(kn.minElevation||0,"m")} / ${te(kn.maxElevation||0,"m")}`}];let Rr=fi+20;Wt.setFont("helvetica","normal"),Wt.setFontSize(10),gs.forEach(En=>{Wt.setTextColor(100,116,139),Wt.text(En.label,30,Rr),Wt.setTextColor(15,23,42),Wt.setFont("helvetica","bold"),Wt.text(En.value,110,Rr),Wt.setFont("helvetica","normal"),Rr+=9}),Rr=fi+20;const Ai=297/2;Pr.forEach(En=>{Wt.setTextColor(100,116,139),Wt.text(En.label,Ai,Rr),Wt.setTextColor(15,23,42),Wt.setFont("helvetica","bold"),Wt.text(En.value,Ai+80,Rr),Wt.setFont("helvetica","normal"),Rr+=9})}catch(xr){console.error("[generateSynthesis] Erreur traitement profil altimétrique:",xr)}else{const xr=((wn=Pi.getBounds)==null?void 0:wn.call(Pi))||((ot=Pi.getLatLng)==null?void 0:ot.call(Pi));xr&&p.value.fitBounds(xr instanceof St.LatLng?St.latLngBounds([xr]):xr,{padding:[50,50]});try{const Gi=((de=Pi.getBounds)==null?void 0:de.call(Pi))||((_e=Pi.getLatLng)==null?void 0:_e.call(Pi));if(!Gi||!p.value)console.warn("[generateSynthesis] Bounds ou carte invalide");else{const Wi=Gi instanceof St.LatLng?St.latLngBounds([Gi]):Gi;Wi&&Wi.isValid&&Wi.isValid()&&p.value.getContainer()&&document.body.contains(p.value.getContainer())&&p.value.fitBounds(Wi,{padding:[50,50],animate:!1})}}catch(Gi){console.warn("[generateSynthesis] Erreur lors de l'ajustement de la vue:",Gi)}await new Promise(Gi=>setTimeout(Gi,2e3)),p.value.invalidateSize(),await new Promise(Gi=>{const Wi=()=>{var fi;const dr=(fi=p.value)==null?void 0:fi.getContainer();if(!dr){Gi();return}const zr=dr.querySelectorAll(".leaflet-tile-loaded");dr.querySelectorAll(".leaflet-tile-loading").length===0&&zr.length>0?Gi():setTimeout(Wi,100)};Wi()});try{const Gi=await fr.takeScreen("image"),Wi=await new Promise((fi,gs)=>{const Pr=new Image;Pr.onload=()=>fi(Pr),Pr.onerror=Rr=>gs(Rr),Pr.src=Gi}),dr=45,zr=297*.6-30;let Vi=Wi.height*zr/Wi.width;if(Vi>210*.9&&(Vi=210*.9),Wt.addImage(Wi,"PNG",20,dr,zr,Vi),kn){let fi=function(hn,di,li,Wn,as){Wt.setTextColor(100,116,139),Wt.setFont("helvetica","normal"),Wt.text(hn,li+10,Wn),Wt.setTextColor(15,23,42),Wt.setFont("helvetica","bold"),Wt.text(di,li+as-10,Wn,{align:"right"})},Pr=0;if(kn.type==="Circle")Pr=4;else if(kn.type==="Rectangle")Pr=4;else if(kn.type==="Line")Pr=1,($e=kn.dimensions)!=null&&$e.width&&Pr++,kn.surfaceInfluence&&Pr++;else if(kn.type==="Semicircle")Pr=6;else if(kn.type==="Polygon")Pr=2;else if(kn.type==="CircleWithSections"&&(Pr=3,kn.sections&&kn.sections.length>0)){const hn=Math.ceil(kn.sections.length/3);Pr+=hn*3}const Rr=Math.max(15+Pr*12+30,60),Ai=297-188.2-20;Wt.setFillColor(248,250,252),Wt.setDrawColor(226,232,240),Wt.roundedRect(188.2,dr,Ai,Rr,3,3,"FD"),Wt.setFont("helvetica","bold"),Wt.setFontSize(12),Wt.setTextColor(51,65,85),Wt.text("Caractéristiques",188.2+10,dr+15);let En=dr+30;Wt.setFontSize(10),kn.type==="Circle"?(fi("Rayon",te(kn.radius),188.2,En,Ai),En+=12,fi("Diamètre",te(kn.radius*2),188.2,En,Ai),En+=12,fi("Surface",te(kn.surface,"m²"),188.2,En,Ai),En+=12,fi("Périmètre",te(kn.perimeter),188.2,En,Ai)):kn.type==="Rectangle"?(fi("Largeur",te(kn.width),188.2,En,Ai),En+=12,fi("Hauteur",te(kn.height),188.2,En,Ai),En+=12,fi("Surface",te(kn.surface,"m²"),188.2,En,Ai),En+=12,fi("Périmètre",te(kn.perimeter),188.2,En,Ai)):kn.type==="Line"?(fi("Longueur",te(kn.length),188.2,En,Ai),En+=12,(Gt=kn.dimensions)!=null&&Gt.width&&(fi("Largeur d'influence",te(kn.dimensions.width),188.2,En,Ai),En+=12),kn.surfaceInfluence&&fi("Surface d'influence",te(kn.surfaceInfluence,"m²"),188.2,En,Ai)):kn.type==="Semicircle"?(fi("Rayon",te(kn.radius),188.2,En,Ai),En+=12,fi("Diamètre",te(kn.radius*2),188.2,En,Ai),En+=12,fi("Surface",te(kn.surface,"m²"),188.2,En,Ai),En+=12,fi("Périmètre",te(kn.perimeter),188.2,En,Ai),En+=12,fi("Longueur d'arc",te(kn.arcLength),188.2,En,Ai),En+=12,fi("Angle d'ouverture",`${kn.openingAngle.toFixed(1)}°`,188.2,En,Ai)):kn.type==="Polygon"?(fi("Surface",te(kn.surface,"m²"),188.2,En,Ai),En+=12,fi("Périmètre",te(kn.perimeter),188.2,En,Ai)):kn.type==="CircleWithSections"&&(fi("Rayon",te(kn.radius),188.2,En,Ai),En+=12,fi("Surface totale",te(kn.surface,"m²"),188.2,En,Ai),En+=12,fi("Périmètre",te(kn.perimeter),188.2,En,Ai),En+=20,kn.sections&&kn.sections.length>0&&(En=rn(kn.sections,Wt,188.2,En,Ai)))}}catch(Gi){console.error(`[generateSynthesis] Erreur capture forme ${Hn+1}:`,Gi)}}}p.value.removeControl(fr),Wt.save(`synthese_${it.nom}.pdf`)}catch(Dn){console.error("[generateSynthesis] Erreur:",Dn),alert("Une erreur est survenue lors de la génération de la synthèse. Veuillez réessayer.")}finally{ae.value=!1}}const ue=f4.debounce(()=>{const it=At.startMeasure("invalidateMapSize","MapView");if(!p.value){it();return}ks(()=>{At.measure("invalidateMapSize:nextTick",()=>{var Ke;try{if(p.value&&p.value.getContainer()&&document.body.contains(p.value.getContainer())){if(p.value.invalidateSize({animate:!1}),(Ke=b.value)!=null&&Ke.getLayers().length)try{D()}catch(qt){console.warn("[invalidateMapSize] Erreur lors de l'ajustement de la vue:",qt)}}else console.warn("[invalidateMapSize] Carte non valide pour l'invalidation")}catch(qt){console.warn("[invalidateMapSize] Erreur lors de l'invalidation de la taille de la carte:",qt)}it()},"MapView")})},250);function Oe(){ue()}Ur(Ie,(it,Ke)=>{it&&it.id!==(Ke==null?void 0:Ke.id)&&ks(()=>{Oe()})});const De=Yt(null),Me=Yt(!1),Ve=Yt([]),ze=Di(()=>{if(console.log("[MapView][filteredConcessionnaires] Computing with:",{selectedUsine:De.value,concessionnaires:H.value,concessionnairesLength:H.value.length}),!De.value)return[];const it=H.value.filter(Ke=>{var xn,wn,ot;const qt=Ke.usine,mn=typeof qt=="object"&&qt!==null?qt.id:qt;return console.log("[MapView][filteredConcessionnaires] Checking concessionnaire:",{concessionnaire:Ke,concessionnaireUsine:qt,concessionnaireUsineId:mn,selectedUsineId:(xn=De.value)==null?void 0:xn.id,matches:mn===((wn=De.value)==null?void 0:wn.id)}),mn===((ot=De.value)==null?void 0:ot.id)});return console.log("[MapView][filteredConcessionnaires] Filtered result:",it),it});function st(it){if(!it)return"";const Ke=it.first_name||"",qt=it.last_name?it.last_name.toUpperCase():"",mn=it.company_name||it.role||"";return`${Ke} ${qt} (${mn})`}async function Qe(){Me.value=!0;try{const it=await ii.get("/users/",{params:{role:"USINE"}});Ve.value=it.data}catch(it){console.error("[MapView] Error loading usines:",it),Ve.value=[]}finally{Me.value=!1}}async function pt(it){console.log("[MapView][selectUsine] Sélection de l'usine:",it),De.value=it,$.value=!0;try{console.log("[MapView][selectUsine] Envoi de la requête avec params:",{role:"CONCESSIONNAIRE",usine:it.id});const Ke=await ii.get("/users/",{params:{role:"CONCESSIONNAIRE",usine:it.id}});console.log("[MapView][selectUsine] Réponse reçue:",Ke.data),H.value=Ke.data,console.log("[MapView][selectUsine] Concessionnaires mis à jour:",H.value)}catch(Ke){console.error("[MapView] Error loading concessionnaires for usine:",Ke),H.value=[]}finally{$.value=!1}}function wt(){De.value=null,I.value=null,Y.value=null,H.value=[],le.value=[],G.value=[]}function Ht(){I.value=null,Y.value=null,le.value=[],G.value=[]}function nn(){Y.value=null,G.value=[]}async function tt(it){var Ke,qt,mn,xn,wn,ot;console.log(`
[MapView][selectConcessionnaire] ====== DÉBUT SÉLECTION CONCESSIONNAIRE ======`),console.log("Informations du concessionnaire:",{id:it.id,username:it.username,company:it.company_name,role:it.role}),console.log("Contexte utilisateur:",{userType:(Ke=O.user)==null?void 0:Ke.user_type,userId:(qt=O.user)==null?void 0:qt.id,userRole:(mn=O.user)==null?void 0:mn.role,selectedUsineId:(xn=De.value)==null?void 0:xn.id}),I.value=it,R.value=!0;try{const de={role:"AGRICULTEUR",concessionnaire:it.id};O.isUsine?(console.log("Ajout de l'ID de l'usine connectée:",(wn=O.user)==null?void 0:wn.id),de.usine=(ot=O.user)==null?void 0:ot.id):De.value&&(console.log("Ajout de l'ID de l'usine sélectionnée:",De.value.id),de.usine=De.value.id),console.log("Paramètres de la requête:",de);const _e=await ii.get("/users/",{params:de});console.log("Réponse reçue du serveur:",{status:_e.status,dataLength:Array.isArray(_e.data)?_e.data.length:"non-array",data:_e.data}),Array.isArray(_e.data)?(le.value=_e.data,console.log(`${_e.data.length} agriculteurs chargés`),_e.data.forEach(($e,Gt)=>{console.log(`Agriculteur ${Gt+1}:`,{id:$e.id,username:$e.username,company:$e.company_name,concessionnaire:$e.concessionnaire})})):(console.warn("Format de réponse inattendu:",_e.data),le.value=[]),le.value.length===0&&console.warn("Aucun agriculteur trouvé pour ce concessionnaire")}catch(de){if(console.error("ERREUR lors du chargement des agriculteurs:",de),de&&typeof de=="object"&&"response"in de){const _e=de;console.error("Détails de l'erreur:",{status:_e.response.status,data:_e.response.data})}le.value=[]}finally{R.value=!1,console.log(`[MapView][selectConcessionnaire] ====== FIN SÉLECTION CONCESSIONNAIRE ======
`)}}async function Qt(it){var Ke;Y.value=it,Z.value=!0;try{const qt={agriculteur:it.id};O.isUsine?qt.usine=(Ke=O.user)==null?void 0:Ke.id:De.value&&(qt.usine=De.value.id),I.value&&(qt.concessionnaire=I.value.id);const mn=await ii.get("/plans/",{params:qt});G.value=mn.data}catch(qt){console.error("[MapView] Error loading client plans:",qt),G.value=[]}finally{Z.value=!1}}function rn(it,Ke,qt,mn,xn){if(!it||it.length===0)return mn;const wn=[...it].sort((bt,_n)=>(_n.surface||0)-(bt.surface||0)),ot=xn,de=7,_e=6,$e=2,Gt=[{header:"Nom",width:.3,align:"left"},{header:"Surface",width:.2,align:"right"},{header:"Angles",width:.25,align:"right"},{header:"Rayon",width:.15,align:"right"},{header:"Type",width:.1,align:"center"}],Dn=de+_e*wn.length;Ke.setFillColor(248,250,252),Ke.setDrawColor(226,232,240),Ke.roundedRect(qt,mn,ot,Dn+$e*2,2,2,"FD"),Ke.setFillColor(241,245,249),Ke.rect(qt+$e,mn+$e,ot-$e*2,de,"F"),Ke.setFont("helvetica","bold"),Ke.setFontSize(7),Ke.setTextColor(51,65,85);let Ln=qt+$e;return Gt.forEach(bt=>{const _n=bt.width*(ot-$e*2);bt.align==="right"?Ke.text(bt.header,Ln+_n-$e,mn+$e+5,{align:"right"}):bt.align==="center"?Ke.text(bt.header,Ln+_n/2,mn+$e+5,{align:"center"}):Ke.text(bt.header,Ln+$e/2,mn+$e+5),Ln+=_n}),Ke.setFont("helvetica","normal"),Ke.setFontSize(6.5),Ke.setTextColor(71,85,105),wn.forEach((bt,_n)=>{const $n=mn+de+$e+_n*_e;_n%2===0&&(Ke.setFillColor(250,252,254),Ke.rect(qt+$e,$n,ot-$e*2,_e,"F"));let ni=qt+$e;const ri=bt.name||`Section ${_n+1}`;Ke.text(ri,ni+$e/2,$n+4),ni+=Gt[0].width*(ot-$e*2);const Li=te(bt.surface||0,"m²");Ke.text(Li,ni+Gt[1].width*(ot-$e*2)-$e,$n+4,{align:"right"}),ni+=Gt[1].width*(ot-$e*2);const Sn=bt.startAngle===0&&bt.endAngle===360?"Complet":`${bt.startAngle}°-${bt.endAngle}°`;Ke.text(Sn,ni+Gt[2].width*(ot-$e*2)-$e,$n+4,{align:"right"}),ni+=Gt[2].width*(ot-$e*2);const Un=te(bt.radius||0);Ke.text(Un,ni+Gt[3].width*(ot-$e*2)-$e,$n+4,{align:"right"}),ni+=Gt[3].width*(ot-$e*2);const ui=bt.startAngle===0&&bt.endAngle===360?"C":"P";Ke.text(ui,ni+Gt[4].width*(ot-$e*2)/2,$n+4,{align:"center"})}),Ke.setDrawColor(226,232,240),Ke.setLineWidth(.05),Ke.line(qt+$e,mn+de+$e,qt+ot-$e,mn+de+$e),mn+Dn+$e*2}return(it,Ke)=>{var qt,mn,xn,wn;return et(),rt("div",ON,[A("div",IN,[ae.value?(et(),rt("div",FN,Ke[8]||(Ke[8]=[Cc('<div class="bg-white/90 rounded-2xl p-8 max-w-md shadow-2xl border border-gray-100"><div class="flex flex-col items-center"><div class="relative w-24 h-24 mb-6"><div class="absolute inset-0 border-4 border-primary-200 rounded-full"></div><div class="absolute inset-0 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"></div><div class="absolute inset-2 border-2 border-primary-400/30 rounded-full animate-pulse"></div><div class="absolute inset-0 flex items-center justify-center"><svg class="w-8 h-8 text-primary-600 animate-bounce" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div></div><h3 class="text-xl font-semibold text-gray-900 mb-2"> Génération de la synthèse </h3><div class="space-y-2 text-center"><p class="text-primary-600 font-medium"> Capture des formes en cours... </p><p class="text-sm text-gray-500"> Nous optimisons la qualité de vos captures pour un rendu parfait </p></div></div></div>',1)]))):Cn("",!0),Ie.value?Cn("",!0):(et(),rt("div",zN,[A("div",jN,[Ke[11]||(Ke[11]=Cc('<div class="relative w-48 h-48 mx-auto mb-12 rounded-full bg-gradient-to-br from-primary-100 to-primary-50 p-8 shadow-lg ring-4 ring-white"><img src="'+cy+'" alt="IrrigationDesign Logo" class="w-full h-full object-contain filter drop-shadow-md"><div class="absolute inset-0 rounded-full bg-gradient-to-t from-transparent to-white/10 pointer-events-none"></div></div><h1 class="text-3xl font-bold text-gray-900 mb-4">Bienvenue sur IrrigationDesign</h1><p class="text-gray-600 mb-8">Pour commencer à dessiner, vous devez d&#39;abord créer un nouveau plan ou charger un plan existant.</p>',3)),A("div",UN,[A("button",{onClick:Ke[0]||(Ke[0]=ot=>pe.value=!0),class:"w-full flex items-center justify-center px-4 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors duration-200"},Ke[9]||(Ke[9]=[A("svg",{class:"w-6 h-6 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),Ir(" Créer un nouveau plan ")])),A("button",{onClick:Ke[1]||(Ke[1]=ot=>Ee.value=!0),class:"w-full flex items-center justify-center px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors duration-200"},Ke[10]||(Ke[10]=[A("svg",{class:"w-6 h-6 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),Ir(" Charger un plan existant ")]))])])])),zn(A("div",$N,[(et(),Yl(E0,{to:"body"},[Ie.value&&!ae.value?(et(),rt("div",qN,[$r(h7,{"last-save":(qt=Ie.value)!=null&&qt.date_modification?new Date(Ie.value.date_modification):void 0,"plan-name":(mn=Ie.value)==null?void 0:mn.nom,"plan-description":(xn=Ie.value)==null?void 0:xn.description,"save-status":We.value,onChangeMapType:Xn(V),onCreateNewPlan:Ke[2]||(Ke[2]=ot=>pe.value=!0),onLoadPlan:Ke[3]||(Ke[3]=ot=>Ee.value=!0),onSavePlan:W,onAdjustView:re,onGenerateSummary:ye},null,8,["last-save","plan-name","plan-description","save-status","onChangeMapType"])])):Cn("",!0)])),A("div",GN,[A("div",VN,[A("div",{ref_key:"mapContainer",ref:t,class:"absolute inset-0 z-[1000]"},null,512)]),Ie.value&&!ae.value?(et(),rt("div",HN,[$r(TB,{"current-tool":Xn(l),"selected-shape":Ae.value,"all-layers":((wn=Xn(b))==null?void 0:wn.getLayers())||[],onToolChange:Xn(_),onStyleUpdate:Xn(w),onPropertiesUpdate:he,onDeleteShape:ee},null,8,["current-tool","selected-shape","all-layers","onToolChange","onStyleUpdate"])])):Cn("",!0)]),ae.value?(et(),rt("div",WN,Ke[12]||(Ke[12]=[Cc('<div class="text-center"><div class="mb-4"><svg class="animate-spin h-10 w-10 mx-auto text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></div><p class="text-lg font-medium text-gray-900">Génération de la synthèse en cours...</p><p class="text-sm text-gray-500 mt-2">Veuillez patienter pendant que nous analysons votre plan.</p></div>',1)]))):Cn("",!0)],512),[[_f,Ie.value]]),(et(),Yl(E0,{to:"body"},[$r(C4,{ref_key:"newPlanModalRef",ref:se,modelValue:pe.value,"onUpdate:modelValue":Ke[4]||(Ke[4]=ot=>pe.value=ot),onCreated:oe,onConcessionnaireSelected:Ke[5]||(Ke[5]=ot=>I.value=ot),onClientSelected:Ke[6]||(Ke[6]=ot=>Y.value=ot)},null,8,["modelValue"])])),(et(),Yl(E0,{to:"body"},[Ee.value?(et(),rt("div",ZN,[A("div",KN,[A("div",JN,[Ke[14]||(Ke[14]=A("h2",{class:"text-xl font-semibold text-gray-900"},"Charger un plan existant",-1)),A("button",{onClick:Ke[7]||(Ke[7]=ot=>Ee.value=!1),class:"text-gray-400 hover:text-gray-500 focus:outline-none"},Ke[13]||(Ke[13]=[A("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),A("div",YN,[Xn(O).isAdmin?(et(),rt("div",XN,[De.value?I.value?Y.value?(et(),rt("div",mD,[A("div",vD,[A("button",{onClick:nn,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},Ke[29]||(Ke[29]=[A("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),Ir(" Retour à la liste des clients ")])),Ke[30]||(Ke[30]=A("span",{class:"mx-2 text-gray-400"},"|",-1)),A("span",yD,Jt(st(Y.value)),1)]),Ke[32]||(Ke[32]=A("h3",{class:"font-medium text-gray-700"},"Plans disponibles",-1)),A("div",_D,[Z.value?(et(),rt(Vn,{key:0},$i(3,ot=>A("div",{key:ot,class:"animate-pulse"},Ke[31]||(Ke[31]=[A("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[A("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),A("div",{class:"h-4 bg-gray-100 rounded w-2/3 mb-2"}),A("div",{class:"h-3 bg-gray-50 rounded w-1/3"})],-1)]))),64)):(et(!0),rt(Vn,{key:1},$i(G.value,ot=>(et(),rt("button",{key:ot.id,onClick:de=>B(ot.id),class:"w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",wD,Jt(ot.nom),1),A("div",xD,Jt(ot.description),1),A("div",LD," Modifié le "+Jt(ne(ot.date_modification)),1)],8,bD))),128))])])):(et(),rt("div",uD,[A("div",cD,[A("button",{onClick:Ht,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},Ke[23]||(Ke[23]=[A("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),Ir(" Retour à la liste des concessionnaires ")])),Ke[24]||(Ke[24]=A("span",{class:"mx-2 text-gray-400"},"|",-1)),A("span",hD,Jt(st(I.value)),1)]),Ke[28]||(Ke[28]=A("h3",{class:"font-medium text-gray-700"},"Sélectionnez un agriculteur",-1)),A("div",fD,[R.value?(et(),rt(Vn,{key:0},$i(3,ot=>A("div",{key:ot,class:"animate-pulse"},Ke[25]||(Ke[25]=[A("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[A("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),A("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(et(),rt(Vn,{key:1},[ie.value.length===0?(et(),rt("div",dD,Ke[26]||(Ke[26]=[A("div",{class:"text-gray-500 mb-2"},"Aucun agriculteur trouvé pour ce concessionnaire",-1),A("div",{class:"text-sm text-gray-400"}," Veuillez vérifier que des agriculteurs ont été assignés à ce concessionnaire ",-1)]))):(et(!0),rt(Vn,{key:1},$i(ie.value,ot=>(et(),rt("button",{key:ot.id,onClick:de=>Qt(ot),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",null,[A("div",gD,Jt(st(ot)),1)]),Ke[27]||(Ke[27]=A("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,pD))),128))],64))])])):(et(),rt("div",iD,[A("div",rD,[A("button",{onClick:wt,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},Ke[18]||(Ke[18]=[A("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),Ir(" Retour à la liste des usines ")])),Ke[19]||(Ke[19]=A("span",{class:"mx-2 text-gray-400"},"|",-1)),A("span",sD,Jt(st(De.value)),1)]),Ke[22]||(Ke[22]=A("h3",{class:"font-medium text-gray-700"},"Sélectionnez un concessionnaire",-1)),A("div",oD,[$.value?(et(),rt(Vn,{key:0},$i(3,ot=>A("div",{key:ot,class:"animate-pulse"},Ke[20]||(Ke[20]=[A("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[A("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),A("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(et(!0),rt(Vn,{key:1},$i(ze.value,ot=>(et(),rt("button",{key:ot.id,onClick:de=>tt(ot),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",null,[A("div",lD,Jt(st(ot)),1)]),Ke[21]||(Ke[21]=A("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,aD))),128))])])):(et(),rt("div",QN,[Ke[17]||(Ke[17]=A("h3",{class:"font-medium text-gray-700"},"Sélectionnez une usine",-1)),A("div",eD,[Me.value?(et(),rt(Vn,{key:0},$i(3,ot=>A("div",{key:ot,class:"animate-pulse"},Ke[15]||(Ke[15]=[A("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[A("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),A("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(et(!0),rt(Vn,{key:1},$i(Ve.value,ot=>(et(),rt("button",{key:ot.id,onClick:de=>pt(ot),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",null,[A("div",nD,Jt(st(ot)),1)]),Ke[16]||(Ke[16]=A("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,tD))),128))])]))])):Xn(O).isConcessionnaire?(et(),rt("div",CD,[Y.value?(et(),rt("div",MD,[A("div",TD,[A("button",{onClick:nn,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},Ke[37]||(Ke[37]=[A("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),Ir(" Retour à la liste des clients ")])),Ke[38]||(Ke[38]=A("span",{class:"mx-2 text-gray-400"},"|",-1)),A("span",BD,Jt(st(Y.value)),1)]),Ke[40]||(Ke[40]=A("h3",{class:"font-medium text-gray-700"},"Plans disponibles",-1)),A("div",ND,[Z.value?(et(),rt(Vn,{key:0},$i(3,ot=>A("div",{key:ot,class:"animate-pulse"},Ke[39]||(Ke[39]=[A("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[A("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),A("div",{class:"h-4 bg-gray-100 rounded w-2/3 mb-2"}),A("div",{class:"h-3 bg-gray-50 rounded w-1/3"})],-1)]))),64)):(et(!0),rt(Vn,{key:1},$i(G.value,ot=>(et(),rt("button",{key:ot.id,onClick:de=>B(ot.id),class:"w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",RD,Jt(ot.nom),1),A("div",OD,Jt(ot.description),1),A("div",ID," Modifié le "+Jt(ne(ot.date_modification)),1)],8,DD))),128))])])):(et(),rt("div",SD,[Ke[36]||(Ke[36]=A("h3",{class:"font-medium text-gray-700"},"Sélectionnez un agriculteur",-1)),A("div",PD,[R.value?(et(),rt(Vn,{key:0},$i(3,ot=>A("div",{key:ot,class:"animate-pulse"},Ke[33]||(Ke[33]=[A("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[A("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),A("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(et(),rt(Vn,{key:1},[ie.value.length===0?(et(),rt("div",ED,Ke[34]||(Ke[34]=[A("div",{class:"text-gray-500 mb-2"},"Aucun agriculteur trouvé pour ce concessionnaire",-1),A("div",{class:"text-sm text-gray-400"}," Veuillez vérifier que des agriculteurs ont été assignés à ce concessionnaire ",-1)]))):(et(!0),rt(Vn,{key:1},$i(ie.value,ot=>(et(),rt("button",{key:ot.id,onClick:de=>Qt(ot),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",null,[A("div",kD,Jt(st(ot)),1)]),Ke[35]||(Ke[35]=A("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,AD))),128))],64))])]))])):Xn(O).isUsine?(et(),rt("div",FD,Jt(Xn(O).isUsine?"...":""),1)):(et(),rt("div",zD,[Xn(i).plans.length===0?(et(),rt("div",jD,Ke[41]||(Ke[41]=[A("p",{class:"text-gray-500"},"Aucun plan disponible",-1)]))):(et(),rt("div",UD,[(et(!0),rt(Vn,null,$i(Xn(i).plans,ot=>(et(),rt("button",{key:ot.id,onClick:de=>B(ot.id),class:"w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[A("div",qD,Jt(ot.nom),1),A("div",GD,Jt(ot.description),1),A("div",VD," Modifié le "+Jt(ne(ot.date_modification)),1)],8,$D))),128))]))]))])])])):Cn("",!0)]))])])}}}),HD={class:"fixed inset-0 z-50 overflow-y-auto"},WD={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0"},ZD={class:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"},KD={class:"mt-3 text-center sm:mt-0 sm:text-left"},JD={class:"text-lg leading-6 font-medium text-gray-900",id:"modal-headline"},YD={class:"mt-4"},XD={key:0,class:"mb-4 rounded-md bg-red-50 p-4"},QD={class:"flex"},eR={class:"ml-3"},tR={class:"text-sm font-medium text-red-800"},nR={key:0},iR={key:1},rR=["value"],sR={key:2},oR={key:3},aR=["value"],lR={class:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-2"},uR={key:0,class:"mt-2 text-sm text-red-600"},cR={key:0,class:"mt-2 text-sm text-red-600"},hR={key:4},fR={key:5},dR={key:0,class:"mt-2 text-sm text-red-600"},pR={class:"flex justify-end space-x-3"},gR=["disabled"],mR={key:0,class:"mr-2"},vR=Pa({__name:"UserFormModal",props:{user:{type:Object,default:()=>({})},concessionnaires:{type:Array,default:()=>[]},usines:{type:Array,default:()=>[]},isAdmin:{type:Boolean,default:!1},isUsine:{type:Boolean,default:!1},currentConcessionnaire:{type:String,default:void 0},currentUsine:{type:String,default:void 0},apiErrors:{type:Array,default:()=>[]},refreshKey:{type:Number,default:0}},emits:["close","save","refresh"],setup(e,{emit:n}){const t=e,i=n,r=Yt(!1),o=Yt(""),l=Yt(""),h=Yt(""),p=Yt(""),m=Yt(""),_=ku({id:void 0,first_name:"",last_name:"",username:"",email:"",password:"",company_name:"",role:t.isUsine?"CONCESSIONNAIRE":t.isAdmin?"ADMIN":"AGRICULTEUR",concessionnaire:null,usine:null,is_active:!0});Ha(()=>{var E;(E=t.user)!=null&&E.id?(_.id=t.user.id,_.first_name=t.user.first_name||"",_.last_name=t.user.last_name||"",_.username=t.user.username||"",_.email=t.user.email||"",_.company_name=t.user.company_name||"",_.role=t.user.role||"AGRICULTEUR",_.is_active=t.user.is_active??!0,t.user.concessionnaire?typeof t.user.concessionnaire=="object"?_.concessionnaire=t.user.concessionnaire.id:_.concessionnaire=t.user.concessionnaire:t.user.concessionnaire_id?_.concessionnaire=t.user.concessionnaire_id:t.currentConcessionnaire&&(_.concessionnaire=parseInt(t.currentConcessionnaire)),t.user.usine?typeof t.user.usine=="object"?_.usine=t.user.usine.id:_.usine=t.user.usine:t.user.usine_id?_.usine=t.user.usine_id:t.currentUsine&&(_.usine=parseInt(t.currentUsine))):(t.currentConcessionnaire&&(_.concessionnaire=parseInt(t.currentConcessionnaire)),t.currentUsine&&(_.usine=parseInt(t.currentUsine)),t.isUsine?_.role="CONCESSIONNAIRE":t.isAdmin||(_.role="AGRICULTEUR"))}),hg(()=>{_.role==="ADMIN"||_.role==="USINE"?(_.concessionnaire=null,_.usine=null):_.role==="CONCESSIONNAIRE"&&(_.concessionnaire=null,t.isUsine&&t.currentUsine&&(_.usine=parseInt(t.currentUsine)))}),hg(()=>{o.value="",l.value="",h.value="",p.value="",t.apiErrors&&t.apiErrors.length>0&&t.apiErrors.forEach(E=>{switch(E.field){case"email":o.value=E.message;break;case"username":l.value=E.message;break;case"password":h.value=E.message;break;case"non_field_error":default:p.value=E.message;break}})});async function w(){o.value="",l.value="",h.value="",p.value="";let E=!0;if(_.id||(_.password!==m.value?(h.value="Les mots de passe ne correspondent pas",E=!1):_.password.length<8&&(h.value="Le mot de passe doit contenir au moins 8 caractères",E=!1)),!!E){r.value=!0;try{const b={..._};_.id&&delete b.password,t.isUsine&&["CONCESSIONNAIRE","AGRICULTEUR"].includes(_.role)&&(b.usine_id=t.currentUsine?parseInt(t.currentUsine):void 0),b.concessionnaire&&(b.concessionnaire_id=b.concessionnaire,delete b.concessionnaire),t.currentConcessionnaire&&_.role==="AGRICULTEUR"&&(b.concessionnaire_id=parseInt(t.currentConcessionnaire)),await i("save",b),i("refresh")}catch(b){console.error("Erreur locale:",b)}finally{r.value=!1}}}return(E,b)=>(et(),rt("div",HD,[A("div",WD,[b[29]||(b[29]=A("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[A("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),b[30]||(b[30]=A("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),A("div",ZD,[A("div",null,[A("div",KD,[A("h3",JD,Jt(e.user?"Modifier l'utilisateur":"Nouvel utilisateur"),1),A("div",YD,[p.value?(et(),rt("div",XD,[A("div",QD,[b[12]||(b[12]=A("div",{class:"flex-shrink-0"},[A("svg",{class:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),A("div",eR,[A("h3",tR,Jt(p.value),1)])])])):Cn("",!0),A("form",{onSubmit:Bp(w,["prevent"]),class:"space-y-6"},[e.isAdmin?(et(),rt("div",nR,[b[14]||(b[14]=A("label",{for:"role",class:"block text-sm font-medium text-gray-700"},"Type d'utilisateur",-1)),zn(A("select",{id:"role","onUpdate:modelValue":b[0]||(b[0]=D=>_.role=D),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:""},b[13]||(b[13]=[A("option",{value:"ADMIN"},"Administrateur",-1),A("option",{value:"USINE"},"Usine",-1),A("option",{value:"CONCESSIONNAIRE"},"Concessionnaire",-1),A("option",{value:"AGRICULTEUR"},"Agriculteur",-1)]),512),[[Ks,_.role]])])):Cn("",!0),e.isAdmin&&_.role==="CONCESSIONNAIRE"?(et(),rt("div",iR,[b[16]||(b[16]=A("label",{for:"usine",class:"block text-sm font-medium text-gray-700"},"Usine",-1)),zn(A("select",{id:"usine","onUpdate:modelValue":b[1]||(b[1]=D=>_.usine=D),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},[b[15]||(b[15]=A("option",{value:null},"-- Sélectionner une usine --",-1)),(et(!0),rt(Vn,null,$i(e.usines,D=>(et(),rt("option",{key:D.id,value:D.id},Jt(D.first_name)+" "+Jt(D.last_name)+" ("+Jt(D.company_name||"Usine")+") ",9,rR))),128))],512),[[Ks,_.usine]])])):Cn("",!0),e.isUsine&&!_.id?(et(),rt("div",sR,[b[18]||(b[18]=A("label",{for:"role",class:"block text-sm font-medium text-gray-700"},"Type d'utilisateur",-1)),zn(A("select",{id:"role","onUpdate:modelValue":b[2]||(b[2]=D=>_.role=D),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:""},b[17]||(b[17]=[A("option",{value:"CONCESSIONNAIRE"},"Concessionnaire",-1),A("option",{value:"AGRICULTEUR"},"Agriculteur",-1)]),512),[[Ks,_.role]])])):Cn("",!0),(e.isAdmin||e.isUsine)&&_.role==="AGRICULTEUR"&&!e.currentConcessionnaire?(et(),rt("div",oR,[b[20]||(b[20]=A("label",{for:"concessionnaire",class:"block text-sm font-medium text-gray-700"},"Concessionnaire",-1)),zn(A("select",{id:"concessionnaire","onUpdate:modelValue":b[3]||(b[3]=D=>_.concessionnaire=D),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:""},[b[19]||(b[19]=A("option",{value:null},"-- Sélectionner un concessionnaire --",-1)),(et(!0),rt(Vn,null,$i(e.concessionnaires,D=>(et(),rt("option",{key:D.id,value:D.id},Jt(D.first_name)+" "+Jt(D.last_name)+" ("+Jt(D.company_name||"Concessionnaire")+") ",9,aR))),128))],512),[[Ks,_.concessionnaire]])])):Cn("",!0),A("div",lR,[A("div",null,[b[21]||(b[21]=A("label",{for:"first_name",class:"block text-sm font-medium text-gray-700"},"Prénom",-1)),zn(A("input",{type:"text",id:"first_name","onUpdate:modelValue":b[4]||(b[4]=D=>_.first_name=D),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Ui,_.first_name]])]),A("div",null,[b[22]||(b[22]=A("label",{for:"last_name",class:"block text-sm font-medium text-gray-700"},"Nom",-1)),zn(A("input",{type:"text",id:"last_name","onUpdate:modelValue":b[5]||(b[5]=D=>_.last_name=D),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Ui,_.last_name]])])]),A("div",null,[b[23]||(b[23]=A("label",{for:"email",class:"block text-sm font-medium text-gray-700"},"Email",-1)),zn(A("input",{type:"email",id:"email","onUpdate:modelValue":b[6]||(b[6]=D=>_.email=D),required:"",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Ui,_.email]]),o.value?(et(),rt("div",uR,Jt(o.value),1)):Cn("",!0)]),A("div",null,[b[24]||(b[24]=A("label",{for:"username",class:"block text-sm font-medium text-gray-700"},"Nom d'utilisateur",-1)),zn(A("input",{type:"text",id:"username","onUpdate:modelValue":b[7]||(b[7]=D=>_.username=D),required:"",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Ui,_.username]]),l.value?(et(),rt("div",cR,Jt(l.value),1)):Cn("",!0)]),A("div",null,[b[25]||(b[25]=A("label",{for:"company_name",class:"block text-sm font-medium text-gray-700"},"Entreprise",-1)),zn(A("input",{type:"text",id:"company_name","onUpdate:modelValue":b[8]||(b[8]=D=>_.company_name=D),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Ui,_.company_name]])]),_.id?Cn("",!0):(et(),rt("div",hR,[b[26]||(b[26]=A("label",{for:"password",class:"block text-sm font-medium text-gray-700"},"Mot de passe",-1)),zn(A("input",{type:"password",id:"password","onUpdate:modelValue":b[9]||(b[9]=D=>_.password=D),required:"",autocomplete:"new-password",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Ui,_.password]])])),_.id?Cn("",!0):(et(),rt("div",fR,[b[27]||(b[27]=A("label",{for:"password_confirm",class:"block text-sm font-medium text-gray-700"},"Confirmer le mot de passe",-1)),zn(A("input",{type:"password",id:"password_confirm","onUpdate:modelValue":b[10]||(b[10]=D=>m.value=D),required:"",autocomplete:"new-password",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Ui,m.value]]),h.value?(et(),rt("div",dR,Jt(h.value),1)):Cn("",!0)])),A("div",pR,[A("button",{type:"button",onClick:b[11]||(b[11]=D=>E.$emit("close")),class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"}," Annuler "),A("button",{type:"submit",disabled:r.value,class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},[r.value?(et(),rt("span",mR,b[28]||(b[28]=[A("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[A("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),A("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):Cn("",!0),Ir(" "+Jt(_.id?"Enregistrer":"Créer"),1)],8,gR)])],32)])])])])])]))}}),yR={class:"fixed inset-0 z-50 overflow-y-auto"},_R={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0"},bR={class:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"},wR={class:"sm:flex sm:items-start"},xR={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"},LR={class:"text-lg leading-6 font-medium text-gray-900",id:"modal-headline"},CR={class:"mt-2"},SR={class:"text-sm text-gray-500"},PR={class:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse"},H4=Pa({__name:"ConfirmationModal",props:{title:{type:String,required:!0},message:{type:String,required:!0}},emits:["confirm","cancel"],setup(e){return(n,t)=>(et(),rt("div",yR,[A("div",_R,[t[3]||(t[3]=A("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[A("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),t[4]||(t[4]=A("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),A("div",bR,[A("div",wR,[t[2]||(t[2]=A("div",{class:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10"},[A("svg",{class:"h-6 w-6 text-red-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),A("div",xR,[A("h3",LR,Jt(e.title),1),A("div",CR,[A("p",SR,Jt(e.message),1)])])]),A("div",PR,[A("button",{type:"button",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:t[0]||(t[0]=i=>n.$emit("confirm"))}," Confirmer "),A("button",{type:"button",class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:mt-0 sm:w-auto sm:text-sm",onClick:t[1]||(t[1]=i=>n.$emit("cancel"))}," Annuler ")])])])]))}}),ER={class:"h-full bg-gray-50"},AR={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},kR={class:"flex justify-between items-center mb-8"},MR={class:"text-3xl font-extrabold text-gray-900"},TR={key:0},BR={key:1},NR={key:2},DR={key:0},RR={key:1},OR={key:2},IR={class:"bg-white shadow rounded-lg mb-6 p-4"},FR={class:"space-y-4"},zR={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},jR={key:0},UR={key:0,value:"ADMIN"},$R={key:1,value:"USINE"},qR={key:1},GR=["value"],VR={key:2},HR=["value"],WR={class:"w-full"},ZR={class:"bg-white shadow rounded-lg"},KR={class:"overflow-x-auto"},JR={class:"min-w-full divide-y divide-gray-200"},YR={class:"bg-gray-50"},XR={key:0,scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},QR={key:1,scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},eO={class:"bg-white divide-y divide-gray-200"},tO={key:0,class:"animate-pulse"},nO={key:1},iO={class:"px-6 py-4 whitespace-nowrap"},rO={class:"flex items-center"},sO={class:"flex-shrink-0 h-10 w-10"},oO={class:"h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center"},aO={class:"text-primary-600 font-medium"},lO={class:"ml-4"},uO={class:"text-sm font-medium text-gray-900"},cO={class:"text-sm text-gray-500"},hO={class:"px-6 py-4 whitespace-nowrap"},fO={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},dO={key:0,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},pO={key:1,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},gO={class:"px-6 py-4 whitespace-nowrap"},mO={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},vO=["onClick"],yO=["onClick"],_O=Pa({__name:"UserListView",setup(e){const n=Va(),t=Nf(),i=Yt([]),r=Yt([]),o=Yt([]),l=Yt(!1),h=Yt(!1),p=Yt(null),m=Yt(null),_=Yt(!0),w=Yt([]),E=ku({role:"",search:"",concessionnaire:"",usine:""}),b=Di(()=>n.isAdmin),D=Di(()=>n.isUsine),j=Di(()=>n.isConcessionnaire),Q=Di(()=>b.value?i.value.filter($=>$.role==="CONCESSIONNAIRE"):D.value?i.value.filter($=>{var R,Z;return $.role==="CONCESSIONNAIRE"&&((R=$.usine)==null?void 0:R.id)===((Z=n.user)==null?void 0:Z.id)}):[]),F=Di(()=>{let $=i.value;if(D.value&&($=$.filter(R=>{var Z,se,ie,Ae,Te;return R.role==="CONCESSIONNAIRE"?((Z=R.usine)==null?void 0:Z.id)===((se=n.user)==null?void 0:se.id):R.role==="AGRICULTEUR"?((Ae=(ie=R.concessionnaire)==null?void 0:ie.usine)==null?void 0:Ae.id)===((Te=n.user)==null?void 0:Te.id):!1})),j.value&&($=$.filter(R=>{var Z,se;return R.role==="AGRICULTEUR"&&(R.concessionnaire_id===((Z=n.user)==null?void 0:Z.id)||R.concessionnaire&&R.concessionnaire.id===((se=n.user)==null?void 0:se.id))})),(b.value||D.value)&&(E.role&&($=$.filter(R=>R.role===E.role)),E.concessionnaire&&($=$.filter(R=>{var se;const Z=((se=R.concessionnaire)==null?void 0:se.id)||R.concessionnaire_id;return(Z==null?void 0:Z.toString())===E.concessionnaire.toString()})),E.usine&&b.value&&($=$.filter(R=>{var Z,se,ie,Ae,Te;return R.role==="CONCESSIONNAIRE"?((se=(Z=R.usine)==null?void 0:Z.id)==null?void 0:se.toString())===E.usine.toString():R.role==="AGRICULTEUR"?((Te=(Ae=(ie=R.concessionnaire)==null?void 0:ie.usine)==null?void 0:Ae.id)==null?void 0:Te.toString())===E.usine.toString():!1}))),E.search){const R=E.search.toLowerCase();$=$.filter(Z=>{var se,ie,Ae,Te;return((se=Z.username)==null?void 0:se.toLowerCase().includes(R))||((ie=Z.email)==null?void 0:ie.toLowerCase().includes(R))||((Ae=Z.first_name)==null?void 0:Ae.toLowerCase().includes(R))||((Te=Z.last_name)==null?void 0:Te.toLowerCase().includes(R))||Z.company_name&&Z.company_name.toLowerCase().includes(R)})}return $});Ha(async()=>{await V(),await pe()});async function V(){var $,R,Z;_.value=!0;try{if(b.value)i.value=await n.fetchUsers();else if(D.value){const[se,ie]=await Promise.all([$d({role:"CONCESSIONNAIRE",usineId:($=n.user)==null?void 0:$.id}),$d({role:"AGRICULTEUR",usineId:(R=n.user)==null?void 0:R.id})]);i.value=[...se,...ie]}else j.value&&(i.value=await $d({role:"AGRICULTEUR",concessionnaireId:(Z=n.user)==null?void 0:Z.id,includeDetails:!0}),console.log("Agriculteurs récupérés:",i.value))}catch(se){console.error("Erreur lors de la récupération des utilisateurs:",se),t.error("Erreur lors de la récupération des utilisateurs")}finally{_.value=!1}}async function pe(){try{b.value?await Promise.all([Ee(),nt()]):D.value&&await Ie()}catch($){console.error("Erreur lors de la récupération des dépendances:",$)}}async function Ee(){var $;try{b.value?r.value=await n.fetchUsersByRole({role:"CONCESSIONNAIRE"}):D.value&&(r.value=await n.fetchUsineConcessionnaires(($=n.user)==null?void 0:$.id))}catch(R){console.error("Erreur lors de la récupération des concessionnaires:",R)}}async function Ie(){var $,R;if(!(!D.value||!(($=n.user)!=null&&$.id)))try{r.value=await n.fetchUsineConcessionnaires((R=n.user)==null?void 0:R.id)}catch(Z){console.error("Erreur lors de la récupération des concessionnaires de l'usine:",Z)}}async function nt(){try{o.value=await n.fetchUsines()}catch($){console.error("Erreur lors de la récupération des usines:",$)}}function We(){p.value=null,l.value=!0}function O($){p.value={...$},l.value=!0}function H(){l.value=!1,p.value=null,w.value=[]}async function le($){var Z,se,ie,Ae,Te,ut;w.value=[];const R=!!$.id;try{const X={...$};b.value?(X.usine&&typeof X.usine=="object"?X.usine_id=X.usine.id:typeof X.usine=="number"&&(X.usine_id=X.usine),X.concessionnaire&&typeof X.concessionnaire=="object"?X.concessionnaire_id=X.concessionnaire.id:typeof X.concessionnaire=="number"&&(X.concessionnaire_id=X.concessionnaire)):D.value?(X.usine_id=(Z=n.user)==null?void 0:Z.id,X.role==="AGRICULTEUR"&&(X.concessionnaire&&typeof X.concessionnaire=="object"?X.concessionnaire_id=X.concessionnaire.id:typeof X.concessionnaire=="number"&&(X.concessionnaire_id=X.concessionnaire))):j.value&&(X.role="AGRICULTEUR",X.concessionnaire_id=(se=n.user)==null?void 0:se.id),X.role==="CONCESSIONNAIRE"?((ie=X.usine)!=null&&ie.id?(X.usine_id=X.usine.id,delete X.usine):typeof X.usine=="number"&&(X.usine_id=X.usine,delete X.usine),delete X.concessionnaire):X.role==="AGRICULTEUR"&&((Ae=X.concessionnaire)!=null&&Ae.id?(X.concessionnaire_id=X.concessionnaire.id,delete X.concessionnaire):typeof X.concessionnaire=="number"&&(X.concessionnaire_id=X.concessionnaire,delete X.concessionnaire),delete X.usine,delete X.usine_id),R?(await n.updateUser($.id,X),t.success("Utilisateur modifié avec succès")):(await n.createUser(X),t.success("Utilisateur créé avec succès")),await Promise.all([V(),pe()]),H()}catch(X){console.error("Error saving user:",((Te=X.response)==null?void 0:Te.data)||X),w.value=iE(X),t.error("Erreur lors de la sauvegarde de l'utilisateur");const ke=((ut=X.response)==null?void 0:ut.data)||{};let B="";throw typeof ke=="object"&&(B=Object.entries(ke).map(([W,he])=>Array.isArray(he)?`${W}: ${he[0]}`:`${W}: ${he}`).filter(W=>W).join(`
`)),B||(B="Une erreur est survenue lors de la sauvegarde"),new Error(B)}}function G($){m.value=$,h.value=!0}async function I(){if(m.value)try{await n.deleteUser(m.value.id),t.success("Utilisateur supprimé avec succès"),await Promise.all([V(),pe()]),h.value=!1,m.value=null}catch($){throw console.error("Erreur lors de la suppression de l'utilisateur:",$),t.error("Erreur lors de la suppression de l'utilisateur"),$}}function Y($){var R,Z,se,ie,Ae,Te,ut,X;return b.value?!0:D.value?$.role==="CONCESSIONNAIRE"?((R=$.usine)==null?void 0:R.id)===((Z=n.user)==null?void 0:Z.id):$.role==="AGRICULTEUR"?((ie=(se=$.concessionnaire)==null?void 0:se.usine)==null?void 0:ie.id)===((Ae=n.user)==null?void 0:Ae.id):!1:j.value?$.role==="AGRICULTEUR"&&($.concessionnaire_id===((Te=n.user)==null?void 0:Te.id)||((ut=$.concessionnaire)==null?void 0:ut.id)===((X=n.user)==null?void 0:X.id)):!1}return($,R)=>{var Z,se,ie,Ae;return et(),rt("div",ER,[A("div",AR,[A("div",kR,[A("h1",MR,[b.value?(et(),rt("span",TR,"Gestion des utilisateurs")):D.value?(et(),rt("span",BR,"Gestion des concessionnaires et agriculteurs")):j.value?(et(),rt("span",NR,"Gestion des agriculteurs")):Cn("",!0)]),A("button",{onClick:We,class:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},[R[5]||(R[5]=A("svg",{class:"-ml-1 mr-2 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z","clip-rule":"evenodd"})],-1)),b.value?(et(),rt("span",DR,"Nouvel utilisateur")):D.value?(et(),rt("span",RR,"Nouveau concessionnaire/agriculteur")):j.value?(et(),rt("span",OR,"Nouvel agriculteur")):Cn("",!0)])]),A("div",IR,[A("div",FR,[A("div",zR,[b.value||D.value?(et(),rt("div",jR,[R[9]||(R[9]=A("label",{for:"role-filter",class:"block text-sm font-medium text-gray-700"},"Rôle",-1)),zn(A("select",{id:"role-filter","onUpdate:modelValue":R[0]||(R[0]=Te=>E.role=Te),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[R[6]||(R[6]=A("option",{value:""},"Tous les rôles",-1)),b.value?(et(),rt("option",UR,"Administrateur")):Cn("",!0),b.value?(et(),rt("option",$R,"Usine")):Cn("",!0),R[7]||(R[7]=A("option",{value:"CONCESSIONNAIRE"},"Concessionnaire",-1)),R[8]||(R[8]=A("option",{value:"AGRICULTEUR"},"Agriculteur",-1))],512),[[Ks,E.role]])])):Cn("",!0),b.value?(et(),rt("div",qR,[R[11]||(R[11]=A("label",{for:"usine-filter",class:"block text-sm font-medium text-gray-700"},"Usine",-1)),zn(A("select",{id:"usine-filter","onUpdate:modelValue":R[1]||(R[1]=Te=>E.usine=Te),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[R[10]||(R[10]=A("option",{value:""},"Toutes les usines",-1)),(et(!0),rt(Vn,null,$i(o.value,Te=>(et(),rt("option",{key:Te.id,value:Te.id},Jt(Xn(ll)(Te)),9,GR))),128))],512),[[Ks,E.usine]])])):Cn("",!0),b.value||D.value?(et(),rt("div",VR,[R[13]||(R[13]=A("label",{for:"concessionnaire-filter",class:"block text-sm font-medium text-gray-700"},"Concessionnaire",-1)),zn(A("select",{id:"concessionnaire-filter","onUpdate:modelValue":R[2]||(R[2]=Te=>E.concessionnaire=Te),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[R[12]||(R[12]=A("option",{value:""},"Tous les concessionnaires",-1)),(et(!0),rt(Vn,null,$i(Q.value,Te=>(et(),rt("option",{key:Te.id,value:Te.id},Jt(Xn(ll)(Te)),9,HR))),128))],512),[[Ks,E.concessionnaire]])])):Cn("",!0)]),A("div",WR,[R[14]||(R[14]=A("label",{for:"search",class:"block text-sm font-medium text-gray-700"},"Recherche",-1)),zn(A("input",{type:"text",id:"search","onUpdate:modelValue":R[3]||(R[3]=Te=>E.search=Te),placeholder:"Rechercher par nom, email, entreprise...",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},null,512),[[Ui,E.search]])])])]),A("div",ZR,[A("div",KR,[A("table",JR,[A("thead",YR,[A("tr",null,[R[15]||(R[15]=A("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Utilisateur ",-1)),R[16]||(R[16]=A("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Rôle ",-1)),R[17]||(R[17]=A("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Email ",-1)),b.value||D.value?(et(),rt("th",XR," Usine ")):Cn("",!0),b.value||D.value?(et(),rt("th",QR," Concessionnaire ")):Cn("",!0),R[18]||(R[18]=A("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Statut ",-1)),R[19]||(R[19]=A("th",{scope:"col",class:"relative px-6 py-3"},[A("span",{class:"sr-only"},"Actions")],-1))])]),A("tbody",eO,[_.value?(et(),rt("tr",tO,R[20]||(R[20]=[A("td",{colspan:"7",class:"py-4 px-6"},[A("div",{class:"h-4 bg-gray-200 rounded w-3/4"})],-1)]))):F.value.length===0?(et(),rt("tr",nO,R[21]||(R[21]=[A("td",{colspan:"7",class:"py-4 px-6 text-center text-gray-500"}," Aucun utilisateur trouvé ",-1)]))):Cn("",!0),(et(!0),rt(Vn,null,$i(F.value,Te=>{var ut;return et(),rt("tr",{key:Te.id},[A("td",iO,[A("div",rO,[A("div",sO,[A("div",oO,[A("span",aO,Jt(Xn(sE)(Te.first_name,Te.last_name)),1)])]),A("div",lO,[A("div",uO,Jt(Xn(ll)(Te)),1),A("div",cO,Jt(Te.username),1)])])]),A("td",hO,[A("span",{class:Jr(Xn(lE)())},Jt(Xn(aE)(Te.role)),3)]),A("td",fO,Jt(Te.email),1),b.value||D.value?(et(),rt("td",dO,[Te.role==="USINE"?(et(),rt(Vn,{key:0},[Ir(" - ")],64)):Te.role==="CONCESSIONNAIRE"?(et(),rt(Vn,{key:1},[Ir(Jt(Te.usine?Xn(ll)(Te.usine):"Non assigné"),1)],64)):Te.role==="AGRICULTEUR"?(et(),rt(Vn,{key:2},[Ir(Jt((ut=Te.concessionnaire)!=null&&ut.usine?Xn(ll)(Te.concessionnaire.usine):"Non assigné"),1)],64)):(et(),rt(Vn,{key:3},[Ir(" - ")],64))])):Cn("",!0),b.value||D.value?(et(),rt("td",pO,[Te.role==="USINE"||Te.role==="ADMIN"?(et(),rt(Vn,{key:0},[Ir(" - ")],64)):Te.role==="CONCESSIONNAIRE"?(et(),rt(Vn,{key:1},[Ir(" - ")],64)):(et(),rt(Vn,{key:2},[Ir(Jt(Te.concessionnaire?Xn(ll)(Te.concessionnaire):"Non assigné"),1)],64))])):Cn("",!0),A("td",gO,[A("span",{class:Jr(Xn(uE)(Te.is_active))},Jt(Te.is_active?"Actif":"Inactif"),3)]),A("td",mO,[A("button",{onClick:X=>O(Te),class:"text-primary-600 hover:text-primary-900 mr-4"}," Modifier ",8,vO),Y(Te)?(et(),rt("button",{key:0,onClick:X=>G(Te),class:"text-red-600 hover:text-red-900"}," Supprimer ",8,yO)):Cn("",!0)])])}),128))])])])])]),l.value?(et(),Yl(vR,{key:0,user:p.value,concessionnaires:r.value,usines:o.value,"is-admin":b.value,"is-usine":D.value,"current-concessionnaire":j.value?(se=(Z=Xn(n).user)==null?void 0:Z.id)==null?void 0:se.toString():void 0,"current-usine":D.value?(Ae=(ie=Xn(n).user)==null?void 0:ie.id)==null?void 0:Ae.toString():void 0,"api-errors":w.value,onClose:H,onSave:le},null,8,["user","concessionnaires","usines","is-admin","is-usine","current-concessionnaire","current-usine","api-errors"])):Cn("",!0),h.value?(et(),Yl(H4,{key:1,title:"Supprimer l'utilisateur",message:"Êtes-vous sûr de vouloir supprimer cet utilisateur ? Cette action est irréversible.",onConfirm:I,onCancel:R[4]||(R[4]=Te=>h.value=!1)})):Cn("",!0)])}}}),bO={class:"h-full bg-gray-50"},wO={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},xO={class:"sm:flex sm:items-center"},LO={class:"sm:flex-auto"},CO={class:"text-2xl font-semibold text-gray-900"},SO={class:"mt-2 text-sm text-gray-700"},PO={key:0,class:"mt-8"},EO={class:"mb-6"},AO=["value"],kO={class:"mb-6"},MO={value:null},TO=["value"],BO={key:0,class:"mb-6"},NO={value:null},DO=["value"],RO={key:1,class:"mt-8"},OO={class:"mb-6"},IO=["value"],FO={class:"mt-8"},zO={class:"overflow-hidden shadow-sm ring-1 ring-black ring-opacity-5 rounded-lg"},jO={class:"overflow-x-auto"},UO={class:"min-w-full divide-y divide-gray-300"},$O={class:"bg-gray-50"},qO={scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6 lg:pl-8"},GO={class:"ml-2 flex-none rounded"},VO={scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},HO={class:"ml-2 flex-none rounded"},WO={class:"divide-y divide-gray-200 bg-white"},ZO={key:0},KO={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 lg:pl-8"},JO={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},YO={class:"px-3 py-4 text-sm text-gray-900"},XO={key:0,class:"flex items-center"},QO={class:"h-8 w-8 flex-shrink-0"},eI={class:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center"},tI={class:"text-primary-700 font-medium text-sm"},nI={class:"ml-3"},iI={class:"font-medium"},rI={key:1,class:"text-gray-500"},sI={class:"px-3 py-4 text-sm text-gray-900"},oI={key:0,class:"flex items-center"},aI={class:"h-8 w-8 flex-shrink-0"},lI={class:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center"},uI={class:"text-primary-700 font-medium text-sm"},cI={class:"ml-3"},hI={class:"font-medium"},fI={key:1,class:"text-gray-500"},dI={class:"px-3 py-4 text-sm text-gray-900"},pI={key:0,class:"flex items-center"},gI={class:"h-8 w-8 flex-shrink-0"},mI={class:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center"},vI={class:"text-primary-700 font-medium text-sm"},yI={class:"ml-3"},_I={class:"font-medium"},bI={key:1,class:"text-gray-500"},wI={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},xI={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6 lg:pr-8"},LI=["onClick"],CI=["onClick"],SI=["onClick"],PI={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[2000]"},EI={class:"bg-white rounded-lg p-6 max-w-md w-full"},AI={class:"flex justify-between items-center mb-4"},kI=["disabled"],MI=["disabled"],TI={key:0,class:"space-y-4"},BI={key:0},NI=["disabled"],DI=["value"],RI=["disabled"],OI=["value"],II={key:0,class:"mt-1 text-sm text-gray-500"},FI=["disabled"],zI=["value"],jI={key:0,class:"mt-1 text-sm text-gray-500"},UI={key:1,class:"mt-4 bg-red-50 p-4 rounded-md"},$I={class:"flex"},qI={class:"ml-3"},GI={class:"text-sm font-medium text-red-800"},VI={class:"mt-5 sm:mt-6 sm:grid sm:grid-cols-2 sm:gap-3"},HI=["disabled"],WI={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},ZI=Pa({__name:"PlansView",setup(e){const n=Gp(),t=Lm(),i=Va(),r=Yt([]),o=Yt([]),l=Yt([]),h=Yt([]),p=Yt(!1),m=Yt(!1),_=Yt(!1),w=Yt(null),E=Yt({nom:"",description:"",client:null}),b=Yt({id:0,nom:"",description:"",usine:null,concessionnaire:null,agriculteur:null}),D=Yt(!1),j=Yt(null),Q=Yt(null),F=Yt(null),V=Yt("date_modification"),pe=Yt("desc"),Ee=Yt(null),Ie=Di(()=>Q.value?h.value.filter(re=>typeof re.concessionnaire=="object"&&re.concessionnaire?re.concessionnaire.id===Q.value:re.concessionnaire===Q.value||re.concessionnaire_id===Q.value):h.value),nt=Di(()=>{let re=r.value;console.log(`
[PlansView] Filtering plans:`,re.map(oe=>({id:oe.id,usine:oe.usine,concessionnaire:oe.concessionnaire,agriculteur:oe.agriculteur}))),i.isAdmin?(Ee.value&&(re=re.filter(oe=>{var Se;return typeof oe.usine=="object"?((Se=oe.usine)==null?void 0:Se.id)===Ee.value:oe.usine===Ee.value})),Q.value&&(re=re.filter(oe=>{var Se;return typeof oe.concessionnaire=="object"?((Se=oe.concessionnaire)==null?void 0:Se.id)===Q.value:oe.concessionnaire===Q.value}),F.value&&(re=re.filter(oe=>{var Se;return typeof oe.agriculteur=="object"?((Se=oe.agriculteur)==null?void 0:Se.id)===F.value:oe.agriculteur===F.value})))):i.isConcessionnaire&&(re=re.filter(oe=>{var Se,te,ae;return typeof oe.concessionnaire=="object"?((Se=oe.concessionnaire)==null?void 0:Se.id)===((te=i.user)==null?void 0:te.id):oe.concessionnaire===((ae=i.user)==null?void 0:ae.id)}),F.value&&(re=re.filter(oe=>{var Se;return typeof oe.agriculteur=="object"?((Se=oe.agriculteur)==null?void 0:Se.id)===F.value:oe.agriculteur===F.value})));const ee=[...re].sort((oe,Se)=>{if(V.value==="nom")return pe.value==="asc"?oe.nom.localeCompare(Se.nom):Se.nom.localeCompare(oe.nom);{const te=new Date(oe[V.value]).getTime(),ae=new Date(Se[V.value]).getTime();return pe.value==="asc"?te-ae:ae-te}});return console.log("[PlansView] Final filtered and sorted plans:",ee.map(oe=>({id:oe.id,usine:oe.usine,concessionnaire:oe.concessionnaire,agriculteur:oe.agriculteur}))),ee}),We=Di(()=>i.isAdmin?{title:"Tous les plans",description:"Liste complète des plans",plans:r.value}:i.isConcessionnaire?{title:"Plans des agriculteurs",description:"Plans où vous êtes assigné comme concessionnaire",plans:r.value.filter(re=>{var ee,oe,Se;return typeof re.concessionnaire=="object"?((ee=re.concessionnaire)==null?void 0:ee.id)===((oe=i.user)==null?void 0:oe.id):re.concessionnaire===((Se=i.user)==null?void 0:Se.id)})}:{title:"Mes plans",description:"Plans qui vous sont assignés ou que vous avez créés",plans:r.value.filter(re=>{var Se,te,ae,Le;const ee=re.createur.id===((Se=i.user)==null?void 0:Se.id);let oe=!1;return typeof re.agriculteur=="object"?oe=((te=re.agriculteur)==null?void 0:te.id)===((ae=i.user)==null?void 0:ae.id):oe=re.agriculteur===((Le=i.user)==null?void 0:Le.id),oe||ee})}),O=Di(()=>Ee.value?o.value.filter(re=>{var ee;return typeof re.usine=="object"?((ee=re.usine)==null?void 0:ee.id)===Ee.value:re.usine_id===Ee.value}):o.value),H=Di(()=>b.value.usine?o.value.filter(re=>{var ee;return typeof re.usine=="object"?((ee=re.usine)==null?void 0:ee.id)===b.value.usine:re.usine_id===b.value.usine}):[]),le=Di(()=>!b.value.usine||!b.value.concessionnaire?[]:h.value.filter(re=>typeof re.concessionnaire=="object"&&re.concessionnaire?re.concessionnaire.id===b.value.concessionnaire:re.concessionnaire===b.value.concessionnaire||re.concessionnaire_id===b.value.concessionnaire));Ha(async()=>{var re;await G(),i.isAdmin?await I():i.isConcessionnaire&&await $(((re=i.user)==null?void 0:re.id)||0)});async function G(){try{const re=await t.fetchPlansWithDetails();r.value=re.data}catch(re){console.error("Erreur lors du chargement des plans:",re)}}async function I(){try{console.log("Chargement des usines..."),l.value=await i.fetchUsines(),console.log("Usines chargées:",l.value)}catch(re){console.error("Erreur lors du chargement des usines:",re)}}async function Y(re){try{if(console.log("Chargement des concessionnaires pour l'usine:",re),re===void 0){const ee=await i.fetchUsersByRole({role:"CONCESSIONNAIRE"});o.value=ee}else o.value=await i.fetchUsineConcessionnaires(re);console.log("Concessionnaires chargés:",o.value)}catch(ee){console.error("Erreur lors du chargement des concessionnaires:",ee)}}async function $(re){try{console.log("Chargement des agriculteurs pour le concessionnaire:",re);const ee=await $d({role:"AGRICULTEUR",concessionnaireId:re});h.value=ee.map(oe=>({...oe,concessionnaire_id:re})),console.log("Agriculteurs chargés:",h.value)}catch(ee){console.error("Erreur lors du chargement des agriculteurs:",ee)}}function R(){p.value=!0,E.value={nom:"",description:"",client:null}}async function Z(re){console.log(`
[PlansView][editPlan] ====== DÉBUT ÉDITION PLAN ======`),console.log("[PlansView][editPlan] Plan reçu:",{id:re.id,nom:re.nom,usine:re.usine,concessionnaire:re.concessionnaire,agriculteur:re.agriculteur});try{console.log("[PlansView][editPlan] Définition du plan courant dans le store..."),t.setCurrentPlan(re),console.log("[PlansView][editPlan] Sauvegarde de l'ID dans localStorage:",re.id),localStorage.setItem("lastPlanId",re.id.toString()),console.log("[PlansView][editPlan] Redirection vers la vue carte..."),await n.push("/"),console.log(`[PlansView][editPlan] ====== FIN ÉDITION PLAN ======
`)}catch(ee){console.error("[PlansView][editPlan] ERREUR:",ee),ee instanceof Error&&console.error("[PlansView][editPlan] Stack trace:",ee.stack),alert("Une erreur est survenue lors du chargement du plan")}}async function se(re){re!=null&&re.id&&(w.value=re,_.value=!0)}async function ie(){var re,ee;if((re=w.value)!=null&&re.id)try{await t.deletePlan(w.value.id),await G(),((ee=t.currentPlan)==null?void 0:ee.id)===w.value.id&&t.clearCurrentPlan()}catch(oe){console.error("Erreur lors de la suppression du plan:",oe),alert("Une erreur est survenue lors de la suppression du plan")}finally{_.value=!1,w.value=null}}function Ae(){_.value=!1,w.value=null}function Te(re){return new Date(re).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}function ut(re){if(!re)return"";const ee=re.first_name||"",oe=re.last_name||"";return(ee.charAt(0)+oe.charAt(0)).toUpperCase()}async function X(re){D.value=!0,j.value=null;try{i.isAdmin&&!l.value.length&&await I();const ee=typeof re.usine=="object"&&re.usine?re.usine.id:re.usine,oe=typeof re.concessionnaire=="object"&&re.concessionnaire?re.concessionnaire.id:re.concessionnaire,Se=typeof re.agriculteur=="object"&&re.agriculteur?re.agriculteur.id:re.agriculteur;b.value={id:re.id,nom:re.nom,description:re.description,usine:ee||null,concessionnaire:oe||null,agriculteur:Se||null},ee&&await Y(ee),oe&&await $(oe),m.value=!0}catch(ee){console.error("Erreur lors de l'ouverture du modal:",ee),j.value="Erreur lors du chargement des données"}finally{D.value=!1}}async function ke(){var re,ee,oe,Se,te;j.value=null,D.value=!0;try{if(!b.value.nom.trim())throw new Error("Le nom du plan est requis");if(b.value.agriculteur&&!b.value.concessionnaire)throw new Error("Un concessionnaire doit être sélectionné pour assigner un agriculteur");if(b.value.concessionnaire&&!b.value.usine)throw new Error("Une usine doit être sélectionnée pour assigner un concessionnaire");console.log("Données envoyées pour la mise à jour:",{id:b.value.id,nom:b.value.nom.trim(),description:b.value.description.trim(),usine_id:b.value.usine,concessionnaire_id:b.value.concessionnaire,agriculteur_id:b.value.agriculteur});const ae=await t.updatePlanDetails(b.value.id,{nom:b.value.nom.trim(),description:b.value.description.trim(),usine_id:b.value.usine,concessionnaire_id:b.value.concessionnaire,agriculteur_id:b.value.agriculteur});console.log("Réponse de la mise à jour:",ae),ae&&(m.value=!1,await G())}catch(ae){if(console.error("Erreur lors de la mise à jour du plan:",ae),(ee=(re=ae.response)==null?void 0:re.data)!=null&&ee.detail)j.value=ae.response.data.detail;else if((Se=(oe=ae.response)==null?void 0:oe.data)!=null&&Se.non_field_errors)j.value=ae.response.data.non_field_errors[0];else if((te=ae.response)!=null&&te.data){const Le=Object.entries(ae.response.data).map(([ye,ue])=>`${ye}: ${Array.isArray(ue)?ue[0]:ue}`);j.value=Le.join(`
`)}else j.value=ae.message||"Une erreur est survenue lors de la mise à jour du plan"}finally{D.value=!1}}Ur(()=>Ee.value,async re=>{Q.value=null,F.value=null,re?await Y(re):await Y()}),Ur(()=>Q.value,async re=>{F.value=null,re&&await $(re)}),Ur(()=>b.value.usine,async re=>{re===null?(b.value.concessionnaire=null,b.value.agriculteur=null):await Y(re)}),Ur(()=>b.value.concessionnaire,async re=>{b.value.agriculteur=null,re&&await $(re)});function B(re){var te,ae,Le;const ee=i.user;if(!ee)return!1;if(ee.user_type==="admin")return!0;if(ee.user_type==="usine")return typeof re.usine=="object"?((te=re.usine)==null?void 0:te.id)===ee.id:re.usine===ee.id;if(ee.user_type==="concessionnaire")return typeof re.concessionnaire=="object"?((ae=re.concessionnaire)==null?void 0:ae.id)===ee.id:re.concessionnaire===ee.id;const oe=re.createur.id===ee.id;let Se=!1;return typeof re.agriculteur=="object"?Se=((Le=re.agriculteur)==null?void 0:Le.id)===ee.id:Se=re.agriculteur===ee.id,Se||oe}async function W(re){await G(),localStorage.setItem("lastPlanId",re.toString()),console.log(`Plan ${re} créé et défini comme plan actif`),n.push("/")}function he(re){V.value===re?pe.value=pe.value==="asc"?"desc":"asc":(V.value=re,pe.value="desc")}function ne(re){return re?ll(re):""}return(re,ee)=>{var oe;return et(),rt("div",bO,[A("div",wO,[A("div",xO,[A("div",LO,[A("h1",CO,Jt(We.value.title),1),A("p",SO,Jt(We.value.description),1)]),A("div",{class:"mt-4 sm:mt-0 sm:ml-16 sm:flex-none"},[A("button",{onClick:R,class:"inline-flex items-center justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:w-auto"}," Nouveau plan ")])]),Xn(i).isAdmin?(et(),rt("div",PO,[A("div",EO,[ee[15]||(ee[15]=A("label",{for:"usine-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par usine",-1)),zn(A("select",{id:"usine-filter","onUpdate:modelValue":ee[0]||(ee[0]=Se=>Ee.value=Se),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[ee[14]||(ee[14]=A("option",{value:null},"Toutes les usines",-1)),(et(!0),rt(Vn,null,$i(l.value,Se=>(et(),rt("option",{key:Se.id,value:Se.id},Jt(ne(Se)),9,AO))),128))],512),[[Ks,Ee.value]])]),A("div",kO,[ee[16]||(ee[16]=A("label",{for:"concessionnaire-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par concessionnaire",-1)),zn(A("select",{id:"concessionnaire-filter","onUpdate:modelValue":ee[1]||(ee[1]=Se=>Q.value=Se),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[A("option",MO,Jt(O.value.length?"Tous les concessionnaires":"Aucun concessionnaire disponible"),1),(et(!0),rt(Vn,null,$i(O.value,Se=>(et(),rt("option",{key:Se.id,value:Se.id},Jt(ne(Se)),9,TO))),128))],512),[[Ks,Q.value]])]),Q.value?(et(),rt("div",BO,[ee[17]||(ee[17]=A("label",{for:"agriculteur-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par agriculteur",-1)),zn(A("select",{id:"agriculteur-filter","onUpdate:modelValue":ee[2]||(ee[2]=Se=>F.value=Se),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[A("option",NO,Jt(Ie.value.length?"Tous les agriculteurs":"Aucun agriculteur disponible"),1),(et(!0),rt(Vn,null,$i(Ie.value,Se=>(et(),rt("option",{key:Se.id,value:Se.id},Jt(ne(Se)),9,DO))),128))],512),[[Ks,F.value]])])):Cn("",!0)])):Xn(i).isConcessionnaire?(et(),rt("div",RO,[A("div",OO,[ee[19]||(ee[19]=A("label",{for:"agriculteur-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par agriculteur",-1)),zn(A("select",{id:"agriculteur-filter","onUpdate:modelValue":ee[3]||(ee[3]=Se=>F.value=Se),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[ee[18]||(ee[18]=A("option",{value:null},"Tous les agriculteurs",-1)),(et(!0),rt(Vn,null,$i(h.value,Se=>(et(),rt("option",{key:Se.id,value:Se.id},Jt(ne(Se)),9,IO))),128))],512),[[Ks,F.value]])])])):Cn("",!0),A("div",FO,[A("div",zO,[A("div",jO,[A("table",UO,[A("thead",$O,[A("tr",null,[A("th",qO,[A("button",{onClick:ee[4]||(ee[4]=Se=>he("nom")),class:"group inline-flex items-center"},[ee[21]||(ee[21]=Ir(" Nom ")),A("span",GO,[(et(),rt("svg",{class:Jr(["h-5 w-5",{"text-gray-900":V.value==="nom","text-gray-400":V.value!=="nom","rotate-180":V.value==="nom"&&pe.value==="asc"}]),viewBox:"0 0 20 20",fill:"currentColor"},ee[20]||(ee[20]=[A("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)]),2))])])]),ee[24]||(ee[24]=A("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Description ",-1)),ee[25]||(ee[25]=A("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Usine ",-1)),ee[26]||(ee[26]=A("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Concessionnaire ",-1)),ee[27]||(ee[27]=A("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Agriculteur ",-1)),A("th",VO,[A("button",{onClick:ee[5]||(ee[5]=Se=>he("date_modification")),class:"group inline-flex items-center"},[ee[23]||(ee[23]=Ir(" Dernière modification ")),A("span",HO,[(et(),rt("svg",{class:Jr(["h-5 w-5",{"text-gray-900":V.value==="date_modification","text-gray-400":V.value!=="date_modification","rotate-180":V.value==="date_modification"&&pe.value==="asc"}]),viewBox:"0 0 20 20",fill:"currentColor"},ee[22]||(ee[22]=[A("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)]),2))])])]),ee[28]||(ee[28]=A("th",{scope:"col",class:"relative py-3.5 pl-3 pr-4 sm:pr-6 lg:pr-8"},[A("span",{class:"sr-only"},"Actions")],-1))])]),A("tbody",WO,[nt.value.length===0?(et(),rt("tr",ZO,ee[29]||(ee[29]=[A("td",{colspan:"7",class:"py-4 px-6 text-center text-gray-500"}," Aucun plan disponible ",-1)]))):Cn("",!0),(et(!0),rt(Vn,null,$i(nt.value,Se=>(et(),rt("tr",{key:Se.id,class:"hover:bg-gray-50"},[A("td",KO,Jt(Se.nom),1),A("td",JO,Jt(Se.description||"-"),1),A("td",YO,[Se.usine&&typeof Se.usine=="object"?(et(),rt("div",XO,[A("div",QO,[A("div",eI,[A("span",tI,Jt(ut(Se.usine)),1)])]),A("div",nI,[A("div",iI,Jt(Xn(ll)(Se.usine)),1)])])):(et(),rt("div",rI," Non assigné "))]),A("td",sI,[Se.concessionnaire&&typeof Se.concessionnaire=="object"?(et(),rt("div",oI,[A("div",aI,[A("div",lI,[A("span",uI,Jt(ut(Se.concessionnaire)),1)])]),A("div",cI,[A("div",hI,Jt(Xn(ll)(Se.concessionnaire)),1)])])):(et(),rt("div",fI," Non assigné "))]),A("td",dI,[Se.agriculteur&&typeof Se.agriculteur=="object"?(et(),rt("div",pI,[A("div",gI,[A("div",mI,[A("span",vI,Jt(ut(Se.agriculteur)),1)])]),A("div",yI,[A("div",_I,Jt(Xn(ll)(Se.agriculteur)),1)])])):(et(),rt("div",bI," Non assigné "))]),A("td",wI,Jt(Te(Se.date_modification)),1),A("td",xI,[A("button",{onClick:te=>Z(Se),class:"text-primary-600 hover:text-primary-900 mr-4"}," Ouvrir ",8,LI),A("button",{onClick:te=>X(Se),class:"text-primary-600 hover:text-primary-900 mr-4"}," Modifier ",8,CI),B(Se)?(et(),rt("button",{key:0,onClick:te=>se(Se),class:"text-red-600 hover:text-red-900"}," Supprimer ",8,SI)):Cn("",!0)])]))),128))])])])])]),$r(C4,{modelValue:p.value,"onUpdate:modelValue":ee[6]||(ee[6]=Se=>p.value=Se),concessionnaires:o.value,clients:h.value,onCreated:W},null,8,["modelValue","concessionnaires","clients"]),m.value?(et(),rt("div",PI,[A("div",EI,[A("div",AI,[ee[31]||(ee[31]=A("h2",{class:"text-xl font-semibold text-gray-900"},"Modifier le plan",-1)),A("button",{onClick:ee[7]||(ee[7]=Se=>m.value=!1),class:"text-gray-400 hover:text-gray-500 focus:outline-none"},ee[30]||(ee[30]=[A("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[A("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),A("form",{onSubmit:Bp(ke,["prevent"]),class:"space-y-4"},[A("div",null,[ee[32]||(ee[32]=A("label",{for:"edit-nom",class:"block text-sm font-medium text-gray-700"}," Nom ",-1)),zn(A("input",{type:"text",id:"edit-nom","onUpdate:modelValue":ee[8]||(ee[8]=Se=>b.value.nom=Se),disabled:D.value,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",required:""},null,8,kI),[[Ui,b.value.nom]])]),A("div",null,[ee[33]||(ee[33]=A("label",{for:"edit-description",class:"block text-sm font-medium text-gray-700"}," Description ",-1)),zn(A("textarea",{id:"edit-description","onUpdate:modelValue":ee[9]||(ee[9]=Se=>b.value.description=Se),disabled:D.value,rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm disabled:bg-gray-100 disabled:cursor-not-allowed"},null,8,MI),[[Ui,b.value.description]])]),Xn(i).isAdmin||((oe=Xn(i).user)==null?void 0:oe.user_type)==="usine"?(et(),rt("div",TI,[Xn(i).isAdmin?(et(),rt("div",BI,[ee[35]||(ee[35]=A("label",{for:"edit-usine",class:"block text-sm font-medium text-gray-700"}," Usine ",-1)),zn(A("select",{id:"edit-usine","onUpdate:modelValue":ee[10]||(ee[10]=Se=>b.value.usine=Se),disabled:D.value,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed"},[ee[34]||(ee[34]=A("option",{value:null},"Sélectionner une usine",-1)),(et(!0),rt(Vn,null,$i(l.value,Se=>(et(),rt("option",{key:Se.id,value:Se.id},Jt(ne(Se)),9,DI))),128))],8,NI),[[Ks,b.value.usine]])])):Cn("",!0),A("div",null,[ee[37]||(ee[37]=A("label",{for:"edit-concessionnaire",class:"block text-sm font-medium text-gray-700"}," Concessionnaire ",-1)),zn(A("select",{id:"edit-concessionnaire","onUpdate:modelValue":ee[11]||(ee[11]=Se=>b.value.concessionnaire=Se),disabled:Xn(i).isAdmin&&!b.value.usine||D.value,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed"},[ee[36]||(ee[36]=A("option",{value:null},"Sélectionner un concessionnaire",-1)),(et(!0),rt(Vn,null,$i(H.value,Se=>(et(),rt("option",{key:Se.id,value:Se.id},Jt(ne(Se)),9,OI))),128))],8,RI),[[Ks,b.value.concessionnaire]]),Xn(i).isAdmin&&!b.value.usine?(et(),rt("p",II," Veuillez d'abord sélectionner une usine ")):Cn("",!0)]),A("div",null,[ee[39]||(ee[39]=A("label",{for:"edit-agriculteur",class:"block text-sm font-medium text-gray-700"}," Agriculteur ",-1)),zn(A("select",{id:"edit-agriculteur","onUpdate:modelValue":ee[12]||(ee[12]=Se=>b.value.agriculteur=Se),disabled:!b.value.concessionnaire||D.value,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed"},[ee[38]||(ee[38]=A("option",{value:null},"Sélectionner un agriculteur",-1)),(et(!0),rt(Vn,null,$i(le.value,Se=>(et(),rt("option",{key:Se.id,value:Se.id},Jt(ne(Se)),9,zI))),128))],8,FI),[[Ks,b.value.agriculteur]]),b.value.concessionnaire?Cn("",!0):(et(),rt("p",jI," Veuillez d'abord sélectionner un concessionnaire "))])])):Cn("",!0),j.value?(et(),rt("div",UI,[A("div",$I,[ee[40]||(ee[40]=A("div",{class:"flex-shrink-0"},[A("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[A("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),A("div",qI,[A("p",GI,Jt(j.value),1)])])])):Cn("",!0),A("div",VI,[A("button",{type:"button",class:"mt-3 inline-flex w-full justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-base font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:mt-0 sm:text-sm",onClick:ee[13]||(ee[13]=Se=>m.value=!1)}," Annuler "),A("button",{type:"submit",disabled:D.value,class:"inline-flex w-full justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:text-sm disabled:opacity-50"},[D.value?(et(),rt("svg",WI,ee[41]||(ee[41]=[A("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),A("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):Cn("",!0),Ir(" "+Jt(D.value?"Enregistrement...":"Enregistrer"),1)],8,HI)])],32)])])):Cn("",!0),_.value?(et(),Yl(H4,{key:3,title:"Supprimer le plan",message:"Êtes-vous sûr de vouloir supprimer ce plan ? Cette action est irréversible.",onConfirm:ie,onCancel:Ae})):Cn("",!0)])])}}}),W4=cA({history:UE("/"),routes:[{path:"/",name:"home",component:Zy,meta:{requiresAuth:!0,allowedRoles:["admin","usine","concessionnaire","agriculteur"]}},{path:"/plans",name:"plans",component:ZI,meta:{requiresAuth:!0,allowedRoles:["admin","usine","concessionnaire","agriculteur"]}},{path:"/users",name:"users",component:_O,meta:{requiresAuth:!0,allowedRoles:["admin","usine","concessionnaire"]}},{path:"/profile",name:"profile",component:()=>nh(()=>import("./ProfileView.js"),[]),meta:{requiresAuth:!0,allowedRoles:["admin","usine","concessionnaire","agriculteur"]}},{path:"/login",name:"login",component:MM,meta:{requiresGuest:!0}},{path:"/forgot-password",name:"forgot-password",component:()=>nh(()=>import("./ForgotPasswordView.js"),[]),meta:{requiresGuest:!0}},{path:"/reset-password/:token",name:"reset-password",component:()=>nh(()=>import("./ResetPasswordView.js"),[]),meta:{requiresGuest:!0}},{path:"/change-password",name:"changePassword",component:hM,meta:{requiresAuth:!0,allowedRoles:["admin","usine","concessionnaire","agriculteur"]}},{path:"/map",name:"map",component:Zy,meta:{requiresAuth:!0}},{path:"/:pathMatch(.*)*",name:"not-found",component:()=>nh(()=>import("./NotFoundView.js"),[])}]});W4.beforeEach(async(e,n,t)=>{var h,p;const i=Va();if(console.log("Route:",e.path,"Auth state:",{initialized:i.initialized,isAuthenticated:i.isAuthenticated,user:i.user}),!i.initialized)try{await i.initialize(window.INITIAL_STATE)}catch(m){console.error("Error initializing auth store:",m)}const r=i.isAuthenticated,o=(h=i.user)==null?void 0:h.must_change_password,l=(p=i.user)==null?void 0:p.user_type;if(e.meta.requiresAuth&&!r){t("/login");return}if(r&&o&&e.name!=="changePassword"){t({name:"changePassword"});return}if(e.name==="changePassword"&&!o){t({name:"home"});return}if(e.meta.allowedRoles&&l&&!e.meta.allowedRoles.includes(l)){t({name:"home"});return}if(e.meta.requiresGuest&&r){t({name:"home"});return}t()});const Em=gS(qk),Z4=yS();Em.use(Z4);Em.use(W4);const KI=Va(Z4);window.INITIAL_STATE&&KI.initialize(window.INITIAL_STATE);Em.mount("#app");export{Fr as _,ku as a,A as b,rt as c,Pa as d,Cn as e,Xn as f,Ir as g,zn as h,et as i,Cc as j,$r as k,Kl as l,VL as m,Jr as n,Ha as o,gF as p,Gp as q,Yt as r,qo as s,Jt as t,Va as u,Ui as v,Bp as w,s4 as x};
